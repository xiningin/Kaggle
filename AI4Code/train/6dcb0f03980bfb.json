{"cell_type":{"517ac1b3":"code","0de24b62":"code","03003285":"code","648ddef2":"code","091cc52f":"code","50290df7":"code","ead1ab47":"code","9e0d1ce2":"code","c1241df5":"code","06e2e761":"code","2500f242":"code","aaccce4c":"code","8cf0859c":"code","bd97acc5":"code","390ff870":"code","e517b31e":"code","5f6339a3":"code","396d72ff":"code","b4f302d3":"code","09817d34":"code","dd35b13a":"code","d055337f":"code","e96e1656":"code","2c46b6e8":"code","8b815bb7":"markdown","43ee9d98":"markdown","8fde0f66":"markdown","507f8564":"markdown","a43a032b":"markdown","8dbd4c09":"markdown","8e435b32":"markdown","d88a2987":"markdown","a001ab05":"markdown","0faeae01":"markdown","201f0a6a":"markdown","06a67423":"markdown","a9f4e42f":"markdown","1c19c389":"markdown","776b5cea":"markdown","dfb7de87":"markdown","2f409872":"markdown","a79d332b":"markdown","9ff18038":"markdown","ec123583":"markdown","e4c9ef9c":"markdown","3c21e1c7":"markdown","f6d25c4d":"markdown","0eed40f6":"markdown","41dd5ebf":"markdown","3ec5867c":"markdown","807ad039":"markdown"},"source":{"517ac1b3":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\n\n# for Box-Cox Transformation\nfrom scipy import stats\nfrom scipy.stats import pearsonr\n\n# for min_max scaling\nfrom mlxtend.preprocessing import minmax_scaling\n\nimport matplotlib.pyplot as plt\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\n# for Welch t-test\nimport scipy.stats\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","0de24b62":"df = pd.read_csv('..\/input\/suicide-rates-overview-1985-to-2016\/master.csv')\n\ntotal_cells = np.product(df.shape)\nmissing_cells = df.isnull().sum().sum()\n\npercent_missing_cells=(missing_cells\/total_cells) * 100\n\n# percent of data that is missing\nprint ('Total # of Cells: %d' %total_cells)\nprint('Total # of Missing Cells: %d' %missing_cells)\nprint('Percent Missing Cells: %d' %percent_missing_cells)\n\nprint('\\nColumns with missing_values_count: ')\ndf.isnull().sum()","03003285":"# Dropping HDI column based on Missing Value analysis\ndf.drop(columns=['HDI for year'],inplace=True)\n\n# Converting GFD_per_capita to numeric\ndf['gdp_per_capita ($)']=pd.to_numeric(df['gdp_per_capita ($)'])\n\n# Dropping 'years' from Age feature for easier read\ndf['age'].replace(regex=True,inplace=True,to_replace=r'years',value=r'')\n\n# Removing word Generation from generation feature\ndf['generation']=df['generation'].apply(lambda x: x.replace('Generation',''))","648ddef2":"\nplt.figure(figsize=(22,36))\nplt.subplot(221)\nsns.countplot(y='country',data=df, alpha=0.7, order=reversed(df['country'].value_counts().index))\nplt.axvline(x=df['country'].value_counts().mean(), color='k')\nplt.gca().xaxis.tick_bottom()\nplt.title('Data count by Country \\nFrom 1987 to 2016')\n\n","091cc52f":"plt.figure(figsize=(14,5))\nplt.subplot(221)\nsns.boxplot(x=df['country'].value_counts())\nplt.gca().xaxis.tick_bottom()\nplt.title('Data count distribution by Country')\n\nplt.subplot(222)\ndf['country'].value_counts().plot.kde()\nplt.gca().xaxis.tick_bottom()\nplt.title('Data count density distribution by Country')","50290df7":"plt.figure(figsize=(20,10))\n#fig.subplots_adjust(hspace=0.4, wspace=1)\n\nplt.subplot(231)\nsns.countplot(y='generation',data=df, alpha=0.7, order=reversed(df['generation'].value_counts().index))\nplt.axvline(x=df['generation'].value_counts().mean(), color='k')\nplt.gca().xaxis.tick_bottom()\nplt.title('Data count by Generation')\n\nplt.subplot(232)\nsns.countplot(y='age',data=df)\nplt.gca().xaxis.tick_bottom()\nplt.title('Data count by Age')\n\nplt.subplot(233)\nsns.countplot(y='sex',data=df)\nplt.gca().xaxis.tick_bottom()\nplt.title('Data count by Sex')","ead1ab47":"by_country_suicide= df.groupby('country').mean().sort_values('suicides\/100k pop', ascending=False).reset_index()\n\n\nplt.figure(figsize=(22,36))\nplt.subplot(221)\nsns.barplot(x='suicides\/100k pop',y='country',data=by_country_suicide)\nplt.axvline(x=by_country_suicide['suicides\/100k pop'].mean(), color='k')\nplt.gca().xaxis.tick_bottom()\nplt.title('Suicides per 100k of population by Country \\nFrom 1987 to 2016')\n\nplt.tight_layout()","9e0d1ce2":"plt.figure(figsize=(14,5))\nplt.subplot(221)\nsns.boxplot(df['suicides\/100k pop'])\n\nplt.subplot(222)\nsns.boxplot(df['gdp_per_capita ($)'])","c1241df5":"def subset_by_iqr(df, column, whisker_width=1.5):\n\n    # Calculate Q1, Q2 and IQR\n    q1 = df[column].quantile(0.25)                 \n    q3 = df[column].quantile(0.75)\n    iqr = q3 - q1\n    # Apply filter with respect to IQR, including optional whiskers\n    \n    filter = (df[column] >= q1 - whisker_width*iqr) & (df[column] <= q3 + whisker_width*iqr)\n    return df.loc[filter]                                                     \n\n\ndf_filtered_suicide = subset_by_iqr(df, 'suicides\/100k pop', whisker_width=1.5)\ndf_filtered_gpd = subset_by_iqr(df, 'gdp_per_capita ($)', whisker_width=1.5)\n\ndf_filtered_suicide = df_filtered_suicide.rename(columns ={'suicides\/100k pop' : 'filtered_suicides\/100k pop'})\ndf_filtered_gpd = df_filtered_gpd.rename(columns ={'gdp_per_capita ($)' : 'filtered_gdp_per_capita ($)'})\n","06e2e761":"plt.figure(figsize=(14,5))\nplt.subplot(221)\nsns.boxplot(df['suicides\/100k pop'], color = 'red')\nplt.gca().xaxis.tick_bottom()\n\nplt.subplot(222)\nsns.boxplot(df['gdp_per_capita ($)'],  color = 'red')\nplt.gca().xaxis.tick_bottom()\n\nplt.subplot(223)\nsns.boxplot(df_filtered_suicide['filtered_suicides\/100k pop'],color = 'g')\nplt.gca().xaxis.tick_bottom()\n\nplt.subplot(224)\nsns.boxplot(df_filtered_gpd['filtered_gdp_per_capita ($)'], color = 'g')\nplt.gca().xaxis.tick_bottom()\n\n\nplt.tight_layout()","2500f242":"df_filtered = df_filtered_suicide.merge(df_filtered_gpd)\n\nprint ('Original data: ',df.shape[0])\nprint ('Filtered data: ',df_filtered.shape[0])\n\nprint ('Percent outliers by suicides\/100k pop and GDP: ', 100 - df_filtered.shape[0]*100\/df.shape[0])\n\n","aaccce4c":"\n# Plotting Suicides\/100k of population and GDP_per_capita as a function of years\n\nsuicide_year_gdp = df_filtered[['suicides\/100k pop','year','gdp_per_capita ($)']].groupby(['year']).mean().reset_index()\n\nfig, ax1 = plt.subplots(figsize=(12,6))\n\n# Plot the suicides over the years.\nln1 = ax1.plot(suicide_year_gdp['year'], suicide_year_gdp['suicides\/100k pop'], 'ro--', label='Suicides')\nplt.gca().xaxis.tick_bottom()\n# Adding GDP plot to the same plot, but on different scale.\nax2 = ax1.twinx()\nln2 = ax2.plot(suicide_year_gdp['year'], suicide_year_gdp['gdp_per_capita ($)'], 'o--', label='GDP')\n\n# Joining legends.\nlns = ln1 + ln2\nlabels = [l.get_label() for l in lns]\nax1.legend(lns, labels, loc=2)\n\n# Setting labels\nax1.set_ylabel('Suicides per 100k population')\nax2.set_ylabel('GDP per Capita($)')\nax1.set_xlabel('Time(Years)')\nplt.title ('Evolution of Suicide and GDP')\n\nplt.show()\n\nsuicide_year_gdp.corr()","8cf0859c":"df_filtered_2015_2016 = df_filtered[df_filtered['year']==2016]\n\n\nby_country_suicide= df_filtered_2015_2016.groupby('country').mean().sort_values('suicides\/100k pop', ascending=False).reset_index()\n\n\nplt.figure(figsize=(14,8))\nplt.subplot(221)\nsns.barplot(x='suicides\/100k pop',y='country',data=by_country_suicide)\nplt.axvline(x=by_country_suicide['suicides\/100k pop'].mean(), color='k')\nplt.gca().xaxis.tick_bottom()\nplt.title('Suicides per 100k of population by Country in 2016')\n\nplt.tight_layout()","bd97acc5":"by_Sex = df.groupby(['sex']).mean().sort_values('suicides\/100k pop', ascending=True).reset_index()\nby_Sex_Time = df.groupby(['sex','year']).mean().sort_values('suicides\/100k pop', ascending=True).reset_index()\nby_Sex_Age = df.groupby(['sex','age']).mean().sort_values('suicides\/100k pop', ascending=True).reset_index()\nby_Sex_Gen = df.groupby(['sex','generation']).mean().sort_values('suicides\/100k pop', ascending=True).reset_index()\n","390ff870":"plt.figure(figsize=(16,10))\n\nplt.subplot(231)\nsns.barplot(x='sex',y='suicides\/100k pop', data=by_Sex,alpha=0.7,  ci='sd')\nplt.gca().xaxis.tick_bottom()\nplt.title('Average Suicides by Sex \\nFrom 1987 to 2016')\n\nplt.subplot(232)\nsns.barplot(x='age',y='suicides\/100k pop', hue='sex', data=by_Sex_Age,alpha=0.7)\nplt.gca().xaxis.tick_bottom()\nplt.title('Average Suicides Age & Sex \\nFrom 1987 to 2016')\n\nplt.subplot(233)\nsns.barplot(x='generation',y='suicides\/100k pop', hue='sex', data=by_Sex_Gen, alpha=0.7, palette=('husl'))\nplt.gca().xaxis.tick_bottom()\nplt.title('Average Suicides by Sex & Generation \\nFrom 1987 to 2016')\n\nplt.tight_layout()","e517b31e":"by_Gen_Time = df.groupby(['generation','year']).mean().sort_values('suicides\/100k pop', ascending=True).reset_index()\nby_Age_Time = df.groupby(['age','year']).mean().sort_values('suicides\/100k pop', ascending=True).reset_index()","5f6339a3":"plt.figure(figsize=(22,8))\nfig.subplots_adjust(hspace=.5)\n\n\nplt.subplot(131)\nsns.lineplot(x='year',y='suicides\/100k pop', hue='sex', data=by_Sex_Time,alpha=0.7)\nplt.gca().xaxis.tick_bottom()\nplt.title('Evolution of average sucide\/100k of population by Sex')\n\nplt.subplot(132)\nsns.lineplot(x='year',y='suicides\/100k pop', hue='age', data=by_Age_Time, alpha=0.7)\nplt.gca().xaxis.tick_bottom()\nplt.title('Evolution of average sucide\/100k of population by Age')\n\nplt.subplot(133)\nsns.lineplot(x='year',y='suicides\/100k pop', hue='generation', data=by_Gen_Time, alpha=0.7)\nplt.gca().xaxis.tick_bottom()\nplt.title('Evolution of average sucide\/100k of population by Generation')\n\n","396d72ff":"# Load world-capitals-gps\ncontinents=pd.read_csv(\"..\/input\/world-capitals-gps\/concap.csv\")   # world GPS\nsuicide = df","b4f302d3":"continents['country'] = continents['CountryName'].apply(lambda x: x.lower())\nsuicide['country'] = suicide['country'].apply(lambda x: x.lower())\n\nsuicide_country = suicide.groupby(['country']).mean().reset_index()\n\n# Merging Suicidce and GPS dataframes based on country using left join method\ncombined_df = pd.merge(suicide_country,\n                            continents[['country','ContinentName']]\n                            ,on='country',how='left')\n\ncombined_df[combined_df.isna().any(axis=1)]","09817d34":"# Lets impute countries have not been assigned with a continent name\ncombined_df.reset_index()\n\ncombined_df.loc[17,'ContinentName'] = 'Africa'\ncombined_df.loc[73,'ContinentName'] = 'Asia'\ncombined_df.loc[75,'ContinentName'] = 'Europe'\ncombined_df.loc[78,'ContinentName'] = 'North America'","dd35b13a":"# Lets look have many countries are in each continent group\nsns.countplot(y='ContinentName',data =combined_df, alpha=0.7, order=reversed(combined_df['ContinentName'].value_counts().index))\n","d055337f":"asian_countries =         combined_df.loc[combined_df['ContinentName']=='Asia']\neuropean_countries =      combined_df.loc[combined_df['ContinentName']=='Europe']\nsouth_america_countries = combined_df.loc[combined_df['ContinentName']=='South America']\nnorth_america_countries = combined_df.loc[combined_df['ContinentName']=='North America']\nafrica_countries =        combined_df.loc[combined_df['ContinentName']=='Africa']","e96e1656":"# Looping 10 T-test\n\nt_test_result=[]\ndef t_test_loop(group_1,group_2,sample_size):\n    \n    group1_continent = group_1['ContinentName'].iloc[0]\n    group2_continent = group_2['ContinentName'].iloc[0]\n    print ('%s vs %s (sample size=%s) :  \\n'%(group1_continent,group2_continent,sample_size))\n    for i in range(11):\n        \n        random_group1_countries = group_1.sample(sample_size)\n        random_group2_countries = group_2.sample(sample_size)\n        \n        group1_suicide = random_group1_countries['suicides\/100k pop'].tolist()\n        group2_suicide = random_group2_countries['suicides\/100k pop'].tolist()\n    \n        p_val = scipy.stats.ttest_ind(group1_suicide,group2_suicide,equal_var=False).pvalue\n        t_test_result.append(round(p_val,2))\n        print ('Welch t-Test results:',scipy.stats.ttest_ind(group1_suicide,group2_suicide,equal_var=False))\n        \n    \n  \n    return  print ('\\nP-value results of series of t-Tests: ',t_test_result)\n    \nt_test_loop(north_america_countries,south_america_countries,9)","2c46b6e8":"def t_test(group_1,group_2,sample_size):\n    \n    group1_continent = group_1['ContinentName'].iloc[0]\n    group2_continent = group_2['ContinentName'].iloc[0]\n    \n    random_group1_countries = group_1.sample(sample_size)\n    random_group2_countries = group_2.sample(sample_size)\n    \n    group1_suicide = random_group1_countries['suicides\/100k pop'].tolist()\n    group2_suicide = random_group2_countries['suicides\/100k pop'].tolist()\n\n    p_val = scipy.stats.ttest_ind(group1_suicide,group2_suicide,equal_var=False).pvalue\n    \n    group_1_mean = round(random_group1_countries['suicides\/100k pop'].mean(),2)\n    group_1_std = round(random_group1_countries['suicides\/100k pop'].std(),2)\n    group_2_mean = round(random_group2_countries['suicides\/100k pop'].mean(),2)\n    group_2_std = round(random_group2_countries['suicides\/100k pop'].std(),2)\n    \n    print ('%s vs %s (sample size=%s) :  \\n'%(group1_continent,group2_continent,sample_size))\n    \n    print ('1st group countries:',random_group1_countries['country'].tolist())\n    print ('2nd group countries:',random_group2_countries['country'].tolist())\n    \n    print ('\\n1st group average suicide\/100k of population:  %s +- %s '%(group_1_mean,group_1_std))\n    print ('2st group average suicide\/100k of population:  %s +- %s '%(group_2_mean,group_2_std))\n\n    print ('\\nWelch t-Test results:',scipy.stats.ttest_ind(group1_suicide,group2_suicide,equal_var=False))\n    \n    if p_val<0.05:\n        print ('\\np values = {} ==> reject Ho'.format(round(p_val,2)))\n    else:\n        print ('\\np values = {} ==> can NOT reject Ho'.format(round(p_val,2)))\n    \nt_test(asian_countries,european_countries,10)","8b815bb7":"# 1.3 Data quantity by Age,Sex, and Generation","43ee9d98":"* Number of suicides comminted by males is 3.5 time higher than females\n* Generally speaking, the older people get the more likely they commit suicide\n* The riskiest age group is 75+ years old\n* Women of 15-24 and 25-34 age groups have a very similar suicide numbers\n* Z generation has the lowest suicide rate due to low amount of data recorded\n* **Anomaly:** G.I. Generation showed the highest averaged suicide\/100k of population, however the amount of data recorded for G.I. generation is lowest. This might explain why mean value is high. ","8fde0f66":"# 3.3 Conclusions: Do warmer countries have lower suicide rate ?\n\nConclusions are based on 90% of similar t-test results \n\nNull hypothesis **can NOT be rejected** for the following samples \n1. Asia vs Europe, sample = 10\n2. Asia vs North America, sample = 10\n2. South vs North America, sample = 9\n\nNull hypothesis **CAN BE rejected** for the following samples \n1. North America vs Europe, sample = 10\n\n\nBased on this analysis we found no evidence that climate alone has an effect on suicide rate. Obviously, a multivariate analysis is required to explain such phenomena, however couple take aways we get from the exercise is that wealth and climate alone can not be determinent factors for predicting suicide rate. ","507f8564":"* Interesting spiked in males suicide occured between 1994-1996. This observation might require additional investigation\n* Age groups of 5-14 and 75+ years old are have the lowest and highest suicide rates accordingly. 3 \n* Recall from Data Cleaning 1.3 section that the amount of data is not the same across Generations. This is why suicide time series of Generation G.I. ends at the year of 2000. Similar behavior is observed with Generation Z which data starts to be recorded in 2006. \n* This is possibly due to the fact that Generation G.I. is the oldest of all generations and most of the suicides occured at 75+ years. Meanwhile Generation Z is the youngest generation and number of suicides has not been peaked yet.\n* Overall world's suicide rate is falling ","a43a032b":"Since there are only four contries that dont have continent name, lets do manual imputation","8dbd4c09":"# 3.2 Experiment: Suicide rate t-Test comparison between two samples from different continent \n\n\nHo : Warm and Cold countries are **NOT different** in their average suicide rate\n\nHa : Warm and Cold countries are different in their average suicide rate \n\nHo gets rejected if **p < 0.05**","8e435b32":"# 2. EDA\n\n# 2.1 Global suicide trend by Country","d88a2987":"* Mean Suicides\/100k population = 12.8\n* For the exception of Sri Lanka, first 10 country are mostly from Easter European regions ","a001ab05":"# 2.3 Suicide comparison between Sex, Age, and Generation groups\n\nQuestions: \n1. What sex group has the highest suicide rate?\n2. What age group has the highest suicide rate?\n3. Is there a correlation between Suicide\/100k of population and GDP per capita ?\n4. Is there any anomalies present ?\n\nMethod:**\n1. Visually inspect plot both Suicide\/100k and GDP_per_capita as a function of years \n\n\n","0faeae01":"* Correlation between GDP_per_capita and Suicide\/100k of population is **-0.40**. This susggests poor relationship between rich countries and suicide rate \n* Stronger correlation is observed between GDP_per_capita and Time. This suggests that globally speaking humans become richer\n* Anomaly: Interesting spike in suicide is observed in 2016. Lets look at countries that can possible cause it.","201f0a6a":"* Data count by generation shows that generation G.I. and Z are below the mean count. This should be taking into the account during the analysis\n* Data count within age groups is are equal, for the exception of 5-14 group, which is slightly lower\n* Data count between sex groups is equal","06a67423":"* Suicides\/100k population data is more skewed by outliers than gdp_per_capita \n* Lets apply IQR method to remove outliers from both features ","a9f4e42f":"# General Exploratory Analysis of Suicide Phenomena\n\nGOALS:\n1. Identify main suicide trends across critical data features\n2. Observe anomalies in indetified trends and try to explain them\n3. Identify main correlations between critical data features","1c19c389":"# 3.0 Case Study: Do warmer countries have lower suicide rate ?\n\n* **Approach: **Compare mean suicide_rate_per_100k between two samples of 10-20 countries with different climates\n\n** Assumptions:**\n1. European and North American countries are primerely COLD \n2. Asian, South American, African countries are primeraly WARM\n\n\n**Method:**\n1. Group countries by continent\n2. Randomly select 10-20 countries for Europe and Latin America \/ SouthEast Asia\n3. Conduct t-Test to identify mean difference between groups\n\n\n**NOTE:**\n1. To avoid Confirmation Bias, I decided not to plot Suicide Rate by Continent\n2. To find out more about Welch's t-Test follow the [Wikipedia link](https:\/\/en.wikipedia.org\/wiki\/Welch%27s_t-test)\n","776b5cea":"# 2.2 Evolution of Suicide and GDP \n\nQuestions: \n1. How does evolution of suicide and gdp per capita look like ?\n2. Can trend be established ?\n3. Is there a correlation between Suicide\/100k of population and GDP per capita ?\n4. Is there any anomalies present ?\n\nMethod:**\n1. Remove outliers from Suicide\/100k and GDP_per_capita\n2. Visually inspect plot both Suicide\/100k and GDP_per_capita as a function of years \n3. Look at Pearson Correlation Coefficint between the two features\n","dfb7de87":"# Looping T-test\n\n**Method:**\n\n1. Conduct ten t-tests based on country random permutations within each continent groups \n\n1. Identify % of test in favor of accepting hypothesis ","2f409872":"# **Data Cleaning**: \n\n# 1.1 Missing data","a79d332b":"* As we can see, some countries have a very low data count\n* Lets look at data count box plot and density density distribution","9ff18038":"# Single t-Test with countries printed","ec123583":"# 1.2 Data quantity by country","e4c9ef9c":"* Indeed, boxplot shows several country outliers with data count below 120\n* For the purpose of this analysis, countries with low data count will not be removed, since normalized suicides and GDP counts will be used primerely for the analysis","3c21e1c7":"# Suicide Rates EDA Conclusions:\n1. Men commit 3.5 times more suicides than women\n2. Overall number of suicides is declining as time progresses\n3. Correlation of -0.4 between GDP_per_capita and suicide\/100k has been established\n4. Number of suisides increases with aging","f6d25c4d":"Approximately 11 % of data has been removed due to outliers in suicides\/100k population and gdp_per_capita features ","0eed40f6":"# 2.4 Evolution of suicide rate by Sex, Age, and Generation \nQuestions: \n1. How does the evolution of suicide look like for men and women? Any spikes in the time series ?\n2. How does the evolution of suicide look like for age groups and generations  ? Any similarities between time series ?\n3. What the overal suicide evolution trends ?\n4. Is there any anomalies present ?\n\nMethod:**\n1. Visually inspect plot both Suicide\/100k and GDP_per_capita as a function of years ","41dd5ebf":"* Data looks much less skewed after IQR method was applied\n* In order to look for a trend and correaltion, lets merge two filtered data frames ","3ec5867c":"# 3.1 Data Preparation ","807ad039":"* It looks like only 14 out of 101 countries are present(recorded) in 2016 in filtered data set, hence the spike in suicide rate can be ignored"}}