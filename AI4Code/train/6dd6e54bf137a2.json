{"cell_type":{"82e385f4":"code","0d36f9da":"code","481aa48c":"code","87882cd3":"code","57b21884":"code","191b2c58":"code","f5d8e342":"code","09e67411":"code","fbd556b7":"code","eecb8ec1":"code","6d8fa04e":"code","b172aa38":"code","f4cced94":"code","1e3443d1":"code","9d8d15b8":"code","2024f968":"code","7dfef8ac":"code","d66195fc":"code","b94889fc":"code","a55be1f4":"code","d3af9d16":"code","2c0b0794":"markdown","bb91a8b9":"markdown","b0e95dc8":"markdown","726411c4":"markdown","ea770c04":"markdown","d0ac8727":"markdown","f2168ed9":"markdown"},"source":{"82e385f4":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport warnings\n\nwarnings.filterwarnings('ignore')\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","0d36f9da":"#Importing the data\n\ndata = pd.read_csv('..\/input\/heart.csv')\n\ndata.head(10)","481aa48c":"# getting the columns in the dataset\n\ndata.columns","87882cd3":"#exploring the data statistically\n\ndata.describe()","57b21884":"# Understanding the influence of Age on heart diseases, coupled with gender\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nplt.figure(1, figsize = (15,6))\nn = 0\nfor gender in [0,1]:\n    n = n + 1\n    plt.subplot(1,2, n)\n    plt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n    for c in range(0,4):\n        sns.distplot(data['age'][data['cp'] == c][data['sex'] == gender], \n                     hist = False, rug = True, label = 'Type {} chest pain'.format(c))\n    plt.title('Age distribution plot for different types of heart disease wrt {}'.\n              format('Male' if gender == 0 else 'Female'))\nplt.legend()\nplt.show()                    ","191b2c58":"# Visualizing the distribution of parameter values wrt presence of heart disease\n\nparam = ['trestbps', 'chol', 'thalach','oldpeak']\n\nplt.figure (1, figsize = (15,10))\nn = 0\nfor p in param:\n    n = n + 1\n    plt.subplot(2,2, n)\n    plt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n    for ctype in range(0,4):\n            sns.distplot(data[p][data['cp'] == ctype], \n                     hist = False, rug = True, label = \"{} type pain\".format(ctype))\n    plt.title(\"Distribution plot for {} wrt to type of Heart disease\".format(p))\nplt.legend()\nplt.show() ","f5d8e342":"# Determining the influence of gender on heart diseases using the same parameters\n\nparam = ['trestbps', 'chol', 'thalach','oldpeak'] \n\nplt.figure (1, figsize = (25,15))\nn = 0\nfor p in param:\n    for gender in [0, 1]:\n        n = n + 1\n        plt.subplot(4,2, n)\n        plt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n        for ctype in range(0,4):\n            sns.distplot(data[p][data['cp'] == ctype][data['sex'] == gender], \n                     hist = False, rug = True, label = \"{} type pain\".format(ctype))\n        plt.title(\"Distribution plot for {} wrt to type of Heart disease in {}\".\n                  format(p, 'Male' if gender == 0 else 'Female'))\nplt.legend()\nplt.show()","09e67411":"# Visualizing the count plots of the different categorical variables wrt of gender and chest pain type\nparam = ['fbs', 'restecg','exang', 'slope', 'ca', 'thal']\n\nplt.figure(1, figsize = (15,6))\nn = 0\n#for p in param:\n#for cp in range(0,4):\n    \nfor gender in [0, 1]:\n    #n = n + 1 \n    #plt.subplot(1,2, n)\n    #plt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n    \n    pd.crosstab(data['cp'][data['sex'] == gender],\n                data[param[0]][data['sex'] == gender]).plot(kind=\"bar\", figsize = (5,5))\n    plt.xlabel('Chest Pain')\n    plt.ylabel('Count')\n    plt.title('Bar plot of {} for {} wrt chest pain type'.format(param[0], 'Male' if gender == 0 else 'Female'))","fbd556b7":"# Visualizing the count plots of the different categorical variables wrt of gender and chest pain type\nparam = ['fbs', 'restecg','exang', 'slope', 'ca', 'thal']\n\nplt.figure(1, figsize = (15,6))\nn = 0\n#for p in param:\n#for cp in range(0,4):\n    \nfor gender in [0, 1]:\n    n = n + 1\n    pd.crosstab(data['cp'][data['sex'] == gender],\n                data[param[1]][data['sex'] == gender]).plot(kind=\"bar\", figsize = (5,5))\n    plt.xlabel('Chest Pain')\n    plt.ylabel('Count')\n    plt.title('Bar plot of {} for {} wrt chest pain type'.format(param[1], 'Male' if gender == 0 else 'Female'))","eecb8ec1":"# Visualizing the count plots of the different categorical variables wrt of gender and chest pain type\nparam = ['fbs', 'restecg','exang', 'slope', 'ca', 'thal']\n\nplt.figure(1, figsize = (15,6))\nn = 0\n#for p in param:\n#for cp in range(0,4):\n    \nfor gender in [0, 1]:\n    n = n + 1\n    pd.crosstab(data['cp'][data['sex'] == gender],\n                data[param[2]][data['sex'] == gender]).plot(kind=\"bar\", figsize = (5,5))\n    plt.xlabel('Chest Pain')\n    plt.ylabel('Count')\n    plt.title('Bar plot of {} for {} wrt chest pain type'.format(param[2], 'Male' if gender == 0 else 'Female'))","6d8fa04e":"# Visualizing the count plots of the different categorical variables wrt of gender and chest pain type\nparam = ['fbs', 'restecg','exang', 'slope', 'ca', 'thal']\n\nplt.figure(1, figsize = (15,6))\nn = 0\n#for p in param:\n#for cp in range(0,4):\n    \nfor gender in [0, 1]:\n    n = n + 1\n    pd.crosstab(data['cp'][data['sex'] == gender],\n                data[param[3]][data['sex'] == gender]).plot(kind=\"bar\", figsize = (5,5))\n    plt.xlabel('Chest Pain')\n    plt.ylabel('Count')\n    plt.title('Bar plot of {} for {} wrt chest pain type'.format(param[3], 'Male' if gender == 0 else 'Female'))","b172aa38":"# Visualizing the count plots of the different categorical variables wrt of gender and chest pain type\nparam = ['fbs', 'restecg','exang', 'slope', 'ca', 'thal']\n\nplt.figure(1, figsize = (15,6))\nn = 0\n#for p in param:\n#for cp in range(0,4):\n    \nfor gender in [0, 1]:\n    n = n + 1\n    pd.crosstab(data['cp'][data['sex'] == gender],\n                data[param[4]][data['sex'] == gender]).plot(kind=\"bar\", figsize = (5,5))\n    plt.xlabel('Chest Pain')\n    plt.ylabel('Count')\n    plt.title('Bar plot of {} for {} wrt chest pain type'.format(param[4], 'Male' if gender == 0 else 'Female'))","f4cced94":"# Visualizing the count plots of the different categorical variables wrt of gender and chest pain type\nparam = ['fbs', 'restecg','exang', 'slope', 'ca', 'thal']\n\nplt.figure(1, figsize = (15,6))\nn = 0\n#for p in param:\n#for cp in range(0,4):\n    \nfor gender in [0, 1]:\n    n = n + 1\n    pd.crosstab(data['cp'][data['sex'] == gender],\n                data[param[5]][data['sex'] == gender]).plot(kind=\"bar\", figsize = (5,5))\n    plt.xlabel('Chest Pain')\n    plt.ylabel('Count')\n    plt.title('Bar plot of {} for {} wrt chest pain type'.format(param[5], 'Male' if gender == 0 else 'Female'))","1e3443d1":"_middleAge = data [data['age'] <=55][data['age'] >35]\nprint(\n    \"There are {} no of entries that belong to the asset population, out of {} total entries\".\n    format(_middleAge.shape, data.shape))\n_middleAge.head()","9d8d15b8":"# count plot of the types of heart disease they selected popuation have, wrt gender\n\nplt.figure(1, figsize = (15,6))\nn = 0\nfor gender in [0,1]:\n    n = n + 1\n    plt.subplot(1,2, n)\n    plt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n    sns.countplot(x = 'cp', data = _middleAge[_middleAge['sex'] == gender])\n    plt.title('Count plot of Chest pain type in {}'.format('Male' if gender == 0 else 'Female'))\nplt.show()","2024f968":"# Visualizing the effect of having oldpeak < 2 and thalach > 150\nparam = ['oldpeak', 'thalach']\n\n_middleAge_men = _middleAge[_middleAge['sex'] == 0]\n\nplt.figure (1, figsize = (15,6))\n\nplt.subplot( 2, 2, 1)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nfor cp in range(0,4):\n    sns.distplot(_middleAge_men['oldpeak'][_middleAge_men['oldpeak'] < 2]\n                 [_middleAge_men['cp'] == cp], hist = False, rug = True,\n                label = \"Type {} heart disase\".format(cp))\nplt.title(\"Probability distribution of oldpeak < 2 for males wrt chest pain type\")\nplt.subplot( 2, 2, 2)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nfor cp in range(0,4):\n    sns.distplot(_middleAge_men['thalach'][_middleAge_men['thalach'] > 150]\n                 [_middleAge_men['cp'] == cp], hist = False, rug = True,\n                label = \"Type {} heart disase\".format(cp))\nplt.title(\"Probability distribution of thalach > 150 for males wrt chest pain type\")\n\nplt.subplot( 2, 2, 3)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_men[_middleAge_men['oldpeak'] < 2]) \nplt.title(\"Count plot of oldpeak < 2 for males wrt chest pain type\")\n\nplt.subplot( 2, 2, 4)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_men[_middleAge_men['thalach'] > 150])\nplt.title(\"Count plot of thalach > 150 for males wrt chest pain type\")\n\n#plt.subplot( 2, 2, 4)\n#plt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nplt.show()","7dfef8ac":"# visualizing [fbs = 0, resteccg = {0,1} , exang = 0, slope = 1, ca = 0, thal = 2] in male\nplt.figure (1, figsize = (12,10))\n\nplt.subplot( 3, 2, 1)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_men[_middleAge_men['fbs'] == 0])\nplt.title(\"Count plot of fbs = 0 for males wrt chest pain type\")\n\n\nplt.subplot( 3, 2, 2)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_men[_middleAge_men['restecg'] <= 1])\nplt.title(\"Count plot of restecg = {0,1} for males wrt chest pain type\")\n\n\nplt.subplot( 3, 2, 3)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_men[_middleAge_men['exang'] == 0])\nplt.title(\"Count plot of exang = 0 for males wrt chest pain type\")\n\n\nplt.subplot( 3, 2, 4)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_men[_middleAge_men['slope'] == 1])\nplt.title(\"Count plot of slope = 1 for males wrt chest pain type\")\n\n\nplt.subplot( 3, 2, 5)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_men[_middleAge_men['ca'] == 0])\nplt.title(\"Count plot of ca = 0 for males wrt chest pain type\")\n\n\nplt.subplot( 3, 2, 6)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_men[_middleAge_men['thal'] == 2])\nplt.title(\"Count plot of thal = 2 for males wrt chest pain type\")","d66195fc":"# similar visualizations for females\n# Visualizing the effect of having oldpeak < 2 and thalach > 150\nparam = ['oldpeak', 'thalach']\n\n_middleAge_women = _middleAge[_middleAge['sex'] == 1]\n\nplt.figure (1, figsize = (15,6))\n\nplt.subplot( 2, 2, 1)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nfor cp in range(0,4):\n    sns.distplot(_middleAge_women['oldpeak'][_middleAge_women['oldpeak'] < 2]\n                 [_middleAge_women['cp'] == cp], hist = False, rug = True,\n                label = \"Type {} heart disase\".format(cp))\nplt.title(\"Probability distribution of oldpeak < 2 for females wrt chest pain type\")\nplt.subplot( 2, 2, 2)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nfor cp in range(0,4):\n    sns.distplot(_middleAge_women['thalach'][_middleAge_women['thalach'] > 150]\n                 [_middleAge_women['cp'] == cp], hist = False, rug = True,\n                label = \"Type {} heart disase\".format(cp))\nplt.title(\"Probability distribution of thalach > 150 for females wrt chest pain type\")\n\nplt.subplot( 2, 2, 3)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_women[_middleAge_women['oldpeak'] < 2]) \nplt.title(\"Count plot of oldpeak < 2 for females wrt chest pain type\")\n\nplt.subplot( 2, 2, 4)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_women[_middleAge_women['thalach'] > 150])\nplt.title(\"Count plot of thalach > 150 for females wrt chest pain type\")\n\n#plt.subplot( 2, 2, 4)\n#plt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nplt.show()","b94889fc":"# visualizing [fbs = 0, resteccg = {0,1} , exang = 0, slope = 1, ca = 0, thal = 2] in female\nplt.figure (1, figsize = (12,10))\n\nplt.subplot( 3, 2, 1)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_women[_middleAge_women['fbs'] == 0])\nplt.title(\"Count plot of fbs = 0 for females wrt chest pain type\")\n\n\nplt.subplot( 3, 2, 2)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_women[_middleAge_women['restecg'] <= 1])\nplt.title(\"Count plot of restecg = {0,1} for females wrt chest pain type\")\n\n\nplt.subplot( 3, 2, 3)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_women[_middleAge_women['exang'] == 0])\nplt.title(\"Count plot of exang = 0 for females wrt chest pain type\")\n\n\nplt.subplot( 3, 2, 4)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_women[_middleAge_women['slope'] == 1])\nplt.title(\"Count plot of slope = 1 for females wrt chest pain type\")\n\n\nplt.subplot( 3, 2, 5)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_women[_middleAge_women['ca'] == 0])\nplt.title(\"Count plot of ca = 0 for females wrt chest pain type\")\n\n\nplt.subplot( 3, 2, 6)\nplt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n\nsns.countplot(x = 'cp', data = _middleAge_women[_middleAge_women['thal'] == 2])\nplt.title(\"Count plot of thal = 2 for females wrt chest pain type\")","a55be1f4":"#Generating heat map between the given set of attributes\nplt.figure (1, figsize = (15,10))\nsns.heatmap(_middleAge_men.corr(), annot = True, cmap = 'Reds')","d3af9d16":"# creating dummy variables for categorical variables\n# we have the following categorical variables : fbs, restecg, exang, ca, thal, slope\n_middleAge_men","2c0b0794":"The above analysis provides us with much needed information regarding the parameters which causes the most common type-2 heart diseases in asset population. We have considered the following parameters (without the constrains):\n**FOR MALES**\n1. oldpeak, thalach among continuous variables\n2. fbs, resteccg, exang, slope, ca, thal among catgorical variables\n**FOR FEMALES**\n1. trestbps, chol, thalach in continuous variables\n2. restecg exang, slope, ca, thal in categorical variables\n\nFirst, we would create a prediction model to determine if the a person *within the asset population* would suffer from type-2 heart disease or not\nWe would use the following models, and would tally their accuracy:\n1. Decision tree: Random forest\n2. Logistic regression.","bb91a8b9":"From the above visualizations, the following basic inferences can be drawn:\n1. Chest pain can be caused by all of the 4 parameters mentioned above, having more or less influence of the type of chest pains\n2. A visibly large proportion of **Men** having **trestbps** value between 140-160 and **chol** value between 200-300 suffers from type-3 chest pain. Similarly, a visibly large proportion of **Women** having **oldpeak** value less than 1 experiences from type-1 chest pain.\n3. The distributions graphs show vastly different reasult for male and female, meaning that **GENDER** have a profound impact on the cause of heart diseases. Also, the **chances and the types of chest pains** experienced by patients also differ vastly across the two genders.\n4. Age also plays an important role in determining the *type* of disease.\n5. A large propotion of **Men** of age 40-60 suffers mostly from type-3 heart disease, but, a similar proportion of men of the same age group have no heart disases at all. \n6. **Women** mostly don't suffer from any heart diseaes, however, some experience type-2 and type-1 heart diseases at the age of 40-60. Also, type-3 heart diseases are experienced by females in some proportions after the age of 60.\n7. Any discussion about heart diseases and it's causes, without considering **gender** as a factor is erroneous. ","b0e95dc8":"The above visualization confirms our assertion of the assumed parametes causing heart diseases among our **asset population** . We, hence create a heatmap and study the co-relation between each of the parameters, for better analysis.","726411c4":"**HOW SICK IS OUR WORKING POPULATION???**\n*Is the experienced working population having worrysome problems with their heart? LEt's find out*\nThe average US person retires at the age 60-62. We will consider that the people of the age range 36-55 consitute the most productive people, because they are *the perfect blend of experience and productivity*, henceforth mentioned as *\"asset populaiton\"*. But, what is the health condition of these *assets population* ? Are their heart healthy? If not, what causes this unhealthiness? The answer to these questions is essential. Let's find out.\n\nLet us now look into the major kinds of heart disases and their casuses that affect the asset population. We would analyse the heart disease of middle aged people ( 36 < age < 55 )","ea770c04":"The plot shows that most of the asset MALE population suffers from type-2 heart disease, which is alarming. On the other hand, the FEMALE asset population mostly have no heart disease, and yet a considerable portion suffers from type-2 heart disease. However, MALE population doesn't have a single case of type-3 heart disease, yet FEMALES have a little but noticalble propotion of type-3 heart diseases. \n\nOne thing is clear, our *asset population* is quite **sick**, with nearly **50% MALES** and nearly **30% FEMALES** suffering from type-2 heart diseases.\n\nTo understand the situation more, we need to know the exact causes which create such heart diseases. For that, we refer to our earlier visualizations. We can consider the following parameters:\n1. Certain range of values in [oldpeak < 2, thalach > 150] in MALES and [trestbps, chol, thalach] in FEMALES are known to cause type-2 heart diseases.\n2. [fbs = 0, resteccg = {0,1} , exang = 0, slope = 1, ca = 0, thal = 2] in MALES and [restecg = {0,1} exang = 0, slope={0,1}, ca = 0, thal = 2 ] in FEMALEs might be considered the parameters for causing type - 2 heart diseaes. \n\nWe can use these paramters to train a classification algorithm to detect the chances of a chest pain in a member of the asset population.","d0ac8727":"With an attempt to explain the cause of heart attacks, this notebook explores the major parameters that increases the chances of a heart attack in a human being. Also, the notebook defines a module to detect the chances of a person having a heart attack.\nThis notebook dwells on these basic questions:\n1. Is age and gender really a determining factor for heart diseaes?\n2. What are the bodily factors that causes heart diseases.\n3. Can we predict the chances of a heart disease in a person? If so, how reliable would it be?","f2168ed9":"A lot of visualizations have been created above, all of which have their own set of information to tell:\n\n1. fbs = 0 value is equally indicative of **no heart disease or type-2 heart disease** in *MALE*, but in *FEMALE*, the same is indicative of **no heart diseases* at all\n2. restecg = 1 value is indicative of **no heart disease or type-2 heart disease** in *MALE*, but in *FEMALE*, the same is more indicative of **no heart diseases**. The same goes for restecg = 0\n3. exang = 0 is highly indicative of **type-2 heart disease** in *MALE*, whereas exang = 1 is indicative of **no heart disease** in *FEMALE*\n4. slope = 1 is highly indicative of **no heart disease** in both *MALE* and *FEMALE*, whereas slope= 2 is indicative of **type- 2 heart disease** in *MALE* and **no heart disease** in *FEMALE*\n5. ca = 0 is equally indicative of **type-2 heart disease** or **no heart disease** in *MALE* \n6. thal = 2 is indicative of **type-2 heart disease** and somewhat indicative of **no heart disease** in *MALE*, but in *FEMALE* thal = 3 is highly indicative of **no heart disease** \n"}}