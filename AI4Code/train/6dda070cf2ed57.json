{"cell_type":{"21d9ab19":"code","b99efb63":"code","5e722f97":"code","51e552c9":"code","55b986b2":"code","c5688eb2":"code","3ce1c101":"markdown","96ec7460":"markdown","54aa59d0":"markdown","a052ec2c":"markdown","f8a64771":"markdown","dca3ed68":"markdown","31c24b97":"markdown","9588e2f4":"markdown","c6c884b6":"markdown"},"source":{"21d9ab19":"# BigQuery\nfrom google.cloud import bigquery\nbigquery_client = bigquery.Client(project='divine-engine-315105')\n\n# Cloud Storage\nfrom google.cloud import storage\nstorage_client = storage.Client(project='divine-engine-315105')\n\ndataset_ref = bigquery_client.dataset(\"SmartDeviceUsage\", project=\"divine-engine-315105\")\ndataset = bigquery_client.get_dataset(dataset_ref)\n\ntable_ref = dataset_ref.table(\"SleepDay_Cleaned\")\ntable = bigquery_client.get_table(table_ref)\n","b99efb63":"query = \"\"\"\n        SELECT \n            COUNT(DISTINCT Id) AS NumOfID,\n            MIN(ActivityDay) AS EarliestDate,\n            MAX(ActivityDay) AS LatestDate,\n            AVG(Calories) AS AverageCalories,\n            MAX(Calories) AS MaxCalories,\n            MIN(Calories) AS MinCalories\n        FROM `divine-engine-315105.SmartDeviceUsage.DailyCalories` \n        \"\"\"\n\nquery_job = bigquery_client.query(query)\nsummary = query_job.to_dataframe()\nsummary.head()","5e722f97":"query = \"\"\"\n        SELECT \n            AVG(TotalTimeInBed-TotalMinutesAsleep) AS AverageMinutesToFallAsleep,\n            MAX(TotalTimeInBed-TotalMinutesAsleep) AS MaxMinutesToFallAsleep,\n            MIN(TotalTimeInBed-TotalMinutesAsleep) AS MinMinutesToFallAsleep,\n            AVG(TotalMinutesAsleep\/TotalTimeInBed)*100 AS PercentAsleep \n        FROM `divine-engine-315105.SmartDeviceUsage.SleepDay_Cleaned` \n        \"\"\"\n\nquery_job = bigquery_client.query(query)\nsummary = query_job.to_dataframe()\nsummary.head()","51e552c9":"query = \"\"\"\n        SELECT \n            Calories.Id AS ID,\n            Calories.ActivityDay AS Date,\n            Calories.Calories AS DailyCaloriesBurned,\n            SleepTime.TotalMinutesAsleep,\n            SleepTime.TotalTimeInBed,\n            (SleepTime.TotalTimeInBed-SleepTime.TotalMinutesAsleep) AS MinutesToFallAsleep,\n            (SleepTime.TotalMinutesAsleep\/SleepTime.TotalTimeInBed)*100 AS PercentTimeAsleepInBed\n        FROM \n            `divine-engine-315105.SmartDeviceUsage.DailyCalories` AS Calories\n        INNER JOIN\n            `divine-engine-315105.SmartDeviceUsage.SleepDay_Cleaned` AS SleepTime\n        ON\n            Calories.Id = SleepTime.Id\n        WHERE\n            Calories.ActivityDay=SleepTime.SleepDay\n        \"\"\"\n\nquery_job = bigquery_client.query(query)\nsummary = query_job.to_dataframe()\nsummary.head()","55b986b2":"query = \"\"\"\n        SELECT \n            Weight.Id,\n            Weight.Date,\n            Weight.WeightKg,\n            Weight.BMI,\n            SleepTime.TotalMinutesAsleep,\n            SleepTime.TotalTimeInBed,\n            (SleepTime.TotalTimeInBed-SleepTime.TotalMinutesAsleep) AS MinutesToFallAsleep,\n            (SleepTime.TotalMinutesAsleep\/SleepTime.TotalTimeInBed)*100 AS PercentTimeAsleepInBed\n        FROM \n            `divine-engine-315105.SmartDeviceUsage.WeightLogInfo_Cleaned` AS Weight\n        INNER JOIN\n            `divine-engine-315105.SmartDeviceUsage.SleepDay_Cleaned` AS SleepTime\n        ON\n            Weight.Id = SleepTime.Id\n        WHERE\n            CAST(Weight.Date AS DATE)=SleepTime.SleepDay\n        \"\"\"\n\nquery_job = bigquery_client.query(query)\nsummary = query_job.to_dataframe()\nsummary.head()","c5688eb2":"query = \"\"\"\n        SELECT \n            Calories.Id AS ID,\n            Calories.ActivityDay AS Date,\n            Calories.Calories AS DailyCaloriesBurned,\n            SleepTime.TotalMinutesAsleep,\n            SleepTime.TotalTimeInBed,\n            (SleepTime.TotalTimeInBed-SleepTime.TotalMinutesAsleep) AS MinutesToFallAsleep,\n            (SleepTime.TotalMinutesAsleep\/SleepTime.TotalTimeInBed)*100 AS PercentTimeAsleepInBed,\n            Weight.WeightKg,\n            Weight.BMI\n        FROM \n            `divine-engine-315105.SmartDeviceUsage.DailyCalories` AS Calories\n        INNER JOIN\n            `divine-engine-315105.SmartDeviceUsage.SleepDay_Cleaned` AS SleepTime\n        ON\n            Calories.Id = SleepTime.Id\n        INNER JOIN \n            `divine-engine-315105.SmartDeviceUsage.WeightLogInfo_Cleaned` AS Weight\n        ON\n            Calories.Id = Weight.Id\n        WHERE\n            Calories.ActivityDay=SleepTime.SleepDay\n            AND Calories.ActivityDay=CAST(Weight.Date AS Date)\n        \"\"\"\n\nquery_job = bigquery_client.query(query)\nsummary = query_job.to_dataframe()\nsummary.head()","3ce1c101":"Join **\u201cdailyCalories_merged.csv\u201d**, **\"weightLogInfo_merged_cleaned.csv\"**  and **\"sleepDay_merged_cleaned.csv\"**. ","96ec7460":"Quick analysis with mean, maximum and minimum values for variables and the number of distinct IDs.","54aa59d0":"A little more complicated analysis with mean, maximum and minimum values for calculated variables and calculated proportion.","a052ec2c":"# Join Tables\n\nThe following codes were used to join the chosen tables so that they can be further analyzed and visualized on R.\n\nJoin **\u201cdailyCalories_merged.csv\u201d**  and **\"sleepDay_merged_cleaned.csv\"**. ","f8a64771":"Join **\"weightLogInfo_merged_cleaned.csv\"**  and **\"sleepDay_merged_cleaned.csv\"**. ","dca3ed68":"Refer back to the [original notebook](https:\/\/www.kaggle.com\/kumakumakumada\/capstone-project-google-data-analytics-certificate) for the next step, visualization.","31c24b97":"## Phase: Analyze\n\n\n# Calculation\n\n\nThe following codes were used to analyze the given dataset.\n\n\n\nSet up environment.","9588e2f4":"The above query codes were repeatedly used for the remaining tables.\nRefer back to the [original notebook](https:\/\/www.kaggle.com\/kumakumakumada\/capstone-project-google-data-analytics-certificate) for summaries of analysis.","c6c884b6":"# SQL Codes\n\nThis notebook contains SQL codes used for Capstone Project.\nLanguage is set to Python here.\nGoogle BigQuery was used to analyze cleaned dataset and join tables. "}}