{"cell_type":{"890a3078":"code","12abc65c":"code","6dd1edee":"code","b5823cc9":"code","15ab6466":"code","270ffa9f":"code","20b373db":"code","51c730b0":"code","fb1cab10":"code","35ce5ca3":"code","da754af7":"code","02c8d39c":"code","d0489d2c":"code","8acf35cc":"code","dea19b01":"code","d6084f0a":"code","aa9e3ad3":"code","9e6e8f2f":"code","bd7356e2":"code","fd02b5d7":"code","e15608ff":"code","fe86c60c":"code","12eb7a39":"code","13d8e0e7":"code","f3c15910":"code","7022cfee":"code","2a78d8fa":"code","c823ed09":"code","310e97ef":"code","d93b1338":"code","87fef1a1":"code","d1eb2f4e":"code","49fa990a":"code","3ebc6ad4":"code","33505823":"code","ba11a820":"code","50baceaf":"code","86334ea7":"code","aaac4135":"code","188d3423":"code","e1d3c51a":"code","b612c370":"code","7d6661dd":"code","aea1228e":"code","871975c2":"code","8980ce27":"code","d0e98e94":"code","71b5c73f":"code","d95c77c8":"code","14399950":"code","9ad81aa3":"code","49ae4710":"code","36ab0b13":"code","2d21284f":"code","e441a044":"code","3cb80567":"code","ced92a0c":"code","785133c7":"code","ff5b8e78":"code","c6c50ca8":"code","19093913":"code","e8def8cb":"code","cdbceaaa":"code","b9cf2103":"code","de9c7590":"code","105e9b00":"code","ac838448":"code","2e00bf2d":"code","1375ab46":"code","7bd45601":"code","5f15ed21":"code","7e4657ca":"code","15d3652e":"code","10d3cf35":"code","3f8c489c":"code","422bb684":"code","bbc7b52f":"code","173e618f":"code","0ec76ec9":"code","48eedcf7":"code","765f0c69":"code","2a329402":"code","6a602fd2":"code","048c0b2a":"code","5a4eea44":"code","77344eb2":"code","a01661a3":"code","a5765fa3":"code","f772ad1a":"code","cf312f22":"code","ab12c201":"code","5a726258":"code","036c31f8":"code","24c64729":"code","8580f2ce":"code","184445fa":"code","881b51ca":"markdown","66995b5a":"markdown","3beca78c":"markdown","184fe350":"markdown","13e6a238":"markdown","301795cd":"markdown","ac0655fb":"markdown","549c704a":"markdown","a5e35b5a":"markdown","0f318756":"markdown","ee5e652a":"markdown","4d9ba933":"markdown","622fa46f":"markdown","962d9ba4":"markdown","910a0021":"markdown","e3cfb8c0":"markdown","18d0a3d4":"markdown"},"source":{"890a3078":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom warnings import filterwarnings\nfilterwarnings('ignore')","12abc65c":"Data=pd.read_csv('..\/input\/used-car-dataset-ford-and-mercedes\/merc.csv')","6dd1edee":"Data.head()","b5823cc9":"Data.info()","15ab6466":"Data.isna().sum()","270ffa9f":"print('Model unique values: ',len(Data['model'].unique()))\nprint(Data['model'].unique())","20b373db":"plt.figure(figsize=(25,8))\nsns.countplot(Data['model'])\nplt.show()","51c730b0":"plt.figure(figsize=(25,8))\nsns.countplot(Data['year'])\nplt.show()","fb1cab10":"print('Transmission unique: ',len(Data['transmission'].unique()))\nprint(Data['transmission'].unique())","35ce5ca3":"sns.countplot(Data['transmission'])\nplt.show()","da754af7":"print('Fuelt type unique values: ',len(Data['fuelType'].unique()))\nprint(Data['fuelType'].unique())","02c8d39c":"sns.countplot(Data['fuelType'])\nplt.show()","d0489d2c":"Data['engineSize'].value_counts()","8acf35cc":"plt.figure(figsize=(13,8))\nsns.countplot(Data['engineSize'])\nplt.show()","dea19b01":"plt.figure(figsize=(15,8))\nsns.countplot(Data['tax'])\nplt.show()","d6084f0a":"Data['price'].describe()","aa9e3ad3":"Data['price'][Data['price']>100000]","9e6e8f2f":"Data['fuelType'][Data['fuelType']=='Other']","bd7356e2":"Data['year'][Data['year']<2000]","fd02b5d7":"New_Data=Data.copy().drop(index=Data['price'][Data['price']>100000].index.tolist()+Data['fuelType'][Data['fuelType']=='Other'].index.tolist()+Data['year'][Data['year']<2000].index.tolist()+Data['transmission'][Data['transmission']=='Other'].index.tolist())","e15608ff":"New_Data.info()","fe86c60c":"data_model_dummies=pd.get_dummies(New_Data['model'])","12eb7a39":"data_model_dummies","13d8e0e7":"transmission_dummies=pd.get_dummies(New_Data['transmission'])","f3c15910":"transmission_dummies","7022cfee":"fueltype_dummies=pd.get_dummies(New_Data['fuelType'])","2a78d8fa":"fueltype_dummies","c823ed09":"New_Data=New_Data.drop(columns=(['fuelType','transmission','model']))  ","310e97ef":"New_Data.head()","d93b1338":"New_Data=pd.concat(([data_model_dummies,New_Data.iloc[:,:2],transmission_dummies,New_Data.iloc[:,2:3],fueltype_dummies,New_Data.iloc[:,3:]]),axis=1)","87fef1a1":"New_Data","d1eb2f4e":"x=New_Data.copy().drop(columns='price')","49fa990a":"x.head()","3ebc6ad4":"y=New_Data.copy().pop('price')","33505823":"y.head()","ba11a820":"from sklearn.model_selection import train_test_split","50baceaf":"x_array=x.values\ny_array=y.values","86334ea7":"x_array","aaac4135":"y_array","188d3423":"x_train,x_val,y_train,y_val=train_test_split(x_array,y_array,test_size=0.10,random_state=42) ","e1d3c51a":"x_train.shape","b612c370":"y_train.shape","7d6661dd":"x_val.shape","aea1228e":"y_val.shape ","871975c2":"x_train,x_test,y_train,y_test=train_test_split(x_train,y_train,test_size=0.20,random_state=42)","8980ce27":"x_train.shape","d0e98e94":"y_train.shape","71b5c73f":"x_test.shape","d95c77c8":"y_test.shape","14399950":"from sklearn.preprocessing import StandardScaler","9ad81aa3":"obje_ss=StandardScaler()\n\nx_train_ss=obje_ss.fit_transform(x_train)\nx_val_ss=obje_ss.fit_transform(x_val)\nx_test_ss=obje_ss.fit_transform(x_test)","49ae4710":"x_train","36ab0b13":"x_train_ss","2d21284f":"from sklearn.metrics import r2_score","e441a044":"from sklearn.linear_model import LinearRegression","3cb80567":"model_le=LinearRegression().fit(x_train,y_train)\nmodel_le","ced92a0c":"y_pred=model_le.predict(x_val)","785133c7":"print('Train success rate : %',model_le.score(x_train,y_train)*100)\nprint('Validation success rate : %',r2_score(y_val,y_pred))","ff5b8e78":"y_pred[y_pred<0] # Linearregression outliner data predict is so bad  ","c6c50ca8":"from sklearn.svm import SVR","19093913":"model_svr=SVR(kernel='linear',degree=3).fit(x_train_ss,y_train)\nmodel_svr","e8def8cb":"y_pred=model_svr.predict(x_val_ss) ","cdbceaaa":"print('Train success rate : %',model_svr.score(x_train_ss,y_train)*100)\nprint('Validation success rate : %',r2_score(y_val,y_pred)*100)","b9cf2103":"from sklearn.preprocessing import PolynomialFeatures","de9c7590":"obje_poly=PolynomialFeatures(degree=2)\n\nx_train_poly=obje_poly.fit_transform(x_train)\nx_val_poly=obje_poly.fit_transform(x_val)\nx_test_poly=obje_poly.fit_transform(x_test)","105e9b00":"model_poly=LinearRegression(n_jobs=-1).fit(x_train_poly,y_train)\nmodel_poly","ac838448":"y_pred=model_poly.predict(x_val_poly)","2e00bf2d":"print('Train success rate : %',model_poly.score(x_train_poly,y_train)*100)\nprint('Validation success rate : %',r2_score(y_val,y_pred)*100)","1375ab46":"y_pred[y_pred<0] #Outliner Data ","7bd45601":"from sklearn.ensemble import RandomForestRegressor","5f15ed21":"model_rfr=RandomForestRegressor(n_estimators=100,n_jobs=-1,random_state=42).fit(x_train_ss,y_train)\nmodel_rfr","7e4657ca":"y_pred=model_rfr.predict(x_val_ss)","15d3652e":"print('Train success rate : %',model_rfr.score(x_train_ss,y_train)*100)\nprint('Validation success rate : %',r2_score(y_val,y_pred)*100)","10d3cf35":"from sklearn.ensemble import AdaBoostRegressor","3f8c489c":"model_ada=AdaBoostRegressor(n_estimators=10,random_state=42).fit(x_train_ss,y_train)\nmodel_ada","422bb684":"y_pred=model_ada.predict(x_val_ss) ","bbc7b52f":"print('Train success rate : %',model_ada.score(x_train_ss,y_train)*100)\nprint('Validation success rate : %',r2_score(y_val,y_pred)*100)","173e618f":"from xgboost import XGBRegressor","0ec76ec9":"model_xgb=XGBRegressor(max_depth=3,learning_rate=0.1,n_estimators=100,verbosity=0,random_state=42).fit(x_train,y_train)\nmodel_xgb","48eedcf7":"y_pred=model_xgb.predict(x_val) ","765f0c69":"print('Train success rate : %',model_xgb.score(x_train,y_train)*100)\nprint('Validation success rate : %',r2_score(y_val,y_pred)*100)","2a329402":"from lightgbm import LGBMRegressor","6a602fd2":"model_lgb=LGBMRegressor(max_depth=2,learning_rate=0.5,n_estimators=100,random_state=42).fit(x_train,y_train)\nmodel_lgb","048c0b2a":"y_pred=model_lgb.predict(x_val)","5a4eea44":"print('Train success rate : %',model_lgb.score(x_train,y_train)*100)\nprint('Validation success rate : %',r2_score(y_val,y_pred)*100)","77344eb2":"def test_models(model_name):\n\n  for i in model_name:\n    print(f'{i.__class__} | Test success rate : % {r2_score(y_test,i.predict(x_test))*100}')\n\ndef test_models_ss(model_name):\n\n   for a in model_name:\n    print(f'{a.__class__} Test success rate : % {r2_score(y_test,a.predict(x_test_ss))*100}')","a01661a3":"model_names=[model_le,model_xgb,model_lgb]\nmodel_names_ss=[model_rfr,model_svr,model_ada]","a5765fa3":"test_models(model_names)","f772ad1a":"test_models_ss(model_names_ss) ","cf312f22":"from sklearn.model_selection import cross_val_score","ab12c201":"model_names=[model_le,model_rfr,model_ada,model_xgb,model_lgb]","5a726258":"def test_models_cross(model_name):\n\n  for i in model_name:\n    print(f'{i.__class__} | Test(Cross validation) success rate : % {cross_val_score(i,X=x_train,y=y_train,cv=5,n_jobs=-1).mean()*100}')\n\ndef test_models_ss_cross(model_name):\n\n   for a in model_name:\n    print(f'{a.__class__} | Test(Cross validation)-ss success rate : % {cross_val_score(a,X=x_train_ss,y=y_train,cv=5,n_jobs=-1).mean()*100}')","036c31f8":"test_models_cross(model_names)","24c64729":"test_models_ss_cross(model_names)","8580f2ce":"print('Support vector regression cross-val success rate:',cross_val_score(model_svr,X=x_train_ss,y=y_train,cv=3,n_jobs=-1).mean()*100)","184445fa":"print('Polynomial regression cross-val success rate:',cross_val_score(model_poly,X=x_train_ss,y=y_train,cv=3,n_jobs=-1).mean()*100)","881b51ca":"### SupportVectorRegression","66995b5a":"## Data Analysis","3beca78c":"### validation","184fe350":"## Standart Scaler","13e6a238":"## Find values","301795cd":"### Test","ac0655fb":"## Data Preprocessing","549c704a":"### RandomForestRegressor","a5e35b5a":"### LinearRegression","0f318756":"## Models","ee5e652a":"## Cross-validation","4d9ba933":"## Train - Validation-Test","622fa46f":"### XGBoostRegressor","962d9ba4":"### AdaBoostRegressor","910a0021":"### LightGBM","e3cfb8c0":"### PolynomialRegression","18d0a3d4":"## Test"}}