{"cell_type":{"ea81955a":"code","02a1d427":"code","3816d12a":"code","2f357a8e":"code","3628ed2d":"code","d54989c6":"code","4dbce913":"code","e916b6dc":"code","d575bb65":"code","48afaccc":"code","38f50943":"code","109ff956":"code","602de05a":"code","d25a0205":"code","9e42a393":"code","85fe53b3":"code","a4fa8efa":"code","02908802":"code","f184700a":"code","2ed9c46e":"code","65954874":"code","6203407e":"code","93247c08":"code","b7137690":"code","88fd99f4":"code","2965e767":"code","bae38ca7":"code","5bd7e018":"code","909ae1fb":"code","ec16cce4":"code","babdf213":"code","1d10c42f":"code","109511f6":"code","e29487dd":"code","c8cb2c57":"code","7a9826e5":"code","26eb3468":"code","b5409f4c":"code","3462fd98":"code","b27a8e96":"code","28d81e7e":"code","3d16dd02":"code","f2ba6dfb":"code","e96e780b":"code","5e0ee0e3":"code","798ae0af":"code","8bcaae93":"code","582032ff":"code","fb02bda5":"code","8feba621":"code","4dda7c91":"code","b96f372d":"code","b6a2213b":"code","4aefc06d":"code","e62bcf2d":"code","e68a8468":"code","27d4282c":"code","013ac366":"markdown","f3773e13":"markdown","f3ee7cae":"markdown","1c19604d":"markdown","67363ffb":"markdown","257b63a1":"markdown","a711383e":"markdown","e4cf0844":"markdown","5294aaba":"markdown","710ebe6f":"markdown","1cf8d70f":"markdown","9c2813cf":"markdown","2dbff5b3":"markdown","93e763f1":"markdown","dc6e8ca2":"markdown","20255703":"markdown","e156fccf":"markdown","2eeb909f":"markdown","6acbd54c":"markdown","97b6c792":"markdown","06fba8e2":"markdown","df1a5298":"markdown","d1620e84":"markdown","a3d8be63":"markdown","b44dfb4f":"markdown","7642f7d7":"markdown","33bffab3":"markdown","63ae6fbe":"markdown","f9688da0":"markdown","36a241ea":"markdown","8125735b":"markdown","64f26fa7":"markdown","4a897407":"markdown","5035651f":"markdown","1235c03c":"markdown","1d75a8c3":"markdown","2aa6bc05":"markdown","30e8b1f1":"markdown","cea5ff64":"markdown","38e8431e":"markdown","0d93d9d6":"markdown","728f0ece":"markdown","0b1ff934":"markdown","8c5593c7":"markdown","9035e4f0":"markdown","e2abbe75":"markdown","f6445c05":"markdown","bfdefaaa":"markdown","28b6dde7":"markdown","2182aa98":"markdown","addbd744":"markdown","9292a9d6":"markdown","607f1751":"markdown"},"source":{"ea81955a":"# Load libraries\nimport pandas as pd\nimport numpy as np\n# Use the \"glob\" module to extract pathnames matching a specified pattern\nimport glob\nimport calendar\n# Visualization\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.express as px\n# Statistics\nfrom scipy import stats\n\n# import module we'll need to import our custom module\nfrom shutil import copyfile\n# copy our file into the working directory (make sure it has .py suffix)\nfrom functions_py import *","02a1d427":"# Load the \"covid_19_data\" dataset \ncovid_2019=pd.read_csv(\"..\/input\/novelcoronavirus2019dataset\/covid_19_data.csv\")\ncovid_2019.head()","3816d12a":"# Describes the continuous variables\ncovid_2019.describe()","2f357a8e":"# Actual data types\ncovid_2019.dtypes","3628ed2d":"## Transform the data type to the correct format\n# 'Last Update' and 'ObservationDate' to datetime\ncovid_2019['Last Update']=pd.to_datetime(covid_2019['Last Update'])\ncovid_2019['ObservationDate']=pd.to_datetime(covid_2019['ObservationDate'])\n# 'Confirmed','Deaths','Recovered' to int\ncovid_2019[['Confirmed','Deaths','Recovered']]=covid_2019[['Confirmed','Deaths','Recovered']].astype('int')\n# 'Province\/State' and 'Country\/Region' to category\ncovid_2019[['Province\/State','Country\/Region']]=covid_2019[['Province\/State','Country\/Region']].astype('category')\ncovid_2019.dtypes","d54989c6":"print('Some general facts about our data:')\nprint('=> The first day reported in our data was {}.'.format(min(covid_2019['Last Update'])))\nprint('=> While the last day included is {}.'.format(max(covid_2019['Last Update'])))\nprint('=> Our data resume the information of the coronavirus spread in {}'.format(max(covid_2019['Last Update']) - min(covid_2019['Last Update'])))\nprint('=> During these days, a total of {} Province\/States had reported at least one case of coronavirus.'.format(len(covid_2019['Province\/State'].unique())))\nprint('=> These Province\/States are distributed in {} countries or regions.'.format(len(covid_2019['Country\/Region'].unique())))","4dbce913":"# Extract the data of the last day\ncovid_2019_lastDay=covid_2019.loc[covid_2019['ObservationDate']==max(covid_2019['ObservationDate']),:]\ncovid_2019_lastDay.head()","e916b6dc":"# Compute the total number of cases by country\ncases_by_countries=covid_2019_lastDay.pivot_table(index=['Country\/Region'],\n                                                  values='Confirmed',\n                                                  aggfunc='sum').sort_values(by='Confirmed',\n                                                                             ascending=False)\nprint('The countries with more cases are:\\n {}'.format(cases_by_countries.head()))","d575bb65":"# Select the city with more cases in the 3 countries with more cases.\ncountries=['US', 'Italy','Spain']\nfunction = lambda country: covid_2019_lastDay.loc[covid_2019_lastDay['Country\/Region']==country,:].sort_values(by='Confirmed',\n                                                                             ascending=False).iloc[0,[2,5]]\n# Stores the results in a dictionary\nresult={country: list(function(country)) for country in countries}\nprint('The cities with more cases for each of the top countries are:\\n {}'.format(pd.DataFrame(result)))","48afaccc":"# Slice the dataset to show only the information relative to Italy \ncovid_2019.loc[covid_2019['Country\/Region']=='Italy',:].sort_values(by='Confirmed',\n                                                                             ascending=False).head()","38f50943":"# Drop all the information relative  to Italy from \"covid_2019\"\ncovid_2019=covid_2019.loc[covid_2019['Country\/Region']!='Italy',:]\n# Check that the information was droped\ncovid_2019.loc[covid_2019['Country\/Region']=='Italy',:]","109ff956":"# Load the new dataframe with the information about Italy\nitaly=pd.read_csv(\"..\/input\/novelcoronavirus2019dataset\/covid19_italy_region.csv\")\n# Print the columns of this data frame\nprint(italy.columns)","602de05a":"# Create a new dataframe for Italy with only the necesary variables (listed above)\nitaly=italy[['SNo','Date','RegionName','Country','Date','TotalPositiveCases','Deaths','Recovered']]\n# Name the columns as in covid_19\nitaly.columns=['SNo','ObservationDate','Province\/State','Country\/Region','Last Update',\n               'Confirmed','Deaths','Recovered']","d25a0205":"# Concat the two dataframes\ncovid_2019=pd.concat([covid_2019,italy])\n# Rename ITA for Italy\ncovid_2019['Country\/Region'].replace(to_replace='ITA',value='Italy',inplace=True)\ncovid_2019.loc[covid_2019['Country\/Region']=='Italy',:].head()","9e42a393":"# Transform data types\ncovid_2019=transform_dtypes(covid_2019)\n# Extract the information about the cities with more cases\n_ , cities=cases_country_city(covid_2019)\ncities","85fe53b3":"# List the names of the coldest countries\ncoldest_countries=['Canada','Russia','Mongolia','Greenland','Sweden','Norway','Finland','Iceland','Austria']\n# Pick only the information of the countries in \"coldest_countries\"\nind=(covid_2019_lastDay['Country\/Region'].isin(set(coldest_countries))) \n# Subset and sort the dataframe using the number of confirmed cases\ncovid_2019_lastDay.loc[ind,:].sort_values('Confirmed',ascending=False).head()","a4fa8efa":"# List of hottest countries \nhottest_countries=['Mali','Burkina Faso','Senegal','Mauritania','Djibouti','Benin','Ghana','Niger',\n                  'Cambodia','South Sudan','Qatar','United Arab Emirates','Sudan',\n                  'Saint Vincent and the Grenadines','Togo']\n# Pick only the information of the countries in \"hottest_countries\"\nind=(covid_2019_lastDay['Country\/Region'].isin(set(hottest_countries)))\n# Subset and sort the dataframe using the number of confirmed cases\ncovid_2019_lastDay.loc[ind,:].sort_values('Confirmed',ascending=False).head()","02908802":"weather_NewYork=pd.read_csv(\"..\/input\/weather\/NewYork_December2019_March_2020.csv\")\nweather_NewYork.head()","f184700a":"# Extract the directories\ndirectories=glob.glob(\"..\/input\/weather\/*.csv\")\n# Create an empty dataframe to store the information\nweather=pd.DataFrame()\n# Include the new data in \"weather\" for each csv file in the directory\nfor file in directories:\n    this_data=pd.read_csv(file)\n    weather=pd.concat([weather,this_data],axis=0)\nweather.head()","2ed9c46e":"# Create a dictionary with the names of the months and the number that represent it.\nd = dict((v,k) for k,v in enumerate(calendar.month_name))\n# Replace the variable 'Month' using the dictionary\nweather['Month']=weather['Month'].map(d)\nweather.head()","65954874":"# Create a new variable called \"Infection Day\" (note that I name this variable as in the \n# covid data frame to make clear that I am going the merge this dataframes using this variable)\nweather['Infection Day']=pd.to_datetime(weather[['Year', 'Month', 'Day']]).dt.date\n# Drop the information relative to the Day, Month and Year\nweather.drop(columns=['Day','Month','Year'],inplace=True)\n# Convert the 'Country' and 'State' features from objects to category variables\nweather[['Country','State']]=weather[['Country','State']].astype('category')\nweather.head()","6203407e":"# Print some basic exploration statistics\nprint('=> The data frame with the weather information is composed by {} rows and {} columns.'.format(weather.shape[0],\n                                                                                                   weather.shape[1]))\nprint('=> The countries included in this dataframe are:\\n {}'.format(weather['Country'].unique()))\nprint('=> The cities included in this dataframe are:\\n {}'.format(weather['State'].unique()))\nprint('=> The total number of Missing Values are: {}'.format(weather.isna().sum().sum()))","93247c08":"# Filter only the observations of the selected countries\nselected_countries=['US','Italy','Austria', 'Canada', 'Sweden', 'Qatar', \n                    'United Arab Emirates', 'Senegal', 'Spain']\ncovid_2019_countries=covid_2019.loc[covid_2019['Country\/Region'].isin(selected_countries),:].copy()\n\n# Include the cities in the selected countries without a city level information\ncountries_without_cities={'Austria': 'Vienna', 'Sweden': 'Stockholm',\n                          'Qatar': 'Doha', 'United Arab Emirates': 'Dubai', \n                          'Senegal': 'Dakar', 'Spain':'Madrid'}\ncovid_2019_countries.loc[:,'Province\/State'] = covid_2019_countries.apply(\n    lambda row: countries_without_cities[row['Country\/Region']] if \n    row['Country\/Region'] in countries_without_cities.keys() else row['Province\/State'],\n    axis=1\n)\n# Check that we don't have missing information in the \"Province\/State\" feature\nprint('The number of missing values in the Province\/State feature is: {} ==> Great!!'.format(covid_2019_countries['Province\/State'].isna().sum()))","b7137690":"# Select only the information relative to the selected province\/state\ncities=['New York','Madrid','Quebec','Lombardia','Vienna','Stockholm',\n       'Doha','Dubai','Dakar']\ncovid_final=covid_2019_countries.loc[covid_2019_countries['Province\/State'].isin(cities),:].copy()\nprint('=> The cities available in the reduced dataframe are:\\n {} ==> Nice, everything looks fine'.format(covid_final['Province\/State'].unique()))\nprint('=> The countries available in the reduced dataframe are:\\n {} ==> Nice!'.format(list(covid_final['Country\/Region'].unique())))\nprint('=> So far, the information about the cities of interests is contained in {} rows and {} columns.'.format(covid_final.shape[0],covid_final.shape[1]))\nprint('=> The new dataset has {} missing values'.format(covid_final.isna().sum().sum()))\ncovid_final.head()","88fd99f4":"# The number of new cases in the a day \"d\" (N_d) can be computed as [N_d - N_(d-1)]. \n# Remember that we need to do this by city.\n# Iterate ove the cities and compute the number of new cases per day\ncovid_new_cases=pd.DataFrame()\nfor city in cities:\n    # Subset the dataset to considder only one city\n    temp=covid_final.loc[covid_final['Province\/State']==city,:].sort_values(by='ObservationDate')\n    # Transform the variable \"Confirmed\" to include only the information \n    # about the new infections by day (not the cumulative)\n    temp.loc[temp['ObservationDate']>min(temp['ObservationDate']),\n             'Confirmed'] = temp['Confirmed'][1:].values - temp['Confirmed'][:-1].values\n    \n    # Create a new variable \"Days Since First Case\" where 0 is the day when \n    # the first infection was reported and N is the last day where was \n    # recorded information about new cases in \"city\"\n    diff_dates=temp.loc[:,'ObservationDate'].values - temp.iloc[0,1] # Difference between the first and k dates\n    temp['Days Since First Case'] =[tt.days for tt in diff_dates] # Include only the information about the days\n    \n    # Concatenate the result with the \"covid_new_cases\" dataframe\n    covid_new_cases=pd.concat([covid_new_cases,temp])\n# Print a piece of \"covid_new_cases\" dataframe\ncovid_new_cases.head()","2965e767":"# Resume in test1 the sum of the new cases by cities\ntest1=covid_new_cases.pivot_table(index=['Province\/State'],values='Confirmed',aggfunc='sum')\n# Extract in test2 the number of cases the last day\ntest2=covid_final.loc[covid_final['ObservationDate']==max(covid_final['ObservationDate']),['Province\/State','Confirmed']]\n# Merge and show this information\npd.merge(test1,test2,on='Province\/State',suffixes=('_cumulative (Last Day)', '_sum (new cases per day)'))","bae38ca7":"# Estimate the infection day\ncovid_new_cases['Infection Day']=covid_new_cases['ObservationDate'] -  pd.to_timedelta(8,'d')\n# Shows the new results\ncovid_new_cases.head()","5bd7e018":"# Left Join the two data frames\ncovid_weather=pd.merge(covid_new_cases,weather,how='left',left_on=['Infection Day','Province\/State'],\n                                            right_on=['Infection Day','State'])\n# Some variables like SNo, State (is a duplication of \"Province\/State\"), \n# Country (is a duplication of \"Country\/Region\") or \"LastUpdate\" are not \n# necessary to this study, so let's drop it from the data.\ncovid_weather.drop(columns=['SNo','State','Country','Last Update'],inplace=True)\ncovid_weather.head()","909ae1fb":"for city in cities:\n    print('=> The data frames have a {} match between the number of observations in {}'.format(\n        covid_weather.loc[covid_weather['Province\/State']==city,:].shape[0]==\n        covid_new_cases.loc[covid_new_cases['Province\/State']==city,:].shape[0],city))\nprint('=> The final data frame that condense all the information about the coronavirus disease and the weather in the selected 9 cities has {} observations and {} features.'.\n     format(covid_weather.shape[0],covid_weather.shape[1]))\nprint('=> The total number of missing values in the data frame is {} ==> Great!!'.format(covid_weather.isna().sum().sum()))","ec16cce4":"# PLot the Temperature Avg by day\npx.line(covid_weather, x='Infection Day', y='TempAvg', color='Province\/State',\n       title='Average Temperature by Day')","babdf213":"# Scatter plot between the Average Temperature and the number of Cases by Province\/State\npx.scatter(covid_weather, x=\"TempAvg\", y=\"Confirmed\", color=\"Province\/State\",\n                 marginal_y=None, marginal_x=\"box\", trendline=\"o\",\n          title='New Infections vs Temperature')","1d10c42f":"# Import k-means from sklearn\nfrom sklearn.cluster import KMeans\n# Extract the information  about the temperatures\nX=np.array(covid_weather['TempAvg'])\n# Cluster\nkmeans = KMeans(n_clusters=3, random_state=0).fit(X.reshape(-1,1))\n# Include the labels in our data frame in the variable \"Cluster_Temp\"\ncovid_weather['Cluster_Temp']=kmeans.labels_\n# Compute the min and max temperature values in each cluster\ncovid_weather.pivot_table(index='Cluster_Temp',values='TempAvg',aggfunc=['min','max'])","109511f6":"# Dictionary with the new labels\ndic={0:'40-60 F', 1: '>60 F', 2: '<40 F'}\n# Replace the labels\ncovid_weather['Cluster_Temp'].replace(dic,inplace=True)\n# Plot the clusters\npx.scatter(covid_weather, x=\"TempAvg\", y=\"Cluster_Temp\", color=\"Cluster_Temp\",\n                 marginal_y=None, marginal_x=None, trendline=\"o\",\n          width=900, height=300)","e29487dd":"# Histogram of the number of infections by group of temperature\npx.bar(covid_weather, x=\"Cluster_Temp\", y=\"Confirmed\", \n       color=\"Province\/State\", title='Temperature ranges and New Infections')","c8cb2c57":"# Number of days that each Province\/State had for each range of temperature\ncovid_weather.pivot_table(index='Province\/State',columns='Cluster_Temp',\n                          values='Days Since First Case',aggfunc='count')","7a9826e5":"# Create a data frame with the Region\/State population and Land Area\nregion_state_density=pd.DataFrame({'Region\/State':['Dakar', 'Doha', 'Dubai',\n                             'Lombardia','Madrid','New York',\n                             'Quebec','Stockholm','Vienna'], \n              'Population': [2956023,2382000,3331420, 10078012,\n                             3223334,19453561,8164361,2377081,1888776 ],\n             'Land Area (sq mi)': [211,51,1588,9206,233.3,54555,595391,2517,160.15]})\n# Compute the population density as Area\/population\nregion_state_density['Population Density']=region_state_density['Population']\/region_state_density['Land Area (sq mi)']\nregion_state_density.sort_values(by=['Population Density'],ascending=False,inplace=True)\nregion_state_density","26eb3468":"# Histogram of the new cases by cities\nfig1, axs = plt.subplots(3, 3, figsize=(10,8), constrained_layout=True)\naxs = trim_axs(axs, len(cities))\nfor ax, city in zip(axs, cities):\n    X=covid_weather.loc[covid_weather['Province\/State']==city,'Confirmed']\n    ax.set_title('{} ({} days observed)'.format(city,len(X)))\n    sns.distplot(X,kde=False,ax=ax,bins=40)\nfig1.suptitle('New Infections Histogram by Province\/State', fontsize=16);","b5409f4c":"## t-student Hypothesis tests ##\n# Create a dictionary with the pairs of cities to be tested\ncities2test=dict({'Dakar': ['New York','Madrid','Lombardia','Vienna','Stockholm','Quebec'],\n                 'Doha': ['New York','Madrid','Lombardia','Vienna','Stockholm','Quebec'],\n                 'Dubai': ['New York','Lombardia','Stockholm','Quebec']})\n# Run the tests (use the function \"t_test_byCities\" available in \"functions.py\") \nresults_pvalue, results_stat=t_test_byCities(cities2test,covid_weather)\n\nprint('The p-values are:')\nresults_pvalue.style.applymap(color_p_value)","3462fd98":"print('The t-statistics are:')\nresults_stat.style.applymap(color_p_value)","b27a8e96":"# Extract only the information of Dakar, Doha, and Madrid\nDakar_Doha_Madrid=covid_weather.loc[covid_weather['Province\/State'].isin(['Doha','Dakar','Madrid']),:]\n# Plot the number of new cases and temperature for Madrid, Dakar and Doha\ng=sns.pairplot(x_vars=\"Days Since First Case\", aspect=3,\n             y_vars=[\"Confirmed\",\"TempAvg\"], kind='scatter', hue=\"Province\/State\",\n             data=Dakar_Doha_Madrid);\ng.fig.suptitle(\"New Infections and Average Temperature by Day (Madrid, Dakar, Doha)\");    ","28d81e7e":"Dakar_Doha_Stockholm=covid_weather.loc[covid_weather['Province\/State'].isin(['Doha','Dakar','Stockholm']),:]\n# Plot the number of new cases and temperature in Stockholm, Dakar and Doha\ng=sns.pairplot(x_vars=\"Days Since First Case\", aspect=3,\n             y_vars=[\"Confirmed\",\"TempAvg\"], kind='scatter', hue=\"Province\/State\",\n             data=Dakar_Doha_Stockholm);\ng.fig.suptitle(\"New Infections and Average Temperature by Day (Stockholm, Dakar, Doha)\");  ","3d16dd02":"# Plot the number of new infections by day and region\npx.scatter(covid_weather, x=\"Days Since First Case\",y=\"Confirmed\",color=\"Province\/State\",\n          title='New Infections by Day')","f2ba6dfb":"# Min and Max Humidity Average values by Province\/State\ncovid_weather.pivot_table(index=\"Province\/State\",values=\"HumAvg\", aggfunc=['min','max'])","e96e780b":"# PLot the number of infections in relationship with the Days since the first infection and the Humidity Avg\npx.scatter(covid_weather, x=\"Days Since First Case\", \n           y=\"Confirmed\", size=\"HumAvg\",color=\"Province\/State\",\n          title=\"Number of New Infections by Day and Humidity Average\")","5e0ee0e3":"# Number of cases by Province\/State\ncovid_weather.pivot_table(index=\"Province\/State\",values='HumAvg',aggfunc='count')","798ae0af":"# Reduce each group to only the first 25 observations\nreduced_data=covid_weather.loc[(covid_weather['Days Since First Case']>=0) & \n                 (covid_weather['Days Since First Case']<=24),:]\nreduced_data.pivot_table(index='Province\/State',values='Days Since First Case',aggfunc=['min','max'])","8bcaae93":"# Create a list of 1-D arrays with the information of the Average Humidity.  \ndata = [reduced_data.loc[ids, 'HumAvg'].values for ids in \n        reduced_data.groupby('Province\/State').groups.values()]","582032ff":"# Run the Levene's test for the homeostasis of the variance\nfrom scipy import stats\nprint(stats.levene(*data))","fb02bda5":"# Kruskal-Wallis H hypothesis test (analysis of the variance)\nstats.kruskal(*data)","8feba621":"# Use the library scikit_posthocs to the posthoc test\nimport scikit_posthocs as sp\nresult=sp.posthoc_dunn(reduced_data,val_col='HumAvg',p_adjust='bonferroni',group_col='Province\/State')","4dda7c91":"# Plot the results as a heatmap\nsp.sign_plot(result);","b96f372d":"# Boxplot of the pressure by Province\/State\npx.box(covid_weather, x='Province\/State', y='Pressure_Avg',\n       title='Boxplot Pressure by Province\/State')","b6a2213b":"# Create a list of 1-D arrays with the information of the Average Humidity.  \ndata = [reduced_data.loc[ids, 'TempAvg'].values for ids in \n        reduced_data.groupby('Province\/State').groups.values()]\n# Levene's test\nprint(stats.levene(*data))\nprint('The test reveals that there are statistically significant differences between the variance of the temperature in different cities.')","4aefc06d":"# Kruskal-Wallis H hypothesis test (analysis of the variance)\nprint(stats.kruskal(*data))\nprint('The Kruskal-Wallis test shows that there are differences in the distribution of the temperature across different Province\/State.')","e62bcf2d":"# Dunn Posthoc test with Bonferroni correction \nresult=sp.posthoc_dunn(covid_weather,val_col='TempAvg',p_adjust='bonferroni',group_col='Province\/State')\nsp.sign_plot(result);","e68a8468":"# Create a dictionary with the combinations of cities\ncities2test=dict({'Madrid': ['New York','Lombardia','Vienna']})\n# Run the tests\nresults_pvalue, results_stat=t_test_byCities(cities2test,covid_weather)\nresults_pvalue['t-stats']=results_stat['Madrid']\nresults_pvalue=results_pvalue.rename(columns={'Madrid':'p-value'})\nresults_pvalue","27d4282c":"# Plot the number of cases by day only for Madrid, Lombardia, New York and Vienna.\ng=sns.relplot(x='Days Since First Case',y='Confirmed',hue='Province\/State',\n            data=covid_weather.loc[covid_weather['Province\/State'].isin(['Madrid',\n                                                                         'New York','Lombardia',\n                                                                         'Vienna']),:]);\ng.fig.suptitle(\"New Infections by Day (Madrid, New York, Lombardia, Vienna)\");","013ac366":"So far, we know that high temperatures potentially reduce the spread of the coronavirus, but what about other weather factors like humidity or pressure? In this section, I am going to see if exists any kind of relationship between the humidity and the spread of the virus.     \nThe next table resumes the minimum and maximum values of the average humidity by `Province\/State`. The range of values is wide in each of the cases, being New York the State with less reported humidity.    ","f3773e13":"Taking into account that we don't have a lot of information about states with low temperatures and higher population density than such regions or states with temperatures between $40-60^o F$, I decided to compare only the impact of high temperatures in the spread of the virus. For this comparison, I defined the next rules in order to decrease the bias (see points above):\n1. I will only consider Dakar, Dubai and Doha as the `Province\/State` with high temperatures.\n2. In order to compare one `Province\/State` with one of the above three cities ($X_i$), the population density of the `Province\/State` should be less than the population density of $X_i$. With this, we avoid the bias that the differences between the number of new cases in two different cities are given because of the population's density and not for other factors.\n\nBased on the above rules, the comparables Provinces\/State are:\n\n|           | Dakar | Doha | Dubai |\n|-----------|-------|------|-------|\n| New York  | \u2714\ufe0f     | \u2714\ufe0f    | \u2714\ufe0f     |\n| Madrid    | \u2714\ufe0f     | \u2714\ufe0f    | \u2716\ufe0f     |\n| Lombardia | \u2714\ufe0f     | \u2714\ufe0f    | \u2714\ufe0f     |\n| Vienna    | \u2714\ufe0f     | \u2714\ufe0f    | \u2716\ufe0f     |\n| Stockholm | \u2714\ufe0f     | \u2714\ufe0f    | \u2714\ufe0f     |\n| Quebec    | \u2714\ufe0f     | \u2714\ufe0f    | \u2714\ufe0f     |\n\nOur objective is to compare if the distribution of the new infections in two different cities comes from the same population or not. In other words, the null hypothesis is that the spread of the virus is independent of the temperature, and the alternative hypothesis is that the spread is lower in cities with high temperatures. \n  \nThe distributions of the new infections are independent but also are far away from following a normal distribution (see Fig. _\"New Infections Histogram by Province\/State\"_ below).  Nevertheless, it has been reported that samples with more than 15 observations (there are at least 25 in each of our distributions) are enough to avoid the normality assumption in the case of two samples t-student hypothesis test (see [here](https:\/\/support.minitab.com\/en-us\/minitab\/18\/Assistant_Two_Sample_t.pdf), or [here](https:\/\/books.google.com\/books?hl=en&lr=&id=fZZTBgAAQBAJ&oi=fnd&pg=PR7&ots=KVNzlTQZBU&sig=uc2nGPRKmXFRx5q5d627Vf2ndPc#v=onepage&q&f=false), and also [here](https:\/\/www.ncbi.nlm.nih.gov\/pmc\/articles\/PMC3693611\/)). I'm not happy with this number of samples, but, in this case, it's important to make inference over the mean (parametric case) and not over the median (nonparametric case) Why? Because we need to take into account if exists a high number of new infections. Also, the nonparametric tests assume that all groups must have the same or very similar spread (variance), which doesn't seem to be the case in our data. Finally, a parametric test (like t-student) gives more statistical power to the test (less probability to fail to reject the null hypothesis when it is false).","f3ee7cae":"At this moment, we covered the two points described at the beginning of [this section](#merging_weather_COVID_datasets) and only remain to merge the information in the coronavirus dataset (\"covid_new_cases\") with the weather dataset \"weather\". Note that we need to do a left join (complete the  information in the \"covid_new_cases\" dataset with the weather).","1c19604d":"Again, if we want to compare the number of cases between regions it's necessary to consider the same number of days since the first infection. The  table below shows that the maximum number of days that we can consider is 25 (New York). ","67363ffb":"#### Cities in Coldest-Countries\n<a id='coldest_countries'><\/a>","257b63a1":"The previous observations are far away to be conclusive because these differences could be explained as a consequence of differents factors like:\n* Differences in the population density between Provinces\/States (cities with more population are more likely to have more cases).\n* Our sample has mostly cities with temperatures between $40-60^o F$.\n* Sociocultural factors. Note here that Spanish and Italians are warm people, normally used to have close interpersonal relationships, and as a consequence this power the spread of the virus. The explanation is extensible for New York, which is a very multicultural city.\n\nThe table below resumes the total days for each temperature group and `Province\/Region`. As we can see, New York is the only city that has days in each of the temperature ranges but isn't enough to even consider a fair statistical comparison of the number of new cases between temperature groups. Without a doubt, this is a limitation of our dataset, and in my opinion, the best bet could be to compare cities with similar population density and different temperatures.\n> Note that taking this path, we are assuming that the sociocultural factors are similar between the population of two different cities, which could be a bias, but it's necessary to simplify our analysis because sadly our data is limited.","a711383e":"The same situation occurs in the case of Stockholm, Dakar, and Doha. You can see in Fig. _\"New Infections and Average Temperature by Day (Stockholm, Dakar, Doha)\"_ that the number of cases increases exponentially in Stockholm after the first 35 days of the first infection. The conclusions explained before in the case of Madrid are extensible to this case, and we need to wait for more information to draw conclusions in these four regions comparison.","e4cf0844":"### Coronavirus vs Pressure\n<a id='coronavirus_vs_pressure'><\/a>\n\nAccording to [Gay-Lussac's law](https:\/\/en.wikipedia.org\/wiki\/Gay-Lussac%27s_law) the pressure and the temperatures are directly proportional to each other, so, if the temperature increase, the pressure increase, and vice-versa. Some good examples and explanations are available [here](https:\/\/www.enotes.com\/homework-help\/what-relationship-between-air-temperature-air-162931).\n> \"An easy way to understand this concept is by comparing car tires in the winter and car tires in the summer. In the summer the air is a lot warmer so the molecules are moving around a lot. The tire expands and you not need as much air because the pressure in the tires is high enough. In the winter, when the air is cold, the molecules are moving very slowly. Many people need to add more air to their tires because there is not enough pressure.\"    \n\nSo, if these two variables are correlated and we analyzed the temperature, there is no reason to analyze the pressure, right? Maybe, but no soo fast! There is another atmospheric relationship that we don't talk yet and it is that the [pressure drops as altitude increases](https:\/\/www.nationalgeographic.org\/encyclopedia\/atmospheric-pressure\/), and as the pressure decrease the amount of oxygen also decreases. Now, do you think that it's valid to study the relationship between the altitude of the province or states as a factor in the spread of the virus? It seems unlikely that this could be a key factor but at least we can get out of the doubt.\n\nThe altitude in feet and meters of our 9 `Province\/State` are included in the next table.\n\n| Province\/State | Altitude     |\n|----------------|--------------|\n| New York       | 33' (10m)    |\n| Madrid         | 2188' (667m) |\n| Doha           | 33' (10m)    |\n| Dakar          | 72' (22m)    |\n| Dubai          | 52' (16m)    |\n| Lombardia      | 390' (120m)  |\n| Quebec         | 322' (98m)   |\n| Stockholm      | 62' (19m)    |\n| Vienna         | 2273' (350m) |\n\nThe region with more altitude is Madrid followed by Vienna and Lombardia,  while New York, Doha, and Dubai have very close altitudes. The case of Madrid is interesting because we know that this city is one of the three with more cases worldwide. Fig. _\"Boxplot Pressure by Province\/Stats\"_ shows that as was expected, Madrid has a significantly lower pressure than the other regions. So, if the pressure given the altitude is a factor in the spread of the virus, we should expect that the number of infections in Madrid will be greater (lower) than each of the other regions.","5294aaba":"### Coronavirus vs Humidity\n<a id='coronavirus_vs_humidity'><\/a>","710ebe6f":"For these tests, I am going to set the critical value $\\alpha=0.05$, and establish the length of each sample to the lengh of the sample with less observations. This is, if X, Y are the two samples to compare with length $l_X$ and $l_Y$ respectively, and $\\hat{l}=min(l_X,l_Y)$, then I am only going to consider the observations of X and Y between the first infection day and the day $\\hat{l}$.\n> The above could look tricky, but in fact, it has an easy explanation, and it is that we need to compare the same number of days after the first infection because in the other way we are introducing a bias based on the lack of information in the distribution with fewer observations.","1cf8d70f":"### Cities Selection\n<a id='cities_selection'><\/a>\n\nFor this study I considered the weather in the last 4 months (December 1 to March 29) of 9 differents cities. The selection criterion was:\n* Include the most infected city of the 3 countries with more cases. At 2020-04-03 these countries were US, Italy, and Spain, and the cities were \"New York\" (US), the region of \"Lombardia\" in Italy (in this case we selected Milan, which is the capital of Lombardia), and Madrid (Spain) (see details in the subsection [Cities in Countries with more Infections](#cities_in_countries_with_more_infections)).\n* Include the city with a greater number of cases in the 3 coldest countries. The list with the coldest countries in the World was obtained from [here](https:\/\/www.swedishnomad.com\/coldest-countries-in-the-world\/) taking into account the average yearly temperature.  \n    * The results show that the coldest countries with more cases are \"Austria\", \"Sweden\", and Canada with 11524, 6131 and 6101 cases respectively. For these countries the most afected cities are Vienna (Austria's capital), Stockholm (Sweden's capital), and Quebec in Canada. For details, see the subsection [Cities in Coldest-Countries](#coldest_countries). \n* Include the city with a greater number of cases in the 3 hottest countries. A list with the 15 hottest countries given the average yearly temperature was obtained from [here](https:\/\/www.swedishnomad.com\/hottest-countries-in-the-world\/). \n    * Given these selection parameters, I obtained that the hottest 3 countries with the greatest number of cases are United Arab Emirates, Qatar, and Burkina Faso with 1264, 1075 and 302 cases respectively. Unfortunately, I can't found free weather information about Burkina Faso, and as consequence I pick the next country in the list, which is Senegal with 207 cases. The weather of the cities with more cases of these 3 countries (Dubai (United Arab Emirates), Doha (Qatar), Dakar (Senegal)) were selected for this analysis (see details in the subsection [Cities in Hottest-Countries](#hottest_countries)).\n\n\n> Unfortunately, it was very difficult for me to find accurate information about the weather by country\/cities in the last 4 months. All the webpages sell this information (and is very expensive by the way), so, I collected and curated manually this data. If anybody has or knows where to obtain this kind of data easily, please, share this information. If you want to use this information, it is available[here](https:\/\/github.com\/Yasel-Garces\/The-impact-of-weather-in-the-coronavirus-spread).","9c2813cf":"For the following analysis is important to remember that the variable `Confirmed` contains the information about the new cases that were infected at `Infection Day`. Note that this is an estimation, but in my opinion, it is more realistic than study the weather around 8 days after that the infection occurs.\n\nFig. \"_Temperature Avg by Day_\" shows the temperature in the 9 `Province\/State` since the `Infection Day` of the first reported patient. This time series shows that the hottests `Province\/State` (Dakar, Dubai, Doha) have mean temperatures over $\\approx 65^o F$ in all days, while Quebec is the only `Province\/State` that had under $30^o F$ most of the time. The temperature in all the others `Province\/States` were between $30$ and $60^o F$.\n> Note that this graph shows the possibility to make a discretization of the temperature potentially considering 3 ranges of values. In the future, should be nice to do a k-means analysis with 3 clusters to study the number of cases by range of temperature (see below).","2dbff5b3":"### Coronavirus vs Temperature\n<a id='coronavirus_vs_temperature'><\/a>","93e763f1":"Above, you can see that the `months` appear as a `string`, let's transform this variable to `int`.","dc6e8ca2":"The next step is to merge the information in all these 9 files in only one.","20255703":"Now, it's time to select only the information relative to the 9 `Province\/State` that we are going to include in this project.","e156fccf":"The first task described at the [beginning of this section](#merging_weather_COVID_datasets) is done. Now we need to move forward to the second point. Remember, for this, we need to compute the number of new cases by day and city (now our dataset contains the accumulative number of cases), and next we need to move back the dates in 8 days (see [above](#merging_weather_COVID_datasets) for more details).\n\nAlso, I am going to create a new variable (`Days Since First Case`) that represents the number of days since the first infection case was reported in a city. Note that this variable could give a more direct information about the number of new cases per day after the first infection.","2eeb909f":"In accordance with the first point above, let's extract from our general data the information about these 9 `Province\/State`. Here it's important to remember that our dataset has the information of some countries segmented by cities or regions (e.g. US, Italy), but others (like Spain) only have a country-level segmentation, so, the first step is to complete the missing information in the `Province\/State` variable. ","6acbd54c":"The next heatmap shows the results of the post hoc test, and if we take into account our previous study about the differences between the number of new infections, we can infer that the humidity doesn't have any influence on the spread of the virus. For example, in the first 25 days of infection, New York had 195 times more cases than Doha and 7922 times that Dubai, but our test revealed that don't exist statistical differences between the humidity of these regions. On the other hand, there is a significant difference between the humidity in Madrid and Dakar but as we analyzed in the previous section, there are no differences between the distribution of the new infections of these two regions.   \n> Based on these results, I think that the humidity is not an influencing environmental factor in the spread of the virus.","97b6c792":"### Weather data\n<a id='weather_data'><\/a>\n\nThe historical weather of the selected 9 cities was collected from [\"Weather Underground\"](https:\/\/www.wunderground.com\/) and saved in independents CSV files (one file per city). Each file contains information about the weather from December 2019 to March 30, 2020 (121 observations), condensed into 18 variables: \n\n| Variable                                     | Description                                       |\n|:----------------------------------------------|:---------------------------------------------------|\n| Day                                          | Day                                               |\n| Month                                        | Month                                             |\n| Year                                         | Year                                              |\n| Country                                      | Name of the country                               |\n| State                                        | Name of the state or region                       |\n| TempMax\/TempAvg\/TempMin                      | Maximum, average and minimum temperature ($^o F$) |\n| HumMax\/HumAvg\/HumMin                         | Maximum, average and minimum humidity (%)         |\n| Wind_Speed_Max\/Wind_Speed_Avg\/Wind_Speed_Min | Maximum, average and minimum wind speed (mph)     |\n| Pressure_Max\/Pressure_Avg\/Pressure_Min       | Maximum, average and minimum pressure (Hg)        |\n| Total_Precipitations                         | Total precipitations (in)                         |\n\n\n\nBelow you can take a look at this information in the case of New York.","06fba8e2":"Before going forward, it's important to transform the variables to the correct format.","df1a5298":"I couldn't find detailed information about the number of cases in Spain by region, but, we know that the greatest number of cases are in Madrid, so, I'm going to pick the information about the weather in Madrid for this analysis.      \nFinally, the functions `transform_dtypes` and `cases_country_city` available in the `functions.py` script runs all the steps that we did earlier in [this section](#cities_in_countries_with_more_infections). The results shows that at this moment New York is US's city with more cases ($\\approx 102987$), while the region of Lombardia in Italy has $\\approx 47520$ cases.","d1620e84":"The p-value is in the order of $10^{-19}$ ==> Reject the null hypothesis that the population medians of all of the groups are equal, and as consequence, exist differences in the humidity between cities. Now, we need to do a post hoc test to see which groups are different. For this, I am going to use [Dunn's tests](https:\/\/www.tandfonline.com\/doi\/abs\/10.1080\/00401706.1964.10490181) as a post hoc with a [Bonferroni correction](https:\/\/en.wikipedia.org\/wiki\/Bonferroni_correction) of the p-value, and this is justified because:\n* Dunn's test employs the same ranking than the Kruskal-Wallis test.\n* Dunn's test employs the pooled variance implied by the null hypothesis of the Kruskal-Wallis test. See [here](https:\/\/en.wikipedia.org\/wiki\/Kruskal%E2%80%93Wallis_one-way_analysis_of_variance#cite_note-Dunn-5) for more information.    \nNote that the Bonferroni correction is necessary because we are doing multiple comparisons between groups.","a3d8be63":"The below heatmap shows the result of the post hoc Dunn's test with Bonferroni correction. In the case of Madrid, we fail to reject the null hypothesis of equality of the median of the temperatures in the combinations with New York, Lombardia, and Vienna, so now we can take these two by two combinations {(Madrid-New York), (Madrid-Lombardia), (Madrid-Vienna)} and see if existing differences in the number of new infections.","b44dfb4f":"#### Cities in Hottest-Countries\n<a id='hottest_countries'><\/a>","7642f7d7":"The problem seems to be clear! Our data doesn't contain the information of Italy or Spain segmented by regions or provinces (note that only exists one record per day). Fortunately, in the case of Italy, this inconvenience can be overcome using another available [dataset in Kaggle that contain specific information about Italy](https:\/\/www.kaggle.com\/sudalairajkumar\/covid19-in-italy#covid19_italy_region.csv). Therefore, I decided to drop all the information relative to Italy from the `covid_2019` dataset and include the new information available in the Italy dataset.","33bffab3":"The p-value is smaller than 0.05, so we reject the null hypothesis ==> There are differences in the variance between groups ==> We can\\'t use ANOVA. The alternative is to use a [Kruskal-Wallis H hypothesis test](https:\/\/en.wikipedia.org\/wiki\/Kruskal%E2%80%93Wallis_one-way_analysis_of_variance), which is the non-parametric version of ANOVA.","63ae6fbe":"Above, we can see that the number of confirmed cases is no longer a cumulative variable. But given that this variable is very important in this project, let's be more cautious and confirm that everything looks as we want. For this, let's compute the sum of all the new cases by city and compare the result with the number of cases of the last day in the original data frame.","f9688da0":"> Finally!!! Our data looks tidy and we are ready to board our scientific questions.","36a241ea":"The above discretization allows quantifying the number of infections by temperature ranges. Fig. _\"Temperature ranges and New Infections\"_ shows that the number of new infections is around 250 000 when the temperature is between $40$ and $60^o F$, which is significantly higher than the two other ranges. Also, this histogram shows that the number of new cases when the temperature is under $40^o F$ ($\\approx 35 000$) is notably bigger than when the temperature is over the $60^o F$, in which case our data only report around 10 000 new infections.","8125735b":"The next chunk of code transforms or data frame and now we only include the first 25 observations by region. Just to be sure that everything looks as was planned, I printed the minimum and maximum day after the first case by Province\/State.","64f26fa7":"The  results obtained through the `stats.ttest_ind` function are relatives to a [two-tailed test](https:\/\/docs.scipy.org\/doc\/scipy\/reference\/generated\/scipy.stats.ttest_ind.html), and for that reason, I divided the p-value by 2 (one-tailed test), and print the t-statistic. \n* If $p\/2<0.05$ and $t>0$ then we are on the right tail of the distribution and we can affirm that the mean of new cases in warm regions is greater than in other regions, \n* If $p\/2<0.05$ and $t<0$ we can conclude that the mean of new cases is lesser when the temperature is upper $60^o F$.\n\nIn 12 of the 16 hypothesis tests, we reject the null hypothesis in favor of the alternative (the mean of the people infected in regions with temperatures under $60^o F$ is more than regions with temperatures over $60^o F$). Nevertheless, it may be interesting to study what happened in these 4 cases where we fail to reject the null hypothesis. In my opinion, a nice way to see this is to relate the number of new infections by day. Fig. _\"New Infections and Average Temperature by Day (Madrid, Dakar, Doha)\"_ shows this relationship in the case of Madrid, Dakar and Doha (note that we fail to reject the null hyphotesis in the test between \"Madrid vs Doha\" and \"Madrid vs Dakar\"), and is easy to see an interesting patter here:\n1. We have only $\\approx 32$ days in common between the three distributions (number of days since the first infection).\n2. Madrid and Dakar have almost the same number of infections by day until day 32, while some days Doha seems to have more infections than Madrid, which explains why we fail to reject the null hypothesis in these case, but this isn't all:\n    1. After day 32, the number of cases increases exponentially in Madrid, but we don't have more information about Doha or Dakar because at this moment these regions only had one month since the first infection.  \n    2. The temperature in Madrid doesn't suffer big changes after day 32 (see Fig. _\"New Infections and Average Temperature by Day\"_), so, this doesn't seem to be the factor that shot the number of infections.\n    > At this point we can formulate two hypothesis:\n        1. The spread of the virus in Doha and Dakar is following a pattern very similar to the case of Madrid, and in the following days, we are going to see an exponential increase in the number of new infections in these regions (I don't believe that this is the case if we also consider that the number of new infections in Dubai is stable and close to zero).\n        2. Other factors (like socioculturals) make a huge impact in the spread of the virus. This looks like a more reasonable hypothesis, but we are not going deeper here because this topic is beyond the scope of this project.","4a897407":"If we look at the columns of the `italy` data frame, it's easy to realize that we only need to consider the next variables to include in our `covid_19` data frame: `Sno`, `Country`, `Date`, `Recovered`, `Deaths`, `TotalPositiveCases`.","5035651f":"## Data Collection and Cleaning\n<a id='data_collection_and_cleaning'><\/a>\n\nThe above questions are related to a more general motivation [proposed at Kaggle](https:\/\/www.kaggle.com\/sudalairajkumar\/novel-corona-virus-2019-dataset\/tasks?taskId=62). One of the main dataset that I am going to use in this projects was also obtained from Kaggle (\"[covid_19_data.csv](https:\/\/www.kaggle.com\/sudalairajkumar\/novel-corona-virus-2019-dataset#covid_19_data.csv)\") and relates the total number of confirmed, deaths and recovered cases per day, `Province\/State` and `Country\/Region`.        ","1235c03c":"Now it's time to begin to explore the relationship between the temperature and the number of new cases. Fig. _\"New Infections vs Temperature\"_ (below) shows that the greatest number of infections occurs in cities with a mean temperature between $40$ and $60^o F$. This is the case of New York, Madrid, and Lombardia with a median temperature of $47.5^o F$, $50.5^o F$ and $47.75^o F$ respectively.     \nNote that for temperatures over $65^o F$ the numbers of infections seems to be very low in comparison with the other regions with lowest temperatures. Also, as we advertise previously, Quebec is the province with the lowest temperature, and also seems to has a low number of new infections in comparison with the regions with temperatures between $40$ and $60^o F$.\n> Given this graph, we can hypothesize that if the temperature has an impact on the spread of the Coronavirus, then:\n1. The spread is reduced significatively when the temperature is over $\\approx 65^o F$.\n2. It's more probable to have more infections when the temperature varies between $40$ and $60^o F$ approximately.\n3. For temperatures under the $\\approx 35^o F$, the spread seems to be less than when the temperature is between $40$ and $60^o F$ but greater than regions with temperatures over $65^o F$. In resume, the cold seems to be a factor that impacts the spread of the virus but less than hight temperatures.","1d75a8c3":"As we exposed at the beginning of this section, it could be interesting (and potentially better for visualization) to create 3 clusters using the temperature. Probably and given the descriptive and exploratory analysis that we did so far, we know between which ranges the temperature will vary, but I think it's better to use a K-means algorithm to find these intervals.","2aa6bc05":"As we can see in the following descriptive data frame, this data is composed of 11614 observations with 119827 infections, 14681 deaths and 63612 recovered patients around the world. An important piece of information is that the variables `Confirmed`, `Deaths` and `Recovered` are cumulative and for that reason, at this point, we can't say anything for example about the mean number of new cases by day.","30e8b1f1":"The above table resumes the results of the k-means analysis. The results look very similar to what we expected, note that one of the cluster (cluster #2) groups temperatures under $\\approx 40^o F$ while the cluster #1 groups temperatures greater than $60^o F$. Finally, the cluster #0 groups temperatures between $\\approx 40$ and $60^o F$.    \nNow, let's transform the new variable `Cluster_Temp` to include the ranges of values as labels instead of integer labels than doesn't provide much information.","cea5ff64":"The previous idea seems valid, but in fact, we need to take the temperature out of the equation if we want to be sure that if exist differences is because the altitude\/pressure and not for the temperature (which we are pretty sure that have an influence in the spread of the virus). With this aim, the simpler solution is to include in the study only the `Province\/Regions` with temperatures that are not significantly different than Madrid. As we did in Section [Coronavirus vs Humidity](#coronavirus_vs_humidity), we are going to analyze all the cities at the same time through a variance analysis. ","38e8431e":"### Merging the weather and the COVID-19 datasets\n<a id='merging_weather_COVID_datasets'><\/a>\nAt this point, it's important to structure the dataset based on some previous assumptions:\n   1. We only are considering 9 cities to study the relationship between the spread of the virus with the weather. \n   2. If a person \"X\" was reported as infected at the day \"D\", then the exposure occurred [between 2-14 days before](https:\/\/www.cdc.gov\/coronavirus\/2019-ncov\/symptoms-testing\/symptoms.html). I am going to assume here that the mean of persons with the disease has the first symptoms on day 8 (the mean between 2 and 14) after exposure. This is, the weather that matter in the infection of \"X\" is the weather in the day (\"D\" - 8).\n       > I am assuming that the weather doesn't matter once the virus gets into a person (which seems logical).","0d93d9d6":"## Conclusions and Remarks\n<a id='conclusions_and_remarks'><\/a>\n1. Temperatures over the $60^o F$ seems to affect the spread of the virus.\n2. The humidity doesn't seem to be an environmental factor that affects the spread of the virus.\n3. Our data shows that in the case of Madrid, the pressure given the altitude had a negative effect on the spread of the virus (reduced the spread) in the first 40 days of infection, but these results are not conclusive and we need a lot of more data to have a better idea of this effect.\n\n### Remarks\n* In my opinion, the study of only 9 cities (even when the cities were selected with a logical criterion) is not enough to draw valid conclusions about general climatological conditions that affect or not the spread of the virus independently of the city or region. \n* There are a lot of factors, like the sociocultural ones, that have a strong incidence in the spread of the virus independently of the weather. Assuming (like I did) that these factors are going to be similar between different regions is a long shot, but it is the only way at this moment to contrast different weather conditions with the number of new infections.\n* In this project, we only developed a univariate statistical analysis about the influence of 3 weather variables with the number of new infections, but a multivariate analysis would be great to elucidate more complex relationships between the weather and the spread of the virus.\n\nIn general, a lot of work remains to do, and more data it's necessary if we want to provide accurate answers. All the codes and datasets employed in this project are available [here](https:\/\/github.com\/Yasel-Garces\/The-impact-of-weather-in-the-coronavirus-spread), and if you have or know where to find more open\/free weather data to improve this analysis, please let me know. \n\n> Meanwhile, would be great to know what you think about the impact of the weather in the spread of the coronavirus or your opinion about the questions that remain open in this work.\n\n**Thanks for reading and keep safe!!**","728f0ece":"The data about the `Population`, `Land Area` and `Population Density` for each `Province\/Region` was obtained from [Wikipedia](https:\/\/www.wikipedia.org\/), and are shown in the next table. The good news is that Doha and Dakar are the regions with more population density, but also the temperature in these regions is always over $60^o F$, so, this opens the possibility to compare these regions with others with different temperatures ranges.","0b1ff934":"#### Cities in Countries with more Infections.\n<a id='cities_in_countries_with_more_infections'><\/a>","8c5593c7":"## Weather and New Infections.\n<a id='weather_and_new_infections'><\/a> ","9035e4f0":"The COVID-19 dataset is composed by 8 variables which description could be found [here](https:\/\/www.kaggle.com\/sudalairajkumar\/novel-corona-virus-2019-dataset). ","e2abbe75":"Fig. _\"Number of New Infections by Day and Humidity Average\"_ shows the number of new infections in relationship with the days since the first infection and the humidity average by day. If we interact with the graphic, it's possible to observe that there is not (at least with the naked eye) a clear relationship between the humidity and the new infections (low or high humidity doesn't imply a high or a low number of infections and vice versa in each `Province\/State`).       \n> Nevertheless, would be interesting to see if exists differences in the humidity between regions and in such cases if that difference seems to have an impact on the number of cases.","f6445c05":"As we can see in the above table, everything looks well and only remain to move the dates 8 days back in the calendar as an approximation of when the infection occurred. For this, I am going to include a new variable called `Infection Day`.","bfdefaaa":"> So far, the weather information looks nice, so, we can move forward and try to relate the covid 2019 dataset with the information about the weather.","28b6dde7":"The faster way to prove the existence of differences in the distribution of the `HumAvg` between regions (`Province\/State`) is to use an analysis of variance ([ANOVA](https:\/\/en.wikipedia.org\/wiki\/Analysis_of_variance)). One of the key assumptions of this test is the homogeneity of the variance ([homoscedasticity](https:\/\/en.wikipedia.org\/wiki\/Homoscedasticity)), and a good way to prove this is using the [Levene's Tests](https:\/\/en.wikipedia.org\/wiki\/Levene%27s_test). Under the null hypothesis, this test assumes the equality of the variance while the alternative hypothesis is that the variance are different. Again, I am going to use a critical value $\\alpha=0.05$.","2182aa98":"We can see here something unexpected (wasn't obtained any city for Italy or Spain). Let's see what happened:","addbd744":"# Has the weather an impact on the spread of the coronavirus?\n\n> ![coronavirus-weather-hero.jpg](attachment:coronavirus-weather-hero.jpg)\n\nWith more than 775 748 peoples infected and 37109 deaths (03\/30\/2020) and with a significative decrease of usual human activity, the COVID-19 will be remembered as a sad part of mankind's history. I, like many others, am trying to keep doing what I love to do and avoid get crazy thinking about the impact of this crisis in my family and people around the World. I am not a politician, I don't have any kind of power, but, at the same time, I feel that I need to do something else, and for that reason I began this project as a modest contribution of what I think could be some interesting open questions about the COVID-19:\n\n1. Is there some relationship between the temperature and the spread of the virus? In such a case, what is the minimum temperature that help to slow down it spread?\n2. Has the humidity some kind of impact on the spread of the virus?\n3. What happens with the virus at different atmospheric pressures?\n   \nThis project is structured as follows:\n1. [Data Collection and Cleaning](#data_collection_and_cleaning)\n    1. [Cities Selection](#cities_selection)\n        1. [Cities in countries with more infections.](#cities_in_countries_with_more_infections)\n        2. [Cities in Coldest Countries.](#coldest_countries)\n        3. [Cities in Hottest Countries.](#hottest_countries)\n    2. [Weather Data](#weather_data)\n        1. [Merging the weather and the COVID-19 datasets.](#merging_weather_COVID_datasets)\n2. [Weather and New Infections.](#weather_and_new_infections)\n    1. [Coronavirus vs Temperature.](#coronavirus_vs_temperature)\n    2. [Coronavirus vs Humidity.](#coronavirus_vs_humidity)\n    3. [Coronavirus vs Pressure.](#coronavirus_vs_pressure)\n3. [Conclusions and Remarks.](#conclusions_and_remarks)","9292a9d6":"Finally, below I include an interactive graphic as a tool if somebody wants to play with this data. If you can find some patterns that I didn't perceive, please, let me know about it.","607f1751":"At this point, the objective is to see if exists differences in the number of infections in each of the three pair of cities defined before. Based on the same explanation given in Section [Coronavirus vs Temperature](#coronavirus_vs_temperature), we are going to use a one tail t-student test with critical value $\\alpha=0.05$. Again, the null hypothesis is that there aren't differences in the mean of the number of new infections between the cities and the alternative is that there is.    \nThe results (see data frame below) are extremely interesting! Note that in all the comparisons we obtained that the number of new infections in Madrid is significantly lower (from a statistical point of view) than in all the other regions with similar temperatures. Also, the population density in Madrid is greater than the other three regions, so, this doesn't seem to be the factor that explains this difference.    \nWhat do you think about this? Is it not weird? I think it is, and this is because currently, we know that Madrid is one of the three regions with more cases, so, what happened here?     \n* This effect is given because (as we did before) we are only considering the common maximum number of days since the first infection between both cities. Remember that I made this decision as a way to mitigate the effect that cities with a greater number of days are more likely to have more cases.\n* If we observe the relationship of the number of new cases by city and the number of days since the first infection (Fig. _\"New Infections by Day (Madrid, New York, Lombardia, Vienna)\"_ below), it is easy to see that our dataset only have the information of Vienna and Lombardia in approximately 40 days, and in those first 40 days, Madrid has fewer infections than these two regions and New York, so, this is the reason why we are obtaining significant statistical differences.\n* Now, the number of cases increased exponentially in Madrid after  40 days of infection, so, maybe these differences in the first 40 days are just a random effect and are not related with the altitude, or the altitude has an effect in the spread of the virus, but a new factor took effect in Madrid after the 40 first days and mitigated the effect of the altitude.    \n> At this point, this analysis is something interesting but is far away to be conclusive! A lot more data and analysis are necessary if we want to prove this hypothesis."}}