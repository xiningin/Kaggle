{"cell_type":{"ae9dee16":"code","37499369":"code","5d1a0d22":"code","18517880":"code","f869382e":"code","388faf3e":"code","dd181729":"code","3ebc6dfb":"code","1c6bd776":"code","f613d611":"code","976352fc":"code","99379443":"code","281d63d7":"code","c9f57a96":"markdown","912c8e22":"markdown","1cbc1de9":"markdown","7b8b9c13":"markdown","f87e14bd":"markdown","2095109f":"markdown","b210e542":"markdown","a43cb58a":"markdown"},"source":{"ae9dee16":"!pip install h2o","37499369":"import pandas as pd \nimport numpy as np \nimport h2o\nfrom h2o.automl import H2OAutoML\nimport matplotlib.pyplot as plt","5d1a0d22":"df_train = pd.read_csv('..\/input\/tabular-playground-series-jan-2021\/train.csv')\ndf_train.drop(columns='id', axis=1, inplace=True)\ndf_train.head()","18517880":"h2o.init(\n    nthreads=-1,     # number of threads when launching a new H2O server\n    max_mem_size=12  # in gigabytes\n)","f869382e":"train = h2o.H2OFrame(df_train)","388faf3e":"x = train.columns\ny = \"target\"\nx.remove(y)","dd181729":"aml = H2OAutoML(nfolds=5, balance_classes=False,\n                max_runtime_secs=(3600*3), max_models=None, seed=42)\naml.train(x=x, y=y, training_frame=train)","3ebc6dfb":"lb = aml.leaderboard\nlb.head(rows=lb.nrows)","1c6bd776":"aml.leader.varimp_plot(num_of_features=10)","f613d611":"model_ids = list(aml.leaderboard['model_id'].as_data_frame().iloc[:,0])\nse = h2o.get_model([mid for mid in model_ids if \"StackedEnsemble_AllModels\" in mid][0])\nmetalearner = h2o.get_model(se.metalearner()['name'])\n\nmetalearner.std_coef_plot(num_of_features=20)","976352fc":"df_test = pd.read_csv('..\/input\/tabular-playground-series-jan-2021\/test.csv')\ndf_test_x = df_test.drop(columns='id',axis=1)\ntest = h2o.H2OFrame(df_test_x)\npreds = aml.leader.predict(test)","99379443":"test_with_pred = test.cbind(preds)\nres = test_with_pred[:,'predict']\nres = res.set_names(['target'])\nh2o.export_file(res, path = 'submission.csv', force = True)\nsubmission = pd.read_csv('.\/submission.csv')\nsubmission['id'] = df_test.id\nsubmission = submission[['id','target']]\nsubmission.to_csv('submission.csv',index=False)","281d63d7":"submission.head()","c9f57a96":"# H2O","912c8e22":"Change to dataframe format h2o can read","1cbc1de9":"Check feature importance of leader model","7b8b9c13":"# Submission","f87e14bd":"Make Prediction and Submission","2095109f":"# Model Evaluation","b210e542":"Check coefficient of each model in the stacked ensemble model","a43cb58a":"# Data Preparation"}}