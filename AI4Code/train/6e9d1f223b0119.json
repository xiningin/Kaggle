{"cell_type":{"1d78d5c6":"code","2a05bf79":"code","ba70a0f0":"code","7d8a6f9b":"code","6a0f1159":"code","c3049ad7":"code","ff1dd5df":"code","62ef9535":"code","a53f687a":"code","7ae6467d":"code","f3f4675a":"code","ff14abd7":"code","7ff42eb0":"code","52a1ecea":"code","a3f9f717":"code","9ed76f60":"code","ea61e315":"code","4e491ada":"code","f6757174":"code","c90b55ed":"code","28ca55ae":"markdown","6653ee3e":"markdown","a9cef98c":"markdown","a474adba":"markdown","4423da86":"markdown","74d36e33":"markdown","ed3d3c7f":"markdown","c72a374d":"markdown","b27e3c86":"markdown","a79999c4":"markdown","de8e7997":"markdown"},"source":{"1d78d5c6":"! apt-get update && apt-get install -y openjdk-8-jdk\n! pip install --upgrade konlpy \"tweepy<4\" scikit-learn\n! bash <(curl -s https:\/\/raw.githubusercontent.com\/konlpy\/konlpy\/master\/scripts\/mecab.sh)","2a05bf79":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nsns.set()","ba70a0f0":"df = pd.read_csv('\/kaggle\/input\/jbnu-iab-text\/train.csv', encoding='utf-8')\ndf","7d8a6f9b":"# \ud559\uc2b5 \ub370\uc774\ud130 \ub808\uc774\ube14 \ubd84\ud3ec\nsns.countplot(data=df, y=\"Label\")  ","6a0f1159":"# \ud559\uc2b5 \ub370\uc774\ud130\uc5d0\uc11c \ubb38\uc7a5 \uae38\uc774 \ubd84\ud3ec\nsents = df['Sent1'].values.tolist() + df['Sent2'].values.tolist()\nlen(sents)","c3049ad7":"a = [1,2,3,4]\nb = [5,6,7,8]\na + b","ff1dd5df":"# counter = []\n# for sent in sents:\n#     counter.append(len(sent))\n    \ncounter = [len(sent) for sent in sents]\nsns.histplot(counter)","62ef9535":"from konlpy.tag import Mecab\n\nmecab = Mecab()","a53f687a":"morphs_tokenizer = mecab.morphs\nmorphs_tokenizer(\"\uc548\ub155\ud558\uc138\uc694\")  # mecab.morphs(\"\uc548\ub155\ud558\uc138\uc694\")","7ae6467d":"morphs_tokenizer = mecab.morphs\nprint(morphs_tokenizer('\uc57c\uad6c \uaddc\uce59\uc744 \uc798 \ubaa8\ub974\uac70\ub098 \uc57c\uad6c\uc7a5\uc5d0 \ucc98\uc74c \uc628 \uc0ac\ub78c\uc774\ub77c\uba74 \uc6b0\uc120 \uc120\uc218\ub4e4\uc774 \uacbd\uae30\ud558\ub294 \ubaa8\uc2b5\uc744 \uc8fc\uc758\uae4a\uac8c \uc0b4\ud3b4 \ubcf8\ub2e4.'))","f3f4675a":"from sklearn.feature_extraction.text import CountVectorizer\n\nvectorizer = CountVectorizer(tokenizer=morphs_tokenizer, max_features=5000)  # 50,000\uac1c vocab\uc744 \uc0ac\uc6a9\nvectorizer.fit(sents)","ff14abd7":"vectorizer.vocabulary_","7ff42eb0":"from sklearn.model_selection import train_test_split\n\ntrain, valid = train_test_split(df, test_size=0.1, random_state=42)","52a1ecea":"X_train = vectorizer.transform(train['Sent1'].values + ' '+ train['Sent2'].values)\ny_train = train['Label'].values.tolist()\n\nX_valid = vectorizer.transform(valid['Sent1'].values + ' '+ valid['Sent2'].values)\ny_valid = valid['Label'].values.tolist()","a3f9f717":"from sklearn.linear_model import LogisticRegression\n\nmodel = LogisticRegression()\nmodel.fit(X_train, y_train)","9ed76f60":"from sklearn.metrics import classification_report\n\ny_pred = model.predict(X_valid)\n\nprint(classification_report(y_valid, y_pred))","ea61e315":"test_df = pd.read_csv('\/kaggle\/input\/jbnu-iab-text\/test.csv', encoding='utf-8')","4e491ada":"X_test = vectorizer.transform(test_df['Sent1'].values + ' '+ test_df['Sent2'].values)","f6757174":"test_df['Label'] = model.predict(X_test)\ntest_df","c90b55ed":"test_df.to_csv('\/kaggle\/working\/submission.csv', index=False, columns=['Id', 'Label'])","28ca55ae":"#### \uad6c\ucd95\ud55c vocab \ucd9c\ub825 (\uc77c\ubd80\ubd84)","6653ee3e":"### Scikit learn\uc744 \ud65c\uc6a9\ud55c Vocabulary \uad6c\ucd95\n- CountVectorizer\ub97c \ud65c\uc6a9\ud558\uc5ec \ube48\ub3c4\uc218 \uc0c1\uc704 50,000\uac1c vocab\uc744 \uad6c\ucd95\n- min_df, max_df \ub4f1 \ub2e4\uc591\ud55c \ud30c\ub77c\ubbf8\ud130\ub4e4\uc774 \uc788\uc73c\ub2c8 API\ub97c \ucc38\uace0\ud558\uc5ec \uad6c\ud604\ud558\uae30 \ubc14\ub78d\ub2c8\ub2e4.","a9cef98c":"### Valid \uc14b\uc73c\ub85c \uad6c\ucd95\ud55c \ubaa8\ub378 \ud3c9\uac00\n- classification_reprot\ub97c \ud65c\uc601\ud558\uc5ec \ud3c9\uac00","a474adba":"### Pandas \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c \uc0ac\uc6a9\ud55c \ud559\uc2b5 \ub370\uc774\ud130 \ubd88\ub7ec\uc624\uae30","4423da86":"### \ud559\uc2b5 \ub370\uc774\ud130 Simple Visualization","74d36e33":"### \uc8fc\uc5b4\uc9c4 \ud559\uc2b5 \ub370\uc774\ud130\ub97c \ud559\uc2b5 \/ \uac80\uc99d \ub370\uc774\ud130 \uc14b\uc73c\ub85c \ubd84\ub9ac","ed3d3c7f":"### \ud55c\uad6d\uc5b4 \ud615\ud0dc\uc18c \ubd84\uc11d\uae30 \uc0ac\uc6a9\n- \uc544\ub798 \ucf54\ub4dc\ub294 Mecab\uc744 \uc774\uc6a9\ud558\uc5ec \ud615\ud0dc\uc18c \ubd84\uc11d\uc744 \uc218\ud589\ud558\ub294 \ucf54\ub4dc\uc785\ub2c8\ub2e4.\n- KoNLPy API\uc5d0 \ub300\ud574\uc11c\ub294 [\ub9c1\ud06c](https:\/\/konlpy-ko.readthedocs.io\/ko\/v0.4.3\/api\/konlpy.tag\/#mecab-class)\ub97c \ucc38\uace0\ud574\uc8fc\uc138\uc694.\n- Mecab \uc678 \ub2e4\ub978 \ud615\ud0dc\uc18c \ubd84\uc11d\uae30\ub4e4\ub3c4 \uc788\uc73c\ub2c8 \ud3b8\ud55c \uac83\uc744 \uc0ac\uc6a9\ud558\uba74 \ub429\ub2c8\ub2e4.","c72a374d":"### \ud55c\uad6d\uc5b4 \ubb38\uc7a5\uc744 \ubd84\uc11d\ud558\uae30 \uc704\ud55c \ub77c\uc774\ube0c\ub7ec\ub9ac \uc124\uce58 (KoNLPy & Mecab)","b27e3c86":"### Logistic regression\uc744 \uc0ac\uc6a9\ud55c \ubd84\ub958 \ubaa8\ub378 \uad6c\ucd95\n- \uc785\ub825\ub41c \ub450 \ubb38\uc7a5\uc744 \ub354\ud574 \uc608\uce21\ud558\ub294 \ubb38\uc81c\ub85c \ubcc0\ud658\ud558\uc5ec \ud574\uacb0\n- sent1 + \\[SEP\\] + sent2\ub97c \uc785\ub825\uc73c\ub85c feature\ub85c \ubf51\uc740 \ud6c4 label\uc744 \uc608\uce21\ud568\n- SVM, Decision Tree, CNN, RNN, BERT\ub4f1\uc744 \uc790\uc720\ub86d\uac8c \uad6c\ud604\ud558\uc5ec \ud14c\uc2a4\ud2b8 \ud558\uae30 \ubc14\ub78c","a79999c4":"### Visualization \ubc0f \ub370\uc774\ud130 \ub85c\ub529\uc744 \uc704\ud55c \ub77c\uc774\ube0c\ub7ec\ub9ac import","de8e7997":"### \ucd5c\uc885\uc801\uc73c\ub85c \uad6c\ucd95\ud55c \ubd84\ub958 \ubaa8\ub378\uc744 \uc0ac\uc6a9\ud558\uc5ec \ud3c9\uac00 \ub370\uc774\ud130\uc5d0 \ub300\ud574 \uc608\uce21\uc744 \uc218\ud589\n- \ud559\uc2b5\ub41c \ubd84\ub958 \ubaa8\ub378\uc744 \uc0ac\uc6a9\ud558\uc5ec test.csv\uc758 label\uc744 \uc608\uce21"}}