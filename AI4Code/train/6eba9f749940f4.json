{"cell_type":{"2342d3fd":"code","64312d07":"code","7bb36cc0":"code","01830c70":"code","84d8a829":"code","26e53708":"code","a65850a3":"code","ed115842":"code","d9878dba":"code","7347c9b1":"code","570d4826":"code","22e7dbf9":"code","02384897":"code","b1c74042":"code","49b7d5db":"code","87079ae1":"code","345b771b":"code","38e1eb5b":"code","6dede17b":"code","1c0442ae":"code","e7c33d67":"code","ec8dfefa":"code","9b93e6df":"code","d7e9f9d1":"code","ad1dde72":"code","1a3c1e70":"code","d8503b28":"markdown","a0ef2484":"markdown"},"source":{"2342d3fd":"import pandas as pd\nimport numpy as np\nimport statsmodels.api as sm\nimport statsmodels.formula.api as smf\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.cluster import KMeans\nfrom sklearn import linear_model\nfrom sklearn.metrics import mean_squared_error, r2_score\ncolor = sns.color_palette()\nfrom IPython.core.display import display, HTML\ndisplay(HTML(\"<style>.container { width:100% !important; }<\/style>\"))\n%matplotlib inline","64312d07":"attendance_valuation_elo_df = pd.read_csv(\"..\/input\/nba_2017_att_val_elo.csv\");attendance_valuation_elo_df.head()","7bb36cc0":"salary_df = pd.read_csv(\"..\/input\/nba_2017_salary.csv\");salary_df.head()","01830c70":"twiter_df = pd.read_csv(\"..\/input\/nba_2017_twitter_players.csv\");twiter_df.head()","84d8a829":"plus_minus_df = pd.read_csv(\"..\/input\/nba_2017_real_plus_minus.csv\");plus_minus_df.head()","26e53708":"attendance_valuation_elo_df.drop([\"Unnamed: 0\",\"CONF\"], axis=1, inplace=True); attendance_valuation_elo_df.head()","a65850a3":"salary_df[\"SALARY_MILLIONS\"] = round(salary_df[\"SALARY\"]\/1000000, 2)\nsalary_df.drop([\"POSITION\", \"TEAM\", \"SALARY\"], inplace=True, axis=1);salary_df.head()","ed115842":"plus_minus_df[\"NAME\"]=plus_minus_df[\"NAME\"].str.split(\",\").str[0]; plus_minus_df.head()\n# plus_minus_df.drop([\"TEAM\"], axis=1, inplace=True); plus_minus_df.head()","d9878dba":"twiter_df.rename(columns={\"PLAYER\":\"NAME\"}, inplace=True)\ntwiter_df[[\"TWITTER_FAVORITE_COUNT\", \"TWITTER_RETWEET_COUNT\"]].astype(float); twiter_df.head()","7347c9b1":"#Merge tables \nmerge_tbl_1 = pd.merge(plus_minus_df, salary_df, left_on=\"NAME\", right_on=\"NAME\", how=\"left\"); merge_tbl_1.head()\nmerge_tbl = pd.merge(merge_tbl_1, twiter_df, left_on=\"NAME\", right_on=\"NAME\", how=\"left\"); merge_tbl.head()\n","570d4826":"ax=sns.pairplot(plus_minus_df)","22e7dbf9":"\nplt.subplots(figsize=(20,15))\nax = plt.axes()\nax.set_title(\"NBA Player Correlation Heatmap:  2016-2017\")\ncorr = merge_tbl.corr()\n#insert mask\nmask = np.zeros_like(corr)\nmask[np.triu_indices_from(mask)] = True\nwith sns.axes_style(\"white\"): sns.heatmap(corr, mask=mask, xticklabels=corr.columns.values, yticklabels=corr.columns.values)\n","02384897":"corr","b1c74042":"sns.lmplot(x=\"WINS\", y=\"TWITTER_FAVORITE_COUNT\", data=merge_tbl)","49b7d5db":"sns.lmplot(x=\"WINS\", y=\"TWITTER_RETWEET_COUNT\", data=merge_tbl)\n","87079ae1":"sns.lmplot(x=\"GP\", y=\"WINS\", data=merge_tbl)\n","345b771b":"sns.lmplot(x=\"MPG\", y=\"WINS\", data=merge_tbl)\n","38e1eb5b":"sns.lmplot(x=\"DRPM\", y=\"WINS\", data=merge_tbl)\n","6dede17b":"merge_tbl.info()","1c0442ae":"#Fill NA\nmerge_tbl[[\"TWITTER_FAVORITE_COUNT\",\"TWITTER_RETWEET_COUNT\"]]=merge_tbl[[\"TWITTER_FAVORITE_COUNT\",\"TWITTER_RETWEET_COUNT\"]].fillna(0)\n","e7c33d67":"merge_tbl = merge_tbl.dropna()\nlen(merge_tbl)","ec8dfefa":"# select the least correlated variables for linear regression; avoid autocorrelation\n#GP, DRPM, MPG, SALARY_MILLIONS\ny_train=merge_tbl[:301][\"WINS\"]\nx_train=merge_tbl[:301][[\"GP\",\"MPG\",\"DRPM\",\"SALARY_MILLIONS\"]]\n\ny_test = merge_tbl[301:][\"WINS\"]\nx_test = merge_tbl[301:][[\"GP\",\"MPG\",\"DRPM\",\"SALARY_MILLIONS\"]]\n","9b93e6df":"# Create linear regression object\nregr = linear_model.LinearRegression()\n\n# Train the model using the training sets\nresults = regr.fit(x_train, y_train)\n\n# Make predictions using the testing set\ny_pred = regr.predict(x_test)\n\nprint(results)\n# The coefficients\nprint('Coefficients: \\n', regr.coef_)\n# The mean squared error\nprint(\"Mean squared error: %.2f\"\n      % mean_squared_error(y_test, y_pred))\n# Explained variance score: 1 is perfect prediction\nprint('Variance score: %.2f' % r2_score(y_test, y_pred))","d7e9f9d1":"results = smf.ols('WINS ~ GP+MPG+DRPM+SALARY_MILLIONS', data=merge_tbl).fit()\nprint(results.summary())\n","ad1dde72":"merge_tbl[\"TWITTER_RETWEET\"] = merge_tbl[\"TWITTER_RETWEET_COUNT\"].apply(lambda x: 1\/x if x != 0 else 0)\n","1a3c1e70":"results = smf.ols('WINS ~ GP+MPG+DRPM+SALARY_MILLIONS+TWITTER_RETWEET', data=merge_tbl).fit()\nprint(results.summary())","d8503b28":"Exploration of How Social Media Can Predict Winning Metrics Better Than Salary","a0ef2484":"**Data Preprocessing**"}}