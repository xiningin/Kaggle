{"cell_type":{"aaaddb8a":"code","55931d30":"code","dbebe05b":"code","e6f8214f":"code","89f5c62a":"code","fc72927d":"code","aafcffdf":"code","d188fef6":"code","2ee6448d":"code","1ca36449":"code","f8bea4e4":"code","f54c82b2":"code","fff63587":"code","5f5828c9":"code","02fa283a":"code","50996297":"code","613b6de7":"code","2eafa6fa":"code","7e9a038b":"code","b201a90c":"code","5568ac07":"code","bff78d27":"code","e1396ee0":"code","0a5a2320":"code","6487fe42":"code","79570cde":"code","4fe2578d":"code","947d208d":"markdown","335d852a":"markdown","d6f65e80":"markdown","1d45702c":"markdown","1e357cc2":"markdown","7a2cdeaa":"markdown","e5a6df51":"markdown","64fd78e8":"markdown"},"source":{"aaaddb8a":"import numpy as np\nimport pandas as pd \nimport seaborn as sns \nimport matplotlib.pyplot as plt\nfrom yellowbrick.cluster import KElbowVisualizer\nfrom xgboost import XGBClassifier\nfrom sklearn.model_selection import train_test_split, cross_val_score\nfrom sklearn.metrics import classification_report\nimport sklearn.metrics as metrics\n\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","55931d30":"df=pd.read_csv(\"\/kaggle\/input\/german-credit-data-with-risk\/german_credit_data.csv\")\ndf.drop(df.columns[[0]],axis=1,inplace=True)","dbebe05b":"sns.set(style=\"darkgrid\")\nsns.boxenplot(x=\"Purpose\", y=\"Credit amount\",\n              color=\"r\",\n              scale=\"linear\", data=df);","e6f8214f":"df1=pd.read_csv(\"..\/input\/german-credit-dataset-without-vacationothers\/german_credit_data1.csv\")\ndf1.head()","89f5c62a":"df1[\"Saving accounts\"].fillna(\"no_account\",inplace=True)\ndf1[\"Checking account\"].fillna(\"no_account\",inplace=True)","fc72927d":"add = pd.DataFrame(\n        {'Housing': pd.Categorical(\n              values =  df1[\"Housing\"],\n              categories=[\"free\",\"rent\",\"own\"]),\n\n         'Saving accounts': pd.Categorical(\n             values = df1[\"Saving accounts\"],\n             categories=[\"no_account\",\"little\",\"moderate\",\"rich\",\"quite rich\"]),\n\n         'Checking account': pd.Categorical(\n             values = df1[\"Checking account\"],\n             categories=[\"no_account\",\"little\",\"moderate\",\"rich\"]),\n         'Purpose': pd.Categorical(\n             values = df1[\"Purpose\"],\n             categories=[\"repairs\",\"domestic appliances\",\"furniture\/equipment\"\n                         ,\"radio\/TV\",\"education\",\"business\",\"car\"])\n        }\n    )","aafcffdf":"add = add.apply(lambda x: x.cat.codes)\nadd.head()","d188fef6":"del df1[\"Saving accounts\"]\ndel df1[\"Checking account\"]\ndel df1[\"Housing\"]\ndel df1[\"Purpose\"]\ndf2 = pd.concat([df1,add],axis=1)\ndf2.head()","2ee6448d":"df2=pd.get_dummies(df2, columns = [\"Sex\"], prefix = [\"Sex\"])\ndf2=pd.get_dummies(df2, columns = [\"Risk\"], prefix = [\"Risk\"])","1ca36449":"del df2[\"Sex_male\"]\ndel df2[\"Risk_bad\"]\ndf2.rename(columns={\"Risk_good\":\"Risk\",\n                  \"Sex_female\":\"Sex\"},inplace=True)\n","f8bea4e4":"from sklearn.cluster import KMeans\ndegiskenler = ['Checking account', 'Risk', 'Duration', 'Purpose',\"Credit amount\",\n       'Saving accounts', 'Housing', 'Sex']\nkumeleme = df2.drop(degiskenler,axis=1)\nkumeleme","f54c82b2":"kmeans = KMeans()\nvisu = KElbowVisualizer(kmeans, k = (2,20))\nvisu.fit(kumeleme)\nvisu.poof()","fff63587":"k_means = KMeans(n_clusters = 3).fit(kumeleme)\ncluster = k_means.labels_\ndf2[\"Age\"] = cluster","5f5828c9":"degiskenler = ['Job', 'Age', 'Duration', 'Risk',\"Housing\",\n       'Saving accounts', 'Checking account', 'Sex']\nkumeleme = df2.drop(degiskenler,axis=1)\nkumeleme","02fa283a":"kmeans = KMeans()\nvisu = KElbowVisualizer(kmeans, k = (2,20))\nvisu.fit(kumeleme)\nvisu.poof()","50996297":"k_means = KMeans(n_clusters = 4).fit(kumeleme)\ncluster = k_means.labels_\ndf2[\"Credit amount\"] = cluster","613b6de7":"degiskenler = ['Job', 'Age', 'Checking account', 'Purpose',\"Housing\",\n       'Saving accounts', 'Credit amount', 'Sex']\nkumeleme = df2.drop(degiskenler,axis=1)\nkumeleme","2eafa6fa":"kmeans = KMeans()\nvisu = KElbowVisualizer(kmeans, k = (2,20))\nvisu.fit(kumeleme)\nvisu.poof()","7e9a038b":"k_means = KMeans(n_clusters = 3).fit(kumeleme)\ncluster = k_means.labels_\ndf2[\"Duration\"] = cluster","b201a90c":"degiskenler = ['Job', 'Age', 'Checking account', 'Duration',\"Housing\",\n       'Saving accounts', 'Credit amount', 'Sex']\nkumeleme = df2.drop(degiskenler,axis=1)\nkumeleme","5568ac07":"k_means = KMeans(n_clusters = 4).fit(kumeleme)\ncluster = k_means.labels_\ndf2[\"Purpose\"] = cluster","bff78d27":"df2.head()","e1396ee0":"y = df2[\"Risk\"]\nX = df2.drop([\"Risk\"], axis = 1)\nX_train, X_test, y_train, y_test = train_test_split(X, y, \n                                                    test_size=0.30, \n                                                    random_state=536)","0a5a2320":"xgb_tuned = XGBClassifier(learning_rate= 0.01, \n                                max_depth= 3,\n                          min_child_weight = 38,\n                                n_estimators= 500, \n                                subsample= 0.8).fit(X_train, y_train)\ny_pred = xgb_tuned.predict(X_test)","6487fe42":"print(classification_report(y_test, y_pred))","79570cde":"fpr, tpr, threshold = metrics.roc_curve(y_test, y_pred)\nroc_auc = metrics.auc(fpr, tpr)\nplt.title('Receiver Operating Characteristic')\nplt.plot(fpr, tpr, 'b', label = 'AUC = %0.2f' % roc_auc)\nplt.legend(loc = 'lower right')\nplt.plot([0, 1], [0, 1],'r--')\nplt.xlim([0, 1])\nplt.ylim([0, 1])\nplt.ylabel('True Positive Rate')\nplt.xlabel('False Positive Rate')\nplt.show()","4fe2578d":"feature_imp = pd.Series(xgb_tuned.feature_importances_,\n                        index=X_train.columns).sort_values(ascending=False)\n\nsns.barplot(x=feature_imp, y=feature_imp.index)\nplt.xlabel('Importance')\nplt.ylabel('Features')\nplt.title(\"Features Skor Levels\")\nplt.show()","947d208d":"\nThis work continues with the information tested and identified in the previous \"Credit Risk Data Analysis and Modeling\" notebook. I recommend that you review the \"Credit Risk Data Analysis and Modeling\" notebook first.","335d852a":"* Purpose Variable","d6f65e80":"* Credit Amount Variable","1d45702c":"* Duration Variable","1e357cc2":"#  ML Modeling","7a2cdeaa":"According to the tests conducted, the \"Purpose\" variable did not seem meaningful. As seen in the table above, \"vacation \/ others\" variable has high variance. From here on, we will continue to work by removing the \"vacation \/ others\" variable from the data.","e5a6df51":"* Age Variable","64fd78e8":"# Clustering"}}