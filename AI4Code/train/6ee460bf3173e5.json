{"cell_type":{"97d30545":"code","015085f0":"code","3d44de3f":"code","a451272a":"code","e4dec674":"code","952e7353":"code","08422479":"code","36ca7c08":"markdown","819ae096":"markdown","d6192129":"markdown","69899d65":"markdown","dd279d4f":"markdown"},"source":{"97d30545":"import numpy as np\nimport pandas as pd\nimport sqlite3   # Library required to read db file\nimport matplotlib.pyplot as plt\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","015085f0":"!curl -L -o \"\/kaggle\/working\/covid-india.db\" \"https:\/\/www.dropbox.com\/s\/hbe04q6vtzapdam\/covid-india.db?dl=1\"","3d44de3f":"def run_query(querystr: str) -> list:\n    con = sqlite3.connect('\/kaggle\/working\/covid-india.db')\n    cursor = con.cursor()\n    cursor.execute(querystr)\n    data = cursor.fetchall()\n    con.close()\n    return data","a451272a":"querystr = 'SELECT D1.date AS date, D1.cases_positive as DL, K1.positive_cases AS KL, K2.cases_new AS KA ' + \\\n            'FROM DL_case_info D1 JOIN KL_daily_summary K1 on D1.date == K1.date ' + \\\n            'JOIN KA_case_info K2 ON D1.date == K2.date ORDER BY date'\n\ndata = run_query(querystr)   # the returned data is a list of tuples (date, DL_occupancy, WB_occupancy)\n\ndata = pd.DataFrame(data, columns=['Date', 'DL', 'KL', 'KA'])\ndata.head()","e4dec674":"data.plot(x='Date', title='Daily new confirmed cases')","952e7353":"querystr = 'SELECT D1.date, D2.hospital_beds_occupied * 100.0 \/ D2.hospital_beds_total AS DL_occupancy, ' + \\\n            'W1.covid19_bed_occupancy AS WB_occupancy FROM DL_case_info D1 JOIN DL_patient_mgmt D2 ON D1.date == D2.date ' + \\\n            'JOIN WB_hospital W1 ON D1.date == W1.date ORDER BY D1.date ASC'\n\ndata = run_query(querystr)   # the returned data is a list of tuples (date, DL_occupancy, WB_occupancy)\n\ndata = pd.DataFrame(data, columns=['Date', 'DL_occupancy', 'WB_occupancy'])\ndata.head()","08422479":"data.plot(x='Date', title='COVID-19 Bed Occupancy in DL and WB')","36ca7c08":"## Analysis 2: COVID-19 Bed Occupancy","819ae096":"## Step 1: Download the data\n\nWe first need to download the latest version of the database from the dropbox folder into the local directory. We will run all our queries against this local db file","d6192129":"## Step 2: Access the data\n\nHaving downloaded a local copy of the remote data, we can now run SQL queries against it. \n\nThe Wiki here [https:\/\/github.com\/IBM\/covid19-india-data\/wiki\/States](https:\/\/github.com\/IBM\/covid19-india-data\/wiki\/States) provides the schema (tables, and columns) of the database","69899d65":"**This notebook demonstrated a simple workflow of loading the database and executing queries against it to extract the data. You can use this notebook as reference to run more complex queries against the database and model\/analyse\/visualize various aspects of the data**","dd279d4f":"## Analysis 1: Daily new cases"}}