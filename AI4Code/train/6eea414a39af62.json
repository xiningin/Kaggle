{"cell_type":{"89723fa1":"code","1aac69ed":"code","a96b9a55":"code","6b789f1a":"code","3eb1747a":"code","99793bf6":"code","1a34330b":"code","789bfe5d":"code","27a78198":"code","513cafab":"code","9bd02e64":"code","f989bcfd":"code","11751717":"code","83d0999a":"code","3d9b873a":"code","1fb2adf0":"code","4043d12b":"code","1762b0af":"code","a4017100":"code","8f4a85a7":"code","bc0e8d2b":"code","d516f771":"code","10ab37dd":"code","87f4756e":"code","25a1e581":"code","1a407316":"code","7e5e5c5d":"markdown","466cdfaa":"markdown","4e2dfb66":"markdown","c7ea4d40":"markdown","a816a1bd":"markdown","bcbf748b":"markdown","4d89cda0":"markdown","29cc90f2":"markdown","e05f93f0":"markdown","5e241591":"markdown","712e79fc":"markdown","a38146f9":"markdown"},"source":{"89723fa1":"# Importing necessary Library\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style('whitegrid')\n%matplotlib inline","1aac69ed":"#Importing input data\ntrain=pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')\ndf_train=pd.DataFrame(train)","a96b9a55":"df_train.shape","6b789f1a":"df_train.head()","3eb1747a":"df_train.info()","99793bf6":"for i in df_train.columns:\n    print(f'total unique values for {i} column is: {df_train[i].value_counts().count()}')","1a34330b":"cat=['thall','caa','slp','exng','restecg','fbs','cp','sex']\nnum=['age','thalachh','chol','trtbps']","789bfe5d":"plt.figure(figsize=(12,6))\nsns.heatmap(df_train.corr(),annot=True,cmap='Blues')\nplt.title('Correlation between Columns')","27a78198":"# Simple function for ploting the graphs\ndef ploting_graph(cat):\n    for i in cat:\n        plt.figure(figsize=(8,5))\n        sns.barplot(x=i,y='output',data=df_train)\n        plt.title(f'{i} vs Output')","513cafab":"ploting_graph(cat)","9bd02e64":"from sklearn.preprocessing import LabelEncoder\nle=LabelEncoder()","f989bcfd":"for i in num:\n    df_train[i]=pd.cut(df_train[i].astype(int),4)\n    df_train[i]=le.fit_transform(df_train[i])","11751717":"df_train['bpchol']=df_train['chol']+df_train['trtbps']","83d0999a":"drop_column=['chol','trtbps','fbs','output']","3d9b873a":"# Plotting graphs after binning and label-encoding those numerical columns\nploting_graph(num)","1fb2adf0":"df_y=df_train['output']\ndf_train.drop(drop_column,axis=1,inplace=True)","4043d12b":"df_train.head()","1762b0af":"from sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import cross_val_score, GridSearchCV,train_test_split\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import classification_report,plot_confusion_matrix\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import SVC","a4017100":"ss=StandardScaler()\nscale_train=ss.fit_transform(df_train)\ndf_scaled_train=pd.DataFrame(scale_train,columns=df_train.columns)","8f4a85a7":"X_train, X_test, y_train, y_test=train_test_split(df_scaled_train, df_y, test_size=0.2, random_state=42)","bc0e8d2b":"X_train.shape","d516f771":"#A dictionary of ML Models for cross-validating results of different algorithms.\n# This Dictonary is adapted from the link: https:\/\/www.kaggle.com\/rashikrahmanpritom\/heart-attack-prediction?rvi=1&scriptVersionId=57435788&cellId=14\nmodel_list = {  \n    'KNeighborsClassifier': { \n        'model': KNeighborsClassifier(),\n        'params': {\n            'n_neighbors': [2,3,4,5,6,7,18,19,20],\n            'algorithm' : ['auto','ball_tree'],\n            'weights' : ['uniform','distance'],\n            'leaf_size' : [27,28,29,30,31]\n        }\n    },\n    \n    'DecisionTreeClassifier': {\n        'model': DecisionTreeClassifier(),\n        'params': {\n            'criterion': ['gini','entropy'],\n            'max_depth' : [None,1,2,6,5]\n        }\n    },\n     \n    \n     'LOGISTIC_REGRESSION': {\n        'model': LogisticRegression(),\n        'params': {\n            'C': [1,2,3,4,5,6,7],\n            'solver' : [ 'liblinear', 'lbfgs'],\n            'multi_class' : ['auto', 'ovr' ]\n        }\n    },\n    \n        \n    'SVM': {\n        'model': SVC(),\n        'params': {\n             'C': [1,2,3,5,6,7],\n             'kernel': ['rbf','linear'],\n             'gamma': ['auto', 'scale']\n        }\n    },\n       \n    'RANDOM_FOREST':{\n        'model' : RandomForestClassifier(),\n        'params': {\n            'n_estimators':[1,2,3,4,5,10,15],\n            'criterion': ['entropy'],\n            'random_state' : [12,13],\n            'max_depth' : [5,6]\n\n        }\n    }\n}","10ab37dd":"for model_name, mp in model_list.items():\n    print(f'model_name: {model_name}')\n    clf = GridSearchCV(mp['model'], mp['params'], cv=15)\n    clf.fit(X_train,y_train)\n    print(f'Best score:{clf.best_score_}')\n    print(f'Best parameters:{clf.best_params_}\\n\\n')","87f4756e":"svm=SVC(C=1, gamma='auto', kernel='rbf')\nsvm.fit(X_train,y_train)\npredict=svm.predict(X_test)\nprint(classification_report(y_test,predict))","25a1e581":"plot_confusion_matrix(svm,X_test,y_test,cmap='viridis')\nplt.show()","1a407316":"# Thank you all for your patience. I am new to ML. Hope, this will help some beginners like me.","7e5e5c5d":"**We are adding two columns 'chol' and 'trtbps' to create a new column named 'bpchol'**","466cdfaa":"**From the above graphs we can say that the fbs column which is fasting blood sugar does not really give us clear indication of the heart attack. We will drop this column in our training set.**","4e2dfb66":"**Standard Scaling all the columns before splitting into test and train sets.**","c7ea4d40":"**As SVM shows most promising result. We will go and predict the output with this one.**","a816a1bd":"# Label Encoding: binning_column","bcbf748b":"** Dataset Description:** \n* age : Age of the patient \n* sex : Sex of the patient \n* cp : Chest Pain \n* trtbps : resting blood pressure (in mm Hg) \n* chol : cholestoral in mg\/dl \n* fbs : fasting blood sugar \n* restecg : resting electrocardiographic results \n* thalachh : Maximum heart rate exang: exercise induced angina \n* oldpeak : Previous peak slp : Slope caa: number of major vessels \n* output : 0= less chance of heart attack 1= more chance of heart attack","4d89cda0":"**We are droping four columns including 'output' column. 'chol' and 'trtbps' columns are dropped because we have a new column with their values. The reason for dropping 'fbs' has already been discussed.**","29cc90f2":"**We can divide the column into categorical and numerical valued columns from above information**","e05f93f0":"**Splitting train and test sets. (80\/20)**","5e241591":"# Training Model\n**Importing libraries for Model creating, testing and predicting**","712e79fc":"# Overview of the dataset","a38146f9":"**Splitting 'output' column(which we will be predicting) from the dataset.**"}}