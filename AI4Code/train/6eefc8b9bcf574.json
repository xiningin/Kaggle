{"cell_type":{"0dacfcb4":"code","582f5083":"code","f13ffe99":"code","25aa88d0":"code","4f3470a7":"code","257ef291":"code","6ffcf8fd":"code","8cbad1e7":"markdown","361c14ec":"markdown","02c453ec":"markdown","0622ff7e":"markdown"},"source":{"0dacfcb4":"import seaborn as sns \nimport matplotlib.pyplot as plt \nimport pandas as pd \ndf = pd.read_csv(\"..\/input\/1-million-bank-transactions\/bank_transactions.csv\")\n\ndf['CustDOB'] = pd.to_datetime(df[\"CustDOB\"])\ndf['TransactionDate'] = pd.to_datetime(df[\"TransactionDate\"])\n\ndf['CustBornYear'] = df['CustDOB'].dt.year\ndf['CustBornMonth'] = df['CustDOB'].dt.month\ndf['TransactionDay'] = df['TransactionDate'].dt.day\ndf['TransactionDayOfWeek'] = df['TransactionDate'].dt.dayofweek\n\ndf.head()","582f5083":"def round_me(x): return round(x)\ndf.describe().apply(round_me)","f13ffe99":"def uniques(df, col):\n    vc = df[col].value_counts().reset_index().rename(columns = {\"index\" : col, col : \"Count\"})\n    total = sum(vc['Count'])\n    vc['Percent'] = vc['Count'].apply(lambda x : round(100 * x \/ total, 2))\n    return vc\n\ndef plot_uniques(df, col, limit = 10):\n    u = uniques(df, col)\n    # display(u[:limit])\n    \n    plt.figure(figsize=(6, 8))\n    sns.barplot(y = u[:limit][col].astype(str), x = u[:limit]['Percent'])\n    plt.title(\"Top \" + col + \" by Transactions\", fontsize=16);\n    plt.ylabel(\"\");\n    plt.xlabel(\"Percent\", fontsize=12);\n    plt.yticks(fontsize=12);\n    \nplot_uniques(df, 'Merchant', 10)\nplot_uniques(df, 'CustLocation', 10)","25aa88d0":"plot_uniques(df, 'CustBornMonth', 10)","4f3470a7":"def aggregate(df, col):\n    agg_df = df.groupby(col).agg({\"TransactionAmount\" : \"mean\", \"CustID\" : \"count\"}).reset_index()\n    agg_df = agg_df.sort_values(\"TransactionAmount\", ascending = False)\n    agg_df = agg_df.rename(columns = {\"TransactionAmount\" : \"Average Transaction Amount\", \"CustID\" : \"Number of Transactions\"})\n    return agg_df[agg_df['Number of Transactions'] > 10].head(20)\n\naggregate(df, 'Merchant')","257ef291":"aggregate(df, 'CustLocation')","6ffcf8fd":"aggregate(df, 'CustBornMonth')","8cbad1e7":"### Data Characteristics \nStatistical Measures for different columns","361c14ec":"Aggregated view of Transactions by Merchant, Locations","02c453ec":"## Quick EDA - 1 Million Bank Transactions\n\nLoading the dataset","0622ff7e":"Top Merchants, Locations in the dataset"}}