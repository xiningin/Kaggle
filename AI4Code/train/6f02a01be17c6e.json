{"cell_type":{"4b789618":"code","f3a830c7":"code","0a981daf":"code","65fec04c":"code","6e990991":"code","d008de25":"code","32614572":"code","ecc058bb":"code","768894ff":"code","6912ca80":"code","75a37f5d":"code","68d9fc2e":"code","71a8b0b4":"code","e062773d":"code","2811a2e4":"code","88838d32":"code","b793bba8":"code","c0102c29":"code","8c7a153e":"code","727741e6":"code","ff4dcd09":"code","9cd0744a":"code","1498c4bb":"code","4fe8fc53":"code","3a13de62":"code","9c7f4576":"code","77415f68":"code","12c91369":"code","a7bf605e":"code","11421cde":"code","43925ad3":"code","16c8fab3":"code","e66c8cdc":"code","5eb00eb7":"code","ac0c61e0":"code","2ea11b53":"code","79a14e66":"code","89cb2ce6":"code","fc3fd689":"code","2a77c801":"code","7344eb49":"code","17b8be1a":"code","efa1490a":"code","a2f1487c":"code","9c9ed4ee":"code","28b1c7e0":"code","5cc9fbbe":"code","8904c42e":"code","75ce2bd0":"code","81dc1600":"code","a2307c15":"code","c82fbf69":"code","d7c4a536":"code","14abf50e":"code","a3219ec6":"code","5d88a181":"code","3f694664":"code","caea1722":"code","70c0a947":"code","ee512295":"code","765927a0":"code","29cbb6f2":"code","e6deb110":"code","236e8586":"code","31c1a601":"code","636923aa":"code","082c3cb3":"markdown","5a0b433e":"markdown","2075df7b":"markdown","7ce60e0d":"markdown","5520596e":"markdown","10b59f4f":"markdown","0291528b":"markdown","7d2fd607":"markdown","0d0ab662":"markdown","1c28af8f":"markdown","aeadccd3":"markdown","c800ae15":"markdown","02569767":"markdown","5791c512":"markdown","df5ab63c":"markdown","9c3c3cf2":"markdown","abb0a9cf":"markdown","dd5ec27b":"markdown","953c2eda":"markdown","6c7c72ca":"markdown","576e3fac":"markdown","5456c9b9":"markdown","033e6c7b":"markdown","601ca527":"markdown","900693a2":"markdown","4c89db20":"markdown","3fc28fe5":"markdown","4cbf12f6":"markdown","07debfd0":"markdown","f5ed49b5":"markdown","0de1bc66":"markdown","5a84838a":"markdown","8fec7ea1":"markdown","dfcbda81":"markdown","711a7c35":"markdown","1d359cf7":"markdown","2400d574":"markdown","456b14be":"markdown","6e7c6133":"markdown","79b8bbab":"markdown","469f29b0":"markdown","0706823a":"markdown","0c0b1976":"markdown","5632b91d":"markdown","78752bd4":"markdown","0cbbdfe9":"markdown","a3cbddb6":"markdown","c298bb98":"markdown","e83a8a89":"markdown","1c49ae38":"markdown"},"source":{"4b789618":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","f3a830c7":"!pip install openpyxl","0a981daf":"df=pd.read_excel('..\/input\/ecommerce-platform-analysis-and-prediction\/E-commerce.xlsx')\ndf.head()","65fec04c":"#Setting option to show max rows and max columns\npd.set_option(\"display.max_columns\",None)\npd.set_option(\"display.max_rows\", None)","6e990991":"from string import digits\n\n#Removing tab spaces\ndf.columns = df.columns.str.replace('\\t','')\n\n#Removing digits\nremove_digits = str.maketrans('', '', digits)\ndf.columns = df.columns.str.translate(remove_digits)\n\n#Removing leading and trailling spaces\ndf.columns = df.columns.str.strip()","d008de25":"df.head()","32614572":"df.shape","ecc058bb":"df.dtypes","768894ff":"df.isnull().sum().any()","6912ca80":"df.nunique()","75a37f5d":"personal_info=['Gender of respondent','How old are you?','Which city do you shop online from?',\n               'What is the Pin Code of where you shop online from?','Since How Long You are Shopping Online ?',\n                   'How many times you have made an online purchase in the past  year?']","68d9fc2e":"for i in personal_info:\n    if i!='What is the Pin Code of where you shop online from?':\n        plt.figure(figsize=(8,6))\n        df[i].value_counts().plot.pie(autopct='%1.1f%%')\n        centre=plt.Circle((0,0),0.7,fc='white')\n        fig=plt.gcf()\n        fig.gca().add_artist(centre)\n        plt.xlabel(i)\n        plt.ylabel('')\n        plt.figure()","71a8b0b4":"#Resolving ambiguity of column \n#Changing 42 times and above to 41 times and above\ndf['How many times you have made an online purchase in the past  year?'].replace('42 times and above','41 times and above',\n                                                                                inplace=True)","e062773d":"plt.figure(figsize=(15,8))\nsns.lineplot(df['How many times you have made an online purchase in the past  year?'],\n              df['From the following, tick any (or all) of the online retailers you have shopped from;'])","2811a2e4":"dict={'31-40 times':35,'41 times and above':45,'Less than 10 times':5,'11-20 times':15,'21-30 times':25}\ndf['Average times made an online purchase']=df['How many times you have made an online purchase in the past  year?'].replace(dict)","88838d32":"plt.figure(figsize=(20,8))\nsns.violinplot(df['From the following, tick any (or all) of the online retailers you have shopped from;'],\n               df['Average times made an online purchase'],hue=df['You feel gratification shopping on your favorite e-tailer'])\nplt.xticks(rotation=45)","b793bba8":"plt.figure(figsize=(20,8))\nsns.violinplot(df['From the following, tick any (or all) of the online retailers you have shopped from;'],\n               df['Average times made an online purchase'],hue=df['Gaining access to loyalty programs is a benefit of shopping online'])\nplt.xticks(rotation=45)","c0102c29":"plt.figure(figsize=(10,8))\nsns.countplot(df['Since How Long You are Shopping Online ?'],hue=df['How old are you?'])","8c7a153e":"df['Since How Long You are Shopping Online ?'].unique()","727741e6":"dict={'Above 4 years':4.5,'3-4 years':3.5,'2-3 years':2.5,'1-2 years':1.5,'Less than 1 year':0.5}\ndf['Average years of shopping online']=df['Since How Long You are Shopping Online ?'].replace(dict)","ff4dcd09":"df['Which city do you shop online from?'].unique()","9cd0744a":"#Changing Greater noida to noida\ndf['Which city do you shop online from?'].replace({'Greater Noida':'Noida'},inplace=True)","1498c4bb":"plt.figure(figsize=(15,8))\nsns.lineplot(df['Which city do you shop online from?'],df['Average years of shopping online'],hue=df['Gender of respondent'])","4fe8fc53":"plt.figure(figsize=(10,8))\nsns.countplot(df['Since How Long You are Shopping Online ?'],\n              hue=df['After first visit, how do you reach the online retail store?'])","3a13de62":"performance=['Easy to use website or application',\n       'Visual appealing web-page layout', 'Wild variety of product on offer',\n       'Complete, relevant description information of products',\n       'Fast loading website speed of website and application',\n       'Reliability of the website or application',\n       'Quickness to complete purchase',\n       'Availability of several payment options', 'Speedy order delivery',\n       'Privacy of customers\u2019 information',\n       'Security of customer financial information',\n       'Perceived Trustworthiness',\n       'Presence of online assistance through multi-channel']","9c7f4576":"for i in performance:\n        plt.figure(figsize=(8,6))\n        df[i].value_counts().plot.pie(autopct='%1.1f%%')\n        centre=plt.Circle((0,0),0.7,fc='white')\n        fig=plt.gcf()\n        fig.gca().add_artist(centre)\n        plt.xlabel(i)\n        plt.ylabel('')\n        plt.figure()","77415f68":"plt.figure(figsize=(12,10))\nsns.stripplot(df['Why did you abandon the \u201cBag\u201d, \u201cShopping Cart\u201d?'],\n              df['From the following, tick any (or all) of the online retailers you have shopped from;'])","12c91369":"#Collecting all the negative remarks about a brand\nbad=['Longer time to get logged in (promotion, sales period)',\n       'Longer time in displaying graphics and photos (promotion, sales period)',\n       'Late declaration of price (promotion, sales period)',\n       'Longer page loading time (promotion, sales period)',\n       'Limited mode of payment on most products (promotion, sales period)',\n       'Longer delivery period', 'Change in website\/Application design',\n       'Frequent disruption when moving from one page to another']","a7bf605e":"for i in bad:\n        plt.figure(figsize=(15,6))\n        sns.countplot(df[i],hue=df['Which of the Indian online retailer would you recommend to a friend?'])\n        plt.xticks(rotation=45)\n        plt.figure()","11421cde":"x=df.copy()\nx.drop('Which of the Indian online retailer would you recommend to a friend?',axis=1,inplace=True)\ny=df['Which of the Indian online retailer would you recommend to a friend?']","43925ad3":"cat=[i for i in x.columns if x[i].dtypes=='O']","16c8fab3":"from sklearn.preprocessing import OrdinalEncoder,LabelEncoder\nencode=OrdinalEncoder()\nlabe=LabelEncoder()","e66c8cdc":"#using ordinal encoder for independent features\nfor i in cat:\n    x[i]=encode.fit_transform(x[i].values.reshape(-1,1))\n\n#Using label encoder for Label Column\ny=labe.fit_transform(y)","5eb00eb7":"from sklearn.preprocessing import MinMaxScaler\nscaler=MinMaxScaler()","ac0c61e0":"xd=scaler.fit_transform(x)\nx=pd.DataFrame(xd,columns=x.columns)","2ea11b53":"from sklearn.ensemble import RandomForestClassifier\nm=RandomForestClassifier()\nm.fit(x,y)","79a14e66":"#plot graph of feature importances for better visualization\nfeat_importances = pd.Series(m.feature_importances_, index=x.columns)\nplt.figure(figsize=(10,8))\nfeat_importances.nlargest(10).plot(kind='barh')\nplt.show()","89cb2ce6":"from sklearn.feature_selection import SelectKBest\nfrom sklearn.feature_selection import chi2","fc3fd689":"selection = SelectKBest(score_func=chi2)\nfit = selection.fit(x,y)","2a77c801":"dfscores = pd.DataFrame(fit.scores_)\ndfcolumns = pd.DataFrame(x.columns)\nfeatureScores = pd.concat([dfcolumns,dfscores],axis=1)\nfeatureScores.columns = ['Features','Score']  #naming the dataframe columns","7344eb49":"print(featureScores.nlargest(10,'Score'))  #print10 best features\nfeat=list(featureScores.nlargest(10,'Score')['Features'])","17b8be1a":"from sklearn.decomposition import PCA\npca = PCA().fit(x)","efa1490a":"fig, ax = plt.subplots(figsize=(20,10))\nxi = np.arange(1, 73, step=1)\nyi = np.cumsum(pca.explained_variance_ratio_)\n\nplt.ylim(0.0,1.1)\nplt.plot(xi, yi, marker='o', linestyle='--', color='b')\n\nplt.xlabel('Number of Components')\nplt.xticks(np.arange(0, 72, step=1)) #change from 0-based array index to 1-based human-readable label\nplt.ylabel('Cumulative variance (%)')\nplt.title('The number of components needed to explain variance')\n\nplt.axhline(y=1, color='r', linestyle='-')\nplt.text(0.5, 0.85, '100% cut-off threshold', color = 'red', fontsize=16)\n\nax.grid(axis='x')\nplt.show()","a2f1487c":"pca=PCA(n_components=29)\nx=pca.fit_transform(x)\nx=pd.DataFrame(x)\nx.head()","9c9ed4ee":"from sklearn.model_selection import train_test_split,cross_val_score\n\nfrom sklearn.ensemble import RandomForestClassifier\nfrom xgboost import XGBClassifier\n\nfrom sklearn.metrics import accuracy_score,confusion_matrix,classification_report,roc_auc_score,roc_curve","28b1c7e0":"xtrain,xtest,ytrain,ytest=train_test_split(x,y,test_size=0.3,random_state=7)","5cc9fbbe":"model=RandomForestClassifier()\nmodel.fit(xtrain,ytrain)\np=model.predict(xtest)\ns=cross_val_score(model,x,y,cv=10)","8904c42e":"print('Accuracy',np.round(accuracy_score(p,ytest),4))\nprint('----------------------------------------------------------')\nprint('Mean of Cross Validation Score',np.round(s.mean(),4))\nprint('----------------------------------------------------------')\nprint('Confusion Matrix')\nprint(confusion_matrix(p,ytest))\nprint('----------------------------------------------------------')\nprint('Classification Report')\nprint(classification_report(p,ytest))","75ce2bd0":"model=XGBClassifier(verbosity=0)\nmodel.fit(xtrain,ytrain)\np=model.predict(xtest)\ns=cross_val_score(model,x,y,cv=10)","81dc1600":"print('Accuracy',np.round(accuracy_score(p,ytest),4))\nprint('----------------------------------------------------------')\nprint('Mean of Cross Validation Score',np.round(s.mean(),4))\nprint('----------------------------------------------------------')\nprint('Confusion Matrix')\nprint(confusion_matrix(p,ytest))\nprint('----------------------------------------------------------')\nprint('Classification Report')\nprint(classification_report(p,ytest))","a2307c15":"from sklearn.model_selection import RandomizedSearchCV","c82fbf69":"params={'n_estimators':[100, 300, 500, 700],\n        'min_samples_split':[1,2,3,4],\n        'min_samples_leaf':[1,2,3,4],\n        'max_depth':[None,1,2,3,4,5,6,7,8,9,10,15,20,25,30,35,40]}","d7c4a536":"g=RandomizedSearchCV(RandomForestClassifier(),params,cv=10)","14abf50e":"g.fit(xtrain,ytrain)","a3219ec6":"print(g.best_estimator_)\nprint(g.best_params_)\nprint(g.best_score_)","5d88a181":"m=RandomForestClassifier(max_depth=20, min_samples_leaf=4, min_samples_split=4,n_estimators=700)\nm.fit(xtrain,ytrain)\np=m.predict(xtest)\nscore=cross_val_score(m,x,y,cv=10)","3f694664":"print('Accuracy',np.round(accuracy_score(p,ytest),4))\nprint('----------------------------------------------------------')\nprint('Mean of Cross Validation Score',np.round(s.mean(),4))\nprint('----------------------------------------------------------')\nprint('Confusion Matrix')\nprint(confusion_matrix(p,ytest))\nprint('----------------------------------------------------------')\nprint('Classification Report')\nprint(classification_report(p,ytest))","caea1722":"params={'n_estimators':[100,200,300,400,500],\n      'learning_rate':[0.001,0.01,0.10,],\n      'subsample':[0.5,1],\n      'max_depth':[1,2,3,4,5,6,7,8,9,10]}","70c0a947":"g=RandomizedSearchCV(XGBClassifier(),params,cv=10)","ee512295":"g.fit(xtrain,ytrain)","765927a0":"print(g.best_estimator_)\nprint(g.best_params_)\nprint(g.best_score_)","29cbb6f2":"m=XGBClassifier(max_depth=10,learning_rate=0.1,n_estimators=500,subsample=0.5)\nm.fit(xtrain,ytrain)\np=m.predict(xtest)\nscore=cross_val_score(m,x,y,cv=10)","e6deb110":"print('Accuracy',np.round(accuracy_score(p,ytest),4))\nprint('----------------------------------------------------------')\nprint('Mean of Cross Validation Score',np.round(s.mean(),4))\nprint('----------------------------------------------------------')\nprint('Confusion Matrix')\nprint(confusion_matrix(p,ytest))\nprint('----------------------------------------------------------')\nprint('Classification Report')\nprint(classification_report(p,ytest))","236e8586":"model=XGBClassifier(max_depth=2,learning_rate=0.01,n_estimators=500,subsample=1)\nmodel.fit(xtrain,ytrain)\np=model.predict(xtest)\nscore=cross_val_score(model,x,y,cv=10)","31c1a601":"print('Accuracy',np.round(accuracy_score(p,ytest),4))\nprint('----------------------------------------------------------')\nprint('Mean of Cross Validation Score',np.round(s.mean(),4))\nprint('----------------------------------------------------------')\nprint('Confusion Matrix')\nprint(confusion_matrix(p,ytest))\nprint('----------------------------------------------------------')\nprint('Classification Report')\nprint(classification_report(p,ytest))","636923aa":"import joblib\njoblib.dump(model,'Retention.obj')","082c3cb3":"![](https:\/\/i.ytimg.com\/vi\/JQHfngSaqD0\/maxresdefault.jpg)","5a0b433e":"We can clearly see that most of the time people abandon the bag is beacuse they get a better alternative offer or promo code not applicable. There is also lack of trust seen in amazon, flipkart and paytm by some people.","2075df7b":"In lines, we can see that density of female customers is more than male. Men living in banglore and ghaziabad shop have shopped online for less than 1 year. Highest number of men shopping online belong from delhi and noida, while men from moradabad have been shopping online for the longest. Women from meerut and noida have shopped the longest.","7ce60e0d":"# Modelling Phase","5520596e":"There are no null values is the dataset","10b59f4f":"##### Using chi2 test","0291528b":"All the columns are of object datatype except for pincode column which is of int type","7d2fd607":"The results of this study suggest following outputs which might be useful for E-commerce websites to extend \ntheir business\n\n1. The cost of the product, the reliability of the E-commerce company and the return policies all play an equally important role in deciding the buying behaviour of online customers. The cost is an important factor as it was the basic criteria used by online retailers to attract customers. The reliability of the E-commerce company is also important, as it is even required in offline retail. It is important because customers are paying online, so they need to be sure of security of the online transaction. The return policies are important because in online retail customer does not get to feel the product. Thus, he wants to be sure that it will be possible to return the product if he does not like it in real. Whereas, the logistics factor, which included Cash on delivery option, One day delivery and the quality of packaging plays a secondary role in this process though these are Must-be-quality. This is so because these all does not interfere with the real product and people believe that this is the basic value that E-commerce websites provide. \n\n\n2. All the websites were not equally preferred by online customers. Amazon was the most preferred followed by Flipkart. This can be explained easily by previous result that we got. These two companies are most trusted in the industry and hence, have a huge reliability. Also, the sellers listed on these websites are generally from Tier 1 cities as compared to Snapdeal and PayTM which have more sellers from tier 2 and 3 cities. Also, these websites have the most lenient return policies as compared to others and also the time required to process a return is low for these. \n","0d0ab662":"Dataset have 269 rows and 71 columns","1c28af8f":"### Processing the dataframe","aeadccd3":"### Personal Info","c800ae15":"Highest number of people have been shopping online for above 4 years except for the age group below 20 years and above 50 years. People who are shopping online for 1-2 years does not include teenagers and elder people.","02569767":"# Evaluation Metrics","5791c512":"# Saving the Model","df5ab63c":"-There is double the number of women than men who have taken this survey. \n-Most of the people are in their 30's followed by 20's, teenagers and senior citizen are the least in number.\n-Most of the people belong from delhi, noida and banglore, ambiguity can also be seen as noida has two categories (noida and       grater noida) which need to be handled\n-Most of the people shopping online have been shopping from a long time.\n-Majority of people shop online 10 times a year, amiguity can also be seen for range 42 times and above which needs to be         handled","9c3c3cf2":"### Xgboost","abb0a9cf":"Amazon, Flipkart have been had the highest votes for having all the positive points and have maintained a very good brand image followed by paytm and the myntra.","dd5ec27b":"##### Using Feature importance of random forrest","953c2eda":"### Pre-processing the columns names","6c7c72ca":"# Univariate Analysis","576e3fac":"Heavy shoppers who shop more than 41 times a year shop from all the online brands, some of the people who shop for 32-40 and less than 10 times a year seem to exclude myntra. People shop from Amazon and flipkart whatever be the case.","5456c9b9":"We can clearly see that with 29 features all the information can be retained","033e6c7b":"##### Separating the label from rest of the features","601ca527":"##### Encoding Categorical Features","900693a2":"### Using various feature selection method to see which feature affects the most","4c89db20":"# Finalizing the best Model","3fc28fe5":"Customers seem to be more loyal to amazon, flipkart and paytm as even though many of them have given negative remarks about them still they would recommend these platforms to their friend","4cbf12f6":"# Analysis on the basis of Various following factors","07debfd0":"### Loyalty","f5ed49b5":"Please Upvote if you like my work!! Thanks","0de1bc66":"### Random Forest","5a84838a":"Almost all the people who have shopped from amazon, flipkart and paytm are satisfied. People who shop from a more number of online brands dosent seem to be satisfied. ","8fec7ea1":"### Intention of Repeat purchase:","dfcbda81":"Even though people who are shopping online for more than 3 years donot use the application rather use search engine and direct url's in large number which indicates that online brands should update all their platforms rather than just application.","711a7c35":"##### Scaling","1d359cf7":"### Xgboost","2400d574":"### Brand image","456b14be":"### Online Retailing:","6e7c6133":"Loyal customers are those who keep using the same brand even if it is not good as other brands","79b8bbab":"# PCA","469f29b0":"People shopping from amazon and paytm are getting benefits from the loyalty points, flipkart and sanpdeal also seem to give such benefits but people who shop from almost everywhere disagree with this statement too","0706823a":"##### Converting years to numbers for better analysis","0c0b1976":"### Random Forest","5632b91d":"# Hyperparameter Tuning","78752bd4":"In the above chart we can see that above features are of most importance in determining whhich platform will a ciustomer recommend to his friend.","0cbbdfe9":"# Conclusion","a3cbddb6":"##### Converting Years to numbers for better analysis","c298bb98":"Both the models give accurate and equal results so we choose xgboost as or final model because of its quick speed.","e83a8a89":"##### Conclusion","1c49ae38":"All the columns are of categorical types. There are no identifier or constant columns"}}