{"cell_type":{"e1ed7f1b":"code","8a2c10cf":"code","9394975c":"code","03509dfe":"code","4cf0e520":"code","ba5171be":"code","9659dfe0":"code","634e6140":"code","c063307c":"code","4344f046":"code","4e63d0b8":"code","2f4e53bb":"code","aa3364bd":"code","0b2d99a5":"code","db1b2e2a":"code","938bee37":"code","718cd36a":"code","297c28a5":"code","ac195823":"code","014e4786":"code","43086536":"code","15b99527":"code","220df7d4":"code","ea6d6f0b":"code","dc9c906f":"code","43bda822":"code","b981fdbb":"code","234856ab":"code","d861ab5d":"code","a1811a7f":"code","9cc82b5a":"code","a890a8c9":"code","506faadd":"code","3f8c85e0":"code","6b05a6c0":"code","9309421e":"code","a7990669":"code","2d1fca08":"code","d6ec7c55":"code","14e6a055":"code","2cd7e554":"code","c9681537":"code","2f077a56":"code","eb21aa1b":"code","db562685":"markdown","4e88894b":"markdown","5024056e":"markdown","b68f3c32":"markdown","dae4e7b3":"markdown","4527674b":"markdown","4cde28b4":"markdown","351966f8":"markdown","c50c2b52":"markdown","eef12cbe":"markdown","78f2eca5":"markdown","37d39d89":"markdown","e94b0b53":"markdown","3ce521a1":"markdown","47003e4e":"markdown","4f30d6a7":"markdown","5ef5d99d":"markdown","bad2e606":"markdown","534fd087":"markdown","59aea0c7":"markdown","6b34c2a2":"markdown","c017c509":"markdown","a98dff49":"markdown","306c6799":"markdown","0153d319":"markdown","a5c25e1a":"markdown","74d8d40c":"markdown","8054eedc":"markdown","9f7f1151":"markdown","6dcdc106":"markdown","d2104443":"markdown","3781e9ad":"markdown","cf7ee5e1":"markdown","5f4c8b17":"markdown","3696a598":"markdown","9537f1c9":"markdown","3a9c7224":"markdown","c8b5d812":"markdown","db3034a9":"markdown","ab0d1dcf":"markdown","109b57ac":"markdown","f2b6c832":"markdown","1a40b028":"markdown","01227385":"markdown","c0c83238":"markdown","792213d0":"markdown","8ffd1879":"markdown","0cc3c293":"markdown","af6b615d":"markdown","266d7473":"markdown","771e9e60":"markdown","f0799736":"markdown","a095df3a":"markdown","7e596999":"markdown","4abdd452":"markdown","d0679722":"markdown","3f2a81ef":"markdown","25fb968c":"markdown","1eeaa20b":"markdown","977f02b7":"markdown"},"source":{"e1ed7f1b":"pip install --upgrade pip","8a2c10cf":"!pip install -U seaborn","9394975c":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib.ticker as ticker\n%matplotlib inline\nimport numpy as np\nimport seaborn as sns\nplt.style.use('fivethirtyeight')\n\nfrom scipy import stats\nfrom scipy.stats import skew\nsns.__version__","03509dfe":"sns.__version__","4cf0e520":"#load train data\ntrain_df = pd.read_csv('..\/input\/titanic\/train.csv')\ntest_df = pd.read_csv('..\/input\/titanic\/test.csv')\n#create a new column 'Is_train' to differentiate the training data from the testing data, 1 = training, 0 = testing\ntrain_df['Is_train'] = 1\ntest_df['Is_train'] = 0\n#create the 'Survived' column filled with null values in the testing data\n#so as to share the same columns as the training data\ntest_df['Survived'] = np.nan\n#combine the trainning data and testing data\nfull_df = pd.concat([train_df, test_df], ignore_index=True)\n# delete the two dataframes which are no longer needed\ndel train_df, test_df","ba5171be":"#Get the total number of passengers in the full dataset\nlen(full_df)","9659dfe0":"#fix the errors and fill in the missing age values for the Sammann family\nindices = [279, 746, 1283, 987, 1188, 48, 920, 13, 610, 119, 541, 542, 813, 850, 68, 1105, 736, 436, 1058, 86, 147]\nfull_df.loc[279, ['SibSp', 'Parch']]= 0, 2\nfull_df.loc[1283, ['SibSp', 'Parch']] = 1, 1\nfull_df.loc[987, 'Age'] = 26\nfull_df.loc[1188, ['Age', 'SibSp', 'Parch']] = 40, 0, 2\nfull_df.loc[48, ['Age', 'SibSp', 'Parch']] = 16, 1, 1\nfull_df.loc[920, ['Age', 'SibSp', 'Parch']] = 18, 1, 1\nfull_df.loc[68, ['SibSp', 'Parch']] = 0, 0\nfull_df.loc[1105, ['SibSp', 'Parch']] = 0, 0\nfull_df.loc[736, ['SibSp', 'Parch']] = 0, 4\nfull_df.loc[[436, 1058, 86, 147], ['SibSp', 'Parch']] = 3, 1","634e6140":"#group the samples by the ticket numbers and count each group\nticket_group_sizes = full_df.groupby('Ticket').size()\n\n#create a new feature 'Ticket_group_size'    \nfull_df['Ticket_group_size'] = full_df['Ticket'].apply(lambda x: ticket_group_sizes[x])","c063307c":"#check the distribution of Ticket_group_size\nticket_group_sizes = full_df['Ticket_group_size'].value_counts()\nticket_group_percentages = round(full_df['Ticket_group_size'].value_counts()\/len(full_df)*100)\nticket_groups = pd.concat([ticket_group_sizes, ticket_group_percentages], axis=1)\nticket_groups.columns = ['Quantity', 'Percentage']\nticket_groups","4344f046":"ticket_group_sizes.plot.pie();","4e63d0b8":"#check whether the fare values within each ticket group are the same\nare_fares_different = full_df.groupby('Ticket').Fare.nunique() > 1\nare_fares_different[are_fares_different].index.tolist()","2f4e53bb":"full_df[full_df['Ticket']=='7534']","aa3364bd":"sns.barplot(x='Pclass', y='Fare', hue='Ticket_group_size', data=full_df);","0b2d99a5":"#plot the distributions of fares across pclasses\nfig, ax =plt.subplots(1,2)\nplt.subplots_adjust(right = 2)\n#plot for all the samples, on the left\nsns.boxplot(x='Pclass', y='Fare', data=full_df, ax=ax[0]);\nax[0].set_title('All Samples')\n#plot only for the samples of Ticket_group_size value of 1, on the right\ntickets_not_shared = full_df['Ticket_group_size']==1\nsns.boxplot(x='Pclass', y='Fare', data=full_df[tickets_not_shared], ax=ax[1])\nax[1].set_title('Ticket_group_size=1');","db1b2e2a":"#Locate the record of the Pclass1 ticket of which the fare is far below the median\nfare_between_one_ten = (full_df.Fare < 10) & (full_df.Fare > 1) \nfull_df[tickets_not_shared & (full_df.Pclass==1) & fare_between_one_ten]","938bee37":"#Locate the record of the Pclass1 ticket of which the fare is far above the median\nfull_df[tickets_not_shared & (full_df.Pclass==1) & (full_df.Fare > 50)]","718cd36a":"#Locate the record of the Pclass3 ticket of which the fare is far above the median\nfull_df[tickets_not_shared & (full_df.Pclass==3) & (full_df.Fare > 15)]","297c28a5":"#Correct the two wrong fare values\nfull_df.loc[[451, 490], 'Fare'] = 6.9667\nfull_df.loc[[451, 490]]","ac195823":"#obtain descriptive statistics of fares at different pclasses for the samples of Ticket_group_size value of 1\nfares_by_pclasses = {}\n\nfor i in range(1,4):\n    fares_by_pclasses[i]=full_df.loc[tickets_not_shared & (full_df.Pclass==i), 'Fare'].\\\n    describe()\n    \nfares_by_pclasses_df = pd.concat([v[1] for v in fares_by_pclasses.items()], axis=1)\nfares_by_pclasses_df.columns=['Pclass ' + str(i) for i in range(1, 4)]\nprint(\"Fares' distribution in each Pclass:\")\ndisplay(fares_by_pclasses_df)","014e4786":"# What's the correlation between fare and pclass for the samples of Ticket_group_size value of 1\nround(full_df.loc[tickets_not_shared, ['Fare', 'Pclass']].corr('spearman').iloc[0,1], 2)","43086536":"#divide the fare by the ticket-group size to obtain the average fare as an estimation for the individual fare\nfull_df['Ind_fare'] = full_df['Fare']\/full_df['Ticket_group_size'] \n\nfull_df[(full_df.Fare>0) & (full_df.Pclass.isin([2, 3]))].groupby('Pclass')['Ind_fare'].\\\n                                                                    describe(percentiles=[.05, .25, .50, .75, .95]) ","15b99527":"full_df.loc[(full_df.Pclass==1) & (full_df.Fare>5), 'Ind_fare'].describe(percentiles=[.05, .25, .50, .75, .95]) ","220df7d4":"fig, ax = plt.subplots(2, 2)\nplt.subplots_adjust(right=2, top=1, hspace=0.5)\nsns.ecdfplot(data=full_df[full_df.Pclass==2], x='Ind_fare', ax=ax[0, 0])\nax[0, 0].set_title('Ecdf of Ind_fare distribution for Pclass2')\nsns.ecdfplot(data=full_df[full_df.Pclass==3], x='Ind_fare', ax=ax[0, 1]);\nax[0, 1].set_title('Ecdf of Ind_fare distribution for Pclass3');\nsns.ecdfplot(data=full_df[full_df.Pclass==1], x='Ind_fare', ax=ax[1,0]);\nax[1,0].set_title(\"Ecdf of Ind_fare distribution for Pclass1\");","ea6d6f0b":"#Look for children with uniuqe ticket number and check if their fare was around 3\nfull_df[tickets_not_shared & (full_df.Age <12)]","dc9c906f":"ax = sns.ecdfplot(data=full_df[full_df.Pclass==1], x='Fare');\ntick_spacing = 50\nax.xaxis.set_major_locator(ticker.MultipleLocator(tick_spacing))\nax.set_title('Ecdf of Fare distribution for Pclass1');","43bda822":"#plot the distributions of fares of pclass1, violinplot (left), swarmplot(right)\nfig, ax =plt.subplots(1,2)\nplt.subplots_adjust(right = 2)\n#Fare distribution by violinplot\nsns.violinplot(x='Fare', data=full_df[full_df.Pclass==1], ax=ax[0]);\nax[0].set_title('Fare Violinplot for Pclass1')\n# Fare distribution by swarmplot in which every data point is displayed\nsns.swarmplot(x='Fare', size=3, data=full_df[full_df.Pclass==1], ax=ax[1]);\nax[1].set_title('Fare Swarmplot for Pclass1');","b981fdbb":"#show all the pclass1 samples with fares above 500\nseg1 = (full_df.Fare>500) & (full_df.Pclass==1)\nfull_df[seg1].drop(\"Pclass\", axis=1)","234856ab":"#pick 6 pclass1 samples randomly among the Pclass1 with fare between 200 and 300 \nseg2 = (full_df.Pclass==1) & (full_df.Fare>200) & (full_df.Fare<300)\nseg2_samples = full_df[seg2].sample(6, random_state=0)\nseg2_samples","d861ab5d":"full_df[seg2 & (full_df.Sex=='male')].dropna(subset=['Survived'])","a1811a7f":"#check the the fare, unique cabin values and size of each sampled ticket mentioned above \nseg2_tickets = seg2_samples['Ticket']\nfull_df.loc[full_df.Ticket.isin(seg2_tickets), ['Ticket', 'Fare', 'Cabin']].\\\n                                                    groupby('Ticket').agg(['unique'])","9cc82b5a":"#pick 10 samples randomly among the Pclass1 with fare between 5 and 100\n#the pclass1 tickets with fares no more than 5 are special and not representative and hence they are excluded here\n#pick 100 as the upper limit for the fares above 100 are likely to be of the smaller parlor suites\nseg3_below100 = (full_df.Pclass==1) & (full_df.Fare>5) & (full_df.Fare<100)\nseg3__below100_samples = full_df[seg3_below100].sample(10, random_state=10)\nseg3__below100_samples","a890a8c9":"#check the the fare, unique cabin values and size of each sampled ticket mentioned above \nseg3_below100_tickets = seg3__below100_samples['Ticket']\nfull_df.loc[full_df.Ticket.isin(seg3_below100_tickets), ['Ticket', 'Fare', 'Cabin']].\\\n                            groupby('Ticket').agg(['unique'])","506faadd":"#pick 6 samples randomly among the Pclass1 with fare between 100 and 200\n#the pclass1 tickets with fares no more than 5 are special and not representative and hence they are excluded here\nseg3_above100 = (full_df.Pclass==1) & (full_df.Fare>100) & (full_df.Fare<200)\nseg3__above100_samples = full_df[seg3_above100].sample(10, random_state=1)\nseg3__above100_samples","3f8c85e0":"seg3_above100_tickets = seg3__above100_samples['Ticket']\nfull_df.loc[full_df.Ticket.isin(seg3_above100_tickets), ['Ticket', 'Fare', 'Cabin']].\\\n                            groupby('Ticket').agg(['unique'])","6b05a6c0":"plt.title(\"ECDF of Ind_fare for Samples of Different Fare Segments\")\nsns.ecdfplot(data= full_df.loc[seg3_below100], x='Ind_fare', label='Fares 5~100')\nsns.ecdfplot(data= full_df[seg3_above100], x='Ind_fare', label='Fares 100~200')\nsns.ecdfplot(data= full_df[seg2], x='Ind_fare', label='Fares 200~300')\nsns.ecdfplot(data= full_df[seg1], x='Ind_fare', label='Fares >500')\nplt.legend();","9309421e":"print(\"{} Pclass1 female passengers did not survive according to the training data set.\".\\\n      format(len(full_df.loc[(full_df.Sex=='female') & (full_df.Pclass==1) & (full_df.Survived == 0)])))\nprint('Their survival rate was {:.0f}%.'.format(np.mean(full_df.loc[(full_df.Sex=='female') & (full_df.Pclass==1), 'Survived'])))","a7990669":"#check the first segment (fare >500)\nfull_df.loc[seg1, :'Parch']","2d1fca08":"#check the 2nd and 3rd segments\nsegs = [(seg2, 'seg2'), (seg3_above100, 'seg3_above100'), (seg3_below100, 'seg3_below100')]\n\nsurvivals = {}\nfor s in segs:\n    survivals[s[1]] = {}\n    cond = s[0] & (full_df.Sex=='male')\n    survivals[s[1]]['# males'] = len(full_df.loc[cond, 'Survived'].dropna())\n    survivals[s[1]]['Survival rate %'] =  round(np.mean(full_df.loc[cond, 'Survived'])*100)                            \n\npd.DataFrame.from_dict(survivals).T","d6ec7c55":"print(\"There were {} free tickets.\".format(len(full_df[full_df.Fare==0])))\nfull_df[full_df.Fare==0].sort_values(by=['Pclass', 'Ticket'])","14e6a055":"#Pclass values of the passengers with free tickets\nfull_df[full_df.Fare==0].Pclass.value_counts()","2cd7e554":"#Survival status of the passengers with free tickets\nfull_df[full_df.Fare==0].Survived.value_counts()","c9681537":"#Survival rates of males of three Pclasses\nfull_df[full_df.Sex=='male'].groupby('Pclass')['Survived'].mean()","2f077a56":"#Number of unique ticket values of each fare group\ntickets_in_fareGroups = full_df.groupby('Fare')['Ticket'].nunique()","eb21aa1b":"#How many fare groups have more than one ticket values\nnp.sum(tickets_in_fareGroups>1)","db562685":"### Are the fare max\/medium ratios much smaller?","4e88894b":"**Online search for these four top pclass1 passengers:**   \n[Titanicpages](https:\/\/www.titanicpages.com\/thomascardeza) says that Thomas Cardeza, his mother, and their servants boarded lifeboat 3 and survived.   \n\nAccording to [Wikipedia](https:\/\/en.wikipedia.org\/wiki\/Lifeboats_of_the_Titanic), lifeboat 3 was the third to be lowered from the **starboard** side.One very important clue was found there: the men's chances of survival largely depend on which side of the ship the men tried to find lifeboat seats. Captain Smith ordered his officers to put the \"women and children in and lower away\".However, **Murdoch and Lightoller interpreted the evacuation order differently: Murdoch (in charge of starboard side) as women and children first, while Lightoller (port side) as women and children only**.   \n\nIf the family of Thomas Cardeza had tried to find lifeboat seats from the port side, Thomas and his manservant might have not been able to access the lifeboat due to the 'women and children only' principle at that side.\n\nSo I did not find any strong evidence that the top pclass1 passengers (fare >500) were given higher priority to board the life boat than the rest pclass1 passengers.","5024056e":"### Are the fare values of the same ticket group the same?","b68f3c32":"## Fare sharing among passengers?\nAccording to [encyclopedia-titanic](https:\/\/www.encyclopedia-titanica.org\/), I found that the passengers sharing the ticket numbers ( I refer them to a ticket group) might share the ticket fares as well, which means that the fare is actually the total fare for them.[LeonardFI](https:\/\/www.kaggle.com\/c\/titanic\/discussion\/3916) found it too.   \n\nThe fare values are to be analyzed from these perspecitves:\n- What is the distribution of the ticekt-group-size values?\n- Are the fare values of the same ticket group the same?\n- Do the fare values increase with the increase in the ticket group size?\n- Is there less fare overlapping between pclasses for the samples with ticket group size of 1?\n- Are the fare max\/medium ratios much smaller?","dae4e7b3":"**Finding:**   \nBased on the description and [Wikipedia](https:\/\/en.wikipedia.org\/wiki\/Lifeboats_of_the_Titanic), people's chances of survival basically depended on whether they got to board the lifeboats before the Titanic sank.","4527674b":"## Background of this notebook\nTwo things unusual were found with 'Fare' variable, described in my previous [EDA notebook](https:\/\/www.kaggle.com\/bofangli\/titanic-eda-with-detailed-explanation):\n- Almost half of samples' ticket numbers are not unique, which means that many of the passengers shared the ticket number with someone else.\n-  All three pclasses overlapped in the fare range below 100.\n\nBesides, the 'Fare' variable is strongly correlated with the 'Pclass' variable (-0.71 with 'Spearman method').\n\nIt made me wonder - What caused the overlapping of fares? How to compare the fare values properly? What additional  information does 'Fare' provide compared to 'Pclass'? So I'm aiming at these three questions in this notebook.","4cde28b4":"Table of Contents:\n\n1. Review challenge description   \n2. Background of this notebook\n3. Load packages, modules, data and fix data errors   \n    3.1 Load libraries, packages and modules   \n    3.2 Load the two datasets and combine them   \n    3.3 Fix some data errors and fill in a couple of missing age values   \n4. Fare sharing among passengers?   \n    4.1 What is the distribution of the ticekt-group-size values?   \n    4.2 Are the fare values of the same ticket group the same?   \n    4.3 Do the fare values increase with the increase in the ticket group size?   \n    4.4 Is there less fare overlapping between pclasses for the samples with ticket group size of 1?   \n    4.5 Analyze the outliers in the samples of unique ticket numbers   \n    4.6 Are the fare max\/medium ratios much smaller?   \n5. What more information can be extracted from the fare than the pclass?   \n    5.1 Correlation between fare and pclass with the removal of the fare-sharing influence   \n    5.2 Are there any subclasses of each pclass with different prices?   \n    5.3 Did the passengers of a higher subclass of Pclass1 have a higher survival rate?   \n    5.4 Is the special fare (zero and unusually low) related with the survival rate?      \n    5.5 Can the fare be used as the indication for the ticket groups?  \n6. Summary   ","351966f8":"### Is the special fare (zero and unusually low) related with the survival rate?\n\nMy previous [EDA notebook](https:\/\/www.kaggle.com\/bofangli\/titanic-eda-with-detailed-explanation) and the fare outliers analysis of this notebook show that there were some free tickets and one very cheap pclass1 ticket of \u00a35.","c50c2b52":"### Correlation between fare and pclass with the removal of the fare-sharing influence","eef12cbe":"**Search online about the ticket fares of Mr. Ingvald and Mr. Konrad**   \nAs [Encyclopedia-titanica ](https:\/\/www.encyclopedia-titanica.org\/titanic-victim\/ingvald-olai-olsen-hagland.html) mentions, Mr. Ingvald was the brother in law of Mr. Konrad and their ticket fares were \u00a36, 19s, 4d, within the normal fare range of Pclass 3. So their fare values in our data are wrong and should be 6.9667.\n<a id=\"wrong_fares\"><\/a>","78f2eca5":"**Finding:**   \nHalf of the passengers had unique ticket numbers.   \nThe rest passengers were mainly in the ticket groups of 2 or 3 people.  ","37d39d89":"**Conclusion based on the training data set:**  \nAlmost all female passengers of pclass1 survived.   \n\nAmong the male passengers:   \nFinding:   \n- 2 of Subclass1 both survived.\n- 6 were with fares 200~300 and none survived.\n- 11 were with fares 100~200 and their survival rate was 45%.\n- 97 were with fares below 100 and their survival rate was 39%.   \n\nAnalysis:   \n- Though the survival rate of Subclass1 was more than twice as high as that of the rest pclass1 male passengerst, due to the small sample size, this observation is highly susceptible to randomness, which is supported by the external resources.\n- None of those six passengers with fares 200~300 survived.  \n- The survival rates of those with fares 100~200 and those with fares below 100 were close, 45% and 39% perspectively.   \n\n\nSo not any strong evidence was found that the passengers of a higher subclass of Pclass1 were more likely survive.","e94b0b53":"**Finding:**   \nAmong these four passengers with fares above 500, 2 men (both survived) and 2 female (one survived, one of unknown survival state based on the data set).These males' survival rate were higher than the rest pclass1 male passengers. The previous [EDA notebook](https:\/\/www.kaggle.com\/bofangli\/titanic-eda-with-detailed-explanation) shows that for pclass1, less than 40% males survived and almost all females survived.\nHowever, the samples of small size are susceptible to randomness. No reliable conclusions can be made only based on the data analysis of such few samples (size of 4). External evidence is necessary to prove that these top pclass1 passengers (esp. men) were given higher priority to board the lifeboat.","3ce521a1":"**Price table** based on Wikipedia[1](https:\/\/en.wikipedia.org\/wiki\/Passengers_of_the_Titanic) [2](https:\/\/en.wikipedia.org\/wiki\/First-class_facilities_of_the_Titanic)\n\n|Accommodation|Price|\n| :- | -: | \n|First-class more lavish and opulent parlor suite|\t\u00a3500-1000|\n|First-class smaller parlor suite|\t\u00a3100-300|\n|Berth in first-class standard cabin| \u00a330 |\n|Berth in second-class cabin| \u00a312 (average)|\n|Berth in third-class cabin| \u00a33 for children, \u00a37 (average) for adults|\n\n\nWikipedia[1](https:\/\/en.wikipedia.org\/wiki\/Passengers_of_the_Titanic) also mentions, \"Third-class passengers paid \u00a37 (\u00a3698 today) for their ticket, depending on their place of origin; ticket prices often included the price of rail travel to the three departure ports\".\n\n[Encyclopedia](https:\/\/www.encyclopedia-titanica.org\/community\/threads\/children-on-the-titanic.20096\/) mentions,Titanic's Certificates for Clearance defined **the children as under age 12**, age 12 and upwards were counted as adults.","47003e4e":"**Crew statistics of [Titanicfacts](https:\/\/titanicfacts.net\/titanic-crew\/):**    \nThere were Totally 908 crew members on board the RMS Titanic.Among them, 212 survived (23%).\n885 crew members were male and 192 out of them survived (22%).","4f30d6a7":"**Finding:**   \nThe fare scale (500) of the left subplot is 10 times as big as that (50) of the right one.\nFor all the samples, the fare range of each pclass is big and they much overlap below 100.   \nFor the samples with ticket group size of 1, the fare range is much smaller in each pclass and there's little overlapping of fare values between pclasses. Besides,some outliers are more noticeable and they will be further analyzed next","5ef5d99d":"**Finding:**   \nOf first segment (fares >500), the Ind_fares are over 120, much higher than the rest pclass1 fares.   \nOf second segment (fares 200~300), 80% Ind_fares are above 40 and mostly below 55.\nOf the other part of third segment (100~200), 70% Ind_fares are below 40.\nOf one part of third segment (fares 5~100), 90% ind_fares are below 40 (mostly above 25).Its ECDF is in between the second segment and the other part of third segment.\n\nConsidering the fare-sharing, a ticket group which consists of four or more passengers with berth in standard cabin, probably has a fare above 100, in the range of smaller parlor suite (100~300).   \nIt's hard to tell whether the samples of fares 100~200 are of berth in standard cabin or smaller parlor suite.","bad2e606":"**Finding:**   \nIn general , within each pclass, the fare values tend to increase with the ticket group sizes.   \nIn pclass1, the variations of fare values for ticket group sizes 3~6 are relatively big.","534fd087":"### Can the fare be used as the indication for the ticket groups?","59aea0c7":"### Load libraries, packages and modules","6b34c2a2":"### Did the passengers of a higher subclass of Pclass1 have a higher survival rate?","c017c509":"### Load the two datasets and combine them\nThe relationship (family member, wife-husband, child-parent, etc.) among passengers is a potential influential factor for the survival rate. For its analysis, the data of all the passengers needs to put together. So the training data and the testing data will be combined.","a98dff49":"### What is the distribution of the ticket-group-size values?","306c6799":"**Conclusion:**   \nThe owners of the special fare (zero and unusually low) were the male employees of RMS titanic or related companies. They were treated as both passengers and crew.    \nTheir survival rate (6%) was much lower than that of the male crew (22%) and that of the male passengers (19%).","0153d319":"#### Are there any subclasses of each pclass with different prices?","a5c25e1a":"**Finding:**  \nWithin each ticket group, the fare values are exactly the same. There's only one exception - ticket '7534'.   \nThe two fare values of ticket '7534' are slightly different (9.2167, 9.8458).  \n[Geni](https:\/\/www.geni.com\/people\/Olaf-Elon-Os%C3%A9n\/6000000015915621723) mentions that Mr. Olaf Elon Osen\ttravelled with Mr Alfred Ossian Gustafsson on titanic.So the two passengers of ticket '7534' were travelling companions.","74d8d40c":"### Analyze the outliers in the samples of unique ticket numbers\n\nDuring the analysis of the samples of unique ticket numbers (ticket group size of 1), some outliers were noticed. They may be wrong data and had better be checked.","8054eedc":"### Do the fare values increase with the increase in the ticket group size?","9f7f1151":"### Fix some data errors and fill in a couple of missing age values\n\nReferences:   \n[Some SibSp\/Parch values are wrong](https:\/\/www.kaggle.com\/c\/titanic\/discussion\/39787)   \n[Miss Erna Alexandra Andersson](https:\/\/www.encyclopedia-titanica.org\/titanic-survivor\/erna-andersson.html)   \n[Miss Ida Augusta Margareta Andersson](https:\/\/www.encyclopedia-titanica.org\/titanic-victim\/ida-augusta-margareta-andersson.html)","6dcdc106":"### Is there less fare overlapping between pclasses for the samples with ticket group size of 1?","d2104443":"## Load packages, modules, data and fix data errors","3781e9ad":"- The overlapping of fares of three Pclasses were mainly caused by the sharing of fares. 46% fare values are not of the individuals, but of the ticket groups. Several passengers with the same ticket number is a ticket group.   \n- So the direct comparison of fare values can be misleading.  \n- The Fare variable is strongly coorelated with the Pclass variable which is the indication of socio-economic class.\n- Some additional information can be extracted from fare values: \n    - The fare can indicate the subclass of Pclass1. But its influence on the survival rate is small.   \n    - Special passengers (including the nine-member Guarantee Group and the eight members of the ship's band) had free tickets and another employee had unusally cheap pclass1 ticket (\u00a35) and their survival rate was much lower than the rest passengers.   ","cf7ee5e1":"**Finding:**   \n* Two fare errors were found and corrected. They were mentioned in my previous [EDA notebook](https:\/\/www.kaggle.com\/bofangli\/titanic-eda-with-detailed-explanation).\n* That notebook shows that the max\/median fare ratios of three pclasses of all samples are unusally big, 5~9.   \n* For the samples of Ticket_group_size value of 1, the ratios are much smaller, only 1.2~1.8.","5f4c8b17":"**Finding:** \nOf the estimated individual fares of Pclass2 and Pclass3:\nTheir mean and median values match the price table.\n\nTheir ranges and variances are much smaller than those of Pclass1.\n- Their (max-min)\/median ratios: 3.75(Pclass1), 0.85 (Pclass2), 0.95(Pclass3).  \n- Their standard deviations\/median ratios: 0.49(Pclass1), 0.17 (Pclass2), 0.16(Pclass3).\n- For Pclass1, more than 75% fall in the range of 20~40.\n- For Pclass2, more than 75% fall in the range of 10~14.   \n- For Pclass3, around 70% fall in the range of 6~8. ","3696a598":"### Are there any subclasses of each pclass with different prices?","9537f1c9":"**Finding:**   \nFares can't be used as the indication for ticket groups because the tickets of same fares are not necessarily of the same number.","3a9c7224":"**Finding and analysis on fare-sharing possibility:**   \nAre the fare values of the same ticket group the same? Yes.   \nDo the fare values increase with the increase in the ticket group size? Yes.   \nIs there less fare overlapping between pclasses for the samples with ticket group size of 1? Yes.  \nAre the fare max\/medium ratios much smaller? Yes.   \n\nWith these evidences, the possibility is high that half of the titanic passengers shared the fares. My further analysis will be based on this assumption until some new evidence proves it wrong. In this case, each fare value is not the fare of an individual passenger, but the total fare of a ticket group. So the direct comparison of the fare values can be misleading.   \n\nHow to treat the fare variable to avoid misleading? Can we just drop fare due to its strong correlation with pclass?\nThe way we handle the fare variable depend on what information we would like to extract from it.","c8b5d812":"## Summary","db3034a9":"**Finding:** The samples with fares above 500 are of 4 passengers who shared the same ticket number and occupied several cabins. Two of them shared three adjacent cabins, one occupied one cabin, and one's cabin value is missing.","ab0d1dcf":"**Finding & analysis:**   \nOur full data has 1309 records, one for each passenger. According to [WIKIPEDIA](https:\/\/en.wikipedia.org\/wiki\/Passengers_of_the_Titanic) and [HISTORY ON THE NET](https:\/\/www.historyonthenet.com\/how-many-people-were-on-the-titanic), the total number of Titanic's passengers was 1,317 or 1316. So our full data covers 99% of the passenger population, with only 7 or 8 missing records.","109b57ac":"## What additional  information does the 'Fare' variable provide compared to the 'Pclass' variable?","f2b6c832":"## Review challenge description","1a40b028":"**Finding:**   \nAccording to the price table, for Pclass2~3 tickets, each ticket's fare depends on the unit price of Berth and the number of Berth.","01227385":"#### Further analyze the fare distribution of Pclass1","c0c83238":"**Finding and analysis:**   \nWith the removal of the fare-sharing influence, the correlation between fare and pclass gets stronger by 8%, from -0.71 to -0.77.    \n   \nIn this challenge, we are asked to build a predictive model that answers the question: \u201cwhat sorts of people were more likely to survive?\u201d using passenger data (ie name, age, gender, socio-economic class, etc). Pclass stands for the socio-economic class. Is the fare an indication for the subclasses of socio-economic class? No such information is included in the data or description provided by Kaggle. So external data is necessary for its clarification. ","792213d0":"As described in my previous [EDA](https:\/\/www.kaggle.com\/bofangli\/titanic-eda-with-detailed-explanation), some tickets were complimentary (fare value=0).   \nAccording to [Tammy Keefer](https:\/\/www.kaggle.com\/c\/titanic\/discussion\/10570), one of those passengers who had the complimentary tickets was the employee.","8ffd1879":"**Finding and analysis:**   \nThe violinplot on the left shows that there are three peaks (over 500, ~230, ~30) and hence the distribution has three modes. The majority of the data points belong to the third distribution (peak ~30), and very few of them belong to the first distribution (peak over 500).The number of modes are consistent with the number of price categories of Pclass1.   \nThe swarmplot shows two noticeable gaps between these three segments.\nHowever, the minimum value of the second segment is 200, instead of 100 while the maximum value of the third segment is over 150, 5 times as big as that of the berth price (30). Considering the fare sharing, the fare values of non-complimentary pclass1 tickets below 100 was expected to be the same or very close to 30, 60, 90 but they are scattered between 30~100. These inconsistencies will be further analyzed.","0cc3c293":"**Finding & Analysis on Pclass1 Fares:**   \n- The fares are not proportional to the number of cabins.   \n- There are three subclasses of pclass1\n    - Subclass1: more lavish and opulent parlor suite.   \n    - Subclass2: smaller parlor suite.   \n    - Subclass3: berth in first-class standard cabin.   \n- The Subclass1's fares are above 500.   \n- The fare sharing causes the overlap between Subclass2 and Subclass3 in the fare range of 100~200. It's hard to tell whether the samples in this range are of Subclass2 or Subclass3.      \n- The samples with fares between 200~300 belong to Subclass2.   \n- The samples with fares below 100 belong to Subclass1.   ","af6b615d":"**Finding:**   \nAbout 75% Pclass1 tickets' fares are below 100. Very few fares above 500. The rest (about 25%) range from 100 and 260.","266d7473":"**Search online about the ticket fare of Mr. Frans:**   \nAccording to [Geni](https:\/\/www.geni.com\/people\/Frans-Olof-Carlsson-1st-Class-RMS-Titanic-Casualty\/6000000015948569078), Mr. Frans' ticket fare was indeed  \u00a35. But he was the employee.","771e9e60":"**Finding from online search for the reasons behind the free or low-price tickets:**   \nAmong the owners of complementary tickets:   \nAll second-class \uff08six totally) and three first-class passengerss(passengerIds 264, 807, 1158) belonged to [The nine-strong \"guarantee group\"](https:\/\/maritimebelfast.com\/case-studies\/titanic-heritage-plaques-the-guarantee-group\/) of Harland and Wolff employees chosen to oversee the smooth running of the Titanic's maiden voyage.   \nAll third-class (four totally) were [American Line employee](https:\/\/www.geni.com\/people\/Lionel-Leonard\/6000000016211210238).   \n[Naval architect](https:\/\/en.wikipedia.org\/wiki\/Thomas_Andrews) that was in charge of the plans for the ocean liner RMS Titanic: Thomas_Andrews(807).\nOther first-class:   \n- [Chairman and managing director of the White Star Line]((https:\/\/en.wikipedia.org\/wiki\/J._Bruce_Ismay): Ismay, Mr. Joseph Bruce(1264).\n- [His valet (816) and secretary (634)](https:\/\/www.geni.com\/people\/John-Richard-Fry\/6000000016142357235) \n- Reuchlin, Jonkheer. John George (823), his ticket was complementary because of his position with the Holland America Line which was part of the International Mercantile according to [geni](https:\/\/www.geni.com\/people\/Jonkheer-Johan-George-Reuchlin\/6000000015519745032)\n\n[Wikipedia](https:\/\/en.wikipedia.org\/wiki\/Crew_of_the_Titanic) says that the nine-member Guarantee Group and the eight members of the ship's band, who were given passenger accommodations and treated as both passengers and crew.","f0799736":"**Finding:**   \nThe fare is not proportional to the number of cabins within each ticket group.","a095df3a":"**Conclusion on subclass analysis:**   \n- Pclass1 had three subclasses.\n    - Subclass1: more lavish and opulent parlor suite.   \n    - Subclass2: smaller parlor suite.   \n    - Subclass3: berth in first-class standard cabin.   \n- Pclass2 and Pclass3 had no subclasses.","7e596999":"The sinking of the Titanic is one of the most infamous shipwrecks in history.\n\nOn April 15, 1912, during her maiden voyage, the widely considered \u201cunsinkable\u201d RMS Titanic sank after colliding with an iceberg. Unfortunately, there weren\u2019t enough lifeboats for everyone onboard, resulting in the death of 1502 out of 2224 passengers and crew.\n\nWhile there was some element of luck involved in surviving, it seems some groups of people were more likely to survive than others.\n\nIn this challenge, we are asked build a predictive model that answers the question: \u201cwhat sorts of people were more likely to survive?\u201d using passenger data (ie name, age, gender, socio-economic class, etc).","4abdd452":"**Finding:**   \nThe fare is not proportional to the number of passengers or the number of cabins of each ticket group.","d0679722":"**Finding:**   \nAs mentioned above in [outlier analysis](#Analyze-the-outliers-in-the-samples-of-unique-ticket-numbers), Mr. Frans' pclass1 ticket fare was \u00a35, and he was the employee and died during the titanic voyage.\n\nAmong these 17 passengers with complimentary tickets and another passenger with a very cheap pclass1 ticket:   \n- 8 of Pclass1, 6 of Pclass2, 4 of Pclass3.   \n- 15 died, 1 survived (Pclass3), 2 unknown survival status (Pclass1) from the data.\n\nThe survival status of 16 out of them are known from the data. Among these 16 passengers:\n- Pclass1: 6 totally, all died. Their survival rates was lower than those of Pclass1 male passengers on average.\n- Pclass2: 6 totally, all died. The sample size is not big enough for comparison because the survival rate was only 0.16 on average.\n- Pclass3: 4 totally, only 1 survived. The survival rate was higher than those of Pclass1 male passengers on average.\n- Survival rate: 6% (1 out of 16).","3f2a81ef":"[Wikipedia](https:\/\/en.wikipedia.org\/wiki\/Passengers_of_the_Titanic) says,   \n'**The ship's passengers were divided into three separate classes determined by the price of their ticket:** those travelling in first class, most of them the wealthiest passengers on board, included prominent members of the upper class, businessmen, politicians, high-ranking military personnel, industrialists, bankers, entertainers, socialites, and professional athletes. Second-class passengers were predominantly middle-class travellers and included professors, authors, clergymen, and tourists. Third-class or steerage passengers were primarily immigrants moving to the United States and Canada.'","25fb968c":"**Search online about the ticket fare of Mr. Washington:**  \nAs [Encyclopedia-titanica](https:\/\/www.encyclopedia-titanica.org\/titanic-victim\/washington-roebling.html) mentions, Mr. Washington carried ticket no. PC 17590 (\u00a350 9s 11d). So the high value around 50 was confirmed.","1eeaa20b":"**Finding and analysis:**   \nThe second class and third class had no subclasses.   \nThe third class' fares' variation was related with the place of origin (ticket prices often included the price of rail travel to the three departure ports) and the children fee.\n\nThe first class had three separate price ranges: **\u00a3500-1000** for lavish parlor suite, **\u00a3100-300** for smaller parlor suite,  **\u00a330** for berth in cabin. Can the samples of these three price ranges be identified based on the fare variable? The pclass1 fare values will be further analyzed next.","977f02b7":"**Finding:**   \nThe fare is not proportional to the number of cabins within each ticket group."}}