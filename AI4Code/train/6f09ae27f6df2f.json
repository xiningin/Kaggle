{"cell_type":{"3eab701a":"code","01f34d0e":"code","a554cac9":"code","116a956e":"code","2f07ca69":"code","c9f322bc":"code","2dab0e84":"code","e03c9ae8":"code","629ead2e":"code","f101a37b":"code","0982b065":"code","f7bb6c68":"code","d87f8678":"code","227b7dcb":"code","ec406a42":"code","905d4b11":"code","d9ac546a":"code","818c57cf":"code","e96a0c08":"code","618955fc":"code","06ff317a":"code","3fd83d6c":"code","e9498900":"code","49387fe5":"code","db343849":"code","c56b9f95":"code","366b8716":"code","f28d8496":"code","a0d8db70":"code","6efbbdf9":"code","661fb865":"code","a5878f37":"code","a85bc72a":"code","359f63ee":"code","cd036257":"code","f5aeec5c":"code","ca26f59b":"code","d6462f68":"code","1f88923a":"code","ed39637b":"code","fa110c72":"markdown","0156ad1c":"markdown","77374894":"markdown","f8abaed1":"markdown","1d6bd953":"markdown","c8b63a4e":"markdown","0e90b80f":"markdown","3ca735c3":"markdown","93da0913":"markdown","92a84a82":"markdown","a72d22a5":"markdown","b433ddad":"markdown"},"source":{"3eab701a":"!pip install nlpaug","01f34d0e":"import pandas as pd\nimport numpy as np\nimport librosa\nimport librosa.display as librosa_display\nimport IPython.display as ipd\nimport nlpaug\nimport nlpaug.augmenter.audio as naa\nimport matplotlib.pyplot as plt","a554cac9":"perfal = '\/kaggle\/input\/birdsong-recognition\/train_audio\/perfal\/XC463087.mp3'\nlotduc = '\/kaggle\/input\/birdsong-recognition\/train_audio\/lotduc\/XC121426.mp3' \nrewbla = '\/kaggle\/input\/birdsong-recognition\/train_audio\/rewbla\/XC135672.mp3' \nwarvir = '\/kaggle\/input\/birdsong-recognition\/train_audio\/warvir\/XC192521.mp3' \nlecthr = '\/kaggle\/input\/birdsong-recognition\/train_audio\/lecthr\/XC141435.mp3' ","116a956e":"import IPython.display as ipd\ndata, sr = librosa.load(perfal)\nipd.Audio(data, rate=sr)\nlibrosa.display.waveplot(data.astype('float'), sr=sr,x_axis=None)\nplt.title('original')","2f07ca69":"def pitch_speed(filename):\n    data, sr = librosa.load(filename)\n    pitch_speed = data.copy()\n    length_change = np.random.uniform(low=0.8, high = 1)\n    speed_fac = 1.0  \/ length_change\n    print(\"resample length_change = \",length_change)\n    tmp = np.interp(np.arange(0,len(pitch_speed),speed_fac),np.arange(0,len(pitch_speed)),pitch_speed)\n    minlen = min(pitch_speed.shape[0], tmp.shape[0])\n    pitch_speed *= 0\n    pitch_speed[0:minlen] = tmp[0:minlen]\n    librosa_display.waveplot(data, sr=sr, alpha=0.5)\n    librosa_display.waveplot(pitch_speed, sr=sr, color='r', alpha=0.25)\n    plt.title('augmented pitch and speed')\n    return ipd.Audio(data, rate=sr)","c9f322bc":"pitch_speed(perfal)","2dab0e84":"pitch_speed(lotduc)","e03c9ae8":"def pitch(filename):\n    data, sr = librosa.load(filename)\n    y_pitch = data.copy()\n    bins_per_octave = 12\n    pitch_pm = 2\n    pitch_change =  pitch_pm * 2*(np.random.uniform())   \n    print(\"pitch_change = \",pitch_change)\n    y_pitch = librosa.effects.pitch_shift(y_pitch.astype('float64'), \n                                          sr, n_steps=pitch_change, \n                                          bins_per_octave=bins_per_octave)\n    librosa_display.waveplot(data, sr=sr, alpha=0.5)\n    librosa_display.waveplot(y_pitch, sr=sr, color='r', alpha=0.25)\n    plt.title('augmented pitch only')\n    plt.tight_layout()\n    plt.show()\n    return ipd.Audio(data, rate=sr)","629ead2e":"pitch(perfal)","f101a37b":"pitch(lotduc)","0982b065":"def speed(filename):\n    data, sr = librosa.load(filename)\n#     speed_change = np.random.uniform(low=0.9,high=1.1)\n#     print(\"speed_change = \",speed_change)\n#     tmp = librosa.effects.time_stretch(data.astype('float64'), speed_change)\n#     minlen = min(data.shape[0], tmp.shape[0])\n#     data *= 0 \n#     data[0:minlen] = tmp[0:minlen]\n#     librosa.display.waveplot(data.astype('float'), sr=sr,x_axis=None)\n    aug = naa.SpeedAug()\n    augmented_data = aug.augment(data)\n\n    librosa_display.waveplot(data, sr=sr, alpha=0.5)\n    librosa_display.waveplot(augmented_data, sr=sr, color='r', alpha=0.25)\n    plt.title('augmented speed only')\n    plt.tight_layout()\n    plt.show()\n    return ipd.Audio(augmented_data, rate=sr)","f7bb6c68":"speed(perfal)","d87f8678":"speed(lotduc)","227b7dcb":"def augmentation(filename):\n    data, sr = librosa.load(filename)\n    y_aug = data.copy()\n    dyn_change = np.random.uniform(low=1.5,high=3)\n    print(\"dyn_change = \",dyn_change)\n    y_aug = y_aug * dyn_change\n    print(y_aug[:50])\n    print(data[:50])\n    librosa_display.waveplot(data, sr=sr, alpha=0.5)\n    librosa_display.waveplot(y_aug, sr=sr, color='r', alpha=0.25)\n    plt.title('amplify value')\n    return ipd.Audio(y_aug, rate=sr)","ec406a42":"augmentation(perfal)","905d4b11":"augmentation(lotduc)","d9ac546a":"def add_noise(filename):\n    data, sr = librosa.load(filename)\n    y_noise = data.copy()\n    # you can take any distribution from https:\/\/docs.scipy.org\/doc\/numpy-1.13.0\/reference\/routines.random.html\n    noise_amp = 0.005*np.random.uniform()*np.amax(y_noise)\n    y_noise = y_noise.astype('float64') + noise_amp * np.random.normal(size=y_noise.shape[0])\n    librosa_display.waveplot(data, sr=sr, alpha=0.5)\n    librosa_display.waveplot(y_noise, sr=sr, color='r', alpha=0.25)\n    return ipd.Audio(y_noise, rate=sr)","818c57cf":"add_noise(perfal)","e96a0c08":"add_noise(lotduc)","618955fc":"def random_shift(filename):\n    data, sr = librosa.load(filename)\n    y_shift = data.copy()\n    timeshift_fac = 0.2 *2*(np.random.uniform()-0.5)  # up to 20% of length\n    print(\"timeshift_fac = \",timeshift_fac)\n    start = int(y_shift.shape[0] * timeshift_fac)\n    print(start)\n    if (start > 0):\n        y_shift = np.pad(y_shift,(start,0),mode='constant')[0:y_shift.shape[0]]\n    else:\n        y_shift = np.pad(y_shift,(0,-start),mode='constant')[0:y_shift.shape[0]]\n    librosa_display.waveplot(data, sr=sr, alpha=0.5)\n    librosa_display.waveplot(y_shift, sr=sr, color='r', alpha=0.25)\n    return ipd.Audio(y_shift, rate=sr)","06ff317a":"random_shift(perfal)","3fd83d6c":"random_shift(lotduc)","e9498900":"def hpss(filename):\n    data, sr = librosa.load(filename)\n    y_hpss = librosa.effects.hpss(data.astype('float64'))\n    print(y_hpss[1][:10])\n    print(data[:10])\n    librosa_display.waveplot(data, sr=sr, alpha=0.5)\n    librosa_display.waveplot(y_hpss[1], sr=sr, color='r', alpha=0.25)\n    plt.title('apply hpss')\n    return ipd.Audio(y_hpss[1], rate=sr)","49387fe5":"hpss(perfal)","db343849":"hpss(lotduc)","c56b9f95":"def streching(filename):\n    data, sr = librosa.load(filename)\n    input_length = len(data)\n    streching = data.copy()\n    streching = librosa.effects.time_stretch(streching.astype('float'), 1.1)\n    if len(streching) > input_length:\n        streching = streching[:input_length]\n    else:\n        streching = np.pad(streching, (0, max(0, input_length - len(streching))), \"constant\")\n    librosa_display.waveplot(data, sr=sr, alpha=0.5)\n    librosa_display.waveplot(streching, sr=sr, color='r', alpha=0.25)\n    \n    plt.title('stretching')\n    return ipd.Audio(streching, rate=sr)","366b8716":"streching(perfal)","f28d8496":"streching(lotduc)","a0d8db70":"def crop(filename):\n    data, sr = librosa.load(filename)\n    aug = naa.CropAug(sampling_rate=sr)\n    augmented_data = aug.augment(data)\n\n    librosa_display.waveplot(augmented_data, sr=sr, alpha=0.5)\n    librosa_display.waveplot(data, sr=sr, color='r', alpha=0.25)\n\n    plt.tight_layout()\n    plt.show()\n\n    return ipd.Audio(augmented_data, rate=sr)","6efbbdf9":"crop(perfal)","661fb865":"crop(lotduc)","a5878f37":"def loudnessaug(filename):\n    data, sr = librosa.load(filename)\n    aug = naa.LoudnessAug(loudness_factor=(2, 5))\n    augmented_data = aug.augment(data)\n\n    librosa_display.waveplot(augmented_data, sr=sr, alpha=0.25)\n    librosa_display.waveplot(data, sr=sr, color='r', alpha=0.5)\n\n    plt.tight_layout()\n    plt.show()\n\n    return ipd.Audio(augmented_data,rate=sr)","a85bc72a":"loudnessaug(perfal)","359f63ee":"loudnessaug(lotduc)","cd036257":"def mask(filename):\n    data, sr = librosa.load(filename)\n    aug = naa.MaskAug(sampling_rate=sr, mask_with_noise=False)\n    augmented_data = aug.augment(data)\n\n    librosa_display.waveplot(data, sr=sr, alpha=0.5)\n    librosa_display.waveplot(augmented_data, sr=sr, color='r', alpha=0.25)\n\n    plt.tight_layout()\n    plt.show()\n    \n    return ipd.Audio(augmented_data, rate=sr)","f5aeec5c":"mask(perfal)","ca26f59b":"mask(lotduc)","d6462f68":"def shift(filename):\n    data, sr = librosa.load(filename)\n    aug = naa.ShiftAug(sampling_rate=sr)\n    augmented_data = aug.augment(data)\n\n    librosa_display.waveplot(data, sr=sr, alpha=0.5)\n    librosa_display.waveplot(augmented_data, sr=sr, color='r', alpha=0.25)\n\n    plt.tight_layout()\n    plt.show()\n    \n    return ipd.Audio(augmented_data, rate=sr)","1f88923a":"shift(perfal)","ed39637b":"shift(lotduc)","fa110c72":"# Change pitch and speed","0156ad1c":"# Change pitch only","77374894":"# random shifting","f8abaed1":"# Mask Augmentation","1d6bd953":"# Audio file","c8b63a4e":"# Change speed only","0e90b80f":"# Loudness Augmentation","3ca735c3":"# value augmentation","93da0913":"# Shift Augmentation","92a84a82":"# Streching","a72d22a5":"# Applying hpss","b433ddad":"# cropping"}}