{"cell_type":{"dc8ed6ae":"code","600c3199":"code","fc398c98":"code","60ada282":"code","04defb88":"code","c78a2593":"code","62a42bfb":"code","200cc7a1":"code","dce4a93a":"code","8619a0d2":"code","fba31987":"code","4be3c9af":"code","8cd32fdb":"code","2422bf2a":"code","554759ad":"code","43ec5cec":"code","2bec9a97":"code","74591a12":"markdown","725c678a":"markdown","518d0d16":"markdown","94562cb0":"markdown","97dd5f95":"markdown","ac3e457a":"markdown","73ce5b27":"markdown","fa67af3a":"markdown","466d255d":"markdown","d85c61b2":"markdown","f7d1178f":"markdown"},"source":{"dc8ed6ae":"import os\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.preprocessing import LabelEncoder, MinMaxScaler\nfrom sklearn.metrics import accuracy_score\nfrom xgboost import XGBClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","600c3199":"path = '\/kaggle\/input\/heart-attack-analysis-prediction-dataset\/'\nos.listdir(path)","fc398c98":"def plot_hist(data, feature, bins=10):\n    fig, axs = plt.subplots(1, 2, figsize=(14, 3), sharey=True, sharex=True)\n    axs[0].hist(data[data['Target']==0][feature], bins=bins, color='yellowgreen', alpha=0.7)\n    axs[1].hist(data[data['Target']==1][feature], bins=bins, color='tomato', alpha=0.7)\n    axs[0].set_title('Less chance of heart attack')\n    axs[1].set_title('More chance of heart attack')\n    axs[0].grid()\n    axs[1].grid()\n    \ndef plot_bar(data, feature):\n    fig, axs = plt.subplots(1, 2, figsize=(14, 3), sharey=True, sharex=True)\n    names = np.arange(len(set(data[feature].unique())))\n    axs[0].bar(names, data[data['Target']==0][feature].value_counts(), color='yellowgreen', alpha=0.7)\n    axs[1].bar(names, data[data['Target']==1][feature].value_counts(), color='tomato', alpha=0.7)\n    \n    axs[0].set_xticks(names)\n    axs[1].set_xticks(names)\n    \n    axs[0].set_title('Less chance of heart attack')\n    axs[1].set_title('More chance of heart attack')\n    axs[0].grid()\n    axs[1].grid()","60ada282":"data = pd.read_csv(path+'heart.csv')","04defb88":"print('Number of samples: ', len(data.index))\nprint('Number of features: ', len(data.columns))","c78a2593":"data.head()","62a42bfb":"dict_names = {'age': 'Age', 'sex': 'Sex', 'cp': 'Chest_Pain', 'trtbps': 'Blood_Pressure', 'chol': 'Cholestoral',\n              'fbs': 'Blood_Sugar', 'restecg': 'ECG_Results', 'thalachh': 'Heart_Rate', 'exng': 'Angina',\n              'oldpeak': 'Previous_Peak', 'slp': 'Slope', 'caa': 'Vessels', 'thall': 'Thale_Rate', 'output': 'Target'}","200cc7a1":"data.rename(columns=dict_names, inplace=True)","dce4a93a":"plot_hist(data, 'Age', bins=20)","8619a0d2":"plot_bar(data, 'Sex')","fba31987":"plot_hist(data, 'Heart_Rate', bins=20)","4be3c9af":"X = data[data.columns.difference(['Target'])]\ny = data['Target']\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=2021)\n\nprint('Train samples:', len(X_train))\nprint('Test samples:', len(X_test))","8cd32fdb":"model = DecisionTreeClassifier()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\nprint('Test Score:', accuracy_score(y_test, y_pred, normalize=True))","2422bf2a":"importance = model.feature_importances_\nfig = plt.figure(figsize=(10, 6))\nx = X_train.columns.values\nplt.barh(x, 100*importance)\nplt.title('Feature Importance', loc='left')\nplt.xlabel('Percentage')\nplt.grid()\nplt.show()","554759ad":"param_grid = {'criterion': ['gini'],\n              'max_features': [None, 'auto', 'sqrt', 'log2'],\n              'max_depth': [i for i in range(1, 6)],\n              'class_weight': [None, 'balanced'],\n              'min_samples_split': [2, 4, 6, 8, 10 ,12],\n              'min_samples_leaf': [1, 2, 3, 4],\n              'random_state': [2021]}\ngrid = GridSearchCV(DecisionTreeClassifier(), param_grid=param_grid, cv=5, scoring='accuracy')\ngrid.fit(X_train, y_train)\nbest_params = grid.best_params_\nprint('Best score of cross validation: {:.3f}'.format(grid.best_score_))\nprint('Best parameters:', best_params)","43ec5cec":"model = DecisionTreeClassifier()\nmodel.set_params(**best_params)\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\nprint(accuracy_score(y_test, y_pred, normalize=True))","2bec9a97":"importance = model.feature_importances_\nfig = plt.figure(figsize=(10, 6))\nx = X_train.columns.values\nplt.barh(x, 100*importance)\nplt.title('Feature Importance', loc='left')\nplt.xlabel('Percentage')\nplt.grid()\nplt.show()","74591a12":"**About this dataset**\n\n* age : Age of the patient\n* sex : Sex of the patient\n* cp : [Chest Pain](https:\/\/en.wikipedia.org\/wiki\/Chest_pain) type chest pain type\n    * Value 1: typical angina\n    * Value 2: atypical angina\n    * Value 3: non-anginal pain\n    * Value 4: asymptomatic\n* trtbps : resting [blood pressure](https:\/\/en.wikipedia.org\/wiki\/Blood_pressure)  (in mm Hg)\n* chol : [cholestoral](https:\/\/en.wikipedia.org\/wiki\/Cholesterol) in mg\/dl fetched via BMI sensor\n* fbs : (fasting [blood sugar](https:\/\/en.wikipedia.org\/wiki\/Blood_sugar_level) > 120 mg\/dl) (1 = true; 0 = false)\n* restecg : resting [electrocardiographic](https:\/\/en.wikipedia.org\/wiki\/Electrocardiography) results\n    * Value 0: normal\n    * Value 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\n    * Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria\n* thalach : maximum [heart rate](https:\/\/en.wikipedia.org\/wiki\/Heart_rate) achieved\n* exng: exercise induced angina (1 = yes; 0 = no)\n* oldpeak: previous peak\n* slp: slope\n* caa: number of major [vessels](https:\/\/en.wikipedia.org\/wiki\/Blood_vessel) (0-3)\n* thall: thale rate\n* output \n     * Value 0: less chance of heart attack\n     * Value 1: more chance of heart attack","725c678a":"# Grid Search","518d0d16":"# Intro\nWelcome to the [Heart Attack Analysis & Prediction Dataset](https:\/\/www.kaggle.com\/rashikrahmanpritom\/heart-attack-analysis-prediction-dataset)\n\n![](https:\/\/storage.googleapis.com\/kaggle-datasets-images\/1226038\/2046696\/2465e7cd117a6954befa50eff39d236f\/dataset-cover.jpg)\n\n<font size=\"4\"><span style=\"color: royalblue;\">Please vote the notebook up if it helps you. Feel free to leave a comment above the notebook. Thank you. <\/span><\/font>","94562cb0":"# Functions","97dd5f95":"# Train And Test Data","ac3e457a":"# Overview","73ce5b27":"# Load Data","fa67af3a":"# Path","466d255d":"# Libraries ","d85c61b2":"# Simple Model","f7d1178f":"# Exploratory Data Analysis"}}