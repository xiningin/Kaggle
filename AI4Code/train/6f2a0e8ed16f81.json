{"cell_type":{"3d26d0c4":"code","71176f26":"code","1e628048":"code","cf0c8847":"code","6884fd88":"code","49bcfcec":"code","ff71a1a8":"code","9b8d3ce0":"code","ca0dc58b":"code","66196521":"code","78294f4c":"code","e80ad913":"code","e35139f4":"code","3502f8bd":"code","10f641e8":"markdown","b3f82fa3":"markdown","aa5f0c35":"markdown","c4e188e2":"markdown","5492e8b7":"markdown","b8bf1179":"markdown","87849984":"markdown","00faca88":"markdown","a607b072":"markdown","fc10637a":"markdown","f8c84590":"markdown"},"source":{"3d26d0c4":"%matplotlib inline\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport scipy.stats as stat\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import classification_report,confusion_matrix,f1_score","71176f26":"data = pd.read_csv(\"..\/input\/loan-predication\/train_u6lujuX_CVtuZ9i (1).csv\")","1e628048":"data.head()","cf0c8847":"data = data.iloc[:,1:]\ndata.head()","6884fd88":"data.info()","49bcfcec":"data.describe()","ff71a1a8":"data.replace({'Loan_Status':{'Y':1,'N':0}},inplace=True)\ndata['Loan_Status']","9b8d3ce0":"corr_matrix = data.corr()\ncorr_matrix[\"Loan_Status\"].sort_values(ascending=False)","ca0dc58b":"from pandas.plotting import scatter_matrix\nattributes = [\"ApplicantIncome\", \"CoapplicantIncome\", \"LoanAmount\", \"Loan_Amount_Term\", \"Credit_History\", \"Loan_Status\"]\nscatter_matrix(data, figsize=(12, 8))","66196521":"X_data = data.iloc[:,:-1]\nY_data = data['Loan_Status']\nX_data = pd.get_dummies(X_data, dummy_na=True)","78294f4c":"X_data = X_data.fillna(X_data.mean())\nprint(X_data.shape)\nprint(Y_data.shape)","e80ad913":"train_features, test_features, train_labels, test_labels = train_test_split(X_data, Y_data, test_size=0.3, stratify=Y_data, random_state=42)","e35139f4":"from sklearn.model_selection import cross_val_score\ndef logistic(train_features, test_features, train_labels, test_labels):\n    lr=LogisticRegression(solver='liblinear')\n    lr.fit(train_features, train_labels)\n    pred=lr.predict(test_features)\n    print('Confusion matrix')\n    print(confusion_matrix(test_labels, pred))\n    print('mean of cross_val_score')\n    scores = cross_val_score(lr, train_features, train_labels, cv=5,  scoring=\"accuracy\")\n    print(scores.sum()\/5)\n    print('Classification report')\n    print(classification_report(test_labels, pred))\n    print('f1_score : {}'.format(f1_score(test_labels,pred)))","3502f8bd":"logistic(train_features, test_features, train_labels, test_labels)","10f641e8":"# 6. \u8bad\u7ec3\u6a21\u578b\u548c\u9884\u6d4b","b3f82fa3":"# 4. \u5206\u5272\u8bad\u7ec3\u96c6\u548c\u6d4b\u8bd5\u96c6","aa5f0c35":"# 3. \u9884\u5904\u7406\u6570\u636e","c4e188e2":"# 5. \u903b\u8f91\u56de\u5f52\u6a21\u578b","5492e8b7":"# 2. \u5206\u6790\u6570\u636e","b8bf1179":"# 1. \u83b7\u53d6\u6570\u636e","87849984":"## 3.2 \u586b\u5145\u7f3a\u5931\u503c","00faca88":"## 2.1 \u53bb\u9664loan_ID","a607b072":"## 2.3 \u53ef\u89c6\u5316\u5206\u6790","fc10637a":"## 3.1 \u628a\u6587\u672cfeatures\u53d8\u4e3aone-hot\u503c","f8c84590":"## 2.2 \u66ff\u6362labels\u7684\u503c"}}