{"cell_type":{"422bbad9":"code","657c9c7f":"code","8bda475a":"code","12739b0a":"code","d643d6fd":"code","a4f38bfc":"code","84aa14cf":"code","a39cf6d9":"code","5cd03c43":"code","9ee2bd9f":"code","f0636f69":"code","fe40e01a":"code","44eec4a7":"code","9c452a83":"code","5ebea8de":"code","c1c05550":"code","dac0c185":"code","3851e08b":"code","9402f892":"code","ef31a123":"code","2fbf689f":"code","df43d164":"code","f409b161":"code","b8faf9f8":"code","429869bd":"code","4ef6fd83":"code","3eaeebe7":"code","5f34d389":"code","c11f4353":"code","4df113ee":"code","d9079997":"code","f2bcd869":"code","682d4dfd":"code","1e4f8913":"code","20b162fc":"code","87a6bc86":"code","929853a3":"code","5c6e818b":"code","09e6a702":"code","de1dc07a":"code","d32ea2e4":"code","554d75e0":"code","3b4f9fd2":"code","e5ed2c4a":"code","ab45b488":"code","b3d289ed":"code","009fb479":"markdown","e4d81e5c":"markdown","510e706a":"markdown","539c56b6":"markdown"},"source":{"422bbad9":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","657c9c7f":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","8bda475a":"train=pd.read_csv('..\/input\/covid19-global-forecasting-week-2\/train.csv')\ntest=pd.read_csv('..\/input\/covid19-global-forecasting-week-2\/test.csv')","12739b0a":"test1=test","d643d6fd":"train.head(5)","a4f38bfc":"test1.head(5)","84aa14cf":"test.head(5)","a39cf6d9":"train.info()","5cd03c43":"fig = plt.figure(figsize=(16,8))\nax = fig.add_subplot(111)\ntrain.groupby('Date').mean().sort_values(by='ConfirmedCases', ascending=False)['ConfirmedCases'].plot('bar', color='r',width=0.3,title='Date Confirmed Cases', fontsize=10)\nplt.xticks(rotation = 90)\nplt.ylabel('Date')\nax.title.set_fontsize(30)\nax.xaxis.label.set_fontsize(10)\nax.yaxis.label.set_fontsize(10)\nprint(train.groupby('Date').mean().sort_values(by='ConfirmedCases', ascending=False)['ConfirmedCases'][[1,2]])\nprint(train.groupby('Date').mean().sort_values(by='ConfirmedCases', ascending=False)['ConfirmedCases'][[4,5,6]])","9ee2bd9f":"#Country_Region top 30\ntrain.Country_Region.value_counts()[0:30].plot(kind='bar')\nplt.show()","f0636f69":"fig = plt.figure(figsize=(16,8))\nax = fig.add_subplot(111)\ntrain.groupby('Date').mean().sort_values(by='Fatalities', ascending=False)['Fatalities'].plot('bar', color='r',width=0.3,title='Date Fatalities Cases', fontsize=10)\nplt.xticks(rotation = 90)\nplt.ylabel('Date')\nax.title.set_fontsize(30)\nax.xaxis.label.set_fontsize(10)\nax.yaxis.label.set_fontsize(10)\nprint(train.groupby('Date').mean().sort_values(by='Fatalities', ascending=False)['Fatalities'][[1,2]])\nprint(train.groupby('Date').mean().sort_values(by='Fatalities', ascending=False)['Fatalities'][[4,5,6]])","fe40e01a":"#visualization of main places US,ITALY,CHINA,UK\n#US\nConfirmedCases_date_US = train[train['Country_Region']=='US'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_US = train[train['Country_Region']=='US'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_US = ConfirmedCases_date_US.join(fatalities_date_US)\n\n\n#China\nConfirmedCases_date_China = train[train['Country_Region']=='China'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_China = train[train['Country_Region']=='China'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_China = ConfirmedCases_date_China.join(fatalities_date_China)\n\n#Italy\nConfirmedCases_date_Italy = train[train['Country_Region']=='Italy'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Italy = train[train['Country_Region']=='Italy'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Italy = ConfirmedCases_date_Italy.join(fatalities_date_Italy)\n\n#Australia\nConfirmedCases_date_Australia = train[train['Country_Region']=='Australia'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Australia = train[train['Country_Region']=='Australia'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Australia = ConfirmedCases_date_Australia.join(fatalities_date_Australia)\n\n\n\nplt.figure(figsize=(15,10))\nplt.subplot(2, 2, 1)\ntotal_date_US.plot(ax=plt.gca(), title='US')\nplt.ylabel(\"Confirmed  cases\", size=13)\n\nplt.subplot(2, 2, 2)\ntotal_date_China.plot(ax=plt.gca(), title='China')\n\nplt.subplot(2, 2, 3)\ntotal_date_Italy.plot(ax=plt.gca(), title='Italy')\nplt.ylabel(\"Confirmed cases\", size=13)\n\nplt.subplot(2, 2, 4)\ntotal_date_Australia.plot(ax=plt.gca(), title='Australia')","44eec4a7":"train['Date']= pd.to_datetime(train['Date']) \ntest['Date']= pd.to_datetime(test['Date'])","9c452a83":"train = train.set_index(['Date'])\ntest = test.set_index(['Date'])","5ebea8de":"def create_time_features(df):\n    \"\"\"\n    Creates time series features from datetime index\n    \"\"\"\n    df['date'] = df.index\n    df['hour'] = df['date'].dt.hour\n    df['dayofweek'] = df['date'].dt.dayofweek\n    df['quarter'] = df['date'].dt.quarter\n    df['month'] = df['date'].dt.month\n    df['year'] = df['date'].dt.year\n    df['dayofyear'] = df['date'].dt.dayofyear\n    df['dayofmonth'] = df['date'].dt.day\n    df['weekofyear'] = df['date'].dt.weekofyear\n    \n    X = df[['hour','dayofweek','quarter','month','year',\n           'dayofyear','dayofmonth','weekofyear']]\n    return X","c1c05550":"create_time_features(train).head()\ncreate_time_features(test).head()","dac0c185":"train.head(5)","3851e08b":"train.drop(\"date\", axis=1, inplace=True)\ntest.drop(\"date\", axis=1, inplace=True)","9402f892":"confirmed_corr=train.corr()['ConfirmedCases']","ef31a123":"confirmed_corr.sort_values(ascending=False)","2fbf689f":"fatalities_corr=train.corr()['Fatalities']","df43d164":"fatalities_corr.sort_values(ascending=False)","f409b161":"train.drop(\"dayofweek\", axis=1, inplace=True)\ntest.drop(\"dayofweek\", axis=1, inplace=True)","b8faf9f8":"train.drop(\"hour\", axis=1, inplace=True)\ntest.drop(\"hour\", axis=1, inplace=True)","429869bd":"train.drop(\"quarter\", axis=1, inplace=True)\ntest.drop(\"quarter\", axis=1, inplace=True)","4ef6fd83":"train.drop(\"year\", axis=1, inplace=True)\ntest.drop(\"year\", axis=1, inplace=True)","3eaeebe7":"train.drop(\"Province_State\", axis=1, inplace=True)\ntest.drop(\"Province_State\", axis=1, inplace=True)","5f34d389":"train.drop(\"Id\", axis=1, inplace=True)\ntest.drop(\"ForecastId\", axis=1, inplace=True)","c11f4353":"test.info()","4df113ee":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\ndef FunLabelEncoder(df):\n    for c in df.columns:\n        if df.dtypes[c] == object:\n            le.fit(df[c].astype(str))\n            df[c] = le.transform(df[c].astype(str))\n    return df","d9079997":"train = FunLabelEncoder(train)\ntrain.info()","f2bcd869":"test = FunLabelEncoder(test)\ntest.info()","682d4dfd":"test.head(5)","1e4f8913":"x_train= train[['Country_Region', 'month', 'dayofyear', 'dayofmonth' , 'weekofyear']]\ny1 = train[['ConfirmedCases']]\ny2 = train[['Fatalities']]\nx_test = test[['Country_Region', 'month', 'dayofyear', 'dayofmonth' , 'weekofyear']]","20b162fc":"from sklearn.ensemble import RandomForestClassifier\n\n# We define the model\ntree_model= RandomForestClassifier(n_estimators=100, max_depth=200,\n                        random_state=1)","87a6bc86":"#for confirmed cases\ntree_model.fit(x_train,y1)\nprediction1 = tree_model.predict(x_test)\nprediction1 = pd.DataFrame(prediction1)\nprediction1.columns = [\"ConfirmedCases_prediction\"]","929853a3":"prediction1.head()","5c6e818b":"#for fatalities\ntree_model.fit(x_train,y2)\nprediction2 = tree_model.predict(x_test)\nprediction2 = pd.DataFrame(prediction2)\nprediction2.columns = [\"Death_prediction\"]","09e6a702":"sub_new=test1[[\"ForecastId\"]]\n","de1dc07a":"sub_new","d32ea2e4":"\nsubmit = pd.concat([prediction1,prediction2,sub_new],axis=1)\nsubmit.head()","554d75e0":"# Clean\nsubmit.columns = ['ConfirmedCases', 'Fatalities', 'ForecastId']\nsubmit = submit[['ForecastId','ConfirmedCases', 'Fatalities']]\n\nsubmit[\"ConfirmedCases\"] = submit[\"ConfirmedCases\"].astype(int)\nsubmit[\"Fatalities\"] = submit[\"Fatalities\"].astype(int)","3b4f9fd2":"submit.info()","e5ed2c4a":"submit.head(5)# Final prediction","ab45b488":"submit.shape","b3d289ed":"submit.to_csv(\"submission.csv\",index=False)","009fb479":"### Overview\n\n**Coronavirus disease (COVID-19) is an infectious disease caused by a new virus.\nThe disease causes respiratory illness (like the flu) with symptoms such as a cough, fever, and in more severe cases, difficulty breathing. You can protect yourself by washing your hands frequently, avoiding touching your face,\nand avoiding close contact (1 meter or 3 feet) with people who are unwell.**\n\n### How it spreads\n\n**Coronavirus disease spreads primarily through contact with an infected person when they cough or sneeze. It also spreads when a person touches a surface or object that has the virus on it, then touches their eyes, nose, or mouth.**\n\n### symptoms\n\n**People may be sick with the virus for 1 to 14 days before developing symptoms. The most common symptoms of coronavirus disease (COVID-19) are fever, tiredness, and dry cough. Most people (about 80%) recover from the disease without needing special treatment.**\n\n### Preventions\n\n**You can protect yourself and help prevent spreading the virus to others if you:\nDo\n\u2022 Wash your hands regularly for 20 seconds, with soap and water or alcohol-based hand rub\n\u2022 Cover your nose and mouth with a disposable tissue or flexed elbow when you cough or sneeze\n\u2022 Avoid close contact (1 meter or 3 feet) with people who are unwell\n\u2022 Stay home and self-isolate from others in the household if you feel unwell**\n\n###  Treatments\n\n**There is no specific medicine to prevent or treat coronavirus disease (COVID-19). People may need supportive care to help them breathe.**\n\n","e4d81e5c":"![image.png](attachment:image.png)","510e706a":"![image.png](attachment:image.png)","539c56b6":"### Details of the challenge \n\n***This is week 2 of Kaggle's COVID19 forecasting series, following the Week 1 competition. This is the 2nd of at least 4 competitions we plan to launch in this series.***\n\n### Background\n\n***The White House Office of Science and Technology Policy (OSTP) pulled together a coalition research groups and companies (including Kaggle) to prepare the COVID-19 Open Research Dataset (CORD-19) to attempt to address key open scientific questions on COVID-19. Those questions are drawn from National Academies of Sciences, Engineering, and Medicine\u2019s (NASEM) and the World Health Organization (WHO).***\n\n### The Challenge\n\n***Kaggle is launching a companion COVID-19 forecasting challenges to help answer a subset of the NASEM\/WHO questions. While the challenge involves forecasting confirmed cases and fatalities between April 1 and April 30 by region, the primary goal isn't only to produce accurate forecasts. It\u2019s also to identify factors that appear to impact the transmission rate of COVID-19.***\n\n***You are encouraged to pull in, curate and share data sources that might be helpful. If you find variables that look like they impact the transmission rate, please share your finding in a notebook.***\n\n***As the data becomes available, we will update the leaderboard with live results based on data made available from the Johns Hopkins University Center for Systems Science and Engineering (JHU CSSE).***\n\n***We have received support and guidance from health and policy organizations in launching these challenges. We're hopeful the Kaggle community can make valuable contributions to developing a better understanding of factors that impact the transmission of COVID-19.***\n\n### Companies and Organizations\n***There is also a call to action for companies and other organizations: If you have datasets that might be useful, please upload them to Kaggle\u2019s dataset platform and reference them in this forum thread. That will make them accessible to those participating in this challenge and a resource to the wider scientific community.***\n\n### Acknowledgements\n***JHU CSSE for making the data available to the public. The White House OSTP for pulling together the key open questions. The image comes from the Center for Disease Control.***"}}