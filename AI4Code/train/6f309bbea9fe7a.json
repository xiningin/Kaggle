{"cell_type":{"9d0031cb":"code","e0695548":"code","b34d6f05":"code","335351ea":"code","ba248660":"code","19a2f4c0":"code","beda1c84":"code","7d2f7cd9":"code","fbbed903":"code","b625c981":"code","0a07c80f":"code","74ad5038":"code","ea08e38d":"code","6c328a34":"code","bc42e29e":"code","d21c3ad0":"code","7cda3709":"code","113029ce":"code","f1b5b2c1":"code","eada4f23":"code","5a53b703":"code","5ed124db":"code","2ede2a96":"code","441db9e9":"code","d6c6579c":"code","dfd30584":"code","8d5c8fe4":"code","2a0d96eb":"code","c990c7d4":"code","4e2fad73":"code","b6113458":"code","bf6cefb4":"code","feef2177":"code","b6860d56":"code","5e2573a5":"code","4958f62c":"code","964ecd8a":"code","8e428aef":"code","cf965d44":"code","e90792fd":"code","207259a8":"code","fadc52f2":"code","2fd69972":"code","daa83094":"code","a449017c":"code","cf93f542":"code","6ba7b195":"code","a1ed2375":"code","27920ba2":"code","b35efa2b":"code","1bf4d624":"code","e8a9734e":"code","9c5722e7":"code","93b49e6f":"code","2dc6f683":"code","66ef0493":"code","90342b39":"code","8f4cd8e4":"code","d8836e29":"code","323bcc06":"code","75722fde":"code","a892f2ab":"code","37cd9206":"code","de4b638e":"code","d7af3b15":"code","46086c82":"code","e72a9538":"code","966e2fe5":"code","f7a3a813":"code","ab65a791":"code","2023950e":"code","54d47805":"code","f7536157":"code","2aeed192":"code","2839c9d1":"code","456c113b":"code","aaf0cab1":"code","a875e329":"code","92aec791":"code","a1dc79e9":"code","d12e574b":"code","c7e94fd7":"code","22cc5844":"code","3bdeb84b":"code","58a125b7":"code","5be20f46":"code","63f4549e":"code","657ddda5":"markdown","20c574b9":"markdown","bb990913":"markdown","7e073670":"markdown","d470461b":"markdown","c1e6fe6e":"markdown","1f7054fd":"markdown","9d9475b4":"markdown","18eee541":"markdown","f0d58274":"markdown","fe90d32d":"markdown","c2785fd1":"markdown","e251507a":"markdown","b1fede41":"markdown","d4054cdb":"markdown","746278e7":"markdown","5d1c1746":"markdown","621fbccb":"markdown","67b5edba":"markdown","3b34dc7c":"markdown"},"source":{"9d0031cb":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","e0695548":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns","b34d6f05":"import re","335351ea":"data = pd.read_csv('\/kaggle\/input\/income-classification\/income_evaluation.csv')","ba248660":"data.head()","19a2f4c0":"col_names = ['age', 'workclass', 'fnlwgt', 'education', 'education_num', 'marital_status', 'occupation', 'relationship',\n             'race', 'sex', 'capital_gain', 'capital_loss', 'hours_per_week', 'native_country', 'income']\n\ndata.columns = col_names\ndata.columns","beda1c84":"data.shape","7d2f7cd9":"data.info()","fbbed903":"print(\"%18s %10s   %10s %10s\" % (\"Column Name\", \"Data Type\", \"#Distinct\", \"NA Values\"))\nfor col in data.columns:\n    dtyp = data[col].dtype\n    uniq = data[col].nunique()\n    na = data[col].isna().sum()\n    print(\"%18s %10s %10s %10s\" % (col, dtyp, uniq, na))\n    ","b625c981":"categorical_feature = [feature for feature in data.columns if data[feature].dtype == 'O']\nprint(\"len of categorical_feature:\",len(categorical_feature))","0a07c80f":"data[categorical_feature].head()","74ad5038":"# there is an extra space before each value of categorical column so correct it.\nfor col in categorical_feature:\n    data[col] = data[col].str.strip()","ea08e38d":"data['workclass'].value_counts()","6c328a34":"data['workclass'] = np.where(data['workclass']=='?',np.NaN,data['workclass'])","bc42e29e":"plt.figure(figsize=(8,8))\ndata['workclass'].value_counts().plot(kind='bar')\nplt.xticks(rotation=45)\nplt.show()","d21c3ad0":"data['marital_status'].value_counts()\n# it is good","7cda3709":"plt.figure(figsize=(8,8))\nsns.countplot(x='income',hue='marital_status',data=data)\nplt.show()","113029ce":"data['occupation'].value_counts()","f1b5b2c1":"# same problem in occupation is there\ndata['occupation'] = np.where(data['occupation']=='?',np.NaN, data['occupation'])","eada4f23":"plt.figure(figsize=(8,8))\ndata['occupation'].value_counts().sort_values().plot(kind='bar')\nplt.xticks(rotation=45)\nplt.show()","5a53b703":"plt.figure(figsize=(8,8))\nsns.countplot(x='income',hue='occupation',data=data,palette='Dark2')\nplt.legend(loc='best')\nplt.show()","5ed124db":"# relationship\ndata['relationship'].value_counts()","2ede2a96":"plt.figure(figsize=(8,8))\nsns.countplot(x='income',hue='relationship',data=data,palette='Paired')\nplt.legend(loc='best')\nplt.show()","441db9e9":"# RACE\ndata['race'].value_counts()","d6c6579c":"# let's see income with respect to sex\nplt.figure(figsize=(8,6))\nsns.countplot(x='income',hue='race',data=data,palette='Set1')\nplt.title(\"Frequency dist of Income W.R.T to Race\")\nplt.show()","dfd30584":"data.sex.value_counts()","8d5c8fe4":"# let's see income with respect to sex\nplt.figure(figsize=(8,8))\nsns.countplot(x='income',hue='sex',data=data,palette='magma')\nplt.show()","2a0d96eb":"data['native_country'].value_counts()","c990c7d4":"data['native_country'].replace('?',np.NaN,inplace=True) ","4e2fad73":"# Education\nplt.figure(figsize=(8,8))\n#data['education'].value_counts().plot(kind='bar')\nsns.countplot(x='income',hue='education',data=data,palette='Dark2')\nplt.show()","b6113458":"# Education\nplt.figure(figsize=(8,8))\n#data['education'].value_counts().plot(kind='bar')\nsns.countplot(x='income',hue='education_num',data=data,palette='Dark2')\nplt.show()","bf6cefb4":"data['education'].value_counts().sort_values()","feef2177":"data.groupby('education')['education_num'].unique().sort_values()\n#here is a encoded number for each education.","b6860d56":"numerical_feature = [feature for feature in data.columns if data[feature].dtype != 'O']\nprint(\"len of numerical_feature:\",len(numerical_feature))","5e2573a5":"data[numerical_feature].head()","4958f62c":"sns.set_color_codes()\nsns.distplot(data['age'],hist=False)\nplt.show()","964ecd8a":"# Income wrt age\nplt.figure(figsize=(8,6))\nsns.boxplot(x='income',y='age',data=data)\nplt.show()","8e428aef":"# Income wrt age\nplt.figure(figsize=(10,8))\nax = sns.boxplot(x='income',y='age',hue='sex',data=data)\nax.set_title(\"visualize Income wrt sex and age\")\nax.legend(loc='best')\nplt.show()","cf965d44":"plt.figure(figsize=(10,8))\nax = sns.boxplot(x='income',y='hours_per_week',hue='sex',data=data)\nax.set_title(\"visualization of income wrt hours work done per week and sex\")\nplt.show()","e90792fd":"data['income'].value_counts()","207259a8":"plt.figure(figsize=(6,6))\ndata['income'].value_counts().plot.pie(explode=[0,0.1],autopct='%1.1f%%',shadow=True,startangle=15)\nplt.xlabel(\"Income_Share\")\nplt.show()","fadc52f2":"data[categorical_feature].isnull().sum()","2fd69972":"for col in categorical_feature:\n    if(data[col].isnull().mean() > 0):\n        print(col, ' ', data[col].isnull().mean())","daa83094":"data['workclass'].mode()[0]","a449017c":"data['workclass'].fillna(data['workclass'].mode()[0], inplace=True)\ndata['occupation'].fillna(data['occupation'].mode()[0], inplace=True)\ndata['native_country'].fillna(data['native_country'].mode()[0], inplace=True)","cf93f542":"data.head(3)","6ba7b195":"categorical_feature","a1ed2375":"from sklearn.preprocessing import LabelEncoder","27920ba2":"cols = ['sex','income']\nfor col in cols:\n    data[col] = pd.get_dummies(data[col],drop_first=True) ","b35efa2b":"data.head(3)   # 0=F\/1=M & 0=<=50k","1bf4d624":"categorical = [feature for feature in data.columns if data[feature].dtype == 'O']\ncategorical","e8a9734e":"data.head(3)","9c5722e7":"data['workclass'].unique()","93b49e6f":"#data.groupby('workclass')['income'].mean().sort_values().index","2dc6f683":"for col in categorical:\n    labels = data.groupby(col)['income'].mean().sort_values().index\n    print(col,'\\n',labels,'\\n')","66ef0493":"for col in categorical:\n    labels = data.groupby(col)['income'].mean().sort_values().index\n    mapping_dict = {k: i for i, k in enumerate(labels, 0)}\n    # apply encoding to our data\n    data[col] = data[col].map(mapping_dict)","90342b39":"data.head(3)","8f4cd8e4":"plt.figure(figsize=(8,8))\nsns.distplot(data['age'])\nplt.show()","d8836e29":"import scipy.stats as stat\nimport pylab   # for probability plot","323bcc06":"def plot_data(df,variable):\n    plt.figure(figsize=(10,8))\n    plt.subplot(1,2,1)\n    df[variable].hist()\n    plt.subplot(1,2,2)\n    stat.probplot(df[variable],dist='norm',plot=pylab)\n    plt.show()","75722fde":"plot_data(data,'age')","a892f2ab":"plot_data(data,'hours_per_week')","37cd9206":"data.corr()['income'][:].sort_values(ascending=False)","de4b638e":"from sklearn.tree import ExtraTreeClassifier\nfrom sklearn.ensemble import ExtraTreesClassifier","d7af3b15":"data.head(3)","46086c82":"x = data.drop('income',axis=1)\ny = data['income']","e72a9538":"from sklearn.preprocessing import MinMaxScaler\n\nminmax = MinMaxScaler()\n\nX = minmax.fit_transform(x)","966e2fe5":"extra_tree = ExtraTreesClassifier(n_estimators=5, criterion='entropy', max_features=3)\n\nextra_tree.fit(X,y)","f7a3a813":"feature_imp = extra_tree.feature_importances_\nfeature_imp","ab65a791":"# Normalizing the individual importances \n#feature_importance_normalized = np.std([tree.feature_importances_ for tree in \n #                                       extra_tree.estimators_], \n  #                                      axis = 0)\n#feature_importance_normalized ","2023950e":"'''\nplt.figure(figsize=(8,8))\nplt.barh(x.columns,feature_importance_normalized )\nplt.ylabel('feature labels')\nplt.xlabel('target')\nplt.show()\n'''","54d47805":"plt.figure(figsize=(11,9))\nfeat_imp = pd.Series(extra_tree.feature_importances_, index=x.columns)\nfeat_imp.nlargest(20).plot(kind = 'barh')\nplt.show()","f7536157":"from sklearn.model_selection import train_test_split\n\nfrom sklearn.svm import SVC\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import RandomForestClassifier\n\n#metrics\nfrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report","2aeed192":"x_train,x_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state=0)","2839c9d1":"svc_clf = SVC()\nknn_clf = KNeighborsClassifier()\ndt_clf = DecisionTreeClassifier()\nrf_clf = RandomForestClassifier()","456c113b":"for clf in (svc_clf, knn_clf, dt_clf, rf_clf):\n    clf.fit(x_train, y_train)\n    \n    y_pred = clf.predict(x_test)\n    \n    print(clf.__class__.__name__, accuracy_score(y_test,y_pred))","aaf0cab1":"rf_clf.fit(x_train,y_train)\n\nypred = rf_clf.predict(x_test)\n\nprint(\"accuracy:\",accuracy_score(y_test,ypred))\nprint(\"\\nclassification_report:\\n\",classification_report(y_test,y_pred))","a875e329":"# VotingClassifier\nfrom sklearn.ensemble import VotingClassifier\n\nvot_clf = VotingClassifier([('svc',svc_clf),('knn',knn_clf),('dt',dt_clf),('rf',rf_clf)],voting='hard')\n\nvot_clf.fit(x_train,y_train)\n\nmypred = vot_clf.predict(x_test)\n\nprint(\"accuracy:\",accuracy_score(y_test,mypred))","92aec791":"#The number of trees in the forest\nn_estimators = [int(x) for x in np.linspace(start=100,stop=1200,num=12)]\n#measure quality of split\ncriterion = [\"gini\", \"entropy\"]\n# The maximum depth of the tree.\nmax_depth = [int(x) for x in np.linspace(6,30,5)]\n# The minimum number of samples required to split an internal node:\nmin_samples_split = [2,7,10,15]\n#The minimum number of samples required to be at a leaf node.\nmin_samples_leaf = [2,5,7]\n# The number of features to consider when looking for the best split:\nmax_features = ['sqrt','auto']\n\nrandom_grid = dict(n_estimators=n_estimators, criterion=criterion, max_depth=max_depth,\n                  min_samples_split=min_samples_split, min_samples_leaf=min_samples_leaf,\n                  max_features=max_features)\nprint(random_grid)","a1dc79e9":"from sklearn.model_selection import RandomizedSearchCV","d12e574b":"rf_random = RandomizedSearchCV(rf_clf, param_distributions=random_grid, cv=5,n_iter=15, random_state=42,n_jobs=-1,verbose=1)\n\nrf_random.fit(x_train,y_train)","c7e94fd7":"rf_random.best_params_","22cc5844":"rf_random.best_score_","3bdeb84b":"rf_clf = RandomForestClassifier(n_estimators= 1000,min_samples_split= 2,\n                                min_samples_leaf= 2,max_features= 'auto',max_depth= 18,\n                               criterion= 'entropy')\n\nrf_clf.fit(x_train, y_train)\n\npred = rf_clf.predict(x_test)\n\nprint(\"accuracy:\",accuracy_score(y_test,y_pred))\nprint(\"\\nclassification_report:\",classification_report(y_test,y_pred))","58a125b7":"import pickle\n\nfile = open('incomeclf.pkl','wb')\npickle.dump(rf_clf,file)","5be20f46":"clf = pickle.load(open('incomeclf.pkl','rb'))","63f4549e":"predi = clf.predict(x_test)\nprint(accuracy_score(y_test,predi))","657ddda5":"* there is no-null values in ds","20c574b9":"* this are the coresponding education_num for each education given, which I do not suppose to be correct encoded so we will encode it further and drop the education_num.","bb990913":"* with help of qq plot the age and hours_per_week is approximate or absolutely normally distributed\n","7e073670":"### Feature Scalling","d470461b":"* Yes it's same there is no duplicasy here, corect encoded is there","c1e6fe6e":"## Model fitting and testing","1f7054fd":"**Thank you so much to follow and have a look at my kernel. If something you find useful and interesting then please upvote this notebook. It will be to motivating for me and I am open to all the changes if you find any corections then please use comment box to appreciate, to suggest and to contribute something from your side to. I am a learner and want to learn something from you too.**\n\n**For more notebooks and Techniques, Please follow**\n\n**All technique for Missing value Imputation and Categorical encoding**\n https:\/\/www.kaggle.com\/rxsraghavagrawal\/all-technique-for-missing-imputation-cat-encoding\n \n**Feature transformation and feature scalling Techniques**\n https:\/\/www.kaggle.com\/rxsraghavagrawal\/feature-transformation-feature-scaling\n\n**Techniques to detect and handle Outliers,**\n https:\/\/www.kaggle.com\/rxsraghavagrawal\/handling-outliers\n","9d9475b4":"### Hyperparameter tuning for RandomForest","18eee541":"* In this case we can use Frequent Category Imputation and Random Sampling Imputation Both. both will work fine.","f0d58274":"### Categorical Encoding","fe90d32d":"## Numerical Feature","c2785fd1":"**Explore target variable**","e251507a":"* By seeing this we can say that whether the salary is whatever the ferquency of male is more in both the fields then female.","b1fede41":"## Categorical Variables","d4054cdb":"## Feature Selection\n**Pearson-corelation coefficient and ExtraTreesClassifier**","746278e7":"* Now, here we can see that it consist of missing value as ?, Now what it means\n* python will only detect NaN as missing not ?. so we have to encode this to NaN and then see.","5d1c1746":"## Save the Model for future use.","621fbccb":"## Impute Missing Values","67b5edba":"* age: the age of an individual\n   Integer greater than 0\n* workclass: a general term to represent the employment status of an individual\n   Private, Self-emp-not-inc, Self-emp-inc, Federal-gov, Local-gov, State-gov, Without-pay, Never-worked.\n* fnlwgt: this is the number of people the census believes the entry represents. Integer greater than 0\n* education: the highest level of education achieved by an individual.\n  Bachelors, Some-college, 11th, HS-grad, Prof-school, Assoc-acdm, Assoc-voc,     9th, 7th-8th, 12th, Masters, 1st-4th, 10th, Doctorate, 5th-6th, Preschool.\n* education-num: the highest level of education achieved in numerical form.\n  Integer greater than 0\n* marital-status: marital status of an individual. Married-civ-spouse corresponds to a civilian spouse while Married-AF-spouse is a spouse in the Armed Forces.\n Married-civ-spouse, Divorced, Never-married, Separated, Widowed, Married-spouse-absent, Married-AF-spouse.\n* occupation: the general type of occupation of an individual Tech-support, Craft-repair, Other-service, Sales, Exec-managerial, Prof-specialty, Handlers-cleaners, Machine-op-inspct, Adm-clerical, Farming-fishing, Transport-moving, Priv-house-serv, Protective-serv, Armed-Forces.\n* relationship: represents what this individual is relative to others. For example an individual could be a Husband. Each entry only has one relationship attribute and is somewhat redundant with marital status. We might not make use of this attribute at all Wife, Own-child, Husband, Not-in-family, Other-relative, Unmarried.\n* race: Descriptions of an individual\u2019s race\n  White, Asian-Pac-Islander, Amer-Indian-Eskimo, Other, Black.\n* sex: the biological sex of the individual Male, female\n* capital-gain: capital gains for an individual Integer greater than or equal to 0\n* capital-loss: capital loss for an individual\n  Integer greater than or equal to 0\n* hours-per-week: the hours an individual has reported to work per week continuous\n* native-country: country of origin for an individual  United-States, Cambodia, England, Puerto-Rico, Canada, Germany, Outlying-US(Guam-USVI-etc), India, Japan, Greece, South, China, Cuba, Iran, Honduras, Philippines, Italy, Poland, Jamaica, Vietnam, Mexico, Portugal, Ireland, France, Dominican-Republic, Laos, Ecuador, Taiwan, Haiti, Columbia, Hungary, Guatemala, Nicaragua, Scotland, Thailand, Yugoslavia, El-Salvador, Trinadad&Tobago, Peru, Hong, Holand-Netherlands.\n\n* the label: whether or not an individual makes more than $50,000 annually.\n   <= 50K, >50K","3b34dc7c":"* here we can see that the features like fnlwgt, age, marital status have adverse means positive ipact on salary and feature like naitive country, sex, race did not matter to much in salary aspect point of view."}}