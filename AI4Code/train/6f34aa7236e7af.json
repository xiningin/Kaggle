{"cell_type":{"de9dbf96":"code","72af6e44":"code","0a36519f":"code","a16fb95b":"code","7a9afbd1":"code","fc4d3258":"code","d9ba126c":"code","14367cbb":"code","35516759":"code","46cca384":"code","d06a963b":"code","a7a041cf":"code","c898f2cb":"code","8d44622c":"code","c9e73b57":"code","dd5ff0b6":"code","bfda956e":"code","eb3a0dd4":"code","5599ec6e":"code","6395c883":"code","7d39d000":"code","6e6ad580":"code","b7d4f15c":"markdown","8b6c7f30":"markdown","a4629904":"markdown","3aa3bfff":"markdown","d236b688":"markdown","643e5d9e":"markdown","5a7f4320":"markdown","8aaf350e":"markdown"},"source":{"de9dbf96":"import pandas as pd\nimport numpy as np\nfrom scipy import stats\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom tqdm import tqdm\nimport helpers\nsns.set()\nnp.random.seed(42)","72af6e44":"symbol = 'AAPL'\noutput_size = 'compact'","0a36519f":"df_raw = helpers.fetch_data(symbol, output_size)\ndf = df_raw.copy()","a16fb95b":"df = df_raw.sort_values(by='timestamp')\ndf.head()","7a9afbd1":"return_rate = pd.DataFrame(df['adjusted_close']).pct_change()\nreturn_rate.head()","fc4d3258":"avg_return_rate = return_rate.mean()\nvar_return_rate = return_rate.var()\nstdev_return_rate = return_rate.std()\ndrift = (avg_return_rate - (var_return_rate \/ 2)) - 0.5 * stdev_return_rate ** 2\nlast_close_price = df['adjusted_close'].iloc[-1]","d9ba126c":"simulation = pd.DataFrame()","14367cbb":"number_simulation = 100\npredict_days = 30","35516759":"for i in tqdm(range(number_simulation)):\n    price_list = []\n    price_list.append(last_close_price)\n    for day in range(predict_days): \n        shock = [drift + stdev_return_rate * np.random.normal()]\n        shock = np.mean(shock)\n        price = price_list[-1] * np.exp(shock)\n        price_list.append(price)\n    simulation[i] = price_list","46cca384":"simulation.head()","d06a963b":"plt.style.use(['ggplot'])\nplt.figure(figsize=(15,7))\nplt.plot(simulation)\nplt.title('Simulation', color='black')\nplt.ylabel('Stock Price')\nplt.xlabel('Simulation Days')\nplt.show()","a7a041cf":"plt.style.use(['ggplot'])\nplt.figure(figsize=(15,7))\nplt.plot(simulation[simulation.columns[:2]])\nplt.title('Simulation', color='black')\nplt.ylabel('Stock Price')\nplt.xlabel('Simulation Days')\nplt.show()","c898f2cb":"simulation_means = np.array([simulation[i].mean() for i in range(100)])","8d44622c":"plt.style.use(['ggplot'])\nplt.figure(figsize=(15,5))\nplt.subplot(1,2,1)\nsns.distplot(df['adjusted_close'],norm_hist=True)\nplt.title('Simulation\\nmean = {:.4f}\\nstdev = {:.4f}\\nskewness = {:.4f}\\nkurtosis = {:.4f}'\n      .format(np.mean(simulation_means), \n              np.std(simulation_means), \n              stats.skew(simulation_means), \n              stats.kurtosis(simulation_means)), color='black')\nplt.xlabel('Close Price')\n\nplt.subplot(1,2,2)\nsns.distplot(simulation_means,norm_hist=True,label='Simulation')\nsns.distplot(df['adjusted_close'],norm_hist=True,label='Sample')\nplt.title('Sample\\nmean = {:.4f}\\nstdev = {:.4f}\\nskewness = {:.4f}\\nkurtosis = {:.4f}'\n      .format(df['adjusted_close'].mean(), \n              df['adjusted_close'].std(), \n              df['adjusted_close'].skew(), \n              df['adjusted_close'].kurtosis()), color='black')\nplt.xlabel('Close Price')\n\nplt.legend()\nplt.show()","c9e73b57":"mean_real = df['adjusted_close'].mean()","dd5ff0b6":"t_statistic, p_value = helpers.t_test_1sample(alpha=0.05, \n                                              sample_array=simulation_means, \n                                              population_mean=mean_real)","bfda956e":"margin_error_real = helpers.moe_t_test_1sample(alpha=0.05, \n                                         sample_size=df['adjusted_close'].shape[0], \n                                         stdev=df['adjusted_close'].std())","eb3a0dd4":"lower_bound_real, upper_bound_real = helpers.confidence_interval(mean=df['adjusted_close'].mean(), \n                                                                 margin_of_error=margin_error_real)\nprint('Lower bound for real:', lower_bound_real)\nprint('Upper bound for real:', upper_bound_real)","5599ec6e":"margin_error_simulation = helpers.moe_t_test_1sample(0.05, \n                                               sample_size=simulation_means.shape[0], \n                                               stdev=simulation_means.std())","6395c883":"lower_bound_simulation, upper_bound_simulation = helpers.confidence_interval(\n                                                    mean=simulation_means.mean(), \n                                                    margin_of_error=margin_error_simulation)\nprint('Lower bound for simulation:', lower_bound_simulation)\nprint('Upper bound for simulation:', upper_bound_simulation)","7d39d000":"b_statistic, p_value = helpers.bartlett(0.05, simulation_means, df['adjusted_close'])","6e6ad580":"ks_statistic, p_value = helpers.ks_test_2sample(0.05, simulation_means, df['adjusted_close'])","b7d4f15c":"## Data Processing","8b6c7f30":"## Bartlett Test for Variance","a4629904":"## Confidence Interval for Mean","3aa3bfff":"----","d236b688":"## Run Simulation","643e5d9e":"## KS Test for Distribution","5a7f4320":"## Data Fetching","8aaf350e":"## T Test for Mean"}}