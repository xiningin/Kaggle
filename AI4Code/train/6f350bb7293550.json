{"cell_type":{"aefda893":"code","b0d1d82e":"code","13673d6e":"code","6f552110":"code","31e3746e":"code","eb7686a2":"code","3bb4abc0":"code","056bf55a":"code","e595eca5":"code","4c11033a":"code","317d5862":"code","94e75548":"code","665d22c4":"code","886e1209":"code","34434db0":"code","1614bab0":"code","2517349a":"code","8ac4d162":"code","57958df8":"code","b719e1b5":"code","81320f99":"markdown","0893066a":"markdown","b1fb536b":"markdown","7eb70de2":"markdown","eb2c1e4d":"markdown","33cb10f4":"markdown","5e88db14":"markdown","528a4592":"markdown","8c597019":"markdown","64dfe637":"markdown","1ed1e02c":"markdown","063fd647":"markdown","942956f8":"markdown","8b52751b":"markdown","4abe18a2":"markdown","59ede062":"markdown","d9d32578":"markdown","7be161b4":"markdown"},"source":{"aefda893":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import normalize\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import classification_report, confusion_matrix, accuracy_score","b0d1d82e":"df=pd.read_csv('..\/input\/logistic-regression-heart-disease-prediction\/framingham_heart_disease.csv')","13673d6e":"df.head(50)","6f552110":"df[:].describe()","31e3746e":"features_nan=[feature for feature in df.columns if df[feature].isnull().sum()>1]\nfor feature in features_nan:\n    print(\"{}: {}% missing values\".format(feature,np.round(df[feature].isnull().mean(),4)))","eb7686a2":"series = pd.isnull(df['cigsPerDay'])\ndf[series]","3bb4abc0":"data = df.drop(['education'], axis = 1)\ndata.head()","056bf55a":"mean_cigsPerDay = round(data[\"cigsPerDay\"].mean())\nmean_BPmeds = round(data[\"BPMeds\"].mean())\nmean_totChol = round(data[\"totChol\"].mean())\nmean_BMI = round(data[\"BMI\"].mean())\nmean_glucose = round(data[\"glucose\"].mean())\nmean_heartRate = round(data[\"heartRate\"].mean())","e595eca5":"data['cigsPerDay'].fillna(mean_cigsPerDay, inplace = True)\ndata['BPMeds'].fillna(mean_BPmeds, inplace = True)\ndata['totChol'].fillna(mean_totChol, inplace = True)\ndata['BMI'].fillna(mean_BMI, inplace = True)\ndata['glucose'].fillna(mean_glucose, inplace = True)\ndata['heartRate'].fillna(mean_heartRate, inplace = True)\n","4c11033a":"features_nan=[feature for feature in data.columns if data[feature].isnull().sum()>1]\nfor feature in features_nan:\n    print(\"{}: {}% missing values\".format(feature,np.round(data[feature].isnull().mean(),4)))","317d5862":"data[:].isnull().sum()","94e75548":"data.groupby('TenYearCHD').mean()","665d22c4":"sns.pairplot(data[[\"age\",\"cigsPerDay\",\"totChol\",\"sysBP\",\"diaBP\",\"BMI\",\"heartRate\",\"glucose\"]])","886e1209":"cols_to_be_normalized = [\"age\",\"cigsPerDay\",\"totChol\",\"sysBP\",\"diaBP\",\"BMI\",\"heartRate\",\"glucose\"]\ncols_not_to_be_normalized = [\"male\",\"currentSmoker\",\"BPMeds\",\"prevalentStroke\",\"prevalentHyp\",\"diabetes\",\"TenYearCHD\"]\n\nnormalized = normalize(data[cols_to_be_normalized])\nboolean = data[cols_not_to_be_normalized]","34434db0":"df_normalized = pd.DataFrame(normalized,columns = cols_to_be_normalized)\ndf_boolean = pd.DataFrame(boolean,columns=cols_not_to_be_normalized)\n# df_final = pd.concat([df_normalized,df_boolean],axis = 1)\n# df_final = df_normalized.join(df_boolean)\ndf_final = df_normalized.merge(df_boolean,left_index=True, right_index=True)","1614bab0":"X = df_final.drop(\"TenYearCHD\",axis = 1)\nY = df_final[\"TenYearCHD\"] \nX = np.array(X)\nY = np.array(Y)","2517349a":" X_train,X_test,y_train,y_test = train_test_split(X,Y,random_state = 1,test_size = 0.2)","8ac4d162":"classifier = LogisticRegression(random_state = 0) \nclassifier.fit(X_train, y_train)","57958df8":"y_pred = classifier.predict(X_test)","b719e1b5":"print (\"Accuracy : \", accuracy_score(y_test, y_pred)) \nprint (classification_report(y_test, y_pred)) ","81320f99":"### Statistical inferences","0893066a":"### Evaluating trained models","b1fb536b":"### Pictorial Analysis","7eb70de2":"### Initializing Logistic Regression Model","eb2c1e4d":"## Thank you\nHope you find this notebook useful. Do support guys ","33cb10f4":"### Analysing Missing Values","5e88db14":"### As Education does not play a factor in Heart Attack, I have dropped that column\n","528a4592":"### Prediction with trained model","8c597019":"### Train Test Split","64dfe637":"### Segregation of Dependent & Independent Variables","1ed1e02c":"### The advantage of below table shown is that the 'currentSmoker' column has value of 1 for all 'cigsPerDay' null values. \n### This helps in conveying that all missing values of cigsPerDay would not be zero.\n","063fd647":"### Filling NAN values with their respective column mean values","942956f8":"### Normalization","8b52751b":"### Importing Data","4abe18a2":"# <center><font color = \"red\">Heart Attack Prediction<\/font><\/center>","59ede062":"### Some Key Takeaways\n1. Most of the Male has 10-year risk of developing coronary heart disease.\n2. Most of the people having mean of age group 54.25 have high risk for developing coronary heart disease\n3. Current Smoker have high high risk for developing coronary heart disease than non smokers\n4. CigsPerDay, BPMeds, prevalentStroke, prevalentHyp are directly proportional with developing the risk for CHR","d9d32578":"### Importing Required Modules","7be161b4":"## Hurray !! we made it.. All NAN values are fixed\n<img src = \"https:\/\/qph.fs.quoracdn.net\/main-qimg-52aaf39089c8b28eb87fcd8e59d5d24e\">"}}