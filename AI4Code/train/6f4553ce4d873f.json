{"cell_type":{"cfd1302a":"code","f65771af":"code","b5217d4c":"code","bfef9ac5":"code","8dbd1e1d":"code","1fa483ec":"code","1240882e":"code","24f585b0":"code","a3f37d86":"code","64c4f641":"code","21f76763":"code","29bd74ff":"code","bc5445c7":"code","d3ac526a":"code","4127247d":"code","c040542c":"code","a56f427f":"code","3a656d77":"code","6d06fd69":"code","b70600c2":"code","d42f1433":"code","86769679":"code","0f07a442":"code","1a7229f8":"code","9920a437":"code","3f6688ac":"code","5dd4edd4":"code","9e65f5db":"code","2e41723d":"code","eb81378b":"code","3c316e65":"code","16b19759":"code","7fd38119":"code","9e11abaf":"code","59029a14":"code","0a09a3a2":"code","ed816cf9":"code","6bf6dc82":"code","cfb49c81":"code","1b2e84d0":"code","5b1ef7b7":"code","a86ef0c0":"code","3f4af34a":"code","a841207f":"code","f34015c1":"code","c606d713":"markdown","fa2a08e8":"markdown","2dfddb30":"markdown","e192de8f":"markdown","ce23884f":"markdown","11356b0c":"markdown","27b0d35f":"markdown","9a3590ba":"markdown"},"source":{"cfd1302a":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","f65771af":"import pandas as pd","b5217d4c":"df=pd.read_csv(\"\/kaggle\/input\/health-insurance-cross-sell-prediction\/train.csv\")","bfef9ac5":"df.shape","8dbd1e1d":"df.head()","1fa483ec":"df.isnull().mean()","1240882e":"df.describe()","24f585b0":"df.info()","a3f37d86":"df.head()","64c4f641":"import matplotlib.pyplot as plt\nimport seaborn as sns","21f76763":"#checking no of male & female\nsns.countplot(df[\"Gender\"])","29bd74ff":"#checking the distribution of age column\nsns.distplot(df[\"Age\"])","bc5445c7":"#checking people with driving license and non driving license\nsns.countplot(df['Driving_License'])","d3ac526a":"df[\"Driving_License\"].value_counts()","4127247d":"#checking differnt varities of Region Code\nplt.figure(figsize=(18,6))\nsns.countplot(df[\"Region_Code\"])\nplt.xticks(rotation=90)","c040542c":"#checking the distribution of Annual_Premium column\nsns.distplot(df[\"Annual_Premium\"],color=\"pink\")","a56f427f":"#checking differnt policy channels Policy_Sales_Channel\nsns.countplot(df[\"Policy_Sales_Channel\"])","3a656d77":"#checking the distribution of vintage column\nsns.distplot(df[\"Vintage\"],color=\"yellow\")","6d06fd69":"#checking ages of the veichles of the customers\nsns.countplot(df[\"Vehicle_Age\"])","b70600c2":"#checking our target variable column\nsns.countplot(df[\"Response\"])","d42f1433":"df[\"Response\"].value_counts()","86769679":"df.head()","0f07a442":"#from our intutive knowledge we can say that people who don't have a driving license ,it is very unlikely for them that \n#they will take a vehicle insurance.So we will drop those people records who don't have a driving license.\nimport numpy as np\ndf[\"Driving_License\"]=np.where(df[\"Driving_License\"]==0,np.nan,1)","1a7229f8":"df.dropna(axis=0,inplace=True)","9920a437":"df.shape","3f6688ac":"#In our current dataset,we have people with only driving license so we don't need this column.\ndf.drop([\"Driving_License\"],axis=1,inplace=True)","5dd4edd4":"df.head()","9e65f5db":"df[\"Vehicle_Age\"].unique()","2e41723d":"x={'> 2 Years':3,'1-2 Year':2,'< 1 Year':1}","eb81378b":"df[\"Vehicle_Age\"]=df[\"Vehicle_Age\"].map(x)","3c316e65":"df.head()","16b19759":"df=pd.get_dummies(df,drop_first=True)","7fd38119":"df.head()","9e11abaf":"X=df.drop([\"Response\"],axis=1)\ny=df[\"Response\"]","59029a14":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=0)","0a09a3a2":"from sklearn.ensemble import RandomForestClassifier\nmod=RandomForestClassifier()\nmod.fit(X_train,y_train)","ed816cf9":"y_pred=mod.predict(X_test)","6bf6dc82":"from sklearn.metrics import confusion_matrix,classification_report,accuracy_score\nprint(confusion_matrix(y_test,y_pred))\nprint(classification_report(y_test,y_pred))\nprint(accuracy_score(y_test,y_pred))","cfb49c81":"#we will try to improve our True Positive score","1b2e84d0":"from imblearn.over_sampling import RandomOverSampler\nfrom collections import Counter","5b1ef7b7":"os=RandomOverSampler(0.85)\nX_train_os,y_train_os=os.fit_sample(X_train,y_train)\nprint(f\"The no of samples before fit count{Counter(y_train)}\")\nprint(f\"The no of samples after fit count{Counter(y_train_os)}\")","a86ef0c0":"mod1=RandomForestClassifier()\nmod1.fit(X_train_os,y_train_os)","3f4af34a":"y_pred_os=mod1.predict(X_test)","a841207f":"from sklearn.metrics import confusion_matrix,classification_report,accuracy_score\nprint(confusion_matrix(y_test,y_pred_os))\nprint(classification_report(y_test,y_pred_os))\nprint(accuracy_score(y_test,y_pred_os))","f34015c1":"#though our accuracy has decreased,yet we can see increase in the values of true positive.","c606d713":"#### DATA EXPLORATION","fa2a08e8":"So much Data , but no missing values !!! Good Days ahead ..","2dfddb30":"# KINDLY UPVOTE IF YOU FEEL BENEFITED","e192de8f":"We have successfully removed people without driving license.","ce23884f":"#### MODEL BUILDING","11356b0c":"#### FEATURE ENGG","27b0d35f":"<img src=\"https:\/\/media1.tenor.com\/images\/e015248e85c4a36940f0063d962d9b14\/tenor.gif?itemid=11568963\">","9a3590ba":"#### DATA COLLECTION"}}