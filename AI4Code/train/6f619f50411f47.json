{"cell_type":{"70d1b7e6":"code","e3d755e4":"code","57da62cc":"code","47fbffab":"code","91ebf806":"code","aa1e3979":"code","3d832ae7":"code","f2c32ab7":"code","58e9a3b6":"code","dfd3d790":"code","bf78a338":"code","15dc80fc":"code","c9b6b116":"code","7710ccd7":"code","0cf1b442":"code","87df5640":"code","0e282c00":"code","07d32057":"code","edc956ca":"code","6c29d4f1":"code","cdb222df":"code","c56a0d5d":"code","0b847ccb":"code","94d63d47":"code","b4574d43":"code","69d152d2":"code","2990fed9":"code","8d2b31e5":"code","30c4fed8":"code","4968f050":"code","78041a09":"code","bec69d67":"code","121b7e84":"code","436d2a98":"code","f88f8517":"code","75b5eaf3":"markdown","07c8fbb7":"markdown","98ca18d2":"markdown","b0ace402":"markdown","5ab67a10":"markdown","287fafe7":"markdown","f4ac8ed3":"markdown","88d02c16":"markdown","a3b06088":"markdown","df6c9506":"markdown","a38d70e0":"markdown","8e76fbb7":"markdown","c5aa936f":"markdown","fcca12bf":"markdown","5d107450":"markdown","382ae833":"markdown","4c3d756c":"markdown","6b8a24a0":"markdown","fff25248":"markdown","b6ead4ec":"markdown","3f248abf":"markdown","f56fafef":"markdown","d4abf9e1":"markdown","bd381697":"markdown","fb3083f1":"markdown","f7e965ee":"markdown","2d3bf185":"markdown","cbcb8ac9":"markdown","e6332a17":"markdown","f4fe1f67":"markdown"},"source":{"70d1b7e6":"pip install lucifer-ml","e3d755e4":"import matplotlib.pyplot as plt\nimport matplotlib.pyplot as plt\nplt.style.use('fivethirtyeight')\nplt.style.use('dark_background')\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nfrom matplotlib.colors import ListedColormap\nfrom collections import Counter\nfrom scipy import stats\nfrom tqdm import tqdm_notebook\n\n## Importing LuciferML\nfrom luciferml.supervised.classification import Classification\nfrom luciferml.preprocessing import Preprocess as prep\n\nimport warnings\nwarnings.simplefilter(action='ignore', category=Warning)","57da62cc":"dataset = pd.read_csv('..\/input\/health-insurance-cross-sell-prediction\/train.csv')","47fbffab":"dataset.head()","91ebf806":"dataset.shape","aa1e3979":"dataset.describe().T.style.bar(\n    subset=['mean'],\n    color='#606ff2').background_gradient(\n    subset=['std'], cmap='PuBu').background_gradient(subset=['50%'], cmap='PuBu')","3d832ae7":"dataset.info()","f2c32ab7":"dataset.isnull().values.any()","58e9a3b6":"plt.figure(figsize=(12, 6))\nsns.countplot(x=\"Response\", data=dataset, palette='husl');","dfd3d790":"categorical_cols =['Gender','Vehicle_Damage']","bf78a338":"quant_cols = [ 'Age', 'Region_Code',\n        \n       'Policy_Sales_Channel', 'Vintage']\n","15dc80fc":"def boxPlotter(dataset, columnName):\n    \"\"\"\n    Plots boxplots for column given as parameter.\n    \"\"\"\n    sns.catplot(x=\"Response\", y=columnName, data=dataset, kind=\"box\");\nfor column in tqdm_notebook(quant_cols, desc = \"Your Charts are being ready\"):\n    boxPlotter(dataset, column)","c9b6b116":"def pieChartPlotter(dataset, columnName):\n    \"\"\"\n    Creates pie chart of the column given as parameter in the dataset\n    \"\"\"\n    values = dataset[columnName].value_counts()\n    labels = dataset[columnName].unique()\n    pie, ax = plt.subplots(figsize=[10, 6])\n\n    patches, texts, autotexts = ax.pie(values, labels=labels, autopct='%1.2f%%', shadow=True, pctdistance=.5\n                                       )\n\n    plt.legend(patches, labels, loc=\"best\")\n    plt.title(columnName, color='white', fontsize=14)\n    plt.setp(texts, color='white', fontsize=20)\n    plt.setp(autotexts, size=10, color='black')\n    autotexts[1].set_color('black')\n    plt.axis('equal')\n    plt.tight_layout()\n    plt.show()","7710ccd7":"for column in categorical_cols:\n    pieChartPlotter(dataset, column) ","0cf1b442":"corr_data = dataset.drop(['id'],axis = 1)","87df5640":"plt.figure(figsize=(20, 17))\nmatrix = np.triu(corr_data.corr())\nsns.heatmap(corr_data.corr(), annot=True,linewidth=.8, mask=matrix, cmap=\"rocket\");","0e282c00":"def distributionPlot(dataset):\n    \"\"\" \n    Creates distribution plot.\n    \"\"\"\n    fig = plt.figure(figsize=(20, 20))\n    for i in tqdm_notebook(range(0, len(dataset.columns)), desc = 'Your plots are being ready'):\n        fig.add_subplot(np.ceil(len(dataset.columns)\/3), 3, i+1)\n        sns.distplot(\n            dataset.iloc[:, i], color=\"lightcoral\", rug=True)\n        fig.tight_layout(pad=3.0)","07d32057":"plot_data = dataset.drop(['id', 'Response','Gender', 'Vehicle_Damage', 'Vehicle_Age', 'Driving_License', 'Region_Code','Policy_Sales_Channel','Previously_Insured' ], axis =1)","edc956ca":"distributionPlot(plot_data)","6c29d4f1":"pp_plot_data = dataset.drop(['id','Gender', 'Vehicle_Damage', 'Vehicle_Age', 'Driving_License', 'Region_Code','Policy_Sales_Channel','Previously_Insured' ], axis =1)","cdb222df":"sns.pairplot(pp_plot_data, hue=\"Response\", palette=\"husl\");","c56a0d5d":"dataset = prep.skewcorrect(dataset,except_columns=['id', 'Response'])","0b847ccb":"dataset = dataset.drop('Vehicle_Age', axis =1)\nfeatures = dataset.iloc[:, 1:-1]\nlabels = dataset.iloc[:, -1]","94d63d47":"features , labels","b4574d43":"features.shape, labels.shape","69d152d2":"accuracy_scores = {}","2990fed9":"params = {'C': 0.0001, 'penalty': 'l1', 'solver': 'liblinear'}\nclassifier =  Classification(predictor = 'lr',params=params, lda = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']","8d2b31e5":"params = {'algorithm': 'kd_tree', 'n_jobs': 1, 'n_neighbors': 5, 'weights': 'uniform'}\nclassifier =  Classification(predictor = 'knn',params=params, lda = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']","30c4fed8":"params = {'criterion': 'entropy', 'max_depth': 30, 'max_features': 'sqrt', 'splitter': 'best', 'random_state': 42}\nclassifier =  Classification(predictor = 'dt',params=params, lda = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']","4968f050":"classifier =  Classification(predictor = 'nb', lda = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']","78041a09":"params = {'criterion': 'gini', 'max_features': 'auto', 'n_estimators': 150,'random_state':0}\nclassifier =  Classification(predictor = 'rfc',params=params, lda = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']","bec69d67":"params = {'learning_rate':0.02, 'n_estimators':600, 'objective':'binary:logistic', 'eval_metric':'logloss', 'nthread':-1}\nclassifier =  Classification(predictor = 'xgb',params=params, lda = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']","121b7e84":"classifier =  Classification(predictor = 'ann', lda = 'y',batch_size = 25, input_units = 15)\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']","436d2a98":"maxKey = max(accuracy_scores, key=lambda x: accuracy_scores[x])\nprint('The model with highest K-Fold Validation Accuracy score is  {0} with an accuracy of  {1:.2f}'.format(\n    maxKey, accuracy_scores[maxKey]))","f88f8517":"plt.figure(figsize=(12, 6))\nmodel_accuracies = list(accuracy_scores.values())\nmodel_names = list(accuracy_scores.keys())\nsns.barplot(x=model_accuracies, y=model_names, palette='mako');","75b5eaf3":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Skewness Correction<\/h2>\n<\/div>","07c8fbb7":"\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;font-weight: bold\"> Importing Dataset <\/h1>\n<\/div>\n","98ca18d2":"![facts](https:\/\/i.pinimg.com\/originals\/c2\/fc\/44\/c2fc441ff047a90a5e8052b794888de5.jpg)\n\n\n#### [Image Source](https:\/\/i.pinimg.com\/originals\/c2\/fc\/44\/c2fc441ff047a90a5e8052b794888de5.jpg)","b0ace402":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Pie Chart<\/h2>\n<\/div>\n\n","5ab67a10":"![](https:\/\/previews.123rf.com\/images\/bearsky23\/bearsky231808\/bearsky23180800221\/107269561-insurance-web-header-banner-that-covers-homeowners-medical-life-vehicle-insurance.jpg)\n#### [Image Source](https:\/\/previews.123rf.com\/images\/bearsky23\/bearsky231808\/bearsky23180800221\/107269561-insurance-web-header-banner-that-covers-homeowners-medical-life-vehicle-insurance.jpg)","287fafe7":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Summary<\/h1>\n<h2 style=\"text-align:center;\">Artificial Neural Network performed best.<\/h2>\n<\/div>\n","f4ac8ed3":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;font-weight: bold\"> Introduction <\/h1><\/div>\n\n","88d02c16":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Training Random Forest<\/h2>\n<\/div>\n\n\n","a3b06088":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Correlation Plot<\/h2>\n<\/div>","df6c9506":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;font-weight: bold\"> Importing Libraries <\/h1>\n<\/div>\n","a38d70e0":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Finding which model performed better<\/h1>\n<\/div>\n","8e76fbb7":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Splitting Columns into Categorical and Quantitative Data<\/h2>\n<\/div>\n","c5aa936f":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Some Distribution Plots<\/h2>\n<\/div>\n","fcca12bf":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<p style=\"text-align:center;\"> It's important to have health insurance as a safety net. If you unexpectedly get sick or injured, health insurance is there to help cover costs that you likely can't afford to pay on your own. Health care can be very expensive. It can be an enormous financial burden. <\/p>\n<\/div>\n\n","5d107450":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Note: The functions used here are created by me. If you use them don't forget to give credit to me. I have spent alot of time building them.<\/h1>\n<\/div>\n","382ae833":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Training K-Nearest Neighnours<\/h2>\n<\/div>\n\n\n\n\n","4c3d756c":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Training ANN<\/h2>\n<\/div>\n\n","6b8a24a0":"\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;font-weight: bold\"> Exploratory Data Analysis <\/h1>\n<\/div>\n","fff25248":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Training Gausian naive Bayes<\/h2>\n<\/div>\n\n","b6ead4ec":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Model training<\/h1>\n<\/div>\n\n\n","3f248abf":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Training Logistic Regression<\/h2>\n<\/div>\n\n\n\n","f56fafef":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Please give feedback by commenting below and If you liked my work please consider upvoting<\/h1>\n<\/div>\n","d4abf9e1":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Some Box Plots<\/h2>\n<\/div>\n","bd381697":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h4 style=\"text-align:left;\">From above charts we can confirm<\/h4>\n<p style=\"text-align:left;\">1) There seems to be significant  correlation between all the features.\n    <br>\n2) Some columns are skewed. So, lets correct it<\/p>\n<\/div>\n","fb3083f1":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Countplot for Response<\/h2>\n<\/div>\n","f7e965ee":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;font-weight:bold\">Data Preprocessing<\/h1>\n<\/div>\n\n","2d3bf185":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Preparing Features and labels <\/h2>\n<\/div>\n\n","cbcb8ac9":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Pairplots<\/h2>\n<\/div>\n\n","e6332a17":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Training XGBoost Classifier<\/h2>\n<\/div>\n\n","f4fe1f67":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Training Decision Trees<\/h2>\n<\/div>\n\n"}}