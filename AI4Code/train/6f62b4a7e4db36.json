{"cell_type":{"50a53dd1":"code","5d81777b":"code","8db36a8c":"code","02022173":"code","ee779a98":"code","394cd565":"code","df5b3304":"code","efdbede5":"code","1f33b8b9":"code","36fc00d5":"code","495ad65d":"code","8b043aa1":"code","c716936c":"code","47e6b923":"code","6f714df3":"code","95224fe7":"code","53feb56a":"code","6fb40870":"code","64c27bdf":"code","9ed6410a":"code","5baeab76":"code","b2868b3e":"code","c7dc5852":"code","b3933f50":"code","264c2002":"code","7ec4ab8e":"code","e2e49eb8":"code","90e553ad":"code","83e5f863":"code","669ac41d":"code","4c9db0c2":"code","31772f7b":"code","47009d2e":"code","69b26fd8":"code","8f16911e":"code","a860aa9d":"code","219d9c77":"code","2ebb766b":"code","6a6d18de":"code","34ecb8aa":"code","93add33c":"code","f8d91c1e":"markdown","df9ab721":"markdown","49f04aa7":"markdown","3773226f":"markdown","504eba0d":"markdown","3c19759d":"markdown","d4fdc3ac":"markdown","92b7cd34":"markdown","3a0c365c":"markdown","12484bca":"markdown","76ce42d7":"markdown","a50f0b20":"markdown","a697ea8b":"markdown","9faaba54":"markdown","54b345eb":"markdown","de7e295f":"markdown","c9819c4d":"markdown","34023beb":"markdown","06c74b32":"markdown","7781a550":"markdown","9d3a665d":"markdown","46ee90a3":"markdown","184afd0f":"markdown","d8e3d241":"markdown","4a578ad5":"markdown","0cb6fccc":"markdown","c40d282b":"markdown","2e2a00ba":"markdown","36754df2":"markdown","d48ed03c":"markdown","1cd5ee72":"markdown","a3e147f0":"markdown","b3cbe48a":"markdown","e1281fd5":"markdown","bc6f34d4":"markdown","5e2df69f":"markdown","166f57e1":"markdown","db451c55":"markdown","4f5301e9":"markdown","5def7cea":"markdown","262eca6f":"markdown","3b8db1b3":"markdown","bd832725":"markdown","11029078":"markdown"},"source":{"50a53dd1":"import os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport pandas_datareader\nimport datetime\nimport pandas_datareader.data as web","5d81777b":"#start = datetime.datetime(2015, 1, 1)\n#end = datetime.datetime(2020, 1, 1)","8db36a8c":"#The Yahoo API is restricted for some reason from the Kaggle Cloud platform so we are using the Kaggle Cloud dataset \n#apple = web.DataReader(\"AAPL\", 'yahoo',start, end)\n#amazon = web.DataReader(\"AMZN\", 'yahoo', start, end)\n#google = web.DataReader(\"GOOGL\", 'yahoo', start, end)","02022173":"apple = pd.read_csv('..\/input\/stock-time-series-20050101-to-20171231\/AAPL_2006-01-01_to_2018-01-01.csv', index_col='Date', parse_dates=['Date'])\ngoogle = pd.read_csv('..\/input\/stock-time-series-20050101-to-20171231\/GOOGL_2006-01-01_to_2018-01-01.csv', index_col='Date', parse_dates=['Date'])\namazon = pd.read_csv('..\/input\/stock-time-series-20050101-to-20171231\/AMZN_2006-01-01_to_2018-01-01.csv', index_col='Date', parse_dates=['Date'])","ee779a98":"apple.tail()","394cd565":"amazon.tail()","df5b3304":"google.head()","efdbede5":"apple['Open'].plot(label='Apple',figsize=(16,8),title='Open Price')\namazon['Open'].plot(label='Amazon')\ngoogle['Open'].plot(label='Google')\nplt.legend();","1f33b8b9":"apple['Volume'].plot(label='Apple',figsize=(16,8),title='Volume Traded')\namazon['Volume'].plot(label='Amazon')\ngoogle['Volume'].plot(label='Google')\nplt.legend();","36fc00d5":"apple['Volume'].max()","495ad65d":"apple['Volume'].argmax()","8b043aa1":"apple['Total Traded'] = apple['Open']*apple['Volume']\namazon['Total Traded'] = amazon['Open']*amazon['Volume']\ngoogle['Total Traded'] = google['Open']*google['Volume']","c716936c":"apple['Total Traded'].plot(label='Apple',figsize=(16,8))\namazon['Total Traded'].plot(label='Amazon')\ngoogle['Total Traded'].plot(label='Google')\nplt.legend()\nplt.ylabel('Total Traded')","47e6b923":"amazon['Total Traded'].argmax()","6f714df3":"amazon['MA50'] = amazon['Open'].rolling(50).mean()\namazon['MA200'] = amazon['Open'].rolling(200).mean()\namazon[['Open','MA50','MA200']].plot(label='gm',figsize=(16,8));","95224fe7":"from pandas.plotting import scatter_matrix","53feb56a":"tech_comp = pd.concat([apple['Open'],amazon['Open'],google['Open']],axis=1)","6fb40870":"tech_comp.columns = ['Apple Open','Amazon Open','Google Open']","64c27bdf":"scatter_matrix(tech_comp,figsize=(8,8),alpha=0.2,hist_kwds={'bins':50});","9ed6410a":"apple['returns'] = (apple['Close'] \/ apple['Close'].shift(1) ) - 1","5baeab76":"apple.head()","b2868b3e":"amazon['returns'] = (amazon['Close'] \/ amazon['Close'].shift(1) ) - 1","c7dc5852":"amazon.head()","b3933f50":"# Now repeat for the other dataframes\namazon['returns'] = amazon['Close'].pct_change(1)\ngoogle['returns'] = google['Close'].pct_change(1)","264c2002":"google.head()","7ec4ab8e":"amazon = amazon.drop(['MA50', 'MA200'], axis=1)\namazon.head()","e2e49eb8":"apple['returns'].hist(bins=50);","90e553ad":"amazon['returns'].hist(bins=50);","83e5f863":"google['returns'].hist(bins=50);","669ac41d":"apple['returns'].hist(bins=100,label='Apple',figsize=(10,8),alpha=0.5)\namazon['returns'].hist(bins=100,label='Amazon',alpha=0.5)\ngoogle['returns'].hist(bins=100,label='Google',alpha=0.5)\nplt.legend();","4c9db0c2":"apple['returns'].plot(kind='kde',label='Apple',figsize=(12,6))\namazon['returns'].plot(kind='kde',label='Amazon')\ngoogle['returns'].plot(kind='kde',label='Google')\nplt.legend();","31772f7b":"box_df = pd.concat([apple['returns'],amazon['returns'],google['returns']],axis=1)\nbox_df.columns = ['Apple Returns','Amazon Returns','Google Returns']\nbox_df.plot(kind='box',figsize=(8,11),colormap='jet');","47009d2e":"scatter_matrix(box_df,figsize=(8,8),alpha=0.2,hist_kwds={'bins':50});","69b26fd8":"box_df.plot(kind='scatter',x='Amazon Returns',y='Google Returns',alpha=0.4,figsize=(10,8));","8f16911e":"box_df.plot(kind='scatter',x='Apple Returns',y='Google Returns',alpha=0.4,figsize=(10,8));","a860aa9d":"apple['Cumulative Return'] = (1 + apple['returns']).cumprod()","219d9c77":"apple.head()","2ebb766b":"amazon['Cumulative Return'] = (1 + amazon['returns']).cumprod()\namazon.head()","6a6d18de":"google['Cumulative Return'] = (1 + google['returns']).cumprod()\ngoogle.head()","34ecb8aa":"apple['Cumulative Return'].plot(label='Apple',figsize=(16,8),title='Cumulative Return')\namazon['Cumulative Return'].plot(label='Amazon')\ngoogle['Cumulative Return'].plot(label='Google')\nplt.legend();","93add33c":"amazon['Cumulative Return'].plot(label='Amazon')\napple['Cumulative Return'].plot(label='Apple')\nplt.legend();","f8d91c1e":"#### https:\/\/ww.9to5mac.com\/2017\/10\/27\/apple-says-demand-for-iphone-x-is-off-the-charts-as-device-sells-out-around-the-world\/#aprd","df9ab721":"### We analyze date of three leading tech companies Apple, Google, and Amazon using DJIA 30 Stock Time Series Data set from Kaggle. First, we intialize the python module\/library required for analysis given they are locally installed in our computer or in the Kaggle Cloud OS. \n\nPlease free to fork the kernel, edit, and add to it. Would appreciate if you leave comments and upvote","49f04aa7":"Now with the KDE diagram we can see that Amazon is more volatile compared to Apple and Google because of the range of percentage change. ","3773226f":"### Part 4: Using the Scatter Plot Matrix, we check if there are any correlation between the stocks open price of Apple, Amazon, and Google\n### https:\/\/pandas.pydata.org\/pandas-docs\/stable\/visualization.html#scatter-matrix-plot ","504eba0d":"### Part 5: Basic Financial Analysis","3c19759d":"Lets us say there is a stock 'ABC' that is being actively traded on an exchange. ABC has the following prices corresponding to the dates given","d4fdc3ac":"$ r_t = \\frac{p_t}{p_{t-1}} -1$","92b7cd34":"### Part 7: Cumulative Daily Returns\nWith daily cumulative returns, the question we are trying to answer is the following, if I invested $1 in the company at the beginning of the time series, how much would is be worth today? This is different than just the stock price at the current day, because it will take into account the daily returns. Keep in mind, our simple calculation here won't take into account stocks that give back a dividend. Let's look at some simple examples:","3a0c365c":"![](https:\/\/media.giphy.com\/media\/26n79t82lmj989iAE\/giphy.gif)","12484bca":"    Date                        Price\n    01\/01\/2018                   10\n    01\/02\/2018                   15\n    01\/03\/2018                   20\n    01\/04\/2018                   25","76ce42d7":"#### Now we draw box plots comparing the returns","a50f0b20":"![](https:\/\/media.giphy.com\/media\/bfrlODgSLqXxS\/giphy.gif)","a697ea8b":"1. #### What happened to apple that day, here's some news!!\n#### https:\/\/macdailynews.com\/2008\/01\/23\/apple_reports_best_quarterly_revenue_and_earnings_in_company_history_street\n","9faaba54":"#### When volume was traded the highest? ","54b345eb":"** Plot the Volume of stock traded each day.**","de7e295f":"### Part 1: Importing Data","c9819c4d":"#### Use these kernel for your analysis. Continue working on where I left off. Make sure to leave a suggestion and upvote. Thank you","34023beb":"It looks like Amazon, Apple and Google do have some sort of possible relationship, let's plot just these two against eachother in scatter plot to view this more closely!","06c74b32":"First, create a new column for each dataframe called returns. This column will be calculated from the Close price column. There are two ways to do this, either a simple calculation using the .shift() method that follows the formula above, or you can also use pandas' built in pct_change method. ","7781a550":"![](https:\/\/media.giphy.com\/media\/xTiTnoUnHxVaaVNWhO\/giphy.gif)","9d3a665d":"**Cumulative Return**: While daily returns are useful, it doesn't give the investor a immediate insight into the gains he had made till date, especially if the stock is very volatile. Cumulative return is computed relative to the day investment is made.  If cumulative return is above one, you are making profits else you are in loss. So for the above example cumulative gains are as follows","46ee90a3":"    Date                         Daily Return                  %Daily Return\n    01\/01\/2018                 10\/10 =  1                          -   \n    01\/02\/2018                 15\/10 =  3\/2                       50%\n    01\/03\/2018                 20\/15 =  4\/3                       33%\n    01\/04\/2018                 25\/20 =  5\/4                       20%","184afd0f":"** Plot this \"Total Traded\" against the time index.**","d8e3d241":"** Now plot a histogram of each companies returns. Either do them separately, or stack them on top of each other. Which stock is the most \"volatile\"? (as judged by the variance in the daily returns we will discuss volatility in a lot more detail in future lectures.)**","4a578ad5":"* When we lay all the histogram plot of percentage return of Apple, Amazon, and Google; we notice the volatility of the percentage return is more or less the same between -0.1 to 0.1+. ","0cb6fccc":"### Part 6: Comparing Daily Returns between Stocks\n\nNow we Create a scatter matrix plot to see the correlation between each of the stocks daily returns. This helps answer the questions of how related the car companies are.","c40d282b":"* Amazon Open Price, Google Open Price, and Apple Open Price all more or less seem to follow y=mx; and it can be seen there's a correlation\n* Amazon Open Price and Google Open Price seems more correlated","2e2a00ba":"This defines r_t (return at time t) as equal to the price at time t divided by the price at time t-1 (the previous day) minus 1. Basically this just informs you of your percent gain (or loss) if you bought the stock on day and then sold it the next day. While this isn't necessarily helpful for attempting to predict future values of the stock, its very helpful in analyzing the volatility of the stock. If daily returns have a wide distribution, the stock is more volatile from one day to the next. Let's calculate the percent returns and then plot them with a histogram, and decide which stock is the most stable!","36754df2":"## Stock Market Analysis ","d48ed03c":"#### Plot a KDE instead of histograms for another view point. Which stock has the widest plot? [](http:\/\/)","1cd5ee72":"Create a new column for each dataframe called \"Total Traded\" which is the Open Price multiplied by the Volume Traded.","a3e147f0":"### Part 3: Calculate Moving Average by 50 and 200 days for Amazon","b3cbe48a":"    Date                       Cumulative Return         %Cumulative Return\n    01\/01\/2018                  10\/10 =  1                         100 %   \n    01\/02\/2018                  15\/10 =  3\/2                       150 %\n    01\/03\/2018                  20\/10 =  2                         200 %\n    01\/04\/2018                  25\/10 =  5\/2                       250 %","e1281fd5":"The formula for a cumulative daily return is:\n\n$ i_i = (1+r_t) * i_{t-1} $\n\nHere we can see we are just multiplying our previous investment at i at t-1 by 1+our percent returns. Pandas makes this very simple to calculate with its cumprod() method. Using something in the following manner:\n\n    df[daily_cumulative_return] = ( 1 + df[pct_daily_return] ).cumprod()\n    ","bc6f34d4":"#### Daily Percentage Change","5e2df69f":"Create a cumulative daily return column for each car company's dataframe.","166f57e1":"The bloxplot now shows how the KDE diagram is so elongated for Amazon","db451c55":"#### What happened to Apple that day?","4f5301e9":"![](https:\/\/media.giphy.com\/media\/zWyv9xtsEfXQQ\/giphy.gif)","5def7cea":"### Part 2: Open Price Analysis","262eca6f":"#### Lets plot the Cumulative Return columns against the time series index. Which stock showed the highest return for a dollar invested? Which showed the lowest?","3b8db1b3":"**Daily Return** : Daily return is the profit\/loss made by the stock compared to the previous day. (This is what ew just calculated above). A value above one indicates profit, similarly a value below one indicates loss. It is also expressed in percentage to convey the information better. (When expressed as percentage, if the value is above 0, the stock had give you profit else loss). So for the above example the daily returns would be","bd832725":"#### Lets check when was total trade highest for Apple?","11029078":"Increaseing Cumulative Return for Amazon increased a lot compared to Apple and Google"}}