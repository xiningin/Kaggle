{"cell_type":{"8ec83c17":"code","9a0c8a50":"code","4d68192c":"code","156bec31":"code","3b712665":"code","1226d286":"code","0545bf26":"code","8eb8096f":"code","17c8b725":"markdown","d04d8fa2":"markdown","511a53af":"markdown","6f65aa38":"markdown","b096d818":"markdown","ef42aad8":"markdown","4d687cb2":"markdown","b16fe121":"markdown","c302e114":"markdown"},"source":{"8ec83c17":"import numpy as np\nimport pandas as pd\nfrom sklearn.model_selection import StratifiedKFold\nimport warnings\nwarnings.filterwarnings('ignore')","9a0c8a50":"df_train = pd.read_csv(\"..\/input\/song-popularity-prediction\/train.csv\")\n\ndf_train.head()","4d68192c":"df_train.song_popularity.value_counts(normalize =True)","156bec31":"df_train['kfold'] = -1","3b712665":"# Preparing data as a tabular matrix\ny_train = df_train.song_popularity\nX_train = df_train.drop('song_popularity', axis=1)","1226d286":"skf = StratifiedKFold(n_splits=5, shuffle=True, random_state=7)\nfor fold, (train_indicies, valid_indicies) in enumerate(skf.split(X_train,y_train )):\n    df_train.loc[valid_indicies, \"kfold\"] = fold\ndf_train.to_csv(\"song_popularity_S5Fold.csv\", index=False)","0545bf26":"df_train['kfold'].value_counts()","8eb8096f":"print(\"Ratio of song_popularity labels (whole dataset)\")\ndf_train.song_popularity.value_counts(normalize = True)\nprint()\nfor fold in range(5):\n    print(f\"Ratio of song_popularity labels (fold number: {fold})\")\n    display(df_train[df_train['kfold'] == fold]['song_popularity'].value_counts(normalize =True))\n    print()","17c8b725":"<div style=\"background:#2b6684   ;font-family:'Times';font-size:35px;color:  #F0CB8E\" >&ensp;Count of values in each row.<\/div>","d04d8fa2":"<div style=\"background:#2b6684   ;font-family:'Times';font-size:35px;color:  #F0CB8E\" >&ensp;What is Stratified K Fold ?<\/div>\n\n<div class=\"alert alert-warning\" role=\"alert\">\n<ul style=\"font-family:cursive;font-size:18px;color:  #A20404\">\n<li > The stratified k fold cross-validation is an extension of the cross-validation technique used for classification problems. <\/li>\n<li> It maintains the same class ratio throughout the K folds as the ratio in the original dataset.<\/li>\n<li>Here,we are dealing with Song Popularity prediction in which you have the class ratio of 63.6\/36.4 (shown in following code); by using <b>stratified K fold, the same class ratio is preserved throughout the K folds.<\/b> (our case 5 Folds)   <\/li>\n<li><a style=\"color:  blue\" href=\"https:\/\/www.kaggle.com\/c\/song-popularity-prediction\/discussion\/301737\" target=\"_blank\"> <u>Discussion about this topic: <\/u><\/a><\/li>\n<\/ul>\n<\/div>","511a53af":"<div style=\"background:#2b6684   ;font-family:'Times';font-size:35px;color:  #F0CB8E\" >&ensp;Let's start with importing required Libraries<\/div>","6f65aa38":"<div style=\"background:#F0CB8E   ;font-family:'Times';font-size:35px;color:  #A20404\" >&ensp;I will smile for every upvote :)<\/div>\n","b096d818":"<div style=\"background:#2b6684   ;font-family:'Times';font-size:35px;color:  #F0CB8E\" >&ensp;Let's varify what StratifiedKFold promised:<\/div>\n<div class=\"alert alert-warning\" role=\"alert\">\n<ul style=\"font-family:cursive;font-size:18px;color:  #A20404\">\n<li > Check the ratio of Target variable (song_popularity) in whole data.<\/li>\n<li> If each KFold has the same ratio, Startified Split is proved.<\/li>\n<li>Let's check this and see if Stratified-5-Fold is a success or not.<\/li>\n<\/ul>\n<\/div>","ef42aad8":"<div style=\"background:#2b6684   ;font-family:'Times';font-size:35px;color:  #F0CB8E\" >&ensp;Balanced or imbalanced data?<\/div>\n","4d687cb2":"<div style=\"background:#2b6684   ;font-family:'Times';font-size:35px;color:  #F0CB8E\" >&ensp;Load the Data<\/div>","b16fe121":"<div style=\"background:#2b6684   ;font-family:'Times';font-size:35px;color:  #F0CB8E\" >&ensp;Stratified-5-Folds<\/div>\n<div class=\"alert alert-warning\" role=\"alert\">\n<ul style=\"font-family:cursive;font-size:18px;color:  #A20404\">\n<li > Separate out Target variable (as we are going to preserve the target variable's label ratio)<\/li>\n<li> Instantiate StratifiedKFold class, with required parameters.<\/li>\n<li>Loop over the split created (train_indices, valid_indices) by StratifiedKFold.<\/li>\n<li>Using enumerate on StratifiedKFold split will let us access the fold number. Use this fold_number and valid_indicies together to assign to a value for kfold (already created column).<\/li>\n<li>Once Loop completes, -1 value in \"kfold\" variable will be replaced with Fold_Number value assigned by StratifiedKFold. Moreover the ratio of Target variable (song_popularity) is preserved for each loop.<\/li>\n<\/ul>\n<\/div>","c302e114":"<div style=\"background:#2b6684   ;font-family:'Times';font-size:35px;color:  #F0CB8E\" >&ensp;So we see that Rato is preserved, hence Stratified-5-Fold is a success.<\/div>\n<div class=\"alert alert-warning\" role=\"alert\">\n<ul style=\"font-family:cursive;font-size:20px;color:  #A20404\">\n<li> Will upload the starter notebook using for EDA, Modelling (with multiple models)<\/li>\n<\/ul>\n<\/div>\n"}}