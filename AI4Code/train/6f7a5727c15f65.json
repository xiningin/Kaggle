{"cell_type":{"918c4c89":"code","3f2a959e":"code","49b5c8e6":"code","ecb7dc54":"code","69485808":"code","826fdff9":"code","86d74c24":"code","384bfe1e":"code","1039b4fe":"code","0b5f6e06":"code","80cb0e31":"code","23e26cc5":"code","f2a622cf":"code","007759ba":"code","c33e68ba":"code","c8ae1020":"code","831c05d0":"code","ffe59472":"markdown","8e4993c0":"markdown","aa4f7715":"markdown","8c90642b":"markdown","dbc73464":"markdown","9559bf46":"markdown","8739807d":"markdown","c63a7b42":"markdown","71383e53":"markdown","689de199":"markdown","4a78e0c0":"markdown"},"source":{"918c4c89":"import numpy as np\nimport pandas as pd\n\n# graph\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style('whitegrid')\n\n# split validation set\nfrom sklearn.model_selection import train_test_split\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","3f2a959e":"label = pd.read_csv('\/kaggle\/input\/train_label.csv')\npledge = pd.read_csv('\/kaggle\/input\/train_pledge.csv')\nactivity = pd.read_csv('\/kaggle\/input\/train_activity.csv')\ncombat = pd.read_csv('\/kaggle\/input\/train_combat.csv')\npayment = pd.read_csv('\/kaggle\/input\/train_payment.csv')\nprint('label.shape: ',label.shape)\nprint('pledge.shape: ',pledge.shape)\nprint('activity.shape: ',activity.shape)\nprint('combat.shape: ',combat.shape)\nprint('payment.shape: ',payment.shape)","49b5c8e6":"train_set = [pledge, activity, combat]\ntotal_user_char_df = pd.DataFrame()\nfor df in train_set:\n    user_char_df = df[['acc_id','char_id']].drop_duplicates()\n    total_user_char_df = pd.concat([total_user_char_df, user_char_df], axis=0)\ntotal_user_char_df = total_user_char_df.drop_duplicates()\ntotal_user_char_cnt_df = total_user_char_df.acc_id.value_counts().reset_index().rename(columns={'index':'acc_id','acc_id':'char_cnt'})\nprint('\uc720\uc800&\uce90\ub9ad\ud130 DataFrame \ud06c\uae30: ',total_user_char_df.shape)\nprint('\uc720\uc800\ubcc4 \uce90\ub9ad\ud130 \uc218 DataFrame \ud06c\uae30: ', total_user_char_cnt_df.shape)","ecb7dc54":"sns.kdeplot(total_user_char_cnt_df.char_cnt, shade=True, label='Number of Character')\nplt.title('Number of Character by User Account Distribution')\nplt.show()","69485808":"total_user_char_cnt_df.char_cnt.describe()","826fdff9":"train_set = [pledge, activity, combat, payment]\ntotal_user_day_df = pd.DataFrame()\nfor df in train_set:\n    user_day_df = df[['acc_id','day']].drop_duplicates()\n    total_user_day_df = pd.concat([total_user_day_df, user_day_df], axis=0)\ntotal_user_day_df = total_user_day_df.drop_duplicates()\ntotal_user_day_cnt_df = total_user_day_df.acc_id.value_counts().reset_index().rename(columns={'index':'acc_id','acc_id':'day_cnt'})\nprint('total_user_day_df.shape: ',total_user_day_df.shape)\nprint('total_user_day_cnt_df.shape: ', total_user_day_cnt_df.shape)","86d74c24":"sns.kdeplot(total_user_day_cnt_df.day_cnt, shade=True, label='Activity Days')\nplt.title('Activity Days by User Account')\nplt.show()","384bfe1e":"total_user_day_cnt_df.day_cnt.describe()","1039b4fe":"label_set = label.copy()\nlabel_set['survived'] = label_set.survival_time.apply(lambda x: 1 if x == 64 else 0)\nlabel_set = pd.merge(label_set, total_user_char_cnt_df, on='acc_id', how='inner')\nlabel_set = pd.merge(label_set, total_user_day_cnt_df, on='acc_id', how='inner')\nprint('label_set shape: ',label_set.shape)","0b5f6e06":"X = label_set.drop(['survival_time','amount_spent'], axis=1)\ny = label_set[['survival_time','amount_spent']]\nx_train, x_valid, y_train, y_valid = train_test_split(X, \n                                                     y,\n                                                     test_size=0.3,\n                                                     random_state=2019,\n                                                     stratify=y.survival_time)","80cb0e31":"print('Number of user account in train set: ',x_train.shape[0])\nprint('Number of user account in validation set: ',x_valid.shape[0])","23e26cc5":"print('\uc88c: Train set \/ \uc6b0: Validation set')\npd.concat([y_train.describe(), y_valid.describe()], axis=1)","f2a622cf":"f, ax = plt.subplots(1,2, figsize=(15,5))\nsns.kdeplot(y_train.survival_time, shade=True, ax=ax[0], label='Train')\nsns.kdeplot(y_valid.survival_time, shade=True, ax=ax[0], label='Validation')\nax[0].set_title('Survival Time Distribution of Train\/Validation Set')\n\nsns.kdeplot(y_train.amount_spent, shade=True, ax=ax[1], label='Train')\nsns.kdeplot(y_valid.amount_spent, shade=True, ax=ax[1], label='Validation')\nax[1].set_title('Amount Spent Distribution of Train.Validation Set')","007759ba":"train = pd.concat([x_train, y_train], axis=1)\nvalid = pd.concat([x_valid, y_valid], axis=1)\ntrain['set'] = 'Train'\nvalid['set'] = 'Validation'\ntotal = pd.concat([train,valid], axis=0)\nprint('total.shape: ',total.shape)","c33e68ba":"f, ax = plt.subplots(1,3, figsize=(25,5))\nsns.countplot(x='survived', hue='set', data=total, ax=ax[0])\nax[0].legend(['Train','Validation'])\nax[0].set_xticklabels(['Survived','Not Survived'])\nax[0].set_xlabel('')\nax[0].set_title('Frequency of Survived in Train\/Validation Set')\n\nsns.kdeplot(data=total.loc[total.set=='Train','char_cnt'], ax=ax[1], shade=True, label='Train')\nsns.kdeplot(data=total.loc[total.set=='Validation','char_cnt'], ax=ax[1], shade=True, label='Validation')\nax[1].set_title('Number of Character by User Account Distribution in Train\/Validation Set')\n\nsns.kdeplot(data=total.loc[total.set=='Train','day_cnt'], ax=ax[2], shade=True, label='Train')\nsns.kdeplot(data=total.loc[total.set=='Validation','day_cnt'], ax=ax[2], shade=True, label='Validation')\nax[2].set_title('Activity Days by User Account in Train\/Validation Set')\nplt.show()","c8ae1020":"train_valid_user_id = total[['acc_id','set']]\nprint('train_valid_user_id shape: ',train_valid_user_id.shape)","831c05d0":"train_valid_user_id.to_csv('train_valid_user_id.csv', index=False)","ffe59472":"\ub450 Label\uc758 \ubd84\ud3ec\ub97c train\uacfc validation Set\uc744 \ube44\uad50\ud574\ubcf4\uc558\uc744 \ub54c, \uc794\uc874\uc77c\uc218(survival_time)\uc5d0\uc11c\ub294 64\uc5d0 train set\uc774 \ubab0\ub824\uc788\uc5c8\ub2e4. \ud3c9\uade0 \uc18c\ube44\uae08\uc561(amount_spent)\uc740 0\uadfc\ucc98\uc5d0\uc11c valiation set\uc774 \ub354 \ubab0\ub824\uc788\uc5c8\ub2e4. \uc804\uccb4\uc801\uc73c\ub85c \ubcf4\uc558\uc744 \ub54c \ud06c\uac8c \ubd84\ud3ec\uc758 \ucc28\uc774\ub294 \ubcf4\uc774\uc9c0 \uc54a\ub294\ub2e4\ub85c \ud310\ub2e8\ud558\uc5ec validation set\uc73c\ub85c \uc0ac\uc6a9\ud55c\ub2e4.","8e4993c0":"# Activity Days by User Account (\uc720\uc800\ubcc4 \ud65c\ub3d9\uc77c)","aa4f7715":"# Save Validation Account ID\n\uc544\ub798\ub294 \uc704\uc5d0\uc11c \ub098\ub208 Train \/ Validation Set\uc5d0 \ub300\ud55c User Account ID\uc774\ub2e4. \uc774\ud6c4 \ud559\uc2b5\uc5d0 \ub300\ud55c \uac80\uc99d\uc744 \uc704\ud574 \uc544\ub798 \uc800\uc7a5\ub41c \ub370\uc774\ud130\ub97c \ud65c\uc6a9\ud558\uba74 \ub41c\ub2e4.","8c90642b":"\uc720\uc800\ubcc4 \ud65c\ub3d9\uc77c\uc218\ub294 \ucd5c\uc18c 1\uc77c\ubd80\ud130 \ucd5c\ub300 28\uc77c\uae4c\uc9c0 \ubd84\ud3ec\ud558\uba70, \ub300\ubd80\ubd84 27\uc77c\uc5d0 \ubd84\ud3ec\ud574 \uc788\ub2e4. ","dbc73464":"\ucd5c\uc18c 1\uac1c\ubd80\ud130 \ub9ce\uac8c\ub294 229\uac1c\uae4c\uc9c0 \uce90\ub9ad\ud130\ub97c \ubcf4\uc720\ud558\uace0 \uc788\uc73c\uba70, \ub300\ubd80\ubd84\uc740 3\uac1c\uc758 \uce90\ub9ad\ud130\uac00 \uc788\ub2e4. ","9559bf46":"# Create Validation Set\n- Validation\uc744 \ub098\ub204\uae30 \uc704\ud574 \ud655\uc778\ub420 \ubd84\ud3ec\ub294 \uc720\uc800\ubcc4 \uc0dd\uc874 \uc5ec\ubd80, \uce90\ub9ad\ud130 \uc218, \ud65c\ub3d9\uc77c \uc774\ub2e4. \uc794\uc874\uae30\uac04(survival_time)\uacfc \ud3c9\uade0 \uc18c\ube44\uae08\uc561(amount_spent)\ub294 train set\uacfc validation set\uc744 Stratified \ud55c \ubc29\ubc95\uc73c\ub85c \ub098\ub20c \ub54c Label\ub85c\uc368 \uc0ac\uc6a9\ub41c\ub2e4.\n- Validation size\ub294 Train set\uc758 30%\ub85c \ud558\uba70, \uc774\ud6c4 \ubcc0\uacbd \uac00\ub2a5\ud558\ub2e4. **`validation set\uc5d0 \ub300\ud55c \ubd80\ubd84\uc740 \uc911\uc694\ud55c \ubd80\ubd84\uc774\uae30 \ub54c\ubb38\uc5d0 \uaf2d \uc8fc\uc758\ud574\uc11c \ud655\uc778\ud558\uae38 \ubc14\ub77c\uba70, \ubb38\uc81c \ud655\uc778\uc2dc \ub2e4\uc2dc \ubcc0\uacbd\ud55c\ub2e4.`**\n- \uacb0\uacfc\uc801\uc73c\ub85c\ub294 **Train set\uc740 28,000\uba85, Validation Set\uc740 12,000\uba85**\uc758 \ub370\uc774\ud130\ub97c \uc0ac\uc6a9\ud55c\ub2e4.","8739807d":"- train\uacfc validation set\uc758 \uc0dd\uc874\uc5ec\ubd80\ub97c \ube44\uad50\ud574 \ubcf4\uc558\uc744 \ub54c \uc704\uc5d0\uc11c \ubcf4\uc558\ub358 \uc794\uc874\uc77c\uc218\uc640 \uac19\uc774 train set\uc774 \uc870\uae08 \ub354 \uc774\ud0c8\uc790\uc5d0 \ub9ce\uc740 \ubd84\ud3ec\uac00 \uc788\uc5c8\ub2e4. \n- \uc720\uc800\ubcc4 \uce90\ub9ad\ud130 \uc218\ub97c \ube44\uad50\ud588\uc744 \ub54c \ub450 \ub370\uc774\ud130 \uc14b \ubaa8\ub450 0\uadfc\ucc98\uc5d0 \ubd84\ud3ec\ud574\uc788\ub2e4, \ub2e8, \uce90\ub9ad\ud130 \uc218\uac00 200\uac1c\uac00 \ub118\ub294 \ub4f1 \uc774\uc0c1\uce58\uc778 \uacbd\uc6b0\ub294 train set\uc5d0\ub9cc \uc788\ub2e4.\n- \uc720\uc800\ubcc4 \ud65c\ub3d9\uc77c\uc740 train set\uc5d0 \uc870\uae08 \ub354 \ub9ce\uc774 28\uc77c\uc5d0 \ubd84\ud3ec\ud574\uc788\uc9c0\ub9cc, \ub450 \ub370\uc774\ud130 \ubaa8\ub450 \ube44\uc2b7\ud55c \ubd84\ud3ec\uc774\ub2e4.","c63a7b42":"# How to Split Validation in Train Set\n\ubcf8 kernel\uc740 \uac80\uc99d \ub370\uc774\ud130\ub97c \uc5b4\ub5bb\uac8c \ub098\ub20c \uac83\uc778\uc9c0\uc5d0 \ub300\ud55c \ub0b4\uc6a9\uacfc \ud655\uc778 \uacfc\uc815\uc744 \ub2f4\uace0 \uc788\uc2b5\ub2c8\ub2e4. \n\n\uc774\ubc88 \uacfc\uc81c\uc5d0\uc11c\ub294 \uc720\uc800\uac00 \ucd1d 40,000\uba85\uc73c\ub85c \uac01 \uc720\uc800\uc758 \uc794\uc874\uc77c\uc218(survival_time)\uacfc \ud3c9\uade0 \uc18c\ube44\uae08\uc561(amount_spent)\ub97c \uc608\uce21\ud558\ub294 \uac83\uc744 \ubaa9\ud45c\ub85c \ud569\ub2c8\ub2e4. \ud559\uc2b5\uc5d0 \uc55e\uc11c \ub370\uc774\ud130 \uac80\uc99d\uc744 \uc704\ud574\uc11c\ub294 \uac80\uc99d \ub370\uc774\ud130\ub97c \ub530\ub85c \uad6c\uc131\ud560 \ud544\uc694\uac00 \uc788\uc2b5\ub2c8\ub2e4. \ub370\uc774\ud130 \uac80\uc99d\uc744 \uc704\ud574\uc11c\ub294 \ud559\uc2b5\uc5d0 \uc0ac\uc6a9\ub418\ub294 \ub370\uc774\ud130\uc640 \uac80\uc99d\uc5d0 \uc0ac\uc6a9\ub418\ub294 \ub370\uc774\ud130\uac00 \uc11c\ub85c \ucc28\uc774\uac00 \uc5c6\uc744 \uc218\ub85d \ub354 \uc815\ud655\ud55c \uac80\uc99d\uc744 \ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \n\uac80\uc99d \ub370\uc774\ud130\ub97c \ub098\ub204\uace0 \ud559\uc2b5 \ub370\uc774\ud130\uc640\uc758 \ucc28\uc774\ub97c \ud655\uc778\ud558\uae30 \uc704\ud55c \uc5ec\ub7ec \ubc29\ubc95\ub4e4\uc774 \uc788\uc2b5\ub2c8\ub2e4. \ub300\ud45c\uc801\uc73c\ub85c \uc544\ub798\uc640 \uac19\uc774 3\uac00\uc9c0 \ubc29\ubc95\uc744 \uc608\uc2dc\ub85c \ub4e4\uc218 \uc788\uc2b5\ub2c8\ub2e4.\n1. Student's t-test\ub098 Chi-square test\ub97c \ud1b5\ud574 \ub450 \ubcc0\uc218\uac04\uc758 \ucc28\uc774\uc758 \uc720\uc758\ubbf8\uc131\uc744 \ud655\uc778\n2. Adversarial Validation\uc744 \ud558\ub294 \ubc29\ubc95\n3. \uadf8\ub798\ud504\ub97c \ud1b5\ud574 \ubd84\ud3ec\ub97c \ube44\uad50\ud558\ub294 \ubc29\ubc95\n\n\ubcf8 kernel\uc5d0\uc11c\ub294 \uc218\uce58\uc801\uc73c\ub85c\ub098 \ud1b5\uacc4\uc801\uc73c\ub85c \ubcf4\ub294 \uac83\ubcf4\ub2e4 \uc720\uc758\ubbf8\ud558\uc9c0\ub294 \uc54a\uc9c0\ub9cc \uac00\uc7a5 \uac04\ub2e8\ud55c 3\ubc88 \ubc29\ubc95\uc744 \ud1b5\ud574 \uc0dd\uc874\uc5ec\ubd80\uc640 \uc720\uc800\ubcc4 \uce90\ub9ad\ud130 \uc218, \uc720\uc800\ubcc4 \ud65c\ub3d9\uc77c\uc744 \uae30\uc900\uc73c\ub85c \ubd84\ud3ec\uac00 \uac19\uc740\uc9c0 \ub2e4\ub978\uc9c0\ub97c \ud310\ub2e8\ud558\uace0 **Stratified \ubc29\ubc95**\uc744 \uc0ac\uc6a9\ud558\uc5ec \uc794\uc874\uc77c\uc218(survival time)\uacfc \ud3c9\uade0 \uc18c\ube44\uc561(amount spent)\ub97c Label\ub85c \uc0ac\uc6a9\ud558\uc5ec \ud559\uc2b5\ub370\uc774\ud130\uc640 \uac80\uc99d\ub370\uc774\ud130\ub97c \ub098\ub204\uc5c8\uc2b5\ub2c8\ub2e4. \n\n\ud639\uc2dc \ucd94\uac00\uc801\uc73c\ub85c \ud559\uc2b5\ub370\uc774\ud130\uc640 \uac80\uc99d\ub370\uc774\ud130\uc758 \ubd84\ud3ec\uac00 \uc11c\ub85c \ub2e4\ub978\uc9c0 \ud655\uc778\ud558\uae30\uc704\ud574 \ud544\uc694\ud55c \ubcc0\uc218\uac00 \uc0dd\uac01\uc774 \ub098\uc2e0\ub2e4\uba74 \ub313\uae00\uc744 \ud1b5\ud574 \uc870\uc5b8 \ubd80\ud0c1\ub4dc\ub9bd\ub2c8\ub2e4. \n\n--- \n\n- \ubcf8 kernel\uc5d0\uc11c \uc0ac\uc6a9\ub41c Validation \ube44\uc728\uc740 30%\uc774\uba70, Random seed\ub294 **2019** \uc785\ub2c8\ub2e4.","71383e53":"# Number of Character by User Account (\uc720\uc800\ubcc4 \uce90\ub9ad\ud130 \uc218)\n- payment\ub294 \uce90\ub9ad\ud130 ID\uac00 \uc5c6\uc73c\ubbc0\ub85c \uc81c\uc678\ud55c\ub2e4","689de199":"# Load data","4a78e0c0":"Train set\uc758 \uc720\uc800\ub294 \ucd1d 40,000\ub9cc\uba85\uc774\ub2e4. "}}