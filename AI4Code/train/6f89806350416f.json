{"cell_type":{"bcc87250":"code","425cb895":"code","85f6904e":"code","78a954c9":"code","89d93caf":"code","6abc1909":"code","bb8af249":"code","d95e1df0":"code","f0f3c7f5":"markdown","584e63dd":"markdown","6dba3d9b":"markdown","0b2aee1b":"markdown"},"source":{"bcc87250":"!cp -r ..\/input\/nucleictransformerrnainference\/RNA_Inference .\n","425cb895":"import RNA_Inference\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt","85f6904e":"df_path='..\/input\/stanford-covid-vaccine\/post_deadline_files\/new_sequences.csv'\ndf=pd.read_csv(df_path)","78a954c9":"sequences=df.sequence\nstructures=df.structure\nloops=df.bpRNA_string\nbpps=[]\nfor i in range(len(df)):\n    bpps.append(np.load(f'..\/input\/stanford-covid-vaccine\/post_deadline_files\/new_sequences_bpps\/{df.id[i]}.npy'))\n","89d93caf":"print(sequences[0])\nprint(structures[0])\nprint(loops[0])","6abc1909":"inference_tool=RNA_Inference.RNA_Inference()\ninference_tool.load_models('RNA_Inference\/best_weights')\noutputs, attention_weights=inference_tool.predict(sequences,structures,loops,bpps)","bb8af249":"results_df=pd.DataFrame(columns=\n['idseqpos','reactivity','deg_Mg_pH10','deg_pH10','deg_Mg_50C','deg_50C'])\n\ncat_outputs=np.concatenate(outputs,0)\n\nidseqpos=[]\n\nfor i in range(len(df)):\n    for j in range(len(outputs[i])):\n        idseqpos.append(f'{df.id[i]}_j')\n\nresults_df.idseqpos=idseqpos\nresults_df.iloc[:,1:]=cat_outputs\nresults_df.to_csv('predictions.csv',index=False)","d95e1df0":"results_df.head()","f0f3c7f5":"# Load sequences and features to predict degradation properties\nFirst, let's load the sequences you want to predict. Here I just use the testing data from OpenVaccine but you can change it to anything you like","584e63dd":"# Nucleic Transformer\nThe Nucleic Transformer models are deep learning models developed to study and understand DNA\/RNA usings public available datasets. You can check out [the paper on bioarxiv](https:\/\/www.biorxiv.org\/content\/10.1101\/2021.01.28.428629v1)\nand [open-sourced code on github](https:\/\/github.com\/Shujun-He\/Nucleic-Transformer). The model archiecture is simple but effective, outperforming previous results in DNA promoters\/virus classification; additionally,\nwe used it to to place 7th in the [OpenVaccine challenge](https:\/\/www.kaggle.com\/c\/stanford-covid-vaccine).\n\nThis notebook will show how to use the RNA degradation prediction model and visualize the attention weights of the Nucleic Transformer","6dba3d9b":"### Let us take a look at what kind of features we are dealing with","0b2aee1b":"# Load models and make predictions"}}