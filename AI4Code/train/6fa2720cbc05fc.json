{"cell_type":{"80a67a71":"code","30098ed1":"code","ced24e43":"code","6f5d1f67":"code","ddc73820":"code","fe705c7e":"code","01ebd289":"code","5393a8ee":"code","dad962b9":"code","2e658b51":"code","05d68b5e":"code","2fb765f0":"code","0294d08c":"code","1d4398ba":"markdown","07a11032":"markdown","38af3452":"markdown","e32b2455":"markdown","08c26d7b":"markdown","c5930d0a":"markdown","a0f58591":"markdown"},"source":{"80a67a71":"import os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport zipfile\nfrom tensorflow import keras\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator","30098ed1":"test = pd.read_csv('..\/input\/histopathologic-cancer-detection\/sample_submission.csv')\n\nprint('Test Set Size:', test.shape)","ced24e43":"test.head()","6f5d1f67":"test_path = \"..\/input\/histopathologic-cancer-detection\/test\/\"\nprint('Test Images:', len(os.listdir(test_path)))","ddc73820":"def append_ext(fn):\n    return fn+\".tif\"","fe705c7e":"test['id'] = test['id'].apply(append_ext)\ntest.head()","01ebd289":"BATCH_SIZE = 64\n\ntest_datagen = ImageDataGenerator(rescale=1\/255)\n\ntest_loader = test_datagen.flow_from_dataframe(\n    dataframe = test,\n    directory = test_path,\n    x_col = 'id',\n    batch_size = BATCH_SIZE,\n    shuffle = False,\n    class_mode = None,\n    target_size = (32,32)\n)","5393a8ee":"cnn = keras.models.load_model('..\/input\/cancer-detection-models\/cancer_model.h5')\ncnn.summary()","dad962b9":"test_probs = cnn.predict(test_loader)\nprint(test_probs.shape)","2e658b51":"print(test_probs[:10,].round(2))","05d68b5e":"submission = pd.read_csv('..\/input\/histopathologic-cancer-detection\/sample_submission.csv')\nsubmission.head()","2fb765f0":"submission.label = test_probs[:,1]\nsubmission.head()","0294d08c":"submission.to_csv('submission.csv', header=True, index=False)","1d4398ba":"## Data Generator","07a11032":"## Load DataFrame\n","38af3452":"## Load Model","e32b2455":"## Import Statements","08c26d7b":"## Prepare Submission","c5930d0a":"## Extract Test Images","a0f58591":"## Test Predictions"}}