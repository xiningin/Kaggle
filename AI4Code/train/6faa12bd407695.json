{"cell_type":{"8c1f60eb":"code","78f0bf4a":"code","c7faba31":"code","02f1ec04":"code","0c3e646e":"code","55386ae9":"code","5980682a":"code","1c955a37":"code","224ce8bd":"code","62a4d999":"code","85c43cfc":"code","f736b227":"code","01a2ed61":"code","c71c76ba":"code","a01c6fc8":"code","746e22a9":"code","8ba00094":"code","d9110cac":"code","387aa692":"code","0185075e":"code","23647925":"code","6add80e7":"code","6424632c":"code","9860961b":"code","527bb4ad":"markdown","6ebf3a4d":"markdown","e8f9ef79":"markdown","0d9a0f6f":"markdown","b18b4e84":"markdown","630e6ce2":"markdown"},"source":{"8c1f60eb":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","78f0bf4a":"#Import fastai framework\nfrom fastai import *\nfrom fastai.vision import *\nfrom torchvision.models import * \n\nimport os\nimport matplotlib.pyplot as plt","c7faba31":"#load data\npath = Path(\"..\/input\/stanford-dogs-dataset\/\")\npath","02f1ec04":"path.ls()","0c3e646e":"# path_anno = path\/'annotations\/Annotations'\npath_img = path\/'images\/Images\/'\n\n# path_anno\npath_img","55386ae9":"path_img.ls()\n","5980682a":"tfms = get_transforms()\n# data = ImageDataBunch.from_folder(path_img ,train='.', valid_pct = 0.2,ds_tfms = tfms , size = 227)\n\n\nnp.random.seed(42)\ndata = ImageDataBunch.from_folder(path, train=\".\", valid_pct=0.2,\n        ds_tfms=get_transforms(), size=227, num_workers=0).normalize(imagenet_stats)","1c955a37":"data = ImageDataBunch.from_folder(path, train=\".\", valid_pct=0.2,\n        ds_tfms=get_transforms(), size=227, num_workers=0, classes=data.classes[:100]).normalize(imagenet_stats)","224ce8bd":"data.show_batch(rows = 3 ,figsize = (7,6))\nprint(data.classes)\nlen(data.classes), data.c # data.c = for classification problems its number of classes","62a4d999":"learn = create_cnn(data , models.resnet34, metrics = error_rate) ","85c43cfc":"learn.fit_one_cycle(4)","f736b227":"learn.model_dir = \"\/kaggle\/working\"\nlearn.save('stage-1')","01a2ed61":"learn.unfreeze()","c71c76ba":"learn.lr_find()","a01c6fc8":"learn.recorder.plot()","746e22a9":"learn.fit_one_cycle(4, max_lr=slice(3e-6,3e-5))\nlearn.model_dir = \"\/kaggle\/working\"\nlearn.save('stage-2')","8ba00094":"learn.load('stage-2')\ninterp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_top_losses(9 , figsize = (15,11))","d9110cac":"interp.plot_confusion_matrix(figsize = (30,30), dpi = 60)","387aa692":"interp.most_confused(min_val = 2) ","0185075e":"data.classes","23647925":"img = open_image('..\/input\/stanford-dogs-dataset\/images\/Images\/n02105855-Shetland_sheepdog\/n02105855_13382.jpg')\nimg","6add80e7":"classes = data.classes\ndata2 = ImageDataBunch.single_from_classes(path, classes, ds_tfms=get_transforms(), size=224).normalize(imagenet_stats)\nlearn = create_cnn(data2 , models.resnet34)\nlearn.load('\/kaggle\/working\/stage-2')","6424632c":"pred_class,pred_idx,outputs = learn.predict(img)\npred_class","9860961b":"prediction = str(pred_class)\nprediction[10:]\nprint(\"The predicted breed is \" + prediction[10:] + '.')","527bb4ad":"\ub370\uc774\ud130 \ubcf4\uc5ec\uc8fc\uae30","6ebf3a4d":"# Setting Resnet34\n\nResnet 34 is a neural network used for image identification.\n\nIt is among the most accurate image identification neural nets.\n![image.png](attachment:image.png)\nSource : Talo, Muhammed & y\u0131ld\u0131r\u0131m, \u00d6zal & Baloglu, Ulas & Aydin, Galip & Acharya, U Rajendra. (2019). Convolutional neural networks for multi-class brain disease detection using MRI images. Computerized Medical Imaging and Graphics. 78. 101673. 10.1016\/j.compmedimag.2019.101673. \n\n\n\n","e8f9ef79":"# Dog breed Confusion\n\nBreeds that look similar to the human eyes such as Rough collie-Border collie, husky-malamute, shih tzu-maltese pairs are often confused.\nAs the table above is kind of cramped, I recommend using interp.most_confused for a more clear look.","0d9a0f6f":"* This was done as an exercise to familiarize myself with fastai.\n\n# What is FastAI? Why use FastAI?\n\nFastAI is a pytorch-based framework used for deep learning.\nThe advantages of using FastAI is to be able to quickly and easily build and deploy deep learning models, without intricate layer coding.\n\n","b18b4e84":"I have tried to classify a shetland sheepdog image here. Since this exercise uses random sampling, it might not use shetland sheepdog the time you run.","630e6ce2":"This was the path settings."}}