{"cell_type":{"1dbc054a":"code","030667a4":"code","f659a406":"code","bb8feede":"code","74d2435c":"code","1934932d":"code","483dacb8":"code","4cb825cc":"code","6e0261f4":"code","fb280343":"code","7fe7e0d5":"code","9a1fee97":"code","1c44f021":"code","7580bb78":"code","3a476132":"code","430eca59":"code","4349e258":"code","9a8fae68":"code","c25f2029":"code","97e58c45":"code","e87ec251":"code","de915a14":"code","9f36da7d":"code","6715afa0":"code","2d66b420":"code","06550102":"code","e78473cc":"code","dd79f67f":"code","4b262ccc":"code","c4c9ce5b":"code","cea3e45a":"code","18d1a472":"code","453bd420":"code","99b99be4":"code","55966375":"code","9e2c54b2":"code","65e71c3c":"code","1038c2d3":"code","146bb79e":"code","730c9c1c":"code","fee5ab9b":"markdown"},"source":{"1dbc054a":"import pandas as pd\nwater= pd.read_csv(\"..\/input\/nyc-beach-water-quality-data\/dohmh-beach-water-quality-data-1.csv\")\nwater.head(9)","030667a4":"water['Sample Location'].value_counts()","f659a406":"water['Sample Location']= water['Sample Location'].replace('Rigth','Right')\nround(water['Sample Location']. value_counts()*100\/len(water),2)","bb8feede":"water.nunique()","74d2435c":"water.info()","1934932d":"water['Sample Date']=pd.to_datetime(water['Sample Date'])\nwater.info()","483dacb8":"water.isnull().sum()*100\/len(water)","4cb825cc":"missing=water[water.isna().any(axis=1)]\nmissing.head()","6e0261f4":"missing.isnull().sum()*100\/len(missing)","fb280343":"missing.nunique()","7fe7e0d5":"missing['Units or Notes'].value_counts()*100\/len(missing)","9a1fee97":"water[water['Units or Notes']=='Result below detection limit'].head()","1c44f021":"water[water['Units or Notes']=='Result below detection limit'].info()","7580bb78":"water[water['Units or Notes']!='Result below detection limit'].head()","3a476132":"water[water['Units or Notes']!='Result below detection limit'].info()","430eca59":"water['Enterococci Results']=water['Enterococci Results'].fillna(0)\nwater.isnull().sum()*100\/len(missing)","4349e258":"water=water.dropna()\nwater.info()","9a8fae68":"water.nunique()","c25f2029":"water.head()","97e58c45":"water=water.drop(['Units or Notes'],axis=1)\nwater.head()","e87ec251":"#paper : https:\/\/www.environment.nsw.gov.au\/-\/media\/OEH\/Corporate-Site\/Documents\/Water\/Beaches\/state-of-beaches-2019-2020-statewide-summary-200302.pdf\nwater.loc[water['Enterococci Results'] <= 50, 'Category'] = 'open'\nwater.loc[water['Enterococci Results'] >500, 'Category'] = 'closed'\nwater.loc[(water['Enterococci Results'] >50) & (water['Enterococci Results'] <=500), 'Category'] = 'advisory'\nround(water['Category'].value_counts()*100\/len(water))","de915a14":"water.rename(columns = {'Enterococci Results':'Enterococci Results (MPN\/100 ml)'}, inplace = True)\nwater.head()","9f36da7d":"!pip install pandas-profiling","6715afa0":"from pandas_profiling import ProfileReport\nProfileReport(water, title=\"EDA Report\")","2d66b420":"!pip install pycaret","06550102":"data = water.sample(frac=0.8, random_state=42)\ndata_unseen = water.drop(data.index)\ndata.reset_index(inplace=True, drop=True)\ndata_unseen.reset_index(inplace=True, drop=True)\nprint('Data for Modeling: ' + str(data.shape))","e78473cc":"print('Unseen Data For Predictions: ' + str(data_unseen.shape))","dd79f67f":"from pycaret.classification import *","4b262ccc":"water= setup(data = data, target = 'Category', session_id=42,\n                  normalize = True, \n                  transformation = True, \n                  log_experiment = True,\n                  handle_unknown_categorical = True, \n                  unknown_categorical_method = 'most_frequent',\n                  remove_multicollinearity = True, #drop one of the two features that are highly correlated with each other\n                  ignore_low_variance = True,#all categorical features with statistically insignificant variances are removed from the dataset.\n                  combine_rare_levels = True,# all levels in categorical features below the threshold defined in rare_level_threshold param are combined together as a single level\n                  numeric_imputation='median',\n           ignore_features=['Sample ID'],\n            date_features=['Sample Date'],\n             high_cardinality_features =['Beach Name'],           \n           fix_imbalance = True,\n            train_size = 0.8\n          )","c4c9ce5b":"dt = create_model('dt')","cea3e45a":"print(dt)","18d1a472":"tuned_dt = tune_model(dt,optimize = 'MCC')","453bd420":"plot_model(tuned_dt, plot = 'auc')","99b99be4":"plot_model(tuned_dt, plot = 'pr')","55966375":"plot_model(tuned_dt, plot='feature')","9e2c54b2":"plot_model(tuned_dt, plot = 'confusion_matrix')","65e71c3c":"evaluate_model(tuned_dt)","1038c2d3":"predict_model(tuned_dt)","146bb79e":"unseen_predictions = predict_model(tuned_dt, data=data_unseen)\nunseen_predictions.head()","730c9c1c":"print(\"Confidence Score :   {}\".format(round(unseen_predictions.Score.mean(),2)))#Confidence Score","fee5ab9b":"# Sample Location"}}