{"cell_type":{"13656450":"code","4045df60":"code","8236c27f":"code","a1ef77d1":"code","369db1f7":"code","0f4e2171":"code","f13233a0":"code","b6b9511f":"code","c57c696a":"code","dcfd7651":"code","49a7f818":"code","93a42984":"code","ceae4bd9":"code","c43fd1c8":"code","fd959e17":"code","87dc62a8":"code","16167cf2":"code","d77a2a20":"code","77ffa728":"code","b796d890":"code","8e5a5e74":"code","e7d29d4e":"code","e9901df9":"code","f792b836":"code","12c0e9dd":"code","2a5cd839":"code","5b17a1f2":"code","68e59517":"code","8757cb52":"code","7aae8e94":"code","c4a24886":"code","189b048d":"code","7ffdd034":"markdown","d304d33e":"markdown","d19b26d5":"markdown","788be572":"markdown","4dc26ad7":"markdown","d9f9194d":"markdown","844480fe":"markdown","54a01351":"markdown","ebe3dae5":"markdown"},"source":{"13656450":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.ensemble import RandomForestClassifier\nfrom catboost import CatBoostClassifier\nfrom lightgbm import LGBMClassifier\nfrom xgboost import XGBClassifier\nfrom sklearn.metrics import accuracy_score\nimport warnings\nwarnings.filterwarnings('ignore')","4045df60":"df = pd.read_csv('..\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv')","8236c27f":"df","a1ef77d1":"df.info()","369db1f7":"df.stroke","0f4e2171":"df.drop(['id'],axis=1,inplace=True)","f13233a0":"cat = []\ninf = []\nfor i in range(0,df.shape[1]):\n    if df.iloc[:,i].dtype == object:\n        cat.append(df.iloc[:,i].name)\n    else:\n        inf.append(df.iloc[:,i].name)\n","b6b9511f":"cat","c57c696a":"inf","dcfd7651":"fig=plt.figure(figsize=(20,10),facecolor = '#fbe7dd')\ncolumns = 3\nrows = 2\na=np.random.rand(2,3)\nfor i in range(1,len(cat)+1):\n    fig.add_subplot(rows, columns, i)\n    sns.countplot(df[cat[i-1]],palette='Spectral_r') \nplt.show()\n    ","49a7f818":"plt.figure(figsize=(10,6),facecolor = '#fbe7dd')\nplt.pie(df.stroke.value_counts(),labels=['Stroke','No Stroke'],startangle=40,explode=[0,0.15],shadow=True,colors=['#FFA177FF','#F5C7B8FF'],autopct = '%1.1f%%')\nplt.axis('equal')\nplt.show()","93a42984":"_,ax = plt.subplots(1,2,figsize=(20,8),facecolor='#fbe7dd')\nsns.countplot(df.gender,hue =  df.stroke,palette='Spectral_r',ax =ax[0])\nsns.countplot(df.smoking_status,hue = df.stroke,ax=ax[1],palette='Spectral_r')\nplt.show()","ceae4bd9":"gs0 = df[df.stroke == 0].gender.value_counts()\ngs1 = df[df.stroke == 1].gender.value_counts()\nss0 = df[df.stroke == 0].smoking_status.value_counts()\nss1 = df[df.stroke == 1].smoking_status.value_counts()","c43fd1c8":"gs1","fd959e17":"_,ax= plt.subplots(2,2,figsize=(20,12),facecolor='#fbe7dd')\nax[0][0].pie(gs0,labels=['Female','Male','Other'],shadow =True,autopct = '%1.1f%%',explode = [0.03,0.03,0.03],colors =['#dee9a4','#72b7a1','#de7959'])\nax[0][1].pie(gs1,labels=['Female','Male'],shadow =True,autopct = '%1.1f%%',explode = [0.03,0.03],colors =['#dee9a4','#72b7a1'])\nax[1][0].pie(ss0,labels=['Never Smoked','Formerly Smoked','Unknown','Smokes'],shadow =True,autopct = '%1.1f%%',explode = [0.04,0.04,0.04,0.04],colors =['#dee9a4','#72b7a1','#de7959','#f0d999'])\nax[1][1].pie(ss1,labels=['Never Smoked','Formerly Smoked','Unknown','Smokes'],shadow =True,autopct = '%1.1f%%',explode = [0.04,0.04,0.04,0.04],colors =['#dee9a4','#72b7a1','#de7959','#f0d999'])\nax[0][0].set_title('Stroke = 0',fontsize= 30)\nax[0][1].set_title('Stroke = 1',fontsize= 30)\nplt.show()","87dc62a8":"#f, ax = plt.subplots(figsize=(10, 8))\n#ax.set_aspect(\"equal\")\n\n# Draw a contour plot to represent each bivariate density\n#sns.kdeplot(\n    #data=df,\n    #y=\"gender\",\n    #x=\"heart_disease\",\n    #hue=\"stroke\",\n    ##thresh=.1,\n#)","16167cf2":"fig=plt.figure(figsize=(20,10),facecolor='#fbe7dd')\ncolumns = 3\nrows = 2\na=np.random.rand(2,3)\nfor i in range(1,len(inf)):\n    fig.add_subplot(rows, columns, i)\n    sns.kdeplot(df[inf[i-1]],hue = df.stroke) \nplt.show()\n","d77a2a20":"df.gender[df.gender == 'Other']","77ffa728":"df.bmi.fillna(df.bmi.mean(),inplace=True)","b796d890":"df = pd.get_dummies(df)","8e5a5e74":"x= df.drop(['stroke','gender_Other'],axis = 1)","e7d29d4e":"nu = ['age','bmi','avg_glucose_level']","e9901df9":"sc = StandardScaler()\nx[nu] = sc.fit_transform(x[nu])","f792b836":"y = df.stroke","12c0e9dd":"x_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.2,random_state=44)","2a5cd839":"score ={}","5b17a1f2":"rfc = RandomForestClassifier()\nrfc.fit(x_train,y_train)\nscore['Random Forest'] = accuracy_score(y_test,rfc.predict(x_test))\naccuracy_score(y_test,rfc.predict(x_test))","68e59517":"lgb = LGBMClassifier(learning_rate = 0.1,reg_alpha = 0.3,n_estimators = 100).fit(x_train,y_train)\nscore['LightGBM'] = (accuracy_score(y_test,lgb.predict(x_test)))\n(accuracy_score(y_test,lgb.predict(x_test)))","8757cb52":"xgb = XGBClassifier().fit(x_train,y_train)\nscore['XGBoost'] =accuracy_score(y_test,xgb.predict(x_test))\naccuracy_score(y_test,xgb.predict(x_test))","7aae8e94":"cbc = CatBoostClassifier(n_estimators=150,l2_leaf_reg=0.1,verbose = 0).fit(x_train,y_train)\nscore['Cat Boost'] = accuracy_score(y_test,cbc.predict(x_test))\naccuracy_score(y_test,cbc.predict(x_test))","c4a24886":"key = list(score.keys())\nval = list(float(score[k]) for k in key)","189b048d":"plt.figure(figsize = (16,6))\nscore = sns.barplot(val,key,palette=\"Spectral_r\")\nfor i in range(0,len(key)):\n    score.text(val[i]\/2,i,str(np.round(val[i],4)),fontdict = dict(fontsize = 12,ha = 'center',va = 'center'),weight = 'bold')","7ffdd034":"<center><span style = 'font-size:19px;font-weight:bold'>Integer\/Float Data<\/span><\/center>","d304d33e":"<center><img src ='https:\/\/medicineforthemindblog.files.wordpress.com\/2017\/08\/brain-pic.jpg' width = '600px'><\/center>\n<center><img src='https:\/\/i.imgur.com\/SZQXq1q.png' width = '600px'><\/center>","d19b26d5":"<center><span style = 'font-size:19px;font-weight:bold'>Categorical Data<\/span>","788be572":"<p style='font-size:17px;font-weight:bold'>A <span style='color:#f54025'>stroke<\/span> occurs when the blood supply to part of your brain is interrupted or reduced, preventing brain tissue from getting oxygen and nutrients. Brain cells begin to die in minutes. <span style='color:#f54025'>Stroke<\/span> has already reached epidemic proportions. Globally 1 in 4 adults over the age of 25 will have a <span style='color:#f54025'>stroke<\/span> in their lifetime. 13.7 million people worldwide will have their first <span style='color:#f54025'>stroke<\/span> this year and five and a half million will die as a result.<\/p>","4dc26ad7":"<center><span style=\"font-size:25px;color:#9ACD32;font-weight:bold\">If you find this notebook helpful, don't forget to <\/span><span style= 'font-size:25px;color:#b7410e;font-weight:bold'>upvote.","d9f9194d":"<p style = 'font-size : 17px;font-style: italic'>\n    <span style ='font-size:19px;font-weight:bold;color:#9ACD32'>Attribute Information<br><\/span>\n1) id:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; unique identifier<br>\n2) gender:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;\"Male\", \"Female\" or \"Other\"<br>\n3) age:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; age of the patient<br>\n4) hypertension:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; 0 if the patient doesn't have hypertension, 1 if the patient has hypertension<br>\n5) heart_disease:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;0 if the patient doesn't have any heart diseases, 1 if the patient has a heart disease<br>\n6) ever_married:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;\"No\" or \"Yes\"<br>\n7) work_type:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; \"children\", \"Govt_jov\", \"Never_worked\", \"Private\" or \"Self-employed\"<br>\n8) Residence_type:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;\"Rural\" or \"Urban\"<br>\n9) avg_glucose_level:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; average glucose level in blood<br>\n10) bmi:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; body mass index<br>\n11) smoking_status:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; \"formerly smoked\", \"never smoked\", \"smokes\" or \"Unknown\"*<br>\n12) stroke:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; 1 if the patient had a stroke or 0 if not<br>\n*Note: \"Unknown\" in smoking_status means that the information is unavailable for this patient\n<\/p>","844480fe":"<h1 id=\"heading1\">\n<span style=\"font-size:30px;color:#9ACD32;font-weight:bold\"><center>Exploring Data<\/center><\/span>\n      <a class=\"anchor-link\" href=\"https:\/\/www.kaggle.com\/alampalsingh\/notebook004d896e8c#heading1\" target =\"_self\"><\/a>\n<\/h1>","54a01351":"<center><span style = 'font-size:19px;font-weight:bold'>Dividing Data into Categorical and Integer\/Float Data<\/span>","ebe3dae5":"<h1 id=\"heading2\">\n<span style=\"font-size:30px;color:#9ACD32;font-weight:bold\"><center>Model Fitting<\/center><\/span>\n<a class=\"anchor-link\" href=\"https:\/\/www.kaggle.com\/alampalsingh\/notebook004d896e8c#heading2\" target ='_self'><\/a>\n<\/h1>"}}