{"cell_type":{"2610ff02":"code","fca2949f":"code","a2b7ebd8":"code","86038d2a":"code","b5904c44":"code","53eddb71":"code","f9818110":"code","18caab0e":"code","99ebad70":"code","c6767f72":"code","30425319":"code","69fa3c17":"code","1c60c2f2":"code","64c3a303":"code","cf512538":"markdown","75b93f40":"markdown"},"source":{"2610ff02":"import numpy as np\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import scale\nfrom sklearn.neighbors import KNeighborsRegressor\nimport matplotlib.pyplot as plt","fca2949f":"df = pd.read_csv('..\/input\/wine-whitered\/Wine_red.csv',sep=';')\nprint(df.shape)\ndf.head(3)","a2b7ebd8":"(df_train,df_test) = train_test_split(df,train_size=0.8,test_size=0.2,shuffle=True,random_state=0)","86038d2a":"features_train = df_train.iloc[:,0:-1]\nfeatures_test = df_test.iloc[:,0:-1]\ntargets_train = df_train.iloc[:,-1]\ntargets_test = df_test.iloc[:,-1]","b5904c44":"features_train = scale(features_train)\nfeatures_test = scale(features_test)","53eddb71":"features_train.std(axis=0)","f9818110":"targets_test","18caab0e":"num_neighbors = []\nR2_train = []\nR2_test = []\nfor K in np.arange(100)+1:\n    knn = KNeighborsRegressor(n_neighbors=K)\n    knn.fit(features_train,targets_train)\n    num_neighbors.append(K)\n    R2_train.append(knn.score(features_train,targets_train))\n    R2_test.append(knn.score(features_test,targets_test))\n\nerrors = pd.DataFrame()\nerrors['neighbors'] = num_neighbors\nerrors['train R2'] = R2_train\nerrors['test R2'] = R2_test\nerrors.head(3)","99ebad70":"ax1 = errors.plot.line(x='neighbors', y='train R2')\nerrors.plot.line(x='neighbors',y='test R2',ax=ax1)\nplt.ylabel('error R2')","c6767f72":"print(' max test R-sqr = ',errors['test R2'].max())\nix = errors['test R2'].idxmax()\nprint('optimal n_neighbors =', errors.neighbors[ix])","30425319":"knn = KNeighborsRegressor(n_neighbors=89)","69fa3c17":"knn.fit(features_train,targets_train)\nyh = knn.predict(features_test)\ny = targets_test\nmse_knn = ((y-yh)**2).mean()\nmse_knn","1c60c2f2":"#simple bias regressor\nb = y.mean()\nmse_bias = ((y-b)**2).mean()\nmse_bias","64c3a303":"R2 = 1-mse_knn\/mse_bias\nround(R2,7)","cf512538":"## Check R-sqr","75b93f40":"## Example (KNN Regressor for Red Wine 1)"}}