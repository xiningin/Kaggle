{"cell_type":{"d5c27321":"code","c46715ab":"markdown"},"source":{"d5c27321":"import PIL\nfrom PIL import Image\n\nimport matplotlib.image as mpimg\nimport matplotlib.pyplot as plt\nfrom sklearn.feature_extraction.text import TfidfVectorizer,CountVectorizer\n\nimg0_test = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/test_images\/0006c8e5462ae52167402bac1c2e916e.jpg\")\nimg1_test = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/test_images\/0007585c4d0f932859339129f709bfdc.jpg\")\nimg2_test = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/test_images\/0008377d3662e83ef44e1881af38b879.jpg\")\n\n# Show result for which of the three images in the test set \nshow_what = 0\n\n# Embeddings : tf for sklearn.TfidfVectorizer, cv for sklearnCountVectorizer\nemb_what = \"tf\"\n\nif show_what == 0:\n    plt.imshow(img0_test)\n    plt.show()\n    \n    \"\"\"\n    # TF : images and cosine distance with the test image, with TfIdf embedding : \n    \n    e07c1c50cf8de8a247f93239368a4848.jpg 0.3276338786638946\n    b918ccfbb3a3d29b6e498e63eccba7e0.jpg 0.283316346467113\n    7675a77df927045ce34117a517d43bd4.jpg 0.27851394508357785\n    3a5541d69dd5707342bd7bc23d2291b5.jpg 0.257966691828448\n    2e5f4cddb8b3965f5536fecbf4c87801.jpg 0.24922339344611744\n    a19324756f5d77671bf783fa1063569a.jpg 0.24324945838406464\n    405330d0ee97a3ade425406bd10ea5c2.jpg 0.23372455870272746\n    1e7f41ef309b72ce391d60d1685d2637.jpg 0.2310358763077448\n     \n    # CV : images and cosine distance with the test image, with Count vectorizer embedding : \n    \n    e07c1c50cf8de8a247f93239368a4848.jpg 0.41666666666666674\n    2e5f4cddb8b3965f5536fecbf4c87801.jpg 0.3928371006591931\n    b918ccfbb3a3d29b6e498e63eccba7e0.jpg 0.3779644730092273\n    405330d0ee97a3ade425406bd10ea5c2.jpg 0.33333333333333326\n    658dded84a37ac2ade6357e8e74148e8.jpg 0.33333333333333326\n    7675a77df927045ce34117a517d43bd4.jpg 0.33333333333333326\n    \"\"\"\n    \n    if emb_what == \"tf\":\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/e07c1c50cf8de8a247f93239368a4848.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/b918ccfbb3a3d29b6e498e63eccba7e0.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/7675a77df927045ce34117a517d43bd4.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/3a5541d69dd5707342bd7bc23d2291b5.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/2e5f4cddb8b3965f5536fecbf4c87801.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/a19324756f5d77671bf783fa1063569a.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/405330d0ee97a3ade425406bd10ea5c2.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/1e7f41ef309b72ce391d60d1685d2637.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n    else:\n        # mse\n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/7675a77df927045ce34117a517d43bd4.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/e07c1c50cf8de8a247f93239368a4848.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n\n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/2e5f4cddb8b3965f5536fecbf4c87801.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n\n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/b918ccfbb3a3d29b6e498e63eccba7e0.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n\n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/405330d0ee97a3ade425406bd10ea5c2.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n\n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/658dded84a37ac2ade6357e8e74148e8.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n\n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/7675a77df927045ce34117a517d43bd4.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n\nelif show_what == 1:\n    plt.imshow(img1_test)\n    plt.show()\n    \n    \"\"\"\n    # TF : images and cosine distance with the test image, with TfIdf embedding : \n    aa73f68d22011d9a78a3ade4591f6d71.jpg 0.3440829874332225\n    3d3de93dca63de535a81625570b11820.jpg 0.29365592922965944\n    bf5aad615d38215a33f54dce90ec7bff.jpg 0.2890647799415893\n    3f9ec1ae4269c35f5cc7cc5640d5673c.jpg 0.28024936901967346\n    e3187b423ba8db9d4e567f5d2f6acb81.jpg 0.2751572444119632\n    70d099dddfc79f33e9c94bbea945928c.jpg 0.2727165054173051\n    4dccaba96a9115db82f0ae7607863819.jpg 0.25254420674422073\n    a6b4887fd3f9c2e787ce68289db06d1a.jpg 0.24459033973328914\n    a28d4735dbe03c594bbc2d66fb1a732b.jpg 0.241708911340054\n    c11b326cfd496718f84172d5047376ae.jpg 0.241708911340054\n    \n    \n    # CV : images and cosine distance with the test image, with Count Vectorizer embedding : \n    4dccaba96a9115db82f0ae7607863819.jpg 0.41666666666666674\n    3f9ec1ae4269c35f5cc7cc5640d5673c.jpg 0.3922322702763681\n    92c20722c5f2253e699cc3f82cca58e2.jpg 0.35533452725935066\n    aa73f68d22011d9a78a3ade4591f6d71.jpg 0.34299717028501764\n    \n    \"\"\"\n    \n    im_cv = \"4dccaba96a9115db82f0ae7607863819.jpg\" # cv, best mse\n    im_tf = \"aa73f68d22011d9a78a3ade4591f6d71.jpg\" # tf, best mse\n    \n    if emb_what == \"tf\":\n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/aa73f68d22011d9a78a3ade4591f6d71.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/3d3de93dca63de535a81625570b11820.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/bf5aad615d38215a33f54dce90ec7bff.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/3f9ec1ae4269c35f5cc7cc5640d5673c.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/e3187b423ba8db9d4e567f5d2f6acb81.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/70d099dddfc79f33e9c94bbea945928c.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/4dccaba96a9115db82f0ae7607863819.jpg\") \n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/a6b4887fd3f9c2e787ce68289db06d1a.jpg\") \n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/a28d4735dbe03c594bbc2d66fb1a732b.jpg\") \n        imgplot = plt.imshow(img0)\n        plt.show()\n        \n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/c11b326cfd496718f84172d5047376ae.jpg\") \n        imgplot = plt.imshow(img0)\n        plt.show()\n\n        \n        \n    else:\n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/4dccaba96a9115db82f0ae7607863819.jpg\") \n        imgplot = plt.imshow(img0)\n        plt.show()\n\n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/3f9ec1ae4269c35f5cc7cc5640d5673c.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n\n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/92c20722c5f2253e699cc3f82cca58e2.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n\n        img0 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/aa73f68d22011d9a78a3ade4591f6d71.jpg\")\n        imgplot = plt.imshow(img0)\n        plt.show()\n    \nelif show_what == 2:\n    plt.imshow(img2_test)\n    plt.show()\n    \n    \"\"\"\n    \n    # TF : images and cosine distance with the test image, with TfIdf embedding : \n    \n    fd4ded3cbfa2019ecfe680f3ee276a91.jpg 0.7794525029415091\n    356b48432b16923d69b144a9ac5bb35a.jpg 0.7581526109744944\n    998ddd1fd4ba143ed832719cf994827e.jpg 0.7581526109744944\n    5a1a5788c2db263b05349e73beb5d24f.jpg 0.7045959200040907\n    b3a4e8cc46adb1573a83d0151aae9e1e.jpg 0.6969638199419048\n    97d15cb38ca949438e1997a9ddc64f62.jpg 0.6661277075970812\n    5b55b6fa7ab3b284cd24bb85acda0260.jpg 0.6550338003017943\n    88ac6a087337e74d185f533d759b83ed.jpg 0.6432332325583916\n    c5fb9ee0df6e36df1b849510e17c7662.jpg 0.6420211825534895\n    8cc597b462e585cf605c593c8acbae98.jpg 0.5446627455250953\n    d848cecc47c058f3ab3396cf81bf60ed.jpg 0.479718345279202\n    33291f0cc48a5b7e127a614df7dd664a.jpg 0.47185267393098607\n    \n    \n    # CV : images and cosine distance with the test image, with CountVectorizer embedding : \n    \n    5a1a5788c2db263b05349e73beb5d24f.jpg 0.7462025072446365\n    fd4ded3cbfa2019ecfe680f3ee276a91.jpg 0.7115124735378853\n    356b48432b16923d69b144a9ac5bb35a.jpg 0.7071067811865475\n    998ddd1fd4ba143ed832719cf994827e.jpg 0.7071067811865475\n    b3a4e8cc46adb1573a83d0151aae9e1e.jpg 0.6240377207533828\n    97d15cb38ca949438e1997a9ddc64f62.jpg 0.6123724356957945\n    5b55b6fa7ab3b284cd24bb85acda0260.jpg 0.600245047998781\n    88ac6a087337e74d185f533d759b83ed.jpg 0.5833333333333334\n    c5fb9ee0df6e36df1b849510e17c7662.jpg 0.5833333333333334\n    8cc597b462e585cf605c593c8acbae98.jpg 0.5103103630798288\n    33291f0cc48a5b7e127a614df7dd664a.jpg 0.4743416490252569\n    8271e50a78f56d95f2d200984c9ba8e0.jpg 0.4330127018922194\n    3bc39f1b647b33c89217225ae20b95a8.jpg 0.4264014327112209\n    \n    \"\"\"\n    \n    \n    im_cv = \"5a1a5788c2db263b05349e73beb5d24f.jpg\"\n    im_tf = \"fd4ded3cbfa2019ecfe680f3ee276a91.jpg\"\n    \n    if emb_what == \"tf\":\n    \n        # 0.7794525029415091\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/\"+im_tf)\n        imgplot = plt.imshow(img2)\n        plt.show()\n\n         # 0.7581526109744944\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/356b48432b16923d69b144a9ac5bb35a.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n\n         # 0.7581526109744944\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/998ddd1fd4ba143ed832719cf994827e.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n\n        # 0.7045959200040907\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/\"+im_cv)\n        imgplot = plt.imshow(img2)\n        plt.show()\n\n         # 0.6969638199419048\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/b3a4e8cc46adb1573a83d0151aae9e1e.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n\n         # 0.6661277075970812\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/97d15cb38ca949438e1997a9ddc64f62.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n\n         # 0.6550338003017943\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/5b55b6fa7ab3b284cd24bb85acda0260.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n\n         # 0.6432332325583916\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/88ac6a087337e74d185f533d759b83ed.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()    \n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/c5fb9ee0df6e36df1b849510e17c7662.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/8cc597b462e585cf605c593c8acbae98.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()  \n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/d848cecc47c058f3ab3396cf81bf60ed.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/33291f0cc48a5b7e127a614df7dd664a.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n        \n    elif emb_what == \"cv\":  \n        # mse\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/356b48432b16923d69b144a9ac5bb35a.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n        \n        # mse\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/998ddd1fd4ba143ed832719cf994827e.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/\"+im_cv)\n        imgplot = plt.imshow(img2)\n        plt.show()\n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/\"+im_tf)\n        imgplot = plt.imshow(img2)\n        plt.show()\n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/356b48432b16923d69b144a9ac5bb35a.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/998ddd1fd4ba143ed832719cf994827e.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/b3a4e8cc46adb1573a83d0151aae9e1e.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/97d15cb38ca949438e1997a9ddc64f62.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/5b55b6fa7ab3b284cd24bb85acda0260.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/88ac6a087337e74d185f533d759b83ed.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()  \n        \n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/c5fb9ee0df6e36df1b849510e17c7662.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/8cc597b462e585cf605c593c8acbae98.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()  \n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/33291f0cc48a5b7e127a614df7dd664a.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/8271e50a78f56d95f2d200984c9ba8e0.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/3bc39f1b647b33c89217225ae20b95a8.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/4dccaba96a9115db82f0ae7607863819.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/3f9ec1ae4269c35f5cc7cc5640d5673c.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()  \n        \n        \n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/92c20722c5f2253e699cc3f82cca58e2.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n\n        img2 = mpimg.imread(\"\/kaggle\/input\/shopee-product-matching\/train_images\/aa73f68d22011d9a78a3ade4591f6d71.jpg\")\n        imgplot = plt.imshow(img2)\n        plt.show()\n        \n\nelse:\n    pass\n    ","c46715ab":"Here is the result I obtained on the 3 images of the test set, using only text information, embeddings with TfidfVectorizer and CountVectorizer, and cosine distance. \n\nI fixed the upper bound of the cosine result at ` > MEAN + 5 * STD`\n\nI kept the stop words as well as tokens containing numbers, as the result was better than when deleting them. I mentioned the cosine distance for each image.\n\nThis is the result for one of the images of the test set. If you want to see the result for another tst image, you must change the value of variable `show_what`. \n\nThe displayed result concerns embedding with TfIdf. You can see also the result with CountVectorizer, by changing the variable `emb_what` to `cv`. "}}