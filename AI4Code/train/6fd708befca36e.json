{"cell_type":{"c54e622c":"code","41b8a667":"code","e894d44c":"code","e8069d3f":"code","4558611d":"code","3f31162e":"code","cd2f528f":"code","00c2e77d":"code","460113c5":"code","93f50bcb":"code","7738c606":"code","95cdc315":"code","1f2bf530":"markdown","0364a098":"markdown","b589278d":"markdown","0587317a":"markdown","cf333275":"markdown"},"source":{"c54e622c":"import pandas as pd\ndf_submission = pd.read_csv(\"..\/input\/semaine-ia-reddit-challenge\/test.csv\")\ndf = pd.read_csv(\"..\/input\/semaine-ia-reddit-challenge\/train.csv\")\ndf.head()","41b8a667":"print(sum(df[\"subreddit\"] == \"gameofthrones\"))\nprint(sum(df[\"subreddit\"] == \"gaming\"))\nprint(sum(df[\"subreddit\"] == \"funny\"))\nprint(sum(df[\"subreddit\"] == \"news\"))\nprint(sum(df[\"subreddit\"] == \"politics\"))\nprint(sum(df[\"subreddit\"] == \"science\"))","e894d44c":"labels = pd.get_dummies(df[\"subreddit\"],prefix='subreddit')\nlabels.head()","e8069d3f":"y_data = labels.values\ncomments = df[\"comment\"].values","4558611d":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(comments, y_data, test_size=0.2, random_state=42)","3f31162e":"from sklearn.feature_extraction.text import TfidfVectorizer\nvectorizer = TfidfVectorizer()\nX_train = vectorizer.fit_transform(X_train)\nX_test = vectorizer.transform(X_test)\nX_train","cd2f528f":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import f1_score\n\nknn_classifier = KNeighborsClassifier(n_neighbors=10)\nknn_classifier.fit(X_train, y_train)\ny_pred = knn_classifier.predict(X_test)\n\nf1_score(y_test, y_pred, average='macro')","00c2e77d":"comments_submission = df_submission[\"comment\"].values\nsubmission_tfidf = vectorizer.transform(comments_submission)\n\nsubmission_tfidf","460113c5":"y_submission = knn_classifier.predict(submission_tfidf)\ndf_sub_preds = pd.DataFrame(y_submission)","93f50bcb":"def one_hot_to_subreddit(a):\n    if a[0]:\n        return \"funny\"\n    elif a[1]:\n        return \"gameofthrones\"\n    elif a[2]:\n        return \"gaming\"\n    elif a[3]:\n        return \"news\"\n    elif a[4]:\n        return \"politics\"\n    elif a[5]:\n        return \"science\"\n    else:\n        return \"politics\"","7738c606":"df_sub_preds[\"subreddit\"] = df_sub_preds.apply(lambda a: one_hot_to_subreddit(a), axis=1)\nsubmission = pd.DataFrame()\nsubmission[\"id\"] = df_submission[\"id\"]\nsubmission[\"subreddit\"] = df_sub_preds[\"subreddit\"]\n\nsubmission","95cdc315":"submission.to_csv(\"knn_submission.csv\", index=False)","1f2bf530":"## G\u00e9n\u00e9ration d'un fichier de soumission\n\n### Effectuer les pr\u00e9dictions","0364a098":"### One-hot","b589278d":"# Exemple - piste de solution\nExemples d'entra\u00eenement, validation locale et g\u00e9n\u00e9ration de fichier de soumission pour le challenge Kaggle\n\n## Chargement des donn\u00e9es","0587317a":"## Apprentissage\n\n### TF-IDF","cf333275":"### KNN"}}