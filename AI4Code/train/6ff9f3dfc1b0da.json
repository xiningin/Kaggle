{"cell_type":{"1fa35317":"code","8ca609e2":"code","d3740414":"code","039218c0":"code","629fc658":"code","e479dee8":"code","2917d0da":"code","34f1bcea":"code","4ce2fe84":"code","45c0da7c":"code","a5643758":"code","17079e1e":"code","f0ec7a16":"code","ce8c2af3":"code","714d0090":"code","12843e38":"code","da0ae65a":"code","6ec98ad9":"code","9c72c9d4":"code","d2fbcf3f":"code","b73615d0":"markdown","df5357db":"markdown","ae4e961c":"markdown","413175e3":"markdown","9a56964c":"markdown","8435ec51":"markdown","9c0e6309":"markdown","5d9bb47e":"markdown","ee408a54":"markdown","04a0e4de":"markdown","dce3507c":"markdown","63be7489":"markdown","740dbf67":"markdown","21853e4d":"markdown","b8f87829":"markdown"},"source":{"1fa35317":"import numpy as np\nfrom matplotlib import pyplot as plt\n\nfrom sklearn import linear_model, datasets","8ca609e2":"N_SAMPLES = 1000\nN_FEATURES = 1\nN_INFORMATIVE = 1\nNOISE = 10\nN_OUTLIERS = 50\nIS_COEF = True\nRAMDOM_SEED = 0\n\nLINE_WIDTH = 5\nX_LABEL = \"input\"\nY_LABEL = \"output\"\nLEGEND_LOC = \"lower right\"","d3740414":"X, y, coef = datasets.make_regression(\n    n_samples=N_SAMPLES,\n    n_features=N_FEATURES,\n    n_informative=N_INFORMATIVE,\n    noise=NOISE,\n    coef=IS_COEF,\n    random_state=RAMDOM_SEED,\n)","039218c0":"X.shape","629fc658":"X[:5]","e479dee8":"np.random.seed(0)\nX[:N_OUTLIERS] = 3 + 0.5 * np.random.normal(size=(N_OUTLIERS, 1))\ny[:N_OUTLIERS] = -3 + 10 * np.random.normal(size=N_OUTLIERS)","2917d0da":"# Fit line using all data\nlr = linear_model.LinearRegression()\nlr.fit(X, y)","34f1bcea":"# Robustly fit linear model with RANSAC algorithm\nransac = linear_model.RANSACRegressor()\nransac.fit(X, y)","4ce2fe84":"lasso = linear_model.Lasso(alpha=2.5)\nlasso.fit(X, y)","45c0da7c":"ridge = linear_model.Ridge(alpha=2.5)\nridge.fit(X, y)","a5643758":"elasticNet = linear_model.ElasticNet(alpha=2.5)\nelasticNet.fit(X, y)","17079e1e":"inlier_mask = ransac.inlier_mask_\noutlier_mask = np.logical_not(inlier_mask)","f0ec7a16":"line_X = np.arange(X.min(), X.max())[:, np.newaxis]","ce8c2af3":"line_y = lr.predict(line_X)","714d0090":"line_y_ransac = ransac.predict(line_X)","12843e38":"line_y_lasso = lasso.predict(line_X)","da0ae65a":"line_y_ridge = ridge.predict(line_X)","6ec98ad9":"line_y_elesticNet = elasticNet.predict(line_X)","9c72c9d4":"print(\"Estimated coefficients (true, linear regression, RANSAC):\")\nprint(\"original coefficient = \",coef)\nprint(\"linear coefficient = \",lr.coef_)\nprint(\"RANSAC coefficient = \",ransac.estimator_.coef_)\nprint(\"lasso coefficient = \",lasso.coef_)\nprint(\"ridge coefficient = \",ridge.coef_)\nprint(\"elasticNet coefficient = \",elasticNet.coef_)","d2fbcf3f":"plt.figure(figsize=(12,8))\n# inlier mask scatter\nplt.scatter(X[inlier_mask], y[inlier_mask], color=\"yellowgreen\", marker=\".\", label=\"Inliers\")\n\n# outler mask scatter\nplt.scatter(X[outlier_mask], y[outlier_mask], color=\"gold\", marker=\".\", label=\"Outliers\")\n\n# linear model plot \nplt.plot(line_X, line_y, color=\"navy\", linewidth=LINE_WIDTH, label=\"Linear regressor\",alpha = 0.5)\n\n# RANSAC model plot\nplt.plot(line_X,line_y_ransac,color=\"cornflowerblue\",linewidth=LINE_WIDTH,label=\"RANSAC regressor\",alpha = 0.5)\n\n# ridge model plot\nplt.plot(line_X,line_y_lasso,color=\"r\",linewidth=LINE_WIDTH,label=\"Lasso regressor\",alpha = 0.5)\n\n# lasso model plot\nplt.plot(line_X,line_y_ridge,color=\"b\",linewidth=LINE_WIDTH,label=\"Ridge regressor\",alpha = 0.5)\n\n# elesticNet model plot\nplt.plot(line_X,line_y_elesticNet,color=\"g\",linewidth=LINE_WIDTH,label=\"ElesticNet regressor\",alpha = 0.5)\n\nplt.legend(loc=LEGEND_LOC)\nplt.xlabel(X_LABEL)\nplt.ylabel(Y_LABEL)\nplt.show()","b73615d0":"# defind global variables","df5357db":"# predict test data using RANSACRegressor model","ae4e961c":"# add outlier data ","413175e3":"#### original coef is almost same with ransac coef.","9a56964c":"# predict test data using LinearRegression model","8435ec51":"# make data ","9c0e6309":"# draw scatter + draw plot + set legend and label","5d9bb47e":"# make Ridge model ","ee408a54":"# make Lasso model","04a0e4de":"# import libraries","dce3507c":"# make RANSACRegressor model","63be7489":"# get inline mask and outline mask ","740dbf67":"# make test data ","21853e4d":"# make LinearRegression model","b8f87829":"# get coefficient (original , linear model, ransac model)"}}