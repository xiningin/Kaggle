{"cell_type":{"185a9546":"code","9367fe4d":"code","ed93a28d":"code","758c13cd":"code","9b2bac49":"code","5f3f9f58":"code","fdc7a559":"markdown","6147af2f":"markdown","e2e33c8e":"markdown","b06f058e":"markdown"},"source":{"185a9546":"# Start by importing the bq_helper module and calling on the specific active_project and dataset_name for the BigQuery dataset.\nimport bq_helper\nfrom bq_helper import BigQueryHelper\n# https:\/\/www.kaggle.com\/sohier\/introduction-to-the-bq-helper-package\n\nwdi = bq_helper.BigQueryHelper(active_project=\"patents-public-data\",\n                                   dataset_name=\"worldbank_wdi\")","9367fe4d":"# View table names under the worldbank_wdi data table\nbq_assistant = BigQueryHelper(\"patents-public-data\", \"worldbank_wdi\")\nbq_assistant.list_tables()","ed93a28d":"# View the first three rows of the wdi_2016 data table\nbq_assistant.head(\"wdi_2016\", num_rows=3)","758c13cd":"# View information on all columns in the wdi_2016 data table\nbq_assistant.table_schema(\"wdi_2016\")","9b2bac49":"query1 = \"\"\"\nSELECT\n  country_name, indicator_value\nFROM\n  `patents-public-data.worldbank_wdi.wdi_2016`\nORDER BY \n  indicator_value DESC\nLIMIT\n  20;\n        \"\"\"\nresponse1 = wdi.query_to_pandas_safe(query1)\nresponse1.head(20)","5f3f9f58":"bq_assistant.estimate_query_size(query1)","fdc7a559":"## Example SQL Query\n\nWhich countries have the highest indicator values?","6147af2f":"## Importance of Knowing Your Query Sizes\n\nIt is important to understand how much data is being scanned in each query due to the free 5TB per month quota. For example, if a query is formed that scans all of the data in a particular column, given how large BigQuery datasets are it wouldn't be too surprising if it burns through a large chunk of that monthly quota!\n\nFortunately, the bq_helper module gives us tools to very easily estimate the size of our queries before running a query. Start by drafting up a query using BigQuery's Standard SQL syntax. Next, call the estimate_query_size function which will return the size of the query in GB. That way you can get a sense of how much data is being scanned before actually running your query.","e2e33c8e":"# How to Query World Development Indicators Data (BigQuery)\n[Click here](https:\/\/www.kaggle.com\/mrisdal\/safely-analyzing-github-projects-popular-licenses) for a detailed notebook demonstrating how to use the bq_helper module and best practises for interacting with BigQuery datasets.","b06f058e":"Interpretting this number, this means my query scanned about ~0.45 GB (or 450 MB) of data in order to return a table of top 20 countries by high indicator value in the dataset."}}