{"cell_type":{"ad44d56a":"code","cdc02a5b":"code","91d28d62":"code","5dc1c066":"code","e79abe3a":"code","24d2e086":"code","ee7d646c":"code","9a04d25e":"code","d464b31d":"code","ce6f0429":"code","6d084ac5":"code","a8a0bad0":"code","19dfaaa5":"code","93adb968":"code","428ad7a8":"code","b57c10be":"code","a4185841":"code","2fb84ff8":"code","935485d7":"code","5ed1ac0a":"code","1fee5dd7":"code","724533fc":"code","6351472f":"code","6d56030f":"code","05c7cc96":"code","7f64f768":"code","6b7f0730":"code","fccba677":"code","d6ab5d78":"code","b05b8e17":"code","f44321a0":"code","2cae93a6":"code","7425af26":"code","8e5592a1":"code","4cbe21d4":"code","921f4937":"code","68c377d9":"code","71ced8b5":"code","28f1ff9a":"code","d71950f2":"code","ee868443":"code","a5702d37":"code","dabb10ff":"code","ea29e54b":"code","254da01f":"code","1dddbd31":"code","8c0f06e1":"code","44a97d00":"code","342d675e":"code","73181f94":"code","4b83d062":"code","2f6542d3":"code","ba312443":"code","e3dc51c6":"code","de73ee22":"code","00bbb521":"code","08a76ded":"code","09d01719":"code","50afd786":"code","47758d89":"markdown","24c64bf1":"markdown","fea18b02":"markdown","9a5b7280":"markdown","3bb83327":"markdown","ac717d2d":"markdown","a5dd5c36":"markdown"},"source":{"ad44d56a":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","cdc02a5b":"df = pd.read_csv('..\/input\/drug-classification\/drug200.csv')","91d28d62":"df.head()","5dc1c066":"df.isnull().sum()","e79abe3a":"df.describe()","24d2e086":"df.info()","ee7d646c":"df['Drug'].unique()","9a04d25e":"df['Drug'] = df['Drug'].transform(lambda value: value[-1])","d464b31d":"df['Drug']","ce6f0429":"df.head()","6d084ac5":"sns.countplot(x='Drug',data=df)","a8a0bad0":"sns.countplot(x='Drug',hue='Sex',data=df)","19dfaaa5":"sns.boxplot(x='Age',y='Drug',hue='Sex',data=df)","93adb968":"sns.countplot(x='Cholesterol',data=df)","428ad7a8":"sns.countplot(x='BP',data=df)","b57c10be":"sns.countplot(x='Sex',data=df)","a4185841":"sns.jointplot(data=df,x='Age',y='Na_to_K',kind='hex')","2fb84ff8":"sns.catplot(data=df,x='Sex',y='Age',kind='box',\n           col='Cholesterol',row='BP')","935485d7":"sns.displot(x='Age',col='Sex',data=df,bins=15,kde=True)","5ed1ac0a":"plt.figure(figsize=(6,4),dpi=200)\nsns.scatterplot(x='Age',y='Na_to_K',hue='Drug',data=df)\nplt.legend(bbox_to_anchor=(1.3,0.7),title='Drug Type')","1fee5dd7":"df['BP'].unique()","724533fc":"df['Cholesterol'].unique()","6351472f":"bp_map = {'LOW':0,'NORMAL':1,'HIGH':2}","6d56030f":"df['BP'] = df['BP'].replace(bp_map)","05c7cc96":"df.head()","7f64f768":"dummie_df  = pd.get_dummies(df[['Cholesterol','Sex']],drop_first=True)","6b7f0730":"dummie_df","fccba677":"df = pd.concat([df,dummie_df],axis=1)","d6ab5d78":"df.head()","b05b8e17":"df = df.drop(['Sex','Cholesterol'],axis=1)","f44321a0":"df.head()","2cae93a6":"df = df[['Age','Sex_M','BP','Cholesterol_NORMAL','Na_to_K','Drug']]","7425af26":"df.head()","8e5592a1":"df.columns = ['Age','Sex_Male','BP','Cholesterol_Normal','Na_to_K','Drug']","4cbe21d4":"df.head()","921f4937":"X = df.drop('Drug',axis=1)","68c377d9":"y = df['Drug']","71ced8b5":"from sklearn.model_selection import train_test_split","28f1ff9a":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.15, random_state=101)","d71950f2":"from sklearn.model_selection import GridSearchCV","ee868443":"n_estimators = [64,100,128,200]","a5702d37":"max_features = [2,3,4,5]","dabb10ff":"bootstrap = [True,False]","ea29e54b":"param_grid = {'n_estimators':n_estimators,\n             'max_features':max_features,\n             'bootstrap':bootstrap}","254da01f":"from sklearn.ensemble import RandomForestClassifier","1dddbd31":"rfc = RandomForestClassifier()","8c0f06e1":"grid = GridSearchCV(rfc,param_grid)","44a97d00":"grid.fit(X_train,y_train)","342d675e":"grid.best_params_","73181f94":"predictions = grid.predict(X_test)","4b83d062":"predictions","2f6542d3":"y_test","ba312443":"from sklearn.metrics import plot_confusion_matrix,classification_report,accuracy_score","e3dc51c6":"plot_confusion_matrix(grid,X_test,y_test)","de73ee22":"print(classification_report(y_test,predictions))","00bbb521":"errors = []\nmisclassifications = []\n\nfor n in range(1,200):\n    rfc = RandomForestClassifier(n_estimators=n,max_features=2)\n    rfc.fit(X_train,y_train)\n    preds = rfc.predict(X_test)\n    err = 1 - accuracy_score(y_test,preds)\n    n_missed = np.sum(preds != y_test)\n    \n    errors.append(err)\n    misclassifications.append(n_missed)","08a76ded":"plt.plot(range(1,200),errors)","09d01719":"plt.plot(range(1,200),misclassifications)","50afd786":"# Performance starts to level off at around 13 decision trees","47758d89":"# Random Forests Using GridSearchCV and Parameter Search","24c64bf1":"**Predicted label:**\n\n- Drug type\n\n**Features:**\n\n- Age of patient\n- Sex of patient\n- Blood Pressure Levels (BP)\n- Cholesterol Levels\n- Na to Potassium Ratio","fea18b02":"### Ordinal Encoding","9a5b7280":"# Exploratory Data Analysis","3bb83327":"# Performance Evaluation","ac717d2d":"# Feature Engineering ","a5dd5c36":" ### One-Hot Encoding"}}