{"cell_type":{"d8926923":"code","02e2213d":"code","e7cbdee4":"code","68c22acb":"code","fa8aab1b":"code","573d4e37":"code","9616e1ae":"code","eda02382":"code","b7e834fa":"code","7d85adaa":"markdown"},"source":{"d8926923":"!pip install banet","02e2213d":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport scipy.io as sio\nfrom banet.core import InOutPath\nfrom banet.predict import predict_one","e7cbdee4":"# List weight files to use to generate the model outputs\nweights_path = '\/kaggle\/input\/banet-pretrained-weights\/'\nweight_files = ['banetv0.20-val2017-fold0.pth','banetv0.20-val2017-fold1.pth','banetv0.20-val2017-fold2.pth']\nweight_files = [weights_path + o for o in weight_files]","68c22acb":"region = 'AU2020'\npath = InOutPath('\/kaggle\/input\/australia-bushfires-viirs-750m-daily', 'output')\ntimes = pd.DatetimeIndex([pd.Timestamp(o.stem.split('_')[-1]) for o in sorted((path\/region).src.ls())])\nprint(times[0], times[-1])","fa8aab1b":"tstart, tend = times.min(), times.max()\nmonth_start = (tstart + pd.Timedelta(days=31)).month","573d4e37":"# Generate the monthly product for the months of October 2019 to January 2020\nptimes = ['2019-10-01', '2019-11-01', '2019-12-01', '2020-01-01']\nptimes = [pd.Timestamp(o) for o in ptimes]\npreds_all = []\nfor time in ptimes:\n    time_start = pd.Timestamp((time - pd.Timedelta(days=30)).strftime('%Y-%m-15')) # Day 15, previous month\n    times = pd.date_range(time_start, periods=64, freq='D')\n    preds = predict_one(path, times, weight_files, region)\n    preds = preds[times.month == time.month]\n    preds_all.append(preds)\npreds_all = np.concatenate(preds_all, axis=0)","9616e1ae":"preds_all.shape","eda02382":"# Calculate confidence level and dates of burning\nba = preds_all.sum(0)\nba[ba>1] = 1\nba[ba<0.05] = np.nan # Set as nan pixels with confidence level bellow 0.05\nbd = preds_all.argmax(0)\nbd = bd.astype(float)\nbd[np.isnan(ba)] = np.nan","b7e834fa":"# Plot results\nfig, axes = plt.subplots(ncols=2, figsize=(12,7), dpi=300)\nim = axes[0].imshow(ba, cmap='jet', vmin=0, vmax=1)\nfig.colorbar(im, ax=axes[0])\naxes[0].set_title('Confidence level')\nim = axes[1].imshow(bd, cmap='RdYlGn_r')\naxes[1].set_title('Burndate (starting at 2019-10-01)')\nfig.colorbar(im, ax=axes[1])\nfig.tight_layout()","7d85adaa":"# Mapping and dating recent Eastern Australia fires with BA-Net\nIn this kernel it is shown how to use BA-Net to map and date the recent extreme bushfires in eastern Australia. The preprocessed input data is provided as a public dataset.\n\nMore information about the methodology:\n* Github: https:\/\/github.com\/mnpinto\/banet\n* Article: https:\/\/authors.elsevier.com\/a\/1aN0a3I9x1YsQn\n* Blog post: https:\/\/link.medium.com\/vNOfYcZod4"}}