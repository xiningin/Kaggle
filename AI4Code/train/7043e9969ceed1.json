{"cell_type":{"a5b10272":"code","4654ffbc":"code","4215dd5e":"code","d31b7b5e":"code","82a65430":"code","a40d28fa":"code","5a1b6684":"code","c03c6da3":"code","3002f64a":"code","95ad3e48":"code","b0254210":"code","dc1e5067":"code","1b4c89cf":"code","6325b41d":"code","25a79451":"code","c15fe4d2":"code","5d09030e":"code","77ba9048":"code","1f3aae23":"code","8d6dd6a4":"code","11042c1f":"code","58442b6f":"code","8069c43a":"code","a7a68450":"markdown","d4c5cd4e":"markdown","24f20710":"markdown","9a34affb":"markdown","ff6101b0":"markdown","2048d9ba":"markdown","b1b83dae":"markdown","4375de32":"markdown","8dd8654e":"markdown","263208b2":"markdown","b4bf53bd":"markdown","63434f84":"markdown","66b37624":"markdown","ef7291eb":"markdown","ff611dc0":"markdown","675e866a":"markdown","2b6806df":"markdown","a89cbb62":"markdown","d4cf8441":"markdown","46eeecb8":"markdown","f578b6fa":"markdown","3f1ccadd":"markdown","1ef315c1":"markdown","322d2df5":"markdown","7d6789f3":"markdown"},"source":{"a5b10272":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nfrom sklearn.linear_model import LinearRegression \n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","4654ffbc":"sub=pd.read_csv(\"..\/input\/covid19-local-us-ca-forecasting-week-1\/ca_submission.csv\")\ntest=pd.read_csv(\"..\/input\/covid19-local-us-ca-forecasting-week-1\/ca_test.csv\")\ntrain=pd.read_csv(\"..\/input\/covid19-local-us-ca-forecasting-week-1\/ca_train.csv\")","4215dd5e":"print(train.shape)\ntrain.head()","d31b7b5e":"#Only taking data with confirmed cases\ntrain=train[train.ConfirmedCases>0]\nprint(train.shape)\ntrain.head()","82a65430":"sns.lineplot(train.Id, train.ConfirmedCases)","a40d28fa":"sns.regplot(train.Id, np.log(train.ConfirmedCases))","5a1b6684":"model_1= LinearRegression()\nx1=np.array(train.Id).reshape(-1,1)\ny1=np.log(train.ConfirmedCases)\nmodel_1.fit(x1,y1)\nprint(\"R-squared score : \",model_1.score(x1,y1))\n\ngr=np.power(np.e, model_1.coef_[0])\nprint(\"Growth Factor : \", gr)\nprint(f\"Growth Rate : {round((gr-1)*100,2)}%\")","c03c6da3":"sns.regplot(train.ConfirmedCases,train.Fatalities)","3002f64a":"model_2= LinearRegression()\nx2=np.array(train.ConfirmedCases).reshape(-1,1)\ny2=train.Fatalities\nmodel_2.fit(x2,y2)\nmodel_2.score(x2,y2)","95ad3e48":"test.head()","b0254210":"#Making Id as unique key between test and train\ntest[\"Id\"]=50+test.ForecastId\ntest.head()","dc1e5067":"test[\"LogConf\"]=model_1.predict(np.array(test.Id).reshape(-1,1))\ntest[\"ConfirmedCases\"]=np.exp(test.LogConf)\/\/1\ntest[\"Fatalities\"]=model_2.predict(np.array(test.ConfirmedCases).reshape(-1,1))\/\/1","1b4c89cf":"#Wherever confirmed cases and fatalities are available in train data, update it into test data\nfor id in train.Id:\n    test.ConfirmedCases[test.Id==id]=train.ConfirmedCases[train.Id==id].sum()\n    test.Fatalities[test.Id==id]=train.Fatalities[train.Id==id].sum()","6325b41d":"test[\"Conf_d1\"]=test.ConfirmedCases\ntest[\"Fat_d1\"]=test.Fatalities\n\nrate=gr-1\nfor i in range(train.shape[0]-2,test.shape[0]):\n    rate*=0.99\n    test.Conf_d1[i]=(1+rate)*test.Conf_d1[i-1]\/\/1\n    test.Fat_d1[i]=model_2.predict(np.array(test.Conf_d1[i]).reshape(-1,1))[0]\/\/1","25a79451":"test[\"Conf_d5\"]=test.ConfirmedCases\ntest[\"Fat_d5\"]=test.Fatalities\n\nrate=gr-1\nfor i in range(train.shape[0]-2,test.shape[0]):\n    rate*=0.95\n    test.Conf_d5[i]=(1+rate)*test.Conf_d5[i-1]\/\/1\n    test.Fat_d5[i]=model_2.predict(np.array(test.Conf_d5[i]).reshape(-1,1))[0]\/\/1","c15fe4d2":"test[\"Conf_i1\"]=test.ConfirmedCases\ntest[\"Fat_i1\"]=test.Fatalities\n\nrate=gr-1\nfor i in range(train.shape[0]-2,test.shape[0]):\n    rate*=1.01\n    test.Conf_i1[i]=(1+rate)*test.Conf_i1[i-1]\/\/1\n    test.Fat_i1[i]=model_2.predict(np.array(test.Conf_i1[i]).reshape(-1,1))[0]\/\/1","5d09030e":"test[\"Conf_15\"]=test.ConfirmedCases\ntest[\"Fat_15\"]=test.Fatalities\n\nrate=1.15\nfor i in range(train.shape[0]-2,test.shape[0]):\n    test.Conf_15[i]=rate*test.Conf_15[i-1]\/\/1\n    test.Fat_15[i]=model_2.predict(np.array(test.Conf_15[i]).reshape(-1,1))[0]\/\/1","77ba9048":"test[\"Conf_20\"]=test.ConfirmedCases\ntest[\"Fat_20\"]=test.Fatalities\n\nrate=1.20\nfor i in range(train.shape[0]-2,test.shape[0]):\n    test.Conf_20[i]=rate*test.Conf_20[i-1]\/\/1\n    test.Fat_20[i]=model_2.predict(np.array(test.Conf_20[i]).reshape(-1,1))[0]\/\/1","1f3aae23":"test[\"Conf_25\"]=test.ConfirmedCases\ntest[\"Fat_25\"]=test.Fatalities\n\nrate=1.25\nfor i in range(train.shape[0]-2,test.shape[0]):\n    test.Conf_25[i]=rate*test.Conf_25[i-1]\/\/1\n    test.Fat_25[i]=model_2.predict(np.array(test.Conf_25[i]).reshape(-1,1))[0]\/\/1","8d6dd6a4":"test[\"Conf_30\"]=test.ConfirmedCases\ntest[\"Fat_30\"]=test.Fatalities\n\nrate=1.30\nfor i in range(train.shape[0]-2,test.shape[0]):\n    test.Conf_30[i]=rate*test.Conf_30[i-1]\/\/1\n    test.Fat_30[i]=model_2.predict(np.array(test.Conf_30[i]).reshape(-1,1))[0]\/\/1","11042c1f":"plt.figure(figsize=(12,8))\nsns.lineplot(test.Id, test.Conf_20, label=\"Constant 20%\")\nsns.lineplot(test.Id, test.Conf_25, label=\"Constant 25%\")\nsns.lineplot(test.Id, test.Conf_30, label=\"Constant 30%\", dashes=True)\nsns.lineplot(test.Id, test.Conf_15, label=\"Constant 15%\")\nsns.lineplot(test.Id, test.Conf_i1, label=\"Increasing by 1%\")\nsns.lineplot(test.Id, test.Conf_d1, label=\"Decreasing by 1%\")\nsns.lineplot(test.Id, test.Conf_d5, label=\"Decreasing by 5%\")\nsns.lineplot(test.Id, test.ConfirmedCases, label=\"Current Rate\")\nsns.lineplot(train.Id, train.ConfirmedCases, label=\"Train Data\")\nplt.legend()\nplt.show()","58442b6f":"plt.figure(figsize=(12,8))\nsns.lineplot(test.Id, test.Fat_25, label=\"Constant 25%\")\nsns.lineplot(test.Id, test.Fat_20, label=\"Constant 20%\")\nsns.lineplot(test.Id, test.Fat_30, label=\"Constant 30%\")\nsns.lineplot(test.Id, test.Fat_15, label=\"Constant 15%\")\nsns.lineplot(test.Id, test.Fat_i1, label=\"Increasing by 1%\")\nsns.lineplot(test.Id, test.Fat_d1, label=\"Decreasing by 1%\")\nsns.lineplot(test.Id, test.Fat_d5, label=\"Decreasing by 5%\")\nsns.lineplot(test.Id, test.Fatalities, label=\"Current Rate\")\nsns.lineplot(train.Id, train.Fatalities, label=\"Train Data\")\nplt.legend()\nplt.show()","8069c43a":"sub.ConfirmedCases=test.ConfirmedCases\nsub.Fatalities=test.Fatalities\nsub.to_csv(\"submission.csv\", index=False)","a7a68450":"### Predicting the Confirmed Cases and Fatalities for test data","d4c5cd4e":"### For Confirmed Cases increasing at a increasing Rate","24f20710":"### Prepare submission file","9a34affb":"### What is the point of prediting the past!","ff6101b0":"### Visualization Id vs log(Confirmed Cases)","2048d9ba":"### Visualization ID vs confirmed cases","b1b83dae":"Assumption:\n* Growth Rate is constant at 25%","4375de32":"### EDA train","8dd8654e":"Assumption:\n* Growth Rate is constant 15% ","263208b2":"### For Confirmed Cases increasing at a constant rate","b4bf53bd":"### Confirmed Cases vs Fatalities","63434f84":"### Evaluation of Regression fit","66b37624":"Assumption:\n* Growth Rate is increasing by 1% every day","ef7291eb":"Assumption:\n* Growth Rate is constant at 30%","ff611dc0":"### Import Libraries","675e866a":"Assumption: 2\n* Growth Rate is decreasing by 5% every day","2b6806df":"R-squared score of 0.9973927213202164 shows that confirmed cases is increasing exponentially with index(date)","a89cbb62":"### Read Data","d4cf8441":"From the train data, number of fatalities varies directly proportional to Number of Confirmed cases.\n* Further exploration needs to be done to check how it behaves when confirmed cases overwhelms the health infrastructure.\n* This can be done using dataset of heavily affected areas with comparable health infrastructure like Italy, France, Spain etc.","46eeecb8":"*Assumption* \n* Rate of increase in confirmed cases for ensuing period = 22.54%\n* Fatalities change linearly with confirmed cases","f578b6fa":"### EDA test data","3f1ccadd":"### Evaluation of Regression fit","1ef315c1":"Assumption:\n* Growth Rate is constant 20% ","322d2df5":"Assumption: 1\n* Growth Rate is decreasing by 1% every day","7d6789f3":"### For Confirmed Cases increasing at a decreasing Rate"}}