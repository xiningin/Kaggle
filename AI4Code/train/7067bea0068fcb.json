{"cell_type":{"2102e88c":"code","033ffaa0":"code","e1122c13":"code","4d86c577":"code","da6435e4":"code","c2a7116f":"code","5c17b32c":"code","20c734f6":"code","0f8f81b2":"code","9c4e5470":"code","c090c4ed":"code","849cb422":"code","cf77673b":"code","b80a7669":"code","da890215":"code","6ac6f8b0":"code","00e784a2":"code","0fcec7b5":"code","f1f12b9d":"code","5bd4d32e":"code","0fab9f34":"code","1ca56d4c":"code","d9f63dd4":"code","0e2f7c2a":"code","204bc86d":"code","531d1d85":"code","98c049ee":"code","41611566":"code","d8287744":"code","2abd64a5":"code","bf24c6c0":"code","92df7c20":"code","65e85343":"code","49758bc4":"code","ea75d1c6":"code","9584ea97":"code","8ff86b8f":"code","93855bda":"code","8c3e368c":"code","db911bcf":"code","ecbef39a":"code","26d94e63":"code","aa7fb1da":"code","8df0118c":"code","d355cb9a":"code","eacb6c54":"code","aae16676":"code","4530a13c":"code","9b15a9c4":"code","0759af55":"code","d1949932":"code","95c64725":"code","a7e64d6e":"code","fe2525de":"code","778433e5":"code","5a658b1c":"code","304f52bd":"code","f4fb8f96":"code","d050ffde":"markdown","2c9b1d7e":"markdown","cf4be993":"markdown","09aa9fad":"markdown","57d29c72":"markdown","aa12f145":"markdown","5dbf4caa":"markdown","ff8dfc68":"markdown","0522cd4a":"markdown","667f557c":"markdown","d03bac45":"markdown","cc962a63":"markdown","ce4b3610":"markdown","29b6a96f":"markdown","102597ad":"markdown"},"source":{"2102e88c":"import numpy as np\nimport pandas as pd","033ffaa0":"df = pd.read_csv('..\/input\/advertising\/Advertising.csv', index_col = 0)","e1122c13":"df.head()","4d86c577":"df.describe().T","da6435e4":"df.info()","c2a7116f":"import seaborn as sns\nsns.jointplot(x = 'TV',y = 'sales', data = df, kind ='reg');","5c17b32c":"df.head()","20c734f6":"from sklearn.linear_model import LinearRegression","0f8f81b2":"X = df[['TV']]\nX.head()","9c4e5470":"y = df[['sales']]\ny.head()","c090c4ed":"reg_model = LinearRegression()\nreg_model.fit(X,y)","849cb422":"reg_model","cf77673b":"reg_model.intercept_","b80a7669":"reg_model.coef_","da890215":"reg_model.score(X,y)","6ac6f8b0":"7.03 + 0.04*40","00e784a2":"import seaborn as sns\nimport matplotlib.pyplot as plt\ng = sns.regplot(df['TV'], df['sales'],ci = None, scatter_kws={'color':'r','s':9})\ng.set_title('Model Denklemi: Sales = 7.03 + TV*0.05')\ng.set_ylabel('Satis Sayisi')\ng.set_xlabel('TV Harcamalari')\nplt.xlim(-10,310)\nplt.ylim(bottom=0);","0fcec7b5":"reg_model.intercept_ + reg_model.coef_*165","f1f12b9d":"reg_model.predict([[165]])","5bd4d32e":"new_data = [[5],[15],[30]]\nreg_model.predict(new_data)","0fab9f34":"X = df.drop('sales', axis=1)\ny = df[['sales']]","1ca56d4c":"reg_model = LinearRegression()","d9f63dd4":"reg_model.fit(X,y)","0e2f7c2a":"reg_model.intercept_","204bc86d":"reg_model.coef_","531d1d85":"2.94 + 30*0.04 + 10*0.19 - 40*0.001","98c049ee":"new_dat = [[300],[120],[400]]\nnew_dat = pd.DataFrame(new_dat).T","41611566":"reg_model.predict(new_dat)","d8287744":"from sklearn.metrics import mean_squared_error\ny.head()","2abd64a5":"reg_model","bf24c6c0":"reg_model.predict(X)","92df7c20":"y_pred = reg_model.predict(X)","65e85343":"mse = mean_squared_error(y, y_pred)\nmse","49758bc4":"import numpy as np\nrmse = np.sqrt(mse)\nrmse","ea75d1c6":"df.describe().T","9584ea97":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X,\n                                                    y,\n                                                    test_size=0.20, random_state=1)\n","8ff86b8f":"X_train.head()","93855bda":"y_train.head()","8c3e368c":"X_test.head()","db911bcf":"y_test.head()","ecbef39a":"X_train.shape","26d94e63":"X_test.shape","aa7fb1da":"reg_model = LinearRegression()\nreg_model.fit(X_train, y_train)","8df0118c":"y_pred = reg_model.predict(X_train)","d355cb9a":"np.sqrt(mean_squared_error(y_train, y_pred))","eacb6c54":"y_pred = reg_model.predict(X_test)","aae16676":"np.sqrt(mean_squared_error(y_test, y_pred))","4530a13c":"from sklearn.model_selection import cross_val_score","9b15a9c4":"reg_model = LinearRegression()","0759af55":"#FIRST METHOD:\n-cross_val_score(reg_model,X,y,cv=10, scoring = 'neg_mean_squared_error')","d1949932":"np.mean(-cross_val_score(reg_model,X,y,cv=10, scoring = 'neg_mean_squared_error'))","95c64725":"np.std(-cross_val_score(reg_model, X,y,cv=10,scoring = 'neg_mean_squared_error'))","a7e64d6e":"np.sqrt(np.mean(-cross_val_score(reg_model,X,y,cv=10, scoring = 'neg_mean_squared_error')))","fe2525de":"X_train, X_test, y_train, y_test = train_test_split(X,\n                                                    y,\n                                                    test_size = 0.20, random_state = 1)","778433e5":"reg_model = LinearRegression()\nreg_model.fit(X_train,y_train)","5a658b1c":"np.sqrt(np.mean(-cross_val_score(reg_model, X_train, y_train, cv=10, scoring = 'neg_mean_squared_error')))","304f52bd":"#Test\ny_pred = reg_model.predict(X_test)","f4fb8f96":"#Test_Error\nnp.sqrt(mean_squared_error(y_test,y_pred))","d050ffde":"# MODEL**","2c9b1d7e":"**How much money we would earn, if we were to spend 40 units on TV?**","cf4be993":"# > MULTIPLE LINEAR REGRESSION","09aa9fad":"# > EVALUATING OF THE SUCCESS OF GUESS MENTIONED","57d29c72":"# **K FOLD CROSS VALIDATION**","aa12f145":"# *GUESS*","5dbf4caa":"# *TEST ERROR*","ff8dfc68":"# 30 unit TV, 10 unit radio, 40 unit newspaper","0522cd4a":"# **GUESS**","667f557c":"# > SECOND METHOD","d03bac45":"# *TRAIN ERROR*","cc962a63":"# > MODEL VALIDATION...HOLD OUT METHOD","ce4b3610":"# **MODEL**","29b6a96f":"# Sales = 2.94 + TV 0.04 + radio 0.19 - newspaper*0.001","102597ad":"y_hat = 7.03 + 0.04*xi"}}