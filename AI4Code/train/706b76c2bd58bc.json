{"cell_type":{"afebb1dd":"code","dc05e2b6":"code","db3aa5e7":"code","d9889cd8":"code","5ff24eb1":"code","6d330548":"code","9cffc26c":"code","f422d1a7":"code","74e8825c":"code","770a87be":"code","e71ddd58":"code","bf527dc8":"code","06ada90d":"code","cd0bed45":"code","6ccc37a7":"code","2a6c06ce":"code","63e35ec5":"code","908e636d":"code","4cf9b7f8":"code","c16d55b0":"code","03748d8a":"code","0a1d6d75":"code","67b2f7eb":"code","0e9eb48b":"code","9beac5b9":"code","598b7897":"code","089dc31f":"code","f339cf18":"code","e26cc585":"code","5fd34e87":"code","3448ed16":"code","8519f47b":"code","0ceeb86c":"code","d513049d":"code","de42ee20":"markdown","3735cd3c":"markdown","9099b5bd":"markdown","70063fb3":"markdown","0c0088ba":"markdown","0c4b540b":"markdown","41f4334d":"markdown","bc6f59fa":"markdown","b9c7e93e":"markdown","91574d55":"markdown","2a566660":"markdown","f20f6192":"markdown","abd79dab":"markdown","20c08664":"markdown","aaebe435":"markdown","a284a787":"markdown","a3405472":"markdown","d3013f16":"markdown","1798a5bb":"markdown","e7fac603":"markdown","3c11f2da":"markdown"},"source":{"afebb1dd":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","dc05e2b6":"df=pd.read_csv(\"\/kaggle\/input\/heart-attack-analysis-prediction-dataset\/heart.csv\")","db3aa5e7":"df.head()","d9889cd8":"df.shape","5ff24eb1":"df.describe()","6d330548":"df.info()","9cffc26c":"df.columns","f422d1a7":"import seaborn as sns\nimport matplotlib.pyplot as plt\nfrom scipy import stats","74e8825c":"out=df['output'].value_counts()\nplt.title('Finding the output ratio',size=20)\nsns.barplot(x=out.index,y=out.values)","770a87be":"columns = ['age', 'cp', 'trtbps', 'chol', 'restecg', 'thalachh',\n       'oldpeak', 'slp', 'caa', 'thall']\nfig, axs = plt.subplots(nrows=2, ncols=5, figsize=(20,10))\nindex =0\naxs = axs.flatten()\nfor c in columns:\n    sns.boxplot(y=c,data=df, ax=axs[index], color = 'red')\n    index = index+1\nplt.tight_layout(pad=0.4,w_pad=0.5,h_pad=5.0)","e71ddd58":"import warnings\nwarnings.filterwarnings(\"ignore\", category=FutureWarning)","bf527dc8":"col = ['sex','fbs','exng','cp','restecg','slp','caa','thall']\nfor i in col:\n    test_df = df[i].value_counts()\n    plt.figure(i)\n    plt.title(i,size=20)\n    sns.barplot(x=test_df.index,y=test_df.values)","06ada90d":"col = ['trtbps', 'chol', 'thalachh']\nfor i in col:\n    plt.figure(i)\n    sns.lineplot(x=\"age\",y=i, hue=\"output\", data=df)\n    plt.title(\"EFFECT OF HEART ATTACK WITH INCREASE IN AGE AND \" +i.upper())","cd0bed45":"plt.figure(figsize=(20, 10))\nsns.heatmap(df.corr().abs(),  annot=True)","6ccc37a7":"df.corr()['output'].sort_values(ascending=False)\n","2a6c06ce":"for i in df.columns[:-1]:\n    g = sns.FacetGrid(df, col='output',height=7)\n    g.map(sns.distplot, i, color=\"green\")","63e35ec5":"sns.pairplot(df, hue='output', height=5,palette='Dark2')","908e636d":"df[df.duplicated(keep=False)]","4cf9b7f8":"df.drop_duplicates(inplace=True)\ndf.shape","c16d55b0":"cat_col = ['sex','cp','fbs','restecg','exng','caa','slp','thall']\ncon_col = [\"age\",\"trtbps\",\"chol\",\"thalachh\",\"oldpeak\"]","03748d8a":"df1 = df.copy()","0a1d6d75":"df1 = pd.get_dummies(df1, columns = cat_col)\n","67b2f7eb":"df1.head()","0e9eb48b":"y = df1['output']\nx = df1.drop('output',axis=1)","9beac5b9":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test = train_test_split(x,y,test_size = 0.2,random_state = 42)","598b7897":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nx_train = sc.fit_transform(x_train)\nx_test = sc.transform(x_test)","089dc31f":"from sklearn.svm import SVC\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import plot_confusion_matrix\nfrom sklearn import metrics\nfrom sklearn.model_selection import GridSearchCV","f339cf18":"models = {'Logistic Regression': LogisticRegression(), 'SVC': SVC(), 'Decision Tree Classifier': DecisionTreeClassifier(), 'Random Forest Classifier': RandomForestClassifier(), 'Gradient Boosting Classifier': GradientBoostingClassifier()}","e26cc585":"acc_score = {}","5fd34e87":"for name, model in models.items():\n    model.fit(x_train,y_train)\n    predict = model.predict(x_test)\n    acc = accuracy_score(y_test, predict)\n    acc_score[name]=acc\n    cm = confusion_matrix(y_test,predict)\n    print('----------------------------------------------------\\n')\n    print('                    '+name.upper())\n    print(\"\\nThe test accuracy score is \", acc)\n    plot_confusion_matrix(model,x_test,y_test,cmap='rocket_r')\n    print('\\n')\n    metrics.plot_roc_curve(model, x_test, y_test) \n    plt.show()\n    print('-----------------------------------------------------------------------------------------------')","3448ed16":"svm = SVC(random_state=42)\nparameters = {'C': [0.1,1, 10, 100], 'gamma': [1,0.1,0.01,0.001],'kernel': ['rbf', 'poly', 'sigmoid']}\nsearcher = GridSearchCV(svm, parameters)\nsearcher.fit(x_train, y_train)\nprint(\"The best params are :\", searcher.best_params_)\nprint(\"The best score is   :\", searcher.best_score_)\npredict = searcher.predict(x_test)\nacc = accuracy_score(y_test, predict)\nacc_score['SVC_tuned']=acc\ncm = confusion_matrix(y_test,predict)\nprint('----------------------------------------------------\\n')\nprint('                    SVC_tuned')\nprint(\"\\nThe test accuracy score is \", acc)    \nprint('\\n')    \nplot_confusion_matrix(model,x_test,y_test,cmap='rocket_r')    \nmetrics.plot_roc_curve(model, x_test, y_test) \nplt.show()    \nprint('-----------------------------------------------------------------------------------------------')","8519f47b":"acc_score","0ceeb86c":"plt.figure(figsize=(12, 6))\nmodel_accuracies = list(acc_score.values())\nmodel_names = list(acc_score.keys())\nsns.barplot(x=model_accuracies, y=model_names, palette='YlOrBr');","d513049d":"maxKey = max(acc_score, key=lambda x: acc_score[x])\nprint('The model with highest Accuracy score is {0} with an accuracy of  {1:.2f}'.format(\n    maxKey, acc_score[maxKey]))","de42ee20":"Searching for duplicates.","3735cd3c":"Plotting the correlation matrix","9099b5bd":"Plotting the continuos column values.","70063fb3":"Splitting the train and test data","0c0088ba":"# Data Preprocessing","0c4b540b":"Performing one hot encoding on the categorical columns","41f4334d":"Hyper Parameter Tuning for SVC","bc6f59fa":"The above correlation graph says that the feature fbs is least correlated with the output hence it is not a deciding factor to determine whether a person will get a heart attack or not.\nWhereas the feature like exng, oldpeak, cp, thalachh and caa are highly responsible for determining the probability of getting a heart attack.","b9c7e93e":"Plotting the count values for categorical columns.","91574d55":"FEATURES:\n\n1. AGE - AGE OF THE PATIENT\n2. SEX - SEX OF THE PATIENT , (1:MALE , 0: FEMALE)\n3. EXANG - EXERCISE INCLUDE ANGIA (1=YES, 0=NO)\n4. CAA - NUMBER OF MAJOR VESSELS (0-3)\n5. CP - CHEST PAIN TYPE (Value 1: typical angina, Value2: atypical angina, Value 3: non-anginal pain, Value 4: asymptomatic\n6. TRTBPS - RESTING BLOOD PRESSURE IN (MM|HG)\n7. CHOL - CHOLESTROL IN (MG|DL) FETCHED VIA BMI SENSOR\n8. FBS - (FASTING BLOOD SUGAR > 120 MG\/DL) (1=TRUE, 0=FALSE)\n9. REST-ECG -(RESTING ELECTROCARDIOGRAPHIC RESULTS) Value 0: normal, Value 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV), Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria\n10. THALACH -MAXIMUM HEAERT RATE ACHIEVED\n11. OLDPEAK - PREVIOUS pEAK\n12. SLP - SLOPE\n13. EXNG - EXERCISE INDUCED ANGINA ~ 1 = YES, 0 = NO\n14. TARGET -0=LESS CHANCE OF HEART ATTACK, 1= MORE CHANCE OF HEART ATTACK\n","2a566660":"Seperating the categorical and continuous columns","f20f6192":"Standardizing the training and testing data.","abd79dab":"The above plot gives a great overview of how the change in value of each feature can be responsible for getting a heart attack.\n1. People in the age range 50-60 have a higher chance of getting a heart attack.\n2. People having Sex=1 i.e male have a higher risk of getting a heart attack than female though the difference is not huge.\n3. **If the chest pain type is of value 2 i.e atypical angina instead of 0 (typical angina) then it is a clear signal that the person is having a chance of heart attack**.\n4. A cholestrol level of 200-300 can have a higher risk of getting heart attacks. Again this is not one of the prominent feature for decision making.\n5. restecg = 1 (having ST-T wave abnormality) can increase the chances of getting a heart attack.\n6. **thalachh (MAXIMUM HEAERT RATE ACHIEVED) in the value of 150-200 can lead to heart attack compared to the normal value of 125-175.**\n7. **value of exng = 0 (EXERCISE INCLUDE ANGIA) is a huge contributing factor in getting a heart attack.**\n8. **Person with the oldpeak (Previous peak) value of 0 can cause heart attack.**\n9. if the slp value changes from 1 to 2 then the chances for the heart attack increases.\n10. **caa = 0 (NUMBER OF MAJOR VESSELS reducing to 0) is a huge deceiding factor in getting a heart attack.**\n11. thall (Thalium Stress Test result) value of 2 instead of 3 increase the risk of heart attack.","20c08664":"1. Trtbs and chol are not highly affecting the chances of a heart attack.\n2. Thalachh value decreases with age and hence increases the chances of a heart attack.","aaebe435":"# Data Description","a284a787":"# Model Implementation","a3405472":"Plotting the feature values for different output.","d3013f16":"From the above boxplot we can conclude that there are some outliers present in columns like trtbs, chol, oldpeak and caa","1798a5bb":"Removing the duplicate values","e7fac603":"# Data Visualization and Interpretation","3c11f2da":"Splitting the feature and target columns."}}