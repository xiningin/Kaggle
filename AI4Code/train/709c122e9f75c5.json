{"cell_type":{"b71bd908":"code","5dced552":"code","d4d3c4b4":"code","279c5f89":"code","aa49a0b9":"code","4f872f93":"code","017d3f71":"code","bc5d46f1":"code","60d23058":"code","cb9be71d":"code","6c80a685":"code","4f27fc5a":"code","44a84de4":"code","18697467":"code","429ec584":"code","cc9d7117":"code","ee71ede4":"code","44692692":"code","e0adb366":"code","a1caa773":"markdown","f9cf7930":"markdown","816e28c1":"markdown","83ee88cb":"markdown","b85577ce":"markdown","8fb237d2":"markdown","8af7534a":"markdown","cf1a25d8":"markdown","7d5dbedb":"markdown","7fc84bed":"markdown","9db0c5ee":"markdown","5e5b9261":"markdown","332a06b3":"markdown","ba402889":"markdown","b0fd66f9":"markdown","5a5bf518":"markdown","188240cf":"markdown","88271db5":"markdown","19aad0f3":"markdown","16e0c75f":"markdown","ac4730a3":"markdown","c75e587e":"markdown"},"source":{"b71bd908":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport itertools\n\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.preprocessing import StandardScaler","5dced552":"data = pd.read_csv(\"..\/input\/credit-risk\/original.csv\")\ndata.head()","d4d3c4b4":"data.info()","279c5f89":"data.fillna(data.mean(),inplace=True)","aa49a0b9":"data.drop(columns=\"clientid\",inplace=True)\ndata[\"age\"] = data[\"age\"].astype(\"int\")\ndata.head()","4f872f93":"X = data[[\"income\",\"age\",\"loan\"]]\ny = data[\"default\"]","017d3f71":"X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,shuffle=True)","bc5d46f1":"neigh = KNeighborsClassifier(n_neighbors=4)\n\nmodel = neigh.fit(X_train,y_train)\n\ny_pred = model.predict(X_test)","60d23058":"print(\"Mean Squared Error{:.3f}\".format(mean_squared_error(y_pred,y_test)))\nprint(\"Accuracy score:{:.3f}\".format(accuracy_score(y_pred,y_test)*100))","cb9be71d":"results = pd.DataFrame({\"Actual Values\":y_test,\n                        \"Predicted Values\":y_pred})\nresults.head()","6c80a685":"results.to_csv(\"k-NN.csv\",index=False)","4f27fc5a":"cm = confusion_matrix(y_pred,y_test)\n\ndef plot_confusion_matrix(cm,classes,title='Confusion Matrix',cmap=plt.cm.Blues):\n    \n    cm = cm.astype('float')\/cm.sum(axis=1)[:,np.newaxis]\n    plt.figure(figsize=(10,10))\n    plt.imshow(cm,interpolation='nearest',cmap=cmap)\n    plt.title(title)\n    plt.colorbar()\n    tick_marks = np.arange(len(classes))\n    plt.xticks(tick_marks, classes, rotation=45)\n    plt.yticks(tick_marks, classes)\n    \n    fmt = '.2f'\n    thresh = cm.max()\/2.\n    for i,j in itertools.product(range(cm.shape[0]),range(cm.shape[1])):\n        plt.text(j,i,format(cm[i,j],fmt),\n                horizontalalignment=\"center\",\n                color=\"white\" if cm[i,j] > thresh else \"black\")\n        pass\n    \n    plt.ylabel('True Label')\n    plt.xlabel('Predicted Label')\n    pass\n\nclasses=['0','1']\n\nplt.figure()\nplot_confusion_matrix(cm,classes,title=\"KNN\")\nplt.show()","44a84de4":"scaler = StandardScaler()\n\nX = scaler.fit_transform(X)\nX = pd.DataFrame(X)\nX.columns = [\"income\",\"age\",\"loan\"]\nX.head()","18697467":"X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,shuffle=True)","429ec584":"neigh = KNeighborsClassifier(n_neighbors=3)\n\nmodel = neigh.fit(X_train,y_train)\n\ny_pred = model.predict(X_test)","cc9d7117":"print(\"Mean Squared Error: {:.3f}\".format(mean_squared_error(y_pred,y_test)))\nprint(\"Accuracy score: {:.3f}\".format(accuracy_score(y_pred,y_test)*100))","ee71ede4":"results_normalized = pd.DataFrame({\"Actual Values\":y_test,\n                        \"Predicted Values\":y_pred})\nresults_normalized.head()","44692692":"results_normalized.to_csv(\"k-NN_normalized.csv\",index=False)","e0adb366":"cm = confusion_matrix(y_pred,y_test)\n\ndef plot_confusion_matrix(cm,classes,title='Confusion Matrix',cmap=plt.cm.Blues):\n    \n    cm = cm.astype('float')\/cm.sum(axis=1)[:,np.newaxis]\n    plt.figure(figsize=(10,10))\n    plt.imshow(cm,interpolation='nearest',cmap=cmap)\n    plt.title(title)\n    plt.colorbar()\n    tick_marks = np.arange(len(classes))\n    plt.xticks(tick_marks, classes, rotation=45)\n    plt.yticks(tick_marks, classes)\n    \n    fmt = '.2f'\n    thresh = cm.max()\/2.\n    for i,j in itertools.product(range(cm.shape[0]),range(cm.shape[1])):\n        plt.text(j,i,format(cm[i,j],fmt),\n                horizontalalignment=\"center\",\n                color=\"white\" if cm[i,j] > thresh else \"black\")\n        pass\n    \n    plt.ylabel('True Label')\n    plt.xlabel('Predicted Label')\n    pass\n\nclasses=['0','1']\n\nplt.figure()\nplot_confusion_matrix(cm,classes,title=\"Normalized KNN\");\nplt.show();","a1caa773":"An accuracy of *84.750* is achieved with a mean squared error of *0.152*.","f9cf7930":"An accuracy of *97.500* is obtained with a mean squared error of *0.025*.","816e28c1":"Comparing the predicted values and actual values and storing in in a CSV file.","83ee88cb":"Splitting the dataset into features and output. \n\n> X -> *income*, *age* and *loan*\n\n> y -> *default*","b85577ce":"Calculating the accuracy and mean squared error.","8fb237d2":"0 is not default while 1 is default","8af7534a":"Plotting the confusion matrix to comapre with the previous model.","cf1a25d8":"Using StandardScaler from scikit-learn. \n\nThe mean and standard variance is calculated. The mean is subtracted from each value and subsequently divided by the variance.\n\nThe MinMaxScaler can also be used where the minimum is subtracted from each value and divided by the difference between maximum and minimum values.\n\nThis done with every column in the features data before the splitting into train and test datasets.","7d5dbedb":"Splitting the features and output into train and test dataset with test as 20% of features and default.","7fc84bed":"Dropping the *clientid* as it does not define whether the client defaults or not.","9db0c5ee":"Plotting the confusion matrix to determine towards which model is the class biased towards.","5e5b9261":"# Normalising the Data\n\nIn the previous model the feature data was not normalised. Normalisation allows the data to be on the same plane or within similar ranges.\n\nTake this for example, features with values (10000,1,100) and (20000,0,200). Using euclidean or  minkowski distance the second values change is overshadowed by the other first and third values change. By normalising all the changes in each value ar given similar measure. This allows the model to train more precisely and efficiently.","332a06b3":"\"Age\" has three rows with NaN as values, we are filling them with the mean of the column.","ba402889":"Importing the necessary libraries","b0fd66f9":"Initializing the k-NN algorithm with minimum number of neighbours to classify in a class at 4","5a5bf518":"*confusion_matrix* is used to show towards which class the model is biased towards. *accuracy_score* calculates the accuracy, but it does not show how good the model behaves.\n\n*train_test_split* is used to split the features and output into train and test datasets. This is recommened as the model shoould not be tested on the complete dataset. If it is the model may overfit.\n\n*KNeighboursClassifier* is the scikit-learn implement of the k-NN classification algorithm.","188240cf":"As it can be seen that the model is biased towards the customer not defaulting. The accuracy should not be the only metric to be used for comparing models.","88271db5":"# Classification \n\nThis notebook deals with whether a customer will default on the loan payment or not. The file consists of the following columns *ClientId*,*Income*,*Age*,*Loan* and *Default*.\n\n*ClientId* can be dropped as it is not a deciding factor in whether a client will default on the loan payment or not. *Income*,*Age* and *Loan* are important features in decinding whether a client will default.","19aad0f3":"As it can be seen that this model is definitely better than the previous model.","16e0c75f":"Reading the file using `read_csv` module of `pandas`.","ac4730a3":"Using the normalised data and making a model.","c75e587e":"Printing the *Mean Squared Error* and *Accuracy Score* of the classifier."}}