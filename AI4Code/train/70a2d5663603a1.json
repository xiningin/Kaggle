{"cell_type":{"0a1dc51e":"code","aad006c2":"code","fca65232":"code","14cabfae":"code","8ae5225a":"code","f58cd08a":"code","1e75a924":"code","f14db397":"code","439856c2":"code","779a0707":"code","0d578534":"code","6d00a73d":"code","58e41ada":"code","4a0ddf27":"markdown"},"source":{"0a1dc51e":"import numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport pandas as pd\nfrom sklearn.cluster import KMeans\nfrom sklearn.preprocessing import StandardScaler \nfrom sklearn.cluster import MeanShift, estimate_bandwidth\nfrom sklearn.mixture import GaussianMixture\nfrom sklearn.cluster import AffinityPropagation\nfrom mpl_toolkits.mplot3d import Axes3D","aad006c2":"K = 15\ncol_names = [\"customer_id\",\"gender\",\"age\",\"annual_income\",\"spending_score\"]\ndata = pd.read_csv(\"..\/input\/mall-customers\/Mall_Customers.csv\",names=col_names,header=0)\ndata = data.sample(frac=1)\ndata.head()","fca65232":"X = data.iloc[:, [3, 4]].values","14cabfae":"plt.figure(figsize=(12,8))\nsns.set(style = 'darkgrid')\nplt.title('Distribution',fontsize=15)\nplt.axis('off')\nsns.distplot(X,color='cyan')\nplt.xlabel('Distribution')\nplt.ylabel('#Customers')","8ae5225a":"plt.figure(figsize=(20,8))\nsns.countplot(data['annual_income'], palette = 'rainbow')\nplt.title('Distribution of Annual Income (k$)', fontsize = 20)\nplt.show()","f58cd08a":"plt.figure(figsize=(8,8))\nsize = data['gender'].value_counts()\ncolors = ['magenta', 'blue']\nplt.pie(size, colors = colors, explode = [0, 0.15], labels = ['Female', 'Male'], shadow = True, autopct = '%.2f%%')\nplt.title('Gender', fontsize = 15)\nplt.axis('off')\nplt.legend()\nplt.show()","1e75a924":"plt.figure(figsize=(10,8))\nsns.heatmap(data.corr(), cmap = 'coolwarm', annot = True)\nplt.title('Heatmap for the Data', fontsize = 15)\nplt.show()","f14db397":"data = data.iloc[:,[1,2,4]]\ndata = data.replace(to_replace=\"Female\",value=1)\ndata = data.replace(to_replace=\"Male\",value=0)","439856c2":"fig = plt.figure(figsize=(14,8))\nax = plt.axes(projection=\"3d\")\n\nx = data[\"age\"].values\nz = data[\"gender\"].values\ny = data[\"spending_score\"].values\n\nimg = ax.scatter(x, y, z, s=50)\nax.set_zticks([0, 1])\nax.set_xlabel('Age')\nax.set_ylabel('Spending Score')\nax.set_zlabel('Gender (F = 1, M = 0)')\nplt.show()","779a0707":"# Use of the elbow method to find the optimal number of clusters\nwcss = []\nfor i in range(1, 11):\n    kmeans = KMeans(n_clusters = i, init = 'k-means++', random_state = 0)\n    kmeans.fit(X)\n    wcss.append(kmeans.inertia_)\nplt.figure(figsize=(8,8))\nplt.scatter(range(1, 11),wcss,c='b',s=100)\nplt.plot(range(1, 11),wcss,c='r',linewidth=4)\nplt.title('The Elbow Method',fontsize=20)\nplt.xlabel('Number of clusters',fontsize=20)\nplt.ylabel('Within-cluster-sum-of-squares',fontsize=20)\nplt.show()","0d578534":"vals = data.values\nk = 4 #from graph above\n\nkmeans = KMeans(n_clusters = k, init = 'k-means++').fit(vals)\n\nfig = plt.figure(figsize=(14,8))\nax = plt.axes(projection=\"3d\")\n\nx = data[\"age\"].values\nz = data[\"gender\"].values\ny = data[\"spending_score\"].values\n\nprint(f\"K-means: num of clusters - {k}\")\n\nax.scatter3D(x, y, z, s=100, c=kmeans.labels_, edgecolors='b')\nax.scatter3D(kmeans.cluster_centers_[:, 1], kmeans.cluster_centers_[:, 2],kmeans.cluster_centers_[:, 0], s = 300, color = 'black', marker=\"P\", edgecolors='red')\n\n# fig.colorbar(img1)\nax.set_zticks([0, 1])\nax.set_xlabel('Age')\nax.set_ylabel('Spending Score')\nax.set_zlabel('Gender (F = 1, M = 0)')\nplt.show()","6d00a73d":"afprop = AffinityPropagation().fit(vals)\ncluster_centers = afprop.cluster_centers_indices_\nnum_clusters = len(cluster_centers)\nprint(f\"Affinity Propagation: num of clusters - {num_clusters}\")\n\nfig = plt.figure(figsize=(14,8))\nax = plt.axes(projection=\"3d\")\n\nx = data[\"age\"].values\nz = data[\"gender\"].values\ny = data[\"spending_score\"].values\n\nax.scatter3D(x, y, z, s=100, c=afprop.labels_, edgecolors='b')\nax.scatter3D(afprop.cluster_centers_[:, 1], afprop.cluster_centers_[:, 2],afprop.cluster_centers_[:, 0], s = 300, color = 'black', marker=\"P\", edgecolors='red')\n\n# fig.colorbar(img1)\nax.set_zticks([0, 1])\nax.set_xlabel('Age')\nax.set_ylabel('Spending Score')\nax.set_zlabel('Gender (F = 1, M = 0)')\nplt.show()","58e41ada":"bandwidth = estimate_bandwidth(vals, quantile=0.2, n_samples=20)\nms = MeanShift(bandwidth=bandwidth, bin_seeding=True).fit(vals)\ncluster_centers = ms.cluster_centers_\nnum_clusters = len(cluster_centers)\n\nprint(f\"Mean-shift: num of clusters - {num_clusters}\")\n\nfig = plt.figure(figsize=(14,8))\nax = plt.axes(projection=\"3d\")\n\nx = data[\"age\"].values\nz = data[\"gender\"].values\ny = data[\"spending_score\"].values\n\nax.scatter3D(x, y, z, s=100, c=ms.labels_, edgecolors='b')\nax.scatter3D(ms.cluster_centers_[:, 1], ms.cluster_centers_[:, 2],ms.cluster_centers_[:, 0], s = 300, color = 'black', marker=\"P\", edgecolors='red')\n\n# fig.colorbar(img1)\nax.set_zticks([0, 1])\nax.set_xlabel('Age')\nax.set_ylabel('Spending Score')\nax.set_zlabel('Gender (F = 1, M = 0)')\nplt.show()","4a0ddf27":"## Task\nThe Mall customers dataset contains information about people visiting the mall. The dataset has gender, customer id, age, annual income, and spending-score. It collects insights from the data and group customers based on their behaviors. Segment the customers based on the age, gender, interest. Customer segmentation is an important practise of dividing customers base into individual groups that are similar. It is useful in customised marketing."}}