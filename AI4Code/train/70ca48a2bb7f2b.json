{"cell_type":{"93005456":"code","69de28ea":"code","479316a3":"code","ab8e0e2e":"code","6aa385a0":"code","8d27f23e":"code","182bbc66":"code","86aa6da0":"code","248cc832":"code","2547ff31":"code","d255ee39":"code","1b783585":"code","0ef1139a":"code","79ca9800":"code","3da12623":"code","10b19933":"code","5d3726a2":"code","d18f9b12":"code","d445187e":"code","ccf253df":"code","8fc70fe9":"code","6f9e9888":"code","60be90eb":"code","d7d3e393":"code","a5fd5226":"code","a1a2a573":"code","22640010":"code","37e63769":"code","ed3eb3ea":"code","3d461520":"code","c0983ed5":"code","38f5d955":"code","44b1caf0":"code","8df62a97":"code","81b76733":"code","cf5814c5":"code","d0ea300e":"code","8bfbb932":"code","c8700c9e":"code","f4586285":"code","650afe7a":"code","22a7d9d1":"code","3c1e944b":"code","d42f369e":"code","056adfb8":"code","0af0ce23":"code","8ad1293c":"code","a1ac8a39":"code","997f3f78":"code","59d4fb02":"code","bf01717e":"code","d5f965f7":"code","e620a27a":"code","e7e698b8":"code","03a00535":"code","ea6ff38a":"code","2487dc41":"code","b8d1b606":"code","078dd673":"code","294a18f4":"code","f7531d39":"code","9e55b311":"code","c0852380":"code","369a7119":"code","b06c8b48":"code","2f4c61ae":"code","c661545d":"code","a4feb571":"code","079191b0":"code","23ba996d":"code","23d590b3":"code","85ed0159":"code","7cb52044":"code","a2a3da4d":"code","ece5fbdb":"code","4fb4cc71":"code","29825d59":"code","4e50a104":"code","24b3dd48":"code","ed0cf58c":"code","f5437176":"code","5e6a5c47":"code","26b0b3ca":"code","a9c1bbd4":"code","c82adb8b":"code","62fac0b0":"code","e923a607":"code","23e715c3":"code","3a1c3ced":"code","6e9e51dd":"code","b947a8c9":"code","197c0646":"code","8f227af5":"code","fae1ecc0":"code","d15ce438":"code","ed0db36b":"code","191867ef":"code","3eca9c6b":"code","a9d7b76a":"code","f96de2c6":"code","f807fc0d":"code","20e0cc5f":"code","7b76a90d":"code","c29d2d38":"code","55e1d384":"code","f304cfb0":"markdown","dbcd429d":"markdown","538f6575":"markdown","b074df1e":"markdown","732e7945":"markdown","98157176":"markdown","beb3eeda":"markdown","1a5ada14":"markdown","390a8116":"markdown","08dd057f":"markdown","844a554a":"markdown","eedff560":"markdown","606ca57f":"markdown","0b2a6e3d":"markdown","da72b701":"markdown","d3754419":"markdown","743a8484":"markdown","ee508a7b":"markdown","2e9f5770":"markdown","413d21a0":"markdown","c9f78aa5":"markdown","6af046c9":"markdown","3991b39e":"markdown","9db69d7c":"markdown","8a556b45":"markdown","72c23afd":"markdown","14bdb9e0":"markdown","5f28412b":"markdown","0885f749":"markdown","c0c9af18":"markdown","cf45646d":"markdown","3e4abac1":"markdown","b016fbdb":"markdown","a1811a5b":"markdown","090e2c7f":"markdown","b500aa0f":"markdown","86c59a95":"markdown","38f822e9":"markdown","5e9430fc":"markdown","7b1b882f":"markdown","315e53ac":"markdown","f6576477":"markdown"},"source":{"93005456":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom sklearn.impute import SimpleImputer, KNNImputer\nfrom sklearn.ensemble import RandomForestRegressor, GradientBoostingRegressor, ExtraTreesRegressor\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom catboost import CatBoostRegressor\nfrom lightgbm import LGBMRegressor\nfrom sklearn.ensemble import RandomForestRegressor, GradientBoostingRegressor\nfrom sklearn.linear_model import LinearRegression, Ridge, Lasso, ElasticNet\nfrom sklearn.model_selection import GridSearchCV, cross_val_score\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.svm import SVR\nfrom sklearn.tree import DecisionTreeRegressor\nfrom xgboost import XGBRegressor\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","69de28ea":"train = pd.read_csv(\"..\/input\/house-prices-advanced-regression-techniques\/train.csv\")\ntest = pd.read_csv(\"..\/input\/house-prices-advanced-regression-techniques\/test.csv\")\nprint(train.shape)\nprint(test.shape)","479316a3":"# N\u00fcmerik de\u011fi\u015fkenlerin se\u00e7ilmesi\nnum_cols = [col for col in train.columns if train[col].dtype in ['int64', 'float64']]\n# Id & SalePrice de\u011fi\u015fkenlerinin \u00e7\u0131kar\u0131lmas\u0131\nnum_cols.remove('Id')\nnum_cols.remove('SalePrice')\n# Num_cols u dataframe e \u00e7evirme\nnum_analysis = train[num_cols].copy()\n# Eksik g\u00f6zlemlerin doldurulmas\u0131\nfor col in num_cols:\n    if num_analysis[col].isnull().sum() > 0:\n        num_analysis[col] = SimpleImputer(strategy='median').fit_transform(num_analysis[col].values.reshape(-1,1))\n        \n# Model\n# ExtraTressRegressor \nclf = ExtraTreesRegressor(random_state=42)\netreg_model = clf.fit(num_analysis, train.SalePrice)\n","ab8e0e2e":"def plot_importance(model, features, num=len(num_cols), save=False):\n    feature_imp = pd.DataFrame({'Value': model.feature_importances_, 'Feature': features})\n    plt.figure(figsize=(16, 10))\n    sns.set(font_scale=1)\n    sns.barplot(x=\"Value\", y=\"Feature\", data=feature_imp.sort_values(by=\"Value\",\n                                                                     ascending=False)[0:num])\n    plt.title('Features')\n    plt.tight_layout()\n    plt.show()\n    if save:\n        plt.savefig('importances.png')\n\nplot_importance(etreg_model, num_cols)\n","6aa385a0":"plt.figure(figsize=(8,8))\nplt.title('\u00d6nemli de\u011fi\u015fkenlerin korelasyon matrisi')\ncols =['OverallQual', 'GarageCars', 'GrLivArea', 'YearBuilt', \n       'FullBath', '1stFlrSF', 'TotalBsmtSF', 'GarageArea','Fireplaces','GarageYrBlt','SalePrice']\nsns.heatmap(train[cols].corr(),annot=True,square=True);\n","8d27f23e":"# https:\/\/www.kaggle.com\/mviola\/house-prices-eda-lasso-lightgbm-0-11635 \ndef plot_numerical(col, discrete=False):\n    if discrete:\n        fig, ax = plt.subplots(1,2,figsize=(12,6))\n        sns.stripplot(x=col, y='SalePrice', data=train, ax=ax[0])\n        sns.countplot(train[col], ax=ax[1])\n        fig.suptitle(str(col) + ' analysis')\n    else:\n        fig, ax = plt.subplots(1,2,figsize=(12,6))\n        sns.scatterplot(x=col, y='SalePrice', data=train, ax=ax[0])\n        sns.distplot(train[col], kde=False, ax=ax[1])\n        fig.suptitle(str(col) + ' analysis')\n\n\nprint('Plot functions are ready to use')","182bbc66":"# cols =['OverallQual', 'GarageCars', 'GrLivArea', 'YearBuilt', \n       #'FullBath', '1stFlrSF', 'TotalBsmtSF', 'GarageArea','Fireplaces','GarageYrBlt','SalePrice']\nplot_numerical('OverallQual',discrete=True)","86aa6da0":"plot_numerical('GarageCars',discrete=True);","248cc832":"plot_numerical('GrLivArea');","2547ff31":"plot_numerical('YearBuilt');","d255ee39":"plot_numerical('FullBath',discrete=True);\n# FullBath: \u00dcst katlardaki tam banyolar","1b783585":"plot_numerical('1stFlrSF');\n# 1stFlrSF : 1.kat metrekare alan\u0131","0ef1139a":"plot_numerical('TotalBsmtSF');\n# TotalBsmtSF : Kare ayakl\u0131 duvar kaplama alan\u0131","79ca9800":"plot_numerical('GarageArea');","3da12623":"plot_numerical('Fireplaces',discrete=True);","10b19933":"# Kategorik de\u011fi\u015fkenlerin se\u00e7ilmesi\ncat_features = [col for col in train.columns if train[col].dtype =='object']\n\ncat_analysis = train[cat_features].copy()\n\nfor col in cat_analysis:\n    if cat_analysis[col].isnull().sum() > 0:\n        cat_analysis[col] = SimpleImputer(strategy='constant').fit_transform(cat_analysis[col].values.reshape(-1,1))\n\n# One-Hot Encoding\ndef one_hot_encoder(dataframe, categorical_cols, drop_first=False):\n    dataframe = pd.get_dummies(dataframe, columns=categorical_cols, drop_first=drop_first)\n    return dataframe\ncat_analysis = one_hot_encoder(cat_analysis,cat_features)\n\n# Model \nclf = ExtraTreesRegressor(random_state=42)\nh = clf.fit(cat_analysis, train.SalePrice)\n","5d3726a2":"def plot_importance(model, features, save=False):\n    feature_imp = pd.DataFrame({'Value': model.feature_importances_, 'Feature': features.columns})\n    plt.figure(figsize=(16, 10))\n    sns.set(font_scale=1)\n    sns.barplot(x=\"Value\", y=\"Feature\", data=feature_imp.sort_values(by=\"Value\",\n                                                                     ascending=False)[0:20])\n    plt.title('Features')\n    plt.tight_layout()\n    plt.show()\n    if save:\n        plt.savefig('importances.png')\n\nplot_importance(h, cat_analysis)\n","d18f9b12":"cat_analysis[\"SalePrice\"] = train[\"SalePrice\"]\n","d445187e":"def cat_plot(col1,col2):\n    # t\u00fcm veri\n    fig, ax = plt.subplots(1,2,figsize=(12,6), sharey=True)\n    sns.stripplot(x=col1, y='SalePrice', data=train, ax=ax[0])\n    sns.boxplot(x=col1, y='SalePrice', data=train, ax=ax[1])\n    ax[0].set_xticklabels(ax[0].get_xticklabels(), rotation=90)\n    ax[1].set_xticklabels(ax[1].get_xticklabels(), rotation=90)\n    fig.suptitle(str(col1) + ' analysis')\n    \n    # one-hot encoding\n    fig, ax = plt.subplots(1,2,figsize=(12,6), sharey=True)\n    sns.stripplot(x=col2, y='SalePrice', data=cat_analysis, ax=ax[0])\n    sns.boxplot(x=col2, y='SalePrice', data=cat_analysis, ax=ax[1])\n    fig.suptitle(str(col2) + ' analysis')\n\n","ccf253df":"cat_plot(\"ExterQual\",\"ExterQual_TA\")","8fc70fe9":"cat_plot(\"BsmtQual\",\"BsmtQual_Ex\")","6f9e9888":"cat_plot(\"FireplaceQu\",\"FireplaceQu_missing_value\")","60be90eb":"cat_plot(\"Neighborhood\",\"Neighborhood_NoRidge\")","d7d3e393":"# train.drop('Id', axis=1, inplace=True)\n# test.drop('Id', axis=1, inplace=True)","a5fd5226":"# Train ve test dataler\u0131n\u0131 birle\u015ftirme\ndf = pd.concat([train, test]).reset_index(drop=True)\nprint(df.shape)","a1a2a573":"def missing_values_table(dataframe, na_name=False):\n    na_columns = [col for col in dataframe.columns if dataframe[col].isnull().sum() > 0]\n    n_miss = dataframe[na_columns].isnull().sum().sort_values(ascending=False)\n    ratio = (dataframe[na_columns].isnull().sum() \/ dataframe.shape[0] * 100).sort_values(ascending=False)\n    missing_df = pd.concat([n_miss, np.round(ratio, 2)], axis=1, keys=['n_miss', 'ratio'])\n    print(missing_df, end=\"\\n\")\n    if na_name:\n        return na_columns\n    \nmissing_values_table(df)","22640010":"# Baz\u0131 de\u011fi\u015fkenledeki NAN olanlar\u0131 eksiklik olarak g\u00f6r\u00fcyor ama asl\u0131nda bunlar\n# eksiklik de\u011fil yoklu\u011fu ifade ediyor.Bu nedenle onlar\u0131 None olarak de\u011fi\u015ftirece\u011fim.\n\nnone_cols = ['Alley', 'PoolQC', 'MiscFeature', 'Fence', 'FireplaceQu', 'GarageType',\n             'GarageFinish', 'GarageQual', 'GarageCond', 'BsmtQual', 'BsmtCond',\n             'BsmtExposure', 'BsmtFinType1', 'BsmtFinType2', 'MasVnrType']\n\n\n# Say\u0131sal de\u011ferlerdeki Nan olanlar asl\u0131nda yokluk anlam\u0131nda oldu\u011fu i\u00e7in onlar\u0131 da 0 \n# ile de\u011fi\u015ftirece\u011fim.\n\nzero_cols = ['BsmtFinSF1', 'BsmtFinSF2', 'BsmtUnfSF', 'TotalBsmtSF', 'BsmtFullBath',\n             'BsmtHalfBath', 'GarageYrBlt', 'GarageArea', 'GarageCars', 'MasVnrArea']\n\n# Di\u011fer de\u011fi\u015fkenlerde eksiklik az oldu\u011fu i\u00e7in mod ile dolduraca\u011f\u0131m.\nfreq_cols = ['Electrical', 'Exterior1st', 'Exterior2nd', 'Functional', 'KitchenQual',\n             'SaleType', 'Utilities']\n\n\nfor col in zero_cols:\n    df[col].replace(np.nan, 0, inplace=True)\n\nfor col in none_cols:\n    df[col].replace(np.nan, 'None', inplace=True)\n    \nfor col in freq_cols:\n    df[col].replace(np.nan, df[col].mode()[0], inplace=True)","37e63769":"missing_values_table(df)","ed3eb3ea":"# MsZoning(genel imar s\u0131n\u0131fland\u0131rmas\u0131) de\u011fi\u015fkenindeki bo\u015f de\u011ferleri \n# MSSubClassa(in\u015faat s\u0131n\u0131f\u0131) g\u00f6re dolduraca\u011f\u0131m.\n\ndf['MSZoning'] = df.groupby('MSSubClass')['MSZoning'].apply(\n    lambda x: x.fillna(x.mode()[0]))\n\n# LotFrontage m\u00fclkiyetin cadde ile ba\u011flant\u0131s\u0131n\u0131 g\u00f6steren bir de\u011fi\u015fken, her mahallenin \n# cadde ba\u011flant\u0131s\u0131n\u0131n birbirine benzeyebilece\u011finden bunu Neighborhood'a g\u00f6re dolduraca\u011f\u0131m.\n\ndf['LotFrontage'] = df.groupby(\n    ['Neighborhood'])['LotFrontage'].apply(lambda x: x.fillna(x.median()))\n\nmissing_values_table(df)\n","3d461520":"# Say\u0131sal de\u011fi\u015fken olup asl\u0131nda kategorik de\u011fi\u015fken olmas\u0131 gerekenleri d\u00fczeltme\n\ndf['MSSubClass'] = df['MSSubClass'].astype(str)\ndf['YrSold'] = df['YrSold'].astype(str)\ndf['MoSold'] = df['MoSold'].astype(str)\ndf.info()","c0983ed5":"df[\"LotShape\"].value_counts()","38f5d955":"# LotShape(\u0130mar \u015fekli) de\u011fi\u015fkeninin IR2 ve IR3 alt s\u0131n\u0131flar\u0131n\u0131n frekans\u0131 d\u00fc\u015f\u00fck.\n# Bu nedenle bunlar\u0131 IR1 e atayaca\u011f\u0131m.\n\ndf.loc[(df[\"LotShape\"] == \"IR2\"), \"LotShape\"] = \"IR1\"\ndf.loc[(df[\"LotShape\"] == \"IR3\"), \"LotShape\"] = \"IR1\"\ndf[\"LotShape\"].value_counts()","44b1caf0":"df[\"ExterQual\"].value_counts()","8df62a97":"# S\u0131n\u0131flar aras\u0131nda dengesizlik oldu\u011fu i\u00e7in Ex ve Gd(en iyi kaliteli iki s\u0131n\u0131f) birle\u015ftirdik.\n# TA ve Fa (orta kaliteli s\u0131n\u0131f) birle\u015ftirdik\n\ndf.loc[df[\"ExterQual\"]==\"Ex\",\"ExterQual\"]=2\ndf.loc[df[\"ExterQual\"]==\"Gd\",\"ExterQual\"]=2\ndf.loc[df[\"ExterQual\"]==\"TA\",\"ExterQual\"]=1\ndf.loc[df[\"ExterQual\"]==\"Fa\",\"ExterQual\"]=1\ndf[\"ExterQual\"]= df[\"ExterQual\"].astype(\"int\")\n\ndf[\"ExterQual\"].value_counts()","81b76733":"df[\"BsmtQual\"].value_counts()","cf5814c5":"# S\u0131n\u0131flar aras\u0131nda dengesizlik oldu\u011fu i\u00e7in Ex ve Gd(90 ile 100 inches aras\u0131) birle\u015ftirdik.\n# TA ve Fa (70 ile 89 inches aras\u0131) birle\u015ftirdik.\n# None da yokluk oldu\u011fu i\u00e7in dokunmad\u0131k.\n\ndf.loc[df[\"BsmtQual\"]==\"Ex\",\"BsmtQual\"]=2\ndf.loc[df[\"BsmtQual\"]==\"Gd\",\"BsmtQual\"]=2\ndf.loc[df[\"BsmtQual\"]==\"TA\",\"BsmtQual\"]=1\ndf.loc[df[\"BsmtQual\"]==\"Fa\",\"BsmtQual\"]=1\ndf.loc[df[\"BsmtQual\"]==\"None\",\"BsmtQual\"]=0\ndf[\"BsmtQual\"]= df[\"BsmtQual\"].astype(\"int\")\n\ndf[\"BsmtQual\"].value_counts()","d0ea300e":"df[\"KitchenQual\"].value_counts()","8bfbb932":"df.loc[df[\"KitchenQual\"]==\"Ex\",\"KitchenQual\"]=2\ndf.loc[df[\"KitchenQual\"]==\"Gd\",\"KitchenQual\"]=2\ndf.loc[df[\"KitchenQual\"]==\"TA\",\"KitchenQual\"]=1\ndf.loc[df[\"KitchenQual\"]==\"Fa\",\"KitchenQual\"]=1\ndf[\"KitchenQual\"]= df[\"KitchenQual\"].astype(\"int\")\ndf[\"KitchenQual\"].value_counts()","c8700c9e":"df.groupby(\"Neighborhood\").agg({\"SalePrice\":\"mean\"}).sort_values(by=\"SalePrice\", ascending=False)","f4586285":"# https:\/\/www.kaggle.com\/oguzerdo\/top-1-house-pricing-project-regression-models\n# Target de\u011fi\u015fkeninin ortalamas\u0131na g\u00f6re birbirine benzeyen il\u00e7eleri birle\u015ftirdik.\n\nneigh_map = {'MeadowV': 1,'IDOTRR': 1,'BrDale': 1,'BrkSide': 2,'OldTown': 2,'Edwards': 2,\n             'Sawyer': 3,'Blueste': 3,'SWISU': 3,'NPkVill': 3,'NAmes': 3,'Mitchel': 4,\n             'SawyerW': 5,'NWAmes': 5,'Gilbert': 5,'Blmngtn': 5,'CollgCr': 5,\n             'ClearCr': 6,'Crawfor': 6,'Veenker': 7,'Somerst': 7,'Timber': 8,\n             'StoneBr': 9,'NridgHt': 10,'NoRidge': 10}\n\ndf['Neighborhood'] = df['Neighborhood'].map(neigh_map).astype('int')","650afe7a":"# Derecelendirme i\u00e7eren de\u011fi\u015fkenleri ordinal yap\u0131ya getirece\u011fim.\n\next_map = {'Po': 1, 'Fa': 2, 'TA': 3, 'Gd': 4, 'Ex': 5}\ndf['ExterCond'] = df['ExterCond'].map(ext_map).astype('int')\n\nbsm_map = {'None': 0, 'Po': 1, 'Fa': 2, 'TA': 3, 'Gd': 4, 'Ex': 5}\n\ndf['BsmtCond'] = df['BsmtCond'].map(bsm_map).astype('int')\n\nbsmf_map = {'None': 0,'Unf': 1,'LwQ': 2,'Rec': 3,'BLQ': 4,'ALQ': 5,'GLQ': 6}\ndf['BsmtFinType1'] = df['BsmtFinType1'].map(bsmf_map).astype('int')\ndf['BsmtFinType2'] = df['BsmtFinType2'].map(bsmf_map).astype('int')\n\nheat_map = {'Po': 1, 'Fa': 2, 'TA': 3, 'Gd': 4, 'Ex': 5}\ndf['HeatingQC'] = df['HeatingQC'].map(heat_map).astype('int')\n\ndf['FireplaceQu'] = df['FireplaceQu'].map(bsm_map).astype('int')\ndf['GarageCond'] = df['GarageCond'].map(bsm_map).astype('int')\ndf['GarageQual'] = df['GarageQual'].map(bsm_map).astype('int')\n","22a7d9d1":"def rare_analyser(dataframe, target, rare_perc):\n    \n    rare_cols = [col for col in dataframe.columns if len(dataframe[col].value_counts()) <= 20\n                    and (dataframe[col].value_counts() \/ len(dataframe) < rare_perc).sum() > 1]\n    \n    for col in rare_cols:\n        print(col, \":\", len(dataframe[col].value_counts()))\n        print(pd.DataFrame({\"COUNT\": dataframe[col].value_counts(),\n                            \"RATIO\": dataframe[col].value_counts() \/ len(dataframe),\n                            \"TARGET_MEAN\": dataframe.groupby(col)[target].mean()}), end=\"\\n\\n\\n\")\n        \nrare_analyser(df, \"SalePrice\", 0.01)","3c1e944b":"df[\"GarageCars\"].value_counts()","d42f369e":"df[\"LotConfig\"].value_counts()","056adfb8":"df.loc[(df[\"LotConfig\"]==\"Inside\"),\"LotConfig\"] = 1\ndf.loc[(df[\"LotConfig\"]==\"FR2\"),\"LotConfig\"] = 1\ndf.loc[(df[\"LotConfig\"]==\"Corner\"),\"LotConfig\"] = 1\n\ndf.loc[(df[\"LotConfig\"]==\"FR3\"),\"LotConfig\"] = 2\ndf.loc[(df[\"LotConfig\"]==\"CulDSac\"),\"LotConfig\"] = 2\ndf[\"LotConfig\"].value_counts()\n","0af0ce23":"df[\"LandSlope\"].value_counts()","8ad1293c":"df.loc[df[\"LandSlope\"] == \"Gtl\", \"LandSlope\"] = 1\ndf.loc[df[\"LandSlope\"] == \"Sev\", \"LandSlope\"] = 2\ndf.loc[df[\"LandSlope\"] == \"Mod\", \"LandSlope\"] = 2\ndf[\"LandSlope\"]= df[\"LandSlope\"].astype(\"int\")\ndf[\"LandSlope\"].value_counts()","a1ac8a39":"df[\"OverallQual\"].value_counts()","997f3f78":"df.loc[df[\"OverallQual\"] == 1, \"OverallQual\"] = 1\ndf.loc[df[\"OverallQual\"] == 2, \"OverallQual\"] = 1\ndf.loc[df[\"OverallQual\"] == 3, \"OverallQual\"] = 1\ndf.loc[df[\"OverallQual\"] == 4, \"OverallQual\"] = 2\ndf.loc[df[\"OverallQual\"] == 5, \"OverallQual\"] = 3\ndf.loc[df[\"OverallQual\"] == 6, \"OverallQual\"] = 4\ndf.loc[df[\"OverallQual\"] == 7, \"OverallQual\"] = 5\ndf.loc[df[\"OverallQual\"] == 8, \"OverallQual\"] = 6\ndf.loc[df[\"OverallQual\"] == 9, \"OverallQual\"] = 7\ndf.loc[df[\"OverallQual\"] == 10, \"OverallQual\"] = 8\ndf[\"OverallQual\"].value_counts()","59d4fb02":"df[\"MasVnrType\"].value_counts()","bf01717e":"df.loc[df[\"MasVnrType\"] == \"BrkCmn\" , \"MasVnrType\"] = \"None\" \ndf[\"MasVnrType\"].value_counts()","d5f965f7":"df[\"Foundation\"].value_counts()","e620a27a":"df.loc[df[\"Foundation\"] == \"Stone\", \"Foundation\"] = \"BrkTil\"\ndf.loc[df[\"Foundation\"] == \"Wood\", \"Foundation\"] = \"CBlock\"\ndf[\"Foundation\"].value_counts()","e7e698b8":"df[\"Fence\"].value_counts()","03a00535":"df.loc[df[\"Fence\"] == \"MnWw\", \"Fence\"] = \"MnPrv\"\ndf.loc[df[\"Fence\"] == \"GdWo\", \"Fence\"] = \"MnPrv\"\ndf[\"Fence\"].value_counts()","ea6ff38a":"# Total banyo say\u0131s\u0131\ndf[\"TotalBath_NEW\"] = df['BsmtFullBath'] + df['BsmtHalfBath'] * 0.5 + df['FullBath'] + df['HalfBath'] * 0.5\n\n# Toplam Kat Say\u0131s\u0131\ndf['TotalSF_NEW'] = (df['BsmtFinSF1'] + df['BsmtFinSF2'] + df['1stFlrSF'] + df['2ndFlrSF'])\n\n# Toplam Veranda Alan\u0131\ndf['TotalPorchSF_NEW'] = (df['OpenPorchSF'] + df['3SsnPorch'] +df['EnclosedPorch'] +df['ScreenPorch'] + df['WoodDeckSF'])\n\n# Kaliteleriyle ilgili de\u011fi\u015fkenler\ndf[\"OVER_QUAL_NEW\"] = df['OverallQual'] + df['OverallCond']\n\n# Bodrum kalitesi\ndf[\"BSMT_QUAL_NEW\"] = df['BsmtQual'] + df['BsmtCond']\n\n# D\u0131\u015f malzeme kalitesi\ndf[\"EX_QUAL_NEW\"] = df['ExterQual'] + df['ExterCond']\n\n# Garaj kalitesi\ndf['TotalGrgQual_NEW'] = (df['GarageQual'] + df['GarageCond'])\n\n# Genel kalite\ndf['TotalQual_NEW'] = df['OverallQual'] + df['EX_QUAL_NEW']  + df['TotalGrgQual_NEW'] + df['KitchenQual'] + df['HeatingQC']\n\n# Lux evler\ndf.loc[(df['Fireplaces'] > 0) & (df['GarageCars'] >= 3), \"LUX_NEW\"] = 1\ndf[\"LUX_NEW\"].fillna(0, inplace=True)\ndf[\"LUX_NEW\"] = df[\"LUX_NEW\"].astype(int)\n\n# Restore Edilmemi\u015f-Edilmemi\u015f\ndf.loc[df[\"YearBuilt\"] == df[\"YearRemodAdd\"], \"NEW_home\"] = 0\ndf.loc[df[\"YearBuilt\"] != df[\"YearRemodAdd\"], \"NEW_home\"] = 1\n\ndf['QualPorch_NEW'] = df['EX_QUAL_NEW'] * df['TotalPorchSF_NEW']\n\ndf['HasPool_NEW'] = df['PoolArea'].apply(lambda x: 1 if x > 0 else 0)\ndf['Has2ndFloor_NEW'] = df['2ndFlrSF'].apply(lambda x: 1 if x > 0 else 0)\ndf['HasGarage_NEW'] = df['TotalGrgQual_NEW'].apply(lambda x: 1 if x > 0 else 0)\ndf['HasFireplace_NEW'] = df['Fireplaces'].apply(lambda x: 1 if x > 0 else 0)\ndf['HasPorch_NEW'] = df['QualPorch_NEW'].apply(lambda x: 1 if x > 0 else 0)\n\n# Bah\u00e7e alan\u0131\ndf[\"Garden_NEW\"]=df[\"LotArea\"] - df[\"GrLivArea\"]","2487dc41":"def outlier_thresholds(dataframe, col_name, q1=0.25, q3=0.75):\n    quartile1 = dataframe[col_name].quantile(q1)\n    quartile3 = dataframe[col_name].quantile(q3)\n    interquantile_range = quartile3 - quartile1\n    up_limit = quartile3 + 1.5 * interquantile_range\n    low_limit = quartile1 - 1.5 * interquantile_range\n    return low_limit, up_limit\n\ndef replace_with_thresholds(dataframe, variable):\n    low_limit, up_limit = outlier_thresholds(dataframe, variable)\n    dataframe.loc[(dataframe[variable] < low_limit), variable] = low_limit\n    dataframe.loc[(dataframe[variable] > up_limit), variable] = up_limit\n    \ndef check_outlier(dataframe, col_name):\n    low_limit, up_limit = outlier_thresholds(dataframe, col_name)\n    if dataframe[(dataframe[col_name] > up_limit) | (dataframe[col_name] < low_limit)].any(axis=None):\n        return True\n    else:\n        return False\n","b8d1b606":"num_cols = [col for col in df.columns if df[col].dtype in ['int64', 'float64']]\nfor col in num_cols:\n    replace_with_thresholds(df, col)","078dd673":"for col in num_cols:\n    print(col, check_outlier(df, col))","294a18f4":"def grab_col_names(dataframe, cat_th=10, car_th=20):\n    # cat_cols, cat_but_car\n    cat_cols = [col for col in dataframe.columns if dataframe[col].dtypes == \"O\"]\n    num_but_cat = [col for col in dataframe.columns if dataframe[col].nunique() < cat_th and\n                   dataframe[col].dtypes != \"O\"]\n    cat_but_car = [col for col in dataframe.columns if dataframe[col].nunique() > car_th and\n                   dataframe[col].dtypes == \"O\"]\n    cat_cols = cat_cols + num_but_cat\n    cat_cols = [col for col in cat_cols if col not in cat_but_car]\n\n    # num_cols\n    num_cols = [col for col in dataframe.columns if dataframe[col].dtypes != \"O\"]\n    num_cols = [col for col in num_cols if col not in num_but_cat]\n\n    print(f\"Observations: {dataframe.shape[0]}\")\n    print(f\"Variables: {dataframe.shape[1]}\")\n    print(f'cat_cols: {len(cat_cols)}')\n    print(f'num_cols: {len(num_cols)}')\n    print(f'cat_but_car: {len(cat_but_car)}')\n    print(f'num_but_cat: {len(num_but_cat)}')\n    return cat_cols, num_cols, cat_but_car\ncat_cols, num_cols, cat_but_car = grab_col_names(df)","f7531d39":"def rare_analyser(dataframe, target, cat_cols):\n    for col in cat_cols:\n        print(col, \":\", len(dataframe[col].value_counts()))\n        print(pd.DataFrame({\"COUNT\": dataframe[col].value_counts(),\n                            \"RATIO\": dataframe[col].value_counts() \/ len(dataframe),\n                            \"TARGET_MEAN\": dataframe.groupby(col)[target].mean()}), end=\"\\n\\n\\n\")\n\ndef rare_encoder(dataframe, rare_perc,cat_cols):\n    \n    rare_columns = [col for col in cat_cols if (dataframe[col].value_counts()\/len(dataframe) < 0.01).sum() > 1]\n\n    for col in rare_columns:\n        tmp = dataframe[col].value_counts() \/ len(dataframe)\n        rare_labels = tmp[tmp < rare_perc].index\n        dataframe[col] = np.where(dataframe[col].isin(rare_labels), 'Rare', dataframe[col])\n\n    return dataframe\n\nrare_analyser(df, \"SalePrice\", cat_cols)","9e55b311":"df = rare_encoder(df, 0.01, cat_cols)","c0852380":"rare_analyser(df, \"SalePrice\", cat_cols)","369a7119":"useless_cols = [col for col in cat_cols if df[col].nunique() == 1 or\n                (df[col].nunique() == 2 and (df[col].value_counts() \/ len(df) <= 0.02).any(axis=None))]\nuseless_cols","b06c8b48":"cat_cols = [col for col in cat_cols if col not in useless_cols]\ndf.shape","2f4c61ae":"for col in useless_cols:\n    df.drop(col, axis=1, inplace=True)\ndf.shape    ","c661545d":"rare_analyser(df, \"SalePrice\", cat_cols)","a4feb571":"def one_hot_encoder(dataframe, categorical_cols, drop_first=False):\n    dataframe = pd.get_dummies(dataframe, columns=categorical_cols, drop_first=drop_first)\n    return dataframe","079191b0":"df = one_hot_encoder(df, cat_cols, drop_first=True)\ndf.shape","23ba996d":"cat_cols, num_cols, cat_but_car = grab_col_names(df)","23d590b3":"rare_analyser(df, \"SalePrice\", cat_cols)","85ed0159":"useless_cols_new = [col for col in cat_cols if (df[col].value_counts() \/ len(df) <= 0.01).any(axis=None)]\nuseless_cols_new","7cb52044":"for col in useless_cols_new:\n    df.drop(col, axis=1, inplace=True)\ndf.shape    ","a2a3da4d":"#test train setini \u00f6nce birle\u015ftirmi\u015ftik \u015fimdi ay\u0131ral\u0131m\ntrain_df = df[df['SalePrice'].notnull()]\ntest_df = df[df['SalePrice'].isnull()].drop(\"SalePrice\", axis=1)","ece5fbdb":"y = np.log1p(train_df['SalePrice'])\nX = train_df.drop([\"Id\", \"SalePrice\"], axis=1)","4fb4cc71":"models = [('LR', LinearRegression()),\n          (\"Ridge\", Ridge()),\n          (\"Lasso\", Lasso()),\n          (\"ElasticNet\", ElasticNet()),\n          ('KNN', KNeighborsRegressor()),\n          ('CART', DecisionTreeRegressor()),\n          ('RF', RandomForestRegressor()),\n          ('SVR', SVR()),\n          ('GBM', GradientBoostingRegressor()),\n          (\"XGBoost\", XGBRegressor(objective='reg:squarederror')),\n          (\"LightGBM\", LGBMRegressor()),\n          (\"CatBoost\", CatBoostRegressor(verbose=False))]","29825d59":"for name, regressor in models:\n    rmse = np.mean(np.sqrt(-cross_val_score(regressor, X, y, cv=5, scoring=\"neg_mean_squared_error\")))\n    print(f\"RMSE: {round(rmse, 4)} ({name}) \")","4e50a104":"lgbm_model = LGBMRegressor(random_state=46)","24b3dd48":"# modelleme \u00f6ncesi hata:\nrmse = np.mean(np.sqrt(-cross_val_score(lgbm_model,\n                                        X, y, cv=10, scoring=\"neg_mean_squared_error\")))\nrmse","ed0cf58c":"lgbm_params = {\"learning_rate\": [0.001, 0.01, 0.05, 0.1],\n               \"n_estimators\": [200, 500, 750],\n               \"max_depth\": [-1, 2, 5, 8],\n               \"colsample_bytree\": [1, 0.50, 0.75],\n               \"num_leaves\": [25, 31, 44]}","f5437176":"lgbm_gs_best = GridSearchCV(lgbm_model,\n                            lgbm_params,\n                            cv=10,\n                            n_jobs=-1,\n                            verbose=True).fit(X, y)","5e6a5c47":"lgbm_gs_best.best_params_","26b0b3ca":"final_model = lgbm_model.set_params(**lgbm_gs_best.best_params_).fit(X, y)","a9c1bbd4":"rmse = np.mean(np.sqrt(-cross_val_score(final_model, X, y, cv=5, scoring=\"neg_mean_squared_error\")))\nrmse\n#hiperparametrelerin default kendi de\u011feriyle rmse 0.12676 idi.\n#optimizasyonlarla 0.1228 e indirdik","c82adb8b":"def plot_importance(model, features, num=len(X), save=False):\n    feature_imp = pd.DataFrame({'Value': model.feature_importances_, 'Feature': features.columns})\n    plt.figure(figsize=(10, 10))\n    sns.set(font_scale=1)\n    sns.barplot(x=\"Value\", y=\"Feature\", data=feature_imp.sort_values(by=\"Value\",\n                                                                     ascending=False)[0:num])\n    plt.title('Features')\n    plt.tight_layout()\n    plt.show()\n    if save:\n        plt.savefig('importances.png')","62fac0b0":"plot_importance(final_model, X, 50)","e923a607":"feature_imp = pd.DataFrame({'Value': final_model.feature_importances_, 'Feature': X.columns})\nfeature_imp.sort_values(by=\"Value\",ascending=False)\n","23e715c3":"feature_imp[feature_imp[\"Value\"] > 0].shape","3a1c3ced":"feature_imp[feature_imp[\"Value\"] < 1].shape","6e9e51dd":"zero_imp_cols = feature_imp[feature_imp[\"Value\"] < 1][\"Feature\"].values\nzero_imp_cols","b947a8c9":"selected_cols = [col for col in X.columns if col not in zero_imp_cols]\nlen(selected_cols)","197c0646":"lgbm_model = LGBMRegressor(random_state=46)","8f227af5":"lgbm_params = {\"learning_rate\": [0.001, 0.01, 0.05, 0.1],\n               \"n_estimators\": [200, 500, 750],\n               \"max_depth\": [-1, 2, 5, 8],\n               \"colsample_bytree\": [1, 0.50, 0.75],\n               \"num_leaves\": [25, 31, 44]}","fae1ecc0":"lgbm_gs_best = GridSearchCV(lgbm_model,\n                            lgbm_params,\n                            cv=10,\n                            n_jobs=-1,\n                            verbose=True).fit(X[selected_cols], y)","d15ce438":"final_model = lgbm_model.set_params(**lgbm_gs_best.best_params_).fit(X[selected_cols], y)","ed0db36b":"rmse = np.mean(np.sqrt(-cross_val_score(final_model, X[selected_cols], y, cv=5, scoring=\"neg_mean_squared_error\")))\nrmse\n\n#bir \u00f6nceli rmse de\u011feri 0.12281029384862836\n#\u00e7\u00f6p de\u011fi\u015fkenlerle azaltm\u0131\u015f olduk biraz da olsa 0.12315210453826239","191867ef":"submission_df = pd.DataFrame()","3eca9c6b":"submission_df['Id'] = test_df[\"Id\"]","a9d7b76a":"y_pred_sub = final_model.predict(test_df[selected_cols])","f96de2c6":"y_pred_sub = np.expm1(y_pred_sub) #\u00f6l\u00e7eklendirmi\u015ftik ya onu geri ald\u0131k","f807fc0d":"submission_df['SalePrice'] = y_pred_sub","20e0cc5f":"submission_df[\"Id\"]=submission_df[\"Id\"].astype(\"int32\")","7b76a90d":"submission_df.dtypes","c29d2d38":"submission_df.to_csv('submission.csv', index=False)","55e1d384":"submission_df","f304cfb0":"## \u00d6nemli N\u00fcmerik De\u011fi\u015fkenlerin \u0130ncelenmesi","dbcd429d":"* \u00dcst katta hi\u00e7 banyosu olmad\u0131\u011f\u0131 halde fiyat\u0131 y\u00fcksek olan evler var.","538f6575":"* GarageCars ile GarageArea aras\u0131nda 0.88 lik pozitif y\u00f6nl\u00fc korelasyon var yani ili\u015fkileri y\u00fcksek.\n* YearBuilt ile GarageYrBlt aras\u0131nda 0.83 l\u00fck korelasyon var.\n* 1stFlrSF ile TotalBsmtSF aras\u0131nda 0.82 lik koralsyon var.","b074df1e":"#### - OverallQual(Genel malzeme ve biti\u015f kalitesi) ","732e7945":"### ExterQual: D\u0131\u015f malzeme kalitesi\n* Ex: Excellent\n* Gd: Good\n* TA: Average \/ Typical\n* Fa: Fair\n* Po: Poor","98157176":"### - Foundation (Vak\u0131f tipi)","beb3eeda":"* Metrekaresi y\u00fcksek oldu\u011fu halde(4000-5000) fiyat\u0131 d\u00fc\u015f\u00fck olan iki g\u00f6zlem var,ayk\u0131r\u0131 olabilir.\n* GrLivArea ile SalePrice aras\u0131nda do\u011frusal ili\u015fki var gibi g\u00f6r\u00fcn\u00fcyor.\n* Evlerin oturma alan\u0131 genelde 1000 ile 2500 metrekare aras\u0131nda yo\u011funluk g\u00f6stermektedir.","1a5ada14":"#### - ExterQual(D\u0131\u015f malzeme kalitesi)","390a8116":"## \u00d6nemli Kategorik De\u011fi\u015fkenlerin \u0130ncelenmesi","08dd057f":"# Base Model","844a554a":"## Feature Engineering","eedff560":"## MODEL","606ca57f":"# Hyperparameter Optimization with Selected Features","0b2a6e3d":"### Missing Values","da72b701":"## DATA PREPROCESSING & FEATURE ENGINEERING","d3754419":"* Di\u011fer \u015fehirlere bak\u0131ld\u0131\u011f\u0131nda en y\u00fcksek fiyatl\u0131 evler North Ridge de g\u00f6r\u00fcn\u00fcyor bu nedenle SalePrice i\u00e7in belirleyici.Burada ayk\u0131r\u0131l\u0131k olabilir.Ayk\u0131r\u0131l\u0131ktan etkilenmi\u015f olabilir.\n### North Ridge de fiyatlar\u0131n y\u00fcksek olmas\u0131n\u0131n sebebi California State \u00dcniversitesinin bu il\u00e7ede olmas\u0131 olabilir,yani belki de ayk\u0131r\u0131l\u0131k de\u011fildir.","743a8484":"#### - BsmtQual(Bodrum Y\u00fcksekli\u011fi)","ee508a7b":"### FirePlaceQu: \u015e\u00f6mine kalitesi\n* Ex: Excellent-Exceptional masonry fireplace(ola\u011fan\u00fcst\u00fc duvar \u015f\u00f6minesi)\n* Gd: Good - masonry fireplace in main level(ana seviyede)\n* TA: Average \/ Typical- Prefabricated Fireplace in main living area or Masonry Fireplace in      basement(Prefabrik \u015f\u00f6mine ya da bodurm kat\u0131nda \u015f\u00f6mine)\n* Fa: Fair- Prefabricated Fireplace in basement(bodrum prefabrik \u015f\u00f6mine)\n* Po: Poor- Ben Franklin Stove\n* NA: No fireplace","2e9f5770":"* Ara\u00e7 kapasitesi fazla olanlar\u0131n ev fiyatlar\u0131n\u0131n y\u00fcksek olmas\u0131n\u0131 bekleriz.\n* Ama 3 ara\u00e7 kapasiteli garaj\u0131 olan evlerin fiyatlar\u0131 4 ara\u00e7 kapasiteli olanlardan daha fazla olmas\u0131 dikkat \u00e7ekiyor.\n* 4 ara\u00e7 kapasiteli garaj\u0131 olan evlerin fiyat\u0131 daha d\u00fc\u015f\u00fck g\u00f6r\u00fcn\u00fcyor.\n* 2 ara\u00e7 kapasiteli garaj\u0131 olan evlerin say\u0131s\u0131 daha fazla.","413d21a0":"* **Hyperparameter Optimization**","c9f78aa5":"* Genel malzeme kalitesi y\u00fcksek olanlar\u0131n fiyatlar\u0131 daha y\u00fcksek.\n* Ama 10. kalitede olup fiyat\u0131 d\u00fc\u015f\u00fck olan iki g\u00f6zlem var bunlar ayk\u0131r\u0131 olabilir.\n* 5.ve 6. kalitede olan evlerin say\u0131s\u0131 daha fazla.","6af046c9":"* Yap\u0131m y\u0131l\u0131 1880 ile 1900 aras\u0131nda olup fiyat\u0131 y\u00fcksek olan evler var.Bunlar tarihi yap\u0131lar olabilir.\n* 2000 y\u0131l\u0131 sonras\u0131nda yap\u0131lan evlerin fiyatlar\u0131 artm\u0131\u015f.","3991b39e":"* 1.kat metrekare alan\u0131 b\u00fcy\u00fck olup fiyat\u0131 d\u00fc\u015f\u00fck olan evler var.Di\u011fer de\u011fi\u015fkenlerle incelenmeli.","9db69d7c":"#### - Neighborhood (Ames \u015fehir s\u0131n\u0131rlar\u0131 i\u00e7indeki fiziksel konum)","8a556b45":"### - Fence (\u00c7it kalitesi)","72c23afd":"* TotalBsmtSF de\u011fi\u015fkeni toplam \"Basement\" y\u00fcz\u00f6l\u00e7\u00fcm\u00fcn\u00fc veriyor.\"GrLivArea\" ve \"1stFlrSF\" ve \"2ndFlrSF\" alan \u00f6l\u00e7\u00fcmlerinin toplam\u0131 oldu\u011fu i\u00e7in bu de\u011fi\u015fkenlerin grafikleri ile benzer oldu\u011fu g\u00f6r\u00fcl\u00fcyor.","14bdb9e0":"## RARE ENCODING","5f28412b":"#### - LotConfig(Parsel yap\u0131land\u0131rma)","0885f749":"### - LandSlope(M\u00fclk\u00fcn e\u011fimi)","c0c9af18":"### BsmtQual: Bodrum y\u00fcksekli\u011fi\n* Ex: Excellent (100+inches)\n* Gd: Good (90-99)\n* TA: Average \/ Typical (80-89)\n* Fa: Fair (70-79)\n* Po: Poor (<70)\n* NA: No basement","cf45646d":"#### - LotShape(\u0130mar \u015fekli)","3e4abac1":"### - MasVnrType (Duvar kaplama t\u00fcr\u00fc)","b016fbdb":"* Garaj alan\u0131 b\u00fcy\u00fck olup fiyat\u0131 d\u00fc\u015f\u00fck olan evler var.\n* Hi\u00e7 garaj\u0131 olmayan evler var.\n","a1811a5b":"#### - GarageCars(Garaj\u0131n araba kapasitesi)","090e2c7f":"# Sonu\u00e7lar\u0131n Y\u00fcklenmesi","b500aa0f":"## Feature Selection","86c59a95":"## One-Hot Encoder","38f822e9":"* 3 \u015f\u00f6minesi olup fiyat\u0131 daha d\u00fc\u015f\u00fck olan evler var.","5e9430fc":"## OUTLIERS(Ayk\u0131r\u0131 de\u011ferler)","7b1b882f":"#### KitchenQual(Mutfak kalitesi)","315e53ac":"### Neighborhood: Ames \u015fehir s\u0131n\u0131rlar\u0131 i\u00e7indeki fiziksel konumlar\u0131\n* Neighborhood_NoRidge: Northridge","f6576477":"## NEW FEATURES(YEN\u0130 DE\u011e\u0130\u015eKENLER)"}}