{"cell_type":{"be95fbe1":"code","f5585759":"code","af756578":"code","cc57c347":"code","8ea208ff":"code","88e5f826":"code","451533de":"code","2f44da47":"code","8f531b4d":"code","f7ae1b48":"code","de1a7ed1":"code","f3a9eb62":"code","cb1c641f":"code","71386c7f":"code","573bd1e4":"code","3c28a748":"code","56022665":"code","558e732e":"code","1b140b6c":"code","7575e8f0":"code","b687b58f":"code","52c07da2":"code","1ef89af3":"code","b35ddba1":"markdown","de322f90":"markdown","e8518573":"markdown","63556d7a":"markdown","f1239d24":"markdown","cf1210a2":"markdown","39a3de43":"markdown","38630c8b":"markdown","d0390240":"markdown","5aa97252":"markdown","e64b1332":"markdown","e891fa36":"markdown","fd466cc0":"markdown","7477d78b":"markdown","b241d874":"markdown","6f2efe08":"markdown","4aa9c0be":"markdown"},"source":{"be95fbe1":"import pandas as pd\nimport numpy as np\nfrom catboost import Pool, CatBoostClassifier, cv, CatBoostRegressor\nimport sklearn.metrics as metrics\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import roc_auc_score\nfrom sklearn.metrics import precision_score, recall_score,f1_score,classification_report\nimport seaborn as sns\nfrom imblearn.over_sampling import SMOTE","f5585759":"dataset=pd.read_csv('..\/input\/creditcardfraud\/creditcard.csv')   ","af756578":"dataset.head()","cc57c347":"dataset['Class'].value_counts().plot(kind='bar',figsize=[10,5])\ndataset['Class'].value_counts()\n","8ea208ff":"dataset = dataset.drop(['Time', 'Amount'], axis=1)\n","88e5f826":"dataset.head()","451533de":"label=dataset['Class']\nData=dataset.drop([\"Class\"],axis=1)","2f44da47":"print(\"Data Types\\n{}\".format(Data.dtypes))","8f531b4d":"null_counts = Data.isnull().sum()\nprint(\"Number of null values in each feature:\\n{}\".format(null_counts))","f7ae1b48":"x_train,x_test,y_train,y_test = train_test_split(Data,label,test_size=0.33,random_state=1236)\n","de1a7ed1":"print(\"Label 1, Before using SMOTE: {} \".format(sum(y_train==1)))\nprint(\"Label 0, Before using SMOTE: {} \".format(sum(y_train==0)))","f3a9eb62":"OS = SMOTE(random_state=12)\nx_train_OS, y_train_OS = OS.fit_sample(x_train, y_train)","cb1c641f":"print(\"Label 1, After using SMOTE: {}\".format(sum(y_train_OS==1)))\nprint(\"Label 0, After using SMOTE: {}\".format(sum(y_train_OS==0)))","71386c7f":"model = CatBoostClassifier(iterations=100,\n                             depth=12,\n                             eval_metric='AUC',\n                             random_seed = 2018,\n                             od_type='Iter',\n                             metric_period = 1,\n                             od_wait=100)","573bd1e4":"model.fit(x_train_OS,y_train_OS)","3c28a748":"predict = model.predict(x_test)","56022665":"cm = pd.crosstab(y_test, predict, rownames=['Actual'], colnames=['Predicted'])\nfig, (ax1) = plt.subplots(ncols=1, figsize=(5,5))\n\nsns.heatmap(pd.DataFrame(cm), annot=True, cmap=\"Blues\" ,fmt='g',\n            xticklabels=['Not Fraud', 'Fraud'],\n            yticklabels=['Not Fraud', 'Fraud'],)\nax1.xaxis.set_label_position(\"top\")\nplt.tight_layout()\nplt.title('Confusion Matrix', y=1.1,fontsize=14)\nplt.show()","558e732e":"acc=accuracy_score(y_test,predict)\nprint('Accuracy =' ,acc)","1b140b6c":"precision = precision_score(y_test, predict)\nprint('Precision =' ,precision)","7575e8f0":"auc_score=roc_auc_score(y_test, predict)\nprint('AUC =' ,auc_score)","b687b58f":"fpr, tpr, threshold = metrics.roc_curve(y_test, predict)\nroc_auc = metrics.auc(fpr, tpr)\nplt.title('Receiver Operating Characteristic')\nplt.plot(fpr, tpr, 'b', label = 'AUC = %0.2f' % roc_auc)\nplt.legend(loc = 'lower right')\nplt.plot([0, 1], [0, 1],'r--')\nplt.xlim([0, 1])\nplt.ylim([0, 1])\nplt.ylabel('True Positive Rate')\nplt.xlabel('False Positive Rate')\nplt.show()\n","52c07da2":"recall = recall_score(y_test, predict)\nprint(\"Recall : \",recall )","1ef89af3":"f1score = f1_score(y_test,predict, average='macro')\nprint(\"F1 Score : \",f1score )","b35ddba1":"  <font color='black'> **F1 SCORE** <\/font>\n","de322f90":"<font color='black'> **Drop Time and Amount Columns** <\/font>","e8518573":"  <font color='black'> **Recall** <\/font>\n","63556d7a":"\n <font color='black'> **Delete Class feature from the dataset** <\/font>","f1239d24":" <font color='black'> **Create Model CatBoost** <\/font>","cf1210a2":" <font color='black'> **Accuracy** <\/font>","39a3de43":"\n#  <font color='red'> Simple Fraud Detection Using SMOTE and CatBoost <\/font>","38630c8b":"\n <font color='black'> **NULL Values in each feature** <\/font>","d0390240":"\n <font color='black'> **Oversampling Data Using SMOTE** <\/font>","5aa97252":" <font color='black'> **Confusion Matrix** <\/font>","e64b1332":" <font color='black'> **Prediction** <\/font>","e891fa36":" <font color='black'> **Precision** <\/font>","fd466cc0":"  <font color='black'> **AUC** <\/font>","7477d78b":"\n <font color='black'> **Features Data Types** <\/font>","b241d874":"\n <font color='black'> **Split data 1\/3 for the test and 2\/3 for the train** <\/font>","6f2efe08":"  <font color='black'> **ROC Curve** <\/font>\n","4aa9c0be":" <font color='black'> **Fitting** <\/font>"}}