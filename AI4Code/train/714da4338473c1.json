{"cell_type":{"b16b6451":"code","de80f5c1":"code","12d204f7":"code","f2ccb5ac":"code","455aca63":"code","ad564d17":"code","14e92692":"code","5bc68f9b":"code","f897e5b1":"code","936be171":"code","3b9a462b":"code","cf1030fc":"code","19a7aeff":"code","f0e9b9a3":"code","0c5ae536":"code","fa2cd2cc":"code","4baf64bf":"code","4edbe6bb":"code","ec36e343":"code","e3a91582":"code","705ba5cb":"code","9a0289ce":"code","61c0ed56":"code","81d37569":"code","c8e6743b":"code","76bbddd6":"code","7cc530d8":"code","2b7b7a9a":"code","31dcb7a6":"code","9b7c5878":"code","126318ee":"code","c56acc37":"code","236cedd1":"code","6816ada0":"code","5cb00f9a":"code","0aff3275":"code","66365d45":"code","f3eb43fd":"code","70c6c64b":"code","20f43e2d":"code","c4d0462e":"code","cfba91e0":"code","7550d2d8":"code","387a739a":"code","d3b52d25":"code","bfd67ab0":"code","07ac0234":"code","38dc082f":"code","d0832107":"code","c6d53e69":"code","6cdd8a60":"code","1accff57":"code","760b7dc4":"code","90108738":"code","5ead4e13":"code","fa7f45f1":"code","8c49d9d9":"code","5c2b364e":"code","4e605fd2":"code","49162996":"code","ec9fec13":"code","c9031930":"code","2bdaa33d":"markdown","00ccbaa7":"markdown","d71d148d":"markdown","277c69df":"markdown","4e6ee688":"markdown","a1017095":"markdown","361a3ce7":"markdown","7782f6e2":"markdown","b4a293e1":"markdown","4210e5ab":"markdown","a49f9690":"markdown","46658f97":"markdown","8c532912":"markdown","54b7bfdb":"markdown","7dd9b30b":"markdown","bb2afa9a":"markdown","c1d8a066":"markdown","08cf6b37":"markdown","664f164a":"markdown","0e1191e0":"markdown","ac149f02":"markdown","332ef4e4":"markdown","7da157ed":"markdown","5ae4cb48":"markdown","14b7cce5":"markdown"},"source":{"b16b6451":"import pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nimport os\nwarnings.filterwarnings(\"ignore\")","de80f5c1":"data = pd.read_csv('\/kaggle\/input\/bank-marketing-dataset\/bank.csv')","12d204f7":"data","f2ccb5ac":"data.columns","455aca63":"data.deposit.value_counts()","ad564d17":"sns.heatmap(data.isnull())","14e92692":"data.describe()","5bc68f9b":"sns.violinplot(data['pdays'])","f897e5b1":"print('median',data.pdays.median())\nprint('mean:',data.pdays.mean())\nprint('mode:',data.pdays.mode())","936be171":"data.pdays.value_counts()","3b9a462b":"dataWOP = data[data.pdays != -1]","cf1030fc":"sns.violinplot(dataWOP.pdays)","19a7aeff":"print('median',dataWOP.pdays.median())\nprint('mean:',dataWOP.pdays.mean())\nprint('mode:',dataWOP.pdays.mode())","f0e9b9a3":"data.balance.describe()","0c5ae536":"data.columns","fa2cd2cc":"data.education.value_counts()","4baf64bf":"sns.barplot(data.balance,data.education)","4edbe6bb":"sns.boxplot(data.pdays)\nprint('outliers with -1')","ec36e343":"sns.boxplot(dataWOP.pdays)\nprint('outliers without -1')","e3a91582":"plt.figure(figsize=(15,15))\nsns.heatmap(data.corr(),square=True,annot=True,cmap= 'twilight_shifted')","705ba5cb":"data.info()","9a0289ce":"data.replace({'deposit': {\"yes\": 1,'no':0}},inplace=True)","61c0ed56":"### identigyind categorical and numerical columns\ncols = data.columns\nnum_cols= data._get_numeric_data().columns\ncat_cols = list(set(cols) - set(num_cols))","81d37569":"for i in data[cat_cols]:\n    sns.barplot(data.deposit,data[i])\n    plt.show()","c8e6743b":"for i in data[num_cols]:\n    sns.barplot(data.deposit,data[i])\n    plt.show()","76bbddd6":"cols = data.columns\nnum_cols= data._get_numeric_data().columns\ncat_cols = list(set(cols) - set(num_cols))","7cc530d8":"data[cat_cols]","2b7b7a9a":"data[num_cols]","31dcb7a6":"from sklearn.preprocessing import LabelEncoder","9b7c5878":"data1 = data[cat_cols].apply(LabelEncoder().fit_transform)","126318ee":"data1","c56acc37":"dataf = data1.join(data[num_cols])","236cedd1":"dataf","6816ada0":"dataf[dataf.pdays == -1]","5cb00f9a":"dataf.pdays.value_counts()","0aff3275":"#dataf.drop('pdays',axis=1)","66365d45":"plt.figure(figsize=(20,20))\nsns.heatmap(dataf.corr(),square=True,annot=True,cmap= 'Spectral')","f3eb43fd":"dataf.corr()","70c6c64b":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import f1_score\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import roc_auc_score\nimport statsmodels.api as sm\nfrom sklearn.metrics import accuracy_score","20f43e2d":"for i in dataf.columns:\n    X = dataf[[i]]\n    y = dataf['deposit']\n    X_train,X_test,y_train,y_test = train_test_split(X,y,test_size = 0.3,random_state=101)\n    lr = LogisticRegression()\n    lr.fit(X_train,y_train)\n    y_pred = lr.predict(X_test)\n    print(\"F1 Score for\", i , f1_score(y_pred,y_test))","c4d0462e":"X = dataf.drop('deposit',axis=1)\ny = dataf['deposit']","cfba91e0":"X_train,X_test,y_train,y_test = train_test_split(X,y,test_size = 0.3,random_state=101)","7550d2d8":"lr = LogisticRegression(random_state=101)\nlr.fit(X_train,y_train)\ny_pred = lr.predict(X_test)","387a739a":"print('Report:\\n',classification_report(y_test, y_pred))\nprint(\"F1 Score:\",f1_score(y_pred,y_test))\nprint('confusion Matrix:\\n',confusion_matrix(y_pred,y_test))\nprint('cross validation:',cross_val_score(lr, X, y, cv=5))","d3b52d25":"model = sm.OLS(y, X)\nresults = model.fit()\nstart = \"\\033[1m\" ### for bold text\nprint(start)\nprint(results.summary())","bfd67ab0":"### Using Rfe\nfrom sklearn.feature_selection import RFE\nrfe = RFE(lr, 15)\nrfe.fit(X_train,y_train)","07ac0234":"print(X_train.columns[rfe.support_])\ncols = X_train.columns[rfe.support_]\nlr.fit(X_train[cols],y_train)\ny_pred2 = lr.predict(X_test[cols])","38dc082f":"def logReggResult():\n    print('Report:\\n',classification_report(y_test, y_pred2))\n    print(\"F1 Score:\",f1_score(y_pred2,y_test))\n    print('AUC score:',roc_auc_score(y_test,y_pred2))\n    print('confusion Matrix:\\n',confusion_matrix(y_pred2,y_test))\n    print('kfold cross validation:\\n',cross_val_score(lr, X, y, cv=5))\n    print(\"Acurracy :::>\",accuracy_score(y_pred2,y_test))","d0832107":"logReggResult()","c6d53e69":"## Feature Importance\nfrom sklearn.feature_selection import SelectFromModel\nsmf = SelectFromModel(lr)\nsmf.fit(X_train,y_train)\nfeatures = smf.get_support()\nfeature_name = X_train.columns[features]\nfeature_name","6cdd8a60":"importances=feature_name\nfeature_importances=pd.Series(importances).sort_values(ascending=False)\nsns.barplot(x=feature_importances[0:10], y=feature_importances.index[0:10])\nplt.title('Feature Importance',size=20)\nplt.ylabel(\"Features\")\nplt.show()","1accff57":"from sklearn.ensemble import RandomForestClassifier","760b7dc4":"X = dataf.drop('deposit',axis=1)\ny = dataf['deposit']\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size = 0.3,random_state=101)","90108738":"rfc = RandomForestClassifier(n_estimators=50,max_depth=5, random_state=101,max_leaf_nodes=50)\nrfc.fit(X_train,y_train)","5ead4e13":"y_pred1 = rfc.predict(X_test)","fa7f45f1":"from sklearn.tree import export_graphviz\nestimator = rfc.estimators_[5]\n# Export as dot file\nexport_graphviz(estimator, \n                out_file='tree1.dot', \n                feature_names = X_train.columns,\n                class_names = 'deposit',\n                rounded = True, proportion = False, \n                precision = 2, filled = True)","8c49d9d9":"os.system('dot -Tpng tree1.dot -o tree1.png')","5c2b364e":"from IPython.display import Image\nImage(filename = 'tree1.png')","4e605fd2":"def RF():\n    print('Report:\\n',classification_report(y_test, y_pred1))\n    print(\"F1 Score:\",f1_score(y_pred1,y_test))\n    print('confusion Matrix:\\n',confusion_matrix(y_pred1,y_test))\n    print('cross validation:',cross_val_score(rfc, X, y, cv=5))\n    print('AUC score:',roc_auc_score(y_test,y_pred))\n    print(\"Acurracy :::>\",accuracy_score(y_pred,y_test))","49162996":"RF()","ec9fec13":"importances=rfc.feature_importances_\nfeature_importances=pd.Series(importances, index=X_train.columns).sort_values(ascending=False)\nsns.barplot(x=feature_importances[0:10], y=feature_importances.index[0:10])\nplt.title('Feature Importance',size=20)\nplt.ylabel(\"Features\")\nplt.show()","c9031930":"print (start + \"############### Random Forest Result: ###############\\n\")\nRF()\nprint(start +'\\n\\n############# Logistic Regression Result: ############\\n')\nlogReggResult()","2bdaa33d":"## PreProcessing","00ccbaa7":"# Comparision ","d71d148d":"### We choose the F1 Score and Confustion Matrix for the Final comparision of both Models because the Target Variable is imbalanced. So, Precision and Recall can be the main factor for evaluation model and we get the harmonic mean for the same in form of F1 score.","277c69df":"### We see that the Random Forest has Perfomed good in comparision to Logistic Regression.","4e6ee688":"##### As there are no values for customers who were not approached ( -1). The mean median and mode have changed significantly.","a1017095":"## Random Forest Classifier","361a3ce7":"### Visualizing Categorical Features with Deposit","7782f6e2":"#### 2 -\tDescribe the pdays column again, this time limiting yourself to the relevant values of pdays. How different are the mean and the median values?","b4a293e1":"### EDA","4210e5ab":"##### After analyzing the we know that Pdays dones play any important role in model so we keep it as it is.\n##### The -1 or the missing values are kept as it is as we would not be using that in modelling part","a49f9690":"## ML Modelling","46658f97":"## Using RFE","8c532912":"# Chintan Chitroda\n## Logistic Regression VS Random Forest Comparision\n##### Note : Acurracy and F1 score can be increased with use of Boosting Algorithms.\n##### The Notebook Visualize the data from Bank Marketing and predict if the customer will respond positively to the campaign or not, For the target variable is \u201cDeposit\u201d.","54b7bfdb":"#### NO null values","7dd9b30b":"### Please do Upvote if you like kernal.","bb2afa9a":"### The Main Features for the both Models\/ Algorithm Differs as Random Forest and Logistic Regression Works on different Principal","c1d8a066":"###### 1  -Describe the pdays column, make note of the mean, median and minimum values. Anything fishy in the values?","08cf6b37":"### Random Forest has Better F1 score,  AUC,  Confusion Matrix, kfold Cross val and accuracy in compare to Logistic Regression.","664f164a":"### More than 70% of pdays have -1.","0e1191e0":"#### Yes we can seee there are outliers in pdays","ac149f02":"## All Features","332ef4e4":"###### 3 -\tPlot a horizontal bar graph with the median values of balance for each education level value. Which group has the highest median?","7da157ed":"######  4 - Make a box plot for pdays. Do you see any outliers?","5ae4cb48":"###  Visualizing Numerical Features with Deposit","14b7cce5":"### All Single feature with Logistic Regression"}}