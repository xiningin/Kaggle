{"cell_type":{"c3b97eca":"code","604b95ae":"code","778ac671":"code","82e9d16f":"code","54841ae2":"code","4e63de83":"code","2a452a8b":"code","fc1fada6":"code","d71be681":"code","f5ff2562":"code","ee3c300f":"code","35390d8a":"code","43087a6b":"code","030da737":"code","a3b0130b":"code","218e1e38":"code","8eeb9302":"code","4a136a9b":"code","3f2eeb79":"markdown","afa37c8a":"markdown","304df1a4":"markdown","79932364":"markdown","0df89146":"markdown","e7664527":"markdown","a020f746":"markdown","cc62f626":"markdown","c1e48854":"markdown","4af3c0ae":"markdown","0bfa7a1b":"markdown","221c0191":"markdown","034aa632":"markdown","bb547184":"markdown","20641730":"markdown","5e1258bd":"markdown","85ae5682":"markdown","f8239760":"markdown","0fd14d55":"markdown","852a5347":"markdown","035caac9":"markdown","63b07b5c":"markdown","e6ef0dd9":"markdown"},"source":{"c3b97eca":"import pandas as pd\nimport numpy as np\nimport os\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n# Don't Show Warning Messages\nimport warnings\nwarnings.filterwarnings('ignore')","604b95ae":"# demographic_info.txt was added in version 2\n\nos.listdir('..\/input')","778ac671":"os.listdir('..\/input\/respiratory_sound_database\/Respiratory_Sound_Database')","82e9d16f":"# Install the pydub library\n\n# Check that kernel Internet is connected before running this cell\n! pip install pydub","54841ae2":"# Play an audio file\n\nfrom pydub import AudioSegment\nimport IPython\n\n# We will listen to this file:\n# 213_1p5_Pr_mc_AKGC417L.wav\n\naudio_file = '213_1p5_Pr_mc_AKGC417L.wav'\n\npath = \\\n'..\/input\/respiratory_sound_database\/Respiratory_Sound_Database\/audio_and_txt_files\/' + audio_file\n\nIPython.display.Audio(path)","4e63de83":"path ='..\/input\/demographic_info.txt'\ncol_names = ['patient_id', 'age', 'sex', 'adult_bmi', 'child_weight', 'child_height']\n\n# Adult BMI (kg\/m2)\n# Child Weight (kg)\n# Child Height (cm)\n\ndf_demo = pd.read_csv(path, sep=\" \", header=None, names=col_names)\n\ndf_demo.head(10)","2a452a8b":"path = \\\n'..\/input\/respiratory_sound_database\/Respiratory_Sound_Database\/patient_diagnosis.csv'\n\ndf_diag = pd.read_csv(path, header=None, names=['patient_id', 'diagnosis'])\n\ndf_diag.head(10)","fc1fada6":"path = \\\n'..\/input\/respiratory_sound_database\/Respiratory_Sound_Database\/filename_differences.txt'\n\ndf_diff = pd.read_csv(path, sep=\" \", header=None, names=['file_names'])\n\ndf_diff.head(10)","d71be681":"path = \\\n'..\/input\/respiratory_sound_database\/Respiratory_Sound_Database\/filename_format.txt'\n\ndata = open(path, 'r').read()\n\ndata","f5ff2562":"path = \\\n'..\/input\/respiratory_sound_database\/Respiratory_Sound_Database\/audio_and_txt_files'\n\nos.listdir(path)","ee3c300f":"path = \\\n'..\/input\/respiratory_sound_database\/Respiratory_Sound_Database\/audio_and_txt_files\/154_2b4_Al_mc_AKGC417L.txt'\n\ncol_names = ['Beginning_of_respiratory_cycle', 'End_of_respiratory_cycle', 'Presence\/absence_of_crackles', 'Presence\/absence_of_wheezes']\n\n# Respiratory cycle column values are in 'seconds'.\n# Presence = 1\n# Absence = 0\n\ndf_annot = pd.read_csv(path, sep=\"\\t\", header=None, names=col_names)\n\ndf_annot.head(10)","35390d8a":"path = \\\n'..\/input\/respiratory_sound_database\/Respiratory_Sound_Database\/audio_and_txt_files\/154_2b4_Al_mc_AKGC417L.txt'\n\ncol_names = ['Beginning_of_respiratory_cycle', 'End_of_respiratory_cycle', 'Presence\/absence_of_crackles', 'Presence\/absence_of_wheezes']\n\n# Respiratory cycle column values are in 'seconds'.\n# Presence = 1\n# Absence = 0\n\ndf_annot = pd.read_csv(path, sep=\"\\t\", header=None, names=col_names)\n\ndf_annot.head(20)","43087a6b":"# Install the pysoundfile library\n! pip install pysoundfile","030da737":"import soundfile as sf\n\n# Define helper functions\n\n# Load a .wav file. \n# These are 24 bit files. The PySoundFile library is able to read 24 bit files.\n# https:\/\/pysoundfile.readthedocs.io\/en\/0.9.0\/\n\ndef get_wav_info(wav_file):\n    data, rate = sf.read(wav_file)\n    return data, rate\n\n# source: Andrew Ng Deep Learning Specialization, Course 5\ndef graph_spectrogram(wav_file):\n    data, rate = get_wav_info(wav_file)\n    nfft = 200 # Length of each window segment\n    fs = 8000 # Sampling frequencies\n    noverlap = 120 # Overlap between windows\n    nchannels = data.ndim\n    if nchannels == 1:\n        pxx, freqs, bins, im = plt.specgram(data, nfft, fs, noverlap = noverlap)\n    elif nchannels == 2:\n        pxx, freqs, bins, im = plt.specgram(data[:,0], nfft, fs, noverlap = noverlap)\n    return pxx","a3b0130b":"# plot the spectrogram\n\npath = \\\n'..\/input\/respiratory_sound_database\/Respiratory_Sound_Database\/audio_and_txt_files\/154_2b4_Al_mc_AKGC417L.wav'\n\n\nx = graph_spectrogram(path)","218e1e38":"# choose an audio file\naudio_file = '154_2b4_Al_mc_AKGC417L.wav'\n\npath = \\\n'..\/input\/respiratory_sound_database\/Respiratory_Sound_Database\/audio_and_txt_files\/' + audio_file\n\n# read the file\ndata, rate = sf.read(path)\n\n# display the numpy array\ndata","8eeb9302":"# https:\/\/stackoverflow.com\/questions\/37999150\/\n# python-how-to-split-a-wav-file-into-multiple-wav-files\n\nfrom pydub import AudioSegment\n\n# note: Time is given in seconds. Will be converted to milliseconds later.\nstart_time = 0\nend_time = 7\n\nt1 = start_time * 1000 # pydub works in milliseconds\nt2 = end_time * 1000\nnewAudio = AudioSegment.from_wav(path) # path is defined above\nnewAudio = newAudio[t1:t2]\nnewAudio.export('new_slice.wav', format=\"wav\")","4a136a9b":"# Lets listen to the new slice\n\nIPython.display.Audio('new_slice.wav')","3f2eeb79":"A microphone records small variations in air pressure (represented by changes in voltage) over time. The ear percieves these slight variations in air pressure as sound. The spectrogram tells us how much different frequencies are present (loudness) in an audio clip at a moment in time.","afa37c8a":"### b. Read the 'patient_diagnosis.csv' file","304df1a4":"## How to slice a section from an audio file","79932364":"Time is on the x axis and Frequencies are on the y axis. The intensity of the different colours shows the amount of energy i.e. how loud the sound is, at different frequencies, at different times.","0df89146":"##  Create an Audio  Spectrogram","e7664527":"### a. Read the 'demographic_info.txt' file","a020f746":"There are a total of 4 files and one folder.","cc62f626":"### e. List the files in the 'audio_and_txt_files' folder","c1e48854":"<hr>\nI hope you enjoy working with this dataset.","4af3c0ae":"## What files are available?","0bfa7a1b":"## Introduction","221c0191":"### c. Read the 'filename_differences.txt' file","034aa632":"## Helpful Resources","bb547184":"<hr>","20641730":"We see that this recording contains 7 respiration cycles. We also see that crackles are present on 5 of the 7 cycles.","5e1258bd":"## Listen to an Audio File","85ae5682":"## Read the Files","f8239760":"## Read an audio file as a numpy array","0fd14d55":"We will use this audio file:<br>\n154_2b4_Al_mc_AKGC417L.wav\n\nFirst let's take a look at the annotation text file for this audio recording to see how many respiration cycles have been recorded.","852a5347":"I found these resources very helpful:\n\n1. Andrew Ng Sequence Models Course, Week 3, Trigger Word Detection Assignment<br>\nhttps:\/\/www.coursera.org\/learn\/nlp-sequence-models\n\n2. PySoundFile Library<br>\nhttps:\/\/pysoundfile.readthedocs.io\/en\/0.9.0\/\n\n3. How to read a 24 bit wav file<br>\nhttps:\/\/stackoverflow.com\/questions\/16719453\/how-to-read-and-write-24-bit-wav-file-using-scipy-or-common-alternative\n\n4. PyDub Library<br>\nhttps:\/\/github.com\/jiaaro\/pydub\n","035caac9":"This quick kernel provides the code to help you do the following:\n    \n    - Listen to an audio file in a jupyter notebook\n    - Read the files associated with this dataset\n    - Create a spectrogram\n    - Read an audio file as a numpy array\n    - Slice an audio file into sections","63b07b5c":"### f. Display the contents of one annotation .txt file","e6ef0dd9":"### d. Read the 'filename_format.txt' file\n\nThe file naming format is described on the Kaggle description page for this dataset. That description reads much more clearly than the format displayed here."}}