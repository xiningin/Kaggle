{"cell_type":{"b0ff8ff7":"code","b05293d3":"code","3c63a3b2":"code","c8a52ff5":"code","e460215d":"code","6e2c1959":"code","5bc14c4d":"code","5482591c":"code","71439454":"code","f6be2cb0":"code","28e4c48a":"code","c9a95d46":"code","c81bfd86":"code","8955642e":"code","107af9e6":"code","e39c686f":"code","1a3fffd1":"code","2d82d9ba":"code","51eb14e2":"code","bd8be915":"code","a440f21d":"code","905c39cf":"code","8ff64a79":"code","41cf0136":"code","4dd4353d":"code","0659e84c":"code","6966624e":"code","f39208fc":"code","1da91cb1":"code","eb039925":"code","e189df1a":"code","da454a60":"code","f52b5dd0":"code","ef306071":"code","b5baa2d1":"code","3f490456":"code","3148baed":"code","4cb3a356":"code","5bb2c8d3":"code","d52e347b":"code","d5f17b22":"code","28526fe5":"code","98919be3":"code","ace8eb1d":"code","f4906b40":"code","97f80da9":"code","9e0b5e92":"code","cb53dc59":"code","e84f9faf":"code","bc71b91a":"code","e6e30612":"code","e010d882":"code","fd568961":"code","e9fe75eb":"code","23abdd3e":"code","e3f56381":"code","6ca17c70":"code","47964a37":"code","243a5967":"markdown","791c6c4c":"markdown","88f49012":"markdown","95c02ec7":"markdown","2e51e39f":"markdown"},"source":{"b0ff8ff7":"import numpy as np\nimport pandas as pd\nfrom pandas import Series, DataFrame","b05293d3":"import seaborn as sns\nimport matplotlib.pyplot as plt","3c63a3b2":"sns.set_style('whitegrid')\n%matplotlib inline","c8a52ff5":"train_df=pd.read_csv('..\/input\/train.csv')\ntest_df=pd.read_csv('..\/input\/test.csv')","e460215d":"train_df.head()","6e2c1959":"test_df.head()","5bc14c4d":"#Calculating the number of male\/female passenger Survived.\nsns.countplot(x='Survived',data=train_df,hue='Sex')","5482591c":"#Plotting the percentage of passengers survived according to the Class they were in. \nsns.factorplot(x='Pclass',data=train_df,kind='count',hue='Survived')","71439454":"#Further breaking the above graph to male\/female level\nsns.factorplot(x='Survived',data=train_df,hue='Sex',kind='count',col='Pclass')","f6be2cb0":"#Age distribution of the passengers\nsns.distplot(train_df['Age'].dropna(),bins=30,kde=False)","28e4c48a":"#Survivers according to their gender and Pclass\nsns.factorplot(x='Pclass',y='Survived',data=train_df,hue='Sex')","c9a95d46":"train_df.info()\nprint('_'*40)\ntest_df.info()","c81bfd86":"#Dropping Cabin column from both datasets\ntrain_df.drop(['Cabin'],inplace=True,axis=1)\ntest_df.drop(['Cabin'],inplace=True,axis=1)","8955642e":"train_df['Embarked']=train_df['Embarked'].fillna('S')","107af9e6":"test_df['Fare']=test_df['Fare'].fillna(test_df['Fare'].mean())","e39c686f":"train_df.head()","1a3fffd1":"plt.figure(figsize=(10,6))\nsns.boxplot(x='Pclass',y='Age',data=train_df)","2d82d9ba":"def age_mean(x):\n    Age,Pclass=x\n    if pd.isnull(Age):\n        if Pclass==1:\n            return 37\n        elif Pclass==2:\n            return 28\n        else:\n            return 24\n    else:\n        return Age","51eb14e2":"train_df['Age']=train_df[['Age','Pclass']].apply(age_mean,axis=1)","bd8be915":"plt.figure(figsize=(10,6))\nsns.boxplot(x='Pclass',y='Age',data=test_df)","a440f21d":"def age_mean_test(x):\n    Age,Pclass=x\n    if pd.isnull(Age):\n        if Pclass==1:\n            return 43\n        elif Pclass==2:\n            return 26\n        else:\n            return 25\n    else:\n        return Age","905c39cf":"test_df['Age']=test_df[['Age','Pclass']].apply(age_mean_test,axis=1)","8ff64a79":"plt.figure(figsize=(10,6))\nsns.heatmap(train_df.isnull())","41cf0136":"plt.figure(figsize=(10,6))\nsns.heatmap(test_df.isnull())","4dd4353d":"def m_f(x):\n    Sex=x\n    if Sex=='male':\n        return 1\n    else:\n        return 0","0659e84c":"train_df['Sex']=train_df['Sex'].apply(m_f)\ntest_df['Sex']=test_df['Sex'].apply(m_f)","6966624e":"train_df.head()","f39208fc":"def name(x):\n    Name=x\n    if Name=='Mr.':\n        return 'Mr'\n    elif Name=='Miss.':\n        return 'Miss'\n    elif Name=='Mrs.':\n        return 'Mrs'\n    else:\n        return 'other'","1da91cb1":"train_df['Name']=train_df['Name'].map(lambda x: x.split(' ')[1])","eb039925":"train_df['Name']=train_df['Name'].apply(name)","e189df1a":"test_df['Name']=test_df['Name'].map(lambda x: x.split(' ')[1])","da454a60":"test_df['Name']=test_df['Name'].apply(name)","f52b5dd0":"train_df.info()\nprint('_'*40)\ntest_df.info()","ef306071":"train_df.head()","b5baa2d1":"test_df.head()","3f490456":"nametrain=pd.get_dummies(train_df['Name'],drop_first=True)\nnametest=pd.get_dummies(test_df['Name'],drop_first=True)","3148baed":"embarkedtrain=pd.get_dummies(train_df['Embarked'],drop_first=True)\nembarkedtest=pd.get_dummies(test_df['Embarked'],drop_first=True)","4cb3a356":"pclasstrain=pd.get_dummies(train_df['Pclass'],drop_first=True)\npclasstest=pd.get_dummies(test_df['Pclass'],drop_first=True)","5bb2c8d3":"tr_df=pd.concat([train_df,nametrain,embarkedtrain,pclasstrain],axis=1)\nte_df=pd.concat([test_df,nametest,embarkedtest,pclasstest],axis=1)","d52e347b":"te_df.drop(['Name','Embarked','Pclass','Ticket'],axis=1,inplace=True)\ntr_df.drop(['Name','Embarked','Pclass','Ticket'],axis=1,inplace=True)","d5f17b22":"tr_df.head()","28526fe5":"#Applying Mean Normalization to both datasets","98919be3":"tr_df['Age']=(tr_df['Age']-tr_df['Age'].mean())\/(tr_df['Age'].max()-tr_df['Age'].min())\ntr_df['Fare']=(tr_df['Fare']-tr_df['Fare'].mean())\/(tr_df['Fare'].max()-tr_df['Fare'].min())\ntr_df.head()","ace8eb1d":"te_df['Age']=(te_df['Age']-te_df['Age'].mean())\/(te_df['Age'].max()-te_df['Age'].min())\nte_df['Fare']=(te_df['Fare']-te_df['Fare'].mean())\/(te_df['Fare'].max()-te_df['Fare'].min())\ntr_df.head()","f4906b40":"x_train=tr_df[['Sex', 'Age', 'SibSp', 'Parch','Fare', 'Mr', 'Mrs', 'other', 'Q', 'S',2,3]]\ny_train=tr_df['Survived']","97f80da9":"x_test=te_df[['Sex', 'Age', 'SibSp', 'Parch', 'Fare', 'Mr','Mrs', 'other', 'Q', 'S',2,3]]","9e0b5e92":"#Data looks clean and nice, it's time for the model training.","cb53dc59":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import RandomForestClassifier\n","e84f9faf":"lr=LogisticRegression()","bc71b91a":"lr.fit(x_train,y_train)","e6e30612":"lr.score(x_train,y_train)","e010d882":"svc=SVC()","fd568961":"svc.fit(x_train,y_train)","e9fe75eb":"svc.score(x_train,y_train)","23abdd3e":"rnf=RandomForestClassifier()","e3f56381":"rnf.fit(x_train,y_train)","6ca17c70":"rnf.score(x_train,y_train)","47964a37":"a","243a5967":"# Data Cleaning","791c6c4c":"#Random Forest","88f49012":"# Data Visualization","95c02ec7":"#LogisticRegression","2e51e39f":"#SVM"}}