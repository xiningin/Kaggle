{"cell_type":{"ee976f85":"code","fa93523c":"code","a7f2049d":"code","4eeb57ab":"code","076fa93f":"code","41bb60f9":"code","90f80ab9":"code","9df02a39":"code","71e8f6f1":"code","53e13872":"code","ed155827":"code","d5979c9c":"code","7f05dfcd":"code","a6c34c23":"code","d931e466":"code","2fc79de6":"code","c02b69e1":"code","c5557575":"code","00c7b2b6":"code","0e114137":"code","ada908eb":"code","d9188325":"code","e7a7d086":"code","f51d8a24":"code","99c41bf1":"code","a7260356":"code","616ac80c":"code","e321b1c0":"code","83406340":"code","82885e89":"code","d09669c9":"code","0252da79":"code","55c59911":"markdown","93ab2aa1":"markdown","1f0a4a99":"markdown","fe1054be":"markdown","5cbcc305":"markdown","b4e4511e":"markdown","d2c6c75c":"markdown","2ee15d41":"markdown","2d95cbc5":"markdown","2104ec9b":"markdown","142fa7b2":"markdown","e084a43a":"markdown","d91126e2":"markdown","effe45fc":"markdown","d622dede":"markdown","918f5323":"markdown","d664daea":"markdown","a7f7efe3":"markdown","f99408fa":"markdown","5177c1bf":"markdown","e287e3ce":"markdown","fc0e88a5":"markdown","c176fc29":"markdown","25384614":"markdown","b95b5205":"markdown","bb1aae95":"markdown","d6f57f12":"markdown","f01c5af8":"markdown","7c8156cb":"markdown","1a906654":"markdown","bff4ef3c":"markdown","cae77c12":"markdown","b7936072":"markdown","4f429b38":"markdown","bb8a18eb":"markdown","4b6b392e":"markdown"},"source":{"ee976f85":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport statsmodels.formula.api as sm\nimport statsmodels.api as sma\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","fa93523c":"dfA = pd.read_csv(\"..\/input\/catshw4\/cats-hw4.csv\")\ndfA = dfA.drop([dfA.columns[0]],axis=1)\ndfA.head()","a7f2049d":"dfA.describe()","4eeb57ab":"dfA['SexNumber'] = dfA['Sex'].map({'F': 0, 'M': 1})\n","076fa93f":"#Model Fit Without interaction\nmodelA1 = sm.ols(formula=\"Hwt ~ Bwt+SexNumber\",data=dfA).fit()\nprint(modelA1.summary())","41bb60f9":"#Model Fit Without interaction\nmodelA2 = sm.ols(formula=\"Hwt ~ Bwt*SexNumber\",data=dfA).fit()\nprint(modelA2.summary())\n","90f80ab9":"inputTestA = pd.DataFrame()\ninputTestA[\"Bwt\"] = [3.4]\ninputTestA[\"SexNumber\"] = [0]\nprint(inputTestA)","9df02a39":"outputA1 = modelA1.predict(inputTestA)\nprint(outputA1)","71e8f6f1":"outputA2 = modelA2.predict(inputTestA)\nprint(outputA2)","53e13872":"dfB = pd.read_csv(\"..\/input\/treehw4\/trees.csv\")\ndfB = dfB.drop([dfB.columns[0]],axis=1)\ndfB.dropna()\ndfB.head()","ed155827":"#main effect only\nmodelB1 = sm.ols(formula=\"Volume ~ Girth+Height\",data=dfB).fit()\nprint(modelB1.summary())","d5979c9c":"#with interaction\nmodelB1B = sm.ols(formula=\"Volume ~ Girth*Height\",data=dfB).fit()\nprint(modelB1B.summary())","7f05dfcd":"#log without interaction\nmodelB2A = sm.ols(formula=\"Volume ~ np.log(Girth)+np.log(Height)\",data=dfB).fit()\nprint(modelB2A.summary())","a6c34c23":"#log with interaction\nmodelB2A = sm.ols(formula=\"Volume ~ np.log(Girth)*np.log(Height)\",data=dfB).fit()\nprint(modelB2A.summary())","d931e466":"dfC = pd.read_csv(\"..\/input\/mtcarshw4\/mtcars.csv\")\ndfC = dfC.dropna()\ndfC.head()","2fc79de6":"modelCA = sm.ols(formula=\"mpg ~ hp*cyl+wt\",data=dfC).fit()\nprint(modelCA.summary())","c02b69e1":"print(\"Car1\", modelCA.predict(pd.DataFrame({\"hp\": [100],\"cyl\": [4], \"wt\": [2.1]})))\nprint(\"Car2\", modelCA.predict(pd.DataFrame({\"hp\": [210],\"cyl\": [8], \"wt\": [3.9]})))\nprint(\"Car3\", modelCA.predict(pd.DataFrame({\"hp\": [200],\"cyl\": [6], \"wt\": [2.9]})))","c5557575":"dfD = pd.read_csv(\"..\/input\/diabethw4\/diabetes.csv\")\ndfD.isnull().sum()\n","00c7b2b6":"dfD.count()","0e114137":"dfD = dfD.dropna()\ndfD.head()","ada908eb":"#Model Intercept only\ndiaNull = sm.ols(formula=\"chol ~ 1\",data=dfD).fit()\nprint(diaNull.summary())","d9188325":"#diaFull, Overly complex model with a four-way interaction (and all lower-order terms) among age, gender, weight, and frame; a three-way interaction (and all lower-order terms) among waist, height, and hip; and a main effect for location.\ndiaFull = sm.ols(formula=\"chol ~ age*gender*weight*frame+waist*height*hip+location\",data=dfD).fit()\nprint(diaFull.summary())","e7a7d086":"chol1 = sm.ols(formula=\"chol ~ 1\",data=dfD).fit()\nchol2 = sm.ols(formula=\"chol ~ age\",data=dfD).fit()\nchol3 = sm.ols(formula=\"chol ~ gender\",data=dfD).fit()\nchol4 = sm.ols(formula=\"chol ~ weight\",data=dfD).fit()\nchol5 = sm.ols(formula=\"chol ~ frame\",data=dfD).fit()\nchol6 = sm.ols(formula=\"chol ~ waist\",data=dfD).fit()\nchol7 = sm.ols(formula=\"chol ~ height\",data=dfD).fit()\nchol8 = sm.ols(formula=\"chol ~ hip\",data=dfD).fit()\nchol9 = sm.ols(formula=\"chol ~ location\",data=dfD).fit()\nprint(sma.stats.anova_lm(chol1,chol2))\nprint(sma.stats.anova_lm(chol1,chol3))\nprint(sma.stats.anova_lm(chol1,chol4))\nprint(sma.stats.anova_lm(chol1,chol5))\nprint(sma.stats.anova_lm(chol1,chol6))\nprint(sma.stats.anova_lm(chol1,chol7))\nprint(sma.stats.anova_lm(chol1,chol8))\nprint(sma.stats.anova_lm(chol1,chol9))","f51d8a24":"chol1 = sm.ols(formula=\"chol ~ age\",data=dfD).fit()\nchol2 = sm.ols(formula=\"chol ~ age+gender\",data=dfD).fit()\nchol3 = sm.ols(formula=\"chol ~ age+weight\",data=dfD).fit()\nchol4 = sm.ols(formula=\"chol ~ age+frame\",data=dfD).fit()\nchol5 = sm.ols(formula=\"chol ~ age+waist\",data=dfD).fit()\nchol6 = sm.ols(formula=\"chol ~ age+height\",data=dfD).fit()\nchol7 = sm.ols(formula=\"chol ~ age+hip\",data=dfD).fit()\nchol8 = sm.ols(formula=\"chol ~ age+location\",data=dfD).fit()\nprint(sma.stats.anova_lm(chol1,chol2))\nprint(sma.stats.anova_lm(chol1,chol2)[\"Pr(>F)\"][1])\nprint(sma.stats.anova_lm(chol1,chol3))\nprint(sma.stats.anova_lm(chol1,chol4))\nprint(sma.stats.anova_lm(chol1,chol5))\nprint(sma.stats.anova_lm(chol1,chol6))\nprint(sma.stats.anova_lm(chol1,chol7))\nprint(sma.stats.anova_lm(chol1,chol8))","99c41bf1":"chol1 = sm.ols(formula=\"chol ~ age+gender\",data=dfD).fit()\nchol2 = sm.ols(formula=\"chol ~ age+gender+weight\",data=dfD).fit()\nchol3 = sm.ols(formula=\"chol ~ age+gender+frame\",data=dfD).fit()\nchol4 = sm.ols(formula=\"chol ~ age+gender+waist\",data=dfD).fit()\nchol5 = sm.ols(formula=\"chol ~ age+gender+height\",data=dfD).fit()\nchol6 = sm.ols(formula=\"chol ~ age+gender+hip\",data=dfD).fit()\nchol7 = sm.ols(formula=\"chol ~ age+gender+location\",data=dfD).fit()\nprint(sma.stats.anova_lm(chol1,chol2))\nprint(sma.stats.anova_lm(chol1,chol3))\nprint(sma.stats.anova_lm(chol1,chol4))\nprint(sma.stats.anova_lm(chol1,chol5))\nprint(sma.stats.anova_lm(chol1,chol6))\nprint(sma.stats.anova_lm(chol1,chol7))","a7260356":"chol1 = sm.ols(formula=\"chol ~ age+gender+weight+frame+waist+height+hip+location\",data=dfD).fit()\nchol2 = sm.ols(formula=\"chol ~ gender+weight+frame+waist+height+hip+location\",data=dfD).fit() #no age\nchol3 = sm.ols(formula=\"chol ~ age+weight+frame+waist+height+hip+location\",data=dfD).fit() #no gender\nchol4 = sm.ols(formula=\"chol ~ age+gender+frame+waist+height+hip+location\",data=dfD).fit() #no weight\nchol5 = sm.ols(formula=\"chol ~ age+gender+weight+waist+height+hip+location\",data=dfD).fit() #no frame\nchol6 = sm.ols(formula=\"chol ~ age+gender+weight+frame+height+hip+location\",data=dfD).fit() #no waist\nchol7 = sm.ols(formula=\"chol ~ age+gender+weight+frame+waist+hip+location\",data=dfD).fit() #no height\nchol8 = sm.ols(formula=\"chol ~ age+gender+weight+frame+waist+height+location\",data=dfD).fit() #no hip\nchol9 = sm.ols(formula=\"chol ~ age+gender+weight+frame+waist+height+hip\",data=dfD).fit() #no location\nprint(sma.stats.anova_lm(chol2, chol1))\nprint(sma.stats.anova_lm(chol3, chol1))\nprint(sma.stats.anova_lm(chol4, chol1))\nprint(sma.stats.anova_lm(chol5, chol1))\nprint(sma.stats.anova_lm(chol6, chol1))\nprint(sma.stats.anova_lm(chol7, chol1))\nprint(sma.stats.anova_lm(chol8, chol1))\nprint(sma.stats.anova_lm(chol9, chol1))","616ac80c":"chol1 = sm.ols(formula=\"chol ~ age+gender+frame+waist+height+hip+location\",data=dfD).fit()\nchol2 = sm.ols(formula=\"chol ~ gender+frame+waist+height+hip+location\",data=dfD).fit() #no age\nchol3 = sm.ols(formula=\"chol ~ age+frame+waist+height+hip+location\",data=dfD).fit() #no gender\nchol4 = sm.ols(formula=\"chol ~ age+gender+waist+height+hip+location\",data=dfD).fit() #no frame\nchol5 = sm.ols(formula=\"chol ~ age+gender+frame+height+hip+location\",data=dfD).fit() #no waist\nchol6 = sm.ols(formula=\"chol ~ age+gender+frame+waist+hip+location\",data=dfD).fit() #no height\nchol7 = sm.ols(formula=\"chol ~ age+gender+frame+waist+height+location\",data=dfD).fit() #no hip\nchol8 = sm.ols(formula=\"chol ~ age+gender+frame+waist+height+hip\",data=dfD).fit() #no location\nprint(sma.stats.anova_lm(chol2, chol1))\nprint(sma.stats.anova_lm(chol3, chol1))\nprint(sma.stats.anova_lm(chol4, chol1))\nprint(sma.stats.anova_lm(chol5, chol1))\nprint(sma.stats.anova_lm(chol6, chol1))\nprint(sma.stats.anova_lm(chol7, chol1))\nprint(sma.stats.anova_lm(chol8, chol1))","e321b1c0":"chol1 = sm.ols(formula=\"chol ~ age+gender+frame+waist+hip+location\",data=dfD).fit()\nchol2 = sm.ols(formula=\"chol ~ gender+frame+waist+hip+location\",data=dfD).fit() #no age\nchol3 = sm.ols(formula=\"chol ~ age+frame+waist+hip+location\",data=dfD).fit() #no gender\nchol4 = sm.ols(formula=\"chol ~ age+gender+waist+hip+location\",data=dfD).fit() #no frame\nchol5 = sm.ols(formula=\"chol ~ age+gender+frame+hip+location\",data=dfD).fit() #no waist\nchol6 = sm.ols(formula=\"chol ~ age+gender+frame+waist+location\",data=dfD).fit() #no hip\nchol7 = sm.ols(formula=\"chol ~ age+gender+frame+waist+hip\",data=dfD).fit() #no location\nprint(sma.stats.anova_lm(chol2, chol1))\nprint(sma.stats.anova_lm(chol3, chol1))\nprint(sma.stats.anova_lm(chol4, chol1))\nprint(sma.stats.anova_lm(chol5, chol1))\nprint(sma.stats.anova_lm(chol6, chol1))\nprint(sma.stats.anova_lm(chol7, chol1))","83406340":"chol1 = sm.ols(formula=\"chol ~ age+gender+frame+waist+hip\",data=dfD).fit()\nchol2 = sm.ols(formula=\"chol ~ gender+frame+waist+hip\",data=dfD).fit() #no age\nchol3 = sm.ols(formula=\"chol ~ age+frame+waist+hip\",data=dfD).fit() #no gender\nchol4 = sm.ols(formula=\"chol ~ age+gender+waist+hip\",data=dfD).fit() #no frame\nchol5 = sm.ols(formula=\"chol ~ age+gender+frame+hip\",data=dfD).fit() #no waist\nchol6 = sm.ols(formula=\"chol ~ age+gender+frame+waist\",data=dfD).fit() #no hip\nprint(sma.stats.anova_lm(chol2, chol1))\nprint(sma.stats.anova_lm(chol3, chol1))\nprint(sma.stats.anova_lm(chol4, chol1))\nprint(sma.stats.anova_lm(chol5, chol1))\nprint(sma.stats.anova_lm(chol6, chol1))\n","82885e89":"chol1 = sm.ols(formula=\"chol ~ age+gender+waist+hip\",data=dfD).fit()\nchol2 = sm.ols(formula=\"chol ~ gender+waist+hip\",data=dfD).fit() #no age\nchol3 = sm.ols(formula=\"chol ~ age+waist+hip\",data=dfD).fit() #no gender\nchol4 = sm.ols(formula=\"chol ~ age+gender+hip\",data=dfD).fit() #no waist\nchol5 = sm.ols(formula=\"chol ~ age+gender+waist\",data=dfD).fit() #no hip\nprint(sma.stats.anova_lm(chol2, chol1))\nprint(sma.stats.anova_lm(chol3, chol1))\nprint(sma.stats.anova_lm(chol4, chol1))\nprint(sma.stats.anova_lm(chol5, chol1))","d09669c9":"chol1 = sm.ols(formula=\"chol ~ age+gender+hip\",data=dfD).fit()\nchol2 = sm.ols(formula=\"chol ~ gender+hip\",data=dfD).fit() #no age\nchol3 = sm.ols(formula=\"chol ~ age+hip\",data=dfD).fit() #no gender\nchol4 = sm.ols(formula=\"chol ~ age+gender\",data=dfD).fit() #no hip\nprint(sma.stats.anova_lm(chol2, chol1))\nprint(sma.stats.anova_lm(chol3, chol1))\nprint(sma.stats.anova_lm(chol4, chol1))\n","0252da79":"chol1 = sm.ols(formula=\"chol ~ age+gender\",data=dfD).fit()\nchol2 = sm.ols(formula=\"chol ~ gender\",data=dfD).fit() #no age\nchol3 = sm.ols(formula=\"chol ~ age\",data=dfD).fit() #no gender\nprint(sma.stats.anova_lm(chol2, chol1))\nprint(sma.stats.anova_lm(chol3, chol1))","55c59911":"**3. Suppose you\u2019re keen on purchasing a 1970s performance car. Your mother advises you to purchase a \u201cpractical and economical\u201d car that\u2019s capable of an average MPG value of at least 25. You see three vehicles advertised: car 1 is a four-cylinder, 100 horsepower car that weighs 2100 lbs; car 2 is an eight-cylinder, 210 horsepower car that weighs 3900 lbs; and car 3 is a six-cylinder, 200 horsepower car that weighs 2900 lbs. Use your model to predict the mean MPG for each of the three cars. Based on your prediction only, which car would you propose to your mother?**","93ab2aa1":"**4. Starting from diaFull, implement backward selection to choose a model for mean total cholesterol and then summarize. Did you get a different model than in #3? If yes, describe why that might be. **","1f0a4a99":"**1. Fit a linear model for mpg based on a two-way interaction between hp and factor( cyl) and their main effects, as well as a main effect for wt. Produce a summary of the fit.**","fe1054be":"**Part B**\n\n**Access the trees.csvPreview the document file; you\u2019ll find the volume and girth measurements, as well as data on the height of each tree.**\n","5cbcc305":"Based on the prediction, Car 1 would be the best option as it is predicted that it will have the highest MPG, 25.71 MPG.","b4e4511e":"**1. There are some missing values in diabetes that might interfere with model selection algorithms. Define a new version of the diabetes data frame that deletes all rows with a missing value in any of the following variables: chol, age, gender, height, weight, frame, waist, hip, location.**","d2c6c75c":"**Inspection:** By adding transformtion of variables, it helps improve both R-squared and Adj. R-squared, which means that the original data is not in the linear form but in the logarithmic form.","2ee15d41":"- It seems 'location' variable has the single least significant as the model with location has the least p'Value. In other word, having location does not help to improve the model  \n\n**Thus, 'location' will be eliminated**","2d95cbc5":"Because the value of input (Bwt) is in the range of the data used to train both model, we may summerize that the result from the model with interaction is more correct.","2104ec9b":"**3. Predict the heart weight of Tilman\u2019s cat Sigma using this model with interactions (Sigma is a 3.4 kg female). Compare it to the main-effects-only model.**","142fa7b2":"**1. Fit a model without interaction between the predictors.**","e084a43a":"- It seems 'frame' variable has the single least significant as the model with frame has the least p'Value. In other word, having frame does not help to improve the model  \n\n**Thus, 'frame' will be eliminated****","d91126e2":"- It seems 'weight' variable has the single least significant as the model with weight has the least p'Value. In other word, having weight does not help to improve the model\n\n**Thus, 'weight' will be eliminated**\n","effe45fc":"**2. Repeat above step, but this time use the log transformation of all variables. What do you notice about the significance of the interaction between the untransformed and transformed models? What does this suggest about the relationships in the data?**","d622dede":"- It seems 'gender' variable has the single least significant as the model with gender has the least p'Value (higher than 0.05). In other word, having gender does not help to improve the model  \n\n**Thus, 'gender' will be eliminated****","918f5323":"**Part D**\n\n","d664daea":"**2. Fit a new model with interaction between the two predictors. Inspect the model summary. What do you notice in terms of the parameter estimates and their significance when compared to the earlier main-effect-only version?.**","a7f7efe3":"**2. Interpret the estimated coefficients for the interaction between horsepower and the (categorical) number of cylinders.**\n\nAs cylinders and horsepower are numeric, every one step of hp and cyl will affect the predicted value with -0.1636(hp) + -2.7421(cyl) + 0.0190(hp*cyl). The higher value of hp and cyl will result in lower value of the result with 0.0190(hp*cyl) adjustment.","f99408fa":"-  It seems 'height' variable has the single least significant as the model with height has the least p'Value. In other word, having height does not help to improve the model\n\n**Thus, 'height' will be eliminated**\n","5177c1bf":"**2. Use your data frame from above to fit two linear models with chol as the response. The null model object, named diaNull, should be an intercept-only model. The full model object, named diaFull, should be the overly complex model with a four-way interaction (and all lower-order terms) among age, gender, weight, and frame; a three-way interaction (and all lower-order terms) among waist, height, and hip; and a main effect for location.**","e287e3ce":"**Part C**\n\n**Use mtcarsPreview the document data set for the following.**","fc0e88a5":"- At this point, there is no other predictor that can help the model yield more an improvement\n**The final model will be col ~ age+gender**","c176fc29":"- It seems 'hip' variable has the single least significant as the model with hip has the least p'Value (higher than 0.05). In other word, having hip does not help to improve the model  \n\n**Thus, 'hip' will be eliminated****","25384614":"**Part A**\n\n\n**Predict the heart weights of domestic cats by total body weight and sex.**","b95b5205":"**Finally, the model of backward selection is 'chol ~ age', which is different from the model in 3. This is because forward and backward selection adding or removing variable in different orders, which can affect the intercorrelation in the model. **","bb1aae95":"By adding interaction with Bwt and Sexnumber, it exposes the interaction between them. This made SexNumber became more significant into the model and improved R-Squared value, which means the model fits to the data better.","d6f57f12":"- chol ~ age+gender has at least p-value, age will be picked to form the model ","f01c5af8":"- Picking the first predictor","7c8156cb":"- chol ~ age has at least p-value, age will be picked to form the model ","1a906654":"**Result from the model without interaction**","bff4ef3c":"- Starting from this model #diaFull,\n\"chol ~ age+gender+weight+frame+waist*height+hip+location\"","cae77c12":"- It seems 'waist' variable has the single least significant as the model with waist has the least p'Value (higher than 0.05). In other word, having waist does not help to improve the model  \n\n**Thus, 'waist' will be eliminated****","b7936072":"**Result from the model with interaction**","4f429b38":"**1. Without using any transformations of the data, fit and inspect a main-effects-only model for predicting volume from girth and height. Then, fit and inspect a second version of this model including an interaction.**","bb8a18eb":"**Inspection**: By adding interactions between variables, it helps improve both R-squared and Adj. R-squared. The P-Value of all variables including interactions are still less than 0.05, which means acceptable. Overall, the regression model with interactions predicts responses for new observations better than the model without interaction. ","4b6b392e":"**3. Starting from diaNull and using the same terms as in diaFull for scope, implement forward selection to choose a model for mean total cholesterol and then summarize.**"}}