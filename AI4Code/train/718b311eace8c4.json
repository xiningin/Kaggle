{"cell_type":{"b43df56d":"code","992a330a":"code","e5d485d1":"code","8e9bdca1":"code","6d444852":"code","27e2e4d3":"code","4114545c":"code","cf665e59":"code","b24fb4fb":"code","5be7bd7e":"code","28380dc0":"markdown","a4eb7362":"markdown","9403e0ab":"markdown","aea3cfb5":"markdown","ebb52f60":"markdown","236a54cb":"markdown","97aab556":"markdown","54c4402a":"markdown","a71687f5":"markdown"},"source":{"b43df56d":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport statsmodels.api as sm\nfrom scipy import stats\nstats.chisqprob = lambda chisq, df: stats.chi2.sf(chisq, df)\nimport warnings\nwarnings.filterwarnings(\"ignore\")","992a330a":"data = pd.read_csv('..\/input\/heart-disease-uci\/heart.csv')\ndata.head()","e5d485d1":"data.describe()","8e9bdca1":"#Change categorial columns that's contain numerical value to categorical.\n\ndata['sex'] = data['sex'].astype(str)\ndata['cp'] = data['cp'].astype(str)\ndata['fbs'] = data['fbs'].astype(str)\ndata['exang'] = data['exang'].astype(str)\ndata['ca'] = data['ca'].astype(str)\ndata.info()","6d444852":"def plot_box(data, cols, col_x = 'target'):\n    for col in cols:\n        sns.set_style(\"whitegrid\")\n        sns.boxplot(col_x, col, data=data)\n        plt.xlabel(col_x) # Set text for the x axis\n        plt.ylabel(col)# Set text for y axis\n        plt.show()\n        \nnum_cols = ['age','sex', 'cp', 'trestbps', 'chol', 'fbs', 'restecg','thalach', \n            'exang', 'oldpeak', 'slope', 'ca', 'thal']\nplot_box(data, num_cols)","27e2e4d3":"#from box plot.Drop columns 'fbs','restecg'\ndata.drop(['fbs','restecg'],axis=1)\ndata.head()","4114545c":"#Chek missing value\ndata.isnull().sum()","cf665e59":"from sklearn.model_selection import train_test_split\nX = data.iloc[:,:-2]\ny = data['target']\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)\n","b24fb4fb":"from sklearn.model_selection import cross_val_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn import tree\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report, confusion_matrix, accuracy_score\n\nmodel_1 = LogisticRegression()\nmodel_2 = tree.DecisionTreeClassifier(max_depth = 4, criterion = 'entropy')\nmodel_3 = GaussianNB()\nmodel_4 = RandomForestClassifier(n_estimators=100,max_depth=4,criterion='gini')\n\n#Create models list\nmodels = [model_1, model_2, model_3, model_4]\n\n#Find accuracy by using cross validation. In this case, I split data to 5 folds.   \nfor model in models:\n    cvs = cross_val_score(model, X_train, y_train, cv=5)\n    print('{0} score is {1}'.format(model,cvs.mean()))\n\n","5be7bd7e":"#cHECK Test Accuracy\n\nfor model in [model_1, model_4]:\n    model = model.fit(X_train, y_train)\n    y_test_pred = model.predict(X_test)\n    test_acc = accuracy_score(y_test, y_test_pred)\n    matrix = confusion_matrix(y_test, y_test_pred)\n    print('{0} accuracy is {1}'.format(model, test_acc))\n    ","28380dc0":"# Load data","a4eb7362":"**** Let's explore each column****\n1. 'age' - age in year\n1. 'sex'- male and female (1 and 0)\n1. 'cp' - chest pain type (0,1,2,3)\n1. 'trestbps' - resting blood pressure (in mm Hg on admission to the hospital)\n1. 'chol' - serum cholestoral in mg\/dl\n1. 'fbs'- (fasting blood sugar &gt; 120 mg\/dl) (1 = true; 0 = false)\n1. 'restecg' - resting electrocardiographic results\n1. 'thalach' - maximum heart rate achieved\n1. 'exang' - exercise induced angina (1 = yes; 0 = no)\n1. 'oldpeak' - ST depression induced by exercise relative to rest\n1. 'slope' - the slope of the peak exercise ST segment\n1. 'ca' - number of major vessels (0-3) colored by flourosopy\n1. 'thal' - 3 = normal; 6 = fixed defect; 7 = reversable defect\n1. 'target' - (Yes = 1, No = 0)","9403e0ab":"# Train the model.","aea3cfb5":"**Train Model  ******","ebb52f60":"Test accuracy have no difference, but model 1 have higher train accuracy than model 4, Then model 1 or Logistic regression is appropiate to this data.","236a54cb":"# Explore the data","97aab556":"From box plot, It's seem like columns 'fbs' and 'restecg' is not effect to target.\nThen I will drop these 2 columns.","54c4402a":"**Import Train Test Split**","a71687f5":"From above, I saw the model 1 and model 4 have more accuacy than others. I select these 2 models."}}