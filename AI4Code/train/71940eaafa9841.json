{"cell_type":{"62ef628e":"code","a840d244":"code","263e78a5":"code","376065ac":"code","e70a6984":"code","92fca8e0":"code","dbbfb850":"code","2e229a62":"code","232631f3":"code","2f806c6d":"code","b1ddceaf":"code","dbcafd8f":"code","a39be2ee":"code","36d21ca8":"code","743911df":"code","08fe2326":"code","f904d152":"code","ef97b788":"code","17e5d92a":"code","34f286a3":"code","f268b93e":"code","b6a2ae02":"code","7205cbd8":"code","a3cb307c":"code","dc61829d":"code","0e303d12":"code","995919c7":"code","95cb9e67":"code","4d3a2c65":"code","5db2a865":"code","cfdff36c":"code","2b95ecdb":"code","83121834":"code","71ab457c":"code","23debfd4":"code","c1b6a97d":"code","d55769c9":"code","60abdfd7":"code","1eabbeab":"code","5e96ce91":"code","861ebc86":"code","73eb1894":"markdown","af94435b":"markdown","e0e8d163":"markdown","de3c2680":"markdown","0bd0f165":"markdown","d46ca692":"markdown","1630b28a":"markdown","a17db9a7":"markdown","111d623f":"markdown","ff1aa940":"markdown","a277e318":"markdown","041b88f1":"markdown","a65d6a3f":"markdown","44ac3548":"markdown","f82df0d8":"markdown","50583a76":"markdown","85a4137c":"markdown","7f06159c":"markdown","e39d0cb3":"markdown","a282602b":"markdown","7e40c794":"markdown","73c5e01d":"markdown","a4f1653b":"markdown","80503555":"markdown","dbc9dc70":"markdown","3dcdcff3":"markdown","060a0f54":"markdown","497fbd05":"markdown","747c146d":"markdown","5aadfdd0":"markdown","236b3577":"markdown","76d547a7":"markdown","e6e64675":"markdown","82b7cd55":"markdown","47a5bf01":"markdown","7751d587":"markdown","65105bca":"markdown","9c68e765":"markdown"},"source":{"62ef628e":"#Importing required packages.\n\nimport pandas as pd\nimport numpy as np\n\n#ploting libraries\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n\n#feature engineering\n\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\n\n#train test split and #cross validation\nfrom sklearn.model_selection import train_test_split, GridSearchCV, cross_val_score\nfrom scipy.stats import zscore\n\n#metrics\nfrom sklearn.metrics import confusion_matrix, classification_report\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import r2_score,mean_squared_error\n\n#ML models\nimport sklearn\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.linear_model import SGDClassifier\nfrom sklearn.linear_model import LinearRegression, Ridge, Lasso\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.svm import SVR\n\n\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')","a840d244":"#Loading dataset\ndf=pd.read_csv('https:\/\/raw.githubusercontent.com\/dsrscientist\/DSData\/master\/Advertising.csv')\n\n#Let's check how the data is distributed\ndf.head()","263e78a5":"#Information about the data columns\ndf.info()","376065ac":"# no. of rows and coloumns\ndf.shape","e70a6984":"# check for null values\ndf.isnull().sum()","92fca8e0":"# check the stats\ndf.describe()","dbbfb850":"sns.distplot(df['sales'])","2e229a62":"sns.distplot(df['TV'])","232631f3":"sns.distplot(df['radio'])","2f806c6d":"sns.distplot(df['newspaper'])","b1ddceaf":"plt.figure(figsize=[10,6])\nplt.title('Relationship between TV Advertising and Sales')\nsns.scatterplot(df['TV'], df['sales']);","dbcafd8f":"plt.figure(figsize=[10,6])\nplt.title('Relationship between radio Advertising and Sales')\nsns.scatterplot(df['radio'], df['sales']);","a39be2ee":"plt.figure(figsize=[10,6])\nplt.title('Relationship between Newspaper Advertising and Sales')\nsns.scatterplot(df['newspaper'], df['sales']);\n","36d21ca8":"# corelation\ncorr_mat=df.corr()\ncorr_mat","743911df":"plt.figure(figsize=[22,12])\nsns.heatmap(corr_mat,annot=True)\nplt.title(\"Correlation Matrix\")\nplt.show()","08fe2326":"sns.heatmap(corr_mat,annot=True,linewidths=6,linecolor='r')","f904d152":"corr_mat[\"sales\"].sort_values(ascending=False)","ef97b788":"plt.figure(figsize=(22,7))\ndf.corr()['sales'].sort_values(ascending=False).drop(['sales']).plot(kind='bar',color='c')\nplt.xlabel('Feature',fontsize=14)\nplt.ylabel('column with target names',fontsize=14)\nplt.title('correlation',fontsize=18)\nplt.show()","17e5d92a":"x=df.drop(\"sales\",axis=1)\ny=df[\"sales\"]","34f286a3":"x.skew()","f268b93e":"from sklearn.preprocessing import power_transform\ndf_skew=power_transform(x)\n\ndf_skew=pd.DataFrame(df_skew,columns=x.columns)","b6a2ae02":"# Removing Skewness through Power Transforms\ndf_skew.skew()","7205cbd8":"df=df_skew\nx=df_skew","a3cb307c":"x.boxplot(figsize=[20,8])\nplt.subplots_adjust(bottom=0.25)\nplt.show()","dc61829d":"df['TV'].plot.box()","0e303d12":"df['radio'].plot.box()","995919c7":"df['newspaper'].plot.box()","95cb9e67":"# Scaling the Feature data\n\nfrom sklearn.preprocessing import StandardScaler\nSC=StandardScaler()\nx=SC.fit_transform(x)\nx","4d3a2c65":"x_train, x_test, y_train, y_test = train_test_split(x,y, test_size = 0.20, random_state=100)","5db2a865":"lr = LinearRegression()\nlr.fit(x_train,y_train)\npredlr = lr.predict(x_test)\nprint(r2_score(y_test,predlr))\nprint(mean_squared_error(y_test,predlr))\nprint(np.sqrt(mean_squared_error(y_test,predlr)))","cfdff36c":"scr = cross_val_score(lr,x,y,cv=5)\nprint('Cross validation score for Linear Regression Model is ',scr.mean())","2b95ecdb":"r = Ridge()\nr.fit(x_train,y_train)\npredr = r.predict(x_test)\nprint(r2_score(y_test,predr))\nprint(mean_squared_error(y_test,predr))\nprint(np.sqrt(mean_squared_error(y_test,predr)))","83121834":"scr = cross_val_score(r,x,y,cv=5)\nprint('Cross validation score for Ridge Regression Model is', scr.mean())","71ab457c":"l = Lasso()\nl.fit(x_train,y_train)\npredl = l.predict(x_test)\nprint(r2_score(y_test,predl))\nprint(mean_squared_error(y_test,predl))\nprint(np.sqrt(mean_squared_error(y_test,predl)))","23debfd4":"scr = cross_val_score(l,x,y,cv=5)\nprint('Cross validation score for Lasso Regression Model is ', scr.mean())","c1b6a97d":"rf = RandomForestRegressor()\nrf.fit(x_train,y_train)\npredrf = rf.predict(x_test)\nprint(r2_score(y_test,predrf))\nprint(mean_squared_error(y_test,predrf))\nprint(np.sqrt(mean_squared_error(y_test,predrf)))","d55769c9":"scr = cross_val_score(rf,x,y,cv=5)\nprint('Cross validation score for Random Forest Regressor Model is', scr.mean())","60abdfd7":"parameters1 = {'alpha': [4.0, 5.0, 6.0, 7.0, 8.0, 10.0],\n             'random_state': [200, 700, 900],\n             'max_iter': [200, 900],\n             'selection': ['cyclic','random']}\nGCV=GridSearchCV(Lasso(),parameters1,cv=5)\nGCV.fit(x_train,y_train)","1eabbeab":"GCV.best_params_","5e96ce91":"mod1=Lasso(alpha=4.0,random_state=200,selection='cyclic',max_iter=200)\n\nmod1.fit(x_train,y_train)\npred=mod1.predict(x_test)\nprint(r2_score(y_test,predrf)*100)\nprint(mean_squared_error(y_test,predrf))\nprint(np.sqrt(mean_squared_error(y_test,predrf)))","861ebc86":"import joblib\njoblib.dump(mod1,\"Advertising_Sales_Lasso.pkl\")","73eb1894":"### Lasso Model r2_score after Hyper parameter Tuning is 98.53%","af94435b":"# Feature and Label Seperation","e0e8d163":"# Skewness","de3c2680":"# Importing Libraries","0bd0f165":"# Outlier Detection","d46ca692":"## If you are doing business and you are not into tv advertising, you are losing business. It is the most dependable and traditional way of advertising. TV advertising in siti channel appeals to masses at large.","1630b28a":"#### Linear Regression Model Difference is 92.57 - 89.53 = 3.04\n\n#### Ridge Regression Model Build:","a17db9a7":"#### Checking for the Skewness and found newspaper has more skewness as predicted by distplot analysis","111d623f":"#### TV Advertising increases the sales high which is followed by Radio Advertising","ff1aa940":"### The distribution strategy and the channel design have to be right the first time. The case study of Sales channel includes the detailed study of TV, radio and newspaper channel. The predict the total sales generated from all the sales channel.  \n\n## Understanding Dataset\n\n## Features:\n\n    `TV: advertising dollars spent on TV for a single product in a given market (in thousands of dollars)\n    `Radio: advertising dollars spent on Radio\n    `Newspaper: advertising dollars spent on Newspaper\n## Target:\n\n    `Sales budget in thousands of dollars","a277e318":"### Obtaining the Best Parameters for Hyper parameters tuning","041b88f1":"#### Upon reviewing above plot, as TV advertising is increased, sales are also increased.","a65d6a3f":"# Importing Dataset and Data Information","44ac3548":"# Data Visualization","f82df0d8":"#### using distplot, found there are skewness in newspaper column","50583a76":"# Sales Channel Prediction Case Study  ","85a4137c":"# Train Test Split","7f06159c":"# Model Building","e39d0cb3":"# Data Standardization","a282602b":"#### Random Forest Regressor Model Difference is 98.53 - 97.33 = 1.20\n\n#### Lasso Regression Model has the least difference in r2_score so it is the best model","7e40c794":"#### No outlier detected","73c5e01d":"# Save the model","a4f1653b":"#### There are no null or missing values in data set","80503555":"#### Ridge Regression Model Difference is 92.48 - 89.53 = 2.95\n\n#### Lasso Regression Model Build:","dbc9dc70":"# Hyper Parameter Tuning","3dcdcff3":"#### Checking Skewness after power transforms and found all columns skewness is within range of -0.5 to +0.5","060a0f54":"#### There are 200 Rows and 5 Columns in Data Set","497fbd05":"#### TV. radio, newspaper, sales are floating data columns; unnamed: 0 is integer data type columns","747c146d":"#### Checking for Outliers through box plot graphs and found no outliers;","5aadfdd0":"![tv](https:\/\/miro.medium.com\/max\/640\/1*mO223lvQAQrIIlqJSh496w.jpeg)","236b3577":"#### Reviewing Data Set at initial stage, found continous datatypes; Target variable data is sales which seems to represent regression problem","76d547a7":"#### Linear Regression Model Build:","e6e64675":"#### Upon reviewing above plot, newspaper advertising has high effect on sales positively at initial. However, as advertising is increased, it has low effect on sales and almost nil at max.\n#### TV advertising has higher positive impact on sales and followed by radio. So TV and radio will have higher correlation with sales","82b7cd55":"#### Checking the Correlation between the target value and rest columns using Heatmap, Correlation Matrix.\n\n#### Upon review, found TV, radio are highly correlated with sales data which coincides with the graphical data analysis done in above steps","47a5bf01":"#### Upon reviewing above plot, similar to TV advertising, as radio advertising is increased, sales are also increased. But Radio advertising is less effective than TV.","7751d587":"## The advertising dataset captures sales revenue generated with respect to advertisement spends across multiple channles like radio, tv and newspaper. ","65105bca":"#### Lasso Regression Model Difference is 82.85 - 82.70 = 0.15\n#### Random Forest Regressor Model Build:","9c68e765":"![tv](https:\/\/content.thriveglobal.com\/wp-content\/uploads\/2021\/05\/marketing-campaign.jpg)"}}