{"cell_type":{"6ecd52b5":"code","518bc7e5":"code","3051f4af":"code","2cb2753a":"code","31fc786d":"code","de564f54":"code","9ab5a14f":"code","06b85729":"code","336a6a7c":"code","ac1c5fa4":"code","fd4a40cc":"code","2b66736a":"code","7eb0024a":"markdown","28e1466f":"markdown","e5548c1a":"markdown","1853c494":"markdown","86ed0cd0":"markdown","7cd1c208":"markdown","a08761e5":"markdown"},"source":{"6ecd52b5":"import os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg\nfrom sklearn.model_selection import train_test_split\nimport pickle\nimport tensorflow as tf\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import *\n\nimport zipfile \nfrom tensorflow import keras\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator","518bc7e5":"test = pd.read_csv('..\/input\/histopathologic-cancer-detection\/sample_submission.csv')\n\nprint('Test Set Size:', test.shape)","3051f4af":"test.head()","2cb2753a":"#The id in the csv file does not have .tif extension, therefore we need to add it here.\ntest['id'] = test['id'].apply(lambda x:f'{x}.tif')\ntest.head()","31fc786d":"test_path = \"..\/input\/histopathologic-cancer-detection\/test\"\nprint('Test Images:', len(os.listdir(test_path)))","de564f54":"BATCH_SIZE = 64\n\ntest_datagen = ImageDataGenerator(rescale=1\/255)\n\ntest_loader = test_datagen.flow_from_dataframe(\n    dataframe = test,\n    directory = test_path,\n    x_col = 'id',\n    batch_size = BATCH_SIZE,\n    shuffle = False,\n    class_mode = None,\n    target_size = (96,96)\n)","9ab5a14f":"cnn_model = keras.models.load_model('..\/input\/cancer-detection-with-cropping-layers-model\/cancer_model_v07.h5')\ncnn_model.summary()","06b85729":"test_probs = cnn_model.predict(test_loader)\nprint(test_probs.shape)","336a6a7c":"test_pred = np.argmax(test_probs, axis=1)\nprint(test_pred[:10]) ","ac1c5fa4":"submission = pd.read_csv('..\/input\/histopathologic-cancer-detection\/sample_submission.csv')\nsubmission.head()","fd4a40cc":"submission.label = test_pred\nsubmission.head()","2b66736a":"submission.to_csv('submission.csv', header=True, index=False)","7eb0024a":"# Data generator","28e1466f":"# Import Packages","e5548c1a":"# Test predictions","1853c494":"# Prepare submission","86ed0cd0":"# Load model","7cd1c208":"# Load dataframe test","a08761e5":"# Extract test images"}}