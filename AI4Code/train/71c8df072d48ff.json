{"cell_type":{"d3108255":"code","b9638113":"code","eadc1bc7":"code","dd391f4e":"code","1a1c014f":"code","3cceb33c":"code","81aafca0":"code","5555f160":"code","b59b0ada":"code","7dd98967":"code","5f63da8d":"code","7f25ee34":"code","8d10b4f7":"code","c5c50854":"code","3c3cbe1e":"code","ecc24802":"code","9189adbd":"code","8fa3a314":"code","20c61748":"code","101da5e5":"code","2f06872e":"code","38c1dec4":"code","11c54086":"code","7191e711":"code","c5ff3a1a":"code","05a255e4":"code","d9382299":"code","f416ef90":"code","e6c4b383":"code","9102c28e":"code","9be6490b":"code","2e269116":"code","5d396090":"code","a778325a":"code","80e5f0b9":"code","039100d6":"code","410e6231":"markdown","59efd35c":"markdown","a16c80f7":"markdown","f0780d16":"markdown","850828dc":"markdown","9f379344":"markdown","b607e57d":"markdown","d66bce4e":"markdown","82eb9e21":"markdown","9cda7fe1":"markdown","8af4020c":"markdown","c1f15bd0":"markdown","4ff7bd69":"markdown","bb6788a2":"markdown","f86516a6":"markdown","2f7035e2":"markdown"},"source":{"d3108255":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n%matplotlib inline\nplt.style.use('ggplot')","b9638113":"data = pd.read_csv('..\/input\/top250-00-19.csv')","eadc1bc7":"data.head()","dd391f4e":"league_from = data.groupby(['League_from'])['Transfer_fee'].sum()\ntop5sell_league = league_from.sort_values(ascending=False).head(5)\ntop5sell_league = top5sell_league\/1000000\ntop5sell_league.head()","1a1c014f":"fig, ax = plt.subplots(figsize=(18,6))\nax.bar(top5sell_league.index, top5sell_league.values, color='orange')\nax.set_ylabel(\"$ millions\", color='navy')\nax.set_yticklabels(labels=[i for i in range(0,8000, 1000)], color='navy')\nax.set_xticklabels(labels=top5sell_league.index, color='navy')","3cceb33c":"league_to = data.groupby(['League_to'])['Transfer_fee'].sum()\ntop5buy_league = league_to.sort_values(ascending=False).head(5)\ntop5buy_league = top5buy_league\/1000000\ntop5buy_league.head()","81aafca0":"fig, ax = plt.subplots(figsize=(18,6))\nax.bar(top5buy_league.index, top5buy_league.values, color='navy')\nax.set_ylabel(\"$ millions\", color='black')\nax.set_yticklabels(labels=[i for i in range(0,16000, 2000)], color='black')\nax.set_xticklabels(labels=top5buy_league.index, color='black')","5555f160":"diff_league = top5sell_league - top5buy_league\ndiff_league = diff_league.sort_values(ascending=False)\ndiff_league.head()","b59b0ada":"fig, ax = plt.subplots(figsize=(18,6))\nax.bar(diff_league.index, diff_league.values)\nax.set_ylabel(\"$ millions\")","7dd98967":"league_summary = pd.concat([top5sell_league, top5buy_league], axis=1)\nleague_summary = league_summary.assign(diff=diff_league)\nnew_columns = league_summary.columns.values\nnew_columns[[0, 1]] = ['sell', 'buy']\nleague_summary.columns = new_columns\nleague_summary.head()","5f63da8d":"fig, ax = plt.subplots(figsize=(18,6))\n\nsales = league_summary[\"sell\"]\nbuys = league_summary[\"buy\"]\nx = league_summary.index\nwidth=0.4\nN = len(x)\nloc = np.arange(N)\n\nax.bar(loc, sales, width, bottom=0, label=\"Sell\")\nax.bar(loc+width, buys, width, bottom=0, label=\"Buy\")\n\nax.set_title(\"Buys and sales by major leagues\")\nax.legend()\nax.set_xticks(loc + width \/ 2)\nax.set_xticklabels(x)\nax.set_ylabel(\"$ millions\")\nax.autoscale_view()","7f25ee34":"club_from_sum = data.groupby(['Team_from'])['Transfer_fee'].sum()\nclub_from_count = data.groupby(['Team_from'])['Transfer_fee'].count()\nclub_from_mean_price = (club_from_sum\/1000000) \/ club_from_count","8d10b4f7":"plt.figure(figsize=(18,6))\nsellers_mean = club_from_mean_price.sort_values(ascending=False)[:20]\ng = sns.barplot(sellers_mean.index, sellers_mean.values, palette=\"Greens_r\")\ng.set_title(\"Mean price of sold player per club\")\ng.set(ylabel=\"$ millions\", xlabel=\"Team selling a player\")\nplt.xticks(rotation=90)","c5c50854":"club_to_sum = data.groupby(['Team_to'])['Transfer_fee'].sum()\nclub_to_count = data.groupby(['Team_to'])['Transfer_fee'].count()\nclub_to_mean_price = (club_to_sum\/1000000) \/ club_to_count","3c3cbe1e":"plt.figure(figsize=(18,6))\nbuy_mean = club_to_mean_price.sort_values(ascending=False)[:20]\ng = sns.barplot(buy_mean.index, buy_mean.values, palette=sns.cubehelix_palette(20))\ng.set_title(\"Mean price of bought player per club\")\ng.set(ylabel=\"$ millions\", xlabel=\"Team buying a player\")\nplt.xticks(rotation=90)","ecc24802":"diff_club = club_from_sum - club_to_sum\ndiff_club = diff_club.sort_values(ascending=False)\ndiff_club = diff_club.dropna()","9189adbd":"diff_club = diff_club\/1000000\ndiff_club.head(15)\n# in millions","8fa3a314":"fig, ax = plt.subplots(figsize=(18,6))\nmake_money = diff_club.sort_values(ascending=False)[:10]\nax.bar(make_money.index, make_money.values, color=\"orange\")\nax.set_title(\"Clubs that make money on transfer market\")\nax.set_ylabel(\"$ millions\")\nax.set_xticklabels(make_money.index, rotation=90)\n# ax.autoscale_view()","20c61748":"diff_club.tail(15)\n# in millions","101da5e5":"fig, ax = plt.subplots(figsize=(18,6))\nlose_money = diff_club.sort_values(ascending=True)[:10]\nax.bar(lose_money.index, lose_money.values, color=\"black\")\nax.set_title(\"Clubs that lose money on transfer market\")\nax.set_ylabel(\"$ millions\")\nax.set_xticklabels(lose_money.index, rotation=90)\nax.autoscale_view()","2f06872e":"club_from_sum = club_from_sum.sort_values(ascending=False)\nclub_from_sum = club_from_sum\/1000000\nclub_from_sum.head(15)","38c1dec4":"plt.figure(figsize=(20,6))\ng = sns.barplot(club_from_sum.head(15).index, club_from_sum.head(15).values, palette=sns.color_palette(\"hls\", 15))\ng.set_title(\"Top sales clubs\")\ng.set(ylabel=\"$, millions\", xlabel=\"Team selling\")","11c54086":"club_from_sum.tail(15)","7191e711":"plt.figure(figsize=(20,6))\ng = sns.barplot(club_from_sum.tail(15).index, club_from_sum.tail(15).values, palette=sns.color_palette(\"Wistia_r\", 15))\ng.set_title(\"Bottom sales clubs\")\ng.set(ylabel=\"$, millions\", xlabel=\"Team selling\")","c5ff3a1a":"club_from_mean_price = club_from_mean_price.sort_values(ascending=False)\nclub_from_mean_price.head(15)\n# in millions","05a255e4":"plt.figure(figsize=(18,6))\ng = sns.barplot(club_from_mean_price.head(15).index, club_from_mean_price.head(15).values, palette=sns.color_palette(\"YlGnBu_r\", 15))\ng.set_title(\"Mean price of a sale, Top\")\ng.set(ylabel=\"$, millions\", xlabel=\"Team selling\")","d9382299":"club_from_mean_price.tail(15)\n# I should've put some minimum borderline of let's say 10 men moved","f416ef90":"plt.figure(figsize=(18,6))\ng = sns.barplot(club_from_mean_price.tail(15).index, club_from_mean_price.tail(15).values, palette=sns.color_palette(\"YlGnBu\", 15))\ng.set_title(\"Mean price of a sale, Bottom\")\ng.set(ylabel=\"$, millions\", xlabel=\"Team selling\")\nplt.xticks(rotation=45)","e6c4b383":"club_to_sum = club_to_sum.sort_values(ascending=False)\nclub_to_sum = club_to_sum\/1000000\nclub_to_sum.head(15)","9102c28e":"plt.figure(figsize=(18,6))\ng = sns.barplot(club_to_sum.head(15).index, club_to_sum.head(15).values, palette=sns.color_palette(\"OrRd_r\", 15))\ng.set_title(\"Total historical spend on players, Top\")\ng.set(ylabel=\"$, millions\", xlabel=\"Team buing\")\nplt.xticks(rotation=45)","9be6490b":"club_to_sum.tail(15)","2e269116":"plt.figure(figsize=(18,6))\ng = sns.barplot(club_to_sum.tail(15).index, club_to_sum.tail(15).values, palette=sns.color_palette(\"OrRd\", 15))\ng.set_title(\"Total historical spend on players, Top\")\ng.set(ylabel=\"$, millions\", xlabel=\"Team buing\")\nplt.xticks(rotation=45)","5d396090":"club_to_mean_price = club_to_mean_price.sort_values(ascending=False)\nclub_to_mean_price.head(15)","a778325a":"plt.figure(figsize=(18,6))\ng = sns.barplot(club_to_mean_price.head(15).index, club_to_mean_price.head(15).values, palette=sns.color_palette(\"magma\", 15))\ng.set_title(\"Mean price of a bought player, Top\")\ng.set(ylabel=\"$, millions\", xlabel=\"Team buing\")\nplt.xticks(rotation=45)","80e5f0b9":"club_to_mean_price.tail(15)","039100d6":"plt.figure(figsize=(18,6))\ng = sns.barplot(club_to_mean_price.tail(15).index, club_to_mean_price.tail(15).values, palette=sns.color_palette(\"magma_r\", 15))\ng.set_title(\"Mean price of a bought player, Top\")\ng.set(ylabel=\"$, millions\", xlabel=\"Team buing\")\nplt.xticks(rotation=45)","410e6231":"## Find Top 5 Leagues by turnover in selling players","59efd35c":"## Mean price of a sale","a16c80f7":"It is not a new information that EPL has the biggest amount of money involved and that clubs can permit themselves to buy a lot as they gain money from other sources. What is really interesting is that clubs from French League1 in general make money on transfers. I actually thought that all of the numbers will be with the minus sign. ","f0780d16":"## Profits?","850828dc":"## Buyers","9f379344":"## Profits?","b607e57d":"In this kernel we will go through football transfer market and create a high level overview of what's happenning there. Some numbers will be relatively well known some might surprise. Anyway, it is goign to be interesting :)\n\nAs usual, we will start with importing python libraries to work with data and explore a little our dataset.","d66bce4e":"## Conclusions","82eb9e21":"## Mean price of a buy","9cda7fe1":"## Total sum of buys","8af4020c":"## Summary Top and Bottom 15 for clubs\n## Total sum of sales","c1f15bd0":"This is a basic analysis, but it already answers few interesting questions.\n1. The richest league - English Premier League (obvious)\n2. Clubs of which Top-5 league make money on transfer market? - Ligue1\n3. The biggest sellers in the market, top5: Monaco, FC Porto, Real Madrid, Chelsea, Liverpool\n4. The biggest buyers in the market, top5: Chelsea, Man City, Real Madrid, FC Barcelona, Man Utd\n5. Clubs that sell expensive players on average: Athletic Bilbao, RB Leipzig, Monaco, FC Augsburg, FC Barcelona\n6. Clubs that buy expensive players on average: SIPG, FC Barcelona, CC Yatai, Man Utd, Real Madrid\n7. Clubs that made money during last 18 years on the transfer market: FC Porto, Benfica, Udinese Calcio, River Plate, Parma\n8. Clubs that lost money (a lot of money actually): Man City, Chelsea, Man Utd, FC Barcelona, Paris SG\n\nI've being looking at this summary for 10 minutes or so trying to make some smart conclusions and what did I understand? All the answers are logical if you know at least something about football. Big clubs with a lot of money buy best players and trying to win all the possible tropheys. Clubs out of top 5 leagues just trying to make money and portugeses do that the best. Also it is not that much about the money, but about the level of the league - best players go to better leagues and this is clear and completely logical.\nAlthough, I think I could find more interesting stuff in dynamics, by analyzing the market divided by periods. For example, we can see that English clubs spent a lot of money on transfers since 2000, but last 10 years Spanish clubs totally dominate Europe. Does it correlate with increased expenses on transfers? This could be a problem to resolve in the next kernel.","4ff7bd69":"## Intro","bb6788a2":"## Summary","f86516a6":"## Analyzing clubs\n## Sellers","2f7035e2":"## Find Top 5 Leagues by turnover in buying players"}}