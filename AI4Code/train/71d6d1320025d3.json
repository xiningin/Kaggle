{"cell_type":{"a5f85f05":"code","fc8c1af7":"code","3d29dbc1":"code","d3573255":"code","d7d7c6f0":"code","3a6115e0":"code","155c711c":"code","fb27eb4f":"code","4237d11d":"code","1976955b":"code","fd1a46e3":"code","96114961":"code","97cf0885":"code","f1438a28":"code","bf480b8e":"code","c2d1cf62":"code","c0ab6ef9":"code","583a7b8f":"markdown","89b4e50a":"markdown","379b1dd3":"markdown","4e9ec97e":"markdown","0eb2bd13":"markdown","00f503b8":"markdown","3c50a6d6":"markdown","1c5a087f":"markdown","3901e7e3":"markdown","14fa15c6":"markdown","4bba3537":"markdown","752ee964":"markdown","e41dc4a2":"markdown","eebb888a":"markdown"},"source":{"a5f85f05":"import  pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nimport keras \nfrom glob import glob\nfrom keras.models import Sequential\nfrom keras.layers import BatchNormalization,MaxPool2D,Dense,Conv2D,Flatten\nfrom keras.callbacks import EarlyStopping,LearningRateScheduler\nimport warnings\nfrom tqdm import tqdm\nfrom PIL import Image\nwarnings.filterwarnings('ignore')","fc8c1af7":"df=pd.DataFrame(columns=['image','label'])\n","3d29dbc1":"\n# for a picture containing image of vehicle label is 1.\n\nidx=0\nfor name in tqdm(glob('..\/input\/vehicle-detection-image-set\/data\/vehicles\/*')):\n    image=Image.open(name)\n    img_seq=image.getdata()\n    img=np.array(img_seq)\n    img=np.reshape(img,(64,64,3))\n    data=pd.DataFrame({'image':[img],'label':[1]},index=[idx])\n    df=df.append(data)    \n    idx+=1","d3573255":"# for a picture doesn't contain image of vehicle label is 0.\n\nfor name in tqdm(glob('..\/input\/vehicle-detection-image-set\/data\/non-vehicles\/*')):\n    image=Image.open(name)\n    img_seq=image.getdata()\n    img=np.array(img_seq)\n    img=np.reshape(img,(64,64,3))\n    data=pd.DataFrame({'image':[img],'label':[0]},index=[idx]) \n    df=df.append(data)\n    idx+=1","d7d7c6f0":"from sklearn.model_selection import StratifiedShuffleSplit,train_test_split\nsplit=StratifiedShuffleSplit(n_splits=1,test_size=0.15,random_state=42)\nfor train_index,test_index in split.split(df,df['label']):\n    train_data=df.iloc[train_index]\n    test_data=df.iloc[test_index]\n# train_x,test_x,train_y,test_y=train_test_split(df['image'],df['label'],random_state=42,test_size=0.15)","3a6115e0":"train_img,train_label=train_data['image'],train_data['label']\ntest_img,test_label=test_data['image'],test_data['label']","155c711c":"plt.figure(figsize=(15,15))\nfor i in range(9):\n    plt.subplot(3,3,(i%9)+1)\n    ix=np.random.randint(3000)\n    if(train_label.iloc[ix]==1):\n        plt.title('Image no.{0} has vehicle'.format(i+1))\n    elif(train_label.iloc[ix]==0):\n        plt.title('Image no.{0} doesnot have vehicle'.format(i))\n    plt.axis('off')\n    plt.imshow(train_img.iloc[ix])\nplt.show()","fb27eb4f":"def change_image_dimension(data):\n    data=np.reshape(data.to_list(),(len(data),64,64,3))\n    return data","4237d11d":"train_img=change_image_dimension(train_img)\ntest_img=change_image_dimension(test_img)\n# train_img\ntrain_img=train_img\/255.0\ntest_img=test_img\/255.0","1976955b":"train_label=np.array(train_label,dtype=int)\ntest_label=np.array(test_label,dtype=int)","fd1a46e3":"def schedule(epoch,lr):\n    if epoch>=5:\n        return 0.0001\n    return 0.001\nearly_stop=EarlyStopping(monitor='val_accuracy',patience=3)\nlearning_rate_scheduler=LearningRateScheduler(schedule)","96114961":"model=Sequential()\nmodel.add(Conv2D(128,(3,3),activation='relu',input_shape=(64,64,3)))\nmodel.add(MaxPool2D((2,2)))\nmodel.add(BatchNormalization())\nmodel.add(Conv2D(64,(3,3),activation='relu'))\nmodel.add(MaxPool2D((2,2)))\nmodel.add(BatchNormalization())\nmodel.add(Conv2D(32,(3,3),activation='relu'))\nmodel.add(MaxPool2D((2,2)))\nmodel.add(BatchNormalization())\nmodel.add(Flatten())\nmodel.add(Dense(128,activation='relu'))\nmodel.add(Dense(64,activation='relu'))\nmodel.add(Dense(1,activation='sigmoid'))","97cf0885":"model.compile(optimizer='adam',loss='binary_crossentropy',metrics=['accuracy'])","f1438a28":"r=model.fit(train_img,train_label,validation_data=(test_img,test_label),epochs=10,batch_size=100,callbacks=[early_stop,learning_rate_scheduler])","bf480b8e":"plt.plot(r.history['loss'])\nplt.plot(r.history['val_loss'])","c2d1cf62":"plt.plot(r.history['accuracy'])\nplt.plot(r.history['val_accuracy'])","c0ab6ef9":"plt.figure(figsize=(20,15))\nfor i in range(9):\n    plt.subplot(3,3,(i%9)+1)\n    rd_idx=np.random.randint(700)\n    pred_test=model.predict_classes(np.reshape(test_img[rd_idx],(-1,64,64,3)))\n    if pred_test==1:\n        plt.title('Predicted that there is vehicle in Image')\n    else:\n        plt.title('Predicted thet there is no vehicle in Image')\n    plt.axis('off')\n    plt.imshow(test_img[rd_idx])\nplt.show()\n","583a7b8f":"<h1 style=\"background-color:green;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Train test spliting of data<\/h1>\n<a id=2><\/a>","89b4e50a":"In this dataset our main objective is to predict if there is a vehicle in the image or not. There are about 17k images of dimension (64x64x3).\n\nTwo labels:\n\nNon-Vehicles\nVehicles","379b1dd3":"<center><img src=\"https:\/\/i.ytimg.com\/vi\/uD8kWFaL9_g\/maxresdefault.jpg\",height='500',width='600'><\/center>\n","4e9ec97e":"<h1 style=\"background-color:green;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Importing modules and Loading datasets<\/h1>\n<a id=1><\/a>","0eb2bd13":"<h1 style=\"background-color:green;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Visualization of Predicted Data<\/h1>\n<a id=3><\/a>","00f503b8":"<h1 style=\"color:red;font-family:algerian;font-size:200%;text-align:center;border-radius: 15px 15px;padding: 3px\">If You like the notebook, don't forget to upvote it. And if you have any doubt feel free to Ask in comment section.<\/h1>\n<a id=3><\/a>","3c50a6d6":"<h1 style=\"background-color:green;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Changing Dimension Of Data<\/h1>\n<a id=4><\/a>","1c5a087f":"<h1 style=\"background-color:green;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">OverView <\/h1>\n<a id=0><\/a>","3901e7e3":"<h1 style=\"background-color:yellow;font-family:newtimeroman;font-size:550%;text-align:center;border-radius: 15px 50px;padding: 5px\">Vehicle Identification<\/h1>\n","14fa15c6":"<h1 style=\"background-color:green;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Convolutional Neural Network<\/h1>\n<a id=5><\/a>","4bba3537":"<h1 style=\"background-color:green;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Data Visualization<\/h1>\n<a id=3><\/a>","752ee964":"<h1 style=\"background-color:green;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Callback Functions<\/h1>\n<a id=5><\/a>","e41dc4a2":"<h1 style=\"background-color:green;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Conclusion<\/h1>\n<a id=3><\/a>","eebb888a":"### Here we find that the model works quite well with accuracy of 99.99% on training dataset and 99.62% on test dataset.Thus this model is apt to identify the vehicles."}}