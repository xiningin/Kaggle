{"cell_type":{"496579f4":"code","60704cba":"code","642945d1":"code","84b2f42b":"code","1e4aba84":"code","010ceca3":"code","d94e2376":"code","fa7f65a3":"code","035e688c":"code","45259d5b":"code","39ce3109":"code","385545e1":"markdown","c7e860f5":"markdown"},"source":{"496579f4":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport statsmodels.api as sm\nimport statsmodels.formula.api as smf \n\n# Load the dataset\ndf = pd.read_csv(\"..\/input\/mental-health-in-tech-survey\/survey.csv\")\ndf.head()","60704cba":"# To check the shape of dataframe\ndf.shape","642945d1":"# general summary of the dataframe\n\ndf.info()","84b2f42b":"# Select variables (likely associated with treatment) for analysis\n\ndf1  = df[['treatment',\"tech_company\",\"Age\",'no_employees','family_history','Gender']]\n\nprint(df1)","1e4aba84":"# To check the number of unique values for the object columns\ndf1.select_dtypes(include=['object']).nunique()","010ceca3":"# There are 49 unique values in Gender column. Something is not right!\n# To inspect data in the Gender column.\n\ndf2 = df1[\"Gender\"].value_counts()\ndf2","d94e2376":"# To purge and group data in Gender column into Nonbinary, Female and Male \n\ndf1[\"Gender\"].replace(['A little about you', 'Agender',\n                       'All', 'Androgyne', 'Enby', 'non-binary',\n                       'Nah', 'something kinda male?', 'p',\n                       'ostensibly male, unsure what that really means',\n                       'Genderqueer', 'queer\/she\/they', 'Neuter', 'Trans woman',\n                       'Trans-female', 'queer', 'fluid', 'fluid', 'male leaning androgynous',\n                       'Female (trans)', 'Guy (-ish) ^_^'], 'Nonbinary', inplace=True)\n\n\ndf1[\"Gender\"].replace(['Cis Female', 'F', 'Femake', 'Female ', 'Female (cis)', 'Woman',\n                       'femail', 'female', 'woman', 'cis-female\/femme', 'f'], 'Female', inplace=True)\n\ndf1[\"Gender\"].replace(['Cis Male', 'Cis Man', 'M', 'Mail', 'Make', 'Mal',\n                       'Male ', 'Male (CIS)', 'Male-ish', 'Man', 'm', 'cis male',\n                       'maile','male','msle','Malr'], 'Male', inplace=True)\n\n\ndf1","fa7f65a3":"# Create dummy variables \ndf_new = pd.get_dummies(df1, columns = ['treatment', 'tech_company',\n                                            'no_employees', 'family_history', 'Gender']) \ndf_new","035e688c":"# Drop useless variables\ndf_new.drop(['tech_company_No', \"treatment_No\", \"family_history_No\"], axis = 1,inplace=True) \ndf_new","45259d5b":"# Compute the correlation matrix\ncorr = df_new.corr()\n\n# Generate a mask for the upper triangle\n\nmask = np.zeros_like(corr, dtype=np.bool)\nmask[np.triu_indices_from(mask)] = True\n\n# Set up the matplotlib figure\nf, ax = plt.subplots(figsize=(11, 9))\n\n# Generate a custom diverging colormap\ncmap = sns.diverging_palette(220, 10, as_cmap=True)\n\n# Draw the heatmap with the mask and correct aspect ratio\nsns.heatmap(corr, mask=mask, cmap=cmap, vmax=.3, center=0,\n            square=True, linewidths=.5, cbar_kws={\"shrink\": .5}, annot = True)","39ce3109":"# Calculate the addjusted odds ratio (adjusted with Age) with different independent variables \nlist_of_variables = [\"Gender_Female\",\"Gender_Nonbinary\",\"family_history_Yes\",\"tech_company_Yes\"]\n\n# list of models\nmodels = []\n\nfor var in list_of_variables:\n    formula = \"treatment_Yes ~ \" + var + \" + Age\" \n    models.append(smf.glm(formula=formula, data=df_new, family=sm.families.Binomial()).fit())\n    \n# To view the summary of individual results ie. 0 = Gender_Female and et cetera\nlist_inv =[0,1,2,3]\n\nfor x in list_inv:\n    print(models[x].summary())\n    print(\"odds ratio\")\n    print(np.exp(models[x].params))\n    print()\n    print(\"95% CI\")\n    print(np.exp(models[x].conf_int()).round(4))\n    print()\n    print(\"p-value\")\n    print(models[x].pvalues)\n    print()","385545e1":"**This kernel is modified from the \u201cstarter kernal\u201d by Megan Risdal and Esther Kim**","c7e860f5":"# **Interpretation**\n\n* The odds of female employees seeking treatment were 2.58 fold higher (p<0.001) than the male and nonbinary gender workers.\n* The odds of seeking treatment in nonbinary gender workers were significantly higher with OR = 3.98 (p=0.014).\n* The odds of seeking treatment were 5.22 times higher among individuals with family history of mental health problems compared to workers without family history.\n* There is no significant association between individuals working in tech company and mental illness."}}