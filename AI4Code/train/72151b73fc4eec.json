{"cell_type":{"6145f4e2":"code","8b0b4d23":"code","fb521430":"code","91a02f9a":"code","06351522":"code","fdb8577a":"code","ceadd1eb":"code","eb6b97e3":"code","9e5e934f":"code","2fc15b13":"code","7a710542":"code","4fe2f7e9":"code","b1b017b0":"code","e283a378":"code","d0dc7435":"code","a79f258f":"code","d2ab0c05":"code","3b631149":"code","aba0599d":"code","3d015a99":"code","88f6962b":"code","abc72ccc":"code","d6211988":"code","b113cc32":"code","4dd5ad89":"code","dac96440":"code","563db865":"code","3933cf08":"markdown","863b0e43":"markdown","9beb7bb5":"markdown","6fce6e5b":"markdown","6d150b6b":"markdown","d67612b4":"markdown","270d5296":"markdown","cb045460":"markdown"},"source":{"6145f4e2":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport warnings\n\nwarnings.filterwarnings(\"ignore\")","8b0b4d23":"pd.set_option(\"display.max_columns\",999)","fb521430":"df_train = pd.read_csv(\"..\/input\/digit-recognizer\/train.csv\")\ndf_train.head()","91a02f9a":"df_train.shape","06351522":"df_test = pd.read_csv(\"..\/input\/digit-recognizer\/test.csv\")\ndf_test.head()","fdb8577a":"### checking null \ndf_train.isnull().sum().sort_values(ascending = False)","ceadd1eb":"df_test.isnull().sum().sort_values(ascending = False)","eb6b97e3":"### checking digit values\ndf_train.label.value_counts()","9e5e934f":"y_train = df_train.pop(\"label\")\nx_train = df_train","2fc15b13":"### scaling the data\nfrom sklearn.preprocessing import StandardScaler","7a710542":"scaler = StandardScaler()","4fe2f7e9":"x_train_scaled = scaler.fit_transform(x_train)","b1b017b0":"df_test_scaled = scaler.transform(df_test)","e283a378":"### using PCA for dimensionality reduction\nfrom sklearn.decomposition import IncrementalPCA\nfrom sklearn.decomposition import PCA","d0dc7435":"pca = PCA(random_state=42)","a79f258f":"### drawing Scree plot to check optinal number of PC required to represent the data\npca.fit(x_train_scaled)","d2ab0c05":"var_cumu = np.cumsum(pca.explained_variance_ratio_)\nplt.plot(range(1,len(pca.explained_variance_ratio_)+1) , var_cumu)\nplt.show()","3b631149":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import cross_val_score","aba0599d":"### creating function to get the optimal PC and checking the accuracy of the model\ndef optimalModel(components):\n    incPCA = IncrementalPCA(n_components=components)\n    x_train_pc = pd.DataFrame(incPCA.fit_transform(x_train_scaled))\n    lr = LogisticRegression()\n    score = cross_val_score(lr , x_train_pc , y_train , cv=5,n_jobs=-1).mean()\n    return score","3d015a99":"pc_score = []\nfor i in range(200,500,25):\n    pc_score.append(optimalModel(i))","88f6962b":"fig = plt.figure(figsize=(12,10))\nplt.plot(range(200,500,25) , pc_score)\nplt.show()","abc72ccc":"### final Model\nincPCA = IncrementalPCA(n_components=225)\nx_train_pc = pd.DataFrame(incPCA.fit_transform(x_train_scaled))\nlr = LogisticRegression()\nmodel = lr.fit(x_train_pc , y_train)","d6211988":"x_test_pc = pd.DataFrame(incPCA.transform(df_test_scaled))","b113cc32":"df_test[\"Label\"] = model.predict(x_test_pc)","4dd5ad89":"df_test[\"Label\"].shape","dac96440":"df_test.index += 1","563db865":"df_test[\"Label\"].to_csv(\"prediction.csv\")","3933cf08":"<br>","863b0e43":"<br>","9beb7bb5":"### Model Building","6fce6e5b":"### Reading and Understanding Data","6d150b6b":"### Import packages","d67612b4":"### Predict the Test Value","270d5296":"<br>","cb045460":"#### Using Logistic Regression to predict"}}