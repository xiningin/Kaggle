{"cell_type":{"905ad799":"code","b1e794ac":"code","146758e3":"code","a4944784":"code","37588dac":"code","f6aaafa8":"code","95903031":"code","a4fc058b":"code","ddbc48ba":"code","1a6bac66":"code","28d395d2":"code","35016f0a":"code","2adcd2f3":"code","8da0e81b":"code","4fa521ef":"code","1721a0ab":"code","d9ac677c":"code","cc07a563":"code","bd1fb21e":"code","afec6972":"code","09e301e2":"code","ec0636ad":"markdown","1356a99d":"markdown","7bd3d83a":"markdown","68e91cd0":"markdown","cb71121b":"markdown","9b1e8607":"markdown","afd4f7be":"markdown","6813d966":"markdown","af275a47":"markdown","ce027f79":"markdown","176461da":"markdown","7725cd2f":"markdown","f0c0a01d":"markdown","cc247626":"markdown","2c078f16":"markdown","4a7738d9":"markdown","7f54925e":"markdown","2833f9da":"markdown","2a4c5534":"markdown","86b0ac9e":"markdown"},"source":{"905ad799":"import pandas as pd\nimport numpy as np\nfrom datetime import datetime\nfrom pytz import UTC\nfrom pytz import timezone\nimport seaborn as sns\nimport warnings\n\nwarnings.filterwarnings('ignore')","b1e794ac":"ercot=pd.read_csv('ercot_hourly_load.csv')\n\ncovid_conf=pd.read_csv('texas_covid_confirmed.csv', parse_dates=['Date'])\n\ncovid_death=pd.read_csv('texas_covid_deaths.csv', parse_dates=['Date'])\n\ngdp=pd.read_csv('Gdp.csv')\n\npop_density=pd.read_csv('Population_Density.csv')\n    \nweather_history=pd.read_csv('weather_history.csv',parse_dates=['date'])\n\nweather_forecast=pd.read_csv('weather_forecast.csv',parse_dates=['date'])\n","146758e3":"cities={\n    \"Coast\":[\n        \"Ace\",\"Alvin\",\"Anahuac\",\"Angleton\",\"Bacliff\",\"Batson\",\"Bay City\",\"Baytown\",\"Beasley\",\"Beaumont\",\"Bellaire\",\n        \"Bellville\",\"Blessing\",\"Bloomington\",\"Boling\", \"Bon Wier\",\"Brazoria\",\"Bridge City\",\"Brookshire\",\"Buna\",\n        \"Burkeville\",\"Call\",\"Camden\",\"Cedar Lane\",\"Channelview\",\"Chester\",\"China\",\"Cleveland\",\"Clute\",\"Coldspring\",\n        \"Collegeport\",\"Colmesneil\",\"Conroe\",\"Corrigan\",\"Crosby\",\"Cypress\",\"Daisetta\",\"Damon\",\"Danbury\",\"Danevang\",\n        \"Dayton\",\"Deer Park\",\"Devers\",\"Deweyville\",\"Dickinson\", \"Doucette\",\"Eagle Lake\",\"East Bernard\",\"Edna\",\"Egypt\",\n        \"El Campo\",\"Elmaton\",\"Evadale\",\"Francitas\",\"Fred\",\"Freeport\",\"Fresno\",\"Friendswood\", \"Fulshear\",\"Galena Park\",\n        \"Galveston\",\"Ganado\",\"Gilchrist\",\"Glen Flora\",\"Goodrich\",\"Groves\",\"Guy\",\"Hamshire\",\"Hankamer\",\"Hardin\",\"Hempstead\",\n        \"High Island\",\"Highlands\",\"Hillister\",\"Hitchcock\",\"Hockley\", \"Houston\",\"Huffman\",\"Hull\", \"Humble\",\"Hungerford\",\n        \"Inez\",\"Jasper\",\"Katy\",\"Kemah\",\"Kendleton\",\"Kingwood\",\"Kirbyville\", \"Kountze\",\"La Marque\",\"La Porte\",\"La Salle\",\n        \"La Ward\",\"Lake Jackson\", \"Lane City\",\"League City\", \"Leggett\", \"Liberty\",\"Lissie\",\"Liverpool\",\"Livingston\",\n        \"Lolita\",\"Louise\",\"Lumberton\",\"Magnolia\", \"Manvel\",\"Markham\",\"Matagorda\",\"Mcfaddin\",\"Midfield\",\"Missouri City\",\n        \"Mont Belvieu\",\"Montgomery\",\"Moscow\",\"Nederland\",\"Needville\",\"New Caney\",\"Newton\",\"Nome\",\"Nursery\",\"Oakhurst\",\n        \"Onalaska\", \"Orange\",\"Orchard\",\"Palacios\",\"Pasadena\",\"Pattison\",\"Pearland\", \"Pierce\",\"Pinehurst\",\"Placedo\",\n        \"Pledger\",\"Point Comfort\",\"Pointblank\",\"Port Arthur\",\"Port Bolivar\",\"Port Lavaca\",\"Port Neches\", \"Port O'Connor\",\n        \"Porter\",\"Prairie View\",\"Richmond\",\"Romayor\",\"Rosenberg\",\"Rosharon\",\"Rye\",\"Sabine Pass\",\"San Felipe\",\"Santa Fe\",\n        \"Saratoga\",\"Seabrook\",\"Seadrift\",\"Sealy\",\"Shepherd\",\"Sheridan\",\"Silsbee\",\"Simonton\",\"Sour Lake\", \"South Houston\",\n        \"Splendora\",\"Spring\", \"Spurger\",\"Stafford\", \"Stowell\",\"Sugar Land\", \"Sweeny\", \"Telferner\",\"Texas City\",  \"Thicket\",\n        \"Thompsons\",\"Tomball\",\"Van Vleck\",  \"Vanderbilt\",\"Victoria\", \"Vidor\",\"Village Mills\",  \"Votaw\",\"Wadsworth\", \"Waller\",\n        \"Wallis\",\"Wallisville\",  \"Warren\", \"Webster\", \"West Columbia\",\"Wharton\",\"Wiergate\", \"Willis\",\"Winnie\",\"Woodville\"\n        ],\n    \"East\":[\n        \"Alto\",\"Anderson\",\"Apple Springs\", \"Arp\", \"Athens\",  \"Atlanta\",\"Avinger\",\"Beckville\",  \"Bedias\",\"Ben Wheeler\",\n        \"Big Sandy\",\"Bivins\",\"Bloomburg\",\"Brashear\",\"Bremond\",\"Bronson\",\"Brookeland\",\"Brownsboro\",\"Bryan\",\"Buffalo\",\n        \"Bullard\",\"Calvert\",\"Canton\",\"Carthage\",\"Cayuga\",\"Center\",\"Centerville\",\"Chandler\",\"Chireno\",\"College Station\",\n        \"Como\",\"Cookville\",\"Crockett\",\"Cumby\",\"Cuney\",\"Cushing\",\"Daingerfield\",\"De Berry\",\"Diana\",\"Diboll\",\"Dike\",\"Donie\",\n        \"Douglass\",\"Douglassville\",\"Edgewood\",\"Elkhart\",  \"Emory\", \"Etoile\",\"Eustace\",\"Fairfield\", \"Flint\", \"Flynn\",\n        \"Franklin\",\"Frankston\",\"Fruitvale\",\"Gallatin\",\"Garrison\",\"Gary\",\"Gilmer\",\"Grand Saline\",\"Grapeland\", \"Groveton\",\n        \"Hearne\",\"Hemphill\",\"Henderson\",\"Hughes Springs\", \"Huntington\", \"Iola\",\"Jacksonville\",\"Jefferson\",   \"Jewett\",\n        \"Joaquin\",  \"Kennard\",\"Kildare\",\"Kirvin\",\"Laneville\",\"Larue\",  \"Latexo\", \"Leesburg\",     \"Leona\",\"Lindale\",\"Linden\",\n        \"Lone Star\",\"Long Branch\",\"Lovelady\",\"Lufkin\",\"Madisonville\",    \"Malakoff\",\"Marietta\",\"Marquez\",\"McLeod\", \"Midway\",\n        \"Milam\",\"Montalba\",\"Mount Enterprise\", \"Mount Pleasant\", \"Mount Vernon\",\"Mumford\",\"Murchison\",\"Nacogdoches\",\"Naples\",\n        \"Navasota\",\"Neches\",\"New London\",\"New Summerfield\",\"Normangee\",\"North Zulch\",\"Oakwood\", \"Omaha\",\"Ore City\",\"Overton\",\n        \"Palestine\",\"Pennington\",\"Pickton\",\"Pineland\",\"Pittsburg\",\"Plantersville\",  \"Point\", \"Pollok\",\"Queen City\",\"Quitman\",\n        \"Ratcliff\",\"Reklaw\",\"Richards\",\"Rusk\",\"Sacul\",\"Saltillo\", \"Scroggins\",\"Shelbyville\",\"Shiro\",\"Streetman\",\"Sulphur Bluff\",\n        \"Sulphur Springs\", \"Talco\",\"Tatum\",\"Teague\", \"Tenaha\", \"Tennessee Colony\", \"Timpson\",\"Trinidad\",  \"Trinity\",\"Troup\",\n        \"Tyler\",\"Van\",\"Waskom\",\"Wells\",\"Whitehouse\", \"Wills Point\",\"Winfield\",\"Winona\",\"Woden\",\"Wortham\",\"Yantis\",\"Zavalla\"\n        ],\n    \"Far West\":[\n        \"Ackerly\",\"Alpine\",\"Andrews\",\"Anthony\",\"Balmorhea\",\"Barstow\",\"Big Bend National Park\",\"Big Lake\",\"Big Spring\",\n        \"Canutillo\",\"Clint\",\"Coahoma\",\"Coyanosa\",\"Crane\",\"Dell City\",\"Dryden\",\"El Paso\",\"Fabens\",\"Forsan\",\"Fort Bliss\",\n        \"Fort Davis\",\"Fort Hancock\",\"Fort Stockton\", \"Gail\",\"Garden City\",\"Gardendale\",\"Goldsmith\",\"Grandfalls\", \"Imperial\",\n        \"Iraan\",\"Kermit\",\"Knott\",\"Lamesa\",\"Lenorah\", \"Marathon\",\"Marfa\",\"McCamey\", \"Mentone\",\"Midkiff\", \"Midland\",\"Monahans\",\n        \"Notrees\",\"Odessa\",\"Odonnell\",\"Orla\",\"Ozona\",\"Pecos\",\"Presidio\",\"Pyote\",\"Rankin\",\"Redford\",\"Salt Flat\",\"San Elizario\",\n        \"Sanderson\",\"Saragosa\",\"Sheffield\",\"Sierra Blanca\",\"Stanton\", \"Tarzan\",\"Terlingua\",\"Tornillo\", \"Toyah\",\"Valentine\",\n        \"Van Horn\",\"Welch\", \"Wickett\",\"Wink\"\n        ],\n    \"North\":[\n        \"Afton\",\"Allison\",\"Annona\",\"Archer City\",\"Arthur City\",\"Aspermont\",\"Avery\",\"Bagwell\",\"Bailey\",\"Bellevue\",\n        \"Bells\",\"Benjamin\",\"Blossom\",\"Bogata\",\"Bonham\",\"Bowie\", \"Briscoe\",\"Brookston\",\"Burkburnett\",\"Byers\",\"Childress\",\n        \"Chillicothe\",\"Clarendon\",\"Clarksville\",\"Collinsville\",\"Crosbyton\",\"Crowell\",  \"De Kalb\",\"Denison\",  \"Deport\",\n        \"Detroit\",\"Dickens\", \"Dodd City\",\"Ector\",\"Electra\",\"Era\",\"Estelline\", \"Flomot\",\"Forestburg\", \"Gainesville\",\"Girard\",\n        \"Gordonville\",\"Goree\",\"Gunter\",\"Guthrie\",\"Harrold\",\"Haskell\",\"Hedley\", \"Henrietta\",\"Holliday\",\"Honey Grove\",\"Hooks\",\n        \"Howe\",\"Iowa Park\",\"Ivanhoe\",\"Jayton\",\"Knox City\",  \"Ladonia\",\n        \"Lakeview\",\"Lelia Lake\",\"Leonard\",\"Lindsay\",\"Lorenzo\",\"Matador\",\"Maud\",\"Mcadoo\",\"Megargel\",\"Memphis\",\"Mobeetie\",\n        \"Montague\",\"Muenster\",\"Munday\",\"Myra\",\"Nash\",\"New Boston\",\"Nocona\",\"O'Brien\",\"Odell\",\"Oklaunion\",\"Old Glory\",\n        \"Paducah\",\"Paris\",\"Pattonville\",\"Petrolia\",\"Petty\",\"Pottsboro\",\"Powderly\",\"Quanah\",\"Quitaque\",\"Ralls\", \"Randolph\",\n        \"Ravenna\",\"Redwater\",\"Ringgold\",\"Roaring Springs\",\"Rochester\",\"Rosston\",\"Roxton\",\"Rule\",\"Sadler\",\"Saint Jo\",\"Savoy\",\n        \"Scotland\",\"Seymour\",\"Shamrock\",\"Sheppard Afb\",\"Sherman\",\"Silverton\",\"Simms\",\"Southmayd\", \"Spur\",\"Sumner\",\"Sunset\",\n        \"Telephone\",\"Tell\",\"Texarkana\",\"Tioga\",\"Tom Bean\", \"Trenton\",\"Turkey\",\"Valley View\",\"Van Alstyne\",\"Vernon\",\"Weinert\",\n        \"Wheeler\",\"Whitesboro\",\"Whitewright\",\"Wichita Falls\", \"Windom\",\"Windthorst\"\n             ],\n    \"North Central\":[\n        \"Abbott\",\"Addison\", \"Albany\",\"Aledo\",\"Allen\",\"Alvarado\",\"Alvord\",\"Anna\",\"Aquilla\",\"Argyle\",\"Arlington\",\n        \"Aubrey\",\"Avalon\",\"Axtell\",\"Azle\",\"Baird\", \"Balch Springs\",\"Bangs\",\"Bardwell\",\"Barry\",\"Bartlett\",\"Bedford\",\"Belton\",\n        \"Ben Franklin\",\"Blanket\",\"Blooming Grove\",\"Blue Ridge\",\"Bluff Dale\",\"Blum\",  \"Boyd\",\"Brandon\",\"Breckenridge\",\n        \"Bridgeport\",\"Brookesmith\",\"Brownwood\",\"Bruceville\",\"Bryson\",\"Burleson\",\"Bynum\",\"Caddo\",\"Caddo Mills\",\"Campbell\",\n        \"Carbon\",\"Carlton\",\"Carrollton\",\"Cedar Hill\", \"Celeste\",\"Celina\",\"Chatfield\",\"Chico\",\"Chilton\",\"China Spring\",\n        \"Cisco\",\"Cleburne\",\"Clifton\",\"Clyde\",\"Colleyville\",\"Comanche\", \"Commerce\",\"Coolidge\",\"Cooper\", \"Coppell\",\n        \"Copperas Cove\",\"Corsicana\",\"Covington\",\"Crandall\",\"Cranfills Gap\",\"Crawford\",\"Cresson\",\"Cross Plains\",\"Crowley\",\n        \"Dallas\",\"Dawson\",\"De Leon\",\"Decatur\",\"Denton\",\"Desdemona\",\"Desoto\", \"Dublin\",\"Duncanville\",\"Early\",\"Eastland\",\n        \"Eddy\",\"Elm Mott\",\"Energy\",\"Enloe\",\"Ennis\",\"Euless\",\"Evant\",\"Farmersville\",\"Fate\", \"Ferris\",\"Flower Mound\",\"Forney\",\n        \"Forreston\",\"Fort Hood\",\"Fort Worth\",\"Frisco\",\"Frost\",\"Garland\",\"Gatesville\",\"Glen Rose\",\"Godley\",\"Goldthwaite\",\n        \"Gordon\",\"Gorman\",\"Graford\",\"Graham\",\"Granbury\", \"Grand Prairie\",\"Grandview\",\"Grapevine\",\"Greenville\",\"Groesbeck\",\n        \"Gustine\",\"Haltom City\",\"Hamilton\",\"Harker Heights\",\"Haslet\",\"Hewitt\",\"Hico\",\"Hillsboro\",\"Holland\",\"Hubbard\",\n        \"Hurst\",\"Hutchins\", \"Iredell\",\"Irene\",\"Irving\",\"Italy\",\"Itasca\",\"Jacksboro\",\"Jermyn\", \"Jonesboro\",\"Josephine\",\n        \"Joshua\",\"Justin\",\"Kaufman\",\"Keene\",\"Keller\",\"Kemp\",\"Kennedale\",\"Kerens\",\"Killeen\",\"Klondike\",\"Kopperl\",\"Kosse\",\n        \"Krum\",\"Lake Creek\",\"Lake Dallas\",\"Lancaster\",\"Lavon\",\"Leroy\", \"Lewisville\",\"Lillian\",\"Lipan\",\"Little Elm\",\n        \"Little River Academy\",\"Lone Oak\",\"Lorena\",\"Lott\", \"Loving\",\"Mabank\",\"Malone\",\"Mansfield\",\"Marlin\",\"Mart\", \"May\",\n        \"Maypearl\",\"McGregor\",\"Mckinney\",\"Melissa\",\"Meridian\",\"Mertens\",\"Mesquite\",  \"Mexia\",\"Midlothian\",\"Milford\",\"Millsap\",\n        \"Mineral Wells\",\"Mingus\",\"Moody\", \"Moran\",\"Morgan\", \"Mount Calm\",\"Mullin\",   \"Naval Air Station Jrb\",\"Nemo\",\"Nevada\",\n        \"Newark\",\"Newcastle\",\"Nolanville\",\"North Richland Hills\",\"Oglesby\",\"Olden\",\"Olney\",\"Palmer\",\"Palo Pinto\",\"Paradise\",\n        \"Pecan Gap\", \"Penelope\",\"Perrin\", \"Pilot Point\",\"Plano\",\"Ponder\",\"Poolville\",\"Pottsville\",\"Powell\",\"Prairie Hill\",\n        \"Priddy\",\"Princeton\",\"Prosper\",\"Purdon\",\"Purmela\",\"Putnam\",\"Quinlan\",\"Rainbow\",\"Ranger\",\"Reagan\",\"Red Oak\",\n        \"Rhome\",\"Rice\",\"Richardson\",\"Richland\",\"Riesel\",\"Rio Vista\",\"Rising Star\",\"Roanoke\",\"Rockwall\",\"Rogers\",\"Rosebud\",\n        \"Rosser\",\"Rowlett\",\"Royse City\",\"Sachse\",\"Salado\",\"Sanger\",\"Santo\",\"Satin\",\"Scurry\",\"Seagoville\",\"Sidney\",\n        \"South Bend\",\"Southlake\",\"Springtown\",\"Stephenville\",\"Strawn\", \"Sunnyvale\",\"Tehuacana\",\"Temple\", \"Terrell\",\n        \"The Colony\",\"Thornton\", \"Throckmorton\",\"Tolar\",\"Troy\",\"Valley Mills\",\"Venus\",  \"Waco\",\"Walnut Springs\",\n        \"Waxahachie\",\"Weatherford\",\"West\",\"Whitney\",\"Whitt\",\"Wilmer\", \"Wolfe City\",  \"Woodson\",\"Woodway\",\"Wylie\",\"Zephyr\"\n        ],\n    \"South\":[\n        \"Agua Dulce\",\"Alamo\",\"Alice\", \"Aransas Pass\",  \"Armstrong\",\"Artesia Wells\",\"Asherton\",\"Austwell\",\"Banquete\",\n        \"Batesville\", \"Bayside\",\"Beeville\",\"Ben Bolt\",\"Benavides\",\"Berclair\",\"Big Wells\", \"Bigfoot\",\"Bishop\",\"Brownsville\",\n        \"Bruni\",\"Calliham\",\"Campbellton\",\"Carrizo Springs\",\"Catarina\",\"Charlotte\",\"Christine\",\"Combes\",\"Concepcion\",\n        \"Corpus Christi\",\"Cotulla\",\"Crystal City\",\"Delmita\",\"Dilley\",\"Donna\",\"Driscoll\",\"Eagle Pass\",\"Edcouch\",\"Edinburg\",\n        \"Edroy\",\"El Indio\",\"Elsa\",\"Encinal\",\"Encino\",\"Falcon Heights\",\"Falfurrias\",\"Fannin\",\"Fowlerton\", \"Freer\",\"Fulton\",\n        \"George West\",\"Goliad\",\"Gregory\",\"Grulla\", \"Hargill\",\"Harlingen\",\"Hebbronville\",\"Hidalgo\",  \"Ingleside\",\"Jourdanton\",\n        \"Kingsville\",\"La Blanca\",\"La Feria\",\"La Joya\",\"La Pryor\",\"La Villa\",\"Laredo\",\"Lasara\",\"Leming\",\"Linn\", \"Lopeno\",\n        \"Los Ebanos\",\"Los Fresnos\",\"Los Indios\",\"Lyford\",\"Lytle\",\"Mathis\",\"Mcallen\",\"Mercedes\",\"Mineral\",\"Mirando City\",\n        \"Mission\",\"Moore\",\"Normanna\",\"Oakville\",\"Odem\",\"Oilton\",\"Olmito\",\"Orange Grove\", \"Pawnee\",\"Pearsall\",\"Penitas\",\n        \"Pettus\",\"Pharr\",\"Pleasanton\",\"Port Aransas\",\"Port Isabel\",\"Port Mansfield\",\"Portland\",\"Poteet\",\"Premont\",\n        \"Progreso\",\"Quemado\",\"Raymondville\",\"Realitos\", \"Refugio\",\"Rio Grande City\",\"Rio Hondo\", \"Riviera\",\"Robstown\",\n        \"Rockport\",\"Roma\",\"Salineno\",\"San Benito\",\"San Diego\",\"San Isidro\",\"San Juan\",\"San Perlita\",\"San Ygnacio\",\n        \"Sandia\",\"Santa Elena\",\"Santa Maria\",\"Santa Rosa\", \"Sarita\", \"Sebastian\", \"Sinton\",\"Skidmore\",\"South Padre Island\",\n        \"Sullivan City\", \"Taft\",\"Three Rivers\", \"Tilden\",  \"Tivoli\",\"Tuleta\",  \"Tynan\",\"Weesatche\",\"Weslaco\", \"Whitsett\",\n        \"Woodsboro\",\"Zapata\"\n        ],\n    \"South Central\":[\n        \"Adkins\",\"Alleyton\",\"Altair\",\"Atascosa\",\"Austin\",\"Bandera\",\"Bastrop\",\"Bergheim\",\"Bertram\",\"Blanco\",\n        \"Bleiblerville\",\"Boerne\",\"Brenham\", \"Briggs\",\"Buckholts\",\"Buda\",\"Bulverde\",\"Burlington\",  \"Burnet\", \"Burton\",\n        \"Caldwell\",\"Cameron\",\"Canyon Lake\",\"Carmine\",\"Castroville\",\"Cat Spring\",\"Cedar Creek\",\"Cedar Park\",\"Chappell Hill\",\n        \"Cibolo\",\"Columbus\",\"Comfort\",\"Converse\",\"Cost\", \"Coupland\",\"Cuero\", \"D Hanis\",\"Dale\",\"Davilla\",  \"Del Valle\",\n        \"Devine\",\"Dime Box\",\"Driftwood\",\"Dripping Springs\", \"Elgin\",\"Ellinger\", \"Elmendorf\",\"Falls City\",\"Fayetteville\",\n        \"Fentress\",\"Fischer\",\"Flatonia\",\"Florence\",\"Floresville\", \"Garwood\",\"Gause\",\"Georgetown\",\"Giddings\", \"Gillett\",\n        \"Glidden\", \"Gonzales\", \"Granger\",\"Hallettsville\", \"Harwood\",\"Helotes\", \"Hobson\",\"Hondo\", \"Horseshoe Bay\",\"Hutto\",\n        \"Hye\",\"Industry\", \"Jarrell\",\"Jbsa Ft Sam Houston\",\"Jbsa Lackland\",\"Jbsa Randolph\",\"Johnson City\",\"Karnes City\",\n        \"Kendalia\",\"Kenedy\",\"Kingsbury\", \"Kyle\", \"La Coste\", \"La Grange\", \"La Vernia\", \"Leander\",\"Ledbetter\", \"Leesville\",\n        \"Lexington\",\"Liberty Hill\",\"Lincoln\",\"Lockhart\",\"Luling\",\"Manchaca\",\"Manor\",\"Marble Falls\",\"Marion\",\"Martindale\",\n        \"Maxwell\",\"McDade\",\"McQueeney\",\"Medina\",\"Meyersville\", \"Mico\",  \"Milano\",\"Moulton\",\"Muldoon\", \"Nada\",\"Natalia\",\n        \"New Braunfels\",\"New Ulm\",\"Nixon\",\"Nordheim\",\"Oakland\",\"Paige\",\"Pandora\",\"Panna Maria\",\"Pflugerville\",\"Pipe Creek\",\n        \"Poth\",\"Prairie Lea\", \"Red Rock\",\"Rio Medina\",\"Rock Island\",\"Rockdale\", \"Rosanky\",\"Round Mountain\",\"Round Rock\",\n        \"Round Top\",\"Runge\",\"Saint Hedwig\",\"San Antonio\",\"San Marcos\",\"Schertz\", \"Schulenburg\",  \"Schwertner\", \"Seguin\",\n        \"Shiner\",  \"Smiley\",\"Smithville\", \"Snook\",\"Somerset\",\"Somerville\",\"Spicewood\",\"Spring Branch\",\"Staples\",\"Stockdale\",\n        \"Sutherland Springs\",\"Sweet Home\",\"Tarpley\",\"Taylor\",\"Thorndale\",\"Thrall\", \"Universal City\",\"Vanderpool\", \"Von Ormy\",\n        \"Waelder\",\"Washington\", \"Weimar\",\"West Point\",  \"Westhoff\",\"Wimberley\",\"Wrightsboro\",\"Yancey\",\"Yoakum\", \"Yorktown\"\n        ],\n    \"West\":[\n        \"Abilene\", \"Anson\",\"Art\",\"Avoca\",\"Ballinger\",\"Barksdale\",\"Barnhart\",\"Bend\",\"Blackwell\",\"Bluffton\",\n        \"Brackettville\",\"Brady\",\"Bronte\",\"Buchanan Dam\",\"Buffalo Gap\", \"Burkett\",\"Camp Wood\",\"Carlsbad\",\"Castell\",\n        \"Center Point\",\"Cherokee\",\"Christoval\",\"Coleman\",\"Colorado City\",\"Comstock\",\"Concan\",\"Del Rio\",\"Doole\",\"Doss\",\n        \"Dyess Afb\",\"Eden\",\"Eldorado\",\"Eola\",\"Fluvanna\",\"Fort McKavett\",\"Fredericksburg\", \"Fredonia\",\"Goldsboro\",\n        \"Goodfellow Afb\",\"Gouldbusk\", \"Hamlin\", \"Harper\",    \"Hawley\",\"Hermleigh\",\"Hext\",\"Hunt\",\"Ingram\", \"Ira\",\"Junction\",\n        \"Kempner\", \"Kerrville\",\"Kingsland\",\"Knickerbocker\",\"Knippa\",\"Lampasas\",\"Langtry\",\"Laughlin Afb\",   \"Lawn\",\"Leakey\",\n        \"Llano\",\"Lohn\",\"Lometa\",\"London\",\"Loraine\",\"Lueders\", \"Maryneal\",\"Mason\",\"McCaulley\",\"Melvin\", \"Menard\",\"Mereta\",\n        \"Merkel\",\"Mertzon\",\"Miles\",\"Millersview\",\"Mountain Home\", \"Nolan\",\"Norton\",\"Novice\",\"Ovalo\",\"Paint Rock\",\"Pontotoc\",\n        \"Richland Springs\",\"Rio Frio\", \"Robert Lee\", \"Roby\",\"Rochelle\",\"Rocksprings\", \"Rockwood\",\"Roosevelt\",\"Roscoe\",\n        \"Rotan\",\"Rowena\",  \"Sabinal\",\"San Angelo\",\"San Saba\",\"Santa Anna\",  \"Silver\",\"Snyder\",\"Sonora\",  \"Stamford\",\n        \"Sterling City\",\"Stonewall\",\"Sweetwater\",\"Sylvester\",\"Talpa\",\"Tennyson\", \"Tow\",\"Trent\",\"Tuscola\",\"Tye\",\"Utopia\",\n        \"Uvalde\",\"Valera\",\"Valley Spring\",\"Vancourt\",\"Voca\",\"Voss\",\"Wall\",\"Water Valley\",\"Westbrook\",\"Willow City\",\"Wingate\",\n        \"Winters\"\n        ]\n}","a4944784":"counties={\n    \"Coast\":[\n        \"Austin\",\"Brazoria\",\"Calhoun\", \"Chambers\",\"Colorado\",\"Fort Bend\",\"Galveston\",\"Goliad\",\"Grimes\",\"Hardin\",\"Harris\",\n        \"Jackson\",\"Jasper\",\"Jefferson\",\"Liberty\",\"Matagorda\",\"Montgomery\",\"Newton\",\"Orange\",\"Polk\",\"San Jacinto\",\"Tyler\",\"Victoria\",\n        \"Waller\",\"Wharton\"\n        ],\n    \"East\":[\n        \"Anderson\",\"Angelina\",\"Brazos\",\"Camp\",\"Cass\",\"Cherokee\",\"Falls\",\"Franklin\",\"Freestone\",\"Gregg\",\"Grimes\",\"Harrison\",\n        \"Henderson\",\"Hopkins\",\"Houston\",\"Hunt\",\"Jasper\",\"Kaufman\",\"Leon\",\"Limestone\",\"Madison\",\"Marion\",\"Miller\",\"Montgomery\",\n        \"Morris\",\"Nacogdoches\",\"Navarro\",\"Newton\",\"Panola\",\"Rains\",\"Robertson\",\"Rusk\",\"Sabine\",\"San Augustine\",\"Shelby\",\n        \"Smith\",\"Titus\",\"Trinity\",\"Upshur\",\"Van Zandt\",\"Walker\",\"Waller\",\"Washington\",\"Wood\"\n        ],\n    \"Far West\":[\n        \"Andrews\",\"Borden\",\"Brewster\",\"Crane\",\"Crockett\",\"Culberson\",\"Dawson\",\"Ector\",\"El Paso\",\"Gaines\",\"Glasscock\",\n        \"Howard\",\"Hudspeth\",\"Jeff Davis\",\"Loving\",\"Lynn\",\"Martin\",\"Midland\",\"Otero\",\"Pecos\",\"Presidio\",\"Reagan\",\"Reeves\",\n        \"Terrell\",\"Upton\",\"Val Verde\",\"Ward\",\"Winkler\"\n        ],\n    \"North\":[\n        \"Archer\",\"Armstrong\",\"Baylor\",\"Bowie\",\"Briscoe\",\"Childress\",\"Clay\",\"Collin\",\"Collingsworth\",\"Cooke\",\"Cottle\",\n        \"Crosby\",\"Denton\",\"Dickens\",\"Donley\",\"Fannin\",\"Floyd\",\"Foard\",\"Grayson\",\"Hall\",\"Hardeman\",\"Haskell\",\"Hemphill\",\n        \"Hunt\", \"Jack\",\"Kent\",\"King\",\"Knox\",\"Lamar\",\"Lubbock\",\"Montague\",\"Motley\",\"Red River\",\"Stonewall\",\"Wheeler\",\"Wichita\",\n        \"Wilbarger\",\"Wise\"\n        ],\n    \"North Central\":[\n        \"Archer\",\"Bell\",\"Bosque\",\"Brown\",\"Burnet\",\"Callahan\",\"Coleman\",\"Collin\",\"Comanche\",\"Cooke\",\"Coryell\",\n        \"Dallas\",\"Delta\",\"Denton\",\"Eastland\",\"Ellis\",\"Erath\",\"Falls\",  \"Fannin\",\"Freestone\",  \"Grayson\",\"Hamilton\",\"Henderson\",\n        \"Hill\",\"Hood\",\"Hopkins\",\"Hunt\",\"Jack\",\"Johnson\",\"Kaufman\",\"Lampasas\",\"Limestone\",\"McLennan\",\"Milam\",\"Mills\",\"Navarro\",\n        \"Palo Pinto\",\"Parker\",\"Rains\", \"Robertson\",\"Rockwall\",\"Shackelford\",\"Somervell\",\"Stephens\",\"Tarrant\",\"Throckmorton\",\n        \"Van Zandt\",\"Williamson\",\"Wise\",\"Young\"\n        ],\n    \"South\":[\n        \"Aransas\", \"Atascosa\",  \"Bee\",\"Bexar\",\"Brooks\",\"Calhoun\",\"Cameron\", \"Dimmit\",\"Duval\", \"Frio\",\"Goliad\",\"Hidalgo\",\"Jim Hogg\",\"Jim Wells\",\n        \"Kenedy\",  \"Kleberg\",\"La Salle\",\"Live Oak\",\"Maverick\",\"McMullen\",\"Medina\",\"Nueces\", \"Refugio\",\"San Patricio\",  \"Starr\",\"Webb\",\"Willacy\",\n        \"Wilson\",\"Zapata\",\"Zavala\"\n        ],\n    \"South Central\":[\n        \"Atascosa\",\"Austin\",\"Bandera\",\"Bastrop\",\"Bee\",\"Bell\", \"Bexar\",\"Blanco\",\"Burleson\",\"Burnet\",\"Caldwell\",\"Colorado\",\n        \"Comal\",\"DeWitt\",\"Falls\", \"Fayette\", \"Frio\",\"Goliad\",\"Gonzales\",\"Guadalupe\",\"Hays\",\"Karnes\",\"Kendall\",\"Kerr\",\"Lavaca\", \"Lee\",\n        \"Live Oak\", \"Llano\",\"Medina\",\"Milam\",\"Real\",\"Travis\", \"Victoria\",\"Washington\",\"Williamson\",\"Wilson\"\n        ],\n    \"West\":[\n        \"Bandera\",\"Bell\",\"Blanco\", \"Borden\",\"Burnet\",\"Callahan\",\"Coke\",\"Coleman\",\"Concho\",\"Coryell\", \"Edwards\", \"Fisher\",\"Gillespie\",\n        \"Haskell\",\"Irion\",\"Jones\",\"Kendall\", \"Kent\",\"Kerr\",\"Kimble\",\"Kinney\",\"Lampasas\",\"Llano\",\"Mason\",\"McCulloch\",\"Medina\",\"Menard\",\n        \"Mills\",\"Mitchell\",\"Nolan\",\"Real\",\"Runnels\",\"San Saba\",\"Schleicher\", \"Scurry\",\"Shackelford\",\"Sterling\",\"Stonewall\",\"Sutton\",\n        \"Taylor\",\"Throckmorton\",\"Tom Green\",\"Uvalde\",\"Val Verde\"\n        ]\n}","37588dac":"counties_list=[\n    \"Austin\",\"Brazoria\",\"Calhoun\", \"Chambers\",\"Colorado\",\"Fort Bend\",\"Galveston\",\"Goliad\",\"Grimes\",\"Hardin\",\"Harris\",\n    \"Jackson\",\"Jasper\",\"Jefferson\",\"Liberty\",\"Matagorda\",\"Montgomery\",\"Newton\",\"Orange\",\"Polk\",\"San Jacinto\",\"Tyler\",\"Victoria\",\n    \"Waller\",\"Wharton\",\"Anderson\",\"Angelina\",\"Brazos\",\"Camp\",\"Cass\",\"Cherokee\",\"Falls\",\"Franklin\",\"Freestone\",\"Gregg\",\"Grimes\",\"Harrison\",\n    \"Henderson\",\"Hopkins\",\"Houston\",\"Hunt\",\"Jasper\",\"Kaufman\",\"Leon\",\"Limestone\",\"Madison\",\"Marion\",\"Montgomery\",\n    \"Morris\",\"Nacogdoches\",\"Navarro\",\"Newton\",\"Panola\",\"Rains\",\"Robertson\",\"Rusk\",\"Sabine\",\"San Augustine\",\"Shelby\",\n    \"Smith\",\"Titus\",\"Trinity\",\"Upshur\",\"Van Zandt\",\"Walker\",\"Waller\",\"Washington\",\"Wood\",\"Andrews\",\"Borden\",\"Brewster\",\"Crane\",\"Crockett\",\n    \"Culberson\",\"Dawson\",\"Ector\",\"El Paso\",\"Gaines\",\"Glasscock\",\"Howard\",\"Hudspeth\",\"Jeff Davis\",\"Loving\",\"Lynn\",\"Martin\",\"Midland\",\n    \"Pecos\",\"Presidio\",\"Reagan\",\"Reeves\",\"Terrell\",\"Upton\",\"Val Verde\",\"Ward\",\"Winkler\",\n    \"Archer\",\"Armstrong\",\"Baylor\",\"Bowie\",\"Briscoe\",\"Childress\",\"Clay\",\"Collin\",\"Collingsworth\",\"Cooke\",\"Cottle\",\n    \"Crosby\",\"Denton\",\"Dickens\",\"Donley\",\"Fannin\",\"Floyd\",\"Foard\",\"Grayson\",\"Hall\",\"Hardeman\",\"Haskell\",\"Hemphill\",\n    \"Hunt\", \"Jack\",\"Kent\",\"King\",\"Knox\",\"Lamar\",\"Lubbock\",\"Montague\",\"Motley\",\"Red River\",\"Stonewall\",\"Wheeler\",\"Wichita\",\n    \"Wilbarger\",\"Wise\",\"Archer\",\"Bell\",\"Bosque\",\"Brown\",\"Burnet\",\"Callahan\",\"Coleman\",\"Collin\",\"Comanche\",\"Cooke\",\"Coryell\",\n    \"Dallas\",\"Delta\",\"Denton\",\"Eastland\",\"Ellis\",\"Erath\",\"Falls\",  \"Fannin\",\"Freestone\",  \"Grayson\",\"Hamilton\",\"Henderson\",\n    \"Hill\",\"Hood\",\"Hopkins\",\"Hunt\",\"Jack\",\"Johnson\",\"Kaufman\",\"Lampasas\",\"Limestone\",\"McLennan\",\"Milam\",\"Mills\",\"Navarro\",\n    \"Palo Pinto\",\"Parker\",\"Rains\", \"Robertson\",\"Rockwall\",\"Shackelford\",\"Somervell\",\"Stephens\",\"Tarrant\",\"Throckmorton\",\n    \"Van Zandt\",\"Williamson\",\"Wise\",\"Young\",\"Aransas\", \"Atascosa\",  \"Bee\",\"Bexar\",\"Brooks\",\"Calhoun\",\"Cameron\", \"Dimmit\",\"Duval\",\n    \"Frio\",\"Goliad\",\"Hidalgo\",\"Jim Hogg\",\"Jim Wells\",\"Kenedy\",  \"Kleberg\",\"La Salle\",\"Live Oak\",\"Maverick\",\"McMullen\",\"Medina\",\n    \"Nueces\", \"Refugio\",\"San Patricio\",  \"Starr\",\"Webb\",\"Willacy\",\"Wilson\",\"Zapata\",\"Zavala\",\n    \"Atascosa\",\"Austin\",\"Bandera\",\"Bastrop\",\"Bee\",\"Bell\", \"Bexar\",\"Blanco\",\"Burleson\",\"Burnet\",\"Caldwell\",\"Colorado\",\n    \"Comal\",\"DeWitt\",\"Falls\", \"Fayette\", \"Frio\",\"Goliad\",\"Gonzales\",\"Guadalupe\",\"Hays\",\"Karnes\",\"Kendall\",\"Kerr\",\"Lavaca\", \"Lee\",\n    \"Live Oak\", \"Llano\",\"Medina\",\"Milam\",\"Real\",\"Travis\", \"Victoria\",\"Washington\",\"Williamson\",\"Wilson\",\n    \"Bandera\",\"Bell\",\"Blanco\", \"Borden\",\"Burnet\",\"Callahan\",\"Coke\",\"Coleman\",\"Concho\",\"Coryell\", \"Edwards\", \"Fisher\",\"Gillespie\",\n    \"Haskell\",\"Irion\",\"Jones\",\"Kendall\", \"Kent\",\"Kerr\",\"Kimble\",\"Kinney\",\"Lampasas\",\"Llano\",\"Mason\",\"McCulloch\",\"Medina\",\"Menard\",\n    \"Mills\",\"Mitchell\",\"Nolan\",\"Real\",\"Runnels\",\"San Saba\",\"Schleicher\", \"Scurry\",\"Shackelford\",\"Sterling\",\"Stonewall\",\"Sutton\",\n    \"Taylor\",\"Throckmorton\",\"Tom Green\",\"Uvalde\",\"Val Verde\"\n    ]","f6aaafa8":"covid_c_melt=pd.melt(\n                  covid_conf,\n                  id_vars='Date',\n                  value_vars=counties_list,\n                  var_name='counties'\n                  )\n\ncovid_d_melt=pd.melt(\n                  covid_death,\n                  id_vars='Date',\n                  value_vars=counties_list,\n                  var_name='counties'\n                  )","95903031":"condlistCounties=[\n          np.isin(covid_c_melt[\"counties\"],counties[\"Coast\"]),\n          np.isin(covid_c_melt[\"counties\"],counties[\"East\"]),\n          np.isin(covid_c_melt[\"counties\"],counties[\"Far West\"]),\n          np.isin(covid_c_melt[\"counties\"],counties[\"North\"]),\n          np.isin(covid_c_melt[\"counties\"],counties[\"North Central\"]),\n          np.isin(covid_c_melt[\"counties\"],counties[\"South\"]),\n          np.isin(covid_c_melt[\"counties\"],counties[\"South Central\"]),\n          np.isin(covid_c_melt[\"counties\"],counties[\"West\"])\n           ]\n\ncondlistCounties2=[\n          np.isin(covid_d_melt[\"counties\"],counties[\"Coast\"]),\n          np.isin(covid_d_melt[\"counties\"],counties[\"East\"]),\n          np.isin(covid_d_melt[\"counties\"],counties[\"Far West\"]),\n          np.isin(covid_d_melt[\"counties\"],counties[\"North\"]),\n          np.isin(covid_d_melt[\"counties\"],counties[\"North Central\"]),\n          np.isin(covid_d_melt[\"counties\"],counties[\"South\"]),\n          np.isin(covid_d_melt[\"counties\"],counties[\"South Central\"]),\n          np.isin(covid_d_melt[\"counties\"],counties[\"West\"])\n           ]\n\ncondlistCounties3=[\n          np.isin(gdp[\"County\"],counties[\"Coast\"]),\n          np.isin(gdp[\"County\"],counties[\"East\"]),\n          np.isin(gdp[\"County\"],counties[\"Far West\"]),\n          np.isin(gdp[\"County\"],counties[\"North\"]),\n          np.isin(gdp[\"County\"],counties[\"North Central\"]),\n          np.isin(gdp[\"County\"],counties[\"South\"]),\n          np.isin(gdp[\"County\"],counties[\"South Central\"]),\n          np.isin(gdp[\"County\"],counties[\"West\"])\n           ]\n\ncondlistCities=[\n          np.isin(weather_history[\"city\"],cities[\"Coast\"]),\n          np.isin(weather_history[\"city\"],cities[\"East\"]),\n          np.isin(weather_history[\"city\"],cities[\"Far West\"]),\n          np.isin(weather_history[\"city\"],cities[\"North\"]),\n          np.isin(weather_history[\"city\"],cities[\"North Central\"]),\n          np.isin(weather_history[\"city\"],cities[\"South\"]),\n          np.isin(weather_history[\"city\"],cities[\"South Central\"]),\n          np.isin(weather_history[\"city\"],cities[\"West\"])\n           ]\n\ncondlistCities2=[\n          np.isin(pop_density[\"name\"],cities[\"Coast\"]),\n          np.isin(pop_density[\"name\"],cities[\"East\"]),\n          np.isin(pop_density[\"name\"],cities[\"Far West\"]),\n          np.isin(pop_density[\"name\"],cities[\"North\"]),\n          np.isin(pop_density[\"name\"],cities[\"North Central\"]),\n          np.isin(pop_density[\"name\"],cities[\"South\"]),\n          np.isin(pop_density[\"name\"],cities[\"South Central\"]),\n          np.isin(pop_density[\"name\"],cities[\"West\"])\n           ]\n\ncondlistCities3=[\n          np.isin(weather_forecast[\"city\"],cities[\"Coast\"]),\n          np.isin(weather_forecast[\"city\"],cities[\"East\"]),\n          np.isin(weather_forecast[\"city\"],cities[\"Far West\"]),\n          np.isin(weather_forecast[\"city\"],cities[\"North\"]),\n          np.isin(weather_forecast[\"city\"],cities[\"North Central\"]),\n          np.isin(weather_forecast[\"city\"],cities[\"South\"]),\n          np.isin(weather_forecast[\"city\"],cities[\"South Central\"]),\n          np.isin(weather_forecast[\"city\"],cities[\"West\"])\n           ]\n\nchoicelist=[\"Coast\", \"East\",\"Far West\", \"North\", \"North Central\",\"South\", \"South Central\", \"West\"]","a4fc058b":"gdp[\"region\"]=np.select(condlistCounties3,choicelist)\ngdp['gdp']=gdp['GDP'].str.replace(',','',regex=False).astype(float)\ngdp_grouped = gdp.groupby(['region'],as_index=False)[['gdp']].mean()","ddbc48ba":"pop_density[\"region\"]=np.select(condlistCities2,choicelist)\npop_density_grouped = pop_density.groupby(['region'],as_index=False)[['density']].mean()","1a6bac66":"covid_c_melt[\"region\"]=np.select(condlistCounties,choicelist)\ncovid_c_melt.rename(columns={'value':'Covid_Confirmed'},inplace=True)\ncovid_c_grouped = covid_c_melt.groupby(['Date','region'],as_index=False)[['Covid_Confirmed']].sum()\ncovid_c_grouped['Covid_Confirmed_Change'] = covid_c_grouped.groupby(['region'])['Covid_Confirmed'].diff()","28d395d2":"covid_d_melt[\"region\"]=np.select(condlistCounties2,choicelist)\ncovid_d_melt.rename(columns={'value':'Covid_Death'},inplace=True)\ncovid_d_grouped = covid_d_melt.groupby(['Date','region'],as_index=False)[['Covid_Death']].sum()\ncovid_d_grouped['Covid_Death_Change'] = covid_d_grouped.groupby(['region'])['Covid_Death'].diff()","35016f0a":"covid_merge=pd.merge(\n    covid_c_grouped,\n    covid_d_grouped,\n    how=\"inner\",\n    on=['Date','region'],\n    left_on=None,\n    right_on=None,\n    left_index=False,\n    right_index=False,\n    sort=True,\n    suffixes=(\"_x\", \"_y\"),\n    copy=True,\n    indicator=False,\n    validate=None,\n)","2adcd2f3":"weather_history[\"region\"]=np.select(condlistCities,choicelist)\nweather_history['Time']=weather_history['time']\/\/100\nweather_history['date']=pd.to_datetime(weather_history['date'],utc=True)\nweather_history['date'] +=  pd.to_timedelta(weather_history.Time, unit='h')\nweather_hist_grouped = weather_history.groupby(['date','region'],as_index=False)[[\n                                                      'tempC','tempF','windspeedMiles','windspeedKmph','winddirDegree','winddir16Point','weatherCode','weatherDesc',\n                                                      'precipMM','precipInches','humidity','visibility','visibilityMiles','pressure','pressureInches','cloudcover',\n                                                      'HeatIndexC','HeatIndexF','DewPointC','DewPointF','WindChillC','WindChillF','WindGustMiles','WindGustKmph',\n                                                      'FeelsLikeC','FeelsLikeF','uvIndex']].mean()","8da0e81b":"weather_forecast[\"region\"]=np.select(condlistCities3,choicelist)\nweather_forecast['Time']=weather_forecast['time']\/\/100\nweather_forecast['date']=pd.to_datetime(weather_forecast['date'],utc=True)\nweather_forecast['date'] +=  pd.to_timedelta(weather_forecast.Time, unit='h')\nweather_fore_grouped = weather_forecast.groupby(['date','region'],as_index=False)[[\n                                                      'tempC','tempF','windspeedMiles','windspeedKmph','winddirDegree','winddir16Point','weatherCode','weatherDesc',\n                                                      'precipMM','precipInches','humidity','visibility','visibilityMiles','pressure','pressureInches','cloudcover',\n                                                      'HeatIndexC','HeatIndexF','DewPointC','DewPointF','WindChillC','WindChillF','WindGustMiles','WindGustKmph',\n                                                      'FeelsLikeC','FeelsLikeF','uvIndex']].mean()\nweather_fore_grouped.set_index(['date','region'])","4fa521ef":"template=pd.DataFrame(pd.to_datetime(pd.period_range(\"6\/12\/2021\", freq=\"H\", periods=193).to_timestamp(),utc=True))\ntemplate.rename(columns={0:'date'},inplace=True)\ntemplate['region']='Coast'\n\ntemplate2=template.copy()\ntemplate2['region']='East'\n\ntemplate3=template.copy()\ntemplate3['region']='Far West'\n\ntemplate4=template.copy()\ntemplate4['region']='North'\n\ntemplate5=template.copy()\ntemplate5['region']='North Central'\n\ntemplate6=template.copy()\ntemplate6['region']='South'\n\ntemplate7=template.copy()\ntemplate7['region']='South Central'\n\ntemplate8=template.copy()\ntemplate8['region']='West'\n\ntemplate_all=pd.concat([template, template2, template3, template4, template5, template6, template7, template8])","1721a0ab":"weather_forecast2=pd.merge(\n    template_all,\n    weather_fore_grouped,\n    how=\"left\",\n    on=None,\n    left_on=['region','date'],\n    right_on=['region','date'],\n    left_index=False,\n    right_index=False,\n    sort=True,\n    suffixes=(\"_x\", \"_y\"),\n    copy=True,\n    indicator=False,\n    validate=None,\n)\n\n\n\n\nfor column in weather_forecast2[['tempC','tempF','windspeedMiles','windspeedKmph','winddirDegree','weatherCode','precipMM','precipInches','humidity','visibility',\n                                       'visibilityMiles','pressure','pressureInches','cloudcover','HeatIndexC','HeatIndexF','DewPointC','DewPointF','WindChillC',\n                                       'WindChillF','WindGustMiles','WindGustKmph','FeelsLikeC','FeelsLikeF','uvIndex']]:\n    weather_forecast2['prev2']=weather_forecast2[column].shift(2)\n    weather_forecast2['prev1']=weather_forecast2[column].shift(1)\n    weather_forecast2['fut1']=weather_forecast2[column].shift(-1)\n    weather_forecast2['fut2']=weather_forecast2[column].shift(-2)\n\n    \n    weather_forecast2[column+'New']=np.where(weather_forecast2[column].notnull(),weather_forecast2[column],\n                                             np.where(weather_forecast2['prev1'].notnull(),weather_forecast2[['prev1','fut2','prev1']].mean(axis=1),\n                                                      weather_forecast2[['prev2','fut1','fut1']].mean(axis=1)))\n\n \n    weather_forecast2.drop(columns=['prev2','prev1','fut1','fut2',column],inplace=True)\n\nweather_forecast2.to_csv('Weather Test.csv') ","d9ac677c":"ercot_melt=pd.melt(ercot,\n                  id_vars='Hour_Ending',\n                  value_vars=['Coast','East','Far West','North','North Central','South','South Central','West'],\n                  var_name='region')\nercot_melt.rename(columns={\"value\":\"ercot\"},inplace=True)\nercot_melt[\"Date_string\"]=ercot_melt['Hour_Ending'].str.slice(start=0,stop=19)\nercot_melt[\"Date\"]=pd.to_datetime(ercot_melt['Hour_Ending'].str.slice(start=0,stop=10))\nercot_melt['date']=pd.to_datetime(ercot_melt['Hour_Ending'],utc=True)-pd.to_timedelta(6,unit='h')\nmask = (ercot_melt['date'] >= '2008-07-1') \nercot_filtered=ercot_melt.loc[mask]","cc07a563":"# Merge weather data and ercot data\n\nercot_weather_hist=pd.merge(\n    ercot_filtered,\n    weather_hist_grouped,\n    how=\"left\",\n    on=['date','region'],\n    left_on=None,\n    right_on=None,\n    left_index=False,\n    right_index=False,\n    sort=True,\n    suffixes=(\"_x\", \"_y\"),\n    copy=True,\n    indicator=False,\n    validate=None,\n)\n\n# Merge previous data set with covid merged data \n\nercot_weather_covid=pd.merge(\n    ercot_weather_hist,\n    covid_merge,\n    how=\"left\",\n    on=['Date','region'],\n    left_on=None,\n    right_on=None,\n    left_index=False,\n    right_index=False,\n    sort=True,\n    suffixes=(\"_x\", \"_y\"),\n    copy=True,\n    indicator=False,\n    validate=None,\n)\n\n# Merged previous data with gdp data \n\nercot_wth_covid_gdp=pd.merge(\n    ercot_weather_covid,\n    gdp_grouped,\n    how=\"left\",\n    on=['region'],\n    left_on=None,\n    right_on=None,\n    left_index=False,\n    right_index=False,\n    sort=True,\n    suffixes=(\"_x\", \"_y\"),\n    copy=True,\n    indicator=False,\n    validate=None,\n)\n\n# Merged previous data with population density data \n\nercot_wth_covid_gdp_pop=pd.merge(\n    ercot_wth_covid_gdp,\n    pop_density_grouped,\n    how=\"left\",\n    on=['region'],\n    left_on=None,\n    right_on=None,\n    left_index=False,\n    right_index=False,\n    sort=True,\n    suffixes=(\"_x\", \"_y\"),\n    copy=True,\n    indicator=False,\n    validate=None,\n)\n","bd1fb21e":"# Average missing ercot data. \n\nercot_wth_covid_gdp_pop['prev1']=ercot_wth_covid_gdp_pop['ercot'].shift(1)\nercot_wth_covid_gdp_pop['fut1']=ercot_wth_covid_gdp_pop['ercot'].shift(-1)\n\n\nercot_wth_covid_gdp_pop['ercotNew']=np.where(ercot_wth_covid_gdp_pop['ercot'].notnull(),ercot_wth_covid_gdp_pop['ercot'],\n                                          ercot_wth_covid_gdp_pop[['prev1','fut1']].mean(axis=1))\nercot_wth_covid_gdp_pop.drop(columns=['prev1','fut1'],inplace=True)\n\n# Average missing weather data. First missing value has more weight from previous value. Second missing value puts more weight on the next value\n\nfor column in ercot_wth_covid_gdp_pop[['tempC','tempF','windspeedMiles','windspeedKmph','winddirDegree','weatherCode','precipMM','precipInches','humidity','visibility',\n                                       'visibilityMiles','pressure','pressureInches','cloudcover','HeatIndexC','HeatIndexF','DewPointC','DewPointF','WindChillC',\n                                       'WindChillF','WindGustMiles','WindGustKmph','FeelsLikeC','FeelsLikeF','uvIndex']]:\n    ercot_wth_covid_gdp_pop['prev2']=ercot_wth_covid_gdp_pop[column].shift(2)\n    ercot_wth_covid_gdp_pop['prev1']=ercot_wth_covid_gdp_pop[column].shift(1)\n    ercot_wth_covid_gdp_pop['fut1']=ercot_wth_covid_gdp_pop[column].shift(-1)\n    ercot_wth_covid_gdp_pop['fut2']=ercot_wth_covid_gdp_pop[column].shift(-2)\n\n    \n    ercot_wth_covid_gdp_pop[column+'Int']=np.where(ercot_wth_covid_gdp_pop[column].notnull(),ercot_wth_covid_gdp_pop[column],\n                                             np.where(ercot_wth_covid_gdp_pop['prev1'].notnull(),ercot_wth_covid_gdp_pop[['prev1','fut2','prev1']].mean(axis=1),\n                                                      ercot_wth_covid_gdp_pop[['prev2','fut1','fut1']].mean(axis=1)))\n\n    ercot_wth_covid_gdp_pop[column + '24']=ercot_wth_covid_gdp_pop[column+'Int'].shift(24)\n    ercot_wth_covid_gdp_pop[column+'New']=np.where(ercot_wth_covid_gdp_pop['Date']=='4\/30\/2021',ercot_wth_covid_gdp_pop[column + '24'],ercot_wth_covid_gdp_pop[column+'Int'])\n \n    ercot_wth_covid_gdp_pop.drop(columns=['prev2','prev1','fut1','fut2',column,column+'24',column+'Int' ],inplace=True)","afec6972":"df = ercot_wth_covid_gdp_pop[[\"region\",\"ercotNew\",\"Date\",\"Date_string\",'date',\"Covid_Confirmed\",\"Covid_Confirmed_Change\",\"Covid_Death\",\"Covid_Death_Change\",\"gdp\",\n                                  \"density\",\"tempCNew\",\"windspeedMilesNew\",\"winddirDegreeNew\",\"weatherCodeNew\",\"precipMMNew\",\"humidityNew\",\"visibilityNew\",\"pressureNew\",\n                                  \"cloudcoverNew\",\"HeatIndexCNew\",\"DewPointCNew\",\"WindChillCNew\",\"WindGustMilesNew\",\"FeelsLikeCNew\",\"uvIndexNew\"]]\n\ncols=[\"Covid_Confirmed\",\"Covid_Confirmed_Change\",\"Covid_Death\",\"Covid_Death_Change\"]\nfor i in cols:\n  df[i]=df[i].fillna(0)\n\n\ndf.to_csv('Dataframe Original.csv')\n\n\nprint(df.isnull().sum())\n\n\nprint(df.describe())","09e301e2":"cols=[\"ercotNew\",\"Covid_Confirmed\",\"Covid_Confirmed_Change\",\"Covid_Death\",\"Covid_Death_Change\",\"gdp\",\"density\",\"tempCNew\",\"windspeedMilesNew\",\"winddirDegreeNew\",\n      \"weatherCodeNew\",\"precipMMNew\",\"humidityNew\",\"visibilityNew\",\"pressureNew\",\"cloudcoverNew\",\"HeatIndexCNew\",\"DewPointCNew\",\"WindChillCNew\",\"WindGustMilesNew\",\n      \"FeelsLikeCNew\",\"uvIndexNew\"]\n\ndef replace(group):\n    \n    mean, std = group.mean(), group.std()\n    outliers = (group - mean).abs() > 2*std\n\n    group[outliers] = mean\n    return group\n\ndf.groupby('region').transform(replace)\n\n\n\nprint(df.describe())\nprint(df.head())\n\n# Output data to csv and text. Text will have all the rows.\n\n\ndf.to_csv('Dataframe Outliers.csv') ","ec0636ad":"Handle missing data","1356a99d":"Weather history data set:  Map cities to region, add time to date, average out all weather variables by date and time","7bd3d83a":"Weather forecast data set:  Map cities to region, add time to date, average out all weather variables by date and time","68e91cd0":"Population Density Data Set","cb71121b":"Merge two covid-19 data sets together","9b1e8607":"Handle outliers","afd4f7be":"Read in data sets provided from competition","6813d966":"GDP Data set","af275a47":"Dictionary for counties to region","ce027f79":"Keeping variables that we need and filling missing info with 0","176461da":"Merge weather forecast data with template and then handle missing data by populating with weighted averages","7725cd2f":"Dictionary for cities to region","f0c0a01d":"List of counties","cc247626":"Ercot data set: Change structure by collapsing region variables to one column, convert date to UTC then back to local,\n    and only keep rows if its after July 2008 because that is when we have weather data","2c078f16":"Create conditional lists to search for county or city values that are in the specified regions","4a7738d9":"Tranpose COVID-19 data sets so that columns are variables","7f54925e":"Merge Data Sets","2833f9da":"Covid Death data set: Map counties to region, sum cases deaths across region and date, and\n    then create a variable that finds the difference in cases deaths from previous date","2a4c5534":"Covid Confirmed data set: Map counties to region, sum cases confirmed across region and date, and\n    then create a variable that finds the difference in cases from previous date","86b0ac9e":"Create template for forecasted weather data to handle missing rows"}}