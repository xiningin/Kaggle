{"cell_type":{"e41b1f6b":"code","d7aacaaf":"code","23f72bbf":"code","00df519e":"markdown","51b71ef5":"markdown","41d55539":"markdown"},"source":{"e41b1f6b":"!pip install -U lightautoml","d7aacaaf":"import pandas as pd\n\nfrom lightautoml.automl.presets.tabular_presets import TabularAutoML, TabularUtilizedAutoML\nfrom lightautoml.dataset.roles import DatetimeRole\nfrom lightautoml.tasks import Task\nfrom lightautoml.utils.profiler import Profiler\n\nCPU_LIMIT = 4\nTIMEOUT = 600\n\ntrain = pd.read_csv('..\/input\/titanic\/train.csv')\ntest = pd.read_csv('..\/input\/titanic\/test.csv')\nsubmission = pd.read_csv('..\/input\/titanic\/gender_submission.csv')\n\ntask = Task('binary',metric='accuracy')\nlabel = 'Survived'\nroles = {\n    'target': label,\n    'drop': ['PassengerId', 'Name','Ticket'],\n}\n\nautoml = TabularAutoML(task=task, \n                       timeout=TIMEOUT,\n                       cpu_limit=CPU_LIMIT,\n                       reader_params={'n_jobs': CPU_LIMIT})\nautoml.fit_predict(train,roles=roles)","23f72bbf":"prediction = automl.predict(test)\nsubmission[label] = (prediction.data[:, 0]>0.5).astype(int)\nsubmission.to_csv('submission.csv.csv',index=False)\nsubmission","00df519e":"## version 2021\/04\/19","51b71ef5":"## Prediction","41d55539":"## Modeling"}}