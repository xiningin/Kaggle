{"cell_type":{"e24a7acc":"code","fd212890":"code","7462ba4a":"code","96175248":"code","d4d228c7":"code","4c8a7740":"code","23e1e0e9":"code","455e3364":"code","e15e7b73":"code","8c515510":"code","f1ea93e9":"code","cc60673e":"code","21d4042d":"code","2b5b66f5":"code","28e08ff6":"code","5ddcb15c":"code","9d623114":"code","b27c11dc":"code","a8d00842":"code","b423ddd6":"code","80b2df0f":"code","06d5c6dd":"code","f676b488":"code","f29166cb":"code","30d58463":"code","2e45d0bd":"code","47323c41":"code","4970be56":"code","a52526b2":"code","930c06cb":"code","c9bf91cb":"markdown","0b628a78":"markdown","20014bcd":"markdown","9cdfcb3e":"markdown","cfa606f3":"markdown","52560542":"markdown","4664160b":"markdown","193063a7":"markdown","41e159b8":"markdown","eddaadb2":"markdown","28a849e6":"markdown","bc0b56b2":"markdown","a0009e49":"markdown","58332ec8":"markdown","04d3993f":"markdown","e59c4275":"markdown","0c83557d":"markdown","3da5ea6a":"markdown","04ddc59a":"markdown","516842ad":"markdown","53d812d5":"markdown","8f2ea723":"markdown"},"source":{"e24a7acc":"import pandas as pd\nimport numpy as np\nfrom datetime import datetime","fd212890":"import lightgbm as lgbm","7462ba4a":"data_folder = \"..\/input\/g-research-crypto-forecasting\/\"\n!ls $data_folder","96175248":"crypto_df = pd.read_csv(data_folder + 'train.csv')","d4d228c7":"crypto_df.head(10)","4c8a7740":"asset_details = pd.read_csv(data_folder + 'asset_details.csv')\nasset_details","23e1e0e9":"crypto_df['date'] = crypto_df['timestamp'].apply(lambda x: datetime.fromtimestamp(x))","455e3364":"# NaN\u3068\u306a\u3063\u3066\u3044\u308bTarget\u3092\u5b66\u7fd2\u30c7\u30fc\u30bf\u304b\u3089\u9664\u5916\u3057\u305f\ncrypto_df = crypto_df[(crypto_df['Target']>0)|(crypto_df['Target']<=0)]","e15e7b73":"# import matplotlib.pyplot as plt\n\n# # plot vwap time series for both chosen assets\n# f = plt.figure(figsize=(15,4))\n\n# # fill missing values for BTC\n# btc = btc.reindex(range(btc.index[0],btc.index[-1]+60,60),method='pad')\n\n# ax = f.add_subplot(121)\n# plt.plot(btc['Close'], label='BTC')\n# plt.legend()\n# plt.xlabel('Time')\n# plt.ylabel('Bitcoin')\n\n# ax2 = f.add_subplot(122)\n# ax2.plot(eth['Close'], color='red', label='ETH')\n# plt.legend()\n# plt.xlabel('Time')\n# plt.ylabel('Ethereum')\n\n# plt.tight_layout()\n# plt.show()","8c515510":"# import time\n\n# # auxiliary function, from datetime to timestamp\n# totimestamp = lambda s: np.int32(time.mktime(datetime.strptime(s, \"%d\/%m\/%Y\").timetuple()))\n\n# # create intervals\n# btc_mini_2021 = btc.loc[totimestamp('01\/06\/2021'):totimestamp('01\/07\/2021')]\n# eth_mini_2021 = eth.loc[totimestamp('01\/06\/2021'):totimestamp('01\/07\/2021')]","f1ea93e9":"# # plot time series for both chosen assets\n# f = plt.figure(figsize=(7,8))\n\n# ax = f.add_subplot(211)\n# plt.plot(btc_mini_2021['Close'], label='btc')\n# plt.legend()\n# plt.xlabel('Time')\n# plt.ylabel('Bitcoin Close')\n\n# ax2 = f.add_subplot(212)\n# ax2.plot(eth_mini_2021['Close'], color='red', label='eth')\n# plt.legend()\n# plt.xlabel('Time')\n# plt.ylabel('Ethereum Close')\n\n# plt.tight_layout()\n# plt.show()","cc60673e":"# # Select some input features from the trading data: \n# # 5 min log return, abs(5 min log return), upper shadow, and lower shadow.\n# upper_shadow = lambda asset: asset.High - np.maximum(asset.Close,asset.Open)\n# lower_shadow = lambda asset: np.minimum(asset.Close,asset.Open)- asset.Low\n\n# X_btc = pd.concat([log_return(btc.VWAP,periods=5), log_return(btc.VWAP,periods=1).abs(), \n#                upper_shadow(btc), lower_shadow(btc)], axis=1)\n# y_btc = btc.Target\n\n# X_eth = pd.concat([log_return(eth.VWAP,periods=5), log_return(eth.VWAP,periods=1).abs(), \n#                upper_shadow(eth), lower_shadow(eth)], axis=1)\n# y_eth = eth.Target","21d4042d":"crypto_df.tail()","2b5b66f5":"crypto_df['Target'].max()","28e08ff6":"crypto_df['Target'].min()","5ddcb15c":"# select training and test periods\n# \u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306a\u306e\u3067\u3001test\u30c7\u30fc\u30bf\u306f\u672a\u6765\u306b\u306a\u308b\u3088\u3046\u306b\u8abf\u6574\ntrain_term_end = '2021-03-01'","9d623114":"asset_details","b27c11dc":"crypto_df.head()","a8d00842":"datamart= pd.merge(crypto_df,asset_details[['Asset_ID','Weight']],on='Asset_ID',how='left')","b423ddd6":"# datamart.head()","80b2df0f":"# divide data into train and test, compute X and y\n# \u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306a\u306e\u3067\u3001test\u30c7\u30fc\u30bf\u306f\u672a\u6765\u306b\u306a\u308b\u3088\u3046\u306b\u8abf\u6574\nlgbm_train = datamart[datamart['date']< train_term_end].fillna(0)\nlgbm_eval = datamart[datamart['date']>= train_term_end].fillna(0)","06d5c6dd":"# lgbm_train.head()","f676b488":"drop_list = ['Target','date']","f29166cb":"y_train = lgbm_train['Target']\nX_train = lgbm_train.drop(drop_list , axis=1)\ny_test = lgbm_eval['Target']\nX_test = lgbm_eval.drop(drop_list , axis=1)\n\n\ndataset_train=lgbm.Dataset(X_train, y_train)\ndataset_eval=lgbm.Dataset(X_test, y_test, reference=dataset_train)","30d58463":"# X_train.head()","2e45d0bd":"params = {'task': 'train',\n          'boosting_type': 'gbdt',      # GBDT\u3092\u6307\u5b9a\n          'objective': 'regression', # \u76ee\u7684 : \u56de\u5e30  \n          'metric': {'rmse'}, # \u8a55\u4fa1\u6307\u6a19 : rsme(\u5e73\u5747\u4e8c\u4e57\u8aa4\u5dee\u306e\u5e73\u65b9\u6839) \n          'learning_rate': 0.1,         # \u5b66\u7fd2\u7387\n          'num_leaves': 23,             # \u30ce\u30fc\u30c9\u306e\u6570\n          'min_data_in_leaf': 3,        # \u6c7a\u5b9a\u6728\u30ce\u30fc\u30c9\u306e\u6700\u5c0f\u30c7\u30fc\u30bf\u6570\n          'num_iteration': 1000         # \u4e88\u6e2c\u5668(\u6c7a\u5b9a\u6728)\u306e\u6570:\u30a4\u30bf\u30ec\u30fc\u30b7\u30e7\u30f3\n         }\n ","47323c41":"# \u30e2\u30c7\u30eb\u306e\u5b66\u7fd2\nlgbm_model = lgbm.train(params,\n                        train_set=dataset_train, # \u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30c7\u30fc\u30bf\u306e\u6307\u5b9a\n                        valid_sets=dataset_eval, # \u691c\u8a3c\u30c7\u30fc\u30bf\u306e\u6307\u5b9a\n                        early_stopping_rounds=1000\n                  )\n","4970be56":"y_pred = lgbm_model.predict(X_test)","a52526b2":"lgbm.plot_importance(lgbm_model, figsize=(12, 8))\n","930c06cb":"from sklearn.metrics import mean_squared_error # \u30e2\u30c7\u30eb\u8a55\u4fa1\u7528(\u5e73\u5747\u4e8c\u4e57\u8aa4\u5dee)\nfrom sklearn.metrics import r2_score # \u30e2\u30c7\u30eb\u8a55\u4fa1\u7528(\u6c7a\u5b9a\u4fc2\u6570)\n# \u30e2\u30c7\u30eb\u8a55\u4fa1\n# rmse : \u5e73\u5747\u4e8c\u4e57\u8aa4\u5dee\u306e\u5e73\u65b9\u6839\nmse = mean_squared_error(y_test, y_pred) # MSE(\u5e73\u5747\u4e8c\u4e57\u8aa4\u5dee)\u306e\u7b97\u51fa\nrmse = np.sqrt(mse) # RSME = \u221aMSE\u306e\u7b97\u51fa\nprint('RMSE :',rmse)\n\n#r2 : \u6c7a\u5b9a\u4fc2\u6570\nr2 = r2_score(y_test,y_pred)\nprint('R2 :',r2)","c9bf91cb":"This forecasting competition aims to predict returns in the near future for prices $P^a$, for each asset $a$. For each row in the dataset, we include the target for prediction, `Target`. `Target` is derived from log returns ($R^a$) over 15 minutes.\n\n\u3053\u306e\u4e88\u6e2c\u30b3\u30f3\u30da\u30c6\u30a3\u30b7\u30e7\u30f3\u306f\u3001\u5404\u8cc7\u7523$a$\u306b\u3064\u3044\u3066\u3001\u4fa1\u683c$P^a$\u306b\u5bfe\u3059\u308b\u8fd1\u672a\u6765\u306e\u30ea\u30bf\u30fc\u30f3\u3092\u4e88\u6e2c\u3059\u308b\u3053\u3068\u3092\u76ee\u7684\u3068\u3057\u3066\u3044\u307e\u3059\u3002\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u5404\u884c\u306b\u306f\u3001\u4e88\u6e2c\u306e\u30bf\u30fc\u30b2\u30c3\u30c8\u3067\u3042\u308b`Target`\u304c\u542b\u307e\u308c\u308b\u3002`Target`\u306f15\u5206\u9593\u306e\u5bfe\u6570\u53ce\u76ca\u7387($R^a$)\u304b\u3089\u5f97\u3089\u308c\u308b\u3002\n\n$$R^a(t) = log (P^a(t+16)\\ \/\\ P^a(t+1))$$\n\nCrypto asset returns are highly correlated, following to a large extend the overall crypto market. As we want to test your ability to predict returns for individual assets, we perform a linear residualization, removing the market signal from individual asset returns when creating the two targets. In more detail, if $M(t)$ is the weighted average market returns, the target is:\n\n\u6697\u53f7\u8cc7\u7523\u306e\u30ea\u30bf\u30fc\u30f3\u306f\u975e\u5e38\u306b\u76f8\u95a2\u6027\u304c\u9ad8\u304f\u3001\u6697\u53f7\u5e02\u5834\u5168\u4f53\u3092\u5927\u304d\u304f\u30d5\u30a9\u30ed\u30fc\u3057\u3066\u3044\u307e\u3059\u3002\u500b\u3005\u306e\u8cc7\u7523\u306e\u30ea\u30bf\u30fc\u30f3\u3092\u4e88\u6e2c\u3059\u308b\u80fd\u529b\u3092\u30c6\u30b9\u30c8\u3057\u305f\u3044\u305f\u3081\u30012\u3064\u306e\u30bf\u30fc\u30b2\u30c3\u30c8\u3092\u4f5c\u6210\u3059\u308b\u969b\u306b\u306f\u3001\u500b\u3005\u306e\u8cc7\u7523\u306e\u30ea\u30bf\u30fc\u30f3\u304b\u3089\u5e02\u5834\u306e\u30b7\u30b0\u30ca\u30eb\u3092\u9664\u53bb\u3057\u3001\u7dda\u5f62\u6b8b\u5dee\u3092\u884c\u3044\u307e\u3059\u3002\u3088\u308a\u8a73\u7d30\u306b\u306f\u3001$M(t)$\u304c\u52a0\u91cd\u5e73\u5747\u5e02\u5834\u30ea\u30bf\u30fc\u30f3\u3067\u3042\u308b\u5834\u5408\u3001\u30bf\u30fc\u30b2\u30c3\u30c8\u306f\n\n$$M(t) = \\frac{\\sum_a w^a R^a(t)}{\\sum_a w^a}  \\\\\n\\beta^a = \\frac{\\langle M \\cdot R^a \\rangle}{\\langle M^2 \\rangle} \\\\\n\\text{Target}^a(t) = R^a(t) - \\beta^a M(t)$$\n\nwhere the bracket $\\langle .\\rangle$ represent the rolling average over time (3750 minute windows). \n\n\u3053\u3053\u3067\u3001\u62ec\u5f27\u5185\u306e$\\langle .\\rangle$\u306f\u3001\u6642\u9593\uff083750\u5206\u7a93\uff09\u3067\u306e\u30ed\u30fc\u30ea\u30f3\u30b0\u5e73\u5747\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\nSome rows have null values for targets due to missing values in future prices. Rows with nulls in the test set ground truth are ignored for scoring purposes.\n\n\u4e00\u90e8\u306e\u884c\u3067\u306f\u3001\u5c06\u6765\u306e\u4fa1\u683c\u306e\u5024\u304c\u6b20\u843d\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u30bf\u30fc\u30b2\u30c3\u30c8\u306e\u5024\u304c\u6b20\u640d\u5024\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u30c6\u30b9\u30c8\u30bb\u30c3\u30c8\u306e\u306b\u6b20\u640d\u5024\u304c\u3042\u308b\u884c\u306f\u3001\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u306e\u305f\u3081\u306b\u7121\u8996\u3055\u308c\u307e\u3059\u3002\n\nIn the competition, your predictions will be evaluated on a weighted version of the Pearson correlation coefficient, with weights given by the `Weight` column in the Asset Details file.\n\n\u30b3\u30f3\u30da\u30c6\u30a3\u30b7\u30e7\u30f3\u3067\u306f\u3001\u3042\u306a\u305f\u306e\u4e88\u6e2c\u306f\u3001\u30d4\u30a2\u30bd\u30f3\u76f8\u95a2\u4fc2\u6570\u306e\u52a0\u91cd\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u8a55\u4fa1\u3055\u308c\u307e\u3059\u3002\u52a0\u91cd\u306f\u3001\u8cc7\u7523\u8a73\u7d30\u30d5\u30a1\u30a4\u30eb\u306e Weight \u5217\u3067\u4e0e\u3048\u3089\u308c\u307e\u3059\u3002\n\nIn this tutorial, we will simplify things and use correlation (without weights) for evaluation, and consider only two assets, BTC and ETH.\n\n\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u306f\u3001\u7269\u4e8b\u3092\u5358\u7d14\u5316\u3057\u3066\u3001\u76f8\u95a2\u95a2\u4fc2\uff08\u91cd\u307f\u306a\u3057\uff09\u3092\u8a55\u4fa1\u306b\u4f7f\u7528\u3057\u3001BTC \u3068 ETH \u306e 2 \u3064\u306e\u8cc7\u7523\u306e\u307f\u3092\u691c\u8a0e\u3057\u307e\u3059\u3002","0b628a78":"## Dealing with missing data \/ \u6b20\u640d\u30c7\u30fc\u30bf\u306e\u51e6\u7406\n","20014bcd":"## Data visualisation \/ \u30c7\u30fc\u30bf\u306e\u53ef\u8996\u5316\n\nWe  will start by visualising the Close prices for the two assets we have selected.\n\n\u9078\u629e\u3057\u305f2\u3064\u306e\u6697\u53f7\u8cc7\u7523\u306e\u7d42\u5024\u3092\u53ef\u8996\u5316\u3057\u3066\u307f\u307e\u3059\u3002","9cdfcb3e":"## Prediction targets and evaluation \/ \u4e88\u6e2c\u5bfe\u8c61\u3068\u8a55\u4fa1","cfa606f3":"The assets have quite different history, but we could check if they correlate in recent times.\n\n\u4e21\u6697\u53f7\u8cc7\u7523\u306e\u6b74\u53f2\u306f\u5168\u304f\u7570\u306a\u308a\u307e\u3059\u304c\u3001\u6700\u8fd1\u3067\u306f\u76f8\u95a2\u95a2\u4fc2\u304c\u3042\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002","52560542":"\u53c2\u8003:https:\/\/www.kaggle.com\/junichiromorita\/tutorial-to-the-g-research-crypto-competition-jpn","4664160b":"On shorter intervals we can visually see some potential correlation between both assets, with some simultaneous ups and downs. A better format for analyzing such movements is by calculating asset returns. \n\n\u3082\u3063\u3068\u77ed\u3044\u9593\u9694\u3067\u898b\u308b\u3068\u3001\u4e21\u6697\u53f7\u8cc7\u7523\u306e\u9593\u306b\u306f\u6f5c\u5728\u7684\u306a\u76f8\u95a2\u95a2\u4fc2\u304c\u3042\u308a\u3001\u540c\u6642\u306b\u3044\u304f\u3064\u304b\u306e\u4e0a\u6607\u3068\u4e0b\u964d\u304c\u3042\u308b\u3053\u3068\u304c\u8996\u899a\u7684\u306b\u308f\u304b\u308a\u307e\u3059\u3002\u3053\u306e\u3088\u3046\u306a\u52d5\u304d\u3092\u5206\u6790\u3059\u308b\u306b\u306f\u3001\u8cc7\u7523\u306e\u30ea\u30bf\u30fc\u30f3\u3092\u8a08\u7b97\u3059\u308b\u306e\u304c\u826f\u3044\u3067\u3057\u3087\u3046\u3002","193063a7":"## Evaluate baselines \/ \u30d9\u30fc\u30b9\u30e9\u30a4\u30f3\u306e\u8a55\u4fa1\n\nThe competition performance metric is weighted correlation. However, for now we will use simple correlation to evaluate the two baseline models built.\n\n\u30b3\u30f3\u30da\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u8a55\u4fa1\u6307\u6a19\u306f\u52a0\u91cd\u76f8\u95a2\u3067\u3059\u3002\u3057\u304b\u3057\u3001\u3053\u3053\u3067\u306f\u5358\u7d14\u76f8\u95a2\u3092\u7528\u3044\u3066\u3001\u69cb\u7bc9\u3057\u305f2\u3064\u306e\u30d9\u30fc\u30b9\u30e9\u30a4\u30f3\u30e2\u30c7\u30eb\u3092\u8a55\u4fa1\u3057\u307e\u3059\u3002","41e159b8":"## Data features \/ \u30c7\u30fc\u30bf\u306e\u7279\u5fb4\n\nWe can see the different features included in the dataset. Specifically, the features included per asset are the following:\n\n\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306b\u542b\u307e\u308c\u308b\u69d8\u3005\u306a\u7279\u5fb4\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u5177\u4f53\u7684\u306b\u306f\u3001\u30a2\u30bb\u30c3\u30c8\u3054\u3068\u306b\u542b\u307e\u308c\u3066\u3044\u308b\u7279\u5fb4\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\n*   **timestamp**: All timestamps are returned as second Unix timestamps (the number of seconds elapsed since 1970-01-01 00:00:00.000 UTC). Timestamps in this dataset are multiple of 60, indicating minute-by-minute data. \/ \u3059\u3079\u3066\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306f\u3001\u79d2\u5358\u4f4d\u306eUnix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\uff081970-01-01 00:00:00.000 UTC\u304b\u3089\u306e\u7d4c\u904e\u79d2\u6570\uff09\u3067\u8fd4\u3055\u308c\u307e\u3059\u3002\u3053\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306f60\u306e\u500d\u6570\u3067\u30011\u5206\u3054\u3068\u306e\u30c7\u30fc\u30bf\u3092\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n*   **Asset_ID**: The asset ID corresponding to one of the crytocurrencies (e.g. `Asset_ID = 1` for Bitcoin). The mapping from `Asset_ID` to crypto asset is contained in `asset_details.csv`. \/ \u3044\u305a\u308c\u304b\u306e\u6697\u53f7\u901a\u8ca8\u306b\u5bfe\u5fdc\u3059\u308b\u30a2\u30bb\u30c3\u30c8ID\uff08\u4f8b\uff1aBitcoin\u306e\u5834\u5408\u306f`Asset_ID = 1`\uff09\u3002`Asset_ID`\u304b\u3089\u6697\u53f7\u8cc7\u7523\u3078\u306e\u30de\u30c3\u30d4\u30f3\u30b0\u306f`asset_details.csv`\u306b\u542b\u307e\u308c\u308b\u3002\n*   **Count**: Total number of trades in the time interval (last minute). \/ \u6642\u9593\u9593\u9694\uff08\u6700\u5f8c\u306e1\u5206\uff09\u3067\u306e\u53d6\u5f15\u306e\u7dcf\u6570\u3002\n*   **Open**:\tOpening price of the time interval (in USD). \/ \u6642\u9593\u9593\u9694\u5185\u306e\u59cb\u5024\uff08\u5358\u4f4d\uff1a\u7c73\u30c9\u30eb\uff09\u3002\n*   **High**:\tHighest price reached during time interval (in USD). \/ \u6642\u9593\u9593\u9694\u5185\u306e\u9ad8\u5024\uff08\u5358\u4f4d\uff1a\u7c73\u30c9\u30eb\uff09\u3002\n*   **Low**: Lowest price reached during time interval (in USD). \/ \u6642\u9593\u9593\u9694\u5185\u306e\u5b89\u5024\uff08\u5358\u4f4d\uff1a\u7c73\u30c9\u30eb\uff09\u3002\n*   **Close**:\tClosing price of the time interval (in USD). \/ \u6642\u9593\u9593\u9694\u5185\u306e\u7d42\u5024\uff08\u7c73\u30c9\u30eb\uff09\u3002\n*   **Volume**:\tQuantity of asset bought or sold, displayed in base currency USD. \/ \u8cb7\u3063\u305f\u307e\u305f\u306f\u58f2\u3063\u305f\u8cc7\u7523\u306e\u91cf\u3067\u3001\u57fa\u672c\u901a\u8ca8\u306e\u7c73\u30c9\u30eb\u3067\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n*   **VWAP**: The average price of the asset over the time interval, weighted by volume. VWAP is an aggregated form of trade data. \/ \u53d6\u5f15\u6642\u9593\u4e2d\u306e\u5e73\u5747\u4fa1\u683c\u3092\u53d6\u5f15\u91cf\u3067\u52a0\u91cd\u5e73\u5747\u3057\u305f\u3082\u306e\u3002VWAP\u306f\u53d6\u5f15\u30c7\u30fc\u30bf\u3092\u96c6\u8a08\u3057\u305f\u3082\u306e\u3067\u3059\u3002\n*   **Target**: Residual log-returns for the asset over a 15 minute horizon. \/ 15\u5206\u9593\u306e\u6697\u53f7\u8cc7\u7523\u306e\u6b8b\u4f59\u5bfe\u6570\u30ea\u30bf\u30fc\u30f3\u3002\n\nThe first two columns define the time and asset indexes for this data row. The 6 middle columns are feature columns with the trading data for this asset and minute in time. The last column is prediction target, which we will get to later in more detail.\n\n\u6700\u521d\u306e2\u5217\u306f\u3001\u3053\u306e\u30c7\u30fc\u30bf\u884c\u306e\u6642\u9593\u3068\u8cc7\u7523\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u307e\u3059\u3002\u4e2d\u592e\u306e6\u5217\u306f\u3001\u3053\u306e\u8cc7\u7523\u3068\u6642\u9593\u306e\u5206\u306e\u53d6\u5f15\u30c7\u30fc\u30bf\u3092\u542b\u3080\u7279\u5fb4\u7684\u306a\u5217\u3067\u3059\u3002\u6700\u5f8c\u306e\u5217\u306f\u4e88\u6e2c\u30bf\u30fc\u30b2\u30c3\u30c8\u3067\u3059\u304c\u3001\u3053\u308c\u306b\u3064\u3044\u3066\u306f\u5f8c\u3067\u8a73\u3057\u304f\u8aac\u660e\u3057\u307e\u3059\u3002\n\nWe also view the asset information, including the list of all assets, the `Asset_ID` to asset mapping, and the weight of each asset used to weigh their relative importance in the evaluation metric.\n\n\u307e\u305f\u3001\u3059\u3079\u3066\u306e\u30a2\u30bb\u30c3\u30c8\u306e\u30ea\u30b9\u30c8\u3001\u30a2\u30bb\u30c3\u30c8_ID\u3068\u30a2\u30bb\u30c3\u30c8\u306e\u30de\u30c3\u30d4\u30f3\u30b0\u3001\u8a55\u4fa1\u6307\u6a19\u306b\u304a\u3051\u308b\u76f8\u5bfe\u7684\u306a\u91cd\u8981\u6027\u3092\u8a55\u4fa1\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u308b\u5404\u30a2\u30bb\u30c3\u30c8\u306e\u91cd\u307f\u306a\u3069\u3001\u30a2\u30bb\u30c3\u30c8\u60c5\u5831\u3082\u8868\u793a\u3055\u308c\u307e\u3059\u3002","eddaadb2":"# Preprocessing \/ \u524d\u51e6\u7406","28a849e6":"Let us inspect the data for another important asset, Ethereum.\n\n\u3082\u3046\u4e00\u3064\u306e\u91cd\u8981\u306a\u6697\u53f7\u8cc7\u7523\u3067\u3042\u308bEthereum\u306e\u30c7\u30fc\u30bf\u3092\u8abf\u3079\u3066\u307f\u307e\u3057\u3087\u3046\u3002","bc0b56b2":"## Submission \/ \u63d0\u51fa\u65b9\u6cd5\n\nNote that this is a Code Competition, in which you must submit your notebook to be run against the hidden private data. Your notebook should use the provided python time-series API, which ensures that models do not peek forward in time. To use the API, follow the instructions and template in [Code Competition Detailed API instructions](https:\/\/www.kaggle.com\/sohier\/detailed-api-introduction) and [Basic Submission Template](https:\/\/www.kaggle.com\/sohier\/basic-submission-template).\n\n\u3053\u308c\u306f\u30b3\u30fc\u30c9\u30b3\u30f3\u30da\u30c6\u30a3\u30b7\u30e7\u30f3\u3067\u3042\u308a\u3001\u96a0\u3055\u308c\u305f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30c7\u30fc\u30bf\u306b\u5bfe\u3057\u3066\u5b9f\u884c\u3055\u308c\u308b\u30ce\u30fc\u30c8\u30d6\u30c3\u30af\u3092\u63d0\u51fa\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u30ce\u30fc\u30c8\u30d6\u30c3\u30af\u306f\u3001\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308bpython\u6642\u7cfb\u5217API\u3092\u4f7f\u7528\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u3001\u30e2\u30c7\u30eb\u304c\u6642\u9593\u7684\u306b\u5148\u306b\u9032\u3080\u3053\u3068\u304c\u306a\u3044\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002API\u3092\u4f7f\u7528\u3059\u308b\u306b\u306f\u3001[Code Competition Detailed API instructions](https:\/\/www.kaggle.com\/sohier\/detailed-api-introduction)\u3068[Basic Submission Template](https:\/\/www.kaggle.com\/sohier\/basic-submission-template)\u306e\u6307\u793a\u3068\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u5f93\u3063\u3066\u304f\u3060\u3055\u3044\u3002","a0009e49":"## Preparing the data for building predictive models \/ \u4e88\u6e2c\u30e2\u30c7\u30eb\u69cb\u7bc9\u306e\u305f\u3081\u306e\u30c7\u30fc\u30bf\u306e\u6e96\u5099\n\nAs we will train linear regression parameters, we need to separate training and test sets. To do so, we will compute X and y and split this data into train and test splits. Note that the test split represents a later part of the data, as it is commonly done in time series. \n\n\u7dda\u5f62\u56de\u5e30\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u3059\u308b\u306e\u3067\u3001\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30bb\u30c3\u30c8\u3068\u30c6\u30b9\u30c8\u30bb\u30c3\u30c8\u3092\u5206\u3051\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u306e\u305f\u3081\u306b\u3001X\u3068Y\u3092\u8a08\u7b97\u3057\u3001\u3053\u306e\u30c7\u30fc\u30bf\u3092\u8a13\u7df4\u7528\u3068\u30c6\u30b9\u30c8\u7528\u306b\u5206\u5272\u3057\u307e\u3059\u3002\u6642\u7cfb\u5217\u3067\u3088\u304f\u884c\u308f\u308c\u308b\u3088\u3046\u306b\u3001\u30c6\u30b9\u30c8\u5206\u5272\u306f\u30c7\u30fc\u30bf\u306e\u5f8c\u306e\u90e8\u5206\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002","58332ec8":"## Feature design \/ \u7279\u5fb4\u91cf\u8a2d\u8a08\n\nWe first design a few relevant features to input to our model.\n\n\u307e\u305a\u3001\u30e2\u30c7\u30eb\u306b\u5165\u529b\u3059\u308b\u305f\u3081\u306e\u95a2\u9023\u3059\u308b\u7279\u5fb4\u91cf\u3092\u3044\u304f\u3064\u304b\u8a2d\u8a08\u3057\u307e\u3059\u3002","04d3993f":"# G-Research Crypto forecasting competition \/ G-Research \u6697\u53f7\u901a\u8ca8\u4e88\u6e2c\u30b3\u30f3\u30da\u30c6\u30a3\u30b7\u30e7\u30f3\n\nIn the [G-Research Crypto forecasting competition](link), participants have the challenge to predict  price returns across a bundle of major cryptocurrencies. To facilitate your participation, we have created this tutorial notebook covering some relevant concepts for the crypto forecasting challenge.\n\nG-Research \u6697\u53f7\u901a\u8ca8\u4e88\u6e2c\u30b3\u30f3\u30da\u30c6\u30a3\u30b7\u30e7\u30f3\u3067\u306f\u3001\u53c2\u52a0\u8005\u306f\u4e3b\u8981\u306a\u6697\u53f7\u901a\u8ca8\u7fa4\u306e\u4fa1\u683c\u30ea\u30bf\u30fc\u30f3\u3092\u4e88\u6e2c\u3059\u308b\u3068\u3044\u3046\u8ab2\u984c\u304c\u4e0e\u3048\u308c\u308c\u307e\u3059\u3002\u53c2\u52a0\u3057\u3084\u3059\u3044\u3088\u3046\u306b\u3001\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u30ce\u30fc\u30c8\u3067\u306f\u3001\u6697\u53f7\u901a\u8ca8\u4e88\u6e2c\u30b3\u30f3\u30da\u30c6\u30a3\u30b7\u30e7\u30f3\u306b\u95a2\u9023\u3059\u308b\u30b3\u30f3\u30bb\u30d7\u30c8\u3092\u8aac\u660e\u3057\u3066\u3044\u307e\u3059\u3002\n\nThe notebook presents an introduction to crypto forecasting, describing the structure and elements of the dataset, some relevant statistical properties, as well as building a couple of ML baseline models and providing an example code submission.\n\n\u3053\u306e\u30ce\u30fc\u30c8\u30d6\u30c3\u30af\u3067\u306f\u3001\u6697\u53f7\u901a\u8ca8\u4e88\u6e2c\u306b\u3064\u3044\u3066\u7d39\u4ecb\u3057\u3001\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u69cb\u9020\u3068\u8981\u7d20\u3001\u95a2\u9023\u3059\u308b\u7d71\u8a08\u7684\u7279\u6027\u3092\u8aac\u660e\u3059\u308b\u3068\u3068\u3082\u306b\u3001\u3044\u304f\u3064\u304b\u306e\u6a5f\u68b0\u5b66\u7fd2\u30d9\u30fc\u30b9\u30e9\u30a4\u30f3\u30e2\u30c7\u30eb\u3092\u69cb\u7bc9\u3057\u3001\u30b3\u30fc\u30c9\u6295\u7a3f\u306e\u4f8b\u3092\u793a\u3057\u3066\u3044\u307e\u3059\u3002","e59c4275":"\n## Forecasting returns \/ \u30ea\u30bf\u30fc\u30f3\u306e\u4e88\u6e2c\n\nA fundamental task in financial modeling is predicting how prices will behave in the near future. Using the time-series of historical prices as training data, we want to predict if prices will go up or down, and by how much, namely the asset *returns*.\n\n\u91d1\u878d\u30e2\u30c7\u30ea\u30f3\u30b0\u306e\u57fa\u672c\u7684\u306a\u8ab2\u984c\u306f\u3001\u8fd1\u3044\u5c06\u6765\u306e\u4fa1\u683c\u304c\u3069\u306e\u3088\u3046\u306b\u63a8\u79fb\u3059\u308b\u304b\u3092\u4e88\u6e2c\u3059\u308b\u3053\u3068\u3067\u3059\u3002\u904e\u53bb\u306e\u4fa1\u683c\u306e\u6642\u7cfb\u5217\u3092\u5b66\u7fd2\u30c7\u30fc\u30bf\u3068\u3057\u3066\u3001\u4fa1\u683c\u304c\u4e0a\u304c\u308b\u306e\u304b\u4e0b\u304c\u308b\u306e\u304b\u3001\u3069\u308c\u304f\u3089\u3044\u4e0a\u304c\u308b\u306e\u304b\u3092\u4e88\u6e2c\u3057\u305f\u3044\u3001\u3064\u307e\u308a\u8cc7\u7523\u306e\u30ea\u30bf\u30fc\u30f3\u3092\u4e88\u6e2c\u3057\u305f\u3044\u306e\u3067\u3059\u3002\n\nIn this competition, Kagglers are challenged to build machine learning models to predict the returns of 14 popular cryptocurrencies, in the time scale of minutes to hours. You will have access to millions of rows of minute-by-minute cryptocurrency trading data, with which you'll design your forecasting models for all 14 assets simultaneously. Your predictions will be evaluated by how much they correlate with real market data collected during the three-month evaluation period after the competition has closed. \n\n\u672c\u30b3\u30f3\u30da\u30c6\u30a3\u30b7\u30e7\u30f3\u3067\u306f\u3001\u4eba\u6c17\u306e\u3042\u308b14\u7a2e\u985e\u306e\u6697\u53f7\u901a\u8ca8\u306e\u30ea\u30bf\u30fc\u30f3\u3092\u4e88\u6e2c\u3059\u308b\u6a5f\u68b0\u5b66\u7fd2\u30e2\u30c7\u30eb\u3092\u3001\u6570\u5206\u304b\u3089\u6570\u6642\u9593\u306e\u6642\u9593\u30b9\u30b1\u30fc\u30eb\u3067\u69cb\u7bc9\u3059\u308b\u3053\u3068\u304cKagglers\u306e\u8ab2\u984c\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u6570\u767e\u4e07\u884c\u306e\u5206\u523b\u307f\u306e\u6697\u53f7\u901a\u8ca8\u53d6\u5f15\u30c7\u30fc\u30bf\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3001\u305d\u308c\u3092\u3082\u3068\u306b14\u306e\u8cc7\u7523\u3059\u3079\u3066\u3092\u540c\u6642\u306b\u5bfe\u8c61\u3068\u3057\u305f\u4e88\u6e2c\u30e2\u30c7\u30eb\u3092\u8a2d\u8a08\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u3042\u306a\u305f\u306e\u4e88\u6e2c\u306f\u3001\u30b3\u30f3\u30c6\u30b9\u30c8\u7d42\u4e86\u5f8c\u306e3\u30f6\u6708\u9593\u306e\u8a55\u4fa1\u671f\u9593\u4e2d\u306b\u53ce\u96c6\u3055\u308c\u305f\u5b9f\u969b\u306e\u5e02\u5834\u30c7\u30fc\u30bf\u3068\u3069\u308c\u3060\u3051\u76f8\u95a2\u3057\u3066\u3044\u308b\u304b\u306b\u3088\u3063\u3066\u8a55\u4fa1\u3055\u308c\u307e\u3059\u3002\n\nCryptocurrency returns prediction remains an open and extremely challenging forecasting task. This is a fascinating problem domain for the ML community given the extreme volatility of the assets, the non-stationary nature of the data, the market and meme manipulation, the correlation between assets and the very fast changing market conditions. We hope you find it as fascinating as we do! \n\n\u6697\u53f7\u901a\u8ca8\u306e\u30ea\u30bf\u30fc\u30f3\u4e88\u6e2c\u306f\u3001\u4f9d\u7136\u3068\u3057\u3066\u672a\u89e3\u6c7a\u3067\u3001\u975e\u5e38\u306b\u56f0\u96e3\u306a\u4e88\u6e2c\u8ab2\u984c\u3067\u3059\u3002\u3053\u308c\u306f\u3001\u8cc7\u7523\u306e\u6975\u7aef\u306a\u5909\u52d5\u6027\u3001\u30c7\u30fc\u30bf\u306e\u975e\u5b9a\u5e38\u6027\u3001\u5e02\u5834\u3084\u64cd\u4f5c\u3001\u8cc7\u7523\u9593\u306e\u76f8\u95a2\u6027\u3001\u975e\u5e38\u306b\u901f\u3044\u5e02\u5834\u72b6\u6cc1\u306e\u5909\u5316\u3092\u8003\u3048\u308b\u3068\u3001\u6a5f\u68b0\u5b66\u7fd2\u30b3\u30df\u30e5\u30cb\u30c6\u30a3\u306b\u3068\u3063\u3066\u9b45\u529b\u7684\u306a\u554f\u984c\u9818\u57df\u3067\u3059\u3002\u79c1\u305f\u3061\u3068\u540c\u3058\u3088\u3046\u306b\u3001\u7686\u3055\u3093\u306b\u3082\u9b45\u529b\u7684\u306a\u554f\u984c\u3092\u898b\u3064\u3051\u3066\u3044\u305f\u3060\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002","0c83557d":"# Dataset description \/ \u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u8aac\u660e\n\nNow, let's dive into the data! We start by loading the competition's dataset and inspecting its basic properties. \n\n\u305d\u308c\u3067\u306f\u3001\u30c7\u30fc\u30bf\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u307e\u305a\u306f\u3001\u30b3\u30f3\u30da\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3001\u305d\u306e\u57fa\u672c\u7684\u306a\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002","3da5ea6a":"We can see that each row of the data set has the trading data for an asset, at a given minute timestamp, described in detail below. \n\n\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u5404\u884c\u306b\u306f\u3001\u7279\u5b9a\u306e\u5206\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306b\u304a\u3051\u308b\u8cc7\u7523\u306e\u53d6\u5f15\u30c7\u30fc\u30bf\u304c\u3042\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002","04ddc59a":"# Building your prediction model \/ \u4e88\u6e2c\u30e2\u30c7\u30eb\u306e\u69cb\u7bc9","516842ad":"# **Crypto forecasting tutorial \/ \u6697\u53f7\u901a\u8ca8\u4e88\u6e2c\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb**","53d812d5":"## Load the training set \/ \u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30bb\u30c3\u30c8\u306e\u8aad\u307f\u8fbc\u307f","8f2ea723":"## The Cryptocurrency Market \/ \u6697\u53f7\u901a\u8ca8\u5e02\u5834\u306b\u3064\u3044\u3066\n\nFirst, a quick introduction to the crypto world. Cryptocurrencies have become an extremely popular and volatile market, delivering massive returns (as well as losses) to investors. Thousands of cryptocurrencies have been created with a few major ones that many of you will have heard of including Bitcoin (BTC), Ether (ETH) or Dogecoin (DOGE).\n\n\u307e\u305a\u3001\u6697\u53f7\u901a\u8ca8\u306e\u4e16\u754c\u306b\u3064\u3044\u3066\u7c21\u5358\u306b\u7d39\u4ecb\u3057\u307e\u3059\u3002\u6697\u53f7\u901a\u8ca8\u306f\u975e\u5e38\u306b\u4eba\u6c17\u304c\u9ad8\u304f\u3001\u5909\u52d5\u306e\u6fc0\u3057\u3044\u5e02\u5834\u3068\u306a\u3063\u3066\u304a\u308a\u3001\u6295\u8cc7\u5bb6\u306b\u591a\u984d\u306e\u30ea\u30bf\u30fc\u30f3\uff08\u640d\u5931\u3082\u542b\u3080\uff09\u3092\u3082\u305f\u3089\u3057\u3066\u3044\u307e\u3059\u3002\u4f55\u5343\u3082\u306e\u6697\u53f7\u901a\u8ca8\u304c\u4f5c\u3089\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u4e3b\u306a\u3082\u306e\u3068\u3057\u3066\u306f\u3001\u30d3\u30c3\u30c8\u30b3\u30a4\u30f3\uff08BTC\uff09\u3001\u30a4\u30fc\u30b5\uff08ETH\uff09\u3001\u30c9\u30fc\u30b8\u30b3\u30a4\u30f3\uff08DOGE\uff09\u306a\u3069\u304c\u3042\u308a\u3001\u591a\u304f\u306e\u4eba\u304c\u805e\u3044\u305f\u3053\u3068\u304c\u3042\u308b\u3067\u3057\u3087\u3046\u3002\n\nCryptocurrencies are traded extensively across crypto-exchanges, with an average volume of $41 billion traded daily over the last year, according to CryptoCompare (as of 25th July 2021). \n\n\u6697\u53f7\u901a\u8ca8\u306f\u6697\u53f7\u901a\u8ca8\u53d6\u5f15\u6240\u3067\u5e83\u304f\u53d6\u5f15\u3055\u308c\u3066\u304a\u308a\u3001CryptoCompare\u306b\u3088\u308b\u3068\u3001\u6628\u5e741\u5e74\u9593\u3067\u6bce\u65e5\u5e73\u5747410\u5104\u30c9\u30eb\u306e\u53d6\u5f15\u304c\u884c\u308f\u308c\u3066\u3044\u307e\u3059\uff082021\u5e747\u670825\u65e5\u73fe\u5728\uff09\u3002\n\nChanges in prices between different cryptocurrencies are highly interconnected. For example, Bitcoin has historically been a major driver of price changes across cryptocurrencies but other coins also impact the market.  \n\n\u7570\u306a\u308b\u6697\u53f7\u901a\u8ca8\u9593\u306e\u4fa1\u683c\u306e\u5909\u5316\u306f\u3001\u9ad8\u5ea6\u306b\u76f8\u4e92\u306b\u95a2\u9023\u3057\u3066\u3044\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001\u30d3\u30c3\u30c8\u30b3\u30a4\u30f3\u306f\u6b74\u53f2\u7684\u306b\u6697\u53f7\u901a\u8ca8\u9593\u306e\u4fa1\u683c\u5909\u52d5\u306e\u4e3b\u306a\u8981\u56e0\u3068\u306a\u3063\u3066\u304d\u307e\u3057\u305f\u304c\u3001\u4ed6\u306e\u30b3\u30a4\u30f3\u3082\u5e02\u5834\u306b\u5f71\u97ff\u3092\u4e0e\u3048\u307e\u3059\u3002"}}