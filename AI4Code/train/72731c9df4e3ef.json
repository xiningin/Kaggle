{"cell_type":{"60be72bb":"code","297a92a5":"code","e7511404":"code","3a5f2a61":"code","e3265b89":"code","38df131b":"code","c6a27e7f":"code","b703b210":"code","9163ff69":"code","d7d27dd7":"code","78157d1f":"code","dcf8dcf2":"code","afbb44d8":"code","7d205276":"markdown","b4b33cf7":"markdown","1e879f88":"markdown","052bfc03":"markdown","52df9fec":"markdown"},"source":{"60be72bb":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nfrom datetime import datetime\nimport calendar\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\n","297a92a5":"df=pd.read_excel('..\/input\/flight_schedule.xlsx')\ndf.head()","e7511404":"df.Date=pd.to_datetime(df.Date)\ndf.Time=df.Time.astype(str)\ndf.Time=pd.to_datetime(df.Time)","3a5f2a61":"df['Weekday'] = df.Date.dt.weekday\ndf['Weekday'] = df['Weekday'].apply(lambda x: calendar.day_name[x])\ndf['Time'] = df.Time.dt.hour\ndf.info()","e3265b89":"cats = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']\ncat_dtype = pd.api.types.CategoricalDtype(categories=cats, ordered=True)\ndf['Weekday'] =df['Weekday'].astype(cat_dtype)","38df131b":"weekdays_total=df.groupby('Weekday').size().plot.bar(title='Flights per weekday', figsize=(8,5))\ntotals = []\n\n# find the values and append to list\nfor i in weekdays_total.patches:\n    totals.append(i.get_height())\n\n# set individual bar lables using above list\ntotal = sum(totals)\n\n# set individual bar lables using above list\nfor i in weekdays_total.patches:\n    # get_x pulls left or right; get_height pushes up or down\n     weekdays_total.text(i.get_x()+0.05, i.get_height()+1, \\\n            i.get_height(), fontsize=12,\n                color='black')\nplt.savefig('books_read.png')\n\n","c6a27e7f":"grouped=df.groupby('Route').size().sort_values(ascending=False)\ngraph_grouped=grouped[:15].plot.bar(title='The most popular destinations weekly', figsize=(12,8))\n\nfor i in graph_grouped.patches:\n    totals.append(i.get_height())\n\ntotal = sum(totals)\n\nfor i in graph_grouped.patches:\n     graph_grouped.text(i.get_x()+.05, i.get_height()+1, \\\n            i.get_height(), fontsize=12,\n                color='black')\n","b703b210":"tf=df.loc[df.Weekday.isin(['Monday','Tuesday','Wednesday','Thursday','Friday'])]\nworkdays=tf.groupby(['Time','Weekday']).size().unstack().plot(kind='line',linewidth=3.0, title='Departure time distribution on workdays',\\\n                                                                        figsize=(18,10))\nworkdays\nplt.xticks(np.arange(0,24,step=1))\nplt.ylabel('Flights amount')\nplt.legend()","9163ff69":"kf=df.loc[df.Weekday.isin(['Saturday','Sunday'])]\n\n\nweekends=kf.groupby(['Time','Weekday']).size().unstack().plot(kind='line',linewidth=3.0, title='Departure time distribution on weekends', figsize=(16,6))\nweekends\nplt.xticks(np.arange(0, 24, step=1))\nplt.ylabel('Flights amount')\nplt.show()","d7d27dd7":"df.Type.unique()","78157d1f":"df.Type.value_counts()[:10]","dcf8dcf2":"df['Week'] = df.Date.dt.week","afbb44d8":"plt.figure(figsize=(6,6))\nlabels = 'DH4','CS300','B733','Other','B738','A320'\nlist = ['320N','CNJ750','E35L', 'C17', 'LRJ-60', 'CCJ', 'CL30', 'CRJ2',\\\n 'CNJ-560X', 'BET-200', 734, 752, 744, 'C250', 332, 321, 'M82','GRJ5', 'SU95','CRJ9','AT7',735]\ndf['Type'] = df['Type'].replace(list,'Other')\ntypes=df[df['Week']==26]['Type'].value_counts()\nplt.pie(types,labels=labels,autopct='%1.1f%%', startangle=60)\nplt.axis('equal')\nplt.title('Aircraft types per week', fontsize=20)\nplt.tight_layout()","7d205276":"## Most popular aircraft types","b4b33cf7":"## The TOP-15 destinations weekly","1e879f88":"## Air traffic on workdays","052bfc03":"## Air traffic on weekends","52df9fec":"## Flights per day of week"}}