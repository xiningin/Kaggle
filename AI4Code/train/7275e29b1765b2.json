{"cell_type":{"148f605c":"code","506ca6dc":"code","f1a15499":"code","6e95b603":"code","e96870f3":"code","2606ca38":"code","5ac3a3c5":"code","b422736f":"code","e0dceeb9":"code","03a9fe2e":"code","b62c3a7e":"code","e33d8f66":"code","74d1f327":"code","b73c5355":"code","5b46d401":"code","2d706cec":"code","e812331f":"code","31b2ec3e":"code","9c333a51":"code","89fdb936":"code","b9c51e94":"code","1e380b56":"code","e04c9a30":"code","a3db7fd8":"code","b8ec36de":"code","74aa9fd0":"code","d34c1453":"code","19cd4348":"code","f4516288":"code","afb9d021":"code","b485f7e7":"code","e48e13c1":"code","0a05307d":"code","4688814b":"code","8db99409":"code","1edf88b5":"code","55b1b023":"code","01973481":"code","f32449dc":"code","763b7121":"code","e6d47e09":"code","6e30460b":"code","1e9e3a8d":"code","7b5ddfd0":"code","a4f5d280":"code","f7a7e767":"code","3c6e0e8a":"code","54b279c9":"code","db16bf08":"code","88d3ed00":"code","01cae979":"code","0da4b61d":"code","2f396dbf":"code","bd1b2d49":"code","bad38384":"code","96ead254":"code","ea1f9cba":"code","9dae059c":"code","cb1c70ff":"code","c254860d":"markdown","bfc8982b":"markdown"},"source":{"148f605c":"import pandas as pd\nimport numpy as np\nimport sklearn\nimport seaborn as sns\nimport matplotlib.pyplot as plt","506ca6dc":"df = pd.read_csv(\"..\/input\/lish-moa\/train_features.csv\")\ndf.head(10)","f1a15499":"df.cp_dose.value_counts()","6e95b603":"df.cp_time.value_counts()","e96870f3":"df.cp_time = df.cp_time.apply(lambda x : x\/\/24)","2606ca38":"df.cp_time.value_counts()","5ac3a3c5":"df.rename(columns={'cp_time':'days'}, inplace=True)","b422736f":"df.head()","e0dceeb9":"df.cp_type.value_counts()","03a9fe2e":"g_list=[]\ncols=df.columns\nfor i in cols:\n    if 'g-' in i:\n        g_list.append(i)\nc_list=[]\ncols=df.columns\nfor i in cols:\n    if 'c-' in i:\n        c_list.append(i)","b62c3a7e":"g_list[-1]","e33d8f66":"#i=0\ndef g_sum(x):\n#     global i\n#     i=i+1\n#     print(i)\n    return sum(x)\ndummy = df.loc[:,\"g-0\" : \"g-771\"]\ns=dummy.apply(g_sum,axis=1)","74d1f327":"s=pd.DataFrame(s)\ns.head()","b73c5355":"s.shape","5b46d401":"dummy = df.loc[:,\"c-0\" : \"c-99\"]\ns_c=dummy.apply(g_sum,axis=1)\ns_c=pd.DataFrame(s_c)\ns_c.head()","2d706cec":"s_c.shape,df.shape,s.shape","e812331f":"df= pd.concat([df,s_c,s],axis=1)","31b2ec3e":"df.shape","9c333a51":"df.head()","89fdb936":"df.drop(g_list,axis=1,inplace=True)","b9c51e94":"df.drop(c_list,axis=1,inplace=True)","1e380b56":"df.head()","e04c9a30":"df.columns=['sig_id', 'cp_type', 'days', 'cp_dose', 'c-type', 'g-type']","a3db7fd8":"df.head()","b8ec36de":"plt.figure(figsize=(15,9))\nsns.countplot(df.cp_dose)","74aa9fd0":"plt.figure(figsize=(15,9))\nsns.countplot(df.cp_type,palette=\"inferno\")","d34c1453":"plt.figure(figsize=(15,9))\nsns.countplot(df.days,palette=\"rainbow\")","19cd4348":"from sklearn.preprocessing import LabelEncoder\nlab = LabelEncoder()\ndf.cp_dose=lab.fit_transform(df.cp_dose)\ndf.cp_type=lab.fit_transform(df.cp_type)","f4516288":"corr= df.corr()\ncorr.style.background_gradient(cmap='inferno')","afb9d021":"df_scored =  pd.read_csv(\"..\/input\/lish-moa\/train_targets_scored.csv\")\ndf_not_scored = pd.read_csv(\"..\/input\/lish-moa\/train_targets_nonscored.csv\")","b485f7e7":"df_scored.head()","e48e13c1":"df_not_scored.head()","0a05307d":"df_scored.shape , df_not_scored.shape","4688814b":"sample_sub = pd.read_csv(\"..\/input\/lish-moa\/sample_submission.csv\")\nsample_sub.head()","8db99409":"ab=sample_sub.columns\nfor i in ab:\n    print(\"'{}',\".format(i))","1edf88b5":"df = pd.read_csv(\"..\/input\/lish-moa\/train_features.csv\")\ndf.head(10)","55b1b023":"df.cp_time = df.cp_time.apply(lambda x : x\/\/24)\ndf.cp_dose=lab.fit_transform(df.cp_dose)\ndf.cp_type=lab.fit_transform(df.cp_type)","01973481":"df.head()","f32449dc":"df.drop(\"sig_id\",axis=1,inplace=True)","763b7121":"df.head()","e6d47e09":"df_scored.drop(\"sig_id\",axis=1,inplace =True)","6e30460b":"from sklearn.multioutput import MultiOutputClassifier\nfrom xgboost import XGBClassifier","1e9e3a8d":"model = MultiOutputClassifier(XGBClassifier(tree_method='gpu_hist'))\nmodel.fit(df,df_scored)","7b5ddfd0":"import pickle\n\npkl_path = \".\/Moa.pkl\"\nwith open(pkl_path, \"wb\") as f:\n    pickle.dump(model, f)","a4f5d280":"import pickle\npkl_path = '..\/input\/models\/Moa.pkl'\nwith open(pkl_path, 'rb') as f:\n    model = pickle.load(f)","f7a7e767":"test = pd.read_csv(\"..\/input\/lish-moa\/test_features.csv\")\ntest.head()","3c6e0e8a":"test.cp_time = test.cp_time.apply(lambda x : x\/\/24)\ntest.cp_dose= lab.fit_transform(test.cp_dose)\ntest.cp_type=lab.fit_transform(test.cp_type)","54b279c9":"test.head()","db16bf08":"a=test.sig_id\na.head()","88d3ed00":"x=test.drop(\"sig_id\",axis=1)\nx.head()","01cae979":"pred= model.predict(x)","0da4b61d":"pred=pd.DataFrame(pred)","2f396dbf":"pred.head()","bd1b2d49":"a=pd.concat([a,pred],axis=1)","bad38384":"a.head()","96ead254":"a.shape","ea1f9cba":"a.columns=[\n    'sig_id',\n'5-alpha_reductase_inhibitor',\n'11-beta-hsd1_inhibitor',\n'acat_inhibitor',\n'acetylcholine_receptor_agonist',\n'acetylcholine_receptor_antagonist',\n'acetylcholinesterase_inhibitor',\n'adenosine_receptor_agonist',\n'adenosine_receptor_antagonist',\n'adenylyl_cyclase_activator',\n'adrenergic_receptor_agonist',\n'adrenergic_receptor_antagonist',\n'akt_inhibitor',\n'aldehyde_dehydrogenase_inhibitor',\n'alk_inhibitor',\n'ampk_activator',\n'analgesic',\n'androgen_receptor_agonist',\n'androgen_receptor_antagonist',\n'anesthetic_-_local',\n'angiogenesis_inhibitor',\n'angiotensin_receptor_antagonist',\n'anti-inflammatory',\n'antiarrhythmic',\n'antibiotic',\n'anticonvulsant',\n'antifungal',\n'antihistamine',\n'antimalarial',\n'antioxidant',\n'antiprotozoal',\n'antiviral',\n'apoptosis_stimulant',\n'aromatase_inhibitor',\n'atm_kinase_inhibitor',\n'atp-sensitive_potassium_channel_antagonist',\n'atp_synthase_inhibitor',\n'atpase_inhibitor',\n'atr_kinase_inhibitor',\n'aurora_kinase_inhibitor',\n'autotaxin_inhibitor',\n'bacterial_30s_ribosomal_subunit_inhibitor',\n'bacterial_50s_ribosomal_subunit_inhibitor',\n'bacterial_antifolate',\n'bacterial_cell_wall_synthesis_inhibitor',\n'bacterial_dna_gyrase_inhibitor',\n'bacterial_dna_inhibitor',\n'bacterial_membrane_integrity_inhibitor',\n'bcl_inhibitor',\n'bcr-abl_inhibitor',\n'benzodiazepine_receptor_agonist',\n'beta_amyloid_inhibitor',\n'bromodomain_inhibitor',\n'btk_inhibitor',\n'calcineurin_inhibitor',\n'calcium_channel_blocker',\n'cannabinoid_receptor_agonist',\n'cannabinoid_receptor_antagonist',\n'carbonic_anhydrase_inhibitor',\n'casein_kinase_inhibitor',\n'caspase_activator',\n'catechol_o_methyltransferase_inhibitor',\n'cc_chemokine_receptor_antagonist',\n'cck_receptor_antagonist',\n'cdk_inhibitor',\n'chelating_agent',\n'chk_inhibitor',\n'chloride_channel_blocker',\n'cholesterol_inhibitor',\n'cholinergic_receptor_antagonist',\n'coagulation_factor_inhibitor',\n'corticosteroid_agonist',\n'cyclooxygenase_inhibitor',\n'cytochrome_p450_inhibitor',\n'dihydrofolate_reductase_inhibitor',\n'dipeptidyl_peptidase_inhibitor',\n'diuretic',\n'dna_alkylating_agent',\n'dna_inhibitor',\n'dopamine_receptor_agonist',\n'dopamine_receptor_antagonist',\n'egfr_inhibitor',\n'elastase_inhibitor',\n'erbb2_inhibitor',\n'estrogen_receptor_agonist',\n'estrogen_receptor_antagonist',\n'faah_inhibitor',\n'farnesyltransferase_inhibitor',\n'fatty_acid_receptor_agonist',\n'fgfr_inhibitor',\n'flt3_inhibitor',\n'focal_adhesion_kinase_inhibitor',\n'free_radical_scavenger',\n'fungal_squalene_epoxidase_inhibitor',\n'gaba_receptor_agonist',\n'gaba_receptor_antagonist',\n'gamma_secretase_inhibitor',\n'glucocorticoid_receptor_agonist',\n'glutamate_inhibitor',\n'glutamate_receptor_agonist',\n'glutamate_receptor_antagonist',\n'gonadotropin_receptor_agonist',\n'gsk_inhibitor',\n'hcv_inhibitor',\n'hdac_inhibitor',\n'histamine_receptor_agonist',\n'histamine_receptor_antagonist',\n'histone_lysine_demethylase_inhibitor',\n'histone_lysine_methyltransferase_inhibitor',\n'hiv_inhibitor',\n'hmgcr_inhibitor',\n'hsp_inhibitor',\n'igf-1_inhibitor',\n'ikk_inhibitor',\n'imidazoline_receptor_agonist',\n'immunosuppressant',\n'insulin_secretagogue',\n'insulin_sensitizer',\n'integrin_inhibitor',\n'jak_inhibitor',\n'kit_inhibitor',\n'laxative',\n'leukotriene_inhibitor',\n'leukotriene_receptor_antagonist',\n'lipase_inhibitor',\n'lipoxygenase_inhibitor',\n'lxr_agonist',\n'mdm_inhibitor',\n'mek_inhibitor',\n'membrane_integrity_inhibitor',\n'mineralocorticoid_receptor_antagonist',\n'monoacylglycerol_lipase_inhibitor',\n'monoamine_oxidase_inhibitor',\n'monopolar_spindle_1_kinase_inhibitor',\n'mtor_inhibitor',\n'mucolytic_agent',\n'neuropeptide_receptor_antagonist',\n'nfkb_inhibitor',\n'nicotinic_receptor_agonist',\n'nitric_oxide_donor',\n'nitric_oxide_production_inhibitor',\n'nitric_oxide_synthase_inhibitor',\n'norepinephrine_reuptake_inhibitor',\n'nrf2_activator',\n'opioid_receptor_agonist',\n'opioid_receptor_antagonist',\n'orexin_receptor_antagonist',\n'p38_mapk_inhibitor',\n'p-glycoprotein_inhibitor',\n'parp_inhibitor',\n'pdgfr_inhibitor',\n'pdk_inhibitor',\n'phosphodiesterase_inhibitor',\n'phospholipase_inhibitor',\n'pi3k_inhibitor',\n'pkc_inhibitor',\n'potassium_channel_activator',\n'potassium_channel_antagonist',\n'ppar_receptor_agonist',\n'ppar_receptor_antagonist',\n'progesterone_receptor_agonist',\n'progesterone_receptor_antagonist',\n'prostaglandin_inhibitor',\n'prostanoid_receptor_antagonist',\n'proteasome_inhibitor',\n'protein_kinase_inhibitor',\n'protein_phosphatase_inhibitor',\n'protein_synthesis_inhibitor',\n'protein_tyrosine_kinase_inhibitor',\n'radiopaque_medium',\n'raf_inhibitor',\n'ras_gtpase_inhibitor',\n'retinoid_receptor_agonist',\n'retinoid_receptor_antagonist',\n'rho_associated_kinase_inhibitor',\n'ribonucleoside_reductase_inhibitor',\n'rna_polymerase_inhibitor',\n'serotonin_receptor_agonist',\n'serotonin_receptor_antagonist',\n'serotonin_reuptake_inhibitor',\n'sigma_receptor_agonist',\n'sigma_receptor_antagonist',\n'smoothened_receptor_antagonist',\n'sodium_channel_inhibitor',\n'sphingosine_receptor_agonist',\n'src_inhibitor',\n'steroid',\n'syk_inhibitor',\n'tachykinin_antagonist',\n'tgf-beta_receptor_inhibitor',\n'thrombin_inhibitor',\n'thymidylate_synthase_inhibitor',\n'tlr_agonist',\n'tlr_antagonist',\n'tnf_inhibitor',\n'topoisomerase_inhibitor',\n'transient_receptor_potential_channel_antagonist',\n'tropomyosin_receptor_kinase_inhibitor',\n'trpv_agonist',\n'trpv_antagonist',\n'tubulin_inhibitor',\n'tyrosine_kinase_inhibitor',\n'ubiquitin_specific_protease_inhibitor',\n'vegfr_inhibitor',\n'vitamin_b',\n'vitamin_d_receptor_agonist',\n'wnt_inhibitor'\n]","9dae059c":"a.head()","cb1c70ff":"a.to_csv(\"submission.csv\",index=False)","c254860d":"# ML Task","bfc8982b":"# Analysis"}}