{"cell_type":{"1fe24f4a":"code","0671045d":"code","fc7f252f":"code","d11b6331":"code","bafaf0f7":"code","b5cc24fb":"code","ab2b02d4":"code","d01f2f8f":"code","3ff14cb8":"code","1b0cbc49":"code","1a2a8a9b":"code","b090fae5":"code","1e4346d0":"code","75fb4c22":"code","8e897129":"code","984f8d29":"code","cc6a2721":"code","c8e5dbc8":"code","b66878b0":"code","81b2d8d6":"code","f98d29bc":"code","ef59ea55":"code","60aaccb7":"code","87765d00":"code","f3779abe":"code","fca8a8dc":"code","d49ed1a2":"code","b2d8ccc2":"code","489083a7":"code","b9ce84fe":"markdown","147e7d1c":"markdown","b5a2508c":"markdown","cb8e16f3":"markdown","8e09b6ce":"markdown","592b67d8":"markdown","bdcbd64f":"markdown","205a791c":"markdown","c0cd5e61":"markdown","bafff043":"markdown","807cfc82":"markdown","8b969270":"markdown","137c9770":"markdown"},"source":{"1fe24f4a":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.ensemble import ExtraTreesClassifier\nfrom sklearn.metrics import classification_report,confusion_matrix\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.decomposition import PCA\nfrom sklearn.utils import resample\nimport tensorflow as tf\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Activation, Dropout\nfrom tensorflow.keras.callbacks import EarlyStopping","0671045d":"file_path = '..\/input\/epitope-prediction'\nbcell_df = pd.read_csv(f'{file_path}\/input_bcell.csv')\ncovid_df = pd.read_csv(f'{file_path}\/input_covid.csv')\nsars_df = pd.read_csv(f'{file_path}\/input_sars.csv')","fc7f252f":"bcell_df.head(3)","d11b6331":"covid_df.head(3)","bafaf0f7":"sars_df.head(3)","b5cc24fb":"#training data created\nframes = [bcell_df, sars_df]\nbcell_sars_df = pd.concat(frames, axis=0, ignore_index=True)\nbcell_sars_df.head() ","ab2b02d4":"#checking for null values\nbcell_sars_df.isna().sum()","d01f2f8f":"#shuffling the dataset\nbcell_sars_df = bcell_sars_df.sample(frac=1).reset_index(drop = True)","3ff14cb8":"#Info of the dataset\nbcell_sars_df.info()","1b0cbc49":"#Describe the dataset\nbcell_sars_df.describe()","1a2a8a9b":"#checking the target variable countplot\nsns.set_style('darkgrid')\nsns.countplot(bcell_sars_df['target'])","b090fae5":"idx_train = bcell_sars_df['target'].astype(\"bool\").values\nfig, axes = plt.subplots(2, 3,figsize=(16,8))\nsns.set_style('darkgrid')\naxes = [x for a in axes for x in a]\nfor i,name in enumerate([\"isoelectric_point\", \"aromaticity\", \"hydrophobicity\", \"stability\", \"parker\", \"emini\"]):\n    value = bcell_sars_df[name]\n    sns.distplot(value[~idx_train],ax = axes[i], color='red')\n    sns.distplot(value[idx_train],ax = axes[i], color = 'blue')\n    axes[i].set_xlabel(name,fontsize=12)\n    fig.legend(labels = [\"target 0\",\"target 1\"],loc=\"right\",fontsize=12)","1e4346d0":"#Corelation Matrix\ncorr_matrix = bcell_sars_df[['parent_protein_id', 'protein_seq', 'start_position', 'end_position', \n                             'peptide_seq', 'chou_fasman', 'emini', 'kolaskar_tongaonkar', 'parker', \n                             'isoelectric_point', 'aromaticity', 'hydrophobicity', 'stability', \n                             'target']].corr()","75fb4c22":"mask = np.zeros_like(corr_matrix, dtype=np.bool)\nmask[np.triu_indices_from(mask)]= True","8e897129":"#corr heatmap\nsns.set_style('whitegrid')\nf, ax = plt.subplots(figsize=(11, 15)) \nheatmap = sns.heatmap(corr_matrix, \n                      mask = mask,\n                      square = True,\n                      linewidths = .5,\n                      cmap = 'coolwarm',\n                      cbar_kws = {'shrink': .4, \n                                'ticks' : [-1, -.5, 0, 0.5, 1]},\n                      vmin = -1, \n                      vmax = 1,\n                      annot = False,\n                      annot_kws = {'size': 12})\n#add the column names as labels\nax.set_yticklabels(corr_matrix.columns, rotation = 0)\nax.set_xticklabels(corr_matrix.columns)\nsns.set_style({'xtick.bottom': True}, {'ytick.left': True})","984f8d29":"#calculating feature importance\nX = bcell_sars_df.drop(['target', 'parent_protein_id', 'protein_seq', 'peptide_seq'], axis = 1)\ny = bcell_sars_df['target']\nforest_clf = ExtraTreesClassifier(n_estimators=250, random_state=420)\nforest_clf.fit(X,y)","cc6a2721":"imp_features = forest_clf.feature_importances_\nstd = np.std([tree.feature_importances_ for tree in forest_clf.estimators_], axis = 0)\n \nplt.figure(figsize = (15,8))\nplt.bar(X.columns, std, color = 'red') \nplt.xlabel('Feature Labels') \nplt.ylabel('Feature Importances') \nplt.title('Comparison of different Feature Importances') \nplt.show()","c8e5dbc8":"#train_test split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.20)","b66878b0":"# Feature Scaling\nsc = StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)","81b2d8d6":"model = Sequential()\nmodel.add(Dense(units=128,activation='relu'))\nmodel.add(Dropout(0.3))\n\nmodel.add(Dense(units=64,activation='relu'))\nmodel.add(Dropout(0.2))\n\nmodel.add(Dense(units=32,activation='relu'))\nmodel.add(Dropout(0.2))\n\nmodel.add(Dense(units=16,activation='relu'))\nmodel.add(Dropout(0.2))\n\nmodel.add(Dense(units=1,activation='sigmoid'))\nmodel.compile(loss='binary_crossentropy', optimizer='adam')\n\n#Early stopping\nearly_stop = EarlyStopping(monitor='val_loss', mode='min', verbose=1, patience=25)","f98d29bc":"model.fit(x=X_train, \n          y=y_train, \n          epochs=150,\n          validation_data=(X_test, y_test), verbose=1,\n          callbacks=[early_stop]\n          )","ef59ea55":"model_loss = pd.DataFrame(model.history.history)\nmodel_loss.plot()","60aaccb7":"#predictions\npredictions = model.predict_classes(X_test)","87765d00":"print(classification_report(y_test, predictions, target_names = ['Covid_Negative','Covid_Positive']))","f3779abe":"#confusion matrix\nplt.figure(figsize = (10,10))\ncm = confusion_matrix(y_test,predictions)\nsns.heatmap(cm,cmap= \"Blues\", linecolor = 'black' , linewidth = 1 , annot = True, fmt='' , xticklabels = ['Covid_Negative','Covid_Positive'] , yticklabels = ['Covid_Negative','Covid_Positive'])\nplt.xlabel(\"Predicted\")\nplt.ylabel(\"Actual\")","fca8a8dc":"#Applying PCA\npca = PCA(n_components = 2)\n\nprojected = pca.fit_transform(bcell_sars_df[['isoelectric_point', 'aromaticity', \n                                             'start_position', 'end_position', \n                                             'stability', 'hydrophobicity', \n                                             'emini', 'parker']])\nplt.figure(figsize=(8,8))\nplt.scatter(projected[:, 0], projected[:, 1],\n            c=bcell_sars_df.target, edgecolor='none', alpha=0.5,\n            cmap=plt.cm.get_cmap('coolwarm', 2))\nplt.xlabel('component 1')\nplt.ylabel('component 2')\nplt.colorbar();","d49ed1a2":"#Prediction for Covid dataset\ncovid_df_Pred = covid_df.drop(['parent_protein_id', 'protein_seq', 'peptide_seq'], axis = 1)\n#transform data\ncovid_df_Pred = sc.transform(covid_df_Pred)\npredictions_covid = model.predict_classes(covid_df_Pred)\npredictions_covid","b2d8ccc2":"predictions_covid = pd.DataFrame(predictions_covid, columns = ['Predictions'])\n#predictions_covid.head()\nframes = [covid_df, predictions_covid]\noutput = pd.concat(frames, axis = 1)\noutput.head(5)","489083a7":"output['Predictions'].value_counts() #0's are Covid negative, 1's are Covid positive.","b9ce84fe":"Above graph shows features like isoelectric_point, aromaticity, start_position, end_position, stability and hydrophobicity are more informative as compare to other variables.","147e7d1c":"# Principal Component Analysis","b5a2508c":"# Results","cb8e16f3":"Reading datasets","8e09b6ce":"# Model Building","592b67d8":"# EDA and Visualisations","bdcbd64f":"# Model Evaluation","205a791c":"# Importing libraries","c0cd5e61":"# The End","bafff043":"**To do:**\n * Importing libraries\n * EDA and Visualisations\n * Finding important features using Extra Trees Classifier\n * Model Building\n * Evaluation\n * Principal Component Analysis\n * Results\n","807cfc82":"**B-Cell Epitome: Leveraging Information From Antibody-Antigen Protein Complexes**\n\nB-cells can neutralize pathogenic molecules by targeting them with extreme specificity using receptors secreted or expressed on their surface (antibodies). B-cells form an essential part of the adaptive immune system, as they are capable of providing long-term protection against pathogens and harmful molecules. B-cells inducing antigen-specific immune responses in vivo produce large amounts of antigen-specific antibodies by recognizing the subregions (epitope regions) of antigen proteins. They can inhibit their functioning by binding antibodies to antigen proteins. Predicting of epitope regions is beneficial for the design and development of vaccines aimed to induce antigen-specific antibody production. Below image is of B-cell:\n\n![](https:\/\/s3-us-west-2.amazonaws.com\/courses-images\/wp-content\/uploads\/sites\/1094\/2016\/11\/03172714\/OSC_Microbio_18_04_indact.jpg)","8b969270":"# Introduction","137c9770":"# Finding Important Features"}}