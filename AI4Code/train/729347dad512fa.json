{"cell_type":{"8870adb1":"code","7402a3aa":"code","24053dff":"code","62003f1b":"code","85ed89a9":"code","631d5b28":"code","13d15c23":"code","bbac782d":"code","16d9e11b":"code","2d460902":"code","9fe00229":"code","8aee4385":"code","26c0486a":"code","524ce241":"code","52557198":"code","573e0531":"code","236537c6":"code","1d013f7f":"code","39f2e77d":"code","640c1d85":"code","cdcce833":"code","661cac02":"code","ecd1852f":"code","7e621dd9":"code","6b4d6d7e":"code","afdd407b":"code","a3d97634":"code","e4d2b24d":"code","b3d4d31d":"code","d189cf55":"code","7cbff86f":"code","ec36a007":"code","0a9fefee":"code","dd3b2abc":"code","73262b94":"code","1c090df7":"code","084253a5":"code","b3e144aa":"code","702c3678":"code","e5c8e3fa":"code","08d9b8fa":"code","ecced98e":"code","2b1b04bb":"code","7f069d8f":"code","cb196599":"code","c4292c89":"code","0fae580f":"code","faada255":"code","959f5a91":"code","349bf85a":"code","740b0ca5":"code","e1065c11":"code","60668404":"code","16d2d870":"code","4b4f912b":"code","c7666fd2":"code","4d4c6cc7":"code","fa0a227b":"code","339f5160":"code","5e21fc30":"code","68f04546":"code","c76fc499":"code","4fd7bc79":"code","0b2828a8":"code","c05e551a":"code","d6f8cdc1":"code","9c52037e":"code","c166d993":"code","39a66ed2":"code","44bbe2af":"markdown","dfd2b3f4":"markdown","68c66b85":"markdown","16e01a27":"markdown","ccf11cc9":"markdown","e8fec817":"markdown","34120291":"markdown","5635e808":"markdown","d3321dd2":"markdown","cb00bc8a":"markdown","99fe55cd":"markdown","dbe439e4":"markdown","e2470074":"markdown","ba4552b7":"markdown","039ce798":"markdown","0f30fb1a":"markdown","8eefbd59":"markdown","fe9f8619":"markdown","65f6f949":"markdown","84b2c514":"markdown","5db0e88d":"markdown","057c749b":"markdown","2a823bfe":"markdown","901c9fac":"markdown","7e128e04":"markdown","ff8e48ec":"markdown","f63a9514":"markdown","09d3f924":"markdown","60ab6c34":"markdown","b416bc25":"markdown","4e658580":"markdown","50f2f66b":"markdown","9b96e9cb":"markdown","41bde424":"markdown","1c779843":"markdown","d51c84a3":"markdown","cc9dd047":"markdown","90860491":"markdown","bc50fe63":"markdown"},"source":{"8870adb1":"%matplotlib inline\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy import stats\nfrom ast import literal_eval\nfrom sklearn.feature_extraction.text import TfidfVectorizer, CountVectorizer\nfrom sklearn.metrics.pairwise import linear_kernel, cosine_similarity\nfrom nltk.stem.snowball import SnowballStemmer\nfrom nltk.stem.wordnet import WordNetLemmatizer\nfrom nltk.corpus import wordnet\nfrom surprise import Reader, Dataset, SVD, accuracy\n\nimport warnings; warnings.simplefilter('ignore')","7402a3aa":"md = pd.read_csv('..\/input\/movies_metadata.csv')\nmd.head()","24053dff":"print('\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/ Before \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/ \\n', md['genres'].head(), '\\n\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/ Before \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/')\n\n# dictionary\uc548\uc5d0 \ub2f4\uaca8\uc788\ub294 Genre \uc815\ubcf4\ub97c List \ud615\ud0dc\ub85c \uc138\ud305\n# 1. md['genres'].fillna('[]') : genres \uceec\ub7fc\uc5d0 null \uac12\uc744 '[](\ube48 \ub9ac\uc2a4\ud2b8 \uac12)'\uc73c\ub85c \ucc44\uc6cc\ub123\uc74c\n# 2. apply(literal_eval) : literal_eval\ub97c \uc0ac\uc6a9\ud558\uc5ec String\uc73c\ub85c \ub418\uc5b4\uc788\ub294 \uac12\uc744 List & Dictionary\ub85c \uc0ac\uc6a9\ud560 \uc218 \uc788\uac8c \ubcc0\ud658\n# 3. apply(lambda x: [i['name'] for i in x] if isinstance(x, list) else []) : x\uac00 list\uc778 \uacbd\uc6b0 \uc548\uc5d0 \ub4e4\uc5b4\uc788\ub294 dictionary \uc911 name\uc5d0 \ud574\ub2f9\ud558\ub294 \uac12\uc744 list\uc5d0 \ub2f4\uc74c\nmd['genres'] = md['genres'].fillna('[]').apply(literal_eval).apply(lambda x: [i['name'] for i in x] if isinstance(x, list) else [])\n\nprint('\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/ After \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/ \\n', md['genres'].head(), '\\n\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/ After \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/')","62003f1b":"print('vote ::: \\n', md[['vote_count', 'vote_average']].head())\nvote_counts = md[md['vote_count'].notnull()]['vote_count'].astype('int')\nvote_averages = md[md['vote_average'].notnull()]['vote_average'].astype('int')\nC = vote_averages.mean()\nC","85ed89a9":"# \ucd1d 45460\uac1c\uc758 \uc601\ud654 \uc911 \uc0c1\uc704 5%\ub294 2273\ubc88\uc9f8\nprint(vote_counts.sort_values(ascending=False)[2273:2274])\n\n# quantile\ub294 \ub370\uc774\ud130\ub97c \ud06c\uae30\ub300\ub85c \uc815\ub82c\ud558\uc600\uc744 \ub54c \ubd84\uc704\uc218\ub97c \uad6c\ud558\ub294 \ud568\uc218. quantile(0.95)\ub294 \uc0c1\uc704 5%\uc5d0 \ud574\ub2f9\ud558\ub294 \uac12\uc744 \ucc3e\ub294 \uac83\nm = vote_counts.quantile(0.95)\nm","631d5b28":"print('release_date ::: \\n', md['release_date'].head())\n\n# pd.to_datetime\n# errors : {\u2018ignore\u2019, \u2018raise\u2019, \u2018coerce\u2019}, default \u2018raise\u2019\n# If \u2018raise\u2019, then invalid parsing will raise an exception\n# If \u2018coerce\u2019, then invalid parsing will be set as NaT\n# If \u2018ignore\u2019, then invalid parsing will return the input\n\n# 'release_date'\ub97c split\ud574\uc11c year\ub9cc \ucd94\ucd9c\nmd['year'] = pd.to_datetime(md['release_date'], errors='coerce').apply(lambda x: str(x).split('-')[0] if x != np.nan else np.nan)\n\nprint('year ::: \\n', md['year'].head())","13d15c23":"# \ud3c9\uac00 \uc218\uac00 \uc0c1\uc704 5%\uc778(434\ubcf4\ub2e4 \ud070) \ub370\uc774\ud130 \ucd94\ucd9c\nqualified = md[(md['vote_count'] >= m) & (md['vote_count'].notnull()) & (md['vote_average'].notnull())][['title', 'year', 'vote_count', 'vote_average', 'popularity', 'genres']]\nqualified['vote_count'] = qualified['vote_count'].astype('int')\nqualified['vote_average'] = qualified['vote_average'].astype('int')\nqualified.shape","bbac782d":"def weighted_rating(x):\n    v = x['vote_count']\n    R = x['vote_average']\n    return (v\/(v+m) * R) + (m\/(m+v) * C)","16d9e11b":"qualified['wr'] = qualified.apply(weighted_rating, axis=1)","2d460902":"# Weighted Rating \uc0c1\uc704 250\uac1c\uc758 \uc601\ud654 \nqualified = qualified.sort_values('wr', ascending=False).head(250)","9fe00229":"qualified.head(15)","8aee4385":"# stack() : stack\uc774 (\uc704\uc5d0\uc11c \uc544\ub798\ub85c \uae38\uac8c, \ub192\uac8c) \uc313\ub294 \uac83\uc774\uba74, unstack\uc740 \uc313\uc740 \uac83\uc744 \uc606\uc73c\ub85c \ub298\uc5b4\ub193\ub294\uac83(\uc67c\ucabd\uc5d0\uc11c \uc624\ub978\ucabd\uc73c\ub85c \ub113\uac8c) \ub77c\uace0 \uc5f0\uc0c1\uc774 \ub420 \uac83\n# reset_index() : \uae30\uc874\uc758 \ud589 \uc778\ub371\uc2a4\ub97c \uc81c\uac70\ud558\uace0 \uc778\ub371\uc2a4\ub97c \ub370\uc774\ud130 \uc5f4\ub85c \ucd94\uac00\ns = md.apply(lambda x: pd.Series(x['genres']), axis=1).stack().reset_index(level=1, drop=True)\ns.name = 'genre'\nprint(s.head(10))\n\ngen_md = md.drop('genres', axis=1).join(s)\nprint(gen_md.head(10))","26c0486a":"def build_chart(genre, percentile=0.85):\n    df = gen_md[gen_md['genre'] == genre]\n    vote_counts = df[df['vote_count'].notnull()]['vote_count'].astype('int')\n    vote_averages = df[df['vote_average'].notnull()]['vote_average'].astype('int')\n    C = vote_averages.mean()\n    m = vote_counts.quantile(percentile)\n    \n    qualified = df[(df['vote_count'] >= m) & (df['vote_count'].notnull()) & (df['vote_average'].notnull())][['title','year','vote_count','vote_average','popularity']]\n    qualified['vote_count'] = qualified['vote_count'].astype('int')\n    qualified['vote_average'] = qualified['vote_average'].astype('int')\n    \n    qualified['wr'] = qualified.apply(lambda x: (x['vote_count']\/(x['vote_count']+m) * x['vote_average']) + (m\/(m+x['vote_count']) * C), axis=1)\n    qualified = qualified.sort_values('wr', ascending=False).head(250)\n    \n    return qualified","524ce241":"build_chart('Romance').head(15)","52557198":"links_small = pd.read_csv('..\/input\/links_small.csv')\nlinks_small = links_small[links_small['tmdbId'].notnull()]['tmdbId'].astype('int')\nlinks_small.head()","573e0531":"# Drop a row by index : 19730, 29503, 33587 \ud589\uc740 \uc774\uc0c1\ud55c \ub370\uc774\ud130\ub4e4(md.iloc[19730], md.iloc[29503], md.iloc[33587])\nmd = md.drop([19730, 29503, 35587])","236537c6":"#Check EDA Notebook for how and why I got these indices.\nmd['id'] = md['id'].astype('int')","1d013f7f":"smd = md[md['id'].isin(links_small)]\nsmd.shape","39f2e77d":"smd = md[md['id'].isin(links_small)]\nsmd.shape","640c1d85":"smd['tagline'] = smd['tagline'].fillna('')\nsmd['description'] = smd['overview'] + smd['tagline']\nsmd['description'] = smd['description'].fillna('')\n\nsmd['description'].head()","cdcce833":"# n-\uadf8\ub7a8:\ub2e8\uc5b4\uc7a5 \uc0dd\uc131\uc5d0 \uc0ac\uc6a9\ud560 \ud1a0\ud070\uc758 \ud06c\uae30\ub97c \uacb0\uc815\ud55c\ub2e4. \ubaa8\ub178\uadf8\ub7a8(1-\uadf8\ub7a8)\uc740 \ud1a0\ud070 \ud558\ub098\ub9cc \ub2e8\uc5b4\ub85c \uc0ac\uc6a9\ud558\uba70 \ubc14\uc774\uadf8\ub7a8(2-\uadf8\ub7a8)\uc740 \ub450 \uac1c\uc758 \uc5f0\uacb0\ub41c \ud1a0\ud070\uc744 \ud558\ub098\uc758 \ub2e8\uc5b4\ub85c \uc0ac\uc6a9\ud55c\ub2e4.\n# Stop Words:\ubb38\uc11c\uc5d0\uc11c \ub2e8\uc5b4\uc7a5\uc744 \uc0dd\uc131\ud560 \ub54c \ubb34\uc2dc\ud560 \uc218 \uc788\ub294 \ub2e8\uc5b4\ub97c \ub9d0\ud55c\ub2e4. \ubcf4\ud1b5 \uc601\uc5b4\uc758 \uad00\uc0ac\ub098 \uc811\uc18d\uc0ac, \ud55c\uad6d\uc5b4\uc758 \uc870\uc0ac \ub4f1\uc774 \uc5ec\uae30\uc5d0 \ud574\ub2f9\ud55c\ub2e4. stop_words \uc778\uc218\ub85c \uc870\uc808\ud560 \uc218 \uc788\ub2e4.\ntf = TfidfVectorizer(analyzer='word', ngram_range=(1, 2), min_df=0, stop_words='english')\ntfidf_matrix = tf.fit_transform(smd['description'])","661cac02":"print(tfidf_matrix[10])","ecd1852f":"tfidf_matrix.shape","7e621dd9":"# linear_kernel\ub294 \ub450 \ubca1\ud130\uc758 dot product \uc774\ub2e4.\ncosine_sim = linear_kernel(tfidf_matrix, tfidf_matrix)","6b4d6d7e":"cosine_sim[0]","afdd407b":"smd = smd.reset_index()\ntitles = smd['title']\nindices = pd.Series(smd.index, index=smd['title'])\n\nprint(titles.head(), indices.head())","a3d97634":"def get_recommendations(title):\n    idx = indices[title]\n    sim_scores = list(enumerate(cosine_sim[idx]))\n    sim_scores = sorted(sim_scores, key=lambda x: x[1], reverse=True)\n    sim_scores = sim_scores[1:31]\n    movie_indices = [i[0] for i in sim_scores]\n    return titles.iloc[movie_indices]","e4d2b24d":"get_recommendations('The Godfather').head(10)","b3d4d31d":"# The Dark Knight\nget_recommendations('Inception').head(10)","d189cf55":"credits = pd.read_csv('..\/input\/credits.csv')\nkeywords = pd.read_csv('..\/input\/keywords.csv')","7cbff86f":"credits['crew'][0]","ec36a007":"keywords['id'] = keywords['id'].astype('int')\ncredits['id'] = credits['id'].astype('int')\nmd['id'] = md['id'].astype('int')","0a9fefee":"md.shape","dd3b2abc":"md = md.merge(credits, on='id')\nmd = md.merge(keywords, on='id')","73262b94":"smd = md[md['id'].isin(links_small)]\nsmd.shape","1c090df7":"smd['cast'] = smd['cast'].apply(literal_eval)\nsmd['crew'] = smd['crew'].apply(literal_eval)\nsmd['keywords'] = smd['keywords'].apply(literal_eval)\nsmd['cast_size'] = smd['cast'].apply(lambda x: len(x))\nsmd['crew_size'] = smd['crew'].apply(lambda x: len(x))","084253a5":"def get_director(x):\n    for i in x:\n        if i['job'] == 'Director':\n            return i['name']\n    return np.nan","b3e144aa":"smd['director'] = smd['crew'].apply(get_director)","702c3678":"# \ucd9c\uc5f0\uc9c4 \uc911 \uc0c1\uc704\uc5d0 \ub178\ucd9c\ub418\ub294 3\uba85\ub9cc \ucd94\ucd9c\nsmd['cast'] = smd['cast'].apply(lambda x: [i['name'] for i in x] if isinstance(x, list) else [])\nsmd['cast'] = smd['cast'].apply(lambda x: x[:3] if len(x) >= 3 else x)","e5c8e3fa":"smd['keywords'] = smd['keywords'].apply(lambda x: [i['name'] for i in x] if isinstance(x, list) else [])","08d9b8fa":"# \ucd9c\uc5f0\uc9c4\uc758 \uc774\ub984\uc5d0\uc11c \uacf5\ubc31 \uc0ad\uc81c\nsmd['cast'] = smd['cast'].apply(lambda x: [str.lower(i.replace(\" \", \"\")) for i in x])","ecced98e":"# \uac10\ub3c5\uc758 \uc774\ub984\uc5d0\uc11c \uacf5\ubc31 \uc0ad\uc81c \ubc0f 3\ubc88 \uc5b8\uae09?\nsmd['director'] = smd['director'].astype('str').apply(lambda x: str.lower(x.replace(\" \", \"\")))\nsmd['director'] = smd['director'].apply(lambda x: [x, x, x])","2b1b04bb":"s = smd.apply(lambda x: pd.Series(x['keywords']), axis=1).stack().reset_index(level=1, drop=True)\ns.name = 'keyword'","7f069d8f":"s = s.value_counts()\ns[:5]","cb196599":"# 2\ubc88 \uc774\uc0c1 \ub4f1\uc7a5\ud55c \ud0a4\uc6cc\ub4dc\ub9cc \ucd94\ucd9c\ns = s[s > 1]","c4292c89":"# \uc5b4\uadfc \ucd94\ucd9c\uc744 \ud1b5\ud574 \ub3d9\uc77c \uc758\ubbf8&\ub2e4\ub978 \ud615\ud0dc\uc758 \ub2e8\uc5b4(dogs&dog, imaging&image \ub4f1)\ub97c \ub3d9\uc77c\ud55c \ub2e8\uc5b4\ub85c \uc778\uc2dd\nstemmer = SnowballStemmer('english')\nprint(\"dogs\uc758 \uc5b4\uadfc : \", stemmer.stem('dogs'))\nprint(\"dog\uc758 \uc5b4\uadfc : \", stemmer.stem('dog'))","0fae580f":"def filter_keywords(x):\n    words = []\n    for i in x:\n        if i in s:\n            words.append(i)\n    return words","faada255":"# \ud0a4\uc6cc\ub4dc\uc758 \uc5b4\uadfc\uc744 \ucc3e\uc544\uc11c \uacf5\ubc31 \uc81c\uac70 \ud6c4 \uc138\ud305\nsmd['keywords'] = smd['keywords'].apply(filter_keywords)\nsmd['keywords'] = smd['keywords'].apply(lambda x: [stemmer.stem(i) for i in x])\nsmd['keywords'] = smd['keywords'].apply(lambda x: [str.lower(i.replace(\" \", \"\")) for i in x])","959f5a91":"smd['soup'] = smd['keywords'] + smd['cast'] + smd['director'] + smd['genres']\nsmd['soup'] = smd['soup'].apply(lambda x: ' '.join(x))","349bf85a":"count = CountVectorizer(analyzer='word', ngram_range=(1,2), min_df=0, stop_words='english')\ncount_matrix = count.fit_transform(smd['soup'])","740b0ca5":"cosine_sim = cosine_similarity(count_matrix, count_matrix)","e1065c11":"smd = smd.reset_index()\ntitles = smd['title']\nindices = pd.Series(smd.index, index=smd['title'])","60668404":"get_recommendations('The Dark Knight').head(10)","16d2d870":"get_recommendations('Mean Girls').head(10)","4b4f912b":"def improved_recommendations(title):\n    print(title)\n    idx = indices[title]\n    print(idx)\n    sim_scores = list(enumerate(cosine_sim[idx]))\n    sim_scores = sorted(sim_scores, key=lambda x: x[1], reverse=True)\n    sim_scores = sim_scores[1:26]\n    movie_indices = [i[0] for i in sim_scores]\n    print(movie_indices)\n\n    movies = smd.iloc[movie_indices][['title','vote_count','vote_average','year']]\n#     print(movies)\n    \n    vote_counts = movies[movies['vote_count'].notnull()]['vote_count'].astype('int')\n    vote_averages = movies[movies['vote_average'].notnull()]['vote_average'].astype('int')\n    C = vote_averages.mean()\n    m = vote_counts.quantile(0.60)\n    qualified = movies[(movies['vote_count'] >= m) & (movies['vote_count'].notnull())]\n#     print(qualified)\n    qualified['vote_count'] = qualified['vote_count'].astype('int')\n    qualified['wr'] = qualified.apply(weighted_rating, axis=1)\n    qualified = qualified.sort_values('wr', ascending=False).head(10)\n    print(qualified)\n    return qualified","c7666fd2":"improved_recommendations('The Dark Knight')","4d4c6cc7":"improved_recommendations('Mean Girls')","fa0a227b":"# surprise \ub77c\uc774\ube0c\ub7ec\ub9ac\uc758 Reader\nreader = Reader()","339f5160":"ratings = pd.read_csv('..\/input\/ratings_small.csv')\nratings.head()","5e21fc30":"data = Dataset.load_from_df(ratings[['userId', 'movieId','rating']], reader)\n# data.split(n_folds=5)\n\ntrainset = data.build_full_trainset()\ntestset = trainset.build_testset()","68f04546":"svd = SVD()\n# evaluate(svd, data, measures=['RMSE', 'MAE'])\n\n####### \uae30\uc874 \ucee4\ub110\ub300\ub85c \uc9c4\ud589\ud558\uba74 \uc624\ub958\ub098\uc11c \uc218\uc815 #######\nsvd.fit(trainset)\npredictions = svd.test(testset)\naccuracy.rmse(predictions)","c76fc499":"ratings[ratings['userId'] == 1]","4fd7bc79":"svd.predict(1, 302, 3)","0b2828a8":"def convert_int(x):\n    try:\n        return int(x)\n    except:\n        return np.nan","c05e551a":"id_map = pd.read_csv('..\/input\/links_small.csv')[['movieId', 'tmdbId']]\nid_map['tmdbId'] = id_map['tmdbId'].apply(convert_int)\nid_map.columns = ['movieId', 'id']\nid_map = id_map.merge(smd[['title', 'id']], on='id').set_index('title')","d6f8cdc1":"indices_map = id_map.set_index('id')","9c52037e":"def hybrid(userId, title):\n    idx = indices[title]\n    tmdbId = id_map.loc[title]['id']\n    movie_id = id_map.loc[title]['movieId']\n    \n    sim_scores = list(enumerate(cosine_sim[int(idx)]))\n    sim_scores = sorted(sim_scores, key=lambda x: x[1], reverse=True)\n    sim_scores = sim_scores[1:26]\n    movie_indices = [i[0] for i in sim_scores]\n    \n    movies = smd.iloc[movie_indices][['title','vote_count','vote_average','year','id']]\n    movies['est'] = movies['id'].apply(lambda x: svd.predict(userId, indices_map.loc[x]['movieId']).est)\n    movies = movies.sort_values('est', ascending=False)\n    return movies.head(10)","c166d993":"hybrid(1, 'Avatar')","39a66ed2":"hybrid(500, 'Avatar')","44bbe2af":"### \uba54\ud0c0 \ub370\uc774\ud130 \uae30\ubc18 \ucd94\ucc9c\uc2dc\uc2a4\ud15c(Metadata Based Recommender)\n \n\ud45c\uc900 \uba54\ud0c0 \ub370\uc774\ud130 \uae30\ubc18 \ucf58\ud150\uce20 \ucd94\ucc9c\uc744 \uad6c\ucd95\ud558\ub824\uba74, \ud604\uc7ac \ub370\uc774\ud130 \uc138\ud2b8\ub97c \uc81c\uc791\uc9c4 \ubc0f \ud0a4\uc6cc\ub4dc \ub370\uc774\ud130 \uc138\ud2b8\uc640 \ubcd1\ud569\ud574\uc57c \ud569\ub2c8\ub2e4. \uccab \ub2e8\uacc4\ub85c \uc774 \ub370\uc774\ud130\ub97c \uc900\ube44\ud558\uaca0\uc2b5\ub2c8\ub2e4.\n\nTo build our standard metadata based content recommender, we will need to merge our current dataset with the crew and the keyword datasets. Let us prepare this data as our first step.","dfd2b3f4":"**Top Movies Chart**\ub97c \ub9cc\ub4e4\uae30\uc704\ud574 TMDB Ratings\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4. IMDB\uc758 *weighted rating* \uacf5\uc2dd\uc744 \uc0ac\uc6a9\ud558\uc5ec \ucc28\ud2b8\ub97c \uad6c\uc131\ud569\ub2c8\ub2e4. \uc218\ud559\uc801\uc73c\ub85c\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \ud45c\ud604\ub429\ub2c8\ub2e4.\n\n\/\/ TO-DO : \uc65c \uc218\ud559\uc801\uc73c\ub85c \uc774\ub807\uac8c \uacc4\uc0b0\ud558\ub294\uc9c0?  \nWeighted Rating (WR) = $(\\frac{v}{v + m} . R) + (\\frac{m}{v + m} . C)$\n\n* *v* : \uc601\ud654\uc5d0 \ub300\ud55c \ud3c9\uac00 \uc218\n* *m* : \ucc28\ud2b8\uc5d0 \ud45c\uc2dc\ub418\uc5b4\uc57c \ud558\ub294 \ucd5c\uc18c \ud3c9\uac00 \uc218\n* *R* : \uc601\ud654\uc758 \ud3c9\uc810\n* *C* : \uc804\uccb4 \uc601\ud654\uc5d0 \ub300\ud55c \ud3c9\uade0 \uc810\uc218\n\n\ub2e4\uc74c \ub2e8\uacc4\ub294 \ucc28\ud2b8\uc5d0 \ud45c\uc2dc\ub418\uc5b4\uc57c \ud558\ub294 \ucd5c\uc18c \ud22c\ud45c \uc218 \uc778 *m*\uc5d0 \uc801\uc808\ud55c \uac12\uc744 \uacb0\uc815\ud558\ub294 \uac83\uc785\ub2c8\ub2e4. **95 \ubc88\uc9f8 \ubc31\ubd84\uc704 \uc218**\ub97c \ucef7\uc624\ud504\ub85c \uc0ac\uc6a9\ud569\ub2c8\ub2e4. \ub2e4\uc2dc \ub9d0\ud574\uc11c, \ucc28\ud2b8\uc5d0 \uc601\ud654\uac00 \uc2e4\ub9ac\ub824\uba74 \uc601\ud654\uac00 \ubaa9\ub85d\uc5d0 \uc788\ub294 \uc601\ud654\uc758 \ucd5c\uc18c 95%\ubcf4\ub2e4 \ub354 \ub9ce\uc740 \ud45c\ub97c \uac00\uc838\uc57c\ud569\ub2c8\ub2e4.\n\n\uc774\uc81c \uc804\uccb4 \uc0c1\uc704 250 \ucc28\ud2b8\ub97c \uc791\uc131\ud558\uace0, \ud2b9\uc815 \uc7a5\ub974\uc5d0 \ub300\ud55c \ucc28\ud2b8\ub97c \uc791\uc131\ud558\ub294 \uae30\ub2a5\uc744 \uc815\uc758\ud560 \uac83\uc785\ub2c8\ub2e4.\n\n\nI use the TMDB Ratings to come up with our Top Movies Chart. I will use IMDB's weighted rating formula to construct my chart. Mathematically, it is represented as follows:\n\nWeighted Rating (WR) = $(\\frac{v}{v + m} . R) + (\\frac{m}{v + m} . C)$\nwhere,\n\n* *v* is the number of votes for the movie\n* *m* is the minimum votes required to be listed in the chart\n* *R* is the average rating of the movie\n* *C* is the mean vote across the whole report\n\nThe next step is to determine an appropriate value for m, the minimum votes required to be listed in the chart. We will use 95th percentile as our cutoff. In other words, for a movie to feature in the charts, it must have more votes than at least 95% of the movies in the list.\n\nI will build our overall Top 250 Chart and will define a function to build charts for a particular genre. Let's begin!","68c66b85":"\uc0ac\uc6a9\uc790 5000\uba85\uc744 \uc120\ud0dd\ud558\uace0 \ubd80\uc5ec\ud55c \ud3c9\uc810\uc744 \ud655\uc778\ud574\ubcf4\uaca0\uc2b5\ub2c8\ub2e4.\n\nLet us pick user 5000 and check the ratings s\/he has given.","16e01a27":"# \uc601\ud654 \ucd94\ucc9c \uc2dc\uc2a4\ud15c(Movies Recommender System)","ccf11cc9":"\uc5ec\uc790 \uce5c\uad6c\uac00 \uac00\uc7a5 \uc88b\uc544\ud558\ub294 \uc601\ud654 **Mean Girls**\uc5d0 \ub300\ud55c \ucd94\ucc9c\ub3c4 \ud655\uc778\ud574\ubcf4\uaca0\uc2b5\ub2c8\ub2e4.\n\nLet me also get the recommendations for **Mean Girls**, my girlfriend's favorite movie.","e8fec817":"\uc774 \uc139\uc158\uc5d0\uc11c\ub294 \ucee8\ud150\uce20 \uae30\ubc18 \ubc0f \ud611\uc5c5 \ud544\ud130 \uae30\ubc18 \uc5d4\uc9c4\uc5d0\uc11c \uad6c\ud604 \ud55c \uae30\uc220\uc744 \ud1b5\ud569\ud558\ub294 \uac04\ub2e8\ud55c \ud558\uc774\ube0c\ub9ac\ub4dc \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc744 \uc791\uc131\ud558\ub824\uace0\ud569\ub2c8\ub2e4. \uc791\ub3d9\ud558\ub294 \ubc29\uc2dd\uc740 \uc544\ub798\uc640 \uac19\uc2b5\ub2c8\ub2e4.\n\n* **\uc785\ub825 :** \uc0ac\uc6a9\uc790 ID \ubc0f \uc601\ud654 \uc81c\ubaa9\n* **\ucd9c\ub825 :** \ud2b9\uc815 \uc0ac\uc6a9\uc790\uc758 \uc608\uc0c1 \ub4f1\uae09\uc744 \uae30\uc900\uc73c\ub85c \uc815\ub82c\ub41c \uc720\uc0ac\ud55c \uc601\ud654.\n\nIn this section, I will try to build a simple hybrid recommender that brings together techniques we have implemented in the content based and collaborative filter based engines. This is how it will work:\n\n* **Input :** User ID and the Title of a Movie\n* **Output :** Similar movies sorted on the basis of expected ratings by that particular user.","34120291":"## \ub2e8\uc21c \ucd94\ucc9c \uc2dc\uc2a4\ud15c(Simple Recommender)\n\n\ub2e8\uc21c \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc740(Simple Recommender)\ub294 \uc601\ud654\uc758 \uc778\uae30\uc640 (\ub54c\ub85c\ub294) \uc7a5\ub974\uc5d0 \ub530\ub77c \ubaa8\ub4e0 \uc0ac\uc6a9\uc790\uc5d0\uac8c \uc77c\ubc18\ud654\ub41c \ucd94\ucc9c\uc744 \uc81c\uacf5\ud569\ub2c8\ub2e4. \uc774 \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc758 \uae30\ubcf8 \uc544\uc774\ub514\uc5b4\ub294 \ub354 \ub300\uc911\uc801\uc774\uace0 \ube44\ud3c9\uc801\uc778 \uc601\ud654\ub294 \uc77c\ubc18 \ub300\uc911\uc774 \uc88b\uc544\ud560 \uac00\ub2a5\uc131\uc774 \ub354 \ub192\ub2e4\ub294 \uac83\uc785\ub2c8\ub2e4. \uc774 \ubaa8\ub378\uc740 \uc0ac\uc6a9\uc790\ub97c \uae30\ubc18\uc73c\ub85c \ud55c \uac1c\uc778\ud654\ub41c \ucd94\ucc9c\uc740 \uc81c\uacf5\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.\n\n\uc774 \ubaa8\ub378\uc758 \uad6c\ud604\uc740 \ub9e4\uc6b0 \uac04\ub2e8\ud569\ub2c8\ub2e4. \ud3c9\uc810\uacfc \uc778\uae30\ub3c4\uc5d0 \ub530\ub77c \uc601\ud654\ub97c \uc815\ub82c\ud558\uace0 \ubaa9\ub85d\uc758 \ucd5c\uc0c1\uc704 \uc601\ud654\ub97c \ud45c\uc2dc\ud558\uae30\ub9cc \ud558\uba74 \ub429\ub2c8\ub2e4. \ucd94\uac00\uc801\uc73c\ub85c \uc7a5\ub974\ub97c \ubcc0\uc218\ub85c \uc804\ub2ec\ud558\uc5ec \ud2b9\uc815 \uc7a5\ub974\uc758 \ucd5c\uace0 \uc601\ud654\ub97c \uc5bb\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\n\nThe Simple Recommender offers generalized recommnendations to every user based on movie popularity and (sometimes) genre. The basic idea behind this recommender is that movies that are more popular and more critically acclaimed will have a higher probability of being liked by the average audience. This model does not give personalized recommendations based on the user.\n\nThe implementation of this model is extremely trivial. All we have to do is sort our movies based on ratings and popularity and display the top movies of our list. As an added step, we can pass in a genre argument to get the top movies of a particular genre.","5635e808":"## \uacb0\ub860(Conclusion)\n\n\uc774 \ub178\ud2b8\ubd81\uc5d0\uc11c\ub294 \ub2e4\uc591\ud55c \uc544\uc774\ub514\uc5b4\uc640 \uc54c\uace0\ub9ac\uc998\uc744 \uae30\ubc18\uc73c\ub85c 4 \uac00\uc9c0 \ucd94\ucc9c \uc5d4\uc9c4\uc744 \uad6c\ucd95\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4.\n\n1. **Simple Recommender :** \uc774 \uc2dc\uc2a4\ud15c\uc740 \uc804\uccb4 TMDB \ud22c\ud45c \uc218 \ubc0f \ud22c\ud45c \ud3c9\uade0\uc744 \uc0ac\uc6a9\ud558\uc5ec \uc77c\ubc18\/\ud2b9\uc815 \uc7a5\ub974\uc5d0 \ub300\ud55c \uc778\uae30 \uc601\ud654 \ucc28\ud2b8\ub97c \uc791\uc131\ud588\uc2b5\ub2c8\ub2e4. IMDB \uac00\uc911 \ud3c9\uac00 \uc2dc\uc2a4\ud15c\uc744 \uc0ac\uc6a9\ud558\uc5ec \uc815\ub82c\uc774 \ub9c8\uc9c0\ub9c9\uc73c\ub85c \uc218\ud589\ub41c \ud3c9\uac00\ub97c \uacc4\uc0b0\ud588\uc2b5\ub2c8\ub2e4.\n2. **Content Based Recommender:** \uc6b0\ub9ac\ub294 2\uac1c\uc758 \ucf58\ud150\uce20 \uae30\ubc18 \uc5d4\uc9c4\uc744 \uad6c\ucd95\ud588\uc2b5\ub2c8\ub2e4. \ud558\ub098\ub294 \uc601\ud654 \uac1c\uc694\uc640 \ud0dc\uadf8 \ub77c\uc778\uc744 \uc785\ub825\uc73c\ub85c \uc0ac\uc6a9\ud558\uace0, \ub2e4\ub978 \ud558\ub098\ub294 \ucd9c\uc5f0\uc9c4, \uc81c\uc791\uc9c4, \uc7a5\ub974 \ubc0f \ud0a4\uc6cc\ub4dc\uc640 \uac19\uc740 \uba54\ud0c0 \ub370\uc774\ud130\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc608\uce21\uc744 \uc218\ud589\ud588\uc2b5\ub2c8\ub2e4. \ub610\ud55c \ud22c\ud45c \uc218\uac00 \ub9ce\uace0 \ud3c9\uc810\uc774 \ub192\uc740 \uc601\ud654\ub97c \ub354 \uc120\ud638\ud558\ub3c4\ub85d \uac04\ub2e8\ud55c \ud544\ud130\ub97c \uc0ac\uc6a9\ud588\uc2b5\ub2c8\ub2e4.\n3. **Collaborative Filtering:** \uac15\ub825\ud55c surprise \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c \uc0ac\uc6a9\ud558\uc5ec \ub2e8\uc77c \uac12 \ubd84\ud574(SVD)\ub97c \uae30\ubc18\uc73c\ub85c \ud611\uc5c5 \ud544\ud130\ub97c \uad6c\ucd95\ud588\uc2b5\ub2c8\ub2e4. RMSE\ub294 1\ubcf4\ub2e4 \uc791\uc558\uc73c\uba70 \uc5d4\uc9c4\uc740 \uc8fc\uc5b4\uc9c4 \uc0ac\uc6a9\uc790 \ubc0f \uc601\ud654\uc5d0 \ub300\ud55c \ud3c9\uc810\uc744 \ubd80\uc5ec\ud588\uc2b5\ub2c8\ub2e4.\n4. **Hybrid Engine:** \ucf58\ud150\uce20 \ubc0f \ud611\uc5c5 \ud544\ud130\ub9c1\uc758 \uc544\uc774\ub514\uc5b4\ub97c \ubaa8\uc544 \ud2b9\uc815 \uc0ac\uc6a9\uc790\uc5d0\uac8c \ub0b4\ubd80\uc801\uc73c\ub85c \uacc4\uc0b0\ub41c \uc608\uc0c1 \ud3c9\uac00\ub97c \uae30\ubc18\uc73c\ub85c \ud2b9\uc815 \uc0ac\uc6a9\uc790\uc5d0\uac8c \uc601\ud654 \ucd94\ucc9c\uc744 \uc81c\uacf5\ud558\ub294 \uc5d4\uc9c4\uc744 \uad6c\ucd95\ud588\uc2b5\ub2c8\ub2e4.\n\nPrevious -> [The Story of Film](https:\/\/www.kaggle.com\/rounakbanik\/the-story-of-film\/)\n\nIn this notebook, I have built 4 different recommendation engines based on different ideas and algorithms. They are as follows:\n\n1. **Simple Recommender :** This system used overall TMDB Vote Count and Vote Averages to build Top Movies Charts, in general and for a specific genre. The IMDB Weighted Rating System was used to calculate ratings on which the sorting was finally performed.\n2. **Content Based Recommender :** We built two content based engines; one that took movie overview and taglines as input and the other which took metadata such as cast, crew, genre and keywords to come up with predictions. We also deviced a simple filter to give greater preference to movies with more votes and higher ratings.\n3. **Collaborative Filtering :** We used the powerful Surprise Library to build a collaborative filter based on single value decomposition. The RMSE obtained was less than 1 and the engine gave estimated ratings for a given user and movie.\n4. **Hybrid Engine :** We brought together ideas from content and collaborative filterting to build an engine that gave movie suggestions to a particular user based on the estimated ratings that it had internally calculated for that user.\n\nPrevious -> The Story of Film","d3321dd2":"Top 15 Romance Movies\ub97c \ud45c\uc2dc\ud558\uc5ec \uc2e4\uc81c \uc791\ub3d9 \ubc29\uc2dd\uc744 \uc0b4\ud3b4 \ubcf4\uaca0\uc2b5\ub2c8\ub2e4(\ub85c\ub9e8\uc2a4\ub294 \uac00\uc7a5 \uc778\uae30\uc788\ub294 \uc601\ud654 \uc7a5\ub974 \uc911 \ud558\ub098 \uc784\uc5d0\ub3c4 \ubd88\uad6c\ud558\uace0 Generic Top Chart\uc5d0 \uac70\uc758 \ub4f1\uc7a5\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4).\n\nLet us see our method in action by displaying the Top 15 Romance Movies (Romance almost didn't feature at all in our Generic Top Chart despite being one of the most popular movie genres).\n\n### Top Romance Movies","cb00bc8a":"\uc5ec\uc790 \uce5c\uad6c\uac00 \uac00\uc7a5 \uc88b\uc544\ud558\ub294 \uc601\ud654\uc778 **Mean Girls**\uc640 \uc720\uc0ac\ud55c \uc601\ud654\ub3c4 \ucd94\ucc9c \ubc1b\uc544\ubcf4\uaca0\uc2b5\ub2c8\ub2e4.\n\nLet me also get recommendations for another movie, **Mean Girls** which happens to be my girlfriend's favorite movie.","99fe55cd":"\ubd88\ud589\ud788\ub3c4 **Batman and Robin**\uc740 \uc6b0\ub9ac\uc758 \ucd94\ucc9c \ubaa9\ub85d\uc5d0\uc11c \uc0ac\ub77c\uc9c0\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \uc774\uac83\uc740 \uc544\ub9c8\ub3c4 4\uc810\uc73c\ub85c TMDB\uc5d0\uc11c \ud3c9\uade0\ubcf4\ub2e4 \uc57d\uac04 \ub0ae\uae30 \ub54c\ubb38\uc77c \uc218 \uc788\uc2b5\ub2c8\ub2e4. **The Dark Knight Rises**\uc640 \uac19\uc740 \ub180\ub77c\uc6b4 \uc601\ud654\uac00 7\uc810\uc774\ub77c\uba74, \uadf8 \uc601\ud654\ub294 4\ub97c \ubc1b\uc744 \uc790\uaca9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. \uadf8\ub7ec\ub098 \uc6b0\ub9ac\uac00 \ud560 \uc218 \uc788\ub294 \uc77c\uc740 \ub9ce\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \ub530\ub77c\uc11c \uc5ec\uae30\uc11c Content Based Recommender \uc139\uc158\uc744 \ub9c8\uce58\uace0 \ud558\uc774\ube0c\ub9ac\ub4dc \uc5d4\uc9c4\uc744 \ub9cc\ub4e4 \ub54c \ub2e4\uc2dc \ub3cc\uc544\uc62c \uac83\uc785\ub2c8\ub2e4.\n\nUnfortunately, **Batman and Robin** does not disappear from our recommendation list. This is probably due to the fact that it is rated a 4, which is only slightly below average on TMDB. It certainly doesn't deserve a 4 when amazing movies like **The Dark Knight Rises** has only a 7. However, there is nothing much we can do about this. Therefore, we will conclude our Content Based Recommender section here and come back to it when we build a hybrid engine.","dbe439e4":"ID\uac00 302\uc778 \uc601\ud654\uc758 \uacbd\uc6b0 **2.501**\uc73c\ub85c \ucd94\uc815\ub429\ub2c8\ub2e4. \uc774 \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc758 \ub180\ub77c\uc6b4 \uae30\ub2a5 \uc911 \ud558\ub098\ub294 \uc601\ud654\uac00 \ubb34\uc5c7\uc778\uc9c0(\ub610\ub294 \ubb34\uc5c7\uc774 \ud3ec\ud568\ub418\uc5b4 \uc788\ub294\uc9c0) \uc0c1\uad00\ud558\uc9c0 \uc54a\ub294\ub2e4\ub294 \uac83\uc785\ub2c8\ub2e4. \uc21c\uc804\ud788 \uc9c0\uc815\ub41c \uc601\ud654 ID\ub97c \uae30\uc900\uc73c\ub85c \uc791\ub3d9\ud558\uba70 \ub2e4\ub978 \uc0ac\uc6a9\uc790\uac00 \uc601\ud654\ub97c \uc5b4\ub5bb\uac8c \uc608\uce21\ud588\ub294\uc9c0\uc5d0 \ub530\ub77c \ub4f1\uae09\uc744 \uc608\uce21 \ud558\ub824\uace0 \ud569\ub2c8\ub2e4.\n\nFor movie with ID 302, we get an estimated prediction of 2.686. One startling feature of this recommender system is that it doesn't care what the movie is (or what it contains). It works purely on the basis of an assigned movie ID and tries to predict ratings based on how the other users have predicted the movie.","e2470074":"## \ucf58\ud150\uce20 \uae30\ubc18 \ucd94\ucc9c(Content Based Recommender)\n\n\uc774\uc804 \uc139\uc158\uc5d0\uc11c \uad6c\ucd95\ud55c \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc5d0\ub294 \uba87 \uac00\uc9c0 \uc2ec\uac01\ud55c \uc81c\ud55c \uc0ac\ud56d\uc774 \uc788\uc2b5\ub2c8\ub2e4. \uc6b0\uc120 \uc0ac\uc6a9\uc790\uc758 \ucde8\ud5a5\uc5d0 \uad00\uacc4\uc5c6\uc774 \ubaa8\ub4e0 \uc0ac\ub78c\uc5d0\uac8c \ub3d9\uc77c\ud55c \uc601\ud654\ub97c \ucd94\ucc9c\ud569\ub2c8\ub2e4. \ub85c\ub9e8\uc2a4 \uc601\ud654\ub97c \uc88b\uc544\ud558\uace0 \uc561\uc158\uc744 \uc2eb\uc5b4\ud558\ub294 \uc0ac\ub78c\uc774 \uc6b0\ub9ac\uc758 Top 15 \ucc28\ud2b8\ub97c \ubcf8\ub2e4\uba74 \uc544\ub9c8\ub3c4 \ub300\ubd80\ubd84\uc758 \uc601\ud654\ub97c \uc88b\uc544\ud558\uc9c0 \uc54a\uc744 \uac83\uc785\ub2c8\ub2e4. \ud55c \ub2e8\uacc4 \ub354 \ub098\uc544\uac00 \uc7a5\ub974\ubcc4\ub85c \ucc28\ud2b8\ub97c \uc0b4\ud3b4\ubcf4\ub354\ub77c\ub3c4 \uc5ec\uc804\ud788 \uc801\uc808\ud55c \ucd94\ucc9c\uc744 \ubc1b\uc9c0 \ubabb\ud560 \uac83\uc785\ub2c8\ub2e4.\n\n\uc608\ub97c \ub4e4\uc5b4, *Dilwale Dulhania Le Jayenge*, *My Name is Khan*, *Kabhi Khushi Kabhi Gham*\uc744 \uc88b\uc544\ud558\ub294 \uc0ac\ub78c\uc744 \uc0dd\uac01\ud574 \ubcf4\uc2ed\uc2dc\uc624. \uc6b0\ub9ac\uac00 \uc5bb\uc744 \uc218\uc788\ub294 \ud55c \uac00\uc9c0 \ucd94\ub860\uc740 \uadf8 \uc0ac\ub78c\uc774 \ubc30\uc6b0 Shahrukh Khan\uacfc \uac10\ub3c5 Karan Johar\ub97c \uc88b\uc544\ud55c\ub2e4\ub294 \uac83\uc785\ub2c8\ub2e4. \ub85c\ub9e8\uc2a4 \ucc28\ud2b8\ub97c \ubcf4\ub354\ub77c\ub3c4 \uadf8 \uc601\ud654\ub4e4\uc744 \uc0c1\uc704\uad8c\uc5d0\uc11c \ucc3e\uc9c0 \ubabb\ud560 \uac83\uc785\ub2c8\ub2e4.\n\n\ucd94\ucc9c\uc744 \ub354 \uac1c\uc778\ud654\ud558\uae30 \uc704\ud574 \ud2b9\uc815 \uce21\uc815 \ud56d\ubaa9\uc744 \uae30\ubc18\uc73c\ub85c \uc601\ud654 \uac04 \uc720\uc0ac\uc131\uc744 \uacc4\uc0b0\ud558\uace0 \uc0ac\uc6a9\uc790\uac00 \uc88b\uc544\ud558\ub294 \ud2b9\uc815 \uc601\ud654\uc640 \uac00\uc7a5 \uc720\uc0ac\ud55c \uc601\ud654\ub97c \uc81c\uc548\ud558\ub294 \uc5d4\uc9c4\uc744 \uad6c\ucd95\ud558\ub824\uace0 \ud569\ub2c8\ub2e4. \uc601\ud654 \uba54\ud0c0 \ub370\uc774\ud130 (\ub610\ub294 \ucee8\ud150\uce20)\ub97c \uc0ac\uc6a9\ud558\uc5ec\uc774 \uc5d4\uc9c4\uc744 \ube4c\ub4dc\ud558\ubbc0\ub85c **\"\ucf58\ud150\uce20 \uae30\ubc18 \ud544\ud130\ub9c1\"** \uc774\ub77c\uace0\ub3c4\ud569\ub2c8\ub2e4.\n\n\ub2e4\uc74c\uc744 \uae30\ubc18\uc73c\ub85c \ub450 \uac00\uc9c0 \ucf58\ud150\uce20 \uae30\ubc18 \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc744 \uad6c\ucd95\ud569\ub2c8\ub2e4.\n* \uc601\ud654 \uac1c\uc694 \ubc0f \ud0dc\uadf8 \ub77c\uc778\n* \uc601\ud654 \ucd9c\uc5f0\uc9c4, \uc81c\uc791\uc9c4, \ud0a4\uc6cc\ub4dc \ubc0f \uc7a5\ub974\n\n\ub610\ud55c \uc18c\uac1c\uc5d0\uc11c \uc5b8\uae09\ud588\ub4ef\uc774 \uc0ac\uc6a9\uac00\ub2a5\ud55c \ucef4\ud4e8\ud305 \uc131\ub2a5\uc774 \uc81c\ud55c\ub418\uc5b4 \uc788\uae30 \ub54c\ubb38\uc5d0, \uc791\uc740 \ub370\uc774\ud130 \uc14b\uc744 \uc0ac\uc6a9\ud560 \uac83\uc785\ub2c8\ub2e4.\n\nThe recommender we built in the previous section suffers some severe limitations. For one, it gives the same recommendation to everyone, regardless of the user's personal taste. If a person who loves romantic movies (and hates action) were to look at our Top 15 Chart, s\/he wouldn't probably like most of the movies. If s\/he were to go one step further and look at our charts by genre, s\/he wouldn't still be getting the best recommendations.\n\nFor instance, consider a person who loves *Dilwale Dulhania Le Jayenge*, *My Name is Khan* and *Kabhi Khushi Kabhi Gham*. One inference we can obtain is that the person loves the actor Shahrukh Khan and the director Karan Johar. Even if s\/he were to access the romance chart, s\/he wouldn't find these as the top recommendations.\n\nTo personalise our recommendations more, I am going to build an engine that computes similarity between movies based on certain metrics and suggests movies that are most similar to a particular movie that a user liked. Since we will be using movie metadata (or content) to build this engine, this also known as **Content Based Filtering**.\n\nI will build two Content Based Recommenders based on:\n\n* Movie Overviews and Taglines\n* Movie Cast, Crew, Keywords and Genre\n\nAlso, as mentioned in the introduction, I will be using a subset of all the movies available to us due to limiting computing power available to me.","ba4552b7":"#### \ud0a4\uc6cc\ub4dc(Keywords)\n\n\ud0a4\uc6cc\ub4dc\ub97c \uc0ac\uc6a9\ud558\uae30 \uc804\uc5d0 \uc57d\uac04\uc758 \uc0ac\uc804 \ucc98\ub9ac\ub97c \uc218\ud589\ud569\ub2c8\ub2e4. \uccab \ub2e8\uacc4\ub85c \ub370\uc774\ud130 \uc138\ud2b8\uc5d0 \ub098\ud0c0\ub098\ub294 \ubaa8\ub4e0 \ud0a4\uc6cc\ub4dc\uc758 \ube48\ub3c4 \uc218\ub97c \uacc4\uc0b0\ud569\ub2c8\ub2e4.\n\nWe will do a small amount of pre-processing of our keywords before putting them to any use. As a first step, we calculate the frequenct counts of every keyword that appears in the dataset.","039ce798":"\ucc28\ud2b8\uc5d0 \uc624\ub97c \uc218 \uc788\ub294 \uc790\uaca9\uc744 \uac16\ucd94\ub824\uba74 \uc601\ud654\uac00 TMDB\uc5d0\uc11c \ucd5c\uc18c **434 \uac1c \uc774\uc0c1\uc758 \ud3c9\uac00**\ub97c \ubc1b\uc544\uc57c\ud569\ub2c8\ub2e4. \ub610\ud55c TMDB\uc5d0\uc11c \uc601\ud654\uc758 \ud3c9\uade0 \ud3c9\uc810\uc740 10\uc810 \ub9cc\uc810\uc5d0 **5.244**\uc785\ub2c8\ub2e4. **2274**\ud3b8\uc758 \uc601\ud654\uac00 \uc6b0\ub9ac \ucc28\ud2b8\uc5d0 \uc62c\ub790\uc2b5\ub2c8\ub2e4.\n\nTherefore, to qualify to be considered for the chart, a movie has to have at least 434 votes on TMDB. We also see that the average rating for a movie on TMDB is 5.244 on a scale of 10. 2274 Movies qualify to be on our chart.","0f30fb1a":"\ud06c\ub9ac\uc2a4\ud1a0\ud37c \ub180\ub780\uc758 \uc601\ud654, **\uc778\uc149\uc158**, **\ub2e4\ud06c \ub098\uc774\ud2b8** \ubc0f **\uc778\ud130\uc2a4\ud154\ub77c**\uac00 \ucc28\ud2b8\uc758 \ub9e8 \uc704\uc5d0 \ub098\ud0c0\ub0a9\ub2c8\ub2e4. \uc774 \ucc28\ud2b8\ub294 \ud2b9\uc815 \uc7a5\ub974 \ubc0f \uac10\ub3c5\uc5d0 \ub300\ud55c TMDB \uc0ac\uc6a9\uc790\uc758 \uac15\ud55c \ud3b8\ud5a5(bias)\uc744 \ub098\ud0c0\ub0c5\ub2c8\ub2e4.\n\n\uc774\uc81c \ud2b9\uc815 \uc7a5\ub974\uc5d0 \ub300\ud574 \ucc28\ud2b8\ub97c \uc791\uc131\ud558\ub294 \ud568\uc218\ub97c \uc815\uc758\ud558\uaca0\uc2b5\ub2c8\ub2e4. \uc774\ub97c \uc704\ud574, \uae30\ubcf8 \uc870\uac74\uc744 95 \ub300\uc2e0 **85**\ubc88\uc9f8 \ubc31\ubd84\uc704 \uc218\ub85c \uc644\ud654\ud569\ub2c8\ub2e4.\n\nWe see that three Christopher Nolan Films, Inception, The Dark Knight and Interstellar occur at the very top of our chart. The chart also indicates a strong bias of TMDB Users towards particular genres and directors.\n\nLet us now construct our function that builds charts for particular genres. For this, we will use relax our default conditions to the 85th percentile instead of 95.","8eefbd59":"\uc774 \ucee4\ub110\uc740 \ud559\uc2b5\uc6a9\uc73c\ub85c \uc544\ub798 \ucee4\ub110\uc744 \ud544\uc0ac\/\ubc88\uc5ed\ud55c \ub0b4\uc6a9\uc785\ub2c8\ub2e4. [\uc6d0\ubcf8 \ucee4\ub110 \uc5f0\uacb0](https:\/\/www.kaggle.com\/rounakbanik\/movie-recommender-systems\/)","fe9f8619":"\uc774\ubc88\uc5d0 \uc5bb\uc740 \uacb0\uacfc\ub294 \ud6e8\uc52c \ub354 \ub9cc\uc871\uc2a4\ub7fd\uc2b5\ub2c8\ub2e4. \uc774 \ucd94\ucc9c\uc740 \ud06c\ub9ac\uc2a4\ud1a0\ud37c \ub180\ub780 \uac10\ub3c4\uc758 \ub2e4\ub978 \uc601\ud654(\uac10\ub3c5\uc5d0\uac8c \uc8fc\uc5b4\uc9c4 \ud070 \uac00\uc911\uce58\ub85c \uc778\ud574)\ub97c \uc778\uc2dd\ud558\uace0 \ucd5c\uace0\uc758 \ucd94\ucc9c\uc73c\ub85c \ub123\uc740 \uac83 \uac19\uc2b5\ub2c8\ub2e4. \uc800\ub294 **The Dark Knight**\ub97c \uc7ac\ubc0c\uac8c \ubcf4\uc558\ub294\ub370, **Batman Begins**, **The Prestige** \ubc0f **The Dark Knight Rises**\ub97c \ud3ec\ud568\ud574 \ucd94\ucc9c \ub9ac\uc2a4\ud2b8\uc758 \ub2e4\ub978 \uc601\ud654\ub4e4\ub3c4 \uc7ac\ubc0c\uac8c \ubcf4\uc558\uc2b5\ub2c8\ub2e4.\n\n\ubb3c\ub860 feature(\uac10\ub3c5, \ubc30\uc6b0, \uc7a5\ub974)\uc5d0 \ub300\ud574 \ub2e4\ub978 \uac00\uc911\uce58\ub97c \uc2dc\ub3c4\ud558\uace0, soup\uc5d0 \uc0ac\uc6a9\ud560 \uc218\uc788\ub294 \ud0a4\uc6cc\ub4dc \uc218\ub97c \uc81c\ud55c\ud558\uace0, \ube48\ub3c4\ub97c \uae30\uc900\uc73c\ub85c \uc7a5\ub974\uc758 \uac00\uc911\uce58\ub97c \uc870\uc815\ud558\uba70, \ub3d9\uc77c\ud55c \uc5b8\uc5b4\uc758 \uc601\ud654\ub9cc \ud45c\uc2dc\ud558\ub294 \ub4f1, \uc774 \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc744 \uc2e4\ud5d8 \ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\n\nI am much more satisfied with the results I get this time around. The recommendations seem to have recognized other Christopher Nolan movies (due to the high weightage given to director) and put them as top recommendations. I enjoyed watching **The Dark Knight** as well as some of the other ones in the list including **Batman Begins**, **The Prestige** and **The Dark Knight Rises**.\n\nWe can of course experiment on this engine by trying out different weights for our features (directors, actors, genres), limiting the number of keywords that can be used in the soup, weighing genres based on their frequency, only showing movies with the same languages, etc.\n\n","65f6f949":"\uc6b0\ub9ac\uc758 \ud1b5\uacc4\uc5d0 \ub530\ub974\uba74 \ucd5c\uace0\uc758 \ub85c\ub9e8\uc2a4 \uc601\ud654\ub294 Bollywood\uc758 **Dilwale Dulhania Le Jayenge**\uc785\ub2c8\ub2e4. Shahrukh Khan starrer\ub294 \uc81c\uac00 \uac1c\uc778\uc801\uc73c\ub85c \uc88b\uc544\ud558\ub294 \ubc30\uc6b0 \uc911 \ud55c \uba85\uc785\ub2c8\ub2e4.\n\nThe top romance movie according to our metrics is Bollywood's **Dilwale Dulhania Le Jayenge**. This Shahrukh Khan starrer also happens to be one of my personal favorites.","84b2c514":"**The Dark Knight**\uc758 \uacbd\uc6b0 \uc2dc\uc2a4\ud15c\uc5d0\uc11c \ubc30\ud2b8\ub9e8 \uc601\ud654\ub85c \uc2dd\ubcc4 \ud55c \ud6c4 \ub2e4\ub978 \ubc30\ud2b8\ub9e8 \uc601\ud654\ub97c \ucd94\ucc9c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uadf8\ub7ec\ub098 \uc548\ud0c0\uae5d\uac8c\ub3c4, \uc774 \uc2dc\uc2a4\ud15c\uc774 \ud604\uc7ac \ud560 \uc218 \uc788\ub294 \uac83\uc740 \uadf8\uac8c \uc804\ubd80\uc785\ub2c8\ub2e4. \uc774\uac83\uc740 \uc601\ud654\uc758 \ud3c9\uc810\uacfc \uc778\uae30\ub97c \uacb0\uc815\ud558\ub294 \ucd9c\uc5f0\uc9c4, \uc81c\uc791\uc9c4, \uac10\ub3c5 \ubc0f \uc7a5\ub974\uc640 \uac19\uc740 \ub9e4\uc6b0 \uc911\uc694\ud55c \uc0ac\ud56d\uc744 \uace0\ub824\ud558\uc9c0 \uc54a\uae30 \ub54c\ubb38\uc5d0 \ub300\ubd80\ubd84\uc758 \uc0ac\ub78c\ub4e4\uc5d0\uac8c \ubcc4\ub85c \uc720\uc6a9\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. **The Dark Knight**\ub97c \uc88b\uc544\ud558\ub294 \uc0ac\ub78c\uc740 \uc544\ub9c8\ub3c4 \ub180\ub780 \ub54c\ubb38\uc5d0 \ub354 \uc88b\uc544\ud558\uace0 **\ubc30\ud2b8\ub9e8 \ud3ec\uc5d0\ubc84**\uc640 \ubc30\ud2b8\ub9e8 \uc2dc\ub9ac\uc988\uc758 \ub2e4\ub978 \ubaa8\ub4e0 \uc601\ud654\ub97c \uc2eb\uc5b4\ud560 \uac83\uc785\ub2c8\ub2e4.\n\n\ub530\ub77c\uc11c **\uac1c\uc694** \ubc0f **\ud0dc\uadf8**\ubcf4\ub2e4 \ud6e8\uc52c \ub354 \uc554\uc2dc\uc801\uc778 \uba54\ud0c0 \ub370\uc774\ud130\ub97c \uc0ac\uc6a9\ud574\uc57c \ud569\ub2c8\ub2e4. \ub2e4\uc74c \ud558\uc704 \uc139\uc158\uc5d0\uc11c\ub294 **\uc7a5\ub974**, **\ud0a4\uc6cc\ub4dc**, **\ucd9c\uc5f0\uc9c4** \ubc0f **\uc81c\uc791\uc9c4**\uc744 \uace0\ub824\ud558\uc5ec\ubcf4\ub2e4 \uc815\uad50\ud55c \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc744 \uad6c\ud604\ud560 \uac83\uc785\ub2c8\ub2e4.\n\n\nWe see that for **The Dark Knight**, our system is able to identify it as a Batman film and subsequently recommend other Batman films as its top recommendations. But unfortunately, that is all this system can do at the moment. This is not of much use to most people as it doesn't take into considerations very important features such as **cast**, **crew**, **director** and **genre**, which determine the rating and the popularity of a movie. Someone who liked The Dark Knight probably likes it more because of Nolan and would hate **Batman Forever** and every other substandard movie in the Batman Franchise.\n\nTherefore, we are going to use much more suggestive metadata than **Overview** and **Tagline**. In the next subsection, we will build a more sophisticated recommender that takes genre, keywords, cast and crew into consideration.","5db0e88d":"![](http:\/\/labs.criteo.com\/wp-content\/uploads\/2017\/08\/CustomersWhoBought3.jpg)","057c749b":"\uc6b0\ub9ac\ub294 \ubaa8\ub450 \uc900\ube44\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc774\uc81c \uba87 \uac00\uc9c0 \uc601\ud654\uc5d0 \ub300\ud55c \ucd94\ucc9c\uc744 \ubc1b\uace0 \ucd94\ucc9c\uc774 \uc5bc\ub9c8\ub098 \uc88b\uc740\uc9c0 \uc54c\uc544\ubcf4\uaca0\uc2b5\ub2c8\ub2e4.\n\nWe're all set. Let us now try and get the top recommendations for a few movies and see how good the recommendations are.","2a823bfe":"## \ud611\uc5c5 \ud544\ud130\ub9c1(Collaborative Filtering)\n\n\ucf58\ud150\uce20 \uae30\ubc18 \uc5d4\uc9c4\uc5d0\ub294 \uba87 \uac00\uc9c0 \uc2ec\uac01\ud55c \uc81c\ud55c\uc774 \uc788\uc2b5\ub2c8\ub2e4. \ud2b9\uc815 \uc601\ud654\uc640 *\uc720\uc0ac\ud55c* \uc601\ud654 \ub9cc \uc81c\uc548 \ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc989, \ucde8\ud5a5\uc744 \ud3ec\ucc29 \ud560 \uc218 \uc5c6\uc73c\uba70 \uc7a5\ub974 \uc804\uccb4\uc5d0 \ub300\ud55c \uad8c\uc7a5 \uc0ac\ud56d\uc744 \uc81c\uacf5 \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.\n\n\ub610\ud55c \uc6b0\ub9ac\uac00 \ub9cc\ub4e0 \uc5d4\uc9c4\uc740 \uc0ac\uc6a9\uc790\uc758 \uac1c\uc778\uc801\uc778 \ucde8\ud5a5\uacfc \ud3b8\uacac\uc744 \ud3ec\ucc29\ud558\uc9c0 \ubabb\ud55c\ub2e4\ub294 \uc810\uc5d0\uc11c \uc2e4\uc81c\ub85c \uac1c\uc778\uc801\uc774\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \uc601\ud654 \uae30\ubc18\uc758 \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc740 \uc870\ud68c\ud558\ub294 \uc0ac\ub78c\uc774 \ub204\uad6c\uc778\uc9c0\uc5d0 \uad00\uacc4\uc5c6\uc774 \ud574\ub2f9 \uc601\ud654\uc5d0 \ub300\ud574 \ub3d9\uc77c\ud55c \ucd94\ucc9c\uc744 \ud574\uc90d\ub2c8\ub2e4.\n\n\ub530\ub77c\uc11c \uc774 \uc139\uc158\uc5d0\uc11c\ub294 **\ud611\uc5c5 \ud544\ud130\ub9c1**\uc774\ub77c\ub294 \uae30\uc220\uc744 \uc0ac\uc6a9\ud558\uc5ec \uc0ac\uc6a9\uc790\uc5d0\uac8c \ucd94\ucc9c \uc601\ud654\ub97c \uc81c\uc2dc\ud569\ub2c8\ub2e4. Collaborative Filtering\uc740 \ud2b9\uc815 \uc81c\ud488\uc774\ub098 \uc11c\ube44\uc2a4\ub97c \uc0ac\uc6a9\/\uacbd\ud5d8\ud574 \ubcf8 \ub098\uc640 \uc720\uc0ac\ud55c \uc0ac\uc6a9\uc790 \uc815\ubcf4\uac00 \ud574\ub2f9 \uc81c\ud488\uc774\ub098 \uc11c\ube44\uc2a4\ub97c \ub0b4\uac00 \uc5bc\ub9c8\ub098 \uc88b\uc544\ud558\ub294\uc9c0 \uc608\uce21\ud558\ub294 \ub370 \uc0ac\uc6a9\ub420 \uc218 \uc788\ub2e4\ub294 \uc544\uc774\ub514\uc5b4\ub97c \uae30\ubc18\uc73c\ub85c\ud569\ub2c8\ub2e4.\n\n\ucc98\uc74c\ubd80\ud130 \ud611\uc5c5 \ud544\ud130\ub9c1\uc744 \uad6c\ud604\ud558\uc9c0\ub294 \uc54a\uc744 \uac83\uc785\ub2c8\ub2e4. \ub300\uc2e0 **SVD(Singular Value Decomposition)** \uc640 \uac19\uc740 \ub9e4\uc6b0 \uac15\ub825\ud55c \uc54c\uace0\ub9ac\uc998\uc744 \uc0ac\uc6a9\ud558\ub294 **Surprise** \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c \uc0ac\uc6a9\ud558\uc5ec, RMSE(Root Mean Square Error)\ub97c \ucd5c\uc18c\ud654\ud558\uace0 \ucd94\ucc9c\ud560 \uac83\uc785\ub2c8\ub2e4.\n\nOur content based engine suffers from some severe limitations. It is only capable of suggesting movies which are close to a certain movie. That is, it is not capable of capturing tastes and providing recommendations across genres.\n\nAlso, the engine that we built is not really personal in that it doesn't capture the personal tastes and biases of a user. Anyone querying our engine for recommendations based on a movie will receive the same recommendations for that movie, regardless of who s\/he is.\n\nTherefore, in this section, we will use a technique called **Collaborative Filtering** to make recommendations to Movie Watchers. Collaborative Filtering is based on the idea that users similar to a me can be used to predict how much I will like a particular product or service those users have used\/experienced but I have not.\n\nI will not be implementing Collaborative Filtering from scratch. Instead, I will use the **Surprise** library that used extremely powerful algorithms like **Singular Value Decomposition (SVD)** to minimise RMSE (Root Mean Square Error) and give great recommendations.","901c9fac":"\uc601\ud654 \ub370\uc774\ud130 \ubd84\uc11d \ubc0f \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc5d0 \uad00\ud55c Springboard Capstone \ud504\ub85c\uc81d\ud2b8\uc758 \ub450 \ubc88\uc9f8 \ub178\ud2b8\uc785\ub2c8\ub2e4. \uccab \ubc88\uc9f8 \ub178\ud2b8 ([The Story of Film](https:\/\/www.kaggle.com\/rounakbanik\/the-story-of-film\/)) \uc5d0\uc11c\ub294 TMDB\uc5d0\uc11c \uc218\uc9d1\ud55c \uc601\ud654 \uba54\ud0c0 \ub370\uc774\ud130\ub97c \uad11\ubc94\uc704\ud558\uac8c \ubd84\uc11d\ud558\uc5ec, \uc601\ud654\uc758 \ub0b4\uc6a9\uc744 \uc124\uba85\ud558\ub824\uace0 \ud588\uc2b5\ub2c8\ub2e4. \ub610\ud55c \uc601\ud654 \uc218\uc775\uacfc \uc601\ud654 \uc131\uacf5\uc744 \uc608\uce21\ud558\uace0, output(\uc218\uc775\uacfc \uc131\uacf5)\uc5d0 \uc601\ud5a5\uc744 \ubbf8\uce58\ub294 feature\ub97c \uc2dc\uac01\ud654\ud558\uae30 \uc704\ud574 \uc544\uc8fc \uc791\uc740 \uc608\uce21 \ubaa8\ub378 \ub450 \uac1c\ub97c \uad6c\ucd95\ud588\uc2b5\ub2c8\ub2e4.\n\n\uc774 \ub178\ud2b8\ubd81\uc5d0\uc11c\ub294 \uba87 \uac00\uc9c0 \ucd94\ucc9c \uc54c\uace0\ub9ac\uc998(\ucf58\ud150\uce20 \uae30\ubc18, \uc778\uae30\ub3c4 \ubc0f \ud611\uc5c5 \ud544\ud130\ub9c1)\uc744 \uad6c\ud604\ud558\uace0, \ucd5c\uc885 \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc744 \uc644\uc131\ud558\uae30 \uc704\ud574 \uc774\ub7ec\ud55c \ubaa8\ub378\uc758 \uc559\uc0c1\ube14\uc744 \uad6c\ucd95\ud560 \uac83\uc785\ub2c8\ub2e4. \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc744 \uad6c\ucd95\ud558\uae30 \uc704\ud574 \ub450 \uac1c\uc758 MovieLens \ub370\uc774\ud130 \uc138\ud2b8\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.\n\n* **The Full Dataset:** 270,000\uba85\uc758 \uc0ac\uc6a9\uc790\uac00 45,000\uac1c\uc758 \uc601\ud654\uc5d0 \ub0a8\uae34 26,000,000\uac1c\uc758 \ud3c9\uac00\uc640 750,000\uac1c\uc758 \ud0dc\uadf8\ub85c \uad6c\uc131\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4. 1,100\uac1c\uc758 \ud0dc\uadf8\uc5d0\uc11c 1200\ub9cc \uac1c\uc758 \uad00\ub828\uc131 \uc810\uc218\ub97c \uac00\uc9c4 \ud0dc\uadf8 \uac8c\ub188 \ub370\uc774\ud130\ub97c \ud3ec\ud568\ud569\ub2c8\ub2e4.\n* **The Small Dataset:** 700\uba85\uc758 \uc0ac\uc6a9\uc790\uac00 9,000\uac1c\uc758 \uc601\ud654\uc5d0 \uc801\uc6a9\ud55c 100,000\uac1c\uc758 \ub4f1\uae09\uacfc 1,300\uac1c\uc758 \ud0dc\uadf8\ub85c \uad6c\uc131\ub429\ub2c8\ub2e4.\n\nSimple Recommender\ub294 *Full Dataset*\uc758 \uc601\ud654 \ub370\uc774\ud130\ub97c \uc0ac\uc6a9\ud558\uc9c0\ub9cc, \uadf8 \uc678 \ubaa8\ub4e0 \uac1c\uc778\ud654\ub41c \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc740 *Small Dataset*\uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4(\ucef4\ud4e8\ud305 \ub2a5\ub825\uc774 \uc81c\ud55c\ub418\uc5b4 \uc788\uae30 \ub54c\ubb38\uc5d0). \n\n\uccab \ub2e8\uacc4\ub85c Simple Recommender\ub97c \uad6c\ucd95\ud558\ub3c4\ub85d \ud558\uaca0\uc2b5\ub2c8\ub2e4.\n\n\nThis is the second part of my Springboard Capstone Project on Movie Data Analysis and Recommendation Systems. In my first notebook ( The Story of Film ), I attempted at narrating the story of film by performing an extensive exploratory data analysis on Movies Metadata collected from TMDB. I also built two extremely minimalist predictive models to predict movie revenue and movie success and visualise which features influence the output (revenue and success respectively).\n\nIn this notebook, I will attempt at implementing a few recommendation algorithms (content based, popularity based and collaborative filtering) and try to build an ensemble of these models to come up with our final recommendation system. With us, we have two MovieLens datasets.\n\nThe Full Dataset: Consists of 26,000,000 ratings and 750,000 tag applications applied to 45,000 movies by 270,000 users. Includes tag genome data with 12 million relevance scores across 1,100 tags.\nThe Small Dataset: Comprises of 100,000 ratings and 1,300 tag applications applied to 9,000 movies by 700 users.\nI will build a Simple Recommender using movies from the Full Dataset whereas all personalised recommender systems will make use of the small dataset (due to the computing power I possess being very limited). As a first step, I will build my simple recommender system.","7e128e04":"### import \ub77c\uc774\ube0c\ub7ec\ub9ac\n**%matplotlib inline:** notebook\uc744 \uc2e4\ud589\ud55c \ube0c\ub77c\uc6b0\uc800\uc5d0\uc11c \ubc14\ub85c \uadf8\ub9bc\uc744 \ubcfc \uc218 \uc788\uac8c \ud574\uc8fc\ub294 \uac83  \n**seaborn:** Seaborn\uc740 Matplotlib\uc744 \uae30\ubc18\uc73c\ub85c \ub2e4\uc591\ud55c \uc0c9\uc0c1 \ud14c\ub9c8\uc640 \ud1b5\uacc4\uc6a9 \ucc28\ud2b8 \ub4f1\uc758 \uae30\ub2a5\uc744 \ucd94\uac00\ud55c \uc2dc\uac01\ud654 \ud328\ud0a4\uc9c0\uc774\ub2e4. \uae30\ubcf8\uc801\uc778 \uc2dc\uac01\ud654 \uae30\ub2a5\uc740 Matplotlib \ud328\ud0a4\uc9c0\uc5d0 \uc758\uc874\ud558\uba70 \ud1b5\uacc4 \uae30\ub2a5\uc740 Statsmodels \ud328\ud0a4\uc9c0\uc5d0 \uc758\uc874  \n\n**CountVectorizer:** \ubb38\uc11c \uc9d1\ud569\uc5d0\uc11c \ub2e8\uc5b4 \ud1a0\ud070\uc744 \uc0dd\uc131\ud558\uace0 \uac01 \ub2e8\uc5b4\uc758 \uc218\ub97c \uc138\uc5b4 BOW \uc778\ucf54\ub529\ud55c \ubca1\ud130\ub97c \ub9cc\ub4e6  \n**TfidfVectorizer:** CountVectorizer\uc640 \ube44\uc2b7\ud558\uc9c0\ub9cc TF-IDF \ubc29\uc2dd\uc73c\ub85c \ub2e8\uc5b4\uc758 \uac00\uc911\uce58\ub97c \uc870\uc815\ud55c BOW \ubca1\ud130\ub97c \ub9cc\ub4e6  \n\n**literal_eval:** Python literal\uc744 \ub2f4\uace0 \uc788\ub294 String \ud615\ud0dc\uc758 expression\uc744 Python literal \ud615\ud0dc\ub85c \uc0ac\uc6a9\ud560 \uc218 \uc788\uac8c \ud574\uc900\ub2e4(ex. String to Dictionary)\n\n**NLTK(Natural Language Toolkit) :** \ud328\ud0a4\uc9c0\ub294 \uad50\uc721\uc6a9\uc73c\ub85c \uac1c\ubc1c\ub41c \uc790\uc5f0\uc5b4 \ucc98\ub9ac \ubc0f \ubb38\uc11c \ubd84\uc11d\uc6a9 \ud30c\uc774\uc36c \ud328\ud0a4\uc9c0\ub2e4. \ub2e4\uc591\ud55c \uae30\ub2a5 \ubc0f \uc608\uc81c\ub97c \uac00\uc9c0\uace0 \uc788\uc73c\uba70 \uc2e4\ubb34 \ubc0f \uc5f0\uad6c\uc5d0\uc11c\ub3c4 \ub9ce\uc774 \uc0ac\uc6a9\ub41c\ub2e4.\n**SnowballStemmer:** \uc5b4\uadfc \ucd94\ucd9c  \n**WordNetLemmatizer:** \ud45c\uc81c\uc5b4 \ucd94\ucd9c\n\n**surprise:** \ucd94\ucc9c \uc2dc\uc2a4\ud15c \uc54c\uace0\ub9ac\uc998 \uc81c\uacf5 \ud328\ud0a4\uc9c0\n\n","ff8e48ec":"\ud3c9\uade0 **Root Mean Sqaure Error**\ub294 0.6473\uc73c\ub85c,\uc774 \uacbd\uc6b0\uc5d0\ub294 \ucda9\ubd84\ud569\ub2c8\ub2e4. \uc774\uc81c \ub370\uc774\ud130 \uc138\ud2b8\ub97c \ud559\uc2b5\ud558\uace0 \uc608\uce21\ud574\ubcf4\uaca0\uc2b5\ub2c8\ub2e4???\n\nWe get a mean Root Mean Sqaure Error of 0.8963 which is more than good enough for our case. Let us now train on our dataset and arrive at predictions.","f63a9514":"\ud0a4\uc6cc\ub4dc\ub294 1\uc5d0\uc11c 610\uc0ac\uc774\uc758 \ube48\ub3c4\ub85c \ubc1c\uc0dd\ud569\ub2c8\ub2e4. \ub2e8 \ud55c \ubc88\ub9cc \ubc1c\uc0dd\ud55c \ud0a4\uc6cc\ub4dc\ub294 \uc0ac\uc6a9\ud558\uc9c0 \uc54a\uae30 \ub54c\ubb38\uc5d0 \uc548\uc804\ud558\uac8c \uc81c\uac70\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ub9c8\uc9c0\ub9c9\uc73c\ub85c *Dogs* \ubc0f *Dog*\uc640 \uac19\uc740 \ub2e8\uc5b4\uac00 \ub3d9\uc77c\ud55c \uac83\uc73c\ub85c \uac04\uc8fc\ub418\ub3c4\ub85d \ubaa8\ub4e0 \ub2e8\uc5b4\ub97c stem\uc73c\ub85c \ubcc0\ud658\ud569\ub2c8\ub2e4.\n\nKeywords occur in frequencies ranging from 1 to 610. We do not have any use for keywords that occur only once. Therefore, these can be safely removed. Finally, we will convert every word to its stem so that words such as Dogs and Dog are considered the same.","09d3f924":"\uc774\uc81c \ub370\uc774\ud130 \uc138\ud2b8\uc758 \ubaa8\ub4e0 \uc601\ud654\uc5d0 \ub300\ud574 pair \ub2e8\uc704 \ucf54\uc0ac\uc778 \uc720\uc0ac\ub3c4 \ub9e4\ud2b8\ub9ad\uc2a4\ub97c \uac16\uc2b5\ub2c8\ub2e4. \ub2e4\uc74c \ub2e8\uacc4\ub294 \ucf54\uc0ac\uc778 \uc720\uc0ac\ub3c4 \uc810\uc218\ub97c \uae30\ubc18\uc73c\ub85c \uac00\uc7a5 \uc720\uc0ac\ud55c 30\uac1c\uc758 \uc601\ud654\ub97c \ubc18\ud658\ud558\ub294 \ud568\uc218\ub97c \uc791\uc131\ud558\ub294 \uac83\uc785\ub2c8\ub2e4.\n\nWe now have a pairwise cosine similarity matrix for all the movies in our dataset. The next step is to write a function that returns the 30 most similar movies based on the cosine similarity score.","60ab6c34":"## \ud558\uc774\ube0c\ub9ac\ub4dc \ucd94\ucc9c \uc2dc\uc2a4\ud15c(Hybrid Recommender)\n\n![](https:\/\/www.toonpool.com\/user\/250\/files\/hybrid_20095.jpg)","b416bc25":"#### \uc778\uae30\ub3c4\uc640 \ud3c9\uc810(Popularity and Ratings)\n\n\ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc5d0\uc11c \uc8fc\ubaa9\ud560\ub9cc\ud55c \uc810\uc740 \ub4f1\uae09\uacfc \uc778\uae30\ub3c4\uc5d0 \uad00\uacc4\uc5c6\uc774 \uc601\ud654\ub97c \ucd94\ucc9c\ud55c\ub2e4\ub294 \uac83\uc785\ub2c8\ub2e4. **Batman and Robin**\uc740 **The Dark Knight**\uc640 \ube44\uc2b7\ud55c \uce90\ub9ad\ud130\uac00 \ub9ce\uc9c0\ub9cc, \ub204\uad6c\uc5d0\uac8c\ub3c4 \ucd94\ucc9c\ud574\uc11c\ub294 \uc548\ub418\ub294 \ub054\ucc0d\ud55c \uc601\ud654\uc600\uc2b5\ub2c8\ub2e4.\n\n\ub530\ub77c\uc11c \uc6b0\ub9ac\ub294 \ud3c9\uc774 \uc88b\uc9c0 \uc54a\uc740 \ub098\uc05c \uc601\ud654\ub97c \uc81c\uac70\ud558\uace0, \uc778\uae30\uac00 \uc788\ub294 \uc601\ud654\ub97c \ubc18\ud658\ud558\ub294 \uba54\ucee4\ub2c8\uc998\uc744 \ucd94\uac00\ud560 \uac83\uc785\ub2c8.\n\n\uc720\uc0ac\ub3c4 \uc810\uc218\ub97c \uae30\uc900\uc73c\ub85c \uc0c1\uc704 25\uac1c \uc601\ud654\ub97c \uc120\uc815\ud558\uace0, 60\ubc88\uc9f8 \ubc31\ubd84\uc704 \uc218 \uc601\ud654\uc758 \ud22c\ud45c\ub97c \uacc4\uc0b0\ud569\ub2c8\ub2e4. \uadf8\ub7f0 \ub2e4\uc74c \uc774\uac83\uc744 $m$ \uac12\uc73c\ub85c \uc0ac\uc6a9\ud558\uc5ec Simple Recommender \uc139\uc158\uc5d0\uc11c\uc640 \uac19\uc774 IMDB\uc758 \uacf5\uc2dd\uc744 \uc0ac\uc6a9\ud558\uc5ec \uac01 \uc601\ud654\uc758 \uac00\uc911\uce58 \ub4f1\uae09\uc744 \uacc4\uc0b0\ud569\ub2c8\ub2e4.\n\nOne thing that we notice about our recommendation system is that it recommends movies regardless of ratings and popularity. It is true that **Batman and Robin** has a lot of similar characters as compared to **The Dark Knight** but it was a terrible movie that shouldn't be recommended to anyone.\n\nTherefore, we will add a mechanism to remove bad movies and return movies which are popular and have had a good critical response.\n\nI will take the top 25 movies based on similarity scores and calculate the vote of the 60th percentile movie. Then, using this as the value of  m , we will calculate the weighted rating of each movie using IMDB's formula like we did in the Simple Recommender section.","4e658580":"\uc774\uc81c \ucd9c\uc5f0\uc9c4, \uc81c\uc791\uc9c4, \uc7a5\ub974 \ubc0f \ud06c\ub808\ub527\uc774 \ubaa8\ub450 \ud558\ub098\uc758 \ub370\uc774\ud130 \ud504\ub808\uc784\uc5d0 \uc788\uc2b5\ub2c8\ub2e4. \uc544\ub798\uc758 \uc9c1\uad00\uc744 \uc0ac\uc6a9\ud558\uc5ec \uc774\uac83\uc744 \uc870\uae08 \ub354 \ud480\uc5b4\ubcfc \uac83\uc785\ub2c8\ub2e4.\n\n1. **Crew:** \uc81c\uc791\uc9c4 \uc911 \uac10\ub3c5 \uc678 \ub2e4\ub978 \uc0ac\ub78c\ub4e4\uc740 \uc601\ud654\uc758 *\ubd84\uc704\uae30*\uc5d0 \uadf8\ub2e4\uc9c0 \uae30\uc5ec\ud558\uc9c0 \uc54a\uae30 \ub54c\ubb38\uc5d0, \uc81c\uc791\uc9c4 \ub370\uc774\ud130 \uc911 \uac10\ub3c5\ub9cc feature\ub85c \uc120\ud0dd\ud560 \uac83\uc785\ub2c8\ub2e4.\n2. **Cast:** \ucd9c\uc5f0\uc9c4 \uc120\ud0dd\uc740 \uc870\uae08 \ub354 \uae4c\ub2e4\ub86d\uc2b5\ub2c8\ub2e4. \ub35c \uc54c\ub824\uc9c4 \ubc30\uc6b0\uc640 \ube44\uc911\uc774 \uc791\uc740 \uc5ed\ud560\uc740 \uc2e4\uc81c\ub85c \uc601\ud654\uc5d0 \ub300\ud55c \uc0ac\ub78c\ub4e4\uc758 \uc758\uacac\uc5d0 \uc601\ud5a5\uc744 \ubbf8\uce58\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \ub530\ub77c\uc11c \uc8fc\uc5f0\uacfc \ud574\ub2f9 \ubc30\uc6b0\ub9cc \uc120\ud0dd\ud574\uc57c\ud569\ub2c8\ub2e4. \uc784\uc758\ub85c \uc6b0\ub9ac\ub294 \ud06c\ub808\ub527 \ubaa9\ub85d\uc5d0 \ub098\uc624\ub294 \uc0c1\uc704 3\uba85\uc758 \ubc30\uc6b0\ub97c \uc120\ud0dd\ud569\ub2c8\ub2e4.\n\n**\ub3c4\uba54\uc778 \uc9c0\uc2dd**\n\nWe now have our cast, crew, genres and credits, all in one dataframe. Let us wrangle this a little more using the following intuitions:\n\n1. **Crew:** From the crew, we will only pick the director as our feature since the others don't contribute that much to the feel of the movie.\n2. **Cast:** Choosing Cast is a little more tricky. Lesser known actors and minor roles do not really affect people's opinion of a movie. Therefore, we must only select the major characters and their respective actors. Arbitrarily we will choose the top 3 actors that appear in the credits list.","50f2f66b":"#### \ucf54\uc0ac\uc778 \uc720\uc0ac\ub3c4(Cosine Similarity)\n\n\ucf54\uc0ac\uc778 \uc720\uc0ac\ub3c4(Cosine Similarity)\uc744 \uc0ac\uc6a9\ud558\uc5ec \ub450 \uc601\ud654 \uc0ac\uc774\uc758 \uc720\uc0ac\uc131\uc744 \ub098\ud0c0\ub0b4\ub294 \uc22b\uc790 \uc218\ub7c9\uc744 \uacc4\uc0b0\ud560 \uac83\uc785\ub2c8\ub2e4. \uc218\ud559\uc801\uc73c\ub85c \ub2e4\uc74c\uacfc \uac19\uc774 \uc815\uc758\ub429\ub2c8\ub2e4.\n\n$cosine(x,y) = \\frac{x. y^\\intercal}{||x||.||y||} $\n\nTF-IDF \ubca1\ud130 \ub77c\uc774\uc800\ub97c \uc0ac\uc6a9 \ud588\uc73c\ubbc0\ub85c Dot Product\ub97c \uacc4\uc0b0\ud558\uba74 \ucf54\uc0ac\uc778 \uc720\uc0ac\ub3c4 \uc810\uc218\ub97c \uc9c1\uc811 \uc5bb\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ub530\ub77c\uc11c cosine_similarities \ub300\uc2e0 sklearn\uc758 **linear_kernel**\uc744 \uc0ac\uc6a9\ud558\ub294 \uac83\uc774 \ud6e8\uc52c \ube60\ub985\ub2c8\ub2e4.\n\n\nI will be using the Cosine Similarity to calculate a numeric quantity that denotes the similarity between two movies. Mathematically, it is defined as follows:\n\n$cosine(x,y) = \\frac{x. y^\\intercal}{||x||.||y||} $\n\nSince we have used the TF-IDF Vectorizer, calculating the Dot Product will directly give us the Cosine Similarity Score. Therefore, we will use sklearn's **linear_kernel** instead of cosine_similarities since it is much faster.\n","9b96e9cb":"\uae30\uc874\uc5d0 \uc0ac\uc6a9\ud588\ub358 \uc601\ud654 \ub370\uc774\ud130(45,000\ud3b8)\uc758 1\/5\uc5d0 \ud574\ub2f9\ud558\ub294 9,099\ud3b8\uc758 \uc601\ud654 \ub370\uc774\ud130 \uc14b\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\n\nWe have 9099 movies avaiable in our small movies metadata dataset which is 5 times smaller than our original dataset of 45000 movies.","41bde424":"### \uc601\ud654 \ub0b4\uc6a9 \uae30\ubc18 \ucd94\ucc9c \uc2dc\uc2a4\ud15c(Movie Description Based Recommender)\n\n\uba3c\uc800 \uc601\ud654 \ub0b4\uc6a9\uacfc \ud0dc\uadf8 \ub77c\uc778\uc744 \uc0ac\uc6a9\ud558\uc5ec \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc744 \uad6c\ud604\ud574\ubcf4\uaca0\uc2b5\ub2c8\ub2e4. \uc2dc\uc2a4\ud15c\uc758 \uc131\ub2a5\uc744 \ud310\ub2e8\ud558\uae30 \uc704\ud55c \uc815\ub7c9\uc801 \uce21\uc815\ubc95\uc774 \uc5c6\uae30 \ub54c\ubb38\uc5d0 \uc774\ub97c \uc815\uc131\uc801\uc73c\ub85c \ud3c9\uac00\ud574\uc57c \ud569\ub2c8\ub2e4.\n\nLet us first try to build a recommender using movie descriptions and taglines. We do not have a quantitative metric to judge our machine's performance so this will have to be done qualitatively.","1c779843":"\ud558\uc774\ube0c\ub9ac\ub4dc \ucd94\ucc9c \uc2dc\uc2a4\ud15c\uc758 \uacbd\uc6b0 \uc601\ud654\ub294 \ub3d9\uc77c\ud558\uc9c0\ub9cc \uc0ac\uc6a9\uc790\ub9c8\ub2e4 \ub2e4\ub978 \ucd94\ucc9c\uc744 \ud569\ub2c8\ub2e4. \ub530\ub77c\uc11c \ucd94\ucc9c\uc2dc\uc2a4\ud15c\uc740 \ud2b9\uc815 \uc0ac\uc6a9\uc790\ub97c \uc704\ud574 \ub354\uc6b1 \uac1c\uc778\ud654\ub418\uace0 \ub9de\ucda4\ud654\ub429\ub2c8\ub2e4.\n\nWe see that for our hybrid recommender, we get different recommendations for different users although the movie is the same. Hence, our recommendations are more personalized and tailored towards particular users.","d51c84a3":"\uc774\uc804\uc5d0 \uc791\uc131\ud55c get_recommendations \ud568\uc218\ub97c \uc7ac\uc0ac\uc6a9 \ud560 \uac83\uc785\ub2c8\ub2e4. \ucf54\uc0ac\uc778 \uc720\uc0ac\ub3c4 \uc810\uc218\uac00 \ubcc0\uacbd\ub418\uc5c8\uc73c\ubbc0\ub85c \ub2e4\ub978(\uadf8\ub9ac\uace0 \uc544\ub9c8\ub3c4 \ub354 \ub098\uc740) \uacb0\uacfc\ub97c \uc5bb\uc744 \uac83\uc73c\ub85c \uae30\ub300\ud569\ub2c8\ub2e4. **\ub2e4\ud06c \ub098\uc774\ud2b8**\uac00 \uc774\ubc88\uc5d0\ub294 \uc5b4\ub5a4 \ucd94\ucc9c\uc744 \ubc1b\ub294\uc9c0 \ud655\uc778\ud574\ubcf4\ub3c4\ub85d \ud558\uaca0\uc2b5\ub2c8\ub2e4.\n\nWe will reuse the get_recommendations function that we had written earlier. Since our cosine similarity scores have changed, we expect it to give us different (and probably better) results. Let us check for The Dark Knight again and see what recommendations I get this time around.","cc9dd047":"### Top Movies","90860491":" \ucd94\ucc9c\uc2dc\uc2a4\ud15c\uc744 \uad6c\ucd95\ud558\uae30 \uc704\ud55c \ub098\uc758 \uc811\uadfc \ubc29\uc2dd\uc740 \uadf9\ub3c4\ub85c *hacky*(\uc9c0\uc800\ubd84\ud558\uace0 \uc5b4\uc124\ud508)\ud560 \uac83\uc785\ub2c8\ub2e4. \ubaa8\ub4e0 \uc601\ud654\uc5d0 \ub300\ud574 **\uc7a5\ub974, \uac10\ub3c5, \uc8fc\uc5f0 \ubc30\uc6b0 \ubc0f \ud0a4\uc6cc\ub4dc**\ub85c \uad6c\uc131\ub41c \uba54\ud0c0 \ub370\uc774\ud130 \ub364\ud504\ub97c \ub9cc\ub4e4 \uac83 \uc785\ub2c8\ub2e4. \uadf8\ub7f0 \ub2e4\uc74c **Count Vectorizer**\ub97c \uc0ac\uc6a9\ud558\uc5ec Description Recommender\uc5d0\uc11c\uc640 \uac19\uc774 \uce74\uc6b4\ud2b8 \ub9e4\ud2b8\ub9ad\uc2a4\ub97c \ub9cc\ub4ed\ub2c8\ub2e4. \ub098\uba38\uc9c0 \ub2e8\uacc4\ub294 \uc774\uc804\uc5d0 \uc218\ud589\ud55c \uac83\uacfc \uc720\uc0ac\ud569\ub2c8\ub2e4. \ucf54\uc0ac\uc778 \uc720\uc0ac\ub3c4\ub97c \uacc4\uc0b0\ud558\uace0 \uac00\uc7a5 \uc720\uc0ac\ud55c \uc601\ud654\ub97c \ubc18\ud658\ud569\ub2c8\ub2e4.\n\n\uc7a5\ub974 \ubc0f \ud06c\ub808\ub527 \ub370\uc774\ud130\ub97c \uc900\ube44 \ud560 \ub54c \ub530\ub77c\uc57c \ud560 \ub2e8\uacc4\ub294 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4.\n1. \ubaa8\ub4e0 \uae30\ub2a5\uc5d0\uc11c **\uc2a4\ud2b8\ub9bd \uc2a4\ud398\uc774\uc2a4 \ubc0f \uc18c\ubb38\uc790\ub85c \ubcc0\ud658**. \uc774\ub7f0 \uc2dd\uc73c\ub85c \uc6b0\ub9ac \uc5d4\uc9c4\uc740 **Johnny Depp**\uc640 **Johnny Galecki**\ub97c \ud63c\ub3d9\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.\n2. **\uac10\ub3c5\uc740 3\ubc30\ub85c \uc5b8\uae09\ud558\uc5ec**\uc740 \uc804\uccb4 \uce90\uc2a4\ud2b8\uc5d0 \ube44\ud574 \uac00\uc911\uce58\ub97c \ub354 \uc90d\ub2c8\ub2e4.\n\n\nMy approach to building the recommender is going to be extremely hacky. What I plan on doing is creating a metadata dump for every movie which consists of **genres, director, main actors and keywords**. I then use a **Count Vectorizer** to create our count matrix as we did in the Description Recommender. The remaining steps are similar to what we did earlier: we calculate the cosine similarities and return movies that are most similar.\n\nThese are steps I follow in the preparation of my genres and credits data:\n\n1. **Strip Spaces and Convert to Lowercase** from all our features. This way, our engine will not confuse between **Johnny Depp** and **Johnny Galecki**.\n2. **Mention Director 3 times** to give it more weight relative to the entire cast.","bc50fe63":"### Scikit-Learn \uc758 \ubb38\uc11c \uc804\ucc98\ub9ac \uae30\ub2a5\n\n**BOW (Bag of Words)**\n\ubb38\uc11c\ub97c \uc22b\uc790 \ubca1\ud130\ub85c \ubcc0\ud658\ud558\ub294 \uac00\uc7a5 \uae30\ubcf8\uc801\uc778 \ubc29\ubc95\uc740 BOW (Bag of Words)\uc774\ub2e4. BOW \ubc29\ubc95\uc5d0\uc11c\ub294 \uc804\uccb4 \ubb38\uc11c {d1,d2,\u2026,dn} \ub97c \uad6c\uc131\ud558\ub294 \uace0\uc815\ub41c \ub2e8\uc5b4\uc7a5(vocabulary)  {t1,t2,\u2026,tm}\ub97c \ub9cc\ub4e4\uace0  di\ub77c\ub294 \uac1c\ubcc4 \ubb38\uc11c\uc5d0 \ub2e8\uc5b4\uc7a5\uc5d0 \ud574\ub2f9\ud558\ub294 \ub2e8\uc5b4\ub4e4\uc774 \ud3ec\ud568\ub418\uc5b4 \uc788\ub294\uc9c0\ub97c \ud45c\uc2dc\ud558\ub294 \ubc29\ubc95\uc774\ub2e4.\n\nxi,j=\ubb38\uc11c di\ub0b4\uc758 \ub2e8\uc5b4 tj\uc758 \ucd9c\ud604 \ube48\ub3c4\n\n\ub610\ub294\n\nxi,j = 0 : \ub9cc\uc57d \ub2e8\uc5b4 tj\uac00 \ubb38\uc11c di \uc548\uc5d0 \uc5c6\uc73c\uba74\n      1 : \ub9cc\uc57d \ub2e8\uc5b4 tj\uac00 \ubb38\uc11c di \uc548\uc5d0 \uc788\uc73c\uba74\n\n**TfidfVectorizer** : CountVectorizer\uc640 \ube44\uc2b7\ud558\uc9c0\ub9cc TF-IDF \ubc29\uc2dd\uc73c\ub85c \ub2e8\uc5b4\uc758 \uac00\uc911\uce58\ub97c \uc870\uc815\ud55c BOW \ubca1\ud130\ub97c \ub9cc\ub4e0\ub2e4.\n-> TF-IDF(Term Frequency \u2013 Inverse Document Frequency) \uc778\ucf54\ub529\uc740 \ub2e8\uc5b4\ub97c \uac2f\uc218 \uadf8\ub300\ub85c \uce74\uc6b4\ud2b8\ud558\uc9c0 \uc54a\uace0 \ubaa8\ub4e0 \ubb38\uc11c\uc5d0 \uacf5\ud1b5\uc801\uc73c\ub85c \ub4e4\uc5b4\uc788\ub294 \ub2e8\uc5b4\uc758 \uacbd\uc6b0 \ubb38\uc11c \uad6c\ubcc4 \ub2a5\ub825\uc774 \ub5a8\uc5b4\uc9c4\ub2e4\uace0 \ubcf4\uc544 \uac00\uc911\uce58\ub97c \ucd95\uc18c\ud558\ub294 \ubc29\ubc95\uc774\ub2e4."}}