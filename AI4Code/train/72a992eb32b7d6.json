{"cell_type":{"48c73362":"code","601b0833":"code","aa75ae76":"code","546ad91d":"code","834da352":"code","ea508cd0":"code","4763f71b":"code","ce9171c4":"code","b32657ff":"code","ee090ea3":"code","aed7e49b":"code","2b2e9da2":"code","91932bc1":"code","43f3958d":"code","80c2b11e":"code","bf49bc0a":"code","217a3c6d":"code","f9b003cf":"code","caf68767":"markdown"},"source":{"48c73362":"import pandas as pd\nimport numpy as np\nimport warnings\nwarnings.filterwarnings('ignore')\npd.set_option('max_rows',None)\npd.set_option('max_columns',None)\nX=pd.read_csv('..\/input\/titanic\/train.csv',encoding='utf-8')\nX_test=pd.read_csv('..\/input\/titanic\/test.csv',encoding='utf-8')\nY_test=pd.read_csv('..\/input\/titanic\/gender_submission.csv',encoding='utf-8')","601b0833":"# \ub370\uc774\ud130 \uc0b4\ud3b4\ubcf4\uae30\nX.head()","aa75ae76":"X.info()","546ad91d":"X['Pclass'].value_counts()","834da352":"# \ud6c8\ub828\ub370\uc774\ud130 : \ubd88\ud544\uc694 \ub370\uc774\ud130 \uc0ad\uc81c\nX=X.drop(['PassengerId','Name','Ticket','Cabin'],axis=1)\nX.isnull().sum()","ea508cd0":"X.dropna(subset=['Embarked'],inplace=True)\nX.isnull().sum()","4763f71b":"# \ud6c8\ub828\ub370\uc774\ud130 : \uacb0\uce21\uce58 \ubcf4\uc815\nX['Age'].fillna(X['Age'].mean(),inplace=True)\nX.isnull().sum()","ce9171c4":"# \ud6c8\ub828\uc6a9 \ub370\uc774\ud130 \ubd84\ud560\nX_train=X.drop(['Survived'],axis=1)\nY_train=X.iloc[:,0]","b32657ff":"Y_train.head()","ee090ea3":"# \ud14c\uc2a4\ud2b8\ub370\uc774\ud130 : \ubd88\ud544\uc694 \ub370\uc774\ud130 \uc0ad\uc81c \ubc0f \uacb0\uce21\uce58 \ubcf4\uc815\ntest_ID=X_test['PassengerId']\nX_test=X_test.drop(['PassengerId','Name','Ticket','Cabin'],axis=1)\nX_test['Age'].fillna(X_test['Age'].mean(),inplace=True)\nX_test['Fare'].fillna(X_test['Fare'].mean(),inplace=True)\nX_test.isnull().sum()","aed7e49b":"# \ubc94\uc8fc\ubcc0\uc218 \ub354\ubbf8\ncol_cat=['Sex','Embarked']\ncol_num=['Pclass','Age','SibSp','Parch','Fare']\nX_train_cat=pd.get_dummies(X_train[col_cat])\nX_train_cat.head()","2b2e9da2":"# \uc218\uce58\ud615 \ubcc0\uc218 \uc815\uaddc\ud654 \ubc0f \ubc94\uc8fc\ud615 \ubcc0\uc218\uc640 \ud569\uce58\uae30\nfrom sklearn.preprocessing import MinMaxScaler\nscaler=MinMaxScaler()\nscaler.fit(X_train[col_num])\nX_train[col_num]=scaler.transform(X_train[col_num])\nX_train_num=X_train[col_num]\nX_train_f=pd.concat([X_train_cat,X_train_num],axis=1)\nX_train_f.tail()","91932bc1":"# \ud14c\uc2a4\ud2b8 \ub370\uc774\ud130 \ubcc0\ud658\nX_test_cat=pd.get_dummies(X_test[col_cat])\nX_test[col_num]=scaler.transform(X_test[col_num])\nX_test_num=X_test[col_num]\nX_test_f=pd.concat([X_test_cat,X_test_num],axis=1)\nX_test_f.tail()","43f3958d":"# \ubaa8\ub378 \ud559\uc2b5\uc2dc\ud0a4\uae30\nimport sklearn\nfrom sklearn.ensemble import RandomForestClassifier\nmodel=RandomForestClassifier(n_estimators=100,max_depth=6, random_state=13)\nmodel.fit(X_train_f,Y_train)\ntrain_pred=model.predict(X_train_f)\ntrain_pred_score=model.score(X_train_f,Y_train)\ntrain_pred_score\n","80c2b11e":"# \ud14c\uc2a4\ud2b8 \ub370\uc774\ud130\ub85c \uc608\uce21\ud558\uae30\ntest_pred=model.predict(X_test_f)\npd.DataFrame(test_pred).head()","bf49bc0a":"output=pd.DataFrame({'PassengerID':test_ID,'Survived':test_pred})\n\noutput.head()","217a3c6d":"output.to_csv('T2-1_choi.csv',index=False)","f9b003cf":"# \ud14c\uc2a4\ud2b8 \ub370\uc774\ud130 \uc131\ub2a5\ud3c9\uac00\ntest_pred_score=model.score(X_test_f,Y_test['Survived'])\ntest_pred_score","caf68767":"## T2-1. Titanic (classification)\n\n\uc0dd\uc874\uc5ec\ubd80 \uc608\uce21\ubaa8\ub378 \ub9cc\ub4e4\uae30\n\n\ud559\uc2b5\uc6a9 \ub370\uc774\ud130 (Xtrain, ytrain)\uc744 \uc774\uc6a9\ud558\uc5ec \uc0dd\uc874 \uc608\uce21 \ubaa8\ud615\uc744 \ub9cc\ub4e0 \ud6c4, \uc774\ub97c \ud3c9\uac00\uc6a9 \ub370\uc774\ud130(X_test)\uc5d0 \uc801\uc6a9\ud558\uc5ec \uc5bb\uc740 \uc608\uce21\uac12\uc744 \ub2e4\uc74c\uacfc \uac19\uc740 \ud615\uc2dd\uc758 CSV\ud30c\uc77c\ub85c \uc0dd\uc131\ud558\uc2dc\uc624(\uc81c\ucd9c\ud55c \ubaa8\ub378\uc758 \uc131\ub2a5\uc740 accuracy \ud3c9\uac00\uc9c0\ud45c\uc5d0 \ub530\ub77c \ucc44\uc810)\n\n(\uac00) \uc81c\uacf5 \ub370\uc774\ud130 \ubaa9\ub85d\n* y_train: \uc0dd\uc874\uc5ec\ubd80(\ud559\uc2b5\uc6a9)\n* Xtrian, Xtest : \uc2b9\uac1d \uc815\ubcf4 (\ud559\uc2b5\uc6a9 \ubc0f \ud3c9\uac00\uc6a9)\n\n(\ub098) \ub370\uc774\ud130 \ud615\uc2dd \ubc0f \ub0b4\uc6a9\n* y_trian (712\uba85 \ub370\uc774\ud130)\n* \uc2dc\ud5d8\ud658\uacbd \uc138\ud305\uc740 \uc608\uc2dc\ubb38\uc81c\uc640 \ub3d9\uc77c\ud55c \ud615\ud0dc\uc758 Xtrain, ytrain, X_test \ub370\uc774\ud130\ub97c \ub9cc\ub4e4\uae30 \uc704\ud568\uc784\n\n\uc720\uc758\uc0ac\ud56d\n* \uc131\ub2a5\uc774 \uc6b0\uc218\ud55c \uc608\uce21\ubaa8\ud615\uc744 \uad6c\ucd95\ud558\uae30 \uc704\ud574\uc11c\ub294 \uc801\uc808\ud55c \ub370\uc774\ud130 \uc804\ucc98\ub9ac, \ud53c\ucc98\uc5d4\uc9c0\ub2c8\uc5b4\ub9c1, \ubd84\ub958\uc54c\uace0\ub9ac\uc998, \ud558\uc774\ud37c\ud30c\ub77c\ubbf8\ud130 \ud29c\ub2dd, \ubaa8\ud615 \uc559\uc0c1\ube14 \ub4f1\uc774 \uc218\ubc18\ub418\uc5b4\uc57c \ud55c\ub2e4.\n* \uc218\ud5d8\ubc88\ud638.csv\ud30c\uc77c\uc774 \ub9cc\ub4e4\uc5b4\uc9c0\ub3c4\ub85d \ucf54\ub4dc\ub97c \uc81c\ucd9c\ud55c\ub2e4.\n* \uc81c\ucd9c\ud55c \ubaa8\ub378\uc758 \uc131\ub2a5\uc740 accuracy\ub85c \ud3c9\uac00\ud568\n\ncsv \ucd9c\ub825\ud615\ud0dc\n* index\ub294 \uc5c6\uace0\n* PassengerId, Survived \ub9cc \uc788\ub294 \ud615\ud0dc"}}