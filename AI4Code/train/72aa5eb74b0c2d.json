{"cell_type":{"89ddb886":"code","73a0ec85":"code","2cc6315b":"code","aa4a6942":"code","9c7e23d2":"code","99f34406":"code","d4e2b3be":"code","dc6066a6":"code","ebd54f28":"code","630e8a04":"code","c0830fb9":"code","882117dd":"code","97d237e6":"code","05ed05c5":"code","8f3fd08e":"code","0fefc155":"code","97aeec65":"code","20c42a5f":"code","7973f6ed":"code","1e94e5a5":"code","fac39074":"code","e946e144":"code","c1b3ce5c":"code","a979e831":"code","b7f640fc":"code","6b56b54b":"code","d7c89e80":"code","b7007a04":"code","d876f5e9":"code","fc1a6485":"code","59035717":"code","c8f608f7":"code","dd2a3009":"code","6f20a4be":"code","02534485":"code","3f0c71a8":"code","f17732ab":"code","c8c8bafa":"code","58101785":"code","cc802bc6":"code","9879a9df":"code","a0bb5bd3":"code","c4492832":"code","376e71b5":"code","bbe83b77":"code","88f442b5":"code","0dc5e197":"code","dc208b65":"code","a3547afd":"code","a6d0ce14":"code","8d068cfc":"code","89d9919e":"code","9b1824e1":"code","f92a4a4f":"code","e41a5b81":"code","d49be4d1":"code","6358069d":"markdown","ada5bd31":"markdown","c17a7922":"markdown","fdcc4330":"markdown","c2baa93d":"markdown","f7891680":"markdown","0ef12524":"markdown","92b9ba3d":"markdown","28ba7bac":"markdown","6c92fc5c":"markdown","a7815ec4":"markdown","d2e413f0":"markdown","f5cc0d29":"markdown","0a406500":"markdown","1d47792c":"markdown"},"source":{"89ddb886":"import pandas as pd\nimport numpy\nimport matplotlib.pyplot as plt\nimport seaborn as sns","73a0ec85":"traindf = pd.read_csv(\"\/kaggle\/input\/tmdb-box-office-prediction\/train.csv\")\ntestdf = pd.read_csv(\"\/kaggle\/input\/tmdb-box-office-prediction\/test.csv\")\nprint(traindf.shape)\nprint(testdf.shape)\ntraindf.head(5)","2cc6315b":"# Null_Values = traindf.isnull()\n# for column in Null_Values.columns.values.tolist():\n#     print(Null_Values[column].value_counts())\n#     print(\"\")\nprint(\"Train Data\",traindf.isnull().sum())\nprint(\"\\n\\n\\n\\nTest Data\",testdf.isnull().sum())\n   \n    ","aa4a6942":"print(\"Train Data\",traindf.info())\nprint(\"\\n\\n\\n\\n\")\nprint(\"Test Data\",testdf.info())","9c7e23d2":"traindf.describe(include = 'all')","99f34406":"testdf.describe(include = 'all')","d4e2b3be":"BinsBudget = numpy.linspace(min(traindf[\"budget\"]), max(traindf[\"budget\"]),4)\nBinsRun = numpy.linspace(min(traindf[\"runtime\"]), max(traindf[\"runtime\"]),4)\n\nBinsBudgetName = [\"Low Budget\", \"Medium Budget\", \"High Budget\"] \nBinsRunName = [\"Short \", \"Medium\", \"Long \"]\n\ntraindf[\"BinBudget\"] = pd.cut(traindf[\"budget\"],BinsBudget,labels = BinsBudgetName,include_lowest = True)\ntraindf[\"BinRunTime\"] = pd.cut(traindf[\"runtime\"],BinsRun,labels = BinsRunName,include_lowest = True)\ntraindf\n","dc6066a6":"plt.figure(figsize = (15,8))\nsns.countplot(traindf[\"runtime\"])\nplt.xlabel(\"Runtime\")\nplt.ylabel(\"Count\")\nplt.title(\"Runtime Variations of Box Office\")","ebd54f28":"plt.figure(figsize = (15,8))\nsns.countplot(traindf[\"BinRunTime\"].sort_values())\nplt.xlabel(\"RunTime\")\nplt.ylabel(\"Count\")\nplt.title(\"RunTime Variations of Box Office\")","630e8a04":"sns.jointplot(x=\"budget\", y=\"revenue\", data=traindf, height=11, ratio=6, color=\"r\")\nplt.xlabel(\"RunTime\")\nplt.ylabel(\"Count\")\nplt.title(\"RunTime Variations of Box Office\")","c0830fb9":"plt.figure(figsize = (15,8))\nplt.hist(traindf[\"budget\"])\nplt.xlabel(\"Budget\")\nplt.ylabel(\"Count\")\nplt.title(\"Budget Variations of Box Office\")","882117dd":"plt.figure(figsize = (15,8))\nplt.hist(traindf[\"BinBudget\"])\nplt.xlabel(\"Budget\")\nplt.ylabel(\"Count\")\nplt.title(\"Budget Variations of Box Office\")","97d237e6":"plt.figure(figsize = (25,8))\n# plt.scatter(\"budget\",\"revenue\",data=traindf)\nsns.jointplot(x=\"budget\", y=\"revenue\", data=traindf, height=11, ratio=6, color=\"g\")\nplt.xlabel(\"Budget\")\nplt.ylabel(\"Count\")\nplt.title(\"Budget Variations of Box Office\")","05ed05c5":"plt.figure(figsize = (15,8))\nplt.hist(traindf[\"popularity\"])\nplt.xlabel(\"Runtime\")\nplt.ylabel(\"Count\")\nplt.title(\"Runtime Variations of Box Office\")\nplt.show()","8f3fd08e":"plt.figure(figsize = (15,8))\nsns.countplot(traindf[\"popularity\"])\nplt.xlabel(\"Runtime\")\nplt.ylabel(\"Count\")\nplt.title(\"Runtime Variations of Box Office\")\nplt.show()","0fefc155":"plt.figure(figsize = (15,8))\n# plt.scatter(traindf[\"popularity\"],traindf[\"revenue\"])\nsns.jointplot(traindf[\"popularity\"],traindf[\"revenue\"],height = 12,ratio =6,color = \"b\")\n\nplt.xlabel(\"Runtime\")\nplt.ylabel(\"Count\")\nplt.title(\"Runtime Variations of Box Office\")\nplt.show()","97aeec65":"sns.pairplot(traindf[[\"revenue\",\"popularity\",\"runtime\",\"budget\"]])","20c42a5f":"plt.figure(figsize = (15,8))\nsns.countplot(traindf[\"original_language\"])\nplt.xlabel(\"original Language\")\nplt.ylabel(\"Count\")\nplt.title(\"Original Language of Box Office\")\nplt.show()","7973f6ed":"test = traindf[[\"BinBudget\",\"BinRunTime\",\"revenue\"]]\nGroup = test.groupby([\"BinBudget\",\"BinRunTime\"],as_index=False).mean()\nPivot = Group.pivot(\"BinBudget\",\"BinRunTime\")\n\ndisplay(Group)\ndisplay(Pivot)\n","1e94e5a5":"plt.figure(figsize = (15,8))\nsns.heatmap(Pivot,annot=True, cmap=\"RdBu\")\nplt.title(\"Heatmap of Binned Budget & Runtime with Price\")","fac39074":"plt.figure(figsize = (25,10))\n\nplt.scatter(traindf[\"budget\"],traindf[\"runtime\"],c=traindf[\"revenue\"],cmap=\"RdGy\")\nplt.colorbar()\nplt.title(\"Heatmap of Budget & Runtime with Price with scatter\")\nplt.xlabel(\"Runtime\")\nplt.ylabel(\"Budget\")","e946e144":"plt.figure(figsize = (25,12))\nsns.heatmap(traindf.corr(),annot = True)","c1b3ce5c":"traindf[['release_month','release_day','release_year']]=traindf['release_date'].str.split('\/',expand=True).replace(numpy.nan, -1).astype(int)\ntraindf.head(2)","a979e831":"plt.figure(figsize = (25,12))\nsns.heatmap(traindf.corr(),annot = True)","b7f640fc":"plt.figure(figsize = (15,8))\nsns.countplot(traindf[\"release_month\"])\nplt.xlabel(\"Release Month\")\nplt.ylabel(\"Count\")\nplt.title(\"Monthly Release Variation\")\nplt.show()","6b56b54b":"plt.figure(figsize = (15,8))\n\ntest2 = traindf[[\"release_month\",\"budget\"]]\ngroup2 = test2.groupby([\"release_month\"]).mean()\nplt.plot(group2)\n\nplt.xlabel(\"Release Month\")\nplt.ylabel(\"Budget\")\nplt.title(\"Average Monthly Budget Variation\")\nplt.show()","d7c89e80":"plt.figure(figsize = (15,8))\n\ntest3 = traindf[[\"release_month\",\"revenue\"]]\ngroup3 = test3.groupby([\"release_month\"]).mean()\nplt.plot(group3)\n\nplt.xlabel(\"Release Month\")\nplt.ylabel(\"Revnue\")\nplt.title(\"Average Monthly Revenue Variation\")\nplt.show()","b7007a04":"plt.figure(figsize = (18,8))\nsns.countplot(traindf[\"release_day\"])\nplt.xlabel(\"Release Month\")\nplt.ylabel(\"Count\")\nplt.title(\"Day Release Variation\")\nplt.show()","d876f5e9":"plt.figure(figsize = (15,8))\n\ntest4 = traindf[[\"release_day\",\"budget\"]]\ngroup4 = test4.groupby([\"release_day\"]).mean()\nplt.plot(group4)\n\nplt.xlabel(\"Release Day\")\nplt.ylabel(\"Budget\")\nplt.title(\"Average Daily Budget Variation\")\nplt.show()","fc1a6485":"plt.figure(figsize = (15,8))\n\ntestdaily = traindf[[\"release_day\",\"revenue\"]]\ngroupdaily = testdaily.groupby([\"release_day\"]).mean()\nplt.plot(groupdaily)\n\nplt.xlabel(\"Release Day\")\nplt.ylabel(\"Revnue\")\nplt.title(\"Average Daily Revenue Variation\")\nplt.show()","59035717":"plt.figure(figsize = (30,8))\nsns.countplot(traindf[\"release_year\"])\nplt.xlabel(\"Release Month\")\nplt.ylabel(\"Count\")\nplt.title(\"Yearly Release Variation\")\nplt.show()","c8f608f7":"plt.figure(figsize = (15,8))\n\ntraindf['YearlyBudget'] = traindf[[\"release_month\",\"budget\"]].groupby([\"release_month\"]).mean()\nplt.plot(traindf['YearlyBudget'])\n\nplt.xlabel(\"Release Year\")\nplt.ylabel(\"Revnue\")\nplt.title(\"Average Yearly Revenue Variation\")\nplt.show()","dd2a3009":"plt.figure(figsize = (15,8))\n\ntraindf['YearlyRevnue'] = traindf[[\"release_month\",\"revenue\"]].groupby([\"release_month\"]).mean()\nplt.plot(traindf['YearlyRevnue'])\n\nplt.xlabel(\"Release Day\")\nplt.ylabel(\"Revnue\")\nplt.title(\"Average Daily Revenue Variation\")\nplt.show()","6f20a4be":"sns.pairplot(traindf[[\"budget\",\"revenue\",\"release_year\",\"release_month\",\"release_day\"]])","02534485":"traindf.loc[pd.isnull(traindf[\"homepage\"]) ,\"Is There Homepage\"] = 0\ntraindf[\"Is There Homepage\"].replace(numpy.nan,\"1\",inplace=True)    # So int this NaN will be for the title that have home page\n\ntraindf.loc[pd.isnull(traindf[\"tagline\"]) ,\"Is There Tagline\"] = 0\ntraindf[\"Is There Tagline\"].replace(numpy.nan,\"1\",inplace=True)    # So int this NaN will be for the title that have Tagline\n\ntraindf['English Movie'] = 0 \ntraindf.loc[ traindf['original_language'] == \"en\" ,\"English Movie\"] = 1\n\ntraindf","3f0c71a8":"plt.figure(figsize = (15,7))\nsns.countplot(traindf[\"Is There Homepage\"])","f17732ab":"# plt.figure(figsize = (28,17))\nsns.catplot(\"Is There Homepage\",y=\"revenue\",data = traindf)","c8c8bafa":"plt.figure(figsize = (28,17))\nsns.catplot(\"Is There Tagline\",y=\"revenue\",data = traindf)\n\n","58101785":"from sklearn.linear_model import LinearRegression \nfrom sklearn.pipeline import Pipeline \nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import Ridge\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.model_selection import cross_val_predict\n\n","cc802bc6":"TrainingFeatures = traindf[[\"budget\",\"popularity\",\"runtime\",\"Is There Homepage\",\"Is There Tagline\",\"English Movie\"]]\ny = traindf[\"revenue\"]\n\nxTrain,xTest,yTrain,yTest = train_test_split(TrainingFeatures,y,test_size = 0.10,random_state = 0)\nTrainingFeatures.isnull().sum()","9879a9df":"traindf[\"runtime\"].replace((numpy.nan,),traindf[\"runtime\"].mean(),inplace=True) \n\n# Replacing the Null Values by mean of the column\n\nTrainingFeatures.isnull().sum()","a0bb5bd3":"lr = LinearRegression()\nlr.fit(xTrain,yTrain)\nprint(\"Rsquared Score for Linear Regression Model = \", lr.score(xTest,yTest))","c4492832":"RsqTest = []\norder = numpy.arange(1,6,1)\n\nfor n in order:\n    pr = PolynomialFeatures(degree = n )\n    Scale = StandardScaler()\n    xTrainTrans = pr.fit_transform(xTrain) \n    xTestTrans = pr.fit_transform(xTest)\n    \n    \n    lr.fit(xTrainTrans,yTrain)\n    RsqTest.append(lr.score(xTestTrans,yTest))\n        \ndisplay(RsqTest) \n\n# plt.plot(RsqTest)\n# plt.ylim(0.6,0.7)","376e71b5":"input = [[\"Scale\",StandardScaler()],[\"Poly\",PolynomialFeatures(degree=3)],[\"lr\",LinearRegression()]]\nPipe = Pipeline(input)\nPipe.fit(xTrain,yTrain)\nPipe.score(xTest,yTest)","bbe83b77":"Pipe.score(xTrain,yTrain)","88f442b5":"Pipe.score(TrainingFeatures,y)","0dc5e197":"Pipe.fit(TrainingFeatures,y)\n# Pipe.score(xTest,yTest)\n# Pipe.score(xTrain,yTrain)\nPipe.score(TrainingFeatures,y)","dc208b65":"RsqTrain2 = []\nRsqTest2 = []\n\nALFAVAL = [0.000000001,0.00001,0.0001,0.001,0.01,0.1,1,10,100,1000,10000,100000,1000000,10000000]\n\nfor m in ALFAVAL:\n    RidgeModel = Ridge(alpha=m)\n    \n    RidgeModel.fit(xTrain,yTrain)\n    \n    RsqTest2.append(RidgeModel.score(xTest,yTest))\n    RsqTrain2.append(RidgeModel.score(xTrain,yTrain))\n\ndisplay(RsqTest2) \n# display(RsqTrain2)\n# plt.plot(RsqTest2)","a3547afd":"ScoresCVS = cross_val_score(Pipe,TrainingFeatures,y,cv = 17) \nnumpy.mean(ScoresCVS)","a6d0ce14":"testdf.head(2)","8d068cfc":"testdf.loc[pd.isnull(testdf[\"homepage\"]) ,\"Is There Homepage\"] = 0\ntestdf[\"Is There Homepage\"].replace(numpy.nan,\"1\",inplace=True)    # So int this NaN will be for the title that have home page\n\ntestdf.loc[pd.isnull(testdf[\"tagline\"]) ,\"Is There Tagline\"] = 0\ntestdf[\"Is There Tagline\"].replace(numpy.nan,\"1\",inplace=True)    # So int this NaN will be for the title that have Tagline\n\ntestdf['English Movie'] = 0 \ntestdf.loc[ testdf['original_language'] == \"en\" ,\"English Movie\"] = 1","89d9919e":"testdf.head(2)","9b1824e1":"testdf[\"budget\"].replace(0,testdf[\"budget\"].mean(),inplace=True)","f92a4a4f":"TestingFeatures.isnull().sum()","e41a5b81":"testdf[\"runtime\"].replace(numpy.nan, testdf[\"runtime\"].mean(),inplace = True)","d49be4d1":"TestingFeatures = testdf[[\"budget\",\"popularity\",\"runtime\",\"Is There Homepage\",\"Is There Tagline\",\"English Movie\"]]\n\nPipe.fit(TrainingFeatures,y)\n\nPredicted_Revenue = Pipe.predict(TestingFeatures)\nPredicted_Revenue = numpy.array(Predicted_Revenue)\n\n\n\nSubFile = pd.read_csv(\"..\/input\/tmdb-box-office-prediction\/sample_submission.csv\")\nSubFile[\"revenue\"] = Predicted_Revenue\nSubFile\nSubFile.to_csv(\"My Final Sub.csv\",index=False)\n\n","6358069d":"# Modelling","ada5bd31":"**Creating Bins For Budget and Runtime for EDA.****","c17a7922":"Using Cross Val ","fdcc4330":"# Exploratory Data Analysis\n","c2baa93d":"# Now Traning then fitting Pipe in test data","f7891680":"**Polynomial Regression\nChecking the Rsquared Scores For various Degrees","0ef12524":"**Ridge Regression\nChecking the Rsquared Scores For various Degrees","92b9ba3d":"Cleaning and making testdf ti fit in Model","28ba7bac":"# I will use Pipelines to Predict final","6c92fc5c":"# **Now check the Nan values & Data Types**","a7815ec4":"Linear Regression","d2e413f0":"# EDA using Groupby","f5cc0d29":"# Correlation Plot","0a406500":"Using Pipeline","1d47792c":"# Statistical Summary******"}}