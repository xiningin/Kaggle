{"cell_type":{"1092ad44":"code","05d596fe":"code","f3096a84":"code","8c2384eb":"code","c8e9bcd9":"code","30c62583":"code","d9e4bbd6":"code","bb32e22b":"code","dcc39ccb":"code","b1b0fac5":"code","315e242f":"code","24838120":"code","a24471ed":"code","a67550d8":"code","d51a2f60":"code","4c640cbb":"code","f154beb4":"code","68af4d06":"code","6e1ddd74":"code","0b13818d":"markdown","8cd88349":"markdown","19970a43":"markdown"},"source":{"1092ad44":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","05d596fe":"train=pd.read_csv('..\/input\/train.csv')\ntest=pd.read_csv('..\/input\/test.csv')\nsample_submission=pd.read_csv('..\/input\/sample_submission.csv')","f3096a84":"print(train.shape,test.shape)","8c2384eb":"train.target.value_counts()*100\/train.shape[0]\\\n","c8e9bcd9":"train.isnull().sum().sort_values(ascending=False).head()","30c62583":"train.isnull().sum().sort_values(ascending=False).head()","d9e4bbd6":"weights={0:1,1:9}\ntarget = train[\"target\"]\ntrain = train.drop(columns=[\"ID_code\",\"target\"],axis=1)\ntest_df = test.drop(columns=[\"ID_code\"],axis=1)","bb32e22b":"from sklearn.model_selection import train_test_split,GridSearchCV\nx_train,x_test,y_train,y_test=train_test_split(train,target,test_size=0.2)","dcc39ccb":"from lightgbm import LGBMClassifier","b1b0fac5":"lgbm=LGBMClassifier(class_weight=weights)","315e242f":"param={'max_depth':[5,7,12],'n_estimators':[300,500],'learning_rate':[0.01,0.1,1,3],'num_leaves':[50,60]}","24838120":"gr=GridSearchCV(cv=5,estimator=lgbm,error_score='auc',n_jobs=16,verbose=True,param_grid=param)","a24471ed":"#gr.fit(x_train,y_train)","a67550d8":"gr.best_score_","d51a2f60":"gr.best_params_","4c640cbb":"pred_gr=gr.predict(x_test)","f154beb4":"from sklearn.metrics import accuracy_score,classification_report,confusion_matrix\nprint(accuracy_score(y_test,pred_gr))\nprint(confusion_matrix(y_test,pred_gr))\nprint(classification_report(y_test,pred_gr))","68af4d06":"pred_gr=gr.predict(test)","6e1ddd74":"sub_df_gr = pd.DataFrame({\"ID_code\":test[\"ID_code\"].values})\nsub_df_gr[\"target\"] = pred_gr\nsub_df_gr.to_csv(\"gr_pred.csv\", index=False)","0b13818d":"### Modelling","8cd88349":"## Good news! No null in train as well as test","19970a43":"## Imbalanced dataset"}}