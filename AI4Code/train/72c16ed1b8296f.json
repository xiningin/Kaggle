{"cell_type":{"e153849e":"code","bcc8d139":"code","5521095e":"code","91040339":"code","b4c2344a":"code","206d5200":"code","e244cfd1":"code","adeb7bb9":"code","be03807d":"code","8a787bb2":"code","7e86a597":"code","13bb7f4d":"code","7ca48fe3":"code","bff98f53":"code","12d5de2e":"code","443d2973":"code","f2751fe8":"code","d3f14381":"code","d73cdf65":"code","25448b0f":"code","bd3e3c41":"code","710c3d4c":"code","c74715d6":"code","f867fe52":"code","a9d725aa":"code","4775b24e":"code","115bc9ae":"code","581f3f3c":"code","ed6e09d9":"code","77eeea2a":"code","64d2664f":"code","ea2cf46c":"code","dd6d82ca":"code","f8007719":"code","3c603fb5":"code","747c64a6":"code","7e23783f":"code","c78be79f":"code","5bc27199":"code","59eb34de":"code","b2ed7e47":"code","b4353da0":"code","1ae1028b":"code","ba952d0d":"code","cec10d53":"code","b6fa0e23":"code","cae342ec":"code","937c0318":"code","a54129ae":"code","e592b233":"code","e77f8654":"code","8d2ad760":"code","d28125d3":"code","e93eab4c":"code","ebdfd6bf":"code","5a8bc526":"code","113fb359":"code","54a0b3ef":"code","3f533e06":"code","42b56faa":"code","7dbf714e":"code","f95ab29b":"code","9b1a25c1":"code","f1456274":"code","4aad594c":"code","2f84a3dc":"code","10101745":"code","c4a913e0":"code","88775670":"code","d9ee66b3":"code","86ea9b39":"code","879d1d22":"code","5f218eed":"code","a24ef0a8":"code","50d8133d":"code","881fa3d7":"code","3739ad74":"code","5ab7bc51":"code","73e26680":"code","cb598b02":"code","9f9d749c":"code","4765addd":"code","80858918":"markdown","ee4c4258":"markdown","c3fc5d8f":"markdown","46b0e7fa":"markdown","bf9e84f6":"markdown","ca382a1f":"markdown","e6262326":"markdown","6899e70c":"markdown","4dcbf2aa":"markdown","88742132":"markdown","242b2e52":"markdown","d53f6d12":"markdown","ebcfd4e9":"markdown","26269570":"markdown","baf403c3":"markdown","73c2656f":"markdown","756c9193":"markdown","40fb5e47":"markdown","90eebe77":"markdown","8006b936":"markdown","7540ce52":"markdown","d96b141e":"markdown","b89694b2":"markdown","07042bf2":"markdown","dc762b17":"markdown","13d66fd0":"markdown","1353fb83":"markdown","b2732f22":"markdown","749122de":"markdown","c0d00093":"markdown","861c140d":"markdown","95c72c19":"markdown","bdeffd3f":"markdown","b73e4917":"markdown","9a8a7e84":"markdown","6a838da7":"markdown","a6beade2":"markdown","9b156c14":"markdown","b94c9ced":"markdown","142c3902":"markdown","bca1d4e0":"markdown","6354b8b7":"markdown","90d1dc37":"markdown","a06587dc":"markdown","c6dec010":"markdown","02288af7":"markdown","85a36a86":"markdown","df5b4c24":"markdown","85aae895":"markdown"},"source":{"e153849e":"import numpy as np # we use numerical python for understanding the data in array form","bcc8d139":"import pandas as pd # we use pandas for work with data frames","5521095e":"import matplotlib.pyplot as plt # we use matplotlib for data visualization","91040339":"import seaborn as sns # we use seaborn for some other task and graphical measurnment ","b4c2344a":"import sklearn # we use sklearn for machine learning tasks","206d5200":"import zipfile","e244cfd1":"#fp = zipfile.ZipFile('insurance.zip')","adeb7bb9":"#fp.filelist","be03807d":"#fp.filelist[0].filename","8a787bb2":"df = pd.read_csv('..\/input\/insurance\/insurance.csv')  ","7e86a597":"df.shape","13bb7f4d":"df.info()","7ca48fe3":"df.describe()","bff98f53":"df.head()","12d5de2e":"df.tail()","443d2973":"df.isnull().sum()","f2751fe8":"df['sex'].value_counts()","d3f14381":"plt.figure(figsize=(14,8) ,dpi = 80 , facecolor='black')\ndf['sex'].value_counts().plot(kind='bar' ,color = ['yellow','cyan'] , width = 0.3 )\nplt.xlabel('Gender' , fontsize = 25 , color = 'cyan')\nplt.ylabel(' Total Male and Total Female ' , fontsize = 20 , color = 'cyan' )\ncount = 0\nfor i in df['sex'].value_counts():\n    plt.text(count-0.05 , i+11, i , fontsize = 12 , color = 'blue')\n    count+=1\nplt.xticks(fontsize = 25 , color = 'white')\nplt.yticks(fontsize = 20 , color = 'white')\nplt.show()","d73cdf65":"plt.figure(figsize=(5,4) , dpi = 100 , facecolor='cyan')\ndf['age'].value_counts().plot(kind='box')\nplt.xlabel('AGE' , fontsize = 15 , color = 'black')\nplt.yticks(color = 'black')\nplt.show()","25448b0f":"fig , (ax1 , ax2) = plt.subplots(1,2,dpi=150)\nax1.hist(df['age'] , bins = 10 , color = 'red', label = 'age' , ec = 'gold')\nax1.legend()\nax2.hist(df['bmi'] , bins = 15 , color = 'green' , label ='bmi' ,ec = 'gold')\nax2.legend()\nplt.show()","bd3e3c41":"fig , (ax1 , ax2) = plt.subplots(1,2,dpi=150)\nax1.hist(df['age'] , bins = 10 , color = 'red', label = 'age' , ec = 'gold')\nax1.legend()\nax2.scatter(df['age'] ,df['bmi'] , color = 'green' , label ='bmi' )\nax2.legend()\nplt.show()","710c3d4c":"fig , (ax1 , ax2) = plt.subplots(1,2,dpi=100)\nax1.hist(df['age'] , bins = 10 , color = 'blue', label = 'age' , ec = 'gold')\nax1.legend()\nax2.scatter(df['age'] ,df['smoker'] ,  color = 'cyan' , label ='bmi' )\nax2.legend()\nplt.show()","c74715d6":"df.corr()","f867fe52":"plt.figure(figsize=(8,6) , dpi = 100)\nsns.heatmap(df.corr(),annot = True,fmt=\".2f\" , cmap ='PiYG_r');","a9d725aa":"plt.figure(dpi=130)\nsns.scatterplot(df['bmi'] , df['charges'] , hue= df['sex'])","4775b24e":"plt.figure(dpi=120)\nsns.boxplot(x=df['charges'])","115bc9ae":"plt.figure(dpi = 100)\nplt.scatter(df['age'] , df['charges'])\nprint(np.corrcoef(df['age'],df['charges']))\nplt.show()","581f3f3c":"plt.figure(dpi=100)\ndf.hist(bins=30, ec='k', color = 'cyan' , figsize=(15, 10))\nplt.show()","ed6e09d9":"plt.figure(figsize=(6,5) , dpi = 100)\nsns.barplot(x = 'sex' , y ='charges' , data=df)","77eeea2a":"plt.figure(figsize=(16,5) , dpi = 150 , facecolor='salmon')\nplt.xticks(color = 'white' , fontsize = 15 , rotation = 90)\nplt.yticks(color = 'white' , fontsize = 15)\n\nsns.barplot(x = 'age' , y ='charges' , data=df  )\nplt.show()","64d2664f":" df['region'] = pd.Categorical(df['region'])\n","ea2cf46c":"df['smoker'] = pd.Categorical(df['smoker'])","dd6d82ca":"df['sex'] = pd.Categorical(df['sex'])","f8007719":"df_num = df.drop(['smoker','sex','region' ],axis=1)\n","3c603fb5":"df_num.head()","747c64a6":"df['region'].unique()","7e23783f":"df['smoker'].unique()","c78be79f":"df['sex'].unique()","5bc27199":"from sklearn.preprocessing import OrdinalEncoder","59eb34de":"df_cat = df[['smoker' , 'sex' , 'region']]\ndf_cat.head()","b2ed7e47":"ordinal_encoder = OrdinalEncoder()","b4353da0":"ordinal_encoder.fit(df_cat)","1ae1028b":"ordinal_encoder.categories_","ba952d0d":"df_cat_encoding = ordinal_encoder.transform(df_cat)","cec10d53":"df_cat_encoding","b6fa0e23":"df_cat.head()","cae342ec":"from sklearn import preprocessing\nlabel_encoder = preprocessing.LabelEncoder()","937c0318":"df[\"sex\"] = label_encoder.fit_transform(df[\"sex\"])\ndf[\"smoker\"] = label_encoder.fit_transform(df[\"smoker\"])\ndf[\"region\"] = label_encoder.fit_transform(df[\"region\"])","a54129ae":"df.info()","e592b233":"df.corr()","e77f8654":"df[['sex']]","8d2ad760":"plt.figure(dpi=150)\nsns.heatmap(df.corr() , cmap = 'Set1_r' , alpha = 0.9)","d28125d3":"plt.figure(dpi=150)\ndf.hist(bins=30, ec='k', color = 'salmon' , figsize=(15, 10))\nplt.show()","e93eab4c":"\nsns.swarmplot(x=df['smoker'],\n              y=df['charges'] )\nplt.xticks(fontsize = 15)\n\n#HERE\n# 0 mean NO\n# 1 MEANS YES","ebdfd6bf":"plt.figure(dpi = 150)\nsns.scatterplot(x=df['bmi'], y=df['charges'], hue=df['smoker'])\nplt.show()","5a8bc526":"plt.figure(dpi = 150)\nsns.scatterplot(x=df['age'], y=df['charges'], hue=df['smoker'])\nplt.show()","113fb359":"from sklearn.model_selection import train_test_split\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom sklearn.preprocessing import StandardScaler\n","54a0b3ef":"#select features and lables\nx = df.drop(['charges'], axis = 1)\ny = df['charges']\n","3f533e06":"x.head()","42b56faa":"y.head()","7dbf714e":"#split train and Testing\nfrom sklearn.model_selection import train_test_split \nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.1, random_state=42)","f95ab29b":"x_train # data of train set in x ","9b1a25c1":"x_test # data of test set in x ","f1456274":"y_train # data of train set in y ","4aad594c":"y_test # data of test set in y","2f84a3dc":"x_train.shape","10101745":"x_test.shape","c4a913e0":"corr_matrix = df.corr()\ncorr_matrix['charges'].sort_values(ascending=False)\n","88775670":"df[['smoker']].hist(bins = 40 , ec = 'gold')","d9ee66b3":"from sklearn.model_selection import StratifiedShuffleSplit","86ea9b39":"df['age_cat'] = pd.cut( df['age'],\nbins = [ 0, 18 , 28 , 38 , 48, 58 , 68, 78, 88, np.inf],\nlabels = [18, 2, 3, 4, 5,6,7,8,9])\n","879d1d22":"#Linear regression algorithm\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn import metrics","5f218eed":"# we will remove the column \"region\" because it is not necesaary\ndf.drop([\"region\"],axis=1,inplace=True)","a24ef0a8":"# dividing the dataset into attributes and label\nx1 = df.iloc[:,0:-1].values\ny1 = df.iloc[:, -1].values\n","50d8133d":"print(x)","881fa3d7":"print(y)","3739ad74":"from sklearn.preprocessing import StandardScaler\nsc_X = StandardScaler()\nsc_y = StandardScaler()\nx1 = sc_X.fit_transform(x)\n","5ab7bc51":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test = train_test_split(x1,y1,test_size=0.2,random_state=42)","73e26680":"Lin_reg = LinearRegression()","cb598b02":"# training the data\nfrom sklearn.linear_model import LinearRegression\nlr = LinearRegression()\nlr.fit(x_train,y_train)","9f9d749c":"#predicting\ny_pred = lr.predict(x_test)","4765addd":"# we will calculate Mean Absolute error\nfrom sklearn import metrics\nmae = metrics.mean_absolute_error(y_test,y_pred)\nprint('Mean Absolute Error:',mae)","80858918":"` in this we see that the person those do smoking have more chance to get high value insurance carges with same BMI index `","ee4c4258":" ${\\text{ WE   CONSIDER}}$  $\\color{red}{\\text{CHARGES}}$${\\text{  AS  LABEL  IN  DATA SET }} $","c3fc5d8f":"# `Above information tell us the columns details and information`\n    In this three coulns are of object type --\n    1. sex\n    2. region\n    3. smoker\n    \n    Remaing columns of Int and float types\n    \n    1.Age\n    2.BMI\n    3.Charges\n    4.Children","46b0e7fa":"from ordinal encoder we cant get proper result so i used label encoding","bf9e84f6":"`Get The Data`","ca382a1f":"###  `Describe function is the important function in this we have see all the stastical part here. `\n###  `In this quartile function also split and publised clearly`\n### `25 percent , 50 percent , 75 percent is the three quartile range of it.`\n### `mean position is always consider as a average of any data set of different features`\n### `count function is here represent the total number of attributes of their coloumn`\n \n ","e6262326":"# $\\color{Red}{\\text{ 3rd Step}}$","6899e70c":"# ....................... `HIST AND BAR GRAPH BTWN AGE AND BMI `.................","4dcbf2aa":"NOTE - In this step we import zipfile and download the data from kaggle","88742132":"load the csv data and name as df","242b2e52":"# `Head function show the top 5 rows by default`\n\nyou can see any number also by passing parameter also - like head(20) - in this 20 top row will visible","d53f6d12":"## $\\color{green}{\\text{we have to Study what the Data about and look at the picture and plan the process for solutions}}$","ebcfd4e9":"`In this we see that the person those do smoking have more chance to get high value insurance carges`","26269570":"# For Splitting the Training and Testing Data","baf403c3":"` EDA AND PREPARATION OF DATA ` ","73c2656f":"` Data Analysis and Data Visualisation part `","756c9193":"`IMPORT LIBRARIES`","40fb5e47":"# `CORRELATION GRAPH `","90eebe77":"## MEDICAL  INSURANCE -  DATA ANAlYSIS AND MACHINE LEARNING TECHNIQUES","8006b936":"`Select the Model and Train it `","7540ce52":"# $\\color{red}{\\text{FEW MAJOR STEPS TO DO WITH THIS TASK}}$\n#### 1. Import Libraries\n#### 2. Get the data\n#### 3. Discover and Visualize the data to gain insights\n#### 4. Prepare the data for Machine Learning algorithms\n#### 5. Select a model and train it\n#### 6. Fine-tune your model\n","d96b141e":"# ....................... `HIST GRAPH BTWN AGE AND BMI `.................","b89694b2":"# $\\color{Red}{\\text{1st Step }}$","07042bf2":"# $\\color{red}{\\text{Some Histogram Plot with Corelations}}$","dc762b17":"# `In this we have to seen the relaion of diiferent attributs which each other`\n## ` But this data is only for numerical values`","13d66fd0":"  this column tell us the shape of data df","1353fb83":"# $\\color{Red}{\\text{ 5th Step}}$","b2732f22":"### WE HAVE TO IMPORT LIBRARIES FOR MACHINE LEARNING MODEL FROM SKLERN \n\n### TRAIN AND TEST DATA SPLIT - WE USE train_test_split\n\n### FOR REGRESSION - WE USE LINERA REGRESSION MODEL\n\n### MEAN SSQUARE ERROR FOR FINDIND THE ERROR","749122de":"# `BOXPLOT`","c0d00093":"## ` IN THIS WE SEE THAT SOME DATA HAVE HIGH VALUES BUT MOST OF THE DATA CHARGES IS IN RANGE OF 10K TO 20 K ONLY`","861c140d":"# $\\color{Red}{\\text{ 2nd Step}}$","95c72c19":"# $ \\color{red}{\\text{.......................we have to find correlation now....................... }} $","bdeffd3f":"Kaggle Link - https:\/\/www.kaggle.com\/mirichoi0218\/insurance\n\n-----DOWNLOADED THE DATA IN ZIP FILE---- ","b73e4917":"# $\\color{Red}{\\text{ 4rth Step}}$","9a8a7e84":" `In this we only see numerical data types value and we have to decide our important columns and features`","6a838da7":"# Split data into x and y","a6beade2":" this is very informative part in this we have to understand the information given by data","9b156c14":"## $\\color{red}{\\text {............................ 1ST IMPORTANT THING DO BEFORE START ............................ }}$","b94c9ced":"# Now data change so we will see final correlation of different data","142c3902":"## In above graph , using pandas function with matplotlib visualitaion \n## This is the bar graph between Male and Female , total number of Male and Female","bca1d4e0":"## `This graph shown us the scatter plot between bmi and charges and you see clearly that both male and female have a insurance range in 10k to 20 k`","6354b8b7":"##  ` This is the very important step in this we have  seen null values ` \n## ` null values is always a worry point for the dataset`\n### `Fortunately we dont have any null values in this data`","90d1dc37":"# `Some Histogram Data plot`","a06587dc":"## $ {\\text{IN THIS WE FIND THAT NOW}}$ $ \\color{red}{\\text {SMOKER IS THE HIGHERST CORRELATION WITH OUR LABEL }}$","c6dec010":"## CONCLUSION --- This is the Dataset Named Insurance Prediction in this we have do Analysis \n\n## ERROR - MEAN ABSOLUTE ERROR ----- 0.18\n\n## PERCENTAGE = 18%\n\n## SO ACURRACY = 100 - ERROR \n\n## 100 - 18 = 72 % = ACCURACY","02288af7":"`This is the box plot in this we seen some outlier duw to which this data is skewd up side`","85a36a86":"# `Tail function show the bottom 5 rows by default`\n\nyou can see any number also by passing parameter also - like tail(20) - in this 20 bottom row will visible","df5b4c24":"# `IN THIS AGE AND CHARGES HAVE 29 PERCENT IMPACT ON EACH OTHER ...... ITS A POSITIVE CORELATION`","85aae895":"$ \\color{red}{\\text{************** NOW WE HAVE PLAY WITH CATAGORICAL COLUMNS*****************}}$"}}