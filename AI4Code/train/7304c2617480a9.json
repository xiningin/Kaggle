{"cell_type":{"a0385932":"code","afeed79f":"code","e01c69d9":"code","ab36a01b":"code","a8032d9d":"code","2a384132":"code","4b7dff35":"code","b8ade15d":"code","43c745f9":"code","5673b760":"code","a5f979b9":"code","2bdc349f":"code","c5fda9d1":"markdown","5220b7c7":"markdown","c87473a0":"markdown","e4af63b5":"markdown","64ccc4f1":"markdown","79db47e7":"markdown","7f4d0ae0":"markdown","2a238469":"markdown","58128d71":"markdown","7ac63776":"markdown","4ed292a8":"markdown","0415b979":"markdown"},"source":{"a0385932":"# Imports\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport datetime\n\n# Plotly\nimport chart_studio.plotly as py\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport colorlover as cl\nfrom plotly.subplots import make_subplots\n\n# Colors\n#maroon = rgb(128,0,0)\n#chocolate = rgb(210,105,30)\n#sky blue = rgb(135,206,235)\n#olive drab = rgb(107,142,35)\n#steel blue = rgb(70,130,180)","afeed79f":"# Read the data\ndata = pd.read_csv(\"..\/input\/climate-change-earth-surface-temperature-data\/GlobalTemperatures.csv\")\ndata.head(2)\n\n# Make a copy of the data for future graphs\ncopy = data.copy()\n\n# Missing values\ndata.isna().sum() # there are 1200 missing values for Max, Min and Land&Ocean Average Temp\nplt.figure(figsize = (16, 3))\nsns.heatmap(data.isna())","e01c69d9":"# Missing data with listwise deletion\n# Because data is missing in chucks and we are dealing with time series data, we will delete all rows that have at least \n# one missing value.\n\ndata.dropna(axis = 0, inplace = True)\n\n\n# Dealing with the DATE\ndata['Date'] = pd.to_datetime(data.dt) # converted all dates to the same format\n\ndata2 = data.copy() # create a new dataset\ndata2.drop(columns = ['dt'], axis = 1, inplace = True) # drop the dt column\n\n# Creating new features\ndata2['day'] = data2['Date'].dt.day\ndata2['week'] = data2['Date'].dt.week\ndata2['month'] = data2['Date'].dt.month\ndata2['year'] = data2['Date'].dt.year\n\n# Week data is not evenly distributed\ndata2['week'].value_counts() # very uneven information on weeks\n\n# For future analysis, we will work only on yearly data, as average (because there are dates missing and data is not consistent)\nearth_data = data2.groupby(by = 'year')[['LandAverageTemperature', 'LandAverageTemperatureUncertainty',\n       'LandMaxTemperature', 'LandMaxTemperatureUncertainty',\n       'LandMinTemperature', 'LandMinTemperatureUncertainty',\n       'LandAndOceanAverageTemperature',\n       'LandAndOceanAverageTemperatureUncertainty']].mean().reset_index()\n\nearth_data['turnpoint'] = np.where(earth_data['year'] <= 1975, 'before', 'after') # creating a new columns\nearth_data.head(2)","ab36a01b":"# Simple Summary Statistics\nearth_data[['LandAverageTemperature', 'LandMaxTemperature', \n       'LandMinTemperature', 'LandAndOceanAverageTemperature']].describe()","a8032d9d":"# Creating the dataset - using copy\ncopy['Date'] = pd.to_datetime(copy.dt)\ncopy['year'] = copy['Date'].dt.year\nland_avg = copy.groupby('year')['LandAverageTemperature', 'LandAverageTemperatureUncertainty'].mean().reset_index()\n\n# Creating the graph\nfig = go.Figure()\nfig.update_layout(title=\"Land Average Temperature: 1750-2010\", title_font_size = 20,\n                  font=dict( family=\"Courier New, monospace\", size=12,color=\"#7f7f7f\"),\n                  template = \"ggplot2\", hovermode= 'closest')\nfig.update_xaxes(showline=True, linewidth=1, linecolor='gray')\nfig.update_yaxes(showline=True, linewidth=1, linecolor='gray')\n\nfig.add_trace(go.Scatter(x = land_avg['year'], y = land_avg['LandAverageTemperature'], mode = 'lines',\n                        name = 'Land Avg Temp', marker_color='rgb(128, 0, 0)'))\n\nfig.add_trace(go.Scatter(x = land_avg['year'], y = land_avg['LandAverageTemperatureUncertainty'], mode = 'lines',\n                        name = 'Land Avg Temp Error', marker_color = 'rgb(107,142,35)'))","2a384132":"# Figure layout\nfig = make_subplots(rows=2, cols=2, insets=[{'cell': (1,1), 'l': 0.7, 'b': 0.3}])\nfig.update_layout(title=\"When Global Warming Started?\",font=dict( family=\"Courier New, monospace\", size=12,color=\"#7f7f7f\"),\n                 template = \"ggplot2\", title_font_size = 20, hovermode= 'closest')\nfig.update_xaxes(showline=True, linewidth=1, linecolor='gray')\nfig.update_yaxes(showline=True, linewidth=1, linecolor='gray')\n\n# Figure data\nfig.add_trace(go.Scatter(x = earth_data['year'], y = earth_data['LandAverageTemperature'], mode = 'lines',\n                        name = 'Land Avg Temp', marker_color='rgb(128, 0, 0)'), row = 1, col = 1)\nfig.add_trace(go.Scatter( x=[1975, 1975], y=[7.5, 10], mode=\"lines\",line=go.scatter.Line(color=\"gray\"), showlegend=False),\n             row = 1, col = 1)\n#=============================================================================\nfig.add_trace(go.Scatter(x = earth_data['year'], y = earth_data['LandMinTemperature'], mode = 'lines',\n                        name = 'Land Min Temp', marker_color='rgb(210,105,30)'), row = 1, col = 2)\nfig.add_trace(go.Scatter( x=[1975, 1975], y=[1.5, 4.5], mode=\"lines\",line=go.scatter.Line(color=\"gray\"), showlegend=False),\n             row = 1, col = 2)\n#=============================================================================\nfig.add_trace(go.Scatter(x = earth_data['year'], y = earth_data['LandMaxTemperature'], mode = 'lines',\n                        name = 'Land Max Temp', marker_color='rgb(135,206,235)'), row = 2, col = 1)\nfig.add_trace(go.Scatter( x=[1975, 1975], y=[13, 15.5], mode=\"lines\",line=go.scatter.Line(color=\"gray\"), showlegend=False),\n             row = 2, col = 1)\n#=============================================================================\nfig.add_trace(go.Scatter(x = earth_data['year'], y = earth_data['LandAndOceanAverageTemperature'], mode = 'lines',\n                        name = 'Land&Ocean Avg Temp', marker_color='rgb(107,142,35)'), row = 2, col = 2)\nfig.add_trace(go.Scatter( x=[1975, 1975], y=[14.5, 16], mode=\"lines\",line=go.scatter.Line(color=\"gray\"), showlegend=False),\n             row = 2, col = 2)","4b7dff35":"# Change in average temperature before\/after 1975\n\n# Figure layout\nfig = make_subplots(rows=2, cols=2, insets=[{'cell': (1,1), 'l': 0.7, 'b': 0.3}])\nfig.update_layout(title=\"Average Temperatures before and after 1975\",font=dict( family=\"Courier New, monospace\", size=12,color=\"#7f7f7f\"),\n                 template = \"ggplot2\", title_font_size = 20, hovermode= 'closest')\n\n# Figure data\nfig.add_trace(go.Box(x = earth_data['LandAverageTemperature'], y = earth_data['turnpoint'],boxpoints = 'all',jitter = 0.3, \n                     pointpos = -1.6, marker_color = 'rgb(128, 0, 0)', boxmean = True, name = 'Land Avg Temp'),\n             row = 1, col = 1)\nfig.add_trace(go.Box(x = earth_data['LandMinTemperature'], y = earth_data['turnpoint'],boxpoints = 'all',jitter = 0.3, \n                     pointpos = -1.6, marker_color = 'rgb(210,105,30)', boxmean = True, name = 'Land Min Temp'),\n             row = 1, col = 2)\nfig.add_trace(go.Box(x = earth_data['LandMaxTemperature'], y = earth_data['turnpoint'],boxpoints = 'all',jitter = 0.3, \n                     pointpos = -1.6, marker_color = 'rgb(135,206,235)', boxmean = True, name = 'Land Max Temp'),\n             row = 2, col = 1)\nfig.add_trace(go.Box(x = earth_data['LandAndOceanAverageTemperature'], y = earth_data['turnpoint'], boxpoints = 'all',jitter = 0.3, \n                     pointpos = -1.6, marker_color = 'rgb(107,142,35)', boxmean = True, name = 'Land&Ocean Avg Temp'),\n             row = 2, col = 2)\n\n\nfig.update_traces(orientation='h')","b8ade15d":"# Read the file (countries + cities)\ncountries = pd.read_csv(\"..\/input\/climate-change-earth-surface-temperature-data\/GlobalLandTemperaturesByCity.csv\")\n\n# Because the file is very big and there are many dates missing (like the last file), we will group by year\n# create column year\ncountries['Date'] = pd.to_datetime(countries['dt'])\ncountries['year'] = countries['Date'].dt.year\n\n# Group by year\nby_year = countries.groupby(by = ['year', 'City', 'Country', 'Latitude', 'Longitude']).mean().reset_index()\n\n# Append the continent & iso codes\ncontinent_map = pd.read_csv(\"..\/input\/country-mapping-iso-continent-region\/continents2.csv\")\ncontinent_map['Country'] = continent_map['name']\ncontinent_map = continent_map[['Country', 'region', 'alpha-2', 'alpha-3']]\n\n# Add information\ndata = pd.merge(left = by_year, right = continent_map, on = 'Country', how = 'left')\n\n# Filter starting 1825 - because some countries weren't monitored before this year on some periods, \n# the mean overall could be quite misleading (example: Americas have an increase from 1821 to 1825 of 5 points in temperature,\n# but this happens only because in 1824 data for South America started to be collected)\ndata = data[data['year'] >= 1825]\n\n# Datasets:\n\nregion = data.dropna(axis = 0).groupby(by = ['region', 'year']).mean().reset_index()\ncountries = data.dropna(axis = 0).groupby(by = ['region', 'Country', 'year']).mean().reset_index()\ncities = data.dropna(axis = 0).groupby(by = ['region', 'Country', 'City', 'year', 'Latitude', 'Longitude']).mean().reset_index()","43c745f9":"# Figure layout\nfig = make_subplots(rows=1, cols=2, insets=[{'cell': (1,1), 'l': 0.7, 'b': 0.3}])\nfig.update_layout(title=\"Continents increase in Average Temperature\", title_font_size = 20,\n                  font=dict( family=\"Courier New, monospace\", size=12,color=\"#7f7f7f\"),\n                  template = \"ggplot2\", hovermode= 'closest')\nfig.update_xaxes(showline=True, linewidth=1, linecolor='gray')\nfig.update_yaxes(showline=True, linewidth=1, linecolor='gray')\n\n#============================= Scatter =============================\nfig.add_trace(go.Scatter(x = region[region['region'] == 'Europe']['year'], y = region[region['region'] == 'Europe']['AverageTemperature'], mode = 'lines',\n                        name = 'Europe', marker_color='rgb(128, 0, 0)'), row = 1, col = 1)\nfig.add_trace(go.Scatter(x = region[region['region'] == 'Americas']['year'], y = region[region['region'] == 'Americas']['AverageTemperature'], mode = 'lines',\n                        name = 'Americas', marker_color='rgb(210,105,30)'), row = 1, col = 1)\nfig.add_trace(go.Scatter(x = region[region['region'] == 'Asia']['year'], y = region[region['region'] == 'Asia']['AverageTemperature'], mode = 'lines',\n                        name = 'Asia', marker_color='rgb(135,206,235)'), row = 1, col = 1)\nfig.add_trace(go.Scatter(x = region[region['region'] == 'Africa']['year'], y = region[region['region'] == 'Africa']['AverageTemperature'], mode = 'lines',\n                        name = 'Africa', marker_color='rgb(107,142,35)'), row = 1, col = 1)\nfig.add_trace(go.Scatter(x = region[region['region'] == 'Oceania']['year'], y = region[region['region'] == 'Oceania']['AverageTemperature'], mode = 'lines',\n                        name = 'Oceania', marker_color='rgb(70,130,180)'), row = 1, col = 1)\n\n#============================= Bar =============================\ny1 = np.round(region.groupby(by = 'region')['AverageTemperature'].mean().tolist(), 1)\ny2 = np.round(region.groupby(by = 'region')['AverageTemperature'].max().tolist(), 1)\n\nfig.add_trace(go.Bar(x = region['region'].unique(), y = region.groupby(by = 'region')['AverageTemperature'].mean().tolist(), \n                     name = 'Mean Temp', marker_color = 'rgb(188,143,143)', text = y1, textposition = 'auto'),\n              row = 1, col = 2)\nfig.add_trace(go.Bar(x = region['region'].unique(), y = region.groupby(by = 'region')['AverageTemperature'].max().tolist(), \n                     name = 'Max Temp', marker_color = 'rgb(222,184,135)', text = y2, textposition = 'auto'),\n              row = 1, col = 2)","5673b760":"# Data\nmean = countries.groupby(['Country', 'region'])['AverageTemperature'].mean().reset_index()\nmaximum = countries.groupby(['Country', 'region'])['AverageTemperature'].max().reset_index()\n\ndifference = pd.merge(left = mean, right = maximum, on = ['Country', 'region'])\ndifference['diff'] = difference['AverageTemperature_y'] - difference['AverageTemperature_x']\n\n# Graph\nfig = go.Figure()\nfig.update_layout(title=\"Difference in Temperature (Countries)\", title_font_size = 20,\n                  font=dict( family=\"Courier New, monospace\", size=13,color=\"#7f7f7f\"),\n                  template = \"ggplot2\", autosize = False, height = 3500, width = 750)\nfig.update_xaxes(showline=True, linewidth=1, linecolor='gray')\nfig.update_yaxes(showline=True, linewidth=1, linecolor='gray')\n\nsort_diff = difference[['Country', 'region', 'diff']].sort_values(by = 'diff', ascending = True)\nfig.add_trace(go.Bar(x = sort_diff['diff'], y = sort_diff['Country'], orientation = 'h',\n                    marker=dict(color='rgb(222,184,135)', line=dict( color='rgb(188,143,143)', width=0.6))))\nfig.show()","a5f979b9":"# Data - we need iso alpha-3 codes\nmap_countries = data.dropna(axis = 0).groupby(by = ['region', 'Country', 'year','alpha-3']).mean().reset_index()\n\n# Min temperature is -5.453083, and because the size in a map cannot be negative, we will add 6 to all temperatures\n# to \"standardize the data\"\nmap_countries['AverageTemperature'] = map_countries['AverageTemperature'] + 6\n\nfig = px.scatter_geo(map_countries, locations='alpha-3', color='region',\n                     color_discrete_sequence = ('rgb(128,0,0)','rgb(210,105,30)','rgb(135,206,235)','rgb(107,142,35)'),\n                     hover_name=\"Country\", size=\"AverageTemperature\", size_max=15, opacity = 0.8,\n                     animation_frame=\"year\",\n                     projection=\"natural earth\", title='Interactive Globe Map - Temperature increase')\nfig.show()","2bdc349f":"# Calculating the difference column\nmean = map_countries.groupby(['region','Country','alpha-3'])['AverageTemperature'].mean().reset_index()\nmaximum = map_countries.groupby(['region','Country','alpha-3'])['AverageTemperature'].max().reset_index()\ndifference = pd.merge(left = mean, right = maximum, on = ['region','Country','alpha-3'])\ndifference['diff'] = difference['AverageTemperature_y'] - difference['AverageTemperature_x']\ndifference.rename(columns = {'AverageTemperature_y':'Maximum Average Temperature',\n                             'AverageTemperature_y':'Overall Avg Temp'}, inplace = True)\n\n# Figure\nfig = px.scatter_geo(difference, locations=\"alpha-3\", color=\"Overall Avg Temp\", #we color by average temp\n                     hover_name=\"Country\", size=\"diff\", size_max=15, #we size by how big is the difference\n                     projection=\"natural earth\", opacity = 0.8,\n                     color_continuous_scale=('#283747', '#2874A6', '#3498DB', '#F5B041', '#E67E22', '#A93226'),\n                     title = 'Global Map - difference between the mean and max temperatures')\nfig.show()","c5fda9d1":"# End thoughts\n\n**So we can see the hotspots around the world when this trend of increasing carbon pollution coincides with the increasing median temperatures.The data also show the trend of where this will all lead to if not addressed so I hope this detailed analysis is enough for the climate change naysayers to come to grounds with reality and make sustainable changes**\n\n","5220b7c7":"### II. Countries rank - from the biggest to smallest increase in temperature since 1825\n\nNow, this is interesting:\n* **Brazil and Argentina** - BIG deforestation issues (their wildfires have increased big time and the agriculture is the main factor)\n* **Kazakhstan** - place for testing biological and nuclear weapons by the soviets. Also, here are located the most polluting industries. Most of their water is infected by industrial and agricultural runoff and it is in some places radioactivity. (http:\/\/factsanddetails.com\/central-asia\/Kazakhstan\/sub8_4f\/entry-4681.html)\n* **Turkmenistan** - Desertification and drying of the Aral Sea, due to HEAVY agricultural practices. (https:\/\/en.wikipedia.org\/wiki\/Environmental_issues_in_Turkmenistan)\n* **Nepal** - Air Pollution. 1 in 10 Nepalese suffer from chronic lung problem, and the life expectancy of a new born is shorter by 2 years due solely to problems air quality related. (https:\/\/www.nepalitimes.com\/here-now\/air-pollution-is-more-dangerous-than-smoking\/)","c87473a0":"### III. Change in Average Temperature before\/after 1975 - cold is hotter?\n\n1975 was a \"no turning back\" point, so I chose this moment to compare temperatures before and after.\n\n* `Land Average Temperature` - an **increase** from 8.37 degrees to 9.20; almost 1 full grade\n* `Land Minimum Temperatures` - an **increase** from 2.45 degrees to 3.64; 1.19 grades increase\n* `Land Maximum Temperature` - an **increase** from 14.18 degrees to 14.89; 0.71 grades increase\n* `Land and Ocean Average Temperature` - an **increase** from 15.06 degrees to 15.62; 0.56 grades increase","e4af63b5":"### II. When did Global Warming Started?\n\nThe increase on all levels, in both land and ocean almost mirror one another. No doubt the Industrial Revolution had an effect between 1900 and 1975, but combining with the **population increase** that started to surge somewhere in 1975 (from ~2.5 bil in 1950 to 5 bil in 2000) created a much bigger **negative contribution** to the overall global warming state. ","64ccc4f1":"## 2.1 Plotly\n\n### I. Continents Increase in Average Temperature\nThere are some variations at the beginning of the period, mainly due to a fluctuation in the gathering of data (there are some countries where there is info in some years and some years there is not).\n\nAnyhow, all continents look to have increased in `Temperature` in about the same pace.","79db47e7":"# 2. Data on Geographical View\n\nLet's look at the countries now.","7f4d0ae0":"# 1. Data on years - overall land and ocean temperature change\n1. Reading the data\n2. Handling Missing data\n3. Create new features (day, month, year etc.)\n4. Analysing distribution of data in time to assess how to better analyse the numbers","2a238469":"## 1.2 Graphs\n\n### I. Land Average Temperature from 1750 to 2010\n\n`Land Average Temperature` had a steady increase: quite flat variation until mid 1800, and then started to increase slowly (when the first **Industrial Revolution** ended, and the effects were starting to show up on the environment). Somewhere in the 1970s the growth started to accelerate. The 1970s mark an increasing trend in **machine automation**, meaning a bust in foreign trading, so the **production started to surge**.","58128d71":"## 2.2 Plotly Maps\n\n### I. Interactive Globe Map - Temperature increase over the years\n\nFirst years have some fluctuations due to absence of data for some nations, but the biggest increases are visible in Europe, South America and West Asia.","7ac63776":"## 1.1 Summary Statistics 1850-2010\n\nSome very simple summary; we have a total of `166` observations. Now we'll go into visualisations, to finally get some insights.","4ed292a8":"![Image](https:\/\/static.scientificamerican.com\/sciam\/cache\/file\/95E0A1A6-5BCA-4F0F-BB92D65F2DD8FB0D_source.jpg?w=590&h=800&EC196A4A-853F-4989-B1CE0AF77333D7CD)\n# Introduction\n\nThe bush fires in Australia in 2020,fires in California,Siberia,more recently the floods in Germany along with the COVID pandemic,everything is not fine with our planet,so lets investigate how rising levels of CO2 has affected various countries and what is its correlation with the increasing median Temperatures and subsequently climate change.\n\n1. What is Climate Change?\n    * change in climate patterns\n    * started at beginning of 20th Century with industrial revolution.\n    * Happening due to increased levels of atmospheric carbon dioxide created by burning use of fossil fuels\n\n\n2. Effects:\n    * Increase in median surface temperatures.\n    * Increase in ocean levels due to faster melting of glaciers and polar ice caps\n    * shifts in seasons and local weather patterns\n    * extreme weather events like those mentioned above\n\n\n3. Questions and Investigation performed here:\n    * How much has the world increased in temperature?\n    * Where are the biggest increases?\n    * How is it related to carbon dioxide pollution.","0415b979":"### II. Globe Map - difference between the mean and maximum temperature\n\n* the bubbles - `countries`\n* the COLOR of the bubbles - the `mean temperature`\n* the size of the bubbles - how much the temperature increased?\n\nWhat do we see? The biggest temperature changes were in Europe and South America.\n\nThere is again the question, as we see that more colder countries (situated to the North) had a biggest increase in Temperature than the overall South, why is this happening?\n"}}