{"cell_type":{"0dd3b71b":"code","9acc0d7c":"code","988f72e0":"code","fb645c3f":"code","615637b8":"code","f00da1a7":"code","091c7e89":"code","a040628b":"code","c23b3ea3":"code","0b957ad3":"code","947d7285":"code","1ef97780":"code","d88fc9cb":"code","4a9f151e":"code","c3094370":"code","82200aa6":"code","dc32d108":"code","af0c2906":"code","80a7a555":"code","8aa9dd0e":"code","e6079e05":"code","073aedbb":"code","31c8df33":"code","fe6a3eb6":"code","d52dfbbe":"code","03ed46c3":"code","64244d18":"code","5add9782":"code","b50952e5":"code","5779166c":"code","69d8a6d7":"code","8f46a2a1":"code","d00d20b6":"code","7cc123a6":"code","527904e1":"code","5d1af2d9":"code","8394203b":"code","6b7507f9":"code","e2994e3b":"code","7cee09d6":"code","17ad8f8c":"code","7e5f182c":"markdown","b045573f":"markdown","ee869009":"markdown","70f97791":"markdown","1f9c1424":"markdown","42e3d4c4":"markdown","d2a12efb":"markdown","9f1bacdd":"markdown","8cb3edb9":"markdown","e2275141":"markdown","4d121661":"markdown","7de032a2":"markdown","4f7e9d68":"markdown","19e52372":"markdown","c5076c02":"markdown","b2572ff8":"markdown","2ace2768":"markdown","9e5c386a":"markdown"},"source":{"0dd3b71b":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","9acc0d7c":"tran=pd.read_csv('..\/input\/petfinder-pawpularity-score\/train.csv')\ntest=pd.read_csv('..\/input\/petfinder-pawpularity-score\/test.csv')","988f72e0":"tran.head()","fb645c3f":"tran.columns","615637b8":"test.columns","f00da1a7":"column=[col for col in tran.columns if col not in ['Id','Pawpularity']]","091c7e89":"x=tran[column]\ny=tran['Pawpularity']","a040628b":"print(x.shape,y.shape,test.shape)","c23b3ea3":"test_id=test['Id']\ntest=test.drop('Id',axis=1)\ntest.shape","0b957ad3":"tran.isnull().any()","947d7285":"test.isnull().any()","1ef97780":"tran.drop('Id',axis=1,inplace=True)","d88fc9cb":"tran_matrix=tran.corr()\nplt.figure(figsize=(10,8))\nsns.heatmap(tran_matrix,linewidth=0.1,linecolor='white',annot=True,cmap='Pastel1',fmt='.2f')\nplt.show()","4a9f151e":"feature_variables=x.columns\ntarget_variable='Pawpularity'","c3094370":"from sklearn.decomposition import PCA\npca=PCA(n_components=2,random_state=42)\npca=pca.fit_transform(x)","82200aa6":"plt.figure(figsize=(8,7))\nplt.scatter(pca[:,0],pca[:,1],color='red')\nplt.show()","dc32d108":"plt.hist(y,bins=10)\nplt.show()","af0c2906":"from sklearn.model_selection import KFold\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import train_test_split,GridSearchCV\nimport tensorflow as tf","80a7a555":"mm=MinMaxScaler()","8aa9dd0e":"y_ss=y.values.reshape((-1,1))","e6079e05":"y_mm=mm.fit_transform(y_ss)","073aedbb":"print(y_mm.mean(),y_mm.max(),y_mm.min())","31c8df33":"pd.DataFrame(y_mm).head()","fe6a3eb6":"print(x.shape,y_mm.shape)","d52dfbbe":"x_mm=x.copy()","03ed46c3":"x_mm=np.array(x_mm).reshape(-1,8,x_mm.shape[1])\ny_mm=np.array(y_mm).reshape(-1,8)","64244d18":"xtrain,xtest,ytrain,ytest=train_test_split(x_mm,y_mm,random_state=42,test_size=0.2)","5add9782":"print(xtrain.shape,ytrain.shape)","b50952e5":"model=tf.keras.models.Sequential([\n    tf.keras.layers.Input(shape=(8,12)),\n    tf.keras.layers.Dense(128,activation='relu'),\n      tf.keras.layers.Dense(64,activation='relu'),\n      tf.keras.layers.Dense(128,activation='relu'),\n      tf.keras.layers.Dense(1)\n])\n\nmodel.compile(loss='mse',optimizer=tf.keras.optimizers.Adam(learning_rate=0.01),\n             metrics=['mse'])\nhst=model.fit(xtrain,ytrain,\n             epochs=100,validation_data=(xtest,ytest))","5779166c":"hst.history.keys()","69d8a6d7":"plt.plot(hst.history['loss'],label='Train_loss')\nplt.plot(hst.history['val_loss'],label='Val_loss')\nplt.legend()\nplt.show()","8f46a2a1":"plt.plot(hst.history['mse'],label='Train_mse')\nplt.plot(hst.history['val_mse'],label='Val_mse')\nplt.legend()\nplt.show()","d00d20b6":"np.mean(hst.history['mse'])","7cc123a6":"test=np.array(test).reshape(-1,8,test.shape[1])","527904e1":"sub=model.predict(test)","5d1af2d9":"sub=sub.reshape(-1,1)","8394203b":"sub.shape","6b7507f9":"sub=mm.inverse_transform(sub)","e2994e3b":"submission=pd.DataFrame(sub,columns=['Pawpularity'])\nsubmission=pd.concat([test_id,submission],axis=1)\n","7cee09d6":"submission","17ad8f8c":"submission.to_csv('submission.csv',index=False)","7e5f182c":"Checking pawpularity distribution ","b045573f":"Reshaping x and y dataset for neural network training purposes","ee869009":"Checking any null instances in train and test dataset","70f97791":"Loading the .csv file","1f9c1424":"In this competetition, our goal is to predict pawpularity of pet's profile based on appearance of pet profile. ","42e3d4c4":"Filtering columns for x and y variables","d2a12efb":"Listing test columns names","9f1bacdd":"**Heatmap analysis**","8cb3edb9":"**Visualizing training and validation mse**","e2275141":"Listing train columns name","4d121661":"Spliting train and test dataset","7de032a2":"sns.countplot(x=feature_variables,y=target_variable,data=tran)","4f7e9d68":"**Model of neural network**","19e52372":"Droping train id column","c5076c02":"Using PCA to reduce dimension for analysis outlier","b2572ff8":"Reshaping test dataset for predicting purposes","2ace2768":"Visualization of PCA ","9e5c386a":"**Ploting training and validation losses**"}}