{"cell_type":{"d698d30f":"code","3b2463ed":"code","30d0fbe1":"code","36ee89a1":"code","64621b0d":"code","b2f69b5e":"code","3ff27cfe":"code","eed97b05":"code","f25f34f4":"code","bae3c2c1":"code","aca829bf":"code","2e2d890d":"code","979135df":"code","637a35ae":"markdown"},"source":{"d698d30f":"# Install fastai2 (note that soon fastai2 will be officially released as fastai)\n!pip install fastai2","3b2463ed":"from fastai2.vision.all import *","30d0fbe1":"path = Path('\/kaggle\/input\/fruits\/fruits-360\/')\ntrain_fld = 'Training'","36ee89a1":"train_files = [o.ls() for o in (path\/train_fld).ls() if 'Potato' in o.name]\ntrain_files = [l for o in train_files for l in o]\nlen(train_files)","64621b0d":"train_df = pd.DataFrame({'file': train_files, 'id': [o.parent.name for o in train_files]})\ntrain_df.head()","b2f69b5e":"dblock = DataBlock(blocks     = (ImageBlock, CategoryBlock),\n                   get_x      = ColReader('file'),\n                   get_y      = ColReader('id'),\n                   splitter   = RandomSplitter(),\n                   item_tfms  = Resize(64),\n                   batch_tfms = [Normalize.from_stats(*imagenet_stats), *aug_transforms()])","3ff27cfe":"dls = dblock.dataloaders(train_df)","eed97b05":"dls.show_batch()","f25f34f4":"class BasicCNN(Module):\n    def __init__(self, n_classes):\n        self.conv1      = nn.Conv2d(3, 32, kernel_size=3)\n        self.conv2      = nn.Conv2d(32, 64, kernel_size=3)\n        self.avgpool    = nn.AdaptiveAvgPool2d(1)\n        self.fc         = nn.Linear(64, n_classes)\n\n    def forward(self, x):\n        x = F.relu(F.max_pool2d(self.conv1(x), 2))\n        x = F.relu(F.max_pool2d(self.conv2(x), 2))\n        x = self.avgpool(x)\n        x = self.fc(x.view(-1, x.shape[1]))\n        return x","bae3c2c1":"model = BasicCNN(n_classes=dls.c)\nlearn = Learner(dls, model, loss_func=nn.CrossEntropyLoss(), metrics=[accuracy])","aca829bf":"learn.summary()","2e2d890d":"learn.fit_one_cycle(30, lr_max=3e-3, wd=1e-2)","979135df":"plt.figure(figsize=(10,5), dpi=150)\nlearn.recorder.plot_loss()\nplt.xlabel('iterations')\nplt.ylabel('loss')","637a35ae":"# Learn AI Today: 03 - Potato Classifier using Convolutional Neural\u00a0Networks \ud83e\udd54\ud83e\udd54\ud83e\udd54\n\n**What you will learn in this story:**\n\n* Potatoes Are Not All the Same\n* Using Kaggle Datasets\n* How Convolutional Neural Networks Work\n* Using fastai2 to Make Your Life Easier\n\n**If you want to receive updates consider joining my mailing list at [learn-ai-today.com](http:\/\/learn-ai-today.com)**\n\n## Note: The full description of the code and steps is available on Medium at [this link](https:\/\/towardsdatascience.com\/learn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806)."}}