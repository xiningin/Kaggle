{"cell_type":{"54e7e44d":"code","9fd3dabd":"code","572f4659":"code","1619f278":"code","dc14dadb":"code","87b655bc":"code","d5d446bc":"code","e6684b40":"code","520e49dc":"code","1833bdf0":"code","9018af46":"code","49072119":"code","000b5e36":"code","40cf0845":"code","26eefee4":"code","e3316f15":"code","2e17d23a":"code","601e37e7":"code","e275b62e":"code","623db86b":"code","5dc2d12f":"code","734436b7":"code","34f329bb":"code","ee9f3669":"code","ef7e904c":"code","307c1631":"code","036c3538":"code","51c8848a":"code","02475f9f":"code","54cc2949":"code","c550aee7":"code","0f258ef2":"code","ddef807b":"code","59755c84":"code","a84b21b5":"code","af9d53c4":"code","7e21f51f":"code","7a363982":"code","95f7ac4c":"code","64dd9355":"code","51145758":"code","d8926513":"code","b968bc16":"code","c532d01d":"code","729b0414":"code","593d29b2":"code","53507c34":"code","6e2fe20d":"code","947137a0":"code","6dded563":"code","767f0301":"code","9df8d79e":"code","c251c1f3":"code","58c05339":"code","98c12ba6":"code","60998b78":"code","ff5959c6":"code","62076001":"code","b083f201":"code","7aa0b3aa":"code","9a099b38":"code","d80cbfa2":"code","f61d2b10":"code","daf1266d":"code","c9e0b485":"code","2a5467eb":"markdown","94a2b159":"markdown","8729d767":"markdown","9a1819a8":"markdown","78a87fb0":"markdown","4e3f623c":"markdown","487bb03c":"markdown","99509b3a":"markdown","9464fbc1":"markdown","bf8057a6":"markdown","188b6aed":"markdown","aaba6e72":"markdown","754ca6cd":"markdown","4c17788e":"markdown","ac564441":"markdown","9e18fe19":"markdown","062e555f":"markdown","dbe63984":"markdown","6b03a01d":"markdown","67d1b9a4":"markdown","6d121bff":"markdown","f2a6daf7":"markdown","b83f5340":"markdown","7152faf2":"markdown","e059e424":"markdown","980a8ea6":"markdown","c3045eaf":"markdown","0e074a91":"markdown","d2a839bc":"markdown","95bd9821":"markdown","b34220a9":"markdown","e5507ad0":"markdown","3122a561":"markdown","c34627ac":"markdown","5bc91a39":"markdown","5295891b":"markdown","e7484193":"markdown","5a30aefa":"markdown","bd487d42":"markdown","b6ea8f6c":"markdown","e2f26bdb":"markdown","c13f7699":"markdown","ad08c129":"markdown","ea585547":"markdown","460ea4d4":"markdown","a87002f3":"markdown","afa4339f":"markdown","66f8f6c5":"markdown","39920b55":"markdown","ffe8a1ec":"markdown"},"source":{"54e7e44d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","9fd3dabd":"#load required libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import SVC","572f4659":"#load our data \ndf=pd.read_csv('..\/input\/titanic\/titanic_train.csv')","1619f278":"#getting an overview information about our data\ndf.info()","dc14dadb":"#checking the shape of our data interms of columns and rows\ndf.shape","87b655bc":"#checking for missing values in our dataset\ndf.isna().sum()","d5d446bc":"#checking percentage of missing values from the column overall entries\nround(df.isna().sum()\/len(df)*100)","e6684b40":"#we shall drop cabin column as it has most missing value at 78%\ndf.drop('Cabin',axis=1,inplace=True)","520e49dc":"#getting passenger titles from the names column\ndf.Name.head(50)\ndf['passenger_title'] = df.Name.apply(lambda x: x.split(',')[1].split('.')[0].strip())","1833bdf0":"#As for Age and  Embarked columns we shall replace missing values with the median and  mode  of their column values\ndf['Age']=df['Age'].fillna(df.Age.median())\n#The mode is the most frequently occurring element in a series.\ndf['Embarked']=df['Embarked'].fillna(df.Embarked.mode()[0])","9018af46":"#checking missing values in our dataset\ndf.isna().sum()","49072119":"#drop passengerId column as it has no correlation with the outcome in whether a passenger survived or not.\n#df.drop('PassengerId',axis=1,inplace=True)\n\n#we can all drop the name of the passenger as we have captured their title which can be a unique distinguisher\ndf.drop('Name',axis=1,inplace=True)","000b5e36":"df.head()","40cf0845":"#relocating our target column(Survived) to be the last column.\ncols=list(df.columns.values) #create a list of our columns\ncols.pop(cols.index('Survived'))#removing Survived from our column list\ndf=df[cols+['Survived']]#create a new list add the survival column that will added as the last column","26eefee4":"#checking the distribution of our target column values\ndf.Survived.value_counts()","e3316f15":"#Gender distribution of passengers\ndf.Sex.value_counts()","2e17d23a":"#plotting a histogram for passenger survival  distribution aboard titanic.\n\ndf.Survived.hist()","601e37e7":"#plotting a histogram for gender distribution of passengers on board.\ndf.Sex.hist()","e275b62e":"#plotting a pie showing the gender distribution\ngender=df.Sex.value_counts()\ngender_labels=['Male','Female']\nplt.pie(gender,labels=gender_labels,autopct='%.0f%%')\nplt.legend(title='Gender')\nplt.show()","623db86b":"#comparison survival between male and female passengers\n\n#plotting a  catplot  to compare gender survival\nsns.catplot(data=df,x='Sex',kind='count',hue='Survived')\n","5dc2d12f":"plt.figure(figsize=(20,10))\ndf['passenger_title'].value_counts()","734436b7":"plt.figure(figsize=(20,10))\nsns.boxplot(data=df,x='Age',y='passenger_title',hue='Survived')","34f329bb":"sns.catplot(data=df,x='Sex',kind='count',hue='Survived')","ee9f3669":"df[['Sex','Survived']].value_counts()","ef7e904c":"#Passenger class survival\nf=sns.catplot(data=df,x='Pclass',kind='count',hue='Survived')\nax = f.facet_axis(0,0)\nfor p in ax.patches:\n    ax.text(p.get_x() + 0.015, \n            p.get_height() * 1.02, \n            '{0:.0f}'.format(p.get_height()), \n            color='black', rotation='horizontal', size='large')","307c1631":"df.Age.hist()","036c3538":"#youngest passenger on board\ndf.Age.min()","51c8848a":"#Oldest passenger on board\ndf.Age.max()","02475f9f":"sns.catplot(x='Sex',y='Age',col='Pclass',hue='Survived',data=df)\nplt.show()","54cc2949":"sns.boxplot(data=df,y='Age',x='Pclass',hue='Survived')","c550aee7":"sns.catplot(x='Sex',y='Age',col='Embarked',hue='Survived',data=df)\nplt.show()","0f258ef2":"#Passenger survival across differend embarkment\ng=sns.catplot(data=df,x='Embarked',kind='count',hue='Survived')\nax = g.facet_axis(0,0)\nfor p in ax.patches:\n    ax.text(p.get_x() + 0.015, \n            p.get_height() * 1.02, \n            '{0:.0f}'.format(p.get_height()), \n            color='black', rotation='horizontal', size='large')","ddef807b":"#plotting a histogram to view the distribution of Siblings\/Spouses aboard the titanic\ndf.SibSp.hist()","59755c84":"df.SibSp.value_counts()","a84b21b5":"sns.catplot(x='SibSp',y='Age',col='Embarked',hue='Survived',data=df)\nplt.show()","af9d53c4":"df.Parch.hist()","7e21f51f":"df.Parch.value_counts()","7a363982":"sns.catplot(x='Parch',y='Age',col='Embarked',hue='Survived',data=df)\nplt.show()","95f7ac4c":"df.Fare.hist()","64dd9355":"sns.catplot(x='Sex',y='Fare',col='Pclass',hue='Survived',data=df)\nplt.show()","51145758":"sns.catplot(x='Parch',y='Fare',col='Pclass',hue='Survived',data=df)\nplt.show()","d8926513":"sns.catplot(x='SibSp',y='Fare',col='Pclass',hue='Survived',data=df)\nplt.show()","b968bc16":"#Normalise fares to get a normal distribution\ndf.Fare.hist()","c532d01d":"#Our normalized fare column values\ndf['norm_fare'] = np.log(df.Fare+1)\ndf['norm_fare'].hist()","729b0414":"#Creating our feature and outcome data variables\nX=df.drop(['Fare','Embarked','passenger_title','Ticket','Survived','PassengerId'],axis=1)\ny=df.Survived","593d29b2":"from sklearn.preprocessing import LabelEncoder\nlbl_enc=LabelEncoder()\n#transforming categofircal values into numerical values for our model to use\nX['Sex']=lbl_enc.fit_transform(X['Sex'])\n#X['Embarked']=lbl_enc.fit_transform(X['Embarked'])","53507c34":"#splitting our data into training and testing dataset\nnp.random.state=42\ntrain_X,test_X,train_y,test_y=train_test_split(X,y,test_size=0.2,random_state=42)","6e2fe20d":"#defining our model\nlog_reg=LogisticRegression()","947137a0":"#training our model using training dataset\nlog_reg.fit(train_X,train_y)","6dded563":"#using our model to predict passenger surival based on test and train data\npred=log_reg.predict(test_X)\ntrain=log_reg.predict(train_X)","767f0301":"#valuating our model performance in predicting passenger survial\nround(accuracy_score(test_y,pred),4)","9df8d79e":"#instantiate our model\ndt_model=DecisionTreeClassifier()","c251c1f3":"#training our model using training dataset\ndt_model.fit(train_X,train_y)","58c05339":"#using our model to predict passenger surival based on test and train data\ndt_pred=dt_model.predict(test_X)\ndt_train=dt_model.predict(train_X)","98c12ba6":"#valuating our model performance in predicting passenger survial\nround(accuracy_score(test_y,dt_pred),4)","60998b78":"#instantiate our model\nrf_model=RandomForestClassifier()","ff5959c6":"#training our model using training dataset\nrf_model.fit(train_X,train_y)","62076001":"#using our model to predict passenger surival based on test and train data\nrf_pred=rf_model.predict(test_X)\nrf_train=rf_model.predict(train_X)","b083f201":"#valuating our model performance in predicting passenger survial\nround(accuracy_score(test_y,rf_pred),4)","7aa0b3aa":"#Create a hyperparameter for grid logisticRegression\nlog_reg_grid={\"C\":np.logspace(-4,4, 20),\n             \"solver\":[\"liblinear\"]}","9a099b38":"#create a hyperparameter grid for RandomForestClassifier\ngs_grid={\"n_estimators\":np.arange(10,100,50),\n        \"max_depth\":[None,3,5,10],\n        \"min_samples_split\":np.arange(2,20, 2),\n        \"min_samples_leaf\":np.arange(1,20,2)}","d80cbfa2":"#Tune LogisticRegression\n#Setup random hyperparameter search for LogisticRegression\ngs_log_reg=GridSearchCV(LogisticRegression(),\n                              param_grid=log_reg_grid,\n                              n_jobs=-1,\n                              scoring=\"accuracy\",\n                              cv=5,\n                              verbose=True)\n#Fit random hyperparameter search model for LogisticRegression\ngs_log_reg.fit(train_X,train_y)","f61d2b10":"round(gs_log_reg.score(test_X,test_y),4)","daf1266d":"#Tune RandomForestClassifier\n\n\n#Setup random hyperparameter search for RandomForestClassifier\ngs_rf=GridSearchCV(RandomForestClassifier(),\n                         param_grid=gs_grid,\n                         cv=10,\n                         scoring=\"accuracy\",\n                         verbose=True)\n#Fit random hyperparameter search model for RandomForestClassifier\ngs_rf.fit(train_X,train_y)","c9e0b485":"#Evaluate the randomized search RandomForestClassifier model\nround(gs_rf.score(test_X,test_y),4)","2a5467eb":"# 2)Decision Tree Classifier ","94a2b159":"# 3)Random Forest Classifier","8729d767":"### Data Features Elaboration.","9a1819a8":"**Passenger Age distribution**","78a87fb0":"**Titanic Passenger Distribution.**","4e3f623c":"# Feature Engineering ","487bb03c":"We have 549 passenger who died and 342 who survived.","99509b3a":"We're going to tune two better performing models:\n\nLogisticRegression()\nRandomForestClassifier()\n...using RandomizedSerachCV","9464fbc1":"### Setting and repositioning our Target variable","bf8057a6":"The above catplot shows that most males who embarked from Southamptom did not survive as compred to those that did who \nwere also a majority from the same region and were of the age between(20-65years) and (0.5(5 months)-52years).\n\nMost of the female who survived embarked from southamptom follwed by Cherbourg and the least were from Queenstown.\n\nA little historical background (source:https:\/\/www.bbc.co.uk\/bitesize\/topics\/z8mpfg8\/articles\/zkg9dxs)\nMore than 720 of Titanic's 900-strong crew were from Southampton and all but three were men. \nOnly 124 returned to the city.","188b6aed":"From the catplot above we find that most of the males that were on passenger class 3 did not survive and comprised of \nage ranging between 20-50 years followd by those on passenger class 2(20-50years) and lastlt those on passenger \nclass 1(20-65years).\n\nWomen a board passenger class 2 had the highest survival with age ranging between 0.5(months)-40years followed by \npassenger class 1 (20-50 years) and 3(0.5(5months)-30years) respectively.\n\nA little research from the internet(source:https:\/\/www.bbc.co.uk\/bitesize\/topics\/z8mpfg8\/articles\/zkg9dxs)\nFirst class passengers were some of the richest and most important people of the time.\nMany of the second class passengers were tourists, made up of professions such as teachers and clergy.\nThe passengers in third class were mainly immigrants heading for a new life in America.","aaba6e72":"**Distribution of Fare across passengers aboard**","754ca6cd":"# Hyperparameter tuning with GridSearchCV","4c17788e":"# 1)Logistic Regression","ac564441":"#  ****Model Building****","9e18fe19":"A majority of the parents aboard did not have children while a majority of those that had children had a single child,followed by those with two children, fourth and fifth respectively.\n\nThe highest number of children aboard was a parent with 6 children.","062e555f":"    Pclass - Passenger Class (1 = 1st; 2 = 2nd; 3 = 3rd)\n    Name - passenger's Name\n    sex - gender of the passenger Male or Female\n    age - Age of the passenger onboard\n    sibsp - Number of Siblings\/Spouses Aboard\n    parch - Number of Parents\/Children Aboard\n    ticket - Ticket Number\n    fare - Passenger Fare\n    cabin - Cabin\n    embarked - gives infromation on where a traveler mounted from there are 3 values\n    (C = Cherbourg; Q = Queenstown; S=Southampton)\n    Survived=passenger if survived 1=yes,0=no","dbe63984":"# ****Data Visualization****","6b03a01d":"Most of the passengers aboard passenger class 1 were female with fare prices ranging from 50-280 followed women on passenger class 2 and passenger 3 respectively.\n\nMost of the male passengers were aboard passenger class 3 followed by those aboard passenger class 2.","67d1b9a4":"After some hyperparameter tuning on our two models using gridsearchCV random forest model had improvements to 80% while logistic classifier dropped. I tend to think theres some offer fitting in our models. Would research on how to implement Catboost and XGBoost","6d121bff":"There were lots of passengers with title Mr followed by Miss ,Mrs then Master.\n\nIt's interesting to see how passengers titles faired with age in terms of survival as they are not far from each other .","f2a6daf7":"This notebook comprises on the people who sailed on the maiden voyage of the RMS Titanic.the ship struck an iceberg and sank in the early morning of 15 April 1912.\n\nThe dataset comprises of 891 passengers information.\n\nA little description about the  passengers aboard Titanic.\n\nPassengers were divided into three passenger classes determined by the price of their ticket: those travelling in first class, most of them the wealthiest passengers on board, included prominent members of the upper class, businessmen, politicians, high-ranking military personnel, industrialists, bankers, entertainers, socialites, and professional athletes. \nSecond-class passengers were predominantly middle-class travellers and included professors, authors, clergymen, and tourists. \nThird-class or steerage passengers were primarily immigrants moving to the United States and Canada.\"\n\nOur target data being categorical (determing if surived Yes or No). I shall use Logistic  regression SVM,Decision Trees algorithms to predict classification of Titanic passenger survival.\n\nLooking forward to your feedback in the comment section also kindly UPVOTE and motivate a beginner here!!!","b83f5340":"**Survival Distribution across per passenger class**","7152faf2":"# EDA coclusion\u00b6\nThe above visualizations shows that passengers aboard passenger class 1 and being female embarking from Southampton with no parent or children and no sibling or spouce a board had very high chances of survival.","e059e424":"From the scores of our models logistic regression performed with better results followed by Randomforest then Decision Trees.\n\nNext we try and improve our model scores through hyperparameter tuning.","980a8ea6":"There were a total of 577 males passengers and 314 female passengers of the total 891 passengers on board the titanic.","c3045eaf":"**Passenger survival across male and female**","0e074a91":"    Our dataset comprises of 12 columns and 891 entries.\n    There missing values in the Age,Fare and Cabin columns. \n    The dataset comprises of entries that are of integer ,object and float data types.\n","d2a839bc":"From the passengers on board the age group of most of them was between 25-32 years.\nWith the youngest at 4 months and the oldest at 80years.","95bd9821":"There are 3 Passenger classes in the titanic 1,2,3 . The passengers on class 1 had a higher survival rate compared to other classes as 136 passengers survived followed by passengers on class 3 at 87 then class 2 where there were 87 of who survived.\n\nWorth noting is passengers in class 2 didn't have a huge disparity(a difference of 10) between passengers who survived and those that didn't compared to class 3 and 1.","b34220a9":"It's a good practice to have the target varible column as the last column. From our target varible column it consists of numerical values in binary from 1 an 0.","e5507ad0":"I have dropped the ticket column will be looking if it has an impact in the overall model performance.","3122a561":"**Covert Label columns into number values**","c34627ac":"From the cat plot above we see that alot of male passengers didn't survive at 468 compared to women at 81.\nThe number of male who survived were 109 compared to women at 233.\n\nThere are high chances of a woman surviving than a man we shall know why as we proceed.","5bc91a39":"From the data set the passenger details are captured with thier titles it can be a good way to see it's correlation to our output","5295891b":"**Distribution of Number of Siblings\/Spouses Aboard**","e7484193":"From the titanic passengers on board 65% comprised of male 35% comprised of female.","5a30aefa":"#  **Data Exploration**","bd487d42":"**Number of Parents\/Children Aboard**","b6ea8f6c":"From the dataset the column with the most missing values is cabin (687)at 77%,Age column has 20% of missing values while Embarked column has 2 missing values.\n\nLater we shall handle the missing values with it's respective column mean but for Cabin it has too many missing values it's advicable to drop it together with Passenger Id column.","e2f26bdb":"The highest number of passengers with no sibling\/spouce aboard and those with 1 sibling\/spouce aboard passenger class 1 survived, compared to those from class 3 who did not survive and both those that did not have sibling\/spouce to those that had with the highest at 8.","c13f7699":"**Survival of passengers across different Embarkments**","ad08c129":"From the box plot above shows the majority of passengers aboard were from passenger class 1 and those above 30years did not survive with a mean age of 38years those that survived had an average of 35 years.\n\nPassengers from Pclass 2 majority of them survived were below 30 years compared to those who didn't and above 30years.\n\nPassenger from Pclass 3 majority of those who survived were below 30years compared to the few above 30years who survived. The passengers in Pclass 3 those that did not survive all were below 30 years.\n\nThere seems to be a strong corrillation between the passengers age and the passenger class they were in the titanic in determining their survival rate (this will lead us to instead of using the mean age to replace missing values we use Pclass and Age).\n","ea585547":"A majority of siblings and spouces of age between 20-75 embarked from Southamptom did not survive compared to other             embarkments.\n\nThe passengers who had no siblings\/spouces survived with a higher number of ages between 0.2-80years followed by those \nthat has 1 sibling\/spouce aboard of age between 0.2(2months)-62years follwed with those that embarked from Cherbourg \nwith no sibling\/spouce and 1 sibling\/spouce a board.","460ea4d4":"Majority of the passengers on board did not have siblings and spouses aboard at 608.\nThose that had siblings on board majority of them had 1 sibling\/spouse aboard at 209.\nThe largest number of sibling\/spouse aboard was 8.","a87002f3":"# **Handling Missing Values**\n","afa4339f":"This means replacing the column values with the a mode value  Embarked of the passengers onboard and for age replace missing values with their ranging age values from the Pclasses.\nNow our data has no missing values.","66f8f6c5":"Passengers who embarked from Southampton were the majority in the titanic, 217 of them survived while  427 did not.\n93 passengers from Cherbourg survived while 75 passengers didn't\nThe least of passengers on board had embarked from Queenstown  where 30 of them survived while 47 of them did not.","39920b55":"# Hyperparameter Tuning ","ffe8a1ec":"The above catplot shows that the parents and children a board majority embarked from Southamptom and had the highest number in non survival and were of between the ages of 18-75years) followed by those from Cherbourg.\n\nA majority of parents who did have children and survived embarked from Cherbourg those that had 1 and 2 children survived were mostly from Southamptom followed by parents with 1 and 2 children from Cherbourg.\n\nThe parent who had most childred at 6 embarked from Southamptom and did not survive."}}