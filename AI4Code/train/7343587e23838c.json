{"cell_type":{"39e46ffc":"code","91106c46":"code","41f0d429":"code","c3c32bbd":"code","425efbf4":"code","1511d2b5":"code","5492e283":"code","91ac6595":"code","10d2cd33":"code","d0513b61":"code","322765a4":"code","e9f7fda7":"code","3d9f5d9b":"code","6d420d36":"code","7f56785c":"code","0d49dbe4":"code","8ccf8eb2":"code","d9562262":"code","cf84faa2":"code","5f764618":"code","67f58d53":"code","d395b9e0":"code","c982be18":"code","208b814c":"code","e3779070":"code","cb173ce4":"code","f8a6f64c":"code","11f6b08f":"code","55f37af2":"code","2a85c026":"code","242075ff":"code","4a657f50":"code","42a5e74c":"code","da561be3":"code","0ba1c3ab":"code","9ffcd3a4":"code","5f753b71":"code","d37333d7":"code","7bbed3d3":"code","b2ed89c5":"code","c671d90a":"code","1e973a7a":"code","79bef135":"markdown","fab4add6":"markdown","8f7b9802":"markdown","cf603d49":"markdown","e21ce3f2":"markdown","d6147b83":"markdown","1e747fa2":"markdown","af2fe7e3":"markdown","469fdd16":"markdown","9df6bb81":"markdown","07c32e0c":"markdown","f13ca800":"markdown","36f82a59":"markdown","d066168f":"markdown","b90be1a3":"markdown","2b900a02":"markdown","100ce33d":"markdown"},"source":{"39e46ffc":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport seaborn as sns\n   ","91106c46":"df_listings = pd.read_csv('..\/input\/airbnbporto\/listings.csv')\ndf_calendar = pd.read_csv('..\/input\/airbnbporto\/calendar.csv')\ndf_reviews = pd.read_csv('..\/input\/airbnbporto\/reviews.csv')","41f0d429":"df_comments = df_reviews[[\"listing_id\",\"comments\"]].copy()\ndf_comments.shape[0]\n#df_comments['comments'][0]","c3c32bbd":"# language=[]\n# from langdetect import detect\n# for index, row in df_comments.iloc[:461812].iterrows():\n#     try:\n#         language.append(detect(row['comments']))\n#     except:\n#         language.append(\"error\")","425efbf4":"# df_lang = pd.DataFrame(language,columns=['language'])\n# df_lang.tail(10)","1511d2b5":"df_lang = pd.read_csv('..\/input\/language-airbnb\/language.csv')","5492e283":"df_comments['language']=df_lang\ndf_lang['count']=1","91ac6595":"df_lang_stat = df_lang.groupby(by='language').sum().sort_values(by='count', ascending=False)","10d2cd33":"df_lang_stat.iloc[:5]","d0513b61":"df_lang_stat.iloc[:5].plot.pie(y='count', figsize=(5,5))","322765a4":"df_lang_stat['count'].iloc[:5].sum()","e9f7fda7":"df_comments_reduced = df_comments.loc[(df_comments.language=='en') | (df_comments.language=='fr')|\n                                     (df_comments.language=='es') | (df_comments.language=='pt')|\n                                     (df_comments.language=='de')].copy()","3d9f5d9b":"df_comments_reduced.tail(10)","6d420d36":"from nltk.sentiment.vader import SentimentIntensityAnalyzer\nfrom nltk.sentiment.util import *\nfrom textblob import TextBlob\nfrom nltk import tokenize","7f56785c":"def get_polarity(text):\n    return TextBlob(text).sentiment.polarity\ndf_comments_reduced['Polarity'] = df_comments_reduced['comments'].apply(get_polarity)","0d49dbe4":"df_comments_reduced.tail()","8ccf8eb2":"df_comments_reduced['Sentiment_Type Textblob']=''\ndf_comments_reduced.loc[df_comments_reduced.Polarity>0,'Sentiment_Type Textblob']='POSITIVE'\ndf_comments_reduced.loc[df_comments_reduced.Polarity==0,'Sentiment_Type Textblob']='NEUTRAL'\ndf_comments_reduced.loc[df_comments_reduced.Polarity<0,'Sentiment_Type Textblob']='NEGATIVE'","d9562262":"df_comments_reduced_sentimental = df_comments_reduced[['listing_id','comments', 'language', 'Sentiment_Type Textblob']].copy()","cf84faa2":"df_comments_reduced_sentimental.tail()","5f764618":"pd.set_option(\"display.max_colwidth\", 500)\ndf_comments_reduced_sentimental.loc[(df_comments_reduced_sentimental.language=='pt') &(df_comments_reduced_sentimental['Sentiment_Type Textblob']=='NEGATIVE')].head(10)","67f58d53":"pd.set_option(\"display.max_colwidth\", 500)\ndf_comments_reduced_sentimental.loc[(df_comments_reduced_sentimental.language=='en') &(df_comments_reduced_sentimental['Sentiment_Type Textblob']=='NEGATIVE')].head(10)","d395b9e0":"import nltk\nnltk.download('vader_lexicon')\nfrom nltk.sentiment.vader import SentimentIntensityAnalyzer\nsid = SentimentIntensityAnalyzer()\n\ndf_comments_reduced['scores'] = df_comments_reduced['comments'].apply(lambda comments: sid.polarity_scores(comments))\ndf_comments_reduced.head()","c982be18":"df_comments_reduced['compound'] = df_comments_reduced['scores'].apply(lambda score_dict: score_dict['compound'])\ndf_comments_reduced['Sentiment_Type VADER']=''\ndf_comments_reduced.loc[df_comments_reduced.compound>0,'Sentiment_Type VADER']='POSITIVE'\ndf_comments_reduced.loc[df_comments_reduced.compound==0,'Sentiment_Type VADER']='NEUTRAL'\ndf_comments_reduced.loc[df_comments_reduced.compound<0,'Sentiment_Type VADER']='NEGATIVE'\n\ndf_comments_reduced.loc[df_comments_reduced.compound>0,'Sentiment_Value VADER']=1\ndf_comments_reduced.loc[df_comments_reduced.compound==0,'Sentiment_Value VADER']=0\ndf_comments_reduced.loc[df_comments_reduced.compound<0,'Sentiment_Value VADER']=-1","208b814c":"df_comments_reduced.head()","e3779070":"df_comments_reduced_sentimental['Sentiment_Type VADER'] = df_comments_reduced['Sentiment_Type VADER']\ndf_comments_reduced_sentimental['Sentiment_Value VADER'] = df_comments_reduced['Sentiment_Value VADER']\ndf_comments_reduced_sentimental.head()","cb173ce4":"pd.set_option(\"display.max_colwidth\", 500)\ndf_comments_reduced_sentimental.loc[(df_comments_reduced_sentimental.language=='pt') &(df_comments_reduced_sentimental['Sentiment_Type VADER']=='NEGATIVE')].tail(10)","f8a6f64c":"df_listings.info()","11f6b08f":"df_scores = df_listings[['id','number_of_reviews', 'review_scores_rating', 'review_scores_accuracy', \n             'review_scores_cleanliness', 'review_scores_checkin','review_scores_communication','review_scores_location','review_scores_value'\n            ]].copy()\ndf_scores.head()","55f37af2":"df_vader = df_comments_reduced_sentimental.groupby('listing_id').sum()","2a85c026":"df_vader.head()","242075ff":"list_id = df_vader.index\ndf_scores.set_index('id', inplace=True)\ndf_scores.head()","4a657f50":"inter1 = df_scores.loc[list_id].copy()\n","42a5e74c":"df_vader['review_scores_rating'] = inter1['review_scores_rating']\ndf_vader['number_of_reviews'] = inter1['number_of_reviews']\ndf_vader.head(20)","da561be3":"df_vader.loc[(df_vader['Sentiment_Value VADER']<0) & (df_vader['number_of_reviews']>=5)].sort_values(by='review_scores_rating')","0ba1c3ab":"df_vader.loc[(df_vader['review_scores_rating']<=50) & (df_vader['Sentiment_Value VADER']<=0)].count() \/ df_vader.loc[(df_vader['review_scores_rating']<=50)].count()","9ffcd3a4":"df_vader.loc[(df_vader['review_scores_rating']>50) & (df_vader['Sentiment_Value VADER']>0)].count() \/ df_vader.loc[(df_vader['review_scores_rating']>50)].count()","5f753b71":"df_vader_en = df_comments_reduced_sentimental.loc[df_comments_reduced_sentimental['language']=='en'].groupby('listing_id').sum()","d37333d7":"list_id = df_vader_en.index","7bbed3d3":"inter2 = df_scores.loc[list_id].copy()","b2ed89c5":"df_vader_en['review_scores_rating'] = inter2['review_scores_rating']\ndf_vader_en['number_of_reviews'] = inter2['number_of_reviews']\ndf_vader_en.head(20)","c671d90a":"df_vader_en.loc[(df_vader_en['review_scores_rating']<=50) & (df_vader_en['Sentiment_Value VADER']<=0)].count() \/ df_vader_en.loc[(df_vader_en['review_scores_rating']<=50)].count()","1e973a7a":"df_vader_en.loc[(df_vader_en['review_scores_rating']>50) & (df_vader_en['Sentiment_Value VADER']>0)].count() \/ df_vader_en.loc[(df_vader_en['review_scores_rating']>50)].count()","79bef135":"Na compara\u00e7\u00e3o considerando os 5 idiomas e os coment\u00e1rios positivosd a precis\u00e3o foi de 90,3%. Bastante elevada.","fab4add6":"# **Integrando o dataset listings com as notas para comparar com os resultados obtidos com os frameworks de an\u00e1lise de sentimentos**","8f7b9802":"A classifica\u00e7\u00e3o dos sentimentos para o idioma portugu\u00eas com o VADER foi significativamente superior. Dos 10 exemplos classificados como negativo, em 5 o comement\u00e1rio havia sido realmente negativo.","cf603d49":"How do star ratings work for stays?\nIn addition to written reviews, guests can submit an overall star rating and a set of category star ratings for their stay.\n\nGuests can give ratings on:\n\n**Overall experience**. Overall, how was the stay?\n\n**Cleanliness**. Did guests feel that the space was clean and tidy?\n\n**Accuracy**. How accurately did the listing page represent the space? For example, guests should be able to find up-to-date info and photos in the listing description.\n\n**Check-in**. How smoothly did check-in go?\n\n**Communication**. How well did you communicate before and during the stay? Guests often care that their host responds quickly, reliably, and frequently to their messages and questions.\n\n**Location**. How did guests feel about the neighborhood? This may mean that there's an accurate description for proximity and access to transportation, shopping centers, city center, etc., and a description that includes special considerations, like noise, and family safety.\n\n**Value**. Did the guest feel that the listing provided good value for the price?\n\n**Amenities**. How did guests feel about the amenities that were available during their stay? Guests often care that all the amenities listed are available, working, and in good condition.","e21ce3f2":"Na compara\u00e7\u00e3o considerando somente coment\u00e1rios em ingles houve uma redu\u00e7\u00e3o de performance substancial de 88,1% p\/ 64,3% p\/ rea\u00e7\u00f5es neutras e negativas","d6147b83":"# **Testando o framework Vader**","1e747fa2":"A classifica\u00e7\u00e3o dos sentimentos para o idioma portugu\u00eas n\u00e3o foi satisfat\u00f3ria. Dos 10 exemplos classificados como negativo, somente em um caso o comement\u00e1rio havia sido realmente negativo.","af2fe7e3":"# **Comparando os scores dados pelos clientes com os calculados pelo Vader considerando somente o ingl\u00eas**","469fdd16":"Avaliando se a an\u00e1lise de sentimentos funciona bem com um idioma sem ser ingl\u00eas","9df6bb81":"# **Encontrando os idiomas dos coment\u00e1rios com langdetect**","07c32e0c":"Na compara\u00e7\u00e3o considerando os 5 idiomas e os coment\u00e1rios neutros\/negativos a precis\u00e3o foi de 88,1%. Bastante elevada.","f13ca800":"# **Testando o framework Textblob**","36f82a59":"A classifica\u00e7\u00e3o dos sentimentos para o idioma ingl\u00eas melhorou um pouco. Dos 10 exemplos classificados como negativo, 4 coment\u00e1rios haviam sido realmente negativos.","d066168f":"# **Comparando os scores dados pelos clientes com os calculados pelo Vader para 5 idiomas: ingl\u00eas, franc\u00eas, espanhol, portugu\u00eas e alem\u00e3o**","b90be1a3":"Como a distribui\u00e7\u00e3o de idioma est\u00e1 bem distribuida terei que utilizar um framework de avalia\u00e7\u00e3o de sentimento para linguas diferentes. Para reduzir o tamnho da an\u00e1lise ser\u00e1 utilizado somente os coment\u00e1rios feitos nos 5 idiomas mais presentes: ingl\u00eas, franc\u00eas, portugu\u00eas, espanhol e alem\u00e3o.","2b900a02":"Considerando somente o ingl\u00eas e coment\u00e1rios, o resultado melhorou muito com precis\u00e3o de 98,4%","100ce33d":"Total de coment\u00e1rios avaliados: 432316"}}