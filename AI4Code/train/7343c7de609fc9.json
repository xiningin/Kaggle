{"cell_type":{"2c82b7de":"code","224633d3":"code","f9a072b8":"code","52c95544":"code","0298e7a8":"code","06feefe3":"code","71e39443":"code","4165011d":"code","3f1a5173":"code","ed1a72d8":"code","484ea372":"code","f37de42b":"code","63a59ce6":"code","23cae107":"code","34538bc6":"code","9c8d0f68":"code","474b835e":"code","3c70bf8e":"code","42c9d3ab":"code","b0e8839b":"code","5365bafc":"code","96f73b2c":"code","2ae30ced":"code","3d93390f":"code","4111ab3f":"code","e46bba01":"code","391605d5":"code","81350290":"code","786ca791":"code","a39f7ae2":"markdown","60cd4382":"markdown","b12bfbd8":"markdown","5168ea60":"markdown","45b7a71c":"markdown"},"source":{"2c82b7de":"!pip install astropy\n!pip install specutils","224633d3":"#GENERAL\n\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport matplotlib.cm as mtpltcm\nfrom mpl_toolkits.mplot3d import Axes3D\nimport random\nimport time\n\n#PATH PROCESS\n\nimport os\nimport os.path\nfrom pathlib import Path\nimport glob\nfrom scipy.io import loadmat\nimport nibabel as nib\nimport csv\nfrom astropy.visualization import astropy_mpl_style\nfrom astropy.utils.data import get_pkg_data_filename\nfrom astropy.io import fits\nimport astropy\nfrom astropy import units as u \nimport astropy.wcs as fitswcs\nfrom specutils import Spectrum1D, SpectralRegion\nfrom astropy.cosmology import WMAP9 as Cosmology\n\n#IMAGE PROCESS\n\nfrom PIL import Image\nfrom keras.preprocessing import image\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nimport cv2\nfrom keras.applications.vgg16 import preprocess_input, decode_predictions\nfrom keras.preprocessing import image\nfrom skimage.feature import hessian_matrix, hessian_matrix_eigvals\nfrom scipy.ndimage.filters import convolve\nfrom skimage import data, io, filters\nimport skimage.morphology as morph\nimport skimage.exposure as skie\nimport skimage\nfrom skimage.morphology import convex_hull_image, erosion\nfrom IPython import display\nfrom scipy.ndimage import gaussian_filter\nfrom mpl_toolkits.mplot3d.art3d import Poly3DCollection\nimport matplotlib.patches as patches\n\n#SCALER & TRANSFORMATION\n\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import MinMaxScaler\nfrom keras.utils.np_utils import to_categorical\nfrom sklearn.model_selection import train_test_split\nfrom keras import regularizers\nfrom sklearn.preprocessing import LabelEncoder\nimport sklearn\n\nimport pydub\nfrom scipy.io.wavfile import read, write\nimport librosa\nimport librosa.display\nimport IPython\nfrom IPython.display import Audio\nimport scipy\nfrom scipy import signal\nfrom scipy.fft import fftshift\n\n#IGNORING WARNINGS\n\nfrom warnings import filterwarnings\n\nfilterwarnings(\"ignore\",category=DeprecationWarning)\nfilterwarnings(\"ignore\", category=FutureWarning) \nfilterwarnings(\"ignore\", category=UserWarning)\nfilterwarnings(\"ignore\", category=RuntimeWarning)","f9a072b8":"NI_TYPE_1_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/2019-1998 HH111 - NEAR INFRARED\/HST-IR\/idgz04030_drz.fits\"\nNI_TYPE_2_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/2019-1998 HH111 - NEAR INFRARED\/HST-IR\/idgz04040_drz.fits\"\nNI_TYPE_3_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/2019-1998 HH111 - NEAR INFRARED\/HST-IR\/idgz04050_drz.fits\"\nNI_TYPE_4_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/2019-1998 HH111 - NEAR INFRARED\/HST-IR\/idgz04060_drz.fits\"\nNI_1_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/2019-1998 HH111 - NEAR INFRARED\/HST-IR\/n4ka07010_mos.fits\"\nNI_2_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/2019-1998 HH111 - NEAR INFRARED\/HST-IR\/n4ka07020_mos.fits\"\nNI_3_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/2019-1998 HH111 - NEAR INFRARED\/HST-IR\/n4ka07030_mos.fits\"\n\nOPTICAL_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/2019 - HH111 - OPTICAL\/HST\/idgz04010\/idgz04010_drc.fits\"\n\nISO_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/1998-ISO\/csp8430182901.fits\"\n\nS_1_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/2005-SPITZER\/40045230.40045230-0.IRAC.1.mosaic.fits\"\nS_2_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/2005-SPITZER\/40045230.40045230-0.IRAC.2.mosaic.fits\"\nS_3_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/2005-SPITZER\/40045230.40045230-0.IRAC.3.mosaic.fits\"\nS_4_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/2005-SPITZER\/40045230.40045230-0.IRAC.4.mosaic.fits\"\n\nCHANDRA_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/CHANDRA\/acisf04490N004_full_img2.fits\"\n\nHERSCEL_TYPE_1_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/HERSCHEL\/Herschel\/anonymous1630923203\/hpacs_25HPPJSMAPB_blue_0553_p0236_00_v1.0_1471604722080.fits\"\nHERSCEL_TYPE_2_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/HERSCHEL\/Herschel\/anonymous1630923203\/hpacs_25HPPJSMAPR_0553_p0236_00_v1.0_1471604753658.fits\"\n\nHERSCEL_1_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/HERSCHEL\/Herschel\/anonymous1630923204\/hspireplw500_25pxmp_0554_p0234_1342205074_1342205075_1462525514484.fits\"\nHERSCEL_2_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/HERSCHEL\/Herschel\/anonymous1630923204\/hspirepmw500_25pxmp_0554_p0234_1342205074_1342205075_1462525516018.fits\"\nHERSCEL_3_PATH = \"..\/input\/herbigharo-object-fits-data-nasa-new\/Herbig-Haro Object\/HERSCHEL\/Herschel\/anonymous1630923204\/hspirepsw500_25pxmp_0554_p0234_1342205074_1342205075_1462525518589.fits\"\n\nNI_TYPE_1_OPEN = fits.open(NI_TYPE_1_PATH)\nNI_TYPE_2_OPEN = fits.open(NI_TYPE_2_PATH)\nNI_TYPE_3_OPEN = fits.open(NI_TYPE_3_PATH)\nNI_TYPE_4_OPEN = fits.open(NI_TYPE_4_PATH)\n\nNI_1_OPEN = fits.open(NI_1_PATH)\nNI_2_OPEN = fits.open(NI_2_PATH)\nNI_3_OPEN = fits.open(NI_3_PATH)\n\nOPTICAL_OPEN = fits.open(OPTICAL_PATH)\n\nISO_OPEN = fits.open(ISO_PATH)\n\nS_1_OPEN = fits.open(S_1_PATH)\nS_2_OPEN = fits.open(S_2_PATH)\nS_3_OPEN = fits.open(S_3_PATH)\nS_4_OPEN = fits.open(S_4_PATH)\n\nCHANDRA_OPEN = fits.open(CHANDRA_PATH)\n\nHERSCEL_TYPE_1_OPEN = fits.open(HERSCEL_TYPE_1_PATH)\nHERSCEL_TYPE_2_OPEN = fits.open(HERSCEL_TYPE_2_PATH)\n\nHERSCEL_1_OPEN = fits.open(HERSCEL_1_PATH)\nHERSCEL_2_OPEN = fits.open(HERSCEL_2_PATH)\nHERSCEL_3_OPEN = fits.open(HERSCEL_3_PATH)","52c95544":"NI_TYPE_1_SCI = NI_TYPE_1_OPEN[1].data\nNI_1_SCI = NI_1_OPEN[1].data\n\n\n\nZOOMED_TYPE_1_SCI = NI_TYPE_1_SCI[440:700,600:900]\nCORE_TYPE_1_SCI = NI_TYPE_1_SCI[520:650,680:800]\nFOCUS_1_SCI = NI_1_SCI[80:150,90:200]\n\n\n\nHERSCHEL_TYPE_1_IMAGE = HERSCEL_TYPE_1_OPEN[1].data\nHERSCHEL_3_IMAGE = HERSCEL_3_OPEN[1].data\n\n\n\nWIDE_HERSCHEL_3 = HERSCHEL_3_IMAGE[500:1500,700:1600]\nWIDE_HERSCHEL_TYPE_1 = HERSCHEL_TYPE_1_IMAGE[2000:2600,2000:2700]\n\n\n\nS_4_PRIMARY = S_4_OPEN[0].data\n\n\n\nWIDE_S_4_PRIMARY = S_4_PRIMARY[1450:1850,900:1400]\n\n\n\nISO_GENERAL = ISO_OPEN[0].data","0298e7a8":"SPECTRAL_LIST = [\"gray\",\"jet\",\"hot\",\"prism\",\"nipy_spectral\",\n             \"gist_ncar\",\"gist_earth\",\"gist_stern\",\"flag\",\"gnuplot2\",'terrain']","06feefe3":"IMAGE_LIST = [ZOOMED_TYPE_1_SCI,CORE_TYPE_1_SCI,FOCUS_1_SCI,WIDE_HERSCHEL_3,WIDE_HERSCHEL_TYPE_1,WIDE_S_4_PRIMARY]","71e39443":"for x_spec in SPECTRAL_LIST:\n    \n    figure,axis = plt.subplots(1,6,figsize=(25,25))\n    \n    axis[0].imshow(ZOOMED_TYPE_1_SCI \/ 255.,cmap=x_spec)\n    axis[0].axis(\"off\")\n    \n    axis[1].imshow(CORE_TYPE_1_SCI \/ 255.,cmap=x_spec) # target\n    axis[1].axis(\"off\")\n    \n    axis[2].imshow(FOCUS_1_SCI \/ 255.,cmap=x_spec)\n    axis[2].axis(\"off\")\n    \n    axis[3].imshow(WIDE_HERSCHEL_3 \/ 255.,cmap=x_spec)\n    axis[3].axis(\"off\")\n    \n    axis[4].imshow(WIDE_HERSCHEL_TYPE_1 \/ 255.,cmap=x_spec)\n    axis[4].axis(\"off\")\n    \n    axis[5].imshow(WIDE_S_4_PRIMARY \/ 255.,cmap=x_spec)\n    axis[5].axis(\"off\")\n    \n    plt.tight_layout()\n    plt.show()","4165011d":"for x_image in IMAGE_LIST:\n    plt.figure(figsize=(14,14))\n    plt.axis(\"off\")\n    plt.imshow(x_image,cmap=\"nipy_spectral\")\n    plt.colorbar()\n    plt.show()","3f1a5173":"for x_image in IMAGE_LIST:\n    \n    ME_IMAGE = filters.meijering(x_image)\n    plt.figure(figsize=(14,14))\n    plt.axis(\"off\")\n    plt.imshow(ME_IMAGE,cmap=\"nipy_spectral\")\n    plt.colorbar()\n    plt.show()","ed1a72d8":"for x_image in IMAGE_LIST:\n    \n    SA_IMAGE = filters.sato(x_image)\n    plt.figure(figsize=(14,14))\n    plt.axis(\"off\")\n    plt.imshow(SA_IMAGE,cmap=\"nipy_spectral\")\n    plt.colorbar()\n    plt.show()","484ea372":"for x_image in IMAGE_LIST:\n    \n    BME_IMAGE = filters.meijering(x_image,black_ridges=False)\n    plt.figure(figsize=(14,14))\n    plt.axis(\"off\")\n    plt.imshow(BME_IMAGE,cmap=\"nipy_spectral\")\n    plt.colorbar()\n    plt.show()","f37de42b":"for x_image in IMAGE_LIST:\n    \n    RND_IMAGE = filters.roberts_neg_diag(x_image)\n    plt.figure(figsize=(14,14))\n    plt.axis(\"off\")\n    plt.imshow(RND_IMAGE,cmap=\"nipy_spectral\")\n    plt.colorbar()\n    plt.show()","63a59ce6":"for x_image in IMAGE_LIST:\n    \n    FCF_IMAGE = skimage.feature.corner_foerstner(x_image)\n    plt.figure(figsize=(14,14))\n    plt.axis(\"off\")\n    plt.imshow(FCF_IMAGE[0],cmap=\"nipy_spectral\")\n    plt.colorbar()\n    plt.show()","23cae107":"for x_image in IMAGE_LIST:\n    \n    FCF_IMAGE = skimage.feature.corner_foerstner(x_image)\n    plt.figure(figsize=(14,14))\n    plt.axis(\"off\")\n    plt.imshow(FCF_IMAGE[1],cmap=\"nipy_spectral\")\n    plt.colorbar()\n    plt.show()","34538bc6":"for x_image in IMAGE_LIST:\n    \n    Picking_Image = x_image\n    Spes_Color_IMG = np.dstack((Picking_Image*0.05, Picking_Image*1.5, Picking_Image*0.02))\n\n    plt.figure(figsize=(14,14))\n    plt.axis(\"off\")\n    plt.imshow(Spes_Color_IMG,cmap=\"nipy_spectral\")\n    plt.colorbar()\n    plt.show()","9c8d0f68":"for x_image in IMAGE_LIST:\n    \n    Picking_Image = x_image\n    Dark_IMG = Picking_Image + (np.ones(Picking_Image.shape) - Picking_Image) * 0.05\n\n    plt.figure(figsize=(14,14))\n    plt.axis(\"off\")\n    plt.imshow(Dark_IMG,cmap=\"nipy_spectral\")\n    plt.colorbar()\n    plt.show()","474b835e":"for i_count in range(150):\n    \n    figure,axis = plt.subplots(1,2,figsize=(22,7))\n\n    GAUSS_ISO = gaussian_filter(ISO_GENERAL[i_count],sigma=0.9)\n\n    DENSITY_FUNC = axis[0].imshow(GAUSS_ISO,cmap=\"nipy_spectral\")\n    axis[0].set_title(\"IMAGE\")\n    axis[0].axis(\"off\")\n\n    axis[1].plot(GAUSS_ISO.flatten(),color=\"black\")\n    axis[1].set_title(\"PLOT\")\n    axis[1].axis(\"off\")\n\n    figure.colorbar(DENSITY_FUNC,shrink=0.5,label=\"DENSITY\",location=\"right\",extend=\"max\")\n    plt.tight_layout()\n    plt.show()","3c70bf8e":"figure,axis = plt.subplots(1,2,figsize=(22,7))\n\nPicking_Image = ZOOMED_TYPE_1_SCI\nSpes_Color_IMG = np.dstack((Picking_Image*0.05, Picking_Image*1.5, Picking_Image*0.02))\n\nDENSITY_FUNC = axis[0].imshow(Spes_Color_IMG,cmap=\"nipy_spectral\")\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\n\naxis[1].plot(Spes_Color_IMG.flatten(),color=\"black\")\naxis[1].set_title(\"PLOT\")\naxis[1].axis(\"off\")\n\nfigure.colorbar(DENSITY_FUNC,shrink=0.5,label=\"DENSITY\",location=\"right\",extend=\"max\")\nplt.tight_layout()\nplt.show()","42c9d3ab":"figure,axis = plt.subplots(1,2,figsize=(22,7))\n\nPicking_Image = CORE_TYPE_1_SCI\nSpes_Color_IMG = np.dstack((Picking_Image*0.05, Picking_Image*1.5, Picking_Image*0.02))\n\nDENSITY_FUNC = axis[0].imshow(Spes_Color_IMG,cmap=\"nipy_spectral\")\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\n\naxis[1].plot(Spes_Color_IMG.flatten(),color=\"black\")\naxis[1].set_title(\"PLOT\")\naxis[1].axis(\"off\")\n\nfigure.colorbar(DENSITY_FUNC,shrink=0.5,label=\"DENSITY\",location=\"right\",extend=\"max\")\nplt.tight_layout()\nplt.show()","b0e8839b":"figure = plt.figure(figsize=(20,5))\npowerSpectrum_1, freqenciesFound_1, time_1, imageAxis_1 = plt.specgram(ZOOMED_TYPE_1_SCI.flatten())\nplt.axis(\"off\")\nplt.title(\"ZOOMED\")\nplt.tight_layout()\nplt.show()","5365bafc":"figure = plt.figure(figsize=(20,5))\nplt.axis(\"off\")\nplt.title(\"ZOOMED\")\nplt.tight_layout()\nplt.plot(ZOOMED_TYPE_1_SCI)\nplt.show()","96f73b2c":"figure = plt.figure(figsize=(20,5))\n\nlibrosa.display.waveplot(ZOOMED_TYPE_1_SCI.astype(np.float32),sr=3200)\n\nplt.title(\"ZOOMED\")\nplt.tight_layout()\nplt.show()","2ae30ced":"figure = plt.figure(figsize=(20,7))\nZOOMED_X = librosa.stft(ZOOMED_TYPE_1_SCI.flatten().astype(np.float32))\nZOOMED_XDB = librosa.amplitude_to_db(abs(ZOOMED_X))\n\nlibrosa.display.specshow(ZOOMED_XDB, sr=3200, x_axis='time', y_axis='log')\nplt.colorbar()\nplt.title(\"ZOOMED\")\nplt.tight_layout()\nplt.show()","3d93390f":"Audio(ZOOMED_TYPE_1_SCI.flatten(),rate=9200)","4111ab3f":"figure = plt.figure(figsize=(20,5))\npowerSpectrum_1, freqenciesFound_1, time_1, imageAxis_1 = plt.specgram(CORE_TYPE_1_SCI.flatten())\nplt.axis(\"off\")\nplt.title(\"CORE\")\nplt.tight_layout()\nplt.show()","e46bba01":"figure = plt.figure(figsize=(20,5))\nplt.axis(\"off\")\nplt.title(\"CORE\")\nplt.tight_layout()\nplt.plot(CORE_TYPE_1_SCI)\nplt.show()","391605d5":"figure = plt.figure(figsize=(20,5))\n\nlibrosa.display.waveplot(CORE_TYPE_1_SCI.astype(np.float32),sr=3200)\n\nplt.title(\"CORE\")\nplt.tight_layout()\nplt.show()","81350290":"figure = plt.figure(figsize=(20,7))\nCORE_X = librosa.stft(CORE_TYPE_1_SCI.flatten().astype(np.float32))\nCORE_XDB = librosa.amplitude_to_db(abs(CORE_X))\n\nlibrosa.display.specshow(CORE_XDB, sr=3200, x_axis='time', y_axis='log')\nplt.colorbar()\nplt.title(\"CORE\")\nplt.tight_layout()\nplt.show()","786ca791":"Audio(CORE_TYPE_1_SCI.flatten(),rate=3200)","a39f7ae2":"### CORE","60cd4382":"# DATA OPERATIONS","b12bfbd8":"# OBSERVING","5168ea60":"# PLOT","45b7a71c":"### ZOOMED"}}