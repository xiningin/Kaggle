{"cell_type":{"37be9530":"code","c8e100b0":"code","59a32a6a":"code","977e2fe6":"code","54e5552e":"code","b89b6df5":"code","21f695c6":"code","1205cb0f":"code","265805d2":"code","16dcaec6":"code","1e37c5e2":"code","a8b89094":"code","2a19df1c":"code","0e7b2239":"code","635c60cb":"code","fefa30f6":"code","12a4fe1c":"code","813896f8":"markdown","ceca8210":"markdown","f3a74006":"markdown","c1795c1d":"markdown","acf6c9b4":"markdown"},"source":{"37be9530":"from sklearn.metrics import silhouette_score","c8e100b0":"import pandas as pd\ndf = pd.read_csv(r'..\/input\/wine-dataset-for-clustering\/wine-clustering.csv')\n# \uce90\uae00 add data, Mall_customers \uac80\uc0c9","59a32a6a":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nscaled_data = scaler.fit_transform(df)\ndf.iloc[:] = scaled_data","977e2fe6":"df","54e5552e":"import matplotlib.pyplot as plt","b89b6df5":"from scipy.cluster.hierarchy import linkage\n# https:\/\/docs.scipy.org\/doc\/scipy\/reference\/generated\/scipy.cluster.hierarchy.linkage.html\n#scipy.cluster.hierarchy.linkage","21f695c6":"hiera = linkage(df\n                , method = 'centroid' # \uad50\uc7ac 92p\ubd80\ud130 \ucc38\uace0 \/ custom function\ub3c4 \uc0ac\uc6a9 \uac00\ub2a5\n               )","1205cb0f":"from scipy.cluster.hierarchy import dendrogram","265805d2":"dend = dendrogram(hiera)","16dcaec6":"from scipy.cluster.hierarchy import cut_tree\n# https:\/\/docs.scipy.org\/doc\/scipy\/reference\/generated\/scipy.cluster.hierarchy.cut_tree.html\nnum_of_cluster = 5\ncluster_info = cut_tree(hiera, num_of_cluster)","1e37c5e2":"print('silhouette_score: {}'.format(silhouette_score(df.iloc[:,3:5], cluster_info)))","a8b89094":"methods = ['single', 'complete', 'average', 'weighted', 'centroid', 'median', 'ward']\nsilhouettes = []\nfor i in methods:\n    hiera = linkage(df, method = i)\n\n    num_of_cluster = 5\n    cluster_info = cut_tree(hiera, num_of_cluster)\n\n    print('method {} silhouette_score: {}'.format(i,silhouette_score(df, cluster_info)))\n    silhouettes.append(silhouette_score(df, cluster_info))","2a19df1c":"from sklearn.cluster import KMeans\n# https:\/\/scikit-learn.org\/stable\/modules\/generated\/sklearn.cluster.KMeans.html","0e7b2239":"tmp = []\nfor i in range(1, 11):\n    kmeans = KMeans(n_clusters = i, init = 'k-means++')\n    kmeans.fit(df)\n    tmp.append(kmeans.inertia_)","635c60cb":"plt.plot(range(1, 11), tmp)\nplt.show()","fefa30f6":"kmeans = KMeans(n_clusters = 5, random_state = 42)\ncluster = kmeans.fit_predict(df)\nprint('silhouette_score: {}'.format(silhouette_score(df, cluster)))","12a4fe1c":"df['silhouette'] = cluster\ndf","813896f8":"## \uc6d0\ub798 dataframe\uacfc \ud569\uce58\uae30","ceca8210":"## 1. \uc720\uc0ac\ub3c4 \ucc99\ub3c4(distance(or similarity) metric \uc815\ud558\uae30)\n### \uc720\ud074\ub9ac\ub514\uc548 \uac70\ub9ac, \ub9e8\ud558\ud0c4 \uac70\ub9ac, \ub9c8\ud560\ub77c\ub178\ube44\uc2a4 \uac70\ub9ac, \uc0c1\uad00\uacc4\uc218 \uac70\ub9ac, dtw \ub4f1\n\n## 2. \ub450 \uad70\uc9d1 \uc0ac\uc774\uc758 \uac70\ub9ac \uce21\uc815 \ubc29\ubc95 \uc815\ud558\uae30 (Min, max, group average, between centroid \ub4f1)\n\n![1_2_1.PNG](attachment:6e0112d0-16a8-4a1a-a5a6-950d701884d2.PNG)","f3a74006":"## K-Means \ud074\ub7ec\uc2a4\ud130\ub9c1","c1795c1d":"![1_2_2.PNG](attachment:c97e830d-f7a8-4171-b9f2-71ab91d31dad.PNG)","acf6c9b4":"## \uacc4\uce35\uc801 \ud074\ub7ec\uc2a4\ud130\ub9c1"}}