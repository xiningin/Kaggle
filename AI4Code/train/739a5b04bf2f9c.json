{"cell_type":{"5b8ad941":"code","cceb61d5":"code","036706b4":"code","6235e239":"code","519beedb":"code","f08eb0d7":"code","aa14e8d3":"code","8b4eb22d":"code","43a09c30":"markdown","4fefaf95":"markdown","582c63a1":"markdown","7a22be8e":"markdown","9e10abf8":"markdown","2c668104":"markdown","f00b26ff":"markdown","e69b52a6":"markdown","6e910304":"markdown"},"source":{"5b8ad941":"import numpy as np\nimport pandas as pd\nimport h2o\nfrom h2o.automl import H2OAutoML","cceb61d5":"from h2o.automl import H2OAutoML\nh2o.init()","036706b4":"train = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ntest = pd.read_csv('..\/input\/titanic\/test.csv')\nsubs = pd.read_csv('..\/input\/titanic\/gender_submission.csv')\n\ndrop_elements = ['PassengerId', 'Name', 'Ticket', 'Cabin', 'SibSp','Parch']\ntrain = train.drop(drop_elements, axis = 1)\ntest = test.drop(drop_elements, axis = 1)\n\ndef checkNull_fillData(df):\n    for col in df.columns:\n        if len(df.loc[df[col].isnull() == True]) != 0:\n            if df[col].dtype == \"float64\" or df[col].dtype == \"int64\":\n                df.loc[df[col].isnull() == True,col] = df[col].mean()\n            else:\n                df.loc[df[col].isnull() == True,col] = df[col].mode()[0]\n                \ncheckNull_fillData(train)\ncheckNull_fillData(test)\n\nstr_list = [] \nnum_list = []\nfor colname, colvalue in train.iteritems():\n    if type(colvalue[1]) == str:\n        str_list.append(colname)\n    else:\n        num_list.append(colname)\n        \ntrain = pd.get_dummies(train, columns=str_list)\ntest = pd.get_dummies(test, columns=str_list)\n\ntrain = h2o.H2OFrame(train)\ntest = h2o.H2OFrame(test)","6235e239":"train.describe()","519beedb":"MAX_RUNTIME = 1800 #30 mins\nRANDOM_SEED = 12 \n\ny = \"Survived\"\ntrain[y] = train[y].asfactor()\nx = train.columns\nx.remove(y)","f08eb0d7":"aml = H2OAutoML(seed = RANDOM_SEED , max_runtime_secs=MAX_RUNTIME)\naml.train(x = x, y = y, training_frame = train)","aa14e8d3":"lb = aml.leaderboard\nlb.head(10)","8b4eb22d":"preds = aml.leader.predict(test)\nsub = preds[0].as_data_frame()  ## Converting to dataframe\nsubs['Survived'] = sub\nsubs.to_csv('h20.ai-automl.csv',index = False)","43a09c30":"### Submission","4fefaf95":"# Imports","582c63a1":"# AutoML","7a22be8e":"# Initializing H20 Cluster","9e10abf8":"# Results Leaderboard","2c668104":"### Top 10 models","f00b26ff":"**Created by Sanskar Hasija**\n\n**\ud83e\udd16H2O.ai AutoML Classification - Titanic**\n\n**15 NOVEMBER 2021**\n","e69b52a6":"# <center> \ud83e\udd16H2O.AI AUTOML CLASSIFICATION - TITANIC<\/center>\n## <center>If you find this notebook useful, support with an upvote\ud83d\udc4d<\/center>","6e910304":"# Data Loading and Preprocessing"}}