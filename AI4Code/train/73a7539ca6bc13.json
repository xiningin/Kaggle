{"cell_type":{"77b479b6":"code","62efbcd8":"code","05bd8093":"code","8c63c143":"code","f106eac9":"code","b0e6a814":"markdown","edb4bebf":"markdown","24f848eb":"markdown","25ab7032":"markdown","4fe477dc":"markdown","76dc1e5c":"markdown","9d8e4147":"markdown","1093d6c3":"markdown","11d2e9f9":"markdown","ac7d2a49":"markdown","1c968142":"markdown","ab9e69c7":"markdown","054d7074":"markdown","ce4e3530":"markdown","8a80dae8":"markdown"},"source":{"77b479b6":"import pandas as pd\nfeature_names = [\n    'age',\n    'workclass',\n    'fnlwgt',\n    'education',\n    'education-num',\n    'marital-status',\n    'occupation',\n    'relationship',\n    'race',\n    'sex',\n    'capital-gain',\n    'capital-loss',\n    'hours-per-week',\n    'native-country',\n    'income',\n]  \ndf = pd.read_csv('https:\/\/archive.ics.uci.edu\/ml\/machine-learning-databases\/adult\/adult.data',names = feature_names)\ndf.head(5)","62efbcd8":"low = df['income'][0]\ny = df['income'].apply(lambda x:0 if x==low else 1) \ny.head(10)","05bd8093":"X = df.drop(['income'],axis=1)\nX.head(10)","8c63c143":"X = pd.get_dummies(X) \nX.head(10)","f106eac9":"from  sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=1)","b0e6a814":"# Feature Engineering and Feature Selection\n[COMP20121 Machine Learning for Data Analytics](https:\/\/sites.google.com\/site\/hejunhomepage\/Teaching\/machine-learning-for-data-analytics)\n\nAuthor: Jun He  ","edb4bebf":"### Understand Data\n* In this lab, you use a classical UCI data, known as \"Census Income\" dataset: to predict whether income exceeds \\$50K\/yr based on census data.\n* Go to https:\/\/archive.ics.uci.edu\/ml\/datasets\/adult. Read the introduction to the data\n* To help you go to the main task on feature selection, the code for prepare data is provided below.","24f848eb":"### Generate feature sets\n* drop `income` column","25ab7032":"### Resources\/references\n1. Garreta, R. and Moncecchi, G., 2013. Learning scikit-learn: machine learning in Python. Packt Publishing Ltd.\n    * Chapter 4. Advanced Features\n    * online access via NTU library\n1. Sklearn Feature selection: https:\/\/scikit-learn.org\/stable\/modules\/feature_selection.html\n1. https:\/\/machinelearningmastery.com\/feature-selection-with-real-and-categorical-data\/","4fe477dc":"### Load the adult data\n* Download the adult data from https:\/\/archive.ics.uci.edu\/ml\/machine-learning-databases\/adult\/adult.data\n* Add feature names","76dc1e5c":"## Activity 1 Decision Tree Classifier without feature selection\n### Evaluate the performance of a Decision Tree Classifier without feature selection\n* Create a DecisionTreeClassifier withour feature selection for predicting high and low income. \n* What is its accuracy of this model?","9d8e4147":"### Learning Objectives\n1. Learn to implement SelectPercentile with Sklearn\n1. Learn to implement RFE with Sklearn\n1. Learn to implement SelectFromModel with Sklearn","1093d6c3":"## Activity 5 Decision Tree Classifier with feature selection: SelectFromModel\n* Create Decision Tree Classifier with feature selection: SelectFromModel for predicting high and low income. \n* Use a pipeline object\n* What is its accuracy of this model? ","11d2e9f9":"### One-Hot Encode all categorical features\n* Use function `pandas.get_dummies` to encode categorical features\n* Note 1: for the sake of programming, we only use adult.data, but ignore adult.test for test. Otherwise, when we onehot-encode categorical features, we cannot apply `pandas.get_dummies` directly.\n* Note 2: we apply `pandas.get_dummies` to all categorical features for one-hot encoding. But it will be better to consider `OrdinalEncoding` for ordinal data.\n* Note 3: We will not handle missing values. `pandas.get_dummies` treats missing values (`?` in this data set) as an extra column (`workclass_?`)","ac7d2a49":"## Activity 3 Decision Tree Classifier with feature selection: RFE \n* Create Decision Tree Classifier with feature selection: RFE for predicting high and low income. \n* Use a pipeline object\n* What is its accuracy of this model?","1c968142":"## Import Data and Prepare Data ","ab9e69c7":"## Reflect\nBriefly note what you\u2019ve learnt, found easy and found challenging in your Jupyter notebook. Keep these notes safe and maintain a reflective log for each lab session.","054d7074":"### Create target variable\n* create the target variable `y` using a lambda function\n    * if `income>50K`, `y=1`\n    * if `incomde<=50K`, `y=0`","ce4e3530":"### Split data into training and test data\n* Use`sklearn.model_selection.train_test_split` split the data with 30% for test","8a80dae8":"## Activity 2 Decision Tree Classifier with feature selection: SelectPercentile \n* Create Decision Tree Classifier with feature selection: SelectPercentile  for predicting high and low income. \n* Use a pipeline object\n* What is its accuracy of this model? "}}