{"cell_type":{"d9670c1c":"code","7dce1940":"code","c01502b4":"code","21941c13":"code","d913673f":"code","13d63bfd":"code","1c14d50d":"markdown","292fafcc":"markdown"},"source":{"d9670c1c":"import numpy as np \nimport pandas as pd\n\nfrom sklearn.model_selection import train_test_split\nimport random\nimport tensorflow as tf\nfrom tensorflow.keras.layers import Dense ,Dropout\nfrom tensorflow.keras.models import Sequential\n","7dce1940":"path = \"\/kaggle\/input\/passenger-list-for-the-estonia-ferry-disaster\/estonia-passenger-list.csv\"\ndata = pd.read_csv(path)\nds = data.values\nrandom.shuffle(ds)","c01502b4":"X,y = (ds[:,4:7],ds[:,7:8])\n\nfor i in range(0,len(X)):\n    if X[i,0] == 'M':\n        X[i,0] = 0\n    else:\n        X[i,0] = 1\n    \n    if X[i,2] == 'P':\n        X[i,2] = 0\n    else:\n        X[i,2] = 1\n        \n#conversion to not get type error.        \nX = np.asarray(X).astype(np.float32)\ny = np.asarray(y).astype(np.float32)\n\n#test data split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=13)\n","21941c13":"model = tf.keras.models.Sequential([\n  tf.keras.layers.Dense(128, activation='relu'),\n  tf.keras.layers.Dense(128, activation='relu'),\n  tf.keras.layers.Dense(128, activation='relu'),\n  tf.keras.layers.Dropout(0.2),\n  tf.keras.layers.Dense(10)\n])\n\nmodel.compile(optimizer='adam',\n              loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True),\n              metrics=['accuracy'])","d913673f":"history = model.fit(X_train, \n                    y_train, \n                    batch_size= 10, \n                    validation_data=(X_test,y_test))","13d63bfd":"score = model.evaluate(X, y)","1c14d50d":"I want to see score on whole data so I am evaluating whole data.","292fafcc":"Since id, country, name and surname seems not relevant I removed them from the data.\nAlso to convert every data to a number value I have used for loop."}}