{"cell_type":{"75acfd05":"code","487f9c91":"code","5a291391":"code","82e6e8ba":"code","d4607207":"code","956ca7d5":"code","528ffd4b":"code","3123f58e":"code","8fccc649":"code","21268ffd":"code","05ddc5a6":"code","7a68a9bc":"code","8f73f3cb":"code","af15ea91":"code","776507dd":"code","6f33de11":"code","cccf05d1":"code","5f048b46":"code","4bc28f29":"code","793bd635":"code","23c1485f":"code","f9c7aa0e":"code","c2779e82":"code","3a537a70":"code","505d1d5b":"code","8f4e7dc5":"code","7e8e35cf":"code","cc96ab25":"code","2b2cadaf":"code","6ad31cec":"code","6e88a104":"code","b08142bc":"code","2f0eab9a":"code","c1540820":"code","8f9c7a58":"code","c43f2e20":"code","ce3f5fdd":"code","2077ebd1":"code","8c0fd825":"code","b63674f5":"code","44828e65":"code","56107eaf":"code","2505e5eb":"code","0d66f8bf":"code","bb41e3b8":"code","3aa5bf80":"markdown","5cd7b67b":"markdown","99b1fdd5":"markdown","2e2c8af5":"markdown","085c6f7f":"markdown","65731d79":"markdown","a79e5f4e":"markdown","70fc9ad5":"markdown","fd2be1c9":"markdown","1cc77d5e":"markdown","9c53a148":"markdown","e99ac7bc":"markdown","1986d653":"markdown"},"source":{"75acfd05":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.metrics import plot_confusion_matrix, classification_report","487f9c91":"# load the train data to df \ndf = pd.read_csv('..\/input\/airline-passenger-satisfaction\/train.csv')","5a291391":"df.head()","82e6e8ba":"df.info()","d4607207":"# Remove the unnecessary features\ndf = df.drop(['Unnamed: 0', 'id'], axis = 1)\ndf.info()","956ca7d5":"# Checking if there are nan values in the data\nsns.set_style('whitegrid')\nplt.figure(figsize=(14,10))\nsns.set_context('paper', font_scale=1.4)\n\nsns.heatmap(df.isnull(),yticklabels=False,cbar=False,cmap='viridis')","528ffd4b":"# How many are there?\nnp.isnan(df['Arrival Delay in Minutes']).value_counts()","3123f58e":"df['Arrival Delay in Minutes'].mean()","8fccc649":"# Not too much. The nan values replace the mean.\ndf['Arrival Delay in Minutes'] = df['Arrival Delay in Minutes'].fillna(df['Arrival Delay in Minutes'].mean())\n# Checking again\nnp.isnan(df['Arrival Delay in Minutes']).value_counts()","21268ffd":"## I am doing the same for the test data as above ##","05ddc5a6":"# load the train data to test \ntest = pd.read_csv('..\/input\/airline-passenger-satisfaction\/test.csv')\n\ntest = test.drop(['Unnamed: 0', 'id'], axis = 1)\ntest.info()","7a68a9bc":"sns.set_style('whitegrid')\nplt.figure(figsize=(14,10))\nsns.set_context('paper', font_scale=1.4)\n\nsns.heatmap(test.isnull(),yticklabels=False,cbar=False,cmap='viridis')","8f73f3cb":"np.isnan(test['Arrival Delay in Minutes']).value_counts()","af15ea91":"test['Arrival Delay in Minutes'] = test['Arrival Delay in Minutes'].fillna(test['Arrival Delay in Minutes'].mean())\nnp.isnan(test['Arrival Delay in Minutes']).value_counts()","776507dd":"## -------------------------------------------- ##","6f33de11":"# Graph of neutral or dissatisfied vs satisfied customers\nsns.set_style('whitegrid')\nplt.figure(figsize=(8,6))\nsns.set_context('paper', font_scale=1.5)\n\nsns.countplot(x='satisfaction', data = df).set_title('Neutral or Dissatisfied vs Statisfied')","cccf05d1":"# What does customer satisfaction look like by Age?\nsns.set_style('whitegrid')\nplt.figure(figsize=(10,8))\nsns.set_context('paper', font_scale=1.5)\n\nsns.histplot(x='Age', data = df,\n             hue ='satisfaction').set_title('Customer satisfaction by Age')","5f048b46":"df[(df['Age'] >= 40) & (df['Age'] <= 60)]['Age'].count()","4bc28f29":"df[(df['Age'] < 40)]['Age'].count()","793bd635":"# Graphs of satisfaction customers by Class, Customer Type and Type of Travel.\n\nsns.set_style('whitegrid')\nfig, ax = plt.subplots(1,3, figsize=(18,16))\nsns.set_context('paper', font_scale=1.5)\n\nax[0].set_title('Customer Satisfaction by Class')\nsns.countplot(x='satisfaction', data = df, hue = 'Class', ax=ax[0])\n\nax[1].set_title('Customer Satisfaction by Customer Type')\nsns.countplot(x='satisfaction', data = df, hue = 'Customer Type', ax=ax[1])\n\nax[2].set_title('Customer Satisfaction by Type of Travel')\nsns.countplot(x='satisfaction', data = df, hue = 'Type of Travel', ax=ax[2])","23c1485f":"# A glance at the correlations\nsns.set_style('whitegrid')\nplt.figure(figsize=(25,15))\nsns.set_context('paper', font_scale=1.4)\n\ncrash_mx = df.corr()\nsns.heatmap(crash_mx, annot=True, cmap='Blues')","f9c7aa0e":"# We know that there are differences between the Business class vs the Eco and Eco plus classes.\n# We will see what the average ratings look like in featuers where clients gave scores from 0 to 5.\n# We will consider these featuers separately for the business class vs for the Eco and Eco Plus classes.\n\n# Looking at Mean values in Eco and Eco Plus classes\ndf[df['Class'] != 'Business'].describe()","c2779e82":"# Creates a data frames that contains mean values. For satisfied and neutral or dissatisfied customers\n# Eco and Eco Plus Classes\ndf_s = df[(df['satisfaction'] != 'neutral or dissatisfied') & (df['Class'] != 'Business')].describe()\ndf_nds = df[(df['satisfaction'] == 'neutral or dissatisfied') & (df['Class'] != 'Business')].describe()\n\n# Creates a data frame that contains only a row with mean values for the selected featuers\n# satisfied\ndf_s_mean = df_s[1:2][['Inflight wifi service', 'Departure\/Arrival time convenient', \n                       'Ease of Online booking', 'Gate location', 'Food and drink', \n                       'Online boarding', 'Seat comfort', 'Inflight entertainment', 'On-board service', \n                       'Leg room service', 'Baggage handling','Checkin service', 'Inflight service', \n                       'Cleanliness']]\n# Changing  the name of index from 'mean' to 'satisfied'\ndf_s_mean = df_s_mean.rename(index = {'mean':'satisfied'})\n\n###\n\n# Creates a data frame that contains only a row with mean values for the selected featuers\n# neutral or dissatisfied\ndf_nds_mean = df_nds[1:2][['Inflight wifi service', 'Departure\/Arrival time convenient', \n                       'Ease of Online booking', 'Gate location', 'Food and drink', \n                       'Online boarding', 'Seat comfort', 'Inflight entertainment', 'On-board service', \n                       'Leg room service', 'Baggage handling','Checkin service', 'Inflight service', \n                       'Cleanliness']]\n# Changing  the name of index from 'mean' to 'neutral or dissatisfied'\ndf_nds_mean = df_nds_mean.rename(index = {'mean':'neutral or dissatisfied'})\n\n###\n\n# Combines two data frames into one\nfinal_mean = pd.concat([df_nds_mean, df_s_mean])\nfinal_mean","3a537a70":"# Graph of Mean Grades in Eco and Eco Plus Class by selected featuers\nfinal_mean.T.plot(figsize=(16,10), fontsize=15, kind = 'bar', \n                          title='Mean Grades in Eco and Eco Plus Class')","505d1d5b":"## Check the same for business class ##","8f4e7dc5":"# Creates a data frames that contains mean values. For satisfied and neutral or dissatisfied customers\n# Business Classes\ndf_sb = df[(df['satisfaction'] != 'neutral or dissatisfied') & (df['Class'] == 'Business')].describe()\ndf_ndsb = df[(df['satisfaction'] == 'neutral or dissatisfied') & (df['Class'] == 'Business')].describe()\n\n# Creates a data frame that contains only a row with mean values for the selected featuers\n# satisfied\ndf_sb = df_sb[1:2][['Inflight wifi service', 'Departure\/Arrival time convenient', \n                       'Ease of Online booking', 'Gate location', 'Food and drink', \n                       'Online boarding', 'Seat comfort', 'Inflight entertainment', 'On-board service', \n                       'Leg room service', 'Baggage handling','Checkin service', 'Inflight service', \n                       'Cleanliness']]\n# Changing  the name of index from 'mean' to 'satisfied'\ndf_sb = df_sb.rename(index = {'mean':'satisfied'})\n\n###\n\n# Creates a data frame that contains only a row with mean values for the selected featuers\n# neutral or dissatisfied\ndf_ndsb = df_ndsb[1:2][['Inflight wifi service', 'Departure\/Arrival time convenient', \n                       'Ease of Online booking', 'Gate location', 'Food and drink', \n                       'Online boarding', 'Seat comfort', 'Inflight entertainment', 'On-board service', \n                       'Leg room service', 'Baggage handling','Checkin service', 'Inflight service', \n                       'Cleanliness']]\n# Changing  the name of index from 'mean' to 'neutral or dissatisfied'\ndf_ndsb = df_ndsb.rename(index = {'mean':'neutral or dissatisfied'})\n\n\n# Combines two data frames into one\nfinal_meanb = pd.concat([df_ndsb, df_sb])\nfinal_meanb","7e8e35cf":"# Graph of Mean Grades in Business Class by selected featuers\nfinal_meanb.T.plot(figsize=(16,10), fontsize=15, kind = 'bar', \n                          title='Mean Grades in Business Class')","cc96ab25":"# How does flight distance affect customer satisfaction?\n\nsns.set_style('whitegrid')\nplt.figure(figsize=(8,6))\nsns.set_context('paper', font_scale=1.5)\n\nsns.histplot(x='Flight Distance', data = df, bins = 20, hue ='satisfaction', \n             kde = True).set_title('Histogram of Flight Distance')","2b2cadaf":"# How is this feautre distributed in the Eco and Eco Plus class?\n\nsns.set_style('whitegrid')\nplt.figure(figsize=(8,6))\nsns.set_context('paper', font_scale=1.5)\n\nsns.histplot(x='Flight Distance', data = df[df['Class'] != 'Business'], bins = 20, hue ='satisfaction', \n             kde = True).set_title('Histogram of Flight Distance by Eco and Eco Plus Class')","6ad31cec":"# How is this feautre distributed in the Business class?\n\nsns.set_style('whitegrid')\nplt.figure(figsize=(8,6))\nsns.set_context('paper', font_scale=1.5)\n\nsns.histplot(x='Flight Distance', data = df[df['Class'] == 'Business'], bins = 20, hue ='satisfaction', \n             kde = True).set_title('Histogram of Flight Distance by Business Class')","6e88a104":"# Departure Delay in Minutes vs Arrival Delay in Minutes\nsns.set_style('whitegrid')\nplt.figure(figsize=(8,6))\nsns.set_context('paper', font_scale=1.5)\n\ng = sns.jointplot(x='Departure Delay in Minutes', y='Arrival Delay in Minutes', \n              data = df, hue = 'satisfaction')\n\ng.fig.suptitle('Departure Delay in Minutes vs Arrival Delay in Minutes')","b08142bc":"# Histogram of Departure Delay\nsns.set_style('whitegrid')\nplt.figure(figsize=(8,6))\nsns.set_context('paper', font_scale=1.5)\n\nsns.histplot(x='Departure Delay in Minutes', data = df[df['Departure Delay in Minutes'] > 0], \n             bins = 50, hue ='satisfaction', kde = True).set_title('Histogram of Departure Delay')","2f0eab9a":"# Histogram of Arrival Delay\nsns.set_style('whitegrid')\nplt.figure(figsize=(8,6))\nsns.set_context('paper', font_scale=1.5)\n\nsns.histplot(x='Arrival Delay in Minutes', data = df[df['Arrival Delay in Minutes'] > 1], \n             bins = 50, hue ='satisfaction', kde = True).set_title('Histogram of Arrival Delay')","c1540820":"# Graphs of Customer Satisfaction by Departure and Arrival Delay\nsns.set_style('whitegrid')\nfig, ax = plt.subplots(1,4, figsize=(25,10))\nsns.set_context('paper', font_scale=1.9)\n\nax[0].set_title('Customer Satisfaction \\nby Flight without any delays\\n')\nsns.countplot(x='satisfaction', order = ['neutral or dissatisfied', 'satisfied'], \n              data = df[(df['Departure Delay in Minutes'] == 0) & (df['Arrival Delay in Minutes'] == 0)], \n              ax=ax[0])\n\nax[1].set_title('Customer Satisfaction \\nby Flight with delayed departure and arrival\\n')\nsns.countplot(x='satisfaction', order = ['neutral or dissatisfied', 'satisfied'], \n              data = df[(df['Departure Delay in Minutes'] > 0) & (df['Arrival Delay in Minutes'] > 0)], \n              ax=ax[1])\n\nax[2].set_title('Customer Satisfaction \\nby Flight with on-time departure \\nand delayed arrival')\nsns.countplot(x='satisfaction', order = ['neutral or dissatisfied', 'satisfied'], \n              data = df[(df['Departure Delay in Minutes'] == 0) & (df['Arrival Delay in Minutes'] > 0)], \n              ax=ax[2])\n\nax[3].set_title('Customer Satisfaction \\nby Flight with delayed departure \\nand on-time arrival')\nsns.countplot(x='satisfaction', order = ['neutral or dissatisfied', 'satisfied'], \n              data = df[(df['Departure Delay in Minutes'] > 0) & (df['Arrival Delay in Minutes'] == 0)], \n              ax=ax[3])","8f9c7a58":"df.info()","c43f2e20":"# First deal with features that are objects, using get_dummies\n\n#train data\ntrain = pd.get_dummies(df, drop_first = False, columns = ['Gender', 'Customer Type', \n                                                         'Type of Travel', 'Class'])\n#test data\ntest = pd.get_dummies(test, drop_first = False, columns = ['Gender', 'Customer Type', \n                                                         'Type of Travel', 'Class'])","ce3f5fdd":"train.info()","2077ebd1":"# Changing feature satisfaction:\n# 1 - satisfied\n# 0 - neutral or dissatisfied\n\ntrain['satisfaction'] = train['satisfaction'].apply(lambda x: np.where(x=='satisfied', 1, 0))\ntest['satisfaction'] = test['satisfaction'].apply(lambda x: np.where(x=='satisfied', 1, 0))","8c0fd825":"# preparing train_test_set\nX_train = train.drop('satisfaction', axis = 1)\ny_train = train['satisfaction']\n\nX_test = test.drop('satisfaction', axis = 1)\ny_test = test['satisfaction']\n\nX = pd.concat([X_train, X_test])\ny = pd.concat([y_train, y_test])","b63674f5":"# making a dictionary in which we include two models with some parameters pre-set.\nmodel_params = {\n    'random_forest' :{\n        'model' : RandomForestClassifier(),\n        'params' : {\n            'n_estimators' : [1, 5, 10, 100]\n        }\n    },\n    \n    'logistics_regression' : {\n        'model' : LogisticRegression(solver = 'lbfgs', multi_class = 'auto'),\n        'params' : {\n            'C' : [0.1, 1, 10, 100],\n            'solver' : ['lbfgs', 'liblinear']\n        }\n    }\n}","44828e65":"# implement GridSearchCV for two models using a loop and a previously created dictionary\n# in the created variable scores, we save best_score and best_params for each model\nscores = []\n\nfor model_name, mp in model_params.items():\n    clf = GridSearchCV(mp['model'], mp['params'], cv=5, n_jobs=-1)\n    print(mp['model'])\n    print('\\nfitting...')\n    clf.fit(X, y)\n    scores.append({\n        'model' : model_name,\n        'best_score' : clf.best_score_,\n        'best_params' : clf.best_params_\n    })\n    print('\\nscore is appended\\n')","56107eaf":"# making data frame with best scores and best params\nsc = pd.DataFrame(scores, columns=['model', 'best_score', 'best_params'])\nsc","2505e5eb":"# implementing Random Forest model with best_params\nclf_rfc = RandomForestClassifier(n_estimators =  100)\nclf_rfc.fit(X_train, y_train)","0d66f8bf":"# confusion matrix RFC\nsns.set_style(\"whitegrid\", {'axes.grid' : False})\nplot_confusion_matrix(clf_rfc,\n                     X_test,\n                     y_test,\n                     values_format = 'd',\n                     display_labels=['neutral or \\ndissatisfied', 'satisfied'])","bb41e3b8":"# Create a classification report for the RFC model \npredictions_rfc = clf_rfc.predict(X_test)\n\n# Create a classification report for the RFC model \nprint(classification_report(y_test,predictions_rfc))","3aa5bf80":"<h4>Random Forest<h4>","5cd7b67b":"<p>More are neutral or dissatisfied than satisfied customers in the Eco or Eco Plus class.\nThe opposite was the case in the Business class, where we have more satisfied customers than neutral or dissatisfied.<\/p>\n<br>\n\n<p>We also know that the type of satisfaction of loyal customers is spread with a slight advantage for neutral or dissatisfied. (40k : 44k) - 84k Loyal Customers<\/p>\n\n<p>In the case of disloyal customers, the type of satisfaction that is neutral or dissatisfied is slightly over 3 times greater than that of satisfied customers. However, there are almost 4.5 times less disloyal customers than loyal customers. (14.5k : 4.5k) - 19k disloyal Customers<\/p>\n<br>\n\n<p>Most of the business travelers were satisfied. However, the difference is not that big when comparing the number of neutral or dissatisfied customers.<\/p>","99b1fdd5":"Let's focus on neutral or dissatisfied customers:\nLow Average grades will appear among others.\n<ul>\nTop 3:\n<li>Inflight wifi service<\/li>\n<li>Ease of Online booking<\/li>\n<li>Online boarding<\/li>\n<\/ul>\nIt can be seen that these indicators correlate with each other. Perhaps it would be worth looking at them in real life. This means checking, for example, the operation of wifi (Inflight wifi service) and the system and application, or creating a more user-friendly interface (Online boarding, Ease of Online booking).\n\nSatisfied customers rated these three featuers high, so maybe they didn't always work properly.","2e2c8af5":"<h4>EDA<\/h4>","085c6f7f":"In general, a delay in departure affects the delay in arrival.\n\nMost of delayed departures and arrivals are about 30 minutes. But there are even cases up to 200 minutes.\n\nHow do delays translate into satisfaction?","65731d79":"<h4>Imports<\/h4>","a79e5f4e":"<h4>Prediction<\/h4>","70fc9ad5":"<h3>Airline Passenger Satisfaction<\/h3>\n<br>\n<br>\n\n<h3>Tasks<\/h3>\n<br>\n<p>What factors lead to customer satisfaction for an Airline?<\/p>\n<br>\n<p>Predict passenger satisfaction<\/p>\n<br>\n<br>\n\n<h3>Data<\/h3>\n<br>\n\n<ol>\n    <li>Gender: Gender of the passengers (Female, Male)<\/li>\n    <li>Customer Type: The customer type (Loyal customer, disloyal customer)<\/li>\n    <li>Age: The actual age of the passengers<\/li>\n    <li>Type of Travel: Purpose of the flight of the passengers (Personal Travel, Business Travel)<\/li>\n    <li>Class: Travel class in the plane of the passengers (Business, Eco, Eco Plus)<\/li>\n    <li>Flight distance: The flight distance of this journey<\/li>\n    <li>Inflight wifi service: Satisfaction level of the inflight wifi service (0:Not Applicable;1-5)<\/li>\n    <li>Departure\/Arrival time convenient: Satisfaction level of Departure\/Arrival time convenient<\/li>\n    <li>Ease of Online booking: Satisfaction level of online booking<\/li>\n    <li>Gate location: Satisfaction level of Gate location<\/li>\n    <li>Food and drink: Satisfaction level of Food and drink<\/li>\n    <li>Online boarding: Satisfaction level of online boarding<\/li>\n    <li>Seat comfort: Satisfaction level of Seat comfort<\/li>\n    <li>Inflight entertainment: Satisfaction level of inflight entertainment<\/li>\n    <li>On-board service: Satisfaction level of On-board service<\/li>\n    <li>Leg room service: Satisfaction level of Leg room service<\/li>\n    <li>Baggage handling: Satisfaction level of baggage handling<\/li>\n    <li>Check-in service: Satisfaction level of Check-in service<\/li>\n    <li>Inflight service: Satisfaction level of inflight service<\/li>\n    <li>Cleanliness: Satisfaction level of Cleanliness<\/li>\n    <li>Departure Delay in Minutes: Minutes delayed when departure<\/li>\n    <li>Arrival Delay in Minutes: Minutes delayed when Arrival<\/li>\n    <li>Satisfaction: Airline satisfaction level(Satisfaction, neutral or dissatisfaction)<\/li>\n<\/ol>\n","fd2be1c9":"Apart from the fact that our top 3 eco-class features are at a low level in the business class and fairly evenly assessed taking into account the difference into satisfaction.\n\nIn addition, neutral or dissatisfied business class customers counted on better:\n<ul>\n<li>Inflight entertainment<\/li>\n<li>Cleanliness<\/li>\n<\/ul>","1cc77d5e":"<p>In the first chart where we check all customers, you can see that a large proportion of the flights are in the range of 0-1250 (distance). Twice or more clients, depending on the specific distance, are neutral or dissatisfied.\nMost of them are in the range of 250 - 750.<\/p>\n<br>\n<p>In the Eco and Eco Plus classes, the above conclusion repeats itself, and dissatisfaction in relation to satisfaction occurs with even more customers.<\/p>\n<br>\n\n<p>In the Business class, the number of satisfied customers generally prevails.\nOn the 0-1250 distance, the advantage of satisfied customers is visible, while above 1250 the advantage is significant.<\/p>\n\n<br>\nIf we would like to increase customer satisfaction. Some additions could be considered for customers in the Eco and Eco Plus class who fly 250 - 750. If possible.","9c53a148":"<p>There are more satisfied customers than dissatisfied customers in the age range from 40 to 60 years.\nThis age range is 43% of customers.<\/p>\n<br>\n<p>Customers under 40 years old = 49%<\/p>\n<p>Customers over 60 years old = 8%<\/p>","e99ac7bc":"<p>Generally, there is high neutral or dissatisfaction with customers everywhere, but it makes sense because there were more of them.\nHowever, it can be seen that arriving on time, despite a delayed departure, is important because you can see almost an equal number of satisfied and neutral or dissatisfied customers.<\/p>","1986d653":"Random Forest did quite well. We have a precision of 96%.\nThe remaining ratios are at the level of 94% - 98%."}}