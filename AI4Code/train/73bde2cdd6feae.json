{"cell_type":{"47af153b":"code","18b32b56":"code","ddd9e1b4":"code","b25589b9":"code","71ca9858":"code","0470aad7":"code","4fa52bed":"code","2be941df":"code","9f2adfa5":"code","defc9acb":"code","06fb4c7a":"code","224ae793":"code","7f15442e":"markdown","3ae4afc4":"markdown","d78c3b8f":"markdown","bf393d7c":"markdown","7e1ec1e3":"markdown","1008aaf1":"markdown","258b2b4f":"markdown","2b6aa9b8":"markdown"},"source":{"47af153b":"!pip install openpyxl\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","18b32b56":"df_athletes = pd.read_excel('..\/input\/2021-olympics-in-tokyo\/Athletes.xlsx')","ddd9e1b4":"df_athletes.head(10)","b25589b9":"df_coaches = pd.read_excel('..\/input\/2021-olympics-in-tokyo\/Coaches.xlsx')\ndf_entriesgender = pd.read_excel('..\/input\/2021-olympics-in-tokyo\/EntriesGender.xlsx')\ndf_medals = pd.read_excel('..\/input\/2021-olympics-in-tokyo\/Medals.xlsx')\ndf_teams = pd.read_excel('..\/input\/2021-olympics-in-tokyo\/Teams.xlsx')","71ca9858":"df_entriesgender.head(10)","0470aad7":"df_medals.head(10)","4fa52bed":"print(\"SOME STATS FROM THE TOKYO OLYMPICS 2021\\n\")\n\ntotalcountriesparticipated = len(df_athletes['NOC'].unique())\n\nprint(\"TOTAL NO. OF COUNTRIES WHICH PARTICIPATED: {}\\n\".format(totalcountriesparticipated))\n\nprint(\"TOTAL NO. OF EVENTS HELD: {}\\n\".format(len(df_entriesgender['Discipline'].unique())))\n\nprint(\"TOTAL NO. OF PARTICIPANTS: {}\\n\".format(len(df_athletes['Name'].tolist())))\n\nprint(\"TOTAL NO. OF MEDALS DISTRIBUTED: {}\".format(df_medals['Total'].sum()))\nprint(\"    GOLD: {}\".format(df_medals['Gold'].sum()))\nprint(\"    SILVER: {}\".format(df_medals['Silver'].sum()))\nprint(\"    BRONZE: {}\\n\".format(df_medals['Bronze'].sum()))\n\nprint(\"OUT OF THE {} COUNTRIES WHICH PARTICIPATED, {} COUNTIRES WON ATLEAST 1 MEDAL\".format(totalcountriesparticipated, df_medals['Team\/NOC'].count()))\nprint(\"    {} COUNTRIES WON ATLEAST 1 GOLD MEDAL\".format(df_medals['Gold'].count() - df_medals['Gold'].tolist().count(0)))\nprint(\"    {} COUNTRIES WON ATLEAST 1 SILVER MEDAL\".format(df_medals['Silver'].count() - df_medals['Silver'].tolist().count(0)))\nprint(\"    {} COUNTRIES WON ATLEAST 1 BRONZE MEDAL\\n\".format(df_medals['Bronze'].count() - df_medals['Bronze'].tolist().count(0)))\n\nindexmax_total = df_medals['Total'].idxmax()\nprint(\"THE COUNTRY WHICH WON THE MOST MEDALS: {} ({})\\n\".format(df_medals.loc[indexmax_total, 'Team\/NOC'], df_medals.loc[indexmax_total, 'Total']))\n\nindexmax_gold = df_medals['Gold'].idxmax()\nprint(\"THE COUNTRY WHICH WON THE MOST GOLD MEDALS: {} ({})\\n\".format(df_medals.loc[indexmax_gold, 'Team\/NOC'], df_medals.loc[indexmax_gold, 'Gold']))","2be941df":"df_medals_sortbyteamasc = df_medals.sort_values(by=['Team\/NOC'])\ntotalmedalrows = len(df_medals.index)\nbronzelist = df_medals_sortbyteamasc['Bronze'].tolist()\nsilverlist = df_medals_sortbyteamasc['Silver'].tolist()\ngoldlist = df_medals_sortbyteamasc['Gold'].tolist()\nbronzeplussilverlist = np.add(bronzelist, silverlist).tolist()\nplt.figure(figsize=(20, 20), dpi=100)\nplt.xticks(range(totalmedalrows), df_medals_sortbyteamasc['Team\/NOC'], rotation=90)\nplt.xlabel('Country')\nplt.ylabel('Total Medals')\nplt.title('Country wise Medals count - Distribution of all three medals')\nplt.bar(range(totalmedalrows), bronzelist, color='#CD7F32')\nplt.bar(range(totalmedalrows), silverlist, bottom=bronzelist, color='#C0C0C0')\nplt.bar(range(totalmedalrows), goldlist, bottom=bronzeplussilverlist, color='#FFD700')\nplt.legend(['Bronze', 'Silver', 'Gold'])\nplt.show()","9f2adfa5":"df_medals_top20total = df_medals.sort_values(by=['Total']).tail(20)\nplt.figure(figsize=(20, 20))\nwidth2 = 0.4\nplt.style.use('ggplot')\nplt.yticks(range(20), df_medals_top20total['Team\/NOC'])\nplt.xlabel('Total Medals')\nplt.title('Top 20 Countries which won the most medals')\nplt.barh(np.arange(20)+0.2, df_medals_top20total['Total'], width2)\nplt.barh(np.arange(20)-0.2, df_medals_top20total['Gold'], width2, color='#FFD700')\nplt.legend(['Total', 'Gold'])\nplt.show()","defc9acb":"country_withmorethan100ath = []\nmedals_withmorethan100ath = []\npercent_medalsbycount_withmorethan100ath = []\nnumberofathletes = []\ncurrentcount = 0\nfor country in df_athletes['NOC'].unique():\n    if df_athletes['NOC'].tolist().count(country) > 100:\n        country_withmorethan100ath.append(country)\n        numberofathletes.append(df_athletes['NOC'].tolist().count(country))\n        medals_withmorethan100ath.append(int(df_medals.loc[df_medals['Team\/NOC'] == country, 'Total']))\n        percent_medalsbycount_withmorethan100ath.append((medals_withmorethan100ath[currentcount] \/ numberofathletes[currentcount]) * 100)\n        currentcount = currentcount + 1    \nplt.figure(figsize=(20, 20))\ntotalitems = len(country_withmorethan100ath)\nplt.style.use('ggplot')\nplt.yticks(np.arange(totalitems), country_withmorethan100ath)\nplt.title('No. of Athletes vs Medals won [Countries with min 100 Athletes]')\nplt.barh(np.arange(totalitems)+0.2, numberofathletes, width2)\nplt.barh(np.arange(totalitems)-0.2, medals_withmorethan100ath, width2)\nplt.legend(['No. of Athletes', 'Total No. of Medals'])\nplt.show()","06fb4c7a":"plt.figure(figsize=(20, 20))\nplt.style.use('ggplot')\nplt.xticks(np.arange(totalitems), country_withmorethan100ath, rotation=90)\nplt.title('Percentage - Medals Won to Athletes [Countries with min 100 Athletes]')\nplt.bar(np.arange(totalitems), percent_medalsbycount_withmorethan100ath)\nplt.ylabel('Percentage')\nplt.show()","224ae793":"plt.figure(figsize=(20, 20))\ntotalitems = df_entriesgender['Discipline'].count()\nplt.yticks(np.arange(totalitems), df_entriesgender['Discipline'])\nplt.title('Distribution of Athletes across various Disciplines')\nplt.barh(np.arange(totalitems)-0.2, df_entriesgender['Male'], width2)\nplt.barh(np.arange(totalitems)+0.2, df_entriesgender['Female'], width2)\nplt.xlabel('No. of Athletes')\nplt.legend(['Male', 'Female'])\nplt.gca().invert_yaxis()\nplt.show()","7f15442e":"**Top 20 Countries Which won the most medals alongwith the share of the Gold medals won by those countries**","3ae4afc4":"**Plot showing No. of Athletes representing a country and the medals won by the country.**\n","d78c3b8f":"**Distribution of Athletes across various disciplines**","bf393d7c":"From the above 2 graphs, while USA, Japan and Australia had the most number of athletes representing their countries, ROC and People's Republic of China had a better ratio of medals to number of athletes.","7e1ec1e3":"**Country wise distribution of Medals**","1008aaf1":"Many of the events had an even number of Male and Female representation.\n\nSome events like Athletics, Boxing, Football, Wrestling, etc. had more number of Male representation.\n\nFrom the graph, it is clear that Rhythmic Gymnastics and Artistic Swimming are solely for Females.","258b2b4f":"Some very basic statistics","2b6aa9b8":"Countries which had a minimum of 100 athletes representation taken here"}}