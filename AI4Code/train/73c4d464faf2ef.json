{"cell_type":{"5d7db45b":"code","de70a847":"code","e0dd019a":"code","2c651466":"code","385789e3":"code","dc02498b":"code","d9774214":"code","84dbe10a":"code","4d9f7614":"code","5f7763a1":"code","d54de2b3":"code","a25e6761":"code","3acac3ab":"code","4e8091c3":"code","825e5656":"code","f8debb68":"code","8f3d34dc":"code","def58df4":"code","015a8e4f":"code","7ee7ce82":"code","8e551c01":"code","47878890":"code","2e9c83e9":"code","f8ecdc49":"code","04c5d77a":"code","aa7a122f":"code","3fffd131":"code","660d4597":"code","7d577785":"markdown","c8e4df2f":"markdown","f98ab4b8":"markdown","64e127b0":"markdown","21473661":"markdown","01997507":"markdown","a78a5e52":"markdown","a2f79e1e":"markdown","3056fb72":"markdown","f7ea5c7a":"markdown","d1cd4a94":"markdown","0e62a63a":"markdown","64b40f77":"markdown"},"source":{"5d7db45b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","de70a847":"df = pd.read_csv('..\/input\/sms-spam-collection-dataset\/spam.csv', encoding = 'latin-1')","e0dd019a":"df.head()","2c651466":"df.tail()","385789e3":"df = df.iloc[:, :2]","dc02498b":"df.head()","d9774214":"df.columns = ['label', 'message']","84dbe10a":"df.label.value_counts().plot.bar(rot = 0)","4d9f7614":"import re\nimport nltk\nnltk.download('stopwords')","5f7763a1":"from nltk.corpus import stopwords\nfrom nltk.stem.porter import PorterStemmer","d54de2b3":"ps = PorterStemmer()","a25e6761":"corpus = []\nfor i in range(0, len(df)):\n    review = re.sub('[^a-zA-Z]', ' ', df['message'][i])\n    review = review.lower()\n    review = review.split()\n    \n    review = [ps.stem(word) for word in review if not word in stopwords.words('english')]\n    review = ' '.join(review)\n    corpus.append(review)","3acac3ab":"from sklearn.feature_extraction.text import CountVectorizer","4e8091c3":"cv = CountVectorizer(max_features=2500)","825e5656":"X = cv.fit_transform(corpus).toarray()","f8debb68":"y=pd.get_dummies(df['label'])\ny=y.iloc[:,1].values","8f3d34dc":"from sklearn.model_selection import train_test_split","def58df4":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.25, random_state = 0)","015a8e4f":"from sklearn.naive_bayes import MultinomialNB","7ee7ce82":"spam_detect_model = MultinomialNB()","8e551c01":"spam_detect_model=spam_detect_model.fit(X_train, y_train)","47878890":"y_pred=spam_detect_model.predict(X_test)","2e9c83e9":"from sklearn.metrics import confusion_matrix","f8ecdc49":"confusion_mt=confusion_matrix(y_test,y_pred)","04c5d77a":"confusion_mt","aa7a122f":"from sklearn.metrics import accuracy_score","3fffd131":"model_accuracy=accuracy_score(y_test,y_pred)","660d4597":"model_accuracy","7d577785":"# Train Test Split","c8e4df2f":"# Now Check Accuracy Score","f98ab4b8":"# Now Create Dummies values","64e127b0":"# Now Creating the Bag of Words model","21473661":"# Now check head and tail of the data","01997507":"# Training model using Naive bayes classifier","a78a5e52":"# Now Data cleaning and preprocessing","a2f79e1e":"# Now Rename the Columns","3056fb72":"# Now Remove The unnecessary colums","f7ea5c7a":"# Now fit and Predict the model","d1cd4a94":"# Now Make Confusion Matrix","0e62a63a":"Import Some libs","64b40f77":"# Now Some Visualization "}}