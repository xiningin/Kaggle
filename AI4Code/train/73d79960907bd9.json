{"cell_type":{"106a978b":"code","ea60351d":"code","7f5f0e8a":"code","8ab412df":"code","42b7dd8e":"code","2240d24e":"code","e319f85d":"code","146a9fc7":"code","9c3623a9":"code","c3c683e4":"code","441db354":"code","7373e3ca":"code","3d9eef5a":"code","9893e282":"code","8a3da3b3":"code","9dd256b7":"code","dfbc8333":"code","59f16119":"code","302dd555":"code","4f4a8cc9":"code","79ffbf98":"code","c4b381ac":"code","d32c91c3":"code","231ab089":"code","ca2bcc78":"code","bcf8617c":"code","dbde7850":"code","976a61c8":"code","f243ffe9":"code","d7ae7a4f":"code","3ff1bfd9":"code","bca57642":"code","0696d198":"code","4eb79457":"code","8898c899":"markdown","cd34e9e6":"markdown","44b7b18a":"markdown","8c4eafd9":"markdown","5a17683e":"markdown","f5e24843":"markdown","89a237b5":"markdown","e4e322ff":"markdown","01c70fd5":"markdown","c727cd7e":"markdown","a487759e":"markdown","7594c2a2":"markdown","5209295a":"markdown","6dbb8fd9":"markdown","b6c6a19c":"markdown","0413b15f":"markdown","9e0cac43":"markdown","623b6634":"markdown","80905a2c":"markdown"},"source":{"106a978b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","ea60351d":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import preprocessing\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.metrics import r2_score, mean_squared_error , mean_absolute_error","7f5f0e8a":"df = pd.read_csv(r'\/kaggle\/input\/fish-market\/Fish.csv')\ndf.head()","8ab412df":"df.describe(include='all')","42b7dd8e":"df.isnull().sum()","2240d24e":"df.dtypes","e319f85d":"df['Species'].value_counts()","146a9fc7":"df.columns","9c3623a9":"sns.scatterplot(df['Length1'],df['Weight'],color = 'Red')","c3c683e4":"We can see a strong correlation between Lenth1 and weight.","441db354":"sns.scatterplot(df['Length2'],df['Weight'])","7373e3ca":"sns.scatterplot(df['Length3'],df['Weight'])","3d9eef5a":"sns.scatterplot(df['Height'],df['Weight'])","9893e282":"sns.scatterplot(df['Width'],df['Weight'])","8a3da3b3":"sns.countplot(df['Species'])","9dd256b7":"sns.boxplot(df['Species'],df['Weight'])","dfbc8333":"sns.distplot(df['Weight'],kde = True)","59f16119":"df.corr()['Weight']","302dd555":"df['Species'].value_counts()","4f4a8cc9":"a = pd.get_dummies(df['Species'])","79ffbf98":"a","c4b381ac":"df = pd.concat([df,a],1)","d32c91c3":"df.head()","231ab089":"df.drop('Species',axis =1,inplace =True)","ca2bcc78":"df = df[['Bream','Parkki','Perch','Pike','Roach','Smelt','Whitefish','Length1','Length2','Length3','Height','Width','Weight']]\ndf.head()","bcf8617c":"plt.figure(figsize =(15,15))\nsns.heatmap(df.corr(),annot =True)","dbde7850":"X = df.iloc[:,0:12]\ny =df.iloc[:,12]","976a61c8":"X = preprocessing.StandardScaler().fit(X).transform(X)\nX","f243ffe9":"X_train,X_test,Y_train,Y_test = train_test_split(X,y,test_size = 0.2,random_state = 1)","d7ae7a4f":"print(X_train.shape,X_test.shape,Y_train.shape,Y_test.shape)","3ff1bfd9":"regr = LinearRegression()\nregr.fit(X_train,Y_train)\ny_hat_regr = regr.predict(X_test)\nAccuracy = r2_score(Y_test,y_hat_regr)\nprint(Accuracy)","bca57642":"rf = RandomForestRegressor(n_estimators = 120,max_features =12,random_state=0,criterion ='mse')\nrf.fit(X_train,Y_train)\ny_hat_rf = rf.predict(X_test)\nAccuracy = r2_score(Y_test,y_hat_rf)\nprint(Accuracy)","0696d198":"gbr = GradientBoostingRegressor(n_estimators = 120,learning_rate =0.09,max_features =12,random_state = 0)\ngbr.fit(X_train,Y_train)\ny_hat_gbr=gbr.predict(X_test)\nAccuracy =r2_score(Y_test,y_hat_gbr)\nprint(Accuracy)","4eb79457":"dtr = DecisionTreeRegressor(random_state=1,max_features=12)\ndtr.fit(X_train,Y_train)\ny_hat_dtr = dtr.predict(X_test)\nAccuracy = r2_score(Y_test,y_hat_dtr)\nprint(Accuracy)","8898c899":"# One Hot Encoding\n","cd34e9e6":"# Finding Correlation****","44b7b18a":"# 2. Random Forest Regressor","8c4eafd9":"Maximum number of species are of Perch, followed by Bream and Roach. Whitefish has the lowest count.","5a17683e":"The correlation between Height and weight is strong but it is not strong as compared to Lengths and weights one.","f5e24843":"This Correlation is also a strong correlation.","89a237b5":"# Training Model with Different Algorithms.","e4e322ff":"# 3. Gradient Boosting Regressor","01c70fd5":"Pike fish has maximum range of weight where Smelt fish have smaller range of weights.","c727cd7e":"#  **** Importing Libraries","a487759e":"# In all these algorithms, Gradient Boosting Regressor and Decision Tree Regressor have higher accuray. Linear Regression algorithm have the least accuracy among the following.\n","7594c2a2":"# Visualizing different aspects.","5209295a":"# 1. Linear Regression","6dbb8fd9":"#  ****Importing DataSet","b6c6a19c":"We can see a strong correlation between Lenth3 and weight","0413b15f":"# 4. Decision Tree Regressor","9e0cac43":"# Dividing Set Into Training and Testing Data\n","623b6634":"We can see a strong correlation between Lenth2 and weight","80905a2c":"# Preprocessing the Data\n"}}