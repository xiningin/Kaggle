{"cell_type":{"c345d6ac":"code","d07579f7":"code","57e4b74c":"code","4390c43a":"code","2c02c89a":"code","05875d7d":"code","d8d926c8":"code","92ce705b":"code","abf9256f":"code","f180f7bf":"code","10da3a47":"code","dd549a36":"code","4c59c682":"code","44a864b2":"code","746af398":"code","14621b4f":"code","a541c404":"code","2a41b4bb":"code","ee2648f3":"code","dcc4abda":"code","c895ea20":"code","9888178f":"code","e719bd29":"code","c311b687":"code","3d454002":"code","ee297c69":"code","c5d46b6a":"code","b9a675e8":"code","1c34d0bb":"code","d5fb183d":"code","79539a8c":"code","b5721fe7":"code","1201dce7":"code","82c6aa71":"code","ef879d6d":"code","2cdcbe68":"code","301881ac":"code","9585ab77":"code","90a0efd1":"code","e52f8d63":"code","f9df6714":"code","3cb3ac70":"code","04c57e1b":"code","f0db7355":"code","637ac2e4":"code","82da115d":"code","dd1cdda7":"code","5a831c79":"code","3bf1f3f7":"code","c416d911":"code","b802a872":"code","a7799010":"code","9d82bd0e":"code","a5a525b1":"code","d10c6f91":"code","4164859d":"code","8aa96023":"code","a3ab22e0":"code","4bdcd983":"code","9b03f926":"code","d138d064":"code","42add006":"code","03c137ca":"code","ba534cf8":"code","934cffd9":"code","bedb7f91":"code","760ba521":"markdown","e661dc6f":"markdown","3b7172a9":"markdown","b32cc1b9":"markdown","de033cc6":"markdown","4a7324db":"markdown","a43f7a88":"markdown","db47acdf":"markdown","a273d274":"markdown","1d85f2ec":"markdown","b5b1cab4":"markdown","81d1fac0":"markdown","c30e283c":"markdown","c2902f44":"markdown","1827be4b":"markdown","c60b91bc":"markdown","867d6496":"markdown","2e914e83":"markdown","cd2960e8":"markdown","6dc730cb":"markdown","425dca45":"markdown","ebab8764":"markdown","f53e4043":"markdown","4ba35ea3":"markdown","bd5449a9":"markdown","90e47683":"markdown","802aa749":"markdown","7f79d031":"markdown","ac2d2422":"markdown","0c35caf3":"markdown","0122e42c":"markdown","c1f5d1b7":"markdown","0cb7a10d":"markdown","101d707b":"markdown","0506ba44":"markdown","c35a54a4":"markdown","d7b96a32":"markdown","9e645054":"markdown","4cc27eb5":"markdown","e759139f":"markdown","dc6d5457":"markdown"},"source":{"c345d6ac":"## Import necessary library for analysis\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings","d07579f7":"## Load data in pandas df\ndf = pd.read_csv(r\"..\/input\/factors-affecting-campus-placement\/Placement_Data_Full_Class.csv\", index_col=0)\ndf.head(3)","57e4b74c":"## Check nan\/missing values in each columns\ndf.isnull().sum()","4390c43a":"## Check detail description about numeric variables \ndf.describe()","2c02c89a":"## Check data type and shape of every column \ndf.info()","05875d7d":"df.hist(bins=50, figsize=(20,15))\nplt.show()","d8d926c8":"## Marginal Probability beteween categorical variables status & specialisation\npd.crosstab(index = df['specialisation'], columns=df['status'], margins =True, normalize = True)","92ce705b":"## Marginal Probability beteween categorical variables status & specialisation\npd.crosstab(index = df['specialisation'], columns=df['workex'], margins =True, normalize = 'columns')","abf9256f":"## Marginal Probability beteween categorical variables status & workexperience (workex)\npd.crosstab(index = df['status'], columns=df['workex'], margins =True, normalize = 'columns')","f180f7bf":"## Marginal Probability beteween categorical variables status & specialisation\npd.crosstab(index = df['degree_t'], columns=df['status'], margins =True, normalize =True)","10da3a47":"sns.countplot(x=\"status\", data=df, hue='specialisation')\nplt.title(\"Degree Specialization vs Candidate Placement\")\nplt.xlabel(\"Status of Placement\")\nplt.ylabel(\"Number of candidate\")\nplt.show()","dd549a36":"sns.lmplot(x='ssc_p', y='degree_p', data= df, hue ='specialisation', legend=True, palette=\"Set2\")\nplt.show()","4c59c682":"sns.countplot(x=\"status\", data=df, hue='workex')\nplt.title(\"Candidate Work Experience in Placement\")\nplt.xlabel(\"Status of Placement\")\nplt.ylabel(\"Number of candidate\")\nplt.show()","44a864b2":"sns.countplot(x=\"degree_t\", data=df, hue='status')\nplt.title(\"Candidate degree Technology in Placement\")\nplt.xlabel(\"Degree Technology\")\nplt.ylabel(\"Number of candidate\")\nplt.show()","746af398":"sns.pairplot(df.drop([\"salary\"], axis=1), kind=\"scatter\", hue=\"status\")\nplt.show()","14621b4f":"df.groupby([\"status\"]).mean()","a541c404":"df.status.value_counts()","2a41b4bb":"## Create another dataframe of only placed students and check its shape \ndf_placed = df.dropna(how=\"any\")\ndf_placed.shape","ee2648f3":"numeric_data = df_placed.select_dtypes(exclude = [object])\nnumeric_data.shape","dcc4abda":"## Box whiskers plot & histogram on the same window \n## Split the plotting window into 2 parts\n\nf, (ax_box, ax_hist)= plt.subplots(2, gridspec_kw={\"height_ratios\": (.15, .85)})\n## Add and create  box plot\nsns.boxplot(df_placed[\"salary\"], ax=ax_box)\n\nsns.distplot(df_placed[\"salary\"], ax=ax_hist, kde=False)\nplt.show()","c895ea20":"corr_matrix = numeric_data.corr()\ncorr_matrix","9888178f":"plt.figure(figsize=(20,10))\nsns.heatmap(corr_matrix,annot=True,cmap='YlGnBu')\nplt.show()","e719bd29":"## Variance Infilation Factor \n# X = numeric_data.drop(columns=['salary','mba_p',], axis=1)\n# vif = pd.DataFrame()\n# vif[\"features\"] = X.columns\n# vif[\"vif_factor\"] = [variance_inflation_factor(X.values, i) for i in range(X.shape[1])]\n# print(vif)","c311b687":"## Box and whiskers plot is very useful to find relationship between numerical & categorical variable.\n\nsns.boxplot(x=df_placed['gender'], y = df_placed['salary'], hue='specialisation', data=df_placed)\nplt.title(\"Salary vs Gender\")\nplt.xlabel(\"Gender of an candidate\")\nplt.xlabel(\"Salary of an candidate\")\nplt.show()","3d454002":"sns.pairplot(df_placed, kind=\"scatter\", hue=\"gender\")\nplt.show()","ee297c69":"sns.pairplot(df_placed, kind=\"scatter\", hue=\"specialisation\")\nplt.show()","c5d46b6a":"df_predict = df_placed.copy()\ndf_predict.shape","b9a675e8":"## Drop unneccesary columns\ndf_predict.drop(columns=['status','degree_p'], axis=1, inplace=True)\ndf_predict.shape","1c34d0bb":"## Converting categorical variables to dummy variables\n##df_predict=pd.get_dummies(df_placed, drop_first=True)\ndf_predict = pd.get_dummies(df_predict, columns=['gender','ssc_b','hsc_b','hsc_s','degree_t','workex','specialisation'], drop_first=True)\ndf_predict.shape","d5fb183d":"df_predict.head(3)","79539a8c":"## Importing necessary libraries\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn import metrics","b5721fe7":"## Separating input and output features\nx1 = df_predict.drop(['salary'], axis='columns', inplace=False)\ny1 = df_predict['salary']","1201dce7":"prices =pd.DataFrame({\"1. Before\":y1, \"2. After\":np.log(y1)})\nprices.hist()\nplt.show()","82c6aa71":"## Transform price as a logarithmic value\ny1 =np.log(y1)","ef879d6d":"x_train, x_test, y_train, y_test = train_test_split(x1, y1, test_size=0.40, random_state = 5)\nprint(x_train.shape, x_test.shape, y_train.shape, y_test.shape)","2cdcbe68":"## Setting intercept as true\nlgr = LinearRegression(fit_intercept =True)","301881ac":"## MODEL\nmodel_lin1 = lgr.fit(x_train, y_train)","9585ab77":"## Predicting model on test set\nsalary_predictions_lin1 = lgr.predict(x_test)","90a0efd1":"## Computing MSE and RMSE\nlin_mse1 = mean_squared_error(y_test, salary_predictions_lin1)\nlin_rmse1 = np.sqrt(lin_mse1)\nprint(lin_rmse1)","e52f8d63":"## R squared value\nr2_lin_test1 = model_lin1.score(x_test, y_test)\nr2_lin_train1 = model_lin1.score(x_train, y_train)\nprint(r2_lin_test1, r2_lin_train1)","f9df6714":"## Regression diagnostics :- Resident plot analysis\n## It is differnce test data and your prediction. It is just difference between actual & predicted value.\nresiduals1 = y_test - salary_predictions_lin1\nsns.regplot(x = salary_predictions_lin1, y=residuals1, scatter=True, fit_reg=False, data=df_placed)\nresiduals1.describe()","3cb3ac70":"#To retrieve the intercept:\nprint(model_lin1.intercept_)\n\n#For retrieving the slope:\ncoeff_df = pd.DataFrame(model_lin1.coef_, x1.columns,columns=['Coefficient'])  \ncoeff_df","04c57e1b":"df1 = pd.DataFrame({'Actual': y_test, 'Predicted':salary_predictions_lin1})\ndf1.head(10)","f0db7355":"df1.plot(kind='bar',figsize=(10,8))\nplt.grid(which='major', linestyle='-', linewidth='0.5')\nplt.grid(which='minor', linestyle=':', linewidth='0.5')\nplt.show()","637ac2e4":"\n## MODEL PARAMETERS\nrf = RandomForestRegressor(n_estimators = 100, max_features='auto', max_depth=100, min_samples_split=10, min_samples_leaf=3, random_state=4)","82da115d":"## MODEL\nmodel_rf1 =rf.fit(x_train, y_train)","dd1cdda7":"## Predicting model on test set\nsalary_predictions_rf1 = rf.predict(x_test)","5a831c79":"## Computing MSE and RSME\nrf_mse1 = mean_squared_error(y_test, salary_predictions_rf1)\nrf_rmse1 = np.sqrt(rf_mse1)\nprint(rf_rmse1)","3bf1f3f7":"## R Squared value\nr2_rf_test1 = model_rf1.score(x_test, y_test)\nr2_rf_train1 = model_rf1.score(x_train, y_train)\nprint(r2_rf_test1, r2_rf_train1)","c416d911":"df2 = pd.DataFrame({'Actual': y_test, 'Predicted':salary_predictions_rf1})\ndf2.head(10)","b802a872":"df2.plot(kind='bar',figsize=(10,8))\nplt.grid(which='major', linestyle='-', linewidth='0.5')\nplt.grid(which='minor', linestyle=':', linewidth='0.5')\nplt.show()","a7799010":"df_status = df.copy()\ndf.head(4)","9d82bd0e":"df_status.drop('salary', axis=1, inplace = True)\n\nX_features = ['gender','ssc_b','hsc_b','hsc_s','degree_t','workex','specialisation']\nencoded_df = pd.get_dummies(df_status[X_features], drop_first = True)\n\ndf_final = pd.concat([encoded_df, df_status], axis=1,sort=False)\ndf_final.columns","a5a525b1":"X = df_final.drop('status', axis=1)\n\nX.drop(df_final[X_features], axis=1, inplace=True)\n\ny = df_final['status']","d10c6f91":"from sklearn.model_selection import train_test_split\n\nX1, X2, y1, y2 = train_test_split(X, y, test_size=0.3, random_state=5)  ## Divide data \nprint(X1.shape, X2.shape, y1.shape, y2.shape)","4164859d":"from sklearn.naive_bayes import GaussianNB       # 1. choose model class\nmodel = GaussianNB()                             # 2. instantiate model","8aa96023":"## We do two validation trials, alternately using each half of the data as a holdout set.\ny2_model = model.fit(X1, y1).predict(X2)\ny1_model = model.fit(X2, y2).predict(X1)","a3ab22e0":"## We will use the accuracy_score utility to see the fraction of predicted labels that match their true value:\nfrom sklearn.metrics import accuracy_score\n\naccuracy_score(y1, y1_model), accuracy_score(y2, y2_model)","4bdcd983":"from sklearn.model_selection import cross_val_score\nscore1 = cross_val_score(model, X, y, cv=5)\nscore1","9b03f926":"print('The mean score and standard deviation of model prediction is', (score1.mean(), score1.std() * 2))","d138d064":"from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression","42add006":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=5)\nlogmodel = LogisticRegression(max_iter=1000)","03c137ca":"## Fit training data into model to make prediction further.\nlogmodel.fit(X_train,y_train)","ba534cf8":"predictions = logmodel.predict(X_test)","934cffd9":"from sklearn.metrics import classification_report\nprint(classification_report(y_test,predictions))","bedb7f91":"## Create confusion matrix to visualize accuracy of model\nfrom sklearn.metrics import confusion_matrix\n\nconfusion_matrix(y_test,predictions)","760ba521":"Now, show the correlation matrix into heatmap for better understanding and visualization","e661dc6f":"### Salary distribution through box-whiskers plot & Histogram","3b7172a9":"### Data Pre Processing","b32cc1b9":"### Find marginal probability through two way table\n\nMarginal Probability is the probability of the occurence of the single event","de033cc6":"###### According to correlation matrix and its visualization in heatmaps, there is almost -ve correlation between undergraduate(%) and salary. The salary variable only shows (+ve) correlation with MBA(%) & placement test(%) . And maximum positive coorelation will be shown between undergraduate(%) and MBA(%).  \n##### In the heatmap of correlation matrix the darker the color of tile the correlation between the variables is highly positive.And lighter the color of tile the correlation between the variables is highly negative.","4a7324db":"### What column name refers to \n\nssc_p:- Secondary Education(%) 10th Grade\n\nssc_b:- 10th Board of Education\n\nhsc_p:- Higher Secondary Education(%) 12th Grade\n\nhsc_b:- 12th Board of Education\n\nhsc_s:- Specialization in Higher Secondary Education\n\ndegree_p:- Undergraduate (%)\n\ndegree_t:- Undergraduate degree type\n\nworkex:- Work experience\n\netest_p:- Placement test (%)\n\nspecialisation:- MBA specialisation\n\nmba_p:- MBA (%)\n\nstatus:- Hiring status    ","a43f7a88":"#### Acc. to data, most of candidates who have work experience are placed in a company. That means work experience is an important factor of getting placement.","db47acdf":"# Model:- Placement Status Prediction","a273d274":"### Find which degree technology studied by candidate is placed more ","1d85f2ec":"#### Check how many students have been placed or not","b5b1cab4":"### Check the difference between the actual value and predicted value.","81d1fac0":"### Find does gender of an student affects the salary or any other variable","c30e283c":"According to campus data and above three marginal probability table shows having work experience is better to get placed. That means work experience factor influenced a candidate in getting placed thats why the of getting placed in a company is better for MBA Finance caandidate.","c2902f44":"### Now let's plot the comparison of Actual and Predicted values","1827be4b":"### Check the difference between the actual value and predicted value.","c60b91bc":"### Visualization of five-fold cross-validation","867d6496":"Commerce candidates getting more placed in companies but they are more in numbers as well but Science & Technology candiates have best ratio of getting placed from other undergraduate degree type.","2e914e83":"### Which degree specialization is much demanded by corporate?","cd2960e8":"### Plot histogram for all numeric variables","6dc730cb":"### Check average or mean of numeric variable for unique values of status ","425dca45":"# Model Development :-  Salary Prediction\n\n#### Now, build a Linear Regression and Random Forest Model on placed dataframe only.","ebab8764":"### Now, check correlation of percentage in degree & ssc with repect to specialisation.","f53e4043":"### Does work experience affects placement of a candidate?","4ba35ea3":"### Find relationship between degree specialization and other variables of placed student.","bd5449a9":"## LINEAR REGRESSION WITH PLACED DATA","90e47683":"#### Pairplot of gender variable","802aa749":"# Explanatory Data Analysis","7f79d031":"#### Splitting data into test and train to fit model & predict. Train set contains 75% data because test_size =0.25 and random state is a predefined algorithm its called pseudo random number generato","ac2d2422":"### Create another dataframe of only placed students and analyse","0c35caf3":"The marginal probability shows, out of 56% of Finance candidate 44% gets placed and in HR out of 44% only 24% gets placed that means the success ratio of MBA in Finance specialisation is more than the HR. Now find does work experience is a one of the factor of success for Finance candidate.","0122e42c":"### Find correlation between numeric variables in dataframe\n\nCorrelation :- Calculate relationship between two numerical variables.\n\nExcluding null valuees & excluding the categorical variables to find the Pearson's correlation\n\n\u2022 Positive correlation \u2013 the other variable has a tendency to also increase \n\n\u2022 Negative correlation \u2013 the other variable has a tendency to decrease\n\n\u2022 No correlation \u2013 the other variable does not tend to either increase or decrease.","c1f5d1b7":"Above margin probability table shows work experience plays an important role in success of MBA Finance candidate. ","0cb7a10d":"#### According to college placement data & above pairplot clearly shows that percentage matters in placement of students in a XYZ campus.","101d707b":"## Logistic Regression","0506ba44":"###### According to above box-whiskers plot the outliners or extreme value in salary column lie more in male category than female. One of assumptions is may be some of the male candidates getting hire for higher post in a company thats why they are getting more salary.","c35a54a4":"## Random Forest Regressor","d7b96a32":"### Check the difference between the actual value and predicted value.","9e645054":"## Supervised learning :- Gaussian Naive Bayes classifier\n### Model validation via cross-validation :- Two Fold","4cc27eb5":"### Relationship between placement of a student to their percentage.\n\nPairwise Plot :- Used to plot relationship in a dataset\n\nCreates scatter plots for join relationship and histogram for univariate distributions \n","e759139f":"#### Create sub dataset of only numeric data type variables","dc6d5457":"#### Above plot shows Mkt&Fin specialization is dominating in campus, for placement."}}