{"cell_type":{"07dc329d":"code","4e972874":"code","711a8553":"code","9803e019":"code","c6a1c2ea":"code","b98d7849":"code","38a75d5a":"code","80ef515e":"code","eb0385f5":"code","8533a43b":"code","e56f473a":"code","6395eb4a":"markdown","d2430de2":"markdown","2dd22bb7":"markdown","f2bcbbc4":"markdown"},"source":{"07dc329d":"import numpy as np\nimport pandas as pd \nfrom sklearn.model_selection import StratifiedKFold\n\nimport seaborn as sns","4e972874":"TRAIN_PATH = \"..\/input\/titanic\/train.csv\"","711a8553":"train = pd.read_csv(TRAIN_PATH)\ntrain.head()","9803e019":"def makeNFoldCSV(df,target_col,project_name,nFold=5,folder_col_name=\"Fold\",seed=2021,shuffle=True):\n    skf = StratifiedKFold(n_splits=nFold,random_state=seed, shuffle=shuffle)\n    skfSplit = skf.split(df, df[target_col])\n    fold = 1\n    for train_index, test_index in skfSplit:\n        df.loc[test_index,folder_col_name] = fold\n        fold = fold + 1\n\n    df = df.astype({folder_col_name: 'int64'})\n    csv_name = project_name + \"_\" + str(nFold) + \"folds.csv\"\n    df.to_csv(csv_name,index = False)","c6a1c2ea":"makeNFoldCSV(train,\"Survived\",\"titanic\")","b98d7849":"fold_csv = pd.read_csv(\".\/titanic_5folds.csv\")\nfold_csv.head()","38a75d5a":"def getFoldCount(df,col=\"Fold\"):\n    return sorted([( colValue,len(train.loc[df[col] == colValue]) ) for colValue in df[col].unique()])\ngetFoldCount(fold_csv)\nax = sns.countplot(data=fold_csv,y=\"Fold\")","80ef515e":"makeNFoldCSV(train,\"Survived\",\"titanic\",nFold=10)","eb0385f5":"fold_csv = pd.read_csv(\".\/titanic_10folds.csv\")\nprint(getFoldCount(fold_csv))\nax = sns.countplot(data=fold_csv,y=\"Fold\")","8533a43b":"makeNFoldCSV(train,\"Survived\",\"titanic\",nFold=20)","e56f473a":"fold_csv = pd.read_csv(\".\/titanic_20folds.csv\")\nprint(getFoldCount(fold_csv))\nax = sns.countplot(data=fold_csv,y=\"Fold\")","6395eb4a":"# 3.to 20 Fold","d2430de2":"# load training data ","2dd22bb7":"# 1.split folds for 5 fold training model","f2bcbbc4":"# 2.to 10 Fold"}}