{"cell_type":{"a5d419d4":"code","6520ed1e":"code","f609cbbc":"code","81d8ad2d":"code","5dea6058":"code","a61bd4a8":"code","28aece35":"markdown"},"source":{"a5d419d4":"import pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","6520ed1e":"# list of (weight, submission file path)\n# supports n number of files\n# make sure the weights sum up to 1 always.\nweight_model_paths_pairs = [\n#     (.025,'..\/input\/gradientboosting1\/submission.csv'),\n#     (.025, '..\/input\/lgbm1\/submission.csv'),\n#     (.02, '..\/input\/xgboost1\/submission1.csv'),\n#     (.01, '..\/input\/catboost1\/submission(1).csv'),\n#     (.03, '..\/input\/xgbregressor1\/submission (4).csv'),\n#     (.04, '..\/input\/cbxgblgm1\/subcat.csv'),\n#     (.02, '..\/input\/lightautoml\/In_LightAutoML_we_trust.csv'),\n#     (.01, '..\/input\/blend1\/voting.csv'),\n#     (.04, '..\/input\/lightautoml2\/LightAutoML_utilized_submission.csv'),\n#     (.005, '..\/input\/lightautoml3\/LightAutoML_utilized_submission (1).csv'),\n#     (.001, '..\/input\/lightautoml4\/LightAutoML_utilized_submission (2).csv'),\n#     (.1, '..\/input\/blend5\/0.part'),\n#     (.5, '..\/input\/blend5\/file1_7.84996_file2_7.85000_blend.csv'),\n    (.025, '..\/input\/blend6\/0 (1).part'),\n    (.025, '..\/input\/blend7\/0 (2).part'),\n    (.15, '..\/input\/feedback2\/submission_weighted_ensemble_24.csv'),\n    (.1, '..\/input\/blend8\/submission (6).csv'),\n    (.7,'..\/input\/blend9\/0 (3).part')]","f609cbbc":"# verify weights sum up to ~1\nres = 0\nfor x, y in weight_model_paths_pairs:\n    res = res + x;\nprint(res)","81d8ad2d":"targets = ['loss']\n\nsubmissions = []\nfor weight, path in weight_model_paths_pairs:\n    df = pd.read_csv(path)\n    df[targets] = df[targets] * weight\n    submissions.append(df)\n\nensembled_output = pd.concat(submissions).groupby(['id']).sum().reset_index()","5dea6058":"ensembled_output.head()","a61bd4a8":"ensembled_output.to_csv('submission_weighted_ensemble_27.csv', index=False)","28aece35":"### Intuition: Multiple models lead a better model.\n\n### Open question:\n\n1. How to decide the weights for different model outputs?\n  1. One way is weight the better performing model more.\n\n### Credits\n\n1. https:\/\/www.kaggle.com\/yus002\/tps-lgbm-model by @yus002\n2. https:\/\/www.kaggle.com\/carlmcbrideellis\/histogram-gradient-boost-starter-script by @carlmcbrideellis\n3. https:\/\/www.kaggle.com\/riyajm\/baseline-gpu-based-xgb-hyperopt-optimize by @riyajm \n4. https:\/\/www.kaggle.com\/andy6804tw\/tps-08-21-catboost by @andy6804tw\n5. https:\/\/www.kaggle.com\/michael127001\/xgbregressor-with-optuna-tuning by @michael127001\n6. https:\/\/www.kaggle.com\/pranjalverma08\/tps-08-cb-lgbm-xgb-starter by @pranjalverma08\n7. https:\/\/www.kaggle.com\/alexryzhkov\/aug21-lightautoml-starter by @alexryzhkov\n8. https:\/\/www.kaggle.com\/dmitryuarov\/falling-below-7-87-voting-cb-xgb-lgbm by @dmitryuarov\n9. https:\/\/www.kaggle.com\/alexryzhkov\/lightautoml-classifier-regressor-mix by @alexryzhkov\n10. https:\/\/www.kaggle.com\/hiro5299834\/tps-aug-2021-lgbm-xgb-catboost by @hiro5299834\n11. https:\/\/www.kaggle.com\/yus002\/blending-tool-tps-aug-2021 by @yus002\n12. https:\/\/www.kaggle.com\/pavfedotov\/blending-tool-tps-aug-2021 by @pavfedotov\n13. https:\/\/www.kaggle.com\/takahiroyoshida012\/smart-ensembling-tps-aug-2021-7-84986 by @takahiroyoshida012\n\n**Upvote for support!! and kudos to the above mentioned notebooks!!**"}}