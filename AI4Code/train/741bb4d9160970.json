{"cell_type":{"96459279":"code","363efe33":"code","2527505e":"code","846e7eeb":"code","3c788da9":"code","38c666f9":"code","2ed60cb1":"code","6bbd370c":"code","60eb84c3":"code","ed132a92":"code","dcc872fc":"code","caa749c1":"code","6ad98b4b":"code","a578a339":"code","bd755040":"code","d605bf37":"code","731c2908":"markdown","54dfb985":"markdown","5d27305e":"markdown","3097d1eb":"markdown"},"source":{"96459279":"# Import dependencies\nimport numpy as np # linear algebra\nimport os\nimport pandas as pd\n\n# Keras is the primary library we will use. It is a part of Tensorflow but can also be used standalone.\nimport keras.utils\nimport keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.optimizers import SGD\nfrom matplotlib import pyplot as plt\n\nprint(\"dependencies imported\")","363efe33":"# Function to load data from our input path\ndef load_data(path):\n    with np.load(path) as f:\n        x_train, y_train = f['x_train'], f['y_train']\n        x_test, y_test = f['x_test'], f['y_test']\n        return (x_train, y_train), (x_test, y_test)\n\n\n# X_train is the data our model will learn\n# y_train is the label\n# X_valid and y_valid are the validation sets. We use these sets to validate the accuracy of our trained model.\n# The capitalized first letter of the variable denotes that it's a two dimensional or higher data structure. \n# The first letter of the variable being lowercase would indicate it's one dimen\n(X_train, y_train), (X_valid, y_valid) = load_data('..\/input\/keras-mnist-amazonaws-npz-datasets\/mnist.npz')\nprint(\"data loaded.\")","2527505e":"# This will show us how many images we have in our dataset\nX_train.shape\n\n# 60000 images which are each 28x28 matrix of value","846e7eeb":"# This will show us that we have 60000 labels that corresponds to the training data \ny_train.shape","3c788da9":"# This will show you the first 12 labels\ny_train[0:12]","38c666f9":"# Define the size of your figure\nplt.figure(figsize=(3,3))\n\n# Loop through the first dozen\nfor k in range(12):\n    \n    # Add subplot to current figure\n    plt.subplot(3, 4, k+1)\n    \n    # Display data as image\n    plt.imshow(X_train[k], cmap='Greys')\n    \n    # Turn off axis lines\n    plt.axis('off')\n    \n# Adjust plot layers to give padding\nplt.tight_layout()\n\n# Show figure\nplt.show()","2ed60cb1":"# This tells us the amount and size of our validation dataset\nX_valid.shape","6bbd370c":"# This tells us the number of labels in our validation set\ny_valid.shape","60eb84c3":"# If you want to see how these relate, see the image this puts out\nplt.imshow(X_valid[0], cmap='Greys')","ed132a92":"# And then see the number this puts out\ny_valid[0]","dcc872fc":"# Flatten 2-dimensional to 1-dimensional as well as convert it to float values\nX_train = X_train.reshape(60000, 784).astype('float32')\nX_valid = X_valid.reshape(10000, 784).astype('float32')\n\nX_train \/= 255\nX_valid \/= 255\n\nX_valid[0]","caa749c1":"# Convert to one hot representation\nn_classes = 10\ny_train = keras.utils.to_categorical(y_train, n_classes)\ny_valid = keras.utils.to_categorical(y_valid, n_classes)\n\ny_valid[0]","6ad98b4b":"# Create a model. This is the simplest of models. \n# It is called sequential because each layer of neurons only passes data to the next layer in a sequential manner.\nmodel = Sequential()\n\n# Specify attributes of our hidden layer\nmodel.add(Dense(64, activation='sigmoid', input_shape=(784,)))\n\n# Specify attributes of the output layer\nmodel.add(Dense(10, activation='softmax'))\n\n# This will give us a summary of our model's schema.\nmodel.summary()","a578a339":"# Compile the model\nmodel.compile(loss='mean_squared_error', optimizer=SGD(lr=0.01), metrics=['accuracy'])\nprint('model compiled')","bd755040":"# Use the fit method to train the model\nmodel.fit(X_train, y_train, batch_size=128, epochs=200, verbose=1, validation_data=(X_valid, y_valid))","d605bf37":"# To validate the accuracy of our model, we pass in our validation data set\nmodel.evaluate(X_valid, y_valid)","731c2908":"# OMG We're building a model!!11oneone","54dfb985":"# Quick Introduction","5d27305e":"# Pre-process data","3097d1eb":"# Training the model"}}