{"cell_type":{"c60a563f":"code","a5a67dbc":"code","6895c898":"code","861aa763":"code","a8c6c769":"code","84c5a0b8":"code","483fb9e7":"code","63b76d5e":"code","e7ced7a1":"code","388617e4":"code","34ff6c60":"code","3a0ee3cc":"markdown"},"source":{"c60a563f":"# Import all required modules\nimport pandas as pd\nimport numpy as np\nfrom sklearn import linear_model,model_selection,preprocessing","a5a67dbc":"# Read training data\ndf_train = pd.read_csv(\"..\/input\/titanic\/train.csv\")\nX = df_train[['Sex','Age','Pclass']]\ny = df_train['Survived']","6895c898":"# Preprocess the data for better fitting\nX['Sex'] = X['Sex'].apply(lambda x:1 if x==\"female\" else 0)\nX['Age'].fillna(value=np.mean(X['Age']),inplace=True)\nX","861aa763":"# Apply logistic regression algorithm\nmodel = linear_model.LogisticRegression(solver='lbfgs')\nmodel.fit(X,y)\nmodel.classes_,model.coef_,model.intercept_\nmodel.score(X,y)","a8c6c769":"C_vals = [1e-3,0.1,1,100,1000,1e5]\ngrdsrch = model_selection.GridSearchCV(estimator=model,param_grid={'C':C_vals},return_train_score=True,cv=5)\ngs_fit = grdsrch.fit(X,y)\ngs_fit.best_score_,gs_fit.best_params_,gs_fit.cv_results_","84c5a0b8":"# Read the test data\ndf_test = pd.read_csv(\"\/kaggle\/input\/titanic\/test.csv\")\nX_test = df_test[['Sex','Age','Pclass']]\n# Preprocess the data for better fitting\nX_test['Sex'] = X_test['Sex'].apply(lambda x:1 if x==\"female\" else 0)\nX_test['Age'].fillna(value=np.mean(X_test['Age']),inplace=True)","483fb9e7":"#X_test\ny_pred = grdsrch.predict(X_test)\ny_pred","63b76d5e":"pd.DataFrame({'PassengerId':df_test.PassengerId,'Survived':y_pred},columns=[\"PassengerId\",\"Survived\"]).to_csv(\"my_submission_2.csv\",index=False)","e7ced7a1":"X_train_norm = preprocessing.normalize(X)\nX_test_norm = preprocessing.normalize(X_test)","388617e4":"gs_fit = grdsrch.fit(X_train_norm,y)\ngs_fit.best_score_,gs_fit.best_estimator_,gs_fit.cv_results_","34ff6c60":"y_pred = grdsrch.predict(X_test_norm)\ny_pred\npd.DataFrame({'PassengerId':df_test.PassengerId,'Survived':y_pred},columns=[\"PassengerId\",\"Survived\"]).to_csv(\"my_submission_2.csv\",index=False)","3a0ee3cc":"This is a revision of earlier attempted Titanic exercise"}}