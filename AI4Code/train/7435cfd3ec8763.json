{"cell_type":{"1b3e525d":"code","2e7a487d":"code","9e2115d2":"code","093628d0":"code","9f9cb656":"code","b7ffc932":"code","46c4f44b":"code","d4a0d12b":"code","5a6ef438":"code","7e1fe791":"markdown","4cecf8a0":"markdown","b2386219":"markdown","7c53809b":"markdown","851b69c5":"markdown","5e72d1cb":"markdown"},"source":{"1b3e525d":"import numpy as np\nimport os\n`\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.ensemble import RandomForestRegressor","2e7a487d":"SEED = 42\nEARLY_STOP_NUM = 5 \nDATA_NUM = 1000 # row number \nCOL_NUM = 5 #column number \nMAX_DEPTH = 2\nMAX_ESTIMATOR = 120\nIS_WARM_START = True","9e2115d2":"np.random.seed(SEED)\nX = np.random.rand(DATA_NUM, COL_NUM) - 0.5\ny = 3*X[:, 0]**2 + 0.05 * np.random.randn(DATA_NUM)","093628d0":"X[:5]","9f9cb656":"y[:5]","b7ffc932":"X_train, X_val, y_train, y_val = train_test_split(X, y, random_state=SEED)","46c4f44b":"rfr = RandomForestRegressor(max_depth=MAX_DEPTH, warm_start=IS_WARM_START, random_state=SEED)\n\nmin_val_error = float(\"inf\")\nerror_going_up = 0\nfor n_estimators in range(1, MAX_ESTIMATOR):\n    rfr.n_estimators = n_estimators\n    rfr.fit(X_train, y_train)\n    y_pred = rfr.predict(X_val)\n    val_error = mean_squared_error(y_val, y_pred)\n    if val_error < min_val_error:\n        print(n_estimators,\"try => find new min val error\")\n        min_val_error = val_error\n        error_going_up = 0\n    else:\n        error_going_up += 1\n        print(n_estimators,\"try => not find new min val error num : \",error_going_up)\n        if error_going_up == EARLY_STOP_NUM:\n            print(n_estimators,\"try => early stopping\")\n            break  # early stopping","d4a0d12b":"print(rfr.n_estimators)","5a6ef438":"print(\"Minimum validation MSE:\", min_val_error)","7e1fe791":"# import libraries","4cecf8a0":"# make data","b2386219":"# global variables","7c53809b":"# split train set and validation set ","851b69c5":"# get best n_estimators using warm_start=True","5e72d1cb":"# get minimum validation MSE "}}