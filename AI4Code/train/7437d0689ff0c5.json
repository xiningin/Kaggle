{"cell_type":{"979f173f":"code","fac0f8a2":"code","2872e0f2":"code","0f45edb8":"code","d7e9bbc5":"code","f4501ba1":"code","9a7a1953":"code","dcee1594":"code","ef591782":"code","25758a89":"code","baee013e":"code","7f042a53":"code","ce79c90e":"code","6554a294":"code","4e2267fa":"markdown","1ebc5720":"markdown","476aeed3":"markdown","8fed0046":"markdown","a45a4387":"markdown","c000d7b3":"markdown","ed55dbf0":"markdown","d054499f":"markdown","31ead2da":"markdown","af191455":"markdown","411978dc":"markdown","86ab5a7e":"markdown","375e0dd3":"markdown","dd4337e0":"markdown"},"source":{"979f173f":"from fastai import *\nfrom fastai.vision import *\nfrom fastai.callbacks.hooks import *","fac0f8a2":"path = Path('..\/input\/dataset\/DATASET')\npath.ls()","2872e0f2":"data = ImageDataBunch.from_folder(\n    path,\n    train = \"TRAIN\",\n    valid = \"TEST\",\n    ds_tfms=get_transforms(do_flip=False),\n    size = 128,\n    bs=32,\n    valid_pct=0.2,\n    num_workers=0\n).normalize(imagenet_stats)\nprint(f'Classes: \\n {data.classes}')\ndata.show_batch(rows=10,figsize=(10,10))","0f45edb8":"learn = create_cnn(data, models.resnet50,metrics=accuracy,model_dir='\/tmp\/model\/')\nlearn.lr_find()\nlearn.recorder.plot()","d7e9bbc5":"learn.fit_one_cycle(5)","f4501ba1":"learn.recorder.plot_losses()","9a7a1953":"inter = ClassificationInterpretation.from_learner(learn)\ninter.plot_top_losses(9,figsize=(20,20))","dcee1594":"inter.plot_confusion_matrix(figsize=(10,10))","ef591782":"learn.unfreeze()\nlearn.fit_one_cycle(2)","25758a89":"learn.lr_find()\nlearn.recorder.plot()","baee013e":"learn.fit_one_cycle(5, max_lr=slice(1e-6,1e-4))","7f042a53":"learn.recorder.plot_losses()","ce79c90e":"inter = ClassificationInterpretation.from_learner(learn)\ninter.plot_top_losses(9,figsize=(20,20))","6554a294":"inter.plot_confusion_matrix(figsize=(10,10),dpi=75)\nlearn.save('waste-clf-fastai-V1')","4e2267fa":"# Plot the losses of the training and validation","1ebc5720":"# Train the model","476aeed3":"# Load the data in using the ImageDataBunch","8fed0046":"# Import Libraries","a45a4387":"# Train the model","c000d7b3":"# Plot the top losses of the model","ed55dbf0":"# Plot the top losses","d054499f":"# Plot the top losses of your model","31ead2da":"# Plot confusion matrix","af191455":"# Find and plot the learning rate","411978dc":"# Create a path to the dataset","86ab5a7e":"# Create the learner","375e0dd3":"# Unfreeze model and train","dd4337e0":"# Plot a confusion matrix"}}