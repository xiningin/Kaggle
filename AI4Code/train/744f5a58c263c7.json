{"cell_type":{"4ddd953e":"code","e2670cea":"code","602a55fa":"code","df53a8cc":"code","9eaa3656":"code","1dcdca65":"code","9cc3abd7":"code","fc6d5e60":"code","672cced0":"code","1e7a180c":"code","0bed7ea0":"code","e0599e8e":"code","739688ca":"code","b2a1c2ea":"code","4d15ccb1":"code","e719244d":"code","5f81d660":"code","f42e7582":"code","3100f054":"code","1884a260":"code","d67f6ced":"code","6f2446cb":"code","86ff58ff":"code","12ea30a0":"code","30265129":"code","929bc52c":"code","9345eab1":"code","fa3c5d43":"code","2151bf46":"code","9a59a278":"code","486f2a6f":"code","3fecad71":"code","5d3e7d00":"code","fb50015f":"code","d741eba3":"code","de2f4d18":"code","e4433a50":"code","f673ca99":"code","6e49abf8":"code","8897e272":"code","ec3f2c80":"code","32d30871":"code","fa1cae5b":"code","ae3e591d":"code","cbb85839":"code","6e8889cf":"code","4bdb6a46":"code","07f71168":"code","d242a1f3":"code","f0464bc5":"code","7b856fa8":"code","2c232199":"code","b1a04a41":"code","36c4ea5b":"code","95e43e24":"code","91d90fd8":"code","f1aef333":"code","3ba36826":"markdown","fc4218a4":"markdown","0f9311d6":"markdown","b6f886e8":"markdown","8bb4d408":"markdown","32fee8b4":"markdown","8c17693d":"markdown","e64c44e4":"markdown","cd96b681":"markdown","8030e0ba":"markdown","fbf11d99":"markdown"},"source":{"4ddd953e":"#importing libraries\nimport pandas as pd\nimport numpy as np\n%matplotlib inline\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","e2670cea":"# Importing the dataset\ndataset = pd.read_csv('\/kaggle\/input\/Boston.csv')\ndataset.shape","602a55fa":"dataset.dtypes","df53a8cc":"dataset.head()","9eaa3656":"dataset.isnull().sum()","1dcdca65":"dataset['crim'].describe()","9cc3abd7":"sns.distplot(dataset['crim'])","fc6d5e60":"print(\"Skewness: %f\" % dataset['crim'].skew())\nprint(\"Kurtosis: %f\" % dataset['crim'].kurt())","672cced0":"sns.boxplot(dataset['crim'])","1e7a180c":"dataset[dataset['crim']<dataset['crim'].quantile(0.02)]['crim']","0bed7ea0":"dataset.loc[dataset['crim']<dataset['crim'].quantile(0.02),['crim']]=dataset['crim'].quantile(0.02)","e0599e8e":"dataset[dataset['crim']>dataset['crim'].quantile(0.95)]['crim']","739688ca":"dataset.loc[dataset['crim']>dataset['crim'].quantile(0.95),['crim']]=dataset['crim'].quantile(0.95)","b2a1c2ea":"sns.boxplot(dataset['crim'])","4d15ccb1":"sns.distplot(dataset['crim'])","e719244d":"dataset['zn'].describe()","5f81d660":"sns.boxplot(dataset['zn'])","f42e7582":"dataset.loc[dataset['zn']<dataset['zn'].quantile(0.1),['zn']]=dataset['zn'].quantile(0.1)\ndataset.loc[dataset['zn']>dataset['zn'].quantile(0.9),['zn']]=dataset['zn'].quantile(0.9)\nsns.boxplot(dataset['zn'])","3100f054":"sns.distplot(dataset['zn'])","1884a260":"print(\"Skewness: %f\" % dataset['zn'].skew())\nprint(\"Kurtosis: %f\" % dataset['zn'].kurt())","d67f6ced":"dataset['indus'].describe()","6f2446cb":"sns.distplot(dataset['indus'])","86ff58ff":"sns.boxplot(dataset['indus'])","12ea30a0":"print(\"Skewness %f\" % dataset['indus'].skew())\nprint(\"Kurtosis %f\" % dataset['indus'].kurt())","30265129":"dataset['chas'].describe()","929bc52c":"dataset['chas'].value_counts()","9345eab1":"sns.countplot(dataset['chas'])","fa3c5d43":"dataset['rm'].describe()","2151bf46":"sns.boxplot(dataset['rm'])","9a59a278":"sns.distplot(dataset['rm'])\n","486f2a6f":"dataset['lstat'].describe()","3fecad71":"sns.boxplot(dataset['lstat'])","5d3e7d00":"sns.distplot(dataset['lstat'])\n","fb50015f":"dataset['ptratio'].describe()","d741eba3":"sns.boxplot(dataset['ptratio'])","de2f4d18":"dataset[dataset['ptratio']<dataset['ptratio'].quantile(0.02)]['ptratio']","e4433a50":"dataset.loc[dataset['ptratio']<dataset['ptratio'].quantile(0.02),['ptratio']]=dataset['ptratio'].quantile(0.02)","f673ca99":"dataset[dataset['ptratio']>dataset['ptratio'].quantile(0.98)]['ptratio']","6e49abf8":"dataset.loc[dataset['ptratio']>dataset['ptratio'].quantile(0.98),['ptratio']]=dataset['ptratio'].quantile(0.98)","8897e272":"sns.boxplot(dataset['ptratio'])","ec3f2c80":"sns.distplot(dataset['ptratio'])\n","32d30871":"dataset['medv'].describe()","fa1cae5b":"sns.boxplot(dataset['medv'])","ae3e591d":"sns.distplot(dataset['medv'])","cbb85839":"feature_cols = ['crim', 'zn', 'indus','nox', 'rm','age', 'dis', 'rad', 'tax', 'ptratio','black', 'lstat']\ntarget_col='medv'","6e8889cf":"X = dataset[feature_cols].values\ny = dataset[target_col].values\nprint(\"X dimensions are\",X.shape)\nprint(\"y dimensions are\",y.shape)","4bdb6a46":"# Splitting the dataset into the Training set and Test set\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, random_state = 0)\nprint(\"X_train dimensions are\",X_train.shape)\nprint(\"y_train dimensions are\",y_train.shape)\nprint(\"X_test dimensions are\",X_test.shape)\nprint(\"y_test dimensions are\",y_test.shape)","07f71168":"# Feature Scaling\nfrom sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)\n","d242a1f3":"# Applying PCA\nfrom sklearn.decomposition import PCA\npca = PCA(n_components = None)\nX_train = pca.fit_transform(X_train)\nX_test = pca.transform(X_test)\nexplained_variance = pca.explained_variance_ratio_\n","f0464bc5":"print(\"dimensin of X_train\",X_train.shape)","7b856fa8":"round(pd.Series(explained_variance),2)\n","2c232199":"#pca.components_.shape[0]\npd.DataFrame(pca.components_)\n","b1a04a41":"\nsns.heatmap(pd.DataFrame(pca.components_).corr(),annot=True)","36c4ea5b":"# number of components\nn_pcs= pca.components_.shape[0]\n\n# get the index of the most important feature on EACH component\n# LIST COMPREHENSION HERE\nmost_important = [np.abs(pca.components_[i]).argmax() for i in range(n_pcs)]\n\nmost_important_names = [feature_cols[most_important[i]] for i in range(n_pcs)]\n\ndic = {'PC{}'.format(i): most_important_names[i] for i in range(n_pcs)}\n\n# build the dataframe\ndf = pd.Series(dic.items())\ndic.items()","95e43e24":"# Fitting SVR to the dataset\nfrom sklearn.svm import SVR\nregressor = SVR(kernel = 'linear')\nfitted=regressor.fit(X_train, y_train)\ny_predict_train=fitted.predict(X_train)\ny_predict_test=fitted.predict(X_test)","91d90fd8":"fitted.score(X_train,y_train)","f1aef333":"\nfrom sklearn.metrics import r2_score\nprint('R square for train:', r2_score(y_train,y_predict_train))\nprint('R square for test:', r2_score(y_test,y_predict_test))","3ba36826":"There are 398 observations and 9 attributes","fc4218a4":"# univarte anlysis of RM variable","0f9311d6":"# univariate analysis of MEDV variable","b6f886e8":"here, in our dataset no NA values are present","8bb4d408":"# Univariate analysis for zn column","32fee8b4":"# univariate analysis of INDUS variable","8c17693d":"# Univariate analysis for CHAS column","e64c44e4":"# univariate analysis of PTRATIO ","cd96b681":"# Split the data into train and test sets","8030e0ba":"# Univariate analysis for CRIM column:","fbf11d99":"# univariate  analysis of LSTAT variable"}}