{"cell_type":{"12d95f6d":"code","50b4b40c":"code","9b7c5e4c":"code","53ba2c0c":"code","607040ec":"code","2775d30d":"code","76c14137":"code","57d212f5":"code","debc8ea3":"code","ae4ac8c8":"code","cc586644":"code","49f1963e":"code","7ad13acd":"code","571a259e":"code","174bd567":"code","e651742b":"code","248b0748":"code","5ccca467":"code","80d8a49d":"markdown","900c0791":"markdown","8820d5c3":"markdown","accb428e":"markdown","68d90c84":"markdown","c8df284e":"markdown","db38aa95":"markdown","a51eaf7d":"markdown","ad40603f":"markdown","07b7d5af":"markdown"},"source":{"12d95f6d":"import numpy as np\nimport pandas as pd","50b4b40c":"df = pd.read_csv('..\/input\/advertising-budget\/Advertising_Budget.csv')\ndf.head()","9b7c5e4c":"print(df.info())","53ba2c0c":"print('Shape: \\n Rows = {0} \\n Columns = {1}'.format(df.shape[0], df.shape[1]))","607040ec":"print(df.describe())","2775d30d":"# Missing Data\ndf.isnull().sum()","76c14137":"from matplotlib import pyplot as plt\nimport seaborn\n\nseaborn.set_style('darkgrid')","57d212f5":"plt.figure()\ng = seaborn.PairGrid(df)\ng.map_diag(seaborn.kdeplot)\ng.map_offdiag(seaborn.scatterplot)\nplt.show()","debc8ea3":"# BoxPlot\nplt.figure(figsize=(10,10))\nseaborn.boxplot(data=df)","ae4ac8c8":"# Locating outliers\nindex = []\n\nq1 = np.percentile(df.loc[:, 'Budget'].values, 25, interpolation='midpoint')\nq3 = np.percentile(df.loc[:, 'Budget'].values, 75, interpolation='midpoint')\niqr = q3 - q1\n\nulim = q3 + 1.5*iqr\nllim = q1 - 1.5*iqr\n\nfor i in range(df.shape[0]) :\n    if df.loc[i, 'Budget'] > ulim :\n        index.append(i)\n    if df.loc[i, 'Budget'] < llim :\n        index.append(i)","cc586644":"# The outliers        \ndf.iloc[index, :]","49f1963e":"# Remove outliers\ndf.drop(index, inplace=True)\ndf.index = np.arange(df.shape[0]) # Reset the index","7ad13acd":"# Separating the variables\nX = df.iloc[:, 0:1].values\ny = df.iloc[:, -1].values","571a259e":"from sklearn.linear_model import LinearRegression\n\nmodel = LinearRegression()\nmodel.fit(X, y)","174bd567":"# Model parameters\nprint('Coeffcients = {}'.format(model.coef_))\nprint('Intercept = {0:.2f}'.format(model.intercept_))","e651742b":"y_hat = model.predict(X)","248b0748":"# Visualize\nplt.figure()\nplt.scatter(X.reshape(-1,), y, color='red', marker='o', alpha=0.35, label = 'Observed Data')\nplt.plot(X.reshape(-1,), y_hat, color='blue', label='Fitted Line')\nplt.xlabel('X-variate')\nplt.ylabel('y-variate')\nplt.title('Scatter Plot with Line Fit')\nplt.legend(loc='upper left')\nplt.show()","5ccca467":"from sklearn.metrics import r2_score, mean_squared_error\n\nprint('R-sq = {0:.4f}'.format(r2_score(y, y_hat)))\nprint('MSE = {0:.3f}'.format(mean_squared_error(y, y_hat)))","80d8a49d":"## Evaluating the model","900c0791":"## Search for Missing values","8820d5c3":"## Fitting the Model","accb428e":"### Method 1: Visualization","68d90c84":"### Method 2: Metrics","c8df284e":"# Linear Regression on Advertising data\n\n## Objectives\n\n+ Perform Exploratory Data Analysis\n+ Dealing with Outliers\n+ Fitting a Linear Regression model using scikit-learn\n+ Evaluating model\n+ Performing Diagnostics","db38aa95":"+ There is a wide gap between 75% percentile and Maximum observation for _Budget_ variable. This implies the presence of outliers.\n+ The data has high variability.","a51eaf7d":"## Overview of Data","ad40603f":"## Search & Remove outliers\n\n+ The box plot confirms the presence of outliers. These outliers are causing the inflation in variance.\n+ In the next step we will remove these outliers.","07b7d5af":"## Data Visualizations\n\nVisualizing the data provides us with visual insights about the data that are visible through the summary statistics. Also it help help us to identify our claims about outliers and high variability."}}