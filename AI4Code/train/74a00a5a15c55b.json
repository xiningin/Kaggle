{"cell_type":{"ce03c9c4":"code","f04b8581":"code","4d28f735":"code","a4b30bf2":"code","fc30c770":"code","2b2d7351":"code","be8a5aea":"code","8ed0d7cb":"code","eff92824":"code","073425fa":"code","6b03aa88":"code","89797185":"code","dc735269":"code","2d7ad3be":"code","5998c1fa":"code","48a0720e":"code","edf825fa":"code","9baf442f":"code","ed57c077":"code","9cebc251":"code","184dfaf8":"code","0fa20934":"code","9b00608e":"code","5cdc2bf1":"code","d430d124":"code","8d40339d":"code","ed83250e":"code","a0789ba0":"code","d5d2a916":"markdown","4888f909":"markdown","ed35f269":"markdown","346b4b51":"markdown","d2a6a444":"markdown","61f8371f":"markdown","f2436449":"markdown","83a80480":"markdown","b95d6cfe":"markdown","3b465663":"markdown","1777cae3":"markdown","d5a42285":"markdown","b97a4280":"markdown","50bdee86":"markdown","b14907b9":"markdown","9bd714eb":"markdown","7053d737":"markdown","6116f2c8":"markdown","11ac4f9d":"markdown","b726d90d":"markdown","b2df9f00":"markdown","5fb8217d":"markdown","b3ac4720":"markdown","9163c6d9":"markdown","757ddf22":"markdown","9d92f6bf":"markdown","57b01806":"markdown","951d6e90":"markdown","b76be528":"markdown","0e6d0bbc":"markdown","60870c90":"markdown","0d91c861":"markdown","9c3d5c22":"markdown","f083d0bb":"markdown","a64b5b18":"markdown","da852569":"markdown","5b85ad1a":"markdown"},"source":{"ce03c9c4":"setwd(\".\/\")","f04b8581":"#-- para plotar as imagens\nlibrary(fields)\n\n#-- para interpolar\nlibrary(akima)\n\n#-- para ler os dados HDF5\nlibrary(rhdf5)\n\n# -- para plotar mapa\nlibrary(maps)","4d28f735":"#-- le arquivos com as funcoes que leem e interpolam os dados\n#--    read_GMI_and_interpolate(arquivo,XLIM,YLIM,tbname,DG=0.05)\n#--    read_DPR_and_interpolate(arquivo,XLIM,YLIM,DG=0.05)\n#--    read_GPROF_and_interpolate(arquivo,XLIM,YLIM,DG=0.05)\n#--    DG \u00e9 o intervalo de interpolacao (em graus de lat\/lon), default = 0.05 \nsource(\"..\/input\/2021lista09\/arquivosauxiliares\/read_DPR_and_interpolate.R\")\nsource(\"..\/input\/2021lista09\/arquivosauxiliares\/read_GMI_and_interpolate.R\")\nsource(\"..\/input\/2021lista09\/arquivosauxiliares\/read_GPROF_and_interpolate.R\")\n","a4b30bf2":"#-- Nomes dos canais do sensor de microondas GMI\ntbname<-c(\"Tb10V\",\n          \"Tb10H\",\n          \"Tb19V\",\n          \"Tb19H\",\n          \"Tb23V\",\n          \"Tb37V\",\n          \"Tb37H\",\n          \"Tb89V\" ,\n          \"Tb89H\")","fc30c770":"################################################################\n###########        FURACAO HARVEY (2017)\n#-----------------------------------------------------------------\n#-- 1a passagem do satelite GPM sobre furacao Harvey em 2017-08-25 \n#-- Limites para o furacao Harvey (2017)\nXLIM.1<-c(-101.5,-85)\nYLIM.1<-c(21,32)\n\n#-----------------------------------------------------------------\n#-- 2a passagem do satelite GPM sobre furacao Harvey em 2017-08-27 \n#-- Limites para o furacao Harvey (2017)\nXLIM.2<-c(-101.5,-85)\nYLIM.2<-c(21,32)\n################################################################","2b2d7351":"################################################################\n###########        FURACAO HARVEY (2017)\n#-----------------------------------------------------------------\n#-- 1a passagem do satelite GPM sobre furacao Harvey em 2017-08-25 \n\n#-- Dados de Tb do GMI\ngmi.1<-read_GMI_and_interpolate(\"..\/input\/2021lista09\/dados\/1C.GPM.GMI.XCAL2016-C.20170825-S111924-E125156.019833.V05A.HDF5\",\n                                XLIM.1,YLIM.1,tbname,DG=0.05)\n\n#-- Dados de R(mm\/h) do DPR\ndpr.1<-read_DPR_and_interpolate(\"..\/input\/2021lista09\/dados\/2A.GPM.DPR.V7-20170308.20170825-S111924-E125156.019833.V05A.HDF5\",\n                                XLIM.1,YLIM.1,DG=0.05)\n\n#-- Dados de R(mm\/h) do GPROF\ngprof.1<-read_GPROF_and_interpolate(\"..\/input\/2021lista09\/dados\/2A.GPM.GMI.GPROF2017v1.20170825-S111924-E125156.019833.V05A.HDF5\",\n                                    XLIM.1,YLIM.1,DG=0.05)\n\n#-----------------------------------------------------------------\n#-- 2a passagem do satelite GPM sobre furacao Harvey em 2017-08-27 \n\n#-- Dados de Tb do GMI\ngmi.2<-read_GMI_and_interpolate(\"..\/input\/2021lista09\/dados\/1C.GPM.GMI.XCAL2016-C.20170827-S202340-E215612.019870.V05A.HDF5\",\n                                XLIM.2,YLIM.2,tbname,DG=0.05)\n\n#-- Dados de R(mm\/h) do DPR\ndpr.2<-read_DPR_and_interpolate(\"..\/input\/2021lista09\/dados\/2A.GPM.DPR.V7-20170308.20170827-S202340-E215612.019870.V05A.HDF5\",\n                                XLIM.2,YLIM.2,DG=0.05)\n\n#-- Dados de R(mm\/h) do GPROF\ngprof.2<-read_GPROF_and_interpolate(\"..\/input\/2021lista09\/dados\/2A.GPM.GMI.GPROF2017v1.20170827-S202340-E215612.019870.V05A.HDF5\",\n                                    XLIM.2,YLIM.2,DG=0.05)\n################################################################","be8a5aea":"#dpr.1\n","8ed0d7cb":"#dpr.2\n","eff92824":"#-- gprof1\n","073425fa":"#-- gprof2\n","6b03aa88":"#-- 1a passagem: Tb10V e TB19V\n\n#-- Definindo o tamanho da tela a ser plotada\noptions(repr.plot.width=16, repr.plot.height=8)\n\npar(mfrow=c(1,2)) #-plota duas figuras, uma em cada coluna (1,2)\n  image.plot(z=gmi.1$Tb10V,\n             x=gmi.1$x,\n             y=gmi.1$y,\n             xlab=\"longitude\",\n             ylab=\"latitude\",\n             cex.lab=1.5,\n             cex.axis=1.5,\n             main=paste(gmi.1$t,\"Tb10V\"))\n  map(\"world\",add=T)\n  image.plot(z=gmi.1$Tb19V,\n             x=gmi.1$x,\n             y=gmi.1$y,\n             cex.lab=1.5,\n             cex.axis=1.5,\n             xlab=\"longitude\",\n             ylab=\"latitude\",\n             main=paste(gmi.1$t,\"Tb19V\"))\n  map(\"world\",add=T)\n","89797185":"#-- 1a passagem: Tb37V e TB89V\n#-- Definindo o tamanho da tela a ser plotada\n\n\n","dc735269":"options(repr.plot.width=10, repr.plot.height=8)\n\n#-- plota a imagem\nimage.plot(z=gmi.1$Tb37V,\n           x=gmi.1$x,\n           y=gmi.1$y,\n           cex.lab=1.5,\n           cex.axis=1.5,\n           main=paste(gmi.1$t,\"Tb37V\"))\nmap(\"world\",add=T)\n\n#-- plota linha horizontal\nabline(h=26.3,\n       lty=\"solid\",\n       lwd=2)  \n#-- plota linha horizontal\nabline(h=29,\n       lty=\"dashed\",\n       lwd=2)  \n#-- plota linha vertical\nabline(v=-95.8,\n       lty=\"solid\",\n       lwd=2) \n#-- plota linha vertical\nabline(v=-94.8,\n       lty=\"dashed\",\n       lwd=2) \n","2d7ad3be":"#-- Harvey\nlat.A <-  26.3  #- solid line\nlat.B <-  29.0  #- dashed line\nlon.A <- -95.8  #- solid line\nlon.B <- -94.8  #- dashed line\n","5998c1fa":"#-- achando os \u00edndices\n\nind.lat.A<-which.min(abs(gmi.1$y-lat.A))\nprint(paste(\"A: lat =\",lat.A))\nprint(paste(\"A: ind.lat.* =\",ind.lat.A))\nprint(paste(\"A: gmi.*[ind.lat.*] =\",gmi.1$y[ind.lat.A]))\n\nind.lon.A<-which.min(abs(gmi.1$x-lon.A))\nprint(paste(\"A: lon =\",lon.A))\nprint(paste(\"A: ind.lon.* =\",ind.lon.A))\nprint(paste(\"A: gmi.*[ind.lon.*] =\",gmi.1$x[ind.lon.A]))\n\nprint(\"\")\n\nind.lat.B<-which.min(abs(gmi.1$y-lat.B))\nprint(paste(\"B: lat =\",lat.B))\nprint(paste(\"B: ind.lat.* =\",ind.lat.B))\nprint(paste(\"B: gmi.*[ind.lat.*] =\",gmi.1$y[ind.lat.B]))\n\nind.lon.B<-which.min(abs(gmi.1$x-lon.B))\nprint(paste(\"B: lon =\",lon.B))\nprint(paste(\"B: ind.lon.* =\",ind.lon.B))\nprint(paste(\"B: gmi.*[ind.lon.*] =\",gmi.1$x[ind.lon.B]))\n","48a0720e":"#-- Tb10V vs. longitude \n\noptions(repr.plot.width=15, repr.plot.height=8)\n\n# plota Tb10V vs. longitude da linha A\nplot(y=gmi.1$Tb10V[,ind.lat.A],\n     x=gmi.1$x,\n     xlab=\"longitude\", \n     ylab=\"Tb10V (K)\",\n     cex.lab=1.5,\n     cex.axis=1.5,\n     type=\"l\",\n     lty=\"solid\",\n     lwd=2)\n\n# acerescenta a linha de  Tb10V vs. longitude da linha B\nlines(y=gmi.1$Tb10V[,ind.lat.B],\n      x=gmi.1$x,\n      type=\"l\",\n      lty=\"dashed\",\n      lwd=2)\n","edf825fa":"#-- Tb10V vs. latitiude\n\n\n\n","9baf442f":"#-- Definindo o tamanho da tela a ser plotada\noptions(repr.plot.width=16, repr.plot.height=16)\n\n#-- plota duas figuras, uma em cada coluna (2,2)\npar(mfrow=c(2,2)) \n\n#-----------------------------------------------------------------------\n#-- Plota imagem e linhas de latitude e longitude sobrepostas para Tb10V\n#-- plota imagem\nimage.plot(z=gmi.1$Tb10V,\n           x=gmi.1$x,\n           y=gmi.1$y,\n           xlab=\"longitude\",\n           ylab=\"latitude\",\n           cex.lab=1.5,\n           cex.axis=1.5,\n           main=paste(gmi.1$t,\"Tb10V\"))\n#-- plota mapa\nmap(\"world\",add=T)\n#-- plota linha horizontal\nabline(h=26.3,\n       lty=\"solid\",lwd=2)  \n#-- plota linha horizontal\nabline(h=29,\n       lty=\"dashed\",lwd=2)  \n#-- plota linha vertical\nabline(v=-95.8,\n       lty=\"solid\",lwd=2) \n#-- plota linha vertical\nabline(v=-94.8,\n       lty=\"dashed\",lwd=2) \n\n#-----------------------------------------------------------------------\n#-- Plota imagem e linhas de latitude e longitude sobrepostas para Tb19V\n#-- plota imagem\nimage.plot(z=gmi.1$Tb19V,\n           x=gmi.1$x,\n           y=gmi.1$y,\n           xlab=\"longitude\", \n           ylab=\"latitude\",\n           cex.lab=1.5,\n           cex.axis=1.5,\n           main=paste(gmi.1$t,\"Tb19V\"))\n#-- plota mapa\nmap(\"world\",add=T)\n#-- plota linha horizontal\nabline(h=26.3,\n       lty=\"solid\",lwd=2)  \n#-- plota linha horizontal\nabline(h=29,\n       lty=\"dashed\",lwd=2)  \n#-- plota linha vertical\nabline(v=-95.8,\n       lty=\"solid\",lwd=2) \n#-- plota linha vertical\nabline(v=-94.8,\n       lty=\"dashed\",lwd=2) \n\n#-----------------------------------------------------------------------\n#-- Plota imagem e linhas de latitude e longitude sobrepostas para Tb37V\n#-- plota imagem\nimage.plot(z=gmi.1$Tb37V,\n           x=gmi.1$x,\n           y=gmi.1$y,\n           xlab=\"longitude\", \n           ylab=\"latitude\",\n           cex.lab=1.5,\n           cex.axis=1.5,\n           main=paste(gmi.1$t,\"Tb37V\"))\n#-- plota mapa\nmap(\"world\",add=T)\n#-- plota linha horizontal\nabline(h=26.3,\n       lty=\"solid\",lwd=2)  \n#-- plota linha horizontal\nabline(h=29,\n       lty=\"dashed\",lwd=2)  \n#-- plota linha vertical\nabline(v=-95.8,\n       lty=\"solid\",lwd=2) \n#-- plota linha vertical\nabline(v=-94.8,\n       lty=\"dashed\",lwd=2) \n\n#-----------------------------------------------------------------------\n#-- Plota imagem e linhas de latitude e longitude sobrepostas para Tb89V\n#-- plota imagem\nimage.plot(z=gmi.1$Tb89V,\n             x=gmi.1$x,\n             y=gmi.1$y,\n             xlab=\"longitude\",\n             ylab=\"latitude\",\n             cex.lab=1.5,\n             cex.axis=1.5,\n             main=paste(gmi.1$t,\"Tb89V\"))\n#-- plota mapa\nmap(\"world\",add=T)\n#-- plota linha horizontal\nabline(h=26.3,\n       lty=\"solid\",lwd=2)  \n#-- plota linha horizontal\nabline(h=29,\n       lty=\"dashed\",lwd=2)  \n#-- plota linha vertical\nabline(v=-95.8,\n       lty=\"solid\",lwd=2) \n#-- plota linha vertical\nabline(v=-94.8,\n       lty=\"dashed\",lwd=2) \n","ed57c077":"#-- Abrindo o arquivo\npng(filename=\"passagem1-Tbs.png\", width = 1200, height = 1000)\n\n#-- plota duas figuras, uma em cada coluna (2,2)\npar(mfrow=c(2,2), mar=c(5,5,3,1), oma=c(0.5,0.5,0.5,0.5))\n\n#-----------------------------------------------------------------------\n#-- Plota imagem e linhas de latitude e longitude sobrepostas para Tb10V\n#-- plota imagem\nimage.plot(z=gmi.1$Tb10V,\n           x=gmi.1$x,\n           y=gmi.1$y,\n           xlab=\"longitude\",\n           ylab=\"latitude\",\n           cex.lab=1.5,\n           cex.axis=1.5,\n           main=paste(gmi.1$t,\"Tb10V\"))\n#-- plota mapa\nmap(\"world\",add=T)\n#-- plota linha horizontal\nabline(h=26.3,\n       lty=\"solid\",lwd=2)  \n#-- plota linha horizontal\nabline(h=29,\n       lty=\"dashed\",lwd=2)  \n#-- plota linha vertical\nabline(v=-95.8,\n       lty=\"solid\",lwd=2) \n#-- plota linha vertical\nabline(v=-94.8,\n       lty=\"dashed\",lwd=2) \n\n#-----------------------------------------------------------------------\n#-- Plota imagem e linhas de latitude e longitude sobrepostas para Tb19V\n#-- plota imagem\nimage.plot(z=gmi.1$Tb19V,\n           x=gmi.1$x,\n           y=gmi.1$y,\n           xlab=\"longitude\", \n           ylab=\"latitude\",\n           cex.lab=1.5,\n           cex.axis=1.5,\n           main=paste(gmi.1$t,\"Tb19V\"))\n#-- plota mapa\nmap(\"world\",add=T)\n#-- plota linha horizontal\nabline(h=26.3,\n       lty=\"solid\",lwd=2)  \n#-- plota linha horizontal\nabline(h=29,\n       lty=\"dashed\",lwd=2)  \n#-- plota linha vertical\nabline(v=-95.8,\n       lty=\"solid\",lwd=2) \n#-- plota linha vertical\nabline(v=-94.8,\n       lty=\"dashed\",lwd=2) \n\n#-----------------------------------------------------------------------\n#-- Plota imagem e linhas de latitude e longitude sobrepostas para Tb37V\n#-- plota imagem\nimage.plot(z=gmi.1$Tb37V,\n           x=gmi.1$x,\n           y=gmi.1$y,\n           xlab=\"longitude\", \n           ylab=\"latitude\",\n           cex.lab=1.5,\n           cex.axis=1.5,\n           main=paste(gmi.1$t,\"Tb37V\"))\n#-- plota mapa\nmap(\"world\",add=T)\n#-- plota linha horizontal\nabline(h=26.3,\n       lty=\"solid\",lwd=2)  \n#-- plota linha horizontal\nabline(h=29,\n       lty=\"dashed\",lwd=2)  \n#-- plota linha vertical\nabline(v=-95.8,\n       lty=\"solid\",lwd=2) \n#-- plota linha vertical\nabline(v=-94.8,\n       lty=\"dashed\",lwd=2) \n\n#-----------------------------------------------------------------------\n#-- Plota imagem e linhas de latitude e longitude sobrepostas para Tb89V\n#-- plota imagem\nimage.plot(z=gmi.1$Tb89V,\n             x=gmi.1$x,\n             y=gmi.1$y,\n             cex.lab=1.5,\n             cex.axis=1.5,\n             xlab=\"longitude\",\n             ylab=\"latitude\",\n             main=paste(gmi.1$t,\"Tb89V\"))\n#-- plota mapa\nmap(\"world\",add=T)\n#-- plota linha horizontal\nabline(h=26.3,\n       lty=\"solid\",lwd=2)  \n#-- plota linha horizontal\nabline(h=29,\n       lty=\"dashed\",lwd=2)  \n#-- plota linha vertical\nabline(v=-95.8,\n       lty=\"solid\",lwd=2) \n#-- plota linha vertical\nabline(v=-94.8,\n       lty=\"dashed\",lwd=2) \n\n\n#-- fechando o arquivo\ndev.off()","9cebc251":"#-- Definindo o tamanho da tela a ser plotada\noptions(repr.plot.width=16, repr.plot.height=8)\n\n#-- Achando os limites do eixo Y de Tb\ntbs<-c(gmi.1$Tb10V[,ind.lat.A], gmi.1$Tb19V[,ind.lat.A], gmi.1$Tb37V[,ind.lat.A], gmi.1$Tb89V[,ind.lat.A])\nYLIM<-c(min(tbs,na.rm=T), max(tbs,na.rm=T))\n\n#-- Plotando a linha de Tb10V\nplot(y = gmi.1$Tb10V[,ind.lat.A],\n     x = gmi.1$x,\n     ylim = YLIM,\n     xlab = \"longitude\",\n     ylab = \"Tb (K)\",\n     cex.lab = 1.5,\n     cex.axis = 1.5,\n     type = \"l\",\n     lty = \"solid\",\n     col = \"black\",\n     lwd = 2,\n     main = \"lat.A\")\n#-- acrescentando a linha de Tb19V\nlines(y=gmi.1$Tb19V[,ind.lat.A],\n      x=gmi.1$x,\n      type=\"l\",\n      lty=\"dashed\",\n      col = \"red\",\n      lwd=2)\n#-- acrescentando a linha de Tb37V\nlines(y=gmi.1$Tb37V[,ind.lat.A],\n      x=gmi.1$x,\n      type=\"l\",\n      lty=\"dotted\",\n      col = \"blue\",\n      lwd=2)\n#-- acrescentando a linha de Tb890V\nlines(y=gmi.1$Tb89V[,ind.lat.A],\n      x=gmi.1$x,\n      type=\"l\",\n      lty=\"dotdash\",\n      col = \"green\",\n      lwd=2)\n#-- acrescentando a legenda\nlegend(x = -100, \n       y = 190, \n       legend = c(\"Tb10V\",\"Tb19V\",\"Tb37V\",\"Tb89V\"), \n       col = c(\"black\",\"red\",\"blue\",\"green\"),\n       lty = c(\"solid\",\"dashed\",\"dotted\",\"dotdash\"),\n       cex = 1.1,\n       text.width = 2,\n       bty = \"n\")\n","184dfaf8":"#-- Definindo o tamanho da tela a ser plotada\noptions(repr.plot.width=16, repr.plot.height=8)\n\n#-- Achando os limites do eixo Y de Tb\ntbs<-c(gmi.1$Tb10V[,ind.lat.B], gmi.1$Tb19V[,ind.lat.B], gmi.1$Tb37V[,ind.lat.B], gmi.1$Tb89V[,ind.lat.B])\nYLIM<-c(min(tbs,na.rm=T), max(tbs,na.rm=T))\n\n#-- Plotando a linha de Tb10V\nplot(y = gmi.1$Tb10V[,ind.lat.B],\n     x = gmi.1$x,\n     ylim = YLIM,\n     xlab = \"longitude\",\n     ylab=\"Tb (K)\",\n     cex.lab = 1.5,\n     cex.axis = 1.5,\n     type = \"l\",\n     lty = \"solid\",\n     col = \"black\",\n     lwd = 2,\n     main=\"lat.B\")\n#-- acrescentando a linha de Tb19V\nlines(y=gmi.1$Tb19V[,ind.lat.B],\n      x=gmi.1$x,\n      type=\"l\",\n      lty=\"dashed\",\n      col = \"red\",\n      lwd=2)\n#-- acrescentando a linha de Tb19V\nlines(y=gmi.1$Tb37V[,ind.lat.B],\n      x=gmi.1$x,\n      type=\"l\",\n      lty=\"dotted\",\n      col = \"blue\",\n      lwd=2)\n#-- acrescentando a linha de Tb19V\nlines(y=gmi.1$Tb89V[,ind.lat.B],\n      x=gmi.1$x,\n      type=\"l\",\n      lty=\"dotdash\",\n      col = \"green\",\n      lwd=2)\n#-- acrescentando a legenda\nlegend(-101, \n       y = 240, \n       legend = c(\"Tb10V\",\"Tb19V\",\"Tb37V\",\"Tb89V\"), \n       col = c(\"black\",\"red\",\"blue\",\"green\"),\n       lty = c(\"solid\",\"dashed\",\"dotted\",\"dotdash\"),\n       cex = 1.1,\n       text.width = 2)\n\n","0fa20934":"#-- Definindo o tamanho da tela a ser plotada\noptions(repr.plot.width=16, repr.plot.height=8)\n\n#-- Achando os limites do eixo Y de Tb\ntbs<-c(gmi.1$Tb10V[ind.lon.B,], gmi.1$Tb19V[ind.lon.B,], gmi.1$Tb37V[ind.lon.B,], gmi.1$Tb89V[ind.lon.B,])\nYLIM<-c(min(tbs,na.rm=T), max(tbs,na.rm=T))\n\n#-- Plotando a linha de Tb10V\nplot(y=gmi.1$Tb10V[ind.lon.B,],\n     x=gmi.1$y,\n     ylim=YLIM,\n     xlab=\"latitude\",\n     ylab=\"Tb (K)\",\n     cex.lab = 1.5,\n     cex.axis = 1.5,\n     type=\"l\",\n     lty=\"solid\",\n     col = \"black\",\n     lwd=2,main=\"lon.B\")\n#-- acrescentando a linha de Tb19V\nlines(y=gmi.1$Tb19V[ind.lon.B,],\n      x=gmi.1$y,\n      type=\"l\",\n      lty=\"dashed\",\n      col = \"red\",\n      lwd=2)\n#-- acrescentando a linha de Tb37V\nlines(y=gmi.1$Tb37V[ind.lon.B,],\n      x=gmi.1$y,\n      type=\"l\",\n      lty=\"dotted\",\n      col = \"blue\",\n      lwd=2)\n#-- acrescentando a linha de Tb89V\nlines(y=gmi.1$Tb89V[ind.lon.B,],\n      x=gmi.1$y,\n      type=\"l\",\n      lty=\"dotdash\",\n      col = \"green\",\n      lwd=2)\n#-- acrescentando a legenda\nlegend(x = 29.6, \n       y = 220, \n       legend = c(\"Tb10V\",\"Tb19V\",\"Tb37V\",\"Tb89V\"), \n       col = c(\"black\",\"red\",\"blue\",\"green\"),\n       lty = c(\"solid\",\"dashed\",\"dotted\",\"dotdash\"),\n       cex = 1.1,\n       text.width = 2)\n\n","9b00608e":"options(repr.plot.width=10, repr.plot.height=10)\n\n#-- plota a imagem\nimage.plot(z=gprof.1$r,\n           x=gprof.1$x,\n           y=gprof.1$y,\n           main=paste(gprof.1$t,\"gprof\"))\n#-- plota mapa\nmap(\"world\",add=T)\n\n#-- plota linha horizontal\nabline(h=26.3,\n       lty=\"solid\",lwd=2)  \n#-- plota linha horizontal\nabline(h=29,\n       lty=\"dashed\",lwd=2)  \n#-- plota linha vertical\nabline(v=-95.8,\n       lty=\"solid\",lwd=2) \n#-- plota linha vertical\nabline(v=-94.8,\n       lty=\"dashed\",lwd=2) \n\n","5cdc2bf1":"#-- Definindo o tamanho da tela a ser plotada\noptions(repr.plot.width=16, repr.plot.height=8)\n\nplot(y=gprof.1$r[,ind.lat.A],\n      x=gprof.1$x,\n      xlab=\"longitude\", \n      ylab=\"R (mm\/h)\",\n      cex.lab = 1.5,\n      cex.axis = 1.5,\n      type=\"l\",\n      lty=\"solid\",\n      col = \"violet\",\n      lwd=3,main=\"lat.A\")\n\nlines(y=dpr.1$r[,ind.lat.A],\n     x=dpr.1$x,\n     type=\"l\",\n     lty=\"dashed\",\n     col = \"orange\",\n     lwd=3)\n\nlegend(x = -90,\n       y = 30,\n       legend = c(\"GPROF\",\"DPR\"), \n       col = c(\"violet\",\"orange\"),\n       lty = c(\"solid\",\"dashed\"),\n       cex  =1.1,\n       text.width = 2)\n\n","d430d124":"#-- Definindo o tamanho da tela a ser plotada\noptions(repr.plot.width=16, repr.plot.height=8)\n\nplot(y=gprof.1$r[ind.lon.A,],\n      x=gprof.1$y,\n      xlab=\"latitude\", \n      ylab=\"R (mm\/h)\",\n      cex.lab = 1.5,\n      cex.axis = 1.5,\n      type=\"l\",\n      lty=\"solid\",\n      col = \"violet\",\n      lwd=3,main=\"lon.A\")\n\nlines(y=dpr.1$r[ind.lon.A,],\n     x=dpr.1$y,\n     type=\"l\",\n     lty=\"dashed\",\n     col = \"orange\",\n     lwd=3)\n\nlegend(x = 30, \n       y = 40, \n       legend=c(\"GPROF\",\"DPR\"), \n       col = c(\"violet\",\"orange\"),\n       lty = c(\"solid\",\"dashed\"),\n       cex=1.1,\n       text.width=2)\n","8d40339d":"# Gr\u00e1ficos de dispers\u00e3o de Rdo GPROF vs. Tb (10V, 19V, 37V e 89V)\n\n\n","ed83250e":"# Gr\u00e1ficos de dispers\u00e3o de R do DPR vs. GPROF.\n\n\n","a0789ba0":"# Calcule o BIAS, RMSE, MAE e PMRE entre R do DPR vs. GPROF.\n\nm <- R_observada\ne <- R_estimada\n\nBIAS <- mean(e-m,na.rm=T)\nRMSE <- (mean((e-m)^2,na.rm=T))^0.5\nMAE <- mean(abs(e-m),na.rm=T)\nPMRE <- 100 * mean(abs((e-m)\/m),na.rm=T)\nprint(paste(\"BIAS =\", BIAS,\"mm\/h\"))\nprint(paste(\"RMSE =\", RMSE,\"mm\/h\"))\nprint(paste(\"MAE =\", MAE,\"mm\/h\"))\nprint(paste(\"PMRE = \", PMRE,\"%\"))","d5d2a916":"Agora, plote a estimativa de precipita\u00e7\u00e3o do DPR na **1a passagem** sobre o furac\u00e3o (`dpr.1$r`), e as linhas `A` e `B`:\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","4888f909":"---\n### a.2) Usando a 1a passagem do sat\u00e9lite GPM, escolha 2 faixas de latitude e 2 faixas de longitude (as quais pelo menos uma passe sobre  ambos os continentes e o oceano), e alguma que passe sobre o olho do furac\u00e3o (ou precipita\u00e7\u00e3o mais intensa, se n\u00e3o tiver olho), e fa\u00e7a gr\u00e1ficos de:\n\nOu seja vamos plotar linhas de:\n\n* `Tb` (`10V`, `19V`, `37V` e `89V` GHz) vs. `longitude` (i.e., latitude fixa)\n\n* `Tb` (`10V`, `19V`, `37V` e `89V` GHz) vs. `latitude` (i.e., longitude fixa)\n\n\nUse a fun\u00e7\u00e3o `abline()` para procurar as latitudes e longitudes nas imagens de Tbs.\n\nPor exemplo, plotando a imagem de `Tb37V` e linhas horizontais (latitude fixa) e verticais (longitude fixa):\n","ed35f269":"Agora vamos plotar no mesmo gr\u00e1fico todas as `Tb` (10V, 19V, 37V e 89V) vs. `longitude` das linhas `A`:\n\n","346b4b51":"Agora plote todas as `Tb` (10V, 19V, 37V e 89V) vs. `latitude` no mesmo gr\u00e1fico das linhas `A`:\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","d2a6a444":"---\n## **a) Estudando o comportamento dos v\u00e1rios canais do sensor GMI**\n\n\n### a.1) Plote as imagens de cada um dos canais verticais do GMI (10V, 19V, 37V e 89V GHz) da 1a passagem do sat\u00e9lite GPM. \n\nUse a fun\u00e7\u00e3o `image.plot()`.\n\nPor exemplo, plotando para os canais 10V e 19V da **1a passagem** sobre o furac\u00e3o (`gmi.1`):","61f8371f":"Visualize os vetores de latitude e longitude de `gmi.2`:\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","f2436449":"---\n\n---\n\n## Inicializando\n\nPrimeiro, vamos estabelecer o diret\u00f3rio de execu\u00e7\u00e3o.\n\n<span style=\"color:red\"> (Complete abaixo com o caminho da pasta onde est\u00e3o os seus dados.) <\/span>\n","83a80480":"Carregando as bibliotecas que vamos usar:","b95d6cfe":"---\n### a.3) Repita os passos de a.1) e a.2) para a 2a passagem do sat\u00e9lite sobre o furac\u00e3o.\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","3b465663":"A vari\u00e1vel `dpr.*` \u00e9 uma lista contendo:\n* `t` = string com a data\/hora\n* `x` = vetor longitude (de tamanho `nx`)\n* `y` = vetor latitude (de tamanho `ny`)\n* `r` = matriz de estimativa de taxa de precipita\u00e7\u00e3o (R, em mmm\/h) pelo radar DPR (de tamanho `[nx,ny]`)\n\nVisualize os elementos de `dpr.1` e `dpr.2`:\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","1777cae3":"---\n## **b) Estudando o comportamento da estimativa de precipita\u00e7\u00e3o do algoritmo GPROF  e aquela estimada pelo radar DPR**\n\n### b.1) Plote as imagens das estimativas de precipita\u00e7\u00e3o do GPROF e do DPR e as linhas longitudinais e latitudinais escolhidas acima, para a 1a passagem do sat\u00e9lite sobre o furac\u00e3o.  \n\nPor exemplo, plotando a estimativa de precipitac\u00e3o do GPROF na **1a passagem** sobre o furac\u00e3o (`gprof.1$r`), e as linhas `A` e `B`:\n","d5a42285":"\n### b.2) Plote as estimativas de precipita\u00e7\u00e3o das linhas longitudinais e latitudinais A e B, para a 1a passagem do sat\u00e9lite sobre o furac\u00e3o. \n\nPlotando, no mesmo gr\u00e1fico, `R` vs. `longitude` do GPROF (`gprof.1$r`) e do DPR (`dpr.1$r`) para a linha `A`:\n","b97a4280":"---\n### b.3) Repita os passos de b.1) e b.2) para a 2a passagem do sat\u00e9lite sobre o furac\u00e3o.\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","50bdee86":"A vari\u00e1vel `gprof.*` \u00e9 uma lista contendo:\n* `t` = string com a data\/hora\n* `x` = vetor longitude (de tamanho `nx`)\n* `y` = vetor latitude (de tamanho `ny`)\n* `r` = matriz de estimativa de taxa de precipita\u00e7\u00e3o (R, em mmm\/h) pelo GMI usando o algoritimo GPROF (de tamanho `[nx,ny]`)\n\n\nVisualize os elementos de `gprof.1` e `gprof.2`:\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","b14907b9":"Agora plote `Tb` vs. `latitude`:\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","9bd714eb":"---\n## Lendo os dados em .HDF5\n\nLendo as fun\u00e7\u00f5es que leem os dados:","7053d737":"---\n### a.4) Usando os conceitos aprendidos na aula te\u00f3rica sobre cada um dos canais de microondas, fa\u00e7a uma an\u00e1lise sobre as `Tb` observadas nas imagens, usando os gr\u00e1ficos `Tb` vs. `longitude` e `latitude` dos itens anteriores (a.1, a.2 e a.3) para exemplificar suas afirma\u00e7\u00f5es.\n\n### Nesta an\u00e1lise use as duas passagens do sat\u00e9lite (1a e 2a passagens). Note que na primeira 1a passagem o furac\u00e3o est\u00e1 sobre o oceano e na segunda o furac\u00e3o est\u00e1 sobre o continente. Logo, na sua an\u00e1lise leve em considera\u00e7\u00e3o tamb\u00e9m o impacto da superf\u00edcie (oceano ou continente).\n\n","6116f2c8":"Abaixo lemos os arquivos de cada \u00f3rbita. Demora alguns minutos para ler...\n\n<span style=\"color:red\"> Para cada ciclone tropical e \u00f3rbita, complete abaixo com o caminho dos dados correspondentes.<\/span>","11ac4f9d":"Visualize os vetores de latitude e longitude de `gmi.1`:\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","b726d90d":"Plotando `Tb` vs. `longitude` :\n","b2df9f00":"... e agora fa\u00e7a o mesmo (`R` vs. `latitude`) para a linha `B`:\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>\n\n","5fb8217d":"Neste exerc\u00edcio iremos estudar:\n\n### **a)** O comportamento dos v\u00e1rios canais do sensor de microondas do sat\u00e9lite GPM (*Global Precipitaion Mission*) (Figura 1) (https:\/\/pmm.nasa.gov\/), o **GMI (*GPM Microwave Imager*)**; e\n\n### **b)** O comportamento da estimativa de precipita\u00e7\u00e3o usando o algoritmo GPROF (*Goddard Profiling Algorithm*) e aquela estimada pelo radar, tamb\u00e9m a bordo deste sat\u00e9lite, o DPR (*Dual Precipitation Radar*).\n\n![](https:\/\/drive.google.com\/uc?export=view&id=1Dgg5Z-ONawOpVTUuyPOKrMcNEFy5StFm)\n\nFigura 1 - Sat\u00e9lite GPM e seu v\u00e1rios sensores.\n\nEm sala de aula iremos estudar o **furac\u00e3o Harvey**, que afetou o estado do Texas em 2017. O furac\u00e3o **Harvey** ocorreu no final do m\u00eas de agosto de 2017, e os dados do GPM para este furac\u00e3o s\u00e3o uma \u00f3rbita do dia `2017-08-25` (com o furac\u00e3o no oceano) e outra do dia `2017-08-27`(com o furac\u00e3o sobre o continente).\n\nPara entregar, cada dupla ou pessoa trabalhar\u00e1 com um dos ciclones tropicais listados [nesta apresenta\u00e7\u00e3o](https:\/\/docs.google.com\/presentation\/d\/1qck70KhYPOKMDE-Cd45doeY-KNl0pHNZpbqcWav_SuQ\/edit?usp=sharing), sem sobreposi\u00e7\u00e3o. Indicar o nome da tempestade a ser estudada [nesta planilha](https:\/\/docs.google.com\/spreadsheets\/d\/1-KaPCGm9q7pbz-LccdWYcCQFEM1FWfkI6pl4nPYzAtY\/edit?usp=sharing). Voc\u00eas ter\u00e3o que fazer o download dos dados correspondentes \u00e0s \u00f3rbitas indicadas do seu ciclone tropical (links na apresenta\u00e7\u00e3o).\n\nOs dados do sat\u00e9lite GPM do furac\u00e3o Harvey est\u00e3o neste *dataset*: https:\/\/www.kaggle.com\/rachelalbrecht\/2021lista09. Adicione-o \u00e0 este notebook.\n\nNele h\u00e1 dois diret\u00f3rios: `arquivosauxiliares` e `dados`. No diret\u00f3rio `dados` temos arquivos para duas \u00f3rbitas do sat\u00e9lite GPM que passaram sobre este furac\u00e3o. Cada \u00f3rbita contem 3 arquivos correspondentes \u00e0s **Tb** do sensor GMI, \u00e0 estimativa de precipita\u00e7\u00e3o (**R**) do radar DPR e \u00e0 estimativa de precipita\u00e7\u00e3o do GMI usando o algoritmo GPROF. A nomenclatura desses arquivos \u00e9:\n\n* GMI: `1C.GPM.GMI.XCAL2016-C.YYYMMDD-SHHMMSS-EHHMMSS.NNNNNN.V05A.HDF5`\n* R(mm\/h) DPR: `2A.GPM.DPR.V7-20170308.YYYMMDD-SHHMMSS-EHHMMSS.NNNNNN.V05A.HDF5`\n* R(mm\/h) GMI GPROF: `2A.GPM.GMI.GPROF2017v1.YYYMMDD-SHHMMSS-EHHMMSS.NNNNNN.V05A.HDF5`\n\nonde:\n\n* YYYYMMDD = ano, mes, dia\n* SHHMMSS e EHHMMSS = hora, minuto e segundo do in\u00edcio (_start_) e fim (_end_) da \u00f3rbita\n* NNNNNNN = n\u00famero da \u00f3rbita\n\nOs dados est\u00e3o em formato HDF5 (https:\/\/support.hdfgroup.org\/HDF5\/) e usaremos a biblioteca `rhdf5` do R para ler esses arquivos. Tamb\u00e9m vamos usar a biblioteca `akima` para interpolarmos os dados para a mesma grade cartesiana e estudarmos as diferen\u00e7as nas estimativas de precipita\u00e7\u00e3o.\n\nO furac\u00e3o **Harvey** ocorreu no final do m\u00eas de agosto de 2017, e os dados do GPM para este furac\u00e3o s\u00e3o uma \u00f3rbita do dia `2017-08-25` (com o furac\u00e3o no oceano) e outra do dia `2017-08-27`(com o furac\u00e3o sobre o continente):\n\n* `1C.GPM.GMI.XCAL2016-C.20170825-S111924-E125156.019833.V05A.HDF5`\n* `1C.GPM.GMI.XCAL2016-C.20170827-S202340-E215612.019870.V05A.HDF5`\n* `2A.GPM.DPR.V7-20170308.20170825-S111924-E125156.019833.V05A.HDF5`\n* `2A.GPM.DPR.V7-20170308.20170827-S202340-E215612.019870.V05A.HDF5`\n* `2A.GPM.GMI.GPROF2017v1.20170825-S111924-E125156.019833.V05A.HDF5`\n* `2A.GPM.GMI.GPROF2017v1.20170827-S202340-E215612.019870.V05A.HDF5`","b3ac4720":"Agora plotando a mesma figura, mas salvando em um arquivo.","9163c6d9":"As fun\u00e7\u00f5es:\n\n* `read_GMI_and_interpolate(arquivo,XLIM,YLIM,tbname,DG=0.05)`\n* `read_DPR_and_interpolate(arquivo,XLIM,YLIM,DG=0.05)`\n* `read_GPROF_and_interpolate(arquivo,XLIM,YLIM,DG=0.05)`\n\nleem os dados `HDF5` usando a biblioteca `rhdf5` e interpola esses dados para uma grade regular de resolu\u00e7\u00e3o `DG` entre os limites dados por `XLIM` e `YLIM`. Aqui vamos usar `DG=0.05` grau (~5km).\n\nPara cada \u00f3ribta `NNNNNN`, os limites de `XLIM` e `YLIM` mudam. Abaixo est\u00e3o definidos os limites para a primeira \u00f3rbita (`XLIM.1` e `YLIM.1`) e a segunda \u00f3rbita (`XLIM.2` e `YLIM.2`).\n\n<span style=\"color:red\"> Para cada ciclone tropical e \u00f3rbita, voc\u00eas ter\u00e3o que definir este limites baseado nas informa\u00e7\u00f5es das \u00f3rbitas na [apresenta\u00e7\u00e3o](https:\/\/docs.google.com\/presentation\/d\/1qck70KhYPOKMDE-Cd45doeY-KNl0pHNZpbqcWav_SuQ\/edit?usp=sharing).<\/span>","757ddf22":"A vari\u00e1vel `gmi.*` \u00e9 uma lista contendo os seguintes elementos:\n* `t` = string com a data\/hora\n* `x` = vetor longitude (de tamanho `nx`)\n* `y` = vetor latitude (de tamanho `ny`)\n* `Tb10V`, `Tb10H`, `Tb19V`, `Tb19H`, `Tb23V`, `Tb37V`, `Tb37H`, `Tb89V`, `Tb89H` = matrizes de temperaturas de brilho (de tamanho `[nx,ny]`)\n","9d92f6bf":"Agora plote para os canais 37V e 89V da **1a passagem (`gmi.1`)** sobre o furac\u00e3o:\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","57b01806":"... e agora fa\u00e7a o mesmo (`R` vs. `longitude`) para a linha `B`:\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>\n\n","951d6e90":"Visualize as strings `gmi.1$t` e `gmi.2$t`:\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","b76be528":"---\n### b.4) Usando os gr\u00e1ficos e an\u00e1lises acima, fa\u00e7a uma compara\u00e7\u00e3o cr\u00edtica das estimativas de precipita\u00e7\u00e3o do DPR e do GPROF, e destas estimativas com m\u00e9todos usando a Tb no infravermelho estudo na lista anterior.\n\nNa sua an\u00e1lise, fa\u00e7a\/use:\n* Os gr\u00e1ficos dos itens a, b.1-3 para exemplificar suas conclus\u00f5es. \n* Gr\u00e1ficos de dispers\u00e3o de `R` do GPROF vs. Tb (10V, 19V, 37V e 89V).\n* Gr\u00e1ficos de dispers\u00e3o de `R` do DPR vs. GPROF.\n* Calcule o `BIAS`, `RMSE`, `MAE` e `PMRE` entre `R` do DPR vs. GPROF.\n\nDicas:\n* use apenas dados com R >0 e n\u00e3o `NA`.\n* Nos gr\u00e1ficos de dispers\u00e3o, lembre-se de adiciona a linha 1:1 e ajustar fun\u00e7\u00f5es (retas, exponenciais, polin\u00f4mios, etc.).\n\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","0e6d0bbc":"Definindo o nome dos canais do sensor GMI (correspondentes \u00e0s frequencias de medi\u00e7\u00e3o):","60870c90":"Agora plote todas as imagens de `Tb` com as mesmas linhas horizontais e verticais sobrepostas, lado a lado, para a 1a passagem do sat\u00e9lite:\n\nDica: Use:\n`par(mfrow=c(2,2)) #-plota duas figuras, uma em cada coluna (2,2)`  e escolha cores diferentes para cada `Tb` (a serem usadas no pr\u00f3ximo item).\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","0d91c861":"Agora plote todas as `Tb` (10V, 19V, 37V e 89V) vs. `longitude` no mesmo gr\u00e1fico das linhas `B`:\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","9c3d5c22":"## [ACA0413] Lista de Exerc\u00edcios 9  - INDIVIDUAL OU EM DUPLAS\n# Estimativa de precipita\u00e7\u00e3o: Microondas","f083d0bb":"Agora plote a mesma figura acima, mas salve em um arquivo.\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","a64b5b18":"Agora plote todas as `Tb` (10V, 19V, 37V e 89V) vs. `latitude` no mesmo gr\u00e1fico das linhas `B`:\n\n<span style=\"color:red\"> (Complete abaixo.)<\/span>","da852569":"Plotando, no mesmo gr\u00e1fico, `R` vs. `latitude` do GPROF (`gprof.1$r`) e do DPR (`dpr.1$r`) para a linha `A`:\n","5b85ad1a":"Depois que achar as latitude e longitude de cortes, use as fun\u00e7\u00f5es `which.min()` e `abs()` para achar o \u00edndice dessas latitudes e longitudes nos vetores `gmi.1$x` e `gmi.1$y`. Esses \u00edndices ser\u00e3o usados para plotar `Tb` vs. `longitude` e `Tb` vs. `latitude`.\n\nPor exemplo:\n\n<span style=\"color:red\"> (Modifique abaixo os valores lat.* e lon.* para os valores que vc achou acima para o seu ciclone tropical.)<\/span>"}}