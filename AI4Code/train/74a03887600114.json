{"cell_type":{"4a171ef7":"code","6dbec75a":"code","e499b90b":"code","0c10e110":"code","35a5e208":"code","58a4afc2":"code","f2500ec2":"code","5b23b28e":"code","7964333e":"code","fb621fec":"code","b1a3febd":"code","5459cf1e":"code","179db9c6":"code","11e493ab":"code","a49a4096":"code","8fc48fb3":"code","a1fe73cd":"code","ed0a6786":"code","eb53d853":"code","9c8834f0":"code","21bfa4d6":"code","ecb05ca2":"code","2117de0f":"code","73689f66":"code","edbcc6a7":"code","db277b0e":"markdown","cc065d9d":"markdown","83efe51b":"markdown","296ba540":"markdown","c64d2e29":"markdown","7d7d3d15":"markdown","25cb1f40":"markdown","4a6eee34":"markdown","3d355065":"markdown","a7745491":"markdown","7b4bf3f6":"markdown","61ae7040":"markdown","f867217a":"markdown","0ee274cd":"markdown","a0f70c2c":"markdown","fe3b7b89":"markdown"},"source":{"4a171ef7":"# import libraries\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np","6dbec75a":"#read csv file\ndf = pd.read_csv('..\/input\/movielens-20m-dataset\/movie.csv')\n\n# first few rows of dataset\ndf.head()","e499b90b":"df.shape","0c10e110":"# drop genres column\ndf.drop(['genres'],axis=1,inplace=True)","35a5e208":"# import rating dataset\nrating = pd.read_csv(\"..\/input\/movielens-20m-dataset\/rating.csv\")\n\n# columns\nrating.columns","58a4afc2":"# we need user id, movie id and rating\nrating = rating.loc[:,[\"userId\",\"movieId\",\"rating\"]]\nrating.head()","f2500ec2":"#then merge movie and rating data\ndf = pd.merge(df,rating)","5b23b28e":"df.head()","7964333e":"df.shape","fb621fec":"df = df.iloc[:1000000]","b1a3febd":"df.shape","5459cf1e":"# basic stats\ndf.describe()","179db9c6":"df.groupby(\"title\").mean()['rating'].sort_values(ascending=False)","11e493ab":"df.groupby(\"title\").count()[\"rating\"].sort_values(ascending=False)","a49a4096":"ratings=pd.DataFrame(df.groupby(\"title\").mean()['rating'])\nratings['number of ratings']=pd.DataFrame(df.groupby(\"title\").count()[\"rating\"])\nprint(ratings.head())","8fc48fb3":"ratings.sort_values(by='rating', ascending=False)","a1fe73cd":"ratings.describe()","ed0a6786":"plt.hist(ratings['rating'])\nplt.show","eb53d853":"plt.hist(ratings['number of ratings'],bins=50)\nplt.show","9c8834f0":"# lets make a pivot table in order to make rows are users and columns are movies. And values are rating\npivot_table = df.pivot_table(index = [\"userId\"],columns = [\"title\"],values = \"rating\")\npivot_table.head(5)","21bfa4d6":"pivot_table.shape","ecb05ca2":"def recommend_movie(movie):\n    movie_watched = pivot_table[movie]\n    similarity_with_other_movies = pivot_table.corrwith(movie_watched)  # find correlation between \"Toy Story (1995)\" and other movies\n    similarity_with_other_movies = similarity_with_other_movies.sort_values(ascending=False)\n    return similarity_with_other_movies.head()","2117de0f":"recommend_movie('American President, The (1995)')","73689f66":"recommend_movie('Toy Story (1995)')","edbcc6a7":"recommend_movie('Taxi Driver (1976)')","db277b0e":"Let's find the number of rating a particular movie has received","cc065d9d":"In our kaggle kernel,we don't have much memory so we have to subset our dataset,we are going to take 1M rows","83efe51b":"First of all we will going to import all the required libraries","296ba540":"If you want to know what are these recommendation system then you must read this amazing article: https:\/\/www.bluepiit.com\/blog\/classifying-recommender-systems\/","c64d2e29":"## Recommendation Engines\nRecommendation Engine filter out the poducts that a paticular customer would be interested in or would buy based on his\/her previous buying history but if the customer is new then this method will fail as we have no previous data from the customer.So,to tackle this issue different methods are used,for example oftern the most popular products are recommended.This recommendations would not be must accurate as they are not customer dependent and are same for all new customers.\n\nSo there are many types of recommndation engines:\n- Collabrative Recommender System\n- Content based Recommender System\n- Demographic based Recommender System\n- Utility based Recommende System\n- Knowledge based Recommende System\n- Hybrid Recommende System","7d7d3d15":"Let's find the average rating of each movie","25cb1f40":"So from above we can see that we don't have any movie with rating 5","4a6eee34":"So we have 27,278 movies.We don't need genres column so we are dropping that column","3d355065":"We need to import our another dataset in which we have ratings for the movie","a7745491":"We will going to take two dataset first one is movie dataset in which we will have movie names and the second dataset will have ratings and userID","7b4bf3f6":"- It can be concluded that we need to recommend \"Angela (1995)\" movie to people who watched \"American President, The (1995)\"\n- It can be concluded that we need to recommend \"Gospa (1995)\" movie to people who watched \"Toy Story (1995)\"\n- It can be concluded that we need to recommend \"Jupiter's Wife (1994)\" movie to people who watched \"Taxi Driver (1976)\"","61ae7040":"Now we will make a function which will recommend the movie with their correlation score.Note that higher the correlation more the movie related to each other","f867217a":"As noted here one user has rated one or more than one movie. This means that one movie has been rated by more than one user.","0ee274cd":"## Recommender System","a0f70c2c":"Now we will going to make a datafame in which we will have rating and number of ratings column","fe3b7b89":"## Data Visualization"}}