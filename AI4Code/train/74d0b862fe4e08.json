{"cell_type":{"4ce3c271":"code","3bf61050":"code","e6a7b1ae":"code","d212922d":"code","0b91814d":"markdown"},"source":{"4ce3c271":"import warnings\nwarnings.simplefilter('ignore')\n\nimport gc\n\nimport numpy as np\nimport pandas as pd\npd.set_option('max_columns', None)\nfrom tqdm.notebook import tqdm\n\nimport joblib\nimport lightgbm as lgb","3bf61050":"lgb_model_0 = joblib.load('..\/input\/lightgbm5foldsgkp\/lgb_0.pkl')\nlgb_model_1 = joblib.load('..\/input\/lightgbm5foldsgkp\/lgb_1.pkl')\nlgb_model_2 = joblib.load('..\/input\/lightgbm5foldsgkp\/lgb_2.pkl')\nlgb_model_3 = joblib.load('..\/input\/lightgbm5foldsgkp\/lgb_3.pkl')\nlgb_model_4 = joblib.load('..\/input\/lightgbm5foldsgkp\/lgb_4.pkl')","e6a7b1ae":"import ubiquant\nenv = ubiquant.make_env()  \niter_test = env.iter_test()","d212922d":"for (test_df, sample_prediction_df) in iter_test:\n    test_df.drop(['row_id'], axis=1, inplace=True)\n    pred_0 = lgb_model_0.predict(test_df)\n    pred_1 = lgb_model_1.predict(test_df)\n    pred_2 = lgb_model_2.predict(test_df)\n    pred_3 = lgb_model_3.predict(test_df)\n    pred_4 = lgb_model_4.predict(test_df)\n    pred = (pred_0 + pred_1 + pred_2 + pred_3 + pred_4) \/ 5\n    sample_prediction_df['target'] = pred\n    env.predict(sample_prediction_df) ","0b91814d":"train code: https:\/\/www.kaggle.com\/hengzheng\/lightgbm-5folds-baseline\n\nchange to \n\n- `kfold = GroupKFold(n_splits=5)`\n- `kfold.split(train[feature_names], train[ycol], train['time_id'])`"}}