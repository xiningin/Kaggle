{"cell_type":{"d8a6f28b":"code","c333b90d":"code","cde759f1":"code","424c3143":"code","4af1ba92":"code","574cd929":"code","dc3cf20a":"code","2a1c8bb1":"code","e2479b98":"code","fda4e20c":"code","a0b164fb":"code","2492e7de":"code","080b95b3":"code","ce004f4a":"code","4b906eee":"code","953fd419":"code","aa8e652d":"code","a86640ae":"code","1139f6ff":"code","c4326ff5":"code","a620d070":"code","e04cb8d3":"code","e18bb34e":"code","4e5448e5":"code","f65a2036":"code","e825b0d1":"code","37830cfd":"code","c100e3b1":"code","8896460c":"code","65bb1786":"code","a2182aba":"code","b9e232d6":"code","6693b781":"code","841eb6df":"code","d334b674":"code","214bdfbb":"code","e9df5668":"code","e4dd7a2f":"code","51c89ab6":"code","bc92bca3":"code","d508e272":"code","f33da3a2":"code","fb38ad99":"code","cb2619d1":"markdown"},"source":{"d8a6f28b":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","c333b90d":"train_data = pd.read_csv(\"..\/input\/big-mart-salescsv\/Train_UWu5bXk.csv\")\ntest_data = pd.read_csv(\"..\/input\/big-mart-salescsv\/Test_u94Q5KV.csv\")","cde759f1":"train_data.head()","424c3143":"test_data.head()","4af1ba92":"train_data.info()","574cd929":"train_data.drop('Item_Identifier',axis=1,inplace=True)\ntest_data.drop('Item_Identifier',axis=1,inplace=True)","dc3cf20a":"train_data.info()","2a1c8bb1":"sns.countplot(x='Item_Fat_Content',data=train_data)","e2479b98":"def clean_col(col):\n    if(col==\"low fat\" or col==\"LF\"):\n        return \"Low Fat\"\n    elif(col==\"reg\"):\n        return \"Regular\"\n    else:\n        return col","fda4e20c":"train_data['Item_Fat_Content']=train_data['Item_Fat_Content'].apply(clean_col)","a0b164fb":"sns.countplot(x='Item_Fat_Content',data=train_data)","2492e7de":"sns.countplot(x='Item_Fat_Content',data=test_data)","080b95b3":"test_data['Item_Fat_Content']=test_data['Item_Fat_Content'].apply(clean_col)","ce004f4a":"sns.countplot(x='Item_Fat_Content',data=test_data)","4b906eee":"plt.figure(figsize=(12,3))\nsns.countplot(x='Item_Type',data=train_data)","953fd419":"sns.heatmap(train_data.isnull(),yticklabels=False,cbar=False,cmap='viridis')","aa8e652d":"train_data.drop('Outlet_Identifier',axis=1,inplace=True)\ntest_data.drop('Outlet_Identifier',axis=1,inplace=True)","a86640ae":"sns.heatmap(train_data.isnull(),yticklabels=False,cbar=False,cmap='viridis')","1139f6ff":"plt.figure(figsize=(15,3))\nsns.boxplot(x=\"Item_Type\", y=\"Item_Weight\", data=train_data,palette='rainbow')","c4326ff5":"train_data.groupby('Item_Type').mean()['Item_Weight']","a620d070":"def fill_null(row):\n    if(pd.isnull(row['Item_Weight'])):\n        row['Item_Weight']=train_data.groupby('Item_Type').mean()['Item_Weight'][row['Item_Type']]\n        return row\n    else:\n        return row","e04cb8d3":"train_data = train_data.apply(fill_null,axis=1)","e18bb34e":"sns.heatmap(train_data.isnull(),yticklabels=False,cbar=False,cmap='viridis')","4e5448e5":"sns.countplot(x='Outlet_Size',data=train_data,hue='Outlet_Type')","f65a2036":"def fill_size(row):\n    if(pd.isnull(row['Outlet_Size'])):\n        if(row['Outlet_Type']==\"Supermarket Type1\"):\n            row['Outlet_Size']=\"Small\"\n            return row\n        elif(row['Outlet_Type']==\"Supermarket Type2\"):\n            row['Outlet_Size']=\"Medium\"\n            return row\n        elif(row['Outlet_Type']==\"Supermarket Type3\"):\n            row['Outlet_Size']=\"Medium\"\n            return row\n        else:\n            row['Outlet_Size']=\"Small\"\n            return row\n    else:\n       return row","e825b0d1":"train_data = train_data.apply(fill_size,axis=1)","37830cfd":"sns.heatmap(train_data.isnull(),yticklabels=False,cbar=False,cmap='viridis')","c100e3b1":"sns.heatmap(test_data.isnull(),yticklabels=False,cbar=False,cmap='viridis')","8896460c":"def fill_null2(row):\n    if(pd.isnull(row['Item_Weight'])):\n        row['Item_Weight']=test_data.groupby('Item_Type').mean()['Item_Weight'][row['Item_Type']]\n        return row\n    else:\n        return row","65bb1786":"test_data = test_data.apply(fill_null2,axis=1)","a2182aba":"sns.heatmap(test_data.isnull(),yticklabels=False,cbar=False,cmap='viridis')","b9e232d6":"sns.countplot(x='Outlet_Size',data=test_data,hue='Outlet_Type')","6693b781":"def fill_size2(row):\n    if(pd.isnull(row['Outlet_Size'])):\n        if(row['Outlet_Type']==\"Supermarket Type1\"):\n            row['Outlet_Size']=\"Small\"\n            return row\n        elif(row['Outlet_Type']==\"Supermarket Type2\"):\n            row['Outlet_Size']=\"Medium\"\n            return row\n        elif(row['Outlet_Type']==\"Supermarket Type3\"):\n            row['Outlet_Size']=\"Medium\"\n            return row\n        else:\n            row['Outlet_Size']=\"Small\"\n            return row\n    else:\n       return row","841eb6df":"test_data = test_data.apply(fill_size2,axis=1)","d334b674":"sns.heatmap(test_data.isnull(),yticklabels=False,cbar=False,cmap='viridis')","214bdfbb":"data_types = train_data.dtypes\nfor cols in train_data.columns:\n    if data_types[cols]==data_types['Item_Type']:\n        temp = pd.get_dummies(train_data[cols],drop_first=True)\n        train_data.drop(cols,axis=1,inplace=True)\n        train_data = pd.concat([train_data,temp],axis=1)\n#data.head()","e9df5668":"train_data.head()","e4dd7a2f":"data_types = test_data.dtypes\nfor cols in test_data.columns:\n    if data_types[cols]==data_types['Item_Type']:\n        temp = pd.get_dummies(test_data[cols],drop_first=True)\n        test_data.drop(cols,axis=1,inplace=True)\n        test_data = pd.concat([test_data,temp],axis=1)","51c89ab6":"test_data.head()","bc92bca3":"from sklearn.tree import DecisionTreeRegressor\nregr = DecisionTreeRegressor()\nregr.fit(train_data.drop('Item_Outlet_Sales',axis=1),train_data['Item_Outlet_Sales'])","d508e272":"X_train = train_data.drop('Item_Outlet_Sales',axis=1)\ny_train = train_data['Item_Outlet_Sales']\nprint(\"Training Accuracy for Decision Tree regressor :\", regr.score(X_train, y_train))","f33da3a2":"predictions = regr.predict(test_data)","fb38ad99":"pd.Series(predictions)","cb2619d1":"# Conclusion\n\nAfter a whole lot of preprocessiong we were finally able to deveop a dataset which was good enough for our model to run. I didn't explain anything step wise but a lot of it is self explanatory. If you liked my notebook pls leave an upvote and if you have any suggestions mention them in the comments too. Cheers!"}}