{"cell_type":{"165f0ab3":"code","0b9e7af6":"code","ecec8049":"code","39c95066":"code","12ebedcc":"code","bc5ebe55":"code","e0e725e1":"code","4d5aa311":"code","a042098a":"code","14635519":"code","4319e2b2":"code","a4a778f7":"code","aa89d928":"code","63a72259":"code","baf3086c":"code","5e24bf25":"code","e4a1cd77":"code","91f1ce27":"code","00ae06f7":"code","014b5b9d":"code","527008b7":"code","97a2e3fa":"code","d1fa1090":"code","c9fc6ed3":"code","b1c0703d":"code","df248e08":"code","f6c33d94":"markdown","63dbeb73":"markdown","b6d334a8":"markdown","77980142":"markdown","de4c2c7e":"markdown","ab02c5b1":"markdown","7ae9dc81":"markdown","a3264a08":"markdown","fdd87665":"markdown","2d67059b":"markdown","4264bbd4":"markdown","490321be":"markdown","3dfd9488":"markdown","5c57d272":"markdown","1e3d1797":"markdown","21f87c7e":"markdown","88154762":"markdown","2078671b":"markdown","cc3a9abd":"markdown","f22fdcf5":"markdown","1ba4ae92":"markdown"},"source":{"165f0ab3":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\/cleartrip-comtravel-samplecsv\"))\n\n# Any results you write to the current directory are saved as output.","0b9e7af6":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nfrom mpl_toolkits.basemap import Basemap\nfrom matplotlib import pyplot as plt\nfrom scipy import stats\nimport nltk\nfrom nltk.tokenize import sent_tokenize, word_tokenize, PunktSentenceTokenizer\nfrom statistics import mode\nfrom collections import Counter\nimport warnings\nimport re\nfrom sklearn.cluster import KMeans  \n\nwarnings.simplefilter(action = \"ignore\", category = FutureWarning)\n\ndf = pd.read_csv(\"..\/input\/cleartrip-comtravel-samplecsv\/cleartrip_com-travel_sample.csv\")","ecec8049":"df[\"tad_review_count\"] = df[\"tad_review_count\"].fillna(0)\ndf[\"review_value\"] = df[\"tad_review_count\"] * df[\"tad_review_rating\"]\ndf[\"property_type\"] = df[\"property_type\"].fillna(\"uncategorized\")\ndf[\"hotel_description\"] = df[\"hotel_description\"].fillna(\"no description\")\ndf[\"similar_hotel\"] = df[\"similar_hotel\"].fillna(0)\n\ni=0\nproperty_type = df.property_type.unique()\n\nfor t,x in zip(df[\"property_type\"], df[\"hotel_description\"]):\n    if ((t == \"uncategorized\") & (x != \"no description\")): \n        for l in nltk.word_tokenize(x):\n            if l in property_type:\n                try:\n                    df.at[i , \"property_type\"] = l\n                    break\n                except:\n                    print(i)\n                            \n    i=i+1","39c95066":"i=0\nfor x,y in zip(df[\"property_type\"], df[\"similar_hotel\"]):\n    prop_type = []\n    if ((x == \"uncategorized\") & (y != 0)):\n        same_props = y.split(\"|\")\n        for z in same_props:\n            try:\n                cat = df.where(df[\"property_id\"] == int(strip(z)))[\"property_type\"]\n                if (cat != \"uncategorized\"):\n                    prop_type.append(cat)\n            except:\n                pass\n        try:\n            df.at[i , \"property_type\"] = mode(prop_type)\n        except:\n            if len(prop_type) != 0:\n                df.at[i , \"property_type\"] = prop_type[0]\n        \n    i=i+1","12ebedcc":"df[[\"city\", \"hotel_star_rating\"]].where(df[\"hotel_star_rating\"] == \"5 Star hotel\")[\"city\"].value_counts().nlargest(5)","bc5ebe55":"df[[\"state\", \"hotel_star_rating\"]].where(df[\"hotel_star_rating\"] == \"5 Star hotel\")[\"state\"].value_counts().nlargest(5)","e0e725e1":"print(df[\"property_type\"].unique())\ndf[\"property_type\"].value_counts()","4d5aa311":"for i in df[\"property_type\"].dropna().unique():\n    avg = df[[\"property_type\", \"room_count\"]].where(df[\"property_type\"] == i)[\"room_count\"].sum()\/df.where(df[\"property_type\"] == i)[\"room_count\"].count()\n    print(i, \": \", np.round(avg))","a042098a":"big = df[df.room_count == df.room_count.max()]\nfig = plt.figure(figsize=(20, 5))\nm = Basemap(projection='lcc',width=8E6, height=10E6, lat_0 = 20, lon_0 = 79, \n            llcrnrlat = 5, llcrnrlon = 65, urcrnrlat = 40, urcrnrlon=100, resolution = \"l\")\nm.drawcoastlines()\nm.drawcountries()\nm.shadedrelief()\n# Map (long, lat) to (x, y) for plotting\nx, y = m(big['longitude'].values, big['latitude'].values)\nplt.plot(x, y, 'r*', markersize=15)\nplt.text(x, y, big.iloc[0][\"property_name\"], fontsize=12)\n","14635519":"#need to remove outliers first\navg_rooms_df = df[[\"property_type\", \"room_count\"]]\navg_rooms_df[\"z_score\"] = np.abs(stats.zscore(avg_rooms_df[\"room_count\"])) < 3\navg_rooms_df = avg_rooms_df[avg_rooms_df.z_score]\n\nplt.subplots(figsize = (12,6))\nsns.boxplot(x = \"property_type\", y = \"room_count\", data = avg_rooms_df)\nplt.show()\nsns.swarmplot(x = \"property_type\", y = \"room_count\", data = avg_rooms_df, palette = \"Set1\")\nfig = plt.gcf()\nfig.set_size_inches(12,8)\nplt.ylim(-5,avg_rooms_df[\"room_count\"].max() + 15)\nplt.show()","4319e2b2":"outliers = df[[\"property_type\", \"room_count\", \"longitude\", \"latitude\", \"property_name\"]]\noutliers[\"z_score\"] = np.abs(stats.zscore(outliers[\"room_count\"])) > 3\noutliers = outliers[outliers.z_score]\nfig = plt.figure(figsize=(80, 20))\nm = Basemap(projection='lcc',width=8E6, height=10E6, lat_0 = 20, lon_0 = 79, \n            llcrnrlat = 5, llcrnrlon = 65, urcrnrlat = 40, urcrnrlon=100, resolution = \"l\")\nm.drawcoastlines()\nm.drawcountries()\nm.shadedrelief()\n# Map (long, lat) to (x, y) for plotting\nfor a,b,c in zip(outliers['longitude'],  outliers['latitude'], outliers['property_name']):\n    x, y = m(a,b)\n    plt.plot(x, y, 'r*', markersize=15)\n    plt.text(x, y, c, fontsize=12)","a4a778f7":"hotel_desc = df[\"hotel_description\"].str.cat(sep = \" \")\nhotel_desc = hotel_desc.lower()\nlist_of_word = []\ntag = []\ndef process_content():\n    try:\n        words = nltk.word_tokenize(hotel_desc)\n        tagged = nltk.pos_tag(words)\n        for i in tagged:\n            list_of_word.append(i[0])\n            tag.append(i[1])\n            #list_of_word.append(tagged[:,0])\n    except Exception as e:\n        print(str(e))\n\nprocess_content()\n\nall_words = pd.DataFrame(data = {\"words\": list_of_word, \"tag\": tag})\nall_adj = all_words[(all_words.tag == \"JJ\") | (all_words.tag == \"JJR\") | (all_words.tag == \"JJS\")]\nall_adj[\"words\"].value_counts().nlargest(20)","aa89d928":"#all_verbs = all_words[(all_words.tag == \"VB\") | (all_words.tag == \"VBD\") | (all_words.tag == \"VBG\") \n#                      | (all_words.tag == \"VBN\")| (all_words.tag == \"VBP\")| (all_words.tag == \"VBZ\")]\nall_verbs = all_words[(all_words.tag == \"VBG\") | (all_words.tag == \"VBP\")| (all_words.tag == \"VBZ\")]\n\nall_verbs[\"words\"].value_counts().nlargest(10)","63a72259":"prop_name = df[\"property_name\"].str.cat(sep = \" \")\nprop_name = prop_name.lower()\n#custom_sent_tokenizer = PunktSentenceTokenizer()\n#tokenized = custom_sent_tokenizer.tokenize(prop_name)\nlist_of_names = []\ntags = []\n\ndef process_content():\n    try:\n        words = nltk.word_tokenize(prop_name)\n        tagged = nltk.pos_tag(words)\n        for i in tagged:\n            list_of_names.append(i[0])\n            tags.append(i[1])\n    except Exception as e:\n        print(str(e))\n\nprocess_content()\n\nall_hotel_names = pd.DataFrame(data = {\"words\": list_of_names, \"tag\": tags})\nall_proper_nouns = all_hotel_names[(all_hotel_names.tag == \"NNP\") | (all_hotel_names.tag == \"NN\") | (all_hotel_names.tag == \"NNS\")]\nall_proper_nouns[\"words\"].value_counts()[:30]","baf3086c":"df[[\"city\", \"hotel_star_rating\", \"property_name\", \"property_type\", \"tad_review_count\"]].nlargest(10, \"tad_review_count\")","5e24bf25":"df[[\"city\", \"hotel_star_rating\", \"property_name\", \"property_type\", \"review_value\"]].nlargest(10, \"review_value\")","e4a1cd77":"prop_type = df[[\"property_type\", \"room_facilities\"]].where(df[\"property_type\"] == \"uncategorized\")\nfecilities = prop_type[\"room_facilities\"].str.cat(sep = \" | \")\nfecilities = fecilities.lower()\nfecilities = fecilities.split(sep = \"|\")\nfecilities = [x.strip() for x in fecilities]\nmst_com_fes = [i[0] for i in Counter(fecilities).most_common(10)]\nprint(mst_com_fes)","91f1ce27":"for fes in df[\"property_type\"].unique():\n    if (fes != \"uncategorized\"):\n        prop_type = df[[\"property_type\", \"room_facilities\"]].where(df[\"property_type\"] == fes)\n        fecilities = prop_type[\"room_facilities\"].str.cat(sep = \" | \")\n        fecilities = fecilities.lower()\n        fecilities = fecilities.split(sep = \"|\")\n        fecilities = [x.strip() for x in fecilities]\n        print(\"Top 10 most common room fecilities in \", fes, \": \")\n        mst_com_fes = [i[0] for i in Counter(fecilities).most_common(5)]\n        print(mst_com_fes, \"\\n\")\n        ","00ae06f7":"data = df[[\"longitude\", \"latitude\"]].dropna()\nfig = plt.figure(figsize=(60, 15))\nm = Basemap(projection='mill')#,width=8E6, height=10E6, lat_0 = 20, lon_0 = 79, \n            #llcrnrlat = 5, llcrnrlon = 65, urcrnrlat = 40, urcrnrlon=100, resolution = \"l\")\nm.drawcoastlines()\nm.drawcountries()\nm.shadedrelief()\n# Map (long, lat) to (x, y) for plotting\nx, y = m(data['longitude'].values, data['latitude'].values)\nplt.plot(x, y, 'o', markersize=5)\n#plt.text(x, y, 'Delhi', fontsize=12)","014b5b9d":"data = df[[\"longitude\", \"latitude\"]].dropna()\ndata = data.where(~(data.latitude >= 37.6) & ~(data.latitude <= 8.4)).dropna()\ndata = data.where((data[\"longitude\"] <= 97.25) & (data[\"longitude\"] >= 68.7)).dropna()","527008b7":"coordinates= np.array([list((a,float(b))) for a,b in zip(data['longitude'], data['latitude'])])\nx = [t for t in range(1,30)]\ny = []\nfor k in range(1,30):\n    kmeans = KMeans(n_clusters = k, random_state=1).fit(coordinates)\n    labels = kmeans.labels_\n    interia = kmeans.inertia_\n    #print(\"k:\",k, \" cost:\", interia)\n    y.append(interia)\n    \nsns.lineplot(x=x, y=y)","97a2e3fa":"fig = plt.figure(figsize=(60, 15))\nm = Basemap(projection='mill',width=8E6, height=10E6, lat_0 = 20, lon_0 = 79, \n            llcrnrlat = 5, llcrnrlon = 65, urcrnrlat = 40, urcrnrlon=100, resolution = \"l\")\n\nm.drawcoastlines()\nm.drawcountries()\nm.shadedrelief()\n\ncoordinates= np.array([list((a,float(b))) for a,b in zip(data['longitude'], data['latitude'])])\nkmeans = KMeans(n_clusters = 10)\nkmeans.fit(coordinates)\nx, y = m(coordinates[:,0],coordinates[:,1])\nplt.scatter(x,y,c=kmeans.labels_.astype(float))\ncenters = kmeans.cluster_centers_\nx, y = m(centers[:, 0], centers[:, 1])\nplt.scatter(x, y, c='black', s=200, alpha=0.5);\nplt.show()","d1fa1090":"cluster_map = pd.DataFrame()\ncluster_map['data_index'] = data.index.values\ncluster_map['cluster'] = kmeans.labels_\nnew_df = df\nnew_df = new_df.reset_index().rename(columns  = {\"index\": \"data_index\"})#.drop(columns = \"level_0\")\nnew_df= pd.merge(new_df, cluster_map, how = 'inner', on = \"data_index\")\nsns.countplot(x=\"cluster\", hue = \"property_type\", data = new_df)\nprint(new_df[\"cluster\"].value_counts())\nmin_clust = new_df[\"cluster\"].value_counts().reset_index().iloc[-3:][\"index\"]\nfig = plt.figure(figsize=(30, 8))\nm = Basemap(projection='mill',width=8E6, height=10E6, lat_0 = 20, lon_0 = 79, \n            llcrnrlat = 5, llcrnrlon = 65, urcrnrlat = 38, urcrnrlon=100, resolution = \"l\")\n\nm.drawcoastlines()\nm.drawcountries()\nm.shadedrelief()\n\nmin_clus = new_df[new_df.cluster.isin(min_clust)]\n# Map (long, lat) to (x, y) for plotting\nx, y = m(min_clus['longitude'].values, min_clus['latitude'].values)\n#plt.plot(x, y, 'o', markersize=5)\nplt.scatter(x,y,c=min_clus.cluster)\n","c9fc6ed3":"avg_rooms_clus = min_clus[[\"property_type\", \"room_count\", \"hotel_star_rating\", \"cluster\"]]\navg_rooms_clus[\"z_score\"] = np.abs(stats.zscore(avg_rooms_clus[\"room_count\"])) < 3\navg_rooms_clus = avg_rooms_clus[avg_rooms_clus.z_score]\n\nplt.subplots(figsize = (12,6))\nsns.boxplot(x = \"property_type\", y = \"room_count\", data = avg_rooms_clus)\nplt.show()\nsns.swarmplot(x = \"property_type\", y = \"room_count\", hue = \"hotel_star_rating\", data = avg_rooms_clus, palette = \"Set1\")\nfig = plt.gcf()\nfig.set_size_inches(12,8)\nplt.ylim(-5,avg_rooms_clus[\"room_count\"].max() + 15)\nplt.show()","b1c0703d":"avg_rooms_clus.groupby([\"hotel_star_rating\", \"cluster\"]).property_type.count()","df248e08":"fig = plt.figure(figsize=(30, 8))\nm = Basemap(projection='mill',width=8E6, height=10E6, lat_0 = 20, lon_0 = 79, \n            llcrnrlat = 5, llcrnrlon = 65, urcrnrlat = 38, urcrnrlon=100, resolution = \"l\")\n\nm.drawcoastlines()\nm.drawcountries()\nm.shadedrelief()\n\nmin_clus = new_df[new_df.cluster == 4]\n# Map (long, lat) to (x, y) for plotting\nx, y = m(min_clus['longitude'].values, min_clus['latitude'].values)\n#plt.plot(x, y, 'o', markersize=5)\nplt.scatter(x,y,c=min_clus.cluster)\nmin_clus[\"city\"].value_counts()","f6c33d94":"**Average rooms in each type**\n\nAmong all properties types Hotels and resort are more likely to have 25 - 30 rooms in total.","63dbeb73":"Tried to find similar hotels and interesetingly there are no similar properties which are part of this sample","b6d334a8":"**common hotel names**\n\nWe can see some nearly 500 properties are part of OYO group.\nAnd some other common names\/words for hotel nomenclature:\n\nVista, Royal, Jaipur (*dataset has jaipur bais*), STARiHOTELS, etc\n","77980142":"Cities and states with most 5 star Hotels","de4c2c7e":"5 most common room facilities in different  property types","ab02c5b1":"High review-rated hotels","7ae9dc81":"Data Prepration","a3264a08":"**Type of Hotels**\n\nThere are a lot of properties(hotels) which are basically uncategoried. In fact most them are not categorized.","fdd87665":"10 most common room facilities","2d67059b":"Avg room size among these clusters depending upon the type of hotel one wants to open.\n\nWe can also see most hotels are 2-star and 3-star hotels in these clusters.","4264bbd4":"All hotels marked on a map\n\nWe can clearly see some hotels are either not India or might be having some wrong latitute and longitude values. ","490321be":"Hotel clusters","3dfd9488":"Some big hotels from the sample","5c57d272":"**Reviews**\n\nMost reviews","1e3d1797":"*Just for the record*\n\nAn uncategorized property has more than 1200 rooms","21f87c7e":"**Room facilities**","88154762":"After zeroing in on the cluster we may look at major hotel hubs in this cluster\n","2078671b":"clusters with minimun properties and maximum opportunity to open an hotel ","cc3a9abd":"Common Verbs\n\nAn attempt to find services offered. unsuccessful though :(","f22fdcf5":"Lets remove hotels which are not in India location-wise\n\nThe geographical extents, latitude and longitude of India respectively, are as follows-\n8\u00b04\u2032 N to 37\u00b06\u2032 N\n68\u00b07\u2032 E to 97\u00b025\u2032 E","1ba4ae92":"**Hotel Description**\n\n20 most used ajdectives in hotel descriptions"}}