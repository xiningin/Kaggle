{"cell_type":{"58631950":"code","21b8e3d1":"code","d94f51e0":"code","a2611c43":"code","fdf44750":"code","280c58db":"code","1c082159":"code","0bf92ad8":"code","e6e37bcd":"code","45591dd3":"code","3d0f79e0":"code","06875e84":"code","6743e6a9":"code","d34ced77":"code","319854c9":"code","18faeb0c":"code","70557622":"code","eb110126":"code","7e7132fe":"code","34593600":"code","78bce006":"code","ea3b08e7":"code","c799fd96":"code","6aaa5709":"code","78a808f2":"code","8e1b4fec":"markdown","596bfa87":"markdown","ce322542":"markdown","61ea1908":"markdown","754fb5da":"markdown","a949071f":"markdown","1cac9447":"markdown","9534ed28":"markdown"},"source":{"58631950":"import numpy as np\nimport pandas as pd\nimport os\nfrom sklearn import preprocessing\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import roc_curve\nimport matplotlib\nimport matplotlib.pyplot as plt\nfrom IPython.display import display, HTML\nimport seaborn as sns\nfrom sklearn.linear_model import LogisticRegression\n","21b8e3d1":"rawdata=pd.read_csv(\"..\/input\/WA_Fn-UseC_-Telco-Customer-Churn.csv\")","d94f51e0":"data=rawdata.copy()\ndata.shape","a2611c43":"data.head(5)","fdf44750":"data.info()","280c58db":"\ndata['TotalCharges']=data['TotalCharges'].convert_objects(convert_numeric=True)\ndef uni(columnname):\n    print(columnname,\"--\" ,data[columnname].unique())","1c082159":"dataobject=data.select_dtypes(['object'])\nlen(dataobject.columns)","0bf92ad8":"for i in range(1,len(dataobject.columns)):\n    uni(dataobject.columns[i])\n    ","e6e37bcd":"def labelencode(columnname):\n    data[columnname] = LabelEncoder().fit_transform(data[columnname])","45591dd3":"for i in range(1,len(dataobject.columns)):\n    labelencode(dataobject.columns[i])","3d0f79e0":"data.info()","06875e84":"for i in range(1,len(dataobject.columns)):\n     uni(dataobject.columns[i])","6743e6a9":"\ndata.info()","d34ced77":"df=data.copy()\ndfl=data.copy()","319854c9":"unwantedcolumnlist=[\"customerID\",\"gender\",\"MultipleLines\",\"PaymentMethod\",\"tenure\"]","18faeb0c":"df = df.drop(unwantedcolumnlist, axis=1)\nfeatures = df.drop([\"Churn\"], axis=1).columns","70557622":"df_train, df_val = train_test_split(df, test_size=0.30)\n","eb110126":"print(df_train.shape)\nprint(df_val.shape)","7e7132fe":"df_train.isnull().sum()","34593600":"df_val.isnull().sum()","78bce006":"df_train['TotalCharges'].fillna(df_train['TotalCharges'].mean(), inplace=True)\ndf_val['TotalCharges'].fillna(df_val['TotalCharges'].mean(), inplace=True)\n","ea3b08e7":"clf = RandomForestClassifier(n_estimators=30 , oob_score = True, n_jobs = -1,random_state =50, max_features = \"auto\", min_samples_leaf = 50)\nclf.fit(df_train[features], df_train[\"Churn\"])\n\n# Make predictions\npredictions = clf.predict(df_val[features])\nprobs = clf.predict_proba(df_val[features])\ndisplay(predictions)","c799fd96":"score = clf.score(df_val[features], df_val[\"Churn\"])\nprint(\"Accuracy: \", score)","6aaa5709":"data['Churn'].value_counts()","78a808f2":"get_ipython().magic('matplotlib inline')\nconfusion_matrix = pd.DataFrame(\n    confusion_matrix(df_val[\"Churn\"], predictions), \n    columns=[\"Predicted False\", \"Predicted True\"], \n    index=[\"Actual False\", \"Actual True\"]\n)\ndisplay(confusion_matrix)\n\n# Calculate the fpr and tpr for all thresholds of the classification\nfpr, tpr, threshold = roc_curve(df_val[\"Churn\"], probs[:,1])\nplt.title('Receiver Operating Characteristic')\nplt.plot(fpr, tpr, 'b')\nplt.plot([0, 1], [0, 1],'r--')\nplt.xlim([0, 1])\nplt.ylim([0, 1])\nplt.ylabel('True Positive Rate')\nplt.xlabel('False Positive Rate')\nplt.show()","8e1b4fec":"### Import Libraries ###","596bfa87":"### Random Forest Algorithm applied on  Train and validate on Validation ###","ce322542":"### Accuracy ###","61ea1908":"### Convert TotalCharges Column(feature) to Numeric From Object ### ","754fb5da":"### Train and Validation Missing Data Fill by mean(imputation) ###","a949071f":"### Application of Churn Analysis? ###\n\n* To chrun - thought of conversion\n* Telcom Industry has more operator and provide verious of services with different prices so custmoer can convert from one operator to other for service\/economical benifits\n* for operator it is vital to identify churn customer and hence they can convince particular\n* above model predict customer churn","1cac9447":"### Read Dataset ###","9534ed28":"### ROC Curve ###"}}