{"cell_type":{"e9f458f1":"code","ad134d9e":"code","70a6adcb":"code","96042676":"code","3d2884b1":"code","fae872ce":"code","0301af96":"code","b10054bf":"code","8e0865e9":"code","d272cfaf":"code","df80cf52":"code","036418ac":"code","ca0e8b2e":"markdown","76508712":"markdown"},"source":{"e9f458f1":"import numpy as np\nimport pandas as pd\nimport os\n\nfrom fastai.vision import *\nfrom sklearn.model_selection import train_test_split","ad134d9e":"os.listdir('..\/input\/shapes\/')","70a6adcb":"# Get the list of images with the full path to each file\n\nimg_list = []\nfor dirname, _, filenames in os.walk('..\/input'):\n        for filename in filenames:\n            img_list.append(os.path.join(dirname, filename))\nlen(img_list)\nimg_list = img_list[3:] #drop first three python script files","96042676":"# Label fuction definition\n\ndef get_labels(img_list):\n    if '\/circle\/' in str(img_list):\n        label = 'circle'\n    elif '\/triangle\/' in str(img_list):\n        label = 'triangle'\n    elif '\/star\/' in str(img_list):\n        label = 'star'\n    else:\n        label = 'square'\n    return label","3d2884b1":"#Splitting data into train and test datasets\n\ntraining_images, testing_images = train_test_split(img_list, train_size=0.8, test_size=0.2, random_state=0)\ndf_testing_images = pd.DataFrame(testing_images) #test images list in DataFrame to be used for ImageList","fae872ce":"#define the train data to fit a model on\n\ndata = ImageDataBunch.from_name_func('', training_images, label_func=get_labels, ds_tfms=get_transforms(), valid_pct=0.2, size=24)\ntest_data = ImageList.from_df(df_testing_images, '')\ndata.classes","0301af96":"data.show_batch(rows=3, figsize=(6,6))","b10054bf":"#Simple cnn is enough to get you going\n\nmodel = simple_cnn((3,16,16,4))\nlearn = Learner(data, model)\nlearn.metrics=[accuracy]\nlearn.fit_one_cycle(5)","8e0865e9":"#Find out which learning rate is the best one \n\nlearn.lr_find()\nlearn.recorder.plot()","d272cfaf":"#fit once more with chosen lr\n\nlearn.metrics=[accuracy]\nlearn.fit_one_cycle(5, max_lr = 1e-02)","df80cf52":"#and lets make predictions and analyse how well they were done\n\npreds,y,losses = learn.get_preds(test_data, with_loss=True)\ninterp = ClassificationInterpretation(learn, preds, y, losses)\ninterp.plot_confusion_matrix()","036418ac":"interp1 = ClassificationInterpretation.from_learner(learn)\ninterp1.plot_top_losses(9, figsize=(10,10))","ca0e8b2e":"**Kindergarten level ML**\n\nI just recently stumbled across [fast.ai](http:\/\/) webpage and not long after I realised how their motto makes a lot of sense - \"Making neural nets uncool again\".\n\nBeing able to learn how to write code shown below doesn't make you special. It just proves that anyone can do it. Of course we're talking of the level mentioned in the header of this notebook. Eventhough I, like many of the beginners, tried playing with cats and dogs categorising and ASL dataset, I was particularly  happy to find Four Shapes data sets.\n\n![image.png](attachment:image.png)\n\nSorting shapes is exactly what kids do, don't they?","76508712":"That's it to it."}}