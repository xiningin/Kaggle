{"cell_type":{"71d280f8":"code","30cddcec":"code","6da916a1":"code","11b74f76":"code","322df6d0":"code","445e358e":"code","e8d45ccb":"code","e55c3506":"code","88c44f1f":"code","6c8611cc":"code","443c598d":"code","f813bf99":"code","dea2e700":"markdown","c1aee449":"markdown","057fb9e2":"markdown","141b93e7":"markdown","02228c9e":"markdown"},"source":{"71d280f8":"#Importing Library\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns # library for plotting\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error","30cddcec":"#Let's read the data\nfull_data = pd.read_csv('..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv')\n#View the data how it looks\nfull_data.head(5) #Display first 5 rows of the data","6da916a1":"#Here isnull() checks for all the fields which have missing data and sum() counts the occurance of the same\nfull_data.isnull().sum()","11b74f76":"#Correlation of quality with other features\nfull_data.corr()['quality'].sort_values()","322df6d0":"#Let's try to understand how many different wine quality we have and what's the distribution amount different wine quality\nsns.displot(full_data.quality)","445e358e":"#Now lets do some plotting to see relation between features\nsns.pairplot(full_data,corner=True).map(sns.lineplot)","e8d45ccb":"plt.figure(figsize=(14,10))\nsns.heatmap(full_data.corr())","e55c3506":"#Dividing wine as good and bad\nbins = (2,6,8)\nquality_names = ['bad', 'good']\nfull_data['quality'] = pd.cut(full_data['quality'], bins = bins, labels = quality_names)\n\n#Now lets assign a labels to our quality variable\nquality_l = LabelEncoder()\nfull_data['quality'] = quality_l.fit_transform(full_data['quality'])\n\n#Let's check the data in column 'quality'\nfull_data.quality.value_counts()","88c44f1f":"# Splitting quality information from other feature and storing it in y remaining one's goes into X\nX, y = full_data.drop('quality', axis = 1) , full_data.quality\n\ndata_train,data_test,result_train,result_test = train_test_split(X, y, test_size = 0.35, random_state = 1)","6c8611cc":"#Let's check how the splitted data looks\n#Checking for train set\ndata_train.head()","443c598d":"#similary check ing for results for corresponding test set\nresult_train.head()","f813bf99":"#Defining model\nmodel = RandomForestRegressor(n_estimators=200,random_state=1)\n\n#fitting the model with training data\nmodel.fit(data_train,result_train)\n\n#Predicting the value\npredict_test = model.predict(data_test)\n\n#Let's check how good is the model\nprint(\"Mean squared error is : \",mean_squared_error(result_test,predict_test))\nprint(\"Score of the Model is : \",model.score(data_test,result_test))","dea2e700":"## Let's Build a Random Forest Model","c1aee449":"Since we don't have any missing data in our dataset let's check for correlation","057fb9e2":"## Splitting test and training data","141b93e7":"# Let's check for missing data","02228c9e":"# Changing the feature Quality of wine"}}