{"cell_type":{"9d75a774":"code","f2f16dbe":"code","59dc64ce":"code","e717f56f":"code","b16588b7":"code","7f9e1b5d":"code","f9e3e361":"code","feb12258":"code","cc82e068":"code","86636895":"code","789ecb8b":"code","a60f96b5":"code","eb318ec2":"code","66f5abf6":"code","48944832":"code","b40aaaf1":"code","c2a30d6c":"code","c86d37de":"code","35975ada":"code","f3279f4d":"code","fceb91e1":"code","11b108c2":"markdown","ace7659e":"markdown"},"source":{"9d75a774":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","f2f16dbe":"import matplotlib.pyplot as plt\nfrom tensorflow import keras","59dc64ce":"X_train = pd.read_csv('..\/input\/digit-recognizer\/train.csv')\nX_test = pd.read_csv('..\/input\/digit-recognizer\/test.csv')\nprint(X_train.head())","e717f56f":"y_train = X_train.pop('label')\nprint(type(y_train))","b16588b7":"X_train = (X_train\/255).to_numpy()\nX_test = (X_test\/255).to_numpy()\ny_train = y_train.to_numpy()","7f9e1b5d":"print(type(X_train))\nprint(X_test.shape)","f9e3e361":"X_train = X_train.reshape(42000,28,28)","feb12258":"X_test = X_test.reshape(28000,28,28)","cc82e068":"print(X_train.shape)","86636895":"print(X_train[0].shape)\nX_trainExample = X_train[0].reshape(28,28)\nprint(X_trainExample.shape)","789ecb8b":"plt.figure()\nplt.imshow(X_trainExample,cmap=plt.cm.binary)\nplt.show()","a60f96b5":"X_train = keras.utils.normalize(X_train, axis=1)\nX_test = keras.utils.normalize(X_test, axis=1)\nprint(X_train)","eb318ec2":"print(y_train)","66f5abf6":"import tensorflow as tf","48944832":"X_train = np.expand_dims(X_train, -1)\nX_test = np.expand_dims(X_test, -1)","b40aaaf1":"input_shape = (28,28,1)","c2a30d6c":"model = keras.models.Sequential()\nmodel.add(keras.layers.Conv2D(32, kernel_size=(3,3), input_shape=input_shape, activation=tf.nn.relu))\nmodel.add(keras.layers.MaxPooling2D(pool_size=(2,2)))\nmodel.add(keras.layers.Conv2D(64, kernel_size=(3,3), activation=tf.nn.relu))\nmodel.add(keras.layers.MaxPooling2D(pool_size=(2,2)))\nmodel.add(keras.layers.Flatten())\nmodel.add(keras.layers.Dense(10, activation=tf.nn.softmax))\nmodel.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])","c86d37de":"early_stopping = keras.callbacks.EarlyStopping()\nmodel.fit(X_train, y_train, epochs=5, callbacks=[early_stopping])\npred = model.predict(X_test)","35975ada":"print(np.argmax(pred[4]))\nX_test0 = X_test[4].reshape(28,28)\nplt.imshow(X_test0)\nplt.show()\nprint(pred.shape)","f3279f4d":"print(np.argmax(pred, axis=1))","fceb91e1":"subm = pd.DataFrame({'ImageId': np.arange(1, 28001), 'Label':np.argmax(pred, axis=1)})\nsubm.to_csv('submission.csv',index=False)\nprint(subm)","11b108c2":"**Normalizing**","ace7659e":"Extend dims of numpy arrays, so they can be used in model"}}