{"cell_type":{"afaa3d8a":"code","8f962236":"code","389fbccb":"code","dcf0cfb4":"code","b14fd395":"code","6da7c324":"code","555c758a":"code","2ee4b844":"code","3f8b8c16":"code","106cd7d1":"code","c6136be8":"code","7f934ca4":"code","fe32aeb6":"code","bae022d6":"code","1df817b2":"code","1bab3df8":"code","ba286417":"code","a4f4bd35":"code","b32bcecd":"code","235a6461":"code","aa0663fd":"markdown","6c1e0e4b":"markdown"},"source":{"afaa3d8a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","8f962236":"import numpy as ny\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","389fbccb":"dataf = pd.read_csv('..\/input\/medical-insurance-premium-prediction\/Medicalpremium.csv')","dcf0cfb4":"dataf.head()","b14fd395":"dataf.isnull().sum()","6da7c324":"dataf.describe()","555c758a":"dataf.info()","2ee4b844":"plt.figure(figsize=(12,10))\nsns.heatmap(dataf.corr(),annot=True,cmap='coolwarm',linewidths=.1)","3f8b8c16":"x=dataf.drop('PremiumPrice',axis=1)\ny=dataf['PremiumPrice']","106cd7d1":"from sklearn.feature_selection import SelectKBest\nfrom sklearn.feature_selection import chi2\nbestfeatures = SelectKBest(score_func=chi2,k=10)\nfit= bestfeatures.fit(x,y)\ndfscores = pd.DataFrame(fit.scores_)\ndfcolumns = pd.DataFrame(x.columns)\nfeatureScores = pd.concat([dfcolumns,dfscores],axis=1)\nfeatureScores.columns = ['Specs','Score']\nfeatureScores","c6136be8":"from sklearn.ensemble import ExtraTreesClassifier\nmodel = ExtraTreesClassifier()\nmodel.fit(x,y)\nprint(model.feature_importances_)","7f934ca4":"feat_imp =pd.Series(model.feature_importances_,index=x.columns)\nfeat_imp.nlargest(10).plot(kind='barh')\nplt.show()","fe32aeb6":"X = x.drop(['Diabetes','KnownAllergies','BloodPressureProblems'],axis=1)\nx.head()","bae022d6":"from sklearn.model_selection import train_test_split\nfrom sklearn import preprocessing\nscaler = preprocessing.StandardScaler()\nX_train, X_test, Y_train, Y_test = train_test_split(X,y,test_size=0.3,random_state=43)\nscaler.fit(X_train)\nX_train = scaler.transform(X_train)\nX_test = scaler.transform(X_test)","1df817b2":"from sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score","1bab3df8":"d_tree = DecisionTreeClassifier()\nd_tree.fit(X_train,Y_train)\ny_pred_tree= d_tree.predict(X_test)\ny_prob_tree =d_tree.predict_proba(X_test)\nacc=accuracy_score(Y_test,y_pred_tree)\nacc","ba286417":"rf = RandomForestClassifier()\nrf.fit(X_train,Y_train)\ny_pred_rf= rf.predict(X_test)\ny_prob_rf =rf.predict_proba(X_test)\nacc=accuracy_score(Y_test,y_pred_rf)\nacc","a4f4bd35":"from sklearn.metrics import confusion_matrix","b32bcecd":"cm_tree = confusion_matrix(Y_test,y_pred_tree)\nplt.figure(figsize=(10,7))\nsns.heatmap(cm_tree,annot=True)\nplt.xlabel(\"predicted\")\nplt.ylabel(\"truth\")","235a6461":"cm_rf = confusion_matrix(Y_test,y_pred_rf)\nplt.figure(figsize=(10,7))\nsns.heatmap(cm_rf,annot=True)\nplt.xlabel(\"predicted\")\nplt.ylabel(\"truth\")","aa0663fd":"Age, weight, Number of major surgeries, any chornic disases, any transplants, cancer is choosen to move forward for the model\n","6c1e0e4b":"Age, anytransplants, anychronicdiseases, no og major surgeries are important featues"}}