{"cell_type":{"d3066306":"code","5b54275e":"code","6f374308":"code","69dba5b6":"code","b0e02045":"code","5bf16c34":"code","bdde7fc4":"code","1cb65626":"code","ae5cc6a2":"code","2740e998":"markdown","4e0e2455":"markdown","60534642":"markdown","a1a1ac1d":"markdown","10b6a8e0":"markdown"},"source":{"d3066306":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n","5b54275e":"# Let's define a function to calculate the metric\n\ndef eval_metric(FVC,FVC_Pred,sigma):\n    n = len(sigma)\n    a=np.empty(n)\n    a.fill(70)\n    sigma_clipped = np.maximum(sigma,a) \n    delta = np.minimum(np.abs(FVC,FVC_Pred),1000)\n    eval_metric = -np.sqrt(2)*delta\/sigma_clipped - np.log(np.sqrt(2)*sigma_clipped)\n    return eval_metric","6f374308":"rand_forest_df = pd.read_csv(\"\/kaggle\/input\/random-forest-submission\/submission.csv\")","69dba5b6":"rand_forest_df.head()","b0e02045":"nn_df = pd.read_csv(\"\/kaggle\/input\/neural-network-model-submission-score\/submission.csv\")","5bf16c34":"nn_df.head()","bdde7fc4":"FVC = rand_forest_df['FVC'].to_numpy()\nFVC_Pred = nn_df['FVC'].to_numpy()\nConfidence = nn_df['Confidence'].to_numpy()","1cb65626":"eval_metric(FVC,FVC_Pred,Confidence)","ae5cc6a2":"np.mean(eval_metric(FVC,FVC_Pred,Confidence))","2740e998":"# Remember they will average at the end for the final submission score ","4e0e2455":"# I downloaded my 2 submissions for testing purposes. Assume one of them is real solution and the other is your prediction and then evaluate!","60534642":"# See below the metric defined for competition","a1a1ac1d":"![![image.png](attachment:image.png)]","10b6a8e0":"# We will define a function to calculate Laplace Log Likelihood function"}}