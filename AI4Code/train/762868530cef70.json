{"cell_type":{"338fd697":"code","a5b13920":"code","5bf985ec":"code","039b6e62":"code","b3b7edf6":"code","b2bfb099":"code","2839257e":"code","5c856e49":"code","600c2cdb":"code","52d5eba1":"code","ccb48b5d":"code","642be3a5":"code","7ce5b07b":"code","d65f423d":"code","9f62a560":"code","58dbc92d":"code","8a95fd71":"code","3da867f6":"code","460cba76":"code","ea1beae9":"code","171ce6dd":"code","76461972":"code","a6e0336a":"code","25c313cd":"code","60b17a32":"code","1cc912bd":"code","e9b7d3ca":"code","ead73e01":"code","f5169623":"code","dd9b5d65":"code","b05cf827":"code","9b1e9907":"code","cd45d52b":"code","b249d140":"code","8480c19a":"markdown","a5a301e0":"markdown","175c8df6":"markdown","cc12a330":"markdown","7ea3336c":"markdown","6bce347d":"markdown","18e94aff":"markdown","7ced1092":"markdown"},"source":{"338fd697":"import os\nimport numpy as np\nimport pandas as pd\npd.set_option('display.max_rows', 500)\npd.set_option('display.max_columns', None)\n\nimport matplotlib.style as style\nstyle.use('fivethirtyeight')\nimport matplotlib.pyplot as plt\n%matplotlib inline\nplt.rcParams['figure.dpi'] = 150 #set figure size\n\nfrom plotly.offline import iplot, init_notebook_mode\nimport plotly.express as px\n#import plotly.plotly as py\nimport plotly.graph_objs as go\nimport cufflinks\ncufflinks.go_offline(connected=True)\ninit_notebook_mode(connected=True)\n\nimport folium","a5b13920":"os.listdir(\"..\/input\")","5bf985ec":"os.listdir(\"..\/input\/covid19-us-county-jhu-data-demographics\")","039b6e62":"os.listdir(\"..\/input\/countries-of-the-world-iso-codes-and-population\")","b3b7edf6":"os.listdir(\"..\/input\/usa-states\")","b2bfb099":"os.listdir(\"..\/input\/novel-corona-virus-2019-dataset\")\n","2839257e":"df = pd.read_csv(\"..\/input\/novel-corona-virus-2019-dataset\/covid_19_data.csv\", parse_dates=['Last Update'])\ndf.rename(columns={'Country\/Region':'Country'}, inplace=True)\ndf = df.drop(columns = ['SNo', \"Last Update\"]) #only confuses\n\ndf_conf = pd.read_csv(\"..\/input\/novel-corona-virus-2019-dataset\/time_series_covid_19_confirmed.csv\")\ndf_conf.rename(columns={'Country\/Region':'Country'}, inplace=True)\n\ndf_death = pd.read_csv(\"..\/input\/novel-corona-virus-2019-dataset\/time_series_covid_19_deaths.csv\")\ndf_death.rename(columns={'Country\/Region':'Country'}, inplace=True)\n\ncountries = pd.read_csv(\"..\/input\/countries-of-the-world-iso-codes-and-population\/countries_by_population_2019.csv\")\ncountries_iso = pd.read_csv(\"..\/input\/countries-of-the-world-iso-codes-and-population\/country_codes_2020.csv\")\n\nus_covid = pd.read_csv('..\/input\/covid19-us-county-jhu-data-demographics\/covid_us_county.csv')\nus_county = pd.read_csv('..\/input\/covid19-us-county-jhu-data-demographics\/us_county.csv')","5c856e49":"df.head()","600c2cdb":"df['Country'] = df['Country'].str.strip()\n\ndf.loc[df['Province\/State'].isnull(), 'Province\/State'] = df.loc[df['Province\/State'].isnull(), 'Country']\n\n#keep most recent line per Province\/State and Country\ndf.sort_values(['Country', 'Province\/State', 'ObservationDate'], ascending = [True,True,False], inplace = True)\ndf = df.drop_duplicates(['Country', 'Province\/State'], keep = \"first\")\n\ndf_state = df.copy()\n\ndf = df.drop(columns = \"ObservationDate\")\n\n#groupby Country\ndf_country = df.groupby(['Country'], as_index=False)['Confirmed', 'Deaths'].sum()\ndf_country.head()","52d5eba1":"countries.head()","ccb48b5d":"countries_iso.head()","642be3a5":"cols_to_drop = ['Rank', 'pop2018','GrowthRate', 'area', 'Density']\ncountries = countries.drop(columns = cols_to_drop)\n\n# merge countries_iso on countries\ncountries = countries.merge(countries_iso[['name', 'cca3']], on = ['name'], how = \"left\")\n\ncols_to_rename = {'name': 'Country', 'pop2019': 'Population', 'cca3': 'ISO'}\ncountries = countries.rename(columns = cols_to_rename)\ncountries.head()","7ce5b07b":"countries_to_rename = {'US': 'United States',\n                       'Mainland China': 'China',\n                       'UK': 'United Kingdom',\n                       'Congo (Kinshasa)': 'DR Congo',\n                       'North Macedonia': 'Macedonia',\n                       'Republic of Ireland': 'Ireland',\n                       'Congo (Brazzaville)': 'Republic of the Congo'}\n\n# merge countries on df_country\ndf_country['Country'] = df_country['Country'].replace(countries_to_rename)\n\ndf_country = df_country.merge(countries, on = \"Country\", how = \"left\")\n\n\n#dropping not matching countries, only small islands left\ndf_country = df_country.dropna()\n\n#rounding population to millions\ndf_country['Population'] = round((df_country['Population']\/1000),2)\ndf_country = df_country.rename(columns = {'Population': 'Population (million)'})\ndf_country['Cases per Million'] = round((df_country['Confirmed']\/df_country['Population (million)']),2)\ndf_country['Deaths per Million'] = round((df_country['Deaths']\/df_country['Population (million)']),2)\n\ndf_country = df_country[(df_country['Population (million)'] > 1)]\n\ndf_country.head()","d65f423d":"df_country = df_country.sort_values(['Cases per Million'], ascending=False).reset_index(drop=True)\n# give subset or else colors all relative cols\ndf_country.drop(columns = ['ISO', 'Deaths', 'Deaths per Million']).head(10).style.background_gradient(cmap='Reds', subset = ['Cases per Million'])","9f62a560":"fig = px.choropleth(df_country, \n                    locations = \"ISO\",\n                    color = \"Cases per Million\",\n                    hover_name = \"Country\",\n                    color_continuous_scale = px.colors.sequential.YlOrRd)\n\nlayout = go.Layout(\n    title = go.layout.Title(\n        text = \"Corona confirmed cases per million inhabitants\",\n        x=0.5),\n    font = dict(size=14),\n    width = 750,\n    height = 350,\n    margin=dict(l=0,r=0,b=0,t=30)\n)\n\nfig.update_layout(layout)\nfig.show()","58dbc92d":"df_country = df_country.sort_values(['Deaths per Million'], ascending = False).reset_index(drop=True)\n\ncountries = df_country.copy()\n\ndf_country.drop(columns = ['ISO', 'Confirmed', 'Cases per Million']).head(10).style.background_gradient(cmap='Reds', subset = ['Deaths per Million'])","8a95fd71":"fig = px.choropleth(df_country, \n                    locations = \"ISO\",\n                    color = \"Deaths per Million\",\n                    hover_name = \"Country\",\n                    color_continuous_scale = px.colors.sequential.YlOrRd)\n\nlayout = go.Layout(\n    title = go.layout.Title(\n        text = \"Corona deaths per million inhabitants\",\n        x=0.5),\n    font = dict(size=14),\n    width = 750,\n    height = 350,\n    margin=dict(l=0,r=0,b=0,t=30)\n)\n\nfig.update_layout(layout)\nfig.show()","3da867f6":"df_conf.head()","460cba76":"#only keep last date available\ncols_to_keep = list(df_conf.columns[0:4]) + list(df_conf.columns[-1:])\ndf_conf_last = df_conf[cols_to_keep]\ncols_to_rename = {'5\/1\/20' : 'Confirmed Cases'}\ndf_conf_last = df_conf_last.rename(columns = cols_to_rename)\ndf_conf_last['Confirmed Cases'] = df_conf_last['Confirmed Cases'].astype(float)\n\ndf_conf_last.head()","ea1beae9":"map1 = folium.Map(location = [30.6, 114], zoom_start=3) # US=[39,-98] Europe =[45, 5]\n\n# Now to add circles in our map\nfor i in range(0,len(df_conf_last)):\n   folium.Circle(\n      location = [df_conf_last.iloc[i]['Lat'], df_conf_last.iloc[i]['Long']],\n      tooltip = \"Country: \"+ df_conf_last.iloc[i]['Country']+\n       \"<br>Province\/State: \"+ str(df_conf_last.iloc[i]['Province\/State'])+\n       \"<br>Confirmed cases: \"+ str(df_conf_last.iloc[i]['Confirmed Cases'].astype(int)),\n      radius = df_conf_last.iloc[i]['Confirmed Cases'] * 5,\n      color = 'crimson',\n      fill = True,\n      fill_color = 'crimson'\n   ).add_to(map1)\n    \nmap1","171ce6dd":"df_death.head()","76461972":"cols_to_keep = list(df_death.columns[0:4]) + list(df_death.columns[-1:])\ndf_death_last = df_death[cols_to_keep]\ndf_death_last.columns.values[-1] = \"Deaths\"\ndf_death_last[\"Deaths\"] = df_death_last[\"Deaths\"].astype(float)\n\ndf_death_last.head()","a6e0336a":"map2 = folium.Map(location = [30.6, 114], zoom_start=3)\n\nfor i in range(0,len(df_death_last)):\n   folium.Circle(\n      location = [df_death_last.iloc[i]['Lat'], df_death_last.iloc[i]['Long']],\n      tooltip = \"Country: \"+ df_death_last.iloc[i]['Country']+\n       \"<br>Province\/State: \"+ str(df_death_last.iloc[i]['Province\/State'])+\n       \"<br>Confirmed cases: \"+ str(df_death_last.iloc[i]['Deaths'].astype(int)),\n      radius = df_death_last.iloc[i]['Deaths'] * 50,\n      color = 'crimson',\n      fill = True,\n      fill_color = 'crimson'\n   ).add_to(map2)\n    \nmap2","25c313cd":"df_conf.head()","60b17a32":"ts_country = df_conf.drop(columns = ['Lat', 'Long', 'Province\/State'])\nts_country = ts_country.groupby(['Country']).sum()\n# sort by most confirmed cases(last col has total conf. cases so sorting by last col)\nts_country = ts_country.sort_values(by = ts_country.columns[-1], ascending = False).head(10)\nts_country","1cc912bd":"ts_country.transpose().iplot(title = 'Time series of confirmed cases of countries with most confirmed cases')","e9b7d3ca":"df_death.head()","ead73e01":"ts_country = df_death.drop(columns = ['Lat', 'Long', 'Province\/State'])\nts_country = ts_country.groupby(['Country']).sum()\n\nts_country = ts_country.sort_values(by = ts_country.columns[-1], ascending = False).head(10)\nts_country","f5169623":"ts_country.transpose().iplot(title = 'Time series of deaths of countries with most victims')","dd9b5d65":"ts_country = ts_country.transpose()\nts_country.head()","b05cf827":"df1 = ts_country.iloc[:,0].to_frame()\ndf1.head()","9b1e9907":"# df1 = df1[df1.iloc[:, 0] !=0].reset_index(drop=True)\ndf1 = df1.loc[df1['US'] != 0, :].reset_index(drop=True)\ndf1.head()","cd45d52b":"for i in range(1, ts_country.shape[1]):\n    df = ts_country.iloc[:, i].to_frame()\n    df = df[df.iloc[:,0] != 0].reset_index(drop=True)\n    df1 = pd.concat([df1, df], join = 'outer', axis=1)\n    \ndf1.head()","b249d140":"df1.iplot(title = 'Time series of deaths since first victim', xTitle = 'Days since first reported Death', yTitle = 'Number of Deaths')","8480c19a":"Time series plot of the countries with most Deaths","a5a301e0":"Bubble chart showing Confirmed Cases by Province\/state","175c8df6":"Time series plot of Deaths since day of first victim","cc12a330":"Deaths per million","7ea3336c":"Time series plot of the countries with most Confirmed cases","6bce347d":"First create a dataframe with 1st col with non zero vals then we add more cols to this df","18e94aff":"Bubble chart showing Deaths by Province\/state","7ced1092":"Cases per million"}}