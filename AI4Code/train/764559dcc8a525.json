{"cell_type":{"51f63be3":"code","edf90a24":"code","c9fd3a57":"code","03331ea4":"code","c84683f0":"code","06ffbc39":"code","1cc569b7":"code","b35a5ab4":"code","cdc51819":"code","ee7c5836":"code","21903989":"code","162c41c6":"code","7f7be8eb":"code","01329a08":"code","b7873b17":"code","cfabe9e3":"code","71d32f2a":"code","cc840414":"code","99a985a7":"code","b616b5de":"code","8068d056":"code","10b81624":"code","ba6fb22a":"code","7e8ff486":"code","77673e7a":"code","64af0b48":"code","7d36c99d":"code","185040c5":"markdown","c6119a43":"markdown","14f4a380":"markdown","dedac8ea":"markdown","f4eb7cd0":"markdown"},"source":{"51f63be3":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(color_codes=True)\nimport tensorflow as tf\nfrom tensorflow import keras\nimport warnings\nwarnings.filterwarnings(\"ignore\")","edf90a24":"df_mnist=pd.read_csv(\"..\/input\/digit-recognizer\/train.csv\")","c9fd3a57":"df_mnist.head()","03331ea4":"x=df_mnist.iloc[:,1:]\ny=df_mnist.iloc[:,:1]","c84683f0":"x=x\/255.0","06ffbc39":"from sklearn.model_selection import train_test_split","1cc569b7":"train_x_full, test_x, train_y_full, test_y=train_test_split(x,y,test_size=0.25,random_state=42)\ntrain_x, valid_x, train_y, valid_y= train_test_split(train_x_full, train_y_full ,test_size=0.25, random_state=42)","b35a5ab4":"fig=plt.gcf()\nfig.set_size_inches(8,5)\nplt.imshow(train_x.iloc[0,:].values.reshape(28,28))\nplt.grid(False)\nplt.show()","cdc51819":"fig=plt.gcf()\nfig.set_size_inches(8,5)\nplt.imshow(train_x.iloc[0,:].values.reshape(28,28),cmap=\"gray\")\nplt.grid(False)\nplt.show()","ee7c5836":"train_x.shape[1:]","21903989":"from kerastuner.tuners import Hyperband","162c41c6":"def build_model(hp):\n    model=keras.models.Sequential()\n    for i in range(hp.Int(\"n_layers\",1,20)):\n        model.add(keras.layers.Dense(units=hp.Int(f\"{i}_units\",min_value=32,max_value=512,step=32),\n                                     input_shape=train_x.shape[1:],\n                                     activation=\"relu\",kernel_initializer=\"glorot_uniform\"))\n    model.add(keras.layers.Dense(10,activation=\"softmax\"))\n    model.compile(optimizer=keras.optimizers.Adam(learning_rate=hp.Choice(\"learnnig_rate\",[1e-3,1e-4,1e-5])),\n                    loss=\"sparse_categorical_crossentropy\",\n                    metrics=[\"accuracy\"])\n    return model","7f7be8eb":"hyperband_tuner= Hyperband(\n    build_model,\n    objective=\"val_accuracy\",\n    max_epochs=10,\n    factor=3,\n    tune_new_entries=True,\n    directory=\"Project\",\n    project_name=\"Digit_Recognizer\"\n)","01329a08":"hyperband_tuner.search_space_summary()","b7873b17":"hyperband_tuner.search(train_x,train_y,epochs=10,validation_data=(valid_x,valid_y))","cfabe9e3":"hyperband_tuner.results_summary()","71d32f2a":"hps=hyperband_tuner.get_best_hyperparameters(num_trials=1)[0]\nbest_model=hyperband_tuner.get_best_models(num_models=1)[0]","cc840414":"# evaluation on training data made by us\nbest_model.evaluate(train_x,train_y)","99a985a7":"new_model=hyperband_tuner.hypermodel.build(hps)","b616b5de":"new_model.summary()","8068d056":"model_history=new_model.fit(train_x,train_y,epochs=10,batch_size=32,validation_data=(valid_x,valid_y))","10b81624":"# evaluation on testing data made by us\naccuracy_test=new_model.evaluate(test_x,test_y)","ba6fb22a":"print(\"Accuracy on test set=\",round(accuracy_test[1],4))","7e8ff486":"pred_y=new_model.predict(test_x).argmax(axis=1)\npred_y","77673e7a":"fig=plt.gcf()\nfig.set_size_inches(8,5)\nplt.imshow(test_x.iloc[0,:].values.reshape(28,28))\nplt.grid(False)\nplt.show()","64af0b48":"fig=plt.gcf()\nfig.set_size_inches(8,5)\nplt.imshow(test_x.iloc[1,:].values.reshape(28,28),cmap=\"gray\")\nplt.grid(False)\nplt.show()","7d36c99d":"fig=plt.gcf()\nfig.set_size_inches((15,6))\nplt.plot(pd.DataFrame(model_history.history))\nplt.legend(labels=[\"loss\",\"accuracy\",\"val_loss\",\"val_accuracy\"])\nplt.grid(True)\nplt.show()","185040c5":"# 3. Visualising the Loss and Accuracy","c6119a43":"## Hyper-Parameter Tuning","14f4a380":"## Model Building","dedac8ea":"# 1. Data Preprocessing","f4eb7cd0":"# 2. Data Modelling"}}