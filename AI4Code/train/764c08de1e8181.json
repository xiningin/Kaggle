{"cell_type":{"5964d519":"code","928ff55c":"code","a8b18758":"code","64ef1f3e":"code","56de6975":"code","fdc3cdf6":"code","69557dcb":"code","db2029c0":"code","21761670":"code","2ea9760f":"code","f14c4d5f":"code","0d268d11":"code","80a2d447":"code","bcd90d09":"code","3c829fd8":"code","63b30243":"code","0d76f045":"code","e59d4e4d":"code","34a61bbd":"code","d81a4427":"code","8a5ead8f":"code","b801e1a4":"code","eebd6e4d":"code","be837557":"code","8571e39e":"code","bcb47ee2":"code","d38e0a5f":"code","4fe41d9a":"code","e6308c4d":"code","5abde532":"code","a52b30e1":"code","a76d9b18":"code","5e1e23bd":"code","966ccce7":"code","a8992ca0":"code","bdc205c7":"code","e1325c1e":"code","4527b449":"code","925fa46e":"code","c1c2d700":"code","10af59d5":"markdown","1281e00b":"markdown","b23033d4":"markdown","c0c95909":"markdown","60a7ffcd":"markdown","aac21546":"markdown","bb11cff2":"markdown","8d93c4d0":"markdown","2a6a558e":"markdown","0473e6b2":"markdown","fd4bc4a7":"markdown","fe737427":"markdown","6d0ba723":"markdown","adad67bb":"markdown","f7d6c6de":"markdown","d5622dd4":"markdown","b3d2f784":"markdown","26e61af0":"markdown","2e48487f":"markdown","c682e245":"markdown","2bb2968c":"markdown","ecda28dc":"markdown","5baf6d81":"markdown","1c198d84":"markdown","ed2c711f":"markdown","4dbabca9":"markdown","a1946ed8":"markdown","7b86468b":"markdown","79632091":"markdown","c96894b5":"markdown","62b26ccf":"markdown","f4a63bb1":"markdown","88baa701":"markdown","e0871c8f":"markdown","0a3e013a":"markdown","91611bfc":"markdown","c9dd57fa":"markdown","800fa427":"markdown"},"source":{"5964d519":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","928ff55c":"df = pd.read_csv(\"\/kaggle\/input\/insurance\/insurance.csv\")\ndf.head()","a8b18758":"df.isnull().sum()","64ef1f3e":"df.shape","56de6975":"df.describe()","fdc3cdf6":"df.groupby('region')['charges'].agg(['min', 'max', 'mean'])","69557dcb":"plt.figure(figsize=(10, 6))\nsns.boxplot(x=\"region\", y=\"charges\", data=df)\nplt.title(\"Box plot of the Regions\")\nplt.show()","db2029c0":"df.groupby('sex')['charges'].agg(['min', 'max', 'mean', 'std'])","21761670":"plt.figure(figsize=(10, 6))\nsns.boxplot(x=\"sex\", y=\"charges\", data=df)\nplt.title(\"Box plot of the Genders\")\nplt.show()","2ea9760f":"df.groupby(['region', 'sex'])['charges'].agg(['min', 'max', 'mean', 'std', 'count'])","f14c4d5f":"plt.figure(figsize=(10, 6))\nsns.boxplot(x=\"region\", y=\"charges\", hue=\"sex\", data=df)\nplt.title(\"Box plot of the Regions with each gender\")\nplt.show()","0d268d11":"df.groupby('smoker')['charges'].agg(['min', 'max', 'mean', 'std', 'count'])","80a2d447":"plt.figure(figsize=(10, 6))\nsns.countplot(x=\"smoker\", data=df)\nplt.title(\"Smoker Numbers\")\nplt.show()","bcd90d09":"plt.figure(figsize=(10, 6))\nsns.boxplot(x=\"smoker\", y=\"charges\", data=df)\nplt.title(\"Box plot of the Smokers\")\nplt.show()","3c829fd8":"df.groupby(['region', 'smoker'])['charges'].agg(['min', 'max', 'mean', 'std', 'count'])","63b30243":"plt.figure(figsize=(10, 6))\nsns.boxplot(x=\"region\", y=\"charges\", hue=\"smoker\", data=df)\nplt.title(\"Box plot of the Regions\")\nplt.show()","0d76f045":"df['children'].describe()","e59d4e4d":"df['children'].value_counts()","34a61bbd":"plt.figure(figsize=(10, 6))\nsns.distplot(df['children'])\nplt.title(\"Distribution of Children\")\nplt.show()","d81a4427":"df.groupby('children')['charges'].agg(['min', 'max', 'mean', 'std', 'count'])","8a5ead8f":"plt.figure(figsize=(10, 6))\nsns.boxplot(x=\"children\", y=\"charges\", data=df)\nplt.title(\"Box plot of the Regions\")\nplt.show()","b801e1a4":"plt.figure(figsize=(10, 6))\nsns.distplot(df['age'])\nplt.title(\"Distribution of Age\")\nplt.show()","eebd6e4d":"df.age.describe()","be837557":"plt.figure(figsize=(10, 6))\nsns.scatterplot(x=\"age\", y=\"charges\", data=df)\nplt.title(\"Box plot of the Genders based on Age\")\nplt.show()","8571e39e":"df.groupby(['sex'])['age'].agg(['min', 'max', 'mean', 'count'])","bcb47ee2":"plt.figure(figsize=(10, 6))\nsns.boxplot(x=\"sex\", y=\"age\", data=df)\nplt.title(\"Box plot of the Genders based on Age\")\nplt.show()","d38e0a5f":"df['bmi'].describe()","4fe41d9a":"plt.figure(figsize=(10, 6))\nsns.scatterplot(x=\"bmi\", y=\"charges\", data=df)\nplt.title(\"Box plot of the Regions\")\nplt.show()","e6308c4d":"df['obesite'] = df['bmi'] > 30\ndf['obesite'].value_counts()","5abde532":"plt.figure(figsize=(10, 6))\nsns.boxplot(x=\"obesite\", y=\"charges\", data=df)\nplt.title(\"Box plot of the Obesite based on charges\")\nplt.show()","a52b30e1":"df.groupby('obesite')['charges'].agg(['min', 'max', 'mean', 'count'])","a76d9b18":"df.groupby(['obesite', 'sex'])['charges'].agg(['min', 'max', 'mean', 'count'])","5e1e23bd":"corr = df.corr()\nax = sns.heatmap(corr, annot=True)","966ccce7":"from sklearn.preprocessing import LabelEncoder\n\ncolumns = ['sex', 'region', 'smoker', 'obesite']\n\nfor column in columns:\n    encoder = LabelEncoder()\n    df[column] = encoder.fit_transform(df[column])\n\ndf.head()","a8992ca0":"X = df.drop(columns=['charges', 'bmi'])\ny = df['charges']\n\nprint(\"X's shape\", X.shape)\nprint(\"y's shape\", y.shape)","bdc205c7":"from sklearn.preprocessing import scale\n\ncolumns = X.columns\n\nfor column in columns:\n    print(column)\n    X[column] = scale(X[column])\n    \nX.head()\n    ","e1325c1e":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\nprint(\"There are {} training examples\".format(X_train.shape[0]))\nprint(\"There are {} test examples\".format(X_test.shape[0]))","4527b449":"from sklearn.linear_model import LinearRegression\n\nmodel = LinearRegression()\n\nmodel.fit(X_train, y_train)\n\npredictions = model.predict(X_test)","925fa46e":"from sklearn.metrics import r2_score\nfrom sklearn.metrics import mean_squared_error\n\n\nr2 = r2_score(y_test, predictions)\nmse = mean_squared_error(y_test, predictions)\n\nprint(\"R2 score is {}\".format(r2))\nprint(\"Mean Squared Error score is {}\".format(mse))","c1c2d700":"plt.figure(figsize=(10, 6))\nsns.scatterplot(x=predictions, y=y_test)\nplt.title(\"Scatter plot of Predictions and Actual Values\")\nplt.show()","10af59d5":"Smoking will be a crucial variable in the regression part.","1281e00b":"Let's check the bmi","b23033d4":"Let's standardize our data.","c0c95909":"Let's see obesite values in each gender","60a7ffcd":"Now let's see the Age values.","aac21546":"There are a few things that comes to attention.\n1. Average age is 39.\n2. Average BMi is 30, which is the threshold for the obesity. [Source](https:\/\/www.cdc.gov\/obesity\/adult\/defining.html#:~:text=If%20your%20BMI%20is%20less,falls%20within%20the%20obese%20range.)\n3. Average children is 1. ","bb11cff2":"What we learned so far\n* Smoker is a cruical factor of insurance charges.\n* There is not much difference between regions.\n* Generally males charges are more than female charges.\n* 2 or 3 children families has the most charges.\n* Obesite plays a crucial factor.","8d93c4d0":"Mean value is higher in Male gender. It could be a useful feature for us. Let's see a boxplot.","2a6a558e":"There are 1338 accounts in seven different columns. ","0473e6b2":"Nearly half of the families has no children and the children average is 1.20. ","fd4bc4a7":"## DATA PREPROCESSING","fe737427":"R2 score is 0.78 which means there is a strong correlation between what we predicted and actual values. Let's see the plot","6d0ba723":"The mean values are basicaly the same. Let's see of smokers age values.","adad67bb":"We can combine gender and sex and see the values for in each region with 2 different gender.","f7d6c6de":"Let's divide our features and labels","d5622dd4":"### MODEL TRAINING","b3d2f784":"In this project what we are trying to do is predicting the charges value. Since charges value is a continous variable, the name of process is **regression**. First we need to handle the data after that we are applying some regression techniques.","26e61af0":"Apperantly there are some higher charges in southeast but average looks almost equal in 4 regions.","2e48487f":"There is no nan value which is good.","c682e245":"Now let's see for the gender.","2bb2968c":"From the numbers what we can say is *southeast* have highest average but there is not much difference in those regions. Let's see a boxplot of it.","ecda28dc":"Let's try something else. Let's divide bmi with obes and not obes","5baf6d81":"Now let's examine the children factor","1c198d84":"Let's see some stats","ed2c711f":"It looks like there is a correlation in between age and charges.","4dbabca9":"## DATA EXPLORATION","a1946ed8":"Apperantly highest average value is in families with 2 or 3 children.","7b86468b":"Let's examine the smoking scores.","79632091":"Let's see some statistics about the categorical variables such as region and gender","c96894b5":"Nearly half of the people are obes","62b26ccf":"Let's see the gender age values.","f4a63bb1":"Male and Female Obesite counts are nearly same. Obesite could be an important factor. ","88baa701":"Obesite ones charges are higher than non-obesites.","e0871c8f":"Southeast has more smokers than the other regions. Smoker numbers might be the reason why southeast has the highest average of charges.","0a3e013a":"Let's see the count of the smokers in each region","91611bfc":"If you find these kernel useful or any good, please upvote. I will try to improve the model performance in the next days. \n\nStay safe.","c9dd57fa":"The number of people in each region with each gender is almost same. However, Male gender in southeast region has the highest mean value among all the numbers. There is at least 3k difference between southeast male and other regions. \n\nOther than that in Northwest region male mean value is lower than the female mean value, unlike other regions. ","800fa427":"Apperantly, smokers charges are more expensive than the non-smoker charges. Let's see a plot of it."}}