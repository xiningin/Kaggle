{"cell_type":{"710fddfb":"code","e815d717":"code","c93e4d7c":"code","55c4cc90":"code","d3dd7791":"code","94cbea10":"code","a00017d0":"code","e0bc192d":"code","0327bb28":"code","81455d12":"code","00d75529":"code","37cc680e":"code","20ef44cc":"code","519f887e":"code","444e4105":"code","01e4ba66":"code","7796ed88":"code","24e73fcb":"code","62874884":"code","bd2e5876":"code","593e3807":"code","b5c65823":"code","97e29c28":"code","baae5b79":"code","8089d484":"code","213295fc":"code","6fed0178":"code","c08564fb":"code","9673886f":"code","f3ed6f32":"code","4ab242e9":"code","7dcf47b5":"code","8119ad1b":"code","d783a022":"code","0cab4e74":"code","9aba7498":"code","8c76a7c5":"code","0a5c3c1d":"code","97901fa5":"code","31cb3b11":"code","dc7b93f0":"code","83073ec1":"code","a846ca19":"code","c6083df1":"code","49cd54a8":"markdown","ceff4ca3":"markdown","9ff106bc":"markdown","80405961":"markdown","8b4b0eff":"markdown","2fe4ef0a":"markdown","67011d5d":"markdown","8054b4c8":"markdown","ae8b68aa":"markdown","a583b0b6":"markdown","e3a56392":"markdown","a2e9e36c":"markdown","91cac8d1":"markdown","790b1758":"markdown","204454ed":"markdown","70757a22":"markdown","75c4c865":"markdown","e2a4ebc0":"markdown","ccbd3622":"markdown","37c894f5":"markdown","c63e5078":"markdown"},"source":{"710fddfb":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","e815d717":"df =  pd.read_csv('\/kaggle\/input\/africa-economic-banking-and-systemic-crisis-data\/african_crises.csv')","c93e4d7c":"df.head()","55c4cc90":"df.info()","d3dd7791":"df.shape","94cbea10":"df.banking_crisis.describe()","a00017d0":"df.head()","e0bc192d":"import seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore')","0327bb28":"fig,ax = plt.subplots(1,2, figsize=(15,10))\nvc=df['inflation_crises'].value_counts()\n#print(vc)\nvc.plot(kind='pie',autopct='%1.1f', ax = ax[0])\n\nvc=df['banking_crisis'].value_counts()\n#print(vc)\nvc.plot(kind='pie',autopct='%1.1f',ax = ax[1])\nax[0].set_title('Percentage of Inflation Crisis')\nax[1].set_title('Percentage of Banking Crisis')\nplt.show()","81455d12":"fig,ax = plt.subplots(1,2, figsize=(15,10))\nvc=df['currency_crises'].value_counts()\nvc.plot(kind='pie',autopct='%1.1f', ax = ax[0])\n\nvc=df['systemic_crisis'].value_counts()\nvc.plot(kind='pie',autopct='%1.1f',ax = ax[1])\nax[0].set_title('Percentage of Currency Crisis')\nax[1].set_title('Percentage of Systemic Crisis')\nplt.show()","00d75529":"plt.figure(figsize=(10,7))\nsns.heatmap(df.corr(),annot=True, cmap='YlGnBu')\nplt.title(\"Correlation Map\",fontsize=20)\nplt.show()","37cc680e":"plt.figure(figsize=(12,7))\nsns.barplot(data=df, x='country', y='case')\nplt.show()","20ef44cc":"plt.figure(figsize=(14,8))\nsns.scatterplot(data = df, y='year', x = 'inflation_crises',hue='inflation_crises')\nplt.show()","519f887e":"plt.figure(figsize=(10,7))\nsns.distplot(df['exch_usd'], bins=20, hist=True, kde=True, color='r')\nplt.show()","444e4105":"plt.figure(figsize=(10,7))\nsns.pointplot(y=df['exch_usd'] , x= df['inflation_crises'])\nplt.title('Exchange Rate vs. Inflation Crisis')\nplt.show()","01e4ba66":"topfive = df.groupby('country')['inflation_crises'].agg('sum').nlargest(5)\n\ndf['banking_crisis'] = df['banking_crisis'].map(lambda x : 1 if x == 'crisis' else 0)\ntopbank = df.groupby('country')['banking_crisis'].agg('sum').nlargest(5)\n","7796ed88":"fig,ax = plt.subplots(1,2,figsize=(15,6))\ntopfive.plot.bar(color='m', ax = ax[0])\ntopbank.plot.bar(color='g', ax = ax[1])\nax[0].set_title('Top Five Countries of Inflation Crisis')\nax[1].set_title('Top Five Countries of Banking Crisis')\nplt.show()","24e73fcb":"curr = df.groupby('country')['currency_crises'].agg('sum').nlargest(5)\nsys = df.groupby('country')['systemic_crisis'].agg('sum').nlargest(5)","62874884":"fig,ax = plt.subplots(1,2,figsize=(15,6))\ncurr.plot.bar(color='r', ax = ax[0])\nsys.plot.bar(color='k', ax = ax[1])\nax[0].set_title('Top Five Countries of Currency Crisis')\nax[1].set_title('Top Five Countries of Systemic Crisis')\nplt.show()","bd2e5876":"sns.regplot(data=df, y='inflation_crises', x='exch_usd')\nplt.show()","593e3807":"from sklearn.model_selection import cross_val_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier \nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.preprocessing import LabelEncoder","b5c65823":"le = LabelEncoder()\ndf['country'] = le.fit_transform(df['country'])","97e29c28":"df['cc3'] = le.fit_transform(df['cc3'])","baae5b79":"X = df.drop('inflation_crises', axis=1)\ny = df['inflation_crises']\ncv_scr = cross_val_score(RandomForestClassifier(), X, y, cv = 10)\ncv_scr","8089d484":"sum1 = 0\nfor i in cv_scr:\n    sum1 = sum1+i\n    i +=1\nprint(\"The average accuracy of Random Forest algorithm with 10 folds is\", sum1*100\/10, \"percent\")","213295fc":"cv_scr1 = cross_val_score(LogisticRegression(), X, y, cv = 10)\nsum2 = 0\nfor i in cv_scr1:\n    sum2 = sum2+i\n    i +=1\nprint(\"The average accuracy of Logistic Regression algorithm with 10 folds is\", sum2*100\/10, \"percent\")","6fed0178":"cv_scr2 = cross_val_score(DecisionTreeClassifier(), X, y, cv = 10)\nsum3 = 0\nfor i in cv_scr2:\n    sum3 = sum3+i\n    i +=1\nprint(\"The average accuracy of Decision Tree algorithm with 10 folds is\", sum3*100\/10, \"percent\")","c08564fb":"cv_scr3 = cross_val_score(KNeighborsClassifier(), X, y, cv = 10)\nsum4 = 0\nfor i in cv_scr3:\n    sum4 = sum4+i\n    i +=1\nprint(\"The average accuracy of KNN algorithm with 10 folds is\", sum4*100\/10, \"percent\")","9673886f":"indices = ['Random Forest','Logistic Regression','Decision Tree', 'KNN']\nbar = pd.DataFrame([sum1*10,sum2*10, sum3*10, sum4*10], index = indices)","f3ed6f32":"bar.plot.bar(color='m')\nplt.show()","4ab242e9":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=14)","7dcf47b5":"model = RandomForestClassifier()\nmodel.fit(X_train,y_train)","8119ad1b":"print(\"The accuracy of the model is\",model.score(X_test,y_test)*100,\"percent\")","d783a022":"plt.figure(figsize=(10,7))\ny_pred = model.predict(X_test)\ncm = confusion_matrix(y_test,y_pred)\nsns.heatmap(cm,annot=True)\nplt.show()","0cab4e74":"gini = DecisionTreeClassifier()","9aba7498":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=14)\ngini.fit(X_train, y_train)\ny_pred = gini.predict(X_test)","8c76a7c5":"from sklearn.metrics import accuracy_score, classification_report\nprint('Accuracy Score: ',accuracy_score(y_test, y_pred)*100,\"percent\")","0a5c3c1d":"print('Classification Report')\nprint(classification_report(y_test, y_pred))","97901fa5":"plt.figure(figsize=(10,7))\ny_pred = model.predict(X_test)\ncm = confusion_matrix(y_test,y_pred)\nsns.heatmap(cm,annot=True)\nplt.show()","31cb3b11":"from sklearn.neighbors import KNeighborsClassifier","dc7b93f0":"knn = KNeighborsClassifier()\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=14)","83073ec1":"from sklearn.model_selection import GridSearchCV\ngrid = {'n_neighbors':np.arange(1,25)}\nknn_cv = GridSearchCV(knn, grid, cv=5)\nknn_cv.fit(X,y)\nprint(\"Tuned Parameters are: {}\".format(knn_cv.best_params_))\nprint(\"Best Score is: {}\".format(knn_cv.best_score_))","a846ca19":"knn = KNeighborsClassifier(n_neighbors = 5)\n\nknn.fit(X_train,y_train)\ny_pred = knn.predict(X_test)\nprint(\"The accuracy score is\", knn.score(X_test, y_test)*100,\"percent\")","c6083df1":"plt.figure(figsize=(10,7))\ncm = confusion_matrix(y_test,y_pred)\nsns.heatmap(cm,annot=True)\nplt.show()","49cd54a8":"The confusion matrix also confirms the fact that the accuracy of KNN is lower than the other three models because the number of False Positives and False Negatives in this case are higher than all the other three models.\n","ceff4ca3":"The countries with inflation crisis have a lower exchange rate (in US Dollars).","9ff106bc":"1. The highest correlation exists between Domestic Debt in Default and Sovereign External Debt Default.\n2. The lowest correlation is between Case and Exchange Used.","80405961":"****Since after tuning, the best number of parameters has come out to be no. of neighbors = 5. We shall use KNN model with n_neighbors = 5 on our dataset.****","8b4b0eff":"The confusion matrix obtained is almost the same as the one obtained in Random Forest implying that both Random Forest and Logistic Regression predict with almost the same accuracy (as can be confirmed by the model score above).","2fe4ef0a":"The number of years that had inflation crisis = 1 is not in continuum. It means that inflation crisis did not occur continuously from 1860 to 2020.","67011d5d":"**Top Five Countries of Crisis**","8054b4c8":"**Hyperparametric Tuning**","ae8b68aa":"The accuracy score of Random Forest Classifier is 98.74 percent.****","a583b0b6":"****The cross-validation score of Decision Tree showed an accuracy of approximately 92% but on applicatiion of the Decision Tree model, we obtain an accuracy of 98.74%.********","e3a56392":"**Comparing Cross Validation Scores of Different Algorithms**","a2e9e36c":"****> Distribution of Exchange Rate of Countries w.r.t US Dollar","91cac8d1":"Out of the four methods that we have applied, KNN gives the lowest accuracy.","790b1758":"**K Nearest Neighbours**","204454ed":"As seen in the bar chart, the cross validation score of Logistic Regression and Random Forest Classifer is almost the same, while the score for Decision Tree is the lowest.","70757a22":"**Random Forest**","75c4c865":"Zimbabwe and Nigeria are among the top five countries in all four kinds of crises.","e2a4ebc0":"**Decision Tree****","ccbd3622":"As the above plot shows, the relationship between Inflation Crises and Exchange Rate is not profoundly linear. Thus, linear regression algoritm is not well-application","37c894f5":"The kernel density is maximum between 0 to 25 (approximate range) implying that the maximum number of countries have an exchange rate in this range.","c63e5078":"The percentage of cases with inflation crises is highest at 12.9%,\nThe percentage of cases with systemic crisis is the lowest at 7.7%."}}