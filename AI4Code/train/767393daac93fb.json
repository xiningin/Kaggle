{"cell_type":{"e824fac8":"code","5195db48":"code","fa1d2fd3":"code","68b4819b":"code","5938d686":"code","2e094753":"code","513ca3e9":"code","135ea328":"code","e67bfecd":"code","df53cf88":"code","17914aa0":"code","3e7bd6cb":"code","0c7b8c24":"markdown","779f21cc":"markdown","8ea915b1":"markdown","13ee615a":"markdown","eb5de554":"markdown"},"source":{"e824fac8":"import numpy as np\nimport pandas as pd\nimport pathlib\nfrom sklearn.metrics import confusion_matrix\nfrom fastai import *\nfrom fastai.vision import *","5195db48":"DATA_DIR='..\/input\/fruits\/DataSetFruits'","fa1d2fd3":"os.listdir(f'{DATA_DIR}')","68b4819b":"torch.cuda.is_available()","5938d686":"data = ImageDataBunch.from_folder(DATA_DIR, train=\".\", \n                                  valid_pct=0.2,\n                                  size=224, bs=10, \n                                  num_workers=0).normalize(imagenet_stats)","2e094753":"print(f'Classes: \\n {data.classes}')","513ca3e9":"data.show_batch(rows=3, figsize=(7,6))","135ea328":"learn = cnn_learner(data, models.resnet34, metrics=accuracy, model_dir=\"\/tmp\/model\/\")","e67bfecd":"learn.fit_one_cycle(5)","df53cf88":"interp = ClassificationInterpretation.from_learner(learn)","17914aa0":"interp.plot_top_losses(9, figsize=(15,11))","3e7bd6cb":"interp.plot_confusion_matrix(figsize=(8,8), dpi=60)","0c7b8c24":"# Treino do modelo","779f21cc":"# Leitura dos dados","8ea915b1":"# Constru\u00e7\u00e3o do modelo\n\nTrecho retirado de https:\/\/docs.fast.ai\/vision.models.html\n\n\nThe fastai library includes several pretrained models from torchvision, namely:\n\n* resnet18, resnet34, resnet50, resnet101, resnet152\n* squeezenet1_0, squeezenet1_1\n* densenet121, densenet169, densenet201, densenet161\n* vgg16_bn, vgg19_bn\n* alexnet","13ee615a":"# Verificando os resultados","eb5de554":"Base de dados: https:\/\/www.kaggle.com\/cactus3\/basicshapes\n\nKernel de refer\u00eancia: https:\/\/www.kaggle.com\/kageyama\/fastai-shape-recognition-using-vgg16"}}