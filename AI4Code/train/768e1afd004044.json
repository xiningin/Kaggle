{"cell_type":{"6312ae72":"code","96979649":"code","ba03b557":"code","c94c895a":"code","95e9ba12":"code","d760bf90":"code","3afe6d3a":"code","8a44b714":"code","b844ee3e":"code","7827413b":"code","d5829552":"code","6a2bf1fa":"code","516cff06":"code","a2ef784f":"code","b412eda5":"code","7fc10784":"code","a67abe93":"code","5ecd2174":"code","251ed4ec":"code","5ed05d3d":"code","14cf2b73":"code","1c2a9bcc":"code","e87c36f3":"markdown","18cb2e51":"markdown","eed7e34a":"markdown","b37a1885":"markdown","e84f8031":"markdown","95317383":"markdown","2b57c3d7":"markdown","50a12a8e":"markdown","dc845922":"markdown","cb252e54":"markdown","93c5064a":"markdown","f7f4425c":"markdown","6310bc99":"markdown","d65e4398":"markdown","32c5af78":"markdown","34a54b66":"markdown","15331c3c":"markdown"},"source":{"6312ae72":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n","96979649":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","ba03b557":"train = pd.read_csv(\"\/kaggle\/input\/tabular-playground-series-jun-2021\/train.csv\")\ntrain","c94c895a":"test = pd.read_csv(\"\/kaggle\/input\/tabular-playground-series-jun-2021\/test.csv\")\ntest","95e9ba12":"submission = pd.read_csv(\"\/kaggle\/input\/tabular-playground-series-jun-2021\/sample_submission.csv\")\nsubmission","d760bf90":"\nimport matplotlib.pyplot as plt\n\ntrain.groupby('target').target.count().plot.bar(ylim=0)\nplt.show()\n","3afe6d3a":"target = train.groupby('target').target.count()\ntarget","8a44b714":"target = train.target","b844ee3e":"train.drop('target', axis = 1, inplace = True)\ntrain","7827413b":"combi = train.append(test)\ncombi","d5829552":"combi.drop('id', axis = 1, inplace = True)\ncombi","6a2bf1fa":"combi.isnull().sum().sum()","516cff06":"combi = (combi.max() - combi) \/ (combi.max() - combi.min())\ncombi","a2ef784f":"target = pd.get_dummies(target)\ntarget","b412eda5":"y = target\nX = combi[: len(train)]\nX_test = combi[len(train) :]","7fc10784":"#split train set for testing\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.10, random_state=1, stratify=y)\nX_train.shape, y_train.shape, X_val.shape, y_val.shape, X_test.shape","a67abe93":"from sklearn.multioutput import MultiOutputRegressor\nfrom sklearn.experimental import enable_hist_gradient_boosting\nfrom sklearn.ensemble import HistGradientBoostingRegressor\n\nmodel = MultiOutputRegressor(HistGradientBoostingRegressor(random_state=1, max_iter=10000)).fit(X_train, y_train)\nmodel.score(X_train, y_train)","5ecd2174":"y_pred = model.predict(X_val)\nmodel.score(X_val, y_val)","251ed4ec":"predictions = model.predict(X_test)\npredictions.shape","5ed05d3d":"predictions[predictions < 0] = 0","14cf2b73":"submission.Class_1 = predictions[:, 0]\nsubmission.Class_2 = predictions[:, 1]\nsubmission.Class_3 = predictions[:, 2]\nsubmission.Class_4 = predictions[:, 3]\nsubmission.Class_5 = predictions[:, 4]\nsubmission.Class_6 = predictions[:, 5]\nsubmission.Class_7 = predictions[:, 6]\nsubmission.Class_8 = predictions[:, 7]\nsubmission.Class_9 = predictions[:, 8]","1c2a9bcc":"submission.to_csv('submission.csv', index=False)\nsubmission = pd.read_csv(\"submission.csv\")\nsubmission","e87c36f3":"Predict on validation set","18cb2e51":"Drop target","eed7e34a":"The dataset is used for this competition is synthetic, but based on a real dataset and generated using a CTGAN. The original dataset deals with predicting the category on an eCommerce product given various attributes about the listing. Although the features are anonymized, they have properties relating to real-world features.\n\n","b37a1885":"Split training set","e84f8031":"One hot encode target","95317383":"Analyse target","2b57c3d7":"Drop id","50a12a8e":"Read","dc845922":"Define independant and dependant variables","cb252e54":"Check for null values","93c5064a":"Combine train and test","f7f4425c":"Define target","6310bc99":"Prepare submission","d65e4398":"Select model","32c5af78":"Normalise data","34a54b66":"Predict on test sdet","15331c3c":"Import"}}