{"cell_type":{"8630dfd8":"code","6deb06de":"code","c6d8158b":"code","ebcac577":"code","a0d05a18":"code","4a997158":"code","3358f1a9":"code","7d779b0b":"code","c2605b37":"code","26e5dab1":"code","bb2eca38":"code","dbece4a6":"code","66eb9a30":"code","860b0b78":"code","323e09fc":"code","c10b7829":"code","68d3f7ef":"code","09e80998":"code","1e9bf1eb":"code","d84b8669":"code","d6deb8aa":"code","1443827c":"code","0b35d18d":"code","7930541f":"code","667d990e":"code","1d218f25":"code","2194ee7f":"code","709bf6ad":"code","0bd5931a":"code","f844d492":"code","02e61525":"code","b09916cc":"code","e0752947":"code","52d377dc":"code","98e50af6":"code","3cb10cb9":"code","ed03a19d":"code","15af6f4c":"code","63affd77":"code","fdef11fd":"code","c9ca8641":"code","9c53d455":"code","818e0ab4":"code","5fe4ff1d":"code","fa377672":"code","e43b0e2c":"markdown","ac921b53":"markdown","63fb4577":"markdown","42b67dbe":"markdown","1b44c80e":"markdown","5a1befaa":"markdown","f052b7d7":"markdown","fcdc2820":"markdown","d3410122":"markdown","226aa979":"markdown","0480ef3c":"markdown","5d63a5d1":"markdown","2c843eb8":"markdown","802cf21c":"markdown","e2feae4b":"markdown","c0f85caf":"markdown","18642e54":"markdown","b3987e1c":"markdown","8fd85525":"markdown","41d85805":"markdown","af92c654":"markdown","450981f5":"markdown","01430806":"markdown"},"source":{"8630dfd8":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","6deb06de":"df_diabetes = pd.read_csv(\"..\/input\/early-diabetes-classification\/diabetes_data.csv\", sep = \";\")","c6d8158b":"df_diabetes.head()","ebcac577":"print(df_diabetes.shape)\nprint(df_diabetes[\"class\"].unique())","a0d05a18":"df_diabetes[\"gender\"] = df_diabetes[\"gender\"].apply({\"Male\":1, \"Female\":0}.get)\ndf_diabetes.head()","4a997158":"from sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler","3358f1a9":"X = df_diabetes[df_diabetes.columns[:-1]]\nY = df_diabetes[df_diabetes.columns[-1]]\nscaler = StandardScaler()\nscaled_X = scaler.fit_transform(X)","7d779b0b":"X_train, X_test, Y_train, Y_test = train_test_split(scaled_X, \n                                                    Y, \n                                                    test_size=0.4, \n                                                    random_state=101)","c2605b37":"sns.countplot(x=\"gender\", data=df_diabetes)","26e5dab1":"sns.countplot(x=\"class\", hue=\"gender\", data=df_diabetes)","bb2eca38":"sns.histplot(df_diabetes[\"age\"], kde=False, bins=10)","dbece4a6":"from sklearn.linear_model import LogisticRegression","66eb9a30":"logmodel = LogisticRegression()\nlogmodel.fit(X_train, Y_train)","860b0b78":"predictions_log = logmodel.predict(X_test)","323e09fc":"from sklearn import metrics\nfrom sklearn.metrics import classification_report, confusion_matrix, f1_score","c10b7829":"print(classification_report(Y_test, predictions_log))","68d3f7ef":"print(confusion_matrix(Y_test, predictions_log))","09e80998":"f1_log = f1_score(Y_test, predictions_log)\nprint(f1_log)","1e9bf1eb":"from sklearn.neighbors import KNeighborsClassifier","d84b8669":"knn = KNeighborsClassifier(n_neighbors=1)\nknn.fit(X_train, Y_train)","d6deb8aa":"predictions_knn1 = knn.predict(X_test)","1443827c":"print(classification_report(Y_test, predictions_knn1))","0b35d18d":"print(confusion_matrix(Y_test, predictions_knn1))","7930541f":"f1_knn1 = f1_score(Y_test, predictions_knn1)\nprint(f1_knn1)","667d990e":"error_rate = []\nfor i in range(1,40):\n    knn = KNeighborsClassifier(n_neighbors=i)\n    knn.fit(X_train, Y_train)\n    pred_i = knn.predict(X_test)\n    error_rate.append(np.mean(pred_i != Y_test))","1d218f25":"plt.figure(figsize=(10,6))\nplt.plot(range(1,40),error_rate,color='blue', linestyle='dashed', marker='o',\n         markerfacecolor='red', markersize=10)\nplt.title('Error Rate vs. K Value')\nplt.xlabel('K')\nplt.ylabel('Error Rate')","2194ee7f":"knn = KNeighborsClassifier(n_neighbors=3)\nknn.fit(X_train, Y_train)","709bf6ad":"predictions_knn2 = knn.predict(X_test)","0bd5931a":"print(classification_report(Y_test, predictions_knn2))","f844d492":"print(confusion_matrix(Y_test, predictions_knn2))","02e61525":"f1_knn2 = f1_score(Y_test, predictions_knn2)\nprint(f1_knn2)","b09916cc":"from sklearn.tree import DecisionTreeClassifier","e0752947":"dtree = DecisionTreeClassifier()\ndtree.fit(X_train, Y_train)","52d377dc":"predictions_dt = dtree.predict(X_test)","98e50af6":"print(classification_report(Y_test, predictions_dt))","3cb10cb9":"print(confusion_matrix(Y_test, predictions_dt))","ed03a19d":"f1_dt = f1_score(Y_test, predictions_dt)\nprint(f1_dt)","15af6f4c":"from sklearn.ensemble import RandomForestClassifier","63affd77":"rfc = RandomForestClassifier(n_estimators=100)\nrfc.fit(X_train, Y_train)","fdef11fd":"predictions_rfc = rfc.predict(X_test)","c9ca8641":"print(classification_report(Y_test, predictions_rfc))","9c53d455":"print(confusion_matrix(Y_test, predictions_rfc))","818e0ab4":"f1_rfc = f1_score(Y_test, predictions_rfc)\nprint(f1_rfc)","5fe4ff1d":"data = {\"Method\":[\"Logistic Regression\", \"KNN1\", \"KNN2\", \"Decision Trees\", \"Random Forest\"],\n       \"f1-score\":[f1_log, f1_knn1, f1_knn2, f1_dt, f1_rfc]}\n\nresults = pd.DataFrame(data)\nprint(results)","fa377672":"plt.figure(figsize=(12,6))\nfeature_imp = pd.Series(rfc.feature_importances_, index = X.columns).sort_values(ascending = False)\nfeature_plot = sns.barplot(x = feature_imp, y = feature_imp.index)\nfeature_plot.set_title(\"Feature Importance Plot\")\nfeature_plot.set_xlabel(\"Score\")\nfeature_plot.set_ylabel(\"Feature\")","e43b0e2c":"### Model 5: Random Forests","ac921b53":"### 1. Data Processing","63fb4577":"### Evaluate Model 1","42b67dbe":"### From initial analysis, we have a majority male dataset but have more females diagnosed with diabetes. Additionally, the histogram shows that we have a majority age group of 50-60 years old","1b44c80e":"# In this project, I will be creating a simple diabetes prediction model and finding important variables to explain a person having diabetes.","5a1befaa":"### Model 2: K Nearest Neighbors","f052b7d7":"## 3. Methods","fcdc2820":"### Evaluate Model 5","d3410122":"### Evaluate Model 3","226aa979":"### Next, we will split the dataset into training and test datasets and utilize various algorithms to predict the response variable class","0480ef3c":"### Model 3: K Nearest Neighbors with tuning","5d63a5d1":"### I chose to utilize f1-scores to determine the most accurate model in predicting diabetes in a particular patient. f1-scores take into account both precision and recall to determine the percentage of positive predictions that were determined to be correct. In an issue such as diabetes, the false negative is highly critical.","2c843eb8":"## 2. EDA","802cf21c":"### Next, I will conduct some basic exploratory data analysis to find out the gender and age profile of our dataset as well as our response variable \"class\"","e2feae4b":"### Here, we see that polydipsia and polyuria are the 2 most important conditions which help to predict a person having diabetes. Polydispia is the medical term for experiencing extreme thirst while Polyuria is a condition where a person has excessive urination. Cross-referencing this with online research, these are 2 particular conditions which are found to be early indications of a person having diabetes. Thus, its importance here is justified.","c0f85caf":"### Evaluate Model 4","18642e54":"### Model 1: Logistic Regression","b3987e1c":"### Based on the respective f1 scores, it appears that the Random Forest Algorithm is the most suitable in predicting diabetes. Lets visualize the important variables","8fd85525":"## My Analysis\n\nHere is the approach I took for this project:\n\n1. Data Processing\n\n2. Exploratory Data Analysis\n\n3. Methods\n\n4. Results & Discussion","41d85805":"### Evaluate Model 2","af92c654":"### Model 4: Decision Trees","450981f5":"## 4. Results & Discussion","01430806":"### There are 520 rows and 16 predictor columns for the diabetes class. The diabetes class takes value 1 and 0. Next, I will convert the categorical gender variable to a binary variable"}}