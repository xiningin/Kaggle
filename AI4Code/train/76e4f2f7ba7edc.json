{"cell_type":{"14592694":"code","1d1ac500":"code","2c25132b":"code","2d3a1f02":"code","e0e0f48f":"code","d049c412":"code","f15acbc2":"code","40e8cf2e":"code","500977c9":"code","2eb9f90e":"code","60fad27c":"code","064b11ff":"code","837e5aac":"code","fc883453":"code","d1fdbe63":"code","9be87554":"markdown","01ba4deb":"markdown","d7f89dd2":"markdown","3e8d7379":"markdown","57193011":"markdown","00946c33":"markdown"},"source":{"14592694":"!pip install fastai -q --upgrade","1d1ac500":"import fastai\nprint(fastai.__version__)","2c25132b":"#remove bad images\n!rm -rf ..\/input\/fromages-images\/Pic du Vieux Chaillol fromage\/image_20210806_110205_6694.jpg","2d3a1f02":"from fastai.vision.all import *\npath = Path('..\/input\/fromages-images')\npath.ls()","e0e0f48f":"def get_dls(bs, size):\n    dblock = DataBlock(blocks = (ImageBlock, CategoryBlock),\n                       get_items = get_image_files,\n                       get_y = parent_label,\n                       splitter = RandomSplitter(),\n                       item_tfms = Resize(size)\n                      )\n    return dblock.dataloaders(path, bs = bs)\n\n","d049c412":"dls = get_dls(16, 128)","f15acbc2":"learn = cnn_learner(dls, resnet34, metrics=accuracy)","40e8cf2e":"learn.lr_find()","500977c9":"learn = cnn_learner(dls, resnet34, metrics=accuracy)\nlearn.fit_one_cycle(10, 1e-3)","2eb9f90e":"learn.dls = get_dls(16, 224)\nlearn.fine_tune(5, 1e-3)","60fad27c":"learn.show_results()","064b11ff":"interp = Interpretation.from_learner(learn)\ninterp.plot_top_losses(k=3)","837e5aac":"learn.predict('..\/input\/squidgame-images\/Oh Il-nam\/image_20211118_172426.jpg')","fc883453":"learn.export(fname='model.pkl', pickle_module=pickle, pickle_protocol=2)","d1fdbe63":"reload_model=load_learner('model.pkl', cpu=True, pickle_module=pickle)\nreload_model","9be87554":"## Enjoy.","01ba4deb":"## Predict","d7f89dd2":"## Save model","3e8d7379":"## Show results","57193011":"## Interpretation","00946c33":"## Reload model"}}