{"cell_type":{"deec0ab2":"code","471e7712":"code","aa49fb50":"code","fc6e3d77":"code","85937876":"code","dcae789d":"code","46f0e2f3":"markdown","610c7cda":"markdown","8aec8892":"markdown","048da3ab":"markdown","c5cb57a6":"markdown","e026f9e8":"markdown","5095110f":"markdown"},"source":{"deec0ab2":"# Import the libraries\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import r2_score\n\nimport seaborn as sns    # plot tools\n\n# Take a look in the Stocks directory to select one dataset from a company\n\nimport os\nprint(os.listdir(\"..\/input\/Data\/\"))\n\n# Any results you write to the current directory are saved as output.","471e7712":"# Directory of the dataset \nfilename = '..\/input\/Data\/Stocks\/googl.us.txt'\n\n# Read the file\nPrgoo = pd.read_csv(filename,sep=',',index_col='Date')\n\n# Prices is the predict value and initial the independet variable (y)\nprices = Prgoo['Close'].tolist()\ninitial = (Prgoo['Open']).tolist()\n \n#Convert to 1d Vector\nprices = np.reshape(prices, (len(prices), 1))\ninitial = np.reshape(initial, (len(initial), 1))\n\nPrgoo.head(5)\n","aa49fb50":"Prgoo[['Open']].plot()\nplt.title('Google Open Price')\nplt.show()\n\nPrgoo[['Close']].plot()\nplt.title('Google Close Price')\nplt.show()","fc6e3d77":"plt.subplots(figsize=(8,6))\nsns.heatmap(Prgoo.corr(),annot=True, linewidth=.5,)","85937876":"sns.distplot(Prgoo['Open'], hist = False, kde = True, kde_kws = {'linewidth': 5},label='Open',) \nsns.distplot(Prgoo['Close'], hist = False, kde = True, kde_kws = {'linewidth': 3},label='Close') \n\nplt.legend(prop={'size': 10}, title = 'Types',loc= 'best')\nplt.title('Density Plot the Open and Close of the stock prices')\nplt.xlabel('Prices')\nplt.ylabel('Density')","dcae789d":"#Splitting the dataset into the Training set and Test set\nxtrain, xtest, ytrain, ytest = train_test_split(initial, prices, test_size=0.33, random_state=42)\nregressor = LinearRegression()\nregressor.fit(xtrain, ytrain)\n \n#Train Set Graph\nprint('Train-set \/','R2 score:',r2_score(ytrain,regressor.predict(xtrain)))\nplt.scatter(xtrain, ytrain, color='red', label= 'Actual Price') #plotting the initial datapoints\nplt.plot(xtrain, regressor.predict(xtrain), color='blue', linewidth=3, label = 'Predicted Price') #plotting the line made by linear regression\nplt.title('Linear Regression price| Open vs. Close')\nplt.legend()\nplt.xlabel('Prices')\nplt.show()\n \n#Test Set Graph\nprint('Test-set\/','R2 score:',r2_score(ytest,regressor.predict(xtest)))\nplt.scatter(xtest, ytest, color='red', label= 'Actual Price') #plotting the initial datapoints\nplt.plot(xtest, regressor.predict(xtest), color='blue', linewidth=3, label = 'Predicted Price') #plotting the line made by linear regression\nplt.title('Linear Regression price| Open vs. Close')\nplt.legend()\nplt.xlabel('Prices')\nplt.show()","46f0e2f3":"In this example we use information a Google, but this company is pretty stable in the stock prices so the simple correlation is going to get a good performance, but with other companies that could have more random behavior the simple linear regression may have issues. Though, in this case we could use other types of regression models for example the polinomial regresion that is not that is not as powerful as more complex models, but have less computacional cost and could get good enough results. \n","610c7cda":"It's seem like there is a high correlation between the dependent and independet variable, so, its means that it more easy to our model to stimate a value. But this fact by general it doesnt happen and we need to make some pre procesing to the data to get a better prediction. But, in this case, due to the strong correlation we are going directly to train and test the model. ","8aec8892":"First, let's check the correlation between the features of the dataset of google.","048da3ab":"In this case we choose the information of the stock price of google, and we are going to predict the close price starting from the open price. Other aproach could be, to choose the date as independet variable but probably is more useful (to bussines decisions) to know wich could be the \"close\" price knowing the actual price (open price). ","c5cb57a6":"**Linear Regression:** is a method used to model a relationship between a dependent variable (y), and an independent variable (x). Mathematically, the regression is based on the elementary equation of the line as follows:\n\n**y = a + bx** \n\nWhere:\n* y = dependent variable or the value to predict\n* b = slope of the line\n* x = independet variable\n* a = the y-intercept\n\nthe main goal is to find the best-fitting line that minimizes the sum of the squared error between the actual value of a stock price (y) and a predicted stock price in all the points of the dataset. \n\nThere is a lot of different types of lineal regresion, the most simple will only be one independet variable (x) and if there is more than one independet variables, its falls under the category of multiple linear regresion. In this exercise will only have one independent variable wich is the \"open\" of a stock price and we try to predict the close price. The main idea of this exercise is uses linear regression to predict the price of a stock so we are not looking use all the dataset but only information of one company.","e026f9e8":"It can be observed that all both \"open\" and \"close\" has the same trend. with naked eye can be say that they have a positive correlation. Let's check the value of the correlation.","5095110f":"Now we create the model of linear regression and also a train and test dataset to evaluate the model.Also we use the R^2 (coefficient of determination) regression score function, that give us information about how well is adapted the regression to the data."}}