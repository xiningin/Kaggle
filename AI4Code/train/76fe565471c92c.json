{"cell_type":{"ca46dfdc":"code","e7055beb":"code","8ab0b7fe":"code","97ca554d":"code","be6ec72d":"code","66e1a423":"code","3bf3dae5":"code","4535e7c4":"code","a8a4a07e":"code","e3157023":"code","e690153c":"code","2f95f6c2":"code","1a93162c":"code","2c398ad9":"code","a8af6faf":"code","6c6c54e4":"code","eaad2834":"code","0207f6c3":"code","eb56fcec":"code","5762499c":"code","12c13433":"code","01a4a4d8":"code","407b680e":"code","6ea47c37":"code","8c288912":"code","03ecff49":"code","1098ea52":"code","f8af9005":"code","9627fbd0":"code","78a0593e":"code","c66d6719":"code","68da8f2e":"code","6901741d":"code","265a8af5":"code","f3282e59":"code","2be9201f":"code","333a7745":"code","ccc50132":"code","46f796e6":"code","33aa7354":"code","7b761b05":"code","818ec003":"code","6337d514":"markdown","f65b05cc":"markdown","c1bdd804":"markdown","39727942":"markdown","0ba3a643":"markdown","7d7c0885":"markdown","8e49dde8":"markdown","46f7212b":"markdown","4870a7f1":"markdown","7a31100d":"markdown","3c149d11":"markdown","d8f3dff9":"markdown","64a271ea":"markdown","09430851":"markdown","3f0dc540":"markdown","dca054d0":"markdown","9c984614":"markdown","aea52d48":"markdown","116f9407":"markdown","b3d40fa7":"markdown","3c36f837":"markdown","7710300b":"markdown","eff38c0e":"markdown","a1e67b16":"markdown","59687436":"markdown","2ea21b88":"markdown","b1b02535":"markdown","fe9d050d":"markdown","78fb99cd":"markdown","67f85c95":"markdown","021e09b5":"markdown","a77e3dc4":"markdown","7a679e85":"markdown","3bdfb4fa":"markdown","ed686392":"markdown","e97603bc":"markdown","cf9e79ba":"markdown","af1969b5":"markdown","0c7469ad":"markdown","a8b2250f":"markdown","491abc0f":"markdown","ef12a2a8":"markdown"},"source":{"ca46dfdc":"import numpy as np\nimport pandas as pd \nimport matplotlib.pyplot as plt \nimport seaborn as sns \nfrom sklearn.linear_model import LogisticRegression #Logistic Regression is a Machine Learning classification algorithm\nfrom sklearn.linear_model import LinearRegression #Linear Regression is a Machine Learning classification algorithm\nfrom sklearn.model_selection import train_test_split #Splitting of Dataset\nfrom sklearn.metrics import classification_report \nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import r2_score\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","e7055beb":"dataset = pd.read_csv(\"\/kaggle\/input\/zomato-bangalore-restaurants\/zomato.csv\")\ndataset.head()","8ab0b7fe":"dataset.shape","97ca554d":"dataset.dtypes","be6ec72d":"dataset.isnull().sum()","66e1a423":"zomato=dataset.drop(['url','dish_liked','phone'],axis=1)\nzomato.columns","3bf3dae5":"zomato.rename({'approx_cost(for two people)': 'approx_cost_for_2_people',\n               'listed_in(type)':'listed_in_type',\n               'listed_in(city)':'listed_in_city'\n              }, axis=1, inplace=True)\nzomato.columns","4535e7c4":"remove_comma = lambda x: int(x.replace(',', '')) if type(x) == np.str and x != np.nan else x \nzomato.votes = zomato.votes.astype('int')\nzomato['approx_cost_for_2_people'] = zomato['approx_cost_for_2_people'].apply(remove_comma)","a8a4a07e":"zomato.info()","e3157023":"zomato = zomato.loc[zomato.rate !='NEW']\nzomato = zomato.loc[zomato.rate !='-'].reset_index(drop=True)","e690153c":"remove_slash = lambda x: x.replace('\/5', '') if type(x) == np.str else x\nzomato.rate = zomato.rate.apply(remove_slash).str.strip().astype('float')","2f95f6c2":"zomato['rate']","1a93162c":"def Encode(zomato):\n    for column in zomato.columns[~zomato.columns.isin(['rate', 'approx_cost_for_2_people', 'votes'])]:\n        zomato[column] = zomato[column].factorize()[0]\n    return zomato\n\nzomato_en = Encode(zomato.copy())","2c398ad9":"zomato_en['rate'] = zomato_en['rate'].fillna(zomato_en['rate'].mean())\nzomato_en['approx_cost_for_2_people'] = zomato_en['approx_cost_for_2_people'].fillna(\n                                         zomato_en['approx_cost_for_2_people'].mean())","a8af6faf":"zomato_en.isna().sum()","6c6c54e4":"plt.figure(figsize=(14,7))\nsns.heatmap(zomato_en.corr(method='kendall'), annot=True )","eaad2834":"x = zomato_en.iloc[:,[2,4,5,6,7,8]]\ny = zomato_en['rate']","0207f6c3":"x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=.1,random_state=0)","eb56fcec":"x_train.head()","5762499c":"from sklearn.linear_model import LinearRegression\nregressor = LinearRegression()\nregressor.fit(x_train, y_train)\n\n# Predicting the Test set results\ny_pred = regressor.predict(x_test)\n\nfrom sklearn.metrics import r2_score\nr2_score(y_test,y_pred)\n","12c13433":"from sklearn.tree import DecisionTreeRegressor\nDecTree=DecisionTreeRegressor(min_samples_leaf=.0001)\nDecTree.fit(x_train,y_train)\ny_predict=DecTree.predict(x_test)\n","01a4a4d8":"from sklearn.metrics import r2_score\nr2_score(y_test,y_predict)","407b680e":"from sklearn.ensemble import RandomForestRegressor\nRForest=RandomForestRegressor(n_estimators=5,random_state=329,min_samples_leaf=.0001)\nRForest.fit(x_train,y_train)\ny_predict1=RForest.predict(x_test)","6ea47c37":"from sklearn.metrics import r2_score\nr2_score(y_test,y_predict1)","8c288912":"sns.set(color_codes=True)","03ecff49":"sns.lmplot(x=\"rate\",y=\"approx_cost_for_2_people\", data=zomato);","1098ea52":"sns.lmplot(x=\"rate\",y=\"approx_cost_for_2_people\",hue=\"online_order\", data=zomato);","f8af9005":"sns.lmplot(x=\"rate\",y=\"votes\", data=zomato);","9627fbd0":"sns.lmplot(x=\"rate\",y=\"votes\", hue=\"book_table\",data=zomato);","78a0593e":"fig = plt.figure(figsize=(20,7))\nloc = sns.countplot(x=\"location\",data=dataset, palette = \"Set1\")\nloc.set_xticklabels(loc.get_xticklabels(), rotation=90, ha=\"right\")\nplt.ylabel(\"Frequency\",size=15)\nplt.xlabel(\"Location\",size=18)\nloc\nplt.title('NO. of restaurants in a Location',size = 20,pad=20)","c66d6719":"import plotly.offline as py\nimport plotly.graph_objs as go\nx=dataset['online_order'].value_counts()\ncolors = ['#FEBFB3', '#E1396C']\n\ntrace=go.Pie(labels=x.index,values=x,textinfo=\"value\",\n            marker=dict(colors=colors, \n                           line=dict(color='#000000', width=2)))\nlayout=go.Layout(title=\"Accepting vs not accepting online orders\",width=500,height=500)\nfig=go.Figure(data=[trace],layout=layout)\npy.iplot(fig, filename='pie_chart_subplots')","68da8f2e":"x=dataset['book_table'].value_counts()\ncolors = ['Blue', '#E1396C']\n\ntrace=go.Pie(labels=x.index,values=x,textinfo=\"value\",\n            marker=dict(colors=colors, \n                           line=dict(color='#000000', width=2)))\nlayout=go.Layout(title=\"booking vs not booking tables online\",width=500,height=500)\nfig=go.Figure(data=[trace],layout=layout)\npy.iplot(fig, filename='pie_chart_subplots')","6901741d":"plt.figure(figsize=(15,7))\nchains=zomato['name'].value_counts()[:20]\nsns.barplot(x=chains,y=chains.index,palette='Set1')\nplt.title(\"Most famous restaurant chains in Bangaluru\",size=20,pad=20)\nplt.xlabel(\"Number of outlets\",size=15)","265a8af5":"plt.figure(figsize=(10,10))\nrestaurantTypeCount=zomato['rest_type'].value_counts().sort_values(ascending=True)\nslices=[restaurantTypeCount[0],\n        restaurantTypeCount[1],\n        restaurantTypeCount[2],\n        restaurantTypeCount[3],\n        restaurantTypeCount[4],\n        restaurantTypeCount[5],\n        restaurantTypeCount[6],\n        restaurantTypeCount[7],\n        restaurantTypeCount[8]]\nlabels=['Pubs and bars','Buffet','Drinks & nightlife','Cafes','Desserts','Dine-out','Delivery ','Quick Bites','Bakery']\ncolors = ['#3333cc','#ffff1a','#ff3333','#c2c2d6','#6699ff','#c4ff4d','#339933','pink','orange']\nplt.pie(slices,colors=colors, labels=labels, autopct='%1.0f%%', pctdistance=.5, labeldistance=1.2,shadow=True)\nfig = plt.gcf()\nplt.title(\"Percentage of Restaurants according to their type\", bbox={'facecolor':'2', 'pad':2})","f3282e59":"fig = plt.figure(figsize=(17,5))\nrest = sns.countplot(x=\"rest_type\",data=zomato, palette = \"Set1\")\nrest.set_xticklabels(rest.get_xticklabels(), rotation=90, ha=\"right\")\nplt.ylabel(\"Frequency\",size=15)\nplt.xlabel(\"Restaurant type\",size=15)\nrest \nplt.title('Restaurant types',fontsize = 20 ,pad=20)","2be9201f":"fig, ax = plt.subplots(figsize=[15,7])\nsns.distplot(zomato_en['approx_cost_for_2_people'],color=\"magenta\")\nax.set_title('Approx cost for two people distribution',size=20,pad=15)\nplt.xlabel('Approx cost for two people',size = 15)\nplt.ylabel('Percentage of restaurants',size = 15)","333a7745":"plt.figure(figsize=(12,7))\npreds_rf = RForest.predict(x_test)\nplt.scatter(y_test,x_test.iloc[:,2],color=\"red\")\nplt.title(\"True rate vs Predicted rate\",size=20,pad=15)\nplt.xlabel('Rating',size = 15)\nplt.ylabel('Frequency',size = 15)\nplt.scatter(preds_rf,x_test.iloc[:,2],color=\"blue\")","ccc50132":"plt.xkcd(False)\nfig = plt.figure(figsize=(15,7))\nax1 = fig.add_subplot(1,2,1)\nax2 = fig.add_subplot(1,2,2)\n\n\n#BIGGEST CHAIN RESTAURANTS (top 10)\nnames,count = [],[]\ntop_ten_by_numbers = zomato['name'].value_counts().to_frame()[:10]\nfor index,row in top_ten_by_numbers.iterrows():\n    names.append(index)\n    count.append(row.values[0])\n\n# ax1.barh(names,count) \nsns.barplot(count, names, palette=\"Blues_d\",ax=ax1)   #Seaborn ! :D\nax1.set_xlabel(\"No. of restaurants\")\nax1.set_title(\"BIGGEST CHAIN RESTAURANTS. (TOP 10)\")\n\n#TOP 10 BEST CHAIN RESTAURANT (top 10)  (Rated 4.8 and above)\nname_by_rate,count_by_rate=[],[]\ntop_ten_by_rate_and_number = zomato[zomato['rate']>=4.8]['name'].value_counts().to_frame()[:10]\nfor index,row in top_ten_by_rate_and_number.iterrows():\n    name_by_rate.append(index)\n    count_by_rate.append(row.values[0])\n\n# ax2.barh(name_by_rate,count_by_rate)  \nax2 = sns.barplot(count_by_rate,name_by_rate,palette=\"Reds_d\",ax=ax2) \nax2.set_xlabel(\"No. of restaurants\")\nax2.set_title(\"BEST RATED CHAIN RESTAURANTS. (TOP 10)\")\nplt.tight_layout()\nplt.show()","46f796e6":"plt.figure(figsize=(15,8))\nrating = zomato['rate']\nplt.hist(rating,bins=20,color=\"red\")\nplt.title('Restaurant rating distribution', size = 20, pad = 15)\nplt.xlabel('Rating',size = 15)\nplt.ylabel('No. of restaurants',size = 15)","33aa7354":"plt.figure(figsize=(15,8))\nsns.violinplot(zomato.approx_cost_for_2_people)\nplt.title('Approx cost for 2 people distribution', size = 20, pad = 15)\nplt.xlabel('Approx cost for 2 people',size = 15)\nplt.ylabel('Density',size = 15)","7b761b05":"plt.figure(figsize=(15,8))\ncuisines=zomato['cuisines'].value_counts()[:15]\nsns.barplot(cuisines,cuisines.index)\nplt.title('Most popular cuisines of Bangalore', size = 20, pad = 15)\nplt.xlabel('No. of restaurants',size = 15)","818ec003":"plt.xkcd(False)\ndummy_2 = zomato.copy()\n#create a new column 'booking_ordering', which basically tells whether a restaurant allows or doesn't allow, booking or online ordering.\ndummy_2['booking_ordering']='None'  \n\nfor index,row in dummy_2.iterrows():\n    if row['online_order'] == \"Yes\" and row['book_table']=='Yes':\n        dummy_2.at[index,'booking_ordering'] = 'booking Available, online Available'      \n    elif row['online_order'] == \"Yes\" and row['book_table']=='No':\n        dummy_2.at[index,'booking_ordering'] = 'booking Unavailable, online Available'\n    elif row['online_order'] == \"No\" and row['book_table']=='Yes':\n        dummy_2.at[index,'booking_ordering'] = 'booking Available, online Unavailable'\n    elif row['online_order'] == \"No\" and row['book_table']=='No':\n        dummy_2.at[index,'booking_ordering'] = 'booking Unavailable, online Unavailable'\n\ndummy_3 = dummy_2[['booking_ordering','rate']]\n\n#Plot\nfig = plt.figure(figsize=(10,10))\nax1 = fig.add_subplot(1,1,1)\nsns.countplot(data=dummy_3,x='rate',hue='booking_ordering',ax =ax1,palette='tab10')\nplt.legend(loc='upper left')\nplt.setp(ax1.get_legend().get_texts(), fontsize='22') # for legend text\nplt.setp(ax1.get_legend().get_title(), fontsize='22') # for legend title\nplt.tight_layout()\nplt.show()","6337d514":"here we created a new column 'booking_ordering', where we got four conditions under which we see relationship between count of restaurants and ratings.","f65b05cc":"# 8. Distribution of restaurants according to approx cost for two people","c1bdd804":"Converting \"votes\" and \"approx_cost_for_2_people\" into numeric(int)\n\n\"votes\" and \"approx_cost_for_2_people\" have values like 1,000. So we will change them into pure numeric values.\nFor this, we will use the lambda function","39727942":"# 10. Biggest chain restaurant vs. Best rated chain restaurants","0ba3a643":"# Linear Relationship between rate and votes shown below:","7d7c0885":"# 11. Restaurant rating distribution","8e49dde8":"# Complete Data Visualization and EDA for Zomato Restaurants in Bangalore City","46f7212b":"# Let's start a Regression part","4870a7f1":"# Data Preprocessing","7a31100d":"1. Heat Map\n2. Linear Regression\n3. Decision Tree Regression\n4. Random Forrest Regression","3c149d11":"# Applying LINEAR REGRESSION Model","d8f3dff9":"import the dataset","64a271ea":"# 6. Percentage of restaurants according to their types","09430851":"**hence we found far better result from decision tree and random forest regression rather than linear regression model.**","3f0dc540":"now filling the null vaslues in the columns \"rate\" and \"approx_cost_for_2_people\" with their mean.","dca054d0":"# 14. To see, Restaurant allows or doesn't allow, booking or online ordering.","9c984614":"# 12. Approx cost for 2 people distribution","aea52d48":"Now we will Label Encode the input variable columns into 0,1,2...","116f9407":"# Applying DECITION TREE REGRESSION Model","b3d40fa7":"Let's count missing values for different column","3c36f837":"We remove the restaurent datas which has rate='NEW'","7710300b":"# 3. Number of restaurants taking online order or not","eff38c0e":"The highest correlation is between name and address which is 0.63.","a1e67b16":"# Linear Relationship between rates and approx_cost_for_2_people shown below","59687436":"Now we will remove '\/5' from rate","2ea21b88":"# 2. No. of restaurants in a particular location","b1b02535":"# Checking for correlation among all the column(inputs)","fe9d050d":"here, we are using plotly to show the result.","78fb99cd":"# 13. Most popular cuisines of Bangalore","67f85c95":"# 1. Visualizing Linear relationship ","021e09b5":"Renaming \"approx_cost(for two people)\" ,listed_in(type) and listed_in(city) as they have multiple data-types","a77e3dc4":"# Splitting dataset into train & test","7a679e85":"# 5. Most famous restaurant chains in Bengaluru","3bdfb4fa":"# 7. Frequency of different types of restaurants","ed686392":"# 9. Showing True rate vs Predicted rate","e97603bc":"# Applying RANDOM FOREST REGRESSION Model","cf9e79ba":"Import the libraries","af1969b5":"here, we are using plotly to show the result.","0c7469ad":"# Data vizualisation and Expolatory Data Analysis for the given data","a8b2250f":"# 4. Frequency of restaurants allowing booking table or not","491abc0f":"From above, it is found that the column \"dish_liked\" has more than 50% values missing\n\nDropping the column \"dish_liked\" \"url\",\"phone\"  and saving the new dataset as \"zomato\"","ef12a2a8":"here we see that, lmplot() function in seaborn is used to visualize a linear relationship as determined through regression."}}