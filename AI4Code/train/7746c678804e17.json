{"cell_type":{"e902ce4e":"code","5247a851":"code","3b265417":"code","8d942aa3":"code","86be51dc":"code","38341698":"code","38ffa7f9":"code","f7736e12":"code","e32b2e6d":"code","d0a6a564":"code","1790afa3":"code","4cdf6215":"code","0bc5eedf":"code","f3423106":"code","7d33c85e":"code","8e2a6e23":"code","32d2ac5e":"code","3738c438":"code","1bf64f1b":"code","c2b896ae":"code","1a32dc6f":"code","09fec48b":"code","c5c4856c":"code","05cefeaa":"code","453cf4e2":"code","c9a0c8bd":"code","4154b8e9":"code","9762a1ef":"code","7808c7c0":"code","ea9b3c4d":"code","ae38e662":"code","f11efbcb":"code","29c896d8":"code","e1f88f0c":"code","bf12038c":"code","c820e2d7":"code","c8e3967b":"code","3e2caa9a":"code","ff408aa1":"code","16e0dd28":"code","38e9de7a":"code","7de9e9d4":"code","b2421483":"code","103679f2":"code","aee1fb52":"code","c93a53f0":"code","f13dd3be":"code","018fbd45":"code","89ce08bd":"code","cee75dc8":"code","751e6175":"code","5f262d60":"code","14104c9a":"code","2ca753fc":"code","49fe3fd6":"code","6e06c3d1":"code","e7db3acb":"code","768a9496":"code","4cc2083a":"code","651fe3cc":"code","b085cf70":"code","3ea983d8":"code","2ceb432e":"code","b32b679d":"code","21b36b8a":"code","dae2c497":"code","434e9742":"code","d53c0973":"code","ad00d465":"code","af721d50":"markdown","4e5e81cf":"markdown","5fab6dbc":"markdown","587ffdf3":"markdown","e8b8a0c7":"markdown","096adfec":"markdown","629393c8":"markdown","bde03102":"markdown","5e3c1c44":"markdown","ad704e0f":"markdown","b8a9bca2":"markdown","a0d51100":"markdown","eadc5535":"markdown"},"source":{"e902ce4e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport scipy.stats as s\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","5247a851":"data=pd.read_csv('\/kaggle\/input\/breast-cancer-wisconsin-data\/data.csv')","3b265417":"data","8d942aa3":"data.drop([data.columns[0],data.columns[32]],axis=1,inplace=True)","86be51dc":"data","38341698":"data.shape","38ffa7f9":"data.info()","f7736e12":"data.describe(include='all').T","e32b2e6d":"labels=np.array(data['diagnosis']).reshape(data['diagnosis'].shape[0],1)","d0a6a564":"labels","1790afa3":"x=np.array(data.iloc[:,1:])","4cdf6215":"x.shape","0bc5eedf":"mu=np.mean(x,axis=0)","f3423106":"mu=mu.reshape(-1,mu.shape[0])","7d33c85e":"mu.shape","8e2a6e23":"x_dash=x-mu","32d2ac5e":"x_dash.shape","3738c438":"sigma_hat=(1\/data.shape[0])*np.matmul(x_dash.T,x_dash)","1bf64f1b":"sigma_hat.shape","c2b896ae":"sigma_hat_decompose=np.linalg.svd(sigma_hat)","1a32dc6f":"len(sigma_hat_decompose)","09fec48b":"Q=sigma_hat_decompose[0]","c5c4856c":"lmda=sigma_hat_decompose[1]","05cefeaa":"lmda","453cf4e2":"Q_tilda=Q[:,0:15]","c9a0c8bd":"Q_tilda.shape","4154b8e9":"x_new=np.matmul(x_dash,Q_tilda)","9762a1ef":"x_new.shape","7808c7c0":"new_data=pd.DataFrame(data=x_new)","ea9b3c4d":"new_data['diagnosis']=labels","ae38e662":"new_data","f11efbcb":"new_data[new_data['diagnosis']=='B'].shape","29c896d8":"new_data[new_data['diagnosis']=='M'].shape","e1f88f0c":"training_data_len=int(0.7*new_data.shape[0])","bf12038c":"training_data_len","c820e2d7":"benign_training_data=new_data[new_data['diagnosis']=='B'].iloc[0:training_data_len\/\/2]\nmalingnant_training_data=new_data[new_data['diagnosis']=='M'].iloc[0:training_data_len\/\/2]","c8e3967b":"benign_training_data.shape","3e2caa9a":"malingnant_training_data.shape","ff408aa1":"training_data=pd.concat([benign_training_data,malingnant_training_data])","16e0dd28":"training_data","38e9de7a":"cv_data_len= int(0.2*new_data.shape[0])","7de9e9d4":"cv_data_len","b2421483":"benign_remaining_data=new_data[new_data['diagnosis']=='B'].iloc[training_data_len\/\/2:]\nmalingnant_remaining_data=new_data[new_data['diagnosis']=='M'].iloc[training_data_len\/\/2:]","103679f2":"benign_remaining_data.shape","aee1fb52":"malingnant_remaining_data.shape","c93a53f0":"remaining_data=pd.concat([benign_remaining_data,malingnant_remaining_data])","f13dd3be":"remaining_data.shape","018fbd45":"cv_data=remaining_data.iloc[0:cv_data_len]\ntesting_data=remaining_data.iloc[cv_data_len:]","89ce08bd":"testing_data.shape","cee75dc8":"mu_hat_m=np.array(training_data[training_data['diagnosis']=='M'].iloc[:,0:15].mean())\nsigma_hat_m=np.array(training_data[training_data['diagnosis']=='M'].iloc[:,0:15].cov())","751e6175":"malingnant_prior=training_data[training_data['diagnosis']=='M'].shape[0]\/training_data.shape[0]","5f262d60":"mu_hat_b=np.array(training_data[training_data['diagnosis']=='B'].iloc[:,0:15].mean())\nsigma_hat_b=np.array(training_data[training_data['diagnosis']=='B'].iloc[:,0:15].cov())","14104c9a":"benign_prior=training_data[training_data['diagnosis']=='B'].shape[0]\/training_data.shape[0]","2ca753fc":"def mock_test(data):\n    inputs=np.array(data.iloc[:,0:15])\n    posterior_m=s.multivariate_normal.pdf(inputs,mu_hat_m,sigma_hat_m)*malingnant_prior\n    posterior_b=s.multivariate_normal.pdf(inputs,mu_hat_b,sigma_hat_b)*benign_prior\n    boolean_mask=posterior_m>posterior_b\n    predicted_category=pd.Series(boolean_mask)\n    predicted_category.replace(to_replace=[False,True],value=['B','M'],inplace=True)\n    return np.array(predicted_category)","49fe3fd6":"cv_results=mock_test(cv_data)","6e06c3d1":"actual_results=np.array(cv_data['diagnosis'])","e7db3acb":"actual_results","768a9496":"boolean_mask=cv_results==actual_results","4cc2083a":"boolean_mask","651fe3cc":"np.count_nonzero(boolean_mask)","b085cf70":"cv_accuracy=np.count_nonzero(boolean_mask)\/boolean_mask.shape[0]","3ea983d8":"cv_accuracy","2ceb432e":"testing_results=mock_test(testing_data)","b32b679d":"testing_results.shape","21b36b8a":"testing_results","dae2c497":"actual_results=np.array(testing_data['diagnosis'])","434e9742":"actual_results","d53c0973":"testing_accuracy=np.count_nonzero(testing_results==actual_results)\/actual_results.shape[0]","ad00d465":"testing_accuracy","af721d50":"# Test Accuracy","4e5e81cf":"# Test data evaluate","5fab6dbc":"**Prior Probability of Benign**\n\\begin{equation}\nP(Diagnosis = B | radius mean = x) = P(radius mean = x | Diagnosis = B) P(texturemean = y| Diagnosis = B) P(Diagnosis = B)\n\\end{equation}","587ffdf3":"**Prior Probability of Malingnant**\n\\begin{equation}\nP(Diagnosis = M | radius mean = x) = \nP(radius mean = x | Diagnosis = M) P(texturemean = y| Diagnosis = M) P(Diagnosis = M)\n\\end{equation}","e8b8a0c7":"# Obtain Training data","096adfec":"# CV data evaluate","629393c8":"# CV Accuracy","bde03102":"# PCA (Eigen Value Decomposition)","5e3c1c44":"**Now, in order to evaluate the likelihood probability** P(radiusmean = x | Diagnosis = M) P(texturemean = y | Diagnosis = M) which is given by Multivariate Joint Gauss\n\\begin{equation}\nP(radiusmean = x | Diagnosis = M)P(texturemean = y | Diagnosis = M) = \\left(\\frac{1}{\\sqrt{2\\pi}\\hat{\\sigma_\\text{rM}}}e^{-\\frac{(x-\\hat{\\mu_\\text{rM}})^2}{2\\hat{\\sigma_\\text{rM}^2}}}\\right)\\left(\\frac{1}{\\sqrt{2\\pi}\\hat{\\sigma_\\text{tM}}}e^{-\\frac{(y-\\hat{\\mu_\\text{tM}})^2}{2\\hat{\\sigma_\\text{tM}^2}}}\\right)\n\\end{equation}","ad704e0f":"# Obtain CV data","b8a9bca2":" \\begin{equation}\nP(radiusmean = x | Diagnosis = B)P(texturemean = y | Diagnosis = B) = \\left(\\frac{1}{\\sqrt{2\\pi}\\hat{\\sigma_\\text{rB}}}e^{-\\frac{(x-\\hat{\\mu_\\text{rB}})^2}{2\\hat{\\sigma_\\text{rB}^2}}}\\right)\\left(\\frac{1}{\\sqrt{2\\pi}\\hat{\\sigma_\\text{tB}}}e^{-\\frac{(y-\\hat{\\mu_\\text{tB}})^2}{2\\hat{\\sigma_\\text{tB}^2}}}\\right)\n\\end{equation}","a0d51100":"# Finish","eadc5535":"# Gaussian Naive Bayes"}}