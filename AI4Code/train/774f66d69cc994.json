{"cell_type":{"6e2db773":"code","11c0d6fb":"code","28d43069":"code","f3ae01fb":"code","880f430f":"code","47b0f845":"code","16b627ea":"code","ab5548fa":"code","81981740":"code","35bac0a6":"code","8caf2cac":"code","50f16cc6":"code","d1a6944d":"code","3fe436e4":"code","72f58bcc":"code","944891ef":"code","4cd7aaeb":"code","992fa7f4":"code","8f58922e":"code","5f5d269a":"code","3227decd":"code","8cd2c08e":"code","7ba25396":"code","ba98242c":"code","f4e22710":"code","1fa346b4":"code","897a9b96":"code","9e3ce516":"code","f8d325de":"code","bb961710":"code","20f8fc5c":"code","60949acc":"code","311ca9bc":"code","0a834876":"code","f6152fc5":"code","98a493b5":"code","49964b16":"code","03650819":"code","17e846ca":"code","50f29f31":"code","a425085b":"code","e556ea73":"code","ad14d11a":"code","31440699":"code","1c63c6ef":"code","daeccaba":"code","1ea9c6bd":"code","291a4f8a":"code","859bd703":"code","44f92559":"code","2c72d180":"code","b61056db":"code","1b91f788":"code","dfa88295":"code","4fcaee7f":"code","775bdeea":"code","70fc0fc7":"code","07f4fabd":"code","69769bc5":"code","bac17d2a":"code","2b3f9b17":"code","5113aecb":"code","00a074e1":"code","95842c7a":"code","e63bea77":"code","1d825244":"code","6a77e4bc":"code","1a5fed39":"code","e50b99ab":"code","38b4af9c":"code","3c6e3f7a":"code","a3e7072c":"code","0ecbbe0d":"code","660301e1":"code","99ea30ec":"markdown","aa4dda86":"markdown","83190a03":"markdown","c3bc86b9":"markdown","a5b28fff":"markdown","70323a21":"markdown","e6d509f4":"markdown","707f921b":"markdown","d77145ae":"markdown","4d423cdd":"markdown","fe9b71dd":"markdown","1fb4420b":"markdown","092db6e5":"markdown","457f48c0":"markdown","8b743e0d":"markdown","c9f968de":"markdown","d033d7e7":"markdown","a603817c":"markdown","b8d6f5e5":"markdown","6bfe4c69":"markdown","726f826e":"markdown","632bad47":"markdown","11380de8":"markdown","b8d26c84":"markdown","53b58606":"markdown","4b409948":"markdown","462b75f9":"markdown","a70feb26":"markdown","05138a17":"markdown","fd154102":"markdown","0acdbfe5":"markdown","f5f34a0a":"markdown","678a7518":"markdown","9d45310c":"markdown","3f591e6f":"markdown","a2dd67a8":"markdown","e2342088":"markdown","588a78a7":"markdown","c46d3ba7":"markdown","ba9f534c":"markdown","8cf40993":"markdown","4754278f":"markdown","4d711498":"markdown","3e5854ff":"markdown","4f0fd73c":"markdown","ef80ae2c":"markdown","579940dd":"markdown","f7c99ce8":"markdown","c1e8c619":"markdown","cb066790":"markdown","91cabc42":"markdown","e835b0a4":"markdown","c1207a57":"markdown","c7cbfb29":"markdown","deae1f52":"markdown","c25ed954":"markdown","d8f56972":"markdown","ad9af658":"markdown","af22ddc4":"markdown"},"source":{"6e2db773":"import pandas as pd\nimport numpy as np\nimport missingno as msno\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\nimport warnings\nwarnings.filterwarnings('ignore')","11c0d6fb":"from sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import LabelEncoder\n\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.ensemble import AdaBoostClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.ensemble import ExtraTreesClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom xgboost import XGBClassifier\nfrom catboost import CatBoostClassifier\nfrom sklearn import metrics\nfrom sklearn.metrics import roc_curve\nfrom sklearn.metrics import recall_score, confusion_matrix, precision_score, f1_score, accuracy_score, classification_report","28d43069":"#loading data\ndf = pd.read_csv('..\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv')","f3ae01fb":"df.head()","880f430f":"df.shape","47b0f845":"df.info()","16b627ea":"df.columns.values","ab5548fa":"df.dtypes","81981740":"# Visualize missing values as a matrix\nmsno.matrix(df);","35bac0a6":"df = df.drop(['customerID'], axis = 1)\ndf.head()","8caf2cac":"df['TotalCharges'] = pd.to_numeric(df.TotalCharges, errors='coerce')\ndf.isnull().sum()","50f16cc6":"df[np.isnan(df['TotalCharges'])]","d1a6944d":"df[df['tenure'] == 0].index","3fe436e4":"df.drop(labels=df[df['tenure'] == 0].index, axis=0, inplace=True)\ndf[df['tenure'] == 0].index","72f58bcc":"df.fillna(df[\"TotalCharges\"].mean())","944891ef":"df.isnull().sum()","4cd7aaeb":"df[\"SeniorCitizen\"]= df[\"SeniorCitizen\"].map({0: \"No\", 1: \"Yes\"})\ndf.head()","992fa7f4":"df[\"InternetService\"].describe(include=['object', 'bool'])","8f58922e":"numerical_cols = ['tenure', 'MonthlyCharges', 'TotalCharges']\ndf[numerical_cols].describe()","5f5d269a":"g_labels = ['Male', 'Female']\nc_labels = ['No', 'Yes']\n# Create subplots: use 'domain' type for Pie subplot\nfig = make_subplots(rows=1, cols=2, specs=[[{'type':'domain'}, {'type':'domain'}]])\nfig.add_trace(go.Pie(labels=g_labels, values=df['gender'].value_counts(), name=\"Gender\"),\n              1, 1)\nfig.add_trace(go.Pie(labels=c_labels, values=df['Churn'].value_counts(), name=\"Churn\"),\n              1, 2)\n\n# Use `hole` to create a donut-like pie chart\nfig.update_traces(hole=.4, hoverinfo=\"label+percent+name\", textfont_size=16)\n\nfig.update_layout(\n    title_text=\"Gender and Churn Distributions\",\n    # Add annotations in the center of the donut pies.\n    annotations=[dict(text='Gender', x=0.16, y=0.5, font_size=20, showarrow=False),\n                 dict(text='Churn', x=0.84, y=0.5, font_size=20, showarrow=False)])\nfig.show()","3227decd":"df[\"Churn\"][df[\"Churn\"]==\"No\"].groupby(by=df[\"gender\"]).count()","8cd2c08e":"df[\"Churn\"][df[\"Churn\"]==\"Yes\"].groupby(by=df[\"gender\"]).count()","7ba25396":"plt.figure(figsize=(6, 6))\nlabels =[\"Churn: Yes\",\"Churn:No\"]\nvalues = [1869,5163]\nlabels_gender = [\"F\",\"M\",\"F\",\"M\"]\nsizes_gender = [939,930 , 2544,2619]\ncolors = ['#ff6666', '#66b3ff']\ncolors_gender = ['#c2c2f0','#ffb3e6', '#c2c2f0','#ffb3e6']\nexplode = (0.3,0.3) \nexplode_gender = (0.1,0.1,0.1,0.1)\ntextprops = {\"fontsize\":15}\n#Plot\nplt.pie(values, labels=labels,autopct='%1.1f%%',pctdistance=1.08, labeldistance=0.8,colors=colors, startangle=90,frame=True, explode=explode,radius=10, textprops =textprops, counterclock = True, )\nplt.pie(sizes_gender,labels=labels_gender,colors=colors_gender,startangle=90, explode=explode_gender,radius=7, textprops =textprops, counterclock = True, )\n#Draw circle\ncentre_circle = plt.Circle((0,0),5,color='black', fc='white',linewidth=0)\nfig = plt.gcf()\nfig.gca().add_artist(centre_circle)\n\nplt.title('Churn Distribution w.r.t Gender: Male(M), Female(F)', fontsize=15, y=1.1)\n\n# show plot \n \nplt.axis('equal')\nplt.tight_layout()\nplt.show()","ba98242c":"fig = px.histogram(df, x=\"Churn\", color=\"Contract\", barmode=\"group\", title=\"<b>Customer contract distribution<b>\")\nfig.update_layout(width=700, height=500, bargap=0.1)\nfig.show()","f4e22710":"labels = df['PaymentMethod'].unique()\nvalues = df['PaymentMethod'].value_counts()\n\nfig = go.Figure(data=[go.Pie(labels=labels, values=values, hole=.3)])\nfig.update_layout(title_text=\"<b>Payment Method Distribution<\/b>\")\nfig.show()","1fa346b4":"fig = px.histogram(df, x=\"Churn\", color=\"PaymentMethod\", title=\"<b>Customer Payment Method distribution w.r.t. Churn<\/b>\")\nfig.update_layout(width=700, height=500, bargap=0.1)\nfig.show()","897a9b96":"df[\"InternetService\"].unique()","9e3ce516":" df[df[\"gender\"]==\"Male\"][[\"InternetService\", \"Churn\"]].value_counts()","f8d325de":"df[df[\"gender\"]==\"Female\"][[\"InternetService\", \"Churn\"]].value_counts()","bb961710":"fig = go.Figure()\n\nfig.add_trace(go.Bar(\n  x = [['Churn:No', 'Churn:No', 'Churn:Yes', 'Churn:Yes'],\n       [\"Female\", \"Male\", \"Female\", \"Male\"]],\n  y = [965, 992, 219, 240],\n  name = 'DSL',\n))\n\nfig.add_trace(go.Bar(\n  x = [['Churn:No', 'Churn:No', 'Churn:Yes', 'Churn:Yes'],\n       [\"Female\", \"Male\", \"Female\", \"Male\"]],\n  y = [889, 910, 664, 633],\n  name = 'Fiber optic',\n))\n\nfig.add_trace(go.Bar(\n  x = [['Churn:No', 'Churn:No', 'Churn:Yes', 'Churn:Yes'],\n       [\"Female\", \"Male\", \"Female\", \"Male\"]],\n  y = [690, 717, 56, 57],\n  name = 'No Internet',\n))\n\nfig.update_layout(title_text=\"<b>Churn Distribution w.r.t. Internet Service and Gender<\/b>\")\n\nfig.show()","20f8fc5c":"color_map = {\"Yes\": \"#FF97FF\", \"No\": \"#AB63FA\"}\nfig = px.histogram(df, x=\"Churn\", color=\"Dependents\", barmode=\"group\", title=\"<b>Dependents distribution<\/b>\", color_discrete_map=color_map)\nfig.update_layout(width=700, height=500, bargap=0.1)\nfig.show()","60949acc":"color_map = {\"Yes\": '#FFA15A', \"No\": '#00CC96'}\nfig = px.histogram(df, x=\"Churn\", color=\"Partner\", barmode=\"group\", title=\"<b>Chrun distribution w.r.t. Partners<\/b>\", color_discrete_map=color_map)\nfig.update_layout(width=700, height=500, bargap=0.1)\nfig.show()","311ca9bc":"color_map = {\"Yes\": '#00CC96', \"No\": '#B6E880'}\nfig = px.histogram(df, x=\"Churn\", color=\"SeniorCitizen\", title=\"<b>Chrun distribution w.r.t. Senior Citizen<\/b>\", color_discrete_map=color_map)\nfig.update_layout(width=700, height=500, bargap=0.1)\nfig.show()","0a834876":"color_map = {\"Yes\": \"#FF97FF\", \"No\": \"#AB63FA\"}\nfig = px.histogram(df, x=\"Churn\", color=\"OnlineSecurity\", barmode=\"group\", title=\"<b>Churn w.r.t Online Security<\/b>\", color_discrete_map=color_map)\nfig.update_layout(width=700, height=500, bargap=0.1)\nfig.show()","f6152fc5":"color_map = {\"Yes\": '#FFA15A', \"No\": '#00CC96'}\nfig = px.histogram(df, x=\"Churn\", color=\"PaperlessBilling\",  title=\"<b>Chrun distribution w.r.t. Paperless Billing<\/b>\", color_discrete_map=color_map)\nfig.update_layout(width=700, height=500, bargap=0.1)\nfig.show()","98a493b5":"fig = px.histogram(df, x=\"Churn\", color=\"TechSupport\",barmode=\"group\",  title=\"<b>Chrun distribution w.r.t. TechSupport<\/b>\")\nfig.update_layout(width=700, height=500, bargap=0.1)\nfig.show()","49964b16":"color_map = {\"Yes\": '#00CC96', \"No\": '#B6E880'}\nfig = px.histogram(df, x=\"Churn\", color=\"PhoneService\", title=\"<b>Chrun distribution w.r.t. Phone Service<\/b>\", color_discrete_map=color_map)\nfig.update_layout(width=700, height=500, bargap=0.1)\nfig.show()","03650819":"sns.set_context(\"paper\",font_scale=1.1)\nax = sns.kdeplot(df.MonthlyCharges[(df[\"Churn\"] == 'No') ],\n                color=\"Red\", shade = True);\nax = sns.kdeplot(df.MonthlyCharges[(df[\"Churn\"] == 'Yes') ],\n                ax =ax, color=\"Blue\", shade= True);\nax.legend([\"Not Churn\",\"Churn\"],loc='upper right');\nax.set_ylabel('Density');\nax.set_xlabel('Monthly Charges');\nax.set_title('Distribution of monthly charges by churn');\n","17e846ca":"ax = sns.kdeplot(df.TotalCharges[(df[\"Churn\"] == 'No') ],\n                color=\"Gold\", shade = True);\nax = sns.kdeplot(df.TotalCharges[(df[\"Churn\"] == 'Yes') ],\n                ax =ax, color=\"Green\", shade= True);\nax.legend([\"Not Chu0rn\",\"Churn\"],loc='upper right');\nax.set_ylabel('Density');\nax.set_xlabel('Total Charges');\nax.set_title('Distribution of total charges by churn');","50f29f31":"fig = px.box(df, x='Churn', y = 'tenure')\n\n# Update yaxis properties\nfig.update_yaxes(title_text='Tenure (Months)', row=1, col=1)\n# Update xaxis properties\nfig.update_xaxes(title_text='Churn', row=1, col=1)\n\n# Update size and title\nfig.update_layout(autosize=True, width=750, height=600,\n    title_font=dict(size=25, family='Courier'),\n    title='<b>Tenure vs Churn<\/b>',\n)\n\nfig.show()\n","a425085b":"plt.figure(figsize=(25, 10))\n\ncorr = df.apply(lambda x: pd.factorize(x)[0]).corr()\n\nmask = np.triu(np.ones_like(corr, dtype=bool))\n\nax = sns.heatmap(corr, mask=mask, xticklabels=corr.columns, yticklabels=corr.columns, annot=True, linewidths=.2, cmap='coolwarm', vmin=-1, vmax=1)","e556ea73":"def object_to_int(dataframe_series):\n    if dataframe_series.dtype=='object':\n        dataframe_series = LabelEncoder().fit_transform(dataframe_series)\n    return dataframe_series","ad14d11a":"df = df.apply(lambda x: object_to_int(x))\ndf.head()","31440699":"plt.figure(figsize=(14,7))\ndf.corr()['Churn'].sort_values(ascending = False)","1c63c6ef":"X = df.drop(columns = ['Churn'])\ny = df['Churn'].values","daeccaba":"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size = 0.30, random_state = 40, stratify=y)","1ea9c6bd":"def distplot(feature, frame, color='r'):\n    plt.figure(figsize=(8,3))\n    plt.title(\"Distribution for {}\".format(feature))\n    ax = sns.distplot(frame[feature], color= color)","291a4f8a":"num_cols = [\"tenure\", 'MonthlyCharges', 'TotalCharges']\nfor feat in num_cols: distplot(feat, df)","859bd703":"df_std = pd.DataFrame(StandardScaler().fit_transform(df[num_cols].astype('float64')),\n                       columns=num_cols)\nfor feat in numerical_cols: distplot(feat, df_std, color='c')","44f92559":"# Divide the columns into 3 categories, one ofor standardisation, one for label encoding and one for one hot encoding\n\ncat_cols_ohe =['PaymentMethod', 'Contract', 'InternetService'] # those that need one-hot encoding\ncat_cols_le = list(set(X_train.columns)- set(num_cols) - set(cat_cols_ohe)) #those that need label encoding","2c72d180":"scaler= StandardScaler()\n\nX_train[num_cols] = scaler.fit_transform(X_train[num_cols])\nX_test[num_cols] = scaler.transform(X_test[num_cols])","b61056db":"knn_model = KNeighborsClassifier(n_neighbors = 11) \nknn_model.fit(X_train,y_train)\npredicted_y = knn_model.predict(X_test)\naccuracy_knn = knn_model.score(X_test,y_test)\nprint(\"KNN accuracy:\",accuracy_knn)","1b91f788":"print(classification_report(y_test, predicted_y))","dfa88295":"svc_model = SVC(random_state = 1)\nsvc_model.fit(X_train,y_train)\npredict_y = svc_model.predict(X_test)\naccuracy_svc = svc_model.score(X_test,y_test)\nprint(\"SVM accuracy is :\",accuracy_svc)","4fcaee7f":"print(classification_report(y_test, predict_y))","775bdeea":"model_rf = RandomForestClassifier(n_estimators=500 , oob_score = True, n_jobs = -1,\n                                  random_state =50, max_features = \"auto\",\n                                  max_leaf_nodes = 30)\nmodel_rf.fit(X_train, y_train)\n\n# Make predictions\nprediction_test = model_rf.predict(X_test)\nprint (metrics.accuracy_score(y_test, prediction_test))","70fc0fc7":"print(classification_report(y_test, prediction_test))","07f4fabd":"plt.figure(figsize=(4,3))\nsns.heatmap(confusion_matrix(y_test, prediction_test),\n                annot=True,fmt = \"d\",linecolor=\"k\",linewidths=3)\n    \nplt.title(\" RANDOM FOREST CONFUSION MATRIX\",fontsize=14)\nplt.show()","69769bc5":"y_rfpred_prob = model_rf.predict_proba(X_test)[:,1]\nfpr_rf, tpr_rf, thresholds = roc_curve(y_test, y_rfpred_prob)\nplt.plot([0, 1], [0, 1], 'k--' )\nplt.plot(fpr_rf, tpr_rf, label='Random Forest',color = \"r\")\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive Rate')\nplt.title('Random Forest ROC Curve',fontsize=16)\nplt.show();","bac17d2a":"lr_model = LogisticRegression()\nlr_model.fit(X_train,y_train)\naccuracy_lr = lr_model.score(X_test,y_test)\nprint(\"Logistic Regression accuracy is :\",accuracy_lr)","2b3f9b17":"lr_pred= lr_model.predict(X_test)\nreport = classification_report(y_test,lr_pred)\nprint(report)","5113aecb":"plt.figure(figsize=(4,3))\nsns.heatmap(confusion_matrix(y_test, lr_pred),\n                annot=True,fmt = \"d\",linecolor=\"k\",linewidths=3)\n    \nplt.title(\"LOGISTIC REGRESSION CONFUSION MATRIX\",fontsize=14)\nplt.show()","00a074e1":"y_pred_prob = lr_model.predict_proba(X_test)[:,1]\nfpr, tpr, thresholds = roc_curve(y_test, y_pred_prob)\nplt.plot([0, 1], [0, 1], 'k--' )\nplt.plot(fpr, tpr, label='Logistic Regression',color = \"r\")\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive Rate')\nplt.title('Logistic Regression ROC Curve',fontsize=16)\nplt.show();","95842c7a":"dt_model = DecisionTreeClassifier()\ndt_model.fit(X_train,y_train)\npredictdt_y = dt_model.predict(X_test)\naccuracy_dt = dt_model.score(X_test,y_test)\nprint(\"Decision Tree accuracy is :\",accuracy_dt)","e63bea77":"print(classification_report(y_test, predictdt_y))","1d825244":"a_model = AdaBoostClassifier()\na_model.fit(X_train,y_train)\na_preds = a_model.predict(X_test)\nprint(\"AdaBoost Classifier accuracy\")\nmetrics.accuracy_score(y_test, a_preds)","6a77e4bc":"print(classification_report(y_test, a_preds))","1a5fed39":"plt.figure(figsize=(4,3))\nsns.heatmap(confusion_matrix(y_test, a_preds),\n                annot=True,fmt = \"d\",linecolor=\"k\",linewidths=3)\n    \nplt.title(\"AdaBoost Classifier Confusion Matrix\",fontsize=14)\nplt.show()","e50b99ab":"gb = GradientBoostingClassifier()\ngb.fit(X_train, y_train)\ngb_pred = gb.predict(X_test)\nprint(\"Gradient Boosting Classifier\", accuracy_score(y_test, gb_pred))","38b4af9c":"print(classification_report(y_test, gb_pred))","3c6e3f7a":"plt.figure(figsize=(4,3))\nsns.heatmap(confusion_matrix(y_test, gb_pred),\n                annot=True,fmt = \"d\",linecolor=\"k\",linewidths=3)\n    \nplt.title(\"Gradient Boosting Classifier Confusion Matrix\",fontsize=14)\nplt.show()","a3e7072c":"from sklearn.ensemble import VotingClassifier\nclf1 = GradientBoostingClassifier()\nclf2 = LogisticRegression()\nclf3 = AdaBoostClassifier()\neclf1 = VotingClassifier(estimators=[('gbc', clf1), ('lr', clf2), ('abc', clf3)], voting='soft')\neclf1.fit(X_train, y_train)\npredictions = eclf1.predict(X_test)\nprint(\"Final Accuracy Score \")\nprint(accuracy_score(y_test, predictions))","0ecbbe0d":"print(classification_report(y_test, predictions))","660301e1":"plt.figure(figsize=(4,3))\nsns.heatmap(confusion_matrix(y_test, predictions),\n                annot=True,fmt = \"d\",linecolor=\"k\",linewidths=3)\n    \nplt.title(\"FINAL CONFUSION MATRIX\",fontsize=14)\nplt.show()","99ea30ec":"* Customers with no TechSupport are most likely to migrate to another service provider.","aa4dda86":"<a id = \"101\" ><\/a>\n#### <b> KNN<\/b>\n<a id = \"knn\" ><\/a>","83190a03":"* On deep analysis, we can find some indirect missingness in our data (which can be in form of blankspaces). Let's see that!","c3bc86b9":"* A lot of customers choose the Fiber optic service and it's also evident that the customers who use Fiber optic have high churn rate, this might suggest a dissatisfaction with this type of internet service.\n* Customers having DSL service are majority in number and have less churn rate compared to Fibre optic service.","a5b28fff":"**<center> <span style=\"color:#0F52BA;font-family:serif; font-size:34px;\"> TELECOM CUSTOMER CHURN PREDICTION \ud83d\udcc8<\/span> <\/center>**","70323a21":"* 26.6 % of customers switched to another firm.\n* Customers are 49.5 % female and 50.5 % male.","e6d509f4":"![AI-Workbench-Predict-propensity-churn-notebook.png](attachment:8fc66a4b-838f-401e-bf6b-4577d1f313ec.png)","707f921b":"<a id = \"5\" ><\/a>\n# <span style=\"font-family:serif; font-size:28px;\"> 2. Loading libraries and data<\/span>\n<a id=\"loading\"><\/a>","d77145ae":"**The data set includes information about:**\n* **Customers who left within the last month** \u2013 the column is called Churn\n\n* **Services that each customer has signed up for** \u2013 phone, multiple lines, internet, online security, online backup, device protection, tech support, and streaming TV and movies\n\n* **Customer account information** - how long they\u2019ve been a customer, contract, payment method, paperless billing, monthly charges, and total charges\n\n* **Demographic info about customers** \u2013 gender, age range, and if they have partners and dependents","4d423cdd":"***","fe9b71dd":"* There is negligible difference in customer percentage\/ count who chnaged the service provider. Both genders behaved in similar fashion when it comes to migrating to another service provider\/firm.","1fb4420b":"<a id = \"107\" ><\/a>\n#### **Gradient Boosting Classifier**\n<a id = \"gb\" ><\/a>","092db6e5":"Decision tree gives very low score.","457f48c0":"<a id = \"1111\" ><\/a>\n#### **Splitting the data into train and test sets**\n<a id = \"Split\" ><\/a>","8b743e0d":"Each row represents a customer, each column contains customer\u2019s attributes described on the column Metadata.","c9f968de":"* Customers that doesn't have partners are more likely to churn","d033d7e7":"* Most customers churn in the absence of online security, ","a603817c":"Customer churn is definitely bad to a firm \u2019s profitability. Various strategies can be implemented to eliminate customer churn. The best way to avoid customer churn is for a company to truly know its customers. This includes identifying customers who are at risk of churning and working to improve their satisfaction. Improving customer service is, of course, at the top of the priority for tackling this issue. Building customer loyalty through relevant experiences and specialized service is another strategy to reduce customer churn. Some firms survey customers who have already churned to understand their reasons for leaving in order to adopt a proactive approach to avoiding future customer churn. ","b8d6f5e5":"<a id = \"6\" ><\/a>\n# <span style=\"font-family:serif; font-size:28px;\"> 3. Undertanding the data<\/span>\n<a id = \"Undertanding the data\" ><\/a>","6bfe4c69":"<a id = \"111\" ><\/a>\n#### **Standardizing numeric attributes**\n<a id = \"Standardizing\" ><\/a>","726f826e":"* Here we see that the TotalCharges has 11 missing values. Let's check this data.","632bad47":"<a id = \"105\" ><\/a>\n#### **Decision Tree Classifier**\n<a id = \"dtc\" ><\/a>","11380de8":"From the confusion matrix we can see that: \nThere are total 1400+149=1549 actual non-churn values and the algorithm predicts 1400 of them as non churn and 149 of them as churn.\nWhile there are 237+324=561 actual churn values and the algorithm predicts 237 of them as non churn values and 324 of them as churn values.","b8d26c84":"* Customers without dependents are more likely to churn","53b58606":"![churn 1.png](attachment:7a47ebdd-9f53-4bf0-bc99-b56b8050a874.png)","4b409948":"* Customers with Paperless Billing are most likely to churn.","462b75f9":"___","a70feb26":"* About 75% of customer with Month-to-Month Contract opted to move out as compared to 13% of customrs with One Year Contract and 3% with Two Year Contract","05138a17":"* There are no additional missing values in the Tenure column. \n\nLet's delete the rows with missing values in Tenure columns since there are only 11 rows and deleting them will not affect the data.","fd154102":"> Using this matrix we can very quickly find the pattern of missingness in the dataset. \n* From the above visualisation we can observe that it has no peculiar pattern that stands out. In fact there is no missing data.","0acdbfe5":"* Major customers who moved out were having Electronic Check as Payment Method.\n* Customers who opted for Credit-Card automatic transfer or Bank Automatic Transfer and Mailed Check as Payment Method were less likely to move out.  ","f5f34a0a":"<a id = \"106\" ><\/a>\n#### **AdaBoost Classifier**\n<a id = \"ada\" ><\/a>","678a7518":"<a id = \"1\" ><\/a>\n# <span style=\"font-family:serif; font-size:28px;\"> 1. Introduction<\/span>\n<a id = \"introduction\" ><\/a>","9d45310c":"<span style=\"color:crimson;font-family:serif; font-size:20px;\">  Please upvote if you liked the kernel! \ud83d\ude00\n    <p style=\"color:royalblue;font-family:serif; font-size:20px;\">KEEP KAGGLING!<\/p> \n<\/span>","3f591e6f":"* Customers with higher Monthly Charges are also more likely to churn","a2dd67a8":"* Very small fraction of customers don't have a phone service and out of that, 1\/3rd Customers are more likely to churn.","e2342088":"<a id = \"2\" ><\/a>\n#### <b>What is Customer Churn?<\/b>\n<span style=\"font-size:16px;\">  Customer churn is defined as when customers or subscribers discontinue doing business with a firm or service. <\/span>\n\n<span style=\"font-size:16px;\"> Customers in the telecom industry can choose from a variety of service providers and actively switch from one to the next. The telecommunications business has an annual churn rate of 15-25 percent in this highly competitive market.<\/span>\n\n<span style=\"font-size:16px;\"> Individualized customer retention is tough because most firms have a large number of customers and can't afford to devote much time to each of them. The costs would be too great, outweighing the additional revenue. However, if a corporation could forecast which customers are likely to leave ahead of time, it could focus customer retention efforts only on these \"high risk\" clients. The ultimate goal is to expand its coverage area and retrieve more\ncustomers loyalty. The core to succeed in this market lies in the customer itself. \n<\/span>\n\n<span style=\"font-size:16px;\"> Customer churn is a critical metric because it is much less expensive to retain existing customers than it is to acquire new customers.<\/span>\n\n<a id=\"churn\"><\/a>\n<a id = \"3\" ><\/a>\n\n<span style=\"font-size:16px;\"><b>To reduce customer churn, telecom companies need to predict which customers are at high risk of churn.<\/b><\/span> \n\n<span style=\"font-size:16px;\"> To detect early signs of potential churn, one must first develop a holistic view of the customers and their interactions across numerous channels, including store\/branch visits, product purchase histories, customer service calls, Web-based transactions, and social media interactions, to mention a few. <\/span> \n\n<span style=\"font-size:16px;\">As a result, by addressing churn, these businesses may not only preserve their market position, but also grow and thrive. More customers they have in their network, the lower the cost of initiation and the larger the profit. As a result, the company's key focus for success is reducing client attrition and implementing effective retention strategy. <\/span> \n<a id=\"reduce\"><\/a>\n\n<a id = \"4\" ><\/a>\n#### <b> Objectives<\/b>\nI will explore the data and try to answer some questions like:\n* What's the % of Churn Customers and customers that keep in with the active services?\n* Is there any patterns in Churn Customers based on the gender?\n* Is there any patterns\/preference in Churn Customers based on the type of service provided?\n* What's the most profitable service types?\n* Which features and services are most profitable?\n* Many more questions that will arise during the analysis\n<a id=\"objective\"><\/a>","588a78a7":"<a id = \"7\" ><\/a>\n# <span style=\"font-family:serif; font-size:28px;\"> 4. Visualize missing values <\/span>\n<a id = \"missingvalue\" ><\/a>","c46d3ba7":"# <span style=\"font-family:serif; font-size:28px;\"> Content<\/span>\n\n1. [Introduction](#1)\n    * [What is Customer Churn?](#2)\n    * [How can customer churn be reducded?](#3)\n    * [Objectives](#4)\n2. [Loading libraries and data](#5)\n3. [Undertanding the data](#6)\n4. [Visualize missing values](#7)\n5. [Data Manipulation](#8)\n6. [Data Visualization](#9)\n7. [Data Preprocessing](#10)\n   * [Standardizing numeric attributes](#111)\n8. [Machine Learning Model Evaluations and Predictions](#11)\n   * [KNN](#101)\n   * [SVC](#102)\n   * [Random Forest](#103)\n   * [Logistic Regression](#104)\n   * [Decision Tree Classifier](#105)\n   * [AdaBoost Classifier](#106)\n   * [Gradient Boosting Classifier](#107)\n   * [Voting Classifier](#108)\n\n","ba9f534c":"<a id = \"9\" ><\/a>\n# <span style=\"font-family:serif; font-size:28px;\"> 6. Data Visualization <\/span>\n<a id = \"datavisualization\" ><\/a>","8cf40993":"<center><span style=\"font-family:Palatino; font-size:22px;\"><i> Did you know that attracting a new customer costs <span style=\"color:#DC143C;\">five times<\/span> as much as keeping an existing one?<\/i><\/span> <\/center>","4754278f":"<a id = \"8\" ><\/a>\n# <span style=\"font-family:serif; font-size:28px;\"> 5. Data Manipulation <\/span>\n<a id = \"8\" ><\/a>","4d711498":"___","3e5854ff":"___","4f0fd73c":"> To solve the problem of missing values in TotalCharges column, I decided to fill it with the mean of TotalCharges values.","ef80ae2c":"Since the numerical features are distributed over different value ranges, I will use standard scalar to scale them down to the same range.","579940dd":"* New customers are more likely to churn","f7c99ce8":"<a id = \"103\" ><\/a>\n#### <b> Random Forest<\/b>\n<a id = \"rf\" ><\/a>","c1e8c619":"<a id = \"104\" ><\/a>\n#### <b>Logistic Regression<\/b>\n<a id = \"lr\" ><\/a>","cb066790":"<a id = \"108\" ><\/a>\n#### **Voting Classifier**\n<a id = \"vc\" ><\/a>\nLet's now predict the final model based on the highest majority of voting and check it's score.","91cabc42":"<a id = \"10\" ><\/a>\n# <span style=\"font-family:serif; font-size:28px;\"> 7. Data Preprocessing<\/span>\n<a id = \"datapreprocessing\" ><\/a>","e835b0a4":"* It can also be noted that the Tenure column is 0 for these entries even though the MonthlyCharges column is not empty.\n\nLet's see if there are any other 0 values in the tenure column.","c1207a57":"\n* The target the we will use to guide the exploration is **Churn**","c7cbfb29":"<a id = \"11\" ><\/a>\n# <span style=\"font-family:serif; font-size:28px;\"> 8. Machine Learning Model Evaluations and Predictions<\/span>\n<a id = \"modelprediction\" ><\/a>","deae1f52":"<style>\nimg\n{\n    display:block; \n    float:none; \n    margin-left:auto;\n    margin-right:auto;\n    width:80%;\n}\n<\/style> ","c25ed954":"___","d8f56972":"***","ad9af658":"<a id = \"102\" ><\/a>\n#### <b>SVC<\/b>\n<a id = \"svc\" ><\/a>","af22ddc4":"* It can be observed that the fraction of senior citizen is very less.\n* Most of the senior citizens churn."}}