{"cell_type":{"6f99a312":"code","0ae954a2":"code","59b54e28":"code","57f2582a":"code","0d2a6b63":"code","12b137e0":"code","9f1d1b2a":"code","7925986e":"code","8368c29f":"code","a0839250":"code","0ccae866":"code","8daea6f9":"code","3e6d0d61":"code","ffd8be8c":"code","530426c3":"code","4c5dd95d":"code","82bbd6ea":"code","3f19e0c0":"code","17a3dce8":"code","cb5fe82a":"code","5015ce61":"code","7ef8a6ca":"code","4c7d0363":"code","b4ecc172":"code","2143488b":"code","f0b6d398":"code","13b7ea12":"code","3fdc60db":"code","2bc18678":"code","5c047674":"code","ad782b20":"code","a48f0426":"code","883ff5e1":"code","5d257a44":"code","90c00614":"code","38dd63c6":"code","be3ef893":"code","f966c89b":"code","9d37b42d":"code","66b5d084":"code","114f7b53":"code","173b5006":"markdown","438d71d3":"markdown","75aeeb55":"markdown","88e11a3c":"markdown","6aed96a0":"markdown","613c9819":"markdown","8a39ee7b":"markdown","7fc00254":"markdown","46f2aba2":"markdown","c9d1832e":"markdown","b385d583":"markdown","d162f1d7":"markdown","0fcde3c9":"markdown","5d9693be":"markdown","38443db6":"markdown","e2fd77c4":"markdown","597010c9":"markdown","ef1f13ac":"markdown","c80bdf92":"markdown","d31a7936":"markdown","e3230009":"markdown","3eb76f6a":"markdown","5c11cdff":"markdown","314778b6":"markdown","1d089190":"markdown","7ac6f5f1":"markdown","4d3218af":"markdown","c162de9a":"markdown","e93cdb85":"markdown","a31fae89":"markdown"},"source":{"6f99a312":"import os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","0ae954a2":"# Importing data into python from the given csv file\ndataset= pd.read_csv('..\/input\/BlackFriday.csv')","59b54e28":"print(\"****** Dataset - head *****\", dataset.head(), sep=\"\\n\", end=\"\\n\\n\\n\\n\")\nprint(\"****** Dataset - tail *****\", dataset.tail(), sep=\"\\n\", end=\"\\n\\n\")","57f2582a":"dataset.dtypes","0d2a6b63":"dataset.info()","12b137e0":"dataset.columns","9f1d1b2a":"dataset.columns = ['UserID', 'ProductID', 'Gender', 'Age', 'Occupation', 'CityCategory',\n       'StayYearsCity', 'MaritalStatus', 'ProdCat1',\n       'ProdCat2', 'ProdCat3', 'Purchase']","7925986e":"dataset.columns","8368c29f":"# Replacing 0s and 1s in the Marital status column with the appropriate strings\ndataset['MaritalStatus'] = dataset['MaritalStatus'].replace(0, 'Unmarried')\ndataset['MaritalStatus'] = dataset['MaritalStatus'].replace(1, 'Married')","a0839250":"dataset['MaritalStatus'].unique()","0ccae866":"dataset_orig = dataset.copy()","8daea6f9":"# Importing required package\nfrom sklearn.preprocessing import LabelEncoder\nencode_x = LabelEncoder()","3e6d0d61":"dataset.head()","ffd8be8c":"# Encoding columns ProductID, \ndataset['ProductID'] = encode_x.fit_transform(dataset['ProductID'])\ndataset['Gender'] = encode_x.fit_transform(dataset['Gender'])\ndataset['Age'] = encode_x.fit_transform(dataset['Age'])\ndataset['CityCategory'] = encode_x.fit_transform(dataset['CityCategory'])\ndataset['MaritalStatus'] = encode_x.fit_transform(dataset['MaritalStatus'])","530426c3":"dataset.StayYearsCity.unique()","4c5dd95d":"# Replacing '4+' years of with numerical number 4 \ndataset['StayYearsCity'] = dataset['StayYearsCity'].replace('4+', 4)","82bbd6ea":"dataset.info()","3f19e0c0":"# Converting StayYearsCity from object to integer\ndataset['StayYearsCity'] = dataset['StayYearsCity'].astype(str).astype(int)","17a3dce8":"dataset.info()","cb5fe82a":"# Creating list of index 'without' null values on column ProdCat2\nno_null_list1 = dataset[~dataset['ProdCat2'].isnull()].index.tolist()","5015ce61":"dataset['ProductID'][no_null_list1].corr(dataset['ProdCat2'][no_null_list1])","7ef8a6ca":"# Creating list of index 'without' null values on column ProdCat2\nno_null_list2 = dataset[~dataset['ProdCat3'].isnull()].index.tolist()","4c7d0363":"dataset['ProductID'][no_null_list2].corr(dataset['ProdCat3'][no_null_list2])","b4ecc172":"print(\"Missing Product Category2 values :\", len(dataset)-len(no_null_list1))\nprint(\"Missing Product Category3 values :\", len(dataset)-len(no_null_list2))","2143488b":"# Checking values contained in ProdCat2 and ProdCat3\ndataset['ProdCat2'].unique()","f0b6d398":"dataset['ProdCat3'].unique()","13b7ea12":"dataset['ProdCat2'].fillna(value=0,inplace=True)\ndataset['ProdCat3'].fillna(value=0,inplace=True)","3fdc60db":"# Recheck for missing values (NaN) in the dataset\ndataset.isna().any()","2bc18678":"# Obtaining categorical data in terms of Percentage for each column \ngroup_1 = dataset_orig.groupby(['Gender'])\ngroup_2 = dataset_orig.groupby([\"Age\"])\ngroup_3 = dataset_orig.groupby([\"CityCategory\"])\ngroup_4 = dataset_orig.groupby([\"Occupation\"])\n\nprint (group_1[['Purchase']].count()\/len(dataset_orig)*100, end=\"\\n\\n\\n\\n\")\nprint (group_2[['Purchase']].count()\/len(dataset_orig)*100, end=\"\\n\\n\\n\\n\")\nprint (group_3[['Purchase']].count()\/len(dataset_orig)*100, end=\"\\n\\n\\n\\n\")\nprint (group_4[['Purchase']].count()\/len(dataset_orig)*100, end=\"\\n\\n\\n\\n\")\n","5c047674":"plt.figure(figsize=(15,10))\n\n# Pie chart for gender distribution\nplt.subplot(2,2,1)\ngender_count = [dataset_orig.Gender[dataset_orig['Gender']=='F'].count(),\n                dataset_orig.Gender[dataset_orig['Gender']=='M'].count()]\ngender_lab = dataset_orig.Gender.unique()\nexpl = (0.1,0)\nplt.pie(gender_count, labels=gender_lab, explode=expl, shadow=True , autopct='%1.1f%%');\n\n# Bar chart for Age\nplt.subplot(2,2,2)\nordr =dataset_orig.groupby([\"Age\"]).count().sort_values(by='Purchase',ascending=False).index\nsns.countplot(dataset_orig['Age'], label=True, order=ordr)\n\n# Bar chart for Occupation\nplt.subplot(2,2,3)\nordr1 =dataset_orig.groupby([\"Occupation\"]).count().sort_values(by='Purchase',ascending=False).index\nsns.countplot(y=dataset_orig['Occupation'], label=True, order=ordr1)\n\n# Donut chart for City Category\nplt.subplot(2,2,4)\ncity_count = group_3[['Purchase']].count().values.tolist()\ncity_lab = dataset_orig.groupby([\"CityCategory\"]).count().index.values\nmy_circle = plt.Circle( (0,0), 0.4, color='white')\nexpl1 = (0,0.1,0)\nplt.pie(city_count, labels=city_lab,explode=expl1, shadow=True, autopct='%1.1f%%')\nplt.gcf().gca().add_artist(my_circle)\n\n\nplt.show()","ad782b20":"plt.figure(figsize=(8,6))\nordr2 =dataset_orig.groupby([\"StayYearsCity\"]).count().sort_values(by='Purchase',ascending=False).index\nsns.countplot(dataset_orig['StayYearsCity'], label=True, order=ordr2)\nplt.show()","a48f0426":"#Creating new column in the dataset \ndataset_orig['Gender_MaritalStatus'] = dataset_orig.apply(lambda x:'%s_%s' % (x['Gender'],x['MaritalStatus']),axis=1)","883ff5e1":"dataset_orig.Gender_MaritalStatus.unique()","5d257a44":"group_5 = dataset_orig.groupby([\"Gender_MaritalStatus\"])","90c00614":"plt.figure(figsize=(15,10))\n\nplt.subplot(1,2,1)\ncount1 = group_5[['Purchase']].count().values.tolist()\nlab1 = dataset_orig.groupby([\"Gender_MaritalStatus\"]).count().index.values\nexpl2 = (0,0,0.1,0.1)\nplt.pie(count1, labels=lab1,explode=expl2, shadow=True, autopct='%1.1f%%')\n\nplt.subplot(1,2,2)\nsns.countplot(dataset_orig['Age'],hue=dataset_orig['Gender_MaritalStatus'])\n\nplt.show()","38dd63c6":"# Bar chart for Age\n\nsns.catplot(x='Gender_MaritalStatus', y='Purchase', data=dataset_orig, kind='boxen')\n\nordr_occ =dataset_orig.groupby([\"Age\"]).mean().sort_values(by='Purchase',ascending=False).index\nsns.catplot(x='Age', y='Purchase', order=ordr_occ, data=dataset_orig, kind='bar')\n\nordr_occ =dataset_orig.groupby([\"Occupation\"]).mean().sort_values(by='Purchase',ascending=False).index\nsns.catplot(x='Occupation', y='Purchase', order=ordr_occ, data=dataset_orig, kind='bar')\n\nsns.catplot(x='CityCategory', y='Purchase', data=dataset_orig, kind='boxen')\n\n\nplt.show()","be3ef893":"corrmat = dataset.corr()","f966c89b":"f, ax = plt.subplots(figsize=(12, 9))\nsns.heatmap(corrmat, vmax=1, cmap=\"YlGnBu\", square=True,linewidths=.5, annot=True)\nplt.show()","9d37b42d":"dataset[dataset.columns[0:]].corr()['Purchase'].sort_values(ascending=False)","66b5d084":"# Obtaining top K columns which affects the Purchase the most\nk= 8\ncorrmat.nlargest(k, 'Purchase')","114f7b53":"# Replotting the heatmap with the above data\ncols = corrmat.nlargest(k, 'Purchase')['Purchase'].index\ncm = np.corrcoef(dataset[cols].values.T)\nf, ax = plt.subplots(figsize=(12, 9))\nsns.heatmap(cm, cmap=\"YlGnBu\", cbar=True, annot=True, square=True, fmt='.2f', annot_kws={'size': 10}, yticklabels=cols.values, xticklabels=cols.values)\nplt.show()","173b5006":"#### 2.2 Encoding categorical varaibles to numerics","438d71d3":"__Conclusion__ : <br>\n It appears that the values in ProdCat2 and ProdCat3 are numeric categories. <br>\n Hence, replacing the 'NaN' with 0s and can be assumed as 'missing' category value.","75aeeb55":"#### 2.3 Handling Missing Values","88e11a3c":"__Create copy of dataset 'before encoding'__\n> Creating a copy of the dataset before encoding the values <br>\nThis is mainly done to use the values for 'visualization' purpose, with actual values","6aed96a0":"#### 1.1 Exploring the data ","613c9819":"#### 2.1 Rename columns","8a39ee7b":"#### 3.2 Visualization of correlation\n","7fc00254":"### 4.0 Conclusion","46f2aba2":"Examining __whether Product Category 2 and 3 are correlated__ to the __Product ID__","c9d1832e":"## Black Friday - Data Pre-processing & Visualization\n\n### Pre-Processing Data and Visualization \n> My main activity using the Black Friday dataset has been *Data Pre-processing* and getting insight through *Visualization*.\n\n\n### Description\n> The dataset here is a sample of the transactions made in a retail store. The store wants to know better the customer purchase behaviour against different products.<br>\n> __Black Friday__ is an informal name for the Friday following Thanksgiving Day in the United States, which is celebrated on the fourth Thursday of November. The day after Thanksgiving has been regarded as the beginning of America's Christmas shopping season since 1952, although the term \"Black Friday\" didn't become widely used until more recent decades. Black Friday date in 2018 fell on November 23. (Source : Wikipedia)\n\n> __Additional Use of data__ <br>\nAdditionally the data can also be considered for 'Classification', as several variables are categorical, like classifying the age group and category of goods purchased.\n'Clustering' can also be incorporated from the dataset, providing different clusters based on product category, age, Gender.","b385d583":"*Observation* <br>\nData contains missing values (NaN) mainly in *'product category2 and 3'* columns","d162f1d7":"Visualization :  __By Average Purchase__  ","0fcde3c9":"### 2.0 Data Pre-Processing","5d9693be":"### 1.0 Importing required libraries and data","38443db6":"*Observation* <br>\nMost of the columns are *'numeric* except 5 columns ","e2fd77c4":"1. Based on the above visualizations and correlation matrix, it appears that the __customer purchase behaviour__ mainly depends on __4 major factors__ ; <br>\n    a. __City Category__ (Category C and B are more in number and spend more on items)<br> \n    b. __Gender__ (Males (esp. unmarried) buy more than females) <br>\n    c. __Occupation__ (codes 4,0,7 are regular buyers, codes 17,12,15 spend more on items) <br>\n    d. People __Aged__ between 26-35 visit more and also spend more more on items <br>\n2. By observing the dataset, it appears that column Product Category 1 is the 'main' category type and other 2 columns indicating  Product categories (2 & 3) are sub categories of the product. As there were quite a few missing values in Product category2 and Product Category3 (replaced by 0s) no particular insight can be provided.","597010c9":"Visualization - __more insights__ <br>\n\n1. Combining __Age and Gender__  and also  __Gender and Marital Status__ \n2. Combining __Gender and Marital Status__ to create new column indicating both Gender and Marital status","ef1f13ac":"Visualization :  __By count__  ","c80bdf92":"__Activity__\n\nAfter exploring the given data I could think of the following pre-processing activities <br> \nthat can be carried out on the data, to ensure that it is ready for Machine Learning\n\n1. Rename column names : Rename the column names to short names without space, so that it would be easy for coding\n2. Encode category varaibles to numerics, so that the data can be used for any kind of Machine Learning\n3. Handling missing values : Check whether Product_ID is correlated to Product Categories and fill in appropriate values","d31a7936":"---","e3230009":"__Observation__ : <br>\nFrom the correlation function, it can be concluded that the 'Product ID' is __NOT correlated__ to <br>\neither ProdCat2 or ProdCat3","3eb76f6a":"__Observations__ : \n1. __Males__ spend more than females\n2. Age factor : People who have earned more (*spend more time working*) and have saved enough money, tend to spend more\n3. __Occupation codes 17, 12 and 15__ appears to be earning more and accordingly spend more \n4. People living in __Category C__ city appears to spend more in the mall\n","5c11cdff":"Let us visualize the plots based on the categorical variables, \n1. Gender\n2. Age\n3. Occupation \n4. City Category","314778b6":"***","1d089190":"__Observations__ : \n1. Males (un-married and married) between the age group of 26-35 are major buyers\n2. Un-married female buyers are more in number than married ones","7ac6f5f1":"### Contents\n[1.0 Importing required Python libraries and data](#1.0-Importing-required-libraries-and-data)<br>\n    [1.1 Exploring the data](#1.1-Exploring-the-data)<br>\n<br>\n[2.0 Data Pre-Processing](#2.0-Data-Pre-Processing)<br>\n    [2.1 Renaming columns](#2.1-Rename-columns)<br>\n    [2.2 Encoding categorical variables](#2.2-Encoding-categorical-varaibles-to-numerics)<br>\n    [2.3 Handling Missing Values](#2.3-Handling-Missing-Values)<br>\n<br>\n[3.0 Visualization](#3.0-Visualization)<br>\n   [3.1 Visualisation of correlation](#3.2-Visualization-of-correlation)<br>\n<br>\n[4.0 Conclusion](#4.0-Conclusion)\n","4d3218af":"### 3.0 Visualization","c162de9a":"__Observations__ : \n\n1. There are __75.4% males__ and 24.6% female buyers from the store\n2. The majority __(40%) of buyers__ are in between the __age group of 26-35__\n3. Major buyers are from the __City category C (31%) and B (42%)__\n4. __Occupation__ code __4 (13%), 0 (12.7%) and 7(10.8%)__ are the major buyers\n5. It can be observed that, as people __who are new__ in the the current city, they tend to visit the mall more frequently.","e93cdb85":"*Observation* <br>\nMissing data in Product_Category_2 and Product_Category_3 columns","a31fae89":"__Observation__ :\nFrom the above correlation matrix and plot we understand that the __Gender, CityCategory and Product Category 3__ are the three (3) main parameters relating to the Purchase "}}