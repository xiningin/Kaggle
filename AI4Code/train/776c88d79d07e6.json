{"cell_type":{"78e9a9b9":"code","6ec214f0":"code","095d0d8d":"code","c3a0e52b":"code","2b7a0efb":"code","8eea780b":"code","b69d492f":"code","52f8c8c4":"code","d52c90e9":"code","5e25dccd":"code","1ed28c86":"code","d5047499":"code","4d36ba0e":"markdown","7796093c":"markdown","bed1089d":"markdown","7a8d91dd":"markdown","e5c229bf":"markdown","d7fec72a":"markdown","9872d0e6":"markdown","41be2afb":"markdown","19d2d3d1":"markdown","83f4aef5":"markdown","236d8084":"markdown","793e24f1":"markdown"},"source":{"78e9a9b9":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","6ec214f0":"import pandas as pd","095d0d8d":"data_df = pd.read_csv(\"\/kaggle\/input\/passengers-air-transport-in-europe\/ttr00012.tsv\", sep='\\t')","c3a0e52b":"print(list(data_df.columns))","2b7a0efb":"pivot_data_col = data_df.columns[0]\ntime_columns = data_df.columns[1:]","8eea780b":"data_df['unit'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[0])\ndata_df['tra_meas']     = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[1])\ndata_df['tra_cov'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[2])\ndata_df['schedule'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[3])\ndata_df['geography'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[4])","b69d492f":"selected_columns = list(['unit', 'tra_meas', 'tra_cov', 'schedule', 'geography']) +  list(time_columns)\ndata_df = data_df[selected_columns]","52f8c8c4":"data_tr_df = data_df.melt(id_vars=['unit', 'tra_meas', 'tra_cov', 'schedule', 'geography'], \n        var_name=\"date\", \n        value_name=\"value\")\ndata_tr_df['date'] = data_tr_df['date'].apply(lambda x: int(x))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"bp\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"b\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"u\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"c\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"d\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\": \", \"NAN\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: float(x))","d52c90e9":"print(f\"Transformed data shape: {data_tr_df.shape} (rows\/columns)\")\ndata_tr_df.head()","5e25dccd":"data_tr_df.tail()","1ed28c86":"import pandas_profiling\npandas_profiling.ProfileReport(data_tr_df)","d5047499":"data_tr_df.to_csv(\"passengers_air_transport.csv\", index=False)","4d36ba0e":"## Load the data\n\nThe datafiles are in TSV format. We will read the files using pandas, just include in the function call the `sep` (tab separator data).\nWe demonstrate first how to read and process the Annual data.","7796093c":"# Export data in csv format","bed1089d":"Let's inspect the result.","7a8d91dd":"# Data pre-processing\n\nWe start by defining two working lists.","e5c229bf":"We select now only the new columns resulted from splitting the `pivot_data_col` and the time columns.","d7fec72a":"Let's glimpse the data columns.","9872d0e6":"Then, we split from `pivot_data_col` the 3 separate fields:\n* unit;\n* tra_meas;\n* tra_cov;\n* schedule;\n* geography (countries and Euro country groups).","41be2afb":"# A very preliminary exploratory data analysis\n\nThis would be a very short exploratory data analysis. The role of this Kernel is just to show how we can prepare the annual data for analysis and we already did this.","19d2d3d1":"Next, we pivot the time columns using `melt` operation in pandas.  \nWe also make sure we transform `date` to be an integer (here is a year data).  \nWe set `value` to be a float, after we replace \": \" (for N\/A) with `NAN`.","83f4aef5":"The first column is a composed one, containing 5 different information (unit, sex, age, isced-11 education attainment levels classification and geography). The next columns are the year value, from last (2020) to first (1983).","236d8084":"# Analysis preparation\n\n## Load packages","793e24f1":"# Introduction\n\nWe show in this Kernel how we can process the data to prepare it for easier processing. Let's check the data files."}}