{"cell_type":{"b99a9e86":"code","52f93edd":"code","3af0b5d2":"code","fc324403":"code","547ccef5":"code","57aca9da":"code","90b7bc57":"code","92608f76":"code","7b2fa3da":"code","630f04b4":"code","bd6a7ffc":"code","93540935":"code","1c111f04":"code","e0f2b79c":"code","f9a3d000":"code","be495e82":"code","0140348c":"code","0abc9c6f":"code","ca1ecc40":"code","9e5ac75d":"code","b03157fc":"code","db4f02a6":"code","ae44c8da":"code","ed8e06d1":"code","6ed22209":"code","6dba9c7e":"code","bd7ba56d":"code","40a35d6a":"code","32701b2d":"markdown","af49a199":"markdown","5473f158":"markdown","480b464e":"markdown","51da7a9b":"markdown","417ab7d2":"markdown","629dc9b5":"markdown","eab9c5eb":"markdown"},"source":{"b99a9e86":"#importing libraries\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.metrics import classification_report, roc_auc_score, roc_curve, confusion_matrix\n\nfrom sklearn.model_selection import cross_val_score\n\nfrom sklearn.preprocessing import MinMaxScaler\n\n# suppressing warnings\nimport warnings\nwarnings.filterwarnings('ignore')","52f93edd":"#importing dataset\ndf = pd.read_csv('..\/input\/bank-loan-classification\/UniversalBank.csv')","3af0b5d2":"df","fc324403":"#dropping unnecessary columns\ndf.drop('ID',axis=1, inplace=True)","547ccef5":"df.dtypes","57aca9da":"df.describe().T","90b7bc57":"#defining numerical and categorical variables\ncategorical_var = ['ZIP Code','Education','Securities Account', 'CD Account', 'Online', 'CreditCard']\ntarget_var = ['Personal Loan']\nnumerical_var = set(df.columns)-set(categorical_var)-set(target_var)\nnumerical_var","92608f76":"#Dropping Categorical Variables with Multiple Levels:\nhigh_cardinality = []\nfor column in categorical_var:\n    if len(df[column].value_counts().index)>100:\n        high_cardinality.append(column)\nhigh_cardinality","7b2fa3da":"df.drop('ZIP Code',axis=1, inplace=True)\ncategorical_var= set(categorical_var)-set(['ZIP Code'])","630f04b4":"#examining missing values with heatmap\nsns.heatmap(df.isnull(),cbar=False)","bd6a7ffc":"#accessing target variable distribution\nprint(df['Personal Loan'].value_counts())\nprint(df['Personal Loan'].hist())","93540935":"#visualizing numerical variables\nsns.pairplot(df[(set(df.columns)-set(categorical_var))],hue='Personal Loan')","1c111f04":"df.corr()['Personal Loan'].sort_values(ascending=False)","e0f2b79c":"for i in categorical_var:\n  print(i)\n  print(df[i].value_counts())\n","f9a3d000":"#Creating dummy variable for Education\nedu_dummy_df = pd.get_dummies(df['Education'],drop_first=True)\ndf.drop(['Education'],axis=1,inplace=True)\ndf=pd.concat([df,edu_dummy_df],axis = 1)\n","be495e82":"df.rename(columns={2:\"Education_2\",3:\"Education_3\"},inplace=True)","0140348c":"df.columns","0abc9c6f":"df[['Education_3','Education_2']] = df[['Education_3','Education_2']].astype({'Education_3': 'int64','Education_2':'int64'})","ca1ecc40":"df.dtypes","9e5ac75d":"#assigning input and target variables\nX=df.drop('Personal Loan',axis=1)\ny=df['Personal Loan']","b03157fc":"#rescaling variables using MinMaxScaler\nscaler = MinMaxScaler()\n\nX_ = scaler.fit_transform(X)\n\nX_rescaled = pd.DataFrame(X_,columns=X.columns)\n\nX_rescaled.describe()","db4f02a6":"#splitting data 70\/30 into training and test datasets\nX_train, X_test, y_train, y_test = train_test_split(X_rescaled,y,test_size= 0.3,random_state=1)\n","ae44c8da":"#developing Artificial Neural Network (ANN)\n#we will use 'lgbfs' solver type since it works accurately for smaller data types\nMLPC_model = MLPClassifier(hidden_layer_sizes=20,activation='logistic',solver='lbfgs',random_state=1)\n\nMLPC_model.fit(X_train,y_train)\n\nmlpc_y_pred = MLPC_model.predict(X_test)\n","ed8e06d1":"#accesssing model performance\n\n##confusion matrix\nprint(confusion_matrix(y_test,mlpc_y_pred),\"\\n\")\n\n##classification report\nprint(classification_report(y_test,mlpc_y_pred),\"\\n\")\n\n##roc_auc score\nprint(\"ROC AUC Score: \",roc_auc_score(y_test,mlpc_y_pred))","6ed22209":"from sklearn.model_selection import cross_val_score\nmin_hidden_layer_size = 5\nmax_hidden_layer_size = 40\ncv_scores = []\n\nfor s in range(min_hidden_layer_size,max_hidden_layer_size, 5):\n  MLPC_model = MLPClassifier(hidden_layer_sizes=s, activation='logistic',solver='lbfgs', random_state =1)\n  scores = cross_val_score(MLPC_model,X_train,y_train.values.ravel(),cv = 5,scoring='accuracy')\n  cv_scores.append(scores.mean())","6dba9c7e":"sns.lineplot(x = range(min_hidden_layer_size,max_hidden_layer_size, 5),y=cv_scores)","bd7ba56d":"#determining exact value of k\n(cv_scores.index(max(cv_scores))+1)*5             #multiplied by 5 since range is increased by 5","40a35d6a":"#accesssing model performance with optimal value of hidden layer size\nMLPC_model = MLPClassifier(hidden_layer_sizes=25,activation='logistic',solver='lbfgs',random_state=1)\n\nMLPC_model.fit(X_train,y_train)\n\nmlpc_y_pred = MLPC_model.predict(X_test)\n##confusion matrix\nprint(confusion_matrix(y_test,mlpc_y_pred),\"\\n\")\n\n##classification report\nprint(classification_report(y_test,mlpc_y_pred),\"\\n\")\n\n##roc_auc score\nprint(\"ROC AUC Score: \",roc_auc_score(y_test,mlpc_y_pred))","32701b2d":"## Bank Loan Prediction","af49a199":"### Data Preprocessing","5473f158":"### Importing Libraries, Dataset, and EDA","480b464e":"### Artificial Neural Network Model","51da7a9b":"#### Model Performance Evaluation","417ab7d2":"#### Rebuilding ANN Model with Optimal Number of Nodes","629dc9b5":"The optimal number of nodes based on model accuracy is 25.","eab9c5eb":"#### Identifying Optimal Number of Nodes"}}