{"cell_type":{"ee778ffc":"code","a533d376":"code","9f084a16":"code","a4415252":"code","0e13abf2":"code","7ffa4804":"code","504f1287":"code","266a6fd7":"code","f9bda4fc":"code","3d936c5a":"code","8210347c":"code","9758bc20":"code","38a8934f":"code","61d14b59":"code","52f82370":"code","b28ee25b":"code","f3c1167f":"code","f1d782b2":"code","62af152c":"code","c2577539":"code","dc29ca16":"code","84eb13e5":"code","d4b18dcb":"code","8ef2fe1d":"code","b754e8ae":"code","380df412":"code","c02581c5":"code","a056a460":"code","3fecff32":"code","b3543613":"code","b75bee33":"code","ee8d50db":"markdown","e659f461":"markdown","aae40750":"markdown","3e1c0e90":"markdown","5b43541d":"markdown","ab5dc163":"markdown","02053082":"markdown","bc43e17c":"markdown","0b54af0e":"markdown","9f436eda":"markdown","71150ac7":"markdown","a8fa788b":"markdown","03d508b0":"markdown"},"source":{"ee778ffc":"#Modules for EDA\nimport numpy as np \nimport pandas as pd \nimport seaborn as sns\nfrom matplotlib import pyplot as plt\nplt.style.use('fivethirtyeight')\nfrom imblearn.over_sampling import SMOTE\n\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report,confusion_matrix\n\nfrom tensorflow import keras\n%matplotlib inline","a533d376":"df = pd.read_csv('..\/input\/hepatitis-c-dataset\/HepatitisCdata.csv')\ndf.shape","9f084a16":"df.info()","a4415252":"df.isna().sum()","0e13abf2":"df.head()","7ffa4804":"df.drop('Unnamed: 0',axis=1,inplace=True)","504f1287":"df.describe()","266a6fd7":"df.fillna(df.mean(),inplace=True)\ndf.describe()","f9bda4fc":"plt.figure(figsize=(7,7))\nplt.title('Age Histogram')\nsns.histplot(df['Age'])\nplt.show()","3d936c5a":"plt.figure(figsize=(7,7))\nplt.title('Age Histogram with Category')\nsns.histplot(df[['Age','Category']],x='Age',hue='Category')\nplt.show()","8210347c":"plt.figure(figsize=(7,7))\nsns.pairplot(data=df.drop(['Age','Sex'],axis=1),hue='Category')\nplt.title('Pairplot')\nplt.show()","9758bc20":"plt.figure(figsize=(7,7))\ndf['Category'].value_counts().plot(kind='pie',autopct='%.2f')\nplt.title('Category Pie Chart')\nplt.show()\n\ndf['Category'].value_counts()","38a8934f":"df.Category.unique()","61d14b59":"replace_dict = dict()\nnum_dict = dict()\ni=0\nfor val in df['Category'].unique():\n    replace_dict[val] = i\n    num_dict[str(i)] = val\n    i += 1","52f82370":"df['Category'].replace(replace_dict,inplace=True)\ndf.Category.unique()","b28ee25b":"df['Sex'].value_counts()","f3c1167f":"df['Sex'].replace(['m','f'],[1,0],inplace=True)\ndf['Sex'].value_counts()","f1d782b2":"x,y = df.drop('Category',axis=1),df['Category']","62af152c":"smote = SMOTE()\nx,y = smote.fit_resample(x,y)","c2577539":"plt.figure(figsize=(7,7))\ny.value_counts().plot(kind='pie',autopct='%.2f')\nplt.title('Category Pie Chart')\nplt.show()\ny.value_counts()","dc29ca16":"cols_to_scale = x.drop('Sex',axis=1).columns\ncols_to_scale","84eb13e5":"scale = MinMaxScaler()\nscalled = scale.fit_transform(x[cols_to_scale])","d4b18dcb":"i = 0\nfor col in cols_to_scale:\n    x[col] = scalled[:,i]\n    i += 1","8ef2fe1d":"x.head()","b754e8ae":"x_train, x_test, y_train, y_test = train_test_split(x,y, test_size=0.3)\nx_train.shape, x_test.shape, y_train.shape, y_test.shape","380df412":"model = keras.Sequential([\n    keras.layers.Dense(12,input_shape=(12,),activation='relu'),\n    keras.layers.Dense(5,activation='softmax')\n])\n\nmodel.compile(\n    optimizer='adam',\n    metrics=['accuracy'],\n    loss='sparse_categorical_crossentropy'\n)","c02581c5":"model.fit(x_train,y_train,epochs=200)","a056a460":"model.evaluate(x_test,y_test)","3fecff32":"def predict(model,x):\n    pred = model.predict(x)\n    pred_test = np.array([np.argmax(pred[i]) for i in range(len(pred))])\n    return pred_test\n\ndef plot_actual_vs_predicted(y_true,y_pred,title):\n    cm = confusion_matrix(y_true,y_pred)\n    plt.figure(figsize=(7,7))\n    sns.heatmap(cm,annot=True,fmt='g',\n                xticklabels=num_dict.values(),yticklabels=num_dict.values())\n    plt.title(title)\n    plt.show()\n    print(\"Classification Report\")\n    print(classification_report(y_true,y_pred))","b3543613":"y_test_pred = predict(model,x_test)\nplot_actual_vs_predicted(y_test,y_test_pred,\"Test Data Predictions\")","b75bee33":"y_train_pred = predict(model,x_train)\nplot_actual_vs_predicted(y_train,y_train_pred,\"Train Data Predictions\")","ee8d50db":"**Attributes 1 to 4 refer to the data of the patient:**\n1. X (Patient ID\/No.)\n2. Category (diagnosis) (values: '0=Blood Donor', '0s=suspect Blood Donor', '1=Hepatitis', '2=Fibrosis', '3=Cirrhosis')\n3. Age (in years)\n4. Sex (f,m)\n<br>**Attributes 5 to 14 refer to laboratory data:**\n5. ALB (Albumin Blood Test)\n6. ALP (Alkaline phosphatase)\n7. ALT (Alanine Transaminase)\n8. AST (Aspartate Transaminase)\n9. BIL (Bilirubin)\n10. CHE (Acetylcholinesterase)\n11. CHOL (Cholesterol)\n12. CREA (Creatinine)\n13. GGT (Gamma-Glutamyl Transferase)\n14. PROT (Proteins)\n\nThe target attribute for classification is Category (2): blood donors vs. Hepatitis C patients (including its progress ('just' Hepatitis C, Fibrosis, Cirrhosis).","e659f461":"# **Predicions**","aae40750":"# **Imbalanced Dataset :(**","3e1c0e90":"# **Replacing Category values into numerics**","5b43541d":"# **Missing Values**","ab5dc163":"# **Replacing Gender Values to 0 and 1**","02053082":"# **Train Data Predictions**","bc43e17c":"# **Model Building and Training**","0b54af0e":"# **Category Pie Chart**","9f436eda":"# **Test Data Predictions**","71150ac7":"# **Train Test Split**","a8fa788b":"# **Oversampling the data using SMOTE Method**","03d508b0":"# **Feature Scaling**"}}