{"cell_type":{"e00bd64a":"code","9f4f3341":"code","49dad69c":"code","3c8b8e0f":"code","e851529d":"code","5cff8b23":"code","2445f97b":"code","ca86d1a4":"code","cfae14bb":"code","583e5344":"code","e54d4a6b":"code","27e7d3b2":"code","b2d901c9":"code","abb01df8":"code","704f82b1":"code","eecc0a72":"code","f0a6a5e0":"code","73a2d061":"code","036f04a8":"code","97985072":"code","92e3d285":"code","2e06fb32":"code","053bf8dc":"code","d189337b":"code","03a37d5b":"code","34416c21":"code","a31bfdf9":"code","83f6b2d1":"code","93f21d62":"code","68906137":"code","543d8056":"code","b0b71505":"code","5679e86e":"code","ce37c307":"code","8599f6e1":"code","048a7881":"code","e203a0a0":"code","cdd584ad":"code","c4164e28":"code","65ae8732":"code","d5c3449a":"markdown","43d58ea5":"markdown","93b321a4":"markdown","d5920abe":"markdown","2d60e8c0":"markdown","61e48d00":"markdown","61349c49":"markdown","bde7b518":"markdown","ea8b6762":"markdown","8e625ff1":"markdown","71130863":"markdown","3e829bd1":"markdown","d591030d":"markdown","560c37c7":"markdown","9acd8a69":"markdown","3782c9bd":"markdown","326a41d4":"markdown","f07de36e":"markdown","a28d9fd3":"markdown","094c87ba":"markdown","40ee3f9e":"markdown","24c55fcd":"markdown","8e8e282a":"markdown","b496151b":"markdown","27d859fb":"markdown","114b57d1":"markdown","672d78ad":"markdown","f4131ab0":"markdown","d532d14d":"markdown","31e2d161":"markdown","419fe8ba":"markdown","f3988dbc":"markdown","3e7e27af":"markdown","bd90ecd7":"markdown","f0935714":"markdown"},"source":{"e00bd64a":"# \u8f7d\u5165\u5e93\nimport numpy as np \nimport pandas as pd\nimport matplotlib.mlab as mlab\nimport matplotlib.pyplot as plt\nimport os\n\n# \u8bfb\u5165\u6587\u4ef6\nfile_dir='..\/input\/2020mcm\/hair_dryer.tsv'\ndata=pd.read_csv(file_dir,engine='python',sep='\\t')\ndata.info()","9f4f3341":"data['verified_purchase'].value_counts()","49dad69c":"labels=['verfied','unverified']\nX=[data[data['verified_purchase']=='Y'].count()[0],data[data['verified_purchase']=='N'].count()[0]]\nfig = plt.figure()\nplt.pie(X,labels=labels,autopct='%1.2f%%')\nplt.title(\"PieChart.jpg\")\nplt.show()\n","3c8b8e0f":"verified_data=data[data['verified_purchase'].isin(['Y'])]\nverified_data['verified_purchase'].value_counts()","e851529d":"slim_data = verified_data.loc[:,['review_id','product_id','vine','review_body','star_rating','helpful_votes','total_votes','review_date']]\nslim_data.info()","5cff8b23":"sales_number=slim_data['product_id'].value_counts()\nlen(sales_number)","2445f97b":"sales_number=slim_data.groupby(['product_id'],as_index=False)['product_id'].agg({'cnt':'count'})\n","ca86d1a4":"small_sales=sales_number[(sales_number['cnt']>=1)&(sales_number['cnt']<=10)]\nsmall_sales.info()","cfae14bb":"sales_one=sales_number[sales_number['cnt']==1]\nsales_one.info()\nsales_one.shape","583e5344":"labels=sales_number['product_id']\nX=sales_number['cnt']\nfig = plt.figure(figsize=(15,15))\nplt.pie(X,labels=labels,autopct='%1.2f%%')\nplt.title(\"the sales number pie chart\"+\"hair_dryer\")\nplt.savefig(\"all dryer share.jpg\")\nplt.show()","e54d4a6b":"top_XX=sales_number.nlargest(50,columns='cnt').tail(50)","27e7d3b2":"X=top_XX['cnt']\nlabels=top_XX['product_id']\nfig=plt.figure(figsize=(15,15))\nplt.pie(X,labels=labels,autopct='%1.2f%%')\nplt.title(\"slim hair dryer share\")\nplt.savefig(\"slim hair dryer share.jpg\")\nplt.show()","b2d901c9":"top_XX_data=slim_data[slim_data['product_id'].isin(labels)]\ntop_XX_data.info()","abb01df8":"labels","704f82b1":"top_XX_data.to_csv(\".\/top_50_dryer.csv\",index=False)","eecc0a72":"tmp=pd.read_csv('.\/top_50_dryer.csv',sep=',')\ntmp.info()","f0a6a5e0":"from textblob import TextBlob\nfrom wordcloud import WordCloud\nimport pandas as pd\nimport numpy as np\nimport csv\nfrom os import listdir\n\ndef getComments(filename): # \u83b7\u53d6\u8bc4\u8bba\u5217\u8868\u3001\u8bc4\u8bba\u4e2d\u6240\u6709\u7684\u5355\u8bcd\uff0c\u4ee5\u7a7a\u683c\u5206\u9694\n    comments = np.zeros(0)\n    words = ''\n    com_file = pd.read_csv(filename,sep=',')\n    comments = np.append(comments, com_file['review_body'])\n    for each in comments:\n        words += each\n    replace_list = [',', '.', '\\'', '\\\"']\n    for each in replace_list:\n        words = words.replace(each, ' ')\n    return comments, words\n\ndef getWordCloud(text_str, picture_name): # \u751f\u6210\u8bcd\u4e91\n    wordcloud = WordCloud(background_color=\"white\",width=1980, height=1080, margin=1, random_state=0).generate(text_str)\n    wordcloud.to_file(picture_name)\n\ndef get_p_or_n(comments): # \u83b7\u53d6\u60c5\u7eea\u6781\u5316\u8bc4\u5206\uff0c\u5e76\u5212\u5b9a\u9608\u503c\u786e\u5b9a\u662f\u79ef\u6781\u3001\u6d88\u6781\u6216\u4e2d\u7acb\n    with open('result.csv', 'w', encoding='utf-8') as csvfile:\n        id = 0\n        writer = csv.writer(csvfile)\n        writer.writerow(['id', 'result', 'score', 'comment'])\n        with open('samples.csv', 'w', encoding='utf-8') as samples_file:\n            writer_samples = csv.writer(samples_file)\n            writer_samples.writerow(['id', 'result', 'score', 'OurJudge', 'comment'])\n            for each in comments:\n                judge = TextBlob(each)\n                # print(each)\n                result = ''\n                score = judge.sentiment.polarity\n                if score > 0.05:\n                    result = '\u79ef\u6781'\n                elif score < -0.03:\n                    result = '\u6d88\u6781'\n                else:\n                    result = '\u4e2d\u7acb'\n                id += 1\n                writer.writerow([id, result, score, each])\n                if id%5 == 0:\n                    writer_samples.writerow([id, result, score, '', each])\n    result_df=pd.read_csv('result.csv',sep=',')\n    init_df=pd.read_csv('.\/top_50_dryer.csv',sep=',')\n    init_df['score']=result_df['score']\n    init_df.to_csv('.\/dryer_score.csv',index=False)\n                    \n                    \ndef main():\n    filename = \".\/top_50_dryer.csv\"\n    comments, words = getComments(filename)\n    print(len(comments))\n    getWordCloud(words, \"WordCloud_dryer.png\")\n    get_p_or_n(comments)\n\nif __name__ == \"__main__\":\n    main()\n","73a2d061":"data=pd.read_csv('.\/dryer_score.csv',sep=',')\ndata['score']=(data['score']+1)\/2","036f04a8":"plt.hist(data['score'])","97985072":"def transfer_vine(data):\n    if data['vine']=='Y':\n        return 1.2\n    else:\n        return 1.0\ndata['vine']=data.apply(transfer_vine,axis=1)    ","92e3d285":"data['vine'].value_counts()","2e06fb32":"data_test=data.loc[:,['helpful_votes','total_votes']]","053bf8dc":"def calculate_helpful(df):\n    if df['total_votes']==0:\n        return 1\n    else:\n        return 1+df['helpful_votes']\/df['total_votes']*0.5\n    \ndata_test['helpful rating']=data.apply(calculate_helpful,axis=1)  \ndata_test['helpful rating']","d189337b":"data['helpfulness rating']=data_test['helpful rating']","03a37d5b":"data_test=data.loc[:,'star_rating']\ndef transfer(data):\n    return data['star_rating']\/5\ndata_test['star_rating']=data.apply(transfer,axis=1)\ndata['star_rating']=data_test['star_rating']","34416c21":"data['star_rating'].value_counts()","a31bfdf9":"labels=['5 stars','4 stars','3 stars','2 stars','1 stars']\nX=[data[data['star_rating']==1.0].count()[0],\n   data[data['star_rating']==0.8].count()[0],\n  data[data['star_rating']==0.6].count()[0],\n  data[data['star_rating']==0.4].count()[0],\n  data[data['star_rating']==0.2].count()[0]]\nfig=plt.figure()\nplt.pie(X,labels=labels,autopct='%1.2f%%')\nplt.title(\"stars share\")\n# plt.savefig(\"file_dir\")\nplt.show()","83f6b2d1":"data['score']=data['score']*100","93f21d62":"data.to_csv(\"ini_review_dryer.csv\",index=False)","68906137":"data['final_review_score']=data['vine']*data['score']*data['helpfulness rating']","543d8056":"plt.hist(data['final_review_score'])","b0b71505":"data.to_csv('.\/every_review_info.csv',index=False)\ndata_2b=data.loc[:,['product_id','review_id','review_date','final_review_score','review_body','star_rating']]\ndata_2b.to_csv('.\/2b_data.csv',index=False)","5679e86e":"data_tmp=data.loc[:,['product_id','final_review_score']]","ce37c307":"data_tmp.info()","8599f6e1":"# \u53ea\u7559\u4e0b\u9700\u8981\u5904\u7406\u7684\u5217\ncols = [col for col in data_tmp.columns if col in['final_review_score']]\n# \u5206\u7ec4\u7684\u5217\ngp_col = 'product_id'\n# \u6839\u636e\u5206\u7ec4\u8ba1\u7b97\u5e73\u5747\u503c\ndf_mean = data_tmp.groupby(gp_col)[cols].mean()\n\ndf_mean","048a7881":"df_final_score=df_mean.sort_values(by='final_review_score',ascending=False)","e203a0a0":"df_mean.sort_values(by='final_review_score',ascending=False)","cdd584ad":"df_mean.sort_values(by='final_review_score',ascending=False).head(10)","c4164e28":"df_final_score.to_csv(\"final_dryer_score.csv\")","65ae8732":"data_2b.info()","d5c3449a":"# 3.\u67e5\u770b\u4e00\u4e0b\u8fd9423\u79cd\u578b\u53f7\u4ea7\u54c1\u7684\u9500\u91cf\u5360\u6bd4","43d58ea5":"\u6570\u636e\u5904\u7406\u7684\u7ed3\u679c\u662f\uff0c\u4fdd\u7559\u8bc4\u8bbaid\u3001\u4ea7\u54c1id\u3001vine\u3001\u8bc4\u8bba\u4e3b\u4f53\n\n\u6211\u5148\u6765\u8bf4\u4e00\u4e0b\u6570\u636e\u5904\u7406\u90e8\u5206\u7684\u64cd\u4f5c\uff1a\n\n1\uff09\u5220\u9664\u65e0\u7528\u8bc4\u8bba\uff0c\u5373'verified_purchase'\u5217\u503c\u4e3aN\u7684\u884c\n\n2\uff09\u8ba1\u7b97\u6709\u591a\u5c11\u79cd\u4ea7\u54c1\n\n3\uff09\u8ba1\u7b97\u6bcf\u79cd\u4ea7\u54c1\u7684\u8bc4\u8bba\u6570\uff0c\u5373\u8ba1\u7b97\u5404\u79cd\u4ea7\u54c1\u7684\u9500\u91cf\uff08\u8fd9\u91cc\u9700\u8981\u7528\u5230\u6570\u636e\u53ef\u89c6\u5316\uff09\n\n4\uff09\u901a\u8fc7\u89c2\u5bdf\u9500\u91cf\u5360\u6bd4\uff0c\u83b7\u53d6\u9500\u91cf\u524dn\u7684\u4ea7\u54c1\n\n5\uff09\u83b7\u53d6\u9500\u91cf\u524dn\u7684\u4ea7\u54c1\u7684\u6709\u7528\u8d44\u6599\uff0c\u5b58\u5230\u53e6\u4e00\u4e2a\u6587\u4ef6\u91cc\n\n6\uff09\u91cf\u5316\u6bcf\u4e00\u6761\u8bc4\u8bba\u7684\u5185\u5bb9\n\n7\uff09\u8ba1\u7b97\u9500\u91cf\u524d\u5217\u7684\u4ea7\u54c1\u7684\u603b\u5206\u6570","93b321a4":"## 6.1\u628a\u5206\u6570\u8f6c\u62100-1\u533a\u95f4","d5920abe":"\u867d\u7136\u6570\u91cf\u8fc7\u591a\u6ca1\u80fd\u5f88\u597d\u5730\u5f97\u5230\u8be6\u7ec6\u7684\u6570\u5b57\uff0c\u4f46\u6211\u4eec\u8fd8\u662f\u80fd\u591f\u4ece\u8fd9\u4e2a\u997c\u72b6\u56fe\u4e4b\u4e2d\u53d1\u73b0\u6709\u51e0\u4e2a\u5e02\u573a\u5360\u6bd4\u660e\u663e\u5927\u7684\u4ea7\u54c1\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u7814\u7a76\u9500\u91cf\u5728\u524d50\u7684\u4ea7\u54c1\u5373\u53ef","2d60e8c0":"## 6.5 \u628ascore\u8f6c\u6210\u767e\u5206\u5236,\u5e76\u628a\u6bcf\u6761\u8bc4\u8bba\u7684\u6587\u672c\u5206\u6570\u4fdd\u5b58\u5230ini_review_XXX.csv\u91cc\u9762","61e48d00":"# 5.\u83b7\u53d6\u9500\u91cf\u5728\u524d50\u7684\u4ea7\u54c1\u6570\u636e,\u5b58\u5230\u6587\u4ef6top_50_XXX\u91cc","61349c49":"## 6.2 \u5904\u7406\u7eff\u6807\u90a3\u4e00\u5217","bde7b518":"# 2.\u8ba1\u7b97\u6709\u591a\u5c11\u6b3e\u4ea7\u54c1","ea8b6762":"\u5230\u4e86\u8fd9\u91cc\uff0cdata\u8fd9\u4e2adataframe(\u4e5f\u5c31\u662fevery_review_info.csv\u8fd9\u4e2a\u6587\u4ef6)\u91cc\u9762\u5df2\u7ecf\u5b58\u50a8\u597d\u4e86\u6240\u6709\u7b2c\u4e8c\u95ee\u9700\u8981\u7684\u6570\u636e\uff0c\u6211\u4eec\u4ecedata\u8fd9\u91cc\u9762\u63d0\u53d6\u6211\u4eec\u9700\u8981\u76844\u5217\uff1a'product_id','review_id','review_date','final_review_score'","8e625ff1":"# 1.\u5220\u9664\u65e0\u6548\u8bc4\u8bba\u5217","71130863":"\u8bc4\u5206\u6700\u9ad8\u768410\u4e2a\u4ea7\u54c1\u7684\u7f16\u53f7\u5982\u4e0b","3e829bd1":"\u6211\u4eec\u518d\u6765\u67e5\u770b\u4e00\u4e0b\uff0c\u5404\u6761\u8bc4\u8bba\u7684\u603b\u5f97\u5206\u53ca\u5206\u6570\u5206\u5e03\uff0c\u53ef\u4ee5\u770b\u5230\u4e5f\u5448\u6b63\u592a\u5206\u5e03\uff0c\u6240\u4ee5\u6211\u4eec\u8fd9\u4e2a\u8bc4\u4ef7\u4f53\u7cfb\u662f\u7b26\u5408\u7edf\u8ba1\u89c4\u5f8b\u7684","d591030d":"\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u83b7\u5f97top_XX\u91cc\u9762\u8fd9\u51e0\u53f7\u4ea7\u54c1\u7684\u8bc4\u4ef7\u6570\u636e\u5c31\u53ef\u4ee5\u4e86","560c37c7":"\u6211\u4eec\u53ea\u9700\u8981\u63d0\u53d6\u5176\u4e2d\u7684review_id\uff0cproduct_id\uff0cvine,review_body\uff0cstar_rating,helpful_votes,total_votes\u8fd97\u90e8\u5206\uff0c\u53ef\u4ee5\u770b\u5230\u8fd94\u5217\u90fd\u662f11470\u884c\u6570\u636e\uff0c\u6ca1\u6709\u7f3a\u5931\u503c\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u8fdb\u884c\u7f3a\u5931\u503c\u5904\u7406","9acd8a69":"# 7.\u8ba1\u7b97\u8fd950\u4e2a\u4ea7\u54c1\u7684\u5e73\u5747\u8bc4\u5206","3782c9bd":"# 6.\u83b7\u53d6\u8bc4\u8bba\u5206\u6570+\u8bcd\u4e91\u56fe","326a41d4":"\u53ef\u4ee5\u770b\u5230\uff0c\u65e0\u6548\u8bc4\u8bba\u5360\u6bd4\u5e76\u4e0d\u5927\uff0c\u4e0d\u5230\u4e94\u5206\u4e4b\u4e00","f07de36e":"\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u8bc4\u5206\u7684\u5206\u5e03\uff0c\u53ef\u4ee5\u770b\u5230\u57fa\u672c\u5448\u6b63\u592a\u5206\u5e03","a28d9fd3":"# 2.1 \u5148\u770b\u4e00\u4e0b\u9500\u91cf\u4f4e\u7684\u4ea7\u54c1\u6709\u591a\u5c11","094c87ba":"\u8fd9\u6837\u770b\u6765\uff0c\u9500\u91cf\u5728\u524d50\u7684\u4ea7\u54c1\u5360\u636e\u4e86\u5e02\u573a70%\u4ee5\u4e0a\u7684\u4efd\u989d\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u5bf9\u8fd950\u4e2a\u4ea7\u54c1\u8fdb\u884c\u5206\u6790\u4fbf\u80fd\u591f\u8986\u76d6\u5e02\u573a\u7684\u7edd\u5927\u90e8\u5206\u9700\u6c42\uff0c\u8fd950\u4e2a\u4ea7\u54c1\u4e3a","40ee3f9e":"## 6.3\u8ba1\u7b97helpfulness rating","24c55fcd":"\u628a\u6700\u7ec8\u5206\u6570\u4fdd\u5b58\u5230final_XXX_score.csv\u91cc\u9762","8e8e282a":"\u53ef\u4ee5\u770b\u5230\uff0c\u4e0d\u540c\u7684\u9500\u91cf\u6570\u5b57\u4e00\u5171\u6709423\u79cd","b496151b":"\u6700\u540e\u7684\u7efc\u5408\u8bc4\u5206\u5982\u4e0b","27d859fb":"## 1.1\u67e5\u770b\u6709\u6548\u8bc4\u8bba\u548c\u65e0\u6548\u8bc4\u8bba\u7684\u5360\u6bd4","114b57d1":"# 6.6\u8ba1\u7b97\u6bcf\u4e00\u6761\u8bc4\u8bba\u7684\u603b\u5f97\u5206","672d78ad":"## 6.4\u628a\u661f\u7ea7\u8bc4\u5206\u5f52\u4e00\u5316","f4131ab0":"## 6.7\u63d0\u53d6\u6570\u636e\uff0c\u4e3a\u7b2c\u4e8c\u95ee\u505a\u51c6\u5907","d532d14d":"\u53ef\u4ee5\u770b\u5230\uff0c\u9500\u91cf\u5728\u4e2a\u4f4d\u6570\u7684\u4ea7\u54c1\u53ea\u6709281\u4ef6,\u800c\u5176\u4e2d\u9500\u91cf\u4e3a1\u7684\u4ea7\u54c1\u5c31\u6709248\u4ef6","31e2d161":"## 1.2 \u5220\u9664\u65e0\u6548\u8bc4\u8bba","419fe8ba":"\u67e5\u770b\u5404\u7b49\u7ea7\u8bc4\u5206\u7684\u5360\u6bd4","f3988dbc":"\u6240\u4ee5\u8d35\u516c\u53f8\u53ef\u4ee5\u591a\u53bb\u7814\u7a76\u4e00\u4e0b\u8fd910\u6b3e\u4ea7\u54c1\u7684\u7279\u6027","3e7e27af":"## 4.\u63d0\u53d6\u9500\u91cf\u5728\u524d50\u7684\u4ea7\u54c1","bd90ecd7":"# \u51c6\u5907\u5de5\u4f5c","f0935714":"## 1.3 \u4ece\u5220\u9664\u4e86\u65e0\u6548\u8bc4\u8bba\u7684\u6570\u636e\u4e2d\u9009\u51fa\u7279\u5b9a\u76847\u5217\u6570\u636e"}}