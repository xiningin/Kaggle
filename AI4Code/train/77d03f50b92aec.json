{"cell_type":{"0402b49e":"code","267b8ace":"code","6b4d9f3a":"code","b1cefaa7":"code","ae7045a2":"code","303ae76f":"code","785b3b70":"code","0df8049b":"code","f6dc2366":"code","bcb2ce07":"code","23a3af88":"code","4f4ac9c6":"code","cd69f2f9":"code","c477d962":"code","ee8e4403":"code","7ab039a7":"code","c9411a2b":"code","6bb1d021":"code","c4374215":"code","204d35a6":"code","cfa322f9":"code","1890d629":"code","a305513b":"code","911067c4":"code","7e59500e":"markdown","bf48832f":"markdown","35118aed":"markdown","d4344c81":"markdown","12fde543":"markdown","6810f350":"markdown","89b0f967":"markdown","d27f6183":"markdown","a90d7c18":"markdown","1fff7d03":"markdown","3816190e":"markdown","8342ac90":"markdown","b14a3313":"markdown"},"source":{"0402b49e":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nfrom statsmodels.tsa.api import VAR\nfrom statsmodels.tsa.stattools import grangercausalitytests, adfuller\nfrom sklearn.metrics import mean_squared_error\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","267b8ace":"temperature_data = pd.read_csv(\"..\/input\/temperature-change\/Environment_Temperature_change_E_All_Data_NOFLAG.csv\",parse_dates = True, encoding=\"ISO-8859-1\")","6b4d9f3a":"temperature_data.drop([\"Area Code\",\"Months\",\"Element Code\", \"Element\",\"Unit\",\"Months Code\"], axis = 1, inplace = True)","b1cefaa7":"temperature_data.head()","ae7045a2":"temperature_data = temperature_data[temperature_data.Area==\"World\"].drop(\"Area\",axis = 1).T\ncols = list(range(34))\ntemperature_data.columns = cols\ntemperature_data = temperature_data.reset_index()\ntemperature_data = temperature_data.rename(columns = {\"index\" : \"Years\"})\ntemperature_data[\"Years\"] = temperature_data[\"Years\"].apply(lambda x: x.lstrip(\"Y\"))\ntemperature_data.set_index(\"Years\", inplace = True)\ntemperature_data[\"Mean_Temperature_Increase\"] = temperature_data.mean(axis = 1)\ntemperature_data.head()\n","303ae76f":"population_data = pd.read_csv(\"..\/input\/world-population-by-year\/WorldPopulation.csv\")\npopulation_data.head()","785b3b70":"population_data = population_data[[\"Year\", \"Population\"]]\npopulation_data = population_data[(1961 <= population_data.Year) & (population_data.Year <=2019)]\npopulation_data.set_index(\"Year\", inplace = True)\npopulation_data = population_data.reindex(index=population_data.index[::-1])\npopulation_data.head()","0df8049b":"temperature_data[\"Population\"] = list(population_data.Population)","f6dc2366":"data = temperature_data\ndata = data[[\"Mean_Temperature_Increase\",\"Population\"]]\ndata.head()","bcb2ce07":"plt.figure(figsize = (15,6))\nplt.plot(data[\"Mean_Temperature_Increase\"], linewidth = 3)\nplt.title(\"Mean Temperature Increase Through the World From 1961 to 2019\")\nplt.xticks(rotation = 90)\nplt.ylabel(\"Temperature (Degrees)\", fontsize = 18)\nplt.show()\n","23a3af88":"plt.figure(figsize = (15,6))\nplt.plot(data[\"Population\"], linewidth = 3)\nplt.title(\"Population Among the World From 1961 to 2019\")\nplt.xticks(rotation = 90)\nplt.ylabel(\"Population\", fontsize = 18)\nplt.show()\n","4f4ac9c6":"granger_result = grangercausalitytests(data[[\"Mean_Temperature_Increase\",\"Population\"]], 4)","cd69f2f9":"adfuller_temp = adfuller(data.Mean_Temperature_Increase)\n\nprint(\"Adfuller Statistical Value: \", adfuller_temp[0])\nprint(\"P-value: \", adfuller_temp[1])\nprint(\"\\n\")\nprint(\"Critical Values:\")\nprint(\"\\n\")\nprint(\"1%: \",adfuller_temp[4][\"1%\"])\nprint(\"5%: \", adfuller_temp[4][\"5%\"])\nprint(\"10%: \", adfuller_temp[4][\"10%\"])\nprint(\"\\n**************\\n\")\n\nadfuller_pop = adfuller(data.Population)\n\nprint(\"Adfuller Statistical Value: \", adfuller_temp[0])\nprint(\"P-value: \", adfuller_temp[1])\nprint(\"\\n\")\nprint(\"Critical Values:\")\nprint(\"\\n\")\nprint(\"1%: \",adfuller_pop[4][\"1%\"])\nprint(\"5%: \", adfuller_pop[4][\"5%\"])\nprint(\"10%: \", adfuller_pop[4][\"10%\"])","c477d962":"data = data.diff().dropna()\n\nadfuller_temp = adfuller(data.Mean_Temperature_Increase)\n\nprint(\"Adfuller Statistical Value: \", adfuller_temp[0])\nprint(\"P-value: \", adfuller_temp[1])\nprint(\"\\n\")\nprint(\"Critical Values:\")\nprint(\"\\n\")\nprint(\"1%: \",adfuller_temp[4][\"1%\"])\nprint(\"5%: \", adfuller_temp[4][\"5%\"])\nprint(\"10%: \", adfuller_temp[4][\"10%\"])\nprint(\"\\n**************\\n\")\n\nadfuller_pop = adfuller(data.Population)\n\nprint(\"Adfuller Statistical Value: \", adfuller_temp[0])\nprint(\"P-value: \", adfuller_temp[1])\nprint(\"\\n\")\nprint(\"Critical Values:\")\nprint(\"\\n\")\nprint(\"1%: \",adfuller_pop[4][\"1%\"])\nprint(\"5%: \", adfuller_pop[4][\"5%\"])\nprint(\"10%: \", adfuller_pop[4][\"10%\"])","ee8e4403":"plt.figure(figsize = (15,6))\nplt.plot(data[\"Mean_Temperature_Increase\"], linewidth = 3)\nplt.title(\"Mean Temperature Increase Through the World From 1961 to 2019\")\nplt.xticks(rotation = 90)\nplt.axhline(y = 0, linestyle = \"--\", color = \"black\" )\nplt.ylabel(\"Temperature (Degrees)\", fontsize = 18)\nplt.show()","7ab039a7":"plt.figure(figsize = (15,6))\nplt.plot(data[\"Population\"], linewidth = 3)\nplt.title(\"Population Increase Through the World From 1961 to 2019\")\nplt.xticks(rotation = 90)\nplt.ylabel(\"Population\", fontsize = 18)\nplt.show()\n# This plot can also be obtained from the\"NetChange\" column in population dataset. ","c9411a2b":"average = data.Population.mean()\nst_dev = data.Population.std()","6bb1d021":"data.Population = data.Population.apply(lambda x: (x-average)\/st_dev)\nplt.figure(figsize = (15,6))\nplt.plot(data[\"Population\"], linewidth = 3)\nplt.title(\"Normalized Population Increase Through the World From 1961 to 2019\")\nplt.xticks(rotation = 90)\nplt.ylabel(\"Population\", fontsize = 18)\nplt.axhline(y = 0, linestyle = \"--\", color = \"black\" )\nplt.show()","c4374215":"train_df = data.iloc[:int(0.8*len(data)),:]\ntest_df = data.iloc[int(0.8*len(data)):,:]","204d35a6":"#model = VAR(train_df)\n#x = model.select_order(maxlags=12) \n#x.summary()\n# to optimize the lag number one can use this","cfa322f9":"model = VAR(train_df)\nfitted_model = model.fit(maxlags = 10)\nfitted_model.summary()","1890d629":"temperature_predictions = []\nfor timestamp in range(len(test_df)):\n    train = data.iloc[timestamp: timestamp + len(train_df)]\n    preds = VAR(train).fit().forecast(VAR(train).fit().y, steps = 2)\n    temperature_predictions.append(preds[:,0])\n\ntemperature_predictions = np.array(temperature_predictions)","a305513b":"plt.figure(figsize = (15,6))\nplt.plot(test_df[\"Mean_Temperature_Increase\"], linewidth = 3)\nplt.plot(temperature_predictions[:,0], linewidth = 3)\nplt.title(\"Comparison of the Predictions and the Test Data\")\nplt.show()    \n","911067c4":"print(\"Mean Sqaured Error: \", mean_squared_error(test_df[\"Mean_Temperature_Increase\"],temperature_predictions[:,0]))","7e59500e":"So our goal is to construct a function having lagged population terms to predict the future outcomes (or in this case predict the test data). Therefore we will use the first table. Prob stands for p-value and each term having prob <=0.05 can be considered as a serious (non-negligable) independent variable for the equation we want to build. The equation will look something like this (to predict the train part of course):\n\nT(t) = 0.189456 + (-1.383326)xT(t-1) + (-1.036591)xT(t-2) + ....... + (1.123664)xP(t-10) + e(t)\n\nfor maxlag = 10","bf48832f":"<a id='3'><\/a>\n# Augmented Dickey\u2013Fuller Test\n\nAdfuller Test is used for determining whether the data is stationary or not. In a nutshell, if p-value is smaller than 0.05, then we can conclude that the data is stationary.","35118aed":"# Content of This Notebook\n\n1. [Introduction](#1)\n1. [Granger Causality Test](#2)\n1. [Augmented Dickey\u2013Fuller Test](#3)\n1. [Z Score Normalization](#4)\n1. [VAR Model and Predictions](#5)\n1. [Sources that I Utilized During Preparation](#6)","d4344c81":"<a id='4'><\/a>\n# Z Score Normalization\n\nTo place the population data around y = 0, we'll use Z-score Normalization. For more information you can check [here](https:\/\/developers.google.com\/machine-learning\/data-prep\/transform\/normalization).\n","12fde543":"<a id='5'><\/a>\n# VAR Model and Predictions","6810f350":"1. https:\/\/www.machinelearningplus.com\/time-series\/vector-autoregression-examples-python\/\n1. \"ritvikmath\" channel found in Youtube\n1. https:\/\/www.kaggle.com\/jam74001\/google-stock-prediction-var-model\/notebook","89b0f967":"As expected, population increase correlated with temperature increase from lag 1. (p-value < 0.05)","d27f6183":"<a id='2'><\/a>\n# Granger Causality Test\n\nGranger Causality Test is used for determining whether there is a relationship between two-time series. Without using this test, we already know there is a relationship between population and temperature increase by intuition. (There are different opinions regarding this relation, but I'll keep it simple for the convenience)","a90d7c18":"P-values are much greater than 0.05. That means our data is non-stationary and we should manipulate the data so it becomes stationary. The most common way is taking first difference of the data.","1fff7d03":"Thanks...","3816190e":"Now our data became stationary. We can also plot and see how it looks like after the first difference.","8342ac90":"<a id='1'><\/a>\n# Introduction\n\n**Warning:** The arguments in this part, have been written according to my knowledge. It may contain wrong, biased, and\/or missing arguments.\n\nGlobal warming is a serious problem. The modern technology that we built is doing an amazing job to meet the needs of that many people. However, to do that, it needs an energy source and petroleum is by far the most efficient one. On the other hand, CO2 emission resulting from petroleum usage is threatening. Because increased CO2 in the atmosphere, absorbs the sunbeams then reflects all the angles and that results in an increase in the temperature of the atmosphere. These facts are not new. But until these days we did not see the serious outcomes of this process. Today, we started to see considerable changes yet we are still using the petroleum because, \n\n1. Per energy it provides, it is the cheapest.\n2. It can be transported in big amounts (unlike electricity, we don't have batteries that are capable to store an equivalent amount of energy.)\n3. Petroleum market is one of the most profitable ones and to keep their values in the stock market high, they have to continue to invest in that area.\n4. Changing all the technology to utilize the alternative resources is neither easy nor cheap.\n5. Countries are likely to blame themselves rather than collaborate.\n\nThere are more things to consider but I think this is enough because the following arguments will be biased a bit so I think it is good to end there.\n\nIn this notebook, I will try to use Vector AutoRegression (VAR) on 2 different time series and try to construct a model for temperature increase. Hope you'll enjoy.","b14a3313":"<a id='6'><\/a>\n# Sources that I Utilized During Preparation"}}