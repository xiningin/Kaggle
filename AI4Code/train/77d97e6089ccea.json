{"cell_type":{"fd345e9c":"code","a3af935b":"code","1a4ce3f4":"code","dea5c0d4":"code","66bfedb9":"code","b5a3871a":"code","d5445ffc":"code","df8a9d96":"code","d35fe6b0":"code","2d42fd9c":"code","1c3841d7":"code","75f269bd":"markdown","bf8de981":"markdown"},"source":{"fd345e9c":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom collections import defaultdict, Counter\nfrom tqdm import tqdm\n","a3af935b":"test_path = \"..\/input\/2020-digix-advertisement-ctr-prediction\/test_data_A.csv\"\ntrain_path = \"..\/input\/2020-digix-advertisement-ctr-prediction\/train_data\/train_data.csv\"","1a4ce3f4":"# train dataset\u5e9e\u5927\uff084\u5343\u4e07\uff09\uff0c\u6545\u4ee5100\u4e07\u4efd\u4e3a\u4e00\u6279\u8bfb\u53d6\uff0c\u5e76\u4ece\u6bcf\u6279\u4e2d\u62bd\u53d65%\u4f5c\u4e3a\u65b0\u7684train dataset\nchunkSize = 10 ** 6\nnum_of_chunk = 0\ntrain = pd.DataFrame()\n    \nfor chunk in tqdm(pd.read_csv(train_path, iterator=True, sep='|', chunksize=chunkSize)):\n    num_of_chunk += 1\n    train = pd.concat([train, chunk.sample(frac=.05, replace=False, random_state=123)], axis=0)\n    #print('Processing Chunk No. ' + str(num_of_chunk))     \n    \ntrain.reset_index(drop=True, inplace=True)\n\n# train\u7684\u957f\u5ea6\uff0c\u7a0d\u540edf\u91cd\u65b0\u5206\u5272\u7d22\u5f15\u7528\u9014\ntrain_len = len(train)\ntrain_len","dea5c0d4":"train.head()","66bfedb9":"train.info()","b5a3871a":"train['useage'] = 'train'\ntrain['id'] = np.nan\nloop = True\nchunks = []\n\ntest = pd.read_csv(test_path, iterator=True, sep='|')\nwhile loop:\n    try:\n        #print(index)\n        chunk = test.get_chunk(chunkSize)\n        chunks.append(chunk)\n        #index += 1\n\n    except StopIteration:\n        loop = False\n        print(\"testing data iteration stopped.\")\n\nfor i in tqdm(chunks):\n    test = pd.concat(chunks, ignore_index=True)\n\ntest['useage'] = 'test'\ntest['label'] = np.nan\ndata = pd.concat([train, test])","d5445ffc":"data.info","df8a9d96":"data.head()","d35fe6b0":"age = Counter(age for age in train['age'])\nitems = sorted(age.items())\nx_age_count = [i[:][0] for i in items]\ny_age_count = [i[:][1] for i in items]\nplt.figure(figsize = (5, 5))\nsns.barplot(y = y_age_count, x = x_age_count)","2d42fd9c":"city = Counter(city for city in train['city'])\ncity_items = city.most_common(20)\nx_city_count = [i[:][0] for i in city_items]\ny_city_count = [i[:][1] for i in city_items]\nplt.figure(figsize = (10, 10))\nsns.barplot(y = y_city_count, x = x_city_count)\nplt.xticks(rotation=90)","1c3841d7":"city_rank = Counter(city_rank for city_rank in train['city_rank'])\ncity_rank_items = sorted(city_rank.items())\nx_city_rank_count = [i[:][0] for i in city_rank_items]\ny_city_rank_count = [i[:][1] for i in city_rank_items]\nplt.figure(figsize = (5, 5))\nsns.barplot(y = y_city_rank_count, x = x_city_rank_count)\n#plt.xticks(rotation=90)","75f269bd":"# **Age interval**","bf8de981":"Top 20 resident city of a user:"}}