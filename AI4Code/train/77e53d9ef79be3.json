{"cell_type":{"938f8f72":"code","a7688b76":"code","c6718391":"code","d354f322":"code","099a77b7":"code","7dbfbe39":"code","85a9fe33":"code","3982ef7d":"code","cc1b05d2":"code","3cab9c33":"code","53ee71b2":"code","a0d793c7":"code","727f4a43":"code","10a87f29":"code","ee00feb9":"code","445fbebd":"code","ea3ca06c":"code","484ee136":"code","70bb17c2":"code","f9f6c188":"code","11a6e57c":"code","2a653b3d":"code","97118c16":"code","b561ea92":"code","93c57ac7":"code","9d57a1b5":"code","c583920a":"code","d1ef25eb":"code","d106a368":"code","a6fb0452":"code","c91c2717":"code","e0eadf63":"code","577c0f73":"code","b11836b0":"code","8834b016":"code","24871d24":"code","bef27810":"code","90145382":"code","1cc29a25":"code","474d0668":"code","cab667e9":"code","c8096c4b":"code","f58bdf5b":"code","32d2db29":"code","1590b0c1":"code","1f779515":"code","a9dcb275":"code","83274ae5":"code","484ce3fc":"code","5f7b68bd":"code","37b35bb6":"code","0b127bfe":"code","bf4fba29":"code","fa3e7fbd":"code","1531260c":"code","3a8a4cf6":"code","178365b0":"code","8eddb2ff":"code","40c5d2ce":"code","b6bc7fe5":"code","853bdb85":"code","ec8d294c":"code","db65ebf4":"code","7fff616b":"code","f2ddc889":"code","543a0e31":"code","5051dc20":"code","f19bffd3":"code","8272bf54":"code","7764fdfd":"code","105d0fc8":"code","0c672138":"code","fe97a48f":"code","66d8e2b1":"code","91a94db4":"code","228ab690":"code","9d09e403":"code","2e147234":"code","0c83270c":"code","f617841d":"code","882f2dfb":"code","bfa8af8f":"code","466b6c0e":"code","f60a0442":"code","4b2b65b2":"code","d425d37c":"code","e0886ace":"markdown","7ce1c73e":"markdown","55312ba9":"markdown","e0c8acb8":"markdown","f2e2b989":"markdown","30f8de33":"markdown","a629bec5":"markdown","e43483a5":"markdown","7ec72136":"markdown","c69f8583":"markdown","6014651a":"markdown","ce6359e5":"markdown","90051911":"markdown","bc063ebb":"markdown","fad2272f":"markdown","36059e22":"markdown","2aeb3259":"markdown","a9ec876b":"markdown","98a74c74":"markdown","be1fe34b":"markdown","4acb6997":"markdown","0f0442d3":"markdown","052d8c29":"markdown","06aa2bc3":"markdown","2aaa321f":"markdown","121bb210":"markdown","8e403cf2":"markdown","57753b80":"markdown","58a2d1e0":"markdown","45b4dcc4":"markdown"},"source":{"938f8f72":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a7688b76":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","c6718391":"df_train= pd.read_csv('https:\/\/raw.githubusercontent.com\/smithaprakash91\/Machine_Learning_Foundation_Projects\/main\/train_data.csv')\ndf_train.shape","d354f322":"df_test=pd.read_csv('https:\/\/raw.githubusercontent.com\/smithaprakash91\/Machine_Learning_Foundation_Projects\/main\/test_data.csv')\ndf_test.shape","099a77b7":"df_train.info()","7dbfbe39":"df_train.isnull().sum()","85a9fe33":"df_train.describe(include='all')","3982ef7d":"df_train.dtypes","cc1b05d2":"df_train['sex'].value_counts()","3cab9c33":"df_train['smoker'].value_counts()","53ee71b2":"df_train['region'].value_counts()","a0d793c7":"df_train_copy = df_train.copy()","727f4a43":"new_data = {'sex':{'male': 0, 'female': 1},\n           'smoker':{'no':0, 'yes':1},\n           'region':{'southeast':0, 'northeast':1,'southwest':2,'northwest':3}}","10a87f29":"df_train_copy = df_train.copy()\ndf_train_copy.replace(new_data, inplace=True)","ee00feb9":"df_train_copy.head()","445fbebd":"df_train_copy.describe()","ea3ca06c":"x= df_train_copy.corr()\nx","484ee136":"import seaborn as sns\nplt.figure(figsize=(10,8))\nsns.heatmap(x, annot=True, cmap='BuPu')","70bb17c2":"print(df_train['sex'].value_counts().sort_values()) \nprint(df_train['smoker'].value_counts().sort_values())\nprint(df_train['region'].value_counts().sort_values())","f9f6c188":"df_train_copy['region'].value_counts()","11a6e57c":"plt.figure(figsize=(14,8))\nsns.barplot(x='region', y='charges', data=df_train_copy, palette='Set1')","2a653b3d":"plt.figure(figsize=(14,7))\nsns.barplot(x='region', y='smoker',hue='sex',data=df_train_copy, palette='Set2')","97118c16":"df_train['age'].mean()","b561ea92":"df_train['age'].median()","93c57ac7":"plt.figure(figsize=(14,7))\nsns.distplot(df_train['age'])","9d57a1b5":"plt.figure(figsize=(14,7))\nsns.lineplot(x='age', y='charges', data=df_train_copy, palette='Set3')","c583920a":"df_train_copy['bmi'].median()","d1ef25eb":"plt.figure(figsize=(14,8))\nsns.distplot(df_train_copy['bmi'], color='g')","d106a368":"plt.figure(figsize=(14,9))\nsns.scatterplot(x='bmi', y='charges', hue='sex', data=df_train_copy, palette='Reds')","a6fb0452":"df_train_copy['sex'].value_counts()","c91c2717":"df_train_copy['sex'].value_counts().plot(kind='pie', \n                                         figsize=(16,7), autopct='%1.1f%%',\n                                         explode=(0,0), fontsize=13)\nplt.title('Gender Ratio', fontsize=20)","e0eadf63":"df_train_copy['smoker'].value_counts()","577c0f73":"df_train_copy['smoker'].value_counts().plot(kind='pie', \n                                         figsize=(16,7), autopct='%1.1f%%',\n                                         explode=(0,0), fontsize=13)\nplt.title('Percentage of Smokers', fontsize=20)","b11836b0":"plt.figure(figsize=(14,8))\nsns.distplot(df_train_copy['charges'], color='r')","8834b016":"plt.figure(figsize=(14,9))\nsns.barplot(x='smoker', y='charges', hue='sex', data=df_train_copy, palette='Blues')","24871d24":"df_train.head()","bef27810":"df_train = df_train.drop('region', axis=1)\ndf_train","90145382":"from sklearn.preprocessing import LabelEncoder","1cc29a25":"le = LabelEncoder()\ndf_train['sex'] = le.fit_transform(df_train['sex'])\ndf_train['smoker'] = le.fit_transform(df_train['smoker'])","474d0668":"df_train.head()","cab667e9":"feature_cols = ['age','sex','bmi','children','smoker','id']\nX = df_train[feature_cols]\nX","c8096c4b":"y = df_train['charges']\ny","f58bdf5b":"print(X.shape)\nprint(y.shape)","32d2db29":"from sklearn.model_selection import train_test_split","1590b0c1":"X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2, random_state=30)","1f779515":"X_train.head()","a9dcb275":"y_train.head()","83274ae5":"X_test.head()","484ce3fc":"y_test.head()","5f7b68bd":"from sklearn.preprocessing import StandardScaler","37b35bb6":"scaler = StandardScaler()","0b127bfe":"df_train.columns","bf4fba29":"X_train = scaler.fit_transform(X_train)\nX_test = scaler.fit_transform(X_test)","fa3e7fbd":"from sklearn.linear_model import LinearRegression","1531260c":"lr = LinearRegression()\nlr","3a8a4cf6":"lr.fit(X_train, y_train)","178365b0":"lr.intercept_","8eddb2ff":"lr.coef_","40c5d2ce":"feature_cols","b6bc7fe5":"feature_cols.insert(0,'Intercept')\nfeature_cols","853bdb85":"coef = lr.coef_.tolist()\ncoef","ec8d294c":"coef.insert(0,lr.intercept_)\ncoef","db65ebf4":"eq1 = zip(feature_cols, coef)\n\nfor c1, c2 in eq1:\n    print(c1,c2)","7fff616b":"y_pred_train = lr.predict(X_train)","f2ddc889":"y_pred_test = lr.predict(X_test)","543a0e31":"X_test","5051dc20":"y = 13235.757551197006 + (0.53889385 * 3601.5401666170856) + (-0.92796073 * 127.25478304212501) + (0.37232702 * 1927.3318761341295) + (-0.11773266 * 546.4395680810161) + (-0.5216818 * 9678.806637558071) + (1.06965852 * 275.26348393926503)\ny","f19bffd3":"from sklearn.metrics import mean_absolute_error, mean_squared_error","8272bf54":"MAE_train = mean_absolute_error(y_train, y_pred_train)\nMAE_test = mean_absolute_error(y_test, y_pred_test)","7764fdfd":"MSE_train = mean_squared_error(y_train, y_pred_train)\nMSE_test = mean_squared_error(y_test, y_pred_test)","105d0fc8":"print('MSE for training set is {}'.format(MSE_train))\nprint('MSE for testing is {}'.format(MSE_test))","0c672138":"from sklearn.metrics import r2_score","fe97a48f":"r2_score_train = r2_score(y_train, y_pred_train)\nr2_score_test = r2_score(y_test, y_pred_test)","66d8e2b1":"r2_score_train","91a94db4":"r2_score_test","228ab690":"print('Rsquared value for training set is {}'.format(r2_score_train))\nprint('Rsquared for testing set is {}'.format(r2_score_test))","9d09e403":"df_train_copy.head()","2e147234":"X_ = df_train_copy.drop('charges',axis=1).values\ny_ = df_train_copy['charges'].values.reshape(-1,1)\n\nfrom sklearn.model_selection import train_test_split\nX_train_, X_test_, y_train_, y_test_ = train_test_split(X_,y_,test_size=0.2, random_state=42)\n\nprint('Size of X_train_ : ', X_train_.shape)\nprint('Size of y_train_ : ', y_train_.shape)\nprint('Size of X_test_ : ', X_test_.shape)\nprint('Size of Y_test_ : ', y_test_.shape)","0c83270c":"from sklearn.ensemble import RandomForestRegressor\nfrom sklearn.datasets import make_regression","f617841d":"rf_reg = RandomForestRegressor(max_depth=50, min_samples_leaf=12, min_samples_split=7,\n                       n_estimators=1200)\nrf_reg.fit(X_train_, y_train_.ravel())","882f2dfb":"y_pred_rf_train_ = rf_reg.predict(X_train_)","bfa8af8f":"y_pred_rf_test_ = rf_reg.predict(X_test_)","466b6c0e":"r2_score_rf_train_ = r2_score(y_train_, y_pred_rf_train_)\nr2_score_rf_test_ = r2_score(y_test_, y_pred_rf_test_)","f60a0442":"print('R2 score (train) : {0:.3f}'.format(r2_score_rf_train_))\nprint('R2 score (test) : {0:.3f}'.format(r2_score_rf_test_))","4b2b65b2":"models = [('Linear Regression', r2_score_train, r2_score_test),\n          ('Random Forest Regression', r2_score_rf_train_, r2_score_rf_test_)]","d425d37c":"predict = pd.DataFrame(data = models, columns=['Model', 'R2_Score(training)', 'R2_Score(test)'])\npredict","e0886ace":"**Model Evalution**\n* Preparing X and y for training and testing","7ce1c73e":"**Southeast region has the highest and northwest has the least number of smokers with males as prominent smokers**","55312ba9":"**B. How age is related with the charges?**","e0c8acb8":"* Label encoding for \u201c**sex**\u201d and \u201c**smoker**\u201d","f2e2b989":"Problem Statement\n\nThe current process suffers from the following problems:\n- The company uses manpower to predict the medical expenses of its insurers. Many factors are considered such as age, BMI, smoking habits, number of children, etc.\n- It is a time and resource-intensive process and many times, inaccurate.\n- The company plans to modernize its legacy systems and wants to implement an automated way of predicting the medical expenses of its insurers based on various factors.\n","30f8de33":"**Interpreting Model Coefficients**","a629bec5":"**2. Age**\n\nA. What's the mean and median value of the age feature?","e43483a5":"**4. Gender**\n\nA. What's the gender ratio?","7ec72136":"**5. Smokers**\n\nA. What's percentage of smokers?","c69f8583":"**Southeast region has the most number of beneficiaries**","6014651a":"**Converting categorical values into numerical**","ce6359e5":"- A higher BMI means that the individual is at a higher risk of heart diseases and might frequently visit the hospitals due to weight-related issues.\n- People with a body mass index (BMI) of 30 or higher can expect to pay more each month for health insurance.\n- In some cases,Health insurance for obese people costs 25 to 50 percent more than coverage for people with a BMI below 30.","90051911":"**Model evaluation**","bc063ebb":"* As smoking is highly related to health disorders, like cancer, heart disease, stroke, lung diseases, diabetes, and chronic obstructive pulmonary disease (COPD), which includes emphysema and chronic bronchitis.\n* Smoking also increases risk for tuberculosis, certain eye diseases, and problems of the immune system, including rheumatoid arthritis.\n* Most of the health insurance companies are allowed to charge smokers up to 50% more for premiums.\n\n**Overall Analysis**\n\n* Rising cost of medical treatment has been a significant rise in the number of people buying a health insurance policy.\n* Premium rates will be increased if the customer has high BMI.\n* People with high BMI are at risk of serious ailments, such as heart diseases, type 2 diabetes, breathing problems, hypertension, and cancer.\n\n**Future Insights**\n\n* Premium payments depends on type of health insurance cover the buyers choose. The premium amount will increase if the customers have purchased add-on covers.\n* Individual or group insurance has low premium rate, while family floater has high premium rate.","fad2272f":"**Splitting Dataset into testing and training**","36059e22":"**B. How BMI will affect medical insurance?**","2aeb3259":"**Impact on health and life insurance premium**\n- Since smokers pose a greater risk of contacting this wide array of diseases mentioned above, it makes them more prone to health complications\n- Most insurers will charge a higher premium amount for smokers compared to non-smokers\n- Smokers are highly related with insurance charges","a9ec876b":"**y = 13235.757551197006 + age 3601.5401666170856 + sex 127.25478304212501 + bmi 1927.3318761341295 + children 546.4395680810161 + smoker 9678.806637558071 + id 275.26348393926503**","98a74c74":"**3. BMI (Body Mass Index)**\n\nA. What is the median value of the bmi feature?","be1fe34b":"- The ratio of male (51%)gender is higher than female(49%)","4acb6997":"**Model Evaluation using Rsquared value**","0f0442d3":"**B. Which region has highest and least number of smokers?**","052d8c29":"* Dropping least important feature of the dataset","06aa2bc3":"**Applying Linear Regression**","2aaa321f":"**Using the Model for Prediction**","121bb210":"**Applying StandardScalar to X_train and y_test**","8e403cf2":"**6. Charges**","57753b80":"**1. Region**\n\nA. Which region has the most number of beneficiaries in the training set?","58a2d1e0":"- Age is one of the primary factors influencing the life insurance premium rate, whether seeking a term or permanent policy.\n- Typically, the premium amount increases average about 8% to 10% for every year of age;\n- It can be as low as 5% annually if beneficiary is in 40s, and as high as 12% annually or if over age 50.","45b4dcc4":"**Applying Random Forest Regressor**"}}