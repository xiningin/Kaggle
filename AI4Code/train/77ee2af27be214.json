{"cell_type":{"74ee5f24":"code","90cdd777":"code","ebc5e71b":"code","ab961b27":"code","7b766695":"code","88c5e0ad":"code","a918f829":"code","c7269d2f":"code","1fbd8aa6":"code","dcb638d7":"code","38715020":"code","8fc8e9a9":"code","9295858c":"code","9f702b4a":"code","93b28734":"code","d5fe7320":"code","3830c7e9":"code","ad8b5413":"markdown","2ee3cc49":"markdown","683f93b9":"markdown","6a78d4b5":"markdown","eb490d69":"markdown","4cb6054b":"markdown","7d1eae0d":"markdown","7715091a":"markdown","56aa1361":"markdown","5dc3e25d":"markdown","4cb5aeb0":"markdown","4efff2e6":"markdown"},"source":{"74ee5f24":"import numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport seaborn as sns\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split","90cdd777":"iris = pd.read_csv(\"..\/input\/Iris.csv\")\nprint(\"Type: \"+str(type(iris)))\nprint(\"Names of column fields: \\n\"+str(iris.columns))\nprint(\"\\n Shape of dataset: \"+str(iris.shape))\nprint(\"Head of dataset: \")\nprint(iris.head())","ebc5e71b":"print(\"\\n Brief description of data: \")\nprint(iris.describe())","ab961b27":"# Shuffling data\nfrom sklearn.utils import shuffle\niris = shuffle(iris)","7b766695":"# Seperating target and features\nX = iris.iloc[:,1:5].values\ny = iris.iloc[:,5].values","88c5e0ad":"# Scaling and normalization\nX_scale = (X-X.mean(0))\/X.std(0)","a918f829":"# Encoding categorical data\nlabelencoder_y = LabelEncoder()\ny_encode = labelencoder_y.fit_transform(y)\n\nprint(\"Name of classes: \"+str(labelencoder_y.classes_))\nprint(\"Classes: \"+str(np.unique(y_encode)))","c7269d2f":"print(y.reshape(150,1).shape)\nprint(X.shape)","1fbd8aa6":"# Using pairplot available in the seaborn package to visualize data\ndata = np.hstack((X,y.reshape(150,1)))\ncolumns = ['SepalLengthCm', 'SepalWidthCm', 'PetalLengthCm', 'PetalWidthCm','Species']\nsns.pairplot(pd.DataFrame(data= data, columns= columns),hue=\"Species\")","dcb638d7":"# from above plot we can easily arrive to following conclusions\n# 1. from the plot of SepalWidthCm vs PetalWidthCm we can see a clear seperation between Setosa and other #species based on PetalWidth\n# 2. from the plot of SepalWidthCm vs SepalLengthCm there is ALMOST  boundary between versicolor and verginica and a clear boundary between setosa and other two species based on the first obeservation we can with 100 certainity and accuracy predict whether specie is setosa or not, based on second obervation we can with high accuracy predict the specie.","38715020":"X_train, X_test, y_train, y_test = train_test_split(X_scale, y_encode,test_size=0.3)","8fc8e9a9":"from sklearn.ensemble import RandomForestClassifier\nclf = RandomForestClassifier(n_estimators=40, criterion='entropy')\nclf.fit(X_train, y_train)","9295858c":"y_pred = clf.predict(X_test)","9f702b4a":"from sklearn.metrics import accuracy_score\nprint(accuracy_score(y_test, y_pred))","93b28734":"from sklearn.metrics import confusion_matrix\ncnf_matrix = confusion_matrix(y_test, y_pred)\n\nfrom mlxtend.plotting import plot_confusion_matrix\nfig, ax = plot_confusion_matrix(conf_mat=confusion_matrix(y_test, y_pred),\n                                colorbar=True,\n                                show_absolute=False,\n                                show_normed=True)\nplt.xticks(np.arange(0,3,1),labelencoder_y.classes_,rotation=90,size=15)\nplt.yticks(np.arange(0,3,1),labelencoder_y.classes_,size=15)\nplt.xlabel('Predicted label',color='red',fontsize=20)\nplt.ylabel('True label',color='red',fontsize=20)\nplt.show()","d5fe7320":"print(list(zip(iris.columns[1:5].values, clf.feature_importances_)))\nplt.barh(iris.columns[1:5].values, clf.feature_importances_)","3830c7e9":"temp = []\nfor i in range(3,100,2):\n    clf = RandomForestClassifier(n_estimators = i, criterion='entropy', max_depth=150, random_state=15)\n    clf.fit(X_train, y_train)\n    y_pred = clf.predict(X_test)\n    temp.append(accuracy_score(y_test, y_pred))\nplt.plot(np.arange(3,100,2), temp, color='red')","ad8b5413":"## 2. Importing the dataset","2ee3cc49":"## 1. Importing necessary packages","683f93b9":"## 8. Accuracy","6a78d4b5":"## 5. Splitting the data into test\/train","eb490d69":"## 10. Importance of each feature","4cb6054b":"## 9. Confusion Matrix","7d1eae0d":"## 4. Visualizing the data","7715091a":"# 11. Finding max accuracy in range of trees","56aa1361":"## 3.Preprocessing the data","5dc3e25d":"# Classification using random forest classifier on iris dataset","4cb5aeb0":"## 6. Classification algorithm - RandomForestClassifier","4efff2e6":"## 7. Prediction"}}