{"cell_type":{"e3d87c47":"code","4e55c37e":"code","b74c9143":"code","f8379b38":"code","0993c823":"code","29e73010":"code","87cbaa77":"code","f1c6752e":"markdown","61bf286a":"markdown","4f709701":"markdown","9ed809bf":"markdown"},"source":{"e3d87c47":"import json\nimport pickle\n\nimport numpy as np\nimport pandas as pd\nfrom tqdm import tqdm_notebook as tqdm\nfrom tensorflow.keras.models import load_model\nfrom tensorflow.keras.preprocessing.sequence import pad_sequences","4e55c37e":"with open('\/kaggle\/input\/quest-bi-gru-starter-code\/tokenizer.pickle', 'rb') as f:\n    tokenizer = pickle.load(f)","b74c9143":"model = load_model('\/kaggle\/input\/quest-bi-gru-starter-code\/model.h5')\nmodel.summary()","f8379b38":"train = pd.read_csv(\"\/kaggle\/input\/google-quest-challenge\/train.csv\")\ntest = pd.read_csv(\"\/kaggle\/input\/google-quest-challenge\/test.csv\")\nsubmission = pd.read_csv(\"\/kaggle\/input\/google-quest-challenge\/sample_submission.csv\")\n\nprint(train.shape)\nprint(test.shape)\ntrain.head()","0993c823":"def compute_sequences(cols, tokenizer, maxlens):\n    sequences = []\n    \n    for texts, maxlen in zip(cols, maxlens):\n        seq = tokenizer.texts_to_sequences(texts.values)\n        seq = pad_sequences(seq, maxlen=maxlen)\n        sequences.append(seq)\n    \n    return sequences","29e73010":"train_data = compute_sequences(\n    [train.question_title, train.question_body, train.answer], \n    tokenizer,\n    [30, 300, 300]\n)\n\ntest_data = compute_sequences(\n    [test.question_title, test.question_body, test.answer], \n    tokenizer,\n    [30, 300, 300]\n)","87cbaa77":"test_pred = model.predict(test_data, batch_size=512)\n\nsubmission.loc[:, 'question_asker_intent_understanding':] = test_pred\nsubmission.to_csv('submission.csv', index=False)","f1c6752e":"## Load Data","61bf286a":"## Compute Sequence","4f709701":"## Load Tokenizer and Model","9ed809bf":"# Load Data"}}