{"cell_type":{"96123c19":"code","d981f11f":"code","08f58c90":"code","bffcaefd":"code","a5742168":"code","f829bf61":"code","44e6d2cf":"code","495c7702":"code","d9c0f756":"code","d1db5545":"markdown"},"source":{"96123c19":"import sys\nsys.path.append('..\/input\/pycaret\/pyod')\nsys.path.append('..\/input\/pycaret\/pycaret')\nfrom pycaret.regression import *\n\nimport pandas as pd\nimport numpy as np\n\nimport warnings\nwarnings.filterwarnings('ignore')","d981f11f":"train = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/test.csv')","08f58c90":"for df in [train, test]:\n    df['date'] = pd.to_datetime(df['date'])\n    df['year'] = df.date.dt.year\n    df['month'] = df.date.dt.month\n    df['week']= df['date'].dt.week\n    df['day'] = df.date.dt.day\n    df['dayofweek'] = df.date.dt.dayofweek\n    df['dayofyear'] = df['date'].dt.dayofyear\n    df.drop(columns=['date'],inplace=True)  ","bffcaefd":"reg = setup(data = train,\n            target = 'num_sold',\n            train_size = 0.7, \n            normalize = True, \n            normalize_method = 'robust', \n            transform_target = True, \n            data_split_shuffle = False, \n            feature_interaction = True, \n            silent = True, \n            fold = 5, \n            n_jobs = -1) ","a5742168":"def smape(y_true, y_pred):\n    return np.mean( np.abs(y_true - y_pred) \/ (y_true + np.abs(y_pred)) * 200 )\n\nadd_metric('SMAPE', 'SMAPE', smape, greater_is_better = False)","f829bf61":"model = create_model('xgboost')","44e6d2cf":"pred = predict_model(model, data=test)\npred.head()","495c7702":"submission = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/sample_submission.csv')\nsubmission.num_sold = pred.Label\nsubmission.to_csv('submission.csv', index = False)","d9c0f756":"submission.head()","d1db5545":"# TPS Jan 2022: XGBoost"}}