{"cell_type":{"e60bb8e7":"code","b6cc2850":"code","208fc7d2":"code","52c122be":"code","3e1a16b4":"code","0ab811c5":"code","8ccecffb":"code","4598ff8f":"code","4a49eb12":"code","e4c93027":"code","f73ca73d":"code","35087e48":"code","8f79b5a7":"code","513d9b6e":"code","23aa3119":"code","cb73595d":"code","bed28677":"code","5bde3cb9":"code","dd115af9":"code","83413a2c":"code","29f6c085":"code","a2868159":"code","b68ee404":"code","5369f773":"code","09e6922b":"code","cae8f26b":"code","72beeeda":"code","fcb63912":"code","bc564a13":"code","1c7c45e4":"code","c52ddd2d":"code","0a5446f3":"code","c58a4461":"code","e68467b6":"code","9abe00fc":"code","c98fc75b":"code","4844274c":"code","6d3927b5":"code","1d309c6b":"code","31298871":"code","5c9b1fc7":"code","7c9b2e63":"code","67f78b5a":"code","16bd8d1d":"code","bebebf00":"code","dc88b694":"code","1b1f6e54":"code","562bebe4":"code","35c46cc7":"code","742f4752":"code","2cd5d171":"code","b9e0fa75":"code","f44b4c18":"code","4cec51f6":"code","d0278aa7":"code","b039f9fe":"code","b356639a":"code","821bf886":"code","db7c0caa":"code","25c9402a":"code","a98d4063":"code","4b12151c":"code","e9567b91":"code","daabd0fe":"code","d09024e7":"code","00bc808d":"code","1966930b":"code","c698600f":"code","67eee5b0":"code","3fcf594b":"code","28d7060b":"code","38e03d4a":"code","4509190c":"code","d6e7ef42":"code","5583ce9b":"markdown","b74ea7ef":"markdown","c905a797":"markdown","49425b16":"markdown"},"source":{"e60bb8e7":"#Importing Data Set\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nclass color:\n    BOLD='\\033[1m'\n    END='\\033[0m'\n    BLUE='\\033[94m'\n    \npd.set_option('display.max_columns',100)\npd.set_option('display.max_rows',100)\nimport warnings\nwarnings.simplefilter(action='ignore',category=FutureWarning)","b6cc2850":"train_df=pd.read_csv('..\/input\/hr-analytics-av\/train_hr.csv')\ntest_df=pd.read_csv('..\/input\/hr-analytics-av\/test_hr.csv')\ntrain_df.head()","208fc7d2":"test_df.head()","52c122be":"train_df.shape,test_df.shape","3e1a16b4":"train_df['Data']='train'\ntest_df['Data']='test'\ntest_df['is_promoted']=np.nan","0ab811c5":"train_df.isnull().sum()","8ccecffb":"test_df.isnull().sum()","4598ff8f":"train_df.previous_year_rating.value_counts()","4a49eb12":"test_df.previous_year_rating.value_counts()","e4c93027":"train_df.education.value_counts()","f73ca73d":"test_df.education.value_counts()","35087e48":"train_df.info()","8f79b5a7":"train_df.shape[0]+test_df.shape[0]","513d9b6e":"df=pd.concat([train_df,test_df],ignore_index=True,axis=0)\ndf.shape","23aa3119":"df.head()","cb73595d":"df.isnull().sum()","bed28677":"df.recruitment_channel.value_counts()","5bde3cb9":"pd.DataFrame(df.groupby('education')['department'])","dd115af9":"df.department.value_counts()","83413a2c":"df.education.value_counts()","29f6c085":"pd.crosstab([df.department,df.education],df.recruitment_channel)","a2868159":"pd.crosstab(df.department,df.recruitment_channel)","b68ee404":"df.previous_year_rating=df.previous_year_rating.fillna(method='bfill')\ndf.previous_year_rating=df.previous_year_rating.fillna(method='ffill')","5369f773":"df.isnull().sum()","09e6922b":"df.loc[(df.department=='Analytics') & (df.recruitment_channel==\"other\") & (df['education'].isnull()),'education']=\"Bachelor's\"\ndf.loc[(df.department=='Analytics') & (df.recruitment_channel==\"sourcing\") & (df['education'].isnull()),'education']=\"Master's & above\"\ndf.loc[(df.department=='Analytics') & (df.recruitment_channel==\"referred\") & (df['education'].isnull()),'education']=\"Master's & above\"\ndf.loc[(df.department=='Finance') & (df.recruitment_channel==\"other\") & (df['education'].isnull()),'education']=\"Bachelor's\"\ndf.loc[(df.department=='Finance') & (df.recruitment_channel==\"sourcing\") & (df['education'].isnull()),'education']=\"Below Secondary\"\ndf.loc[(df.department=='Finance') & (df.recruitment_channel==\"referred\") & (df['education'].isnull()),'education']=\"Master's & above\"","cae8f26b":"df.loc[(df.department=='HR') & (df.recruitment_channel==\"other\") & (df['education'].isnull()),'education']=\"Bachelor's\"\ndf.loc[(df.department=='HR') & (df.recruitment_channel==\"sourcing\") & (df['education'].isnull()),'education']=\"Below Secondary\"\ndf.loc[(df.department=='HR') & (df.recruitment_channel==\"referred\") & (df['education'].isnull()),'education']=\"Master's & above\"","72beeeda":"df.loc[(df.department=='Legal') & (df.recruitment_channel==\"other\") & (df['education'].isnull()),'education']=\"Bachelor's\"\ndf.loc[(df.department=='Legal') & (df.recruitment_channel==\"sourcing\") & (df['education'].isnull()),'education']=\"Below Secondary\"\ndf.loc[(df.department=='Legal') & (df.recruitment_channel==\"referred\") & (df['education'].isnull()),'education']=\"Master's & above\"","fcb63912":"df.loc[(df.department=='Operations') & (df.recruitment_channel==\"other\") & (df['education'].isnull()),'education']=\"Bachelor's\"\ndf.loc[(df.department=='Operations') & (df.recruitment_channel==\"sourcing\") & (df['education'].isnull()),'education']=\"Below Secondary\"\ndf.loc[(df.department=='Operations') & (df.recruitment_channel==\"referred\") & (df['education'].isnull()),'education']=\"Master's & above\"","bc564a13":"df.loc[(df.department=='Procurement') & (df.recruitment_channel==\"other\") & (df['education'].isnull()),'education']=\"Bachelor's\"\ndf.loc[(df.department=='Procurement') & (df.recruitment_channel==\"sourcing\") & (df['education'].isnull()),'education']=\"Below Secondary\"\ndf.loc[(df.department=='Procurement') & (df.recruitment_channel==\"referred\") & (df['education'].isnull()),'education']=\"Master's & above\"","1c7c45e4":"df.loc[(df.department=='R&D') & (df.recruitment_channel==\"other\") & (df['education'].isnull()),'education']=\"Bachelor's\"\ndf.loc[(df.department=='R&D') & (df.recruitment_channel==\"sourcing\") & (df['education'].isnull()),'education']=\"Below Secondary\"\ndf.loc[(df.department=='R&D') & (df.recruitment_channel==\"referred\") & (df['education'].isnull()),'education']=\"Master's & above\"","c52ddd2d":"df.loc[(df.department=='Sales & Marketing') & (df.recruitment_channel==\"other\") & (df['education'].isnull()),'education']=\"Bachelor's\"\ndf.loc[(df.department=='Sales & Marketing') & (df.recruitment_channel==\"sourcing\") & (df['education'].isnull()),'education']=\"Below Secondary\"\ndf.loc[(df.department=='Sales & Marketing') & (df.recruitment_channel==\"referred\") & (df['education'].isnull()),'education']=\"Master's & above\"","0a5446f3":"df.loc[(df.department=='Technology') & (df.recruitment_channel==\"other\") & (df['education'].isnull()),'education']=\"Bachelor's\"\ndf.loc[(df.department=='Technology') & (df.recruitment_channel==\"sourcing\") & (df['education'].isnull()),'education']=\"Below Secondary\"\ndf.loc[(df.department=='Technology') & (df.recruitment_channel==\"referred\") & (df['education'].isnull()),'education']=\"Master's & above\"","c58a4461":"df.previous_year_rating.value_counts()","e68467b6":"df.isnull().sum()\n","9abe00fc":"df.region.value_counts().sort_index","c98fc75b":"df['region_num']=df.region.apply(lambda x:str(x).split('_')[1]).astype(int)","4844274c":"df.head()","6d3927b5":"df.region_num.value_counts(sort=False).sort_index","1d309c6b":"df.recruitment_channel.value_counts()","31298871":"df.info()","5c9b1fc7":"df.head()","7c9b2e63":"def gender(x):\n    if x=='m':\n        x=1\n    else:\n        x=0\n    return x\ndf.gender=df.gender.apply(gender)","67f78b5a":"df.gender.value_counts()","16bd8d1d":"#drop employee_id,region,data","bebebf00":"df=df.drop(['employee_id','region'],axis=1)","dc88b694":"categor_ = df.select_dtypes(['object']).copy()\ncategor_.columns","1b1f6e54":"df=pd.get_dummies(df,columns=['department', 'education', 'recruitment_channel'])\ndf.info()","562bebe4":"df.head()","35c46cc7":"X = df[df.Data=='train']\ny=df.is_promoted.dropna()\ntest = df[df.Data=='test']","742f4752":"df.is_promoted.dropna().value_counts()","2cd5d171":"X=X.drop(['is_promoted','Data'],axis=1)\ntest=test.drop(['is_promoted','Data'],axis=1)","b9e0fa75":"X.head()","f44b4c18":"test.head()","4cec51f6":"from sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier,ExtraTreesClassifier\nfrom xgboost.sklearn import XGBClassifier\nfrom sklearn.neighbors import KNeighborsClassifier as KNN\nfrom imblearn.over_sampling import SMOTE\n\nX_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.3, random_state=0)","d0278aa7":"X_train.shape,X_test.shape,y_train.shape,y_test.shape","b039f9fe":"rf=RandomForestClassifier()\nxgb=XGBClassifier()\net=ExtraTreesClassifier()\nknn=KNN()","b356639a":"rf.fit(X_train,y_train)\nxgb.fit(X_train,y_train)\nknn.fit(X_train,y_train)\net.fit(X_train,y_train)","821bf886":"#Accuracy\nprint(color.BOLD+'RandomForestClassifier'+color.END,rf.score(X_train,y_train))\nprint(color.BOLD+'XGBClassifier'+color.END,xgb.score(X_train,y_train))\nprint(color.BOLD+'ExtraTreesClassifier'+color.END,et.score(X_train,y_train))\nprint(color.BOLD+'KNN'+color.END,knn.score(X_train,y_train))","db7c0caa":"#Accuracy\nprint(color.BOLD+'RandomForestClassifier'+color.END,rf.score(X_test,y_test))\n#print(color.BOLD+'XGBClassifier'+color.END,xgb.score(X_test,y_test))\nprint(color.BOLD+'ExtraTreesClassifier'+color.END,et.score(X_test,y_test))\nprint(color.BOLD+'KNN'+color.END,knn.score(X_test,y_test))","25c9402a":"#f1_score RandomForestClassifier\npredrf=rf.predict(X_test)\nrf.score(X_test,predrf)\nseg_rf=rf.predict(test)\n\nfrom sklearn.metrics import f1_score\nprint('f1-score of RandomForestClassifier: ',f1_score(y_test,predrf,average='weighted'))\n\n#f1_score XGBClassifier\n'''predxgb=xgb.predict(X_test)\nxgb.score(X_test,predxgb)\nseg_xgb=xgb.predict(test)\n\nfrom sklearn.metrics import f1_score\nprint('f1-score of ExtraTreesClassifier: ',f1_score(y_test,predxgb,average='weighted'))'''\n#f1_score ExtraTreesClassifier\npredet=et.predict(X_test)\net.score(X_test,predet)\nseg_et=et.predict(test)\n\nfrom sklearn.metrics import f1_score\nprint('f1-score of ExtraTreesClassifier: ',f1_score(y_test,predet,average='weighted'))\n\n#f1_score KNN\npredknn=knn.predict(X_test)\nknn.score(X_test,predet)\nseg_knn=knn.predict(test)\n\nfrom sklearn.metrics import f1_score\nprint('f1-score of KNN: ',f1_score(y_test,predet,average='weighted'))","a98d4063":"id=pd.DataFrame(test_df.employee_id,columns=['employee_id'])","4b12151c":"seg_rf=pd.DataFrame(seg_rf)\nseg_rf.columns=['is_promoted']\n\n#seg_xgb=pd.DataFrame(seg_xgb)\n#seg_xgb.columns=['is_promoted']\n\nseg_et=pd.DataFrame(seg_et)\nseg_et.columns=['is_promoted']\n\nseg_knn=pd.DataFrame(seg_knn)\nseg_knn.columns=['is_promoted']","e9567b91":"rf_1=pd.concat([id,seg_rf],axis=1).astype(int)\nrf_1.to_csv('rf_1.csv',index=False)","daabd0fe":"knn_1=pd.concat([id,seg_knn],axis=1).astype(int)\nknn_1.to_csv('knn_1.csv',index=False)","d09024e7":"et_1=pd.concat([id,seg_et],axis=1).astype(int)\net_1.to_csv('et_1.csv',index=False)","00bc808d":"import warnings\nwarnings.simplefilter(action='ignore',category=FutureWarning)\n\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import confusion_matrix,accuracy_score,classification_report,cohen_kappa_score,confusion_matrix","1966930b":"from imblearn.over_sampling import SMOTE\nsmote=SMOTE('auto')\nX_sm,y_sm=smote.fit_sample(X_train,y_train)\nprint(X_sm.shape,y_sm.shape)","c698600f":"from sklearn.ensemble import RandomForestClassifier,GradientBoostingClassifier,ExtraTreesClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom xgboost.sklearn import XGBClassifier\nrf=RandomForestClassifier()\nrf.fit(X_sm,y_sm)\ny_pred_rf=rf.predict(X_test)\nprint(color.BOLD+'Train Accuracy -:'+color.END,rf.score(X_sm,y_sm))\nprint(color.BOLD+'Test Accuracy -:'+color.END,rf.score(X_test,y_test))\nprint('\\n'*2)\ny_train_pred=rf.predict(X_sm)\ny_test_pred=rf.predict(X_test)\nprint(color.BOLD+'Classification_report Train-:\\n'+color.END,classification_report(y_sm,y_train_pred))\nprint(color.BOLD+'Accuracy_score Train-:'+color.END,accuracy_score(y_sm,y_train_pred))\nprint(color.BOLD+'Confusin Matrix Train-:\\n'+color.END,confusion_matrix(y_sm,y_train_pred))\n\nprint('======================================================================================')\nprint(color.BOLD+'Classification_report Test-:\\n'+color.END,classification_report(y_test,y_test_pred))\nprint(color.BOLD+'Accuracy_score Test-:'+color.END,accuracy_score(y_test,y_test_pred))\nprint(color.BOLD+'Confusin Matrix Test-:\\n'+color.END,confusion_matrix(y_test,y_test_pred))\nprint(color.BOLD+'Cohen_Kappa_score is-:'+color.END,cohen_kappa_score(y_test_pred,y_test,weights='quadratic'))\n","67eee5b0":"from sklearn.ensemble import RandomForestClassifier,GradientBoostingClassifier,ExtraTreesClassifier\n\nfrom sklearn.model_selection import RandomizedSearchCV","3fcf594b":"randsv=RandomizedSearchCV(estimator=RandomForestClassifier(),\n                          param_distributions=[{'n_estimators':np.arange(10,100,5),\n                                                'max_depth':np.arange(5,30,2),\n                                                'min_samples_leaf':np.arange(5,10,2),\n                                               'min_samples_split':np.arange(5,10,2)}])","28d7060b":"rand_fit=randsv.fit(X_sm,y_sm)\nprint(rand_fit)","38e03d4a":"print(rand_fit.best_estimator_)","4509190c":"rand_score=rand_fit.score(X_sm,y_sm)\nrand_score","d6e7ef42":"rfscv=RandomForestClassifier(max_depth=29,min_samples_leaf=5,min_samples_split=9,n_estimators=70)\nrfscv.fit(X_sm,y_sm)\ny_pred_rf=rfscv.predict(X_test)\nprint(color.BOLD+'Train Accuracy -:'+color.END,rfscv.score(X_sm,y_sm))\nprint(color.BOLD+'Test Accuracy -:'+color.END,rfscv.score(X_test,y_test))\nprint('\\n'*2)\ny_train_pred=rfscv.predict(X_sm)\ny_test_pred=rfscv.predict(X_test)\nprint(color.BOLD+'Classification_report Train-:\\n'+color.END,classification_report(y_sm,y_train_pred))\nprint(color.BOLD+'Accuracy_score Train-:'+color.END,accuracy_score(y_sm,y_train_pred))\nprint(color.BOLD+'Confusin Matrix Train-:\\n'+color.END,confusion_matrix(y_sm,y_train_pred))\n\nprint('======================================================================================')\nprint(color.BOLD+'Classification_report Test-:\\n'+color.END,classification_report(y_test,y_test_pred))\nprint(color.BOLD+'Accuracy_score Test-:'+color.END,accuracy_score(y_test,y_test_pred))\nprint(color.BOLD+'Confusin Matrix Test-:\\n'+color.END,confusion_matrix(y_test,y_test_pred))\nprint(color.BOLD+'Cohen_Kappa_score is-:'+color.END,cohen_kappa_score(y_test_pred,y_test,weights='quadratic'))\n","5583ce9b":"# WITH SMOTE ","b74ea7ef":"# WITHOUT SMOTE ","c905a797":"df.loc[(df.Graduated=='Yes') & (df.Spending_Score=='Average') & (df['Profession'].isnull()),'Profession']='Healthcare'\ndf.Graduated=df.Graduated.fillna(method='bfill')","49425b16":"#Accuracy\nprint(color.BOLD+'RandomForestClassifier'+color.END,rf.score(X_train,y_train))\nprint(color.BOLD+'XGBClassifier'+color.END,xgb.score(X_train,y_train))\nprint(color.BOLD+'ExtraTreesClassifier'+color.END,et.score(X_train,y_train))\nprint(color.BOLD+'KNN'+color.END,knn.score(X_train,y_train))\n#Accuracy\nprint(color.BOLD+'RandomForestClassifier'+color.END,rf.score(X_test,y_test))\nprint(color.BOLD+'XGBClassifier'+color.END,xgb.score(X_test,y_test))\nprint(color.BOLD+'ExtraTreesClassifier'+color.END,et.score(X_test,y_test))\nprint(color.BOLD+'KNN'+color.END,knn.score(X_test,y_test))"}}