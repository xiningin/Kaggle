{"cell_type":{"02200349":"code","7f830944":"code","caaff19c":"code","5c4ac624":"code","400731f4":"code","d480fce5":"code","8d274259":"code","1152b459":"code","0a0e6aa7":"code","15cdc917":"code","56ec34fd":"code","b7535d47":"code","ebebd2b2":"markdown"},"source":{"02200349":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","7f830944":"import plotly.express as px \nimport pandas as pd\nfrom datetime import datetime\nimport json","caaff19c":"import pandas as pd\ndf = pd.read_csv(\"..\/input\/mycsvfile.csv\")","5c4ac624":"def func_visitStartTime_updated(value):\n    return datetime.fromtimestamp(value)\n\ndef func_visitStartTime_to_hour(value):\n    return datetime.fromtimestamp(value).hour\n\ndef func_geoNetwork_to_continent(value):\n    json_data = value.replace(\"\\'\", \"\\\"\")\n    json_obj = json.loads(json_data)\n    return json_obj[\"continent\"]\n\ndef func_geoNetwork_to_subContinent(value):\n    json_data = value.replace(\"\\'\", \"\\\"\")\n    json_obj = json.loads(json_data)\n    return json_obj[\"subContinent\"]\n\ndef func_geoNetwork_to_country(value):\n    json_data = value.replace(\"\\'\", \"\\\"\")\n    json_obj = json.loads(json_data)\n    return json_obj[\"country\"]\n","400731f4":"df['visitStartTime_updated'] = df['visitStartTime'].apply(func_visitStartTime_updated)","d480fce5":"df['hour'] = df['visitStartTime'].apply(func_visitStartTime_to_hour)","8d274259":"df['geoNetwork_continent'] = df['geoNetwork'].apply(func_geoNetwork_to_continent)","1152b459":"df['country'] = df['geoNetwork'].apply(func_geoNetwork_to_country)","0a0e6aa7":"df.head(10)","15cdc917":"df['unit'] = 1\n# df['hour'] = pd.to_datetime(df['serverTimePretty']).dt.hour\n# For each country and hour, count number of visitors\ndfg = df[['unit', 'country', 'hour']].groupby(['country', 'hour']).sum()","56ec34fd":"dfg.reset_index(inplace=True)\n# Data cleaning, remove unknown\ndfg = dfg.query(\"country != 'Unknown'\")\ndfg.sort_values(by='hour', inplace=True)","b7535d47":"# Plotly figure\nfig = px.choropleth(dfg, locations='country', color='unit', locationmode='country names',\n                    animation_frame='hour', range_color=(0, dfg['unit'].max()),\n                    color_continuous_scale='RdPu')\n\n# Add a different title for each frame\nfor i, frame in enumerate(fig.frames):\n    frame.layout.title = 'GMT time %d:00, visitors of Google Merchandise Store' %i\nfig.show()","ebebd2b2":"Resouce and Assistance\n- https:\/\/gist.github.com\/emmanuelle\/2c96b5976caa5055caca03dca1c9d089\n- https:\/\/www.kaggle.com\/avkash\/bigquery-in-depth-using-google-analytics-data\/edit\n- Plotly \n"}}