{"cell_type":{"b964abfa":"code","2c3fc985":"code","00243a2c":"code","371132e6":"code","6a35c080":"code","909d0d72":"code","af0ea836":"code","3473b1fa":"code","d83704cb":"code","870e11b4":"code","6e4ee39b":"code","f59437b3":"code","f2102c63":"code","5c1e7907":"code","e6fdd75d":"code","464b2d5b":"code","71d96a9a":"code","2608b11d":"code","f81d8d65":"code","2863f71d":"code","f20ec916":"code","0ca0e959":"code","966389b7":"code","5998f6ca":"code","dfcc0ee0":"code","398260f7":"code","8bd6df9e":"code","258c671c":"code","81b72c04":"code","dd7b639d":"code","2c38977e":"code","9993f925":"code","705b1126":"code","e61cd47f":"code","1fde911b":"code","ee155e9c":"code","362af9b9":"code","914bf9c7":"code","67e76a00":"code","36ca36f3":"code","5adebeb0":"code","debbf3ae":"code","88fc27c7":"code","ea8296a4":"code","a35b55e1":"code","46a0d621":"code","55b6786f":"code","01c1517f":"code","da44b291":"code","e2a16971":"code","509604b7":"code","7e7dc77a":"markdown"},"source":{"b964abfa":"import pandas as pd\nimport numpy as np\n\ntrain = pd.read_csv('..\/input\/train.csv')\ntest = pd.read_csv('..\/input\/test.csv')","2c3fc985":"train.head()","00243a2c":"train.info()","371132e6":"test.info()","6a35c080":"train.isnull().sum()","909d0d72":"test.isnull().sum()","af0ea836":"import matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns","3473b1fa":"sns.set_style(style='whitegrid')\nsns.heatmap(train.isnull(),yticklabels=False,cbar=False,cmap='viridis')","d83704cb":"sns.countplot(x='Survived',data=train,hue='Sex')","870e11b4":"sns.countplot(x='Survived',hue='Pclass',data=train)","6e4ee39b":"sns.distplot(train['Age'].dropna(),kde=False,bins=30,color='darkred')","f59437b3":"sns.countplot(x='SibSp',data=train)","f2102c63":"train['Fare'].hist(bins=30,color='green',figsize=(8,5))","5c1e7907":"plt.figure(figsize=(12,7))\nsns.boxplot(x='Pclass',y='Age',data=train,palette='winter')","e6fdd75d":"def impute_age(cols):\n    Age=cols[0]\n    Pclass=cols[1]\n    \n    if pd.isnull(Age):\n        \n        if Pclass==1:\n            return 37\n        \n        if Pclass==2:\n            return 28\n        \n        if Pclass==3:\n            return 24\n    \n    else:\n        return Age","464b2d5b":"train['Age']=train[['Age','Pclass']].apply(impute_age,axis=1)","71d96a9a":"sns.heatmap(train.isnull(),yticklabels=False,cbar=False,cmap='viridis')","2608b11d":"sns.heatmap(test.isnull(),yticklabels=False,cbar=False,cmap='viridis')","f81d8d65":"train.drop('Cabin',axis=1,inplace=True)","2863f71d":"sex= pd.get_dummies(train['Sex'],drop_first=True)\nembark = pd.get_dummies(train['Embarked'],drop_first=True)","f20ec916":"train.drop(['Sex','Embarked','Name','Ticket'],axis=1,inplace=True)","0ca0e959":"train=pd.concat([train,sex,embark],axis=1)","966389b7":"train.head()","5998f6ca":"from sklearn.model_selection import train_test_split","dfcc0ee0":"X_train, X_test, y_train, y_test = train_test_split(train.drop('Survived',axis=1), \n                                                    train['Survived'], test_size=0.30, \n                                                    random_state=104)","398260f7":"from sklearn.linear_model import LogisticRegression","8bd6df9e":"logmodel = LogisticRegression()\nlogmodel.fit(X_train,y_train)","258c671c":"predictions = logmodel.predict(X_test)","81b72c04":"from sklearn.metrics import classification_report","dd7b639d":"print(classification_report(y_test,predictions))","2c38977e":"test=pd.read_csv('..\/input\/test.csv')\ntest.drop('Cabin',axis=1,inplace=True)","9993f925":"sex_test= pd.get_dummies(test['Sex'],drop_first=True)\nembark_test = pd.get_dummies(test['Embarked'],drop_first=True)","705b1126":"test.drop(['Sex','Embarked','Name','Ticket'],axis=1,inplace=True)","e61cd47f":"test=pd.concat([test,sex_test,embark_test],axis=1)","1fde911b":"test.head()","ee155e9c":"test['Age']=test[['Age','Pclass']].apply(impute_age,axis=1)","362af9b9":"nan_rows = test[test.isnull().T.any().T]\nnan_rows","914bf9c7":"test.groupby('Pclass').mean()","67e76a00":"test['Fare'][152]=12.459678","36ca36f3":"test['Fare'][152]","5adebeb0":"X_train=train.drop('Survived',axis=1)\ny_train=train['Survived']","debbf3ae":"from sklearn.linear_model import LogisticRegression","88fc27c7":"logmodel=LogisticRegression()\nlogmodel.fit(X_train,y_train)","ea8296a4":"Survived=logmodel.predict(test)","a35b55e1":"Survived","46a0d621":"test['Survived']=Survived","55b6786f":"test.head()","01c1517f":"prediction=test.drop(['Pclass','Age','SibSp','Parch','Fare','male','Q','S'],axis=1)","da44b291":"prediction.head()","e2a16971":"prediction.to_csv('prediction_titanic',index=False)","509604b7":"prediction.info()","7e7dc77a":"# Model Fitting on Test Data"}}