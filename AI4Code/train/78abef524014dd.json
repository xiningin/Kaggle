{"cell_type":{"753b106e":"code","14872662":"code","83d0063c":"code","fd1d1451":"code","b5e86cad":"code","b1135efd":"markdown","ff2e6887":"markdown","d6905e9f":"markdown"},"source":{"753b106e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","14872662":"import random\nimport pandas as pd\nimport numpy as np\nimport dill\nimport tensorflow as tf\nfrom tensorflow import keras","83d0063c":"feature_cols = dill.load(open('\/kaggle\/input\/kmarket-mlp\/feature_cols.dill','rb'))\nmodel = tf.keras.models.load_model('\/kaggle\/input\/kmarket-mlp\/val_model.hdf5')","fd1d1451":"import janestreet\nenv = janestreet.make_env() # initialize the environment\niter_test = env.iter_test() # an iterator which loops over the test set\n\nfor (test_df, sample_prediction_df) in iter_test:\n    test_df.fillna(0,inplace=True)\n    X = test_df[feature_cols].values\n    action = model(X,training=False).numpy()[0,0] > 0.5\n    sample_prediction_df.action = int(action)\n    env.predict(sample_prediction_df)","b5e86cad":"#pd.read_csv('.\/submission.csv')","b1135efd":"### This notebook is only dedicated to submitting. The model training is made in : [JMarket-Keras Starter](https:\/\/www.kaggle.com\/tchaye59\/jmarket-keras-starter)","ff2e6887":"# Generate submission","d6905e9f":"# Load model and other files"}}