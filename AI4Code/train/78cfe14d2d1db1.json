{"cell_type":{"e39dbaa4":"code","9abd1c51":"code","23663ec3":"code","d4d6b4ba":"code","ab1f63e1":"code","5bed8d1a":"code","f1fec049":"code","abd12374":"code","48e43198":"code","0470d56e":"code","f37d44e1":"code","31b83a4f":"code","cbedab0d":"markdown","eb33afe6":"markdown","e786f5c1":"markdown","2bc1d42b":"markdown","1aeabe42":"markdown","fd0098bc":"markdown","6483f653":"markdown","8ca2cdfc":"markdown","65155409":"markdown","7d3c7f28":"markdown","5e1c36d6":"markdown","efe3d80f":"markdown"},"source":{"e39dbaa4":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\nimport torch\nimport torch.nn as nn\nimport torch.nn.functional as F\nimport torch.optim as optim\nimport torchvision\nfrom torch.utils.data import DataLoader\nfrom torchvision import datasets\nimport torchvision.transforms as transforms\nimport os\nimport time\nimport sys\nimport torch.quantization","9abd1c51":"train_df = pd.read_csv('..\/input\/titanic\/train.csv')\ntrain_df.head()","23663ec3":"test_df = pd.read_csv('..\/input\/titanic\/test.csv')\ntest_df.head()","d4d6b4ba":"train_df.info()","ab1f63e1":"print(train_df.dtypes)","5bed8d1a":"def process_df(df):\n    df = df.drop([\"PassengerId\", \"Name\", \"Ticket\", \"Cabin\", \"Embarked\"], axis=1)\n    df[\"Age\"] = df[\"Age\"].fillna(df[\"Age\"].mean())\n    df = df.replace(\"male\", 0)\n    df = df.replace(\"female\", 1)\n    return df\n\ntrain_df = process_df(train_df)\ntest_df = process_df(test_df)\ntrain_df.head()","f1fec049":"class Dataset:\n    def __init__(self, df):\n        self.df = df\n        self.X = self.df.drop([\"Survived\"], axis=1)\n        self.Y = self.df[\"Survived\"]\n    \n    def __len__(self):\n        return self.df.shape[0]\n    \n    def __getitem__(self, idx):\n#         print(type(self.X.iloc[idx,:]))\n#         print(type(self.Y.iloc[idx]))\n        return self.X.iloc[idx,:].values, self.Y.iloc[idx]\n\ntrain_dataset = Dataset(train_df)\n# test_dataset = Dataset(test_df)\nlen(train_dataset)","abd12374":"BATCH_SIZE = 32\ntrain_dataloader = DataLoader(train_dataset, batch_size=BATCH_SIZE, shuffle=True, drop_last=True)\n\n# x\u306b\u5165\u529b\uff0cy\u306b\u30e9\u30d9\u30eb\u304c\u5165\u308b\nfor x,y in train_dataloader:\n    print(x,y)\n    break","48e43198":"class Net(nn.Module):\n    def __init__(self, input_sz, hidden_sz, out_sz):\n        super(Net, self).__init__()\n        self.f1 = nn.Linear(input_sz, hidden_sz)\n        self.f2 = nn.Linear(hidden_sz, out_sz)\n        \n    def forward(self, x):\n        h1 = F.sigmoid(self.f1(x))\n        y = self.f2(h1)\n        \n        return y\n\ninput_sz = 6\nhidden_sz = 3\nout_sz = 2\nnet = Net(input_sz, hidden_sz, out_sz)","0470d56e":"learning_rate = 0.01\nloss_func = nn.MSELoss(reduction=\"sum\")\noptimizer = optim.Adam(net.parameters(), lr=learning_rate)\nepoch = 32\ndef train():\n    for e in range(epoch):\n        for X, labels in train_dataloader:\n            T = convert_label_to_onehot(labels)\n            y = F.softmax(net(X.float()), dim=1)\n            loss = loss_func(y, torch.FloatTensor(T))\n            loss.backward()\n            optimizer.step()\n            \ndef convert_label_to_onehot(labels):\n    onehot = np.zeros((len(labels), max(labels)+1))\n    idx = [(i, t.item()) for i, t in enumerate(labels)]\n    for i in idx:\n        onehot[i] = 1\n    return onehot\n\ntrain()","f37d44e1":"# torch.max()\u306e\u7c21\u5358\u306a\u8aac\u660e\nprob = torch.tensor([[0.1, 0.9],\n                    [0.2, 0.8],\n                    [0.6, 0.4]])\nmax, argmax = torch.max(prob, dim=1)\nprint(\"max\\t\",max)\nprint(\"argmax\\t\",argmax)              ","31b83a4f":"def test():\n    test_X = torch.tensor(test_df.iloc[:,:].values)\n    test_Y = net(test_X.float())\n    survived = torch.max(test_Y, dim=1)[1]\n    test_paID = pd.read_csv('..\/input\/titanic\/gender_submission.csv')['PassengerId']\n    sub_df = pd.DataFrame({\"PassengerId\":test_paID.values, \"Survived\":survived})\n    print(sub_df)\n    return sub_df\n    \nsub_df = test()\nsub_df.to_csv(\".\/submission.csv\", index=False)\n    ","cbedab0d":"DataFrame\u306e\u30e1\u30f3\u30d0\u5909\u6570\u3067\u3042\u308b`dtypes`\u3067\u306f\uff0c\u5404\u5217\u304c\u3069\u306e\u3088\u3046\u306a\u30c7\u30fc\u30bf\u578b\u3067\u3042\u308b\u304b\u304c\u5206\u304b\u308a\u307e\u3059\uff0e\n\n`object`\u306f\uff0c\u6587\u5b57\u5217\u3067\u3042\u308b\u3068\u8003\u3048\u308c\u3070\u826f\u3044\u3067\u3059\uff0e","eb33afe6":"\u307e\u305a\u306f\u30e2\u30b8\u30e5\u30fc\u30eb\u304b\u3089\uff0e\u9069\u5f53\u306b\u5f15\u3063\u5f35\u3063\u3066\u304d\u305f\u306e\u3067\uff0c\u4e00\u90e8\u4f7f\u3063\u3066\u3044\u306a\u3044\u3082\u306e\u3082\u3042\u308a\u307e\u3059\u304c...","e786f5c1":"\u3053\u3053\u3067\u306f\uff0c\u30bf\u30a4\u30bf\u30cb\u30c3\u30af\u306e\u554f\u984c\u3092NN\u3067\u89e3\u304f\u306b\u3042\u305f\u308a\uff0cpytorch\u3092\u7528\u3044\u305f\u5b9f\u88c5\u306b\u3064\u3044\u3066\u7d39\u4ecb\u3057\u307e\u3059\uff0e","2bc1d42b":"# \u3044\u3056\u8a13\u7df4\n\n\u8a13\u7df4\u3092\u884c\u3044\u307e\u3059\uff0e  \n\u8a13\u7df4\u3092\u884c\u3046\u524d\u306b\uff0c\u640d\u5931\u95a2\u6570\u3068\u6700\u9069\u5316\u95a2\u6570\u3092\u5b9a\u7fa9\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e\u3053\u308c\u306f\u305d\u308c\u305e\u308cMSELoss(2\u4e57\u8aa4\u5dee)\u3068\uff0cAdam\u3092\u4f7f\u7528\u3057\u307e\u3059\uff0e\n\nepoch\u3068\u3044\u3046\u306e\u306f\u30c7\u30fc\u30bf\u5168\u4f53\u3092\u8210\u3081\u305f\u56de\u6570\u306b\u76f8\u5f53\u3059\u308b\u5024\u3067\uff0c\u4eca\u56de\u306f30\u56de\u304f\u3089\u3044\u8210\u3081\u307e\u3059\uff0e\n\n\u3042\u3068\u306f\uff0c\u30c7\u30fc\u30bf\u30ed\u30fc\u30c0\u30fc\u304b\u3089\u5165\u529b\u3068\u30e9\u30d9\u30eb\u306e\u7d44\u3092\u9806\u6b21\u53d6\u308a\u51fa\u3057\u306a\u304c\u3089\uff0c\u8aa4\u5dee\u3092\u8a08\u7b97\u3057\u3066\uff0c\u9006\u4f1d\u64ad\u3057\u307e\u3059\uff0e","1aeabe42":"\u540c\u69d8\u306b\uff0ctest\u30c7\u30fc\u30bf\u3082\u8aad\u307f\u8fbc\u307f\u307e\u3059\uff0e  \ntest\u30c7\u30fc\u30bf\u306f\u751f\u304d\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u3092\u63a8\u5b9a\u3059\u308b\u5bfe\u8c61\u306e\u30c7\u30fc\u30bf\u306a\u306e\u3067\uff0c\u7b54\u3048\u3068\u306a\u308bSurvived\u306e\u5217\u306f\u3042\u308a\u307e\u305b\u3093\uff0e","fd0098bc":"# \u30e2\u30c7\u30eb\u5b9a\u7fa9\n\u30e2\u30c7\u30eb\u3092\u4f5c\u308a\u307e\u3059\uff0e\u4eca\u56de\u306f\uff0c\u4e2d\u9593\u5c64\u304c1\u5c64\u3067\u3042\u308b\u3088\u3046\u306a\u5358\u7d14\u306a\u30e2\u30c7\u30eb\u3092\u8003\u3048\u307e\u3059\uff0e\n\n`__init__`\u3067\u884c\u5217\u306e\u639b\u3051\u7b97\u306e\u5b9a\u7fa9\u3092\u3057\u3066\uff0c`forward`\u3067\u305d\u308c\u3092\u3069\u306e\u9806\u756a\u3067\u884c\u3046\u304b\u3092\u6307\u5b9a\u3059\u308b\u611f\u3058\u3067\u3059\uff0e\n\n\u4eca\u56de\u306f\uff0c\u5165\u529b\u306e\u6b21\u5143\u306f6\u3064\uff086\u5217\u5206\u306e\u30c7\u30fc\u30bf\uff09\u3067\u3042\u308a\uff0c\u51fa\u529b\u306f\u751f\u304d\u3066\u3044\u308b\u304b\u306e2\u629e\uff08\u751f\u304d\u3066\u3044\u308b\u78ba\u7387\u3068\uff0c\u305d\u3046\u3067\u306a\u3044\u78ba\u7387\uff09\u306e2\u3064\u3067\u3059\uff0e","6483f653":"# \u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u4f5c\u6210\n\u30e2\u30c7\u30eb\u306e\u5b66\u7fd2\u3092\u884c\u3046\u306b\u3042\u305f\u308a\uff0c\u4eca\u56de\u306f**\u30df\u30cb\u30d0\u30c3\u30c1\u5316**\u3092\u884c\u3044\u307e\u3059\uff0e  \n\u30df\u30cb\u30d0\u30c3\u30c1\u5316\u306f,\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u8907\u6570\u306b\u5206\u5272\u3057\u3066\uff0c\u5c0f\u3055\u3081\u306e\u30c7\u30fc\u30bf\u3067\u5b66\u7fd2\u3092\u7e70\u308a\u8fd4\u3057\u884c\u3046\u3053\u3068\u3067\u3059\uff0e  \n\u3053\u306e\u30df\u30cb\u30d0\u30c3\u30c1\u5316\u306f\uff0c\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3068\u30c7\u30fc\u30bf\u30ed\u30fc\u30c0\u30fc\u306e2\u3064\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u3067\uff0c\u6bd4\u8f03\u7684\u7c21\u5358\u306b\u5b9f\u73fe\u3067\u304d\u307e\u3059\uff0e\n\n\u307e\u305a\u306f\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3067\u3059\uff0e  \n\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306f\uff0c\u5165\u529b\u3068\u305d\u308c\u306b\u5bfe\u3059\u308b\u30e9\u30d9\u30eb\u306e\u30da\u30a2\u3092\u305f\u304f\u3055\u3093\u6301\u3063\u3066\u3044\u307e\u3059\uff0e\u305d\u3057\u3066\uff0c\u3042\u308bindex\u3092\u6307\u5b9a\u3055\u308c\u305f\u3089\uff0c\u305d\u306e\u756a\u53f7\u306e\u30da\u30a2\u3092\u305f\u30601\u7d44\u3060\u3051\u8fd4\u3059\u3068\u3044\u3046\u5f79\u5272\u304c\u3042\u308a\u307e\u3059\uff0e\n\n\u5b9f\u88c5\u306f\u30af\u30e9\u30b9\u3092\u4f7f\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\uff0e\u307e\u305f\uff0c`__len__`\u3068`__getitem__`\u306e2\u3064\u3092\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u304c\u5fc5\u9808\u3067\u3059\uff0e  \n`__len__`\u306f`len()`\u306b\u3088\u3063\u3066\u547c\u3070\u308c\u308b\u95a2\u6570\u3067\uff0c`__getitem__`\u306f`array[i]`\u306e\u3088\u3046\u306bindex\u3092\u6307\u5b9a\u3055\u308c\u305f\u6642\u306b\u547c\u3070\u308c\u308b\u95a2\u6570\u3067\u3059\uff0e","8ca2cdfc":"DataFrame\u306e\u30e1\u30f3\u30d0\u5909\u6570\u3068\u3057\u3066info()\u304c\u3042\u308a\uff0c\u5404\u5217\u306b\u5bfe\u3057\u3066\uff0c\u5b9f\u969b\u306b\u30c7\u30fc\u30bf\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u6570\u304c\u8868\u793a\u3055\u308c\u307e\u3059\uff0e  \nPassengerId\u306f\u4e57\u5ba2\u306eID\u306a\u306e\u3067\uff0c\u6b20\u640d\u3057\u3066\u3044\u308b\u306f\u305a\u304c\u3042\u308a\u307e\u305b\u3093\uff0e\u3088\u3063\u3066\u30c7\u30fc\u30bf\u6570\u306f891\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\uff0e  \n891\u3068\u3044\u3046\u6570\u5b57\u3068\u6bd4\u3079\u308b\u3068\uff0cAge,Cabin\u306e\u5217\u306f\uff0c\u4f55\u304b\u3057\u3089\u6b20\u640d\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\uff0e","65155409":"# \u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\u3068\u78ba\u8a8d\ntrain\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u8fbc\u307f\u307e\u3059\uff0e   \npandas\u3092\u7528\u3044\u3066\u8aad\u307f\u8fbc\u3080\u306e\u3067\uff0cDataFrame\u3068\u3044\u3046\u5f62\u5f0f\u3067\u5909\u6570\u306b\u683c\u7d0d\u3055\u308c\u307e\u3059\uff0e  \nhead()\u3092\u4f7f\u3046\u3053\u3068\u3067\uff0c\u5148\u982d\u304b\u30895\u884c\u5206\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e  \n\u540d\u524d\u3084\u6027\u5225\u306a\u3069\u306e\u30c7\u30fc\u30bf\u304c\u3042\u308a\uff0c1\u884c\u304c1\u4eba\u306e\u4e57\u5ba2\u30c7\u30fc\u30bf\u306b\u5bfe\u5fdc\u3057\u307e\u3059\uff0e  \ntrain\u30c7\u30fc\u30bf\u306a\u306e\u3067\uff0c\u751f\u304d\u3066\u3044\u308b\u304b\u306e\u7b54\u3048\u3068\u306a\u308bSurvived\u306e\u5217\u304c\u4e0e\u3048\u3089\u308c\u3066\u3044\u307e\u3059\uff0e","7d3c7f28":"# \u30c6\u30b9\u30c8\u3059\u308b\n\n\u30c6\u30b9\u30c8\u3092\u884c\u3044\u307e\u3059\uff0e\n\n\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306b\u306f\u6b63\u89e3\u304c\u7121\u3044\u306e\u3067\uff0c\u8aa4\u5dee\u3092\u8a08\u7b97\u3059\u308b\u3068\u3044\u3046\u5de5\u7a0b\u306f\u51fa\u73fe\u3057\u307e\u305b\u3093\uff0e\n\n\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u5165\u529b\u3059\u308c\u3070\u30e2\u30c7\u30eb\u306e\u51fa\u529b\u304c\u5f97\u3089\u308c\u308b\u306e\u3067\uff0c\u305d\u308c\u3092\u63d0\u51fa\u3057\u307e\u3059\uff0e\n\n`..\/input\/titanic\/gender_submission.csv`\u306b\u63d0\u51fa\u5f62\u5f0f\u304c\u3042\u308b\u306e\u3067\uff0c\u305d\u308c\u3092\u53c2\u8003\u306b\u3057\u306a\u304c\u3089\u63d0\u51fa\u7528\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\uff0e\n\nkaggle\u306e\u30b5\u30a4\u30c8\u4e0a\u3067\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u3044\u308c\u3070\uff0c\u30e6\u30fc\u30b6\u30fc\u306e\u73fe\u5728\u5730\u306foutput\u30d5\u30a9\u30eb\u30c0\u306a\u306e\u3067\uff0c\u81ea\u5206\u3068\u540c\u3058\u968e\u5c64\u306bcsv\u3092\u4f5c\u6210\u3059\u308c\u3070\u826f\u3044\u3067\u3059\uff0e\n\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\uff0c\u30e2\u30c7\u30eb\u306f2\u3064\u306e\u78ba\u7387\u5024\u3092\u51fa\u529b\u3057\u307e\u3059\u304c\uff0c\u63d0\u51fa\u306e\u969b\u306f0,1\u306b\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\uff0e\n\u3053\u306e\u5909\u63db\u306b\u306f\uff0c`torch.max()`\u3092\u4f7f\u3046\u3068\u4fbf\u5229\u3067\u3059\uff0e2\u3064\u306e\u8fd4\u308a\u5024\u304c\u3042\u3063\u3066\uff0c1\u3064\u76ee\u306b\u306f\u6700\u5927\u5024\u306e\u30ea\u30b9\u30c8(max)\uff0c2\u3064\u76ee\u306b\u306f\u6700\u5927\u5024\u3092\u6301\u3064index\u306e\u30ea\u30b9\u30c8(argmax)\u3067\u3059\uff0e\u63d0\u51fa\u306b\u306f\u5f8c\u8005\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\uff0e(\u4e0b\u306b\u7c21\u5358\u306a\u4f8b\u3092\u793a\u3057\u307e\u3059\uff0e)","5e1c36d6":"# \u30c7\u30fc\u30bf\u306e\u524d\u51e6\u7406\n* **\u5217\u306e\u524a\u9664 **  \n\u307e\u305a\u306f\u8981\u3089\u306a\u3044\u5217\u3092\u6d88\u3057\u3066\u3044\u304d\u307e\u3059\uff0e\u4e57\u5ba2ID\u3084\u540d\u524d\uff0c\u30c1\u30b1\u30c3\u30c8\uff0c\u6e2f(Embarked)\u306f\u751f\u6b7b\u306b\u3042\u307e\u308a\u95a2\u4fc2\u304c\u306a\u3055\u305d\u3046\u3067\u3059\u3057\uff0c\u90e8\u5c4b\u756a\u53f7(Cabin)\u306f\u6b20\u640d\u304c\u3042\u308b\u3057\u6587\u5b57\u5217\u306a\u306e\u3067\uff0c\u7c21\u5358\u306e\u305f\u3081\u8003\u3048\u307e\u305b\u3093\uff0e  \n\u5217\u3092\u6d88\u3059\u6642\u306b\u306f\uff0c`drop()`\u3092\u7528\u3044\u307e\u3059\uff0e\u7b2c\u4e00\u5f15\u6570\u306b\uff0c\u6d88\u3057\u305f\u3044\u5217\u540d\u306e\u30ea\u30b9\u30c8\uff0caxis\u306e\u5c5e\u6027\u3067\u5217\u3092\u6d88\u3059\u3053\u3068\u3092\u6307\u793a\u3057\u307e\u3059\uff0e\n\n* **\u6b20\u640d\u306e\u88dc\u5b8c  **  \n\u5024\u304c\u3069\u308c\u304f\u3089\u3044\u6b20\u640d\u3057\u3066\u3044\u308b\u304b\u3068\u3044\u3046\u60c5\u5831\u3068\u30c7\u30fc\u30bf\u578b\u304c\u5206\u304b\u3063\u305f\u306e\u3067\uff0c\u6b20\u640d\u3092\u3046\u307e\u304f\u88dc\u5b8c\u3057\u307e\u3059\uff0e\nAge\u306f\u6b20\u640d\u304c\u3042\u308b\u306e\u3067\uff0c\u305d\u306e\u3088\u3046\u306a\u3068\u3053\u308d\u306f\u5e73\u5747\u5024\u3067\u88dc\u5b8c\u3057\u307e\u3059\uff0e\uff08\u4e2d\u592e\u5024\u3092\u4f7f\u3046\u306a\u3069\u306e\u9078\u629e\u80a2\u3082\u3042\u308a\u307e\u3059\u304c\uff0c\u4eca\u56de\u306f\u5e73\u5747\u3092\u4f7f\u3044\u307e\u3059\uff0e\uff09\n\n* **\u6587\u5b57\u5217\u3092\u6570\u5b57\u306b\u7f6e\u63db **   \n\u307e\u305f\uff0c\u6587\u5b57\u5217\u306fNN\u3067\u6271\u3044\u306b\u304f\u3044\u306e\u3067\uff0c\u6027\u5225\u306fmale\uff0cfemale\u30920,1\u306b\u7f6e\u63db\u3057\u3066\u304a\u304d\u307e\u3059\uff0e\n\n\u6700\u7d42\u7684\u306b\uff0c\u5217\u306f7\u3064\u306b\u306a\u308a\uff0c\u5168\u3066\u6570\u5b57\u3067\u3042\u308b\u3088\u3046\u306a\u30c7\u30fc\u30bf\u306b\u306a\u308a\u307e\u3057\u305f\uff0e","efe3d80f":"\u6b21\u306b\u30c7\u30fc\u30bf\u30ed\u30fc\u30c0\u30fc\u3067\u3059\uff0e\n\n\u30c7\u30fc\u30bf\u30ed\u30fc\u30c0\u30fc\u306f\uff0c\u5148\u306b\u4f5c\u3063\u3066\u304a\u3044\u305f\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u5f15\u6570\u3068\u3057\u3066\uff0c\u305d\u308c\u3092\u3046\u307e\u304f\u5206\u5272\u3057\u305f\u3082\u306e\u3092\u4f5c\u6210\u3059\u308b\u5f79\u5272\u304c\u3042\u308a\u307e\u3059\uff0e\n\n\u4f55\u500b\u305a\u3064\u306b\u5206\u5272\u3059\u308b\u304b\u306f\uff0c\u30d1\u30e9\u30e1\u30fc\u30bf`batch_size`\u3067\u6307\u5b9a\u3067\u304d\u307e\u3059\uff0e  \n\u307e\u305f\uff0c\u5206\u5272\u306e\u969b\u306b\u30c7\u30fc\u30bf\u3092\u30b7\u30e3\u30c3\u30d5\u30eb\u3059\u308b\u304b\u3069\u3046\u304b\u3092`shuffle`\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u6307\u5b9a\u3067\u304d\u307e\u3059\uff0e  \n\u3055\u3089\u306b\uff0c\u5206\u5272\u3057\u305f\u6642\u306b\u7aef\u6570\u304c\u751f\u3058\u305f\u5834\u5408\u306b\uff0c\u305d\u308c\u3092\u6368\u3066\u308b\u304b\u3069\u3046\u304b\u3092`drop_last`\u3067\u6307\u5b9a\u3067\u304d\u307e\u3059\uff0e\n\n\u4f8b\u3048\u3070\uff0c110\u500b\u306e\u30c7\u30fc\u30bf\u3092`batch_size=20`\u3067\u5206\u5272\u3057\u305f\u6642\uff0c\u30c7\u30fc\u30bf\u306f\u30b5\u30a4\u30ba\u304c 20,20,20,20,20,10 \u3068\u306a\u308b\u3088\u3046\u306b\u5206\u5272\u3055\u308c\u307e\u3059\uff0e\u3053\u3053\u3067\uff0c`drop_last=True`\u3092\u6307\u5b9a\u3057\u305f\u6642\uff0c\u7aef\u6570\u3068\u306a\u308b\u30b5\u30a4\u30ba10\u306e\u30c7\u30fc\u30bf\u306f\u52dd\u624b\u306b\u524a\u9664\u3055\u308c\u307e\u3059\uff0e\n\n\u5f97\u3089\u308c\u305f\u5206\u5272\u5f8c\u306e\u30c7\u30fc\u30bf\u306f\uff0cfor\u6587\u3092\u7528\u3044\u3066\u53d6\u308a\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\u5f53\u7136\uff0c\u5165\u529b\u3068\u305d\u306e\u30e9\u30d9\u30eb\u306e\u30da\u30a2\u3092\u6301\u3063\u3066\u3044\u308b\u306e\u3067\uff0cfor\u6587\u3067\u306f2\u3064\u306e\u5909\u6570\u3067\u53d7\u3051\u53d6\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e"}}