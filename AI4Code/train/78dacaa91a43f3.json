{"cell_type":{"5727ddac":"code","e25eb2fc":"code","a3e15df2":"code","1325ae68":"code","48ef3f46":"code","cd8ae8ef":"code","e99b10c6":"code","9f7fadcb":"code","c2dc6312":"code","0a711ee2":"code","884d2be3":"code","016270a7":"code","8ee8aaa0":"code","a7e6fd2a":"code","0f1f6da1":"code","85f47bc0":"code","aa657fc6":"code","a7012f31":"code","2ed106da":"code","dc0d122c":"code","6cf21ba7":"code","fe277ea8":"code","bf8b7839":"code","505fbd73":"code","280827e9":"code","04105272":"code","8e08bc59":"code","f82dd0bd":"code","619f3eb8":"code","edbba3fe":"code","2ebeaecd":"code","b8f9f842":"code","0167ff8c":"code","380995fe":"code","ba30b09b":"code","f30939f9":"code","af7a69c5":"code","1daecbfc":"code","6abb7acb":"code","958eba7c":"code","2cca15a7":"code","2b1d3852":"code","11a0faba":"code","62b5ad6a":"code","192bb4a6":"code","c1ec43fe":"code","ed6bfdc7":"markdown","54bb5167":"markdown","84cd4607":"markdown","17beb7f0":"markdown","2910e63e":"markdown","8e021037":"markdown","88f64ad3":"markdown","a3be189b":"markdown","eb99f6c7":"markdown","5c12cc22":"markdown","40fad8d0":"markdown","d2be1064":"markdown","e39ca189":"markdown","4855f61d":"markdown","bb0b2a7e":"markdown","5db26dfb":"markdown","f924270a":"markdown"},"source":{"5727ddac":"# necessary imports\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\n\nimport tensorflow as tf\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nplt.style.use('fivethirtyeight')\n%matplotlib inline","e25eb2fc":"# reading data\n\ndf = pd.read_csv('..\/input\/insurance\/insurance.csv')\ndf.head()","a3e15df2":"df.describe()","1325ae68":"df.info()","48ef3f46":"# looking for missing values\n\nimport missingno as msno\nmsno.bar(df)\nplt.show()","cd8ae8ef":"df.head()","e99b10c6":"plt.figure(figsize = (15, 8))\n\nsns.heatmap(df.corr(), annot = True, linewidths = 1)\nplt.show()","9f7fadcb":"# distribution plot of charges column\n\nplt.figure(figsize = (16, 7))\nsns.distplot(df['charges'])\nplt.title('Distribution Plot of Charges\\n', fontsize =  20)\nplt.show()","c2dc6312":"px.scatter(data_frame = df, x = 'age', y = 'charges', color = 'age', template = 'plotly_dark')","0a711ee2":"age_18_25 = df.age[(df.age >= 18) & (df.age <= 25)]\nage_26_35 = df.age[(df.age >= 26) & (df.age <= 35)]\nage_36_45 = df.age[(df.age >= 36) & (df.age <= 45)]\nage_46_55 = df.age[(df.age >= 46) & (df.age <= 55)]\nage_55above = df.age[df.age >= 55]","884d2be3":"x_age = ['18-25', '26-35', '36-45', '46-55', '55+']\ny_age = [len(age_18_25.values), len(age_26_35.values), len(age_36_45.values), len(age_46_55.values),\n     len(age_55above.values)]\n\npx.bar(data_frame = df, x = x_age, y = y_age, color = x_age, template = 'plotly_dark',\n       title = 'Number of patients per age group')","016270a7":"px.histogram(data_frame = df, x = 'charges', nbins = 100, color = 'sex', marginal = 'box',\n             template = 'plotly_dark')","8ee8aaa0":"px.box(x = 'sex', y = 'charges', data_frame = df, template = 'plotly_dark')","a7e6fd2a":"sns.catplot(x = 'sex', y = 'charges', hue = 'smoker', data = df, kind = 'box',\n            height = 6, aspect = 2)\nplt.show()","0f1f6da1":"sns.catplot(x = 'sex', y = 'charges', hue = 'children', data = df, kind = 'box',\n            height = 6, aspect = 2)\nplt.show()","85f47bc0":"sns.catplot(x = 'sex', y = 'charges', hue = 'region', data = df, kind = 'box',\n            height = 6, aspect = 2)\nplt.show()","aa657fc6":"px.scatter(data_frame = df, x = 'bmi', y = 'charges', color = 'bmi', template = 'plotly_dark')","a7012f31":"px.scatter(data_frame = df, x = 'bmi', y = 'charges', color = 'sex', template = 'plotly_dark')","2ed106da":"px.scatter(data_frame = df, x = 'bmi', y = 'charges', color = 'smoker', template = 'plotly_dark')","dc0d122c":"px.scatter(data_frame = df, x = 'bmi', y = 'charges', color = 'children', size = 'children',\n           template = 'plotly_dark')","6cf21ba7":"df_child = df.groupby(['children'])['charges'].mean().reset_index()\ndf_child","fe277ea8":"px.bar(data_frame = df_child, x = 'children', y = 'charges', color = 'charges',\n       template = 'plotly_dark')","bf8b7839":"px.histogram(data_frame = df, x = 'charges', nbins = 100, color = 'children', marginal = 'box',\n             template = 'plotly_dark', opacity = 0.8)","505fbd73":"sns.catplot(x = 'children', y = 'charges', col = 'sex', data = df, kind = 'bar')\nplt.show()","280827e9":"px.box(x = 'children', y = 'bmi', data_frame = df, template = 'plotly_dark')","04105272":"px.box(x = 'children', y = 'charges', color = 'smoker', data_frame = df, template = 'plotly_dark')","8e08bc59":"px.box(x = 'children', y = 'charges', color = 'region', data_frame = df, template = 'plotly_dark')","f82dd0bd":"px.box(x = 'smoker', y = 'charges', data_frame = df, template = 'plotly_dark')","619f3eb8":"px.histogram(data_frame = df, x = 'charges', nbins = 100, color = 'smoker', marginal = 'box',\n             template = 'plotly_dark', opacity = 0.8)","edbba3fe":"px.box(data_frame = df, x = 'smoker', y = 'charges', color = 'sex', template = 'plotly_dark')","2ebeaecd":"sns.catplot(x = 'smoker', y = 'charges', col = 'children', data = df, kind = 'bar', col_wrap = 3)\nplt.show()","b8f9f842":"px.box(data_frame = df, x = 'smoker', y = 'charges', color = 'region', template = 'plotly_dark')","0167ff8c":"px.histogram(data_frame = df, x = 'charges', nbins = 100, color = 'region', marginal = 'box',\n             template = 'plotly_dark', opacity = 0.8)","380995fe":"region_wise_patients = df.region.value_counts().reset_index()\nregion_wise_patients.columns = ['Region', 'No of patients']\nregion_wise_patients","ba30b09b":"px.box(data_frame = df, x = 'region', y = 'charges', color = 'region', template = 'plotly_dark')","f30939f9":"plt.figure(figsize = (17, 8))\nsns.barplot(x = 'region', y = 'charges', hue = 'sex', data = df)\nplt.show()","af7a69c5":"sns.catplot(x = 'region', y = 'charges', col = 'children', data = df, kind = 'bar', col_wrap = 3)\nplt.show()","1daecbfc":"sns.catplot(x = 'region', y = 'charges', hue = 'smoker', data = df, kind = 'violin',\n            height = 6, aspect = 2)\nplt.show()","6abb7acb":"from sklearn.compose import make_column_transformer\nfrom sklearn.preprocessing import MinMaxScaler, OneHotEncoder\n\n# creating column transformer (this will help us normalize\/preprocess our data)\n\nct = make_column_transformer((MinMaxScaler(), ['age', 'bmi', 'children']), \n                             (OneHotEncoder(handle_unknown = 'ignore'), ['sex', 'smoker', 'region']))","958eba7c":"# creating X and y (features and labels)\n\nX = df.drop('charges', axis = 1)\ny = df['charges']","2cca15a7":"# splitting data into training set and test set\n\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.20)","2b1d3852":"# fitting column transformer on training data\nct.fit(X_train)\n\n# transforming training and test data with normalizing (MinMaxScaler) and one hot encodig (OneHotEncoder)\nX_train = ct.transform(X_train)\nX_test = ct.transform(X_test)","11a0faba":"# creating a model using the Sequential API\n\nmodel = tf.keras.Sequential([\n    tf.keras.layers.Dense(300, activation = tf.keras.activations.relu),\n    tf.keras.layers.Dense(200, activation = tf.keras.activations.relu),\n    tf.keras.layers.Dense(50, activation = tf.keras.activations.relu),\n    tf.keras.layers.Dense(50, activation = tf.keras.activations.relu),\n    tf.keras.layers.Dense(10, activation = tf.keras.activations.relu),\n    tf.keras.layers.Dense(1)\n])\n\n# compiling the model\nmodel.compile(loss = tf.keras.losses.mae, optimizer = tf.keras.optimizers.Adam(lr = 0.01), metrics = ['mae'])\n\n# fit the model\nmodel_history = model.fit(X_train, y_train, epochs = 500)","62b5ad6a":"model.evaluate(X_test, y_test)","192bb4a6":"model.summary()","c1ec43fe":"from tensorflow.keras.utils import plot_model\n\nplot_model(model, show_shapes = True)","ed6bfdc7":"<p style = \"font-size : 30px; color : #34656d ; font-family : 'Comic Sans MS'; text-align : center; background-color : #f9b208; border-radius: 5px 5px;\"><strong>Visualizing Model<\/strong><\/p> ","54bb5167":"<p style = \"font-size : 45px; color : #34656d ; font-family : 'Comic Sans MS'; text-align : center; background-color : #f9b208; border-radius: 5px 5px;\"><strong>Model Building<\/strong><\/p> ","84cd4607":"<p style = \"font-size : 25px; color : #34656d ; font-family : 'Comic Sans MS'; \"><strong>From above plot we can say that Charges mainly lies under 15000<\/strong><\/p> ","17beb7f0":"<ul>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Charges for male patients have high charges than female patients.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>No significant effect of smoker or non smoker on charges of males and females.<\/strong><\/li>    \n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Males having 2, 3 or 4 children have relatively high charges.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>charges of patients from southeast region have the highest charges.<\/strong><\/li>    \n<\/ul>","2910e63e":"<ul>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Highest no of patients are from southeast region.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Patients from northwest and southwest region pays higher charges.<\/strong><\/li>\n<\/ul>","8e021037":"<p style = \"font-size : 30px; color : #34656d ; font-family : 'Comic Sans MS'; text-align : center; background-color : #f9b208; border-radius: 5px 5px;\"><strong>Evaluating the Model<\/strong><\/p> ","88f64ad3":"<ul>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>We can say that there is some relation between age and charges, as the age increases charges also increases.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Surprisingly age group 18-25 have the highest patients.<\/strong><\/li>\n<\/ul>","a3be189b":"<p style = \"font-size : 45px; color : #564a4a ; font-family : 'Comic Sans MS'; text-align : center; background-color : #00adb5; border-radius: 5px 5px;\"><strong>Medical Cost EDA and Regression using TensorFlow<\/strong><\/p>","eb99f6c7":"<ul>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Patients having 2\/3 children have the highest average charges may be because patients having 2\/3 children are also smoker.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Male patients having children have high charges than female patients.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Highest patients having 2 children are from southwest region.<\/strong><\/li>\n<\/ul>","5c12cc22":"<ul>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>bmi have slightly correlation with charges, as bmi increases charges may also increase.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Patients who smoke have high bmi and high charges.<\/strong><\/li>\n<\/ul>","40fad8d0":"<p style = \"font-size : 25px; color : #34656d ; font-family : 'Comic Sans MS'; \"><strong>There are no missing values in the data.<\/strong><\/p> ","d2be1064":"<p style = \"font-size : 45px; color : #34656d ; font-family : 'Comic Sans MS'; text-align : center; background-color : #f9b208; border-radius: 5px 5px;\"><strong>Data Preprocessing<\/strong><\/p> ","e39ca189":"<p style = \"font-size : 30px; color : #34656d ; font-family : 'Comic Sans MS'; text-align : center; background-color : #f9b208; border-radius: 5px 5px;\"><strong>Model Summary<\/strong><\/p> ","4855f61d":"<img style=\"margin-left: 10%; float: center;  border:5px solid #ffb037; width:80%;\" src = https:\/\/www.careinsurance.com\/upload_master\/media\/posts\/July2020\/uPI9Tz0Mb2C3sy8F70CT.jpg>  ","bb0b2a7e":"<ul>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Patients which are smoker pay high charges.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Highest smoker patients are from southeast region<\/strong><\/li>\n<\/ul>","5db26dfb":"<p style = \"font-size : 30px; color : #f55c47 ; font-family : 'Comic Sans MS'; \"><strong>If you like my work, please do Upvote.<\/strong><\/p> ","f924270a":"<p style = \"font-size : 45px; color : #34656d ; font-family : 'Comic Sans MS'; text-align : center; background-color : #f9b208; border-radius: 5px 5px;\"><strong>Exploratory Data Analysis (EDA)<\/strong><\/p> "}}