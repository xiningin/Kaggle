{"cell_type":{"11beb3c8":"code","711fb472":"code","8e76e827":"code","54ad2b4b":"code","b56a51d2":"code","d1a1c4db":"code","7e2babf3":"code","afb7a7c1":"code","f647b7c0":"code","4ec23a7a":"code","0c17881b":"code","90cba2e6":"code","64984c96":"code","139e7330":"code","c4275390":"code","40ae705a":"code","5d529718":"code","e21bc602":"code","0d736da3":"code","4ff6ba5d":"code","062f10e3":"code","2963fa5c":"code","d0f5ee24":"markdown","c9a008a9":"markdown","3b1d32a6":"markdown","e45812d5":"markdown","f1d1111a":"markdown","1f44208b":"markdown","f796a342":"markdown","05575a9e":"markdown","a11315e2":"markdown","9d1c830a":"markdown","8e15ee8b":"markdown","facae5c5":"markdown","227f8a2b":"markdown","5c29f68e":"markdown"},"source":{"11beb3c8":"import numpy as np\nfrom random import randrange\nimport os\nfrom PIL import Image\nimport matplotlib.pyplot as plt","711fb472":"filenames = os.listdir('..\/input\/butterfly-dataset\/leedsbutterfly\/images')","8e76e827":"img = Image.open('..\/input\/butterfly-dataset\/leedsbutterfly\/images\/' + filenames[randrange(len(filenames))]).convert('L').resize((256,256))","54ad2b4b":"plt.imshow(img, cmap='gray')","b56a51d2":"U,S,V = np.linalg.svd(np.array(img), full_matrices=False)\nS = np.diag(S)","d1a1c4db":"plt.plot(np.cumsum(S)\/np.sum(S))\nplt.title('Cumulative Sum of Sigma Matrix')","7e2babf3":"r = 5\nreconstruction = U[:,:r] @ S[0:r,:r] @ V[:r,:]","afb7a7c1":"energy = 0\nfor i in range(r):\n    energy = energy + S[i][i]*S[i][i]\nenergy = energy \/ np.sum(np.square(S))\nprint('The first ' + str(r) + ' columns contained ' + str(energy * 100) + '% of the original energy of the image')","f647b7c0":"plt.imshow(reconstruction,cmap='gray')","4ec23a7a":"r = 10\nreconstruction = U[:,:r] @ S[0:r,:r] @ V[:r,:]","0c17881b":"energy = 0\nfor i in range(r):\n    energy = energy + S[i][i]*S[i][i]\nenergy = energy \/ np.sum(np.square(S))\nprint('The first ' + str(r) + ' columns contained ' + str(energy * 100) + '% of the original energy of the image')","90cba2e6":"plt.imshow(reconstruction,cmap='gray')","64984c96":"r = 25\nreconstruction = U[:,:r] @ S[0:r,:r] @ V[:r,:]","139e7330":"energy = 0\nfor i in range(r):\n    energy = energy + S[i][i]*S[i][i]\nenergy = energy \/ np.sum(np.square(S))\nprint('The first ' + str(r) + ' columns contained ' + str(energy * 100) + '% of the original energy of the image')","c4275390":"plt.imshow(reconstruction,cmap='gray')","40ae705a":"r = 50\nreconstruction = U[:,:r] @ S[0:r,:r] @ V[:r,:]","5d529718":"energy = 0\nfor i in range(r):\n    energy = energy + S[i][i]*S[i][i]\nenergy = energy \/ np.sum(np.square(S))\nprint('The first ' + str(r) + ' columns contained ' + str(energy * 100) + '% of the original energy of the image')","e21bc602":"plt.imshow(reconstruction,cmap='gray')","0d736da3":"img = Image.open('..\/input\/butterfly-dataset\/leedsbutterfly\/images\/' + filenames[randrange(len(filenames))]).convert('L').resize((256,256))\nprint('Original')\nplt.imshow(img, cmap='gray')","4ff6ba5d":"U,S,V = np.linalg.svd(np.array(img), full_matrices=False)\nS = np.diag(S)\nr = 50\nreconstruction = U[:,:r] @ S[0:r,:r] @ V[:r,:]\nprint('Reconstruction')\nplt.imshow(reconstruction,cmap='gray')","062f10e3":"img = Image.open('..\/input\/butterfly-dataset\/leedsbutterfly\/images\/' + filenames[randrange(len(filenames))]).convert('L').resize((256,256))\nprint('Original')\nplt.imshow(img, cmap='gray')","2963fa5c":"U,S,V = np.linalg.svd(np.array(img), full_matrices=False)\nS = np.diag(S)\nr = 50\nreconstruction = U[:,:r] @ S[0:r,:r] @ V[:r,:]\nprint('Reconstruction')\nplt.imshow(reconstruction,cmap='gray')","d0f5ee24":"# First 50 Columns","c9a008a9":"# Image Reconstruction","3b1d32a6":"Load random image in dataset and convert to grayscale","e45812d5":"# Load Data","f1d1111a":"Only keeping the first 5 columns of the SVD matrices, truncating the rest and reconstructing the original image","1f44208b":"![energy](https:\/\/i.imgur.com\/VyUtygs.png)","f796a342":"The plot below represents the energy each singular vector adds to the overall image","05575a9e":"# Compute Singular Value Decomposition","a11315e2":"# First 25 Columns","9d1c830a":"The energy in the first *I* columns can be caluculated using the following formula","8e15ee8b":"# Other Images","facae5c5":"# First 10 Columns","227f8a2b":"Using first 50 columns","5c29f68e":"# First 5 Columns"}}