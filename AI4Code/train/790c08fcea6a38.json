{"cell_type":{"42404f57":"code","ac2fba7c":"code","d5fdeb3f":"code","5a4fa111":"code","a8647964":"code","86b8ec5e":"code","45e9b220":"code","88a67dda":"code","89b6289b":"code","0f3045ca":"code","1cc12d07":"code","c3aa88d9":"code","1021b7de":"code","9080c595":"code","f0f45d97":"code","60a48af6":"code","a2ad7ae6":"code","940187ee":"code","338eed2e":"code","1ed8f9c5":"code","d63baf24":"code","a9ea709e":"code","86382895":"code","819f0121":"code","9c06d3db":"code","261a4e70":"code","3b648383":"code","d61f6554":"code","a39035c3":"code","5e86575e":"code","ae9e60c7":"code","939c8fd3":"code","a56606ac":"code","f719e5b6":"code","f6c648cb":"code","5c110729":"code","954aafec":"markdown","3a85cdf7":"markdown","e3cc1a5b":"markdown","8f2b7785":"markdown","9a005531":"markdown","883ff0b5":"markdown","94bc9a89":"markdown","5268890d":"markdown","528a8318":"markdown","9cc72c90":"markdown","70c5a275":"markdown","d5a69d3c":"markdown","22427514":"markdown","47e6f8b8":"markdown","5f301b29":"markdown"},"source":{"42404f57":"import os\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport cv2\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom scipy import stats","ac2fba7c":"train_folder=\"..\/input\/petfinder-pawpularity-score\/train\"\ntrain_df=pd.read_csv('..\/input\/petfinder-pawpularity-score\/train.csv')\n\nprint( train_df.shape )","d5fdeb3f":"def get_pawpularity_bins(p):\n    if p <= 20:\n        return '0-20'\n    elif p>20 and p<=40:\n        return '20-40'\n    elif p>40 and p<=60:\n        return '40-60'\n    elif p>60 and p<=80:\n        return '60-80'\n    return '>80'","5a4fa111":"train_df['bin'] = train_df.Pawpularity.apply(get_pawpularity_bins)\ntrain_df.head()","a8647964":"train_df.Pawpularity.describe()","86b8ec5e":"_, ax=plt.subplots(1, 3, figsize=(15, 5))\n\nsns.lineplot(x=range(len(train_df)), y=train_df.Pawpularity.sort_values().values, ax=ax[0])\nsns.histplot(train_df.Pawpularity, ax=ax[1])\nsns.boxplot(data=train_df, x='Pawpularity', ax=ax[2])\n\nplt.legend(loc='best')\nplt.show()","45e9b220":"skew = stats.skew(train_df.Pawpularity)\nkurtosis = stats.kurtosis(train_df.Pawpularity)\navg_pawpularity=train_df.Pawpularity.mean()\n\nprint(\"Pawpularity Skewness:{:.5f}\".format(skew))\nprint(\"Pawpularity Kurtosis:{:.5f}\".format(kurtosis))\nprint(\"Mean Pawpularity:{:.4f}\".format(avg_pawpularity))","88a67dda":"train_df.bin.value_counts()","89b6289b":"plt.title(\"Bin Count\")\n\nsns.countplot(data=train_df, x='bin', order=['0-20', '20-40', '40-60', '60-80', '>=80'])\nplt.legend(loc='best')\nplt.show()","0f3045ca":"def read_image(filename):\n    filepath = os.path.join(train_folder, filename+\".jpg\")\n    img=cv2.imread(filepath)\n    img=cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n    return img","1cc12d07":"def get_images(field_name, title1, title2, rand_state=10):\n    print(field_name)\n    imgs1=train_df[train_df[field_name] == 0].sample(5, random_state=rand_state).Id.values\n    imgs2=train_df[train_df[field_name] == 1].sample(5, random_state=rand_state).Id.values\n    \n    imgs=np.concatenate([imgs1, imgs2])\n    imgs=[read_image(imgname) for imgname in imgs]\n    \n    _, ax=plt.subplots(2, 5, figsize=(17, 8), sharex=True, sharey=True)\n\n    ax[0, 0].set_title(title1)\n    ax[1, 0].set_title(\"\\n\"+title2)\n    for i in range(2):\n        for j in range(5):\n            ax[i, j].imshow( imgs[i*5 + j] )\n    plt.title(field_name)\n    plt.show()","c3aa88d9":"plt.title(\"Subject Focus in Popularity Bins\")\nsns.countplot(data=train_df, \n              x='bin',\n              hue='Subject Focus',\n              order=['0-20', '20-40', '40-60', '60-80', '>=80'])\nplt.legend(loc='best')\nplt.show()","1021b7de":"get_images(\"Subject Focus\", \"Cluttered Background or Toofar or Too Close Images\", \"focused Images\", rand_state=3)","9080c595":"plt.title(\"Eyes in Popularity Bins\")\nsns.countplot(data=train_df, \n              x='bin',\n              hue='Eyes',\n              order=['0-20', '20-40', '40-60', '60-80', '>=80'])\nplt.legend(loc='best')\nplt.show()","f0f45d97":"get_images(\"Eyes\", \"Low Quality of Eyes\", \"Both Eyes facing front and atleast one eye is clear\", rand_state=3)","60a48af6":"plt.title(\"Face in Popularity Bins\")\nsns.countplot(data=train_df, \n              x='bin',\n              hue='Face',\n              order=['0-20', '20-40', '40-60', '60-80', '>=80'])\nplt.legend(loc='best')\nplt.show()","a2ad7ae6":"get_images(\"Face\", \"Face is not clear or near-front\", \"face is clear and near front\", rand_state=3)","940187ee":"plt.title(\"Near in Popularity Bins\")\nsns.countplot(data=train_df, \n              x='bin',\n              hue='Near',\n              order=['0-20', '20-40', '40-60', '60-80', '>=80'])\nplt.legend(loc='best')\nplt.show()","338eed2e":"get_images(\"Near\", \"Not Near\", \"Single Pet taking Significant portion around 50%\", rand_state=6)","1ed8f9c5":"plt.title(\"Action in Popularity Bins\")\nsns.countplot(data=train_df, \n              x='bin',\n              hue='Action',\n              order=['0-20', '20-40', '40-60', '60-80', '>=80'])\nplt.legend(loc='best')\nplt.show()","d63baf24":"get_images(\"Action\", \"No Action\", \"Pet in the middle of an action\", rand_state=8)","a9ea709e":"plt.title(\"Accessory in Popularity Bins\")\nsns.countplot(data=train_df, \n              x='bin',\n              hue='Accessory',\n              order=['0-20', '20-40', '40-60', '60-80', '>=80'])\nplt.legend(loc='best')\nplt.show()","86382895":"get_images(\"Accessory\", \"No Accessory\", \"Accompanies Accessory\", rand_state=10)","819f0121":"plt.title(\"Group in Popularity Bins\")\nsns.countplot(data=train_df, \n              x='bin',\n              hue='Group',\n              order=['0-20', '20-40', '40-60', '60-80', '>=80'])\nplt.legend(loc='best')\nplt.show()","9c06d3db":"get_images(\"Group\", \"No >1 pet\", \">1 pet- in a group\", rand_state=12)","261a4e70":"plt.title(\"Collage in Popularity Bins\")\nsns.countplot(data=train_df, \n              x='bin',\n              hue='Collage',\n              order=['0-20', '20-40', '40-60', '60-80', '>=80'])\nplt.legend(loc='best')\nplt.show()","3b648383":"get_images(\"Collage\", \"No Collage\", \"Collage - digitally retouched photo\", rand_state=14)","d61f6554":"plt.title(\"Human in Popularity Bins\")\nsns.countplot(data=train_df, \n              x='bin',\n              hue='Human',\n              order=['0-20', '20-40', '40-60', '60-80', '>=80'])\nplt.legend(loc='best')\nplt.show()","a39035c3":"get_images(\"Human\", \"No Human\", \"Human in the photo\", rand_state=15)","5e86575e":"plt.title(\"Occlusion =1 Bins\")\nsns.countplot(data=train_df[train_df.Occlusion == 1].copy(),\n              x='bin',\n              hue='Occlusion',\n              order=['0-20', '20-40', '40-60', '60-80', '>=80'])\nplt.legend(loc='best')\nplt.show()","ae9e60c7":"plt.title(\"Occlusion in Popularity Bins\")\nsns.countplot(data=train_df, \n              x='bin',\n              hue='Occlusion',\n              order=['0-20', '20-40', '40-60', '60-80', '>=80'])\nplt.legend(loc='best')\nplt.show()","939c8fd3":"get_images(\"Occlusion\", \"No Occlusion\", \"Occlusion in the photo\", rand_state=16)","a56606ac":"plt.title(\"Info Counts per Bins\")\nsns.countplot(data=train_df[train_df.Info == 1], \n              x='bin',\n              order=['0-20', '20-40', '40-60', '60-80', '>=80'])\nplt.legend(loc='best')\nplt.show()","f719e5b6":"plt.title(\"Info in Popularity Bins\")\nsns.countplot(data=train_df, \n              x='bin',\n              hue='Info',\n              order=['0-20', '20-40', '40-60', '60-80', '>=80'])\nplt.legend(loc='best')\nplt.show()","f6c648cb":"get_images(\"Info\", \"No Info on the pet photo\", \"Pet description\", rand_state=18)","5c110729":"_, ax=plt.subplots(5, 3, figsize=(21, 10), sharex=True, sharey=True)\nfor i, b in enumerate(train_df.bin.sort_values().unique()):\n    imgs=train_df[train_df.bin == b].Id.values[:3]\n    imgs=[read_image(img) for img in imgs]\n    ax[i,0].set_title(b)\n    for j, img in enumerate(imgs):\n        ax[i, j].imshow(img)","954aafec":"# Occlusion","3a85cdf7":"# Subject Focus","e3cc1a5b":"1. In the 2nd row with >1 pet, a human in background also getting treated as pet or group","8f2b7785":"# Info","9a005531":"# Accessory","883ff0b5":"# Collage","94bc9a89":"# Action","5268890d":"bins are highly skewed to the right","528a8318":"# Clear Face facing front","9cc72c90":"# Near","70c5a275":"1. There is an exponential growth from Pawpularity (20-50 %) from the 1st graph.\n2. Around 300 images have 100% Pawpularity from 2nd graph.\n3. Pawpularity looks kind of gaussian with some skewness","d5a69d3c":"# Group","22427514":"1. Image (0, 2) --> is not cluttered, but a bit far away","47e6f8b8":"# Eyes","5f301b29":"# Human"}}