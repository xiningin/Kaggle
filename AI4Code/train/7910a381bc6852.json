{"cell_type":{"18b88208":"code","726b2b8e":"code","4be3ec21":"code","7f385da4":"code","d7612054":"code","dcdc94bc":"code","3e9b0f8f":"code","62446faf":"code","8a330906":"code","87f0efca":"code","fccaac89":"code","f3ca4a68":"code","e20147d9":"code","97177656":"code","3b5952c5":"code","0c6a90ee":"code","2b0f1aee":"code","495b5a1e":"code","e4bac7bf":"code","d361649d":"code","a4a9039d":"code","cc3e613d":"code","c6935da0":"code","5c7e627f":"code","1bae73d0":"code","215870fb":"code","8674440a":"code","5e3fcb6b":"code","44242544":"code","95808a85":"code","c9934dab":"code","ee5993fe":"code","f389cc00":"code","a31b21fb":"code","bdfc2dbb":"code","27646504":"code","7c549483":"code","f099369b":"code","1a4ba83d":"code","7b04add7":"markdown","01edf893":"markdown","38be4a72":"markdown","178c543d":"markdown","85197e00":"markdown","697c1024":"markdown","b43c29d5":"markdown","a08821f7":"markdown","ac9bd332":"markdown","9c350597":"markdown","62ac7b8a":"markdown","3465a9c8":"markdown","9f39c2ce":"markdown","2095fcdc":"markdown","5b3dc7e7":"markdown","a4f3361b":"markdown","f0a60386":"markdown","92393259":"markdown"},"source":{"18b88208":"import pandas as pd\nimport numpy as np\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\n# Data Preparations\nfrom collections import Counter\nfrom sklearn.datasets import make_classification\nfrom imblearn.over_sampling import RandomOverSampler\n\n# Classification Modelling\nimport xgboost as xgb\nfrom sklearn.model_selection import train_test_split\n\n# Plot Visualizations\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import classification_report,plot_confusion_matrix,plot_roc_curve","726b2b8e":"survey = pd.read_csv('..\/input\/starbucks-customer-retention-malaysia-survey\/Starbucks satisfactory survey.csv')","4be3ec21":"survey.head()","7f385da4":"data = survey.copy()","d7612054":"data.drop(columns=['Timestamp'], inplace = True)\ndata.drop(columns=['10. What do you most frequently purchase at Starbucks?'], inplace = True)\ndata.drop(columns=['19. How do you come to hear of promotions at Starbucks? Check all that apply.'], inplace = True)","dcdc94bc":"data.rename({'1. Your Gender' : 'Gender', '2. Your Age' : 'Age', '3. Are you currently....?' : 'Work_Status', '4. What is your annual income?' : 'Annual_Income', '5. How often do you visit Starbucks?' : 'Visit', '6. How do you usually enjoy Starbucks?' : 'Visit_Type', '7. How much time do you normally  spend during your visit?' : 'Visit_Duration', \"8. The nearest Starbucks's outlet to you is...?\" : 'Distance', '9. Do you have Starbucks membership card?' : 'Membership', '11. On average, how much would you spend at Starbucks per visit?' : 'Spending', '12. How would you rate the quality of Starbucks compared to other brands (Coffee Bean, Old Town White Coffee..) to be:' : 'Product_Rating', '13. How would you rate the price range at Starbucks?' : 'Price_Rating', '14. How important are sales and promotions in your purchase decision?' : 'Promo_Rating', '15. How would you rate the ambiance at Starbucks? (lighting, music, etc...)' : 'Ambiance_Rating', '16. You rate the WiFi quality at Starbucks as..' : 'Wifi_Rating', '17. How would you rate the service at Starbucks? (Promptness, friendliness, etc..)' : 'Service_Rating', '18. How likely you will choose Starbucks for doing business meetings or hangout with friends?' : 'Hangout_Rating', '20. Will you continue buying at Starbucks?' : 'Loyality'} , inplace = True , axis = 1)","3e9b0f8f":"data.head()","62446faf":"# Check for missing values\ndata.isnull().any()","8a330906":"# Missing value is written as nan\ndata['Visit_Type'].unique()","87f0efca":"# Change the value of nan to never\ndata['Visit_Type'].fillna('never', inplace = True)","fccaac89":"# Delete redundant data to the Never Buy value\ndata['Visit_Type'].replace(['never', 'Never buy', 'I dont like coffee', 'Never', 'Never '], 'Never buy', inplace = True)\ndata['Visit_Type'].value_counts()","f3ca4a68":"# Make sure there are no more missing values\ndata.isnull().any()","e20147d9":"data.dtypes","97177656":"data['Gender'].unique()","3b5952c5":"data['Age'].unique()","0c6a90ee":"data['Work_Status'].unique()","2b0f1aee":"data['Annual_Income'].unique()","495b5a1e":"data['Visit'].unique()","e4bac7bf":"data['Visit_Type'].unique()","d361649d":"data['Visit_Duration'].unique()","a4a9039d":"data['Distance'].unique()","cc3e613d":"data['Membership'].unique()","c6935da0":"data['Spending'].unique()","5c7e627f":"data[\"Gender\"].replace({\"Female\": 1, \"Male\": 0}, inplace=True)\ndata[\"Age\"].replace({\"Below 20\": 0, \"From 20 to 29\": 1, \"From 30 to 39\": 2, \"40 and above\": 3}, inplace=True)\ndata[\"Work_Status\"].replace({\"Student\": 0, \"Employed\": 1, \"Self-employed\": 2, \"Housewife\": 3}, inplace=True)\ndata[\"Annual_Income\"].replace({\"Less than RM25,000\": 0, \"RM25,000 - RM50,000\": 1, \"RM50,000 - RM100,000\": 2, \"RM100,000 - RM150,000\": 3, \"More than RM150,000\": 4}, inplace=True)\ndata[\"Visit\"].replace({\"Never\": 0, \"Rarely\": 1, \"Monthly\": 2, \"Weekly\": 3, \"Daily\": 4}, inplace=True)\ndata[\"Visit_Type\"].replace({\"Never buy\": 0, \"Take away\": 1, \"Drive-thru\": 2, \"Dine in\": 3}, inplace=True)\ndata[\"Visit_Duration\"].replace({\"Below 30 minutes\": 0, \"Between 30 minutes to 1 hour\": 1, \"Between 1 hour to 2 hours\": 2, \"Between 2 hours to 3 hours\": 3, \"More than 3 hours\": 4}, inplace=True)\ndata[\"Distance\"].replace({\"within 1km\": 0, \"1km - 3km\": 1, \"more than 3km\": 2}, inplace=True)\ndata[\"Membership\"].replace({\"No\": 0, \"Yes\": 1}, inplace=True)\ndata[\"Spending\"].replace({\"Zero\": 0, \"Less than RM20\": 1, \"Around RM20 - RM40\": 2, \"More than RM40\": 3}, inplace=True)","1bae73d0":"data.dtypes","215870fb":"data.head()","8674440a":"# Retrieve dataset\ndatasb = data\n# Split in X and y\nX, y = datasb.iloc[:,:-1], datasb.iloc[:,-1]\n\n# The dataset is divided into two, for training data and testing data\n# Data Training : Data Testing - 70% : 30%\nX_train, X_test, y_train, y_test= train_test_split(X, y, test_size=0.3, random_state=123)","5e3fcb6b":"# Create an XGBoost Classifier model\nxg_cl = xgb.XGBClassifier(objective='binary:logistic', n_estimators=1000, seed=123, learning_rate=0.1, max_depth=5, colsample_bytree=1, subsample=1)","44242544":"# Fitting model XGBoost\nxg_cl.fit(X_train,y_train)","95808a85":"# Prediction of testing data\npreds = xg_cl.predict(X_test)","c9934dab":"# View accuracy scores\naccuracy = float(np.sum(preds==y_test))\/y_test.shape[0]\nprint(\"Accuracy: %f\" % (accuracy))","ee5993fe":"plot_confusion_matrix(xg_cl,X_test,y_test,cmap='RdPu')","f389cc00":"plot_roc_curve(xg_cl,X_test,y_test)","a31b21fb":"# View the most important features in the classification\nxgb.plot_importance(xg_cl)\nplt.show()","bdfc2dbb":"# Save model to file\n#import pickle\n#xg_cl.save_model(\"xgb_model.bin\")","27646504":"# Try test data\ntestdata = pd.read_csv('..\/input\/test-data-starbucks-survey\/test data starbucks survey.csv')","7c549483":"# Predict test data\ntest_prediction=xg_cl.predict(testdata)","f099369b":"# Prediction results are placed in the Loyality column\ntestdata['Loyality'] = test_prediction","1a4ba83d":"testdata","7b04add7":"\nAt this stage, a prediction test will be carried out using test data and the classification model that has been made.\n\n","01edf893":"\n\n---\n\n\n# **Deployment**\n","38be4a72":"\n\n---\n\n\n# **Data Preparation**\n","178c543d":"\n\n---\n\n\n# **Business Understanding**\n\n1. Objective :\n> Classify and Predict Customer's Loyality with XGBoost Classifier\n\n2. Description :\n> This dataset is composed of a survey questions of over 100 respondents for their buying behavior at Starbucks.\nIncome is show in Malaysian Ringgit (RM)\n\n\n\n","85197e00":"## 1.4 Data Cleaning\nTo simplify the dataset, it is necessary to clean up the non-essential data.\n\n","697c1024":"XGBClassifier Parameters:\n\n* Objective - What is your goal for this particular problem, here we have a binary classification problem of 2 class hence use binary:logistic.\n* n_estimators - The number of trees we use for the classification problem.\n* learning_rate - How big a step to take.\n* max_depth - Maximum depth of each tree.\n* colsample_bytree - What percentage of features each tree has.\n* subsample - What percentage of data is used by each tree.","b43c29d5":"\n## 2.1 Missing Value\nAt this stage will be checked for missing values. Missing value here means a data in an attribute that has no value.\n\n","a08821f7":"## 1.2 Load Data\nAfter the Library is imported, the next step is to access and load the dataset.\n\n","ac9bd332":"ROC Curve or Receiver Operating Characteristic Curve, is a graph that shows the performance of the classification model across all classification thresholds. This curve plots two parameters: True Positive Rate and False Positive Rate.","9c350597":"\n\n---\n\n\n# **Modelling**\n","62ac7b8a":"\n## 1.1 Import Library\nThe first thing that needs to be done for the code to work properly is to import the Library. The library here serves to call the functions required in data preprocessing to classification methods.\n","3465a9c8":"**Variable Description**\n\n* *Gender*: Female or Male.\n* *Age*: Age range of respondents.\n* *Work_Status*: Respondent's employment status.\n* *Annual_Income*: Respondent's income (in Malaysian Ringgit).\n* *Visit*: How often the respondent visits.\n* *Visit_Type*: Type of visit (eat in or take away).\n* *Visit_Duration*: Length of visit.\n* *Distance*: The distance of the nearest Starbucks outlet from the respondent's location.\n* *Membership*: Ownership of respondent's membership card.\n* *Spending*: The respondent's average purchase expenditure.\n* *Product_Rating*: Product rating by respondents on a scale of 1-5.\n* *Price_Rating*: Price rating by respondents on a scale of 1-5.\n* *Promo_Rating*: Promotion rating by respondents on a scale of 1-5.\n* *Ambiance_Rating*: Atmosphere rating by respondents on a scale of 1-5.\n* *Wifi_Rating*: WiFi rating by respondents on a scale of 1-5.\n* *Service_Rating*: Service rating by respondents on a scale of 1-5.\n* *Hangout_Rating*: The suitability rating as a hangout place by respondents on a scale of 1-5.\n\n**Variable Target**\n\n* *Loyality*: Customer loyalty in product purchases.\n\n\n\n","9f39c2ce":"It can be seen here, Price_Rating is the most important attribute in predicting customer loyalty.","2095fcdc":"## 1.3 Statistical Summaries and Visualisations\nTo understand the data, we will now consider some key facts about the various variables including their relationship to the target variable, namely customer loyalty.\n\nWe start by looking at a few rows of data.\n\n","5b3dc7e7":"Note: There's a better way to change Categorical to Numerical, but my knowledge is too limited and I rather do it manually. If you know how, something something about LabelEncoder, please do share, and maybe make this notebook more efficient. I don't know if that's how it works here, but I wouldn't mind learning new things. Thank you.","a4f3361b":"\nAt this stage a model will be formed from the training data.\n\n","f0a60386":"\n## 2.2 Change Categorical Variables to Numerical\nIn this dataset, many still use categorical variables. In order for machine learning to understand the data, these variables must be converted to numerical.\n\n","92393259":"\n\n---\n\n\n# **Data Understanding**\n\n"}}