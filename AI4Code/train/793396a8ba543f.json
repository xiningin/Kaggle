{"cell_type":{"915a8a78":"code","24694ad5":"code","b5631a3b":"code","e8c0655b":"code","40edc8ab":"code","45f9a137":"code","c49e0c23":"code","e09dbee0":"code","4bd29be5":"code","df38b3f9":"code","7f025115":"code","cb92e714":"code","2447e0fc":"code","681a8285":"code","9c15f851":"code","fb2e7379":"code","d7d705b4":"code","eb4e63af":"code","163804a1":"code","de5e784a":"code","86af8abf":"markdown","26cf55d3":"markdown","da2f9fe4":"markdown","c57654ac":"markdown","9e312a87":"markdown","d348572f":"markdown","1c520be0":"markdown","65e80f4f":"markdown","205b1868":"markdown","bcb49778":"markdown","69bf9152":"markdown","d9a2c8ab":"markdown","c2b84595":"markdown","0b69696f":"markdown","657625fd":"markdown","88de3d9b":"markdown","324ba6d7":"markdown","203646c2":"markdown","255ed286":"markdown","8de7c9cb":"markdown","1260aa2b":"markdown","1e1a9eee":"markdown","13404d69":"markdown","59c231e7":"markdown"},"source":{"915a8a78":"# Data Manipulation, Linear Algebra\nimport pandas as pd\nimport numpy as np\n\n# Plots\nimport seaborn as sns\nsns.set_style(\"darkgrid\")\nimport matplotlib.pyplot as plt\n\n#ignore warning messages \nimport warnings\nwarnings.filterwarnings('ignore')\n\n# Machine Learning\nfrom sklearn.metrics import r2_score\n\nfrom sklearn import tree, linear_model, ensemble, neighbors","24694ad5":"data = pd.read_csv(\"..\/input\/california-housing-prices\/housing.csv\")\r\ndata.head()","b5631a3b":"data.info()","e8c0655b":"data.isnull().sum()","40edc8ab":"data.describe()","45f9a137":"fig, axes = plt.subplots(figsize=(18, 12), nrows=2, ncols=1)\r\n\r\nsns.histplot(data.total_bedrooms, ax=axes[0])\r\naxes[0].set_title(\"Total Number of Bedrooms Distribution - Histogram\")\r\naxes[0].set_xlabel('Number of Bedrooms')\r\naxes[0].set_ylabel('Count of Houses')\r\n\r\nsns.boxplot(data.total_bedrooms, ax=axes[1])\r\naxes[1].set_title(\"Total Number of Bedrooms Distribution - Boxplot\")\r\naxes[1].set_xlabel('Number of Bedrooms')\r\n\r\n\r\nplt.show()","c49e0c23":"data.total_bedrooms.fillna(data.total_bedrooms.median(), inplace=True)\r\ndata.isnull().sum()","e09dbee0":"plt.rcParams[\"figure.figsize\"] = (18, 20)\r\ndata.hist()\r\nplt.show()","4bd29be5":"plt.rcParams[\"figure.figsize\"] = (12, 8)\r\nsns.heatmap(data.corr(), annot=True)\r\nplt.title(\"Corelation Heatmap\")\r\nplt.show()","df38b3f9":"def scatter_plots(x_var, y_var):\r\n    fig, axes = plt.subplots(figsize=(20, 8), nrows=1, ncols=3)\r\n    \r\n    ax = 0\r\n    for y in y_var:\r\n        sns.scatterplot(x=x_var, y=y, hue=\"ocean_proximity\", data=data, ax=axes[ax])\r\n        axes[ax].set_title(f\"{x_var} vs {y}\")\r\n\r\n        ax += 1\r\n\r\n    plt.show()","7f025115":"scatter_plots(\"total_rooms\", [\"total_bedrooms\", \"population\", \"households\"])","cb92e714":"scatter_plots(\"housing_median_age\", [\"total_rooms\", \"population\", \"households\"])","2447e0fc":"plt.rcParams[\"figure.figsize\"] = (20, 10)\r\nsns.scatterplot(x=\"median_income\", y=\"median_house_value\", hue=\"ocean_proximity\", data=data)\r\nplt.title(\"Medain Income vs Medain House Value\")\r\nplt.show()","681a8285":"new_data = pd.get_dummies(data)\r\nnew_data.head()","9c15f851":"X = new_data.drop(\"median_house_value\", axis=1)\r\ny = new_data.median_house_value.values.reshape(-1, 1)\r\n\r\nfrom sklearn.model_selection import train_test_split\r\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state=0)","fb2e7379":"MLA_compare = pd.DataFrame()\r\n\r\ndef MLA_testing(MLA, X_train, X_test):\r\n    row_index = 0\r\n    for classifier in MLA:\r\n        classifier.fit(X_train, y_train)\r\n\r\n        y_pred = classifier.predict(X_test)\r\n        classifier_r2_score = r2_score(y_test, y_pred)\r\n\r\n        MLA_name = classifier.__class__.__name__\r\n        MLA_compare.loc[row_index, 'MLA Name'] = MLA_name\r\n        MLA_compare.loc[row_index, 'R^2 Score'] = classifier_r2_score*100\r\n\r\n        print(MLA_name, \"Done\")\r\n        row_index+=1","d7d705b4":"MLA = [\n    tree.DecisionTreeRegressor(),\n    tree.ExtraTreeRegressor(),\n    \n    linear_model.LinearRegression(),\n    linear_model.SGDRegressor(),\n    \n    ensemble.RandomForestRegressor(),\n    ensemble.AdaBoostRegressor(),\n    ensemble.ExtraTreesRegressor(),\n    ensemble.GradientBoostingRegressor(),\n    \n    neighbors.KNeighborsRegressor(),\n]\n\nMLA_testing(MLA=MLA, X_train=X_train, X_test=X_test)","eb4e63af":"MLA_compare = MLA_compare.sort_values(by=\"R^2 Score\", ascending=False).reset_index(drop=True)[:5]\r\nMLA_compare","163804a1":"plt.rcParams[\"figure.figsize\"] = (15, 6)\r\nsns.barplot(x=\"MLA Name\", y=\"R^2 Score\",data=MLA_compare)\r\nplt.show(\"Comparing R^2 scores of Models\")\r\nplt.show()","de5e784a":"regressor = ensemble.RandomForestRegressor()\r\n\r\n# Training Model\r\nregressor.fit(X_train, y_train)\r\n\r\n# Predicting for Test set\r\ny_pred = regressor.predict(X_test)\r\n\r\n# Calculating R^2 Value\r\nr2_score = r2_score(y_test, y_pred)\r\n\r\nprint(\"R^2 Score for Test Set :\", r2_score)","86af8abf":"#### We Can observe a Positive Linearn Relation above","26cf55d3":"## Encoding Categorican Variable","da2f9fe4":"# Importing Necessary Libraries","c57654ac":"## Distribution Plot for all Numerical Features","9e312a87":"## Split data into train and test sets","d348572f":"#### Luckiely we have only one Categorical Variabale","1c520be0":"# Preparing Data","65e80f4f":"## Total Rooms vs Other Corelated Variables","205b1868":"## Checking for null values","bcb49778":"#### Only total_bedrooms column has null values - 207","69bf9152":"## Housing Median Age vs Other Corelated Features","d9a2c8ab":"## Getting top 5 Best Performing Models","c2b84595":"#### From Above Distribution we observe that the total_bedrooms data has a lot and I mean a lot of Outliers. So it would be better to fill the null values by the median.","0b69696f":"# Regression Model","657625fd":"# Analysis and EDA","88de3d9b":"# Using RandomForestRegressor","324ba6d7":"#### As Population went up with Time the Number of Rooms in houses and the Householding also went up.","203646c2":"# Preprocessing","255ed286":"## Heat map to find Corelation between Features","8de7c9cb":"## Median Income vs Median House Values","1260aa2b":"## Training and Testing Multiple Models","1e1a9eee":"#### We can say from above plots most of the features have a right skewness in their data","13404d69":"#### We can observe some strong positive relations between total_rooms, total_bedrooms, population and households\r\n#### Also there is strong negative relation between latitude and longitude","59c231e7":"## Total Bedrooms Distribution"}}