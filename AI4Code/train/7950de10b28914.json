{"cell_type":{"925d59cf":"code","55128f7f":"code","390b48a9":"code","ddb28f29":"code","80e51563":"code","aaafbf6e":"code","8c978a99":"code","5e8725bb":"code","c79a3322":"code","cb0221eb":"code","cecab6d8":"code","6e0f373e":"code","32579be3":"code","0403d4ca":"code","3c46af8d":"code","c30c102b":"code","05213237":"code","3d670c94":"code","770a9bb7":"markdown","e9fc9c49":"markdown","670f9e9e":"markdown","db40edaf":"markdown","2c14683c":"markdown","d1c297c9":"markdown","729f39a1":"markdown","803565ee":"markdown","8fbf5934":"markdown","28dbec13":"markdown","a2b668eb":"markdown","463c6d8c":"markdown","92595c77":"markdown","5a47b02c":"markdown","52a3836a":"markdown","b3e28b59":"markdown","1a25e419":"markdown","084c7aa5":"markdown","fd63a069":"markdown","939e3f29":"markdown","aa900305":"markdown","4a627b12":"markdown","58693019":"markdown","c9321586":"markdown","2343200f":"markdown","5fd324ad":"markdown","23cbe74c":"markdown","e39c84b0":"markdown","84af6531":"markdown","86f793d8":"markdown","1c6f2fcd":"markdown","7f41eab0":"markdown","cb50e78e":"markdown","770b2cc3":"markdown","b2020b1d":"markdown","93fb83a3":"markdown","81fb9817":"markdown","172841b8":"markdown","a6bf34b3":"markdown","726aaa82":"markdown","eff217c2":"markdown","7b63c78e":"markdown","d49e65ad":"markdown","5a1f6d90":"markdown","791baa90":"markdown","d1c98bec":"markdown","aab28778":"markdown"},"source":{"925d59cf":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\nfrom pywaffle import Waffle","55128f7f":"# Now, let us import the dataset.\n\ndf=pd.read_csv('SampleSuperstore.csv')\ndf.head()","390b48a9":"print('Total rows:', df.shape[0])\nprint('Total columns:', df.shape[1])","ddb28f29":"df.isnull().sum(axis = 0).to_frame()","80e51563":"df.dtypes.to_frame()","aaafbf6e":"state_code = {'Alabama': 'AL','Alaska': 'AK','Arizona': 'AZ','Arkansas': 'AR','California': 'CA','Colorado': 'CO','Connecticut': 'CT','Delaware': 'DE','Florida': 'FL','Georgia': 'GA','Hawaii': 'HI','Idaho': 'ID','Illinois': 'IL','Indiana': 'IN','Iowa': 'IA','Kansas': 'KS','Kentucky': 'KY','Louisiana': 'LA','Maine': 'ME','Maryland': 'MD','Massachusetts': 'MA','Michigan': 'MI','Minnesota': 'MN','Mississippi': 'MS','Missouri': 'MO','Montana': 'MT','Nebraska': 'NE','Nevada': 'NV','New Hampshire': 'NH','New Jersey': 'NJ','New Mexico': 'NM','New York': 'NY','North Carolina': 'NC','North Dakota': 'ND','Ohio': 'OH','Oklahoma': 'OK','Oregon': 'OR','Pennsylvania': 'PA','Rhode Island': 'RI','South Carolina': 'SC','South Dakota': 'SD','Tennessee': 'TN','Texas': 'TX','Utah': 'UT','Vermont': 'VT','Virginia': 'VA','District of Columbia': 'WA','Washington': 'WA','West Virginia': 'WV','Wisconsin': 'WI','Wyoming': 'WY'}\ndf['state_code'] = df.State.apply(lambda x: state_code[x])","8c978a99":"state_data = df[['Sales', 'Profit', 'state_code']].groupby(['state_code']).sum()\n\n\nfig = go.Figure(data=go.Choropleth(\n    locations=state_data.index, \n    z = state_data.Sales, \n    locationmode = 'USA-states', \n    colorscale = 'Reds',\n    colorbar_title = 'Sales in USD',\n))\n\nfig.update_layout(\n    title_text = 'Total State-Wise Sales',\n    geo_scope='usa',\n    height=800,\n)\n\nfig.show()","5e8725bb":"fig = go.Figure(data=go.Choropleth(\n    locations=state_data.index, # Spatial coordinates\n    z = state_data.Profit, # Data to be color-coded\n    locationmode = 'USA-states', # set of locations match entries in `locations`\n    colorscale = [[0, 'rgb(255,0,0)'], [0.25, 'rgb(255,255,255)'], [0.45, 'rgb(124,208,247)'], [0.6, 'rgb(97,255,140)'], [1, 'rgb(8,181,0)']],\n#     reversescale = True,\n    colorbar_title = 'Profits in USD',\n))\n\nfig.update_layout(\n    title_text = 'Total State-Wise Profit\/Loss',\n    geo_scope='usa', # limite map scope to USA\n    height=600,\n)\n\nfig.show()","c79a3322":"def state_data_viewer(states):\n    \"\"\"Plots the turnover generated by different product categories and sub-categories for the list of given states.\n    Args:\n        states- List of all the states you want the plots for\n    Returns:\n        None\n    \"\"\"\n    product_data = df.groupby(['State'])\n    for state in states:\n        data = product_data.get_group(state).groupby(['Category'])\n        fig, ax = plt.subplots(1, 3, figsize = (28,5))\n        fig.suptitle(state, fontsize=14)        \n        ax_index = 0\n        for cat in ['Furniture', 'Office Supplies', 'Technology']:\n            cat_data = data.get_group(cat).groupby(['Sub-Category']).sum()\n            sns.barplot(x = cat_data.Profit, y = cat_data.index, ax = ax[ax_index])\n            ax[ax_index].set_ylabel(cat)\n            ax_index +=1\n        fig.show()","cb0221eb":"states = ['California', 'Washington', 'Mississippi', 'Arizona', 'Texas']\nstate_data_viewer(states)","cecab6d8":"data = df[['Segment', 'Sales']].groupby(['Segment']).sum()\n\n# #To plot the waffle Chart \nfig = plt.figure( \n    FigureClass = Waffle,\n    figsize=(8, 8),\n    rows = 10, \n    values = data.to_numpy()\/10000,\n    title={'label': 'Sales in Each Customer Segment (Total \u2248 $2.29 million)'.upper(), 'loc': 'left'},\n    labels=[\"{} ({:.2f}%)\".format(label, percent) for label,percent in zip(list(data.index), (data.Sales\/data.Sales.sum()*100).to_numpy())],\n    legend={'loc': 'lower left', 'bbox_to_anchor': (0, -0.1), 'ncol': len(data), 'framealpha': 0},\n)","6e0f373e":"data = df[['Segment', 'Profit']].groupby(['Segment']).sum()\n\n#To plot the waffle Chart \nfig = plt.figure( \n    FigureClass = Waffle,\n    figsize=(7, 7),\n    rows = 6, \n    values = data.to_numpy()\/4000,\n    title={'label': 'Profits made by Each Customer Segment (Total \u2248 $286K)'.upper(), 'loc': 'left'},\n    labels=[\"{} ({:.2f}%)\".format(label, percent) for label,percent in zip(list(data.index), (data.Profit\/data.Profit.sum()*100).to_numpy())],\n    legend={'loc': 'lower left', 'bbox_to_anchor': (0, -0.15), 'ncol': len(data), 'framealpha': 0},\n)","32579be3":"df['price_per_product'] = df.Sales \/ df.Quantity\ndf['profit_per_product'] = df.Profit \/ df.Quantity \n\ndata = df.groupby(['Category'])\n\nfor cat, df in data:\n    sizes = np.absolute(df.price_per_product)\n    fig = px.scatter(df, x = 'price_per_product', title = cat.upper(), \n                    color = 'Sub-Category',\n                    size = sizes, hover_data=['Sub-Category'])\n    fig.update_layout(\n        height = 500,\n        xaxis = dict(title='Price Per Product'),\n        yaxis = dict(title=''),\n    )\n    fig.show()","0403d4ca":"for cat, df in data:\n    sizes = np.absolute(df.profit_per_product)\n    fig = px.scatter(df, x = 'profit_per_product', title = cat.upper(), \n                    color = 'Sub-Category',\n                    size = sizes, hover_data=['Sub-Category'])\n    fig.update_layout(\n        autosize = True,\n        height = 500,\n        xaxis = dict(title='Profit\/Loss Per Product'),\n        yaxis = dict(title=''),\n    )\n    fig.show()","3c46af8d":"for cat, df in data:\n    subCat = df.groupby(['Sub-Category']).sum()\n    fig = px.bar(subCat, y = 'Profit', title = cat.upper(), \n                    color = subCat.index)\n    fig.update_layout(\n        autosize = True,\n        width = 600,\n        yaxis = dict(title='Profit\/Loss Per Product Sub-Category'),\n        xaxis = dict(title=''),\n    )\n    fig.show()\n","c30c102b":"ship_segment = df.groupby(['Segment'])\nsegment_list = df.Segment.value_counts().index\ncat_list = df.Category.value_counts().index\n\nfor segment in segment_list:\n    seg_shipping = ship_segment.get_group(segment)\n    standard, second, first, same = [], [], [], []\n    for cat in cat_list:\n        count = seg_shipping.groupby(['Category']).get_group(cat)['Ship Mode'].value_counts()\n        standard.append(count[0]), second.append(count[1]), first.append(count[2]), same.append(count[3])\n        \n        fig = go.Figure()\n    fig.add_trace(go.Bar(x = cat_list,y = standard,name='Standard Class',marker_color='rgb(137,51,51)'\n                        ))\n    fig.add_trace(go.Bar(x = cat_list,y = second,name='Second Class',marker_color='rgb(234,84,84)'\n                        ))\n    fig.add_trace(go.Bar(x = cat_list,y = first,name='First Class',marker_color='rgb(250,127,78)'\n                        ))\n    fig.add_trace(go.Bar(x = cat_list,y = same,name='Same Day',marker_color='lightsalmon'\n                        ))\n\n    fig.update_layout(\n        barmode ='group',\n        width = 600,\n        title = segment.upper(),\n        yaxis = dict(title = 'Number of Deliveries'))\n    fig.show()","05213237":"df['loss'] = df.Profit.apply(lambda x: x if (x < 0) else 0)\n\nfig = px.bar( df,x = 'Ship Mode', y = 'loss', title = 'Losses in Each Shipping Category'.upper(), \n                    color = 'Ship Mode', hover_data=['loss', 'Sub-Category'])\nfig.update_layout(\n        autosize = True,\n        width = 800,\n        yaxis = dict(title='Total Loss'),\n        xaxis = dict(title='Shipping Class'),\n    )\nfig.show()","3d670c94":"df['whether_discount'] = df.Discount.apply(lambda x: 'No Discount' if (x == 0) else 'Discount')\n\ndiscount_data = df.groupby(['whether_discount']).mean()\n\ndef discount_plotter(data_type = 'total'):\n    \"\"\"Plots discount data related plots.\n    Args:\n        data_type- 'total' or 'average', depending on you want the average statistics or total stats.\n    \"\"\"\n    color = ['rgb(81,81,246)', 'rgb(209,70,70)']\n    if data_type == 'average':\n        discount_data = df.groupby(['whether_discount']).mean()\n        fig = make_subplots(rows=1, cols=3, subplot_titles=('AVERAGE SALE', 'AVERAGE PROFIT\/LOSS', 'AVERAGE PRICE PER PRODUCT'))\n    else:\n        discount_data = df.groupby(['whether_discount']).sum()\n        fig = make_subplots(rows=1, cols=3, subplot_titles=('TOTAL SALE', 'TOTAL PROFIT\/LOSS', 'TOTAL PRICE PER PRODUCT'))\n    fig.add_trace(\n        go.Bar(x = discount_data.index, y = discount_data.Sales, marker_color = color),\n            row=1, col=1\n    )\n    \n    fig.add_trace(\n        go.Bar(x = discount_data.index, y = discount_data.Profit, marker_color = color),\n            row=1, col=2\n    )\n\n    fig.add_trace(\n        go.Bar(x = discount_data.index, y = discount_data.price_per_product, marker_color = color),\n            row=1, col=3\n    )\n    fig.update_layout(showlegend=False)\n    fig.show()\n    \ndiscount_plotter('average')\ndiscount_plotter()","770a9bb7":"One thing to be noted is that while the superstore is incurring losses due to giving discounts on its products, they can't stop giving discounts of their products. Most of the heavy discounts are during festivals, end-of-season and clearance sales which are necessary so that the store can make space in their warehouses for fresh stock. Also, by incurring small losses, the company gains in the future by attracting more long term customers. Therefore, the small losses from discounts are an essential part of company's business.","e9fc9c49":"# Author - Deepak Kaura (DK)","670f9e9e":"# Observations from the plot above-","db40edaf":"## Data Source : - \n\nhttps:\/\/www.kaggle.com\/bravehart101\/sample-supermarket-dataset\/version\/1","2c14683c":"# THE SPARKS FOUNDATION","d1c297c9":"1) Furnitures-\n\n>    (i) If we see the average price, we'll find that most of the tables and chairs are around the $200 mark, making them one            of the most expensive furniture items.Some tables go as high as USD 550 while the most expensive chair costs USD 700.\n\n>    (ii) The most expensive item in the furniture category is a bookcase costing $880.","729f39a1":"Now, let's analyze the sales made in each consumer segment.","803565ee":"Now, we will clean our dataset, removing all the unnecessary null values in the data. As the first step, let us check for any null values within the dataset.","8fbf5934":"1) Furnitures-\n\n>  (I) Upon observing the plot, it is evident that tables are one of the businesses where the supermarket is losing most of its       money.\n\n>  (II) Book cases is another business where the supermarket is mostly just bearing losses.\n\n>  (III) If we see the overall performance, chairs seem to be generating the highest profits for the supermarket.","28dbec13":"While the above plots gives us a rough idea regarding how and in what sub category the supermarket is losing the money, it's still now clear how each sub category is performing considering the overall data. Let's have a look at the performance of each sub category.","a2b668eb":"I have few questions to answer here.\n\n>What products do the most profit making states buy?\n\n>What products do the loss bearing states buy?\n\n>What product segment needs to be improved in order to drive the profits higher?","463c6d8c":"Now, let's analyze the sales of a few random states from each profit bracket (high profit, medium profit, low profit, low loss and high loss) and try to observe some crucial trends which might help us in increasing the sales.","92595c77":"2) Office Supplies-\n\n>   (i) Most office supplies fall under the $100 mark.\n\n>   (ii) Binders and supplies are the most expensive categories, going as high as $1890.","5a47b02c":"# Observation across each product category-","52a3836a":"# Observation across each product category-","b3e28b59":"Now, for the last part of EDA section, we will see how discounts affect the sale of products and the revenue generated by it.","1a25e419":"# From the above given plots, it is clear that-\n\n> A) Tables and Bookcases are the businesses where the company is losing most of its money.\n\n> B) While the technology business is making most of the profits for the company, the machines business makes the least profit.      The supermarket can improve in that sub-category.\n\n> C) Considering the combined turnover from each category, the furniture business is where the company is barely making any          consideraable profit.Maybe the shipping modes and shipping costs for the furniture products, which are usually large, has      something to do with the low profits\/high losses.","084c7aa5":">(1) Around 50% of the total sales were made in the consumer segment which comprises of the individual buyers.\n\n>(2) The Corporate sector and Home Office segments have around 31% and 19% sales respectively.","fd63a069":"# Observations from the above given plot-\n\n>  a) Standard class shipping is the most used shipping method across all consumer segments and product categories.\n\n>  b) Across all three consumer segments, office supplies are the most bought products, and the technology items are the least        bought products.","939e3f29":">(1) The states in shades of green, namely New York, California and Washington are the most profitable for the company, with         profits of over $30K.\n\n>(2) The states in teal and blue, with an average profit of around $25K are mostly situated in the north-east and south-east         region.\n\n>(3) The state of Texas, with the third highest sales proved to be the most expensive state for the company with a very high         loss of around $25K.","aa900305":"3) Technology-\n\n>   (i) As per the plot, products in the machines and copiers sub categories are the most expensive technology items.\n\n>   (ii)Most products fall under the $200 price tag.","4a627b12":"Now, let's consider how much loss each shipping category bears.","58693019":"# Exploratory Data Analysis","c9321586":"# Observations from the plot above-\n\n>(i) The highest loss beared by the company was while delivering products via the standard class shipping. This is of no             surprise, since most products were delivered using standard shipping. However, one important thing to be noted is that some     of the biggest losses beared by the superstore also fall under the standard shipping category, one going as high as $6,600     in a single sale.\n\n>(ii) First and second class shipping have almost equal losses. This is also no surprise since the number of sales shipped under      each shipping category were also almost equal.","2343200f":"It seems there are no null values in our dataset. Now, let's check the data types of each column.","5fd324ad":"Apart from this information, it doesn't seem that shipping has a major effect on profits or losses as such.","23cbe74c":"# Data Cleaning","e39c84b0":"Now, let's analyze what percent of profits does each customer section makes for the supermarket.","84af6531":" It seems our data already pre-processed and requires no further cleaning. We can move on to performing EDA task.","86f793d8":"# Observations from the above plot are:","1c6f2fcd":"Let's have a look at what role the various shipping modes has to play in all this.","7f41eab0":"3) Technology-\n\n>   (I) The company's machine sales cause the highest loss, going as high as $1300 in loss.","cb50e78e":"Now, let's observe the prices of products across each product category and try to see how the prices are spread across each product category.","770b2cc3":">(i) In the state of California, the highest revenue generating state for the supermarket, while all the products sold across       each category are generating high-to-low profits, tables in furniture category is generating an overall loss. I verified       the same with New York, the second highest revenue generating state.\n\n>(ii) Washington, has a very positive performance, with profits generating over all product categories. A few of the low              performing product sub categories are- bookcases, supplies, fasteners, machines and phones. Overall, office supplies and        technology categories make the most profit for the supermarket.\n\n>(iii) In the state of Mississippi, a low profit generating state, we see that the Furniture category performs slightly better         than the other two categories.The Technology category performs the worst. I observed this same trend in other low profit       generating states as well.\n\n>(iv) In low-loss states like Arizona, the highest loss generating sub-categories are- Tables, binders, machines, storage, and        book cases.\n\n>(v) In Texas, the highest loss state, the furniture category is going entirely in loss, generating massive losses for the           supermarket. The performance is soo bad that the best option for the supermarket will be to end its furniture business in       the state. \n\nIn case of office supplies category, the binders (generally one of the highest revenue generating sub-category in other states) and appliances are one of the worst performers.","b2020b1d":"# Some interesting observations here.","93fb83a3":">(A) The company has the highest sales in the state of California (shown in dark maroon), selling around $450K of goods.\n\n>(B) New York (bright red, top right) is the state with the second highest sales, with more that $300k worth of goods sold.\n\n>(C) The states of Texas (bottommost, orange) and Washington (top left, orange) end up third and fourth on the top sales charts     with around $170K and 140K in sales respectively.\n\n>(D) If we look at the overall data, we will observe that the supermarket company does most of its business in East Coast and       West Coast region.\n\nIn fact, the total sales in the state of New York is more than the sales in all of the Central America combined.","81fb9817":"Now, we will perform EDA on our dataset, with an aim to uncover the hidden trends within the data which might help the superstore to increase their profits.\n\nFirst, let's have a look at the total sales per state and the revenue generated.","172841b8":"2) Office Supplies-\n\n>  (I) While binders generate most revenue for the company, it is also one of the highest-loss sub-categories in the office            supplies category.","a6bf34b3":"# Observations from the above given plots:","726aaa82":"# Observations from the above given plots-\n\n> A) Considering both average and total sales, it seems that people tend to buy more things when it is selling at a discounted      price. An average sale at discounted price is of around USD 232 as compared to USD 226 on undiscounted price.\n\n> B) On an average, a discounted sale results in a loss of around USD 6 as compared to around USD 66 in profit on a non-            discounted sale. Also, the company made a total profit of around USD 320K on non-discount sales, as compared to a loss of      around USD 34K on discounted sales.\n\n> C) The average price of a discounted product is around USD 62, while the same is around USD 58 for a non-discounted item.","eff217c2":">(a) While the Consumer segment had more than 50% in sales, its total contribution in the profits made by the company is only       around 46%. This shows that the company is bearing a higher loss in the Consumer segment.\n\n>(b) The Corporate and the Home Office segments are returning more profits to the supermarket as compared to the sales made.         While their joint sales is around 50%, thier joint profits made for the supermarket is around 54%.\n\n\nHere, the company can do two things in order to increase their profits. They can look into the reasons why they are bearing more losses in the consumer segment and try to reduce those losses, thus directly increasing the sales.\n\nOther route the company can take is to providing more polished services to the Corporate and Home Office segments, thus driving them towards more profits.","7b63c78e":"# Task 3 - Exploratory Data Analysis - Retail","d49e65ad":"Now, let's have a look at which shipping method different consumer segments use the most for buying products in different product categories.","5a1f6d90":"Now, let's have a look at how much each product generates or loses in terms of revenue.","791baa90":"Since we will be working with some geographical plots, let's map the state names to state codes.","d1c98bec":"# Observations from the above given geographical plot-","aab28778":"# Highlighted points for this task :-\n\n> Perform \u2018Exploratory Data Analysis\u2019 on dataset \u2018SampleSuperstore\u2019 \n\n> As a business manager, try to find out the weak areas where you can work to make more profit. \n\n> What all business problems you can derive by exploring the data? "}}