{"cell_type":{"c93798af":"code","cc0cc083":"code","0a19ead8":"code","90a46a3c":"code","b6201e2d":"code","a4ffafee":"code","a3bd611c":"code","0fc7370f":"code","62c08994":"code","641205e5":"code","2b61f1ce":"code","3cf551a8":"code","344ec919":"code","7113563e":"code","c8ea634e":"code","fb08e99b":"code","e0458933":"code","67533d44":"code","86d690a3":"code","a7a8c3d4":"code","54c2f105":"code","915875ef":"code","70637bd1":"code","6ec9d931":"code","9b26ec5f":"code","9d2af5aa":"markdown","bc532076":"markdown","978684a9":"markdown","9c5cf5dc":"markdown","e2918896":"markdown","b907fbe3":"markdown","f0a2a843":"markdown","5a491fdc":"markdown","6593c886":"markdown","ae9c8bfa":"markdown","26fb234c":"markdown","49b40282":"markdown","9be5b84b":"markdown","113c1743":"markdown","0aa2b860":"markdown","04d18499":"markdown","06116f1b":"markdown","d9ad251e":"markdown","1dfb844a":"markdown"},"source":{"c93798af":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.cluster import KMeans\nimport scipy.cluster.hierarchy as sch\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","cc0cc083":"data=pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\ndata.head()","0a19ead8":"data.isna().sum()","90a46a3c":"data.shape","b6201e2d":"data.info()","a4ffafee":"data.describe()","a3bd611c":"data['Gender'].value_counts()","0fc7370f":"sns.countplot(data['Gender'], palette='Blues_r')","62c08994":"plt.figure(figsize=(20,15))\nplt.subplot(3,1,1)\nsns.countplot(data['Age'], palette='icefire')\nplt.subplot(3,1,2)\nsns.countplot(data['Annual Income (k$)'], palette='icefire')\nplt.subplot(3,1,3)\nsns.countplot(data['Spending Score (1-100)'], palette='icefire')","641205e5":"plt.figure(figsize=(20,12))\nplt.subplot(1,3,1)\nsns.distplot(data['Age'], kde=True, rug=True)\n\nplt.subplot(1,3,2)\nsns.distplot(data['Annual Income (k$)'],kde=True, rug=True, color='Pink')\nplt.tight_layout()\n\nplt.subplot(1,3,3)\nsns.distplot(data['Spending Score (1-100)'],kde=True, rug=True, color='Purple')\nplt.tight_layout()","2b61f1ce":"sns.heatmap(data.corr(), annot=True, color='Blue')","3cf551a8":"sns.catplot('Gender', 'Spending Score (1-100)', data=data, kind='violin',palette = 'Blues')\n","344ec919":"sns.catplot('Gender', 'Annual Income (k$)',data=data, palette = 'cividis',kind='box')","7113563e":"sns.lmplot(x='Annual Income (k$)', y='Spending Score (1-100)',hue='Gender', data=data, fit_reg=False)","c8ea634e":"sns.lmplot(x='Age', y='Spending Score (1-100)',hue='Gender', data=data, fit_reg=False)","fb08e99b":"sns.lmplot(x='Age', y='Annual Income (k$)',hue='Gender', data=data, fit_reg=False)","e0458933":"df=pd.get_dummies(data, drop_first=True)\ndf.head()","67533d44":"df.drop('CustomerID',inplace=True, axis=1)\ndf.head()","86d690a3":"scaler=StandardScaler()\ndfscaled=scaler.fit_transform(df)\ndfscaled=pd.DataFrame(dfscaled)\ndfscaled.columns=['Age', 'Annual Income (k$)', 'Spending Score (1-100)', 'Gender_Male']\ndfscaled.drop('Gender_Male',inplace=True, axis=1)\ndfscaled.head()","a7a8c3d4":"kdata=dfscaled[['Age','Spending Score (1-100)']]\nkdata.head()","54c2f105":"kssd=[]\nfor i in range(1, 11):\n    km = KMeans(n_clusters = i, init = 'k-means++', max_iter = 300, n_init = 10, random_state = 0)\n    km.fit(kdata)\n    kssd.append(km.inertia_)\nplt.plot(range(1, 11), kssd)","915875ef":"plt.figure(figsize=(20,12))\nkm = KMeans(n_clusters = 4, init = 'k-means++', max_iter = 300, n_init = 10, random_state = 0)\ny_means = km.fit_predict(kdata)\nkdata = np.array(kdata)\nplt.scatter(kdata[y_means == 0, 0], kdata[y_means == 0, 1], s = 100, c = 'pink', label = 'Normal shopper')\nplt.scatter(kdata[y_means == 1, 0], kdata[y_means == 1, 1], s = 100, c = 'yellow', label = 'Young Frequent')\nplt.scatter(kdata[y_means == 2, 0], kdata[y_means == 2, 1], s = 100, c = 'cyan', label = 'Old frequent')\nplt.scatter(kdata[y_means == 3, 0], kdata[y_means == 3, 1], s = 100, c = 'magenta', label = 'Privilege')\n\nplt.scatter(km.cluster_centers_[:,0], km.cluster_centers_[:, 1], s = 50, c = 'blue' , label = 'centeroid')\n\nplt.style.use('fivethirtyeight')\nplt.title('K Means Clustering - based on age group', fontsize = 20)\nplt.xlabel('Age')\nplt.ylabel('Spending Score')\nplt.legend()\nplt.grid()\nplt.show()\n","70637bd1":"kdata=dfscaled[['Annual Income (k$)','Spending Score (1-100)']]\nkdata.head()","6ec9d931":"kssd=[]\nfor i in range(1, 11):\n    km = KMeans(n_clusters = i, init = 'k-means++', max_iter = 300, n_init = 10, random_state = 0)\n    km.fit(kdata)\n    kssd.append(km.inertia_)\nplt.plot(range(1, 11), kssd)","9b26ec5f":"plt.figure(figsize=(20,12))\nkm = KMeans(n_clusters = 5, init = 'k-means++', max_iter = 300, n_init = 10, random_state = 0)\ny_means = km.fit_predict(kdata)\nkdata = np.array(kdata)\nplt.scatter(kdata[y_means == 0, 0], kdata[y_means == 0, 1], s = 100, c = 'pink', label = 'penny-pincher')\nplt.scatter(kdata[y_means == 1, 0], kdata[y_means == 1, 1], s = 100, c = 'yellow', label = 'spendthrift')\nplt.scatter(kdata[y_means == 2, 0], kdata[y_means == 2, 1], s = 100, c = 'cyan', label = 'general customer')\nplt.scatter(kdata[y_means == 3, 0], kdata[y_means == 3, 1], s = 100, c = 'magenta', label = 'target customer')\nplt.scatter(kdata[y_means == 4, 0], kdata[y_means == 4, 1], s = 100, c = 'orange', label = 'careful spender')\nplt.scatter(km.cluster_centers_[:,0], km.cluster_centers_[:, 1], s = 50, c = 'blue' , label = 'centeroid')\n\nplt.style.use('fivethirtyeight')\nplt.title('K Means Clustering-mbased on spending habits', fontsize = 20)\nplt.xlabel('Annual income')\nplt.ylabel('Spending Score')\nplt.legend()\nplt.grid()\nplt.show()","9d2af5aa":"#### From above count we know demographics of customer based on gender of all 200,  44% are Male and 66% are female, Female customers are more","bc532076":"### Clustering on age and spending score","978684a9":"#### Plotting sum of square distance to get elbow curve , so that we can get optimal cluster where  cluster count doesnt make any huge significant improvement","9c5cf5dc":"### Determine various segment of customer based on annual income and  spending score i.e spending habits","e2918896":"#### Plotting cluster and identifying labels based on spending score and age to find customer segments","b907fbe3":"### Checking for null values","f0a2a843":"#### Checking for correlation between feature","5a491fdc":"### Performing scaling of features","6593c886":"### Creating dummies for categorical feature","ae9c8bfa":"#### According to  elbow chart 5 are optimal cluster to be  form","26fb234c":"#### Customer with age group upto 40 have higher spending score  means they are frequent shopper that go with trends and shop with low to average annual income if we see insight from annual income distribution and age -annual income relationship  below.","49b40282":"## EDA ","9be5b84b":"#### Annual income and spending score shows  grouping in chart which show high possibility to group and segment customer based on there annual income and spending pattern","113c1743":"# Customer Segmentation and Analysis","0aa2b860":"### K-Means Clustering Algorithm to determine various segment of customer based on age and  spending score","04d18499":"#### Plotting sum of square distance to get elbow curve , so that we can get optimal cluster where  cluster count doesnt make any huge significant improvement","06116f1b":"### Checking data  info\"","d9ad251e":"\n#### Plotting cluster and identifying labels based on annual income and  spending score","1dfb844a":"#### From inspecting all above  we can tell there are more customer from age of 40-70 that have higher annual income, and we can see same having higher spending score, below distribution plot verify our analysis"}}