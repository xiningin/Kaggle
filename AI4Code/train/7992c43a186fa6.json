{"cell_type":{"473b5fdd":"code","5f2caf73":"code","6746ce9b":"code","2fe40aa0":"code","d812c766":"code","9796d3b7":"code","7d2c727c":"code","b82953b5":"code","43706642":"code","91b30ba8":"code","57148973":"code","15e2c401":"code","d8a28fe5":"code","c4886fd5":"code","d6dcf24a":"code","20205cff":"code","14a121b2":"code","b50d4508":"code","f5e4ce8b":"code","9e68e0e6":"code","6877d745":"code","9eda905e":"code","67533a8e":"code","d1f2e1cd":"code","351264ee":"code","2610fd83":"markdown","29e54392":"markdown","b493f589":"markdown","dc15d6a1":"markdown","2d066af6":"markdown","729e673c":"markdown","5b2042a8":"markdown","fa3e46e3":"markdown","4fcae860":"markdown"},"source":{"473b5fdd":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\n# Any results you write to the current directory are saved as output.","5f2caf73":"import glob\ntrain_arr = []\nfor file in glob.glob(\"..\/input\/train\/train\/*\/*\"):\n    train_arr.append({\"name\": file, \"label\": file.split(\"\/\")[-2]})\ndf = pd.DataFrame(train_arr)","6746ce9b":"df.sample(frac=1).head()","2fe40aa0":"df[\"label\"].nunique()","d812c766":"df[\"label\"].value_counts()","9796d3b7":"import numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.plotly as py\nimport plotly.graph_objs as go\nfrom plotly.offline import init_notebook_mode,iplot\nimport plotly.figure_factory as ff\ninit_notebook_mode(connected=True)\nimport matplotlib.cm as cm\nimport re","7d2c727c":"iplot([go.Bar(\nx=df[\"label\"].value_counts().keys(),\ny=df[\"label\"].value_counts())])","b82953b5":"!pip install imagesize","43706642":"import imagesize\ndf[\"width\"] = 0\ndf[\"height\"] = 0\ndf[\"aspect_ratio\"] = 0.0\nfor idx, row in df.iterrows():\n    width, height = imagesize.get(row[\"name\"])\n    df.at[idx, \"width\"] = width\n    df.at[idx, \"height\"] = height\n    df.at[idx, \"aspect_ratio\"] = float(height) \/ float(width)","91b30ba8":"df.head()","57148973":"df[\"height\"].hist()","15e2c401":"df[\"width\"].hist()","d8a28fe5":"df[\"aspect_ratio\"].hist()","c4886fd5":"from fastai.vision import *","d6dcf24a":"path = Path(\"..\/input\")\ntfms = get_transforms()\ndata = ImageDataBunch.from_folder(path\/\"train\",valid_pct=0.1, ds_tfms=tfms, size=224)","20205cff":"data.show_batch(rows=2, figsize=(5,5))","14a121b2":"df.head()","b50d4508":"data = ImageDataBunch.from_df(\"\", df=df[[\"name\", \"label\"]], label_col=\"label\", folder=\"\", size=64)","f5e4ce8b":"data.show_batch(rows=3, figsize=(5,5))","9e68e0e6":"learn = cnn_learner(data, models.resnet18, metrics=error_rate)","6877d745":"learn.fit_one_cycle(1)","9eda905e":"interp = ClassificationInterpretation.from_learner(learn)","67533a8e":"interp.plot_confusion_matrix(figsize=(25,25))","d1f2e1cd":"interp.plot_top_losses(9, figsize=(25,25))","351264ee":"interp.most_confused()","2610fd83":"Let's also see the width\/height and aspect ratio for the images.","29e54392":"**Let's inspect the distribution of classes**","b493f589":"In this kernel, we will try to first create a pandas dataframe from the given dataset present as image files and then use it to feed into the training model.","dc15d6a1":"Since all the images are not of same aspect ratio, it will be important to decide how we crop\/scale the images while applying augmentations","2d066af6":"<h3> Using fastai's ClassificationInterpretation to analyze the training results <\/h3>","729e673c":"<h3> \nApproach of data loading #2 ImageDataBunch.from_df<h3>","5b2042a8":"Same could be visualized using plot.ly chart","fa3e46e3":"<h3> \nApproach of data loading #1 ImageDataBunch.from_folder<h3>","4fcae860":"We can see that there is imbalance in the distribution."}}