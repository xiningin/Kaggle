{"cell_type":{"b032bf3c":"code","b37a6bb4":"code","8ad1df33":"code","5f662ef2":"code","c8485cd3":"code","8e586dcc":"code","38123163":"code","e2f5c66a":"code","f6ef099c":"code","dfa9aaeb":"code","d2a4add6":"code","71b93f16":"code","dbe790b6":"code","a0bc3b72":"code","b4702b20":"code","f5afdec4":"code","02c7a0dc":"code","01c82a5b":"code","a984ffff":"code","c66f0d40":"code","5436e32a":"code","bffcee2c":"code","41be66cc":"code","fe4b95b2":"code","21b2c0f4":"markdown","52c572a3":"markdown","15b86ff3":"markdown","7a2f3224":"markdown","92575692":"markdown","2390f823":"markdown","2f22c467":"markdown","729f2137":"markdown","9d6b272d":"markdown","834808a0":"markdown","e6b091c1":"markdown","dfe4572e":"markdown","7fe2ce0e":"markdown","ed35a083":"markdown","fcfbfaec":"markdown","a7495877":"markdown","7117503c":"markdown","ea7cd919":"markdown","e42bfb76":"markdown","66bd9139":"markdown","df2818f5":"markdown","4f35f38f":"markdown","d1bfbde0":"markdown","adcedf55":"markdown","8ea1aa3b":"markdown","f7603cdc":"markdown","af9bd152":"markdown","a2778d33":"markdown","be3d68f1":"markdown","22a41c22":"markdown","a26f4056":"markdown","3a506759":"markdown","1f2c2e09":"markdown"},"source":{"b032bf3c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot\nimport cufflinks as cf\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n","b37a6bb4":"df=pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","8ad1df33":"df.head(5)","5f662ef2":"len(df)","c8485cd3":"df.isnull().sum()","8e586dcc":"import missingno as msno\nmsno.matrix(df)","38123163":"df['Gender'].unique()","e2f5c66a":"print(sum(df.duplicated()))\ndf = df.drop_duplicates()\n","f6ef099c":"ig, axes = plt.subplots(1,2, figsize=(21,6))\nsns.distplot(df['Age'], ax=axes[0])\nsns.distplot(df['Annual Income (k$)'], ax=axes[1])\n\n","dfa9aaeb":"sns.countplot(x='Gender', data=df, palette='viridis')","d2a4add6":"sns.stripplot(x='Gender', y = 'Spending Score (1-100)', data = df)","71b93f16":"sns.boxplot( x= 'Gender', y = 'Annual Income (k$)', data = df )","dbe790b6":"x = df['Annual Income (k$)']\ny = df['Age']\nz = df['Spending Score (1-100)']\n\nsns.lineplot(x, y, color = 'blue')\nsns.lineplot(x, z, color = 'pink')\nplt.title('Annual Income vs Age and Spending Score', fontsize = 20)\nplt.show()\n","a0bc3b72":"df['Gender'].replace({'Male': 0, 'Female': 1},inplace = True) ","b4702b20":"df.head(5)","f5afdec4":"df.drop('CustomerID', axis=1, inplace = True)","02c7a0dc":"df.head(5)","01c82a5b":"sns.heatmap(df.corr(), annot=True)","a984ffff":"def impute_age(cols):\n    spend=cols\n    if spend > 55:\n         return 1\n    else:\n         return 0\ndf['Spending Score (1-100)'] = df['Spending Score (1-100)'].apply(impute_age)\ndf.head(5)\n    ","c66f0d40":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test= train_test_split(df.drop('Spending Score (1-100)',axis=1), df['Spending Score (1-100)'], test_size=0.30, random_state=101)\nfrom sklearn.linear_model import LogisticRegression\nlog=LogisticRegression()\nlog.fit(X_train,y_train)\npred=log.predict(X_test)\nfrom sklearn.metrics import classification_report\nprint(classification_report(y_test, pred))\n","5436e32a":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nscaler.fit(df.drop('Spending Score (1-100)',axis=1))\nscaled_features = scaler.transform(df.drop('Spending Score (1-100)',axis=1))\ndf_feat = pd.DataFrame(scaled_features,columns=df.columns[:-1])\ndf_feat.head()\n","bffcee2c":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(scaled_features,df['Spending Score (1-100)'],\n                                                    test_size=0.30)\nfrom sklearn.neighbors import KNeighborsClassifier\nknn = KNeighborsClassifier(n_neighbors=1)\nknn.fit(X_train,y_train)\npred = knn.predict(X_test)\nfrom sklearn.metrics import classification_report,confusion_matrix\nprint(confusion_matrix(y_test,pred))\nprint(classification_report(y_test,pred))","41be66cc":"error_rate = []\n\nfor i in range(1,40):\n    \n    knn = KNeighborsClassifier(n_neighbors=i)\n    knn.fit(X_train,y_train)\n    pred_i = knn.predict(X_test)\n    error_rate.append(np.mean(pred_i != y_test))\n    plt.figure(figsize=(10,6))\nplt.plot(range(1,40),error_rate,color='blue', linestyle='dashed', marker='o',\n         markerfacecolor='red', markersize=10)\nplt.title('Error Rate vs. K Value')\nplt.xlabel('K')\nplt.ylabel('Error Rate')","fe4b95b2":"\nknn = KNeighborsClassifier(n_neighbors=3)\n\nknn.fit(X_train,y_train)\npred = knn.predict(X_test)\n\nprint('WITH K=3')\nprint('\\n')\nprint(confusion_matrix(y_test,pred))\nprint('\\n')\nprint(classification_report(y_test,pred))","21b2c0f4":"Here we have replaced males with 1 and females with 0. Quantifying the variables will enable us to execute machine learning methods for future predictions. Now lets check if we have succesfully dummied these values or not.\n","52c572a3":"Now lets look at some complex plot","15b86ff3":"There are few outliers in the male population on the top. Surprisingly, the females have a little less average income but still our store has more female customers which clearly indicates that females visit our stores regardless of their income. Perhaps, men are more interested in saving than spending. ","7a2f3224":"Out of 200 people, around 115 were women while 85 were men. The barchart above clearly illustrates the fact that we have more female\ncustomers than male. Perhaps, we have more of household products or may be our stores have more emphasis on items on which female \npopulation is interested","92575692":"And there are 200 columns. So this is quite a small dataset with less number of rows and columns. Now lets begin working with all the data that we have","2390f823":"Here we have standardized out data for further processing.","2f22c467":"Now lets look onto the distribution of age and income of our customers","729f2137":"With interval value=1, we see that our predicitve probability is just 0.68. Lets check which interval value between 1 and 40 gives us the most accurate result.","9d6b272d":"**Machine Learning: K-Means Clustering**","834808a0":"### Author : Sanjoy Biswas\n### Topic : Mall Customer Segmentation & Analysis\n### Email : sanjoy.eee32@gmail.com","e6b091c1":"You can see that our graph shows continuous dark lines without any horizozntal interruptions. This support our previous idea that we dont have any missing values","dfe4572e":"So with the K-Nearest Neighbour algorithm, we can predict if a customer is our target customer or not with a probability of roughly 8\/10, which is pretty much acceptable. Hope you found this analysis helpful. Feel free to ask if you have any questions with the code above. There are other algorithms that you can apply to find if they are more accurate.","7fe2ce0e":"**Machine Learning: Logistic Regression**","ed35a083":"**THANK YOU**","fcfbfaec":"Since the customer ID are nothing more than unique numbers assigned to each customers, we have removed this column. Lets check","a7495877":"The first figure shows us that the average age of our customers is around 35. The age of our customers is typically between 20 and 70.","7117503c":"Now lets look onto the spending scores of male and female individually","ea7cd919":"As we can see the logistic regresion only has a probability of predicting the target customer with a probability of 0.6, which is pretty low, we will apply another machine learning technique( K Nearest Neighbor) to our data.","e42bfb76":"Now, lets make a fair assumption that people with spending score of more than 55( the topmost chunk in the aforementioned plot)\nare our target customers as they are highly likely to make purchases. Once we can accurately predict these group of customers by looking at their age, gender and income , we cann apply several tactics like sending emails of new offers to increase the number of purchases","66bd9139":"But first we need to check if there are any missing values or not. Turns out our dataset is clean without any null values. So we dont have to worry about filling any missing columns or rows","df2818f5":"**DATA WRANGLING AND VISUALIZATION**","4f35f38f":"Now lets check the Gender Column. There might be two possiblities: either gender is just classified as male and female or there are other classifications that identify LGBTQ community. ","d1bfbde0":"We can see that people with the highest spending score are the ones with annual income of 50k. Perhaps our store is a retail store with only few luxury brands and more of household and daily products. Despite large income, some people appear to have decreasing spending score which is clear onthe right edge of the graph.","adcedf55":"As you can see we have five columns: Customer ID , Gender, Annual Income and Spending score.","8ea1aa3b":"The figure above indicates that none of the columns we have are strongly correlated to each other. So using machine learning technique of linear regression wont give us an accurate predictive outcome","f7603cdc":"Lets see which gender makes up the majority of people visiting our store","af9bd152":"Roughly, male and female both have similar spending score. We can see more number of dots on the female side because of \nlarge number of female population compared to male population. We can see both the male and female population have two gaps in their distribution : around 20 and 60. These two gaps divide the population into three chunks: people with score below 20, people with score between 30 and 60 , and people with speding score between 60 and 80. So we conclude that there are three types of customers in both the gender on the basis of their spending habit. We are most interested in the top most group.  ","a2778d33":"We can see from the figure above that at the K interval value of 3, the error rate is low.So now,lets find the classification report with error rate =3.","be3d68f1":"So we only have two genders listed.\nNow lets do some short codings so that we dont have any duplicate values.","22a41c22":"Now lets see if there is any differences in the income of the population in two genders that might explain their spending habit","a26f4056":"Now talking about annual income, majority of our customers have an annual income around 80K per annum. The salary ranges from 15k to 135k","3a506759":"Now lets try to find if there is any correlation between any of our data.","1f2c2e09":"# **Data Import  And Preprocessing**"}}