{"cell_type":{"86d67e38":"code","a4f4cb48":"code","a517625f":"code","b33e228b":"code","aa745b67":"code","fb5ee21b":"code","085359f0":"code","e74ea05b":"code","f29af925":"code","c8db469d":"code","d240c27f":"markdown","0efd9c5b":"markdown","7306a885":"markdown","d1f9ae20":"markdown"},"source":{"86d67e38":"!pip install pycaret -q","a4f4cb48":"!wget -q https:\/\/www.flaticon.com\/svg\/static\/icons\/svg\/3313\/3313446.svg\n!wget -q https:\/\/www.flaticon.com\/svg\/static\/icons\/svg\/89\/89977.svg","a517625f":"import pandas as pd\nimport numpy  as np\n\nimport plotly.express as px\nimport matplotlib.pyplot as plt\n\nfrom pycaret.nlp import create_model, setup, plot_model, assign_model, evaluate_model, tune_model","b33e228b":"raw_data = pd.read_csv('..\/input\/trip-advisor-hotel-reviews\/tripadvisor_hotel_reviews.csv')\nraw_data['Review'] = raw_data['Review'].str.replace('*',' stars')\nraw_data","aa745b67":"# Check Rating Distribution\nfig = px.histogram(raw_data,\n             x = 'Rating',\n             title = 'Histogram of Review Rating',\n             template = 'plotly_dark',\n             color = 'Rating',\n             color_discrete_sequence= px.colors.sequential.Blues_r,\n             opacity = 0.8,\n             height = 525,\n             width = 835,\n            )\n\nfig.update_yaxes(title='Count')\nfig.show()","fb5ee21b":"# Configure the first experiment - General Topic Modeling\nexperiment_1 = setup(raw_data,\n                          target = 'Review',\n                          session_id = 451,\n                          log_experiment = True,\n                          log_plots = True,\n                          experiment_name='General Topic Modeling'\n                         )","085359f0":"lda_grid = {'num_topics':list(range(2,5))}","e74ea05b":"# Create an Latent Dirilech Allocation model\n#lda_model = create_model('lda')\ntuned_lda = tune_model(model = 'lda',\n                       multi_core = True,\n                       supervised_target = 'Rating',\n                       custom_grid = list(range(2,5)),                      \n                      )\n\n# Assign model results\nlda_results = assign_model(tuned_lda)\nlda_results.head()","f29af925":"#evaluate_model(lda_model)","c8db469d":"plot_model(lda_model, plot = 'topic_model')","d240c27f":"> Due to the abscence of a starter kernel, I took the liberty of creating this one :)","0efd9c5b":"# Supervised Topic Modeling","7306a885":"In this section, we'll apply topic modeling for the entire dataset taking the ratings into account, this will tie the topics to the ratings as we desire.","d1f9ae20":"> Select a plot and press the `Run Interact` button."}}