{"cell_type":{"46d1045f":"code","e1256d0a":"code","b020c1ce":"code","53a8ac28":"code","53cff4c2":"code","c6422dea":"code","6d6241f0":"code","907a887a":"code","339e4d1b":"code","4d62d4d6":"code","e76b3b19":"code","03599b1d":"code","e9a927dc":"code","f32c86f9":"code","99580ce2":"code","04996064":"code","83a34909":"code","04c02fa6":"code","7b70d724":"code","43e81a0e":"code","f57f9c7b":"code","333bb368":"code","89e82139":"code","544f8bc6":"code","df771ff3":"code","d1cfacbc":"code","ea8fbddc":"code","8e016792":"code","30ff07f0":"code","cec415d1":"code","6783dddc":"code","6c8682f9":"code","fd92b058":"code","db0988f6":"code","7f42e27b":"code","9bc9e3cc":"code","099ff30b":"code","434a6908":"code","f0788fbd":"code","e6447e3c":"code","f57fe60c":"code","fcc7b3ac":"code","f7654b51":"code","f0cd4074":"code","969339b5":"code","1c43726a":"code","f00b3df1":"code","b1a60798":"code","bd3c665d":"code","27c747ab":"code","ad5a1de3":"code","47975244":"code","032172a6":"code","7aefe4eb":"code","4fdc94d8":"code","39e5376d":"code","75a7fe49":"code","9f0c3be8":"code","077a1bcc":"code","762122be":"code","2d0ad569":"code","3e987f1a":"code","9d36fbfb":"code","9c468708":"code","891b6d37":"code","72de257f":"code","cc7aa459":"code","823eacaa":"markdown"},"source":{"46d1045f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","e1256d0a":"train=pd.read_csv(\"\/kaggle\/input\/titanic\/train.csv\")\ntrain.head()","b020c1ce":"test=pd.read_csv(\"\/kaggle\/input\/titanic\/test.csv\")\ntest.head()","53a8ac28":"print(train.shape)\nprint(test.shape)","53cff4c2":"print(train.info())\n","c6422dea":"train.describe()","6d6241f0":"round(100*(train.isnull().sum()\/len(train)),2).sort_values(ascending=False)","907a887a":"train.drop(\"Cabin\",1,inplace=True)","339e4d1b":"round(100*(train.isnull().sum()\/len(train)),2).sort_values(ascending=False)","4d62d4d6":"women = train.loc[train.Sex == 'female'][\"Survived\"]\nrate_women = sum(women)\/len(women)\n\nprint(\"% of women who survived:\", rate_women)","e76b3b19":"men = train.loc[train.Sex == 'male'][\"Survived\"]\nrate_men = sum(men)\/len(men)\n\nprint(\"% of men who survived:\", rate_men)","03599b1d":"sns.distplot(train[\"Age\"])","e9a927dc":"a=train.Age.mean()","f32c86f9":"train.Age=train.Age.fillna(a)\n","99580ce2":"train.head()","04996064":"round(100*(train.isnull().sum()\/len(train)),2).sort_values(ascending=False)","83a34909":"train=train.dropna()","04c02fa6":"round(100*(train.isnull().sum()\/len(train)),2).sort_values(ascending=False)","7b70d724":"sns.countplot(x=\"Pclass\",hue=\"Survived\",data=train)","43e81a0e":"sns.countplot(x=\"Sex\",hue=\"Survived\",data=train)","f57f9c7b":"sns.countplot(x=\"SibSp\",hue=\"Survived\",data=train)","333bb368":"sns.countplot(x=\"Parch\",hue=\"Survived\",data=train)","89e82139":"sns.distplot(train[\"Fare\"])","544f8bc6":"sns.countplot(x=\"Fare\",hue=\"Survived\",data=train)","df771ff3":"sns.boxplot(train[\"Fare\"])","d1cfacbc":"test.info()","ea8fbddc":"test.describe()","8e016792":"round(100*(test.isnull().sum()\/len(test)),2).sort_values(ascending=False)","30ff07f0":"test.drop(\"Cabin\",1,inplace=True)","cec415d1":"round(100*(test.isnull().sum()\/len(test)),2).sort_values(ascending=False)","6783dddc":"test.Age=test.Age.fillna(a)","6c8682f9":"round(100*(test.isnull().sum()\/len(test)),2).sort_values(ascending=False)","fd92b058":"test.Fare.mean()","db0988f6":"round(100*(test.isnull().sum()\/len(test)),2).sort_values(ascending=False)","7f42e27b":"test.Fare=test.Fare.fillna(test.Fare.mean())\ntest.head()","9bc9e3cc":"train.columns","099ff30b":"X_train=train.drop(['PassengerId','Survived',\"Name\"],1)\nX_train.head()","434a6908":"train_dum=pd.get_dummies(train.Sex)\ntrain_dum.head()","f0788fbd":"X_train=pd.concat([X_train,train_dum],axis=1)\nX_train.head()","e6447e3c":"train_dum=pd.get_dummies(train.Embarked)\ntrain_dum.head()","f57fe60c":"X_train=pd.concat([X_train,train_dum],axis=1)\nX_train.head()","fcc7b3ac":"X_train.drop([\"Sex\",\"Embarked\",\"Ticket\"],1,inplace=True)","f7654b51":"X_train.head()","f0cd4074":"X_train.columns","969339b5":"y_train=train[\"Survived\"]\ny_train.head()","1c43726a":"from sklearn import tree","f00b3df1":"model=tree.DecisionTreeClassifier(max_depth=3)","b1a60798":"model.fit(X_train,y_train)","bd3c665d":"model.score(X_train,y_train)","27c747ab":"from sklearn.tree import plot_tree\nplt.figure(figsize=(60,30))\nplot_tree(model,filled=True);","ad5a1de3":"test.columns","47975244":"X_test=test.drop(['PassengerId',\"Name\"],1)\nX_test.head()","032172a6":"test_dum=pd.get_dummies(test.Sex)\ntest_dum.head()","7aefe4eb":"X_test=pd.concat([X_test,test_dum],axis=1)\nX_test.head()","4fdc94d8":"test_dum=pd.get_dummies(test.Embarked)\ntest_dum.head()","39e5376d":"X_test=pd.concat([X_test,test_dum],axis=1)\nX_test.head()","75a7fe49":"X_test.drop([\"Sex\",\"Embarked\",\"Ticket\"],1,inplace=True)","9f0c3be8":"X_test.head()","077a1bcc":"train_pred=model.predict(X_train)\ntest_pred=model.predict(X_test)","762122be":"from sklearn.metrics import confusion_matrix, accuracy_score","2d0ad569":"print(accuracy_score(y_train,train_pred))","3e987f1a":"confusion_matrix(y_train,train_pred)","9d36fbfb":"l=list(test_pred)\nl[:10]","9c468708":"sub=pd.read_csv(\"\/kaggle\/input\/titanic\/gender_submission.csv\")\nsub.head()","891b6d37":"#so\nmy_sub=pd.DataFrame({\"PassengerId\":test[\"PassengerId\"],\"Survived\":l})\nmy_sub.head()","72de257f":"from sklearn.ensemble import RandomForestClassifier\n\ny = train[\"Survived\"]\n\nfeatures = [\"Pclass\", \"Sex\", \"SibSp\", \"Parch\"]\nX = pd.get_dummies(train[features])\nX_test = pd.get_dummies(test[features])\n\nmodel = RandomForestClassifier(n_estimators=100, max_depth=5, random_state=1)\nmodel.fit(X, y)\npredictions = model.predict(X_test)\n\noutput = pd.DataFrame({'PassengerId': test.PassengerId, 'Survived': predictions})\noutput.to_csv('submission.csv', index=False)\nprint(\"Your submission was successfully saved!\")","cc7aa459":"model.predict(X_test)","823eacaa":"# For Test Set****"}}