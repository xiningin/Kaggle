{"cell_type":{"4f39ac47":"code","4110a6da":"code","5c712e35":"code","6f59e8f7":"code","6fb1af47":"code","eae81d55":"code","67ffbb6b":"code","3c80795e":"code","5b082884":"code","aae240ba":"code","9aed0ca0":"code","a0291b6f":"code","be15fa44":"code","a91ef433":"code","f5a2eb70":"code","95e56a3d":"code","09348770":"code","53f6afc7":"code","60c29a70":"code","3ea10f15":"markdown","d763b94f":"markdown","3194c699":"markdown","29a3c8d6":"markdown","09803796":"markdown","35b72a0d":"markdown","2f5618ee":"markdown","9c646069":"markdown","f7a39b32":"markdown","7dc45b40":"markdown","a910dc1a":"markdown","e4d089a5":"markdown","c1281208":"markdown","c8a5b47e":"markdown","ebf11463":"markdown"},"source":{"4f39ac47":"import pandas as pd\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split, cross_val_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import confusion_matrix","4110a6da":"data = pd.read_csv('------------------\/heart.csv')\ndf = data.rename(columns={'trtbps':'rest_bps','thalachh':'thal',\n                              'exng':'exang','caa':'ca','output':'mark'})\n\ndf1 = df.drop(labels=['slp','thall'], axis=1, inplace=False)\ncolumns = df1.columns","5c712e35":"corr_Pearson = df1.corr(method='pearson')\n\nfigure = plt.figure(figsize=(12,8))\nsns.heatmap(corr_Pearson,vmin=-1,vmax=+1,cmap='Blues',annot=True, \n            linewidths=1,linecolor = 'white')\nplt.title('Pearson Correlation')\nplt.show()","6f59e8f7":"df1.hist(figsize=(15,10))\nplt.show()","6fb1af47":"j = 0\nfor i in columns:\n    j = j+1\n    if(j!=len(columns)):\n        sns.lineplot(x='mark', y=i,data=df1)\n        plt.show()","eae81d55":"figure = plt.figure(figsize=(15,10))\nsns.barplot(x='sex', y='mark',data=df1)\nplt.show()","67ffbb6b":"figure = plt.figure(figsize=(15,10))\nsns.barplot(x='cp', y='mark',data=df1)\nplt.show()","3c80795e":"figure = plt.figure(figsize=(15,10))\nsns.barplot(x='fbs', y='mark',data=df1)\nplt.show()","5b082884":"figure = plt.figure(figsize=(15,10))\nsns.barplot(x='restecg', y='mark',data=df1)\nplt.show()","aae240ba":"figure = plt.figure(figsize=(15,10))\nsns.barplot(x='exang', y='mark',data=df1)\nplt.show()","9aed0ca0":"figure = plt.figure(figsize=(15,10))\nsns.barplot(x='ca', y='mark',data=df1)\nplt.show()","a0291b6f":"figure = plt.figure(figsize=(15,10))\nsns.boxplot(x='chol',y='mark',orient='h',data=df1)\nplt.show()","be15fa44":"figure = plt.figure(figsize=(15,10))\nsns.boxplot(x='rest_bps',y='mark',orient='h',data=df1)\nplt.show()","a91ef433":"figure = plt.figure(figsize=(15,10))\nsns.boxplot(x='thal',y='mark',orient='h',data=df1)\nplt.show()","f5a2eb70":"figure = plt.figure(figsize=(15,10))\nsns.boxplot(x='oldpeak',y='mark',orient='h',data=df1)\nplt.show()","95e56a3d":"data_x = df.drop(labels=['mark'], axis=1, inplace=False)\ndata_y = df['mark']\n\n\nx_train, x_test, y_train, y_test = train_test_split(data_x, data_y ,\n                                    test_size = 0.3, random_state = 44, \n                                    shuffle = True)","09348770":"Logistic_R = LogisticRegression(solver=\"liblinear\").fit(x_train,y_train)\nKNN = KNeighborsClassifier().fit(x_train,y_train)\nDecision_Tree = DecisionTreeClassifier(random_state=44).fit(x_train,\n                                                            y_train)\nmodels = [Logistic_R,KNN,Decision_Tree]","53f6afc7":"model_total = pd.DataFrame(columns=['Score','Model'])\nfor model in models:\n    pre = model.predict(x_test)\n    cvs = cross_val_score(model,x_test,y_test).mean()\n    \n    cf_matrix = confusion_matrix(y_test,pre)\n    figure = plt.figure(figsize=(15,10))\n    sns.heatmap(cf_matrix, linecolor = \"white\", linewidth = 1, \n                cmap = \"Blues\", annot = True)\n    plt.show()\n    \n    model_name = model.__class__.__name__ # tricky\n    result = pd.DataFrame([[cvs,model_name]],columns=['Score','Model'])\n    model_total = model_total.append(result)","60c29a70":"figure = plt.figure(figsize=(15,10))   \nsns.barplot(x=\"Model\",y=\"Score\",data=model_total)\nplt.ylim(0,1)\n\nbest_model = model_total.sort_values(by=['Score'],ascending=False).iloc[0,1]","3ea10f15":"![Figure 2021-04-23 204431.png](attachment:e62c7f61-2978-4732-a632-037294e91061.png)","d763b94f":"![Figure 2021-04-23 204422.png](attachment:e015e5cd-ee1e-4af9-b415-4c9c0b4f9f7d.png)","3194c699":"![Figure 2021-04-23 204548.png](attachment:5d5d2836-9014-4e18-8dbc-e0a8961f38e5.png)","29a3c8d6":"![Figure 2021-04-23 204523.png](attachment:903d2ebd-80f9-456e-8f0d-f3c6851b80e3.png)","09803796":"![Figure 2021-04-23 204533.png](attachment:814ccf5f-7f7b-465e-bedf-0c90e513c77b.png)","35b72a0d":"![Figure 2021-04-23 204528.png](attachment:4e816dca-1d90-468a-9614-b33eb623711c.png)","2f5618ee":"![Figure 2021-04-23 204526.png](attachment:94ca6b26-ea30-4a35-98b1-fe2be1e4aece.png)","9c646069":"![Figure 2021-04-23 204540.png](attachment:92e332f3-d747-45fa-823e-d3dff65624a7.png)","f7a39b32":"![Figure 2021-04-23 204535.png](attachment:2f8b0eb6-a965-4f18-bbb1-97032fa9c2f2.png)","7dc45b40":"![Figure 2021-04-23 204600.png](attachment:c9d9d658-bde0-45cc-a1c0-e7c1f0e3dca8.png)","a910dc1a":"![Figure 2021-04-23 204551.png](attachment:39eb7157-0d90-4a0a-bf06-f242292ca724.png)![Figure 2021-04-23 204554.png](attachment:aaf0d78f-cf74-4232-8fcf-25b34a719ff1.png)![Figure 2021-04-23 204558.png](attachment:b2c98f49-8002-4a39-aa31-e27356d2cc4b.png)","e4d089a5":"![Figure 2021-04-23 204537.png](attachment:5057d7f3-9ef1-41bd-b1c7-79c52510412a.png)","c1281208":"![Figure 2021-04-23 204545.png](attachment:bf1eaf32-e9d7-424d-9611-e9e638d99c1b.png)","c8a5b47e":"![Figure 2021-04-23 204520.png](attachment:e6b3ca7c-5752-4c06-808d-04b4f0b90763.png)","ebf11463":"![Figure 2021-04-23 204436.png](attachment:9eff6f2e-867a-4baa-b28a-a2b6b20a762b.png)![Figure 2021-04-23 204440.png](attachment:28076a6a-36af-450e-b660-f004fcc4c8d0.png)![Figure 2021-04-23 204446.png](attachment:2f3096ad-3c8a-4d23-b97e-3d449fb1f527.png)![Figure 2021-04-23 204449.png](attachment:67062841-78e1-405b-af4f-84c68da0a248.png)![Figure 2021-04-23 204451.png](attachment:9ab2f30d-0c87-4407-ad56-605fe8ac388a.png)![Figure 2021-04-23 204457.png](attachment:ae7f01c7-ad63-4b85-9b01-72c7d6d2cfdf.png)![Figure 2021-04-23 204500.png](attachment:4497d525-a13a-45e2-9ac4-0b5b6711d234.png)![Figure 2021-04-23 204502.png](attachment:27b9cf3b-0b1c-4268-a590-3dc336f46a31.png)![Figure 2021-04-23 204505.png](attachment:8d4ca56e-a4af-48f4-a545-822f5752e11e.png)![Figure 2021-04-23 204513.png](attachment:8e87cc25-34fb-4ea3-8ad0-dc051a8bc972.png)![Figure 2021-04-23 204517.png](attachment:c60de496-a15e-49fa-bf84-a8bb2eb29828.png)"}}