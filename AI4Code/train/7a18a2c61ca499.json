{"cell_type":{"9e34c370":"code","ada3983f":"code","295bee18":"code","e6e66263":"code","c9b6bf21":"code","864e559a":"code","a90396e1":"code","70da54d3":"code","bd9dcf4a":"code","99c3d683":"code","513d0f77":"code","98f04f05":"code","03e4d0f3":"code","2d9f801e":"markdown","22774fe3":"markdown"},"source":{"9e34c370":"!pip install git+https:\/\/github.com\/hyperopt\/hyperopt-sklearn","ada3983f":"import pandas as pd\nimport numpy as np\nimport altair as alt\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.model_selection import train_test_split\nimport xgboost as xgb\nfrom hpsklearn import HyperoptEstimator\nfrom hpsklearn import any_regressor\nfrom hpsklearn import any_preprocessing\nfrom hyperopt import tpe","295bee18":"df_sample = pd.read_csv(\"\/kaggle\/input\/tabular-playground-series-aug-2021\/sample_submission.csv\")\ndf_train = pd.read_csv(\"\/kaggle\/input\/tabular-playground-series-aug-2021\/train.csv\")\ndf_test = pd.read_csv(\"\/kaggle\/input\/tabular-playground-series-aug-2021\/test.csv\")","e6e66263":"model = HyperoptEstimator(regressor=any_regressor('reg'), preprocessing=any_preprocessing('pre'), loss_fn=mean_squared_error, algo=tpe.suggest, max_evals=100, trial_timeout=50)","c9b6bf21":"X = df_train.drop(\"loss\",axis=1)\ny = df_train[\"loss\"]","864e559a":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.6, random_state=1)","a90396e1":"model.fit(X_train, y_train)","70da54d3":"print(model.best_model())","bd9dcf4a":"model.predict(df_test)","99c3d683":"sub = df_sample.copy()","513d0f77":"sub[\"loss\"] = model.predict(df_test)","98f04f05":"df_sample","03e4d0f3":"sub.set_index(\"id\").to_csv(\"submission.csv\")","2d9f801e":"# Practice with Hyperopt-sklearn\nThis library is completely new to me.<br><br>  Resources:\n* GitHub page for [Hyperopt-sklearn](https:\/\/github.com\/hyperopt\/hyperopt-sklearn)\n* Some code copied from [HyperOpt for Automated Machine Learning With Scikit-Learn](https:\/\/machinelearningmastery.com\/hyperopt-for-automated-machine-learning-with-scikit-learn\/) at Machine Learning Mastery","22774fe3":"Sometimes the next cell raises almost instantly an AllTrialsFailed error.  It went away when I decreased the number of rows.  Not sure if that's meaningful or just a coincidence."}}