{"cell_type":{"1010875f":"code","c2de89e6":"code","0ae14df2":"code","c74f85a3":"code","7f9b2b8d":"code","e16bac27":"code","2a8393e9":"code","98d12179":"code","a397027a":"code","23081025":"code","fc9266b1":"code","448b4f73":"code","404ec782":"code","06d439a6":"code","a807d7f5":"code","0a056806":"code","08bc0897":"code","30dfdd84":"code","218b051c":"code","1d15206b":"code","28b0d0d1":"code","a6613a70":"code","8b7041b0":"code","1c6ab698":"code","b675c9fa":"code","c4cfc23d":"code","b73498f7":"code","bfdf7021":"code","33d718ae":"code","e505a609":"code","124bb91a":"code","0eb505e8":"code","3b72b8cb":"code","66d0ec60":"code","86e3809d":"code","422f874e":"code","1c0f4636":"code","7e9e0350":"code","a79a2a33":"code","4b2a10ee":"code","15a9efaa":"code","405ac544":"code","b4ebf27b":"code","a8a3868f":"code","2fede7e7":"code","9ab6fbd9":"code","397d943d":"code","27995e68":"code","68a247c5":"code","445ec337":"code","ecd5869f":"code","aea1740c":"code","469d3a8d":"code","f4b47551":"code","78fd898e":"code","d67738a3":"code","e91cb0c1":"code","cc44fb6c":"code","6b2d57d8":"code","e167d923":"code","9aa8c214":"code","c5b8afde":"code","cf60db4d":"code","dcf50c0b":"code","b8dbe298":"code","77a13986":"code","60bd08e0":"code","311ba8c5":"code","b851a0ec":"code","a7f5fba3":"code","535d6ff8":"code","6f8b4347":"code","19b8b29c":"markdown","b638680e":"markdown","c4de01b9":"markdown","ca2a2659":"markdown","d2dbf904":"markdown","aaee1325":"markdown","0e2b87f9":"markdown","31ce3334":"markdown","b1599b6e":"markdown","ac8a76f8":"markdown","5decd388":"markdown","fa59354e":"markdown","7b184002":"markdown","e550147c":"markdown","a9946358":"markdown","9e5a1e3c":"markdown","e693a7a6":"markdown","e8371085":"markdown","60b80a7f":"markdown","65e32b04":"markdown","8ac44d8e":"markdown"},"source":{"1010875f":"import unicodecsv\nimport pandas as pd\nimport numpy as np\n%matplotlib inline\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom datetime import datetime\nfrom PIL import Image\nfrom scipy.stats import ttest_ind\n\n","c2de89e6":"baltimore = pd.read_csv('..\/input\/BPD_Part_1_Victim_Based_Crime_Data.csv')","0ae14df2":"baltimore.head()","c74f85a3":"baltimore.isnull().sum()","7f9b2b8d":"baltimore['Weapon'].value_counts(dropna=False)","e16bac27":"baltimore.fillna(method='ffill', inplace=True)","2a8393e9":"baltimore['Weapon'].value_counts(dropna=True)","98d12179":"baltimore['Premise'].value_counts(dropna=False)","a397027a":"baltimore['Neighborhood'].value_counts(dropna=False)","23081025":"baltimore.fillna(method='ffill', inplace=True)","fc9266b1":"baltimore['District'].value_counts(dropna=False)","448b4f73":"baltimore.fillna(method='ffill', inplace=True)","404ec782":"baltimore['Post'].value_counts(dropna=False)","06d439a6":"baltimore.fillna(method='ffill', inplace=True)","a807d7f5":"baltimore['Inside\/Outside'].value_counts(dropna=False)","0a056806":"def change_category(InsideOutside):\n    if InsideOutside=='Inside':\n        return ('I')\n    elif InsideOutside=='Outside':\n        return ('O')\n    elif InsideOutside=='O':\n        return ('O')\n    elif InsideOutside=='I':\n        return('I')","08bc0897":"baltimore['InsideOutside'] = baltimore['Inside\/Outside'].apply(change_category)","30dfdd84":"baltimore['InsideOutside'].value_counts(dropna=False)","218b051c":"baltimore.head()","1d15206b":"baltimore['Location'].unique()","28b0d0d1":"baltimore['Description'].unique()","a6613a70":"baltimore['Weapon'].unique()","8b7041b0":"baltimore['Post'].unique()","1c6ab698":"def create_list_number_crime(name_column, list_unique):\n    # list_unique = df[name_column].unique()\n    \n    \n    i = 0\n    \n    list_number = list()\n    \n    while i < len(list_unique):\n        list_number.append(len(baltimore.loc[baltimore[name_column] == list_unique[i]]))\n        i += 1\n    \n    return list_unique, list_number","b675c9fa":"def pie_plot(list_number, list_unique):\n    plt.figure(figsize=(20,10))\n    plt.pie(list_unique, \n        labels=list_number,\n        autopct='%1.1f%%', \n        shadow=True, \n        startangle=140)\n \n    plt.axis('equal')\n    plt.show()\n    return 0","c4cfc23d":"def bar_chart(list_number, list_unique):\n    objects = list_unique\n    y_pos = np.arange(len(objects))\n    performance = list_number\n \n    plt.figure(figsize=(20,10))    \n    plt.bar(y_pos, performance, align='center', alpha=0.5)\n    plt.xticks(y_pos, objects)\n    plt.ylabel('Number') \n    plt.show()\n    \n    return 0","b73498f7":"for n in range(0, 276528):\n    x = baltimore.loc[n, 'CrimeDate']\n    baltimore.loc[n,'CrimeYear'] = int(x[6:])","bfdf7021":"crime_year = baltimore.CrimeYear.value_counts()\ncrime_yearindex = crime_year.sort_index(axis=0, ascending=True)\nprint(crime_yearindex)","33d718ae":"bar_chart(crime_yearindex,crime_year.index)","e505a609":"pie_plot(crime_yearindex.index, crime_yearindex)","124bb91a":"\n# Create a new column that has the hour at which the crime occurred\n\nfor n in range(0, 276528):\n    x = baltimore.loc[n, 'CrimeTime']\n    baltimore.loc[n,'CrimeHour'] = int(x[:2])","0eb505e8":"# There is only one occurrence of one crime at hour 24. For 24-hour format, midnight can be described as either 24:00\n# or 00:00, so we will change the observation from 24 to 0\n\nprint(baltimore[baltimore['CrimeHour'] == 24])\nbaltimore.at[239894, 'CrimeHour'] = 0\nprint(baltimore.loc[239894])","3b72b8cb":"\n\n# Incorporate the change of the observation\n\ncrime_hour = baltimore.CrimeHour.value_counts()\ncrime_hourindex = crime_hour.sort_index(axis=0, ascending=True)","66d0ec60":"# Create line plot that shows the crime occurrence by hour\n\nfig = plt.figure(figsize=(20, 20))\nf, ax = plt.subplots(1)\nxdata = crime_hourindex.index\nydata = crime_hourindex\nax.plot(xdata, ydata)\nax.set_ylim(ymin=0, ymax=17000)\nax.set_xlim(xmin=0, xmax=24)\nplt.xlabel('Hour')\nplt.ylabel('Number of Crimes')\nplt.title('Number of Crimes by Hour')\nplt.show(f)","86e3809d":"pie_plot(crime_hourindex.index, crime_hourindex)\n","422f874e":"bar_chart(crime_hourindex,crime_hourindex.index)","1c0f4636":"# Create a pivot table to identify if hours had more occurence of specific crime categories\n\nbaltimore.pivot_table(index='Description',\n               columns='CrimeHour',\n               values='CrimeTime',\n               aggfunc= 'count')","7e9e0350":"#Create a dataframe that has the number of crime occurences by district\n\ndistrictcount = baltimore.District.value_counts()\nbaltimore.District.value_counts()","a79a2a33":"#Create bar graph of number of crimes by district\n\nmy_colors = ['r', 'g', 'b', 'k', 'y', 'm', 'c']\ndistrictcount.plot(kind='bar',\n                color=my_colors,\n                title='Number of Crimes Committed by District')","4b2a10ee":"#Create a dataframe that has the occurrence of crimes by category\n\ncrimecount = baltimore.Description.value_counts()\nbaltimore.Description.value_counts()","15a9efaa":"#Create bar graph of number of crimes by category\n\nmy_colors = ['r', 'g', 'b', 'k', 'y', 'm', 'c']\ncrimecount.plot(kind='bar',\n                color=my_colors,\n                title='Crimes Committed by Category')","405ac544":"# visualization\n#map out the data and visualize where the specific crimes occur by using the Longitude and Latitude datapoints, \n#this can help visualize crime cluster locations\nfrom mpl_toolkits.basemap import Basemap\nimport folium\nfrom folium import plugins","b4ebf27b":"m = folium.Map([39.2903848, -76.6121893], zoom_start=11)\nm","a8a3868f":"baltimore[['Longitude','Latitude']].describe()","2fede7e7":"location = baltimore[['Longitude','Latitude']]\nlocation = location.dropna()\n\nlocation = location.loc[(location['Latitude']>30) & (location['Longitude'] < -60)]","9ab6fbd9":"\nx = baltimore['Longitude']\ny = baltimore['Latitude']\n\n\n\ncolors = np.random.rand(len(x))\n\nplt.figure(figsize=(20,20))\nplt.scatter(x, y,c=colors, alpha=0.5)\nplt.show()","397d943d":"x = baltimore['Longitude']\ny = baltimore['Latitude']\n\n\n# Custom the inside plot: options are: \u201cscatter\u201d | \u201creg\u201d | \u201cresid\u201d | \u201ckde\u201d | \u201chex\u201d\nsns.jointplot(x, y, kind='scatter')\nsns.jointplot(x, y, kind='hex')\nsns.jointplot(x, y, kind='kde')","27995e68":"list_column = ['description','Weapon', 'Post','District','Longitude','Latitude']","68a247c5":"list_column","445ec337":"df_model = pd.DataFrame()","ecd5869f":"list_offense_code_group = ('ROBBERY - RESIDENCE',\n                           'AUTO THEFT',\n                           'SHOOTING',\n                           'AGG. ASSAULT',\n                           'COMMON ASSAULT',\n                           'BURGLARY',\n                           'HOMICIDE',\n                           'ROBBERY - STREET',\n                           'ROBBERY - COMMERCIAL',\n                           'LARCENY',\n                           'LARCENY FROM AUTO',\n                           'ARSON',\n                          'ROBBERY - CARJACKING',\n                          'ASSAULT BY THREAT',\n                          'RAPE')","aea1740c":"i = 0\n\nwhile i < len(list_offense_code_group):\n\n    df_model = df_model.append(baltimore.loc[baltimore['Description'] == list_offense_code_group[i]])\n    \n    i+=1","469d3a8d":"def change_category_num(description):\n    if description=='ROBBERY - RESIDENCE':\n        return 1\n    elif description=='AUTO THEFT':\n        return 2\n    elif description=='SHOOTING':\n        return 3\n    elif description=='AGG. ASSAULT':\n        return 4\n    elif description=='COMMON ASSAULT':\n        return 5\n    elif description=='BURGLARY':\n        return 6\n    elif description=='HOMICIDE':\n        return 7\n    elif description=='ROBBERY - STREET':\n        return 8\n    elif description=='ROBBERY - COMMERCIAL':\n        return 9\n    elif description=='LARCENY':\n        return 10\n    elif description=='LARCENY FROM AUTO':\n        return 11\n    elif description=='ARSON':\n        return 12\n    elif description=='ROBBERY - CARJACKING':\n        return 13\n    elif description=='ASSAULT BY THREAT':\n        return 14\n    elif description=='RAPE':\n        return 15\n","f4b47551":"baltimore['description'] = baltimore['Description'].apply(change_category_num)","78fd898e":"baltimore['description'].unique()","d67738a3":"y.unique()","e91cb0c1":"# DISTRICT\n\ndf_model['District'] = df_model['District'].map({\n    'SOUTHERN':1, \n    'CENTRAL':2, \n    'NORTHERN':3, \n    'SOUTHEASTERN':4, \n    'NORTHWESTERN':5, \n    'EASTERN':6, \n    'SOUTHWESTERN':7, \n    'NORTHEASTERN':8, \n    'WESTERN':9, \n    'nan':10, \n    \n})\n\ndf_model['District'].unique()","cc44fb6c":"# Weapon\n\ndf_model['Weapon'] = df_model['Weapon'].map({\n    'KNIFE':1, \n    'nan':2, \n    'FIREARM':3, \n    'OTHER':4, \n    'HANDS':5, \n   \n})\n\ndf_model['Weapon'].unique()","6b2d57d8":"# Lat, Long\n\ndf_model[['Latitude', 'Longitude']].head()","e167d923":"# POST\n\ndf_model['Post'].unique()","9aa8c214":"df_model.fillna(0, inplace = True)","c5b8afde":"x = df_model[['Weapon', 'Post','District','Longitude','Latitude']]","cf60db4d":"baltimore['description'].unique()","dcf50c0b":"df_model = df_model[list_column]","b8dbe298":"y=df_model['description']","77a13986":"y.unique()","60bd08e0":"# Split dataframe into random train and test subsets\nfrom sklearn.cross_validation import train_test_split\nfrom sklearn.cross_validation import train_test_split\n\nX_train, X_test, Y_train, Y_test = train_test_split(\n    x,\n    y, \n    test_size = 0.1,\n    random_state=42\n)\n\nprint(X_train.shape, Y_train.shape)\nprint(X_test.shape, Y_test.shape)","311ba8c5":"from sklearn.tree import DecisionTreeClassifier\nfrom sklearn.naive_bayes import BernoulliNB\nfrom sklearn.tree import ExtraTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.discriminant_analysis import LinearDiscriminantAnalysis\nfrom sklearn.semi_supervised import LabelSpreading\nfrom sklearn.svm import LinearSVC\nfrom sklearn.neighbors.nearest_centroid import NearestCentroid\nfrom sklearn.ensemble import RandomForestClassifier\nfrom lightgbm import LGBMClassifier\nfrom sklearn.model_selection import train_test_split","b851a0ec":"from sklearn.metrics import f1_score","a7f5fba3":"def fun_results(result):\n    print('mean:' + str(result.mean()))\n    print('max: ' + str(result.max()))\n    print('min: ' + str(result.min()))\n    return result","535d6ff8":"# DecisionTreeClassifier\n\ndef fun_DecisionTreeClassifier(X_train, Y_train):\n    dec_tree = DecisionTreeClassifier()\n    dec_tree = dec_tree.fit(X_train, Y_train)\n\n    dec_tree_pred = dec_tree.predict(X_test)\n     \n    dec_tree_score = f1_score(Y_test, dec_tree_pred, average=None)\n    print(dec_tree_pred)\n    return fun_results(dec_tree_score)\n\nfun_DecisionTreeClassifier(X_train, Y_train)","6f8b4347":"# BernoulliNB\n\ndef fun_BernoulliNB(X_train, Y_train):\n    bernoulli = BernoulliNB()\n    bernoulli = bernoulli.fit(X_train, Y_train)\n\n    bernoulli_pred = bernoulli.predict(X_test)\n\n    bernoulli_score = f1_score(Y_test, bernoulli_pred, average=None)\n    print(bernoulli_pred)\n    return fun_results(bernoulli_score)\n\nfun_BernoulliNB(X_train, Y_train)","19b8b29c":"<h1>3. Analysis Questions <\/h1>\n\n\n1.What is the trend of the Baltimore Crime Data from 2012-2017?\n\n2.What is the most dangerous hour (The hour where most crimes occur)?\n\n3.Which District has the most crime?\n\n4.Which Crime Category has the most occurrences?\n\n5.Visualization : map out the data and visualize where the specific crimes occur by using the Longitude and Latitude datapoints, this can help visualize crime locations","b638680e":"The number of categories for the weapon of choice are small. There are only knife, firearm, hands, and other.","c4de01b9":"This is a dataset containing records from the new crime incident report system, which includes a reduced set of fields focused on capturing the type of incident as well as when and where it occurred. The data spans the years of 2012 - 2017.","ca2a2659":"The 'Post' column refers to the number of the nearest Baltimore Police Station where that crime was committed. In this dataset, there are 179 unique posts.","d2dbf904":"<h1> Description: <\/h1>","aaee1325":"lets take a look at the some of the sample data. We will do this by looking at the top 5 rows of data and the bottom 5 rows of data.","0e2b87f9":"Source of the dataset: https:\/\/www.kaggle.com\/sohier\/crime-in-baltimore","31ce3334":"<h1> 4. Function for visualization <\/h1>","b1599b6e":"<h3> discretization <\/h3>","ac8a76f8":"<h1> 1.Import <\/h1>","5decd388":"<h1> Nulls in the Dataset: <\/h1>","fa59354e":"<h1> 3. initial look at the Dataset <\/h1>","7b184002":"<h1> prediction algorithms <\/h1>","e550147c":"<h1> 2.Read data <\/h1>","a9946358":"The 'Description' column describes the general category of the crime.","9e5a1e3c":"<h3> Application of the algorithms <\/h3>","e693a7a6":"Unlawful activities, regardless of place and time, are disapproved in the community. This tendency of the collective conscience to disapprove of the illegal, establishes the deviant character of the act and at the same time implicitly sanctions these actions. Today, there are many cities around the world that are considered crime capitals. Among these, we can mention baltimore whose data relating to the years of 2012-2017","e8371085":"Let's take a look at the number of nulls in the dataset. The only columns that don't have nulls are 'CrimeDate', 'CrimeTime', 'CrimeCode', 'Description', and 'Total Incidents'. There are a lot of Nulls in the data. For the purpose of this Capstone, we will only focus on the analyzing the data that do not have nulls.","60b80a7f":"<h1> Cleaning Data <\/h1>","65e32b04":"The 'Location' column has the address where the crime occurred.","8ac44d8e":"<h1> Content <\/h1>"}}