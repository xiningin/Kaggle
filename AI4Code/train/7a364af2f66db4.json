{"cell_type":{"b35a0137":"code","3a74a900":"code","557c5d89":"code","b4601e25":"code","ae46b932":"code","5155d87f":"code","3015175a":"code","13d32424":"code","6a4251e0":"code","d56f9f3c":"code","a4cf9a10":"code","672215df":"code","1683f583":"code","93d595c1":"code","ddb65b41":"code","df1b7436":"code","c0485ddf":"code","9e70aa5c":"code","58319035":"code","144123a2":"code","d43ceabd":"code","c54fbd73":"code","30bb75d8":"markdown","4645e9b1":"markdown"},"source":{"b35a0137":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","3a74a900":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","557c5d89":"df = pd.read_csv('..\/input\/classified-data\/Classified Data', index_col=0)","b4601e25":"df.head()","ae46b932":"df.columns","5155d87f":"df.info()","3015175a":"from sklearn.preprocessing import StandardScaler","13d32424":"scaler = StandardScaler()\nscaler.fit(df.drop('TARGET CLASS', axis=1))\nscaled_features = scaler.transform(df.drop('TARGET CLASS', axis=1))\ndf_scaled = pd.DataFrame(scaled_features, columns=df.columns[:-1])","6a4251e0":"df_scaled.head()","d56f9f3c":"sns.pairplot(df, hue='TARGET CLASS')","a4cf9a10":"from sklearn.model_selection import train_test_split","672215df":"features_train, features_test, labels_train, labels_test = train_test_split(df_scaled,df['TARGET CLASS'],\n                                                                           test_size=0.30)","1683f583":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import accuracy_score\n\nclf = KNeighborsClassifier(n_neighbors=1)\nclf.fit(features_train, labels_train)\npred = clf.predict(features_test)","93d595c1":"print(accuracy_score(labels_test, pred))","ddb65b41":"from sklearn.metrics import classification_report, confusion_matrix\nfrom sklearn.model_selection import cross_val_score","df1b7436":"print(confusion_matrix(labels_test, pred))","c0485ddf":"print(classification_report(labels_test, pred))","9e70aa5c":"from scipy.spatial.distance import cdist","58319035":"error_rate = []\n\nfor k in range(1,80):\n    clf = KNeighborsClassifier(n_neighbors=k)\n    clf.fit(features_train, labels_train)\n    pred = clf.predict(features_test)\n    error_rate.append(np.mean(pred != labels_test))","144123a2":"plt.figure(figsize=(20,15))\nplt.plot(range(1,80), error_rate, linestyle='--', marker='D', markerfacecolor='green', markersize=10)\nplt.title('Error Rate VS K-Values')\nplt.xlabel('K')\nplt.ylabel('Error Rate')","d43ceabd":"# Now with k = 31\n\nclf = KNeighborsClassifier(n_neighbors=31)\nclf.fit(features_train, labels_train)\npred = clf.predict(features_test)\nprint(accuracy_score(labels_test, pred))","c54fbd73":"print('With K = 32')\nprint(confusion_matrix(labels_test, pred))\nprint(classification_report(labels_test, pred))","30bb75d8":"* When we use KNN, we need to set K to some value. But to what value should I set K?\n* We can know the value of K either from our domain knowledge or by doing data visualization.\n* When above methods dont work we can use **Elbow Method** to determine the value of K","4645e9b1":"Here We can clearly see that after k=30 error rate starts increasing. So suitable value of K for our task will be values near 30. for example 28,29,32,33 etc."}}