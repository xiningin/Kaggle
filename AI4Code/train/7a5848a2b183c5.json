{"cell_type":{"c1e293f7":"code","56e160f6":"code","1bfed87d":"code","cc1392c4":"code","81439815":"code","b6523087":"code","3f8d2e13":"code","46e267b1":"code","f773cbc9":"code","d8b9f607":"code","381546c2":"code","238af6c5":"code","70ac8c0c":"code","9bd877b3":"markdown","30192ce5":"markdown"},"source":{"c1e293f7":"# Loading necessary Python libraries\nimport numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt \nimport seaborn as sns","56e160f6":"# Input data files are available in the read-only \"..\/input\/\" directory\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","1bfed87d":"input_df = pd.read_csv('\/kaggle\/input\/us-accidents\/US_Accidents_Dec20_updated.csv')\ninput_df.head()","cc1392c4":"# Garry \ninput_df.columns\n# The meaning of the data can be seen in the dataset description:\n# \"https:\/\/www.kaggle.com\/sobhanmoosavi\/us-accidents\"","81439815":"# state distribution information could be used for call the map api\ninput_df.State.unique()","b6523087":"count_by_state=[]\nfor i in input_df.State.unique():\n    count_by_state.append(input_df[input_df['State']==i].count()['ID'])\n\nfig,ax = plt.subplots(figsize=(16,10))\nsns.barplot(input_df.State.unique(),count_by_state)","3f8d2e13":"#ZHAO XINJIAN\nimport folium\nfrom folium.plugins import HeatMap\nsample_df = input_df.sample(int(0.001 * len(input_df)))\nlat_lon_pairs = list(zip(list(sample_df.Start_Lat), list(sample_df.Start_Lng)))\nmap = folium.Map()\nHeatMap(lat_lon_pairs).add_to(map)","46e267b1":"map","f773cbc9":"pip install plotly-geo","d8b9f607":"#ZHAO XINJIAN\nimport plotly.figure_factory as ff\ndf_county = pd.read_csv('https:\/\/raw.githubusercontent.com\/plotly\/datasets\/master\/laucnty16.csv')\ndf_county['county_full'] = df_county['County Name\/State Abbreviation'].apply(lambda x: x.split(', ')[0])\ndf_county['county_name'] = df_county['county_full'].apply(lambda x: x.split(' County')[0])\n\ncounty_count_acc = pd.value_counts(input_df['County'])\nfips_county_df = df_county[['county_name', 'County FIPS Code', 'State FIPS Code']].merge(county_count_acc, left_on='county_name', right_index=True)\nfips_county_df['State FIPS Code'] = fips_county_df['State FIPS Code'].apply(lambda x: str(x).zfill(2))\nfips_county_df['County FIPS Code'] = fips_county_df['County FIPS Code'].apply(lambda x: str(x).zfill(3))\nfips_county_df['FIPS'] = fips_county_df['State FIPS Code'] + fips_county_df['County FIPS Code']\n\ncolorscale = [\"#f7fbff\", \"#ebf3fb\", \"#deebf7\", \"#d2e3f3\", \"#c6dbef\", \"#b3d2e9\", \"#9ecae1\",\n    \"#85bcdb\", \"#6baed6\", \"#57a0ce\", \"#4292c6\", \"#3082be\", \"#2171b5\", \"#1361a9\",\n    \"#08519c\", \"#0b4083\", \"#08306b\"\n]\nendpts = list(np.linspace(1,30000, len(colorscale) - 1))\nfips = fips_county_df['FIPS'].tolist()\nvalues = fips_county_df['County'].tolist()\n\n\nfig = ff.create_choropleth(\n    fips=fips, values=values, scope=['usa'],\n    binning_endpoints=endpts, colorscale=colorscale,\n    show_state_data=False,\n    show_hover=True,\n    asp = 2.9,\n    title_text = 'USA County accidents count',\n    legend_title = 'Accidents count'\n)\nfig.layout.template = None\nfig.show()","381546c2":"#ZHAO XINJIAN\ndf_source = input_df.groupby(['Severity']).size().reset_index().pivot(\\\n    columns='Severity', values=0)\ndf_source.plot(kind='bar', stacked=True, title='Severity Count by Sources')","238af6c5":"#ZHAO XINJIAN\ndf_4 = input_df[input_df['Severity']==4]\n\nplt.figure(figsize=(15,10))\n\nplt.plot( 'Start_Lng', 'Start_Lat', data=df_4, linestyle='', marker='o', markersize=3, color=\"teal\", alpha=0.5, label='Accidents with Serverity Level 4')\nplt.plot( 'Start_Lng', 'Start_Lat', data=input_df, linestyle='', marker='o', markersize=1.5, color=\"coral\", alpha=0.2, label='All Accidents')\n\nplt.legend(markerscale=8)\nplt.xlabel('Longitude', size=12, labelpad=3)\nplt.ylabel('Latitude', size=12, labelpad=3)\nplt.title('Map of Accidents', size=16, y=1.05)\nplt.show()","70ac8c0c":"#ZHAO XINJIAN\nimport datetime\ninput_df['Start_Time']= pd.to_datetime(input_df['Start_Time'])\ninput_df['day']= input_df['Start_Time'].dt.day_name()\ninput_df.groupby(['day']).size().plot.pie(figsize=(10,10))","9bd877b3":"First, search the us-accidents dataset on the right \"+ Add data\" button. \n\nThe dataset lies in the \"\/kaggle\/input\" directory and our notebook is under the \"\/kaggle\/working\" directory.","30192ce5":"The updated database has 1516064 rows and 47 attributes now.\n\nMark it because I deleted the \"input.shape\" block."}}