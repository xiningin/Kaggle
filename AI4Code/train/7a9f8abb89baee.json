{"cell_type":{"32c56c0b":"code","1edcf59c":"code","093c58c1":"code","de1fc507":"code","291db3fe":"code","e0e3d269":"code","9353c721":"code","0bc713cb":"code","f9c3ff04":"code","bfaa4061":"code","03db9558":"code","3fb1b77f":"code","dcb6e883":"code","bfbd688f":"code","5219d871":"code","55cd184a":"code","85869da1":"code","bd752171":"code","1924b7bc":"code","0ba6e2ba":"code","8e3ac851":"code","6bab617d":"code","55ed6a91":"code","07568b82":"code","c0367ddb":"code","5d4e56d2":"code","cd649368":"code","aacda3da":"code","9a792643":"code","65ce95dd":"code","fbb46c46":"code","a45482ca":"code","78767055":"code","ccef2733":"code","683c4c41":"markdown","72f3be89":"markdown","198c60a0":"markdown","61d80368":"markdown","8530d754":"markdown","55d5b826":"markdown","52bb8aa0":"markdown","a5623d7c":"markdown","369c440f":"markdown"},"source":{"32c56c0b":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split , RandomizedSearchCV\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score","1edcf59c":"train_data=pd.read_csv(\"..\/input\/titanic\/train.csv\")\nteset_data=pd.read_csv(\"..\/input\/titanic\/test.csv\")","093c58c1":"train_data.head()","de1fc507":"train_data.info()","291db3fe":"train_data.describe()","e0e3d269":"sns.pairplot(train_data.drop(columns=[\"PassengerId\",\"Name\"]),hue=\"Survived\",diag_kind=\"hist\",dropna=True)","9353c721":"sns.barplot(x=\"Embarked\",y=\"Survived\",data=train_data)","0bc713cb":"sns.countplot(x=\"Cabin\",data=train_data)","f9c3ff04":"sns.barplot(x=\"Sex\",y=\"Survived\",data=train_data)","bfaa4061":"train_data.isnull().sum()","03db9558":"train_data.drop(columns=[\"PassengerId\",\"Name\",\"Cabin\",\"Ticket\"],inplace=True)","3fb1b77f":"train_data[\"Age\"].hist()","dcb6e883":"median=train_data[\"Age\"].median()\ntrain_data.fillna(median,inplace=True)","bfbd688f":"train_data.isnull().sum()","5219d871":"train_data[\"Age\"]=(np.sort(np.round(train_data[\"Age\"]))).astype(int)","55cd184a":"train_data.duplicated().sum()","85869da1":"train_data.drop_duplicates(inplace=True)","bd752171":"train_data.duplicated().sum()","1924b7bc":"# sex\ntrain_data[\"Sex\"]=train_data[\"Sex\"].replace(to_replace=[\"male\",\"female\"],value=[0,1])","0ba6e2ba":"train_data=pd.get_dummies(train_data,drop_first=True,dtype=np.int64)\ntrain_data.drop(columns=[\"Embarked_C\"],inplace=True)","8e3ac851":"X=train_data.drop(columns=[\"Survived\"])\nY=train_data[\"Survived\"]","6bab617d":"X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.2, random_state=42)","55ed6a91":"# Setup the hyperparameter grid\nparameters = {\"max_depth\": np.array([3,4,5,6,7, None]),\n              \"max_features\": np.arange(1,9,1),\n              \"min_samples_leaf\": np.arange(1,9,1),\n              \"n_estimators\":np.arange(100,300,30),\n              \"criterion\": [\"gini\", \"entropy\"]}\n\nRF_classifier=RandomForestClassifier()\nRF_grid=RandomizedSearchCV(RF_classifier,parameters,cv=5)\nRF_grid.fit(X_train,y_train)","07568b82":"print(\"Tuned Decision Tree Parameters: {}\".format(RF_grid.best_params_))\nprint(\"Best score is {}\".format(RF_grid.best_score_))","c0367ddb":"print(\"Training Accuracy : \",accuracy_score(y_train,RF_grid.predict(X_train)))","5d4e56d2":"print(\"Evaluation Accuracy : \",accuracy_score(y_test,RF_grid.predict(X_test)))","cd649368":"test_data=pd.read_csv(\"..\/input\/titanic\/test.csv\")","aacda3da":"# null values\ntest_data.drop(columns=[\"Name\",\"Ticket\",\"Cabin\"],inplace=True)\nmedian=test_data[\"Age\"].median()\ntest_data.fillna(median,inplace=True)","9a792643":"# data types\ntest_data[\"Age\"]=(np.sort(np.round(test_data[\"Age\"]))).astype(int)","65ce95dd":"# dupicates\ntest_data.duplicated().sum()","fbb46c46":"# categorical data\ntest_data[\"Sex\"]=test_data[\"Sex\"].replace(to_replace=[\"male\",\"female\"],value=[0,1])\ntest_data=pd.get_dummies(test_data,drop_first=True,dtype=np.int64)","a45482ca":"test_data.head()","78767055":"y_predict =RF_grid.predict(test_data.drop(columns=[\"PassengerId\"]))\ntest_data[\"Survived\"] = y_predict","ccef2733":"test_data[['PassengerId', 'Survived']].to_csv('\/kaggle\/working\/submission.csv', index=False)","683c4c41":"### null values","72f3be89":"# 2-Explore data","198c60a0":"# 4-train model ","61d80368":"# 3-split data","8530d754":"### categorical data","55d5b826":"### data types","52bb8aa0":"# 1-read data","a5623d7c":"### duplicates","369c440f":"# summition"}}