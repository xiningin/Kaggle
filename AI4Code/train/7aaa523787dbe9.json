{"cell_type":{"561ba560":"code","dcf66554":"code","1223f878":"code","dc2ea0c0":"code","1d5cc90a":"code","5d4d1bbc":"code","d855c924":"code","c1a46f6e":"code","a71addc1":"code","003ae413":"code","f51e1ade":"code","ca2ea7c6":"code","6830492e":"code","5067d015":"code","df96ae84":"code","508a687f":"code","96690a8a":"code","29737a15":"code","6c6b95e6":"markdown","34c3783a":"markdown"},"source":{"561ba560":"\nimport pandas as pd \nfrom sklearn.model_selection import train_test_split, GridSearchCV,cross_val_score\nfrom sklearn.metrics import mean_squared_error, r2_score","dcf66554":"hit = pd.read_csv(\"..\/input\/hittlers\/Hitters.csv\")\ndf = hit.copy()\ndf = df.dropna()\ndms = pd.get_dummies(df[['League', 'Division', 'NewLeague']])\ny = df[\"Salary\"]\nX_ = df.drop(['Salary', 'League', 'Division', 'NewLeague'], axis=1).astype('float64')\nX = pd.concat([X_, dms[['League_N', 'Division_W', 'NewLeague_N']]], axis=1)\nX_train, X_test, y_train, y_test = train_test_split(X, y, \n                                                    test_size=0.25, \n                                                    random_state=42)\n\n","1223f878":"from sklearn.ensemble import BaggingRegressor\n\nbag_model=BaggingRegressor(bootstrap_features=True)\nbag_model.fit(X_train,y_train)","dc2ea0c0":"bag_model.n_estimators","1d5cc90a":"bag_model.estimators_   #different trees","5d4d1bbc":"bag_model.estimators_samples_","d855c924":"bag_model.estimators_features_","c1a46f6e":"bag_model.estimators_[0]","a71addc1":"import numpy as np\ny_pred=bag_model.predict(X_test)","003ae413":"np.sqrt(mean_squared_error(y_test,y_pred))","f51e1ade":"bag_params={\"n_estimators\": range(2,20)}","ca2ea7c6":"bag_cv_model= GridSearchCV(bag_model, bag_params,cv=10)","6830492e":"bag_cv_model.fit(X_train,y_train)","5067d015":"bag_cv_model.best_params_","df96ae84":"bag_tuned=BaggingRegressor(n_estimators= 12,random_state=45)","508a687f":"bag_tuned.fit(X_train,y_train)","96690a8a":"y_pred=bag_tuned.predict(X_test)\nnp.sqrt(mean_squared_error(y_pred,y_test))","29737a15":"# We found 413 for KNN, \n#          367 for SVR,\n#          363 for Artifical Neural Network.\n#          376 for CART\n#And now,  349 for Bagged Trees\n\n#In these models(KNN-SVR-ANN-CART-Bagged Trees), the best one is Bagged Trees model for \"hitters\" data set, till now.","6c6b95e6":"# Prediction","34c3783a":"# Model Tuning"}}