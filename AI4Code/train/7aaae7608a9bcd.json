{"cell_type":{"d946e3d1":"code","522fcbbe":"code","759f8d4b":"code","d1aaecd2":"code","b048c733":"code","5edd56dd":"code","0e0b322b":"code","b93e9623":"code","15a0d786":"code","d1447643":"code","4e927d43":"code","76f048cf":"code","3ef903f6":"code","cdd53c68":"markdown","fde652e2":"markdown","4e99566a":"markdown"},"source":{"d946e3d1":"!pip install -q easyocr","522fcbbe":"import os\n\nimport numpy as np\nimport pandas as pd\nfrom glob import glob\nfrom time import time\nfrom tqdm.auto import tqdm \n\nfrom PIL import Image\n\nimport easyocr\nimport Levenshtein","759f8d4b":"ROOT_DIR = \"..\/input\/mlub-mongolian-car-plate-prediction\"","d1aaecd2":"df_train = pd.read_csv(os.path.join(ROOT_DIR, \"training.csv\"))\ndf_subm  = pd.read_csv(os.path.join(ROOT_DIR, \"submission.csv\"))\nprint(df_train.shape, df_subm.shape)","b048c733":"df_train.sample(5)","5edd56dd":"%%time\nreader = easyocr.Reader(['mn'])","0e0b322b":"image_path = f\"{ROOT_DIR}\/training\/training\/0002.png\"\nImage.open(image_path)","b93e9623":"# %%time\nresult = reader.readtext(image_path, detail=0)\nresult = \"\".join(result)[:7]\nresult","15a0d786":"# %%time\np1 = '5791\u0423\u0411\u0412'\np2 = '5793882'\n\nprint(f\"{p1}&{p2} => levenstein {Levenshtein.distance(p1, p2)}\")","d1447643":"test_paths = sorted(glob(os.path.join(ROOT_DIR, \"test\/test\/*\")))\nlen(test_paths)","4e927d43":"ids     = []\ny_preds = []\n\nfor tp in tqdm(test_paths):\n    result = reader.readtext(tp, detail=0)\n    result = \"\".join([a.strip() for a in result])[:7]\n    \n    ids.append(tp.split(\"\/\")[-1].split(\".\")[0])\n    y_preds.append(result)","76f048cf":"df_subm[\"plate_number\"] = y_preds","3ef903f6":"df_subm.to_csv(\"submission.csv\", index=False)","cdd53c68":"# Baseline: EasyOCR\n\n\u042d\u043d\u044d\u0445\u04af\u04af \u0442\u044d\u043c\u0446\u044d\u044d\u043d \u043d\u044c \u043e\u0434\u043e\u043e\u0433\u043e\u043e\u0440 \u0431\u044d\u043b\u044d\u043d \u0431\u0430\u0439\u0433\u0430\u0430 \u0441\u0430\u043d\u0433\u0443\u0443\u0434\u044b\u0433 \u0442\u0443\u0440\u0448\u0438\u0445 \u0441\u0430\u0439\u0445\u0430\u043d \u0431\u043e\u043b\u043e\u043c\u0436 \u0433\u044d\u0436 \u0431\u043e\u0434\u043e\u0436 \u0431\u0430\u0439\u0433\u0430\u0430 \u0442\u0443\u043b \u044d\u043d\u044d\u0445\u04af\u04af notebook-\u0438\u0439\u0433 \u0445\u0438\u0439\u0436 \u0431\u0430\u0439\u043d\u0430.\n\n[link to EasyOCR](https:\/\/github.com\/JaidedAI\/EasyOCR) ","fde652e2":"### Data Load","4e99566a":"### Submit \u0445\u0438\u0439\u0445 \u043d\u044c:"}}