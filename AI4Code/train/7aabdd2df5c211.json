{"cell_type":{"790f24c2":"code","edff74be":"code","ee008e6b":"code","92ccc2bd":"code","ad500604":"code","9cc993ee":"code","bbb648e0":"code","fd179807":"code","04193560":"code","81e1473b":"code","10ebb00d":"code","eab15e94":"code","2ac1016c":"code","01dbf5ae":"code","9d247cc2":"code","90e44158":"code","44509b4f":"code","d30b1d65":"code","67d34ba2":"code","3cdb7468":"markdown","84a53199":"markdown","e4453b52":"markdown","55f9c1a6":"markdown","9fc47dfd":"markdown","91d5e74c":"markdown","3b325d0a":"markdown","6ff10cf0":"markdown","83e7168c":"markdown","df8ea0d4":"markdown","6a832d96":"markdown","30a2d993":"markdown","54aba21d":"markdown","197ba62e":"markdown","963a3154":"markdown"},"source":{"790f24c2":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nimport seaborn as sns\nimport matplotlib as plt\nimport matplotlib.patches as mpatches\n%matplotlib inline\nfrom datetime import datetime, timedelta\nimport warnings\nfrom matplotlib import pyplot\nwarnings.filterwarnings(\"ignore\")\n# print(os.listdir(\"..\/input\"))","edff74be":"# Loading the email data and establishing some basic information\nquestions = pd.read_csv('..\/input\/questions.csv', parse_dates=['questions_date_added'])\nanswers = pd.read_csv('..\/input\/answers.csv', parse_dates=['answers_date_added'])\nmin_q_date = min(questions['questions_date_added'])\nmax_q_date = max(questions['questions_date_added'])\nmin_a_date = min(answers['answers_date_added'])\nmax_a_date = max(answers['answers_date_added'])\nprint('{:,} questions were added between {} and {}'.format(questions.shape[0], min_q_date.strftime('%Y-%m-%d'), max_q_date.strftime('%Y-%m-%d')))\nprint('and')\nprint('{:,} answers were added between {} and {}'.format(answers.shape[0], min_a_date.strftime('%Y-%m-%d'), max_a_date.strftime('%Y-%m-%d')))","ee008e6b":"# Count of answers\ntemp = answers.groupby('answers_question_id').size()\nquestions['questions_answers_count'] = pd.merge(questions, pd.DataFrame(temp.rename('count')), left_on='questions_id', right_index=True, how='left')['count'].fillna(0).astype(int)\n# First answer for questions\nfirstansw = answers[['answers_question_id', 'answers_date_added']].groupby('answers_question_id').min()\nquest = questions.copy()\nquest['questions_first_answers'] = pd.merge(quest, pd.DataFrame(firstansw), left_on='questions_id', right_index=True, how='left', indicator=True)['answers_date_added']\n# Last answer for questions\nlastansw = answers[['answers_question_id', 'answers_date_added']].groupby('answers_question_id').max()\nquest['questions_last_answers'] = pd.merge(quest, pd.DataFrame(lastansw), left_on='questions_id', right_index=True, how='left')['answers_date_added']\n# Days required to answer the question\nansw = answers.copy()\ntemp = pd.merge(quest, answers, left_on='questions_id', right_on='answers_question_id')\nanswers['time_delta_answer'] = (temp['answers_date_added'] - temp['questions_date_added'])\n# Days until first answer\nquest['time_until_1stanswer'] = (quest['questions_first_answers'] - quest['questions_date_added']).dt.days\nax_data = pd.DataFrame(quest['time_until_1stanswer'])\ntempZ = quest['time_until_1stanswer'].dropna()\ntempZ = tempZ.astype('int')\nax = sns.distplot(tempZ, kde=False, color=\"orange\")\nax.set(xlabel='Time until 1st Answer (in days)')\n#ax_data = (quest['questions_first_answers'] - quest['questions_date_added']).dt.days.rename('')\nax = ax_data.plot(kind='box', showfliers=False, grid=True, vert=False, figsize=(18, 5))\nax.set(xlabel='Time in Days', ylabel='', title='Days until FIRST Answer is Posted')\nprint(ax_data.describe())","92ccc2bd":"temp5 = quest['questions_answers_count'].dropna()\ntemp5 = temp5.astype('int')\nsns.set(style=\"white\", palette=\"bright\", color_codes=True)\n# Set up the matplotlib figure\nsns.despine(left=True)\n# Setting axis and figure size\nsns.set(rc={'figure.figsize':(10,5)})\n# Plot a simple histogram with binsize determined automatically\nax = sns.distplot(temp5, kde=False, color=\"orange\")\nax.set(xlabel='Number of Answers')","ad500604":"ax = temp5.plot(kind='box', showfliers=False, grid=True, vert=False, figsize=(18, 5))\nax.set(xlabel='Number of Answers', ylabel='', title='Number of Answers')\nprint(temp5.describe())","9cc993ee":"morethan10 = len(quest.loc[quest['questions_answers_count']>10])\nprint('There are {:,} instances of more than 10 answers.'.format(morethan10,))","bbb648e0":"tag_questions = pd.read_csv('..\/input\/tag_questions.csv')\ntags = pd.read_csv('..\/input\/tags.csv')\nq_t = questions.merge(right=tag_questions, how='left', left_on='questions_id', right_on='tag_questions_question_id')\nq_tag = q_t.merge(right=tags, how='left', left_on='tag_questions_tag_id', right_on='tags_tag_id')\nq_a_tag = q_tag.merge(right=answers, how='left', left_on='questions_id', right_on='answers_question_id')\ntagnames = q_tag['tags_tag_name'].nunique()\nnotag = q_tag['questions_id'][q_tag['tags_tag_name'].isnull()]\nprint('Across the {:,} questions {} unique tags were used; {} questions had no tag'.format(questions.shape[0], tagnames, len(notag)))","fd179807":"# Distribution of tags \nq_tag.groupby(['questions_id'])['tags_tag_name'].nunique().describe()","04193560":"sns.set(style='whitegrid', palette='bright', color_codes=True)\n# Draw a violinplot of the number of tags per question\n# sns.swarmplot(x=q_tag.groupby(['questions_id'])['tags_tag_name'].nunique(),data=q_tag)\nax = sns.distplot(q_tag.groupby(['questions_id'])['tags_tag_name'].nunique(), hist=True, kde=False, rug=True, bins=40)\nax.set(xlabel='Number of Unique Tags', ylabel='Number of Questions', title='Distribution of Unique Tags')\nsns.despine(left=True)","81e1473b":"# Adding count of tags to the questions dataframe\ntagcount = tag_questions.groupby('tag_questions_question_id').size()\nquest['questions_tag_count'] = pd.merge(quest, pd.DataFrame(tagcount.rename('tagcount')), left_on='questions_id', right_index=True, how='left')['tagcount'].fillna(0).astype(int)\nax = quest['questions_tag_count'].plot(kind='box', showfliers=False, grid=True, vert=False, figsize=(18, 5))\nax.set(xlabel='Number of Tags', ylabel='', title='Number of Tags')","10ebb00d":"#answers['time_delta_answer']\ntemp1 = quest.loc[:, ['questions_id', 'questions_tag_count', 'questions_answers_count']]\ntemp1['questions_id']=temp1['questions_id'].astype(str)\ntemp2 = answers.loc[:, ['answers_question_id', 'time_delta_answer']]\ntemp2['answers_question_id']=temp2['answers_question_id'].astype(str)\ntemp3 = pd.merge(temp1, temp2, left_on='questions_id', right_on='answers_question_id', how='left')\ntemp3.drop('answers_question_id', axis=1, inplace=True)\ntemp3['Response Time (days)'] = temp3['time_delta_answer']\/ timedelta (days=1)\n#temp3['time_delta_answer']=temp3['time_delta_answer'].total_seconds() \/ timedelta (days=1).total_seconds()\nax = sns.regplot(x=temp3['questions_tag_count'], y=temp3['Response Time (days)'])\nax.set(xlabel='Number of Unique Tags', ylabel='Response Time in Days', title='Questions - Number of tags versus response time')","eab15e94":"ax = sns.regplot(x=temp3['questions_tag_count'], y=temp3['questions_answers_count'])\nax.set(xlabel='Count of Unique Tags', ylabel='Number of Answers', title='Questions - Number of tags versus number of answers')","2ac1016c":"# Exploring the variety of tags for the question with the most tags\ntenlargest = q_tag.groupby(['questions_id'])['tags_tag_name'].nunique().nlargest(20)\ntwenlargest_1 = tenlargest.index\nfor i in twenlargest_1:\n    print(q_tag[['questions_title', 'questions_date_added']][q_tag['questions_id'] == i].iloc[1,0])","01dbf5ae":"np.count_nonzero(quest['time_until_1stanswer'].isnull()) ","9d247cc2":"quest.loc[quest['time_until_1stanswer'].isnull()].head(5)","90e44158":"answers.loc[answers['answers_question_id']=='dab7b240dc394d30a54dd0c5862d5fe3']","44509b4f":"tempx = quest.copy()\ntempx['ResponseTime'] = (tempx['questions_first_answers'] - tempx['questions_date_added']).dt.days\ntempx.loc[tempx['ResponseTime']<0].head(3) ","d30b1d65":"questions.loc[questions['questions_id']=='2984024edb7f4661bc23b11897dd1a0e']","67d34ba2":"answers.loc[answers['answers_question_id']=='2984024edb7f4661bc23b11897dd1a0e']","3cdb7468":"Next we pull up the observation from the questions dataset and review the time stamp of when the question was logged: '2016-05-24 23:50:39'","84a53199":"**Section 5:** Next we will explore a sample of 10 of the **questions with the highest number of tags** to get a better sense of this subset. These appear to be fairly broad\/general questions. ","e4453b52":"Let's first establish **how many questions and answers** the dataset contains and the timeframe those were submitted:","55f9c1a6":"**SECTION 2**: Next, we'll look at the **distribution of answers** overall. A few observations based on the raw data:\n* the minimum is 0 which indicates that a few questions did not receive answers\n* the median is 3 while the mean is 3.60; there are 129 observations with more than 10 answers","9fc47dfd":"Now, plotting the **number of tags** and the **number of answers per question** to visually inspect if there may be any relationship between the two...no clear relationship either based.","91d5e74c":"**Appendix A**\n\nLet's check how many missing values for the time until 1st answer and investigate the cause of the missing values","3b325d0a":"Let's review the first five with missing values and take the first question ID in that group and look it up in the original answer file --> we see that there is no answer in the answer file for this question ID ( the slice for that question ID returns a table without entries)","6ff10cf0":"Let's take a look at some key statistics for the distribution of the **number of tags per question** below ","83e7168c":"**Appendix B**\n\nInvestigating instances where the time stamp for the answer is prior to the time stamp of the question: first we take a look at some of the observations where the response time is below zero and then we take a look at the entries in the original files for one of the observations (i.e. '6deb0744cdb54e5286acf13251955e5e') .\n","df8ea0d4":"**SECTION 3**: Now we take a look at the **distribution of tags** amongst the questions:","6a832d96":"This notebook documents an initial EDA for questions, their answers and the tags associated with questions.\nSome key observations about the dataset:\n* **Total questions**: 23,931 (891 did not receive an answer)\n* **Total answers**: 51,123 answers\n* **Timeframe**: 2016 - 2019\n* **Unique question tags**: 7091 ","30a2d993":"Most questions have 4 or fewer tags associated with them; however there are some questions with a higher number of tags (up to 54 tags). The next plots illustrate the frequency distribution and a boxplot. ","54aba21d":"When we look at this answer ID ('2984024edb7f4661bc23b11897dd1a0e') in the answer file, we can see that one of the answers was logged at '2016-05-24 23:47:09' (see third row in the table), which is 3.5 minutes before the question was posed according to the questions file (i.e. '2016-05-24 23:50:39'). This seems to be data issue.","197ba62e":"**SECTION 4**: Now we'll take a look whether there are any potential bivariate relationships between the variables we reviewed so far. First we plot the **number of tags** the **response time** to visually inspect if there may be any relationship between the two...it appears not.","963a3154":"**SECTION 1**: First let's take a look at **how long it takes to get an answer** (i.e. when is the first answer to a question posted) to a question is posted. A few observations based on the raw data:\n* the minimum is -1 day which is non-sensical and likely indicates a data issue (as is documented in Appendix B below)\n* a quarter of questions received an answer within the same day (time in days = 0)\n* the mean response time (~ 65 days) is far greater than the median (~ 2 days)\n\n(Note: the count of questions below is 23,110 which is 821 below the count of questions per the above (23,931); this is due to questions with missing answers as illustrated in Appendix A below)"}}