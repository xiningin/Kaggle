{"cell_type":{"1bac7c7b":"code","65a99755":"code","3cc4b96b":"code","d38da437":"code","b4cf2f81":"code","aff175dd":"code","5eede203":"code","2d61f50a":"code","157da08c":"code","381c9aad":"code","271029ca":"code","260fa381":"code","b0d768e8":"code","f8b99372":"code","dfe3ed75":"code","99224b8d":"code","0e63fe22":"markdown","fc1d7c92":"markdown","1c4c2543":"markdown","e249a0dc":"markdown","a56ad388":"markdown","2cc4d690":"markdown","aa41c052":"markdown","5d6fc1ac":"markdown","d6785c21":"markdown","eb38ac68":"markdown"},"source":{"1bac7c7b":"from tensorflow import keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense,Convolution2D,MaxPooling2D,Flatten,Conv2D,Dropout\nfrom keras.preprocessing.image import ImageDataGenerator\nimport pandas as pd\nimport numpy as np\nimport os\nimport matplotlib.pyplot as plt\nfrom PIL import Image\nimport tensorflow as tf\nimport matplotlib.pyplot as plt","65a99755":"# Let's have a look at the data\n\nim=Image.open('..\/input\/intel-image-classification\/seg_train\/seg_train\/buildings\/10032.jpg')\nim","3cc4b96b":"# Let's have a look at another image\n\nim2=Image.open('..\/input\/intel-image-classification\/seg_train\/seg_train\/glacier\/10003.jpg')\nim2","d38da437":"# Creating the model\n\nmodel=Sequential()\nmodel.add(Convolution2D(32,(3,3),input_shape=(64,64,3),activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2,2)))\nmodel.add(Flatten())\nmodel.add(Dense(3000,activation='relu'))\nmodel.add(Dense(units=6,activation='softmax'))\n","b4cf2f81":"model.summary()","aff175dd":"tf.keras.utils.plot_model(\n    model,\n    to_file=\"model.png\",\n    show_shapes=False,\n    show_layer_names=True,\n    rankdir=\"TB\",\n    expand_nested=False)","5eede203":"model.compile(optimizer= 'adam', loss= 'categorical_crossentropy', metrics= ['accuracy'])\n","2d61f50a":"\ntrain_datagen = ImageDataGenerator(rescale = 1.\/255, \n                                   shear_range = 0.2, \n                                   zoom_range = 0.2, \n                                   horizontal_flip = True)\n\ntest_datagen = ImageDataGenerator(rescale = 1.\/255)\n\ntraining_set = train_datagen.flow_from_directory('..\/input\/intel-image-classification\/seg_train\/seg_train', \n                                                    target_size = (64, 64), \n                                                    batch_size = 32)\ntest_set = test_datagen.flow_from_directory('..\/input\/intel-image-classification\/seg_test\/seg_test',\n                                                target_size = (64, 64),\n                                                 batch_size = 32)\n\n","157da08c":"len(set(training_set.classes))","381c9aad":"fitted_model = model.fit_generator(training_set,\n                        steps_per_epoch = 100,\n                        epochs = 20,\n                        validation_data = test_set,\n                        validation_steps = 100)","271029ca":"plt.plot([i for i in range(20)],fitted_model.history['accuracy'])\nplt.plot([i for i in range(20)],fitted_model.history['loss'])","260fa381":"def image_prediction(path):\n    imm=Image.open(path)\n    imm=imm.resize((64,64))\n    x=np.array(imm)\n    x=np.expand_dims(x,axis=0)\n    classs=model.predict_classes(x)\n    l=os.listdir('..\/input\/intel-image-classification\/seg_train\/seg_train')\n    l.sort()\n    return l[classs[0]]","b0d768e8":"imagee=Image.open('..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10004.jpg')\nimagee","f8b99372":"# Let's make prediction for the above image\nimage_prediction('..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10004.jpg')","dfe3ed75":"# Let's see another one :)\nImage.open('..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10048.jpg')","99224b8d":"image_prediction('..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10048.jpg')","0e63fe22":"# Having a look at the data","fc1d7c92":"# Using Keras On Intel Data\n![](https:\/\/keras.io\/img\/logo.png)","1c4c2543":"# Compiling the model","e249a0dc":"# Hope you liked the file :)\n![](https:\/\/i.pinimg.com\/originals\/8c\/40\/05\/8c4005377742272315e792545a9c93df.gif)","a56ad388":"# Wow its working awesome :)","2cc4d690":"# Making the Image Data to load in the model","aa41c052":"# Fitting and training the data to the model","5d6fc1ac":"# Importing the required packages","d6785c21":"# Creating a simple model","eb38ac68":"# Plotting the results"}}