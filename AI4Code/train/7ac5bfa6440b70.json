{"cell_type":{"3f1b4450":"code","828912d2":"code","fd649c81":"code","d1f6aec9":"code","aa8b2295":"code","1a0773af":"code","60885305":"code","898d08b8":"code","358db513":"code","1af6a0b5":"code","4251101f":"code","2d35e61e":"code","462bc21f":"code","2441bc83":"code","97af53ca":"code","cb83332c":"code","3fee7036":"code","10cd8099":"code","81c03a0f":"code","f217648c":"code","6b36318d":"code","f05ca265":"code","7aeca403":"markdown","8c304751":"markdown","c6e01ffe":"markdown","91379ab1":"markdown","5e0f7cfa":"markdown","15c94265":"markdown","38ea796f":"markdown","181746ba":"markdown","b4ade4ec":"markdown","9c16ef3d":"markdown","bfae38b4":"markdown","18e584e8":"markdown","5f52031b":"markdown","08aa365d":"markdown","dc040c6a":"markdown","49953c73":"markdown","f36aa9c1":"markdown","2d9c614e":"markdown","ccd3fb6e":"markdown","a9c16407":"markdown","8b7df804":"markdown","39072cb2":"markdown","377c07a5":"markdown"},"source":{"3f1b4450":"import numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\n\nimport warnings\nwarnings.filterwarnings(\"ignore\") \n\n%matplotlib inline","828912d2":"# Read Dataset\ndata = pd.read_csv('..\/input\/pima-indians-diabetes-database\/diabetes.csv')\ndata.sample(n = 10, random_state = 0)","fd649c81":"data.info(verbose = True)","d1f6aec9":"data.describe().transpose()","aa8b2295":"import seaborn as sns\nsns.pairplot(data, hue = 'Outcome', diag_kind='kde')\nplt.show()","1a0773af":"data_copy = data.copy(deep = True)\ndata_copy.loc[:, ['Glucose', 'BloodPressure', 'SkinThickness', 'Insulin', 'BMI']] = data_copy.loc[:, ['Glucose', 'BloodPressure', 'SkinThickness', 'Insulin', 'BMI']].replace(0, np.NaN)","60885305":"data_copy.isnull().sum()\nimport missingno as msno\nmsno.matrix(data_copy, figsize = (20, 10), labels = True, color = (0.502, 0.0, 0.0)) \nplt.show()","898d08b8":"import plotly.graph_objects as go\ncolumn_names = data_copy.columns\nno_of_boxes = len(column_names)\ncolors = [ 'hsl(' + str(h) + ',50%' + ',50%)' for h in np.linspace(0, 360, no_of_boxes)]\n\nfig = go.Figure(data = [go.Box(y = data_copy.loc[:, column_names[i]], marker_color = colors[i], name = column_names[i], boxmean = True, showlegend = True) for i in range(no_of_boxes)])\n\nfig.update_layout(\n    xaxis=dict(showgrid = True, zeroline = True, showticklabels = True),\n    yaxis=dict(zeroline = True, gridcolor = 'white'),\n    paper_bgcolor = 'rgb(233,233,233)',\n    plot_bgcolor = 'rgb(233,233,233)')\n\nfig.show()","358db513":"from sklearn.impute import SimpleImputer\nimputer_mean = SimpleImputer(missing_values = np.NaN, strategy = 'mean')\nimputer_median = SimpleImputer(missing_values = np.NaN, strategy = 'median')\n\nglucose_fit = imputer_mean.fit(data_copy[['Glucose']])\ndata_copy[['Glucose']] = glucose_fit.transform(data_copy[['Glucose']])\n\nbp_fit = imputer_median.fit(data_copy[['BloodPressure']])\ndata_copy[['BloodPressure']] = bp_fit.transform(data_copy[['BloodPressure']])\n\nbp_fit = imputer_median.fit(data_copy[['SkinThickness']])\ndata_copy[['SkinThickness']] = bp_fit.transform(data_copy[['SkinThickness']])\n\nbp_fit = imputer_median.fit(data_copy[['Insulin']])\ndata_copy[['Insulin']] = bp_fit.transform(data_copy[['Insulin']])\n\nbp_fit = imputer_median.fit(data_copy[['BMI']])\ndata_copy[['BMI']] = bp_fit.transform(data_copy[['BMI']])","1af6a0b5":"plt.figure(figsize = (14, 10))\nsns.heatmap(data_copy.corr(), annot = True, cmap = 'Blues', linecolor = 'tab:cyan', linewidths = 2)\nplt.title(\"Clean dataset\")\nplt.show()","4251101f":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\ndata_scaled = pd.DataFrame(scaler.fit_transform(data_copy.drop(labels = ['Outcome'], axis = 1)), columns = column_names[:-1])\ndata_scaled.sample(n = 10)","2d35e61e":"count_0 = data_copy[data_copy[['Outcome']] == 0]['Outcome']\ncount_1 = data_copy[data_copy[['Outcome']] == 1]['Outcome']\n\ntrace1 = go.Histogram(x = count_0, name = 'Non-Diabetic')\ntrace2 = go.Histogram(x = count_1, name = 'Diabetic')\n\nplot_data = [trace1, trace2]\nlayout = go.Layout(title = \"Total Outcomes\", xaxis = dict(title = \"Outcome\"),yaxis = dict(title = \"Count\") ) \n\nfig = go.Figure(data = plot_data, layout = layout)\nfig.show()","462bc21f":"from sklearn.model_selection import train_test_split\nx = data_scaled\ny = data[['Outcome']]\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.25, stratify = data[['Outcome']])\nx_train.shape, x_test.shape, y_train.shape, y_test.shape","2441bc83":"from sklearn import metrics\nfrom sklearn.model_selection import cross_val_score\naccuracy = []\nprecision = []\nrecall = []\nf1_score = []\ndef calculate_metrics(y_test, y_pred):\n    acc = metrics.accuracy_score(y_true = y_test, y_pred = y_pred)\n    pre = metrics.precision_score(y_true = y_test, y_pred = y_pred)\n    rec = metrics.recall_score(y_true = y_test, y_pred = y_pred)\n    f1 = metrics.f1_score(y_true = y_test, y_pred = y_pred)\n    accuracy.append(acc)\n    precision.append(pre)\n    recall.append(rec)\n    f1_score.append(f1)\n\n    \nkfold_min = []\nkfold_mean = []\nkfold_max = []\ndef calculate_kfold(estimator):\n    accuracies = cross_val_score(estimator, x, y, cv = 10)\n    kfold_min.append(accuracies.min())\n    kfold_mean.append(accuracies.mean())\n    kfold_max.append(accuracies.max())","97af53ca":"from sklearn.linear_model import LogisticRegression\nlogisticRegression = LogisticRegression()\nlogisticRegression.fit(x_train, y_train)\nlogisticRegression_prediction = logisticRegression.predict(x_test)\ncalculate_metrics(y_test, logisticRegression_prediction)\ncalculate_kfold(logisticRegression)","cb83332c":"from sklearn.tree import DecisionTreeClassifier\ndecisionTree = DecisionTreeClassifier(criterion = 'entropy')\ndecisionTree.fit(x_train, y_train)\ndecisionTree_prediction = decisionTree.predict(x_test)\ncalculate_metrics(y_test, decisionTree_prediction)\ncalculate_kfold(decisionTree)","3fee7036":"from sklearn.ensemble import RandomForestClassifier\nrandomForest = RandomForestClassifier(n_estimators = 1000)\nrandomForest.fit(x_train, y_train)\nrandomForest_prediction = randomForest.predict(x_test)\ncalculate_metrics(y_test, randomForest_prediction)\ncalculate_kfold(randomForest)","10cd8099":"from sklearn.svm import LinearSVC\nlinearSVC = LinearSVC()\nlinearSVC.fit(x_train, y_train)\nlinearSVC_prediction = linearSVC.predict(x_test)\ncalculate_metrics(y_test, linearSVC_prediction)\ncalculate_kfold(linearSVC)","81c03a0f":"from xgboost import XGBClassifier\nxgbClassifier = XGBClassifier()\nxgbClassifier.fit(x_train, y_train)\nxgbClassifier_prediction = xgbClassifier.predict(x_test)\ncalculate_metrics(y_test, xgbClassifier_prediction)\ncalculate_kfold(xgbClassifier)","f217648c":"from sklearn.neighbors import KNeighborsClassifier\nknnClassifier = KNeighborsClassifier()\nknnClassifier.fit(x_train, y_train)\nknnClassifier_prediction = knnClassifier.predict(x_test)\ncalculate_metrics(y_test, knnClassifier_prediction)\ncalculate_kfold(knnClassifier)","6b36318d":"from sklearn.naive_bayes import BernoulliNB\nbernoulliNB = BernoulliNB(binarize = True)\nbernoulliNB.fit(x_train, y_train)\nbernoulliNB_prediction = bernoulliNB.predict(x_test)\ncalculate_metrics(y_test, bernoulliNB_prediction)\ncalculate_kfold(bernoulliNB)","f05ca265":"column = pd.MultiIndex.from_arrays([['First Train', 'First Train', 'First Train', 'First Train', 'KFold', 'KFold', 'KFold'], ['Accuracy', 'Precision', 'Recall', 'F1 Score', 'Min', 'Mean', 'Max']])\n\nresults = pd.DataFrame(data = [accuracy, precision , recall, f1_score, kfold_min, kfold_mean, kfold_max], columns = column, index = ['Logistic Regression', 'Decision Tree', 'Random Forest', 'Linear SVC', 'XGBoost', 'K Neighbors', 'Bernoulli NB'])\nresults","7aeca403":"**Function to store every model's metrics**","8c304751":"# **2.3 Decision Tree**","c6e01ffe":"# **1.3 Evalute Dataset by Descriptive Statistics**","91379ab1":"# **2.8 Bernoulli Naive Bayes**","5e0f7cfa":"# **1.8 Coorelation of Clean Dataset**","15c94265":"# **1.6 Boxplot**","38ea796f":"# **2.4 Random Forest**","181746ba":"# **1.10 Target Class Ratio**","b4ade4ec":"**Columns Glucose, BloodPressure, SkinThickness, Insulin, BMI have invalid zero. Create a deep copy of dataset so that changes doesn't affect our original dataset\n**","9c16ef3d":"# **1.7 Replace Null Values**","bfae38b4":"# **3.0 Combine All Metrics**","18e584e8":"# **1.4 Pairwise Relationships in the Dataset**","5f52031b":"# **2.5 Linear Support Vector Classifier**","08aa365d":"# **2.1 Split Dataset**","dc040c6a":"**This notebook covers:**\n* Visualization of Dataset\n* Impute Null Values\n* Check Coorelation\n* Scale Data\n* All Classification Models\n* KFold\n* Evaluate Models","49953c73":"# Please give your suggestions in the comment box.\n# If you found it useful, UPVOTE.","f36aa9c1":"# **2.6 XGB Classifier**","2d9c614e":"# **2.7 KNeighbors**","ccd3fb6e":"# **1.9 Scale Dataset**","a9c16407":"# ** 1.2 Summary of Dataset**","8b7df804":"# 1.1 Import Dataset","39072cb2":"# **2.2 Logistic Regression**","377c07a5":"# **1.5 Visualizaion of Null Values**"}}