{"cell_type":{"a63ad200":"code","c5141042":"code","72238a59":"code","3bac7474":"code","5b83b69b":"code","b91044ee":"code","4ffe249b":"code","5588b654":"code","b4c0b1c0":"code","5f55c3a4":"code","a0d856aa":"code","62fd7d8c":"code","3782b42f":"markdown","08023a65":"markdown","83277419":"markdown","00b68bf2":"markdown","71495206":"markdown","2b0cdc82":"markdown","0e32d108":"markdown","ee178988":"markdown","95d972dc":"markdown","831a85f0":"markdown"},"source":{"a63ad200":"import numpy as np\nimport os\n\nimport pandas as pd\n\n# Plotting libraries\nimport matplotlib.pyplot as plt","c5141042":"# Geospatial libraries that we will be using for this\nimport folium\nimport geopandas as gpd\nfrom shapely.geometry import Point","72238a59":"power_plants = pd.read_csv('\/kaggle\/input\/ds4g-environmental-insights-explorer\/eie_data\/gppd\/gppd_120_pr.csv')\npower_plants.columns","3bac7474":"# Plotting the .geo info of the first power plant\npower_plants['.geo'][0]","5b83b69b":"longitude = float(power_plants['.geo'][0].split(\"[\")[1][:-2].split(\",\")[0])\nlatitude = float(power_plants['.geo'][0].split(\"[\")[1][:-2].split(\",\")[1])\n\nprint(f'Longitude: {longitude}, lattitude: {latitude}')","b91044ee":"# We can create a new column containing this information\npower_plants['longitude'] = [float(power_plants['.geo'][point].split(\"[\")[1][:-2].split(\",\")[0]) for point in range(power_plants.shape[0])]\npower_plants['latitude'] = [float(power_plants['.geo'][point].split(\"[\")[1][:-2].split(\",\")[1]) for point in range(power_plants.shape[0])]","4ffe249b":"geometry_power_plants = [Point(x,y) for x,y in zip(power_plants.longitude, power_plants.latitude)]","5588b654":"del power_plants['.geo']","b4c0b1c0":"gdf_power_plants = gpd.GeoDataFrame(power_plants, crs = {'init': 'epsg: 4326'}, geometry = geometry_power_plants)\ngdf_power_plants.head()","5f55c3a4":"gdf_power_plants.plot()","a0d856aa":"# Plot on the map\nlat=18.200178; lon=-66.664513\nplot = folium.Map(location = (lat, lon), zoom_start=9)\n\nfor plant_lat, plant_long in zip(gdf_power_plants.latitude, gdf_power_plants.longitude):\n    folium.Marker(location = (plant_lat, plant_long),\n                    icon = folium.Icon(color='blue')).add_to(plot)\n    \nplot","62fd7d8c":"# Saving the geodataframe for easy use later\ngdf_power_plants.to_file('Geolocated_gppd_120_pr.geojson', driver='GeoJSON')","3782b42f":"I should add that there are more benefits to making handling GeoJSONs instead of CSVs. For example, we can very easily drop them in QGIS and compare them to any rasters we might have:\n\n![Imgur](https:\/\/i.imgur.com\/AX4e89p.png)","08023a65":"And finally, we want to save this GeoDataFrame to be able to use it later","83277419":"GeoDataFrames are like pandas DataFrames, except they have an additional column called the `geometry` which will contain Shapely information about the row object given (here it is a point, but it could also be polygons (for boundaries of a country for example) or multipolyons).","00b68bf2":"If we take a look at the `.geo` column, we cna see that the location is in a string in there:","71495206":"We can easily extract the longitude & latitude of a given point and keep it as a float","2b0cdc82":"As we are saving these points with some geo-location information, we need to give it a CRS: Coordinate Reference System. These are just the reference system used to calculate the given longitude and latitude given in the `geometry` column.","0e32d108":"First we need to find where the location information is in the original `.csv` file:","ee178988":"We can now simply plot this GeoDataFrame","95d972dc":"Just to be sure, we can plot these on a Folium Map, to check that we have the correct CRS and we didn't mess up anything. (You can also check by un-hiding the code, that plotting points on a map with a GeoDataFrame is much easier than if we had to create an additional function to retrieve the longitude and latitude. Technically we could just keep that in a pandas DataFrame, but for the sake of the deomstration, GeoDataFrames are shown here).","831a85f0":"# Saving the power plants to a GeoJSON\n\nGeoJSONs are a great format to be able to open points very easily. They are basically just geo-located JSON files, which prevent us from having to retrieve the location info from each point with a self-made function each time we want to plot \/ access to points.\n\nIn this short notebook, I'll show how this is done with a library called `geopandas` and how to then simply save this file.\n\nI also created a dataset [here](https:\/\/www.kaggle.com\/maxlenormand\/geolocated-power-plants-geojson) if you simply want to download the `.geojson` file directly."}}