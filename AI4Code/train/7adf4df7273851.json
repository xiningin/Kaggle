{"cell_type":{"6c1b8942":"code","1b755d8c":"code","c8226a93":"code","6b515311":"code","5f374dea":"code","6400a4a3":"code","36302e77":"markdown","51bf50a8":"markdown","4a14f2f5":"markdown"},"source":{"6c1b8942":"import pandas as pd\nimport matplotlib.pyplot as plt","1b755d8c":"blue = '#0d71c0'\nyellow = '#f0e415'\norange = '#f79320'\nred = '#df1922'","c8226a93":"df = pd.read_csv('https:\/\/bit.ly\/3uP3F7x')\ndf.drop(columns=['Unnamed: 0', 'Aciklamalar', 'tarih_bitis'], inplace=True)\ndf.rename(columns={'tarih_baslangic': 'date', 'il': 'city', '100bin_kiside_haftalik_vaka_sayisi': 'case'}, inplace=True)\n\ndf['case'] = df['case'].replace(regex={',': '.'}).astype('float32')\ndf['color'] = df['case'].apply(lambda x : 0 if x < 20 else 1 if x < 50 else 2 if x < 100 else 3)","6b515311":"def plot_city(df, city):\n  fig, ax = plt.subplots(figsize=(16, 4))\n\n  ax.set_title(city, fontsize=20)\n\n  x = df['date'].replace(r'(\\d\\d)\\.(\\d\\d).\\d\\d\\d\\d', r'\\2-\\1', regex=True).unique() # date formatting\n  y = df.loc[df['city'] == city, 'case']\n\n  ax.bar(x, y, color=[blue if i < 20 else yellow if i < 50 else orange if i < 100 else red for i in y])","5f374dea":"plot_city(df, 'Istanbul')\nplot_city(df, 'Ankara')\nplot_city(df, 'Izmir')\nplt.show()","6400a4a3":"idx = pd.MultiIndex.from_product([df['date'].unique(), [0, 1, 2, 3]])\n\ncol = df.groupby(['date'])['color'].value_counts()\ncol = col.append(pd.Series(0, index=idx[~idx.isin(col.index)])).sort_index()\n\ncol.index = col.index.set_levels(pd.DatetimeIndex(col.index.levels[0], dayfirst=True), level=0)\ncol = col.sort_index()\ncol.index = col.index.set_levels(col.index.levels[0].strftime('%m-%d'), level=0)\n\nX = col.index.get_level_values(0).unique()\nY0 = col.loc[pd.IndexSlice[:, 0],].values\nY1 = col.loc[pd.IndexSlice[:, 1],].values\nY2 = col.loc[pd.IndexSlice[:, 2],].values\nY3 = col.loc[pd.IndexSlice[:, 3],].values\n\nfig, ax = plt.subplots(figsize=(16, 4))\n\nax.set_title('Cities Per Color Level', fontsize=20)\n\nax.bar(X, Y0, color=blue)\nax.bar(X, Y1, color=yellow, bottom=Y0)\nax.bar(X, Y2, color=orange, bottom=(Y0 + Y1))\nax.bar(X, Y3, color=red, bottom=(Y0 + Y1 + Y2))\n\nplt.show()","36302e77":"### General stats","51bf50a8":"### City stats","4a14f2f5":"### Data preparation"}}