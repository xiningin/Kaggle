{"cell_type":{"acfbd395":"code","b5044e5a":"code","fe44d430":"code","920d13d9":"code","f3c4eedf":"code","5930e388":"code","cffc5938":"code","8ac4e93b":"code","323dbe2d":"code","67457481":"code","55fa72e9":"code","7a868356":"code","99be06df":"code","177fecf2":"code","077692a6":"code","7486857b":"code","e8cfeb08":"code","922567e5":"code","a09a7ed9":"code","ac070467":"code","e16f7980":"code","90657699":"code","030c1909":"code","960395f1":"code","d565a71c":"code","ffd9f100":"code","82638b1b":"code","7408578e":"code","c12731cb":"code","dcc78527":"code","29bd1430":"code","deb90903":"code","20f0f5df":"code","fedc34d9":"markdown","50e8ace1":"markdown","cd2c08d9":"markdown","21be8b8f":"markdown","bb294c13":"markdown","7cb2c871":"markdown","41f00bd0":"markdown","72d0fbec":"markdown","6b3088e0":"markdown","c8989617":"markdown","1482d514":"markdown","d3b63174":"markdown","eb1a14d8":"markdown","19da1867":"markdown","aeee1489":"markdown","ae953602":"markdown","7767d8c1":"markdown","ecf5f9b8":"markdown"},"source":{"acfbd395":"# Importing Libraries\nimport numpy as np\nimport pandas as pd\nimport os\n# Data Visualization\nimport matplotlib.pyplot as pl\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')\n","b5044e5a":"data = pd.read_csv(\"..\/input\/insurance\/insurance.csv\")\ndata.head()","fe44d430":"#  Check Null Values\ndata.isnull().sum()","920d13d9":"# Summary of the dataset\ndata.describe()","f3c4eedf":"# Check data typs of each column\ndata.dtypes","5930e388":"from sklearn.preprocessing import LabelEncoder\n# Sex\nle = LabelEncoder()\nle.fit(data.sex.drop_duplicates())\ndata.sex = le.transform(data.sex)\n# Smoker\nle.fit(data.smoker.drop_duplicates())\ndata.smoker = le.transform(data.smoker)\n# Region\nle.fit(data.region.drop_duplicates())\ndata.region = le.transform(data.region)\n","cffc5938":"# Check the Correlation\ndata.corr()['charges'].sort_values()","8ac4e93b":"# Visualizing correlation\n\nf,ax =pl.subplots(figsize =(10,8))\ncorr= data.corr()\nsns.heatmap(corr)\n","323dbe2d":"# Distribution of Charge\npl.hist(data.charges,color= \"seagreen\")\npl.xlabel(\"Charge Distribution\")\npl.ylabel(\"No. Of occurence\")","67457481":"from bokeh.io import output_notebook, show\nfrom bokeh.plotting import figure\noutput_notebook()\nimport scipy.special\nfrom bokeh.layouts import gridplot\nfrom bokeh.plotting import figure, show, output_file\n\nf= pl.figure(figsize=(12,5))\n\nax=f.add_subplot(121)\nsns.distplot(data[(data.smoker == 1)][\"charges\"],color='c',ax=ax)\nax.set_title('Distribution of charges for smokers')\n\nax=f.add_subplot(122)\nsns.distplot(data[(data.smoker == 0)]['charges'],color='b',ax=ax)\nax.set_title('Distribution of charges for non-smokers')","55fa72e9":"sns.catplot(x=\"smoker\",hue=\"sex\",kind=\"count\",palette=\"GnBu_d\",data=data)","7a868356":"sns.catplot(x=\"sex\", y=\"charges\", hue=\"smoker\",\n            kind=\"violin\", data=data, palette = 'magma')","99be06df":"pl.figure(figsize=(12,5))\npl.title(\"Box plot for Charges of women\")\nsns.boxplot(y=\"smoker\", x=\"charges\", data= data[(data.sex==1)],orient=\"h\",palette ='magma')","177fecf2":"pl.figure(figsize=(12,5))\npl.title(\"Box plot for charges of men\")\nsns.boxplot(y=\"smoker\", x=\"charges\", data =  data[(data.sex == 0)] , orient=\"h\", palette = 'rainbow')","077692a6":"pl.figure(figsize=(12,5))\npl.title(\"Distribution of age\")\nax = sns.distplot(data[\"age\"], color = 'g')","7486857b":"sns.catplot(x=\"smoker\", kind=\"count\",hue = 'sex', palette=\"rainbow\", data=data[(data.age == 18)])\npl.title(\"The number of smokers and non-smokers (18 years old)\")","e8cfeb08":"pl.figure(figsize=(12,5))\npl.title(\"Box plot for charges 18 years old smokers\")\nsns.boxplot(y=\"smoker\", x=\"charges\", data = data[(data.age == 18)] , orient=\"h\", palette = 'pink')","922567e5":"g = sns.jointplot(x=\"age\", y=\"charges\", data = data[(data.smoker == 0)],kind=\"kde\", color=\"g\")\ng.plot_joint(pl.scatter, c=\"w\", s=30, linewidth=1, marker=\"+\")\ng.ax_joint.collections[0].set_alpha(0)\ng.set_axis_labels(\"$age$\", \"$charges$\")\nax.set_title('Distribution of charges and age for non-smokers')","a09a7ed9":"g = sns.jointplot(x=\"age\", y=\"charges\", data = data[(data.smoker == 1)],kind=\"kde\", color=\"c\")\ng.plot_joint(pl.scatter, c=\"w\", s=30, linewidth=1, marker=\"+\")\ng.ax_joint.collections[0].set_alpha(0)\ng.set_axis_labels(\"$age$\", \"$charges$\")\nax.set_title('Distribution of charges and age for smokers')","ac070467":"#non - smokers\np = figure(plot_width=500, plot_height=450)\np.circle(x=data[(data.smoker == 0)].age,\n         y=data[(data.smoker == 0)].charges, \n         size=7, line_color=\"navy\", fill_color=\"pink\",\n         fill_alpha=0.9)\n\nshow(p)","e16f7980":"#smokers\np = figure(plot_width=500, plot_height=450)\np.circle(x=data[(data.smoker == 1)].age,y=data[(data.smoker == 1)].charges, size=7, line_color=\"navy\", fill_color=\"red\", fill_alpha=0.9)\nshow(p)","90657699":"sns.lmplot(x=\"age\", y=\"charges\", hue=\"smoker\", data=data, palette = 'inferno_r', size = 7)\nax.set_title('Smokers and non-smokers')","030c1909":"# Distribution of BMI\npl.figure(figsize=(12,5))\npl.title(\"Distribution of bmi\")\nax = sns.distplot(data[\"bmi\"], color = 'm')","960395f1":"pl.figure(figsize=(12,5))\npl.title(\"Distribution of charges for patients with BMI greater than 30\")\nax = sns.distplot(data[(data.bmi >= 30)]['charges'], color = 'm')","d565a71c":"pl.figure(figsize=(12,5))\npl.title(\"Distribution of charges for patients with BMI less than 30\")\nax = sns.distplot(data[(data.bmi < 30)]['charges'], color = 'c')","ffd9f100":"g = sns.jointplot(x=\"bmi\", y=\"charges\", data = data,kind=\"kde\", color=\"m\")\ng.plot_joint(pl.scatter, s=30, linewidth=1, marker=\"+\")\ng.ax_joint.collections[0].set_alpha(0)\ng.set_axis_labels(\"$bmi$\", \"$charges$\")\nax.set_title('Distribution of bmi and charges')","82638b1b":"pl.figure(figsize=(10,6))\nax = sns.scatterplot(x='bmi',y='charges',data=data,palette='magma',hue='smoker')\nax.set_title('Scatter plot of charges and bmi')\n\nsns.lmplot(x=\"bmi\", y=\"charges\", hue=\"smoker\", data=data, palette = 'magma', size = 8)","7408578e":"sns.catplot(x=\"children\", kind=\"count\",\n            palette=\"pink\", data=data, size = 7)","c12731cb":"sns.catplot(x=\"smoker\", kind=\"count\", palette=\"rainbow\",hue = \"sex\",\n            data=data[(data.children > 0)], size = 6)\nax.set_title('Smokers and non-smokers who have childrens')","dcc78527":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom sklearn.ensemble import RandomForestRegressor\n","29bd1430":"# Linear Regression\nx=data.drop(['charges'],axis=1)\ny=data.charges\nx_train,x_test,y_train,y_test=train_test_split(x,y,random_state=0)\n\nlr= LinearRegression().fit(x_train,y_train)\n\ny_train_pred = lr.predict(x_train)\ny_test_pred = lr.predict(x_test)\n\nprint(lr.score(x_test,y_test))\n","deb90903":"# Transformation using Polynomials\nX = data.drop(['charges','region'], axis = 1)\nY = data.charges\n\n\n\nquad = PolynomialFeatures (degree = 2)\nx_quad = quad.fit_transform(X)\n\nX_train,X_test,Y_train,Y_test = train_test_split(x_quad,Y, random_state = 0)\n\nplr = LinearRegression().fit(X_train,Y_train)\n\nY_train_pred = plr.predict(X_train)\nY_test_pred = plr.predict(X_test)\n\nprint(plr.score(X_test,Y_test))\n","20f0f5df":"# Random Forest\nregressor = RandomForestRegressor(n_estimators=100,random_state=0)\nregressor.fit(x_train,y_train)\ny_pred = regressor.predict(x_test)\nprint(regressor.score(x_test,y_test))\n\nfrom sklearn import metrics\n\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y_test, y_pred))\nprint('Mean Squared Error:', metrics.mean_squared_error(y_test, y_pred))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test, y_pred)))","fedc34d9":"Patients with BMI above 30 spend more on treatment!","50e8ace1":"Please note that women are coded with the symbol \" 1 \"and men - \"0\". Thus non-smoking people and the truth more. Also we can notice that more male smokers than women smokers. It can be assumed that the total cost of treatment in men will be more than in women, given the impact of smoking.","cd2c08d9":"The average BMI in patients is 30.","21be8b8f":"The above tells that may patients don no have children","bb294c13":"Check how many children our patients have.","7cb2c871":"We have patients under 20 in our data set. Im 18 years old. This is the minimum age of patients in our set. The maximum age is 64 years. My personal interest is whether there are smokers among patients 18 years.","41f00bd0":"Does smoking affect the cost of treatment at this age?","72d0fbec":"For male non-smokers there are few outliers. And similat to women there is no outlier for smoker males. That is even if the male or female is non-smoker they are giving high charges","6b3088e0":"In non-smokers, the cost of treatment increases with age.\nIn smoking people, we do not see such dependence. I think that it is not only in smoking but also in the peculiarities of the dataset. Such a strong effect of Smoking on the cost of treatment would be more logical to judge having a set of data with a large number of records and signs.\n\nCheck for BMI","c8989617":"Do Label Encoding","1482d514":"First, let's look at the distribution of costs in patients with BMI greater than 30 and less than 30.","d3b63174":"Now,look at the age of the patient. Check how age affects the cost of the patient\n","eb1a14d8":"There is a strong correlation of charge with smoker. We need to investigate more on smoker field.","19da1867":"Loading Data set and Analysing the data","aeee1489":"Non-smoking parents are much more.\nUse Linear Regression.","ae953602":"From the above graph it can be said that there are outliers for non-smoker women. It is right skewed\nFor smoker women there are no outliers and it is slightly right skewed","7767d8c1":"According to the above graph numner of smoker spend more on treatment. But also non-smokers seems more. Check the same.","ecf5f9b8":"As we can see, even at the age of 18 smokers spend much more on treatment than non-smokers. Among non-smokers we are seeing some \" tails.\" I can assume that this is due to serious diseases or accidents. Now let's see how the cost of treatment depends on the age of smokers and non-smokers patients."}}