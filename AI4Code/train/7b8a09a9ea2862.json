{"cell_type":{"a1fa56de":"code","d17bfd83":"code","8aaaa30b":"code","b7c6cf66":"code","f0688cc7":"code","d891aae7":"code","54e9da9c":"code","fc71201e":"code","524dff0d":"code","dfdda8c3":"code","ac27311f":"code","5efc4ce1":"code","edd00031":"code","5d82d41f":"markdown","3cfd11ab":"markdown","b28ea94c":"markdown","9362cf78":"markdown"},"source":{"a1fa56de":"import warnings\nwarnings.filterwarnings(\"ignore\")","d17bfd83":"from matplotlib.pyplot import imread,imshow\nimport matplotlib.pyplot as plt\nfrom skimage.transform import resize\nfrom sklearn.utils import shuffle\nfrom tensorflow.keras.layers import *\nfrom tensorflow.keras.models import *\nfrom tensorflow.keras.optimizers import *\nfrom sklearn.model_selection import train_test_split\nfrom tensorflow.keras.utils import to_categorical\nimport pandas as pd\nimport numpy as np\nimport glob\nfrom tensorflow.keras.callbacks import EarlyStopping\nfrom tensorflow.keras.datasets import mnist","8aaaa30b":"train_df = pd.read_csv(\"..\/input\/digit-recognizer\/train.csv\")\ntest_df  = pd.read_csv(\"..\/input\/digit-recognizer\/test.csv\")","b7c6cf66":"xtr = np.array(train_df.drop(columns=['label']))\nytr = np.array(train_df['label'])\n\nxte = np.array(test_df)","f0688cc7":"xtr = xtr.reshape((xtr.shape[0],28,28,1))\nxte = xte.reshape((xte.shape[0], 28,28,1))\n\nxtr = xtr.astype('float32')\nxte = xte.astype('float32')\n\nxtr = xtr\/ 255\nxte =xte\/ 255","d891aae7":"ytr = to_categorical(ytr,10)","54e9da9c":"model = Sequential()\nmodel.add(Conv2D(64, kernel_size=(7, 7), strides=(1, 1), activation='relu',input_shape=(28,28,1)))\nmodel.add(MaxPooling2D(pool_size=(2, 2), strides=(2, 2)))\nmodel.add(BatchNormalization(momentum=0.9, epsilon=1e-5, gamma_initializer=\"uniform\"))\nmodel.add(Conv2D(128, (5, 5), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Conv2D(256, (3, 3), activation='relu'))\nmodel.add(Flatten())\nmodel.add(Dense(1000, activation='relu'))\nmodel.add(Dense(10, activation='softmax'))","fc71201e":"model.compile(loss='categorical_crossentropy',optimizer=\"adam\",metrics='accuracy')\nmodel.summary()","524dff0d":"history = model.fit(xtr,ytr,batch_size=100,epochs=20,validation_split = 0.1)","dfdda8c3":"rows = 4\ncolumns = 4\n\nfig = plt.figure(figsize=(16,16))\n\nrandom_images = []\n\nfor _ in range(rows*columns):\n    random_index = np.random.randint(0,xte.shape[0])\n    \n    random_images.append(xte[random_index])\n    \nrandom_images = np.array(random_images)\n\npredictions = np.argmax(model.predict(random_images),1).astype('int32').reshape(rows*columns,)\n\nfor i in range(1,rows*columns+1):\n    ax = plt.subplot(rows, columns, i)\n    plt.imshow(random_images[i-1])\n    predicted_str = \"Predicted: \" + str(predictions[i-1])\n    ax.set_title(predicted_str)\n\nfig.show()","ac27311f":"predictions = model.predict(xte)","5efc4ce1":"pred = np.argmax(predictions,axis=1)","edd00031":"submission_df = pd.DataFrame()\n\nimageId = [i for i in range(1,pred.shape[0]+1)]\nsubmission_df['ImageId'] = imageId\nsubmission_df['Label'] = pred\n\nsubmission_df.to_csv(\"submission.csv\",index=False)","5d82d41f":"# Creating Model","3cfd11ab":"# Sample demonstration","b28ea94c":"# Submitting Results","9362cf78":"# Preparing Data"}}