{"cell_type":{"28c1eb0a":"code","b1ae3c17":"code","cbfab85b":"code","5614378a":"code","0d25eb25":"code","af127e10":"code","c8ec3c47":"code","6a678acd":"code","82284af5":"code","c984b45b":"code","81c8bbb6":"code","a5807121":"code","ab31eb95":"code","103ab011":"code","551830b2":"code","b14b2171":"code","0299492d":"code","878d4d0b":"code","43fac96a":"code","bf8b4e32":"markdown","bc912e62":"markdown"},"source":{"28c1eb0a":"import numpy as np\nimport pandas as pd\nfrom pathlib import Path\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n        \nimport matplotlib.pyplot as plt\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error\n\nfrom sklearn.dummy import DummyRegressor\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.linear_model import Ridge, Lasso\nfrom sklearn.ensemble import RandomForestRegressor\n        \ninput_path = Path('\/kaggle\/input\/tabular-playground-series-jan-2021\/')","b1ae3c17":"train = pd.read_csv(input_path \/ 'train.csv', index_col='id')\ndisplay(train.head())","cbfab85b":"submission = pd.read_csv(input_path \/ 'sample_submission.csv', index_col='id')\ndisplay(submission.head())","5614378a":"from fastai.tabular.all import *\nsplits = RandomSplitter(valid_pct=0.2)(range_of(train))","0d25eb25":"to = TabularPandas(train, procs=[ FillMissing,Normalize],\n                   cont_names = ['cont1',\n                                 'cont2',\n                                 'cont3',\n                                 'cont4',\n                                 'cont5',\n                                 'cont6',\n                                 'cont7',\n                                 'cont8',\n                                 'cont9',\n                                 'cont10',\n                                 'cont11',\n                                 'cont12',\n                                 'cont13',\n                                 'cont14'],\n                   y_names='target',\n                   splits=splits)","af127e10":"to.xs.iloc[:2]","c8ec3c47":"dls = to.dataloaders(bs=64)","6a678acd":"learn = tabular_learner(dls, metrics=rmse)","82284af5":"learn.fit_one_cycle(4)","c984b45b":"learn.show_results()","81c8bbb6":"learn.lr_find()\n","a5807121":"lr = 1e-06\nlearn.fit_one_cycle(3, lr , wd = 0.3)","ab31eb95":"row, clas, probs = learn.predict(train.iloc[0])","103ab011":"print('i am done training')","551830b2":"test = pd.read_csv(input_path \/ 'test.csv', index_col='id')\ndisplay(test.head())","b14b2171":"test_df = test.copy()\ndl = learn.dls.test_dl(test_df)","0299492d":"preds = learn.get_preds(dl=dl)[0].numpy()\n","878d4d0b":"submission['target'] = preds\nsubmission.to_csv('random_forest.csv')","43fac96a":"submission['target'].describe()","bf8b4e32":"# Read in the data files","bc912e62":" **[Tabular Playground Series - Jan 2021](https:\/\/admin.kaggle.com\/c\/tabular-playground-series-jan-2021\/overview)** competition. \n"}}