{"cell_type":{"8b5544f0":"code","093f5278":"code","483d3b45":"code","512387b1":"code","364cea86":"code","c2f4a0c3":"code","dc8544a9":"code","1ca87bef":"code","e4c26c9c":"code","5ab7c61b":"code","215b0e76":"code","a908536a":"code","2546e59f":"code","42d6e4d8":"code","f0524a67":"code","4fe63344":"code","8b3982dc":"code","60b29d7d":"code","67a9b851":"markdown","11fbea03":"markdown","d6592e7a":"markdown","277392e1":"markdown","370bf093":"markdown","247b7dab":"markdown","00575fb9":"markdown","89703030":"markdown","f182230f":"markdown","55a7761c":"markdown","5da69589":"markdown","8594a1d2":"markdown","bd7e0655":"markdown","c538d1d1":"markdown","6f181490":"markdown","96f1afd9":"markdown"},"source":{"8b5544f0":"import matplotlib.pyplot as plt\nimport pandas as pd\nimport pylab as pl\nimport numpy as np\n%matplotlib inline","093f5278":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","483d3b45":"df = pd.read_csv(\"..\/input\/oc2emission\/FuelConsumptionCo2.csv\")\ndf","512387b1":"df.head()","364cea86":"df.describe()","c2f4a0c3":"cdf = df[[\"ENGINESIZE\", \"CYLINDERS\", \"FUELCONSUMPTION_COMB\", \"CO2EMISSIONS\"]]\ncdf","dc8544a9":"viz = cdf\nviz.hist()\nplt.show()","1ca87bef":"plt.scatter(cdf.ENGINESIZE, cdf.CO2EMISSIONS, color = \"yellow\")\nplt.xlabel(\"ENGINESIZE\")\nplt.ylabel(\"CO2EMISSIONS\")\nplt.show()","e4c26c9c":"plt.scatter(cdf.CYLINDERS, cdf.CO2EMISSIONS, color = \"yellow\")\nplt.xlabel(\"CYLINDERS\")\nplt.ylabel(\"CO2EMISSIONS\")\nplt.show()","5ab7c61b":"plt.scatter(cdf.FUELCONSUMPTION_COMB, cdf.CO2EMISSIONS, color = \"yellow\")\nplt.xlabel(\"FUELCONSUMPTION_COMB\")\nplt.ylabel(\"CO2EMISSIONS\")\nplt.show()","215b0e76":"msk = np.random.rand(len(df)) < 0.8\ntrain = cdf[msk]\ntest = cdf[~msk]","a908536a":"from sklearn import linear_model\nregr = linear_model.LinearRegression()\ntrain_x = np.asanyarray(train[[\"ENGINESIZE\"]])\ntrain_y = np.asanyarray(train[[\"CO2EMISSIONS\"]])\nregr.fit(train_x, train_y)\nprint(\"Coefficient: \", regr.coef_)\nprint(\"Intercept: \", regr.intercept_)","2546e59f":"plt.scatter(train.ENGINESIZE, train.CO2EMISSIONS, color = \"blue\")\nplt.plot(train_x, regr.coef_[0][0]*train_x + regr.intercept_[0], '-r')\nplt.xlabel(\"ENGINESIZE\")\nplt.ylabel(\"CO2EMISSIONS\")\nplt.show()","42d6e4d8":"plt.scatter(train.ENGINESIZE, train.CO2EMISSIONS, color = \"yellow\")\nplt.plot(train_x, regr.coef_[0][0]*train_x + regr.intercept_[0], \"-r\")\nplt.xlabel(\"ENGINESIZE\")\nplt.ylabel(\"CO2EMISSIONS\")","f0524a67":"from sklearn.metrics import r2_score\ntest_x = np.asanyarray(test[[\"ENGINESIZE\"]])\ntest_y = np.asanyarray(test[[\"CO2EMISSIONS\"]])\ntest_y_hat = regr.predict(test_x)","4fe63344":"np.mean(np.absolute(test_y_hat - test_y))","8b3982dc":"np.mean((test_y_hat - test_y)**2)","60b29d7d":"r2_score(test_y_hat, test_y)","67a9b851":"***Reading in the dataset***","11fbea03":"***Evaluation***","d6592e7a":"Mean Square error:","277392e1":"***Modeling***","370bf093":"***Creating train and test dataset***","247b7dab":"Selecting possible features","00575fb9":"***Importing needed packages***","89703030":"R-squared (Coefficient of determination):","f182230f":"Mean absolute error:","55a7761c":"we can plot the fit line over the data:","5da69589":"***Train data distribution***","8594a1d2":"***Plot outputs***","bd7e0655":"Coefficient and Intercept in the simple linear regression, are the parameters of the fit line. Given that it is a simple linear regression, with only 2 parameters, and knowing that the parameters are the intercept and slope of the line, sklearn can estimate them directly from our data.","c538d1d1":"Visualizing the possible selected features","6f181490":"***Data Exploration***","96f1afd9":"Plotting different features against the label \"CO2EMISSIONS\" to see how linear their relationship is."}}