{"cell_type":{"4a344696":"code","7c536a3a":"code","bd1ffdca":"code","f624593e":"code","edf1d74f":"code","a7570d20":"code","40405f56":"code","e8803ad1":"code","d7c73aa9":"code","83189d80":"code","d371371a":"code","7a907a3c":"code","881ab743":"code","0bcf872a":"code","954da0a2":"code","5d402dfd":"code","74eef198":"code","1dbaa095":"code","e7b0eee8":"code","78d80e20":"code","290fe751":"code","13084c31":"code","49ea9c96":"code","18258049":"code","ce676e8d":"code","e1ee55fc":"code","47624783":"code","efdb1ff2":"code","f4197354":"code","2f6f7e50":"code","77a3adfd":"code","0ecfa59d":"code","57ef8fbe":"code","04dd61be":"markdown","d4c3031c":"markdown"},"source":{"4a344696":"import pandas as pd\npd.plotting.register_matplotlib_converters()\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\n\nimport plotly.offline as py\nimport plotly.figure_factory as ff\npy.init_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nfrom plotly import tools\n\ndf = pd.read_csv('..\/input\/flight-delays\/flights.csv')#, low_memory=False)","7c536a3a":"df","bd1ffdca":"df.head(10).T","f624593e":"df","edf1d74f":"#flight_data.isna().sum()\npd.concat([df.isnull().sum(), 100 * df.isnull().sum()\/len(df)], \n              axis=1).rename(columns={0:'Missing Records', 1:'Percentage (%)'})","a7570d20":"#df\ndff = df.ORIGIN_AIRPORT.value_counts()[:10]\nlen(dff)\ndff","40405f56":"dff = df.ORIGIN_AIRPORT.value_counts()[:10]\n\ntrace = go.Bar(\n    x=dff.index,\n    y=dff.values,\n    marker=dict(\n        color = dff.values,\n        colorscale='Jet',\n        showscale=True\n    )\n)\n\ndata = [trace]\nlayout = go.Layout(\n    title='Origin City Distribution', \n    yaxis = dict(title = '# of Flights')\n)\n\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)","e8803ad1":"dff = df.ORIGIN_AIRPORT.value_counts()\nlen(dff)","d7c73aa9":"dff = df.ORIGIN_AIRPORT.value_counts()[:10]\nlabel = dff.index\nsize = dff.values\n\ncolors = ['skyblue', '#FEBFB3', '#96D38C', '#D0F9B1', 'gold', 'orange', 'lightgrey', \n          'lightblue','lightgreen','aqua']\ntrace = go.Pie(labels=label, values=size, marker=dict(colors=colors),hole = .2)\n\ndata = [trace]\nlayout = go.Layout(\n    title='Origin Airport Distribution'\n)\n\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)","83189d80":"airports_path = \"..\/input\/flight-delays\/airports.csv\"\nairports = pd.read_csv(airports_path)\nairports","d371371a":"dff = df.AIRLINE.value_counts()[:10]\n\ntrace = go.Bar(\n    x=dff.index,\n    y=dff.values,\n    marker=dict(\n        color = dff.values,\n        colorscale='Jet',\n        showscale=True)\n)\n\ndata = [trace]\nlayout = go.Layout(xaxis=dict(tickangle=15),\n    title='Airline distribution', \n                   yaxis = dict(title = '# of Flights'))\n\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)","7a907a3c":"df = pd.merge(df,airlines, left_on='AIRLINE', right_on = 'IATA_CODE')\ndf.insert(loc=5, column='AIRLINE', value=df.AIRLINE_y)\ndf = df.drop(['AIRLINE_y','IATA_CODE'], axis=1)","881ab743":"airport = pd.read_csv('..\/input\/flight-delays\/airports.csv')\ndf = pd.merge(df,airport[['IATA_CODE','AIRPORT','CITY']], left_on='ORIGIN_AIRPORT', right_on = 'IATA_CODE')\ndf = df.drop(['IATA_CODE'], axis=1)\ndf = pd.merge(df,airport[['IATA_CODE','AIRPORT','CITY']], left_on='DESTINATION_AIRPORT', right_on = 'IATA_CODE')\ndf = df.drop(['IATA_CODE'], axis=1)","0bcf872a":"dff = df['AIRPORT_x'].value_counts()[:10]\nlabel = dff.index\nsize = dff.values\n\ncolors = ['skyblue', '#FEBFB3', '#96D38C', '#D0F9B1', 'gold', 'orange', 'lightgrey', \n          'lightblue','lightgreen','aqua']\ntrace = go.Pie(labels=label, values=size, marker=dict(colors=colors),hole = .2)\n\ndata = [trace]\nlayout = go.Layout(\n    title='Origin Airport Distribution'\n)\n\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)","954da0a2":"dff = df.CITY_x.value_counts()[:10]\n\ntrace = go.Bar(\n    x=dff.index,\n    y=dff.values,\n    marker=dict(\n        color = dff.values,\n        colorscale='Jet',\n        showscale=True\n    )\n)\n\ndata = [trace]\nlayout = go.Layout(\n    title='Origin City Distribution', \n    yaxis = dict(title = '# of Flights')\n)\n\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)","5d402dfd":"dff = df.AIRLINE.value_counts()[:10]\n\ntrace = go.Bar(\n    x=dff.index,\n    y=dff.values,\n    marker=dict(\n        color = dff.values,\n        colorscale='Jet',\n        showscale=True)\n)\n\ndata = [trace]\nlayout = go.Layout(xaxis=dict(tickangle=15),\n    title='Airline distribution', \n                   yaxis = dict(title = '# of Flights'))\n\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)","74eef198":"dff = df.MONTH.value_counts().to_frame().reset_index().sort_values(by='index')\ndff.columns = ['month', 'flight_num']\nmonth = {1: 'Jan', 2: 'Feb', 3: 'Mar', 4: 'Apr', 5: 'May',\n            6: 'Jun', 7: 'Jul', 8: 'Aug', 9: 'Sep', 10: 'Oct', 11: 'Nov', 12: 'Dec'}\ndff.month = dff.month.map(month)\n\ntrace = go.Bar(\n    x=dff.month,\n    y=dff.flight_num,\n    marker=dict(\n        color = dff.flight_num,\n        colorscale='Reds',\n        showscale=True)\n)\n\ndata = [trace]\nlayout = go.Layout(\n    title='# of Flights (monthly)', \n    yaxis = dict(title = '# of Flights'\n                                                )\n)\n\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)","1dbaa095":"df['dep_delay'] = np.where(df.DEPARTURE_DELAY>0,1,0)\ndf['arr_delay'] = np.where(df.ARRIVAL_DELAY>0,1,0)\ndff = df.groupby('MONTH').dep_delay.mean().round(2)\n\ndff.index = dff.index.map(month)\ntrace1 = go.Bar(\n    x=dff.index,\n    y=dff.values,\n    name = 'Departure_delay',\n    marker = dict(\n        color = 'aqua'\n    )\n)\n\ndff = df.groupby('MONTH').arr_delay.mean().round(2)\ndff.index = dff.index.map(month)\n\ntrace2 = go.Bar(\n    x=dff.index,\n    y=dff.values,\n    name='Arrival_delay',\n    marker=dict(\n        color = 'red'\n    )\n)\n\ndata = [trace1,trace2]\nlayout = go.Layout(\n    title='% Delay (Months)', \n    yaxis = dict(title = '%')\n)\n\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)","e7b0eee8":"plt.figure(figsize=(10,6))\n\nplt.title(\"Average Arrival Delay for Spirit Airlines Flights, by Month\")\n\n# Bar chart showing average arrival delay for Spirit Airlines flights by month\nsns.barplot(x=df.index, y=df['NK'])\n\n# Add label for vertical axis\nplt.ylabel(\"Arrival delay (in minutes)\")","78d80e20":"airlines_path = \"..\/input\/flight-delays\/airlines.csv\"\nairlines = pd.read_csv(airlines_path)","290fe751":"df = pd.merge(df,airlines, left_on='AIRLINE', right_on = 'IATA_CODE')\ndf.insert(loc=5, column='AIRLINE', value=df.AIRLINE_y)\ndf = df.drop(['AIRLINE_y','IATA_CODE'], axis=1)","13084c31":"airports_path = \"..\/input\/flight-delays\/airports.csv\"\nairport = pd.read_csv(airports_path)\ndf = pd.merge(df,airport[['IATA_CODE','AIRPORT','CITY']], left_on='ORIGIN_AIRPORT', right_on = 'IATA_CODE')\ndf = df.drop(['IATA_CODE'], axis=1)\ndf = pd.merge(df,airport[['IATA_CODE','AIRPORT','CITY']], left_on='DESTINATION_AIRPORT', right_on = 'IATA_CODE')\ndf = df.drop(['IATA_CODE'], axis=1)","49ea9c96":"df.head()","18258049":"plt.figure(figsize=(10,6))\n\n# Add title\nplt.title(\"Average Arrival Delay for Spirit Airlines Flights, by Month\")\n\n# Bar chart showing average arrival delay for Spirit Airlines flights by month\nsns.barplot(x=flight_data.index, y=flight_data['NK'])\n\n# Add label for vertical axis\nplt.ylabel(\"Arrival delay (in minutes)\")","ce676e8d":"dff = df['AIRPORT_x'].value_counts()[:10]\nlabel = dff.index\nsize = dff.values\n\ncolors = ['skyblue', '#FEBFB3', '#96D38C', '#D0F9B1', 'gold', 'orange', 'lightgrey', \n          'lightblue','lightgreen','aqua']\ntrace = go.Pie(labels=label, values=size, marker=dict(colors=colors),hole = .2)\n\ndata = [trace]\nlayout = go.Layout(\n    title='Origin Airport Distribution'\n)\n\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)","e1ee55fc":"dff = df.CITY_x.value_counts()[:10]\n\ntrace = go.Bar(\n    x=dff.index,\n    y=dff.values,\n    marker=dict(\n        color = dff.values,\n        colorscale='Jet',\n        showscale=True\n    )\n)\n\ndata = [trace]\nlayout = go.Layout(\n    title='Origin City Distribution', \n    yaxis = dict(title = '# of Flights')\n)\n\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)","47624783":"flight_path = \"..\/input\/flight-delays\/flights.csv\"\nflight_data = pd.read_csv(flight_path )#, index_col=\"Date\", parse_dates=True)","efdb1ff2":"flight_data","f4197354":"DEPARTURE_features = ['SCHEDULED_DEPARTURE', 'DEPARTURE_TIME', 'DEPARTURE_DELAY']\nflight_data[DEPARTURE_features]","2f6f7e50":"dayOfWeek={1:'Monday', 2:'Tuesday', 3:'Wednesday', 4:'Thursday', 5:'Friday', \n                                           6:'Saturday', 7:'Sunday'}\ndff = df.DAY_OF_WEEK.value_counts()\ndff = dff.to_frame().sort_index()\ndff.index = dff.index.map(dayOfWeek)\n\ntrace1 = go.Bar(\n    x=dff.index,\n    y=dff.DAY_OF_WEEK,\n    name = 'Weather',\n    marker=dict(\n        color = dff.DAY_OF_WEEK,\n        colorscale='Jet',\n        showscale=True\n    )\n)\n\ndata = [trace1]\nlayout = go.Layout(\n    title='# of Flights (Day of Week)', \n    yaxis = dict(title = '# of Flights'\n                                                    )\n)\n\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)","77a3adfd":"TIME_features = ['AIR_TIME', 'TAXI_IN', 'TAXI_OUT', 'ELAPSED_TIME']\nflight_data[TIME_features]","0ecfa59d":"plt.figure(figsize=(12,6))\nsns.lineplot(x= flight_data['DISTANCE'] , y = flight_data['ELAPSED_TIME'] )\n","57ef8fbe":"df = pd.merge(df,airlines, left_on='AIRLINE', right_on = 'IATA_CODE')\ndf.insert(loc=5, column='AIRLINE', value=df.AIRLINE_y)\ndf = df.drop(['AIRLINE_y','IATA_CODE'], axis=1)","04dd61be":"* wheels_off = taxi_out + departure_time\n* wheels_on = air_time + wheels_off\n* arrival_time = taxi_in + wheels_on\n* elapsed_time = air_time + taxi_in + taxi_out","d4c3031c":"**ARRIVAL_DELAY = ARRIVAL_TIME-SCHEDULED_ARRIVAL**"}}