{"cell_type":{"f9b22614":"code","42d9ff7f":"code","96df94af":"code","1900cb54":"code","aaad356a":"code","052197f4":"code","56313521":"code","7225307a":"code","79d88762":"code","f258b666":"code","e5188d43":"code","c686652e":"code","ae979bca":"code","848c0348":"code","a7a0b598":"code","05ec7fe6":"code","4931bd51":"code","d64f2e2a":"code","dbce33aa":"code","2d092945":"code","875e712c":"code","387df890":"code","953a3287":"code","687eedd8":"code","3e11366d":"code","f19212c5":"code","291b11fb":"code","36932202":"code","e401d378":"code","de4a87d8":"code","092e072a":"code","ca180a2c":"code","296f9fe6":"code","43bfa015":"code","253ee5d0":"code","39981be2":"code","e27f3de7":"code","5ab5b95d":"markdown","0ba0093e":"markdown","e0842c66":"markdown","329063bc":"markdown","cc4e5a7e":"markdown","7fb756fa":"markdown"},"source":{"f9b22614":"import pandas as pd\nimport numpy as np\nfrom sklearn.ensemble import RandomForestRegressor as rgs\nimport seaborn as sns\nfrom matplotlib import pyplot as plt\nfrom sklearn.model_selection import train_test_split","42d9ff7f":"df = pd.read_csv('..\/input\/usd-pk5-20192021\/usd_pkr.csv')\n","96df94af":"df1 = pd.read_csv('..\/input\/usd-pk5-20192021\/usd_pkr_2.csv')","1900cb54":"dfnew = pd.concat([df1 ,df])","aaad356a":"dfnew.isnull().sum()","052197f4":"dfnew.dropna(how ='any')","56313521":"\n\ndfnew['Date'] = pd.date_range(start='15-May-2021', end='07-Jun-1999'  , periods =  dfnew.shape[0])\n\n","7225307a":"dfnew['Date'] = pd.to_datetime(df.Date)","79d88762":"dfnew.dtypes","f258b666":"x_ir = dfnew['Change %'].astype(str)\nx_ir = x_ir.replace({'%':''}, regex = True)\ndfnew['Change %'] = x_ir","e5188d43":"y = dfnew.Price","c686652e":"dfnew.dtypes","ae979bca":"features = [ 'Open' , 'High' , 'Low' ,'Change %'  ]","848c0348":"dfnew_X = dfnew[features] ","a7a0b598":"y = dfnew.Price","05ec7fe6":"y","4931bd51":"corrmat = dfnew.corr()\n\ntop_corr_features = corrmat.index\nplt.figure(figsize=(10,10))\ng=sns.heatmap(dfnew[top_corr_features].corr(),annot=True,cmap=\"RdYlGn\")\n\n","d64f2e2a":"X_train, X_test, Y_train, Y_test = train_test_split(dfnew_X,y)\n","dbce33aa":"X_train","2d092945":"Y_train","875e712c":"from sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.metrics import mean_squared_error\n","387df890":"forest_model = RandomForestRegressor(random_state=1)\n","953a3287":"forest_model.fit(X_train, Y_train)\n","687eedd8":"predicts = forest_model.predict(X_test)\n","3e11366d":"predicts","f19212c5":"print(mean_absolute_error(Y_test, predicts))\n","291b11fb":"mean_squared_error(Y_test, predicts)\n","36932202":"fig, ax = plt.subplots()\nax.scatter(Y_test, predicts)\nax.plot([Y_test.min(), Y_test.max()], [Y_test.min(), Y_test.max()], 'k--', lw=2 )\nax.set_xlabel('Actual')\nax.set_ylabel('Predicted')\n\nplt.show()\n","e401d378":"from sklearn.linear_model import LinearRegression\n","de4a87d8":"lm=LinearRegression()\n","092e072a":"lm.fit(X_train, Y_train)\n","ca180a2c":"print(lm.intercept_)","296f9fe6":"print(lm.coef_)","43bfa015":"lm_predicts = lm.predict(X_test)","253ee5d0":"from sklearn.metrics import mean_squared_error\n","39981be2":"lmmse = mean_squared_error(Y_test, lm_predicts)\n","e27f3de7":"plt.scatter(Y_test, predicts)\n","5ab5b95d":"# Random Forest ML Algorithm\n","0ba0093e":"# concat 1999-2019 and 2019-2021\n\n# Cleaning data","e0842c66":"# linear regression \n","329063bc":"Input 2 DATA FILES USD TO PKR 2","cc4e5a7e":"# Feature Engineering--> 3 Methods","7fb756fa":"# HeatMapping\n"}}