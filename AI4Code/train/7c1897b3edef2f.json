{"cell_type":{"6c04694d":"code","46fd4691":"code","83342eaf":"code","e971379d":"code","4c6682b9":"code","bf9c96f6":"code","182985be":"code","e56b4f6f":"code","51cfc501":"code","b0e43c8f":"code","b995d787":"code","a33f3ffa":"code","dd163cd9":"code","9f305227":"code","866597e1":"code","a9a5c361":"code","c24cd5c8":"code","afdbbc01":"code","4f76121c":"code","d5fa8fbb":"code","f72d3b73":"code","72ca2b29":"code","046f0e65":"markdown","237b89fa":"markdown","a8c3d541":"markdown","b5c0deb8":"markdown","3394025a":"markdown","2f9364fb":"markdown","5a57937a":"markdown"},"source":{"6c04694d":"import nltk\nfrom nltk.corpus import stopwords\nfrom nltk.stem import PorterStemmer\nimport re\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score,classification_report,confusion_matrix\nimport seaborn as sns","46fd4691":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","83342eaf":"df=pd.read_csv('\/kaggle\/input\/stockmarket-sentiment-dataset\/stock_data.csv')\ndf.head()","e971379d":"df.shape","4c6682b9":"df.info()","bf9c96f6":"df.isnull().sum()","182985be":"duplicate=df[df.duplicated()]\nduplicate","e56b4f6f":"df['Sentiment'].value_counts()","51cfc501":"sns.countplot(x='Sentiment',data=df)","b0e43c8f":"corpus=[]","b995d787":"for i in range(len(df)):\n    words=df.iloc[i,0]\n    words=re.sub('[^a-zA-Z]',' ',words)\n    words=words.lower()\n    words=words.split()\n    words=[PorterStemmer().stem(word) for word in words if word not in set(stopwords.words('english'))]\n    corpus.append(' '.join(words))","a33f3ffa":"len(corpus)","dd163cd9":"vec=CountVectorizer(max_features=5000)\nX=vec.fit_transform(corpus).toarray()","9f305227":"vec.get_feature_names()[0:20]","866597e1":"X.shape","a9a5c361":"y=df['Sentiment']","c24cd5c8":"X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=42)","afdbbc01":"X_train.shape,y_train.shape,X_test.shape,y_test.shape","4f76121c":"rfc=RandomForestClassifier(n_estimators=250,max_depth=None)\nrfc.fit(X_train,y_train)\ny_pred=rfc.predict(X_test)","d5fa8fbb":"accuracy_score(y_test,y_pred)","f72d3b73":"sns.heatmap(confusion_matrix(y_test,y_pred),annot=True,fmt='.0f')","72ca2b29":"print(classification_report(y_test,y_pred))","046f0e65":"# Understanding the Data","237b89fa":"# Importing Necessary Libraries","a8c3d541":"There is no duplicate entry present in the data","b5c0deb8":"### Data Preprocessing","3394025a":"### Shape of the dataset","2f9364fb":"# Model Creation","5a57937a":"### Check for duplicate entry"}}