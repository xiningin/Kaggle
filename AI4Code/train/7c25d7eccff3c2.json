{"cell_type":{"9d3b36cc":"code","81ef22db":"code","6a72bfd8":"code","e363a19b":"code","cfb0cbf2":"code","b6230f27":"code","f3841434":"code","67791bcb":"code","1f0f4184":"code","dfb80117":"code","8ce59062":"code","a6b36c81":"code","aee77884":"code","19722f52":"code","3610d8f2":"code","b45df896":"code","005c2c39":"code","9142c0f8":"markdown","a3de15b8":"markdown","2d7f80fc":"markdown","014e205b":"markdown","6183cdaf":"markdown","a3fcdd29":"markdown","254ce3c4":"markdown","a368b813":"markdown","fc6e99cc":"markdown","b953b398":"markdown","edd0a3d5":"markdown","e60c86d4":"markdown","f8787661":"markdown","4e540dfc":"markdown","7d3735a1":"markdown","1ee1ea4c":"markdown","8405ad4b":"markdown","32a4c1b0":"markdown","1bd2675c":"markdown","64b5cb10":"markdown"},"source":{"9d3b36cc":"import warnings\nfrom sklearn.exceptions import DataConversionWarning\n# Suppress warnings\nwarnings.filterwarnings(action='ignore', category=DataConversionWarning)\nwarnings.filterwarnings(action='ignore', category=DeprecationWarning)\nwarnings.filterwarnings(action='ignore', category=FutureWarning)","81ef22db":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport os\nfrom sklearn.feature_selection import SelectKBest, f_regression\nfrom sklearn.preprocessing import OneHotEncoder, LabelEncoder, MinMaxScaler, StandardScaler\n\n# Set pandas data display option\npd.set_option('display.max_columns', 100)\npd.set_option('display.max_rows', 500)\n\n# Display all filenames\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","6a72bfd8":"# Load csv data\ntrain = pd.read_csv(\"..\/input\/train.csv\")\ncompe = pd.read_csv(\"..\/input\/test.csv\")\nsample_sub = pd.read_csv(\"..\/input\/sample_submission.csv\")\n\n# All data\ndata  = train.append(compe, sort=False)","e363a19b":"# Columns\nprint(len(data.columns))\ndata.columns","cfb0cbf2":"# Data example\ndata.sample(n=20)","b6230f27":"types = pd.DataFrame(data.dtypes).rename(columns={0: 'type'}).sort_values(by=['type'],ascending=False)\ntypes","f3841434":"# Check missing values\ndef check_missing(df):\n    null_val = df.isnull().sum()\n    percent = 100 * df.isnull().sum()\/len(df)\n    missing_table = pd.concat([null_val, percent], axis=1)\n    col = missing_table.rename(columns = {0 : 'Num', 1 : 'Rate'})\n    return col\n\n# Display columns missing values are under 1%.\nprint(\"Data #\"+str(len(data)))\ncols = check_missing(data)\ntypes.join(cols).sort_values(by=\"Rate\", ascending=False)","67791bcb":"# Drop more than 40% missing variables\ndata.drop(['PoolQC', 'MiscFeature', 'Alley', 'Fence', 'FireplaceQu'], axis=1, inplace = True)","1f0f4184":"# Fill missing data and replace with dummy value\ncategorical_variables_string = \\\n    ['MSZoning', 'Street', 'LotShape', 'LandContour', \n     'Utilities', 'LotConfig', 'LandSlope', 'Neighborhood', \n     'Condition1', 'Condition2', 'BldgType', 'HouseStyle', \n     'RoofStyle', 'RoofMatl', 'Exterior1st', 'Exterior2nd', \n     'MasVnrType', 'ExterQual', 'ExterCond', 'Foundation', \n     'BsmtQual', 'BsmtCond', 'BsmtExposure', 'BsmtFinType1', \n     'BsmtFinType2', 'Heating', 'HeatingQC', 'CentralAir', \n     'Electrical', 'KitchenQual', 'Functional', 'GarageType', \n     'GarageFinish', 'GarageQual', 'GarageCond', 'PavedDrive', \n     'SaleType', 'SaleCondition']\n\nfor v in categorical_variables_string:\n    # Fill NaN with mode\n    data[v] = data[v].fillna(data[v].mode()[0])\n    # One-Hot Encoding\n    data = pd.get_dummies(data, columns=[v], drop_first=True)\n    # Categorize\n    # data[v] = pd.factorize(data[v])[0]","dfb80117":"# There's no missing data\ncategorical_variables_int = \\\n    ['OverallQual', 'OverallCond', 'MoSold']","8ce59062":"# Fill missing data\nnumerical_variavles = \\\n    ['MSSubClass', 'LotFrontage', 'LotArea', 'YearBuilt', \n     'YearRemodAdd', 'MasVnrArea', 'BsmtFinSF1', 'BsmtFinSF2', \n     'BsmtUnfSF', 'TotalBsmtSF', '1stFlrSF', '2ndFlrSF', \n     'LowQualFinSF', 'GrLivArea', 'BsmtFullBath', 'BsmtHalfBath', \n     'FullBath', 'HalfBath', 'BedroomAbvGr', 'KitchenAbvGr', \n     'TotRmsAbvGrd', 'Fireplaces', 'GarageYrBlt', 'GarageCars', \n     'GarageArea', 'WoodDeckSF', 'OpenPorchSF', 'EnclosedPorch', \n     '3SsnPorch', 'ScreenPorch', 'PoolArea', 'MiscVal', 'YrSold']\n\nss = StandardScaler()\nfor v in numerical_variavles:\n    # Fill NaN with mean\n    data[v] = data[v].fillna(data[v].mean())\n    # Standardize values\n    data[v] = ss.fit_transform(data[[v]])","a6b36c81":"# Data example\ndata.sample(n=10)","aee77884":"# Set data\ntrain = data[:1460]\ntest  = data[1460:]","19722f52":"possible_features = train.columns.copy().drop('SalePrice').drop('Id')\n\n# Check feature importances\nselector = SelectKBest(f_regression, len(possible_features))\nselector.fit(train[possible_features], train['SalePrice'])\nscores = -np.log10(selector.pvalues_)\nindices = np.argsort(scores)[::-1]\nprint('Feature importances:')\nfor i in range(len(scores)):\n    print('%.2f %s' % (scores[indices[i]], possible_features[indices[i]]))","3610d8f2":"# Feature params\nfparams = \\\n    ['OverallQual', 'YearBuilt']\n\n# Get params\ntrain_target = train[\"SalePrice\"].values\ntrain_features = train[fparams].values\ntest_features  = test[fparams].values","b45df896":"from sklearn import svm\nfrom sklearn.model_selection import GridSearchCV, train_test_split\n\nsvrgs_parameters = {\n    'kernel': ['rbf'],\n    'C':     [150000,200000,250000],\n    'gamma': [0.004,0.0045,0.005]\n}\n\nsvr_cv = GridSearchCV(svm.SVR(), svrgs_parameters, cv=8, scoring= 'neg_mean_squared_log_error')\nsvr_cv.fit(train_features, train_target)\nprint(\"SVR GridSearch score: \"+str(svr_cv.best_score_))\nprint(\"SVR GridSearch params: \")\nprint(svr_cv.best_params_)","005c2c39":"prediction = svr_cv.best_estimator_.predict(test_features)\npred = pd.DataFrame(pd.read_csv(\"..\/input\/test.csv\")['Id'])\npred['SalePrice'] = prediction\npred.to_csv(\"..\/working\/submission.csv\", index = False)","9142c0f8":"Output prediction result to a file","a3de15b8":"Process numerical variables\n1. Just fill missing data with average\n2. Standardize values","2d7f80fc":"Drop variables more than 40% data was missing..","014e205b":"# Data Pre-Processing <a id=\"pre-processing\"><\/a>","6183cdaf":"There's 81 columns in data","a3fcdd29":"Check what types of data in each columns","254ce3c4":"Check types of each variables","a368b813":"For data pre-processing, categorize variables into 'Numerical Variables', 'Categorical Variables(int)', 'Categorical Variables(string)'  \n  \n**Numerical Variables: **float and int variables  \n['MSSubClass', 'LotFrontage', 'LotArea', 'YearBuilt', 'YearRemodAdd', 'MasVnrArea', 'BsmtFinSF1', 'BsmtFinSF2', 'BsmtUnfSF', 'TotalBsmtSF', '1stFlrSF', '2ndFlrSF', 'LowQualFinSF', 'GrLivArea', 'BsmtFullBath', 'BsmtHalfBath', 'FullBath', 'HalfBath', 'BedroomAbvGr', 'KitchenAbvGr', 'TotRmsAbvGrd', 'Fireplaces', 'GarageYrBlt', 'GarageCars', 'GarageArea', 'WoodDeckSF', 'OpenPorchSF', 'EnclosedPorch', '3SsnPorch', 'ScreenPorch', 'PoolArea', 'MiscVal', 'YrSold']  \n  \n**Categorical Variables(int): **some of int variables  \n['OverallQual', 'OverallCond', 'MoSold']  \n  \n**Categorical Variables(string): **string variables  \n['MSZoning', 'Street', 'Alley', 'LotShape', 'LandContour', 'Utilities', 'LotConfig', 'LandSlope', 'Neighborhood', 'Condition1', 'Condition2', 'BldgType', 'HouseStyle', 'RoofStyle', 'RoofMatl', 'Exterior1st', 'Exterior2nd', 'MasVnrType', 'ExterQual', 'ExterCond', 'Foundation', 'BsmtQual', 'BsmtCond', 'BsmtExposure', 'BsmtFinType1', 'BsmtFinType2', 'Heating', 'HeatingQC', 'CentralAir', 'Electrical', 'KitchenQual', 'Functional', 'FireplaceQu', 'GarageType', 'GarageFinish', 'GarageQual', 'GarageCond', 'PavedDrive', 'PoolQC', 'Fence', 'MiscFeature', 'SaleType', 'SaleCondition']","fc6e99cc":"Check how many data is missing","b953b398":"# Training and Prediction <a id=\"training-prediction\"><\/a>","edd0a3d5":"* [Load Data and Libraries](#load)\n* [Check Data](#check-data)\n* [Data Pre-Processing](#pre-processing)\n* [Training and Prediction](#training-prediction)","e60c86d4":"This time, pick variables by their importances  \n  \n**Possible features(Ordered by importances)**  \n    ['OverallQual', 'GrLivArea', 'GarageCars', 'GarageArea', 'TotalBsmtSF', \n     '1stFlrSF', 'ExterQual_TA', 'FullBath', 'TotRmsAbvGrd', 'YearBuilt', \n     'KitchenQual_TA', 'GarageFinish_Unf', 'YearRemodAdd', 'BsmtQual_TA', \n     'Foundation_PConc', 'MasVnrArea', 'GarageYrBlt', 'Fireplaces', \n     'ExterQual_Gd', 'BsmtFinType1_GLQ', 'Neighborhood_NridgHt', 'BsmtFinSF1', \n     'MasVnrType_None', 'SaleType_New', 'GarageType_Detchd', 'SaleCondition_Partial', \n     'Foundation_CBlock', 'LotFrontage', 'MasVnrType_Stone', 'Neighborhood_NoRidge', \n     'WoodDeckSF', 'KitchenQual_Gd', 'BsmtExposure_No', '2ndFlrSF', 'OpenPorchSF', \n     'HeatingQC_TA', 'BsmtExposure_Gd', 'Exterior2nd_VinylSd', 'Exterior1st_VinylSd', \n     'MSZoning_RM', 'HalfBath', 'LotShape_Reg', 'LotArea', 'CentralAir_Y', 'MSZoning_RL', \n     'HouseStyle_2Story', 'SaleType_WD', 'Electrical_SBrkr', 'RoofStyle_Hip', 'GarageType_BuiltIn', \n     'BsmtQual_Gd', 'GarageType_Attchd', 'PavedDrive_Y', 'BsmtFullBath', 'RoofStyle_Gable', \n     'Neighborhood_StoneBr', 'BsmtUnfSF', 'MasVnrType_BrkFace', 'Neighborhood_OldTown', \n     'Neighborhood_NAmes', 'Neighborhood_Edwards', 'GarageFinish_RFn', 'RoofMatl_WdShngl', \n     'BedroomAbvGr', 'Exterior1st_MetalSd', 'Neighborhood_IDOTRR', 'Exterior2nd_MetalSd', \n     'Exterior2nd_Wd Sdng', 'Exterior1st_Wd Sdng', 'KitchenQual_Fa', 'SaleCondition_Normal', \n     'Neighborhood_BrkSide', 'LotConfig_CulDSac', 'Neighborhood_Somerst', 'ExterCond_Fa', \n     'GarageCond_TA', 'KitchenAbvGr', 'BsmtFinType1_Rec', 'HeatingQC_Gd', 'HeatingQC_Fa', \n     'Exterior1st_CemntBd', 'GarageQual_Fa', 'BsmtFinType1_Unf', 'BsmtFinType1_BLQ', \n     'GarageCond_Fa', 'BsmtQual_Fa', 'EnclosedPorch', 'Neighborhood_Sawyer', 'Exterior2nd_CmentBd', \n     'Electrical_FuseF', 'Neighborhood_Timber', 'LotShape_IR2', 'LandContour_HLS', 'Foundation_Slab', \n     'Condition1_Feedr', 'Functional_Typ', 'ExterQual_Fa', 'BldgType_Duplex', 'Condition1_Norm', \n     'Neighborhood_MeadowV', 'ScreenPorch', 'ExterCond_TA', 'RoofMatl_CompShg', 'Neighborhood_BrDale', \n     'BldgType_Twnhs', 'BldgType_2fmCon', 'GarageQual_TA', 'Exterior1st_HdBoard', 'HouseStyle_SFoyer', \n     'Heating_GasA', 'PoolArea', 'Heating_Grav', 'MSZoning_FV', 'BsmtCond_Gd', 'PavedDrive_P', \n     'HouseStyle_1.5Unf', 'BsmtFinType1_LwQ', 'MSSubClass', 'LotConfig_Inside', 'OverallCond', \n     'Exterior2nd_ImStucc', 'Neighborhood_CollgCr', 'Functional_Min2', 'Neighborhood_Crawfor', \n     'GarageType_CarPort', 'Functional_Maj2', 'Exterior2nd_HdBoard', 'MSZoning_RH', 'Functional_Min1', \n     'Neighborhood_SWISU', 'Neighborhood_Veenker', 'GarageCond_Po', 'HouseStyle_1Story', 'Heating_Wall', \n     'Neighborhood_Mitchel', 'BsmtFinType2_BLQ', 'BsmtFinType2_Unf', 'Neighborhood_ClearCr', \n     'BsmtCond_Po', 'Exterior2nd_Plywood', 'Exterior1st_WdShing', 'Exterior1st_BrkComm', \n     'SaleCondition_AdjLand', 'ExterCond_Gd', 'Condition1_PosN', 'Condition2_PosN', 'Condition2_Feedr', \n     'Electrical_FuseP', 'Condition2_PosA', 'Exterior2nd_Brk Cmn', 'Condition1_RRAe', \n     'SaleCondition_Family', 'MoSold', 'GarageQual_Po', 'LandContour_Low', 'Exterior2nd_Other', \n     'RoofMatl_WdShake', '3SsnPorch', 'BsmtExposure_Mn', 'GarageQual_Gd', 'LandSlope_Mod', \n     'Exterior2nd_Stucco', 'Condition1_PosA', 'SaleType_ConLD', 'SaleType_Con', 'Street_Pave', \n     'Exterior2nd_Wd Shng', 'BsmtFinType2_Rec', 'Condition2_RRNn', 'HouseStyle_SLvl', \n     'Neighborhood_NPkVill', 'BsmtFinType2_LwQ', 'Electrical_Mix', 'LotShape_IR3', 'HouseStyle_2.5Fin', \n     'Exterior1st_Stone', 'Neighborhood_Gilbert', 'RoofStyle_Gambrel', 'SaleType_Oth', 'ExterCond_Po', \n     'Exterior1st_BrkFace', 'HeatingQC_Po', 'Condition2_Norm', 'Exterior1st_Stucco', 'GarageType_Basment', \n     'YrSold', 'LandSlope_Sev', 'LandContour_Lvl', 'SaleType_ConLw', 'Exterior1st_ImStucc', \n     'Exterior1st_AsphShn', 'HouseStyle_2.5Unf', 'Heating_OthW', 'LowQualFinSF', 'Exterior2nd_CBlock', \n     'Exterior1st_CBlock', 'BsmtCond_TA', 'Exterior2nd_BrkFace', 'Exterior2nd_AsphShn', \n     'Neighborhood_NWAmes', 'Condition1_RRNn', 'MiscVal', 'RoofStyle_Shed', 'Neighborhood_Blueste', \n     'Heating_GasW', 'RoofMatl_Membran', 'SaleType_CWD', 'LotConfig_FR3', 'Exterior1st_Plywood', \n     'Functional_Sev', 'BsmtHalfBath', 'Exterior2nd_Stone', 'Functional_Mod', 'SaleCondition_Alloca', \n     'Neighborhood_SawyerW', 'Condition2_RRAn', 'RoofMatl_Roll', 'SaleType_ConLI', 'Utilities_NoSeWa', \n     'Foundation_Stone', 'BsmtFinSF2', 'LotConfig_FR2', 'Condition1_RRAn', 'RoofMatl_Tar&Grv', \n     'Condition1_RRNe', 'BldgType_TwnhsE', 'Condition2_RRAe', 'Foundation_Wood', 'GarageCond_Gd', \n     'RoofStyle_Mansard', 'RoofMatl_Metal', 'BsmtFinType2_GLQ']","f8787661":"To select parameters for training, use feature selection library","4e540dfc":"Data after processing is like this","7d3735a1":"Process categorical variables(int)\n1. Do nothing, because there's no missing data","1ee1ea4c":"# Check Data <a id=\"check-data\"><\/a>","8405ad4b":"Here's just use SVR for prediction, with GridSearch","32a4c1b0":"ref: this notebook has been fork from https:\/\/www.kaggle.com\/himaoka\/house-simple-svr-support-vector-regression","1bd2675c":"# Load Data and Libraries <a id=\"load\"><\/a>","64b5cb10":"Process categorical variables(string)\n1. Fill missing data by most frequent value\n2. One-Hot Encoding"}}