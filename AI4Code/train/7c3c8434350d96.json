{"cell_type":{"149833c6":"code","d24c51f0":"code","140a8a51":"code","4ed33529":"code","a8a77565":"code","f73032f3":"code","0f3c9479":"code","275ecb87":"code","83242240":"code","c73537b5":"code","817aa6dd":"code","ddd515ed":"code","386069a2":"code","73a251a6":"code","a89cb9a7":"code","5b0bfa7f":"code","5f32ffe6":"code","a6844ad7":"code","aecb764b":"code","fb308511":"code","6c5ab27a":"code","0cde8c48":"code","8377c587":"code","fa2bb94c":"code","33e8c649":"code","5ce704a7":"code","ab3b30a3":"code","d6cc2763":"code","599841e8":"code","b77ce82d":"code","70eff369":"code","b6fb0a05":"markdown","5e12a796":"markdown","d09a5b0f":"markdown","43bd3c65":"markdown","715a8402":"markdown","fae2edbd":"markdown","24bb7991":"markdown","4f809f75":"markdown","34b68ed6":"markdown","3137d536":"markdown","8ffed047":"markdown","0cad357a":"markdown","beee9f19":"markdown","f7941f7a":"markdown","bb608e29":"markdown","66aa17b8":"markdown","360694cf":"markdown"},"source":{"149833c6":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","d24c51f0":"df=pd.read_csv(\"..\/input\/wine-reviews\/winemag-data_first150k.csv\")\ndf=df.iloc[:,1:]\ndf.head()","140a8a51":"df.shape","4ed33529":"df.info()","a8a77565":"df.dtypes","f73032f3":"df.describe().T","0f3c9479":"def missing_value_table(df):\n    missing_value = df.isna().sum().sort_values(ascending=False)\n    missing_value_percent = 100 * df.isna().sum()\/\/len(df)\n    missing_value_table = pd.concat([missing_value, missing_value_percent], axis=1)\n    missing_value_table_return = missing_value_table.rename(columns = {0 : 'Missing Values', 1 : '% Value'})\n    cm = sns.light_palette(\"lightgreen\", as_cmap=True)\n    missing_value_table_return = missing_value_table_return.style.background_gradient(cmap=cm)\n    return missing_value_table_return\n  \nmissing_value_table(df)","275ecb87":"df.region_2.unique().size","83242240":"df.region_1.unique().size","c73537b5":"df.designation.unique().size","817aa6dd":"plt.figure(figsize=(15,6))\ndf.dtypes.value_counts().plot.barh();","ddd515ed":"fig,ax=plt.subplots(nrows=1,ncols=2,figsize=(15,7))\nsns.kdeplot(df[\"points\"],shade=True,ax=ax[0]);\nsns.kdeplot(df[\"price\"],shade=True,ax=ax[1]);","386069a2":"sns.pairplot(df)\nsns.set(style=\"ticks\", color_codes=True)","73a251a6":"corr = df.corr()\nplt.figure(figsize=(15,7))\nsns.heatmap(corr, annot=True);","a89cb9a7":"country = df.country.value_counts()[:10]\nplt.figure(figsize=(15,7))\nsns.barplot(x=country.index, y=country.values, palette=\"dark\")\nplt.xticks(rotation='vertical')\nplt.ylabel('Frequency')\nplt.xlabel('Country')\nplt.title('top 10 countries',color = 'darkblue',fontsize=15);","5b0bfa7f":"f, ax = plt.subplots(figsize=(15,7))\nsns.despine(f, left=True, bottom=True)\n\nsns.scatterplot(x=\"points\", y=\"price\",\n                hue=\"price\",\n                palette=\"ch:r=-.2,d=.3_r\",\n                sizes=(1, 8), linewidth=0,\n                data=df, ax=ax);","5f32ffe6":"num_data=pd.DataFrame(df.dtypes[df.dtypes!=\"object\"]).index","a6844ad7":"count = 0\nfig, ax =plt.subplots(nrows=1,ncols=2, figsize=(20,8))\nsns.boxplot(df[num_data[0]],ax=ax[0])\nsns.boxplot(df[num_data[1]],ax=ax[1]);","aecb764b":"lower_and_upper = {}\n\nfor col in num_data:\n    q1 = df[col].quantile(0.25)\n    q3 = df[col].quantile(0.75)\n    iqr = 1.5*(q3-q1)\n    \n    lower_bound = q1-iqr\n    upper_bound = q3+iqr\n    \n    lower_and_upper[col] = (lower_bound, upper_bound)\n    df.loc[(df.loc[:,col]<lower_bound),col]=lower_bound*0.75\n    df.loc[(df.loc[:,col]>upper_bound),col]=upper_bound*1.25\n    \n    \nlower_and_upper","fb308511":"count = 0\nfig, ax =plt.subplots(nrows=1,ncols=2, figsize=(20,8))\nsns.boxplot(df[num_data[0]],ax=ax[0])\nsns.boxplot(df[num_data[1]],ax=ax[1]);","6c5ab27a":"import missingno as msno","0cde8c48":"df.isnull().sum()","8377c587":"msno.bar(df);","fa2bb94c":"msno.matrix(df);","33e8c649":"msno.heatmap(df);","5ce704a7":"df[\"country\"].fillna(df[\"country\"].mode()[0],inplace=True)\ndf[\"province\"].fillna(df[df[\"country\"]==\"US\"][\"province\"].mode()[0],inplace=True)","ab3b30a3":"list_columns=[\"designation\",\"region_1\",\"region_2\",\"variety\",\"winery\"]\nfor i in df[list_columns]:\n    df[i].fillna(df[i].mode()[0],inplace=True)","d6cc2763":"from sklearn.impute import KNNImputer","599841e8":"knn_imputer=KNNImputer()\ndf[\"price\"]=knn_imputer.fit_transform(df[[\"price\"]])","b77ce82d":"msno.bar(df);","70eff369":"df.isnull().sum()","b6fb0a05":"## Content\n* Load and Check Data\n* Variable Description\n* Data Visualization\n* Outliers Detection\n* Missing Value Imputation\n* Missing Value Visualization\n- Fill Missing Value","5e12a796":"1. country : The country that the wine is from.\n2. description : A few sentences from a sommelier describing the wine's taste, smell, look, feel, etc.\n3. designation : The vineyard within the winery where the grapes that made the wine are from.\n4. points : The number of points WineEnthusiast rated the wine on a scale of 1-100 (though they say they only post reviews for wines that score &gt;=80)\n5. price : The cost for a bottle of the wine.\n6. province : The province or state that the wine is from\n7. region_1 : The wine growing area in a province or state (ie Napa)\n8. region_2 : Sometimes there are more specific regions specified within a wine growing area (ie Rutherford inside the Napa Valley), but this value can sometimes be blank\n9. variety : The type of grapes used to make the wine (ie Pinot Noir)","d09a5b0f":"## Missing Value Visualization","43bd3c65":"# Variable Description","715a8402":"# Missing Value","fae2edbd":"# Outlier Data","24bb7991":"## Fill Missing Value","4f809f75":"In statistics, an outlier is a data point that differs significantly from other observations.\n\nOutlier is smaller than Q1-1.5(Q3-Q1) and higher than Q3+1.5(Q3-Q1) .\n\n(Q3-Q1) = IQR (INTER QUARTILE RANGE)\n\nQ3 = Third Quartile(%75)\nQ1 = First Quartile(%25)\ntrain and test separation","34b68ed6":"* Mode Imputation","3137d536":"## Context\n   After watching Somm (a documentary on master sommeliers) I wondered how I could create a predictive model to identify wines through blind tasting like a master sommelier would. The first step in this journey was gathering some data to train a model. I plan to use deep learning to predict the wine variety using words in the description\/review. The model still won't be able to taste the wine, but theoretically it could identify the wine based on a description that a sommelier could give. If anyone has any ideas on how to accomplish this, please post them!","8ffed047":"# Wine Reviews Introduction","0cad357a":"## Target \nIn this dataset, price estimation based on some features.","beee9f19":"![](https:\/\/253qv1sx4ey389p9wtpp9sj0-wpengine.netdna-ssl.com\/wp-content\/uploads\/2015\/01\/GettyImages-80992924-700x461.jpg)","f7941f7a":"* KNN imputation","bb608e29":"# Data Visualization\n","66aa17b8":"# Load and Check Data","360694cf":"* float64(1): price.\n* int64(2): Unnamed: 0, points.\n* object(8): country, description, designation, province, region_1, region_2, variety, winery.\n* number of rows: 150.930\n* number of columns: 11"}}