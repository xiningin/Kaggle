{"cell_type":{"0ce274b5":"code","74a4c97d":"code","e6d8fb2f":"code","05dc397c":"code","b936d787":"code","9567652d":"code","430f9e2c":"code","373c9da2":"code","31516a01":"code","17523f43":"code","f347d762":"code","f9df3694":"code","10732a1e":"code","cadd23c9":"code","2d048c36":"code","602d21f5":"code","ab98f8e2":"code","f229ed12":"code","51b580dd":"code","c4b89d51":"code","fcbd733c":"code","856c07ec":"code","30afaec9":"code","b85d7702":"code","e8d2cb0d":"code","aaeca7c8":"code","cff086f5":"code","63a3f349":"code","b319aed6":"code","e8e8a65f":"markdown","2012cc5a":"markdown","4c9bec04":"markdown","861467cb":"markdown","258879ca":"markdown"},"source":{"0ce274b5":"#Parte 1 Carregando as Bibliotecas B\u00e1sicas\nimport numpy as np\nimport pandas as pd","74a4c97d":"#Parte 2: Carregar a Biblioteca de Gr\u00e1fica\nimport matplotlib.pyplot as plt","e6d8fb2f":"#Parte 3: Carregando a Biblioteca Machine Learning\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import SGDRegressor\nfrom sklearn.neural_network import MLPRegressor","05dc397c":"dataset = pd.read_csv(\"..\/input\/traffic-volume-in-brazils-highway-toll-plazas\/all.csv\",\n                     sep= \";\",\n                     decimal=\",\",\n                     encoding=\"ISO-8859-1\")","b936d787":"dataset.head()","9567652d":"dataset[\"Concessionaria\"].unique()","430f9e2c":"dataset_dutra = dataset[dataset[\"Concessionaria\"] == \"01.Nova Dutra\"]","373c9da2":"dataset_dutra [\"Categoria\"].unique()","31516a01":"dataset_dutra_passeio = dataset_dutra[dataset_dutra[\"Categoria\"] == \"Categoria 1\"]","17523f43":"dataset_dutra_passeio [\"Praca\"].unique()","f347d762":"dataset_dutra_passeio[\"mes_ano\"] = pd.to_datetime(dataset_dutra_passeio[\"mes_ano\"],\n                                                  format=\"%b-%y\")","f9df3694":"dataset_dutra_passeio[\"mes_ano\"]","10732a1e":"dataset_agrupado = dataset_dutra_passeio.groupby([\"mes_ano\"]).sum()","cadd23c9":"dataset_agrupado.head()","2d048c36":"dataset_agrupado[\"m\u00eas\"] = dataset_agrupado.index.month * (dataset_agrupado.index.year - 2009)","602d21f5":"dataset_agrupado[\"m\u00eas\"]","ab98f8e2":"dataset_agrupado","f229ed12":"X = dataset_agrupado[[\"m\u00eas\"]]\nY = dataset_agrupado[[\"Volume_total\"]]\nplt.scatter(X, Y)\nplt.xlabel(\"Meses\")\nplt.ylabel(\"Volume\")","51b580dd":"X = dataset_agrupado[[\"m\u00eas\"]]\nY = dataset_agrupado[[\"Volume_total\"]]\n\n#Fun\u00e7\u00e3o de Normaliza\u00e7\u00e3o \n\nescala = StandardScaler()\nX_norm = escala.fit_transform(X)","c4b89d51":"#Teste e Treino: Dividindo as Fun\u00e7\u00f5es\n\nX_norm_train, X_norm_test, Y_train, Y_test = train_test_split(X_norm, Y, test_size=0.5)","fcbd733c":"#ativando a fun\u00e7\u00e3o MLPRegressor\nrna = MLPRegressor(hidden_layer_sizes=(600, 300, 200, 100, 50),\n                   max_iter=2000,\n                   tol=0.0000001,\n                   solver=\"adam\",\n                   learning_rate_init=0.01,\n                   activation=\"relu\",\n                   learning_rate=\"constant\",\n                   verbose=2)\n\nrna.fit(X_norm_train, Y_train)","856c07ec":"#Fun\u00e7\u00e3o MLPRegressor - come\u00e7ando o processamento\nregress\u00e3o_linear = SGDRegressor(max_iter=500, \n                          eta0=0.01, \n                          tol=0.0000001, \n                          learning_rate=\"constant\", \n                          verbose=1)\nregress\u00e3o_linear.fit(X_norm_train, Y_train)","30afaec9":"#Previs\u00e3o de testes\nY_reg_pred_test = regress\u00e3o_linear.predict(X_norm_test)\nY_rna_pred_test = rna.predict(X_norm_test)","b85d7702":"#Verifica\u00e7\u00e3o dos testes\nX_test = escala.inverse_transform(X_norm_test)\nplt.scatter(X_test, Y_test, alpha=0.5, label=\"Real\")\nplt.scatter(X_test, Y_rna_pred_test, label=\"Redes Neurais\")\nplt.scatter(X_test, Y_reg_pred_test, label=\"Regress\u00e3o\")\nplt.xlabel(\"M\u00eas\")\nplt.ylabel(\"Volume\")\nplt.title(\"Gr\u00e1fico de Volume x m\u00eas\")","e8d2cb0d":"tamanho_dados_mes = X.size","aaeca7c8":"#Dados da regress\u00e3o linear\nX_pred_reg = X\ny_pred_reg = regress\u00e3o_linear.predict(escala.transform(X_pred_reg))\n\nX_pred_futura_reg = np.array([np.arange(tamanho_dados_mes + 1, tamanho_dados_mes + 25)])\nX_pred_futura_reg = X_pred_futura_reg.transpose()\ny_pred_futura_reg = regress\u00e3o_linear.predict(escala.transform(X_pred_futura_reg))","cff086f5":"#Gr\u00e1fico com os dados da regress\u00e3o linear\nplt.scatter(X, Y, label=\"Real\")\nplt.scatter(X_pred_reg, y_pred_reg, label=\"Aproxima\u00e7\u00e3o\")\nplt.scatter(X_pred_futura_reg, y_pred_futura_reg, label=\"Previs\u00e3o\")\nplt.xlabel(\"M\u00eas\")\nplt.ylabel(\"Volume\")\nplt.title(\"Gr\u00e1fico de Volume x M\u00eas - Regress\u00e3o linear\")\nplt.legend(loc=\"upper left\")\nplt.savefig(\".\/GraficoVolumeMesREG.png\", dpi=350)","63a3f349":"#Dados das redes neurais\nX_pred_rna = X\ny_pred_rna = rna.predict(escala.transform(X_pred_rna))\n\nX_pred_futura_rna = np.array([np.arange(tamanho_dados_mes + 1, tamanho_dados_mes + 25)])\nX_pred_futura_rna = X_pred_futura_rna.transpose()\ny_pred_futura_rna = rna.predict(escala.transform(X_pred_futura_rna))","b319aed6":"#Grafico com os dados das redes neurais\nplt.scatter(X, Y, label=\"Real\")\nplt.scatter(X_pred_rna, y_pred_rna, label=\"Aproxima\u00e7\u00e3o\")\nplt.scatter(X_pred_futura_rna, y_pred_futura_rna, label=\"Previs\u00e3o\")\nplt.xlabel(\"M\u00eas\")\nplt.ylabel(\"Volume\")\nplt.title(\"Gr\u00e1fico de Volume x M\u00eas - Redes Neurais\")\nplt.legend(loc=\"upper left\")\nplt.savefig(\".\/GraficoVolumeMesRNA.png\", dpi=350)","e8e8a65f":"# P\u00d3S-PROCESSAMENTO","2012cc5a":"# PROCESSAMENTO","4c9bec04":"# Pr\u00e9-Processamento","861467cb":"# PRE\u00c2MBULO","258879ca":"# Carregamento do Dataset"}}