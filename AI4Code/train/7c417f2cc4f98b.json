{"cell_type":{"7f5decfa":"code","a4dd26df":"code","14fdfae8":"code","f4e6548c":"code","828ce97f":"code","94079557":"code","0cb6bbc2":"code","119843d0":"code","03edae89":"code","1bdcae89":"code","85d334f5":"markdown","fcf11aa6":"markdown"},"source":{"7f5decfa":"import os\nimport datetime as dt\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","a4dd26df":"input_dir = \"..\/input\"\nexamples_dir = os.path.join(input_dir,'cv-data-augmentation-activity-predictors')\nexamples = pd.read_parquet(os.path.join(examples_dir,'positive_negative_examples.parquet.gzip'))","14fdfae8":"examples.shape","f4e6548c":"examples.sample(10)","828ce97f":"network_predictors_1_dir = os.path.join(input_dir,'cv-feature-engineering-network-predictors-1')\nprint(os.listdir(network_predictors_1_dir))","94079557":"network_statistics_map = {'users_users_shared_schools': ['questions_author_id', 'answer_user_id'], \n                          'users_users_shared_tags': ['questions_author_id', 'answer_user_id'], \n                          'users_users_shared_groups': ['questions_author_id', 'answer_user_id'],\n                          'questions_users_shared_tags': ['questions_id', 'answer_user_id']}\n\nfor network_statistics_name in network_statistics_map.keys():\n    print('Considering: {}'.format(network_statistics_name))\n    \n    network_statistics = pd.read_parquet(os.path.join(network_predictors_1_dir,'{}.parquet.gzip'.format(network_statistics_name)))\n\n    print(network_statistics.shape)\n    print(network_statistics.head(3))\n\n    examples = examples.merge(network_statistics, \n                                  on=network_statistics_map[network_statistics_name],\n                                  how='left')\n\n    print('Non empty rows: {}'.format(examples[~pd.isnull(examples[network_statistics.columns[-1]])].shape))\n    print(examples.sample(10))\n    examples[network_statistics.columns[-1]] = examples[network_statistics.columns[-1]].fillna(0)","0cb6bbc2":"examples.shape","119843d0":"examples.sample(10)","03edae89":"examples.to_parquet('positive_negative_examples.parquet.gzip', compression='gzip')","1bdcae89":"os.listdir()","85d334f5":"# I. Loading the Supevised Machine Learning Data Set ##","fcf11aa6":"# II. Loading Network Predictors 1 and Merging Them to the Data Set ##"}}