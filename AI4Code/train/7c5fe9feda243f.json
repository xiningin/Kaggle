{"cell_type":{"f5bfc703":"code","87f254c0":"code","41ad55b9":"code","a0432052":"code","2acae279":"code","9989a7d6":"code","cf8d493c":"code","87e4592f":"code","8b240f7a":"code","f2f7bc9e":"code","dd92ddd5":"code","0beb73bd":"code","493bef91":"code","f0aea020":"code","e0a5de29":"code","83983204":"code","0ab8eea2":"code","6a17427c":"code","53a848e4":"code","74478dbb":"code","b2486bfd":"code","c8548da2":"code","5ac6d9cb":"code","214afa4e":"code","ef3a6d17":"code","fa7f131f":"markdown","525b5ae1":"markdown","44cd713d":"markdown","bb7fc7f5":"markdown","49a79031":"markdown","b92ff576":"markdown","78c069bd":"markdown","593a791d":"markdown","d2525773":"markdown","dc2f4635":"markdown","818ed0ec":"markdown","da0d4b8e":"markdown","4c0e58e8":"markdown","6e981b71":"markdown","3a55d0d1":"markdown","d0c4cbc8":"markdown","56b2f97f":"markdown","b12aec6d":"markdown","2651f298":"markdown","e3a33f2c":"markdown","476d49f6":"markdown"},"source":{"f5bfc703":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","87f254c0":"#Importing all the libraries that I use in this project\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import classification_report\n","41ad55b9":"#Loding data into the kernels \n\nfile_path_with_infertility=\"..\/input\/polycystic-ovary-syndrome-pcos\/PCOS_infertility.csv\"\nfile_path_without_infertility=\"..\/input\/polycystic-ovary-syndrome-pcos\/PCOS_data_without_infertility.xlsx\"\n\nPCOS_inf = pd.read_csv(file_path_with_infertility)\nPCOS_woinf = pd.read_excel(file_path_without_infertility, sheet_name=\"Full_new\")","a0432052":"#Merging the two files as per patient file no. \n#The files were sorted into two based on patients with infertility and without infertility\ndata = pd.merge(PCOS_woinf,PCOS_inf, on='Patient File No.', suffixes={'','_y'},how='left')\n\n#Dropping the repeated features after merging\ndata =data.drop(['Unnamed: 44', 'Sl. No_y', 'PCOS (Y\/N)_y', '  I   beta-HCG(mIU\/mL)_y',\n       'II    beta-HCG(mIU\/mL)_y', 'AMH(ng\/mL)_y'], axis=1)\n\n#Taking a look at the dataset\ndata.head() ","2acae279":"data.info()","9989a7d6":"#Having a look at the data with dtype objects\n\ndata[\"AMH(ng\/mL)\"].head() ","cf8d493c":"#Similarly\n\ndata[\"II    beta-HCG(mIU\/mL)\"].head()","87e4592f":"#Dealing with categorical values.\n#In this database the type objects are numeric values saved as strings.\n#So I am just converting it into a numeric value.\n\ndata[\"AMH(ng\/mL)\"] = pd.to_numeric(data[\"AMH(ng\/mL)\"], errors='coerce')\ndata[\"II    beta-HCG(mIU\/mL)\"] = pd.to_numeric(data[\"II    beta-HCG(mIU\/mL)\"], errors='coerce')\n\n#Dealing with missing values. \n#Filling NA values with the median of that feature.\n\ndata['Marraige Status (Yrs)'].fillna(data['Marraige Status (Yrs)'].median(),inplace=True)\ndata['II    beta-HCG(mIU\/mL)'].fillna(data['II    beta-HCG(mIU\/mL)'].median(),inplace=True)\ndata['AMH(ng\/mL)'].fillna(data['AMH(ng\/mL)'].median(),inplace=True)\ndata['Fast food (Y\/N)'].fillna(data['Fast food (Y\/N)'].median(),inplace=True)\n\n#Clearing up the extra space in the column names (optional)\n\ndata.columns = [col.strip() for col in data.columns]","8b240f7a":"# Having a look at some basic statistical details.\n\ndata.describe()","f2f7bc9e":"#Added in the recent update. \n#This came upon evaluating the dataset some obvious outliers I am not explaining the process I used. \n#Dropping the outliers. \n\ndata = data[(data[\"BP _Diastolic (mmHg)\"]>20)]\ndata = data[(data[\"AMH(ng\/mL)\"]<40)]\ndata = data[(data[\"BP _Systolic (mmHg)\"]>20)]\ndata = data[(data[\"Endometrium (mm)\"]>0)]\ndata = data[(data[\"Avg. F size (R) (mm)\"]>0)]\ndata = data[(data[\"Avg. F size (R) (mm)\"]>0)]\ndata = data[(data[\"RBS(mg\/dl)\"]<200)]\ndata = data[(data[\"PRG(ng\/mL)\"]<20)]\ndata = data[(data[\"Pulse rate(bpm)\"]>20)]\ndata = data[(data[\"FSH(mIU\/mL)\"]<4000)]\ndata = data[(data[\"LH(mIU\/mL)\"]<1500)]\ndata = data[(data[\"Cycle(R\/I)\"]<4.5)]\n\ndata.shape","dd92ddd5":"#Examaning a correlation matrix of all the features \n\ncorrmat = data.corr()\nplt.subplots(figsize=(18,18))\nsns.heatmap(corrmat,cmap=\"Pastel1\", square=True);","0beb73bd":"#How all the features correlate with the PCOS \n\ncorrmat[\"PCOS (Y\/N)\"].sort_values(ascending=False)","493bef91":"#Having a look at features bearing significant correlation\n\nplt.figure(figsize=(12,12))\nk = 12 #number of variables with positive for heatmap\nl = 3 #number of variables with negative for heatmap\ncols_p = corrmat.nlargest(k, \"PCOS (Y\/N)\")[\"PCOS (Y\/N)\"].index \ncols_n = corrmat.nsmallest(l, \"PCOS (Y\/N)\")[\"PCOS (Y\/N)\"].index\ncols = cols_p.append(cols_n) \n\ncm = np.corrcoef(data[cols].values.T)\nsns.set(font_scale=1.25)\nhm = sns.heatmap(cm, cbar=True,cmap=\"Pastel1\", annot=True, square=True, fmt='.2f', annot_kws={'size': 10}, yticklabels=cols.values, xticklabels=cols.values)\nplt.show()","f0aea020":"# Length of menstrual phase in PCOS vs normal \ncolor = [\"teal\", \"plum\"]\nfig=sns.lmplot(data=data,x=\"Age (yrs)\",y=\"Cycle length(days)\", hue=\"PCOS (Y\/N)\",palette=color)\nplt.show(fig)","e0a5de29":"# Pattern of weight gain (BMI) over years in PCOS and Normal. \nfig= sns.lmplot(data =data,x=\"Age (yrs)\",y=\"BMI\", hue=\"PCOS (Y\/N)\", palette= color )\nplt.show(fig)","83983204":"# cycle IR wrt age \nsns.lmplot(data =data,x=\"Age (yrs)\",y=\"Cycle(R\/I)\", hue=\"PCOS (Y\/N)\",palette=color)\nplt.show()","0ab8eea2":"# Distribution of follicles in both ovaries. \nsns.lmplot(data =data,x='Follicle No. (R)',y='Follicle No. (L)', hue=\"PCOS (Y\/N)\",palette=color)\nplt.show()","6a17427c":"features = [\"Follicle No. (L)\",\"Follicle No. (R)\"]\nfor i in features:\n    sns.swarmplot(x=data[\"PCOS (Y\/N)\"], y=data[i], color=\"black\", alpha=0.5 )\n    sns.boxenplot(x=data[\"PCOS (Y\/N)\"], y=data[i], palette=color)\n    plt.show()","53a848e4":"features = [\"Age (yrs)\",\"Weight (Kg)\", \"BMI\", \"Hb(g\/dl)\", \"Cycle length(days)\",\"Endometrium (mm)\" ]\nfor i in features:\n    sns.swarmplot(x=data[\"PCOS (Y\/N)\"], y=data[i], color=\"black\", alpha=0.5 )\n    sns.boxenplot(x=data[\"PCOS (Y\/N)\"], y=data[i], palette=color)\n    plt.show()","74478dbb":"#Assiging the features (X)and target(y)\n\nX=data.drop([\"PCOS (Y\/N)\",\"Sl. No\",\"Patient File No.\"],axis = 1) #droping out index from features too\ny=data[\"PCOS (Y\/N)\"]\n\n#Splitting the data into test and training sets\n\nX_train,X_test, y_train, y_test = train_test_split(X,y, test_size=0.3) ","b2486bfd":"#Fitting the RandomForestClassifier to the training set\n\nrfc = RandomForestClassifier()\nrfc.fit(X_train, y_train)\n\n#Making prediction and checking the test set\n\npred_rfc = rfc.predict(X_test)\naccuracy = accuracy_score(y_test, pred_rfc)\nprint(accuracy)","c8548da2":"#Building a dictionalry with list of optional values that will me analyesed by GridSearch CV\n\nparameters = { \n    'n_estimators': [100,150, 200,500,700],\n    'max_features': ['auto', 'sqrt', 'log2'],\n    'max_depth' : [4,5,6,7,8,9,10,12],\n    'criterion' :['gini', 'entropy'],\n    'n_jobs':[-1,1,None]\n}\n\n#Fitting the trainingset to find parameters with best accuracy\n\nCV_rfc = GridSearchCV(estimator=rfc, param_grid=parameters, cv= 7)\nCV_rfc.fit(X_train, y_train)\n\n#Getting the outcome of gridsearch\n\nCV_rfc.best_params_","5ac6d9cb":"#Fitting the model with selected parameters\n\nrfc1=RandomForestClassifier(**CV_rfc.best_params_)\nrfc1.fit(X_train, y_train)\n\n#Testing the Model on test set\n\npredictions=rfc1.predict(X_test)\nacccuracy_final = accuracy_score(y_test,predictions)\n\nacccuracy_final","214afa4e":"classi_report = classification_report(y_test, predictions)\nprint(classi_report)","ef3a6d17":"# cofusion matrix\nplt.subplots(figsize=(15,5))\ncf_matrix = confusion_matrix(y_test, predictions)\nsns.heatmap(cf_matrix\/np.sum(cf_matrix), annot = True, annot_kws = {'size':15}, cmap = 'Pastel1')","fa7f131f":" **<span style=\"color:teal;\"> Fitting the Model <\/span>**\n \nFitting a rather vanilla modle as base model ","525b5ae1":"The number of follicles in women with PCOS is higher, as expected. And are unequal as well. \n \n**<span style=\"color:teal;\"> Some Miscellaneous EDA <\/span>**","44cd713d":"**<span style=\"color:teal;\"> Classification Report & Confusion Matrix <\/span>**","bb7fc7f5":"The mensural cycle becomes more regular for normal cases with age. Whereas, for PCOS the irregularity increases with age.\n\n **<span style=\"color:teal;\"> Number Of Follicles <\/span>**","49a79031":"**<span style=\"color:teal;\"> Polycystic Ovary Syndrome (PCOS) <\/span>** Polycystic Ovary Syndrome (PCOS) is a health problem that affects women of childbearing age. Women with PCOS have a hormonal imbalance and metabolism problems that may affect their overall health.\n\nPCOS manifests as a variety of symptoms \n\n![Orange%20and%20Blue%20Freeform%20Health%20Facebook%20Cover%20%281%29.png](attachment:Orange%20and%20Blue%20Freeform%20Health%20Facebook%20Cover%20%281%29.png)\n\nFor more information on PCOS visit ([here](https:\/\/www.webmd.com\/women\/what-is-pcos))","b92ff576":"Body mass index (BMI) is showing consistency for normal cases. Whereas for PCOS the BMI increases with age.\n\n **<span style=\"color:teal;\"> Patterns Of Irregularity In Mensuration  <\/span>**\n\n*There is no clarity on what this feature and its values indicate but, *\n\n**Apparently in the feature \"Cycle(R\/I)\" value:**\n\n**4** indicates irregular menstrual cycle \n\n**2** indicates a regular menstrual cycle","78c069bd":"**<span style=\"color:teal;\"> Merging the two files as per patient file no. and dropping the repeated features<\/span>**","593a791d":"Everything looks alright we can work with this.\n\nWe have a dataset of shape 5 rows \u00d7 44 columns.\n\nLet's head up to the next step and have a further look at the data.","d2525773":" # <p style=\"background-color:teal;font-family:newtimeroman;color:white;font-size:120%;text-align:center;border-radius:20px 60px;\">Exploratory Data Analysis<\/p>\n\n\n**Steps involved in EDA**\n* Feature selection based on the correlation factor \n* Patterns Of Length Of The Menstrual Cycle\n* Patterns Of BMI \n* Patterns Of Irregularity In Mensuration \n* Number of Follicles\n* Some Miscellaneous EDA\n\n\n**<span style=\"color:teal;\"> Let's explore features <\/span>**","dc2f4635":"After having a look at this info we may conclude that:\n\n* Some numeric data are saved as strings.\n* There are some missing values. Namely, Marriage Status (Yrs)& Fast food (Y\/N)","818ed0ec":" # <p style=\"background-color:teal;font-family:newtimeroman;color:white;font-size:120%;text-align:center;border-radius:20px 60px;\">Model Building<\/p>\n\n**Steps involved in Model Building:**\n\n* Assigning values to features as X and target as y\n* Split test and training sets\n* Fitting a vanilla model as the base Random Forest model\n* Hyperparameter tuning using GridSearch CV\n* Fitting the final model \n* Evaluating the confusion matrix\n* Evaluating the classification report","da0d4b8e":"# <p style=\"background-color:teal;font-family:newtimeroman;color:white;font-size:120%;text-align:center;border-radius:20px 60px;\">Importing Libraries<\/p>\n","4c0e58e8":"The length of the menstrual phase is overall consistent over different ages for normal cases. Whereas in the case of PCOD the length increased with age. \n\n **<span style=\"color:teal;\"> Patterns Of BMI <\/span>**","6e981b71":"**<span style=\"color:teal;\"> If you liked this Notebook, please do upvote.<\/span>**\n\n**<span style=\"color:teal;\"> If you have any suggestions or questions, I am all ears!<\/span>**\n\n**<span style=\"color:teal;\">Best Wishes!<\/span>**\n\n# <p style=\"background-color:teal;font-family:newtimeroman;color:white;font-size:120%;text-align:center;border-radius:20px 60px;\">END<\/p>","3a55d0d1":"**<span style=\"color:teal;\"> Encoding categorical variables (dtype objects)<\/span>**","d0c4cbc8":"# <p style=\"background-color:teal;font-family:newtimeroman;color:white;font-size:120%;text-align:center;border-radius:20px 60px;\">POLYCYSTIC OVARY SYNDROME (PCOS): DIAGNOSIS<\/p>\n\n![Orange%20and%20Blue%20Freeform%20Health%20Facebook%20Cover.png](attachment:Orange%20and%20Blue%20Freeform%20Health%20Facebook%20Cover.png)","56b2f97f":"The distribution of follicles in both ovaries Left and Right are not equal for women with PCOS in comparison with the \"Normal\" patient. \nThia is curious let's exlore it with boxen plot. ","b12aec6d":"# <p style=\"background-color:teal;font-family:newtimeroman;color:white;text-align:center;font-size:120%;border-radius:20px 60px;\">Table Of Contents<\/p>\n\n* **Importing Library**\n* **Loading data**\n* **Data Preprocessing**\n* **Data Visualization**\n* **Model Building**\n  ","2651f298":" # <p style=\"background-color:teal;font-family:newtimeroman;color:white;font-size:120%;text-align:center;border-radius:20px 60px;\">Data Preprocessing<\/p>\n\n**Steps involved in Data Preprocessing:**\n\n* Merging the two files that are sorted into two based on patients with infertility and without infertility\n\n* Dropping the repeated features\n \n* Encoding categorical variables (dtype objects)\n\n* Dealing with missing values \n","e3a33f2c":" **<span style=\"color:teal;\"> Patterns Of Length Of The Menstrual Cycle <\/span>**","476d49f6":" # <p style=\"background-color:teal;font-family:newtimeroman;color:white;font-size:120%;text-align:center;border-radius:20px 60px;\">Loading Data<\/p>\n \n **About the data:**\n\n* This dataset contains all physical and clinical parameters to determine PCOS and infertility related issues. There are a total of 44 parameters. \n\n* This data is collected from 10 different hospitals across Kerala, India.\n\n* The unit used is feet to cm\n\n* Blood pressure entered as systolic and diastolic separately\n\n* RBS means Random glucose test\n\n* Beta-HCG cases are mentioned as Case I and II\n\n* Blood Group indications: A+ = 11, A- = 12, B+ = 13, B- = 14, O+ =15, O- = 16, AB+ =17, AB- = 18\n"}}