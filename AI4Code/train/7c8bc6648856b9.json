{"cell_type":{"d3d9c273":"code","6f25bb9d":"code","76be9eee":"code","95a23fe3":"code","48bbe67e":"code","7db46437":"code","e62a210a":"code","69e816cb":"code","aaf3357e":"code","aa5112a6":"code","75a6e1a7":"code","1002f0de":"code","629d2f38":"markdown","8d17f3d0":"markdown","c5d4cf59":"markdown","6bcc6f69":"markdown","99a432fb":"markdown","9fba6cbb":"markdown","fe4ad3a7":"markdown","71fbbfc3":"markdown"},"source":{"d3d9c273":"import numpy as np\nimport pandas as pd \nimport h2o\nfrom h2o.automl import H2OAutoML","6f25bb9d":"TRAIN_PATH = \"..\/input\/tabular-playground-series-dec-2021\/train.csv\"\nTEST_PATH = \"..\/input\/tabular-playground-series-dec-2021\/test.csv\"\nSAMPLE_SUBMISSION_PATH = \"..\/input\/tabular-playground-series-dec-2021\/sample_submission.csv\"\nSUBMISSION_PATH = \"submission.csv\"\n\nTARGET = \"Cover_Type\"\nID = \"Id\"\nSEED = 2021\nMAX_RUNTIME_SECS = 60 * 20","76be9eee":"h2o.init()","95a23fe3":"# load data\ntrain = h2o.import_file(TRAIN_PATH)\ntest = h2o.import_file(TEST_PATH)","48bbe67e":"train.columns","7db46437":"x = train.columns\ny = TARGET\n\nx.remove(y)\nx.remove(ID) #remove id  ","e62a210a":"aml_y = H2OAutoML(max_runtime_secs=MAX_RUNTIME_SECS, seed=SEED)\naml_y.train(x=x, y=y, training_frame=train)","69e816cb":"preds_y = aml_y.predict(test)","aaf3357e":"submission = pd.read_csv(SAMPLE_SUBMISSION_PATH)\nsubmission[TARGET] = (preds_y.as_data_frame().predict- 0.5).astype(int) + 1\nsubmission.to_csv(SUBMISSION_PATH, index=False)","aa5112a6":"submission.tail(100)","75a6e1a7":"# a = 1 if i<100 else 2 if i>100 else 0","1002f0de":"[for item in preds_y.as_data_frame().predict 2 if item >= 2 else 2 if preds_y.as_data_frame().predict >=1 else 1]","629d2f38":"# split data","8d17f3d0":"# submit prediction result","c5d4cf59":"# load data","6bcc6f69":"# import libraries","99a432fb":"# init h20","9fba6cbb":"# build model","fe4ad3a7":"# predict test data","71fbbfc3":"# define variable"}}