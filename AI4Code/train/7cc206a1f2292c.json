{"cell_type":{"45089f9d":"code","9c479dbd":"code","54b7398f":"code","9661c383":"code","ad493391":"code","759812be":"code","5ca89bb1":"code","77b860b0":"code","40b8558f":"code","ab7b235e":"code","cc3763fd":"code","632c9d24":"code","200b92c4":"code","2a66764b":"markdown"},"source":{"45089f9d":"from keras.models import Sequential\nfrom keras.layers import Dense\nfrom numpy import loadtxt\nimport tensorflow as tf\n\nimport keras\nimport pandas as pd\nimport numpy as np\nimport riiideducation\n\n# You can only call make_env() once, so don't lose it!\n#env = riiideducation.make_env()","9c479dbd":"questions = pd.read_csv(\"..\/input\/userquestions-dataframes-csv\/questions_dataframe.csv\")\nusers = pd.read_csv(\"..\/input\/userquestions-dataframes-csv\/users_dataframe.csv\")","54b7398f":"users","9661c383":"model = keras.models.load_model(\"..\/input\/model2\/wholedatamodel_5layers_256r_128r_64r_32r_1s_lr.00001.h5\")","ad493391":"#p = np.array([1.20100000e+04,8.30090791e-01,7.09174841e-01,1,0])","759812be":"#p = p.reshape(-1,1)","5ca89bb1":"#p.shape","77b860b0":"#model.predict([ 5.69200000e+03,  0.00000000e+00,  0.00000000e+00,\n#         7.45494879e-01,  6.95652174e-01])","40b8558f":"model.summary()","ab7b235e":"feature_list = ['content_id','prior_question_elapsed_time','prior_question_had_explanation', 'question_correct_ratio','student_correct_ratio']","cc3763fd":"def prepare_test_features(test_df,feature_list):\n    ['content_id','prior_question_elapsed_time','prior_question_had_explanation', 'question_correct_ratio','student_correct_ratio']\n    \n        \n    test_df = pd.merge(test_df,questions[['content_id', 'question_correct_ratio']],how='left',on='content_id')\n    test_df = pd.merge(test_df,users[['user_id','student_correct_ratio']],how='left',on='user_id')\n    test_df['prior_question_elapsed_time'].fillna(-1,inplace = True)\n    test_df['prior_question_had_explanation'] *= 1 # convert from boolean to numbers\n    test_df['prior_question_had_explanation'].fillna(-1,inplace = True)\n    test_df.fillna(-1,inplace = True)\n    return test_df[feature_list].to_numpy().astype(float)","632c9d24":"env = riiideducation.make_env()\niter_test = env.iter_test()","200b92c4":"for (test_df, sample_prediction_df) in iter_test:\n    test_questions = test_df['content_id'].to_numpy()\n    #print(\"test_questions: \", test_questions)\n    test_users = test_df['user_id'].to_numpy()\n    #print(\"test_users: \", test_users)\n    test_set = prepare_test_features(test_df,feature_list)\n    #print(\"test_set: \", test_set)\n    answered_correctly = model.predict_classes(test_set)\n    #print(\"answered_correctly: \", answered_correctly)\n    #answered_correctly = clf.predict(test_set)\n    test_df['answered_correctly'] = answered_correctly\n    env.predict(test_df.loc[test_df['content_type_id']==0,['row_id','answered_correctly']])","2a66764b":"## In-depth Introduction\nFirst let's import the module and create an environment."}}