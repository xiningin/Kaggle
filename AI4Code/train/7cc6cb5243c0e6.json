{"cell_type":{"461809e1":"code","b439d6a7":"code","90c9b9fe":"code","908099fc":"code","cbabe5fa":"code","79fcca3b":"code","aae5a9e9":"code","327213f5":"code","579c5cd2":"code","d13140c7":"code","bd537c0e":"code","21aa5955":"code","53439098":"code","fcbf5d9b":"code","d6f9c544":"code","f86fce0f":"code","415544e8":"code","f266d1d6":"code","e59188da":"code","a3eee0cc":"code","9fa63561":"code","4d4c5d3f":"code","4956c473":"code","047d0345":"code","4d6f8323":"code","000be33e":"code","43922989":"code","01ca7d19":"code","b98fc233":"code","4a901f7c":"code","bf457c27":"code","f559b7d1":"code","82f22033":"code","9ecd392f":"code","619ed1c1":"code","e628375c":"code","65c6f7c1":"code","10fbecb2":"code","c1be8924":"code","9b49130d":"code","4b24360b":"code","8d006cdd":"code","0b9e3fd5":"code","c451e132":"code","219f0f0c":"markdown","2381daf0":"markdown","109030cb":"markdown","1f96bd88":"markdown","beffa8bd":"markdown"},"source":{"461809e1":"!pip install git+https:\/\/github.com\/darecophoenixx\/wordroid.sblo.jp","b439d6a7":"from som import som","90c9b9fe":"%matplotlib inline\nfrom IPython.display import SVG\nfrom keras.utils.vis_utils import model_to_dot","908099fc":"import random\n\nimport numpy as np\nimport pandas as pd\nfrom sklearn import datasets\nfrom sklearn.datasets import load_digits\nfrom sklearn import preprocessing\nfrom sklearn.decomposition import PCA\nfrom sklearn.metrics import f1_score, classification_report, confusion_matrix, roc_auc_score\nfrom sklearn.model_selection import train_test_split\n\nfrom keras.utils import to_categorical\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns","cbabe5fa":"from sklearn.datasets.california_housing import fetch_california_housing","79fcca3b":"cal_housing = fetch_california_housing()","aae5a9e9":"X_train, X_test, y_train, y_test = train_test_split(cal_housing.data,\n                                                    cal_housing.target,\n                                                    test_size=0.2,\n                                                    random_state=1)","327213f5":"names = cal_housing.feature_names","579c5cd2":"X_train[:3]","d13140c7":"sns.distplot(X_train[:,0])","bd537c0e":"sns.distplot(np.log(X_train[:,0]))","21aa5955":"sns.distplot(X_train[:,1])","53439098":"sns.distplot(X_train[:,2])","fcbf5d9b":"sns.distplot(np.log(X_train[:,2]))","d6f9c544":"sns.distplot(X_train[:,3])","f86fce0f":"sns.distplot(np.log(X_train[:,3]))","415544e8":"sns.distplot(X_train[:,4])","f266d1d6":"sns.distplot(np.log(X_train[:,4]))","e59188da":"sns.distplot(X_train[:,5])","a3eee0cc":"sns.distplot(np.log(X_train[:,5]))","9fa63561":"sns.distplot(X_train[:,6])","4d4c5d3f":"sns.distplot(X_train[:,7])","4956c473":"sns.distplot(y_train)","047d0345":"sns.distplot(np.log(y_train))","4d6f8323":"y_train","000be33e":"import sklearn\nsklearn.__version__","43922989":"pt = preprocessing.PowerTransformer()","01ca7d19":"pt.fit(np.c_[cal_housing.target, cal_housing.data])","b98fc233":"Xy_sc = pt.transform(np.c_[cal_housing.target, cal_housing.data])\nXy_sc.shape","4a901f7c":"pt.inverse_transform(Xy_sc)[:3]","bf457c27":"df = pd.DataFrame(Xy_sc)\nsns.pairplot(df)","f559b7d1":"y_sc = Xy_sc[:,0]\ny_sc.shape","82f22033":"X_sc = Xy_sc[:,1:]\nX_sc.shape","9ecd392f":"sobj = som.SomRegressor((20, 30), it=(15,1500), r2=(1.5,0.5), verbose=2, alpha=1.5)\nsobj","619ed1c1":"sobj.fit(X_sc, y_sc)","e628375c":"lw = 2\nplt.plot(np.arange(len(sobj.sksom.meanDist)), sobj.sksom.meanDist, label=\"mean distance to closest landmark\",\n             color=\"darkorange\", lw=lw)\nplt.legend(loc=\"best\")","65c6f7c1":"sobj.predict(X_sc)","10fbecb2":"np.c_[y_sc, sobj.predict(X_sc)]","c1be8924":"df = pd.DataFrame(np.c_[y_sc, sobj.predict(X_sc)])\ndf.columns = ['col1', 'col2']\ndf.head()\nsns.lmplot(\"col1\", \"col2\", data=df, fit_reg=False, size=8, scatter_kws={'alpha': 0.5})","9b49130d":"df = pd.DataFrame(np.c_[cal_housing.target, pt.inverse_transform(np.c_[sobj.predict(X_sc), X_sc])[:,0]])\ndf.columns = ['col1', 'col2']\ndf.head()\nsns.lmplot(\"col1\", \"col2\", data=df, fit_reg=False, size=8, scatter_kws={'alpha': 0.5})","4b24360b":"img = som.conv2img(sobj.sksom.landmarks_, (20, 30), target=[0,1,2])\nplt.figure(figsize=(10, 10))\nplt.imshow(img)","8d006cdd":"img = som.conv2img(sobj.sksom.landmarks_, (20, 30), target=[3,4,5])\nplt.figure(figsize=(10, 10))\nplt.imshow(img)","0b9e3fd5":"img = som.conv2img(sobj.sksom.landmarks_, (20, 30), target=[6,7,8])\nplt.figure(figsize=(10, 10))\nplt.imshow(img)","c451e132":"df1= pd.DataFrame(sobj.sksom.landmarks_)\ndf1['cls'] = 'K'\ndf1.head()\ndf2 = pd.DataFrame(Xy_sc)\ndf2['cls'] = 'X'\ndf2.head()\ndf = pd.concat([df2, df1], axis=0)\ndf.head()\ndf.shape\nsns.pairplot(df, markers=['s', '.'], hue='cls', plot_kws={'alpha': 0.3}, diag_kind='hist')","219f0f0c":"## scale","2381daf0":"[SomClassifier (Iris Moon Digit8)](https:\/\/www.kaggle.com\/wordroid\/somclassifier-iris-moon-digit8)","109030cb":"## california_housing","1f96bd88":"### train","beffa8bd":"### y vs y_predicted"}}