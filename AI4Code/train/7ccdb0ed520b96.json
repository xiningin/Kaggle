{"cell_type":{"616604ed":"code","34fd2a5a":"code","2f481165":"code","0ada5bf7":"code","8ff4ae97":"code","24adf075":"code","6c9a5067":"code","1fec58f1":"code","cc2e7cf8":"code","f012d7eb":"code","9ed7181c":"code","74cfbb7f":"code","462887a9":"code","54804f79":"code","cf1f55ea":"code","e929e0c8":"code","48ce5f59":"code","ef5ae09b":"code","88a3f546":"markdown","dde7821e":"markdown","18d75e77":"markdown","e1007278":"markdown","d673c488":"markdown","705c9227":"markdown","18f81709":"markdown","2a6a2d49":"markdown"},"source":{"616604ed":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom collections import Counter\n\nsns.set(rc={'figure.figsize':(14,10)})","34fd2a5a":"df = pd.read_csv('..\/input\/cooking-ingredients\/train.csv')\ndf.head()","2f481165":"# number of ingredients\nnr_ingredients = len(df.iloc[:,0])\n\nfeatures = df.iloc[:, 1:nr_ingredients]\nlabels = df.iloc[:, 0]\n\nnr_ingredients = len(df.columns) - 1\nprint(\"Number of igredients: \", nr_ingredients)","0ada5bf7":"def draw_barplot(x, y, title):\n    ax = sns.barplot(x=x, y=y)\n    ax.title.set_position([.5, 1.05])\n    ax.yaxis.labelpad = 25\n    ax.xaxis.labelpad = 25\n    ax.set_title(title, fontsize = 20)\n    ax.set_ylabel('Ingredients', fontsize = 16)\n    ax.set_xlabel('Recipes', fontsize = 16)\n    ax.tick_params(labelsize=16)","8ff4ae97":"ingredients_ascending = features.sum().sort_values(ascending=False)","24adf075":"draw_barplot(x=ingredients_ascending[:20].values, y=ingredients_ascending[:20].keys().values, title=\"Top used ingredients\")","6c9a5067":"# get the mean line\nmean = ingredients_ascending.mean()\n\n# get the indexes in the range of 5%\nidx = np.where((ingredients_ascending.values < (mean + mean * 0.05)) & (ingredients_ascending.values > (mean - mean * 0.05)))[0]\n\n# get the mean ingredients\nmean_ingredients = ingredients_ascending.iloc[idx]","1fec58f1":"draw_barplot(x=mean_ingredients.values, y=mean_ingredients.keys().values, title=\"Average used ingredients\")","cc2e7cf8":"ingredients_descending = features.sum().sort_values(ascending=True)","f012d7eb":"draw_barplot(x=ingredients_descending[:20].values, y=ingredients_descending[:20].keys().values, title=\"Less used ingredients\")","9ed7181c":"top_ten_idx = list(features.sum(axis=1).sort_values(ascending=False).index)[:10]","74cfbb7f":"print(\"Receipes with most ingredients:\")\nfor i,recipe in enumerate(labels[top_ten_idx].values):\n    print('{0}. {1}'.format(i + 1, recipe))","462887a9":"def get_most_frequent_ingredients(df, nr):\n    idxes = []\n    for nr in range(len(df)):\n        arr = np.where(df == 1.0)\n        nr_idx = np.where(arr[0] == nr)[0]\n        ids = arr[1][nr_idx]\n        idxes.append(ids)\n\n    flat_idxes = np.concatenate(idxes)\n    count = Counter(flat_idxes)\n    freqs = np.array([[freq[0], freq[1]] for freq in count.most_common(nr)])\n    return idxes, freqs","54804f79":"freq_idxes, frequencies = get_most_frequent_ingredients(features.iloc[top_ten_idx], 5)","cf1f55ea":"x = np.arange(len(labels[frequencies[:,0]].values))\ny = frequencies[:,1]\nhue = features.columns[frequencies[:, 0]]","e929e0c8":"ax = sns.barplot(x=x, y=y, hue=hue)\nax.title.set_position([.5, 1.05])\nax.yaxis.labelpad = 25\nax.xaxis.labelpad = 25\nax.set_title('Most frequent ingredients', fontsize = 20)\nax.set_ylabel('Frequency', fontsize = 16)\nax.set_xlabel('Recipes', fontsize = 16)\nax.tick_params(labelsize=16)","48ce5f59":"ingredients = features.columns.values[np.where(features.iloc[top_ten_idx[0]] == 1.0)[0]]","ef5ae09b":"fig, ax = plt.subplots(figsize=(15, 15), subplot_kw=dict(aspect=\"equal\"))\n\ndata = np.arange(len(ingredients))\ningredients = ingredients\n\n\ndef func(pct, allvals):\n    absolute = int(pct\/100.*np.sum(allvals))\n    return \"{:.1f}%\".format(pct, absolute)\n\n\nwedges, texts, autotexts = ax.pie(data, autopct=lambda pct: func(pct, data),\n                                  textprops=dict(color=\"w\"))\n\nlegend = ax.legend(wedges, ingredients,\n          title=\"Ingredients\",\n          loc=\"center left\",\n          fontsize=15,\n          bbox_to_anchor=(1, 0, 0.5, 1))\n\nplt.setp(legend.get_title(),fontsize=15, weight=\"bold\")\n\nplt.setp(autotexts, size=8, weight=\"bold\")\n\nax.set_title(\"Crab Cake Benedict with Old Bay Hollandaise on Johnnycakes\", fontsize=15, weight=\"bold\")\n\nplt.show()","88a3f546":"# Receipes with most ingredients","dde7821e":"# Prepare Data","18d75e77":"# Less used ingredients","e1007278":"# Average used ingredients","d673c488":"<h1 align=center style=\"color:black;border: 1px dotted red;\">Recipes by ingredients<\/h1>","705c9227":"![our-ingredients-side.png](attachment:our-ingredients-side.png)","18f81709":"# Top ingredients","2a6a2d49":"# Analysis for most ingredient recipe\n**Recipe**: Crab Cake Benedict with Old Bay Hollandaise on Johnnycakes"}}