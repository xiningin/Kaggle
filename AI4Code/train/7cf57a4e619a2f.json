{"cell_type":{"d0a9681f":"code","51bb6935":"code","866faa71":"code","b3eb5b32":"code","c4a62fb2":"code","fe2667d9":"code","973744cf":"code","2714c142":"code","3118556c":"code","3aa9a146":"code","e7bc3c72":"code","401f495b":"code","4b098ca5":"code","a80951fb":"code","52b83d3c":"code","a4f02ccd":"code","c7901863":"code","49413723":"code","e372f722":"code","b584e975":"code","d7d62997":"code","53baa97d":"code","06553be1":"code","70fee776":"code","937d2cb1":"code","80a0775b":"code","7f19f503":"code","76dd3c29":"code","f2102cd0":"code","24eab5a0":"code","eafca2af":"code","18b6aba1":"code","d1738f85":"code","65ddef47":"code","64fbbe75":"markdown","84fcee09":"markdown","92cd47f5":"markdown","26c2aad5":"markdown","e2af476e":"markdown","f7c8d3b1":"markdown","7ae7ffa8":"markdown","1a22a7a5":"markdown","d220844b":"markdown","471e92eb":"markdown"},"source":{"d0a9681f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","51bb6935":"df = pd.read_csv(r'\/kaggle\/input\/ccdata\/CC GENERAL.csv')","866faa71":"df.head()","b3eb5b32":"df.drop('CUST_ID',axis=1,inplace=True)","c4a62fb2":"df.shape","fe2667d9":"df.info()","973744cf":"df.isnull().sum()","2714c142":"df['MINIMUM_PAYMENTS'].describe()","3118556c":"df['MINIMUM_PAYMENTS'].fillna(df['MINIMUM_PAYMENTS'].mean(),inplace=True)","3aa9a146":"df['CREDIT_LIMIT'].describe()","e7bc3c72":"df['CREDIT_LIMIT'].fillna(df['CREDIT_LIMIT'].mean(),inplace=True)","401f495b":"df.isnull().sum()","4b098ca5":"import matplotlib.pyplot as plt\nimport seaborn as sns\ncorr=df.corr()\ntop_features=corr.index\nplt.figure(figsize=(20,20))\nsns.heatmap(df[top_features].corr(),annot=True)","a80951fb":"df.drop(['PURCHASES','PURCHASES_FREQUENCY','CASH_ADVANCE_FREQUENCY'],axis=1,inplace=True)","52b83d3c":"fig, ax = plt.subplots(figsize=(15,10))\nsns.boxplot(data=df, width= 0.5,ax=ax,  fliersize=3)\n","a4f02ccd":"df.shape","c7901863":"from scipy import stats\nimport numpy as np\nz = np.abs(stats.zscore(df))\nprint(z)","49413723":"threshold = 3\nprint(np.where(z > 3))","e372f722":"df1 = df[(z < 3).all(axis=1)]","b584e975":"df1.shape","d7d62997":"fig, ax = plt.subplots(figsize=(15,10))\nsns.boxplot(data=df1, width= 0.5,ax=ax,  fliersize=3)","53baa97d":"plt.figure(figsize=(20,25), facecolor='white')\nplotnumber = 1\n\nfor column in df1:\n    if plotnumber<=14 :\n        ax = plt.subplot(7,2,plotnumber)\n        sns.kdeplot(df1[column],bw=1.5)\n        plt.xlabel(column,fontsize=20)\n    plotnumber+=1\nplt.show()","06553be1":"df1.head()","70fee776":"df1['log_balance']=np.log(1+df1['BALANCE'])\ndf1['log_oneoff_purchases']=np.log(1+df1['ONEOFF_PURCHASES'])\ndf1['log_installments_purchases']=np.log(1+df1['INSTALLMENTS_PURCHASES'])\ndf1['log_cash_advance']=np.log(1+df1['CASH_ADVANCE'])\ndf1['log_cash_advance_trx']=np.log(1+df1['CASH_ADVANCE_TRX'])\ndf1['log_purchases_trx']=np.log(1+df1['PURCHASES_TRX'])\ndf1['log_credit_limit']=np.log(1+df1['CREDIT_LIMIT'])\ndf1['log_payments']=np.log(1+df1['PAYMENTS'])\ndf1['log_minimum_payments']=np.log(1+df1['MINIMUM_PAYMENTS'])","937d2cb1":"df1.drop(['BALANCE','ONEOFF_PURCHASES','INSTALLMENTS_PURCHASES','CASH_ADVANCE','CASH_ADVANCE_TRX','PURCHASES_TRX','CREDIT_LIMIT','PAYMENTS','MINIMUM_PAYMENTS'],axis=1,inplace=True)","80a0775b":"df1.head()","7f19f503":"plt.figure(figsize=(20,25), facecolor='white')\nplotnumber = 1\n\nfor column in df1:\n    if plotnumber<=14 :\n        ax = plt.subplot(7,2,plotnumber)\n        sns.kdeplot(df1[column],bw=1.5)\n        plt.xlabel(column,fontsize=20)\n    plotnumber+=1\nplt.show()","76dd3c29":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nX = scaler.fit_transform(df1)\nX.shape","f2102cd0":"from sklearn.cluster import KMeans\nwcss=[]\nfor i in range (1,12):\n    kmeans=KMeans(n_clusters=i,init='k-means++',random_state=40)\n    kmeans.fit(X)\n    wcss.append(kmeans.inertia_)\nplt.plot(range(1,12),wcss)\nplt.title('The Elbow Method')\nplt.xlabel('Number of clusters')\nplt.ylabel('WCSS')\nplt.show()","24eab5a0":"kmeans = KMeans(n_clusters = 5, init = 'k-means++', random_state = 50)\ny_kmeans = kmeans.fit_predict(X)\nprint(y_kmeans)","eafca2af":"labels = kmeans.labels_\nlabels","18b6aba1":"from sklearn.decomposition import PCA\npca = PCA(2)\nprincipalComponents = pca.fit_transform(X)\nx, y = principalComponents[:, 0], principalComponents[:, 1]\nprint(principalComponents.shape)\n\ncolors = {0: 'red', 1: 'blue', 2: 'green', 3: 'yellow', 4: 'purple'}","d1738f85":"final_df = pd.DataFrame({'x': x, 'y':y, 'label':labels}) \ngroups = final_df.groupby(labels)","65ddef47":"fig, ax = plt.subplots(figsize=(15, 10)) \n\nfor name, group in groups:\n    ax.plot(group.x, group.y, marker='o', linestyle='', ms=5, color=colors[name], mec='none')\n    ax.set_aspect('auto')\n    ax.tick_params(axis='x',which='both',bottom='off',top='off',labelbottom='off')\n    ax.tick_params(axis= 'y',which='both',left='off',top='off',labelleft='off')\n    \nax.set_title(\"Customer Segmentation based on Credit Card usage\")\nplt.show()","64fbbe75":"**There is a lot of right skeweness in some of the features**","84fcee09":"There are a lot of outliers","92cd47f5":"**Checking the distribution of data**","26c2aad5":"**Removing highly correlated features(correlation>=0.8)**","e2af476e":"Using box plot to check for outliers","f7c8d3b1":"**Check for correlation using heatmap**","7ae7ffa8":"**Outlier Analysis and Removal using Z-score**\n* The intuition behind Z-score is to describe any data point by finding their relationship with the Standard Deviation and Mean of the group of data points. Z-score is finding the distribution of data where mean is 0 and standard deviation is 1 i.e. normal distribution.\n* While calculating the Z-score we re-scale and center the data and look for data points which are too far from zero. These data points which are way too far from zero will be treated as the outliers. In most of the cases a threshold of 3 or -3 is used i.e if the Z-score value is greater than or less than 3 or -3 respectively, that data point will be identified as outliers","1a22a7a5":"**Using Log Transformation to handle skewness**","d220844b":"**Taking K value as 5**","471e92eb":"# K-Means Clustering\n* Elbow curve to determine the K value"}}