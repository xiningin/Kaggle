{"cell_type":{"d616c221":"code","e47ba6d0":"code","5fe5edcf":"code","2d70e5e7":"code","f8938434":"code","39483055":"code","56006a1e":"code","91d08f0a":"code","d1af3f91":"code","e7ed155d":"code","b8c22acb":"code","ce7a5fde":"code","326abc23":"code","0d2636cd":"code","e635b711":"code","6270ffa5":"code","7d9bb045":"code","71c59cbd":"code","09737f17":"code","135ef77a":"code","0d7addb1":"code","e1ed954c":"code","914bb2d9":"code","1b8e29d3":"code","7196978a":"code","e8d1f692":"code","3838b3ad":"code","29efb988":"code","45afbec2":"code","78fb6e1c":"code","62d981ed":"code","a5238eec":"code","01a6f6bf":"code","744c71db":"code","3d3523f5":"code","445e49cb":"code","782fb263":"code","9ca26e7e":"code","dc6ac2d3":"code","25c3a042":"code","0b0bf377":"code","abc5b85d":"code","f9aa4647":"code","4dbd6483":"code","d7dccede":"code","6d13a977":"code","e6d1b352":"code","66147a6f":"code","dcca64a3":"code","3049fa7b":"code","3a030557":"code","e2849147":"code","cb1bbee2":"code","e7acf2c4":"code","2feadb8a":"code","1fc98346":"code","17f983b8":"code","1f5bfcb9":"code","49d326bf":"code","68a5a601":"code","3888ab15":"code","ee65df31":"markdown","dd260c7b":"markdown","665b5da0":"markdown","07f72c6f":"markdown","7f9f29bb":"markdown","677cb11b":"markdown","12bcd0eb":"markdown","c903a1c4":"markdown","b8cd601c":"markdown","bd1af3e9":"markdown","5293136b":"markdown"},"source":{"d616c221":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","e47ba6d0":"import matplotlib.pyplot as plt \nimport seaborn as sns\n%matplotlib inline","5fe5edcf":"cars = pd.read_csv('\/kaggle\/input\/usa-cers-dataset\/USA_cars_datasets.csv')\ncars.head()","2d70e5e7":"# the second column is an index and can be deleted\n# the vin number is a unique value for each car and wont add to analysis. also delete \n# same with lot number and condition","f8938434":"cars.drop(['Unnamed: 0','vin','lot','condition'],axis=1,inplace=True)\ncars.head()","39483055":"cars.info()","56006a1e":"cars.isnull().sum()\n# no null values, great! ","91d08f0a":"cars.describe()","d1af3f91":"cars['title_status'].unique()","e7ed155d":"cars[cars['brand']=='dodge']['model'].nunique()","b8c22acb":"# this is using matplotlib\nsns.set_style('whitegrid')\nfig, (ax1,ax2) = plt.subplots(1,2,figsize=(20,5))\n\nax1.scatter(x='mileage',y='price',data=cars,marker='.',facecolor='r',edgecolors='white',linewidth=.5)\n#scatter1.set_title('Price vs Mileage')\n\nax2.scatter(x='year',y='price',data=cars,marker='.',facecolor='b',edgecolors='white',linewidth=.5,s=80)\n\nax1.set_title('Price vs Mileage',fontsize=15,fontweight=\"bold\",color='blue')\nax1.set_ylabel('Price',fontsize=15,color='b')\nax1.set_xlabel('Mileage',fontsize=13,color='b')\n\nax2.set_title('Price vs Year',fontsize=15,fontweight=\"bold\",color='blue')\nax2.set_ylabel('Price',fontsize=15,color='b')\nax2.set_xlabel('Year',fontsize=15,color='b')","ce7a5fde":"scat1 = sns.scatterplot(y='price',x='mileage',data=cars,hue='title_status',marker='o')","326abc23":"plt.figure(figsize=(8,8))\nbox_cars = sns.boxplot(x='title_status',y='price',data=cars,showfliers=False)\nbox_cars.set_title('Price by Title_Status',fontsize=15,fontweight='bold',color='Blue')\nbox_cars.set_xlabel('Title Status',fontsize=15,color='Blue')\nbox_cars.set_ylabel('Price',fontsize=15,color='Blue')","0d2636cd":"\nplt.figure(figsize=(9,6))\nprice_dist = plt.hist(x='price',data=cars,bins=30,color='g',alpha=.5)\nplt.title('Price Distribution',fontsize=15,color='blue',fontweight='bold')\nplt.xlabel('Price',fontsize=14,color='blue')\nplt.ylabel('Quantity',fontsize=14,color='blue')","e635b711":"by_title_status = cars.groupby('title_status').agg(['count'])\nby_title_status","6270ffa5":"by_title_status.index","7d9bb045":"by_title_status['price']['count']","71c59cbd":"plt.bar(x=by_title_status.index,height=by_title_status['price']['count'],color='g',alpha=.5)\nplt.title('Distribution by Title Status',fontsize=15,color='blue')\nplt.xlabel('Title Status',fontsize=14,color='blue')\nplt.ylabel('Count',fontsize=14,color='blue')\nplt.ylim(0,2500)","09737f17":"cars['brand'].unique()","135ef77a":"cars[cars['brand']=='peterbilt']['model'].unique()","0d7addb1":"by_model = cars.groupby(['brand','model']).agg(['count'])\nby_model","e1ed954c":"plt.figure(figsize=(5,5))\nplt.bar(x=by_title_status.index,height=by_title_status['price']['count'],color=sns.color_palette('dark'),alpha=.6,width=.4,align='center')\nplt.title('Distribution by Title Status',fontsize=15,color='blue')\nplt.xlabel('Title Status',fontsize=14,color='blue')\nplt.ylabel('Count',fontsize=14,color='blue')\nplt.ylim(0,2500)","914bb2d9":"car_brands= cars.groupby('brand').agg(['count'])\ncar_brands","1b8e29d3":"sorted_cars = car_brands.sort_values(by=[('price','count')],ascending=False)\ntop_six = sorted_cars[0:6]\ntop_six","7196978a":"car_brands_index = car_brands.index","e8d1f692":"plt.figure(figsize=(15,7))\nplt.bar(x=top_six.index,height=top_six['price']['count'],alpha=.6,color=sns.color_palette('dark'))\nplt.ylim(0,1500)\nplt.title('Top Six Car Brands',fontsize=15,fontweight='bold',color='b')\nplt.xlabel('Car Brand',fontsize=13,color='b')\nplt.ylabel('Quantity',fontsize=13,color='b')","3838b3ad":"# most popular models within the six brands\n\n#by_model = cars.groupby(['brand','model']).agg(['count'])\n#by_model\n","29efb988":"cars[cars['brand']=='ford']['model'].unique()","45afbec2":"by_model","78fb6e1c":"cars[cars['brand']=='ford']","62d981ed":"s = cars.groupby(['brand']).agg(['count'])\ns","a5238eec":"# brands = [['ford','dodge','nissan','chevrolet','gmc','jeep']]\npd.pivot_table(cars,index=['brand','model'],aggfunc=np.sum)","01a6f6bf":"f = pd.pivot_table(cars[cars['brand']=='ford'],index=['brand','model'],aggfunc='count').sort_values(by='color',ascending=False)[0:6]\n\nd = pd.pivot_table(cars[cars['brand']=='dodge'],index=['brand','model'],aggfunc='count').sort_values(by='color',ascending=False)[0:6]\n\nn = pd.pivot_table(cars[cars['brand']=='nissan'],index=['brand','model'],aggfunc='count').sort_values(by='color',ascending=False)[0:6]\n\nc = pd.pivot_table(cars[cars['brand']=='chevrolet'],index=['brand','model'],aggfunc='count').sort_values(by='color',ascending=False)[0:6]\n\ng = pd.pivot_table(cars[cars['brand']=='gmc'],index=['brand','model'],aggfunc='count').sort_values(by='color',ascending=False)[0:6]\n\nj = pd.pivot_table(cars[cars['brand']=='jeep'],index=['brand','model'],aggfunc='count').sort_values(by='color',ascending=False)[0:6]\n\n\n","744c71db":"# check one of them to confirm output is what we want\nf","3d3523f5":"sns.set_style('whitegrid')\nsns.color_palette('dark')\nfig, (axs) = plt.subplots(2,3,figsize=(20,10),sharey='row')\nfig.suptitle(\"Quantity of Top Six Car Brands \\n By Model\",va='center',ha='center',fontsize=20,fontweight='heavy',fontstyle='oblique',color='k')\n\naxs[0,0].bar(x=f.index.get_level_values(1),height=f['color'].values,color=sns.color_palette('Blues'),alpha=1)\naxs[0,1].bar(x=d.index.get_level_values(1),height=d['color'].values,color=sns.color_palette('Greens'),alpha=1)\naxs[0,2].bar(x=n.index.get_level_values(1),height=n['color'].values,color=sns.color_palette('Oranges'),alpha=1)\naxs[1,0].bar(x=c.index.get_level_values(1),height=c['color'].values,color=sns.color_palette('Purples'),alpha=1)\naxs[1,1].bar(x=g.index.get_level_values(1),height=g['color'].values,color=sns.color_palette('Reds'),alpha=1)\naxs[1,2].bar(x=j.index.get_level_values(1),height=j['color'].values,color=sns.color_palette('YlOrBr'),alpha=1)\n\n# Set axis labels for the entire plot\nfig.text(0.5, 0.04, 'Model', ha='center', va='top',fontsize=20,fontweight='heavy',color='k')\nfig.text(0.06, 0.5, 'Quantity', ha='center', va='center', rotation='vertical',fontsize=20,fontweight='bold',color='k')\n\n#set axis labels for individual plots\naxs[0,0].set_xlabel('Ford',fontsize=13,color='b')\naxs[0,1].set_xlabel('Dodge',fontsize=13,color='b')\naxs[0,2].set_xlabel('Nissan',fontsize=13,color='b')\naxs[1,0].set_xlabel('Chevrolet',fontsize=13,color='b')\naxs[1,1].set_xlabel('GMC',fontsize=13,color='b')\naxs[1,2].set_xlabel('Jeep',fontsize=13,color='b')\n","445e49cb":"cars.head(10)","782fb263":"cars['brand'].nunique()","9ca26e7e":"cars.drop(['country'],axis=1,inplace=True)\ncars.head()","dc6ac2d3":"car_brand=pd.get_dummies(cars['brand'],drop_first=True)\ncar_model=pd.get_dummies(cars['model'],drop_first=True)\ntitle=pd.get_dummies(cars['title_status'],drop_first=True)\ncolor_=pd.get_dummies(cars['color'],drop_first=True)\nstate_=pd.get_dummies(cars['state'],drop_first=True)\n#cars_model = pd.concat([car_brand,car_model,title,color_],axis=1)\ncars_model = pd.concat([cars,car_brand,car_model,title,color_,state_],axis=1)","25c3a042":"list(cars_model.columns)","0b0bf377":"cars_model.drop(['brand','model','title_status','color','state'],axis=1,inplace=True)","abc5b85d":"X = cars_model.drop(['price'],axis=1)\ny = cars_model['price']","f9aa4647":"from sklearn.model_selection import train_test_split","4dbd6483":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.4, random_state=101)","d7dccede":"from sklearn.linear_model import LinearRegression\nlm = LinearRegression()\nlm.fit(X_train,y_train)","6d13a977":"print(lm.intercept_)","e6d1b352":"coeff_df = pd.DataFrame(lm.coef_,X.columns,columns=['Coefficient'])\ncoeff_df","66147a6f":"predictions = lm.predict(X_test)","dcca64a3":"# this is using matplotlib\nsns.set_style('whitegrid')\nplt.figure(figsize=(10,10))\nplt.scatter(y_test,predictions,marker='.',c='red',edgecolors='black',s=100,linewidth=1)\n","3049fa7b":"sns.set_style('white')\nplt.figure(figsize=(8,8))\nsns.distplot((y_test-predictions),bins=50);","3a030557":"from sklearn import metrics","e2849147":"print('MAE:', metrics.mean_absolute_error(y_test, predictions))\nprint('MSE:', metrics.mean_squared_error(y_test, predictions))\nprint('RMSE:', np.sqrt(metrics.mean_squared_error(y_test, predictions)))","cb1bbee2":"list(cars_model.columns)","e7acf2c4":"X = cars_model.drop(['salvage insurance'],axis=1)\ny = cars_model['salvage insurance']","2feadb8a":"from sklearn.model_selection import train_test_split","1fc98346":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.4, random_state=101)","17f983b8":"from sklearn.linear_model import LogisticRegression","1f5bfcb9":"logmodel = LogisticRegression()\nlogmodel.fit(X_train,y_train)","49d326bf":"predictions = logmodel.predict(X_test)","68a5a601":"from sklearn.metrics import classification_report","3888ab15":"print(classification_report(y_test,predictions))","ee65df31":"# # 2.1 *Predictive Modeling with Linear Regression*\n### Predicting price using linear regression","dd260c7b":"# Training and Predicting\n### Using Logistic Regression, let's evaluate how predictly we can predict a car's title status","665b5da0":"![image.png](attachment:image.png)","07f72c6f":"### Create and Train the Model","7f9f29bb":"# 2.2 Predictive Modeling with Logistic Regression","677cb11b":"### Model Evaluation","12bcd0eb":"### Train Test Split","c903a1c4":"# 1. Exploratory Data Analysis","b8cd601c":"### Predictions from our model","bd1af3e9":"# 3. Conclusion\n### Linear Regression left much to be desired for accuracy. Part of the large RMSE and lack of general accuracy may be fixed or adjusted by changing the handling of dummy variables.\n### Future updates to this notebook may include any or more of the following:\n* Consolidating the state information into one of our areas across the country, North East, North West, South East, South West\n* Consolidating colors (for example, there were many kinds of black or white, for example), or perhaps certain colors stand out more than others, maybe a binary whether a car is black or not\n\n\n### Regarding the ability to predict a car's title status, logistic regression was quite accurate at 97%. ","5293136b":"### Transform non-numeric columns into variables that the model can work with. This includes:\n* Brand - dummy variables\n* Model - dummy variables\n* Title_status - binary dummy variables\n* Color - dummy variables\n* State\n* Country DELETE The majority of the data set is from the U.S with less then 20 variables from Canada. "}}