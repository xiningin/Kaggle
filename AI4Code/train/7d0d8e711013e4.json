{"cell_type":{"9cc902dc":"code","08aa15fa":"code","6454e418":"code","5690cf6c":"code","f88c61ae":"code","9cd14af3":"code","26f6a845":"code","f4c78a9e":"code","55514510":"code","e01b7f05":"code","52828d21":"code","1ccb9920":"code","f38a0e2c":"code","a5376b8e":"code","29171447":"code","d9d0177c":"code","ba8f69bd":"code","7e4b425b":"code","f25f97dc":"code","1557bb83":"code","ecb4e12b":"code","17be6730":"code","c3e3e8ea":"code","a116e83f":"code","5907e251":"code","91893b4d":"code","d0644a00":"code","7c36887d":"code","bfc9dec4":"markdown","65d4fafc":"markdown","74e6b852":"markdown","70de45ee":"markdown","9076db1f":"markdown","54ed7d2c":"markdown","2eedcd93":"markdown"},"source":{"9cc902dc":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","08aa15fa":"import matplotlib.pyplot as plt\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport seaborn as sns\nfrom plotly.subplots import make_subplots\nimport warnings\nwarnings.filterwarnings(\"ignore\")\nimport gc","6454e418":"imports = pd.read_csv('\/kaggle\/input\/global-patterns-of-us-merchandise-trade\/data_imports_of_naics_total_all_merchandise.csv')\nimports.shape","5690cf6c":"imports.head(3)","f88c61ae":"temp_imp = imports\ntemp_imp['Total_imports'] = temp_imp.sum(axis=1)\n\ntemp_imp = temp_imp.melt(id_vars=['Partner','Total_imports'], \n                         var_name=\"Year\", \n                         value_name=\"Value\")","9cd14af3":"exports = pd.read_csv('\/kaggle\/input\/global-patterns-of-us-merchandise-trade\/data_exports_of_naics_total_all_merchandise.csv')\nexports.shape","26f6a845":"exports.head(3)","f4c78a9e":"temp_exp = exports\ntemp_exp['Total_exports'] = temp_exp.sum(axis=1)\n\ntemp_exp = temp_exp.melt(id_vars=['Partner','Total_exports'], \n                       var_name=\"Year\", \n                       value_name=\"Value\")","55514510":"region = pd.read_csv('\/kaggle\/input\/country-mapping-iso-continent-region\/continents2.csv')\nregion = region[['name','region']]","e01b7f05":"world_imp = temp_imp[temp_imp['Partner'] == 'World']\nworld_exp = temp_exp[temp_exp['Partner'] == 'World']\n\nworld_imp.rename(columns={'Value':'Import'},inplace=True)\nworld_exp.rename(columns={'Value':'Export'},inplace=True)\n\nworld_trade = pd.merge(world_imp,world_exp ,on=['Year','Partner'])\n","52828d21":"trace1 = go.Scatter(\n    x=world_trade['Year'],\n    y=world_trade['Import'],\n    name='Import',\n    marker=dict(\n        color='rgb(34,163,192)'\n               )\n)\ntrace2 = go.Scatter(\n    x=world_trade['Year'],\n    y=world_trade['Export'],\n    name='Export'\n\n)\n\nfig = make_subplots(specs=[[{\"secondary_y\": True}]])\nfig.add_trace(trace1)\nfig.add_trace(trace2,secondary_y=True)\n\nfig.add_vrect(x0=\"7.5\", x1=\"6\", \n              annotation_text=\"   decline\", annotation_position=\"top left\",\n              fillcolor=\"green\", opacity=0.25, line_width=4)\n\nfig['layout'].update(height = 600,title = 'US Import & Export Trend With World (2002-2016)',xaxis=dict(\n      tickangle=-90\n    ))\nfig.update_layout(margin={'b':0,'l':0,'r':0,},\n                 paper_bgcolor='rgb(248, 248, 255)',\n                 plot_bgcolor='rgb(248, 248, 255)',\n                 title={'font':{\n                             'family':'monospace',\n                             'size':22,\n                             'color': 'grey'\n                         },\n                        'x':0.45,'y':0.9})\nfig.show()","1ccb9920":"imports = imports[1:]\n\n#creating new column with sum of all import over the years\nimports['Total_imports'] = imports.sum(axis=1) \n\nmost_imports = imports.nlargest(5,'Total_imports')","f38a0e2c":"most_imports = most_imports.T.reset_index()\nnew = most_imports.iloc[0]\nmost_imports = most_imports[1:-1]\nmost_imports.columns = new\nmost_imports.rename(columns={'Partner':'Year'},inplace=True)","a5376b8e":"trace1 = go.Scatter(\n    x=most_imports['Year'],\n    y=most_imports['China'],\n    name='China',\n    marker=dict(\n        color='rgb(34,163,192)'\n               )\n)\ntrace2 = go.Scatter(\n    x=most_imports['Year'],\n    y=most_imports['Canada'],\n    name='Canada'\n\n)\n\ntrace3 = go.Scatter(\n    x=most_imports['Year'],\n    y=most_imports['Mexico'],\n    name='Mexico'\n\n)\n\ntrace4 = go.Scatter(\n    x=most_imports['Year'],\n    y=most_imports['Japan'],\n    name='Japan'\n\n)\n\ntrace5 = go.Scatter(\n    x=most_imports['Year'],\n    y=most_imports['Germany'],\n    name='Germany'\n\n)\n\nfig = make_subplots(specs=[[{\"secondary_y\": True}]])\nfig.add_trace(trace1)\nfig.add_trace(trace2,secondary_y=True)\nfig.add_trace(trace3)\nfig.add_trace(trace4)\nfig.add_trace(trace5)\n\nfig.add_vline(x=7, line_width=3, line_dash=\"dash\",\n              line_color=\"green\",\n              annotation_text=\"In year 2009 US has decline in imports most significantly with Canada\",\n              annotation_position=\"top\")\n\nfig['layout'].update(height = 600,title = 'US top 5 Import partners (2002-2016)',xaxis=dict(\n      tickangle=-90\n    ))\nfig.update_layout(margin={'b':0,'l':0,'r':0,'t':120},\n                 paper_bgcolor='rgb(248, 248, 255)',\n                 plot_bgcolor='rgb(248, 248, 255)',\n                 title={'font':{\n                             'family':'monospace',\n                             'size':22,\n                             'color': 'grey'\n                         },\n                        'x':0.45,'y':0.9})\nfig.show()","29171447":"imp_sca = most_imports.melt(id_vars=['Year'], \n                       var_name=\"Country\", \n                       value_name=\"Value\")\nimp_sca['Value'] = imp_sca['Value'].astype(float)\nimp_sca['Year'] = imp_sca['Year'].astype(int)","d9d0177c":"fig = px.scatter(imp_sca, x=\"Year\", y=\"Value\", animation_frame=\"Year\", animation_group=\"Country\",\n           size=\"Value\", color=\"Country\", hover_name=\"Country\",\n           log_y=True,size_max=50, range_x=[2002,2016],\n           color_discrete_sequence=px.colors.qualitative.Safe)\n\nfig['layout'].update(height = 600,title = 'US top 5 Import partners (2002-2016)',xaxis=dict(\n      tickangle=-90\n    ))\n\nfig.update_layout(margin={'b':0,'l':0,'r':0,'t':120},\n                 paper_bgcolor='rgb(248, 248, 255)',\n                 plot_bgcolor='rgb(248, 248, 255)',\n                 title={'font':{\n                             'family':'monospace',\n                             'size':22,\n                             'color': 'grey'\n                         },\n                        'x':0.45,'y':0.9})\nfig.show()","ba8f69bd":"iso_code = pd.read_csv('\/kaggle\/input\/iso-codes\/iso_codes.csv')\niso_code = iso_code[['Country','ISO_Code']].drop_duplicates().reset_index(drop=True)","7e4b425b":"world_imp = temp_imp[temp_imp['Partner'] != 'World']\nworld_imp.rename(columns={'Partner':'Country'},inplace=True)\n\nworld_import = (\n       world_imp.groupby(['Year','Country'])['Value'].agg(['mean'])\n      .reset_index()\n      .rename(columns={'mean': 'AvgImport'})\n      .merge(iso_code,left_on='Country',right_on='Country')\n      .sort_values(by=['Year','Country'])\n      )","f25f97dc":"fig = (\n   px.choropleth(\n                 world_import               \n                ,locations='ISO_Code'               \n                ,color='AvgImport'\n                ,hover_name='Country'  \n                ,hover_data={'ISO_Code':False, 'Year':True,'AvgImport':':.2f'}\n                ,animation_frame='Year'   \n                ,color_continuous_scale='IceFire' \n                ,height=600)\n  .update_layout(\n                 title_text='World average US Import dynamics'\n                ,title_x=0.3\n                ,margin=dict(r=10, t=40, b=10, l=10)\n                ,coloraxis_colorbar_title='Import')\n \n .update_layout(margin={'b':0,'l':0,'r':0,'t':120},\n                 paper_bgcolor='rgb(248, 248, 255)',\n                 plot_bgcolor='rgb(248, 248, 255)',\n                 title={'font':{\n                             'family':'monospace',\n                             'size':22,\n                             'color': 'grey'\n                         },\n                        'x':0.45,'y':0.9})\n)\nfig.layout.updatemenus[0].buttons[0].args[1][\"frame\"][\"duration\"] = 800\nfig.show()\n\n","1557bb83":"most_export = exports[1:]\nmost_export = most_export.nlargest(5,'Total_exports')\n\nmost_export = most_export.T.reset_index()\nnew = most_export.iloc[0]\nmost_export = most_export[1:-1]\nmost_export.columns = new\nmost_export.rename(columns={'Partner':'Year'},inplace=True)","ecb4e12b":"trace1 = go.Scatter(\n    x=most_export['Year'],\n    y=most_export['Canada'],\n    name='Canada',\n    marker=dict(\n        color='rgb(34,163,192)'\n               )\n)\ntrace2 = go.Scatter(\n    x=most_export['Year'],\n    y=most_export['Mexico'],\n    name='Mexico'\n\n)\n\ntrace3 = go.Scatter(\n    x=most_export['Year'],\n    y=most_export['China'],\n    name='China'\n\n)\n\ntrace4 = go.Scatter(\n    x=most_export['Year'],\n    y=most_export['Japan'],\n    name='Japan'\n\n)\n\ntrace5 = go.Scatter(\n    x=most_export['Year'],\n    y=most_export['United Kingdom'],\n    name='United Kingdom'\n\n)\n\nfig = make_subplots(specs=[[{\"secondary_y\": True}]])\nfig.add_trace(trace1)\nfig.add_trace(trace2,secondary_y=True)\nfig.add_trace(trace3)\nfig.add_trace(trace4)\nfig.add_trace(trace5)\n\nfig.add_vline(x=7, line_width=3, line_dash=\"dash\", line_color=\"green\",annotation_text=\"Fall of export year 2009\",annotation_position=\"top\")\n\nfig['layout'].update(height = 600,title = 'US top 5 EXport partners (2002-2016)',xaxis=dict(\n      tickangle=-90\n    ))\nfig.update_layout(margin={'b':0,'l':0,'r':0,},\n                 paper_bgcolor='rgb(248, 248, 255)',\n                 plot_bgcolor='rgb(248, 248, 255)',\n                 title={'font':{\n                             'family':'monospace',\n                             'size':22,\n                             'color': 'grey'\n                         },\n                        'x':0.45,'y':0.9})\nfig.show()","17be6730":"exp_sca = most_export.melt(id_vars=['Year'], \n                       var_name=\"Country\", \n                       value_name=\"Value\")\nexp_sca['Value'] = exp_sca['Value'].astype(float)\nexp_sca['Year'] = exp_sca['Year'].astype(int)","c3e3e8ea":"fig = px.scatter(exp_sca, x=\"Year\", y=\"Value\", animation_frame=\"Year\", animation_group=\"Country\",\n           size=\"Value\", color=\"Country\", hover_name=\"Country\",\n           log_y=True,size_max=50, range_x=[2002,2016],\n           color_discrete_sequence=px.colors.qualitative.Set3)\n\nfig['layout'].update(height = 600,title = 'US top 5 Import partners (2002-2016)',xaxis=dict(\n      tickangle=-90\n    ))\n\nfig.update_layout(margin={'b':0,'l':0,'r':0,'t':120},\n                 paper_bgcolor='rgb(248, 248, 255)',\n                 plot_bgcolor='rgb(248, 248, 255)',\n                 title={'font':{\n                             'family':'monospace',\n                             'size':22,\n                             'color': 'grey'\n                         },\n                        'x':0.45,'y':0.9})\nfig.show()","a116e83f":"world_exp = temp_exp[temp_exp['Partner'] !='World']\nworld_exp.rename(columns={'Partner':'Country'},inplace=True)\n\nworld_export = (\n       world_exp.groupby(['Year','Country'])['Value'].agg(['mean'])\n      .reset_index()\n      .rename(columns={'mean': 'AvgExport'})\n      .merge(iso_code,left_on='Country',right_on='Country')\n      .sort_values(by=['Year','Country'])\n      )","5907e251":"fig = (\n   px.choropleth(\n                 world_export               \n                ,locations='ISO_Code'               \n                ,color='AvgExport'\n                ,hover_name='Country'  \n                ,hover_data={'ISO_Code':False, 'Year':True,'AvgExport':':.2f'}\n                ,animation_frame='Year'   \n                ,color_continuous_scale='mint' \n                ,height=600)\n  .update_layout(\n                 title_text='World average US Export dynamics'\n                ,title_x=0.3\n                ,margin=dict(r=10, t=40, b=10, l=10)\n                ,coloraxis_colorbar_title='Export')\n \n .update_layout(margin={'b':0,'l':0,'r':0,'t':120},\n                 paper_bgcolor='rgb(248, 248, 255)',\n                 plot_bgcolor='rgb(248, 248, 255)',\n                 title={'font':{\n                             'family':'monospace',\n                             'size':22,\n                             'color': 'grey'\n                         },\n                        'x':0.45,'y':0.9})\n)\nfig.layout.updatemenus[0].buttons[0].args[1][\"frame\"][\"duration\"] = 800\nfig.show()\n","91893b4d":"region_imp = imports\nregion_imp = pd.merge(region_imp,region,left_on='Partner',right_on='name')\n\nregion_imp = region_imp.groupby('region')['Total_imports'].sum().reset_index().sort_values(by='Total_imports',ascending=False)\n\nregion_exp = exports\nregion_exp = pd.merge(region_exp,region,left_on='Partner',right_on='name')\n\nregion_exp = region_exp.groupby('region')['Total_exports'].sum().reset_index().sort_values(by='Total_exports',ascending=False)","d0644a00":"fig = make_subplots(rows=1,cols=2,\n                   vertical_spacing=0.25,\n                   column_widths=[0.35,0.35],\n                   specs=[[{'type':'bar'},{'type':'bar'}]],\n                   subplot_titles=['Imports','Exports'])\n\nfig.append_trace(px.bar(region_imp\n                      ,y='region'\n                      ,x='Total_imports'\n                      ,color='Total_imports'\n                      ,color_continuous_scale=['orange','red']\n                      ,text='Total_imports'\n                      ,hover_name='region').data[0],1,1)\n\nfig.append_trace(px.bar(region_exp\n                      ,y='region'\n                      ,x='Total_exports'\n                      ,color='Total_exports'\n                      ,text='Total_exports'\n                      ,hover_name='region').data[0],1,2)\n\n\n\nfig.update_layout(margin={'b':0,'l':0,'r':0,'t':100},\n                 paper_bgcolor='rgb(248, 248, 255)',\n                 plot_bgcolor='rgb(248, 248, 255)',\n                 title={'font':{\n                             'family':'monospace',\n                             'size':22,\n                             'color': 'grey'\n                         }, 'text':'US Trade Per Region',\n                        'x':0.45,'y':0.9})\n\nfig.show()","7c36887d":"fig = (\n    px.line(temp_exp, x=\"Year\", y=\"Value\", color=\"Partner\")\n    .update_traces(\n        line={\"color\": \"#00CC96\", \"dash\": \"dash\"},\n        mode=\"lines+markers\",\n        visible=False,\n        name=\"Export\",\n    )\n    .update_traces(visible=True, selector={\"legendgroup\": \"World\"})\n    .add_traces(\n        px.line(temp_imp, x=\"Year\", y=\"Value\", color=\"Partner\")\n        .update_traces(line={\"color\": \"gold\",'dash':'dash'}, visible=False,\n                       name=\"Import\",\n                       mode = 'lines+markers')\n        .update_traces(visible=True, selector={\"legendgroup\": \"World\"})\n        .data\n    )\n)\n\nfig.update_layout(\n    updatemenus=[\n        {\n            \"buttons\": [\n                {\n                    \"label\": p,\n                    \"method\": \"update\",\n                    \"args\": [{\"visible\": [t[\"legendgroup\"] == p for t in fig.data]}],\n                }\n                for p in temp_imp[\"Partner\"].unique()\n            ]\n        }\n    ]\n)\nfig.update_layout(margin={'b':0,'l':0,'r':0,'t':100},\n                 paper_bgcolor='rgb(248, 248, 255)',\n                 plot_bgcolor='rgb(248, 248, 255)',\n                 title={'font':{\n                             'family':'monospace',\n                             'size':22,\n                             'color': 'grey'\n                         }, 'text':'US Trade With World',\n                        'x':0.45,'y':0.9})\n\nfig.show()","bfc9dec4":"The goal of this notebook is to analyze US trade's rise and fall with different part of the world.","65d4fafc":"**Let's understand the data first.**\n\n**Merchandise trade balance:** The Merchandise Trade Balance is the difference in value between imported and exported goods. Data are denominated both in U.S. dollars and renminbi. A positive number indicates a surplus meaning that more goods were exported than imported.\n \n**Export:** Value of Exports (money flowing into the Country)\n \n**Import:** Value of Imports (money flowing out of the Country)","74e6b852":"**US Top 5 Import partners**\n\n1. Line Plot to plot US import with top 5 Countries\n\n2. Scatter Plot to visualize rise & fall of import with top 5 Countries\n\n3. choropleth Plot to visualize US import With whole world","70de45ee":"Looking at the data one can clearly see that in Year **2009** there was a major decline in trade after Trade fell mostly because demand crashed globally and did so particularly in its most import-intensive component \u2013 investment.\n\nIn **2009**, the U.S. merchandise trade deficit fell by **$308.2 billion (33 percent)** to **$612.4 billion**. U.S. imports and exports fell by **26 percent** and **20 percent**, respectively, in 2009, reflecting the downturn in the U.S. and world economies that resulted in reduced demand for imports and U.S. exports. In 2009, most U.S. merchandise trade deficits with major trading partners also fell.","9076db1f":"**US Top 5 Export Partners:**\n\n**Discovery:**\n\nUs Exports are relatively less than Imports.\n\nUnited States Consumer goods exports are worth US$ 430,334 million, product share of 26.17%. United States Consumer goods imports are worth US$ 949,394 million, product share of 36.98%. United States Capital goods exports are worth US$ 528,561 million, product share of 32.15%.","54ed7d2c":"**First Insight:**\n\n**US trade With world trend:**\n\nLets look at the total import & export of US with world over the years.","2eedcd93":"**US trade per region for the entire period**"}}