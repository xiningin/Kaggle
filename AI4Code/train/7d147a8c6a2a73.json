{"cell_type":{"550bd63f":"code","380f5299":"code","a9169576":"code","404ab085":"code","1fc1a212":"code","cc37a7f2":"code","656f445c":"code","7701df39":"code","de5c9b78":"code","47f87b33":"code","4a643e6b":"code","297d63ef":"code","e65d9bf2":"code","6cabf56d":"code","7ed891bc":"code","57a19709":"code","6fde30c0":"code","c7a0b2ba":"code","bd648a48":"code","7f0ad261":"code","f51f507b":"code","4940a40a":"code","bf5c2e14":"code","523f33e0":"code","42f1eb59":"markdown","0fe620e9":"markdown","fcd708a6":"markdown","721b7cd4":"markdown","dfde776d":"markdown","da041aab":"markdown","d2eb68f4":"markdown","0a8a6b10":"markdown","a303c6c0":"markdown","62db1a8e":"markdown","679fad08":"markdown","6de7d4e3":"markdown","f3d19aa5":"markdown","40761ee1":"markdown"},"source":{"550bd63f":"import numpy as np\nimport pandas as pd\nimport os\nfrom sklearn.metrics import classification_report, log_loss, accuracy_score","380f5299":"from fastai import *\nfrom fastai.tabular import *\nfrom fastai.metrics import *\nfrom fastai.tabular.all import *","a9169576":"train0 = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ntest0 = pd.read_csv(\"..\/input\/titanic\/test.csv\")","404ab085":"data=pd.concat([train0,test0],sort=False)","1fc1a212":"data['Sex'].replace(['male','female'], [0, 1], inplace=True)\ndata['Embarked'].fillna(('S'), inplace=True)\ndata['Embarked'] = data['Embarked'].map( {'S': 0, 'C': 1, 'Q': 2} ).astype(int)\ndata['Fare'].fillna(np.mean(data['Fare']), inplace=True)\ndata['fare_value']=data['Fare']\/50\nage_avg = data['Age'].mean()\nage_std = data['Age'].std()\ndata['Age'].fillna(np.random.randint(age_avg - age_std, age_avg + age_std), inplace=True)\ndata['age_value']=data['Age']\/50\ndata['family'] = (data['SibSp'] + data['Parch'])\/5\ndata['isAlone'] = 0\ndata.loc[data['family'] > 0, 'isAlone'] = 1\ndelete_columns = ['Name','SibSp','Parch','Ticket','Cabin','Age','Fare']\ndata.drop(delete_columns, axis=1, inplace=True)","cc37a7f2":"train = data[:len(train0)]\ntest = data[len(train0):]","656f445c":"train.columns","7701df39":"dep_var = \"Survived\"\ncat_names= ['Pclass', 'Sex', 'Embarked', 'isAlone',],\ncont_names = ['fare_value', 'age_value', 'family',],","de5c9b78":"procs = [Normalize]","47f87b33":"dls1 = TabularDataLoaders.from_df(train,'..\/input\/titanic\/train.csv', \n                    cat_names= ['Pclass', 'Sex', 'Embarked', 'isAlone',],\n                    cont_names = ['fare_value', 'age_value', 'family',],\n                    y_names='Survived',\n                    procs = [Categorify, FillMissing, Normalize])\ndls1","4a643e6b":"learn = tabular_learner(dls1,layers=[200,100],metrics=accuracy)\nlearn","297d63ef":"learn.fit_one_cycle(10,1e-02)","e65d9bf2":"preds, y_true=learn.get_preds()","6cabf56d":"# targs = true value, preds = predicted value\npreds,targs = learn.get_preds()\nprint(preds[0:3])\nprint(targs[0:3])\nprint(len(targs))","7ed891bc":"preds2=[]\nfor i in range(len(preds)):\n    preds2+=[np.where(preds[i]<0.5,0,1)[0]]\nprint(preds2[0:3])","57a19709":"targs=targs.numpy().reshape(-1)\ntargs[0:3]","6fde30c0":"targs=pd.Series(targs).astype(int).tolist()\ntargs[0:3]","c7a0b2ba":"# result of validation\nprint(classification_report(targs,preds2))","bd648a48":"learn.recorder.plot_sched()","7f0ad261":"learn.show_results()","f51f507b":"tpreds=[]\nfor i in range(len(test)):\n    _, _, probs = learn.predict(test.iloc[i])\n    tpreds+=[probs.numpy()[0]]","4940a40a":"print(tpreds[0:3])","bf5c2e14":"tpreds2=[]\nfor i in range(len(tpreds)):  \n    tpreds2+=[np.where(tpreds[i]<0.5,0,1).tolist()]\nprint(tpreds2[0:3])","523f33e0":"submit=pd.read_csv('..\/input\/titanic\/gender_submission.csv')\nsubmit['Survived']=tpreds2\nsubmit.to_csv('submission.csv',index=None)\nsubmit","42f1eb59":"### What is Fastai?\n\nfast.ai is a non-profit research group focused on deep learning and artificial intelligence. It was founded in 2016 by [Jeremy Howard](https:\/\/www.kaggle.com\/jhoward) and Rachel Thomas with the goal of democratising deep learning. They do this by providing a massive open online course (MOOC) named \"Practical Deep Learning for Coders,\" which has no other prerequisites except for knowledge of the programming language Python. (Wikipedia)\n","0fe620e9":"https:\/\/docs.fast.ai\/callback.schedule.html#Recorder.plot_sched","fcd708a6":"https:\/\/docs.fast.ai\/data.transforms.html#Normalize","721b7cd4":"https:\/\/docs.fast.ai\/learner.html#Learner.predict","dfde776d":"### use tabularpandas, predict by fastai\nhttps:\/\/www.kaggle.com\/stpeteishii\/titanic2-fastai-with-tabularpandas\n### use tabularpandas, predict not by fastai\nhttps:\/\/www.kaggle.com\/stpeteishii\/titanic-classify-with-fastai-tabularpandas\n### not use tabularpandas, predict by fastai (this notebook)\nhttps:\/\/www.kaggle.com\/stpeteishii\/titanic-fastai","da041aab":"https:\/\/docs.fast.ai\/tabular.data.html#TabularDataLoaders.from_df","d2eb68f4":"# Test data prediction","0a8a6b10":"![Upvote!](https:\/\/img.shields.io\/badge\/Upvote-If%20you%20like%20my%20work-07b3c8?style=for-the-badge&logo=kaggle)","a303c6c0":"## TabularLearner","62db1a8e":"## TabularDataLoaders","679fad08":"https:\/\/docs.fast.ai\/learner.html#Learner.get_preds","6de7d4e3":"# Titanic Fastai\nThis notebook referred to the followings.<br\/>\nhttps:\/\/www.kaggle.com\/masoodrehman\/iris-species-fastai-accuracy-95<br\/>\nhttps:\/\/docs.fast.ai\/","f3d19aa5":"https:\/\/docs.fast.ai\/tabular.learner.html","40761ee1":"https:\/\/docs.fast.ai\/learner.html#Learner.show_results"}}