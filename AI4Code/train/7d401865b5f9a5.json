{"cell_type":{"afc0d86b":"code","58b38d0b":"code","56772e76":"code","1ace9f12":"code","ffec5872":"code","00775c01":"code","2af69256":"code","e66cbd51":"code","07b10caf":"code","6d054e7b":"code","f82198d1":"code","a1ccdc30":"code","f16ff87b":"code","df0cd571":"code","681902e9":"code","f72af6df":"code","8d78e542":"code","6a3bc02c":"code","eeb701e5":"code","7c690cac":"code","e0667c7c":"code","8afa7ba0":"code","a86db027":"code","89753620":"code","4d021107":"code","673c1e05":"code","9e70b0d9":"code","ee21866b":"code","ec14db05":"code","480c6723":"code","0a8f8cca":"code","1ecda4da":"code","a554d25d":"code","12fe295c":"code","ee580a2c":"code","3ee587fe":"code","5f2fde13":"code","36fead27":"code","8467789d":"markdown","3df8cd18":"markdown","e6015873":"markdown","3ffaf1b5":"markdown","92631831":"markdown","6dfac9b9":"markdown","873b41f2":"markdown","f7333f04":"markdown","3e48ec12":"markdown","243271e8":"markdown","3c0922fe":"markdown","c0cc038e":"markdown","c5998ada":"markdown","9076d47d":"markdown","317bf2ba":"markdown","e3f35791":"markdown","d82374ee":"markdown","a4041df4":"markdown"},"source":{"afc0d86b":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt \n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\n","58b38d0b":"# Set Color Palettes for the notebook\nmy_color_palette = [\"#d81159\",\"#8f2d56\",\"#218380\",\"#fbb13c\",\"#73d2de\"]\nsns.palplot(sns.color_palette(my_color_palette))\n\n# Set Style\n#sns.set_style(\"whitegrid\")\nsns.despine(left=True, bottom=True)","56772e76":"df_holiday_events = pd.read_csv('..\/input\/store-sales-time-series-forecasting\/holidays_events.csv',parse_dates =['date'])\ndf_oil = pd.read_csv('..\/input\/store-sales-time-series-forecasting\/oil.csv',parse_dates =['date'])\ndf_sample_submission = pd.read_csv('..\/input\/store-sales-time-series-forecasting\/sample_submission.csv')\ndf_stores = pd.read_csv('..\/input\/store-sales-time-series-forecasting\/stores.csv')\ndf_test = pd.read_csv('..\/input\/store-sales-time-series-forecasting\/test.csv',parse_dates =['date'])\ndf_train = pd.read_csv('..\/input\/store-sales-time-series-forecasting\/train.csv',parse_dates =['date'])\ndf_transactions = pd.read_csv('..\/input\/store-sales-time-series-forecasting\/transactions.csv',parse_dates =['date'])","1ace9f12":"# helper function \n\ndef get_df_name(df):\n    name =[x for x in globals() if globals()[x] is df][0]\n    return name\n\ndef check_df(dataframe):\n    print('*'*30+'Name of dataframe'+'*'*30)\n    print(get_df_name(dataframe))\n    print('*'*30+'Shape of dataframe'+'*'*30)\n    print(dataframe.shape)\n    print('\\n'+'*'*30+'Head of dataframe'+'*'*30)\n    print(dataframe.head())\n    print('\\n'+'*'*30+'Tail of dataframe'+'*'*30)\n    print(dataframe.tail())\n    print('\\n'+'*'*30+'Concise summary of dataframe'+'*'*30)\n    print(dataframe.info())\n    print('\\n'+'*'*30+'Check for missing values'+'*'*30)\n    print(dataframe.isnull().sum())\n    print('\\n'+'*'*30+'Check dataframe for numeric and categorical variables'+'*'*30)\n    \n    numeric_variables = dataframe.select_dtypes(include=[np.number])\n    categorical_variables = dataframe.select_dtypes(exclude=[np.number])\n\n    print('Numeric variables in the given dataframe : ',numeric_variables.shape[1])\n    print('Categorical variables in the givne dataframe:',categorical_variables.shape[1])\n","ffec5872":"check_df(df_holiday_events)\n","00775c01":"# rename the column name for oil dataframe.\ndf_oil.rename(columns={'dcoilwtico':'oil_price'}, inplace=True)\ncheck_df(df_oil)","2af69256":"check_df(df_sample_submission)","e66cbd51":"check_df(df_stores)","07b10caf":"check_df(df_test)","6d054e7b":"check_df(df_train)\n","f82198d1":"check_df(df_transactions)\n","a1ccdc30":"# Let's check the store data\n\ndf_stores.head()","f16ff87b":"df_stores.type.value_counts()\n","df0cd571":"df_stores.state.value_counts()","681902e9":"df_stores.city.value_counts()","f72af6df":"plt.figure(figsize=(20, 15))\nsns.countplot(data=df_stores, x='type', order=df_stores.type.value_counts().index,palette=my_color_palette)\nplt.title('Number of Stores based on Type',fontweight=\"bold\")\nplt.xlabel('Type', fontsize=18)\nplt.ylabel('Count', fontsize=16)\nplt.show()\n","8d78e542":"plt.figure(figsize=(20, 15))\n\nsns.countplot(data=df_stores, y='city', \n              order=df_stores.city.value_counts().index,\n              palette=my_color_palette,\n              )\nplt.title('Number of Stores based on Cities',fontweight=\"bold\")\nplt.ylabel('City', fontsize=18)\nplt.xlabel('Count', fontsize=16)\n","6a3bc02c":"plt.figure(figsize=(20, 15))\n\nsns.countplot(data=df_stores, y='state', \n              order=df_stores.state.value_counts().index,\n              palette=my_color_palette,\n              )\nplt.title('Number of Stores based on State',fontweight=\"bold\")\nplt.ylabel('State', fontsize=18)\nplt.xlabel('Count', fontsize=16)\n","eeb701e5":"# Data preparation\n# Let's combine the dataframes\n\n#https:\/\/www.kaggle.com\/madhuri15\/store-sales-time-series-analysis\n    \n# Let's merge oil data into the train and test data\ntrain = df_train.merge(df_oil, on='date')\ntest = df_train.merge(df_oil, on='date') \n    \ntrain = train.merge(df_holiday_events[['date', 'type', 'transferred']], on='date')\ntrain = train.merge(df_stores, on='store_nbr')\ntrain.rename(columns={'type_x':'holiday_type', 'type_y':'store_type'}, inplace=True)\n\n","7c690cac":"train['Year'] = train.date.dt.year\ntrain['Year-Month'] = train['date'].apply(lambda x : x.strftime('%Y-%m'))\ntrain['Month'] = train.date.dt.month\ntrain['Day'] = train.date.dt.day","e0667c7c":"train","8afa7ba0":"test","a86db027":"check_df(train)","89753620":"check_df(test)","4d021107":"train.family.value_counts()","673c1e05":"train.family.unique()","9e70b0d9":"plt.figure(figsize=(20, 15))\n\nsns.barplot(x='sales',y='family',data=train)\nplt.title('Distribution of Sales considering Product',fontweight=\"bold\")\nplt.ylabel('Family', fontsize=18)\nplt.xlabel('Sales', fontsize=16)\n","ee21866b":"plt.figure(figsize=(20, 15))\n\nsns.barplot(x='sales',y='state',data=train, ci=None)\nplt.title('Distribution of Sales considering State',fontweight=\"bold\")\nplt.ylabel('State', fontsize=18)\nplt.xlabel('Sales', fontsize=16)\n","ec14db05":"plt.figure(figsize=(20, 15))\n\nsns.barplot(x='sales',y='city',data=train, ci=None)\nplt.title('Distribution of Sales considering City',fontweight=\"bold\")\nplt.ylabel('City', fontsize=18)\nplt.xlabel('Sales', fontsize=16)\n","480c6723":"train","0a8f8cca":"plt.figure(figsize=(20, 15))\nsns.boxenplot(x = \"Year\", y = \"sales\", \n              data = train,palette=my_color_palette)\nplt.title('Distribution of Sales by Year',fontweight=\"bold\")\nplt.xlabel('Year', fontsize=18)\nplt.ylabel('Sales', fontsize=16)\nplt.show()","1ecda4da":"plt.figure(figsize=(20, 15)) \nsns.lineplot(train['Month'], train['sales'], hue=train['Year'], palette=my_color_palette)\nplt.title('Seasonal plot of Sales', fontsize = 20, loc='center', fontdict=dict(weight='bold'))\nplt.xlabel('Month', fontsize = 16, fontdict=dict(weight='bold'))\nplt.ylabel('Sales', fontsize = 16, fontdict=dict(weight='bold'))\nplt.show()","a554d25d":"ts=train.groupby(['date'])[\"sales\"].sum()","12fe295c":"# credits : https:\/\/www.kaggle.com\/jagangupta\/time-series-basics-exploring-traditional-ts\n\nplt.figure(figsize=(20, 15)) \nplt.plot(ts.rolling(window=12,center=False).mean(),label='Rolling Mean');\nplt.plot(ts.rolling(window=12,center=False).std(),label='Rolling Stanard Deviation');\nplt.legend();","ee580a2c":"import statsmodels.api as sm\n# multiplicative\nres = sm.tsa.seasonal_decompose(ts.values,freq=12,model=\"multiplicative\")\n#plt.figure(figsize=(16,12))\nfig = res.plot()\n#fig.show()","3ee587fe":"# Additive model\nres = sm.tsa.seasonal_decompose(ts.values,freq=12,model=\"additive\")\n#plt.figure(figsize=(16,12))\nfig = res.plot()\n#fig.show()","5f2fde13":"from statsmodels.tsa.stattools import adfuller, acf, pacf,arma_order_select_ic","36fead27":"# Stationarity tests\ndef test_stationarity(timeseries):\n    \n    #Perform Dickey-Fuller test:\n    print('Results of Dickey-Fuller Test:')\n    dftest = adfuller(timeseries, autolag='AIC')\n    dfoutput = pd.Series(dftest[0:4], index=['Test Statistic','p-value','#Lags Used','Number of Observations Used'])\n    for key,value in dftest[4].items():\n        dfoutput['Critical Value (%s)'%key] = value\n    print (dfoutput)\n\ntest_stationarity(ts)","8467789d":"<img src=\"https:\/\/www.quirkybyte.com\/wp-content\/uploads\/2018\/10\/66e3a30f3843.gif\" width=\"1280\" height=\"720\">\n","3df8cd18":"<a id=\"2\"><\/a>\n<h1 style='background:#c3c087; border:0; color:black'><center> Loading Data <\/center><\/h1> \n","e6015873":"<h1 style='background:#c3c087; border:0; color:black'><center> \ud83c\udf3b Thank you \ud83c\udf3b <\/center><\/h1> \n","3ffaf1b5":"![](https:\/\/raw.githubusercontent.com\/sachinprabhu007\/Kaggle_Covers\/main\/Kaggle_Store_Sales_EDA.jpg)","92631831":"**\ud83c\udf3bThis notebook is handcrafted with lots of love. If you have learnt something new or found it helpful, Please upvote \ud83d\udc4d\ud83c\udf3b**","6dfac9b9":"<img src=\"https:\/\/i.pinimg.com\/originals\/2e\/e6\/99\/2ee6998e34c3e2eff7b894c66cfc5267.jpg\"  width=\"1280\" height=\"720\">\n","873b41f2":"<h1 style='background:#c3c087; border:0; color:black'><center> \ud83d\udea7Work in Progress\ud83d\udea7 <\/center><\/h1> \n","f7333f04":"<a id=\"3.2\"><\/a>\n<h1 style='background:#c3c087; border:0; color:black'><center> Time Series Forecasting <\/center><\/h1> \n\n<img src=\"https:\/\/i.pinimg.com\/originals\/31\/53\/2d\/31532d7d378053de3b8bf23c6e7bfae3.gif\" width=\"1280\" height=\"720\">\n\n### What is Time Series? \n\nGiven a data if it is recorded over consistent intervals of time it is referred as Time Series\n\n\n### What is the difference between Prediction and Forecasting?\n\n\nPrediction is concerned with estimating the outcomes for unseen data. For this purpose, we fit a model to a training data set, which results in an estimator f^(x) that can make predictions for new samples x.\n\nForecasting is a sub-discipline of prediction in which we are making predictions about the future, on the basis of time-series data. Thus, the only difference between prediction and forecasting is that we consider the temporal dimension. \n\n\nAn estimator for forecasting has the form f^(x1,\u2026,xt) where x1,\u2026,xt indicate historic measurements at time points 1,\u2026,t, while the estimate relates to time point t+1 or some other time in the future. Since the model depends on previous observations, xi, this is called an autoregressive model.\n\n\n\n### What is the difference betweeen Time Series Analysis and Time Series Prediction?\n\n- Time series analysis comprises methods for analyzing time series data in order to extract meaningful statistics and other characteristics of the data. \n\n- Time series forecasting is the use of a model to predict future values based on previously observed values\n\n\n\n### Types of Time Series Data\n\nThere are four main types of time-series data, which are\n\n1. Seasonal - The patterns of the data are repeated over a specific period.\n2. Trend - The values of the data are increased or decreased in a reasonably predictable pattern.\n3. Cyclical -The values of the data exhibit rises and falls that are not of a fixed frequency often due to economic conditions.\n4. Random - The patterns of the data do not fall in any 3 categories mentioned above. They are totally irregular.\n\n\n### What is Seasonality ? \n\nSeasonality refers to periodic fluctuations. For example, electricity consumption is high during the day and low during night, or online sales increase during Christmas before slowing down again.\n\n\n### What is Stationarity?\n\nA time series is said to be stationary if its statistical properties do not change over time. In other words, it has constant mean and variance, and covariance is independent of time.\n\n","3e48ec12":"<a id=\"1\"><\/a>\n<h1 style='background:#c3c087; border:0; color:black'><center> Importing Libraries <\/center><\/h1> \n","243271e8":"<a id=\"3.1\"><\/a>\n<h1 style='background:#c3c087; border:0; color:black'><center> \ud83d\udea7Data Preparation and Analysis\ud83d\udea7 <\/center><\/h1> \n\n\nSince our dataset doesn't have missing values we will move forward and analyze data in detail","3c0922fe":"1. https:\/\/en.wikipedia.org\/wiki\/Time_series\n\n2. https:\/\/datascienceblog.net\/post\/machine-learning\/forecasting_vs_prediction\/\n\n3. https:\/\/towardsdatascience.com\/the-complete-guide-to-time-series-analysis-and-forecasting-70d476bfe775\n\n4. https:\/\/medium.com\/vitrox-publication\/what-is-a-time-series-forecasting-d020d657f11a\n","c0cc038e":"<a id='top'><\/a>\n<div class=\"list-group\" id=\"list-tab\" role=\"tablist\">\n<h1 style='background:#c3c087; border:0; color:black'><center> Table of Contents <\/center><\/h1> \n\n[1. Importing Libraries](#1)\n    \n[2. Loading Data](#2)    \n\n[3. EDA](#3)     \n    \n[3.1. Data Cleaning and Analysis](#3.1) \n   \n[3.2 Time Series Analysis](#3.2) \n\n\n        \n","c5998ada":"<a id=\"3\"><\/a>\n<h1 style='background:#c3c087; border:0; color:black'><center> EDA <\/center><\/h1> \n","9076d47d":"<h1 style='background:#c3c087; border:0; color:black'><center> Introduction <\/center><\/h1> \n\nAim of this competition is to use time series forecasting to forecast store sales on given data. Let's go through the data to predict grocery sales.\n\nDataset source : Corporaci\u00f3n Favorita, a large Ecuadorian-based grocery retailer\n\n\n<div class=\"alert simple-alert\">\n\ud83c\udf3b This notebook is inspired by storytelling skills \/ layouts used in notebooks by <b>Karnika Kapoor\n<\/b> <a href=\"https:\/\/www.kaggle.com\/karnikakapoor\/code\"> Notebooks - Karnika Kapoor  <\/a> and <b> Andrada Olteanu\n<\/b> <a href=\"https:\/\/www.kaggle.com\/andradaolteanu\/code\"> Notebooks - Andrada Olteanu<\/a>. Please go check their work for amazing visualizations! Always fascinating! \n    \n    \nGrateful to both for sharing their work with everyone on Kaggle \ud83c\udf3b \ud83d\ude4f\n<\/div>\n\n\n\n","317bf2ba":"<h1 style='background:#c3c087; border:0; color:black'><center>  \u270f\u2712\ud83d\udcda References \u270f\u2712\ud83d\udcda <\/center><\/h1> \n","e3f35791":"<h1 style='background:#c3c087; border:0; color:black'><center>Store Sales - EDA<\/center><\/h1> ","d82374ee":"Since we are dealing with time let's summon Dr.Strange and go through the notebook shall we?\n\n<img src=\"https:\/\/c.tenor.com\/zInCuCM3WVEAAAAC\/doctor-strange-benedict-cumberbatch.gif\" width=\"1280\" height=\"720\">\n","a4041df4":"### What is Rolling Mean and Rolling Standard Deviation?\n\nRolling is a very useful operation for time series data. Rolling means creating a rolling window with a specified size and perform calculations on the data in this window which, of course, rolls through the data. The figure below explains the concept of rolling.\n\n\n<img src=\"https:\/\/miro.medium.com\/max\/820\/1*jqix0WWK_zDf5iIICpMVjw.png\" >\n\n\n### Why do we use Rolling or Moving  Standard Deviation?\n\nMoving Standard Deviation is a statistical measurement of market volatility. It makes no predictions of market direction, but it may serve as a confirming indicator. We specify the number of periods to use, and the study computes the standard deviation of prices from the moving average of the prices\n\n### What is Market volatility?\n\nIn statistical terms, volatility is the standard deviation of a market or security's annualised returns over a given period - essentially the rate at which its price increases or decreases. If the price fluctuates rapidly in a short period, hitting new highs and lows, it is said to have high volatility.\n\n\n\n\nDocumentation :\nhttps:\/\/pandas.pydata.org\/docs\/reference\/api\/pandas.DataFrame.rolling.html\n\nCredits : \n\n1. https:\/\/towardsdatascience.com\/time-series-analysis-resampling-shifting-and-rolling-f5664ddef77e\n2. https:\/\/www.danielstrading.com\/education\/technical-analysis-learning-center\/moving-standard-deviation\n3. https:\/\/www.fidelity.com.sg\/beginners\/what-is-volatility\/market-volatility#:~:text=In%20statistical%20terms%2C%20volatility%20is,said%20to%20have%20high%20volatility."}}