{"cell_type":{"ad52b88e":"code","8c14e199":"code","a556752e":"code","d4d5bbd2":"code","009a6e77":"code","563586f2":"code","bf441565":"code","ae176b02":"code","db4f3357":"code","1e64dbd1":"markdown","11d03481":"markdown","1369452b":"markdown","a49d3854":"markdown","c0e221dd":"markdown","33be4221":"markdown","32137a70":"markdown","b21791d5":"markdown","9edd2b5a":"markdown","3188c49f":"markdown"},"source":{"ad52b88e":"import sys\npackage_dir = '..\/input\/autokeras-april-2021'\nsys.path.insert(0, package_dir)","8c14e199":"import pandas as pd\n\ndata_train = pd.read_csv(\"\/kaggle\/input\/commonlitreadabilityprize\/train.csv\")\ndata_test = pd.read_csv(\"\/kaggle\/input\/commonlitreadabilityprize\/test.csv\")\n\ndata_train.head()","a556752e":"data_train[\"excerpt\"] = data_train[\"excerpt\"].apply(lambda x: \"<bos> \"+x+\" <eos>\")\ndata_test[\"excerpt\"] = data_test[\"excerpt\"].apply(lambda x: \"<bos> \"+x+\" <eos>\")","d4d5bbd2":"text_train = data_train[\"excerpt\"].values\ntext_test = data_test[\"excerpt\"].values\ntext_train.shape","009a6e77":"labels_train = data_train[\"target\"].to_numpy()","563586f2":"import autokeras\n\ntext_regressor = autokeras.TextRegressor(\n    #loss=\"mean_squared_error\",\n    max_trials=25,\n    #objective=\"val_loss\",\n    overwrite=True\n)\n\ntext_regressor.fit(x=text_train, y=labels_train, validation_split=0.1)\n","bf441565":"import numpy as np\n\n\ntest_predictions = text_regressor.predict(text_test).flatten()\nnp.set_printoptions(suppress=True)\nprint(test_predictions)\n","ae176b02":"data_to_submit = pd.DataFrame({\n    'id':data_test['id'],\n    'target': test_predictions\n})\ndata_to_submit.to_csv('submission.csv', index = False)\ndata_to_submit","db4f3357":"import shutil\n\ndir_path = 'text_regressor'\n\nshutil.rmtree(dir_path)","1e64dbd1":"Submission\n===","11d03481":"\nExtract labels\n===","1369452b":"Add beginning of string and end of string tokens\n===","a49d3854":"Load the data into pandas\n===","c0e221dd":"Synopsis\n===\nBarebones autokeras regression.\n\nHeavily influenced by https:\/\/www.kaggle.com\/heyytanay\/auto-keras-text-regression-starter\/data\n","33be4221":"Cleanup to make submission easier\n===","32137a70":"Predictions\n===","b21791d5":"Install autokeras\n===","9edd2b5a":"Extract features\n===","3188c49f":"Building and training the model\n==="}}