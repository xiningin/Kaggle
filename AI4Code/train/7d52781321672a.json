{"cell_type":{"a83c7e03":"code","8d8f0b91":"code","e14bf866":"code","16fe8be8":"code","8d0f776f":"code","dc3d8ac7":"code","c1272388":"markdown"},"source":{"a83c7e03":"import pandas as pd\nimport numpy as np\n\nfrom matplotlib import pyplot as plt\nimport seaborn as sns","8d8f0b91":"df = pd.read_csv('\/kaggle\/input\/work_3.csv', delimiter=';', usecols=['metrics', 'group'])\ndf['metrics'] = df['metrics'].str.replace(',', '.')\ndf['metrics'] = df['metrics'].astype(float)\ndf_0, df_1 = df[df['group'] == 0], df[df['group'] == 1]","e14bf866":"plt.figure(figsize=(15, 8))\nsns.distplot(df_0['metrics'])\nsns.distplot(df_1['metrics'])","16fe8be8":"# \u0420\u0430\u0437\u0434\u0435\u043b\u044f\u044e \u0432\u044b\u0431\u043e\u0440\u043a\u0443 \u043d\u0430 \u0434\u0435\u0446\u0438\u043b\u0438\ndef split_to_deciles(df):\n    deciles_values = np.percentile(df['metrics'].values, np.arange(0, 100, 10))\n    deciles_values = np.append(deciles_values, df['metrics'].max())\n    deciles = []\n    for i in range(1, len(deciles_values)):\n        deciles.append(df[(df['metrics'] >= deciles_values[i - 1]) & (df['metrics'] < deciles_values[i])]['metrics'].values)\n    return deciles\ndeciles_0 = split_to_deciles(df_0)\ndeciles_1 = split_to_deciles(df_1)","8d0f776f":"def split_to_buckets(data, bucket_count):\n    idx = np.arange(0, len(data))\n    np.random.shuffle(idx)\n    buckets = [data[bucket_idx] for bucket_idx in np.array_split(idx, bucket_count)]\n    return buckets","dc3d8ac7":"bucket_count = 1000\n\nfig_shape = (5, 2)\nfig, axs = plt.subplots(*fig_shape)\nfig.set_figheight(25)\nfig.set_figwidth(15)\n\nfor decile_num in range(len(deciles_0)):\n    # \u041a\u0430\u0436\u0434\u044b\u0439 \u0434\u0435\u0446\u0438\u043b\u044c \u0432 \u043a\u0430\u0436\u0434\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435 \u0440\u0430\u0437\u0431\u0438\u0432\u0430\u044e \u043d\u0430 \u0431\u0430\u043a\u0435\u0442\u044b \u0438 \u0441\u0442\u0440\u043e\u044e \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0441\u0440\u0435\u0434\u043d\u0438\u0445 \u0432 \u0431\u0430\u043a\u0435\u0442\u0430\u0445\n    buckets_0 = split_to_buckets(deciles_0[decile_num], bucket_count)\n    means_0 = [b.mean() for b in buckets_0]\n    ci_0 = np.percentile(means_0, [2.5, 97.5])\n    \n    buckets_1 = split_to_buckets(deciles_1[decile_num], bucket_count)\n    means_1 = [b.mean() for b in buckets_1]\n    ci_1 = np.percentile(means_1, [2.5, 97.5])\n    \n    #\u0420\u0438\u0441\u0443\u044e \u0433\u0440\u0430\u0444\u0438\u043a\u0438\n    row = decile_num \/\/ fig_shape[1]\n    column = decile_num - fig_shape[1] * row\n    \n    sns.distplot(means_0, color='red', axlabel='decile ' + str(decile_num + 1), ax=axs[row][column])\n    sns.distplot(means_1, color='blue', axlabel='decile ' + str(decile_num + 1), ax=axs[row][column])","c1272388":"\u0414\u0430\u0436\u0435 \u0431\u0435\u0437 \u0434\u043e\u0432\u0435\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b\u043e\u0432 \u043d\u0430 \u0433\u0440\u0430\u0444\u0438\u043a\u0430\u0445 \u0432\u0438\u0434\u043d\u043e, \u0447\u0442\u043e \u0441\u0440\u0435\u0434\u043d\u0438\u0435 \u0432 \u0432\u044b\u0431\u043e\u0440\u043a\u0430\u0445 \u043d\u0435 \u0440\u0430\u0437\u043b\u0447\u0430\u044e\u0442\u0441\u044f"}}