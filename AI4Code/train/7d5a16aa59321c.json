{"cell_type":{"e4e24a0e":"code","a5a1682f":"code","978df7e2":"code","66405ab4":"code","2db5dcd2":"code","0386d8ec":"code","36ab981a":"code","7d5579e4":"code","9626271c":"code","277b146d":"code","37c62be9":"code","2b475e5c":"code","e6467e6a":"code","c3c7d456":"code","7b334be7":"code","04fdce40":"code","d9e8d31f":"code","a3057c34":"code","2e5236d5":"code","f1423e90":"code","17584daf":"code","57aa24cd":"code","c2b91514":"code","6114d87f":"code","0260ab45":"code","5278c01f":"code","2d7f6b12":"code","55ce705d":"code","7391e95b":"code","ebbaf8eb":"code","9bada751":"code","a0a7cb3e":"code","a6d9d7f6":"code","99129c99":"code","fc4497da":"code","c8bbd162":"code","beaac7f3":"code","7d1a96d0":"code","e2dc604e":"code","874e3dc6":"code","94844040":"code","5e5f3ac4":"code","dfa517b0":"code","93b68279":"code","03f12339":"code","095e79d7":"code","fdef231a":"code","43fb274f":"code","f69196bb":"code","8ceaf397":"code","a3f32a92":"code","f5bc7d5c":"markdown"},"source":{"e4e24a0e":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.ensemble import ExtraTreesClassifier\nfrom collections import Counter\nimport plotly.express as px\nfrom sklearn.preprocessing import StandardScaler,Normalizer\nfrom sklearn.metrics import confusion_matrix,accuracy_score, mean_squared_error, log_loss\nfrom imblearn.combine import SMOTETomek\nfrom sklearn.model_selection import RandomizedSearchCV","a5a1682f":"data = pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')","978df7e2":"data.head()","66405ab4":"data.info()","2db5dcd2":"df = data.copy()","0386d8ec":"df.head()","36ab981a":"data.isnull().sum()","7d5579e4":"data.dtypes","9626271c":"df['sex'] = df['sex'].map({1:'Male',0:'Female'})","277b146d":"sns.distplot(df['age'],kde=True)","37c62be9":"sns.catplot(x='age',hue='output',col='sex',data=df,kind='count', orient=True)","2b475e5c":"df.head()","e6467e6a":"df['output'] = df['output'].map({0:'less chances',1:'More chances'})","c3c7d456":"sns.catplot(x='sex',hue='output',data=df,kind='count', orient=True)","7b334be7":"sns.catplot(x='sex',y = 'age', hue='output',data=df,kind='bar')","04fdce40":"df.groupby(['output'])['output'].count().plot.bar()","d9e8d31f":"decision =  df['output'].value_counts().reset_index()\ndecision.columns = ['Decision','Count']\npx.pie(decision,names='Decision',values='Count',color_discrete_sequence=px.colors.sequential.Emrld_r)","a3057c34":"sns.pairplot(data=df,hue='output')","2e5236d5":"data.head()","f1423e90":"X = data.iloc[:,:-1]","17584daf":"y=data.iloc[:,-1]","57aa24cd":"from imblearn.combine import SMOTETomek\nimb = SMOTETomek(random_state=42)\nX,y = imb.fit_resample(X,y)","c2b91514":"Counter(y)","6114d87f":"IMP = ExtraTreesClassifier()\nIMP.fit(X,y)\nranked_feat = pd.Series(IMP.feature_importances_,index=X.columns)\nranked_feat.nlargest(13).plot(kind='barh')","0260ab45":"stand = Normalizer()","5278c01f":"x = pd.DataFrame(stand.fit_transform(X),columns=X.columns)","2d7f6b12":"x.head()","55ce705d":"from sklearn.feature_selection import mutual_info_classif\nmutual_info = mutual_info_classif(x,y)\nmutual_data = pd.Series(mutual_info, index=x.columns)\nmutual_data.sort_values(ascending=True)","7391e95b":"print(x.shape)\nprint(y.shape)","ebbaf8eb":"XX_train,X_test,yy_train,y_test = train_test_split(x,y,random_state=42,test_size=42)\nX_train,X_cv,y_train,y_cv = train_test_split(XX_train,yy_train,test_size=42,random_state=42)","9bada751":"RF = RandomForestClassifier()\nRF_param = {'n_estimators':range(1,500,10),'max_depth':range(1,50,2)}\nRF_search = RandomizedSearchCV(RF,RF_param,scoring='neg_mean_squared_error',cv=10,n_jobs=-1)\nRF_search.fit(X_cv,y_cv)","a0a7cb3e":"print(RF_search.best_params_)\nprint(RF_search.best_score_)\nprint(RF_search.best_estimator_)","a6d9d7f6":"RF_result = RandomForestClassifier(n_estimators=391,max_depth=37)\nRF_result.fit(X_train,y_train)\npred1 = RF_result.predict(X_test)","99129c99":"ACC1= accuracy_score(y_test,pred1)\nprint(accuracy_score(y_test,pred1))","fc4497da":"labels = [0,1]\nC = confusion_matrix(y_test,pred1)\nsns.heatmap(C,annot=True,xticklabels=labels,yticklabels=labels,vmax=2,vmin=1,linewidth=3,color='red')","c8bbd162":"DT = DecisionTreeClassifier()","beaac7f3":"param_d = {'criterion':['gini','entropy'],'max_depth':range(1,10)}\nGrida=GridSearchCV(DT,param_d,cv=10,n_jobs=-1)\nGrida.fit(X_cv,y_cv)","7d1a96d0":"print(Grida.best_params_)\nprint(Grida.best_score_)\nprint(Grida.best_estimator_)","e2dc604e":"DTC = DecisionTreeClassifier(criterion='entropy',max_depth=6)\nDTC.fit(X_train,y_train)\npred2 = DTC.predict(X_test)\nACC2 = accuracy_score(pred2,y_test)\nprint(accuracy_score(pred2,y_test))","874e3dc6":"labels = [0,1]\nC = confusion_matrix(y_test,pred2)\nsns.heatmap(C,annot=True,xticklabels=labels,yticklabels=labels)","94844040":"from sklearn.neighbors import KNeighborsClassifier\nKN = KNeighborsClassifier()\nparama = {'n_neighbors':range(1,30)}\nGrd = GridSearchCV(KN, parama,cv=10,scoring='neg_mean_squared_error')\nGrd.fit(X_cv,y_cv)","5e5f3ac4":"print(Grd.best_params_)\nprint(Grd.best_estimator_)\nprint(Grd.best_score_)","dfa517b0":"KNN = KNeighborsClassifier(n_neighbors=12)\nKNN.fit(X_train,y_train)\npred3 = KNN.predict(X_test)\nACC3 = accuracy_score(pred3,y_test)\nprint(accuracy_score(pred3,y_test))","93b68279":"labels = [0,1]\nC = confusion_matrix(y_test,pred3)\nsns.heatmap(C,annot=True,xticklabels=labels,yticklabels=labels)","03f12339":"from sklearn.linear_model import LogisticRegression\nfrom xgboost import XGBClassifier","095e79d7":"LR = LogisticRegression()\nLR.fit(X_train,y_train)\npred4 = LR.predict(X_test)\nprint(accuracy_score(pred4,y_test))\nACC4 = accuracy_score(pred4,y_test)","fdef231a":"labels = [0,1]\nC = confusion_matrix(y_test,pred4)\nsns.heatmap(C,annot=True,xticklabels=labels,yticklabels=labels)","43fb274f":"XGB = XGBClassifier()\nXGB.fit(X_train,y_train)\npred5 = XGB.predict(X_test)\nprint(accuracy_score(pred5,y_test))\nACC5 = accuracy_score(pred5,y_test)","f69196bb":"labels = [0,1]\nC = confusion_matrix(y_test,pred5)\nsns.heatmap(C,annot=True,xticklabels=labels,yticklabels=labels)","8ceaf397":"Final_Result = pd.DataFrame({'Algo':['RandomForest','DecisionTree','KNN','Logistic-Regresion','XGBoost'],\n                      'Accuracy':[ACC1,ACC2,ACC3,ACC4,ACC5]})","a3f32a92":"sns.catplot(x='Algo',y='Accuracy',data=Final_Result,kind='bar',orient='verticle')","f5bc7d5c":"### About Dataset\n\nAge : Age of the patient\n\nSex : Sex of the patient\n\ncp : Chest Pain type chest pain type\n\nValue 0: asymptomatic\nValue 1: typical angina\nValue 2: atypical angina\nValue 3: non-anginal pain\ntrtbps : resting blood pressure (in mm Hg)\n\nchol : cholestoral in mg\/dl fetched via BMI sensor\n\nfbs : (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)\n\nrest_ecg : resting electrocardiographic results\n\nValue 0: normal\nValue 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\nValue 2: showing probable or definite left ventricular hypertrophy by Estes' criteria\nthalach : maximum heart rate achieved\n\nexang: exercise induced angina (1 = yes; 0 = no)\n\noldpeak: ST depression induced by exercise relative to rest\n\nslp: the slope of the peak exercise ST segment (1 = upsloping; 2 = flat; 3 = downsloping)\n\nca: number of major vessels (0-3)\n\nthal - 3 = normal; 6 = fixed defect; 7 = reversable defect\n\nnum : 0= low Chances 1= High Chances"}}