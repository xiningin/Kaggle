{"cell_type":{"8fb32b6b":"code","4254a2f9":"code","21f4c2fd":"code","d10b039d":"code","e26c7a9f":"code","3640103d":"code","45a219b9":"code","c073dd7f":"code","ef2eb813":"code","f1bfff0c":"code","b04705df":"code","d7766ac9":"code","3727d69a":"code","b33dc188":"code","0e8fca38":"code","28f2d80b":"markdown","13c0ea65":"markdown","8217e767":"markdown","f2313a14":"markdown","5e24a3b0":"markdown","fea22c26":"markdown","eea15878":"markdown","f68cf848":"markdown","84137117":"markdown","2067a702":"markdown","3de3bf98":"markdown"},"source":{"8fb32b6b":"#import libs\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport pickle\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_absolute_error","4254a2f9":"#read train\ntrain = pd.read_csv(\"..\/input\/ventilator-pressure-prediction\/train.csv\")","21f4c2fd":"#since dataset is too big : sampling\ntrain = train.sample(frac =.01,random_state = 90, replace = False)\ntrain.shape","d10b039d":"train.head()","e26c7a9f":"train.isnull().sum()","3640103d":"train.info()","45a219b9":"train.corr()","c073dd7f":"sns.scatterplot(x=train[\"pressure\"],y=train['u_in'])","ef2eb813":"sns.histplot( x=train[\"u_in\"],binwidth=5 ,kde=True)","f1bfff0c":"#dropping breathid for reducing data complication\ntrain = train.drop(\"breath_id\",axis=1)","b04705df":"X = train.drop(\"pressure\",axis=1)\ny = train[\"pressure\"]","d7766ac9":"rf = RandomForestRegressor()\nrf.fit(X,y)","3727d69a":"pickle.dump(rf,open(\"rf.h5\",\"wb\"))","b33dc188":"rf_loaded = pickle.load(open(\"rf.h5\",\"rb\"))\npreds  = rf_loaded.predict(X[:1000])\nmae = mean_absolute_error(y[:1000],preds)","0e8fca38":"print(mae)","28f2d80b":"\u2b06\ufe0f it has saved !!","13c0ea65":"Pretty high score \ud83d\ude05","8217e767":"# 3:Saving the model in h5 format","f2313a14":"# 4:Loading the model","5e24a3b0":"u in and pressure have highest correlation","fea22c26":"# Intro\nSaving your pre trained model will save you a lot of time . So to show how this works I have made this notebook : \n","eea15878":"# 2:Building Model \ud83c\udf32","f68cf848":"looks like a solid block of blue , Data is spread all around","84137117":"# 1 : Data Analysis \nThe most important part","2067a702":"Thanks for viewing this notebook . Please upvote if you found this useful","3de3bf98":"![image.png](attachment:cc264b70-3434-4627-a3be-bdacc5ce6980.png)"}}