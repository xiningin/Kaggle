{"cell_type":{"f729e6b4":"code","4cc1f715":"code","f16334dd":"code","21a984ae":"code","7365cb36":"code","ac0d1ca5":"code","1b27339d":"markdown","7433f3eb":"markdown"},"source":{"f729e6b4":"import numpy as np\nimport pandas as pd\nfrom PIL import Image\nimport matplotlib.pyplot as plt","4cc1f715":"path = '..\/input\/jigsawpuzzle\/data\/'\n\ndata = pd.read_csv(path + 'label.csv')","f16334dd":"def solve_jigsaw(im, label, cuts=3, dim=201, channel=3):\n    \n    '''\n        This function rearange the image according to the label\n    '''\n    \n    cut_len = dim\/\/cuts\n    \n    new_im = np.zeros((dim,dim, channel))\n    for i in range(cuts):\n\n        hor_cut = im[i*cut_len:(i+1)*cut_len]\n\n        for j in range(cuts):\n\n            piece = hor_cut[:,j*cut_len:(j+1)*cut_len]      \n\n            pos = label[i*cuts+j]\n            x = pos\/\/cuts\n            y = pos%cuts\n\n            new_im[x*cut_len:(x+1)*cut_len,y*cut_len:(y+1)*cut_len] = piece\n\n    plt.imshow(new_im)\n    plt.show()\n","21a984ae":"id = 17\n\nim = Image.open(path + 'images\/' + data.iloc[id]['image'])\nim = np.array(im)\/255\nplt.imshow(im)\nplt.show()\nlabel = data.iloc[id]['label']\nlabel = [int(i) for i in label.split()]\n\nsolve_jigsaw(im, label)","7365cb36":"def load_image():\n        \n    x = []\n    y = []\n    \n    path = '..\/input\/jigsawpuzzle\/data\/images\/'\n    \n    for i in range(len(data)):\n        \n        im = Image.open(path + data.iloc[i]['image'])\n        im = np.array(im)\n        im = im\/255\n        x.append(im)\n        \n        label = data.iloc[i]['label']\n        label = [int(i) for i in label.split()]\n        y.append(label)\n            \n    return (np.array(x), np.array(y).reshape((-1,9,1)))","ac0d1ca5":"x, y = load_image()\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.1, random_state=42)","1b27339d":"### Loading images into training and testing set","7433f3eb":"### Rearranging the jigsaw image using label\u00b6"}}