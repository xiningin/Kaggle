{"cell_type":{"c2a7825b":"code","65fbe22e":"code","5cac607f":"code","66eeb962":"code","c8fcefea":"code","253fd36a":"code","63757c82":"code","496a969e":"code","f9ac52dc":"code","ae00b95a":"code","6785362f":"code","ab3d4d22":"code","14fac472":"code","c830e788":"code","05eee0e4":"code","311a8d35":"code","99533532":"code","524a59f1":"code","18f3b8ae":"code","22ed8fa7":"markdown","96a3f8cb":"markdown","89d39e2d":"markdown","19a32071":"markdown"},"source":{"c2a7825b":"# import Libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib as pyplot\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","65fbe22e":"# to see all the comands result in a single kernal \n%load_ext autoreload\n%autoreload 2\nfrom IPython.core.interactiveshell import InteractiveShell\nInteractiveShell.ast_node_interactivity = \"all\"","5cac607f":"# to increase no. of rows and column visibility in outputs\npd.set_option('display.max_rows', 500)\npd.set_option('display.max_columns', 500)\npd.set_option('display.width', 1000)","66eeb962":"#Upload data\ntrain = pd.read_csv(r'..\/input\/janatahack-crosssell-prediction\/train.csv')\ntest = pd.read_csv(r'..\/input\/janatahack-crosssell-prediction\/test.csv')\nsample_submmission = pd.read_csv(r'..\/input\/janatahack-crosssell-prediction\/sample_submission.csv')\ntrain.shape\ntest.shape\nsample_submmission.shape","c8fcefea":"train.head()","253fd36a":"train.isna().sum().sum()\ntest.isna().sum().sum()","63757c82":"train['Response'].value_counts()\/len(train)\ntrain['Gender'].value_counts()\ntrain['Vehicle_Age'].value_counts()\ntrain['Vehicle_Damage'].value_counts()","496a969e":"#converting onject to int type\ntrain['Vehicle_Age']=train['Vehicle_Age'].replace({'< 1 Year':0,'1-2 Year':1,'> 2 Years':2})\ntrain['Gender']=train['Gender'].replace({'Male':1,'Female':0})\ntrain['Vehicle_Damage']=train['Vehicle_Damage'].replace({'Yes':1,'No':0})\ntest['Vehicle_Age']=test['Vehicle_Age'].replace({'< 1 Year':0,'1-2 Year':1,'> 2 Years':2})\ntest['Gender']=test['Gender'].replace({'Male':1,'Female':0})\ntest['Vehicle_Damage']=test['Vehicle_Damage'].replace({'Yes':1,'No':0})","f9ac52dc":"train.columns","ae00b95a":"col_1=['Gender', 'Age', 'Driving_License', 'Region_Code', 'Previously_Insured', 'Vehicle_Age', 'Vehicle_Damage', 'Annual_Premium', 'Policy_Sales_Channel', 'Vintage']","6785362f":"# categorical column \ncat_col=['Gender','Driving_License', 'Region_Code', 'Previously_Insured', 'Vehicle_Age', 'Vehicle_Damage','Policy_Sales_Channel']","ab3d4d22":"train.info()","14fac472":"# changing data type because cat_feature in catboost cannot be float\ntrain['Region_Code']=train['Region_Code'].astype(int)\ntest['Region_Code']=test['Region_Code'].astype(int)\ntrain['Policy_Sales_Channel']=train['Policy_Sales_Channel'].astype(int)\ntest['Policy_Sales_Channel']=test['Policy_Sales_Channel'].astype(int)","c830e788":"X=train[col_1]\ny=train['Response']","05eee0e4":"len(test)\/(len(test)+len(train))","311a8d35":"from sklearn.metrics import roc_auc_score\nfrom sklearn.model_selection import train_test_split\nX_t, X_tt, y_t, y_tt = train_test_split(X, y, test_size=.25, random_state=150303,stratify=y,shuffle=True)","99533532":"from catboost import CatBoostClassifier\nfrom sklearn.metrics import accuracy_score\ncatb = CatBoostClassifier()\ncatb= catb.fit(X_t, y_t,cat_features=cat_col,eval_set=(X_tt, y_tt),plot=True,early_stopping_rounds=30,verbose=100)\ny_cat = catb.predict(X_tt)\nprobs_cat_train = catb.predict_proba(X_t)[:, 1]\nprobs_cat_test = catb.predict_proba(X_tt)[:, 1]\nroc_auc_score(y_t, probs_cat_train)\nroc_auc_score(y_tt, probs_cat_test)","524a59f1":"feat_importances = pd.Series(catb.feature_importances_, index=X_t.columns)\nfeat_importances.nlargest(15).plot(kind='barh')\n#feat_importances.nsmallest(20).plot(kind='barh')\nplt.show()","18f3b8ae":"cat_pred= catb.predict_proba(test[col_1])[:, 1]\nsample_submmission['Response']=cat_pred\nsample_submmission.to_csv(\"cat.csv\", index = False)","22ed8fa7":"# Basic Visualization","96a3f8cb":"# Don't Forget to Upvote, if you find this notebook useful. It encourage me to make more such notebooks.\n","89d39e2d":"# It is an Analytics vidhya Hackathon\n# To have better idea of probelm statement and to try your own notebook on Kaggle I have also added dataset with problem description.\n# https:\/\/www.kaggle.com\/jassican\/janatahack-crosssell-prediction","19a32071":"# Model "}}