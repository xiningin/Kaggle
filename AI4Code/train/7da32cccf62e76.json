{"cell_type":{"a027cb54":"code","031b2c14":"code","f300b67e":"code","732c81ca":"code","115bf0b7":"code","c80eb607":"code","d2570415":"code","a16ad1e0":"code","1ca0df60":"markdown","64103f9b":"markdown"},"source":{"a027cb54":"import numpy as np\nimport pandas as pd\nimport h2o\nfrom h2o.estimators import H2ORandomForestEstimator\n","031b2c14":"\ntrain = pd.read_csv('..\/input\/ncaaw-2021-features-only\/tourney.csv')\ntest = pd.read_csv('..\/input\/ncaaw-2021-features-only\/test.csv')","f300b67e":"train.shape","732c81ca":"h2o.init()","115bf0b7":"\nh2o_train_data = h2o.H2OFrame(train)\nh2o_test_data = h2o.H2OFrame(test)","c80eb607":"num_folds = 10\ntraining_columns = list(train.drop(['Season','TeamID1','TeamID2','result'], axis=1).columns)\n\n# Define model\nmodel = H2ORandomForestEstimator(ntrees=1000,\n                                 max_depth=50,\n                                 nfolds=num_folds,\n                                 seed=1234)\n\n\n# Train model\nmodel.train(x=training_columns,\n            y='result',\n            training_frame=h2o_train_data)","d2570415":"# predictions on test sample\ntest_preds = model.predict(test_data=h2o_test_data).as_data_frame()['predict'].values","a16ad1e0":"# Saving predictions\ntest = pd.read_csv('..\/input\/ncaaw-2021-features-only\/test.csv')\nWSampleSubmission = pd.read_csv('..\/input\/ncaaw-march-mania-2021\/WSampleSubmissionStage1.csv')\n\nidx = test_preds.shape[0] \/\/2\ntest_preds[idx:] = 1 - test_preds[idx:] # (return game!)\n\npred = pd.concat([test.ID, pd.Series(test_preds)], axis=1).groupby('ID')[0]\\\n        .mean().reset_index().rename(columns={0:'Pred'})\nsub = WSampleSubmission.drop(['Pred'],axis=1).merge(pred, on='ID')\nsub.to_csv('submission.csv', index=False)","1ca0df60":"#### This notebook provide an example of training a Random Forest model in H2O.","64103f9b":"**Any comment?**\n\n"}}