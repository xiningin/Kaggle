{"cell_type":{"406ff736":"code","027cbc5f":"code","d6d04760":"code","6c97ee29":"code","90a1f860":"code","492f499c":"code","bbc5c916":"code","f8f7621d":"code","ac1d7678":"code","fb72f969":"code","9db25a17":"code","2eb04f93":"code","a0c23d85":"code","d59b2d20":"code","d7137a87":"code","386cb162":"code","2c08c8b6":"code","76e45953":"code","af527180":"code","b604478d":"code","acafc2e7":"code","9d219dc5":"code","2aec9f80":"code","5d714e55":"code","41a93587":"code","5e4b1903":"code","8b3d1b91":"code","b201ced8":"code","f9c22a08":"code","31dd248f":"code","3031694c":"code","324c4265":"code","d7ddc525":"code","2cf13124":"code","5f86b88e":"code","e97453b6":"code","24e2c505":"code","cd9a781b":"code","53f385ae":"code","cf66e589":"code","92d0638a":"code","fdab4d9f":"code","74b4e6d3":"code","40412f3e":"code","8e20f847":"code","27dbba4e":"code","967a7140":"code","ff199c4a":"code","bd5250cc":"code","29f4dabf":"markdown","6a50d063":"markdown","51898dd8":"markdown","cfd12e1a":"markdown","7f9a33ef":"markdown","ceb59a45":"markdown"},"source":{"406ff736":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import GridSearchCV","027cbc5f":"data=pd.read_csv(\"..\/input\/weatherAUS.csv\",parse_dates=[\"Date\"])","d6d04760":"data.head()","6c97ee29":"data.dtypes","90a1f860":"data.isnull().sum()","492f499c":"data=data.drop(columns=['Date','Location','Sunshine','Cloud9am','Cloud3pm','RISK_MM','Evaporation'])","bbc5c916":"data.head()","f8f7621d":"data.corr()","ac1d7678":"data=data.dropna(how='any')\nx=data.drop(columns=['RainTomorrow'])","fb72f969":"x=pd.get_dummies(x)","9db25a17":"y=data.RainTomorrow","2eb04f93":"print(y.shape,x.shape)","a0c23d85":"from sklearn import preprocessing\nmin_max_scaler = preprocessing.MinMaxScaler()\nX_scaled = pd.DataFrame(min_max_scaler.fit_transform(x), columns = x.columns)\nX_scaled.head()","d59b2d20":"from sklearn.feature_selection import chi2,SelectKBest","d7137a87":"xnew=SelectKBest(chi2,k=10) #choosing top 10 features.","386cb162":"xnew.fit(X_scaled,y)\nx.columns[xnew.get_support()]","2c08c8b6":"pd.Series(xnew.scores_,X_scaled.columns).sort_values(ascending=False)","76e45953":"X_final=x[['Rainfall', 'WindGustSpeed', 'Humidity9am', 'Humidity3pm',\n       'WindGustDir_E', 'WindDir9am_E', 'WindDir9am_N', 'WindDir9am_NNW',\n       'RainToday_No', 'RainToday_Yes']]","af527180":"X_final.head(5)","b604478d":"from sklearn.model_selection import train_test_split\nfrom sklearn.metrics import f1_score,accuracy_score","acafc2e7":"X_train,X_test,Y_train,Y_test=train_test_split(X_final,y,test_size=0.30,random_state=10)","9d219dc5":"from sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import accuracy_score,confusion_matrix","2aec9f80":"parameters={'max_depth':[1,2,3,4,5],'min_samples_split':[2,3,4,5],'min_samples_leaf':[1,2,3,4,5],'criterion':['gini','entropy']}\ndt=DecisionTreeClassifier()","5d714e55":"clf=GridSearchCV(dt,parameters,scoring='accuracy')","41a93587":"clf.fit(X_train,Y_train)","5e4b1903":"clf.best_score_","8b3d1b91":"clf.best_params_","b201ced8":"tree=DecisionTreeClassifier(criterion='entropy',\n max_depth= 5,min_samples_leaf=1,min_samples_split= 2)","f9c22a08":"tree.fit(X_train,Y_train)","31dd248f":"Y_pred=tree.predict(X_test)","3031694c":"accuracy_score(Y_train,tree.predict(X_train))","324c4265":"accuracy_score(Y_test,Y_pred)","d7ddc525":"dict={'Y_test':Y_test,\"Y_pred\":Y_pred}","2cf13124":"result=pd.DataFrame(dict)","5f86b88e":"result.replace(['Yes','No'],[1,0])","e97453b6":"#Creating Confusion MAtrix\n\nconmat=confusion_matrix(result.Y_test,result.Y_pred)\nconmat","24e2c505":"plt.figure(figsize=(9,6))\nplt.subplot(1,2,1)\nsns.countplot(result.Y_test)\nplt.title(\"Actual Value counts\")\nplt.subplot(1,2,2)\nplt.title(\"Predicted Value counts\")\nsns.countplot(result.Y_pred)\nplt.show()","cd9a781b":"from sklearn.neighbors import KNeighborsClassifier","53f385ae":"KNN=KNeighborsClassifier()","cf66e589":"para={'n_neighbors':range(1,15,1)}\n\nknn=GridSearchCV(KNN,para,scoring=\"accuracy\")","92d0638a":"knn.fit(X_train,Y_train)","fdab4d9f":"knn.best_estimator_","74b4e6d3":"knn.best_score_","40412f3e":"KNN=KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',\n           metric_params=None, n_jobs=None, n_neighbors=14, p=2,\n           weights='uniform')","8e20f847":"KNN.fit(X_train,Y_train)","27dbba4e":"ypredknn=KNN.predict(X_test)","967a7140":"print(\"accuracy score in Train:\", accuracy_score(KNN.predict(X_train),Y_train))","ff199c4a":"print(\"accuracy score in Test:\", accuracy_score(ypredknn,Y_test))","bd5250cc":"confusion_matrix(ypredknn,Y_test)","29f4dabf":"## Importing Libraries","6a50d063":"# will it rain Tomorrow?","51898dd8":"result.head()","cfd12e1a":"# KNN algorithm","7f9a33ef":"# DecisionTreeClassifier","ceb59a45":"## Feature selection using selectkBest"}}