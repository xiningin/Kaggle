{"cell_type":{"33e50a7b":"code","8980f55d":"code","42f803f6":"code","e7876d15":"code","edd0d7bc":"code","97666171":"code","34ccd2ef":"code","51e9ac30":"code","b48f44ef":"code","a02390ad":"code","21f7dcc0":"code","03be60c3":"code","941d32ce":"markdown","43a133fe":"markdown","653ca089":"markdown","6a840574":"markdown","94ddef5e":"markdown","201870dc":"markdown","20cc0303":"markdown"},"source":{"33e50a7b":"\nimport pandas as pd\nimport numpy as np\n\nimport plotly.express as px\n","8980f55d":"df=pd.read_csv('..\/input\/g-research-crypto-forecasting\/train.csv')\ndf.head()","42f803f6":"df['y']=df['Target']\ndf=df.drop(columns=['Target'])","e7876d15":"asset_details=pd.read_csv('..\/input\/g-research-crypto-forecasting\/asset_details.csv')\nasset_details.head()","edd0d7bc":"dic=dict(zip(asset_details['Asset_ID'],asset_details['Asset_Name']))","97666171":"import matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()\nsubplots=plt.subplots(14,1,figsize=(10,40))[1]\nfor asset in range(14):\n    crop=df[df['Asset_ID']==asset]\n    subplots[asset].plot(pd.to_datetime(crop['timestamp'],unit='s').dt.date,crop['High']-np.min(crop['High'])\/(np.max(crop['High'])-np.min(crop['High'])),label=dic[asset])\n    subplots[asset].legend()\n\nplt.show()\nplt.close()","34ccd2ef":"def reduce_mem_usage(df):\n    \"\"\" iterate through all the columns of a dataframe and modify the data type\n        to reduce memory usage.\n    \"\"\"\n    start_mem = df.memory_usage().sum() \/ 1024**2\n    print('Memory usage of dataframe is {:.2f} MB'.format(start_mem))\n\n    for col in df.columns:\n        col_type = df[col].dtype.name\n        \n        if col_type not in ['object', 'category', 'datetime64[ns, UTC]', 'datetime64[ns]']:\n            c_min = df[col].min()\n            c_max = df[col].max()\n            if str(col_type)[:3] == 'int':\n                if c_min > np.iinfo(np.int8).min and c_max < np.iinfo(np.int8).max:\n                    df[col] = df[col].astype(np.int16)\n                elif c_min > np.iinfo(np.int16).min and c_max < np.iinfo(np.int16).max:\n                    df[col] = df[col].astype(np.int16)\n                elif c_min > np.iinfo(np.int32).min and c_max < np.iinfo(np.int32).max:\n                    df[col] = df[col].astype(np.int32)\n                elif c_min > np.iinfo(np.int64).min and c_max < np.iinfo(np.int64).max:\n                    df[col] = df[col].astype(np.int64)  \n            else:\n                if c_min > np.finfo(np.float16).min and c_max < np.finfo(np.float16).max:\n                    df[col] = df[col].astype(np.float16)\n                elif c_min > np.finfo(np.float32).min and c_max < np.finfo(np.float32).max:\n                    df[col] = df[col].astype(np.float32)\n                else:\n                    df[col] = df[col].astype(np.float64)\n\n    end_mem = df.memory_usage().sum() \/ 1024**2\n    print('Memory usage after optimization is: {:.2f} MB'.format(end_mem))\n    print('Decreased by {:.1f}%'.format(100 * (start_mem - end_mem) \/ start_mem))\n\n    return df","51e9ac30":"def upper_shadow(df):\n    return df['High'] - np.maximum(df['Close'], df['Open'])\n\ndef lower_shadow(df):\n    return np.minimum(df['Close'], df['Open']) - df['Low']\n\ndef add_features(dataframe):\n    dataframe['dat']=pd.to_datetime(dataframe['timestamp'],unit='s')\n    dataframe['date']=dataframe['dat'].dt.date\n    dataframe[\"Day of Week\"] = dataframe['dat'].dt.dayofweek\n    dataframe['weekend']=np.where(dataframe['Day of Week']>4,1,0)\n    date_of_elon_musk_tweet='2018-6-04'\n    dataframe['after']=(dataframe['dat']>date_of_elon_musk_tweet).astype(int)\n    date_of_elon_musk_tweet='2021-03-29'\n    dataframe['afterdoge']=(dataframe['dat']>date_of_elon_musk_tweet).astype(int)\n  \n    dataframe['Month']=dataframe['dat'].dt.month\n    dataframe['upper_Shadow'] = upper_shadow(dataframe)\n    dataframe['lower_Shadow'] = lower_shadow(dataframe)\n    dataframe[\"high_div_low\"] = dataframe[\"High\"] \/ dataframe[\"Low\"]\n    #dataframe[\"open_sub_close\"] = dataframe[\"Open\"] - dataframe[\"Close\"]\n    dataframe['trade']=dataframe['Close']-dataframe['Open']\n    dataframe['gtrade']=dataframe['trade']\/dataframe['Count']\n    dataframe['shadow1']=dataframe['trade']\/dataframe['Volume']\n    #dataframe['shadow2']=dataframe['upper_Shadow']\/df['Low']\n    dataframe['shadow3']=dataframe['upper_Shadow']\/dataframe['Volume']\n    #dataframe['shadow4']=dataframe['lower_Shadow']\/dataframe['High']\n    dataframe['shadow5']=dataframe['lower_Shadow']\/dataframe['Volume']\n    \n \n    return dataframe.drop(columns=['dat','date'])\ndf=add_features(reduce_mem_usage(df))\ndf.head()\n","b48f44ef":"def draw_card(df1,df2=False):\n    for column in list(df1.keys()):\n      \n        \n        try:\n            column2=df2[column]\n            print(f'|{column} : {np.mean(np.nan_to_num(df1[column]))-np.mean(np.nan_to_num(column2))}|')\n        except:\n            try:\n                print(f'|{column} : {np.mean(np.nan_to_num(df1[column]))}|')\n            except:\n                pass\n                    \n        ","a02390ad":"for asset in range(14):\n    crop=df[df['Asset_ID']==asset]\n    print(dic[asset])\n    crop=crop.dropna(how='any')\n\n    \n    \n    draw_card(crop[crop['weekend']==1],crop[crop['weekend']==0])\n","21f7dcc0":"print('Bitcoin After Elon')\nasset=1\ncrop=df[df['Asset_ID']==asset]\nprint('|'+dic[asset]+'|')\n    \ndraw_card(crop[crop['after']==1],crop[crop['after']==0])\n\nprint('-------\\nDogecoin after Elon')\n\nasset=4\ncrop=df[df['Asset_ID']==asset]\nprint('|'+dic[asset]+'|')\n    \ndraw_card(crop[crop['afterdoge']==1],crop[crop['afterdoge']==0])\n","03be60c3":"for asset in range(1,13):\n    print(dic[asset])\n  \n\n    \n    \n    draw_card(df[df['Month']==asset])\n","941d32ce":"# Weekend\n\nIn weekend as it is a holiday Count feature or number of trades will decrease and price in return will decrease because crypto follows  only 1 rule 'low demand low price high demand high price'","43a133fe":"# Load Data","653ca089":"# Plot","6a840574":"# 2 elon musk tweets \n\n'You can now buy tesla with bitcoin' - We all know what happened to crypto price , come on it went to space\n\n'Doge to the moon' - Dodgecoin price increased by 30 %\n\n\nObserve the differences\n","94ddef5e":"# Features","201870dc":"# Training\n\nhttps:\/\/www.kaggle.com\/swaralipibose\/new-features-training-notebook-and-feature-eval","20cc0303":"# Months\n\nNot quite sure why this happens but mainly i think because natural disasters are prone at certain months which can effect crypto price"}}