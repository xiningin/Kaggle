{"cell_type":{"5506ad6a":"code","c07f3106":"code","3e500f74":"code","c53b09c1":"code","82e149cf":"code","51b99838":"code","fc9b07e9":"code","d1276e67":"code","f2b96728":"code","e4436b0d":"code","2c938be0":"code","bbfe21c0":"code","952402f4":"code","a424b2b3":"code","8664f524":"code","c39d9abf":"code","c731a490":"code","0dcb76ab":"code","548c5f98":"code","f717e8ce":"code","c5d569b2":"code","164ff43e":"markdown","5c1ecea2":"markdown","4c342c1a":"markdown","bfa862f3":"markdown","5c801e2a":"markdown","553a9111":"markdown","82c8ce2f":"markdown","12fa7882":"markdown","94d439eb":"markdown","81671627":"markdown","d28a0bb6":"markdown","fa026ed0":"markdown","bd3d6d88":"markdown","662d8bb8":"markdown","6419d846":"markdown","abf5c662":"markdown","30ac088d":"markdown","34d043ab":"markdown","e2756290":"markdown","dcb0c366":"markdown","f4d07a47":"markdown"},"source":{"5506ad6a":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nfrom matplotlib import pyplot as plt\n\npd.pandas.set_option('display.max_columns', None)\n\ndef load_persona():\n    df = pd.read_csv(\"..\/input\/persona-data\/persona.csv\")\n    return df\n\ndf = load_persona()\ndf.head()","c07f3106":"def check_df(dataframe, head=5, col_name = \"SEX\", plot = False):\n    print(\"##################### Shape #####################\")\n    print(dataframe.shape)\n    print(\"##################### Types #####################\")\n    print(dataframe.dtypes)\n    print(\"##################### Head #####################\")\n    print(dataframe.head(head))\n    print(\"##################### Tail #####################\")\n    print(dataframe.tail(head))\n    print(\"##################### NA #####################\")\n    print(dataframe.isnull().sum())\n    print(\"##################### Quantiles #####################\")\n    print(dataframe.quantile([0, 0.05, 0.50, 0.95, 0.99, 1]).T)\n    if plot:\n        sns.countplot(x=dataframe[col_name], data=dataframe)\n        plt.show()\n\ncheck_df(df, plot = True)\n","3e500f74":"df[\"SOURCE\"].unique()","c53b09c1":"df[\"PRICE\"].unique()","82e149cf":"df[\"PRICE\"].value_counts()","51b99838":"df[\"COUNTRY\"].value_counts()","fc9b07e9":"df.groupby('COUNTRY')['PRICE'].sum()","d1276e67":"df.groupby(\"SOURCE\")[\"PRICE\"].count()","f2b96728":"df.groupby(\"COUNTRY\")[\"PRICE\"].mean()","e4436b0d":"df.groupby(\"SOURCE\")[\"PRICE\"].mean()","2c938be0":"df.groupby([\"COUNTRY\",\"SOURCE\"])[\"PRICE\"].mean()","bbfe21c0":"df.groupby([\"COUNTRY\", \"SOURCE\", \"SEX\", \"AGE\"]).agg({\"PRICE\": \"mean\"})","952402f4":"agg_df = df.groupby([\"COUNTRY\", \"SOURCE\", \"SEX\", \"AGE\"]).agg({\"PRICE\": \"mean\"}).sort_values(\"PRICE\", ascending=False )\nagg_df","a424b2b3":"agg_df = agg_df.reset_index()\nagg_df.head()","8664f524":"agg_df[\"AGE_CAT\"] = pd.cut(df[\"AGE\"],bins = [0, 18, 24, 30, 40, 70], labels= [\"0_18\", \"19_23\", \"24_30\", \"31_40\", \"41_70\"])\nagg_df.head()","c39d9abf":"col_names = [\"COUNTRY\", \"SOURCE\", \"SEX\", \"AGE_CAT\"]\nagg_df[col_names]\nagg_df[\"customers_level_based\"] = [\"_\".join(row).upper() for row in agg_df[col_names].values]\nagg_df.head()\nagg_df[\"customers_level_based\"].value_counts()\n#singularize\nagg_df = agg_df.groupby(\"customers_level_based\").agg({\"PRICE\":\"mean\"})\nagg_df = agg_df.reset_index()\nagg_df.head()\nagg_df[\"customers_level_based\"].value_counts()","c731a490":"agg_df[\"SEGMENT\"] = pd.qcut(agg_df[\"PRICE\"], 4, labels=[\"D\",\"C\",\"B\",\"A\"])\nagg_df","0dcb76ab":"agg_df.groupby(\"SEGMENT\").agg({\"PRICE\" : [\"mean\", \"max\", \"sum\"]})","548c5f98":"agg_df[agg_df[\"SEGMENT\"] == \"C\"].describe().T","f717e8ce":"new_user = \"TUR_ANDROID_FEMALE_31_40\"\nagg_df[agg_df[\"customers_level_based\"] == new_user]","c5d569b2":"new_user2 = \"USA_IOS_MALE_24_30\"\nagg_df[agg_df[\"customers_level_based\"] == new_user2]","164ff43e":"* What are the PRICE averages in the COUNTRY-SOURCE breakdown?","5c1ecea2":"* Convert age variable to categorical variable and add it to agg_df.","4c342c1a":"For example, which segment does a 33 year old Turkish woman using android belong to?","bfa862f3":"* What are the sales numbers according to SOURCE types?","5c801e2a":"* How many sales were made from which PRICE?","553a9111":"* How many sales from which country?","82c8ce2f":"* How many unique SOURCE are there? What are their frequencies?","12fa7882":"* How many unique PRICE are there?","94d439eb":"****Rule based classification ****","81671627":"* How much was earned in total from sales by country?","d28a0bb6":"* Sort the output by PRICE.","fa026ed0":"* Identify new level-based customers.","bd3d6d88":"* What are the total gains broken down by COUNTRY, SOURCE, SEX, AGE?","662d8bb8":"* What are the PRICE averages by SOURCEs?","6419d846":"* Segment your new customers.\n* Divide new customers\n* (Example: USA_ANDROID_MALE_0_18) into 4 segments according to PRICE.\n* Add the segments to agg_df as variable with SEGMENT naming.\n* Describe the segments (Group by segments and get the price mean, max, sum).\n* Analyze C segment (only extract C segment from dataset and analyze).","abf5c662":"**** Business Problem: A game company wants to create new stage-based customer definitions (personas) based on some characteristics of its customers, and form segments according to these new customer definitions, and estimate how much new customers can earn on average according to these segments.****","30ac088d":"* Convert the names in the index to variable names.","34d043ab":"* Classify new customers according to their segments and estimate how much income it can generate.","e2756290":"* What are the PRICE averages by country?","dcb0c366":"**> Read the data and show general information about the dataset**","f4d07a47":"* Which segment does a 26 year old American man using IOS belong to?"}}