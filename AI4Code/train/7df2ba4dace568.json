{"cell_type":{"95ddc487":"code","0cb5dc18":"code","d8f2a143":"code","b4481be2":"code","42b8bf78":"code","6147ae08":"code","d875c4e8":"code","1309fd06":"code","cb1e6938":"code","2613606a":"code","4b242d04":"code","4a6a15ba":"code","a5f75fb3":"code","1df27e1c":"markdown","f6508790":"markdown","589a5504":"markdown","8692eaa5":"markdown"},"source":{"95ddc487":"from PIL import Image","0cb5dc18":"import keras\nfrom keras.layers import Conv2D,Flatten,Dense,MaxPooling2D\nfrom keras.preprocessing.image import ImageDataGenerator","d8f2a143":"#Code by Gajulamandyam Deva Kumar https:\/\/www.kaggle.com\/devaloo\/kerneledb31c4357\n\ntrain_datagen = ImageDataGenerator(rescale = 1\/255)\ntest_datagen = ImageDataGenerator(rescale = 1\/255)","b4481be2":"#Code by Jonas Paluci Barbosa  @jonaspalucibarbosa\n\nBATCH = 32\n\ntrainset = train_datagen.flow_from_directory(r\"..\/input\/is-that-santa-image-classification\/is that santa\/train\",target_size = (150,150),class_mode='binary',batch_size = BATCH)\ntestset = test_datagen.flow_from_directory(r\"..\/input\/is-that-santa-image-classification\/is that santa\/test\",target_size = (150,150),class_mode = 'binary',batch_size = BATCH)","42b8bf78":"#Code by Gajulamandyam Deva Kumar https:\/\/www.kaggle.com\/devaloo\/kerneledb31c4357\n\nmodel = keras.models.Sequential([Conv2D(16,(3,3),input_shape = (150,150,3),activation = 'relu'),\n                                 MaxPooling2D(2,2),\n                                 Conv2D(32,(3,3),activation = 'relu'),\n                                 MaxPooling2D(2,2),\n                                 Conv2D(64,(3,3),activation = 'relu'),\n                                 MaxPooling2D(2,2),\n                                 Flatten(),\n                                 Dense(512,activation = 'relu'),\n                                 Dense(1,activation = 'sigmoid')\n    \n])","6147ae08":"model.summary()","d875c4e8":"from tensorflow.keras.optimizers import RMSprop\n\nmodel.compile(optimizer = RMSprop(learning_rate = 0.001),loss = 'binary_crossentropy',metrics = ['accuracy'])","1309fd06":"#Code by Jonas Paluci Barbosa  @jonaspalucibarbosa\n\nmodel.fit(trainset,epochs = 10, batch_size = BATCH, validation_data=testset,\n          steps_per_epoch= len(trainset),\n          validation_steps= len(testset));","cb1e6938":"#Code by Jonas Paluci Barbosa  @jonaspalucibarbosa\n\nmodel.compile(optimizer = \"adam\",loss = 'binary_crossentropy',metrics = ['accuracy'])","2613606a":"#Code by Jonas Paluci Barbosa  @jonaspalucibarbosa\n\nmodel.fit(trainset,epochs = 5, batch_size = BATCH, validation_data=testset,\n          steps_per_epoch= len(trainset),\n          validation_steps= len(testset));","4b242d04":"trainset.class_indices","4a6a15ba":"from keras.preprocessing import image\ntestdata1 = image.load_img(\"..\/input\/is-that-santa-image-classification\/is that santa\/train\/santa\/11.Santa.jpg\",target_size = (150,150))\nimport numpy as np\nx1=image.img_to_array(testdata1)\nx1=np.expand_dims(x1, axis=0)\nimages = np.vstack([x1])\nans = model.predict(images)\nif ans[0][0] == 0:\n    print(\"it is Not a Santa\")\nelse:\n    print(\"it is a Santa\")","a5f75fb3":"from PIL import Image\n\nimage = Image.open(\"..\/input\/is-that-santa-image-classification\/is that santa\/train\/santa\/11.Santa.jpg\")\nimage","1df27e1c":"#Let's try to change the optimizer:","f6508790":"#Then reduce epochs to five","589a5504":"#Tell me, Ho Ho Ho or whatever: in which world is it a Santa?  That's a morse wearing a Santa stocking cap.\n\nML won't survive to stand up comediants.","8692eaa5":"#Acknowledgements:\n\nJonas Paluci Barbosa @jonaspalucibarbosa for fixing my code\n\nCode by Gajulamandyam Deva Kumar https:\/\/www.kaggle.com\/devaloo\/kerneledb31c4357"}}