{"cell_type":{"1d7d4074":"code","a06d952f":"code","e73029a1":"code","f2a0c62a":"code","658f58cf":"code","f10ca01d":"code","6392461f":"code","81d15f4a":"code","2c3b8715":"code","e87644e7":"code","33853b74":"code","e339a79c":"code","d0fec5d5":"code","dbd8305e":"code","c410bd0f":"code","5740b223":"code","23b19cf2":"code","5819acff":"code","47d70aef":"code","0a9f3fcb":"code","1eb3989e":"code","6483ab3a":"code","30568784":"code","12e7ba24":"markdown","605f855a":"markdown","03558a98":"markdown"},"source":{"1d7d4074":"import tensorflow as tf\nlayers = tf.keras.layers\nInput = tf.keras.Input","a06d952f":"text_vocabulary_size = 10000\nquestion_vocabulary_size = 10000\nanswer_vocabulary_size = 500","e73029a1":"text_input = Input(shape=(None,), dtype='int32', name='text')\ntext_input","f2a0c62a":"embedded_text = layers.Embedding(64, text_vocabulary_size)(text_input)\nembedded_text","658f58cf":"encoded_text = layers.LSTM(32)(embedded_text)\nencoded_text","f10ca01d":"question_input = Input(shape=(None,), dtype='int32', name='question')\nquestion_input","6392461f":"embedded_question = layers.Embedding(32, question_vocabulary_size)(question_input)\nencoded_question = layers.LSTM(16)(embedded_question)","81d15f4a":"concatenated = layers.concatenate([encoded_text, encoded_question],\n                                 axis=-1)","2c3b8715":"answer = layers.Dense(answer_vocabulary_size,\n                      activation='softmax')(concatenated)","e87644e7":"model = tf.keras.Model([text_input, question_input], answer)\nmodel.compile(optimizer='rmsprop',\n             loss='categorical_crossentropy',\n             metrics=['acc'])\nmodel.summary()","33853b74":"'''\n# pydotplus is not available in gpu kernels\nfrom keras.utils import plot_model \nplot_model(model, to_file='..\/input\/multi-input-model.png')\n'''\nfrom IPython.display import Image\nImage(filename='..\/input\/multi-input-model.png') ","e339a79c":"import numpy as np","d0fec5d5":"num_samples = 1000\nmax_length = 100","dbd8305e":"text = np.random.randint(1,\n                        text_vocabulary_size,\n                        size=(num_samples, max_length))","c410bd0f":"question = np.random.randint(1,\n                            question_vocabulary_size,\n                            size=(num_samples, max_length))\nanswers = np.random.randint(0,\n                           1,\n                           size=(num_samples, answer_vocabulary_size))","5740b223":"# fitting using a list of inputs\n# model.fit([text, question], answers, epochs=10, batch_size=128)","23b19cf2":"# fitting using a dictionary of inputs (only if inputs are named)\nmodel.fit({'text': text, 'question': question},\n          answers, epochs=10, batch_size=128)","5819acff":"model","47d70aef":"text = \"A federal judge in Texas is weighing a request by 20 states to suspend the Affordable Care Act (ACA), a move that could lead to chaos in the health insurance market, some industry experts worry.\"\nquestion = \"Who answered the request?\"","0a9f3fcb":"predict_input = np.array([1,2,3])\npredict_input.shape","1eb3989e":"model.input_shape","6483ab3a":"prediction = model.predict([predict_input, predict_input])\nprediction","30568784":"sum(prediction[0])","12e7ba24":"## Inference","605f855a":"Using the tensorflow keras highlevel api, build a model that can process a question and piece of text jointly and return a 1-word answer.\nWork in progress, if you know how to finish it please share.","03558a98":"## Train"}}