{"cell_type":{"32752ad6":"code","382c3bfa":"code","2e6c00e2":"code","61166cb4":"code","f5656f22":"code","65134dc5":"code","2b6bae30":"code","04119919":"markdown","fc577635":"markdown","5d79e6cc":"markdown","44fd0fca":"markdown","7c2fd392":"markdown","0f1a8928":"markdown","bbadc9a0":"markdown","055daa2a":"markdown"},"source":{"32752ad6":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","382c3bfa":"x = pd.Series((np.arange(350)-175)\/50*np.pi)\nfx = abs(((x+np.pi) % (2*np.pi))-np.pi)**3\ndf = pd.DataFrame({'x': x, 'fx': fx})\ndf['k0'] = np.pi**3 \/ 4\ndf['c0'] = df['k0']\n\n# Calculates l2 error for x, y, and an estimate e.\ndef l2_error(x, y, e):\n    return sum(x.diff()[1:].reset_index(drop=True)\n               .multiply(y[:-1].reset_index(drop=True)-e[:-1].reset_index(drop=True))**2)\n\nprint(\"L2 Error: \" + str(l2_error(df['x'], df['fx'], df['c0'])))\ndf[['x', 'fx', 'k0']].plot.line(x='x')","2e6c00e2":"# Calculation of the Fourier coefficients for x^3\ndef get_x3_Fourier_Coefficient(k):\n    return (-1)**k * 6.0 * np.pi \/ k**2 - 12.0 \/ (np.pi * k**4) * ((-1)**k - 1)","61166cb4":"df['k1'] = get_x3_Fourier_Coefficient(1) * np.cos(x)\ndf['c1'] = df['k0'] + df['k1']\nprint(\"L2 Error: \" + str(l2_error(df['x'], df['fx'], df['c1'])))\nfig1, ax = plt.subplots(1, 2, figsize=(14,8), sharex=True)\ndf[['x', 'fx', 'k0', 'k1']].plot.line(x='x', ax=ax[0])\ndf[['x', 'fx', 'k0', 'c1']].plot.line(x='x', ax=ax[1])","f5656f22":"df['k2'] = get_x3_Fourier_Coefficient(2) * np.cos(2 * df['x'])\ndf['c2'] = df['c1'] + df['k2']\nprint(\"L2 Error: \" + str(l2_error(df['x'], df['fx'], df['c2'])))\nfig1, ax = plt.subplots(1, 2, figsize=(14,8), sharex=True)\ndf[['x', 'fx', 'k0', 'k1', 'k2']].plot.line(x='x', ax=ax[0])\ndf[['x', 'fx', 'k0', 'c1', 'c2']].plot.line(x='x', ax=ax[1])","65134dc5":"df['k3'] = get_x3_Fourier_Coefficient(3) * np.cos(3 * df['x'])\ndf['c3'] = df['c2'] + df['k3']\nprint(\"L2 Error: \" + str(l2_error(df['x'], df['fx'], df['c3'])))\nfig1, ax = plt.subplots(1, 2, figsize=(14,8), sharex=True)\ndf[['x', 'fx', 'k0', 'k1', 'k2', 'k3']].plot.line(x='x', ax=ax[0])\ndf[['x', 'fx', 'k0', 'c1', 'c2', 'c3']].plot.line(x='x', ax=ax[1])","2b6bae30":"df['c'] = df['k0']\nfor i in np.arange(32):\n    df['c'] = df['c'] + get_x3_Fourier_Coefficient(i+1) * np.cos((i+1) * df['x'])\nprint(\"L2 Error: \" + str(l2_error(df['x'], df['fx'], df['c'])))\nfig2, ax2 = plt.subplots(1, 1, figsize=(14,8), sharex=True)\ndf[['x', 'fx', 'c']].plot.line(x='x', ax=ax2)","04119919":"<h2>Problem:<\/h2>\n\nExpand the function \\\\(f(x) = x^3\\\\) in a Fourier cosine series on the interval \\\\( 0 \\leq x \\leq \\pi \\\\).","fc577635":"One more step, showing the inclusion of \\\\(k=3\\\\).","5d79e6cc":"Next, we add in the approximation for \\\\(k=2\\\\).","44fd0fca":"<h3><i>Answer:<\/i><\/h3>\n\nWe'll start with the calculation of the 0-th coefficient \\\\( a_0 \\\\) which is calculated using the equation\n\n$$ a_0 = \\frac{1}{\\pi} \\int_0^\\pi x^3 dx = \\frac{1}{\\pi} \\left( \\frac{x^4}{4}\\bigg|_0^\\pi \\right) = \\frac{\\pi^3}{4}$$\n\nSo the best horizontal line approximation for the function is given by \\\\( y = \\frac{\\pi^3}{4} \\\\).","7c2fd392":"To calculate \\\\(a_k\\\\) for \\\\(k \\ge 1\\\\), we need to solve\n\n$$ a_k = \\frac{2}{\\pi} \\int_0^\\pi x^3 \\cos(kx) dx $$\n\nUsing integration by parts, we get\n\n$$ a_k = \\frac{2}{\\pi} \\left( \\frac{1}{k}x^3\\sin(kx)\\bigg|_0^\\pi \\right) - \\frac{6}{\\pi k} \\int_0^\\pi x^2 \\sin(kx) dx$$\n\nThe term on the left evaluates to zero because \\\\(\\sin(k\\pi) = 0 \\\\) for all values of k.  Applying integration by parts a second time to the term on the right gets us\n\n$$ a_k = -\\frac{6}{\\pi k} \\left( -\\frac{x^2}{k} \\cos(kx) \\bigg|_0^\\pi \\right) -\\frac{12}{\\pi k^2} \\int_0^\\pi x \\cos(kx) dx $$\n\nNote that \\\\( \\cos(k \\pi) \\\\) evaluates to 1 for even values of k and to -1 for odd values of k.  So for the term on the left, we have\n\n$$ -\\frac{6}{\\pi k} \\left( -\\frac{x^2}{k} \\cos(kx) \\bigg|_0^\\pi \\right) = (-1)^k \\frac{6 \\pi}{k^2} $$\n\nFor the term on the right, we apply integration by parts one last time to get\n\n$$-\\frac{12}{\\pi k^2} \\int_0^\\pi x \\cos(kx) dx = -\\frac{12x}{\\pi k^3}\\sin(kx)\\bigg|_0^\\pi +\\frac{12}{\\pi k^3} \\int_0^\\pi \\sin(kx)dx $$\n\nAs above, the term on the left is identically zero for all values of k.  The term on the right evaluates to \n\n$$ -\\frac{12}{\\pi k^4} \\cos(kx) \\bigg|_0^\\pi $$\n\nAs indicated earlier, \\\\( \\cos(k\\pi) \\\\) is 1 when k is even and is -1 when k is odd.  Thus we now have the full calculation for \\\\( a_k \\\\):\n\n$$ a_k = (-1)^k \\frac{6 \\pi}{k^2} -\\frac{12}{\\pi k^4}\\left( (-1)^k - 1 \\right) $$","0f1a8928":"Armed with this information, we can now demonstrate how to approximate our original function with successive refinements of the Fourier series.  We'll start with approximation with the constant \\\\(a_0\\\\) and the first series with \\\\(k=1\\\\).  The graph on the left shows the original function, the horizontal line, and the first Fourier series approximation individually.  The graph on the right combines \\\\(a_0\\\\) and function for \\\\(k=1\\\\).","bbadc9a0":"<h1>Fourier Series: An Exercise<\/h1>\n\nI'm refamiliarizing myself with the properties of Fourier series and Fourier transforms to better understand how these tools can be used in data analysis.  Toward that end, I've been working through a variety of exercises and proofs, and wanted to memorialize this work for future reference.  I thought it might also be beneficial to incorporate some graphs to illustrate in places.","055daa2a":"And now let's show the approximation when we include all of the approximations up to \\\\(k=32\\\\).  Aside from the neighborhoods around the peaks, the approximation is pretty close to indistinguishable from the original function."}}