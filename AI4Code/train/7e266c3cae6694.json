{"cell_type":{"94e9cbe6":"code","9c48d284":"code","65bd1443":"code","1f89aeae":"code","98bab3dc":"code","4010d496":"code","0b954905":"code","16b9f12e":"code","16396c09":"code","ead81730":"code","b6eb5cd8":"code","8b31e9e0":"code","9eae34fc":"code","70314bb5":"code","8a7f7bba":"code","a46fa823":"code","ef01608b":"code","bd776549":"code","bd60f9ac":"code","c7da1430":"code","962c09a2":"code","6d1790ae":"code","5e23d347":"code","121add6f":"code","b17995c4":"code","b2012531":"code","8ffcbe60":"code","aac0815b":"code","8e8573ef":"code","3945afd3":"code","38b36420":"code","aa6145af":"code","d50fdbe7":"markdown","485cb684":"markdown","0609e7b1":"markdown","ee1f8f55":"markdown","e1493e7b":"markdown","52540002":"markdown","bba7f9ed":"markdown","aaa01b05":"markdown","69fd15e1":"markdown","724f2b64":"markdown","27c4c038":"markdown","9880a770":"markdown","ca8d6743":"markdown","59d9b10f":"markdown","1bd8c363":"markdown","b52e15d9":"markdown","28616f76":"markdown"},"source":{"94e9cbe6":"# for numerical analyiss\nimport numpy as np\n\n# to store and process data in dataframe\nimport pandas as pd\n\n# to interface with operating system\nimport os\n\n# for offline ploting\nimport matplotlib.pyplot as plt\n\n# interactive visualization\nimport plotly.express as px\nimport seaborn as sns; sns.set()\n\nfrom plotly.offline import plot, iplot, init_notebook_mode\ninit_notebook_mode(connected=True)\n\nimport plotly.graph_objs as go\nimport plotly.figure_factory as ff\nfrom plotly.subplots import make_subplots\n\n# for trendlines\nimport statsmodels","9c48d284":"# Create an empty list for universal and germany specific data\nfiles = []\nfiles_G = []\n\n# Fill the list with the file names of the CSV files in the Kaggle folder\nfor dirname, _, filenames in os.walk('..\/input\/bootcamp1b'):\n    for filename in filenames:\n        files.append(os.path.join(dirname, filename))\n        \nfor dirname, _, filenames in os.walk('..\/input\/germany'):\n    for filename in filenames:\n        files_G.append(os.path.join(dirname, filename))\n\n# Sort the file names\nfiles = sorted(files)\nfiles_G = sorted(files_G)\n\n# Output the list of sorted file names\nfiles\nfiles_G","65bd1443":"# Read the CSV files through list comprehension\nseries = [pd.read_csv(f, na_values=['.']) for f in files]\n\n# Define series name, which becomes the dictionary key\nseries_name = ['btc','cpi_us','gold','snp_us','high_yield_bond_us','inv_grade_bond_us','moderna','employment','tesla_robinhood','trea_20y_bond','trea_10y_yield','tesla','fed_bs','wti']\n\n# series name = dictionary key, series = dictionary value\nseries_dict = dict(zip(series_name, series))\n\n#Making germany data into a dictionary\nseries_G = [pd.read_csv(f, na_values=['.']) for f in files_G]\nseries_name_G = ['10_yr_bond','cpi','DAX','inflation','recession_mon','recession','debt','ltbond','unemployment']\nseries_dict_G = dict(zip(series_name_G, series_G))","1f89aeae":"# 1.DAX (Daily and Monthly)\ndax = series_dict_G['DAX']\n\n#Convert date into the right format\ndax['Date'] = pd.to_datetime(dax['Date'])\n\n#Rename colume from SNP closing data to snp\ndax.rename(columns={'Adj Close':'dax'}, inplace=True)\n\n#Calculate % change in stock price\ndax['dax_return'] = dax['dax'].pct_change()\n\n# Annualize daily standard deviation * 20 trading days per month (Rolling means to look back X trading days from the recent to the past)\ndax['dax_volatility_1m'] = (dax['dax_return'].rolling(20).std())*(20)**(1\/2) \n\n# Annualize daily S.D * 252 trading days per year\ndax['dax_volatility_1y'] = (dax['dax_return'].rolling(252).std())*(252)**(1\/2) \n\n#Select he necessary columns\ndax = dax[['Date','dax','dax_return','dax_volatility_1m','dax_volatility_1y']]\n\n# Calculate 1-month forward cumulative returns\ndax['one_month_forward_dax_return'] = dax['dax_return'][::-1].rolling(window=20, min_periods=1).sum()[::-1]\n\ndax_month = dax.resample('MS',on = 'Date').mean()\ndax_month.tail()\n\nplt.plot(dax['Date'], dax['dax'], color = 'r')\nplt.title('DAX index again Time')\nplt.show()\n\n#There's a quick bounce back of stock price during the covid outbreak\n#Possibly due to this is not a typical recession but it's an pendamic-induced recession. Cash is not going to physical business so they are flooded into stock markets. ","98bab3dc":"# 2. Bitcoin (Daily and Monthly)\nbtc = series_dict['btc']\nbtc['Date'] = pd.to_datetime(btc['Date'])\nbtc.rename(columns={'Adj Close':'btc'}, inplace=True)\nbtc['btc_return'] = btc['btc'].pct_change()\nbtc['btc_volatility_1m'] = (btc['btc_return'].rolling(20).std())*(20)**(1\/2) \nbtc['btc_volatility_1y'] = (btc['btc_return'].rolling(252).std())*(252)**(1\/2) \nbtc = btc[['Date','btc','btc_return','btc_volatility_1m','btc_volatility_1y']]\nbtc['one_month_forward_btc_return'] = btc['btc_return'][::-1].rolling(window=20, min_periods=1).sum()[::-1]\n\n#Compile to monthly\nbtc_month = btc.resample('MS',on = 'Date').mean()\nbtc_month.tail()","4010d496":"# 3. Gold (Daily and Monthly)\ngold = series_dict['gold']\ngold['Date'] = pd.to_datetime(gold['DATE'])\ngold.rename(columns={'GOLDPMGBD228NLBM':'gold'}, inplace=True)\ngold['gold_lag1'] = gold['gold'].shift(1)\ngold['gold_lag2'] = gold['gold'].shift(2)\ngold['gold'] = gold['gold'].fillna(gold['gold_lag1'])\ngold['gold'] = gold['gold'].fillna(gold['gold_lag2'])\ngold[\"gold\"] = gold[\"gold\"].astype('float64')\ngold['gold_return'] = gold['gold'].pct_change()\ngold['gold_volatility_1m'] = (gold['gold_return'].rolling(20).std())*(20)**(1\/2) \ngold['gold_volatility_1y'] = (gold['gold_return'].rolling(252).std())*(252)**(1\/2) \ngold = gold[['Date','gold','gold_return','gold_volatility_1m','gold_volatility_1y']]\ngold['one_month_forward_gold_return'] = gold['gold_return'][::-1].rolling(window=20, min_periods=1).sum()[::-1]\n\ngold_month = gold.resample('MS',on = 'Date').mean()\ngold_month.tail()\n\nplt.plot(gold['Date'], gold['gold'],color = 'y')\nplt.show()","0b954905":"# 4. Germany 10 year bond (MONTHLY)\nten_year_bond = series_dict_G['10_yr_bond']\nten_year_bond['Date'] = pd.to_datetime(ten_year_bond['DATE'])\nten_year_bond.rename(columns={'IRLTLT01DEM156N':'10_yr_bond'}, inplace=True)\nten_year_bond['10_yr_bond_return_1m'] = ten_year_bond['10_yr_bond'].pct_change()\nten_year_bond['10_yr_bond_volatility_1m'] = ten_year_bond['10_yr_bond_return_1m']\n#ten_year_bond['10_yr_bond_volatility_1m'] = (ten_year_bond['10_yr_bond_return'].rolling(20).std())*(20)**(1\/2)\nten_year_bond['10_yr_bond_volatility_1y'] = (ten_year_bond['10_yr_bond_return_1m'].rolling(12).std())*(12)**(1\/2)\nten_year_bond = ten_year_bond[['Date','10_yr_bond','10_yr_bond_return_1m','10_yr_bond_volatility_1m',\n                                   '10_yr_bond_volatility_1y']]\nten_year_bond['one_month_forward_10_yr_bond_return'] = ten_year_bond['10_yr_bond_return_1m'][::-1].rolling(window=1, min_periods=1).sum()[::-1]\nten_year_bond.tail()\n","16b9f12e":"#5. Germany long term bond (combined terms) (MONTHLY)\nltbond = series_dict_G['ltbond']\n\nltbond['Date'] = pd.to_datetime(ltbond['DATE'])\nltbond.rename(columns={'IRLTCT01DEM156N':'ltbond'}, inplace=True)\nltbond['ltbond_return_1m'] = ltbond['ltbond'].pct_change()\nltbond['ltbond_volatility_1m'] = ltbond['ltbond_return_1m'] \n#ltbond['ltbond_volatility_1m'] = (ltbond['ltbond_return'].rolling(20).std())*(20)**(1\/2)\nltbond['ltbond_volatility_1y'] = (ltbond['ltbond_return_1m'].rolling(12).std())*(12)**(1\/2)\nltbond['one_month_forward_inv_grade_bond_return'] = ltbond['ltbond_return_1m'][::-1].rolling(window=1, min_periods=1).sum()[::-1]\n\nltbond = ltbond[['Date','ltbond','ltbond_return_1m','ltbond_volatility_1m','ltbond_volatility_1y']]\nltbond","16396c09":"# 6. Crude Oil WTI (Daily and Monthly)\nwti = series_dict['wti']\nwti['Date'] = pd.to_datetime(wti['DATE'])\nwti.rename(columns={'WTISPLC':'wti'}, inplace=True)\nwti['wti_return'] = wti['wti'].pct_change()\nwti['wti_volatility_1m'] = wti['wti_return'].rolling(20).std()*(20)**(1\/2)\nwti['wti_volatility_1y'] = wti['wti_return'].rolling(252).std()*(252)**(1\/2)\nwti = wti[['Date','wti','wti_return','wti_volatility_1m','wti_volatility_1y']]\nwti['one_month_forward_wti_return'] = wti['wti_return'][::-1].rolling(window=20, min_periods=1).sum()[::-1]\n\nwti_month = wti.resample('MS',on = 'Date').mean()\nwti_month.tail()","ead81730":"#7. Inflation in Germany indicated by CPI (MONTHLY)\ncpi = series_dict_G['cpi']\ncpi['Date'] = pd.to_datetime(cpi['DATE'])\ncpi.rename(columns={'DEUCPHPLA01GYM':'cpi'}, inplace=True)\ncpi = cpi[['Date','cpi']]\ncpi","b6eb5cd8":"#8. Employment  (MONTHLY)\n#** This is unemployment rate!\nunemployment = series_dict_G['unemployment']\nunemployment['Date'] = pd.to_datetime(unemployment['DATE'])\nunemployment.rename(columns={'LMUNRRTTDEM156S':'unemployment_rate'}, inplace=True)\nunemployment = unemployment[['Date','unemployment_rate']]\n\nplt.plot(unemployment['Date'], unemployment['unemployment_rate'])\nplt.show()","8b31e9e0":"#9. Germany's Debt Position \n#* The data is not sufficient to the current date\n#This is an indicator of economic conditions, not an asset class\n\nger_debt = series_dict_G['debt']\nger_debt['Date'] = pd.to_datetime(ger_debt['DATE'])\nger_debt.rename(columns={'GGGDTADEA188N':'debt_percent'}, inplace=True)\nger_debt = ger_debt[['Date','debt_percent']]\n\nplt.plot(ger_debt['Date'], ger_debt['debt_percent'])\nplt.show()\n","9eae34fc":"# Import datasets with Pandas method read_csv (Daily and Monthly, but only monthly is used)\n\n#recession_indicator_month = series_dict_G['recession_mon'] #Monthly data is unnecessary\n#recession_indicator_day = series_dict_G['recession']\n\n#import monthly recession indicator (1,0)\nrecession_indicator_month = series_dict_G['recession_mon']\n\n#Convert data types and rename columns\nrecession_indicator_month[\"Date\"] = pd.to_datetime(recession_indicator_month[\"DATE\"], format = '%d\/%m\/%Y')\nrecession_indicator_month[\"Recession\"] = recession_indicator_month[\"DEUREC\"].astype('bool')\n#recession_indicator_day[\"Date\"] = pd.to_datetime(recession_indicator_day[\"DATE\"])\n#recession_indicator_day[\"Recession\"] = recession_indicator_day[\"DEURECD\"].astype('bool')\n\n# Subset data columns\nrecession_indicator_month = recession_indicator_month[[\"Date\",\"Recession\"]]\n#recession_indicator_day = recession_indicator_day[[\"Date\",\"Recession\"]]","70314bb5":"# Merge datasets together (All monthly datasets)\nasset_classes = [btc_month,cpi,gold_month,ten_year_bond,ltbond,unemployment,wti_month]\n\nbaseline = pd.merge(dax_month,recession_indicator_month,how='left',left_on='Date', right_on = 'Date')\n\nfor asset_class in asset_classes:\n    baseline = pd.merge(baseline,asset_class,how='left',left_on='Date', right_on = 'Date')\n\n#Backfilling missing values, for covid outbreak, assume recession YES\nbaseline.loc[baseline.Date >= '2020-03-01', \"Recession\"] = 1\nbaseline[\"Recession\"] = baseline[\"Recession\"].fillna(0).astype(bool)\n\nbaseline.info()\nbaseline.tail(10)\n","8a7f7bba":"# Index Date\nbaseline.set_index('Date', inplace=True)\nbaseline.tail(20)","a46fa823":"# Re-sample the dataset every year and calculate the sum of returns\nbaseline_yearly_return = baseline[[\"dax_return\", \"btc_return\", \"gold_return\", \"ltbond_return_1m\", \"10_yr_bond_return_1m\", \"wti_return\"]].dropna().resample('Y').sum().reset_index()\n\nprint(baseline_yearly_return['Date'].min())\nbaseline_yearly_return.tail()","ef01608b":"# Re-sample the dataset every year and calculate the mean of 1-year volatility\nbaseline_yearly_volatility_1y = baseline[[\"dax_volatility_1y\", \"btc_volatility_1y\", \"gold_volatility_1y\", \n                                          \"ltbond_volatility_1y\", '10_yr_bond_volatility_1y',\n                                          \"wti_volatility_1y\"]].dropna().resample('Y').mean().reset_index()\n\nbaseline_yearly = baseline_yearly_return.merge(baseline_yearly_volatility_1y, on='Date')\n\nbaseline_yearly.head()","bd776549":"# Reshape dataset wide to tall with method melt\nbaseline_yearly_reshaped = baseline_yearly.melt(id_vars='Date', var_name='key', value_name='value')\nbaseline_yearly_reshaped.head(50)","bd60f9ac":"baseline_yearly_reshaped['metric'] = np.where(baseline_yearly_reshaped['key'].str.contains(pat = 'return'), 'return', 'volatility')\nbaseline_yearly_reshaped['position']= baseline_yearly_reshaped['key'].str.find('_') \nbaseline_yearly_reshaped['asset_class']= baseline_yearly_reshaped['key'].str.slice(0,3,1)\nbaseline_yearly_reshaped = baseline_yearly_reshaped[['Date','metric','asset_class','value']]\nbaseline_yearly_reshaped.head()","c7da1430":"# Display return and volatility for each asset class\nprint(baseline_yearly_reshaped[baseline_yearly_reshaped['metric'] == 'return'].groupby('asset_class').mean())\nprint(baseline_yearly_reshaped[baseline_yearly_reshaped['metric'] == 'volatility'].groupby('asset_class').mean())","962c09a2":"# Reset index\nbaseline.reset_index(inplace=True)\nbaseline.tail(10)","6d1790ae":"# Output summary statistics\nbaseline[[\"dax_return\", \"dax_volatility_1y\", \"btc_return\", \"btc_volatility_1y\", \"gold_return\", \"gold_volatility_1y\", \n                  \"10_yr_bond_return_1m\",'10_yr_bond_volatility_1y', \"ltbond_return_1m\",'ltbond_volatility_1y',\n                 \"wti_return\", \"wti_volatility_1y\"]].describe()","5e23d347":"# Plot a jointplot with a regression line\nsns.jointplot(x = 'gold_return', y = 'dax_return', data = baseline, kind='reg', color = 'r')","121add6f":"def plot_chart(series):\n    fig = px.scatter(baseline[baseline[series].notnull()], x=\"Date\", y=series, color=\"Recession\", color_discrete_sequence=['#636EFA', '#FFA15A'], width=1200)\n    fig.update_traces(mode='markers', marker_size=4)\n    fig.update_layout(title=series, xaxis_title=\"\", yaxis_title=\"\")\n    fig.show()","b17995c4":"plot_chart(\"dax\")\ndax.tail(20)\n\n#German Stocks in general is not a good hedge against recession","b2012531":"plot_chart(\"gold\")","8ffcbe60":"plot_chart('btc')","aac0815b":"# Plot pairplot\nbaseline_returns = baseline[[\"dax_return\", \"btc_return\", \"gold_return\", \"ltbond_return_1m\", \"10_yr_bond_return_1m\", \"wti_return\", \"Recession\"]]\n\nsns.pairplot(baseline_returns, hue=\"Recession\")","8e8573ef":"def plot_chart_vol_ret(series):\n    fig = px.scatter(baseline[baseline[series+'_return'].notnull()], x=series + '_volatility_1m', \n                     y='one_month_forward_' + series + '_return', width=800,\n                     trendline = 'ols')\n    fig.update_layout(title=str(series) + ' volatility vs one-month forward return', xaxis_title='', yaxis_title='')\n    fig.show()\n    \ndef plot_chart_vol_ret_by_recession(series):\n    fig = px.scatter(baseline[baseline[series+'_return'].notnull()], x=series + '_volatility_1m', \\\n                     color='Recession', y='one_month_forward_' + series + '_return', \n                     color_discrete_sequence=['#636EFA', '#FFA15A'], width=800,\n                     trendline = 'ols')\n    fig.update_layout(title=str(series) + ' volatility vs one-month forward return', xaxis_title='', yaxis_title='')\n    fig.show()","3945afd3":"plot_chart_vol_ret('dax')","38b36420":"plot_chart_vol_ret_by_recession('dax')","aa6145af":"# Plot heatmap of the relationships across different asset classes\nbaseline_corr = baseline[['dax_return', 'dax_volatility_1y', 'btc_return', 'btc_volatility_1y',\n                         'gold_return', 'gold_volatility_1y', '10_yr_bond_return_1m', '10_yr_bond_volatility_1y',\n                         'ltbond_return_1m', 'ltbond_volatility_1y', 'wti_return', 'wti_volatility_1y',\n                         'Recession']].dropna().corr()\n\nfig, ax = plt.subplots(figsize=(20,10)) \nsns.heatmap(baseline_corr, annot=True, ax = ax)","d50fdbe7":"<a id=\"section-three\"><\/a>\n# 3. WHAT DO DECADES OF ASSET RETURNS TELL US ABOUT INVESTING?","485cb684":"# Germany's Covid-Financial Situation and Assets to hedge against recession\n## Table of contents\n\n* [1. INTRODUCTION](#section-one)\n* [2. SETUP](#section-two)\n    - [2.1 Draw Packages](#subsection-two-one)\n    - [2.2 Import Data](#subsection-two-two)\n    - [2.3 Wrangle Data](#subsection-two-three)\n* [3. WHAT DO DECADES OF ASSET RETURNS TELL US ABOUT INVESTING?](#section-three)\n    - [3.1 Question 1: What is the risk\/return profile for different asset class?](#subsection-three-one)\n    - [3.2 Question 2: Which asset class is a good hedge against recession?](#subsection-three-two)\n    - [3.3 Question 3: Does volatility foretell future return?](#subsection-three-three)\n* [4. CONCLUSION](#section-four)\n* [5. REFERENCES](#section-five)","0609e7b1":"<a id=\"subsection-two-three\"><\/a>\n## 2.3 Wrangle Data","ee1f8f55":"DAX and gold returns are -ve correlated. Makes sense as when the economy is down, gold becomes a good hedging asset","e1493e7b":"There's a +ve relationship but the relationship is at best weak.","52540002":"Digital coins are extremely volatile and it should not be correlated to the general economic conditions, at least so far.","bba7f9ed":"When we normalise the bond data, the 10 year bond and long term bond have similiar monthly volatility rate","aaa01b05":"<a id=\"subsection-two-two\"><\/a>\n## 2.2 Import Data\nThe two sets of data are availavle on the public space of shaofei.sun in Kaggle with the folder name of 'germany' and 'bootcamp1b'\n\nThe data are all normalised into monthly data for the purpose of plotting due to the lack of Germany specific data.","69fd15e1":"## The data includes Germany's \n- 10-year bond\n- DAX\n- Inflation Rate\n- Recession indicator\n- Debt\n- Unemployment\n\n## Also with the world's \n- Gold Price\n- Bitcoin Price","724f2b64":"<a id=\"subsection-three-one\"><\/a>\n## 3.1 Question 1: What is the risk\/return profile for different asset class?","27c4c038":"The relationship between dax volatility and one-month forward return is stronger when there is recession. However, both do not have a strong correlation indicated by a very small r^2 value","9880a770":"<a id=\"subsection-two-one\"><\/a>\n# 2. Data Processing\n## 2.1 Import Packages to the notebook","ca8d6743":"<a id=\"subsection-three-three\"><\/a>\n## 3.3 Question 3: Does volatility foretell future return?    ","59d9b10f":"<a id=\"subsection-three-two\"><\/a>\n## 3.2 Question 2: Which asset class is a good hedge against recession?","1bd8c363":"<a id=\"section-one\"><\/a>\n# 1. INTRODUCTION to COVID causing economic downturns in Germany and Investing under recession\n\n\nThe Covid19 pandemic has driven the economies around the world into deep recessions. The various forms of mandated lockdowns have caused both supply-side and demand-side shocks to the world economies. The scale of the economic downturn is unprecedented. In this notebook, we will first explore the risk\/return profile of different asset classes (e.g., DAX, Long term Bonds, Gold, Oil, Bitcoin, etc.). Then, we explore which asset class is a good hedge against recession. Finally, the Covid19 pandemic has heightened the volatilities of asset returns. ","b52e15d9":"Gold seems to be a GOOD hedge against recession.","28616f76":"<a id=\"section-four\"><\/a>\n# 4. CONCLUSION"}}