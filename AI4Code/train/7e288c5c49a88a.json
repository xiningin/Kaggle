{"cell_type":{"a45ea61e":"code","da7cbf46":"code","fe042ecf":"code","ee139b2c":"code","5bf04d92":"code","84fba90a":"code","81dd475a":"code","7a8362ee":"code","017c1b58":"code","9a57f9a5":"code","273e3c5a":"code","0e797cac":"code","5e47bd09":"code","732c61b9":"code","f2c437fa":"code","7db350ac":"code","9a90f632":"code","dc163317":"code","6c7b0725":"code","02e89677":"code","fd0377e4":"code","086f6362":"code","c79a2485":"code","af1b03de":"code","03c4be8d":"code","0d8a1b75":"code","b8f62e58":"code","c052abc4":"code","ee45f07b":"code","2c6041a4":"code","bbaf64b7":"code","6c921bc2":"markdown","0504ff24":"markdown","cd9f7304":"markdown","d1fa2c41":"markdown","5d90ef3a":"markdown","6daa985b":"markdown","dc00d394":"markdown","fb3f1eea":"markdown","8e2befd4":"markdown","b310258a":"markdown","f6b0d14e":"markdown","4fbe2105":"markdown","540c49e4":"markdown","4fdfe7eb":"markdown","f4361ab1":"markdown","7e060588":"markdown","ca51d110":"markdown","6364c8fe":"markdown","9cf87aa2":"markdown","904f8ba3":"markdown","6daa70a0":"markdown"},"source":{"a45ea61e":"pip install pyspark","da7cbf46":"pip install findspark","fe042ecf":"from pyspark.sql import SparkSession # required to created a dataframe\nspark=SparkSession.builder.appName(\"Basics\").getOrCreate() \n\nimport pyspark.sql.functions","ee139b2c":"df= spark.read.csv(\"..\/input\/employee-salary-dataset\/Employee_Salary_Dataset.csv\",header=True,inferSchema=True)\ndf.show(5)","5bf04d92":"df.printSchema()","84fba90a":"df.groupby(\"Gender\").mean(\"Salary\").show()","81dd475a":"print(\"Distinct Count: \" + str(df.distinct().count()))","7a8362ee":"df.show(5)","017c1b58":"df.sort(\"Experience_Years\").show(5)","9a57f9a5":"df.sort(\"Experience_Years\",\"Age\").show(5)","273e3c5a":"df_pivot=df.groupby(\"Age\").pivot(\"Gender\").sum(\"Experience_Years\")\ndf_pivot.show(10)","0e797cac":"#1\ndf_pivot.na.fill(value=0).show(10)","5e47bd09":"#2\ndf_pivot.na.fill(value=0,subset=[\"Male\"]).show()","732c61b9":"from pyspark.sql.functions import substring","f2c437fa":"df.select(\"Gender\",substring(\"Gender\",1,3).alias(\"Substring\")).show(5)","7db350ac":"df_view=df.createOrReplaceTempView(\"employee\")","9a90f632":"df_new=spark.sql(\"SELECT * FROM employee where Gender='Male' and age > 50\")\ndf_new.show()","dc163317":"df_new=spark.sql(\"select avg(salary) from employee where age between 20 and 40\")\ndf_new.show()","6c7b0725":"df_new=spark.sql(\"select distinct Gender from employee\")\ndf_new.show()","02e89677":"df_new=spark.sql(\"select * from employee where salary in (select max(salary) from employee ) \")\ndf_new.show()","fd0377e4":"df_new=spark.sql(\"Select * from employee where Experience_Years in (select max(Experience_Years) from employee where )\")\ndf_new.show()","086f6362":"df_new=spark.sql(\"Select * from employee where Experience_Years in (select min(Experience_Years) from employee where )\")\ndf_new.show()","c79a2485":"df1=spark.read.csv(\"..\/input\/employees-department-dataset\/Department_Dataset.csv\",header=True,inferSchema=True)\ndf1.show()","af1b03de":"df1_view=df1.createOrReplaceTempView(\"department\")","03c4be8d":"df1_new=spark.sql(\"select * from employee e join department d on e.ID=d.ID where Dept_name='Tech'\")\ndf1_new.show()","0d8a1b75":"df1_new=spark.sql(\"select count(e.ID) from employee e join department d on e.ID=d.ID where location='Bangalore' \" )\ndf1_new.show()\n#since each employees is there only once we can do select * as well","b8f62e58":"df1_new=spark.sql(\"select distinct * from employee e join department d on e.ID=d.ID where location='Pune' and Dept_name='Finance' \" )\ndf1_new.show()","c052abc4":"df1_new=spark.sql(\"select distinct GENDER,COUNT(*) from employee e join department d on e.ID=d.ID \\\n                  where location='Mumbai' and travel_required='yes'\\\n                  group by Gender\" )\ndf1_new.show()","ee45f07b":"df1_new=spark.sql(\"select distinct location,max(Salary) from employee e join department d on e.ID=d.ID \\\n                                    group by location\" )\ndf1_new.show()","2c6041a4":"df1_new=spark.sql(\"select distinct Dept_name,max(Salary) from employee e join department d on e.ID=d.ID \\\n                                    group by Dept_name\" )\ndf1_new.show()","bbaf64b7":"df1_new=spark.sql(\"select distinct Dept_name,min(age) from employee e join department d on e.ID=d.ID \\\n                                    group by Dept_name\" )\ndf1_new.show()","6c921bc2":"### Count of employees who are working from bangalore","0504ff24":"### Fetch records of male employee of over 50Years of age","cd9f7304":"### select distinct gender groups","d1fa2c41":"### Fine the employee with the least and most experience","5d90ef3a":"### group the employees by Gender and find the COUNT who are from Mumbai and are required to travel","6daa985b":"### Select the employees who work in finance department and from Pune","dc00d394":"### sort by experience years and age","fb3f1eea":"### find the employee with highest salary","8e2befd4":"### Find employees from Tech department","b310258a":"### fetch the average salary of employees in the age group of 20 to 40","f6b0d14e":"### fill 0 in the df_pivot data frame","4fbe2105":"### group the employees by location and find their max salaries in each location ","540c49e4":"### JOINS","4fdfe7eb":"### group the employees by Department name and find their max salaries in each location ","f4361ab1":"### find the age of the youngest employee in each department","7e060588":"### What is the mean salary for male and female?","ca51d110":"### Use Pivot","6364c8fe":"### Sort by experience years","9cf87aa2":"### ","904f8ba3":"### Find the substring","6daa70a0":"### Count the total number of records"}}