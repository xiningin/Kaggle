{"cell_type":{"f9221b27":"code","c539a92c":"code","08162cb9":"code","07948d43":"code","e97658bb":"code","82fa6f29":"code","e6a7da64":"code","18521339":"code","a9465866":"code","3e0bf528":"code","8c136194":"code","c8b1eaea":"code","1d4b7ba9":"code","8f836ce3":"code","b7b202ca":"code","893a667e":"code","f6c4976e":"code","e63f8975":"code","3c76b6b8":"code","71bc087b":"markdown","189fa275":"markdown","94b25d27":"markdown","6242d1a6":"markdown","3780af7c":"markdown","43250e0b":"markdown","a38adb02":"markdown","e24b884d":"markdown","3d765c8b":"markdown","501bb3e8":"markdown","ce850605":"markdown","2f93416e":"markdown","4c7f2cb0":"markdown","9985e0d8":"markdown","f0f5d2fd":"markdown","49d406d7":"markdown","6f7925c4":"markdown","6fba763c":"markdown","36940f43":"markdown"},"source":{"f9221b27":"!pip uninstall tensorflow==2.1.0 --yes\n!pip install bert-serving-server\n!pip install bert-serving-client\n!pip install --upgrade ipykernel\n!pip install tensorflow==1.13.1","c539a92c":"!wget https:\/\/github.com\/naver\/biobert-pretrained\/releases\/download\/v1.1-pubmed\/biobert_v1.1_pubmed.tar.gz","08162cb9":"!tar xvzf biobert_v1.1_pubmed.tar.gz\n%cd biobert_v1.1_pubmed\n!rename 's\/model.ckpt-1000000.data-00000-of-00001\/bert_model.ckpt.data-00000-of-00001\/' *\n!rename 's\/model.ckpt-1000000.meta\/bert_model.ckpt.meta\/' *\n!rename 's\/model.ckpt-1000000.index\/bert_model.ckpt.index\/' *\n!ls #\/kaggle\/working\/biobert_v1.1_pubmed\n#!port_num=5555","07948d43":"import tensorflow as tf\nprint(tf.__version__)","e97658bb":"import pandas as pd\nfrom bert_serving.client import BertClient\nimport numpy as np\nfrom bert_serving.server.helper import get_args_parser\nfrom bert_serving.server import BertServer","82fa6f29":"a = get_args_parser().parse_args(['-model_dir', '\/kaggle\/working\/biobert_v1.1_pubmed',\n                                     '-port', '5555',\n                                     '-port_out', '5556',\n                                     '-max_seq_len', 'NONE',\n                                     '-mask_cls_sep',\n                                     '-cpu',\n                                     '-num_worker','4'])\nserver = BertServer(a)\nserver.start()","e6a7da64":"bc = BertClient(port=5555, port_out=5556)","18521339":"biorx_df = pd.read_csv('..\/..\/input\/cord-19-eda-parse-json-and-generate-clean-csv\/biorxiv_clean.csv')\nbiorx_lst = biorx_df['title'].astype(str).to_list()\nprint(biorx_lst)","a9465866":"doc_vecs = bc.encode(biorx_lst)\nprint(doc_vecs.shape)","3e0bf528":"def find_similar_articles(query,topk):\n    query_vec = bc.encode([query])[0]\n    score = np.sum(query_vec * doc_vecs, axis=1) \/ np.linalg.norm(doc_vecs, axis=1)\n    topk_idx = np.argsort(score)[::-1][:topk]\n    for idx in topk_idx:\n        print('> %s\\t%s' % (score[idx], biorx_lst[idx]))\n","8c136194":"find_similar_articles(\"smoking or pre-existing pulmonary disease increase risk of COVID-19\",5)","c8b1eaea":"find_similar_articles(\"Socio-economic and behavioral factors to understand the economic impact of the coronavirus and whether there were differences.\",5)","1d4b7ba9":"find_similar_articles(\"Co-infections (determine whether co-existing respiratory\/viral infections make the virus more transmissible or virulent) and other co-morbidities\",5)","8f836ce3":"find_similar_articles(\"Risk of of COVID-19 for neonates and pregnant women\",5)","b7b202ca":"find_similar_articles(\" Potential risk factors of Transmission dynamics of the virus, including the basic reproductive number, incubation period, serial interval, modes of transmission and environmental factors\",5)","893a667e":"find_similar_articles(\"What is the severity of disease, including risk of fatality among symptomatic hospitalized patients, and high-risk patient groups?\",5)","f6c4976e":"find_similar_articles(\"Susceptibility of populations\",5)","e63f8975":"find_similar_articles(\"Public health mitigation measures that could be effective for control\",5)","3c76b6b8":"!bert-serving-terminate -port 5555","71bc087b":"Downloading the pre-trained weights of Biobert","189fa275":"**Susceptibility of populations**","94b25d27":"**What is the severity of disease, including risk of fatality among symptomatic hospitalized patients, and high-risk patient groups?**","6242d1a6":"Importing the biorxiv csv file and creating a list of all the titles","3780af7c":"**Risk of of COVID-19 for neonates and pregnant women**","43250e0b":"Co-infections (determine whether co-existing respiratory\/viral infections make the virus more transmissible or virulent) and other co-morbidities","a38adb02":"# **COVID-19 Biobert Semantic Search Engine**\n1. **The goal is to find semantically similar articles based on title by mapping variable length sentences to a fixed length vector using Biobert model.** \n2. **The intention is to implement this using bert as a service. **\n3. **Also abstracts and full text can be vectorized using this. (This kernel uses only biorxiv dataset and is implemented for titles only)**\n4. **This is also worth trying with ClinicalBert, SciBert and other Bert based biomedical language models.**\n\n**The next goal would be trying to create an end to end pipeline having a combination of different algorithms to have specific answers to the questions mentioned in the tasks.**\n","e24b884d":"Making Sure we have the right version of tensorflow installed","3d765c8b":"Setting required arguments for the bert server and starting the server.","501bb3e8":"**References:**\n\n**Bert as a service: https:\/\/github.com\/hanxiao\/bert-as-service**\n\n**Biobert pre-trained weights: https:\/\/github.com\/naver\/biobert-pretrained\/releases**\n\n**Dataset Source: https:\/\/www.kaggle.com\/xhlulu\/cord-19-eda-parse-json-and-generate-clean-csv**\n","ce850605":"Importing the required packages","2f93416e":"**Potential risk factors of Transmission dynamics of the virus, including the basic reproductive number, incubation period, serial interval, modes of transmission and environmental factors**","4c7f2cb0":"Installing the required dependencies.","9985e0d8":"Function to find top K similar articles for a given query","f0f5d2fd":"**Socio-economic and behavioral factors to understand the economic impact of the coronavirus and whether there were differences.**","49d406d7":"**Public health mitigation measures that could be effective for control**","6f7925c4":"Creating embeddings of all the titles","6fba763c":"**smoking or pre-existing pulmonary disease increase risk of COVID-19**","36940f43":"Unpacking the weights and renaming it as per the original bert model (as its a requirement for bert as a service)"}}