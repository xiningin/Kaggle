{"cell_type":{"34d192bb":"code","0f3bee41":"code","5ba68996":"code","83c3e547":"code","b3a1345d":"code","f29ac5e9":"code","5afe59d7":"code","38e3ebf7":"code","5adbac46":"code","d157248a":"code","9d7def58":"code","10c5ef70":"code","10ec5600":"code","04a53110":"code","cf85bb61":"code","4c88251d":"markdown","856954f5":"markdown","1a2bef94":"markdown","b72b34c5":"markdown","c0a5d7b9":"markdown","e93265d7":"markdown","f9ae2e0f":"markdown","ce79b92e":"markdown","f26fb0c5":"markdown"},"source":{"34d192bb":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom wordcloud import WordCloud\nfrom nltk.corpus import stopwords\nimport re\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras.preprocessing import sequence\nfrom tensorflow.keras.utils import to_categorical\nfrom tensorflow.keras.layers import Embedding\nfrom tensorflow.keras.datasets import imdb","0f3bee41":"(x_train, y_train),(x_test, y_test) = imdb.load_data(skip_top=20, num_words=50000) # \uc0c1\uc704 20\uac1c \ub2e8\uc5b4\ub294 \uac74\ub108\ub700, \ud6c8\ub828\uc5d0 \uc0ac\uc6a9\ud560 \ub2e8\uc5b4 \uac1c\uc218=50000\nprint(x_train.shape, y_train.shape)","5ba68996":"print(x_train[0])","83c3e547":"for i in range(len(x_train)):\n    x_train[i] = [w for w in x_train[i] if w>2]","b3a1345d":"# \uc601\ub2e8\uc5b4\uc640 \uc815\uc218\ub85c \uad6c\uc131\ub41c \ub515\uc154\ub108\ub9ac \ubc18\ud658\nword_to_index = imdb.get_word_index()\n# \uc815\uc218\ub97c \uc601\ub2e8\uc5b4\ub85c \ubcc0\ud658\nindex_to_word = {word_to_index[k]: k for k in word_to_index}    \n\nindex_to_word","f29ac5e9":"def decode_review(data):\n    return ' '.join([index_to_word.get(i,'?') for i in data])\n\ndecode_review(x_train[0])","5afe59d7":"# \ubd88\uc6a9\uc5b4 \ucc98\ub9ac\nword = index_to_word.values()\nstop_words = set(stopwords.words('english'))\n\nword_clean=[]\n\nfor w in word:\n    if w not in stop_words:\n        word_clean.append(w) ","38e3ebf7":"np.unique(y_train, return_counts=True)","5adbac46":"maxlen = 300 # \ucd5c\ub300 \uc0d8\ud50c \uae38\uc774\nx_train_seq = sequence.pad_sequences(x_train, maxlen=maxlen)\nx_test_seq = sequence.pad_sequences(x_test, maxlen=maxlen)\n\nprint(x_train_seq.shape, x_test_seq.shape)","d157248a":"print(x_train_seq[0])","9d7def58":"model = keras.Sequential()\nmodel.add(keras.layers.Embedding(50000,16))\nmodel.add(keras.layers.SimpleRNN(16))\nmodel.add(keras.layers.Dense(16, activation='relu'))\nmodel.add(keras.layers.Dense(1, activation='sigmoid'))\n\nmodel.summary()","10c5ef70":"model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])\nhist = model.fit(x_train_seq, y_train, epochs=10, batch_size=32, validation_split=0.5)","10ec5600":"results = model.evaluate(x_test_seq, y_test, verbose=2)\n\nprint(results)","04a53110":"plt.plot(hist.history['loss'],'r',label='loss')\nplt.plot(hist.history['val_loss'],'b',label='val_loss')\nplt.legend()\nplt.show()","cf85bb61":"plt.plot(hist.history['accuracy'],'r',label='accuracy')\nplt.plot(hist.history['val_accuracy'],'b',label='val_accuracy')\nplt.legend()\nplt.show()","4c88251d":"IMDB \ub370\uc774\ud130\ub294 \ub9ac\ubdf0\uc5d0 \ud3ec\ud568\ub41c \ub2e8\uc5b4\ub97c \uc774\ubbf8 \uc815\uc218\ub85c \ubc14\uafb8\uc5b4 \ub193\uc740 \ub370\uc774\ud130\uc774\ub2e4.\n\n\uc22b\uc790 2\ub294 \uc5b4\ud718 \uc0ac\uc804\uc5d0 \uc5c6\ub294 \ub2e8\uc5b4\ub97c \uc758\ubbf8\ud558\uae30 \ub54c\ubb38\uc5d0, \uc81c\uc678\ud574\uc8fc\uba74 \ub41c\ub2e4.","856954f5":"y\ub370\uc774\ud130\ub294 1\uacfc 0\uc73c\ub85c \uad6c\uc131\ub418\uc5b4 \uc601\ud654\ub9ac\ubdf0\uac00 \uae0d\uc815(1)\uc778\uc9c0 \ubd80\uc815(0)\uc778\uc9c0\ub97c \ub098\ud0c0\ub0c4","1a2bef94":"\uc190\uc2e4\uacfc \uc815\ud655\ub3c4\ub85c \ubaa8\ub378\uc758 \uc131\ub2a5 \ud3c9\uac00\ud558\uae30","b72b34c5":"\uc190\uc2e4 \uadf8\ub798\ud504\uacfc \uc815\ud655\ub3c4 \uadf8\ub798\ud504\ub97c \uadf8\ub824 \ud6c8\ub828 \uc9c4\ud589\uc5d0 \ub530\ub978 \ubcc0\ud654 \ud655\uc778","c0a5d7b9":"pad_sequences\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc0d8\ud50c \uae38\uc774\ub97c \ub9de\ucdb0\uc8fc\uc5b4\uc57c \ud568","e93265d7":"# \uc601\ud654 \ub9ac\ubdf0\ub97c \uc0ac\uc6a9\ud55c \ud14d\uc2a4\ud2b8 \ubd84\ub958\n\n## IMDB = Internet Movie DataBase","f9ae2e0f":"\ucd5c\ub300 \uc0d8\ud50c \uae38\uc774 \uc774\ud558\uc758 \ub370\uc774\ud130\ub294 \uc67c\ucabd\uc5d0 0\uc744 \ucc44\uc6cc\ub123\uc5b4 \uae38\uc774\ub97c \ub9de\ucd98\ub2e4.","ce79b92e":"\ub370\uc774\ud130 \uc138\ud2b8 \ubd88\ub7ec\uc624\uace0, \ud6c8\ub828 \uc138\ud2b8 \ud06c\uae30 \ud655\uc778\ud558\uae30","f26fb0c5":"index_to_word\ub294 \uc815\uc218Key\uc640 \uc601\ub2e8\uc5b4\ub97c Value\uac12\uc73c\ub85c \uac00\uc9c4 \ub515\uc154\ub108\ub9ac\uc774\ub2e4.\n\nindex_to_word\ub97c \uc774\uc6a9\ud558\uc5ec \ub9ac\ubdf0 \ubb38\uc7a5\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub294 decode_review \ud568\uc218\ub97c \ub9cc\ub4e4\uc5b4 \ud14d\uc2a4\ud2b8 \ud615\ud0dc\uc758 \ub9ac\ubdf0\ub97c \ucd9c\ub825\ud574\ubcfc \uc218 \uc788\ub2e4."}}