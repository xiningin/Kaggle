{"cell_type":{"c1ae016e":"code","d98d33c6":"code","22e6a884":"code","b7844d60":"code","ce3cdf02":"code","46cd0dba":"code","43a4008f":"code","603e38e0":"code","88ccc217":"code","a12bec3f":"code","50b4944e":"code","2582d838":"code","d4bc6df6":"code","180f51e6":"code","886a1a39":"code","d3f6db28":"code","8bfb012a":"code","d2c88ba9":"code","81e83107":"code","5190115c":"code","5470c94b":"code","a4dcfada":"code","13f8df52":"code","94dfbee2":"code","2fd5476f":"code","a63e3aa8":"code","ae2d1308":"code","e19e1afb":"code","fa449fa8":"code","760e33cb":"code","90d228f8":"code","ef4fb106":"code","eff15847":"code","8774203b":"code","36602852":"code","a2519440":"code","1533688d":"code","3efb86a3":"code","2e4373f1":"code","d84f1431":"code","cf419dde":"code","987bf4d2":"code","d3578ae1":"code","7128a400":"code","1c797ff0":"code","30249a22":"code","ad50413a":"code","4e82bb80":"code","e06cf0b3":"code","f5eee9c1":"code","0b487a74":"code","d7ed9ecf":"code","a7469d89":"code","810c22d9":"code","80f1ea6f":"code","39e67c5e":"code","16690379":"code","ad70d2a4":"code","b8a1068b":"code","34985227":"markdown","ad40c8c5":"markdown","dabb524b":"markdown","c76fbd96":"markdown","cafdb5db":"markdown","c6178aea":"markdown","f2ba1643":"markdown","ca35632f":"markdown"},"source":{"c1ae016e":"import numpy as np # linear algebra\nimport pandas as pd # data processing\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom scipy.stats import boxcox,skew,norm\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import LabelEncoder\n","d98d33c6":"#reading the dataset\n\nbank_data = pd.read_csv('..\/input\/PL_XSELL.csv')","22e6a884":"bank_data.shape","b7844d60":"bank_data.head()","ce3cdf02":"bank_data.drop(['random','CUST_ID'],axis=1,inplace=True)","46cd0dba":"bank_data.info()#checking data types","43a4008f":"bank_data.isna().sum()#checking null values","603e38e0":"bank_data.describe(include='all').transpose()#descriptive statistics","88ccc217":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\nbank_data['GENDER'] = le.fit_transform(bank_data['GENDER'])\nbank_data['AGE_BKT'] = le.fit_transform(bank_data['AGE_BKT'])\nbank_data['OCCUPATION'] = le.fit_transform(bank_data['OCCUPATION'])\nbank_data['ACC_TYPE'] = le.fit_transform(bank_data['ACC_TYPE'])\n","a12bec3f":"bank_data['ACC_OP_DATE'][:3]","50b4944e":"type(bank_data['ACC_OP_DATE'][0])","2582d838":"# converting into pd datetime format","d4bc6df6":"bank_data['ACC_OP_DATE']=pd.to_datetime(bank_data['ACC_OP_DATE'])","180f51e6":"type(bank_data['ACC_OP_DATE'][0])","886a1a39":"bank_data.head(3)","d3f6db28":"plt.subplots(figsize=(16,10))\nsns.heatmap(bank_data.corr())","8bfb012a":"bank_data.columns\n","d2c88ba9":"#Univariate analysis","81e83107":"bank_data.TARGET.value_counts()\n","5190115c":"bank_data.TARGET.value_counts().plot(kind='bar')","5470c94b":"bank_data.GENDER.value_counts().plot(kind='bar')","a4dcfada":"sns.boxplot(bank_data.AGE)","13f8df52":"sns.distplot(bank_data.AGE)","94dfbee2":"sns.countplot(bank_data['ACC_OP_DATE'])","2fd5476f":"bank_data.OCCUPATION.value_counts().plot(kind='bar')","a63e3aa8":"#occupation wise interested in new loan  policy\nbank_data.OCCUPATION[bank_data.TARGET==1].value_counts().plot(kind='bar')\nprint(bank_data.OCCUPATION[bank_data.TARGET==1].value_counts())","ae2d1308":"(bank_data.OCCUPATION[bank_data.TARGET==1].value_counts()\/bank_data.OCCUPATION.value_counts())*100","e19e1afb":"#ACC_TYPE wise interested in new loan  policy\nbank_data.ACC_TYPE[bank_data.TARGET==1].value_counts().plot(kind='bar')\nprint(bank_data.ACC_TYPE[bank_data.TARGET==1].value_counts())\n","fa449fa8":"(bank_data.ACC_TYPE[bank_data.TARGET==1].value_counts()\/bank_data.ACC_TYPE.value_counts())*100","760e33cb":"# Gender wise interest in new loan policy\nbank_data.GENDER[bank_data.TARGET==1].value_counts().plot(kind='bar')\nprint(bank_data.GENDER[bank_data.TARGET==1].value_counts())\n","90d228f8":"# GENDER wise  interest in new loan \n(bank_data.GENDER[bank_data.TARGET==1].value_counts()\/bank_data.GENDER.value_counts())*100","ef4fb106":"# bank_data['ACC_OP_DATE'] = le.fit_transform(bank_data['OCCUPATION'])","eff15847":"bank_data.columns","8774203b":"##Age Bucket interested in new policy\nbank_data.AGE_BKT[bank_data.TARGET==1].value_counts().plot(kind='bar')\nprint(bank_data.AGE_BKT[bank_data.TARGET==1].value_counts())\n","36602852":"# % of each Age Bucket groups interested in new loan \n(bank_data.AGE_BKT[bank_data.TARGET==1].value_counts()\/bank_data.AGE_BKT.value_counts())*100","a2519440":"# Age Bucket 3 is more interested(17%) in new loan policy than other age groups","1533688d":"sns.scatterplot(bank_data['ACC_OP_DATE'],bank_data.TARGET,alpha=0.1)","3efb86a3":"#scaling data\nx = bank_data.drop(['ACC_OP_DATE','TARGET'],axis=1)\ny =bank_data.TARGET","2e4373f1":"sc= StandardScaler()\n","d84f1431":"sc.fit_transform(x)","cf419dde":"from sklearn.model_selection import train_test_split","987bf4d2":"#splitting data into 70% btrain and 30% test\n\nx_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.3,random_state=1)","d3578ae1":"#CART Algotrithm","7128a400":"from sklearn.tree import DecisionTreeClassifier\nimport sklearn.metrics as metrics","1c797ff0":"dct = DecisionTreeClassifier()","30249a22":"dct.fit(x_train,y_train)","ad50413a":"#train set accuracy score\ndct.score(x_train,y_train)","4e82bb80":"#test set accuracy score\ndct.score(x_test,y_test)","e06cf0b3":"#check with cross validation","f5eee9c1":"from sklearn.model_selection import cross_val_score","0b487a74":"cross_score = cross_val_score(dct,x_test,y_test,cv=5,scoring='accuracy')","d7ed9ecf":"cross_score","a7469d89":"#mean accuracy score\nprint(cross_score.mean())","810c22d9":"predit = dct.predict(x_test)#predictd values","80f1ea6f":"#confusion metrics\ncm=metrics.confusion_matrix(y_test,predit)","39e67c5e":"print(cm)","16690379":"cr=metrics.classification_report(y_test,predit)","ad70d2a4":"print(cr)","b8a1068b":"#roc curve\n\ndef roccurve(y_values, y_preds_proba):\n    fpr, tpr, _ = metrics.roc_curve(y_values, y_preds_proba)\n    xx = np.arange(101) \/ float(100)\n    aur = metrics.auc(fpr,tpr)\n    plt.xlim(0, 1.0)\n    plt.ylim(0, 1.25)\n    plt.plot([0.0, 0.0], [0.0, 1.0], color='green', linewidth=8)\n    plt.plot([0.0, 1.0], [1.0, 1.0], color='green', label='Perfect Model', linewidth=4)\n    plt.plot(xx,xx, color='blue', label='Random Model')\n    plt.plot(fpr,tpr, color='red', label='CART Model')\n    plt.title(\"ROC Curve - AUR value =\"+str(aur))\n    plt.xlabel('% False positives')\n    plt.ylabel('% True positives')\n    plt.legend()\n    plt.show()\n\n\n\n\ndct_test_pred_proba = dct.predict_proba(X=x_test)\nroccurve(y_values=y_test, y_preds_proba=dct_test_pred_proba[:,1])","34985227":"#Target variable has very lesscorrelation with other attributes","ad40c8c5":"#Male gender is more interested(13% in new loan\n#group 2 is unknown gender and total of 10 such records are present in dataset we can  ignoring those records","dabb524b":"\nDataSet:PL_XSELL.csv\n\u2022\tSplit data in Training (Development Sample) 70% and Hold-out Sample 30%\n\u2022\tBuild CART Model in Python\n\u2022\t AUC and Rank Ordering performance -Python \n","c76fbd96":"Percentage wise account type 0 is mor interested in new loan(16%)","cafdb5db":"#class 0 is higher than class 1","c6178aea":"#Occupation group 2 is more interested in new loan policy (20%)","f2ba1643":"#Most of the Account Holders are between 30 to 46 years of age","ca35632f":"#Most number of account holders are of gender male"}}