{"cell_type":{"c6b3fefc":"code","c045d634":"code","72f72cb5":"code","53190f15":"code","91bbe259":"code","15c0282c":"code","0d67269c":"code","9a2764fa":"code","9b465746":"code","e60d4ca1":"code","51493d77":"code","b921bdeb":"code","b87de144":"code","26c4f789":"code","486e3a4d":"code","3c80b7eb":"code","fc247f69":"code","633a3373":"code","9f9dd0c4":"markdown"},"source":{"c6b3fefc":"import pandas as pd\ndata = pd.read_csv('..\/input\/Narrativedata.csv',index_col=0)\n#index_col=0\u4ee5\u7b2c0\u5217\u70ba\u7d22\u5f15\uff0c\u5982\u679c\u4e0d\u5beb\uff0c\u6703\u88ab\u7576\u4f5c\u662f\u7279\u5fb5\u4e4b\u4e00\ndata.head()","c045d634":"data.info() #\u6709\u5e74\u9f61\u7f3a\u5931\u503c","72f72cb5":"Age = data.loc[:,\"Age\"].values.reshape(-1,1)\n#\u56e0\u70ba\u6578\u64da\u662fdataframe\u5f62\u5f0f\uff0c\u53ef\u4ee5\u9032\u884c\u63d0\u53d6\uff0c\u53d6\u503c\uff08\u7d22\u5f15\u6d88\u5931\uff09\n#\u8981\u88ab\u5c0e\u5165\u6a21\u578b\u4e2d\uff0c\u4e0d\u80fd\u662f\u4e00\u7dad\u77e9\u9663\uff0c\u6240\u4ee5\u8981\u7528reshape(-1,1)\u6539\u8b8a\u7dad\u5ea6\nAge[:20]","53190f15":"#\u586b\u88dc\u6578\u64da\nfrom sklearn.impute import SimpleImputer\nimp_mean = SimpleImputer()      #\u5747\u503c\u586b\u88dc\nimp_median = SimpleImputer(strategy=\"median\") #\u4e2d\u4f4d\u6578\u586b\u88dc\nimp_0 = SimpleImputer(strategy=\"constant\",fill_value=0)  #\u75280\u586b\u88dc\nimp_mean = imp_mean.fit_transform(Age) #\u5be6\u4f8b\u5316\uff0cfit\u8abf\u51fa\u7d50\u679c\nimp_median = imp_median.fit_transform(Age) #\u5be6\u4f8b\u5316fit\u8abf\u51fa\u7d50\u679c\nimp_0 = imp_0.fit_transform(Age)         #\u5be6\u4f8b\u5316fit\u8abf\u51fa\u7d50\u679c\n#\u5728\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u4e2d\u4f4d\u6570\u586b\u8865Age \ndata.loc[:,\"Age\"] = imp_median\ndata.info()","91bbe259":"#\u4f7f\u7528\u4f17\u6570\u586b\u8865Embarked(\u5c6c\u65bc\u5b57\u7b26\u8cc7\u6599)\nEmbarked = data.loc[:,\"Embarked\"].values.reshape(-1,1)\n#sklearn\u5f53\u4e2d\u7279\u5f81\u77e9\u9635\u5fc5\u987b\u662f\u4e8c\u7ef4\nimp_mode = SimpleImputer(strategy = \"most_frequent\") \n#\u5b9e\u4f8b\u5316\uff0c\u9ed8\u8ba4\u5747\u503c\u586b\u8865 #\u7528\u4e2d\u4f4d\u6570\u586b\u8865 #\u75280\u586b\u8865\n#fit_transform\u4e00\u6b65\u5b8c\u6210\u8c03\u53d6\u7ed3\u679c\ndata.loc[:,\"Embarked\"] = imp_mode.fit_transform(Embarked) \ndata.info()","15c0282c":"import pandas as pd\ndata_ = pd.read_csv(\"..\/input\/Narrativedata.csv\",index_col=0)\ndata_.head()\ndata_.loc[:,\"Age\"] = data_.loc[:,\"Age\"].fillna(data_.loc[:,\"Age\"].median())\n#.fillna \u5728DataFrame\u91cc\u9762\u76f4\u63a5\u8fdb\u884c\u586b\u8865\n#\u7528\u4e2d\u4f4d\u6578\u586b\u88dc\ndata_.info()","0d67269c":"data_ = data_.dropna(axis=0,inplace=False)","9a2764fa":"data_.info()","9b465746":"from sklearn.preprocessing import LabelEncoder\n\ny = data.iloc[:,-1] #\u8981\u8f93\u5165\u7684\u662f\u6807\u7b7e\uff0c\u4e0d\u662f\u7279\u5f81\u77e9\u9635\uff0c\u6240\u4ee5\u5141\u8bb8\u4e00\u7ef4\nle = LabelEncoder()\nle = le.fit(y)\nlabel = le.transform(y)\n#label\u662f\u4e00\u7dad\u77e9\u9663\uff08891,)\n","e60d4ca1":"le.classes_","51493d77":"le.fit_transform(y) \nle.inverse_transform(label)\ndata.iloc[:,-1] = label #\u8ba9\u6807\u7b7e\u7b49\u4e8e\u6211\u4eec\u8fd0\u884c\u51fa\u6765\u7684\u7ed3\u679c data.head()\ndata.head() #\u5df2\u7d93\u5c07\u5b57\u7b26\u6539\u6210\u6578\u503c\u8cc7\u6599","b921bdeb":"from sklearn.preprocessing import LabelEncoder\ndata.iloc[:,-1] = LabelEncoder().fit_transform(data.iloc[:,-1])\n","b87de144":"from sklearn.preprocessing import OrdinalEncoder \n#\u63a5\u53e3categories_\u5bf9\u5e94LabelEncoder\u7684\u63a5\u53e3classes_\uff0c\u4e00\u6a21\u4e00\u6837\u7684\u529f\u80fd\n#\u5e6b\u4f60\u770b\u7279\u5fb5\u4e2d\u6709\u591a\u5c11\u500b\u985e\u5225\ndata_ = data.copy() #\u4fdd\u8b77\u539f\u59cb\u8cc7\u6599\ndata_.head()\nOrdinalEncoder().fit(data_.iloc[:,1:-1]).categories_\n#\u6240\u6709\u7684\u884c\uff0c\u5f9e\u7d22\u5f15\u70ba1\u958b\u59cb\uff0c\u53d6\u5230\u6700\u5f8c\u4e00\u5217\u4e4b\u524d\uff0c-1\u4ee3\u8868\u662f\u6700\u5f8c\u4e00\u5217\u4e4b\u524d\n#\u4e5f\u5c31\u662f\u5f9eSex\u5230Emabarked  \uff08\u4e5f\u53ef\u4ee5\u76f4\u63a5data_.iloc[:,1:3]\u524d\u9762\u6703\u53d6\u5230\uff0c\u5f8c\u9762\u4e0d\u6703\u53d6\u5230\ndata_.iloc[:,1:-1] = OrdinalEncoder().fit_transform(data_.iloc[:,1:-1]) \ndata_.head()","26c4f789":"data.head()","486e3a4d":"#\u555e\u8b8a\u91cf\uff08\u6709\u4f60\u6c92\u6211\u7684\u6982\u5ff5\uff09\nfrom sklearn.preprocessing import OneHotEncoder\nX = data.iloc[:,1:-1]#\u4e2d\u9593\u5169\u5217\nenc = OneHotEncoder(categories='auto').fit(X)   \nresult = enc.transform(X).toarray()   #\u5169\u500b\u7279\u5fb5\u4e94\u500b\u985e\u5225\uff08Sex\tEmbarked\uff09\nresult","3c80b7eb":"enc.get_feature_names() #\u6bcf\u500b\u77e9\u9663\uff08\u5df2\u7d93fit\u904e\u7684\uff09\u540d\u7a31\n\nresult","fc247f69":"result.shape\n#axis=1,\u8868\u793a\u8de8\u884c\u8fdb\u884c\u5408\u5e76\uff0c\u4e5f\u5c31\u662f\u5c06\u91cf\u8868\u5de6\u53f3\u76f8\u8fde\uff0c\u5982\u679c\u662faxis=0\uff0c\u5c31\u662f\u5c06\u91cf\u8868\u4e0a\u4e0b\u76f8\u8fde\n# \u8b8a\u6210\u4e8c\u7dad\u77e9\u9663","633a3373":"newdata = pd.concat([data,pd.DataFrame(result)],axis=1)#\u5408\u4f75dataframe\n#result \u672c\u4f86\u662farray   \uff03\u5c07result \u52a0\u5230\u6709\u908a\uff08\u56e0\u70baaxis=1)\nnewdata.head()\nnewdata.drop([\"Sex\",\"Embarked\"],axis=1,inplace=True)#\u628a\u539f\u4f86\u7684sex\u3001embarked\u8abf\nnewdata.columns = [\"Age\",\"Survived\",\"Female\",\"Male\",\"Embarked_C\",\"Embarked_Q\",\"Embarked_S\"]\nnewdata.head()","9f9dd0c4":"\u555e\u8b8a\u91cf"}}