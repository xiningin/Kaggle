{"cell_type":{"32fc7f60":"code","d1fb7ad2":"code","1b870d67":"code","79054f82":"code","cf283ea4":"code","fc7368ba":"code","70430441":"code","a434672f":"code","8ce919f7":"code","07976f94":"code","86d8a531":"code","75a842d7":"code","f9a1af9a":"code","9845d871":"code","916dccf6":"code","9132b20e":"code","a9f47e4c":"code","0bb50796":"code","5be7a94a":"code","0e7c8385":"code","79939797":"code","debd44d3":"code","defe27eb":"code","5ee4edb0":"code","c38f2484":"code","22bdda01":"code","35cf3b8d":"code","34cb09db":"code","614d925b":"code","a66fa235":"code","33d9367b":"code","34864d7d":"code","5c712176":"code","239db78e":"code","c1a77493":"code","cc27dd25":"code","0fe1a953":"code","292eb839":"code","a42bb33b":"code","0bff692f":"code","bf96ec7d":"code","e2979e5b":"code","94c99dec":"code","002f1da5":"code","d7591bc2":"code","26a50a78":"code","439a5b73":"code","14c89f3d":"code","bed2f6d6":"code","ec1ccb8a":"code","5564b167":"code","ffeae1ae":"code","732a7927":"code","49260999":"code","08e54267":"code","c3e81f56":"code","97328cbb":"code","650a4de8":"code","00a79ce1":"code","279d440d":"code","076687a0":"code","9458003f":"code","6a794170":"code","f3c26fa5":"code","81d40096":"code","22f37d2c":"code","53dd194c":"code","32e205a0":"code","a4561df5":"code","e1cea94c":"code","f023d24f":"code","52a8ab8c":"code","15b89dc3":"code","44a2d937":"code","4957e6ba":"code","42b54b7d":"code","2d217f12":"code","e82316ee":"code","87276bd4":"code","ec5e409c":"code","d45b4b1f":"code","726c5996":"code","ca0d9ea8":"code","4f47af56":"code","b4b7602f":"code","c123c8fb":"code","89d01a9d":"code","bfa06147":"code","db7e76a5":"code","5fa0fb07":"markdown","1e9e07ed":"markdown","73326496":"markdown"},"source":{"32fc7f60":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn import tree\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import f1_score","d1fb7ad2":"# reading csv file\nstroke_data = pd.read_csv('..\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv')","1b870d67":"# checking the first five element\nstroke_data.head()","79054f82":"# shape of data\nstroke_data.shape","cf283ea4":"# gathering the information\nstroke_data.info()","fc7368ba":"stroke_data.describe()","70430441":"# checking the null value of every column\nstroke_data.isnull().sum()","a434672f":"# since bmi has many null value we will replace it with mean\nstroke_data=stroke_data.replace(to_replace=np.nan,value=stroke_data.mean())","8ce919f7":"# checking null values\nstroke_data.isnull().sum()","07976f94":"correlation=stroke_data.corr()","86d8a531":"sns.heatmap(correlation,annot=True)","75a842d7":"stroke_data.nunique()","f9a1af9a":"stroke_data['smoking_status'].unique()","9845d871":"stroke_data['Residence_type'].unique()","916dccf6":"stroke_data['work_type'].unique()","9132b20e":"stroke_data['ever_married'].unique()","a9f47e4c":"stroke_data['gender'].unique()","0bb50796":"# count of smoking status\nsns.countplot(x=stroke_data['smoking_status'])","5be7a94a":"# as for clarification we will treat 'Unknown' as a null value and replace it\nstroke_data['smoking_status'].replace(to_replace='Unknown',value=stroke_data['smoking_status'].mode()[0],inplace=True)","0e7c8385":"sns.countplot(x=stroke_data['Residence_type'])","79939797":"sns.countplot(x=stroke_data['work_type'])","debd44d3":"sns.countplot(x=stroke_data['ever_married'])","defe27eb":"sns.countplot(x=stroke_data['gender'])","5ee4edb0":"sns.countplot(x=stroke_data['heart_disease'])","c38f2484":"sns.countplot(x=stroke_data['hypertension'])","22bdda01":"sns.boxplot(x='bmi',data=stroke_data)","35cf3b8d":"def remove_outliers(data):\n    arr=[]\n    #print(max(list(data)))\n    q1=np.percentile(data,25)\n    q3=np.percentile(data,75)\n    iqr=q3-q1\n    mi=q1-(1.5*iqr)\n    ma=q3+(1.5*iqr)\n    #print(mi,ma)\n    for i in list(data):\n        if i<mi:\n            i=mi\n            arr.append(i)\n        elif i>ma:\n            i=ma\n            arr.append(i)\n        else:\n            arr.append(i)\n    #print(max(arr))\n    return arr\n","34cb09db":"stroke_data['bmi']=remove_outliers(stroke_data['bmi'])","614d925b":"sns.boxplot(x='bmi',data=stroke_data)","a66fa235":"stroke_data.head()","33d9367b":"sns.boxplot(x='avg_glucose_level',data=stroke_data)","34864d7d":"stroke_data['avg_glucose_level']=remove_outliers(stroke_data['avg_glucose_level'])","5c712176":"sns.boxplot(x='avg_glucose_level',data=stroke_data)","239db78e":"# relation between age and stroke\nsns.countplot(x='work_type',hue='stroke',data=stroke_data)","c1a77493":"# relationship between smoking status and stroke\nsns.countplot(hue='hypertension',x='stroke',data=stroke_data)\n","cc27dd25":"sns.countplot(x='work_type',hue='stroke',data=stroke_data)","0fe1a953":"sns.countplot(x='heart_disease',hue='stroke',data=stroke_data)","292eb839":"stroke_data.columns","a42bb33b":"from sklearn.preprocessing import LabelEncoder","0bff692f":"label_encoder=LabelEncoder()","bf96ec7d":"data=stroke_data.apply(label_encoder.fit_transform)","e2979e5b":"data.head()","94c99dec":"data['smoking_status'].unique()","002f1da5":"correl=data.corr(method='pearson')\n#sns.heatmap(correl,annot=True)\ncorrel","d7591bc2":"data.drop(['id'],axis=1,inplace=True)","26a50a78":"data.head()","439a5b73":"from sklearn.model_selection import train_test_split","14c89f3d":"x=data.drop('stroke',axis=1)\ny=data['stroke']","bed2f6d6":"x.shape","ec1ccb8a":"y.shape","5564b167":"from imblearn.over_sampling import RandomOverSampler\nrus = RandomOverSampler(random_state=42)\nx,y=rus.fit_resample(x, y)","ffeae1ae":"x.shape","732a7927":"y.shape","49260999":"x_Train,x_Test,y_Train,y_Test= train_test_split(x,y,test_size=0.4,random_state=40)","08e54267":"features=list(x_Train.columns)","c3e81f56":"features","97328cbb":"dtree = DecisionTreeClassifier()\ndtree = dtree.fit(x_Train,y_Train)","650a4de8":"pred1=dtree.predict(x_Test)\n","00a79ce1":"from sklearn.metrics import accuracy_score\nfrom sklearn.metrics import precision_score\nprint(accuracy_score(y_Test,pred1))","279d440d":"from sklearn.metrics import confusion_matrix\ncm=confusion_matrix(y_Test,pred1)\nprint(cm)","076687a0":"def precision(cm):\n    return cm[1][1]\/(cm[1][1]+cm[0][1])\n\nprint(precision(cm))","9458003f":"def recall(cm):\n    return cm[1][1]\/(cm[1][1]+cm[1][0])\n\nrecall(cm)                                    ","6a794170":"def specificity(cm):\n    return cm[0][0]\/(cm[0][0]+cm[0][1])\n\nspecificity(cm)","f3c26fa5":"f1_score(y_Test,pred1)","81d40096":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.preprocessing import MinMaxScaler","22f37d2c":"# x=data.drop('stroke',axis=1)\n# y=data['stroke']\n","53dd194c":"# sc=MinMaxScaler(feature_range=(0,1))\n# X=sc.fit_transform(X)","32e205a0":"#x_Train,x_Test,y_Train,y_Test= train_test_split(x,y,test_size=0.4,random_state=42)","a4561df5":"lg=LogisticRegression(max_iter=10000)","e1cea94c":"lg=lg.fit(x_Train,y_Train)","f023d24f":"pred2=lg.predict(x_Test)","52a8ab8c":"accuracy_score(y_Test,pred2)","15b89dc3":"cm2=confusion_matrix(y_Test,pred2)\ncm2","44a2d937":"precision(cm2)","4957e6ba":"recall(cm2)","42b54b7d":"specificity(cm2)","2d217f12":"f1_score(y_Test,pred2)","e82316ee":"from sklearn.ensemble import RandomForestClassifier","87276bd4":"rf=RandomForestClassifier(n_estimators=100,random_state=42)","ec5e409c":"rf=rf.fit(x_Train,y_Train)","d45b4b1f":"pred3=rf.predict(x_Test)","726c5996":"feature_important=pd.Series(rf.feature_importances_,index=x.columns).sort_values(ascending=False)\nfeature_important","ca0d9ea8":"sns.barplot(x=feature_important,y=feature_important.index)","4f47af56":"accuracy_score(y_Test,pred3)","b4b7602f":"cm3=confusion_matrix(y_Test,pred3)\ncm3","c123c8fb":"precision(cm3)","89d01a9d":"recall(cm3)","bfa06147":"specificity(cm3)","db7e76a5":"f1_score(y_Test,pred3)","5fa0fb07":"# Random Forest Classifier ","1e9e07ed":"# Decision Tree","73326496":"#  Logistic Regression"}}