{"cell_type":{"21f98d79":"code","1251088a":"code","dcac2914":"code","571414db":"code","6a773636":"markdown","61f329ec":"markdown","40fd7ebd":"markdown"},"source":{"21f98d79":"import pandas as pd\nimport os,json","1251088a":"DATA_DIR = '\/kaggle\/input\/CORD-19-research-challenge'\n\ndf = pd.read_csv(f'{DATA_DIR}\/metadata.csv')\nshas = df[df.has_full_text==True].sha.tolist()","dcac2914":"full_text = []\ni = 0\nfor root, dirs, files in os.walk(DATA_DIR):\n    for file in files:\n        sha, ext = os.path.splitext(file)\n        if ext=='.json' and sha in shas:\n            with open(f'{root}\/{file}', 'r') as f:\n                try:\n                    article_json  = json.loads(f.read())\n                except:\n                    continue\n            i+=1\n\n            if i%250==0:\n                print(f'Processed {i} articles. Currently processing {file}')\n            \n            raw_text = []\n            \n            for item in article_json['body_text']:\n                raw_text.append(item['text'])\n            \n            full_text.append((sha, ' '.join(raw_text)))","571414db":"print('Building dataframe')\ndf_fulltext = pd.DataFrame(full_text, columns=['sha', 'body_text'])\n\nprint('Saving dataframe')\ndf_fulltext.to_csv(f'body_text.csv', index=False)","6a773636":"## Create a DataFrame from the List and Save to CSV\nThis dataframe can be merged on sha with the original metadata as well","61f329ec":"## Walk Through the Data Directory, Load JSON, and Build A List of Body Text","40fd7ebd":"## Load the Metadata into a DataFrame and Create a List of SHAs with Full Text"}}