{"cell_type":{"b5c1110d":"code","3f726f3c":"code","f29bbfdc":"code","3da059a6":"code","2cc189aa":"code","77c9d3ae":"code","0f414d5e":"code","19e08077":"code","eedc1afc":"code","bb7534fa":"code","d7adbf8e":"code","77f99b6e":"code","a688afad":"code","cae6661e":"code","9c09f235":"code","dfbad5ce":"code","8ec89f9b":"code","1edcf54b":"code","e1674086":"code","45bd2a2d":"code","1cec7900":"code","e2e6d9f7":"code","6805dc3b":"code","1ac59ffb":"code","830b35bf":"code","07f01952":"code","ef175aa6":"code","34ad9c1f":"code","5c062dd8":"code","07661574":"code","5a9616a4":"code","7ddc4f6f":"code","4a44d0aa":"code","89184038":"code","4db1f93d":"code","8ca35584":"code","d29e24ac":"code","f5ba031b":"code","400cb9d3":"code","d320108b":"code","47381c39":"code","691f607a":"code","fbd6790a":"code","cca7c7c1":"code","bb3f945d":"code","0e66e22f":"code","e1bc7763":"code","64bb8dcb":"code","e9d39fe8":"code","d84d83aa":"markdown","802c01c2":"markdown","dde37d71":"markdown","93591bc0":"markdown","cd4217f4":"markdown","3cc0a0dc":"markdown","6d79b610":"markdown","3fcb4201":"markdown","4e6cd45f":"markdown","11dcd718":"markdown","99494e40":"markdown","b84e5778":"markdown","c5875abd":"markdown","b3c9a8e0":"markdown","4b649476":"markdown","9bdf79ae":"markdown","c933122f":"markdown","61be4da9":"markdown","73deaee5":"markdown","2d6ff87f":"markdown","9115fbb5":"markdown","6537938e":"markdown","3d318335":"markdown","ad6058c9":"markdown","6e693bef":"markdown","3ca280d4":"markdown","293f6283":"markdown","d9598e93":"markdown","bbe4f333":"markdown","81fe8819":"markdown","cbc4c92a":"markdown","e9e4a1be":"markdown","494ea05a":"markdown","404f98a9":"markdown"},"source":{"b5c1110d":"def despine():\n    sns.despine(top=1,bottom=1,right=1,left=1)\n    \ndef title(x,fontsize=13):\n    plt.title(x,fontsize=fontsize,fontweight='bold')","3f726f3c":"def kdeall(df,lst,hspace=.5,wspace=.25,cut=3,h=10,w=10,show=True):\n    f=plt.figure(figsize=(w,h))\n    for i,col in enumerate(lst):\n        f.add_subplot(math.ceil(len(lst)\/cut),cut,i+1)\n        sns.kdeplot(data=df,x=col,palette=sns.color_palette(morancolor[:4]),cut=0)\n        sns.rugplot(data=df,x=col)\n        if show==True:\n            plt.axvline(df[col].median(),label='median',ls='--')\n            plt.axvline(df[col].mean(),label='mean')\n            plt.legend()\n        plt.ylabel('')\n        plt.xlabel(col,fontweight='bold')\n        despine()\n    plt.subplots_adjust(hspace=hspace,wspace=wspace)","f29bbfdc":"# General tools\nimport pandas as pd\nimport numpy as np\nimport os, math\nfrom collections import Counter\n\n# Plotting\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nmorancolor=sns.color_palette(['#66260b', '#cb8034', '#ddc08d', '#9c886f', '#47261a','#363634', '#524636', '#ac7330', '#b19a78', '#d1c5ab'])\nsns.set_theme(style=\"whitegrid\", palette=morancolor)\nplt.rcParams['font.family']='serif'\nplt.rcParams['figure.dpi'] =100 # high resolution\n\nfrom wordcloud import WordCloud , ImageColorGenerator\nfrom PIL import Image\n\n# Manage warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# Data Preprocessing\nfrom sklearn.preprocessing import OrdinalEncoder\nfrom sklearn.preprocessing import MinMaxScaler,StandardScaler\n\n# Model Evaluation\nfrom sklearn.metrics import confusion_matrix, classification_report\n\n# Display max columns\npd.pandas.set_option('display.max_columns',None)","3da059a6":"# loading file\ndf=pd.read_csv(\"..\/input\/body-performance-data\/bodyPerformance.csv\")\ndf.drop_duplicates(inplace=True)\ndf.columns=df.columns.str.strip().str.replace(' ','_')\ndf.rename(columns={'class':'Class', 'body_fat_%':'body_fat', 'sit-ups_counts':'sit_ups_counts'},inplace=True)\ndf.shape","2cc189aa":"df.sample(4)","77c9d3ae":"df.info()","0f414d5e":"# data completeness\ndf.isnull().sum().sort_values(ascending=False)","19e08077":"df.describe()","eedc1afc":"df.describe(include='O')","bb7534fa":"df.gender=df.gender.map({'M':1,'F':0}).astype('int')","d7adbf8e":"oe=OrdinalEncoder(dtype='int')\ndf.Class=oe.fit_transform(df.Class.values.reshape(-1,1)).reshape(1,-1)[0]","77f99b6e":"df.corr().Class.sort_values(ascending=False)[1:].abs().sort_values(ascending=False).plot(kind='bar',figsize=(10,4),alpha=.92)\ndespine()","a688afad":"plt.figure(figsize=(10,7))\nmask = np.triu(np.ones_like(df.corr()))\nsns.heatmap(df.corr(),annot=True,fmt='.2f',mask=mask,annot_kws={\"size\":10},cmap='RdBu',vmin=-1,vmax=1)","cae6661e":"combo1=df.corr().Class[df.corr().Class.abs()>.2].abs().sort_values(ascending=False)[1:].index.tolist()\ncombo1","9c09f235":"fullset=df.corr().Class.abs().sort_values(ascending=False)[1:].index.tolist()","dfbad5ce":"kdeall(df,fullset,h=16,w=10,show=False)","8ec89f9b":"df.Class.value_counts(1)","1edcf54b":"kdeall(df,[\"height_cm\",\"weight_kg\"],cut=2,show=True,h=4,w=10)","e1674086":"df.gender.value_counts(1)","45bd2a2d":"sns.countplot(df.gender)\nsns.countplot(df.gender,hue=df.Class)\nplt.legend(loc=1,bbox_to_anchor=(1.2,1.01),title='Class')\ndespine()","1cec7900":"kdeall(df,['age'],cut=1,w=8,h=5)","e2e6d9f7":"df.gender.value_counts(1)","6805dc3b":"df.corr().Class.abs().sort_values(ascending=False)[1:]>.5","1ac59ffb":"df[fullset].boxplot(vert=0,figsize=(7,5))\ndespine()","830b35bf":"def outlier(df,lst,fence=1.5):\n    outlier_index=[]\n    for col in lst:\n        q1,q3=np.percentile(df[col],25), np.percentile(df[col],75)\n        iqr=q3-q1\n        outlier_index.extend(df[(df[col]<q1-fence*iqr)|(df[col]>q3+fence*iqr)].index)\n    return list(set(outlier_index))","07f01952":"out_ind=outlier(df,['sit_and_bend_forward_cm', 'body_fat', 'broad_jump_cm', 'weight_kg', \n                    'diastolic', 'height_cm', 'systolic'],fence=3)\nprint(f\"We are going to drop {len(out_ind)} observations\")","ef175aa6":"df=df.drop(index=out_ind)","34ad9c1f":"df[fullset].boxplot(vert=0,figsize=(7,5))\ndespine()","5c062dd8":"kdeall(df,fullset,cut=3,w=10,h=16,show=False)","07661574":"from sklearn.preprocessing import MinMaxScaler\nsc=MinMaxScaler()\ndf.age=sc.fit_transform(df.age.values.reshape(-1,1)).reshape(1,-1)[0]","5a9616a4":"stdfeature=[\"sit_and_bend_forward_cm\", \"sit_ups_counts\", \"body_fat\", \"broad_jump_cm\", \"weight_kg\", \"diastolic\", \"height_cm\", \"systolic\"]\nstd=StandardScaler()\nfor i in stdfeature:\n    df[i]=std.fit_transform(df[i].values.reshape(-1,1)).reshape(1,-1)[0]","7ddc4f6f":"kdeall(df,fullset,h=16,w=10, cut=3,show=False)","4a44d0aa":"X=df.drop('Class',axis=1)\ny=df.Class","89184038":"from sklearn.model_selection import train_test_split\nXtrain,Xval,ytrain,yval=train_test_split(X,y,test_size=.2,random_state=0,stratify=df.Class)\nprint(f\"train size: {Xtrain.shape[0]} - validation size: {Xval.shape[0]}\")","4db1f93d":"from sklearn.neighbors import KNeighborsClassifier\nkncl=KNeighborsClassifier(n_neighbors=7)\nkncl.fit(Xtrain,ytrain)\nprint(f\"train score: {kncl.score(Xtrain,ytrain):.4f}\")\nprint(f\"test score: {kncl.score(Xval,yval):.4f}\")","8ca35584":"print(classification_report(yval,kncl.predict(Xval)))","d29e24ac":"sns.heatmap(confusion_matrix(yval,kncl.predict(Xval)),annot=True,annot_kws={\"size\":10},cmap='twilight',fmt='.0f')","f5ba031b":"from sklearn.ensemble import RandomForestClassifier\nrf=RandomForestClassifier(random_state=42,n_estimators=500)\nrf.fit(Xtrain,ytrain)\nprint(f\"train score: {rf.score(Xtrain,ytrain):.4f}\")\nprint(f\"test score: {rf.score(Xval,yval):.4f}\")","400cb9d3":"print(classification_report(yval,rf.predict(Xval)))","d320108b":"sns.heatmap(confusion_matrix(yval,rf.predict(Xval)),annot=True,annot_kws={\"size\":10},cmap='twilight',fmt='.0f')","47381c39":"combo1","691f607a":"rf2=RandomForestClassifier(random_state=42,n_estimators=500)\nrf2.fit(Xtrain[combo1],ytrain)\nprint(f\"train score: {rf2.score(Xtrain[combo1],ytrain):.4f}\")\nprint(f\"test score: {rf2.score(Xval[combo1],yval):.4f}\")","fbd6790a":"from xgboost import XGBClassifier\nxgbc=XGBClassifier(n_estimators=500, learning_rate=0.05)\nxgbc.fit(Xtrain,ytrain, early_stopping_rounds=5, eval_set=[(Xval,yval)],verbose=False)\nprint(f\"train score: {xgbc.score(Xtrain,ytrain):.4f}\")\nprint(f\"test score: {xgbc.score(Xval,yval):.4f}\")","cca7c7c1":"sns.heatmap(confusion_matrix(yval,xgbc.predict(Xval)),annot=True,annot_kws={\"size\":10},cmap='twilight',fmt='.0f')","bb3f945d":"from sklearn.svm import SVC\nsvm=SVC(gamma=1e-4 ,C=500,random_state=42)\nsvm.fit(Xtrain,ytrain)\nprint(f\"train score: {svm.score(Xtrain,ytrain):.4f}\")\nprint(f\"test score: {svm.score(Xval,yval):.4f}\")","0e66e22f":"sns.heatmap(confusion_matrix(yval,svm.predict(Xval)),annot=True,annot_kws={\"size\":10},cmap='twilight',fmt='.0f')","e1bc7763":"from lightgbm import LGBMClassifier\nlgbm=LGBMClassifier(learning_rate=.005,n_estimators=500)\nlgbm.fit(Xtrain,ytrain, early_stopping_rounds=5, eval_set=[(Xval,yval)],verbose=False)","64bb8dcb":"print(f\"train score: {lgbm.score(Xtrain,ytrain):.4f}\")\nprint(f\"test score: {lgbm.score(Xval,yval):.4f}\")","e9d39fe8":"sns.heatmap(confusion_matrix(yval,lgbm.predict(Xval)),annot=True,annot_kws={\"size\":10},cmap='twilight',fmt='.0f')","d84d83aa":"#### Gender","802c01c2":"#### Age","dde37d71":"## Data Dictionary\nSorce: https:\/\/www.kaggle.com\/kukuroo3\/body-performance-data\/code\n    \n    age : 20 ~64\n    gender : F,M\n    height_cm : (If you want to convert to feet, divide by 30.48)\n    weight_kg\n    body fat_%\n    diastolic : diastolic blood pressure (min)\n    systolic : systolic blood pressure (min)\n    gripForce\n    sit and bend forward_cm\n    sit-ups counts\n    broad jump_cm\n    class : A,B,C,D ( A: best) \/ stratified","93591bc0":"- Looks like we don't have missing data\n- There are 2 only categorical features, including our target variable - class","cd4217f4":"- Both height and weight have a roughly normal distribution\n- The median values of height and weight are approximately 170 cm and 67 kg, respectively","3cc0a0dc":"#### KNeighborsClassifier","6d79b610":"# 2. Exploratory Data Analysis (EDA)","3fcb4201":"#### LightGBM","4e6cd45f":"### 2.3 Features analysis","11dcd718":"- In general, distribution of our target variable is quite well-balanced","99494e40":"- There are some significant correlations between several features, such as gender and body fat, height and body fat, height\/ weight and gender, etc\n- The negative correlation between age and number of sit-ups means that younger people tend to sit more than older people. The same goes for the broad jump\n- There is a positive correlation of 0.73 between height and weight, and a negative correlation of -0.52 between height and body fat, which means that taller people have less body fat than shorter people\n- There was some negative correlation between body fat and certain attributes (such as broad jump, sit-ups counts, and grip force), suggesting that people with less body fat tend to do more broad jump, sit-ups and grip force\n- Diastolic and systolic have a positive correlation of 0.68 with each other","b84e5778":"### 1.0 Defining functions","c5875abd":"### 2.2 Correlation Matrix","b3c9a8e0":"#### Height and weight","4b649476":"- The most important features (in order) are: **sit and bend forward, sit ups counts, body fat, broadjump and weight**","9bdf79ae":"### 2.1 Categorical features encoding","c933122f":"#### Target variable","61be4da9":"##### Should we try with our subset?","73deaee5":"- It seems that outliers can appear in weight, diastolic, gripForce, and sit and bend forward features","2d6ff87f":"# 1. Importing data","9115fbb5":"    - Skew: df.sit_and_bend_forward_cm, df.age\n    - Almost bell-shaped: df.height_cm, df.systolic, df.diastolic, df.broad_jump_cm","6537938e":"#### Random Forest","3d318335":"#### Data distribution","ad6058c9":"### 1.2 Importing data","6e693bef":"# 5. Modeling","3ca280d4":"#### XGBClassifier","293f6283":"# Content\n1. Importing data\n    - 1.1 Importing Python Libraries\n    - 1.2 Importing data\n2. Exploratory Data Analysis (EDA)\n    - 2.1 Categorical features encoding\n    - 2.2 Correlation matrix\n    - 2.3 Features analysis\n3. Scaling and Normalization\n4. Outliers detection\n5. Modeling","d9598e93":"- The median value for age is about 32 years\n- Most of the people in our observations are around 37 years old","bbe4f333":"### 1.1 Importing Python Libraries","81fe8819":"# 3. Outliers detection","cbc4c92a":"    - Outliers appear in many features, such as df.sit_and_bend_forward_cm, df.body_fat, df.broad_jump_cm, df.weight_kg, \n    df.diastolic, df.height_cm, and df.systolic","e9e4a1be":"#### SVC","494ea05a":"- The proportion of men is almost twice that of women","404f98a9":"# 4. Scaling and Normalization"}}