{"cell_type":{"fdef9443":"code","e3452bdc":"code","f51ae572":"code","1bc02619":"code","9e28f059":"code","ccae88de":"code","6964fdea":"code","545f3784":"code","0a6e5633":"code","d145c11a":"code","a7813fb9":"code","94978ba8":"markdown","d0130083":"markdown","62e1a016":"markdown","14211840":"markdown","c02a9107":"markdown","a1ab1f2b":"markdown","ef854a93":"markdown"},"source":{"fdef9443":"# TensorFlow\nimport tensorflow as tf\nimport tensorflow_hub as hub\n\n# Requests\nimport cv2\nimport requests\nimport numpy as np\nimport matplotlib.pyplot as plt","e3452bdc":"ESRGAN_MODEL_PATH = \"https:\/\/tfhub.dev\/captain-pool\/esrgan-tf2\/1\"","f51ae572":"%%time\nmodel = hub.load(ESRGAN_MODEL_PATH)","1bc02619":"def download_image(url):\n    \"\"\"\n    Download image from URL\n    \"\"\"\n    content = requests.get(url).content\n    image_array = np.asarray(bytearray(content), dtype=np.uint8)\n    image = cv2.cvtColor(cv2.imdecode(image_array, -1), cv2.COLOR_BGR2RGB)\n    \n    return image","9e28f059":"def plot_image(image):\n    plt.figure(figsize=(10,10))\n    plt.title(image.shape)\n    plt.imshow(image)\n    plt.show()","ccae88de":"url = \"https:\/\/user-images.githubusercontent.com\/12981474\/40157448-eff91f06-5953-11e8-9a37-f6b5693fa03f.png\"\ntest_image = download_image(url)\nplot_image(test_image)","6964fdea":"def preprocess_image(image):\n    \"\"\"\n    Pre process image for model\n    \"\"\"\n    image_size = (tf.convert_to_tensor(test_image.shape[:-1]) \/\/ 4) * 4\n    cropped_image = tf.image.crop_to_bounding_box(image, 0, 0, image_size[0], image_size[1])\n    new_image = tf.cast(cropped_image, tf.float32)\n    \n    return tf.expand_dims(new_image, 0)","545f3784":"def run(image):\n    \"\"\"\n    Run super resolution model\n    \"\"\"\n    preprocessed_image = preprocess_image(image)\n    new_image = model(preprocessed_image)\n    return tf.squeeze(new_image) \/ 255.0","0a6e5633":"%%time\nfake_image = run(test_image)\nplot_image(fake_image)","d145c11a":"%%time\nurl = \"https:\/\/github.com\/fenghansen\/ESRGAN-Keras\/blob\/master\/images\/inputs\/img_014_SRF_4_LR.png?raw=true\"\ntest_image = download_image(url)\nplot_image(test_image)\nfake_image = run(test_image)\nplot_image(fake_image)","a7813fb9":"%%time\nurl = \"https:\/\/github.com\/fenghansen\/ESRGAN-Keras\/blob\/master\/images\/inputs\/50-(2,2).png?raw=true\"\ntest_image = download_image(url)\nplot_image(test_image)\nfake_image = run(test_image)\nplot_image(fake_image)","94978ba8":"### Settings","d0130083":"### Load model","62e1a016":"# Super Resolution GAN","14211840":"### Run model","c02a9107":"### Load image","a1ab1f2b":"### Test model","ef854a93":"### Pre-process image"}}