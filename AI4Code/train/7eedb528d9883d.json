{"cell_type":{"b75c8635":"code","46370133":"code","0516181f":"code","1d13c009":"code","213ca197":"code","354215a9":"code","1dc39b7c":"code","30b6d244":"code","b5c18623":"code","522409ba":"code","acd461ca":"code","80503c1a":"code","0e6b9561":"code","86d4ca21":"code","f3039571":"code","9a9503cb":"code","89455f3c":"code","0568bd13":"code","2c2c99de":"code","ba8da4d4":"code","e94acdbc":"code","cafe20ce":"code","7c15e983":"code","31f7993d":"code","7ad1b353":"code","d9f81c36":"code","69e8f709":"code","62b27ec9":"code","88a71766":"code","9798cd70":"code","595a2b4e":"code","a8f45f3b":"code","387e5210":"code","3b75f893":"code","d6181ba7":"code","df59b574":"code","7cc4fdca":"code","50275576":"code","9bb0a0f7":"code","a70d74df":"code","170a40c8":"code","41f4b2ab":"code","96c9f928":"markdown","9dd8387a":"markdown"},"source":{"b75c8635":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","46370133":"import tensorflow as tf\nimport nltk\nfrom sklearn.manifold import TSNE\nfrom nltk.corpus import gutenberg\nfrom nltk.corpus import stopwords\nfrom nltk.tokenize import sent_tokenize\nfrom gensim.models import Word2Vec","0516181f":"nltk.download('punkt')","1d13c009":"nltk.download('gutenberg')","213ca197":"len(gutenberg.fileids())","354215a9":"gutenberg.fileids()","1dc39b7c":"gberg_sent_tokens = sent_tokenize(gutenberg.raw())\ngberg_sent_tokens[0:5]","30b6d244":"gberg_sent_tokens[1]","b5c18623":"nltk.word_tokenize(gberg_sent_tokens[1])","522409ba":"nltk.word_tokenize(gberg_sent_tokens[1])[14]","acd461ca":"# a convenient method that handles newlines, as well as tokenizing sentences and words in one shot\ngberg_sents = gutenberg.sents()","80503c1a":"gberg_sents[0:5]","0e6b9561":"gberg_sents[4]","86d4ca21":"gberg_sents[4][14]","f3039571":"# another convenient method that we don't immediately need: \ngutenberg.words() ","9a9503cb":"len(gutenberg.words())","89455f3c":"model = Word2Vec(sentences=gberg_sents, size=64, sg=1, window=10, min_count=5, seed=42, workers=8)","0568bd13":"model.save('raw_gutenberg_model.w2v')","2c2c99de":"model = Word2Vec.load('raw_gutenberg_model.w2v')","ba8da4d4":"model['dog']","e94acdbc":"len(model['dog'])","cafe20ce":"model.most_similar('dog') # distance","7c15e983":"model.most_similar('think')","31f7993d":"model.most_similar('day')","7ad1b353":"model.most_similar('father')","d9f81c36":"model.doesnt_match(\"mother father daughter dog\".split())","69e8f709":"model.similarity('father', 'dog')","62b27ec9":"model.most_similar(positive=['father', 'woman'], negative=['man']) ","88a71766":"model.most_similar(positive=['son', 'woman'], negative=['man'])","9798cd70":"model.most_similar(positive=['husband', 'woman'], negative=['man']) ","595a2b4e":"model.most_similar(positive=['king', 'woman'], negative=['man'], topn=30) ","a8f45f3b":"model.wv.vocab","387e5210":"len(model.wv.vocab)","3b75f893":"X = model[model.wv.vocab]","d6181ba7":"tsne = TSNE(n_components=2, n_iter=1000) # 200 is minimum iter; default is 1000","df59b574":"X_2d = tsne.fit_transform(X)","7cc4fdca":"X_2d[0:5]","50275576":"coords_df = pd.DataFrame(X_2d, columns=['x','y'])\ncoords_df['token'] = model.wv.vocab.keys()","9bb0a0f7":"coords_df.head()","a70d74df":"coords_df.to_csv('raw_gutenberg_tsne.csv', index=False)","170a40c8":"coords_df = pd.read_csv('raw_gutenberg_tsne.csv')","41f4b2ab":"_ = coords_df.plot.scatter('x', 'y', figsize=(12,12), marker='.', s=10, alpha=0.2)","96c9f928":"# Reduce word vector dimensionality with t-SNE","9dd8387a":"# Tokenize text\n"}}