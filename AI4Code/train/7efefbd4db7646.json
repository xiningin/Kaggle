{"cell_type":{"5b2a6951":"code","2605691b":"code","100ff4e9":"code","cd766298":"code","023ebef8":"code","99c51c38":"code","6f55e8f8":"code","3e9d89f3":"code","3c31d895":"code","a5881677":"code","12f72aa8":"code","50396323":"code","990b8cc9":"code","b5c2625b":"code","5a3ba5cf":"code","b9df0d79":"code","75094084":"code","37320dec":"code","968c9c57":"code","6322e1d9":"code","9b1bbf73":"code","3e689155":"code","ac418a24":"markdown"},"source":{"5b2a6951":"import pandas as pd","2605691b":"cab_df = pd.read_csv(\"..\/input\/cab_rides.csv\")#,encoding = \"utf-16\")\nweather_df = pd.read_csv(\"..\/input\/weather.csv\")#,encoding = \"utf-16\")","100ff4e9":"cab_df.head()","cd766298":"weather_df.head()","023ebef8":"cab_df['date_time'] = pd.to_datetime(cab_df['time_stamp']\/1000, unit='s')\nweather_df['date_time'] = pd.to_datetime(weather_df['time_stamp'], unit='s')\ncab_df.head()","99c51c38":"weather_df.head()","6f55e8f8":"#merge the datasets to refelect same time for a location\ncab_df['merge_date'] = cab_df.source.astype(str) +\" - \"+ cab_df.date_time.dt.date.astype(\"str\") +\" - \"+ cab_df.date_time.dt.hour.astype(\"str\")\nweather_df['merge_date'] = weather_df.location.astype(str) +\" - \"+ weather_df.date_time.dt.date.astype(\"str\") +\" - \"+ weather_df.date_time.dt.hour.astype(\"str\")","3e9d89f3":"weather_df.index = weather_df['merge_date']","3c31d895":"cab_df.head()","a5881677":"merged_df = cab_df.join(weather_df,on=['merge_date'],rsuffix ='_w')\nprint(merged_df.shape)","12f72aa8":"merged_df['rain'].fillna(0,inplace=True)","50396323":"merged_df = merged_df[pd.notnull(merged_df['date_time_w'])]\nprint(merged_df.shape)","990b8cc9":"merged_df = merged_df[pd.notnull(merged_df['price'])]\nprint(merged_df.shape)","b5c2625b":"merged_df['day'] = merged_df.date_time.dt.dayofweek","5a3ba5cf":"merged_df['hour'] = merged_df.date_time.dt.hour","b9df0d79":"merged_df['day'].describe()","75094084":"merged_df.columns","37320dec":"merged_df.count()","968c9c57":"merged_df[\"price_div_distance\"] = merged_df[\"price\"].div(merged_df[\"distance\"])","6322e1d9":"merged_df","9b1bbf73":"merged_df = merged_df.drop([\"id\",\"merge_date\",\"date_time\",\"merge_date_w\",\"time_stamp_w\"]).drop_duplicates().sample(frac=1)","3e689155":"merged_df.to_csv(\"-uber-lyft-ride-prices.csv.gz\",index=False,compression=\"gzip\")","ac418a24":"<a href=\"https:\/\/colab.research.google.com\/github\/ravi72munde\/scala-spark-cab-rides-predictions\/blob\/Ravi\/Cab_Price_Prediction.ipynb\" target=\"_parent\"><img src=\"https:\/\/colab.research.google.com\/assets\/colab-badge.svg\" alt=\"Open In Colab\"\/><\/a>"}}