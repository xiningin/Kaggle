{"cell_type":{"1741f9a6":"code","c4db1d5c":"code","461d0da1":"code","1fc3c748":"code","b3271a1a":"code","ecaf96e1":"code","30503410":"code","fdab9318":"code","8cc84974":"code","a7654339":"code","7b202cfc":"markdown","d5e468f7":"markdown","65dd9567":"markdown","a30f0473":"markdown","207ecc11":"markdown","7dbc5663":"markdown","cc286a96":"markdown","356012c9":"markdown","8d9cd32e":"markdown","af93be20":"markdown"},"source":{"1741f9a6":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.graph_objects as go\nfrom plotly.offline import plot\nimport datetime\n\npd.options.mode.chained_assignment = None\ndf = pd.read_csv('\/kaggle\/input\/earthquake-database\/database.csv')","c4db1d5c":"fig, ax = plt.subplots(figsize=(15,5))\nsns.heatmap(df.isnull(), ax=ax)\nplt.grid()\nplt.show()","461d0da1":"l = df['Date'].str.len()\nprint(l.value_counts())\nind = np.where([l == 24])[1]\nprint('Indices with corrupted data:', ind)","1fc3c748":"df1 = df.loc[ind]\ndf1['DateTime'] = pd.to_datetime(df1['Date']).dt.tz_convert(None)","b3271a1a":"df = df.drop(ind)\ndf['Date'] = pd.to_datetime(df['Date'])\ndf['Time'] = pd.to_datetime(df['Time']).dt.time\ndf['DateTime'] = [datetime.datetime.combine(a, b) for a, b in zip(df['Date'], df['Time'])]","ecaf96e1":"df = pd.concat([df, df1])\ndf = df.drop(['Date', 'Time'], axis=1)\nprint(df['DateTime'])","30503410":"fig, ax = plt.subplots(figsize=(20,5))\nsns.countplot(ax=ax, x=df['DateTime'].dt.year)\nplt.show()","fdab9318":"sns.pairplot(data=df)\nplt.show()","8cc84974":"import configparser\nconfig = configparser.ConfigParser()\nconfig = config.read('config.ini')\nmapbox_token = 'pk.eyJ1IjoiY2xhdWNvdCIsImEiOiJja2h4MTIxd2UwMzNzMnlvNzVycXN2dW14In0.J_KSzOY3YGDzozRdHvMJgQ'\n\nfig = go.Figure(\n    go.Scattermapbox(\n        lat=df['Latitude'],\n        lon=df['Longitude'],\n        mode='markers',\n        marker = go.scattermapbox.Marker(\n            size=df['Magnitude'],\n            colorscale='IceFire',\n            color=df['Magnitude'],\n            showscale=True,\n            colorbar={'title': 'Magnitude', 'titleside': 'top', 'thickness': 4, 'ticksuffix': ''},\n        ),\n            customdata=np.stack(\n                (pd.Series(df.DateTime.dt.year),\n                 df['Magnitude'],\n                 df['Depth']),\n                axis=-1\n                ),\n            hovertemplate=\"\"\"\n                <extra><\/extra>\n                <em>%{customdata[0]}  <\/em><br>\n                Magnitude  %{customdata[1]}<br>\n                Depth  %{customdata[2]}<br>\n                \"\"\",\n\n    )\n)\n\n# Specify layout information\nfig.update_layout(\n    mapbox=dict(\n        accesstoken=mapbox_token, #\n        center=go.layout.mapbox.Center(lat=25, lon=142),\n        zoom=1\n    )\n)","a7654339":"df['Y'] = df['DateTime'].dt.year\ndf['M'] = df['DateTime'].dt.month\ndf = df.set_index(['Y', 'M'])\nindex_list = df.index.levels[0].tolist()\n\nframes=[{\n        'name': 'frame_{}'.format(i),\n\n        'data': [{\n            'type': 'scattermapbox',\n            'lat': df.xs(i)['Latitude'],\n            'lon': df.xs(i)['Longitude'],\n            'marker': go.scattermapbox.Marker(\n                size=df.xs(i)['Magnitude']+(df.xs(i)['Magnitude']-4)**3,\n                color=df.xs(i)['Magnitude'],\n                showscale=True,\n                colorscale='IceFire',\n                colorbar={'title': 'Magnitude', 'titleside': 'top', 'thickness': 4, 'ticksuffix': ' Mgn'}\n                ),\n        'customdata': np.stack((\n            df.xs(i)['Magnitude'],\n            df.xs(i)['Depth'],\n            pd.Series(df.xs(i).index)),\n                axis=-1\n                ),\n        'hovertemplate': \"<extra><\/extra><em> Magnitude  %{customdata[0]}<br>Depth  %{customdata[1]}\",\n        }],\n    } for i in index_list]\n\nsliders = [{\n            'transition':{'duration': 0},\n            'x':0.08,\n            'len':0.88,\n            'currentvalue':{'font':{'size':15}, 'prefix':'\ud83d\udcc5 ', 'visible':True, 'xanchor':'center'},\n            'steps':[\n                {\n                    'label':i,\n                    'method':'animate',\n                    'args':[\n                        ['frame_{}'.format(i)],\n                        {'mode':'immediate', 'frame':{'duration':1000, 'redraw': True}, 'transition':{'duration':500, }}\n                      ],\n                } for i in index_list]\n        }]\n\nplay_button = [{\n        'type':'buttons',\n        'showactive':True,\n        'x':0.045, 'y':-0.08,\n        'buttons':[{\n            'label':'\ud83c\udfac', # Play\n            'method':'animate',\n            'args':[\n                None,\n                {\n                    'frame':{'duration':1000, 'redraw':True},\n                    'transition':{'duration':500},\n                    'fromcurrent':True,\n                    'mode':'immediate',\n                }\n            ]\n        }]\n    }]\n\n# Defining the initial state\ndata = frames[0]['data']\n\n# Adding all sliders and play button to the layout\nlayout = go.Layout(\n    sliders=sliders,\n    updatemenus=play_button,\n    mapbox={\n        'accesstoken':'pk.eyJ1IjoiY2xhdWNvdCIsImEiOiJja2h4MTIxd2UwMzNzMnlvNzVycXN2dW14In0.J_KSzOY3YGDzozRdHvMJgQ',\n        'center':{\"lat\": 25, \"lon\": 142},\n        'zoom':1,\n        'style':'light',\n    }\n)\n\n# Creating the figure\nfig = go.Figure(data=data, layout=layout, frames=frames)\n\n# Display the figure\nfig.show()","7b202cfc":"Static map figure - total earthquakes","d5e468f7":"concat df and df1 an drop 2 columns and check dtype: datetime64[ns]","65dd9567":"isolate Date length = 24 to df1 and convert it","a30f0473":"Animated figure - framed per year and play button","207ecc11":"Pair ploting","7dbc5663":"Check for incomplete data","cc286a96":"Check for some wrong format date data based on lenght","356012c9":"convert the date time in df without df1, create a new column based on Date and Time","8d9cd32e":"Read the csv file","af93be20":"visualise DateTime per year"}}