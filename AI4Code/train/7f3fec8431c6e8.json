{"cell_type":{"a34b9f18":"code","4056f5eb":"code","9a4b0a99":"code","cc770eab":"code","17674266":"code","49c72b1a":"code","ac69f702":"code","2068e968":"code","947225b8":"code","34f38000":"code","072529e0":"code","8fb016cc":"code","c19594a3":"code","e8b7143b":"code","c2a600fa":"code","4db0b88f":"code","898bd6ab":"code","2294206c":"code","160e2f6b":"code","ba550533":"code","92bbe388":"code","d7db1d5e":"code","8ae541f8":"code","a58016d9":"code","6fe2245c":"code","53379ef2":"code","196b3cb6":"code","0b2e3057":"code","6c254a2d":"code","e54f5f81":"code","a0537922":"code","ab849b43":"code","e2b7e2e3":"markdown","0b355eb0":"markdown","29f13a3e":"markdown","a633ad11":"markdown","c4bc4c61":"markdown","8a0df0f3":"markdown","741039e7":"markdown","ba111a6d":"markdown","e972d022":"markdown","bdfe1bea":"markdown","57eee9a9":"markdown","0f1956cf":"markdown","5690be67":"markdown","5c20a043":"markdown","d131f1df":"markdown","d990afdb":"markdown","25da416d":"markdown","f25e53e3":"markdown","1427e811":"markdown","3c181267":"markdown","f58706b4":"markdown","da46a049":"markdown","cf7bc524":"markdown","4766c98b":"markdown","f58fa6ca":"markdown","b0402592":"markdown","fdcaad5f":"markdown"},"source":{"a34b9f18":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nimport pylab as plt\nimport altair as alt\nalt.renderers.enable('html')\n\ndf = pd.read_csv(\"..\/input\/ibm-hr-analytics-attrition-dataset\/WA_Fn-UseC_-HR-Employee-Attrition.csv\")\ndf.to_csv('WA_Fn-UseC_-HR-Employee-Attrition-copy.csv')","4056f5eb":"df.head()","9a4b0a99":"df.describe().T","cc770eab":"df.describe(include=['object'])","17674266":"df.drop(['EmployeeCount', 'EmployeeNumber', 'Over18', 'StandardHours'], axis=\"columns\", inplace=True)","49c72b1a":"#Attrition count|\nattrition_count = df['Attrition'].value_counts()\nprint(attrition_count)\n\n#ploting the Attrition Count\nplt.pie(attrition_count,labels=['No','Yes']);","ac69f702":"#Employee that attrited\nemp_attrited = pd.DataFrame(df[df['Attrition'] == 'Yes'])\nemp_not_attrited = pd.DataFrame(df[df['Attrition'] == 'No'])\nprint(emp_attrited.shape)\nprint(emp_not_attrited.shape)","2068e968":"\natt_dep = emp_attrited['Department'].value_counts()\npercentage_att_dep = ((att_dep\/237)*100).round(2)\ntable1 = pd.DataFrame(percentage_att_dep)\nnot_att_dep = emp_not_attrited['Department'].value_counts()\npercentage_not_att_dep = ((not_att_dep\/1233)*100).round(2)\ntable2 = pd.DataFrame(percentage_not_att_dep)\ntable = table1.join(table2, lsuffix = '-Attrition=Yes', rsuffix = '-Attrition=No', how = 'outer')\n\nprint(table)","947225b8":"#Hypothesis1: Based on Department\n\ngroup = (df.groupby(['Attrition'])\n         ['Department'].value_counts(normalize=True).mul(100).round(2)\n         .reset_index(name='Percentage')\n        )\n\nfig = plt.figure(figsize=(15,5))\nsns.barplot(data=group, x='Department', y='Percentage', hue='Attrition', palette = \"rocket_r\");\nplt.tight_layout()","34f38000":"#Factors\ndep_cols = df[['PercentSalaryHike', 'TrainingTimesLastYear', 'Education', 'TotalWorkingYears']]\nfor items in dep_cols: \n    plt.figure(figsize=(10,5))\n    sns.barplot(x = \"Department\", y = items, hue = \"Attrition\", data = df, palette = \"Blues_r\", ci=None)\n    plt.legend(bbox_to_anchor=(1,1), title=\"Attrition\")\n    plt.tight_layout()\n\n","072529e0":"#Bar to find relationshp between Education and Trainng Time\nclick=alt.selection_multi(encodings=['color'])\n\nbar=alt.Chart(df).mark_area(opacity=0.5).encode(\n    x='Education',\n    y='average(TrainingTimesLastYear)',\n    color=alt.Color('Department:N', legend=None),\n    column='Attrition').transform_filter(click)\n\nlegend = alt.Chart(df).mark_point().encode(\ny='Department',\ncolor=alt.condition(click,'Department',alt.value('lightgray'),legend=None)\n).properties(selection=click)\n\nbar|legend","8fb016cc":"#Heatmap to find realtionship between Salary Hike and Experience\n\nclick=alt.selection_multi(encodings=['color'])\n\nbar=alt.Chart(df).mark_point().encode(\n    x=alt.X('PercentSalaryHike', bin=False),\n    y=alt.Y('average(TotalWorkingYears)', bin=False),\n    color=alt.Color('Department:N', legend=None),\n    column='Attrition').transform_filter(click)\n\nlegend = alt.Chart(df).mark_point().encode(\ny='Department',\ncolor=alt.condition(click,'Department',alt.value('lightgray'),legend=None)\n).properties(selection=click)\n\nbar|legend","c19594a3":"att_jr = emp_attrited['JobRole'].value_counts()\npercentage_att_jr = ((att_jr\/237)*100).round(2)\ntable1 = pd.DataFrame(percentage_att_jr)\nnot_att_jr = emp_not_attrited['JobRole'].value_counts()\npercentage_not_att_jr = ((not_att_jr\/1233)*100).round(2)\ntable2 = pd.DataFrame(percentage_not_att_jr)\ntable = table1.join(table2, lsuffix = '-Attrition=Yes', rsuffix = '-Attrition=No', how = 'outer')\n\nprint(table)","e8b7143b":"#Based on JobRole\n\n\ngroup = (df.groupby(['Attrition'])\n         ['JobRole'].value_counts(sort = False, normalize=True).mul(100).round(2)\n         .reset_index(name='Percentage')\n        )\n\nfig = plt.figure(figsize=(15,5))\nsns.barplot(data=group, x='JobRole', y='Percentage', hue='Attrition', palette = \"rocket_r\");\nplt.tight_layout()\n\n","c2a600fa":"#Internal Aspect\njobrole_cols_internal = df[['MonthlyIncome', 'JobInvolvement', 'JobSatisfaction', \n                            'PerformanceRating', 'JobLevel']]\n\nfor items in jobrole_cols_internal:\n    plt.figure(figsize=(15,5))\n    sns.barplot(x = \"JobRole\", y = items, hue = \"Attrition\", data = df, palette = \"Blues\", ci=None);  \n    plt.legend(bbox_to_anchor=(1,1), title=\"Attrition\")\n    plt.tight_layout()\n","4db0b88f":"#Performance Rating and Monthly Income\nclick = alt.selection_multi(encodings=['color'])\n\nchart=alt.Chart(df).mark_bar().encode(\n    x='average(MonthlyIncome)',\n    y='PerformanceRating:N',\n    color=alt.Color('JobRole', legend=None),\n    column=('Attrition')\n).transform_filter(click)\n\nlegend = alt.Chart(df).mark_point().encode(\n    y='JobRole',\n    color=alt.condition(click, 'JobRole',alt.value('lightgray'), legend=None)\n).properties(selection=click)\n\nchart|legend","898bd6ab":"click = alt.selection_multi(encodings=['color'])\n\nchart=alt.Chart(df).mark_bar().encode(\n    x='average(JobLevel)',\n    y='PerformanceRating:O',\n    color=alt.Color('JobRole:N', legend=None),\n    column=('Attrition')\n).transform_filter(click)\n\nlegend = alt.Chart(df).mark_point().encode(\n    y='JobRole',\n    color=alt.condition(click, 'JobRole',alt.value('lightgray'), legend=None)\n).properties(selection=click)\n\nchart|legend","2294206c":"#Work Aspect External Factor\n\njobrole_cols_internal = df[['RelationshipSatisfaction', 'YearsSinceLastPromotion',\n                            'YearsWithCurrManager', 'YearsInCurrentRole', 'EnvironmentSatisfaction', 'Age']]\n\nfor items in jobrole_cols_internal:\n    plt.figure(figsize=(15,5))\n    sns.barplot(x = \"JobRole\", y = items, hue = \"Attrition\", data = df, palette = \"Blues\", ci=None);\n    plt.legend(bbox_to_anchor=(1,1), title=\"Attrition\")\n    plt.tight_layout()\n","160e2f6b":"click = alt.selection_multi(encodings=['color'])\n\nchart=alt.Chart(df).mark_line().encode(\n    x='YearsSinceLastPromotion',\n    y='average(Age)',\n    color=alt.Color('JobRole', legend=None),\n    column=('Attrition')\n).transform_filter(click)\n\nlegend = alt.Chart(df).mark_point().encode(\n    y='JobRole',\n    color=alt.condition(click, 'JobRole',alt.value('lightgray'), legend=None)\n).properties(selection=click)\n\nchart|legend\n\n#Manager, Manufacturing Director, ","ba550533":"#Personal Aspect\n\npersonal_cols = df[['WorkLifeBalance','DistanceFromHome', 'StockOptionLevel']]\n\nfor items in personal_cols:\n    plt.figure(figsize=(15,5))\n    sns.barplot(x = \"JobRole\", y = items, hue = \"Attrition\", data = df, palette = \"Blues\", ci=None);\n    plt.legend(bbox_to_anchor=(1,1), title=\"Attrition\")\n    plt.tight_layout()\n","92bbe388":"#Other Factors\ncols = df[['BusinessTravel', 'MaritalStatus', 'OverTime']]\n\nfor items in cols:\n  group = (df.groupby(['Attrition'])\n         [items].value_counts(normalize=True).mul(100).round(2)\n         .reset_index(name='Percentage')\n        )\n\n  fig = plt.figure(figsize=(15,5))\n  sns.barplot(data=group, x=items, y='Percentage', hue='Attrition', palette = \"rocket_r\");\n\n  att = emp_attrited[items].value_counts()\n  percentage_att = ((att\/237)*100).round(2)\n  table1 = pd.DataFrame(percentage_att)\n  not_att = emp_not_attrited[items].value_counts()\n  percentage_not_att = ((not_att\/1233)*100).round(2)\n  table2 = pd.DataFrame(percentage_not_att)\n  table = table1.join(table2, lsuffix = '-Attrition=Yes', rsuffix = '-Attrition=No', how = 'outer')\n\n  print(table)\n  plt.tight_layout()\n  \n  \n  ","d7db1d5e":"#Correlation Matrix\nfig = plt.figure(figsize=(20,20))\nsns.heatmap(df.corr(), annot = True, fmt = '.0%', vmin=-0.5, vmax=1, center= 0);","8ae541f8":"#Correlation Matrix for Attrited\nfig = plt.figure(figsize=(20,20))\nsns.heatmap(emp_attrited.corr(), annot = True, fmt = '.0%', vmin=-0.5, vmax=1, center= 0);","a58016d9":"#Transform the data \n#Converting Categorical to number type\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import  LabelEncoder\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score, confusion_matrix, precision_score, recall_score, f1_score\n\ndf1 = ('WA_Fn-UseC_-HR-Employee-Attrition.csv')\nfor column in df.columns:\n  if df[column].dtype == np.number:\n    continue \n  df[column] = LabelEncoder().fit_transform(df[column])\n\n","6fe2245c":"#Checking Missing Values \nmissing_values = df.isnull().sum()\nmissing_values\n","53379ef2":"#Create new Column \ndf['Age Years'] = df['Age']\n#Dropping the Age Column\ndf = df.drop('Age', axis = 1)\n","196b3cb6":"df.head()","0b2e3057":"X = df.iloc[:, 1:df.shape[1]].values\ny = df.iloc[:, 0].values\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)","6c254a2d":"def print_model(model, X_train, X_test, y_train, y_test, train = True):\n  if train:\n    prediction = model.predict(X_train)\n    print(\"TRAINING SCORE\\n\")\n\n    print(f\"ACCURACY SCORE : {accuracy_score(y_train, prediction) * 100:.2f}%\")\n    print(f\"PERCISION SCORE : {precision_score(y_train, prediction) * 100:.2f}%\")\n    print(f\"F1 SCORE : {f1_score(y_train, prediction) * 100:.2f}%\")\n    print(f\"RECALL SCORE : {recall_score(y_train, prediction) * 100:.2f}%\")\n    print(f\"CONFUSION MATRIX :\\n {confusion_matrix(y_train, prediction)}\")\n\n  elif train == False:\n    prediction = model.predict(X_test)\n    print(\"\\nTESTING SCORE\\n\")\n\n    print(f\"ACCURACY SCORE : {accuracy_score(y_test, prediction) * 100:.2f}%\")\n    print(f\"PERCISION SCORE : {precision_score(y_test, prediction) * 100:.2f}%\")\n    print(f\"F1 SCORE : {f1_score(y_test, prediction) * 100:.2f}%\")\n    print(f\"RECALL SCORE : {recall_score(y_test, prediction) * 100:.2f}%\")\n    print(f\"CONFUSION MATRIX :\\n {confusion_matrix(y_test, prediction)}\")\n","e54f5f81":"\nrd_forest = RandomForestClassifier(n_estimators = 10, criterion='entropy', random_state = 0)\nrd_forest.fit(X_train, y_train)\n\nprint_model(rd_forest, X_train, X_test, y_train, y_test, train = True)\nprint_model(rd_forest, X_train, X_test, y_train, y_test, train = False)\n\n","a0537922":"from xgboost import XGBClassifier\n\nxgb_clf = XGBClassifier()\nxgb_clf.fit(X_train, y_train)\n\nprint_model(rd_forest, X_train, X_test, y_train, y_test, train = True)\nprint_model(rd_forest, X_train, X_test, y_train, y_test, train = False)","ab849b43":"from sklearn.linear_model import LogisticRegression\n\nlr_clf = LogisticRegression(solver='liblinear', penalty='l1')\nlr_clf.fit(X_train, y_train)\n\n\nprint_model(lr_clf, X_train, X_test, y_train, y_test, train = True)\nprint_model(lr_clf, X_train, X_test, y_train, y_test, train = False)","e2b7e2e3":"**Relationship between Performance Rating and Monthly Income**\n\n***NOTE:*** Click on the legend to view each Job Role","0b355eb0":"\nA Pie Chart to show the number of emoloyee attrited to number of employee not attrited","29f13a3e":"# XGBoost ","a633ad11":"**Inference**\n\n* Research Director have higher bars for every aspect which is analyzed below.","c4bc4c61":"**Inference** \n\n* The Total Working Years and Training Times Last Year are comparatively less for employees who are attrited. \n\n* Is Salary Hike releated to Work Experience?.\n\n* Does Education has a relationship with Training Time?\n\n\n\n","8a0df0f3":"The work aspect is analyzed using 2 different factors:\n\n* Internal Factors: Factors which led to attrition due issues with the job role. (MonthlyIncome, JobInvolvement, JobSatisfaction, PerformanceRating, JobLevel).\n\n* External Factors: Factors which led to attrition when the employee is not satisfied with environment. (RelationshipSatisfaction, YearsSinceLastPromotion, YearsWithCurrManager, YearsInCurrentRole, EnvironmentSatisfaction, Age).","741039e7":"**Inference**\n\nWe can understand that Research Directors and Sales Executives who are attrited were of higher Job Level and paid better. \n","ba111a6d":"#Better Aspect \n\nFactors \n","e972d022":"**Years Since Last Promotion and Age**\n\n***NOTE:*** Click on legend to view each Job Role","bdfe1bea":"**CONCLUSION**\n\n* From the above graphs we can conclude that Research Directors and Sales Executives who even after being paid well and higher Job Level had attrited were dissatisfied with their Job. \n\n* Research Direcctors average age would be aroud 50 as mean of the line is closer to 50. This would suggest that Research Directors might have retired and left rather being dissatisfied.\n\n* While for other Job Role factors like Perfromance Rating, Job Level, Promotion and other internal and External Factors were lesser than the ones who stayed.\n\n\n---\n\n\n\n---\n\n","57eee9a9":"# Random Forest ","0f1956cf":"# Other Factors\n\nThe other factors the employee's issues releated to his personal life.\n\n","5690be67":"**Relationship between Job Level and Performance Rating**\n\n***NOTE:*** Click on the legend to view each Job Role.","5c20a043":"**Internal Aspects**","d131f1df":"**CONCLUSION**\n\nIt can be noted that the the employees from the above departments who attrited were less experienced and had lesser education. \n\n\n\n---\n\n\n\n---\n\n","d990afdb":"# Applying Machine Learning","25da416d":"**Inference**\n\n* Employees with higher ediucation are who were attrited were trained frequently when compared to the others. \n* The ones who were attrited were less expericed and their salaray hike was higher when compared to the ones who are not attrited. ","f25e53e3":"**Relationship between Education and Training Time**\n\n***NOTE:*** Click on the legend to view individual Department\n\n\n","1427e811":"# Attrition due to Work Aspect based on Job Role\n\nA visualization is done to show how people are attrited based on Jobe Role.","3c181267":"**External Aspect**","f58706b4":"# Logistic Regression","da46a049":"**Inference**\n\n\n* It can be inferred that employees who are Single left the Job.\n* Employees who were doing overtime attrited. \n* The ones who left the Job traveled more frequently. \n* People who had Stock in the company stayed.\n* The ones who left the job had to travel more for work. \n\n","cf7bc524":"# HR Analytics Employee Attrition\n\nQ. What is Attrition?\nA. Staff attrition refers to the loss of employees through a natural process, such as retirement, resignation, elimination of a position, personal health, or other similar reasons. With attrition, an employer will not fill the vacancy left by the former employee.\n\n# Business Questions \n\nWe would look into why Employee Attrition happend.\n\n1. Better Prospects\n2. Worklife and Work Stress \n3. Personal Issues ","4766c98b":"From the above graph, it can be noted that employees from Sales have higher rate of attrition when compared to other Departments. ","f58fa6ca":"**Relatinship between Salary Hike and Experience**\n\n***NOTE:*** Click on the legend to view individual Department","b0402592":"**Inference**\n\n* The Job Involvement for the ones who left is lower than for the ones who stayed. \n\n* The employees who are attrited were not satisfied with their job.\n\n* How Performance Rating play any role in the Income?\n\n* Does Performance Rating has any relatonship with the Job Level?","fdcaad5f":"#**Attrition for Better Aspect based upon Department** \n\nA visualization is done to show how people are attrited on basis of their Department."}}