{"cell_type":{"a086fff4":"code","0a87ec9c":"code","f5bd5d8f":"code","36e94a54":"code","23605a75":"code","380b4d4e":"code","d60a0931":"code","abe88148":"code","07736e04":"code","a9a00aaa":"code","40555836":"code","f43e5875":"code","e7824428":"code","44ef460a":"code","260af40e":"code","451d37ca":"code","864a6d35":"code","565f1497":"code","f2efa985":"code","866ee493":"code","9c43b9d5":"code","a0f89678":"code","74d6cd21":"code","61760ddf":"code","fdca20d1":"code","a29fa1df":"code","93516bfb":"code","0d0d9fd8":"code","ac420a28":"code","bbf02d2d":"code","22e825c0":"code","057f46fd":"code","6502fe8d":"code","eea95cfb":"code","e3fa07e7":"code","b04fe9ca":"code","cbe4124a":"code","454faf1d":"code","d2b67997":"code","4641ea34":"code","924629ac":"code","24eb9130":"code","e70cb854":"code","8d988ed0":"code","c4478d99":"code","c031b057":"code","644f8dd8":"code","3269203c":"code","71f09f58":"code","c2942f17":"code","a3829ac4":"code","7b92a485":"code","7a6dd365":"code","aae6fa40":"code","79be49f9":"code","3a5b25f6":"code","189a8e17":"code","fae305f7":"code","54f13d78":"code","148293f7":"code","b9f84def":"code","7430c286":"code","11357c32":"code","7ba1a4d1":"code","573b1dd9":"code","dea4e0af":"code","1a296714":"code","3a4e4137":"code","4e1a64b3":"code","9e9f1fca":"code","e303fdb9":"code","2fd33548":"code","bfb52df6":"code","80f9ef86":"code","40640b41":"code","9c1665ba":"markdown"},"source":{"a086fff4":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","0a87ec9c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\n","f5bd5d8f":"df=pd.read_csv(\"..\/input\/WA_Fn-UseC_-Telco-Customer-Churn.csv\")","36e94a54":"df.head()","23605a75":"df.shape","380b4d4e":"df.info()","d60a0931":"df.describe()","abe88148":"df.describe(include=['object', 'bool'])","07736e04":"df.Contract.value_counts()","a9a00aaa":"df.Churn.value_counts()","40555836":"df.Dependents.value_counts()","f43e5875":"df.Churn.value_counts(normalize=True)","e7824428":"df.dtypes","44ef460a":"#I am changing Churn to 1 and 0 for analysis purpose\ndf['Churn']=df['Churn'].replace('No',0)\ndf['Churn']=df['Churn'].replace('Yes',1)","260af40e":"#I am changing Seniorcitizon as yes or no\ndf['SeniorCitizen']=df['SeniorCitizen'].replace(1,'Yes')\ndf['SeniorCitizen']=df['SeniorCitizen'].replace(0,'No')","451d37ca":"# Here Totalcharges actually is integer but it showing object so i converted into integer\ndf['TotalCharges'] = df['TotalCharges'].replace(r'\\s+', np.nan, regex=True)\ndf['TotalCharges'] = pd.to_numeric(df['TotalCharges'])","864a6d35":"df.head()\npd.set_option('display.max_columns', None)","565f1497":"df.head()","f2efa985":"df.shape","866ee493":"\ndf.isnull().sum()","9c43b9d5":"#Defining categorical variables\ncategorical_features=df.select_dtypes(include=[object])","a0f89678":"categorical_features.columns","74d6cd21":"# Removing unwanted coloumns\ndf.drop(['customerID'],axis=1,inplace=True)","61760ddf":"df.TotalCharges.isnull().sum()","fdca20d1":"df['TotalCharges']=df['TotalCharges'].fillna(df['TotalCharges'].median())","a29fa1df":"df.TotalCharges.isnull().sum()","93516bfb":"df.dtypes","0d0d9fd8":"## below are manually done encoding","ac420a28":"df['gender']=df['gender'].replace('Male',1)\ndf['gender']=df['gender'].replace('Female',0)","bbf02d2d":"df['Partner']=df['Partner'].replace('No',0)\ndf['Partner']=df['Partner'].replace('Yes',1)","22e825c0":"df['Dependents']=df['Churn'].replace('No',0)\ndf['Dependents']=df['Dependents'].replace('Yes',1)","057f46fd":"df['SeniorCitizen']=df['SeniorCitizen'].replace('No',0)\ndf['SeniorCitizen']=df['SeniorCitizen'].replace('Yes',1)","6502fe8d":"df['PhoneService']=df['PhoneService'].replace('No',0)\ndf['PhoneService']=df['PhoneService'].replace('Yes',1)","eea95cfb":"df.head()","e3fa07e7":"df.dtypes","b04fe9ca":"### One Hot Encoding by ceating dummies","cbe4124a":"from sklearn.preprocessing import OneHotEncoder","454faf1d":"oe=OneHotEncoder()","d2b67997":"final_df=pd.get_dummies(columns=['MultipleLines','InternetService','OnlineSecurity','OnlineBackup','DeviceProtection','TechSupport','StreamingTV','StreamingMovies','Contract','PaperlessBilling','PaymentMethod'],data=df)","4641ea34":"final_df.head()","924629ac":"final_df.shape","24eb9130":"y=final_df['Churn']","e70cb854":"X=final_df.drop(['Churn'],axis=1)","8d988ed0":"from sklearn.model_selection import train_test_split","c4478d99":"X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=0)","c031b057":"X_train.shape","644f8dd8":"X_test.shape","3269203c":"y_test.shape","71f09f58":"y_train.shape","c2942f17":"X.shape","a3829ac4":"final_df.dtypes","7b92a485":"from sklearn.linear_model import LogisticRegression","7a6dd365":"lr=LogisticRegression()","aae6fa40":"lr.fit(X_train,y_train)","79be49f9":"lr.score(X_train,y_train)","3a5b25f6":"lr_predict=lr.predict(X_test)","189a8e17":"from sklearn.metrics import confusion_matrix","fae305f7":"from sklearn import metrics","54f13d78":"cm=confusion_matrix(y_test,lr_predict)","148293f7":"cm","b9f84def":"metrics.accuracy_score(y_test,lr_predict)","7430c286":"metrics.roc_auc_score(y_test,lr_predict)","11357c32":"metrics.classification_report(y_test,lr_predict)","7ba1a4d1":"metrics.f1_score(y_test,lr_predict)","573b1dd9":"print('Actual:', y_test.values[0:25])\nprint('Predicted:', lr_predict[0:25])","dea4e0af":"from sklearn.ensemble import RandomForestClassifier","1a296714":"rf=RandomForestClassifier(criterion='entropy',n_estimators=1000,max_depth=100,oob_score=True,random_state=42)","3a4e4137":"rf.fit(X_train,y_train)","4e1a64b3":"rf.score(X_train,y_train)","9e9f1fca":"rf_predict=rf.predict(X_test)","e303fdb9":"metrics.confusion_matrix(y_test,rf_predict)","2fd33548":"metrics.accuracy_score(y_test,rf_predict)","bfb52df6":"metrics.f1_score(y_test,rf_predict)","80f9ef86":"import pandas as pd\nfeature_importances1 = pd.DataFrame(rf.feature_importances_,index = X_train.columns,columns=['importance']).sort_values('importance',ascending=False)","40640b41":"feature_importances1","9c1665ba":"Random Forest"}}