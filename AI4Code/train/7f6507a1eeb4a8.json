{"cell_type":{"200da307":"code","68c18bb1":"code","a65d3a67":"code","90dfa33c":"code","3ac7ecd4":"code","966ec304":"code","19c0dcac":"code","588647f9":"code","1d3c348a":"code","98522eab":"code","0adab65f":"code","14db03d8":"code","1c19e112":"code","e457bf86":"code","7cfbfc91":"code","6deeb35c":"code","b5d334d6":"code","cb352a1f":"code","7e03f0f8":"code","5e1f2ddc":"code","b13d3e46":"code","4e04d206":"code","a5600971":"code","75f5f83c":"code","aeea6921":"code","1db7dec2":"code","5681b430":"code","a9f5e6d2":"code","69650c44":"code","7948d9e7":"code","ab9e85d6":"code","7b4d3a26":"code","f4ae5626":"markdown","ece568f3":"markdown","bf730fb8":"markdown","ad7dda52":"markdown","65d66f56":"markdown","1202f573":"markdown","4ceff24d":"markdown","74df7bea":"markdown","06e34ae1":"markdown","51004059":"markdown","55563da6":"markdown","a9b1b789":"markdown","344f7b06":"markdown","183175dc":"markdown","723729f9":"markdown","5828bec8":"markdown"},"source":{"200da307":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras import layers,callbacks\nimport seaborn as sns\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","68c18bb1":"df2c=pd.read_csv('..\/input\/biomechanical-features-of-orthopedic-patients\/column_2C_weka.csv')\ndf3c=pd.read_csv('..\/input\/biomechanical-features-of-orthopedic-patients\/column_3C_weka.csv')","a65d3a67":"print('2C shape: ',df2c.shape,'3C shape: ',df3c.shape)","90dfa33c":"df2c.head()","3ac7ecd4":"df3c.head()","966ec304":"df2c=df2c.rename(columns={'pelvic_tilt numeric':'pelvic_tilt'})","19c0dcac":"df=pd.concat([df2c,df3c],axis=0)","588647f9":"df.shape","1d3c348a":"df.head()","98522eab":"sns.set_style('darkgrid')\nfig,ax=plt.subplots(figsize=(9,4))\nplt.bar(x=df['class'].unique(),height=df['class'].value_counts())\nplt.title('Count of all Classes')","0adab65f":"fig,ax=plt.subplots(figsize=(7,7))\nsns.scatterplot(data=df,x='pelvic_incidence',y='pelvic_tilt',hue='class')\nsns.rugplot(data=df,x='pelvic_incidence',y='pelvic_tilt',hue='class')","14db03d8":"fig,ax=plt.subplots(figsize=(11,6))\nsns.violinplot(y=\"pelvic_incidence\", x=\"class\", data=df)","1c19e112":"sns.displot(data=df,x='pelvic_tilt',aspect=14\/7,hue='class',multiple='stack')","e457bf86":"fig,ax=plt.subplots(figsize=(11,7))\nsns.boxplot(data=df,x='class',y='lumbar_lordosis_angle')","7cfbfc91":"fig,ax=plt.subplots(figsize=(11,6))\nsns.violinplot(y=\"sacral_slope\", x=\"class\", data=df)","6deeb35c":"df.head()","b5d334d6":"df.head()","cb352a1f":"df['class'].unique()","7e03f0f8":"df['class']=df['class'].replace({'Normal':1,'Abnormal':0,'Hernia':0,'Spondylolisthesis':0})","5e1f2ddc":"xtr=df.drop('class',axis=1)\nytr=df['class']","b13d3e46":"from sklearn.preprocessing import StandardScaler as sc\nscc=sc()\nxtr=scc.fit_transform(xtr)","4e04d206":"from sklearn.model_selection import train_test_split","a5600971":"xtr,xte,ytr,yte=train_test_split(xtr,ytr,random_state=108,test_size=0.3)","75f5f83c":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import GridSearchCV","aeea6921":"knn=KNeighborsClassifier() \nparam_grid={'n_neighbors':[4,5,6],\n            'weights':['distance'],\n            'algorithm':['auto','ball_tree','kd_tree','brute'],\n            'leaf_size':[25,23,24],\n            'metric':['manhattan']}\ngrid=GridSearchCV(knn,cv=5,param_grid=param_grid,verbose=1,n_jobs=1)","1db7dec2":"grid.fit(xtr,ytr)","5681b430":"grid.best_params_","a9f5e6d2":"ypred=grid.predict(xte)","69650c44":"from sklearn.metrics import classification_report, confusion_matrix, accuracy_score","7948d9e7":"print(classification_report(yte,ypred))","ab9e85d6":"sns.heatmap(confusion_matrix(yte,ypred),annot=True)","7b4d3a26":"print('Accuracy of model: ',accuracy_score(yte,ypred))","f4ae5626":"## Context\n### The data have been organized in two different but related classification tasks.\n\n#### column3Cweka.csv (file with three class labels)\n\n** The first task consists in classifying patients as belonging to one out of three categories: \n* Normal (100 patients), \n* Disk Hernia (60 patients) or \n* Spondylolisthesis (150 patients).\n\n** For the second task, the categories Disk Hernia and Spondylolisthesis were merged into a single category labelled as 'abnormal'.\nThus, the second task consists in classifying patients as belonging to one out of two categories: \n* Normal (100 patients) or \n* Abnormal (210 patients).","ece568f3":"# Building the ML model\n### **HyperParameter** will be tuned by *GridSearchCV*","bf730fb8":"#### Checking unique values in **Class** column ","ad7dda52":"#### **Pelvic tilt** is considered to have a *normal range* of values between **13** and **\u00b16** degrees.\n#### *Visualizing* this parameter","65d66f56":"# Visualizing relationship between these parameters and Classes involved","1202f573":"##### *Abnormal* class is a mixture of both **Hernia** and **Spondylolisthesis**","4ceff24d":"#### **Pelvic incidence** is considered to have a *normal range* of values between **33 and 85 degrees**.\n#### *Visualizing* this parameter","74df7bea":"## **Time** for some cool *Predictions*","06e34ae1":"### Evaluating the *model*","51004059":"# Importing and exploring datasets","55563da6":"# *97.84%* **Accuracy** achieved","a9b1b789":"#### **sacral_slope** is considered to have a *normal range* of values between **36 degrees** and **50 degrees**.\n#### *Visualizing* this parameter","344f7b06":"#### **lumbar_lordosis_angle** is considered to have a *normal range* of values between **41\u00b111 degrees(Male)** and **46\u00b111 degrees(Female)**.\n#### *Visualizing* this parameter","183175dc":"# **Fitting** the *model*\n#### with **Testing data**(*xte* & *yte*)","723729f9":"#### Preparing the dataset","5828bec8":"# Converting categorical columns to numerical ones"}}