{"cell_type":{"3e094b47":"code","c8b19176":"code","3ce1044c":"code","113757fc":"code","a78c45d5":"code","3b4f21ab":"code","dc551b88":"code","aa98738f":"code","728527d9":"code","7084a742":"code","079a728d":"code","a88967e2":"code","d6213de6":"code","fcd176b0":"code","8eb48153":"code","c17b3970":"code","18254e6f":"code","e3c94631":"code","9b73b31b":"code","cbf53a4a":"code","f00c02bb":"code","d319a230":"markdown","c4779838":"markdown","b4c8f23e":"markdown","621c8033":"markdown","587739f5":"markdown","99f02a90":"markdown","ac2f2b58":"markdown","77de46a3":"markdown"},"source":{"3e094b47":"import numpy as np\nimport pandas as pd\nimport os\nfrom xgboost import XGBClassifier\nfrom tqdm import tqdm\nfrom sklearn.model_selection import train_test_split","c8b19176":"train_df = pd.read_csv('..\/input\/titanic\/train.csv')\ntest_df = pd.read_csv('..\/input\/titanic\/test.csv')\ntrain_df.head()","3ce1044c":"test_df.head()","113757fc":"train_df.shape","a78c45d5":"train_df.corr()","3b4f21ab":"del train_df['PassengerId']\ndel train_df['Name']\ndel train_df['Ticket']\ndel train_df['Cabin']\ntrain_df.head()","dc551b88":"def sex_to_categorical(row):\n    if row.Sex == 'male':\n        return 0\n    else:\n        return 1\n\ndef embark_to_categorical(row):\n    if row.Embarked == 'C':\n        return 0\n    elif row.Embarked == 'Q':\n        return 1\n    else:\n        return 2","aa98738f":"train_df['sex'] = [sex_to_categorical(train_df.loc[i]) for i in tqdm(range(train_df.shape[0]))]\ntrain_df['embarked'] = [embark_to_categorical(train_df.loc[i]) for i in tqdm(range(train_df.shape[0]))]","728527d9":"train_df.head()","7084a742":"del train_df['Sex']\ndel train_df['Embarked']\ntrain_df.head()","079a728d":"X = train_df.drop('Survived',axis=1)\nY = train_df['Survived']\nprint('Train data shape: {}'.format(X.shape))\nprint('Train labels shape: {}'.format(Y.shape))","a88967e2":"x_train, x_val, y_train, y_val = train_test_split(X, Y, test_size = 0.1, random_state=1)\nprint(f'x train shape: {x_train.shape}')\nprint(f'y train shape: {y_train.shape}')\nprint(f'x val shape: {x_val.shape}')\nprint(f'y val shape: {y_val.shape}')","d6213de6":"model_xgb = XGBClassifier(n_estimators = 150000,\n                          learning_rate = 0.001,\n                          tree_method = 'gpu_hist',\n                          gpu_id= 0\n                         )\nmodel_xgb.fit(x_train, y_train,\n              eval_set = [(x_val,y_val)],\n              early_stopping_rounds = 5,\n              verbose = True\n             )","fcd176b0":"test_df.head()","8eb48153":"passenger_id = pd.DataFrame()\npassenger_id['PassengerId'] = test_df['PassengerId']","c17b3970":"test_df['sex'] = [sex_to_categorical(test_df.loc[i]) for i in tqdm(range(test_df.shape[0]))]\ntest_df['embarked'] = [embark_to_categorical(test_df.loc[i]) for i in tqdm(range(test_df.shape[0]))]\ndel test_df['Sex']\ndel test_df['Embarked']\ndel test_df['Cabin']\ndel test_df['Ticket']\ndel test_df['Name']\ndel test_df['PassengerId']\ntest_df.head()","18254e6f":"y_pred = model_xgb.predict(test_df)","e3c94631":"sample_submission = pd.read_csv('..\/input\/titanic\/gender_submission.csv')\nsample_submission.head()","9b73b31b":"result = pd.DataFrame()\nresult['PassengerId'] = passenger_id['PassengerId']\nresult['Survived'] = y_pred\nresult.head()","cbf53a4a":"result.shape","f00c02bb":"result.to_csv('\/kaggle\/working\/submission.csv', index=False)\nprint('Done!!!!')","d319a230":"# Train Data Preprocessing","c4779838":"# Test Data Preprocessing","b4c8f23e":"# Model Training","621c8033":"# Importing Libraries","587739f5":"# Preditions on Test set","99f02a90":"# Generating Data","ac2f2b58":"# Train-Validation Split","77de46a3":"# Submission File "}}