{"cell_type":{"b38c49de":"code","c630c276":"code","6c54a0f7":"code","ec28e090":"code","b53319e5":"code","7f55e7fd":"markdown","e40e6958":"markdown"},"source":{"b38c49de":"import numpy as np\nimport multiprocessing as mp\nfrom PIL import Image\nimport pandas as pd\nfrom tqdm.auto import tqdm","c630c276":"df = pd.read_csv(\"..\/input\/plant-pathology-2021-fgvc8\/train.csv\")","6c54a0f7":"means = list()\nstds = list()\n\ndef worker(args):\n    index, row = args\n    img = (np.array(Image.open(\"..\/input\/plant-pathology-2021-fgvc8\/train_images\/\" + row.image)) \/ 255).reshape(-1, 3)\n    return img.mean(axis=0), img.std(axis=0)\n\nwith mp.Pool() as pool:\n    for m, s in tqdm(pool.imap_unordered(worker, df.iterrows()), total=len(df)):\n        means.append(m)\n        stds.append(s)","ec28e090":"np.vstack(means).mean(axis=0)","b53319e5":"np.vstack(stds).mean(axis=0)","7f55e7fd":"# Mean standard-deviation","e40e6958":"# Mean average per color channel"}}