{"cell_type":{"77443f9d":"code","8acd79da":"code","70dd4119":"code","ec3447f1":"code","469eafcf":"code","db8da0c6":"code","b3fea1b0":"code","1b751632":"code","8a12947a":"code","6bf5e6cc":"code","5b679f33":"code","37df6629":"code","0a566fac":"code","625ded6e":"code","e530edf8":"markdown","d129def3":"markdown","6f720b32":"markdown","4804c672":"markdown","bca3f7e6":"markdown","e4d704de":"markdown","4486e42c":"markdown","008f9448":"markdown","4c6c1e90":"markdown","990e5b9a":"markdown","99513598":"markdown","bd594b8e":"markdown"},"source":{"77443f9d":"import numpy as np\nimport pandas as pd\nimport os\nos.chdir('\/kaggle\/input\/brazilian-ecommerce')\n#os.chdir('.\/input')","8acd79da":"# replace the product categorie names to english\nproducts = pd.read_csv(\"olist_products_dataset.csv\")\nprod_cat_name_tr = pd.read_csv(\"product_category_name_translation.csv\")\nproducts = products.merge(prod_cat_name_tr, on='product_category_name', how='left')\nproducts.drop ('product_category_name', axis=1, inplace=True)","70dd4119":"#load all the tables\no_items = pd.read_csv(\"olist_order_items_dataset.csv\")\norders = pd.read_csv(\"olist_orders_dataset.csv\")\no_reviews = pd.read_csv(\"olist_order_reviews_dataset.csv\")\ngeoloc = pd.read_csv(\"olist_geolocation_dataset.csv\")\nsellers = pd.read_csv(\"olist_sellers_dataset.csv\")\no_payments = pd.read_csv(\"olist_order_payments_dataset.csv\")\ncustomers = pd.read_csv(\"olist_customers_dataset.csv\")","ec3447f1":"# merge all the tables in one dataframe\nolist = orders.merge(o_items, on='order_id', how='left')\nolist = olist.merge(o_payments, on='order_id', how='outer', validate='m:m')\nolist = olist.merge(o_reviews, on='order_id', how='outer')\nolist = olist.merge(products, on='product_id', how='outer')\nolist = olist.merge(customers, on='customer_id', how='outer')\nolist = olist.merge(sellers, on='seller_id', how='outer')","469eafcf":"olist['review_comment_title'] = olist['review_comment_title'].fillna('No title')\nolist['review_comment_message'] = olist['review_comment_message'].fillna('No message')","db8da0c6":"\nbefore_drop = olist.shape[0]\nolist= olist.dropna()\nafter_drop = olist.shape[0]\nprint(f'There is {round(((before_drop-after_drop)\/after_drop)*100,2)}% nan values ')","b3fea1b0":"# convert dates\nolist.info()","1b751632":"\nolist['order_purchase_timestamp'] = pd.to_datetime(olist.order_purchase_timestamp)\nolist['order_approved_at'] = pd.to_datetime(olist.order_approved_at)\nolist['order_delivered_carrier_date'] = pd.to_datetime(olist.order_delivered_carrier_date)\nolist['order_delivered_customer_date'] = pd.to_datetime(olist.order_delivered_customer_date)\nolist['order_estimated_delivery_date'] = pd.to_datetime(olist.order_estimated_delivery_date)\nolist['shipping_limit_date'] = pd.to_datetime(olist.shipping_limit_date)\nolist['review_creation_date'] = pd.to_datetime(olist.review_creation_date)","8a12947a":"olist.info()","6bf5e6cc":"olist.head()","5b679f33":"olist.head()","37df6629":"olist['year'] = olist['order_purchase_timestamp'].dt.year\nolist['month'] = olist['order_purchase_timestamp'].dt.month\n","0a566fac":"df_bmx = olist.groupby('month')['price'].mean().reset_index()","625ded6e":"df_bmx.plot(x = 'month', \n            y=['price'], \n            kind = 'bar', \n            color = ['lightblue', 'red', 'yellow'], \n            fontsize=10)","e530edf8":"## Correction dates","d129def3":"# <a id=\"6\"><\/a><p style=\"background-color:#FFF9ED;font-family:arial;color:#7e17b9;border-style:solid;font-size:100%;text-align:center;border-radius:10px 10px;\">CONCLUSION<\/p>","6f720b32":"# vis per Month","4804c672":"# <a id=\"2\"><\/a><p style=\"background-color:#FFF9ED;font-family:arial;color:#7e17b9;border-style:solid;font-size:100%;text-align:center;border-radius:10px 10px;\">IMPORTING LIBRARIES & LOADING DATA<\/p>","bca3f7e6":"# <a id=\"4\"><\/a><p style=\"background-color:#FFF9ED;font-family:arial;color:#7e17b9;border-style:solid;font-size:100%;text-align:center;border-radius:10px 10px;\">CLEAN DATA<\/p>\n## Default review title and message","e4d704de":"# <a id=\"1\"><\/a><p style=\"background-color:#FFF9ED;font-family:arial;color:#7e17b9;border-style:solid;font-size:100%;text-align:center;border-radius:10px 10px;\">ABOUT DATASET<\/p>","4486e42c":"# <a id=\"3\"><\/a><p style=\"background-color:#FFF9ED;font-family:arial;color:#7e17b9;border-style:solid;font-size:100%;text-align:center;border-radius:10px 10px;\">MERGE TABLES<\/p>\n## All in one","008f9448":"# <p style=\"background-color:#FFF9ED;font-family:arial;color:#7e17b9;border-style:solid;font-size:200%;text-align:center;border-radius:10px 10px;\">Prepare Olist dataset<\/p>\n\n<img src=\"https:\/\/raw.githubusercontent.com\/meafekih\/Preparation-Olist-dataset\/master\/ecommerce-brazil.jpg\">\n\n<h3>\nIn this tiny Notebook, I will collect all tables of Olist dataset in one dataframe, and cleaning the result.\nAll my future studies about Olist dataset, will be starting from the result of this notebook.\n<\/h3>\n\n<a id='top'><\/a>\n<p style=\"background-color:#FFF9ED;font-family:arial;color:#7e17b9;border-style:solid;font-size:100%;text-align:center;border-radius:10px 10px;\">TABLE OF CONTENTS<\/p>\n\n       \n* [1. ABOUT DATASET](#1)\n    \n    \n* [2. IMPORTING LIBRARIES & LOADING DATA](#2)\n \n    \n* [3. MERGE TABLES](#3) \n      \n    \n* [4. CLEAN DATA](#4)\n\n\n* [5. Visualization](#5)\n\n    \n* [6. CONCLUSION](#6)","4c6c1e90":"# <a id=\"5\"><\/a><p style=\"background-color:#FFF9ED;font-family:arial;color:#7e17b9;border-style:solid;font-size:100%;text-align:center;border-radius:10px 10px;\">Visualization<\/p>","990e5b9a":"## Drop nan values","99513598":"## Context\n\n* Brazilian E-Commerce Public Dataset by Olist\n* The dataset has information of 100k orders from 2016 to 2018 made at multiple marketplaces in Brazil.\n\n* This is real commercial data, it has been anonymised.\n\n* This dataset was generously provided by Olist, the largest department store in Brazilian marketplaces. Olist connects small businesses from all over Brazil to channels without hassle and with a single contract. Those merchants are able to sell their products through the Olist Store and ship them directly to the customers using Olist logistics partners. \n\n* After a customer purchases the product from Olist Store a seller gets notified to fulfill that order. Once the customer receives the product, or the estimated delivery date is due, the customer gets a satisfaction survey by email where he can give a note for the purchase experience and write down some comments.\n\n<img src=\"https:\/\/raw.githubusercontent.com\/meafekih\/Preparation-Olist-dataset\/master\/olist.png\">\n\n[MySql Workbenche](https:\/\/raw.githubusercontent.com\/meafekih\/Preparation-Olist-dataset\/master\/schema.mwb)\n","bd594b8e":"## Target\nThis new dataset allows viewing an order from multiple dimensions:\n* order status\n* price\n* payment\n* freight performance to customer location\n* product attributes\n* reviews written by customers\n* Geolocation dataset that relates Brazilian zip codes to lat\/lng coordinates.\n\n# <p style=\"font-family:arial;font-size:100%;text-align:center\">If you read this line you should upvote this notebook :)<\/p>\n<h3>**Good continuation**<\/h3>"}}