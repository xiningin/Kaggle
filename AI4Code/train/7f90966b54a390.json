{"cell_type":{"2d796858":"code","2199dc69":"code","5ffc5cb3":"code","947682a4":"code","f874c314":"code","d6e812bc":"code","9669e52e":"code","99a70e25":"code","bcf776f8":"code","cfef2288":"code","dd73f2a7":"code","84f59f3a":"code","57ba53e6":"code","7863af46":"code","d988bb75":"code","548c3b06":"code","97fa2761":"code","e42e7475":"code","7dd1a303":"code","c76ca4d1":"code","39fc05af":"code","9705100c":"code","0c9e1965":"code","c439ea58":"code","76e54eef":"code","37ca06f1":"code","1ff4655f":"code","e2265d5e":"code","272ffbf4":"code","7bee44c4":"code","feca7c75":"code","671a9568":"code","28eb5bf8":"code","a5159116":"code","f8cff69d":"code","f84e4717":"code","a1435d37":"code","6d6e8716":"code","546fcd6e":"code","76956360":"code","4120f62b":"code","0da7d61b":"code","ff949e52":"code","56c81b17":"code","5a070162":"code","ee97c967":"code","f49461e3":"code","a7762b10":"code","1e763570":"code","fad1ced2":"code","cbc03d2d":"code","f17f7efa":"markdown","9dbe5435":"markdown","caec565c":"markdown","f9374e33":"markdown","a1059491":"markdown","94b7d9d4":"markdown","bc38e40e":"markdown","260ecc0f":"markdown","e173377e":"markdown","417bcdd9":"markdown","65978ca4":"markdown","47f42e43":"markdown","f797e882":"markdown","12ec51bc":"markdown","cd9dafff":"markdown","763127a1":"markdown","9bd9b6ca":"markdown","7b1cc0d0":"markdown","8d1d385d":"markdown","3da8bfac":"markdown","5f877b20":"markdown","ea84f956":"markdown","cb6856b2":"markdown","3ac01da8":"markdown","fcabf175":"markdown","7cecbe78":"markdown","25cde5e0":"markdown","c2768668":"markdown","5d0d2207":"markdown","e1a82443":"markdown","88342b3e":"markdown","b0aa7ea1":"markdown","a633680c":"markdown","b82c89e9":"markdown","9dfc5dc7":"markdown","2eaae01a":"markdown","0ac870ab":"markdown","0d527aea":"markdown","2686f797":"markdown","0fb55ced":"markdown","6667d802":"markdown","9be65a36":"markdown","f34311e6":"markdown","f2c9c3f9":"markdown","87d5b001":"markdown"},"source":{"2d796858":"import pandas as pd #for data manipulation\nimport numpy as np #for mathematical operations\nimport seaborn as sns #for visualization\nfrom plotnine import * #for visualization (based on ggplot library)\nimport warnings\nwarnings.filterwarnings('ignore') #ignore warning message","2199dc69":"from matplotlib import pyplot as plt\n%matplotlib inline","5ffc5cb3":"train=pd.read_csv('..\/input\/workation-price-prediction-challengemachinehack\/Train.csv')\ntest=pd.read_csv('..\/input\/workation-price-prediction-challengemachinehack\/Test.csv')","947682a4":"train.info()","f874c314":"test.info()","d6e812bc":"train.head(2)","9669e52e":"test.head(2)","99a70e25":"train.isnull().sum()","bcf776f8":"test.isnull().sum()","cfef2288":"def iqr(x: [int,float])->[int,float]:\n    \"\"\"Inter_Quartile-Range.\n    \n    with the help of numpy percentile function we can get the 1st and 3rd quartile.\n    Then subtract the 1st quartile value from 3rd quartile.\n    \n    parameters:\n    -----------\n    input: list of numerical values,array\n    return: single nummerical value.\n    \"\"\"\n    q1_x = np.percentile(x, 25, interpolation='midpoint')\n    q3_x = np.percentile(x, 75, interpolation='midpoint')\n    return q3_x - q1_x","dd73f2a7":"def bin_w(x: [int,float])->[int,float]:\n    \"\"\"\n    with help of above iqr function we can get iqr value.\n    Using the iqr value and the following freedman diaconis formula we can get optimal bin width.\n    \n    parametes:\n    ----------\n    input: list of numerical values,array\n    return: single nummerical value.\n    \n    \"\"\"\n    bw=(2 * iqr(x)) \/ np.power(x.shape[0], 1\/3)\n    return bw","84f59f3a":"price_bw=bin_w(train['Per Person Price'])\n(ggplot(train)+geom_histogram(aes(x='Per Person Price'),fill='green',color='yellow',\n                             binwidth=price_bw)+\nlabs(y='',title='Per Person Price Distribution')+\ntheme_seaborn(style='ticks')+\ntheme(figure_size=(8,8),\naxis_ticks=element_blank(),      \nplot_title=element_text(style='normal',size=16,weight='bold'),      \naxis_text=element_text(style='normal',size=14,weight='bold'),\naxis_title=element_text(style='normal',size=14,weight='bold'),\nstrip_text=element_text(style='normal',size=14,weight='bold')))","57ba53e6":"(ggplot(train)+geom_boxplot(aes(x='0',y='Per Person Price'),fill='green',color='red'\n                             )+\nlabs(x='',y='',title='Per Person Price Boxplot')+\ntheme_seaborn(style='ticks')+\ntheme(#figure_size=(8,8),\nplot_title=element_text(style='normal',size=16,weight='bold'),      \naxis_text=element_text(style='normal',size=14,weight='bold'),\naxis_text_x=element_blank(),    \naxis_ticks=element_blank(),    \naxis_title=element_text(style='normal',size=14,weight='bold'),\nstrip_text=element_text(style='normal',size=14,weight='bold')))","7863af46":"print(\"The Median is:\",train['Per Person Price'].median())","d988bb75":"import statistics as st","548c3b06":"print(\"The Mode is:\",st.mode(train['Per Person Price']))","97fa2761":"train['Per Person Price'].describe()","e42e7475":"train['Package Name'].nunique()","7dd1a303":"train['Package Type'].value_counts()","c76ca4d1":"from wordcloud import WordCloud, STOPWORDS\nstopwords=set(STOPWORDS)","39fc05af":"c=1\nfig=plt.figure(figsize=(14, 14))\nfor x in train['Package Type'].unique():\n    wc = WordCloud(background_color=\"white\", max_words=100, stopwords=stopwords,\n                   max_font_size=40, random_state=42).generate(train[train['Package Type']==x]['Package Name'].to_string())  \n   \n    plt.subplot(3,2,c)\n    plt.imshow(wc)\n    plt.title(x,fontsize='24',fontweight='20')\n    plt.axis(\"off\")\n    c+=1\nplt.show() ","9705100c":"(ggplot(train)+geom_violin(aes(x='Package Type',y='Per Person Price',\n                               fill='Package Type'\n                               ))+\n\ngeom_boxplot(aes(x='Package Type',y='Per Person Price'),fill=None,width=0.3)+\nlabs(title='Package Type and Per Person Price')+\ntheme_seaborn(style='ticks')+\ntheme(figure_size=(8,5),\nlegend_position='none',      \nplot_title=element_text(style='normal',size=16,weight='bold'),      \naxis_text=element_text(style='normal',size=14,weight='bold'),    \naxis_ticks=element_blank(),    \naxis_title=element_text(style='normal',size=14,weight='bold'),\nstrip_text=element_text(style='normal',size=14,weight='bold')))","0c9e1965":"train.groupby(['Package Type'],as_index=False).agg({'Per Person Price':['min','median','mean','max']})","c439ea58":"import re #regular expression","76e54eef":"#create function to extract the numbers from 'Itinerary' column and convert it into integer list then retrun the sum of list.\ndef sum_n(x):\n    \"\"\"\n    parameters:\n    ----------- \n    input: object(mixed data types)\n    output: integer\n    \"\"\"\n    if not None:\n        r=[]\n        a=re.findall(r'\\d+',x)#extract the numbers in Itinerary column\n        for i in a:\n            r.append(int(i))#convert string to integer and store it in new list\n    return sum(r)  ","37ca06f1":"#create a new column to store the total days of stay \ntrain[\"total_days_stay\"] = train['Itinerary'].map(sum_n) #using map function to map the created sum_n function ","1ff4655f":"tot_nights=(train.\n            groupby(['Package Type','total_days_stay']).\n        agg({'total_days_stay':['count']}))\n\ntot_nights.columns = ['total']\ntot_nights=tot_nights.sort_values([\"Package Type\",\"total\"], ascending=False).reset_index()\ntot_nights=tot_nights[tot_nights['total']>0]\n\ntot_nights=tot_nights.astype({'total_days_stay':'category'})\n","e2265d5e":"(ggplot(tot_nights)+\n geom_bar(aes(x='total_days_stay',y='total',\n                               fill='total_days_stay'\n                               ),stat='identity')+\nfacet_wrap('Package Type',scales='free',ncol=2)+\n#scale_x_discrete(limits=num_place_package['Package Type'].index) +\nlabs(title='Package Type wise Staying Day Categories')+\ntheme_seaborn(style='ticks')+\ntheme(figure_size=(12,10),\nlegend_position='none', \nsubplots_adjust={'hspace': 0.4,'wspace': 0.4} ,\nplot_title=element_text(style='normal',size=16,weight='bold'),      \naxis_text=element_text(style='normal',size=14,weight='bold'),    \naxis_ticks=element_blank(),    \naxis_title=element_text(style='normal',size=14,weight='bold'),\nstrip_text=element_text(style='normal',size=14,weight='bold')))","272ffbf4":"(ggplot(train.astype({'total_days_stay':'category'}))+geom_boxplot(aes(x='total_days_stay',y='Per Person Price',\n                               fill='total_days_stay'\n                               ))+\nfacet_wrap('Package Type',scales='free',ncol=2)+\n#geom_boxplot(aes(x='Package Type',y='Per Person Price'),fill=None,width=0.3)+\nlabs(title=' Per Person Price Distribution between Package Type and Total Days of Stay')+\ntheme_seaborn(style='ticks')+\ntheme(figure_size=(10,10),\nlegend_position='none',  \nsubplots_adjust={'hspace': 0.4,'wspace': 0.4} ,     \nplot_title=element_text(style='normal',size=16,weight='bold'),      \naxis_text=element_text(style='normal',size=14,weight='bold'),    \naxis_ticks=element_blank(),    \naxis_title=element_text(style='normal',size=14,weight='bold'),\nstrip_text=element_text(style='normal',size=14,weight='bold')))","7bee44c4":"#train[train['Package Type'].isin(['Premium','Standard'])].groupby(['Package Type','total_days_stay']).agg({'Per Person Price':['min','median','max']}).reset_index()\n\ntrain.groupby(['Package Type','total_days_stay'],as_index=False).agg({'Per Person Price':['min','median','max']})","feca7c75":"c=1\nfig=plt.figure(figsize=(20, 20))\nfor x in train['total_days_stay'].sort_values().unique():\n    wc = WordCloud(background_color=\"white\", max_words=1000, stopwords=stopwords,\n                   max_font_size=40, random_state=42).generate(train[train['total_days_stay']==x]['Places Covered'].to_string())  \n    plt.subplot(5,3,c)\n    plt.imshow(wc)\n    plt.title(label=\"{}_Night_Stay\".format(x) ,fontsize='26',fontweight='20')\n    plt.axis(\"off\")\n    c+=1\nplt.show()","671a9568":"#function to count number of  location in each pacakage\ndef count_dest(x):\n    \"\"\"\n    parameter:\n    ----------\n    \n    input:string seperated by delimeter\n    return:total count\n    \"\"\"\n    if not None:\n        l=0 \n        s=x.split(\"|\")\n        l=len(s)\n    return l","28eb5bf8":"train['num_of_places']=train['Places Covered'].map(count_dest) #map count_dest function to column","a5159116":"(ggplot(train.astype({'num_of_places':'category'}))+geom_bar(aes(x='num_of_places',\n                               fill='num_of_places'\n                               ))+\nscale_x_discrete(limits=train['num_of_places'].value_counts().index) +\nlabs(title='Number of Destination Places of Workation Trip')+\ntheme_seaborn(style='ticks')+\ntheme(figure_size=(8,5),\nlegend_position='none',       \nplot_title=element_text(style='normal',size=16,weight='bold'),      \naxis_text=element_text(style='normal',size=14,weight='bold'),    \naxis_ticks=element_blank(),    \naxis_title=element_text(style='normal',size=14,weight='bold'),\nstrip_text=element_text(style='normal',size=14,weight='bold')))","f8cff69d":"train['num_of_places'].value_counts().sort_values(ascending=False)","f84e4717":"num_place_package=(train[['Package Type','num_of_places']].\n                   groupby(['Package Type','num_of_places'])['num_of_places'].\n                   agg({'count'}).reset_index().sort_values(by=['Package Type','count'],ascending=False).\n                   astype({'num_of_places':'category'}))","a1435d37":"(ggplot(num_place_package)+\n geom_bar(aes(x='num_of_places',y='count',\n                               fill='num_of_places'\n                               ),stat='identity')+\nfacet_wrap('Package Type',scales='free',ncol=2)+\n#scale_x_discrete(limits=num_place_package['Package Type'].index) +\nlabs(title='Package Type and its Number of Destination Location')+\ntheme_seaborn(style='ticks')+\ntheme(figure_size=(12,8),\nlegend_position='none', \nsubplots_adjust={'hspace': 0.4,'wspace': 0.4} ,\nplot_title=element_text(style='normal',size=16,weight='bold'),      \naxis_text=element_text(style='normal',size=14,weight='bold'),    \naxis_ticks=element_blank(),    \naxis_title=element_text(style='normal',size=14,weight='bold'),\nstrip_text=element_text(style='normal',size=14,weight='bold')))","6d6e8716":"(ggplot(train.astype({'num_of_places':'category'}))+geom_boxplot(aes(x='num_of_places',y='Per Person Price',\n                               fill='num_of_places'\n                               ))+\nfacet_wrap('Package Type',scales='free',ncol=2)+\n#geom_boxplot(aes(x='Package Type',y='Per Person Price'),fill=None,width=0.3)+\nlabs(title=' Per Person Price Distribution between Package Type and Number of Destinations')+\ntheme_seaborn(style='ticks')+\ntheme(figure_size=(10,10),\nlegend_position='none',  \nsubplots_adjust={'hspace': 0.4,'wspace': 0.4} ,     \nplot_title=element_text(style='normal',size=16,weight='bold'),      \naxis_text=element_text(style='normal',size=14,weight='bold'),    \naxis_ticks=element_blank(),    \naxis_title=element_text(style='normal',size=14,weight='bold'),\nstrip_text=element_text(style='normal',size=14,weight='bold')))","546fcd6e":"(train[['Package Type','num_of_places','Per Person Price']].groupby(['Package Type','num_of_places']).\n agg({'Per Person Price':['min','mean','median','max']}).reset_index())","76956360":"c=1\nfig=plt.figure(figsize=(20,20))\nfor x in train['num_of_places'].sort_values().unique():\n    wc = WordCloud(background_color=\"white\", max_words=1000, stopwords=stopwords,\n                   max_font_size=40, random_state=42).generate(train[train['num_of_places']==x]['Places Covered'].to_string())  \n    plt.subplot(5,2,c)\n    plt.imshow(wc)\n    plt.title(label=\"{}_Location_trip\".format(x) ,fontsize='26',fontweight='20')\n    plt.axis(\"off\")\n    c+=1\nplt.show()","4120f62b":"train['Travel Date']=pd.to_datetime(train['Travel Date'], errors='coerce')","0da7d61b":"(ggplot(train)+geom_line(aes(x='Travel Date',y='Per Person Price' ),color='green')+\nscale_x_datetime(date_labels =\"%b,%Y\")+\nlabs(title='Per Person Price Changes over Time')+\ntheme_seaborn(style='ticks')+\ntheme(figure_size=(15,8),     \nplot_title=element_text(style='normal',size=16,weight='bold'),      \naxis_text=element_text(style='normal',size=13,weight='bold'),    \naxis_ticks=element_blank(),    \naxis_title=element_text(style='normal',size=14,weight='bold'),\nstrip_text=element_text(style='normal',size=14,weight='bold')))","ff949e52":"train['day'],train['day_label'],train['day_number'],train['month_number'],train['month_label'],train['year_quarter'],train['week_of_year'],train['year'] = train['Travel Date'].dt.day,train['Travel Date'].dt.day_name(),train['Travel Date'].dt.dayofweek,train['Travel Date'].dt.month,train['Travel Date'].dt.strftime('%b'),train['Travel Date'].dt.quarter,train['Travel Date'].dt.week, train['Travel Date'].dt.year","56c81b17":"train.head(2)","5a070162":"(ggplot(train)+geom_line(aes(x='Travel Date',y='Per Person Price'),color='green')+\nscale_x_datetime(date_labels =\"%b,%Y\")+\nfacet_wrap('Package Type',scales='free',ncol=1)+\nlabs(title='Package Type Wise Per Person Price Changes over Time')+\ntheme_seaborn(style='ticks')+\ntheme(figure_size=(10,10),\nsubplots_adjust={'hspace': 0.8,'wspace': 0.4} ,     \nplot_title=element_text(style='normal',size=16,weight='bold'),      \naxis_text=element_text(style='normal',size=10,weight='bold'),    \naxis_ticks=element_blank(),    \naxis_title=element_text(style='normal',size=14,weight='bold'),\nstrip_text=element_text(style='normal',size=14,weight='bold')))","ee97c967":"(ggplot(train)+geom_line(aes(x='Travel Date',y='Per Person Price'),color='green')+\nscale_x_datetime(date_labels =\"%b\")+\nfacet_wrap('total_days_stay',scales='free',ncol=2)+\nlabs(title='Per Person Price Changes over Time by Various Category Days of Stay')+\ntheme_seaborn(style='ticks')+\ntheme(figure_size=(15,12),\nsubplots_adjust={'hspace':1,'wspace': 0.2} ,     \nplot_title=element_text(style='normal',size=16,weight='bold'),      \naxis_text=element_text(style='normal',size=10,weight='bold'),    \naxis_ticks=element_blank(),    \naxis_title=element_text(style='normal',size=14,weight='bold'),\nstrip_text=element_text(style='normal',size=14,weight='bold')))","f49461e3":"(ggplot(train)+geom_line(aes(x='Travel Date',y='Per Person Price'),color='green')+\nscale_x_datetime(date_labels =\"%m,%y\")+\nfacet_wrap('num_of_places',scales='free',ncol=2)+\nlabs(title='Per Person Price Changes over Time by Various Category of Destinatio Location Count')+\ntheme_seaborn(style='ticks')+\ntheme(figure_size=(15,12),\nsubplots_adjust={'hspace':1,'wspace': 0.2} ,     \nplot_title=element_text(style='normal',size=16,weight='bold'),      \naxis_text=element_text(style='normal',size=10,weight='bold'),    \naxis_ticks=element_blank(),    \naxis_title=element_text(style='normal',size=14,weight='bold'),\nstrip_text=element_text(style='normal',size=14,weight='bold')))","a7762b10":"!pip install calplot","1e763570":"import calplot","fad1ced2":"price = pd.Series(train['Per Person Price'].values, index=train['Travel Date'])","cbc03d2d":"cal_plot=calplot.calplot(price,edgecolor=\"red\",cmap='twilight',linewidth=5,\n                         yearlabel_kws = {\"fontsize\":\"large\"},\n                        figsize=(40,30))","f17f7efa":"#### The above chart explains that the budget workation trip package has mostly one destination location.\n#### The deluxe, luxury, premium, and standard workation trip package have mostly 1 to 3 destination locations.","9dbe5435":"#### The **Itinerary** column has the destination location name and its number of night stay information.\n\n#### Let's collect those numbers and find a total staying night.","caec565c":"### Let's compare the price distribution between the package type and total days of stay.","f9374e33":"#### In test dataset there are 14 columns and 9000 data entries.","a1059491":"### Import Train and Test Dataset","94b7d9d4":"#### In train dataset there are 15 columns(including target column) and 21000 data entries.\n#### The target columns is **Per Person Price**","bc38e40e":"#### The above summary shows that there is no missing in any column.","260ecc0f":"### Let's create a fuction to find a optimal bin width by using **Freedman Diaconis Rule**","e173377e":"### Let's see how per person price is changing over time.","417bcdd9":"### Let's see is there any change between per person price and number of destinations ","65978ca4":"### Let's analyse relationship between price and pacakge types.","47f42e43":"#### The above wordcloud shows various package names under different types of workation trip package.","f797e882":"#### The above chart explains that the budget workation trip package has more number of three-days stay packages.\n#### The standard, premium, luxury, and deluxe workation trip packages have more number of 3 to 6-days stay packages.","12ec51bc":"### Let's calculate the number of night stay of each packages.","cd9dafff":"### let's see target column(**Per Person Price**) distribution.","763127a1":"### Let structure of the train and test dataset","9bd9b6ca":"#### The above violin plot explains that there is a significant difference between the **package type** and **per person price**.\n#### The minimum per person price difference between luxury and deluxe package margin is too low.","7b1cc0d0":"#### There are 2204 unique workation trip packages.Let's compare the vaious package name with package type by using word cloud.","8d1d385d":"### Let's see package type-wise total days of stay.","3da8bfac":"#### Let' create one function to count the number of destination places.","5f877b20":"#### The above wordcloud explains various most famous destination based on the total days of stay.","ea84f956":"### Let's see the Number of destination wise most popular workation trip location.","cb6856b2":"### let's perform exploratory data analysis and see how the workation destination price has changing based on various factors.","3ac01da8":"#### The above line plot explains how price changes over time based on the package type.","fcabf175":"#### The above chart explains that most of the workation trips will have 1 to 4 destination locations.","7cecbe78":"#### This project is about predicting the workation trip price for a person.\n\n#### The workation trip price will be based on various factors such as destination location, hotels and their amenities, and so on.","25cde5e0":"### Let's view the sample data from train and test dataset","c2768668":"### Let's package type wise per person price changes over time.","5d0d2207":"#### The above summary shows that there is no missing in any column.","e1a82443":"### Let's see the number of locations count by package type.","88342b3e":"### let's see how per person price changes over time by various category of destination location count.","b0aa7ea1":"# Introduction","a633680c":"### Let' see how many workation trip packages are available.","b82c89e9":"#### The above wordcloud explain various popular workation trip location based on the number of destination.","9dfc5dc7":"### Let's check if there is any missing value in train and test dataset.","2eaae01a":"### Let's see how many destinations locations will be covered by each type of packages.","0ac870ab":"#### Let's create a function to find a inter-quartile-range.","0d527aea":"#### The chart explains that the per person workation trip price will increase based on the total days of stay.\n\n#### The premium and Luxury package's 10-night stay trip's per person price is cheaper than the budget package's maximum price.\n","2686f797":"#### The above boxplot explains the various price ranges based on the number of destinations.\n#### The standard package with 11 destinations, that package's minimum, and maximum price is almost in a close range","0fb55ced":"### Import Necessary Packages","6667d802":"### Let's see how per person price changes over time by various category days of stay.","9be65a36":"#### The above histogram explains that per person price distribution is right skewed(mode is less than median).\n#### The boxplot explains that there are some outlier points outside q3.\n#### The mean is 20059.","f34311e6":"### Let's see which destination location is most popular based on categories of total days of stay.","f2c9c3f9":"### Let's use calplot and see how  per person price changes over time.","87d5b001":"### Let's break down the date into month, year, quarter, and so on."}}