{"cell_type":{"30dfd560":"code","0062bd16":"code","0a80bfb2":"code","3d6e3338":"code","e52bccf4":"code","7db4820a":"code","e99a0975":"code","9b2570ca":"code","72d2598f":"code","4ecf585a":"code","cce778b0":"code","d47391d4":"code","8ededb09":"code","d723af8f":"code","80f0c44d":"markdown","ef946ddb":"markdown","4d4e2d01":"markdown"},"source":{"30dfd560":"# Importing Libraries\nimport numpy as np\nimport pandas as pd\nfrom kmodes.kprototypes import KPrototypes\n%matplotlib inline\nimport matplotlib.pyplot as plt\nimport seaborn as sns","0062bd16":"# Reading Dataset\nblood = pd.read_csv('https:\/\/archive.ics.uci.edu\/ml\/machine-learning-databases\/blood-transfusion\/transfusion.data', sep=\",\",engine = 'python')","0a80bfb2":"#Sanity Check\nblood.head()","3d6e3338":"# standardizing data\ncolumns_to_normalize     = ['Recency (months)','Frequency (times)','Monetary (c.c. blood)','Time (months)']\nblood[columns_to_normalize] = blood[columns_to_normalize].apply(lambda x: (x - x.mean()) \/ np.std(x))","e52bccf4":"# Re-check after standardizing data\nblood.head()","7db4820a":"blood_matrix= blood.values\nblood_matrix","e99a0975":"# Running K-Prototype clustering\nkproto = KPrototypes(n_clusters=5, init='Cao')\nclusters = kproto.fit_predict(blood_matrix, categorical=[4])","9b2570ca":"kproto.cluster_centroids_","72d2598f":"# Checking the cost of the clusters created.\nkproto.cost_","4ecf585a":"# Adding the predicted clusters to the main dataset\nblood['cluster_id'] = clusters","cce778b0":"# Re-check\nblood.head()","d47391d4":"# Checking the clusters created\nblooddf = pd.DataFrame(blood['cluster_id'].value_counts())\nblooddf","8ededb09":"plt.figure(figsize=(10,12))\nax=sns.barplot(x=blooddf.index, y=blooddf['cluster_id'])\nfor p in ax.patches:\n    ax.annotate(str(p.get_height()), (p.get_x() * 1.01 , p.get_height() * 1.01))\nplt.show()\n\n","d723af8f":"#Choosing optimal K\ncost = []\ncost = []\nfor cluster in list(range(2,10)):\n    kproto = KPrototypes(n_clusters=cluster, init='Cao')\n    kproto.fit_predict(blood_matrix, categorical=[4])\n    cost.append(kproto.cost_)\nplt.plot(cost);","80f0c44d":"**About Blood Transfusion dataset**<br><br>\nTo demonstrate the RFMTC marketing model (a modified version of RFM), this study adopted the donor database of Blood Transfusion Service Center in Hsin-Chu City in Taiwan. The center passes their blood transfusion service bus to one university in Hsin-Chu City to gather blood donated about every three months. To build a FRMTC model, we selected 748 donors at random from the donor database. These 748 donor data, each one included R (Recency - months since last donation), F (Frequency - total number of donation), M (Monetary - total blood donated in c.c.), T (Time - months since first donation), and a binary variable representing whether he\/she donated blood in March 2007 (1 stand for donating blood; 0 stands for not donating blood).","ef946ddb":"# K-Prototype Clustering","4d4e2d01":"**Attribute Information:**\n\n- R (Recency - months since last donation), \n- F (Frequency - total number of donation), \n- M (Monetary - total blood donated in c.c.), \n- T (Time - months since first donation), and a binary variable representing whether he\/she donated blood in March 2007 (1 stand for donating blood; 0 stands for not donating blood). \n\n- Variable\tData Type\tMeasurement\tDescription\tmin\tmax\tmean\tstd \n- Recency quantitative\tMonths\tInput\t0.03\t74.4\t9.74\t8.07 \n- Frequency quantitative\tTimes\tInput\t1\t50\t5.51\t5.84 \n- Monetary\tquantitative\tc.c. blood\tInput\t250\t12500\t1378.68\t1459.83 \n- Time quantitative\tMonths\tInput\t2.27\t98.3\t34.42\t24.32 \n- Whether he\/she donated blood in March 2007\tbinary\t1=yes 0=no\tOutput\t0\t1\t1 (24%) 0 (76%) "}}