{"cell_type":{"70ec8ab2":"code","55abee25":"code","9d47bb77":"code","1e5b2c61":"code","c2285a30":"code","290ca53a":"code","26afd2b8":"code","d4b979eb":"code","c4c7cb86":"code","6d8c868f":"code","84b08b88":"code","9c637568":"code","61f56d02":"code","aa8583ff":"code","8734f0e5":"code","a703ec19":"code","ea103acc":"code","b1d1438b":"code","6e23c827":"code","c96f47ae":"code","eb9c326e":"code","43ed08b6":"code","de780474":"code","cf8d6798":"code","b83ae545":"markdown","ebe9d070":"markdown","858da255":"markdown","fa9e046a":"markdown","9896af9b":"markdown","daf34237":"markdown","e0efa202":"markdown","0db72b4a":"markdown","f9e33590":"markdown","e7c78961":"markdown","91ed96f7":"markdown","4b2bdce6":"markdown","63afcff6":"markdown","f3a33f33":"markdown","4792bf52":"markdown","280fa2d1":"markdown","d761a607":"markdown"},"source":{"70ec8ab2":"#Importing the libraries\nimport pandas as pd\nimport numpy as np\n\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nfrom plotly.subplots import make_subplots\nimport plotly.graph_objects as go","55abee25":"#Importing the datasets\nurl='https:\/\/raw.githubusercontent.com\/CSSEGISandData\/COVID-19\/master\/csse_covid_19_data\/csse_covid_19_time_series\/time_series_covid19_confirmed_global.csv'\nconfirmed=pd.read_csv(url,error_bad_lines=False)\ndeath=pd.read_csv('https:\/\/raw.githubusercontent.com\/CSSEGISandData\/COVID-19\/master\/csse_covid_19_data\/csse_covid_19_time_series\/time_series_covid19_deaths_global.csv',\n                 error_bad_lines=False)\nrecovered=pd.read_csv('https:\/\/raw.githubusercontent.com\/CSSEGISandData\/COVID-19\/master\/csse_covid_19_data\/csse_covid_19_time_series\/time_series_covid19_recovered_global.csv',\n                 error_bad_lines=False)\n","9d47bb77":"def country_with_cases(dataset):\n    is_province=dataset.loc[dataset['Province\/State'].isna()==False]\n    is_province=is_province['Country\/Region'].unique()\n    df=dataset.copy()\n    Country=df['Country\/Region'].values\n    temp=df.drop(columns=['Province\/State','Country\/Region','Lat','Long'])\n    values=temp.values\n    cases=[]\n    for i in range(0,len(values)):\n        cases.append(values[i][values.shape[1]-1])\n    new_df=pd.concat([pd.DataFrame(Country),pd.DataFrame(cases)],axis=1)\n    new_df.columns=['Country','Cases']\n    index=[]\n    is_province_sums=[]\n    for i in is_province:\n        temp=new_df.loc[new_df['Country']==i]\n        index.append(temp.index)\n        s=np.sum(temp['Cases'])\n        is_province_sums.append(s)\n    for i in index:\n        new_df.drop(i,axis=0,inplace=True)\n    countries_with_province=pd.concat([pd.DataFrame(is_province),pd.DataFrame(is_province_sums)],axis=1)\n    countries_with_province.columns=['Country','Cases']\n    All_country_cases=pd.concat([new_df,countries_with_province],axis=0)\n    All_country_cases.reset_index(inplace=True)\n    return All_country_cases","1e5b2c61":"confirmed_tree=country_with_cases(confirmed)","c2285a30":"def tree_map(df,color_scale,title):\n    #The df is the one which only has country and cases\n    fig = px.treemap(df,path=['Country'], values='Cases',color='Cases',\n                     color_continuous_scale=color_scale,\n                     title=title)\n    fig.show()","290ca53a":"tree_map(confirmed_tree,'amp','Confirmed cases across countries')","26afd2b8":"recovered_tree=country_with_cases(recovered)\ntree_map(recovered_tree,'Greens','Recovery across countries')","d4b979eb":"death_tree=country_with_cases(death)\ntree_map(death_tree,'Reds','Deaths across countries')","c4c7cb86":"def top_10(df):# This function will only work \n    df_descending=df.sort_values(by='Cases', ascending=False)\n    df_descending=df_descending.reset_index()\n    top=df_descending.iloc[:10 :]\n    return top['Country'].values","6d8c868f":"def rate(df):   \n    is_province=df.loc[confirmed['Province\/State'].isna()==False]\n    is_province=is_province['Country\/Region'].unique()\n    copy=df.copy()\n    final=[]\n    index=[]\n    for i in is_province:    \n        temp=copy.loc[copy['Country\/Region']==i]\n        index=copy.loc[copy['Country\/Region']==i].index\n        temp=temp.sum(axis=0)\n        final.append(temp)\n        copy.drop(index,inplace=True)\n    new_df=pd.DataFrame(final)\n    new_df['Country\/Region']=is_province\n    total=pd.concat([copy,new_df],axis=0)\n    total.reset_index(inplace=True)\n    total.drop(columns=['Province\/State'],inplace=True)\n    t=pd.melt(total,id_vars=['Country\/Region','index','Lat','Long'],var_name=\"Date\", value_name=\"Value\")\n    return t","84b08b88":"c=rate(confirmed)\nfig = px.line(c, x=\"Date\", y=\"Value\", color=\"Country\/Region\",\n              title='Confirmed cases across countries')\nfig.update_layout(showlegend=False)\nfig.show()","9c637568":"r=rate(recovered)\nfig = px.line(r, x=\"Date\", y=\"Value\", color=\"Country\/Region\",\n              title='Confirmed cases across countries')\nfig.update_layout(showlegend=False)\n\nfig.show()","61f56d02":"d=rate(death)\nfig = px.line(d, x=\"Date\", y=\"Value\", color=\"Country\/Region\",\n              title='Deaths across countries')\nfig.update_layout(showlegend=False)\n\nfig.show()","aa8583ff":"top_ten=top_10(confirmed_tree)","8734f0e5":"def stacked_line_subplots(confirmed,death,recovered,countries):\n    subplot_title=[]\n    for i in countries:\n        subplot_title.append('Cases in {}'.format(i))\n    subplot_title=tuple(subplot_title)\n    fig = make_subplots(rows=len(countries), cols=1,subplot_titles=subplot_title)\n    #countries=['India','US','Yemen','Angola']\n    dates=confirmed.columns\n    dates=np.delete(dates,[0,2,3])\n    dfs=[confirmed,death,recovered]\n    row=1\n    for i in range(len(countries)):\n        value=[]\n        for j in dfs:\n            temp=j.loc[j['Country\/Region']==countries[i]].values\n            temp=np.delete(temp,[0,1,2,3])\n            value.append(temp)\n        if(i==0):\n            fig.append_trace(go.Scatter(x=dates,y=value[1],mode='lines',name='Death',\n                         line_color='red',stackgroup='covid',legendgroup=\"group1\"),row=row,col=1)\n            fig.append_trace(go.Scatter(x=dates,y=value[2],mode='lines',name='Recovered',\n                         line_color='green',stackgroup='covid',legendgroup=\"group2\"),row=row,col=1)\n            fig.append_trace(go.Scatter(x=dates,y=value[0],mode='lines',name='Confirmed',\n                         line_color='blue',stackgroup='covid',legendgroup=\"group3\"),row=row,col=1)\n        else:\n            fig.append_trace(go.Scatter(x=dates,y=value[1],mode='lines',name='Death',\n                         line_color='red',stackgroup='covid', showlegend=False,\n                                        legendgroup=\"group1\"),row=row,col=1)\n            fig.append_trace(go.Scatter(x=dates,y=value[2],mode='lines',name='Recovered',\n                         line_color='green',stackgroup='covid', showlegend=False,\n                                       legendgroup=\"group2\"),row=row,col=1)\n            fig.append_trace(go.Scatter(x=dates,y=value[0],mode='lines',name='Confirmed',\n                         line_color='blue',stackgroup='covid', showlegend=False,\n                                       legendgroup=\"group3\"),row=row,col=1)\n            \n\n        row+=1\n        \n        fig.update_layout(height=2000, width=800,\n                  title_text=\"Cases across the top 10 countries\")\n            \n    fig.show()\n    ","a703ec19":"stacked_line_subplots(confirmed,death,recovered,top_ten)","ea103acc":"def world_map(df,title,color):\n    dates=df.columns\n    dates=np.delete(dates,[0,2,3])\n    country=df['Country\/Region']\n    lat=df['Lat']\n    long=df['Long']\n    transformed=pd.melt(df,id_vars=['Province\/State','Country\/Region','Lat','Long'],\n                   var_name=\"Date\", value_name=\"Value\")\n    fig = px.scatter_geo(transformed, lat=\"Lat\",lon=\"Long\", color=\"Value\",\n                     hover_name=\"Country\/Region\", size=transformed[\"Value\"],\n                     animation_frame=\"Date\",\n                     projection=\"natural earth\",title=title,\n                     color_continuous_scale=color)\n    fig.show()","b1d1438b":"world_map(confirmed,'Confirmed cases with time series','Jet')","6e23c827":"world_map(recovered,'Recovered cases with time series','YlGn')","c96f47ae":"world_map(death,'Death Cases with time series','Burg')","eb9c326e":"from datetime import date\ndef weekly_trend(df,number):\n    c=rate(df)\n    date_values=c['Date'].values\n    first_date=date_values[0].split('\/')\n    first=list(map(int, first_date))\n    for i in range(len(date_values)):\n        random=date_values[i].split('\/')\n        random=list(map(int, random))\n        delta=date(2020,random[0],random[1])-date(2020,first[0],first[1])\n        date_values[i]=delta.days\n    c['Date']=date_values\n    c['Weeks']=c['Date']\/\/7\n    confirmed_week=c.loc[c['Weeks']==number]\n    confirmed_week=confirmed_week.sort_values(by='Value',ascending=False)    \n    return confirmed_week\n    \n","43ed08b6":"def top_3_trends(week,week_number):\n    last_day=week.loc[week['Date']==((week_number*7)+6)]\n    first_day=week.loc[week['Date']==(week_number*7)]\n    first_day_values=first_day['Value'].values\n    last_day['Value']=last_day['Value']-first_day_values\n    last_day=last_day.sort_values(by='Value',ascending=False)\n    countries=last_day['Country\/Region'].unique()[:3]\n    return countries\n    ","de780474":"def top_3(week,week_number,subject):\n    top_3=top_3_trends(week,week_number)\n    week=week.sort_values(by='Date',ascending=True)\n    \n    subplot_title=[]\n    for i in top_3:\n        subplot_title.append( '{}'.format(i))\n    subplot_title=tuple(subplot_title)\n    fig = make_subplots(rows=1, cols=3,subplot_titles=subplot_title)\n    \n    col=1\n    for i in range(0,3):\n        temp=week.loc[week['Country\/Region']==top_3[i]]\n        temp['Value']-=temp.iloc[0,5]\n        fig.append_trace(go.Scatter(x=temp['Date'],y=temp['Value'],mode='lines',showlegend=False\n                                    ),col=col,row=1)\n        \n        col+=1\n    \n    fig.update_layout(title_text=\"Week {} trends of {} in top 3 countries\".format(week_number,subject))\n            \n    fig.show()\n    \n    ","cf8d6798":"for i in range(1,22):\n    week=weekly_trend(confirmed,i)\n    top_3(week,i,'Confirmed Cases')\n#The same can be done for Recovered and death cases, but the the kernel becomes to long and redundant","b83ae545":"> [](http:\/\/) This kernel will be updated frequently to keep it up to date","ebe9d070":"The rate function converts the structire of the dataframe in general. In the dataset the dates are the column making it not so convenient for visualising the data. This function transforms all the dates into one column and this makes plotting very much easier","858da255":"We will analyse 10 countries with the highest confirmed case","fa9e046a":"# Visuals on the World Map","9896af9b":"This stacked line graph in a way shows the ratio of the cases in a country. The blue area in way indicates the active cases(when both red and green areas are present), green indicates recovered and red indicates the deaths","daf34237":"# Case proportions of countries","e0efa202":"# Library and dataset imports","0db72b4a":"# Weekly analysis on case growth","f9e33590":"In this study, the focus is on the country cases. This analysis examines at the case growth, case proportion and weekly growth.","e7c78961":"The data used for this study is taken from the Johns Hopkins CSSE data repository. The following files were used for the analysis:\n1. time_series_covid19_confirmed_global.csv-> https:\/\/rb.gy\/uktxf3\n2. time_series_covid19_deaths_global.csv   -> https:\/\/rb.gy\/qnjgsj\n3. time_series_covid19_recovered_global.csv-> https:\/\/rb.gy\/dxfjfl","91ed96f7":"The function top_3_trends returns the top 3 countries. These are the countries which have the highest growth in the week","4b2bdce6":"# Visualising the Country growth ","63afcff6":"This function plots the top 3 countries in a subplot","f3a33f33":"The function country_with_cases will return a dataframe with just the country name and the number of cases. This function also adds up all the province value into one to make the overall data just in terms of the Country\/Region. The main reason this is done is because the Province\/State contains a lot of null values","4792bf52":"# Analysing the top 10 countries ","280fa2d1":"# COVID-19 Analysis across  countries and weeks","d761a607":"The function weekly_trend() mainly creates a new column named week. This column indicates the week \nnumber of a particular day. For this, the dates have been converted to days since the first reported day. The function will return the a dataframe of one particular week"}}