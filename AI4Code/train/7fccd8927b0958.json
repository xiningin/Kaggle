{"cell_type":{"ef089754":"code","e1110cbd":"code","471e2e3d":"code","bfa7383c":"code","bc88e80a":"code","18642147":"code","1b533455":"code","1cc56eb3":"code","1abb5a52":"code","b07f94a5":"code","fd811d62":"code","68adcc43":"code","c2dc8f4a":"code","13d23599":"code","3dfd8738":"code","09691528":"code","3611d9ae":"code","04471f5d":"code","8e1eb0fe":"code","d564c026":"code","a952aa35":"code","f6e1a53c":"code","667750a9":"code","40653da3":"code","665d2ad7":"code","8ab6c756":"code","f496bfbb":"code","d0754f6c":"code","a47d84ed":"code","b9d032a2":"code","19adaf38":"code","c10d76fc":"code","39112b7d":"code","b884195b":"code","e1f13d9f":"code","41468138":"code","7993537f":"markdown","6c79a93c":"markdown","52bb2350":"markdown","33aef17b":"markdown","d9a92aeb":"markdown","a9430e7d":"markdown","f15f20bc":"markdown","9f14f42a":"markdown","9630aeb3":"markdown","e5f5330e":"markdown","a997c6be":"markdown","34f39ef1":"markdown","18edbea3":"markdown","e8b11331":"markdown","2ca2fad9":"markdown","7424b1cc":"markdown","55c93a43":"markdown","e38618d6":"markdown","e677b5d7":"markdown","12ddbe35":"markdown"},"source":{"ef089754":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","e1110cbd":"hp=pd.read_csv('\/kaggle\/input\/heart-patients\/US_Heart_Patients.csv')","471e2e3d":"hp.info()","bfa7383c":"hp.isnull().sum()*100\/len(hp)","bc88e80a":"hp.shape","18642147":"hp.drop('education',axis=1,inplace=True)","1b533455":"hp.dropna(subset=['cigsPerDay'],inplace=True)","1cc56eb3":"hp.dropna(subset=['BPMeds'],inplace=True)","1abb5a52":"hp.totChol","b07f94a5":"hp.totChol.fillna(hp.totChol.mean(),inplace=True)","fd811d62":"hp.glucose","68adcc43":"hp.glucose.fillna(hp.glucose.mean(),inplace=True)","c2dc8f4a":"hp.dropna(subset=['heartRate'],inplace=True)","13d23599":"hp.BMI.describe()","3dfd8738":"hp.BMI.fillna(hp.BMI.mean(),inplace=True)","09691528":"hp.isnull().sum()*100\/len(hp)","3611d9ae":"import seaborn as sns\nimport matplotlib.pyplot as  plt","04471f5d":"hp.TenYearCHD.value_counts().plot.barh(grid=True)\nplt.show()","8e1eb0fe":"plt.figure(figsize=(20,8))\nsns.heatmap(hp.corr(),annot=True)\nplt.show()","d564c026":"plt.figure(figsize=(20,8))\nsns.stripplot(data=hp,y='age',x='cigsPerDay',hue='TenYearCHD')\nplt.show()","a952aa35":"sns.scatterplot(data=hp,y='diaBP',x='sysBP',hue='TenYearCHD')\nplt.show()","f6e1a53c":"sns.scatterplot(data=hp,y='diaBP',x='sysBP',hue='prevalentHyp')\nplt.show()","667750a9":"sns.barplot(data=hp,x='diabetes',y='glucose',hue='TenYearCHD')\nplt.show()","40653da3":"sns.barplot(data=hp,x='currentSmoker',y='cigsPerDay',hue='TenYearCHD')\nplt.show()","665d2ad7":"hp.shape","8ab6c756":"bmi=hp['BMI']\ndef cat_BMI(bmi):\n    if float(bmi)<=18.5 :\n        return 'Underweight'\n    elif 18.5<float(bmi)<=25:\n        return 'Normal'\n    elif 25<float(bmi)<=30:\n        return 'Overweight'\n    else:\n        return 'Obese'","f496bfbb":"hp['cat_BMI']=hp['BMI'].apply(cat_BMI)","d0754f6c":"hp['cat_BMI'].value_counts()*100\/len(hp['cat_BMI'])","a47d84ed":"ct_bmi_tychd=pd.crosstab(hp['cat_BMI'],hp['TenYearCHD'])","b9d032a2":"ct_bmi_tychd.plot.bar()\nplt.show()","19adaf38":"from sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score,classification_report\nfrom sklearn.model_selection import train_test_split,GridSearchCV\nfrom sklearn.feature_selection import RFE","c10d76fc":"X=hp.drop(['TenYearCHD','cat_BMI'],axis=1)\ny=hp.TenYearCHD","39112b7d":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)","b884195b":"dtr=DecisionTreeClassifier()\nnp.random.seed(42)\n\nparam_dist = {'criterion':['gini','entropy'],'min_samples_split':[2,3,4],'max_depth':[4,5,6],'min_samples_leaf':[1,2,3]}\n\ncv_dtr = GridSearchCV(dtr, cv = 5,param_grid=param_dist, n_jobs = 3)\n\ncv_dtr.fit(X_train, y_train)\nprint('Best Parameters using grid search: \\n', cv_dtr.best_params_)","e1f13d9f":"dtr=dtr.set_params(criterion= 'gini', max_depth= 4, min_samples_leaf= 1, min_samples_split= 3)","41468138":"dtr_fit=dtr.fit(X_train,y_train)\ndtr_predict=dtr.predict(X_test)\ndtr_train_predict=dtr.predict(X_train)\nprint('accuracy score of train:',accuracy_score(y_train,dtr_train_predict))\nprint('accuracy score of test:',accuracy_score(y_test,dtr_predict))\nprint('classification report:\\n',classification_report(y_test,dtr_predict))","7993537f":" ***15% of total patients(4157) will suffer with heart disease within 10 year of span. ***","6c79a93c":"***Current smoker and smoking 17 or more than 17 cigarettes per day than you would have an heart attack within 10 years.***","52bb2350":"Cigsperday has only 0.62% of missing value so we can drop nan from it.","33aef17b":"Age and CigPerday is not much affecting whether you have an heart attack or not.","d9a92aeb":"# APPLYING ML MODELS\n>> As the target variable is categorical,so applying SLC","a9430e7d":"# EDA","f15f20bc":"## ****Objective****\n* EDA on dataset\n* Building a predictive model\n![heart](https:\/\/2f4izj3opteu3l5obc1sh0bb-wpengine.netdna-ssl.com\/wp-content\/uploads\/sites\/14\/2016\/09\/heartbeat-heart-attack.jpg)","9f14f42a":"DiaBP and sysBP are not much impacting on whether the patient will have heart attack within 10yrs or not.\n> As patients with low diaBP and sysBP are also having a high chance of having heart attack and also patients with high diaBP and sysBP are also having high chance of heart attack.","9630aeb3":"There is high correlation between diaBP and sysBP","e5f5330e":"Diabetic patients have high glucose level as compared to  non diabetic patients.\n>>But glucose level above 150 will lead to an heart attack.","a997c6be":"****Overweight patients are having high chances of getting an heart diease****\n> Overweight falls in between 25 to 30 BMI(Body Mass Index)\n![bmi formula](https:\/\/bmicalculatorusa.com\/wp-content\/uploads\/2018\/10\/body-mass-index-formulas.jpg)","34f39ef1":"splitting into 70:30 train test ","18edbea3":"BP Meds is an categorical value attribute so nan value cannot be filled.","e8b11331":"The above code shows how much value percentage of value missing in the dataset from following attributes.","2ca2fad9":"Glucose can be filled with mean\/average.","7424b1cc":"total cholesterol attribute can be filled with mean\/average.","55c93a43":"Patients with high Blood Pressure and are having diabetes have prevalent Hypertension.\nSimilarly patients with high blood pressure and donot have diabetes also have prevelant Hypertension.\n>>*So high blood pressure can lead to hypertension or vice versa.*","e38618d6":"# MISSING VALUE TREATMENT","e677b5d7":"* ***Approximately 44% of patients are having normal weight***\n* ***Approximately 42% of patients are overweight ***\n* ***Approximately 13% of patients are Obese***\n* ***Only 1% is underweight***","12ddbe35":"Education has no significance to our analysis so dropped it."}}