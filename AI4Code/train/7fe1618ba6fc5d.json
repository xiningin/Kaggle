{"cell_type":{"4ec28095":"code","13e115af":"code","a7bb04b1":"code","d4886a5f":"code","f8a396c8":"code","5d991d42":"code","047d309b":"code","485dab1b":"code","33bd4668":"code","b7acf2e6":"code","5d9ee9ec":"code","7afee5c8":"code","728cab46":"code","2f04a634":"code","e391d0f2":"code","a450d31a":"code","010a6d13":"code","9e23814c":"code","09eb1d52":"code","8f532a35":"code","8c79b8c2":"markdown","93a99367":"markdown"},"source":{"4ec28095":"#Import the Libraries\nimport numpy as np \nimport pandas as pd \n\nimport matplotlib.pyplot as plt\nimport missingno as msno \nimport seaborn as sns\nplt.style.use('seaborn-whitegrid')\n\nfrom sklearn.impute import SimpleImputer\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.preprocessing import LabelEncoder","13e115af":"#Load the Dataset\ndf_movies = pd.read_csv(\"..\/input\/movies-on-netflix-prime-video-hulu-and-disney\/MoviesOnStreamingPlatforms_updated.csv\", index_col=\"ID\")\ndf_movies.head()","a7bb04b1":"#Remove \"Unnamed\" \ndf_movies=df_movies.drop(\"Unnamed: 0\",axis=1)\ndf_movies.head()","d4886a5f":"#Description overview of the data\ndf_movies.info()","f8a396c8":"#Check for total no.of null values in each column \ndf_movies.isna().sum()","5d991d42":"#Removing the Target value\ndf_movies = df_movies[df_movies['IMDb'].notna()]","047d309b":"#Visualizing the amount of missing data\nmsno.bar(df_movies ,color='red', figsize=(10, 4))","485dab1b":"#Dropping \"Rotten Tomatoes\" for its excessively low data \ndf_movies = df_movies.drop(['Rotten Tomatoes'], axis=1)\n\n#\"Title\" and \"Type\" are dropped as it is irrelevant for our prediction.\ndf_movies = df_movies.drop(['Title','Type'], axis=1)\ndf_movies.isna().sum()","33bd4668":"#Checking unique values in \"Age\" \ndf_movies['Age'].unique()","b7acf2e6":"#Imputing null values in \"Age\" with \"all\"\nimputer = SimpleImputer(missing_values=np.nan, strategy='constant', fill_value=\"all\")\ndf_movies[\"Age\"] = imputer.fit_transform(df_movies[[\"Age\"]]).ravel()\n\ndf_movies.isna().sum()","5d9ee9ec":"#Dropping all the rows(entries) where there are celss with no data \ndf_movies.dropna(axis=0, how='any',inplace=True)\n\ndf_movies.isna().sum()","7afee5c8":"#Visualizing if there is anymore missing data or not\nmsno.bar(df_movies ,color='red', figsize=(10, 4))","728cab46":"df_movies.info()","2f04a634":"# Choose target and features\ny = df_movies.IMDb\n\nX = df_movies.drop(['IMDb'], axis=1)\n\n#Split the data for train and test\nX_train_full, X_test_full, y_train, y_test  = train_test_split(X, y,random_state = 0)\n\n#List of Categorical colunmns to be used as features\ncat_cols=[\"Age\",\"Directors\",\"Genres\",\"Country\",\"Language\"]\n\n#List of Numerical colunmns to be used as features\nnumerical_cols = ['Year','Runtime']\n\n#Keep selected columns only\nmy_cols = numerical_cols + cat_cols \nX_train = X_train_full[my_cols].copy()\nX_test = X_test_full[my_cols].copy()","e391d0f2":"#Viewing Test data\nX_train.head()","a450d31a":"#Viewing Test data\nX_test.head()","010a6d13":"#Copying the data to prevent change in original datset\nlabel_X_train = X_train.copy()\nlabel_X_test = X_test.copy()\n\n# Apply label encoder to each column with categorical data\nlabel_encoder = LabelEncoder()\nfor col in cat_cols:\n    label_encoder.fit(pd.concat([label_X_train[col], label_X_test[col]], axis=0, sort=False))\n    label_X_train[col] = label_encoder.transform(label_X_train[col])\n    label_X_test[col] = label_encoder.transform(label_X_test[col])","9e23814c":"# Define the models\nmodel_1 = RandomForestRegressor(n_estimators=50, random_state=1)\nmodel_2 = RandomForestRegressor(n_estimators=100, random_state=1)\nmodel_3 = RandomForestRegressor(n_estimators=100, criterion='mae', random_state=1)\nmodel_4 = RandomForestRegressor(n_estimators=200, min_samples_split=20, random_state=1)\nmodel_5 = RandomForestRegressor(n_estimators=100, max_depth=7, random_state=1)\n\n#List of models\nmodels = [model_1, model_2, model_3, model_4, model_5]","09eb1d52":"# Function for comparing different models\ndef score_model(model, X_t=label_X_train, X_v=label_X_test, y_t=y_train, y_v=y_test):\n    model.fit(X_t, y_t)\n    preds = model.predict(X_v)\n    return mean_absolute_error(y_v, preds)\n\nmae_scores=[]\n\nfor i in range(0, len(models)):\n    mae = score_model(models[i])\n    print(\"Model %d MAE: %f\" % (i+1, mae))\n    mae_scores.append(mae)","8f532a35":"best_score=min(mae_scores)\nbest_score","8c79b8c2":"## Github Link of this Project can be found at \n### https:\/\/github.com\/diptaraj23\/IMDb-Rating-Prediction-","93a99367":"# IMDb Rating Prediction from a data set of Movies"}}