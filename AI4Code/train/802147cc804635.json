{"cell_type":{"5e3f2234":"code","31485227":"code","22826358":"code","b24c38e1":"code","a251b3a4":"code","967bddc0":"code","94697a22":"code","b53ce5d3":"code","504de83a":"code","ebcafb72":"code","cc80d12e":"code","4cc90c70":"code","168be862":"code","b8392119":"code","d9ffcba1":"code","eee2cacc":"code","082e8d41":"code","e57d57f4":"code","2ccdd0bc":"code","e1fb2448":"code","1d3b23ee":"code","e485b014":"code","618dc134":"code","9141d23c":"code","353eb025":"code","4035979d":"code","503c04a3":"markdown","ad00edbc":"markdown","b6e68d4a":"markdown","97f72e1b":"markdown","e2447ce4":"markdown","ff71dee5":"markdown","610d8bdf":"markdown","b5882de8":"markdown","f1d4e714":"markdown","d782677a":"markdown","accb4aab":"markdown","98a0e89a":"markdown","01a781f3":"markdown","5223a16b":"markdown","1035e535":"markdown","0769a2f3":"markdown","22f93212":"markdown","e79621eb":"markdown"},"source":{"5e3f2234":"import matplotlib.pyplot as plt\nimport seaborn as sns\nimport missingno as msno\nimport numpy as np \nimport pandas as pd","31485227":"df = pd.read_csv('..\/input\/australian-fatal-car-accident-data-19892021\/Crash_Data.csv', low_memory=False)\ndf.head()","22826358":"msno.matrix(df)\nplt.show()","b24c38e1":"df.columns","a251b3a4":"df = df.drop(columns=df.columns[df.isnull().sum() \/ len(df) > 0.1])","967bddc0":"# remove 2021 data (atm this year hasn't ended yet)\ndf = df[df['Year'] < 2021]","94697a22":"def spines(ax,yl='share',xl='year'):\n    x1 = ax.spines['right'].set_visible(False)\n    x2 = ax.spines['top'].set_visible(False)\n    x3 = ax.spines['left'].set_linewidth(2)\n    x4 = ax.spines['bottom'].set_linewidth(2)\n    x5 = ax.set_ylabel(yl)\n    x6 = ax.set_xlabel(xl)\n    return x1, x2, x3, x4, x5, x6","b53ce5d3":"fig, ax = plt.subplots(figsize=(16,8))\ndf.groupby('Year')['Crash ID'].count().plot.bar()\nspines(ax,yl='Number of deaths')\nplt.show()","504de83a":"df['Age Group'].value_counts()","ebcafb72":"age_groups = df['Age Group'].value_counts().sort_index().index.tolist()\n\nfig, ax = plt.subplots(figsize=(16,18))\nfig.suptitle('Share of deaths for each age group', y=0.93)\nn = 0 \nfor group in age_groups:\n    n+=1\n    for_plot = df[df['Age Group'] == group].groupby('Year')['Crash ID'].count() \/ df.groupby('Year')['Crash ID'].count()\n    ax = plt.subplot(320+n)\n    plt.bar(for_plot.index, for_plot.values)\n    plt.title(group)\n    plt.ylim(0.02,0.35)\n    spines(ax)\nplt.show()","cc80d12e":"fig, ax = plt.subplots(figsize=(16,16))\nax = plt.subplot(221)\nmale_plot = df[(df['Gender']=='Male') & (df['Age Group']=='17_to_25') ].groupby('Year')['Crash ID'].count() \/ df.groupby('Year')['Crash ID'].count()\nmale_plot.plot.bar(title='Males 17 to 25')\nspines(ax,yl='Share of deaths')\nax = plt.subplot(222)\nfemale_plot = df[(df['Gender']=='Female') & (df['Age Group']=='17_to_25') ].groupby('Year')['Crash ID'].count() \/ df.groupby('Year')['Crash ID'].count()\nfemale_plot.plot.bar( align='edge', color='r', title='Females 17 to 25')\nspines(ax,yl='Share of deaths')\n\nax = plt.subplot(223)\nmale_plot = df[(df['Gender']=='Male') & (df['Age Group']=='40_to_64') ].groupby('Year')['Crash ID'].count() \/ df.groupby('Year')['Crash ID'].count()\nmale_plot.plot.bar(title='Males 40 to 64')\nspines(ax,yl='Share of deaths')\nax = plt.subplot(224)\nfemale_plot = df[(df['Gender']=='Female') & (df['Age Group']=='40_to_64') ].groupby('Year')['Crash ID'].count() \/ df.groupby('Year')['Crash ID'].count()\nfemale_plot.plot.bar( align='edge', color='r', title='Females 40 to 64')\n# plt.ylim(female_plot.min(), male_plot.max())\nspines(ax,yl='Share of deaths')\nplt.show()","4cc90c70":"time_groups = df['Time of day'].value_counts().sort_index().index.tolist()\n\nfig, ax = plt.subplots(figsize=(16,8))\nn = 0 \nfor group in time_groups:\n    n+=1\n    for_plot = df[df['Time of day'] == group].groupby('Year')['Crash ID'].count() \/ df.groupby('Year')['Crash ID'].count()\n    plt.plot(for_plot.index, for_plot.values, label=group)\n    plt.title('Night \/ day share of deaths')\n\n    plt.legend()\n    spines(ax)\nplt.show()","168be862":"day_groups = df['Day of week'].value_counts().sort_index().index.tolist()\n\nfig, ax = plt.subplots(figsize=(16,6))\nfig.suptitle('Share of deaths for day type')\nn = 0 \nfor group in day_groups:\n    n+=1\n    for_plot = df[df['Day of week'] == group].groupby('Year')['Crash ID'].count() \/ df.groupby('Year')['Crash ID'].count()\n    ax = plt.subplot(120+n)\n    plt.scatter(for_plot.index, for_plot.values)\n    plt.title(group)\n#     plt.ylim(0.02,0.35)\n    spines(ax)\nplt.show()","b8392119":"df['Time'] = pd.to_datetime(df['Time'])\ndf['Time'] = df['Time'].dt.strftime('%H')","d9ffcba1":"fig, ax = plt.subplots(figsize=(16,8))\ndf[df['Year'] < 1999].groupby('Time')['Crash ID'].count().plot.bar(label='90ties', align = 'center', width=0.25)\ndf[df['Year'] > 2010].groupby('Time')['Crash ID'].count().plot.bar(label='2010 onwards', align='edge', color='r', width=0.25)\nplt.title('Number of deaths per hour of day')\nplt.legend()\nspines(ax, xl='time of day', yl='number of deaths')\nplt.show()","eee2cacc":"fig, ax = plt.subplots(figsize=(16,8))\ndf[df['Year'] < 2000].groupby('Time')['Crash ID'].count().plot.kde(label='90ties', linewidth=4)\ndf[df['Year'] >= 2010].groupby('Time')['Crash ID'].count().plot.kde(label='2010 and later', linewidth=4)\nplt.legend()\nax.axes.xaxis.set_ticks([])\nax.axes.yaxis.set_ticks([])\nspines(ax, xl='', yl='')\nplt.title('Kernel density plot')\nplt.show()","082e8d41":"df = df[~df['Speed Limit'].isnull()]\ndf.loc[df['Speed Limit'] == '<40','Speed Limit'] = 40\ndf = df[~(df['Speed Limit'] == 'Unspecified')]\ndf['Speed Limit'] = df['Speed Limit'].astype(int)\ndf['Speed Limit group'] = np.digitize(df['Speed Limit'], bins=[60, 80,100, 140])\nd = {3:'130',2:'100',1:'80', 0:'60'}\ndf = df.replace({'Speed Limit group': d})","e57d57f4":"speed_groups = df['Speed Limit group'].value_counts().sort_index()[:6].index.tolist()\n\nfig, ax = plt.subplots(figsize=(16,16))\nfig.suptitle('Number of deaths per speed limit group', y=0.93)\nn = 0 \nfor group in speed_groups:\n    n+=1\n    for_plot = df[df['Speed Limit group'] == group].groupby('Year')['Crash ID'].count() \n    ax = plt.subplot(320+n)\n    plt.scatter(for_plot.index, for_plot.values)\n    plt.title('speed limit up to '+group)\n#     plt.ylim(0,0.55)\n    spines(ax, yl='Number of deaths')\nplt.show()\n","2ccdd0bc":"fig, ax = plt.subplots(figsize=(16,12))\ndf['State'].value_counts().plot.pie()\nplt.title('Share of deaths per state')\nplt.show()","e1fb2448":"locations = df['State'].value_counts().sort_values(ascending=False)[:4].index.tolist()\n\nfig, ax = plt.subplots(figsize=(16,14))\nfig.suptitle('Number of deaths in each state', y=0.93)\nn = 0 \nfor group in locations:\n    n+=1\n    for_plot = df[df['State'] == group].groupby('Year')['Crash ID'].count() \n    ax = plt.subplot(220+n)\n    plt.scatter(for_plot.index, for_plot.values)\n    plt.title(group)\n    plt.ylim(100,1000)\n    spines(ax, yl='Number of deaths')\nplt.show()\n","1d3b23ee":"locations = df.loc[df['Age Group']=='17_to_25', 'State'].value_counts().sort_values(ascending=False).index[:4].tolist()\n\nfig, ax = plt.subplots(figsize=(16,14))\nfig.suptitle('Share of deaths in each state in the 17-25 age group', y=0.93)\nn = 0 \nfor group in locations:\n    n+=1\n    for_plot = df[(df['Age Group']=='17_to_25')&(df['State'] == group)].groupby('Year')['Crash ID'].count() \/ df[df['Age Group']=='17_to_25'].groupby('Year')['Crash ID'].count()\n    ax = plt.subplot(220+n)\n    plt.scatter(for_plot.index, for_plot.values)\n    plt.title(group)\n    plt.ylim(0,0.4)\n    spines(ax)\nplt.show()\n","e485b014":"locations = df.loc[df['Age Group']=='40_to_64', 'State'].value_counts().sort_values(ascending=False).index[:4].tolist()\n\nfig, ax = plt.subplots(figsize=(16,12))\nfig.suptitle('Number of deaths in each state in the 40-64 age group', y=0.93)\n\nn = 0 \nfor group in locations:\n    n+=1\n    for_plot = df[(df['Age Group']=='40_to_64')&(df['State'] == group)].groupby('Year')['Crash ID'].count() \n    ax = plt.subplot(220+n)\n    plt.scatter(for_plot.index, for_plot.values)\n    plt.title(group)\n#     plt.ylim(0,0.6)\n    spines(ax, yl='Number of deaths')\nplt.show()\n","618dc134":"fig, ax = plt.subplots(figsize=(16,12))\nmale_plot = df[(df['Gender']=='Male') & (df['Age Group']=='40_to_64')  & (df['State']=='WA')].groupby('Year')['Crash ID'].count() \/ df.groupby('Year')['Crash ID'].count()\nmale_plot.plot.bar(title='WA males aged 40-64')\nspines(ax,yl='Share of deaths')\nplt.show()","9141d23c":"df['Road User'].value_counts()","353eb025":"df = df[~(df['Road User'] == 'Other\/-9')]\nusers = df['Road User'].value_counts().sort_values(ascending=False).index.tolist()\n\nfig, ax = plt.subplots(figsize=(16,18))\nfig.suptitle('Share of deaths for each road user', y=0.93)\nfig.subplots_adjust(hspace=0.3, wspace=0.15)\nn = 0 \nfor group in users:\n    n+=1\n    for_plot = df[df['Road User'] == group].groupby('Year')['Crash ID'].count()  \/ df.groupby('Year')['Crash ID'].count()\n    ax = plt.subplot(320+n)\n    plt.scatter(for_plot.index, for_plot.values)\n    plt.title(group)\n#     plt.ylim(0.0,0.39)\n    spines(ax, yl='Share of deaths')\nplt.show()\n","4035979d":"speeds = df.loc[df['Speed Limit group']=='60', 'Road User'].value_counts().sort_values(ascending=False).index.tolist()\n\nfig, ax = plt.subplots(figsize=(16,16))\nfig.subplots_adjust(hspace=0.3, wspace=0.15)\nfig.suptitle('Road users share of deaths in speed limit zones under 60', y=0.93)\nn = 0 \nfor group in speeds:\n    n+=1\n    for_plot = df[(df['Speed Limit group']=='60')&(df['Road User'] == group)].groupby('Year')['Crash ID'].count() \/ df.groupby('Year')['Crash ID'].count()\n    ax = plt.subplot(320+n)\n    plt.scatter(for_plot.index, for_plot.values)\n    plt.title(group)\n#     plt.ylim(0,0.6)\n    spines(ax)\nplt.show()\n","503c04a3":"# Road users","ad00edbc":"## That is the group that we should be addressing, their share of road deaths quadrupled in the last 30 years.","b6e68d4a":"Road deaths are becoming more concentrated around a single time of the day in modern times.\n* weekday, daytime around 3 o'clock has become a really dangerous time to be on the roads.\n* on a positive side lets not forget it's still safer, than it used to be in the 90-ties","97f72e1b":"Two biggest states are driving down the death share numbers for the age group 17 to 25, but there's an opposite trend in Queensland and WA, their share of road deaths is increasing in those states.","e2447ce4":"# Conclusions:\nAlthough the general number of deaths is decreasing, we can still isolate some areas and groups that should get attention, lets name a few:\n* males aged 40 to 64 - their share of road deaths is increasing, especially in WA\n* young people in Queensland\n* urban areas are becoming more deadly\n* both WA and QLD death numbers are decreasing much slower than NSW and VIC\n","ff71dee5":"## Lets remove all the columns with more than 10% missing values:","610d8bdf":"This will be a rather basic analysis of fatal car accidents in Australia from 1989 onwards. Overall as our cars and roads are becoming more modern and full of advanced technologies, we are much safer. On the other side the fact that more and more people drive a car doesn't help in improving the numbers.  In 1990 there were more than 10 million cars registered in Australia. Today? There were 20.1 million registered motor vehicles as at 31 January 2021.\n\nLets see what trends we can identify within this dataset.","b5882de8":"# Age group trends","f1d4e714":"We're going to analyze the top 4 states:\n* New South Wales\n* Victoria\n* Queensland\n* Western Australia","d782677a":"# General trend","accb4aab":"Clearly as the cities grow, their traffic increases and an increase in numnber of deaths on the roads follows.","98a0e89a":"**Observations:**\n\nBig decrease in share of deaths among the age group with probably the worst reputation among road users (17 - 25 year olds, females registered a bigger drop).\n\nAt the same time, a significant increase in share of deaths among the group, which probably has the best reputation among road users (40 to 64 year olds - especially males have a huge increase).","01a781f3":"# When should we travel?\n\nLets check how times of day and week affect the amount of death during the last 30 years.","5223a16b":"# Which state is the safest one?","1035e535":"# Where is it safe?\nAustralia is no European Union, so within a range of few kilometers you can come across various speed limits (20, 30, 40(school zone), 50 or 60 (most urban areas), 80 (some roads), 90, 110, 130). We've got it all here! I've categorized them into only 4 types:\n* up to 60\n* up to 80\n* up to 100\n* up to 130","0769a2f3":"Knowing that males aged 40 - 64 are dying more frequently on the roads, and looking at the above plot of number of deaths in WA. Lets see if we isolate that group, we'll see even steeper increase in their share of deaths on the roads:","22f93212":"Roads are becoming safer, but is this trend equal to everyone on the roads? ","e79621eb":"The two biggest states recorded biggest proportional drops in number of deaths."}}