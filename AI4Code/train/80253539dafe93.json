{"cell_type":{"56f4e093":"code","c322ba43":"code","932de6ac":"code","9dc6354d":"code","c26b507c":"code","b1cc8dff":"code","1695c744":"code","64b97a1a":"code","6ae60f4a":"code","f8987e4a":"code","787677a4":"code","ae7d41b7":"code","d660d2cd":"code","25c527b5":"code","8f5bc8c0":"code","f7695776":"code","c097af8e":"code","5f0fbbb2":"code","4ab0ceb6":"code","c765d241":"code","d2f61684":"code","2d0320f0":"code","412f3739":"code","89660ec8":"markdown"},"source":{"56f4e093":"#Import Dependencies\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\nfrom sklearn.preprocessing import MinMaxScaler","c322ba43":"# Get Data\ndata = pd.read_csv('..\/input\/google-stock-market-data\/GOOG.csv', date_parser = True)\ndata.head(10)","932de6ac":"data_training = data[data['Date']<'2019-01-01'].copy()\ndata_test = data[data['Date']>='2019-01-01'].copy()","9dc6354d":"data_training = data_training.drop(['Date', 'Adj Close'], axis = 1)","c26b507c":"scaler = MinMaxScaler()\ndata_training = scaler.fit_transform(data_training)\ndata_training[0:5]","b1cc8dff":"X_train = []\ny_train = []","1695c744":"for i in range(60, data_training.shape[0]):\n    X_train.append(data_training[i-60:i])\n    y_train.append(data_training[i, 0])","64b97a1a":"X_train, y_train = np.array(X_train), np.array(y_train)","6ae60f4a":"print(X_train.shape)\nprint(y_train.shape)","f8987e4a":"from tensorflow.keras import Sequential\nfrom tensorflow.keras.layers import Dense, LSTM, Dropout","787677a4":"model = Sequential()\n\nmodel.add(LSTM(units = 60, activation = 'relu', return_sequences = True, input_shape = (X_train.shape[1], 5)))\nmodel.add(Dropout(0.2))\n\nmodel.add(LSTM(units = 60, activation = 'relu', return_sequences = True))\nmodel.add(Dropout(0.2))\n\nmodel.add(LSTM(units = 80, activation = 'relu', return_sequences = True))\nmodel.add(Dropout(0.2))\n\nmodel.add(LSTM(units = 120, activation = 'relu'))\nmodel.add(Dropout(0.2))\n\nmodel.add(Dense(units = 1))","ae7d41b7":"model.compile(optimizer='adam', loss = 'mean_squared_error')","d660d2cd":"model.fit(X_train, y_train, epochs=5, batch_size=32)","25c527b5":"data_test.head()","8f5bc8c0":"data_training = data[data['Date']<'2019-01-01'].copy()\n\npast_60_days = data_training.tail(60)\n\ndf = past_60_days.append(data_test, ignore_index = True)\ndf = df.drop(['Date', 'Adj Close'], axis = 1)\ndf.head()","f7695776":"inputs = scaler.transform(df)\ninputs","c097af8e":"\nX_test = []\ny_test = []\n\nfor i in range(60, inputs.shape[0]):\n    X_test.append(inputs[i-60:i])\n    y_test.append(inputs[i, 0])","5f0fbbb2":"\nX_test, y_test = np.array(X_test), np.array(y_test)\nX_test.shape, y_test.shape","4ab0ceb6":"y_pred = model.predict(X_test)","c765d241":"scaler.scale_","d2f61684":"scale = 1\/8.18605127e-04\nscale","2d0320f0":"y_pred = y_pred*scale\ny_test = y_test*scale","412f3739":"# Visualising the results\nplt.figure(figsize=(14,5))\nplt.plot(y_test, color = 'red', label = 'Real Google Stock Price')\nplt.plot(y_pred, color = 'blue', label = 'Predicted Google Stock Price')\nplt.title('Google Stock Price Prediction')\nplt.xlabel('Time')\nplt.ylabel('Google Stock Price')\nplt.legend()\nplt.show()","89660ec8":"**Building the Neural Network**"}}