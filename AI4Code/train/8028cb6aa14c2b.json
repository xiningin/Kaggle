{"cell_type":{"6d4658c7":"code","ea20235c":"code","2ba669e0":"code","0f2b0c8e":"code","30f325dd":"code","6b7a52be":"code","b30cc9bc":"code","c9f12516":"code","668e88b6":"code","878b64cf":"code","c6472f33":"code","f75d5b70":"code","dbe207d3":"code","a5192a6c":"code","02e32533":"code","f99b3377":"code","47a2054d":"code","2303317f":"code","dccf85ec":"code","d5cfd4da":"markdown","22c21f43":"markdown"},"source":{"6d4658c7":"import os\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\nfrom IPython.core.interactiveshell import InteractiveShell\n","ea20235c":"df = pd.read_excel(\"..\/input\/anz-virtual-datasets\/ANZ synthesised transaction dataset.xlsx\",engine=\"openpyxl\")","2ba669e0":"df.head(3)","0f2b0c8e":"# Drop unnecessary columns\ndrop_list = [\"status\", \"card_present_flag\",\"bpay_biller_code\",\"currency\",\"country\"] \ndf.drop(drop_list,axis=1,inplace=True)","30f325dd":"# Basic feature engineering\ndf[\"extraction\"] = pd.to_datetime(df.extraction)","6b7a52be":"df[\"month\"] = df.extraction.dt.month\ndf[\"day\"] = df.extraction.dt.day\ndf[\"hour\"] = df.extraction.dt.hour\ndf[\"day_of_week\"] = df.extraction.dt.dayofweek","b30cc9bc":"# split location info into longitude and latitude\ndf[\"m_long\"] = df.merchant_long_lat.str.split(\" \").str[0]\ndf[\"m_lat\"]= df.merchant_long_lat.str.split(\" \").str[1]\ndf[\"long\"] = df.long_lat.str.split(\" \").str[0] \ndf[\"lat\"] = df.long_lat.str.split(\" \").str[1]\ndf.drop([\"long_lat\",\"merchant_long_lat\"],axis=1)","c9f12516":"df_spend = df[df[\"movement\"] != \"credit\"]","668e88b6":"customer_total_spend = df_spend.groupby(\"customer_id\").amount.sum()\nhourly_spend = df_spend.groupby(\"hour\").amount.sum()\nmonthly_spend = df_spend.groupby(\"month\").amount.sum()\nday_of_month_spend = df_spend.groupby(\"day\").amount.sum()\nday_of_week_spend = df_spend.groupby(\"day_of_week\").amount.sum()","878b64cf":"plt.hist(customer_total_spend)\nplt.title(\"Total spend distribution\")","c6472f33":"hourly_spend = hourly_spend.to_frame().reset_index()\nplt.plot(hourly_spend)\nplt.title(\"Hourly spend distribution\")\nplt.xticks(hourly_spend.hour)","f75d5b70":"day_of_month_spend = day_of_month_spend.to_frame().reset_index()\nplt.plot(day_of_month_spend)\nplt.title(\"day of month spend distribution\")","dbe207d3":"day_of_week_spend = day_of_week_spend.to_frame().reset_index()\nplt.plot(day_of_week_spend)\nplt.title(\"day of week spend distribution\")","a5192a6c":"day_of_week_spend.plot()","02e32533":"df_spend[\"long\"]= df_spend[\"long\"].astype(\"float64\")\ndf_spend[\"lat\"] = df_spend[\"lat\"].astype(\"float64\")\ndf_spend[\"m_long\"] =df_spend[\"m_long\"].astype(\"float64\")\ndf_spend[\"m_lat\"] = df_spend[\"m_lat\"].astype(\"float64\")","f99b3377":"distance_from_merchant = np.sqrt((df_spend.long-df_spend.m_long)**2 + (df_spend.lat-df_spend.m_lat)**2)","47a2054d":"distance_from_merchant","2303317f":"plt.hist(distance_from_merchant, bins = [i*0.1 for i in range(100)])\nplt.title(\"distance between merchant location and customer for every spending\")","dccf85ec":"#saved \ndf.to_csv(\"preprocessed.csv\")","d5cfd4da":"## Plots of statistics.","22c21f43":"## part one of ANZ virtual project. \n\nPart 1, the goal is to explore the dataset and present with 2 or 3 slides. Also presented with tableau with time segment.\n\nThe Tableau Dashboard of the Project link : https:\/\/public.tableau.com\/profile\/john.zhang2750#!\/vizhome\/project_16139211441070\/1?publish=yes\n\nANZ Project link : https:\/\/www.theforage.com\/modules\/ZLJCsrpkHo9pZBJNY\/BiJPfqmGY2QwgN6gA?ref=imLtMcmkCCRLgvKGE\n\n"}}