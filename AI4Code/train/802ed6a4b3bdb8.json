{"cell_type":{"c4bfdef5":"code","1748d435":"code","2b0d9498":"code","dc7faa6c":"code","e5ae01bb":"code","51791fd9":"code","37a9d051":"code","c46c13bc":"code","d749199d":"code","f2f6bc3c":"code","f70a7571":"code","476680c7":"code","0207cb08":"code","e41d0970":"code","f4c02dac":"markdown","372f7121":"markdown","4c2ab270":"markdown","5867057a":"markdown","185274db":"markdown","d7c71a3a":"markdown","5ab75a81":"markdown","a5995d12":"markdown","4c59b701":"markdown","dbc87a4c":"markdown","aeb159b2":"markdown","f1423b29":"markdown"},"source":{"c4bfdef5":"import seaborn as sns\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport tensorflow as ts\nfrom tensorflow import keras\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix","1748d435":"heart = pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')\nheart.head()","2b0d9498":"heart.info()","dc7faa6c":"heart.isnull().sum()","e5ae01bb":"sns.countplot(x=\"output\", data=heart).set(xlabel='Probability of heart attack',title='Distribution of outputs',ylabel=' ')","51791fd9":"#Chest Pain type is a column with categorical variables\nname=['typical_angina','atypical_angina','non_anginal_pain','asymptomatic']\n\ncd=pd.get_dummies(heart['cp'])\ncd.columns=name","37a9d051":"#Rest_ecg is a column with categorical variables\nname=['normal',' having_abnormality','definite_left_ventricular_hypertrophy']\n\nad=pd.get_dummies(heart['restecg'])\nad.columns=name","c46c13bc":"#include in dataframe original and drop column cp\nheart=heart.drop(labels=['cp','restecg'],axis=1)\nheart=pd.concat([heart,cd,ad],axis=1)\nheart","d749199d":"corr=heart.corr(method ='pearson')\n\nmask = np.triu(np.ones_like(corr, dtype=bool))\n\n# Set up the matplotlib figure\nf, ax = plt.subplots(figsize=(11, 9))\n\n# Generate a custom diverging colormap\ncmap = sns.diverging_palette(230, 20, as_cmap=True)\nsns.heatmap(corr, mask=mask, cmap=cmap, vmax=.3, center=0,\n            square=True, linewidths=.5, cbar_kws={\"shrink\": .5}).set(title='Correlation of parameters')","f2f6bc3c":"corr=heart.corr(method ='spearman')\n\nmask = np.triu(np.ones_like(corr, dtype=bool))\n\n# Set up the matplotlib figure\nf, ax = plt.subplots(figsize=(11, 9))\n\n# Generate a custom diverging colormap\ncmap = sns.diverging_palette(230, 20, as_cmap=True)\nsns.heatmap(corr, mask=mask, cmap=cmap, vmax=.3, center=0,\n            square=True, linewidths=.5, cbar_kws={\"shrink\": .5}).set(title='Correlation of parameters')","f70a7571":"y=heart['output']\nX=heart.drop(labels=['age', 'sex', 'trtbps', 'chol','fbs','output'],axis=1)\nscaler = StandardScaler()\nX = scaler.fit_transform(X)\nX","476680c7":"X_train, X_test, y_train, y_test = train_test_split(X, y,\ntest_size = 0.15)","0207cb08":"model = keras.Sequential([\n    keras.layers.Dense(64, activation='relu',input_dim=X_train.shape[1]),\n    keras.layers.Dense(32, activation='relu'),\n    keras.layers.Dense(16, activation='relu'),\n    keras.layers.Dense(1, activation='sigmoid'),\n])\n\nmodel.compile(optimizer='adam',\n              loss='binary_crossentropy',\n              metrics=['accuracy'])\n\ncallbacks = [\n    keras.callbacks.ModelCheckpoint('.\/hearts_attack_model.h5', save_best_only=True)\n]\nmodel.fit(X_train,y_train,epochs=200,batch_size = 32,validation_split = 0.2,callbacks=callbacks)","e41d0970":"model = keras.models.load_model('.\/hearts_attack_model.h5')\ny_predict=(model.predict(X_test) > 0.5).astype(\"int32\")\ncf_matrix = confusion_matrix(y_test, y_predict)\nsns.heatmap(cf_matrix, annot=True).set(xlabel='Actual values',ylabel='Predict values')","f4c02dac":"## Load data and first look","372f7121":"Pearson correlation","4c2ab270":"## Data Analysis and feature selection","5867057a":"## Predict probability of hearth attack with NN\n\nThe past analysis will be used to train a neural network with the parameters with the highest correlation for its prediction, tensorflow and keras will be used","185274db":"Now,this dataset already makes sense to use","d7c71a3a":"## Libraries","5ab75a81":"- Age : Age of the patient\n\n- Sex : Sex of the patient\n\n- exang: exercise induced angina (1 = yes; 0 = no)\n\n- ca: number of major vessels (0-3)\n\n- cp : Chest Pain type chest pain type\n\n        Value 1: typical angina\n        Value 2: atypical angina\n        Value 3: non-anginal pain\n        Value 4: asymptomatic\n- trtbps : resting blood pressure (in mm Hg)\n\n- chol : cholestoral in mg\/dl fetched via BMI sensor\n\n- fbs : (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)\n\n- rest_ecg : resting electrocardiographic results\n\n        Value 0: normal\n\n        Value 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\n\n        Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria\n        \n- thalach : maximum heart rate achieved\n\n- target : 0= less chance of heart attack 1= more chance of heart attack\n\nFrom the datafame info we observe that our columns are all numerical and do not have missing values which will make our work easier","a5995d12":"Spearman correlation","4c59b701":"The dataset is balanced ","dbc87a4c":"No missing values.","aeb159b2":"Taking into account the two correlation graphs, it can be concluded that the data are linear and monotonous for the reason that S = P\n\nWith the correlations it can be seen that some parameters do not have a significant correlation such as age, sex, trtbps, chol and fbs, these parameters do not have a great meaning in the probability of a heart attack.","f1423b29":"## Introduction\n\nThe heart attack or acute myocardial infarction is the obstruction of the blood supply to the heart muscle.\nA heart attack is a medical emergency. Heart attacks usually happen when a blood clot blocks the blood supply to the heart. Without blood, the tissues do not receive oxygen and die. \n\nMotivation:\nTry to understand what the cause of Heart attack.\nExplore the data trough some EDA and data visualisazion.\nTry to detect and extract relevant feature in order to build a prediction model.\nThe plan:\n- Libraries\n\n- Load data and first look\n\n- Data Analysis and feature selection \n\n- Model"}}