{"cell_type":{"4aa0be99":"code","6b1268ce":"code","68e4b2cf":"code","ed2070f3":"code","d06debe9":"code","c9212dd7":"code","f7d5cefc":"code","78187655":"code","e1f73737":"code","cbf6a075":"code","d64bfde0":"markdown","078e091d":"markdown","511f8567":"markdown"},"source":{"4aa0be99":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import mean_squared_error\nfrom tqdm.notebook import tqdm","6b1268ce":"train = pd.read_csv(\"\/kaggle\/input\/petfinder-pawpularity-score\/train.csv\")\ntrain.head()","68e4b2cf":"# All zero RMSE\nmean_squared_error(np.zeros(len(train)), train[\"Pawpularity\"], squared=False)","ed2070f3":"# All mean RMSE\nmean_target = np.mean(train[\"Pawpularity\"])\nprint(\"Mean target\", mean_target)\nmean_squared_error([mean_target] * len(train), train[\"Pawpularity\"], squared=False)","d06debe9":"N = 1700\nrmse_values = []\n\nfor i in tqdm(range(10000)):\n    sample = train[\"Pawpularity\"].sample(n=N)\n    rmse_values.append(mean_squared_error(np.zeros(N), sample, squared=False))","c9212dd7":"mc_mean = np.mean(rmse_values)\nmc_std = np.std(rmse_values)\nmc_mean, mc_std","f7d5cefc":"plt.figure(figsize=(10, 6))\nplt.hist(rmse_values, bins=100);\nplt.title(\"RMSE calculated using all zeros\")\nplt.axvline(43.25455, c=\"k\", label=\"Full train RMSE (43.25455)\");\nplt.axvline(43.50174, c=\"r\", label=\"Public LB RMSE (43.50174)\");\nplt.axvline(mc_mean, c=\"g\", label=\"Mean of sampled train RMSE\");\nplt.axvline(mc_mean - mc_std, c=\"g\", linestyle=\"--\", label=\"-1 std dev\");\nplt.axvline(mc_mean + mc_std, c=\"g\", linestyle=\"--\", label=\"+1 std dev\");\nplt.legend(loc=\"upper right\");","78187655":"N = 1700\nrmse_values = []\n\nfor i in tqdm(range(10000)):\n    sample = train[\"Pawpularity\"].sample(n=N)\n    rmse_values.append(mean_squared_error([mean_target] * N, sample, squared=False))","e1f73737":"mc_mean = np.mean(rmse_values)\nmc_std = np.std(rmse_values)\nmc_mean, mc_std","cbf6a075":"plt.figure(figsize=(10, 6))\nplt.hist(rmse_values, bins=100);\nplt.title(\"RMSE calculated using train mean: 38.03904\")\nplt.axvline(20.59095, c=\"k\", label=\"Full train RMSE (20.59095)\");\nplt.axvline(20.50574, c=\"r\", label=\"Public LB RMSE (20.50574)\");\nplt.axvline(mc_mean, c=\"g\", label=\"Mean of sampled train RMSE\");\nplt.axvline(mc_mean - mc_std, c=\"g\", linestyle=\"--\", label=\"-1 std dev\");\nplt.axvline(mc_mean + mc_std, c=\"g\", linestyle=\"--\", label=\"+1 std dev\");\nplt.legend(loc=\"upper right\");","d64bfde0":"# Estimate LB noise","078e091d":"## All mean","511f8567":"All zeros sub on public LB is 43.50174.\n\nUsing only the train mean as a submission on public LB is 20.50574 [notebook](https:\/\/www.kaggle.com\/kaushal2896\/petfinder-my-initial-eda-mean-baseline)\n\n# Test dataset\n* 6800 photos\n* LB is 25% (1700 photos)\n\nMonte Carlo method:\n* Choose 1700 random photos from train\n* Calculate RMSE for an all zero\/mean prediction\n* Repeat 10000 times\n\n## All zero"}}