{"cell_type":{"8cb57ecf":"code","0577af29":"code","c8a3fb01":"code","1d2439e4":"code","8a2f064f":"code","980aab61":"code","a97aece5":"code","d0a276a6":"markdown","eb92ef2a":"markdown"},"source":{"8cb57ecf":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\n# for dirname, _, filenames in os.walk('\/kaggle\/input'):\n#     for filename in filenames:\n#         print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","0577af29":"# Test image folder directory\nTEST_DIR = '..\/input\/cassava-leaf-disease-classification\/test_images\/'","c8a3fb01":"# load the best saved model as a new model\nfrom keras.models import load_model\nmodel = load_model('..\/input\/effficientnetb3-cassava\/best_model.hdf5')","1d2439e4":"model.summary()","8a2f064f":"#This is the image size on which our model was trained\nIMG_SIZE = 300\nsize = (IMG_SIZE,IMG_SIZE)","980aab61":"#loading images\nfrom PIL import Image\n\ntest_images = os.listdir(TEST_DIR)\npreds = []\nfor image in test_images:\n    img = Image.open(TEST_DIR + image)\n    img = img.resize(size)\n    img = np.expand_dims(img, axis=0)\n    preds.extend(model.predict(img).argmax(axis = 1))","a97aece5":"#Creating submission file\n\nsub = pd.DataFrame({'image_id': test_images, 'label': preds})\nprint(sub)\nsub.to_csv('submission.csv', index = False)","d0a276a6":"## Loading the trained model\n* Training Notebok: https:\/\/www.kaggle.com\/deepakat002\/effficientnetb3-cassava\n","eb92ef2a":"## Submission:"}}