{"cell_type":{"4699d0aa":"code","aa1eeb48":"code","d489567f":"code","c2e8b042":"code","ac8e091d":"code","7ed153ca":"code","3e6c11e3":"code","fdf84ee7":"code","bc7e1b22":"code","9596a20e":"code","418c0b79":"code","ddd58466":"code","274c91f4":"code","9a0f1060":"code","91dee905":"code","7ce1ce0d":"code","ff95b069":"code","6efb2d81":"code","b0963aad":"code","e66cb01c":"code","3038db31":"code","6ca428af":"code","cbabcfc2":"code","26637d84":"code","83325556":"code","d1d28d4a":"code","a0605e3b":"code","8bbf1ba7":"code","61c4afca":"code","97a0244d":"code","ca23ed2f":"code","f715e76c":"code","62d20c62":"markdown","bbc18db8":"markdown","e166e7dc":"markdown","5a43c178":"markdown","487cf70d":"markdown","93261dd3":"markdown","24075418":"markdown","900b12d7":"markdown","4f6a2c95":"markdown","9dbef09e":"markdown","fe415457":"markdown","045f1cde":"markdown","28d69484":"markdown","9e9446f6":"markdown","72a4d2a4":"markdown"},"source":{"4699d0aa":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","aa1eeb48":"df = pd.read_csv('..\/input\/pizza-price-prediction\/pizza_v2.csv')\ndf.head()","d489567f":"df.shape","c2e8b042":"df.describe()","ac8e091d":"df.info()","7ed153ca":"# Check duplicate values\n\ndf.duplicated().sum()","3e6c11e3":"# Remove duplicate values\n\ndf.drop_duplicates(inplace=True)","fdf84ee7":"df.isnull().sum()","bc7e1b22":"# Convert price_rupiah column into integer and remove string\n\ndf['price_rupiah'] = df['price_rupiah'].apply(lambda x: x.replace('Rp', '').replace(',', ''))\ndf['price_rupiah'] = df['price_rupiah'].astype(float)","9596a20e":"df['price_rupiah']","418c0b79":"# Convert diameter column into integer and remove string\ndf['diameter'] = df['diameter'].apply(lambda x: x.replace('inch', ''))\ndf['diameter'] = df['diameter'].astype(float)","ddd58466":"df['diameter']","274c91f4":"plt.figure(figsize=(15,10))\nsns.distplot(df['price_rupiah'])","9a0f1060":"plt.figure(figsize=(15,10))\nsns.distplot(df['diameter'])","91dee905":"# Price column\nplt.figure(figsize=(15,10))\nsns.boxplot(df['price_rupiah'])","7ce1ce0d":"# diameter column\nplt.figure(figsize=(15,10))\nsns.boxplot(df['diameter'])","ff95b069":"plt.figure(figsize=(15,10))\nsns.barplot(x = df['topping'], y = df['price_rupiah'], data=df)","6efb2d81":"plt.figure(figsize=(15,10))\nplt.xticks(rotation=90)\nsns.barplot(x = df['variant'], y = df['price_rupiah'], data=df)","b0963aad":"# How many Pizza size are available\nplt.figure(figsize=(15,10))\nplt.xticks(rotation=90)\nsns.countplot(df['size'], data=df)","e66cb01c":"plt.figure(figsize=(15,10))\n#plt.xticks(rotation=90)\nsns.barplot(x = df['company'], y = df['price_rupiah'], data=df)","3038db31":"from sklearn.preprocessing import LabelEncoder\n\nen = LabelEncoder()","6ca428af":"cat_cols = []\nfor i in df.columns:\n    if df[i].dtypes == 'object':\n        cat_cols.append(i)\ncat_cols","cbabcfc2":"for col in cat_cols:\n    df[col] = en.fit_transform(df[col])","26637d84":"df.head()","83325556":"y = df[\"price_rupiah\"]\nX = df.drop(\"price_rupiah\",axis = 1)","d1d28d4a":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.8, test_size=0.2)","a0605e3b":"from xgboost import XGBRegressor\nfrom sklearn.metrics import mean_absolute_error\nimport sklearn.metrics as metrics\n\n# Initialize object\nxgb = XGBRegressor(n_estimators=1000, learning_rate = 0.09)\n\n# Fit model\nxgb.fit(X_train, y_train)\n\n# Get Predictions\ny_predict = xgb.predict(X_test)\n\n# Calculate MAE\nmae = mean_absolute_error(y_predict, y_test)\nprint(\"Mean Absolute Error:\" , mae)\n\n#Calculating R2\nr2 =  metrics.r2_score(y_test, y_predict)\nprint(\"R2 score :\", r2)","8bbf1ba7":"from sklearn.linear_model import LinearRegression\n\nlr = LinearRegression()\nlr.fit(X_train, y_train)\ny_predict = lr.predict(X_test)\n\n# Calculate MAE\nmae = mean_absolute_error(y_predict, y_test)\nprint(\"Mean Absolute Error:\" , mae)\n\n#Calculating R2\nr2 =  metrics.r2_score(y_test, y_predict)\nprint(\"R2 score :\", r2)","61c4afca":"from sklearn.linear_model import Lasso\n\nlr = Lasso()\nlr.fit(X_train, y_train)\ny_predict = lr.predict(X_test)\n\n# Calculate MAE\nmae = mean_absolute_error(y_predict, y_test)\nprint(\"Mean Absolute Error:\" , mae)\n\n#Calculating R2\nr2 =  metrics.r2_score(y_test, y_predict)\nprint(\"R2 score :\", r2)","97a0244d":"from sklearn.linear_model import Ridge\n\nlr = Ridge()\nlr.fit(X_train, y_train)\ny_predict = lr.predict(X_test)\n\n# Calculate MAE\nmae = mean_absolute_error(y_predict, y_test)\nprint(\"Mean Absolute Error:\" , mae)\n\n#Calculating R2\nr2 =  metrics.r2_score(y_test, y_predict)\nprint(\"R2 score :\", r2)","ca23ed2f":"predictions = pd.DataFrame(y_predict)","f715e76c":"predictions.head()","62d20c62":"# Using Lasso Regression","bbc18db8":"# Using XGB Regressor","e166e7dc":"# Encode Data","5a43c178":"# Check Null values","487cf70d":"# Import Dataset","93261dd3":"# Using Ridge Regression","24075418":"# SPLITTING THE DATASET INTO TRAIN AND TEST DATA","900b12d7":"# Data Preprocessing","4f6a2c95":"# Analysis","9dbef09e":"# Check Data Distribution","fe415457":"# Import Libraries","045f1cde":"# Using Linear Regression","28d69484":"# Check Outlier","9e9446f6":"# Feature Extraction ","72a4d2a4":"# In this notebook, we will try to predcit Pizza Prices "}}