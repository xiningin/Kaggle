{"cell_type":{"f80ade0c":"code","26c053c7":"code","28a0d46a":"code","03e3f58e":"code","8c68f73a":"code","1cf790c3":"code","c2cf7bd5":"code","09649df5":"code","0b60e9c6":"code","32457cfc":"code","c1901c94":"code","ef9209b0":"code","1404f043":"code","65248fb2":"markdown","c9f9d2b1":"markdown","bac8f06f":"markdown","0443c1e3":"markdown","80fe8a6e":"markdown","e9876144":"markdown"},"source":{"f80ade0c":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport pickle\nfrom tensorflow import keras","26c053c7":"test = pd.read_csv(f'..\/input\/digit-recognizer\/test.csv')\n\nprint('Test Set Size:', test.shape)","28a0d46a":"test.head()","03e3f58e":"X_test = test.values","8c68f73a":"Xs_test = X_test \/ 255","1cf790c3":"digit_net = keras.models.load_model('..\/input\/models\/MNIST\/digit_ann_v01.h5')\ndigit_net.summary()","c2cf7bd5":"test_probs = digit_net.predict(Xs_test)\nprint(test_probs.shape)","09649df5":"print(test_probs[:10,].round(2))","0b60e9c6":"test_pred = np.argmax(test_probs, axis=1)\nprint(test_pred[:10])","32457cfc":"sel = np.random.choice(range(len(X_test)), 40, replace=False)\n\nX_sel = X_test[sel]\np_sel = test_pred[sel]\n\nplt.close()\nplt.rcParams[\"figure.figsize\"] = [16,10]\nfor i in range(40):\n    img = X_sel[i].reshape(28,28)\n    pred = p_sel[i]\n    \n    plt.subplot(5,8,i+1)\n    plt.imshow(img, cmap='binary')\n    plt.text(-1, 10, s = str(pred), fontsize=16, color='r')\n    plt.axis('off')\nplt.show()","c1901c94":"submission = pd.read_csv('..\/input\/digit-recognizer\/sample_submission.csv')\nsubmission.head()","ef9209b0":"submission.Label = test_pred\nsubmission.head()","1404f043":"submission.to_csv('submission.csv', header=True, index=False)","65248fb2":"# Import Statements","c9f9d2b1":"# Prepare Submission","bac8f06f":"# MNIST Handwritten Digit Dataset\n\n","0443c1e3":"# Test Predictions","80fe8a6e":"# Load and Explore Data","e9876144":"# Load Model"}}