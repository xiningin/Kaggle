{"cell_type":{"656f0ecc":"code","33c307b6":"code","d768dffa":"code","fd4add11":"code","311326ae":"code","1d2918a1":"code","e86e9561":"code","567001dc":"code","e862dcf9":"code","1d3ffbbe":"code","0b4c52bf":"code","ba68a83e":"code","9b9d4d0b":"code","dfb3e2bc":"code","94a0bf96":"code","18ca6601":"code","d78c305a":"code","281a5429":"code","979da243":"code","cd590e35":"code","0280a2ab":"code","63ede017":"code","d48d41e2":"code","c979b335":"code","c83d55be":"code","4c492796":"code","d2242305":"code","7623264b":"code","83082857":"markdown","b35991ea":"markdown","357563d4":"markdown","428346f1":"markdown","6adff3d8":"markdown","9370e6ba":"markdown","7482432e":"markdown","83ee51b1":"markdown","cefb0681":"markdown","8a8636cb":"markdown","5f6da5b0":"markdown"},"source":{"656f0ecc":"from sklearn.metrics import roc_auc_score\n\ny_true = [\n    0,\n    1,\n    1,\n    0,\n    1\n]\n\ny_predictions = [\n    0.1,\n    0.9,\n    0.4,\n    0.6,\n    0.61\n]\n\nroc_auc_score(y_true, y_predictions)","33c307b6":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","d768dffa":"data = pd.read_csv('..\/input\/advanced-dls-spring-2021\/train.csv')","fd4add11":"# \u0414\u043b\u044f \u0432\u0430\u0448\u0435\u0433\u043e \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u0441\u043f\u0438\u0441\u043a\u0438 \u0441 \u0438\u043c\u0435\u043d\u0430\u043c\u0438 \u0440\u0430\u0437\u043d\u044b\u0445 \u043a\u043e\u043b\u043e\u043d\u043e\u043a\n\n# \u0427\u0438\u0441\u043b\u043e\u0432\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438\nnum_cols = [\n    'ClientPeriod',\n    'MonthlySpending',\n    'TotalSpent'\n]\n\n# \u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438\ncat_cols = [\n    'Sex',\n    'IsSeniorCitizen',\n    'HasPartner',\n    'HasChild',\n    'HasPhoneService',\n    'HasMultiplePhoneNumbers',\n    'HasInternetService',\n    'HasOnlineSecurityService',\n    'HasOnlineBackup',\n    'HasDeviceProtection',\n    'HasTechSupportAccess',\n    'HasOnlineTV',\n    'HasMovieSubscription',\n    'HasContractPhone',\n    'IsBillingPaperless',\n    'PaymentMethod'\n]\n\nfeature_cols = num_cols + cat_cols\ntarget_col = 'Churn'","311326ae":"# \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e\u0433\u043e \u0441\u0435\u043c\u043f\u043b\u0430 \u0434\u0430\u043d\u043d\u044b\u0445\ndata.sample(5) ","1d2918a1":"data.info()","e86e9561":"# \u0412 \u043a\u043e\u043b\u043e\u043d\u043a\u0435 TotalSpent \u0435\u0441\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u0443\u0441\u0442\u043d\u044b\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439","567001dc":"# \u0417\u0430\u043c\u0435\u043d\u0438\u043c \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u0438 \u043d\u0430 \u043d\u0443\u043b\u0438\ndef remove_spaces(row):\n    try:\n        row = float(row)\n        return row\n    except ValueError:\n        return 0.\n\ndata['TotalSpent'] = data['TotalSpent'].apply(remove_spaces)","e862dcf9":"fig, ax = plt.subplots(3, 1, figsize=(14,18))\n\nfor n, col in enumerate(num_cols):\n    ax = ax.flatten()\n    ax[n].hist(data[col], bins=50)\n    ax[n].set_title(col, size=15)\nplt.show()","1d3ffbbe":"fig, ax = plt.subplots(8, 2, figsize=(10,20))\nfor n, col in enumerate(cat_cols):\n    ax = ax.flatten()\n    ax[n].bar(data[col].value_counts().index, data[col].value_counts().values)\n    ax[n].set_title(col, size=15)\n    ax[n].set_xticks(data[col].value_counts().index)\nfig.tight_layout()\nplt.show()","0b4c52bf":"plt.bar(data[target_col].value_counts().index, data[target_col].value_counts().values)\nplt.xticks(data[target_col].value_counts().index)\nplt.title(target_col)\nplt.show()","ba68a83e":"from sklearn.linear_model import LogisticRegression, LogisticRegressionCV\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.preprocessing import StandardScaler, RobustScaler, LabelEncoder, OneHotEncoder\nfrom sklearn.pipeline import make_pipeline","9b9d4d0b":"std_scaler = StandardScaler()\nlog_reg_cv = LogisticRegressionCV(scoring='roc_auc')","dfb3e2bc":"data_num_cols_std = std_scaler.fit_transform(data[num_cols])\ndum_cat_data = pd.get_dummies(data[cat_cols])\nX = pd.DataFrame(data_num_cols_std, columns=num_cols).join(dum_cat_data)\ny = data[target_col]\nX_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.8, random_state=42)","94a0bf96":"cv = GridSearchCV(log_reg_cv, \n                  param_grid={\n                      'penalty': ['l1', 'l2'],\n                      'solver': ['lbfgs', 'newton-cg', 'liblinear', 'sag', 'saga'],\n                  },\n                  scoring='roc_auc',\n                  refit=True,\n                  n_jobs=-1,\n                  verbose=0\n)\ncv.fit(X_train, y_train)","18ca6601":"print(cv.score(X_train, y_train), cv.score(X_test, y_test))","d78c305a":"cv.best_params_","281a5429":"from catboost import CatBoostClassifier","979da243":"catb_clf = CatBoostClassifier(logging_level='Silent')","cd590e35":"X = data.drop(target_col, axis=1)\ny = data[target_col]\nX_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.8, random_state=42)","0280a2ab":"catb_clf.fit(X_train, y_train, cat_features=cat_cols)","63ede017":"# \u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e\nroc_auc_score(y_test, catb_clf.predict_proba(X_test)[:, 1])","d48d41e2":"# \u041f\u043e\u0434\u0431\u043e\u0440 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0447\u0435\u0440\u0435\u0437 GridSearchCV\nparameters = {\n    'iterations':[100, 300, 500, 700, 1000], \n    'depth':[3, 5, 6, 7, 10], \n}\n\ncv = GridSearchCV(catb_clf, param_grid=parameters, n_jobs=-1)\ncv.fit(X_train, y_train, cat_features=cat_cols)","c979b335":"cv.best_params_","c83d55be":"# \u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e catboost \u0441 GridSearchCV\nroc_auc_score(y_test, cv.predict_proba(X_test)[:, 1])","4c492796":"best_model = CatBoostClassifier(iterations=700, depth=3, logging_level='Silent')","d2242305":"best_model.fit(X_train, y_train, cat_features=cat_cols)","7623264b":"X_test = pd.read_csv('..\/input\/advanced-dls-spring-2021\/test.csv')\nsubmission = pd.read_csv('..\/input\/advanced-dls-spring-2021\/submission.csv')\n\nsubmission['Churn'] = best_model.predict_proba(X_test)[:, 1]\nsubmission.to_csv('.\/my_submission.csv', index=False)","83082857":"# \u041a\u0430\u043a \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c?\n\n\u0421\u0442\u0430\u0432\u044c\u0442\u0435 \u043f\u043e\u043b\u043d\u044b\u0439 \u0431\u0430\u043b\u043b, \u0435\u0441\u043b\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u044b \u0432\u0441\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438 \u0438\u043b\u0438 \u0441\u0434\u0435\u043b\u0430\u043d\u043e \u0447\u0442\u043e-\u0442\u043e \u0431\u043e\u043b\u0435\u0435 \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u043d\u043e\u0435 \u0438 \u0441\u043b\u043e\u0436\u043d\u043e\u0435. \u0417\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 \u043e\u0442\u0441\u0443\u0441\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u043f\u0443\u043d\u043a\u0442 \u0438\u0437 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u044f \u0441\u043d\u0438\u0436\u0430\u0439\u0442\u0435 1 \u0431\u0430\u043b\u043b.","b35991ea":"# \u041c\u0435\u0442\u0440\u0438\u043a\u0430\n\n\u041f\u0435\u0440\u0435\u0434 \u0440\u0435\u0448\u0435\u043d\u0438\u0435\u043c \u043b\u044e\u0431\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438 \u0432\u0430\u0436\u043d\u043e \u043f\u043e\u043d\u0438\u043c\u0430\u0442\u044c, \u043a\u0430\u043a \u0431\u0443\u0434\u0435\u0442 \u043e\u0446\u0435\u043d\u0438\u0432\u0430\u0442\u044c\u0441\u044f \u0432\u0430\u0448\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435. \u0412 \u0434\u0430\u043d\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435 \u043c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u0443\u044e \u0434\u043b\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u043c\u0435\u0442\u0440\u0438\u043a\u0443 ROC-AUC. \u0415\u0435 \u043c\u043e\u0436\u043d\u043e \u0432\u044b\u0447\u0438\u0441\u043b\u0438\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0438 \u0438 \u0438\u0441\u0442\u0438\u043d\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0441\u044b \u0431\u0435\u0437 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043f\u043e\u0440\u043e\u0433\u0430 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 + \u043e\u043d\u0430 \u0440\u0430\u043e\u0442\u0430\u0435\u0442 \u0434\u0430\u0436\u0435 \u0435\u0441\u043b\u0438 \u043a\u043b\u0430\u0441\u0441\u044b \u0432 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0438\u043b\u044c\u043d\u043e \u043d\u0435\u0441\u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b (\u043f\u0440\u0438\u043c\u0435\u0440\u043e\u0432 \u043e\u0434\u043d\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0430 \u0432 \u0434\u0435\u0441\u044f\u0442\u043a\u0438 \u0440\u0430\u0437 \u0431\u043e\u043b\u044c\u0448\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u043e\u0432 \u0434\u043b\u0443\u0433\u043e\u0433\u043e). \u0418\u043c\u0435\u043d\u043d\u043e \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043e\u043d\u0430 \u043e\u0447\u0435\u043d\u044c \u0443\u0434\u043e\u0431\u043d\u0430 \u0434\u043b\u044f \u0441\u043e\u0440\u0435\u0432\u043d\u043e\u0432\u0430\u043d\u0438\u0439.\n\n\u041f\u043e\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0435\u0435 \u043b\u0435\u0433\u043a\u043e:\n","357563d4":"## \u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043b\u0438\u043d\u0435\u0439\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 (3 \u0431\u0430\u043b\u043b\u0430)\n\n1) \u041e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u0439\u0442\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0442\u043e\u0433\u043e, \u0447\u0442\u043e\u0431\u044b \u043a \u043d\u0438\u043c \u043c\u043e\u0436\u043d\u043e \u0431\u044b\u043b\u043e \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c LogisticRegression. \u0422.\u0435. \u043e\u0442\u043d\u043e\u0440\u043c\u0438\u0440\u0443\u0439\u0442\u0435 \u0447\u0438\u0441\u043b\u043e\u0432\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438, \u0430 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u0437\u0430\u043a\u043e\u0434\u0438\u0440\u0443\u0439\u0442\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e one-hot-encoding'\u0430. \n\n2) \u0421 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043a\u0440\u043e\u0441\u0441\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438 \u0438\u043b\u0438 \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043d\u0430 train\/valid \u0432\u044b\u0431\u043e\u0440\u043a\u0443 \u043f\u0440\u043e\u0442\u0435\u0441\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u0440\u0430\u0437\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 C \u0438 \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043b\u0443\u0447\u0448\u0438\u0439 (\u043c\u043e\u0436\u043d\u043e \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0421=100, 10, 1, 0.1, 0.01, 0.001) \u043f\u043e \u043c\u0435\u0442\u0440\u0438\u043a\u0435 ROC-AUC. \n\n\u0415\u0441\u043b\u0438 \u0432\u044b \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u0442\u0435 \u043d\u0430 train\/valid, \u0442\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 LogisticRegressionCV. \u041e\u043d \u0441\u0430\u043c \u043f\u0440\u0438 \u0432\u044b\u0437\u043e\u0432\u0435 .fit() \u043f\u043e\u0434\u0431\u0435\u0440\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0421. (\u043d\u0435 \u0437\u0430\u0431\u0443\u0434\u044c\u0442\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c scroing='roc_auc', \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u0438 \u043a\u0440\u043e\u0441\u0441\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438 \u0441\u0440\u0430\u0432\u043d\u0438\u0432\u0430\u043b\u0438\u0441\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u044d\u0442\u043e\u0439 \u043c\u0435\u0442\u0440\u0438\u043a\u0438, \u0438 refit=True, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u0438 \u043f\u043e\u0442\u043e\u043c \u043c\u043e\u0434\u0435\u043b\u044c \u043e\u0431\u0443\u0447\u0438\u043b\u0430\u0441\u044c \u043d\u0430 \u0432\u0441\u0435\u043c \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435 \u0441 \u043b\u0443\u0447\u0448\u0438\u043c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u043c C). \n\n\n(\u0431\u043e\u043b\u0435\u0435 \u0441\u043b\u043e\u0436\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442) \u0415\u0441\u043b\u0438 \u0432\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u0440\u043e\u0441\u0441\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044e, \u0442\u043e \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 LogisticRegression \u043d\u0443\u0436\u043d\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0432 \u043e\u0434\u0438\u043d Pipeline \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e make_pipeline, \u043a\u0430\u043a \u044d\u0442\u043e \u0434\u0435\u043b\u0430\u043b\u043e\u0441\u044c \u0432\u043e \u0432\u0442\u043e\u0440\u043e\u043c \u0441\u0435\u043c\u0438\u043d\u0430\u0440\u0435. \u041f\u043e\u0442\u043e\u043c pipeline \u043d\u0430\u0434\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0432 GridSearchCV. \u0414\u043b\u044f one-hot-encoding'a \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u043c\u0431\u0438\u043d\u0430\u0446\u0438\u044e LabelEncoder + OneHotEncoder (\u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u043f\u0440\u0435\u0432\u0440\u0430\u0449\u0430\u0435\u043c \u0441\u0442\u0440\u043e\u0447\u043a\u0438 \u0432 \u0447\u0438\u0441\u043b\u0430, \u0430 \u043f\u043e\u0442\u043e\u043c \u0447\u0438\u0441\u043b\u0430 \u043f\u0440\u0432\u0440\u0430\u0449\u0430\u0435\u043c \u0432 one-hot \u0432\u0435\u043a\u0442\u043e\u0440\u0430.)","428346f1":"\u0412\u044b\u043f\u0438\u0448\u0438\u0442\u0435 \u043a\u0430\u043a\u043e\u0435 \u043b\u0443\u0447\u0448\u0435\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0438 \u0441 \u043a\u0430\u043a\u0438\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 \u0432\u0430\u043c \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c","6adff3d8":"## \u0410\u043d\u0430\u043b\u0438\u0437 \u0434\u0430\u043d\u043d\u044b\u0445 (3 \u0431\u0430\u043b\u043b\u0430)\n\n1) \u0414\u043b\u044f \u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0445 \u043f\u0440\u0438\u0437\u0430\u043d\u043a\u043e\u0432 \u043f\u043e\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u0433\u0438\u0441\u0442\u043e\u0433\u0440\u0430\u043c\u043c\u0443 (*plt.hist(...)*) \u0438\u043b\u0438 boxplot (*plt.boxplot(...)*). \u0414\u043b\u044f \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u0441\u0447\u0438\u0442\u0430\u0439\u0442\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0430. \u0414\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u043a\u043e\u043b\u043e\u043d\u043a\u0438 \u043d\u0430\u0434\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c *data.value_counts()* \u0438 \u043f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c bar \u0434\u0438\u0430\u0433\u0440\u0430\u043c\u043c\u044b *plt.bar(...)* \u0438\u043b\u0438 \u043a\u0440\u0443\u0433\u043e\u0432\u044b\u0435 \u0434\u0438\u0430\u0433\u0440\u0430\u043c\u043c\u044b *plt.pie(...)* (\u0445\u043e\u0440\u043e\u0448\u043e, \u0435\u043b\u0441\u0438 \u0432\u044b \u0441\u043c\u043e\u0436\u0435\u0442\u0435 \u044d\u0442\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u043d\u0430 \u043e\u0434\u043d\u043e\u043c \u0433\u0430\u0440\u0444\u0438\u043a\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e *plt.subplots(...)*). \n\n2) \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435 \u043d\u0430 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0446\u0435\u043b\u0435\u0432\u043e\u0439 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u0438 \u0441\u043a\u0430\u0436\u0438\u0442\u0435, \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u043b\u0438 \u043a\u043b\u0430\u0441\u0441\u044b \u043d\u0435\u0441\u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c\u0438.\n\n3) (\u0415\u0441\u043b\u0438 \u0431\u0443\u0434\u0435\u0442 \u0436\u0435\u043b\u0430\u043d\u0438\u0435) \u041f\u043e\u0438\u0433\u0440\u0430\u0439\u0442\u0435 \u0441 \u0440\u0430\u0437\u043d\u044b\u043c\u0438 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430\u043c\u0438 \u0434\u043b\u044f \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 - *sns*, *pandas_visual_analysis*, etc.\n\n\u0412\u0442\u043e\u0440\u043e\u0439 \u043f\u0443\u043d\u043a\u0442 \u043e\u0447\u0435\u043d\u044c \u0432\u0430\u0436\u0435\u043d, \u043f\u043e\u0442\u043e\u043c\u0443 \u0447\u0442\u043e \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0442 \u0437\u0430\u0434\u0430\u0447\u0438 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0441 \u043d\u0435\u0441\u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c\u0438 \u043a\u043b\u0430\u0441\u0441\u0430\u043c\u0438. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u044d\u0442\u043e \u043c\u043e\u0436\u0435\u0442 \u0437\u043d\u0430\u0447\u0438\u0442\u044c, \u0447\u0442\u043e \u0432 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435 \u043d\u0430\u043c\u043d\u043e\u0433\u043e \u0431\u043e\u043b\u044c\u0448\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u043e\u0432 0 \u043a\u043b\u0430\u0441\u0441\u0430. \u0412 \u0442\u0430\u043a\u0438\u0445 \u0441\u043b\u0443\u0447\u0430\u044f\u0445 \u043d\u0443\u0436\u043d\u043e 1) \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c accuracy \u043a\u0430\u043a \u043c\u0435\u0442\u0440\u0438\u043a\u0443 2) \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043c\u0435\u0442\u043e\u0434\u044b \u0431\u043e\u0440\u044c\u0431\u044b \u0441 imbalanced dataset (\u043e\u0431\u044b\u0447\u043d\u043e \u0435\u0441\u043b\u0438 \u0434\u0430\u0442\u0430\u0441\u0435\u0442 \u0441\u0438\u043b\u044c\u043d\u043e \u043d\u0435\u0441\u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0430\u043d, \u0442.\u0435. \u043a\u043b\u0430\u0441\u0441\u0430 1 \u0432 20 \u0440\u0430\u0437 \u043c\u0435\u043d\u044c\u0448\u0435 \u043a\u043b\u0430\u0441\u0441\u0430 0).","9370e6ba":"# \u041f\u0435\u0440\u0432\u0430\u044f \u0447\u0430\u0441\u0442\u044c. \u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u0435","7482432e":"# Kaggle (5 \u0431\u0430\u043b\u043b\u043e\u0432)\n\n\u041a\u0430\u043a \u0432\u044b\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0431\u0430\u043b\u043b\u044b:\n\n1) 1 >= roc auc > 0.84 \u044d\u0442\u043e 5 \u0431\u0430\u043b\u043b\u043e\u0432\n\n2) 0.84 >= roc auc > 0.7 \u044d\u0442\u043e 3 \u0431\u0430\u043b\u043b\u0430\n\n3) 0.7 >= roc auc > 0.6 \u044d\u0442\u043e 1 \u0431\u0430\u043b\u043b\n\n4) 0.6 >= roc auc \u044d\u0442\u043e 0 \u0431\u0430\u043b\u043b\u043e\u0432","83ee51b1":"\u0415\u0441\u0442\u044c \u0434\u0432\u0435 \u0447\u0430\u0441\u0442\u0438 \u044d\u0442\u043e\u0433\u043e \u0434\u043e\u043c\u0430\u0448\u043d\u0435\u0433\u043e \u0437\u0430\u0434\u0430\u043d\u0438\u044f: \n* \u0421\u0434\u0435\u043b\u0430\u0442\u044c \u043f\u043e\u043b\u043d\u043e\u0446\u0435\u043d\u043d\u044b\u0439 \u043e\u0442\u0447\u0435\u0442 \u043e \u0432\u0430\u0448\u0435\u0439 \u0440\u0430\u0431\u043e\u0442\u0435: \u043a\u0430\u043a \u0432\u044b \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043b\u0438 \u0434\u0430\u043d\u043d\u044b\u0435, \u043a\u0430\u043a\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u043f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u043b\u0438 \u0438 \u043a\u0430\u043a\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438\u0441\u044c (\u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 10 \u0431\u0430\u043b\u043b\u043e\u0432). \u0417\u0430 \u043a\u0430\u0436\u0434\u0443\u044e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u0443\u044e \u0447\u0430\u0441\u0442\u044c \u0431\u0443\u0434\u0435\u0442 \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0431\u0430\u043b\u043b\u043e\u0432.\n* \u041b\u0443\u0447\u0448\u0435\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432 \u0441\u043e\u0440\u0435\u0432\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043d\u0430 [kaggle](https:\/\/www.kaggle.com\/c\/advanced-dls-spring-2021\/) (\u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 5 \u0431\u0430\u043b\u043b\u043e\u0432). \u0417\u0430 \u043f\u0440\u043e\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u0440\u043e\u0433\u043e\u0432 \u0431\u0443\u0434\u0443\u0442 \u043d\u0430\u0447\u0438\u0441\u043b\u044f\u0442\u044c\u0441\u044f \u0431\u0430\u043b\u043b\u044b.\n\n\n**\u041e\u0431\u0435 \u0447\u0430\u0441\u0442\u0438 \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c\u0441\u044f \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 peer-review. \u0422.\u0435. \u0432\u0430\u0448\u0443 \u043f\u043e\u0441\u044b\u043b\u043a\u0443 \u043d\u0430 \u0441\u0442\u0435\u043f\u0438\u043a \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0434\u0440\u0443\u0433\u0438\u0445 \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u043e\u0432 \u0438 \u0430\u0433\u0433\u0440\u0435\u0433\u0430\u0446\u0438\u044f \u0438\u0445 \u043e\u0446\u0435\u043d\u043e\u043a \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0430. \u0412 \u0442\u043e \u0436\u0435 \u0432\u0440\u0435\u043c\u044f \u0432\u0430\u043c \u0442\u043e\u0436\u0435 \u043d\u0443\u0436\u043d\u043e \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0447\u0435\u043d\u0438\u043a\u043e\u0432.**\n\n**\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0434\u0435\u043b\u0430\u0439\u0442\u0435 \u0441\u0432\u043e\u044e \u0440\u0430\u0431\u043e\u0442\u0443 \u0447\u0438\u0441\u0442\u043e\u0439 \u0438 \u043f\u043e\u043d\u044f\u0442\u043d\u043e\u0439, \u0447\u0442\u043e\u0431\u044b \u043e\u0431\u043b\u0435\u0433\u0447\u0438\u0442\u044c \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443. \u0415\u0441\u043b\u0438 \u0443 \u0432\u0430\u0441 \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0441 \u0440\u0435\u0448\u0435\u043d\u0438\u0435\u043c \u0438\u043b\u0438 \u0445\u043e\u0447\u0435\u0442\u0441\u044f \u0441\u043e\u0432\u0435\u0442\u0430, \u0442\u043e \u043f\u0438\u0448\u0438\u0442\u0435 \u0432 \u043d\u0430\u0448 \u0447\u0430\u0442 \u0432 \u0442\u0435\u043b\u0435\u0433\u0440\u0430\u043c\u0435 \u0438\u043b\u0438 \u0432 \u043b\u0441 @runfme. \u0415\u0441\u043b\u0438 \u0432\u044b \u0437\u0430\u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u0440\u043e\u0430\u043f\u043f\u0435\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0446\u0435\u043d\u043a\u0443, \u0442\u043e \u043f\u0438\u043f\u0448\u0438\u0442\u0435 \u0432 \u043b\u0441 @runfme.**\n\n**\u0412\u043e \u0432\u0441\u0435\u0445 \u043f\u0443\u043d\u043a\u0442\u0430\u0445 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u044f \u044d\u0442\u043e \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u043d\u0430\u0431\u043e\u0440 \u0432\u0435\u0449\u0435\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u0442\u043e\u0438\u0442 \u0441\u0434\u0435\u043b\u0430\u0442\u044c. \u0415\u0441\u043b\u0438 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u043a\u0430\u043a\u043e\u0439-\u0442\u043e \u0448\u0430\u0433 \u043b\u0443\u0447\u0448\u0435 \u0438\u043b\u0438 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0447\u0442\u043e-\u0442\u043e \u0441\u0432\u043e\u0435 - \u0434\u0435\u0440\u0437\u0430\u0439\u0442\u0435!**","cefb0681":"# \u041f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u044f","8a8636cb":"## \u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 (2 \u0431\u0430\u043b\u043b\u0430)\n\n1) \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435 \u043d\u0430 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u044b\u0435 \u0441\u0442\u0440\u043e\u0447\u043a\u0438. \n\n2) \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435, \u0435\u0441\u0442\u044c \u043b\u0438 \u0432 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435 \u043d\u0435\u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f (nan'\u044b) \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e data.isna() \u0438\u043b\u0438 data.info() \u0438, \u0435\u0441\u043b\u0438 \u043d\u0443\u0436\u043d\u043e, \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u0435 \u0438\u0445 \u043d\u0430 \u0447\u0442\u043e-\u0442\u043e. \u0411\u0443\u0434\u0435\u0442 \u0445\u043e\u0440\u043e\u0448\u043e, \u0435\u0441\u043b\u0438 \u0432\u044b \u043f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u0435 \u0442\u0430\u0431\u043b\u0438\u0447\u043a\u0443 \u0441 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e\u043c nan \u0432 \u043a\u0430\u0436\u0434\u043e\u0439 \u043a\u043e\u043b\u043e\u043d\u043a\u0435.","5f6da5b0":"## \u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442\u043d\u043e\u0433\u043e \u0431\u0443\u0441\u0442\u0438\u043d\u0433\u0430 (2 \u0431\u0430\u043b\u043b\u0430)\n\n\u0415\u0441\u043b\u0438 \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0431\u0430\u043b\u043b\u044b \u0437\u0430 \u0442\u043e\u0447\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442, \u0442\u043e \u0441\u0442\u043e\u0438\u0442 \u043f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442\u043d\u044b\u0439 \u0431\u0443\u0441\u0442\u0438\u043d\u0433. \u0427\u0430\u0441\u0442\u043e \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442\u043d\u044b\u0439 \u0431\u0443\u0441\u0442\u0438\u043d\u0433 \u0441 \u0434\u0435\u0444\u043e\u043b\u0442\u043d\u044b\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 \u0434\u0430\u0441\u0442 \u0432\u0430\u043c 80% \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0437\u0430 0% \u0443\u0441\u0438\u043b\u0438\u0439.\n\n\u041c\u044b \u0431\u0443\u0434\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c catboost, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043d\u0430\u043c \u043d\u0435 \u043d\u0430\u0434\u043e \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438. catboost \u0441\u0434\u0435\u043b\u0430\u0435\u0442 \u044d\u0442\u043e \u0441\u0430\u043c (\u0432 .fit() \u043d\u0430\u0434\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c cat_features=cat_cols). \u0410 \u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438 \u043d\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0435\u0439, \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043d\u0430 \u0434\u0435\u0440\u0435\u0432\u044c\u044f\u0445 \u043d\u0435 \u043d\u0443\u0436\u043d\u043e.\n\n1) \u0420\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435 \u0432\u044b\u0431\u043e\u0440\u043a\u0443 \u043d\u0430 train\/valid. \u041f\u0440\u043e\u0442\u0435\u0441\u0442\u0438\u0440\u0443\u0439\u0442\u0435 catboost c\u043e \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438.\n\n2) \u041f\u0440\u043e\u0442\u0435\u0441\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u0440\u0430\u0437\u043d\u044b\u0435 \u0437\u0430\u043d\u0447\u0435\u043d\u0438\u044f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0430 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0434\u0435\u0440\u0435\u0432\u044c\u0435\u0432 \u0438 learning_rate'\u0430 \u0438 \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043b\u0443\u0447\u0448\u0443\u044e \u043f\u043e \u043c\u0435\u0442\u0440\u0438\u043a\u0435 ROC-AUC \u043a\u043e\u043c\u0431\u0438\u043d\u0430\u0446\u0438\u044e. \n\n(\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e) \u0415\u0441\u0442\u044c \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0441 \u0442\u0435\u043c, \u0447\u0442\u043e\u0431\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c CatBoostClassifier \u0432\u043c\u0435\u0441\u0442\u0435 \u0441 GridSearchCV, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043c\u044b \u043d\u0435 \u043f\u0440\u043e\u0441\u0438\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u0440\u043e\u0441\u0441\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044e. \u041d\u043e \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c)"}}