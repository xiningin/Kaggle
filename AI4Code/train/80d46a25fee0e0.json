{"cell_type":{"ffa715ba":"code","c009c3bf":"code","48934f65":"code","5d884fe2":"code","ba285dac":"code","655add59":"code","fa8eac41":"code","942ede7e":"code","0bb3b2b7":"code","5b5d9c0f":"code","c5afab84":"code","24ff4ce3":"code","2374b598":"code","f5ea89d3":"code","6e06f14c":"code","78bc7c61":"code","8e0e39d3":"code","2837e203":"code","f72d7b07":"code","abd61a98":"code","a24de31a":"code","2ccb556e":"code","13fc813b":"code","5fc1578b":"code","1583d28f":"code","5742e4be":"code","02a3d24f":"code","04859933":"code","bba5e378":"code","cf59ff25":"code","92e16944":"code","36558686":"code","9d293890":"code","620b0da6":"code","4a8ad907":"code","0017ddcb":"code","c3440629":"code","2bf597d0":"code","021a97e2":"code","68545fc2":"code","f8d8ab0b":"code","eb191dd7":"code","0c68cf21":"code","7133d77b":"code","f711ceff":"code","dfc16019":"code","fdb74937":"code","6e17114d":"markdown","ab6397d5":"markdown","f678165a":"markdown","c67e9c51":"markdown","bb14f9ef":"markdown","68c39796":"markdown","16f861e4":"markdown","adc70757":"markdown","02afc25c":"markdown","8b2a8c26":"markdown","2c1fd3fe":"markdown","5007fa0b":"markdown","a8d86fa9":"markdown","c61adf44":"markdown","ee207529":"markdown","f4a94b70":"markdown","e1421464":"markdown","64ca1ad2":"markdown","ebdca026":"markdown","d20c9aaa":"markdown","8765fed6":"markdown","72ba0a98":"markdown","5165a380":"markdown","4dea5666":"markdown","548f4709":"markdown","f6ecf270":"markdown","6da66467":"markdown","d17566d8":"markdown","34120af7":"markdown","646bc5f5":"markdown","12c0b0ec":"markdown","1474ffd5":"markdown","7e1b20fd":"markdown","61e0c94d":"markdown","03e831e0":"markdown","7f6a1009":"markdown","cae90b04":"markdown"},"source":{"ffa715ba":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import plot_confusion_matrix, f1_score, recall_score, precision_score, accuracy_score","c009c3bf":"heart_failure=pd.read_csv('..\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv',header=0)","48934f65":"heart_failure.head()","5d884fe2":"heart_failure.shape","ba285dac":"heart_failure.describe()","655add59":"heart_failure.columns=['age', 'anaemia', 'creatinine_phosphokinase', 'diabetes',\n       'ejection_fraction', 'high_blood_pressure', 'platelets',\n       'serum_creatinine', 'serum_sodium', 'sex', 'smoking', 'time',\n       'death_event']\n\nheart_failure.head()","fa8eac41":"to_update={'age':float, 'anaemia':bool, 'creatinine_phosphokinase':int, 'diabetes':bool,\n       'ejection_fraction':int, 'high_blood_pressure':bool, 'platelets':float,\n       'serum_creatinine':float, 'serum_sodium':float, 'sex':bool, 'smoking':bool, 'time':int,\n       'death_event':bool}\n\nheart_failure=heart_failure.astype(to_update)\nheart_failure.info()","942ede7e":"plt.scatter(x=heart_failure['age'],y=heart_failure['death_event'],color='red')\n#plt.figsize(10,10)","0bb3b2b7":"heart_failure['age'].plot(kind='hist', bins=15,figsize=(10,10))","5b5d9c0f":"heart_failure['ejection_fraction'].plot(kind='hist',bins=15,figsize=(10,10))","c5afab84":"heart_failure['creatinine_phosphokinase'].plot(kind='hist',bins=15,figsize=(10,10))","24ff4ce3":"heart_failure['platelets'].plot(kind='hist',bins=15,figsize=(10,10))","2374b598":"heart_failure['serum_creatinine'].plot(kind='hist',bins=15,figsize=(10,10))","f5ea89d3":"heart_failure['serum_sodium'].plot(kind='hist',bins=15,figsize=(10,10))","6e06f14c":"heart_failure['anaemia'].astype(int).plot(kind='hist')","78bc7c61":"heart_failure['high_blood_pressure'].astype(int).plot(kind='hist',bins=10)","8e0e39d3":"heart_failure['diabetes'].astype(int).plot(kind='hist',bins=10)","2837e203":"heart_failure['smoking'].astype(int).plot(kind='hist',bins=10)","f72d7b07":"heart_failure['death_event'].astype(int).plot(kind='hist',bins=10)","abd61a98":"deaths=heart_failure[heart_failure['death_event']==True]\ndeaths.shape","a24de31a":"deaths.describe()","2ccb556e":"a=deaths['anaemia'].sum()\nb=deaths['diabetes'].sum()\nc=deaths['high_blood_pressure'].sum()\n\nto_print=\"Anaemic: {}, had diabetes: {}, had high blood pressure:{}\".format(a,b,c)\nprint(to_print)","13fc813b":"a=np.logical_and(deaths['anaemia']==True,deaths['diabetes']==True)\ndeaths[np.logical_and(a,deaths['high_blood_pressure']==True)]['age'].count()","5fc1578b":"#deaths[].plot(kind='hist',subplots=True,figsize=(10,10))\n\n['age','creatinine_phosphokinase','ejection_fraction','platelets','serum_creatinine','serum_sodium']\n\n","1583d28f":"deaths['age'].plot(kind='hist',figsize=(10,10))","5742e4be":"deaths['creatinine_phosphokinase'].plot(kind='hist',figsize=(10,10))","02a3d24f":"deaths['ejection_fraction'].plot(kind='hist',figsize=(10,10))","04859933":"deaths['platelets'].plot(kind='hist',figsize=(10,10))","bba5e378":"deaths['serum_creatinine'].plot(kind='hist',figsize=(10,10))","cf59ff25":"deaths['serum_sodium'].plot(kind='hist',figsize=(10,10))","92e16944":"df = heart_failure.drop(['time'], axis=1)\nf = plt.figure(figsize=(16, 15))\nplt.matshow(df.corr(), fignum=f.number)\nplt.xticks(range(df.shape[1]), df.columns, fontsize=14, rotation=45)\nplt.yticks(range(df.shape[1]), df.columns, fontsize=14)\ncb = plt.colorbar()\ncb.ax.tick_params(labelsize=14)","36558686":"from sklearn.model_selection import train_test_split","9d293890":"X=np.asarray(heart_failure[['age', 'anaemia', 'creatinine_phosphokinase', 'diabetes',\n       'ejection_fraction', 'high_blood_pressure', 'platelets',\n       'serum_creatinine', 'serum_sodium', 'sex', 'smoking', 'time']])\n\nY=np.asarray(heart_failure[['death_event']])","620b0da6":"X_train, X_test, y_train, y_test = train_test_split( X, Y, test_size=0.3, random_state=4)\nprint ('Train set:', X_train.shape,  y_train.shape)\nprint ('Test set:', X_test.shape,  y_test.shape)","4a8ad907":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import plot_confusion_matrix\nLR = LogisticRegression(C=0.01, solver='liblinear').fit(X_train,y_train)\nLR","0017ddcb":"yhat = LR.predict(X_test)\n#yhat","c3440629":"yhat_prob = LR.predict_proba(X_test)\n#yhat_prob","2bf597d0":"#from sklearn.metrics import jaccard_similarity_score\n#jaccard_similarity_score(y_test, yhat)","021a97e2":"print('Classification f1-score', f1_score(y_test, yhat))\nprint('Classification precision', precision_score(y_test, yhat))\nprint('Classification recall', recall_score(y_test, yhat))","68545fc2":"X1=np.asarray(heart_failure[['anaemia', 'creatinine_phosphokinase', 'diabetes',\n       'ejection_fraction', 'high_blood_pressure', 'platelets',\n       'serum_creatinine', 'serum_sodium', 'sex', 'smoking', 'time']])\n\nY1=np.asarray(heart_failure[['death_event']])","f8d8ab0b":"X_train1, X_test1, y_train1, y_test1 = train_test_split( X1, Y1, test_size=0.3, random_state=4)\nprint ('Train set:', X_train1.shape,  y_train1.shape)\nprint ('Test set:', X_test1.shape,  y_test1.shape)","eb191dd7":"LR1 = LogisticRegression(C=0.01, solver='liblinear').fit(X_train1,y_train1)\nLR1","0c68cf21":"yhat1 = LR1.predict(X_test1)\nyhat1","7133d77b":"yhat_prob1 = LR1.predict_proba(X_test1)\n#yhat_prob1","f711ceff":"#jaccard_similarity_score(y_test1, yhat1)","dfc16019":"plot_confusion_matrix(LR1, X_test1, y_test1)\nplt.show()","fdb74937":"print('Classification f1-score', f1_score(y_test1, yhat1))\nprint('Classification precision', precision_score(y_test1, yhat1))\nprint('Classification recall', recall_score(y_test1, yhat1))","6e17114d":"Only 6 out of the 96 people who died due to congestive heart failure suffered from all three conditions. This means, each of these conditions seperately are extremely leathal ","ab6397d5":"<p1><b>Platelets counts of those affected people are slightly on the lower side.<\/b><\/p1>","f678165a":"<h3>Distribution of Platelets<\/h3>","c67e9c51":"As there are no missing values or junk values, we dont have to alter the data set much. We can proceed with building the classification model to predict the chances of getting affected by Congestive Heart Failure","bb14f9ef":"<h3>Distribution of Serum Creatinine<\/h3>","68c39796":"<h3>Lets focus on cases where death event happened<\/h3>","16f861e4":"<p1>\n<ol>\n    <li>Women->1<\/li>\n    \n<\/ol>\n\n<\/p1>","adc70757":"<h2>Lets plot Age and Death event<\/h2>","02afc25c":"Distribution of Serum Sodium","8b2a8c26":"<img src='\/Users\/akash-5162\/Desktop\/chf.jpg'>","2c1fd3fe":"<p1>Congestive Heart Failure is top cause of death worldwide. <\/p1>","5007fa0b":"<h3>Distribution of Ejection Fraction<\/h3>","a8d86fa9":"<h3>Distribution of other boolean variables<\/h3>","c61adf44":"Lets plot the various attributes present in the data set to see which of them could be use in our prediction","ee207529":"<h2>Lets check other effeciency measuring metrics<\/h2>","f4a94b70":"<p1><b>Ejection Fraction, however offers an interesting insight. We see that the ejection fraction value is mostly centered around 20 to 30. However the average value of the data set happens to be between 30 to 40. Hence this could be used as a parameter<\/b><\/p1>","e1421464":"As we can see, several columns likes diabetes, anaemia, etc are of the type float rather than Boolean. Lets sort this issue","64ca1ad2":"Removing age as certainly improved the effeciency of the model","ebdca026":"<h2>Lets make sure that the column names are all uniform<\/h2>","d20c9aaa":"<b>As we saw, the age can't be used as a deciding factor. Hence lets drop the factor 'age' from our model and see its impace on our model effeciency<\/b>","8765fed6":"There are 299 samples, with 13 variable each in this data set. We would have to create a model based on this data. To make our model more effecient, we would be splitting this data set into testing and training set","72ba0a98":"Distribution of Platelets","5165a380":"<h1>Congestive Heart Failure Analysis<\/h1>","4dea5666":"How many people who died had all three","548f4709":"<p1><b>As we can see, there are no unusual trend in the distribution of Creatinine Phosphokinase. Most people has a value between 0 to 1000, which is how it is for normal people as well. Hence this might not be an important factor contributing to Congestive heart failure.<\/b><\/p1>","f6ecf270":"<h2>Lets understand the data better!<\/h2>","6da66467":"As it can be seen, we don't have concrete evidence to say that age has a strong triggering factor of Congestive Heart Failure","d17566d8":"<h3>Distribution of Serum Sodium<\/h3>","34120af7":"Distribution of Ejection Fraction","646bc5f5":"Distribution of Creatinine Phosphokinase","12c0b0ec":"<h2>jaccard index<\/h2>\nLets try jaccard index for accuracy evaluation. we can define jaccard as the size of the intersection divided by the size of the union of two label sets. If the entire set of predicted labels for a sample strictly match with the true set of labels, then the subset accuracy is 1.0; otherwise it is 0.0","1474ffd5":"<h3>Distribution of Creatinine Phosphokinase<\/h3>","7e1b20fd":"Distribution of Age","61e0c94d":"Distribution of Serum Creatinine","03e831e0":"Lets see how many of the 96 people were anaemic, had diabetes, and high blood pressure","7f6a1009":"<h3>Distribution of Age<\/h3>","cae90b04":"Lets see the distribution of variables of for the death case"}}