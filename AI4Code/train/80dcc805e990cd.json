{"cell_type":{"c1ab644c":"code","14579647":"code","2774bf9c":"code","a6d5f412":"code","f4c085aa":"code","b4bc4143":"code","a12397a8":"code","e2b9ba72":"code","de9baad0":"code","3aef7488":"code","37ee11ed":"code","caad0e94":"code","0435b7e1":"code","adcce964":"code","05d8b759":"code","8e326202":"code","c14ff7b7":"code","2f41a8a6":"code","933440a0":"code","5b5a1bdc":"code","2438ae69":"code","e36bb4d0":"code","54b65ea6":"code","0474dfd6":"code","41cbb58b":"code","5f7e927a":"code","2fe71afb":"code","bc37ad02":"code","40cfef34":"code","72a34bda":"code","ec3c044b":"code","1f28b7e7":"code","c978bb69":"markdown","64baa0d8":"markdown"},"source":{"c1ab644c":"from IPython.core.display import display, HTML\ndisplay(HTML(\"<style>.container {width:90% !important;}<\/style>\"))\n\n\n\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nsns.set_style('dark')\nimport matplotlib.pyplot as plt\n\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\ntrain_path='\/kaggle\/input\/titanic\/train.csv'\ntest_path='\/kaggle\/input\/titanic\/test.csv'\ntitanic_train=pd.read_csv(train_path)\ntitanic_test=pd.read_csv(test_path)\n\n","14579647":"titanic_train.head()","2774bf9c":"titanic_test.head()","a6d5f412":"titanic_train.describe()","f4c085aa":"titanic_train.describe(include ='O')","b4bc4143":"titanic_train.info()","a12397a8":"sns.pairplot(data = titanic_train)","e2b9ba72":"titanic_train['Survived'].value_counts().plot(kind = 'pie',autopct='%1.1f%%')","de9baad0":"age_means = titanic_train['Age'].mean()\ntitanic_train['Age'].fillna(age_means, inplace = True)\n\ncount, bin_dividers = np.histogram(titanic_train['Age'], bins = 8)\nbin_names = ['10\uc138\u25bc','10\ub300','20\ub300','30\ub300','40\ub300','50\ub300','60\ub300','70\ub300\u25b2']\n\ntitanic_train['Age_cut'] = pd.cut(titanic_train['Age'], bins = bin_dividers, labels = bin_names, include_lowest=True)","3aef7488":"titanic_train['Age_cut'].value_counts()","37ee11ed":"fare_means = titanic_train['Fare'].mean()\ntitanic_train['Fare'].fillna(fare_means, inplace = True)\ncount, bin_dividers_Fare = np.histogram(titanic_train['Fare'], bins=6)\nbin_name = ['85\u25bc','85','170','256','341','426\u25b2']\ntitanic_train['Fare_cut'] = pd.cut(titanic_train['Fare'], bins = bin_dividers_Fare, labels = bin_name, include_lowest=True)","caad0e94":"hist_col = ['Age_cut', 'SibSp','Parch','Fare_cut']\nfig, axe = plt.subplots(1,4 , figsize=(20,5))\nx = 0\nfor i in hist_col:\n    sns.barplot(x = i, y = 'Survived' ,data = titanic_train, ax = axe.flatten()[x])\n    x+=1\nfig.tight_layout()","0435b7e1":"titanic_train['Cabin']\n","adcce964":"titanic_train['Cabin'] = titanic_train['Cabin'].str[:1]\ntitanic_train['Embarked'].fillna('S', inplace = True)\ntitanic_train['Cabin'].fillna('X', inplace = True)\n","05d8b759":"dist_col = ['Sex', 'Cabin', 'Embarked']\nff, axx = plt.subplots(1,3, figsize = (12,5))\nx = 0\nfor i in dist_col:\n    sns.countplot(x = i,hue = 'Survived', data = titanic_train, ax = axx.flatten()[x])\n    x+=1\nff.tight_layout()","8e326202":"f, ax = plt.subplots(1,2,figsize=(12,5))\ntable = titanic_train.pivot_table(index = ['Sex','Survived'], columns =['Pclass'], aggfunc='size')\nsns.heatmap(table, annot = True, fmt='d', cmap = 'YlGnBu', linewidth = .5, cbar = False, ax = ax[0])\nsns.barplot(x= 'Sex', y='Survived', hue = 'Pclass', data = titanic_train, ax = ax[1])\n","c14ff7b7":"fff, axx = plt.subplots(1,4,figsize=(20,5))\nsns.barplot(x='Embarked', y='Age',hue='Survived', data=titanic_train, ax=axx[0])\nsns.barplot(x='Embarked', y='Fare',hue='Survived', data=titanic_train, ax=axx[1])\nsns.barplot(x='Embarked', y='SibSp',hue='Survived', data=titanic_train, ax=axx[2])\nsns.barplot(x='Embarked', y='Parch',hue='Survived', data=titanic_train, ax=axx[3])","2f41a8a6":"fff, axx = plt.subplots(1,4,figsize=(20,5))\nsns.barplot(x='Pclass', y='Age',hue='Survived', data=titanic_train, ax=axx[0])\nsns.barplot(x='Pclass', y='Fare',hue='Survived', data=titanic_train, ax=axx[1])\nsns.barplot(x='Pclass', y='SibSp',hue='Survived', data=titanic_train, ax=axx[2])\nsns.barplot(x='Pclass', y='Parch',hue='Survived', data=titanic_train, ax=axx[3])","933440a0":"sns.lmplot('Fare', 'Survived', data=titanic_train)","5b5a1bdc":"import re\n\ndef cleaning(x):\n    tikets = re.compile('[^a-zA-z+]')\n    clean_ticket = tikets.sub('', x)\n    return clean_ticket\n\ntitanic_train['Ticket_cut'] = titanic_train['Ticket'].apply(lambda x : cleaning(x))\ntitanic_train['Ticket_cut'].replace('', 'number', inplace = True)\n","2438ae69":"plt.subplots(1,1,figsize = (40,20))\nsns.countplot(x= 'Ticket_cut', hue = 'Survived', data =titanic_train)","e36bb4d0":"titanic_train['Ticket_cut'].value_counts()","54b65ea6":"titanic_train['Family'] = titanic_train['SibSp'] + titanic_train['Parch']\ntable = titanic_train.pivot_table(index = ['Survived'], columns =['Family'], aggfunc='size')\n\nfig, ax = plt.subplots(1,2, figsize=(20,5))\nsns.heatmap(table, annot = True, cmap = 'YlGnBu', linewidth = .5, cbar = False, ax = ax[0])\nsns.countplot('Family', hue='Survived', data = titanic_train, ax = ax[1])","0474dfd6":"titanic_train['Name_cut'] = titanic_train['Name'].str.extract(' ([A-Za-z]+)\\.', expand=False)\n\n\ntitanic_train['Name_cut'] = titanic_train['Name_cut'].replace(['Lady', 'Countess','Capt', 'Col','Don', 'Dr', 'Major', 'Rev', 'Sir', 'Jonkheer', 'Dona'], 'Other')\ntitanic_train['Name_cut'] = titanic_train['Name_cut'].replace(['Mlle','Mme','Ms','Mr'], 'Other')\ntitanic_train['Name_cut'] = titanic_train['Name_cut'].replace(['Mrs'], 'Miss')\ntitanic_train['Name_cut'].value_counts()","41cbb58b":"sns.countplot(x = 'Name_cut', hue = 'Survived', data = titanic_train)","5f7e927a":"from sklearn.preprocessing import LabelEncoder\n\ntitanic_train=pd.read_csv(train_path)\ntitanic_test=pd.read_csv(test_path)\n\ndef data_clean(df):\n    \n    def cleaning(x):\n        tikets = re.compile('[^a-zA-z+]')\n        clean_ticket = tikets.sub('', x)\n        return clean_ticket\n    \n\n    df.drop('Name', axis = 1, inplace = True)\n    df['Age'].fillna(df['Age'].mean(), inplace = True)\n    df['Cabin'].fillna('X', inplace = True)\n    df['Embarked'].fillna('S', inplace= True)\n    \n    for i in range(len(df['Age'])):\n        if df['Age'][i] <= 10:\n            df['Age'][i] = 1\n        elif df['Age'][i] <= 30:\n            df['Age'][i] = 2\n        elif df['Age'][i] <= 50:\n            df['Age'][i] = 3\n        else:\n            df['Age'][i] = 4\n            \n    for i in range(len(df['Fare'])):\n        if df['Fare'][i] <= 7.910400:\n            df['Fare'][i] = 1\n        elif df['Fare'][i] <= 14.454200:\n            df['Fare'][i] = 2\n        elif df['Fare'][i] <= 31.000000:\n            df['Fare'][i] = 3\n        elif df['Fare'][i] <= 86:\n            df['Fare'][i] = 4\n        else:\n            df['Fare'][i] = 5\n            \n    \n    df['Cabin'] = df['Cabin'].str[:1]\n    \n    df['Ticket'] = df['Ticket'].apply(lambda x : cleaning(x))\n    df['Ticket'].replace('', 'number', inplace = True)\n    \n    df['Family'] = df['SibSp'] + df['Parch']\n    \n    \n    \n    return df\n    \ndef Labelencoding(df):\n    \n    features = ['Cabin', 'Embarked', 'Sex', 'Ticket']\n    \n    for feature in features:\n        Le = LabelEncoder()\n        le = Le.fit(df[feature])\n        df[feature] = le.transform(df[feature])\n    return df\n\n\n\n    \ntitanic_train = data_clean(titanic_train)        \ntitanic_train = Labelencoding(titanic_train)\ntitanic_test = data_clean(titanic_test)\ntitanic_test = Labelencoding(titanic_test)","2fe71afb":"label = titanic_train['Survived']\ntitanic_train.drop('Survived', axis = 1 , inplace = True)\nX = titanic_train","bc37ad02":"titanic_test.columns","40cfef34":"from sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import KFold, GridSearchCV\nfrom xgboost import XGBRFClassifier,XGBClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier, GradientBoostingClassifier, ExtraTreesClassifier, VotingClassifier\n\nX_train, X_test, y_train, y_test = train_test_split(X,label, test_size = 0.2, random_state = 42)","72a34bda":"cv=KFold(n_splits=10, random_state=42)\n\nmodel=XGBRFClassifier()\nparam_grid={'booster' :['gbtree'],\n                 'max_depth':[4,6,8],\n                 'gamma':[0,1,2,3],\n                 'n_estimators':[250, 350, 450],\n                 'random_state':[42],\n                'learning_rate':[0.1]}\n\nxgbrf_clf =GridSearchCV(model, param_grid=param_grid,scoring = 'accuracy',cv = cv, n_jobs=-1)\n \n\nmodel=XGBClassifier()\nparam_grid={'booster' :['gbtree'],\n                 'max_depth':[4,6,8],\n                 'gamma':[0,1,2,3],\n                 'n_estimators':[250, 350, 450],\n                 'random_state':[42],\n                'learning_rate':[0.1]}\n\nxgb_clf =GridSearchCV(model, param_grid=param_grid,scoring = 'accuracy',cv = cv, n_jobs=-1)\n\nmodel=RandomForestClassifier()\nparam_grid={     \n                 'max_depth':[4,6,8],\n                 'n_estimators':[250, 350, 450],\n                 'max_features': ['auto'],\n                 'random_state':[42],\n            }\n\nrf_clf=GridSearchCV(model, param_grid=param_grid,scoring = 'accuracy',cv = cv, n_jobs=-1)\n\nada_clf_rf = AdaBoostClassifier(algorithm='SAMME.R',base_estimator=RandomForestClassifier(n_estimators=200, max_depth= 4, min_samples_leaf= 2, min_samples_split= 6),\n                             random_state=42,n_estimators=300,\n                            learning_rate = 0.1)\n\nada_clf_ds = AdaBoostClassifier(algorithm='SAMME.R',base_estimator=DecisionTreeClassifier(max_depth= 4, min_samples_leaf= 2, min_samples_split= 6),\n                             random_state=42,n_estimators=300,\n                            learning_rate = 0.1)\n\ngrd_clf = GradientBoostingClassifier(max_depth=2, n_estimators=250)","ec3c044b":"\n\nmodels=[\n        ('xgbrf_clf', xgbrf_clf),\n        ('xgb_clf', xgb_clf),\n        ('rf_clf', rf_clf),\n        ('ada_clf_rf', ada_clf_rf),\n        ('ada_clf_ds',ada_clf_ds),\n        ('grd_clf',grd_clf),\n    \n]\n\n\nvot_soft = VotingClassifier(estimators=models, voting='soft', n_jobs=-1)\nvot_soft.fit(X_train, y_train)\nsoft_pred = vot_soft.predict(titanic_test)","1f28b7e7":"a = pd.DataFrame({\n    'PassengerId' : titanic_test['PassengerId'],\n    'Survived' : soft_pred\n})\n\na.to_csv('good_score.csv', index = False)","c978bb69":"# \uc218\uce58\ud615 \ub370\uc774\ud130","64baa0d8":"# \ubc94\uc8fc\ud615 \ub370\uc774\ud130"}}