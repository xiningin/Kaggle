{"cell_type":{"8887c724":"code","32499459":"code","ea8eeffb":"code","07c696f4":"code","1e8daec7":"code","2b85f325":"code","3f2e33a9":"code","d36d833a":"code","a2f1fc9a":"code","1e1d34f4":"code","65e0af62":"code","121e689a":"code","144acffa":"code","b3b55279":"code","f8d97b5d":"code","d2246523":"code","0b300cf9":"code","07e36ec3":"code","8921178c":"code","98ba8b45":"markdown","2ad1c929":"markdown","c1620ba7":"markdown","c20a57c2":"markdown","98c0a8ca":"markdown","5e94ec31":"markdown","b59f9876":"markdown","5a5f2a5d":"markdown","f3cd2306":"markdown","bf04a815":"markdown","ca41df7f":"markdown","3f1db5c0":"markdown","9c344c29":"markdown","7e241068":"markdown","3dae67e4":"markdown"},"source":{"8887c724":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","32499459":"#Edit limit nunber of data per page to 1000\nimport requests\ncentercode = list(range(34,40))\ncenter = ['C','N','S','U','E','W']\ndf =pd.DataFrame()\nfor tmp in centercode:\n    url = 'https:\/\/www.nstda.or.th\/sims\/login\/index.php?class=AnnounceTable&order=&orderType=&page=1&limit=2000&id='+str(tmp)+'&proposalcode=&namethai=&school=&team=&adviser=&processstatusid=&masterId=&datesendproposal='\n    html = requests.get(url).content\n    df_list = pd.read_html(html)\n    df = df.append(df_list[-1])\n# df.head()","ea8eeffb":"from datetime import date\nfrom datetime import date\npath = '\/kaggle\/working\/ysc2021_'+''.join(str(date.today()).split('-'))+'.csv'\ndf.to_csv(path)","07c696f4":"print('First 2 digits of \u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23:',df['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].str[0:2].unique())\nprint('3rd digits of \u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23:',df['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].str[2:3].unique())\nprint('The 4th \u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 is','type.')\nprint(df['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].str[3:4].unique())\nprint('The 5-6th is topic.')\nprint(df['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].str[4:6].unique())\nprint('The 7th is center.')\nprint(df['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].str[6:7].unique())\nprint('The 8-12th is ID.')\nprint(len(df['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].str[7:12].unique()))\n\nfrom datetime import date\nprint('Total Applicants as of', date.today(),':',len(df))","1e8daec7":"!ls \/kaggle\/working -l\n!curl -O https:\/\/raw.githubusercontent.com\/githubdcw\/THSarabunNewFont\/master\/THSarabunNew.ttf \n!ls \/kaggle\/working -l","2b85f325":"from datetime import date\nfrom datetime import datetime\nfrom datetime import timedelta\n\nprint('Total Applicants as of', (datetime.now()+timedelta(hours=7)).strftime(\"%Y-%m-%d %H:%M:%S\"),':',len(df))\n\nstatus = df['\u0e2a\u0e16\u0e32\u0e19\u0e30 (Status)'].unique()\n# print(status)\ndf_submit = df.loc[df['\u0e2a\u0e16\u0e32\u0e19\u0e30 (Status)'] == status[1]]\nprint('[\u0e25\u0e07\u0e17\u0e30\u0e40\u0e1a\u0e35\u0e22\u0e19]: ',len(df),' projects.')\nprint('[\u0e2a\u0e48\u0e07\u0e02\u0e49\u0e2d\u0e40\u0e2a\u0e19\u0e2d\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23\u0e41\u0e25\u0e49\u0e27]: ',len(df_submit),'projects =', \"{:.2f}%\".format(100 *len(df_submit)\/len(df)))\n\ncenter = df['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].str[6:7].unique()\nfor tmp in center:\n    tmp1=len(np.where(df['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].str[6:7] == tmp)[0])\n    tmp2=len(np.where((df['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].str[6:7] == tmp)&(df['\u0e2a\u0e16\u0e32\u0e19\u0e30 (Status)'] == status[1]))[0])\n    print('Center = ',tmp,'[\u0e25\u0e07\u0e17\u0e30\u0e40\u0e1a\u0e35\u0e22\u0e19]',tmp1,\\\n         '[\u0e2a\u0e48\u0e07\u0e02\u0e49\u0e2d\u0e40\u0e2a\u0e19\u0e2d\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23\u0e41\u0e25\u0e49\u0e27]',tmp2,\\\n         '\u0e04\u0e34\u0e14\u0e40\u0e1b\u0e47\u0e19 {:.2f}%'.format(100*tmp2\/tmp1))","3f2e33a9":"# print(df.loc[df['\u0e42\u0e23\u0e07\u0e40\u0e23\u0e35\u0e22\u0e19 (School)'].str.contains('\u0e01\u0e33') & df['\u0e1c\u0e39\u0e49\u0e1e\u0e31\u0e12\u0e19\u0e32 (Owner)'].str.contains('\u0e2d\u0e23')]['\u0e0a\u0e37\u0e48\u0e2d\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Name)'].tolist())\nprint(df.loc[df['\u0e42\u0e23\u0e07\u0e40\u0e23\u0e35\u0e22\u0e19 (School)'].str.contains('\u0e01\u0e33') & df['\u0e1c\u0e39\u0e49\u0e1e\u0e31\u0e12\u0e19\u0e32 (Owner)'].str.contains('\u0e2d\u0e23')])","d36d833a":"numberofproj = df_submit.groupby('\u0e42\u0e23\u0e07\u0e40\u0e23\u0e35\u0e22\u0e19 (School)').count()['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].\\\nsort_values(ascending=False)\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport matplotlib.font_manager as fm\nfontpath = '\/kaggle\/working\/THSarabunNew.ttf'\nfp = fm.FontProperties(fname=fontpath,size=20)\nplt.style.use('ggplot')\nx_pos = [i for i, _ in enumerate(numberofproj.index)]\nfig, ax = plt.subplots(figsize=(30, 30), subplot_kw=dict(aspect=\"equal\"))\nplt.xticks(x_pos,numberofproj.index,rotation=90,fontproperties=fp)\nax.bar(x_pos, numberofproj, color='green')\nplt.show()","a2f1fc9a":"numberofproj = df.groupby('\u0e42\u0e23\u0e07\u0e40\u0e23\u0e35\u0e22\u0e19 (School)').count()['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].\\\nsort_values(ascending=False)\n\nimport matplotlib.pyplot as plt\nimport matplotlib.pyplot as plt\nimport matplotlib.font_manager as fm\nfontpath = '\/kaggle\/working\/THSarabunNew.ttf'\nfig, ax = plt.subplots(figsize=(20, 20), subplot_kw=dict(aspect=\"equal\"))\n\nfp = fm.FontProperties(fname=fontpath,size=30)\nlabels = numberofproj.index\nsizes = numberofproj\n\nwedges, texts, autotexts = ax.pie(sizes,  autopct='%2.1f%%', startangle=90, textprops=dict(size=20))\n\nfor i in range(len(texts)):\n    texts[i].set_fontproperties(fp) # \u0e40\u0e1b\u0e25\u0e35\u0e48\u0e22\u0e19\u0e1f\u0e2d\u0e19\u0e15\u0e4c\u0e41\u0e25\u0e30\u0e02\u0e19\u0e32\u0e14\n\nax.legend(wedges, labels,\n          title=\"School\",\n          loc=\"center left\",\n          bbox_to_anchor=(1, 0, 0.5, 1),\n          prop = fp)\n\nax.set_title('Number of Projects by School')\nplt.show()","1e1d34f4":"import matplotlib.pyplot as plt\n%matplotlib inline\nimport matplotlib.font_manager as fm\nfontpath = '\/kaggle\/working\/THSarabunNew.ttf'\nfp = fm.FontProperties(fname=fontpath,size=20)\nplt.style.use('ggplot')\nx_pos = [i for i, _ in enumerate(numberofproj.index)]\nfig, ax = plt.subplots(figsize=(30, 30), subplot_kw=dict(aspect=\"equal\"))\nplt.xticks(x_pos,numberofproj.index,rotation=90,fontproperties=fp)\nax.bar(x_pos, numberofproj, color='green')\nplt.show()","65e0af62":"print('\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23\u0e08\u0e32\u0e01 \u0e42\u0e23\u0e07\u0e40\u0e23\u0e35\u0e22\u0e19\u0e2a\u0e32\u0e18\u0e34\u0e15\u0e2f')\nnumberofproj.loc[numberofproj.index.str.find('\u0e2a\u0e32\u0e18\u0e34\u0e15') == 0]","121e689a":"print('\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23\u0e08\u0e32\u0e01 \u0e42\u0e23\u0e07\u0e40\u0e23\u0e35\u0e22\u0e19\u0e40\u0e15\u0e23\u0e35\u0e22\u0e21\u0e2d\u0e38\u0e14\u0e21\u0e2f')\nnumberofproj.loc[numberofproj.index.str.contains('\u0e40\u0e15\u0e23\u0e35\u0e22\u0e21',regex=True)]","144acffa":"print('\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23\u0e08\u0e32\u0e01 \u0e42\u0e23\u0e07\u0e40\u0e23\u0e35\u0e22\u0e19\u0e27\u0e34\u0e17\u0e22\u0e32\u0e28\u0e32\u0e2a\u0e15\u0e23\u0e4c\u0e08\u0e38\u0e2c\u0e32\u0e20\u0e23\u0e13\u0e23\u0e32\u0e0a\u0e27\u0e34\u0e17\u0e22\u0e32\u0e25\u0e31\u0e22\u0e2f')\nnumberofproj.loc[numberofproj.index.str.find('\u0e27\u0e34\u0e17\u0e22\u0e32\u0e28\u0e32\u0e2a\u0e15\u0e23\u0e4c\u0e08\u0e38\u0e2c\u0e32\u0e20\u0e23\u0e13\u0e23\u0e32\u0e0a\u0e27\u0e34\u0e17\u0e22\u0e32\u0e25\u0e31\u0e22') == 0]","b3b55279":"print('\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23\u0e08\u0e32\u0e01 \u0e42\u0e23\u0e07\u0e40\u0e23\u0e35\u0e22\u0e19\u0e01\u0e33\u0e40\u0e19\u0e34\u0e14\u0e27\u0e34\u0e17\u0e22\u0e4c')\nn=numberofproj.loc[numberofproj.index.str.find('\u0e01\u0e33\u0e40\u0e19\u0e34\u0e14\u0e27\u0e34\u0e17\u0e22\u0e4c') == 0]\nprint(n.tolist()[0],'projects =',np.round(n.tolist()[0]*100\/numberofproj.sum(),1),'%')","f8d97b5d":"print('\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23\u0e08\u0e32\u0e01 \u0e42\u0e23\u0e07\u0e40\u0e23\u0e35\u0e22\u0e19\u0e21\u0e2b\u0e34\u0e14\u0e25\u0e27\u0e34\u0e17\u0e22\u0e32\u0e19\u0e38\u0e2a\u0e23\u0e13\u0e4c')\nn=numberofproj.loc[numberofproj.index.str.find('\u0e21\u0e2b\u0e34\u0e14\u0e25\u0e27\u0e34\u0e17\u0e22\u0e32\u0e19\u0e38\u0e2a\u0e23') == 0]\nprint(n.tolist()[0],'projects =',np.round(n.tolist()[0]*100\/numberofproj.sum(),1),'%')","d2246523":"print(numberofproj.loc[numberofproj == numberofproj.max()].index[0]+' has the maximun number of projects.')\nprint('There are ',numberofproj.loc[numberofproj == numberofproj.max()].tolist()[0],'projects or ',\\\n      np.round(numberofproj.loc[numberofproj == numberofproj.max()].tolist()[0]*100\/numberofproj.sum(),1),'%')\n","0b300cf9":"print(df['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].str[4:6].unique())","07e36ec3":"topics = df['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].str[4:6].unique()\ndata_val=[]\ndata_name =[]\nfor tmp in topics:  \n    data_name.append(tmp)\n    data_val.append(len(np.where(df['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].str[4:6] == tmp)[0]))\n\nimport matplotlib.pyplot as plt\nlabels = data_name\nsizes = data_val\nfig1, ax1 = plt.subplots()\nax1.pie(sizes, labels=labels, autopct='%2.0f%%',startangle=90)\nax1.axis('equal')  # Equal aspect ratio ensures that pie is drawn as a circle.\ntitle= 'Overall: % of Projects by Topic'\nplt.title(title)\nplt.show()   ","8921178c":"groupbyschool = df.groupby('\u0e42\u0e23\u0e07\u0e40\u0e23\u0e35\u0e22\u0e19 (School)')\nfor tmp1 in numberofproj.index:\n    df_school= groupbyschool.get_group(tmp1)\n    data_val=[]\n    data_name =[]\n    topics = df_school['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].str[4:6].unique()\n    for tmp in topics:  \n        data_name.append(tmp)\n        data_val.append(len(np.where(df_school['\u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)'].str[4:6] == tmp)[0]))\n\n    import matplotlib.pyplot as plt\n    labels = data_name\n    sizes = data_val\n    fig1, ax1 = plt.subplots()\n#     print(np.sum(sizes))\n    ax1.pie(sizes, labels=labels, autopct=lambda pct: np.round(pct*np.sum(sizes)\/100) ,startangle=90)\n    ax1.axis('equal')  # Equal aspect ratio ensures that pie is drawn as a circle.\n    title= tmp1+'\\n Total of '+str(np.sum(sizes))+'\\n Number of Projects by Topic'\n    plt.title(title,fontproperties=fp)\n    plt.show()\n","98ba8b45":"# Shool from which maximum number of projects are submitted is ..... ","2ad1c929":"Download link:  \n\n    https:\/\/www.nstda.or.th\/sims\/login\/index.php?class=AnnounceTable&order=&orderType=&page=1&limit=2000&id='+str(tmp)+'&proposalcode=&namethai=&school=&team=&adviser=&processstatusid=&masterId=&datesendproposal=\n\nRegional CODE for str(tmp)  \n* 38 = NE1 (North East region 1)   = E\n* 37 = NE2 (North East region 1)   = U\n* 35 = N   (North region)          = N\n* 34 = CE  (Center and East region)= C\n* 39 = W   (West region)           = W\n* 36 = S   (South region)          = S\n    \nID CODE  \n23Y(Type)(Area)(Region)(Number)  \n23Y(I|T)(BI|)(E|U|N|C|W|S)[0-9]{5}\n","c1620ba7":"# [\u0e2a\u0e48\u0e07\u0e02\u0e49\u0e2d\u0e40\u0e2a\u0e19\u0e2d\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23\u0e41\u0e25\u0e49\u0e27]","c20a57c2":"# Over all","98c0a8ca":"# Number of Projects by School  \n# ['\u0e44\u0e21\u0e48\u0e21\u0e35\u0e01\u0e32\u0e23\u0e2d\u0e31\u0e1e\u0e42\u0e2b\u0e25\u0e14\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23'+'\u0e2a\u0e48\u0e07\u0e02\u0e49\u0e2d\u0e40\u0e2a\u0e19\u0e2d\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23\u0e41\u0e25\u0e49\u0e27']","5e94ec31":"# Read Application Data from the web.","b59f9876":"YSC is Young Scientist Competition. It is a yearly event held by National Science and Technology Development Agency, NSTDA, Thailand. This is for young generation in Thailand to propose their science project ideas. ","5a5f2a5d":"# Write data to output as a .csv file","f3cd2306":"1. CS \u0e2a\u0e32\u0e02\u0e32\u0e27\u0e34\u0e17\u0e22\u0e32\u0e01\u0e32\u0e23\u0e04\u0e2d\u0e21\u0e1e\u0e34\u0e27\u0e40\u0e15\u0e2d\u0e23\u0e4c (Computer Science)\n2. PE \u0e2a\u0e32\u0e02\u0e32\u0e1f\u0e34\u0e2a\u0e34\u0e01\u0e2a\u0e4c \u0e1e\u0e25\u0e31\u0e07\u0e07\u0e32\u0e19 \u0e41\u0e25\u0e30\u0e14\u0e32\u0e23\u0e32\u0e28\u0e32\u0e2a\u0e15\u0e23\u0e4c (Physics, Energy and Astronomy)\n3. CH \u0e2a\u0e32\u0e02\u0e32\u0e40\u0e04\u0e21\u0e35 (Chemistry)\n4. MS \u0e2a\u0e32\u0e02\u0e32\u0e27\u0e31\u0e2a\u0e14\u0e38\u0e28\u0e32\u0e2a\u0e15\u0e23\u0e4c (Material Science)\n5. BI \u0e2a\u0e32\u0e02\u0e32\u0e0a\u0e35\u0e27\u0e27\u0e34\u0e17\u0e22\u0e32 (Biology)\n6. EN \u0e2a\u0e32\u0e02\u0e32\u0e27\u0e34\u0e28\u0e27\u0e01\u0e23\u0e23\u0e21\u0e28\u0e32\u0e2a\u0e15\u0e23\u0e4c (Engineering)\n7. MA \u0e2a\u0e32\u0e02\u0e32\u0e04\u0e13\u0e34\u0e15\u0e28\u0e32\u0e2a\u0e15\u0e23\u0e4c (Mathematical Sciences)\n8. EV \u0e2a\u0e32\u0e02\u0e32\u0e27\u0e34\u0e17\u0e22\u0e32\u0e28\u0e32\u0e2a\u0e15\u0e23\u0e4c\u0e2a\u0e34\u0e48\u0e07\u0e41\u0e27\u0e14\u0e25\u0e49\u0e2d\u0e21 (Environmental Science)","bf04a815":"# Loading Thai font from github.com","ca41df7f":"# Results by School","3f1db5c0":"# Number of Projects by School  \n# ['\u0e2a\u0e48\u0e07\u0e02\u0e49\u0e2d\u0e40\u0e2a\u0e19\u0e2d\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23\u0e41\u0e25\u0e49\u0e27']","9c344c29":"# Analyze \u0e23\u0e2b\u0e31\u0e2a\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23 (Project Code)\n\n* 23Y(I|T)(BI|)(E|U|N|C|W|S)[0-9]{5}","7e241068":"# Application ID Code","3dae67e4":"# Analyze projects by Topics"}}