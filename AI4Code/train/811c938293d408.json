{"cell_type":{"00031a50":"code","3242f128":"code","0a8bdf5c":"code","e68ab42f":"code","1e87e280":"markdown"},"source":{"00031a50":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport pickle\nimport re\nimport glob\n\ndef clean_text(txt):\n    return re.sub('[^A-Za-z0-9]+', ' ', str(txt).lower()).strip()","3242f128":"submission_df = pd.read_csv('..\/input\/coleridge-initiative-data\/submission.csv', index_col=0)\nsubmission_df['PredictionString'] = None\nindata = open('..\/input\/coleridge-initiative-data\/confirmed_databases.pickle','rb')\ndatabase_dict = pickle.load(indata)\nindata.close()\ndatasets_titles = database_dict['original'] #Fetch the original set of databases (and labels) that we know about\n#Test data has to be built\ntest_files = glob.glob(\"..\/input\/coleridgeinitiative-show-us-the-data\/test\/*.json\")\ndf_test_publications = pd.DataFrame()\n\nfor test_file in test_files:\n    file_data = pd.read_json(test_file)\n    file_data.insert(0,'pub_id', test_file.split('\/')[-1].split('.')[0])\n    df_test_publications = pd.concat([df_test_publications, file_data])\n\ndf_test_publications.to_csv(\"df_test_publications.csv\",index=False)\ndf_test_publications['text'] = df_test_publications['text'].str.lower()\ndf_train_publications = pd.read_csv('..\/input\/coleridge-initiative-data\/df_train_publications.csv')\n\ndf_train_publications.head(3)","0a8bdf5c":"df_test_publications.head(3)","e68ab42f":"labels = []\nfor index in submission_df.index:\n    print(index)\n    publication_text = df_test_publications[df_test_publications['pub_id'] == index].text.str.cat(sep='\\n').lower()\n    label = []\n    for dataset_title in datasets_titles:\n        if dataset_title in publication_text:\n            label.append(clean_text(dataset_title))\n    labels.append('|'.join(label))\n\nsubmission_df['PredictionString'] = labels\n\nsubmission_df.to_csv('submission.csv')\n\nsubmission_df","1e87e280":"The purpose of this notebook is to illustrate how to upload data from the coleridge-initiative-data dataset quickly\n"}}