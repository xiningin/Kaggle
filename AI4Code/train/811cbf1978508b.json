{"cell_type":{"8cc724d9":"code","16c645a0":"code","672e9f95":"code","64c91fa6":"code","371fe301":"code","8a85914b":"code","ce6b6db8":"code","2dbca153":"code","a4aa6303":"code","613322fc":"code","2bbacc44":"code","b0b4a89e":"code","de191aab":"code","8a3d0d95":"code","ad02c033":"code","a8bcb818":"code","8c78c50f":"code","0cc7cb7d":"code","44eac006":"code","aabe9031":"code","976fa10a":"code","71763f2d":"code","2e71d0de":"code","20ce8cfc":"code","e5196e8b":"code","ad224ed7":"code","01db0d29":"code","d5223777":"code","cd1f4c5a":"code","3b4a9653":"code","cb73ebae":"code","bee87a63":"code","ec954985":"markdown","4fae509e":"markdown","9684e4da":"markdown","0f8cac22":"markdown","7db8e66f":"markdown","44610871":"markdown","ef65e4d5":"markdown","d9862573":"markdown","2255fb3b":"markdown","89f3ac81":"markdown"},"source":{"8cc724d9":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","16c645a0":"df = pd.read_csv('..\/input\/santander-customer-satisfaction\/test.csv')\ndf","672e9f95":"y = df.TARGET","64c91fa6":"sns.countplot(y)","371fe301":"from sklearn.feature_selection import VarianceThreshold\n\nvari = VarianceThreshold(threshold=0.95)","8a85914b":"vari.fit(df)","ce6b6db8":"col = [col for col in df.columns if col not in df.columns[vari.get_support()]]","2dbca153":"len(col)","a4aa6303":"df.drop(col,axis=1,inplace=True)","613322fc":"### Feature selection Using Pearson Corelation","2bbacc44":"df","b0b4a89e":"def correlate(dataset,threshold):\n    col_cor= set()\n    cor_mat = dataset.corr()\n    for i in range(len(dataset.columns)):\n        for j in range (i):\n            if abs(cor_mat.iloc[i,j])> threshold:\n                col_cor.add(cor_mat.columns[i])\n    return col_cor\n            ","de191aab":"col = correlate(df,0.80)","8a3d0d95":"print(len(col))","ad02c033":"df.drop(col,axis=1, inplace=True)","a8bcb818":"df.drop('ID',axis=1, inplace=True)","8c78c50f":"pd.set_option(\"display.max_columns\",500)\ndf.describe()","0cc7cb7d":"import seaborn as sns\nplt.figure(figsize=(25,50))\n\nfor i in enumerate(df.columns):\n    plt.subplot(20,5,i[0]+1)\n    sns.boxplot(df[i[1]])","44eac006":"df['var3'].replace(-999999,2,inplace=True)","aabe9031":"from imblearn.under_sampling import NearMiss\nfrom imblearn.combine import SMOTETomek\n\nsmk = SMOTETomek(random_state=42)\nX_tr,Y_tr = smk.fit_resample(df,y)","976fa10a":"X_tr.shape,Y_tr.shape","71763f2d":"\"\"\"sns.heatmap(X_tr.corr())\"\"\"","2e71d0de":"## RFECV\n\"\"\"\nfrom sklearn.feature_selection import RFECV\nfrom sklearn.ensemble import RandomForestClassifier\n\nmodel = RandomForestClassifier(random_state=42)\nrfe = RFECV(estimator=model,cv=2,step=1,scoring='accuracy',n_jobs=3)\nrfe.fit(X_tr,Y_tr)\n\"\"\"","20ce8cfc":"\"\"\"from sklearn.model_selection import cross_val_score\nfrom sklearn.ensemble import RandomForestClassifier\nmodel = RandomForestClassifier(random_state =42)\n\ncros = cross_val_score(X_tr,Y_tr,estimator=model,cv=3,scoring='accuracy')\"\"\"","e5196e8b":"\"\"\"print(X_tr.columns[rfe.support_])\nprint(len(X_tr.columns[rfe.support_]))\"\"\"","ad224ed7":"\"\"\"plt.figure()\nplt.xlabel('Features')\nplt.ylabel('Accuracy')\nplt.plot(range(1,len(rfe.grid_scores_)+1),rfe.grid_scores_)\"\"\"","01db0d29":"X = X_tr[X_tr.columns[rfe.support_]]\nX","d5223777":"from xgboost import XGBClassifier\n\nmod = XGBClassifier(random_state = 42)\n\nmod.fit(X_tr,Y_tr)","cd1f4c5a":"test_df = pd.read_csv('..\/input\/santander-customer-satisfaction\/train.csv')\ntest_df1 = test_df[df.columns]\npre = mod.predict(test_df1)","3b4a9653":"subm = pd.read_csv('sample_submission.csv')\nsubm.TARGET = pre","cb73ebae":"subm","bee87a63":"subm.to_csv('sample_submission.csv',index=False)","ec954985":"we can able to find the columns since the data set has huge colums , lets write a function","4fae509e":"find missing Values","9684e4da":"### Feature Selection Using Variance","0f8cac22":"lets fix this imbalanced data set","7db8e66f":"we can see we are having an imbalanced data set","44610871":"since there are more variables we first do feature selection to remove unwanted columns","ef65e4d5":"lets Do one More feature selection","d9862573":"### Over Sampling\n\nthis methods even out the number of 0 classified targets with target classified as 1 by increasing the records ","2255fb3b":"we have 34 columns to be removed","89f3ac81":"we can see over 88 col are not needed here"}}