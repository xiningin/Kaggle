{"cell_type":{"1652fb3b":"code","3c643ef4":"code","76ff7d17":"code","1faa5ad1":"code","0eced59b":"code","f3194243":"code","d5a56944":"code","bc8e1023":"code","5fe0c21e":"code","481a2077":"code","fa74ccb4":"code","4abdab0d":"code","c645a96e":"code","c16d8cda":"code","928d19fc":"code","78184797":"code","d2c374c9":"code","e6ad8ef1":"code","3a5ef22b":"code","5815d43b":"code","361f2244":"code","ae326c32":"code","334b4e95":"code","532b2e79":"code","cf2210f6":"code","a8211e3b":"code","44499847":"code","ae033836":"code","faab781e":"code","3cd93f03":"code","ede1b3a2":"code","4b82a93c":"code","bb748d27":"code","eed09771":"code","c8035d2c":"code","ca067bdc":"code","86b682fb":"code","0ad572a3":"code","ce41376d":"code","cf5d03e8":"code","26695f48":"code","e28f0467":"code","510d1d44":"code","8d0c0c85":"markdown","a15170ba":"markdown","0933a936":"markdown","bb5c5734":"markdown","d8d3c006":"markdown","d97e6f7c":"markdown","d788906a":"markdown","a0549856":"markdown","a633a702":"markdown","4b9aa105":"markdown","1fbbff53":"markdown","1dc02e14":"markdown","d58a927f":"markdown","0dd9076c":"markdown","2f2d61bf":"markdown","6d427175":"markdown","ccaa24f3":"markdown","3f13ac8c":"markdown","14fbc678":"markdown"},"source":{"1652fb3b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","3c643ef4":"table_1 = pd.read_csv(\"\/kaggle\/input\/gufhtugu-publications-dataset-challenge\/GP Orders - 2.csv\")\ntable_2 = pd.read_csv(\"\/kaggle\/input\/gufhtugu-publications-dataset-challenge\/GP Orders - 4.csv\")\ntable_3 = pd.read_csv(\"\/kaggle\/input\/gufhtugu-publications-dataset-challenge\/GP Orders - 5.csv\")","76ff7d17":"print(table_1.columns)\nprint(table_2.columns)\nprint(table_3.columns)\nprint(table_1.shape)\nprint(table_2.shape)","1faa5ad1":"# join the Table_1 and table_2\ntable_1_2 = table_1.append(table_2, ignore_index=True, sort=True)","0eced59b":"# change the column name\ntable_1_2.rename(columns={'City (Billing)': 'City'}, inplace=True)\ntable_3.rename(columns={'Order Date & Time': 'Order Date'}, inplace=True)\n# print(table_1_2.columns)\n# print(table_3.columns)","f3194243":"# join table_1_2 and table_3\nfinal = table_1_2.append(table_3, ignore_index=True, sort=True)\nfinal_csv=final.to_csv(\"fnal.csv\")\nFinal=pd.read_csv(\"fnal.csv\")\n\npd.set_option('max_columns', None)\npd.set_option('max_rows', None)","d5a56944":"#Rename the Columns name\nFinal = Final.rename(columns={\"Book Name\": \"Book_Name\", \"Order Date\": \"Order_Date\",\n                              \"Order Number\": \"Order_NO\", \"Order Status\": \"Order_Status\",\n                             \"Payment Method\": \"Payment_Method\", \"Total items\": \"Total_items\",\n                              \"Total weight (grams)\": \"Total_weight_(gram)\"})\n#del(Final[\"Unnamed: 0\"])\n#print(Final.columns)\n#print(Final.head())","bc8e1023":"Final[\"Book_Name\"] = Final[\"Book_Name\"].str.split(\"\/\")\nFinal = Final.explode(\"Book_Name\", ignore_index=True)\nFinal[\"Book_Name\"] = Final[\"Book_Name\"].str.split(\"?\")\nFinal = Final.explode(\"Book_Name\", ignore_index=True)\nFinal[\"Book_Name\"] = Final[\"Book_Name\"].str.split(\"- \")\nFinal = Final.explode(\"Book_Name\", ignore_index=True)\nFinal= Final.replace(to_replace=r\"^\\s*$\", value=np.NAN, regex=True)\nFinal =Final.replace(to_replace=r\"^[!(-. \\d]*$\", value=np.NAN, regex=True)\nFinal= Final.replace(to_replace=r\"^Release Date$\", value=np.NAN, regex=True)\nFinal = Final.dropna(subset=[\"Book_Name\"])\n#print(Final.isna().sum())","5fe0c21e":"# Clean the city Column\n\nFinal=Final.dropna(subset=['City'])\n#print(Final.isna().sum())\nFinal[\"City\"] = Final[\"City\"].str.split(\"?\")\nFinal = Final.explode(\"City\", ignore_index=True)\nFinal=Final.replace(to_replace=r\"^[? ]*$\",value=np.NAN,regex=True)\nshort_full={\"karachi\":\"Karachi\",\n            \"KARACHI\":\"Karachi\",\n            \"islamabad\":\"Islamabad\",\n            \"ISLAMABAD\":\"Islamabad\"\n           ,\"sialkot\":\"Sialkot\",\n            \"lahore\":\"Lahore\",\n            \"peshawar\":\"Peshawar\",\n            \"quetta\":\"Quetta\",\n           \"FAISALABAD\":\"Faisalabad\",\n            \"RAWALPINDI\":\"Rawalpindi\",\n            \"Rawalpindi cant\":\"Rawalpindi\",\n          \"Seem Afzalpur mirpur ajk\":\"Azad Kashmir\",\n            \"Mirpur Azad Kashmir\":\"Azad Kashmir\",\n           \"multan\":\"Multan\",\n            \"HYDERABAD \":\"Hyderabad\",\n            \"rawalpindi\":\"Rawalpindi\",\n            \"Mingora Swat\":\"Swat\",\n           \"rahim yar khan\":\"Rahim yar khan\",\n            \"Bahria Town Islamabad\":\"Islamabad\",\n            \"Allama Iqbal Town, Lahore.\":\"Lahore\",\n           \"ABBOTTABAD\":\"Abbottabad\",\n            \"SARGODHA\":\"Sargodha\",\n            \"Malir, Karachi\":\"Karachi\",\n            \"faisalabad\":\"Faisalabad\",\n           \"Rohri, District Sukkur\":\"Sukkur\",\n            \"Qila Didar singh, Gujranwala\":\"Gujranwala\",\n            \"chiniot\":\"Chiniot\",\n           \"chakwal\":\"Chakwal\",\n            \"Chaklala Rawalpindi\":\"Rawalpindi\",\n            \"OKARA\":\"Okara\",\n            \"Lahore.\":\"Lahore\",\n           \"Township Lahore\":\"Lahore\",\n            \"Faqirabad Peshawar\":'Peshawar',\n            \"bahawalpur\":\"Bahawalpur\",\n            \"Johar Town Lahore\":\"Lahore\",\n           \"Atto k\":\"Attock\",\n            \"Midel town lahore\":\"Lahore\",\n            \"Johar Town, Lahore\":\"Lahore\",\n            \"Orangi Town Karachi\":\"Karachi\",\n           \"MULTAN\":\"Multan\",\n            \"Pindi Gheb District Attock\":\"Attock\",\n            \"SINDH \/ KARACHI\":\"Karachi\",\n            \"Noshera Distt Khushab\":\"Khushab\",\n           \"North Karachi, Karachi\":\"Karachi\",\n            \"swabi\":\"Swabi\",\n            \"TALAGANG\":\"Talagang\",\n            \"hyderabad\":\"Hyderabad\",\n           \"Bahawal nagar\":\"Bahawalnagar\",\n            \"North Karachi\":\"Karachi\",\n            \"Sadiq Abad\":\"Sadiqabad\",\n            \"sheikhupura\":\"Sheikhupura\",\n           \"Shor Kot,District jhang.\":\"Jhang\",\n            \"North Nazimabad, Karachi\":\"Karachi\",\n            \"larkana\":\"Larkana\",\n           \"sahiwal ,harappa station, chak no 142\/9.l\":\"Sahiwal\",\n            \"Multan Cantt\":\"Multan\",\n            \"Gulberg Town, Karachi\":\"Karachi\",\n           \"TOBA TEK Singh\":\"Toba Tek Singh\",\n            \"TOBA TEK SINGH\":\"Toba Tek Singh\",\n            \"kohat\":\"Kohat\",\n            \"BAHAWALPUR\":\"Bahawalpur\",\n           \"Peshawer\":\"Peshawar\",\n            \"SAHIWAL\":\"Sahiwal\",\n            \" Islampura (Krishan Nagar); LAHORE\":\"Lahore\",\n            \"LIAQUATPUR\":\"Liqatpur\",\n           \"Boson Road Multan \":\"Multan\",\n            \"Gulistan e Jauhar Karachi\":\"Karachi\",\n            \"Bhogiwal Road, Baghbanpura Lahore\":\"Lahore\",\n           \"battagram\":\"Battagram\",\n            \"Haroon Abad\":\"Haroonabad\",\n            \"Gulshan-e-Bahar orangi town, karachi.\":\"Karachi\",\n           \"Kundian Dist Mianwali\":\"Mianwali\",\n            \"Chaudhry Park Rashid Road Lahore\":\"Lahore\",\n            \"Landhi Karachi\":\"Karachi\"}\nFinal[\"City\"] = Final[\"City\"].replace(short_full)","481a2077":"#Analyze data\nTop_10_books = Final.groupby(\"Book_Name\")[\"Order_NO\"].agg([\"count\"]).reset_index().sort_values(by=\"count\",ascending=False).head(10)\n#print(Top_10_books)","fa74ccb4":"#Visuallize the Top ten Books\nsns.set_style(\"darkgrid\")\nsns.set_context(\"paper\")\ng=sns.catplot(x=\"Book_Name\",y=\"count\",data=Top_10_books,kind=\"bar\")\ng.fig.suptitle(\"Top 10 Books \")\nplt.xticks(rotation=90)\nplt.show()","4abdab0d":"top_15_cities = Final.groupby(\"City\")[\"Order_NO\"].agg([\"count\"]).reset_index().sort_values(by='count',ascending=False).head(15)\nprint(top_15_cities)","c645a96e":"#Visualize the top 15 cities\nsns.set_style(\"darkgrid\")\nsns.set_context(\"paper\", rc={\"lines.linewidth\": 2})\ng=sns.barplot(x=\"City\",y=\"count\",data=top_15_cities,)\ng.set_title(\"Top 15 Cities \")\nplt.xticks(rotation=90)\nplt.show()","c16d8cda":"# Visualize by Pi chart to show the percentage\n\n\nCities = Final['City'].value_counts().head(10)\n#pi-chart of top  most cities where books sold\nCities.plot(kind='pie',figsize=(8,8),autopct='%1.1f%%')","928d19fc":"# Check the null vales in the column\nFinal[\"Order_Date\"].isnull().sum()","78184797":"# Analyze the order of Books BY Year\n\nFinal[\"Order_Date\"]=pd.to_datetime(Final[\"Order_Date\"])\nFinal[\"Year\"]=Final[\"Order_Date\"].dt.year\nPer_Year=Final.groupby(\"Year\")[\"Order_NO\"].agg(['count']).reset_index().sort_values(by='count',ascending=False)\nprint(Per_Year)","d2c374c9":"# Visualize the Graph\n\nsns.set_style(\"darkgrid\")\nsns.set_context(\"paper\", rc={\"lines.linewidth\": 2})\ng=sns.barplot(x=\"Year\",y=\"count\",data=Per_Year,)\ng.set_title(\"Order By Years\")\nplt.xticks(rotation=90)\nplt.show()","e6ad8ef1":"# Analyze the order of books by Months\nFinal[\"Month\"] = Final[\"Order_Date\"].dt.month_name()\nmonth=[\"January\",\"February \",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"]\nPer_Month_stat=Final.groupby(\"Month\")[\"Order_NO\"].agg(['count']).reset_index().sort_values(by=\"count\",ascending=False)\nprint(Per_Month_stat)","3a5ef22b":"#Visualize Bar plot show the no of the order of books by Months\n\ncat_order=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\n          \"July\",\"August\",\"September\",\"November\",\"December\"]\nsns.set_style(\"darkgrid\")\nsns.set_context(\"paper\", rc={\"lines.linewidth\": 2})\ng=sns.barplot(x=\"Month\",y=\"count\",data=Per_Month_stat,order=cat_order)\ng.set_title(\"Orders By Months \")\nplt.xticks(rotation=90)\nplt.show()\n","5815d43b":"#Visualize the relational graph of the order of books by Months\ncat_order=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\n          \"July\",\"August\",\"September\",\"November\",\"December\"]\nsns.set_style(\"whitegrid\")\nsns.set_context(\"paper\", rc={\"lines.linewidth\": 2})\ng=sns.catplot(x=\"Month\",y=\"count\",kind='point',data=Per_Month_stat,order=cat_order,color=\"r\")\ng.fig.suptitle(\"Orders BY Months \")\nplt.xticks(rotation=90)\nplt.show()","361f2244":"Per_Year=Final.groupby([\"Year\",\"Month\"])[\"Order_NO\"].agg(['count']).reset_index().sort_values(by='count',ascending=False)\nprint(Per_Year)","ae326c32":"cat_order=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\n          \"July\",\"August\",\"September\",\"November\",\"December\"]\nsns.set_style(\"darkgrid\")\ng = sns.catplot(x=\"Month\",y=\"count\",data=Per_Year,hue=\"Year\",style=\"Year\",kind=\"point\",order=cat_order)\ng.fig.suptitle(\"Relation Of Months and Years\")\nplt.xticks(rotation=90)\nplt.show()","334b4e95":"ReOrder={\"Cancelled\":\"Canceled\"}\nFinal[\"Order_Status\"]=Final[\"Order_Status\"].replace(ReOrder)\nOrder_status = Final.groupby(\"Order_Status\")[\"Order_NO\"].agg([\"count\"]).reset_index()\nprint(Order_status)","532b2e79":"sns.set_style(\"darkgrid\")\ncustom_palette = [\"yellow\", \"green\", \"red\", \"purple\"] \nsns.set_palette(custom_palette) \nsns.set_context(\"paper\", rc={\"lines.linewidth\": 2})\ng=sns.barplot(x=\"Order_Status\",y=\"count\",data=Order_status)\ng.set_title('Order_Status')\n#plt.xticks(rotation=90)\nplt.show()","cf2210f6":"cat_set_pay={\"Cash on Delivery (COD)\":\"Cash on delivery\"}\nFinal[\"Payment_Method\"] = Final[\"Payment_Method\"].replace(cat_set_pay)\nPayment_Method =Final.groupby([\"Payment_Method\"])[\"Order_NO\"].agg(['count']).reset_index()\nprint(Payment_Method)","a8211e3b":"sns.set_style(\"darkgrid\")\ncustom_palette = [\"yellow\", \"green\", \"red\", \"purple\"] \nsns.set_palette(custom_palette) \nsns.set_context(\"paper\", rc={\"lines.linewidth\": 2})\ng=sns.barplot(x=\"Payment_Method\",y=\"count\",data=Payment_Method)\ng.set_title('Payment Method ')\n#plt.xticks(rotation=90)\nplt.show()","44499847":"canceled_Book = Final[Final[\"Order_Status\"]==\"Canceled\"]\ncancel_Book = canceled_Book.groupby([\"Month\",\"Year\"])[\"Order_NO\"].agg(['count']).reset_index()\nprint(cancel_Book)","ae033836":"#Relation Of Canaceled Books By Months and Years\n\ncat_order=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\n          \"July\",\"August\",\"September\",\"November\",\"December\"]\n\ng = sns.catplot(x=\"Month\",y=\"count\",data=cancel_Book,hue=\"Year\",style=\"Year\",kind=\"point\",order=cat_order)\ng.fig.suptitle(\"Relation Of Canaceled Books By Months and Years\")\nplt.xticks(rotation=90)\nplt.show()","faab781e":"# Analyze the No Of Canaceled Books By Months and Years\n\ncat_order=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\n          \"July\",\"August\",\"September\",\"November\",\"December\"]\n\ng = sns.catplot(x=\"Month\",y=\"count\",data=cancel_Book,hue=\"Year\",kind=\"bar\",order=cat_order)\ng.fig.suptitle(\"No Of Canaceled Books By Months and Years\")\nplt.xticks(rotation=90)\nplt.show()","3cd93f03":"canceled_Book_Method=Final[Final[\"Order_Status\"]==\"Canceled\"]\ncancel_Book_Method =canceled_Book_Method.groupby([\"Payment_Method\"])[\"Order_NO\"].agg(['count']).reset_index()\nprint(cancel_Book_Method)","ede1b3a2":"g = sns.catplot(x=\"Payment_Method\",y=\"count\",data=cancel_Book_Method,kind=\"bar\")\ng.fig.suptitle(\"No of Canceled Books by Different Method \")\n#plt.xticks(rotation=90)\nplt.show()","4b82a93c":"Completed_Book=Final[Final[\"Order_Status\"]==\"Completed\"]\nComplete_Book =Completed_Book.groupby([\"Month\",\"Year\"])[\"Order_NO\"].agg(['count']).reset_index()\nprint(Complete_Book)","bb748d27":"#Analyze the Relation Of Completed Books By Months and Years\n\ncat_order=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\n          \"July\",\"August\",\"September\",\"November\",\"December\"]\n\ng = sns.catplot(x=\"Month\",y=\"count\",data=Complete_Book,hue=\"Year\",style=\"Year\",kind=\"point\",order=cat_order)\ng.fig.suptitle(\"Relation Of Completed Books By Months and Years\")\nplt.xticks(rotation=90)\nplt.show()","eed09771":"# Analyze the No Of Completed Books By Months and Years\n\n\ncat_order=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\n          \"July\",\"August\",\"September\",\"November\",\"December\"]\n\ng = sns.catplot(x=\"Month\",y=\"count\",data=Complete_Book,hue=\"Year\",kind=\"bar\",order=cat_order)\ng.fig.suptitle(\"No Of Completed Books By Months and Years\")\nplt.xticks(rotation=90)\nplt.show()","c8035d2c":"Completed_Book_Method=Final[Final[\"Order_Status\"]==\"Completed\"]\nComplete_Book_Method =Completed_Book_Method.groupby([\"Payment_Method\"])[\"Order_NO\"].agg(['count']).reset_index()\nprint(Complete_Book_Method)","ca067bdc":"g = sns.catplot(x=\"Payment_Method\",y=\"count\",data=Complete_Book_Method,kind=\"bar\")\ng.fig.suptitle(\"No of Completed Books by Different Method \")\n#plt.xticks(rotation=90)\nplt.show()","86b682fb":"Returned_Book=Final[Final[\"Order_Status\"]==\"Returned\"]\nReturn_Book =Returned_Book.groupby([\"Month\",\"Year\"])[\"Order_NO\"].agg(['count']).reset_index()\nprint(Return_Book)","0ad572a3":"# Analyze the Relation Of Returned Books By Months and Years\n\ncat_order=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\n          \"July\",\"August\",\"September\",\"November\",\"December\"]\n\ng = sns.catplot(x=\"Month\",y=\"count\",data=Return_Book,hue=\"Year\",style=\"Year\",kind=\"point\",order=cat_order)\ng.fig.suptitle(\"Relation Of Returned Books By Months and Years\")\nplt.xticks(rotation=90)\nplt.show()","ce41376d":"#Analyze the NO Of Returned Books By Months and Years\n\ncat_order=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\n          \"July\",\"August\",\"September\",\"November\",\"December\"]\n\ng = sns.catplot(x=\"Month\",y=\"count\",data=Return_Book,hue=\"Year\",kind=\"bar\",order=cat_order)\ng.fig.suptitle(\"NO Of Returned Books By Months and Years\")\nplt.xticks(rotation=90)\nplt.show()","cf5d03e8":"Returned_Book_Method=Final[Final[\"Order_Status\"]==\"Returned\"]\nReturn_Book_Method =Returned_Book_Method.groupby(\"Payment_Method\")[\"Order_NO\"].agg(['count']).reset_index()\nprint(Return_Book_Method)","26695f48":"g = sns.catplot(x=\"Payment_Method\",y=\"count\",data=Return_Book_Method,kind=\"bar\")\ng.fig.suptitle(\"No of Returned Books by Different Method \")\nplt.xticks(rotation=90)\nplt.show()","e28f0467":"Payment_Method =Final.groupby([\"Month\",\"Payment_Method\"])[\"Order_NO\"].agg(['count']).reset_index()\nprint(Payment_Method)","510d1d44":"#Analyze the Payments Method by Months\n\ncat_order=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\n          \"July\",\"August\",\"September\",\"November\",\"December\"]\n\ng = sns.catplot(x=\"Month\",y=\"count\",data=Payment_Method,hue=\"Payment_Method\",kind=\"point\",order=cat_order)\ng.fig.suptitle(\"Payments Method by Months\")\nplt.xticks(rotation=90)\nplt.show()","8d0c0c85":"# Order_Status:\"Completed\"\n## Analyse the Order_Status when it is \"Completed\" ","a15170ba":"# Visualize the Payment_Method","0933a936":"# Join the \"GP Orders - 2.csv\" and \"GP Orders - 4.csv\"","bb5c5734":"# Cleaning the \"Book_Name\" column","d8d3c006":"# Order_Status:\"Canceled\"\n## Analyse the Order_Status when it is \"canceled\" ","d97e6f7c":"# Read the Csv Files","d788906a":"# Cleaning the \"City\" column","a0549856":"# Analyze \"Returned\" Books by Payment_Method","a633a702":"# Order of Books by Month","4b9aa105":"# Visualize Payment Method by Months","1fbbff53":"# Analyze the Top_15 cities in which books are sold","1dc02e14":"# Relation of order of books by months and year","d58a927f":"# Analyze \"Canceled\" Books by Payment_Method","0dd9076c":"# Order_Status:\"Returned\"\n## Analyse the Order_Status when it is \"Returned\" ","2f2d61bf":"# Analyze \"Completed\" Books by Payment_Method","6d427175":"# Analyze the Top_10 Sold Books","ccaa24f3":"# Merge the join with \"GP Orders - 5.csv\"\/\n","3f13ac8c":"# Order of Books by Year","14fbc678":"# Visualize the Order_Status"}}