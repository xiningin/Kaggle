{"cell_type":{"77f26c68":"code","1e144878":"code","3149a8a7":"code","9bd12bda":"code","05ad0436":"code","750c735d":"code","098bbf47":"code","947a181c":"code","2e620ff2":"code","3ca74909":"code","a33a4c22":"code","94aca39e":"code","e862de1c":"code","287d9b83":"code","a2d3d79b":"code","f3979941":"code","05f2243b":"markdown","36798db6":"markdown","8a29b151":"markdown","5bcbc33a":"markdown","3712db14":"markdown","0cbff870":"markdown","a5034f47":"markdown","7e3b4a46":"markdown"},"source":{"77f26c68":"# ====================================================\n# Directory settings\n# ====================================================\nimport os\n\nOUTPUT_DIR = '.\/'\nif not os.path.exists(OUTPUT_DIR):\n    os.makedirs(OUTPUT_DIR)","1e144878":"# ====================================================\n# CFG\n# ====================================================\nclass CFG:   \n    seed=2021\n    n_fold=5\n    max_model=20","3149a8a7":"import random\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","9bd12bda":"# ====================================================\n# Utils\n# ====================================================\ndef seed_everything(seed=42):\n    random.seed(seed)\n    os.environ['PYTHONHASHSEED'] = str(seed)\n    np.random.seed(seed)\n\nseed_everything(seed=CFG.seed)","05ad0436":"train = pd.read_csv('\/kaggle\/input\/tabular-playground-series-apr-2021\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/tabular-playground-series-apr-2021\/test.csv')\nsubmission = pd.read_csv('\/kaggle\/input\/tabular-playground-series-apr-2021\/sample_submission.csv')","750c735d":"display(train.head())\ndisplay(test.head())","098bbf47":"display(train.describe())\ndisplay(test.describe())","947a181c":"display(train.shape)\ndisplay(test.shape)","2e620ff2":"import h2o\nfrom h2o.automl import H2OAutoML","3ca74909":"h2o.init(max_mem_size='16G', nthreads=16)","a33a4c22":"train_df = h2o.H2OFrame(train.copy())","94aca39e":"train_df['Survived'] = train_df['Survived'].asfactor()\n\nx = train_df.columns[2:]\ny = 'Survived'","e862de1c":"display(train_df.head())","287d9b83":"aml = H2OAutoML(\n    max_models=CFG.max_model, \n    seed=CFG.seed, \n    max_runtime_secs=10800,\n    nfolds = CFG.n_fold,\n    exclude_algos = [\"DeepLearning\"]\n)\naml.train(x=x, y=y, training_frame=train_df)","a2d3d79b":"lb = aml.leaderboard \nlb.head(rows = lb.nrows)","f3979941":"preds = aml.predict(h2o.H2OFrame(test.copy()))\npreds_df = h2o.as_list(preds)\n\nsubmission['Survived'] = preds_df['predict']\nsubmission.to_csv('submission.csv', index=False)\ndisplay(submission.head())","05f2243b":"# Data Loading","36798db6":"# Utils","8a29b151":"# Make a submission","5bcbc33a":"# CFG","3712db14":"# Import Libraries","0cbff870":"# Basic EDA","a5034f47":"# Directory settings","7e3b4a46":"# H2O"}}