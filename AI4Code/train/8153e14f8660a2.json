{"cell_type":{"5dd7602f":"code","aaf07d3a":"code","8dfbbbcc":"code","ce69c681":"code","9fa00d89":"code","9244fa9c":"code","de963d1c":"code","d8f92247":"code","afcdb2d7":"code","40a43166":"code","feb0eb89":"code","fd5e460f":"code","edff4543":"code","2663ae85":"code","03a573d0":"code","6b0ef0ca":"code","bcb4fa91":"code","eb8829ca":"code","de4f0ca8":"code","ead275e4":"code","605a611b":"markdown","f59aec0c":"markdown","e873961e":"markdown","a8411c59":"markdown"},"source":{"5dd7602f":"!pip install sentencepiece","aaf07d3a":"! pip install transformers","8dfbbbcc":"from transformers import AutoTokenizer, AutoModelForTokenClassification, pipeline","ce69c681":"tokenizer = AutoTokenizer.from_pretrained(\"oliverguhr\/fullstop-punctuation-multilang-large\")","9fa00d89":"model = AutoModelForTokenClassification.from_pretrained(\"oliverguhr\/fullstop-punctuation-multilang-large\")","9244fa9c":"#text = \"My name is Clara and I live in Berkeley California\"\ntext = 'This model predicts the punctuation of English Italian French and German text'","de963d1c":"#input_ids = tokenizer.encode(text, return_tensors=\"pt\")","d8f92247":"pun = pipeline('ner', model=model, tokenizer=tokenizer)","afcdb2d7":"output_json = pun(text)","40a43166":"output_json","feb0eb89":"s = ''\n\nfor n in output_json:\n  result = n['word'].replace('\u2581',' ') + n['entity'].replace('0','')\n  s += result","fd5e460f":"s","edff4543":"from spacy import displacy","2663ae85":"empty_ner = []\nfor n in output_json:\n  if n['entity'] != '0':\n    temp = [n['start'],n['end'],n['entity']]\n    empty_ner.append(temp)","03a573d0":"empty_ner","6b0ef0ca":"colors = {\"0\": \"linear-gradient(90deg, #999999, #cccccc)\",\n          \",\": \"linear-gradient(90deg, #aa9cfc, #fc9ce7)\",\n          \".\": \"linear-gradient(90deg, #aa9cfc, #fc9ce7)\",\n          \"?\": \"linear-gradient(90deg, #aa9cfc, #fc9ce7)\",\n          \":\": \"linear-gradient(90deg, #aa9cfc, #fc9ce7)\",\n          \"-\": \"linear-gradient(90deg, #aa9cfc, #fc9ce7)\"\n          }\noptions = {\"ents\": [\"0\", \",\",\".\",\"?\",\":\",'-'], \"colors\": colors}","bcb4fa91":"[{\"start\": x[0], \"end\": x[1], \"label\": x[2]} for x in empty_ner]","eb8829ca":"ex = [{\"text\": text,\n       \"ents\": [{\"start\": x[0], \"end\": x[1], \"label\": x[2]} for x in empty_ner],\n       \"title\": \"Deep Learning powered Punctuation Corrector\"}]\n\n","de4f0ca8":"html = displacy.render(ex, style=\"ent\", manual=True, options=options)","ead275e4":"# from IPython.core.display import display, HTML\n# display(HTML(html))\n","605a611b":"\ud83e\udd17 Model Page - https:\/\/huggingface.co\/oliverguhr\/fullstop-punctuation-multilang-large ","f59aec0c":"### Result","e873961e":"### Visualize the Punctuation Correction with `displacy`","a8411c59":"Credit: https:\/\/www.alexanderjunge.net\/blog\/ner-vis-displacy\/"}}