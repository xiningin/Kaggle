{"cell_type":{"c9a8b765":"code","961eb46f":"code","dfc955c8":"code","848f365d":"code","7d70a400":"code","8d1d0a00":"code","bf5b87a4":"code","8bab7a4c":"code","6197efe3":"code","108203aa":"markdown","9469b135":"markdown","3eda7898":"markdown"},"source":{"c9a8b765":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport cv2\n\nimport keras\nfrom keras import models, layers\nfrom keras.utils import np_utils\n\ndef highlight_max(s):\n    '''\n    highlight the maximum in a Series yellow.\n    '''\n    is_max = s == s.max()\n    return ['background-color: yellow' if v else '' for v in is_max]","961eb46f":"brand = ['Hyundai','Tesla','Mercedes-Benz']\n\nX_train = []\ny_train = []\nX_test = []\ny_test = []\nfor brand_name in brand:\n    bra = brand_name\n    for i in range(0,60):\n        img_src = '..\/input\/100-images-of-top-50-car-brands\/imgs_zip\/imgs\/{0}\/{0}_{1:03d}.jpg'.format(bra,i)\n        src = cv2.imread(img_src, cv2.IMREAD_COLOR)\n        dst = cv2.cvtColor(src, cv2.COLOR_BGR2GRAY)\n        X_train.append(cv2.resize(dst, dsize=(200, 300), interpolation=cv2.INTER_AREA))\n        y_train.append(bra)\n        \n    for i in range(60,84):\n        img_src = '..\/input\/100-images-of-top-50-car-brands\/imgs_zip\/imgs\/{0}\/{0}_{1:03d}.jpg'.format(bra,i)\n        src = cv2.imread(img_src, cv2.IMREAD_COLOR)\n        dst = cv2.cvtColor(src, cv2.COLOR_BGR2GRAY)\n        X_test.append(cv2.resize(dst, dsize=(200, 300), interpolation=cv2.INTER_AREA))\n        y_test.append(bra)\n        \nX_train = np.array(X_train)\ny_train = np.array(y_train)\nX_test = np.array(X_test)\ny_test = np.array(y_test)\n\ny_train = y_train.reshape(-1,1)\ny_test = y_test.reshape(-1,1)\n\nfig, axes = plt.subplots(1,10,figsize=(25,10))\nfor i in range(0,10):\n    axes[i].imshow(X_train[i])","dfc955c8":"X_train = X_train.reshape(X_train.shape[0], 300, 200,1)\nX_test = X_test.reshape(X_test.shape[0], 300, 200,1)\n\ny_train = np.array(pd.get_dummies(pd.DataFrame(y_train),columns=[0]))\ny_test = np.array(pd.get_dummies(pd.DataFrame(y_test),columns=[0]))\n\nX_train.shape, X_test.shape, y_train.shape, y_test.shape","848f365d":"input_shape = X_train.shape[1:]\nmodel = models.Sequential()\nmodel.add(layers.Conv2D(filters = 32, kernel_size = (5,5),padding = 'Same', \n                 activation ='relu', input_shape = input_shape))\nmodel.add(layers.Conv2D(filters = 32, kernel_size = (5,5),padding = 'Same', \n                 activation ='relu'))\nmodel.add(layers.MaxPool2D(pool_size=(2,2)))\nmodel.add(layers.Dropout(0.25))\n\n\nmodel.add(layers.Conv2D(filters = 64, kernel_size = (3,3),padding = 'Same', \n                 activation ='relu'))\nmodel.add(layers.Conv2D(filters = 64, kernel_size = (3,3),padding = 'Same', \n                 activation ='relu'))\nmodel.add(layers.MaxPool2D(pool_size=(2,2), strides=(2,2)))\nmodel.add(layers.Dropout(0.25))\n\n\nmodel.add(layers.Flatten())\nmodel.add(layers.Dense(256, activation = \"relu\"))\nmodel.add(layers.Dropout(0.5))\nmodel.add(layers.Dense(3, activation = \"softmax\"))\nmodel.compile(loss=keras.losses.categorical_crossentropy, optimizer='rmsprop', metrics=['accuracy'])\n\nhistory = model.fit(X_train, y_train, batch_size = 256, epochs = 30, shuffle=True, validation_data=(X_test,y_test),verbose = 0)","7d70a400":"model.evaluate(X_test, y_test)","8d1d0a00":"fig,axes = plt.subplots(1,2, figsize=(15,8))\nfig.suptitle(\"The model 's evaluation \",fontsize=20)\naxes[0].plot(history.history['loss'])\naxes[0].plot(history.history['val_loss'])\naxes[0].set_title('Model Loss')\naxes[0].set_ylabel('Loss')\naxes[0].set_xlabel('Epoch')\naxes[0].legend(['Train','Test'])\n\n\naxes[1].plot(history.history['accuracy'])\naxes[1].plot(history.history['val_accuracy'])\naxes[1].set_title('Model Accuracy')\naxes[1].set_ylabel('Accuracy')\naxes[1].set_xlabel('Epoch')\naxes[1].legend(['Train','Test'])\nplt.show()","bf5b87a4":"src = cv2.imread('..\/input\/100-images-of-top-50-car-brands\/imgs_zip\/imgs\/Hyundai\/Hyundai_089.jpg', cv2.IMREAD_COLOR)\ndst = cv2.cvtColor(src, cv2.COLOR_BGR2GRAY)\nimg = cv2.resize(dst, dsize=(200, 300), interpolation=cv2.INTER_AREA)\n\nimg = np.array(img)\nimg = img.astype('float32')\nimg = img\/255\nimg = img.reshape(1,300,200,1)\npred = model.predict(img)\n\nplt.imshow(src)\nplt.show()\n\npd.DataFrame(pred,columns=brand).T.style.apply(highlight_max)","8bab7a4c":"src = cv2.imread('..\/input\/100-images-of-top-50-car-brands\/imgs_zip\/imgs\/Mercedes-Benz\/Mercedes-Benz_085.jpg', cv2.IMREAD_COLOR)\ndst = cv2.cvtColor(src, cv2.COLOR_BGR2GRAY)\nimg = cv2.resize(dst, dsize=(200, 300), interpolation=cv2.INTER_AREA)\n\nimg = np.array(img)\nimg = img.astype('float32')\nimg = img\/255\nimg = img.reshape(1,300,200,1)\npred = model.predict(img)\n\nplt.imshow(src)\nplt.show()\n\npd.DataFrame(pred,columns=brand).T.style.apply(highlight_max)","6197efe3":"src = cv2.imread('..\/input\/100-images-of-top-50-car-brands\/imgs_zip\/imgs\/Tesla\/Tesla_087.jpg', cv2.IMREAD_COLOR)\ndst = cv2.cvtColor(src, cv2.COLOR_BGR2GRAY)\nimg = cv2.resize(dst, dsize=(200, 300), interpolation=cv2.INTER_AREA)\n\nimg = np.array(img)\nimg = img.astype('float32')\nimg = img\/255\nimg = img.reshape(1,300,200,1)\npred = model.predict(img)\n\nplt.imshow(src)\nplt.show()\n\npd.DataFrame(pred,columns=brand).T.style.apply(highlight_max)","108203aa":"### This notebook's work was fail to predict the car's brand. Please read this [other version](https:\/\/www.kaggle.com\/jeongbinpark\/predict-the-car-brand-by-cnn?scriptVersionId=57555318)\n### This work showed only 0.33 accuracy that predict only one brand... like output = [\"1\", \"1\", \"1\" .....]","9469b135":"### To make model, I refer [Yassine Ghouzam's Notebook](https:\/\/www.kaggle.com\/yassineghouzam\/introduction-to-cnn-keras-0-997-top-6). ","3eda7898":"# Next_version : [Predict the car brand by CNN](https:\/\/www.kaggle.com\/jeongbinpark\/predict-the-car-brand-by-cnn?scriptVersionId=57555318)"}}