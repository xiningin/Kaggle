{"cell_type":{"23aad1b8":"code","187729e2":"code","e220bc3c":"code","36d9e80a":"code","117ed120":"markdown"},"source":{"23aad1b8":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n\npd.set_option('max_columns', None)\n\ntrain = pd.read_csv('..\/input\/santander-customer-transaction-prediction\/train.csv')\ntest = pd.read_csv('..\/input\/santander-customer-transaction-prediction\/test.csv')\nsynthetic = np.load('..\/input\/list-of-fake-samples-and-public-private-lb-split\/synthetic_samples_indexes.npy')\ntrain = train.sample(frac=0.5)\ntest_real = test.iloc[~test.index.isin(synthetic)]\ntest_fake = test.iloc[test.index.isin(synthetic)]\ndata = pd.concat([train, test_real, test_fake], axis=0, sort=False)\n\nprint(len(train))\nprint(len(test_real))\nprint(len(test_fake))","187729e2":"# === unique value\ncol_var = train.columns[2:]\ndf = pd.DataFrame(col_var, columns=['feature'])\ndf['n_train_unique'] = train[col_var].nunique(axis=0).values\ndf['n_test_real_unique'] = test_real[col_var].nunique(axis=0).values\ndf['n_test_fake_unique'] = test_fake[col_var].nunique(axis=0).values\n\nfor i in df.index:\n    col = df.loc[i, 'feature']\n    df.loc[i, 'n_overlap_withreal'] = int(np.isin(train[col].unique(), test_real[col]).sum())\n\ndf['value_range'] = data[col_var].max(axis=0).values - data[col_var].min(axis=0).values","e220bc3c":"df.T","36d9e80a":"# === plot\ndf = df.sort_values(by='n_train_unique').reset_index(drop=True)\ndf[['n_train_unique', 'n_test_real_unique', 'n_test_fake_unique', 'n_overlap_withreal']].plot(kind='barh' ,figsize=(22, 100), fontsize=20, width=0.8)\nplt.yticks(df.index, df['feature'].values)\nplt.xlabel('n_unique', fontsize=20)\nplt.ylabel('feature', fontsize=20)\nplt.legend(loc='center right', fontsize=20)","117ed120":"# Credits to the original kernel: https:\/\/www.kaggle.com\/triplex\/more-unique-values-in-train-set-than-test-set"}}