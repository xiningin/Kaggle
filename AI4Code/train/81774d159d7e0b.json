{"cell_type":{"3a3ef739":"code","90ead993":"code","4c5041b9":"code","a1642526":"code","3b53d687":"code","75733761":"code","094915d5":"code","b844aeeb":"code","3f1f1411":"code","4f9532f7":"code","9c250108":"code","4aa85e4c":"code","7495874b":"code","e7ebd4a4":"code","6b14fc4f":"markdown","651d5204":"markdown","23956a82":"markdown","3992bed2":"markdown","231b1330":"markdown","7107bb4c":"markdown","f19f931a":"markdown","bb78917f":"markdown","5f06e834":"markdown","c080a3db":"markdown","93deea61":"markdown"},"source":{"3a3ef739":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","90ead993":"import tensorflow as tf\nimport matplotlib.pyplot as plt\nimport random\nimport seaborn as sns\nfrom keras.models import Sequential\nfrom keras.layers import Conv2D,Dense,Flatten,Dropout,AveragePooling2D\nfrom keras.preprocessing.image import ImageDataGenerator\nfrom keras.callbacks import ReduceLROnPlateau","4c5041b9":"train_dir_normal=\"..\/input\/chest-xray-pneumonia\/chest_xray\/train\/NORMAL\"\ntrain_dir_pneumonia = \"..\/input\/chest-xray-pneumonia\/chest_xray\/train\/PNEUMONIA\"\nvalid_dir_normal = \"..\/input\/chest-xray-pneumonia\/chest_xray\/val\/NORMAL\"\nvalid_dir_pneumonia = \"..\/input\/chest-xray-pneumonia\/chest_xray\/val\/PNEUMONIA\"\ntest_dir_pneumonia = \"..\/input\/chest-xray-pneumonia\/chest_xray\/test\/normal\"\ntest_dir_pneumonia = \"..\/input\/chest-xray-pneumonia\/chest_xray\/test\/PNEUMONIA\"","a1642526":"sns.set_style('whitegrid')\nsns.barplot(x=['Normal','Pneumonia'],y=[len(train_dir_normal), len(train_dir_pneumonia)])\n","3b53d687":"training_dir = \"..\/input\/chest-xray-pneumonia\/chest_xray\/train\"\ntraining_generator = ImageDataGenerator(rescale=1.\/255,\n                                   rotation_range=15,\n                                   shear_range=0.2,\n                                   zoom_range=0.2 )\ntrain_generator = training_generator.flow_from_directory(training_dir,target_size=(200,200),batch_size=4,class_mode='binary')","75733761":"validation_dir = \"..\/input\/chest-xray-pneumonia\/chest_xray\/val\"\nvalidation_generator = ImageDataGenerator(rescale=1.\/255)\nvalid_generator = validation_generator.flow_from_directory(validation_dir,target_size=(200,200),batch_size=4,class_mode='binary')","094915d5":"testing_dir = \"..\/input\/chest-xray-pneumonia\/chest_xray\/test\"\ntesting_generator = ImageDataGenerator(rescale=1.\/255)\ntest_generator = testing_generator.flow_from_directory(testing_dir,target_size=(200,200),batch_size=4,class_mode='binary')","b844aeeb":"Building Deep CNN Model \ud83d\ude0d","3f1f1411":"ak=tf.keras.Sequential([\n    tf.keras.layers.Conv2D(32,(3,3),input_shape=(200,200,3),activation='relu'),\n    tf.keras.layers.MaxPooling2D(2,2),\n    \n    tf.keras.layers.Conv2D(64,(3,3),activation='relu'),\n    tf.keras.layers.MaxPooling2D(2,2),\n    tf.keras.layers.Dropout(0.2),\n    \n    tf.keras.layers.Conv2D(128,(3,3),activation='relu'),\n    tf.keras.layers.MaxPooling2D(2,2),\n    tf.keras.layers.Dropout(0.2),\n    \n    tf.keras.layers.Conv2D(256,(3,3),activation='relu'), \n    tf.keras.layers.MaxPooling2D(2,2),\n    \n    tf.keras.layers.Flatten(),\n    tf.keras.layers.Dropout(0.2),\n    tf.keras.layers.Dense(256,activation='relu'),\n    tf.keras.layers.Dense(1,activation='sigmoid')\n    \n])","4f9532f7":"ak.summary()","9c250108":"ak.compile(optimizer = tf.keras.optimizers.Adam(lr=0.001), loss = 'binary_crossentropy', metrics = ['accuracy'])","4aa85e4c":"history = ak.fit_generator(train_generator,\n                           validation_data = valid_generator,\n                           epochs = 5,\n                           verbose = 1)","7495874b":"%matplotlib inline\naccuracy = history.history['accuracy']\nval_accuracy = history.history['val_accuracy']\nloss = history.history['loss']\nval_loss = history.history['val_loss']\n\nepochs = range(len(accuracy))\n\nplt.plot(epochs, accuracy, 'r', label='Training accuracy')\nplt.plot(epochs, val_accuracy, 'b', label='Validation accuracy')\nplt.title('Training and validation accuracy')\nplt.legend(loc=0)\nplt.figure()","e7ebd4a4":"print(\"Loss of the model is - \" , ak.evaluate(test_generator)[0]*100 , \"%\")\nprint(\"Accuracy of the model is - \" , ak.evaluate(test_generator)[1]*100 , \"%\")","6b14fc4f":"***19 July 2019***","651d5204":"Plot some graph.....","23956a82":"Compiling the model \ud83d\ude2c","3992bed2":"**Thank you**\n","231b1330":"**Made using Tensorflow \u270c**","7107bb4c":"Testing........","f19f931a":"**PNEUMONIA DETECTION USING CHEST X-RAYS**\n\nPneumonia-detection-with-the-help-of-chest-X-ray\nPneumonia is an infection in one or both lungs. Bacteria, viruses, and fungi cause it. The infection causes inflammation in the air sacs in your lungs, which are called alveoli. The alveoli fill with fluid or pus, making it difficult to breathe.\n\nIncludes Diseases: Community-acquired pneumonia\n\nSymptoms: Inflammation\n\n![download.jfif](attachment:download.jfif)\n\n","bb78917f":"Got an Accuracy of 92% on epochs 5\nafter increasing the epochs to 20 the accuracy is 96%\ud83d\ude0d\ud83e\udd2a","5f06e834":"Dataset divided into 3 parts train,test and valid having 'normal' and 'infected' x-rays","c080a3db":"Time to train our model \ud83d\ude34\ud83d\ude34\nWaiting..........................................\ud83d\ude2a","93deea61":"**If you liked this please 'UPVOTE' \ud83d\udc46\nyou can also check it on my github account \"https:\/\/github.com\/Amankumar29\/Pneumonia-detection-with-the-help-of-chest-X-ray\" you can check my projects there \ud83e\udd17\ud83e\udd17**"}}