{"cell_type":{"20542832":"code","2c9af2f7":"code","3f9bc4dd":"code","6b4695a6":"code","cdd388aa":"code","dfded23e":"code","4a64cfd6":"code","df6be11f":"code","83c175fb":"code","134317c0":"code","e198c5e8":"code","cf830a46":"code","f7d1837a":"code","3e07047f":"code","bee16808":"code","c095db0a":"code","0d96887a":"code","76337340":"code","1eb6b1fd":"code","3bed5323":"code","44143055":"code","25ab72e9":"code","f0f3a449":"code","0f446580":"code","639370c2":"code","657ef67c":"code","4a129910":"code","a1403fef":"code","ea29fb5d":"code","f38762bb":"code","7f653564":"code","2d138eb4":"code","af47521d":"code","d76cf327":"markdown","3108103b":"markdown","0c37b609":"markdown","e5bbbdfc":"markdown","e80a7ca9":"markdown","536992d6":"markdown","16a3fda3":"markdown","104334a1":"markdown","f94ca4a2":"markdown","3fb44ba7":"markdown","8da4b4e4":"markdown"},"source":{"20542832":"import pandas as pd\nimport numpy as np\nhitters=pd.read_csv(\"..\/input\/hittlers\/Hitters.csv\")\ndf=hitters.copy()\ndf.head(2)","2c9af2f7":"df=df.dropna()\ny=df[\"Salary\"]   # EASY ASSESMENT FOR \"SALARY\" AND \"HITS\" VARIABLES\ndms=pd.get_dummies(df[[\"League\",\"Division\",\"NewLeague\"]])\ndms.head(2)","3f9bc4dd":"dms=dms[[\"League_N\",\"Division_W\",\"NewLeague_N\"]]\na=df.drop([\"Salary\",\"League\",\"Division\",\"NewLeague\"],axis=1)\nX=pd.concat([a,dms],axis=1)\nfrom sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.25, random_state=42)","6b4695a6":"X_train=pd.DataFrame(X_train[\"Hits\"])\nX_test=pd.DataFrame(X_test[\"Hits\"])","cdd388aa":"from sklearn.svm import SVR\nsvr_model=SVR(\"linear\").fit(X_train,y_train)","dfded23e":"svr_model.predict(X_train)[0:5]","4a64cfd6":"print(\"y=\",svr_model.intercept_[0],\"+\",svr_model.coef_[0][0],\"x\") #SVR PREDICTION MODEL","df6be11f":"svr_model.coef_[0]","83c175fb":"svr_model.coef_[0][0] # add one more square bracket to escape from array","134317c0":"X_train[\"Hits\"][0:1]","e198c5e8":"-48.69756097561513+4.969512195122206*X_train[\"Hits\"][0:1]   # What will be my salary if i score 91 points in a game? \n                                                            #403","cf830a46":"y_pred=svr_model.predict(X_train)","f7d1837a":"X_train.shape","3e07047f":"import matplotlib.pyplot as plt\nplt.scatter(X_train,y_train)\nplt.plot(X_train,y_pred, color=\"r\");   #SVR GRAPHIC ","bee16808":"#LINEAR REGRESSION FORMULA\nfrom sklearn.linear_model import LinearRegression\nlinear_model=LinearRegression().fit(X_train,y_train)\nlinear_predict=linear_model.predict(X_train)\nprint(linear_model.intercept_, \"+\",linear_model.coef_[0],\"x\")","c095db0a":"-8.814095480334572+5.1724561354706875*X_train[\"Hits\"][0:1]    # What will be my salary if i score 91 points in a game? \n                                                              #461","0d96887a":"#Linear Regression predict is 461, easy SVR model prediction is 403 for scoring 91 points","76337340":"plt.scatter(X_train,y_train)\nplt.plot(X_train,y_pred, color=\"r\")\nplt.plot(X_train, linear_model.predict(X_train), color=\"g\")   #Linear Regression(green) and SVR model(red) are together\nplt.xlabel(\"Hits\")\nplt.ylabel(\"Salary\");","1eb6b1fd":"#WHY SVR IS LOWER THAN LINEAR REGRESSION? \n#BECAUSE SVR IS ROBUST, IT IS LESS SENSITIVE TO OUTLIERS THAN LINEAR REGRESSION !!","3bed5323":"#IN BRIEFLY, PREDICTIONS ARE:","44143055":"svr_model.predict([[91]])","25ab72e9":"linear_model.predict([[91]])","f0f3a449":"from sklearn.metrics import mean_squared_error    \nnp.sqrt(mean_squared_error(y_test,svr_model.predict(X_test)))      #test error without tunning","0f446580":"svr_model       # we will tune \"c\" parameter in this model","639370c2":"svr_params={\"C\": np.arange(0.1,2,0.1)}\nfrom sklearn.model_selection import GridSearchCV\nsvr_cv_model=GridSearchCV(svr_model,svr_params,cv=10).fit(X_train,y_train)","657ef67c":"svr_cv_model.best_params_","4a129910":"pd.Series(svr_cv_model.best_params_)[0]","a1403fef":"svr_tuned_model=SVR(\"linear\",C=pd.Series(svr_cv_model.best_params_)[0]).fit(X_train,y_train)\ny_pred=svr_tuned_model.predict(X_test)\nnp.sqrt(mean_squared_error(y_test,y_pred))","ea29fb5d":"import pandas as pd\nfrom sklearn.model_selection import train_test_split\nhitters=pd.read_csv(\"..\/input\/hittlers\/Hitters.csv\")\ndf = hitters.copy()\ndf = df.dropna()\ndms = pd.get_dummies(df[['League', 'Division', 'NewLeague']])\ny = df[\"Salary\"]\nX_ = df.drop(['Salary', 'League', 'Division', 'NewLeague'], axis=1).astype('float64')\nX = pd.concat([X_, dms[['League_N', 'Division_W', 'NewLeague_N']]], axis=1)\nX_train, X_test, y_train, y_test = train_test_split(X, y, \n                                                    test_size=0.25, \n                                                    random_state=42)\nsvr_params={\"C\": np.arange(0.1,2,0.1)}\nfrom sklearn.model_selection import GridSearchCV\nsvr_cv_model=GridSearchCV(svr_model,svr_params,cv=10).fit(X_train,y_train)   #it takes time (more than 15 minutes) ","f38762bb":"svr_cv_model","7f653564":"y_pred=svr_cv_model.predict(X_test)\nnp.sqrt(mean_squared_error(y_test,y_pred))","2d138eb4":"# BEFORE THIS TIME, WE HAD ONLY ONE X VARIABLE(HITS) AND WE PREDICTED THE SALARY\n# NOW, WE HAVE MORE X VARIABLES. \n#AND WE KNOW THAT THESE VARIABLES ALSO HAVE POWER TO EXPLAIN VARIABILITY OF DEPENDENT VARIABLE\n#BECAUSE TEST ERROR DECREASED FROM 458 TO 367","af47521d":"#Thanks to https:\/\/github.com\/mvahit\/DSMLBC","d76cf327":"# 5.TEST ERROR FOR TUNED MODEL(INCLUDE ONE X VARIABLE)","3108103b":"# 2.SET AND FIT SVR MODEL","0c37b609":"## 1. IMPORT AND SPLIT DATA","e5bbbdfc":"# PLUS:  ASSESMENT FOR SALARY AND ALL VAR\u0130ABLES IN X","e80a7ca9":"# 4.SVR MODEL TUNNING","536992d6":"# TEST ERROR FOR UNTUNED SVR MODEL WHICH INCLUDED ONE X VARIABLE ","16a3fda3":"# EASY SVR\n## NOW WE HAVE Y VARIABLE AND ONLY ONE X VARIABLE ","104334a1":"# COMPARISON BETWEEN LINEAR REGRESSION AND SVR MODEL","f94ca4a2":"# SVR STEPS\n","3fb44ba7":"# THIS TEST ERROR IS ALSO LESS THAN THE TEST ERROR OF NONLINEAR REGRESSION MODEL KNN(THE PREVIOUS IPYNB)","8da4b4e4":"# 3.PREDICT Y FROM X TRAIN"}}