{"cell_type":{"bb839e27":"code","54197879":"code","a151a485":"code","7de1b7ae":"code","a39c1978":"code","fbf7315f":"code","0dbe88e6":"code","3257fb07":"code","41951d85":"code","8663319e":"code","e0f361e2":"code","9683740e":"code","87c9f6f9":"code","30f3416a":"code","426480f7":"code","2c0954c1":"code","8156e737":"code","58abd959":"code","be8e63fc":"markdown","87b763c6":"markdown"},"source":{"bb839e27":"\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nimport os\nprint(os.listdir(\"..\/input\"))\nimport lightgbm as gbm\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score\n","54197879":"train = pd.read_csv(\"..\/input\/train.csv\",index_col=0)\ntest = pd.read_csv(\"..\/input\/test.csv\",index_col=0)\ntrain.head(5)","a151a485":"train.info()","7de1b7ae":"train.describe()","a39c1978":"plt.figure(figsize=(8,6))\nsns.countplot(train['type'])\nplt.xticks(fontsize=20)\nplt.show()","fbf7315f":"sns.countplot(train['color'])\nplt.xticks(fontsize=15)\nplt.show()\nprint(train.groupby('color')['type'].count())","0dbe88e6":"g = sns.pairplot(train.loc[:,'bone_length':],hue=\"type\",palette= 'husl')","3257fb07":"train.groupby(['type','color'])['color'].count()","41951d85":"train_x=pd.get_dummies(train,columns=['color'],drop_first=True)\ntest_x = pd.get_dummies(test,columns=['color'],drop_first=True)\ntrain_label = train_x['type']\ntrain_x.drop('type',axis=1,inplace=True)\ntrain_val = train_x.values","8663319e":"model = RandomForestClassifier()\nmodel.fit(train_val,train_label)","e0f361e2":"imp=model.feature_importances_\nfeature_importances = pd.DataFrame(imp,index = train_x.columns,columns=['importance']).sort_values('importance',ascending=False)","9683740e":"plt.figure(figsize=(8,8))\nplt.barh(feature_importances.index,feature_importances.importance,color='r')\nplt.show()","87c9f6f9":"from sklearn.preprocessing import LabelEncoder\nlb = LabelEncoder()\nlb.fit(train_label)\ntrain_nc=lb.transform(train_label)\ntrain_nc","30f3416a":"mod = gbm.LGBMClassifier()\ntrain_lgb = gbm.Dataset(data = train_val,label = train_nc)","426480f7":"default = mod.get_params()\ndefault","2c0954c1":"N_FOLDS = 3\nMAX_EVALS=5\ndel default['n_estimators']\ncv_results = gbm.cv(default, train_lgb, num_boost_round = 10000, early_stopping_rounds = 100, \n                    metrics = 'auc', nfold = N_FOLDS, seed = 42)\ncv_results","8156e737":"test_val =test.values\nmod.n_estimators = len(cv_results['auc-mean'])\nmod.fit(train_val,train_nc)\npredictions=mod.predict(test_x)","58abd959":"ans=lb.inverse_transform(predictions)\nsubmission = pd.DataFrame({'id':test_x.index,'type':ans})\nsubmission.to_csv('submit.csv',index=False)","be8e63fc":"So there are 4 float type data columns, 1 int type and 2 object type which are for depicting colour and type.","87b763c6":"Let's explore data a little bit."}}