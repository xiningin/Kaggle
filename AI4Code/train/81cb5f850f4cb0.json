{"cell_type":{"9209d098":"code","3f6944f4":"code","823b162b":"code","1e68ce2e":"code","04ae5f61":"code","9857deff":"code","0c1732ab":"code","36e79025":"code","8826c845":"code","53e6a4cc":"code","9d2eafa4":"markdown"},"source":{"9209d098":"import numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport pandas as pd\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import train_test_split\nimport lightgbm as lgb\nfrom sklearn.metrics import accuracy_score","3f6944f4":"#Data Read\ndata_test=pd.read_csv(\"..\/input\/g-research-crypto-forecasting\/example_test.csv\")\nprint(\"test_data\")\ndata_test_=data_test.sort_values(\"Asset_ID\")\ndata_test_.head()\ndata_test_.describe().T.style.background_gradient(cmap = 'Blues')\\\n                          .bar(subset = [\"mean\",], color = 'lightgreen')\\\n                           .bar(subset = [\"std\"], color = '#ee1f5f')","823b162b":"data_train=pd.read_csv(\"..\/input\/g-research-crypto-forecasting\/train.csv\")\nprint(\"train_data\")\ndata_train_=data_train.sort_values(\"Asset_ID\")\ndata_train_.head()\ndata_train_.describe().T.style.background_gradient(cmap = 'Blues')\\\n                          .bar(subset = [\"mean\",], color = 'lightgreen')\\\n                           .bar(subset = [\"std\"], color = '#ee1f5f')","1e68ce2e":"#Check Null\ndef fillCheck(df):\n        n_val=df.isnull().sum()\n        pre=100*df.isnull().sum()\/len(df)\n        tdble=pd.concat([n_val,pre],axis=1)\n        ren_colum=tdble.rename(columns={0:\"Null Persent\",1:\"%\"})\n        return ren_colum","04ae5f61":"print(\"train_data\")\nfillCheck(data_train_) ","9857deff":"print(\"test_data\")\nfillCheck(data_test_)","0c1732ab":"#Data_Split\ndf_train,df_val=train_test_split(data_train_,test_size=0.3)\n\nX_train=df_train.drop(\"Target\",axis=1)\ny_train=df_train[\"Target\"]\n\nX_val=df_val.drop(\"Target\",axis=1)\ny_val=df_val[\"Target\"]","36e79025":"#LGB Modeling\nparams = {\n    'random_state':100,\n    'verbose':0,\n    #Learning model indicators\n    'metrics' : \"auc\"\n}\n\n\ntrain_d=lgb.Dataset(X_train,y_train)\nval_d=lgb.Dataset(X_val,y_val)\n\nmodel=lgb.train(params,train_d,valid_sets=val_d,num_boost_round=100,early_stopping_rounds=100)","8826c845":"#fitting\ndata_x=data_test_.drop(\"group_num\",axis=1)\ndata_X=data_x.drop(\"row_id\",axis=1)\n\npred=model.predict(data_X)","53e6a4cc":"#submit\nPassengerId=data_test_[\"Asset_ID\"]\nprint(PassengerId.shape)\nprint(PassengerId.head())\nPredictions=pd.DataFrame(data=pred,index=PassengerId,columns=['Target'])\nPredictions.to_csv(\"submission.csv\")","9d2eafa4":"Hi all. This Note book checks data, and LightBGM template"}}