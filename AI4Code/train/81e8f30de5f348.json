{"cell_type":{"45f671e9":"code","ed8eac35":"code","15d7d369":"code","7648eb00":"code","18236145":"code","793c788f":"markdown"},"source":{"45f671e9":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","ed8eac35":"import sys\n!test -d bertviz_repo && echo \"FYI: bertviz_repo directory already exists, to pull latest version uncomment this line: !rm -r bertviz_repo\"\n# !rm -r bertviz_repo # Uncomment if you need a clean pull from repo\n!test -d bertviz_repo || git clone https:\/\/github.com\/jessevig\/bertviz bertviz_repo\nif not 'bertviz_repo' in sys.path:\n  sys.path += ['bertviz_repo']\n!pip install regex\n!pip install transformers","15d7d369":"\nfrom bertviz import head_view\nfrom transformers import BertTokenizer, BertModel","7648eb00":"def call_html():\n  import IPython\n  display(IPython.core.display.HTML('''\n        <script src=\"\/static\/components\/requirejs\/require.js\"><\/script>\n        <script>\n          requirejs.config({\n            paths: {\n              base: '\/static\/base',\n              \"d3\": \"https:\/\/cdnjs.cloudflare.com\/ajax\/libs\/d3\/3.5.8\/d3.min\",\n              jquery: '\/\/ajax.googleapis.com\/ajax\/libs\/jquery\/2.0.0\/jquery.min',\n            },\n          });\n        <\/script>\n        '''))","18236145":"model_version = 'bert-base-uncased'\ndo_lower_case = True\nmodel = BertModel.from_pretrained(model_version, output_attentions=True)\ntokenizer = BertTokenizer.from_pretrained(model_version, do_lower_case=do_lower_case)\n\nsentence_a = \"What is the inheritance pattern of Li\\u2013Fraumeni syndrome?\"\nsentence_b = \"Balanced t(11;15)(q23;q15) in a TP53+\/+ breast cancer patient from a Li-Fraumeni syndrome family. Li-Fraumeni Syndrome (LFS) is characterized by early-onset carcinogenesis involving multiple tumor types and shows autosomal dominant inheritance.\"\ninputs = tokenizer.encode_plus(sentence_a, sentence_b, return_tensors='pt', add_special_tokens=True)\ntoken_type_ids = inputs['token_type_ids']\ninput_ids = inputs['input_ids']\nattention = model(input_ids, token_type_ids=token_type_ids)[-1]\ninput_id_list = input_ids[0].tolist() # Batch index 0\ntokens = tokenizer.convert_ids_to_tokens(input_id_list)\ncall_html()\n\nhead_view(attention, tokens)","793c788f":"This tool helps to visualize the attention score for each word corrosponding to each word. We can hover on the words to see the same."}}