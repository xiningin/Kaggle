{"cell_type":{"d8f502ba":"code","8bbc1f42":"code","d561e202":"code","1b11a487":"code","238fdf23":"code","b8b5abf4":"code","13ae1961":"code","d7c549a3":"code","bac93b5d":"code","f6e16c00":"code","fa798d34":"code","9875c7c7":"code","c8f919fb":"code","c490fc3b":"code","ba6c8eda":"code","92dc08e9":"markdown","cc50b9df":"markdown","7ef30b3b":"markdown","51b03805":"markdown","4ad73ae2":"markdown","72d2ef74":"markdown"},"source":{"d8f502ba":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport warnings\nwarnings.simplefilter(action='ignore', category=Warning)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","8bbc1f42":"df=pd.read_csv('\/kaggle\/input\/rationalist-thinkers\/Rationalism_works_corpus.csv',encoding ='ISO-8859-1',sep=\",\")\ndf.head()","d561e202":"df.isnull().sum()","1b11a487":"import gensim\n\nimport lightgbm as lgb\n\nfrom sklearn.model_selection import KFold\nfrom sklearn.metrics import r2_score\nfrom sklearn.metrics import mean_squared_error","238fdf23":"data_dir = '..\/input\/rationalist-thinkers\/'\nsample_submission = pd.read_csv(data_dir + 'Rationalism_works_corpus.csv')\ntarget = df['publishing_date'].to_numpy()","b8b5abf4":"#Code by Syurenuko https:\/\/www.kaggle.com\/syurenuko\/clrp-word2vec-lightgbm-baseline\/data\n\nword2vec_model = gensim.models.KeyedVectors.load_word2vec_format('..\/input\/googlenewsvectorsnegative300\/GoogleNews-vectors-negative300.bin', binary=True)\nprint(word2vec_model.vectors.shape)","13ae1961":"#Code by Syurenuko https:\/\/www.kaggle.com\/syurenuko\/clrp-word2vec-lightgbm-baseline\/data\n\ndef avg_feature_vector(sentence, model, num_features):\n    words = sentence.replace('\\n',\" \").replace(',',' ').replace('.',\" \").split()\n    feature_vec = np.zeros((num_features,),dtype=\"float32\")#\u7279\u5fb4\u30d9\u30af\u30c8\u30eb\u306e\u521d\u671f\u5316\n    i=0\n    for word in words:\n        try:\n            feature_vec = np.add(feature_vec, model[word])\n        except KeyError as error:\n            feature_vec \n            i = i + 1\n    if len(words) > 0:\n        feature_vec = np.divide(feature_vec, len(words)- i)\n    return feature_vec","d7c549a3":"#Code by Syurenuko https:\/\/www.kaggle.com\/syurenuko\/clrp-word2vec-lightgbm-baseline\/data\n\nword2vec_df = np.zeros((len(df.index),300),dtype=\"float32\")#\u7279\u5fb4\u30d9\u30af\u30c8\u30eb\u306e\u521d\u671f\u5316\n#word2vec_test = np.zeros((len(test.index),300),dtype=\"float32\")\n\nfor i in range(len(df.index)):\n    word2vec_df[i] = avg_feature_vector(df[\"text_clean\"][i],word2vec_model, 300)\n    \n#for i in range(len(test.index)):\n #   word2vec_test[i] = avg_feature_vector(test[\"text_clean\"][i],word2vec_model, 300)","bac93b5d":"print(word2vec_df.shape)\nprint(target.shape)\n#print(word2vec_test.shape)","f6e16c00":"#Code by Syurenuko https:\/\/www.kaggle.com\/syurenuko\/clrp-word2vec-lightgbm-baseline\/data\n\n#parameter settings\nparams = {\n    'boosting_type': 'gbdt',\n    'metric': 'rmse',\n    'objective': 'regression',\n    'seed': 42,\n    'learning_rate': 0.01,\n    \"n_jobs\": -1,\n    \"verbose\": -1\n}\n\npred = np.zeros(df.shape[0])","fa798d34":"#KFold \u3000n_splits=5\nfrom sklearn.model_selection import KFold\nfold = KFold(n_splits=5, shuffle=True, random_state=42)\ncv=list(fold.split(word2vec_df, target))","9875c7c7":"#Code by Syurenuko https:\/\/www.kaggle.com\/syurenuko\/clrp-word2vec-lightgbm-baseline\/data\n\nrmses = []\nfor tr_idx, val_idx in cv: \n    x_tr, x_va = word2vec_df[tr_idx], word2vec_df[val_idx]\n    y_tr, y_va = target[tr_idx], target[val_idx]\n        \n    df_set = lgb.Dataset(x_tr, y_tr)\n    val_set = lgb.Dataset(x_va, y_va, reference=df_set)\n        \n    # Training\n    model = lgb.train(params, df_set, num_boost_round=10000, early_stopping_rounds=100,\n                      valid_sets=[df_set, val_set], verbose_eval=-1)#lgb.train is module train. Don't write df\n        \n    y_pred = model.predict(x_va)\n    rmse =  np.sqrt(mean_squared_error(y_va, y_pred))\n    rmses.append(rmse)\n        \n    #Inference\n   # test_pred = model.predict(word2vec_test)\n    #pred += test_pred \/ 5  \n        \nprint(\"\\n\", \"Mean Fold RMSE:\", np.mean(rmses))","c8f919fb":"#Saving for the next competition\n\nsample_submission.target = pred\nsample_submission.to_csv('Rationalism_works_corpus.csv',index=False)","c490fc3b":"#sample_submission","ba6c8eda":"#2nd row. And 6th column, text_clean \n\ndf.iloc[1,5]","92dc08e9":"#Embedding by Word2vec","cc50b9df":"#Thanks to Syurenuko https:\/\/www.kaggle.com\/syurenuko\/clrp-word2vec-lightgbm-baseline\/data\n\nAgain.\n","7ef30b3b":"#Code by Syurenuko https:\/\/www.kaggle.com\/syurenuko\/clrp-word2vec-lightgbm-baseline\/data","51b03805":"#Rationalism\n\nIn philosophy, rationalism is the epistemological view that \"regards reason as the chief source and test of knowledge\" or \"any view appealing to reason as a source of knowledge or justification\". More formally, rationalism is defined as a methodology or a theory \"in which the criterion of the truth is not sensory but intellectual and deductive.\n\nhttps:\/\/en.wikipedia.org\/wiki\/Rationalism","4ad73ae2":"![](https:\/\/www.researchgate.net\/profile\/Raid-Al-Ani\/post\/What_is_the_difference_between_Rationalism_Empiricism_give_your_opinion\/attachment\/59d7936df3ec044767de8d04\/AS%3A546396342554624%401507282447588\/image\/RationalismEmpiricism.png)researchgate.net","72d2ef74":"#Training & Inference\n\nlightgbm (KFold=5)"}}