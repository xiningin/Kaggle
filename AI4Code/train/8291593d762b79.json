{"cell_type":{"09aa17d6":"code","b72a7e57":"code","972517be":"code","28ab0213":"code","24331764":"code","c24d8644":"code","751063b6":"markdown","d7cd1478":"markdown"},"source":{"09aa17d6":"#Importando Libs\nimport tensorflow\nfrom tensorflow.keras.applications.resnet50 import ResNet50\nfrom tensorflow.keras.preprocessing import image\nfrom tensorflow.keras.applications.resnet50 import preprocess_input, decode_predictions\nimport numpy as np\n# Plot\nimport matplotlib.pyplot as plt\n%matplotlib inline","b72a7e57":"# Carregando o modelo ResNet pr\u00e9-treinado no ImageNet\nmodel = ResNet50(weights='imagenet')","972517be":"#Buscando alguma imagem da Internet\nimport requests\n\nurl = 'https:\/\/fotos.jornaldocarro.estadao.com.br\/uploads\/2020\/01\/03062028\/Onix-2020-Hatch-2-1160x774.jpg'\nurl = 'https:\/\/quatrorodas.abril.com.br\/wp-content\/uploads\/2019\/04\/imagem7-e1584036891780.jpg?quality=70&strip=info'\nurl = 'https:\/\/www.calimaro.com.br\/media\/catalog\/product\/cache\/1\/image\/9df78eab33525d08d6e5fb8d27136e95\/s\/h\/shelter-violao-de-aco-auditorium-sag500prsx-nm-natural-matte-principal.jpg'\nurl = 'https:\/\/http2.mlstatic.com\/lote-com-4-peixe-palhaco-ocelaris-com-brinde-marinho-D_NQ_NP_900038-MLB27109155440_032018-F.webp'\nr = requests.get(url, allow_redirects=True)\n\nopen('test.jpg', 'wb').write(r.content)","28ab0213":"# Abrindo arquivo salvo e botando no formato da Resnet\nimg_path = '.\/test.jpg'\nimg = image.load_img(img_path, target_size=(224, 224))\nx = image.img_to_array(img)\nx = np.expand_dims(x, axis=0)\nx = preprocess_input(x)\n\npreds = model.predict(x)\n# Resultados como uma lista de (classid, descri\u00e7\u00e3o, probabilidade).\nprint('Predicted:', decode_predictions(preds, top=3)[0])","24331764":"#Visualizando\nimport matplotlib.pyplot as plt\n%matplotlib inline\nplt.imshow(img)","c24d8644":"#Mas como \u00e9 esse modelo?\nmodel.summary()","751063b6":"# Introdu\u00e7\u00e3o","d7cd1478":"**Resumo:**\n\nO exemplo aqui desenvolvido tem como objetivo apresentar conceitos iniciais de implementa\u00e7\u00e3o de redes neurais com python e tensorflow\/keras. Esse exemplo mostra o uso da arquitetura cl\u00e1ssica ResNet50, dispon\u00edvel no keras, pr\u00e9-treinada no dataset do ImageNet para reconhecimento de imagens. Alguns exemplos de imagens s\u00e3o buscados da internet para teste.\n\n**N\u00e3o \u00e9 objetivo nosso desenvolver e otimizar o modelo de classifica\u00e7\u00e3o**. O exemplo tem objetivo meramente did\u00e1tico.\n\n---\n\n**Para saber mais:**\n* [Palestras e cursos do Ocean](http:\/\/www.oceanbrasil.com\/)\n* Fran\u00e7ois Chollet. Deep Learning with Python. Manning Publications, 2017.\n* Ian Goodfellow and Yoshua Bengio and Aaron Courville. [Deep Learning](https:\/\/www.deeplearningbook.org\/). MIT Press, 2016."}}