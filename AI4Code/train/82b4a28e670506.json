{"cell_type":{"605697b1":"code","875c9931":"code","839dc322":"code","dfc247c2":"code","11f184e9":"code","e048f166":"code","74eacaf7":"code","a13a7a2f":"code","feb4f1f0":"code","59db54aa":"code","ecc446dc":"code","c7cf1073":"code","9ed08c96":"code","59e3713e":"code","df8d46f4":"code","6720a48e":"code","5a0c26d7":"code","e33a350b":"code","3bd7971a":"code","d3e8c04d":"code","bfe88066":"code","b1b4930a":"code","6707cdd7":"markdown","59621667":"markdown","caf6d35c":"markdown","861e56ea":"markdown","028dd9a7":"markdown","c4c6d185":"markdown","c838072d":"markdown","6a534ae9":"markdown","0334d3ac":"markdown","e7ab75f3":"markdown","1f019e07":"markdown","9f8d584b":"markdown","2b61824b":"markdown","927f13a8":"markdown","34834b25":"markdown","743adf4e":"markdown","41fd42a2":"markdown","f0507ed3":"markdown","1bc63398":"markdown","d5777f6a":"markdown","294472a7":"markdown"},"source":{"605697b1":"import tensorflow as tf\nfrom keras.preprocessing.image import ImageDataGenerator\nimport numpy as np\nfrom PIL import Image\nfrom IPython.display import Image\nimport matplotlib.pyplot as plt","875c9931":"# import warnings\n# warnings.filterwarnings('ignore')","839dc322":"train_datagen = ImageDataGenerator(rescale = 1.\/255,\n                                   shear_range = 0.2,\n                                   zoom_range = 0.2,\n                                   horizontal_flip = True)","dfc247c2":"test_datagen = ImageDataGenerator(rescale = 1.\/255)","11f184e9":"training_set = train_datagen.flow_from_directory('\/kaggle\/input\/dauntomat\/train',\n                                                 target_size = (64, 64),\n                                                 class_mode = 'binary')","e048f166":"test_set = test_datagen.flow_from_directory('\/kaggle\/input\/dauntomat\/test',\n                                            target_size = (64, 64),\n                                            class_mode = 'binary')","74eacaf7":"cnn = tf.keras.models.Sequential()","a13a7a2f":"cnn.add(tf.keras.layers.Conv2D(filters=32, kernel_size=3, padding=\"same\", activation=\"relu\", input_shape=[64, 64, 3]))","feb4f1f0":"cnn.add(tf.keras.layers.MaxPool2D(pool_size=2, strides=2, padding='valid'))","59db54aa":"#to improve accuracy\ncnn.add(tf.keras.layers.Conv2D(filters=32, kernel_size=3, padding=\"same\", activation=\"relu\"))\ncnn.add(tf.keras.layers.MaxPool2D(pool_size=2, strides=2, padding='valid'))\n\n#to improve accuracy\ncnn.add(tf.keras.layers.Conv2D(filters=32, kernel_size=3, padding=\"same\", activation=\"relu\"))\ncnn.add(tf.keras.layers.MaxPool2D(pool_size=2, strides=2, padding='valid'))\n\n","ecc446dc":"cnn.add(tf.keras.layers.Flatten())","c7cf1073":"cnn.add(tf.keras.layers.Dense(units=128, activation='relu'))\n# cnn.add(tf.keras.layers.Dense(units=128, activation='relu'))","9ed08c96":"cnn.add(tf.keras.layers.Dense(units=1, activation='sigmoid'))","59e3713e":"cnn.compile(optimizer = 'adam', loss = 'binary_crossentropy', metrics = ['accuracy'])","df8d46f4":"history=cnn.fit(\n        x=training_set,\n        epochs=40,\n        validation_data=test_set,\n        validation_steps=len(test_set))","6720a48e":"print(history.history.keys())\nplt.plot(history.history['accuracy'])\nplt.plot(history.history['val_accuracy'])\nplt.title('model accuracy')\nplt.ylabel('accuracy')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'], loc='upper left')\nplt.show()\n# summarize history for loss\nplt.plot(history.history['loss'])\nplt.plot(history.history['val_loss'])\nplt.title('model loss')\nplt.ylabel('loss')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'], loc='upper left')\nplt.show()","5a0c26d7":"import numpy as np\nfrom keras.preprocessing import image","e33a350b":"def predict_img(img_path):\n    test_image=image.load_img(img_path,target_size=(64,64,3))\n    test_image=image.img_to_array(test_image)\n    test_image=np.expand_dims(test_image,axis=0)\n    result=cnn.predict(test_image)\n    training_set.class_indices\n    if result[0][0]==1:\n        prediction ='Daun_tomato_sehat'\n    else:\n        prediction='Daun_tomato_sakit'\n    print(prediction)","3bd7971a":"predict_img(img_path='\/kaggle\/input\/dauntomat\/train\/sakit\/0012b9d2-2130-4a06-a834-b1f3af34f57e___RS_Erly.B 8389.JPG')\nImage(filename='\/kaggle\/input\/dauntomat\/train\/sakit\/0012b9d2-2130-4a06-a834-b1f3af34f57e___RS_Erly.B 8389.JPG')","d3e8c04d":"predict_img(img_path='\/kaggle\/input\/dauntomat\/train\/sehat\/sehat (1).JPG')\nImage(filename='\/kaggle\/input\/dauntomat\/train\/sehat\/sehat (1).JPG')","bfe88066":"predict_img(img_path='\/kaggle\/input\/dauntomat\/train\/sehat\/sehat (10).JPG')\nImage(filename='\/kaggle\/input\/dauntomat\/train\/sehat\/sehat (10).JPG')","b1b4930a":"predict_img(img_path='\/kaggle\/input\/dauntomat\/train\/sakit\/0034a551-9512-44e5-ba6c-827f85ecc688___RS_Erly.B 9432.JPG')\nImage(filename='\/kaggle\/input\/dauntomat\/train\/sakit\/0034a551-9512-44e5-ba6c-827f85ecc688___RS_Erly.B 9432.JPG')","6707cdd7":"## Data Preprocessing","59621667":"### Compiling the CNN","caf6d35c":"### Generating images for the Training set","861e56ea":"# Convolutional Neural Network","028dd9a7":"### Flattening","c4c6d185":"### Full Connection","c838072d":"## Building the CNN","6a534ae9":"### Creating the Training set","0334d3ac":"### Training the CNN on the Training set and evaluating it on the Test set","e7ab75f3":"![](dataset\/single_prediction\/cat_or_dog_1.jpg)","1f019e07":"### Initialising the CNN","9f8d584b":"### Output Layer","2b61824b":"### Convolution","927f13a8":"### Generating images for the Test set","34834b25":"### Adding another convolutional layers","743adf4e":"### Importing the libraries","41fd42a2":"### Pooling","f0507ed3":"### Creating the Test set","1bc63398":"## Predicting unseen Images","d5777f6a":"## Training the CNN","294472a7":"![](dataset\/single_prediction\/cat_or_dog_2.jpg)"}}