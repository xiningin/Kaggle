{"cell_type":{"b800b1ef":"code","9d205a07":"code","f9482c10":"code","0482062f":"code","7ecb44fa":"code","51865e13":"code","c52cf1ce":"code","1fd5477f":"code","788794d6":"code","62b0c6dc":"code","999422fb":"code","c088d70f":"code","30633fb1":"code","32f63553":"code","3c966bab":"code","a275c686":"code","d871ca43":"code","ae542de7":"code","cc248973":"code","91007723":"code","5d7adc07":"code","38170c8e":"code","5897320f":"code","34b1a14c":"code","7651d3c6":"code","8e315389":"code","f2df14b6":"code","2c3ac6cc":"code","fdb2c573":"code","572a0218":"code","7b01b3d7":"code","6352834d":"code","7c7ec23a":"code","9fdd90b6":"code","f75acaa1":"code","bc08e5de":"code","30179bc7":"code","4bd39040":"markdown","e7c4a51f":"markdown","f9626af9":"markdown","8ddbc3dd":"markdown","c745e752":"markdown","cc589102":"markdown","345c6585":"markdown","01a57ba1":"markdown","26f5865f":"markdown"},"source":{"b800b1ef":"import pandas as pd \nimport numpy as np\nimport pickle\n\nfrom PIL import Image\n\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import RandomizedSearchCV\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import precision_score\nfrom sklearn.metrics import recall_score\nfrom sklearn.neural_network import MLPClassifier\n\nimport matplotlib.pyplot as plt","9d205a07":"df_train = pd.read_csv('..\/input\/mnist-in-csv\/mnist_train.csv')\ndf_train","f9482c10":"df_train = df_train.reindex(np.random.permutation(df_train.index))","0482062f":"df_train.shape","7ecb44fa":"X_train = df_train.drop(columns = ['label'])\nX_train","51865e13":"y_train = df_train['label']\ny_train","c52cf1ce":"df_test = pd.read_csv('..\/input\/mnist-in-csv\/mnist_test.csv')\ndf_test","1fd5477f":"df_test = df_test.reindex(np.random.permutation(df_test.index))","788794d6":"# df_test = df_test.drop(df_test.index[999:9999]) # Don't run more than once","62b0c6dc":"df_test.shape","999422fb":"X_test = df_test.drop(columns = ['label'])\nX_test","c088d70f":"y_test = df_test['label']\ny_test","30633fb1":"normal_forest = RandomForestClassifier(random_state = 1)","32f63553":"nf_model = normal_forest.fit(X_train, y_train)","3c966bab":"nf_predictions = nf_model.predict(X_test)","a275c686":"mean_absolute_error(y_test, nf_predictions)","d871ca43":"accuracy_score(y_test, nf_predictions)*100 # %","ae542de7":"precision_score(y_test, nf_predictions, average='macro')*100 # %","cc248973":"recall_score(y_test, nf_predictions, average='macro')*100 # %","91007723":"nn = MLPClassifier()","5d7adc07":"nn.fit(X_train, y_train)","38170c8e":"nn_predictions = nn.predict(X_test)","5897320f":"mean_absolute_error(y_test, nn_predictions)","34b1a14c":"accuracy_score(y_test, nn_predictions)*100 # %","7651d3c6":"precision_score(y_test, nn_predictions, average='macro')*100 # %","8e315389":"recall_score(y_test, nn_predictions, average='macro')*100 # %","f2df14b6":"filename = 'rf_model.sav'\npickle.dump(nf_model, open(filename, 'wb'))","2c3ac6cc":"filename2 = 'good_nn.sav'\npickle.dump(nn, open(filename2, 'wb'))","fdb2c573":"img1 = Image.open(\"..\/input\/shapes\/0.png\").convert(mode=\"1\")\narray1 = np.array(img1.getdata())","572a0218":"img2 = Image.open(\"..\/input\/shapes\/1.png\").convert(mode=\"1\")\narray2 = np.array(img2.getdata())","7b01b3d7":"df_myimages = pd.DataFrame(np.array([array1,array2]))","6352834d":"df_myimages","7c7ec23a":"nf_model.predict(df_myimages)","9fdd90b6":"i = X_test.loc[200]\nplt.imshow(np.array(i).reshape(28,28))","f75acaa1":"df = pd.DataFrame(i)\ndf = df.transpose()","bc08e5de":"nf_model.predict(df)","30179bc7":"nn.predict(df)","4bd39040":"# Imports","e7c4a51f":"**Predict with my images**","f9626af9":"# Random Forest Classifier\n","8ddbc3dd":"# Saving models\n","c745e752":"# Optimizing Hyperparameters for Random Forest\n\n","cc589102":"# Reading csv and spliting data","345c6585":"# Neural Network (in progress)\n","01a57ba1":"# Predicting using MINST images","26f5865f":"# Testing with my own digits"}}