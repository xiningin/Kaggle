{"cell_type":{"8a4e873b":"code","732fbaf1":"code","a3a12afa":"code","791dbdd8":"code","91736f66":"code","775f1480":"code","09023c65":"code","084cc9a3":"code","48ad8999":"code","bd45f38f":"code","bb8dddd3":"code","f3a42abf":"code","c0ddc047":"code","231c8a53":"code","d6505e48":"code","77232cc9":"code","e4456f3f":"code","7b69e6f5":"code","126028a4":"code","0982df5c":"code","ee5c96f8":"code","d6539e61":"markdown","3db32744":"markdown","1d3198e9":"markdown"},"source":{"8a4e873b":"import numpy as np\nimport pandas as pd\n\nimport plotly.express as px\nimport plotly.graph_objs as go\n\nfrom datetime import date","732fbaf1":"data = pd.read_csv('\/kaggle\/input\/ecommerce-purchase-history-from-electronics-store\/kz.csv')\n\ndata.head(5)","a3a12afa":"data.dtypes","791dbdd8":"data.set_index('order_id', inplace=True)","91736f66":"null_columns = data.columns[data.isnull().any()]\ndata[null_columns].isnull().sum()","775f1480":"n_unique_products = data['product_id'].nunique()\nn_unique_users = data['user_id'].nunique()\nprint('Number of unique users: ' + str(n_unique_users) +'. Number of unique products is: ' + str(n_unique_products))","09023c65":"data['event_time']=pd.to_datetime(data['event_time'])","084cc9a3":"data.dropna(subset=['category_code'],inplace=True)","48ad8999":"#Getting the main category from the category_code\ndata['category'] = data['category_code'].str.rsplit('.', n=1, expand=True)[1]\ndata.drop(columns=['category_code'], inplace=True)","bd45f38f":"#best performing brands\nbest_performing_brands = data.groupby('brand')['price'].sum().reset_index().sort_values('price', ascending=False).head(10)","bb8dddd3":"fig = px.bar(\n    best_performing_brands, \n    x='brand', \n    y='price', \n    title='Best performing brands',\n    width=800, \n    height=800\n)\n\nfig.show()","f3a42abf":"#most sold brands\nmost_sold_brands = data.groupby('brand')['price'].agg('count').reset_index().sort_values('price', ascending=False).head(10)\nmost_sold_brands.rename(columns={\"brand\": \"brand\", \"price\": \"times_sold\"}, inplace=True)","c0ddc047":"fig = px.bar(\n    most_sold_brands, \n    x='brand', \n    y='times_sold', \n    title='Most sold brands',\n    width=800, \n    height=800\n)\n\nfig.show()","231c8a53":"#most bought categories\nmost_sold_categories = data.groupby('category')['price'].agg('count').reset_index().sort_values('price', ascending=False).head(10)\nmost_sold_categories.rename(columns={\"category\": \"category\", \"price\": \"times_sold\"}, inplace=True)","d6505e48":"fig = px.bar(\n    most_sold_categories, \n    x='category', \n    y='times_sold', \n    title='Most sold categories',\n    width=800, \n    height=800\n)\n\nfig.show()","77232cc9":"#best time for purchase. filter with lambda <900 as a lot of data was on 1970-1-1 12 am\nbest_time = data.groupby(data['event_time'].dt.strftime('%r'))['price'].sum().sort_values()[lambda x: x<= 900000].tail(10)","e4456f3f":"fig = px.bar(\n    best_time,\n    x=\"price\", \n    orientation='h', \n    title=\"At what time most of the purchases were made\", \n    width=800, \n    height=800\n)\n\nfig.show()","7b69e6f5":"#montly purchases\nbest_month = data.groupby(data['event_time'].dt.strftime('%B'))['price'].sum().sort_values()","126028a4":"fig = px.bar(\n    best_month,\n    x=\"price\", \n    orientation='h', \n    title=\"In which months most of the purchases were made\", \n    width=800, \n    height=800\n)\n\nfig.show()","0982df5c":"# How much money spent 20% of top buyers in comparison with other 80% of clients\nmost_active_users = data.groupby('user_id')['price'].sum().reset_index().sort_values('price', ascending=False).head(round((data['user_id'].nunique())*0.2))\nleast_active_users = data.groupby('user_id')['price'].sum().reset_index().sort_values('price', ascending=False).tail(round((data['user_id'].nunique())*0.8))\ntop_20_percent_buyers = most_active_users['price'].sum()\nbottom_80_percent_buyers = least_active_users['price'].sum()\nlast_data = pd.DataFrame(data={'most_active': [most_active_users['price'].sum()], 'least_active': [least_active_users['price'].sum()]})","ee5c96f8":"fig = px.bar(\n    last_data,  \n    title=\"20% of most active in comparison with other 80% of buyers\", \n    width=800, \n    height=800\n)\n\nfig.show()","d6539e61":"****Best performing brands","3db32744":"# Analyzing data","1d3198e9":"Cleaning the Data"}}