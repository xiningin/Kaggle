{"cell_type":{"7114a123":"code","b4aaa138":"code","107d99c0":"code","eeccc7db":"code","c4b7b147":"code","6889c777":"code","5ee0ca43":"code","76059a30":"code","2f70a6c3":"code","b1950356":"code","d3feefed":"code","3fcedd6c":"code","4e535d09":"code","e68a1c4b":"markdown","42ac88ba":"markdown","3bdb7e62":"markdown","f87eb5ca":"markdown","9e15a3da":"markdown","3269ebb7":"markdown","90dbd1be":"markdown","5757bf9e":"markdown","457ccc88":"markdown","48e5b9d7":"markdown","710feb86":"markdown","66590dfa":"markdown","7f775f9f":"markdown","bd559f10":"markdown"},"source":{"7114a123":"import os\n\n\nimport random\nimport seaborn as sns\nimport cv2\n\n# General packages\nimport pandas as pd\nimport numpy as np\nimport matplotlib\nimport matplotlib.pyplot as plt\nimport PIL\nimport IPython.display as ipd\nimport glob\nimport h5py\nimport plotly.graph_objs as go\nimport plotly.express as px\nfrom PIL import Image\nfrom tempfile import mktemp\n\nfrom bokeh.layouts import column, row\nfrom bokeh.models import ColumnDataSource, LinearAxis, Range1d\nfrom bokeh.models.tools import HoverTool\nfrom bokeh.palettes import BuGn4\nfrom bokeh.plotting import figure, output_notebook, show\nfrom bokeh.transform import cumsum\nfrom math import pi\n\noutput_notebook()\n\n\nfrom IPython.display import Image, display\nimport warnings\nwarnings.filterwarnings(\"ignore\")","b4aaa138":"os.listdir('..\/input\/landmark-recognition-2021\/')\n","107d99c0":"BASE_PATH = '..\/input\/landmark-recognition-2021'\n\nTRAIN_DIR = f'{BASE_PATH}\/train'\nTEST_DIR = f'{BASE_PATH}\/test'\n\nprint('Reading data...')\ntrain = pd.read_csv(f'{BASE_PATH}\/train.csv')\nsubmission = pd.read_csv(f'{BASE_PATH}\/sample_submission.csv')\nprint('Reading data completed')","eeccc7db":"display(train.head())\nprint(\"Shape of train_data :\", train.shape)","c4b7b147":"display(submission.head())\nprint(\"Shape of submission :\", submission.shape)","6889c777":"# displaying only top 30 landmark\nlandmark = train.landmark_id.value_counts()\nlandmark_df = pd.DataFrame({'landmark_id':landmark.index, 'frequency':landmark.values}).head(30)\n\nlandmark_df['landmark_id'] =   landmark_df.landmark_id.apply(lambda x: f'landmark_id_{x}')\n\nfig = px.bar(landmark_df, x=\"frequency\", y=\"landmark_id\",color='landmark_id', orientation='h',\n             hover_data=[\"landmark_id\", \"frequency\"],\n             height=1000,\n             title='Number of images per landmark_id (Top 30 landmark_ids)')\nfig.show()","5ee0ca43":"import PIL\nfrom PIL import Image, ImageDraw\n\n\ndef display_images(images, title=None): \n    f, ax = plt.subplots(5,5, figsize=(18,22))\n    if title:\n        f.suptitle(title, fontsize = 30)\n\n    for i, image_id in enumerate(images):\n        image_path = os.path.join(TRAIN_DIR, f'{image_id[0]}\/{image_id[1]}\/{image_id[2]}\/{image_id}.jpg')\n        image = Image.open(image_path)\n        \n        ax[i\/\/5, i%5].imshow(image) \n        image.close()       \n        ax[i\/\/5, i%5].axis('off')\n\n        landmark_id = train[train.id==image_id.split('.')[0]].landmark_id.values[0]\n        ax[i\/\/5, i%5].set_title(f\"ID: {image_id.split('.')[0]}\\nLandmark_id: {landmark_id}\", fontsize=\"12\")\n\n    plt.show() ","76059a30":"samples = train.sample(25).id.values\ndisplay_images(samples)","2f70a6c3":"samples = train[train.landmark_id == 89894].sample(25).id.values\n\ndisplay_images(samples)","b1950356":"samples = train[train.landmark_id == 82267].sample(25).id.values\n\ndisplay_images(samples)","d3feefed":"samples = train[train.landmark_id == 162833].sample(25).id.values\n\ndisplay_images(samples)","3fcedd6c":"samples = train[train.landmark_id == 10419].sample(25).id.values\n\ndisplay_images(samples)","4e535d09":"sample_submission = pd.read_csv('..\/input\/landmark-recognition-2021\/sample_submission.csv')\nsample_submission.to_csv('submission.csv',index=False)","e68a1c4b":"<div class=\"alert alert-block alert-danger\">  \n<h2><center><strong>Loading the data \ud83d\udcc1 \ud83d\udcc2<\/strong><\/center><\/h2>\n        \n<\/div>","42ac88ba":"### Visualizing landmark with images (landmark_id: 89894)","3bdb7e62":"### The dataset comprises of following important files:\n\n* **train.csv**: This file contains, ids and targets\n    * `id`: image id\n    * `landmark_id`: target landmark id\n    \n\n* The training set is available in the `train\/` folder, with corresponding landmark labels in `train.csv`. \n* The test set images are listed in the `test\/` folder. Each image has a unique id. \n\n> Note: Since there are a large number of images, each image is placed within three subfolders according to the first three characters of the image id (i.e. image abcdef.jpg is placed in a\/b\/c\/abcdef.jpg).\n","f87eb5ca":"## More code is coming Soon. Please upvote if you like the work and you will get notifications with additions. \n\n<center><img src=\"https:\/\/thumbs.gfycat.com\/AshamedWeightyDachshund-max-1mb.gif\"><\/center>","9e15a3da":"<div class=\"alert alert-block alert-danger\">  \n<h2><center><strong>Exploratory data analysis \ud83d\udd0e \ud83d\udcca<\/strong><\/center><\/h2>\n        \n<\/div>\n\n### Target Distribution (Number of images per landmark_id)\n","3269ebb7":"# Visualizing landmark images (landmark_id: 10419)","90dbd1be":"**Inference**\n\n* There are 81313 unique landmark_ids\n* There is only one landmark which has more than 2300 images (landmark_id: 138982)\n* Number of images per landmark_id ranges from 2 to 6272.\n* Out of 81313, there are 79298 (97.5%) landmark_ids with less than 100 images.","5757bf9e":"<div class=\"alert alert-block alert-info\">  \n    <center><h3><strong>\ud83d\udc68\u200d\ud83d\udcbb Getting Started with Google Landmark Retrieval 2021<\/strong><\/h3><\/center>\n    <i><\/i>\n<\/div>","457ccc88":"<div class=\"alert alert-block alert-danger\">  \n<h2><center><strong>Importing Python Libraries \ud83d\udcd5 \ud83d\udcd7 \ud83d\udcd8 \ud83d\udcd9<\/strong><\/center><\/h2>\n        \n<\/div>","48e5b9d7":"### Visualizing landmark with  images (landmark_id: 82267)","710feb86":"<div class=\"alert alert-block alert-danger\">  \n<h1><center><strong>Data Visualization \ud83d\udcdd<\/strong><\/center><\/h1>\n\n\n   \n        \n<\/div>","66590dfa":"### Visualizing landmark with images (landmark_id: 162833)","7f775f9f":"# <center><img src=\"https:\/\/akm-img-a-in.tosshub.com\/businesstoday\/images\/story\/201712\/data-analytics_660_120717022837.jpg\"><\/center>","bd559f10":"### Guideline to submit the results"}}