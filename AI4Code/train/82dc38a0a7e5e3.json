{"cell_type":{"b69de7bc":"code","2e71bcb1":"code","da94d258":"code","30b13adb":"code","2a364030":"code","a36f0b95":"code","355dc782":"code","fbd7afa7":"code","467868a5":"code","d26d7831":"code","30b2d34c":"code","bc11452f":"code","cb0510f5":"code","bb844fc2":"code","e0f195f8":"code","81b98802":"code","02f11573":"code","4fc46e68":"code","d43efac6":"code","03d40a9d":"code","4ca73f0c":"code","434731a7":"code","aa61419f":"code","2c000a1f":"code","fc231070":"code","e08161e0":"code","535b4aa8":"code","0f738f75":"code","3ca26565":"code","c8cbef27":"code","39230930":"code","f8adfc47":"code","1c1f9bbd":"code","5dc4f8da":"code","dcbccb72":"code","ee31d1df":"code","e64ba94b":"code","dd0caec0":"code","ab021d80":"code","c77ff9db":"code","b8b9ae18":"code","59cf962a":"code","b9a390d7":"code","73da1890":"code","78ff8103":"code","30c9ce35":"markdown","a61c14e9":"markdown","8197c321":"markdown","9b559e5a":"markdown","46442865":"markdown","d3c549fa":"markdown","99321060":"markdown","d2782bd5":"markdown","486a977f":"markdown","3ba18161":"markdown"},"source":{"b69de7bc":"import pandas as pd \nimport seaborn as sns\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import MinMaxScaler\nimport sklearn\nimport matplotlib.pyplot as plt\nfrom sklearn.svm import SVC","2e71bcb1":"data =pd.read_csv('..\/input\/crop-dataset\/Crop_recommendation.csv')","da94d258":"data","30b13adb":"100*(data.isnull().sum()\/len(data.label))","2a364030":"len(data.label.value_counts())","a36f0b95":"data.describe(percentiles = [0.05,0.10,0.15,0.85,0.90,0.95])","355dc782":"data.info()","fbd7afa7":"for i in data.select_dtypes(['int64','float64']).columns:\n    sns.boxplot(data[i])\n    plt.show()\n    ","467868a5":"data.loc[(data['K']>75)&(data['P']>90)]","d26d7831":"sns.pairplot(data,hue = 'label')","30b2d34c":"plt.figure(figsize=(10,10))\nsns.jointplot(x='temperature',y='rainfall',hue ='label',data=data.loc[(data['temperature']>30)&(data['rainfall']<120)])","bc11452f":"y=data.pop('label')\nx=data\n\nx_train,x_test,y_train,y_test = train_test_split(x,y,train_size=0.8)","cb0510f5":"dt = DecisionTreeClassifier(max_depth = 10,min_samples_split =30,min_samples_leaf = 20)","bb844fc2":"dt.fit(x_train,y_train)","e0f195f8":"predicted_tree = dt.predict(x_test)","81b98802":"sklearn.metrics.accuracy_score(y_test,predicted_tree)","02f11573":"dt_1 = DecisionTreeClassifier()\n\nparameters = {'max_depth':[8,9,10,11,12],\n              'min_samples_split':[20,25,30,40,50],\n              'min_samples_leaf':[15,20,25,30,35],\n              }\n\ngrid_1 = GridSearchCV(estimator = dt_1,\n                     param_grid = parameters,\n                     cv=4,\n                     n_jobs=1,\n                     refit = True,\n                     scoring='accuracy')\n\ngrid_1.fit(x_train,y_train)","4fc46e68":"grid_1.best_params_","d43efac6":"grid_1.best_score_","03d40a9d":"predicted_gridDT = grid_1.predict(x_test)","4ca73f0c":"sklearn.metrics.accuracy_score(y_test,predicted_gridDT)","434731a7":"rfc = RandomForestClassifier(n_estimators =50,max_depth= 3,min_samples_split = 20,min_samples_leaf=15 )","aa61419f":"rfc.fit(x_train,y_train)","2c000a1f":"predicted_randomforest = rfc.predict(x_test)","fc231070":"sklearn.metrics.accuracy_score(y_test,predicted_randomforest)","e08161e0":"rfcc = RandomForestClassifier()\n\nparams = {'n_estimators':[100,120,130,140],\n          'max_depth':[4,5,6,8],\n          'min_samples_split':[20,30,40],\n          'min_samples_leaf': [15,25,35]}\n\ngrid_2 = GridSearchCV(estimator = rfcc,\n                    param_grid = params,\n                    refit = True,\n                    cv=4,n_jobs = -1,scoring='accuracy')\n\ngrid_2.fit(x_train,y_train)","535b4aa8":"grid_2.best_score_","0f738f75":"predicted_grid_RF = grid_2.predict(x_test)","3ca26565":"sklearn.metrics.accuracy_score(y_test,predicted_grid_RF)","c8cbef27":"scaler = MinMaxScaler()\n\nx_train_scaled = scaler.fit_transform(x_train)  \nx_test_scaled = scaler.fit_transform(x_test)","39230930":"svc = SVC(kernel = 'rbf')\nsvc.fit(x_train_scaled,y_train)","f8adfc47":"predicted_svc_r = svc.predict(x_test_scaled)","1c1f9bbd":"sklearn.metrics.accuracy_score(y_test,predicted_svc_r)","5dc4f8da":"svc_polynomial = SVC(kernel = 'poly')\nsvc_polynomial.fit(x_train_scaled,y_train)","dcbccb72":"predicted_svc_p = svc_polynomial.predict(x_test_scaled)","ee31d1df":"sklearn.metrics.accuracy_score(y_test,predicted_svc_p)","e64ba94b":"lg = LogisticRegression()\nlg.fit(x_train_scaled,y_train)","dd0caec0":"predicted_lg = lg.predict(x_test_scaled)","ab021d80":"sklearn.metrics.accuracy_score(y_test,predicted_lg)","c77ff9db":"l1 = LogisticRegression(C=1, penalty='l1', solver='liblinear')\n\nl1.fit(x_train_scaled,y_train)\n","b8b9ae18":"predicted_l1 = l1.predict(x_test_scaled)","59cf962a":"sklearn.metrics.accuracy_score(y_test,predicted_l1)","b9a390d7":"l2 = LogisticRegression(C=10, penalty='l2')\n\nl2.fit(x_train_scaled,y_train)\n","73da1890":"predicted_l2 = l2.predict(x_test_scaled)","78ff8103":"sklearn.metrics.accuracy_score(y_test,predicted_l2)","30c9ce35":"L2 Logistic Regression","a61c14e9":"LOGISTIC REGRESSION","8197c321":"GRID SEARCH IS UESD TO FIND THE BEST PARAMETER","9b559e5a":"SUPPORT VECTOR CLASSIFIER - RBG ","46442865":"DECISION TREE CLASSIFIER","d3c549fa":"## CORRELATION BETWEEN PHOSPORUS AND POTASSIUM IS HIGH, SO THERE IS NO NEED FOR REMOVAL OF OUTLIERS","99321060":"SUPPORT VECTOR CLASSIFER - POLYNOMIAL","d2782bd5":"RANDOM FOREST CLASSIFER ","486a977f":"L1 Logistic Regression","3ba18161":"# IMPORTING REQUIRED LIBRARIES"}}