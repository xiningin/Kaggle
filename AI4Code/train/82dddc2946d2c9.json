{"cell_type":{"9680ac39":"code","d64a7259":"code","7f73297a":"code","b56594ab":"code","ef4bcd6a":"code","ab93759d":"code","54b6f28c":"code","cfc60acc":"code","98f89c3e":"code","92fc57e5":"code","f27e2004":"code","97c3525e":"markdown","a83d3d65":"markdown"},"source":{"9680ac39":"import pandas as pd\nimport numpy as np\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import train_test_split, KFold\nfrom sklearn.preprocessing import LabelEncoder\n","d64a7259":"#\uc790\uc2e0\uc758 \ub370\uc774\ud130\uacbd\ub85c\uc5d0 \ub9de\uac8c \uc218\uc815\ud558\uc2dc\uba74 \ub429\ub2c8\ub2e4\nX_train = pd.read_csv(\"..\/input\/kaistbme587\/X_train.csv\")\nX_test = pd.read_csv(\"..\/input\/kaistbme587\/X_test.csv\")","7f73297a":"X_test.head()","b56594ab":"X_train = X_train.fillna(-1)\nX_test = X_test.fillna(-1)","ef4bcd6a":"for col in (X_train.columns):\n    if X_train[col].dtype == 'object':\n        enc = LabelEncoder()\n        enc.fit(list(X_train[col].values) + list(X_test[col].values))\n        X_train[col] = enc.transform(list(X_train[col].values))\n        X_test[col] = enc.transform(list(X_test[col].values)) ","ab93759d":"X = X_train.iloc[:,1:]\ny = X_train.iloc[:,0]","54b6f28c":"X_test = X_test.iloc[:,1:]","cfc60acc":"folds = KFold(n_splits=5)\n\nresult = list()\n# enumerate\ub294 index\uc640 \ub370\uc774\ud130\ub97c \ubd84\ub9ac\ud574\uc8fc\ub294 \ud568\uc218 \uc784\nfor fold, (trn_idx, test_idx) in enumerate(folds.split(X, y)):\n\n    print(f'Fold {fold+1} \ub97c \ud559\uc2b5\ud569\ub2c8\ub2e4~~')\n    print(trn_idx)\n    train_x = X.iloc[trn_idx] \n    train_y= y.iloc[trn_idx]\n    valid_x = X.iloc[test_idx]\n    valid_y=y.iloc[test_idx]\n    model = RandomForestClassifier()\n    model.fit(train_x, train_y)\n    \n    y_pred = model.predict_proba(X_test)[:,1]\n    result.append(y_pred)\n","98f89c3e":"real=result[0]+result[1]+result[2]+result[3]+result[4]","92fc57e5":"real=real\/5","f27e2004":"sub = pd.read_csv(\"..\/input\/kaistbme587\/sample_submission.csv\")\nsub['Fraud'] = real\nsub.to_csv('baseline3.csv', index=False)","97c3525e":"# Kfold Apply","a83d3d65":"K fold\ub294, \ub370\uc774\ud130\ub97c n\uac1c\ub85c \ucabc\uac1c\uc11c, \uc608\ub97c\ub4e4\uba74 3\uac1c\ub85c \ucabc\uac20\ub2e4\uace0 \uac00\uc815\ud558\uba74\n\n(0,1), (0,2),(1,2) \uc138\uac1c\uc758 \ub370\uc774\ud130\uc14b\uc73c\ub85c 3\ubc88 \ud559\uc2b5\ud574\uc11c 3\uac00\uc9c0 \ud559\uc2b5\uacb0\uacfc\ub97c \ud3c9\uade0\ub0b4\uc8fc\ub294 \ubc29\ubc95\ub860\uc774\ub2e4.\n\n\ub370\uc774\ud130 \ubd84\uc11d\uc5d0\uc11c \ud574\uacb0\ud574\uc57c\ud558\ub294 \uac00\uc7a5 \uc911\uc694\ud55c \uac83 \uc911 \ud558\ub098\ub294 \"Uncertainty \ud574\uc18c\" \uc774\ub2e4. \uc5b4\ub5a4 \ubaa8\ub378\uc774\ub098\n\n\ubaa8\ub378\uc758 \ubd88\ud655\uc2e4\uc131\uc740 \uc874\uc7ac\ud55c\ub2e4. \ubd88\ud655\uc2e4\uc131\uc774\ub780, \ubaa8\ub378\uc774 \ud655\ub960\uc801\uc73c\ub85c target\uc744 \ub9de\ucd94\uc9c0 \ubabb\ud558\ub294 \uac83\uc744 \ub9d0\ud558\uba70 \n\n\uc8fc\uc5b4\uc9c4\ub370\uc774\ud130\uc5d0\uc11c K-Fold\ub294 \uac70\uc758 99% \uc774\uc0c1\uc73c\ub85c \ubd88\ud655\uc2e4\uc131\uc744 \ud574\uc18c\ud574\uc900\ub2e4.\n\nsklearn\uc758 Kfold \ud568\uc218\ub97c \uc774\uc6a9\ud574 \uc544\uc8fc \uac04\ub2e8\ud558\uac8c Starter Code\uc758 \uc131\ub2a5\uc744 \uc62c\ub824\ubcf4\uaca0\ub2e4.\n\nStarter\uc5d0 \ube44\ud574 \uba87\uc904 \ucd94\uac00\ud55c \uac83 \ub9cc\uc73c\ub85c AUC\uac00 \uc57d 1%\uc815\ub3c4 \ub298\uc5b4\ub098\ub294 \ud6a8\uacfc\ub97c \uc9c0\ub154\ub2e4. \n\n\"Fold\ub97c \uc5b4\ub5bb\uac8c \ub098\ub204\ub0d0\" \ub3c4 \ud559\uc2b5\uc5d0 \uc9c0\ub300\ud55c \uc601\ud5a5\uc744 \ub07c\uce5c\ub2e4!\n"}}