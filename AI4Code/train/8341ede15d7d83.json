{"cell_type":{"2d83f5cb":"code","595a9453":"code","bf48263d":"code","6f156b30":"code","0e4095a7":"code","86b11b90":"code","a9ec2718":"code","8bd971fb":"code","152f6c0f":"code","e83dbbcf":"code","f2424ab6":"code","c4f55abc":"code","1d253d72":"code","4c1596f0":"code","cd8bd912":"markdown","88a4b2a8":"markdown","c820f934":"markdown","4508a7cf":"markdown","1650bc00":"markdown","500a13bc":"markdown","c76bb4ec":"markdown"},"source":{"2d83f5cb":"from sklearn.feature_extraction.text import CountVectorizer\nimport pandas as pd\nimport numpy as np","595a9453":"x = ['which book is this', 'this is book and this is math']","bf48263d":"cv = CountVectorizer() # Counts the occurence of each word\ncount = cv.fit_transform(x)\n\nwords = cv.get_feature_names()\ncounts = count.toarray()","6f156b30":"bow = pd.DataFrame(counts, columns=words)\nbow","0e4095a7":"# Divide each word's occurence by the total number of words\nfrequencies = [[ word \/ sum(col) for word in col ] for col in counts]","86b11b90":"tf = pd.DataFrame(frequencies, columns=words)\ntf","a9ec2718":"occurred = bow.astype('bool') # Turn the bow counts into True | False\noccurred","8bd971fb":"N = len(occurred)\n\nidf = [np.log((N + 1) \/ (occurred[word].sum() + 1)) + 1 for word in bow.columns]\n\npd.DataFrame([idf], columns=words)","152f6c0f":"tfidf = tf * np.array(idf)\ntfidf","e83dbbcf":"from sklearn.feature_extraction.text import TfidfVectorizer","f2424ab6":"x","c4f55abc":"tfidf = TfidfVectorizer()\nX = tfidf.fit_transform(x)","1d253d72":"tfidf.idf_","4c1596f0":"X.toarray()","cd8bd912":"# 3 - Inverse Document Frequency (IDF)\n\nA statistical interpretation that diminishes the weight of frequently occurring terms (like 'is' and 'this') in favor of less frequently occurring ones. The smooth variation is often used:\n\n${\\displaystyle \\log \\left({\\frac {N}{1+n_{t}}}\\right)+1}$.\n\nWhere $N$ is the total number of rows and $n_{t}$ is the number of rows in which the word occurred.","88a4b2a8":"IDF is the same we calculated above","c820f934":"# 2 - Term Frequency\n\nA representation of text that describes the occurrence frequency of words within a document.","4508a7cf":"# 4 - TF-IDF\n\nA numerical statistic that reflects how important a word is to a document in a collection or corpus. It is the product of the Term Frequency with the Inverse Document Frequency.","1650bc00":"# 5 - TFIDF (Sklearn)\n\nSklearn has a class that takes care of TF, IDF and TF-IDF.","500a13bc":"# 1 - Bag of Words\n\nA representation of text that describes the occurrence of words within a document.","c76bb4ec":"TF is not, as the TfidfVectorizer normalizes the frequencies"}}