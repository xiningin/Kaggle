{"cell_type":{"a5adb021":"code","dea8cf1e":"code","cf5463b9":"code","ddd86919":"code","4a4698e1":"code","cb3097da":"code","694ebe28":"code","980521ad":"code","21d8fe01":"code","0113dddb":"code","20f9d7be":"code","d4c92860":"code","cc303b4d":"code","98e27fd8":"code","1a12c823":"code","41381bed":"markdown","a4912c4c":"markdown","45f20a67":"markdown","fcc20027":"markdown","246edb23":"markdown","da9af18b":"markdown","fc44fc6e":"markdown","354b9157":"markdown","feea2801":"markdown"},"source":{"a5adb021":"import pandas as pd\nimport plotly.express as px","dea8cf1e":"data = pd.read_csv(\"..\/input\/quoraquestions\/quora_questions.csv\")\ndata.head()","cf5463b9":"data['Question'][len(data)-1]","ddd86919":"from sklearn.feature_extraction.text import TfidfVectorizer\ntfidf = TfidfVectorizer(max_df = 0.9, min_df = 5, lowercase = True, stop_words = \"english\")\ndtm = tfidf.fit_transform(data['Question'])","4a4698e1":"from sklearn.decomposition import NMF\nnmf = NMF(n_components = 20, random_state = 177013)\nnmf.fit(dtm)","cb3097da":"topic_word_dict = {}\nfor index,topic in enumerate(nmf.components_):\n    topic_word_dict[index] = [tfidf.get_feature_names()[i] for i in topic.argsort()[-20:]]","694ebe28":"from wordcloud import WordCloud, STOPWORDS\nimport matplotlib.pyplot as plt\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots \ndef word_cloud(word_list):\n    wordcloud = WordCloud(width = 1000,\n                      height = 1000,\n                      background_color = \"white\",\n                      stopwords = set(STOPWORDS),\n                      min_font_size = 15).generate(\" \".join(word_list))\n    return wordcloud\n\ndef matplot_word_cloud(word_lists,title_list,columns_x =2 , rows_x = 2 , figsize_x=(8, 8)):\n    fig=plt.figure(figsize=figsize_x)\n    columns = columns_x\n    rows = rows_x\n    itera_index = 0\n    for i in range(1, columns*rows +1):\n        img = word_cloud(word_lists[itera_index])\n        fig.add_subplot(rows, columns, i)\n        plt.axis(\"off\")\n        plt.title(title_list[itera_index])\n        plt.imshow(img)\n        itera_index = itera_index + 1 \n    plt.show()","980521ad":"dict_word = [topic_word_dict[0],topic_word_dict[1],topic_word_dict[3],topic_word_dict[4]]\ntitle_list = [\"e-commerce\",\"higher_education\",\"search_queries\",\"facebook\"]\nmatplot_word_cloud(dict_word,title_list, figsize_x = (10,10))","21d8fe01":"dict_word = [topic_word_dict[5],topic_word_dict[6],topic_word_dict[7],topic_word_dict[8]]\ntitle_list = [\"indian_politics\",\"computer_science\", \"US_elections\",\"IAS_prep\"]\nmatplot_word_cloud(dict_word,title_list, figsize_x = (10,10))","0113dddb":"dict_word = [topic_word_dict[9],topic_word_dict[10],topic_word_dict[11],topic_word_dict[12]]\ntitle_list = [\"gender_politics\",\"CA_news\", \"Internet_\",\"indian_currency\"]\nmatplot_word_cloud(dict_word,title_list, figsize_x = (10,10))","20f9d7be":"dict_word = [topic_word_dict[13],topic_word_dict[14],topic_word_dict[15],topic_word_dict[16]]\ntitle_list =[\"spoken_english\",\"healthcare\",\"computer_science\",\"therepy\"]\nmatplot_word_cloud(dict_word,title_list, figsize_x = (10,10))","d4c92860":"dict_word = [topic_word_dict[17],topic_word_dict[18],topic_word_dict[19]]\ntitle_list =[\"social_media\", \"internet\", \"indo_pak_politics\"]\nmatplot_word_cloud(dict_word,title_list,3,1,figsize_x = (16,16))","cc303b4d":"topic_res = nmf.fit_transform(dtm)\ndata[\"topic\"] = topic_res.argmax(axis =1)","98e27fd8":"topic_dict = {0:\"e-commerce\", 1:\"higher education\",2:\"search_queries\", 3:\"facebook\",4:\"philosophy\",\n              5:\"indian_politics\",6:\"computer_science\", 7:\"US_elections\",8:\"IAS_prep\",9:\"GenderPolitics\",\n              10:\"CA_news\",11:\"internet_\",12:\"indian_currency\", 13:\"spoken_english\", 14:\"healthcare\",15:\"computer_science\",\n              16:\"therepy\",17:\"Social_media\",18:\"internet_\",19:\"indo_pak_politics\"}\ndata[\"NMF_allocation\"] = data[\"topic\"].map(topic_dict)","1a12c823":"fig = px.bar(x = data[\"NMF_allocation\"].value_counts().index,y = data[\"NMF_allocation\"].value_counts().values,\n             color = data[\"NMF_allocation\"].value_counts().index,title = \"queries related to each topic\")\nfig.show()","41381bed":"plot_cloud(topic_word_dict[0],topic_word_dict[1],topic_word_dict[3],topic_word_dict[4],(\"e-commerce\",\"higher_education\", \"search_queries\",\"facebook\"))","a4912c4c":"plot_cloud(topic_word_dict[13],topic_word_dict[14],topic_word_dict[15],topic_word_dict[16],(\"spoken_english\",\"healthcare\",\"computer_science\",\"therepy\"))","45f20a67":"def plot_cloud(word_list_1,word_list_2,word_list_3,word_list_4,subplots = (\"e-commerce\",\"higher_education\", \"search_queries\",\"facebook\")):\n    fig = make_subplots(rows=2, cols=2,subplot_titles = subplots)\n    fig.add_trace(go.Image(z=word_cloud(word_list_1)),1,1)\n    fig.add_trace(go.Image(z=word_cloud(word_list_2)),1,2)\n    fig.add_trace(go.Image(z=word_cloud(word_list_3)),2,1)\n    fig.add_trace(go.Image(z=word_cloud(word_list_4)),2,2)\n    fig.update(layout_title_text='Top words in each topic',layout_showlegend=False)\n    fig.update_layout(\n    autosize=False,\n    width=1000,\n    height=1000)\n\n    fig.show(\"notebook\")","fcc20027":"fig = make_subplots(rows=1, cols=3,subplot_titles = (\"social_media\", \"internet\", \"indo_pak_politics\"))\nfig.add_trace(go.Image(z=word_cloud(topic_word_dict[17])),1,1)\nfig.add_trace(go.Image(z=word_cloud(topic_word_dict[18])),1,2)\nfig.add_trace(go.Image(z=word_cloud(topic_word_dict[19])),1,3)\nfig.update(layout_title_text='Top words in each topic',layout_showlegend=False)\nfig.update_layout(\nautosize=False,\nwidth=1000,\nheight=500)\nfig.show(\"notebook\")","246edb23":"# quora_topic_modelling","da9af18b":"plot_cloud(topic_word_dict[5],topic_word_dict[6],topic_word_dict[7],topic_word_dict[8],(\"indian_politics\",\"computer_science\", \"US_elections\",\"IAS_prep\"))","fc44fc6e":"### PLOTLY PLOTS (WILL take soo much memory, that they will crash jupyter)","354b9157":"plot_cloud(topic_word_dict[9],topic_word_dict[10],topic_word_dict[11],topic_word_dict[12],(\"gender_politics\",\"CA_news\", \"Internet_\",\"indian_currency\"))","feea2801":"###  use them at your own discretion..change cells below from markdown format"}}