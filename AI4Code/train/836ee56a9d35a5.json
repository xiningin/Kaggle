{"cell_type":{"53aef317":"code","b5f33e25":"code","e63f9262":"code","0db3dedc":"code","21dc0cec":"code","11fed895":"code","4f5a3f7c":"code","72cfc1fe":"code","8a05a6ba":"code","4d383f26":"code","2fe6aa47":"code","01bc42a5":"code","4ef2b729":"code","21a50692":"code","e35a3109":"code","27da2669":"code","dd271723":"code","663ea34d":"code","fb4615a8":"code","73b30ae0":"code","7eb7c46d":"code","0c640af4":"code","8fb628bb":"code","a7ec671c":"code","853fc35e":"code","2d991c6e":"code","28a88be0":"code","8e0b3c4e":"code","54dad2ea":"code","50c09ea0":"code","7e395ab8":"code","10fe126a":"code","7fdb387f":"code","0dd2742f":"code","512f6ebe":"code","0a308206":"code","cea6342f":"code","55e2f308":"code","d42f0b41":"code","16e5426b":"code","1941a2cf":"code","198ec45e":"code","4729f1ec":"code","231d5f79":"code","f1321f8b":"code","69ad85fa":"code","8c1b6ae9":"code","4fa5f5e6":"code","fa939a77":"code","ea18780e":"markdown","f9513988":"markdown","224fc1d1":"markdown","afbd84fa":"markdown","f4bfe377":"markdown","7949403a":"markdown","8c9eb4b7":"markdown","b44536c6":"markdown","654da86c":"markdown"},"source":{"53aef317":"#importing libraries\n\nimport numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport seaborn as sns\n\nfrom sklearn.cluster import KMeans\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.preprocessing import StandardScaler","b5f33e25":"df = pd.read_csv('..\/input\/customer-personality-analysis\/marketing_campaign.csv',sep='\\t')","e63f9262":"df.head().style.background_gradient(cmap = 'Oranges_r', text_color_threshold = 0.2)","0db3dedc":"df.isnull().sum()","21dc0cec":"df.drop(['ID', 'Z_CostContact', 'Z_Revenue'], axis = 1, inplace = True)\ndf['Income'].fillna(df['Income'].mean(), inplace = True)","11fed895":"df.isnull().sum()","4f5a3f7c":"df.Marital_Status.value_counts()","72cfc1fe":"df['Marital_Status'] = df['Marital_Status'].replace(['Married', 'Together'], 'relationship')\ndf['Marital_Status'] = df['Marital_Status'].replace(['Single', 'Divorced', 'Widow', 'Alone', 'Absurd', 'YOLO'], 'single')\n","8a05a6ba":"df['Kids'] = df['Kidhome'] + df['Teenhome']","4d383f26":"\ndf['Expenses'] = df['MntWines'] + df['MntFruits'] + df['MntMeatProducts'] + df['MntFishProducts'] + df['MntSweetProducts'] + df['MntGoldProds']\n","2fe6aa47":"df['Total_Cmp'] = df['AcceptedCmp3'] + df['AcceptedCmp4'] + df['AcceptedCmp5'] + df['AcceptedCmp1'] + df['AcceptedCmp2']\n","01bc42a5":"df['Total_Purchases'] = df['NumDealsPurchases'] + df['NumWebPurchases'] + df['NumCatalogPurchases'] + df['NumStorePurchases']","4ef2b729":"df.drop(['Kidhome', 'Teenhome', 'MntWines', 'MntFruits', 'MntMeatProducts', 'MntFishProducts', 'MntSweetProducts', 'MntGoldProds'], axis = 1, inplace = True)","21a50692":"df.drop(['AcceptedCmp3', 'AcceptedCmp4', 'AcceptedCmp5', 'AcceptedCmp1', 'AcceptedCmp2', 'NumDealsPurchases', 'NumWebPurchases', 'NumCatalogPurchases', 'NumStorePurchases'], axis = 1, inplace = True)","e35a3109":"df['current_year'] = 2021","27da2669":"df['Age'] = df['current_year'] - df['Year_Birth'] ","dd271723":"df.drop(['current_year', 'Year_Birth'], axis = 1, inplace = True)\ndf.head()","663ea34d":"df.Education.value_counts()","fb4615a8":"df['Education'] = df['Education'].replace(['PhD','2n Cycle','Graduation', 'Master'],'PG')  \ndf['Education'] = df['Education'].replace(['Basic'], 'UG')","73b30ae0":"df.info()","7eb7c46d":"df['Dt_Customer'] = df['Dt_Customer'].apply(pd.to_datetime, errors = 'coerce')","0c640af4":"df['today_day'] = '14-10-2021'\ndf['today_day'] = pd.to_datetime(df.today_day)\ndf['Day_engaged'] = (df['today_day'] - df['Dt_Customer']).dt.days","8fb628bb":"df.drop(['Dt_Customer', 'Recency', 'Complain', 'today_day'], axis = 1, inplace = True)","a7ec671c":"df.head()","853fc35e":"plt.figure(figsize = (15,8))\nsns.heatmap(df.corr(), annot = True, cmap = 'magma')","2d991c6e":"df.describe()","28a88be0":"plt.figure(figsize = (20,8))\nsns.countplot(data = df, x = 'Age')","8e0b3c4e":"plt.figure(figsize = (8,8))\ndf.Marital_Status.value_counts().plot(kind = 'pie')\nplt.legend()","54dad2ea":"plt.figure(figsize = (8,8))\ndf.Education.value_counts().plot(kind = 'pie')\nplt.legend()","50c09ea0":"df.info()","7e395ab8":"enc = LabelEncoder()\ncols = ['Education', 'Marital_Status']\nfor col in cols:\n    df[col] = enc.fit_transform(df[col])","10fe126a":"df.head()","7fdb387f":"stanscale = StandardScaler()\ndf_scaled = stanscale.fit_transform(df)\ndf_scaled","0dd2742f":"lst = []\nfor i in range(1,15):\n    kmodel = KMeans(n_clusters = i, n_init = 15, max_iter = 500)\n    kmodel.fit(df_scaled)\n    lst.append(kmodel.inertia_)","512f6ebe":"lst","0a308206":"plt.plot(range(1,15), lst, marker = 'o')\nplt.title('Elbow Method')\nplt.grid()","cea6342f":"kmodel = KMeans(n_clusters = 8)","55e2f308":"kmodel.fit(df_scaled)","d42f0b41":"prediction = kmodel.predict(df_scaled)","16e5426b":"kmodel.cluster_centers_","1941a2cf":"df['clusters'] = prediction","198ec45e":"df.head()","4729f1ec":"plt.figure(figsize = (20,10))\ncolor = np.array(['darkgray', 'lightsalmon', 'powderblue', 'red', 'yellow', 'black', 'green', 'pink'])\nsns.scatterplot(x = df['Income'], y = df['Expenses'], c = color[kmodel.labels_], s = 50)","231d5f79":"plt.figure(figsize = (20,10))\ncolor = np.array(['darkgray', 'lightsalmon', 'powderblue', 'red', 'yellow', 'black', 'green', 'pink'])\nsns.scatterplot(x = df['Kids'], y = df['Expenses'], c = color[kmodel.labels_], s = 50)","f1321f8b":"plt.figure(figsize = (20,10))\ncolor = np.array(['darkgray', 'lightsalmon', 'powderblue', 'red', 'yellow', 'black', 'green', 'pink'])\nsns.scatterplot(x = df['Marital_Status'], y = df['Expenses'], c = color[kmodel.labels_], s = 50)","69ad85fa":"plt.figure(figsize = (20,10))\ncolor = np.array(['darkgray', 'lightsalmon', 'powderblue', 'red', 'yellow', 'black', 'green', 'pink'])\nsns.scatterplot(x = df['Age'], y = df['Expenses'], c = color[kmodel.labels_], s = 50)","8c1b6ae9":"from scipy.cluster.hierarchy import linkage, dendrogram","4fa5f5e6":"var = linkage(df, method = 'ward')","fa939a77":"plt.figure(figsize = (20,15))\ndendrogram(var)","ea18780e":"# k = 8","f9513988":"# Dendrogram","224fc1d1":"# EDA","afbd84fa":"# Label Encoding","f4bfe377":"# Customer Personality Analysis","7949403a":"ID: Customer's unique identifier\nYear_Birth: Customer's birth year\nEducation: Customer's education level\nMarital_Status: Customer's marital status\nIncome: Customer's yearly household income\nKidhome: Number of children in customer's household\nTeenhome: Number of teenagers in customer's household\nDt_Customer: Date of customer's enrollment with the company\nRecency: Number of days since customer's last purchase\nComplain: 1 if customer complained in the last 2 years, 0 otherwise\n\nMntWines: Amount spent on wine in last 2 years\nMntFruits: Amount spent on fruits in last 2 years\nMntMeatProducts: Amount spent on meat in last 2 years\nMntFishProducts: Amount spent on fish in last 2 years\nMntSweetProducts: Amount spent on sweets in last 2 years\nMntGoldProds: Amount spent on gold in last 2 years\n\n\nNumDealsPurchases: Number of purchases made with a discount\nAcceptedCmp1: 1 if customer accepted the offer in the 1st campaign, 0 otherwise\nAcceptedCmp2: 1 if customer accepted the offer in the 2nd campaign, 0 otherwise\nAcceptedCmp3: 1 if customer accepted the offer in the 3rd campaign, 0 otherwise\nAcceptedCmp4: 1 if customer accepted the offer in the 4th campaign, 0 otherwise\nAcceptedCmp5: 1 if customer accepted the offer in the 5th campaign, 0 otherwise\nResponse: 1 if customer accepted the offer in the last campaign, 0 otherwise\n\n\nNumWebPurchases: Number of purchases made through the company\u2019s web site\nNumCatalogPurchases: Number of purchases made using a catalogue\nNumStorePurchases: Number of purchases made directly in stores\nNumWebVisitsMonth: Number of visits to company\u2019s web site in the last month\n    \n    \n\nNeed to perform clustering to summarize customer segments.","8c9eb4b7":"# Clustering Using Elbow Method","b44536c6":"# Scaling","654da86c":"# Data Cleaning"}}