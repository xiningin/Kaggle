{"cell_type":{"f1449648":"code","900eda77":"code","a0b9e6ce":"code","a772a35d":"code","a1ceba08":"code","f23f7d95":"markdown","40f1f967":"markdown","4e76d57a":"markdown","0c0008e2":"markdown"},"source":{"f1449648":"import numpy as np\nimport pandas as pd\nimport json\nimport pickle","900eda77":"train = pd.read_csv('..\/input\/mlb-player-digital-engagement-forecasting\/train.csv')\ntrain.head()\n# except for the column 'date', all columns have data of json format.","a0b9e6ce":"def unpack_json(df,var):\n    name = var\n    tmp = df[['date']+[name]].dropna(how='any').reset_index(drop=True)\n    temp=[]\n    for val in tmp[name]:\n        temp.append(json.loads(val))\n    tmp[name]=temp\n    \n    var_val_dict = dict(zip(tmp.iloc[0,1][0].keys(),[[] for val in tmp.iloc[0,1][0].keys()]))\n    date_list = []\n\n    for d, eng in zip(tmp['date'].values,tmp[name].values): #df\u306e1\u884c\u305a\u3064\u3067\u30eb\u30fc\u30d7\n        for val in eng: #1\u30bb\u30eb\u306e\u30ea\u30b9\u30c8\u306e\u8981\u7d20\u3054\u3068\u306b\u30eb\u30fc\u30d7\n            date_list.append(d)\n            for key in val.keys(): #\u30ea\u30b9\u30c8\u306e1\u8981\u7d20\u304c\u8f9e\u66f8\u306b\u306a\u3063\u3066\u304a\u308a\u3001\u8f9e\u66f8\u5185\u306e\u30ad\u30fc\u3067\u30eb\u30fc\u30d7\n                var_val_dict[key].append(val[key])\n                #var_val_dict['date_tr'].append(id1)\n                #tqdm(zip(df['date'].values,df[name].values))\n\n    output_df = pd.DataFrame(var_val_dict)\n    output_df['date'] = date_list\n    \n    return output_df","a772a35d":"var_list = ['nextDayPlayerEngagement','games','rosters','playerBoxScores','teamBoxScores','transactions',\n           'standings','awards','events','playerTwitterFollowers','teamTwitterFollowers']","a1ceba08":"for var in var_list:  \n    output = unpack_json(train,var)\n    filename = var + '.pickle'\n    with open(filename, 'wb') as f:\n        pickle.dump(output, f)\n    print('output: ',filename)","f23f7d95":"#### Add these outputs in your notebooks!\nThank you for reading!","40f1f967":"# Processing","4e76d57a":"## Import","0c0008e2":"- Some columns of 'train.csv' have json format data\n- We need to convert to dataframe for them, and save as pickle."}}