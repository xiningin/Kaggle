{"cell_type":{"af475e91":"code","7391ed4c":"code","7aa6c975":"code","4c8d810d":"code","3df776c4":"code","c6366485":"code","ec6f92b3":"code","da168b9a":"markdown","8945bb25":"markdown","4b51934c":"markdown","11a3aaa0":"markdown","b352eb3b":"markdown","838d0247":"markdown","2d5d6870":"markdown","6dbd3c80":"markdown","18234340":"markdown","3ee46bfa":"markdown"},"source":{"af475e91":"import keras","7391ed4c":"from PIL import Image\nImage.open('..\/input\/img.png')","7aa6c975":"model = keras.models.Sequential()\n\nmodel.add(keras.layers.LSTM(units=3, input_shape=(2,10)))","4c8d810d":"model = keras.models.Sequential()\n\nmodel.add(keras.layers.LSTM(units=3, batch_input_shape=(8,2,10)))","3df776c4":"model = keras.models.Sequential()\n\nmodel.add(keras.layers.LSTM(units=3, input_shape=(2,10), return_sequences=False))\n\nmodel.summary()","c6366485":"model = keras.models.Sequential()\n\nmodel.add(keras.layers.LSTM(units=3, batch_input_shape=(8,2,10), return_sequences=False))\n\nmodel.summary()","ec6f92b3":"model = keras.models.Sequential()\n\nmodel.add(keras.layers.LSTM(units=3, batch_input_shape=(8,2,10), return_sequences=True))\n\nmodel.summary()","da168b9a":"- You always have to give a three-dimensional array as an input to your LSTM network (refer to the above image). Where the first dimension represents the batch size, the second dimension represents the number of time-steps you are feeding a sequence. And the third dimension represents the number of units in one input sequence. For example, input shape looks like `(batch_size, time_steps, seq_len)`. Let's look at an example in Keras.","8945bb25":"- Here you can see that I defined `batch_size` in advance and the output shape is `(8,3)` which makes sense.","4b51934c":"First, let's understand the Input and its shape in Keras LSTM.","11a3aaa0":"- Let's look at `input_shape` argument. Though it looks like that `input_shape` requires a 2D array, it actually requires a 3D array. In the example above `input_shape` is `(2,10)` which means number of time steps are 2 and number of input units is 10. And you can give any size for a batch. So your input array shape looks like `(batch_size, 2, 10)`.","b352eb3b":"When I started working with the LSTM networks, I was very confused about input and output shape This Kernel will help you to understand the Input and Output shape of the LSTM network. I assume that you already know about the LSTM theoretically. I am using the Keras library in this tutorial.","838d0247":"- Let's look at the other arguments. `units` is number of the output units in the LSTM which is 3 here. So output shape is `(None, 3)`. First dimension of output is None because we do not know the batch size in advance. So actual output shape will be `(batch_size, 3)` here.","2d5d6870":"- Now, look at the other argument which is `return_sequences`. This argument tells Whether to return the output at each time steps instead of the final time step. Now the output shape is 3D array, not a 2D array. And the shape of the array is `(8,2,3)`. You can see that there is one extra dimension in between which represent number of time steps. ","6dbd3c80":"### Summary\n\n- The input of the LSTM is always is a 3D array. `(batch_size, time_steps, seq_len)`.\n- The output of the LSTM could be a 2D array or 3D array depending upon the return_sequences argument.\n- If return_sequence is False, the output is a 2D array. `(batch_size, units)`\n- If return_sequence is True, the output is a 3D array. `batch_size, time_steps, units)`\n","18234340":"- You can also give an argument called `batch_input_shape` instead of `input_shape`. The difference here is that you have to give a fixed batch size now and your input array shape will look like `(8,2,10)`. Now if you try to give different batch size, you will get an error.","3ee46bfa":"Let's look at the output and its shape in the LSTM network."}}