{"cell_type":{"ff224e32":"code","46c623b1":"code","cc4fb24d":"code","e3717a81":"code","e11532f9":"code","95d0079c":"code","3333d950":"code","ac5b889a":"code","fdb481b0":"code","53c8441b":"code","f8346233":"code","71a0b4b5":"code","56f9ee09":"code","58274f48":"code","a20e98da":"code","cff86d15":"code","031b2568":"code","56a13272":"code","9f6c57ac":"code","87997f1e":"code","dd77d13f":"code","84851c41":"code","3af6653f":"code","b6d8d7f2":"code","17dc8f4f":"code","62a8efcf":"code","ed47c897":"code","de4e6673":"code","bdf7e93f":"code","56b3e83a":"code","35ddc844":"code","6f6e294c":"code","59f5b15f":"code","e25e9b7d":"code","848f367a":"code","615c5aff":"code","84ec196e":"code","c7d34cf6":"code","93e3ed5f":"code","c7991c6c":"code","becfa36e":"code","8cbd5d81":"code","18cdedb2":"code","49d353ef":"code","c3f2fb63":"code","2cdf355a":"code","a0692166":"code","c7e86965":"code","597141b6":"code","e4b87371":"code","42bf1280":"code","7b95c4a8":"code","fdfe4e06":"code","7a6afd34":"code","d44ee25b":"code","f0cc32cc":"code","fa6810bc":"code","2416fc4b":"code","1105ba24":"code","ff78e69f":"code","ba3609e7":"code","bf4a1bcb":"code","aef9b189":"code","24bee969":"markdown","3debf99a":"markdown","037ba55b":"markdown","1e2be55c":"markdown","b19b0e58":"markdown","09de8fff":"markdown","69163d3c":"markdown","7b1cde1f":"markdown","ec377bc2":"markdown","c45adc50":"markdown","2d080f51":"markdown","1c105976":"markdown","c7eeff28":"markdown","ed8c667e":"markdown","19d4c0de":"markdown","0db21c5f":"markdown","03a5a1ec":"markdown","dccbf359":"markdown"},"source":{"ff224e32":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","46c623b1":"df = pd.read_csv('..\/input\/hr-analytics-job-change-of-data-scientists\/aug_train.csv')\ndf.head()","cc4fb24d":"df.info()","e3717a81":"# Missing Value Screening\n\nprint(\"Number of Missing Values in Each Category:\")\nprint(df.isna().sum())","e11532f9":"plt.subplots(figsize=(10,5))\nsns.heatmap(df.isnull(),cbar=False)\nplt.xlabel('Feature')\nplt.ylabel('Index')\nplt.title('Missing Value Visualization')\n\nplt.show()","95d0079c":"# Imbalance Dataset Checking\n\ndf['target'].value_counts()","3333d950":"plt.subplots(figsize=(10,5))\nsns.countplot(df['target'])\nplt.xlabel('Target Label')\nplt.ylabel('Count')\nplt.title('Target Label Comparison')\n\nplt.show()","ac5b889a":"def city_code(x):\n    y = x.str.split(\"_\",expand=True)[1].astype('int64')\n    return y","fdb481b0":"df['city'] = city_code(df['city'])","53c8441b":"df.head()","f8346233":"def null_fill(x):\n    return x.fillna('Unknown',inplace=True)","71a0b4b5":"null_fill(df)\ndf.info()","56f9ee09":"from sklearn.preprocessing import OrdinalEncoder, OneHotEncoder\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.compose import ColumnTransformer","58274f48":"ord_pipe = Pipeline([\n    ('ord_encode',OrdinalEncoder([\n                                    ['Unknown', 'Primary School',  'High School', 'Graduate', 'Masters', 'Phd'],\n                                    'Unknown,<1,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,>20'.split(','),\n                                    ['Unknown','<10', '10\/49', '50-99', '100-500', '500-999' ,'1000-4999', '5000-9999', '10000+'],\n                                    ['Unknown','1', '2', '3', '4', '>4', 'never']\n                                ]))\n])","a20e98da":"ord_column = ['education_level','experience','company_size','last_new_job']\ncard_column = ['gender','relevent_experience','enrolled_university','major_discipline','company_type'] ","cff86d15":"def encoder(df,ord_column,card_column):\n    ord_pipe.fit(df[ord_column])\n    df[ord_column] = ord_pipe.transform(df[ord_column])\n    df = pd.get_dummies(df,columns=card_column)\n    return df","031b2568":"df = encoder(df,ord_column,card_column)","56a13272":"df.head()","9f6c57ac":"X = df.drop(columns=['enrollee_id','target'])\ny = df.target","87997f1e":"from imblearn.over_sampling import SMOTE\nfrom imblearn.under_sampling import RandomUnderSampler","dd77d13f":"# Fungsi\ndef balancing(X,y,smote_ratio,rus_ratio):\n    smote = SMOTE(sampling_strategy=smote_ratio)\n    X_sm, y_sm = smote.fit_sample(X, y)\n    rus = RandomUnderSampler(sampling_strategy=rus_ratio)\n    X, y = rus.fit_sample(X_sm,y_sm)\n    return X,y","84851c41":"X,y = balancing(X,y,1,1)","3af6653f":"y.value_counts()","b6d8d7f2":"plt.subplots(figsize=(10,5))\nsns.countplot(y)\nplt.xlabel('Target Label')\nplt.ylabel('Count')\nplt.title('Target Label Comparison')\n\nplt.show()","17dc8f4f":"from sklearn.feature_selection import SelectKBest, f_classif","62a8efcf":"selector = SelectKBest(f_classif, k=10)\nselector.fit(X, y)\n\ncols = selector.get_support(indices=True)\nX_new = X.iloc[:,cols]","ed47c897":"X_new.columns","de4e6673":"X_new.head()","bdf7e93f":"from sklearn.model_selection import train_test_split","56b3e83a":"X_train,X_test,y_train,y_test = train_test_split(X_new,y,test_size=0.2,stratify=y,random_state=42)\nX_train.shape,X_test.shape,y_train.shape,y_test.shape","35ddc844":"from sklearn.preprocessing import StandardScaler, PowerTransformer","6f6e294c":"num_pipe = Pipeline([\n    ('scaler',StandardScaler())\n])","59f5b15f":"num_column = ['city','city_development_index']","e25e9b7d":"def transform_scaling(X,num_column):\n    num_pipe.fit(X[num_column])\n    X[num_column] = num_pipe.transform(X[num_column])\n    return X","848f367a":"X_train = transform_scaling(X_train,num_column)\nX_test = transform_scaling(X_test,num_column)","615c5aff":"X_train.head()","84ec196e":"from sklearn.naive_bayes import GaussianNB\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom xgboost import XGBClassifier\nfrom sklearn.model_selection import GridSearchCV, RandomizedSearchCV","c7d34cf6":"models = Pipeline([\n    ('clf', None), \n])\n\nsearch = GridSearchCV(\n    models, \n    cv=3, \n    return_train_score=False, \n    scoring=['accuracy', 'recall', 'f1'],\n    refit = 'f1',\n    param_grid={\n        'clf': [GaussianNB(), RandomForestClassifier(), LogisticRegression(), XGBClassifier()]        \n})","93e3ed5f":"search.fit(X_train,y_train)\n\nprint('Best model:', search.best_params_)\nmodel_comparison = pd.DataFrame(search.cv_results_)\nmodel_comparison","c7991c6c":"model_comparison['model'] = ['Naive Bayes', 'Random Forest', 'Logistic Regression', 'XGB Classifier']\n\nfig, ax = plt.subplots(figsize=(10,5))\nax = sns.barplot('model', 'mean_test_accuracy', data=model_comparison, capsize=.05, palette='Blues', ci=None)\nax.set_xlabel(\"Models\",fontsize=12)\nax.set_ylabel(\"Accuracy (%)\",fontsize=12)\nax.tick_params(labelsize=12)\nax.axes.set_title(\"Accuracy Between Models\", fontsize=12)\n\nplt.show()","becfa36e":"param_xgb = {\n    'max_depth':np.arange(1,4),\n    'n_estimators':np.arange(169,171),\n    'gamma':np.arange(8,11),\n    'reg_alpha':np.linspace(0.33,0.34,100),\n    'reg_lambda':np.linspace(0.15,0.16,100)\n}\n\nmodel_selected = XGBClassifier(n_jobs=-1,random_state=42)","8cbd5d81":"model_xgb = RandomizedSearchCV(model_selected,param_xgb,cv=3,n_iter=100,n_jobs=-1,verbose=1,random_state=42)\nmodel_xgb.fit(X_train,y_train)\n\nprint(model_xgb.best_params_)\nprint(\"Train data accuracy score: \", model_xgb.score(X_train,y_train))\nprint(\"Test data accuracy score: \", model_xgb.score(X_test,y_test))","18cdedb2":"from sklearn.metrics import plot_confusion_matrix, classification_report, roc_auc_score, roc_curve","49d353ef":"y_pred = model_xgb.predict(X_test)","c3f2fb63":"# Confusion Matrix\n\nfig,ax = plt.subplots(figsize=(10,5))\nplot_confusion_matrix(model_xgb,X_test,y_test,cmap=plt.cm.Blues,normalize='true',ax=ax)\nax.set_xlabel('Predicted')\nax.set_ylabel('Actual')\nax.set_title('Confusion Matrix (Normalized)')","2cdf355a":"# Classification Report\n\nprint(classification_report(y_test,y_pred))","a0692166":"# ROC-AUC Score\n\nroc_auc = roc_auc_score(y_test, y_pred)\nprint(\"ROC-AUC score is\",roc_auc)","c7e86965":"y_pred_proba = model_xgb.predict_proba(X_test)","597141b6":"a = [i[1] for i in y_pred_proba]","e4b87371":"fpr,tpr,_ = roc_curve(y_test, a)","42bf1280":"fig = plt.subplots(figsize=(7,7))\n\nplt.plot([0, 1],[0, 1],color='navy',linestyle='--')\nplt.plot(fpr,tpr,color='orange',label='ROC curve (AUC = {})'.format(round(roc_auc,3)))\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive Rate')\nplt.legend(loc='lower right')\nplt.title('ROC Curve')\n\nplt.show()","7b95c4a8":"df_test = pd.read_csv('..\/input\/hr-analytics-job-change-of-data-scientists\/aug_test.csv')\ndf_test.head()","fdfe4e06":"df_test.info()","7a6afd34":"df_test['city'] = city_code(df_test['city'])","d44ee25b":"null_fill(df_test)","f0cc32cc":"df_test = encoder(df_test,ord_column,card_column)","fa6810bc":"df_test = df_test[['city', 'city_development_index', 'experience', 'company_size',\n                   'gender_Male', 'relevent_experience_Has relevent experience',\n                   'enrolled_university_no_enrollment', 'major_discipline_Unknown',\n                   'company_type_Pvt Ltd', 'company_type_Unknown']]","2416fc4b":"df_test = transform_scaling(df_test,num_column)","1105ba24":"df_test.head(6)","ff78e69f":"# Predict!\n\ny_test_pred = model_xgb.predict(df_test)","ba3609e7":"y_test_pred_proba = model_xgb.predict_proba(df_test)","bf4a1bcb":"pd.DataFrame(y_test_pred_proba)","aef9b189":"pd.DataFrame(y_test_pred).to_csv('submission.csv',index=False)","24bee969":"## Dataset Splitting ","3debf99a":"## Numerical Feature Treatment","037ba55b":"## Balancing Dataset ","1e2be55c":"## Model Selection ","b19b0e58":"## Encoding","09de8fff":"# Data Preparation","69163d3c":"## Submission ","7b1cde1f":"# Data Understanding","ec377bc2":"## Preparation","c45adc50":"## Missing Value Treatment","2d080f51":"# Prediction","1c105976":"A company which is active in Big Data and Data Science wants to hire data scientists among people who successfully pass some courses which conduct by the company. Many people signup for their training. Company wants to know which of these candidates are really wants to work for the company after training or looking for a new employment because it helps to reduce the cost and time as well as the quality of training or planning the courses and categorization of candidates. Information related to demographics, education, experience are in hands from candidates signup and enrollment.","c7eeff28":"# Business Understanding","ed8c667e":"# Modeling","19d4c0de":"## Hyperparameter Tuning ","0db21c5f":"# Evaluation","03a5a1ec":"## Feature Selection","dccbf359":"## Extract City Code "}}