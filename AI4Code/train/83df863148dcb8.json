{"cell_type":{"26f75274":"code","60d05072":"code","ee6d2ae0":"code","b07f9185":"code","780bdd26":"code","7398b678":"code","01b2f260":"markdown","982aaad8":"markdown","58f257e0":"markdown","988c999b":"markdown","ccf2bab8":"markdown"},"source":{"26f75274":"### Import Libraries\n\nimport numpy as np \nimport pandas as pd \nimport os\nfrom numpy import mean\n!pip install flaml\nimport flaml\nfrom flaml import AutoML\nimport warnings\nwarnings.filterwarnings('ignore')","60d05072":"\n\ntrain_path = '\/kaggle\/input\/petfinder-pawpularity-score\/train'\ntest_path = '\/kaggle\/input\/petfinder-pawpularity-score\/test'\n\ndf_train = pd.read_csv(train_path+'.csv')\ndf_test = pd.read_csv(test_path+'.csv')\n","ee6d2ae0":"# Take the train set columns as features\n\nfeature_cols=list(df_train.columns)[1:13]\n\n# Values of train and test dataframes\n\ntrain_set = np.array(df_train[feature_cols])\ntest_set = np.array(df_test[feature_cols])\n\n\n## bin the pawpularity score among a list of values ranging from 0 to 100\n### Labels is a list of pawpularity score values ranging from 1 to 10\n\ndf_train['label'] = pd.cut(np.array(df_train['Pawpularity']),\n                          bins = list(range(0,110,10)),\n                          labels = list(range(0,10)))\n\n\n## Calculate the average pawpularity score of pets \n## The pet score can be between 1 to 10\n\npaw_values = []\nfor i in range(0,10):\n    v = list(df_train[df_train['label'] == i]['Pawpularity'])\n    paw_values.append(mean(v))\nytrain = np.array(df_train['label'])","b07f9185":"import flaml\nfrom flaml import AutoML\nimport warnings\nwarnings.filterwarnings('ignore')\n\na = AutoML()\nsettings = {\n    'estimator_list':['xgboost','rf','lgbm','catboost'],\n    'log_file_name':'pp.log',\n    'task':'classification',\n    'metric':'accuracy',\n    'time_budget':360,\n    'seed':2021\n}\na.fit(train_set, ytrain,**settings)","780bdd26":"## Predicted output\n\npred = a.predict(test_set)\n\n## Iterate through the paw values list and \n## update the final predicted pawpularity scores\npred_set = [paw_values[i] for i in pred]\n\n## Convert the \npred_df = pd.DataFrame.from_dict({\n    \"Id\":list(df_test[\"Id\"]),\n    \"Pawpularity\":pred_set\n})\npred_df.to_csv('.\/submission.csv',index=False)\npred_df.head(5)","7398b678":"# Convert submission file to .csv and download the submission file\n\npred_df.to_csv('\/kaggle\/working\/submission.csv')\n\nfrom IPython.display import FileLink\nFileLink(r'submission.csv')","01b2f260":"## Problem statement\n\nPredict the pawpularity score of pet images.\n\n## About the dataset \n\n* The dataset contains pictures of stray dogs and animals looking for shelter and a happy home.\n* A cute, lovely picture of a dog could help him\/her find new pet parents.\n* The Pawpularity score is '\u2764\ufe0fCuteness\ud83d\udc95' score of an image. \n* The Id corresponds to image id of the pet.\n\n## Goal of this competion\n\n* Help company PetFinder.my in updating their \"Image cuteness\" calculation algorithms.\n* Find and analyze the data to find features, important in finding the 'Pawpularity Score'\n\n![image.png](attachment:be3a0f67-b558-4f3e-878d-e1d90b0887b2.png)","982aaad8":"## AutoML in Action \ud83d\ude0e\ud83c\udfb6\ud83c\udfb6\ud83d\udc81","58f257e0":"## Load the train and test files","988c999b":"## FLAML \n\nFLAML is a python package that can tell us the best-fit machine learning model for low computation. Thus, it removes the burden of the manual process of choosing the best model and best parameter. \n\nTo solve this problem, Microsoft built an AutoML system which is mainly focused on:\n\nModel selection\nHyperparameter tuning\nFeature engineering\nNeural architecture search\nModel compression \nThis is an ongoing project for model selection, feature engineering, and hyperparameter tuning. Microsoft has built the Microsoft FLAML library package using python development. In the next section, we will start with the basics of Microsoft FLAML(a fast and lightweight autoML library. \n\nRef: [Guide to FLAML](https:\/\/analyticsindiamag.com\/guide-to-microsofts-flaml\/)","ccf2bab8":"## Finding Pawpularity scores"}}