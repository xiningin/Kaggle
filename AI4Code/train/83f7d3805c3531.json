{"cell_type":{"da6ba930":"code","48df58aa":"code","e570c817":"code","d3d08bc5":"code","7ba0c095":"code","3dee5a2d":"code","9f0049b8":"code","5585e3cb":"code","e6eb1a49":"code","73fbede4":"code","0feaa5b1":"code","5f8b91de":"code","3f4651a1":"code","c901679c":"code","ed67e7d0":"code","23273675":"markdown","49ff4cf7":"markdown","df79800b":"markdown","4abddd50":"markdown","0f8e51ef":"markdown","2776e152":"markdown","b8d9e449":"markdown","5adedb9e":"markdown","d49e1afc":"markdown","52e030f3":"markdown","0180efd4":"markdown","558952ec":"markdown","eded8749":"markdown","c258a5be":"markdown","aa63a49f":"markdown","09ad4c07":"markdown","e8b1a0bc":"markdown","372e7f5b":"markdown","eee0d12d":"markdown"},"source":{"da6ba930":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","48df58aa":"import pandas as pd\nimport plotly.express as px","e570c817":"df = pd.read_csv('..\/input\/sp-beaches\/sp_beaches.csv', parse_dates=['Date'])\ndf.head()\n","d3d08bc5":"df.info()","7ba0c095":"df['Date'].min()","3dee5a2d":"df['Date'].max()","9f0049b8":"years = df.loc[:, 'Date':'Enterococcus'] #Selecting Date and Enterococcus columns\nyears.head()","5585e3cb":"years = years.groupby(df['Date'].dt.year)['Enterococcus'].mean().to_frame().reset_index() \nyears","e6eb1a49":"years = years.iloc[0:8, 0:3] #Selecting lines 0 to 7 in order to exclude 2020\nyears","73fbede4":"fig1 = px.bar(years, x='Date', y='Enterococcus', color='Enterococcus',\n              title='Year vs Enterococcus mean per year', color_continuous_scale= px.colors.sequential.Viridis_r)\nfig1.show()","0feaa5b1":"\nmonths = df.groupby(df['Date'].dt.month)['Enterococcus'].mean().to_frame().reset_index() \nmonths\n","5f8b91de":"fig2 = px.bar(months, x = 'Date', y = 'Enterococcus', \n              title = 'Enterococcus mena per month', color= 'Enterococcus', \n              color_continuous_scale= px.colors.sequential.Viridis_r)\nfig2.show()","3f4651a1":"latlon = pd.read_excel('..\/input\/sp-beaches-latlon\/sp_beaches_latlon(1).xlsx', parse_dates=True)\nlatlon.head()","c901679c":"\nfig3 = px.scatter_mapbox(latlon, lat=\"lat\", lon=\"lon\", hover_name=\"City\", size='Enterococcus', color='Enterococcus', size_max= 50,\n                        color_continuous_scale= px.colors.sequential.Inferno_r, zoom=8, height=500)\nfig3.update_layout(mapbox_style=\"open-street-map\")\nfig3.update_layout(margin={\"r\":10,\"t\":10,\"l\":0,\"b\":0})\nfig3.show()","ed67e7d0":"fig4 = px.scatter_mapbox(latlon, lat=\"lat\", lon=\"lon\", hover_name=\"City\", size='Enterococcus', color='Enterococcus', size_max= 50,\n                        color_continuous_scale= px.colors.sequential.solar_r, zoom=8, height=500)\nfig4.update_layout(\n    mapbox_style=\"white-bg\",\n    mapbox_layers=[\n        {\n            \"below\": 'traces',\n            \"sourcetype\": \"raster\",\n            \"source\": [\n                \"https:\/\/basemap.nationalmap.gov\/arcgis\/rest\/services\/USGSImageryOnly\/MapServer\/tile\/{z}\/{y}\/{x}\"\n            ]\n        }\n      ])\nfig4.update_layout(margin={\"r\":0,\"t\":0,\"l\":0,\"b\":0})\nfig4.show()","23273675":"## 1st Goal\n\n- [ ] Check ammount of *Enterococcus* along the years and analyze if it has improved or not\n\nFirst of all, let's check the last Date and the first Date in order to verify if we have measures of all year long.","49ff4cf7":"It's important to say that **the conclusions that I had along this data analysis doesn't reflect the reality necessarily** and should not be used for other thing otherwise in order to learn more about the language. \n\nThis was my first notebook in kaggle, I'm begginer in python language and Data Science so I hope this notebook help others beginners too. \n\nI will be so thankful for all the coments, critics etc...\n\n*Bye!*\n\n---","df79800b":"I will analyze the data by month, so it's necessary to get the data together by month","4abddd50":"Now it's easy to select just the rows that are interesting for the analysis. ","0f8e51ef":"Once the days and months doesn't interest for us now it's necessary to group the data by year. In the following code I grouped the data by year showing the mean of Enterococcus in each year, transformed the data in Dataframe (it was a Series before) and reseted index. As follows:","2776e152":"As we don't have data for all 2020 year. We will exclude this year of our data and will analyze from 2012 until 2019. We also will remove Columns `<City>` and `<'Beach'>` because they're not interesting for us now. ","b8d9e449":"*According with CETESB criteria for sea water: the Enterococcus density greater than 100 UFC\/100ml, in two or more samples of a set of five weeks or values greater than 400UFC\/100ml in the last sample,  characterize the impropriety of beach for primary contact recreation.*\n\n---\n**1st Goal Reached**\n\n- [x] **Check ammount of *Enterococcus* along the years and analyze if it has improved or not**\n\n> Analyzing the graph above we can see that along the years the Enterococcus mean is about 45 UFC\/100ml and 78 UFC\/100ml. From 2013 until 2016 the amount of Enterococcus was decreasing every year, but in 2018 and 2019 increased.\n\n> The Enterococcus mean was about the same along the 8 years of analysis, so there were no improvements that worked and there was no major worsening either.  ","5adedb9e":"## 2nd Goal\n\n- [ ] Check if the vacations or holidays have some relation with the the quality of the water.\n\nVacations in Brazil are usually in the months of **June - 06**, **July - 07**, **December - 12**, **January - 01** and **February - 02**","d49e1afc":"# Water quality on the beachs  of the coast of S\u00e3o Paulo \n\n*Qualidade da \u00c1gua nas praias do litoral do Estado de S\u00e3o Paulo*\n<center><img alt=\"beach\" width=\"90%\" src=\"https:\/\/raw.githubusercontent.com\/marcosmvgs\/Water-quality-on-the-beaches-of-S-o-Paulo\/master\/pngtree-yellow-beach-cartoon-ocean-taobao-travel-background-image_122125.jpg\"\/><\/center>\n\n**Context**\n\nOne criteria that can be used to measure the water quality of the beaches is the density of Enterococcus, which indicates the fecal pollution in water. High values of the density of this bacteria indicates that the water quality is compromised and it represents risks to the bathers health. The measurements are performed weekly in several beaches in the state of S\u00e3o Paulo and they are used to classify the beaches as 'Proper' or 'Improper' for bathing.\nContent\n\n**About the Data**\n\nThis data represents over 68k measurements of Enterococcus taken weekly between 2012 and 2020, from 16 cities and 168 beaches\/collection points in the S\u00e3o Paulo state.\n\nThe original source of the data was provided by [CETESB.!](https:\/\/cetesb.sp.gov.br\/)\n\nIn order to represent the statistics in a map i decided to include the coordinates of each beach in the Data as it will be seen along the notebook.\n\n**Goals** \n\n1. Check ammount of *Enterococcus* along the years and analyze if it has improved or not;\n2. Check if the vacations or holidays have some relation in the quality of the water;\n3. Plot on a map the beaches and the ammount of Enterococcus colected in each of them. ","52e030f3":"Importing libraries\n1. Pandas\n2. Plotly.express ","0180efd4":"**Ploting the data with plotly express**\n\nNow with our data organized it's easy to plot the graph","558952ec":"Just another type of graph","eded8749":"**2nd Goal Reached**\n\n- [x] **Check if the vacations or holidays have some relation with the the quality of the water.**\n\n> Analyzing the graph above we can see that in the months from December to March, especially January the levels os Enterococcus is much higher than the others. This coincides with the most used months for vacation but also coincides with the most rainy months in the year. See the graph below acquired at this [link!](https:\/\/pt.climate-data.org\/america-do-sul\/brasil\/sao-paulo\/sao-paulo-655\/#climate-table) showing the months vs precipitation.\n\n\n<center><img src=\"https:\/\/images.climate-data.org\/location\/655\/climate-graph.png\" width=\"600\" height=\"400\" \/><\/center>","c258a5be":"Creating the graph required ","aa63a49f":"Reading de Data","09ad4c07":"## 3th Goal\n\n- [ ] Plot on a map the beaches and the ammount of Enterococcus colected in each of them. \n\nSince we need the coordinates of each beach to create a map, I took them in google maps and create a new dataframe with two aditional columns, lat and long, in xlsx format.","e8b1a0bc":"We can see above that:\n* There's no null's\n* All columns have the right Dtype, including Date column\n\nSo our data is well organized","372e7f5b":"Checking the information about the Data","eee0d12d":"Ploting a Scatter map.\n\nBelow is ploted a mapbox graph so we can see that the bigger and darker the circle the more polluted the water is."}}