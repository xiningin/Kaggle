{"cell_type":{"be984212":"code","64ec1f4d":"code","5a46a6c2":"code","332e12fb":"code","af9b3b17":"code","c0024fa3":"code","a5587e9b":"code","1230ca1f":"code","4d715265":"code","216edd76":"code","4869164e":"code","5787b522":"code","6581c6b6":"markdown","34afcc23":"markdown","b2db6ff3":"markdown"},"source":{"be984212":"import pandas as pd\nimport numpy as np\n\nimport keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import Flatten\nfrom keras.layers import Dropout\nfrom keras.layers import LSTM\nfrom tensorflow.keras.utils import to_categorical","64ec1f4d":"df = pd.read_csv('..\/input\/riemann-hypothesis-1-million-prize\/prime_number.csv')\ndf.head()","5a46a6c2":"a = []\nfor i in range(0,len(df)):\n    a.append(df.prime[i:i+15].values)","332e12fb":"b = []\nfor i in range(0,len(df)):\n    try:\n        b.append(df.prime[i+15])\n    except:\n        print(i)","af9b3b17":"len(a)","c0024fa3":"len(b)","a5587e9b":"a1 = np.array(a[:148918],dtype=np.float32)\nb1 = pd.Series(np.array(b[:148918],dtype=np.float32))","1230ca1f":"a1.shape","4d715265":"a1 = np.expand_dims(a1, -1)","216edd76":"a1.shape","4869164e":"model = Sequential()\n\nmodel.add(LSTM(1024, input_shape=(15, 1),return_sequences=True))\nmodel.add(LSTM(512, return_sequences=True,dropout=0.2))\nmodel.add(LSTM(256, return_sequences=True,dropout=0.2))\nmodel.add(LSTM(128, return_sequences=False))\nmodel.add(Dense(1))\nmodel.compile(loss='mse', optimizer=keras.optimizers.Adadelta())\nmodel.fit(a1[:100], b1[:100], epochs=10, batch_size=10)","5787b522":"model.predict(a1[100:110])","6581c6b6":"## Create time dataset","34afcc23":"## We only need Prime numbers","b2db6ff3":"## Loss is Huge"}}