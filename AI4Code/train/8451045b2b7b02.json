{"cell_type":{"1c2a1bf3":"code","eca125ad":"code","79babe1f":"code","6c17b98d":"code","ccbc567a":"code","ec1e5dcb":"code","10f756de":"code","cf855e5f":"code","3192fad9":"code","fbc76718":"code","d676b75e":"code","0d27722a":"code","2ea16ddf":"code","b309a821":"code","4258b372":"code","4f17d496":"code","7fa29647":"code","b3e33b3e":"code","d6be627a":"code","b9f74bfa":"code","938d094b":"code","742eeb6d":"code","b760f06c":"code","eff7a315":"code","ed3dda7b":"code","8e767a6b":"code","b4e8c0e8":"code","ec108e9e":"code","218275fa":"code","da5d79a9":"code","345b4fec":"code","793396f7":"code","93a6412f":"code","c75fb6b3":"code","30ca2c52":"code","9afcf725":"code","a97e101b":"code","feff41f4":"code","621d37a4":"code","a843e9c8":"code","17393c13":"code","5dffa7f1":"code","649be684":"code","58d857ae":"code","b39c2aec":"code","371ea81b":"code","679067e5":"code","96653cf0":"code","17dd6470":"code","3141afa0":"code","ef2a8320":"code","7f63b86b":"code","3aded308":"code","08f5ec5a":"code","8123ad69":"code","3b7ed16d":"code","bfe9e0e5":"code","777ed3c0":"code","caae2303":"code","7948b61d":"code","a23ff125":"code","049a4077":"code","278f0d91":"code","3aa136b2":"code","c7f77213":"code","c81388c7":"markdown","6028d102":"markdown","5020175f":"markdown","9fc5ac0a":"markdown","3bd34333":"markdown","c925ab5f":"markdown","fe382c88":"markdown","18110986":"markdown","31cb1c76":"markdown","5f40c6f2":"markdown","47fa9478":"markdown","c10154c7":"markdown","83095e44":"markdown","f4b7405a":"markdown","76f4547f":"markdown","9bb14b59":"markdown","8546fed4":"markdown","39cb8ee3":"markdown","c92b1d23":"markdown","45fab1ac":"markdown","f298b20b":"markdown","60df7a93":"markdown","9bd6f41e":"markdown","646250bf":"markdown","bc1be127":"markdown","29a1ab3c":"markdown","7f3637e2":"markdown","d5167305":"markdown","f6c6a1e1":"markdown","7cbf89c7":"markdown"},"source":{"1c2a1bf3":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport math\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","eca125ad":"df = pd.read_csv('..\/input\/iesb-2019\/train.csv')\ntest = pd.read_csv('..\/input\/iesb-2019\/test.csv')","79babe1f":"df['nota_mat'] = np.log(df['nota_mat'])","6c17b98d":"df.info()","ccbc567a":"df = df.append(test, sort = False)","ec1e5dcb":"df['codigo_mun'].sample(5)","10f756de":"df['codigo_mun'] = df['codigo_mun'].str.replace('ID_ID_','')","cf855e5f":"df['codigo_mun'].sample(5)","3192fad9":"df['codigo_mun'].astype('int32')","fbc76718":"df['codigo_mun'].value_counts().sum()","d676b75e":"df.head()","0d27722a":"df.tail()","2ea16ddf":"df.shape","b309a821":"df.nunique()","4258b372":"df.sample(5).T","4f17d496":"df.isnull().sum()","7fa29647":"type(df)","b3e33b3e":"df.describe().T","d6be627a":"df['perc_pop_econ_ativa']=df['perc_pop_econ_ativa']*100","b9f74bfa":"df[['municipio','nota_mat']].sample(5)","938d094b":"df['nota_mat'].describe()","742eeb6d":"df.groupby('estado')['nota_mat'].describe()","b760f06c":"df.groupby('regiao')['nota_mat'].describe()","eff7a315":"import seaborn as sns\nsns.distplot(df['nota_mat'].dropna())","ed3dda7b":"sns.boxplot(y=\"nota_mat\", data=df)","8e767a6b":"df.groupby('regiao').nota_mat.mean().plot.bar()","b4e8c0e8":"sns.boxplot(x=\"regiao\", y=\"nota_mat\", data=df)","ec108e9e":"sns.boxplot(x=\"capital\", y=\"nota_mat\", data=df)","218275fa":"sns.boxplot(x=\"regiao\", y=\"nota_mat\", hue=\"capital\",\n...                  data=df, palette=\"Set3\")","da5d79a9":"sns.violinplot(y='nota_mat', x='regiao',hue='capital', data=df)","345b4fec":"sns.violinplot(y='nota_mat', x='capital',data=df)","793396f7":"sns.boxplot(x=\"porte\", y=\"nota_mat\",data=df, palette=\"Set3\")","93a6412f":"sns.pairplot(x_vars='gasto_pc_educacao', y_vars='nota_mat', hue = 'capital', \n             data=df, size=7, kind='reg')","c75fb6b3":"sns.pairplot(x_vars='gasto_pc_saude', y_vars='nota_mat',\n             hue = 'capital', data=df, size=7,kind='reg')","30ca2c52":"sns.pairplot(x_vars='exp_vida', y_vars='nota_mat', \n             hue='capital',data=df, size=7,kind='reg')","9afcf725":"sns.pairplot(x_vars='exp_vida', y_vars='nota_mat', \n             data=df, size=7,kind='reg')","a97e101b":"sns.pairplot(x_vars='idhm', y_vars='nota_mat',\n             hue='capital',data=df, size=7,kind='reg')","feff41f4":"sns.pairplot(x_vars='idhm', y_vars='nota_mat',\n             data=df, size=7,kind='reg')","621d37a4":"sns.pairplot(x_vars='perc_pop_econ_ativa', y_vars='nota_mat', \n             hue='capital', data=df, size=7,kind='reg')","a843e9c8":"sns.pairplot(x_vars='perc_pop_econ_ativa', y_vars='nota_mat', \n              data=df, size=7,kind='reg')","17393c13":"sns.pairplot(x_vars='taxa_empreendedorismo', y_vars='nota_mat',\n             hue='capital', data=df, size=7,kind='reg')","5dffa7f1":"corr = df[['nota_mat',\n       'exp_vida','perc_pop_econ_ativa','idhm',\n       'densidade_dem','gasto_pc_saude','gasto_pc_educacao',\n      'pib_pc','taxa_empreendedorismo']].corr()\ncorr['nota_mat']","649be684":"df[['nota_mat',\n       'exp_vida','perc_pop_econ_ativa','idhm',\n       'densidade_dem','gasto_pc_saude','gasto_pc_educacao',\n      'pib_pc','taxa_empreendedorismo']].corr()","58d857ae":"corr_groupby=df.groupby('capital')[['nota_mat',\n       'exp_vida','perc_pop_econ_ativa','idhm','taxa_empreendedorismo']].corr()\ncorr_groupby['nota_mat']","b39c2aec":"df.fillna(-2, inplace=True)","371ea81b":"from sklearn.ensemble import RandomForestRegressor","679067e5":"from sklearn.model_selection import train_test_split","96653cf0":"df, test = df[df['nota_mat']!=-2], df[df['nota_mat']==-2]","17dd6470":"train, valid = train_test_split(df, random_state=42)","3141afa0":"removed_cols = ['Unnamed: 0','porte', \n                'capital', 'regiao', 'estado','municipio','codigo_mun',\n                'populacao','comissionados_por_servidor','area','densidade_dem',\n                'ranking_igm','indice_governanca','exp_vida','perc_pop_econ_ativa','nota_mat']","ef2a8320":"rf = RandomForestRegressor(random_state=42, n_estimators=100)","7f63b86b":"feats = [c for c in df.columns if c not in removed_cols]","3aded308":"rf.fit(train[feats], train['nota_mat'])","08f5ec5a":"from sklearn.metrics import mean_squared_error","8123ad69":"valid_preds = rf.predict(valid[feats])","3b7ed16d":"mean_squared_error(valid['nota_mat'], valid_preds)**(1\/2)","bfe9e0e5":"test['nota_mat'] = np.exp(rf.predict(test[feats]))","777ed3c0":"test.sample(5).T","caae2303":"test[['codigo_mun','nota_mat']].to_csv('SampleSubmissionRF.csv', index=False)","7948b61d":"from sklearn.ensemble import RandomForestRegressor, ExtraTreesRegressor\nfrom sklearn.ensemble import AdaBoostRegressor, GradientBoostingRegressor\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.svm import SVR","a23ff125":"models = {'RandomForest': RandomForestRegressor(random_state=42),\n         'ExtraTrees': ExtraTreesRegressor(random_state=42),\n         'GBM': GradientBoostingRegressor(random_state=42),\n         'DecisionTree': DecisionTreeRegressor(random_state=42),\n         'AdaBoost': AdaBoostRegressor(random_state=42),\n         'KNN 1': KNeighborsRegressor(n_neighbors=1),\n         'KNN 3': KNeighborsRegressor(n_neighbors=3),\n         'KNN 11': KNeighborsRegressor(n_neighbors=11),\n         'SVR': SVR(),\n         'Linear Regression': LinearRegression()}","049a4077":"def run_model(model, train, valid, feats, nota_mat):\n    model.fit(train[feats], train[nota_mat])\n    preds = model.predict(valid[feats])\n    return mean_squared_error(valid[nota_mat], preds)**(1\/2)","278f0d91":"import warnings\nwarnings.filterwarnings('ignore', category=FutureWarning)","3aa136b2":"scores = []\nfor name, model in models.items():\n    score = run_model(model, train, valid, feats, 'nota_mat')\n    scores.append(score)\n    print(name+':', score)","c7f77213":"pd.Series(scores, index=models.keys()).sort_values(ascending=False).plot.barh()","c81388c7":"## **explorando a vari\u00e1vel \"nota_mat\"**","6028d102":"* > **Verificando quantidade de valores \u00fanicos por coluna**","5020175f":"* >  Nota em matem\u00e1tica vs gasto percapita em sa\u00fade","9fc5ac0a":"## Explorando as vari\u00e1veis num\u00e9ricas da base","3bd34333":"* > Separando as bases e criando os conjuntos de treino e valida\u00e7\u00e3o","c925ab5f":"os dados se dispersam de forma uniforme e crescente, indicando uma poss\u00edvel associa\u00e7\u00e3o entre nota em matem\u00e1tica e a expectativa de vida da cidade","fe382c88":"> **Lendo os dados**","18110986":"## Verificando n\u00ba de valores nulos por coluna","31cb1c76":">* **Informa\u00e7\u00f5es da base**","5f40c6f2":"Observa-se pelo box-plot que cidades que n\u00e3o s\u00e3o capitais possuem uma maior variabilidade na nota de matem\u00e1tica, o que j\u00e1 era de se esperar pois s\u00e3o a maioria, e que a mediana da nota de matem\u00e1tica \u00e9 maior nas capitais.","47fa9478":"* > **nota de matem\u00e1tica por uf** ","c10154c7":"* >  Nota em matem\u00e1tica vs gasto percapita em educa\u00e7\u00e3o","83095e44":"* >  Nota em matem\u00e1tica vs percentual de popula\u00e7\u00e3o economicamente ativa","f4b7405a":"* >  Nota em matem\u00e1tica vs expectativa de vida","76f4547f":"## Verificando o tipo da base","9bb14b59":"Percebe-se que a correla\u00e7\u00e3o \u00e9 ainda mais forte dentro das capitais.","8546fed4":"assim como a expectativa de vida, o IDH municipal tamb\u00e9m parece ser um fator ao qual a nota em matem\u00e1tica est\u00e1 associada","39cb8ee3":"> * **Transformando a vari\u00e1vel de interesse em logar\u00edtimo**","c92b1d23":"* >  Nota em matem\u00e1tica vs IDH do munic\u00edpio","45fab1ac":"Nota-se tamb\u00e9m forte correla\u00e7\u00e3o entre idhm e percentual da popula\u00e7\u00e3o economicamente ativa e expectativa de vida, o que pode causar multicolinearidade no modelo.","f298b20b":"Corroborando com a an\u00e1lise gr\u00e1fica feita anteriormente, percebe-se forte correla\u00e7\u00e3o linear positiva entre a nota de matem\u00e1tica e expectativa de vida, percentual da popula\u00e7\u00e3o economicamente ativa e IDH municipal. ","60df7a93":" >* ## ** Verificando correla\u00e7\u00e3o** ","9bd6f41e":"* >  Nota em matem\u00e1tica vs taxa_empreendedorismo","646250bf":">* **Veficando as dimens\u00f5es da base** ","bc1be127":"## Juntando as bases","29a1ab3c":"* > **Visualizando as duas vari\u00e1veis de interesse** ","7f3637e2":"> * **Comparando nota_mat com outras vari\u00e1veis**","d5167305":"* > ## **Modelagem**","f6c6a1e1":"* > M\u00e9dia da nota por regi\u00e3o","7cbf89c7":"* > nota de matem\u00e1tica por regi\u00e3o"}}