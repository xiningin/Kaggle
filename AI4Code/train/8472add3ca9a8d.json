{"cell_type":{"feb36a59":"code","90120088":"code","edeb4596":"code","214bc188":"code","7cdb1c79":"code","fc638b39":"code","9b373cf3":"code","987b2ffd":"code","a29d6a5c":"code","42a9134f":"code","18185474":"markdown","5590fd17":"markdown","2a3fbd9a":"markdown","2bad0e6c":"markdown"},"source":{"feb36a59":"import numpy as np\nimport pandas as pd\nimport os\n\nurunler = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/items.csv')\nkategoriler = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/item_categories.csv')\nsatislar = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/sales_train.csv')\nmagazalar = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/shops.csv')\n\n\n\nsatislar.head()\n#kategoriler.head()\n","90120088":"magazalar.head()","edeb4596":"import plotly.offline as py\nimport plotly.express as px\nfrom fbprophet import Prophet\nfrom fbprophet.plot import plot_plotly, add_changepoints_to_plot\n\nthveri = satislar   # Tahmin verileri\nthveri = thveri.fillna(0)\nthveri_grp = thveri.groupby(\"date\")[[\"item_id\",\"item_cnt_day\"]].sum().reset_index()\nthveri_cntday = thveri_grp.loc[:,[\"date\",\"item_cnt_day\"]]\nth_data = thveri_cntday\nth_data.columns = ['ds','y']    #ds: dates  -  y: values\nth_data.head()","214bc188":"urunModel=Prophet()\nurunModel.fit(th_data)\nozellik1=urunModel.make_future_dataframe(periods=6,freq='M')   #  Bir sonraki ay olan Kas\u0131m 2015'in de i\u00e7inde bulundu\u011fu gelecek 6 ay\u0131n tahmin verileri i\u00e7in \u00f6zellik dataframe'i\ntahmin1=urunModel.predict(ozellik1)\ntahmin1\n\n#fig = plot_plotly(m, tahmin)\n#py.iplot(fig) \n\nfig = urunModel.plot(tahmin1,xlabel='Aylar',ylabel='Aylara G\u00f6re Sat\u0131lan Toplam \u00dcr\u00fcn Miktar\u0131', figsize=(20,5))   # Son 6 ay tahminleri i\u00e7ermektedir","7cdb1c79":"ft=thveri\ndef mask(df, key, value):\n    return df[df[key] == value]\npd.DataFrame.mask = mask\n\nid=21                        #        Ma\u011faza id'si \"21\" se\u00e7ilsin\n\nmagaza=magazalar.loc[magazalar['shop_id'] == id, 'shop_name'].iloc[0]\n\nft2=ft.mask('shop_id', id)   #        Bu id'ye g\u00f6re filtreledim ---- \u00d6nemli: Baz\u0131 ma\u011fazalar\u0131n 2015 Ekim'e kadar sat\u0131\u015f verileri yok\nft2.tail(10)","fc638b39":"print(\"Secilen magaza ad\u0131: \",magaza)","9b373cf3":"\n\nmagazaTahmin_grp = ft2.groupby(\"date\")[\"item_cnt_day\"].sum().reset_index()\nmagazaTahmin_cntday = magazaTahmin_grp.loc[:,[\"date\",\"item_cnt_day\"]]\nmagazaTahmin_data = magazaTahmin_cntday\nmagazaTahmin_data.columns = ['ds','y']    #ds: dates  -  y: values olmakta\nmagazaTahmin_data.head()\n\nmodelMagaza=Prophet()\nmodelMagaza.fit(magazaTahmin_data)\ndFozellik2=modelMagaza.make_future_dataframe(periods=6,freq='M')   #  Bir sonraki ay olan Kas\u0131m 2015'in de i\u00e7inde bulundu\u011fu gelecek 6 ay\u0131n tahmin verileri i\u00e7in \u00f6zellik dataframe'i\ntahmin2=modelMagaza.predict(dFozellik2)\ntahmin2\n\n#fig2 = plot_plotly(modelMagaza, tahmin2)\n#py.iplot(fig2) \n\n\n\nfig2=modelMagaza.plot(tahmin2,xlabel='Aylar',ylabel= magaza + \"   Ma\u011fazas\u0131n\u0131n Ayl\u0131k Sat\u0131\u015f Miktar\u0131\", figsize=(20,5))   # Magaza yukar\u0131dan de\u011fi\u015ftirilebilir","987b2ffd":"from fbprophet.diagnostics import cross_validation\ndf_cv = cross_validation(modelMagaza, initial='730 days', period='30 days', horizon = '180 days')    # Yukar\u0131daki tahmin periyodunu 6 belirledi\u011fimden horizon = 6*30 olmal\u0131\ndf_cv.head()","a29d6a5c":"from fbprophet.diagnostics import performance_metrics\ndf_p = performance_metrics(df_cv)\ndf_p.head()\n","42a9134f":"from fbprophet.plot import plot_cross_validation_metric\nfig = plot_cross_validation_metric(df_cv, metric='mape')","18185474":"# ------------------------**Ma\u011fazalar\u0131n Sat\u0131\u015f Tahmini**---------------------------","5590fd17":"# ------------------------\u00d6n Haz\u0131rl\u0131k---------------------------","2a3fbd9a":"# ------------------------**Model Performans\u0131**---------------------------","2bad0e6c":"# ------------------------**\u00dcr\u00fcnlerin Sat\u0131\u015f Tahmini**---------------------------"}}