{"cell_type":{"a11d66b6":"code","34934151":"code","9535d063":"code","4025f0e3":"code","d6d000e8":"code","ac90bb43":"code","0cb93097":"code","bf4d6a85":"code","d378789f":"code","fd3cfd59":"code","1aed5aea":"code","738f812b":"code","91d8ba22":"code","6b4f7ac0":"code","6409ad02":"code","69fc7983":"code","6eb35806":"code","26624e72":"code","f63a26ed":"code","cb1c85d8":"code","c2a029cf":"code","9bb8eda8":"code","7daa5c5b":"code","5934c99a":"code","cfb0ea60":"code","c541ed8d":"code","a8dd1adf":"code","17192036":"code","eade45cc":"code","8f52a74d":"code","dac0c6a1":"code","2b38be58":"code","aaad7836":"code","1b29cb75":"code","64a4521c":"code","e162a88c":"code","0ddc0ae7":"code","471f6138":"code","7659f3c6":"code","3c3c886a":"code","4c093589":"code","a04c6cc2":"code","e13c6a20":"code","8cd8bd29":"code","ac08a4ff":"markdown","eb40224d":"markdown","d59831c2":"markdown","aa888115":"markdown","015cc6b9":"markdown","c9a2d43c":"markdown","cf3034d4":"markdown","a0dba5dd":"markdown","f853a604":"markdown","f64b2765":"markdown","1e4629da":"markdown","2b05ea61":"markdown","a4c8ab69":"markdown","c70c5885":"markdown","0d2ee5e5":"markdown","61463427":"markdown","f9b42321":"markdown","c217b5c8":"markdown","1232fd3f":"markdown","c04685c8":"markdown","1fe3be8c":"markdown","09936649":"markdown","978e2072":"markdown","6ca8ca65":"markdown","b5a27639":"markdown","123152a6":"markdown","32837f24":"markdown","90c251e7":"markdown","0755ee8e":"markdown","661c69a7":"markdown","4bd79c62":"markdown","b6bc28ea":"markdown","5a1caa27":"markdown","3c5a5ac2":"markdown","3f59d086":"markdown","5403c13b":"markdown"},"source":{"a11d66b6":"import pandas as pd\nimport sklearn\nimport matplotlib.pyplot as plt\nimport numpy as np","34934151":"adulto = pd.read_csv('..\/input\/adult-pmr3508\/train_data.csv',\n        names=[\n        'id', \"Age\", \"Workclass\", \"fnlwgt\", \"Education\", \"Education-Num\", \"Marital Status\",\n        \"Occupation\", \"Relationship\", \"Race\", \"Sex\", \"Capital Gain\", \"Capital Loss\",\n        \"Hours per week\", \"Country\", \"Target\"],\n        sep=r'\\s*,\\s*',\n        engine='python',\n        na_values=\"?\")\nadulto = adulto.drop(0, axis=0) #retirar linha repetida no in\u00edcio\nadultoteste = pd.read_csv('..\/input\/adult-pmr3508\/test_data.csv',\n        names=[\n        'id', \"Age\", \"Workclass\", \"fnlwgt\", \"Education\", \"Education-Num\", \"Marital Status\",\n        \"Occupation\", \"Relationship\", \"Race\", \"Sex\", \"Capital Gain\", \"Capital Loss\",\n        \"Hours per week\", \"Country\"],    \n        sep=r'\\s*,\\s*',\n        engine='python',\n        na_values=\"?\")\nadultoteste = adultoteste.drop(0, axis=0)","9535d063":"adulto.head()","4025f0e3":"adultoteste.head()","d6d000e8":"adulto.describe()","ac90bb43":"adulto.shape","0cb93097":"adulto['Race'].value_counts()","bf4d6a85":"piechart = adulto['Race'].value_counts().plot(kind='pie', figsize = (7,7))\npiechart.legend(loc=\"upper right\")","d378789f":"adulto['Education-Num'].value_counts()","fd3cfd59":"grafbarra = adulto['Education-Num'].value_counts().plot(kind=\"bar\", figsize = (5,5), title = 'Education-Num Bar Graph')\ngrafbarra.set_xlabel('Education-Num')\ngrafbarra.set_ylabel('Quantity')","1aed5aea":"comp1 = pd.crosstab(adulto['Age'], adulto['Target'])\ncomp1.plot()","738f812b":"comp2 = pd.crosstab(adulto['Workclass'], adulto['Target'])\ncomp2.plot()","91d8ba22":"comp3 = pd.crosstab(adulto['Education'], adulto['Target'])\ncomp3.plot()","6b4f7ac0":"comp4 = pd.crosstab(adulto['Education-Num'], adulto['Target'])\ncomp4.plot()","6409ad02":"comp5 = pd.crosstab(adulto['Marital Status'], adulto['Target'])\ncomp5.plot()","69fc7983":"comp6 = pd.crosstab(adulto['Occupation'], adulto['Target'])\ncomp6.plot()","6eb35806":"adulto['Occupation'].value_counts()","26624e72":"comp7 = pd.crosstab(adulto['Relationship'], adulto['Target'])\ncomp7.plot()","f63a26ed":"adulto['Relationship'].value_counts()","cb1c85d8":"comp8 = pd.crosstab(adulto['Race'], adulto['Target'])\ncomp8.plot()","c2a029cf":"comp9 = pd.crosstab(adulto['Sex'], adulto['Target'])\ncomp9.plot()","9bb8eda8":"comp10 = pd.crosstab(adulto['Capital Gain'], adulto['Target'])\ncomp10.plot()","7daa5c5b":"comp11 = pd.crosstab(adulto['Capital Loss'], adulto['Target'])\ncomp11.plot()","5934c99a":"comp12 = pd.crosstab(adulto['Hours per week'], adulto['Target'])\ncomp12.plot()","cfb0ea60":"comp13 = pd.crosstab(adulto['Country'], adulto['Target'])\ncomp13.plot()","c541ed8d":"adulto.isnull().sum()","a8dd1adf":"adultoteste.isnull().sum()","17192036":"relationlist = [\n[\"Husband\" ,          13193],\n[\"Not-in-family\",      8304],\n[\"Own-child\"     ,     5068],\n[\"Unmarried\"      ,    3446],\n[\"Wife\"            ,   1568],\n[\"Other-relative\"   ,   981]]\n\ndef relationset(parametro):\n    for i in range(len(relationlist)):\n        if parametro == relationlist[i][0]:\n            return relationlist[i][1]\n    return parametro\n\nracelist = [\n[\"White\",                 25932],\n[\"Black\",                  2817],\n[\"Asian-Pac-Islander\",      895],\n[\"Amer-Indian-Eskimo\",      286],\n[\"Other\",                   231]\n]\n\ndef raceset(parametro):\n    for i in range(len(racelist)):\n        if parametro == racelist[i][0]:\n            return racelist[i][1]\n    return parametro\n\nsexlist = [\n[\"Male\",      20379],\n[\"Female\",     9782]\n]\n\ndef sexset(parametro):\n    for i in range(len(sexlist)):\n        if parametro == sexlist[i][0]:\n            return sexlist[i][1]\n    return parametro","eade45cc":"adulto['Relationship'] = adulto['Relationship'].apply(relationset)\nadulto['Race'] = adulto['Race'].apply(raceset)\nadulto['Sex'] = adulto['Sex'].apply(sexset)\n\nadultoteste['Relationship'] = adultoteste['Relationship'].apply(relationset)\nadultoteste['Race'] = adultoteste['Race'].apply(raceset)\nadultoteste['Sex'] = adultoteste['Sex'].apply(sexset)","8f52a74d":"nadulto = adulto.dropna()\nnadultoteste = adultoteste","dac0c6a1":"nadulto.head()","2b38be58":"nadultoteste.head()","aaad7836":"Xadulto = nadulto[['Age', 'Education-Num','Relationship', 'Capital Gain', 'Capital Loss']]\nYadulto = nadulto.Target","1b29cb75":"Xadultoteste = nadultoteste[['Age', 'Education-Num','Relationship', 'Capital Gain', 'Capital Loss']]","64a4521c":"from sklearn.neighbors import KNeighborsClassifier\nKnn = KNeighborsClassifier(n_neighbors=28, p=1)","e162a88c":"from sklearn.model_selection import cross_val_score","0ddc0ae7":"scores  = cross_val_score(Knn, Xadulto, Yadulto, cv = 13)","471f6138":"Knn.fit(Xadulto, Yadulto)","7659f3c6":"Yadultoteste = Knn.predict(Xadultoteste)","3c3c886a":"Yadultoteste = Knn.predict(Xadultoteste)","4c093589":"accuracy = np.mean(scores)","a04c6cc2":"accuracy","e13c6a20":"id_index = pd.DataFrame({'Id' : list(range(len(Yadultoteste)))})\nincome = pd.DataFrame({'income' : Yadultoteste})\nresult = income\nresult","8cd8bd29":"result.to_csv(\"submission.csv\", index = True, index_label = 'Id')","ac08a4ff":"\u00c9 poss\u00edvel perceber que h\u00e1 uma boa discrimina\u00e7\u00e3o de renda para alguns empregos:","eb40224d":"Aqui os dados obtidos nos dados de teste ser\u00e3o mostrados e salvos:","d59831c2":"Aqui ocorrem os testes de acur\u00e1cia:","aa888115":"O comando value_counts() \u00e9 \u00fatil para saber quais atributos e suas quantidades existem em determinada coluna:","015cc6b9":"### \u00c9 importante saber quais dados discriminam mais os atributos do Target estudado:","c9a2d43c":"\u00c9 poss\u00edvel notar que em poucos par\u00e2metros h\u00e1 uma boa discrimina\u00e7\u00e3o de renda dentre os par\u00e2metros da Educa\u00e7\u00e3o:","cf3034d4":"\u00c9 poss\u00edvel notar que entre os brancos h\u00e1 uma boa discrimina\u00e7\u00e3o de renda:","a0dba5dd":"Os comandos describe() e shape s\u00e3o \u00fateis para se tomar informa\u00e7\u00f5es r\u00e1pidas, como a quantidade de dados, a \nfrequ\u00eancia deles, o atributo mais comum em cada coluna...","f853a604":"Mas um gr\u00e1fico de setores \u00e9 de mais simples visualiza\u00e7\u00e3o:","f64b2765":"\u00c9 poss\u00edvel notar que dentre os trabalhadores do ramo privado, h\u00e1 uma boa distin\u00e7\u00e3o de rendas:","1e4629da":"Para o in\u00edcio da prepara\u00e7\u00e3o, \u00e9 importante saber quais par\u00e2metros possuem dados faltantes, e quantos o s\u00e3o:","2b05ea61":"\u00c9 poss\u00edvel notar que h\u00e1 uma boa discrimina\u00e7a\u00f5 de renda entre algumas quantidades de horas trabalhadas:","a4c8ab69":"## Prepara\u00e7\u00e3o dos dados:","c70c5885":"Para poder usar par\u00e2metros que s\u00e3o em forma de string, deve-se relacion\u00e1-los a integers:\n\nOs r\u00f3tulos foram associados \u00e0s suas respectivas frequ\u00eancias","0d2ee5e5":"Percebe-se que h\u00e1 uma boa discrimina\u00e7\u00e3o de renda em um certo pa\u00eds:","61463427":"Para importar os arquivos, pareceu \u00fatil alterar o nome das colunas, mas para isso, foi necess\u00e1rio apagar o nome previamente utilizado","f9b42321":"Utilizei o mesmo comando value_counts para outro par\u00e2metro dos dados:","c217b5c8":"# An\u00e1lise da base de dados adult","1232fd3f":"Aqui o algor\u00edtmo \u00e9 usado nos dados de teste:","c04685c8":"A tabela de dados ficou melhor:","1fe3be8c":"\u00c9 poss\u00edvel perceber que h\u00e1 uma \u00f3tima discrimina\u00e7\u00e3o de renda entre os tipos de relacionamento:","09936649":"Apesar de se ter convertido os dados dos par\u00e2metros Race e Sex para integers, o classificador obteve resultado melhor sem eles (0,2%)","978e2072":"Aqui ocorre o aprendizado:","6ca8ca65":"Para uma estima\u00e7\u00e3o melhor, usa-se o m\u00e9todo da crossvalidation, que est\u00e1 tamb\u00e9m presente na biblioteca sklearn:","b5a27639":"\u00c9 poss\u00edvel perceber que para ambos sexos h\u00e1 uma boa discrimina\u00e7\u00e3o de renda:","123152a6":"\u00c9 poss\u00edvel notar que apenas em um atributo do par\u00e2metro de estado civil h\u00e1 uma boa discrimina\u00e7\u00e3o de rendas:","32837f24":"O KneighborsClassifier \u00e9 uma fun\u00e7\u00e3o da biblioteca sklearn  que realiza o classificador knn com os valores explicitados:","90c251e7":"## Entendimento dos dados:","0755ee8e":"\u00c9 poss\u00edvel notar que ambos par\u00e2metros de renda variam de forma parecida para em cada atributo na compara\u00e7\u00e3o do n\u00edvel de educa\u00e7\u00e3o com o Target:","661c69a7":" Bem, no trabalho comecei importando as bibliotecas a serem utilizadas:","4bd79c62":"Foi atingida uma acur\u00e1cia de 85,3%","b6bc28ea":"Nesse caso, como h\u00e1 muitos atributos, o gr\u00e1fico de barras pareceu mais apropriado:","5a1caa27":"O comando apply() substitui os antigos nomes dos atributos pelos novos determinados pelas fun\u00e7\u00f5es acima:","3c5a5ac2":"\u00c9 poss\u00edvel perceber que at\u00e9 antes dos 50 anos, h\u00e1 uma boa discrimina\u00e7\u00e3o de rendas:","3f59d086":"\u00c9 poss\u00edvel perceber que n\u00e3o h\u00e1 grande discrimina\u00e7\u00e3o de renda entre quem ganhou e perdeu capital:","5403c13b":"Define-se aqui os par\u00e2metros aprendidos pela m\u00e1quina (Xadulto) e o par\u00e2metro desejado (Yadulto):"}}