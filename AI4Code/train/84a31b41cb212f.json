{"cell_type":{"5cde1d6a":"code","b8c2158b":"code","23c36cc8":"code","edf03a95":"code","8c037252":"code","9888ca93":"code","bd23997d":"code","f9fc9095":"code","acd9ecb9":"code","4dce2947":"code","adf6d3d8":"code","32a849d8":"code","2bf10b57":"markdown","0ceba9c2":"markdown","5ce1eaa1":"markdown","11fcb7f1":"markdown","24a7b0b8":"markdown","02750ff9":"markdown","273c3f05":"markdown","716d6c3b":"markdown","be57a9fa":"markdown","46821b6d":"markdown","2abaee72":"markdown","dbd7e636":"markdown","4b31ae50":"markdown"},"source":{"5cde1d6a":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom sklearn.cluster import KMeans # for KMeans\nimport matplotlib.pyplot as plt\n%matplotlib inline ","b8c2158b":"ds = pd.read_csv('..\/input\/usarrests\/USArrests.csv')","23c36cc8":"ds.head()","edf03a95":"ds.rename(columns={'Unnamed: 0':'State'},inplace=True)\nds.head()","8c037252":"from sklearn.preprocessing import StandardScaler","9888ca93":"X = ds[['Murder','Assault','UrbanPop','Rape']]\nscaler = StandardScaler()\nX_scaled = scaler.fit_transform( X )\nprint (X_scaled[:5,:])","bd23997d":"distortions = []\nK = range(1,10)\nfor k in K:\n    kmeanModel = KMeans(n_clusters=k)\n    kmeanModel.fit(X_scaled)\n    distortions.append(kmeanModel.inertia_)","f9fc9095":"plt.figure(figsize=(16,8))\nplt.plot(K, distortions, 'bx-')\nplt.xlabel('K - Clusters')\nplt.ylabel('Distortion')\nplt.title('The Elbow Method showing distortion against K Clusters')\nplt.show()","acd9ecb9":"kmeanModel = KMeans(n_clusters=4)\nkmeanModel.fit(X_scaled)","4dce2947":"ds['Cluster_ID']=kmeanModel.labels_\nds['Cluster_ID']=ds['Cluster_ID'].astype('str')\nds.head()","adf6d3d8":"us_state_abbrev = {\n    'Alabama': 'AL',\n    'Alaska': 'AK',\n    'American Samoa': 'AS',\n    'Arizona': 'AZ',\n    'Arkansas': 'AR',\n    'California': 'CA',\n    'Colorado': 'CO',\n    'Connecticut': 'CT',\n    'Delaware': 'DE',\n    'District of Columbia': 'DC',\n    'Florida': 'FL',\n    'Georgia': 'GA',\n    'Guam': 'GU',\n    'Hawaii': 'HI',\n    'Idaho': 'ID',\n    'Illinois': 'IL',\n    'Indiana': 'IN',\n    'Iowa': 'IA',\n    'Kansas': 'KS',\n    'Kentucky': 'KY',\n    'Louisiana': 'LA',\n    'Maine': 'ME',\n    'Maryland': 'MD',\n    'Massachusetts': 'MA',\n    'Michigan': 'MI',\n    'Minnesota': 'MN',\n    'Mississippi': 'MS',\n    'Missouri': 'MO',\n    'Montana': 'MT',\n    'Nebraska': 'NE',\n    'Nevada': 'NV',\n    'New Hampshire': 'NH',\n    'New Jersey': 'NJ',\n    'New Mexico': 'NM',\n    'New York': 'NY',\n    'North Carolina': 'NC',\n    'North Dakota': 'ND',\n    'Northern Mariana Islands':'MP',\n    'Ohio': 'OH',\n    'Oklahoma': 'OK',\n    'Oregon': 'OR',\n    'Pennsylvania': 'PA',\n    'Puerto Rico': 'PR',\n    'Rhode Island': 'RI',\n    'South Carolina': 'SC',\n    'South Dakota': 'SD',\n    'Tennessee': 'TN',\n    'Texas': 'TX',\n    'Utah': 'UT',\n    'Vermont': 'VT',\n    'Virgin Islands': 'VI',\n    'Virginia': 'VA',\n    'Washington': 'WA',\n    'West Virginia': 'WV',\n    'Wisconsin': 'WI',\n    'Wyoming': 'WY'\n}\nds['State_Short']=ds['State'].replace(us_state_abbrev)","32a849d8":"import plotly.express as px  # Be sure to import express\nfig = px.choropleth(ds,  # Input Pandas DataFrame\n                    locations='State_Short',  # DataFrame column with locations\n                    color=\"Cluster_ID\",  # DataFrame column with color values\n                    hover_name=\"State\", # DataFrame column hover info\n                    locationmode = 'USA-states') # Set to plot as US States\nfig.update_layout(\n    title_text = 'US States Crime Arrest Grouping', # Create a Title\n    geo_scope='usa',  # Plot only the USA instead of globe\n)\nprint(fig.show())","2bf10b57":"I will use the USArrest dataset for it.\nThis dataset contains 50 observations with having 5 variables.\n\n1. State\n2. Murder \t ->  Murder arrests (per 100,000)\n3. Assault   ->  Assault arrests (per 100,000)\n4. UrbanPop  ->  Percent urban population\n5. Rape Rape ->  Rape arrests (per 100,000) \n\nWe want to Identify  the states having similar type of crimes. But right now we dont know how many related states or clusters present in dataset. We will identify this **optimal cluster** number by using **Elbow Chart**. I will explain that chart below.","0ceba9c2":"We will add these clusters to our main data set","5ce1eaa1":"Now its time to see which states are identified as similar by our algorithm based on our data set related to crime arrest.\nIn-order to plot the US States we need US states short codes. I am using below dictionary for this.","11fcb7f1":"> Import Data Set","24a7b0b8":"Now we will calculate variance in KMeans clusters by using different number of clusters from 1 to 10. After that we will plot these variances in chart and see where we have lower varaince as compared to number of clusters. The optimal point is the one where variance line become almost straight i.e. by increasing number of clusters there is less impact on variance. That optimal point is called **'elbow'**, thatswhy the name of the chart is elbow chart.","02750ff9":"In above map we can see that majority of closely located states have similar types of crimes in our dataset. \nWhat do you think?  ","273c3f05":"In unsupervised machine learning category, clustering plays an important for part for any business. There are different clustering algorithms available like **KMEANS, DBSCAN, BIRCH,Affinity Propagation** etc. This clustering algorithm list is long but in industry KMEANS is mostly used due to its simplicity. The problem we face in KMEANS is that we need to pass the numbers cluster by ourself. In this tutorial we will see how to identify the **optimal number of clusters** for KMeans. \nSo lets start","716d6c3b":"We can observe that the **\u201celbow\u201d** is the number **4** which is optimal for this case. Now we can run a K-Means using as n_clusters the number 4","be57a9fa":"Plotting the distortions of K-Means","46821b6d":"As columns (Murder, Assault, UrbanPop, Rape) have different range of scale in values, first we need to scale our dataset. ","2abaee72":"> Import Libraries","dbd7e636":"Running K-Means with a range of k","4b31ae50":"> Columns renaming for better understanding"}}