{"cell_type":{"ae64bc99":"code","2bfc3fa7":"code","396dba5a":"code","cb8fd6ca":"code","f704e380":"code","39fa1faa":"markdown"},"source":{"ae64bc99":"from fastai.tabular.all import *","2bfc3fa7":"train_df = pd.read_csv('..\/input\/optiver-train-with-features\/train_with_features.csv')\ntrain_df = train_df.drop(['time_id', 'row_id'], axis=1).fillna(0)\ntrain_df.stock_id = train_df.stock_id.astype('category')","396dba5a":"cont_nn,cat_nn = cont_cat_split(train_df,  dep_var='target')\ndls = TabularPandas(train_df, [Categorify, Normalize], cat_nn, cont_nn, splits = RandomSplitter()(train_df), y_names='target').dataloaders(1024)","cb8fd6ca":"def rmspe(preds, targs):\n    x = (targs-preds)\/targs\n    return (x**2).mean().sqrt()","f704e380":"learn = tabular_learner(dls, y_range=(0,.1), layers=[1000,500,200], n_out=1, loss_func = rmspe, metrics=AccumMetric(rmspe))\nlearn.fit_one_cycle(70, 5e-3)","39fa1faa":"## Training an MLP model with the fastai TabularLearner.\nInference code is shown here: https:\/\/www.kaggle.com\/slawekbiel\/short-fast-nn-lgb"}}