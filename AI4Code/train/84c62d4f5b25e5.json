{"cell_type":{"a2dd63bc":"code","0b490d4c":"code","f11ea366":"code","4cd9b044":"code","13640342":"code","d3d3e1cd":"code","50bfe1b2":"code","07cf409d":"code","d8acb7fe":"code","c020db37":"code","cc0fb8d3":"code","429dcc3f":"code","437022eb":"code","8dd3a619":"code","8fa3dfee":"code","8b4709c6":"code","79fa7cd3":"code","e422be1d":"code","f141007f":"code","4ebe1cac":"code","06652d24":"code","9994eab8":"code","9eb46fca":"code","b8194818":"code","6639ad23":"code","ee6197e7":"code","ec3c2aa2":"code","02ea3b81":"code","87d82b27":"code","7fcf71ff":"code","e39eddae":"code","2f1e7eca":"code","3320deed":"code","481954bb":"code","f3705f00":"code","1169f69b":"code","f0398a3b":"code","d4aa86f6":"code","325209ca":"code","cd5a60a8":"code","51bcb5f1":"code","60b39b9a":"code","17df9f57":"code","1cfc2e4f":"markdown","3a63a1e4":"markdown","e109bba8":"markdown","bba86668":"markdown","d10bf11c":"markdown","f2ba74af":"markdown","a0ddfc87":"markdown","70ef468f":"markdown","5bb1d7cc":"markdown","7e8650a9":"markdown","8ce7f328":"markdown","b108c040":"markdown","a441625a":"markdown","f6f56032":"markdown","dc55373d":"markdown","ae16a5dd":"markdown","d9131c3c":"markdown","fabec422":"markdown","cce0960e":"markdown","209c2824":"markdown","6d987866":"markdown","506c8267":"markdown","5c55cf93":"markdown","739ba32d":"markdown","60a4266a":"markdown","da158ce8":"markdown","9e429a14":"markdown","ea123482":"markdown","29a2a542":"markdown","6a6dcc09":"markdown","550c6051":"markdown","ae8534d9":"markdown","0b198a96":"markdown","5a96a960":"markdown","1b3701de":"markdown","409dfc0e":"markdown","2c74c5e6":"markdown","ac4a9512":"markdown","d23f8c99":"markdown","ce154a24":"markdown","a27b57cf":"markdown","950d5d59":"markdown","6999d9b8":"markdown","cc403174":"markdown","b18ae79d":"markdown"},"source":{"a2dd63bc":"#Comment this cell and restart the session after running it\n\"\"\"!pip install --upgrade plotly\n!pip install --upgrade geopandas\n!pip install --upgrade pyshp\n!pip install --upgrade shapely\"\"\"","0b490d4c":"#Import Essential Libraries\n!pip3 install geopandas==0.3.0\n!pip3 install pyshp==1.2.10\n!pip3 install shapely==1.6.3\n!pip install plotly-geo\n\nimport numpy as np\nfrom numpy import *\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport plotly.figure_factory as ff","f11ea366":"#Cleaning routine for files from USDA Economic Research Service\ndef cleanGovData(file, index):\n    data = pd.read_csv(file)\n    data.columns = data.iloc[index]\n    data = data.drop([i for i in range(index + 1)], axis = 0)\n    data.index -= index + 1\n    data = data.rename(columns = {\"FIPStxt\" : \"FIPS\"})\n    data[\"FIPS\"] = list(map(int, data[\"FIPS\"]))\n    return data\n\n\n#Creates a chloropleth map on a USA counties map template from any list\ndef plotMap(inputList):\n    endPoints = list(np.percentile(inputList, [5 + (5 * i) for i in range(19)])) #5% intervals for range of numbers and colors\n    i = 0\n    while i < len(endPoints):\n        if endPoints.count(endPoints[i]) > 1 or endPoints[i] == min(inputList) or endPoints[i] == max(inputList):\n            del endPoints[i] #removes any repeating intervals or minimum\/maximum for well balanced intervals\n        else:\n            i += 1\n            \n    colorScale, numColors = [], len(endPoints) + 1\n    for i in range(numColors): #Creates as many colors between light blue and dark blue as needed (based on intervals)\n        colorScale.append(\"rgb(\" + str(247 - ((239 \/ (numColors - 1)) * i)) + \", \" + str(251 - ((203 \/ (numColors - 1)) * i)) + \", \" + str(255 - ((148 \/ (numColors - 1)) * i)) + \")\")\n        \n    fig = ff.create_choropleth(fips = fipsList, values = inputList, colorscale = colorScale, binning_endpoints = endPoints)\n    fig.layout.template = None \n    fig.show(rendering = \"kaggle\") #creates chloropeth map using the list, color scale, intervals, and fips values\n    \n\n    \n#Generates a linear regression line for any two lists\ndef regLine(xList, yList):\n    coeff = np.polyfit(xList, yList, 1)\n    return [((coeff[0] * xList[i]) + coeff[1]) for i in range(len(xList))]\n\n\n#Returns the correlation coefficient for any two lists\ndef coeff(xList, yList):\n    return np.corrcoef(xList, yList)[0][1]\n\n\n#Removes Manhattan and counties with negligible cases\/deaths\ndef reduce(inputList):\n    outputList = []\n    for i in range(len(confirmedList)):\n        if confirmedList[i] > 10 and deathList[i] > 5 and i != 1750:\n            outputList.append(inputList[i])\n    return outputList\n\n\n#Min-Max normalizes\/scales any list\ndef normalize(inputList):\n    return ((np.array(inputList) - min(inputList)) \/ (max(inputList) - min(inputList)))","4cd9b044":"#Retrieving and cleaning general case info from Johns Hopkins data\ncovidData = pd.read_csv(\"\/kaggle\/input\/06-07-2020.csv\")\ncovidData = covidData.rename(columns = {\"Admin2\" : \"County\"})\ncovidData[\"FIPS\"].fillna(999999999999, inplace = True)\ncovidData[\"FIPS\"] = list(map(int, covidData[\"FIPS\"]))\n\ncovidData.head()","13640342":"#Retrieves and cleans files from USDA data\nunemployData = cleanGovData(\"\/kaggle\/input\/Unemployment.csv\", 6)\npovertyData = cleanGovData(\"\/kaggle\/input\/Poverty.csv\", 3)\npopulationData = cleanGovData(\"\/kaggle\/input\/Population.csv\", 1)\neducationData = cleanGovData(\"\/kaggle\/input\/Education.csv\", 3)\n\nunemployData.head()","d3d3e1cd":"#Retrieves racial\/demographic data (already been cleaned from original census data)\nracialData = pd.read_csv(\"\/kaggle\/input\/racialData.csv\")\n\nracialData.head()","50bfe1b2":"#List of all 2959 FIPS values to be used (already found using set intersection)\nfipsList = list(racialData[\"FIPS\"])\n\n#All lists to be created from data sources\ncountyList, stateList, confirmedList, deathList, mortalityList = [], [], [], [], []\nwhiteAlone, blackAlone, nativeAlone, asianAlone, hispanic = [], [], [], [], []\nmedianList, unemployList, povallList, popList = [], [], [], []\nlessHigh, onlyHigh, someCollege, bachelorAbove = [], [], [], []\nconfirmPopList, deathPopList = [], []","07cf409d":"#Loops through all FIPS values\nfor fips in fipsList:\n    \n    #Finds rows from each data frame with current FIPS value\n    covidRow = covidData.loc[covidData[\"FIPS\"] == fips]\n    unemployRow = unemployData.loc[unemployData[\"FIPS\"] == fips]\n    povertyRow = povertyData.loc[povertyData[\"FIPS\"] == fips]\n    populationRow = populationData.loc[populationData[\"FIPS\"] == fips]\n    educationRow = educationData.loc[educationData[\"FIPS\"] == fips]\n    racialRow = racialData.loc[racialData[\"FIPS\"] == fips]\n\n    #Case info from Johns Hopkins data\n    countyList.append(list(covidRow[\"County\"])[0]) #list of county names\n    stateList.append(list(covidRow[\"Province_State\"])[0]) #list of corresponding state names\n    if list(covidRow[\"Confirmed\"])[0] == 0:\n        mortalityList.append(0) #adds 0 to mortality list if there are zero cases\n    else:\n        mortalityList.append(list((covidRow[\"Deaths\"] \/ covidRow[\"Confirmed\"]) * 100)[0]) #deaths\/confirmed = mortality\n    confirmedList.append(int(list(covidRow[\"Confirmed\"])[0])) #number of total confirmed cases as of 06\/07\/2020\n    deathList.append(int(list(covidRow[\"Deaths\"])[0])) #number of total deaths as of 06\/07\/2020\n\n\n    #Confirmed Cases and Deaths per 100,000 people\n    confirmPopList.append(list(covidRow[\"Confirmed\"])[0] \/ float(list(populationRow[\"POP_ESTIMATE_2018\"])[0].replace(\",\", \"\")) * 100000)\n    deathPopList.append(list(covidRow[\"Deaths\"])[0] \/ float(list(populationRow[\"POP_ESTIMATE_2018\"])[0].replace(\",\", \"\")) * 100000)\n\n    #Economic information - median household income and unemployment rate\n    medianList.append(int(list(unemployRow[\"Median_Household_Income_2018\"])[0].replace(\",\", \"\")))\n    unemployList.append(float(list(unemployRow[\"Unemployment_rate_2018\"])[0]))\n\n    #Poverty information - percent of total population living under poverty line\n    povallList.append(float(list(povertyRow[\"PCTPOVALL_2018\"])[0]))\n    \n    #Total Population 2018\n    popList.append(int(list(populationRow[\"POP_ESTIMATE_2018\"])[0].replace(\",\", \"\")))\n    \n    #Educational information (percent of adults)\n    lessHigh.append(float(list(educationRow[\"Percent of adults with less than a high school diploma, 2014-18\"])[0]))\n    onlyHigh.append(float(list(educationRow[\"Percent of adults with a high school diploma only, 2014-18\"])[0]))\n    someCollege.append(float(list(educationRow[\"Percent of adults completing some college or associate's degree, 2014-18\"])[0]))\n    bachelorAbove.append(float(list(educationRow[\"Percent of adults with a bachelor's degree or higher, 2014-18\"])[0]))\n\n    #Racial data (percent of total population)\n    whiteAlone.append(float(racialRow[\"White Alone\"]))\n    blackAlone.append(float(racialRow[\"Black Alone\"]))\n    nativeAlone.append(float(racialRow[\"Native Alone\"]))\n    asianAlone.append(float(racialRow[\"Asian Alone\"]))\n    hispanic.append(float(racialRow[\"Hispanic\"]))","d8acb7fe":"#Creates a new data frame from all of the lists\ncleanData = pd.DataFrame({\n                          \"State\" : stateList, \"FIPS\" : fipsList, \"County\" : countyList,\n                          \"Population 2018\" : popList, \"Median Household Income 2018 ($)\" : medianList,\n                          \"Unemployment Rate 2018 (%)\" : unemployList, \"Poverty 2018 (%)\" : povallList,\n                          \"Confirmed Cases\" : confirmedList, \"Confirmed Deaths\" : deathList,\n                          \"Confirmed Cases Per 100,000 people\" : confirmPopList,\n                          \"Deaths Per 100,000 people\" : deathPopList, \"Mortality Rate (%)\" : mortalityList,\n                          \"White Alone (%)\" : whiteAlone, \"Black Alone (%)\" : blackAlone,\n                          \"Native American Alone (%)\" : nativeAlone, \"Asian Alone (%)\" : asianAlone,\n                          \"Hispanic (%)\" : hispanic, \"Less than a High School Diploma (%)\" : lessHigh,\n                          \"Only a High School Diploma (%)\" : onlyHigh, \"Some College\/Associate's Degree (%)\" : someCollege,\n                          \"Bachelor's Degree or Higher (%)\" : bachelorAbove\n                        })\n\ncleanData.head(10)","c020db37":"#YOU CAN SCROLL TO SEE THE REST OF THE MAP!\n#Plotting COVID-19 mortality rate by county\nplotMap(mortalityList)","cc0fb8d3":"#Plotting confirmed cases per 100,000 people by county\nplotMap(confirmPopList)","429dcc3f":"#Plotting the confirmed cases per 100,000 people against the mortality rate\nplt.rcParams[\"figure.figsize\"] = (12, 8)\n\nplt.xlabel(\"Confirmed Cases per 100,000 people\")\nplt.ylabel(\"Mortality Rate (%)\")\nplt.scatter(confirmPopList, mortalityList, 1)\nplt.plot(confirmPopList, regLine(confirmPopList, mortalityList))\nplt.show()\n\nprint(\"Correlation coefficient: \" + str(coeff(confirmPopList, mortalityList)))","437022eb":"#Plotting deaths per 100,000 people by county\nplotMap(deathPopList)","8dd3a619":"#Plotting the poverty rate by county\nplotMap(povallList)","8fa3dfee":"#Plotting poverty rate against the deaths per 100,000 people\nplt.rcParams[\"figure.figsize\"] = (16, 8)\n\nplt.subplot(1, 2, 1)\nplt.xlabel(\"Poverty Rate (%)\")\nplt.ylabel(\"Deaths per 100,000 people\")\nplt.scatter(povallList, deathPopList)\nplt.plot(povallList, regLine(povallList, deathPopList))\n\nplt.subplot(1, 2, 2)\nplt.xlabel(\"Poverty Rate (%)\")\nplt.ylabel(\"Deaths per 100,000 people\")\ntempPov, tempDeaths = povallList[0 : 1750] + povallList[1751:], deathPopList[0 : 1750] + deathPopList[1751:]\nplt.scatter(tempPov, tempDeaths)\nplt.plot(tempPov, regLine(tempPov, tempDeaths))\n\nplt.show()\n\nprint(\"Correlation coefficient with Manhattan: \" + str(coeff(povallList, deathPopList)))\nprint(\"Correlation coefficient without Manhattan: \" + str(coeff(tempPov, tempDeaths)))","8b4709c6":"#Removing negligible counties\nplt.rcParams[\"figure.figsize\"] = (8, 8)\n\nx, y = reduce(povallList), reduce(deathPopList)\nplt.xlabel(\"Poverty Rate (%)\")\nplt.ylabel(\"Deaths per 100,000 people\")\nplt.scatter(x, y)\nplt.plot(x, regLine(x, y))\n\nprint(\"Correlation coefficient without Manhattan and negligible counties: \" + str(coeff(x, y)) + \"\\n\")\nprint(\"Number of counties in reduced list: \" + str(len(x)) + \" (\" + str(len(x) \/ 2959 * 100) + \"% of all 2959 counties)\")\nprint(\"% of total confirmed cases that reduced list is: \" + str(sum(reduce(confirmedList)) \/ sum(confirmedList) * 100))\nprint(\"% of total population that reduced list is: \" + str(sum(reduce(popList)) \/ sum(popList) * 100))","79fa7cd3":"#Plotting the unemployment rate by county\nplotMap(unemployList)","e422be1d":"#Plotting unemployment rate against deaths per 100,000 people\nplt.rcParams[\"figure.figsize\"] = (8, 8)\n\nx, y = reduce(unemployList), reduce(deathPopList)\nplt.xlabel(\"Unemployment Rate (%)\")\nplt.ylabel(\"Deaths per 100,000 people\")\nplt.scatter(x, y)\nplt.plot(x, regLine(x, y))\nplt.show()\n\nprint(\"Correlation coefficient: \" + str(coeff(x, y)))","f141007f":"#Plotting the median household income by county\nplotMap(medianList)","4ebe1cac":"#Plotting median household income against deaths per 100,000 people\nplt.rcParams[\"figure.figsize\"] = (8, 8)\n\nx, y = reduce(medianList), reduce(deathPopList)\nplt.xlabel(\"Median Household Income ($)\")\nplt.ylabel(\"Deaths per 100,000 people\")\nplt.scatter(x, y)\nplt.plot(x, regLine(x, y))\nplt.show()\n\nprint(\"Correlation coefficient: \" + str(coeff(x, y)))","06652d24":"#Plotting white alone % by county\nplotMap(whiteAlone)","9994eab8":"#Plotting white alone % against deaths per 100,000 people\nplt.rcParams[\"figure.figsize\"] = (8, 8)\n\nx, y = reduce(whiteAlone), reduce(deathPopList)\nplt.xlabel(\"White Alone (%)\")\nplt.ylabel(\"Deaths per 100,000 people\")\nplt.scatter(x, y)\nplt.plot(x, regLine(x, y))\nplt.show()\n\nprint(\"Correlation coefficient: \" + str(coeff(x, y)))","9eb46fca":"#Plotting black alone % by county\nplotMap(blackAlone)","b8194818":"#Plotting black alone % against deaths per 100,000 people\nplt.rcParams[\"figure.figsize\"] = (8, 8)\n\nx, y = reduce(blackAlone), reduce(deathPopList)\nplt.xlabel(\"Black Alone (%)\")\nplt.ylabel(\"Deaths per 100,000 people\")\nplt.scatter(x, y)\nplt.plot(x, regLine(x, y))\nplt.show()\n\nprint(\"Correlation coefficient: \" + str(coeff(x, y)))","6639ad23":"#Plotting hispanic % by county\nplotMap(hispanic)","ee6197e7":"#Plotting hispanic % against deaths per 100,000 people\nplt.rcParams[\"figure.figsize\"] = (8, 8)\n\nx, y = reduce(hispanic), reduce(deathPopList)\nplt.xlabel(\"Hispanic (%)\")\nplt.ylabel(\"Deaths per 100,000 people\")\nplt.scatter(x, y)\nplt.plot(x, regLine(x, y))\nplt.show()\n\nprint(\"Correlation coefficient: \" + str(coeff(x, y)))","ec3c2aa2":"#Plotting asian alone % by county\nplotMap(asianAlone)","02ea3b81":"#Plotting asian alone % against deaths per 100,000 people\nplt.rcParams[\"figure.figsize\"] = (8, 8)\n\nx, y = reduce(asianAlone), reduce(deathPopList)\nplt.xlabel(\"Asian Alone (%)\")\nplt.ylabel(\"Deaths per 100,000 people\")\nplt.scatter(x, y)\nplt.plot(x, regLine(x, y))\nplt.show()\n\nprint(\"Correlation coefficient: \" + str(coeff(x, y)))","87d82b27":"#Plotting Native American alone % by county\nplotMap(nativeAlone)","7fcf71ff":"#Plotting Native American alone % against deaths per 100,000 people\nplt.rcParams[\"figure.figsize\"] = (8, 8)\n\nx, y = reduce(nativeAlone), reduce(deathPopList)\nplt.xlabel(\"Native American Alone (%)\")\nplt.ylabel(\"Deaths per 100,000 people\")\nplt.scatter(x, y)\nplt.plot(x, regLine(x, y))\nplt.show()\n\nprint(\"Correlation coefficient: \" + str(coeff(x, y)))","e39eddae":"#Plotting less than a high school diploma % by county\nplotMap(lessHigh)","2f1e7eca":"#Plotting less than a high school diploma % against deaths per 100,000 people\nplt.rcParams[\"figure.figsize\"] = (8, 8)\n\nx, y = reduce(lessHigh), reduce(deathPopList)\nplt.xlabel(\"Adults with less than a high school diploma (%)\")\nplt.ylabel(\"Deaths per 100,000 people\")\nplt.scatter(x, y)\nplt.plot(x, regLine(x, y))\nplt.show()\n\nprint(\"Correlation coefficient: \" + str(coeff(x, y)))","3320deed":"#Plotting only a high school diploma % by county\nplotMap(onlyHigh)","481954bb":"#Plotting only a high school diploma % against deaths per 100,000 people\nplt.rcParams[\"figure.figsize\"] = (8, 8)\n\nx, y = reduce(onlyHigh), reduce(deathPopList)\nplt.xlabel(\"Adults with a high school diploma only (%)\")\nplt.ylabel(\"Deaths per 100,000 people\")\nplt.scatter(x, y)\nplt.plot(x, regLine(x, y))\nplt.show()\n\nprint(\"Correlation coefficient: \" + str(coeff(x, y)))","f3705f00":"#Plotting some college\/associate's degree % by county\nplotMap(someCollege)","1169f69b":"#Plotting some college\/associate's degree % against deaths per 100,000 people\nplt.rcParams[\"figure.figsize\"] = (8, 8)\n\nx, y = reduce(someCollege), reduce(deathPopList)\nplt.xlabel(\"Adults with some college\/associate's degree (%)\")\nplt.ylabel(\"Deaths per 100,000 people\")\nplt.scatter(x, y)\nplt.plot(x, regLine(x, y))\nplt.show()\n\nprint(\"Correlation coefficient: \" + str(coeff(x, y)))","f0398a3b":"#Plotting bachelor's degree or higher % by county\nplotMap(bachelorAbove)","d4aa86f6":"#Plotting bachelor's degree or higher % against deaths per 100,000 people\nplt.rcParams[\"figure.figsize\"] = (8, 8)\n\nx, y = reduce(bachelorAbove), reduce(deathPopList)\nplt.xlabel(\"Adults with a bachelor's degree or higher (%)\")\nplt.ylabel(\"Deaths per 100,000 people\")\nplt.scatter(x, y)\nplt.plot(x, regLine(x, y))\nplt.show()\n\nprint(\"Correlation coefficient: \" + str(coeff(x, y)))","325209ca":"#Plotting relationships between economic factors\nplt.rcParams[\"figure.figsize\"] = (18, 8)\n\nplt.subplot(1, 3, 1)\nplt.xlabel(\"Median Household Income ($)\")\nplt.ylabel(\"Poverty Rate (%)\")\nplt.scatter(medianList, povallList)\n\nplt.subplot(1, 3, 2)\nplt.xlabel(\"Median Household Income ($)\")\nplt.ylabel(\"Unemployment Rate (%)\")\nplt.scatter(medianList, unemployList)\n\nplt.subplot(1, 3, 3)\nplt.xlabel(\"Poverty Rate (%)\")\nplt.ylabel(\"Unemployment Rate (%)\")\nplt.scatter(povallList, unemployList)\n\nplt.show()","cd5a60a8":"#Plotting relationships between demographic factors (only significant correlations plotted)\nplt.rcParams[\"figure.figsize\"] = (18, 8)\n\nplt.subplot(1, 3, 1)\nplt.xlabel(\"White Alone (%)\")\nplt.ylabel(\"Black Alone (%)\")\nplt.scatter(whiteAlone, blackAlone)\n\nplt.subplot(1, 3, 2)\nplt.xlabel(\"White Alone (%)\")\nplt.ylabel(\"Asian Alone (%)\")\nplt.scatter(whiteAlone, asianAlone)\n\nplt.subplot(1, 3, 3)\nplt.xlabel(\"White Alone (%)\")\nplt.ylabel(\"Native Alone (%)\")\nplt.scatter(whiteAlone, nativeAlone)\n\nplt.show()","51bcb5f1":"#Plotting relationships between educational factors (only significant correlations plotted)\nplt.rcParams[\"figure.figsize\"] = (18, 8)\n\nplt.subplot(1, 3, 1)\nplt.xlabel(\"Adults with less than a high school diploma (%)\")\nplt.ylabel(\"Adults with some college\/associate's degree (%)\")\nplt.scatter(lessHigh, someCollege)\n\nplt.subplot(1, 3, 2)\nplt.xlabel(\"Adults with less than a high school diploma (%)\")\nplt.ylabel(\"Adults with bachelor's degrees or higher (%)\")\nplt.scatter(lessHigh, bachelorAbove)\n\nplt.subplot(1, 3, 3)\nplt.xlabel(\"Adults with a high school diploma only (%)\")\nplt.ylabel(\"Adults with bachelor's degrees or higher (%)\")\nplt.scatter(onlyHigh, bachelorAbove)\n\nplt.show()","60b39b9a":"#Plotting other relationships (only significant ones plotted)\n\nplt.rcParams[\"figure.figsize\"] = (18, 28)\n\nplt.subplot(4, 3, 1)\nplt.xlabel(\"Poverty Rate (%)\")\nplt.ylabel(\"White Alone (%)\")\nplt.scatter(povallList, whiteAlone)\n\nplt.subplot(4, 3, 2)\nplt.xlabel(\"Poverty Rate (%)\")\nplt.ylabel(\"Black Alone (%)\")\nplt.scatter(povallList, blackAlone)\n\nplt.subplot(4, 3, 3)\nplt.xlabel(\"Poverty Rate (%)\")\nplt.ylabel(\"Adults with less than a high school diploma (%)\")\nplt.scatter(povallList, lessHigh)\n\nplt.subplot(4, 3, 4)\nplt.xlabel(\"Poverty Rate (%)\")\nplt.ylabel(\"Adults with bachelor's degrees or higher (%)\")\nplt.scatter(povallList, bachelorAbove)\n\nplt.subplot(4, 3, 5)\nplt.xlabel(\"Median Household Income ($)\")\nplt.ylabel(\"Asian Alone (%)\")\nplt.scatter(medianList, asianAlone)\n\nplt.subplot(4, 3, 6)\nplt.xlabel(\"Median Household Income ($)\")\nplt.ylabel(\"Adults with less than a high school diploma (%)\")\nplt.scatter(medianList, lessHigh)\n\nplt.subplot(4, 3, 7)\nplt.xlabel(\"Median Household Income ($)\")\nplt.ylabel(\"Adults with a high school diploma only (%)\")\nplt.scatter(medianList, onlyHigh)\n\nplt.subplot(4, 3, 8)\nplt.xlabel(\"Median Household Income ($)\")\nplt.ylabel(\"Adults with bachelor's degrees or higher (%)\")\nplt.scatter(medianList, bachelorAbove)\n\nplt.subplot(4, 3, 9)\nplt.xlabel(\"Unemployment Rate (%)\")\nplt.ylabel(\"Adults with less than a high school diploma (%)\")\nplt.scatter(unemployList, lessHigh)\n\nplt.subplot(4, 3, 10)\nplt.xlabel(\"Asian Alone (%)\")\nplt.ylabel(\"Adults with a high school diploma only (%)\")\nplt.scatter(asianAlone, onlyHigh)\n\nplt.subplot(4, 3, 11)\nplt.xlabel(\"Asian Alone (%)\")\nplt.ylabel(\"Adults with bachelor's degrees or higher (%)\")\nplt.scatter(asianAlone, bachelorAbove)\n\nplt.subplot(4, 3, 12)\nplt.xlabel(\"Hispanic (%)\")\nplt.ylabel(\"Adults with less than a high school diploma (%)\")\nplt.scatter(hispanic, lessHigh)\n\nplt.show()","17df9f57":"#Plotting combined index against deaths per 100,000 people\nplt.rcParams[\"figure.figsize\"] = (16, 8)\n\nallLists = [povallList, unemployList, medianList, whiteAlone, blackAlone, hispanic, asianAlone, nativeAlone, lessHigh, onlyHigh, someCollege, bachelorAbove]\nallCoeff = []\n\n\n#Reduced lists against deaths per 100,000 people\ny = reduce(deathPopList)\nfor i in range(len(allLists)):\n    allCoeff.append(coeff(normalize(reduce(allLists[i])), y))\n\ncombinedIndex = np.array([0 for i in range(len(y))])\nfor i in range(len(allLists)):\n    combinedIndex = combinedIndex + (allCoeff[i] * normalize(reduce(allLists[i])))\n\nplt.subplot(1, 2, 1)\nplt.xlabel(\"Combined Socio-Economic Index\")\nplt.ylabel(\"COVID-19 Deaths per 100,000 people\")\nplt.title(\"Correlation coefficient for reduced lists: \" + str(coeff(combinedIndex, y)))\nplt.scatter(combinedIndex, y)\nplt.plot(combinedIndex, regLine(combinedIndex, y))\n\n\n#All 2959 counties combined index against natural log of number of deaths per 100,000 people\ny = ma.log(deathPopList)\nallCoeff.clear()\nfor i in range(len(allLists)):\n    allCoeff.append(coeff(normalize(allLists[i]), y))\n\ncombinedIndex = np.array([0 for i in range(len(y))])\nfor i in range(len(allLists)):\n    combinedIndex = combinedIndex + (allCoeff[i] * normalize(allLists[i]))\n\nplt.subplot(1, 2, 2)\nplt.xlabel(\"Combined Socio-Economic Index\")\nplt.ylabel(\"Natural Log of COVID-19 Deaths per 100,000 people\")\nplt.title(\"Correlation coefficient for all lists: \" + str(coeff(combinedIndex, y)))\nplt.scatter(combinedIndex, y)\nplt.plot(combinedIndex, regLine(combinedIndex, y))\n\n\nplt.show()","1cfc2e4f":"As can be seen from the map above, counties with higher proportions of adults with bachelor's degrees or higher are mostly located in metropolitan areas\/cities such as Houston, Atlanta, the Bay area, the Tri-State area, etc. Although these places do have higher population densities, they also tend to be wealthier in general.","3a63a1e4":"### F. Final Analysis\nThis combines all the factors above and correlates it with the deaths per 100,000 people to give the big picture.\n\nTo do this, I will min-max normalize all of the input lists on a scale of 0 to 1. Then I will multiply each value in the lists by their respective correlation coefficients which will weight them by importance. Finally, I will add all of the lists together to create a combined socio-economic index.","e109bba8":"### E. Other Correlations\nThis analysis finds correlations between several different variables that are not all related to the pandemic.\nI will not be using the reduced lists for this as I won't be plotting any case information.","bba86668":"Although the correlation coefficient is positive like we expected it to be, it is very weak and could possibly be influeced by the outliers in the confirmPopList. Nevertheless, there does seem to be a very weak positive correlation between the two variables.\n\n#### What next?\nEven though the map of the mortality rate does have some geographic patterns, it is a little bit more scattered than I expected and I think that I might have to use another data feature for the rest of the analysis that will give stronger results.","d10bf11c":"Although the mortality map might look rather scattered at a glance, the general pattern shows that there are 4 clusters in the US where the proportion of people that contract COVID-19 who die is unusually high -\n\n1) North-East (specifically the Tri-State area)\n\n2) The South-East (close to the Gulf of Mexico)\n\n3) The Midwest \n\n4) The South-West (stretch from LA to New Mexico & Colorado)\n\nThese regions coincide with the map of the number of confirmed cases per 100,000 people.\n\n#### Why does this make sense?\nA county's healthcare system usually scales in size according to its population. If there are an unusually higher number of confirmed cases per 100,000 people, that also means that the healthcare system for those counties are most likely overwhelmed by COVID-19 patients. This spreads the resources of hospitals and doctors thin, often leading to some patients not getting the care they need, which then leads to a higher proportion of COVID-19 deaths per confirmed cases.","f2ba74af":"As can be seen from the map above, the counties with higher proportions of adults that only have high school diplomas are located mostly in the Midwest and South-Eastern states. This is most likely due to the large manufacturing industries in the Midwest and also recently in the South, which don't require more than a high school education.","a0ddfc87":"As can be seen from the map above, the counties with higher proportions of Native American residents are all mostly located west of the Mississippi river due to the expansionist policies of the US in the 1800s. There are a few counties with very high proportions of Native Americans along the Northern border between Arizona and New Mexico which coincide with high death per capita rates in those counties.","70ef468f":"# Analysis of COVID-19 in the United States\n\nThis notebook uses data from several sources to analyze the relationship between several social, economic, and demographic factors and the role these play in the shaping of the COVID-19 pandemic in the United States.\n\nAuthor: Aditya Ranjan\n\n<a rel=\"license\" href=\"http:\/\/creativecommons.org\/licenses\/by-nc\/4.0\/\"><img alt=\"Creative Commons License\" style=\"border-width:0\" src=\"https:\/\/i.creativecommons.org\/l\/by-nc\/4.0\/88x31.png\" \/><\/a><br \/>This work is licensed under a <a rel=\"license\" href=\"http:\/\/creativecommons.org\/licenses\/by-nc\/4.0\/\">Creative Commons Attribution-NonCommercial 4.0 International License<\/a>.","5bb1d7cc":"As can be seen from the map above, the nation's southern states have much higher proportions of African-American residents than the rest of the states and this directly coincides with the maps that show the South having lower median incomes, higher unemployment rates, and higher poverty levels. All of this can be explained by the United States' sad and cruel history of slavery and the oppression of the African-American community.","7e8650a9":"#### Why does this make sense?\nThere is a moderate positive correlation between the combined index for the reduced lists and the number of deaths per 100,000 people. On the right side, I included all counties, but to account for the negligible counties and Manhattan being an extreme outlier, I plotted the combined index for all the counties against the natural log of the number of deaths per 100,000 people (counties with death rates of 0 were masked). As can be seen, after combining all the variables into a comprehensive index, there is a clearly a correlation between all of them and the number of deaths per 100,000 people. Both graphs have a cluster of counties with low death per capita rates and both clusters are situated towards the lower end of the index, proof that counties with higher index values usually have higher death per capita rates.","8ce7f328":"As can be seen from the map above, the Asian community is scattered across the country, but is mostly clustered in large cities and metropolitan areas such as Dallas, Austin, Houston, LA, the Bay Area, Atlanta, and the Tri-State area. These places have higher population densities, but also have higher median incomes and lower poverty levels.","b108c040":"#### Some college\/associate's degree % - Why does this make sense?\nThere is a weak negative correlation between the proportion of adults with some college\/an associate's degree and the number of deaths per 100,000 people. This could be explained by the fact that most of these counties are located in the West where the population density is much lower than other states, thereby exposing less people to the virus. Also, adults with some college\/an associate's degree are usually qualified for higher paying jobs and have better access to healthcare.","a441625a":"Looking at the unemployment map above, there are three geographical regions from the deaths per 100,000 people map that coincide with this one - the South-West, the South-East, and the Midwest (somewhat).\n\nThe South's high poverty rate makes sense that it also has a high unemployment rate; the same goes for the South-West. Being unemployed means that more people go out to look for jobs and are willing to work with anything they can find, often venturing out more than others so that they can put food on the table - exposing them even more to the virus which is especially bad considering this group of people doesn't have access to affordable healthcare.\n\nThe reason I said \"somewhat\" for the Midwest is that although some parts of the region have high unemployment rates due to the shutdown of the industries there (not West Virginia, which is below the Midwestern states), Indiana seems to be faring better than its counterparts, especially when considering its high density of counties with high COVID-19 death rates.","f6f56032":"As can be seen from the map above, there is an overwhelming white majority in all of the Midwest and the Western US. The only region which coincides with the death per 100,000 people map is the Midwest. Overall, I would expect the deaths per 100,000 people to decrease as the percentage of people that identify as White Alone increases since counties in the Appalachians and west of the Mississippi River have very low death rates.","dc55373d":"### A. Libraries\nApart from standard data science libraries such as numpy, pandas, and matplotlib, I use one of plotly's geospatial tools to plot the distribution of a certain characteristic on a United States Counties map. This helps\nvisualize the spatial distribution of a certain factor, which can be correlated with other factors for discovering interesting patterns.","ae16a5dd":"#### Asian Alone % - Why does this make sense?\nThere is a weak negative correlation between the proportion of Asian American residents and the deaths per 100,000 people (possibly skewed by all the lower proportion points). The low value of the coefficient can be explained by the fact that counties with higher proportions of Asian American residents both tend to be larger\/populous cities (more exposure to the virus) and also have higher incomes and lower poverty levels (better healthcare).","d9131c3c":"#### Negligible counties\n72% of the counties only account for about 9% of the confirmed cases and about 22% of the population,  making them negligible in terms of the COVID-19 analysis. That is why I chose to exclude them from most graphs as to show the accurate picture. This problem was fixed by taking the log of the deaths per capita, which placed those counties on an appropriate scale and didn\u2019t skew the regression line or affect the correlation coefficient significantly either.\n\n#### Manhattan is an extreme outlier\nManhattan Borough\/New York County accounts for about 10% of the confirmed cases and 20% of the deaths while only accounting for 0.5% of the total population. This goes to show just how much COVID-19 has devastated the community there. I excluded it from the individual graphs to show a more accurate picture but including it in the final analysis with the natural log of the death per capita rate actually increased the correlation coefficient as it was done on a much more appropriate scale.\n\n#### It\u2019s not just one factor that matters.\nAs can be seen from the final analysis, the combination of all factors weighted according to their correlation coefficient yielded a much stronger correlation than any of the individual analyses. In general, there are two types of counties which are affected negatively more than others - \n\n1. Counties with very high populations and population densities such as those in the Tri-State area and some cities in the Midwest. People in these counties are easily exposed to the virus and transmission occurs much quicker, often leading to overwhelmed hospitals and tired doctors.\n\n2. Counties with high poverty\/unemployment and low median incomes. These counties also tend to have higher proportions of Native Americans and African Americans such as those in the South-East and the reservations in the South-West. This is due to the United States\u2019 history of racial discrimination, slavery, westward expansion, and government negligence. People in these counties often work in menial labor jobs which can\u2019t be done from home, thereby increasing exposure to the virus. In addition, the lack of affordable quality healthcare also means that people don\u2019t get adequate medical attention.\n\n#### More data is always helpful.\nAll the factors used in this analysis are social factors or economic factors and while they explain why counties in the South-East and reservations in the South-West have high COVID-19 death per capita rates, it doesn\u2019t necessarily explain the same for the Midwest or the North-East very well. To backup the claims I made regarding the high population density, I would have to include such data in the analysis, which I intend to continue working on, along with a variety of other factors that could further the analysis for all regions.\n\n#### Sources - \nhttps:\/\/github.com\/CSSEGISandData\/COVID-19\n\nhttps:\/\/www.ers.usda.gov\/data-products\/county-level-data-sets\/download-data\/\n\nhttps:\/\/www.census.gov\/data\/tables\/time-series\/demo\/popest\/2010s-counties-detail.html\n\n#### 06\/02\/2020 Dataset -\nhttps:\/\/www.kaggle.com\/ady123\/us-counties-covid19-dataset","fabec422":"As can be seen from the map above, almost all counties with higher proportions of hispanic residents are in the Western States since they are much closer to Mexico. Although these counties do coincide with the small region in the South-West which has higher death rates, most of these counties are located in places with harsher climates (desert) and have lower population densities.","cce0960e":"\n### E. Extracting Information from the Data Frames\nWith all of the lists created to store individual data points, I can now move on to the main procedure, which is to loop through each FIPS value in the list of 2959 FIPS codes and add information to each list from corresponding data frames.","209c2824":"This map of deaths per 100,000 people shares a lot in common with the mortality map (same 4 geographic regions), but has much clearer geographic clusters, which could also be a result of the color scaling. However, there are not as many scattered counties on this map as on the mortality one and the patterns seem to be much more consistent on a regional basis.\n\nThe deaths per 100,000 people map coincides almost perfectly with the confirmed cases per 100,000 people, but this makes sense because the higher the number of confirmed cases, the higher number of deaths as well.\n\n#### Next Stage\nIn the next steps of the analysis, I will compare non-pandemic factors related to the social and economic backgrounds of the counties with COVID-19 deaths per 100,000 people. I will focus on the same four regions\/clusters -\n\n1) North-East\/Tri-State area\n\n2) South-East\n\n3) South-West\n\n4) Midwest","6d987866":"#### Important Note - Why remove Manhatthan Borough\/New York County?\nAs can be seen in the first plot and the difference in correlation coefficients, Manhattan (New York City in the list) is an extreme outlier with a drastically higher number of deaths per 100,000 people, primarily due to its very high population density. \n\nFor this reason, I will not include Manhattan in the other graphs going forward. It will ensure that the data remains more reflective of the country as a whole and will also be useful to show the effect of outliers in the final analysis.\n\n#### Important Note - Why remove so many counties?\nYes. I know it looks like I'm removing 70% of the 2959 counties, but if you take a closer look, you can see why it is being done. Despite being only 28% of the original counties, the 844 counties in the reduced list make up 77% of the total population and 81% of the total confirmed cases! It also increased the correlation coefficient by about 0.18! This means one thing - all those counties with 10 or less cases and 5 or less deaths were skewing the data and manipulating the big picture a lot. They were accounting for a negligible amount of cases and deaths while taking up a lot of data points which skewed the regression line. This is why I will work with the reduced lists going forward (only in graphs, not in maps). If you try this yourself, you can change the reduce function with any numbers you want. 10 and 5 are just numbers that I chose after looking at the percentiles.\n\n#### Poverty - Why does this make sense?\nAs can be seen from the graphs above and the correlation coefficients, there is a weak positive correlation between the poverty level and the deaths per 100,000 people. This could be explained by the fact that people in poorer counties don't have access to the best healthcare and in addition to this, they often have to go out for their jobs and don't have the comfort of working at home, exposing them to the virus more than usual.\n\nThe patterns are already looking stronger and I will continue this same process for the rest of the factors, combining all of them in the final analysis.","506c8267":"As can be seen from the map above, the counties with higher proportions of adults not completing high school are mainly in the Southern States where poverty and unemployment is higher. These counties also have higher proportions of Hispanic and African American residents.","5c55cf93":"#### White Alone % - Why does this make sense?\nAs I expected, there is a weak negative correlation between the proportion of white residents in a county and the deaths per 100,000 people. This could be explained by the fact that a majority of counties with higher proportions of white residents tend to be either in the Appalachian Mountains or west of the Mississippi river where the population density is very low and therefore, the number of people infected would be lower as well. In addition, due to the US' history as a nation divided along race lines, counties with higher proportions of white residents also tend to be wealthier, having better access to healthcare.","739ba32d":"### A. General Analysis\nThis analysis focuses on general case and death information to determine which factor to focus on.","60a4266a":"#### Only a high school diploma % - Why does this make sense?\nThere is a weak positive correlation between the proportion of adults with a high school diploma only and the number of deaths per 100,000 people. This is also because adults with a high school diploma only tend to work in blue-collar industries, where access to healthcare is scarce and working from home isn't an option. This overlaps with both the Midwest and South-East regions, which both have counties with higher numbers of deaths per capita.","da158ce8":"### C. Racial Disparities\nThis analysis specifically focuses on the racial makeup of a county's population.","9e429a14":"## 1. Data Preparation\nMy first step is to comb through all of the source files, clean them, and then extract the information I want for each of the 2959 counties. Then, I will store all of the combined information in one clean data frame for future use. After all of this is done, I can finally move on to analyzing the data.","ea123482":"## 3. Findings & Conclusion\nHaving plotted the relationships between multiple variable pairs and analyzing geospatial patterns of certain factors, it is time to summarize all of the graphs and maps above into a couple of key paragraphs.","29a2a542":"#### Unemployment - Why does this make sense?\nAs can be seen from the graph above and the correlation coefficient, there is a weak positive correlation between the unemployment rate and the deaths per 100,000 people. This can be explained by the same reason for which counties with high poverty levels have higher death rates as well - poor access to quality healthcare and venturing out for work.\n\nAlthough the graph above appears to be normally distributed, the data points above 50 deaths per 100,000 people are a tiny fraction of the total counties and the regression line is appropriate for a majority of the data points.","6a6dcc09":"#### Native American Alone % - Why does this make sense?\nThere is a weak positive correlation between the proportion of Native American residents and the number of deaths per 100,000 people. This can be explained by the fact that counties with higher proportions of Native Americans, such as the reservation in Arizona & New Mexico, usually have higher poverty and unemployment in addition to most Native Americans having no natural immunity against foreign viruses. The low coefficient value is most likely due to the several low proportion data points which could possibly be skewing the regression line as well.","550c6051":"As can be seen from the map above, the counties with higher proportions of adults with some college\/an associate's degree are mostly located in the Western states. These regions have low populations and population densities as well as lower unemployment and poverty rates.","ae8534d9":"### F. Create a new Data Frame\nAfter storing all the relevant information in the 21 data lists, I can now move on to combining all of the lists into one data frame with clean data for each of the 2959 counties.","0b198a96":"#### Median Household Income - Why does this make sense?\nThere is a weak negative correlation between the median income and deaths per 100,000 people, nearing about -0.15, but lower in magnitude than the coefficients for poverty and unemployment.\n\nThe reason this trend exists is because counties with higher median incomes tend to have a larger proportion of people that can work from home (tech jobs) as well as improved affordable access to quality healthcare. Both these factors translate to a lower number of people being exposed to the virus as well as adequate medical attention for those who do contract the virus, leading to a lower death per population rate.","5a96a960":"### C. Storing Data in Data Frames\nNow that I have defined all of the necessary functions including one that cleans data, I can move on to retrieving data from all of the source files and storing the content of each in panda data frames.","1b3701de":"## 2. Data Analysis\nWith all the data stored in the new data frame and all of the information added to the lists, I can finally analyze the relationship between variables, plot graphs, and examine chloropleth maps.","409dfc0e":"### D. Creating Data Lists\nBelow is a bunch of all of the lists that make up the 21 data points for each county. I decided to create each one as a separate list as creating a dictionary would have served the same purpose and a creating a two-dimensional list would have made it difficult to keep track of each data point.","2c74c5e6":"Looking at the median income map above, it is clear that the two regions that coincide with the deaths per 100,000 people map are the Midwest and the North-East.\n\nAlthough these two regions have high median household incomes which I would instinctively think would decrease deaths, their high death per capita rates might be explained by higher populations and larger cities with higher population densities. It is difficult to tell from the map how the median income affects death rates on the large scale with all 844 counties, which is what we will look at with the graphs below.","ac4a9512":"#### Black Alone % - Why does this make sense?\nThere is a weak positive correlation between the proportion of African-American residents and the deaths per 100,000 people. Due to the systemic oppression of the African-American community for hundreds of years, their community has faced high poverty and unemployment as well as low median incomes. This translates to many people often having to go out to find work, exposing them to the virus more and since they don't have access to quality healthcare, this in turn leads to higher death rates.","d23f8c99":"### D. Educational Factors\nThis analysis specifically focuses on different types of educational backgrounds in a population.","ce154a24":"#### Less than a high school diploma % - Why does this make sense?\nThere is a weak positive correlation between the proportion of adults not completing high school and the number of deaths per 100,000 people. This is because adults that don't complete high school only have the qualifications and skills for low level jobs, thereby increasing poverty and unemployment. This especially correlates with the South-Eastern region\/cluster on the deaths per capita map.","a27b57cf":"Looking at the poverty map above, there are two geographical regions from the deaths per 100,000 people map that coincide with this one - the South-West and the South-East. \n\nThe North-East and the Midwest both have low poverty levels and their high death per population rates might be explained by their large number of big cities and industrial areas with high populations and population densities.","950d5d59":"### B. Economic Factors\nThis analysis specifically focuses on measures of economic health and stability such as the median household income, the poverty rate, and the unemployment rate.","6999d9b8":"### B. Functions\nBelow is a list of some functions I wrote that are called repeatedly throughout the notebook and make certain processes much easier to implement.","cc403174":"#### Hispanic % - Why does this make sense?\nThere is a weak negative correlation between the proportion of Hispanic residents and the deaths per 100,000 people, which is lower in magnitude than the other correlations above. This can be explained by most of these counties having lower population densities as mentioned above.\n\n#### Important Note \nThis DOES NOT mean that the Hispanic community is spared from the worst of the pandemic. This correlation does not show that the Hispanic community in high density places such as New York City is severely affected by COVID-19. This graph merely shows a correlation, not the actual situation of the community.","b18ae79d":"#### Bachelor's degree or higher % - Why does this make sense?\nThere is a weak negative correlation between the proportion of adults with bachelor's degrees or higher and the number of deaths per 100,000 people. This value is lower in magnitude than the other coefficients most likely due to the fact that the Tri-State area is a cluster with a high proportion of adults with bachelor's degrees or higher, but is also a hotspot for COVID-19 and has counties with high death rates."}}