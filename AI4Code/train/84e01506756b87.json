{"cell_type":{"4b9be9b4":"code","cdbbd7d1":"code","6e69ad88":"code","28111712":"code","391c8b93":"code","d22a4b0f":"code","533cacb7":"code","2cafae9e":"code","6e2247f4":"code","85cf898f":"code","fb4e6b5f":"code","780aeafe":"code","32151b24":"code","dd98ed9c":"code","75e79209":"code","2c4aafa0":"code","d0701697":"code","03f53c2d":"code","9ec9a69b":"code","0754a322":"markdown","6ad99311":"markdown","5525f549":"markdown","fba7c62b":"markdown","30c30876":"markdown"},"source":{"4b9be9b4":"# Importing necessary packages:\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\n!pip install pmdarima","cdbbd7d1":"from sklearn.metrics import mean_squared_error,r2_score # Metrics for evaluation.....","6e69ad88":"from pmdarima import auto_arima  #Auto ARIMA package....","28111712":"data_raw= pd.read_csv('..\/input\/basic-auto-arima-dataset\/AutoARIMA.csv') #Importing the file.....","391c8b93":"data =data_raw.iloc[:,1:]\ndata","d22a4b0f":"data['Month'] = pd.to_datetime(data['Month']) #Converting Month column to timestamp....","533cacb7":"data.index = data['Month']       # Since this is time series forecasting, we index month column....","2cafae9e":"data_new = data.drop('Month',axis=1)  #Since Month is indexed, we drop the column from the dataset...","6e2247f4":"#Plotting the graph:\n\nplt.plot(data_new)\nplt.xlabel('Month')\nplt.ylabel('Passengers')\nplt.title('Time-Plot',fontsize=15)\nplt.show()\n\n# The time series clearly has seasonality and Trend element.","85cf898f":"from pmdarima.arima.stationarity import ADFTest\nadf = ADFTest(alpha=0.05)  #Alpha is set to 5%\nadf.is_stationary(data_new)\n\n# The output attained is false, which is we reject Null hypothesis. The series isn't stationary.","fb4e6b5f":"#Splitting the data into Train and test:\n\ntrain = data_new[:int(0.7*len(data))]\ntest = data_new[int(0.7*len(data)):]","780aeafe":"model = auto_arima(train,start_p=1,start_q=1,max_p=8,max_q=8,start_P=0,start_Q=0,max_P=8,max_Q=8,m=12,seasonal=True,stepwise=False,suppress_warnings=True,D=1,d=1,error_action='warn',random_state=20,n_fits=30)","32151b24":"model.summary()     #Model Summary.....","dd98ed9c":"#Model training.....\n\nmodel.fit(train)","75e79209":"#Model prediction........\n\ny_predict = model.predict(n_periods=len(test))","2c4aafa0":"y_predictdf = pd.Series(y_predict.astype(int),index=test.index)  #Array to Series........\ny_predictdf","d0701697":"test","03f53c2d":"#Plotting the test and predictions:\nplt.title('Predicted Vs Test',fontsize=20)\nplt.plot(test)\nplt.plot(y_predictdf,linestyle='--',color='Red')\nplt.xlabel('Month')\nplt.ylabel('Passengers')\nplt.xticks(rotation=90)\nplt.show()","9ec9a69b":"print('Model Evaluation:', r2_score(test,y_predictdf))\nprint('Mean Squared Error:',mean_squared_error(test,y_predictdf,squared=False))","0754a322":"## Introduction to ARIMA model:\n\n- ARIMA stands for Auto Regressive Integrated Moving Average.\n- ARIMA finds its application sales forecasting, inventory forecasting etc\n- It is a type of ML model used for Time Series forecasting.\n- In the 'ARIMA' the 'AR' part takes care of the predictor values lag with its prior values. This is at time called Shift.\n- 'I' in ARIMA takes care of the differenes between the predicting variables present and previous values.\n- 'MA' in ARIMA indicates the regressive error, the linear combination of the error terms.\n- The major parameters in an ARIMA model is (p,d,q).\n- 'p' denotes the order of time lags.\n- 'd' denotes degree of differences, number of times the data of past has been subtracted.\n- 'q' denotes order of the moving average values.\n- (P,D,Q) represents same meaning as (p,d,q), they represent seasonal component.\n- Metrics used in a ARIMA model could be Mean squared error(MSE), r2_score, Mean average percentage error(MAPE), AIC(Akaike information criteria), BIC(Bayesian Information Criteria).","6ad99311":"## Stationarity Check : Using ADF","5525f549":"## Auto ARIMA:\n\n- Auto ARIMA takes care of automatically tweaking the (p,d,q) parameters to get the model with best metrics.\n- (p,d,q) values set in the desired range of values by the user and the model computes the best of the parameters and predicts.\n- Auto ARIMA is a module in the Pyramid package in Python.","fba7c62b":"## Model building :","30c30876":"## Stationarity of the data :\n\n- In any time series data we can always encounter, seasonal effect, trend and noise.\n- The model's prediction can be relied upon only when the data is stationary.\n- Stationarity : In this context refers to mean and variance of the plot remains constant over time.\n- Differencing term in the ARIMA takes care of the stationarity.\n- There are numerous tests to check out for stationarity on the data.\n- Augmented Dickey fuller test, rolling mean and much more.\n- Even stationarity can be visualized used Auto Correlatory plot(ACF plot)."}}