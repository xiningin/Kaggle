{"cell_type":{"c7c62913":"code","03271996":"code","63d281b1":"code","c71e8f8b":"code","aed4854c":"code","9429f224":"code","2d8aa54e":"code","56310e28":"code","a885f2d9":"code","592c14c2":"code","b530a0a5":"code","757e60e1":"code","859b6360":"code","af3c8e25":"code","91b0065a":"code","4614258f":"code","2f4ccaa6":"code","0590018c":"markdown"},"source":{"c7c62913":"import cv2","03271996":"faceClassifier = cv2.CascadeClassifier(\"haarcascade_frontalface_default.xml\")\n#img = cv2.imread(\"indian.jpg\")\ngray_image = cv2.cvtColor(img, cv2.COLOR_BGR2BGRA)\nfaces = faceClassifier.detectMultiScale(gray_image, 1.3, 12)\nfor x,y,w,h in faces:\n    img = cv2.rectangle(img, (x,y), (x + w, y + h), (255,255,255), 3)\nwhile True:\n    cv2.imshow(\"My Face - New\", img)\n    if cv2.waitKey(1) == 13:\n        break\n","63d281b1":"cam = cv2.VideoCapture(0)","c71e8f8b":"cam = cv2.VideoCapture(1)\nwhile True:\n    Con, img = cam.read()\n    if Con:\n        gray_image = cv2.cvtColor(img, cv2.COLOR_BGR2BGRA)\n        faces = faceClassifier.detectMultiScale(gray_image, 1.3, 6)\n        for x,y,w,h in faces:\n            img = cv2.rectangle(img, (x,y), (x + w, y + h), (0,255,0), 3)\n        cv2.imshow(\"My Face - New\", img)\n        if cv2.waitKey(1) == 13:\n            break\n    else:\n        print(\"Connect Your Camera..\")","aed4854c":"import numpy as np","9429f224":"def CreateDataSet():\n    cam = cv2.VideoCapture(0)\n    Sam = 0\n    while True:\n        Con, img = cam.read()\n        if Con:\n            gray_image = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)\n            faces = faceClassifier.detectMultiScale(gray_image, 1.3, 6)\n            for x,y,w,h in faces:\n                face = gray_image[y:y+h, x:x+w]\n                face = cv2.resize(face, (200, 200))\n                \n                cv2.imwrite(\"Images\/user.{}.jpg\".format(Sam), face)\n                Sam = Sam + 1\n                face = cv2.putText(face, str(Sam), (50, 50), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0,255,0), 2)\n                cv2.imshow(\"My Face\", face)\n            \n            \n            if Sam == 50:\n                print(\"We Collected Your Faces...\")\n                break\n                \n            if cv2.waitKey(1) == 13:\n                break\n    cam.release()\n\nCreateDataSet()","2d8aa54e":"### Train Our Model With Your Faces...","56310e28":"import cv2\nimport numpy as np\nimport os\n\npath = \"Images\/\"\nall_images = os.listdir(path)[:-1]\n\nTraining_Data = []\nLabels = np.arange(1, len(all_images)+1)\nLabels = np.asarray(Labels, dtype = np.int32)\nfor i in all_images:\n    if i[-4:] == \".jpg\":\n        img_path = path + i\n        print(img_path)\n        image = cv2.imread(img_path, cv2.IMREAD_GRAYSCALE)\n        if len(image) < 1:\n            print(i, img_path)\n        Narray = np.asarray(image, dtype = np.uint8)\n        Training_Data.append(Narray)\n    ","a885f2d9":"### Train Your Model...","592c14c2":"#Face_Model = cv2.face.LBPHFaceRecognizer_create()\nFace_Model = cv2.face_LBPHFaceRecognizer.create()\nFace_Model.train(Training_Data, Labels)\nprint(\"We Trained Your Machine with Your Faces.\")","b530a0a5":"###Detect Face...\n","757e60e1":"import subprocess\nfaceClassifier = cv2.CascadeClassifier(\"haarcascade_frontalface_default.xml\")\ncam = cv2.VideoCapture(0)\nwhile True:\n    Con, img = cam.read()\n    if Con:\n        gray_image = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)\n        faces = faceClassifier.detectMultiScale(gray_image, 1.3, 6)\n        for x,y,w,h in faces:\n            face = gray_image[y:y+h, x:x+w]\n            face = cv2.resize(face, (200, 200))\n\n            pred = Face_Model.predict(face)\n            print(pred)\n            if pred[1]< 42:\n                face = cv2.putText(img, \"Hey! Prateek\", (x, y-20), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0,255,0), 2)\n                cv2.rectangle(img, (x,y), (x+w, y+h), (0,255,0), 2)\n                #subprocess.call([\"say\", \"Hey Prateek. How Can i Help You..\"])\n            else:\n                face = cv2.putText(img, \"Unknown Face @\", (x, y-20), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0,0,255), 2)\n                cv2.rectangle(img, (x,y), (x+w, y+h), (0,0,255), 2)\n                \n           \n        cv2.imshow(\"MyFace\", img)\n        if cv2.waitKey(1) == 13:\n            break","859b6360":"\nimg = cv2.imread(\"Images\/user.11.jpg\")\ngray_image = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)\nfaces = faceClassifier.detectMultiScale(gray_image, 1.3, 6)\nfor x,y,w,h in faces:\n    face = gray_image[y:y+h, x:x+w]\n    face = cv2.resize(face, (200, 200))\n\n    pred = Face_Model.predict(face)\n    print(pred)\n    if pred[1]< 42:\n        face = cv2.putText(img, \"Hey! User\", (x, y-20), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0,255,0), 2)\n        cv2.rectangle(img, (x,y), (x+w, y+h), (0,255,0), 2)\n        subprocess.call([\"say\", \"Hey User. How Can i Help You..\"])\n    else:\n        face = cv2.putText(img, \"Unknown Face @\", (x, y-20), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0,0,255), 2)\n        cv2.rectangle(img, (x,y), (x+w, y+h), (0,0,255), 2)\n\n\ncv2.imshow(\"MyFace\", img)\nif cv2.waitKey(1) == 13:\n    break","af3c8e25":"import matplotlib.pyplot as plt","91b0065a":"x = [3,4,3,4,5,6,7,3,4,6,4,6,5,4,3,6,8,9,4,3,6,7,3,3,4,5,6,3,2,1,1,1,1,7,6,7,8]\ny = [43,54,6,7,87,545,21,54,8,434,65,76,43,54,76,322,6,58,79,89,2,435,76,88,65,3]","4614258f":"plt.hist(x, bins=3)","2f4ccaa6":"plt.hist(y)","0590018c":"> **PLEASE NOTE THAT YOU NEED TO MODIFY THE CODE AS PER YOUR SYSTEM. THE SAME CODE WON'T RUN.\n> > SCRIPT KIDDIES ARE ENCOURAGES TO GAIN KNOWLEDGE BEFORE USING THE CODE!**"}}