{"cell_type":{"66abfd33":"code","a11d1368":"code","b8dae98a":"code","af22e675":"code","fb6b166e":"code","e1945f17":"code","89b752ce":"code","2bc5290e":"code","4b22c0d9":"markdown","24c4fcd1":"markdown","3d0bdedb":"markdown","f56937a4":"markdown","c2fd6229":"markdown","2d7f19ad":"markdown","e9946645":"markdown","37812acd":"markdown"},"source":{"66abfd33":"import h2o\nh2o.init()","a11d1368":"train_data = h2o.import_file('..\/input\/tabular-playground-series-oct-2021\/train.csv')\ntest_data  = h2o.import_file('..\/input\/tabular-playground-series-oct-2021\/test.csv')","b8dae98a":"train_data","af22e675":"train_data[\"target\"] = train_data[\"target\"].asfactor()","fb6b166e":"from h2o.estimators.gbm import H2OGradientBoostingEstimator\n\nclassifier  =  H2OGradientBoostingEstimator(nfolds =    5,\n                                            ntrees =  100,\n                                            seed   =    1,\n                                            max_depth = 9, \n                                            stopping_rounds =   5,\n                                            stopping_metric = \"AUC\")","e1945f17":"classifier.train(training_frame=train_data, y=\"target\")","89b752ce":"predictions    = classifier.predict(test_data)\npredictions_df = predictions[\"p1\"].as_data_frame()","2bc5290e":"import pandas as pd\nsample = pd.read_csv('..\/input\/tabular-playground-series-oct-2021\/sample_submission.csv')\nsample[\"target\"] = predictions_df[\"p1\"]\nsample.to_csv('submission.csv',index=False)","4b22c0d9":"![](https:\/\/raw.githubusercontent.com\/Carl-McBride-Ellis\/images_for_kaggle\/main\/H2O_ai_logo.png)\n# H2O.ai Gradient boosting classifier\nIn this notebook we shall be using the Gradient boosting classifier ([`H2OGradientBoostingEstimator`](https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/data-science\/gbm.html)) from [H2O.ai](https:\/\/www.h2o.ai\/)\n\nTo learn more about H2O.ai see:\n* [H2O.ai Overview](https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/index.html)\n* [H2O.ai Tutorials](https:\/\/docs.h2o.ai\/h2o-tutorials\/latest-stable\/index.html)\n\nFirstly, import `h2o` and start a local H2O server","24c4fcd1":"Read in the data as a [H2OFrame](https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-py\/docs\/frame.html), the primary data store for H2O. \n\nNote that \n\n> \"*One of the critical distinction is that the data is generally not held in memory, instead it is located on a (possibly remote) H2O cluster*\" \n\nso we see that our notebook RAM is hardly used at all, and we can read in the whole `train` and `test` datasets with ease:","3d0bdedb":"### Train our classifier","f56937a4":"### Take a quick look at the data","c2fd6229":"We shall be using the [H2O Gradient Boosting Machine](https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/data-science\/gbm.html)","2d7f19ad":"### Insert the predictions into the `sample_submission.csv` provided","e9946645":"### Produce our predictions","37812acd":"Convert the `target` column in the `train_data` frame to be categorical, indicating to the estimator that this is a classification problem. As for the other categorical features, H2O automatically takes care of them."}}