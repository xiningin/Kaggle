{"cell_type":{"63409c93":"code","eb7bdf1b":"code","3fe0985d":"code","43c20400":"code","5604e050":"code","b670976d":"code","3155a05d":"code","37c9f942":"code","d7901443":"code","cdf6b151":"markdown"},"source":{"63409c93":"import pandas as pd\nimport h2o\nfrom h2o.automl import H2OAutoML","eb7bdf1b":"h2o.init()\nh2o.cluster().show_status()","3fe0985d":"train = h2o.import_file('\/kaggle\/input\/dsa-automl-and-fe\/train_fe.csv')\ntest = h2o.import_file('\/kaggle\/input\/dsa-automl-and-fe\/test_fe.csv')","43c20400":"train['target'] = train['target'].asfactor()","5604e050":"x = train.columns\nx.remove('ID')\nx.remove('v22')\nx.remove('v56')\nx.remove('v71')\ny = 'target'\ntrain[y] = train[y].asfactor()","b670976d":"%%time\naml = H2OAutoML(max_models=10, \n                nfolds=20, \n                max_runtime_secs=60*60*4,\n                balance_classes=True,\n                sort_metric='logloss', \n                exclude_algos=['DeepLearning'], \n                verbosity='info')\naml.train(x=x, y=y, training_frame=train)\nlb = aml.leaderboard\nlb.head(rows=lb.nrows)","3155a05d":"aml.leaderboard","37c9f942":"test['PredictedProb'] = aml.leader.predict(test)[:,2]","d7901443":"h2o.export_file(test[['ID', 'PredictedProb']],'submission.csv')","cdf6b151":"### Competi\u00e7\u00e3o DSA de Machine Learning - Dezembro 2019\n#### Previs\u00e3o de Indediza\u00e7\u00e3o aos Segurados pela Seguradora\n#### AutoML(H2O)"}}