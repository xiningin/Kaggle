{"cell_type":{"4cc3fee3":"code","fefb9369":"code","8afb6d2d":"code","f75df5ae":"code","c6728c38":"code","ef7d365f":"code","83ee6ce9":"code","7ee2dcae":"code","e671e812":"code","d33b6d12":"code","e2ba86f8":"code","7005cd09":"code","1b424b08":"code","a8d01b91":"code","6ede7fce":"code","2ae36806":"code","98e3aa91":"code","bce2a70e":"code","2f67ebeb":"markdown","d9ea0d43":"markdown","ecabdc6c":"markdown","1c6521be":"markdown","20f04f3d":"markdown","0cad8ff9":"markdown","b4f96388":"markdown","d8fe028c":"markdown","9950923f":"markdown","44097536":"markdown","00feaf0b":"markdown","5149dd80":"markdown","61a11f5f":"markdown","0430765a":"markdown","d8bcfd77":"markdown","a40817dd":"markdown","8e9d1c92":"markdown","7b577884":"markdown","4f06e569":"markdown"},"source":{"4cc3fee3":"import pandas as pd\nimport numpy as np\nfrom sklearn.preprocessing import StandardScaler\nimport tflearn.data_utils as du\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.model_selection import train_test_split\nimport seaborn as sns\nfrom sklearn.metrics import confusion_matrix\n\nfrom sklearn.externals.six import StringIO  \nfrom IPython.display import Image  \nfrom sklearn.tree import export_graphviz\nimport pydotplus","fefb9369":"data = pd.read_csv('..\/input\/column_3C_weka.csv')","8afb6d2d":"data.info()","f75df5ae":"# Calculating the correlation matrix\ncorr = data.corr()\n# Generating a heatmap\nsns.heatmap(corr,xticklabels=corr.columns, yticklabels=corr.columns)","c6728c38":"sns.pairplot(data)","ef7d365f":"x = data.iloc[:,:6].values\ny = data.iloc[:,6].values","83ee6ce9":"x_train , x_test, y_train, y_test = train_test_split(x, y, test_size = 0.25, random_state = 0)","7ee2dcae":"sc = StandardScaler()\nx_train = sc.fit_transform(x_train)\nx_test = sc.transform(x_test)","e671e812":"classifier = DecisionTreeClassifier(criterion = 'entropy', max_depth = 4)\nclassifier.fit(x_train, y_train)","d33b6d12":"y_pred = classifier.predict(x_test)","e2ba86f8":"cm = confusion_matrix(y_test, y_pred)","7005cd09":"accuracy = sum(cm[i][i] for i in range(3)) \/ y_test.shape[0]\nprint(\"accuracy = \" + str(accuracy))","1b424b08":"dot_data = StringIO()\n\nexport_graphviz(classifier, out_file=dot_data,  \n                filled=True, rounded=True,\n                special_characters=True)\n\ngraph = pydotplus.graph_from_dot_data(dot_data.getvalue())  \nImage(graph.create_png())","a8d01b91":"classifier2 = DecisionTreeClassifier(criterion = 'entropy')\nclassifier2.fit(x_train, y_train)","6ede7fce":"y_pred2 = classifier2.predict(x_test)","2ae36806":"cm2 = confusion_matrix(y_test, y_pred2)","98e3aa91":"accuracy2 = sum(cm2[i][i] for i in range(3)) \/ y_test.shape[0]\nprint(\"accuracy = \" + str(accuracy2))","bce2a70e":"dot_data = StringIO()\n\nexport_graphviz(classifier2, out_file=dot_data,  \n                filled=True, rounded=True,\n                special_characters=True)\n\ngraph = pydotplus.graph_from_dot_data(dot_data.getvalue())  \nImage(graph.create_png())","2f67ebeb":"## Visualizing the Decision Tree","d9ea0d43":"To know more about the different paramteres of the `sklearn.tree.DecisionTreeClassifier`, click [here](http:\/\/scikit-learn.org\/stable\/modules\/generated\/sklearn.tree.DecisionTreeClassifier.html)","ecabdc6c":"## Building a model without the `max_depth` parameter","1c6521be":"## Building the Decision tree\nThe criterion here is `entropy`. The criterion parameter detemines the function to measure the quality of a split. When the `entropy` is used as a criterion, each split tries to reduce the randomness in that part of the data.\n\nThe another parameter used is the `max_depth`. This determines how deep a tree can go. The affect of this parameter on the model will be discusses later in this notebook","20f04f3d":"## What is correlation?\nCorrelation is a statistical term which in common usage refers to how close two variables are to having a linear relationship with each other. \n\nFor example, two variable which are linearly dependent (say, x and y which depend on each other as x = 2y) will have a higher correlation than two variables which are non-linearly dependent (say, u and v which depend on each other as u = v<sup>2<\/sup>)","0cad8ff9":"## What is a confusion matrix?\n>A confusion matrix is a technique for summarizing the performance of a classification algorithm.\nClassification accuracy alone can be misleading if you have an unequal number of observations in each class or if you have more than two classes in your dataset.\nCalculating a confusion matrix can give you a better idea of what your classification model is getting right and what types of errors it is making.\n\n*[Source](https:\/\/machinelearningmastery.com\/confusion-matrix-machine-learning\/)*","b4f96388":"## Visualizing the decision tree without the `max_depth` parameter","d8fe028c":"The dataset used here is the [Biomechanical features of orthopedic patients](https:\/\/www.kaggle.com\/uciml\/biomechanical-features-of-orthopedic-patients)","9950923f":"This kernel was inspired by the kernel - [Do You Have Spinal Disease? Decision Tree in R](https:\/\/www.kaggle.com\/petrkajzar\/do-you-have-spinal-disease-decision-tree-in-r)","44097536":"## What are Decision Trees?\n>A decision tree is a flowchart-like structure in which each internal node represents a \"test\" on an attribute (e.g. whether a coin flip comes up heads or tails), each branch represents the outcome of the test, and each leaf node represents a class label (decision taken after computing all attributes).\n\n*(Source: [Wikipedia](https:\/\/en.wikipedia.org\/wiki\/Decision_tree#Overview))*\n\nIn simpler terms, a decision tree checks if an attribute or a set of attributes satisfy a condition and based on the result of the check, the subsequent checks are performed. The tree splits the data into different parts based these checks.","00feaf0b":"## Importing the necessary libraries","5149dd80":"## What is achieved in this kernel?\nThe following are achieved in this dataset\n* Loading the data\n* Visualizing the data using a correlaton matrix and a pair plot\n* Building a Decision Tree Classifier\n* Determining the accuracy of the model using a confusion matrix\n* Viualizing the Decision tree as a flow chart","61a11f5f":"## Splitting the dataset into train and test data\nThe train data to train the model and the test data to validate the model's performance","0430765a":"## Splitting the dataset into independent (x) and dependent (y) variables","d8bcfd77":"# Understanding decision trees","a40817dd":"In the above two plots you can clearly see that the pairs of independent variables with a higher correlation have a more linear scatter plot than the independent variables having a relatively lesser correlation","8e9d1c92":"## Making the prediction on the test data","7b577884":"## Scaling the independent variables\n[This](https:\/\/stackoverflow.com\/questions\/26225344\/why-feature-scaling#26229427) question on stackoverflow has responses which gives a brief explanation on why scaling is necessary and how it can affect the model","4f06e569":"Now, consider the leaf nodes (terminal nodes) of the tree with and without the `max_depth` paratemer. You will notice that the entropy all the terminal nodes are zero in the tree without the `max_depth` parameter and non zero in three with that parameter. This is because when the parameter is not mentioned, the split recursively takes place till the terminal node has an entropy of zero."}}