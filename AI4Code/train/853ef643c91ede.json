{"cell_type":{"cffe7e19":"code","db144529":"code","aa70ced1":"code","48a00362":"code","f8718a37":"code","e9a224fc":"code","7a8bc775":"code","ccc90904":"code","dd7d1dad":"code","e52fb7a9":"code","ba5e8bdf":"code","98866992":"code","ac8a6523":"code","3f894038":"code","66c08248":"code","6b373881":"code","d391d87d":"code","624ba51e":"code","4f451bbb":"code","845dfd15":"code","ccd4ec95":"code","5aa5afe1":"code","54e42fc8":"code","0e142e17":"code","5e675199":"code","2bb44b18":"code","11fc258a":"code","54095294":"code","a6cac0de":"code","468fc14b":"code","164cd3d4":"code","8cd65dcf":"code","e78e8ad0":"code","9ec1d3b9":"code","12f1baee":"code","44cf9564":"code","4f47863e":"code","e9ac0e9a":"code","7555298b":"code","dfb1c6f9":"code","399f81a6":"code","32721fa9":"code","b64bab63":"code","98dce896":"code","1f22867b":"code","a5fcf505":"code","ddcd4d24":"code","c704a300":"code","95b3e06d":"code","33cf98d0":"code","4d551c4e":"code","4b54486f":"code","c29a4579":"code","7d7def37":"code","bd02949b":"code","40fd462f":"markdown","3eac38dc":"markdown","16d099a5":"markdown","8fc82a97":"markdown","42cbb90d":"markdown","cc0ded21":"markdown","1c7dda84":"markdown","beee4acb":"markdown","652e2f20":"markdown","05bef5ce":"markdown","7163e52d":"markdown","f68c1d99":"markdown","4febbef2":"markdown"},"source":{"cffe7e19":"import numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport pandas as pd\nfrom sklearn.metrics import accuracy_score,f1_score,recall_score,precision_score, confusion_matrix,classification_report","db144529":"data=pd.read_csv('..\/input\/indian-liver-patient-records\/indian_liver_patient.csv')","aa70ced1":"data.head()","48a00362":"data.rename({'Dataset':'Liver_disorder'},axis=1,inplace=True)","f8718a37":"data.isnull().sum()","e9a224fc":"data.shape","7a8bc775":"data.dropna().shape","ccc90904":"data['Albumin_and_Globulin_Ratio'].unique()","dd7d1dad":"data[data['Albumin_and_Globulin_Ratio'].isnull()]","e52fb7a9":"data.dropna(inplace=True)","ba5e8bdf":"data['Liver_disorder'].value_counts()","98866992":"data.shape","ac8a6523":"data.head()","3f894038":"sns.pairplot(data)","66c08248":"data.corr()","6b373881":"data['Gender']=data['Gender'].replace({'Male':0,'Female':1})","d391d87d":"data['Gender'].value_counts()","624ba51e":"data.info()","4f451bbb":"data['Gender']=data['Gender'].astype('category')","845dfd15":"#no_of_MF_with_disorder=data[data['Liver_disorder']==1].groupby('Gender')[['Gender']].count()","ccd4ec95":"#no_of_MF_with_disorder","5aa5afe1":"tab=pd.crosstab(data.Gender,data.Liver_disorder)\nprint(tab)","54e42fc8":"#tot=data.groupby('Gender')[['Gender']].count()","0e142e17":"#tot","5e675199":"tot_male=tab.iloc[1].sum()","2bb44b18":"male_with_disorder=tab.iloc[1,0]","11fc258a":"tot_female=tab.iloc[0].sum()","54095294":"female_with_disorder=tab.iloc[0,0]","a6cac0de":"p1=male_with_disorder\/tot_male","468fc14b":"p2=female_with_disorder\/tot_female","164cd3d4":"p=(male_with_disorder+female_with_disorder)\/data.shape[0]","8cd65dcf":"Zstats=(p1-p2)\/(np.sqrt(p*(1-p)*((1\/tot_male)+(1\/tot_female))))","e78e8ad0":"Zstats","9ec1d3b9":"import scipy.stats as stats\nstats.norm.cdf(Zstats)","12f1baee":"cor=data.corr()","44cf9564":"cor_target=abs(cor['Liver_disorder'])","4f47863e":"Pearson_Coeff=pd.DataFrame(cor_target)\nprint(Pearson_Coeff)","e9ac0e9a":"data.info()","7555298b":"data.drop('Total_Protiens',axis=1,inplace=True)","dfb1c6f9":"d=data.drop('Liver_disorder',axis=1)","399f81a6":"features = \"+\" .join(d)\n#y, X = dmatrices('annual_inc ~' + features, df, return_type='dataframe')","32721fa9":"features","b64bab63":"from   patsy                                import dmatrices\nfrom   statsmodels.stats.outliers_influence import variance_inflation_factor\ny,X=dmatrices('Liver_disorder~'+features,data,return_type='dataframe')","98dce896":"Vif=pd.DataFrame()","1f22867b":"Vif['features']=X.columns\nVif['VIF factor']=[variance_inflation_factor(X.values,i) for i in range(X.shape[1])]\n\nprint(Vif)","a5fcf505":"LData=data.drop('Direct_Bilirubin',axis=1)","ddcd4d24":"LData.head()","c704a300":"from sklearn.model_selection import GridSearchCV\nfrom sklearn.linear_model import LogisticRegression\npenalty=['l2','l1']\nmulti_class=['ovr', 'auto']\nX=LData.drop('Liver_disorder',axis=1)\ny=LData[['Liver_disorder']]\nmodel=LogisticRegression()\ngrid=GridSearchCV(estimator=model,cv=3,param_grid=dict(penalty=penalty,multi_class=multi_class))\ngrid.fit(X,y)","95b3e06d":"print(grid.best_params_)","33cf98d0":"print('Recall:',grid.best_score_)\nprint('Accuracy:',grid.best_score_)","4d551c4e":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test=train_test_split(X,y,test_size=0.20,random_state=2)","4b54486f":"y_train.shape","c29a4579":"model1=LogisticRegression()\nmodel1.fit(X_train, y_train)","7d7def37":"preds= model1.predict(X_test)","bd02949b":"print(accuracy_score(y_test,preds))","40fd462f":"### Time to apply Logistic Regression:","3eac38dc":"### This is the co-relationship between X's and Y","16d099a5":"####  Multi-co-linearity: Total_Bilirubin and Direct Bilirubin have High VIF so lets Drop one of the Column.","8fc82a97":"### Dropping 4 rows","42cbb90d":"#### Now lets check if multi-colinearity exist between independent X's:Using VIF","cc0ded21":"### pval<<0.05 we can reject the H_null i.e the proportion is not the same between male and female so it can be a one of the good predictor of Y","1c7dda84":"#### Let's use train lets split","beee4acb":"##### Lets drop protein beacuse it's not significant predictor of Y the co-relation co-eff is just 3%","652e2f20":"#### HNULL= proportion of liver disorder in male = proportion of liver disorder in female\n#### Halternative= proportions are not equal","05bef5ce":"### EDA","7163e52d":"#323 female have liver_disorder\n\n#91 Male have liver_disorder\n\n","f68c1d99":"Lets do Grid Search: To find best Parameters:Using k-fold cross validation","4febbef2":"##### lets perform statistical test on Gender to see if both the means are same or it is significantly different to predict (good predictor):As gender  and Liver_disorder both are categorical we will be doing 2 sample proportion test(popularly called as Z-test)."}}