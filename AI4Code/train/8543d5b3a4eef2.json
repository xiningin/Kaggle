{"cell_type":{"9a658071":"code","32c93e40":"code","53229e7c":"code","815555ee":"code","93d55c19":"code","02cb616c":"code","f843227c":"code","d1a8e9d8":"code","c970f018":"code","88531682":"code","79bf7d5d":"code","b8ce338a":"code","b8f65ce8":"code","824fac4a":"code","40a0028e":"code","92b61699":"code","71ceb417":"code","6d4f5523":"markdown","6f9425f4":"markdown","95beb2aa":"markdown","0993dee1":"markdown"},"source":{"9a658071":"import pandas as pd\nimport numpy as np\nimport os\nimport glob\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.ensemble import ExtraTreesClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.impute import SimpleImputer","32c93e40":"train = '\/kaggle\/input\/sepsisb\/training_setB\/'\nprint('training setA have {} files'.format(len(os.listdir(train))))","53229e7c":"os.chdir('\/kaggle\/input\/sepsisb\/training_setB\/')\nextension ='psv'\nfilenames = [i for i in glob.glob('*{}'.format(extension))]","815555ee":"trainn = pd.concat([pd.read_csv(f , sep='|') for f in filenames])\ntrainn.to_csv(r'trainn.csv')","93d55c19":"from IPython.display import FileLink\nFileLink('\/kaggle\/input\/trainn.csv\/')","02cb616c":"X = trainn.drop(columns =['SepsisLabel','PaCO2','SBP','MAP','pH','DBP','PTT','FiO2','Potassium','Lactate','Glucose','AST','TroponinI','Hct', 'Hgb','O2Sat','Unit1','Unit2'])","f843227c":"X.head()","d1a8e9d8":"y = trainn['SepsisLabel']","c970f018":"y.head()","88531682":"imputer = SimpleImputer(strategy=\"median\")\nimputer.fit(X)\nX = imputer.transform(X)","79bf7d5d":"clf = ExtraTreesClassifier( n_estimators=100, criterion=\"entropy\", max_features=\"auto\", min_samples_leaf=1, min_samples_split=5)\n\nclf.fit(X,y)","b8ce338a":"import pickle","b8f65ce8":"filename = '\/kaggle\/working\/model_v1.pkl'\nwith open( filename, 'wb') as file:\n    pickle.dump(clf, file) ","824fac4a":"with open(filename ,'rb') as f:\n    loaded_model = pickle.load(f)\nloaded_model","40a0028e":"X_test = np.array([120,21,16,43,34,25,45,22,45,6,104,0.9,20,8.6,8.9,52,2.2,22,32,28,0,-0.98,258])\nX_test = X_test.reshape(1,-1)\ny_predict = clf.predict(X_test)","92b61699":"y_predict","71ceb417":"loaded_model.predict(X_test)","6d4f5523":"Here the platform i used was Kaggle as it provides free GPU along with 16 GB RAM.","6f9425f4":"Import the necessary libraries and packages used.","95beb2aa":"# SEPSIS PREDICTION MODEL ","0993dee1":"Extract data from each files in the Training A folder of our dataset. Patience is important parameter here(lol !), as we are extracting and concatinating data from 20,000 files on the go."}}