{"cell_type":{"719a8458":"code","3d7607f9":"code","73d52fee":"code","47169615":"code","7325cfbd":"code","cb91cb13":"code","a8ac6658":"code","35ebed95":"code","7cee3423":"code","f7b85fcd":"code","e7526590":"code","75eac027":"code","80c6404b":"code","8b2bba9b":"code","ddc08dc9":"markdown","6951b6b9":"markdown","d16502d4":"markdown","3e7113f0":"markdown","f26145a2":"markdown"},"source":{"719a8458":"import os\nimport cv2\nimport ast\nimport numpy as np\nimport pandas as pd\nimport matplotlib\nimport matplotlib.pyplot as plt","3d7607f9":"path = '\/kaggle\/input\/tensorflow-great-barrier-reef\/'\nos.listdir(path)","73d52fee":"train_data = pd.read_csv(path+'train.csv')\ntest_data = pd.read_csv(path+'test.csv')\nsamp_subm = pd.read_csv(path+'example_sample_submission.csv')","47169615":"train_data.head()","7325cfbd":"video_frame = 621\nfile_name = str(video_frame)+'.jpg'\ntrain_data[train_data['video_frame']==video_frame]","cb91cb13":"image_folder_0 = cv2.imread(path+'train_images\/video_2\/'+file_name)\nimage_folder_1 = cv2.imread(path+'train_images\/video_1\/'+file_name)\nimage_folder_2 = cv2.imread(path+'train_images\/video_0\/'+file_name)","a8ac6658":"train_data[(train_data['video_frame']==video_frame)&(train_data['video_id']==1)]['annotations']","35ebed95":"row = 7329","7cee3423":"boxes = ast.literal_eval(train_data.loc[row, 'annotations'])","f7b85fcd":"fig, ax = plt.subplots(1, 1, figsize=(20, 8))\nax.imshow(image_folder_1)\nfor box in boxes:\n    p = matplotlib.patches.Rectangle((box['x'], box['y']), box['width'], box['height'],\n                                     ec='r', fc='none', lw=2.)\n    ax.add_patch(p)\nax.set_xticklabels([])\nax.set_yticklabels([])\nplt.savefig(\"oh_no_one_reef_eater.png\")\nplt.show()","e7526590":"row = 2845\nfile_name = str(train_data.loc[row, 'video_frame'])+'.jpg'\nvideo_folder = 'video_'+str(train_data.loc[row, 'video_id'])\nboxes = ast.literal_eval(train_data.loc[row, 'annotations'])","75eac027":"print('video folder:', video_folder)\nprint('file name:', file_name)","80c6404b":"image = cv2.imread(path+'train_images\/'+video_folder+'\/'+file_name)\nimage.shape","8b2bba9b":"fig, ax = plt.subplots(1, 1, figsize=(20, 8))\nax.imshow(image)\nfor box in boxes:\n    p = matplotlib.patches.Rectangle((box['x'], box['y']), box['width'], box['height'], ec='r', fc='none', lw=2.)\n    ax.add_patch(p)\nax.set_xticklabels([])\nax.set_yticklabels([])\nplt.show()","ddc08dc9":"## \u5bfc\u5305","6951b6b9":"## \u7ed8\u56fe2","d16502d4":"## \u5bfc\u5165\u6570\u636e\u96c6","3e7113f0":"## \u7ed8\u56fe","f26145a2":"## \u8bbe\u7f6eBox"}}