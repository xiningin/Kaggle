{"cell_type":{"a36f390f":"code","29b32c80":"code","a2a0439d":"code","258f0ac1":"code","8f1a53fe":"code","8b5dbbf7":"code","2d04a842":"code","2f20a750":"code","b2bd797a":"code","c5a1e02e":"code","aecdbabf":"code","37fc79b8":"code","545cb1fb":"code","56a8cba0":"code","f13b7afa":"code","c2ab3b7a":"code","d5b61d64":"code","493dc9ee":"code","4b7779e3":"code","cb47f490":"code","a5d75aa7":"code","56a07828":"code","dd5845bc":"code","4c96153a":"code","0e7ac470":"code","187ce1c9":"code","2681e07d":"code","e7f93872":"code","16d50be3":"code","db9ae8e0":"markdown","e4bc5d48":"markdown"},"source":{"a36f390f":"import pandas as pd\nimport numpy as np\nimport os","29b32c80":"train=pd.read_csv(\"..\/input\/train.csv\")\ntest=pd.read_csv(\"..\/input\/test.csv\")","a2a0439d":"print(\"train data size:\",train.shape)\nprint(\"test data size:\",test.shape)\n","258f0ac1":"print(\"train:\\n\",train.head())\nprint(\"test:\\n\",test.head())","8f1a53fe":"train['train\/test']='train'\ntest['train\/test']='test'\ntarget=train.sales\ntrain.drop('sales',axis=1,inplace=True)\ntest.drop('id',axis=1,inplace=True)","8b5dbbf7":"df=pd.concat([train,test])","2d04a842":"df.head()","2f20a750":"print(df.shape,\"\\n\",df.dtypes)","b2bd797a":"df['date']=pd.to_datetime(df['date'])","c5a1e02e":"df['dayofmonth'] = df.date.dt.day.astype(str)\ndf['dayofyear'] = df.date.dt.dayofyear.astype(str)\ndf['dayofweek'] = df.date.dt.dayofweek.astype(str)\ndf['month'] = df.date.dt.month.astype(str)\n#df['year'] = df.date.dt.year.astype(str)\ndf['weekofyear'] = df.date.dt.weekofyear.astype(str)\n#df['is_month_start'] = (df.date.dt.is_month_start).astype(int)\n#df['is_month_end'] = (df.date.dt.is_month_end).astype(int)\ndf[360:370]","aecdbabf":"df.dtypes","37fc79b8":"trntst=df['train\/test']\ndf.drop('train\/test',axis=1,inplace=True)","545cb1fb":"df.head()","56a8cba0":"%%time\ndf=pd.get_dummies(df)","f13b7afa":"df.shape","c2ab3b7a":"df['train_or_test']=trntst\ndel trntst","d5b61d64":"df.shape","493dc9ee":"df.drop('date',axis=1,inplace=True)","4b7779e3":"x=df[df['train_or_test']=='train']\ntest=df[df['train_or_test']=='test']","cb47f490":"x.drop('train_or_test',axis=1,inplace=True)\ntest.drop('train_or_test',axis=1,inplace=True)","a5d75aa7":"print(x.shape,test.shape)","56a07828":"import lightgbm as lgb","dd5845bc":"lg=lgb.LGBMRegressor()\nlg","4c96153a":"%%time\nlg.fit(x,target)","0e7ac470":"lg.score(x,target)","187ce1c9":"%%time\npredict=pd.DataFrame(lg.predict(test),columns=['sales'])","2681e07d":"predict.head()","e7f93872":"ids=pd.read_csv(\"..\/input\/test.csv\",usecols=['id'])\nsub=ids.join(predict)","16d50be3":"sub.to_csv(\"lgbm_get_dummies.csv\",index=False)","db9ae8e0":"### LightGBM","e4bc5d48":"### Libraries"}}