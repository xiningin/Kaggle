{"cell_type":{"3fd594c0":"code","324f75ef":"code","ee53f5af":"code","73bd8e90":"code","ff3ba651":"code","f450cc18":"code","12a7135a":"code","f750c386":"code","89d2ff25":"code","a8b59f37":"code","4bfdaac3":"code","3195e6a2":"code","54bc60d3":"code","d2bf929e":"code","91e1e9c2":"code","9280f28a":"code","95ec86f2":"code","0daf1eb9":"code","9ed31c56":"code","5d819674":"code","fd45cc10":"code","fa0086ab":"code","c62d5f06":"code","37d47fa6":"code","a088a066":"code","6ded22a7":"code","1510306d":"code","ffadc7b5":"code","620edf8e":"code","65d89dd7":"code","172da481":"code","da107c9d":"code","745b20bf":"code","9109b728":"code","e8ec5cb1":"code","ee1c4bf6":"code","eb7e34ff":"code","a20b4664":"code","435b825f":"code","d9ead993":"code","9853630a":"code","42287892":"code","d71d7406":"code","ef817287":"code","0896c82b":"code","6aa52545":"code","e1133a48":"code","95c9fcbd":"code","aaed858c":"code","4a747171":"code","0f2877e6":"code","ea226c88":"code","15208b64":"code","f8b42fb0":"code","b03d495a":"code","dd6897a4":"code","2606c178":"code","4377f03c":"code","771c4e6f":"code","294519a6":"code","d6393655":"code","b2988459":"code","8e3a2ea9":"code","077a5663":"code","eb55dcbc":"code","75aca5c0":"code","4b7a7546":"code","be38e0f6":"code","a307f3da":"code","4d04a1fe":"code","428913e3":"code","6f4d0098":"code","aa54ca78":"code","ed132224":"code","0761e036":"code","e346bcce":"code","8fd7519f":"code","d63fcaca":"code","efea3ea3":"code","db1c4c1f":"code","8b784a0a":"code","a5f438b0":"code","5a42f56c":"code","7142853f":"code","548eac8e":"code","8777ff0f":"code","c0cfb145":"code","a0df89f2":"code","4a5b2656":"code","8d3fed86":"code","fbe2e135":"code","21d0219e":"code","c90d95ec":"code","17f8065b":"code","62860481":"code","4e11ae15":"code","33312abb":"code","e5439f86":"code","6f11469b":"code","2a19a08b":"code","2e1ede97":"code","c35264e4":"code","b795240b":"code","247617c5":"code","a8add17c":"code","edec8dd5":"code","8577e38e":"code","fb9ee708":"code","04faa778":"markdown","c9ff1821":"markdown","f15785ee":"markdown","28faf138":"markdown","a376a243":"markdown","8b80dc65":"markdown","e3af9269":"markdown","9c5d7339":"markdown","f26aef73":"markdown","4c087535":"markdown","b069dfc7":"markdown","1831f5d3":"markdown","e5677f23":"markdown","5248d3d7":"markdown","3da37b11":"markdown","a433db7c":"markdown","d7d09d4a":"markdown","b3098f8c":"markdown"},"source":{"3fd594c0":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport lightgbm as lgbm\nimport xgboost as xgb\nimport catboost as cat\n\nfrom sklearn.metrics import r2_score, mean_absolute_error, mean_squared_error\nfrom sklearn.preprocessing import StandardScaler, RobustScaler, LabelEncoder, PowerTransformer, OneHotEncoder, StandardScaler\nfrom sklearn.ensemble import GradientBoostingRegressor, StackingRegressor, RandomForestRegressor\nfrom sklearn.linear_model import Lasso, Ridge, SGDRegressor, ElasticNetCV, LassoCV, RidgeCV\nfrom sklearn.model_selection import KFold, cross_val_score, GridSearchCV, train_test_split\nfrom sklearn.pipeline import make_pipeline\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\n%matplotlib inline","324f75ef":"from IPython.display import display\npd.options.display.max_columns = None","ee53f5af":"train = pd.read_csv('..\/input\/house-prices-advanced-regression-techniques\/train.csv')\ntest = pd.read_csv('..\/input\/house-prices-advanced-regression-techniques\/test.csv')","73bd8e90":"test_ID = test['Id']","ff3ba651":"train.head(5)","f450cc18":"train.shape","12a7135a":"train_missing = train.isnull().sum().sort_values(ascending=False)\ntrain_missing.head(20)","f750c386":"train['MiscFeature'].fillna('None', inplace=True)\ntrain['Fence'].fillna('No Fence', inplace=True)\ntrain['PoolQC'].fillna('No Pool', inplace=True)\ntrain['Alley'].fillna('No alley access', inplace=True)\ntrain['FireplaceQu'].fillna('No Fireplace', inplace=True)\ntrain['LotFrontage'].fillna(train['LotFrontage'].median(), inplace=True)\ntrain['GarageCond'].fillna('No Garage', inplace=True)\ntrain['GarageType'].fillna('No Garage', inplace=True)\ntrain['GarageYrBlt'].fillna(round(train['GarageYrBlt'].median(), 1), inplace=True)\ntrain['GarageFinish'].fillna('No Garage', inplace=True)\ntrain['GarageQual'].fillna('No Garage', inplace=True)\ntrain['BsmtExposure'].fillna('No Basement', inplace=True)\ntrain['BsmtFinType2'].fillna('No Basement', inplace=True)\ntrain['BsmtFinType1'].fillna('No Basement', inplace=True)\ntrain['BsmtCond'].fillna('No Basement', inplace=True)\ntrain['BsmtQual'].fillna('No Basement', inplace=True)\ntrain['MasVnrArea'].fillna(0.0, inplace=True)\ntrain['MasVnrType'].fillna('None', inplace=True)\ntrain['Electrical'].fillna('Mixed', inplace=True)","89d2ff25":"plt.subplots(figsize = (30,20))\n\nmask = np.zeros_like(train.corr(), dtype=np.bool)\nmask[np.triu_indices_from(mask)] = True\n\nsns.heatmap(train.corr(), \n            cmap=sns.diverging_palette(20, 220, n=200), \n            mask = mask, \n            annot=True, \n            center = 0, \n);\n\nplt.title(\"Heatmap of all the Features\", fontsize=30);","a8b59f37":"plt.figure(figsize=(5,20))\nsns.heatmap(train.corr()[['SalePrice']].sort_values(by=['SalePrice'],ascending=False).head(50), vmin=-1, annot=True);","4bfdaac3":"best_columns = ['OverallQual', 'GrLivArea', 'GarageCars', 'GarageArea',\\\n               'TotalBsmtSF', '1stFlrSF', 'FullBath', 'TotRmsAbvGrd', \\\n               'YearBuilt', 'YearRemodAdd', 'MasVnrArea', 'Fireplaces', \\\n               'BsmtFinSF1', 'LotFrontage', 'WoodDeckSF', '2ndFlrSF', 'OpenPorchSF']","3195e6a2":"train.info()","54bc60d3":"test.head(5)","d2bf929e":"test.shape","91e1e9c2":"test.info()","9280f28a":"test_missing = test.isnull().sum().sort_values(ascending=False)\ntest_missing.head(35)","95ec86f2":"test['MiscFeature'].fillna('None', inplace=True)\ntest['Fence'].fillna('No Fence', inplace=True)\ntest['PoolQC'].fillna('No Pool', inplace=True)\ntest['Alley'].fillna('No alley access', inplace=True)\ntest['FireplaceQu'].fillna('No Fireplace', inplace=True)\ntest['LotFrontage'].fillna(train['LotFrontage'].median(), inplace=True)\ntest['GarageCond'].fillna('No Garage', inplace=True)\ntest['GarageType'].fillna('No Garage', inplace=True)\ntest['GarageYrBlt'].fillna(round(test['GarageYrBlt'].median(), 1), inplace=True)\ntest['GarageFinish'].fillna('No Garage', inplace=True)\ntest['GarageQual'].fillna('No Garage', inplace=True)\ntest['BsmtExposure'].fillna('No Basement', inplace=True)\ntest['BsmtFinType2'].fillna('No Basement', inplace=True)\ntest['BsmtFinType1'].fillna('No Basement', inplace=True)\ntest['BsmtCond'].fillna('No Basement', inplace=True)\ntest['BsmtQual'].fillna('No Basement', inplace=True)\ntest['MasVnrArea'].fillna(0.0, inplace=True)\ntest['MasVnrType'].fillna('None', inplace=True)\ntest['MSZoning'].fillna('RL', inplace=True)\ntest['Utilities'].fillna('AllPub', inplace=True)\ntest['Functional'].fillna('Typ', inplace=True)\ntest['BsmtFullBath'].fillna(0.0, inplace=True)\ntest['BsmtHalfBath'].fillna(0.0, inplace=True)\ntest['BsmtFinSF2'].fillna(0.0, inplace=True)\ntest['BsmtUnfSF'].fillna(0.0, inplace=True)\ntest['TotalBsmtSF'].fillna(test['TotalBsmtSF'].median(), inplace=True)\ntest['SaleType'].fillna('WD', inplace=True)\ntest['BsmtFinSF1'].fillna(0.0, inplace=True)\ntest['GarageCars'].fillna(2.0, inplace=True)\ntest['GarageArea'].fillna(0.0, inplace=True)\ntest['KitchenQual'].fillna('TA', inplace=True)\ntest['Exterior1st'].fillna('VinylSd', inplace=True)\ntest['Exterior2nd'].fillna('VinylSd', inplace=True)","0daf1eb9":"train_test = pd.concat([train,test], axis=0, sort=False)","9ed31c56":"train_test.sample(10)","5d819674":"train.drop(['Id', 'Utilities', 'Street', 'LowQualFinSF', 'PoolArea'], axis=1, inplace=True)\ntest.drop(['Id', 'Utilities', 'Street', 'LowQualFinSF', 'PoolArea'], axis=1, inplace=True)\ntrain_test.drop(['Id', 'Utilities', 'Street', 'LowQualFinSF', 'PoolArea'], axis=1, inplace=True)","fd45cc10":"train['MSSubClass'] = train['MSSubClass'].apply(str)\ntrain['OverallCond'] = train['OverallCond'].astype(str)\ntrain['YrSold'] = train['YrSold'].astype(str)\ntrain['MoSold'] = train['MoSold'].astype(str)\n#train['GarageYrBlt'] = train['GarageYrBlt'].astype(str)\n\ntest['MSSubClass'] = test['MSSubClass'].apply(str)\ntest['OverallCond'] = test['OverallCond'].astype(str)\ntest['YrSold'] = test['YrSold'].astype(str)\ntest['MoSold'] = test['MoSold'].astype(str)\n#test['GarageYrBlt'] = test['GarageYrBlt'].astype(str)\n\ntrain_test['MSSubClass'] = train_test['MSSubClass'].apply(str)\ntrain_test['OverallCond'] = train_test['OverallCond'].astype(str)\ntrain_test['YrSold'] = train_test['YrSold'].astype(str)\ntrain_test['MoSold'] = train_test['MoSold'].astype(str)\n#train_test['GarageYrBlt'] = train_test['GarageYrBlt'].astype(str)","fa0086ab":"train_test.head()","c62d5f06":"columns = train.columns","37d47fa6":"columns","a088a066":"numeric = ['LotFrontage', \n           'LotArea',  \n           'YearBuilt', \n           'YearRemodAdd',\n           'MasVnrArea', \n           'BsmtFinSF1', \n           'BsmtFinSF2', \n           'BsmtUnfSF', \n           'TotalBsmtSF',\n           '1stFlrSF', \n           '2ndFlrSF', \n           'GrLivArea',  \n           'GarageArea', \n           'WoodDeckSF', \n           'OpenPorchSF',\n           'EnclosedPorch', \n           '3SsnPorch', \n           'ScreenPorch', \n           'MiscVal', \n           'GarageYrBlt']","6ded22a7":"categorical = set(columns) - set(numeric)","1510306d":"sns.set_style('whitegrid')","ffadc7b5":"def num_plot(data):\n    for col in numeric:\n        if col != 'SalePrice':\n            print(col)\n            print(data[col].dtype)\n    \n            plt.figure(figsize=(10, 10))\n            ax = sns.scatterplot(x=col, y='SalePrice', data=data)\n            plt.show();","620edf8e":"num_plot(train)","65d89dd7":"def cat_plot(data):\n    for col in categorical:\n        if col != 'SalePrice':\n            print(col)\n            print(data[col].dtype)\n    \n            ax = sns.catplot(x=col, y='SalePrice', data=data, size=10)\n            plt.show();","172da481":"cat_plot(train)","da107c9d":"train.drop(['PoolQC', 'Condition2'], axis=1, inplace=True)\ntest.drop(['PoolQC', 'Condition2'], axis=1, inplace=True)\ntrain_test.drop(['PoolQC', 'Condition2'], axis=1, inplace=True)","745b20bf":"categorical.remove('PoolQC')\ncategorical.remove('Condition2')\ncategorical.remove('SalePrice')","9109b728":"LE = LabelEncoder()","e8ec5cb1":"for col in categorical:\n    train[col] = LE.fit_transform(train[col])","ee1c4bf6":"train.head()","eb7e34ff":"rf_clf = RandomForestRegressor(random_state=42, n_estimators=500, max_depth=8, criterion='mse')","a20b4664":"%time rf_clf.fit(train.drop(['SalePrice'], axis=1), train['SalePrice'])","435b825f":"%time cross_val_score(rf_clf, train.drop(['SalePrice'], axis=1), train['SalePrice'], cv=5)","d9ead993":"importances = rf_clf.feature_importances_\nstd = np.std([tree.feature_importances_ for tree in rf_clf.estimators_], axis=0)\nindices = np.argsort(importances)[::-1]\n\nprint(\"Feature ranking:\")\n\nfor f in range(train.shape[1] - 1):\n    print(\"%d. %s -- feature %d (%f)\" % (f + 1, train.columns[indices[f]], indices[f], importances[indices[f]]))\n\nplt.figure(figsize=(18, 12))\nplt.title(\"Feature importances\")\nplt.bar(range(train.drop(['SalePrice'], axis=1).shape[1]), importances[indices],\n       yerr=std[indices], align=\"center\")\nplt.xticks(range(train.shape[1]), indices)\nplt.xlim([-1, train.shape[1]])\nplt.show()","9853630a":"indices[:40]","42287892":"columns_to_models = train.columns[indices[:40]]","d71d7406":"columns_to_models = list(columns_to_models)","ef817287":"columns_to_models.append('SalePrice')","0896c82b":"columns_to_models","6aa52545":"train_test = train_test[columns_to_models]","e1133a48":"train_test.shape","95c9fcbd":"train_test.head()","aaed858c":"scaler = StandardScaler()","4a747171":"new_numeric = []\n\nfor col in numeric:\n    if col in columns_to_models:\n        new_numeric.append(col)","0f2877e6":"new_numeric","ea226c88":"new_cat = []\n\nfor col in categorical:\n    if col in columns_to_models:\n        new_cat.append(col)","15208b64":"new_cat","f8b42fb0":"train_test[new_numeric] = scaler.fit_transform(train_test[new_numeric])","b03d495a":"train_test.head()","dd6897a4":"for col in new_cat:\n    if col != 'SalePrice':\n        train_test[col] = LE.fit_transform(train_test[col])","2606c178":"train_test.head()","4377f03c":"train_test_lin = train_test.copy()","771c4e6f":"train_test_lin = pd.concat([train_test_lin, \n                     pd.get_dummies(train_test_lin['BedroomAbvGr'], prefix='BedroomAbvGr', drop_first=True),\n                     pd.get_dummies(train_test_lin['GarageFinish'], prefix='GarageFinish', drop_first=True), \n                     pd.get_dummies(train_test_lin['BsmtQual'], prefix='BsmtQual', drop_first=True),\n                     pd.get_dummies(train_test_lin['HalfBath'], prefix='HalfBath', drop_first=True),\n                     pd.get_dummies(train_test_lin['MoSold'], prefix='MoSold', drop_first=True), \n                     pd.get_dummies(train_test_lin['SaleCondition'], prefix='SaleCondition', drop_first=True),\n                     pd.get_dummies(train_test_lin['BsmtFinType1'], prefix='BsmtFinType1', drop_first=True),\n                     pd.get_dummies(train_test_lin['KitchenQual'], prefix='KitchenQual', drop_first=True),\n                     pd.get_dummies(train_test_lin['OverallQual'], prefix='OverallQual', drop_first=True),\n                     pd.get_dummies(train_test_lin['LandContour'], prefix='LandContour', drop_first=True),\n                     pd.get_dummies(train_test_lin['TotRmsAbvGrd'], prefix='TotRmsAbvGrd', drop_first=True),\n                     pd.get_dummies(train_test_lin['ExterQual'], prefix='ExterQual', drop_first=True),\n                     pd.get_dummies(train_test_lin['Exterior2nd'], prefix='Exterior2nd', drop_first=True),\n                     pd.get_dummies(train_test_lin['OverallCond'], prefix='OverallCond', drop_first=True),   \n                     pd.get_dummies(train_test_lin['GarageType'], prefix='GarageType', drop_first=True),\n                     pd.get_dummies(train_test_lin['Fireplaces'], prefix='Fireplaces', drop_first=True),\n                     pd.get_dummies(train_test_lin['CentralAir'], prefix='CentralAir', drop_first=True),\n                     pd.get_dummies(train_test_lin['LotShape'], prefix='LotShape', drop_first=True),   \n                     pd.get_dummies(train_test_lin['Exterior1st'], prefix='Exterior1st', drop_first=True),\n                     pd.get_dummies(train_test_lin['BsmtExposure'], prefix='BsmtExposure', drop_first=True),\n                     pd.get_dummies(train_test_lin['Neighborhood'], prefix='Neighborhood', drop_first=True),   \n                     pd.get_dummies(train_test_lin['FullBath'], prefix='FullBath', drop_first=True),         \n                     pd.get_dummies(train_test_lin['GarageCars'], prefix='GarageCars', drop_first=True),         \n                     pd.get_dummies(train_test_lin['MSZoning'], prefix='MSZoning', drop_first=True)\n                       ],\n                    axis=1)","294519a6":"train_test_lin.drop(new_cat, axis=1, inplace=True)","d6393655":"train_test.sample(10)","b2988459":"train_test_lin.sample(10)","8e3a2ea9":"train_test.shape, train_test_lin.shape","077a5663":"train_to_model = train_test[train_test['SalePrice'].isna() == False]\ntest_to_model = train_test[train_test['SalePrice'].isna() == True]\ntrain_to_model_lin = train_test_lin[train_test_lin['SalePrice'].isna() == False]\ntest_to_model_lin = train_test_lin[train_test_lin['SalePrice'].isna() == True]","eb55dcbc":"train_to_model.head()","75aca5c0":"test_to_model.head()","4b7a7546":"train_to_model_lin.head()","be38e0f6":"test_to_model_lin.head()","a307f3da":"test_to_model.drop(['SalePrice'], axis=1, inplace=True)\ntest_to_model_lin.drop(['SalePrice'], axis=1, inplace=True)","4d04a1fe":"train_to_model.shape, test_to_model.shape, train_to_model_lin.shape, test_to_model_lin.shape","428913e3":"X_train, X_test, y_train, y_test = train_test_split(train_to_model.drop(['SalePrice'], axis=1), \\\n                                                    train_to_model['SalePrice'], test_size=0.1, random_state=42)","6f4d0098":"X_train_lin, X_test_lin, y_train_lin, y_test_lin = train_test_split(train_to_model_lin.drop(['SalePrice'], axis=1), \\\n                                                    train_to_model_lin['SalePrice'], test_size=0.1, random_state=42)","aa54ca78":"print('X_train shape :', X_train.shape)\nprint('X_test shape :', X_test.shape)\nprint('y_train shape :', y_train.shape)\nprint('y_test shape :', y_test.shape)","ed132224":"print('X_train_lin shape :', X_train_lin.shape)\nprint('X_test_lin shape :', X_test_lin.shape)\nprint('y_train_lin shape :', y_train_lin.shape)\nprint('y_test_lin shape :', y_test_lin.shape)","0761e036":"kfolds = KFold(n_splits=10, shuffle=True, random_state=42)","e346bcce":"%%time\nlgb_reg = lgbm.LGBMRegressor(objective='regression', learning_rate=0.01, n_estimators=100, n_jobs=-1, subsample=0.5)\nlgb_param_grid = {\"learning_rate\":[0.1, 0.01, 0.001],\n                   \"n_estimators\":[250, 500, 750, 1000],\n                  \"subsample\":[0.3, 0.4, 0.5, 0.6],\n                   \"max_depth\":[4, 5, 6, 7]\n                  }\n                  \ngrid_search = GridSearchCV(lgb_reg, param_grid=lgb_param_grid, cv=kfolds, scoring=\"neg_mean_squared_error\", n_jobs=-1, verbose=1)\ngrid_search.fit(X_train, y_train)\n\nlgb_reg = grid_search.best_estimator_\nprint(grid_search.best_params_)\n\ny_pred = lgb_reg.predict(X_test)\n\nprint('-' * 10 + 'LGBM' + '-' * 10)\nprint('R square Accuracy: ', r2_score(y_test, y_pred))\nprint('Mean Absolute Error: ', mean_absolute_error(y_test, y_pred))\nprint('Mean Squared Error: ', mean_squared_error(y_test, y_pred))","8fd7519f":"%%time\nxgb_reg = xgb.XGBRegressor(learning_rate=0.01, n_estimators=100, n_jobs=-1, booster='gbtree', random_state=42, subsample=0.5)\nxgb_param_grid = {\"learning_rate\":[0.1, 0.01, 0.001],\n                   \"n_estimators\":[250, 500, 750, 1000],\n                  \"subsample\":[0.3, 0.4, 0.5, 0.6],\n                   \"max_depth\":[4, 5, 6, 7]\n                  }\n                  \ngrid_search = GridSearchCV(xgb_reg, param_grid=xgb_param_grid, cv=kfolds, scoring=\"neg_mean_squared_error\", n_jobs=-1, verbose=1)\ngrid_search.fit(X_train, y_train)\n\nxgb_reg = grid_search.best_estimator_\nprint(grid_search.best_params_)\n\ny_pred = xgb_reg.predict(X_test)\n\nprint('-' * 10 + 'XGB' + '-' * 10)\nprint('R square Accuracy: ', r2_score(y_test, y_pred))\nprint('Mean Absolute Error: ', mean_absolute_error(y_test, y_pred))\nprint('Mean Squared Error: ', mean_squared_error(y_test, y_pred))","d63fcaca":"%%time\ncat_reg = cat.CatBoostRegressor(learning_rate=0.01, n_estimators=100, objective='RMSE', loss_function='R2', random_state=42, subsample=0.5)\ncat_param_grid = {\"learning_rate\":[0.1, 0.01, 0.001],\n                   \"n_estimators\":[250, 500, 750, 1000],\n                  \"subsample\":[0.3, 0.4, 0.5, 0.6],\n                   \"max_depth\":[4, 5, 6, 7]\n                  }\n                  \ngrid_search = GridSearchCV(cat_reg, param_grid=cat_param_grid, cv=kfolds, scoring=\"neg_mean_squared_error\", n_jobs=-1, verbose=1)\ngrid_search.fit(X_train, y_train)\n\ncat_reg = grid_search.best_estimator_\nprint(grid_search.best_params_)\n\ny_pred = cat_reg.predict(X_test)\n\nprint('-' * 10 + 'CatBoost' + '-' * 10)\nprint('R square Accuracy: ', r2_score(y_test, y_pred))\nprint('Mean Absolute Error: ', mean_absolute_error(y_test, y_pred))\nprint('Mean Squared Error: ', mean_squared_error(y_test, y_pred))","efea3ea3":"%%time\ngb_reg = GradientBoostingRegressor(n_estimators=100, learning_rate=0.01, random_state=42, subsample=0.5)\ngbdt_param_grid = {\"learning_rate\":[0.1, 0.01, 0.001],\n                   \"n_estimators\":[250, 500, 750, 1000],\n                  \"subsample\":[0.3, 0.4, 0.5, 0.6],\n                   \"max_depth\":[4, 5, 6, 7]\n                  }\n\n                  \ngrid_search = GridSearchCV(gb_reg, param_grid=gbdt_param_grid, cv=kfolds, scoring=\"neg_mean_squared_error\", n_jobs=-1, verbose=1)\ngrid_search.fit(X_train, y_train)\n\ngb_reg = grid_search.best_estimator_\nprint(grid_search.best_params_)\n\ny_pred = gb_reg.predict(X_test)\n\nprint('-' * 10 + 'GBM' + '-' * 10)\nprint('R square Accuracy: ', r2_score(y_test, y_pred))\nprint('Mean Absolute Error: ', mean_absolute_error(y_test, y_pred))\nprint('Mean Squared Error: ', mean_squared_error(y_test, y_pred))","db1c4c1f":"alphas = [1e-9, 1e-8, 1e-7, 1e-6, 1e-5, 1e-4, 1e-3, 1e-2, 1e-1, 0.1, 1, 10]\n\nridgecv_reg = make_pipeline(RidgeCV(alphas=alphas, cv=kfolds))\nridgecv_reg.fit(X_train_lin, y_train_lin)\ny_pred = ridgecv_reg.predict(X_test_lin)\n\nprint('-' * 10 + 'RidgeCV' + '-' * 10)\nprint('R square: ', r2_score(y_test_lin, y_pred))\nprint('Mean Absolute Error: ', mean_absolute_error(y_test_lin, y_pred))\nprint('Mean Squared Error: ', mean_squared_error(y_test_lin, y_pred))","8b784a0a":"lassocv_reg = make_pipeline(LassoCV(alphas=alphas, cv=kfolds))\nlassocv_reg.fit(X_train_lin, y_train_lin)\ny_pred = lassocv_reg.predict(X_test_lin)\n\nprint('-' * 10 + 'LassoCV' + '-' * 10)\nprint('R square: ', r2_score(y_test_lin, y_pred))\nprint('Mean Absolute Error: ', mean_absolute_error(y_test_lin, y_pred))\nprint('Mean Squared Error: ', mean_squared_error(y_test_lin, y_pred))","a5f438b0":"alphas = [0.0001, 0.0002, 0.0003, 0.0004, 0.0005, 0.0006, 0.0007, 0.0008, 0.0009, 0.001]\nl1ratio = [0.8, 0.83, 0.85, 0.87, 0.9, 0.92, 0.95, 0.97, 0.99, 1]\n\nelasticv_reg = make_pipeline(ElasticNetCV(alphas=alphas, cv=kfolds, l1_ratio=l1ratio))\nelasticv_reg.fit(X_train_lin, y_train_lin)\ny_pred = elasticv_reg.predict(X_test_lin)\n\nprint('-' * 10 + 'ElasticNetCV' + '-' * 10)\nprint('R square: ', r2_score(y_test_lin, y_pred))\nprint('Mean Absolute Error: ', mean_absolute_error(y_test_lin, y_pred))\nprint('Mean Squared Error: ', mean_squared_error(y_test_lin, y_pred))","5a42f56c":"ensemble = lgb_reg.predict(test_to_model) * 0.2 + xgb_reg.predict(test_to_model) * 0.2 + cat_reg.predict(test_to_model) * 0.2 \\\n            + gb_reg.predict(test_to_model) * 0.2 + lassocv_reg.predict(test_to_model_lin) * 0.05 + \\\n            ridgecv_reg.predict(test_to_model_lin) * 0.05 + elasticv_reg.predict(test_to_model_lin) * 0.1","7142853f":"ensemble[:10]","548eac8e":"#sub = pd.DataFrame()\n#sub['Id'] = test_ID\n#sub['SalePrice'] = ensemble\n#sub.to_csv('submission_blend_free.csv',index=False)","8777ff0f":"import keras\nfrom keras import models, layers, regularizers","c0cfb145":"model = models.Sequential()\nmodel.add(layers.Dense(256, activation='relu', input_shape=(X_train.shape[1],)))\n#model.add(layers.Dropout(0.5))\n#model.add(layers.Dense(256, activation='relu'))\nmodel.add(layers.Dense(256, activation='relu'))\nmodel.add(layers.Dense(1))\n    \noptimizer = keras.optimizers.RMSprop(0.001)\n    \nmodel.compile(optimizer=optimizer,\n              loss='mae',\n              metrics=['mae', 'mse'])","a0df89f2":"model.summary()","4a5b2656":"history = model.fit(X_train, y_train,\n                   epochs=250,\n                   batch_size=5,\n                   validation_data=(X_test, y_test))","8d3fed86":"import matplotlib.pyplot as plt\n\nmae = history.history['mae']\nval_mae = history.history['val_mae']\n\nepochs = range(1, len(mae) + 1)\n\nplt.figure(figsize=(12, 12))\nplt.plot(epochs[20:], mae[20:], 'bo', label='Training mae')\nplt.plot(epochs[20:], val_mae[20:], 'b', label='Validation mae')\nplt.title('Training and validation mae')\nplt.grid(True)\nplt.xlabel('Epochs')\nplt.ylabel('Loss')\nplt.legend()\nplt.show()","fbe2e135":"test_predictions = model.predict(X_test).flatten()\n\nplt.figure(figsize=(10, 10))\nplt.scatter(y_test, test_predictions)\nplt.xlabel('True Values')\nplt.ylabel('Predictions')\nplt.axis('equal')\nplt.axis('square')\nplt.xlim([0,plt.xlim()[1]])\nplt.ylim([0,plt.ylim()[1]])\n_ = plt.plot([-1000000, 1000000], [-1000000, 1000000])","21d0219e":"y_pred = model.predict(X_test)\n\nprint('-' * 10 + 'NN' + '-' * 10)\nprint('R square Accuracy: ', r2_score(y_test, y_pred))\nprint('Mean Absolute Error: ', mean_absolute_error(y_test, y_pred))\nprint('Mean Squared Error: ', mean_squared_error(y_test, y_pred))","c90d95ec":"model = models.Sequential()\nmodel.add(layers.Dense(256, activation='relu', input_shape=(X_train.shape[1],)))\n#model.add(layers.Dropout(0.5))\n#model.add(layers.Dense(256, activation='relu'))\nmodel.add(layers.Dense(256, activation='relu'))\nmodel.add(layers.Dense(1))\n    \noptimizer = keras.optimizers.RMSprop(0.001)\n    \nmodel.compile(optimizer=optimizer,\n              loss='mae',\n              metrics=['mae', 'mse'])","17f8065b":"history = model.fit(train_to_model.drop(['SalePrice'], axis=1), train_to_model['SalePrice'],\n                   epochs=300,\n                   batch_size=5,\n                   validation_split=0.05)","62860481":"mae = history.history['mae']\nval_mae = history.history['val_mae']\n\nepochs = range(1, len(mae) + 1)\n\nplt.figure(figsize=(12, 12))\nplt.plot(epochs[20:], mae[20:], 'bo', label='Training mae')\nplt.plot(epochs[20:], val_mae[20:], 'b', label='Validation mae')\nplt.title('Training and validation mae')\nplt.grid(True)\nplt.xlabel('Epochs')\nplt.ylabel('Loss')\nplt.legend()\nplt.show()","4e11ae15":"y_pred_model = model.predict(test_to_model)","33312abb":"model_pred = []\n\nfor pred in range(len(y_pred_model.tolist())):\n    model_pred.append(y_pred_model.tolist()[pred][0])","e5439f86":"model_pred[:10]","6f11469b":"ensemble[:10]","2a19a08b":"sub = pd.DataFrame()\nsub['Id'] = test_ID\nsub['SalePrice'] = model_pred\nsub.to_csv('submission_NN.csv',index=False)","2e1ede97":"model_pred = np.array(model_pred)\nmodel_pred","c35264e4":"final_blend = ensemble * 0.3 + model_pred * 0.7","b795240b":"final_blend[:10]","247617c5":"sub = pd.DataFrame()\nsub['Id'] = test_ID\nsub['SalePrice'] = final_blend\nsub.to_csv('submission_blend_NN7.csv',index=False)","a8add17c":"final_blend = ensemble * 0.4 + model_pred * 0.6\nsub = pd.DataFrame()\nsub['Id'] = test_ID\nsub['SalePrice'] = final_blend\nsub.to_csv('submission_blend_NN6.csv',index=False)","edec8dd5":"final_blend = ensemble * 0.5 + model_pred * 0.5\nsub = pd.DataFrame()\nsub['Id'] = test_ID\nsub['SalePrice'] = final_blend\nsub.to_csv('submission_blend_NN5.csv',index=False)","8577e38e":"final_blend = ensemble * 0.6 + model_pred * 0.4\nsub = pd.DataFrame()\nsub['Id'] = test_ID\nsub['SalePrice'] = final_blend\nsub.to_csv('submission_blend_NN4.csv',index=False)","fb9ee708":"final_blend = ensemble * 0.2 + model_pred * 0.8\nsub = pd.DataFrame()\nsub['Id'] = test_ID\nsub['SalePrice'] = final_blend\nsub.to_csv('submission_blend_NN8.csv',index=False)","04faa778":"## 1. Download the data and explore","c9ff1821":"**Simple keras NN**","f15785ee":"Correlation","28faf138":"**Scaling and dummy encoding**","a376a243":"**Concatenate train and test**","8b80dc65":"Drop noisy features","e3af9269":"Drop irrelevant features","9c5d7339":"Some feature have wrong format","f26aef73":"Correlation more than 0.3","4c087535":"Final prediction + blending","b069dfc7":"**Let's look at the data - samples, missing values, info, correlation**","1831f5d3":"## 2. EDA and preprocessing","e5677f23":"## 3. Check feature importance on RandomForestRegressor and final preparation","5248d3d7":"Leave first 40 features","3da37b11":"### Data describtion:\n\n- MSSubClass: Identifies the type of dwelling involved in the sale.\n- MSZoning: Identifies the general zoning classification of the sale.\n- LotFrontage: Linear feet of street connected to property.\n- LotArea: Lot size in square feet.\n- Street: Type of road access to property.\n- Alley: Type of alley access to property.\n- LotShape: General shape of property.\n- LandContour: Flatness of the property.\n- Utilities: Type of utilities available.\n- LotConfig: Lot configuration.\n- LandSlope: Slope of property.\n- Neighborhood: Physical locations within Ames city limits.\n- Condition1: Proximity to various conditions.\n- Condition2: Proximity to various conditions (if more than one is present).\n- BldgType: Type of dwelling.\n- HouseStyle: Style of dwelling.\n- OverallQual: Rates the overall material and finish of the house.\n- OverallCond: Rates the overall condition of the house.\n- YearBuilt: Original construction date.\n- YearRemodAdd: Remodel date (same as construction date if no remodeling or additions).\n- RoofStyle: Type of roof.\n- RoofMatl: Roof material.\n- Exterior1st: Exterior covering on house.\n- Exterior2nd: Exterior covering on house (if more than one material).\n- MasVnrType: Masonry veneer type **(None - None)**.\n- MasVnrArea: Masonry veneer area in square feet.\n- ExterQual: Evaluates the quality of the material on the exterior\/\n- ExterCond: Evaluates the present condition of the material on the exterior.\n- Foundation: Type of foundation.\n- BsmtQual: Evaluates the height of the basement **(NA - No Basement)**.\n- BsmtCond: Evaluates the general condition of the basement **(NA - No Basement)**.\n- BsmtExposure: Refers to walkout or garden level walls **(NA - No Basement)**.\n- BsmtFinType1: Rating of basement finished area **(NA - No Basement)**.\n- BsmtFinSF1: Type 1 finished square feet.\n- BsmtFinType2: Rating of basement finished area (if multiple types) **(NA - No Basement)**.\n- BsmtFinSF2: Type 2 finished square feet.\n- BsmtUnfSF: Unfinished square feet of basement area.\n- TotalBsmtSF: Total square feet of basement area.\n- Heating: Type of heating.\n- HeatingQC: Heating quality and condition.\n- CentralAir: Central air conditioning.\n- Electrical: Electrical system.\n- 1stFlrSF: First Floor square feet.\n- 2ndFlrSF: Second floor square feet.\n- LowQualFinSF: Low quality finished square feet (all floors).\n- GrLivArea: Above grade (ground) living area square feet.\n- BsmtFullBath: Basement full bathrooms.\n- BsmtHalfBath: Basement half bathrooms.\n- FullBath: Full bathrooms above grade.\n- HalfBath: Half baths above grade.\n- Bedroom: Bedrooms above grade (does NOT include basement bedrooms).\n- Kitchen: Kitchens above grade.\n- KitchenQual: Kitchen quality.\n- TotRmsAbvGrd: Total rooms above grade (does not include bathrooms).\n- Functional: Home functionality (Assume typical unless deductions are warranted).\n- Fireplaces: Number of fireplaces.\n- FireplaceQu: Fireplace quality **(NA - No Fireplace)**.\n- GarageType: Garage location **(NA - No Garage)**.\n- GarageYrBlt: Year garage was built.\n- GarageFinish: Interior finish of the garage **(NA - No Garage)**.\n- GarageCars: Size of garage in car capacity.\n- GarageArea: Size of garage in square feet.\n- GarageQual: Garage quality **(NA - No Garage)**.\n- GarageCond: Garage condition **(NA - No Garage)**.\n- PavedDrive: Paved driveway.\n- WoodDeckSF: Wood deck area in square feet.\n- OpenPorchSF: Open porch area in square feet.\n- EnclosedPorch: Enclosed porch area in square feet.\n- 3SsnPorch: Three season porch area in square feet.\n- ScreenPorch: Screen porch area in square feet.\n- PoolArea: Pool area in square feet.\n- PoolQC: Pool quality **(NA - No Pool)**.\n- Fence: Fence quality **(NA - No Fence)**.\n- MiscFeature: Miscellaneous feature not covered in other categories **(NA - None)**.\n- MiscVal: Value of miscellaneous feature.\n- MoSold: Month Sold (MM).\n- YrSold: Year Sold (YYYY).\n- SaleType: Type of sale.\n- SaleCondition: Condition of sale.","a433db7c":"Fill in missing values","d7d09d4a":"**SPLIT THE DATA FOR LINEAR MODEL AND BOOSTS + NN**","b3098f8c":"## 4. Modeling"}}