{"cell_type":{"92ba63fa":"code","c187a86c":"code","46a0bda9":"code","874afc8b":"code","de7abfeb":"code","b0adbf83":"code","d5dd746d":"code","b32f85b3":"code","63b6ed5e":"code","3d12445b":"code","61663391":"code","35344b08":"code","8b15cf69":"markdown","d3bd3594":"markdown","d453d2c3":"markdown","b448da87":"markdown","f142cba8":"markdown","a8ea6c84":"markdown"},"source":{"92ba63fa":"import numpy\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport math\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import LSTM\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.metrics import mean_squared_error\nimport tqdm\n# fix random seed for reproducibility\nnumpy.random.seed(7)\n","c187a86c":"# load the dataset\ndf = pd.read_csv('..\/input\/airline-datasets\/airline_passengers.csv', usecols=[1], engine='python', skipfooter=3)","46a0bda9":"data = df.values\ndata = data.astype('float32')","874afc8b":"# normalize the dataset\nscaler = MinMaxScaler(feature_range=(0, 1))\ndataset = scaler.fit_transform(data)\n\n# split into train and test sets\ntrain_size = int(len(dataset) * 0.67)\ntest_size = len(dataset) - train_size\ntrain, test = dataset[0:train_size,:], dataset[train_size:len(dataset),:]\n","de7abfeb":"# convert an array of values into a dataset matrix\ndef create_dataset(dataset, look_back=1):\n    dataX, dataY = [], []\n    for i in range(len(dataset)-look_back-1):\n        a = dataset[i:(i+look_back), 0]\n        dataX.append(a)\n        dataY.append(dataset[i + look_back, 0])\n    return numpy.array(dataX), numpy.array(dataY)\n","b0adbf83":"# reshape \nlook_back = 10\ntrainX, trainY = create_dataset(train, look_back)\ntestX, testY = create_dataset(test, look_back)\n\n# reshape input to be [samples, time steps, features]\ntrainX = numpy.reshape(trainX, (trainX.shape[0], trainX.shape[1], 1))\ntestX = numpy.reshape(testX, (testX.shape[0], testX.shape[1], 1))","d5dd746d":"# create and fit the LSTM network\nbatch_size = 1\nmodel = Sequential()\nmodel.add(LSTM(64, batch_input_shape=(batch_size, look_back, 1),stateful=True,return_sequences=True))\nmodel.add(LSTM(64, stateful=True))\nmodel.add(Dense(16, activation='relu'))\nmodel.add(Dense(1))\nmodel.compile(loss='mean_squared_error', optimizer='adam')\n\nprint (trainX.shape, trainY.shape)","b32f85b3":"\nfor i in tqdm.tqdm(range(20)):\n    model.fit(trainX, trainY, epochs=3, batch_size=batch_size, verbose=0, shuffle=False)\n    model.reset_states()","63b6ed5e":"# make predictions\ntrainPredict = model.predict(trainX, batch_size=batch_size)\nmodel.reset_states()\ntestPredict = model.predict(testX, batch_size=batch_size)\n\n# invert predictions\ntrainPredict = scaler.inverse_transform(trainPredict)\ntrainY = scaler.inverse_transform([trainY])\ntestPredict = scaler.inverse_transform(testPredict)\ntestY = scaler.inverse_transform([testY])\n","3d12445b":"# calculate root mean squared error\ntrainScore = math.sqrt(mean_squared_error(trainY[0], trainPredict[:,0]))\nprint('Train Score: %.2f RMSE' % (trainScore))\ntestScore = math.sqrt(mean_squared_error(testY[0], testPredict[:,0]))\nprint('Test Score: %.2f RMSE' % (testScore))","61663391":"# shift train predictions for plotting\ntrainPredictPlot = numpy.empty_like(dataset)\ntrainPredictPlot[:, :] = numpy.nan\ntrainPredictPlot[look_back:len(trainPredict)+look_back, :] = trainPredict\n","35344b08":"# shift test predictions for plotting\ntestPredictPlot = numpy.empty_like(dataset)\ntestPredictPlot[:, :] = numpy.nan\ntestPredictPlot[len(trainPredict)+(look_back*2)+1:len(dataset)-1, :] = testPredict\n\n\n# plot baseline and predictions\nplt.plot(scaler.inverse_transform(dataset))\nplt.plot(trainPredictPlot)\nplt.plot(testPredictPlot)\nplt.show()","8b15cf69":"# a) Write a simple function to convert the single column of data into a two-column dataset: the first column containing this month\u2019s (t) passenger count and the second column containing next month\u2019s (t+1) passenger count, to be predicted.","d3bd3594":"# b) Pre-process the dataset: - Normalize the dataset using the MinMaxScaler preprocessing class from the scikit-learn library. - Data split in train\/tes","d453d2c3":"## Time Series Prediction using LSTM: Use the given international airline passengers dataset problem. This is a problem where, given a year and a month, the task is to predict the number of international airline passengers in units of 1,000. The data ranges from January 1949 to December 1960, or 12 years, with 144 observations. We can phrase the problem as a regression problem. That is, given the number of passengers (in units of thousands) this month, what is the number of passengers next month? Perform the following.\n","b448da87":"# d) Train the network and perform hyper parameter tuning.","f142cba8":"# f) Plot the original dataset along with train and test predictions to get an idea of how the trained model performs","a8ea6c84":"# e) Evaluate the model."}}