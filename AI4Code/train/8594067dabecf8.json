{"cell_type":{"89d10d3a":"code","cde9db9d":"code","fd8cb20f":"code","a505b2a5":"code","c3e77d02":"code","bac346e1":"code","bafcd4ad":"code","53707992":"code","b55d4fb9":"code","473040b0":"code","a020c2bf":"code","9ce4b290":"code","08eaed97":"code","1e840d53":"code","d0e0d7df":"code","cdca84ee":"code","8e7a1ee0":"code","a8217ef6":"code","a8bee793":"code","03db0751":"code","8cd01d05":"code","5375f1be":"markdown","b73d25c8":"markdown","a4b7fd06":"markdown","499a2d7b":"markdown","107c256d":"markdown","e5b6f640":"markdown","5cb570a0":"markdown","b5eaab79":"markdown","ffa7b526":"markdown","7e32ecc3":"markdown","773aab9c":"markdown","a1290387":"markdown","4f709654":"markdown","e5e87b3f":"markdown","56838d06":"markdown","4923f3d1":"markdown","9a3242ee":"markdown","87e1886f":"markdown","f3863344":"markdown","d0741bfb":"markdown","fee85ed1":"markdown","206dc9b6":"markdown","b08b579e":"markdown","2c64e7de":"markdown","3bcf6199":"markdown","fb3147f5":"markdown","c23bc091":"markdown","d2c77040":"markdown","0a54479e":"markdown","3538f271":"markdown","3eb68d03":"markdown","f86acf73":"markdown","69484d40":"markdown","3c510324":"markdown","ca6346f5":"markdown"},"source":{"89d10d3a":"# import packages\nimport os, gc\nimport numpy as np\n\n# data manipulation\nimport pandas as pd\nimport pandas_profiling \n\n# visualization\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn import manifold\nimport cufflinks as cf\nimport plotly.offline\n\n# Settings\ncf.go_offline()\ncf.set_config_file(offline=False, world_readable=True)\nplt.style.use('fivethirtyeight')\nplt.show()\n\n%matplotlib inline\n\nos.listdir('..\/input\/lish-moa\/')","cde9db9d":"# root directory\nROOT = '..\/input\/lish-moa\/'\n\n# files\ntarget_scored = pd.read_csv(f'{ROOT}train_targets_scored.csv')\ntarget_nonscored = pd.read_csv(f'{ROOT}train_targets_nonscored.csv')\ntrain_features = pd.read_csv(f'{ROOT}train_features.csv')\ntest_features = pd.read_csv(f'{ROOT}test_features.csv')","fd8cb20f":"train_features.head()","a505b2a5":"print(f'We have {train_features.shape[0]} rows and {train_features.shape[1]} columns in train_features.')","c3e77d02":"target_scored.head()","bac346e1":"print(f'We have {target_scored.shape[0]} rows and {target_scored.shape[1]} columns in target_scored.')","bafcd4ad":"target_nonscored.head()","53707992":"print(f'We have {target_nonscored.shape[0]} rows and {target_nonscored.shape[1]} columns in target_nonscored.')","b55d4fb9":"test_features.head()","473040b0":"print(f'We have {test_features.shape[0]} rows and {test_features.shape[1]} columns in test_features.')","a020c2bf":"# missing values\nprint(f'We have {train_features.isnull().values.sum()} missing values in train data')\nprint(f'We have {test_features.isnull().values.sum()} missing values in test data')","9ce4b290":"f = plt.figure(figsize=(16, 6))\ngs = f.add_gridspec(1, 3)\n\nwith sns.axes_style(\"whitegrid\"):\n    ax = f.add_subplot(gs[0, 0])\n    sns.countplot(train_features['cp_type'], palette=\"Set3\")\n    plt.title(\"Treatment Type\")\n\nwith sns.axes_style(\"white\"):\n    ax = f.add_subplot(gs[0, 1])\n    sns.countplot(train_features['cp_dose'], palette=\"Set2\")\n    plt.title(\"Treatment Dose\")\n\nwith sns.axes_style(\"ticks\"):\n    ax = f.add_subplot(gs[0, 2])\n    sns.countplot(train_features['cp_time'], palette=\"ch:.25\")\n    plt.title(\"Treatment Time\")\n\nf.tight_layout()","08eaed97":"f = plt.figure(figsize=(16, 8))\n\nwith sns.axes_style(\"white\"):\n    for i in range(0,26):\n        sns.kdeplot(train_features.loc[:,f\"g-{i}\"], shade=True);\n        plt.title(\"Gene Distribution\")","1e840d53":"f = plt.figure(figsize=(20, 16))\n\nmask = np.triu(np.ones_like(train_features.loc[:,\"g-0\":\"g-771\"].corr(), dtype=bool))\ncmap = sns.diverging_palette(230, 20, as_cmap=True)\n\nwith sns.axes_style(\"white\"):\n    sns.heatmap(train_features.loc[:,\"g-0\":\"g-771\"].corr(), mask=mask, square=True, cmap=cmap);\n    plt.title(\"Gene Expression: Correlation\")","d0e0d7df":"f = plt.figure(figsize=(16, 8))\n\nwith sns.axes_style(\"white\"):\n    for i in range(0,26):\n        sns.kdeplot(train_features.loc[:,f\"c-{i}\"], shade=True);\n        plt.title(\"Cell Viability Distribution\")","cdca84ee":"f = plt.figure(figsize=(16, 10))\n\nmask = np.triu(np.ones_like(train_features.loc[:,\"c-0\":\"c-99\"].corr(), dtype=bool))\n\nwith sns.axes_style(\"white\"):\n    sns.heatmap(train_features.loc[:,\"c-0\":\"c-99\"].corr(), mask=mask, square=True);\n    plt.title(\"Cell Viability: Correlation\")","8e7a1ee0":"data = target_scored.drop(['sig_id'], axis=1).sum().sort_values(inplace=False, ascending=False)\ndata = pd.Series(data)\nwith sns.axes_style(\"whitegrid\"):\n    data[:20].plot(kind='bar', figsize=(16, 8), title='Top 20 Target Features')","a8217ef6":"data = target_scored.drop(['sig_id'], axis=1).sum().sort_values(inplace=False)\ndata = pd.Series(data)\nwith sns.axes_style(\"whitegrid\"):\n    data[:20].plot(kind='bar', figsize=(16, 8), title='Last 20 Target Features')","a8bee793":"with sns.axes_style(\"whitegrid\"):\n    target_scored.sum(axis=1).value_counts().plot(kind='bar', figsize=(16, 8), title='Number of MoA Activations per samples')","03db0751":"data = target_nonscored.drop(['sig_id'], axis=1).sum().sort_values(inplace=False, ascending=False)\ndata = pd.Series(data)\nwith sns.axes_style(\"whitegrid\"):\n    data[:20].plot(kind='bar', figsize=(16, 8), title='Top 20 Non Target Features')","8cd01d05":"with sns.axes_style(\"whitegrid\"):\n    target_nonscored.sum(axis=1).value_counts().plot(kind='bar', figsize=(16, 8), title='Number of MoA Activations per samples (Non Target Features)')","5375f1be":"**\ud83d\udccc Points to note :**\n\n   * We can see most of the gene expression columns are forming a normal distribution.  \n   * We can conclude that all the columns from **\"g-0 to g-771\"** are normally distributed.\n   * Value in gene expression features ranges from -10 to 10.","b73d25c8":"## 4.2 <a id='4-2'>Gene Expression<\/a>\n[Table of contents](#0.1)\n\n**\"Gene expression\"** is the process by which the instructions in our DNA are converted into a functional product, such as a protein. When the **information stored in our DNA is converted into instructions for making proteins or other molecules, it is called gene expression**.\n\nWe have columns ranging from **\"g-0 to g-771\"** which seems to be similar. We will make a density plot to view some of the gene expressions. ","a4b7fd06":"# 3. <a id='3'>Data Overview\ud83d\udd0d<\/a>\n[Table of Contents](#0.1)","499a2d7b":"### 4.4.2 <a id='4-4-2'>Low Occurences<\/a>\n[Table of contents](#0.1)\n\nWe will see target variables with low MoAs.","107c256d":"# Table of contents\ud83d\uddc3<a id='0.1'><\/a>\n\n- [1. Introduction](#1)\n- [2. Import Packages](#2)\n- [3. Data Overview](#3)\n   - [3.1 Train Data](#3-1)\n   - [3.2 Train Targets](#3-2)\n   - [3.3 Test Data](#3-3)\n   - [3.4 Missing Values](#3-4)\n- [4. Visualization](#4)\n   - [4.1 Treatment Features (Type, Dose & Duration)](#4-1)\n   - [4.2 Gene Expression](#4-2)\n       - [4.2.1 Gene Expression: Correlation](#4-2-1)\n   - [4.3 Cell Viability](#4-3)\n       - [4.3.1 Cell Viability: Correlation](#4-3-1)\n   - [4.4 Target Features](#4-4)\n       - [4.4.1 Top Occurences](#4-4-1)\n       - [4.4.2 Low Occurences](#4-4-2)\n       - [4.4.3 Activation Per Sample](#4-4-3)\n   - [4.5 Non Target Features](#4-5)\n       - [4.5.1 Top Occurences](#4-5-1)\n       - [4.5.2 Activation Per Sample](#4-5-2)","e5b6f640":"**\ud83d\udccc Points to note :**\n\n   * We can see most of the cell viability columns are rightly skewed.  \n   * There are 100 cell viability features ranging from **\"c-0 to c-99\"**. \n   * Values in cell viability features ranges from -10 to 6.","5cb570a0":"# 2. <a id='2'>Import Packages\ud83d\udcda<\/a>\n\n[Table of Contents](#0.1)","b5eaab79":"## 3.3 <a id='3-3'>Test Data<\/a>\n[Table of Contents](#0.1)","ffa7b526":"# 4. <a id='4'>Visualization<\/a>\n[Table of contents](#0.1)\n\nNow comes the amazing part, **Visualization**. We will visualize various features categorical and numericals. ","7e32ecc3":"\ud83d\udccc **Points to note :**\n\n   * We can see most of the treatment are compound treatments (trt_cp).\n   * Treatment dose has two categories D1 and D2 (high vs low).\n   * We have three categories for treatment duration viz 24, 48 and 72.","773aab9c":"## 4.5.2 <a id='4-5-2'>Activations Per Sample<\/a>\n[Table of contents](#0.1)","a1290387":"## 4.1 <a id='4-1'>Treatment Features (Type, Dose & Duration)<\/a>\n[Table of contents](#0.1)","4f709654":"* sig_id is unique id for each sample.\n* We have **cp_type**, **cp_time** and **cp_dose** which indicates sample treated with a compound, treatment duration and dose levels respectively.\n* **\"g-\"** means gene expression data and **\"c-\"** means cell viability data.","e5e87b3f":"<img src='https:\/\/www.msm.edu\/online\/makingmedicines\/images\/makingmedicines784.jpg'>\n<p>\n<p>\n<h1><center>Mechanisms of Action (MoA) Prediction<\/center><h1>\n<h3><center>\ud83d\udc8aCan you improve the algorithm that classifies drugs based on their biological activity?\n\ud83d\udc8a<\/center><h3>\n    \n    \n[image credit](https:\/\/www.msm.edu\/online\/makingmedicines\/index.php)","56838d06":"**\ud83d\udccc Points to note :**\n   * We can see most of the samples have **no Machanism of Action (MoA) annotation around **19224**.\n   * There are not any samples with 6 MoA annotation.\n   * Very few samples have 2, 3, 4, 5 and 6 annotations.","4923f3d1":"## 4.3 <a id='4-3'>Cell Viability<\/a>\n\n**\"Cell viability\"** is a measure of the proportion of live, healthy cells within a population. Cell viability assays are used to determine the overall health of cells, optimize culture or experimental conditions, and to measure cell survival following treatment with compounds, such as during a drug screen.\n\n[Table of contents](#0.1)","9a3242ee":"## 4.4 <a id='4-4'>Target Features<\/a>\n[Table of contents](#0.1)\n\nWe have **206 target variables** all of which are **binary(0,1)**.\n\n### 4.4.1 <a id='4-4-1'>Top occurences<\/a>","87e1886f":"## 3.2 <a id='3-2'>Train Targets<\/a>\n[Table of Contents](#0.1)","f3863344":"## 3.4 <a id='3-4'>Missing Values<\/a>\n[Table of Contents](#0.1)","d0741bfb":"### 4.3.1 <a id='4-3-1'>Cell Viability: Correlation<\/a>\n[Table of contents](#0.1)","fee85ed1":"## 3.1 <a id='3-1'>Train Data<\/a>\n[Table of Contents](#0.1)","206dc9b6":"**\ud83d\udccc Points to note :**\n   * We can see there is high correlation between **\"cell viability features\"**.","b08b579e":"## 4.5 <a id='4-5'>Non Target Features<\/a>\n[Table of contents](#0.1)\n\n## 4.5.1 <a id='4-5-1'>Top Occurences Non Target Features<\/a>\n","2c64e7de":"**\ud83d\udccc Points to note :**\n   * We can see most of the samples have one Machanism of Action (MoA) annotation and we can see significant samples with no MoA annotation at all. \n   * There are not any samples with 6 MoA annotation.\n   * Very few samples have 4, 5 or 6 annotations.","3bcf6199":"* Same as the train data (train_features). We need to predict the probability of each scored MoA for each row in the test data.","fb3147f5":"# 1. <a id='1'>Introduction\ud83d\udcc3<\/a>\n[Table of Contents](#0.1)\n\nThis competition is presented by [Connectivity Map](https:\/\/clue.io\/) and [Laboratory for Innovation Science at Harvard (LISH)](https:\/\/lish.harvard.edu\/). The goal of this competition of is to advance drug development through improvements to MoA prediction algorithms. Let's first understand what is **Machanism of Action (MoA)**?\n\n## What is Mechanism of Action (MoA)?\n\nIn medicine, a term used to describe how a drug or other substance produces an effect in the body. For example, a drug\u2019s mechanism of action could be how it affects a specific target in a cell, such as an enzyme, or a cell function, such as cell growth. Knowing the mechanism of action of a drug may help provide information about the safety of the drug and how it affects the body. It may also help identify the right dose of a drug and which patients are most likely to respond to treatment. Also called MOA. For more information check [here](https:\/\/www.kaggle.com\/c\/lish-moa\/overview).\n\n## Competition Data\n\nWe have access to a unique dataset that combines gene expression and cell viability data. The data is based on the 100 different types of human cells responses to various drugs. We are provided with separate predictor(train_features.csv) and targets(train_targets_scored.csv) CSVs. Our data has - \n\n   * train_features.csv - Features for the training set. Features g- signify gene expression data, and c- signify cell viability data. cp_type indicates samples treated with a compound (cp_vehicle) or with a control perturbation (ctrl_vehicle); control perturbations have no MoAs; cp_time and cp_dose indicate treatment duration (24, 48, 72 hours) and dose (high or low).\n   \n   * train_targets_scored.csv - The binary MoA targets that are scored.\n   \n   * train_targets_nonscored.csv - Additional (optional) binary MoA responses for the training data. These are not predicted nor scored.\n   \n   * test_features.csv - Features for the test data. You must predict the probability of each scored MoA for each row in the test data.\n   \n   * sample_submission.csv - A submission file in the correct format.\n\n\n## What we are predicting? \n\n**Our goal is to classify drugs based on their biological activity**. Since drugs can have multiple MoA annotations, the task is formally a **multi-label classification problem**. Given various gene expression and cell viability features we have to predict multiple targets of the Mechanism of Action (MoA) responses of different samples.","c23bc091":"**\ud83d\udccc Points to note :**\n   * We have **206 target variables**. Since target dataframe is huge here are the **top 20 target variables**.\n   * We can see **nfkb_inhibitor** has huge(832) occurence followed by proteasome_inhibitor(726).","d2c77040":"* These are the additional binary responses. These are not predicted nor scored.","0a54479e":"### 4.2.1 <a id='4-2-1'>Gene Expression: Correlation<\/a>\n[Table of contents](#0.1)","3538f271":"**\ud83d\udccc Points to note :**\n\n   * So we can see this is huge correlation plot with **\"772 gene expression features\"**.","3eb68d03":"# WORK IN PROGRESS","f86acf73":"### 4.4.3 <a id='4-4-3'>Activations Per Sample<\/a>\n[Table of contents](#0.1)","69484d40":"**\ud83d\udccc Points to note :**\n   * We can see **\"atp-sensitive_potassium_channel_antagonist\"** and **\"erbb2_inhibitor\"** have few occurence only 1 respectively.","3c510324":"# Reference\n[Table of contents](#0.1)\n\n* [MOA Definition](https:\/\/www.cancer.gov\/publications\/dictionaries\/cancer-terms\/def\/mechanism-of-action)\n* [Cell viability](https:\/\/www.cellsignal.com\/contents\/_\/synopsis-of-cell-proliferation-metabolic-status-and-cell-death\/cell-viability-and-survival)\n* [Seaborn](https:\/\/seaborn.pydata.org\/index.html)\n* [Parul Panday's notebook collection on Kaggle](https:\/\/www.kaggle.com\/parulpandey\/notebooks)\n* https:\/\/www.kaggle.com\/headsortails\/explorations-of-action-moa-eda#individual-feature-visualisations","ca6346f5":"* We have 207 target variables. We can see binary labels(0 & 1)."}}