{"cell_type":{"e0addd72":"code","1f6f5cc5":"code","7a0d0c9e":"code","bb6d183c":"code","f52a7e36":"code","5e2167c7":"code","bd6825c2":"code","f07d7550":"code","8bfb7075":"code","cefe140f":"code","17c6c3f5":"code","3bdbbf4a":"code","e068d968":"code","9e986842":"code","046876c2":"code","594d8425":"code","3eeb1569":"code","a4e23980":"code","82d405c1":"code","ddfcbb75":"code","f2e58d9f":"code","9f1b6e6c":"code","8ab75061":"code","40345547":"code","14d5be2a":"code","855822e6":"code","1d41d62c":"code","f5c0b744":"code","c78c2485":"code","70d4dd61":"code","a7258d35":"code","4caef4f1":"code","2df8f766":"code","e8b6e6ff":"code","8addb8fb":"code","141ce6d2":"code","4522bdc9":"markdown","d713a2e0":"markdown","ca10955c":"markdown","bd893f7b":"markdown","1812b5c7":"markdown","80f986a3":"markdown","80bea805":"markdown","d07a478d":"markdown","1188e54e":"markdown"},"source":{"e0addd72":"import numpy as np # linear algebra\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()\nfrom datetime import datetime\nimport gc\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","1f6f5cc5":"building_metadata = pd.read_csv('\/kaggle\/input\/ashrae-energy-prediction\/building_metadata.csv')","7a0d0c9e":"building_metadata.shape","bb6d183c":"building_metadata.head()","f52a7e36":"building_metadata.shape","5e2167c7":"building_metadata['primary_use'].isna().sum()","bd6825c2":"building_metadata['square_feet'].isna().sum()","f07d7550":"building_metadata['year_built'].isna().sum()","8bfb7075":"building_metadata['floor_count'].isna().sum()","cefe140f":"del building_metadata['floor_count']","17c6c3f5":"building_metadata.to_csv('cleaned_building_metadata.csv',index=False)","3bdbbf4a":"del building_metadata\ngc.collect()","e068d968":"weather_train = pd.read_csv('\/kaggle\/input\/ashrae-energy-prediction\/weather_train.csv')","9e986842":"weather_train.shape","046876c2":"weather_train.head()","594d8425":"weather_train['timestamp'] = pd.to_datetime(weather_train['timestamp'])","3eeb1569":"weather_train['date'] = weather_train['timestamp'].apply(datetime.date)","a4e23980":"weather_train['time'] = weather_train['timestamp'].apply(datetime.time)","82d405c1":"weather_train['air_temperature'].isna().sum()","ddfcbb75":"temp = weather_train.groupby(['site_id','date','time'])['air_temperature'].agg(pd.Series.mode)","f2e58d9f":"temp","9f1b6e6c":"temp_list = []\nfor i in weather_train.index:\n    if np.isnan(weather_train.loc[i].air_temperature):\n        try:\n            temp1 = temp[[weather_train.loc[i].site_id,weather_train.loc[i].date,weather_train.loc[i].time]]\n            temp_list.append(temp1)\n        except:\n            temp_list.append(np.nan)\n    else:\n        temp_list.append(weather_train.loc[i].air_temperature)","8ab75061":"weather_train['air_temperature'] = temp_list","40345547":"temp1 = []\nfor i in weather_train.index:\n    if type(weather_train.loc[i].air_temperature) == np.float64:\n        temp = weather_train.loc[i].air_temperature\n        temp1.append(temp)\n    else:\n        temp2 = 0\n        temp3 = 0\n        for i in weather_train.loc[i].air_temperature:\n            if type(i) == np.float64:\n                temp2 += i\n                temp3 += 1\n        temp1.append(temp2\/temp3)","14d5be2a":"weather_train['air_temperature'] = temp1","855822e6":"weather_train['air_temperature'].isna().sum()","1d41d62c":"weather_train['dew_temperature'].isna().sum()","f5c0b744":"weather_train['cloud_coverage'].isna().sum()","c78c2485":"weather_train['sea_level_pressure'].isna().sum()","70d4dd61":"weather_train['wind_direction'].isna().sum()","a7258d35":"weather_train['wind_speed'].isna().sum()","4caef4f1":"for j in ['dew_temperature','wind_speed','wind_direction','sea_level_pressure','cloud_coverage']:\n    temp = weather_train.groupby(['site_id','date','time'])[j].agg(pd.Series.mode)\n    temp_list = []\n    for i in weather_train.index:\n        if np.isnan(weather_train.loc[i][j]):\n            try:\n                temp1 = temp[[weather_train.loc[i].site_id,weather_train.loc[i].date,weather_train.loc[i].time]]\n                temp_list.append(temp1)\n            except:\n                temp_list.append(np.nan)\n        else:\n            temp_list.append(weather_train.loc[i][j])\n    weather_train[j] = temp_list\n    temp1 = []\n    for i in weather_train.index:\n        if type(weather_train.loc[i].air_temperature) == np.float64:\n            temp = weather_train.loc[i].air_temperature\n            temp1.append(temp)\n        else:\n            temp2 = 0\n            temp3 = 0\n            for i in weather_train.loc[i].air_temperature:\n                if type(i) == np.float64:\n                    temp2 += i\n                    temp3 += 1\n            temp1.append(temp2\/temp3)\n    weather_train[j] = temp1","2df8f766":"weather_train['precip_depth_1_hr'].isna().sum()","e8b6e6ff":"del weather_train['precip_depth_1_hr']","8addb8fb":"weather_train.to_csv('cleaned_weather_train.csv',index=False)","141ce6d2":"del weather_train\ngc.collect()","4522bdc9":"# Analysis for building_metadata","d713a2e0":"Deleting this column as it has too many null values","ca10955c":"**Missing values in rest of the columns of weather_train**","bd893f7b":"# Purpose of this notebook","1812b5c7":"* **The purpose of this notebook is to handle missing data present in building metadata, weather train files**\n* **This notebook outputs cleaned data files with names cleaned_building_metadata, cleaned_weather_train respectively. **\n* **The output of this notebook can be used to create new notebook with these cleaned files to perform furthur steps like model fitting etc.**\n* **Steps to use these cleaned files: Output->New_notebook**","80f986a3":"For these columns similar steps will be taken, as air_temperature","80bea805":"**Part 2 of this notebook, that contains cleanup for weather_test files, it is handled in different kernel as its large size was causing problem**\n**Link to notebook - [Click here](https:\/\/www.kaggle.com\/rohan9889\/handling-missing-data-ashrae-pt2)**","d07a478d":"**Handling missing air_temperature column**","1188e54e":"# Handling missing data of table weather data (train)"}}