{"cell_type":{"fc94f724":"code","90266519":"code","8ca870c1":"code","78fb8731":"code","1c3bfef1":"code","21cdea64":"code","8db63020":"code","0437536a":"code","50a9a2a0":"code","b4375d23":"code","44d9e453":"markdown"},"source":{"fc94f724":"#Import some libraries\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","90266519":"#Read in the labelled data\ndftrain=pd.read_csv(\"..\/input\/innovation-challenge-2020\/data_training.csv\",header=0)\n\n#And the target tweet ids for the solution (and the dummy classifcations)\ndfsolution=pd.read_csv(\"..\/input\/innovation-challenge-2020\/data_example_random.csv\",header=0)\n\n#Hydrate following the steps in the Data page.\n#Read in the hydrated data\ndfhydrate=pd.read_csv(\"..\/input\/hydrateddata\/hydrated_training.csv\",header=0)\n\n#Read in the hydrated data for the target tweet ids\ndftarget=pd.read_csv(\"..\/input\/hydrateddata\/hydrated_solution.csv\",header=0)","8ca870c1":"#Merge the two datasets (tweet ids from data_training and the tweets from hydrated_training). \n#Note: the number of tweetids availble to hydrate may have changed since the labelled dataset was made.\ndf=pd.merge(left=dfhydrate,right=dftrain, left_on='id', right_on='tweetid')\ndf.head()","78fb8731":"#What are all the column names?\ndf.columns","1c3bfef1":"#Import some sci-kit learn libraries to make a simple classifier\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.feature_extraction.text import TfidfTransformer\nfrom sklearn.metrics import f1_score","21cdea64":"#Build our processing pipeline\ntext_clf = Pipeline([\n    #Turn the sentences into something we can classify\n    ('vect', CountVectorizer()),\n    ('tfidf', TfidfTransformer()),\n    #And choose the classifier\n    ('clf', MultinomialNB()),\n    ])","8db63020":"predicted = text_clf.predict(df.text)\n\nprint(\"F1 Score:\", f1_score(df.tweet_label_int.values,predicted))","0437536a":"#Nevertheless, lets create the final output data to upload up to kaggle for submission\n#Test our classifier on the hydrated target tweets\npredicted_targets = text_clf.predict(dftarget.text)","50a9a2a0":"#Set the solution to our predicted targets\ndfsolution.tweet_label_int=predicted_targets\ndfsolution","b4375d23":"#And save it out to upload to competition!\ndfsolution.to_csv(\"my_kaggle_solution.csv\",index=False)","44d9e453":"# Ooof, not a very good score. But I am just building the bare bones, and this is my first time classifying text\/twitter data. Version 2 is going to good: coming soon!"}}