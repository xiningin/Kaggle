{"cell_type":{"2d5f87f3":"code","8643e339":"code","5da12c04":"code","654d648e":"code","69799752":"code","23b05b9a":"code","3f4a6c59":"code","97df4b91":"code","9c3d5125":"code","bc33a84f":"code","0e06c824":"code","951c6e5c":"code","6bd2641f":"code","8cf0b454":"code","a533d103":"code","d920ac70":"code","0c81ac43":"code","c3a8fa2f":"code","b72dd0bb":"code","024933e2":"code","1ad3571d":"code","98fa80b4":"code","c4831184":"code","27374876":"code","5ef53b42":"code","9ed60efd":"code","917c3153":"code","40ae8c05":"code","e538e216":"code","58ee1d71":"code","8fc9aeef":"code","207eb72e":"markdown","f21d596f":"markdown","37728354":"markdown"},"source":{"2d5f87f3":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","8643e339":"filename=\"..\/input\/neural-net-regression-data\/fake_reg.csv\"\ndf=pd.read_csv(filename)\ndf","5da12c04":"sns.pairplot(df)","654d648e":"from sklearn.model_selection import train_test_split","69799752":"X=df[['feature1','feature2']].values\ny=df['price'].values","23b05b9a":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=40)","3f4a6c59":"from sklearn.preprocessing import MinMaxScaler","97df4b91":"scaler=MinMaxScaler()","9c3d5125":"scaler.fit(X_train)","bc33a84f":"X_train=scaler.transform(X_train)","0e06c824":"X_test=scaler.transform(X_test)","951c6e5c":"X_train.max()","6bd2641f":"from tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense","8cf0b454":"model=Sequential()\n\nmodel.add(Dense(4,activation='relu'))\nmodel.add(Dense(4,activation='relu'))\nmodel.add(Dense(4,activation='relu'))\nmodel.add(Dense(1))\n\nmodel.compile(optimizer='rmsprop',loss='mse')","a533d103":"model.fit(x=X_train,y=y_train,epochs=250)","d920ac70":"loss_df=pd.DataFrame(model.history.history)\nloss_df.plot()","0c81ac43":"model.evaluate(x=X_test,y=y_test,verbose=10)","c3a8fa2f":"model.evaluate(x=X_train,y=y_train,verbose=10)","b72dd0bb":"prediction=model.predict(X_test)\nprediction","024933e2":"test_pred=pd.Series(prediction.reshape(300,))\ntest_pred","1ad3571d":"pred_df=pd.DataFrame(data=y_test,columns=['True value(y)'])\npred_df","98fa80b4":"pred_df=pd.concat([pred_df,test_pred],axis=1)\npred_df","c4831184":"pred_df.columns=['true value(y)','predicted_vals']","27374876":"pred_df","5ef53b42":"sns.scatterplot(x='true value(y)',y='predicted_vals',data=pred_df)","9ed60efd":"from sklearn.metrics import mean_absolute_error,mean_squared_error","917c3153":"ae=mean_absolute_error(pred_df['true value(y)'],pred_df['predicted_vals'])\nse=mean_squared_error(pred_df['true value(y)'],pred_df['predicted_vals'])\nprint('mean absolute error is {}'.format(ae))\nprint('mean squared error is {}'.format(se))","40ae8c05":"df.describe()","e538e216":"from tensorflow.keras.models import load_model","58ee1d71":"model.save('first_neural_net.h5')","8fc9aeef":"later_model=load_model('first_neural_net.h5')","207eb72e":"**Scatterplot shows that the true values and predicted values are extremely close to each other which shows that the deep neural network is working perfectly.**","f21d596f":"**load_model is used to save model and to use it in other notebook or script file","37728354":"# The End"}}