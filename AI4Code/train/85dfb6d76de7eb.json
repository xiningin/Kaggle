{"cell_type":{"5789af10":"code","70c93d9b":"code","964feb5b":"code","57482f5f":"code","4944073d":"code","b02a6406":"code","fa9df965":"code","630ddd04":"code","5eeeea73":"code","ad69e61f":"code","c5ff7b89":"code","79d1746a":"code","5eaa9bbc":"code","a24883b2":"code","e4136efc":"code","f1855f79":"code","2cba2a82":"code","61caf7dd":"code","e0f5e182":"code","75293560":"code","64f85642":"code","65d5dbf8":"code","0c1ccf32":"code","36a07197":"code","9dbeb136":"code","ba3f6ba1":"code","25691974":"code","524a1f12":"markdown","f434fa2a":"markdown","20c73bd2":"markdown","2f086b7e":"markdown","6fac8280":"markdown","45fa3474":"markdown","6ff7fc30":"markdown","2c2b7c4e":"markdown","1640be15":"markdown","1d4f2583":"markdown","543918f6":"markdown","9ad60f20":"markdown","0499f796":"markdown"},"source":{"5789af10":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport warnings\nwarnings.simplefilter('ignore')\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","70c93d9b":"data = pd.read_csv(\"..\/input\/heart.csv\")","964feb5b":"data.head()","57482f5f":"sns.pairplot(data,hue='target')","4944073d":"data.columns","b02a6406":"sns.pairplot(data[['thalach','oldpeak','slope','target']],hue='target')","fa9df965":"sns.heatmap(data.corr(),cmap='coolwarm')","630ddd04":"ax = sns.countplot(x='sex',hue='sex',data=data)\nax.set_xticklabels([\"Female\",\"Male\"])\nax.legend(['Female','Male'])","5eeeea73":"count = data.groupby('sex').count()['age']\ncount_male = data['sex'].value_counts()[1]\ncount_female = data['sex'].value_counts()[0]\nfrom matplotlib.pyplot import pie\nfig1, ax1 = plt.subplots()\nax1.pie([count_female\/(count_female+count_male),count_male\/(count_female+count_male)], labels=['Female','Male'],autopct='%1.1f%%')","ad69e61f":"hrt_prob_data = data[data['target']==1]\nnot_hrt_prob = data[data['target']==0]\nsns.distplot(hrt_prob_data['age'],bins=10)","c5ff7b89":"sns.distplot(hrt_prob_data['thalach'],hist=False, rug=True, label='Heart Problem')\nsns.distplot(not_hrt_prob['thalach'],hist=False, rug=True, label='No Heart Problem')","79d1746a":"ax1 = sns.distplot(hrt_prob_data['oldpeak'],hist=False, rug=True, label='Heart Problem',bins=10)\nax2 = sns.distplot(not_hrt_prob['oldpeak'],hist=False, rug=True, label='No Heart Problem',bins=10)\nax1.set_xlim(-1,4)\nax2.set_xlim(-1,4)","5eaa9bbc":"print('mean of ST depression when no heart problem:',not_hrt_prob['oldpeak'].mean())\nprint('mean of ST depression when there is heart problem:',hrt_prob_data['oldpeak'].mean())","a24883b2":"data.info()","e4136efc":"data['cp'] = data['cp'].astype('object')\ndata['fbs'] = data['fbs'].astype('object')\ndata['restecg'] = data['restecg'].astype('object')\ndata['exang'] = data['exang'].astype('object')\ndata['slope'] = data['slope'].astype('object')\ndata['thal'] = data['thal'].astype('object')","f1855f79":"data_categorical = pd.get_dummies(data, drop_first=True)\ndata_categorical.head()","2cba2a82":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nscaler.fit(data_categorical.drop('target',axis=1))","61caf7dd":"scaled_features = scaler.transform(data_categorical.drop('target',axis=1))","e0f5e182":"feature_data = pd.DataFrame(scaled_features,columns=(data_categorical.drop('target',axis=1)).columns[:])","75293560":"feature_data.head()","64f85642":"from sklearn.model_selection import train_test_split","65d5dbf8":"X = feature_data\ny = data_categorical['target']\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","0c1ccf32":"from sklearn.neighbors import KNeighborsClassifier","36a07197":"error_rate = []\nfor i in range(1,40):\n    knn = KNeighborsClassifier(n_neighbors=i)\n    knn.fit(X_train,y_train)\n    pred_i = knn.predict(X_test)\n    error_rate.append(np.mean(pred_i != y_test))\n    \nplt.figure(figsize=(10,6))\nplt.plot(range(1,40),error_rate,marker='o')","9dbeb136":"knn_12 = KNeighborsClassifier(n_neighbors=12)\nknn_12.fit(X_train,y_train)\npred_12 = knn_12.predict(X_test)\nfrom sklearn.metrics import classification_report,confusion_matrix\nprint(confusion_matrix(y_test,pred_12))\nprint('\\n')\nprint(classification_report(y_test,pred_12))","ba3f6ba1":"from sklearn.ensemble import RandomForestClassifier\nrfc = RandomForestClassifier(n_estimators=100)\nrfc.fit(X_train,y_train)\nrfc_pred = rfc.predict(X_test)\nprint(classification_report(y_test,rfc_pred))","25691974":"fig = plt.figure(figsize=(10,10))\nimportant_feat = pd.Series(rfc.feature_importances_,index=X_train.columns)\nsns.set_style('whitegrid')\nimportant_feat.sort_values().plot.barh()\nplt.title('Important Features')","524a1f12":"Using Elbow Method to find the most efficient K value","f434fa2a":"The heatmap shows that there is a higher correlation between the target and variables - cp(chest pain type),\nthalach(maximum heart rate achieved) and slope(the slope of the peak exercise ST segment). ","20c73bd2":"Hence, it shows that what we estimated from the pairplot was true for 'thalach' and 'old peak'. These 2 variables do have a bearing on the output. This makes sense too as 'max heart rate achieved' is the immediate, subjective state of the patient at the time of examination.'Oldpeak' i.e. the ST depression relates to the shape and direction of the ST segment. Upward or downward shifts can represent decreased blood flow to the heart from a variety of causes, including heart attack, spasms in one or more coronary arteries (Prinzmetal's angina), infection of the lining of the heart (pericarditis) or the heart muscle itself (myocarditis), an excess of potassium in the bloodstream, a heart rhythm problem, or a blood clot in the lungs (pulmonary embolism).\" \n\nThe above image also shows that 'ca' i.e. the number of colored blood vessels too have a high bearing on the output which has to be true because the more the blood can get to the heart the better the heart is functioning.","2f086b7e":"The ones who are detected with a heart problem are mostly above 35 years of age, most of them around 50-60 age group.","6fac8280":"This shows in a much better way that in our dataset itself the incidence of heart disease is much more prevalent in males than females.","45fa3474":"Lets use K Nearest Neighbours to classify a condition as having a heart problem or not based on the given attributes-","6ff7fc30":"K=12 seems to be the most efficient!","2c2b7c4e":"Using Random Forest - ","1640be15":"Lets see if there is some pattern w.r.t gender and age.","1d4f2583":"From the pairplot above, it can be taken noted that 'thalach'(maximum heart rate achieved),\n'oldpeak'(ST depression induced by exercise relative to rest) and slope(the slope of the peak exercise ST segment)\nare able to segregate the 'target' values quite prominantly.\nTo get a closer look, lets slice the data frame and look closer.","543918f6":"Lets assign the categorical columns a data type 'object' so as to get their dummy variables - ","9ad60f20":"Shows that if the maximum heart rate achieved is less than 150bpm then the chances of having a heart problem is relatively less as compared to when it is greater than 150.","0499f796":"Without digging down too much we can see that these 3 variables have quite a higher bearing on the output! Lets verify the results too!"}}