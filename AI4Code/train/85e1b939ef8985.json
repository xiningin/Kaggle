{"cell_type":{"10e68ee9":"code","8e9ced9f":"code","14e4e9b2":"code","85f49272":"code","63e8cf0f":"code","f72f3f8c":"code","a2750733":"code","25aa424e":"code","c8271873":"code","23f84822":"code","bbea44e9":"code","27baf691":"code","104d4058":"code","417707d9":"code","a22a9eac":"code","60a5c20d":"code","e43c8fc1":"code","dfb22490":"code","0a6bfcf6":"code","ecf2d854":"code","47620fbf":"markdown","1f891774":"markdown","37224f27":"markdown","ecb286b6":"markdown","c6be7b9b":"markdown","e2984898":"markdown","52d94ac5":"markdown","cb79af7c":"markdown","f28a2436":"markdown","3880bef3":"markdown","167164fc":"markdown","ce5eefbf":"markdown","e8af2789":"markdown","7e8543ac":"markdown","83547608":"markdown","8f6d40a1":"markdown","54c56fc4":"markdown","f6cf7396":"markdown","59405741":"markdown","3d36ca4d":"markdown","df5e646b":"markdown","a0d96652":"markdown","a7490aac":"markdown","aa92a1a3":"markdown","7f24a6a9":"markdown","04a9110c":"markdown","03992836":"markdown"},"source":{"10e68ee9":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import r2_score, mean_squared_error\nimport seaborn as sns\n%matplotlib inline\npd.set_option('max_columns', None)","8e9ced9f":"df_original = pd.read_csv('..\/input\/airbnb-boston\/boston_listings.csv')\ndf = pd.read_csv('..\/input\/boston-preprocessed\/boston_listings_updated.csv')\ndf = df.drop(columns=['Unnamed: 0'])\ndf.head(2)","14e4e9b2":"print(df['price'].describe()) \ndf['price'].plot(kind ='box')","85f49272":"Q1 = df['price'].quantile(0.25)\nQ3 = df['price'].quantile(0.75)\n\nIQR = Q3 -Q1\n\nMax = Q3 + 1.5*IQR\nMin = Q1 - 1.5*IQR\nprint('Min value {} , Max value {}'.format(Min,Max))","63e8cf0f":"print('Total count for price higher than 422 = ' + str(df[df['price'] > 422]['price'].count()))\nprint('A look at the outlier prices :' + str(np.sort(df[df['price'] > 422]['price'].unique())))","f72f3f8c":"df = df.query('price < 500')","a2750733":"!pip install sklearn","25aa424e":"!pip install pycaret\nimport pycaret\nfrom pycaret.regression import *","c8271873":"bnb_setup = setup(df, target='price',silent = True)","23f84822":"compare_models(fold=5)","bbea44e9":"catboost_regressor = create_model('catboost')","27baf691":"tuned_catboost_regressor = tune_model('catboost',optimize ='mse')","104d4058":"predictions = predict_model(tuned_catboost_regressor)\n\nfinal_model = finalize_model(tuned_catboost_regressor)\nfinal_model.get_params()","417707d9":"save_model(final_model, 'airbnb_catboost_1')","a22a9eac":"interpret_model(final_model)","60a5c20d":"features = final_model.get_feature_importance(prettified = True).set_index('Feature Id').to_dict()['Importances']\n\n#sort by decreasing importance \nfeature_importance_dict = dict([(v[0],v[1]) for v in sorted(features.items(), key=lambda kv: (-kv[1], kv[0]))])","e43c8fc1":"amenity_list = ['24-Hour Check-in', 'Air Conditioning', 'Breakfast',\n       'Buzzer\/Wireless Intercom', 'Cable TV', 'Carbon Monoxide Detector',\n       'Cat(s)', 'Dog(s)', 'Doorman', 'Dryer', 'Elevator in Building',\n       'Essentials', 'Family\/Kid Friendly', 'Fire Extinguisher',\n       'First Aid Kit', 'Free Parking on Premises',\n       'Free Parking on Street', 'Gym', 'Hair Dryer', 'Hangers',\n       'Heating', 'Hot Tub', 'Indoor Fireplace', 'Internet', 'Iron',\n       'Kitchen', 'Laptop Friendly Workspace', 'Lock on Bedroom Door',\n       'Other pet(s)', 'Paid Parking Off Premises', 'Pets Allowed',\n       'Pets live on this property', 'Pool', 'Safety Card', 'Shampoo',\n       'Smoke Detector', 'Smoking Allowed', 'Suitable for Events', 'TV',\n       'Washer', 'Washer \/ Dryer', 'Wheelchair Accessible',\n       'Wireless Internet', 'translation missing: en.hosting_amenity_49',\n       'translation missing: en.hosting_amenity_50']\n\namenity_importance = []\nfor amenity in amenity_list:\n    for col in feature_importance_dict.keys():\n        if amenity in col:\n            if 'False' in col:\n                amenity_importance.append((col[:-6], -feature_importance_dict[col]))\n            else:\n                amenity_importance.append((col[:-5], feature_importance_dict[col]))\n    \n    \namenity_importance.sort(key=lambda tup: tup[1], reverse = True) \n\npd.DataFrame(amenity_importance, columns = ['amenity','Importance']).drop_duplicates().set_index('amenity').plot(kind='bar', figsize = (30,15))\nplt.xticks(fontsize=20)\nplt.xlabel('amenity', fontsize=30)\nplt.ylabel('Importance', fontsize=30)\n","dfb22490":"df_original['price'] = df_original['price'].map(lambda p: int(p[1:-3].replace(\",\", \"\")))\ndf_original = df_original.query('price < 500')","0a6bfcf6":"neighborhoods = df_original['neighbourhood_cleansed']\n\nfor n in neighborhoods:\n    n_price.append((n, df_original[df_original['neighbourhood_cleansed'] == n]['price'].mean()))","ecf2d854":"pd.DataFrame(n_price, columns = ['Neighborhood','Average Price']).drop_duplicates().set_index('Neighborhood').sort_values(by = 'Average Price').plot(kind='bar', figsize = (30,15))\nplt.xticks(fontsize=20)\nplt.xlabel('Neighborhood', fontsize=30)\nplt.ylabel('Average Price', fontsize=30)","47620fbf":"## In this file we will try to find answers to following questions:\n1. Is it possible to accurately predict the most attractive price of your Airbnb?\n2. What services will actually help you raise the price?\n3. What are the most favored neighborhoods?\n","1f891774":"Let's have a look at our target variable 'price'.","37224f27":"We have a lot of values at range below 422, lets take upper limit to 500. ","ecb286b6":"As expected, the areas near the city center cost on average $50 or more than the ones far from the city. It\u2019s the premium you pay to be \u2018right-there\u2019 location wise which honestly sounds good to me.","c6be7b9b":"## Prediction","e2984898":"## Results:","52d94ac5":"* We can see that mentioning basic amenities such as hangers, lock on bedroom door, hairdryers have a negative impact on the listing. This could be because there are very basic necessities and should not be mentioned as a special feature.\n* The easiest things to increase price are to include a TV, Cable, and an Indoor Fireplace. Also, including a free on-premise parking space add a bonus.\n* Investing in safety devices like Fire Extinguisher, Safety card, Intercome, and smoke detectors will not only help you safeguard the place but also earn a few extra bucks.","cb79af7c":"## Result:","f28a2436":"Important of feature for pred","3880bef3":"So, we have outliers at higher price values but non for lower(negative min value). <br>\nLet's see the count for outliers for values higher than 422.","167164fc":"We have some outliers in the data and some extreme values as well. <br>\nLet's use _Tukey rule_ to detect the outliers.","ce5eefbf":"We will use **Pycaret** library for our prediction","e8af2789":"## 3. What are the most favored neighborhoods?","7e8543ac":"***","83547608":"RMSE for final model is 41.25 dollars, meaning that our regressor is wrong by that much on average. But the SHAP analysis tells us some interesting facts:\n\n* Clearly, an Entire home or Apartment has the biggest impact on the price, so it is for the number of bedrooms and bathrooms. These parameters alone can shift the price of your listing.\nLatitude and Longitude meaning the location is important as well, we will discuss this later in the post.\n* Availability throughout the year and acceptance rate of the host is an important factor. Higher values for both will benefit you.\n* As expected, the higher the number of minimum nights less popular will be Airbnb.\n* It is interesting to note that rentals with higher rents tend to charge little or none for the cleaning fee.","8f6d40a1":"## 2. What services will actually help you bump the price? Let's check the significance of annementies in price of the AirBnB.","54c56fc4":"We have selected highest scoring model for perdiction. ","f6cf7396":"***","59405741":"***","3d36ca4d":"Let's plot interpretation of the model based on the SHAP (SHapley Additive exPlanations), which is a unified approach to explain the output of the machine learning model. ","df5e646b":"## 1. Is it possible to accurately predict the most attractive price of your Airbnb?","a0d96652":"Initializing the environment in pycaret. Creating the transformation pipeline to prepare the data for modeling and deployment.","a7490aac":"Let's tune the model to get the best hyperparameters and select the best model based on Mean Square Error.","aa92a1a3":"## Result:","7f24a6a9":"Comparing all models in the model library and score them using K-fold Cross Validation","04a9110c":"Save the model for further use.","03992836":"Our RMSE for final model is 41.25 dollars, meaning that our regressor is wrong by that much on average.\n<br><br>\nBut our motive here is to understand important variables that contribute towards price of the AirBnB. "}}