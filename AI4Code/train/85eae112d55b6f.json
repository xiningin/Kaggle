{"cell_type":{"0ef0f790":"code","57d5a5eb":"code","a4680854":"code","abb73c34":"code","54c701bf":"code","33e9a781":"code","12b07691":"code","55f61d00":"code","5f9b3759":"code","b58a0f9e":"code","1fd5eaed":"code","97afa994":"code","b262018a":"code","bb4ea860":"code","5dcaab38":"code","6aa28229":"code","c26b6c9c":"code","6e4d5596":"code","b2ea32d0":"code","4748cf2f":"code","8495d980":"code","79e5d255":"code","6142feb6":"code","d917d55f":"code","414ac5c5":"code","6e3776d9":"code","bf8aee85":"code","70e19c06":"code","af22e7d1":"code","9dcc5074":"code","16591bd8":"code","a2671458":"code","a6793e42":"code","dbcf8a22":"code","00f8cd99":"code","351d7ce6":"code","6d53fd9e":"code","89009280":"code","e4a113fb":"code","89159678":"code","394ff3e8":"code","a55eec1d":"code","cde094e5":"markdown","f2e7af11":"markdown","53cc298f":"markdown","c15224db":"markdown","6f50e01a":"markdown","0018bedb":"markdown"},"source":{"0ef0f790":"from warnings import filterwarnings\nfilterwarnings(\"ignore\")\n\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport scipy as sp\nfrom sklearn.cluster import KMeans","57d5a5eb":"df = pd.read_csv(\"..\/input\/USArrests.csv\").copy()\ndf.sample(10)","a4680854":"df.shape","abb73c34":"df.index = df.iloc[:,0]\ndf.head()","54c701bf":"df.drop([\"Unnamed: 0\"], axis = 1, inplace = True)","33e9a781":"df.head()","12b07691":"del df.index.name","55f61d00":"df.head()","5f9b3759":"df.isnull().sum()","b58a0f9e":"df.info()","1fd5eaed":"df.describe().T","97afa994":"df.hist(figsize=(10,10));","b262018a":"?kmeans","bb4ea860":"from sklearn.cluster import KMeans\nkmeans = KMeans(n_clusters = 4)\nkmeans","5dcaab38":"k_fit = kmeans.fit(df)\nk_fit.n_clusters","6aa28229":"k_fit.cluster_centers_","c26b6c9c":"kmeans = KMeans(n_clusters = 2)\nk_fit = kmeans.fit(df)","6e4d5596":"clusters = k_fit.labels_\nclusters","b2ea32d0":"centers = k_fit.cluster_centers_\ncenters","4748cf2f":"plt.scatter(df.iloc[:,0], df.iloc[:,1], c = clusters, s = 50, cmap =\"viridis\")\nplt.scatter(centers[:,0], centers[:,1], c = \"red\", s = 200, alpha = .5);","8495d980":"kmeans = KMeans(n_clusters = 3)\nk_fit = kmeans.fit(df)\ncenters = k_fit.cluster_centers_\nclusters = k_fit.labels_","79e5d255":"centers","6142feb6":"import matplotlib.pyplot as plt\nfrom mpl_toolkits.mplot3d import Axes3D\n\nplt.rcParams[\"figure.figsize\"] = (16,9)\nfig = plt.figure()\nax = Axes3D(fig)\nax.scatter(df.iloc[:,0], df.iloc[:,1], df.iloc[:,2], c= clusters, s = 200);","d917d55f":"fig = plt.figure()\nax = Axes3D(fig)\nax.scatter(df.iloc[:,0], df.iloc[:,1], df.iloc[:,2], c = clusters, s = 200)\nax.scatter(centers[:,0], centers[:,1], centers[:,2], marker = \"*\", c = \"#050505\", s = 1000);","414ac5c5":"kmeans = KMeans(n_clusters = 3)\nk_fit = kmeans.fit(df)\nclusters = k_fit.labels_\nclusters","6e3776d9":"df[\"Cluster\"] = clusters\ndf[\"Cluster\"] = df[\"Cluster\"] + 1\ndf.head()","bf8aee85":"!pip install yellowbrick\nfrom yellowbrick.cluster import KElbowVisualizer","70e19c06":"kmeans = KMeans()\nvisualizer = KElbowVisualizer(kmeans, k=(2,50))\nvisualizer.fit(df)\nvisualizer.poof()","af22e7d1":"df = pd.read_csv(\"..\/input\/USArrests.csv\").copy()\ndf.index = df.iloc[:,0]\ndf = df.iloc[:,1:5]\ndel df.index.name\ndf.head()","9dcc5074":"from scipy.cluster.hierarchy import linkage\nhc_complete = linkage(df, \"complete\")\nhc_average = linkage(df, \"average\")\nhc_single = linkage(df, \"single\")","16591bd8":"from scipy.cluster.hierarchy import dendrogram\n\nplt.figure(figsize = (15,10))\nplt.title(\"Hiyerar\u015fik k\u00fcmeleme - dendrogram\")\nplt.xlabel(\"indexler\")\nplt.ylabel(\"uzakl\u0131k\")\n\ndendrogram(hc_complete, leaf_font_size = 10);","a2671458":"from scipy.cluster.hierarchy import dendrogram\n\nplt.figure(figsize = (15,10))\nplt.title(\"Hierarchical clustering - dendrogram\")\nplt.xlabel(\"index\")\nplt.ylabel(\"distance\")\n\ndendrogram(hc_complete,\n           truncate_mode = \"lastp\",\n           p = 12,\n           show_contracted = True);","a6793e42":"from sklearn.cluster import AgglomerativeClustering\ncluster = AgglomerativeClustering(n_clusters = 4,\n                                  affinity = \"euclidean\", \n                                  linkage=\"ward\")","dbcf8a22":"cluster.fit_predict(df)","00f8cd99":"df[\"Cluster\"] = cluster.fit_predict(df) +1\ndf.head()","351d7ce6":"df = pd.read_csv(\"..\/input\/USArrests.csv\").copy()\ndf.index = df.iloc[:,0]\ndf = df.iloc[:,1:5]\ndel df.index.name\ndf.head()","6d53fd9e":"from sklearn.preprocessing import StandardScaler\n\ndf = StandardScaler().fit_transform(df)\ndf[0:5,0:5]","89009280":"from sklearn.decomposition import PCA \npca = PCA(n_components = 2)\npca_fit = pca.fit_transform(df)","e4a113fb":"component_df = pd.DataFrame(data = pca_fit,\n                           columns = [\"first_component\", \"second_component\"])\ncomponent_df.head()","89159678":"pca.explained_variance_ratio_","394ff3e8":"pca.explained_variance_ratio_[0] + pca.explained_variance_ratio_[1] # explain with 86% ratio","a55eec1d":"pca = PCA().fit(df)\nplt.plot(np.cumsum(pca.explained_variance_ratio_));","cde094e5":"# Optimum number of cluster","f2e7af11":"# K Means","53cc298f":"# Hierarchical clustering","c15224db":"# Principal Component Analysis","6f50e01a":"# Optimum number of cluster","0018bedb":"# K Means Modelling and Visualization"}}