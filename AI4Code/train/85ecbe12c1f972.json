{"cell_type":{"e2cd13db":"code","c99d1708":"code","d0aa9eb7":"code","6dfde1e4":"code","13f04918":"code","2858aa3d":"code","85606bcb":"code","fb2a9ce3":"code","56549345":"code","94955857":"code","bb98daaf":"code","9e0ebbd3":"code","5bae8254":"markdown","9258d52c":"markdown","7c12ff22":"markdown","1c6a6f95":"markdown","bb0e74ca":"markdown","5482fe7c":"markdown","c606bd0b":"markdown"},"source":{"e2cd13db":"#import required libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.cluster import KMeans\n","c99d1708":"#loading the data\ncustomers_data=pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\ncustomers_data.head(10)","d0aa9eb7":"customers_data.info()","6dfde1e4":"print(customers_data.Gender.value_counts())","13f04918":"fig, ax = plt.subplots(1,3,figsize=(20,6))\nn = 0\nfor x in ['Age','Annual Income (k$)','Spending Score (1-100)']:\n    sns.distplot(customers_data[x],bins=20,color='#8FBC8F',ax=ax[n])\n    ax[n].set_title('Distplot of {}'.format(x))\n    n+=1;","2858aa3d":"#taking annual income and spending score as inputs\nX= customers_data.iloc[:,[3,4]].values","85606bcb":"#finding within cluster sum of squares(WCSS)\nwcss=[]\nfor i in range(1,11):\n    kmeans=KMeans(n_clusters=i,init=\"k-means++\",random_state=4)\n    kmeans.fit(X)\n    wcss.append(kmeans.inertia_)\n    \nprint(wcss)","fb2a9ce3":"#plotting the elbow graph\nsns.set_style(\"darkgrid\", {\"grid.color\": \".6\", \"grid.linestyle\": \":\"})\nplt.plot(range(1,11),wcss,\"o-b\")\nplt.title(\"Elbow graph\")\nplt.xlabel(\"No. of clusters\")\nplt.ylabel(\"wcss\")\nplt.show();","56549345":"classifier = KMeans(n_clusters=5,init=\"k-means++\",random_state=4)\nclusters = classifier.fit_predict(X)","94955857":"clusters","bb98daaf":"labels = classifier.labels_\ncentroids = classifier.cluster_centers_\nnew_data = customers_data[['Annual Income (k$)','Spending Score (1-100)']].iloc[:,:]\nnew_data['labels'] = labels\nplt.figure(figsize=(8,6))\nsns.set_style(\"darkgrid\", {\"grid.color\": \".6\", \"grid.linestyle\": \":\"})\nsns.scatterplot(data=new_data,x='Annual Income (k$)',y='Spending Score (1-100)',hue='labels',palette='prism_r')\nplt.title(\"Clusters\")\nplt.show();","9e0ebbd3":"# plotting all the clusters and their Centroids\n\nplt.figure(figsize=(8,8))\nplt.scatter(X[clusters==0,0], X[clusters==0,1], s=50, c='green', label='Cluster 1')\nplt.scatter(X[clusters==1,0], X[clusters==1,1], s=50, c='red', label='Cluster 2')\nplt.scatter(X[clusters==2,0], X[clusters==2,1], s=50, c='orchid', label='Cluster 3')\nplt.scatter(X[clusters==3,0], X[clusters==3,1], s=50, c='blue', label='Cluster 4')\nplt.scatter(X[clusters==4,0], X[clusters==4,1], s=50, c='yellow', label='Cluster 5')\n\n# plot the centroids\nplt.scatter(classifier.cluster_centers_[:,0], classifier.cluster_centers_[:,1], s=80, c='black', label='Centroids')\n\nplt.title('Customer Groups')\nplt.xlabel('Annual Income')\nplt.ylabel('Spending Score')\nplt.show()","5bae8254":"### Model building","9258d52c":"### Choosing the number of clusters ","7c12ff22":"### <font color=#DB7093> Visualizing the Clusters<\/font>","1c6a6f95":"After 5 there is not much difference,so 5 will be optimum no. of clusters.","bb0e74ca":"## <font color=#458B74>The goal of this project is to gruop customers in different categories for the profit of the business.<\/font>","5482fe7c":"## <font color=#FF4040>EDA<\/font>","c606bd0b":"#### Another way"}}