{"cell_type":{"ad61d827":"code","f66ccc6e":"code","4a2ec6d6":"code","58f0576f":"code","0866e95f":"code","f5e4ec10":"code","f990c6c9":"code","0a7ce941":"code","d06521cd":"code","30f34d5c":"code","c1780ee5":"code","cef5044f":"code","719af7ba":"code","bc5ae927":"markdown","47dc4095":"markdown","faa5d337":"markdown","6285edf2":"markdown","adbeced5":"markdown","958cb1d6":"markdown","c47eb5af":"markdown","db5de568":"markdown","b7d8f2ad":"markdown","96d88a83":"markdown","177db4fd":"markdown","047ae802":"markdown","402689f8":"markdown","a0079e22":"markdown","2784eb62":"markdown","f8800fe8":"markdown","49692595":"markdown","def881ec":"markdown","f97985a0":"markdown"},"source":{"ad61d827":"%config Completer.use_jedi = False\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib.image as im\n\ntrain_df = pd.read_csv(\"..\/input\/petfinder-pawpularity-score\/train.csv\")\ntest_df = pd.read_csv(\"..\/input\/petfinder-pawpularity-score\/test.csv\")\nsubmission_df = pd.read_csv(\"..\/input\/petfinder-pawpularity-score\/sample_submission.csv\")","f66ccc6e":"print(\"[INFO] Number of Training Images {}\".format(train_df.shape[0]))\ncolumns = train_df.columns\nprint(\"[INFO] Training Dataset Estimator Variable Name {}\".format(columns))\n","4a2ec6d6":"train_df.head(10)","58f0576f":"test_df.head(10)","0866e95f":"submission_df.head(10)","f5e4ec10":"train_df[\"Pawpularity\"].describe()","f990c6c9":"sns.displot(data=train_df['Pawpularity'], kind='hist',height=7)","0a7ce941":"# we will plot Graph in 4*3 size ( 4 rows, 3 colums)\nfigure, ax = plt.subplots(nrows=4,ncols=3, figsize=(20, 16))\nax = ax.flatten()\nprint(len(ax))\n# skipping 1st(image) and last ( pawpularity score) column we want to plot the histogram for binary features\nsubsetColumns = columns[1:-1]\nfor idx, col in enumerate(subsetColumns):\n    # plot hostogram plot of binary column vs pawpularity \n    sns.histplot(data=train_df[[col, \"Pawpularity\"]], hue=col, x=\"Pawpularity\", ax=ax[idx])","d06521cd":"# Image index for pawpularity between 1 to 25\nrange_1_25_Idx = np.where(train_df[\"Pawpularity\"] <= 25)[0]\n# Image index for pawpularity between 26 to 60\nrange_25_60_Idx = np.intersect1d(np.where(train_df[\"Pawpularity\"] > 25)[0],np.where(train_df[\"Pawpularity\"] <= 60)[0])\nprint(len(range_25_60_Idx))\n# Image index for pawpularity between 61 to 99\nrange_60_80_idx = np.intersect1d(np.where(train_df[\"Pawpularity\"] > 60)[0],np.where(train_df[\"Pawpularity\"] <= 99)[0])\n# # Image index for pawpularity 100\nmostPopular_idx = np.where(train_df[\"Pawpularity\"] == 100)[0]\n","30f34d5c":"mostPopularImages = train_df[train_df[\"Pawpularity\"] ==100].index\n# set seed \nnp.random.seed(10)\n# choose 12 index randomly\nimageIndexes = np.random.choice(mostPopularImages, 12)\n# create subplot 4 rows 3 columns\nfigure, ax = plt.subplots(nrows=3, ncols=4, figsize=(20,15))\nax = ax.flatten()\n\nfor idx,imageId in enumerate(imageIndexes):\n    img_id = train_df.loc[imageId][\"Id\"]\n    ax[idx].imshow(im.imread(\"..\/input\/petfinder-pawpularity-score\/train\/{}.jpg\".format(img_id)))\n    ax[idx].title.set_text(\"Pawpularity score: {}\".format(train_df.loc[imageId][\"Pawpularity\"]))\n    ","c1780ee5":"leastPopularImages = train_df[train_df[\"Pawpularity\"] <= 25].index\n# set seed \nnp.random.seed(42)\n# choose 12 index randomly\nimageIndexes = np.random.choice(leastPopularImages, 12)\n# create subplot 4 rows 3 columns\nfigure, ax = plt.subplots(nrows=3, ncols=4, figsize=(20,15))\nax = ax.flatten()\n\nfor idx,imageId in enumerate(imageIndexes):\n    img_id = train_df.loc[imageId][\"Id\"]\n    ax[idx].imshow(im.imread(\"..\/input\/petfinder-pawpularity-score\/train\/{}.jpg\".format(img_id)))\n    ax[idx].title.set_text(\"Pawpularity score: {}\".format(train_df.loc[imageId][\"Pawpularity\"]))\n    ","cef5044f":"Image_25_60 = train_df[np.logical_and(train_df[\"Pawpularity\"] > 25 , train_df[\"Pawpularity\"] <=60)].index\n# set seed \nnp.random.seed(42)\n# choose 12 index randomly\nimageIndexes = np.random.choice(Image_25_60, 12)\n# create subplot 4 rows 3 columns\nfigure, ax = plt.subplots(nrows=3, ncols=4, figsize=(20,15))\nax = ax.flatten()\n\nfor idx,imageId in enumerate(imageIndexes):\n    img_id = train_df.loc[imageId][\"Id\"]\n    ax[idx].imshow(im.imread(\"..\/input\/petfinder-pawpularity-score\/train\/{}.jpg\".format(img_id)))\n    ax[idx].title.set_text(\"Pawpularity score: {}\".format(train_df.loc[imageId][\"Pawpularity\"]))\n    ","719af7ba":"Image_60_99 = train_df[np.logical_and(train_df[\"Pawpularity\"] > 60 , train_df[\"Pawpularity\"] <=99)].index\n# set seed \nnp.random.seed(42)\n# choose 12 index randomly\nimageIndexes = np.random.choice(Image_60_99, 12)\n# create subplot 4 rows 3 columns\nfigure, ax = plt.subplots(nrows=3, ncols=4, figsize=(20,15))\nax = ax.flatten()\n\nfor idx,imageId in enumerate(imageIndexes):\n    img_id = train_df.loc[imageId][\"Id\"]\n    ax[idx].imshow(im.imread(\"..\/input\/petfinder-pawpularity-score\/train\/{}.jpg\".format(img_id)))\n    ax[idx].title.set_text(\"Pawpularity score: {}\".format(train_df.loc[imageId][\"Pawpularity\"]))\n    ","bc5ae927":"### Load Training CSV File","47dc4095":"<h1><center>Pet Finder EDA<\/center><\/h1>\n<h2><center>Let's Adopt some puppies!<\/center><\/h2>                    \n<<!--center> <img src = \"attachment:2849b475-b585-4000-beae-3c12922dbc3b.png\" width = \"750\" height = \"500\"\/><\/center> -->","faa5d337":"<a id=\"pawpularity\"><\/a>\n<div class=\"list-group\" id=\"list-tab\" role=\"tablist\">\n<h1 class=\"list-group-item list-group-item-action active\" data-toggle=\"list\" style='background:#b02a4c; border:0; color:white' role=\"tab\" aria-controls=\"home\"><center>Pawpularity Analysis<\/center><\/h1>","6285edf2":"### plot  image samples [Pawpularity Score > 25 and PawPularity Score <= 60]","adbeced5":"### Purpose of Photo Metadata\nPhoto Metadata gives information about visual quality and composition information.\nMetadata features are binary feature\n\n1. **Focus** - Pet stands out against uncluttered background, not too close \/ far.\n2. **Eyes** - Both eyes are facing front or near-front, with at least 1 eye \/ pupil decently clear.\n3. **Face** - Decently clear face, facing front or near-front.\n4. **Near** - Single pet taking up significant portion of photo (roughly over 50% of photo width or height).\n5. **Action** - Pet in the middle of an action (e.g., jumping).\n6. **Accessory** - Accompanying physical or digital accessory \/ prop (i.e. toy, digital sticker), excluding collar and leash.\n7. **Group** - More than 1 pet in the photo.\n8. **Collage** - Digitally-retouched photo (i.e. with digital photo frame, combination of multiple photos).\n9. **Human** - Human in the photo.\n10. **Occlusion** - Specific undesirable objects blocking part of the pet (i.e. human, cage or fence). Note that not all blocking objects are considered occlusion.\n11. **Info** - Custom-added text or labels (i.e. pet name, description).\n12. **Blur** - Noticeably out of focus or noisy, especially for the pet\u2019s eyes and face. For Blur entries, \u201cEyes\u201d column is always set to 0.\n\n\n<\/br>\n\nWe can use histogram to see how this binary variable impacts the pawpularity score.\n","958cb1d6":"<a id=\"future\"><\/a>\n<div class=\"list-group\" id=\"list-tab\" role=\"tablist\">\n<h1 class=\"list-group-item list-group-item-action active\" data-toggle=\"list\" style='background:#b02a4c; border:0; color:white' role=\"tab\" aria-controls=\"home\"><center>Future Work<\/center><\/h1>","c47eb5af":"### plot  image samples [Pawpularity Score > 60 and PawPularity Score <= 99]\n","db5de568":"### Description\n\n\nA picture is worth a thousand words. But did you know a picture can save a thousand lives? Millions of stray animals suffer on the streets or are euthanized in shelters every day around the world. You might expect pets with attractive photos to generate more interest and be adopted faster. But what makes a good picture? With the help of data science, you may be able to accurately determine a pet photo\u2019s appeal and even suggest improvements to give these rescue animals a higher chance of loving homes.\n\nPetFinder.my is Malaysia\u2019s leading animal welfare platform, featuring over 180,000 animals with 54,000 happily adopted. PetFinder collaborates closely with animal lovers, media, corporations, and global organizations to improve animal welfare.\n\nCurrently, PetFinder.my uses a basic Cuteness Meter to rank pet photos. It analyzes picture composition and other factors compared to the performance of thousands of pet profiles. While this basic tool is helpful, it's still in an experimental stage and the algorithm could be improved.\n\nIn this competition, you\u2019ll analyze raw images and metadata to predict the \u201cPawpularity\u201d of pet photos. You'll train and test your model on PetFinder.my's thousands of pet profiles. Winning versions will offer accurate recommendations that will improve animal welfare.\n\n\n### Business Objective\n\n1. What makes a good picture?\n1. Calculate the photo's appeal\n1. Find out the ways to improve picture so that photo appeal can be improved\n1. Improvements to give these  animals a higher chance of loving homes\n\n### Evaluation criteria\nRoot Mean Squared Error \ud835\udc45\ud835\udc40\ud835\udc46\ud835\udc38\n$$\\textrm{RMSE} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2}$$\n","b7d8f2ad":"\n<a id=\"range\"><\/a>\n<div class=\"list-group\" id=\"list-tab\" role=\"tablist\">\n<h1 class=\"list-group-item list-group-item-action active\" data-toggle=\"list\" style='background:#b02a4c; border:0; color:white' role=\"tab\" aria-controls=\"home\"><center>Plotting Images based on Pawpularity Range<\/center><\/h1>","96d88a83":"### plot least popular image samples [Pawpularity Score < 25]","177db4fd":"<a id=\"metadata\"><\/a>\n<div class=\"list-group\" id=\"list-tab\" role=\"tablist\">\n<h1 class=\"list-group-item list-group-item-action active\" data-toggle=\"list\" style='background:#b02a4c; border:0; color:white' role=\"tab\" aria-controls=\"home\"><center>Image Metadata Analysis<\/center><\/h1>","047ae802":"<a id=\"load-datasets\"><\/a>\n<div class=\"list-group\" id=\"list-tab\" role=\"tablist\">\n<h1 class=\"list-group-item list-group-item-action active\" data-toggle=\"list\" style='background:#b02a4c; border:0; color:white' role=\"tab\" aria-controls=\"home\"><center>Load Dataset<\/center><\/h1>","402689f8":"### Pawpularity Score Histogram\nwe want to predict Pawpularity score using  Image and other binary feature related to image attribute related to pet. let's first see the distribution of Pawpularity score using Histogram.","a0079e22":"<a id=\"competition-overview\"><\/a>\n<div class=\"list-group\" id=\"list-tab\" role=\"tablist\">\n<h1 class=\"list-group-item list-group-item-action active\" data-toggle=\"list\" style='background:#b02a4c; border:0; color:white' role=\"tab\" aria-controls=\"home\"><center>Competition Overview<\/center><\/h1>","2784eb62":"1. [Competition Overview](#competition-overview)  \n2. [Load Datasets](#load-datasets)\n3. [Pawpularity Analysis](#pawpularity)\n4. [Image Metadata Analysis](#metadata)\n5. [Plotting Images based on Pawpularity Range](#range)\n6. [Future Work](#future)\n","f8800fe8":"I want to explore more on Image features, I am also considering to predict the meta data information based on image features and some features.","49692595":"### plot most popular image samples [Pawpularity Score = 100]","def881ec":"### Histogram Analysis:\n1. We can see from the histogram that these matadata information has corelation with pawpularity score (less blur, less occulsion, clear face has higher rating generally.)\n<\/br>\n2. histogram is skewed and there are lots of images with perfect 100 score, there are very few images for rating between 60-80. we can further plots the images based on range of score they fall in. ","f97985a0":"<div class=\"list-group\" id=\"list-tab\" role=\"tablist\">\n<h1 class=\"list-group-item list-group-item-action active\" data-toggle=\"list\" style='background:#b02a4c; border:0; color:white' role=\"tab\" aria-controls=\"home\" ><center>Contents<\/center><\/h1>"}}