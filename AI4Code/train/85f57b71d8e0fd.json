{"cell_type":{"641c5600":"code","7efea8cf":"code","1b0f97e7":"code","eff3ac6a":"code","4a2e9739":"code","30cf9cbe":"code","cf7feded":"code","bb8b9ab7":"code","c5954e6f":"code","8f7f13a4":"code","35e08385":"code","43258fc4":"code","54a59a17":"code","cca69f4c":"code","db5acf28":"code","aa0ab19f":"code","36d8776c":"code","d0b99f31":"code","4ab9c6b6":"code","59155929":"code","4c0b3f1a":"code","1c3e91d5":"code","36a7eb1a":"code","da7ec36b":"code","ed79ed31":"code","af5990f4":"code","4886ad81":"markdown","07c78742":"markdown","b1a9a33f":"markdown","a3f1239d":"markdown","e36003b4":"markdown","28b306ee":"markdown","50e9539d":"markdown","e9ece9ee":"markdown","91223939":"markdown","74f493bf":"markdown"},"source":{"641c5600":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport re\nfrom nltk.corpus import stopwords\nfrom nltk.stem.porter import PorterStemmer\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.linear_model import LogisticRegression\n# from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom wordcloud import WordCloud, STOPWORDS\nimport nltk\nnltk.download('stopwords')","7efea8cf":"news_dataset = pd.read_csv('..\/input\/fake-news\/train.csv')","1b0f97e7":"news_dataset.head()","eff3ac6a":"news_dataset.shape","4a2e9739":"news_dataset.isnull().sum()","30cf9cbe":"news_dataset = news_dataset.fillna('')","cf7feded":"news_dataset['data'] = news_dataset['author']+' '+news_dataset['title']","bb8b9ab7":"print(news_dataset['data'])","c5954e6f":"X = news_dataset.drop(columns='label', axis=1)\nY = news_dataset['label']","8f7f13a4":"print(X,'\\n\\n\\n\\n',Y)","35e08385":"stem_words = PorterStemmer()","43258fc4":"def stemming(data):\n    stemmed_content = re.sub('[^a-zA-Z]',' ',data)\n    stemmed_content = stemmed_content.lower()\n    stemmed_content = stemmed_content.split()\n    stemmed_content = [stem_words.stem(word) for word in stemmed_content if not word in stopwords.words('english')]\n    stemmed_content = ' '.join(stemmed_content)\n    return stemmed_content","54a59a17":"news_dataset['data'] = news_dataset['data'].apply(stemming)","cca69f4c":"stopwords = set(STOPWORDS)\nwordcloud = WordCloud(\n                        background_color='black',\n                        stopwords=stopwords,\n                        max_words=200, \n                        random_state=42).generate(str(news_dataset['data']))\n\nplt.figure(figsize=(15,10))\nplt.axis(\"off\")\nplt.title(\"Words frequented in text\", fontsize=15)\nplt.imshow(wordcloud.recolor(colormap= 'viridis' , random_state=42), alpha=0.98)\nplt.show()","db5acf28":"print(news_dataset['data'])","aa0ab19f":"X = news_dataset['data'].values\nY = news_dataset['label'].values","36d8776c":"print(X,'\\n\\n\\n\\n',Y)","d0b99f31":"vectorizer = TfidfVectorizer()\nvectorizer.fit(X)\n\nX = vectorizer.transform(X)","4ab9c6b6":"X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size = 0.2, stratify=Y, random_state=2)","59155929":"model = LogisticRegression()\nmodel.fit(X_train, Y_train)","4c0b3f1a":"X_train_prediction = model.predict(X_train)\ntraining_data_accuracy = accuracy_score(X_train_prediction, Y_train)","1c3e91d5":"print('Accuracy score of the training data : ', training_data_accuracy)","36a7eb1a":"X_test_prediction = model.predict(X_test)\ntest_data_accuracy = accuracy_score(X_test_prediction, Y_test)","da7ec36b":"print('Accuracy score of the test data : ', test_data_accuracy)","ed79ed31":"X_new = X_test[0]\nprediction = model.predict(X_new)\n\nif (prediction[0]==0):\n    print('The news is Real')\nelse:\n    print('The news is Fake')","af5990f4":"print(Y_test[0])","4886ad81":"# Modelling","07c78742":"### Training Accuracy ","b1a9a33f":"# Model Prediction","a3f1239d":"# Accuracy Check","e36003b4":"### About the Dataset:\n\n1. id: unique id for a news article\n2. title: the title of a news article\n3. author: author of the news article\n4. text: the text of the article; could be incomplete\n5. label: a label that marks whether the news article is real or fake:\n           1: Fake news\n           0: real News","28b306ee":"### Testing Accuracy ","50e9539d":"# Stemming","e9ece9ee":"# Importing Libraries","91223939":"# Visualizing","74f493bf":"# EDA"}}