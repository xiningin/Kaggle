{"cell_type":{"6da5a68f":"code","423d78bc":"code","e26b555b":"code","c25df334":"code","aaddd099":"code","4b03510a":"code","7c8f3ff3":"code","369949bd":"code","29d5cde0":"code","aa1972c1":"code","27c210fe":"code","3e7a27d3":"code","1987baf5":"code","cec43d0d":"markdown","f507a41b":"markdown","9b6b2d88":"markdown","9be4d00d":"markdown","1859e717":"markdown","1634e8f8":"markdown","fb90d51d":"markdown","eb0855ba":"markdown","eab5a056":"markdown"},"source":{"6da5a68f":"%%capture\n! pip install pingouin\nimport pandas as pd\nimport numpy as np\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\n\n# for stats analysis\n#import statsmodels.api as sm\nimport statsmodels.formula.api as smf\n#import scipy.stats\nimport pingouin as pg","423d78bc":"df = pd.read_csv('..\/input\/stat844advertising\/Advertising.csv')\ndf","e26b555b":"df.isnull().any()","c25df334":"fig,ax = plt.subplots(1, 2, figsize=(30,6))\nsns.set_theme()\nsns.histplot(data=df,x='Sales',ax=ax[0],kde=True,bins=50,color='violet')\nsns.boxplot(data=df,x='Sales',orient='h',ax=ax[1],linewidth=2.5,color='violet',width=0.35)\nsns.swarmplot(data=df,x='Sales',ax=ax[1],color='.25',size=4) ","aaddd099":"fig, ax = plt.subplots(figsize=(10,10))\npg.qqplot(df.Sales,dist='norm',ax=ax)","4b03510a":"fig,ax=plt.subplots(1,3,figsize=(20,6))\nsns.set_theme()\nsns.regplot(data=df,x='TV',y='Sales',color='.25',ax=ax[0])\nsns.regplot(data=df,x='Radio',y='Sales',color='.25',ax=ax[1])\nsns.regplot(data=df,x='Newspaper',y='Sales',color='.25',ax=ax[2])","7c8f3ff3":"from sklearn.linear_model import LinearRegression\n\nmodel = LinearRegression()\nx = df.drop('Sales',axis=1)\ny = df['Sales']\nmodel.fit(x,y)\nyh = model.predict(x)\nresiduals = y - yh","369949bd":"## sns.set_theme()\nfig, ax = plt.subplots(1,3,figsize=(30,9))\n\nsns.scatterplot(x=yh,y=y,color='.25',ax=ax[0])\nax[0].plot([0,25],[0,25],color='r')\nax[0].set(xlabel='Predicted',ylabel='Target',title='Preds vs Targets')\n\nsns.regplot(x=yh,y=residuals,color='r',order=2,ax=ax[1])\nax[1].hlines(y=0,xmin=0,xmax=25,color='k')\nax[1].set(xlabel='Predicted',ylabel='Residual',title='Preds vs Residuals')\n\nsns.regplot(x=y,y=residuals,color='r',order=2,ax=ax[2])\nax[2].hlines(y=0,xmin=0,xmax=25,color='k')\nax[2].set(xlabel='Target',ylabel='Residual',title='Targets vs Residuals')","29d5cde0":"fig, ax = plt.subplots(1,3,figsize=(30,9))\n\nsns.regplot(x=df.TV,y=residuals,color='r',order=2,ax=ax[0])\nax[0].hlines(y=0,xmin=0,xmax=300,color='k')\nax[0].set(xlabel='TV',ylabel='Residual',title='TV vs Residuals')\n\nsns.regplot(x=df.Radio,y=residuals,color='r',order=2,ax=ax[1])\nax[1].hlines(y=0,xmin=0,xmax=50,color='k')\nax[1].set(xlabel='Radio',ylabel='Residual',title='Radio vs Residuals')\n\nsns.regplot(x=df.Newspaper,y=residuals,color='r',order=1,ax=ax[2])\nax[2].hlines(y=0,xmin=0,xmax=115,color='k')\nax[2].set(xlabel='Newspaper',ylabel='Residual',title='Newspaper vs Residuals')","aa1972c1":"fig, ax = plt.subplots(figsize=(10,10))\npg.qqplot(residuals,dist='norm',ax=ax)","27c210fe":"fig, ax = plt.subplots(figsize=(15,6))\nsns.histplot(residuals,color='r',kde=True,bins=50)\nax.set(yticks=[],ylabel=None,xlabel='Residuals == y_true - y_pred',title='Residuals distribution')","3e7a27d3":"print('residual standard error: ', np.sqrt(np.sum(residuals**2)\/(len(x)-x.shape[1]-1)))","1987baf5":"model = smf.ols(formula = 'Sales ~ TV + Radio + Newspaper', data=df)\nresult = model.fit()\nprint(result.summary())","cec43d0d":"# Scatter plot with regression line","f507a41b":"# Diagnostics: normal QQ plot for residuals","9b6b2d88":"In this toy dataset, the targets are in the `Sales` column, the rest are the predictors.","9be4d00d":"# Residuals distribution","1859e717":"# Diagnostics: preds vs targets, preds vs residuals, targets vs residuals","1634e8f8":"# Normal QQ plot for targets","fb90d51d":"# Histogram & box plot of the targets","eb0855ba":"# Diagnostics: predictors vs residuals","eab5a056":"# Summary table for the linear model"}}