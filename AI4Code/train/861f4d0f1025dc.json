{"cell_type":{"8926c4aa":"code","4c2bad55":"code","9e87e146":"code","50b58e47":"code","4eac3e71":"code","e4c9e05b":"code","ce231172":"code","e29f2456":"code","12b1959f":"code","602417ba":"code","25d01d3b":"code","e076f105":"code","1b5df291":"code","d3f5fc11":"code","8351d545":"code","7c22839b":"code","a1c16463":"code","d5295c41":"markdown","f224080a":"markdown","6c5516a5":"markdown","93d9f183":"markdown","eaeafcfa":"markdown","32dc6c89":"markdown","9cf4ee02":"markdown","5f8c00d8":"markdown","4c981650":"markdown","8bcbad96":"markdown","ff7b5a60":"markdown","7e4a208f":"markdown","5fc3faff":"markdown"},"source":{"8926c4aa":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","4c2bad55":"import numpy as np \nimport pandas as pd \n# visualisation\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n# prediction model\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression","9e87e146":"df = pd.read_csv('\/kaggle\/input\/the-ultimate-halloween-candy-power-ranking\/candy-data.csv')","50b58e47":"df","4eac3e71":"df.describe().T","e4c9e05b":"# Competitors unique per row?\n# How many different competitors are there?\nprint('How many different competitors? ', len(df.competitorname.unique()))\n# looking upper see hbiw bigger than the rest then better to rescale to not lose stuff\nprint('rescaling winpercent...')\n# scale winpercent between 0 and 1\ndf.winpercent = df.winpercent\/100","ce231172":"df.describe().T","e29f2456":"df.info()","12b1959f":"# consider a matrix of features X for later\nX = df.copy()\nX.drop('competitorname', axis=1, inplace=True)\nX","602417ba":"plt.figure(figsize=(10, 10)) # set figure size\ncorr_heat = sns.heatmap(X.corr(), vmin=-1, vmax=1, center=0, annot=True, cmap=\"YlGnBu\")","25d01d3b":"# see how scater of non binary labels look like ~ correlation\n# we do not expect to find high correlation, because of previous results\nplt.figure(figsize=(8, 8))\nplt.scatter(X['sugarpercent'], X['pricepercent'], color='blue')\nplt.scatter(X['sugarpercent'], X['winpercent'], color='red')\nplt.scatter(X['pricepercent'], X['winpercent'], color='green')","e076f105":"df_s = df.sort_values(by=\"winpercent\", ascending=False)\n\nplt.figure(figsize=(15,15))\nsns.barplot(y=df_s[\"competitorname\"], x=df_s[\"winpercent\"])\nplt.title('Ranking (winpercent normalized)')","1b5df291":"winner = df_s[0:1]\nwinner","d3f5fc11":"# focusin on the correlations with winpercent \ndf.corr()[\"winpercent\"]\nwp_corr = df.corr()[\"winpercent\"]\n\nwp_corr.sort_values(ascending=False)","8351d545":"y = X['chocolate']\nX.drop(['chocolate'], axis=1, inplace=True)\nX","7c22839b":"# split in train and test set\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2,random_state=1)","a1c16463":"#apply model\nmodel = LogisticRegression()\nmodel.fit(X_train, y_train)\nprint(f\"Model Accuracy: {model.score(X_test, y_test)}\")","d5295c41":"Winner: Peanut Butter Cup, favorite one","f224080a":"- Which qualities are associated with higher rankings?","6c5516a5":"We find that the most correlated is  chocolate","93d9f183":"Logistic Regression using a sklearn library.\n\nThe creation of the matrix of features (X) already done before.\nWe still need to drop chocolate off  to a separate vector y, which is the variable that we want to predict knowing the others.\n","eaeafcfa":"Before, a full correlation matrix to explore the data was presented.\nWe can focus on the correlation between win percentage and other features","32dc6c89":"# - Exploring the Data","9cf4ee02":"About the data:\n\n* chocolate: Does it contain chocolate?\n* fruity: Is it fruit flavored?\n* caramel: Is there caramel in the candy?\n* peanutalmondy: Does it contain peanuts, peanut butter or almonds?\n* nougat: Does it contain nougat?\n* crispedricewafer: Does it contain crisped rice, wafers, or a cookie component?\n* hard: Is it a hard candy?\n* bar: Is it a candy bar?\n* pluribus: Is it one of many candies in a bag or box?\n* sugarpercent: The percentile of sugar it falls under within the data set.\n* pricepercent: The unit price percentile compared to the rest of the set.\n* winpercent: The overall win percentage according to 269,000 matchups.","5f8c00d8":"# - Regression Classification","4c981650":"* Let us take a look to the **correlations** first.","8bcbad96":"Competirtor name is a categorical, then we need to transform this in order to use it.\ne.g. use one hot encoder. How ever not a v good option cus we have 85 different names and \nprobs we will not handle the name of the candy but the characteristics. \nSo then we can kinda expclude de first line innit?","ff7b5a60":"# - Data Visualization","7e4a208f":"Proposed problem \/ Logistic regression: Can you predict if a candy is chocolate or not based on its other features?\n\n\nWhat else can we study:\n> What\u2019s the most popular candy? \n\n> Which qualities are associated with higher rankings?\n\n\n\n\n","5fc3faff":"* Let us see percentage of wining ordered"}}