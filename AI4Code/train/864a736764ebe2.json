{"cell_type":{"6afb3950":"code","c252fca9":"code","cdfcb5f7":"code","96a01581":"code","d1f7268d":"code","2801af4d":"code","dd44f23f":"code","c497a29e":"code","10fc190e":"code","8ba8fe1e":"code","afad083b":"code","892ac2b4":"markdown","4031e987":"markdown","9d19083d":"markdown","e3857889":"markdown","d5151f8a":"markdown","caa3e34b":"markdown"},"source":{"6afb3950":"import numpy as np\nimport pandas as pd \nfrom catboost import CatBoostClassifier\nimport seaborn as sns","c252fca9":"train = pd.read_csv(\"..\/input\/petfinder-adoption-prediction\/train\/train.csv\")\ntrain.head()","cdfcb5f7":"test = pd.read_csv(\"..\/input\/petfinder-adoption-prediction\/test\/test.csv\")\ntest.head()","96a01581":"sample_submission = pd.read_csv(\"..\/input\/petfinder-adoption-prediction\/test\/sample_submission.csv\")\nsample_submission.head()","d1f7268d":"categorical_columns = [\"Type\", \"Breed1\", \"Breed2\", \"Gender\", \"Color1\", \"Color2\", \"Color3\", \"MaturitySize\", \"Vaccinated\", \"Dewormed\", \"Sterilized\", \"Health\", \"State\"]\nnumerical_columns = [\"Age\", \"Fee\", \"VideoAmt\", \"PhotoAmt\"]","2801af4d":"import seaborn as sns\nimport matplotlib.pyplot as plt\nfor i in range(len(categorical_columns)):\n    sns.countplot(x=categorical_columns[i], data=train)\n    plt.title(\"Distribtion of %s\"%(categorical_columns[i]))\n    plt.show()\nfor i in range(len(numerical_columns)):\n    train[numerical_columns[i]].hist()\n    plt.title(\"Distribtion of %s\"%(numerical_columns[i]))\n    plt.show()","dd44f23f":"data = pd.DataFrame()\ndata = data.append(train)\ndata = data.append(test)\ndfs = []\nfor i in range(len(categorical_columns)):\n    df = pd.get_dummies(data[categorical_columns[i]])\n    df.columns = [categorical_columns[i] + \"_\" + str(column) for column in df.columns]\n    dfs.append(df)\nnumeric_df = data[numerical_columns]\nnumeric_df = (numeric_df - numeric_df.mean()) \/ numeric_df.std()\ndfs.append(numeric_df)\ndf = pd.concat(dfs, axis=1)\ntrain_features = df.iloc[:len(train)]\ntest_features = df.iloc[len(train):]","c497a29e":"from sklearn.model_selection import train_test_split\ntrain_targets = train[\"AdoptionSpeed\"]\nX_train, X_val, y_trian, y_val = train_test_split(train_features, train_targets, test_size=0.1)\nX_train.shape, X_val.shape, y_trian.shape, y_val.shape","10fc190e":"cat_params = {\n    \"iterations\": 15000,\n    \"learning_rate\": 0.03,\n    \"depth\": 7,\n    \"verbose\": 1000,\n    'od_wait': 1000,\n    'eval_metric': 'Accuracy',\n}\nmodel = CatBoostClassifier(**cat_params)\nmodel.fit(X_train, y_trian, eval_set=(X_val, y_val))","8ba8fe1e":"y_pred = model.predict(test_features)\ny_pred.shape","afad083b":"sample_submission[\"AdoptionSpeed\"] = y_pred\nsample_submission.to_csv(\"submission.csv\", index=False)\nsample_submission.head()","892ac2b4":"## Preprocessing","4031e987":"## Train Validation Split","9d19083d":"## Distributions","e3857889":"## Modeling","d5151f8a":"## PetFinder Adoption Speed Prediction with CatBoost","caa3e34b":"## Submission"}}