{"cell_type":{"c8579a24":"code","becf8daf":"code","337dfcf8":"code","92fb47ac":"code","c16920c7":"code","f556e551":"code","9f7c6c28":"code","70205e0a":"code","b51636c6":"code","5b770b45":"code","2b7012ea":"code","911f02de":"code","8d167c1d":"code","0097e0af":"code","fbe3f3b8":"code","b8ecb781":"code","39ce2c7a":"code","a4c2bec3":"code","444c4c2f":"code","83c1081e":"code","680c11f1":"code","a3f7eb9a":"code","e1ed27ec":"code","0f7b47dc":"code","8a059eb6":"code","c1209cb2":"code","8254c7bf":"code","6305a761":"code","902b09c4":"code","9861b73c":"code","953227ba":"code","1277e3ba":"markdown","0771790a":"markdown","9e8553e4":"markdown","10d96ce8":"markdown","eab2e55f":"markdown","2008adc1":"markdown","8b2d3571":"markdown","3ab4d7e0":"markdown","820767ac":"markdown","fe35d722":"markdown","22293bd7":"markdown"},"source":{"c8579a24":"import pandas as pd","becf8daf":"genres = pd.read_csv('\/kaggle\/input\/bible\/key_genre_english.csv')\nkjv_bible = pd.read_csv('\/kaggle\/input\/bible\/t_kjv.csv')\nbook = pd.read_csv('\/kaggle\/input\/bible\/key_english.csv')","337dfcf8":"genres.head()","92fb47ac":"kjv_bible.head()","c16920c7":"book.head()","f556e551":"book = pd.merge(book, genres, on='g')","9f7c6c28":"book.head()","70205e0a":"df = pd.merge(kjv_bible, book, left_on = 'b', right_on = 'b')","b51636c6":"df.head()","5b770b45":"df = df.rename(columns={'t_x': 'content', 'n_x' : 'book', 't_y' : 'testament', 'n_y' : 'genre'})","2b7012ea":"df.head()","911f02de":"df['word_count'] = df['content'].str.split().str.len()","8d167c1d":"df.head()","0097e0af":"df.to_csv('\/kaggle\/working\/word_count.csv', index = False)","fbe3f3b8":"df.groupby(by=['book', 'testament', 'genre']).agg({\n    'c' : 'max',\n    'v' : 'count'\n}).reset_index().sort_values(['v'], ascending = False)","b8ecb781":"import nltk\nnltk.download('punkt')\nnltk.download('stopwords')\n\nimport string\nfrom nltk import word_tokenize, FreqDist\nfrom nltk.corpus import stopwords","39ce2c7a":"df_2 = df","a4c2bec3":"df_2['tokenized'] = df.apply(lambda row: nltk.word_tokenize(row['content']), axis=1)","444c4c2f":"df_2.head()","83c1081e":"df_2['no_p'] = df_2.apply(lambda row: [ t for t in row['tokenized'] if t not in string.punctuation ], axis=1)","680c11f1":"df_2['lowercase'] = df_2.apply(lambda row: [ t.lower() for t in row['no_p'] ], axis=1)","a3f7eb9a":"# Create a stopword list from the standard list of stopwords available in nltk\nstop = stopwords.words('english')\nstop = stop + ['thy', 'shall', 'would', 'could', 'upon', 'thereof', 'unto', 'thee', 'thou', 'shalt', 'saith', 'said', 'ye', 'hath', 'also', 'us', 'say', 'things', 'saying' ,'\\'s', 'even', 'hast', 'according', 'thus', 'like', 'therein']\nprint(stop)\nlen(stop)","e1ed27ec":"#Remove stop words\ndf_2['no_stop'] = df_2.apply(lambda row: [ t for t in row['lowercase'] if t not in stop ], axis=1)","0f7b47dc":"df_2.head()\n#We can see how each of the steps are reflected in the columns: tokenized, no_p, lowercase, no_stop.","8a059eb6":"df_wc = df_2.explode('no_stop')","c1209cb2":"df_wc.head()","8254c7bf":"df_wc = df_wc.groupby(by = ['book','c','v','testament','genre', 'no_stop']).agg({'no_stop' : 'count'})","6305a761":"df_wc = df_wc.rename(columns={'no_stop':'count'})","902b09c4":"df_wc = df_wc.reset_index()\ndf_wc = df_wc.sort_values('count', ascending = False)\ndf_wc.head()","9861b73c":"df_wc.to_csv('\/kaggle\/working\/word_token_frequency.csv', index = False)","953227ba":"df_wc.groupby(['testament','book', 'no_stop']).agg({'count': 'sum'}).reset_index().sort_values(['testament','book','count'], ascending = [True,True,False])","1277e3ba":"**Step 4: Create a list of stopwords**\nSince I want to create a word cloud from this, I would need to remove the stopwords.","0771790a":"# **Creating Dataset 1 : KJV Bible**\n# \nHere, we have created the complete dataset of KJV Bible, each book, chapter and verse with the corresponding genre and word count.","9e8553e4":"# **Creating Dataset 2: Words of the Bible**","10d96ce8":"**Step 3: Convert all to lowercase**","eab2e55f":"**Step 1. Tokenise the text into a list of words**","2008adc1":"# **Dataset 2 (Completed): Words of the Bible**\nIn **df_wc**, we have the count of each word from each verse, chapter, book, genre. This can easily be grouped by books, chapters, genres or testament, and a word cloud can then be generated. ","8b2d3571":"# **Dataset 1 (Completed) : KJV Bible**\n\nIn **df**, we have created the complete dataset of KJV Bible, each book, chapter and verse with the corresponding genre and word count.\n\nThis dataset can be readily used in various ways, such as descriptive statistics of book length, verse length, etc.","3ab4d7e0":"**Step 2: Remove punctuations**","820767ac":"**Here is an example of a word cloud dashboard in Tableau that I made:\n[https:\/\/public.tableau.com\/profile\/nathan.timothy.handoko#!\/vizhome\/BibleStatisticsKJV\/BibleWordCloud](http:\/\/)**","fe35d722":"Here is an example to get the number of chapters and verses by Bible Books.","22293bd7":"For example, here I group it by books, so we can see the most common words in the book."}}