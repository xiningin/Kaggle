{"cell_type":{"770f1e8b":"code","b4e2e0f5":"code","1e5af6df":"code","b858c494":"code","24bc686d":"code","d90e8a57":"code","f1e47c87":"code","b428e639":"code","27300304":"code","93515e72":"code","54e95819":"code","dc2caefe":"code","438c915c":"code","6dcb49db":"code","909768b5":"code","ac8632d2":"code","d040a58f":"code","8c6ed585":"code","8f79d772":"code","51740036":"markdown","ec9fbcb4":"markdown","52d58e3b":"markdown","bdac6908":"markdown","5c19c2a7":"markdown","0b555af3":"markdown","793ffe35":"markdown","94f126cd":"markdown","247a1c25":"markdown","50852a89":"markdown","d5bf6a19":"markdown","f8ba9746":"markdown","1b0ad3b3":"markdown","16ff5f1b":"markdown","b591de8f":"markdown","d4802711":"markdown","8248b1e7":"markdown","d4eb450d":"markdown","5c281470":"markdown"},"source":{"770f1e8b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt # data visualization\nimport plotly.express as px #data visualization\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","b4e2e0f5":"train_df = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ntrain_df.head()","1e5af6df":"train_df.describe()","b858c494":"train_df.isnull().sum()","24bc686d":"survived = train_df.groupby(\"Survived\")[\"PassengerId\"].count().reset_index(name=\"count\")\nsurvived_pie = px.pie(survived, values=\"count\", names=\"Survived\", title=\"Survivor Spread\")\nsurvived_pie.show()","d90e8a57":"gender = train_df.groupby(\"Sex\")[\"PassengerId\"].count().reset_index(name=\"count\")\ngender_pie = px.pie(gender, values=\"count\", names=\"Sex\", title=\"Gender Spread\")\ngender_pie.show()","f1e47c87":"male_df = train_df[train_df.Sex == \"male\"]\nmale = male_df.groupby(\"Survived\")[\"PassengerId\"].count().reset_index(name=\"count\")\nmale_pie = px.pie(male, values=\"count\", names=\"Survived\", title=\"Male Survival Spread\", color=\"Survived\", color_discrete_map={1:\"lightcyan\", 0:\"royalblue\"})\nmale_pie.show()","b428e639":"female_df = train_df[train_df.Sex == \"female\"]\nfemale = female_df.groupby(\"Survived\")[\"PassengerId\"].count().reset_index(name=\"count\")\nfemale_pie = px.pie(female, values=\"count\", names=\"Survived\", title=\"Female Survival Spread\", color=\"Survived\", color_discrete_map={1:\"lightcyan\", 0:\"royalblue\"})\nfemale_pie.show()","27300304":"pclass_1_df = train_df[train_df.Pclass == 1]\npclass_1 = pclass_1_df.groupby(\"Survived\")[\"PassengerId\"].count().reset_index(name=\"count\")\npclass_1_pie = px.pie(pclass_1, values=\"count\", names=\"Survived\", title=\"Pclass1 Survived Spread\", color=\"Survived\", color_discrete_map={1:\"#09FF00\", 0:\"#FF0000\"})\npclass_1_pie.show()","93515e72":"pclass_2_df = train_df[train_df.Pclass == 2]\npclass_2 = pclass_2_df.groupby(\"Survived\")[\"PassengerId\"].count().reset_index(name=\"count\")\npclass_2_pie = px.pie(pclass_2, values=\"count\", names=\"Survived\", title=\"Pclass2 Survived Spread\", color=\"Survived\", color_discrete_map={1:\"#09FF00\", 0:\"#FF0000\"})\npclass_2_pie.show()","54e95819":"pclass_3_df = train_df[train_df.Pclass == 3]\npclass_3 = pclass_3_df.groupby(\"Survived\")[\"PassengerId\"].count().reset_index(name=\"count\")\npclass_3_pie = px.pie(pclass_3, values=\"count\", names=\"Survived\", title=\"Pclass3 Survived Spread\", color=\"Survived\", color_discrete_map={1:\"#09FF00\", 0:\"#FF0000\"})\npclass_3_pie.show()","dc2caefe":"age_survivor_df = train_df[[\"Survived\", \"Age\"]]\nage_survivor_df = age_survivor_df.dropna()\nage_survivor_df.groupby([\"Survived\"]).mean()","438c915c":"age_survivor_1_df = age_survivor_df[age_survivor_df.Survived == 1]\nage_survivor_1_df = age_survivor_1_df.drop(columns=[\"Survived\"])\nage_survivor_1_df.hist()\nplt.title(\"Histogram for Age of Survivors\")","6dcb49db":"age_survivor_0_df = age_survivor_df[age_survivor_df.Survived == 0]\nage_survivor_0_df = age_survivor_0_df.drop(columns=[\"Survived\"])\nage_survivor_0_df.hist()\nplt.title(\"Histogram for Age of Non-survivors\")\n","909768b5":"train_df = train_df[train_df[\"Age\"].notna()]\ntrain_df = train_df.replace([\"male\"],0)\ntrain_df = train_df.replace([\"female\"],1)\nX_train = train_df[[\"Sex\", \"Pclass\", \"Age\"]]\nY_train = train_df[\"Survived\"]\nmean_age = train_df[\"Age\"].mean()\ntest_df = pd.read_csv(\"..\/input\/titanic\/test.csv\")\nX_test = test_df[[\"Sex\", \"Pclass\", \"Age\"]]\nX_test = X_test.replace([\"male\"],0)\nX_test = X_test.replace([\"female\"],1)\nX_test = X_test.fillna(mean_age)\nX_train.shape, Y_train.shape, X_test.shape\n","ac8632d2":"from sklearn.neighbors import KNeighborsClassifier","d040a58f":"neigh = KNeighborsClassifier(n_neighbors=3)\nneigh.fit(X_train, Y_train)\nY_pred = neigh.predict(X_test)\nprint(neigh.predict([[1, 3, 5]])) #Prediction for Sex: female, Pclass: 3, Age: 5\nprint(neigh.predict([[0, 1, 10]])) #Prediction for Sex: male, Pclass: 1, Age: 10\nprint(neigh.predict([[0, 1, 70]])) #Prediction for Sex: male, Pclass: 1, Age: 70\nprint(neigh.predict([[1, 3, 45]])) #Prediction for Sex: female, Pclass: 3, Age: 45\n\n#Saving our predicted Y values\nY_pred = neigh.predict(X_test)\nprint(Y_pred.shape)","8c6ed585":"knn_accuracy = neigh.score(X_train, Y_train)\nprint(knn_accuracy)","8f79d772":"submission = pd.DataFrame({\n        \"PassengerId\": test_df[\"PassengerId\"],\n        \"Survived\": Y_pred\n    })\n\nsubmission.to_csv(\"submission.csv\",index=False)\n\n","51740036":"# Modeling \n\nWe will now begin creating a model. \n\nLooking back at our aims we want to be able to classify someone whether he is a survivor or non-survivor (1, 0 in Survival). To do this we will use a KNN or k-Nearest Neighbors machine learning algorithm.\n\nBased on our observations in the data exploration phase we will be using the following factors to classify:\n1. Sex\n2. Pclass\n3. Age < 20 \n\n\n","ec9fbcb4":"There appears to be a very strong connection between the Pclass and survival. \n\nThe causation seems the be obvious depending on the class ticket the passanger was likely to be on a different location on the ship, and so certain locations have a lower chance of survival because they are physically \/ geographically disadvantaged. ","52d58e3b":"# Data Exploration\n\nAfter importing the data files (train.csv and test.csv) we can begin exploring the data.\n\nWe will only use train.csv for data exploration, modelling and analysis, that way we have a non biased sample (test.csv) to test the accuracy of our models and conclusions.\n\n**Aims in data exploration:**\n* Understand how the data is spread.\n* What type of data do we have? categorical ... continuous?\n* Is there any obvious correlation or pattern we notice in the data? \n","bdac6908":"Now we will observe how the difference in pclass affects survival. ","5c19c2a7":"Importing the machine learning libraries.","0b555af3":"We will now check for any null or 0 values.","793ffe35":"# Conclusion from data exploration\n\n* The probability of a female passenger surviving is much higher than that of a male passenger.\n* The Pclass has a significant correlation with the probability of survival, the lower the Pclass (range(1, 3, 1)) the higher the probability of survival.\n* The mean age of those that survived is lower than those that did not survive. However, it appears to be due passengers under the age of 20 having a significantly higher probability of survival. ","94f126cd":"Finally we will observe how age affects survival (remembering to take into account the null age values, in our case just ignoring them). \n\n*It is possible to look specifically at the survival of the null Age passengers to see if it weights heavily on the results.*","247a1c25":"We will now create our model and train it using our train data.","50852a89":"# **Titanic survival data analysis**\n\nThis is my first attempt at a kaggle competition, so I am just trying to have a go at the data see if I can find anything interesting. *Just testing the waters.* \n\nGoals:\n* Observe how different factors influence the probability of survival.\n* Create a model that accurately classifies someone into survivor or non-survivor. \n* Asses how accurate the model is.","d5bf6a19":"We can see that the mean age of those that survived is slightly lower than those that didn't. Let's see if a histogram of the data will tell us more. ","f8ba9746":"**As we can see Age, Cabin and Embarked all contain null values we will have to remember to take it into account when working with these factors.**","1b0ad3b3":"Initially we will tweak our train_df dataset keeping only the rows where Age is not null (for our test_df we will simply replace the null values with the mean age). Then in the Sex column we will change male to 0 and female to 1, so we can plug it into our algorithm. then we will set our Survived column as our index for Y_test.\n\n*Ideally we would want to predict the age values for the nulls using correlations we find with age and other features.*\n\nThen we define our X and Y values of our training data, and the X values of our test data.","16ff5f1b":"We can see that the predictions match fairly well what we observed in the data.\n\nLet's see our accuracy score.","b591de8f":"0.86, that's quite good. However, keep in mind that because in our test_df we replaced the null Age values with the average age it is likely to reduce our accuracy. ","d4802711":"As we can tell by the spreads **female survive at a much higher rate than male** (female are 393% more likely to survive than male).\n\nThe causality might raise a question (why would female be more likely to survive than male?), there could be another factor that influences the survival odds (women where placed on a certain part of the ship that wasn't impacted as much by the crash).\n\n*We might want to explore how other factors such as Pclass, Age, Cabin, Embarked differ for female than male.*","8248b1e7":"The survivor spread indicates that approximately 1\/3 of the passengers survived and the gender spread indicates that approximately 1\/3 of the passengers were female.\n\nPerhaps female passengers have a higher survival rate.\n\nLets look at female survival rate compared to the male survivor rate. ","d4eb450d":"There doesn't seem to be a real difference in the histogram of the age of those that survived and those that didn't. However, it appears that **those that are younger than 20 have a much better chance of surviving.** ","5c281470":"We appear to have both continuous and categorical data.\n\nContinuous:\n* PassengerId\n* Age\n* SibSp\n* Parch\n* Fare \n\nCategorical: \n* Survived (0 = No, 1 = Yes)\n* Pclass \n* Name\n* Sex \n* Ticket \n* Cabin \n* Embarked\n\nWe also appear to have data is several different formats (strings, numbers, alphanumeric). "}}