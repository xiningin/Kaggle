{"cell_type":{"e51f85a6":"code","24132ad1":"code","c1c458dd":"markdown","a622ed84":"markdown","24ab2e6f":"markdown"},"source":{"e51f85a6":"import cv2\nimport pandas as pd\nimport numpy as np\nimport os, time, random\n#!conda install -c menpo opencv=2.4.11\nimport matplotlib.pyplot as plt\nfrom IPython.display import Image, clear_output","24132ad1":"#Preprocessing\n\ndf = pd.read_csv('..\/input\/stanfordcardatasetediting\/anno_trainnewyedek.csv')\n#add '_id'\ndf.rename(columns={'image':'image_id'}, inplace=True)\n#delete '.img' \ndf['image_id'] = df['image_id'].apply(lambda x: x.split('.')[0])\n\n#make random choice\nindex = list(set(df.image_id))\nimage = random.choice(index)\nprint(\"Image ID: %s\"%(image))\nimg = cv2.imread(f'..\/input\/stanford-cars-dataset\/cars_train\/cars_train\/{image}.jpg')\nimg=cv2.resize(img,(640,480))\nimg.shape\n\n#Haar Cascade\ncar_cascade = cv2.CascadeClassifier('..\/input\/car-cascade\/cascade.xml')\n\n\ngray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)\ncars = car_cascade.detectMultiScale(gray,scaleFactor=1.1,minNeighbors=5,minSize=(100,100),flags=cv2.CASCADE_SCALE_IMAGE)\n\n    \nfor (x,y,w,h) in cars:\n    cv2.rectangle(img,(x,y),(x+w,x+h),(0,0,255),2)\n\nplt.figure(figsize=(18,15))\nplt.imshow(img)\nplt.xticks([])\nplt.yticks([])\nplt.show()","c1c458dd":"Note: You can see four random object detection results in one of the four input (randomimagesfromcode)","a622ed84":"# **Code**","24ab2e6f":"# **Libraries**"}}