{"cell_type":{"41726328":"code","91115cc0":"code","173674eb":"code","c567a9e1":"code","cfa16cc9":"code","3e15421a":"code","ab546028":"code","057a6db3":"markdown","1a31b94e":"markdown","a88339eb":"markdown","3da8e71a":"markdown"},"source":{"41726328":"import pandas as pd","91115cc0":"train = pd.read_csv('\/kaggle\/input\/shopee-product-matching\/train.csv')\ntest =  pd.read_csv('\/kaggle\/input\/shopee-product-matching\/test.csv')\ndisplay(train.head())\ndisplay(test.head())","173674eb":"sample = pd.read_csv('\/kaggle\/input\/shopee-product-matching\/sample_submission.csv')\nsample","c567a9e1":"test_list = test[['posting_id', 'title', 'image', 'image_phash']].reset_index(drop=True).values.tolist()","cfa16cc9":"submission_list = []\n# ==========================================\n# Case. title[1] & image[2] & image_phash[3]\n# ==========================================\nfor item in test_list:\n    res1 = test[test['title']==item[1]]['posting_id'].unique().tolist()\n    res2 = test[test['image']==item[2]]['posting_id'].unique().tolist()\n    res3 = test[test['image_phash']==item[3]]['posting_id'].unique().tolist()\n    res = list(set(res1 + res2 + res3))\n    \n    res.remove(item[0])\n    matches = ' '.join(map(str, res))\n    matches = f'{item[0]} {matches}'\n    submission_list.append([item[0], matches])","3e15421a":"submission = pd.DataFrame(submission_list, columns = ['posting_id','matches'])\nsubmission.to_csv('submission.csv', index=False)","ab546028":"submission.head()","057a6db3":"# About this notebook\nThis is a simple baseline.\n- Use `title`, `image`, `image_phash`\n\n- `v3` - initial baseline using `image_phash` (If you want to submit and get `0.559`, please use v3)\n- `v4` - cleaning codes\n- `v6` - merge `title`, `image`, `image_phash` and need to submit it.\n- `v7` - simple baseline using `title`, `image`, `image_phash`.\n- `v9` - remove inner for loop (public lb `0.573`)\n\nRef. https:\/\/www.kaggle.com\/isaienkov\/shopee-data-understanding-and-analysis","1a31b94e":"<a id=\"1\"><\/a>\n<h2 style='background:black; border:0; color:white'><center>Simple Baseline<\/center><h2>","a88339eb":"<a id=\"0\"><\/a>\n<h2 style='background:black; border:0; color:white'><center>Load dataset<\/center><h2>","3da8e71a":"<a id=\"2\"><\/a>\n<h2 style='background:black; border:0; color:white'><center>Making Submission<\/center><h2>"}}