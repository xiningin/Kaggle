{"cell_type":{"732a464b":"code","a798ca54":"code","b9172a4c":"code","0f73f27f":"code","d707fbad":"code","0bdf1c01":"code","70600e83":"code","0df9f99f":"code","40ee3d82":"code","8b57ebc4":"code","9a683cb5":"code","db0f7eec":"code","7dd0cbee":"code","43b13e76":"code","464131d2":"code","f3d10d01":"code","dc9cb287":"code","bda3640a":"code","98a328ed":"code","eb699af5":"code","93f25b2d":"code","3ea0ad48":"code","703c4e04":"markdown","bb18ce19":"markdown","b0d19b1e":"markdown","be5065df":"markdown","77cf59d0":"markdown","197dbceb":"markdown","1af835f5":"markdown","2b1016b7":"markdown","5e3509f5":"markdown","60cb3d5d":"markdown","66038750":"markdown","3c0af0bc":"markdown","fa05120f":"markdown","162262f1":"markdown","dd56c9fe":"markdown","26cedd14":"markdown","e4da4bcc":"markdown","99b62362":"markdown","6799b4fc":"markdown","75b63ff9":"markdown","0e43cf1e":"markdown","78a5a73e":"markdown"},"source":{"732a464b":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# For visualizations\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport squarify\nimport networkx as nx\nfrom wordcloud import WordCloud\n\nfrom mlxtend.frequent_patterns import apriori, association_rules\n\nfrom mlxtend.preprocessing import TransactionEncoder\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","a798ca54":"data = pd.read_csv('\/kaggle\/input\/market-basket-optimization\/Market_Basket_Optimisation.csv', header = None)\nprint('Data is loaded!')","b9172a4c":"data.head()","0f73f27f":"data.shape","d707fbad":"data.dtypes","0bdf1c01":"data.info()","70600e83":"data.describe()","0df9f99f":"plt.rcParams['figure.figsize'] = (14, 14)\nwordcloud = WordCloud(background_color = 'white', width = 1200,  height = 1200, max_words = 121).generate(str(data[0]))\nplt.imshow(wordcloud)\nplt.axis('off')\nplt.title('Most Popular Items',fontsize = 15)\nplt.show()","40ee3d82":"# looking at the frequency of most popular items \n\nplt.rcParams['figure.figsize'] = (18, 7)\ncolor = plt.cm.viridis(np.linspace(0, 1, 40))\ndata[0].value_counts().head(40).plot.bar(color = color)\nplt.title('Frequency of most popular items', fontsize = 20)\nplt.xticks(rotation = 90 )\nplt.grid()\nplt.show()","8b57ebc4":"y = data[0].value_counts().head(50).to_frame()\ny.index","9a683cb5":"# plotting a tree map\n\nplt.rcParams['figure.figsize'] = (18, 18)\ncolor = plt.cm.viridis(np.linspace(0, 1, 50))\nsquarify.plot(sizes = y.values, label = y.index, alpha=.7, color = color)\nplt.title('Tree Map for Popular Items')\nplt.axis('off')\nplt.show()","db0f7eec":"data['food'] = 'Food'\nfood = data.truncate(before = -1, after = 15)\nfood = nx.from_pandas_edgelist(food, source = 'food', target = 0, edge_attr = True)","7dd0cbee":"plt.rcParams['figure.figsize'] = (18, 18)\npos = nx.spring_layout(food)\ncolor = plt.cm.Wistia(np.linspace(0, 15, 1))\nnx.draw_networkx_nodes(food, pos, node_size = 15000, node_color = color)\nnx.draw_networkx_edges(food, pos, width = 3, alpha = 0.6, edge_color = 'black')\nnx.draw_networkx_labels(food, pos, font_size = 20, font_family = 'sans-serif')\nplt.axis('off')\nplt.grid()\nplt.title('Top 15 First Choices', fontsize = 40)\nplt.show()","43b13e76":"# Making each customers shopping items an identical list\ntransactions = []\nfor i in range(0, 7501):\n  transactions.append([str(data.values[i,j]) for j in range(0, 20)])","464131d2":"# Apply TransactionEncoder to learns the unique labels in the dataset.\ntransac = TransactionEncoder()\ndataset = transac.fit_transform(transactions)\ndataset","f3d10d01":"data = pd.DataFrame(dataset, columns= transac.columns_)\ndata.head()","dc9cb287":"# Apply Apriori Algorithm to find out most frequent itemset with min support of 0.003\n\nfrequent_itemsets = apriori(data, min_support=0.003, use_colnames=True)\nfrequent_itemsets['length'] = frequent_itemsets['itemsets'].apply(lambda x : len(x))","bda3640a":"frequent_itemsets.head()","98a328ed":"# Filter Frequent itemset of minimum length 3\n\nfrequent_itemsets[frequent_itemsets['length'] >= 3].head(10)","eb699af5":"# Association Rules Mining to generate the rules with their coresponding support\nrules = association_rules(frequent_itemsets, metric='lift', min_threshold=1)\nrules.head(20)","93f25b2d":"rules.shape","3ea0ad48":"rules[(rules['lift'] >= 6) & (rules['confidence'] >= 0.4)]","703c4e04":"<div align='left'><font size=\"3\" color=\"#000000\"> Market Basket Analysis is a modelling technique based upon the theory that if you buy a certain group of items, you are more (or less) likely to buy another group of items. For example, if you are in an English pub and you buy a pint of beer and don't buy a bar meal, you are more likely to buy crisps (US. chips) at the same time than somebody who didn't buy beer.\n<\/font><\/div>\n\n* **Problem Statement:**\n<div align='left'><font size=\"3\" color=\"#000000\"> Market owners should want to know what customers will buy next by looking at the products they buy, so that market owners can adjust their product placement to increase product sales. This can be overcome by using the Apriori Algorithm to perform a Market Basket Analysis of the customer's buying behavior.\n<\/font><\/div>","bb18ce19":"<a id=\"association_mining\"><\/a>\n## 5. Association Mining","b0d19b1e":"<div align='left'><font size=\"3\" color=\"#000000\"> An association rule has two parts: an antecedent (if) and a consequent (then). An antecedent is an item found within the data. A consequent is an item found in combination with the antecedent.\n<\/font><\/div>\n\n","be5065df":"<a id=\"data_acquistion\"><\/a>\n## 2. Data Acquisition","77cf59d0":"<div align='left'><font size=\"3\" color=\"#000000\"> From the results above, it provides several transactions that have high score of lift and confidence. We can tell it from the first row that:\n<\/font><\/div>\n\n\n* <div align='left'><font size=\"3\" color=\"#000000\"> Support shows that 0.03% customers purchased mineral water, whole wheat pasta, and olive oil.\n<\/font><\/div>\n\n* <div align='left'><font size=\"3\" color=\"#000000\"> Confidence shows that 40.2% of the customers that bought mineral water and whole wheat also bought olive oil.\n<\/font><\/div>\n\n* <div align='left'><font size=\"3\" color=\"#000000\"> A lift ratio greater than 1.0 implies a more significant association, with lift indicating that a ratio of 6.115863 means the customer is more likely to purchase olive oil if the customer has purchased mineral water and whole wheat pasta.\n<\/font><\/div>\n\n* <div align='left'><font size=\"3\" color=\"#000000\"> Store managers should place olive oil near mineral water and whole wheat pasta on aisle knowing that they have a high chance of purchasing these products based on the lift score of transaction.\n<\/font><\/div>\n\n* <div align='left'><font size=\"3\" color=\"#000000\"> Store managers should consider to make promos related with these associations to attract more customer.\n<\/font><\/div>","197dbceb":"<a id=\"data_understanding\"><\/a>\n## 3. Data Understanding","1af835f5":"#### 1. Support\n> <center><img src=\"https:\/\/miro.medium.com\/max\/700\/1*bqdq-z4Ec7Uac3TT3H_1Gg.png\" width=\"800px\"><\/center>\n\n* <div align='left'><font size=\"3\" color=\"#000000\"> This measure gives an idea of how frequent an itemset is in all the transactions.\n<\/font><\/div>\n\n* <div align='left'><font size=\"3\" color=\"#000000\"> Range from 0 to 1, the higher the value, the more frequent the itemset in all transactions.\n<\/font><\/div>\n\n#### 2. Confidence\n> <center><img src=\"https:\/\/miro.medium.com\/max\/700\/1*E3mNKHcudWzHySGMvo_vPg.png\" width=\"800px\"><\/center>\n\n* <div align='left'><font size=\"3\" color=\"#000000\"> This measure defines the likeliness of occurrence of consequent on the cart given that the cart already has the antecedents.\n<\/font><\/div>\n\n* <div align='left'><font size=\"3\" color=\"#000000\"> Range from 0 to 1, the higher the value, the more likeliness of occurrence of consequent on the cart given that the cart already has the antecedents.\n<\/font><\/div>\n\n* <div align='left'><font size=\"3\" color=\"#000000\"> Considering just the value of confidence limits our capability to make any business inference as it does not reflect the strong product association.\n<\/font><\/div>\n\n#### 3. Lift\n> <center><img src=\"https:\/\/miro.medium.com\/max\/700\/1*Rg429lteTXRKdYgCiHmLVw.png\" width=\"800px\"><\/center>\n\n* <div align='left'><font size=\"3\" color=\"#000000\"> Lift is the rise in probability of having {Y} on the cart with the knowledge of {X} being present over the probability of having {Y} on the cart without any knowledge about presence of {X}\n<\/font><\/div>\n\n* <div align='left'><font size=\"3\" color=\"#000000\"> Range from 0 to infinite,  the more value of lift, greater are the chances of preference to buy {Y} if the customer has already bought {X}.\n<\/font><\/div>\n\n* <div align='left'><font size=\"3\" color=\"#000000\"> Lift is the measure that will help store managers to decide product placements on aisle.\n<\/font><\/div>\n\n","2b1016b7":"### Load the Dataset","5e3509f5":"<div align='left'><font size=\"3\" color=\"#000000\"> Using and TransactionEncoder, we can learn the unique labels in the dataset, and via the transform method, it transforms the input dataset (a Python list of lists) into a one-hot encoded.\n<\/font><\/div>\n\n","60cb3d5d":"<a id=\"data_preprocessing\"><\/a>\n## 4. Data Preprocessing","66038750":"<a id=\"introduction\"><\/a>\n## 1. Introduction","3c0af0bc":"> <center><img src=\"https:\/\/images.unsplash.com\/photo-1578916171728-46686eac8d58?ixid=MnwxMjA3fDB8MHxzZWFyY2h8NXx8c3VwZXJtYXJrZXR8ZW58MHx8MHx8&ixlib=rb-1.2.1&w=1000&q=80\" width=\"1350px\"><\/center>","fa05120f":"<a id=\"data_visualizations\"><\/a>\n## 3. Data Visualizations","162262f1":"<a id=\"transaction_encoder\"><\/a>\n### 4.2 Using TransactionEncoder","dd56c9fe":"# **Market Basket Analysis: Apriori Algorithm**","26cedd14":"### Import Libraries","e4da4bcc":"<h1 style='color:white;background-color:black' > Table of Contents <\/h1>\n\n* [Introduction](#introduction)\n* [Data Acquisition](#data_acquisition)\n* [Data Understanding](#data_understanding)\n* [Data Preprocessing](#data_preprocessing)\n    - [Using TransactionEncoder](#transaction_encoder)\n    - [Apply Apriori Algorithm](#apriori)\n* [Association Mining](#association_mining)\n    - [Filter of the Most Frequent Association Itemset](#most_frequent)\n* [Reference Links](#reference)","99b62362":"<a id=\"most_frequent\"><\/a>\n### 5.1 Filter of the Most Frequent Association Itemset","6799b4fc":"<a id=\"reference\"><\/a>\n## 6. Reference Links","75b63ff9":"* https:\/\/towardsdatascience.com\/association-rules-2-aa9a77241654\n* https:\/\/www.kaggle.com\/rgalkar\/market-basket-analysis-and-visualization","0e43cf1e":"<a id=\"apriori\"><\/a>\n### 4.3 Apply Apriori Algorithm","78a5a73e":"Association rule mining finds interesting associations and correlation relationships among large sets of data items. Association rules show attribute value conditions that occur frequently together in a given data set."}}