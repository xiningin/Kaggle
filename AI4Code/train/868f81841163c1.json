{"cell_type":{"abb3f017":"code","76475905":"code","7c56dfd2":"code","03ea35ec":"code","5114b23e":"code","51a08efd":"code","bd9b01ea":"code","71ea7f00":"code","88286a43":"code","75ea9bb2":"code","472a85f1":"code","b1e15746":"code","37909236":"code","9b4a0bad":"code","39c0bf61":"code","1b951552":"code","361ddf79":"code","07de4701":"code","d0b33d59":"code","f3e3fcad":"code","dfbf1fed":"code","b81642ac":"code","c8cf2d2e":"code","bfb8a009":"markdown","e094ef65":"markdown","ee6a2f6f":"markdown","8455ab4f":"markdown","675612f2":"markdown","ede2ff24":"markdown","e18e1ad7":"markdown","3431d91f":"markdown","e7c3fbf6":"markdown","cfc0b392":"markdown","3a50a6af":"markdown","392fc50f":"markdown","ac9783a3":"markdown","71e9ef1d":"markdown","677a1bae":"markdown"},"source":{"abb3f017":"#importing necessary packages\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport imblearn","76475905":"#Reading data\ndata = pd.read_csv(\"..\/input\/heart-disease-prediction-using-logistic-regression\/framingham.csv\")\ndata.head()","7c56dfd2":"#Pie chart of data\ndata['TenYearCHD'].value_counts().plot.pie(explode=[0,0.2],autopct='%1.1f%%',shadow=True)","03ea35ec":"#Plotting histogram of age with respect to TenYearCHD\nplt.figure(figsize=(12, 6))\nsns.countplot('age',hue='TenYearCHD',data=data)","5114b23e":"plt.figure(figsize=(15, 12))\n\nplt.subplot(3,3,1)\nsns.countplot('male',hue='TenYearCHD',data=data)\nplt.subplot(3,3,2)\nsns.countplot('education',hue='TenYearCHD',data=data)\nplt.subplot(3,3,3)\nsns.countplot('currentSmoker',hue='TenYearCHD',data=data)\nplt.subplot(3,3,4)\nsns.countplot('BPMeds',hue='TenYearCHD',data=data)\nplt.subplot(3,3,5)\nsns.countplot('prevalentStroke',hue='TenYearCHD',data=data)\nplt.subplot(3,3,6)\nsns.countplot('prevalentHyp',hue='TenYearCHD',data=data)\nplt.subplot(3,3,7)\nsns.countplot('diabetes',hue='TenYearCHD',data=data)\n\nplt.show()","51a08efd":"plt.figure(figsize=(15, 12))\n\nplt.subplot(3,3,1)\nsns.boxplot(data['TenYearCHD'], data['totChol'], palette = 'viridis')\nplt.subplot(3,3,2)\nsns.boxplot(data['TenYearCHD'], data['sysBP'], palette = 'viridis')\nplt.subplot(3,3,3)\nsns.boxplot(data['TenYearCHD'], data['diaBP'], palette = 'viridis')\nplt.subplot(3,3,4)\nsns.boxplot(data['TenYearCHD'], data['BMI'], palette = 'viridis')\nplt.subplot(3,3,5)\nsns.boxplot(data['TenYearCHD'], data['heartRate'], palette = 'viridis')\nplt.subplot(3,3,6)\nsns.boxplot(data['TenYearCHD'], data['glucose'], palette = 'viridis')\n\nplt.show()","bd9b01ea":"#Checking if data is missing\ndata.info()\nprint(\"------------------------\")\ndata.isnull().sum()","71ea7f00":"#Calculating the Missing Values % contribution in data\ndata_null = data.isna().mean().round(4) * 100\ndata_null.sort_values(ascending=False).head()","88286a43":"#A dendrogram is a diagram that shows the hierarchical relationship between features\n#Here we are looking at dendogram of missing data\nimport missingno as msno\nmsno.dendrogram(data)","75ea9bb2":"#Imputing the missing data\nfrom sklearn.impute import SimpleImputer\nimputer = SimpleImputer(missing_values=np.nan, strategy='mean')\n\ndata_new = pd.DataFrame(imputer.fit_transform(data))\ndata_new.columns = data.columns\ndata_new.index = data.index","472a85f1":"data_new.isnull().sum()","b1e15746":"#Plotting boxplot of features to find outliers\nplt.figure(figsize=(15, 8))\n\nplt.subplot(3,3,1)\nsns.boxplot(data_new['age'],color='yellow')\nplt.subplot(3,3,2)\nsns.boxplot(data_new['cigsPerDay'],color='yellow')\nplt.subplot(3,3,3)\nsns.boxplot(data_new['totChol'],color='yellow')\nplt.subplot(3,3,4)\nsns.boxplot(data_new['sysBP'],color='yellow')\nplt.subplot(3,3,5)\nsns.boxplot(data_new['diaBP'],color='yellow')\nplt.subplot(3,3,6)\nsns.boxplot(data_new['BMI'],color='yellow')\nplt.subplot(3,3,7)\nsns.boxplot(data_new['heartRate'],color='yellow')\nplt.subplot(3,3,8)\nsns.boxplot(data_new['glucose'],color='yellow')\n\nplt.show()","37909236":"\"\"\"\nZ-score:\nThis score helps to understand if a data value is greater or smaller than mean and how far away it is from the mean.\nIf the z score of a data point is more than 3\/-3, it indicates that the data point is quite different from the other data points. Such a data point can be an outlier.\n\"\"\"\n\nfrom scipy import stats\nz = np.abs(stats.zscore(data_new))\nthreshold = 3\nprint(np.where(z > 3)) # The first array contains the list of row numbers and second array respective column numbers\n\n#Removing outliers\ndata_new = data_new[(z < 3).all(axis=1)]","9b4a0bad":"#Plotting boxplot of features to find outliers\nplt.figure(figsize=(15, 8))\n\nplt.subplot(3,3,1)\nsns.boxplot(data_new['age'],color='yellow')\nplt.subplot(3,3,2)\nsns.boxplot(data_new['cigsPerDay'],color='yellow')\nplt.subplot(3,3,3)\nsns.boxplot(data_new['totChol'],color='yellow')\nplt.subplot(3,3,4)\nsns.boxplot(data_new['sysBP'],color='yellow')\nplt.subplot(3,3,5)\nsns.boxplot(data_new['diaBP'],color='yellow')\nplt.subplot(3,3,6)\nsns.boxplot(data_new['BMI'],color='yellow')\nplt.subplot(3,3,7)\nsns.boxplot(data_new['heartRate'],color='yellow')\nplt.subplot(3,3,8)\nsns.boxplot(data_new['glucose'],color='yellow')\n\nplt.show()","39c0bf61":"#Looking at some of the properties such as mean and std of each feature\ndata_new.describe()","1b951552":"#Viewing class distribution\nplt.figure(figsize=(6, 4))\nsns.countplot('TenYearCHD', data=data_new)\nplt.title('Class Distributions')","361ddf79":"#We will use Robust scaler for scaling as it is less prone to outliers\nfrom sklearn.preprocessing import RobustScaler\nsc = RobustScaler()\n\ndata_new['age'] = sc.fit_transform(data_new['age'].values.reshape(-1,1))\ndata_new['cigsPerDay'] = sc.fit_transform(data_new['cigsPerDay'].values.reshape(-1,1))\ndata_new['totChol'] = sc.fit_transform(data_new['totChol'].values.reshape(-1,1))\ndata_new['sysBP'] = sc.fit_transform(data_new['sysBP'].values.reshape(-1,1))\ndata_new['diaBP'] = sc.fit_transform(data_new['diaBP'].values.reshape(-1,1))\ndata_new['BMI'] = sc.fit_transform(data_new['BMI'].values.reshape(-1,1))\ndata_new['heartRate'] = sc.fit_transform(data_new['heartRate'].values.reshape(-1,1))\ndata_new['glucose'] = sc.fit_transform(data_new['glucose'].values.reshape(-1,1))\n\ndata_new.head()","07de4701":"X = data_new.iloc[:,:-1].values\ny = data_new.iloc[:, -1].values","d0b33d59":"#SMOTE\nfrom imblearn.over_sampling import SMOTE\nfrom imblearn.under_sampling import RandomUnderSampler\nfrom imblearn.pipeline import Pipeline\n\nover = SMOTE()\nunder = RandomUnderSampler()\nsteps = [('o', over), ('u', under)]\npipeline = Pipeline(steps=steps)\n\nX, y = pipeline.fit_resample(X, y)\nprint(X.shape, y.shape)\n\n#reshaping\ny = y.reshape(len(y), 1)\nprint(X.shape, y.shape)","f3e3fcad":"#Viewing class distribution after resampling\ndf_temp = {'TenYearCHD' : y[:,0]}\ndf = pd.DataFrame(df_temp)\n\nplt.figure(figsize=(6, 4))\nsns.countplot('TenYearCHD', data = df)\nplt.title('Class Distributions after resampling')","dfbf1fed":"#Splitting data\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.1, random_state = 0)\n\nprint(X_train.shape, y_train.shape, X_test.shape, y_test.shape)","b81642ac":"from sklearn.ensemble import RandomForestClassifier\nclassifier = RandomForestClassifier()\ny_train = y_train.reshape(len(y_train))\nclassifier.fit(X_train, y_train)\n","c8cf2d2e":"y_pred = classifier.predict(X_test)\nfrom sklearn.metrics import classification_report\nprint(classification_report(y_test, y_pred))","bfb8a009":"Data successfully resampled","e094ef65":"Handling missing data","ee6a2f6f":"We will handle this using Z-score","8455ab4f":"#**Model Training**","675612f2":"Now lets check for outliers","ede2ff24":"There seems to be data missing","e18e1ad7":"Seems that 15.2% of people have 10-year risk of future coronary heart disease. This also tells that the data is skewed which we will handle later.","3431d91f":"**Exploratory Data Analysis**","e7c3fbf6":"**HEART DISEASE PREDICTION**\n\nThe dataset is publically available on the Kaggle website, and it is from an ongoing cardiovascular study on residents of the town of Framingham, Massachusetts.\n\n![](http:\/\/)The goal is to predict whether the patient has 10-year risk of future coronary heart disease (CHD)","cfc0b392":"**Insight**: \n1. There seems to be a slighlty higher risk if its a male.\n2. The more educated people are the lower their risk. Makes sense as they have more knowledge on how to take care of themselves.\n3. Risk is the same for both smoker and non-smoker\n4. People taking BPMeds have a higher risk.\n5. People that have had a stroke are at greater risk.\n6. People who are hypertensive are at greater risk.\n7. People with diabetes are at a higher risk","3a50a6af":"Now the dataset is balanced","392fc50f":"Resampling data","ac9783a3":"**Insight** : There seems to be increased risk with age","71e9ef1d":"**Insight**: \n1. People with risk of CHD seem to have slighlty elevated cholestrol levels\n2. People with risk of CHD seem to have elevated levels of systolic blood pressure (sysBP)\n3. People with risk of CHD seem to have elevated levels of diastolic blood pressure (diaBP)\n4. People with risk of CHD seem to have slighlty elevated BMI\n5. People with risk of CHD seem to have slighlty elevated heart rate\n6. People with risk of CHD seem to have slighlty elevated glucose levels","677a1bae":"We can see that the data is imbalanced. This could lead to bad precision and recall. We will use SMOTE and RandomUndersample for resampling the data\n\nBefore that we will scale the follwing features:\n\nage, cigsPerDay, totChol, sysBP, diaBP, BMI, heartRate and glucose"}}