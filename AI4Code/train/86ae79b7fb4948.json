{"cell_type":{"140d65e1":"code","9c947353":"code","75962ed0":"code","54d01705":"code","dcc319e1":"code","4b2eed21":"code","d227be95":"code","cb79c227":"code","b129c274":"code","d16c6965":"code","904e18e2":"code","4b0b4088":"code","3c7c187a":"code","a894535c":"code","850852ee":"code","bbbcaa08":"code","6664bbc0":"code","ef332225":"code","3c385ab5":"code","2e22b918":"markdown","543a1ccc":"markdown","04b04bd6":"markdown"},"source":{"140d65e1":"import numpy as np \nimport pandas as pd\nimport seaborn as sns\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import roc_auc_score\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.preprocessing import StandardScaler","9c947353":"train_data = pd.read_csv(\"..\/input\/tabular-playground-series-mar-2021\/train.csv\",index_col='id')\ntest_data = pd.read_csv(\"..\/input\/tabular-playground-series-mar-2021\/test.csv\",index_col='id')\nsubmission = pd.read_csv('..\/input\/tabular-playground-series-mar-2021\/sample_submission.csv', index_col='id')","75962ed0":"y = train_data.pop('target')","54d01705":"num_cols = [col for col in train_data.columns if train_data[col].dtype in ['int64','float64']]\nnum_cols","dcc319e1":"cat_cols = [col for col in train_data.columns if train_data[col].dtype in ['O']]\ncat_cols","4b2eed21":"from sklearn.pipeline import Pipeline\nfrom sklearn.compose import ColumnTransformer","d227be95":"num_transform = StandardScaler()\n\ncat_transform = OneHotEncoder(handle_unknown='ignore')\n\npreprocessor = ColumnTransformer(\n    transformers=[\n        ('num',num_transform,num_cols),\n        ('cat',cat_transform,cat_cols)\n    ])","cb79c227":"from xgboost import XGBClassifier\nxgboost =  XGBClassifier()","b129c274":"my_pipeline = Pipeline(steps=[\n    ('preproc',preprocessor),\n    ('model',xgboost)\n])","d16c6965":"from sklearn.model_selection import GridSearchCV\n\nparams = [\n    {'model__eta':[0.3,0.6],\n     'model__max_depth':[6,12],\n     'model__lambda':[1,5],\n     'model__alpha':[0,7]\n    }\n]\n\nparams1 = [\n    {'model__eta':[0.3]\n    }\n]","904e18e2":"grid = GridSearchCV(my_pipeline, cv=3, n_jobs=-1, param_grid=params ,scoring='roc_auc',\n                    verbose=1)","4b0b4088":"grid.fit(train_data,y)","3c7c187a":"grid.best_estimator_","a894535c":"grid.best_score_","850852ee":"grid.best_params_","bbbcaa08":"grid.predict_proba(test_data)","6664bbc0":"pred = grid.predict_proba(test_data)\npred","ef332225":"y_pred = pred[:,1]\ny_pred","3c385ab5":"submission['target'] = y_pred\nsubmission.to_csv('gs_xgboost.csv')","2e22b918":"# Read in Data","543a1ccc":"# Pipeline Setup","04b04bd6":"# Set up Categorical and Numerical Cols"}}