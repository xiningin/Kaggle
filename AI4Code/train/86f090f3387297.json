{"cell_type":{"3d52043c":"code","af8a5246":"code","df3355df":"code","8bab91cc":"code","7d747a59":"code","53b88a99":"code","999c20d3":"code","0a8c67c1":"code","c7d7473b":"code","40fbdfe6":"code","39d76f0c":"code","4e3c37a0":"code","bde96a06":"code","a47b52bb":"code","5d258884":"code","21e7641a":"code","eec7e66a":"code","f6e91f2f":"code","b8415157":"code","a603a1d3":"code","a383c361":"code","fd0dbecd":"markdown","1c66bc08":"markdown","07c77205":"markdown","4dafd9a7":"markdown","9c394bfc":"markdown","086cb10f":"markdown","2a9d22cf":"markdown","3894f380":"markdown","6df217d0":"markdown","3f5146c1":"markdown","6db37717":"markdown","dddf4011":"markdown"},"source":{"3d52043c":"import pandas as pd","af8a5246":"products = pd.read_csv('..\/input\/amazon_baby.csv')","df3355df":"len(products)","8bab91cc":"products.head()","7d747a59":"from sklearn.feature_extraction.text import CountVectorizer\nvectorizer = CountVectorizer()\nword_count = vectorizer.fit_transform(products['review'].values.astype('U'))","53b88a99":"print (word_count.shape)","999c20d3":"products['sentiment'] = products['rating'] >= 4","0a8c67c1":"products.head()","c7d7473b":"from sklearn.naive_bayes import MultinomialNB\nclf = MultinomialNB().fit(word_count, products['sentiment'])","40fbdfe6":"clf.coef_.shape","39d76f0c":"clf.coef_","4e3c37a0":"from sklearn.pipeline import Pipeline\nfrom sklearn.feature_extraction.text import TfidfTransformer\ntext_clf = Pipeline([('vect', CountVectorizer()),\n                     ('tfidf', TfidfTransformer()),\n                     ('clf', MultinomialNB()), ])","bde96a06":"text_clf.fit(products.review.values.astype('U'), products.sentiment)","a47b52bb":"products['prediction'] = text_clf.predict_proba(products.review.values.astype('U'))[:, [True, False]]","5d258884":"giraffe_reviews = products[products['name'] == 'Vulli Sophie the Giraffe Teether']","21e7641a":"giraffe_reviews = giraffe_reviews.sort_values('prediction')","eec7e66a":"giraffe_reviews.head()","f6e91f2f":"pd.options.display.max_colwidth = 1000\ngiraffe_reviews.iloc[0]['review']","b8415157":"giraffe_reviews.iloc[1]['review']","a603a1d3":"giraffe_reviews.iloc[-1]['review']","a383c361":"giraffe_reviews.iloc[-2]['review']","fd0dbecd":"## Let's train  the sentiment classifier","1c66bc08":"## Building a pipeline","07c77205":"## Define what's a positive and a negative sentiment","4dafd9a7":"## Evaluate the sentiment model","9c394bfc":"## Read some product review data","086cb10f":"## positive sentiment = 4 or 5 * rating","2a9d22cf":"## Build the word count vector for each review","3894f380":"## Sort the giraffe reviews based on the predicted sentiment and explore","6df217d0":"## Most positive reviews","3f5146c1":"## Build a sentiment classifier","6db37717":"## Show most negative reviews","dddf4011":"## Fire up pandas"}}