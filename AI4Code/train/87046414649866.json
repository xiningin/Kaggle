{"cell_type":{"c265f4a1":"code","1ff50a8b":"code","6d1d8c9f":"code","218c8cd9":"code","06b6bd9a":"code","15e1d01b":"code","718783b2":"code","34463252":"code","fc28c27a":"code","9aec6f67":"markdown","2daef800":"markdown","fd3ac9e1":"markdown","3ae011ea":"markdown","aa09c01e":"markdown","c338fd1b":"markdown","67ca8074":"markdown","fb270b3b":"markdown","aeba48ea":"markdown"},"source":{"c265f4a1":"import pandas as pd\nimport numpy as np\n#Using to split data randomly\nfrom sklearn.model_selection import train_test_split\n#Using to get most common element from list\nfrom collections import Counter","1ff50a8b":"def readData():\n    data = pd.read_csv('\/kaggle\/input\/breast-cancer-wisconsin-data\/data.csv')\n    #Drop Id as it has no influence on diagnosis, and Unnamed for Nan Vals\n    data = data.drop(['id', 'Unnamed: 32'], axis = 1)\n    data = data.dropna()\n    return data\n","6d1d8c9f":"\ndef splitData(data, testSize):\n    y = data['diagnosis'].to_numpy()\n    data = data.drop(['diagnosis'], axis = 1)\n    X = data.to_numpy()\n    Xtrain, Xtest, ytrain, ytest = train_test_split(X, y, test_size=testSize)\n    return Xtrain, Xtest, ytrain, ytest","218c8cd9":"def euclidean(Xtrain, Xtestval):\n    distances = []\n    for i in range(len(Xtrain)):\n        #euclidean equation\n        distance = np.sqrt(np.sum(np.square(Xtestval-Xtrain[i])))\n        distances.append([distance, i])\n    return sorted(distances)","06b6bd9a":"def predict(Xtrain, ytrain, Xtestval, k):\n    distances = euclidean(Xtrain, Xtestval)\n    predict = []\n    for i in range(k):\n        predict.append(ytrain[distances[i][1]])\n        \n    return Counter(predict).most_common(1)[0][0]","15e1d01b":"def KNN(Xtrain, Xtest, ytrain):\n    predictions = []\n    for i in range(len(Xtest)):\n        predictions.append(predict(Xtrain, ytrain, Xtest[i], 3))\n        \n    return predictions","718783b2":"def accuracy(ytest, predictions):\n    correct = 0\n    for i in range(len(predictions)):\n        if(predictions[i]==ytest[i]):\n            correct += 1\n        \n    score = (correct\/len(ytest))*100\n    return score","34463252":"data = readData()\nXtrain, Xtest, ytrain, ytest = splitData(data, 0.2)\npredictions = KNN(Xtrain, Xtest, ytrain)\n\n","fc28c27a":"print(accuracy(ytest, predictions))","9aec6f67":"Split data into a train and a test set. Converting them to numpy arrays, and returning them.","2daef800":"On average when I ran it was between 90-95% when k=3 and testSize = 0.2","fd3ac9e1":"main","3ae011ea":"An attempt to better understand KNN by making one from scratch in Python. Just using train_test_split to split the data and Counter to get most common element from a list, and numpy arrays. I hope I did everything correctly, feel free to leave feedback!","aa09c01e":"This is our actual KNN function, which just gets a predicted class for each set of values in our Xtest. Note k=3 in this example.","c338fd1b":"This function will make a list of predictions (predict). It does this by taking the index of the k smallest distances (which is already sorted in the distances list so really the first k values of the list), and finding the value of the corresponding index of the y train values (the actual class of those xtrain features). We will then return the most common value in the predict list, which is our predicted class of the Xtest features.","67ca8074":"Our Xtest are the features of which we will actually try to predict the class of. We will do this by comparing them to the Xtrain values. So for each Xtest values (Xtestval), We will create a list (distances), of which will have the euclidean distance between xtestval and each Xtrain value. We will also need to make sure we keep track of the index of the Xtrain value to look up the corresponding ytrain value (the actual class of the Xtrain value). We will return this list sorted from lowest (best) to highest distances.","fb270b3b":"Start by reading in the data, dropping the ID Column and Unnamed, and any other null data","aeba48ea":"This function just takes our predicted values and compares them to the actual ytest values, calculating the % we got correct."}}