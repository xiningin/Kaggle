{"cell_type":{"8b887a7c":"code","1c141ea2":"code","8d536a5c":"code","d785d683":"code","a37f79b3":"code","898afec7":"code","b2ea305f":"code","cb2f6ad0":"code","d31d215e":"code","6c3b0284":"code","5d0ca384":"code","5e0d1c5c":"code","8ae22d3a":"code","2216592b":"code","ba8656fd":"code","f6431c60":"code","0c8f7f58":"code","9892b4af":"code","08ffcf49":"code","73240f37":"code","495a2768":"code","dc6b905e":"code","9da15bf9":"code","bfac20b5":"code","91e9420a":"code","71ad950e":"code","687371cd":"code","88063474":"code","27a6e685":"code","06610e61":"code","82800caa":"code","b6e05626":"code","6ca08776":"code","d622d147":"code","401761de":"code","e137361a":"code","7f836bbc":"code","16e760de":"code","64aa2af3":"code","e3692d5a":"code","428f402e":"code","2dca00c3":"code","9243c54d":"markdown","f959a593":"markdown","3d581a64":"markdown","bbcfd203":"markdown","52da5fb1":"markdown","0c51779c":"markdown","aad4efa8":"markdown","2e58433c":"markdown","f4240486":"markdown","77ff11b2":"markdown","bb90d6fe":"markdown","4e9780ee":"markdown","04f3e456":"markdown","ac6e032a":"markdown","46a83fd7":"markdown","107bd077":"markdown","00960005":"markdown"},"source":{"8b887a7c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","1c141ea2":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import mean_squared_error, r2_score\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression","8d536a5c":"udemy_data = pd.read_csv('\/kaggle\/input\/udemy-courses\/udemy_courses.csv')\nudemy_data.head()","d785d683":"udemy_data.info()","a37f79b3":"udemy_data.columns","898afec7":"udemy_data.describe()","b2ea305f":"subject_col = udemy_data['subject'].value_counts()\nsubject_col","cb2f6ad0":"categorical_df = udemy_data.select_dtypes(include=[\"object\"])","d31d215e":"categorical_df.subject.unique()","6c3b0284":"categorical_df.level.unique()","5d0ca384":"subject_col.plot.barh(color='lightblue');","5e0d1c5c":"sns.distplot(udemy_data.price, bins=10, kde=False);","8ae22d3a":"sns.barplot(x = \"level\", y = \"price\", hue = \"subject\", data = udemy_data,ci = None)\nplt.show()","2216592b":"g = sns.catplot(x=\"price\", aspect=3, data=udemy_data, kind=\"count\")\ng.fig.suptitle(\"price Counts\", y=1.0)\nplt.show()","ba8656fd":"sns.relplot(x=\"price\", y=\"num_subscribers\", data=udemy_data, kind=\"line\", aspect=4, ci=\"sd\")\nplt.show()","f6431c60":"sns.distplot(udemy_data.price, bins=10)","0c8f7f58":"sns.kdeplot(udemy_data.price, shade = True)","9892b4af":"sns.catplot(x = \"subject\", y = \"price\", kind=\"violin\",aspect=3, data = udemy_data,);","08ffcf49":"# 3.cu icin hue\nsns.catplot(x = \"subject\", y = \"price\", hue=\"level\", kind=\"violin\", aspect=3, data = udemy_data);","73240f37":"sns.catplot(x = \"price\", y = \"level\", hue = \"subject\", kind = \"point\", data = udemy_data);","495a2768":"sns.scatterplot(x = \"price\", y = \"subject\", hue = \"level\", data = udemy_data);","dc6b905e":"sns.relplot(x=\"num_reviews\", y=\"num_subscribers\",aspect=3, data=udemy_data, kind=\"scatter\")\nplt.show()","9da15bf9":"sns.set_palette(\"RdBu\")\ncorrelation=udemy_data.corr()\nsns.heatmap(correlation, annot=True)\nplt.show()","bfac20b5":"\nsns.lmplot(x = \"price\", y = \"num_subscribers\", hue = \"level\", data=udemy_data);","91e9420a":"sns.boxplot(x = udemy_data[\"price\"]);","71ad950e":"sns.boxplot(x = \"level\", y = \"price\", data = udemy_data);","687371cd":"sns.boxplot(x = \"level\", y = \"price\", hue=\"subject\", data = udemy_data)","88063474":"fig, ax = plt.subplots()\nax.hist(udemy_data.level, label=\"price\", bins=10)\nax.set_xlabel(\"level\")\nax.set_ylabel(\"price\")\nplt.show()","27a6e685":"sns.catplot(x=\"is_paid\",data=udemy_data, kind=\"count\")\nplt.show()","06610e61":"sns.lmplot(x = \"num_subscribers\",y=\"num_reviews\", hue = \"subject\", data=udemy_data);","82800caa":"sns.lineplot(x = \"price\", y = \"num_subscribers\", hue=\"subject\", data = udemy_data);","b6e05626":"# we dont have NaN value\ndf_for_model.isna().sum().sum()","6ca08776":"df_for_model = udemy_data.copy()","d622d147":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\ndf_le = df_for_model.copy()\nle.fit(df_le[\"level\"])","401761de":"list(le.classes_)","e137361a":"pd.get_dummies(df_for_model[\"level\"])","7f836bbc":"X = df_for_model['num_subscribers'].values\ny = df_for_model['num_reviews'].values","16e760de":"print(X.shape)\nprint(y.shape)","64aa2af3":"X = X.reshape(-1,1)\ny = y.reshape(-1,1)","e3692d5a":"X_train, X_test,  y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","428f402e":"# !!! DO NOT FORGET TO LIBRARIES\nreg = LinearRegression()\n\nreg.fit(X_train,y_train)\npreds = reg.predict(X_test)\nrmse = np.sqrt(mean_squared_error(y_test,preds))\nprint(rmse)\nprint('Score',reg.score(X_test,y_test))","2dca00c3":"# !!! DO NOT FORGET TO LIBRARIES\n\n\n# Instantiate model with 100 decision trees\nrf = RandomForestRegressor(n_estimators = 100, random_state = 42)\n# Train the model on training data\nrf.fit(X_train, y_train);\n# Use the forest's predict method on the test data\npredictions = rf.predict(X_test)\n# Calculate the absolute errors\nerrors = abs(predictions - y_test)\n\n# Print out the mean absolute error (mae)\nprint('Mean Absolute Error:', round(np.mean(errors), 2), 'degrees.')\n#Score\nprint(\"Score :\",rf.score(X_test, y_test))","9243c54d":"# heatmap","f959a593":"# is_paid categorical variable frequency","3d581a64":"<a id = '11'> <\/a> <\/br>\n# Modelling \n* ## Reviews prediction by subscribers\n* preparing data for train test split\n* train test split\n* Linear regression\n* RandomForestRegressor","bbcfd203":"<a id = '9'> <\/a> <\/br>\n# Label Encoding","52da5fb1":"<a id = '14'> <\/a> <\/br>\n### LinearRegression","0c51779c":"<a id = '3'> <\/a> <\/br>\n# How many course we have?","aad4efa8":"<a id = '4'> <\/a> <\/br>\n# How many unique variable we have?","2e58433c":"<a id = '10'> <\/a> <\/br>\n## one-hot encoding","f4240486":"<a id = '12'> <\/a> <\/br>\n### Preparing data for train test split","77ff11b2":"<a id = '8'> <\/a> <\/br>\n# Preproccessing\n* How to label encoding\n* How to get one-hot encoding","bb90d6fe":"<a id = '5'> <\/a> <\/br>\n# Visualizations\n* plots\n* scatter\n* heatmap","4e9780ee":"# Exploratory Data Analysis and Prediction of Udemy\n\n## Udemy Visualizations and ML models with scikit-learn\n* ### Visualizations: Seaborn and matplotlib\n* ### ML models: Linear Regression and RandomForestRegressor \n![udemy.png](attachment:udemy.png)\n\nUdemy, founded in May 2010, is an American online learning platform aimed at professional adults and students. As of Jan 2020, the platform has more than 50 million students and 57,000 instructors teaching courses in over 65 languages. There have been over 295 million course enrollments. Students and instructors come from 190+ countries and 2\/3 of the students are located outside of the U.S.\n\nStudents take courses largely as a means of improving job-related skills.Some courses generate credit toward technical certification. Udemy has made a special effort to attract corporate trainers seeking to create coursework for employees of their company.As of 2020, there are more than 150,000 courses on the website.\n\n\n\nSource: https:\/\/en.wikipedia.org\/wiki\/Udemy\n\n<font color = 'blue'>\nContents:\n1. [Importing libraries](#1)\n1. [Load and Check Data](#2)\n    * [How many course we have?](#3)\n    * [How many unique variable we have?](#4)\n1. [Visualizations](#5)\n1. [Basic Preproccessing](#8)\n    * [Label Encoding](#9)\n    * [one-hot encoding](#10)\n1. [Modelling](#11)\n    * [preparing data for train test split](#12)\n    * [train test split](#13)\n    * [Linear regression](#14)\n    * [RandomForestRegressor](#15)","04f3e456":"<a id = '2'> <\/a> <\/br>\n# Load and Check Data","ac6e032a":"<a id = '1'> <\/a> <\/br>\n# Importing libraries","46a83fd7":"* <a id = '15'> <\/a> <\/br>\n### RandomForestRegressor","107bd077":"<a id = '13'> <\/a> <\/br>\n### train_test_split","00960005":"# scatter"}}