{"cell_type":{"0e33e33a":"code","5106f131":"code","9add50e5":"code","f320f406":"code","9b3d03ce":"code","8accb6a1":"code","fb11bb87":"code","296e7f83":"code","93828e44":"code","ea3514d8":"code","c46f3cec":"code","32a720b2":"code","a290ea4a":"code","ad3ffb3a":"code","5011f130":"code","c36715ad":"code","92bf7c7c":"code","95446489":"code","f0e2e40d":"code","abf6d129":"code","36570fe8":"code","5c66d097":"code","79d934be":"code","1494c33b":"code","b75b21ac":"code","2639c052":"code","33004b76":"code","efe00013":"code","aceff3fa":"code","627fa785":"code","3cf1ea14":"code","cc3b0a76":"code","1f1003df":"code","dd8b16f0":"code","141e0759":"code","50fa0e69":"code","07b6dc10":"code","7f013ada":"code","4fce4bba":"code","299070fb":"code","263629c6":"code","8b1cecd3":"code","e81d5dd8":"code","e1e2c793":"code","de5a3236":"code","73822057":"code","2823912e":"code","c3b5b695":"code","6af44cb8":"code","57ade6f6":"code","a0d9320f":"code","92eac8cc":"code","be41071b":"code","a24349cb":"code","22c3d930":"code","c5c4fc47":"code","06abd2a3":"markdown","7ce31a96":"markdown","5d19f7b4":"markdown","9ac9f10c":"markdown","3ebfd8cd":"markdown","baa5d5f3":"markdown","8c49cd35":"markdown","af64f982":"markdown","b177cc43":"markdown","750f19f4":"markdown","dd798139":"markdown","b88d08a9":"markdown","3a66b4fb":"markdown","77ca5254":"markdown","ee802832":"markdown","825a23b9":"markdown","77f20442":"markdown","e7c1e29e":"markdown","438173d9":"markdown","44b2e7e4":"markdown","ba04500d":"markdown","16b22bd6":"markdown","16d5b90f":"markdown","222ea141":"markdown"},"source":{"0e33e33a":"# importanto as bibliotecas\n\n# Manipula\u00e7\u00e3o dos dados\nimport pandas as pd  \n\n# Para uso de matrizes e arrays\nimport numpy as np  \n\n# Visualiza\u00e7\u00e3o \nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Estat\u00edstica\nimport statsmodels as sm\n\ndf = pd.read_csv('..\/input\/WA_Fn-UseC_-Telco-Customer-Churn.csv')","5106f131":"df.head()","9add50e5":"df.info()","f320f406":"# SeniorCitizen\n\ndf['SeniorCitizen'] = df.SeniorCitizen.astype('object')","9b3d03ce":"df.info()","8accb6a1":"df.TotalCharges = pd.to_numeric(df.TotalCharges, errors = 'coerce')\n\ndf.TotalCharges.describe()","fb11bb87":"df.info()","296e7f83":"df.TotalCharges.isnull().sum()","93828e44":"df.TotalCharges.fillna(value = df.tenure *  df.MonthlyCharges, inplace = True)","ea3514d8":"df.TotalCharges.isnull().sum()","c46f3cec":"df.describe().round()","32a720b2":"numerics = df[['tenure','MonthlyCharges', 'TotalCharges', 'Churn']]\n\nplt.figure(figsize = (8,8))\n\nsns.regplot(x = 'tenure', y = 'TotalCharges', data = numerics)\n\nplt.title('Relationship between loyalty months and total revenue')","a290ea4a":"plt.figure(figsize = (8,8))\nplt.title('Relationship between monthly fee and total revenue')\nax = sns.regplot(x = 'MonthlyCharges', y = 'TotalCharges', data = numerics)","ad3ffb3a":"plt.figure(figsize = (15,10))\nsns.pairplot(numerics)","5011f130":"plt.figure(figsize = (15,10))\n\nsns.boxplot(x = 'tenure', y = 'TotalCharges', data = df)\n\nplt.title('Box Plot of Total Payments X Months of Loyalty')","c36715ad":"plt.figure(figsize = (15,10))\nsns.countplot(df['tenure'])","92bf7c7c":"\ndf.describe(include = 'object')","95446489":"pd.crosstab(df.Churn, df.SeniorCitizen,\n            margins = True)","f0e2e40d":"# Should make a function for that..\nprint('The percentage of elderly people who left the company:{}%'.format(476\/1142*100))\nprint('The non-elderly population is:{}%'.format(1393\/5901*100)) ","abf6d129":"plt.figure(figsize = (8,8))\nsns.set(style = 'whitegrid')\n\nsns.countplot(df.SeniorCitizen, hue = df.Churn )","36570fe8":"mens_media_idoso = df[df['SeniorCitizen'] == 1]\nmens_media_idoso = mens_media_idoso.MonthlyCharges.mean()\nmens_media_idoso\n\nn_idoso_media_mes = df[df['SeniorCitizen'] == 0]\nn_idoso_media_mes = n_idoso_media_mes.MonthlyCharges.mean()\n\nprint('The average monthly expenditure for the elderly is :{}'.format(mens_media_idoso))\nprint('The average monthly expenditure for non-elderly persons is :{}'.format(n_idoso_media_mes))","5c66d097":"# Checking\n\nmedia_mes_idade = df.groupby('SeniorCitizen').mean() \nmedia_mes_idade.round()","79d934be":"plt.figure(figsize = (10,8))\n\nsns.set(style = 'whitegrid')\nsns.boxplot(x = df.SeniorCitizen, y = df.TotalCharges, hue = df.Churn)\n\nplt.title('Total Revenue by Seniors and Non-Seniors')","1494c33b":"df.SeniorCitizen.value_counts(normalize = True)","b75b21ac":"plt.figure(figsize = (8,8))\nsns.set(style = 'whitegrid')\nsns.countplot(df.gender, hue = df.Churn)","2639c052":"receita_gender = df.groupby(by = 'gender')['TotalCharges', 'MonthlyCharges'].mean().round()\nreceita_gender","33004b76":"df.groupby(by = 'gender')['tenure'].mean().round()","efe00013":"plt.figure(figsize = (8,8))\nsns.set(style = 'whitegrid')\nsns.countplot(df.Partner, hue = df.Churn)","aceff3fa":"df.groupby('Partner')['TotalCharges', 'MonthlyCharges', 'tenure'].mean().plot(kind = 'bar', stacked = True, \n                                                                             figsize = (8,8))","627fa785":"pd.crosstab(df.Partner, df.Dependents).plot(kind = 'bar', stacked = True, figsize = (8,8))","3cf1ea14":"plt.figure(figsize = (15,10))\nsns.countplot(df['tenure'], hue = df.Partner)","cc3b0a76":"df.InternetService.value_counts(normalize = True)","1f1003df":"pd.crosstab(df.InternetService, df.PhoneService, margins = True)","dd8b16f0":"plt.figure(figsize = (15,5))\nsns.countplot(df.InternetService, hue = df.Churn)","141e0759":"df.groupby('InternetService')['TotalCharges'].mean()","50fa0e69":"df.head()","07b6dc10":"df.drop(['customerID', 'gender'], axis = 1, inplace = True)","7f013ada":"df_model = df\n\ndf_model.head()","4fce4bba":"df_model.columns","299070fb":"## Here i forked some code from another Kernel\n\ncolumns_to_convert = ['Partner', 'Dependents','PhoneService','OnlineSecurity' ,\n                      'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies','PaperlessBilling',\n                      'Churn']\n                      \n                      \n    \n    \nfor item in columns_to_convert:\n    df_model[item].replace(to_replace=['Yes', 'No'], value= [1,0], inplace = True)\ndf_model.head()","263629c6":"# adjusting the column Multiple Lines\n\ndf_model.MultipleLines = df_model.MultipleLines.replace(to_replace= 'No phone service', value = 'No')\ndf_model.MultipleLines = df_model.MultipleLines.replace(to_replace= ['Yes', 'No'], value = [1,0])\ndf_model.MultipleLines.value_counts()","8b1cecd3":"pd.get_dummies(df_model, columns = ['InternetService', 'Contract', 'PaymentMethod'], drop_first = True)","e81d5dd8":"df_model.OnlineSecurity = df_model.OnlineSecurity.replace(to_replace= 'No internet service', value = 0)\ndf_model.OnlineBackup = df_model.OnlineBackup.replace(to_replace= 'No internet service', value = 0)\ndf_model.DeviceProtection = df_model.DeviceProtection.replace(to_replace= 'No internet service', value = 0)\ndf_model.TechSupport = df_model.TechSupport.replace(to_replace= 'No internet service', value = 0)\ndf_model.StreamingTV = df_model.StreamingTV.replace(to_replace= 'No internet service', value = 0)\ndf_model.StreamingMovies = df_model.StreamingMovies.replace(to_replace= 'No internet service', value = 0)\n","e1e2c793":"df_model.head(10)","de5a3236":"df_model2 = pd.get_dummies(df_model, columns = ['InternetService', 'Contract', 'PaymentMethod'], drop_first = True)\ndf_model2.head(20)","73822057":"from sklearn.model_selection import train_test_split\n\nX = df_model2.drop('Churn',axis=1)\ny = df_model2['Churn']\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=101)","2823912e":"from sklearn import tree\n","c3b5b695":"clf = tree.DecisionTreeClassifier()\nclf = clf.fit(X_train,y_train)","6af44cb8":"# Predictions\n\npredictions = clf.predict(X_test)","57ade6f6":"predictions","a0d9320f":"from sklearn.metrics import classification_report, confusion_matrix\n\nprint(classification_report(y_test,predictions))\nprint('\\n')\nprint(confusion_matrix(y_test,predictions))","92eac8cc":"from sklearn.ensemble import RandomForestClassifier","be41071b":"rfc = RandomForestClassifier(n_estimators= 10)","a24349cb":"rfc.fit(X_train,y_train)","22c3d930":"rfc_predictions = rfc.predict(X_test)","c5c4fc47":"print(classification_report(y_test,rfc_predictions))","06abd2a3":"The conversion generated 11 null values, we will fill them with the result of multiplying the tenure and MonthlyCharges columns. Since the first represents the number of months that the customer was in the company, and the second indicates the amount paid per month.","7ce31a96":"***SeniorCitizen***","5d19f7b4":"## Clean and Transform Data!\n\nThe dataset has no missing values.\n\nWe have more than 7000 rows and 21 attributes (columns)\n\nSome data that should be categorical are saved as number. Let's fix this.","9ac9f10c":"Ok, thats all for now. Im trying to undestand how to apply these algorithims. But in resume:\n    \n    Random Forest performed better than decision tree...at the moment, i cant explain much why this occur, but i will keep learning...\n    \n    Plese, leave your comments, i'll be so glad if someone can explain to me how my model performed ! \n    \n    Thank you ! ","3ebfd8cd":"***Gender***","baa5d5f3":"Proportionally speaking, the volume of older people leaving the company is much higher than the volume of non-elderly.\n\nDoes this indicate a dependency relationship? Is it worth considering to investigate this relationship more closely? Or was it mere chance? A chi-square test can help us find out if this assignment is statistically significant.\n\nJust for curiosity, what is the monthly average between young and old?","8c49cd35":"* Half of the clients remain in the company for more than 29 months (just over two years);\n* The average amount per month $ 30;\n* The average total revenue generated per customer is 2280.\n\n\n*** Let's look at how the relationships between these variables occur.***","af64f982":"Problem solved !\n\nNow that all the variables are ok, we can start exploring the data. Let's try to understand which customers spend more, which ones usually stay longer in the company among other information that may be interesting and lead us to some insinghts.\n\nLet's start by observing a statistical summary of the numerical variables, which are:\n\n* tenure: Period in months that customers stay in the company\n* MonthlyCharge: Value of the monthly payment paid by the customer\n* TotalCharges: Total amount paid by the customer\n\n## Exploratory Analysis","b177cc43":"Analysis of [Telco's](http:\/\/telco.com.br\/) customer database, with information about the attributes of its customers.\n\nThe intention is to predict customers with greater potential to leave the company.\n\nPlease, if you like that Kernel, let me know, leaving your upvote, i would appreciate that so much !\n","750f19f4":"As we see above, the gender does not have any great difference. So i think that this variable is not important for the model. Let's drop it!","dd798139":"Done ! Now the SeniorCitizen column, which indicates whether the customer is elderly or not, through a dummy variable (0 and 1), is properly saved as a qualitative variable.\n\nWe need to change the column *** TotalCharges *** to numerical as it refers to the total amount of revenue generated by the client. I'll do this using the _to_numeric () _ function of pandas.\n\nThe _errors = 'coerce'_ parameter turns the records into which the conversion could not be converted to values \u200b\u200bof type NaN.","b88d08a9":"Clients that dont use phone services, use the DSL internet service. Wich means that Fiber Optic is avaliable only for those who has phone services.\n\nFor those Who use phone service, DSL still an option.\n\nWe are starting to understanding the company's product strategy...","3a66b4fb":"There is a huge churn tendency in Fiber Optic Services. That mighty show a great insatisfcation with this service. \n\n","77ca5254":"Tha above chart, confirm that people who has partner stay more time in the company. \n\nSo, that's the insghts of this analysis: \n\n* People with partner are very lucrative to the company, cause they stay more time and spent more money. \n\n\n***OK, i think that we got some good insights exploring the demographics atributes of our clients. Lets take a look on our products ! Which one is the most lucrative ? Is that the same with the higuer fidelity ?***","ee802832":"Above we have just explored the relationships between the time of home and the total value of expenses. They are linear as you would expect. That is, the longer the customer stays with us, the greater your total spend.\n\nWe also observed the linear relationship between the monthly value and total revenue. Customers with higher monthly value, represent higher revenue.\n\nWe observe that there is no relation to the months of the house, and the increase of the monthly payments. To my credit, many clients remain for a long time without hiring new services; in contrast, some already come with more expensive plans.\n\nAnd through boxblot we have seen that, in general, the Dataset does not have outliers.\n\n\n***Now let's explore the categorical variables. From here, we'll take into account the variable 'Churn' in all our views. This variable indicates whether the customer has left the company or not. Our target variable.***","825a23b9":" ***Lets star the modeling phase***\n\nFirst of all,  i'll transform the columns so the model will be able to understand our data !  ","77f20442":"Does the age group influence the escape of customers?","e7c1e29e":"Quickly, in this picture we can already observe:\n\n* Most customers are not Senior;\n* The most popular internet service is fiber optics;\n* Most customers prefer not to receive printed accounts;\n* The most popular form of payment is the electronic payment\n\n\n","438173d9":"Theres is great diference between people with partners e without it. People with partner(married ones) spent much more money in the company and stay much more time. That may be cause they has children and has more complete packs.\n\nLet's confirm that possibility!","44b2e7e4":"Based on the above comparisons:\n\n* Although they represent only 16% of clients, the elderly spend more in the company: It has a monthly average higher, leave more revenue and has a higher fidelity average. However, as we have seen, it has a much higher rate of evasion than the young public. The graphic makes this even clearer.\n\nThese numbers make sense. Older people spend more time at home, because they are retired or taking lighter lives, so they consume more television, which leads them to sign more complete and consequently more expensive packages.\n\nBased on these data, I would recommend a deeper analysis to understand the reason for this evasion rate and propose actions to increase retention of this public and to attract them.\n\nThis analysis has already shown us some very relevant insights and this considering only the variable relative to age ....\n\n\n### Lets investigate the gender variable","ba04500d":"***There is no behavior difference between women and men.***\n\n### Lets investigate the Partner variable, that indicates if the customer has any relationship partner.","16b22bd6":"That's right, people who has partners, has more dependents(children) than the single ones.","16d5b90f":"21% of clients don't use internet services. Would be a nice idea explore some ways to making they use our internet services. Maybe using some clustering algorithm to discover especific characteristics to use to our favor....\n\nFrom here a think that is time to slice our dataset, lets focus on clients that use internet services, but before that, lets take a closer look: ","222ea141":"***SeniorCitzen***"}}