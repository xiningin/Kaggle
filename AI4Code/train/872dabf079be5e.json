{"cell_type":{"8b0dd4e2":"code","cd0ce41c":"code","1e7d80c4":"code","5529e841":"code","1ae2b6a4":"code","e2ec7722":"code","5e51a3fe":"code","0e7da143":"code","d82f8b11":"code","6a99d5df":"code","6141c720":"code","1f5ffa27":"code","72391ee6":"code","84f89449":"code","696c257d":"code","dfc09dde":"code","5586c770":"code","e070987f":"code","3d65c8fe":"code","8dc9d813":"code","82a207c9":"code","b78d707e":"code","26c238d6":"code","d00e7f15":"code","67c0cf85":"code","c9797ad7":"code","5a717bda":"code","bd33450c":"code","637ef0c8":"code","2d28291c":"code","bc9f207b":"code","e7b81611":"code","2f685080":"code","e3012f23":"code","d44863ea":"code","671d4130":"code","1cf7ff16":"code","e496c244":"code","b5a5ce3d":"code","6841ce30":"code","c23eac5d":"markdown","901b6681":"markdown","bd5bb563":"markdown","e105eb13":"markdown","dd4dbeb5":"markdown","8915ca2c":"markdown","58559266":"markdown","3e6e15d2":"markdown","e543666a":"markdown"},"source":{"8b0dd4e2":"# Importing the required libraries\nimport pandas as pd, numpy as np\nimport matplotlib.pyplot as plt, seaborn as sns\n%matplotlib inline","cd0ce41c":"# Reading the csv file and putting it into 'df' object.\ndf = pd.read_csv(r\"\/kaggle\/input\/delhi-delights-data\/DelhiDelightsData.csv\")","1e7d80c4":"df.columns","5529e841":"df.head(len(df))","1ae2b6a4":"df.shape","e2ec7722":"df.info()","5e51a3fe":"df.describe()","0e7da143":"plt.figure(figsize = (10,5))\nax= sns.violinplot(df['Average Delivery Rating (a1)'])\nplt.show()","d82f8b11":"plt.figure(figsize = (15,5))\nax= sns.countplot(df['\"Delighted Members\" Purchase'])\nfor p in ax.patches:\n    ax.annotate(str(p.get_height()), (p.get_x() * 1.01 , p.get_height() * 1.01))\nplt.xticks(rotation = 45)\nplt.show()","6a99d5df":"df['\"Delighted Members\" Purchase'].value_counts(ascending=False) * 100 \/ len(df)","6141c720":"plt.figure(figsize = (10,5))\nax= sns.violinplot(df['Average Orders per month (a2)'])\nplt.show()","1f5ffa27":"plt.figure(figsize = (10,5))\nsns.violinplot(y = 'Average Delivery Rating (a1)', x = '\"Delighted Members\" Purchase', data = df)\nplt.show()","72391ee6":"plt.figure(figsize = (10,5))\nsns.violinplot(y = 'Average Orders per month (a2)',x='Average Delivery Rating (a1)', \n               hue = '\"Delighted Members\" Purchase', split=True,data = df,inner=\"quartile\")\nplt.show()","84f89449":"plt.figure(figsize = (10,5))\nsns.violinplot(y = 'Average Orders per month (a2)', x = '\"Delighted Members\" Purchase', data = df)\nplt.show()","696c257d":"plt.figure(figsize = (10,5))\nsns.heatmap(df.corr(), annot = True, cmap=\"rainbow\")\nplt.show()","dfc09dde":"# Putting feature variable to X\nX = df.drop('\"Delighted Members\" Purchase',axis=1)\n\n# Putting response variable to y\ny = df['\"Delighted Members\" Purchase']","5586c770":"from sklearn.model_selection import train_test_split","e070987f":"X_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.7, random_state=10)\nX_train.shape, X_test.shape","3d65c8fe":"from sklearn.tree import DecisionTreeClassifier","8dc9d813":"dt = DecisionTreeClassifier()\ndt.fit(X, y)","82a207c9":"from sklearn import tree\nfig = plt.figure(figsize=(25,20))\n_ = tree.plot_tree(dt,\n                   feature_names=X.columns,\n                   class_names=['Yes', \"No\"],\n                   filled=True)","b78d707e":"dt = DecisionTreeClassifier(random_state=7)\ndt.fit(X_train, y_train)","26c238d6":"from sklearn import tree\nfig = plt.figure(figsize=(25,20))\n_ = tree.plot_tree(dt,\n                   feature_names=X.columns,\n                   class_names=['Yes', \"No\"],\n                   filled=True)","d00e7f15":"from sklearn.metrics import confusion_matrix, accuracy_score","67c0cf85":"def evaluate_model(dt_classifier):\n    print(\"Train Accuracy :\", round(accuracy_score(y_train, dt_classifier.predict(X_train)),2))\n    print(\"Train Confusion Matrix:\")\n    print(confusion_matrix(y_train, dt_classifier.predict(X_train)))\n    print(\"-\"*50)\n    print(\"Test Accuracy :\", round(accuracy_score(y_test, dt_classifier.predict(X_test)),2))\n    print(\"Test Confusion Matrix:\")\n    print(confusion_matrix(y_test, dt_classifier.predict(X_test)))","c9797ad7":"evaluate_model(dt)","5a717bda":"dt = DecisionTreeClassifier(random_state=50)","bd33450c":"from sklearn.model_selection import GridSearchCV","637ef0c8":"# Create the parameter grid based on the results of random search \nparams = {\n    'max_depth': [2, 3, 4,5, 6],\n    'min_samples_leaf': [1,2,3,4,5],\n    'criterion': [\"gini\", \"entropy\"]\n}","2d28291c":"# Instantiate the grid search model\ngrid_search = GridSearchCV(estimator=dt, \n                           param_grid=params, \n                           cv=4, n_jobs=-1, verbose=1, scoring = \"accuracy\")","bc9f207b":"%%time\ngrid_search.fit(X_train, y_train)","e7b81611":"score_df = pd.DataFrame(grid_search.cv_results_)\nscore_df.head()","2f685080":"score_df.nlargest(5,\"mean_test_score\")","e3012f23":"grid_search.best_estimator_","d44863ea":"dt_best = grid_search.best_estimator_","671d4130":"fig = plt.figure(figsize=(25,10))\n_ = tree.plot_tree(dt_best,\n                   feature_names=X.columns,\n                   class_names=['Yes', \"No\"],\n                   filled=True)","1cf7ff16":"evaluate_model(dt_best)","e496c244":"from sklearn.metrics import classification_report","b5a5ce3d":"print(classification_report(y_test, dt_best.predict(X_test)))","6841ce30":"print(classification_report(y_train, dt_best.predict(X_train)))","c23eac5d":"### Decision Tree over test dataset","901b6681":"**Train Accuracy as 1 means overfitting model. Opted for Hyper-parameter tuning of this model**","bd5bb563":"# EDA ","e105eb13":"No Outliers exists for this field","dd4dbeb5":"**Balanced Dataset** over \"Delighted Members\" Purchase' field","8915ca2c":"![image1](https:\/\/miro.medium.com\/max\/875\/0*8CoIJ0viQsn4UH4G.jpg)","58559266":"We work at Delhi Delights! which is a food delivery company in Delhi. It offers a premium membership called \u2018Delighted Members\u2019, with which there is no delivery cost for your order. Lately, the number of purchases of this premium membership has been going down. Now, based on past data, Delhi Delights! wants to predict which of the customers will buy the 'Delighted Members' membership and which ones will not. \n","3e6e15d2":"### Decision Tree over whole dataset","e543666a":"No Outliers exists for this field"}}