{"cell_type":{"2358da39":"code","5783e2fc":"code","270387c4":"code","211937ad":"code","1ceaf713":"code","0fce260d":"code","057021bc":"code","c13536fe":"code","2fd2d521":"code","c087969a":"code","99d16000":"code","57749dc1":"code","18c59c0f":"code","a1df2bf0":"code","5472879e":"code","f71f3766":"code","4a6d013b":"code","720481ff":"code","93992a99":"code","716cceb4":"code","e7a3d40e":"code","ab50370d":"markdown"},"source":{"2358da39":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","5783e2fc":"df=pd.read_csv('..\/input\/random-linear-regression\/test.csv')\ndf.head()","270387c4":"df.shape","211937ad":"X=df['x'].values\nY=df['y'].values\nn=len(X)\nmean_x=np.mean(X)\nmean_y=np.mean(Y)","1ceaf713":"number=0\ndenom=0\nfor i in range(n):\n    number=number+(X[i]-mean_x)*(Y[i]-mean_y)\n    denom=denom+(X[i]-mean_x)**2\n    m=number\/denom\n    c=mean_y-(m*mean_x)\nprint(m,c)","0fce260d":"y_pred=m*X+c\nprint(y_pred)","057021bc":"plt.scatter(X,Y,label='actual points')\nplt.plot(X,y_pred,c='r',label='predicted')\nplt.legend()","c13536fe":"ss_t=0\nss_r=0\nfor i in range(n):\n    y_pred=m*X[i]+c\n    ss_t=ss_t+(Y[i]-mean_y)**2\n    ss_r=ss_r+(Y[i]-y_pred)**2\n    r2=1-(ss_r\/ss_t)\nprint(r2)","2fd2d521":"x=pd.DataFrame(df['x'])\ny=df['y']","c087969a":"from sklearn.model_selection import train_test_split","99d16000":"X_train,X_test,Y_train,Y_test=train_test_split(x,y,test_size=0.3,random_state=3)","57749dc1":"from sklearn.linear_model import LinearRegression\nmodel=LinearRegression()","18c59c0f":"model.fit(X_train,Y_train)","a1df2bf0":"y_predict=model.predict(X_test)","5472879e":"y_predict","f71f3766":"from sklearn.metrics import r2_score","4a6d013b":"score=r2_score(Y_test,y_predict)","720481ff":"score","93992a99":"import seaborn as sn","716cceb4":"sn.distplot(y_predict)","e7a3d40e":"plt.scatter(X_test,Y_test)\nplt.plot(X_test,y_predict,c='r')","ab50370d":"# by using sklearn"}}