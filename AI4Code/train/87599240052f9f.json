{"cell_type":{"4d01409c":"code","4ed85710":"code","2fc3824f":"code","aa6613e9":"code","153ccfe6":"code","a679f121":"code","0dbdf55e":"code","30d597ea":"code","4ac313bd":"code","f66d0744":"code","2f74cc08":"code","84a8f635":"code","a20ac3f0":"code","28f10701":"code","9fdb4938":"code","418da62e":"code","6e5836cc":"code","c8b7ac21":"markdown","fde29f74":"markdown","ac317bbf":"markdown","615aeee3":"markdown","f434e727":"markdown","b94367fd":"markdown","33449210":"markdown","cfc58df7":"markdown","f83b4bb4":"markdown","a8bea8b0":"markdown","9724c532":"markdown","635cf0b8":"markdown","048249fb":"markdown","4062d11e":"markdown","316e5e81":"markdown","e63d59a1":"markdown","a901dffe":"markdown"},"source":{"4d01409c":"\nimport numpy as np \nimport pandas as pd \nimport os\nimport seaborn as sns\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","4ed85710":"df = df = pd.read_csv(\"\/kaggle\/input\/heart-attack-analysis-prediction-dataset\/heart.csv\")\ndf.head()","2fc3824f":"sns.heatmap(df.corr(), annot=True)","aa6613e9":"print(df.info())","153ccfe6":"for i in df:\n print(i,'\\n',df[i].unique(),'\\n')","a679f121":"df.head()","0dbdf55e":"print('Before ',np.shape(df))\n# Dropping duplicates from the user_dets dataset\ndf.drop_duplicates(inplace=True)\n# Rechecking the shape of the ratings dataset after dropping duplicate records\nprint('After ',np.shape(df))\n","30d597ea":"df.isnull().sum()","4ac313bd":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score\n","f66d0744":"X= df.iloc[:,:-1]\ny = df.iloc[:,-1]","2f74cc08":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test= train_test_split(X,y,test_size=0.25, random_state=0)\n","84a8f635":"from sklearn.linear_model import LinearRegression\nreg=LinearRegression()\nreg.fit(X_train,y_train)","a20ac3f0":"y_pred = reg.predict(X_test)\ny_pred","28f10701":"from sklearn.metrics import r2_score\nprint('r2 score:',r2_score(y_test,y_pred))","9fdb4938":"import matplotlib.pyplot as plt\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score\naccuracy=[]\nestimators_count=[]\nfor i in range(1,51,5):\n RandomForest = RandomForestClassifier(n_estimators = i, criterion = 'entropy', random_state = 0)\n RandomForest.fit(X_train, y_train)\n y_predicted = RandomForest.predict(X_test)\n accuracy.append(accuracy_score(y_test,y_predicted))\n estimators_count.append(i)\n print(f'{i} {accuracy_score(y_test,y_predicted).round(4)}')\n \n# plot of No_of_Estimators VS Accuracy graph\nplt.plot(estimators_count,accuracy)\nplt.xlabel('Number of Estimators')\nplt.ylabel('Accuracy')\nplt.title('No_of_Estimators VS Accuracy')\nplt.grid(b=None)\nplt.show()\n","418da62e":"from sklearn.cluster import KMeans\n# Initialising wcss list\nwcss = []\n# Running the for loop\nfor i in range(2, 11):\n # Generating kmeans model with n_clusters=ith iteration of the for loop\n k_means = KMeans(n_clusters = i, init = 'k-means++', random_state = 42)\n # Ftting the model onto the dataset 'X'\n k_means.fit(X)\n # Appending the sum of squares to wcss\n wcss.append(k_means.inertia_) \n# Plot of the results using the Elbow Method\nplt.plot(range(2, 11), wcss)\nplt.title('The Elbow Method')\nplt.xlabel('Number of clusters')\nplt.ylabel('WCSS')\nplt.grid()\nplt.show()\n","6e5836cc":"from sklearn.metrics import silhouette_score\nfrom sklearn.cluster import KMeans\nsilhouette = []\nkmax = 10\nfor k in range(2, kmax+1):\n     k_means = KMeans(n_clusters = k).fit(X)\n     labels = k_means.labels_\n     silhouette.append(silhouette_score(X, labels, metric = 'manhattan',sample_size=5000))\nprint(silhouette)\n# plot of results obtained using the Silhoutte Method \nplt.plot(range(2, kmax+1), silhouette)\nplt.title('Silhouette Method')\nplt.xlabel('k')\nplt.ylabel('Silhouette Score')\nplt.grid()\nplt.show()\n","c8b7ac21":"**Importing Libraries**","fde29f74":"# Silhouette Score","ac317bbf":"# checking for null values","615aeee3":"# Importing Dataset","f434e727":"# Elbow Method Representation","b94367fd":"# R2 Score","33449210":"# Linear Regression","cfc58df7":"# Testing Model","f83b4bb4":"# Heart-Attack Analysis","a8bea8b0":"# HeatMap to check Correlation","9724c532":"# Splitting arrays into Training and Testing Arrays","635cf0b8":"![](http:\/\/www.templehealth.org\/sites\/default\/files\/inline-images\/heart-attack-symptoms-men-vs-women.png)","048249fb":"# Splitting Dependent and Independent Features","4062d11e":"# Importing Libraries","316e5e81":"**Data Information**","e63d59a1":"# Before and after dropping duplicates from datasets ","a901dffe":"# Estimators vs Accuracy"}}