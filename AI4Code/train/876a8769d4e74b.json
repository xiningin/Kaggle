{"cell_type":{"d118957c":"code","b728a904":"code","f23f3bd2":"code","00345d2d":"code","55624a75":"code","b1d95b69":"code","d9372bdf":"code","d0730a2f":"code","4ca2658d":"code","43c5b0d1":"markdown","349b1955":"markdown","12bffa20":"markdown","5654fa3d":"markdown","691bc3cd":"markdown","303ff7b9":"markdown","ff8458d4":"markdown"},"source":{"d118957c":"# Load minimal modules\n%pylab inline\nfrom matplotlib import style\nstyle.use('https:\/\/raw.githubusercontent.com\/JoseGuzman\/minibrain\/master\/minibrain\/paper.mplstyle') # custom plots\nimport pandas as pd","b728a904":"# Load waveforms\nmypath = '..\/input\/waveforms\/waveforms.csv'\nwaveforms = pd.read_csv(mypath, index_col = 'uid')\n\nprint(f'{waveforms.shape[0]} observations and {waveforms.shape[1]-1} samples (features)')\n\nwaveforms.organoid.value_counts()","f23f3bd2":"# define some custom colors for visualization\nmycolors = {'TSCp5_30s':     '#FFA500', # orange\n          'TSCp5_32s':       '#4169E1', # royalblue\n          'DLX_bluered':     '#DAA520', # goldenrod \n          'DLX_Cheriff':     '#228B22', # forestgreen\n          'DLX_H9' :         '#006400', # darkgreen \n          'AP_ctrl':         '#00BFFF', # deepskyblue \n          'AP_drug':         '#DC143C'  # crimson\n    }","00345d2d":"# Add color to the DataFrame\nwaveforms['color'] = waveforms['organoid'].apply(lambda orgID: mycolors[orgID])","55624a75":"def plot_waveform(index, color= True, ax = None):\n    \"\"\"\n    Returns an axis with the normalized waveform,\n    together with its color and tissue name. It \n    requires trace (2D NumPy array with the vectors\n    of spikes) and waveforms (pandas DataFrame).\n    \n    Arguments\n    ---------\n    index (int)\n        the index of the waveform to be selected in the\n        Pandas object.\n    color (bool)\n        If the default waveform color is plotted (default true)\n    ax (matplotlib axis object)\n        If None, use current axis object\n    \"\"\"\n    \n    myax = ax or plt.gca()\n    \n    # waveforms is a DataFrame and must be previously defined\n    df = waveforms.drop(['organoid', 'color'], axis = 1, inplace=False)\n    trace = df.values # 2D array\n    \n    if color:\n        myax.plot(trace[index], color = waveforms.iloc[index].color)\n    else:\n        myax.plot(trace[index], color = 'black')\n    \n    myax.text(x = 5, y= 0.75, s=waveforms.iloc[index].organoid, fontsize=10, color=waveforms.iloc[index].color)\n    \n    return myax","b1d95b69":"fig, ax = plt.subplots(1,7, figsize=(12,3))\nfig.suptitle('Example waveforms')\n\nax[0] = plot_waveform(index = 15,  ax = ax[0])\nax[1] = plot_waveform(index = 340, ax = ax[1])\nax[2] = plot_waveform(index = 319, ax = ax[2])\nax[3] = plot_waveform(index = 128, ax = ax[3])\nax[4] = plot_waveform(index = 132, ax = ax[4])\nax[5] = plot_waveform(index = 93,  ax = ax[5])\nax[6] = plot_waveform(index = 98,  ax = ax[6])\n\nax[6].text(x = 120, y= -1, s='1 ms', fontsize=10)\nax[6].hlines(y = -1.1, xmin = 120, xmax = 150, lw=2, color='k') # 30 samples -> 1ms\n\nfor myax in ax:\n    myax.set_ylim(-1.3,1.3)\n    myax.grid()\n    myax.axis('off')\n#plt.savefig('spikes.png', dpi = 600)","d9372bdf":"def plot_waveform(index, color= True, ax = None):\n    \"\"\"\n    Returns an axis with the normalized waveform,\n    together with its color and tissue name. It \n    requires trace (2D NumPy array with the vectors\n    of spikes) and waveforms (pandas DataFrame).\n    \n    Arguments\n    ---------\n    index (int)\n        the index of the waveform to be selected in the\n        Pandas object.\n    color (bool)\n        If the default waveform color is plotted (default true)\n    ax (matplotlib axis object)\n        If None, use current axis object\n    \"\"\"\n    \n    myax = ax or plt.gca()\n    \n    # waveforms is a DataFrame and must be previously defined\n    df = waveforms.drop(['organoid', 'color'], axis = 1, inplace=False)\n    trace = df.values # 2D array\n    \n    if color:\n        myax.plot(trace[index], color = waveforms.iloc[index].color)\n    else:\n        myax.plot(trace[index], color = 'black')\n   \n  \n    return myax","d0730a2f":"np.random.seed(42)\nmyidx = np.random.choice(range(len(waveforms)), size = 160, replace = False)\n\nncols = 10\nnrows = 16\n\nfig, ax = plt.subplots(ncols, nrows, figsize=(15,8))\n\n\ncounter = 0\nfor i in range(ncols):\n    for j in range(nrows):\n        ax[i,j] = plot_waveform(index = myidx[counter], color=False, ax = ax[i,j])\n        counter +=1\n\n#ax[nrows-1, ncols-1].text(x = 120, y= -1, s='1 ms', fontsize=10)\nax[9,15].hlines(y = -1.1, xmin = 100, xmax = 160, lw=2, color='k') # 30 samples -> 1ms\nax[9,15].text(x = 100, y = -0.9, s = '2 ms', fontsize = 10)\n\nfor myax in ax.flatten():\n    myax.grid('off')\n    myax.axis('off')","4ca2658d":"# Plot in colors\n\nfig, ax = plt.subplots(ncols, nrows, figsize=(15,8))\n\n\ncounter = 0\nfor i in range(ncols):\n    for j in range(nrows):\n        ax[i,j] = plot_waveform(index = myidx[counter], color=True, ax = ax[i,j])\n        counter +=1\n\nax[9,15].hlines(y = -1.1, xmin = 100, xmax = 160, lw=2, color='k') # 30 samples -> 1ms\nax[9,15].text(x = 100, y = -0.9, s = '2 ms', fontsize = 10)\n\nfor myax in ax.flatten():\n    myax.grid('off')\n    myax.axis('off')","43c5b0d1":"# Table of Contents\n\n* [1. Importing necesary libraries](#section1)\n    \n* [2. Loading Spikes dataset](#section2)\n    \n* [3. Visualization of waveforms](#section3)","349b1955":"## Plot the same spikes in colors","12bffa20":"<a id=\"section3\"><\/a>\n# 3. Visualization of waveforms","5654fa3d":"## Plot random spikes (in black)","691bc3cd":"<a id=\"section1\"><\/a>\n# 1. Importing necessary libraries\u00b6\n\nWe will load plotting parameters from my python module [minibrain](https:\/\/github.com\/JoseGuzman\/minibrain) \nto provide some custom plotting.\n\n","303ff7b9":"<a id=\"section2\"><\/a>\n# 2. Loading Dataset\n\n<P>\nThe dataset contains spike waveforms obtained from different neural tissues. \nIn Neuroscience\/Electrophysiology, we tend to use the word samples similar as features in Machine Learning.<\/P><a id=\"section1\"><\/a>","ff8458d4":"<CENTER><H1>Visualize spike waveforms<\/H1><\/CENTER>\n<BR>   \n<img src=\"https:\/\/raw.githubusercontent.com\/JoseGuzman\/minibrain\/master\/img\/spikes_colors.png\" width=\"800\"><BR>\n<BR>\n\nThis notebook plots spike waveforms obtained in different tissues similarly as with the [MNIST dataset](https:\/\/www.kaggle.com\/c\/digit-recognizer).Spikes are electrical signals generated by neurons for communication. Different spike waveforms correspond to different cell types or different neuron morphologies.\n"}}