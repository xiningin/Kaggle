{"cell_type":{"e8347059":"code","95918680":"code","733ea482":"code","4d7b4420":"code","21029fe1":"code","a14c1640":"code","f9026fa3":"code","07f54bbc":"code","2239f831":"code","7f5b4f01":"code","9daf38fe":"code","9132f0cc":"code","fa4e7156":"code","9acd1ca2":"markdown","06d513f4":"markdown","8948b55b":"markdown","3b7833b6":"markdown","e1d61bff":"markdown","37ebace8":"markdown","54ce2210":"markdown"},"source":{"e8347059":"import warnings\nwarnings.filterwarnings('ignore')\n\nimport random\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport tensorflow as tf\nimport matplotlib.image as mpimg\nimport matplotlib.pyplot as plt\n\nfrom tqdm import tqdm\nfrom sklearn.model_selection import StratifiedKFold, KFold\n\npd.set_option('display.max_colwidth',None)","95918680":"train = pd.read_csv('..\/input\/petfinder-pawpularity-score\/train.csv')\ntest = pd.read_csv('..\/input\/petfinder-pawpularity-score\/test.csv')\nsample_submission = pd.read_csv('..\/input\/petfinder-pawpularity-score\/sample_submission.csv')","733ea482":"train.head(2)","4d7b4420":"test.head(2)","21029fe1":"sample_submission.head(2)","a14c1640":"print(train.shape, test.shape, sample_submission.shape)","f9026fa3":"xgb_params = {\n    'eval_metric': 'rmse',\n    'seed': 1337,\n    'eta': 0.0123,\n    'subsample': 0.8,\n    'colsample_bytree': 0.85,\n    'silent': 1,\n}\n","07f54bbc":"N_FOLDS = 4\nFOLDS = StratifiedKFold(n_splits=N_FOLDS, shuffle=True, random_state=42)","2239f831":"import xgboost as xgb\ndef run_xgb(params, X_train, X_test):\n    kf = FOLDS\n    n_splits = N_FOLDS\n    \n    verbose_eval = 1000\n    num_rounds = 60000\n    early_stop = 500\n\n    oof_train = np.zeros((X_train.shape[0]))\n    oof_test = np.zeros((X_test.shape[0], n_splits))\n\n    i = 0\n\n    for train_idx, valid_idx in kf.split(X_train, X_train['Pawpularity'].values):\n\n        X_tr = X_train.iloc[train_idx, :]\n        X_val = X_train.iloc[valid_idx, :]\n\n        y_tr = X_tr['Pawpularity'].values\n        X_tr = X_tr.drop(['Pawpularity'], axis=1)\n\n        y_val = X_val['Pawpularity'].values\n        X_val = X_val.drop(['Pawpularity'], axis=1)\n\n        d_train = xgb.DMatrix(data=X_tr._get_numeric_data(), label=y_tr, feature_names=X_tr._get_numeric_data().columns, enable_categorical= True)\n        d_valid = xgb.DMatrix(data=X_val._get_numeric_data(), label=y_val, feature_names=X_val._get_numeric_data().columns, enable_categorical= True)\n\n        watchlist = [(d_train, 'train'), (d_valid, 'valid')]\n        model = xgb.train(dtrain=d_train, num_boost_round=num_rounds, evals=watchlist,\n                         early_stopping_rounds=early_stop, verbose_eval=verbose_eval, params=params)\n\n        valid_pred = model.predict(xgb.DMatrix(X_val._get_numeric_data(), feature_names=X_val._get_numeric_data().columns), ntree_limit=model.best_ntree_limit)\n        test_pred = model.predict(xgb.DMatrix(X_test._get_numeric_data(), feature_names=X_test._get_numeric_data().columns), ntree_limit=model.best_ntree_limit)\n\n        oof_train[valid_idx] = valid_pred\n        oof_test[:, i] = test_pred\n\n        i += 1\n    return model, oof_train, oof_test\n\nmodel, oof_train, oof_test = run_xgb(xgb_params, train, test)\n","7f5b4f01":"train_pred = oof_train\ntest_pred = np.mean(oof_test, axis=1)\ntrain_pred.shape, test_pred.shape","9daf38fe":"test_pred","9132f0cc":"submission = pd.DataFrame({'Id': sample_submission['Id'], 'Pawpularity': test_pred})\nsubmission","fa4e7156":"submission.to_csv(\"submission.csv\", index=False)","9acd1ca2":"# <div style=\"text-align:center; border: 2px solid #FFA500; border-radius: 25px\"><span style=\"color:purple\">Pawpularity Prediction<\/span><\/div>\nIn this competition, our goal is to predict the engaggement with a pet's profile based on the appearance of that profile. For example, what kind of pictures are likely to be attracted by someone. (including the pet's name, using props in the picture, using multiple pictures, using accessories etc.)\n\nWe are provide with metadata (data about data)\n- Image data\n- Tabular data\n\n\n*We want to predict the **Pawpularity score**. We can expect pets with attractive photos to generate more interest and be adopted faster.*\n ","06d513f4":"# Imports","8948b55b":"loading the `csv` files:","3b7833b6":"# Prediction","e1d61bff":"# Submission","37ebace8":"# Model Creation\n\n[Reference Kernel](https:\/\/github.com\/databatman\/kaggle-petfinder-competition\/blob\/master\/stacking-lgb-xgb-mlp-bug-fixed-again.ipynb)","54ce2210":"# Exploratory Data Analysis\n\n**The EDA Kernel** can be found [here](https:\/\/www.kaggle.com\/esratmaria\/petfinder-pawpularity-prediction-eda)"}}