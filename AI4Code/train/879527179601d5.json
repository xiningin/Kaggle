{"cell_type":{"071d7095":"code","ea07ab18":"code","6c388823":"code","8d1ea690":"code","e689cd2c":"code","0c3a54e4":"code","f0394e02":"code","678a483f":"code","df029b61":"code","24fd0a07":"code","ea66a5e7":"code","18079f2f":"code","776b68ca":"code","874cb0aa":"code","4b3e2152":"code","b6f37886":"code","17c1c529":"code","0c3d304d":"code","db7a0ff1":"code","ca47173a":"code","26f66657":"code","c975d162":"code","ad548c0f":"code","9bdf8b79":"code","4762b1bc":"code","ec6c0752":"code","0e914f3b":"code","42df45c0":"code","3cd3e471":"code","40bcee39":"code","a4194674":"code","56201e7f":"code","d38ba5c5":"code","0d1c348b":"code","457417f8":"code","0be186ba":"code","4a451b31":"code","cfb7da00":"code","d2f8f825":"code","584ebb1d":"code","9f556c62":"code","d183d308":"code","26a5b9bc":"code","1585beef":"code","a9eebbbf":"code","721c8191":"code","33def269":"code","c5cc8ab5":"code","a526a19f":"code","577725d5":"code","108dcf4b":"code","77685a8a":"markdown","0fed1ee8":"markdown","950d70db":"markdown","01031894":"markdown","bf8a17a6":"markdown","0080641a":"markdown","0f21472d":"markdown","782594c1":"markdown","f150dc9e":"markdown","4c4bc9c1":"markdown","3621fc4a":"markdown","35f6c424":"markdown","a1cdcc3f":"markdown","ff9214dc":"markdown","de44a115":"markdown","524d158c":"markdown","25b8ac0e":"markdown","6bedbe82":"markdown","c330d3cc":"markdown","95e247a1":"markdown","7ab93aae":"markdown","75da60dc":"markdown","8c53a559":"markdown","77ee1716":"markdown","8884dd90":"markdown","8084a519":"markdown","8ad1f16a":"markdown","7812a878":"markdown","47073c92":"markdown","11a5ee3d":"markdown","de700672":"markdown","8e897cad":"markdown","e393d5d9":"markdown","f80ff2a8":"markdown","5c5bb4db":"markdown","5fdf0664":"markdown","27ac7188":"markdown","00846e17":"markdown","91e6dda9":"markdown","5fde9c63":"markdown","f79a3996":"markdown","d82051b9":"markdown"},"source":{"071d7095":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","ea07ab18":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.graph_objs as go\nimport plotly.express as px\nimport plotly.offline as po","6c388823":"customer_churn = pd.read_csv('\/kaggle\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv')","8d1ea690":"customer_churn.head()","e689cd2c":"print('The names of columns in our dataset:\\n ',list(customer_churn.columns))\nprint(\"\\nThe total number of columns in our data set: \",len(customer_churn.columns))\nprint(\"\\nThe shape of our data set is: \",customer_churn.shape)","0c3a54e4":"print('-------------------------------')\nprint(\"Rows\\t\\tMissing values\")\nprint(\"-------------------------------\")\nprint(customer_churn.isna().sum())\nprint('------------------------------')","f0394e02":"print('----------------------------')\nprint(\"Rows\\t\\tData types\")\nprint('----------------------------')\nprint(customer_churn.dtypes)\nprint('----------------------------')","678a483f":"customer_churn['Churn'][:5]","df029b61":"customer_churn['Churn'] = customer_churn['Churn'].replace({\"Yes\":1,\"No\":0})","24fd0a07":"customer_churn['Churn'][:5]","ea66a5e7":"cols = ['OnlineBackup', 'StreamingMovies','DeviceProtection','TechSupport','OnlineSecurity','StreamingTV']\nfor values in cols:\n    customer_churn[values] = customer_churn[values].replace({'No internet service':'No'})","18079f2f":"customer_churn['TotalCharges'] = customer_churn['TotalCharges'].replace(\" \",np.nan)\n\n# Drop null values of 'Total Charges' feature\ncustomer_churn = customer_churn[customer_churn[\"TotalCharges\"].notnull()]\ncustomer_churn = customer_churn.reset_index()[customer_churn.columns]\n\ncustomer_churn['TotalCharges'] = customer_churn['TotalCharges'].astype(float)","776b68ca":"customer_churn['TotalCharges'].dtype","874cb0aa":"customer_churn['Churn'].value_counts().unique()","4b3e2152":"churn_x = customer_churn['Churn'].value_counts().keys().tolist()\nchurn_y = customer_churn['Churn'].value_counts().values.tolist()\nfig = px.pie(customer_churn,\n           labels = churn_x,\n            values = churn_y,\n            color_discrete_sequence=['grey','teal'],\n             hole=0.6\n            )\n\n\nfig.update_layout(\n    title='Customer Churn',\n    template='plotly_dark'\n)\nfig.show()","b6f37886":"gender_chunk = customer_churn.groupby('gender').Churn.mean().reset_index()\n\nfig = go.Figure(data=[go.Bar(\n            x=gender_chunk['gender'], y=gender_chunk['Churn'],\n            textposition='auto',\n            width=[0.2,0.2],\n            marker = dict(color=['brown','purple']))])\nfig.update_layout(\n    title='Churn rate by Gender',\n    xaxis_title=\"Gender\",\n    yaxis_title=\"Churn rate\",\n        template='plotly_dark'\n\n)\nfig.show()","17c1c529":"tech_chunk = customer_churn.groupby('TechSupport').Churn.mean().reset_index()\n\nfig = go.Figure(data=[go.Bar(\n            x=tech_chunk['TechSupport'], y=tech_chunk['Churn'],\n            textposition='auto',\n            width=[0.2,0.2],\n            marker = dict(color=['midnightblue','darkgreen']))])\nfig.update_layout(\n    title='Churn rate by Tech Support',\n    xaxis_title=\"Tech Support\",\n    yaxis_title=\"Churn rate\",\n        template='plotly_dark'\n\n)\nfig.show()","0c3d304d":"internet_chunk = customer_churn.groupby('InternetService').Churn.mean().reset_index()\n\nfig = go.Figure(data=[go.Bar(\n            x=internet_chunk['InternetService'], y=internet_chunk['Churn'],\n            textposition='auto',\n            width=[0.2,0.2,0.2],\n            marker = dict(color=['tomato','tan','cyan']))])\nfig.update_layout(\n    title='Churn rate by Internet Services',\n    xaxis_title=\"Internet Services\",\n    yaxis_title=\"Churn rate\",\n        template='plotly_dark'\n\n)\nfig.show()","db7a0ff1":"payment_chunk = customer_churn.groupby('PaymentMethod').Churn.mean().reset_index()\n\nfig = go.Figure(data=[go.Bar(\n            x=payment_chunk['PaymentMethod'], y=payment_chunk['Churn'],\n            textposition='auto',\n            width=[0.2,0.2,0.2,0.2],\n            marker = dict(color=['teal','thistle','lime','navy']))])\nfig.update_layout(\n    title='Churn rate by Payment Method',\n    xaxis_title=\"Payment Method Churns\",\n    yaxis_title=\"Churn rate\",\n        template='plotly_dark'\n\n)\nfig.show()","ca47173a":"contract_chunk = customer_churn.groupby('Contract').Churn.mean().reset_index()\n\nfig = go.Figure(data=[go.Bar(\n            x=contract_chunk['Contract'], y=contract_chunk['Churn'],\n            textposition='auto',\n            width=[0.2,0.2,0.2,0.2],\n            marker = dict(color=['teal','thistle','purple']))])\nfig.update_layout(\n    title='Churn rate by Contract',\n    xaxis_title=\"Contract Churns\",\n    yaxis_title=\"Churn rate\",\n        template='plotly_dark'\n\n)\nfig.show()","26f66657":"ten_chunk = customer_churn.groupby('tenure').Churn.mean().reset_index()\n\nfig = go.Figure(data=[go.Scatter(\n    x=ten_chunk['tenure'],\n    y=ten_chunk['Churn'],\n        mode='markers',\n        name='Low',\n        marker= dict(size= 5,\n            line= dict(width=0.8),\n            color= 'blue'\n           ),\n)])\nfig.update_layout(\n    title='Churn rate by Tenure',\n    xaxis_title=\"Tenure\",\n    yaxis_title=\"Churn rate\",\n    template='plotly_dark'\n\n)\nfig.show()","c975d162":"churn_data = pd.get_dummies(customer_churn, columns = ['Contract','Dependents','DeviceProtection','gender',\n                                                        'InternetService','MultipleLines','OnlineBackup',\n                                                        'OnlineSecurity','PaperlessBilling','Partner',\n                                                        'PaymentMethod','PhoneService','SeniorCitizen',\n                                                        'StreamingMovies','StreamingTV','TechSupport'],\n                              drop_first=True)","ad548c0f":"churn_data.head()","9bdf8b79":"from sklearn.preprocessing import StandardScaler\n\n#Perform Feature Scaling on 'tenure', 'MonthlyCharges', 'TotalCharges' in order to bring them on same scale\nstandard = StandardScaler()\ncolumns_for_ft_scaling = ['tenure', 'MonthlyCharges', 'TotalCharges']\n\n#Apply the feature scaling operation on dataset using fit_transform() method\nchurn_data[columns_for_ft_scaling] = standard.fit_transform(churn_data[columns_for_ft_scaling])\n","4762b1bc":"churn_data.head()","ec6c0752":"list(churn_data.columns)","0e914f3b":"from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import accuracy_score,plot_confusion_matrix","42df45c0":"X = churn_data.drop(['Churn','customerID'], axis=1)\ny = churn_data['Churn']","3cd3e471":"X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.3,random_state=0)","40bcee39":"X_train.shape,y_train.shape,X_test.shape,y_test.shape","a4194674":"#using logistic regression\nlog = LogisticRegression()\n\n#fitting our data\nlog.fit(X_train,y_train)\n\n#making prediction\ny_pred = log.predict(X_test)","56201e7f":"y_pred","d38ba5c5":"print(\"The accuracy score of Logistic Regression is: {:.2f}% \".format(accuracy_score(y_pred,y_test)*100))","0d1c348b":"#using random forest classifier\nrand = RandomForestClassifier()\n\n#fitting the data\nrand.fit(X_train,y_train)\n\n#predicting values\ny_rand_pred = rand.predict(X_test)","457417f8":"y_rand_pred","0be186ba":"print(\"The accuracy score of Random Forest is: {:.2f}% \".format(accuracy_score(y_rand_pred,y_test)*100))","4a451b31":"#using support vector machine\nsvm_model = SVC(kernel='linear',probability=True)\n\n#fitting our data\nsvm_model.fit(X_train,y_train)\n\n#predicting values\ny_svm_pred = svm_model.predict(X_test)\n#svm_model.score(X_test,y_test)","cfb7da00":"y_svm_pred","d2f8f825":"print(\"The accuracy score of Support Vector Machine is: {:.2f}% \".format(accuracy_score(y_svm_pred,y_test)*100))","584ebb1d":"#using decision tree classifier\ndec = DecisionTreeClassifier()\n\n#fitting our data\ndec.fit(X_train,y_train)\n\n#predicting the values\ny_dec_pred = dec.predict(X_test)","9f556c62":"print(\"The accuracy score of Decision Tree is: {:.2f}% \".format(accuracy_score(y_dec_pred,y_test)*100))","d183d308":"#using knearestneighbor\nknn = KNeighborsClassifier()\n\n#fitting our data\nknn.fit(X_train,y_train)\n\n#predicting the values.\ny_knn_pred = knn.predict(X_test)","26a5b9bc":"y_knn_pred","1585beef":"print(\"The accuracy score of K-Nearest Neighbor is: {:.2f}% \".format(accuracy_score(y_knn_pred,y_test)*100))","a9eebbbf":"print('Logistic Regression Model')\nplot_confusion_matrix(log,X_test,y_test);","721c8191":"print(\"Support Vector Machine Model\")\nplot_confusion_matrix(svm_model,X_test,y_test,cmap='summer');","33def269":"print(\"Random Forest Model\")\nplot_confusion_matrix(rand,X_test,y_test,cmap='cividis');","c5cc8ab5":"print(\"K-Nearest Neighbor Model\")\nplot_confusion_matrix(knn,X_test,y_test,cmap='magma');","a526a19f":"print(\"Decision Tree Model\")\nplot_confusion_matrix(dec,X_test,y_test,cmap='RdPu');","577725d5":"# Predict the probability of Churn of each customer\nchurn_data['Customer Churning Probability'] = log.predict_proba(churn_data[X_test.columns])[:,1]","108dcf4b":"churn_data[['customerID','Customer Churning Probability']].head(10)","77685a8a":"Here we can say that churn have have positive or negative values . Yes means customer will churn our and no means customer will not churn our. So, our first task is to convert the yes\/no values to 1\/0 values so that is will be easier for us to do the further operations.","0fed1ee8":"Here we can see that higher tenure resulted in low churn rate.","950d70db":"So lets plot the confusion matrix for each of our model model to see how well they perform.","01031894":"### Signing long term or short contract term churn the most?","bf8a17a6":"----\n\n<img src=\"https:\/\/www.websystemer.no\/wp-content\/uploads\/2020\/05\/understanding-confusion-matrix-and-applying-it-on-knn-classifier-on-iris-dataset-800x418.png\">\n\n----","0080641a":"### What percent of customer have churn or not?","0f21472d":"Here we can see that we have lots of items having data types object. \n\n## Exploratory Data Analysis\n\nNow, let's go through the churn column in our dataset.","782594c1":"Now, let's check if we have any missing values in our dataset","f150dc9e":"We have successfully splited our data into 70% and 30%. Now its time to predict using different algorithms.","4c4bc9c1":"### Confusion matrix","3621fc4a":"### Does Tech support plays a important role?","35f6c424":"-----\n\n<img src=\"https:\/\/static.javatpoint.com\/tutorial\/machine-learning\/images\/decision-tree-classification-algorithm.png\">\n\n-----","a1cdcc3f":"### \"Male or Female\" who have churn the most?","ff9214dc":"## Modelling","de44a115":"### Random Forest\n\n-----\n\n<img src=\"https:\/\/static.javatpoint.com\/tutorial\/machine-learning\/images\/random-forest-algorithm2.png\">\n\n-----","524d158c":"----\n\n<img src=\"https:\/\/static.javatpoint.com\/tutorial\/machine-learning\/images\/logistic-regression-in-machine-learning.png\">\n\n----","25b8ac0e":"# Telco Customer Churn\n### Focused customer retention programs\n\nThe churn rate, also known as the rate of attrition or customer churn, is the rate at which customers stop doing business with an entity. It is most commonly expressed as the percentage of service subscribers who discontinue their subscriptions within a given time period.\n\n----\n\n<img src=\"https:\/\/cdn-images-1.medium.com\/fit\/t\/1600\/480\/0*d58iZ6esNNcfntQ7\">\n\n----\n\n### Context\n\n\"Predict behavior to retain customers. Our goal is to analyze all relevant customer data and develop focused customer retention programs.\" \n\n### Content\n\nThe data set includes information about:\n\n* Customers who left within the last month \u2013 the column is called Churn\n* Services that each customer has signed up for \u2013 phone, multiple lines, internet, online security, online backup, device protection, tech support, and streaming TV and movies\n* Customer account information \u2013 how long they\u2019ve been a customer, contract, payment method, paperless billing, monthly charges, and total charges.\n* Demographic info about customers \u2013 gender, age range, and if they have partners and dependents","6bedbe82":"Now the values lies in yes or no for the above columns.","c330d3cc":"Here we can see that tenure,MonthlyCharges and TotalCharges are in same range. and the suffix are converted into subcolumns eg: Contract is expanded to contract_one year and Contract_Two year. These are only the individual values. Let's see how many columns we have in our dataset.","95e247a1":"### K-Nearest Neighbor","7ab93aae":"### Payment Method, Any role in Churning??","75da60dc":"Here we can clearly see that customers making payment through electronic check seem to be more churn than others.","8c53a559":"Here I have created a new column in our dataset named Customer Churning Probability.","77ee1716":"### Telecome company is not satisfying their customer with internet support?","8884dd90":"Time to split our data into x and y.","8084a519":"Let's predict the probability of churn for each customer using logistic regression model.","8ad1f16a":"Using the train_test_split() function to split our data into training and test sets. I will use 70% of our data for training our model and 30% for testing our model.","7812a878":"Here we can see that logistic regression and Support vector machine performs better as compared to other.","47073c92":"### Data Overview","11a5ee3d":"### Logistic Regression","de700672":"### Support Vector Machine","8e897cad":"Here we get the value in the form of 0 and 1. Let's step ahead and look at other rows if we can convert the values to the appropriate format.\n\nlet's convert replace the \"No internet service\" string to \"No\" in the following columns below.","e393d5d9":"### Decision Tree","f80ff2a8":"Total charges column have some values with extra spaces. so first remove those extra spaces from our columns. After that our column is a type of object so convert it into float.","5c5bb4db":"Here we have no missing values.\n\nTime to check what type of data we have.","5fdf0664":"Here, we can clearly see the probability of customer whether they churn or not.","27ac7188":"We can clearly see that we have added multiple columns for the individual values.\n\nNow let's import the appropriate libraries and train our model.","00846e17":"----\n\n<img src=\"https:\/\/static.javatpoint.com\/tutorial\/machine-learning\/images\/support-vector-machine-algorithm.png\">\n\n----","91e6dda9":"----\n\n<img src = \"https:\/\/static.javatpoint.com\/tutorial\/machine-learning\/images\/k-nearest-neighbor-algorithm-for-machine-learning2.png\">\n\n-----","5fde9c63":"Here we successfully converted our object type data into float.\n\n### Data Visualization\n\nLet's visualize our data and understand it more clearly.\n","f79a3996":"### Loading Data","d82051b9":"From the above bar chart we can clearly see that customers who have monthly contract seems more likely to churn as compared to one year of two year contract signed customers.\n"}}