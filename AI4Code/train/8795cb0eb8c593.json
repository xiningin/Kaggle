{"cell_type":{"8fb4bfd6":"code","0f917174":"code","1cd5e125":"code","5654e6a2":"code","adba60b1":"code","b200ce92":"code","422a52d6":"code","1eb80c31":"code","0e0d6003":"code","17166d1f":"code","b4ce308e":"code","d7644a0e":"code","986b93da":"code","1a8b1c97":"code","d69de02a":"code","fb1ad4bb":"code","a97007f9":"code","5a614fd6":"code","a7471150":"code","75cec437":"code","8e3c11e7":"code","7169c081":"code","477b4a38":"code","9bda932c":"code","9d2a5111":"code","de7fb9f9":"code","db8ea0bb":"markdown","e1a7f224":"markdown","9ce53d0c":"markdown","dcceae67":"markdown","f225d323":"markdown","9107a769":"markdown","c737b74c":"markdown","d00346e6":"markdown","d45cbfcc":"markdown","d81641e5":"markdown","1836f538":"markdown"},"source":{"8fb4bfd6":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport catboost\nimport catboost.datasets\nimport matplotlib.pyplot as plt  \nimport os\nimport sklearn.model_selection\nfrom scipy import stats\nfrom catboost import CatBoostRegressor\nimport shap\n","0f917174":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","1cd5e125":"with open(\"\/kaggle\/input\/house-prices-advanced-regression-techniques\/train.csv\") as file:\n    train  = pd.read_csv(file)\nwith open(\"\/kaggle\/input\/house-prices-advanced-regression-techniques\/test.csv\") as file:\n    test  = pd.read_csv(file)\n\n\nprint(\n    '''\n    \u0420\u0430\u0437\u043c\u0435\u0440\u044b \u0432\u044b\u0431\u043e\u0440\u043e\u043a, (\u043e\u0431\u044a\u0435\u043a\u0442\u044b, \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438).\n    - \u041e\u0431\u0443\u0447\u0430\u044e\u0449\u0430\u044f: {}\n    - \u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f: {}\n    '''.format(\n        train.shape,\n        test.shape\n    )\n)","5654e6a2":"test.columns","adba60b1":"display(train['MSZoning'].value_counts())","b200ce92":"train","422a52d6":"train[[\"SalePrice\", \"LotFrontage\", 'GarageCars', 'LotArea', 'Neighborhood', 'Condition1', 'BldgType', 'YearBuilt', 'ExterCond', 'Heating', 'GarageType']]","1eb80c31":"train = train[[\"SalePrice\", \"LotFrontage\", 'GarageCars', 'LotArea', 'Neighborhood', 'Condition1', 'BldgType', 'YearBuilt', 'ExterCond', 'Heating']]\ntest = test[[\"LotFrontage\", 'GarageCars', 'LotArea', 'Neighborhood', 'Condition1', 'BldgType', 'YearBuilt', 'ExterCond', 'Heating']]","0e0d6003":"train['SalePrice'].describe()","17166d1f":"train['SalePrice'].hist(bins=10)  \nplt.show()  ","b4ce308e":"a, _ = stats.boxcox(train['SalePrice'])\ntrain['SalePrice'] = pd.DataFrame({'SalePrice':a})\ntrain['SalePrice'].hist(bins=10) \nplt.show()  ","d7644a0e":"train.isna().mean()","986b93da":"\ntrain_no_missing = train.dropna()\ntest_no_missing = test.dropna()\n","1a8b1c97":"train_no_missing.isna().mean()","d69de02a":"train_no_missing = train_no_missing.applymap(str)","fb1ad4bb":"for i in train_no_missing.columns:\n    if i != 'SalePrice':\n        fig, ax = plt.subplots()\n        ax.scatter(train_no_missing['SalePrice'], train_no_missing[i])  \n        plt.xlabel('Sale Price')\n        plt.ylabel(i)\n        plt.show()","a97007f9":"train_X, val_X, train_y, val_y = sklearn.model_selection.train_test_split(\n    train_no_missing.drop(columns=['SalePrice']),\n    train_no_missing['SalePrice'],\n    test_size=0.1,\n    random_state=28\n)\n\ntest_X = test_no_missing\n#test_y = train_no_missing['SalePrice']","5a614fd6":"train_pool = catboost.Pool(\n    train_X,\n    label=train_y,\n    cat_features=list(train_X.columns)\n  \n)\nval_pool = catboost.Pool(\n    val_X,\n    label=val_y,\n    cat_features=list(train_X.columns)\n)\n","a7471150":"cat = CatBoostRegressor()\ncat.fit(train_pool, eval_set=val_pool,verbose=True)\n","75cec437":"cat","8e3c11e7":"params = {\"iterations\": 100,\n          \"depth\": 2,\n          \"loss_function\": \"RMSE\",\n          \"verbose\": False}\nscores = catboost.cv(val_pool, params)","7169c081":"scores","477b4a38":"sorted(\n    zip(train_X.columns, cat.feature_importances_), \n    key=lambda p: p[1], \n    reverse=True\n)","9bda932c":"shap_info = cat.get_feature_importance(\n    data=train_pool, \n    type='ShapValues', \n    verbose=10000\n)\nshap_values = shap_info[:,:-1]\nbase_values = shap_info[:,-1]","9d2a5111":"shap_values.shape","de7fb9f9":"shap.summary_plot(shap_values, train_X)","db8ea0bb":"\u041f\u043e\u0441\u043a\u043e\u043b\u044c\u043a\u0443 \u043e\u0442\u0432\u0435\u0442\u044b \u043d\u0430\u043c \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b, \u0442\u043e \u0441\u0440\u0430\u0432\u043d\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u0438 \u043c\u044b \u043d\u0435 \u043c\u043e\u0436\u0435\u043c. \u041e\u0434\u043d\u0430\u043a\u043e \u043c\u044b \u043c\u043e\u0436\u0435\u043c \u0443\u0437\u043d\u0430\u0442\u044c, \u043a\u0430\u043a\u0430\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f \u0432\u043d\u043e\u0441\u0438\u0442 \u0432\u043a\u043b\u0430\u0434 \u0431\u043e\u043b\u044c\u0448\u0435 \u0434\u0440\u0443\u0433\u0438\u0445 \u0432 \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u0435 \u0446\u0435\u043d\u044b","e1a7f224":"0. \u0417\u0430\u0433\u0440\u0443\u0437\u0438\u043c \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 \u0438 \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u0434\u0430\u043d\u043d\u044b\u0435","9ce53d0c":"\u0413\u0438\u043f\u043e\u0442\u0435\u0437\u044b: \u043c\u044b \u043f\u043e\u043b\u0430\u0433\u0430\u0435\u043c, \u0447\u0442\u043e \u0441\u0438\u043b\u044c\u043d\u0435\u0435 \u0432\u0441\u0435\u0433\u043e \u043d\u0430 \u0446\u0435\u043d\u0443 \u0434\u043e\u043c\u0430 \u043f\u043e\u0432\u043b\u044f\u044e\u0442: \n- \u0431\u043b\u0438\u0437\u043e\u0441\u0442\u044c \u0434\u043e\u043c\u0430 \u043a \u0443\u043b\u0438\u0446\u0435\n- \u0440\u0430\u0437\u043c\u0435\u0440 \u0433\u0430\u0440\u0430\u0436\u0430\n- \u0440\u0430\u0437\u043c\u0435\u0440 \u0443\u0447\u0430\u0441\u0442\u043a\u0430 (\u0447\u0435\u043c \u0431\u043e\u043b\u044c\u0448\u0435 \u0434\u043e\u043c \u0442\u0435\u043c \u043e\u043d \u0434\u043e\u0440\u043e\u0436\u0435)\n- \u0440\u0430\u0439\u043e\u043d \n- \u0431\u043b\u0438\u0437\u043e\u0441\u0442\u044c \u043a \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u043c \u043e\u0431\u044a\u0435\u043a\u0442\u0430\u043c \u0433\u043e\u0440\u043e\u0434\u0430\n- \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0432\u043d\u0435\u0448\u0435\u043d\u0435\u0433\u043e \u0432\u0438\u0434\u0430 \u0434\u043e\u043c\u0430\n- \u0442\u0438\u043f \u043e\u0442\u043e\u043f\u043b\u0435\u043d\u0438\u044f","dcceae67":"\u041c\u044b \u0432\u0438\u0434\u0438\u043c, \u0447\u0442\u043e \u043d\u0430 \u0446\u0435\u043d\u0443 \u0434\u043e\u043c\u0430 \u0441\u0438\u043b\u044c\u043d\u0435\u0435 \u0432\u0441\u0435\u0433\u043e \u0432\u043b\u0438\u044f\u044e\u0442 \u0440\u0430\u0439\u043e\u043d, \u0432\u043c\u0435\u0441\u0442\u0438\u043c\u043e\u0441\u0442\u044c \u0433\u0430\u0440\u0430\u0436\u0430 \u0438 \u0433\u043e\u0434 \u043f\u043e\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0437\u0434\u0430\u043d\u0438\u044f, ","f225d323":"\u0412\u0438\u0434\u0438\u043c \u0447\u0442\u043e \u0446\u0435\u043b\u0435\u0432\u0430\u044f \u043f\u0435\u0435\u0440\u043c\u0435\u043d\u043d\u0430\u044f \u0441\u043c\u0435\u0449\u0435\u043d\u0430 \u0432\u043b\u0435\u0432\u043e, \u0435\u0441\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0445\u0432\u043e\u0441\u0442 \u0432\u044b\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0437\u0430 \u043f\u0440\u0435\u043d\u0434\u0435\u043b\u044b \u0442\u0440\u0435\u0442\u044c\u0435\u0433\u043e \u043a\u0432\u0430\u043d\u0442\u0438\u043b\u044f (\u0432\u044b\u0448\u0435 214 \u0442\u044b\u0441\u044f\u0447 \u0434\u043e\u043b\u043b\u0430\u0440\u043e\u0432)\n\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0411\u043e\u043a\u0441\u0430-\u041a\u043e\u043a\u0441\u0430 \u0434\u043b\u044f \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445","9107a769":"1.1 \u043e\u0442\u0431\u0438\u0440\u0430\u0435\u043c \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435","c737b74c":"1.2. \u0421\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0446\u0435\u043b\u0435\u0432\u043e\u0439 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439","d00346e6":"2. \u041e\u0431\u0443\u0447\u0435\u043d\u0438\u0435","d45cbfcc":"3. Post-hoc \u0430\u043d\u0430\u043b\u0438\u0437","d81641e5":"1.4 \u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u0432\u0437\u0430\u0438\u043c\u043d\u043e\u0435 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u043b\u0435\u043d\u0438\u0435","1836f538":"1.3. \u0421\u043c\u043e\u0442\u0440\u0438\u043c \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u0438 \u0432 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445. \u0418\u0445 \u043c\u0430\u043b\u043e, \u0430 \u043f\u043e\u0442\u043e\u043c\u0443 \u043e\u0442\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u043c \u0438\u0445"}}