{"cell_type":{"9adef9a3":"code","1e41ffa4":"code","e6b84469":"code","5e643e85":"code","ac318ea3":"code","13a4e209":"code","6c0f1fd1":"code","e42df522":"code","2c6a02cc":"code","73d6d5f8":"code","cb48d0b1":"code","e0654c95":"code","ec50a7e3":"code","d492009c":"code","c523714c":"code","23444bd9":"code","62cc1323":"code","96bdfe6c":"code","34c91a87":"code","527c48ef":"code","61f06c7a":"code","7a71a7fc":"code","7484af84":"code","71231418":"code","b3356410":"code","c90d5551":"code","6ee360fa":"code","9758d680":"code","14aef317":"code","946da1f9":"code","12e77175":"code","3a72f7c3":"code","7d9ee143":"code","53d133eb":"code","3a277ae0":"code","ef1ad374":"code","f8bf8b21":"code","3bead6b1":"code","2f2149be":"code","21eae054":"code","279abfa9":"code","eef81e7b":"code","e4de1295":"code","159de291":"code","a949abe9":"code","90e57055":"code","6837e80f":"code","0b5d93bb":"code","b4581340":"code","861c0df7":"code","46c0a47a":"code","c2e7a875":"code","c2a295b9":"code","74ad4be3":"code","77b7f382":"code","d08cda09":"code","698cf15e":"code","0349de6b":"code","f1a07c4d":"code","c5e57f88":"code","b5727a24":"code","3cd512d6":"code","26aaadf5":"code","b91aa8b2":"code","ed138c66":"code","eb040e45":"code","6769e839":"code","dc8ff1aa":"code","ccb261d0":"code","a36f562c":"code","9281300d":"code","28528e12":"code","0059f7bd":"code","124be642":"code","044dffc1":"markdown","e04fa123":"markdown","dd7f9d44":"markdown","fb116e3a":"markdown","043631a3":"markdown","8ae37ebf":"markdown","1f681760":"markdown","f854b2fd":"markdown","42cea273":"markdown","cbb0bbc1":"markdown","e489d569":"markdown","bfa62573":"markdown","3dd8b874":"markdown","f4debf9d":"markdown"},"source":{"9adef9a3":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","1e41ffa4":"df = pd.read_csv('..\/input\/car-price\/cars.csv')\ndf.head()","e6b84469":"df.describe(include='all')","5e643e85":"df = df.drop(['Model'],axis=1)","ac318ea3":"df.describe(include='all')","13a4e209":"df.isnull().sum()","6c0f1fd1":"df = df.dropna(axis=0)","e42df522":"df.describe(include='all')","2c6a02cc":"sns.distplot(df['Price'])","73d6d5f8":"df.describe(include='all')","cb48d0b1":"q = df['Price'].quantile(0.99)","e0654c95":"df = df[df['Price']<q]\ndf.describe(include='all')","ec50a7e3":"sns.distplot(df['Price'])","d492009c":"sns.distplot(df['Mileage'])","c523714c":"q = df['Mileage'].quantile(0.99)\ndf = df[df['Mileage']<q]\ndf.describe(include='all')","23444bd9":"sns.distplot(df['Mileage'])","62cc1323":"sns.distplot(df['Year'])","96bdfe6c":"q = df['Year'].quantile(0.1)\ndf = df[df['Year']>q]\ndf.describe(include='all')","34c91a87":"sns.distplot(df['Year'])","527c48ef":"df[['EngineV']].max()","61f06c7a":"df[df['EngineV']>6.5].count()","7a71a7fc":"df = df[df['EngineV']<6.5]","7484af84":"df.describe(include='all')","71231418":"df","b3356410":"df = df.reset_index(drop=True)","c90d5551":"df","6ee360fa":"df.describe(include='all')","9758d680":"f,(ax1,ax2,ax3) = plt.subplots(1,3,sharey=True,figsize=(15,3))\nax1.scatter(df['Mileage'],df['Price'])\nax1.set_title('Milage vs Price')\n\nax2.scatter(df['EngineV'],df['Price'])\nax2.set_title('Engine Volume vs Price')\n\nax3.scatter(df['Year'],df['Price'])\nax3.set_title('Year vs Price')\n\n","14aef317":"log_price = np.log(df['Price'])\ndf['log_price'] = log_price","946da1f9":"f,(ax1,ax2,ax3) = plt.subplots(1,3,sharey=True,figsize=(15,3))\nax1.scatter(df['Mileage'],df['log_price'])\nax1.set_title('Milage vs Log Price')\n\nax2.scatter(df['EngineV'],df['log_price'])\nax2.set_title('Engine Volume vs Log Price')\n\nax3.scatter(df['Year'],df['log_price'])\nax3.set_title('Year vs Log Price')\n\n","12e77175":"from statsmodels.stats.outliers_influence import variance_inflation_factor","3a72f7c3":"variables = df[['Mileage','EngineV','Year']]\n\nvif = pd.DataFrame()\n\nvariables.shape","7d9ee143":"vif['VIF'] = [variance_inflation_factor(variables.values,i) for i in range(variables.shape[1])]","53d133eb":"vif['Features'] = variables.columns","3a277ae0":"vif","ef1ad374":"df = df.drop(['Year'],axis=1)","f8bf8b21":"df","3bead6b1":"df_dummies = pd.get_dummies(df,drop_first=True)","2f2149be":"df_dummies","21eae054":"df_dummies.columns","279abfa9":"variables = df_dummies[[x for x in df_dummies.columns if x not in ['Price']]]\n\nvif = pd.DataFrame()\n\nvariables.shape","eef81e7b":"vif['VIF'] = [variance_inflation_factor(variables.values,i) for i in range(variables.shape[1])]","e4de1295":"vif['Features'] = variables.columns","159de291":"vif","a949abe9":"df = df_dummies","90e57055":"df","6837e80f":"from sklearn.linear_model import LinearRegression","0b5d93bb":"reg = LinearRegression()","b4581340":"target = df[['log_price']]\ninputs = df.drop(['log_price','Price'],axis=1)","861c0df7":"inputs","46c0a47a":"# Scaling the data\nfrom sklearn.preprocessing import StandardScaler","c2e7a875":"scaler = StandardScaler()","c2a295b9":"scaler.fit(inputs)","74ad4be3":"scaled_input = scaler.transform(inputs)","77b7f382":"# Train-test split\nfrom sklearn.model_selection import train_test_split","d08cda09":"input_train,input_test,target_train,target_test = train_test_split(scaled_input,target,test_size=0.2,random_state=365)","698cf15e":"# Fitting a regression\n\nreg.fit(input_train,target_train)","0349de6b":"reg.score(input_train,target_train)","f1a07c4d":"yhat = reg.predict(input_train)","c5e57f88":"plt.scatter(target_train,yhat)","b5727a24":"sns.distplot(target_train-yhat)","3cd512d6":"y_hat_test = reg.predict(input_test)","26aaadf5":"plt.scatter(y_hat_test,target_test,alpha=0.2)\nfig = plt.plot([7.5,8,11,12],[7.5,8,11,12],lw=4,c='orange')\nplt.show()","b91aa8b2":"# Performance Dataframe\n\ndf_pf = pd.DataFrame(np.exp(y_hat_test),columns=['Predicted'])","ed138c66":"df_pf['Target'] = np.exp(target_test)","eb040e45":"df_pf","6769e839":"target_test = target_test.reset_index(drop=True)\ntarget_test","dc8ff1aa":"df_pf['Target'] = np.exp(target_test)","ccb261d0":"df_pf","a36f562c":"df_pf['Residual'] = df_pf['Target'] - df_pf['Predicted']","9281300d":"df_pf","28528e12":"df_pf['Difference%'] = np.absolute(df_pf['Residual']\/df_pf['Target']*100)","0059f7bd":"df_pf","124be642":"df_pf.describe()","044dffc1":"**We can notice that in columns Price and EngineV there are null values**","e04fa123":"**We carry out log transformation on price**","dd7f9d44":"**Creating Dummies**","fb116e3a":"**Testing**","043631a3":"**It is clearly visible that the graph is exponential**","8ae37ebf":"**Linear Regression**","1f681760":"**Checking the VIF including the dummies**","f854b2fd":"**We will drop those null rows**","42cea273":"**Model column is unnecessary**","cbb0bbc1":"**The graph is not normalized**","e489d569":"**So it is clear from the stats that 'year' has the highest VIF value. So it can be dropped**","bfa62573":"**It is clear from the table that the column Price has outliers**","3dd8b874":"**Plotting the independent varibles with price**","f4debf9d":"**Multicollinearity**"}}