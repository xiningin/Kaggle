{"cell_type":{"267322e1":"code","81b6698c":"code","f0a9e12e":"code","06188228":"code","b849e755":"code","f85b7f8a":"code","f1ab75e4":"code","1afbc9d0":"code","5f37caf0":"code","8f0f113f":"code","076816e0":"code","b9b73944":"code","691bf63b":"code","73735bc9":"code","87b408f1":"code","af33c42f":"code","e31646d1":"code","a7197e1e":"code","ada5822d":"code","f6b4f38d":"code","c43f2419":"markdown","6c1fc773":"markdown","0df9a7e9":"markdown","4f315f27":"markdown","27879019":"markdown","b06df15e":"markdown","ba6e0b0a":"markdown","6c9ea025":"markdown","b24e9a50":"markdown","d4a5850a":"markdown","cbd6cf58":"markdown","bf512ab9":"markdown","205611f4":"markdown","8f15c7c8":"markdown","d5f1b8c3":"markdown","81b69997":"markdown","2e343ddd":"markdown","95e548da":"markdown","9c963198":"markdown","74c9ddf0":"markdown","e4373823":"markdown","80e8a23a":"markdown","9c722bfc":"markdown","ac585bf7":"markdown","fc7fff63":"markdown","6ea9a546":"markdown","dbdc3d91":"markdown","aabe438a":"markdown","f1f05a19":"markdown","1699bdc5":"markdown","85abc8b5":"markdown"},"source":{"267322e1":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nfrom scipy import stats\nimport seaborn as sns\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.impute import SimpleImputer\n\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","81b6698c":"data = pd.read_csv('..\/input\/profiles-dating-app\/profiles.csv')\nprint(data.columns)\nprint(data.describe())","f0a9e12e":"data = data.dropna()\ndata.reset_index(drop=True, inplace=True)\nprint(len(data))\n","06188228":"feature_cols = data.loc[:, data.columns != 'body_type']\ntarget_col = data['body_type']","b849e755":"rel_cols = []\nfor i in feature_cols.columns:\n    print('Column: {}, different values: {}'.format(i, feature_cols[i].nunique()))\n    if feature_cols[i].nunique() < 100:\n        rel_cols.append(i)\n        \nprint(rel_cols)","f85b7f8a":"features = feature_cols[rel_cols]\n\nfeatures_dummies = pd.get_dummies(features)\nfeatures_dummies.head()","f1ab75e4":"age = data['age']\n\nplt.hist(age, bins=50)\nplt.title('Distribution of Age')\nplt.xlabel('Age')\nplt.ylabel('Number of People')\nplt.show()\n\nprint(age.describe())","1afbc9d0":"import plotly.express as px\n\nfig = px.histogram(data, x=\"age\", color=\"sex\")\n\nfig.show()","5f37caf0":"fig = px.histogram(data, x=\"height\", color=\"sex\")\n\nfig.show()","8f0f113f":"plt.hist(data['smokes'])\nplt.ylabel('Number of profiles')\nplt.xlabel('smoking status')\nplt.show()","076816e0":"X = features_dummies\ny= target_col\n\n\n\nX_train, X_test, y_train, y_test = train_test_split(X,y,random_state=1)\n\n\n\n","b9b73944":"from xgboost import XGBClassifier\n\n\n\nxgbcl = XGBClassifier()\n\n\nxgbcl.fit(X_train,y_train)\n\nxgbcl.score(X_test,y_test)","691bf63b":"from sklearn.model_selection import cross_val_score\n\nscores = cross_val_score(xgbcl, X,y,cv=5)\nprint(\"Cross validation scores: {}\".format(scores))","73735bc9":"from xgboost import plot_importance\n\nnum_features = 20\n\nprint('The importance of the {} most important features:'.format(num_features))\n\nimportance = plot_importance(xgbcl, ax=None, height=1, xlim=None, ylim=None, title='Feature importance', xlabel='F score', ylabel='Features', fmap='', importance_type='weight', max_num_features = num_features, grid=True, show_values=True)","87b408f1":"arr = xgbcl.feature_importances_\n\nsorted_index_array = np.argsort(arr) \n  \n\nsorted_array = arr[sorted_index_array] \n    \nn = 15\n\nrslt = sorted_array[-n : ] \n\nprint(\"{} largest values:\".format(n), \n      rslt) ","af33c42f":"print(data['orientation'].unique())","e31646d1":"feature_cols = data.loc[:, data.columns != 'orientation']\ntarget_col = data['orientation']","a7197e1e":"rel_cols = []\nfor i in feature_cols.columns:\n    print('Column: {}, different values: {}'.format(i, feature_cols[i].nunique()))\n    if feature_cols[i].nunique() < 100:\n        rel_cols.append(i)\n        \nprint(rel_cols)","ada5822d":"features = feature_cols[rel_cols]\n\nfeatures_dummies = pd.get_dummies(features)\nfeatures_dummies.head()","f6b4f38d":"X = features_dummies\ny= target_col\n\nxgbcl2 = XGBClassifier()\n\nscores = cross_val_score(xgbcl, X,y,cv=5)\nprint(\"Cross validation scores: {}\".format(scores))","c43f2419":"One hot encoding of categorical features results in the following dataframe (only the first five lines are shown):","6c1fc773":"# 2 Data Exploration","0df9a7e9":"Data is now cleaned and encoded and therefore ready for EDA and ML.","4f315f27":" # 1 Data Preparation","27879019":"Further questions that could lead to interesting insights:\n    \n* What are the most common sexual orientations among the users?\n* What are the most common languages?\n* What does the income distribution look like?\n* How many users have kids and how many pets?\n* Are there correlations among the features?\n* Can a tool be built that allows you to determine the percentage of the population that fits your preferences?","b06df15e":"## 2.2 Habits","ba6e0b0a":"Score is very low. Not sure if this can be suffienctly improved by grid search, feature selection\/engineering and other measures.","6c9ea025":"Note: Only columns with few categories are really suited for KNNClassifier!","b24e9a50":"Age distribution by sex shows that age is evenly distributed among the sexes. It also shows that there are more females in every age bracket than males.","d4a5850a":"Conclusion: I think the data set doesn\u00b4t contain enough information to reliably predict a persons body type.","cbd6cf58":"Handling missing values:","bf512ab9":"# 3 Predictions","205611f4":"Starting off with overall age distribution, it looks like the majority (75%) of users are between 20 and 40 years old. 50 percent of the users are older than 30 years:","8f15c7c8":"Results are  still very low. Precision seems quite consistent over different data.","d5f1b8c3":"The height distribution by sex shows that most females tend to be smaller than most males. This visualisation could be improved by displaying the relative distribution of size among each sex instead of absolute numbers. This would visually correct for the fact that there are more females than males in the data set (as shown above).","81b69997":"Choosing suitable features (Essays aren't useful for non-nlp-application, because they are neither numerical nor categorical)","2e343ddd":"## 3.1 Body Type Prediction","95e548da":"## 3.2 Sexual Orientation Prediction","9c963198":"Choosing suitable features (Essays aren't useful for non-nlp-application, because they are neither numerical nor categorical)","74c9ddf0":"One hot encoding of categorical features results in the following dataframe (only the first five lines are shown):","e4373823":"What features influence this classification?","80e8a23a":"The first analyzed habit is smoking. It seems like the vast majority of users don\u00b4t smoke.","9c722bfc":"Can feature selection improve the performance of the model?","ac585bf7":"Using cross validation:","fc7fff63":"## 2.1 Demographics","6ea9a546":"Splitting feature cols from target col","dbdc3d91":"Age is by far the most important feature for this prediction, followed by height and then income. What does this mean for the model and feature selection?","aabe438a":"# Questions\n\nPredictions:\n\n- Can body type be predicted by the dating profile info\n- Can sexual orientation be predicted by the dating profile info\n- Can sex be predicted by the essays in a dating profile","f1f05a19":"Splitting feature cols from target col","1699bdc5":"Data is ready for prediction","85abc8b5":"There are three categories of sexual orientation an user can choose from:"}}