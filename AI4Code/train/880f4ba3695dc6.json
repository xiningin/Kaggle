{"cell_type":{"cb6fc1dd":"code","ecb6bb88":"code","bf202eac":"code","148ec46f":"code","9c1502b9":"code","7e738689":"code","1f992438":"code","63477614":"markdown","e56a94a0":"markdown","5ecec6e7":"markdown","786a3ee5":"markdown"},"source":{"cb6fc1dd":"import numpy as np\n\nimport matplotlib.pyplot as plt\n\nfrom sklearn.datasets import make_moons\nfrom sklearn.cluster import DBSCAN","ecb6bb88":"N_SAMPLES = 1000\nNOISE = 0.05\nSEED = 42\n\nEPS1 = 0.05\nEPS2 = 0.2\nMIN_SAMPLES = 5","bf202eac":"X, y = make_moons(n_samples=N_SAMPLES, noise=NOISE, random_state=SEED)","148ec46f":"dbscan = DBSCAN(eps=EPS1, min_samples=MIN_SAMPLES)\ndbscan.fit(X)\n\nprint(\"lable length=\",np.unique(dbscan.labels_))\nprint(\"label data=\",dbscan.labels_[:10])\nprint(\"sample index length=\",len(dbscan.core_sample_indices_))\nprint(\"sample index data\",dbscan.core_sample_indices_[:10])\nprint(\"component\",dbscan.components_[:3])","9c1502b9":"dbscan2 = DBSCAN(eps=EPS2)\ndbscan2.fit(X)\n\nprint(\"lable length=\",np.unique(dbscan2.labels_))\nprint(\"label data=\",dbscan2.labels_[:10])\nprint(\"sample index length=\",len(dbscan2.core_sample_indices_))\nprint(\"sample index data\",dbscan2.core_sample_indices_[:10])\nprint(\"component\",dbscan2.components_[:3])\n","7e738689":"def plot_dbscan(dbscan, X, size, show_xlabels=True, show_ylabels=True):\n    core_mask = np.zeros_like(dbscan.labels_, dtype=bool)\n    core_mask[dbscan.core_sample_indices_] = True\n    anomalies_mask = dbscan.labels_ == -1\n    non_core_mask = ~(core_mask | anomalies_mask)\n\n    cores = dbscan.components_\n    anomalies = X[anomalies_mask]\n    non_cores = X[non_core_mask]\n    \n    plt.scatter(cores[:, 0], cores[:, 1],\n                c=dbscan.labels_[core_mask], marker='o', s=size, cmap=\"Paired\")\n    plt.scatter(cores[:, 0], cores[:, 1], marker='*', s=20, c=dbscan.labels_[core_mask])\n    plt.scatter(anomalies[:, 0], anomalies[:, 1],\n                c=\"r\", marker=\"x\", s=100)\n    plt.scatter(non_cores[:, 0], non_cores[:, 1], c=dbscan.labels_[non_core_mask], marker=\".\")\n    if show_xlabels:\n        plt.xlabel(\"$x_1$\", fontsize=14)\n    else:\n        plt.tick_params(labelbottom=False)\n    if show_ylabels:\n        plt.ylabel(\"$x_2$\", fontsize=14, rotation=0)\n    else:\n        plt.tick_params(labelleft=False)\n    plt.title(\"eps={:.2f}, min_samples={}\".format(dbscan.eps, dbscan.min_samples), fontsize=14)","1f992438":"plt.figure(figsize=(9, 3.2))\n\nplt.subplot(121)\nplot_dbscan(dbscan, X, size=100)\n\nplt.subplot(122)\nplot_dbscan(dbscan2, X, size=600, show_ylabels=False)\n\nplt.show()","63477614":"# red x is outliers","e56a94a0":"# plot","5ecec6e7":"# if esp == 0.05 => found outliers (label is -1)","786a3ee5":"# if eps == 0.2 => not found outliers"}}