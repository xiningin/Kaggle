{"cell_type":{"6c700231":"code","dd2d96e7":"code","1eb133cf":"code","aa856529":"code","ddf4b30b":"code","f9eba448":"code","44ffafe8":"code","39fbfe1f":"code","d576197b":"code","3c5d02db":"code","f648dd1f":"code","4cf71b20":"code","1434cb59":"code","4145b698":"code","f0e452cc":"code","7c8d8620":"code","a79987eb":"code","12139876":"code","e58e69fd":"code","7526e9d4":"code","9dcf212b":"code","d58ed7e5":"code","a2c11279":"code","417f7985":"code","5335b365":"code","9616815c":"code","86c2b56b":"code","9bdacc1a":"code","c2487f90":"code","32b0f1b8":"code","ea59928d":"code","552000e6":"code","9e8f1bf3":"code","5ea41f11":"markdown","17c2ed67":"markdown","dfa1ff84":"markdown","e9189c08":"markdown","4cda4ee6":"markdown","3641bd1a":"markdown","05350449":"markdown","43a69c17":"markdown","6c3f6043":"markdown","871be46a":"markdown","133e966d":"markdown","a46d86c0":"markdown","33cf0890":"markdown","6539fa00":"markdown","5a6cf61c":"markdown","b77d494e":"markdown","0bcda879":"markdown","cba93ba1":"markdown","eb14990c":"markdown"},"source":{"6c700231":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","dd2d96e7":"df = pd.read_csv(\"..\/input\/MiningProcess_Flotation_Plant_Database.csv\",decimal=\",\",parse_dates=[\"date\"],infer_datetime_format=True).drop_duplicates()","1eb133cf":"df.head()","aa856529":"df.describe()","ddf4b30b":"df = df.dropna()\ndf.shape","f9eba448":"plt.figure(figsize=(30, 25))\np = sns.heatmap(df.corr(), annot=True)","44ffafe8":"silic_corr = df.corr()['% Silica Concentrate']\nsilic_corr = abs(silic_corr).sort_values()\nsilic_corr","39fbfe1f":"drop_index= silic_corr.index[:5].tolist()+[\"date\"]#+[\"% Iron Concentrate\"]\nprint (drop_index)","d576197b":"df = df.drop(drop_index, axis=1)","3c5d02db":"df.head()","f648dd1f":"Y = df['% Silica Concentrate']\nX = df.drop(['% Silica Concentrate'], axis=1)","4cf71b20":"from sklearn import preprocessing\nmin_max_scaler = preprocessing.MinMaxScaler()","1434cb59":"X_scaled = pd.DataFrame(min_max_scaler.fit_transform(X), columns=X.columns)","4145b698":"from sklearn.model_selection import train_test_split","f0e452cc":"X_train, X_test, Y_train, Y_test = train_test_split(X_scaled, Y, test_size=0.3, random_state=42)","7c8d8620":"from sklearn.linear_model import LinearRegression","a79987eb":"reg = LinearRegression()","12139876":"_ = reg.fit(X_train, Y_train)","e58e69fd":"predictions = reg.predict(X_test)\npredictions","7526e9d4":"from sklearn.metrics import mean_squared_error","9dcf212b":"error = mean_squared_error(Y_test, predictions)\nerror","d58ed7e5":"from sklearn.linear_model import SGDRegressor","a2c11279":"reg_sgd = SGDRegressor(max_iter=1000, tol=1e-3)","417f7985":"_ = reg_sgd.fit(X_train, Y_train)","5335b365":"predicitons_sgd = reg_sgd.predict(X_test)","9616815c":"error_sgd = mean_squared_error(Y_test, predicitons_sgd)\nerror_sgd","86c2b56b":"from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\nfrom sklearn.model_selection import train_test_split\nfrom IPython.display import display\nfrom sklearn import metrics","9bdacc1a":"model = RandomForestRegressor(n_estimators=100, min_samples_leaf=1, max_features=None, n_jobs=-1)\nmodel.fit(X_train,Y_train)","c2487f90":"predicitons_rdmforest = model.predict(X_test)\nerror_rdf = mean_squared_error(Y_test, predicitons_rdmforest)\nerror_rdf","32b0f1b8":"from sklearn import datasets\nfrom sklearn.model_selection import cross_val_predict\nfrom sklearn import linear_model\nimport matplotlib.pyplot as plt\nax = plt.subplots()","ea59928d":"pred_1, pred_2, Y_1, Y_2 = train_test_split(predicitons_rdmforest, Y_test, test_size=0.9, random_state=42)","552000e6":"plt.figure(figsize=(20,20))\nplt.scatter(Y_1, pred_1)\nplt.plot([Y_1.min(), Y_1.max()], [Y_1.min(), Y_1.max()], 'k--', lw=4)\nplt.show()","9e8f1bf3":"plt.show(ax)","5ea41f11":"* In the dataset we have to predict the  **% Silica Concentrate**\n* Silica Concentrate is the impurity in the iron ore which needs to be removed\n* The current process of detecting silica takes many hours.\n* With the help of some analysis and modelling of data we can give a good approximation of silica concentrate which will reduce a lot of time and effort required for processing iron ore","17c2ed67":"# Quality Prediction in Iron Ore Mining","dfa1ff84":"### A basic analysis of dataset","e9189c08":"Lets reduce the number of variables ","4cda4ee6":"Finding Mean Squared Error","3641bd1a":"#### Using Stochastic Gradient Descent","05350449":"### Importing the Libraries","43a69c17":"Finding Mean Squared Error","6c3f6043":"### Scaling the features","871be46a":"### Training a Model","133e966d":"### Importing the Dataset","a46d86c0":"Now we will split data into train and test set","33cf0890":"Our Aim is to predict the percentage of silica in the end of the mining process of the iron ore","6539fa00":"Now we will have to drop those features which are not useful for us","5a6cf61c":"Above plot shows the correaltions between the features.\nFrom the list we can find out the features which affects the % Silica Concentrate the most and discard the least important ones. \nNote that ","b77d494e":"### Preparing the Dataset","0bcda879":"#### Using Linear Regression","cba93ba1":"Great! So we can see that there are no null values in the dataset.","eb14990c":"### Splitting the Data"}}