{"cell_type":{"79ded159":"code","6035e99b":"code","fa5812bd":"code","e4acc338":"code","f8a00625":"code","a59c350e":"code","ad7740b6":"code","8d3a1bf6":"code","c107143f":"code","a1c11654":"code","15dc8353":"code","ee8f6504":"code","623a870b":"code","a8d8071b":"code","7fd497b1":"code","9f20eda5":"code","8ae64cea":"markdown","dd83b971":"markdown","6be19a2e":"markdown","dba89019":"markdown","6564dbd4":"markdown","fa262cf3":"markdown"},"source":{"79ded159":"import numpy as np\nimport pandas as pd\nimport os\nimport sys\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.graph_objects as go\nimport plotly.express as px\nimport plotly.offline as py\nimport math\nimport itertools\nfrom scipy.stats import pearsonr\nfrom sklearn.linear_model import LinearRegression\npy.init_notebook_mode(connected=True)","6035e99b":"df = pd.read_csv(\"..\/input\/credit-card-balance-data\/Credit.csv\")\ndf","fa5812bd":"def quant_compare(feature_x, feature_y=\"Rating\"):\n    fig = px.scatter(df, x=feature_x, y=feature_y, trendline=\"ols\")\n    fig.update_layout(title={'text': f\"{feature_x} vs {feature_y}; Corr: {round(pearsonr(df[feature_x], df[feature_y])[0], 3)}\", 'x': 0.5,\n                             'xanchor': 'center', 'font': {'size': 20}}, yaxis_title=\"Credit Rating\")\n    fig.show()","e4acc338":"quant_compare('Income')","f8a00625":"quant_compare('Limit')","a59c350e":"quant_compare('Cards')","ad7740b6":"quant_compare('Age')","8d3a1bf6":"quant_compare('Balance')","c107143f":"quant_compare('Education')","a1c11654":"def qual_compare(feature_compare, feature_x=\"Rating\"):\n    fig = px.histogram(df, x=feature_x, color=feature_compare, histnorm='probability')\n    fig.update_layout(title={'text': f\"{feature_x} with Different {feature_compare} Histogram\", 'x': 0.5,\n                         'xanchor': 'center', 'font': {'size': 20}})\n    fig.show()\n    \n    plt.figure(figsize=(15, 8))\n    ax = sns.kdeplot(data=df, x=feature_x, hue=feature_compare)\n    ax.set_title(f\"{feature_x} with Different {feature_compare} KDE Plot\", fontsize=20)\n    plt.show()\n    \n    all_features = df[feature_compare].unique()\n    feature_dict = {}\n    for feature in all_features:\n        arr = df.loc[df[feature_compare] == feature][feature_x]\n        feature_dict[feature] = f\"{np.mean(arr)} +- {2*np.std(arr)}\"\n\n    for feature in feature_dict:\n        print(f\"{feature} Confidence Interval: {feature_dict[feature]}\")","15dc8353":"qual_compare('Gender')","ee8f6504":"qual_compare('Student')","623a870b":"qual_compare('Married')","a8d8071b":"qual_compare('Ethnicity')","7fd497b1":"model = LinearRegression()\nmodel.fit(X=df[['Income', 'Limit', 'Balance']], y=df['Rating'])\n\nprint(\"MSE of the model is: \", np.round(np.average(np.power(model.predict(df[['Income', 'Limit', 'Balance']])-df['Rating'], 2)), 3))","9f20eda5":"print(\"Intercept: \", model.intercept_)\nprint(\"Coefficients: \", model.coef_)","8ae64cea":"# Qualitative Features\n\n- Education, Gender, Student, Married, Ethnicity","dd83b971":"# Essential Imports","6be19a2e":"We implemented a linear regression model using income, limit, and balance as the input features, with credit rating as the target. Our model can be defined as:\n\n```Rating = 0.134 * Income + 0.062 * Limit + 0.015 * Balance + 44.425```\n\nThe Mean Squared Error of this model is ~142.674, which is surprisingly high given the fact the model was trained on the entire test dataset. In reality, the error would be much higher had the model been trained only on a subset of the entire data. ","dba89019":"# Quantitative Features\n\n- Income, Limit, Cards, Age, Balance","6564dbd4":"# Linear Regression\n\nThe predictors that are most closely associated with default are probably income, limit, balance, and perhaps also married and ethnicity. For the purposes of this exercise (so I don't have to use one-hot encoding), I decide to just use the appropriate quantative features.","fa262cf3":"# Credit Exploratory Data Analysis\n\nQuick notebook for exploring what features are most correlative\/indicative with a good credit score."}}