{"cell_type":{"e7885ee6":"code","e77b2cde":"code","acd1107e":"code","1b46de0c":"code","edf5bee5":"code","94b40443":"code","1681b85f":"code","b8256768":"code","f3dae485":"code","f100efce":"code","ec5f7022":"code","a53d6789":"code","cbc9a307":"code","2ddac00e":"code","80f512f0":"code","361252c9":"markdown","0d76ef54":"markdown","b66f32f6":"markdown","8072cd18":"markdown","f873b327":"markdown","f4e0f653":"markdown","f158346a":"markdown","36e9c202":"markdown","0c995ecc":"markdown","89ad9a0c":"markdown","85347917":"markdown","58a09b2d":"markdown","6f016066":"markdown","a1bf034e":"markdown"},"source":{"e7885ee6":"import tensorflow as tf\nfrom tensorflow.keras import Sequential\nfrom tensorflow.keras.layers import Conv2D,MaxPool2D,Dropout,Flatten,Dense,BatchNormalization\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom tensorflow.keras.preprocessing import image\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport cv2\nimport os\n","e77b2cde":"Parasitized_cell=os.listdir('..\/input\/cell-images-for-detecting-malaria\/cell_images\/Parasitized\/')\n\nuninfected_cell=os.listdir('..\/input\/cell-images-for-detecting-malaria\/cell_images\/Uninfected\/')\n\nprint(\"parasitized cell:\",len(Parasitized_cell))\nprint(\"Uninfcted cell:\",len(uninfected_cell))","acd1107e":"for i in range(5):\n    img=cv2.imread('..\/input\/cell-images-for-detecting-malaria\/cell_images\/Parasitized\/'+Parasitized_cell[i])\n    plt.imshow(img)\n    plt.title(\"Parasitized\")\n    plt.show()","1b46de0c":"for i in range(5):\n    img=cv2.imread('..\/input\/cell-images-for-detecting-malaria\/cell_images\/Uninfected\/'+uninfected_cell[i])\n    plt.imshow(img)\n    plt.title(\"Uninfected\")\n    plt.show()","edf5bee5":"width = 68\nheight = 68","94b40443":"datagen = ImageDataGenerator(rescale=1\/255.0, validation_split=0.2)","1681b85f":"trainDatagen = datagen.flow_from_directory(directory='..\/input\/cell-images-for-detecting-malaria\/cell_images\/cell_images\/',\n                                           target_size=(width,height),\n                                           class_mode = 'binary',\n                                           batch_size = 16,\n                                           subset='training')","b8256768":"trainDatagen.class_indices\n","f3dae485":"valDatagen = datagen.flow_from_directory(directory='..\/input\/cell-images-for-detecting-malaria\/cell_images\/cell_images\/',\n                                           target_size=(width,height),\n                                           class_mode = 'binary',\n                                           batch_size = 16,\n                                           subset='validation')\n","f100efce":"model = Sequential()\nmodel.add(Conv2D(16,(3,3),activation='relu',input_shape=(width,height,3)))\nmodel.add(MaxPool2D(2,2))\nmodel.add(Dropout(0.2))\n\n\nmodel.add(Conv2D(64,(3,3),activation='relu'))\nmodel.add(MaxPool2D(2,2))\nmodel.add(Dropout(0.3))\n\nmodel.add(Flatten())\nmodel.add(Dense(64,activation='relu'))\nmodel.add(Dropout(0.5))\n\nmodel.add(Dense(1,activation='sigmoid'))","ec5f7022":"model.summary()","a53d6789":"model.compile(optimizer='adam',\n              loss='binary_crossentropy',\n              metrics=['accuracy'])","cbc9a307":"history=model.fit_generator(generator=trainDatagen,\n                            steps_per_epoch=len(trainDatagen),\n                            epochs=6,\n                            validation_data=valDatagen ,\n                            validation_steps=len(valDatagen )\n                           )\n","2ddac00e":"plt.plot(history.history['accuracy'])\nplt.plot(history.history['val_accuracy'])\nplt.title('model accuracy')\nplt.ylabel('accuracy')\nplt.xlabel('epochs')\nplt.legend(['train', 'test'], loc='upper left')\nplt.show()\n\n# summarize history for loss\nplt.plot(history.history['loss'])\nplt.plot(history.history['val_loss'])\nplt.title('model loss')\nplt.ylabel('loss')\nplt.xlabel('epochs')\nplt.legend(['train', 'test'], loc='upper left')\nplt.show()","80f512f0":"testimg_path=\"..\/input\/cell-images-for-detecting-malaria\/cell_images\/Parasitized\/C100P61ThinF_IMG_20150918_144104_cell_163.png\"\nimg=image.load_img(testimg_path,target_size=(68,68))\nplt.imshow(img)\n\nx=image.img_to_array(img)\nx=np.expand_dims(x,axis=0)\nimages=np.vstack([x])\nval=model.predict(images)\nif val==0:\n    plt.title(\"Paracitized\")\nelse:\n    plt.title(\"Uninfected\")","361252c9":"# Thank for reading my notebook.If you like my **notebook  Upvote** it will be motivate me to create more notebook","0d76ef54":"# Splitting Dataset","b66f32f6":"## It will automatically assign label ","8072cd18":"##  Resizeing the cell images","f873b327":"# Visualization Cell Images","f4e0f653":"# Table of content\n* Introduction\n* Import necessary Library\n* Reading Image Data\n* Visualization Cell Images\n* Splitting Dataset\n* Preparing Train and Test data Generator\n* Creating CNN Model\n* Ploting Accuracy Of Our Model\n* Testing Our Model ","f158346a":"# Creating CNN Model","36e9c202":"# Import Necessary Library","0c995ecc":"# Reading Image Data","89ad9a0c":"## Before feeding cell images to the neural network we have to rescale all the images into same scale you know highest pixel of  a image is 255  if we divide all our images into 255 our cell images was scale into 0 and 1 .If we are not scalling our images reducing loss will take more time.","85347917":"#  Testing Our Model ","58a09b2d":"# Ploting Accuracy Of Our Model","6f016066":"# Preparing Train and Test data Generator","a1bf034e":"# Introduction\n\n##  Malaria is a life-threatening disease. It\u2019s typically transmitted through the bite of an infected Anopheles mosquito. Infected mosquitoes carry the Plasmodium parasite. \n   \n  \n   \n   \n\n   \n   ## When this mosquito bites you, the parasite is released into your bloodstream.Once the parasites are inside your body, they travel to the liver, where they mature. After several days, the mature parasites enter the bloodstream and begin to infect red blood cells.Within 48 to 72 hours, the parasites inside the red blood cells multiply, causing the infected cells to burst open.\n\n\n\n\n\n## The parasites continue to infect red blood cells, resulting in symptoms that occur in cycles that last two to three days at a time.\n\n## Malaria is typically found in tropical and subtropical climates where the parasites can live. The World Health Organization (WHO)Trusted Source states that, in 2016, there were an estimated 216 million cases of malaria in 91 countries.\n\n## In the United States, the Centers for Disease Control and Prevention (CDC) report 1,700 casesTrusted Source of malaria annually. Most cases of malaria develop in people who travel to countries where malaria is more common.\n\n\n## In this notebook we will see how to detect the malariya cell using CNN."}}