{"cell_type":{"5d43178c":"code","4d7dfd7c":"code","9dee185d":"code","deab8aaa":"code","46a5258b":"code","f8d9a01d":"code","5e9dbbb5":"code","96a81eba":"code","38b2846e":"code","56b84e3b":"code","80a2a2af":"code","b8cbe888":"code","4e8c2ad8":"code","4bf4930e":"markdown","05e70dee":"markdown","708c8bcd":"markdown","a86be9b8":"markdown"},"source":{"5d43178c":"import os\nfrom tensorflow.python import keras\nfrom tensorflow.python.keras.models import Sequential\nfrom tensorflow.python.keras.layers import Dense, Flatten, Conv2D, Dropout, MaxPooling2D\nimport numpy as np","4d7dfd7c":"#from tensorflow.python.keras.preprocessing.image import ImageDataGenerator","9dee185d":" # image_size = 150 \n# train_data_generator = ImageDataGenerator(\n#                                     rotation_range=40,\n#                                    width_shift_range=0.2,\n#                                    height_shift_range=0.2,\n#                                    shear_range=0.2,\n#                                    zoom_range=0.2,\n#                                    horizontal_flip=True)\n\n\n# train_generator = train_data_generator.flow_from_directory(\n#         '..\/input\/prajna-bhandary-face-mask-detection-dataset\/data\/train\/',\n#         target_size=(image_size, image_size),\n#         batch_size= 10)\n\n# validation_data_generator = ImageDataGenerator()\n# validation_generator = validation_data_generator.flow_from_directory(\n#         '..\/input\/prajna-bhandary-face-mask-detection-dataset\/data\/test\/',\n#         target_size=(image_size, image_size))\n","deab8aaa":"from tensorflow.python.keras.preprocessing.image import load_img, img_to_array\nfrom tensorflow.python.keras.applications.resnet import preprocess_input","46a5258b":"def img_path(path):\n    for dirname, _, filenames in os.walk(path):\n        l = []\n        y = []\n        for filename in filenames:\n            l.append(os.path.join(dirname, filename))\n            y.append(os.path.join(dirname, filename).split(\"\/\")[-2])\n        return (l, y)\n\nimage_size = 150\ndef read_and_prep_images(img_paths, img_height=image_size, img_width=image_size):\n    imgs = [load_img(img_path, target_size=(img_height, img_width)) for img_path in img_paths]\n    img_array = np.array([img_to_array(img) for img in imgs])\n    output = preprocess_input(img_array)\n    return(output)","f8d9a01d":"l_img_path, out_y = img_path(\"..\/input\/prajna-bhandary-face-mask-detection-dataset\/data\/train\/with_mask\/\")\nx, y = img_path(\"..\/input\/prajna-bhandary-face-mask-detection-dataset\/data\/train\/without_mask\/\")\nl_img_path = l_img_path + x \nout_y = out_y + y \nx, y = img_path(\"..\/input\/prajna-bhandary-face-mask-detection-dataset\/data\/test\/with_mask\/\")\nl_img_path = l_img_path + x \nout_y = out_y + y \nx, y = img_path(\"..\/input\/prajna-bhandary-face-mask-detection-dataset\/data\/test\/without_mask\/\")\nl_img_path = l_img_path + x \nout_y = out_y + y \n#print(l_img_path)\n#print(out_y)\nout_x = read_and_prep_images(l_img_path)\n\nfor i in range(len(out_y)):\n    if out_y[i] == \"with_mask\":\n        out_y[i] = 1\n    else:\n        out_y[i] = 0\nfrom tensorflow import keras\n# print(out_y)\nout_y = keras.utils.to_categorical(out_y, 2)","5e9dbbb5":"print(out_y)","96a81eba":"model = Sequential([\n    Conv2D(30, (3,3), activation='relu', input_shape=(150, 150, 3)),\n    Conv2D(30, (3,3), activation='relu'),\n    Flatten(),\n    Dense(50, activation='relu'),\n    Dense(2, activation='softmax')\n])\nmodel.compile(optimizer='adam', loss= keras.losses.categorical_crossentropy,  metrics=['acc'])","38b2846e":"from tensorflow.keras.callbacks import TensorBoard, ModelCheckpoint\ncheckpoint = ModelCheckpoint('model-{epoch:03d}.model',monitor='val_loss',verbose=0,save_best_only=True,mode='auto')","56b84e3b":"# history = model.fit_generator(train_generator,\n#                               epochs=3,\n#                               validation_data=validation_generator,\n#                               callbacks=[checkpoint])\nhist = model.fit(out_x, out_y,\n          batch_size=10,\n          epochs=2)","80a2a2af":"# import numpy as np\n# import cv2\n# import matplotlib.pyplot as plt\n# from PIL import Image\n# test_img_path = '..\/input\/prajna-bhandary-face-mask-detection-dataset\/data\/train\/without_mask\/10.jpg'\n# image = Image.open(test_img_path)\n# new_image = image.resize((150, 150))\n# plt.imshow(new_image)\n# mat = np.array(new_image)\n# result=model.predict(mat)","b8cbe888":"img_paths = ['..\/input\/prajna-bhandary-face-mask-detection-dataset\/data\/train\/with_mask\/1-with-mask.jpg', '..\/input\/prajna-bhandary-face-mask-detection-dataset\/data\/train\/without_mask\/10.jpg', '..\/input\/prajna-bhandary-face-mask-detection-dataset\/data\/train\/without_mask\/108.jpg'] \ntest_img = read_and_prep_images(img_paths)\npreds = model.predict(test_img)\nprint(preds)","4e8c2ad8":"I have not added even the validation set i will add after ","4bf4930e":"## DL imports ","05e70dee":"Trying the model explained here\n\nhttps:\/\/github.com\/mk-gurucharan\/Face-Mask-Detection\/blob\/master\/FaceMask-Detection.ipynb","708c8bcd":"with mask means 0 1 \n\nwihout mask means 1 0 ","a86be9b8":"from tensorflow.python.keras.applications.resnet50 import preprocess_input\n\nI have seen in the DL from scratch section that you can supply \n\nImageDataGenerator(preprocessing_function=preprocess_input)"}}