{"cell_type":{"cb978b6e":"code","20d3ff94":"code","d4e2c45b":"code","f9a2e28c":"code","4b535031":"code","060a57c0":"code","def80cdc":"code","df69d4f7":"code","a5755060":"code","f7673d37":"code","13065d9e":"code","6fac5356":"code","58d10d98":"code","1b9598c4":"code","8907f57a":"code","6d59cf11":"code","3bcf0f13":"code","76dcd33c":"code","9e5c9589":"code","dbc10fc9":"code","2ab85e60":"code","9e7681f5":"code","d73bd3a6":"code","92f40413":"code","c695dde3":"code","b3944301":"code","9c62e250":"code","7782a3d9":"code","5c8f75aa":"code","ac5818a9":"code","e80b287d":"code","6b98212c":"code","4a2025f1":"code","49003e18":"code","93cf1730":"code","66d48d6b":"code","80dd15d9":"code","f887f210":"code","0b947924":"code","42dcd4c0":"markdown","34bf41eb":"markdown","4d5242dc":"markdown","3310f297":"markdown","6d562be1":"markdown","4d9da633":"markdown","63eb8a80":"markdown","b647bb75":"markdown","7e381303":"markdown","10813bc6":"markdown","78cc31b5":"markdown","2c8f44dd":"markdown","15443ffe":"markdown","30d64bcd":"markdown","4a4a63d5":"markdown","e070f361":"markdown","0c11709d":"markdown","f16809e8":"markdown","4bd327ae":"markdown","41ed9f74":"markdown","26d5c205":"markdown","fa608091":"markdown","46b7fed6":"markdown","bddf9227":"markdown","8bbe66e2":"markdown","d750efda":"markdown","847906f4":"markdown"},"source":{"cb978b6e":"import numpy as np\nimport pandas as pd\nimport statsmodels.api as sm\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.ensemble import RandomForestRegressor","20d3ff94":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","d4e2c45b":"df = pd.read_csv(\"..\/input\/used-car-dataset-ford-and-mercedes\/merc.csv\", low_memory=False)","f9a2e28c":"print(\"The shape of data:\", df.shape)\ndf.head().T","4b535031":"df.info()","060a57c0":"df.describe(include=\"O\")","def80cdc":"df.describe()","df69d4f7":"len(df.model.unique())","a5755060":"fig = plt.figure(figsize=(20, 10))\nsns.countplot(y='model', data=df);\nplt.title(\"Car Model\");\nplt.xlabel(\"Count of the Cars\");\nplt.ylabel(\"Car Model\");","f7673d37":"df.model.unique().tolist()    ","13065d9e":"df.model.value_counts()","6fac5356":"df.model.value_counts().nlargest(5)","58d10d98":"plt.figure(figsize=(20,10))\ndf.model.value_counts().nlargest(5).plot(kind='bar')\nplt.title(\"Top 5 Most Popular Car\");","1b9598c4":"sns.set(style=\"whitegrid\")\nplt.figure(figsize=(15, 10))\nmileage_wise_price = df.groupby('model')['mileage'].mean().reset_index()\nm=sns.barplot(x='model', y='mileage', data=mileage_wise_price);\nm.set_xticklabels(df['model'].values,rotation=30)\nplt.title(\"Model-Wise-Mileage\")\nplt.show()","8907f57a":"plt.figure(figsize=(20,10))\ndf.groupby('model')['mileage'].mean().sort_values().nlargest(10).plot(kind='bar')\nplt.title( \"Top 10 cars mileages wise\")\nplt.ylabel(\"Mileage\")\nplt.show()","6d59cf11":"plt.figure(figsize=(20,10))\ndf.groupby('model')['mileage'].mean().sort_values().nsmallest(5).plot(kind='bar')\nplt.title( \"Top 5 cars with lowest mileages\")\nplt.ylabel(\"Mileage\")\nplt.show()","3bcf0f13":"plt.figure(figsize=(20, 5))\nyear_sale_model = df.groupby('year')['model'].count().reset_index()\nc = sns.barplot(x='year', y='model', data=year_sale_model)\nc.set_title(\"Car Sales by Year\")\nc.set_ylabel(\"Model Count\")\nplt.show()","76dcd33c":"plt.figure(figsize=(20, 10))\ny=sns.swarmplot(x='year', hue='model',y='price', data=df, size=10);\ny.set_title(\"Cars Sales in Year and Price Range\");","9e5c9589":"plt.figure(figsize=(20, 10))\nf = sns.lineplot(x='model', y='price', hue='transmission', data=df)\nf.set_xticklabels(df['model'].values, rotation=30)\nf.set_title(\"Populare Transmission by Price \")\nplt.show()","dbc10fc9":"plt.figure(figsize=(20, 10))\nf = sns.lineplot(x='model', y='price', hue='fuelType', data=df)\nf.set_xticklabels(df['model'].values, rotation=30)\nplt.title(\"Fuel Type Wise Car Price\");","2ab85e60":"plt.figure(figsize=(20, 8))\nsns.violinplot(y='mileage', x='fuelType', data=df);\nplt.title(\"Fule Type Wise Price\");","9e7681f5":"#Let's convert categorical features to numbers\n\nlabelencoder = LabelEncoder()\ndf = df.apply(lambda col: labelencoder.fit_transform(col))","d73bd3a6":"plt.figure(figsize=(20,10))\nplt.scatter('engineSize', 'mpg', c='mileage', s='price', data=df)\nplt.legend()\nplt.xlabel('Engine Size')\nplt.ylabel('MPG')\nplt.show()","92f40413":"plt.figure(figsize=(20,20))\nsns.heatmap(df.corr(), annot=True, cmap=\"RdYlGn\");","c695dde3":"#Let's make X & y\n\nX = df.drop(\"price\", axis=1)\ny = df[\"price\"]\n\n# Split data into train & test\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)\n\nX_train.shape, y_train.shape, X_test.shape, y_test.shape","b3944301":"from sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.metrics import mean_squared_error\n\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=50)\n\nlin = LinearRegression().fit(X_train, y_train)\npred = lin.predict(X_test).round(2)\nprint(f'Linear Model Coefficient (w) :{(lin.coef_)}')\nprint(f'Linear Model Intercept (b) :{(lin.intercept_).round(2)}')\nprint(\"R^2 score on train:\", lin.score(X_train, y_train).round(2))\nprint(\"R^2 score on test\", lin.score(X_test, y_test).round(2))\nprint(\"Mean absolue error (MAE):\", mean_absolute_error(y_test, pred))\nprint(\"Mean squared error (MSE):\", mean_squared_error(y_test, pred))","9c62e250":"plt.figure(figsize=(20,5))\nlent = [i for i in range(len(X_test))]\nplt.plot(lent, X_test, 'bs')\nplt.plot(lent, y_test, 'ro')\nplt.plot(lent, pred, 'g^')\nplt.title(\"Actual Vs Predicted\")\nplt.xlabel(\"Actual Price\")\nplt.ylabel(\"Prediction Price\")\nplt.show()","7782a3d9":"plt.figure(figsize=(20,5))\nlent = [i for i in range(len(X_test))]\nplt.plot(lent, y_test, 'ro')\nplt.plot(lent, pred,'g^')\nplt.title(\"Actual Vs Predicted (Price)\")\nplt.xlabel(\"Actual Price\")\nplt.ylabel(\"Prediction Price\")\nplt.show()","5c8f75aa":"plt.figure(figsize=(20,5))\nplt.plot(y_test-pred, 'b*')\nplt.title(\"error\")\nplt.show()","ac5818a9":"# Error distribution\nplt.figure(figsize=(20,10))\nsns.distplot(y_test - pred, bins=100)\nplt.xlabel('Actual_price - Predicted_price')\nplt.ylabel('Index')\nplt.title('Error distribution')\nplt.show()","e80b287d":"df_model = pd.DataFrame(data={\"Actual Value\": y_test,\n                             \"Predicted Value\": pred})\ndf_model[\"Difference\"] = df_model[\"Predicted Value\"].round(2)-df_model['Actual Value']\ndf_model[:10]","6b98212c":"plt.figure(figsize=(15,10))\nplt.scatter(data=df_model, x='Actual Value', y=\"Predicted Value\", marker=\"*\")\nplt.title(\"\");","4a2025f1":"plt.figure(figsize=(20,10))\nsns.scatterplot(x='Actual Value', y='Predicted Value', data=df_model);","49003e18":"rfr = RandomForestRegressor(n_estimators=114, max_depth=15, random_state=100).fit(X_train, y_train)\n","93cf1730":"print(\"R2\", rfr.score(X_test, y_test))\nprediction = rfr.predict(X_test)","66d48d6b":"plt.figure(figsize=(20,5))\nlent = [i for i in range(len(X_test))]\nplt.plot(lent, X_test, 'bs')\nplt.plot(lent, prediction, 'ro')\nplt.plot(lent, y_test, 'g^')\nplt.title(\"Actual Vs Predicted\")\nplt.xlabel(\"Actual Price\")\nplt.ylabel(\"Prediction Price\")\nplt.show()","80dd15d9":"plt.figure(figsize=(20,5))\nlent = [i for i in range(len(X_test))]\nplt.plot(lent, y_test, 'ro')\nplt.plot(lent, prediction,'g^')\nplt.title(\"Actual Vs Predicted (Price)\")\nplt.xlabel(\"Actual Price\")\nplt.ylabel(\"Prediction Price\")\nplt.show()","f887f210":"plt.figure(figsize=(20,5))\nplt.plot(y_test-prediction, 'r*')\nplt.title(\"error\")\nplt.show()","0b947924":"# Error distribution\nplt.figure(figsize=(20,10))\nsns.distplot(y_test - prediction, bins=100)\nplt.xlabel('Actual_price - Predicted_price')\nplt.ylabel('Index')\nplt.title('Error distribution')\nplt.show()","42dcd4c0":"***Which are the top 5 cars with lowest mileage?***","34bf41eb":"***Now let's plot the correlation matrix***","4d5242dc":"***Which are the most popular cars?***","3310f297":"***Plot the Prediction vs Actual***","6d562be1":"***Which are the top 10 cars mileages wise?***","4d9da633":"### Random Forest Regressor\n","63eb8a80":"***Which are top 5 car most popular?***","b647bb75":"### Mercedes Price Prediction\n\n### EDA with some simple questions and will find out the answers in dataset\n","7e381303":"***How is relatationship between features Engine Size, MPG, Mileage and Price?***","10813bc6":"### Linear Regression","78cc31b5":"### Describe statstics summary on categorical features data","2c8f44dd":"***Which type of car models we have in this data?***","15443ffe":"### Import the data","30d64bcd":"***Plot the prediction & actual sales price with X_test set for understading how speared prediction & Actual price with features***","4a4a63d5":"***Which transmission most populared in sold cars and what are the price range?***","e070f361":"### Describe statstics summary on numerical features data","0c11709d":"***Plot the Actual Vs Predicted***","f16809e8":"***Plot the prediction & actual sales price with X_test set for understading how speared prediction & Actual price with features***","4bd327ae":"### Plot the Error rate (Actual-Prediction)","41ed9f74":"+ We can see above most populated technology Semi-Auto and Automatic\n\n***Which fuel type car has highe price?***","26d5c205":"***What are car models sale in which year and what is the price range?***","fa608091":"***Here is the some question which have been taken from Mercedese dataset***\n+ How many car models we have?\n+ Which are the most popular models?\n+ Which type of car models we have in this data?\n+ Which are the most popular cars?\n+ which are top 5 car most popular?\n+ What are the cars mileage?\n+ Which are the top 10 cars mileages wise?\n+ Which are the top 5 cars with low mileages?\n+ In which year most cars sale?\n+ What are car models sale in which year and what is the price range?\n+ Which transmission most populated in sold cars and what are the price range?\n+ Which fuel type car has higher price?\n+ Which fuel type car has higher mileage?\n+ How is relationship between features Engine Size, MPG, Mileage and Price? And finally\n+ How correlation between all features? \n","46b7fed6":"This dataset have 27 car models","bddf9227":"***What are the cars mileage?***","8bbe66e2":"\n\n***Which fuel type car has higher mileage?***","d750efda":"***How many car models we have?***","847906f4":"***In which year most cars sale?***"}}