{"cell_type":{"f2b6d3a3":"code","b5d70fe7":"code","ae47ebe3":"code","c9e39c03":"code","e3c2e300":"code","3332ca78":"code","678d3ee9":"code","90b5f548":"code","e1f7635e":"code","b760f2c8":"code","9c25b10e":"code","fcf33075":"code","1ebf5a82":"code","b7bcf695":"code","ef5295af":"code","fc34d339":"code","595b9ad5":"code","59385aaa":"code","fb3736aa":"code","db0a1f6c":"code","f54a807c":"code","88ab5991":"markdown","66ee3aa2":"markdown","252bdf0e":"markdown","134de600":"markdown","76f667f8":"markdown","b7132870":"markdown","5a46d78d":"markdown","86bc186c":"markdown","6ad765c7":"markdown","12a814a8":"markdown","b9264227":"markdown","74f05854":"markdown","c76db26b":"markdown","ef177c3c":"markdown","f5879abc":"markdown","c055a42f":"markdown","25d0b1df":"markdown","32e2c6f6":"markdown","b2c63ab2":"markdown","6ee5fd89":"markdown","de5df91c":"markdown","3715b229":"markdown","3a3f522f":"markdown","e945f483":"markdown","5a5c7e43":"markdown"},"source":{"f2b6d3a3":"import pandas as pd\nimport numpy as np\nimport warnings\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import datasets, linear_model\nimport statsmodels.api as sm\nfrom scipy import stats\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.metrics import mean_absolute_error\nwarnings.filterwarnings(\"ignore\")","b5d70fe7":"df = pd.read_csv('..\/input\/graduate-admissions\/Admission_Predict_Ver1.1.csv')\ndf.head()","ae47ebe3":"df.shape","c9e39c03":"df = df.drop(['Serial No.'], axis=1)","e3c2e300":"df.isnull().sum()","3332ca78":"df.columns = ['GRE Score', 'TOEFL Score', 'University Rating', 'SOP', 'LOR', 'CGPA','Research', 'Chance of Admit']","678d3ee9":"DV = 'Chance of Admit'\nIVs = list(df.columns)\nIVs.remove('Chance of Admit')","90b5f548":"def scatter_plot_with_admit(X,Y,df):\n    fig = sns.regplot(x=X, y=Y, data=df)\n    plt.title(str(X) + ' vs ' + str(Y))\n    plt.show()\n\ndef plot_all(IVs, DV, df):\n    for IV in IVs:\n        scatter_plot_with_admit(IV,DV,df)","e1f7635e":"plot_all(IVs,DV,df)","b760f2c8":"corr = df.corr()\nfig,ax = plt.subplots(figsize= (6, 6))\nsns.heatmap(corr, ax= ax, annot= True,linecolor = 'white')\ncorr.style.background_gradient(cmap='coolwarm').set_precision(2)\nplt.show()","9c25b10e":"x = df.drop(['Chance of Admit','GRE Score','TOEFL Score','University Rating','SOP'], axis=1)\ny = df['Chance of Admit']\nX_train, X_test, y_train, y_test = train_test_split(x,y,test_size = 0.20, shuffle=False)","fcf33075":"mod = sm.OLS(y_train,X_train)\nfii = mod.fit()\np_values = fii.summary2().tables[1]['P>|t|']\np_values <0.05","1ebf5a82":"lm = linear_model.LinearRegression()\nlm.fit(X_train, y_train)","b7bcf695":"predictions = lm.predict(X_test)","ef5295af":"for IV,coef in zip(X_train.columns,lm.coef_):\n    print('coefficient of',IV,'is' ,coef)","fc34d339":"lm.intercept_","595b9ad5":"yhat = lm.predict(X_train)\nSS_Residual = sum((y_train-yhat)**2)       \nSS_Total = sum((y_train-np.mean(y_train))**2)     \nr_squared = 1 - (float(SS_Residual))\/SS_Total\nadjusted_r_squared = 1 - (1-r_squared)*(len(y_train)-1)\/(len(y_train)-X_train.shape[1]-1)\nprint(r_squared, adjusted_r_squared)","59385aaa":"print(lm.score(X_train, y_train), 1 - (1-lm.score(X_train, y_train))*(len(y_train)-1)\/(len(y_train)-X_train.shape[1]-1))","fb3736aa":"sns.residplot(predictions.reshape(-1),y_test, data=df,lowess=True,\n                                  line_kws={'color': 'red', 'lw': 1, 'alpha': 1})\nplt.xlabel(\"Fitted values\")\nplt.title('Residual plot')","db0a1f6c":"residuals = y_test - predictions.reshape(-1)\nplt.figure(figsize=(7,7))\nstats.probplot(residuals, dist=\"norm\", plot=plt)\nplt.title(\"Normal Q-Q Plot\")","f54a807c":"print('Mean Squared error:',np.sqrt(mean_squared_error(y_test, predictions)))\nprint('Mean Absolute error:',mean_absolute_error(y_test, predictions))","88ab5991":"# **Linear regression **","66ee3aa2":"CGPA are highly correlated with GRE Score, TOEFL Score, University rating, SOP. \n\nTo avoid multicollinearity, only CGPA will be kept as independent variable. \n\nChance of adamit and CGPA have the highest correlation coefficient among all pairs of change of admit and other variables.","252bdf0e":"Both values are small, the difference between prediction and actual value is small.","134de600":"Seem all Independent variables are positively correlated to Chance of admit.\nCorrelation coefficient will be computed.","76f667f8":"Rename the columns, there are some spacing problems","b7132870":"# **Data cleaning**","5a46d78d":"Create plot for all indepenent variables against dependent varibale","86bc186c":"# ****MSE and MAE****","6ad765c7":"# **Import libraries**","12a814a8":"# **Model building**","b9264227":"Estimated chance of admit = -0.838 + LOR * (0.023) + CGPA * (0.170) + Research * (0.036)","74f05854":"No empty cell at all.","c76db26b":"Serial No can be removed. It is not useful for model building.","ef177c3c":"**The Regression formula shows below.**","f5879abc":"There are two ways to compute R square adn adjusted R square.","c055a42f":"# **Assumption Checking**","25d0b1df":"# **Data set**","32e2c6f6":"# **R square and adjusted R square**","b2c63ab2":"This model explain 78.5% of the variation of chance of admit by the response variables. No assumputions of regression are violated.","6ee5fd89":"Residual seems normally distributed.","de5df91c":"# **Conclusion**","3715b229":"Considering 95% significant, all explanatory variables has a p-value smaller than 0.05. \n","3a3f522f":"About 78.5% of the variation of chance of admit can be explained by this model.\n\nNotice that this is a multiple linear regression, so we consider adjusted R square.","e945f483":"No obvious trend of residual variance.\nResidual seems independent.","5a5c7e43":"# **Data Analysis**"}}