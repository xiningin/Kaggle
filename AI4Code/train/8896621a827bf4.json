{"cell_type":{"10c2ce3b":"code","5df163d0":"code","ca0b0e15":"code","f5009cd1":"code","2b911209":"code","820c6466":"code","64f16b88":"code","5b506aac":"code","982fae19":"code","45fe1a1c":"code","676c33cb":"code","4c288279":"code","5cf5aac1":"code","8460384a":"code","98d768ff":"code","9135be2b":"code","20bae892":"code","f3fd34d5":"code","aa8ed652":"code","a9c357a4":"code","3d66d3b0":"code","e2f123c9":"code","0d0fe57a":"code","9e0d91ed":"code","f88cd298":"code","f6592b87":"code","9252d973":"code","b84c5030":"code","270ae6fd":"code","848c5a69":"code","229530a1":"code","f409d4eb":"code","93d0c436":"code","d54c608e":"code","a0fc593f":"code","856a4aab":"code","388b9cb5":"code","77033052":"code","ab6148fc":"code","eee7fe7a":"code","43683a9f":"markdown","70a06809":"markdown","2fdd120a":"markdown","451effdb":"markdown","3c9c877c":"markdown","4e8dc590":"markdown","000a39cb":"markdown","2a890480":"markdown","cfd8b246":"markdown","d1a0232c":"markdown","8619a167":"markdown","6466bdd9":"markdown","0096c8e0":"markdown","7836f8c9":"markdown","4f2d7c1b":"markdown","af804749":"markdown","5c635cc5":"markdown","52505fba":"markdown","5f31a745":"markdown","a09e50e7":"markdown","133c8f02":"markdown","1bb9cb1f":"markdown","18afc31d":"markdown","3a26959e":"markdown","ad3bb34e":"markdown","c2a836bc":"markdown","ede89c87":"markdown","f297b3c3":"markdown","d8fe266a":"markdown","6fcf6f34":"markdown","a0d7a3bb":"markdown","ee8a9b50":"markdown","0623132b":"markdown","e9c470f1":"markdown","06f7d27b":"markdown","7af39e83":"markdown","807f6b92":"markdown","c835b758":"markdown","7d2d8fa1":"markdown","4ef3beb5":"markdown","649f5e4a":"markdown","20778087":"markdown","5933ee37":"markdown","f006ac2a":"markdown"},"source":{"10c2ce3b":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns \nimport warnings\nwarnings.filterwarnings(\"ignore\")","5df163d0":"train = pd.read_csv('..\/input\/pubg-finish-placement-prediction\/train_V2.csv')","ca0b0e15":"train.info()","f5009cd1":"train.head()","2b911209":"print(\"The average person kills {:.4f} players, 99% of people have {} kills or less, while the most kills ever recorded is {}.\".format(train['kills'].mean(),train['kills'].quantile(0.99), train['kills'].max()))","820c6466":"data = train.copy()\ndata.loc[data['kills'] > data['kills'].quantile(0.99)] = '8+'\nplt.figure(figsize=(15,10))\nsns.countplot(data['kills'].astype('str').sort_values())\nplt.title(\"Kill Count\",fontsize=15)\nplt.show()","64f16b88":"data = train.copy()\ndata = data[data['kills']==0]\nplt.figure(figsize=(15,10))\nplt.title(\"Damage Dealt by 0 killers\",fontsize=15)\nsns.distplot(data['damageDealt'])\nplt.show()","5b506aac":"print(\"{} players ({:.4f}%) have won without a single kill!\".format(len(data[data['winPlacePerc']==1]), 100*len(data[data['winPlacePerc']==1])\/len(train)))\n\ndata1 = train[train['damageDealt'] == 0].copy()\nprint(\"{} players ({:.4f}%) have won without dealing damage!\".format(len(data1[data1['winPlacePerc']==1]), 100*len(data1[data1['winPlacePerc']==1])\/len(train)))","982fae19":"sns.jointplot(x=\"winPlacePerc\", y=\"kills\", data=train, height=10, ratio=3, color=\"r\")\nplt.show()","45fe1a1c":"kills = train.copy()\n\nkills['killsCategories'] = pd.cut(kills['kills'], [-1, 0, 2, 5, 10, 60], labels=['0_kills','1-2_kills', '3-5_kills', '6-10_kills', '10+_kills'])\n\nplt.figure(figsize=(15,8))\nsns.boxplot(x=\"killsCategories\", y=\"winPlacePerc\", data=kills)\nplt.show()","676c33cb":"print(\"The average person walks for {:.1f}m, 99% of people have walked {}m or less, while the marathoner champion walked for {}m.\".format(train['walkDistance'].mean(), train['walkDistance'].quantile(0.99), train['walkDistance'].max()))","4c288279":"data = train.copy()\ndata = data[data['walkDistance'] < train['walkDistance'].quantile(0.99)]\nplt.figure(figsize=(15,10))\nplt.title(\"Walking Distance Distribution\",fontsize=15)\nsns.distplot(data['walkDistance'])\nplt.show()","5cf5aac1":"print(\"{} players ({:.4f}%) walked 0 meters. This means that they die before even taking a step or they are afk (more possible).\".format(len(data[data['walkDistance'] == 0]), 100*len(data1[data1['walkDistance']==0])\/len(train)))","8460384a":"sns.jointplot(x=\"winPlacePerc\", y=\"walkDistance\",  data=train, height=10, ratio=3, color=\"lime\")\nplt.show()","98d768ff":"print(\"The average person drives for {:.1f}m, 99% of people have drived {}m or less, while the formula 1 champion drived for {}m.\".format(train['rideDistance'].mean(), train['rideDistance'].quantile(0.99), train['rideDistance'].max()))","9135be2b":"data = train.copy()\ndata = data[data['rideDistance'] < train['rideDistance'].quantile(0.9)]\nplt.figure(figsize=(15,10))\nplt.title(\"Ride Distance Distribution\",fontsize=15)\nsns.distplot(data['rideDistance'])\nplt.show()","20bae892":"print(\"{} players ({:.4f}%) drived for 0 meters. This means that they don't have a driving licence yet.\".format(len(data[data['rideDistance'] == 0]), 100*len(data1[data1['rideDistance']==0])\/len(train)))","f3fd34d5":"sns.jointplot(x=\"winPlacePerc\", y=\"rideDistance\", data=train, height=10, ratio=3, color=\"y\")\nplt.show()","aa8ed652":"f,ax1 = plt.subplots(figsize =(20,10))\nsns.pointplot(x='vehicleDestroys',y='winPlacePerc',data=data,color='#606060',alpha=0.8)\nplt.xlabel('Number of Vehicle Destroys',fontsize = 15,color='blue')\nplt.ylabel('Win Percentage',fontsize = 15,color='blue')\nplt.title('Vehicle Destroys\/ Win Ratio',fontsize = 20,color='blue')\nplt.grid()\nplt.show()","a9c357a4":"print(\"The average person swims for {:.1f}m, 99% of people have swimemd {}m or less, while the olympic champion swimmed for {}m.\".format(train['swimDistance'].mean(), train['swimDistance'].quantile(0.99), train['swimDistance'].max()))","3d66d3b0":"data = train.copy()\ndata = data[data['swimDistance'] < train['swimDistance'].quantile(0.95)]\nplt.figure(figsize=(15,10))\nplt.title(\"Swim Distance Distribution\",fontsize=15)\nsns.distplot(data['swimDistance'])\nplt.show()","e2f123c9":"swim = train.copy()\n\nswim['swimDistance'] = pd.cut(swim['swimDistance'], [-1, 0, 5, 20, 5286], labels=['0m','1-5m', '6-20m', '20m+'])\n\nplt.figure(figsize=(15,8))\nsns.boxplot(x=\"swimDistance\", y=\"winPlacePerc\", data=swim)\nplt.show()","0d0fe57a":"print(\"The average person uses {:.1f} heal items, 99% of people use {} or less, while the doctor used {}.\".format(train['heals'].mean(), train['heals'].quantile(0.99), train['heals'].max()))\nprint(\"The average person uses {:.1f} boost items, 99% of people use {} or less, while the doctor used {}.\".format(train['boosts'].mean(), train['boosts'].quantile(0.99), train['boosts'].max()))","9e0d91ed":"data = train.copy()\ndata = data[data['heals'] < data['heals'].quantile(0.99)]\ndata = data[data['boosts'] < data['boosts'].quantile(0.99)]\n\nf,ax1 = plt.subplots(figsize =(20,10))\nsns.pointplot(x='heals',y='winPlacePerc',data=data,color='lime',alpha=0.8)\nsns.pointplot(x='boosts',y='winPlacePerc',data=data,color='blue',alpha=0.8)\nplt.text(4,0.6,'Heals',color='lime',fontsize = 17,style = 'italic')\nplt.text(4,0.55,'Boosts',color='blue',fontsize = 17,style = 'italic')\nplt.xlabel('Number of heal\/boost items',fontsize = 15,color='blue')\nplt.ylabel('Win Percentage',fontsize = 15,color='blue')\nplt.title('Heals vs Boosts',fontsize = 20,color='blue')\nplt.grid()\nplt.show()","f88cd298":"sns.jointplot(x=\"winPlacePerc\", y=\"heals\", data=train, height=10, ratio=3, color=\"lime\")\nplt.show()","f6592b87":"sns.jointplot(x=\"winPlacePerc\", y=\"boosts\", data=train, height=10, ratio=3, color=\"blue\")\nplt.show()","9252d973":"solos = train[train['numGroups']>50]\nduos = train[(train['numGroups']>25) & (train['numGroups']<=50)]\nsquads = train[train['numGroups']<=25]\nprint(\"There are {} ({:.2f}%) solo games, {} ({:.2f}%) duo games and {} ({:.2f}%) squad games.\".format(len(solos), 100*len(solos)\/len(train), len(duos), 100*len(duos)\/len(train), len(squads), 100*len(squads)\/len(train),))","b84c5030":"f,ax1 = plt.subplots(figsize =(20,10))\nsns.pointplot(x='kills',y='winPlacePerc',data=solos,color='black',alpha=0.8)\nsns.pointplot(x='kills',y='winPlacePerc',data=duos,color='#CC0000',alpha=0.8)\nsns.pointplot(x='kills',y='winPlacePerc',data=squads,color='#3399FF',alpha=0.8)\nplt.text(37,0.6,'Solos',color='black',fontsize = 17,style = 'italic')\nplt.text(37,0.55,'Duos',color='#CC0000',fontsize = 17,style = 'italic')\nplt.text(37,0.5,'Squads',color='#3399FF',fontsize = 17,style = 'italic')\nplt.xlabel('Number of kills',fontsize = 15,color='blue')\nplt.ylabel('Win Percentage',fontsize = 15,color='blue')\nplt.title('Solo vs Duo vs Squad Kills',fontsize = 20,color='blue')\nplt.grid()\nplt.show()","270ae6fd":"f,ax1 = plt.subplots(figsize =(20,10))\nsns.pointplot(x='DBNOs',y='winPlacePerc',data=duos,color='#CC0000',alpha=0.8)\nsns.pointplot(x='DBNOs',y='winPlacePerc',data=squads,color='#3399FF',alpha=0.8)\nsns.pointplot(x='assists',y='winPlacePerc',data=duos,color='#FF6666',alpha=0.8)\nsns.pointplot(x='assists',y='winPlacePerc',data=squads,color='#CCE5FF',alpha=0.8)\nsns.pointplot(x='revives',y='winPlacePerc',data=duos,color='#660000',alpha=0.8)\nsns.pointplot(x='revives',y='winPlacePerc',data=squads,color='#000066',alpha=0.8)\nplt.text(14,0.5,'Duos - Assists',color='#FF6666',fontsize = 17,style = 'italic')\nplt.text(14,0.45,'Duos - DBNOs',color='#CC0000',fontsize = 17,style = 'italic')\nplt.text(14,0.4,'Duos - Revives',color='#660000',fontsize = 17,style = 'italic')\nplt.text(14,0.35,'Squads - Assists',color='#CCE5FF',fontsize = 17,style = 'italic')\nplt.text(14,0.3,'Squads - DBNOs',color='#3399FF',fontsize = 17,style = 'italic')\nplt.text(14,0.25,'Squads - Revives',color='#000066',fontsize = 17,style = 'italic')\nplt.xlabel('Number of DBNOs\/Assits\/Revives',fontsize = 15,color='blue')\nplt.ylabel('Win Percentage',fontsize = 15,color='blue')\nplt.title('Duo vs Squad DBNOs, Assists, and Revives',fontsize = 20,color='blue')\nplt.grid()\nplt.show()","848c5a69":"f,ax = plt.subplots(figsize=(15, 15))\nsns.heatmap(train.corr(), annot=True, linewidths=.5, fmt= '.1f',ax=ax)\nplt.show()","229530a1":"k = 5 #number of variables for heatmap\nf,ax = plt.subplots(figsize=(11, 11))\ncols = train.corr().nlargest(k, 'winPlacePerc')['winPlacePerc'].index\ncm = np.corrcoef(train[cols].values.T)\nsns.set(font_scale=1.25)\nhm = sns.heatmap(cm, cbar=True, annot=True, square=True, fmt='.2f', annot_kws={'size': 10}, yticklabels=cols.values, xticklabels=cols.values)\nplt.show()","f409d4eb":"sns.set()\ncols = ['winPlacePerc', 'walkDistance', 'boosts', 'weaponsAcquired', 'damageDealt', 'killPlace']\nsns.pairplot(train[cols], size = 2.5)\nplt.show()","93d0c436":"train['playersJoined'] = train.groupby('matchId')['matchId'].transform('count')","d54c608e":"data = train.copy()\ndata = data[data['playersJoined']>49]\nplt.figure(figsize=(15,10))\nsns.countplot(data['playersJoined'])\nplt.title(\"Players Joined\",fontsize=15)\nplt.show()","a0fc593f":"train['killsNorm'] = train['kills']*((100-train['playersJoined'])\/100 + 1)\ntrain['damageDealtNorm'] = train['damageDealt']*((100-train['playersJoined'])\/100 + 1)\ntrain[['playersJoined', 'kills', 'killsNorm', 'damageDealt', 'damageDealtNorm']][5:8]","856a4aab":"train['healsAndBoosts'] = train['heals']+train['boosts']\ntrain['totalDistance'] = train['walkDistance']+train['rideDistance']+train['swimDistance']","388b9cb5":"train['boostsPerWalkDistance'] = train['boosts']\/(train['walkDistance']+1) #The +1 is to avoid infinity, because there are entries where boosts>0 and walkDistance=0. Strange.\ntrain['boostsPerWalkDistance'].fillna(0, inplace=True)\ntrain['healsPerWalkDistance'] = train['heals']\/(train['walkDistance']+1) #The +1 is to avoid infinity, because there are entries where heals>0 and walkDistance=0. Strange.\ntrain['healsPerWalkDistance'].fillna(0, inplace=True)\ntrain['healsAndBoostsPerWalkDistance'] = train['healsAndBoosts']\/(train['walkDistance']+1) #The +1 is to avoid infinity.\ntrain['healsAndBoostsPerWalkDistance'].fillna(0, inplace=True)\ntrain[['walkDistance', 'boosts', 'boostsPerWalkDistance' ,'heals',  'healsPerWalkDistance', 'healsAndBoosts', 'healsAndBoostsPerWalkDistance']][40:45]","77033052":"train['killsPerWalkDistance'] = train['kills']\/(train['walkDistance']+1) #The +1 is to avoid infinity, because there are entries where kills>0 and walkDistance=0. Strange.\ntrain['killsPerWalkDistance'].fillna(0, inplace=True)\ntrain[['kills', 'walkDistance', 'rideDistance', 'killsPerWalkDistance', 'winPlacePerc']].sort_values(by='killsPerWalkDistance').tail(10)","ab6148fc":"train['team'] = [1 if i>50 else 2 if (i>25 & i<=50) else 4 for i in train['numGroups']]","eee7fe7a":"train.head()\nsub.to_csv('result_submission.csv',index-False)","43683a9f":"<img src=\"https:\/\/i.ytimg.com\/vi\/tQxzsE0DijQ\/maxresdefault.jpg\" alt=\"The Swimmers\" style=\"width: 700px;\"\/>","70a06809":"Plot win placement percentage vs kills.","2fdd120a":"So we created 10 features. I hope some of them to be useful.","451effdb":"## Pearson correlation between variables","3c9c877c":"Most people can't make a single kill. At least do they do damage?","4e8dc590":"In every plot, there is an abnormal behavior when values are 0.","000a39cb":"### Thank you if you reached this point! This is my first kernel ever. An upvote would be really appreciated and help me keep going!\n\n### In progress.. ","2a890480":"A game in PUBG can have up to 100 players fighting each other. But most of the times a game isn't \"full\". There is no variable that gives us the number of players joined. So lets create one.","cfd8b246":"## Solos, Duos and Squads","d1a0232c":"There is a small correlation between rideDistance and winPlacePerc.","8619a167":"## The Drivers","6466bdd9":"Apparently walking has a high correlation with winPlacePerc.","0096c8e0":"## The Swimmers","7836f8c9":"Hmm, very interesting. Solos and duos behave the same, but when playing squads kills don't matter that much.","4f2d7c1b":"Apparentrly killing has a correlation with winning. Finally let's group players based on kills (0 kills, 1-2 kills, 3-5 kills, 6-10 kills and 10+ kills).","af804749":"Same, let's create the feature \"killsPerWalkDistance\".","5c635cc5":"<img src=\"https:\/\/steemitimages.com\/DQmRmYLRxu1vUhVtnFAA6bHFbShtr7Wdv1wLrPjdxbRZsjc\/maxresdefault%20(2).jpg\" alt=\"The Runners\" style=\"width: 700px;\"\/>","52505fba":"Almost no one swims. Let's group the swimming distances in 4 categories and plot vs winPlacePerc.","5f31a745":"Another simple feature is the sum of heals and boosts. Also the sum of total distance travelled.","a09e50e7":"## EDA for the popular battle royale game PUBG","133c8f02":"My experience was correct. Destroying a single vehicle increases your chances of winning!","1bb9cb1f":"<img src=\"https:\/\/i.ytimg.com\/vi\/xfI9XljX51k\/maxresdefault.jpg\" alt=\"The Healers\" style=\"width: 700px;\"\/>","18afc31d":"The attribute DBNOs means enemy players knocked. A \"knock\" can happen only in duos or squads, because the teammates have the chance to \"revive\" the knocked player in a given time. So a knocked player can be revived or die. If he is revived, the next time he will be knocked, his teammates will have less time to revive him.\n\nThe attribute assist can also happen only in duos or squads. It generally means that the player had an involvement in a kill.\n\nThe attribute revive also happens in duos or squads.","3a26959e":"<img src=\"http:\/\/cdn.gamer-network.net\/2018\/metabomb\/pubghowtodrivecarsandbikes.jpg\" alt=\"The Drivers\" style=\"width: 700px;\"\/>","ad3bb34e":"In terms of the target variable (winPlacePerc), there are a few variables high medium to high correlation. The highest positive correlation is walkDistance and the highest negative the killPlace.\n\n**Let's zoom to the top-5 most positive correlated variables with the target.**","c2a836bc":"## The Healers","ede89c87":"## Feature Engineering","f297b3c3":"When using boosting items you run faster. They also help staying out of the zone (PUBG term) and loot more (meaning walking more). So lets create a feature boosts per walking distance. Heals don't make you run faster, but they also help staying out of the zone and loot more. So lets create the same feature for heals also.","d8fe266a":"Earlier in the kernel we did EDA for Solos, Duos and Squads. Lets create a column for them.","6fcf6f34":"- **groupId** - Integer ID to identify a group within a match. If the same group of players plays in different matches, they will have a different groupId each time.\n- **matchId** - Integer ID to identify match. There are no matches that are in both the training and testing set.\n- **assists** - Number of enemy players this player damaged that were killed by teammates.\n- **boosts** - Number of boost items used.\n- **damageDealt** - Total damage dealt. Note: Self inflicted damage is subtracted.\n- **DBNOs** - Number of enemy players knocked.\n- **headshotKills** - Number of enemy players killed with headshots.\n- **heals** - Number of healing items used.\n- **killPlace** - Ranking in match of number of enemy players killed.\n- **killPoints** - Kills-based external ranking of player. (Think of this as an Elo ranking where only kills matter.)\n- **kills** - Number of enemy players killed.\n- **killStreaks** - Max number of enemy players killed in a short amount of time.\n- **longestKill** - Longest distance between player and player killed at time of death. This may be misleading, as downing a - player and driving away may lead to a large longestKill stat.\n- **maxPlace** - Worst placement we have data for in the match. This may not match with numGroups, as sometimes the data skips over placements.\n- **numGroups** - Number of groups we have data for in the match.\n- **revives** - Number of times this player revived teammates.\n- **rideDistance** - Total distance traveled in vehicles measured in meters.\n- **roadKills** - Number of kills while in a vehicle.\n- **swimDistance** - Total distance traveled by swimming measured in meters.\n- **teamKills** - Number of times this player killed a teammate.\n- **vehicleDestroys** - Number of vehicles destroyed.\n- **walkDistance** - Total distance traveled on foot measured in meters.\n- **weaponsAcquired** - Number of weapons picked up.\n- **winPoints** - Win-based external ranking of player. (Think of this as an Elo ranking where only winning matters.)\n- **winPlacePerc** - The target of prediction. This is a percentile winning placement, where 1 corresponds to 1st place, and 0 corresponds to last place in the match. It is calculated off of maxPlace, not numGroups, so it is possible to have missing chunks in a match.","a0d7a3bb":"<img src=\"https:\/\/pmcvariety.files.wordpress.com\/2018\/04\/pubg.jpg?w=1000&h=563&crop=1\" alt=\"PUBG\" style=\"width: 750px;\"\/>\n\nThis kernel features:\n- [The Killers](#The-Killers)\n- [The Runners](#The-Runners)\n- [The Drivers](#The-Drivers)\n- [The Swimmers](#The-Swimmers)\n- [The Healers](#The-Healers)\n- [Solos, Duos and Squads](#Solos,-Duos-and-Squads)\n- [Correlation](#Pearson-correlation-between-variables)\n- [Feature Engineering](#Feature-Engineering)","ee8a9b50":"So healing and boosting, definitely are correlated with winPlacePerc. Boosting is more.","0623132b":"Let's plot the kill counts.","e9c470f1":"## The Killers","06f7d27b":"Well, most of them don't. Let's investigate the exceptions.","7af39e83":"0 walking distance and many kills? Also most have winPlacePerc=1. Definitelly cheaters.","807f6b92":"Destroying a vehicle in my experience shows that a player has skills. Let's check it.","c835b758":"Ok, now that we have a glimpse of the data, let's explore them.","7d2d8fa1":"Let's plot the above variables and the killPlace variable as pairs.","4ef3beb5":"## The Runners","649f5e4a":"<img src=\"https:\/\/i.ytimg.com\/vi\/rnAeX795Jn0\/maxresdefault.jpg\" alt=\"The Killers\" style=\"width: 700px;\"\/>","20778087":"Based on the \"playersJoined\" feature we can create (or change) a lot of others to normalize their values. For example i will create the \"killsNorm\" and \"damageDealtNorm\" features. When there are 100 players in the game it might be easier to find and kill someone, than when there are 90 players. So i will normalize the kills in a way that a kill in 100 players will score 1 (as it is) and in 90 players it will score (100-90)\/100 + 1 = 1.1. This is just an assumption. You can use different scales.","5933ee37":"There are 3 game modes in the game. One can play solo, or with a friend (duo), or with 3 other friends (squad). 100 players join the same server, so in the case of duos the max teams are 50 and in the case of squads the max teams are 25. ","f006ac2a":"It seems that if you swim, you rise to the top. In PUBG there are currently 3 maps. One of them has almost no water. Keep that in mind. I might plan on doing analysis to find out in which map a match is played."}}