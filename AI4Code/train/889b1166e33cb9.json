{"cell_type":{"b60230e5":"code","34ddf34a":"code","aca0b720":"code","9fe24fb4":"code","6b139321":"code","0b79340d":"code","fbf9b4d0":"code","92e7eb33":"code","6d6419c9":"code","bf49f7f8":"code","58e49008":"code","a422f13d":"code","d6862423":"code","5617556b":"code","b474ac60":"code","0a1eeb29":"code","2294ba0e":"code","10099945":"code","1120fcbc":"code","42ec6eb1":"code","e03dce7c":"code","0414b8ad":"code","959578d2":"code","6d0df053":"code","9cf62b17":"code","ad6eb283":"code","d29124ad":"code","87521a04":"code","af1e572c":"code","fd9eeb73":"code","795abcec":"code","a0da5ee8":"code","486cfc6c":"code","502f2a0b":"code","96dd29e1":"markdown","f311f5c9":"markdown","0321f14f":"markdown","5e585f0a":"markdown","e6f130dd":"markdown","decda60a":"markdown","354e0313":"markdown","89068c12":"markdown","78998b3b":"markdown","488bdbfa":"markdown","45e4d85b":"markdown","97edc294":"markdown","9f849784":"markdown","a37019e0":"markdown","f8ed39a9":"markdown","a10af699":"markdown","945b191e":"markdown","6ad9cf72":"markdown","dd8da507":"markdown","64cb17de":"markdown","c87cd19c":"markdown","e8e2578a":"markdown","8b35094c":"markdown","1921fc7a":"markdown","a128aa92":"markdown","d932c24c":"markdown","74db9bed":"markdown","034675de":"markdown"},"source":{"b60230e5":"\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n","34ddf34a":"28 * 28","aca0b720":"import cv2\nimport numpy as np\nimport pandas as pd\n\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nfrom sklearn import svm\nfrom sklearn.model_selection import train_test_split","9fe24fb4":"data = pd.read_csv('\/kaggle\/input\/d\/aggarwalrahul\/dl-intro-to-nn\/dataset.csv')    # Load the dataset by providing the path to the file.","6b139321":"data","0b79340d":"data.shape","fbf9b4d0":"# The labels for images.\ny = data[\"label\"]","92e7eb33":"print(y[0])               # Label for 1st image.\nprint(y[2000])            # Label for 2001st image.","6d6419c9":"# Drop 'label' column.\nX = data.drop(labels = [\"label\"], axis = 1)","bf49f7f8":"type(X)","58e49008":"print(y[0])               # Label for 1st image.\nprint(y[2000])            # Label for 2001st image.","a422f13d":"i=20\nimg = X.iloc[i].values\nimg = img.reshape((28,28))\nplt.imshow(img, cmap='gray')\nplt.title(y[i]);","d6862423":"y.value_counts()","5617556b":"g = sns.countplot(x=y);","b474ac60":"# Check the data\nX.isnull().sum()","0a1eeb29":"# Normalize the data\nX = X.astype('float32') \/ 255.0","2294ba0e":"X = X.values # Convert the features (pixel values) to numpy array to feed into the supervised learning model.\ny = y.values # Convert the labels to numpy array to feed into the supervised learning model.","10099945":"# Split data into test and train to build the model.\nX_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.75, random_state=0)","1120fcbc":"type(X_train) # As we can see that the data to be fed into model is of the type numpy array.","42ec6eb1":"i=200\nimg = X[i]\nimg = img.reshape((28,28))\nplt.imshow(img, cmap='gray')\nplt.title(y[i]);","e03dce7c":"plt.figure(figsize=(10,7))\n\nn, bins, patches = plt.hist(X[9], bins=10, range=(0.0, 1.0))\nplt.xlabel('Pixel value')\nplt.ylabel('Number of Pixels')\nplt.title('Histogram of Pixel values')\nplt.show();","0414b8ad":"from sklearn.ensemble import RandomForestClassifier","959578d2":"?RandomForestClassifier","6d0df053":"# random forest model creation\nclf = RandomForestClassifier(random_state=190,verbose=False,n_estimators=201,n_jobs=8,max_depth=8)","9cf62b17":"clf.fit(X_train, y_train)","ad6eb283":"train_pred_cl=clf.predict(X_test)\ntrain_pred_cl","d29124ad":"clf.score(X_train, y_train)","87521a04":"clf.score(X_test, y_test)","af1e572c":"y_pred = clf.predict(X_test)\ny_pred","fd9eeb73":"i=0\nimg = X_test[i]\nimg = img.reshape((28,28))\nplt.imshow(img, cmap='gray')\nplt.title(y_pred[i]);","795abcec":"from sklearn.metrics import classification_report, confusion_matrix","a0da5ee8":"print(\"=== Confusion Matrix ===\")\ncm = confusion_matrix(y_test, y_pred)\nprint(cm)","486cfc6c":"df_cm = pd.DataFrame(cm, index = [i for i in \"0123456789\"],\n                     columns = [i for i in \"0123456789\"])\nplt.figure(figsize = (10,7))\nsns.heatmap(df_cm, annot=True, fmt='d');","502f2a0b":"print(\"=== Classification Report ===\")\nprint(classification_report(y_test, y_pred))","96dd29e1":"## Please Note:\nNEVER loop through a numpy array or pandas df! Use vectorized operations instead!\nhttps:\/\/www.pythonlikeyoumeanit.com\/Module3_IntroducingNumpy\/VectorizedOperations.html","f311f5c9":"### 3. Check for Null and Missing Values","0321f14f":"### 5. Train and Test Split","5e585f0a":"* In the original data, the pixel values were in a 1-Dimensional array.\n* We converted that 1-D array of 784 pixel values into an 2-D array of shape (28 X 28).\n* Note that 28 multiplied by 28 is equal to 784.\n* As each pixel value represents dark or white spot, when we plot the 28x28 pixel's array, we get the above image.\n* So, it validates the fact that image can be represented by an numpy array.\n* Each value of the above numpy array represents a pixel, which has value between 0 and 255.","e6f130dd":"* From above histogram, we can see that the there are more number of pixels which have value equal to zero. \n* Zero value represents black pixel.\n* From the image we saw before, we observed that the black portion of image was more than the white portion.\n* It confirms that white pixel is represented by value equal to 1.","decda60a":"### 4. Normalization [Depends upon the Algorithm]\n* We perform a grayscale normalization to reduce the effect of illumination's differences.\n\n* https:\/\/machinelearningmastery.com\/how-to-manually-scale-image-pixel-data-for-deep-learning\/","354e0313":"## Think about it:\n\nDo we know, how the data distribution looks like across all the numbers?\n\ni.e. We need to know the images corresponding to each number.","89068c12":"### 8. Training our model\n- First, we use the sklearn.ensemble module to create a **random forest classifier**.\n- Next, we pass our training images and labels to the classifier's fit method, which trains our model.\n- Finally, the test images and labels are passed to the score method to see how well we trained our model. Score will return a float between 0-1 indicating our accuracy on the test data set\n\n* Try playing with the parameters of RandomForestClassifier() to see how the results change.","78998b3b":"# <center> Case Study on Image Classification:","488bdbfa":"## Think about it:\n\n- What does the height = 641 mean?\nSimilarly other height values in the result.\n- The width is same for all = 0.1","45e4d85b":"# Problem:\n- Classify the image based on the pixel value.\n- The result of the model should be the number which is represented by the pixel values.\n- Use Supervised Learning method for it.","97edc294":"----------------------------------------------------","9f849784":"### 2. Data Preparation\n\n**Add on:**\n\nWhat should we do to prepare the data according to the model input?\n\nLet's see in the next steps.","a37019e0":"### So, we got a pretty good accuracy on classification of the images of digits, as the classification report shows.\n\n# Session Summary\n- The images can be represented using numpy array.\n- If the array is 1-D, then we can visualize the image after reshaping the array to suitable shape. In this case we converted it to 2-D array.\n- We visualized the image by plotting the numpy array using matplotlib.\n- After that we saw that the pixel values' distribution in histogram, the black pixel's value is zero, and the white pixel's value is 1. These values are after normalization of pixel values, i.e. after dividing each value by 255.\n- We used RandomForestClassifier as supervised classification method.","f8ed39a9":"### 6. Viewing an Image\n- Since the image is currently one-dimension, we load it into a numpy array and reshape it so that it is two-dimensional (28x28 pixels)\n- Then, we plot the image and label with matplotlib\n\n* You can change the value of variable i to check out other images and labels.","a10af699":" How did our model do?\n- You should have gotten around 0.9376, or **93.76% accuracy**. This is good.","945b191e":"### 7. Examining the Pixel Values:\n- Note that these images aren't actually black and white (0,1). They are gray-scale (0-255).\n- A histogram of this image's pixel values shows the range.","6ad9cf72":"## Think about it:\n\nWhy did we drop the labels from the data and saved it into new variable \"X\"?","dd8da507":"**Insights** So, we got a pretty good accuracy on classification of the images of digits, as the classification report shows.","64cb17de":"## Add-on:\n- What is `X[i]`'s shape?\n- How to reshape the whole array instead of just one row?\n- What's the shape of the reshaped array?","c87cd19c":"Let's see some of the labels.","e8e2578a":"**Insights** We checked for corrupted images (missing values inside) - There are no missing values in the dataset. So we can safely go ahead.","8b35094c":"**Insight -** We can see from the above plot that the data is evenly distributed among all the classes (from 0, 1, 2, ..., 8, 9). So, the dataset is perfectly balanced.","1921fc7a":"#### We can get a better sense for one of these examples by visualising the image and looking at the label.","a128aa92":"\n# Context:\n- We are given a **dataset** which contains image data. \n- The data contains **pixel values** of the images in csv format. \n- Each image represents one of the number from 0, 1, 2, ..., 8, 9. So there are 10 possible outcomes for each row of data. As the data contains the pixel values of the image in each row. \n- Each image is 28 pixels in height and 28 pixels in width, for a total of 784 pixels in total. \n- Each pixel has a single pixel-value associated with it, indicating the lightness or darkness of that pixel, with higher numbers meaning lighter shade. \n- This pixel-value is an integer between 0 and 255, inclusive.\n- The data set has 785 columns. \n- The first column, called \"label\", is the digit which is in the image. \n- *The* rest of the columns contain the pixel-values of the associated image.","d932c24c":"## Think about it:\n\n- What should be our next step while understanding about the images?","74db9bed":"## 1. Loading the data\n- We use panda's read_csv to read train.csv into a dataframe.\n- Then we separate our images and labels for supervised learning.\n- We also do a train_test_split to break our data into two sets, one for training and one for testing. This let's us measure how well our model was trained by later inputting some known test data.","034675de":"# Data:\n- **label:** A value between 0 and 9. Both inclusive. Total 10 unique values.\n- **pixel0, pixel1, pixel2, ..., pixel782, pixel783:** Each value in these columns is between 0 and 255. Which represents the pixel intensity. "}}