{"cell_type":{"3aac6fcc":"code","37fe77ee":"code","84cbbe70":"code","4d2787d2":"code","75dff22d":"code","0fc05674":"code","b9d333b6":"code","a7c687a0":"code","7b272936":"code","5a3afe64":"code","85df855c":"code","dc7ca2f1":"code","4037c4ed":"code","9e7eb83f":"code","a1d01b6b":"code","98190470":"code","f1814018":"code","33aa46d3":"code","aaec3cb0":"code","62907689":"code","18bd8e45":"code","95c18339":"code","5644ed8b":"code","e4b8497a":"markdown","b8045e1f":"markdown","f1e4c02c":"markdown","882c45af":"markdown","4c4d6b8e":"markdown","b77d65c2":"markdown","22d6f752":"markdown","255983d7":"markdown"},"source":{"3aac6fcc":"import os\nimport time\nfrom pathlib import Path\n\nimport pandas as pd\nimport numpy as np\n\nfrom sklearn.model_selection import train_test_split\nimport matplotlib.pylab as plt\nimport seaborn as sns\n\nplt.style.use(\"ggplot\")","37fe77ee":"train_df = pd.read_csv(\"..\/input\/central-nj-data-science-meetup\/cars-train.csv\")\nvalid_df = pd.read_csv(\"..\/input\/central-nj-data-science-meetup\/cars-test.csv\")\ntest_df = pd.read_csv(\"..\/input\/central-nj-data-science-meetup\/cars-final-prediction.csv\")\n\n\nsample_submission = pd.read_csv(\"..\/input\/central-nj-data-science-meetup\/cars-sample-submission.csv\")","84cbbe70":"train_df.columns","4d2787d2":"train_df.head()","75dff22d":"train_df['doors'].value_counts()","0fc05674":"train_df['persons'].value_counts()","b9d333b6":"train_df['class'].value_counts()","a7c687a0":"ax = train_df['class'].value_counts().plot(kind='bar')\nax.set_title(\"Class Target Frequency\")\nplt.show()","7b272936":"train_df.info()","5a3afe64":"train_df.isna().sum()","85df855c":"y = train_df['class']\nX = train_df.iloc[:,:-1]\n","dc7ca2f1":"X.head()","4037c4ed":"cat_features = X.select_dtypes(include = \"object\").columns\nprint (cat_features)","9e7eb83f":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\nX = X[cat_features].apply(le.fit_transform)\nX_test = test_df[cat_features].apply(le.fit_transform)\n#X = le.fit_transform(X[cat_features])","a1d01b6b":"X.head()","98190470":"from sklearn import tree\n\nclf = tree.DecisionTreeClassifier(random_state=42)\n\nclf = clf.fit(X, y)","f1814018":"from sklearn.tree import export_text\n\n#tree_rules = export_text(clf, feature_names=cat_features)\ntree_rules = export_text(clf)\n\n\nprint(tree_rules)","33aa46d3":"from sklearn import tree\n#tree.plot_tree(clf)\nplt.figure(figsize=(12,8),dpi=150)\ntree.plot_tree(clf,filled=True,feature_names=X.columns)\nplt.show()","aaec3cb0":"import graphviz\ndot_data = tree.export_graphviz(clf, out_file=None,\n                                feature_names=X.columns,\n                                class_names=train_df['class'],\n                               filled=True, rounded=True,  \n                      special_characters=True) \ngraph = graphviz.Source(dot_data) \ngraph.render(\"auto\") ","62907689":"preds = clf.predict(X_test)\npreds","18bd8e45":"X_test.shape, preds.shape, sample_submission.shape","95c18339":"sample_submission['class'] = preds","5644ed8b":"sample_submission.to_csv(\"submission.csv\", index=False)\nsample_submission","e4b8497a":"<div style=\"background-color:rgba(65, 128, 179, 0.6);border-radius:5px;display:fill\">\n    <h1 style=\"text-align: center;padding: 12px 0px 12px 0px;\">Central NJ Data Science Competition<\/h1>\n<\/div>\n\n## Kaggle Resources Used to Develop this Notebook\n\n- [Random Forest Classifier Tutorial](https:\/\/www.kaggle.com\/prashant111\/random-forest-classifier-tutorial)\n- [Decision_Trees (Titanic)](https:\/\/www.kaggle.com\/rezvanrah\/decision-trees-titanic)","b8045e1f":"<div style=\"background-color:rgba(65, 128, 179, 0.6);border-radius:5px;display:fill\">\n    <h1 style=\"text-align: center;padding: 12px 0px 12px 0px;\">Submission<\/h1>\n<\/div>","f1e4c02c":"# Target Frequency","882c45af":"Label Encode","4c4d6b8e":"<div style=\"background-color:rgba(65, 128, 179, 0.6);border-radius:5px;display:fill\">\n    <h1 style=\"text-align: center;padding: 12px 0px 12px 0px;\">Check for Missing Data<\/h1>\n<\/div>","b77d65c2":"<div style=\"background-color:rgba(65, 128, 179, 0.6);border-radius:5px;display:fill\">\n    <h1 style=\"text-align: center;padding: 12px 0px 12px 0px;\">Explore the Data<\/h1>\n<\/div>","22d6f752":"<div style=\"background-color:rgba(65, 128, 179, 0.6);border-radius:5px;display:fill\">\n    <h1 style=\"text-align: center;padding: 12px 0px 12px 0px;\">Import Libraries<\/h1>\n<\/div>","255983d7":"<div style=\"background-color:rgba(65, 128, 179, 0.6);border-radius:5px;display:fill\">\n    <h1 style=\"text-align: center;padding: 12px 0px 12px 0px;\">Load Train\/Test Data<\/h1>\n<\/div>"}}