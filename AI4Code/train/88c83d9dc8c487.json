{"cell_type":{"39d841e2":"code","6201e0b4":"code","f703c14a":"code","3854611e":"code","ca08236a":"code","686514cf":"code","b1b4671f":"code","7357f3a0":"code","4c54a533":"code","af77d55f":"code","e16af58d":"code","11966ffa":"code","1cddd217":"code","fab03b10":"code","59315563":"code","dda2059c":"code","ab01ef24":"code","edb1aeb7":"code","fab1a404":"code","9c154f0d":"code","9851ed23":"code","48b5996e":"code","0330576d":"markdown","ad8102f9":"markdown","98767a63":"markdown","72fe5079":"markdown","1d4def88":"markdown","0ad4e1b7":"markdown","01265e18":"markdown","6fa32ca6":"markdown","45005cec":"markdown","55f0df07":"markdown","a13b8cf7":"markdown","d6681ad4":"markdown"},"source":{"39d841e2":"import pandas as pd\nimport numpy as np\nimport sklearn\nfrom sklearn.model_selection import KFold\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.preprocessing import scale\nfrom sklearn import datasets\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import roc_auc_score\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import r2_score\nfrom sklearn.linear_model import LinearRegression\nfrom catboost import CatBoostClassifier, Pool","6201e0b4":"%matplotlib inline\nimport matplotlib.pyplot as plt\nimport seaborn as sns","f703c14a":"data = pd.read_csv('\/kaggle\/input\/tabular-playground-series-may-2021\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/tabular-playground-series-may-2021\/test.csv')\nsubmission = pd.read_csv('\/kaggle\/input\/tabular-playground-series-may-2021\/sample_submission.csv')","3854611e":"data.head(10)","ca08236a":"test.head()","686514cf":"data = data.drop('id', axis=1)\ntest = test.drop('id', axis=1)","b1b4671f":"data.shape, test.shape","7357f3a0":"data.info()","4c54a533":"data['target'].value_counts(normalize=True).plot(kind='bar')","af77d55f":"colors = ['#001c57','#50248f','#a6a6a6','#38d1ff']\nsns.palplot(sns.color_palette(colors))","e16af58d":"sns.heatmap(data.corr(), cmap='YlGnBu', vmin=-1)","11966ffa":"dist_feature = pd.crosstab(data['target'], data['feature_0'])\ndist_feature.div(dist_feature.sum(1), axis=0).plot(kind='bar', stacked=True)","1cddd217":"dist_feature.div(dist_feature.sum(1), axis=0)","fab03b10":"X = data.drop('target', axis = 1)\ny = data.target","59315563":"X_train, X_valid, y_train, y_valid = train_test_split(X, y, test_size=.2, random_state=88)\nX_train.shape, X_valid.shape, y_train.shape, y_valid.shape","dda2059c":"clf = CatBoostClassifier()","ab01ef24":"train_pool = Pool(X_train, y_train)\nvalid_pool = Pool(X_valid, y_valid)","edb1aeb7":"clf.fit(train_pool, plot=True)","fab1a404":"plt.bar(range(len(clf.feature_importances_)), clf.feature_importances_)\nplt.show()","9c154f0d":"pred = clf.predict(valid_pool)\naccuracy = accuracy_score(pred, y_valid)\naccuracy","9851ed23":"y_pred = clf.predict_proba(test)\ny_pred","48b5996e":"submission_cat = pd.DataFrame(y_pred, columns=['Class_1', 'Class_2', 'Class_3', 'Class_4'])\nsubmission_cat['id'] = submission['id']\nsubmission_cat = submission_cat[['id','Class_1','Class_2','Class_3','Class_4']]\n#submission_cat.to_csv('submission_cat',index=False)","0330576d":"# \u0418\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435","ad8102f9":"### id'\u0448\u043d\u0438\u043a \u043d\u0430\u043c \u043d\u0435 \u043d\u0443\u0436\u0435\u043d, \u043e\u043d \u0437\u0434\u0435\u0441\u044c \u0432 \u0440\u043e\u043b\u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u0430, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043f\u0440\u043e\u0441\u0442\u043e \u0443\u0434\u0430\u043b\u0438\u043c \u0435\u0433\u043e \u0438\u0437 \u0434\u0430\u043d\u043d\u044b\u0445","98767a63":"\u041f\u0440\u043e\u043f\u0443\u0441\u043a\u043e\u0432 \u0432 \u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0435\u0442. \u0425\u043e\u0442\u044f \u043f\u043e-\u043c\u043e\u0435\u043c\u0443 \u043c\u043d\u0435\u043d\u0438\u0435, \u043c\u043e\u0436\u043d\u043e \u0431\u044b\u043b\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u0443\u0441\u0442\u044b\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439(\u044d\u0442\u043e \u0432\u0441\u0451 \u0440\u0430\u0432\u043d\u043e \u0438\u0433\u0440\u0443\u0448\u0435\u0447\u043d\u044b\u0439, \u0432\u043e \u0432\u0441\u0435\u0445 \u0441\u043c\u044b\u0441\u043b\u0430\u0445, \u043f\u0440\u0438\u043c\u0435\u0440), \u0447\u0442\u043e\u0431\u044b \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0449\u0438\u0435 \u0441\u0430\u0435\u043d\u0442\u0438\u0441\u0442\u044b \u043f\u043e\u043a\u0440\u0443\u0442\u0438\u043b\u0438 \u0434\u0430\u0442\u0430\u0441\u0435\u0442(\u043b\u0438\u0448\u043d\u0438\u043c \u043d\u0435 \u0431\u0443\u0434\u0435\u0442) \u0438 \u043f\u043e\u0434\u0443\u043c\u0430\u043b\u0438 \u043e \u043c\u0435\u0442\u043e\u0434\u0430\u0445 \u0438\u0445 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438. ","72fe5079":"# **\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u0434\u0430\u043d\u043d\u044b\u0435** \n## \u041e\u0442\u0441\u044e\u0434\u0430 \u0441\u0442\u0430\u0440\u0442\u0443\u0435\u0442 \u0431\u043b\u043e\u043a\u043d\u043e\u0442","1d4def88":"# \u0421\u0434\u0435\u043b\u0430\u0435\u043c \u043f\u0440\u0435\u0434\u0438\u043a\u0442\u044b \u0434\u043b\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0433\u043e \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430 \u0438 \u0437\u0430\u043f\u0438\u0448\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u043d\u0430 kaggle","0ad4e1b7":"### \u041d\u0438\u043a\u0430\u043a\u043e\u0439 \u043a\u043e\u0440\u0440\u0435\u043b\u044f\u0446\u0438\u0438 \u043c\u0435\u0436\u0434\u0443 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438 \u043d\u0435 \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u043e, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0442\u044c \u043a \u043d\u0438\u043c \u043a\u0430\u043a\u0438\u0435-\u0442\u043e \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u044b \u043d\u0435 \u0438\u043c\u0435\u0435\u0442 \u0441\u043c\u044b\u0441\u043b\u0430.","01265e18":"#### \u0421\u043f\u0430\u0441\u0438\u0431\u043e, \u0437\u0430 \u0442\u043e \u0447\u0442\u043e \u0433\u043e\u043b\u043e\u0441\u0443\u0435\u0442\u0435 \u0438 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0430\u044e \u0432\u0441\u0435\u0445 \u0436\u0435\u043b\u0430\u044e\u0449\u0438\u0445 \u0432 \u043c\u043e\u0439 \u0442\u0435\u043b\u0435\u0433\u0440\u0430\u043c\u043c \u043a\u0430\u043d\u0430\u043b: https:\/\/t.me\/data_science_bleat","6fa32ca6":"# **\u042f \u043d\u0430\u0447\u043d\u0443 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044e \u0441 \u0438\u043c\u043f\u043e\u0440\u0442\u0430 \u0432\u0441\u0435\u0445 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0445 \u043d\u0430\u043c \u0438\u043c\u0451\u043d. \u0425\u043e\u0442\u044c \u0438\u0445 \u0438 \u043c\u043e\u0436\u043d\u043e \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u043c\u0435\u0440\u0435 \u043d\u0430\u0434\u043e\u0431\u043d\u043e\u0441\u0442\u0438 \u0432 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0435, \u043e\u0434\u043d\u0430\u043a\u043e PEP8 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u0442 \u0434\u0435\u043b\u0430\u0442\u044c \u044d\u0442\u043e \u0432 \u043d\u0430\u0447\u0430\u043b\u0435 \u0444\u0430\u0439\u043b\u0430.**","45005cec":"## \u041e\u0431\u043e\u0437\u043d\u0430\u0447\u0438\u043c *Baseline* \u0434\u043b\u044f \u043d\u0430\u0448\u0435\u0439 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u043e\u0431\u0443\u0447\u0438\u043c \u043f\u0435\u0440\u0432\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u0431\u0435\u0437 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432.","55f0df07":"  #### \u0413\u0440\u0430\u0444\u0438\u043a \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u0432 \u043e\u0434\u043d\u043e\u0439 \u0444\u0438\u0447\u0435. \"0\" \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b-\u0432\u043e \u0440\u0430\u0437, \u043d\u043e \u043f\u0440\u0438 \u044d\u0442\u043e\u043c \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d \u0440\u0430\u0432\u043d\u043e\u043c\u0435\u0440\u043d\u043e \u0432\u043e \u0432\u0441\u0435\u0445 4 \u043a\u043b\u0430\u0441\u0441\u0430\u0445.","a13b8cf7":"### \u0417\u0430\u0447\u0435\u043c \u043c\u044b \u0441\u0442\u0440\u043e\u0438\u043c \u044d\u0442\u043e\u0442 \u0433\u0440\u0430\u0444\u0438\u043a? \u041d\u0443\u0436\u043d\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043a\u0430\u043a \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d \u0446\u0435\u043b\u0435\u0432\u043e\u0439 \u043f\u0440\u0438\u0437\u043d\u0430\u043a, \u0442\u0435\u043c \u0431\u043e\u043b\u0435\u0435, \u0447\u0442\u043e \u043e\u043d \u043d\u0435 \u0431\u0438\u043d\u0430\u0440\u043d\u044b\u0439. \u0421\u0440\u0430\u0437\u0443 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0434\u043c\u0435\u0442\u0438\u0442\u044c, \u0447\u0442\u043e \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043d\u0435 \u0440\u0430\u0432\u043d\u043e\u043c\u0435\u0440\u043d\u043e\u0435, \u0441 \u044d\u0442\u0438\u043c \u043f\u0440\u0438\u0434\u0451\u0442\u0441\u044f, \u0447\u0442\u043e-\u0442\u043e \u0434\u0435\u043b\u0430\u0442\u044c, \u043d\u043e \u043f\u043e\u043a\u0430 \u043f\u0440\u043e\u0441\u0442\u043e \u043f\u0440\u0438\u043c\u0435\u043c \u044d\u0442\u043e \u043a \u0441\u0432\u0435\u0434\u0435\u043d\u0438\u044e. 60% \u043e\u0442 \u0432\u0441\u0435\u0439 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0438 \u043f\u0440\u0438\u043d\u0430\u0434\u043b\u0435\u0436\u0438\u0442 \u043a \u043a\u043b\u0430\u0441\u0441\u0443 2, \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438 \u0442\u043e\u0436\u0435 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u044b \u043d\u0435\u0440\u0430\u0432\u043d\u043e\u043c\u0435\u0440\u043d\u043e, \u043d\u043e \u0438\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043d\u0430\u0445\u043e\u0434\u044f\u0442\u0441\u044f, \u0435\u0441\u043b\u0438 \u043c\u043e\u0436\u043d\u043e \u0442\u0430\u043a \u0433\u043e\u0432\u043e\u0440\u0438\u0442\u044c, \u0432 \u043f\u0440\u0435\u0434\u0435\u043b\u0430\u0445 \u043f\u043e\u0433\u0440\u0435\u0448\u043d\u043e\u0441\u0442\u0438. ","d6681ad4":"### \u0412\u0438\u0434\u043d\u043e, \u0447\u0442\u043e \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0444\u0438\u0447\u0438 \u043a\u0443\u0434\u0430 \u0431\u043e\u043b\u0435\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0432\u043d\u0435\u0435. "}}