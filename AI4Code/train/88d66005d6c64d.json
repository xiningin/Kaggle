{"cell_type":{"62526f4a":"code","6373171d":"code","5e61e8bd":"code","efdcc1ba":"code","48f695b6":"code","ad42b330":"code","d290dd29":"code","b4083800":"code","f39780c8":"code","18a3ef43":"code","e7c799d3":"code","bb3dc696":"code","e4249b35":"code","b53630f9":"code","e9d13b31":"code","81c89084":"code","45e33c97":"code","e609341b":"code","41e91b5f":"code","cae255e1":"code","6b9dfd1f":"code","23517626":"code","2c55b610":"code","be003a56":"code","85118786":"code","1fdee932":"code","ed811ee9":"code","c54956d7":"code","972a3ce0":"code","1c6f9b5e":"code","13b1c19f":"code","7eb3ca65":"code","59edf86f":"code","5dfb8c03":"markdown","3a5fde70":"markdown","b4f4c79d":"markdown","74a1bea9":"markdown","fe6f1411":"markdown","3e6234f6":"markdown","14ef41ce":"markdown","ec4851b0":"markdown","d4bf27d8":"markdown","4136c931":"markdown","f17dc018":"markdown","562c636f":"markdown","85de2b77":"markdown","deac59dd":"markdown","82535e8c":"markdown","4c5040f1":"markdown","36130e46":"markdown","9b73d27c":"markdown","2447e14d":"markdown","275c46a5":"markdown","87401b6c":"markdown"},"source":{"62526f4a":"import pandas as pd\nimport missingno as msno\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nfrom matplotlib import rcParams\nfrom sklearn import preprocessing\nimport warnings\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import AdaBoostClassifier\nimport xgboost\nfrom xgboost import XGBClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.tree import DecisionTreeClassifier\nimport numpy as np\nfrom sklearn import svm\nwarnings.filterwarnings(\"ignore\")","6373171d":"data=pd.read_csv(\"..\/input\/water-potability\/water_potability.csv\")\ndata.head()","5e61e8bd":"data.info()","efdcc1ba":"#Plot to visualize the patterns in the missing values\nmsno.matrix(data)","48f695b6":"#Percentage of missing values \ncolumns=data.columns\nprint(\"% of Missing values\")\nfor col in columns:\n    if data[col].isnull().sum():\n        print(\"      \",col,\": \",data[col].isnull().sum()\/len(data))\n    ","ad42b330":"data.describe()","d290dd29":"#The Mean and Median of the pH,Sulfate and Trihalomethanes are almost similar, So replace the missing values with any of these\nattributes=['ph','Sulfate','Trihalomethanes']\nfor col in attributes:\n    data[col].fillna(data[col].mean(),inplace=True)\ndata.info()","b4083800":"values=[len(data[data['Potability']==0]),len(data[data['Potability']==1])]\n\n# Figure Size\nfig, ax = plt.subplots(figsize =(11, 11))\n\n# Horizontal Bar Plot\nax.barh(['Non-Potable','Potable'],values)\n\n# Remove axes splines\nfor s in ['top', 'bottom', 'left', 'right']:\n    ax.spines[s].set_visible(False)\n \n # Remove x, y Ticks\nax.xaxis.set_ticks_position('none')\nax.yaxis.set_ticks_position('none')\n \n# Add padding between axes and labels\nax.xaxis.set_tick_params(pad = 5)\nax.yaxis.set_tick_params(pad = 10)\nax.invert_yaxis()\n\n# Add annotation to bars\nfor i in ax.patches:\n    plt.text(i.get_width()+0.2, i.get_y()+0.5,\n             str(round((i.get_width()), 2)),\n             fontsize = 10, fontweight ='bold',\n             color ='grey')\n# Add Plot Title\nax.set_title('Ratio of Potable and Non-Potable',\n             loc ='left', )\n \n\n # Show Plot\n\nplt.show()","f39780c8":"data","18a3ef43":"\nX = data.loc[:, data.columns != 'Potability']\ny = data.loc[:, data.columns == 'Potability']\n\nfrom imblearn.over_sampling import SMOTE\nOver_sample = SMOTE(random_state=0)\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=0)\ncolumns = X_train.columns\n\nOver_sample_data_X, Over_sample_data_y = Over_sample.fit_resample(X_train, y_train)\nOver_sample_data_X = pd.DataFrame(data=Over_sample_data_X ,columns=columns )\nOver_sample_data_y= pd.DataFrame(data=Over_sample_data_y,columns=['Potability'])\n\n# we can Check the numbers of our data\nprint(\"length of oversampled data is \",len(Over_sample_data_X))\nprint(\"Number of Non-Potable in oversampled data\",len(Over_sample_data_y[Over_sample_data_y['Potability']==0]))\n\nprint(\"Number of Potable in oversampledd data\",len(Over_sample_data_y[Over_sample_data_y['Potability']==1]))\n\nprint(\"Proportion of non Potable data in oversampled data is \",len(Over_sample_data_y[Over_sample_data_y['Potability']==0])\/len(Over_sample_data_X))\nprint(\"Proportion of Potable data in oversampled data is \",len(Over_sample_data_y[Over_sample_data_y['Potability']==1])\/len(Over_sample_data_X))\n","e7c799d3":"data=Over_sample_data_X\ntarget=Over_sample_data_y\n","bb3dc696":"sns.set(style=\"dark\")\nrcParams['figure.figsize'] = 8,5\nfor col in data.columns:\n    if col=='Potability':\n        continue\n    sns.distplot(data[col],kde=True,color='red')\n    plt.title(\"Distribution of {}\".format(col))\n    plt.show()","e4249b35":"#Normalizing the fetures using sklearn minmax scaler\nmin_max_scaler = preprocessing.MinMaxScaler(feature_range =(0, 1))\ndata=min_max_scaler.fit_transform(data)\ndata=pd.DataFrame(data)\nprint(data)\ndata.columns=columns","b53630f9":"rcParams['figure.figsize'] = 11,11\ncorrelation=data.copy()\nsns.heatmap(correlation.corr(),xticklabels=correlation.columns,yticklabels=correlation.columns,annot=True,cmap=sns.diverging_palette(220, 10, as_cmap=True),linewidths=2)\nplt.title(\"Correlation Plot\")\nplt.show()","e9d13b31":"data","81c89084":"X_train, X_test, y_train, y_test = train_test_split(data, target, test_size=0.2,shuffle=True)","45e33c97":"print(X_train.shape)\nprint(y_train.shape)","e609341b":"Accuracy_={}","41e91b5f":"from sklearn import metrics\nlogreg = LogisticRegression()\nlogreg.fit(X_train, y_train)\ny_pred = logreg.predict(X_test)\nAccuracy_[\"Logistic Regression\"]=logreg.score(X_test, y_test)*100\nprint('Accuracy of logistic regression classifier on test set: {:.2f}'.format(logreg.score(X_test, y_test)))","cae255e1":"from sklearn.metrics import confusion_matrix\nconfusion_matrix = confusion_matrix(y_test, y_pred)\nrcParams['figure.figsize'] = 10,5\nsns.set(font_scale=1.5)\nplt.yticks(va='center')\nsns.heatmap(confusion_matrix,xticklabels=['Potable','Non-Potable'],yticklabels=['Potable','Non-Potable'],annot=True,cmap='YlGnBu',linewidths=0.5,fmt='d',annot_kws={\"size\":15})\nplt.title(\"Logistic Regression Confusion Matrix\")\nplt.show()","6b9dfd1f":"svc = svm.SVC(C=2)\nsvc.fit(X_train,y_train)\ny_pred = svc.predict(X_test)\nAccuracy_[\"SVM Classifier\"]=svc.score(X_test, y_test)*100\nprint('Accuracy of SVM classifier on test set: {:.2f}'.format(svc.score(X_test, y_test)))","23517626":"from sklearn.metrics import confusion_matrix\nconfusion_matrix = confusion_matrix(y_test, y_pred)\nrcParams['figure.figsize'] = 10,5\nsns.set(font_scale=1.5)\nplt.yticks(va='center')\nsns.heatmap(confusion_matrix,xticklabels=['Potable','Non-Potable'],yticklabels=['Potable','Non-Potable'],annot=True,cmap='YlGnBu',linewidths=0.5,fmt='d',annot_kws={\"size\":15})\nplt.title(\"SVM Classifier Confusion Matrix\")\nplt.show()","2c55b610":"DT = DecisionTreeClassifier()\nDT.fit(X_train, y_train)\ny_pred = DT.predict(X_test)\nAccuracy_[\"Decision Tree\"]=DT.score(X_test, y_test)*100\nprint('Accuracy of Decision Tree classifier on test set: {:.2f}'.format(DT.score(X_test, y_test)))","be003a56":"from sklearn.metrics import confusion_matrix\nconfusion_matrix=confusion_matrix(y_test,y_pred)\nrcParams['figure.figsize'] = 10,5\nsns.set(font_scale=1.5)\nplt.yticks(va='center')\nsns.heatmap(confusion_matrix,xticklabels=['Potable','Non-Potable'],yticklabels=['Potable','Non-Potable'],annot=True,cmap='YlGnBu',linewidths=0.5,fmt='d',annot_kws={\"size\":15})\nplt.title(\"Decision Tree Confusion Matrix\")\nplt.show()","85118786":"model_forest=RandomForestClassifier()\ngrid_forest=GridSearchCV(model_forest,param_grid={'max_depth':range(6,11)})\ngrid_forest.fit(X_train,y_train)\ny_pred = grid_forest.predict(X_test)\nAccuracy_[\"Random Forest\"]=grid_forest.score(X_test, y_test)*100\nprint('Accuracy of Random Forest on test set: {:.2f}'.format(grid_forest.score(X_test, y_test)))","1fdee932":"from sklearn.metrics import confusion_matrix\nconfusion_matrix=confusion_matrix(y_test,y_pred)\nrcParams['figure.figsize'] = 10,5\nsns.set(font_scale=1.5)\nplt.yticks(va='center')\nsns.heatmap(confusion_matrix,xticklabels=['Potable','Non-Potable'],yticklabels=['Potable','Non-Potable'],annot=True,cmap='YlGnBu',linewidths=0.5,fmt='d',annot_kws={\"size\":15})\nplt.title(\"Random Forest Confusion Matrix\")\nplt.show()","ed811ee9":"model_xgb=XGBClassifier(n_estimators=10)\nmodel_xgb.fit(X_train,y_train)\ny_pred = model_xgb.predict(X_test)\nAccuracy_[\"XG Boost\"]=model_xgb.score(X_test, y_test)*100\nprint('Accuracy of XG Boostt on test set: {:.2f}'.format(model_xgb.score(X_test, y_test)))\n","c54956d7":"from sklearn.metrics import confusion_matrix\nconfusion_matrix=confusion_matrix(y_test,y_pred)\nrcParams['figure.figsize'] = 10,5\nsns.set(font_scale=1.5)\nplt.yticks(va='center')\nsns.heatmap(confusion_matrix,xticklabels=['Potable','Non-Potable'],yticklabels=['Potable','Non-Potable'],annot=True,cmap='YlGnBu',linewidths=0.5,fmt='d',annot_kws={\"size\":15})\nplt.title(\"XG Boost Confusion Matrix\")\nplt.show()","972a3ce0":"model_adaboost=AdaBoostClassifier(n_estimators=70)\nmodel_adaboost.fit(X_train,y_train)\ny_pred = model_adaboost.predict(X_test)\nAccuracy_[\"Ada Boost\"]=model_adaboost.score(X_test, y_test)*100\nprint('Accuracy of Ada Boost on test set: {:.2f}'.format(model_adaboost.score(X_test, y_test)))\n","1c6f9b5e":"from sklearn.metrics import confusion_matrix\nconfusion_matrix=confusion_matrix(y_test,y_pred)\nrcParams['figure.figsize'] = 10,5\nsns.set(font_scale=1.5)\nplt.yticks(va='center')\nsns.heatmap(confusion_matrix,xticklabels=['Potable','Non-Potable'],yticklabels=['Potable','Non-Potable'],annot=True,cmap='YlGnBu',linewidths=0.5,fmt='d',annot_kws={\"size\":15})\nplt.title(\"Ada Boost Confusion Matrix\")\nplt.show()","13b1c19f":"model_KNN=KNeighborsClassifier()\ngrid_KNN=GridSearchCV(model_KNN,param_grid={'n_neighbors':range(4,12)})\ngrid_KNN.fit(X_train,y_train)\ny_pred = grid_KNN.predict(X_test)\nAccuracy_[\"KNN Classifier\"]=grid_KNN.score(X_test, y_test)*100\nprint('Accuracy of KNN Classifier on test set: {:.2f}'.format(grid_KNN.score(X_test, y_test)))\n","7eb3ca65":"from sklearn.metrics import confusion_matrix\nconfusion_matrix=confusion_matrix(y_test,y_pred)\nrcParams['figure.figsize'] = 10,5\nsns.set(font_scale=1.5)\nplt.yticks(va='center')\nsns.heatmap(confusion_matrix,xticklabels=['Potable','Non-Potable'],yticklabels=['Potable','Non-Potable'],annot=True,cmap='YlGnBu',linewidths=0.5,fmt='d',annot_kws={\"size\":15})\nplt.title(\"KNN Classifier Confusion Matrix\")\nplt.show()","59edf86f":"print(\"{:<25} {:<15}\".format('Model','Accuracy'))\nfor k, v in sorted(Accuracy_.items(), key=lambda item :item[1],reverse=True):\n    \n    print(\"{:<25} {:<15}\".format(k,v))","5dfb8c03":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>KNN Classifier<\/b><\/h1>","3a5fde70":"<center><img src=\"https:\/\/p9cdn4static.sharpschool.com\/UserFiles\/Servers\/Server_791028\/Image\/News-Announcements\/water-testing.jpg\",height='1',width='0.05'><\/center>","b4f4c79d":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>Importing libraries and Loading Dataset<\/b><\/h1>","74a1bea9":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>Train Test Split<\/b><\/h1>","fe6f1411":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>Distribution of the Features<\/b><\/h1>","3e6234f6":"Safe and readily available water is important for public health, whether it is used for drinking, domestic use, food production or recreational purposes. Improved water supply and sanitation, and better management of water resources, can boost countries\u2019 economic growth and can contribute greatly to poverty reduction.\n\nContaminated water and poor sanitation are linked to transmission of diseases such as cholera, diarrhoea, dysentery, hepatitis A, typhoid, and polio. Absent, inadequate, or inappropriately managed water and sanitation services expose individuals to preventable health risks. This is particularly the case in health care facilities where both patients and staff are placed at additional risk of infection and disease when water, sanitation, and hygiene services are lacking. Globally, 15% of patients develop an infection during a hospital stay, with the proportion much greater in low-income countries.","14ef41ce":"# Description of the features\n* pH is a measure of how acidic\/basic water is. The range goes from 0 to 14, with 7 being neutral. pHs of less than 7 indicate acidity, whereas a pH of greater than 7 indicates a base. The pH of water is a very important measurement concerning water quality.\n* Hardness was originally a measure of the capacity of water to react with soap, where hard water requires more soap to create a lather.Water containing calcium carbonate at concentrations below 60 mg\/l is generally considered as soft; 60\u2013120 mg\/l, moderately hard; 120\u2013180 mg\/l, hard; and more than 180 mg\/l, very hard.\n* The principal constituents are usually calcium, magnesium, sodium, and potassium cations and carbonate, hydrogencarbonate, chloride, sulfate, and nitrate anions. The presence of dissolved solids in water may affect its taste.\n* Chloramines (also known as secondary disinfection) are disinfectants used to treat drinking water and they:\n    * Are most commonly formed when ammonia is added to chlorine to treat drinking water.\n    * Provide longer-lasting disinfection as the water moves through pipes to consumers.\n* Sulfate is second to bicarbonate as the major anion in hard water reservoirs. Sulfates (SO4--) can be naturally occurring or the result of municipal or industrial discharges.In humans, concentrations of 500 - 750 mg\/L cause a temporary laxative effect. However, doses of several thousand mg\/L did not cause any long-term ill effects. At very high concentrations sulfates are toxic to cattle. Problems caused by sulfates are most often related to their ability to form strong acids which changes the pH.\n* Conductivity of water is important is because it can tell you how much dissolved substances, chemicals, and minerals are present in the water. Higher amounts of these impurities will lead to a higher conductivity\n* Total Organic Carbon (TOC) is a measure of the total amount of carbon in organic compounds in pure water and aqueous systems. ... Unless it's ultrapure, water will naturally contain some organic compounds, understanding how much is key.\n* Trihalomethanes (THMs) are the result of a reaction between the chlorine used for disinfecting tap water and natural organic matter in the water. At elevated levels, THMs have been associated with negative health effects such as cancer and adverse reproductive outcomes.\n* Turbidity is the measure of relative clarity of a liquid. It is an optical characteristic of water and is a measurement of the amount of light that is scattered by material in the water when a light is shined through the water sample. \n","ec4851b0":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>Relationship b\/w the features<\/b><\/h1>","d4bf27d8":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b> Random Forest<b><\/h1>","4136c931":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>Test Accuracy<\/b><\/h1>","f17dc018":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>Featue Scalling<\/b><\/h1>","562c636f":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>Ada Boost<\/b><\/h1>","85de2b77":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>Over Sampling Using SMOTE<\/b><\/h1>","deac59dd":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>Train and Evaluvate<\/b><\/h1>","82535e8c":"\n\n<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b> Decision Tree<\/b><\/h1>","4c5040f1":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>SVM Classifier<\/b><\/h1>","36130e46":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>XGBoost Classifier<\/b><\/h1>","9b73d27c":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>Dataset Overview<\/b><\/h1>","2447e14d":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>Logistic Regression<\/b><\/h1>","275c46a5":"# If you find this notebook useful\n<h1 style=\"background-color:tomato;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>feel free to upvote!<\/b><\/h1>","87401b6c":"<h1 style=\"background-color:MediumSeaGreen;font-family:newtimeroman;font-size:500%;text-align:center;border-radius: 15px 50px;padding: 5px 5px 5px 5px\">\n    <b>Attributes with Missing values<\/b><\/h1>"}}