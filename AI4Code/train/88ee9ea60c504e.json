{"cell_type":{"a1c088e1":"code","de5add39":"code","c8f2e711":"code","131a5565":"code","f7378eba":"code","b328319f":"code","b5d36fea":"code","5e63e9ce":"code","dc4e43a0":"code","4b6cda9c":"code","f1dfde10":"code","70581913":"code","44e07a65":"code","1a735eff":"code","da7c8d11":"code","221b7b73":"code","d12825b6":"code","ef547439":"code","7e29dc62":"code","f6beab3b":"code","1803a81f":"code","6cb55c2d":"code","b6c6c957":"code","84b60b88":"code","f372082f":"code","8604660d":"code","fc33782b":"code","b043ab6b":"code","1bff7a8f":"code","6a035709":"code","d7a518b0":"code","c52fc073":"code","f07c56ef":"code","7995787c":"code","8379b2fe":"code","9b8d576a":"code","077b212d":"code","a33829ec":"code","52cf6c91":"code","3021d072":"code","f476847c":"code","7e3c8e84":"code","3347a0d9":"code","7912e2d7":"code","f13cfd3e":"markdown"},"source":{"a1c088e1":"#%reset -f  \nimport numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt   \n#%matplotlib  qt5\nimport os","de5add39":"#os.getcwd()\nimport seaborn as sns  \n#path = \"C:\\\\Backup\\\\My Documents\\\\My Documents\\\\Training\\\\Data ScienceAnalytics\\\\Python\"","c8f2e711":"#os.chdir(path)\n#df = pd.read_csv(\"superstore-data.zip\", encoding = \"ISO-8859-1\")\ndf = pd.read_csv(\"..\/input\/superstore_dataset2011-2015.csv\", encoding = \"ISO-8859-1\")","131a5565":"df.shape","f7378eba":"df.head()\ndf.columns\ndf.dtypes","b328319f":"#===============================================================================\n#1. Who are the top-20 most profitable customers. Show them through plots.\n#===============================================================================","b5d36fea":"result = df.groupby([\"Customer Name\"])['Profit'].aggregate(np.sum).reset_index().sort_values('Profit',ascending = False).head(20)","5e63e9ce":"result.head\ntype(result)\nresult.shape\nresult\nsns.barplot(x = \"Customer Name\",y= \"Profit\",data=result)","dc4e43a0":"fig = plt.figure(figsize = (5,5))","4b6cda9c":"ax1 = fig.add_subplot(111)\nsns.barplot(x = \"Customer Name\",y= \"Profit\",\n            data=result,\n            ax = ax1\n             )","f1dfde10":"ax1.set_ylabel(\"Profit\", fontname=\"Arial\", fontsize=12)\n","70581913":"# Set the title to Comic Sans\nax1.set_title(\"Top 20 Customers\", fontname='Comic Sans MS', fontsize=18)\n","44e07a65":"# Set the font name for axis tick labels to be Comic Sans\nfor tick in ax1.get_xticklabels():\n    tick.set_fontname(\"Comic Sans MS\")\n    tick.set_fontsize(12)\nfor tick in ax1.get_yticklabels():\n    tick.set_fontname(\"Comic Sans MS\")\n    tick.set_fontsize(12)","1a735eff":"# Rotate the labels as the Customer names overwrites on top of each other\nax1.set_xticklabels(ax1.get_xticklabels(), rotation = 45)\nplt.show()","da7c8d11":"#---Observations\n## The top 3 customers in that order are Tamara Chand, Raymond Buch & Sanjit Chand","221b7b73":"#=================================================================================\n# 2. What is the distribution of our customer segment\n#=================================================================================\ndescending_order = df['Segment'].value_counts().index","d12825b6":"df.Segment.value_counts()","ef547439":"df['Segment'].unique()","7e29dc62":"sns.countplot(\"Segment\", data = df, order = descending_order)","f6beab3b":"#---Observations\n# Segment is categorical attribute with 3 levels - Consumer, Corporate & Home Office. The distribution is highest in Consumer\n# followed by Corporate and Home Office","1803a81f":"#=====================================================================================\n#3. Who are our top-20 oldest customers\n#=====================================================================================","6cb55c2d":"df.dtypes.value_counts()","b6c6c957":"df.dtypes","84b60b88":"df['Order Date'] = pd.to_datetime(df['Order Date'])","f372082f":"oldest = pd.DataFrame({'Count' : df.groupby([\"Order Date\",\"Customer Name\"]).size()}).reset_index()","8604660d":"oldest.head(20)","fc33782b":"# Top oldest customers are Annie Thurman, Eugene Moren, Joseph Holt, Toby Braunhardt, Dave Hallsten","b043ab6b":"#=========================================================================================\n#4. Which customers have visited this store just once\n#==========================================================================================","1bff7a8f":"Customers_visit = pd.DataFrame({'Count' : df.groupby([\"Customer Name\"]).size()}).reset_index()","6a035709":"Customers_visit[Customers_visit['Count'] == 1]","d7a518b0":"#Since it returns an empty data frame, there are no customers that have visited this store just once","c52fc073":"#==========================================================================================\n#5. Relationship of Order Priority and Profit\ndf['Order Priority'].value_counts()\n\nsns.boxplot(\n            \"Order Priority\",\n            \"Profit\",\n             data= df\n             )","f07c56ef":"#there does not appear to be any relationship between Order Priority & Profit","7995787c":"#6. What is the distribution of customers Market wise?\ndf.shape\ndf['Market'].value_counts()\nCustomers_market = pd.DataFrame({'Count' : df.groupby([\"Market\",\"Customer Name\"]).size()}).reset_index()\nCustomers_market.shape\n","8379b2fe":"sns.barplot(x = \"Market\",     # Data is groupedby this variable\n             y= \"Count\",    # Aggregated by this variable\n             data=Customers_market\n             )","9b8d576a":"sns.countplot(\"Market\",        # Variable whose distribution is of interest\n                data = Customers_market)","077b212d":"# Market has 7 levels. APAC has the largest # of customers followed by LATAM, and US in that order\n # Canada has the least # of customers","a33829ec":"#7. What is the distribution of customers Market wise and Region wise\ndf['Region'].value_counts()\nCustomers_market_region = pd.DataFrame({'Count' : df.groupby([\"Market\",\"Region\",\"Customer Name\"]).size()}).reset_index()\n\nsns.countplot(\"Market\",        # Variable whose distribution is of interest\n              hue= \"Region\",    # Distribution will be gender-wise\n              data = Customers_market_region)","52cf6c91":"#for APAC, the largest # of customers are basd out of Oceania, followed by Southeast Asia\n#for US, the largest # of customers are based out of Western Region followed by East","3021d072":"#8.Distribution of  Customers by Country & State - top 15\nCustomers_Country = pd.DataFrame({'Count' : df.groupby([\"Country\",\"State\"]).size()}).reset_index().sort_values('Count',ascending = False).head(15)\nCustomers_Country\n\nsns.barplot(x = \"Country\",     # Data is groupedby this variable\n            y= \"Count\",  \n            hue=\"State\",\n            data = Customers_Country.sort_values('Country')\n            )\n## US has the largest number of customers -California being the largest followed by New York, Washington, Illinois & Ohio\n## UK has the next largest population of Customers -England","f476847c":"# Top 20 Cities by Sales Volume\nsale_cities = df.groupby([\"City\"])['Quantity'].aggregate(np.sum).reset_index().sort_values('Quantity',ascending = False).head(20)\nsns.barplot(x = \"City\",     # Data is groupedby this variable\n            y= \"Quantity\",          \n            data=sale_cities,\n            )","7e3c8e84":"# top 10 products\nsale_Products = df.groupby([\"Product Name\"])['Quantity'].aggregate(np.sum).reset_index().sort_values('Quantity',ascending = False).head(20)\nsns.barplot(x = \"Product Name\",     # Data is groupedby this variable\n            y= \"Quantity\",          \n            data=sale_Products)\n#Staples is the largest selling product","3347a0d9":"# top selling products by countries (in US)\ndf.columns\nsale_Products_Country = df.groupby([\"Product Name\",\"Country\"])['Quantity'].aggregate(np.sum).reset_index().sort_values('Quantity',ascending = False)\nsale_Products_Country = df.groupby([\"Product Name\",\"Country\"])['Quantity'].sum().reset_index().sort_values('Quantity',ascending = False)\nsale_Products_Country\ntype(sale_Products_Country)\nspc = sale_Products_Country[sale_Products_Country['Country'] == \"United States\"].sort_values('Quantity',ascending = False).head(20)\nsns.barplot(x = \"Product Name\",     # Data is groupedby this variable\n            hue=\"Country\",\n            y= \"Quantity\",          \n            data=spc)\n# top selling products by countries (in US)\ndf.columns\nsale_Products_Country = df.groupby([\"Product Name\",\"Country\"])['Quantity'].aggregate(np.sum).reset_index().sort_values('Quantity',ascending = False)\nsale_Products_Country = df.groupby([\"Product Name\",\"Country\"])['Quantity'].sum().reset_index().sort_values('Quantity',ascending = False)\nsale_Products_Country\ntype(sale_Products_Country)\nspc = sale_Products_Country[sale_Products_Country['Country'] == \"United States\"].sort_values('Quantity',ascending = False).head(20)\nsns.barplot(x = \"Product Name\",     # Data is groupedby this variable\n            hue=\"Country\",\n            y= \"Quantity\",          \n            data=spc)","7912e2d7":"# sales by product Category, Sub-category\nsale_category = df.groupby([\"Category\",\"Sub-Category\"])['Quantity'].aggregate(np.sum).reset_index().sort_values('Quantity',ascending = False)\nsale_category\nsns.barplot(x = \"Category\",     # Data is groupedby this variable\n            hue=\"Sub-Category\",\n            y= \"Quantity\",          \n            data=sale_category)","f13cfd3e":"for tick in ax1.get_yticklabels():\n    tick.set_fontname(\"Comic Sans MS\")\n    tick.set_fontsize(12)"}}