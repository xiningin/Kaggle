{"cell_type":{"2eb6cbfd":"code","9e94ec30":"code","ffc46c9b":"code","092131f1":"code","2995c032":"code","ed2a9cb2":"code","ea6b5cb6":"code","0dd36ba4":"code","40e3d215":"code","b49a0738":"code","04da6873":"code","550ccb2e":"code","c19dd508":"code","7418b44a":"code","c62d95e8":"code","e7dac8a7":"code","c7a8ced0":"code","b47dd2f9":"code","55329e04":"code","02c14957":"code","1c8eb12d":"code","5f7b9fbd":"code","089fe550":"markdown"},"source":{"2eb6cbfd":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","9e94ec30":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","ffc46c9b":"data = pd.read_csv('..\/input\/diamonds\/diamonds.csv',index_col=0)\n","092131f1":"data.head()","2995c032":"data.isnull()","ed2a9cb2":"data.describe()","ea6b5cb6":"data.info()","0dd36ba4":"from sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.metrics import mean_absolute_error , mean_squared_error , r2_score","40e3d215":"data = pd.get_dummies(data)","b49a0738":"X=data.drop(['price'] , axis=1)","04da6873":"y=data['price']","550ccb2e":"X_train , X_val , y_train , y_val = train_test_split(X , y , test_size = 0.8 , random_state=1) ","c19dd508":"model = RandomForestRegressor()","7418b44a":"model.fit(X_train , y_train)","c62d95e8":"y_pred = model.predict(X_val)","e7dac8a7":"mae = mean_absolute_error(y_val , y_pred)","c7a8ced0":"mae","b47dd2f9":"mse = mean_squared_error(y_val , y_pred)","55329e04":"mse","02c14957":"sns.jointplot(x=y_val,y=y_pred,kind='reg',line_kws={\"color\": \"red\"})\nplt.title('actual vs predicted output')\nplt.show()","1c8eb12d":"r2 = r2_score(y_val , y_pred)","5f7b9fbd":"r2","089fe550":"**The model predicts with 97.64% accuracy**"}}