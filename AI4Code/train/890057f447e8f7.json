{"cell_type":{"d91e2747":"code","1eec30be":"code","f47bfd6a":"code","15a5101d":"code","7e559a5a":"code","fa1dcac7":"code","31fa1bde":"code","9460ac8b":"code","e203b3f6":"code","27c30c15":"code","80265bfb":"code","b39b6b2e":"code","48fb7c0b":"code","759f5e2b":"code","b5b73915":"code","2eac96a3":"code","e11228b8":"code","9d4cb8aa":"code","a198aab3":"code","2cd1a983":"code","af80809b":"code","905d9989":"code","797c50a1":"code","a187e647":"code","3615a254":"code","0975e41c":"code","6c5c86b9":"code","b1436af9":"code","81bdd602":"code","7f828f01":"code","f96564dc":"code","c3ab90d0":"markdown","d2416b3b":"markdown","b0995f2a":"markdown","8cb25932":"markdown","d5f1aedc":"markdown","00ddf2ac":"markdown","52718ade":"markdown","d7c278b3":"markdown","f5c9e683":"markdown","40611fd6":"markdown"},"source":{"d91e2747":"# Pandas : librairie de manipulation de donn\u00e9es\n# NumPy : librairie de calcul scientifique\n# MatPlotLib : librairie de visualisation et graphiques\nimport pandas as pd\nimport numpy as np\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.model_selection import train_test_split\n\nfrom sklearn.metrics import mean_squared_error, r2_score","1eec30be":"#lecture du dataset\ndf = pd.read_csv(\"..\/input\/bostonhoustingmlnd\/housing.csv\")","f47bfd6a":"df.head().T","15a5101d":"df.info()","7e559a5a":"df.plot(kind=\"scatter\", x=\"LSTAT\", y=\"RM\", c=\"MEDV\", cmap=\"rainbow\", s=3, figsize=(12,12))","fa1dcac7":"df.count()","31fa1bde":"tabcorr = df.corr() ","9460ac8b":"tabcorr","e203b3f6":"plt.figure(figsize=(12,12))\nsns.heatmap(abs(tabcorr), cmap=\"coolwarm\")","27c30c15":"sns.clustermap(abs(tabcorr), cmap=\"coolwarm\")","80265bfb":"from scipy.cluster import hierarchy as hc\n\ncorr = 1 - df.corr()\ncorr_condensed = hc.distance.squareform(corr)\nlink = hc.linkage(corr_condensed, method='ward')\nplt.figure(figsize=(12,12))\nden = hc.dendrogram(link, labels=df.columns, orientation='left', leaf_font_size=10)","b39b6b2e":"correlations = tabcorr.MEDV\nprint(correlations)","48fb7c0b":"correlations = correlations.drop(['MEDV'],axis=0)","759f5e2b":"print(abs(correlations).sort_values(ascending=False))","b5b73915":"df.columns","2eac96a3":"continuous_features = ['RM', 'LSTAT', 'PTRATIO']","e11228b8":"from sklearn.linear_model import LinearRegression","9d4cb8aa":"X = df.drop(['MEDV'], axis=1)\ny = df.MEDV\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1, random_state=1)","a198aab3":"lm = LinearRegression()\nlm.fit(X_train, y_train)            # apprentissage\ny_pred = lm.predict(X_test)         # pr\u00e9diction sur l'ensemble de test","2cd1a983":"plt.figure(figsize=(12,12))\nplt.scatter(y_test, y_pred)\nplt.plot([y_test.min(),y_test.max()],[y_test.min(),y_test.max()], color='red', linewidth=3)\nplt.xlabel(\"Prix\")\nplt.ylabel(\"Prediction de prix\")\nplt.title(\"Prix reels vs predictions\")","af80809b":"sns.distplot(y_test-y_pred)","905d9989":"print(np.sqrt(mean_squared_error(y_test, y_pred)))","797c50a1":"scoreR2 = r2_score(y_test, y_pred)\nprint(scoreR2)","a187e647":"lm.score(X_test,y_test)","3615a254":"from sklearn import ensemble\nrf = ensemble.RandomForestRegressor()\nrf.fit(X_train, y_train)\ny_rf = rf.predict(X_test)\nprint(rf.score(X_test,y_test))","0975e41c":"plt.figure(figsize=(12,12))\nplt.scatter(y_test, y_rf)\nplt.plot([y_test.min(),y_test.max()],[y_test.min(),y_test.max()], color='red', linewidth=3)\nplt.xlabel(\"Prix\")\nplt.ylabel(\"Prediction de prix\")\nplt.title(\"Prix reels vs predictions\")","6c5c86b9":"sns.distplot(y_test-y_rf)","b1436af9":"print(np.sqrt(mean_squared_error(y_test, y_rf)))","81bdd602":"rf.score(X_test,y_test)","7f828f01":"import xgboost as XGB\nxgb  = XGB.XGBRegressor()\nxgb.fit(X_train, y_train)\ny_xgb = xgb.predict(X_test)\nprint(xgb.score(X_test,y_test))\n\nplt.figure(figsize=(12,12))\nplt.scatter(y_test, y_xgb)\nplt.plot([y_test.min(),y_test.max()],[y_test.min(),y_test.max()], color='red', linewidth=3)\nplt.xlabel(\"Prix\")\nplt.ylabel(\"Prediction de prix\")\nplt.title(\"Prix reels vs predictions\")","f96564dc":"sns.distplot(y_test-y_xgb)","c3ab90d0":"qu'on peut \u00e9crire plus simplement :","d2416b3b":"## R\u00e9gression par for\u00eats al\u00e9atoires","b0995f2a":"On peut tracer uniquement le dendrogramme des corr\u00e9lations entre les caract\u00e9ristiques. On utilise une forme \"condens\u00e9e\" de la matrice de corr\u00e9lation. linkage permet de calculer les distances entre caract\u00e9ristiques \u00e0 partir des corr\u00e9lations","8cb25932":"Ou le score R2 (rapport des variances estim\u00e9e\/r\u00e9elle) :","d5f1aedc":"# R\u00e9gression lin\u00e9aire multiple","00ddf2ac":"On voit que la plus forte corr\u00e9lation concerne la LSTAT","52718ade":"## XG boost","d7c278b3":"## Recherche de corr\u00e9lations","f5c9e683":"'RM' \u662f\u8be5\u5730\u533a\u4e2d\u6bcf\u4e2a\u623f\u5c4b\u7684\u5e73\u5747\u623f\u95f4\u6570\u91cf\uf97e\uff1b\n'LSTAT' \u662f\u6307\u8be5\u5730\u533a\u6709\u591a\u5c11\u767e\u5206\u2f50\u6bd4\u7684\u4e1a\u4e3b\u5c5e\u4e8e\u662f\u4f4e\u6536\u2f0a\u5165\u9636\u5c42\uff08\u6709\u2f2f\u5de5\u4f5c\u4f46\u6536\u2f0a\u5165\u5fae\u8584\uff09\uff1b\n'PTRATIO' \u662f\u8be5\u5730\u533a\u7684\u4e2d\u5b66\u548c\u2f29\u5c0f\u5b66\u2fa5\u91cc\uf9e9\uff0c\u5b66\u2f63\u751f\u548c\u2f7c\u8001\uf934\u5e08\u7684\u6570\u2f6c\u76ee\u2f50\u6bd4\uff08\u5b66\u2f63\u751f\/\u2f7c\u8001\uf934\u5e08\uff09","40611fd6":"## Lecture du fichier"}}