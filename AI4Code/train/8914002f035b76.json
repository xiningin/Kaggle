{"cell_type":{"dc5696cd":"code","f1cf39af":"code","32c576c2":"code","1d9b31cb":"code","440685d9":"code","13edef1a":"code","b22e3389":"markdown","422d1b5c":"markdown","32b18e5e":"markdown","deec9805":"markdown","78a487bc":"markdown"},"source":{"dc5696cd":"!pip install nyaggle\n\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom nyaggle.experiment import run_experiment\nfrom tqdm.notebook import tqdm\nimport os\n%matplotlib inline\n","f1cf39af":"train = pd.read_csv('\/kaggle\/input\/seti-breakthrough-listen\/train_labels.csv')\ntest = pd.read_csv('\/kaggle\/input\/seti-breakthrough-listen\/sample_submission.csv')\n\ndef get_file_path(image_id: str, train_or_test: str, data_dir: str = '\/kaggle\/input\/seti-breakthrough-listen\/') -> str:\n    return os.path.join(data_dir, train_or_test, image_id[0], f\"{image_id}.npy\")\n\ntrain['type'] = 'train'\ntest['type'] = 'test'\ndf = pd.concat([train, test]).reset_index(drop=True)\n\nmean = []\nstd = []\nminv = []\nmaxv = []\nnuniq = []\n\nfor i, row in tqdm(df.iterrows()):\n    arr = np.load(get_file_path(row.id, row.type))[[0,2,4],:,:].astype(float)\n    mean.append(np.mean(arr))\n    std.append(np.std(arr))\n    minv.append(np.min(arr))\n    maxv.append(np.max(arr))\n    nuniq.append(len(np.unique(arr)))\n    \ndf['mean'] = mean\ndf['std'] = std\ndf['min'] = minv\ndf['max'] = maxv\ndf['nuniq'] = nuniq\n\ndf.to_csv('seti-stats.csv', index=False)","32c576c2":"fig, axes = plt.subplots(1, 2, figsize=(16,7))\n\naxes[0].set_xlim(-0.0001, 0.0001)\naxes[0].set_title('mean of image')\naxes[1].set_xlim(0.9998, 1.0002)\naxes[1].set_title('std of image')\n\nsns.distplot(df[df['target']==1]['mean'], label='target=1', ax=axes[0])\nsns.distplot(df[df['target']==0]['mean'], label='target=0', ax=axes[0])\n\nsns.distplot(df[df['target']==1]['std'], label='target=1', ax=axes[1])\nsns.distplot(df[df['target']==0]['std'], label='target=0', ax=axes[1])\n\nplt.legend()","1d9b31cb":"params = {\n    'objective': 'binary',\n    'metrics': 'auc',\n    'n_estimators': 300\n}\nfeatures = ['mean', 'std', 'min', 'max', 'nuniq']\n\nX_train = df[df['type'] == 'train'][features]\ny_train = df[df['type'] == 'train']['target']\nX_test = df[df['type'] == 'test'][features]\nresult = run_experiment(params, X_train, y_train, X_test, fit_params={'verbose': 50})","440685d9":"print(f'OOF SCORE: {result.metrics[-1]}')","13edef1a":"submission = pd.read_csv('\/kaggle\/input\/seti-breakthrough-listen\/sample_submission.csv')\nsubmission['target'] = result.test_prediction\nsubmission.to_csv('submission.csv', index=False)","b22e3389":"## Modeling","422d1b5c":"# This is a folk of [this notebook](https:\/\/www.kaggle.com\/nyanpn\/yet-another-leakage-lb0-995)\nI just want to confirm that this notebook is not valid for the new dataset.","32b18e5e":"Images with target=0 appear to be normalized to mean 0 and variance 1, whereas **images with target=1 are clearly seen to have a positive bias in the mean and a larger variance.**\n\nPerhaps the host added the target signal to the image **after** normalizing the background noise. (Of course, to prevent leakage, the image should be normalized after the target signal is added.","deec9805":"## Visualize basic statistics","78a487bc":"A simple statistic alone was able to produce a CV=0.93. Perhaps the model for the participants at the top of the leaderboard implicitly takes advantage of this difference in data distribution."}}