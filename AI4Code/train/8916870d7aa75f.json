{"cell_type":{"30bed3d7":"code","0ed06c5e":"code","498178df":"code","f87272ce":"code","68c7dfd1":"code","8450313e":"code","087a1144":"code","4c5bc2c5":"code","c4fe0f19":"code","4245a692":"code","0c131d79":"code","c3600624":"code","aa7f9015":"code","fe2eeb4c":"code","fd2ada86":"code","83d4eb9a":"code","e19d8bab":"code","f45345e5":"code","56b63aa4":"code","6b2b4af2":"code","a29f3184":"code","b321565d":"code","36ae7ec4":"code","9931bdbf":"code","a3bf3352":"code","a5a2e54e":"code","47c2f685":"code","a3b8d597":"code","95f5e50a":"code","7f50a1ee":"code","fc103107":"code","0e566233":"code","9fd1e881":"code","1e1ab073":"code","d370b12d":"code","d4afc0c8":"code","fc1ec7e1":"code","35d2ac58":"code","2ed8cbe0":"markdown","27feaf9d":"markdown","41afd396":"markdown","146f0879":"markdown","1e425c53":"markdown","7f3e17c7":"markdown","c44a92f6":"markdown","80a1f5bb":"markdown","4cf1a17c":"markdown","79c70462":"markdown","875cb2b7":"markdown","156e28ba":"markdown","1fc2ec24":"markdown","04e1b2cf":"markdown","13cd67f8":"markdown","bf6e2e78":"markdown","98464e9d":"markdown","e53b2769":"markdown","2ae09313":"markdown","2af72b0f":"markdown","604555bc":"markdown","3d38d059":"markdown","89549c42":"markdown","4e6813d1":"markdown","ba2b9d45":"markdown","a068efd9":"markdown","ed59513e":"markdown","b8602bd7":"markdown","b54ebe91":"markdown","0a1de2fa":"markdown","8fca9041":"markdown","54bc7ad0":"markdown","4b8254f7":"markdown","aa3bf942":"markdown"},"source":{"30bed3d7":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nplt.rcParams['font.size']= 14\nplt.rcParams['figure.figsize']= [10,7]\n\n\n\ndf = pd.read_csv('..\/input\/used-car-dataset-ford-and-mercedes\/hyundi.csv')\nprint(df.shape)\ndf.head(10)","0ed06c5e":"df.describe()","498178df":"df.info()","f87272ce":"df.duplicated().sum()","68c7dfd1":"df.mpg.value_counts()","8450313e":"#problem 3\ndf.drop(df[(df.mpg == 1.1) | (df.mpg == 256.8)].index, inplace= True)\n#problem 2\ndf.rename(columns= {'tax(\u00a3)': 'tax'}, inplace= True)\n#problem 1\ndf.drop(df[df.engineSize == 0].index, inplace= True)","087a1144":"df['age'] = 2021 - df['year']\ndf.head()","4c5bc2c5":"fig, ax = plt.subplots(figsize= (10,7))\nsns.heatmap(df.corr(), annot= True, linewidth= 1, ax=ax)","c4fe0f19":"fig, ax = plt.subplots(figsize= (10,7))\nax.scatter(data= df, x='age', y='price')\nax.set_title('Age vs Price')\nax.set_ylabel('Price')\nax.set_xlabel('Age')","4245a692":"df[df.price > 80000]","0c131d79":"df[(df.model == ' I10') & (df.year == 2017)].price.max()","c3600624":"df.loc[df.price > 80000, 'price'] = 9200","aa7f9015":"df[df.price > 80000]","fe2eeb4c":"fig, ax = plt.subplots(figsize= (10,7))\nax.bar(df.transmission, df.price)\nax.set_title('Transmission vs Price')\nax.set_ylabel('Price')\nax.set_xlabel('Transmission')\nfig.show()","fd2ada86":"most_year = df.year.value_counts().index[0]\nmost_model = df[df.year == most_year].model.value_counts().index[0]\nprint(most_year, most_model)","83d4eb9a":"tucson_17 = df[(df.year == most_year) & (df.model == most_model)]\ntucson_17","e19d8bab":"fig, ax = plt.subplots(figsize= (10,7))\nax.scatter(tucson_17.mileage, tucson_17.price)\nax.set_title('Mileage vs Price')\nax.set_ylabel('Price')\nax.set_xlabel('Mileage')\nfig.show()","f45345e5":"fig, ax = plt.subplots(figsize= (10,7))\nax.bar(df.fuelType, df.price)\nax.set_title('Fuel Type vs Price')\nax.set_ylabel('Price')\nax.set_xlabel('Fuel Type')\nfig.show()","56b63aa4":"fig, ax = plt.subplots(figsize= (10,7))\nsns.countplot(x='fuelType', data=df, ax=ax)\nfig.show()","6b2b4af2":"fig, ax = plt.subplots(figsize= (10,7))\nax.bar(df.age, df.tax)\nax.set_title('Age vs Tax')\nax.set_ylabel('Tax')\nax.set_xlabel('Age')\nfig.show()","a29f3184":"fig, ax = plt.subplots(figsize= (10,7))\nax.scatter(df.transmission, df.tax)\nax.set_title('Transmission vs Tax')\nax.set_ylabel('Tax')\nax.set_xlabel('Transmission')\nfig.show()","b321565d":"df[df.tax >= 500]","36ae7ec4":"df[df.model == ' Santa Fe'].tax.value_counts()","9931bdbf":"df[df.engineSize >= 2.4].tax.value_counts()","a3bf3352":"df.drop(df[df.tax == 555].index, inplace= True)","a5a2e54e":"fig, ax = plt.subplots(figsize= (10,7))\nax.scatter(df.engineSize, df.mpg)\nax.set_title('Engine Size vs Consumption')\nax.set_ylabel('MPG')\nax.set_xlabel('Engine Size')\nax.set_xlim(0.5,3)\nfig.show()","47c2f685":"fig, ax = plt.subplots(figsize= (10,7))\nax.scatter(df.engineSize, df.price)\nax.set_title('Engine Size vs Consumption')\nax.set_ylabel('MPG')\nax.set_xlabel('Engine Size')\nax.set_xlim(0.5,3)\nfig.show()","a3b8d597":"df_model = df.copy()\ndf_model['total_price'] = df.price + df.tax\ndf_model.drop(columns = ['price', 'tax', 'year'], inplace= True)\ndf_model.head()","95f5e50a":"df_model.model.value_counts()","7f50a1ee":"df_model.transmission.value_counts()","fc103107":"df_model.fuelType.value_counts()","0e566233":"df_model = pd.get_dummies(df_model, columns= ['model', 'transmission', 'fuelType'], drop_first= True)\ndf_model","9fd1e881":"#Our model features\nX = df_model.drop(columns= 'total_price')\n#Our predicted feature\ny= df_model.total_price\n\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size= 0.4, random_state= 27)","1e1ab073":"from sklearn.linear_model import LinearRegression\n\nlr_model = LinearRegression()\n\nlr_model.fit(X_train, y_train)","d370b12d":"pred_total_price = lr_model.predict(X_test)","d4afc0c8":"coef = pd.DataFrame(lr_model.coef_, index= X_train.columns)\ncoef","fc1ec7e1":"lr_model.intercept_","35d2ac58":"from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error\n\nmse = mean_squared_error(y_test, pred_total_price)\nrmse = np.sqrt(mse)\nmae = mean_absolute_error(y_test, pred_total_price)\nr2 = r2_score(y_test, pred_total_price)\n\nlabels = ['Mean-Squared-Error','Root-Mean-Squared-Error','Mean-Absolute-Error','R^2 Score']\n\neval_model = pd.DataFrame([mse, rmse, mae, r2], index= labels)\npd.options.display.float_format = \"{:f}\".format\neval_model","2ed8cbe0":"## 6.How does the road tax affected by car age and transmission type?\n\n<p align=\"center\">\n  <img width=\"800\" height=\"600\" alt=\"tarnsmission stick\" src=\"https:\/\/www.stockvault.net\/data\/2018\/07\/30\/253496\/preview16.jpg\">\n<\/p>","27feaf9d":"The cars with diesel fuel seem to be more expensive than the petrol although more cars are using petrol as a fuel type.\n\nThat may be because diesel nowadays costs more the petrol.","41afd396":"Prices are increasing with increment in the engine size however we have cars with high engine size with lower price maybe because they are old or have high mileage.\n\nNow let's start our journey to the price prediction model.\n\n# Linear Regression Price Prediction Model:\n\nWe are interested to build a linear regression model that helps us to predict the price of used Hyundai cars in the future.\n\nLinear Regression is one of the algorithms of machine learning that helps in predicting numerical features but if we have a key feature as categorical we need to create what is called dummies variables for these features.\n\nAlso, we need to calculate the total price for our data to predict the total price too so we will create a new feature that sums the price of the car and its tax.\n\nLet's start our job.\n\n## Get the data ready for the model:\n\n### 1. Total Price Feature:","146f0879":"Here, as you can see the more cars get older, the more drop in the price.\n\nThis is logically to happen for cars.\n\n*Note: we can observe an outlier in the age of 4 that has a very high price, actually the highest in our data and we need to investigate it*","1e425c53":"## 7.How does the fuel consumbtion rate affected by engine size?\n\n<p align=\"center\">\n  <img width=\"800\" height=\"600\" alt=\"tarnsmission stick\" src=\"https:\/\/www.maxpixel.net\/static\/photo\/1x\/Petrol-Tank-Full-Fuel-Fuel-Gauge-Ad-Gas-Empty-70507.jpg\">\n<\/p>","7f3e17c7":"# Introduction:\n\nHyundai is one of the biggest lead car brands for the mid-wealth people around the world, it's established in South Korea in 1967 and since then its cars keep hitting the market with special average exterior designs and suitable prices.\n\nToday we are gonna explore the dataset of **Hyundai** used cars to learn more about the following questions:\n- What is the relation between dataset features and how are they correlated?\n- How does the age of the car affect its price?\n- How does the transmission type affect the price?\n- Does the milage of the same car with the same age can change the price?\n- How does the fuel type affect the price?\n- How does the road tax affected by car age and transmission type?\n- How does the fuel consumption rate affected by engine size?\n- How does the engine size affect the price?\n\nPrice is one of the most aspects and keys to be studied before selling or buying used cars and the relation between it and the status of the car health and specs is important.\n\nAfter exploring our data and answering our questions we are gonna try to build a price prediction model and evaluate it.\n\n#### Let's get started...\n***\n\n# Discover the data:","c44a92f6":"### 2. Dummies:\n\nLet's first see each categorical feature's unique values again to understand what will be the shape of our dataframe for the model after creating the dummies variable.","80a1f5bb":"## 8. How does the engine size affect the price?\n\n<p align=\"center\">\n  <img width=\"800\" height=\"600\" alt=\"tarnsmission stick\" src=\"https:\/\/live.staticflickr.com\/6106\/6309884152_6e4851b41a_b.jpg\">\n<\/p>","4cf1a17c":"## Seperate Data to Train and Test Data:","79c70462":"## Predict Total Price:\n\n<p align=\"center\">\n  <img width=\"800\" height=\"600\" alt=\"tarnsmission stick\" src=\"https:\/\/cdn.pixabay.com\/photo\/2017\/08\/21\/15\/55\/money-2665824_1280.jpg\">\n<\/p>","875cb2b7":"## 3.How does the transmission type affect the price?\n\n<p align=\"center\">\n  <img width=\"800\" height=\"600\" alt=\"tarnsmission stick\" src=\"https:\/\/cdn.pixabay.com\/photo\/2015\/07\/31\/11\/36\/shift-868980_1280.jpg\">\n<\/p>","156e28ba":"## 1. What is the relation between dataset features and how are they correlated?","1fc2ec24":"## 2. How does the age of the car affect its price?\n\n<p align=\"center\">\n  <img width=\"800\" height=\"600\" alt=\"Hyundai old car\" src=\"https:\/\/upload.wikimedia.org\/wikipedia\/commons\/b\/bf\/My_New_Car_Hyundai_i30_-_August_2009_%283831038685%29.jpg\">\n<\/p>","04e1b2cf":"## Train The model:","13cd67f8":"So the largest sample to check our answer is the **Tucson 2017 Model**, Let's split its data.","bf6e2e78":"We see that there are 4 cars with mpg equal to **1.1** that are impossible, and 3 cars with mpg equal to **256.8** that are high value. \n\nI choose to drop them as they seem to be outliers.","98464e9d":"Let's see **I 10 2017 Models** max price in our dataset","e53b2769":"The two charts above show that the road tax is not affected by both transmission type or age.\n\n*Note: we can see an outlier car in our data set, Let's see it close to make a decision about it.*","2ae09313":"* We see that our data is clean and there are no null values.\n* We have the proper data types for our features.\n* Although we have **86 duplicate** records we can process our exploration normally without being worry.\n\nWe have three problems with our data:\n1. We have some records with **0 engine size** that we need to remove.\n2. The tax column has a euro sign that will make it hard to index and call it.\n3. We have a weird range in mpg records as the minimum value is **1.1** and the maximum value is **256.8**.\n\nLet's solve those problems from the last to the first one before get starting.","2af72b0f":"Let's check the road taxes for **Santa fe** cars and **2.4 engine** cars.","604555bc":"We can now say that there is a human mistake in collecting data from our investigation, Let's correct it.","3d38d059":"Now we can say that this car is absolutely an outlier and we will need to remove it to avoid problems with our linear regression model.","89549c42":"Transmission type reflects on the price of the car as the **Semi-Auto** cars are the highest in the prices rates and then comes **Automatic** cars.","4e6813d1":"We can see that our model R-square score is about **88%** and that's not bad for our model to predict the total price for the **Hyundai Cars**.","ba2b9d45":"## Coefficients and Intercept of the Model:","a068efd9":"## 4.Does the milage of the same car with the same age can change the price?\n\n<p align=\"center\">\n  <img width=\"800\" height=\"600\" alt=\"tarnsmission stick\" src=\"https:\/\/live.staticflickr.com\/1367\/4606495023_7a7719a312_b.jpg\">\n<\/p>\n\nLet's choose the most year with models and the most model to do investigation for this question.","ed59513e":"# EDA and Answeres:\n\nBefore getting into our questions' answers let's first create a new column for our cars' age.","b8602bd7":"## Evaluate our model:","b54ebe91":"We can tell that the mpg is not affected with engine size in our data as our sample starts to get low fuel consumption after engine size of 1.6L and this maybe not happened in the real-life, also we see that the highest consumption rate trophy goes to te cars with 1.6L engine size.","0a1de2fa":"## 5.How does fuel type affect the price?\n\n<p align=\"center\">\n  <img width=\"800\" height=\"600\" alt=\"tarnsmission stick\" src=\"https:\/\/p1.pxfuel.com\/preview\/492\/488\/949\/petrol-gasoline-diesel-gas.jpg\">\n<\/p>","8fca9041":"Creating dummies variables makes a new dummy feature for each categorical feature variable with the value of 0 or 1, also our method will drop the original categorical features and the first dummy feature.","54bc7ad0":"We can see from above that there are **positive correlation** between:\n- Price and Engine Size.\n- Mileage and Age.\nand **negative correlation** between:\n- Price and Mileage.\n- Price and Age.\n\na logical answer, isn't it?","4b8254f7":"<p align=\"center\">\n  <img width=\"800\" height=\"600\" alt=\"Hyundai Logo\" src=\"https:\/\/p1.pxfuel.com\/preview\/251\/598\/497\/car-hyundai-steering-wheel-vehicle.jpg\">\n<\/p>","aa3bf942":"Mileage is affecting the price slightly as the more mileage number the less is the price.\n\nHowever, it seems that the mileage is not a perfect factor by its own as we can see how our data are scattered."}}