{"cell_type":{"4827f02e":"code","321702d2":"code","44f5b42d":"code","f025dce4":"code","ce9311f0":"code","58c8b320":"code","9c877a9e":"code","3c7df9e8":"code","a9320447":"code","9c510c05":"code","12522c1a":"code","59eff777":"code","576f7f66":"code","fc4806bb":"code","e8be8c90":"code","66d071f9":"code","96f64a52":"code","5375575b":"code","c8b4e38d":"markdown","15eb5d88":"markdown","79382ead":"markdown","26bde040":"markdown","6a010225":"markdown","66d985fb":"markdown","067aa725":"markdown","a4a0f08e":"markdown","036e414f":"markdown","787a7726":"markdown","9357c175":"markdown","aae38db0":"markdown","8b08a717":"markdown","916986c8":"markdown","332500c6":"markdown","65b5e279":"markdown","09638c72":"markdown"},"source":{"4827f02e":"import numpy as np\nimport pandas as pd\n\nfrom sklearn.decomposition import PCA\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.linear_model import LogisticRegression\n\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.linear_model import LinearRegression\n\nimport matplotlib.pyplot as plt\n\nfrom math import sin\nfrom math import pi\nfrom numpy import arange\nfrom numpy import vstack\nfrom numpy import argmax\nfrom numpy import asarray\nfrom numpy.random import normal\nfrom numpy.random import random\nfrom scipy.stats import norm\nfrom sklearn.gaussian_process import GaussianProcessRegressor\nfrom warnings import catch_warnings\nfrom warnings import simplefilter\nfrom matplotlib import pyplot","321702d2":"path = \"..\/input\/star-type-classification\/Stars.csv\"\ndf = pd.read_csv(path)\ndf.head()","44f5b42d":"colors_to_idx = {v:k for k,v in enumerate(df['Color'].unique())}\nidx_to_colors = {k:v for k,v in enumerate(df['Color'].unique())}\n\nspectral_to_idx = {v:k for k,v in enumerate(df['Spectral_Class'].unique())}\nidx_to_spectral = {k:v for k,v in enumerate(df['Spectral_Class'].unique())}","f025dce4":"df['Color'].replace(colors_to_idx, inplace=True)\ndf['Spectral_Class'].replace(spectral_to_idx, inplace=True)","ce9311f0":"df.describe().T","58c8b320":"features = df.drop('Type', axis=1)\nlabels = df['Type']","9c877a9e":"mms = MinMaxScaler()\n\nfeatures = mms.fit_transform(features)","3c7df9e8":"pca = PCA(n_components=2, svd_solver='arpack')\nX_tr = pca.fit_transform(features)","a9320447":"pd.DataFrame(features).describe()","9c510c05":"plt.figure(figsize=(14,8))\n\ncolors = ['blue', 'red', 'green', 'brown', 'cyan', 'purple']\n\nfor i in range(len(colors)):\n    X, y = X_tr[list(df[df['Type'] == i].index)][:,0], X_tr[list(df[df['Type'] == i].index)][:,1]\n    plt.scatter(X, y, color=colors[i], marker='s')","12522c1a":"# Select the blue white star\nid = colors_to_idx['Blue white']\n\nX_orig, y_orig = X_tr[list(df[df['Type'] == id].index)][:,0], X_tr[list(df[df['Type'] == id].index)][:,1]\n    \nplt.figure(figsize=(14,8))\nplt.plot(X_orig, y_orig, 'bo')","59eff777":"X = X_orig.reshape(len(X_orig), 1)\ny = y_orig.reshape(len(y_orig), 1)","576f7f66":"degree = 16\npolyreg = make_pipeline(PolynomialFeatures(degree),LinearRegression())\npolyreg.fit(X,y)","fc4806bb":"plt.figure(figsize=(14,8))\nplt.plot(X, y, 'bo')\nplt.plot(X, polyreg.predict(X), 'ro')","e8be8c90":"model = GaussianProcessRegressor()\nmodel.fit(X, y)\n\nplt.figure(figsize=(14,8))\nplt.plot(X, y, 'bo')\nplt.plot(X, model.predict(X), 'ro')","66d071f9":"def surrogate(model, X):\n    '''\n        Surrogate or approximation for the objective function\n    '''\n    with catch_warnings():\n        # ignore generated warnings\n        simplefilter(\"ignore\")\n        return model.predict(X, return_std=True)\n \ndef acquisition(X, Xsamples, model):\n    '''\n        Probability of improvement acquisition function\n    '''\n    # calculate the best surrogate score found so far\n    yhat, _ = surrogate(model, X)\n    best = max(yhat)\n    # calculate mean and stdev via surrogate function\n    mu, std = surrogate(model, Xsamples)\n    mu = mu[:, 0]\n    # calculate the probability of improvement\n    probs = norm.cdf((mu - best) \/ (std+1E-9))\n    return probs\n \ndef opt_acquisition(X, y, model):\n    '''\n        Optimize the acquisition function\n    '''\n    # random search, generate random samples\n    Xsamples = random(100)\n    Xsamples = Xsamples.reshape(len(Xsamples), 1)\n    # calculate the acquisition function for each sample\n    scores = acquisition(X, Xsamples, model)\n    # locate the index of the largest scores\n    ix = argmax(scores)\n    return Xsamples[ix, 0]","96f64a52":"for i in range(10):\n    # select the next point to sample\n    x = opt_acquisition(X, y, model)\n    # sample the point\n    actual = polyreg.predict(np.array(x).reshape(1, -1))\n    # summarize the finding\n    est, _ = surrogate(model, [[x]])\n    if((i+1) % 1 == 0):\n        print('>x=%.3f, f()=%3f, actual=%.3f' % (x, est, actual))\n    # add the data to the dataset\n    X = vstack((X, [[x]]))\n    y = vstack((y, actual))\n    # update the model\n    model.fit(X, y)","5375575b":"plt.figure(figsize=(14,8))\nplt.plot(X_orig, y_orig, 'o', color='blue', label='original')\nplt.plot(X, model.predict(X), 'o', color='red', label='gaussian optimized')\nplt.xlim([-0.5, 1.0])\nplt.ylim([-0.4, 0.4])\nplt.legend()\nplt.show()","c8b4e38d":"## Features and labels","15eb5d88":"<h1 id=\"reference\" style=\"color:#463833; background:white; border:0.5px dotted #3490b8;\"> \n    <center>Reference\n        <a class=\"anchor-link\" href=\"#reference\" target=\"_self\">\u00b6<\/a>\n    <\/center>\n<\/h1>","79382ead":"<h1 id=\"extra\" style=\"color:#463833; background:white; border:0.5px dotted #3490b8;\"> \n    <center>Gaussian Optimization functions\n        <a class=\"anchor-link\" href=\"#extra\" target=\"_self\">\u00b6<\/a>\n    <\/center>\n<\/h1>","26bde040":"## Load Dataset","6a010225":"<h1 id=\"categorize\" style=\"color:#463833; background:white; border:0.5px dotted #3490b8;\"> \n    <center>Categorize Stars using PCA\n        <a class=\"anchor-link\" href=\"#categorize\" target=\"_self\">\u00b6<\/a>\n    <\/center>\n<\/h1>","66d985fb":"<div width=\"100%\">\n    <img width=\"100%\" src=\"https:\/\/storage.googleapis.com\/kaggle-datasets-images\/1247161\/2080258\/f00c5de7e83ea7287bc77aeb969b79ea\/dataset-cover.jpg\" \/>\n<\/div>","067aa725":"[Gaussian Optimization - Machine Learning Mastery](https:\/\/machinelearningmastery.com\/what-is-bayesian-optimization\/)","a4a0f08e":"<h1 id=\"dataset\" style=\"color:#463833; background:white; border:0.5px dotted #3490b8;\"> \n    <center>Dataset\n        <a class=\"anchor-link\" href=\"#dataset\" target=\"_self\">\u00b6<\/a>\n    <\/center>\n<\/h1>","036e414f":"## Min-Max Scaling","787a7726":"<h1 id=\"blue\" style=\"color:#463833; background:white; border:0.5px dotted #3490b8;\"> \n    <center>Blue White Star\n        <a class=\"anchor-link\" href=\"#blue\" target=\"_self\">\u00b6<\/a>\n    <\/center>\n<\/h1>","9357c175":"## Dimension reduction","aae38db0":"## Categorical encoding","8b08a717":"<h1 id=\"gaussian\" style=\"color:#463833; background:white; border:0.5px dotted #3490b8;\"> \n    <center>Gaussian Base training\n        <a class=\"anchor-link\" href=\"#gaussian\" target=\"_self\">\u00b6<\/a>\n    <\/center>\n<\/h1>","916986c8":"<h1 id=\"target\" style=\"color:#463833; background:white; border:0.5px dotted #3490b8;\"> \n    <center>Polynomial Regression\n        <a class=\"anchor-link\" href=\"#target\" target=\"_self\">\u00b6<\/a>\n    <\/center>\n<\/h1>\n\n<h3>Goal: Use polynomial regression to setup Gaussian target for optimization.<\/h3>","332500c6":"## Describe columns","65b5e279":"<h1 id=\"training\" style=\"color:#463833; background:white; border:0.5px dotted #3490b8;\"> \n    <center>Gaussian Optimization training\n        <a class=\"anchor-link\" href=\"#training\" target=\"_self\">\u00b6<\/a>\n    <\/center>\n<\/h1>","09638c72":"<h1 id=\"results\" style=\"color:#463833; background:white; border:0.5px dotted #3490b8;\"> \n    <center>Gaussian Optimization results\n        <a class=\"anchor-link\" href=\"#results\" target=\"_self\">\u00b6<\/a>\n    <\/center>\n<\/h1>"}}