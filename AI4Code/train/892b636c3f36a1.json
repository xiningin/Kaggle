{"cell_type":{"0219ba71":"code","a142e579":"code","e040d492":"code","ce269042":"code","d4285c07":"code","c01fdc96":"code","658c8fa9":"code","59a26d43":"markdown","ee7bc052":"markdown","902a419d":"markdown","35369a60":"markdown","34114f21":"markdown","b51b789c":"markdown","ffa9a545":"markdown"},"source":{"0219ba71":"import numpy as np\nimport pandas as pd\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.preprocessing import LabelEncoder\nfrom lightgbm import LGBMRegressor\n\ntrain = pd.read_csv(\"\/kaggle\/input\/30-days-of-ml\/train.csv\", index_col=0)\ntest = pd.read_csv(\"\/kaggle\/input\/30-days-of-ml\/test.csv\", index_col=0)","a142e579":"train.head()","e040d492":"le = LabelEncoder()\nfor i in train.iloc[:, 0:10].columns:\n    train[i] = le.fit_transform(train[i])\ntrain.head()","ce269042":"x = train.iloc[:, 0:24]\ny = train.iloc[:, 24]\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state=0)","d4285c07":"lgbm_parameters = {\n    'max_depth': 5,\n    'learning_rate': 0.05,\n    'metric': 'rmse', \n    'n_jobs': -1,\n    'n_estimators': 10000,\n    'reg_alpha': 17,\n    'reg_lambda': 21,\n    'colsample_bytree': 0.225,\n    'subsample': 0.75,\n    'num_leaves': 64,\n    'min_child_samples': 15,\n    'max_bin': 250\n}\n\nlgbm_model = LGBMRegressor(**lgbm_parameters)","c01fdc96":"lgbm_model.fit(x_train, y_train, early_stopping_rounds=75, eval_set=[(x_test, y_test)], verbose=False)\ny_pred = lgbm_model.predict(x_test)\nrmse = mean_squared_error(y_test, y_pred, squared=False)\nprint(\"RMSE for Light GBM:\" , rmse)","658c8fa9":"for i in test.iloc[:, 0:10].columns:\n    test[i] = le.fit_transform(test[i])\nfinal = lgbm_model.predict(test)\nfinal_out = pd.DataFrame({'Id': test.index, 'target': final})\nfinal_out.to_csv('submission.csv', index=False)","59a26d43":"#### Encoding categorical columns ","ee7bc052":"#### Creating train and test sets ","902a419d":"### Output generation","35369a60":"### Tuning Light GBM Model ","34114f21":"### Importing libraries and csv files ","b51b789c":"# Light GBM - Hyperparameters tuned ","ffa9a545":"#### Fit the model and predict "}}