{"cell_type":{"8c0851b8":"code","1090778e":"code","4299d84e":"code","06f55f83":"code","d5e620b4":"code","31de57e6":"code","d6bf9890":"code","15645e9b":"code","c0e834b4":"code","15d1f014":"code","2f85f487":"code","ac8f067b":"code","7de41677":"code","11a9fcf8":"code","cb9d1d0c":"markdown","e1bc0207":"markdown","fb3cef8c":"markdown","9425282b":"markdown","f531814d":"markdown","4f6577ac":"markdown","bf76cad8":"markdown","711b9306":"markdown","c2ce3e8a":"markdown","a7966091":"markdown","9aa80461":"markdown","76e47d0f":"markdown","9edb50a6":"markdown","e574363c":"markdown","01c2236f":"markdown","8664e08d":"markdown","80180e29":"markdown","b2553139":"markdown","84c68598":"markdown","97bb38a3":"markdown","6b7e0ff7":"markdown","7214329d":"markdown","8a2d867d":"markdown","3bf770f8":"markdown","6405e03d":"markdown","1d82410c":"markdown","262b0570":"markdown","a8b6e7bc":"markdown","259d89af":"markdown","3da90574":"markdown","c923cf36":"markdown","6337df70":"markdown","198cd42e":"markdown","74c56160":"markdown","74d1fcc0":"markdown"},"source":{"8c0851b8":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.cluster import KMeans\n\nimport warnings\nwarnings.filterwarnings('ignore')","1090778e":"df = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\ndf.head()","4299d84e":"print('Linhas: ', df.shape[0])\nprint('Colunas: ', df.shape[1])","06f55f83":"df.isnull().sum()","d5e620b4":"df.info()","31de57e6":"plt.figure(figsize=(16, 5))\n\nplt.subplot(1, 3, 1)\nsns.distplot(df['Annual Income (k$)'], color='g')\nplt.title('Renda anual')\n\nplt.subplot(1, 3, 2)\nsns.distplot(df['Age'])\nplt.title('Idade')\n\nplt.subplot(1, 3, 3)\nsns.distplot(df['Spending Score (1-100)'], color='r')\nplt.title('Pontua\u00e7\u00e3o')\n\nplt.show()","d6bf9890":"plt.figure(figsize=(5, 5))\n\nplt.pie(df.Gender.value_counts(), colors=['pink', 'lightblue'], explode=[0, 0.1], labels=['Feminino', 'Masculino'], autopct='%.2f%%')\nplt.title('G\u00eanero', fontsize=14)\nplt.show()","15645e9b":"plt.figure(figsize=(10, 6))\n\nsns.heatmap(df.corr(), vmin=-1, vmax=1, cmap='Blues', annot=True, linewidths=2, linecolor='black')\n\nplt.show()","c0e834b4":"sns.boxplot(df['Gender'], df['Spending Score (1-100)'], palette=['lightblue', 'pink'])\nplt.title('Gender vs Spending Score', fontsize = 20)\nplt.show()","15d1f014":"plt.figure(figsize=(15, 4))\n\nplt.subplot(1, 2, 1)\nmale_income = df.loc[df.Gender == 'Male', 'Annual Income (k$)']\nmale_score = df.loc[df.Gender == 'Male', 'Spending Score (1-100)']\nsns.kdeplot(male_income, color='b', shade=True)\nsns.kdeplot(male_score, color='g', shade=True)\nplt.title('Homem')\n\nplt.subplot(1, 2, 2)\nfemale_income = df.loc[df.Gender == 'Female', 'Annual Income (k$)']\nfemale_score = df.loc[df.Gender == 'Female', 'Spending Score (1-100)']\nsns.kdeplot(female_income, color='pink', shade=True)\nsns.kdeplot(female_score, color='g', shade=True)\nplt.title('Mulher')\n\nplt.legend()\nplt.tight_layout()\nplt.show()","2f85f487":"x = df.iloc[:, [2, 4]].values","ac8f067b":"plt.figure(figsize=(8, 4))\n# Within cluster sum o errors\n# Inicializa uma lista varia\nwcss = []\n\n# Itera entre 1 e 10 clusters\nfor i in range(1, 11):\n    # Cria uma inst\u00e2ncia do KMeans\n    kmeans = KMeans(n_clusters=i, init='k-means++', max_iter=500, n_init=10, random_state=42)\n    # Treina o modelo\n    kmeans.fit(x)\n    # Armazena a inertia na lista criada anteriormente\n    wcss.append(kmeans.inertia_)\n    \nplt.plot(range(1, 11), wcss)\nplt.xlabel('Quantidade de clusters')\nplt.grid(True)\nplt.show()","7de41677":"# modelo com 4 clusters\nkmeans = KMeans(n_clusters=4, init='k-means++', max_iter=500, n_init=10, random_state=42)\npreds = kmeans.fit_predict(x)","11a9fcf8":"plt.figure(figsize=(12, 8))\n\n# Aqui iremos visualizar os resultados dos 4 clusters\nplt.scatter(x[preds==0, 0], x[preds==0, 1], s=100, c='red', alpha=0.5, label='Comum')\nplt.scatter(x[preds==1, 0], x[preds==1, 1], s=100, c='green', alpha=0.5, label='Ideal')\nplt.scatter(x[preds==2, 0], x[preds==2, 1], s=100, c='blue', alpha=0.5, label='Usual')\nplt.scatter(x[preds==3, 0], x[preds==3, 1], s=100, c='cyan', alpha=0.5, label='Usual - Mais velho')\n\n# Centr\u00f3ides\nplt.title('Clusters da Idade', fontsize=14)\nplt.xlabel('Idade')\nplt.ylabel('Pontua\u00e7\u00e3o')\n\nplt.legend()\nplt.show()","cb9d1d0c":"# Modelagem","e1bc0207":"A recomenda\u00e7\u00e3o \u00e9 ter um olhar mais atento ao grupo **ideal**, tra\u00e7ando planos e estrat\u00e9gias para fideliza\u00e7\u00e3o.","fb3cef8c":"# An\u00e1lise dos dados","9425282b":"Como podemos ver, ap\u00f3s 4 **clusters**, a inercia decresce bem pouco, ou seja, n\u00e3o h\u00e1 uma mudan\u00e7a significante no seu valor.","f531814d":"O pandas classificou corretamente o tipo dos dados, por\u00e9m, caso fosse feita alguma aplica\u00e7\u00e3o de um modelo de **aprendizado supervisionado**, seria interessante transformar as vari\u00e1veis (menos \"Annual Income (k$)\") em categ\u00f3ricas, e logo ap\u00f3s aplicar o \"Onehot Encoder\".","4f6577ac":"\u00c9 poss\u00edvel notar que quase n\u00e3o h\u00e1 clientes que ganham menos de **20k de d\u00f3lares anualmente**, enquanto h\u00e1 uma quantidade baixa de clientes que ganham mais que **110k de dol\u00e1res**. A maioria desses clientes ganha entre **50k e ~62k, e entre 75k e ~85k**.","bf76cad8":"O objetivo desse notebook \u00e9 analisar alguns dados sobre os clientes de um shopping e depois aplicar um algoritmo de **aprendizado n\u00e3o-supervisionado** com intuito de agrupar os clientes em \"clusters\". Pela natureza desse tipo de aprendizado, note que n\u00e3o haver\u00e1 uma coluna alvo (target), e sim a utiliza\u00e7\u00e3o de todas as \"features\" para realizar o agrupamento.","711b9306":"#### Shape","c2ce3e8a":"### G\u00eanero vs Pontua\u00e7\u00e3o","a7966091":"Mais homens possuem um ganho anual maior, por\u00e9m suas pontua\u00e7\u00f5es s\u00e3o um pouco mais baixas que as das mulheres, que possuem uma renda anual menor.","9aa80461":"Como j\u00e1 esperado de um conjunto de dados t\u00e3o pequeno, n\u00e3o h\u00e1 dados nulos.","76e47d0f":"#### Elbow Method","9edb50a6":"# Bibliotecas necess\u00e1rias","e574363c":"#### Renda anual","01c2236f":"### Quantidade de clientes por g\u00eanero","8664e08d":"### Distribui\u00e7\u00e3o de algumas \"features\"","80180e29":"Assemelha-se \u00e0 uma distribui\u00e7\u00e3o normal. A maior parte dos clientes possuem pontua\u00e7\u00f5es ~45 e ~55.","b2553139":"# Conclus\u00e3o","84c68598":"N\u00e3o h\u00e1 muita diferen\u00e7a nas pontua\u00e7\u00f5es quando se trata do g\u00eanero, mas \u00e9 poss\u00edvel ver que as mulheres normalmente est\u00e3o melhores pontuadas.","97bb38a3":"### Distribui\u00e7\u00e3o de renda anual vs Pontua\u00e7\u00e3o","6b7e0ff7":"# Introdu\u00e7\u00e3o","7214329d":"Iremos utilizar as colunas **Gender, Age e Annual Income (k$)** para efeturar o treinamento e verificar o n\u00famero de clusters.","8a2d867d":"#### Treinamento final","3bf770f8":"#### Pontua\u00e7\u00e3o","6405e03d":"H\u00e1 uma diferen\u00e7a de 12% entr os g\u00eaneros, onde o p\u00fablico feminino representa a maioria dos clientes. ","1d82410c":"#### Dados nulos","262b0570":"H\u00e1 picos entre **20 anos e 50 anos**, por\u00e9m acima disso a quantidade de clientes \u00e9 bem baixa.","a8b6e7bc":"De acordo com o gr\u00e1fico, podemos observar 4 clusters distintos os quais classifiquei como:\n- Cluster 1 (verde): s\u00e3o os clientes **ideais**. S\u00e3o jovens, e com pontua\u00e7\u00f5es mais altas, fato provavelmente causado pela disposi\u00e7\u00e3o em gastar dinheiro\n- Cluster 2 (vermelho): s\u00e3o os clientes **comuns**, ou seja, com idades diversas e pontua\u00e7\u00f5es mais baixas. S\u00e3o aqueles que provavelmente fizeram poucas compras\n- Cluster 3 (azul): s\u00e3o os clientes **usuais**. S\u00e3o jovens e jovens adultos, e possuem pontua\u00e7\u00f5es medianas\n- Cluster 4 (ciano): tamb\u00e9m s\u00e3o clientes **usuais**, por\u00e9m dessa vez com mais idade.","259d89af":"#### Idade","3da90574":"Apesar desse mapa de calor n\u00e3o nos dar muitas informa\u00e7\u00f5es \u00fateis, \u00e9 interessante notar essa correla\u00e7\u00e3o negativa entre a **idade** e a **pontua\u00e7\u00e3o**, ou seja, quanto mais velho o cliente, menor sua pontua\u00e7\u00e3o, provavelmente pelo fato de fazer menos compras.","c923cf36":"Entenda as colunas como:\n- **CustomerID**: identificador \u00fanico de cada cliente\n- **Gender**: g\u00eanero do cliente\n- **Age**: idade do cliente\n- **Annual Income (k$**): renda anual do cliente\n- **Spending Score (1-100)**: pontua\u00e7\u00e3o atribu\u00edda pelo shopping com base no comportamento do cliente e natureza dos gastos.","6337df70":"Durante a cria\u00e7\u00e3o de nosso modelo, utilizaremos o **KMeans**, al\u00e9m do **Elbow method** para mensurar o melhor n\u00famero de clusters. Para saber mais sobre isso, consulte:\n- [Kmeans](https:\/\/www.geeksforgeeks.org\/k-means-clustering-introduction)\n- [Elbow Method](https:\/\/www.geeksforgeeks.org\/elbow-method-for-optimal-value-of-k-in-kmeans)\n- [Evaluating Clusters](https:\/\/medium.com\/@ODSC\/unsupervised-learning-evaluating-clusters-bd47eed175ce)","198cd42e":"\u00c9 um conjunto de dados relativamente pequeno, n\u00e3o s\u00f3 em quest\u00e3o de linhas, mas tamb\u00e9m com poucas \"features\".","74c56160":"### Correla\u00e7\u00f5es","74d1fcc0":"#### Info"}}