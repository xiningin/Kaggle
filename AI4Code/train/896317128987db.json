{"cell_type":{"0b23a690":"code","c21d5869":"code","1bd75cda":"code","0190a4ad":"code","d18e1964":"code","09460a7d":"code","4ba4668b":"code","15cc34d8":"code","fdb37bee":"code","d31a2c9a":"code","e80b4a56":"code","810df391":"code","d37cff92":"code","fd39c67f":"code","72d067ba":"code","850929e5":"code","35ee74dc":"code","49d609f0":"code","c5332b47":"code","932ce510":"code","a0deea99":"code","bd9c9a02":"code","575efe48":"code","b4031a4e":"code","4ee7a44c":"code","ca372d4e":"code","1a51dd1e":"code","6b69d52c":"code","5236cf97":"code","48012e57":"code","d775331a":"code","5ceaacbb":"code","c7620f49":"code","393f202e":"code","d9da91a7":"code","d40e66bd":"code","ec72f737":"code","92c99aac":"code","7dca0c01":"code","b5392d33":"code","bc5eb590":"markdown","64a8db3a":"markdown","60f144fa":"markdown","b45609ed":"markdown","bbe64ae6":"markdown","984478d1":"markdown","1206945c":"markdown","3d594cf5":"markdown","28fc331f":"markdown","4084683d":"markdown","b7cc1aa6":"markdown","db33cda2":"markdown","c2c8aa10":"markdown"},"source":{"0b23a690":"import numpy as np\nimport pandas as pd\nimport tensorflow as tf\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom tensorflow import keras\n%matplotlib inline","c21d5869":"data = pd.read_csv(\"..\/input\/Skyserver_SQL2_27_2018 6_51_39 PM.csv\")","1bd75cda":"data.head()","0190a4ad":"# drop the object id columns, they are of no use in the analysis\ndata.drop(['objid','specobjid'], axis=1, inplace=True)","d18e1964":"data.head()","09460a7d":"sns.countplot(x=data['class'])","4ba4668b":"def change_category_to_number(classCat):\n    if classCat=='STAR':\n        return 0\n    elif classCat=='GALAXY':\n        return 1\n    else:\n        return 2","15cc34d8":"# assign a numerical value to the categorical field of class, by using the above function\ndata['classCat'] = data['class'].apply(change_category_to_number)","fdb37bee":"data.head()","d31a2c9a":"sns.pairplot(data[['u','g','r','i']])","e80b4a56":"data.drop(['run','rerun','camcol','field','class'],axis=1,inplace=True)","810df391":"data.head()","d37cff92":"data.dtypes","fd39c67f":"X = data.drop('classCat', axis=1)\ny = data['classCat']","72d067ba":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=128)","850929e5":"dtClassifer = DecisionTreeClassifier(max_leaf_nodes=15,random_state=0)","35ee74dc":"dtClassifer.fit(X_train, y_train)","49d609f0":"prediction = dtClassifer.predict(X_test)","c5332b47":"prediction[:10]","932ce510":"y_test[:10]","a0deea99":"accuracy_score(y_true=y_test, y_pred=prediction)","bd9c9a02":"lrClassifier = LogisticRegression()","575efe48":"lrClassifier.fit(X_train,y_train)","b4031a4e":"prediction = lrClassifier.predict(X_test)","4ee7a44c":"prediction[:10]","ca372d4e":"y_test[:10]","1a51dd1e":"accuracy_score(y_true=y_test, y_pred=prediction)","6b69d52c":"featcols = [tf.feature_column.numeric_column('ra'),\n            tf.feature_column.numeric_column('dec'),\n            tf.feature_column.numeric_column('u'),\n            tf.feature_column.numeric_column('g'),\n            tf.feature_column.numeric_column('r'),\n            tf.feature_column.numeric_column('i'),\n            tf.feature_column.numeric_column('z'),\n            tf.feature_column.numeric_column('redshift'),\n            tf.feature_column.numeric_column('plate'),\n            tf.feature_column.numeric_column('mjd'),\n            tf.feature_column.numeric_column('fiberid')\n           ]","5236cf97":"model = tf.estimator.LinearClassifier(n_classes=3,\n                                      optimizer=tf.train.FtrlOptimizer(l2_regularization_strength=0.1,learning_rate=0.01),\n                                     feature_columns=featcols)","48012e57":"data.head()","d775331a":"def get_input_fn(num_epochs,n_batch,shuffle):\n    return tf.estimator.inputs.pandas_input_fn(\n        x=X_train,\n        y=y_train,\n        batch_size=n_batch,\n        num_epochs=num_epochs,\n        shuffle=shuffle\n    )","5ceaacbb":"model.train(input_fn=get_input_fn(100,128,True),steps=1000)","c7620f49":"def evaluate_fn(num_epochs,n_batch,shuffle):\n    return tf.estimator.inputs.pandas_input_fn(\n        x=X_test,\n        y=y_test,\n        batch_size=n_batch,\n        num_epochs=num_epochs,\n        shuffle=shuffle\n    )","393f202e":"model.evaluate(input_fn=evaluate_fn(100,128,True),steps=1000)","d9da91a7":"dnn_model = tf.estimator.DNNClassifier(n_classes=3,\n                                       feature_columns=featcols,\n                                       hidden_units=[1024,512,256,32,3],\n                                       activation_fn=tf.nn.relu,\n                                       optimizer='Adam',\n                                       dropout=0.2,\n                                      )","d40e66bd":"dnn_model.train(input_fn=get_input_fn(100,128,True),steps=1000)","ec72f737":"dnn_model.evaluate(input_fn=evaluate_fn(100,128,True),steps=1000)","92c99aac":"dnnlcc_model = tf.estimator.DNNLinearCombinedClassifier(n_classes=3,dnn_activation_fn='relu',dnn_dropout=0.2,dnn_hidden_units=[1024,512,256,32,3],dnn_optimizer='Adam',dnn_feature_columns=featcols,linear_feature_columns=featcols)","7dca0c01":"dnnlcc_model.train(input_fn=get_input_fn(100,128,True),steps=1000)","b5392d33":"dnnlcc_model.evaluate(input_fn=evaluate_fn(100,128,True),steps=1000)","bc5eb590":"### Measure accuracy of the classifier","64a8db3a":"# Sloan Digital Sky Survey","60f144fa":"### Prediction on test data","b45609ed":"### Measure accuracy of the model","bbe64ae6":"### Perform train and test split","984478d1":"# Neural Network using Tensorflow and Keras","1206945c":"### DNN Classifier","3d594cf5":"### Linear Classifier ","28fc331f":"## Decision Tree Classifier","4084683d":"For Deep Neural Network to work better, you need more dataset.","b7cc1aa6":"### Prediction on test data","db33cda2":"## Logistic Regression Classifier","c2c8aa10":"### DNN Linear Combined Classifier"}}