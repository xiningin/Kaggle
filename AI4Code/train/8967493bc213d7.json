{"cell_type":{"f42adfb2":"code","15074530":"code","3e5e6ae0":"code","138d0cf4":"code","cced0763":"code","4ca81bd1":"code","5e440794":"code","2c5e5c84":"code","97ec52e3":"code","412c2a58":"code","42360edb":"code","b920b29d":"code","527799dc":"code","e4ac8523":"code","fc52a72f":"code","7b6908ab":"code","9ca07b70":"code","de812a62":"code","9d8fa2b9":"code","6d1e7041":"code","f203b593":"code","59f17821":"code","1c93429c":"code","8cf7d551":"code","f8368f1a":"code","38eef78b":"code","52b6266a":"code","c6e2cfcc":"code","aaac58f6":"code","1f011aeb":"code","094ca0a2":"code","70ebd093":"code","dc85c30a":"code","a9894a35":"code","a99db903":"code","09a16fe3":"code","586ba0ea":"code","d91b9fed":"markdown","2144ada5":"markdown","3de9226b":"markdown","8da5fa43":"markdown","5b07c0d1":"markdown","f0d9c6f8":"markdown","31ca5dfc":"markdown","cab2136f":"markdown","bf010423":"markdown","b5d27230":"markdown","5a9875f7":"markdown","5407f0e5":"markdown","830da546":"markdown","6528d9db":"markdown","42a9c513":"markdown"},"source":{"f42adfb2":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","15074530":"import matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(rc={'figure.figsize':(11.7,8.27)})","3e5e6ae0":"df = pd.read_csv('\/kaggle\/input\/insurance\/insurance.csv')","138d0cf4":"df.head()","cced0763":"df.info()","4ca81bd1":"df.shape","5e440794":"df.isnull().sum()","2c5e5c84":"df.head()\n","97ec52e3":"df['sex'].value_counts()","412c2a58":"df['sex'].value_counts().plot(kind='bar')","42360edb":"df['region'].value_counts().plot(kind='pie')","b920b29d":"df['smoker'].value_counts().plot(kind='bar')","527799dc":"df.groupby('smoker')['charges'].mean()","e4ac8523":"df.groupby('children')['charges'].mean()","fc52a72f":"sns.countplot(data=df,x='region',hue='smoker')","7b6908ab":"df['children'].value_counts().plot(kind='bar')","9ca07b70":"sns.countplot(x='sex',hue='smoker',data=df)","de812a62":"from sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import r2_score","9d8fa2b9":"df = pd.get_dummies(df,drop_first=True)","6d1e7041":"df.head()","f203b593":"cols=['age','bmi','children','sex_male','smoker_yes','region_northwest','region_southeast','region_southwest','charges']\ndf = df[cols]","59f17821":"df.head()","1c93429c":"X=df.iloc[:,:-1].values\ny=df.iloc[:,-1].values\ny = y.reshape(-1,1)","8cf7d551":"from sklearn.preprocessing import StandardScaler\nsc_X = StandardScaler()\nsc_y = StandardScaler()\nX = sc_X.fit_transform(X)\ny = sc_y.fit_transform(y)","f8368f1a":"print(X.shape,y.shape)","38eef78b":"X_train,X_test,y_train,y_test = train_test_split(X,y,train_size=0.2)","52b6266a":"from sklearn.linear_model import LinearRegression\nmodel = LinearRegression()\nmodel.fit(X_train,y_train)\ny_pred = model.predict(X_test)","c6e2cfcc":"print(model.score(X_test,y_test))\n","aaac58f6":"from sklearn.svm import SVR\nregressor = SVR(kernel='rbf')\nregressor.fit(X_train,y_train)","1f011aeb":"y_pred = regressor.predict(X_test)","094ca0a2":"regressor.score(X_test,y_test)","70ebd093":"from sklearn.tree import DecisionTreeRegressor\nregressor = DecisionTreeRegressor(random_state=0)\nregressor.fit(X_train,y_train)","dc85c30a":"y_pred = regressor.predict(X_test)","a9894a35":"regressor.score(X_test,y_test)","a99db903":"from sklearn.ensemble import RandomForestRegressor\nregressor = RandomForestRegressor(n_estimators=200,random_state=0)\nregressor.fit(X_train,y_train)","09a16fe3":"y_pred = regressor.predict(X_test)","586ba0ea":"regressor.score(X_test,y_test)","d91b9fed":"# Looks like random forest regressor works best for this dataset but you can also use XGBoost,GradientBoost,AdaBoost and other regressors to improve the performance of the model","2144ada5":"# 2.Support Vector Regression(SVR)","3de9226b":"# --------------------------------------------------------------------------------","8da5fa43":"**Lets Build a cost predicting model**","5b07c0d1":"# 1.Linear Regression","f0d9c6f8":"# 74.65% Accuracy.","31ca5dfc":"# 80.21% Accuracy.","cab2136f":"# 82.18% Accuracy.","bf010423":"# 3.Decision Tree.","b5d27230":"# ----------------------------------------------------------------------------","5a9875f7":"# Exploratory Data Analysis. ","5407f0e5":"# From the EDA we can infer that the dataset is not skewed or imbalanced.\n# And also smokers have more insurance cost as compared to non-smokers and female smokers are less as compared to male smokers.Also in each region there are almost equal number of smokers.","830da546":"# 4.Random Forest Regressor","6528d9db":"# 70.15% Accuracy.","42a9c513":"#  We do not have any null values so no need of handling missing Data."}}