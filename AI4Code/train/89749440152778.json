{"cell_type":{"6784b8f6":"code","fe1f14c4":"code","105b6874":"code","702aa65b":"code","a547b359":"code","11a01e17":"code","a279b74f":"code","0d9d0a79":"code","2399c574":"code","ebc53eba":"code","0c9c03ec":"code","5c3d97dd":"code","49473441":"code","ad8334e2":"code","3e33f47c":"code","bbf5bf71":"code","a215797c":"code","a1bf5e0c":"code","06822767":"code","d3d7161c":"code","4d5297c7":"code","9ee1d3c2":"code","b0dec1b7":"code","c94aa00e":"code","a2af9f96":"code","58f6bf16":"code","32ce7160":"code","8b760a85":"code","30308efc":"code","218f6f79":"markdown","e6a1f61d":"markdown","5de21924":"markdown","22f6d7c0":"markdown","2b40d3ff":"markdown","d1de215d":"markdown","e02f4933":"markdown","67212b98":"markdown","50721ea3":"markdown","d4237eb2":"markdown","7dc09fe9":"markdown"},"source":{"6784b8f6":"import os\nimport numpy as np\nimport pandas as pd\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\nimport seaborn as sns","fe1f14c4":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","105b6874":"df = pd.read_csv('\/kaggle\/input\/ds_SSP_MonthlyOccurences_SP-BR_utf8_2001-2020.csv',low_memory=False)\ndf.shape","702aa65b":"df.head()","a547b359":"df.Natureza.value_counts()","11a01e17":"df.info()","a279b74f":"df.Jun.value_counts()","0d9d0a79":"df = df.replace('...', 0.0)","2399c574":"df['Jun'] = df['Jun'].astype('float64')\ndf['Jul'] = df['Jul'].astype('float64')\ndf['Ago'] = df['Ago'].astype('float64')\ndf['Set'] = df['Set'].astype('float64')\ndf['Out'] = df['Out'].astype('float64')\ndf['Nov'] = df['Nov'].astype('float64')\ndf['Dez'] = df['Dez'].astype('float64')","ebc53eba":"df.info()","0c9c03ec":"df_hom_dol_sampa = df[(df.Natureza == 'HOMIC\u00cdDIO DOLOSO (2)') & (df.Cidade == 'S\u00e3o Paulo')].sort_values('Ano')\ndf_hom_dol_sampa.head(2)","5c3d97dd":"plt.figure(figsize=(10, 5))\nsns.barplot(x='Ano', y='Total', data=df_hom_dol_sampa, color='firebrick')\nplt.xticks(rotation=90)\nplt.title('Homic\u00eddios Dolosos - Cidade de S\u00e3o Paulo', fontsize=14)\nplt.xlabel('Ano', fontsize=10)\nplt.ylabel('N\u00famero de homic\u00eddios', fontsize=10);","49473441":"def plot_ssp_crimes(df, type_occurrence, city, graph='Total'):\n    dt = df[(df.Natureza == type_occurrence)\n                          & (df.Cidade == city)].sort_values('Ano')\n\n    plt.figure(figsize=(10, 5))\n    sns.barplot(x='Ano', y=graph, data=dt, color='firebrick')\n    plt.xticks(rotation=90)\n    \n    if type_occurrence[-1] == ')': \n        title = type_occurrence[:-4]\n    else:\n        title = type_occurrence\n    plt.title('{} em {}'.format(title, city), fontsize=14)\n    plt.xlabel('Ano', fontsize=10)\n    plt.ylabel('N\u00famero de ocorr\u00eancias', fontsize=10);","ad8334e2":"plot_ssp_crimes(df, 'ROUBO DE CARGA', 'Campinas', graph='Total')","3e33f47c":"plot_ssp_crimes(df, 'TOTAL DE ESTUPRO (4)', 'Osasco', graph='Total')","bbf5bf71":"df_sampa = df[(df.Cidade == 'S\u00e3o Paulo')].sort_values('Ano')\ndt = df_sampa.groupby(['Natureza','Ano']).sum()","a215797c":"dt.isnull().sum()","a1bf5e0c":"dt.head(10)","06822767":"dt = dt.T\ndt.head(2)","d3d7161c":"list(df.Natureza.unique())","4d5297c7":"hom_sp = dt['N\u00ba DE V\u00cdTIMAS EM HOMIC\u00cdDIO DOLOSO (3)'] + dt[\n    'HOMIC\u00cdDIO CULPOSO POR ACIDENTE DE TR\u00c2NSITO'] + dt[\n        'HOMIC\u00cdDIO CULPOSO OUTROS'] + dt['N\u00ba DE V\u00cdTIMAS EM LATROC\u00cdNIO']\nhom_sp","9ee1d3c2":"hom_sp = hom_sp.T.reset_index()\nhom_sp['Num. Month'] = [12 for _ in range(len(hom_sp))]\nhom_sp.at[18, 'Num. Month'] = 5\nhom_sp['HOMICIDIOS (M\u00e9dia Mensal)'] = (hom_sp['Total']\/hom_sp['Num. Month']).astype('int64')\nhom_sp","b0dec1b7":"def plot_sub_dataset(dt, type_occurrence, city):\n    plt.figure(figsize=(10, 5))\n    sns.barplot(x='Ano', y=type_occurrence, data=dt, color='firebrick')\n    plt.xticks(rotation=90);\n\n    plt.title('{} - {}'.format(type_occurrence, city), fontsize=14)\n    plt.xlabel('Ano', fontsize=10)\n    plt.ylabel('Casos', fontsize=10);","c94aa00e":"plot_sub_dataset(hom_sp, 'HOMICIDIOS (M\u00e9dia Mensal)', 'S\u00e3o Paulo')","a2af9f96":"def get_sub_dataset(df, type_occurrence, city):\n    dt = df[(df.Cidade == city)].sort_values('Ano')\n    dt = dt.groupby(['Natureza','Ano']).sum().T\n    dt = dt[type_occurrence].T.reset_index()\n    dt['Num. Month'] = [12 for _ in range(len(dt))]\n    dt.at[18, 'Num. Month'] = 5\n    dt['Total Year'] = dt.iloc[:, 1:13].sum(axis=1)\n    if type_occurrence[-1] == ')': \n        label = type_occurrence[:-4]+' (M\u00e9dia Mensal)'\n    else:\n        label = type_occurrence +' (M\u00e9dia Mensal)'\n    dt[label] = (dt['Total Year']\/dt['Num. Month']).astype('int64')\n    plot_sub_dataset(dt, label, city)\n    return dt","58f6bf16":"estupros_sp = get_sub_dataset(df, 'TOTAL DE ESTUPRO (4)', 'S\u00e3o Paulo')","32ce7160":"roubo_veiculo_sp = get_sub_dataset(df, 'ROUBO DE VE\u00cdCULO', 'S\u00e3o Paulo')","8b760a85":"roubo_veiculo_sp = get_sub_dataset(df, 'ROUBO DE VE\u00cdCULO', 'Osasco')","30308efc":"plt.figure(figsize=(10, 5))\nplt.plot(hom_sp['Ano'], hom_sp['HOMICIDIOS (M\u00e9dia Mensal)']);\nplt.plot(hom_sp['Ano'], estupros_sp['TOTAL DE ESTUPRO (M\u00e9dia Mensal)'])\nplt.xticks(rotation=90);\nplt.gca().set_xticks(hom_sp['Ano'].unique());\n\nplt.title('Medias Mensais de Homic\u00eddios versus Estupros na cidade de S\u00e3o Paulo', fontsize=14)\nplt.xlabel('Ano', fontsize=10)\nplt.ylabel('Casos', fontsize=10);","218f6f79":"`We must replace dots (...) bu 0.0 and convert all data to float`","e6a1f61d":"## Dataset","5de21924":"### Creating a generic function to explore type of occurrence ","22f6d7c0":"## General Function for Sub-Dataset and Plotting","2b40d3ff":"## Comparing Data","d1de215d":"## Libraries","e02f4933":"`Once 2020 has only 5 months, let's create a new feature with the year montly average of cases`","67212b98":"## Introduction\nThis notebook explores the crimes occurred on S\u00e3o Paulo State from 2001 to 2020.\n- **Notebook Author**: [Marcelo Rovai](https:\/\/github.com\/Mjrovai)\n- Based on great dataset collected by [Dalciana Waller](https:\/\/www.kaggle.com\/dbwaller)\n- Dataset available at repo: [Official Crime data - Sao Paulo state-Brazil (SSP)](https:\/\/www.kaggle.com\/dbwaller\/official-crime-data-sao-paulo-statebrazil-ssp)\n\n**NOTES**\n- The dataset contain official crime statistics from S\u00e3o Paulo state cities (Brazil) and were prepared based on information available on the [Civil State Police statistics site](http:\/\/www.ssp.sp.gov.br\/Estatistica\/Pesquisa.aspx)\n- **Period**: Jan 2001 to May 2020.\n- Data and labels in brazilian portuguese\n- Information about crime type interpretation (available only in brazilian portuguese): [Estat\u00edstica de Criminalidade\nManual de Interpreta\u00e7\u00e3o](http:\/\/www.ssp.sp.gov.br\/Estatistica\/download\/manual.pdf)\n- Dataset prepared with webscraping techniques in Python.","50721ea3":"`Jun to Dez have object as type, but should be float64`","d4237eb2":"## Creating a sub-dataset for Total Homicides in S\u00e3o Paulo","7dc09fe9":"## Exploratory Analysis\n`Let's see some crime tipification (for example 'HOMIC\u00cdDIO DOLOSO (2) on a specific city (for example 'S\u00e3o Paulo')`"}}