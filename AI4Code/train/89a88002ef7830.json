{"cell_type":{"b740cbaa":"code","312b4986":"code","df19284c":"code","8a855a0f":"code","5d6cfc35":"code","d7eedb96":"code","707b12bd":"code","a30b21a0":"code","6fe3183f":"code","930bb626":"code","52398c32":"code","a8a92003":"code","c38c58ea":"code","cba46402":"code","c1d776fd":"markdown","39764b18":"markdown","d5f572d8":"markdown","d6760e2b":"markdown","79691134":"markdown","171c18a9":"markdown","a9b57e86":"markdown","10d0a598":"markdown"},"source":{"b740cbaa":"import tensorflow as tf\nfrom tensorflow.keras.datasets import fashion_mnist\nfrom tensorflow.keras.layers import Conv2D, Dropout, MaxPooling2D, Flatten, Dense\n# Helper libraries\nimport numpy as np\nimport matplotlib.pyplot as plt","312b4986":"\n(train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data()\n","df19284c":"train_images.shape","8a855a0f":"plt.imshow(train_images[99])","5d6cfc35":"train_images = train_images.astype('float32') \/ 255\ntest_images = test_images.astype('float32') \/ 255\n\ntrain_images = train_images.reshape(train_images.shape[0], 28, 28, 1)\ntest_images = test_images.reshape(test_images.shape[0], 28, 28, 1)\n\ntrain_labels = tf.keras.utils.to_categorical(train_labels, 10)\ntest_labels = tf.keras.utils.to_categorical(test_labels, 10)\n","d7eedb96":"model = tf.keras.Sequential()\n# Must define the input shape in the first layer of the neural network\nmodel.add(Conv2D(filters=64, kernel_size=2, padding='same', activation='relu', input_shape=(28,28,1))) \nmodel.add(MaxPooling2D(pool_size=2))\nmodel.add(Dropout(0.3))\nmodel.add(Conv2D(filters=32, kernel_size=2, padding='same', activation='relu'))\nmodel.add(MaxPooling2D(pool_size=2))\nmodel.add(Dropout(0.3))\nmodel.add(Flatten())\nmodel.add(Dense(256, activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(10, activation='softmax'))\n# Take a look at the model summary\nmodel.summary()","707b12bd":"model.compile(loss='categorical_crossentropy',\n             optimizer='rmsprop',\n             metrics=['accuracy'])","a30b21a0":"model.fit(train_images,\n         train_labels,\n         batch_size=64,\n         epochs=10)","6fe3183f":"score = model.evaluate(test_images, test_labels, verbose=0)\n","930bb626":"score","52398c32":"early = tf.keras.callbacks.EarlyStopping(monitor='accuracy',patience=1)\nmodel.fit(train_images,\n         train_labels,\n         batch_size=64,\n        callbacks=[early],\n         epochs=10)","a8a92003":"checkpoint = tf.keras.callbacks.ModelCheckpoint(filepath='mi_primer_red_conv.hdf5',\n                                verbose=1,\n                                  monitor='accuracy',\n                                  save_best_only=True)\nmodel.fit(train_images,\n         train_labels,\n         batch_size=64,\n         callbacks=[checkpoint],\n         epochs=10)","c38c58ea":"model2 = model\nmodel2.load_weights('.\/mi_primer_red_conv.hdf5')","cba46402":"model2.evaluate(test_images, test_labels)","c1d776fd":"## An\u00e1lisis de resultados","39764b18":"## Creando nuestra red neuronal","d5f572d8":"## Callbacks","d6760e2b":"## Limpieza de datos","79691134":"## Importando librer\u00edas","171c18a9":"## Cargando dataset de Fashion MNIST","a9b57e86":"## Compilando la red neuronal","10d0a598":"## Entenando la red"}}