{"cell_type":{"8c39b9a2":"code","10ae0112":"code","fe30c4d9":"code","1a54c166":"code","fa4c13e0":"code","6db98373":"code","b54861d6":"code","295ffa3d":"code","5abfb413":"code","a0a152ea":"code","fd90f1ff":"code","64d67a3c":"code","5a1fde2b":"code","66f9865b":"code","64aa8b2c":"code","b41a9390":"code","c44fd973":"markdown"},"source":{"8c39b9a2":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\ndf = pd.read_csv(\"..\/input\/international-energy-statistics\/all_energy_statistics.csv\")","10ae0112":"df.shape","fe30c4d9":"df.head()","1a54c166":"# the category column doesn't look to be in need of cleaning\npd.set_option(\"display.max_rows\", 100)\ndf.category.value_counts()","fa4c13e0":"# commodity transcation looks to have mulitple pieces of information in each row\ndf.commodity_transaction.value_counts().tail(50)","6db98373":"df.commodity_transaction.head()","b54861d6":"# how mnay hypens per row?\ndf.commodity_transaction.str.count(\" - \").value_counts()\n\n#splits pandas column by string","295ffa3d":"?str.split","5abfb413":"# split commodity_transaction column into more useful columns\nsplit_commodities = df.commodity_transaction.str.split(\" - | \u2013 \",  expand=True)\nsplit_commodities.head()","a0a152ea":"# more informative column names\nsplit_commodities.columns = [\"commodity\",\"transaction_type\",\"additional_transaction_info\"]\nsplit_commodities.head()","fd90f1ff":"# check out the commodities: they actually look pretty good\npd.set_option('display.max_rows', 100)\nsplit_commodities.commodity.str.lower().value_counts()","64d67a3c":"# cleaning transaction type\npd.set_option('display.max_rows', 250)\nsplit_commodities.transaction_type = split_commodities.transaction_type.str.lower().str.strip()\n\n# spelling corrections: \n# transformatin -> transformation \n# \" \/\" -> \"\/\"\n# \"\/ \" -> \"\/\"\n# \"non energy uses\"  -> \"consumption for non-energy uses\"\n\nsplit_commodities.transaction_type = split_commodities.transaction_type.str.replace(\"transformatin\", \"transformation\")\nsplit_commodities.transaction_type = split_commodities.transaction_type.str.replace(\"non energy uses\", \"consumption for non-energy uses\")\nsplit_commodities.transaction_type = split_commodities.transaction_type.str.replace(\" \/\", \"\/\")\nsplit_commodities.transaction_type = split_commodities.transaction_type.str.replace(\"\/ \", \"\/\")\n\nsplit_commodities.transaction_type.value_counts()","5a1fde2b":"# check out column #3 & make sure it looks good\nsplit_commodities.additional_transaction_info.str.lower().value_counts()","66f9865b":"# add cleaned columns to our output dataframe\ndf = pd.concat([df, \n                split_commodities.commodity.str.lower(),\n                split_commodities.transaction_type,\n                split_commodities.additional_transaction_info.str.lower()], \n               axis=1)","64aa8b2c":"df.head()","b41a9390":"with open(\"cleaned_energy_data.csv\", \"w+\") as file:\n    file.write(df.to_csv())","c44fd973":"This notebook does some basic data cleaning of the \"commodity_transaction\" column to make the dataframe tidy and remove some spelling errors. Should be easier to use for summary statistics!"}}