{"cell_type":{"d5ef9b45":"code","7a4e9ada":"code","9e50946b":"code","ee3205f7":"code","5ec1f42c":"code","a167b72e":"code","d3a0a07d":"code","22b06b23":"code","48acd997":"code","3ecf4059":"code","0b8a2200":"code","bb9472d0":"code","1ef68366":"code","e99e0b82":"code","bdbe0bd7":"code","5961860d":"markdown","6de1aaca":"markdown","853d98bb":"markdown","548e99b9":"markdown","9a1c595f":"markdown","1682be8a":"markdown","4cc7f9ba":"markdown","3096d065":"markdown","5d30eff0":"markdown","2b1a732d":"markdown","77d58990":"markdown","e47b1e1c":"markdown","2173a95e":"markdown","b2813c1c":"markdown","107831fb":"markdown","8c37f944":"markdown","65bca12e":"markdown","c80d7bc1":"markdown"},"source":{"d5ef9b45":"!pip install -qq fastai","7a4e9ada":"import pandas as pd\nimport numpy as np\n\n# Sci-Kit Learn, FastAI and Torch:\nfrom fastai.text.all import *\nimport torch\n\n# \nfrom sklearn.metrics import accuracy_score, precision_recall_fscore_support","9e50946b":"path = \"..\/input\/us-election-2020-tweets\/hashtag_joebiden.csv\"\ndata = pd.read_csv(path)\ndata = data['tweet']\ndata.head()","ee3205f7":"train = data.loc[:90000]\n\ntrain = pd.DataFrame(train)","5ec1f42c":"dls = TextDataLoaders.from_df(train, text_col = 'tweet', is_lm = True, seq_len = 50)","a167b72e":"dls.show_batch(max_n=3)","d3a0a07d":"learn = language_model_learner(dls, AWD_LSTM, drop_multi = 0.5, metrics = accuracy)","22b06b23":"learn.lr_find()","48acd997":"learn.fit_one_cycle(5, 1e-2)","3ecf4059":"learn.predict('biden sucks so much, he will raise my taxes.',10, temperature = 1)","0b8a2200":"train = data.loc[:200000]\n\ntrain = pd.DataFrame(train)","bb9472d0":"dls = TextDataLoaders.from_df(train, text_col = 'tweet', is_lm = True, seq_len = 50)","1ef68366":"learn = language_model_learner(dls, AWD_LSTM, drop_multi = 0.5, metrics = accuracy)","e99e0b82":"learn.fit_one_cycle(1, 1e-2)","bdbe0bd7":"learn.predict('I dont like biden at all he sucks. ', 40,temperature = 1)","5961860d":"Setting up the dataloader:","6de1aaca":"Lets train the model for a few epochs now:","853d98bb":"## Preprocessing the Data (Again)","548e99b9":"## Training the Model (Again)","9a1c595f":"# Importing Stuff","1682be8a":"# Training the Model","4cc7f9ba":"# Preprocessing the Data:","3096d065":"Downloading what we need:","5d30eff0":"Lets import the data and take a look at it:","2b1a732d":"# Working with 60,000 lines of text","77d58990":"Lets train the model for a few epochs now:","e47b1e1c":"This is the end of my notebook, hope it helps!","2173a95e":"# Working with 200,000 lines of text","b2813c1c":"Using FastAI's language_model_learner module:","107831fb":"Finding a suitable learning rate:","8c37f944":"It seems like a suitable learning rate lies around 1e-2, because the slope is the steepest there.","65bca12e":"# Grabbing Data and Models","c80d7bc1":"Setting up the tokenizer:"}}