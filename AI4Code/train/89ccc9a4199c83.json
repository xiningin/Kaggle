{"cell_type":{"8fd084a1":"code","5edb43a3":"code","f5b204bb":"code","0da082fe":"code","d8b28ce9":"code","90f23ea9":"code","045fbef2":"code","9894007e":"code","4b753304":"code","ab4785a3":"code","3b7cd0ec":"code","8aec2ab2":"code","2386145f":"code","f95dbf58":"code","fef8568b":"code","bedb0f14":"code","74361061":"code","deb7ec7d":"code","b55b4bbc":"code","9f2d1d63":"code","07af91cb":"code","ea6d2aa1":"code","fd19ed1c":"code","1cf76203":"code","baa05690":"code","fe64c313":"code","3d42848c":"code","6857be51":"code","c245ad4f":"code","ded639c7":"code","21b04610":"code","e72b4ae2":"code","989ab86a":"code","245a05d2":"code","7f7d3c04":"code","5047f067":"code","5c65b247":"code","e2f61c0f":"code","de14c7a8":"code","4e30cbd4":"code","e1b4f84b":"code","5e11b22e":"code","e8512a29":"code","da065caa":"code","6e87b17e":"code","13d5d646":"code","a162c644":"code","b52e3dda":"code","2a0a3711":"markdown","58182f4a":"markdown","ab42aed7":"markdown","dd7e91be":"markdown","996a6804":"markdown","7d0f53d5":"markdown","7ba3b2b0":"markdown","56c0b4fc":"markdown","3c564d5b":"markdown","9a2735a4":"markdown","fc6d7542":"markdown","225d5a05":"markdown","da869305":"markdown","57e3cfed":"markdown","fce9f1dd":"markdown"},"source":{"8fd084a1":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport os\nimport scipy as sp\nimport string\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n%matplotlib inline\n\n\n","5edb43a3":"data=pd.read_csv(\"..\/input\/fake-news-classifier-data\/test.csv\")\n","f5b204bb":"data","0da082fe":"data.head()","d8b28ce9":"data.info()","90f23ea9":"data.describe()","045fbef2":"data.value_counts","9894007e":"data.dtypes","4b753304":"data.shape","ab4785a3":"data.columns","3b7cd0ec":"data.isnull().sum()","8aec2ab2":"data.isnull().any()","2386145f":"###Drop Nan Values\ndata=data.dropna()\n","f95dbf58":"data.isnull().sum()","fef8568b":"## Get the Independent Features\n\nX=data.drop('id',axis=1)\n","bedb0f14":"y=data['id']\n","74361061":"y.value_counts()\n","deb7ec7d":"X.shape","b55b4bbc":"y.shape","9f2d1d63":"plt.style.use(\"default\")\nsns.barplot(x=\"id\", y=\"title\",data=data[180:190])\nplt.title(\"ID vs TITLE\",fontsize=15)\nplt.xlabel(\"ID\")\nplt.ylabel(\"TITLE\")\nplt.show()\n\n\n","07af91cb":"data.columns","ea6d2aa1":"sns.set_palette(\"Paired\")\nsns.pairplot(data,hue='text',height=5,palette='colorblind')\nplt.show()\n","fd19ed1c":"plt.figure(figsize=(14,10))\nsns.set_style(style='whitegrid')\nplt.subplot(2,3,1)\nsns.boxplot(x='id',data=data)\n\n","1cf76203":"sns.pairplot(data=data)","baa05690":"import tensorflow as tf\n","fe64c313":"from tensorflow.keras.layers import Embedding\nfrom tensorflow.keras.preprocessing.sequence import pad_sequences\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.preprocessing.text import one_hot\nfrom tensorflow.keras.layers import LSTM\nfrom tensorflow.keras.layers import Dense\n\n","3d42848c":"### Vocabulary size\nvoc_size=5000\n","6857be51":"messages=X.copy()\n","c245ad4f":"messages.reset_index(inplace=True)\n\n","ded639c7":"import nltk\nimport re\nfrom nltk.corpus import stopwords","21b04610":"nltk.download('stopwords')\n","e72b4ae2":"### Dataset Preprocessing\nfrom nltk.stem.porter import PorterStemmer\nps = PorterStemmer()\ncorpus = []\nfor i in range(0, len(messages)):\n    print(i)\n    review = re.sub('[^a-zA-Z]', ' ', messages['title'][i])\n    review = review.lower()\n    review = review.split()\n    \n    review = [ps.stem(word) for word in review if not word in stopwords.words('english')]\n    review = ' '.join(review)\n    corpus.append(review)\n","989ab86a":"corpus","245a05d2":"onehot_repr=[one_hot(words,voc_size)for words in corpus] \nonehot_repr","7f7d3c04":"sent_length=20\nembedded_docs=pad_sequences(onehot_repr,padding='pre',maxlen=sent_length)\nprint(embedded_docs)\n","5047f067":"embedded_docs[0]\n","5c65b247":"## Creating model\nembedding_vector_features=40\nmodel=Sequential()\nmodel.add(Embedding(voc_size,embedding_vector_features,input_length=sent_length))\nmodel.add(LSTM(100))\nmodel.add(Dense(1,activation='sigmoid'))\nmodel.compile(loss='mae',optimizer='adam',metrics=['accuracy'])\n\n","e2f61c0f":"model.summary()","de14c7a8":"import numpy as np\nX_final=np.array(embedded_docs)\ny_final=np.array(y)\n","4e30cbd4":"X_final.shape,y_final.shape","e1b4f84b":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X_final, y_final, test_size=0.3, random_state=42)\n","5e11b22e":"model.fit(X_train,y_train,validation_data=(X_test,y_test),epochs=50,batch_size=256)\n","e8512a29":"from tensorflow.keras.layers import Dropout\n## Creating model\nembedding_vector_features=40\nmodel=Sequential()\nmodel.add(Embedding(voc_size,embedding_vector_features,input_length=sent_length))\nmodel.add(Dropout(0.3))\nmodel.add(LSTM(100))\nmodel.add(Dropout(0.3))\nmodel.add(Dense(1,activation='sigmoid'))\nmodel.compile(loss='mae',optimizer='adam',metrics=['accuracy'])","da065caa":"y_pred=model.predict(X_test)\n","6e87b17e":"y_pred","13d5d646":"print((y_pred > 0.5))\n","a162c644":"from tensorflow.keras.utils import plot_model\nplot_model(model, show_shapes = True)\n","b52e3dda":"model.summary()","2a0a3711":"# **Exploratory Data Analysis**","58182f4a":"**MODEL CREATION**","ab42aed7":"**With Dense we can also use Dropout and Batch Normalization**","dd7e91be":"# IMPORTING THE LIBRARIES","996a6804":"***So we have to drop the null values .***","7d0f53d5":"**LSTM**","7ba3b2b0":"***So now we can see all the null values have been dropped .***","56c0b4fc":"**Stemming and Lemmatization are Text Normalization (or sometimes called Word Normalization) techniques in the field of Natural Language Processing that are used to prepare text, words, and documents for further processing.**","3c564d5b":"# LOADING THE DATASET","9a2735a4":"# **Checking Null Values**","fc6d7542":"# FAKE NEWS CLASSIFIER ","225d5a05":"**Types of Loss Functions:**\n\n**1) Mean Squared Error**\n\n**2) Regression Loss Function**\n\n**3) Mean Absolute Error Loss**\n\n**4) Binary Classification Loss Function**\n\n**5) Binary Cross Entropy Loss**\n","da869305":"**Types of Activation Functions:**\n\n**1) Relu**\n\n**2) Sigmoid**\n\n**3) Threshold**\n\n**4) Hyperbolic Tangent**","57e3cfed":"**Types of Optimizers:**\n\n**1) Gradient Descent (GD)**\n\n**2) Stochastic Gradient Descent**\n\n**3) Mini-Batch Gradient Descent**\n\n**4) Adagrad**\n\n**5) RMSProp**\n\n\n\n","fce9f1dd":"**NLTK**"}}