{"cell_type":{"2b543baa":"code","d2eb0906":"code","6858851a":"code","ee648dba":"code","2dede8a5":"code","2b33d42c":"code","b1f1faf6":"code","1c4d2365":"code","9d3efb69":"code","c0554ce8":"code","57850e65":"code","40c9ab91":"code","dcd7283c":"code","cbc53e1c":"code","cbec11be":"code","d336bbc0":"code","4602caf8":"code","f9090dd3":"code","45cd4dac":"code","f7daebad":"code","67c73005":"code","13ea88e0":"code","fa62f22a":"code","2998e32a":"code","62fe1dea":"code","ad8fb99d":"code","9b4f2ccf":"code","ef6ecc38":"code","45697e20":"code","1fe972c4":"code","51639f11":"code","5fa0759b":"code","24877fcd":"code","52ef522c":"code","f58c1624":"code","3997e598":"code","cf063109":"code","7eec455a":"code","e57d9e1e":"code","d19b80d2":"code","17657373":"code","c785c3ce":"code","db539e95":"code","2e26d393":"code","07488411":"code","a5a990f4":"code","a62465e0":"code","d6c84cdc":"code","e7c6ac6d":"code","7ccb6f05":"code","f97379a0":"code","7f9b8c35":"code","e82f1261":"code","04a8daf9":"code","7e7d86cc":"code","dd248841":"code","22de9100":"code","e4009732":"code","f9cbc82f":"code","00c82e17":"code","763fa375":"code","efa6cc02":"code","d2835fb6":"code","55ec25dd":"code","d67c0b5c":"code","436c4053":"code","f8c5263a":"code","1f94069f":"code","1ed42bf7":"code","50eb4035":"code","9894ea8c":"code","cad22cbf":"code","6f9133b6":"code","239fd8a3":"code","e0593caf":"code","11da0407":"code","9c121ea1":"code","d1d093b5":"code","22a2cffb":"code","c74c83ba":"code","0f355ab2":"code","3229f030":"code","737b35f1":"code","6fe318ba":"code","4bcbf0f1":"code","d5760b20":"code","61d18bef":"code","be889243":"code","05b0af32":"code","975d8d9c":"code","38d94f78":"code","7d1abc0f":"markdown","a356e002":"markdown","7b197897":"markdown","c0514aa1":"markdown","76142e67":"markdown","fa076357":"markdown","571c157d":"markdown"},"source":{"2b543baa":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\n%matplotlib inline","d2eb0906":"df=pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')","6858851a":"df.head()","ee648dba":"df.shape","2dede8a5":"df.info()","2b33d42c":"df.describe()","b1f1faf6":"df[['age','trtbps']].describe()","1c4d2365":"mpl.rcParams['figure.dpi']=150","9d3efb69":"df[['age','trtbps']].hist()","c0554ce8":"for cat in ['sex','cp','fbs','restecg','exng','slp','caa','thall','output']:\n  print(df[cat].value_counts())\n  print('--'*5)","57850e65":"df[['chol','oldpeak','thalachh']].hist()","40c9ab91":"mpl.rcParams['figure.dpi']=70\n\ndf.groupby('sex').agg({'output':'mean'}).plot.bar(legend=False)\nplt.ylabel('output')\nplt.xlabel('sex')","dcd7283c":"df.groupby('cp').agg({'output':'mean'}).plot.bar(legend=False)\nplt.ylabel('output')\nplt.xlabel('cp')","cbc53e1c":"df.groupby('fbs').agg({'output':'mean'}).plot.bar(legend=False)\nplt.ylabel('output')\nplt.xlabel('fbs')","cbec11be":"df.groupby('exng').agg({'output':'mean'}).plot.bar(legend=False)\nplt.ylabel('output')\nplt.xlabel('exng')","d336bbc0":"df.groupby('slp').agg({'output':'mean'}).plot.bar(legend=False)\nplt.ylabel('output')\nplt.xlabel('slp')","4602caf8":"df.groupby('caa').agg({'output':'mean'}).plot.bar(legend=False)\nplt.ylabel('output')\nplt.xlabel('caa')","f9090dd3":"df.groupby('thall').agg({'output':'mean'}).plot.bar(legend=False)\nplt.ylabel('output')\nplt.xlabel('thall')","45cd4dac":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(df[df.columns.tolist()[:-1]].values,df[df.columns.tolist()[-1]].values,test_size=0.2,random_state=42)","f7daebad":"X_train.shape","67c73005":"np.mean(y_train)","13ea88e0":"np.mean(y_test)","fa62f22a":"from sklearn.model_selection import cross_val_score\nfrom sklearn.linear_model import LogisticRegression","2998e32a":"lr=LogisticRegression()","62fe1dea":"score=cross_val_score(lr,X_train,y_train,scoring='accuracy',cv=5,verbose=1)\nnp.mean(score)","ad8fb99d":"lr.fit(X_train,y_train)\ny_pred=lr.predict(X_test)","9b4f2ccf":"from sklearn.metrics import accuracy_score\naccuracy_score(y_test,y_pred)","ef6ecc38":"from sklearn.ensemble import RandomForestClassifier\nrf=RandomForestClassifier(max_depth=10,n_estimators=100)\nnp.mean(cross_val_score(rf,X_train,y_train,scoring='accuracy',cv=5,verbose=1))","45697e20":"rf.fit(X_train,y_train)","1fe972c4":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport scipy as sp\nimport seaborn as sns\nimport re\nimport os\nimport time\nimport plotly.express as px","51639f11":"df.head()","5fa0759b":"df.info()","24877fcd":"df[df.duplicated()]    ## useful to find duplicate rows","52ef522c":"df_clean=df.drop_duplicates()      ## useful","f58c1624":"df_clean.shape","3997e598":"df_clean.corr()","cf063109":"mpl.rcParams['figure.dpi']=130\nsns.heatmap(df_clean.corr(),center=True)","7eec455a":"plt.figure(figsize=(8,5))\nplt.style.use('ggplot')\nsns.countplot(x=df_clean.age)\nplt.xticks(rotation=90)\nplt.xlabel('Age')\nplt.ylabel('count')\nplt.title('count')","e57d9e1e":"df=df_clean.copy()","d19b80d2":"df['sex'].hist()","17657373":"c=df['cp'].value_counts()\ntype(c)","c785c3ce":"sns.barplot(x=c.index,y=c)\nplt.xlabel('cp values')\nplt.ylabel('count')\nplt.title('type of chest pain with no of patients')","db539e95":"sns.displot(df['trtbps'],kde=True,kind='hist')\nplt.title('resting blood pressure')","2e26d393":"sns.displot(df['chol'],kde=True,kind='hist')\nplt.title('cholestrol level')","07488411":"sns.displot(df['thalachh'],kde=True,kind='hist')\nplt.title('max heart rate achieved')","a5a990f4":"sns.displot(df['oldpeak'],kde=True,kind='hist')\nplt.title('previous peak')","a62465e0":"v=pd.crosstab(df_clean['age'],df_clean['output']).reset_index()\nv.columns=['age',\"low_risk\",\"high_risk\"]\nv","d6c84cdc":"pos_output_mask=df['output']==1\nneg_output_mask=df['output']==0","e7c6ac6d":"axes = plt.axes()\naxes.hist(df.loc[neg_output_mask, 'age'], alpha=0.5, color='blue')\naxes.hist(df.loc[pos_output_mask, 'age'], alpha=0.5, color='red')\naxes.tick_params(axis='x', labelrotation=45)\naxes.set_xlabel('age')\naxes.set_ylabel('counts')\naxes.legend(['low risk', 'high risk'])\naxes.set_title('age and risk')","7ccb6f05":"features_response=df.columns.tolist()","f97379a0":"features_response=[item for item in features_response if item !='output']\nfeatures_response","7f9b8c35":"sns.lineplot(data=df,x='age',y='trtbps')\nplt.xlabel('age')\nplt.ylabel('resting blood pressure')\nplt.title('blood pressure with age')","e82f1261":"sns.lineplot(data=df,x='age',y='chol')\nplt.xlabel('age')\nplt.ylabel('cholestrol')\nplt.title('cholestrol with age')","04a8daf9":"sns.lineplot(data=df,x='age',y='thalachh')\nplt.xlabel('age')\nplt.ylabel('thalachh')\nplt.title('max heart rate achieved with age')","7e7d86cc":"## does inc in chol affect heart rate","dd248841":"sns.lineplot(data=df,x='age',y='trtbps',hue='output')\nplt.xlabel('age')\nplt.ylabel('resting blood pressure')\nplt.title('effect of heart attack with ( age and blood pressure) ')","22de9100":"sns.lineplot(data=df,x='age',y='thalachh',hue='output')\nplt.xlabel('age')\nplt.ylabel('thalachh')\nplt.title('effect of heart attack with (age and resting_blood_pressure) ')","e4009732":"sns.lineplot(data=df,x='age',y='chol',hue='output')\nplt.xlabel('age')\nplt.ylabel('cholestrol')\nplt.title('effect of heart attack with( cholestrol and age)')","f9cbc82f":"mpl.rcParams['figure.dpi']=300\n\nsns.heatmap(df.corr(),center=0,annot=True,annot_kws={\"fontsize\":4})","00c82e17":"mpl.rcParams['figure.dpi']=100\nsns.scatterplot(data=df,x='output',y='chol')\nplt.title('chol and output')","763fa375":"sns.regplot(data=df,x='output',y='chol')\nplt.title('chol and output')","efa6cc02":"sns.swarmplot(data=df,x='output',y='chol')\nplt.title('chol and output')","d2835fb6":"sns.histplot(data=df,x='age',hue='output')\nplt.title('does age affect heart attack')","55ec25dd":"sns.histplot(data=df,x='chol',hue='output')\nplt.title('does chol affect heart attack')","d67c0b5c":"## it seems that through corr graph that caa,oldpeak,exng,cp,thalachh are good ones","436c4053":"df['caa'].value_counts()","f8c5263a":"groupby_caa=df.groupby('caa').agg({'output':'mean'})\ngroupby_caa","1f94069f":"sns.catplot(data=df,x='caa',y='output',kind='bar')","1ed42bf7":"g=sns.FacetGrid(data=df,col='output')\ng.map(sns.histplot,'caa')","50eb4035":"sns.histplot(data=df,x='oldpeak',hue='output')","9894ea8c":"df.groupby('output')['oldpeak'].count()","cad22cbf":"df['exng'].value_counts()","6f9133b6":"df.groupby('output')['exng'].count()","239fd8a3":"sns.catplot(data=df,x='exng',y='output',kind='bar')","e0593caf":"df['cp'].value_counts()","11da0407":"sns.catplot(data=df,x='cp',y='output',kind='bar')","9c121ea1":"sns.histplot(data=df,x='thalachh',hue='output')","d1d093b5":"sns.histplot(data=df,x='oldpeak',hue='slp')","22a2cffb":"X_train,X_test,y_train,y_test=train_test_split(df.iloc[:,:-1].values,df.iloc[:,-1].values,test_size=0.2,random_state=42)","c74c83ba":"from sklearn.feature_selection import f_classif\nfrom sklearn.feature_selection import SelectPercentile","0f355ab2":"[f_stat,f_p_value]=f_classif(X_train,y_train)","3229f030":"f_df=pd.DataFrame({\n    'columns':features_response,\n    'f_stat':f_stat,\n    'p_value':f_p_value\n})","737b35f1":"f_df.sort_values('p_value')","6fe318ba":"selector=SelectPercentile(f_classif,percentile=20)\nselector.fit(X_train,y_train)","4bcbf0f1":"best_features=selector.get_support()\nbest_features","d5760b20":"best_features=[features_response[i] for i in range(len(features_response)) if best_features[i]]\nbest_features","61d18bef":"rf=RandomForestClassifier(n_estimators=100,max_depth=9)","be889243":"cross_val_score(rf,X_train,y_train,scoring='accuracy').mean()","05b0af32":"rf.fit(X_train,y_train)","975d8d9c":"accuracy_score(y_test,rf.predict(X_test))","38d94f78":"### please provide any extra things that i might have done wrong","7d1abc0f":"univariate analysis","a356e002":"these first few blocks of code ive done in a hurry just for a little taste of the dataset and fast results","7b197897":"'slp','caa','thall','output","c0514aa1":"bivariate analysis","76142e67":"# ***Begin again***","fa076357":"### **this is my first file to be uploaded i would like if anyone can give me any remarks or suggestion of what has been done wrong or where its good thank you**\n","571c157d":"beginning again but with more detailed analytics"}}