{"cell_type":{"a94d67ed":"code","56c90780":"code","ebda6cd6":"code","fadfd114":"code","92225763":"code","6205722f":"code","3be7c125":"code","d3df14e5":"code","fba7b995":"code","3145edb9":"code","e3456f67":"code","61492b20":"code","a992a25c":"code","a9e0ac7c":"code","438024ac":"code","febaf21f":"markdown","99329a2e":"markdown","de566997":"markdown","fcc28950":"markdown","5944cb8b":"markdown","71eada74":"markdown","1982c608":"markdown","dbeb176f":"markdown","9158d46c":"markdown","5770c325":"markdown","7d075994":"markdown","99fff7c7":"markdown","35e962e9":"markdown"},"source":{"a94d67ed":"import numpy as np\nimport pandas as pd\ngender_submission = pd.read_csv(\"..\/input\/titanic\/gender_submission.csv\")\ntest = pd.read_csv(\"..\/input\/titanic\/test.csv\")\ntrain = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ntrain.head()","56c90780":"train.shape","ebda6cd6":"train.isnull().sum()","fadfd114":"test.isnull().sum()","92225763":"train.drop(['Cabin'],axis=1,inplace=True)\ntest.drop(['Cabin'],axis=1,inplace=True)","6205722f":"train.drop(['Ticket'],axis=1,inplace=True)\ntest.drop(['Ticket'],axis=1,inplace=True)","3be7c125":"train.drop(['Name'],axis=1,inplace=True)\ntest.drop(['Name'],axis=1,inplace=True)","d3df14e5":"print(\"Mean age:\", np.mean(train['Age'].dropna()))\nprint(\"Mean age:\", np.mean(test['Age'].dropna()))","fba7b995":"from collections import Counter\nfrom sklearn import preprocessing\n\ntrain['Age'].fillna(30, inplace=True)\ntest['Age'].fillna(30, inplace=True)\n\nctr = Counter(train['Embarked'])\nprint(\"Embarked feature's most common 2 data points:\", ctr.most_common(2))\ntrain['Embarked'].fillna('S', inplace=True)\ntest.isnull().sum()","3145edb9":"test['Fare'].fillna(np.mean(test['Fare']), inplace=True)\ntest['Age'] = test.Age.astype(int)\n\ntest.isnull().sum()\ntest.info()","e3456f67":"import copy\n\nencoder = preprocessing.LabelEncoder()\n\nembarkedEncoder = copy.copy(encoder.fit(train['Embarked']))\ntrain['Embarked'] = embarkedEncoder.transform(train['Embarked'])\n\nsexEncoder = copy.copy(encoder.fit(train['Sex']))\ntrain['Sex'] = sexEncoder.transform(train['Sex'])\n\ntrain['Fare'] = train['Fare'].astype(int)\ntrain.loc[train.Fare<=7.91,'Fare']=0\ntrain.loc[(train.Fare>7.91) &(train.Fare<=14.454),'Fare']=1\ntrain.loc[(train.Fare>14.454)&(train.Fare<=31),'Fare']=2\ntrain.loc[(train.Fare>31),'Fare']=3\n\ntrain['Age']=train['Age'].astype(int)\ntrain.loc[ train['Age'] <= 16, 'Age']= 0\ntrain.loc[(train['Age'] > 16) & (train['Age'] <= 32), 'Age'] = 1\ntrain.loc[(train['Age'] > 32) & (train['Age'] <= 48), 'Age'] = 2\ntrain.loc[(train['Age'] > 48) & (train['Age'] <= 64), 'Age'] = 3\ntrain.loc[train['Age'] > 64, 'Age'] = 4\n","61492b20":"import copy\n\nencoder = preprocessing.LabelEncoder()\n\nembarkedEncoder = copy.copy(encoder.fit(test['Embarked']))\ntest['Embarked'] = embarkedEncoder.transform(test['Embarked'])\n\nsexEncoder = copy.copy(encoder.fit(test['Sex']))\ntest['Sex'] = sexEncoder.transform(test['Sex'])\n","a992a25c":"train.head()","a9e0ac7c":"test.head()","438024ac":"X=train.drop('Survived',axis=1)\ny=train['Survived'].astype(int)\n\ntrain['Fare'] = train['Fare'].astype(int)\ntrain['Age'] = train['Age'].astype(int)\ntest['Fare'] = test['Fare'].astype(int)\n\nfrom sklearn.model_selection import StratifiedShuffleSplit\nfrom sklearn.svm import SVC\nfrom sklearn.preprocessing import Imputer\n\n\nfrom sklearn.model_selection import train_test_split\n\nsss = StratifiedShuffleSplit(n_splits=10, test_size=0.3, random_state=0)\nacc_dict = {}\n\nfor train_index, test_index in sss.split(X, y):\n    \n    X_train, X_test = X.iloc[train_index], X.iloc[test_index]\n    y_train, y_test = y.iloc[train_index], y.iloc[test_index]\n    \n\nclassifier=SVC()\nxtrain=train.iloc[:,1:]\nytrain=train.iloc[:,:1]\nytrain=ytrain.values.ravel()\nclassifier.fit(xtrain,ytrain)\n\ntestIm=Imputer(missing_values='NaN',strategy='most_frequent',axis=1)\nAge1=testIm.fit_transform(test.Age.values.reshape(1,-1))\nFare2=testIm.fit_transform(test.Fare.values.reshape(1,-1))\ntest['Age']=Age.T\ntest['Fare']=Fare.T\ntest.set_index('PassengerId',inplace=True)\n\ntest['Fare'] = test['Fare'].astype(int)\ntest.loc[test.Fare<=7.91,'Fare']=0\ntest.loc[(test.Fare>7.91) &(test.Fare<=14.454),'Fare']=1\ntest.loc[(test.Fare>14.454)&(test.Fare<=31),'Fare']=2\ntest.loc[(test.Fare>31),'Fare']=3\n\ntest['Age']=test['Age'].astype(int)\ntest.loc[ test['Age'] <= 16, 'Age']= 0\ntest.loc[(test['Age'] > 16) & (test['Age'] <= 32), 'Age'] = 1\ntest.loc[(test['Age'] > 32) & (test['Age'] <= 48), 'Age'] = 2\ntest.loc[(test['Age'] > 48) & (test['Age'] <= 64), 'Age'] = 3\ntest.loc[test['Age'] > 64, 'Age'] = 4\n\nResult=classifier.predict(test)\nprint(Result)\nprint(len(Result))","febaf21f":"Repeating a similar task for test data:","99329a2e":"To fill in for NaN columns of age, we're calculating the mean age for train and test and filling it in:","de566997":"**Initially, we will import all our data:**","fcc28950":"We've got 12 columns, namely **PassengerId, Survived** (where Yes = 1, No = 0), **pclass** (1 = 1st, 2 = 2nd,3 = 3rd), **sex, name, age\nsibsp** (Number of siblings that were with them on the ship), **parch** (Number of parents that were with them on the ship), **tickets, fare, cabin, embarked** (C,S,Q being locations). Among these, the Age, Fare, SibSp and Parch are numeric, Sex, Embarked, Survived and Pclass are alphabetic, Ticket and Cabin are alphanumeric. Name is text feature.\n","5944cb8b":"Our train data looks fairly good. Let's look at test data:","71eada74":"In our test data, we still have to deal with the fare column. calculating the mean fare for test and filling it in:","1982c608":"The name and ticket columns do not contribute anything, so we might as well delete them:","dbeb176f":"The Age and Cabin columns are short on a lot of values, which is undesireable for our work as it can lead to a poor prediction. To correct this, we must fill these in. But first, let's take a look at test data as well.","9158d46c":"Some of the columns such as sex and embarked are still not in int form, so we shall use label encoders that will to convert them into int: ","5770c325":"Fine, let's move on to training our model. Using the scikit train_test_split class, we'll split the training and testing data, and as we pass 0.3 as the value for test_size, the dataset will be split 30% as the test dataset. The train_size automatically gets assigned the remaining. Some of the values such as Fare, Age are float64, so we need to convert them to int in order to run them in prediction function.","7d075994":"Rounding off 29.6 to 30 and 30.27 to 30 respectively, and replacing NaN with 30 in the age feature column for train and test. We'll also get an idea of the repeated values in the embarked column. This will rid us of all the null values in the train set.","99fff7c7":"An observation can be made here that the cabin column is missing out on a lot of rows here as well, so we might as well drop the column from both the datasets. For age and fare, we will deal with those by using mean of the values.","35e962e9":"We can see that we have around 891 rows and 12 columns. Some of our rows are filled with an NaN, which is not a number and perhaps some undefined type. Let's see which columns have such values along with how many of in each of them."}}