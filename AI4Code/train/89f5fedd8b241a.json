{"cell_type":{"7c0d2497":"code","f3ac6d8a":"code","b5392ef2":"code","06786fb1":"code","8108ed48":"code","7515021a":"code","56eb2d25":"code","544d6868":"code","9cf33f33":"code","c213efa5":"code","b79e8cd9":"code","37261103":"code","d885a3f7":"code","abd2666a":"code","c2e2f4fa":"code","c9836488":"code","24d3f88c":"code","c0feecaa":"code","61d32006":"code","dcb6ea68":"code","2e414cf7":"code","60423129":"code","bcf0b04d":"code","1e33fdc5":"markdown","1413076c":"markdown"},"source":{"7c0d2497":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport re\nimport nltk\nfrom nltk.corpus import stopwords\nnltk.download('stopwords')\nfrom nltk.tokenize import word_tokenize\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session\ndata = pd.read_csv(\"..\/input\/netflix-shows\/netflix_titles.csv\")\ndata.head()\n\n","f3ac6d8a":"data.groupby('type').count()","b5392ef2":"data = data.dropna(subset=['cast','country','rating'])\n","06786fb1":"movies = data[data['type']=='Movie'].reset_index()\nmovies = movies.drop(['index','show_id','type','date_added','release_year','duration','description'],axis=1)\nmovies.head()","8108ed48":"tv = data[data['type']=='TV Show'].reset_index()\ntv = tv.drop(['index','show_id','date_added','release_year','duration','description','type'],axis=1)\ntv.head()","7515021a":"actors =[]\nfor i in movies['cast']:\n    actor=re.split(r',\\s*',i)\n    actors.append(actor)\n    \n    \nflat_list=[]\nfor sublist in actors:\n    for item in sublist:\n        flat_list.append(item)\nactor_list = sorted(set(flat_list))\nbinary_actor = [[0] * 0 for i in range(len(set(flat_list)))]\nfor i in movies['cast']:\n    k=0\n    for j in actor_list:\n        if j in i:\n            binary_actor[k].append(1.0)\n        else:\n            binary_actor[k].append(0.0)\n        k+=1\nbinary_actor = pd.DataFrame(binary_actor).transpose()\n\ndirectors=[]\n\nfor i in movies['director']:\n    if pd.notna(i):\n        director=re.split(r',\\s*',i)\n        directors.append(director)\nflat_list2=[]\nfor sublist in directors:\n    for item in sublist:\n        flat_list2.append(item)\ndirectors_list=sorted(set(flat_list2))\n\nbinary_director = [[0]* 0 for i in range(len(set(flat_list2)))]\nfor i in movies['director']:\n    k=0\n    for j in directors_list:\n        if pd.notna(j):\n            binary_director[k].append(0.0)\n        elif j in i:\n            binary_director[k].append(1.0)\n        else:\n            binary_director[k].append(0.0)\n        k+=1\n            \nbinary_director = pd.DataFrame(binary_director).transpose()\n\n\ncountries=[]\nfor i in movies['country']:\n    country=re.split(r',\\s*',i)\n    countries.append(country)\nflat_list3=[]\nfor sublist in countries:\n    for item in sublist:\n        flat_list3.append(item)\ncountry_list = sorted(set(flat_list3))\nbinary_country=[[0]*0 for i in range(len(set(flat_list3)))]\nfor i in movies['country']:\n    k=0\n    for j in country_list:\n        if j in i:\n            binary_country[k].append(1.0)\n        else:\n            binary_country[k].append(0.0)\n        k+=1\nbinary_country = pd.DataFrame(binary_country).transpose()\n \n    \ngenres=[]\nfor i in movies['listed_in']:\n    genre=re.split(r',\\s*',i)\n    genres.append(genre)\nflat_list4=[]\nfor sublist in genres:\n    for item in sublist:\n        flat_list4.append(item)\ngenre_list=sorted(set(flat_list4))\nbinary_genre=[[0] * 0 for i in range(len(set(flat_list4)))]\nfor i in movies['listed_in']:\n    k = 0\n    for j in genre_list:\n        if j in i:\n            binary_genre[k].append(1.0)\n        else:\n            binary_genre[k].append(0.0)\n        k+=1\nbinary_genre=pd.DataFrame(binary_genre).transpose()\nratings = []\nfor i in movies['rating']:\n    ratings.append(i)\nrating_list = sorted(set(ratings))\nbinary_rating = [[0]*0 for i in range(len(set(rating_list)))]\nfor i in movies['rating']:\n    k=0\n    for j in rating_list:\n        if j in i:\n            binary_rating[k].append(1.0)\n        else:\n            binary_rating[k].append(0.0)\n        k+=1\nbinary_rating = pd.DataFrame(binary_rating).transpose()\n\n            \n    \n    \n\n\n        \n        \n\n      \n        ","56eb2d25":"binary = pd.concat([binary_actor,binary_director,binary_country,binary_genre],axis=1,ignore_index=True)\nbinary","544d6868":"actors2=[]\nfor i in tv['cast']:\n    actor=re.split(r',\\s*',i)\n    actors2.append(actor)\nflat_list5 = []\nfor sublist in actors2:\n    for item in sublist:\n        flat_list5.append(item) \nactors_list2 = sorted(set(flat_list5))\nbinary_actor2 = [[0] * 0 for i in range(len(set(flat_list5)))]\nfor i in tv['cast']:\n    k=0\n    for j in actors_list2:\n        if j in i:\n            binary_actor2[k].append(1.0)\n        else:\n            binary_actor2[k].append(0.0)\n        k+=1\nbinary_actor2 = pd.DataFrame(binary_actor2).transpose()\n\n\n\ncountry2 = []\nfor i in tv['country']:\n    \n    countries2 = re.split(r',\\s*',i)\n    country2.append(countries2)\nflat_list6 = []\n\nfor sublist in country2:\n    for item in sublist:\n        flat_list6.append(item)\ncountry_list2 = sorted(set(flat_list6))\n\n\nbinary_country2 = [[0] * 0 for i in range(len(set(flat_list6)))]\nfor i in tv['country']:\n    k=0\n    for j in country_list2:\n        if j in i:\n            binary_country2[k].append(1.0)\n        else:\n            binary_country2[k].append(0.0)\n            \n        k+=1\nbinary_country2 = pd.DataFrame(binary_country2).transpose()\n\n\n\n\ngenres2=[]\n\n\nfor i in tv['listed_in']:\n    genre2=re.split(r',\\s*',i)\n    genres2.append(genre2)\n    \nflat_list8=[]\n\nfor sublist in genres2:\n    for item in sublist:\n        flat_list8.append(item)\n\ngenres_list2 = sorted(set(flat_list8))\n\nbinary_genre2 = [[0] * 0 for i in range(len(set(flat_list8)))]\n\nfor i in tv['listed_in']:\n    k=0\n    for j in genres_list2:\n        if j in i:\n            binary_genre2[k].append(1.0)\n        else:\n            binary_genre2[k].append(0.0)\n        k+=1\n        \n        \nbinary_genre2 = pd.DataFrame(binary_genre2).transpose()\n\n\nratings2 = []\n\nfor i in tv['rating']:\n    ratings2.append(i)\n    \nrating_list2 = sorted(set(ratings2))\n\nbinary_rating2 = [[0] * 0 for i in range(len(set(rating_list2)))]\n\nfor i in tv['rating']:\n    k=0\n    for j in rating_list2:\n        if j in i:\n            binary_rating2[k].append(1.0)\n        else:\n            binary_rating2[k].append(0.0)\n        k+=1\n        \nbinary_rating2 = pd.DataFrame(binary_rating2).transpose()\n\n            \n\n        \n","9cf33f33":"binary2 = pd.concat([binary_actor2,binary_country2,binary_genre2],axis=1,ignore_index=True)\nbinary2","c213efa5":"def recommender(search):\n    cs_list = []\n    binary_list = []\n    if search in movies['title'].values:\n        idx = movies[movies['title']==search].index.item()\n        for i in binary.iloc[idx]:\n            binary_list.append(i)\n        point1=np.array(binary_list).reshape(1,-1)\n        point1=[val for sublist in point1 for val in sublist]\n        for j in range(len(movies)):\n            binary_list2 = []\n            for k in binary.iloc[j]:\n                binary_list2.append(k)\n            point2 = np.array(binary_list2).reshape(1,-1)\n            point2 = [val for sublist in point2 for val in sublist]\n            \n            dot_product = np.dot(point1,point2)\n            \n            norm_1 = np.linalg.norm(point1)\n            norm_2 = np.linalg.norm(point2)\n            cos_sim = dot_product \/ (norm_1*norm_2)\n            cs_list.append(cos_sim)\n            \n        movies_copy = movies.copy()\n        movies_copy['cos_sim'] = cs_list\n        results = movies_copy.sort_values('cos_sim',ascending=False)\n        results = results[results['title']!=search]\n        top_results = results.head(5)\n        return(top_results)\n    \n    \n    elif search in tv['title'].values:\n        idx = tv[tv['title']==search].index.item()\n        for i in binary2.iloc[idx]:\n            binary_list.append(i)\n            \n        point1 = np.array(binary_list).reshape(1,-1)\n        point1 = [val for sublist in point1 for val in sublist]\n        for j in range(len(tv)):\n            binary_list2=[]\n            for k in binary2.iloc[j]:\n                binary_list2.append(k)\n            point2 = np.array(binary_list2).reshape(1,-1)\n            point2 = [val for sublist in point2 for val in sublist]\n            \n            dot_product = np.dot(point1,point2)\n            \n            norm_1 = np.linalg.norm(point1)\n            norm_2 = np.linalg.norm(point2)\n            cos_sim = dot_product \/ (norm_1*norm_2)\n            cs_list.append(cos_sim)\n        tv_copy = tv.copy()\n        tv_copy['cos_sim'] = cs_list\n        results = tv_copy.sort_values('cos_sim',ascending=False)\n        results = results[results['title']!=search]\n        top_results = results.head(5)\n        return(top_results)\n    else:\n        return(\"Title is not in dataset.Please check what's worng !!\")\n            \n    \n   \n    \n    \n            \n        \n        \n        \n        ","b79e8cd9":"recommender('The Conjouring')","37261103":"recommender('After Life')","d885a3f7":"recommender('Charlie and the Chocolate Factory')\n","abd2666a":"recommender('The Conjuring')","c2e2f4fa":"movies_des = data[data['type']== 'Movie'].reset_index()\nmovies_des = movies_des[['title','description']]\nmovies_des.head(5)","c9836488":"tv_des = data[data['type'] == 'TV Show'].reset_index()\ntv_des = tv_des[['title','description']]\ntv_des.head(5)","24d3f88c":"filtered_movies = []\nmovies_word = []\nfor text in movies_des['description']:\n    text_tokens = word_tokenize(text)\n    tokens_without_sw = [ word.lower() for word in text_tokens if not word in stopwords.words()]\n    movies_word.append(tokens_without_sw)\n    filtered = (\" \").join(tokens_without_sw)\n    filtered_movies.append(filtered)\nmovies_word = [val for sublist in movies_word for val in sublist]\nmovies_word = sorted(set(movies_word))\nmovies_des['description_filtered'] = filtered_movies\nmovies_des.head(5)","c0feecaa":"filtered_show = []\ntv_word = []\nfor text in tv_des['description']:\n    text_tokens = word_tokenize(text)\n    tokens_without_sw =[word.lower() for word in text_tokens if not word in stopwords.words()]\n    tv_word.append(tokens_without_sw)\n    filtered = (\" \").join(tokens_without_sw)\n    filtered_show.append(filtered)\ntv_word = [val for sublist in tv_word for val in sublist]\ntv_word = sorted(set(tv_word))\ntv_des['description_filtered'] = filtered_show\ntv_des.head(5)","61d32006":"movie_word_binary = [[0] * 0 for i in range(len(set(movies_word)))]\n\nfor des in movies_des['description_filtered']:\n    k = 0\n    for word in movies_word:\n        if word in des:\n            movie_word_binary[k].append(1.0)\n        else:\n            movie_word_binary[k].append(0.0)\n        k+=1\nmovie_word_binary = pd.DataFrame(movie_word_binary).transpose()\n","dcb6ea68":"tv_word_binary = [[0] * 0 for i in range(len(set(tv_word)))]\nfor des in tv_des['description_filtered']:\n    k=0\n    for word in tv_word:\n        if word in des:\n            tv_word_binary[k].append(1.0)\n        else:\n            tv_word_binary[k].append(0.0)\n        k+=1\ntv_word_binary = pd.DataFrame(tv_word_binary).transpose()\n","2e414cf7":"def recommender2(search):\n    cs_list = []\n    binary_list = []\n    if search in movies_des['title'].values:\n        idx = movies_des[movies_des['title'] == search].index.item()\n        for i in movie_word_binary.iloc[idx]:\n            binary_list.append(i)\n        point1 = np.array(binary_list).reshape(1,-1)\n        point1 =[val for sublist in point1 for val in sublist]\n        for j in range(len(movies_des)):\n            binary_list2 = []\n            for k in movie_word_binary.iloc[j]:\n                binary_list2.append(k)\n            point2 = np.array(binary_list2).reshape(1,-1)\n            point2 = [val for sublist in point2 for val in sublist]\n            dot_product = np.dot(point1,point2)\n            norm_1 = np.linalg.norm(point1)\n            norm_2 = np.linalg.norm(point2)\n            cos_sim = dot_product\/(norm_1 * norm_2)\n            cs_list.append(cos_sim)\n        movies_copy = movies_des.copy()\n        movies_copy['cos_sim'] = cs_list\n        results = movies_copy.sort_values('cos_sim',ascending=False)\n        results = results[results['title'] != search]\n        top_result = results.head(5)\n        return(top_result)\n    \n    \n    elif search in tv_des['title'].values:\n        idx = tv_des[tv_des['title']==search].index.item()\n        print(idx)\n        for i in tv_word_binary.iloc[idx]:\n            binary_list.append(i)\n        point1 = np.array(binary_list).reshape(1,-1)\n        point1 = [val for sublist in point1 for val in sublist]\n        for j in range(len(tv_des)):\n            binary_list2=[]\n            for k in tv_word_binary.iloc[j]:\n                binary_list2.append(k)\n            point2 = np.array(binary_list2).reshape(1,-1)\n            point2 = [val for sublist in point2 for val in sublist]\n            dot_product = np.dot(point1,point2)\n            norm_1 = np.linalg.norm(point1)\n            norm_2 = np.linalg.norm(point2)\n            cos_sim = dot_product\/(norm_1 * norm_2)\n            cs_list.append(cos_sim)\n        tv_copy = tv_des.copy()\n        tv_copy['cos_sim'] = cs_list\n        results = tv_copy.sort_values('cos_sim',ascending=False)\n        results = results[results['title']!=search]\n        top_result = results.head(5)\n        return(top_result)\n    else:\n        return(\"Title is not found.please cheack your spalling!\")","60423129":"recommender2('The Conjuring')","bcf0b04d":"recommender2(\"Child's Play\")","1e33fdc5":"**Recommendation using description**","1413076c":"filepath=\"..\/input\/netflix-shows\"\nmovie=pd.read_csv(filepath)\nmovie.head()"}}