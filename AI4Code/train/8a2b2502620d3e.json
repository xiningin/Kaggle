{"cell_type":{"d5c3626a":"code","a704314e":"code","a6fdefb5":"code","a7f92306":"code","fe662699":"code","c9d7f29b":"code","73a81c24":"code","88d5109d":"code","0185fdc8":"code","37810f42":"code","ed7b12ca":"code","1a419787":"code","75e0802e":"code","cf419c1f":"code","c7e59333":"code","288a72f9":"code","edf7c22a":"code","cf210e8f":"code","a65bb0cb":"code","ac1889f9":"code","ef0d0568":"code","cfa8f199":"markdown","3bf75983":"markdown","1e6501f9":"markdown"},"source":{"d5c3626a":"from pathlib import Path\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","a704314e":"# for training our model\ntrain_values = pd.read_csv('..\/input\/warm-up-machine-learning-with-a-heart\/train_values.csv', index_col='patient_id')\ntrain_labels = pd.read_csv('..\/input\/warm-up-machine-learning-with-a-heart\/train_labels.csv', index_col='patient_id')","a6fdefb5":"train_values.head()","a7f92306":"train_values.dtypes","fe662699":"train_labels.head()","c9d7f29b":"train_labels.heart_disease_present.value_counts().plot.bar(title='Number with Heart Disease')","73a81c24":"selected_features = ['age', \n                     'sex', \n                     'max_heart_rate_achieved', \n                     'resting_blood_pressure']\ntrain_values_subset = train_values[selected_features]","88d5109d":"sns.pairplot(train_values.join(train_labels), \n             hue='heart_disease_present', \n             vars=selected_features)","0185fdc8":"# for preprocessing the data\nfrom sklearn.preprocessing import StandardScaler\n\n# the model\nfrom sklearn.linear_model import LogisticRegression\n\n# for combining the preprocess with model training\nfrom sklearn.pipeline import Pipeline\n\n# for optimizing parameters of the pipeline\nfrom sklearn.model_selection import GridSearchCV","37810f42":"pipe = Pipeline(steps=[('scale', StandardScaler()), \n                       ('logistic', LogisticRegression())])\npipe","ed7b12ca":"param_grid = {'logistic__C': [0.0001, 0.001, 0.01, 1, 10], \n              'logistic__penalty': ['l1', 'l2']}\ngs = GridSearchCV(estimator=pipe, \n                  param_grid=param_grid, \n                  cv=3)","1a419787":"gs.fit(train_values_subset, train_labels.heart_disease_present)\n","75e0802e":"gs.best_params_","cf419c1f":"from sklearn.metrics import log_loss\n\nin_sample_preds = gs.predict_proba(train_values[selected_features])\nlog_loss(train_labels.heart_disease_present, in_sample_preds)","c7e59333":"test_values = pd.read_csv('..\/input\/warm-up-machine-learning-with-a-heart\/test_values.csv', index_col='patient_id')","288a72f9":"test_values_subset = test_values[selected_features]\n","edf7c22a":"predictions = gs.predict_proba(test_values_subset)[:, 1]\n","cf210e8f":"submission_format = pd.read_csv('..\/input\/format\/submission_format.csv', index_col='patient_id')\n","a65bb0cb":"my_submission = pd.DataFrame(data=predictions,\n                             columns=submission_format.columns,\n                             index=submission_format.index)","ac1889f9":"my_submission.head()\n","ef0d0568":"my_submission.to_csv('..\/input\/solution.csv')","cfa8f199":"#reference http:\/\/drivendata.co\/blog\/machine-learning-with-a-heart-benchmark\/","3bf75983":"DATA_DIR = Path('..', 'data', 'final', 'public')","1e6501f9":"DATA_DIR = Path('..', 'data', 'final', 'public')"}}