{"cell_type":{"881dcdef":"code","f78d5996":"code","6d73297a":"code","bcf6ec85":"code","55f3f7d7":"code","4837fcbf":"code","fbe676e6":"markdown","24a6b678":"markdown"},"source":{"881dcdef":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\ntrain = pd.read_csv('\/kaggle\/input\/titanic\/train.csv')","f78d5996":"y = train['Survived']\ntrain.drop(labels = ['Survived','PassengerId','Name','Ticket','Cabin','Embarked'], axis = 1, inplace = True)\ntrain['Age'].fillna(train['Age'].mean(), inplace = True)\ncategorical_columns = ['Sex']\ntrain = pd.get_dummies(train,columns = categorical_columns, dtype = int)\ntrain.drop(labels = ['Sex_male'], axis = 1, inplace = True)\n\nX = []\nfor column in train.columns:\n    X.append(column)\n\nX = train[X]","6d73297a":"X","bcf6ec85":"#ENTER MODEL HERE\nfrom sklearn.ensemble import GradientBoostingClassifier\nmodel = GradientBoostingClassifier()\nmodel.fit(X,y)\n\ny_pred = model.predict(X)\n\nfrom sklearn import metrics\n\ncm = metrics.confusion_matrix(y, y_pred)\nplt.figure(figsize=(9,9))\nsns.heatmap(cm, annot=True, fmt=\".3f\", linewidths=.5, square = True, cmap = 'Blues_r');\nplt.ylabel('Actual label');\nplt.xlabel('Predicted label');\nall_sample_title = 'Confusion Matrix'\nplt.title(all_sample_title, size = 15);","55f3f7d7":"original_test = pd.read_csv('\/kaggle\/input\/titanic\/test.csv')\ntest = pd.read_csv('\/kaggle\/input\/titanic\/test.csv')\ntest.drop(labels = ['PassengerId','Name','Ticket','Cabin','Embarked'], axis = 1, inplace = True)\ntest['Age'].fillna(test['Age'].mean(), inplace = True)\ncategorical_columns = ['Sex']\ntest = pd.get_dummies(test,columns = categorical_columns, dtype = int)\ntest.drop(labels = ['Sex_male'], axis = 1, inplace = True)\ntest['Fare'].fillna(test['Fare'].mean(), inplace = True)\n\ntest_pred = model.predict(test)\n#list_of_predictions_test = []\n\n#for pred in test_pred:\n#    list_of_predictions_test.append(one_or_zero(pred))\n    \n#test_pred = np.asarray(list_of_predictions_test)","4837fcbf":"submission = pd.DataFrame({\n        \"PassengerId\": original_test[\"PassengerId\"],\n        \"Survived\": test_pred\n    }) \n\nfilename = 'submission.csv'\nsubmission.to_csv(filename,index=False)\nprint('Saved file: ' + filename)","fbe676e6":"First I will  split the data between variable and targets. I will also remove the columns PassenderId, Name, Ticket (these should not have any effect on whether the passenger survived or not) and Cabin (as these have a lot of missing values). I will also remove the embarked column as where the passenger has left from shouldn't have any effect on whether they survived or not.","24a6b678":"**Using the model on the test data**"}}