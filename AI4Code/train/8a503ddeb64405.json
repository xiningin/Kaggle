{"cell_type":{"3bceefe8":"code","068886ca":"code","5ecc21ed":"code","036d1a0a":"code","cc101c5e":"code","51e26dff":"code","4c482c29":"code","edda0f85":"code","6dae4984":"code","7bba81c2":"code","5e43cfed":"code","8ed00784":"code","a9560865":"code","00295193":"code","cb5a496b":"code","71a86290":"code","a0fd04ec":"code","e696b5c2":"code","fc47a4f9":"code","e2e64ae9":"code","1c6de410":"code","de65246e":"code","820abdfc":"code","88775b6e":"code","e2556bac":"code","0a8519c4":"markdown","baf0cbc2":"markdown","46fc4a9c":"markdown","820139e8":"markdown","1e9d5492":"markdown","d95f1170":"markdown","c5303de6":"markdown","c8a10e39":"markdown","31cf1c27":"markdown","92580dc2":"markdown","a584189e":"markdown","f45b35cb":"markdown","3d6aa860":"markdown"},"source":{"3bceefe8":"# importing libraries\nimport pandas as pd\nimport numpy as np\nimport shap\nimport eli5\nfrom eli5.sklearn import PermutationImportance\nfrom sklearn.feature_selection import chi2\nfrom sklearn.preprocessing import RobustScaler\nfrom imblearn.over_sampling import SMOTE\nfrom sklearn.model_selection import train_test_split\nfrom xgboost import XGBClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier, RandomForestClassifier\nfrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report, roc_auc_score\nfrom catboost import CatBoostClassifier\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nplt.style.use(\"fivethirtyeight\")\nsns.set_style(\"darkgrid\")\nimport warnings\nwarnings.filterwarnings(action=\"ignore\")","068886ca":"df = pd.read_csv(\"\/kaggle\/input\/creditcardfraud\/creditcard.csv\")\ndf.head(10)","5ecc21ed":"print(f\"Dataset has {df.shape[1]} columns and {df.shape[0]} rows\")","036d1a0a":"df = df.astype(\"int32\")","cc101c5e":"df.info()","51e26dff":"# Percentage of null values\n(df.isna().sum())\/len(df)","4c482c29":"df.describe()","edda0f85":"plt.figure(figsize=(15,14))\nsns.heatmap(df.corr(), annot=True, fmt=\".1f\",cmap=\"RdBu\")","6dae4984":"plt.figure(figsize=(8,5))\nsns.distplot(df[\"Time\"],kde=True, bins=50,color=\"red\")","7bba81c2":"sns.boxplot(df[\"Amount\"],orient=\"h\")","5e43cfed":"plt.figure(figsize=(8,3))\nsns.boxplot(df[\"Time\"],orient=\"h\",palette=\"Set2\")","8ed00784":"sns.countplot(df[\"Class\"],palette=\"Set1\")\nplt.title(\"Countplot of Target Variable\")","a9560865":"rbst = RobustScaler()\ndf['Amount'] = rbst.fit_transform(df['Amount'].values.reshape(-1,1))\ndf['Time'] = rbst.fit_transform(df['Time'].values.reshape(-1,1))","00295193":"X = df.drop(\"Class\",axis=1)\ny = df.Class\n\nX_train, X_test, y_train, y_test = train_test_split(X,y, test_size=0.25,random_state=24)","cb5a496b":"smote = SMOTE(random_state=24)\nX_smote, y_smote = smote.fit_resample(X_train, y_train)","71a86290":"rf = RandomForestClassifier()\nrf.fit(X_smote, y_smote)","a0fd04ec":"y_pred2 = rf.predict(X_test)\nreport2 = classification_report(y_pred2, y_test)\nprint(report2)\nprint(f\"Accuracy: {accuracy_score(y_pred2, y_test)}\")\nprint(f\"ROC AUC Score for Random Forest Classifier: {roc_auc_score(y_pred2, y_test)}\")","e696b5c2":"xgb = XGBClassifier()\nxgb.fit(X_smote, y_smote)","fc47a4f9":"y_pred3 = xgb.predict(X_test)\nreport3 = classification_report(y_pred3, y_test)\nprint(report3)\nprint(f\"Accuracy: {accuracy_score(y_pred3, y_test)}\")\nprint(f\"ROC AUC Score for XGBoost Classifier: {roc_auc_score(y_pred3, y_test)}\")","e2e64ae9":"cat_classifier = CatBoostClassifier(iterations=250,verbose=False)\ncat_classifier.fit(X_smote, y_smote)","1c6de410":"y_pred4 = cat_classifier.predict(X_test)\nreport4 = classification_report(y_pred4, y_test)\nprint(report4)\nprint(f\"Accuracy: {accuracy_score(y_pred4, y_test)}\")\nprint(f\"ROC AUC Score for Cat Boost Classifier: {roc_auc_score(y_pred4, y_test)}\")","de65246e":"grb = GradientBoostingClassifier()\ngrb.fit(X_smote, y_smote)","820abdfc":"y_pred5 = grb.predict(X_test)\nreport5 = classification_report(y_pred5, y_test)\nprint(report5)\nprint(f\"Accuracy: {accuracy_score(y_pred5, y_test)}\")\nprint(f\"ROC AUC Score for Gradient Boosting Classifier: {roc_auc_score(y_pred5, y_test)}\")","88775b6e":"perm = PermutationImportance(rf,random_state=24).fit(X_test, y_test)\neli5.show_weights(perm, feature_names = X_test.columns.tolist())","e2556bac":"cm = confusion_matrix(y_pred2,y_test)\nsns.heatmap(cm, annot=True, fmt=\".1f\", cmap=\"icefire\")","0a8519c4":"<div class=\"alert alert-box alert-warning\">\nCatBoost Classifier\n<\/div>","baf0cbc2":"## SMOTE\n* For handling class imbalance","46fc4a9c":"# Confusion Matrix:","820139e8":"# Robust Scaler\n* RobustScaler is applied to resolve outliers in the data.","1e9d5492":"## Model Training...","d95f1170":"<div class=\"alert alert-box alert-info\">\nPlease UPVOTE the notebook if you find this insightful!\n    \nThank you:)\n<\/div>","c5303de6":"**Feature Importance**","c8a10e39":"<div class=\"alert alert-box alert-warning\">\nGradient Boosting Classifier\n<\/div>","31cf1c27":"## Splitting Data into Dependent and Independent set","92580dc2":"<div class=\"alert alert-box alert-warning\">\nXGBoost\n<\/div>","a584189e":"<h1 style=\"Font-size:200%;color:navy;\"><b>Credit Card Fraud Detection<\/b><\/h1>","f45b35cb":"**Random Forest Classifier is best Classifier in terms of ROC AUC Score. So, we will consider it.**","3d6aa860":"<div class=\"alert alert-box alert-warning\">\nRandom Forest\n<\/div>"}}