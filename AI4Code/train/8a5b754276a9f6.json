{"cell_type":{"bdff92e0":"code","601fa251":"code","0121b502":"code","9f36fa48":"code","1bef1ca8":"code","9e93b2a4":"code","59a68051":"code","85f83bc6":"code","051ed767":"code","5cb7cdb9":"code","43869926":"code","b5089fa4":"code","b1baa15b":"code","57083ab6":"code","94d8f1c2":"code","aa2f867b":"code","11ab0405":"code","6303a9c4":"code","e644a577":"code","846b9361":"code","4ef358bd":"code","c3b6ab03":"code","b86fd60e":"code","a883ea61":"code","86207a37":"markdown","bc47a502":"markdown","17d8c17c":"markdown","3e7942a2":"markdown","d27006a5":"markdown","a4329e29":"markdown","07a11be4":"markdown"},"source":{"bdff92e0":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","601fa251":"df = pd.read_csv('\/kaggle\/input\/diamonds\/diamonds.csv')","0121b502":"df.shape","9f36fa48":"df.head()","1bef1ca8":"del df['Unnamed: 0']","9e93b2a4":"df.head()","59a68051":"df['cut'].value_counts()","85f83bc6":"df['cut'].replace(('Fair','Good','Very Good','Premium','Ideal'),(1,2,3,4,5), inplace = True)","051ed767":"df['color'].value_counts()","5cb7cdb9":"df['color'].replace(('D','E','F','G','H','I','J'),(7,6,5,4,3,2,1), inplace = True)","43869926":"df['clarity'].replace(('I1','SI2','SI1','VS2','VS1','VVS2','VVS1','IF'),(1,2,3,4,5,6,7,8),inplace = True)","b5089fa4":"df.head()","b1baa15b":"df.isnull().sum()","57083ab6":"df.dtypes","94d8f1c2":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.feature_selection import SelectFromModel\nimport xgboost as xgb\nfrom sklearn.metrics import mean_squared_error, r2_score","aa2f867b":"y = df['price']\nX = df.drop('price', axis = 1)\nprint(y.shape)\nprint(X.shape)","11ab0405":"X_train,X_test,y_train,y_test = train_test_split(X,y, test_size = 0.2)","6303a9c4":"print(X_train.shape)\nprint(X_test.shape)","e644a577":"rf = RandomForestRegressor()\nrf.fit(X_train,y_train)","846b9361":"for feature in zip(X. columns, rf.feature_importances_):\n    print(feature)","4ef358bd":"lr = LinearRegression()\nlr.fit(X_train,y_train)\npred_lr = lr.predict(X_test)","c3b6ab03":"pred_rf = rf.predict(X_test)","b86fd60e":"lr_mse = mean_squared_error(y_test,pred_lr)\nrf_mse = mean_squared_error(y_test,pred_rf)\nprint(lr_mse)\nprint(rf_mse)","a883ea61":"print(r2_score(y_test,pred_lr))\nprint(r2_score(y_test,pred_rf))","86207a37":"delete 'Unnamed: 0' since this is not useful in predicting the target","bc47a502":"Feature selection with RandomForestRegressor","17d8c17c":"This indicates that only 'carat' and 'y' are the most important features in predicting target","3e7942a2":"There are no missing values and therefore we can proceed ahead with out model building activity","d27006a5":"If you like this article on diamond price prediction please give an upvote. Thanks","a4329e29":"Now every feature in the input is numerical and we want to check for any missing values in the data","07a11be4":"Rather than using Label Encode I am encoding manually since the number of classes are fewer. The drawback of label encoding in Python is that it does not recognize the natural ordering between element the classes of feature."}}