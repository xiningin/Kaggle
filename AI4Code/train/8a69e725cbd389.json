{"cell_type":{"eba52776":"code","78031f02":"code","3c955723":"code","0a28aba3":"code","2d09644a":"code","2c654c0c":"code","ff614007":"code","12069d83":"code","20d0e20a":"code","d3973f8d":"code","e3b695a8":"code","c73d443d":"code","9da6bbf9":"code","c5c233dd":"code","e89d1e1b":"code","8f4588b7":"code","2e21f990":"code","76298f3c":"code","fcaef6ac":"code","3a38370d":"code","97b591e1":"code","1f61ffbc":"code","a553f09b":"code","f77c453a":"code","f08284d0":"code","90545896":"code","1e061ea8":"code","773da807":"code","245f3d2e":"code","74d0235b":"code","35382698":"code","4cdd055c":"code","e2d73cb1":"code","05acc5c3":"code","ffad403f":"code","3792c551":"code","faebf5d5":"code","d55479e5":"code","15e2d877":"code","6625c463":"code","dc4fab82":"code","25c705bf":"code","d56a0d93":"code","16c12e03":"code","a24893c0":"code","ee34d730":"markdown","1d27ec3c":"markdown","3369e5f7":"markdown","0fd5ae52":"markdown","664dadd0":"markdown","cd4f5d5f":"markdown","c212ec0f":"markdown","c0f10a5a":"markdown","3dc19ecc":"markdown","a138b670":"markdown","c6b5062f":"markdown","37db0c53":"markdown","29ef2835":"markdown","53d7500d":"markdown","593e780f":"markdown","9960c55e":"markdown","ec681b93":"markdown","2cba78ef":"markdown","49d36130":"markdown","a33ceae5":"markdown","c9d8ef6c":"markdown","4f72692b":"markdown","86d95456":"markdown","9f3a0f49":"markdown","27e34b82":"markdown","58fd4725":"markdown","e9b827bb":"markdown","e322380e":"markdown","f0e78764":"markdown"},"source":{"eba52776":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","78031f02":"# Import Libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","3c955723":"# read files\ntotalCases = pd.read_csv(\"..\/input\/covid19-dataset\/total_cases.csv\")\ntotalDeath = pd.read_csv(\"..\/input\/covid19-dataset\/total_deaths.csv\")\nnewDeath = pd.read_csv(\"..\/input\/covid19-dataset\/new_deaths.csv\")\nnewCases = pd.read_csv(\"..\/input\/covid19-dataset\/new_cases.csv\")","0a28aba3":"world_confirmed_cases = totalCases['World'].iloc[-1]\nchina_confirmed = totalCases['China'].iloc[-1]\noutside_china_confirmed = totalCases['World'].iloc[-1] - totalCases['China'].iloc[-1]","2d09644a":"endDate = totalCases['date'].max()\nprint(f'{endDate}')\nprint()\nprint('Outside China:   {} cases'.format(outside_china_confirmed))\nprint('China:\\t\\t {} cases'.format(china_confirmed))\nprint('Total:\\t\\t {} cases'.format(world_confirmed_cases))","2c654c0c":"names = ['China','Outside China']\nvalues = [china_confirmed, outside_china_confirmed]\nplt.figure(figsize=(16, 9))\nplt.barh(names,values,color='darkred')\nplt.title('Coronavirus Confirmed Cases', size=20)\nplt.xticks(size=20)\nplt.yticks(size=20)\nplt.grid()\nplt.show()","ff614007":"df1 = totalCases.tail(1)\ndf1","12069d83":"df2 = df1.drop(df1.columns[[0,1]], axis = 1)\ndf2","20d0e20a":"df2.fillna(0)\nnp.count_nonzero(df2)","d3973f8d":"df2.idxmax(axis = 1)","e3b695a8":"df = pd.read_csv(\"..\/input\/covid19-dataset\/full_data.csv\",\n                 usecols=['date','location','total_cases'])\ndf.drop(df[df['location'] == 'World' ].index, inplace=True)\nend = df['date'].max()\ndff = (df[df['date'].eq(end)]\n       .sort_values(by='total_cases', ascending=False).head(10))\ndff","c73d443d":"plt.figure(figsize = (14,14))\nlabels = dff['location'].tolist()\nvalues = dff['total_cases'].tolist()\n#Explode = [0, 0, 0.1, 0, 0, 0, 0 , 0 , 0] \ncolors=['lightsalmon','pink','lightskyblue',\n        'lightyellow','grey','plum','peachpuff',\n        'lightgreen','aliceblue','slateblue']\nplt.title('COVID-19 Confirmed Cases per Country', size=20)\nplt.pie(values,labels = labels, autopct=\"%.1f%%\",colors=colors)#, explode = Explode)\nplt.show()","9da6bbf9":"print('Top 10 countries have the most confirmed cases: {}'. format(labels))","c5c233dd":"plt.figure(figsize=(25, 10))\nplt.plot(totalCases['date'], totalCases['United States'],color='red')\nplt.plot(totalCases['date'], totalCases['Brazil'],color='blue')\nplt.plot(totalCases['date'], totalCases['Russia'],color='orange')\nplt.plot(totalCases['date'], totalCases['United Kingdom'],color='cyan')\nplt.plot(totalCases['date'], totalCases['Italy'],color='slategray')\nplt.plot(totalCases['date'], totalCases['Germany'],color='black')\nplt.plot(totalCases['date'], totalCases['Turkey'],color='brown')\nplt.plot(totalCases['date'], totalCases['India'],color='purple')\nplt.plot(totalCases['date'], totalCases['France'],color='green')\nplt.plot(totalCases['date'], totalCases['Iran'],color='navy')\nplt.title('Total Coronavirus Cases', size=30)\nplt.xlabel('Days Since 12\/31\/2020', size=30)\nplt.ylabel('Amount', size=30)\nplt.legend(['United States', 'Spain', 'Italy',\n            'Germany', 'United Kingdom',\n            'France', 'Turkey', 'Iran',\n            'China', 'Russia'], prop={'size': 20})\nplt.xticks(rotation = 90,size=9)\nplt.yticks(size=20)\nplt.grid()\nplt.show()","e89d1e1b":"totalCases[totalCases['date'] == '2020-03-16'].index.values","8f4588b7":"dff = totalCases.iloc[76:,:]","2e21f990":"plt.figure(figsize=(25, 10))\nplt.plot(dff['date'], dff['United States'],color='red')\nplt.plot(dff['date'], dff['Brazil'],color='blue')\nplt.plot(dff['date'], dff['Russia'],color='orange')\nplt.plot(dff['date'], dff['United Kingdom'],color='cyan')\nplt.plot(dff['date'], dff['Italy'],color='slategray')\nplt.plot(dff['date'], dff['Germany'],color='black')\nplt.plot(dff['date'], dff['Turkey'],color='brown')\nplt.plot(dff['date'], dff['India'],color='purple')\nplt.plot(dff['date'], dff['France'],color='green')\nplt.plot(dff['date'], dff['Iran'],color='navy')\nplt.title('Total Coronavirus Cases', size=30)\nplt.xlabel('Days Since 03\/16\/2020', size=30)\nplt.ylabel('Amount', size=30)\nplt.legend(['United States', 'Spain', 'Italy',\n            'Germany', 'United Kingdom',\n            'France', 'Turkey', 'Iran',\n            'China', 'Russia'], prop={'size': 20})\nplt.xticks(rotation = 90,size=13)\nplt.yticks(size=20)\nplt.grid()\nplt.show()","76298f3c":"dff_death = totalDeath.iloc[76:,:]","fcaef6ac":"plt.figure(figsize=(25, 10))\nplt.plot(dff_death['date'], dff_death['United States'],color='red')\nplt.plot(dff_death['date'], dff_death['Brazil'],color='blue')\nplt.plot(dff_death['date'], dff_death['Russia'],color='orange')\nplt.plot(dff_death['date'], dff_death['United Kingdom'],color='cyan')\nplt.plot(dff_death['date'], dff_death['Italy'],color='slategray')\nplt.plot(dff_death['date'], dff_death['Germany'],color='black')\nplt.plot(dff_death['date'], dff_death['Turkey'],color='brown')\nplt.plot(dff_death['date'], dff_death['India'],color='purple')\nplt.plot(dff_death['date'], dff_death['France'],color='green')\nplt.plot(dff_death['date'], dff_death['Iran'],color='navy')\nplt.title('Total Coronavirus Death Cases', size=30)\nplt.xlabel('Days Since 03\/16\/2020', size=30)\nplt.ylabel('Amount', size=30)\nplt.legend(['United States', 'Spain', 'Italy',\n            'Germany', 'United Kingdom',\n            'France', 'Turkey', 'Iran',\n            'China', 'Russia'], prop={'size': 20})\nplt.xticks(rotation = 90,size=13)\nplt.yticks(size=20)\nplt.grid()\nplt.show()","3a38370d":"us20 = totalCases.tail(20)","97b591e1":"plt.figure(figsize=(10, 7))\nplt.bar(\"date\", \"United States\", data = us20, color = \"darkred\") \nplt.plot(us20['date'], us20['United States'],color = 'black')\nplt.xlabel(\"Dates\", size=20) \nplt.ylabel(\"Amount\", size=20)\nplt.title(\"Last 20 Days Confirmed Cases in US\", size=20)\nplt.xticks(rotation = 70,size=13)\nplt.yticks(size=13)\nplt.grid()\nplt.show()","1f61ffbc":"usDeath20 = totalDeath.tail(20)\nplt.figure(figsize=(10, 7))\nplt.bar(\"date\", \"United States\", data = usDeath20, color = \"darkred\") \nplt.plot(usDeath20['date'], usDeath20['United States'],color = 'black')\nplt.xlabel(\"Dates\", size=20) \nplt.ylabel(\"Amount\", size=20)\nplt.title(\"Last 20 Days Death Cases in US\", size=20)\nplt.xticks(rotation = 70,size=13)\nplt.yticks(size=13)\nplt.grid()\nplt.show()","a553f09b":"mortalityRate = (totalDeath['United States'].iloc[-1]) \/ (totalCases['United States'].iloc[-1])\nmortalityRate","f77c453a":"newCases20 = newCases.tail(20)\nnewDeath20 = newDeath.tail(20)","f08284d0":"plt.figure(figsize=(16, 9))\nplt.plot(usDeath20['date'], usDeath20['United States'],color='red')\nplt.plot(us20['date'], us20['United States'],color='green')\nplt.plot(newDeath20['date'],newDeath20['United States'])\nplt.plot(newCases20['date'],newCases20['United States'])\nplt.legend(['Total Death', 'Total Confirmed','New Death','New Confirmed'], prop={'size': 15})\nplt.xlabel(\"Dates\", size=20) \nplt.ylabel(\"Amount\", size=20)\nplt.title(\"Late 20 Days Coronavirus Cases in US\", size=20)\nplt.xticks(rotation = 70,size=13)\nplt.yticks(size=13)\nplt.grid()\nplt.show()","90545896":"plt.figure(figsize=(16, 9))\n\nnewCases10 = newCases.tail(10)\nnewDeath10 = newDeath.tail(10)\n\nplt.plot(newDeath10['date'],newDeath10['United States'],color = 'r', marker = 'o')\nplt.plot(newCases10['date'],newCases10['United States'],color = 'g', marker = 'o')\nplt.legend(['New Death','New Confirmed'], prop={'size': 15})\nplt.title('New Confirmed VS. New Death in US (last 10 days)',size=25)\nplt.ylabel('Amount', size=20)\nplt.xlabel('Dates', size=20)\nplt.grid()\nplt.show()","1e061ea8":"plt.figure(figsize=(16, 9))\n\nnewCases10 = newCases.tail(10)\nnewDeath10 = newDeath.tail(10)\nwidth = 0.5\n\np1 = plt.bar(newCases10['date'], newCases10['United States'], width)\np2 = plt.bar(newDeath10['date'], newDeath10['United States'], width)\n\nplt.title('New Confirmed VS. New Death in US (last 10 days)',size=25)\nplt.ylabel('Amount', size=20)\nplt.xlabel('Dates', size=20)\nplt.legend((p1[0], p2[0]), ('New Confirmed', 'New Death'))\nplt.grid()\nplt.show()","773da807":"full_data = pd.read_csv(\"..\/input\/covid19-dataset\/full_data.csv\")","245f3d2e":"df_us = full_data[full_data['location'] == 'United States']\ndf_us.head()","74d0235b":"df21 = df_us.iloc[21:,:]\ndf21.tail()","35382698":"from sklearn.model_selection import train_test_split\nfrom sklearn.svm import SVR\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.metrics import mean_squared_error, mean_absolute_error\nimport datetime","4cdd055c":"dates = df21['date']\ntotal_cases = df21['total_cases']","e2d73cb1":"days_since_1_21 = np.array([i for i in range(len(dates))]).reshape(-1, 1)\ntotal_cases = np.array(total_cases).reshape(-1, 1)","05acc5c3":"days_in_future = 10\nfuture_forcast = np.array([i for i in range(len(dates)+days_in_future)]).reshape(-1, 1)\nadjusted_dates = future_forcast[:-10]","ffad403f":"X_train_confirmed, X_test_confirmed, y_train_confirmed, y_test_confirmed = train_test_split(days_since_1_21[50:], total_cases[50:], test_size=0.16, shuffle=False) ","3792c551":"svm_confirmed = SVR(shrinking=True, kernel='poly',gamma=0.01, epsilon=1,degree=3, C=0.1)\nsvm_confirmed.fit(X_train_confirmed, y_train_confirmed)\nsvm_pred = svm_confirmed.predict(future_forcast)","faebf5d5":"svm_test_pred = svm_confirmed.predict(X_test_confirmed)\nplt.plot(y_test_confirmed)\nplt.plot(svm_test_pred)\nplt.legend(['Test Data', 'SVM Predictions'])\nprint('MAE:', mean_absolute_error(svm_test_pred, y_test_confirmed))\nprint('MSE:',mean_squared_error(svm_test_pred, y_test_confirmed))\nplt.grid()\nplt.show()","d55479e5":"poly = PolynomialFeatures(degree=5)\npoly_X_train_confirmed = poly.fit_transform(X_train_confirmed)\npoly_X_test_confirmed = poly.fit_transform(X_test_confirmed)\npoly_future_forcast = poly.fit_transform(future_forcast)","15e2d877":"linear_model = LinearRegression(normalize=True, fit_intercept=False)\nlinear_model.fit(poly_X_train_confirmed, y_train_confirmed)\ntest_linear_pred = linear_model.predict(poly_X_test_confirmed)\nlinear_pred = linear_model.predict(poly_future_forcast)\nprint('MAE:', mean_absolute_error(test_linear_pred, y_test_confirmed))\nprint('MSE:',mean_squared_error(test_linear_pred, y_test_confirmed))","6625c463":"plt.plot(y_test_confirmed)\nplt.plot(test_linear_pred)\nplt.legend(['Test Data', 'Polynomial Regression Predictions'])\nplt.grid()\nplt.show()","dc4fab82":"plt.figure(figsize=(14, 7))\nplt.bar(df21['date'], df21['new_cases'])\nplt.title('US Daily Increases in Confirmed Cases', size=30)\nplt.xlabel('Days Since 1\/21\/2020', size=30)\nplt.ylabel('# of Cases', size=30)\nplt.xticks(rotation = 70,size=4)\nplt.yticks(size=20)\nplt.show()","25c705bf":"plt.figure(figsize=(14, 7))\nplt.bar(df21['date'], df21['new_deaths'])\nplt.title('US Daily Increases in Confirmed Deaths', size=30)\nplt.xlabel('Days Since 1\/21\/2020', size=30)\nplt.ylabel('# of Cases', size=30)\nplt.xticks(rotation = 70,size=4)\nplt.yticks(size=20)\nplt.show()","d56a0d93":"def plot_predictions(x, y, pred, algo_name, color):\n    plt.figure(figsize=(14, 5))\n    plt.plot(x, y)\n    plt.plot(future_forcast, pred, linestyle='dashed', color=color)\n    plt.title('# of Coronavirus Cases Over Time', size=20)\n    plt.xlabel('Days Since 1\/21\/2020', size=15)\n    plt.ylabel('# of Cases', size=15)\n    plt.legend(['Confirmed Cases', algo_name], prop={'size': 15})\n    plt.xticks(size=15)\n    plt.yticks(size=15)\n    plt.show()","16c12e03":"plot_predictions(adjusted_dates, df21['total_cases'], svm_pred, 'SVM Predictions', 'purple')","a24893c0":"plot_predictions(adjusted_dates, df21['total_cases'], linear_pred, 'Polynomial Regression Predictions', 'orange')","ee34d730":"**We got 210 countries, let's see if there are some countries have not been infected (means the cases is 0)**","1d27ec3c":"## **Syllabus of this notebook:**\n* **initial exploratory data analysis**\n* **data visualization of confirmed cases in different countries**\n* **confirmed cases trends in 10 countries with the most cases**\n* **in-depth analysis on US coronavirus cases**\n* **US confirmed cases prediction**","3369e5f7":"**Find the Top 10 countries that have the most confirmed cases**","0fd5ae52":"## **Modify the data to fit the model better**","664dadd0":"**We can see the number of cases in each country on the last day of the dataset**","cd4f5d5f":"# **Analysis on US coronavirus cases**","c212ec0f":"> You can use \"explode\" to let the country stand out","c0f10a5a":"**Let's see more clearly through bar chart (It\u2019s shocking how quickly this virus spread)**","3dc19ecc":"## **Let's look closer at how the cases look in US in the last 20 days.**","a138b670":"**We can roughly say that the mortality rate is about 6% in US on the last day of the dataset. It means infected people have a 6% chance of dying from coronavirus... **","c6b5062f":"**Pie chart**\n>***(link for colors codes and names: https:\/\/htmlcolorcodes.com\/color-names\/)***","37db0c53":"** From this line chart, we can see the rising curve of US is the steepest in these 10 countries. The change in quantity is not particularly noticeable before 03\/16\/2020, so we\u2019ll get rid of this part in the following chart.**","29ef2835":"## **As we see, US has the most confirmed cases right now**","53d7500d":"## **Model for predicting US confirmed cases**\nI am using support vector machine and linear regression","593e780f":"## **Furture forcasting**","9960c55e":"## **US daily increases**\nnew confirmed cases and new deaths cases","ec681b93":"# **Data Visualization of Confirmed Cases in Different Countries**","2cba78ef":"## **Q: Are there some countries that have not been infected so far? Which country has the most confirmed cases now?**\n***We guess US has the most cases, let's check if it is right.***","49d36130":"**Remove first two columns () to get only country data**","a33ceae5":"# **Confirmed cases trends**","c9d8ef6c":"## **We can see 210 countries have already been infected**","4f72692b":"### **As we see: **\n* **before 04\/11\/2020, UK had the most death cases**\n* **after that, death cases in US continues to grow faster than other 9 countries**\n","86d95456":"**We can use the line chart and the bar chart to visualize the relationship between new confirmed cases and new death cases in the last 10 days.**","9f3a0f49":"**After 03\/27\/2020, US continues to have the most confirmed cases.**\n\n**Let's have a look at how death cases look in these countries.**","27e34b82":"# **US confirmed cases prediction**","58fd4725":"## **Predictions for confirmed coronavirus cases in US**","e9b827bb":"# **Exploratory Data Analysis**","e322380e":"**Get the last day's data of \"World\" and \"China\" from dataset**","f0e78764":"**This notebook provides a detailed analysis of the Top 10 countries with the most coronavirus cases and the predicton of US confirmed cases. This is a countinuation of my previous analysis on the growth of coronavirus cases (link to previous notebook below). **\n> **Coronavirus (COVID-19) Bar Chart Race:\nhttp:\/\/www.kaggle.com\/minaliu314\/coronavirus-covid-19-bar-chart-race**\n\n![](https:\/\/estaticos.elperiodico.com\/resources\/jpg\/5\/9\/1583931660595.jpg)"}}