{"cell_type":{"92f4dad8":"code","6d8675d4":"code","35d96cc8":"code","badde68a":"code","1968530d":"code","b012ef49":"code","d1dc4676":"code","206385cd":"markdown","3c59ac29":"markdown","38f1e122":"markdown"},"source":{"92f4dad8":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","6d8675d4":"df_train_raw = pd.read_csv(\"..\/input\/tensorflow-great-barrier-reef\/train.csv\")\ndf_train_raw","35d96cc8":"df_train_raw[df_train_raw[\"annotations\"] != '[]']","badde68a":"df_train_raw[df_train_raw[\"annotations\"] == '[]']","1968530d":"from PIL import Image, ImageDraw\nimport ast\n\ndef fetch_image_list(df_tmp, video_id, num_images, start_frame_idx):\n    def fetch_image(frame_id):\n        path_base = '\/kaggle\/input\/tensorflow-great-barrier-reef\/train_images\/video_{}\/{}.jpg'\n        raw_img = Image.open(path_base.format(video_id, frame_id))\n\n        row_frame = df_tmp[(df_tmp.video_id == video_id) & (df_tmp.video_frame == frame_id)].iloc[0]\n        bounding_boxes = ast.literal_eval(row_frame.annotations)\n\n        for box in bounding_boxes:\n            draw = ImageDraw.Draw(raw_img)\n            x0, y0, x1, y1 = (box['x'], box['y'], box['x']+box['width'], box['y']+box['height'])\n            draw.rectangle( (x0, y0, x1, y1), outline=180, width=3)\n        return raw_img\n\n    return [np.array(fetch_image(start_frame_idx + index)) for index in range(num_images)]\n\nimages = fetch_image_list(df_train_raw, video_id = 0, num_images = 80, start_frame_idx = 25)","b012ef49":"print(\"Num images: \", len(images))\nplt.imshow(images[10], interpolation='nearest')\nplt.axis('off')\nplt.show()","d1dc4676":"from matplotlib import animation, rc\nrc('animation', html='jshtml')\n\n\ndef create_animation(ims):\n    fig = plt.figure(figsize=(9, 9))\n    plt.axis('off')\n    im = plt.imshow(ims[0])\n\n    def animate_func(i):\n        im.set_array(ims[i])\n        return [im]\n\n    return animation.FuncAnimation(fig, animate_func, frames = len(ims), interval = 1000\/\/12)\n\ncreate_animation(images)\n","206385cd":"## Dataset without annotations","3c59ac29":"## Visualize the images","38f1e122":"## Dataset with annotations"}}