{"cell_type":{"02f24a8c":"code","976f6ecd":"code","c8c95564":"code","5e523cac":"code","ecc363a2":"code","54826a7a":"code","87dbfeab":"code","39cfd0e2":"code","70bf1bd4":"code","49cea57f":"code","e45672b1":"code","9e8c19cc":"code","818e8250":"code","3276239c":"code","fec813c2":"markdown","2e46cf59":"markdown","f52166ed":"markdown","d5a5b947":"markdown","4a5daca3":"markdown","324801d7":"markdown","d1028a1f":"markdown","34bef71f":"markdown","bb3228ab":"markdown","53651cae":"markdown","30912f3e":"markdown","28565dd2":"markdown","2bacd5d5":"markdown"},"source":{"02f24a8c":"%%time\n!pip install bert-extractive-summarizer","976f6ecd":"%%time\n!pip install transformers==2.2.0","c8c95564":"%%time\n!pip install spacy==2.0.12","5e523cac":"import numpy as np\nimport pandas as pd\n\nimport matplotlib\nimport matplotlib.pyplot as plt\n\nfrom summarizer import Summarizer,TransformerSummarizer\nfrom sklearn.metrics import accuracy_score\n\nimport warnings\nwarnings.filterwarnings('ignore')","ecc363a2":"# Thanks to https:\/\/www.kaggle.com\/vbmokin\/nlp-for-en-bert-classification-for-water-report\ndf = pd.read_csv('..\/input\/nlp-reports-news-classification\/water_problem_nlp_en_for_Kaggle_100.csv', delimiter=';', header=0)\ndf = df.fillna(0)\n\nconvert_dict = {'text': str, \n                'env_problems': int,\n                'pollution': int, \n                'treatment': int,\n                'climate': int,\n                'biomonitoring': int} \n  \ndf = df.astype(convert_dict)\ndf = df[:5]\ndf","54826a7a":"df.info()","87dbfeab":"df['text'].head(10)","39cfd0e2":"df['text'].str.len().max()","70bf1bd4":"# Creation the list with new long block\nmax_length = 400  # minimum characters in each block\ni = 0\nbodies = []\nwhile i < len(df):\n    body = \"\"\n    body_empty = True\n    while (len(body) < max_length) and (i < len(df)):\n        if body_empty:\n            body = df.loc[i,'text']\n            body_empty = False\n        else: body += \" \" + df.loc[i,'text']\n        i += 1\n    bodies.append(body)\n    print(\"Length of blocks =\", len(body))\nprint(f\"\\nNumber of text blocks = {len(bodies)}\\n\")\nprint(\"Text blocks:\\n\", bodies)","49cea57f":"min_length_text = 40","e45672b1":"%%time\nbert_summary = []\nfor i in range(len(bodies)):\n    bert_model = Summarizer()\n    bert_summary.append(''.join(bert_model(bodies[i], min_length=min_length_text)))","9e8c19cc":"%%time\ngpt_summary = []\nfor i in range(len(bodies)):\n    GPT2_model = TransformerSummarizer(transformer_type=\"GPT2\",transformer_model_key=\"gpt2-medium\")\n    gpt_summary.append(''.join(GPT2_model(bodies[i], min_length=min_length_text)))","818e8250":"%%time\nxlnet_summary = []\nfor i in range(len(bodies)):\n    model = TransformerSummarizer(transformer_type=\"XLNet\",transformer_model_key=\"xlnet-base-cased\")\n    xlnet_summary.append(''.join(model(bodies[i], min_length=min_length_text)))","3276239c":"%%time\nprint(\"All Summarizing Results:\\n\")\nfor i in range(len(bodies)):\n    print(\"ORIGINAL TEXT:\")\n    print(bodies[i])\n    print(\"\\nBERT Summarizing Result:\")\n    print(bert_summary[i])\n    print(\"\\nGPT-2 Summarizing Result:\")\n    print(gpt_summary[i])\n    print(\"\\nXLNet Summarizing Result:\")\n    print(xlnet_summary[i])\n    print(\"\\n\\n\")","fec813c2":"<a class=\"anchor\" id=\"0.1\"><\/a>\n## Table of Contents\n\n1. [Install and import libraries](#1)\n1. [Download data](#2)\n1. [Text Summarizing](#3)\n    -  [BERT Summarizing](#3.1)\n    -  [GPT-2 Summarizing](#3.2)\n    -  [XLNet Summarizing](#3.3)\n1. [Results](#4)","2e46cf59":"# Acknowledgements\n\nThis notebook uses such good notebooks: \n* BERT, GPT2, XLNET summarizing from the notebook [Text Summarization using BERT, GPT2,XLNET](https:\/\/www.kaggle.com\/pemagrg\/text-summarization-using-bert-gpt2-xlnet)\n* data download from my notebook [NLP for EN : BERT Classification for Water Report](https:\/\/www.kaggle.com\/vbmokin\/nlp-for-en-bert-classification-for-water-report)\n\nMy dataset [NLP : Reports & News Classification](https:\/\/www.kaggle.com\/vbmokin\/nlp-reports-news-classification)","f52166ed":"I hope you find this notebook useful and enjoyable.","d5a5b947":"### 3.3. XLNet Summarizing <a class=\"anchor\" id=\"3.3\"><\/a>\n\n[Back to Table of Contents](#0.1)","4a5daca3":"### 3.1. BERT Summarizing <a class=\"anchor\" id=\"3.1\"><\/a>\n\n[Back to Table of Contents](#0.1)","324801d7":"## 2. Download data <a class=\"anchor\" id=\"2\"><\/a>\n\n[Back to Table of Contents](#0.1)","d1028a1f":"### 3.2. GPT-2 Summarizing <a class=\"anchor\" id=\"3.2\"><\/a>\n\n[Back to Table of Contents](#0.1)","34bef71f":"## 1. Install and import libraries <a class=\"anchor\" id=\"1\"><\/a>\n\n[Back to Table of Contents](#0.1)","bb3228ab":"<a class=\"anchor\" id=\"0\"><\/a>\n# [NLP : Reports & News Classification](https:\/\/www.kaggle.com\/vbmokin\/nlp-reports-news-classification)\n## Automatic Environmental Reports & News Classification (English)","53651cae":"Your comments and feedback are most welcome.","30912f3e":"## 4. Results <a class=\"anchor\" id=\"4\"><\/a>\n\n[Back to Table of Contents](#0.1)","28565dd2":"[Go to Top](#0)","2bacd5d5":"## 3. Text Summarizing <a class=\"anchor\" id=\"3\"><\/a>\n\n[Back to Table of Contents](#0.1)"}}