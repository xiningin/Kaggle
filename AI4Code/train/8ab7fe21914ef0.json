{"cell_type":{"167fa65c":"code","aafacf6e":"code","d116ac22":"code","5f586538":"code","a0b7314f":"code","bac40cd2":"code","36215df7":"markdown"},"source":{"167fa65c":"import numpy as np\nimport pandas as pd\nimport os\nimport sys\nfrom tensorflow.keras.models import load_model\nimport cv2\nimport skimage.io\n\nsys.path.insert(0, '\/kaggle\/input\/efficientnet-keras-source-code\/')\nimport efficientnet.tfkeras as efn","aafacf6e":"img_size = 512\ntest_dir = '\/kaggle\/input\/prostate-cancer-grade-assessment\/test_images'\nmodel = load_model('\/kaggle\/input\/panda-tpu-starter-train\/model.h5')","d116ac22":"def get_image(img_name):\n    data_dir = test_dir\n    img_path = os.path.join(data_dir, f'{img_name}.tiff')    \n    img = skimage.io.MultiImage(img_path)        \n    img = cv2.resize(img[-1], (img_size, img_size))    \n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n    img = img \/ 255\n    return img","5f586538":"sub = pd.read_csv('\/kaggle\/input\/prostate-cancer-grade-assessment\/sample_submission.csv')\ntest_images = sub['image_id'].values","a0b7314f":"labels = []\ntry:\n    for image in test_images:                \n        img = get_image(image)    \n        im1 = img.reshape((1, img_size, img_size, 3))    \n        preds = model.predict(im1, batch_size=1)    \n        result = np.argmax(preds ,axis = 1)               \n        labels.append(result)\n    sub['isup_grade'] = labels\nexcept:\n    print('exception')","bac40cd2":"sub['isup_grade'] = sub['isup_grade'].astype(int)\nsub.to_csv('submission.csv', index=False)\nsub.head()","36215df7":"Training kernel: https:\/\/www.kaggle.com\/ateplyuk\/panda-tpu-starter-train"}}