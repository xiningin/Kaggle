{"cell_type":{"a5b9de68":"code","31fd3d81":"code","6641630f":"code","f10e5ba0":"code","e01b439c":"code","afc8213e":"code","ff1ddadd":"code","abde7a16":"code","cc83d265":"markdown","ed546fd0":"markdown","66127708":"markdown","1f261893":"markdown","c521ed1c":"markdown","b042f144":"markdown","c7c0397e":"markdown","1e8ac856":"markdown","42f84ff6":"markdown","46e810b4":"markdown","a7b4e10c":"markdown","0745774e":"markdown","a293488f":"markdown"},"source":{"a5b9de68":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport pydicom\nimport os\nimport albumentations as A\nimport torch\ntrain = pd.read_csv('..\/input\/osic-pulmonary-fibrosis-progression\/train.csv')\ngpu = torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\")\ngpu","31fd3d81":"def show_images(images, read_region=(1780,1950)):\n    f, ax = plt.subplots(3,3, figsize=(16,18))\n    \n    for i, image in enumerate(images):\n        image_path = os.path.join('..\/input\/osic-pulmonary-fibrosis-progression',\"train\/ID00007637202177411956430\",image+'.dcm')\n        image = pydicom.dcmread(image_path)\n        ax[i\/\/3, i%3].imshow(image.pixel_array) \n        ax[i\/\/3, i%3].axis('off')\n\n    plt.show()\nimages = [\n    '1', '2', '3',\n    '4', '5', '6',\n    '7', '8', '9']   \nshow_images(images)\n","6641630f":"import cv2\ndef show_images(images, aug_dict, read_region=(1780,1950)):\n    f, axes = plt.subplots(len(augs),6, figsize=(20, 2 * len(augs)), squeeze=False);\n    \n    for i, im in enumerate(images):\n        \n        for i, (key, aug) in enumerate(aug_dict.items()):\n            for j in range(6):\n                ax = axes[i, j]\n                if j == 0:\n                    ax.text(0.5, 0.5, key, horizontalalignment='center', verticalalignment='center', fontsize=15)\n                    ax.get_xaxis().set_visible(False);\n                    ax.get_yaxis().set_visible(False);\n                    ax.axis('off')\n                else:\n                    image_path = '..\/input\/osic-pulmonary-fibrosis-progression\/' + \"train\/ID00007637202177411956430\/\" + str(j) +'.dcm'\n                    image = pydicom.dcmread(image_path).pixel_array\n                    if aug is not None:\n                        image = aug(image=image)['image']\n                    ax.imshow(image, cmap='bone');\n        plt.tight_layout()\n        plt.show();\n        plt.close()\n\n    plt.show();\nimages = [\n    '1', '19', '13',\n    '11', '5']   \naugs = {'Original': None,\n             'Blur': A.Blur(p=1.0),\n             'MedianBlur': A.MedianBlur(blur_limit=5, p=1.0),\n             'GaussianBlur': A.GaussianBlur(p=1.0),\n             'MotionBlur': A.MotionBlur(p=1.0)\n       }\nshow_images(images, augs)\n","f10e5ba0":"augs = {'Original': None,\n             'GridDropout': A.GridDropout(p=1.0),\n        #     'ChannelDropout': A.ChannelDropout(p=1.0)\n       }\nshow_images(images, augs)","e01b439c":"augs = {'Original': None,\n             'RandomCrop': A.RandomCrop(height=64, width=64, p=1.0),\n         'CenterCrop': A.CenterCrop(height=64, width=64, p=1.0),\n        'RandomSizedCrop': A.RandomSizedCrop((90, 100), 64, 64)\n       }\nshow_images(images, augs)","afc8213e":"augs = {'Original': None,\n             'RandomRotate90': A.RandomRotate90(p=1.0),\n         'ShiftScaleRotate': A.ShiftScaleRotate(p=1.0),\n        'Rotate': A.Rotate()\n       }\nshow_images(images, augs)","ff1ddadd":"def show_imagesunit8(images, aug_dict, read_region=(1780,1950)):\n    f, axes = plt.subplots(len(augs),6, figsize=(20, 2 * len(augs)), squeeze=False);\n    \n    for i, im in enumerate(images):\n        \n        for i, (key, aug) in enumerate(aug_dict.items()):\n            for j in range(6):\n                ax = axes[i, j]\n                if j == 0:\n                    ax.text(0.5, 0.5, key, horizontalalignment='center', verticalalignment='center', fontsize=15)\n                    ax.get_xaxis().set_visible(False);\n                    ax.get_yaxis().set_visible(False);\n                    ax.axis('off')\n                else:\n                    image_path = '..\/input\/osic-pulmonary-fibrosis-progression\/' + \"train\/ID00007637202177411956430\/\" + str(j) +'.dcm'\n                    image = pydicom.dcmread(image_path).pixel_array.astype(\"uint8\")\n                    if aug is not None:\n                        image = aug(image=image)['image']\n                    ax.imshow(image, cmap='bone');\n        plt.tight_layout()\n        plt.show();\n        plt.close()\n\naugs = {'Original': None,\n             'Solarize': A.Solarize(p=1.0),\n         'Posterize': A.Posterize(p=1.0),\n        'Equalize': A.Equalize(),\n        'Downscale': A.Downscale()\n       }\nshow_imagesunit8(images, augs)","abde7a16":"augs = {'Original': None,\n             'GaussNoise': A.GaussNoise(p=1.0)\n       }\nshow_imagesunit8(images, augs)","cc83d265":"<h1 id=\"blur\">Blur-based augs<\/h1>","ed546fd0":"<h1 id=\"snbt\">Scaling and normalization-based transforms<\/h1>","66127708":"This is the end of my not-so-pedagogical notebook which takes a surface level scan of these augmentations to introduce them to people who aren't familiar.\n\nThere are some other resources for learning about this are:\n+ https:\/\/albumentations.readthedocs.io\/en\/latest\/api\/augmentations.html <br>\n**These are the official docs for albumentations, please read.** <br>\n+ https:\/\/github.com\/albumentations-team\/albumentations <br>\n**This is the GitHub for albumentations.** <br>\n+ https:\/\/www.kaggle.com\/shonenkov\/nlp-albumentations <br>\n**Perhaps the most creative use of any sort of albumentations I have ever seen.** <br>\n+ https:\/\/albumentations.ai\/ <br>\n**The official albumentations website.** <br>\n","1f261893":"<h1 id=\"dropout\">Dropout augmentations<\/h1>","c521ed1c":"<h1 id=\"rt\">Rotation-based transforms<\/h1>\n\nThese are primarily oriented towards rotation of the image.","b042f144":"Dropout augmentations we're going to be applying here (with their description from the [albumentations docs](https:\/\/albumentations.readthedocs.io\/en\/latest\/api\/augmentations.html)) are:\n\n+ GridDropout\n> GridDropout, drops out rectangular regions of an image and the corresponding mask in a grid fashion.\n+ ChannelDropout\n> Randomly Drop Channels in the input Image.\n","c7c0397e":"This is a simple set of:\n+ Blur\n+ GaussianBlur\n+ MedianBlur\n+ MotionBlur","1e8ac856":"These principally revolve around transforms which scale the image, normalize it, invert pixel values etc.","42f84ff6":"<h1 id=\"cbt\">Crop-based augmentations<\/h1>\n\nThis kind of augmentations are primarily oriented towards croppnig an image in its many forms and sizes.","46e810b4":"# OSIC: augmentations tutorial w\/ albumentations \n\nIn any good deep learning model pipeline, it is **always** essential to be able to augment data, as it gives you the advantage of your model generalizing well. As such, here is a tutorial on data augmentations (especially those for images) with the library albumentations developed by notable Kagglers such as Dr. Vladimir Iglovikov and Eugene Khvedchenya.\n\nAlbumentations themselves quote:\n> Image augmentation is a process of creating new training examples from the existing ones. To make a new sample, you slightly change the original image. For instance, you could make a new image a little brighter; you could cut a piece from the original image; you could make a new image by mirroring the original one, etc.\n\n\n\n<hr>\n\n### TOC:\n\n+ <a href=\"#blur\">Blur-based Augmentations <\/a><br>\n+ <a href=\"#dropout\">Dropout Augmentations <\/a><br>\n+ <a href=\"#cbt\">Crop-based Augmentations <\/a><br>\n+ <a href=\"#rt\">Rotation-based Augmentations<\/a><br>\n+ <a href=\"#snbt\">Scaling and normalization-based transforms<\/a>\n+ <a href=\"#ns\">Noise-based transforms<\/a>","a7b4e10c":"# Further Resources","0745774e":"<h1 id=\"ns\">Noise based transforms<\/h1>\n\nThese primarily are meant to add some sort of artificial noise to our image.","a293488f":"These are a few of our sample images present in the dataset. Let us now commence our albumentations tutorial, with simple blur-based augmentations."}}