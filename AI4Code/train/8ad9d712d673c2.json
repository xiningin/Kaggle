{"cell_type":{"4e35b6a2":"code","041cca0b":"code","b4520da0":"code","c92aeb62":"code","964245e8":"code","00a278f6":"code","52f59f2d":"code","b887c1c8":"code","68e9b54e":"code","b0911d5e":"code","2a0127e2":"markdown","e3af7fed":"markdown","091c72a8":"markdown","3bb061f8":"markdown","88360cbb":"markdown"},"source":{"4e35b6a2":"%%time\n\n# https:\/\/www.kaggle.com\/cdeotte\/rapids\n\nimport sys\n!cp ..\/input\/rapids\/rapids.0.12.0 \/opt\/conda\/envs\/rapids.tar.gz\n!cd \/opt\/conda\/envs\/ && tar -xzvf rapids.tar.gz > \/dev\/null\nsys.path = [\"\/opt\/conda\/envs\/rapids\/lib\/python3.6\/site-packages\"] + sys.path\nsys.path = [\"\/opt\/conda\/envs\/rapids\/lib\/python3.6\"] + sys.path\nsys.path = [\"\/opt\/conda\/envs\/rapids\/lib\"] + sys.path \n!cp \/opt\/conda\/envs\/rapids\/lib\/libxgboost.so \/opt\/conda\/lib\/","041cca0b":"%%time\n\nimport os\n\nfrom pathlib import Path\n\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\nfrom sklearn.metrics import accuracy_score, confusion_matrix\nfrom sklearn.model_selection import train_test_split\nfrom cuml.svm import SVR","b4520da0":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","c92aeb62":"%%time\n\npath_input = Path('\/kaggle\/input\/digit-recognizer\/')\n\ndf_train = pd.read_csv(path_input \/ 'train.csv')\ndf_test  = pd.read_csv(path_input \/ 'test.csv')\n\nX_train = df_train.iloc[:, 1:].values.reshape(-1, 28, 28).astype(np.float32)\ny_train = df_train.iloc[:, 0 ].values\n\nX_train, X_valid, y_train, y_valid = train_test_split(X_train, y_train, random_state=42)\n\nX_test  = df_test.values.reshape(-1, 28, 28).astype(np.float32)","964245e8":"fig = plt.figure(figsize=(18, 9))\nfor row in range(5):\n    for col in range(10):\n        ax = fig.add_subplot(5, 10, 1+10*row+col)\n        ax.imshow(X_train[10*row+col])\n        ax.set_axis_off()\n        ax.set_title(y_train[10*row+col])","00a278f6":"%%time\n\nmodel = SVR()\nmodel.fit(X_train.reshape(-1, 28*28), y_train)","52f59f2d":"%%time\n\nh_valid = model.predict(X_valid.reshape((-1, 28*28)))\nh_valid = np.clip(np.round(h_valid.values.get()), 0, 9)","b887c1c8":"confusion_matrix(y_valid, h_valid)","68e9b54e":"accuracy_score(y_valid, h_valid)","b0911d5e":"fig = plt.figure(figsize=(18, 9))\nfor row in range(5):\n    for col in range(10):\n        ax = fig.add_subplot(5, 10, 1+10*row+col)\n        ax.imshow(X_valid[y_valid != h_valid][10*row+col])\n        ax.set_axis_off()\n        ax.set_title(h_valid[y_valid != h_valid][10*row+col])","2a0127e2":"# Train","e3af7fed":"# Import libraries","091c72a8":"# Predict","3bb061f8":"# Load datasets","88360cbb":"# validation"}}