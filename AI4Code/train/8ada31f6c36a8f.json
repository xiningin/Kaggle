{"cell_type":{"3da6b995":"code","17fa6b14":"code","e01bebab":"code","5ca44c55":"code","aced1f40":"code","2586007e":"code","4def6a7a":"code","ece163a2":"code","bd5f96ae":"code","a01a1faa":"code","fd656893":"code","731ec9d5":"code","97f0cba0":"code","ef482510":"code","a87a0bd0":"code","c5b8808e":"code","facf0af9":"code","799fabce":"markdown","f439126f":"markdown"},"source":{"3da6b995":"import numpy as np\nimport pandas as pd\nimport os,random,time\nfrom sklearn.model_selection import train_test_split\nimport torch\nfrom torchvision import transforms\nfrom PIL import Image\nfrom torch.utils.data import Dataset,DataLoader\nimport torch.nn.functional as F\nimport json\nimport matplotlib.pyplot  as plt                   \nimport cv2","17fa6b14":"import json, codecs\nwith codecs.open(\"..\/input\/herbarium-2020-fgvc7\/nybg2020\/train\/metadata.json\", 'r',\n                 encoding='utf-8', errors='ignore') as f:\n    train_meta = json.load(f)\n    \nwith codecs.open(\"..\/input\/herbarium-2020-fgvc7\/nybg2020\/test\/metadata.json\", 'r',\n                 encoding='utf-8', errors='ignore') as f:\n    test_meta = json.load(f)","e01bebab":"train_meta.keys()","5ca44c55":"train_meta","aced1f40":"sample_sub = pd.read_csv('..\/input\/herbarium-2020-fgvc7\/sample_submission.csv')\ndisplay(sample_sub)","2586007e":"train_df=pd.DataFrame(train_meta['annotations'])\ntrain_df.head()","4def6a7a":"train_cat=pd.DataFrame(train_meta['categories'])\ntrain_cat.columns = ['family', 'genus', 'category_id', 'category_name']\ntrain_cat.head()","ece163a2":"train_img=pd.DataFrame(train_meta['images'])\ntrain_img.columns = ['file_name', 'height', 'image_id', 'license', 'width']\ntrain_img.head()","bd5f96ae":"train_reg = pd.DataFrame(train_meta['regions'])\ntrain_reg.columns = ['region_id', 'region_name']\ntrain_reg.head()","a01a1faa":"train_df = train_df.merge(train_cat, on='category_id', how='outer')\ntrain_df = train_df.merge(train_img, on='image_id', how='outer')\ntrain_df = train_df.merge(train_reg, on='region_id', how='outer')","fd656893":"train_df.head()","731ec9d5":"na = train_df.file_name.isna()\nkeep = [x for x in range(train_df.shape[0]) if not na[x]]\ntrain_df = train_df.iloc[keep]","97f0cba0":"dtypes = ['int32', 'int32', 'int32', 'int32', 'object', 'object', 'object', 'object', 'int32', 'int32', 'int32', 'object']\nfor n, col in enumerate(train_df.columns):\n    train_df[col] = train_df[col].astype(dtypes[n])\nprint(train_df.info())\ndisplay(train_df)","ef482510":"test_df = pd.DataFrame(test_meta['images'])\ntest_df.columns = ['file_name', 'height', 'image_id', 'license', 'width']\nprint(test_df.info())\ndisplay(test_df)","a87a0bd0":"train_df.to_csv('full_train_data.csv', index=False)\ntest_df.to_csv('full_test_data.csv', index=False)","c5b8808e":"train_df.head()","facf0af9":"test_df.head()","799fabce":"Let's Create Model!","f439126f":"Merge DataFrames"}}