{"cell_type":{"d6be4bf4":"code","fc2cf3b1":"code","6e9ceac5":"code","ac7a5693":"code","043c857d":"code","ea6fed8c":"code","1ab6b2ec":"markdown","917dbce5":"markdown","cdf54ac1":"markdown","4f0d58af":"markdown","8055e85f":"markdown","b6daf635":"markdown"},"source":{"d6be4bf4":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","fc2cf3b1":"import matplotlib.pyplot as plt\n\nimport seaborn as sns; sns.set() #for plot styling\n%matplotlib inline\n\nplt.rcParams['figure.figsize'] = (16,9)\nplt.style.use('ggplot')\n\ndataset = pd.read_csv('..\/input\/clustering-customer-data\/CLV.csv')\ndataset.head()\n##len(dataset)\ndataset.describe().transpose()\n","6e9ceac5":"plot_income = sns.distplot(dataset[\"INCOME\"])\nplot_spend = sns.distplot(dataset[\"SPEND\"])\nplt.xlabel('Income\/Spend')","ac7a5693":"scatter_income = sns.scatterplot(x = \"INCOME\", y =\"SPEND\", data=dataset)","043c857d":"from sklearn.cluster import KMeans\nwcss = []\nfor i in range (1,11): # this refers to 1 - 11 possible clusters\n    km = KMeans(n_clusters = i, init = 'k-means++', max_iter = 300, n_init = 10, random_state = 0)\n    km.fit(dataset)\n    wcss.append(km.inertia_)\nplt.plot(range(1,11), wcss)\nplt.xlabel('Number of Clusters')\nplt.ylabel('wcss')\nplt.show()","ea6fed8c":"km6 = KMeans(n_clusters = 6, init = 'k-means++', max_iter = 300, n_init = 10, random_state = 0)\nX = dataset\ny_means = km6.fit_predict(X)\nX.head()\n\nplt.scatter(X.iloc[:, 0], X.iloc[:, 1], c=y_means, s=50, cmap='viridis')\nplt.scatter(km6.cluster_centers_[:,0], km6.cluster_centers_[:,1],s=200,marker='s', c='red', alpha=0.7, label='Customer Group')\n\nplt.title('Customer segments')\nplt.xlabel('Annual income of customer')\nplt.ylabel('Annual spend from customer on site')\nplt.legend()\nplt.show()\n\n","1ab6b2ec":"**Discussion**\n\nExamining the scatterplot, we see 6 customer segments. They could be described as:\n\n    i) Low Income\/Low Spend\n    \n    ii) Low - Medium Income\/High Spend\n    \n    iii) Medium Income\/High Spend\n    \n    iv) Medium Income\/Low Spend\n    \n    v) Medium - High Income\/High Spend\n    \n    vi) High Income\/High Spend\n    \nThese segements could be described better, but they will do for now.\n\nIn terms of a sales aspect, a question that could arise from this graph is how do we increase the sales of Group 4 (Medium Income\/Low Spend)? ","917dbce5":"**Clustering Customer Data**\n\nThis kernel is built off of Sowmya Vivek's article \"Clustering algorithms for customer segmentation\". The same two-variable dataset was used that compared customer income with customer spend.","cdf54ac1":"**Clusters**\n\nAs per the the elbow method, the number of clusters would be 4. However, for the sake of practice, we changed it to 6 to view the differences.\nReferencing Vivek's code, I ran into an issue plotting the different clusters. Rather than plotting four separate scatters, we could do the same work using just one line of code by using X.iloc[:, 0], X.iloc[:, 1] instead.","4f0d58af":"In the original article, a violin plot was used next. However, I felt that it would be more beneficial to visualize a scatterplot. When we look at the scatterplot, we see a wide range of SPEND and INCOME values. At first glance, it would be difficult to come to any conclusions from this graph.","8055e85f":"**Data Visualization**\n\nFirst we take a look at the distribution of values within the INCOME and SPEND variables.","b6daf635":"**K-Means**\n\nK-Means clustering can be used to create customer segments. From Vivek:\n\n*\"The objective of any clustering algorithm is to ensure that the distance between datapoints in a cluster is very low compared to the distance between 2 clusters. In other words, members of a group are very similar, and members of different groups are extremely dissimilar.\"*\n\nIn order to find a good estimate for the number of clusters to use,the concept of minimizing within cluster sum of square was used. This means the find the minimal distance between a central point and surrounding data points."}}