{"cell_type":{"0f2e2456":"code","7f5f6ede":"code","f11bf84e":"code","ee0de3b1":"code","f506d494":"code","fbfefc25":"code","2400f6e7":"code","0aac3d8b":"code","6f73427d":"code","fc1c457a":"code","b7856f9c":"code","de23269c":"markdown","fe56d7b4":"markdown","b36e5aef":"markdown","84690fe5":"markdown"},"source":{"0f2e2456":"import pandas as pd\nimport numpy as np\nfrom scipy.stats import norm\nimport seaborn as sns\nimport matplotlib.pylab as plt\n%matplotlib inline","7f5f6ede":"train_df = pd.read_csv('..\/input\/train.csv')","f11bf84e":"train_df['var_0'].plot(kind='hist', bins=100)","ee0de3b1":"var_0_mean = train_df['var_0'].mean()\nvar_0_std = train_df['var_0'].std()","f506d494":"var_0_mean, var_0_std","fbfefc25":"scaled_var_0 = (train_df['var_0'] - var_0_mean) \/ var_0_std\ntrf_var_0 = pd.Series(norm.cdf(scaled_var_0))","2400f6e7":"scaled_var_0.plot(kind='hist', bins=100)","0aac3d8b":"trf_var_0.plot(kind='hist', bins=100)","6f73427d":"def uniformize(s):\n    mean = s.mean()\n    std = s.std()\n    return pd.Series(norm.cdf((s - mean) \/ std))","fc1c457a":"uniformize(train_df['var_1']).plot(kind='hist', bins=100)","b7856f9c":"for col in train_df.drop(['target', 'ID_code'], axis=1).columns[:10]:\n    _, ax = plt.subplots(1, 1)\n    uniformize(train_df.loc[lambda df: df.target == 0, col]).plot(kind='hist', \n                                                                  bins=100, ax=ax,\n                                                                 label=\"0\")\n    uniformize(train_df.loc[lambda df: df.target == 1, col]).plot(kind='hist', \n                                                                  bins=100, ax=ax,\n                                                                 label=\"1\")\n    ax.set_title(f'Normal transformation for {col}')\n    ax.legend()","de23269c":"==> Applying the normal CDF to a normal distribution will give a \nuniform distribution. Can you see why?","fe56d7b4":"Here is a short notebook were I explore transforming the features by applying \nthe [**normal**](https:\/\/en.wikipedia.org\/wiki\/Normal_distribution) [**CDF**](https:\/\/en.wikipedia.org\/wiki\/Cumulative_distribution_function) (after scaling). \nEnjoy!","b36e5aef":"# For more features","84690fe5":"#\u00a0One variable transformation"}}