{"cell_type":{"2561b71e":"code","5dcf9e46":"code","bf021411":"code","24989a5f":"code","fb93b88e":"code","e9696b41":"code","1ac84786":"code","8851b6a1":"code","fdea1153":"code","8cc97cd3":"code","0b18af17":"code","8658bbc6":"code","59f0bf00":"markdown","7414162e":"markdown","6297a06b":"markdown","0a9f58b2":"markdown","b7830ed5":"markdown","29296f4e":"markdown"},"source":{"2561b71e":"import pandas as pd\nimport numpy as np\nimport pandas_datareader as web\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import GridSearchCV\nfrom scipy import stats","5dcf9e46":"# Example YESBANK.NS or RELIANCE.NS\n#Update ticker from Yahoo Finance or edit below link for code to accept runtime inputs\n#stockname = input(\"Type Stock Ticker: \")\nstockname = \"SBIN.NS\"","bf021411":"stockname = stockname\nfrom datetime import date \nfrom datetime import timedelta \n  \n# Get today's date \ntoday = date.today() \nprint(\"Today is: \", today) \n  \n# Yesterday date \nyesterday = today - timedelta(days = 1) \nthreedaybeforeyesterday = today - timedelta(days = 3) \nprint(\"Yesterday was: \", yesterday) \nprint(threedaybeforeyesterday)","24989a5f":"#Get the stock quote \ndataset = web.DataReader(stockname, data_source='yahoo', start='2015-01-01', end=today) \n#Show the data\ndataset = dataset.reset_index()\n#data_frame.reset_index(drop=True, inplace=True) \ndataset\ndataset.reset_index()\nprint(dataset.head())","fb93b88e":"# Extract the training and test data\n\nX = dataset.drop([\"Close\",\"Date\"], axis=1)  # all rows, no label\ny = dataset.pop(\"Close\")  # all rows, label only\n\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)","e9696b41":"from sklearn.preprocessing import MinMaxScaler\n \nscaler = MinMaxScaler(feature_range=(0,1))\n \n## Transform the data into\nX_train = scaler.fit_transform(X_train)\nX_test = scaler.transform(X_test)","1ac84786":"from sklearn.ensemble import RandomForestRegressor\n","8851b6a1":"regressor = RandomForestRegressor(n_estimators=500, random_state=0)\nregressor.fit(X_train, y_train)\ny_pred = regressor.predict(X_test)\n","fdea1153":"from sklearn import metrics\n\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y_test, y_pred))\nprint('Mean Squared Error:', metrics.mean_squared_error(y_test, y_pred))\nRSME = np.sqrt(metrics.mean_squared_error(y_test, y_pred))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test, y_pred)))","8cc97cd3":"from sklearn.metrics import accuracy_score,mean_squared_error,r2_score\naccuracy = r2_score(y_test, y_pred)\nprint(\"Train r2_score:\",r2_score(y_test, y_pred))","0b18af17":"from sklearn.metrics import r2_score   \nr2_score(y_test, y_pred)   \nadjustedaccuracy = 1-(1-r2_score(y_test, y_pred))*((len(X_test)-1)\/(len(X_test)-len(X_test[0])-1))\nprint(1-(1-r2_score(y_test, y_pred))*((len(X_test)-1)\/(len(X_test)-len(X_test[0])-1)))","8658bbc6":"#Predicting Todays closing price\nQuote = web.DataReader(stockname, data_source='yahoo', start='2015-01-01', end= today)\nQuote = Quote.reset_index()\n\n## Creating a new dataframe\nnew_data_train = Quote.drop([\"Close\",\"Date\"], axis=1)\nnew_data_test = Quote.filter(['Close'])\n\n##Scale the data to be values between 0 and 1\nnew_data_train = scaler.fit_transform(new_data_train)\npredicted_price = regressor.predict(new_data_train)\n\n## Display the pridicted price for next day\nprint(stockname + \" Share closing Price  \" + str(predicted_price[-1]))\nprint(\"accuracy \"+ str(accuracy))\nprint(\"Adjusted accuracy \"+ str(adjustedaccuracy))\nprint(\"Error \" + str(RSME))","59f0bf00":"Scaling data","7414162e":"Predicting Today's Stock's Closing price with accuracy score","6297a06b":"Import necessary libraries","0a9f58b2":"Importing Live data from Yahoo Finance","b7830ed5":"# Predicting Stock's Closing Price using Random Forest","29296f4e":"We are going to use Random Forest Regression to predict Share's Closing price. Data is pulled from Yahoo Finance. Incase you would like to predict your preferred share price then visit [Yahoo Finance](https:\/\/in.finance.yahoo.com\/)"}}