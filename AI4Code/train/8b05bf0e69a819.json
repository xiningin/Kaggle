{"cell_type":{"bec6b6f9":"code","0f47300d":"code","0009c88c":"code","086d0860":"code","c656cd76":"code","c8e7af88":"code","bb334ed8":"code","e446d03a":"code","e381b826":"code","d5d61cdc":"code","ae6f2a13":"code","cad9f84b":"code","af48047a":"code","59eeb2c5":"code","67bf77d1":"code","35dd4b47":"code","61253ad8":"code","923fc937":"code","727469e2":"code","6a0538c3":"code","919a91bf":"code","d3cca25b":"code","58dbfb5c":"code","d81588ef":"code","c8ed95dc":"code","5dcd95c0":"markdown","8e3f3095":"markdown","9fcdc894":"markdown"},"source":{"bec6b6f9":"import pandas as pd\nimport numpy as np\ndf=pd.read_csv(\"..\/input\/heart-failure-prediction\/heart.csv\")\ndf.head(5)","0f47300d":"df.info()","0009c88c":"df.isnull().sum()","086d0860":"df.duplicated().sum()","c656cd76":"import seaborn as sns\nsns.countplot(x=\"HeartDisease\",data=df,hue='HeartDisease') \ndf['HeartDisease'].value_counts()","c8e7af88":"df.select_dtypes(np.object).nunique()","bb334ed8":"from sklearn.preprocessing import LabelEncoder\ncateg = ['RestingECG','ExerciseAngina','ChestPainType','ST_Slope','Sex']\n\n# Encode Categorical Columns\nle = LabelEncoder()\ndf[categ] = df[categ].apply(le.fit_transform)","e446d03a":"df.dtypes","e381b826":"import matplotlib.pyplot as plt\ncorr=df.corr()\nplt.figure(figsize = (12, 12))\nsns.heatmap(corr, annot = True, cmap = \"Blues\")","d5d61cdc":"df.var()","ae6f2a13":"cov_=df.cov() # covariance\ncov_","cad9f84b":"from statsmodels.stats.outliers_influence import variance_inflation_factor\nvif = pd.DataFrame()\nvif[\"features\"] = df.columns\nvif[\"VIF\"] = [variance_inflation_factor(df.values, i) for i in range(df.shape[1])]\nvif","af48047a":"df=df.drop(['RestingBP','Age','MaxHR'],axis=1)","59eeb2c5":"from statsmodels.stats.outliers_influence import variance_inflation_factor\nvif = pd.DataFrame()\nvif[\"features\"] = df.columns\nvif[\"VIF\"] = [variance_inflation_factor(df.values, i) for i in range(df.shape[1])]\nvif","67bf77d1":"df.skew()","35dd4b47":"df.kurt()","61253ad8":"y=df['HeartDisease'].values\nx=df.drop(['HeartDisease'],axis=1).values\n","923fc937":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nx = sc.fit_transform(x)","727469e2":"from sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state=42)","6a0538c3":"from sklearn.svm import SVC\nclassifier = SVC(kernel='rbf', random_state=42)\nclassifier.fit(x_train, y_train)","919a91bf":"y_pred = classifier.predict(x_test)","d3cca25b":"from sklearn.metrics import confusion_matrix\ncf = confusion_matrix(y_test, y_pred)\nsns.heatmap(cf, annot=True,cmap=\"Blues\")","58dbfb5c":"from sklearn import metrics\nfrom sklearn.metrics import classification_report\nprint(\"\\n Classification_report: \\n\",classification_report(y_test,y_pred))","d81588ef":"pred = classifier.predict(x)","c8ed95dc":"final_result=pd.DataFrame({'Actual': df.HeartDisease, 'Predicted': pred})\nfinal_result","5dcd95c0":"restingBP, Age, and MaxHR have larger VIF values. so we drop the biggest VIF values then calculate again the VIF","8e3f3095":"### Heart Failure Prediction","9fcdc894":"#### Variance Inflation Factor"}}