{"cell_type":{"e17b9597":"code","4f8dfbf4":"code","114b5ddb":"code","96e666b4":"code","43332e79":"code","1bd7fafb":"code","e9f071be":"code","a43a26c1":"markdown","0b6234a2":"markdown","65dc4ceb":"markdown","a7a3483d":"markdown","751df022":"markdown"},"source":{"e17b9597":"import numpy as np\nimport pandas as pd\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.model_selection import cross_val_score\nimport seaborn as sns\nimport matplotlib.pyplot as plt","4f8dfbf4":"train= \"train.csv\"\ntest = \"test.csv\"\n\ndf_tr = pd.read_csv(train)\ndf_te = pd.read_csv(test)\n\n\ntrain_random_ages = np.random.randint(df_tr[\"Age\"].mean() - df_tr[\"Age\"].std(), df_tr[\"Age\"].mean() + df_tr[\"Age\"].std(),\nsize = df_tr[\"Age\"].isnull().sum())\ntest_random_ages = np.random.randint(df_te[\"Age\"].mean() - df_te[\"Age\"].std(),df_te[\"Age\"].mean() + df_te[\"Age\"].std(),\nsize = df_te[\"Age\"].isnull().sum())\n\npd.options.mode.chained_assignment = None\ndf_tr[\"Age\"][np.isnan(df_tr[\"Age\"])] = train_random_ages\ndf_te[\"Age\"][np.isnan(df_te[\"Age\"])] = test_random_ages\ndf_tr['Sex'] = np.where(df_tr['Sex'] == 'male', 0, df_tr['Sex'])\ndf_tr['Sex'] = np.where(df_tr['Sex'] == 'female', 1, df_tr['Sex'])\ndf_te['Sex'] = np.where(df_te['Sex'] == 'male', 0, df_te['Sex'])\ndf_te['Sex'] = np.where(df_te['Sex'] == 'female', 1, df_te['Sex'])\ndf_tr['Embarked'] = np.where(df_tr['Embarked'] == 'C', 1, df_tr['Embarked'])\ndf_tr['Embarked'] = np.where(df_tr['Embarked'] == 'Q', 2, df_tr['Embarked'])\ndf_tr['Embarked'] = np.where(df_tr['Embarked'] == 'S', 3, df_tr['Embarked'])\ndf_te['Embarked'] = np.where(df_te['Embarked'] == 'C', 1, df_te['Embarked'])\ndf_te['Embarked'] = np.where(df_te['Embarked'] == 'Q', 2, df_te['Embarked'])\ndf_te['Embarked'] = np.where(df_te['Embarked'] == 'S', 3, df_te['Embarked'])\ndf_tr[\"Embarked\"].fillna('0', inplace=True)\ndf_te[\"Embarked\"].fillna('0', inplace=True)\ndf_tr[\"Fare\"].fillna(df_tr[\"Fare\"].median(), inplace=True)\ndf_te[\"Fare\"].fillna(df_te[\"Fare\"].median(), inplace=True)\ndf_tr['CabinStatus'] = df_tr[\"Cabin\"].apply(lambda x: 0 if type(x) == float else 1)\ndf_te['CabinStatus'] = df_te[\"Cabin\"].apply(lambda x: 0 if type(x) == float else 1)\n\ndf_tr['Age'] = df_tr['Age'].astype(int)\ndf_te['Age'] = df_te['Age'].astype(int)\ndf_tr['Sex'] = df_tr['Sex'].astype(int)\ndf_te['Sex'] = df_te['Sex'].astype(int)\ndf_tr['Embarked'] = df_tr['Embarked'].astype(int)\ndf_te['Embarked'] = df_te['Embarked'].astype(int)","114b5ddb":"corr = df_tr.corr()\n\n\nmask = np.triu(np.ones_like(corr, dtype=np.bool))\n\nf, ax = plt.subplots(figsize=(11, 9))\n\ncmap = sns.diverging_palette(220, 10, as_cmap=True)\n\nsns_plot =sns.heatmap(corr, mask=mask, cmap=cmap, vmax=.3, center=0,\n            square=True, linewidths=.5, cbar_kws={\"shrink\": .5})\n\npic = sns_plot.get_figure()","96e666b4":"df_tr[\"Age\"] = np.where(df_tr['Age'] < 14, 0, df_tr['Age'])\ndf_tr[\"Age\"] = np.where((df_tr['Age'] >= 14) & (df_tr['Age'] < 21), 1, df_tr['Age'])\ndf_tr[\"Age\"] = np.where((df_tr['Age'] >= 21) & (df_tr['Age'] < 60), 2, df_tr['Age'])\ndf_tr[\"Age\"] = np.where(df_tr['Age'] >= 60, 3, df_tr['Age'])\ndf_te[\"Age\"] = np.where(df_te['Age'] < 14, 0, df_te['Age'])\ndf_te[\"Age\"] = np.where((df_te['Age'] >= 14) & (df_te['Age'] < 21), 1, df_te['Age'])\ndf_te[\"Age\"] = np.where((df_te['Age'] >= 21) & (df_te['Age'] < 60), 2, df_te['Age'])\ndf_te[\"Age\"] = np.where(df_te['Age'] >= 60, 3, df_te['Age'])\ndf_tr['SibSp'] = np.where((df_tr['SibSp'] >= 1) & (df_tr['SibSp'] <= 2), 1, df_tr['SibSp'])\ndf_tr['SibSp'] = np.where(df_tr['SibSp'] > 2, 2, df_tr['SibSp'])\ndf_te['SibSp'] = np.where((df_te['SibSp'] >= 1) & (df_te['SibSp'] <= 2), 1, df_te['SibSp'])\ndf_te['SibSp'] = np.where(df_te['SibSp'] > 2, 2, df_te['SibSp'])\ndf_tr['Parch'] = np.where((df_tr['Parch'] >= 1) & (df_tr['Parch'] <= 2), 1, df_tr['Parch'])\ndf_tr['Parch'] = np.where(df_tr['Parch'] > 2, 2, df_tr['Parch'])\ndf_te['Parch'] = np.where((df_te['Parch'] >= 1) & (df_te['Parch'] <= 2), 1, df_te['Parch'])\ndf_te['Parch'] = np.where(df_te['Parch'] > 2, 2, df_te['Parch'])\ndf_tr[\"Fare\"] = np.where(df_tr['Fare'] < 8, 0, df_tr['Fare'])\ndf_tr[\"Fare\"] = np.where((df_tr['Fare'] >= 8) & (df_tr['Fare'] < 15), 1, df_tr['Fare'])\ndf_tr[\"Fare\"] = np.where((df_tr['Fare'] >= 15) & (df_tr['Fare'] < 31), 2, df_tr['Fare'])\ndf_tr[\"Fare\"] = np.where(df_tr['Fare'] >= 31, 3, df_tr['Fare'])\ndf_te[\"Fare\"] = np.where(df_te['Fare'] < 8, 0, df_te['Fare'])\ndf_te[\"Fare\"] = np.where((df_te['Fare'] >= 8) & (df_te['Fare'] < 15), 1, df_te['Fare'])\ndf_te[\"Fare\"] = np.where((df_te['Fare'] >= 15) & (df_te['Fare'] < 31), 2, df_te['Fare'])\ndf_te[\"Fare\"] = np.where(df_te['Fare'] >= 31, 3, df_te['Fare'])\n\ndf_tr['Age'] = df_tr['Age'].astype(int)\ndf_te['Age'] = df_te['Age'].astype(int)\ndf_tr['Sex'] = df_tr['Sex'].astype(int)\ndf_te['Sex'] = df_te['Sex'].astype(int)\ndf_tr['SibSp'] = df_tr['SibSp'].astype(int)\ndf_te['SibSp'] = df_te['SibSp'].astype(int)\ndf_tr['Parch'] = df_tr['Parch'].astype(int)\ndf_te['Parch'] = df_te['Parch'].astype(int)\ndf_tr['Fare'] = df_tr['Fare'].astype(int)\ndf_te['Fare'] = df_te['Fare'].astype(int)\ndf_tr['CabinStatus'] = df_tr['CabinStatus'].astype(int)\ndf_te['CabinStatus'] = df_te['CabinStatus'].astype(int)\n\ndel df_tr['Name']\ndel df_te['Name']\ndel df_tr['Cabin']\ndel df_te['Cabin']\ndel df_tr['Ticket']\ndel df_te['Ticket']","43332e79":"del df_tr['PassengerId']\n\ntrain_nosurvive = df_tr.drop(\"Survived\",axis=1)\ntrain_survive = df_tr[\"Survived\"]\ntest_nosurvive = df_te.drop(\"PassengerId\",axis=1).copy()\n","1bd7fafb":"gnb = GaussianNB()\n\npred = gnb.fit(train_nosurvive, train_survive).predict(test_nosurvive)\n\nresult_tr = gnb.score(train_nosurvive, train_survive)\nresult_val = cross_val_score(gnb,train_nosurvive, train_survive, cv=5).mean()\nprint(result_tr , result_val)","e9f071be":"\nfinalresult = pd.DataFrame({\"PassengerId\": df_te[\"PassengerId\"],\"Survived\": pred})\nfinalresult.to_csv('titanic.csv', index=False)","a43a26c1":"\u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u043c \u043a\u043e\u0440\u0440\u0435\u043b\u044f\u0446\u0438\u044e \u0434\u0430\u043d\u043d\u044b\u0445. \u0428\u0430\u043d\u0441 \u0432\u044b\u0436\u0438\u0432\u0430\u043d\u0438\u044f \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0441\u0438\u043b\u044c\u043d\u043e \u043a\u043e\u0440\u0440\u0435\u043b\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0441 \u043f\u043e\u043b\u043e\u043c, \u0446\u0435\u043d\u043e\u0439 \u0431\u0438\u043b\u0435\u0442\u0430, \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043a\u0430\u0431\u0438\u043d\u044b \u0438 \u043a\u043b\u0430\u0441\u0441 \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u044f  (\u0447\u0435\u043c \u0432\u044b\u0448\u0435 \u043d\u043e\u043c\u0435\u0440 \u043a\u043b\u0430\u0441\u0441\u0430, \u0442\u0435\u043c \u043d\u0438\u0436\u0435 \u0448\u0430\u043d\u0441 \u0432\u044b\u0436\u0438\u0432\u0430\u043d\u0438\u044f).","0b6234a2":"\u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u044b\u0439 \u0434\u0430\u0442\u0430\u0441\u0435\u0442 (\u0431\u0435\u0437 \u0432\u044b\u0436\u0438\u0432\u0430\u043d\u0438\u044f), \u0438 \u0434\u0430\u0442\u0430\u0441\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0441 \u0432\u044b\u0436\u0438\u0432\u0430\u043d\u0438\u0435\u043c.","65dc4ceb":"\u0420\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u043c \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438, \u0443\u0431\u0438\u0440\u0430\u0435\u043c \u043b\u0438\u0448\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435","a7a3483d":"\u0421\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u043c \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u044b\u0435 \u0438 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435, \u0437\u0430\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u043f\u0440\u043e\u0431\u0435\u043b\u044b","751df022":"\u041f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c \u0432\u044b\u0436\u0438\u0432\u0430\u043d\u0438\u0435 \u0432 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u043c \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043d\u0430\u0438\u0432\u043d\u043e \u0431\u0430\u0439\u0435\u0441\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430, \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u043c\u0435\u0442\u043e\u0434\u0430"}}