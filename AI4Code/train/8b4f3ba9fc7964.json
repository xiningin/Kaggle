{"cell_type":{"5deb78d5":"code","b0d02aa0":"code","df68bcfd":"code","f28ae2cd":"code","682ebcfd":"code","c3561148":"code","46fb3871":"code","e3351e0d":"code","7eb26d43":"code","d2981f9d":"code","3b7283e0":"code","daa84532":"code","2136c5d8":"code","99cd2ed5":"code","a8878882":"code","ba0e0b05":"code","7ed9aadb":"code","7ed36700":"code","33568386":"code","44566357":"code","868cc887":"code","0eb9d993":"code","4ca07a64":"code","f7716c2b":"code","b448fe59":"code","818c6f06":"code","3256d290":"code","16bf2df0":"code","70f8d74b":"code","4ad38a6c":"code","ec2ce2a5":"code","b9a8df22":"code","ddce2b79":"code","e75a0e3f":"code","409fd3d4":"code","1d1a377c":"code","efef432c":"code","c6b9bef3":"code","a1c4d3fa":"code","d6b72666":"code","fbbd30a1":"code","8dddbcd2":"code","e7067913":"code","f2530376":"code","b6bf1091":"code","58682e1f":"code","e0865b8d":"code","2afe0313":"code","34b976b2":"code","d63dda43":"code","04164548":"code","6bf4798f":"code","c1dc8406":"code","19e6c427":"code","c13c0cdb":"code","351b0c03":"code","a74a2f3d":"code","e4345f87":"code","46048d6c":"markdown","32605913":"markdown","c3357f91":"markdown","aa05ca2b":"markdown","574396a5":"markdown","783c8c7c":"markdown","c8576340":"markdown","b1bf7cd4":"markdown"},"source":{"5deb78d5":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn import metrics\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import confusion_matrix, classification_report, plot_confusion_matrix\nfrom sklearn.metrics import f1_score\n\nfrom imblearn.over_sampling import SMOTE #to correct skewness","b0d02aa0":"file = pd.read_csv(r\"..\/input\/pima-indians-diabetes-database\/diabetes.csv\") #uplaoding data","df68bcfd":"file.head()","f28ae2cd":"file.shape","682ebcfd":"file.describe()","c3561148":"file['Outcome'].value_counts()\n#unstructured\n#more values for non diabetic than diabetic","46fb3871":"file.groupby('Outcome').mean()","e3351e0d":"def outliers(file):\n    for column_name in file.columns:\n        q1 = file[column_name].quantile(0.25)\n        q3 = file[column_name].quantile(0.75)\n        iqr = q3-q1\n        lower_limit = q1-1.5*iqr\n        upper_limit = q3+1.5*iqr\n        print(f\"{column_name}>>Lower_limit:{lower_limit} \\n Upper_limit:{upper_limit}\")\n        file = file[(file[column_name]>lower_limit)&(file[column_name]<upper_limit)]\n        \n    return file","7eb26d43":"df = outliers(file)","d2981f9d":"file.shape","3b7283e0":"x = file.drop(columns = \"Outcome\", axis=1)\ny = file[\"Outcome\"]","daa84532":"smote = SMOTE()\nx,y = smote.fit_resample(x,y)\nx.shape,y.shape","2136c5d8":"file.info()","99cd2ed5":"file.corr()","a8878882":"sns.heatmap(file.corr())","ba0e0b05":"#a histogram presentation\nplt.figure(figsize=(6,5))\nplt.hist(\"Glucose\",data=file,edgecolor=\"k\")\nplt.title(\"Glucose Hist Plot\")\nplt.show()","7ed9aadb":"plt.figure(figsize=(6,5))\nplt.hist(\"Pregnancies\",data=file,edgecolor=\"k\")\nplt.title(\"Pregnancies Hist Plot\")\nplt.show()","7ed36700":"plt.figure(figsize=(6,5))\nplt.hist(\"BloodPressure\",data=file,edgecolor=\"k\")\nplt.title(\"BloodPressure Hist Plot\")\nplt.show()","33568386":"plt.figure(figsize=(6,5))\nplt.hist(\"SkinThickness\",data=file,edgecolor=\"k\")\nplt.title(\"SkinThickness Hist Plot\")\nplt.show()","44566357":"plt.figure(figsize=(6,5))\nplt.hist(\"Insulin\",data=file,edgecolor=\"k\")\nplt.title(\"Insulin Hist Plot\")\nplt.show()","868cc887":"plt.figure(figsize=(6,5))\nplt.hist(\"BMI\",data=file,edgecolor=\"k\")\nplt.title(\"BMI Hist Plot\")\nplt.show()","0eb9d993":"plt.figure(figsize=(6,5))\nplt.hist(\"DiabetesPedigreeFunction\",data=file,edgecolor=\"k\")\nplt.title(\"DiabetesPedigreeFunction Hist Plot\")\nplt.show()","4ca07a64":"plt.figure(figsize=(6,5))\nplt.hist(\"Age\",data=file,edgecolor=\"k\")\nplt.title(\"Age Hist Plot\")\nplt.show()","f7716c2b":"#a scatter plot presentation\nplt.figure(figsize=(6,5))\nplt.scatter(\"BMI\",\"Glucose\",data=file,edgecolor=\"k\")\nplt.title(\"Glucose Vs BMI \")\nplt.xlabel(\"Glucose\")\nplt.ylabel(\"BMI\")\nplt.show()","b448fe59":"#a scatter plot presentation\nplt.figure(figsize=(6,5))\nplt.scatter(\"Outcome\",\"Glucose\",data=file,edgecolor=\"k\")\nplt.title(\"Glucose Vs Outcome \")\nplt.xlabel(\"Glucose\")\nplt.ylabel(\"Outcome\")\nplt.show()","818c6f06":"plt.figure(figsize=(6,5))\nplt.scatter(\"Outcome\",\"Insulin\",data=file,edgecolor=\"k\")\nplt.title(\"Outcome Vs Insulin \")\nplt.xlabel(\"Outcome\")\nplt.ylabel(\"Insulin\")\nplt.show()","3256d290":"plt.figure(figsize=(6,5))\nplt.scatter(\"Outcome\",\"BMI\",data=file,edgecolor=\"k\")\nplt.title(\"Outcome Vs BMI \")\nplt.xlabel(\"Outcome\")\nplt.ylabel(\"BMI\")\nplt.show()","16bf2df0":"file.shape","70f8d74b":"x_train, x_test,y_train, y_test = train_test_split(x,y, test_size=0.2, random_state=2)","4ad38a6c":"print(x_train.shape, x_test.shape, y_train.shape, y_test.shape)","ec2ce2a5":"logreg = LogisticRegression(solver=\"liblinear\")","b9a8df22":"logreg.fit(x_train,y_train)","ddce2b79":"logreg.score(x_test,y_test)","e75a0e3f":"y_pred=logreg.predict(x_test)","409fd3d4":"cm = confusion_matrix(y_test,y_pred)\ncm","1d1a377c":"plot_confusion_matrix(logreg,x_test,y_test,cmap=\"Blues\",values_format=\".3g\")","efef432c":"print(classification_report(y_test,y_pred))","c6b9bef3":"import math\nmath.sqrt(len(y_test))","a1c4d3fa":"kn_classifier = KNeighborsClassifier(n_neighbors=11, p=2, metric=\"euclidean\")\nkn_classifier.fit(x_train,y_train)","d6b72666":"y_pred = kn_classifier.predict(x_test)\ny_pred","fbbd30a1":"cm = confusion_matrix(y_test,y_pred)\ncm","8dddbcd2":"plot_confusion_matrix(kn_classifier,x_test,y_test,cmap=\"Blues\",values_format=\".3g\")","e7067913":"f1_score(y_test,y_pred)","f2530376":"accuracy_score(y_test,y_pred)","b6bf1091":"print(classification_report(y_test,y_pred))","58682e1f":"dt = DecisionTreeClassifier(criterion=\"entropy\", max_depth=3)","e0865b8d":"dt.fit(x_train,y_train)","2afe0313":"y_pred = dt.predict(x_test)","34b976b2":"metrics.accuracy_score(y_test,y_pred)","d63dda43":"plot_confusion_matrix(dt,x_test,y_test,cmap=\"Blues\",values_format=\".3g\")","04164548":"print(classification_report(y_test,y_pred))","6bf4798f":"ranfor = RandomForestClassifier(n_estimators=100,random_state=0,max_depth=3,criterion=\"gini\")","c1dc8406":"ranfor.fit(x_train,y_train)\n","19e6c427":"y_pred = ranfor.predict(x_test)","c13c0cdb":"ranfor.score(x_train,y_train)","351b0c03":"cm = confusion_matrix(y_test,y_pred)\ncm","a74a2f3d":"plot_confusion_matrix(ranfor,x_test,y_test,cmap=\"Blues\",values_format=\".3g\")","e4345f87":"print(classification_report(y_test,y_pred))","46048d6c":"# Random Forest Classifier","32605913":"# KNN ","c3357f91":"# Logistic Regression","aa05ca2b":"# Train test split","574396a5":"# Correlation","783c8c7c":"# Decision Tree Classifier","c8576340":"# Data Visualization","b1bf7cd4":"# Import Libraries\n"}}