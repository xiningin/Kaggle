{"cell_type":{"a893fa6d":"code","912da8c9":"code","a01a27ed":"code","44679624":"code","a0d13d63":"code","325eb566":"code","734bd3e2":"code","2e8ceabb":"code","5f63a899":"code","68ebc558":"code","43a68469":"markdown","e5528f17":"markdown","b03f8a2d":"markdown","79f97ddf":"markdown","b0665be1":"markdown","10c07238":"markdown","318a6ea5":"markdown"},"source":{"a893fa6d":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn import linear_model\nimport pandas as pd\nimport math","912da8c9":"# reading the csv files\ndf_train = pd.read_csv('..\/input\/train.csv')\ndf_test = pd.read_csv('..\/input\/test.csv')\ndf_train.info()","a01a27ed":"df_train.columns\ndf_train.describe()","44679624":"x_train = df_train[\"x\"]\ny_train = df_train[\"y\"]\nx_test = df_test[\"x\"]\ny_test = df_test[\"y\"]\n#_train = x_train.reshape(len(x_train),1)\n#_train = y_train.reshape(len(y_train),1)\n#_test = x_test.reshape(len(x_test),1)\n#_test = y_test.reshape(len(y_test),1)\nplt.scatter(x_train, y_train,  color='black')\nplt.title('Train data')\nplt.xlabel('Size')\nplt.ylabel('Price')\nplt.xticks(())\nplt.yticks(())\n\nplt.show()","a0d13d63":"df_train_data = df_train.dropna()\n","325eb566":"\nX = df_train_data[['x']].as_matrix()\nY = df_train_data[['y']].as_matrix()\n\nlm=linear_model.LinearRegression()\nlm.fit(X,Y)\nlm.coef_\n\n","734bd3e2":"\nlm.intercept_","2e8ceabb":"df_test_data = df_test.dropna()\nXtest=df_test_data[['x']].as_matrix()\nYtest=df_test_data[['y']].as_matrix()\nprint('Coeff of determination:',lm.score(Xtest,Ytest))\nprint('correlation is:',math.sqrt(lm.score(Xtest,Ytest)))","5f63a899":"plt.scatter(X,Y)\nyhat=1.000656386*X-0.10726546\nfig=plt.plot(X,yhat,lw=4,c='black',label='regression line')\nplt.title(\"trainig data\")\nplt.xlabel('Size',fontsize=20)\nplt.ylabel('Price',fontsize=20)\nplt.show()","68ebc558":"plt.scatter(Xtest,Ytest)\nyhat=1.000656386*Xtest-0.10726546\nfig=plt.plot(Xtest,yhat,lw=4,c='black',label='regression line')\nplt.title(\"testing data\")\nplt.xlabel('Size',fontsize=20)\nplt.ylabel('Price',fontsize=20)\nplt.show()","43a68469":"As we can see, the function relating the price and the size is almoast linear","e5528f17":"Now, let's compare our model with the real values of both training and tesing data","b03f8a2d":"**Linear regression : **\nThe first thing to do is importing the necessary data for this lecture:\n  \n1.   numpy \n2.   matplotlib.pyplot \n3.   pandas to manipulate the training and testing data\n4.   sklearn to use a linear regression","79f97ddf":"The puspose of this lecture is to find a linear relation between x and y","b0665be1":"We will extract the information from files","10c07238":"Then, we have to load the data into variables;which are in the form of dataframes.","318a6ea5":"After that, we use the method LinearRegression() of sklearn to detrmine the linear model"}}