{"cell_type":{"544fe046":"code","fee0c89c":"code","bdcd2781":"code","0a4d87c4":"code","4d2d9731":"code","c7d05397":"code","414507f8":"code","cc31d315":"code","38053f2d":"code","f847d20b":"code","1a3204bf":"code","72eec886":"markdown","5436321b":"markdown","5ce88b84":"markdown","2d0706d5":"markdown","09367ed3":"markdown","bde239c6":"markdown","3ea835a0":"markdown","312cd176":"markdown","815d547b":"markdown","e6861bd9":"markdown","95c92d68":"markdown"},"source":{"544fe046":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","fee0c89c":"from pandas_profiling import ProfileReport","bdcd2781":"# Load Data\nxtrain = pd.read_csv('\/kaggle\/input\/covid19-global-forecasting-week-3\/train.csv')\nxtest = pd.read_csv('\/kaggle\/input\/covid19-global-forecasting-week-3\/test.csv')\nxsubmission = pd.read_csv('\/kaggle\/input\/covid19-global-forecasting-week-3\/submission.csv')","0a4d87c4":"train_profile = ProfileReport(xtrain, title='Pandas Profiling Report', html={'style':{'full_width':True}})\ntrain_profile","4d2d9731":"xtrain.rename(columns={'Country_Region':'Country'}, inplace=True)\nxtest.rename(columns={'Country_Region':'Country'}, inplace=True)\n\nxtrain.rename(columns={'Province_State':'State'}, inplace=True)\nxtest.rename(columns={'Province_State':'State'}, inplace=True)\n\nxtrain['Date'] = pd.to_datetime(xtrain['Date'], infer_datetime_format=True)\nxtest['Date'] = pd.to_datetime(xtest['Date'], infer_datetime_format=True)\n\nxtrain.info()\nxtest.info()\n\ny1_xTrain = xtrain.iloc[:, -2]\ny1_xTrain.head()\ny2_xTrain = xtrain.iloc[:, -1]\ny2_xTrain.head()\n\nEMPTY_VAL = \"EMPTY_VAL\"\n\ndef fillState(state, country):\n    if state == EMPTY_VAL: return country\n    return state","c7d05397":"X_xTrain = xtrain.copy()\n\nX_xTrain['State'].fillna(EMPTY_VAL, inplace=True)\nX_xTrain['State'] = X_xTrain.loc[:, ['State', 'Country']].apply(lambda x : fillState(x['State'], x['Country']), axis=1)\n\nX_xTrain.loc[:, 'Date'] = X_xTrain.Date.dt.strftime(\"%m%d\")\nX_xTrain[\"Date\"]  = X_xTrain[\"Date\"].astype(int)\n\nX_xTrain.head()\n\n#X_Test = df_test.loc[:, ['State', 'Country', 'Date']]\nX_xTest = xtest.copy()\n\nX_xTest['State'].fillna(EMPTY_VAL, inplace=True)\nX_xTest['State'] = X_xTest.loc[:, ['State', 'Country']].apply(lambda x : fillState(x['State'], x['Country']), axis=1)\n\nX_xTest.loc[:, 'Date'] = X_xTest.Date.dt.strftime(\"%m%d\")\nX_xTest[\"Date\"]  = X_xTest[\"Date\"].astype(int)\n\nX_xTest.head()","414507f8":"from sklearn import preprocessing\n\nle = preprocessing.LabelEncoder()\n\nX_xTrain.Country = le.fit_transform(X_xTrain.Country)\nX_xTrain['State'] = le.fit_transform(X_xTrain['State'])\n\nX_xTrain.head()\n\nX_xTest.Country = le.fit_transform(X_xTest.Country)\nX_xTest['State'] = le.fit_transform(X_xTest['State'])\n\nX_xTest.head()\n\nxtrain.head()\nxtrain.loc[xtrain.Country == 'Afghanistan', :]\nxtest.tail()","cc31d315":"from warnings import filterwarnings\nfilterwarnings('ignore')\n\nfrom sklearn import preprocessing\n\nle = preprocessing.LabelEncoder()\n\nfrom xgboost import XGBRegressor\n\ncountries = X_xTrain.Country.unique()\n","38053f2d":"# Predict data and Create submission file from test data\nxout = pd.DataFrame({'ForecastId': [], 'ConfirmedCases': [], 'Fatalities': []})\n\nfor country in countries:\n    states = X_xTrain.loc[X_xTrain.Country == country, :].State.unique()\n    #print(country, states)\n    # check whether string is nan or not\n    for state in states:\n        X_xTrain_CS = X_xTrain.loc[(X_xTrain.Country == country) & (X_xTrain.State == state), ['State', 'Country', 'Date', 'ConfirmedCases', 'Fatalities']]\n        \n        y1_xTrain_CS = X_xTrain_CS.loc[:, 'ConfirmedCases']\n        y2_xTrain_CS = X_xTrain_CS.loc[:, 'Fatalities']\n        \n        X_xTrain_CS = X_xTrain_CS.loc[:, ['State', 'Country', 'Date']]\n        \n        X_xTrain_CS.Country = le.fit_transform(X_xTrain_CS.Country)\n        X_xTrain_CS['State'] = le.fit_transform(X_xTrain_CS['State'])\n        \n        X_xTest_CS = X_xTest.loc[(X_xTest.Country == country) & (X_xTest.State == state), ['State', 'Country', 'Date', 'ForecastId']]\n        \n        X_xTest_CS_Id = X_xTest_CS.loc[:, 'ForecastId']\n        X_xTest_CS = X_xTest_CS.loc[:, ['State', 'Country', 'Date']]\n        \n        X_xTest_CS.Country = le.fit_transform(X_xTest_CS.Country)\n        X_xTest_CS['State'] = le.fit_transform(X_xTest_CS['State'])\n        \n        #models_C[country] = gridSearchCV(model, X_Train_CS, y1_Train_CS, param_grid, 10, 'neg_mean_squared_error')\n        #models_F[country] = gridSearchCV(model, X_Train_CS, y2_Train_CS, param_grid, 10, 'neg_mean_squared_error')\n        \n        xmodel1 = XGBRegressor(n_estimators=1000)\n        xmodel1.fit(X_xTrain_CS, y1_xTrain_CS)\n        y1_xpred = xmodel1.predict(X_xTest_CS)\n        \n        xmodel2 = XGBRegressor(n_estimators=1000)\n        xmodel2.fit(X_xTrain_CS, y2_xTrain_CS)\n        y2_xpred = xmodel2.predict(X_xTest_CS)\n        \n        xdata = pd.DataFrame({'ForecastId': X_xTest_CS_Id, 'ConfirmedCases': y1_xpred, 'Fatalities': y2_xpred})\n        xout = pd.concat([xout, xdata], axis=0)\n","f847d20b":"xout.ForecastId = xout.ForecastId.astype('int')\nxout.tail()\nxout.to_csv('submission.csv', index=False)","1a3204bf":"xout.head()","72eec886":"For Timeseries Forecasting of Covid-19(week-3)  Using Prophet refer my another notebook https:\/\/www.kaggle.com\/eswarchandt\/timeseries-forecasting-of-covid-19-week-3-prophet","5436321b":"**Fit Data with Model**","5ce88b84":"For EDA of covid-19 (week-3) please refer my another notebook https:\/\/www.kaggle.com\/eswarchandt\/eda-covid-19-week-3 ","2d0706d5":"# MODEL BUILDING","09367ed3":"# Creating Submisssion File","bde239c6":"If you like these notebooks please up vote and keep me motivated","3ea835a0":"Coronavirus disease (COVID-19) is an infectious disease caused by a newly discovered coronavirus.\n\nMost people infected with the COVID-19 virus will experience mild to moderate respiratory illness and recover without requiring special treatment. Older people, and those with underlying medical problems like cardiovascular disease, diabetes, chronic respiratory disease, and cancer are more likely to develop serious illness.\n\nThe best way to prevent and slow down transmission is be well informed about the COVID-19 virus, the disease it causes and how it spreads. Protect yourself and others from infection by washing your hands or using an alcohol based rub frequently and not touching your face.\n\nThe COVID-19 virus spreads primarily through droplets of saliva or discharge from the nose when an infected person coughs or sneezes, so it\u2019s important that you also practice respiratory etiquette (for example, by coughing into a flexed elbow).\n\nAt this time, there are no specific vaccines or treatments for COVID-19. However, there are many ongoing clinical trials evaluating potential treatments. WHO will continue to provide updated information as soon as clinical findings become available.\n\nStay informed:\n\nProtect yourself: advice for the public Myth busters Questions and answers Situation reports All information on the COVID-19 outbreak","312cd176":"# Introduction","815d547b":"For day to day track and geospatial analysis of Covid-19 refer my another notebook https:\/\/www.kaggle.com\/eswarchandt\/geospatial-analysis-on-covid-19-day-to-day-track ","e6861bd9":"![image.png](attachment:image.png)","95c92d68":"For Timeseries Forecasting of Covid-19 (week-3) ARIMA refer my another notebook https:\/\/www.kaggle.com\/eswarchandt\/timeseries-forecasting-of-covid-19-week-3-arima"}}