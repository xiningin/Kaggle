{"cell_type":{"5ff0f6ff":"code","2443d226":"code","6caf52dc":"code","6e398809":"code","1e5ec9fc":"code","c4c4e4a7":"code","6aad41ea":"code","311355e7":"code","ed167463":"code","efc030a7":"code","5b8eba0e":"code","dfb916f3":"code","27699d8b":"code","d5772f86":"code","1b69edd4":"code","eccdb284":"code","1044f3cd":"code","73b41409":"code","4e803311":"code","b3457a52":"code","8703c15d":"code","8d32d68d":"code","f561f646":"code","e7547baf":"code","80c1b36f":"code","428e88c7":"code","46e896f6":"code","790f0dcd":"code","91808265":"code","c33cd149":"code","1fb372a8":"code","f68ed698":"code","2283317b":"code","7ae6522b":"code","4cd22823":"code","41cb7034":"code","5ad4d744":"code","17cd5a92":"code","c65a1ab6":"code","d6343b4b":"code","5d547287":"code","d0dfebf0":"code","a8c90751":"code","94cc6663":"code","f15951dd":"code","4722cc97":"code","7bb201e4":"code","4c806ed4":"code","1a3521c8":"code","59ef6ef6":"code","dd23f6b4":"code","d36450cc":"code","42e70572":"code","3250aef7":"code","3eb3ee59":"code","a187e1ec":"code","2f687b8a":"code","16dedeb4":"code","8beda9fc":"code","a8f4a205":"code","07d92071":"code","f2c0f542":"code","a1203402":"code","08b12c65":"code","01df3375":"code","37dcc889":"code","57e621a3":"code","3eb5bf0d":"code","68f69e13":"code","d12e8eb5":"code","f59ce2fc":"code","5b2c9899":"code","8d00a6d8":"markdown","4898e5e5":"markdown","e00912b7":"markdown","41a7f3fe":"markdown","6284b275":"markdown","ab24a8d4":"markdown","45b8a98f":"markdown","e8e8880a":"markdown","0d44d903":"markdown","5af86c49":"markdown","ca1590c4":"markdown","e3250cc3":"markdown","d6239428":"markdown","e6d6dd17":"markdown","4281336b":"markdown","cda30730":"markdown","e8b85e0a":"markdown","707111d9":"markdown","725f1be5":"markdown","d6797a86":"markdown","60baa4d6":"markdown","72054d01":"markdown","b1b20eb4":"markdown","f3e75c3f":"markdown","7773c978":"markdown","c8a8f564":"markdown","cbeaa605":"markdown","c49e815a":"markdown","f82442e9":"markdown","665ee5e4":"markdown","81e2b57d":"markdown","d042094c":"markdown","e631c076":"markdown","9c28d1ac":"markdown"},"source":{"5ff0f6ff":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\n\nfrom sklearn.linear_model import LogisticRegression\n\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\n\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder, OneHotEncoder\nfrom sklearn.metrics import confusion_matrix, accuracy_score\nfrom sklearn.metrics import classification_report","2443d226":"df = pd.read_csv('..\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv')","6caf52dc":"df.head()","6e398809":"df.shape","1e5ec9fc":"df.info()","c4c4e4a7":"df.drop('id',axis=1,inplace=True)","6aad41ea":"df.columns","311355e7":"df.isnull().sum()","ed167463":"# fill na","efc030a7":"df['bmi'].fillna(df['bmi'].mean(), inplace=True)","5b8eba0e":"df.isnull().sum()['bmi']","dfb916f3":"df['hypertension'].value_counts()","27699d8b":"print(df['hypertension'].dtype)","d5772f86":"df['heart_disease'].value_counts()","1b69edd4":"print(df['heart_disease'].dtype)","eccdb284":"df['ever_married'].value_counts()","1044f3cd":"def married(ever_married):\n    if ever_married == 'Yes':\n        return 1\n    else:\n        return 0","73b41409":"df['ever_married']=df['ever_married'].apply(married)","4e803311":"df['ever_married'].value_counts()","b3457a52":"df['work_type'].value_counts()","8703c15d":"def work_type(work):\n    if work == 'Private':\n        return 4\n    if work =='Self-employed':\n        return 3\n    if work =='children':\n        return 2\n    if work == 'Govt_job':\n        return 1\n    if work == 'Never_worked':\n        return 0","8d32d68d":"df['work_type']= df['work_type'].apply(work_type)","f561f646":"df.work_type.value_counts()","e7547baf":"df['Residence_type'].value_counts()","80c1b36f":"def residence_type(residence):\n    if residence=='Urban':\n        return 1\n    else:\n        return 0\n    Residence_type\ndf['Residence_type']=df['Residence_type'].apply(residence_type)","428e88c7":"df.Residence_type.value_counts()","46e896f6":"df['smoking_status'].value_counts()","790f0dcd":"def smoking_status(smoking):\n    if smoking=='never smoked':\n        return 0\n    if smoking=='Unknown':\n        return \n        \n        ","91808265":"df['smoking_status'] = pd.Categorical(df['smoking_status'])\ndfDummies_smoking_status = pd.get_dummies(df['smoking_status'], prefix = 'smoking_status_encoded')\ndfDummies_smoking_status","c33cd149":"df = pd.concat([df, dfDummies_smoking_status], axis=1)","1fb372a8":"df['gender'].value_counts()\n","f68ed698":"def gender(gender):\n    if gender=='Male':\n        return 1\n    else:\n        return 0","2283317b":"df['gender']=df['gender'].apply(gender)\ndf['gender'].value_counts()","7ae6522b":"plt.figure(figsize=(8,6))\nplt.title('Agv Glucose level')\nsns.boxplot(x='avg_glucose_level',data=df)\nplt.show()","4cd22823":"plt.figure(figsize=(10,8))\nsns.histplot(data=df,x='age',hue='stroke')","41cb7034":"plt.figure(figsize=(8,6))\nplt.title('heart_disease')\nsns.histplot(x='heart_disease',data=df,hue='stroke')\nplt.show()","5ad4d744":"plt.figure(figsize=(8,6))\nplt.title('heart_disease')\nsns.histplot(x='hypertension',data=df,hue='stroke')\nplt.show()","17cd5a92":"plt.figure(figsize=(10,6))\nplt.title('heart_disease')\nsns.histplot(x='work_type',data=df,hue='stroke')\nplt.show()","c65a1ab6":"df.corr()['stroke'].sort_values(ascending=False)","d6343b4b":"plt.figure(figsize=(10,8))\ndf.corr()['stroke'].sort_values(ascending=False)[1:].plot(kind='bar')","5d547287":"plt.figure(figsize=(12,8))\nplt.title('Correlation Heatmap')\nsns.heatmap(df.corr())\nplt.show()","d0dfebf0":"df.drop('smoking_status',axis=1,inplace=True)","a8c90751":"df.info()","94cc6663":"X=df.drop('stroke',axis=1)","f15951dd":"y=df['stroke']","4722cc97":"from sklearn.model_selection import train_test_split","7bb201e4":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","4c806ed4":"X_train.shape,y_train.shape","1a3521c8":"X_test.shape, y_test.shape","59ef6ef6":"lr=LogisticRegression()","dd23f6b4":"lr.fit(X_train,y_train)","d36450cc":"y_pred=lr.predict(X_test)","42e70572":"print(classification_report(y_test,y_pred))","3250aef7":"df['stroke'].value_counts()","3eb3ee59":"df_class_1=df[df['stroke']==1]\ndf_class_0=df[df['stroke']==0]","a187e1ec":"df_class_1_over = df_class_1.sample(4861, replace=True)","2f687b8a":"df_class_1_over.shape","16dedeb4":"df_test_over = pd.concat([df_class_0, df_class_1_over], axis=0)\n\nprint('Random over-sampling:')\nprint(df_test_over.stroke.value_counts())","8beda9fc":"# df_test_over","a8f4a205":"X = df_test_over.drop('stroke',axis='columns')\ny = df_test_over['stroke']\n\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=15, stratify=y)","07d92071":"lr.fit(X_train,y_train)\n","f2c0f542":"predictions=lr.predict(X_test)","a1203402":"predictions","08b12c65":"# y_test","01df3375":"print(classification_report(y_test,predictions))","37dcc889":"model = RandomForestClassifier()","57e621a3":"model.fit(X_train,y_train)","3eb5bf0d":"predictions=model.predict(X_test)","68f69e13":"print(classification_report(y_test,predictions))","d12e8eb5":"X_train.head(1)","f59ce2fc":"def rfc_model(data):\n    pred=model.predict(data)[0]\n    if pred==1:\n        return 'Stroke Occure'\n    else:\n        return 'Stroke not occure'\n\nrfc_model([[1,67.0,0,1,1,4,1,228.33,36.7,0,1,0,0]])\n    \n ","5b2c9899":"y_train[:1]","8d00a6d8":"### Model Building","4898e5e5":"1.hypertension\n\n2.heart_disease\n\n3.ever_married\n\n4.work_type\n\n5.Residence_type\n\n6.smoking_status\n\n7.Gender","e00912b7":"loading data!!!","41a7f3fe":"### Data Cleaning ","6284b275":"### Data Visualization","ab24a8d4":"##### 3.ever_married","45b8a98f":"##### 2.heart_disease","e8e8880a":"##### 7.Gender","0d44d903":"Now deal with categorcal data ","5af86c49":"### Handle imbalanced data","ca1590c4":"#### correlation heatmap","e3250cc3":"importing libraries","d6239428":"##### 5.Residence_type","e6d6dd17":"spliting data into training and testing set","4281336b":"##### 2.Age","cda30730":"A stroke occurs when the blood supply to part of your brain is interrupted or reduced, preventing brain tissue from getting oxygen and nutrients. Brain cells begin to die in minutes.\n\nA stroke is a medical emergency, and prompt treatment is crucial. Early action can reduce brain damage and other complications.","e8b85e0a":"### Feature Engineering","707111d9":"#### LogisticRegression","725f1be5":"* ## Project:- Stroke  Prediction","d6797a86":"### Train Test Split","60baa4d6":"acccuracy for 1 is not well bcoz our data is unbalanced","72054d01":"##### 4.work_type","b1b20eb4":"##### 3.Hypertension","f3e75c3f":"#### model building and model Evaluation","7773c978":"##### 6.smoking_status","c8a8f564":"Which Factor affecting most on Stroke","cbeaa605":"#### RandomForestClassifier","c49e815a":"#### OverSampling Method","f82442e9":"##### 1.hypertension","665ee5e4":"#### predictions","81e2b57d":"#### model Evaluations","d042094c":"##### 1.Avg Glucose level","e631c076":"### any missing values??","9c28d1ac":"##### 3.heart_disease"}}