{"cell_type":{"b0b91668":"code","16d33589":"code","e784d59f":"code","609fce32":"code","8be87b75":"code","83831f0e":"code","23fadac6":"code","679c5ac3":"code","95f91bed":"code","284ee483":"code","5f01b4a4":"markdown","e6196379":"markdown","e5b939fc":"markdown","4fcf686d":"markdown","8df6820d":"markdown","da8bb84a":"markdown"},"source":{"b0b91668":"import os\nimport numpy as np\nimport pandas as pd\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras import layers\nos.environ['TF_CPP_MIN_LOG_LEVEL'] = '3' # Supress tensorflow log outputs","16d33589":"train = pd.read_csv(\"\/kaggle\/input\/digit-recognizer\/train.csv\")\ntest = pd.read_csv(\"\/kaggle\/input\/digit-recognizer\/test.csv\")","e784d59f":"x_train = train.drop(\"label\", axis=1).astype(\"float32\") \/ 255.0\ny_train = train[\"label\"]","609fce32":"model = keras.Sequential([\n    layers.Dense(256, activation=\"relu\"),\n    layers.BatchNormalization(),\n    layers.Dropout(0.2),\n    \n    layers.Dense(128, activation=\"relu\"),\n    layers.BatchNormalization(),\n    layers.Dropout(0.2),\n    \n    layers.Dense(64, activation=\"relu\"),\n    layers.BatchNormalization(),\n    layers.Dropout(0.2),\n    \n    layers.Dense(10, activation=\"softmax\")\n])","8be87b75":"model.compile(\n    optimizer = keras.optimizers.Adam(),\n    loss = keras.losses.SparseCategoricalCrossentropy(),\n    metrics=[\"accuracy\"]\n)","83831f0e":"from tensorflow.keras.callbacks import EarlyStopping\nfrom tensorflow.keras.callbacks import ReduceLROnPlateau\nfrom tensorflow.keras.callbacks import ModelCheckpoint\n\ncallbacks = [\n    EarlyStopping(patience=15, monitor='val_loss'),\n\n\tReduceLROnPlateau(monitor='val_loss', min_lr=0.001, patience=5, mode='min',verbose=1),\n\n\tModelCheckpoint(monitor='val_loss', filepath='.\/best_model.h5', save_best_only=True)\n]","23fadac6":"model.fit(x_train, y_train, epochs=100, batch_size=64, validation_split=0.2, verbose=2, callbacks=callbacks)","679c5ac3":"model = keras.models.load_model(\"best_model.h5\") # load in best model","95f91bed":"x_test = test \/ 255.0\nsubmission = pd.read_csv(\"\/kaggle\/input\/digit-recognizer\/sample_submission.csv\")\nsubmission[\"Label\"] = np.argmax(model.predict(x_test), axis=-1)\nsubmission.to_csv(\"submission.csv\", index=False)","284ee483":"submission","5f01b4a4":"### Load in Data","e6196379":"### Callbacks to minimize loss","e5b939fc":"### Simple Model with Regularization","4fcf686d":"### Extract x_train and y_train","8df6820d":"### Submission","da8bb84a":"### Imports"}}