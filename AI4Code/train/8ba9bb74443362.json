{"cell_type":{"406262d2":"code","36c7e427":"code","94fbf7ce":"code","2dc7f5f4":"code","acb5a5f2":"code","b4848235":"code","9c672680":"code","f6279bea":"code","00820e81":"code","5f146c59":"code","8ebb1966":"code","30397b30":"code","00510dd8":"code","403f1b5d":"code","043cc8ae":"code","3ac33146":"code","8a76e8d9":"code","a3d216d5":"code","38475e24":"code","09e08651":"code","a2201832":"code","27809444":"code","e62cef2e":"code","95ff6c22":"code","9c6cc25b":"code","5987d41d":"code","c2f43d41":"code","1212df54":"code","d7d4e8ca":"code","6e4357e5":"code","58e057ec":"code","89017669":"code","94b2d568":"code","ca415202":"code","1fba3397":"code","f3fa623d":"code","a2237e4e":"code","bb14edbd":"code","c4128c0c":"code","baa85ec7":"code","c6837b81":"code","2163c40a":"code","0fd3450d":"code","3bf05396":"code","33627266":"code","0c38ca17":"code","6b1f8e2a":"code","b8cd8717":"code","ad358d50":"code","1ab31b82":"code","7f6ad722":"code","8957a650":"code","348688e6":"code","8804a820":"code","2c065ce2":"code","f88a7c08":"code","904280b7":"code","72747123":"code","ca29b359":"code","57f4f4f2":"code","9c9ae219":"code","96498e01":"code","498943ec":"code","37ce643b":"code","97710aee":"code","1b7e6755":"code","bbf9cdb2":"code","00015e5d":"code","646fda2d":"code","3bf82d36":"code","6ba0ffb9":"code","b3f3b1fd":"code","180dae38":"code","5c180f65":"code","c65ad81a":"code","93e71e09":"code","d14030fa":"code","e4fbe262":"code","831bf624":"code","4e9f2345":"code","7c98f9de":"code","ba52f4d9":"code","e3ee095a":"code","359057f3":"code","7e7f1e3c":"code","98b6cc2c":"code","9549c621":"code","b5393806":"code","94b400eb":"code","f873de78":"code","6376d223":"code","462b352d":"code","00b1ccbe":"code","f141f5ed":"code","dacc7809":"code","34a0d0e9":"code","55e95a65":"code","6081e714":"code","bea2bfdd":"markdown","8c282c86":"markdown","07cd30cf":"markdown","c77c657a":"markdown","6697c3f3":"markdown","3a63fdf9":"markdown","2e35c9b3":"markdown","ba923707":"markdown","45fcc46f":"markdown","48af7c8f":"markdown","588afac5":"markdown","ede13722":"markdown","8852f7df":"markdown","b5bf65ee":"markdown","f46850a4":"markdown","9af1e5b5":"markdown","ab18a2eb":"markdown","c5bce1e7":"markdown","fcc20b8a":"markdown","6a242aa9":"markdown","04896082":"markdown","0bcf96e6":"markdown","211ecb8c":"markdown","11688281":"markdown","8c6023b1":"markdown","1dc1a37e":"markdown","c1361167":"markdown","33b8640f":"markdown","115e8366":"markdown","fd6b6883":"markdown","60cbf4b4":"markdown","4bd637c0":"markdown","6ff659a3":"markdown","801d2e2e":"markdown","65a5dbf5":"markdown","3687a0ef":"markdown","c1dde0d3":"markdown","7d9c39ee":"markdown","2480833c":"markdown","86c24963":"markdown","7de50cb7":"markdown","32301cae":"markdown","586e6a38":"markdown","d4206e70":"markdown","2b8f79b0":"markdown","9d030a0d":"markdown","cbcd5262":"markdown","996e5d67":"markdown","a1938762":"markdown","211273aa":"markdown","17d378d1":"markdown","67122ba8":"markdown","3c4cf47e":"markdown","580b88f3":"markdown","11c0071c":"markdown","ab45e471":"markdown","2d4b0374":"markdown","7fc8cfcb":"markdown","1c70e1fd":"markdown","1445cb2f":"markdown","2f993bf7":"markdown","e36c40a0":"markdown","061ed6de":"markdown","cc47f41e":"markdown","0566ffda":"markdown","f65221c4":"markdown","f7986057":"markdown","4a7194fe":"markdown","264912f1":"markdown","38468c08":"markdown","d13d7d03":"markdown","507f86e1":"markdown","af476c39":"markdown","8fdf837f":"markdown","ee714380":"markdown"},"source":{"406262d2":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns # graph\nimport matplotlib.pyplot as plt\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","36c7e427":"math = pd.read_csv(\"..\/input\/student-mat.csv\")\npor = pd.read_csv(\"..\/input\/student-por.csv\")","94fbf7ce":"math.head()","2dc7f5f4":"len(math)","acb5a5f2":"por.head()","b4848235":"len(por)","9c672680":"math.rename(columns={'G1':'G1_Mat', 'G2':'G2_Mat', 'G3':'G3_Mat'}, inplace=True)","f6279bea":"por.rename(columns={'G1':'G1_Por', 'G2':'G2_Por', 'G3':'G3_Por'}, inplace=True)","00820e81":"math.columns","5f146c59":"# Students with grades in Math and Portuguese\nboth = pd.merge(math, por, on=['school', 'sex', 'age', 'address', 'famsize', 'Pstatus', 'Medu', 'Fedu',\n       'Mjob', 'Fjob', 'reason', 'guardian', 'traveltime', 'studytime',\n       'failures', 'schoolsup', 'famsup', 'activities', 'nursery',\n       'higher', 'internet', 'romantic', 'famrel', 'freetime', 'goout', 'Dalc',\n       'Walc', 'health', 'absences'])\nboth = both.drop_duplicates()","8ebb1966":"len(both)","30397b30":"# school - student's school (binary: 'GP' - Gabriel Pereira or 'MS' - Mousinho da Silveira)\n# sex - student's sex (binary: 'F' - female or 'M' - male)\n# age - student's age (numeric: from 15 to 22)\n# address - student's home address type (binary: 'U' - urban or 'R' - rural)\n# famsize - family size (binary: 'LE3' - less or equal to 3 or 'GT3' - greater than 3)\n# Pstatus - parent's cohabitation status (binary: 'T' - living together or 'A' - apart)\n# Medu - mother's education (numeric: 0 - none, 1 - primary education (4th grade), 2 \u2013 5th to 9th grade, 3 \u2013 secondary education or 4 \u2013 higher education)\n# Fedu - father's education (numeric: 0 - none, 1 - primary education (4th grade), 2 \u2013 5th to 9th grade, 3 \u2013 secondary education or 4 \u2013 higher education)\n# Mjob - mother's job (nominal: 'teacher', 'health' care related, civil 'services' (e.g. administrative or police), 'at_home' or 'other')\n# Fjob - father's job (nominal: 'teacher', 'health' care related, civil 'services' (e.g. administrative or police), 'at_home' or 'other')\n# reason - reason to choose this school (nominal: close to 'home', school 'reputation', 'course' preference or 'other')\n# guardian - student's guardian (nominal: 'mother', 'father' or 'other')\n# traveltime - home to school travel time (numeric: 1 - <15 min., 2 - 15 to 30 min., 3 - 30 min. to 1 hour, or 4 - >1 hour)\n# studytime - weekly study time (numeric: 1 - <2 hours, 2 - 2 to 5 hours, 3 - 5 to 10 hours, or 4 - >10 hours)\n# failures - number of past class failures (numeric: n if 1<=n<3, else 4)\n# schoolsup - extra educational support (binary: yes or no)\n# famsup - family educational support (binary: yes or no)\n# paid - extra paid classes within the course subject (Math or Portuguese) (binary: yes or no)\n# activities - extra-curricular activities (binary: yes or no)\n# nursery - attended nursery school (binary: yes or no)\n# higher - wants to take higher education (binary: yes or no)\n# internet - Internet access at home (binary: yes or no)\n# romantic - with a romantic relationship (binary: yes or no)\n# famrel - quality of family relationships (numeric: from 1 - very bad to 5 - excellent)\n# freetime - free time after school (numeric: from 1 - very low to 5 - very high)\n# goout - going out with friends (numeric: from 1 - very low to 5 - very high)\n# Dalc - workday alcohol consumption (numeric: from 1 - very low to 5 - very high)\n# Walc - weekend alcohol consumption (numeric: from 1 - very low to 5 - very high)\n# health - current health status (numeric: from 1 - very bad to 5 - very good)\n# absences - number of school absences (numeric: from 0 to 93)\n# These grades are related with the course subject, Math or Portuguese:\n\n# G1 - first period grade (numeric: from 0 to 20)\n# G2 - second period grade (numeric: from 0 to 20)\n# G3 - final grade (numeric: from 0 to 20, output target)","00510dd8":"por.isna().sum()","403f1b5d":"por.school.value_counts(normalize=True)","043cc8ae":"print(\"%s%% of the students are in Gabriel Pereira school\" % (100*round(por.school.value_counts(normalize=True)[0],4)))","3ac33146":"por.sex.value_counts(normalize=True)","8a76e8d9":"print(\"%s%% of the students are girls\" % (100*round(por.sex.value_counts(normalize=True)[0],4)))","a3d216d5":"sns.set(rc={'figure.figsize':(8,6)})\nsns.countplot(x=\"school\", hue =\"sex\", data=por)","38475e24":"sns.countplot(por.age)","09e08651":"por.address.value_counts(normalize=True)","a2201832":"print(\"%s%% of the students live in an urban area\" % (100*round(por.address.value_counts(normalize=True)[0],4)))","27809444":"por.famsize.value_counts(normalize=True)","e62cef2e":"print(\"%s%% of the students live in a family with more than 3 members\" % (100*round(por.famsize.value_counts(normalize=True)[0],4)))","95ff6c22":"sns.countplot(x=\"school\", hue =\"address\", data=por)","9c6cc25b":"por.Pstatus.value_counts(normalize=True)","5987d41d":"print(\"%s%% of the students' parents live together\" % (100*round(por.Pstatus.value_counts(normalize=True)[0],4)))","c2f43d41":"sns.countplot(x=\"Pstatus\", hue =\"famsize\", data=por)","1212df54":"sns.countplot(por.Medu)","d7d4e8ca":"sns.countplot(por.Fedu)","6e4357e5":"sns.countplot(x=\"Medu\", hue =\"Fedu\", data=por)","58e057ec":"sns.countplot(por.Mjob)","89017669":"por.Mjob.value_counts(normalize=True)","94b2d568":"print(\"%s%% of the mothers are at home\" % (100*round(por.Mjob.value_counts(normalize=True)[2],4)))","ca415202":"sns.countplot(por.Fjob)","1fba3397":"por.Fjob.value_counts(normalize=True)","f3fa623d":"print(\"%s%% of the fathers are at home\" % (100*round(por.Fjob.value_counts(normalize=True)[2],4)))","a2237e4e":"sns.countplot(x=\"Mjob\", hue =\"Medu\", data=por)","bb14edbd":"sns.countplot(x=\"Fjob\", hue =\"Fedu\", data=por)","c4128c0c":"sns.countplot(por.reason)","baa85ec7":"por.guardian.value_counts(normalize=True)","c6837b81":"sns.countplot(x=\"age\", hue =\"guardian\", data=por)","2163c40a":"sns.countplot(por.traveltime)","0fd3450d":"sns.countplot(x=\"address\", hue =\"traveltime\", data=por)","3bf05396":"sns.countplot(x=\"school\", hue =\"traveltime\", data=por)","33627266":"sns.countplot(por.studytime)","0c38ca17":"sns.countplot(x=\"school\", hue =\"studytime\", data=por)","6b1f8e2a":"sns.countplot(por.failures)","b8cd8717":"sns.countplot(x=\"age\", hue=\"failures\", data=por)","ad358d50":"por.schoolsup.value_counts(normalize=True)","1ab31b82":"por.famsup.value_counts(normalize=True)","7f6ad722":"sns.countplot(x=\"school\", hue=\"famsup\", data=por)","8957a650":"por.paid.value_counts(normalize=True)","348688e6":"sns.countplot(por[por.paid == 'yes']['famsup'])","8804a820":"por.activities.value_counts(normalize=True)","2c065ce2":"sns.countplot(x=\"sex\", hue=\"activities\", data=por)","f88a7c08":"por.nursery.value_counts(normalize=True)","904280b7":"sns.countplot(x=\"Medu\", hue=\"nursery\", data=por)","72747123":"por.higher.value_counts(normalize=True)","ca29b359":"sns.countplot(x=\"failures\", hue=\"higher\", data=por)","57f4f4f2":"sns.countplot(x=\"age\", hue=\"higher\", data=por)","9c9ae219":"por.internet.value_counts(normalize=True)","96498e01":"sns.countplot(x=\"Medu\", hue=\"internet\", data=por)","498943ec":"sns.countplot(x=\"Mjob\", hue=\"internet\", data=por)","37ce643b":"sns.countplot(x=\"school\", hue=\"internet\", data=por)","97710aee":"por.romantic.value_counts(normalize=True)","1b7e6755":"sns.countplot(x=\"age\", hue=\"romantic\", data=por)","bbf9cdb2":"sns.countplot(por.famrel)","00015e5d":"sns.countplot(por.freetime)","646fda2d":"por.head()","3bf82d36":"sns.countplot(por.goout)","6ba0ffb9":"sns.countplot(x=\"freetime\", hue=\"goout\", data=por)","b3f3b1fd":"sns.countplot(por.Dalc)","180dae38":"sns.countplot(x=\"goout\", hue=\"Dalc\", data=por)","5c180f65":"sns.countplot(x=\"sex\", hue=\"Dalc\", data=por)","c65ad81a":"sns.countplot(por.Walc)","93e71e09":"sns.countplot(x=\"Dalc\", hue=\"Walc\", data=por)","d14030fa":"sns.countplot(por.health)","e4fbe262":"sns.countplot(x=\"sex\", hue=\"health\", data=por)","831bf624":"sns.countplot(x=\"Walc\", hue=\"health\", data=por)","4e9f2345":"sns.distplot(por.absences)","7c98f9de":"por.columns","ba52f4d9":"por['Total_Grades'] = por['G1_Por'] + por['G2_Por'] + por['G3_Por']","e3ee095a":"sns.distplot(por.Total_Grades)","359057f3":"GP = por[por.school == 'GP']\nMS = por[por.school == 'MS']\n\nsns.distplot(GP.Total_Grades, hist=False, label=\"GP\")\nsns.distplot(MS.Total_Grades, hist=False, label=\"MS\")\nplt.show()","7e7f1e3c":"por['school'] = por['school'].map({'GP': 0, 'MS': 1}).astype(int)\npor['sex'] = por['sex'].map({'M': 0, 'F': 1}).astype(int)\npor['address'] = por['address'].map({'R': 0, 'U': 1}).astype(int)\npor['famsize'] = por['famsize'].map({'LE3': 0, 'GT3': 1}).astype(int)\npor['Pstatus'] = por['Pstatus'].map({'A': 0, 'T': 1}).astype(int)\npor['Mjob'] = por['Mjob'].map({'at_home': 0, 'health': 1, 'other': 2, 'services': 3, 'teacher': 4}).astype(int)\npor['Fjob'] = por['Fjob'].map({'at_home': 0, 'health': 1, 'other': 2, 'services': 3, 'teacher': 4}).astype(int)\npor['reason'] = por['reason'].map({'course': 0, 'other': 1, 'home': 2, 'reputation': 3}).astype(int)\npor['guardian'] = por['guardian'].map({'mother': 0, 'father': 1, 'other': 2}).astype(int)\npor['schoolsup'] = por['schoolsup'].map({'no': 0, 'yes': 1}).astype(int)\npor['famsup'] = por['famsup'].map({'no': 0, 'yes': 1}).astype(int)\npor['paid'] = por['paid'].map({'no': 0, 'yes': 1}).astype(int)\npor['activities'] = por['activities'].map({'no': 0, 'yes': 1}).astype(int)\npor['nursery'] = por['nursery'].map({'no': 0, 'yes': 1}).astype(int)\npor['higher'] = por['higher'].map({'no': 0, 'yes': 1}).astype(int)\npor['internet'] = por['internet'].map({'no': 0, 'yes': 1}).astype(int)\npor['romantic'] = por['romantic'].map({'no': 0, 'yes': 1}).astype(int)","98b6cc2c":"por.head()","9549c621":"por.corr()['Total_Grades'].sort_values(ascending=False)","b5393806":"grades_corr = por.corr()['Total_Grades']","94b400eb":"grades_corr = pd.DataFrame({'col':grades_corr.index, 'correlation':grades_corr.values})","f873de78":"no_corr_cols = grades_corr[(grades_corr.correlation < 0.1) & (grades_corr.correlation > -0.1)]\nno_corr_cols = list(no_corr_cols.col)","6376d223":"# Droping grades because they are too correlated and can bias the model\nX = por.drop(['G1_Por', 'G2_Por', 'G3_Por', 'Total_Grades'], axis=1)\ny = por['Total_Grades']","462b352d":"# Droping columns with no correlation\nX = X.drop(no_corr_cols, axis=1)","00b1ccbe":"from sklearn.linear_model import LinearRegression, Ridge, Lasso\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.model_selection import cross_val_score\n\nmodels = [LinearRegression(), Ridge(), Lasso(), DecisionTreeRegressor()]\nnames = ['LinearRegression', 'Ridge', 'Lasso', 'DecisionTreeRegressor']\n\nfor name, clf in zip(names, models):\n    cv_model = cross_val_score(clf, X, y, cv=5).mean()\n    print(name, ': %s' % cv_model)","f141f5ed":"dtr = DecisionTreeRegressor()\ncvs = range(2,20)\ncvs_models = []\nfor i in cvs:\n    cvs_models.append(abs(cross_val_score(clf, X, y, cv=i).mean()))\n    \nprint('Best score with', cvs_models.index(min(cvs_models)), 'subsets : %s' % max(cvs_models))","dacc7809":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","34a0d0e9":"dtr = DecisionTreeRegressor()","55e95a65":"dtr.fit(X_train, y_train)","6081e714":"dtr.score(X_test,y_test)","bea2bfdd":"Juste based on this graph, Mousinho da Silveira seems less demanding than Gabriel Pereira, we will see grades evaluations after","8c282c86":"There are more girls in both schools","07cd30cf":"Good correlations with columns grades (logic), failures and higher","c77c657a":"12. Guardian","6697c3f3":"1. School","3a63fdf9":"**Grades Prediction**","2e35c9b3":"Creating students with grades in Math and Portuguese dataset","ba923707":"Same observation with jobs","45fcc46f":"Parents at tend to have lesser level of education, teachers and health jobs have the higher level of education","48af7c8f":"25. Free time","588afac5":"29. Current health status","ede13722":"Higher percentage of wanting to be in sursery when mothers took higher educations","8852f7df":"5. Famsize","b5bf65ee":"As guessed earlier, Mousinho da Silveira is on the outskirts of the city, where students have more travel time","f46850a4":"Students in Gabriel Pereira are mostly from urban area whereas Mousinho da Silveira has the same amount of students from urban and rural areas. \nIt seems Gabriel Pereira school in near the center of the city, Mousinho da Silveira located on the outskirts of the city","9af1e5b5":"Boys have more extra activities than girls","ab18a2eb":"Boys are in better health than girls","c5bce1e7":"Daily alcohol consumption and Weekend alcohol consumption are very corrolated","fcc20b8a":"It seems to be quite similar, mothers with no education are just a few","6a242aa9":"Weekend alcohol consumption has an impact on health, it seems that the more students drink, the more they are in good shape","04896082":"23. Romantic relationship","0bcf96e6":"27. Workday alcohol consumption","211ecb8c":"20. Nursery","11688281":"Majority of fathers did not attempt secondary education","8c6023b1":"21. Wants to take higher education","1dc1a37e":"6. Pstatus","c1361167":"Majority of guardians are the mothers","33b8640f":"Majority of students has less than 15 minutes of travel","115e8366":"26. Going out with friends","fd6b6883":"Interesting to see that parents tend to be their similar level of education","60cbf4b4":"More family educational support in Gabriel Pereira","4bd637c0":"19. Extra-curricular activities","6ff659a3":"More travel in rural area","801d2e2e":"Majority of the students are between 15 and 18","65a5dbf5":"30. Absences","3687a0ef":"**Data Cleaning**","c1dde0d3":"2. Sex","7d9c39ee":"8. Fedu","2480833c":"18. Extra paid classes","86c24963":"The more the mother took higher education, the more students have internet","7de50cb7":"17. Fam Support","32301cae":"Students at Gabriel Pereira have more access to internet than Mousinho da Silveira ","586e6a38":"The majority of the students took the school for the course","d4206e70":"Students study less than 5 hours a week","2b8f79b0":"3. Age","9d030a0d":"Families with parents apart tend to have less than 3 members","cbcd5262":"4. Address","996e5d67":"15. Failures","a1938762":"Older students are more to be in relationships","211273aa":"Converting categorical features","17d378d1":"After 18, the guardian changes","67122ba8":"28. Weekend alcohol consumption","3c4cf47e":"24. Quality of family relationships","580b88f3":"Best score with Decision Tree Regressor","11c0071c":"9. Mjob","ab45e471":"Not enough data to have a good score","2d4b0374":"**Data Exploration**","7fc8cfcb":"31. Grades","1c70e1fd":"11. Reason","1445cb2f":"The more students go out, the more they drink in the week","2f993bf7":"'GP' - Gabriel Pereira or 'MS' - Mousinho da Silveira)","e36c40a0":"The more students have freetime, the more they go out","061ed6de":"14. Study Time","cc47f41e":"Better grades at Gabriel Pereira","0566ffda":"We will use the Portuguese dataset because it has more data","f65221c4":"10. Fjob","f7986057":"22. Internet","4a7194fe":"16. School Support","264912f1":"Older students want less to take higher education","38468c08":"The more students have failures, the less they want to take higher education","d13d7d03":"Students have in general good relations with their family","507f86e1":"Failures are not very significative","af476c39":"13. Travel Time","8fdf837f":"7. Medu","ee714380":"More failures when students age"}}