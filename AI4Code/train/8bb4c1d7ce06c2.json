{"cell_type":{"dca482ba":"code","1ab8f7aa":"code","ef687bf6":"code","708b5733":"code","9d3383da":"code","34d4faff":"code","73c9c820":"code","7c51d4c5":"code","389564d3":"code","71f2e0cc":"code","9b675ea1":"code","639e05cf":"code","a447c0ee":"code","70f1581d":"markdown","5b87f6c1":"markdown","e375affa":"markdown","6ee5ab8c":"markdown","d61a839f":"markdown","0f143147":"markdown"},"source":{"dca482ba":"import os\nfrom PIL import Image\nimport numpy as np\nimport random\nimport tensorflow as tf\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom tensorflow.keras import models, layers, losses","1ab8f7aa":"train_dir = \"\/kaggle\/input\/gtsrb-german-traffic-sign\/train\"","ef687bf6":"train_datagen = ImageDataGenerator(validation_split=0.2, rescale=1.\/255)\n\ntrain_generator = train_datagen.flow_from_directory(\n    train_dir,\n    subset='training',\n    target_size=(32,32),\n    batch_size=32,\n    color_mode='rgb',    \n    shuffle=True,\n    seed=42,\n    class_mode='categorical')","708b5733":"input_shape = (32,32,3) # img_rows, img_colums, color_channels\nnum_classes = 43","9d3383da":"## Build Model\ninputs = layers.Input(shape=input_shape)\n# 1st Conv layer \nx = layers.Conv2D(32, kernel_size = (3, 3), activation = 'relu', padding = 'same')(inputs)\nx = layers.Conv2D(32, kernel_size = (3, 3), activation = 'relu', padding = 'same')(x)\nx = layers.MaxPool2D(pool_size = (2, 2))(x)\n# 2nd Conv layer        \nx = layers.Conv2D(64, kernel_size = (3, 3), activation = 'relu', padding = 'same')(x)\nx = layers.Conv2D(64, kernel_size = (3, 3), activation = 'relu', padding = 'same')(x)\nx = layers.MaxPool2D(pool_size = (2, 2))(x)\n# Fully Connected layer        \nx = layers.Flatten()(x)\nx = layers.Dense(256)(x)\nx = layers.Dropout(0.5)(x)\noutputs = layers.Dense(num_classes, activation=\"softmax\")(x)\n\nmodel = models.Model(inputs=inputs, outputs=outputs)\n\nmodel.summary()","34d4faff":"# Compile Model\nmodel.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])","73c9c820":"STEP_SIZE_TRAIN=train_generator.n\/\/train_generator.batch_size\nnum_epochs = 10","7c51d4c5":"# Train Model\nhistory = model.fit(train_generator,steps_per_epoch=STEP_SIZE_TRAIN,epochs=num_epochs) #, callbacks=[checkpoint])","389564d3":"import pandas as pd\ndf = pd.read_csv('\/kaggle\/input\/gtsrb-german-traffic-sign\/Test.csv')\ndf.head()","71f2e0cc":"!mkdir -p Dataset\/Test","9b675ea1":"from shutil import copyfile\nsrc_dir  = \"\/kaggle\/input\/gtsrb-german-traffic-sign\/\"\ntest_dir = \".\/Dataset\/Test\/\"\nfor i in range(len(df)):\n    if not os.path.exists(test_dir+str(df.iloc[i].ClassId)):\n        os.makedirs(test_dir+str(df.iloc[i].ClassId))\n    copyfile(src_dir+df.iloc[i].Path, test_dir+str(df.iloc[i].ClassId)+'\/'+df.iloc[i].Path[5:])","639e05cf":"test_datagen = ImageDataGenerator(rescale=1.\/255)\n\ntest_generator = test_datagen.flow_from_directory(\n    test_dir,\n    target_size=(32,32),\n    batch_size=32,\n    color_mode='rgb',    \n    shuffle=True,\n    seed=42,\n    class_mode='categorical')","a447c0ee":"STEP_SIZE_TEST =test_generator.n\/\/test_generator.batch_size\n\nscore = model.evaluate(test_generator, steps=STEP_SIZE_TEST)\nprint('Test loss:', score[0])\nprint('Test accuracy:', score[1])","70f1581d":"## Test Model","5b87f6c1":"## Train Model","e375affa":"# German Traffic Sign Recognition","6ee5ab8c":"## GTSRB Dataset\nThe dataset features 43 different signs under various sizes, lighting conditions, occlusions and is very similar to real-life data. Training set includes about 39000 images while test set has around 12000 images. <br \/>\n![GTSRB](https:\/\/chsasank.github.io\/assets\/images\/traffic\/classes.jpg)","d61a839f":"## Build Model","0f143147":"## Data Augmentation"}}