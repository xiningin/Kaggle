{"cell_type":{"e969a808":"code","e10f2eca":"code","0c7677fd":"code","213de7cb":"code","a3cbea64":"code","dfbf173b":"code","a60a5c7c":"code","107cd639":"code","f4c84a75":"code","cf075dd3":"code","4c5f2a68":"markdown","f7be7f24":"markdown","33f43a56":"markdown","3faab1e9":"markdown","8fc7f226":"markdown","ec7d3950":"markdown","9d58f442":"markdown","f5717bf8":"markdown"},"source":{"e969a808":"import numpy as np\nimport pandas as pd","e10f2eca":"#Import movie ratings\ndata_ratings = pd.read_csv('..\/input\/movie-lens-small-latest-dataset\/ratings.csv')\ndata_ratings.head()","0c7677fd":"#Import movie data\ndata_movies = pd.read_csv('..\/input\/movie-lens-small-latest-dataset\/movies.csv')\ndata_movies.head()","213de7cb":"#Merge both the datasets\nmovie_ratings = pd.merge(data_movies, data_ratings, on = 'movieId')\nprint(movie_ratings.shape)\nmovie_ratings.head()","a3cbea64":"#Groupby all movie titles together and find their mean ratings\nmovie_ratings.groupby('title')['rating'].mean().head()","dfbf173b":"#Sort movies based on ratings from highest to lowest\nmovie_ratings.groupby('title')['rating'].mean().sort_values(ascending = False)","a60a5c7c":"#Recommend top n popular movies\nn = 10\n\nmovie_ratings.groupby('title')['rating'].mean().sort_values(ascending = False).head(n)","107cd639":"movie_ratings['title'].value_counts()\n#movie_ratings.groupby('title')['rating'].count().sort_values(ascending = False).head() either of the 2 gives same output","f4c84a75":"#First create a DataFrame\ndata = pd.DataFrame(movie_ratings.groupby('title')['rating'].mean())\ndata['rating_counts'] = pd.DataFrame(movie_ratings['title'].value_counts())\n#data['rating_counts'] = pd.DataFrame(movie_ratings.groupby('title')['rating'].count()) #either of the 2 codes\ndata.head()","cf075dd3":"#load packages\nfrom math import *\n\n#Creating 2 functions, square root and cosine similarity just like the formula\n\ndef square_rooted(x):\n    return round(sqrt(sum([a*a for a in x])),3)\n\ndef cosine_similarity(x,y):\n    numerator = sum(a*b for a,b in zip(x,y))\n    denominator = square_rooted(x) * square_rooted(y)\n    return round(numerator\/ float(denominator),3)\n\nprint(cosine_similarity([3,45,7,2],[2,54,13,15]))","4c5f2a68":"# What is Recommendation System ?\nRecommender\/recommendation system is a subclass of information filtering system that seeks to predict the rating\/ preference a user would give to an item.\n\nThey are primarily used in applications where a person\/ entity is involved with a product\/ service. To further improve their experience with this product, we try to personalize it to their needs. For this we have to look up at their past interactions with this product.\n\n*In one line* -> **Specialized content for everyone.**\n\n*For further info, [Wiki](https:\/\/en.wikipedia.org\/wiki\/Recommender_system#:~:text=A%20recommender%20system%2C%20or%20a,would%20give%20to%20an%20item.)*\n\nHere we will learn the foll.\n\n* 1. Popularity based Recommender System\n* 2. Cosine Similarity (code from scratch)\n\n\n# Popularity based recommender system\nAs the name suggests it recommends based on what is currently trending\/ popular across the site. This is particularly useful when you don't have past data as a reference to recommend product to the user. It is not tailor fit for any particular group of audience or movie.","f7be7f24":"**0.972 implies a good cosine score.**","33f43a56":"# Import packages and dataset","3faab1e9":"**What is movie rating and how many people voted for this ?**","8fc7f226":"We will recommend movies based on ratings they have got. For the huge dataset, we will use just movies & ratings data.","ec7d3950":"**How many users have rated a given movie ?**","9d58f442":"# Recommend Popular Movies\n\nThis dataset doesn't need much of data preprocessing also there are no NaN values so we can directly proceed over to recommending popular movies based on ratings.\n\n**Things to do:**\n\n* Groupby all movie titles together and find their mean ratings\n* Sort movies based on ratings from highest to lowest\n* Recommend top n popular movies","f5717bf8":"# Calculating Cosine Similarity\n\nCosine similarity is a measure of similarity between two non-zero vectors, that measures the cosine of the angle between them. Here we would a write code for cosine similarity from scratch.\n\n*For more info -> [Wiki](https:\/\/en.wikipedia.org\/wiki\/Cosine_similarity#:~:text=Cosine%20similarity%20is%20a%20measure,to%20both%20have%20length%201.)*\n\n**Things to do:**\n\n* Import math package\n* Create square root and cosine similarity function"}}