{"cell_type":{"8e9f1761":"code","7197d11b":"code","c2558419":"code","4ab325fd":"code","d6acf4c4":"code","b9292dec":"code","134b20cc":"code","551db564":"code","4c94cfd8":"code","3deb24d7":"code","76cc7c13":"code","5ed9f32f":"code","c2828b10":"code","290c274b":"code","49c1274b":"code","2212e3cb":"code","40d56c4e":"code","8fbf0fbb":"code","2b9aa98f":"code","8d297ae5":"code","1144e159":"code","3530f4a1":"code","24f1d431":"code","a141b3a0":"code","e18941ed":"code","2daa3cd1":"code","fde81baf":"code","1ed5fcaa":"code","ed8c8cd4":"code","2eec9ecd":"code","9ad67e28":"code","0863d778":"code","65098775":"code","d67e2d25":"code","e7de43f6":"code","4b13fea0":"code","af653eec":"code","8013cd94":"code","86225fb4":"code","a7fff124":"code","05f46420":"code","a6c9100a":"code","2a5cfb9c":"code","6ada7882":"code","9e7ac8f0":"markdown","077e2238":"markdown","33d2b045":"markdown","82c6fff9":"markdown","e9096364":"markdown","1bb74dba":"markdown","f9199265":"markdown","184e6ad2":"markdown","ef4f9031":"markdown","e2db004e":"markdown","76208bd8":"markdown"},"source":{"8e9f1761":"from sklearn import linear_model\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.preprocessing import OneHotEncoder,LabelEncoder\nfrom sklearn import preprocessing  \nfrom sklearn.model_selection import train_test_split","7197d11b":"import pandas as pd\nimport numpy as np\nfrom math import sqrt ","c2558419":"import seaborn as sns\nimport matplotlib.pyplot as plt","4ab325fd":"lm = linear_model.LinearRegression()","d6acf4c4":"train = pd.read_csv('..\/input\/bigmart-sales-data\/Train.csv') ########### Reading training Data ","b9292dec":"test = pd.read_csv('..\/input\/bigmart-sales-data\/Test.csv')  ########### Reading testing Data ","134b20cc":"train['source'] = 'train'\ntest['source'] = 'test'\ntest['Item_Outlet_Sales'] = 0\ndata = pd.concat([train, test], sort = False)\nprint(train.shape, test.shape, data.shape)","551db564":"data","4c94cfd8":"data.dtypes \n","3deb24d7":"data.isnull().sum()","76cc7c13":"data['Item_Weight']=data['Item_Weight'].fillna(data['Item_Weight'].mean())","5ed9f32f":"data","c2828b10":"sns.countplot(data.Outlet_Location_Type)","290c274b":"sns.boxplot(data['Item_Weight'])","49c1274b":"plt.figure(figsize=(12,8))\nsns.countplot(data.Outlet_Type)","2212e3cb":"plt.figure(figsize=(25,8))\nsns.countplot(data.Outlet_Identifier)","40d56c4e":"plt.figure(figsize=(25,8))\nsns.countplot(data.Item_Type)","8fbf0fbb":"data['Outlet_Size'] = data['Outlet_Size'].fillna(data['Outlet_Size'].value_counts().index[0])","2b9aa98f":"data","8d297ae5":"sns.boxplot(x='Outlet_Size',y='Item_Outlet_Sales',data = data)\n\n","1144e159":"sns.boxplot(x='Item_Outlet_Sales',y='Item_Fat_Content',data = data)","3530f4a1":"plt.figure(figsize=(20,8))\nsns.boxplot(y='Item_Outlet_Sales',x='Outlet_Type',hue = 'Outlet_Location_Type',data = data)","24f1d431":"data['Item_Outlet_Sales'].describe()","a141b3a0":"sns.distplot(data['Item_Outlet_Sales'])","e18941ed":"print(\"skewness :\",data['Item_Outlet_Sales'].skew())\nprint(\"kurtosis :\",data['Item_Outlet_Sales'].kurt())","2daa3cd1":"train.columns","fde81baf":"#### Unique items in data set\ndata.apply(lambda x : len(x.unique()))","1ed5fcaa":"le = LabelEncoder()\nenc = OneHotEncoder()","ed8c8cd4":"label = ['Item_Identifier','Item_Fat_Content','Item_Type','Outlet_Identifier','Outlet_Establishment_Year']\none = ['Outlet_Size','Outlet_Location_Type','Outlet_Type']","2eec9ecd":"for col in label:\n    data[col]=le.fit_transform(data[col]) ","9ad67e28":"data","0863d778":"for col in one:\n    data[col]=le.fit_transform(data[col]) ","65098775":"data","d67e2d25":"def model(data):\n    grp = data.groupby('source')\n    test = grp.get_group('test')\n    train = grp.get_group('train')\n    train = train.drop('source',axis=1)\n    test = test.drop('source',axis=1)\n    Y = train.Item_Outlet_Sales\n    X = train.drop('Item_Outlet_Sales',axis=1)\n    x_train,x_test,y_train,y_test = train_test_split(X,Y,test_size=0.3,random_state = 42)\n    model = lm.fit(x_train, y_train)\n    predictions = lm.predict(x_test)\n    RMSE = sqrt((( y_test-predictions)**2).mean())\n    return RMSE","e7de43f6":"print('RMSE with raw data :',model(data))","4b13fea0":"data.corr(method='pearson')##### Linear correlation","af653eec":"rmv = ['Item_Identifier','Item_Weight','Item_Fat_Content','Item_Type','Outlet_Establishment_Year']","8013cd94":"data.drop(rmv, axis=1, inplace=True)","86225fb4":"data.columns","a7fff124":"print('RMSE after reducing some features :',model(data))","05f46420":"def remove_outlier(data,column):\n    Q3 = data[column].quantile(.75)\n    Q1 = data[column].quantile(.25)\n    IQR = Q3-Q1\n    data = data[~((data[column] < (Q1 - 1.5 * IQR)) |(data[column] > (Q3 + 1.5 * IQR)))]\n    return data\n    ","a6c9100a":"data_o =remove_outlier(data,'Outlet_Size')","2a5cfb9c":"data_o","6ada7882":"print('RMSE after removing outliers :',model(data_o))","9e7ac8f0":"Since 'Item_Weight' is a continues variable , I am using mean to fill missing values . Ofcourse we've got some other options too, such as median, mode etc. ","077e2238":"I am done with numbers, Let's see what graphs have to offer.\nclearly we have 3 'Outlet_Location_Type' among them Tier3 has more outlets but how does\nit add any value in Sales prediction. \n","33d2b045":"So, let's start with importing essential libraries,","82c6fff9":"This is because i am going to use Linear regression to predict 'Item_Outlet_Sales'","e9096364":"# BigMart Sales Prediction ","1bb74dba":"checking if there are missing values in our dataset, ","f9199265":"General Info : Datset consist of 7 categorical features, 5 numerical feature and 1 addition feature we just added to keep track of 'Train' and 'Test' data set","184e6ad2":"similarly, 'Item_Weight' has minimal effect on 'Item_Otlet_Sales' ","ef4f9031":"Merging training and testing data as one big dataset because it saves some trouble of making same changes in both 'Train' and 'Test' separetly.\nfor example : if i am imputing missing values in 'Train' by 'Most Frequent Value or Mode' then i will be using Mode in 'Test' as well.","e2db004e":"This is my first Notebook, I don't know whether its good or bad, but by the way all feedbacks\/suggestions are welcome.  ","76208bd8":"\n\n**BigMart Sales Prediction practice problem**\n\nWe have train (8523) and test (5681) data set, train data set has both input and output variable(s). We need to predict the sales for test data set.\n\n    1. Item_Identifier: Unique product ID\n\n    2. Item_Weight: Weight of product\n\n    3. Item_Fat_Content: Whether the product is low fat or not\n\n    4. Item_Visibility: The % of total display area of all products in a store allocated to the particular product\n\n    5. Item_Type: The category to which the product belongs\n\n    6. Item_MRP: Maximum Retail Price (list price) of the product\n\n    7. Outlet_Identifier: Unique store ID\n\n    8. Outlet_Establishment_Year: The year in which store was established\n\n    9. Outlet_Size: The size of the store in terms of ground area covered\n\n    10.Outlet_Location_Type: The type of city in which the store is located\n\n    11.Outlet_Type: Whether the outlet is just a grocery store or some sort of supermarket\n\n    12.Item_Outlet_Sales: Sales of the product in the particulat store. This is the outcome variable to be predicted.\n\n"}}