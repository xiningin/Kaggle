{"cell_type":{"c13bf34c":"code","495ec682":"code","79f01e68":"markdown"},"source":{"c13bf34c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","495ec682":"from sklearn.metrics import roc_auc_score\nfrom sklearn import tree\nimport graphviz\ntrain = pd.read_csv('..\/input\/train.csv')\ncols = []\nfor i in range(0,200):\n    cols.append('var_'+str(i))\n    \nvalid = train.sample(frac=0.2, random_state=42)\ntrain = train[ ~train.index.isin(valid.index) ].sample(frac=1)\n\n#model = tree.DecisionTreeClassifier(max_leaf_nodes=4)\nmodel = tree.DecisionTreeRegressor(max_leaf_nodes=10)\nmodel.fit(train[cols], train['target'])\n#pred_val = model.predict_proba(valid[cols])[:,1]\npred_val = model.predict(valid[cols])\n\nprint('AUC = ',round( roc_auc_score(valid['target'],pred_val),4 ) )\ntree_graph = tree.export_graphviz(model, out_file=None, max_depth = 10,\n    impurity = False, feature_names = cols, class_names = ['0', '1'],\n    rounded = True, filled= True )\ngraphviz.Source(tree_graph)  ","79f01e68":"**This is code shared by [Chris Deotte](https:\/\/www.kaggle.com\/cdeotte) in a Discussion**"}}