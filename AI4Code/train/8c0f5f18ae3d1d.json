{"cell_type":{"9b06dc58":"code","892d74c0":"code","989ce4a5":"code","b1d96bef":"code","f4b59dda":"code","0a7b0ef3":"code","0dc8f8d5":"code","1b625a2e":"code","46af1921":"code","05c9a66c":"code","97201df4":"code","ff7ef6d4":"code","adf2d257":"code","626cc8d0":"code","8abd4e59":"code","910fc30f":"code","7d5a493b":"markdown","37f69609":"markdown","6ccc4b05":"markdown","ea5c94bc":"markdown","84b4314c":"markdown","68e34f2f":"markdown","3f88e81c":"markdown","753b27ba":"markdown","24a8e9bb":"markdown"},"source":{"9b06dc58":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom matplotlib import pyplot as plt\nfrom mpl_toolkits.basemap import Basemap\nimport plotly.offline as py\npy.init_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nimport plotly.tools as tls\nimport seaborn as sns\n\n%matplotlib inline \nimport os\n# Set work Directory\nos.chdir(\"..\/input\")","892d74c0":"from IPython.display import HTML\n\nHTML('''<script>\ncode_show=true; \nfunction code_toggle() {\n if (code_show){\n $('div.input').hide();\n } else {\n $('div.input').show();\n }\n code_show = !code_show\n} \n$( document ).ready(code_toggle);\n<\/script>\n<form action=\"javascript:code_toggle()\"><input type=\"submit\" value=\"Click here to toggle on\/off the raw code.\"><\/form>''')","989ce4a5":"%%HTML\n<center><img src=\"https:\/\/e.rpp-noticias.io\/normal\/2018\/08\/14\/353935_662104.jpg\"><center>","b1d96bef":"# Read Data\ncacao = pd.read_csv('flavors_of_cacao.csv')\nlist(cacao)","f4b59dda":"# Rename columns\ncacao.columns = ['company', 'bean_orig', 'ref', 'review_date', 'cacao_percent',\n                 'company_location', 'rating', 'bean_type', 'broad_bean_origin' ]","0a7b0ef3":"# Looking for nulls\nprint(cacao.isnull().any())\n\n# Inspecting type\nprint(cacao.dtypes)","0dc8f8d5":"#cacao_percent to number\ncacao['cacao_percent']= cacao['cacao_percent'].str.strip('%').astype(float)\ncacao.head()","1b625a2e":"# Broad Bean Origin\nprint('Number of Broad Bean Origin %d' % cacao[cacao.broad_bean_origin != '\\xa0'].broad_bean_origin.dropna().nunique())","46af1921":"bean_origin = cacao[cacao.broad_bean_origin != '\\xa0'].broad_bean_origin.value_counts()\nbean_origin[:10].plot.barh(width=0.9, color = '#339FFF')\nplt.xlabel('Count of Chocolate Bars')\nplt.ylabel('Countries of Bean Origin')\nprint(\"Fig 1: Top-10 Broad Bean Origin\")","05c9a66c":"## Top-10 Company Location","97201df4":"companyL = cacao.company_location.value_counts()\ncompanyL[:10].plot.barh(width=0.9, color = '#339FFF')\nplt.xlabel('Count of Chocolate Bars')\nplt.ylabel('Company Location')\nprint(\"Fig 2: Top-10 Company Location\")","ff7ef6d4":"countries = companyL.index.tolist()\nmean_rating = []\nfor country in countries:\n    mean_rating.append(cacao[cacao['company_location'] == country]['rating'].mean())\n    \ndata = [ dict(\n        type = 'choropleth',        \n        locations = countries,\n        z = mean_rating,\n        locationmode = 'country names',\n        text = countries,\n        marker = dict(\n            line = dict(color = 'rgb(0,0,0)', width = 1)),\n            colorbar = dict(autotick = True, tickprefix = '',\n            title = 'Average\\nRating'),\n        #The following line is also needed to create Stream\n        #stream = stream_id\n            )\n       ]\n\nlayout = dict(\n    title = 'Average Rating Country Company Location',\n    geo = dict(\n        showframe = False,\n        showocean = True,\n        oceancolor = '#339FFF',\n        type = 'equirectangular'\n    ),\n)\n\nfig = dict(data=data, layout=layout)\npy.iplot(fig, validate=False, filename='world_rating_cacao_location')","adf2d257":"countries_ = bean_origin.index.tolist()[:42]\n#count_bars = []\n#for country in countries_:\n    #count_bars.append(cacao[cacao['broad_bean_origin'] == country]['broad_bean_origin'].value_counts().values[0])\n    \nmean_rating_ = []\nfor country in countries_:\n    mean_rating_.append(cacao[cacao['broad_bean_origin'] == country]['rating'].mean())\n    \ndata = [ dict(\n        type = 'choropleth',        \n        locations = countries_,\n        z = mean_rating_,\n        locationmode = 'country names',\n        text = countries_,\n        marker = dict(\n            line = dict(color = 'rgb(0,0,0)', width = 1)),\n            colorbar = dict(autotick = True, tickprefix = '',\n            title = 'Average\\nRating'),\n        #The following line is also needed to create Stream\n        #stream = stream_id\n            )\n       ]\nlayout = dict(\n    title = 'Average rating Country Bean Origin',\n    geo = dict(\n        showframe = False,\n        showocean = True,\n        oceancolor = '#339FFF',\n        type = 'equirectangular'\n    ),\n)\n\nfig = dict(data=data, layout=layout)\npy.iplot(fig, validate=False, filename='world_rating_cacao_map')","626cc8d0":"## Look best Cocoa Beans Grown\nbestCocoaBeansGrown = cacao[cacao['broad_bean_origin'].isin(bean_origin[:11].index.tolist())]\n\nf, (ax) = plt.subplots(1, 1, figsize=(12, 4))\nf.suptitle('Boxplot, Rating by Bean Country Origin', fontsize=14)\n\nsns.boxplot(data=bestCocoaBeansGrown,  \n            x=\"rating\", \n            y=bestCocoaBeansGrown.broad_bean_origin,\n            palette=\"Reds\",\n            ax=ax)\n\nax.set_xlabel(\"Country bean origin\",size=12,alpha=0.8)\nax.set_ylabel(\"Rating\",size=12,alpha=0.8)\nprint(\"Fig 3: Boxplot, Rating by Bean Country Origin\")","8abd4e59":"jp = sns.jointplot(data=cacao,\n                   x='cacao_percent', \n                   y='rating', \n                   kind='reg',\n                   space=0, height=6, ratio=4)\nplt.xlabel('Cacao %')\nplt.ylabel('Rating')\nplt.title('High Cocoa % = High Ratings?', y=1.05)","910fc30f":"years = np.unique(cacao.review_date)\ncountries = companyL[:5].index.tolist()\nmean_rating_year_review = [ [0] * len(years) for i in range(len(countries))]\n\nj = 0\nfor country in countries:\n    all_rating_country = cacao[cacao['company_location'] == country]\n    i = 0\n    for year in years:\n        mean_rating_year_review[j][i] = all_rating_country[all_rating_country['review_date'] == year]['rating'].mean()\n        i +=1\n    j += 1\n    \nj = 0\nfor country in countries:\n    all_rating_country = cacao[cacao['company_location'] == country]\n    i = 0\n    for year in years:\n        mean_rating_year_review[j][i] = all_rating_country[all_rating_country['review_date'] == year]['rating'].mean()\n        i +=1\n    j += 1\n\ntraces = []\ncolors = ['rgb(0, 255, 255)', 'rgb(255, 0, 255)', 'rgb(0, 0, 0)',\n          'rgb(255, 0, 0)', 'rgb(0, 255, 0)']\nfor i in range(len(countries)):\n    traces.append(go.Scatter(\n        x=years,\n        y=mean_rating_year_review[i],\n        mode='lines',\n        name=countries[i],\n        line=dict(color=colors[i]),\n    ))\n\nlayout = go.Layout(\n    xaxis=dict(title='year'),\n    yaxis=dict(title='Average Rating'),\n    title='Average Rating on the Location Countries',)\n\nfig = go.Figure(data=traces, layout=layout)\npy.iplot(fig)","7d5a493b":"* U.S.A has raised its rating\n* Canada and France produce good chocolate bars.","37f69609":"* The best company is from Chile.<br>\n* The worst location of the companies: Mexico, India, South Africa.","6ccc4b05":"* The best bean grows in countries like Guatemala, Honduras, Congo and Vietnam.\n* North America, Europe, Russia and Australia have companies that produce chocolate bars, but in these countries cocoa beans are not produced\n* In India and Mexico, good cocoa beans grow, but they do not produce the best chocolate bars","ea5c94bc":"* Higher % of cocoa does not imply higher score.\n* Most chocolate bars have 70% cocoa. ","84b4314c":"## Top-10 Broad Bean Origin","68e34f2f":"Column names","3f88e81c":"### Chocolate Bar Ratings\nChocolate is one of the most popular candies in the world. Each year, residents of the United States collectively eat more than 2.8 billions pounds. However, not all chocolate bars are created equal! This dataset contains expert ratings of over 1,700 individual chocolate bars, along with information on their regional origin, percentage of cocoa, the variety of chocolate bean used and where the beans were grown.\n\nFlavors of Cacao Rating System:<br>\n5= Elite (Transcending beyond the ordinary limits)<br>\n4= Premium (Superior flavor development, character and style)<br>\n3= Satisfactory(3.0) to praiseworthy(3.75) (well made with special qualities)<br>\n2= Disappointing (Passable but contains at least one significant flaw)<br>\n1= Unpleasant (mostly unpalatable)\n\n### Data description\nCompany (Maker-if known) - Name of the company manufacturing the bar.<br>\nSpecific Bean Origin or Bar Name - The specific geo-region of origin for the bar.<br>\nReview Date - Date of publication of the review.<br>\nCocoa Percent - Cocoa percentage (darkness) of the chocolate bar being reviewed.<br>\nCompany Location - Manufacturer base country.<br>\nRating - Expert rating for the bar.<br>\nBean Type - The variety (breed) of bean used, if provided.<br>\nBroad Bean Origin - The broad geo-region of origin for the bean","753b27ba":"**Looking for nulls**<br>\n**Inspecting type**","24a8e9bb":"Brazil is the best rating of the main countries."}}