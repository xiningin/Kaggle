{"cell_type":{"1bc31516":"code","ec09577c":"code","f114653e":"code","c3fc5195":"code","80d775b0":"code","281e849e":"code","f2825918":"code","d2ee9230":"code","6bf2fb12":"code","dcdefff2":"code","0b676d54":"code","06d9eb2f":"code","e26d867b":"code","a9343cb3":"code","6e222562":"code","c3f23e11":"code","95813bbc":"code","71c8a36d":"code","239074eb":"code","4c379083":"code","2d9ad046":"code","d9696c9d":"code","1c5a5257":"code","e7bf1b6f":"code","4b432c7d":"code","1beef4cb":"code","368d6800":"code","43882614":"code","7b6cf8ff":"code","1fb0f863":"code","52a1efe7":"code","78499d3a":"code","6db0c1b9":"code","55cb3ea4":"code","b90e7a3e":"code","4e5f6511":"code","5773abbb":"code","b6cb8899":"code","8454dfdf":"code","ca9b08b3":"code","25dc8607":"code","19513656":"markdown","b92d4094":"markdown","040b8fb4":"markdown","db6761d6":"markdown","91026565":"markdown"},"source":{"1bc31516":"import warnings\nwarnings.filterwarnings('ignore')\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","ec09577c":"df=df=pd.read_csv(\"..\/input\/persona-data\/persona.csv\")","f114653e":"data=df.copy()","c3fc5195":"df.head()","80d775b0":"df.info()","281e849e":"df.columns","f2825918":"df.shape","d2ee9230":"df.dtypes","6bf2fb12":"df.isnull().sum().sum()","dcdefff2":"df.describe().T","0b676d54":"numeric_cols=list(df._get_numeric_data().columns)\nprint(numeric_cols)","06d9eb2f":"categoric_cols=list(set(df.columns)-set(numeric_cols))\nprint(categoric_cols)","e26d867b":"f, ax = plt.subplots(figsize= [20,15])\nsns.heatmap(df.corr(), annot=True, fmt=\".2f\", ax=ax, cmap = \"magma\" )\nax.set_title(\"Correlation Matrix\", fontsize=20)\nplt.show()","a9343cb3":"for col in categoric_cols:\n    print(f'###############{col}###############')\n    print(df[col].value_counts())","6e222562":"for col in categoric_cols:\n    \n    sns.countplot(x=df[col])\n    plt.show()","c3f23e11":"plt.figure(figsize=[16, 8])\nplt.pie(x=df['COUNTRY'].value_counts(), autopct=\"%.2f\", labels=df['COUNTRY'].value_counts().index)\nplt.title(\"Country distribution\", fontsize=14)","95813bbc":"for i in df._get_numeric_data().columns:\n    fig, axes = plt.subplots(nrows=1, ncols=3, figsize=(20, 4))\n    sns.histplot(df[i], bins=10, ax=axes[0])\n    axes[0].set_title(i)\n    \n    sns.boxplot(df[i], ax=axes[1])\n    axes[1].set_title(i)\n   \n    sns.kdeplot(df[i], ax=axes[2])\n    axes[2].set_title(i)\n    plt.show()","71c8a36d":"#How much was earned in total from sales by country?\nprint(df.groupby('COUNTRY').agg({'PRICE':'sum'}))","239074eb":"#What are the PRICE averages by country?\nprint(df.groupby('COUNTRY').agg({'PRICE':'mean'}))","4c379083":"#What are the PRICE averages by SOURCEs?\nprint(df.groupby('SOURCE').agg({'PRICE':'mean'}))","2d9ad046":"#What are the PRICE averages in the COUNTRY-SOURCE breakdown?\ndf.groupby([\"COUNTRY\",\"SOURCE\"]).agg({\"PRICE\":\"mean\"})","d9696c9d":"#What are the total gains broken down by COUNTRY, SOURCE, SEX, AGE?\ndf.groupby([\"COUNTRY\",\"SOURCE\",\"SEX\",\"AGE\"]).agg({\"PRICE\": \"mean\"})","1c5a5257":"#Sort the output by PRICE\nagg_df = df.groupby([\"COUNTRY\",\"SOURCE\",\"SEX\",\"AGE\"]).agg({\"PRICE\":\"mean\"}).sort_values(\"PRICE\", ascending=False)","e7bf1b6f":"agg_df.head()","4b432c7d":"agg_df.index","1beef4cb":"agg_df.reset_index(inplace=True)","368d6800":"agg_df.head()","43882614":"#Convert age variable to categorical variable and add it to agg_df\nagg_df[\"AGE_CAT\"] = pd.cut(agg_df[\"AGE\"], bins=[0, 18, 24, 30, 40, 70], labels=[\"0_18\", \"19_23\", \"24_30\", \"31_40\", \"41_70\"])","7b6cf8ff":"agg_df.head()","1fb0f863":"#Identify new level-based customers\nagg_df[\"customers_level_based\"]=[ \n    agg_df['COUNTRY'][i]+'_'+agg_df['SOURCE'][i]+'_'+agg_df['SEX'][i]+'_'+str(agg_df['AGE_CAT'][i])\n for i in agg_df.index]","52a1efe7":"agg_df.head()","78499d3a":"agg_df[\"customers_level_based\"].value_counts()","6db0c1b9":"agg_df.groupby([\"customers_level_based\"]).agg({'PRICE':'mean'})","55cb3ea4":"agg_df=agg_df.groupby([\"customers_level_based\"]).agg({'PRICE':'mean'}).reset_index()","b90e7a3e":"agg_df.head()","4e5f6511":"agg_df[\"SEGMENT\"] = pd.qcut(agg_df[\"PRICE\"], 4, labels=[\"D\",\"C\",\"B\",\"A\"])","5773abbb":"agg_df.head()","b6cb8899":"agg_df.groupby(\"SEGMENT\").agg({\"PRICE\" : [\"mean\", \"max\", \"sum\"]})","8454dfdf":"#For example, which segment does a 35 year old French woman using ios belong to?\nnew_user1 = \"FRA_IOS_FEMALE_31_40\"\nagg_df[agg_df[\"customers_level_based\"] == new_user1.lower()] #C segmenti","ca9b08b3":"#Which segment does a 26 year old American man using IOS belong to?\nnew_user2 = \"USA_IOS_MALE_24_30\"\nagg_df[agg_df[\"customers_level_based\"] == new_user2.lower()]","25dc8607":"new_user3 = \"TUR_ANDROID_FEMALE_31_40\"\nagg_df[agg_df[\"customers_level_based\"] == new_user3.lower()]","19513656":"# Prediction","b92d4094":"# Get the data","040b8fb4":"# Import libraries","db6761d6":"###### Classify new customers according to their segments and estimate how much income it can generate.","91026565":"# EDA"}}