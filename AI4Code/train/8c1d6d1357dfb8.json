{"cell_type":{"609a6d8d":"code","f2b49ae8":"code","7d341c98":"code","f44b0e7f":"code","ce15c960":"code","e423edac":"code","1c00052d":"code","3b415325":"code","10177c9a":"code","fed1762c":"code","680c7cea":"code","060b81ca":"code","2f085f9d":"code","0fe759fa":"code","a1ba91d4":"code","5d874598":"code","69d8d1d3":"code","5587cf40":"code","a9ebacee":"code","947c5d28":"code","ee889a8c":"markdown","d024d4fd":"markdown","1ee2533a":"markdown","7cbed776":"markdown","43fa3650":"markdown","32b3b34e":"markdown","08b16e7a":"markdown","ad69fae6":"markdown","0628253d":"markdown","a7fda78e":"markdown","36269ca7":"markdown","8f1743d0":"markdown","1ab2acd7":"markdown","e36984a4":"markdown"},"source":{"609a6d8d":"import numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\nimport datetime as dt\n\n# import required libraries for clustering\nfrom sklearn.preprocessing import StandardScaler\n\nfrom scipy.cluster.hierarchy import linkage\nfrom scipy.cluster.hierarchy import dendrogram\nfrom scipy.cluster.hierarchy import cut_tree","f2b49ae8":"df = pd.read_csv('\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","7d341c98":"# first five row\ndf.head()","f44b0e7f":"# size of datset\ndf.shape","ce15c960":"# change column name\ndf.rename(columns={'Annual Income (k$)': 'Annual_income', 'Spending Score (1-100)': 'Spending_score'}, inplace=True)","e423edac":"# statistical summary of numerical variables\ndf.describe()","1c00052d":"# summary about dataset\ndf.info()","3b415325":"# check for missing values\ndf.isna().sum() ","10177c9a":"plt.pie(df['Gender'].value_counts(), labels=df['Gender'].unique(), autopct='%1.1f%%')\nplt.show()","fed1762c":"cols = ['Age', 'Annual_income', 'Spending_score']\n\nfor col in cols:\n    plt.hist(df[col],bins=15)\n    plt.title('Histogram ' + col)\n    plt.xlabel(col)\n    plt.ylabel('Freq')\n    plt.show()","680c7cea":"sns.pairplot(df,kind='scatter',hue='Gender',palette=('#40a1e6','#e64040'))\nplt.show()","060b81ca":"cols = ['Age', 'Annual_income', 'Spending_score']\n\nfor col in cols:\n    sns.boxplot(data=df, x=col)\n    plt.title(col)\n    plt.show()","2f085f9d":"from sklearn.preprocessing import LabelEncoder\n\nle = LabelEncoder()\n\ndf['Gender'] = le.fit_transform(df['Gender'])","0fe759fa":"# copy data\nnew_df = df.copy()\n\n# drope customer id\nnew_df = new_df.drop('CustomerID', axis=1)\n\n# view data after scaling\nnew_df.head()","a1ba91d4":"# figure size\nplt.figure(figsize=(19,8))\n\n# Single linkage\nmergings = linkage(new_df, method=\"single\", metric='euclidean')\n\n# diagram\ndendrogram(mergings)\nplt.show()","5d874598":"# figure size\nplt.figure(figsize=(19,8))\n\n# Single linkage\nmergings = linkage(new_df, method=\"complete\", metric='euclidean')\n\n# diagram\ndendrogram(mergings)\nplt.show()","69d8d1d3":"# figure size\nplt.figure(figsize=(19,8))\n\n# Single linkage\nmergings = linkage(new_df, method=\"average\", metric='euclidean')\n\n# diagram\ndendrogram(mergings)\nplt.show()","5587cf40":"# 2 clusters\n\ncluster_labels = cut_tree(mergings, n_clusters=2).reshape(-1, )\ncluster_labels","a9ebacee":"# Assign cluster labels\n\nnew_df['Cluster_Labels'] = cluster_labels\nnew_df.head()","947c5d28":"# Plot Cluster Id vs Spending_score\nfor cols in new_df.columns[:-1].to_list():\n    sns.boxplot(y=cols, x='Cluster_Labels', data=new_df)\n    plt.show()","ee889a8c":"### Hierarchical Clustering\nHierarchical clustering involves creating clusters that have a predetermined ordering from top to bottom. For example, all files and folders on the hard disk are organized in a hierarchy. There are two types of hierarchical clustering,\n\n* Divisive\n* Agglomerative.\n\n### Single Linkage:\n\nIn single linkage hierarchical clustering, the distance between two clusters is defined as the shortest distance between two points in each cluster. For example, the distance between clusters \u201cr\u201d and \u201cs\u201d to the left is equal to the length of the arrow between their two **closest points.**\n![Clustering_single.png](attachment:Clustering_single.png)","d024d4fd":"## Cutting the Dendrogram based on K","1ee2533a":"# Import libraries","7cbed776":"# Load dataset","43fa3650":"# Feature Scaling","32b3b34e":"# Exploratory data analysis","08b16e7a":"# Explore categorical variables","ad69fae6":"# Please UPVOTE if you like this kernel","0628253d":"# What is Hierarchical clustering?\nHierarchical clustering, also known as hierarchical cluster analysis, is an algorithm that groups similar objects into groups called clusters. The endpoint is a set of clusters, where each cluster is distinct from each other cluster, and the objects within each cluster are broadly similar to each other.\n\nThe main output of Hierarchical Clustering is a dendrogram, which shows the hierarchical relationship between the clusters:","a7fda78e":"### Average Linkage\n\nIn average linkage hierarchical clustering, the distance between two clusters is defined as the average distance between each point in one cluster to every point in the other cluster. For example, the distance between clusters \u201cr\u201d and \u201cs\u201d to the left is equal to the average length each arrow between connecting the points of one cluster to the other.\n\n![Clustering_average.png](attachment:Clustering_average.png)","36269ca7":"### Complete Linkage\n\nIn complete linkage hierarchical clustering, the distance between two clusters is defined as the longest distance between two points in each cluster. For example, the distance between clusters \u201cr\u201d and \u201cs\u201d to the left is equal to the length of the arrow between their two **furthest points.**\n\n![Clustering_complete.png](attachment:Clustering_complete.png)","8f1743d0":"# Encoding ","1ab2acd7":"# Building the Model","e36984a4":"# Final Analysis\n## Hierarchical Clustering with 2 Cluster Labels\n\n* Customers with Cluster_Labels 0 average age is 35 with average annual salary is 55k and Cluster_Labels 1 average age is 45 with average annual salary is 80k.\n* Customers with Cluster_Labels 0 spend more when compare with Customers with Cluster_Labels 1\n* Customers with Cluster_Labels 0 annual income is less when compare with Customers with Cluster_Labels 1 but Customers with Cluster_Labels 0 spending score is much higher."}}