{"cell_type":{"bda00b98":"code","27d9e687":"code","df4b1cef":"code","c1b596d1":"code","bc9e316d":"code","19b4a26c":"code","9bba5b60":"code","55683747":"code","a057276f":"code","1c265731":"code","33e1d585":"code","e2a4ab05":"code","229b8cd2":"code","ef631771":"code","34294bc5":"code","01b1dad8":"code","5a6d805c":"code","db618f6f":"code","92ef6b5b":"code","055398ca":"code","08a94fd4":"code","da6d17d0":"code","575b1492":"code","20ec7cfc":"code","628b4dee":"code","c0922650":"code","d4ad91db":"code","e3fc5bc9":"code","7d97110d":"code","63aa1018":"code","d3eb789a":"code","a96f96aa":"code","d539a20f":"code","d1066b46":"code","07ee1726":"code","91ad3c85":"code","2c84a1a7":"code","295efc8a":"code","8c27107b":"code","89cc62e1":"code","3d0aa329":"code","a1303270":"code","d44b221f":"code","9539bf43":"code","743cbe3d":"code","0b9fb504":"code","88a9a37d":"code","e8973b13":"code","b156e17e":"code","01da7791":"code","11598812":"code","771ed002":"code","f7e01431":"code","fd2dd59e":"code","ae75bb60":"code","ac22070c":"code","173c414a":"code","05641623":"code","24f2d389":"markdown","e5b55248":"markdown","2c8e6020":"markdown","f9a815a9":"markdown","b400144f":"markdown","33369c05":"markdown","f414c84c":"markdown","e43d39f2":"markdown","9cfc9548":"markdown","188b4afe":"markdown","3b04b6aa":"markdown","9fbc2181":"markdown","fc4efa43":"markdown","3e595241":"markdown","6122cb55":"markdown","4362624b":"markdown","83029c8f":"markdown","3793a444":"markdown","cc7e7fc4":"markdown","1b011bc8":"markdown","a1983a1b":"markdown","5617c7b3":"markdown","f0968457":"markdown","213587df":"markdown","01dc59d4":"markdown","e9b5aab9":"markdown","00180fde":"markdown","b86e5838":"markdown","fa85bba9":"markdown","bc61a823":"markdown","ed37226f":"markdown","559670b3":"markdown","d82bbb47":"markdown","e2d471ae":"markdown","6f8a3690":"markdown","b6770dc9":"markdown","2b122f2c":"markdown"},"source":{"bda00b98":"%matplotlib inline","27d9e687":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","df4b1cef":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt \nfrom sklearn.preprocessing import MinMaxScaler,LabelEncoder\nfrom category_encoders import OneHotEncoder\nfrom sklearn.model_selection import train_test_split\nimport seaborn as sns\nimport warnings\nsns.set(style = 'darkgrid')\nwarnings.filterwarnings('ignore')","c1b596d1":"df = pd.read_csv('\/kaggle\/input\/adult-census-income\/adult.csv')","bc9e316d":"df.head()","19b4a26c":"df.info()","9bba5b60":"df.describe(include='all')","55683747":"workclass = df['workclass'].value_counts()\nsns.countplot(df['workclass'],palette='icefire_r')\nplt.xticks(rotation = 60)\nprint(workclass)","a057276f":"print(df['education'].value_counts())\nplt.xticks(rotation = 60)\nsns.countplot(df['education'])\nplt.show()","1c265731":"print(df['marital.status'].value_counts())\nsns.countplot(df['marital.status'])\nplt.xticks(rotation = 60)\nplt.show()","33e1d585":"print(df['occupation'].value_counts())\nsns.countplot(df['occupation'])\nplt.xticks(rotation = 90)\nplt.show()","e2a4ab05":"print(df['relationship'].value_counts())\nsns.countplot(df['relationship'])\nplt.show()","229b8cd2":"print(df['race'].value_counts())\nsns.countplot(df['race'])\nplt.show()","ef631771":"print(df['sex'].value_counts())\nsns.countplot(df['sex'])\nplt.show()","34294bc5":"print(df['income'].value_counts())\nsns.countplot(df['income'])\nplt.show()","01b1dad8":"print(df['native.country'].value_counts())\nsns.countplot(df['native.country'])\nplt.xticks(rotation = 90)\nplt.show()","5a6d805c":"attrib, counts = np.unique(df['workclass'], return_counts = True)\nmost_freq_attrib = attrib[np.argmax(counts, axis = 0)]\ndf['workclass'][df['workclass'] == '?'] = most_freq_attrib \n\nattrib, counts = np.unique(df['occupation'], return_counts = True)\nmost_freq_attrib = attrib[np.argmax(counts, axis = 0)]\ndf['occupation'][df['occupation'] == '?'] = most_freq_attrib ","db618f6f":"sns.distplot(df['hours.per.week'])\nplt.show()\nsns.violinplot(df['hours.per.week'],)\nplt.show()","92ef6b5b":"sns.distplot(df['age'])\nplt.show()\nsns.boxplot(df['age'])\nplt.show()","055398ca":"df['income'] = LabelEncoder().fit_transform(df['income'])","08a94fd4":"sns.distplot(df['income'],kde = False)\nplt.show()","da6d17d0":"sns.distplot(df['fnlwgt'])\nplt.xticks(rotation = 90)\nplt.show()\nsns.boxplot(df['fnlwgt'])\nplt.xticks(rotation = 90)\nplt.show()","575b1492":"sns.distplot(df['education.num'])\nplt.show()\nsns.boxplot(df['education.num'])\nplt.show()","20ec7cfc":"sns.distplot(df['capital.gain'],kde = False)\nplt.show()\nsns.boxplot(df['capital.gain'])\nplt.show()","628b4dee":"sns.distplot(df['capital.loss'],kde = False)\nplt.show()\nsns.boxplot(df['capital.loss'])\nplt.show()","c0922650":"sns.relplot('capital.gain','capital.loss',data = df,hue = 'income')\nplt.show()","d4ad91db":"sns.catplot('income','capital.gain',data =df,kind = 'violin')\nplt.show()","e3fc5bc9":"sns.catplot('income','capital.loss',data =df,kind = 'violin')\nplt.show()","7d97110d":"sns.catplot(y = 'fnlwgt',x = 'income',data = df,kind = 'violin')\nplt.show()","63aa1018":"sns.catplot(y = 'hours.per.week',x = 'income',data = df,hue = 'income',kind = 'violin')\nplt.show()","d3eb789a":"sns.catplot(y = 'age',x= 'income',data = df,hue = 'income',kind = 'violin')\nplt.show()","a96f96aa":"plt.figure(figsize=(10,10))\nsns.heatmap(df.corr(),annot = True,cmap = 'vlag',linewidths=0.25)\nplt.show()","d539a20f":"df.head(20)","d1066b46":"df.drop(['native.country'],axis = 1,inplace = True)\ndf.head()","07ee1726":"sns.countplot('workclass',data = df,hue = 'income' )\nplt.xticks(rotation = 60)\nplt.show()\n(df['workclass'].groupby(by = df['income']).value_counts())","91ad3c85":"sns.countplot('education',data = df,hue = 'income')\nplt.xticks(rotation = 60)\nplt.show()\n(df['education'].groupby(by = df['income']).value_counts())","2c84a1a7":"sns.countplot('education.num',data = df,hue = 'income')\nplt.show()\ndf['education.num'].groupby(by = df['income']).value_counts()","295efc8a":"sns.countplot('marital.status',data = df,hue = 'income')\nplt.xticks(rotation = 60)\nplt.show()\ndf['marital.status'].groupby(by = df['income']).value_counts()","8c27107b":"sns.countplot('occupation',data = df,hue = 'income')\nplt.xticks(rotation = 60)\nplt.show()\ndf['occupation'].groupby(by= df['income']).value_counts()","89cc62e1":"sns.countplot('relationship',data = df,hue = 'income')\nplt.xticks(rotation = 60)\nplt.show()\ndf['relationship'].groupby(by= df['income']).value_counts()","3d0aa329":"sns.countplot('sex',data = df,hue = 'income')\nplt.xticks(rotation = 60)\nplt.show()\ndf['sex'].groupby(by= df['income']).value_counts()","a1303270":"sns.countplot('race',data = df,hue = 'income')\nplt.show()\ndf['race'].groupby(by = df['income']).value_counts()","d44b221f":"df.drop('education',axis = 1,inplace = True) ##It's already Ordered encoded in the column 'eduction-num'","9539bf43":"df.workclass = df.workclass.map((df.workclass.value_counts()\/len(df.workclass)).to_dict())*100","743cbe3d":"df.rename(columns={'marital.status' : 'marital_status'},inplace = True)","0b9fb504":"df.marital_status = df.marital_status.map((df['marital_status'].value_counts()\/len(df['marital_status'])).to_dict())*100\ndf.occupation = df.occupation.map((df.occupation.value_counts()\/len(df.occupation)).to_dict())*100\ndf.relationship = df.relationship.map((df.relationship.value_counts()\/len(df.relationship)).to_dict())*100\ndf.race = df.race.map((df.race.value_counts()\/len(df.race)).to_dict())*100\n\ndf.head()","88a9a37d":"df = pd.get_dummies(df)","e8973b13":"df.head()","b156e17e":"df['capital-change'] = df['capital.gain'] - df['capital.loss']\ndf.drop(['capital.gain','capital.loss'],axis = 1,inplace = True)","01da7791":"y = df.income\ndf.drop('income',axis = 1,inplace = bool(1))","11598812":"xtrain,xtest,ytrain,ytest = train_test_split(df,y,random_state = 42)","771ed002":"xtrain.shape,xtest.shape,ytrain.shape,ytest.shape","f7e01431":"from sklearn.ensemble import GradientBoostingClassifier\ngbclf = GradientBoostingClassifier(random_state=42,n_estimators=300,max_depth=5,learning_rate=0.01)","fd2dd59e":"gbclf.fit(xtrain,ytrain)","ae75bb60":"train_predict = gbclf.predict(xtrain)","ac22070c":"from sklearn.metrics import classification_report,accuracy_score,roc_auc_score\nprint(classification_report(ytrain,train_predict),accuracy_score(ytrain,train_predict),roc_auc_score(ytrain,train_predict))","173c414a":"test_predict = gbclf.predict(xtest)\nprint(classification_report(ytest,test_predict),accuracy_score(ytest,test_predict),roc_auc_score(ytest,test_predict))","05641623":"(dict(sorted(zip(df.columns,gbclf.feature_importances_))))","24f2d389":"# Feature Preprocessing","e5b55248":"**Encoding workclass,race,relationship,marital.status,occupation features by replacing labels with percentage of frequency they occured**","2c8e6020":"1. Almost 3\/4 people live with their family","f9a815a9":"1. More than 75% of the people have income less than 50K\n2. The target variable is imbalance","b400144f":"1. Almost 70% people work in private firms\n2. No. of missing values is around 5%\n3. There are very few people not working or not getting paid","33369c05":"1. Looking at this plot,still i can't see any relation between 'fnlwgt' and income category,I will deal with this later","f414c84c":"1. Attribute 'race' has almost all instances as 'white'.So, this feature will be of no use \n   in predicting income hence we will drop it.","e43d39f2":"**Now let's take a look at numerical features**","9cfc9548":"### Loading Censous Data","188b4afe":"**Now with caegorical attributes**","3b04b6aa":"1. This attribute highly left sided skewed\n2. There are also some large outliers in this attribute","9fbc2181":"# Splitting ths data and training the Model","fc4efa43":"1. There are many occupations that people have and for every occupation there are many people in that occupation\n2. There are also 2809 missing values\n3. there are only 15 people working in armed forces. ","3e595241":"**Converting the target variable into numeric datatype**","6122cb55":"1. Most people work 35 to 50 hours per week\n2. Very less people work either 90+ or 0 hours per week","4362624b":"# EDA","83029c8f":"1. 'Educational-num' feature is just the Ordered LabelEncoded form of 'Education' feature \n2. I will drop 'education' column for the model training.","3793a444":"### Multivariate Analysis\n  **Let's try to interpret the relation between target varibale and numeric independent variables**","cc7e7fc4":"1. Most people are either married(46%) or never married(33%) or divorced(13%).","1b011bc8":"1. I do not understand what is this attribute for\n2. Median value for this attribute is around 170000\n3. There are very large outlires in the attribute","a1983a1b":"1. It can be seen that as age increases income increases as well.\n2. Most people less than 30 years of age have income <50k.","5617c7b3":"## Univariate Analysis\n    Let's first take a look at Categorical features","f0968457":"### About the data\n    1. There are 48842 instances and 15 features.\n    2. 9 out of 15 of our features are categorical.","213587df":"##### Important: There are Missing vlaues in 'Workclaas' and 'Occupation\" columns identified by '?'","01dc59d4":"1. The median age of people is around 37 years\n2. There are also some people with age 80+ years","e9b5aab9":"##### Filling the missing values of occupation and workclass fature by most frequent category","00180fde":"1. Most of the people are either High Scholl gradute or went to some college or have Bachelor degree","b86e5838":"###### Dropping unnecessery Ctegorical features","fa85bba9":"# Importing Packages","bc61a823":"1. People with higher eductional degree are more likely to fall into >50k income category.","ed37226f":"1. It can be seen that most people work for more than 35+ hours per week\n2. People with income >=50k work more hours per week than people with income<50k\n3. It can be seen that number of people working less than 35 hours per week is more in <50k income category.","559670b3":"1. Those who have zero capital-loss have high chance having income >=50k\n2. Those Who have less capital-gain have high chance of having income <50k\n3. Perhaps we can drop these two attributes and use new feature 'capital-change' = 'capital-gain'-capital-loss'\n   by doing this it will be also somewhat easy dealing with the outliers of these attributes","d82bbb47":"1. The data is very skewed since almost 90% of the people have native-country as United States\n2. It will be better to drop this feature too.","e2d471ae":"1. People working in private companies have high probability of having income <50k\n3. Generally every workclass have more no. of people in income <50k category","6f8a3690":"**'Educational-Num' is also a categorical attribute**\n1. I think it is somehow related with the 'Education' column\n2. I will deal with this later while doing multivariate analysis","b6770dc9":"1. There are almost 67% men and 33% women in the data.","2b122f2c":"1. This attribute also has same trend as capital loss.\n2. It has many outliers also but not that large as of 'capital-gain'"}}