{"cell_type":{"2222cd8a":"code","c8cf047c":"code","5f47ab52":"code","a28bf923":"code","11754554":"code","720663a1":"code","3e633b58":"code","618faef8":"code","7b27f219":"code","711ed63e":"code","aa84e08b":"code","8feed7c7":"code","92f665e1":"code","0ff1dc5d":"code","aafe77f0":"code","9798952a":"code","7318c4c6":"code","cf4318f9":"code","7d5e3bc6":"code","b183ed53":"code","0b624477":"code","3c46ef71":"code","6b66466a":"code","d0b315b1":"code","5e5cf5ea":"code","c386c263":"code","0eea965f":"code","48f9602b":"code","31f68439":"code","80250bcd":"code","3269e06d":"code","0465dea5":"code","5de1ca89":"code","ebb4d5f3":"code","9b3d09d2":"code","1a019b00":"code","b8274c8b":"code","e7f7f93a":"code","8497c0ca":"markdown","b0526cc2":"markdown","67ba77b1":"markdown","f5a73ada":"markdown","d31d7da8":"markdown","e5078571":"markdown","63354797":"markdown","59f9959c":"markdown","0aa6d37b":"markdown","db35c38d":"markdown","41f5b900":"markdown","98e281a4":"markdown","3d25b821":"markdown","099e16fa":"markdown","d7bca0a2":"markdown","b94b0342":"markdown","67a870f4":"markdown","c3d004ac":"markdown","ba1706ce":"markdown","e4f8558a":"markdown","5c25149d":"markdown","c99c135d":"markdown","15e97382":"markdown","893c97af":"markdown","f88001b1":"markdown","0eb04c20":"markdown","522db0b2":"markdown","4c0c4cbb":"markdown","175379e7":"markdown","e030252f":"markdown","e2c2f914":"markdown","f34a5ae7":"markdown","c40667ce":"markdown","6a46c1c8":"markdown","7aca611a":"markdown","0aa367b9":"markdown","c1f7c0b1":"markdown","ee7981b6":"markdown","f97a3587":"markdown"},"source":{"2222cd8a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nplt.style.use(\"seaborn-whitegrid\")\nimport seaborn as sns\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","c8cf047c":"data=pd.read_csv(\"\/kaggle\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv\")","5f47ab52":"data.info()","a28bf923":"data.isnull().any()","11754554":"data.columns","720663a1":"data.head()","3e633b58":"data.tail()","618faef8":"data[\"quality\"].unique()","7b27f219":"data.corr()","711ed63e":"f,ax=plt.subplots(figsize=(10,10))\nsns.heatmap(data.corr(), annot=True, linewidth=.5)\nplt.show()","aa84e08b":"x_data=data.drop([\"quality\"],axis=1)\nx=(x_data-np.min(x_data))\/(np.max(x_data)- np.min(x_data)).values\nx.head()","8feed7c7":"sns.barplot(y=x['fixed acidity'], x=data['quality'], data=data)\nplt.show()","92f665e1":"sns.barplot(y=x['volatile acidity'], x=data['quality'], data=data)\nplt.show()","0ff1dc5d":"sns.barplot(y=x['citric acid'], x=data['quality'], data=data)\nplt.show()","aafe77f0":"sns.barplot(y=x['residual sugar'], x=data['quality'], data=data)\nplt.show()","9798952a":"sns.barplot(y=x['chlorides'], x=data['quality'], data=data)\nplt.show()","7318c4c6":"sns.barplot(y=x['free sulfur dioxide'], x=data['quality'], data=data)\nplt.show()","cf4318f9":"sns.barplot(y=x['total sulfur dioxide'], x=data['quality'], data=data)\nplt.show()","7d5e3bc6":"sns.barplot(y=x['density'], x=data['quality'], data=data)\nplt.show()","b183ed53":"sns.barplot(y=x['pH'], x=data['quality'], data=data)\nplt.show()","0b624477":"sns.barplot(y=x['sulphates'], x=data['quality'], data=data)\nplt.show()","3c46ef71":"sns.barplot(y=x['alcohol'], x=data['quality'], data=data)\nplt.show()","6b66466a":"data[\"quality\"]","d0b315b1":"data[\"quality\"].unique()","5e5cf5ea":"sns.countplot(data[\"quality\"], data=data)\nplt.show()","c386c263":"data.head()","0eea965f":"data[\"quality\"]=[0 if i <6 else 1 for i in data[\"quality\"]]\ndata.head()","48f9602b":"data[\"quality\"].unique()","31f68439":"x.drop(labels=[\"residual sugar\",\"density\",\"pH\",\"fixed acidity\"], axis=1 , inplace=True)\nx.head()","80250bcd":"x=x.rename(columns={'citric acid':'citric_acid','free sulfur dioxide':'free_sulfur_dioxide','total sulfur dioxide':'total_sulfur_dioxide'})\nx.columns","3269e06d":"y=data[\"quality\"]\ny.head()","0465dea5":"from sklearn.model_selection import train_test_split, StratifiedKFold, GridSearchCV\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import RandomForestClassifier, VotingClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import accuracy_score","5de1ca89":"x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.3, random_state=42)\n\nprint(\"x_train\",len(x_train))\nprint(\"x_test\",len(x_test))\nprint(\"y_train\",len(y_train))\nprint(\"y_test\",len(y_test))","ebb4d5f3":"logreg= LogisticRegression()\nlogreg.fit(x_train,y_train)\nacc_train=round(logreg.score(x_train,y_train)*100,2)\nacc_test=round(logreg.score(x_test,y_test)*100,2)\nprint(\"Training Accuracy:%{}\".format(acc_train))\nprint(\"Test Accuracy:{}\".format(acc_test))\n","9b3d09d2":"random_state=42\nclassifier=[DecisionTreeClassifier(random_state=random_state), SVC(random_state=random_state), RandomForestClassifier(random_state=random_state),LogisticRegression(random_state=random_state),KNeighborsClassifier()]\n\ndt_param_grid={\"min_samples_split\":range(10,500,20),\"max_depth\":range(1,20,2)}\n                                                                   \nsvc_param_grid={\"kernel\":[\"rbf\"],\"gamma\":[0.001,0.01,0.1,1],\"C\":[1,10,50,100,200,300,1000]}                                                                   \n                                   \nrf_param_grid={\"max_features\":[2,3],\"min_samples_split\":[8,10,12],\"min_samples_leaf\":[3,4,5],\"bootstrap\":[False],\"n_estimators\":[100,200,500]}  \n                                                              \nlogreg_param_grid={\"C\":np.logspace(-3,3,7),\"penalty\":[\"l1\",\"l2\"]}                                                                  \n                                           \nknn_param_grid={\"n_neighbors\":np.linspace(1,19,10, dtype=int).tolist(),\"weights\":[\"uniform\",\"distance\"],\"metric\":[\"euclidean\",\"manhattan\"]}                                                                   \n                                                                   \nclassifier_param=[dt_param_grid,svc_param_grid,rf_param_grid,logreg_param_grid,knn_param_grid]    ","1a019b00":"cv_result=[]\nbest_estimators=[]\n\nfor i in range(len(classifier)):\n    \n    clf=GridSearchCV(classifier[i],param_grid=classifier_param[i],cv=StratifiedKFold(n_splits=10),scoring=\"accuracy\",n_jobs=-1,verbose=1)\n    clf.fit(x_train,y_train)\n    cv_result.append(clf.best_score_)\n    best_estimators.append(clf.best_estimator_)\n    print(cv_result[i])","b8274c8b":"cv_results= pd.DataFrame({\"Cross Validation Means\":cv_result,\"ML Models\":[\"DecisionTreeClassifier\", \"SVC\", \"RandomForestClassifier\",\"LogisticRegression\",\"KNeighborsClassifier\"]})\n\ng=sns.barplot(\"Cross Validation Means\",\"ML Models\", data=cv_results)\ng.set_xlabel(\"Mean Accuracy\")\ng.set_title(\"Cross Validtion Scores\")","e7f7f93a":"cv_result[2]","8497c0ca":"<a id=\"1\"><\/a>\n<font color='purple'>\n## Load and Check Data","b0526cc2":"<a id=\"4\"><\/a>\n<font color='green'>\nFixed Acidity    ","67ba77b1":"<a id=\"6\"><\/a>\n<font color='green'>\nCitric Acid","f5a73ada":"<a id=\"9\"><\/a>\n<font color='green'>\nFree Sulfur Dioxide","d31d7da8":"This plot almost have linear decrease with quality.So we can use that feature.","e5078571":"<font color = 'purple'>\n    \n# Introduction\n<font color = 'black'>\n\nIn this notebook we are gonna try to determine which  physiochemical properties make a good quality wine.\n\n\n<font color = 'purple'>\n\nContent:\n1. [Load and Check Data](#1)\n2. [Variable Description](#2)\n3. [Variable Visualization](#3)\n   * [Fixed acidity](#4)\n   * [Volatile acidity](#5)\n   * [Citric acid](#6)\n   * [Residual sugar](#7)      \n   * [Chlorides](#8)   \n   * [Free sulfur dioxide](#9)   \n   * [Total sulfur dioxide](#10) \n   * [Density](#11)\n   * [PH](#12)       \n   * [Sulphates](#13)             \n   * [Alcohol](#14)           \n   * [Quality](#15)\n1. [Preparing Data](#16)\n1. [Modelling](#17)\n    * [Train-Test Split](#18)\n    * [Simple Logistic Regression Model](#19)\n    * [Hyperparameter Tuning-Grid Search-Cross Validation](#20)\n","63354797":"<a id=\"15\"><\/a>\n<font color='green'>\nQuality","59f9959c":"There is so little connection with this feature. We can drop it.","0aa6d37b":"<a id=\"17\"><\/a>\n<font color='purple'>\n## Modelling","db35c38d":"<a id=\"20\"><\/a>\n<font color='green'>\n### Hyperparameter Tuning-Grid Search-Cross Validation\n    ","41f5b900":"As we can see at barplot Random Forest Classifier is giving us the best score","98e281a4":"<a id=\"8\"><\/a>\n<font color='green'>\nChlorides","3d25b821":"<a id=\"16\"><\/a>\n<font color='purple'>\n## Preparing Data","099e16fa":"Like as we determine at the heatmap, there is not much connection with quality here so we can drop this feature.","d7bca0a2":"<a id=\"2\"><\/a>\n<font color='purple'>\n## Variable Description","b94b0342":"There is some irregular connection.","67a870f4":"<a id=\"18\"><\/a>\n<font color='green'>\n### Train-Test Split","c3d004ac":"We are gonna import libraries.","ba1706ce":"When we check heatmap we were not sure for this feature. But after checking this barplot i decided not to drop this feature.","e4f8558a":"<a id=\"10\"><\/a>\n<font color='green'>\nTotal Sulfur Dioxide","5c25149d":"We are gonna check the correlation between features with heatmap.Then we are gonna decide which features are effecting quality more or less with this plot.","c99c135d":"There is almost has a linear increase with quality at this plot.","15e97382":"<a id=\"7\"><\/a>\n<font color='green'>\nResidual Sugar","893c97af":"<a id=\"11\"><\/a>\n<font color='green'>\nDensity","f88001b1":"<a id=\"5\"><\/a>\n<font color='green'>\nVolatile Acidity","0eb04c20":"I am looking for best parameters and i will use grid search for this.","522db0b2":"We are done with visualization of variables. After examinate all plots , i decided to drop ,\"fixed acidity\",residual sugar\", \"density\" and \"ph\" features.","4c0c4cbb":"<a id=\"14\"><\/a>\n<font color='green'>\nAlcohol","175379e7":"I am gonna try to improve accuracy rate with hyperparameter tuning.","e030252f":"1. fixed acidity:most acids involved with wine or fixed or nonvolatile (do not evaporate readily)\n1. volatile acidity:the amount of acetic acid in wine, which at too high of levels can lead to an unpleasant, vinegar taste\n1. citric acid:found in small quantities, citric acid can add 'freshness' and flavor to wines\n1. residual sugar:the amount of sugar remaining after fermentation stops, it's rare to find wines with less than 1 gram\/liter and wines with greater than 45 grams\/liter are considered sweet\n1. chlorides:the amount of salt in the wine\n1. free sulfur dioxide:the free form of SO2 exists in equilibrium between molecular SO2 (as a dissolved gas) and bisulfite ion; it prevents microbial growth and the oxidation of wine\n1. total sulfur dioxide:amount of free and bound forms of S02; in low concentrations, SO2 is mostly undetectable in wine, but at free SO2 concentrations over 50 ppm, SO2 becomes evident in the nose and taste of wine\n1. density:the density of water is close to that of water depending on the percent alcohol and sugar content\n1. pH:describes how acidic or basic a wine is on a scale from 0 (very acidic) to 14 (very basic); most wines are between 3-4 on the pH scale\n1. sulphates:a wine additive which can contribute to sulfur dioxide gas (S02) levels, wich acts as an antimicrobial and antioxidant\n1. alcohol","e2c2f914":"<a id=\"19\"><\/a>\n<font color='green'>\n### Simple Logistic Regression Model","f34a5ae7":"We can easily see the there is some trend here.","c40667ce":"I am gonna seperate quality feature to 0 and 1. If i seperate it <7 bad and >=7 good that will create us an imbalanced data. Even though if our modelling is not correct and it give us 0 all the time , our accuracy will be high anyway because of this imbalance. So i am gonna use, if quality<6 it has a bad quality and if it is >=6 it has a good quality.","6a46c1c8":"<a id=\"12\"><\/a>\n<font color='green'>\nPh","7aca611a":"We got %80 accuracy. This is the first machine learning that i have done all by myself. You can leave comments or suggestions for help me to improve. Thank you :)","0aa367b9":"It looks like residual sugar, ph and free sulfur dioxide has less correlation with quality than other features. I am gonna take a look at the barplots too so i can make sure which features i will drop and then i can start modelling. For that first, i am gonna normalize our features so we can have healthier results.\n","c1f7c0b1":"This barplot confirms the heatmap. There is not much connection. We are gonna drop ph feature.","ee7981b6":"<a id=\"3\"><\/a>\n<font color='purple'>\n## Variable  Visualization ","f97a3587":"<a id=\"13\"><\/a>\n<font color='green'>\nSulphates"}}