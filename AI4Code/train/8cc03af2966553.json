{"cell_type":{"7267f036":"code","1a05c284":"code","0ed33e99":"code","e6b4c8fc":"code","ca458cfc":"code","843c8c2b":"code","909c5f26":"code","d3ed0624":"code","405ad9f1":"code","22520c08":"code","46ac5817":"code","505cb37d":"code","31a55fa4":"code","4e5032c3":"code","c1eb0227":"code","6c348215":"code","432ca6e1":"code","b1d7160f":"code","fea3fc35":"code","9fc3a492":"code","dd613e1d":"code","469bcba4":"code","52603b63":"code","0758f554":"code","d3557090":"markdown","7771b153":"markdown","563204fb":"markdown","8b7cbe25":"markdown","d6887129":"markdown","d962cafc":"markdown","38d98529":"markdown","3c9ad6fe":"markdown","be61b44f":"markdown","9eb523d1":"markdown","58261b5d":"markdown","291ab0d4":"markdown","32af94dd":"markdown","77ec3c6a":"markdown","4792b37d":"markdown","4aba8974":"markdown","12f7041e":"markdown","2cd7d10e":"markdown","0acd260a":"markdown","d4438772":"markdown","dfc851ff":"markdown","7e800cf3":"markdown","215ce7b6":"markdown","1d0b2dfa":"markdown","c224e0ad":"markdown","790890be":"markdown","425d71b3":"markdown","7db92b9b":"markdown","14c0f70b":"markdown","d8c1b224":"markdown","888658c9":"markdown","2d9d5678":"markdown","d5b96fe6":"markdown"},"source":{"7267f036":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nc1 = '#b90d3c'\nc2 = '#041d40'","1a05c284":"example_sample_submission_df = pd.read_csv('..\/input\/mlb-player-digital-engagement-forecasting\/example_sample_submission.csv', parse_dates=['date'])\nprint(f'\\nShape of Example Sample Submission CSV: {example_sample_submission_df.shape}\\n\\n')\nexample_sample_submission_df.head()","0ed33e99":"example_test_df = pd.read_csv('..\/input\/mlb-player-digital-engagement-forecasting\/example_test.csv')\nprint(f'\\nShape of Example Test CSV: {example_test_df.shape}\\n\\n')\nexample_test_df","e6b4c8fc":"# Read in CSV\nawards_df = pd.read_csv('..\/input\/mlb-player-digital-engagement-forecasting\/awards.csv', parse_dates=['awardDate'])\nprint(f'\\nShape of Awards Dataset: {awards_df.shape}\\n\\n')\nawards_df.head()","ca458cfc":"# 20 Most frequently given awards\nawards_df.awardName.value_counts().head(20)","843c8c2b":"# Number of Awards \/ year\naward_yr_df = awards_df.awardSeason.value_counts().sort_index().reset_index()\n\n# Bar plot\nplt.figure(figsize=(8,5))\nsns.barplot(x=award_yr_df['index'], y=award_yr_df.awardSeason, color='red', alpha=0.7)\nsns.despine(bottom=True, left=True)\nplt.xticks(rotation=45)\nplt.xlabel('Years', fontsize=13)\nplt.ylabel('Award Count', fontsize=13)\nplt.title('Yearly Count of Awards', fontsize=15)\nplt.show()","909c5f26":"# Top 10 players with most awards\nawards_df.groupby(['playerName']).count()['awardPlayerTeamId'].sort_values(ascending=False).head(10)","d3ed0624":"# Read in CSV\nplayers_df = pd.read_csv('..\/input\/mlb-player-digital-engagement-forecasting\/players.csv')\nprint(f'\\nShape of Dataset: {players_df.shape}\\n\\n')\nplayers_df.head()","405ad9f1":"seasons_df = pd.read_csv('..\/input\/mlb-player-digital-engagement-forecasting\/seasons.csv')\nprint(f'\\nShape of Dataset: {seasons_df.shape}\\n\\n')\nseasons_df.head()","22520c08":"teams_df = pd.read_csv('..\/input\/mlb-player-digital-engagement-forecasting\/teams.csv')\nprint(f'\\nShape of Dataset: {teams_df.shape}\\n\\n')\nteams_df.head()","46ac5817":"# Read in CSV\ntrain_df = pd.read_csv('..\/input\/mlb-player-digital-engagement-forecasting\/train.csv', parse_dates=['date'])\nprint(f'\\nShape of Dataset: {train_df.shape}\\n\\n')\ntrain_df.head()","505cb37d":"# Function to show a single json query\ndef show_single_json(json):\n    return np.NaN if pd.isna(json) else pd.read_json(json)","31a55fa4":"# Game Information\/Stats on 2021-04-30\nprint('Game Information\/Stats Status on 2021-04-30')\nprint('\\n')\n\nshow_single_json(train_df['games'].iloc[1215])","4e5032c3":"# Squad Status on 2021-04-30\nprint('Squad Status on 2021-04-30')\nprint('\\n')\n\nshow_single_json(train_df['rosters'].iloc[1215])","c1eb0227":"# Roster Status Frequency for the day 2021-04-30\nprint(show_single_json(train_df['rosters'].iloc[1215]).status.value_counts())","6c348215":"# Visualizing Roster Status Frequency for the day 2021-04-30\nplt.figure(figsize=(8,5))\nsns.barplot(y=show_single_json(train_df['rosters'].iloc[1215]).status.value_counts().index, \n            x=show_single_json(train_df['rosters'].iloc[1215]).status.value_counts().values,\n            color='red', alpha=0.70)\nsns.despine(bottom=True, left=True)\nplt.xlabel('Player Count', fontsize=13)\nplt.ylabel('Player Status', fontsize=13)\nplt.title('Roster Count on 2021-04-30', fontsize=15)\nplt.show()","432ca6e1":"# Player Box Scores on 2021-04-30\nprint('Player Box Scores on 2021-04-30')\nprint('\\n')\n\nshow_single_json(train_df['playerBoxScores'].iloc[1215]).head()","b1d7160f":"# Transactions on 2021-04-30\nprint('Tracnsactions on 2021-04-30')\nprint('\\n')\n\nshow_single_json(train_df['transactions'].iloc[1214]).head(10)","fea3fc35":"# Type of Transaction on 2021-04-29\nshow_single_json(train_df['transactions'].iloc[1214]).typeDesc.value_counts()","9fc3a492":"# Standings on 2021-04-29\nprint('Standings on 2021-04-29')\nprint('\\n')\n\nshow_single_json(train_df['standings'].iloc[1214])","dd613e1d":"# Awards handed out on 2021-04-30\nprint('Awards handed out on 2021-04-29')\nprint('\\n')\n\nshow_single_json(train_df['awards'].iloc[1215])","469bcba4":"# A single cell containing Twitter Followers details of multiple \"players\" on a particular date\nshow_single_json(train_df['playerTwitterFollowers'].iloc[0])","52603b63":"# A single cell containing Twitter Followers details of all \"teams\" on a particular date\nshow_single_json(train_df['teamTwitterFollowers'].iloc[0])","0758f554":"# Next Day (2021-05-01) Target Variables as of 2021-04-30\nshow_single_json(train_df['nextDayPlayerEngagement'].iloc[1215]).head()","d3557090":"### iii. **awards.csv**","7771b153":"# <center><font color='#041e42'>This Notebook is Work in Progress...<\/font> <font color='#bf0d3e'>It will be updated on daily basis...<\/font><\/center>","563204fb":"### \ud83d\udc49 A Small Description\n* Identify the many other factors which pique supporter engagement and create deeper relationships betweens players and fans.\n* Baseball fans watch, read, and search for information about players. Which individuals they seek can depend on player performance, team standings, popularity, among other, currently unknown factors.\n* Predict how fans engage with MLB players\u2019 digital content on a daily basis for a future date range. ","8b7cbe25":"> ### \ud83d\udccc Observations from Example Test data\n> * All the columns contains either JSON data or np.Nan values.\n> * `date_playerId` , which is required in the submission file, is missing from example_test.\n> * Here, each row represents a single day. But, submissions the are to be made for multiple players on each day.\n> * So we know that, using the first row data of 2021-04-26, we are making predictions 2021-04-27 for multiple players.(like 20210427_player1, 20210427_player2, and so on)","d6887129":"#### \ud83d\udd39 **Target Variables**: A single cell from the 'nextDayPlayerEngagement' column\n* This is what we have to predict. Next Day Target Variables representing players engagements based on Current day data.","d962cafc":"> #### \ud83d\udccc  Observations from **awards.csv**\n> * Contains information about the awards given out on a particular date in the training dataset. As we have already seen, the seperate CSV file named awards.csv contains all the information about awards given out prior to 2018 season. \n> \n> * On one hand, the awards given out before 2018 can help us understand how big a player is, their influence, and how people engage with them on long term basis. Whereas, the daily award information will help us understand how the fans engage with the playes digital content on a daily - much shorter - basis. ","38d98529":"# <font color='#093e88'>2. Sneak Peak at Datasets<\/font>\nThe datasets in this competetion contains vast amount of information. First off, the data contains a set of static files that do not change with time (players.csv, teams.csv, seasons.csv, awards.csv) as well as daily data (train.csv) which is grouped by day. Secondly, each cell in the daily data (train.csv) is a JSON dictionary, the size of each JSON itself can be equivalent to an entire dataset. \n\nThat is why before we move on to analysis and modeling, we will first understand and make sense of data.","3c9ad6fe":"> ### \ud83d\udccc Observation from train.csv\n> * All the columns contains either JSON data or np.Nan values.\n> * `date_playerId`, which is required in the submission file, is not an attribute here.\n> * Here, each row represents a single day. But, submissions the are to be made for multiple players on each day.\n> * So we know that, using the first row data of 2018-01-01, we will make predictions 2018-01-02 for multiple players.(like 20180101_player1, 20180101_player2, and so on)","be61b44f":"### ii. **example_test.csv**","9eb523d1":"# <font color='#093e88'>1. Introduction<\/font>","58261b5d":"> #### \ud83d\udccc Observations from **rosters JSON**\n> * Contains the squad status for all the matches played on a particular date. \n> * Normally, the active player should have more engagement compared to the injured players. In rare cases, the opposite is also very possible where injured players get more engagements. This could may very well be dependent upon player's injury, stardom, or some other intrinsic attribute such as club rivalries, and so on.\n> * Again we will analyse it lateron based on the data.","291ab0d4":"### \ud83d\udc49 Test Sets for Evaluation:\nThere are 2 test sets for evaluation:\n1. During Training phase:  \nThis unseen test (provided by time series module 'mlb') set is comprised of data for the **month of May 2021** and the set of active players this year.\n\n2. During Evaluation phase:\nThis test set will be a **future** in-season range of approximately **one month**.\n","32af94dd":"### \ud83d\udc49 Evaluation Matrix\n* Submissions are evaluated on the mean column-wise mean absolute error (MCMAE). A mean absolute error is calculated for each of the four target variables and the score is the average of those four MAE values.\n* For each \"date_playerId\" you need to predict all four target variables.\n\n|date_playerId|target1|target2|target3|target4|\n|--|--|--|--|--|\n|20210501_642727|0|100|70|50|\n\n* When predicting on a given date, you are forecasting the target variables for the next day (i.e. for date d, you're predicting the engagement for day d+1).\n* Your code will need to be robust and make predictions for any date_playerId combination requested by the module.\n* Submit predications using the provided 'mlb' python time series module.","77ec3c6a":"### vi. **teams.csv**\nThis data contains basic team information for all 30 teams. Such as teamId, leagueId, divisionId, venueId, so on.","4792b37d":"# <center><font color='#041e42'>MLB Player Digital Engagement:<\/font> <font color='#bf0d3e'>Complete Indepth Analysis<\/font><\/center>\n\n<center><img src= \"https:\/\/www.googleapis.com\/download\/storage\/v1\/b\/kaggle-user-content\/o\/inbox%2F603584%2Ff7c0669c09db26bd45f76ade61b2a91f%2FGoogleCloud_MLB_Lockup.jpg?generation=1623359034713516&alt=media\" alt =\"Kaggle MLB Competetion Image\"><\/center>\n","4aba8974":"### iv. **players.csv**\nThis data contains players' basic personal as well as positional information. ","12f7041e":"> Most awarded (1307 times) Award is \"MiLB.com Organization All-Star\", almost 3x more than \"next most awarded award\"","2cd7d10e":"#### \ud83d\udd39 **Transactions**: A single cell from the 'transactions' column","0acd260a":"#### \ud83d\udd39 **Awards**: A single cell from the 'awards' column","d4438772":"#### \ud83d\udd39 **Game Stats**: A single cell from the 'games' column","dfc851ff":"### i. **example_sample_submission.csv**","7e800cf3":"> #### \ud83d\udccc Observations from **games JSON**\n> * Contains \"game information\/stats\" for all the games played on a particular date. Such as Home Team Stats, Away Team Stats, Win\/Loss, Score, etc. \n> * Results of a game surely have a big impacts the fan engagement on digital platform of the players. We will analyse it later and see how the data supports our claim.","215ce7b6":"> ###  \ud83d\udccc Observations from Example Sample Submission\n> * It is not explictly given what the target variables (`target1` to `target4`) represents.\n> * **Very Important to note**: Predictions for the subsequent day is made based on current day's data.\n> * For example: Using the data of 2021-04-26, we are making predictions 2021-04-27 for multiple players.","1d0b2dfa":"Now that we have understood the structure of datasets and what they represent. We can start off with data exploration analysis!","c224e0ad":"#### \ud83d\udd39 **Standings**: A single cell from the 'standings' column\n\n* Contains daily standing infomation of the 30 teams\n* Contains all kinds of standing table stats such as streaks, league rank, division rank, wins\/loses, etc","790890be":"> #### \ud83d\udccc Observations from **transactions.csv**\n> * Transactions here represents changes made to the players. Such as status change(like injured), recalled, selection, etc.\n> * **Important attributes** from the Transactions:\n>     1. typeCode (Transaction status abbreviation)\n>     2. fromTeamId, toTeamId representing teams involved","425d71b3":"### vii. **train.csv**","7db92b9b":"#### \ud83d\udd39 **Player Box Scores**: A single cell from the 'playerBoxScores' column","14c0f70b":"### \ud83d\udccc Observations from Awards data\n\n* Award Date range between June 1998 and December 2017 \n* There are 455 unique awards\n* Most awarded (1307 times) Award is \"MiLB.com Organization All-Star\", almost 3x more than next \"most awarded award\"\n* Till now, around 1700 players have been awarded almost 11500 times\n* For past 5 years, 1000+ awards\/year are given out each season\n* Only a Small proportion of players have 40+ awards to their name","d8c1b224":"# <font color='#093e88'>3. Exploratory Data Analysis<\/font>","888658c9":"### v. **seasons.csv**\nThis data contains various season dates for last 5 seasons (inclding current season).","2d9d5678":"#### \ud83d\udd39 **Twitter Followers**: A single cell from the 'teamTwitterFollowers' & 'playerTwitterFollowers'\n* Contains twitter followers count for players and teams on a particular date.","d5b96fe6":"#### \ud83d\udd39 **Roster Status**: A single cell from the 'rosters' column"}}