{"cell_type":{"71b77906":"code","3d84bcc6":"code","4622f870":"code","705f1586":"code","39ffd6f3":"code","202e97f1":"code","2590845e":"code","5a0dab33":"code","58c397b9":"code","0bd660d8":"code","55b3dbd2":"code","7c417402":"code","ac42ffb3":"code","181fe28d":"code","f9c2296d":"code","36911986":"code","2be970a8":"code","d9d348c9":"code","1d2a631e":"code","67f166c7":"code","99452048":"code","67891d53":"code","7434a6f9":"code","cf00296e":"code","9241f82f":"code","cb7a6bab":"code","d45f83b2":"code","ada22966":"code","0d517938":"code","481f9bbb":"code","7b28ad61":"markdown","760f72d2":"markdown","6926b8e5":"markdown","28408d07":"markdown","2137fa3a":"markdown","39127fbd":"markdown","c075176a":"markdown","10b8f6b9":"markdown","b22469bb":"markdown","fa03db29":"markdown","5eb19003":"markdown","f80f0d01":"markdown","0aa3c0d3":"markdown","d7bb641d":"markdown","f4ff05fe":"markdown","7bdf86d0":"markdown","803acce6":"markdown","46e2bbd4":"markdown","1aff62ce":"markdown","80e46b5f":"markdown","e74ba4c6":"markdown","50b33932":"markdown","da56c6d8":"markdown","e66a52a3":"markdown","d32ecb2d":"markdown","34a6a4bd":"markdown","6f2b1035":"markdown","a9171537":"markdown","082d8f24":"markdown","d11ff09d":"markdown","1bb0b9bf":"markdown","8b76fb7a":"markdown","95f8d83a":"markdown","b5e80a16":"markdown","c48559bf":"markdown","5d902139":"markdown","15a1cc62":"markdown","923f87b0":"markdown","5e4e6983":"markdown","2994302b":"markdown","5d511ca1":"markdown","2071cd19":"markdown"},"source":{"71b77906":"from PIL import Image\nImage.open('shutterstock_1248997882_web.jpg')","3d84bcc6":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(style=\"ticks\", color_codes=True)\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\npd.set_option('display.max_columns',None)\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import model_selection\n\nfrom sklearn.naive_bayes import BernoulliNB\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import BaggingClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.ensemble import AdaBoostClassifier\nfrom sklearn.svm import SVC\nimport lightgbm\nfrom xgboost import XGBClassifier","4622f870":"heart=pd.read_csv('heart.csv')\nheart.head(2)","705f1586":"print('Number of records in dataset are {} and Features are {}.  '.format(*heart.shape))\nprint(\"\\nAny missing sample in set:\",heart.isnull().values.any())","39ffd6f3":"heart.describe()","202e97f1":"#Some changes for better visualization\n\nheart1=heart.copy()\nheart1['target']=heart1['target'].map({1:'Unwell',0:'Healthy'})\nheart1['cp']=heart1['cp'].map({0:'Typical Angina',1:'Atypical Angina',2:'Non-Anginal',3:'Asymptomatic'}).astype('object')\nheart1['fbs']=heart1['fbs'].map({1:'>120 mg\/dl',0:'<120 mg\/dl'})\nheart1['restecg']=heart1['restecg'].map({0:'normal',1:'ST-T abnormality',2:'probable_LVH'})\nheart1['exang']=heart1['exang'].map({1:'Yes',0:'No'})","2590845e":"heart1['target'].value_counts(normalize=True).plot.pie(autopct='%1.1f%%')\nplt.show()","5a0dab33":"heart[['age', 'trestbps','chol','thalach','oldpeak','target']].corr()['target'][:-1].plot.barh()\nplt.title(\"Feature Relation with illness\")\nplt.xlabel('Correlation Coefficient with target')\nplt.ylabel('Continous Features')\nplt.show()","58c397b9":"sns.kdeplot(heart1[heart1['target']=='Unwell']['chol'],shade=True,color=\"orange\", label=\"Unwell\", alpha=.7)\nsns.kdeplot(heart1[heart1['target']=='Healthy']['chol'],shade=True,color=\"dodgerblue\", label=\"Healthy\", alpha=.7)\nplt.title('Cholesterol in mg\/d for both case')\nplt.show()","0bd660d8":"sns.kdeplot(heart1[heart1['target']=='Unwell']['trestbps'],shade=True,color=\"orange\", label=\"Unwell\", alpha=.7)\nsns.kdeplot(heart1[heart1['target']=='Healthy']['trestbps'],shade=True,color=\"dodgerblue\", label=\"Healthy\", alpha=.7)\nplt.title('Resting Blood Pressure for both case')\nplt.show()","55b3dbd2":"Image.open('blood pressure.png')","7c417402":"sns.kdeplot(heart1[heart1['target']=='Unwell']['thalach'],shade=True,color=\"orange\", label=\"Unwell\", alpha=.7)\nsns.kdeplot(heart1[heart1['target']=='Healthy']['thalach'],shade=True,color=\"dodgerblue\", label=\"Healthy\", alpha=.7)\nplt.title('Maximum Heart Rate Achieved for both case')\nplt.show()","ac42ffb3":"sns.kdeplot(heart1[heart1['target']=='Unwell']['oldpeak'],shade=True,color=\"orange\", label=\"Unwell\", alpha=.7)\nsns.kdeplot(heart1[heart1['target']=='Healthy']['oldpeak'],shade=True,color=\"dodgerblue\", label=\"Healthy\", alpha=.7)\nplt.title('ST depression distribution for both case')\nplt.show()","181fe28d":"cols = ['age', 'trestbps', 'chol', 'thalach', 'oldpeak']\nplt.figure(figsize=(15,4))\nfor i,col in enumerate(cols,1):\n   plt.subplot(1,5,i)\n   sns.boxplot(heart[col])\n   plt.xlabel(col)  \nplt.show()","f9c2296d":"Categorical_Features=['sex','cp','exang','fbs','thal','restecg','slope','ca']\npd.DataFrame(heart[Categorical_Features].nunique(),columns=['Unique_counts'])","36911986":"Image.open('angina.png')","2be970a8":"plt.figure(figsize=(15,5))\nplt.subplot(121)\nheart1['cp'].value_counts(normalize=True).plot.pie(autopct='%1.1f%%')\n\nplt.subplot(122)\nsns.countplot(hue='target',x='cp',data=heart1,palette='husl')\nplt.show()","d9d348c9":"plt.figure(figsize=(15,5))\nplt.subplot(121)\nheart1['exang'].value_counts(normalize=True).plot.pie(autopct='%1.1f%%')\n\nplt.subplot(122)\nsns.countplot(hue='target',x='exang',data=heart1,palette='husl')\nplt.show()","1d2a631e":"plt.figure(figsize=(15,5))\nplt.subplot(121)\nheart1['fbs'].value_counts(normalize=True).plot.pie(autopct='%1.1f%%')\n\nplt.subplot(122)\nsns.countplot(hue='target',x='fbs',data=heart1,palette='husl')\nplt.show()","67f166c7":"plt.figure(figsize=(15,5))\nplt.subplot(121)\nheart1['thal'].value_counts(normalize=True).plot.pie(autopct='%1.1f%%')\n\nplt.subplot(122)\nsns.countplot(hue='target',x='thal',data=heart1,palette='husl')\nplt.show()","99452048":"Image.open('The-description-of-the-ECG-curve.png')","67891d53":"plt.figure(figsize=(15,5))\nplt.subplot(121)\nheart1['restecg'].value_counts(normalize=True).plot.pie(autopct='%1.1f%%')\n\nplt.subplot(122)\nsns.countplot(hue='target',x='restecg',data=heart1,palette='husl')\nplt.show()","7434a6f9":"heart1.groupby(['slope','target'])['slope','target'].size().unstack()","cf00296e":"Image.open('st_depression.png')","9241f82f":"plt.figure(figsize=(15,5))\nplt.subplot(121)\nheart1['slope'].value_counts(normalize=True).plot.pie(autopct='%1.1f%%')\n\nplt.subplot(122)\nsns.countplot(hue='target',x='slope',data=heart1,palette='husl')\nplt.show()","cb7a6bab":"plt.figure(figsize=(15,5))\nplt.subplot(121)\nheart1['ca'].value_counts(normalize=True).plot.pie(autopct='%1.1f%%')\n\nplt.subplot(122)\nsns.countplot(hue='target',x='ca',data=heart1,palette='husl')\nplt.show()","d45f83b2":"X=heart.drop('target',axis=1)\ny=heart['target']\n\n#Split the data into train and test set:(70\/30)\nx_trains,x_tests, y_train,y_test=train_test_split(X, y, test_size=0.3, random_state=3)","ada22966":"models = []\n\nmodels.append(('NB', BernoulliNB() ))\nmodels.append(('LOGREG', LogisticRegression() ))\nmodels.append(('DT', DecisionTreeClassifier() ))\nmodels.append(('BAGGED_DT', BaggingClassifier() ))\nmodels.append(('RFC', RandomForestClassifier() ))\n#models.append(('KNN', KNeighborsClassifier() ))   #Use if data is scaled\nmodels.append(('ADA', AdaBoostClassifier() ))\nmodels.append(('SVM', SVC() ))\nmodels.append(('LGBM', lightgbm.LGBMClassifier() ))\nmodels.append(('XGB', XGBClassifier() ))\n\nmodels","0d517938":"from sklearn.metrics import confusion_matrix, accuracy_score,roc_auc_score,roc_curve\nfrom sklearn.model_selection import cross_val_score\n\nresults_train = []\nresults_test = []\nnames = []\ndf_results=pd.DataFrame()\n\nfor name, model in models:\n    names.append(name)\n    kfold = model_selection.KFold(n_splits=10, random_state=3, shuffle=True)\n    \n    trainf1 =cross_val_score(model,x_trains,y_train,cv=kfold, scoring='f1_weighted')\n    trainacc =cross_val_score(model,x_trains,y_train,cv=kfold, scoring='accuracy')\n    trainpre =cross_val_score(model,x_trains,y_train,cv=kfold, scoring='precision_weighted')\n    trainre =cross_val_score(model,x_trains,y_train,cv=kfold, scoring='recall_weighted')\n    trainroc =cross_val_score(model,x_trains,y_train,cv=kfold, scoring='roc_auc')\n    results_train.append(trainroc)\n    \n    \n    \n    \n    testf1 = cross_val_score(model, x_tests, y_test,cv=kfold, scoring='f1_weighted')\n    testacc =cross_val_score(model,x_tests,y_test,cv=kfold, scoring='accuracy')\n    testpre =cross_val_score(model,x_tests,y_test,cv=kfold, scoring='precision_weighted')\n    testre =cross_val_score(model,x_tests,y_test,cv=kfold, scoring='recall_weighted')\n    testroc =cross_val_score(model,x_tests,y_test,cv=kfold, scoring='roc_auc')\n    results_test.append(testroc)\n    \n    \n    df_results = pd.concat([df_results,\\\n                            pd.DataFrame(np.array([name,round(trainf1.mean(),2),round(testf1.mean(),2),\\\n                                                   round(trainacc.mean(),2),round(testacc.mean(),2),\\\n                                                   round(trainpre.mean(),2),round(testpre.mean(),2),\\\n                                                   round(trainre.mean(),2),round(testre.mean(),2),\\\n                                                   round(trainroc.mean(),2),round(testroc.mean(),2) ]).reshape(1,-1),\n                                         columns=['Description','F1score_train','F1score_test',\\\n                                                  'Accuracy_train','Accuracy_test','Precision_train','Precision_test',\\\n                                                  'Recall_train','Recall_test','Roc_auc_train','Roc_auc_test']  )\n                           ], axis=0)\n    \ndf_results","481f9bbb":"plt.figure(figsize=(20,4))\n\nplt.subplot(121)\nplt.title('Train: Algorithm Comparison on Roc-Auc-score')\nplt.boxplot(results_train,labels=names)\n\nplt.subplot(122)\nplt.title('Test: Algorithm Comparison on Roc-Auc-score')\nplt.boxplot(results_test,labels=names,manage_ticks=True)\nplt.show()\n","7b28ad61":"* Some persons are having very high Cholesterol hence are on high risk of illness.","760f72d2":"####  Every algorithm is tested and results are collected \n","6926b8e5":"* As an ST depression of at least 1 mm after adenosine administration indicates a reversible ischaemia, which can be easily seen from concentration of positive cases towards lower side.","28408d07":"### Descriptive Statistics","2137fa3a":"* Stable angina is usually triggered by physical activity.\n* When you climb stairs, exercise or walk, your heart demands more blood, but narrowed arteries slow down blood flow.","39127fbd":"#### Boxplot Algorithm Comparison","c075176a":"* There are extreme values in most of the quantitative variables and it is obvious to get such values as patients with critical conditions can have abnormal values of these variables. So we will not be treating these outliers.","10b8f6b9":"### Checking For Outliers","b22469bb":"* A normal resting heart rate for adults ranges from 60 to 100 beats per minute.\n\n* To measure your heart rate, simply check your pulse. Place your index and third fingers on your neck to the side of your windpipe. To check your pulse at your wrist, place two fingers between the bone and the tendon over your radial artery \u2014 which is located on the thumb side of your wrist.\n\n* When you feel your pulse, count the number of beats in 15 seconds. Multiply this number by four to calculate your beats per minute.\n\nhttps:\/\/www.mayoclinic.org\/healthy-lifestyle\/fitness\/expert-answers\/heart-rate\/faq-20057979","fa03db29":"**Categorical Features** :  'sex', 'cp',  'fbs', 'restecg', 'exang', 'slope', 'ca', 'thal'\n\n\n**Numerical Features** : 'age', 'trestbps', 'chol', 'thalach', 'oldpeak'","5eb19003":"Where,\n* Angina is chest pain or discomfort caused when your heart muscle doesn't get enough oxygen-rich blood. \n* Angina pain may even feel like indigestion. But, angina is not a disease.\n\nTwo types of angina are :","f80f0d01":"### 1.5) cp: Chest Pain Experienced ","0aa3c0d3":"* There isn't any significant difference in both cases in distribution plot. Detailed bifurcation can be seen from below table.","d7bb641d":"### 1.9) restecg: Resting electrocardiographic measurement\n####  (0 = normal, 1 = having ST-T wave abnormality, 2 = showing probable or definite left ventricular hypertrophy by Estes' criteria)\n","f4ff05fe":"### 1.11) ca: The number of major vessels (0-4)","7bdf86d0":"**Happy learning!!**\n\n **Random hypothesis testing :**\n $$Null~Hypothesis    : Opening~this~notebook~was~significant.$$\n $$Alternate~Hypothesis : Wasn't~useful.$$\n\n**Upvote** If this notebook passed your Random hypothesis testing and you found this work useful :)\n","803acce6":"### 1.8) thal: A blood disorder called thalassemia\n#### ( normal;  fixed defect; reversable defect)\n","46e2bbd4":"## 2) Prediction","1aff62ce":"* Blood pressure (BP) is the pressure of circulating blood on the walls of blood vessels. \n* Blood pressure is usually expressed in terms of the systolic pressure (maximum during one heartbeat) over diastolic pressure (minimum in between two heartbeats) and is measured in millimeters of mercury (mmHg).\n","80e46b5f":"**Just some random info:**\n\nFormer tennis player **Pete Sampras** and soccer player **Zinedine Zidane** are known to be a Thalassemia minor patient.","e74ba4c6":"* Thalassemia is a blood disorder passed down through families (inherited) in which the body makes an abnormal form or inadequate amount of hemoglobin. Hemoglobin is the protein in red blood cells that carries oxygen. \n* The disorder results in large numbers of red blood cells being destroyed, which leads to anemia.`","50b33932":"* **Fluoroscopy** is used to help the healthcare provider see the flow of blood through the coronary arteries to check for arterial blockages.\n\n* Fluoroscopy is a study of moving body structures. It\u2019s much like an X-ray \"movie\" and is often done while a contrast dye moves through the part of the body being examined. A continuous X-ray beam is passed through the body part and sent to a video monitor so that the body part and its motion can be seen in detail. Fluoroscopy, as an imaging tool, allows healthcare providers to look at many body systems, including the skeletal, digestive, urinary, cardiovascular, respiratory, and reproductive systems.\n\n* Fluoroscopy may be used to evaluate specific areas of the body. These include the bones, bowel, muscles, heart vessels, and joints.\n\n* If both age and the number of vessels calcified are considered, fluoroscopy can provide useful information regarding the **presence of stenosis** in young and middle-aged patients.\n\n* Vascular calcifications are mineral deposits on the walls of your arteries and veins. These mineral deposits sometimes stick to fatty deposits, or plaques, that are already built up on the walls of a blood vessel. Vascular calcifications are common but potentially serious.\n\nhttps:\/\/pubmed.ncbi.nlm.nih.gov\/3341167\/","da56c6d8":"### 1.6) exang: Exercise Induced Angina \n#### (1 = yes; 0 = no)","e66a52a3":"### 1.7) fbs: Fasting blood sugar\n#### (> 120 mg\/dl, 1 = true; 0 = false)","d32ecb2d":"* Cholesterol is a waxy, fat-like substance that's found in all the cells in your body. \n* Your liver makes cholesterol, and it is also in some foods, such as meat and dairy products. \n* Your body needs some cholesterol to make hormones, vitamin D, and substances that help you digest foods.\n* Your body makes all the cholesterol it needs. But if you have too much cholesterol in your blood, you have a higher risk of coronary artery disease.\n\nhttps:\/\/medlineplus.gov\/cholesterollevelswhatyouneedtoknow.html","34a6a4bd":"* ST depression refers to a finding on an electrocardiogram, wherein the trace in the ST segment is abnormally low below the baseline.\n* In a cardiac stress test, **an ST depression of at least 1 mm after adenosine administration indicates a reversible ischaemia**, while an exercise stress test requires an ST depression of at least 2 mm to significantly indicate reversible ischaemia.","6f2b1035":"* Among Continuous feature oldpeak and thalach are most significant in determining disease.\n* Lets analysis each feature independently.","a9171537":"Our dataset have following 4 types of values.\n* Typical angina, \n\n* Atypical angina, \n\n* Non-anginal pain, \n\n* Asymptomatic(producing or showing no symptoms)","082d8f24":"### 1.10) slope: Slope of the peak exercise ST segment \n#### ( upsloping, flat,  downsloping)","d11ff09d":"# 1) Feature Description","1bb0b9bf":"**Hello Folks!!**\n\nOver 400 million men and women have a kind of cardiovascular illness. 1\/3 of all global deaths are the results of heart disease and stroke. \n\nLets analyse and predict if person with certain physical report have illness or not.","8b76fb7a":"### 1.1) chol: Cholesterol in mg\/dl","95f8d83a":"### 1.4) oldpeak: ST depression induced by exercise relative to rest","b5e80a16":"####  Preparing an array with all the algorithms","c48559bf":"##  Continous Features","5d902139":"* Above boxplots are based on AUC score.\n* Logistic Regression, SVM and ADABoost model are having high variance error compared to other classification models.\n* Random Forest, LightGBM, XGBoost, Naive Bayes are the models with low bias error and also low variance error.\n* Model selection is also based on metric to be considered, we can choose recall or precision as per requirement by health specialist and hence we can manipulate our model selection accordingly.","15a1cc62":"* Generally, a lower heart rate at rest implies more efficient heart function and better cardiovascular fitness. For example, a well-trained athlete might have a normal resting heart rate closer to 40 beats per minute.\n* We dont have record of an well-trained athlete here it seems :)\n","923f87b0":"* A test is done in the morning to determine how much glucose (sugar) is in a blood sample after an overnight fast. The fasting blood glucose test is commonly used to detect diabetes mellitus.\n\n\n\n* 70-100 mg\/dl        : The normal range for blood glucose. \n\n* 100-126 mg\/dl       : Impaired fasting glucose or pre-diabetes. \n\n* 126 mg\/dl or higher : Diabetes need to be diagnosed.\n\n","5e4e6983":"## Categorical Features","2994302b":"### 1.3) thalach: Maximum Heart Rate Achieved","5d511ca1":"\n* **The ST segment** is the flat, isoelectric section of the ECG between the end of the S wave (the J point) and the beginning of the T wave. The ST Segment represents the interval between ventricular depolarization and repolarization.\n\n* The most important cause of ST segment abnormality (elevation or depression) is myocardial ischaemia or infarction. **Myocardial ischemia** occurs when blood flow to the heart muscle (myocardium) is obstructed by a partial or complete blockage of a coronary artery by a buildup of plaques (atherosclerosis). If the plaques rupture, you can have a heart attack (myocardial infarction)`\n\n* **Left ventricular hypertrophy, or LVH**, is a term for a heart\u2019s left pumping chamber that has thickened and may not be pumping efficiently. Sometimes problems such as aortic stenosis or high blood pressure overwork the heart muscle. In response to this pressure overload, the inner walls of the heart may respond by getting thicker. These thickened walls can cause the left ventricle to weaken, stiffen and lose elasticity, which may prevent healthy blood flow.\n\nhttps:\/\/litfl.com\/st-segment-ecg-library\/\n\nhttps:\/\/www.heart.org\/en\/health-topics\/heart-valve-problems-and-disease\/heart-valve-problems-and-causes\/what-is-left-ventricular-hypertrophy-lvh\n\nhttps:\/\/www.healio.com\/cardiology\/learn-the-heart\/ecg-review\/ecg-topic-reviews-and-criteria\/left-ventricular-hypertrophy-review\n\nhttps:\/\/www.youtube.com\/watch?v=xIZQRjkwV9Q","2071cd19":"### 1.2) trestbps: Resting Blood Pressure \n#### (mm Hg on admission to the hospital)\n"}}