{"cell_type":{"0c346cf3":"code","7f2302b8":"code","93474158":"code","0d786ad0":"code","cd03f154":"code","5b210979":"code","63883869":"code","cdccfd9e":"code","a0db7ec7":"code","69d4e494":"code","11296b22":"code","6b6330ae":"code","1302a934":"code","5f9f69de":"code","7b6759f8":"code","e8bc56cd":"code","fae6413b":"code","a0c9b4ff":"code","a69798b7":"code","9b0f0829":"code","eef77235":"code","da03d14f":"code","0943f606":"code","a7c07193":"code","249e8d51":"code","dac680a7":"code","0b4ad678":"markdown","87d4162b":"markdown","49d704fd":"markdown","2443683e":"markdown","3231585f":"markdown","a361a90e":"markdown","f168d2ff":"markdown","21867043":"markdown","d0ed4855":"markdown","cadc7625":"markdown","c375c9f1":"markdown","59353a41":"markdown","f2be501d":"markdown","616ada26":"markdown"},"source":{"0c346cf3":"#Importing Liabraries\n\nimport numpy as np\nimport pandas as pd\n\n#For data visualization\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n#For interactivity\nfrom ipywidgets import interact\n\n#For warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\n#For Clustering Analysis\nfrom sklearn.cluster import KMeans\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import confusion_matrix","7f2302b8":"#Loading Dataset\ndata = pd.read_csv('..\/input\/crop-recommendation-dataset\/Crop_recommendation.csv')\ndata","93474158":"#Shape of dataset\nprint(\"Shape of the dataset :\",data.shape)","0d786ad0":"#Checking missing values\ndata.isnull().sum()","cd03f154":"#Checking Crops present in Dataset\ndata['label'].value_counts()","5b210979":"#Checking the Statistics for all the crops\nprint(\"Average Ratio of nitrogen in the soil : {0: .2f}\".format(data['N'].mean()))\nprint(\"Average Ratio of Phosphorous in the soil : {0: .2f}\".format(data['P'].mean()))\nprint(\"Average Ratio of Potassium in the soil : {0: .2f}\".format(data['K'].mean()))\nprint(\"Average temperature in Celsius : {0: .2f}\".format(data['temperature'].mean()))\nprint(\"Average Relative Humidity in % is : {0: .2f}\".format(data['humidity'].mean()))\nprint(\"Average pH value of the soil : {0: .2f}\".format(data['ph'].mean()))\nprint(\"Average Rain fall in mm : {0: .2f}\".format(data['rainfall'].mean()))","63883869":"#Checking Statistics for each Crop\n\n@interact\ndef summary(crops = list(data['label'].value_counts().index)):\n    x = data[data['label'] == crops]\n    print(\"-------------------------------------------------\")\n    print(\"Statistics for Nitrogen :\")\n    print(\"Minimum Nitrogen Required :\", x['N'].min())\n    print(\"Average Nitrogen Required :\", x['N'].mean())\n    print(\"Maximum Nitrogen Required :\", x['N'].max())\n    print(\"-------------------------------------------------\")\n    print(\"Statistics for Phosphorous :\")\n    print(\"Minimum Phosphorous Required :\", x['P'].min())\n    print(\"Average Phosphorous Required :\", x['P'].mean())\n    print(\"Maximum Phosphorous Required :\", x['P'].max())\n    print(\"-------------------------------------------------\")\n    print(\"Statistics for Potassium :\")\n    print(\"Minimum Potassium Required :\", x['K'].min())\n    print(\"Average Potassium Required :\", x['K'].mean())\n    print(\"Maximum Potassium Required :\", x['K'].max())\n    print(\"-------------------------------------------------\")\n    print(\"Statistics for Temperature :\")\n    print(\"Minimum Temperature Required : {0: .2f}\".format(x['temperature'].min()))\n    print(\"Average Temperature Required : {0: .2f}\".format(x['temperature'].mean()))\n    print(\"Maximum Temperature Required : {0: .2f}\".format(x['temperature'].max()))\n    print(\"-------------------------------------------------\")\n    print(\"Statistics for Humidity :\")\n    print(\"Minimum Humidity Required : {0: .2f}\".format(x['humidity'].min()))\n    print(\"Average Humidity Required : {0: .2f}\".format(x['humidity'].mean()))\n    print(\"Maximum Humidity Required : {0: .2f}\".format(x['humidity'].max()))\n    print(\"-------------------------------------------------\")\n    print(\"Statistics for PH :\")\n    print(\"Minimum PH Required : {0: .2f}\".format(x['ph'].min()))\n    print(\"Average PH Required : {0: .2f}\".format(x['ph'].mean()))\n    print(\"Maximum PH Required : {0: .2f}\".format(x['ph'].max()))\n    print(\"-------------------------------------------------\")\n    print(\"Statistics for Rainfall :\")\n    print(\"Minimum Rainfall Required : {0: .2f}\".format(x['rainfall'].min()))\n    print(\"Average Rainfall Required : {0: .2f}\".format(x['rainfall'].mean()))\n    print(\"Maximum Rainfall Required : {0: .2f}\".format(x['rainfall'].max()))\n    print(\"-------------------------------------------------\")\n    ","cdccfd9e":"# Lets compare the average Requirement for eash crops with average conditions\n\n@interact\ndef compare(conditions = ['N','P','K','temperature','ph','humidity','rainfall']):\n    print(\"Average Value for\",conditions,\"is {0: .2f}\".format(data[conditions].mean()))\n    print(\"----------------------------------------------------------------\")\n    print(\"Rice : {0: .2f}\".format(data[(data['label'] == 'rice')][conditions].mean()))\n    print(\"Black Grams : {0: .2f}\".format(data[(data['label'] == 'blackgram')][conditions].mean()))\n    print(\"Banana : {0: .2f}\".format(data[(data['label'] == 'banana')][conditions].mean()))\n    print(\"Jute : {0: .2f}\".format(data[(data['label'] == 'jute')][conditions].mean()))\n    print(\"Coconut : {0: .2f}\".format(data[(data['label'] == 'coconut')][conditions].mean()))\n    print(\"Apple : {0: .2f}\".format(data[(data['label'] == 'apple')][conditions].mean()))\n    print(\"Papaya : {0: .2f}\".format(data[(data['label'] == 'papaya')][conditions].mean()))\n    print(\"Muskmelon : {0: .2f}\".format(data[(data['label'] == 'muskmelon')][conditions].mean()))\n    print(\"Grapes : {0: .2f}\".format(data[(data['label'] == 'grapes')][conditions].mean()))\n    print(\"Watermelon : {0: .2f}\".format(data[(data['label'] == 'watermelon')][conditions].mean()))\n    print(\"Kedney Beans : {0: .2f}\".format(data[(data['label'] == 'kidneybeans')][conditions].mean()))\n    print(\"Mung Beans : {0: .2f}\".format(data[(data['label'] == 'mungbean')][conditions].mean()))\n    print(\"Oranges : {0: .2f}\".format(data[(data['label'] == 'orange')][conditions].mean()))\n    print(\"Chick Peas : {0: .2f}\".format(data[(data['label'] == 'chickpea')][conditions].mean()))\n    print(\"Lentils : {0: .2f}\".format(data[(data['label'] == 'lentil')][conditions].mean()))\n    print(\"Cotton : {0: .2f}\".format(data[(data['label'] == 'cotton')][conditions].mean()))\n    print(\"Maize : {0: .2f}\".format(data[(data['label'] == 'maize')][conditions].mean()))\n    print(\"Moth Beans : {0: .2f}\".format(data[(data['label'] == 'mothbeans')][conditions].mean()))\n    print(\"Pigeon peas : {0: .2f}\".format(data[(data['label'] == 'pigeonpeas')][conditions].mean()))\n    print(\"Mango : {0: .2f}\".format(data[(data['label'] == 'mango')][conditions].mean()))\n    print(\"Pomegrante : {0: .2f}\".format(data[(data['label'] == 'pomegrante')][conditions].mean()))\n    print(\"Coffee : {0: .2f}\".format(data[(data['label'] == 'coffee')][conditions].mean()))\n    ","a0db7ec7":"#Distribution for Agricultural Conditions\nplt.figure(figsize=(15,8))\nplt.subplot(2,4,1)\nsns.distplot(data['N'],color = 'blue')\nplt.xlabel('Ratio of Nitrogen',fontsize = 12)\nplt.grid()\n\nplt.subplot(2,4,2)\nsns.distplot(data['P'],color = 'green')\nplt.xlabel('Ratio of Phosphorous',fontsize = 12)\nplt.grid()\n\nplt.subplot(2,4,3)\nsns.distplot(data['K'],color = 'darkblue')\nplt.xlabel('Ratio of Potassium',fontsize = 12)\nplt.grid()\n\nplt.subplot(2,4,4)\nsns.distplot(data['temperature'],color = 'black')\nplt.xlabel('Temperature',fontsize = 12)\nplt.grid()\n\nplt.subplot(2,4,5)\nsns.distplot(data['rainfall'],color = 'grey')\nplt.xlabel('Rainfall',fontsize = 12)\nplt.grid()\n\nplt.subplot(2,4,6)\nsns.distplot(data['humidity'],color = 'lightgreen')\nplt.xlabel('Humidity',fontsize = 12)\nplt.grid()\n\nplt.subplot(2,4,7)\nsns.distplot(data['ph'],color = 'darkgreen')\nplt.xlabel('ph level',fontsize = 12)\nplt.grid()\n\nplt.suptitle('Distribution for Agricultural Conditions', fontsize = 20)\nplt.show()","69d4e494":"# Crops requires more rainfall,temperature,humidity,Nitrogen,Potassium,Phosphorous and ph value VS Crops requires Less \n@interact\ndef compare(conditions = ['N','P','K','temperature','ph','humidity','rainfall']):\n    print(\"Crops which require greater than average\",conditions,'\\n')\n    print(data[data[conditions] > data[conditions].mean()]['label'].unique())\n    print(\"-------------------------------------------------------\")\n    print(\"Crops which require less than average\",conditions,'\\n')\n    print(data[data[conditions] <= data[conditions].mean()]['label'].unique())","11296b22":"# Crops which Require more Rainfall vs Crops which Require Less Rainfall\nprint(\"Crops which requires very High rainfall:\",data[data['rainfall'] > 200]['label'].unique())\nprint(\"Crops which requires very Low rainfall:\",data[data['rainfall'] < 40]['label'].unique())","6b6330ae":"print(\"Crops which requires very High ratio of Nitrogen Content in soil :\",data[data['N'] > 120]['label'].unique())\nprint(\"Crops which requires very High ratio of Phosphorous Content in soil :\",data[data['P'] > 100]['label'].unique())\nprint(\"Crops which requires very High ratio of Potassium Content in soil :\",data[data['K'] > 200]['label'].unique())\nprint(\"Crops which requires very High Rainfall :\",data[data['rainfall'] > 200]['label'].unique())\nprint(\"Crops which requires very Low Rainfall:\",data[data['rainfall'] < 40]['label'].unique())\nprint(\"Crops which requires very Low Temperature :\",data[data['temperature'] < 10]['label'].unique())\nprint(\"Crops which requires very High Temperature :\",data[data['temperature'] > 40]['label'].unique())\nprint(\"Crops which requires very Low Humidity :\",data[data['humidity'] < 20]['label'].unique())\nprint(\"Crops which requires very Low pH :\",data[data['ph'] < 4]['label'].unique())\nprint(\"Crops which requires very High pH :\",data[data['ph'] > 8]['label'].unique())","1302a934":"# By using dataset, Find the best suitable Crop for Summer Season,Winter Season and Rainy Season\nprint(\"Summer Crops\")\nprint(data[(data['temperature'] > 30) & (data['humidity'] > 50)]['label'].unique())\nprint(\"--------------------------------------------------------------------------\")\nprint(\"Winter Crops\")\nprint(data[(data['temperature'] < 20) & (data['humidity'] > 30)]['label'].unique())\nprint(\"--------------------------------------------------------------------------\")\nprint(\"Rainy Crops\")\nprint(data[(data['rainfall'] > 200) & (data['humidity'] > 30)]['label'].unique())","5f9f69de":"#Removing the Labels column \nx = data.drop(['label'], axis=1)\n\n#Selecting all values of data\nx = x.values\n\n#Checking the shape\nprint(x.shape)","7b6759f8":"#Determining Optimum number of Clusters within Dataset by using K-means Clustering\nplt.rcParams['figure.figsize'] = (10,4)\n\nwcss = []\nfor i in range(1,11):\n    km = KMeans(n_clusters = i,init = 'k-means++',max_iter = 300, n_init = 10, random_state = 0)\n    km.fit(x)\n    wcss.append(km.inertia_)\n    \n#Plotting the Results\nplt.plot(range(1,11),wcss)\nplt.title('The Elbow Method',fontsize = 20)\nplt.xlabel('No. of Cluster')\nplt.ylabel('wcss')\nplt.show()","e8bc56cd":"#Implementing K-means Algorithm to perform Clustering Analysis\nkm = KMeans(n_clusters = 4,init = 'k-means++',max_iter = 300, n_init = 10, random_state = 0)\ny_means = km.fit_predict(x)\n\n#Lets find out results\na = data['label']\ny_means = pd.DataFrame(y_means)\nz = pd.concat([y_means, a],axis = 1)\nz = z.rename(columns = {0: 'cluster'})\n\n#Checking Clusters of Each crop\nprint(\"Checking results after applying K-means Clustering Analysis \\n\")\nprint(\"Crops in First Cluster:\", z[z['cluster'] == 0]['label'].unique())\nprint(\"---------------------------------------------------------------\")\nprint(\"Crops in Second Cluster:\", z[z['cluster'] == 1]['label'].unique())\nprint(\"---------------------------------------------------------------\")\nprint(\"Crops in Third Cluster:\", z[z['cluster'] == 2]['label'].unique())\nprint(\"---------------------------------------------------------------\")\nprint(\"Crops in Forth Cluster:\", z[z['cluster'] == 3]['label'].unique())","fae6413b":"#Splitting dataset for Predictive Modelling\ny = data['label']\nx = data.drop(['label'],axis = 1)\n\nprint(\"Shape of x:\", x.shape)\nprint(\"Shape of y:\", y.shape)","a0c9b4ff":"#Training and Testing Sets for Validation of Results\nx_train,x_test,y_train,y_test = train_test_split(x,y,test_size = 0.2,random_state = 0)\n\nprint(\"The shape of x train:\", x_train.shape)\nprint(\"The shape of x test:\", x_test.shape)\nprint(\"The shape of y train:\", y_train.shape)\nprint(\"The shape of y test:\", y_test.shape)","a69798b7":"#Creating a Predictive model\nmodel = LogisticRegression(solver='liblinear')\nmodel.fit(x_train, y_train)\ny_pred = model.predict(x_test)","9b0f0829":"#Evaluating Model Performance by using confusion matrix\nplt.rcParams['figure.figsize'] = [10,10]\ncm = confusion_matrix(y_test, y_pred)\nsns.heatmap(cm, annot = True, cmap = 'Wistia')\nplt.title('Confusion Matrix for Logistic Regression', fontsize=15)\nplt.show()","eef77235":"#Printing Classification Report\ncr = classification_report(y_test, y_pred)\nprint(cr)","da03d14f":"# Our model is ready,now we use model to predict Crop name\ndata.head()","0943f606":"prediction = model.predict((np.array([[90,\n                                       40,\n                                       40,\n                                       20,\n                                       80,\n                                       7,\n                                       200]])))\nprint(\"The suggested Crop for Given Climatic condition is :\", prediction)","a7c07193":"data.tail()","249e8d51":"prediction = model.predict((np.array([[107,\n                                       34,\n                                       32,\n                                       26,\n                                       66,\n                                       7,\n                                       180]])))\nprint(\"The suggested Crop for Given Climatic condition is :\", prediction)","dac680a7":"#If you like this notebook,don't forget to upvote.","0b4ad678":"### As we can see that for all 22 classes we have high precision and recall values which shows that our Predictive model works very well.","87d4162b":"# 4.Predictive Modelling","49d704fd":"### We can find rainfall,temperature,humidity,Nitrogen,Potassium,Phosphorous and ph value of every individual crop by selecting on the drop down menu.","2443683e":"### Above Graph shows us many hidden patterns like many crops need Phosphorous and Potassium at very high level.\n### Need of rain,temperature and ph value vary from crop to crop.","3231585f":"# Crop Recommendation based on different Features\n\n### Contents\n###   1.Exploratory Data Analysis\n###   2.Hidden Patterns\n###   3.Clustering Analysis\n###   4.Predictive modeling","a361a90e":"# 1.Exploratory Data Analysis","f168d2ff":"#### We can find statistics of any other crop by selecting on drop down list","21867043":"# 3.Clustering Analysis","d0ed4855":"# Setup","cadc7625":"# 2.Hidden Patterns","c375c9f1":"### Our Predictive Model works very well.\n### This Predictive model is usefull for Modern Farming.","59353a41":"### By using Elbow method,we concluded that dataset consists of four clusters.","f2be501d":"#### Above shows that nitrogen,Phosphorous and potassium should be around 50%\n#### Temperature should be around 25\u00b0C and Humidity around 70%\n#### Rain fall should be around 100mm and PH should be arount 7","616ada26":"### Performance of our Predictive model is excellent, Now we are going to change our input values."}}