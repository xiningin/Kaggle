{"cell_type":{"59b221f6":"code","e99c9712":"code","b4dfac5b":"code","d4cf29e8":"code","bf81728e":"code","042802b1":"code","6a943f84":"code","a1525b27":"code","572c932d":"code","a4a9893e":"code","942f97d8":"code","bb113d07":"markdown","aa23fcb3":"markdown","0e6edb7a":"markdown","12cb89b2":"markdown","1273141d":"markdown","c24288f4":"markdown","e45966d8":"markdown","664421e5":"markdown","f676deda":"markdown","c613dd07":"markdown","d570ead9":"markdown","55db8814":"markdown"},"source":{"59b221f6":"!pip install neuralprophet[live]","e99c9712":"import pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom neuralprophet import NeuralProphet","b4dfac5b":"df = pd.read_csv(\"..\/input\/nifty50-stock-market-data\/COALINDIA.csv\", parse_dates=[\"Date\"])\ndf.head()","d4cf29e8":"df.tail()","bf81728e":"df = df[[\"Date\", \"VWAP\"]]\ndf.rename(columns={\"Date\": \"ds\", \"VWAP\": \"y\"}, inplace=True)","042802b1":"model = NeuralProphet()\nmetrics = model.fit(df, validate_each_epoch=True, freq=\"D\")","6a943f84":"future = model.make_future_dataframe(df, periods=365, n_historic_predictions=len(df))\nforecast = model.predict(future)","a1525b27":"fig, ax = plt.subplots(figsize=(8,8))\nmodel.plot(forecast, xlabel=\"Date\", ylabel=\"VWAP\", ax=ax)\n\nax.xaxis.label.set_size(28)\nax.yaxis.label.set_size(28)\nax.tick_params(axis='both', which='major', labelsize=24)\nax.set_title(\"Coal India Stocks\", fontsize=28, fontweight=\"bold\")","572c932d":"fig_comp = model.plot_components(forecast)","a4a9893e":"fig_param = model.plot_parameters()","942f97d8":"fig, ax = plt.subplots(figsize=(14, 10))\nax.plot(metrics[\"MAE\"], '-b', linewidth=6, label=\"Training Loss\")  \nax.plot(metrics[\"MAE_val\"], '-r', linewidth=2, label=\"Validation Loss\")\n\n# You can use metrics[\"SmoothL1Loss\"] and metrics[\"SmoothL1Loss_val\"] too.\n\nax.legend(loc='center right', fontsize=16)\nax.tick_params(axis='both', which='major', labelsize=20)\nax.set_xlabel(\"Epoch\", fontsize=28, fontweight=\"bold\")\nax.set_ylabel(\"Loss\", fontsize=28, fontweight=\"bold\")\n\nax.set_title(\"Model Loss (MAE)\", fontsize=28, fontweight=\"bold\")\n","bb113d07":"# pattern for neuralprophet \nThis is same as Prophet where only two columns are expected \u2018ds\u2019 which is the timestamp and \u2018y\u2019 the dependent variable( for stocks it is VWAP or Volume Weighted Average Price) \n","aa23fcb3":"# defining the model and fitting it\nThe complete hyperparameter for the model list can be viewed from [here](http:\/\/ourownstory.github.io\/neural_prophet\/hyperparameter-selection\/). Here \u2018D\u2019 stands for calendar day frequency.","0e6edb7a":"# NeuralProphet\n\nLast week Facebook released its new open source time series modelling Python library [NeuralProphet](http:\/\/ourownstory.github.io\/neural_prophet\/), a PyTorch based neural network forecasting tool. Neural Prophet is an up-gradation to Facebook's previously launched Prophet library. It is also based on AR-Net. The NeuralProphet framework addresses some key points - customization, scalability and extensibility. It is built on top of statistical and neural network models for time series modelling, used in any kind of forecasting and anomaly detection. NeuralProphet was created in collaboration with researchers at Monash and Stanford University. It's easy-to-use and enables researchers and engineers to build better time-based data models. \nNeuralProphet consists of components like trends, multiple seasonality modelled using Fourier terms, auto-regression implemented using Auto-Regressive Feed-Forward Neural Network, special events, future regressors and lagged regressors. \n","12cb89b2":"# Stock Market Forecasting using Facebook\u2019s NeuralProphet\n","1273141d":"# making future predictions from the model.\n","c24288f4":"# Stock Price Forecasting Using NeuralProphet\n### Installation: \nThe [GitHub](http:\/\/github.com\/ourownstory\/neural_prophet) repository can be cloned and used otherwise using pip.\n\npip install neuralprophet \n\nor \n\npip install neutralprophet[live] - This enables plot_live_live parameter in the train function to get live training and validation plots.\n","e45966d8":"# Model Loss","664421e5":"![stocks](http:\/\/secureservercdn.net\/192.169.221.188\/wvn.6db.myftpupload.com\/wp-content\/uploads\/2020\/06\/Nifty-50-Stocks-List-weightage-wise-httpfintechadvise.com_.jpeg)","f676deda":"# plotting the prediction","c613dd07":"# reading dataset\nFor demonstration purposes, I've shown the forecasting on Coal India stocks. Similarly, it can be done on other stocks as well.","d570ead9":"# Time Series over Stocks\n\nPredicting stock prices can be difficult as it involves various factors. Both the government and companies keep changing their policies and strategies which affect stocks massively to either rise or fall anytime. The stock market is the most unpredictable area as these factors are unforeseen and subject to change in future. Thus it is difficult to make models that can accurately predict stock prices. Although it is possible to predict the trends, seasonality and other parameters based on the previous historical data. With the advent of deep learning state of art models, many systems are adapting it.\n","55db8814":"# plotting the parameters\nThis shows the trend, trend rate, weekly seasonality and a yearly seasonality."}}