{"cell_type":{"b08cb2f3":"code","48a7dabd":"code","6a9f5e55":"code","96b38c2f":"code","cfa2bd88":"code","a6b1124f":"code","68a8d318":"code","93f109b3":"code","4c239014":"code","e1edada3":"code","0b60c5e5":"code","8fc6ff9f":"markdown","16cb6dec":"markdown","0f15928b":"markdown","41360f4e":"markdown","6fe5b410":"markdown","d9aec907":"markdown"},"source":{"b08cb2f3":"!pip install feyn","48a7dabd":"import pandas as pd\nimport feyn","6a9f5e55":"df = pd.read_csv(\"\/kaggle\/input\/churn-modelling\/Churn_Modelling.csv\")\ndf","96b38c2f":"df = df.drop([\"RowNumber\", \"CustomerId\", \"Surname\"], axis=1)","cfa2bd88":"train, test = feyn.tools.split(df, ratio=(4,1), random_state=42)","a6b1124f":"stypes = {}\nfor colname in df:\n    if df[colname].dtype == object:\n        stypes[colname] = \"cat\"\n\nstypes","68a8d318":"ql = feyn.connect_qlattice()\nql.reset(random_seed=42)","93f109b3":"models = ql.auto_run(train, output_name=\"Exited\", kind=\"classifier\", stypes=stypes, criterion=\"bic\", n_epochs=40)","4c239014":"models[0].plot(train, test)","e1edada3":"models[0].plot_signal(train)","0b60c5e5":"models[0].plot_response_1d(test, by=\"Age\")","8fc6ff9f":"# Abstract\n\nIn this notebook I use a QLattice symbolic regressor to find mathematical model that can predict churn. I find that a quite simple model yields good results (AUC=0.83, accuracy=85%).\n\n# The QLattice\n\n![image.png](attachment:270a7cf2-c779-48ad-b425-d67c5751912c.png)\n\nThe QLattice is a supervised machine learning tool for symbolic regression developed by Abzu. QLattices have been shown in research to perform very well and yield simple and explainable models: Symbolic regression outperforms other models for small data sets\n\nAbzu provides free QLattices for non-commercial use. Read more about how it works here: https:\/\/docs.abzu.ai\/docs\/guides\/getting_started\/community.html\n\nThe feyn Python module is not installed on Kaggle by default so we have to pip install it first.","16cb6dec":"# Feature importance\nPlot how correlation arises throughout the model","0f15928b":"\n# Allocate a QLattice\n\nThe actual QLattice is a quantum simulator that runs on Abzu's hardware, but we can allocate one to use for our analysis with a single line of code. Hopefully the following line will get us one.\n","41360f4e":"# Partial plot\nAs an example of a partial plot, let's look at the probaility of churning as a function of age. It's fun to see the gaussian peak in the late 50's","6fe5b410":"# Evaluate\nEvaluate the AUC and other performance metrics of of the model on both the train and the test set","d9aec907":"# Categorical data\n\nThe QLattice will work fine with both categorical and numerical data. I just need to tell it which is which. Read more about categorical data in the QLattice here: https:\/\/docs.abzu.ai\/docs\/guides\/essentials\/stypes.html"}}