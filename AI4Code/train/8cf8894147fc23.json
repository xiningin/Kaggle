{"cell_type":{"2b7b5131":"code","680cc4c1":"code","97d2a528":"code","b456f07c":"code","387e4736":"code","e41ae0a9":"code","ea61e459":"code","e3680366":"code","b5bc669b":"code","084597f0":"code","f815dc2d":"code","52286ead":"code","fd09d1a3":"code","70e51521":"code","e195ee2d":"code","75a69a45":"code","c75259d1":"code","c225fd71":"code","55d5b8f0":"code","39acd73d":"code","45904c05":"code","cc81309b":"code","273d1204":"code","c704d826":"code","f357fef3":"code","6173dd25":"code","9122952f":"code","7cbd9cf4":"code","c61ecd58":"code","34d44ef7":"code","0be00c9f":"code","1e41b5a5":"markdown","d475440c":"markdown","4e88093c":"markdown","63baf484":"markdown","256bdd11":"markdown","cb9ddab4":"markdown","f815bdfa":"markdown","f9425bd3":"markdown"},"source":{"2b7b5131":"import numpy as np\nimport pandas as pd\nfrom sklearn.linear_model import LogisticRegression\nimport tensorflow as tf\nfrom tensorflow import keras","680cc4c1":"raw = pd.read_csv('..\/input\/heart-failure-prediction\/heart.csv')","97d2a528":"raw.tail(10)","b456f07c":"data = raw.copy()","387e4736":"data.ChestPainType.replace(['ASY','ATA','NAP','TA'], [1,2,3,4], inplace=True)","e41ae0a9":"y_train = data.HeartDisease\ndata = data.drop(['HeartDisease'],axis=1)","ea61e459":"data.RestingECG.replace(['LVH','Normal','ST'],[1,2,3],inplace=True)\ndata.ExerciseAngina.replace(['Y','N'],[0,1],inplace=True)","e3680366":"data.Sex.replace(['M','F'],[1,2],inplace=True)","b5bc669b":"data.ST_Slope.replace(['Up','Flat','Down'],[1,2,3],inplace=True)","084597f0":"clf = LogisticRegression(penalty='l2', solver='liblinear')","f815dc2d":"from sklearn.model_selection import train_test_split","52286ead":"x_train, x_test, y_train, y_test = train_test_split(data, y_train, random_state=1)","fd09d1a3":"clf.fit(x_train, y_train)","70e51521":"clf.score(x_train, y_train)","e195ee2d":"clf.score(x_test,y_test)","75a69a45":"from sklearn.tree import DecisionTreeClassifier","c75259d1":"clf1 = DecisionTreeClassifier(max_leaf_nodes=22, criterion='entropy') #taking max leaf nodes as 22 (2 split avg for each feature).","c225fd71":"clf1.fit(x_train, y_train)","55d5b8f0":"clf1.score(x_test, y_test)","39acd73d":"total_male = raw.Sex.loc[raw.Sex=='M'].count()\ntotal_female = raw.Sex.loc[raw.Sex=='F'].count()","45904c05":"ill_male = raw[raw.Sex=='M']['HeartDisease'].sum()\nill_female = raw[raw.Sex=='F']['HeartDisease'].sum()","cc81309b":"percent_ill_male = ill_male\/total_male*100\npercent_ill_female = ill_female\/total_female*100\nprint('% of ill male = ', percent_ill_male)\nprint('% of ill female = ', percent_ill_female)","273d1204":"import matplotlib.pyplot as plt","c704d826":"hr_ill = raw.MaxHR[raw.HeartDisease==1]\nhr_not_ill = raw.MaxHR[raw.HeartDisease==0]\nprint(hr_ill.describe(), hr_not_ill.describe())","f357fef3":"plt.hist(hr_ill)\nplt.show()\nplt.hist(hr_not_ill)\nplt.show()","6173dd25":"a = raw.ExerciseAngina[raw.ExerciseAngina=='Y'].count()\nb = raw.ExerciseAngina[raw.ExerciseAngina=='N'].count()\na_ill = raw[raw.ExerciseAngina=='Y']['HeartDisease'].sum()\nb_ill = raw[raw.ExerciseAngina=='N']['HeartDisease'].sum()\na_ill*100\/a, b_ill*100\/b","9122952f":"data.head()","7cbd9cf4":"data.describe()","c61ecd58":"for i in data.columns:\n    data[i] = data[i]\/data[i].max()\ndata.head()","34d44ef7":"model = keras.Sequential([\n    keras.layers.Dense(100, input_shape=(11,), activation='sigmoid'),\n    keras.layers.Dense(1, input_shape=(11,), activation='sigmoid', kernel_initializer='ones', bias_initializer='zeros')\n])\n\nmodel.compile(optimizer='adam',\n              loss='binary_crossentropy',\n              metrics=['accuracy']\n)\n\nmodel.fit(x_train, y_train, epochs=1000)","0be00c9f":"model.evaluate(x_test, y_test)","1e41b5a5":"Therefore both Logistic Regression and Decision Tree is performing almost same.","d475440c":"I am a newbie in this field, just started learning.\nSo any suggestion is welcome","4e88093c":"Let's see what role gender plays","63baf484":"So if you are a male, there is a high chance that you will suffer from heart chance rathar than female.","256bdd11":"Now let's see if a person is suffering from heart disease will his\/her heart rate different from healthy people.","cb9ddab4":"Applied some basic neural network logistic regression.","f815bdfa":"Therefore people with heart disease tends to have lower heart rate than healthy people.","f9425bd3":"So people who suffer from Exercise Angina tends to have Heart Desiease more than those who don't.\n\nEverything that we have calculated has a value. A slight manipulation of those values can be further used to specify class weights for the classifiers, ultimately giving better predictions."}}