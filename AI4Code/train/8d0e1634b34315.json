{"cell_type":{"e1e9ab10":"code","c08d1e23":"code","51e6992b":"code","683d3561":"code","3ccf6956":"code","c9193d25":"markdown","ea245275":"markdown","2c01f96d":"markdown","6c3201e6":"markdown"},"source":{"e1e9ab10":"import os\nfrom os import listdir\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport random\nfrom collections import Counter\n%matplotlib inline\n\n# dcm \nimport pydicom\nfrom pydicom.pixel_data_handlers.util import apply_modality_lut\n\nfrom colorama import Fore, Back, Style\n\n\n# Suppress warnings \nimport warnings\nwarnings.filterwarnings('ignore')\n\n# Settings for pretty nice plots\nplt.style.use('fivethirtyeight')\nplt.show()\n\nfrom ipywidgets import interact, interactive, IntSlider, Layout\nimport ipywidgets as widgets\n\nfrom IPython.core.interactiveshell import InteractiveShell\nInteractiveShell.ast_node_interactivity = 'all'","c08d1e23":"random.seed(12)\n\n# take a random sample of a training DICOM file\nTRAIN_FILE_PATH = \"\/kaggle\/input\/rsna-str-pulmonary-embolism-detection\/train\"\nsample_StudyInstanceUID = random.choice(os.listdir(TRAIN_FILE_PATH))\n\nFULL_SAMPLE_PATH = TRAIN_FILE_PATH + '\/' + sample_StudyInstanceUID\nsample_SeriesInstanceUID = random.choice(os.listdir(FULL_SAMPLE_PATH))\n\nFULL_SAMPLE_PATH += '\/' + sample_SeriesInstanceUID\nsample_SOPInstanceUID = os.listdir(FULL_SAMPLE_PATH)[0]\n\nFULL_SAMPLE_PATH += '\/' + sample_SOPInstanceUID\nprint(\"Selected Sample: \" + FULL_SAMPLE_PATH)","51e6992b":"# get dicom instance\nimg_dicom = pydicom.read_file(FULL_SAMPLE_PATH)\nsample_img = img_dicom.pixel_array\n\n# apply rescaling\nslope = img_dicom.RescaleSlope\nintercept = img_dicom.RescaleIntercept\nsample_img = sample_img * slope + intercept","683d3561":"# static plots\nDIM = 10\n\nfig= plt.figure(figsize=(DIM,DIM))\nW = 400\nL = 40\n\nimg_min = L - W \/\/ 2 # lowest_visible_value\nimg_max = L + W \/\/ 2 # highest_visible_value\n\ntest_img = sample_img.copy()\n\ntest_img[test_img < img_min] = img_min # setting any value lower than lowest_visible_value to lowest_visible_value \ntest_img[test_img > img_max] = img_max # setting any value higher than highest_visible_value to highest_visible_value\n\nplt.imshow(test_img)\nplt.show()","3ccf6956":"DIM = 6 \n\nmin_hu = min(sample_img.flatten().tolist())\/\/10*10\nmax_hu = max(sample_img.flatten().tolist())\/\/10*10\n\nW = widgets.IntSlider(description='W', min = min_hu, max = max_hu, step = 10)\nL = widgets.IntSlider(description='L', min = min_hu, max = max_hu, step = 10)\n\ndef f(W, L):\n    img_min = L - W \/\/ 2 # lowest_visible_value\n    img_max = L + W \/\/ 2 # highest_visible_value\n\n    test_img = sample_img.copy()\n\n    test_img[test_img < img_min] = img_min # setting any value lower than lowest_visible_value to lowest_visible_value \n    test_img[test_img > img_max] = img_max # setting any value higher than highest_visible_value to highest_visible_value\n    fig = plt.figure(figsize=(DIM,DIM))\n    plt.imshow(test_img)\n\nout = widgets.interactive_output(f, {'W': W, 'L': L})\n\nwidgets.HBox([widgets.VBox([W, L]), out])","c9193d25":"## Static Plot","ea245275":"## Interactive Plot\nHere, you can freely adjust the W and L parameters and view what the resulting CT image is. ","2c01f96d":"<font color = 'blue'> I will have the list of useful resources + summaries updated to notebook during the weekend :)   In the mean time, happy to hear any suggestions, comments, or findings. Thank you! <\/font>","6c3201e6":"# HU Exploration \n\n<font color = 'blue' size = 3> Seems like the interactive feature of this notebook is not avilable unless you do edit\/run. <\/font>   \n<font color = 'blue' size = 3> If you would like to play around with the HU Width and Center values, Copy the notebook, go to Edit, and run all cells <\/font>  \n\n\n![image.png](attachment:image.png)\n\n\nThank you!\n\n\n* created: 09-17-2020\n* updates: \n    * [09-17-2020]: created notebook and added codes for interactive visualization \n    * [09-18-2020]: added descriptions \n\n**What is Hounsfield Unit (HU)?:**   \nTo be added\n\n**Steps involved:**   \nTo be added\n\n**References:**  \n[1] Great explanation on HU and ranges: https:\/\/www.stepwards.com\/?page_id=21646   \n[2] To be added"}}