{"cell_type":{"e8cf33dd":"code","5174eace":"code","f413536f":"code","425cc5c8":"code","67780605":"code","64de5c30":"code","71b2ae8d":"code","dea93954":"code","1993f90d":"code","21847656":"code","30c86a8e":"code","1fe5e31f":"code","ddf4a3c3":"code","7183e253":"code","b64ff6ff":"code","6263e76d":"code","ac92ec82":"markdown","aa236166":"markdown","c1f99948":"markdown","d9848168":"markdown","d17cf478":"markdown","40d5b638":"markdown","ee8901e2":"markdown","49668074":"markdown","8bd00f1b":"markdown","065f6b05":"markdown","35ea7dc1":"markdown","0140f38b":"markdown"},"source":{"e8cf33dd":"import numpy as np\nimport tensorflow as tf\nfrom tensorflow.keras import layers\nimport pandas as pd\n\nimport os\nimport glob\nimport collections\nimport shutil\nfrom PIL import Image\nimport matplotlib.pyplot as plt\n\n\n# Set the seed\nseed = 27912\nnp.random.seed(seed)\n","5174eace":"data = pd.read_csv(\"..\/input\/pokemon-images-and-types\/pokemon.csv\")","f413536f":"data.sample(5)","425cc5c8":"images_dir = \"..\/input\/pokemon-images-and-types\/images\/images\/\"","67780605":"data.info","64de5c30":"os.chdir(images_dir)\ncnt = collections.Counter()\nfor filename in glob.glob(\"*\"):\n    name, ext = os.path.splitext(filename)\n    cnt[ext] += 1\nprint(cnt)","71b2ae8d":"types = data.Type1.unique()\ntypes","dea93954":"os.mkdir(\"newData\")\n\nfor t in types:\n    os.mkdir(\"newData\/{}\".format(t))","1993f90d":"for t in types:\n    aux_type = data[data.Type1.eq(t)]\n    for pokemon in aux_type.Name:\n        for filename in os.listdir(images_dir):\n            original_path = \"{}{}\".format(images_dir, filename)\n            # pokemon name with extension\n            extension = os.path.basename(original_path)\n            # directory without extension\n            poke_dir = os.path.splitext(original_path)[0]\n            # only pokemon name\n            poke_name = os.path.basename(poke_dir)\n            if(pokemon == poke_name):\n                target_path = \"newData\/{}\/{}\".format(t, extension)\n                shutil.copyfile(original_path, target_path)\n","21847656":"fill_color = (255, 255, 255)\nnew_images_dir = \"newData\/\"\n\nfor t in types:\n    for filename in os.listdir(new_images_dir):\n        type_dir = \"{}{}\/\".format(new_images_dir, filename)\n        for pokemon in os.listdir(type_dir):\n            full_path = \"{}\/{}\".format(type_dir, pokemon)\n            file_dir, file_extension = os.path.splitext(full_path)\n            if file_extension == \".png\":\n                im = Image.open(full_path)\n                im = im.convert(\"RGBA\")\n                if im.mode in ('RGBA', 'LA'):\n                    bg = Image.new(im.mode[:-1], im.size, fill_color)\n                    bg.paste(im, im.split()[-1])  # omit transparency\n                    bg.save(\"{}.jpg\".format(file_dir))\n                    os.remove(full_path)\n","30c86a8e":"dir_name = \"newData\/\"\noutput_filename = \"newData\"\n\nshutil.make_archive(output_filename, 'zip', dir_name)\n","1fe5e31f":"batch_size = 16\nimg_height = 120\nimg_width = 120","ddf4a3c3":"train_ds = tf.keras.preprocessing.image_dataset_from_directory(\n  new_images_dir,\n  validation_split=0.2,\n  subset=\"training\",\n  seed=seed,\n  image_size=(img_height, img_width),\n  batch_size=batch_size)","7183e253":"val_ds = tf.keras.preprocessing.image_dataset_from_directory(\n  new_images_dir,\n  validation_split=0.2,\n  subset=\"validation\",\n  seed=seed,\n  image_size=(img_height, img_width),\n  batch_size=batch_size)","b64ff6ff":"class_names = train_ds.class_names\nprint(class_names)","6263e76d":"plt.figure(figsize=(10, 10))\nfor images, labels in train_ds.take(1):\n    for i in range(9):\n        ax = plt.subplot(3, 3, i + 1)\n        plt.imshow(images[i].numpy().astype(\"uint8\"))\n        plt.title(class_names[labels[i]])\n        plt.axis(\"off\")","ac92ec82":"Now we have the data ready for creating model to predict the Pokemon type. Below you can find an example of how you could start building a model on this dataset.","aa236166":"## Model preparation","c1f99948":"Now we are going to compress the \"newData\" directory into a .zip file.","d9848168":"We can see that there are png and jpg images, this is a problem that we will fix further on this notebook.","d17cf478":"Let's get all the different types and store them. These types are the classes we are going to try to predict. (We are going to predict only *Type1*)","40d5b638":"Hope it was useful and I am looking forward to seeing your models!","ee8901e2":"Now we create a new data folder and inside, we create a folder per class.","49668074":"There are png and jpg images so we are going to make all of them jpg since png images have 4 channels but jpg images have 3 (RGB)","8bd00f1b":"In this notebook we are going to prepare the \"Pokemon Image Dataset\" for making models to predict the type of Pokemons.\n\n* Pokemon Image Dataset: https:\/\/www.kaggle.com\/vishalsubbiah\/pokemon-images-and-types","065f6b05":"Copy the original images and paste them on the corresponding class folder.","35ea7dc1":"Let's check if the images are all in the same format.","0140f38b":"# Getting \"Pokemon Image Dataset\" ready for type prediction"}}