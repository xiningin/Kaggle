{"cell_type":{"b33c1bff":"code","8254e941":"code","9c91d869":"code","103f7e01":"code","110c8c24":"code","b9409686":"code","1de96062":"code","a15f397a":"code","1de4cddb":"code","2d2fc4f5":"code","f1c77529":"code","152541de":"code","786312f8":"code","fc4b2066":"code","259368ed":"code","fa1f3399":"code","b35b9fdf":"code","66ead874":"code","8abf628d":"code","4945ed39":"code","46a7a05d":"code","a0a490f6":"code","15efab85":"code","85f0c274":"code","253635ba":"code","fe82a640":"markdown","49dccfdf":"markdown","a0ef8bb1":"markdown","da1d00ad":"markdown","f87a9c53":"markdown","13e1c226":"markdown","1ea94176":"markdown","996cbb67":"markdown","bd4544c3":"markdown","070e5913":"markdown","46deaf5b":"markdown","55f0c30b":"markdown","f7730170":"markdown","d669833e":"markdown"},"source":{"b33c1bff":"import pandas as pd","8254e941":"data = pd.read_csv(\"\/kaggle\/input\/paris-housing-classification\/ParisHousingClass.csv\") ","9c91d869":"data.head()","103f7e01":"data.size","110c8c24":"data.info()\n","b9409686":"data.describe()","1de96062":"from sklearn.preprocessing import LabelEncoder\n\ndata[\"category\"] = LabelEncoder().fit_transform(data[\"category\"])\ndata","a15f397a":"prepared_data = data.copy()","1de4cddb":"prepared_data.info()","2d2fc4f5":"print(prepared_data.isnull().sum())","f1c77529":"housing_category_labels = prepared_data[\"category\"].copy()\nprepared_data = prepared_data.drop([\"category\"], axis=1)\nprepared_data","152541de":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(prepared_data, housing_category_labels, test_size=0.30, random_state=42)","786312f8":"import matplotlib.pyplot as plt\ndata.hist(bins=6, figsize=(20,15))\nplt.show()","fc4b2066":"import plotly.express as px\n\nfig = px.imshow(data.corr())\n\nfig.show()","259368ed":"from sklearn.preprocessing import StandardScaler\n\nneed_scaling = ['squareMeters', 'numberOfRooms', 'floors', 'cityCode', 'made', 'basement', 'attic', 'garage', 'price']\n\nstandard_scaler = StandardScaler()\nprepared_data[need_scaling] = standard_scaler.fit_transform(prepared_data[need_scaling])","fa1f3399":"from sklearn.linear_model import LogisticRegression\nlogreg_model = LogisticRegression(random_state=0, fit_intercept=False).fit(X_train, y_train)","b35b9fdf":"accuracy = logreg_model.score(X_train, y_train)\ntest_accuracy = logreg_model.score(X_test, y_test)\nprint(f\"accuracy: {accuracy}, test_accuracy: {test_accuracy}\")","66ead874":"c_vals = [100, 10, 0.05, 0.001]\nfor c in c_vals:\n    logreg_l1_model = LogisticRegression(C=c, penalty=\"l1\", solver=\"liblinear\", max_iter=2000)\n    logreg_l1_model.fit(X_train, y_train)\n    accuracy = logreg_l1_model.score(X_train, y_train)\n    test_accuracy = logreg_l1_model.score(X_test, y_test)\n    print(f\"c: {c}, accuracy: {accuracy}, test_accuracy: {test_accuracy}\")","8abf628d":"c_vals = [100, 10, 0.05, 0.001]\nfor c in c_vals:\n    logreg_l2_model = LogisticRegression(C=c, penalty=\"l2\", solver=\"lbfgs\")\n    logreg_l2_model.fit(X_train, y_train)\n    accuracy = logreg_l2_model.score(X_train, y_train)\n    test_accuracy = logreg_l2_model.score(X_test, y_test)\n    print(f\"c: {c}, accuracy: {accuracy}, test_accuracy: {test_accuracy}\")","4945ed39":"logreg_model.coef_[0]","46a7a05d":"import numpy as np\nfeatures_relevancy = pd.DataFrame({\n    'feature': X_test.columns,\n    'coef': np.abs(logreg_model.coef_[0])\n})","a0a490f6":"features_relevancy.sort_values(by='coef', ascending=True)","15efab85":"from sklearn.metrics import log_loss\nlog_loss(y_train, logreg_model.predict(X_train))","85f0c274":"log_loss(y_test, logreg_model.predict(X_test))","253635ba":"from sklearn.preprocessing import StandardScaler\nstandard_scaler = StandardScaler()","fe82a640":"## Load the data","49dccfdf":"Las mas relevantes son made y garage","a0ef8bb1":"## 3. Grafique la matriz de correlaci\u00f3n","da1d00ad":"## Relevancia","f87a9c53":"## 2. Realice An\u00e1lisis de los datos (EDA) con gr\u00e1ficos o tablas","13e1c226":"## Check the data","1ea94176":"## 7. Cuales son las 2 caracter\u00edsticas (features) menos relevantes a la hora de realizar la clasificaci\u00f3n.","996cbb67":"## 4. Ajuste un modelo utilizando regresi\u00f3n log\u00edstica","bd4544c3":"### Regularizaci\u00f3n L1 (Lasso)","070e5913":"## 6. Cuales son las 2 caracter\u00edsticas (features) mas relevantes a la hora de realizar la clasificaci\u00f3n","46deaf5b":"las menos relevantes son hasStorageRoom, hasStormProtector","55f0c30b":"### Regularizaci\u00f3n L2 (Ridge)","f7730170":"## 5. Muestre el accuracy del modelo utilizando tanto el train y como el test.","d669833e":"## 1. Separe el dataset en Train y Test"}}