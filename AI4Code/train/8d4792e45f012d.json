{"cell_type":{"9ee508f2":"code","f82f1200":"code","aba26ad3":"code","e79b2463":"code","2f641537":"code","caaa75fd":"code","68658618":"code","2487323b":"code","3143db07":"code","259234a2":"code","ac2564fa":"code","9408ea25":"code","31a6548b":"code","3ed02a1f":"code","d9f9590a":"code","864550ab":"code","dccfdcea":"code","80c5e1a7":"code","9fca4f7c":"code","dbc8ed9c":"code","3cade4ab":"code","7d8a3485":"code","28ef2148":"code","36cabf00":"code","0c22cd32":"code","5bea1867":"code","b9166102":"code","83b26174":"code","e482e91c":"code","66790b9a":"code","c28233de":"code","f5eed644":"code","ce8e4166":"code","82953597":"code","8b20ac35":"code","ea2a1ae6":"code","d4f31d36":"code","05e8a5b8":"code","5b0c08e2":"code","81784c13":"code","5816efd3":"code","946c66ea":"code","dcf02e90":"code","bcd7d5c6":"code","f9f2891d":"markdown","12849f74":"markdown","8068cf6d":"markdown","1a900efb":"markdown","cf8d5145":"markdown","34ff1ede":"markdown","e3ac9981":"markdown","1dde36a4":"markdown","566f0202":"markdown","f90c106e":"markdown","ac715e86":"markdown","2bc7b0a0":"markdown","f53c86ab":"markdown","ddf81cbb":"markdown","8cca9005":"markdown"},"source":{"9ee508f2":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport nltk","f82f1200":"df = pd.read_csv(\"Musical_instruments_reviews.csv\")","aba26ad3":"df.head()","e79b2463":"df.info()","2f641537":"df.columns","caaa75fd":"df.isnull().sum()","68658618":"df['reviewText'].fillna(\"\", inplace = True)","2487323b":"df['reviewText'].isnull().sum()","3143db07":"df['review'] = df['reviewText']+df['summary']","259234a2":"df['review'][0]","ac2564fa":"df.head()","9408ea25":"df = df.drop(['reviewerID','asin','helpful','reviewText','reviewerName','unixReviewTime','reviewTime','summary'],axis=1)","31a6548b":"df.columns","3ed02a1f":"df['overall'].value_counts()","d9f9590a":"def rating(rating):\n    if(int(rating) == 1 or int(rating) == 2 or int(rating) == 3):\n        return 0\n    else: \n        return 1\ndf.overall = df.overall.apply(rating) ","864550ab":"df['overall'].value_counts()","dccfdcea":"from nltk.corpus import stopwords\nfrom nltk.stem.porter import PorterStemmer\nfrom nltk.stem import WordNetLemmatizer\nfrom nltk.tokenize import word_tokenize,sent_tokenize\nimport re\n","80c5e1a7":"import nltk\nnltk.download('stopwords')","9fca4f7c":"import string\nfrom string import punctuation","dbc8ed9c":"stop = set(stopwords.words('english'))\npunctuation = list(string.punctuation)\nstop.update(punctuation)","3cade4ab":"from nltk.corpus import wordnet","7d8a3485":"def get_pos(tag):\n    if tag.startswith('J'):\n        return wordnet.ADJ\n    elif tag.startswith('V'):\n        return wordnet.VERB\n    elif tag.startswith('N'):\n        return wordnet.NOUN\n    elif tag.startswith('R'):\n        return wordnet.ADV\n    else:\n        return wordnet.NOUN","28ef2148":"lemmatizer = WordNetLemmatizer()","36cabf00":"from nltk import pos_tag","0c22cd32":"def lemmatize_words(review):\n    final_review = []\n    for i in review.split():\n        if i.strip().lower() not in stop:\n            pos = pos_tag([i.strip()])\n            word = lemmatizer.lemmatize(i.strip(),get_pos(pos[0][1]))\n            final_review.append(word.lower())\n    return \" \".join(final_review)","5bea1867":"df['review'] = df.review.apply(lemmatize_words)","b9166102":"df['review']","83b26174":"from sklearn.linear_model import LogisticRegression,SGDClassifier\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.svm import SVC\nfrom sklearn.metrics import classification_report,confusion_matrix,accuracy_score\nfrom sklearn.model_selection import train_test_split","e482e91c":"x_train,x_test,y_train,y_test = train_test_split(df.review,df.overall,test_size = 0.2 , random_state = 0)","66790b9a":"from sklearn.feature_extraction.text import CountVectorizer","c28233de":"cv = CountVectorizer(min_df= 0,max_df= 1,binary=False,ngram_range= (1,3))\n\ncv_train_reviews = cv.fit_transform(x_train)\n\ncv_test_reviews = cv.transform(x_test)\n\nprint('cv_train:',cv_train_reviews.shape)\nprint('cv_test:',cv_test_reviews.shape)","f5eed644":"lr = LogisticRegression(penalty= 'l2',max_iter=500,C = 1,random_state= 0)\n \nlr_bow = lr.fit(cv_train_reviews,y_train)\nprint(lr_bow)\n\nlr_tfidf = lr.fit(cv_train_reviews,y_train)\nprint(lr_tfidf)","ce8e4166":"lr_bow_predict = lr.predict(cv_test_reviews)\n\nlr_tfidf_predict = lr.predict(cv_test_reviews)","82953597":"lr_bow_score = accuracy_score(y_test,lr_bow_predict)\nprint(\"lr_bow_score :\",lr_bow_score)\n#Accuracy score\nlr_tfidf_score = accuracy_score(y_test,lr_tfidf_predict)\nprint(\"lr_tfidf_score :\",lr_tfidf_score)","8b20ac35":"lr_bow_report = classification_report(y_test,lr_bow_predict,target_names=['0','1'])\nprint(lr_bow_report)\n\n#Classification report \nlr_tfidf_report = classification_report(y_test,lr_tfidf_predict,target_names=['0','1'])\nprint(lr_tfidf_report)","ea2a1ae6":"mnb = MultinomialNB()\n\nmnb_bow = mnb.fit(cv_train_reviews,y_train)\nprint(mnb_bow)\n\nmnb_tfidf = mnb.fit(cv_train_reviews,y_train)\nprint(mnb_tfidf)","d4f31d36":"mnb_bow_predict = mnb.predict(cv_test_reviews)\n\nmnb_tfidf_predict = mnb.predict(cv_test_reviews)","05e8a5b8":"mnb_bow_score = accuracy_score(y_test,mnb_bow_predict)\nprint(\"mnb_bow_score :\",mnb_bow_score)\nmnb_tfidf_score = accuracy_score(y_test,mnb_tfidf_predict)\nprint(\"mnb_tfidf_score :\",mnb_tfidf_score)","5b0c08e2":"mnb_bow_report = classification_report(y_test,mnb_bow_predict,target_names = ['0','1'])\nprint(mnb_bow_report)\nmnb_tfidf_report = classification_report(y_test,mnb_tfidf_predict,target_names = ['0','1'])\nprint(mnb_tfidf_report)","81784c13":"ls =  SVC()\nls_bow = ls.fit(cv_train_reviews,y_train)\nls_tfidf = ls.fit(cv_train_reviews,y_train)\n\n#predict\nls_bow_predict = ls.predict(cv_test_reviews)\nls_tfidf_predict = ls.predict(cv_test_reviews)\n\n#accuracy\nls_bow_score = accuracy_score(y_test, ls_bow_predict)\nls_tfidf_score = accuracy_score(y_test,ls_tfidf_predict)\n\nprint('ls bow accuracy:', ls_bow_score)\nprint('ls tfidf accuracy:', ls_tfidf_score)","5816efd3":"ls_bow_report = classification_report(y_test,ls_bow_predict,target_names = ['0','1'])\nprint(ls_bow_report)\nls_tfidf_report = classification_report(y_test,ls_tfidf_predict,target_names = ['0','1'])\nprint(ls_tfidf_report)","946c66ea":"df['review'][3]","dcf02e90":"mnb_bow_predict[3]","bcd7d5c6":"\nfrom sklearn.ensemble import VotingClassifier\nlr = LogisticRegression( random_state=0)\nmnb = MultinomialNB()\nls =  SVC()\nmodel = VotingClassifier(estimators=[('lr', lr), ('mnb', mnb), ('ls', ls)], voting='hard')\nmodel.fit(X_train,Y_train)\nmodel.score(X_test,Y_test)","f9f2891d":"# Rating Prediction \n","12849f74":"filling missing values","8068cf6d":"SVM ","1a900efb":"naive bayes MultinomialNB","cf8d5145":"LogisticRegression","34ff1ede":"Cleaning , tokenizing","e3ac9981":"classification_report","1dde36a4":"lemmatizer","566f0202":"classification_report :naive bayes MultinomialNB","f90c106e":"rating 1,2,3 = 0\nrating 4,5 = 1","ac715e86":"model fitting & prediction","2bc7b0a0":"classification_report SVM","f53c86ab":"Dropping ","ddf81cbb":"removing punctuation","8cca9005":"EDA"}}