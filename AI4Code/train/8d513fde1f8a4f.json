{"cell_type":{"e487fd88":"code","6fd7a598":"code","24688146":"code","864dd428":"code","98e33be6":"code","63dff69b":"code","a73620f8":"code","13bc7d03":"code","659453fa":"code","0b77c3c9":"code","4a6d98ef":"code","8c0ced86":"code","202cd837":"code","ca4b54ab":"code","e9bf322f":"code","a8d3f548":"code","ecaa7064":"code","5807081e":"code","924656fe":"code","d0664af7":"code","043f6866":"code","1609deda":"code","dd4db0fd":"code","ebe2f988":"code","bbdc26b4":"code","1814018b":"code","697f3743":"code","d0290de9":"code","4cdeaea9":"code","fe657797":"code","5cb9dc47":"code","fdc01b6c":"code","42896f5e":"code","5502460f":"code","430c9c77":"code","3f3d1a5e":"code","3a0c4e93":"code","14adf35f":"code","61b0ee86":"code","ea124a90":"code","94cbdb19":"code","ae236aaf":"code","1de70f79":"code","f56af9d0":"code","c0454235":"code","42e05854":"code","09e4eaa4":"code","3d9abfe9":"code","880474d5":"code","b3ffaf99":"code","4d1d9804":"code","f1774a77":"code","1ed5dd53":"code","53c1bca7":"code","84873e9d":"code","51689fe4":"code","2712359b":"code","8d37c171":"code","96fd9e6c":"code","c5ab16f9":"code","df561f6a":"code","54b90023":"code","8d8ccf2e":"code","0c22f618":"code","f291dee0":"code","f9d0a897":"code","7e371a42":"code","2a32897a":"code","e2d2f6ba":"code","3e0093b9":"code","b5e721c1":"code","50654ea4":"code","a1a3361b":"code","2a84984d":"code","15ad2b85":"code","4777628e":"code","ab233068":"code","def7005c":"code","12e2540c":"code","94ef5652":"code","c4b81b33":"code","082cbd69":"code","9a7a996e":"code","0f788e7c":"code","52462d69":"code","4043d036":"code","7c79e672":"code","edb2fea5":"code","3ae0667f":"code","6dccc6bb":"code","ad91e5b5":"code","0094342f":"code","1fe26754":"code","47aa4c41":"code","09fd0910":"code","31d002cf":"code","261044df":"code","b9df5632":"code","9bd0c87d":"code","81dd8e47":"code","e08b81ee":"code","84984fff":"code","7fafdb1c":"code","937182e3":"code","ddff7ad3":"code","06ef1557":"code","e90e0f38":"code","848d857a":"code","d0fdf433":"code","06da8b7b":"markdown","8cadbb45":"markdown","3a08d613":"markdown","fadb382a":"markdown","daadb201":"markdown","52c2002c":"markdown","71e5f645":"markdown","ff25bc48":"markdown","5ca7c77c":"markdown","0323e18e":"markdown","90b42500":"markdown","58abe3d4":"markdown","481f65d5":"markdown","52630b2b":"markdown","d426de12":"markdown","0a8b5f4e":"markdown","6096b491":"markdown","6c5a642f":"markdown","820fd812":"markdown","6a9a470d":"markdown","1890e976":"markdown","f96d89b1":"markdown","4c5b380a":"markdown","d9331c47":"markdown","d67b0744":"markdown","40642f91":"markdown"},"source":{"e487fd88":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","6fd7a598":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport matplotlib\nimport seaborn as sns\nfrom scipy import stats\nfrom scipy.stats import norm\nimport warnings\nwarnings.filterwarnings('ignore',category=DeprecationWarning)","24688146":"df1 = pd.read_csv(\"\/kaggle\/input\/brasilian-houses-to-rent\/houses_to_rent_v2.csv\")","864dd428":"df1.head()","98e33be6":"df1.info()","63dff69b":"df1.columns","a73620f8":"df1.describe()","13bc7d03":"df1.isnull().sum()","659453fa":"df1.isnull().describe()","0b77c3c9":"df1.rename(columns={'hoa (R$)':'hoa','rent amount (R$)':'rent amount','property tax (R$)':'property tax','fire insurance (R$)':'fire insurance','total (R$)':'total'},inplace=True)","4a6d98ef":"df1","8c0ced86":"df1['city'].unique()","202cd837":"df1.floor.unique()","ca4b54ab":"df1['floor']=df1['floor'].replace('-',1)\ndf1['floor']=df1['floor'].apply(lambda x:int(x))","e9bf322f":"df1.floor.unique()","a8d3f548":"df1[df1['floor']==51]","ecaa7064":"df1[(df1['city']=='Campinas') & (df1['floor']>20)]","5807081e":"This tells that 'Campinas' city has generally no building with floor value greater than 20. Again this is an outlier.\n","924656fe":"df1.floor.value_counts()","d0664af7":"df1[df1['floor']>45]","043f6866":"\ndf1=df1[df1['floor']<45]","1609deda":"df1.describe()","dd4db0fd":"corr=df1.corr()\ncorr['total']","ebe2f988":"fig = plt.figure(figsize=(12,12))\nsns.heatmap(corr, cmap = 'Wistia', annot= True);","bbdc26b4":"df2=df1.drop('floor',axis='columns')","1814018b":"df2.head()","697f3743":"Convert the categorical columns to numerical columns.:","d0290de9":"animal_info=pd.DataFrame()\nanimal_info['name']=df2.animal.unique()\nanimal_info['label']=[1,0]\nanimal_info","4cdeaea9":"df2['animal']=df2['animal'].replace({'acept':1,'not acept':0})","fe657797":"df2.head()","5cb9dc47":"df2.animal.describe()","fdc01b6c":"furniture_info=pd.DataFrame()\nfurniture_info['name']=df2.furniture.unique()\nfurniture_info['label']=[1,0]\nfurniture_info","42896f5e":"df2['furniture']=df2['furniture'].replace({'furnished':1,'not furnished':0})","5502460f":"city_info=pd.DataFrame(df2['city'].unique())\ncity_info","430c9c77":"from sklearn import preprocessing\nle = preprocessing.LabelEncoder()\ndf2['city']=le.fit_transform(df2['city'])","3f3d1a5e":"city_info['label']=df2['city'].unique()","3a0c4e93":"city_info","14adf35f":"df2.head()","61b0ee86":"df2.mode()","ea124a90":"animal_info","94cbdb19":"df2.animal.value_counts()","ae236aaf":"size = [df2.animal.value_counts()]\nlabels = ['acept', 'not acept']\nplt.pie(size, labels = labels, shadow = True, explode = [0, 0.1],radius=1)\nplt.legend()\nplt.title('Animal Pet Acceptance', fontsize = 20)\nplt.show()\nplt.tight_layout()","1de70f79":"ax = df2['animal'].value_counts().plot(kind = 'bar',figsize = (8,6),color = 'brown')\nax.set_title('Accept or not animals in the $House$', fontsize = 22)\nax.set_xlabel('Y or N', fontsize = 15)\nax.set_ylabel('Quantitiy of houses' , fontsize = 15)\nplt.show()","f56af9d0":"ax = df2['city'].value_counts().plot(kind = 'bar',figsize = (10,8),color = 'yellow')\nax.set_title('Accept or not animals in the $House$', fontsize = 22)\nax.set_xlabel('Y or N', fontsize = 15)\nax.set_ylabel('Quantitiy of houses' , fontsize = 15)\nplt.show()","c0454235":"ax = df2['furniture'].value_counts().plot(kind = 'bar',figsize = (10,8),color = 'green')\nax.set_title('furnish or not', fontsize = 22)\nax.set_xlabel('Y or N', fontsize = 15)\nax.set_ylabel('Quantitiy of houses' , fontsize = 15)\nplt.show()","42e05854":"sns.boxplot(x = 'city', y ='total', data = df2)","09e4eaa4":"city_group = df2.groupby('city')['total']\ntype(city_group)","3d9abfe9":"Q1 = city_group.quantile(.25)\nQ3 = city_group.quantile(.75)\nIIQ = Q3 - Q1  \nlower_limit = Q1 - 1.5* IIQ\nupper_limit = Q3 + 1.5* IIQ\n","880474d5":"Q1","b3ffaf99":"Q3","4d1d9804":"city_group.groups.keys()","f1774a77":"new_data = pd.DataFrame()\n\nfor city in city_group.groups.keys():\n    is_city = df2['city'] == city\n    accepted_limit = ((df2['total'] >= lower_limit[city]) &\n                     (df2['total'] <= upper_limit[city]))\n    \n    select = is_city & accepted_limit\n    data_select = df2[select]\n    new_data = pd.concat([new_data, data_select])\n\ndf3=new_data","1ed5dd53":"df3","53c1bca7":"sns.boxplot(x = 'city', y ='total', data = df3)","84873e9d":"fig = plt.figure(figsize=(10,10))\ncorr = df3.corr()\nsns.heatmap(corr, cmap = 'Wistia', annot= True);","51689fe4":"area = plt.figure()\ng1 = area.add_subplot(2,2,1)\ng2 = area.add_subplot(2,2,2)\ng3 = area.add_subplot(2,2,3)\ng4 = area.add_subplot(2,2,4)\ng1.scatter(df3['fire insurance'], df3['total'])\ng1.set_title('Fire insurance x total')\ng2.scatter(df3['property tax'],df3['total'])\ng2.set_title('property x total')\ng3.scatter(df3['rent amount'],df3['total'])\ng3.set_title('rent R$ x total')\ng4.scatter(df3['bathroom'],df3['total'])\ng4.set_title('bathrooms x total')","2712359b":"plt.scatter(df3['parking spaces'], df3['total'])","8d37c171":"sns.distplot(df3['total'])","96fd9e6c":"sns.distplot(df3['total'], fit=norm);\n\n(mu, sigma) = norm.fit(df3['total'])\nprint( '\\n mu = {:.2f} and sigma = {:.2f}\\n'.format(mu, sigma))\nplt.legend(['Normal dist. ($\\mu=$ {:.2f} and $\\sigma=$ {:.2f} )'.format(mu, sigma)],\n            loc='best')\nplt.ylabel('Frequency')\nplt.title('total (R$) distribution')","c5ab16f9":"fig = plt.figure()\nstats.probplot(df3['total'], plot=plt)\nplt.show()","df561f6a":"plt.scatter(y =df3['total'],x = df3.area,c = 'black')\nplt.show()","54b90023":"Q1 = df3.quantile(0.25)\nQ3 = df3.quantile(0.75)\nIQR = Q3- Q1\nprint(IQR, df3.shape)","8d8ccf2e":"Q1 = df3['area'].quantile(0.25)\nQ3 = df3['area'].quantile(0.75)\nIQR = Q3- Q1\n","0c22f618":"df3= df3[~((df3['area'] < (Q1 - 5*IQR)) | (df3['area'] > (Q3 + 5*IQR)))]\ndf3.shape","f291dee0":"fig, axs = plt.subplots(ncols=2, figsize=(15,5))\nsns.boxplot(x=df3['area'], ax = axs[0])\nsns.boxplot(x=df3['rent amount'], ax = axs[1])\n\nplt.show()","f9d0a897":"plt.figure(figsize=(15,15))\nc = df3.corr()\nsns.heatmap(c,cmap='Blues', annot=True)\n","7e371a42":"from numpy import mean\n\nplt.figure(figsize = (10,4))\nsns.barplot(data = df3, x='city', y='total', estimator=mean, palette = \"Blues\")\nplt.ylabel('Avg Rent Amount')\nplt.xlabel('')\nplt.title('Average total')\nplt.legend('')\n\nplt.figure(figsize = (10,4))\nsns.barplot(x='city', y='total', data = df3, hue = 'animal', palette='Blues', estimator = mean)\nplt.ylabel('Avg total')\nplt.title('Average total by City and by Animal Acceptance')\n\nplt.figure(figsize = (10,4))\nsns.barplot(x='city', y='total', data = df3, hue ='furniture', palette='Blues', estimator = mean)\nplt.ylabel('Avg total')\nplt.title('Average total by City and by furniture')\n\nplt.figure(figsize = (10,4)) \nsns.barplot(x='parking spaces', y='total', data = df3, palette='Blues', estimator=mean)\nplt.ylabel('Avg total')\nplt.title('Averace total by n. of Parking Spaces')\nplt.show()\n\nplt.figure(figsize = (10,4))\nsns.barplot(x='city', y='area', data = df3, palette='Blues', estimator = mean)\nplt.ylabel('Avg area')\nplt.title('Average total by City and by area ')\n","2a32897a":"df4=df3","e2d2f6ba":"df4.shape","3e0093b9":"c=df4.corr()","b5e721c1":"c['total']","50654ea4":"df4.describe()","a1a3361b":"df4['area'].mean()","2a84984d":"df4['area'].max()","15ad2b85":"df4['area'].min()","4777628e":"df4[df4['area']<15]","ab233068":"df4[df4['area']>600]","def7005c":"df5=df4\ntype(df5)","12e2540c":"df5[(df5.area\/df5.rooms)<15]","94ef5652":"df5.shape","c4b81b33":"df5","082cbd69":"df5=df5[df5.area\/df5.rooms>15]","9a7a996e":"df5","0f788e7c":"df5.shape","52462d69":"df5[df5.area\/df5.rooms>200]","4043d036":"df5=df5[df5.area\/df5.rooms<200]","7c79e672":"df5","edb2fea5":"df5.shape","3ae0667f":"c=df5.corr()\nc['total']","6dccc6bb":"df5=df5.drop(['furniture','animal'],axis='columns')","ad91e5b5":"x=df5.drop('total',axis='columns')\ny=df5['total']\nfrom sklearn.feature_selection import SelectKBest\nfrom sklearn.feature_selection import chi2\nfrom sklearn.preprocessing import MinMaxScaler\nX_norm = MinMaxScaler().fit_transform(x)\nchi_selector = SelectKBest(chi2, k=7)\nchi_selector.fit(X_norm, y)\nchi_support = chi_selector.get_support()\nchi_feature = x.loc[:,chi_support].columns.tolist()\nchi_feature","0094342f":"df6=df5.drop(['parking spaces','property tax'],axis='columns')","1fe26754":"df6","47aa4c41":"X=df6.drop('total',axis='columns')","09fd0910":"X","31d002cf":"y=df6['total']","261044df":"y","b9df5632":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.2,random_state=10)","9bd0c87d":"from sklearn.model_selection import GridSearchCV\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.linear_model import Lasso\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.model_selection import ShuffleSplit\nfrom sklearn.model_selection import cross_val_score\n\ndef find_best_model_using_gridsearchcv(X,y):\n    algos = {\n        'linear_regression' : {\n            'model': LinearRegression(),\n            'params': {\n                'normalize': [True, False]\n            }\n        },\n        'lasso': {\n            'model': Lasso(),\n            'params': {\n                'alpha': [1,2],\n                'selection': ['random', 'cyclic']\n            }\n        },\n        'decision_tree': {\n            'model': DecisionTreeRegressor(),\n            'params': {\n                'criterion' : ['mse','friedman_mse'],\n                'splitter': ['best','random']\n            }\n        }\n    }\n    scores = []\n    cv = ShuffleSplit(n_splits=5, test_size=0.2, random_state=0)\n    for algo_name, config in algos.items():\n        gs =  GridSearchCV(config['model'], config['params'], cv=cv, return_train_score=False)\n        gs.fit(X,y)\n        scores.append({\n            'model': algo_name,\n            'best_score': gs.best_score_,\n            'best_params': gs.best_params_\n        })\n\n    return pd.DataFrame(scores,columns=['model','best_score','best_params'])\n\nfind_best_model_using_gridsearchcv(X,y)","81dd8e47":"from sklearn.linear_model import LinearRegression\nmodel = LinearRegression(normalize=True)\nmodel.fit(X_train,y_train)\nscore=model.score(X_test,y_test)\nscore","e08b81ee":"model.coef_","84984fff":"model.intercept_","7fafdb1c":"city_info","937182e3":"def predict_price(city,area,rooms,bathroom,hoa,rent_amount,fire_insurance):\n    total_price=model.predict([[city,area,rooms,bathroom,hoa,rent_amount,fire_insurance]])\n    return total_price","ddff7ad3":"predict_price(0,150,4,5,1300,1500,1000)","06ef1557":"predict_price(1,150,4,5,1300,1500,1000)","e90e0f38":"predict_price(2,150,4,5,1300,1500,1000)","848d857a":"predict_price(3,150,4,5,1300,1500,1000)","d0fdf433":"predict_price(4,150,4,5,1300,1500,1000)","06da8b7b":"### **Conclusion:**\nHence, We successfully build a model for predicting total amount for renting house in brazil in differnt cities.","8cadbb45":"## **Important process followed :**\n*   Dataset Preparation and Preprocessing\n*   Model Training\n*   Model Testing and Evaluation\n*   Conclusion","3a08d613":"##  **Introduction:**\n\nBrasilian Housing is an Public dataset.\n In this dataset there are total 13 features and 10692 data-points.\n\nWe have house info like  city, area, rooms, parking space etc. \nOn this basis we have to predict the \u201ctotal\u201d rent of house.\nHere target variable is \u201ctotal (R$)\u201d column.","fadb382a":"Lets explore area feature:","daadb201":"## **Dataset Information:**\n\nBrazil Housing is an Public dataset.\n In this dataset there are total 13 features and 10692 data-points.\n\nThe features columns in the dataset are:\n1. city - city located\n2. area - area of house\n3.    rooms - quantity of rooms\n4.   bathroom - quantity of bathrooms\n5.    parking spaces - quantity of parking spaces\n6.    floor - floor\n7.    animal - acept animals or not\n8.    furniture - furnish or not\n9.    hoa - Homeowners association tax\n10.    property tax - property tax\n1.   rent amount - rental price\n1.    fire insurance - fire insurance\n1.    total - total value\n","52c2002c":"consider,\nUsually room need minimum 15 unit of area and maximum 200 unit. those data values which are beyond this values are certainly outliers.\nlets explore them and clean the data:","71e5f645":"here, floor has value= 301, which is impossible. This is a outlier.","ff25bc48":"## Lets explore animal feature:","5ca7c77c":"furniture is categorical feature.we will convert this categorical feature to Numerical feature by simple labling.\n1: furnished\n0: not furnished","0323e18e":"below is the correlation of differnt features with total from our cleaned data","90b42500":"To apply the other algorithms and check the accuracy with differnt parameters we will define python function.we will use cross_val_score to increase accuracy by training data in n_splits.\n\n**We will apply following algorithms:**\n*   Linear Regression\n*   Logistic Regression\n*   lasso\n*   Desicion tree\n\n\n","58abe3d4":"lets remove those outlier","481f65d5":"heatmap shows that there is strong relationship between following components:\n\n\n*   fire insurance and rent amount\n*   fire insurance and total\n*   total and rent amount\n*   room and total\n*   room and bathroom\n*  hoa and total\n\nlets explore them with graphical view:\n\n","52630b2b":"This shows that  is linear regression is giving maximum accuracy. So we will select it for further process.","d426de12":"This shows the total amount variation in differnt cities.\nalso one can easily observe that our dataset contains various outliers.","0a8b5f4e":"# **Split the data into training and testing:**\nwe will keep test size as 20% of data.","6096b491":"Floor column consists of '-' value. to convert it to numerical, we will replace it with 1 (minimum value). \n\nAlso we will convert this categorical feature to Numerical feature for computation purpose.","6c5a642f":"In above cases we predict price for same data in differnt cities. And as expected, prices are high in city no '4' ie. 'S\u00e3o Paulo'","820fd812":"### **Data preprocessing, Data cleaning, Model Preparation, Model Fitting:**\n\nfollowing are the steps:\n1.   Read the file and explore dataset.\n2.  Preprocess the data and feature engineering:(Perform an exploratory analysis of the data in order to gain insights and    choose the best features )\n  1.   Check the null values from the dataset and handle them appropriately. \n  2.   Remove the insignificant columns from the dataset if necessary.\n  1.  Convert the categorical columns to numerical columns.\n  1.   labelling \n2. Perform EDA on the dataset using visualization such as bar plot ,  Box  plot , count plot etc. \n2.Split the data into training and testing.\n1.train the model with differnt regression techniques.\n2. Observe the accuracy of each model and conclude which model gives the maximum accuracy.\n1.select model with maximum accuracy and test the data.","6a9a470d":"## **our model has 99.15% of accuracy**","1890e976":"Above, plot is the boxplot for new data after removing outliers with respect to city and total.\nplot shows that our data is pretty good and one can observe that city named '4' which is S\u00e3o Paulo' has comparitively higher prices which is making it costly city.","f96d89b1":"This is how we have removed outliers.","4c5b380a":"# **Convert the categorical columns to numerical columns.:**\nanimal is categorical feature.we will convert this categorical feature to Numerical feature by simple labling.\n1: acept\n0: not acept","d9331c47":"lets create X and y for model preparation:","d67b0744":"##  **Objective:**\nIn this notebook, we are supposed to clean data,exploratory data analysis , feature engineering, data treatment and application of Machine Learning models to predict the 'total (R$)'.\n","40642f91":"lets explore to floor feature\n"}}