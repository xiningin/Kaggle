{"cell_type":{"d00ab4c0":"code","a415507e":"code","9f80037e":"code","ecf72044":"code","6915f3e5":"code","9533c0ef":"code","f43dd681":"code","1f6128cb":"code","16a83191":"code","bdb576fc":"code","4c02e06f":"code","0d87937e":"code","e7b681d2":"code","2773f128":"code","5ad1da11":"code","69c708fc":"code","04b4aed6":"code","98218562":"code","684e1a62":"code","4b37f707":"code","5362b985":"code","6e5c11c4":"code","9039b27c":"code","b43be852":"code","b32cdafb":"markdown","753d8bcd":"markdown","0c528b0c":"markdown","edeff585":"markdown","3ba53e59":"markdown","93cae077":"markdown","2cda0163":"markdown","cbabc07f":"markdown","39068076":"markdown","4f034a8c":"markdown","ef76c6ac":"markdown","41deb882":"markdown","4fad23c5":"markdown"},"source":{"d00ab4c0":"from sklearn.datasets import load_iris\nfrom sklearn.datasets import load_boston\nfrom sklearn.preprocessing import normalize\n\nfrom sklearn.feature_selection import f_regression\nfrom sklearn.feature_selection import f_classif\n\nfrom sklearn.feature_selection import mutual_info_classif \nfrom sklearn.feature_selection import mutual_info_regression\n\nfrom sklearn.feature_selection import VarianceThreshold\n\nfrom sklearn.linear_model import Lasso\n\nfrom sklearn.feature_selection import SelectKBest\nfrom sklearn.feature_selection import chi2\n\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt","a415507e":"X, y = load_iris(return_X_y=True)","9f80037e":"level_sign = 0.05\nnp.where(f_classif(X, y)[1] < level_sign)[0] ","ecf72044":"def add_random_col(X, num_cols=2):\n    col_rand = np.random.rand(X.shape[0], num_cols).reshape(-1, num_cols)\n    return np.concatenate((X, col_rand), axis=1)","6915f3e5":"# add 2 more random columns with random values\nX_new = add_random_col(X)\nX_new.shape, X.shape","9533c0ef":"np.where(f_classif(X_new, y)[1] < level_sign)[0] ","f43dd681":"X, y = load_boston(return_X_y=True)","1f6128cb":"np.where(f_regression(X, y)[1] < level_sign)[0]","16a83191":"# also add new random columns\nX_new = add_random_col(X)\nX_new.shape, X.shape","bdb576fc":"np.where(f_regression(X_new, y)[1] < level_sign)[0]","4c02e06f":"X, y = load_iris(return_X_y=True)\nmutual_info_classif(X, y, random_state=42)","0d87937e":"X_new = add_random_col(X)\nmutual_info_classif(X_new, y, random_state=42)","e7b681d2":"X, y = load_boston(return_X_y=True)\nmutual_info_regression(X, y, random_state=42)","2773f128":"X_new = add_random_col(X)\nmutual_info_regression(X_new, y, random_state=42)","5ad1da11":"threshold = 0.3\nnp.where(mutual_info_regression(X_new, y) > threshold)[0]","69c708fc":"X, _ = load_iris(return_X_y=True)\n# need to normalize to make std equal to 1\nX_norm = normalize(X, norm='l2', axis=0)\nvar_threshold = VarianceThreshold(threshold=0.001)","04b4aed6":"var_threshold.fit(X_norm)\nvar_threshold.get_support()","98218562":"X, y = load_boston(return_X_y=True)\nlasso = Lasso()\nlasso.fit(X, y)","684e1a62":"lasso.coef_","4b37f707":"X_new = add_random_col(X)\nlasso.fit(X_new, y)","5362b985":"lasso.coef_","6e5c11c4":"threshold = 0.05\nnp.where(abs(lasso.coef_) > threshold)[0]","9039b27c":"k = 10\nselectKBest = SelectKBest(score_func=chi2, k=10)\nselectKBest.fit(X_new, y.astype('int'))\nnp.array(pd.DataFrame(selectKBest.scores_).sort_values(by=0, ascending=False).iloc[:k, :].index)","b43be852":"plt.figure(figsize=(20,20))\nsns.heatmap(pd.DataFrame(X_new).corr(),annot=True,cmap=\"RdYlGn\");","b32cdafb":"Classification","753d8bcd":"Regression","0c528b0c":"<h3>SelectKBest using chi2<\/h3>","edeff585":"<h2>Filter<\/h2>\n\n<h3>F test<\/h3>","3ba53e59":"<h3>Lasso Regression<\/h3>","93cae077":"Why feature selection is importamnt:\n1. Time of learning\n2. Model's overfitting\n3. Improve accuracy","2cda0163":"<h3>Variance Threshold<\/h3>","cbabc07f":"<h3>Feature Importance<\/h3>\n\nI hope everyone knows about it","39068076":"![](http:\/\/)I don't know how to take a right threshold :((","4f034a8c":"<h3>Mutual Information<\/h3>","ef76c6ac":"https:\/\/towardsdatascience.com\/why-how-and-when-to-apply-feature-selection-e9c69adfabf2\nhttps:\/\/towardsdatascience.com\/feature-selection-techniques-in-machine-learning-with-python-f24e7da3f36e","41deb882":"We may take some threshold to select appropriate features","4fad23c5":"<h3>Corretaion Heat Map<\/h3>\n\nPrevent too correlated fetures between each other"}}