{"cell_type":{"7faac4a5":"code","6ba2f068":"code","74fe7e3d":"code","3499d39b":"code","6bbae01e":"code","6840633d":"code","4edbaffc":"code","1febc816":"code","17c014c8":"code","a9b5e782":"code","7e895833":"code","e461ecf5":"code","2591d68f":"code","432790d6":"code","6c7f67ec":"code","24c7a532":"code","2346ec1c":"code","606347e8":"code","82b50436":"code","7771b2e0":"code","c46a1c6e":"code","e800d656":"code","9424f595":"code","8020ae50":"code","22287ec7":"code","743bd4b2":"code","ea8a1211":"code","cb005822":"code","6dfc4d68":"code","40642cd2":"code","a9531994":"markdown","7d5a8a61":"markdown"},"source":{"7faac4a5":"#Importing Linraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport tensorflow as tf\nimport keras","6ba2f068":"#Reading dataset\ndata_set = pd.read_csv('..\/input\/foreign-exchange-rates-per-dollar-20002019\/Foreign_Exchange_Rates.csv', na_values='ND')","74fe7e3d":"data_set.shape","3499d39b":"#Dataset head\ndata_set.head()","6bbae01e":"#Checking null values\ndata_set.isnull().sum()","6840633d":"data_set.interpolate(inplace=True)\ndata_set.isnull().sum()","4edbaffc":"#Plotting Indian Exchange rate\nplt.plot(data_set['INDIA - INDIAN RUPEE\/US$'])","1febc816":"#Data frame\ndf = data_set['INDIA - INDIAN RUPEE\/US$']","17c014c8":"print(df)","a9b5e782":"#Preprocessing data set\ndf = np.array(df).reshape(-1,1)","7e895833":"df","e461ecf5":"from sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()","2591d68f":"df = scaler.fit_transform(df)","432790d6":"df","6c7f67ec":"#Training and test sets\ntrain = df[:4800]\ntest = df[4800:]\n\nprint(train.shape)\nprint(test.shape)","24c7a532":"def get_data(data, look_back):\n  datax, datay = [],[]\n  for i in range(len(data)-look_back-1):\n    datax.append(data[i:(i+look_back),0])\n    datay.append(data[i+look_back,0])\n  return np.array(datax) , np.array(datay)","2346ec1c":"look_back = 1\n\nx_train , y_train = get_data(train, look_back)\nprint(x_train.shape)\nprint(y_train.shape)","606347e8":"x_test , y_test = get_data(test,look_back)\nprint(x_test.shape)\nprint(y_test.shape)","82b50436":"#Processing train and test sets for LSTM model\nx_train = x_train.reshape(x_train.shape[0],x_train.shape[1], 1)\nx_test = x_test.reshape(x_test.shape[0],x_test.shape[1], 1)","7771b2e0":"print(x_train.shape)\nprint(x_test.shape)\n","c46a1c6e":"#Defining the LSTM model\nfrom keras.models import Sequential\nfrom keras.layers import Dense,LSTM\n","e800d656":"n_features=x_train.shape[1]\nmodel=Sequential()\nmodel.add(LSTM(100,activation='relu',input_shape=(1,1)))\nmodel.add(Dense(n_features))","9424f595":"model.summary()","8020ae50":"#Compiling\nmodel.compile(optimizer='adam', loss = 'mse')","22287ec7":"#Training\nmodel.fit(x_train,y_train, epochs = 5, batch_size=1)","743bd4b2":"#Prediction using the trained model\nscaler.scale_","ea8a1211":"y_pred = model.predict(x_test)\ny_pred = scaler.inverse_transform(y_pred)\nprint(y_pred[:10])","cb005822":"#Processing test shape\ny_test = np.array(y_test).reshape(-1,1)\ny_test = scaler.inverse_transform(y_test)\nprint(y_test[:10])","6dfc4d68":"#Visualizing the results\nplt.figure(figsize=(10,5))\nplt.title('Foreign Exchange Rate of India')\nplt.plot(y_test , label = 'Actual', color = 'g')\nplt.plot(y_pred , label = 'Predicted', color = 'r')\nplt.legend()","40642cd2":"from sklearn.metrics import mean_squared_error\nmean_squared_error(y_test, y_pred)","a9531994":"# Foreign Exchange Rate Prediction using LSTM Recurrent Neural Network","7d5a8a61":"We will implement the LSTM Recurrent Neural Network to predict the foreign exchange rate. The LSTM model will be trained to learn the series of previous observations and predict the next observation in the sequence. We will apply this model in predicting the foreign exchange rate of India."}}