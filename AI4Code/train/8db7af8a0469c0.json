{"cell_type":{"03ecf953":"code","580664d0":"code","2e889f23":"markdown"},"source":{"03ecf953":"#------------------------------------------------------\n#Imported modules\n#------------------------------------------------------\nimport sqlite3\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n#------------------------------------------------------\n#------------------------------------------------------\n\nSQL_DB_NAME = 'db.sqlite'\ncon = sqlite3.connect(SQL_DB_NAME)\n\n\nvalues_a = [['101',25],\n           ['102',107],\n           ['103',40]]\n\nvalues_b = [['101',3],\n           ['102',2],\n           ['103',5]]\n\ntbla = pd.DataFrame(values_a,columns=['id','qty'])\ntblb = pd.DataFrame(values_b,columns=['id','customers'])\n\ntbla.to_sql('apples',con=con,if_exists='replace',index=False)\ntblb.to_sql('oranges',con=con,if_exists='replace',index=False)\n\nstma = 'SELECT id, qty, RANK() OVER (ORDER BY qty) as rank_qty FROM apples'\nstmb = 'SELECT id, RANK() OVER (ORDER BY customers) as rank_customers FROM oranges'\n\nstmc = 'SELECT tb1.id, tb1.rank_qty, tb2.rank_customers FROM ('+stma+') As tb1 '\nstmc = stmc + 'INNER JOIN ('+stmb+') as tb2 ON tb1.id=tb2.id;'\n\nqry = pd.read_sql_query(stmc,con=con)\n\nqry","580664d0":"stmc","2e889f23":"This notebook shows an example of the SQL statement for joining two tables which each have their own sub-calculated fields using the RANK() function."}}