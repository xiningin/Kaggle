{"cell_type":{"fc800b77":"code","065cf6ae":"code","1437d0f0":"code","b42f999e":"code","4f770eaf":"markdown","fe5ef87a":"markdown","9a4016f3":"markdown","17b4f869":"markdown"},"source":{"fc800b77":"# run each cell by Shift+Enter\n# daily_infected returns the number of infected in a given region under the assumptions 1-3. \n\ndayshift = 16\n\ndef estimation(timeseries, multiplier=100.0\/4.0, shift=dayshift):      \n    timeseries = multiplier * timeseries\n    timeseries[:-shift] = timeseries[shift:]\n    timeseries[-shift:] = 0\n    return timeseries\n\nimport pandas as pd    \nimport numpy as np    \nimport matplotlib.pyplot as plt\nfrom IPython.display import Image\nglobal ax\n\n%matplotlib inline \nplt.rcParams['figure.figsize'] = 14, 10\n\n\ndf = pd.read_csv('\/kaggle\/input\/corona-virus-report\/covid_19_clean_complete.csv') \n\ncountries = list(df['Country\/Region'].unique())\ndef smooth(time_series,eps=0.2):    # this function smooths timeseries by three elements\n    timeseries = np.zeros(len(time_series)+2)\n    timeseries[1:-1] = np.array(time_series)\n    timeseries[0], timeseries[-1] = timeseries[1], timeseries[-2]\n    return pd.Series(eps*timeseries[:-2]+(1-2*eps)*timeseries[1:-1]+eps*timeseries[2:])\n\ndef smooth5(timeseries,eps=0.15):   # this function smooths timeseries by five elements\n    timeseries = np.zeros(len(time_series)+4)\n    timeseries[2:-2] = np.array(time_series)\n    timeseries[0], timeseries[1], timeseries[-2], timeseries[-1] = timeseries[2], timeseries[2], timeseries[-3], timeseries[-3]\n    return pd.Series(eps*timeseries[:-4]+(1\/3-eps\/3)*timeseries[1:-3]+(1\/3-4*eps\/3)*timeseries[2:-2]+(1\/3-eps\/3)*timeseries[3:-1]+eps*timeseries[4:])\n\ndef cum2daily(time_series):      # this function is an inverse of cummulative summation\n    timeseries = np.zeros(len(time_series)+1)\n    timeseries[1:] = np.array(time_series)\n    timeseries[0] = timeseries[1]\n    return pd.Series(timeseries[1:]-timeseries[:-1])\n\ndef show_with_dates(columns,dates, label):\n    columns = pd.DataFrame(columns, columns=[label])\n    columns['Date']=dates.reset_index()['Date'] \n    return columns.set_index('Date')\n\ndef show_est(data,vert_lines,d_rate=4.0,smooth_koef=0.0,shift_deaths_day=17,shift_confirm_day=5): \n    plt.figure(figsize=(14, 14), dpi=50)\n    confirmed_per_day = estimation(cum2daily(smooth(data['Confirmed'],smooth_koef)),\n                                   multiplier=4.0,shift=shift_confirm_day)\n    ax = show_with_dates(confirmed_per_day[:-shift_confirm_day],\n         data['Date'],'Infected per day, estimation by confirmed').plot.line()\n\n    infected_per_day = estimation(cum2daily(smooth(data['Deaths'],smooth_koef)),\n                                  multiplier=100.00\/d_rate,shift=shift_deaths_day)\n    show_with_dates(infected_per_day[:-shift_deaths_day],\n         data['Date'],'Infected per day, estimation by deaths').plot.line(ax=ax)\n\n    scale = max(confirmed_per_day)\n    ax.xaxis.set_ticks(range(0,len(data['Date'])))\n    ax.set_xticklabels(list(data['Date']), rotation=90)\n    \n    for day, y, text, color in vert_lines:\n            plt.axvline(x=day,color=color)\n            ax.text(day+0.5, scale * y, text,\n                verticalalignment='bottom', \n                horizontalalignment='left',\n                color='blue', fontsize=10)   \n    plt.show()\n    \n    return\n","065cf6ae":"print('Current data set is \"covid_19_clean_complete.csv\" from kaggle.com by Devakumar KP')\nprint('data from ',df[:1]['Date'].to_string(index=False),' till ', df[-1:]['Date'].to_string(index=False))","1437d0f0":"### 2.1 Greece","b42f999e":"country = 'Greece'\nregion_df = df[df['Country\/Region']==country]\n \nshow_est(region_df,[[9, 0.8, ' The coronavirus pandemic first appeared in Greece on 26 February 2020', 'black'],\n                    [46, 0.75, 'On 9 March, all school trips were banned, all school championships were cancelled', 'black'],\n                    [48, 0.5,'Starting on 10 March, all educational institutions were closed for 14 days', 'black'],\n                    [48, 0.3,'On 12 March, a two-week closure of all theatres, courthouses, cinemas, gyms, playgrounds and clubs was announced', 'black'],\n                    [49, 0.4,'On 16 March, Greece closed its borders with Albania and North Macedonia, deciding to suspend all road, sea and air links with these countries', 'black'],\n                    [51, 0.55,'On 18 March, Deputy Minister of Civil Protection and Crisis Management Nikos Hardalias announced a ban on public gatherings of 10 or more people and the imposition of a 1,000 euro fine on violators', 'black'],\n                    [53, 0.6,'On 19 March, the government announced the closure of all hotels across the country, from midnight on March 22 and until the end of April', 'black'],\n                    [54, 0.7,'On 20 March, only permanent residents and supply trucks would be allowed to travel to the Greek islands, with effect from 6am local time on 21 March', 'black'],\n                    [55, 0.8,'On 22 March, a ban on all nonessential transport and movement across the country, starting from 6 a.m on 23 March until 6 April', 'black'],\n                                       \n                   ],d_rate=10.0,smooth_koef=0.0,shift_deaths_day=18,shift_confirm_day=6)\n#plt.yscale('log')\n\n\n# https:\/\/en.wikipedia.org\/wiki\/2020_coronavirus_pandemic_in_Greece","4f770eaf":"## 1. Introduction \n\nWe are estimating the number of actual infected people per day in the region. The median time from first symptom to death was estimated as 19-20 days from statistics [1, 2]. The median mortality is 4% and depends on the epidemic peak height, medical resources and patients age distribution [3].     \nAlso we assume three simplifications \n1. Assumption. The mortality rate in a given region is the same, does not change over time.\n2. Assumption. Proportion of risk groups in population in a given region is the same, does not change over time.\n3. Assumption. Herd immunity does not change over time.\n\nLiterature\n1. Wang D. et al. Clinical characteristics of 138 hospitalized patients with 2019 novel coronavirus\u2013infected pneumonia in Wuhan, China \/\/Jama. \u2013 2020.\n2. Linton N. M. et al. Incubation period and other epidemiological characteristics of 2019 novel coronavirus infections with right truncation: a statistical analysis of publicly available case data \/\/Journal of Clinical Medicine. \u2013 2020. \u2013 \u0422. 9. \u2013 N. 2. \u2013 \u0421. 538.\n3. Baud D. et al. Real estimates of mortality following COVID-19 infection \/\/The Lancet Infectious Diseases. \u2013 2020. https:\/\/doi.org\/10.1016\/S1473-3099(20)30195-X","fe5ef87a":"Values per day as death, confirmed and recovered are distributed as a sum of peaky distributions with heights that distributed by exponential law. Such random peaky distributions are seems to be alike.\n\nSo a random correlation can be pointed as a true correlation.   ","9a4016f3":"## 2. Reconstruction of the number of infected persons each day","17b4f869":"\n# COVID-19 Estimating the number of actual cases"}}