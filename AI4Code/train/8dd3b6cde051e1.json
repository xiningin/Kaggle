{"cell_type":{"127ca85d":"code","b2102498":"code","fb71901e":"code","d76aacbc":"code","41f14089":"code","c6e8741e":"code","78928472":"code","7dd46adf":"code","0de1603e":"markdown","4935c8b0":"markdown","c8b04088":"markdown","4970e122":"markdown","572b7438":"markdown","6799b709":"markdown","a79e8b15":"markdown"},"source":{"127ca85d":"\n\nimport glob\nimport os\nimport errno\nfrom shutil import copyfile\n\ndef copy_files_for_tensor(database=\"pitfallpart2output\"):\n\n    for folder in glob.glob(f\"..\/input\/{database}\/tb_log\/*\") :\n        for file in glob.glob(folder+\"\/*\/*\"):\n            filename='\/'.join(file.split(\"\/\")[3:])\n            if not os.path.exists(os.path.dirname(filename)):\n                try:\n                    os.makedirs(os.path.dirname(filename))\n                except OSError as exc: # Guard against race condition\n                    if exc.errno != errno.EEXIST:\n                        raise\n\n\n            copyfile(file, filename)\n","b2102498":"!apt install apt-utils psmisc -y\n!killall -9 ngrok\n!rm -rf *ngrok*\n!wget https:\/\/bin.equinox.io\/c\/4VmDzA7iaHb\/ngrok-stable-linux-amd64.zip\n!unzip ngrok-stable-linux-amd64.zip\n!mkdir -p ngrok-dir\n!mv ngrok ngrok-dir\/\n# \u03a3\u03c4\u03b7\u03bd \u03b5\u03c0\u03cc\u03bc\u03b5\u03bd\u03b7 \u03b3\u03c1\u03b1\u03bc\u03bc\u03ae \u03b2\u03ac\u03bb\u03c4\u03b5 \u03c4\u03bf \u03b4\u03b9\u03ba\u03cc \u03c3\u03b1\u03c2 authentication token \u03b1\u03c0\u03cc \u03c4\u03bf ngrok\n!ngrok-dir\/ngrok authtoken 1pQXAmawXFhcccxNaTqxBybnA8M_8ab6i8BfThM2qQcPHkUKv\n\nLOG_DIR = 'tb_log\/'\n!mkdir -p LOG_DIR\n\nget_ipython().system_raw(\n    'tensorboard --logdir {} --host 0.0.0.0 --port 6006 &'\n    .format(LOG_DIR)\n)\nget_ipython().system_raw('ngrok-dir\/ngrok http 6006 &')\n! curl -s http:\/\/localhost:4040\/api\/tunnels | python3 -c \\\n    \"import sys, json; print(json.load(sys.stdin)['tunnels'][0]['public_url'])\"\nprint(\"Wait 10-15 seconds and then click the URL above to open TensorBoard\")","fb71901e":"!pip install --upgrade pip\n!pip install --upgrade stable_baselines3[extra]\n# we need a specific version of gym because of this issue: https:\/\/github.com\/DLR-RM\/stable-baselines3\/issues\/294\n!pip install gym==0.17.3\n!pip install sb3-contrib","d76aacbc":"from stable_baselines3.common.env_util import make_atari_env\nfrom stable_baselines3.common.vec_env import VecFrameStack\nimport datetime # For filenames while logging\nmax_steps=4000\nfrom stable_baselines3 import DQN, A2C, PPO\nfrom sb3_contrib import QRDQN\nimport shutil","41f14089":"atari_env_name='PitfallDeterministic-v0'\n\n# \u039c\u03b5 \u03c4\u03b9\u03c2 \u03c3\u03c5\u03bd\u03b1\u03c1\u03c4\u03ae\u03c3\u03b5\u03b9\u03c2 \u03c0\u03bf\u03c5 \u03b1\u03ba\u03bf\u03bb\u03bf\u03c5\u03b8\u03bf\u03cd\u03bd \u03ba\u03ac\u03bd\u03bf\u03c5\u03bc\u03b5 \u03c4\u03b7\u03bd \u03af\u03b4\u03b9\u03b1 \u03c0\u03c1\u03bf\u03b5\u03c0\u03b5\u03be\u03b5\u03c1\u03b3\u03b1\u03c3\u03af\u03b1 \u03bc\u03b5 \u03c4\u03b7\u03bd Deepmind\n\n# Here we are also multi-worker training (n_envs=4 => 4 environments), The model must support Multi Processing. To DQN \u03b4\u03b5\u03bd \u03b5\u03c0\u03b9\u03c4\u03c1\u03ad\u03c0\u03b5\u03b9 multi envs\nenv = make_atari_env(atari_env_name, n_envs=1)\n# Frame-stacking with 4 frames\n# \u03bc\u03b5 \u03ad\u03bd\u03b1 frame \u03ad\u03c7\u03bf\u03c5\u03bc\u03b5 \u03c4\u03b7 \u03b8\u03ad\u03c3\u03b7, \u03bc\u03b5 \u03b4\u03cd\u03bf \u03c4\u03b7\u03bd \u03c4\u03b1\u03c7\u03cd\u03c4\u03b7\u03c4\u03b1, \u03bc\u03b5 \u03c4\u03c1\u03af\u03b1 \u03c4\u03b7\u03bd \u03b5\u03c0\u03b9\u03c4\u03ac\u03c7\u03c5\u03bd\u03c3\u03b7 \u03ba\u03b1\u03b9 \u03bc\u03b5 \u03c4\u03ad\u03c3\u03c3\u03b5\u03c1\u03b1 \u03c4\u03bf\u03bd \u03c1\u03c5\u03b8\u03bc\u03cc \u03bc\u03b5\u03c4\u03b1\u03b2\u03bf\u03bb\u03ae\u03c2 \u03c4\u03b7\u03c2 \u03b5\u03c0\u03b9\u03c4\u03ac\u03c7\u03c5\u03bd\u03c3\u03b7\u03c2 (jerk)\nenv = VecFrameStack(env, n_stack=4)\n# Test environment must be unique\ntest_env = make_atari_env(atari_env_name, n_envs=1)\n# Frame-stacking with 4 frames\ntest_env = VecFrameStack(test_env, n_stack=4)","c6e8741e":"model_name='best_det_v0_model'+atari_env_name+\"final\"\ntime_stamp=datetime.datetime.now().strftime(\"-%Y%m%d-%H%M%S\")\nmodel_log= LOG_DIR + model_name + time_stamp","78928472":"!wget --no-check-certificate 'https:\/\/www.dropbox.com\/s\/3br9ow68xv887bi\/best_det_v0_model_after.zip?dl=1' -O best_det_v0.zip\nbest_det_v0_model = A2C.load(\".\/best_det_v0.zip\",env=env, verbose=1)","7dd46adf":"max_steps=int(10**6)\nbest_det_v0_model.learn(total_timesteps=max_steps)\nbest_det_v0_model.save(\"best_det_v0_model_after\")","0de1603e":"## \u039f\u03c1\u03b9\u03c3\u03bc\u03cc\u03c2 \u03c0\u03b1\u03b9\u03c7\u03bd\u03b9\u03b4\u03b9\u03bf\u03cd\n\n\u0392\u03ac\u03bb\u03c4\u03b5 \u03b5\u03b4\u03ce \u03c4\u03bf string \u03c0\u03bf\u03c5 \u03b1\u03bd\u03c4\u03b9\u03c3\u03c4\u03bf\u03b9\u03c7\u03b5\u03af \u03c3\u03c4\u03bf \u03c0\u03b1\u03b9\u03c7\u03bd\u03af\u03b4\u03b9 \u03c3\u03b1\u03c2. \u0393\u03b9\u03b1 \u03c4\u03b7\u03bd \u03bf\u03bd\u03bf\u03bc\u03b1\u03c4\u03bf\u03bb\u03bf\u03b3\u03af\u03b1 \u03c4\u03c9\u03bd \u03c0\u03b5\u03c1\u03b9\u03b2\u03b1\u03bb\u03bb\u03cc\u03bd\u03c4\u03c9\u03bd:\n- v0 vs v4: v0 has repeat_action_probability of 0.25 (meaning 25% of the time the previous action will be used instead of the new action), while v4 has 0 (always follow your issued action)\n- Deterministic: a fixed frameskip of 4, while for the env without Deterministic, frameskip is sampled from [2,4]\n- There is also NoFrameskip-v4 with no frame skip and no action repeat stochasticity.\n\n\u0391\u03bd\u03b1\u03bb\u03c5\u03c4\u03b9\u03ba\u03cc\u03c4\u03b5\u03c1\u03b1 \u03c3\u03c4\u03b7\u03bd \u03b5\u03ba\u03c6\u03ce\u03bd\u03b7\u03c3\u03b7 \u03c4\u03b7\u03c2 \u03ac\u03c3\u03ba\u03b7\u03c3\u03b7\u03c2.","4935c8b0":"# \u03a0\u03b1\u03af\u03b6\u03bf\u03bd\u03c4\u03b1\u03c2 Atari \u03bc\u03b5 \u03b2\u03b1\u03b8\u03b9\u03ac \u03b5\u03bd\u03b9\u03c3\u03c7\u03c5\u03c4\u03b9\u03ba\u03ae \u03bc\u03ac\u03b8\u03b7\u03c3\u03b7\n\n\u03a0\u03c1\u03bf\u03c3\u03bf\u03c7\u03ae: \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03bc\u03c0\u03bf\u03c1\u03ad\u03c3\u03b5\u03b9 \u03bd\u03b1 \u03c4\u03c1\u03ad\u03be\u03b5\u03b9 \u03b1\u03c5\u03c4\u03cc \u03c4\u03bf notebook \u03c3\u03c4\u03bf Kaggle \u03c0\u03c1\u03ad\u03c0\u03b5\u03b9 \u03bd\u03b1 \u03b5\u03bd\u03b5\u03c1\u03b3\u03bf\u03c0\u03bf\u03b9\u03ae\u03c3\u03b5\u03c4\u03b5 \u03c4\u03bf Internet \u03ba\u03b1\u03b9 \u03c4\u03b7\u03bd GPU \u03b3\u03b9\u03b1 \u03c4\u03bf\u03bd \u03c0\u03c5\u03c1\u03ae\u03bd\u03b1 \u03c3\u03b1\u03c2. \u0391\u03c5\u03c4\u03cc \u03b1\u03c0\u03b1\u03b9\u03c4\u03b5\u03af \u03c4\u03b7\u03bd \u03b5\u03c0\u03b9\u03b2\u03b5\u03b2\u03b1\u03af\u03c9\u03c3\u03b7 \u03c4\u03bf\u03c5 \u03ba\u03b9\u03bd\u03b7\u03c4\u03bf\u03cd \u03c3\u03b1\u03c2 \u03bc\u03b5 SMS. \u03a0\u03b7\u03b3\u03b1\u03af\u03bd\u03c4\u03b5 \u03c3\u03c4\u03bf \u03b4\u03b5\u03be\u03af sidebar \u03c3\u03c4\u03b1 settings \u03ba\u03b1\u03b9 \u03b8\u03b1 \u03c4\u03bf \u03b4\u03b5\u03af\u03c4\u03b5. \n\n\u03a4\u03b5\u03bb\u03b9\u03ba\u03ac \u03c0\u03c1\u03ad\u03c0\u03b5\u03b9 \u03bd\u03b1 \u03ad\u03c7\u03b5\u03c4\u03b5 \u03b1\u03c5\u03c4\u03ae \u03c4\u03b7\u03bd \u03b5\u03b9\u03ba\u03cc\u03bd\u03b1:\n\n![](https:\/\/i.imgur.com\/Ek5hOIo.jpg)","c8b04088":"## \u0395\u03b3\u03ba\u03b1\u03c4\u03ac\u03c3\u03c4\u03b1\u03c3\u03b7 \u03b2\u03b9\u03b2\u03bb\u03b9\u03bf\u03b8\u03ae\u03ba\u03b7\u03c2 \u03ba\u03b1\u03b9 gym","4970e122":"## Tensorboard \u03ba\u03b1\u03b9 ngrok\n\n\u0391\u03bd\u03c4\u03b9\u03ba\u03b1\u03c4\u03b1\u03c3\u03c4\u03ae\u03c3\u03c4\u03b5 \u03c4\u03bf authentication token \u03c3\u03b1\u03c2 \u03c0\u03bf\u03c5 \u03c0\u03b1\u03af\u03c1\u03bd\u03b5\u03c4\u03b5 \u03b1\u03c0\u03cc \u03c4\u03bf [ngrok](https:\/\/ngrok.com\/) \u03c3\u03c4\u03b7 \u03b3\u03c1\u03b1\u03bc\u03bc\u03ae \u03c0\u03bf\u03c5 \u03c5\u03c0\u03bf\u03b4\u03b5\u03b9\u03ba\u03bd\u03cd\u03b5\u03c4\u03b1\u03b9. \u038c\u03c4\u03b1\u03bd \u03b5\u03ba\u03c4\u03b5\u03bb\u03b5\u03c3\u03c4\u03b5\u03af \u03c4\u03bf \u03ba\u03b5\u03bb\u03af \u03b8\u03b1 \u03c3\u03b1\u03c2 \u03b4\u03ce\u03c3\u03b5\u03b9 \u03c4\u03bf URL \u03cc\u03c0\u03bf\u03c5 \u03bc\u03c0\u03bf\u03c1\u03b5\u03af\u03c4\u03b5 \u03bd\u03b1 \u03b2\u03bb\u03ad\u03c0\u03b5\u03c4\u03b5 \u03c4\u03bf TensorBoard. \u03a3\u03b7\u03bc\u03b5\u03b9\u03ce\u03c3\u03c4\u03b5 \u03cc\u03c4\u03b9 \u03c3\u03b5 \u03c0\u03b5\u03c1\u03af\u03c0\u03c4\u03c9\u03c3\u03b7 \u03b5\u03c0\u03b1\u03bd\u03b5\u03ba\u03ba\u03af\u03bd\u03b7\u03c3\u03b7\u03c2 \u03c4\u03bf\u03c5 \u03c0\u03c5\u03c1\u03ae\u03bd\u03b1 \u03b8\u03b1 \u03c0\u03c1\u03ad\u03c0\u03b5\u03b9 \u03bd\u03b1 \u03be\u03b1\u03bd\u03b1\u03c4\u03c1\u03ad\u03be\u03b5\u03c4\u03b5 \u03c4\u03bf \u03ba\u03b5\u03bb\u03af. \u0397 \u03b4\u03b9\u03b5\u03cd\u03b8\u03c5\u03bd\u03c3\u03b7 \u03b8\u03b1 \u03b5\u03af\u03bd\u03b1\u03b9 \u03b4\u03b9\u03b1\u03c6\u03bf\u03c1\u03b5\u03c4\u03b9\u03ba\u03ae, \u03b1\u03bb\u03bb\u03ac \u03c4\u03b1 \u03c0\u03c1\u03bf\u03b7\u03b3\u03bf\u03cd\u03bc\u03b5\u03bd\u03b1 \u03c3\u03c4\u03b1\u03c4\u03b9\u03c3\u03c4\u03b9\u03ba\u03ac \u03c3\u03b1\u03c2 \u03b4\u03b5\u03bd \u03c7\u03ac\u03bd\u03bf\u03bd\u03c4\u03b1\u03b9 (\u03bc\u03ad\u03c7\u03c1\u03b9 \u03bd\u03b1 \u03b1\u03bd\u03b1\u03ba\u03c5\u03ba\u03bb\u03c9\u03b8\u03b5\u03af \u03bf \u03c0\u03c5\u03c1\u03ae\u03bd\u03b1\u03c2).","572b7438":"# Further Training","6799b709":"## \u0394\u03b7\u03bc\u03b9\u03bf\u03c5\u03c1\u03b3\u03af\u03b1 \u03c0\u03b5\u03c1\u03b9\u03b2\u03ac\u03bb\u03bb\u03bf\u03bd\u03c4\u03bf\u03c2","a79e8b15":"## Deterministic-v0"}}