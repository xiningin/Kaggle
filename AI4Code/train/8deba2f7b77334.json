{"cell_type":{"123761e1":"code","2c7e5603":"code","37cd4746":"code","e5b46d90":"code","75d750b9":"code","e2d08c0f":"code","32f4e9be":"code","c7feb1a1":"code","cf7ca316":"code","b5982d13":"code","edc3462c":"code","056a3467":"code","aa152900":"code","fc891d7a":"code","3dcb16d5":"code","1792e978":"code","99c80b75":"code","765c4c7f":"code","6bbfde97":"code","d31f85fd":"code","5863dc5e":"code","3e311064":"code","e2da9f82":"code","86380e80":"code","6b4840fd":"code","a5174432":"code","a929517b":"code","ca708272":"code","b4de03af":"code","d0a64e77":"code","632a08b7":"code","46b2fe04":"code","4945441a":"code","6556aef4":"markdown","5d7d1916":"markdown","e8543698":"markdown","8987c13d":"markdown","9aaba35f":"markdown","47341e3f":"markdown","31676aa3":"markdown","56e09518":"markdown","4c837f0a":"markdown","06c76cc3":"markdown","bfab3fc6":"markdown","6aa7cc6f":"markdown","122235b3":"markdown","777f9086":"markdown","53d3f683":"markdown"},"source":{"123761e1":"import pandas as pd\nimport numpy as np\nimport os\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport datetime as dt\nimport warnings\nwarnings.filterwarnings('ignore')","2c7e5603":"os.chdir(\"\/kaggle\/input\/wallmart\")","37cd4746":"df2 = pd.read_csv(\"Total_sales.csv\")\ndf2 = df2.iloc[:,1:]\ndf2 = df2.fillna(0)\ndf2.head()","e5b46d90":"df2['Total'] = 0\nfor i in range(30490):\n    i = df2.columns[i]\n    df2['Total'] += df2[i]\ndf2['Total'].head()","75d750b9":"fig = px.line(df2, x='date', y='Total', title='Wallmart Sales 2011-2016\/10 stores',width=1200)\nfig.update_xaxes(rangeslider_visible=True)\nfig.show()","e2d08c0f":"for i in range(30490):\n    i = df2.columns[i]\n    state = i.split('_')[3]\n    if state not in df2.columns:\n        df2[state] = 0\nfor i in range(30490):\n    i = df2.columns[i]\n    state = i.split('_')[3]\n    df2[state] += df2[i]\ndf2.head()","32f4e9be":"fig = go.Figure()\nfig.add_trace(go.Scatter(x=df2['date'], y=df2['CA'].values,\n                    mode='lines',\n                    name='CA'))\nfig.add_trace(go.Scatter(x=df2['date'], y=df2['TX'].values,\n                    mode='lines',\n                    name='TX'))\nfig.add_trace(go.Scatter(x=df2['date'], y=df2['WI'].values,\n                    mode='lines',\n                    name='WI'))\nfig.update_layout(\n    autosize=False,\n    width=1000,\n    height=700,\n    margin=dict(\n        l=50,\n        r=50,\n        b=100,\n        t=100,\n        pad=4\n    ),\n    paper_bgcolor=\"LightSteelBlue\",\n    title=\"Walmart statewise sales\",\n    xaxis_title=\"Date\",\n    yaxis_title=\"Sales\",\n    font=dict(\n        family=\"Courier New, monospace\",\n        size=18,\n        color=\"#042a30\"\n    )\n)\n\nfig.update_xaxes(rangeslider_visible=True,)\nfig.show()","c7feb1a1":"for i in range(30490):\n    i = df2.columns[i]\n    category = i.split('_')[0]\n    if category not in df2.columns:\n        df2[category] = 0\nfor i in range(30490):\n    i = df2.columns[i]\n    category = i.split('_')[0]\n    df2[category] += df2[i]\ndf2.head()","cf7ca316":"import plotly.graph_objects as go\n\nfig = go.Figure()\n\nfig.add_trace(go.Scatter(x=df2['date'], y=df2['FOODS'].values,\n                    mode='lines',\n                    name='FOODS'))\nfig.add_trace(go.Scatter(x=df2['date'], y=df2['HOBBIES'].values,\n                    mode='lines',\n                    name='HOBBIES'))\nfig.add_trace(go.Scatter(x=df2['date'], y=df2['HOUSEHOLD'].values,\n                    mode='lines',\n                    name='HOUSEHOLD'))\nfig.update_layout(\n    autosize=False,\n    width=1000,\n    height=700,\n    margin=dict(\n        l=50,\n        r=50,\n        b=100,\n        t=100,\n        pad=4\n    ),\n    paper_bgcolor=\"LightSteelBlue\",\n    title=\"Walmart category wise sales\",\n    xaxis_title=\"Date\",\n    yaxis_title=\"Sales\",\n    font=dict(\n        family=\"Courier New, monospace\",\n        size=18,\n        color=\"#042a30\"\n    )\n)\n\n\nfig.update_xaxes(rangeslider_visible=True)\nfig.show()","b5982d13":"df2.columns","edc3462c":"for i in range(30490):\n    i = df2.columns[i]\n    store = i.split('_')[3] + '_' + i.split('_')[4]\n    if store not in df2.columns:\n        df2[store] = 0\nfor i in range(30490):\n    i = df2.columns[i]\n    store = i.split('_')[3] + '_' + i.split('_')[4]\n    df2[store] += df2[i]\ndf2.head()","056a3467":"for i in range(30490):\n    i = df2.columns[i]\n    item = i.split('_')[3] + '_' + i.split('_')[4] + '_' + i.split('_')[0]\n    if item not in df2.columns:\n        df2[item] = 0\nfor i in range(30490):\n    i = df2.columns[i]\n    item = i.split('_')[3] + '_' + i.split('_')[4] + '_' + i.split('_')[0]\n    df2[item] += df2[i]\ndf2.head()","aa152900":"import plotly.graph_objects as go\n\nfig = go.Figure()\n\nfor i in range(30498,30502): \n    i = df2.columns[i]\n    fig.add_trace(go.Scatter(x=df2['date'], y=df2[i].values,\n                        mode='lines',\n                        name=i.split('_')[0] + ' store ' +i.split('_')[1]))\n    \nfig.update_layout(\n    autosize=False,\n    width=1000,\n    height=700,\n    margin=dict(\n        l=50,\n        r=50,\n        b=100,\n        t=100,\n        pad=4\n    ),\n    paper_bgcolor=\"LightSteelBlue\",\n    title=\"Walmart California store wise sales\",\n    xaxis_title=\"Date\",\n    yaxis_title=\"Sales\",\n    font=dict(\n        family=\"Courier New, monospace\",\n        size=18,\n        color=\"#042a30\"\n    )\n)\n\nfig.update_xaxes(rangeslider_visible=True)\nfig.show()","fc891d7a":"import plotly.graph_objects as go\n\nfig = go.Figure()\n\nfor i in range(30510,30531,10): \n    i = df2.columns[i]\n    fig.add_trace(go.Scatter(x=df2['date'], y=df2[i].values,\n                        mode='lines',\n                        name=i.split('_')[2]))\n    \nfig.update_layout(\n    autosize=False,\n    width=1000,\n    height=700,\n    margin=dict(\n        l=50,\n        r=50,\n        b=100,\n        t=100,\n        pad=4\n    ),\n    paper_bgcolor=\"LightSteelBlue\",\n    title=\"Walmart California store 3 category wise sales\",\n    xaxis_title=\"Date\",\n    yaxis_title=\"Sales\",\n    font=dict(\n        family=\"Courier New, monospace\",\n        size=18,\n        color=\"#042a30\"\n    )\n)\n\n\nfig.update_xaxes(rangeslider_visible=True)\nfig.show()","3dcb16d5":"cal = pd.read_csv('calendar.csv')\nevents = cal[['date','event_name_1','event_type_1','event_name_2','event_type_2']]\nevents = events.fillna(0)\nevents = events[(events['event_name_1'] != 0) | (events['event_name_2'] != 0)]\nevents.shape","1792e978":"l = []\nc = 0\nfor x in events['date'].values:\n    c +=1\n    l.append(\n    dict(\n        type=\"line\",\n        yref='paper',\n        y0=0,\n        y1=1,\n        xref='x1',\n        x0=x,\n        x1=x,\n        line=dict(\n            color=\"Red\",\n            width=2,\n            dash=\"dashdot\",\n    )))\nprint(c)\nfig = px.line(df2, x='date', y='CA_3')\nfig.update_layout(shapes=l)\nfig.show()","99c80b75":"\nevents[events['date'] == dt.datetime(2015, 4 , 12)]\nevents[(events['date'].apply(lambda a : dt.datetime.strptime(a, \"%Y-%m-%d\").month) == 5) | (events['date'].apply(lambda a : dt.datetime.strptime(a, \"%Y-%m-%d\").month) == 6)]","765c4c7f":"df2[['event_name_1', 'event_type_1', 'event_name_2', 'event_type_2','snap_CA', 'snap_TX', 'snap_WI']] = cal[['event_name_1', 'event_type_1', 'event_name_2', 'event_type_2','snap_CA', 'snap_TX', 'snap_WI']]\ndf2[['date','event_name_1', 'event_type_1', 'event_name_2', 'event_type_2','snap_CA', 'snap_TX', 'snap_WI']]\n","6bbfde97":"dis = pd.read_csv('us_disasters_m5.csv')\ndis.head()","d31f85fd":"dis_ca = dis[dis['state'] == 'CA']\nprint(dis_ca.shape)\ndis_ca.head()","5863dc5e":"dis_ca['declaration_date'] = pd.to_datetime(dis_ca['declaration_date'].apply(lambda x : x[:10]))\ndis_ca['declaration_date'].head()","3e311064":"dis_ca_timeline = dis_ca[['incident_type','declaration_date']]\ndis_ca_timeline['declaration_date'] = pd.to_datetime(dis_ca_timeline['declaration_date'])\ndis_ca_timeline['declaration_date'] = dis_ca_timeline['declaration_date'].apply(lambda x : x.strftime(\"%Y-%m-%d\"))","e2da9f82":"\ndis_ca_timeline = dis_ca_timeline.reset_index()\ndis_ca_timeline = dis_ca_timeline.drop(columns='index') \ndis_ca_timeline.head()","86380e80":"dis_ca_timeline.head()","6b4840fd":"df2[['date','Total']].set_index('date').head()","a5174432":"l = []\nfor i in range(54):\n    x = dis_ca_timeline['declaration_date'].iloc[i]\n    l.append(\n    dict(\n        type=\"line\",\n        yref='paper',\n        y0=0,\n        y1=1,\n        xref='x1',\n        x0=x,\n        x1=x,\n        line=dict(\n            color=\"Red\",\n            width=2,\n            dash=\"dashdot\",\n    )))\nfig = px.line(df2, x='date', y='Total')\n\ni=40\nx = dis_ca_timeline['declaration_date'].iloc[i]\nfig.update_layout(shapes=l)    ","a929517b":"dis_ca_timeline['declaration_date'].unique()","ca708272":"dis_ca_timeline['Threat level'] = 'Minor'\n\nd = dis_ca_timeline['incident_type'] == 'Tsunami'\n\ndis_ca_timeline.loc[d.values,'Threat level'] = 'Major'","b4de03af":"dis_ca_timeline[dis_ca_timeline['incident_type'] != 'Fire']","d0a64e77":"dis[dis['state'] == 'CA']\ndis.iloc[327:329,:]","632a08b7":"dis_ca_timeline1 = dis_ca[['incident_type','incident_begin_date']]\ndis_ca_timeline1['incident_begin_date'] = pd.to_datetime(dis_ca_timeline1['incident_begin_date'])\ndis_ca_timeline1['incident_begin_date'] = dis_ca_timeline1['incident_begin_date'].apply(lambda x : x.strftime(\"%Y-%m-%d\"))\ndis_ca_timeline1 = dis_ca_timeline1.reset_index()\ndis_ca_timeline1 = dis_ca_timeline1.drop(columns='index') \ndis_ca_timeline1.set_index('incident_begin_date')\n#dis_ca_timeline1 = dis_ca_timeline1[dis_ca_timeline1['incident_type'] != 'Fire']\ndis_ca_timeline1.head()","46b2fe04":"dis_ca_timeline2 = pd.read_excel('dis_ca_timeline1_modified.xlsx')\ndis_ca_timeline2[dis_ca_timeline2['Threat level'] == 'Medium']['incident_begin_date'].values\ndis_ca_timeline2.head()","4945441a":"l = []\nfor x in dis_ca_timeline2[dis_ca_timeline2['Threat level'] == 'Medium']['incident_begin_date'].values:\n    l.append(\n    dict(\n        type=\"line\",\n        yref='paper',\n        y0=0,\n        y1=1,\n        xref='x1',\n        x0=x,\n        x1=x,\n        line=dict(\n            color=\"Red\",\n            width=2,\n            dash=\"dashdot\",\n    )))\n    \nfig = px.line(df2, x='date', y='CA_3')\nfig.update_layout(shapes=l)\nfig.show()","6556aef4":"# EDA - daily basis","5d7d1916":"### Analysis of California Store 3","e8543698":"## Reading data","8987c13d":"### Analysis of California stores","9aaba35f":"## Importing libraries","47341e3f":"### 4) Total sales per day per state per store","31676aa3":"### 1) Total sales of 10 stores per day","56e09518":"### 3) Total sales per day per category","4c837f0a":"The downward lines in the above chart corresponds to no sales on the Eve of Christmas holiday","06c76cc3":"## Disaster is Medium","bfab3fc6":"## Events analysis","6aa7cc6f":"As there are 4 stores in California compared to 3 stores each in Texas and Wisconsin, California is on top the chart","122235b3":"## Disaster analysis","777f9086":"### 2) Total sales per day per state","53d3f683":"## Adding new features"}}