{"cell_type":{"0ff93279":"code","8957450f":"code","db9f3174":"code","d04c1f95":"code","d4aa7fe9":"code","73eea7a2":"code","7822d645":"code","7737a055":"code","0b1d4741":"markdown","f24c338d":"markdown","7b402a80":"markdown","572bf7f2":"markdown","baaddff4":"markdown","7dd3cb47":"markdown","1ea2a8a8":"markdown","ffda4106":"markdown","b3346d37":"markdown","887d68e0":"markdown","4eb97487":"markdown"},"source":{"0ff93279":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport math\nfrom sklearn.linear_model import LinearRegression\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","8957450f":"df_train_full = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/train.csv')\ndf_test_full = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/test.csv')\n\ndf = df_train_full.copy()\ndf_test = df_test_full.copy()","db9f3174":"df = df.drop(df[df['num_sold'] > 915].index)","d04c1f95":"df['date']=pd.to_datetime(df['date'])\ndf.insert(loc=2, column='year', value=df['date'].dt.year)\ndf.insert(loc=3, column='month', value=df['date'].dt.month)\ndf.insert(loc=4, column='day', value=df['date'].dt.day)\n\ndf = df.drop(['date', 'row_id'], axis=1)\ndf = df.reset_index(drop=True)\n\n#################### Below code is for test data ####################\ndf_test['date']=pd.to_datetime(df_test['date'])\ndf_test.insert(loc=2, column='year', value=df_test['date'].dt.year)\ndf_test.insert(loc=3, column='month', value=df_test['date'].dt.month)\ndf_test.insert(loc=4, column='day', value=df_test['date'].dt.day)\n\ndf_test = df_test.drop(['date', 'row_id'], axis=1)\ndf_test = df_test.reset_index(drop=True)","d4aa7fe9":"df1 = df['num_sold']\ndf2 = np.log(df1)\n\ndf['num_sold'] = np.log(df['num_sold'])\n\ndf['year'] = df['year'].astype('category')\ndf['month'] = df['month'].astype('category')\ndf['day'] = df['day'].astype('category')\n\ndf = pd.get_dummies(df)\n\n#################### Below code is for test data ####################\ndf_test['year'] = df_test['year'].astype('category')\ndf_test['month'] = df_test['month'].astype('category')\ndf_test['day'] = df_test['day'].astype('category')\n\ndf_test = pd.get_dummies(df_test)\n\ndf_test.insert(loc=0, column='year_2015', value=0)\ndf_test.insert(loc=1, column='year_2016', value=0)\ndf_test.insert(loc=2, column='year_2017', value=0)\ndf_test.insert(loc=3, column='year_2018', value=1)\n\ndf_test = df_test.drop(['year_2019'], axis=1)","73eea7a2":"Y = df[['num_sold']]\nX = df.drop(['num_sold'], axis=1)\n\ntr_size = len(X)\ntr_size = int(tr_size)\n\nX_train = X.values[0 : tr_size]\nY_train = Y.values[0 : tr_size]","7822d645":"std_reg = LinearRegression()\nstd_reg.fit(X_train, Y_train)\n\nr2_train = std_reg.score(X_train, Y_train)\nprint(\"Score:\")\nprint(r2_train)\n\n# Create Y Predictions\nY_predict = std_reg.predict(df_test)\n\nY_predict_e = []\n\nfor data in Y_predict:\n    # Y_predict_e.append(int(math.exp(data) + (math.exp(data) \/ 100) * 7))\n    Y_predict_e.append(int(math.exp(data)))","7737a055":"output = pd.DataFrame({'row_id': df_test_full['row_id'],\n                       'num_sold': Y_predict_e})\noutput.to_csv('submission.csv', index=False)","0b1d4741":"# <center style=\"background-color:#4267B2; color:white; padding: 10px; border-radius:5px 5px;\">Load data to dataframe<\/center>","f24c338d":"<center><img src=\"https:\/\/www.googleapis.com\/download\/storage\/v1\/b\/kaggle-user-content\/o\/inbox%2F59561%2Fcc6d9a21f0c3ed71b00113b33efb2b66%2Fkaggle_sweater.png?generation=1640900016906235&alt=media\" \/><\/center>","7b402a80":"# <center style=\"background-color:#4267B2; color:white; padding: 10px; border-radius:5px 5px;\">Basic setup and import<\/center>","572bf7f2":"<div style=\"background-color:#2d862d; color:white; padding: 5px 5px 5px 15px; border-radius:5px 5px; font-size:18px;\">Generate oufput file for submission<\/div>","baaddff4":"<div style=\"background-color:#2d862d; color:white; padding: 5px 5px 5px 15px; border-radius:5px 5px; font-size:18px;\">Remove outlier data<\/div>","7dd3cb47":"<div style=\"background-color:#2d862d; color:white; padding: 5px 5px 5px 15px; border-radius:5px 5px; font-size:18px;\">Feature Engineering and Create dummy columns<\/div>","1ea2a8a8":"<div style=\"background-color:#2d862d; color:white; padding: 5px 5px 5px 15px; border-radius:5px 5px; font-size:18px;\">Test \/ Train Split of Data<\/div>","ffda4106":"# <center style=\"color:white; padding: 10px; border-radius:5px 5px; background-image: url(https:\/\/i.imgur.com\/0fetaJr.png);\">Thank You<\/center>","b3346d37":"# <center style=\"color:white; padding: 10px; border-radius:5px 5px; background-image: url(https:\/\/i.imgur.com\/0fetaJr.png);\">TPS - Jan 2022 - Linear Regression (Few and simple steps)<\/center>","887d68e0":"<div style=\"background-color:#2d862d; color:white; padding: 5px 5px 5px 15px; border-radius:5px 5px; font-size:18px;\">Create Model and Check Score<\/div>","4eb97487":"<div style=\"background-color:#2d862d; color:white; padding: 5px 5px 5px 15px; border-radius:5px 5px; font-size:18px;\">Convert datetime to different columns<\/div>"}}