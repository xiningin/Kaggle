{"cell_type":{"81e273f3":"code","210bbdcb":"code","677eda8d":"code","f6da87d2":"code","5827028a":"code","f53d8e42":"code","caf70469":"code","bdfdb609":"code","4aa855fa":"code","770d8319":"code","adc76851":"markdown","a4d5345e":"markdown","aebaea66":"markdown"},"source":{"81e273f3":"import numpy as np\nimport pandas as pd\nfrom tqdm import tqdm\nimport matplotlib.pyplot as plt\npd.set_option(\"max_columns\",300)\npd.set_option(\"max_rows\",1020)","210bbdcb":"train_df = pd.read_csv(\"..\/input\/train.csv\")\nlabels_df = pd.read_csv(\"..\/input\/labels.csv\")","677eda8d":"train_df[\"attribute_ids\"]=train_df[\"attribute_ids\"].apply(lambda x:[int(x) for x in x.split(\" \")])\ntrain_df[\"id\"]=train_df[\"id\"].apply(lambda x:x+\".png\")\ntrain_df.head()","f6da87d2":"for ix in tqdm(range(1103)):\n    train_df[\"label_\"+str(ix)] = train_df[\"attribute_ids\"].map(lambda x: 1 if ix in x else 0)","5827028a":"train_df.head()","f53d8e42":"labels = [\"label_{}\".format(i) for i in range(1103)]\nsummary = train_df[labels].sum()","caf70469":"labels_df[\"count\"] = summary.values","bdfdb609":"labels_df.sort_values(\"count\")","4aa855fa":"fig = plt.figure(figsize=(20,5))\nax = fig.add_subplot(1, 1, 1)\nax.set_xticks([x for x in range(0,1000,20)]) \nplt.xlabel('train num per label')\nplt.hist(summary, range=(0, 1000), bins=50);","770d8319":"for num in [5, 10, 50, 100]: \n    print(\"under {0}: {1}\".format(num, (summary<=num).sum()))","adc76851":"How do we learn the labels which have less than 10 images?","a4d5345e":"## Summary\n\nThere are a lot of labels, and many labels have few images.\n\nI think this competition's key is to treat these labels.","aebaea66":"## Numbers of train images per label\n\nThis competition is **multi-label task**.  \n\nSo we should understand the number of train images per label.  \n\nLet's check!!"}}