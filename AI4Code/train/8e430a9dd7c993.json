{"cell_type":{"632566a4":"code","5d2962a9":"code","a8b473e4":"code","a3e36045":"code","839969c0":"code","d0e8a843":"code","f77041e2":"code","5bcce427":"code","d65a2542":"code","284da430":"code","c59b5582":"code","8571809a":"code","3c30851b":"code","ea0f7920":"code","8354c7e9":"code","ba1c0749":"code","6eec7791":"code","a50f6c68":"code","af6db453":"code","3146fd8b":"code","78052f46":"code","7816fd35":"code","bf496753":"code","f6fd798c":"code","677a23ab":"code","e73d411f":"code","ba8fa6b1":"code","83891e68":"code","2c3c8056":"code","67a4f5cd":"code","0c88a850":"code","cd12bcab":"code","380dedbf":"code","282e4b43":"code","c83b4a32":"markdown","f748b2f6":"markdown","7593a3ce":"markdown","4253cad6":"markdown","3e16136c":"markdown","3ba3141d":"markdown","c9c6048d":"markdown","3f59e3f7":"markdown","c93edaa6":"markdown","449ecec1":"markdown","185cb8ec":"markdown","9ea0697b":"markdown","a56c49ad":"markdown","457adfc6":"markdown","ebcd4c3d":"markdown","73362dc5":"markdown","5d1b373f":"markdown","afdde451":"markdown","29b97557":"markdown","1631c4d1":"markdown","499912db":"markdown","9a6c70d8":"markdown","04f2b4d9":"markdown","ea2b9d03":"markdown","2755a659":"markdown","505df22b":"markdown","cf8b6195":"markdown"},"source":{"632566a4":"import numpy as np\n\nimport pandas as pd\nimport pandas_profiling as pp\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n#These parameters are common for all plots, moved them here\nplt.rcParams['figure.figsize'] = [19, 5]\nplt.rcParams['agg.path.chunksize'] = 5000\n\nimport plotly.express as px\nimport plotly.graph_objects as go\n\nimport seaborn as sns\nimport glob\nimport gc","5d2962a9":"products = pd.read_csv('\/kaggle\/input\/learnplatform-covid19-impact-on-digital-learning\/products_info.csv')\ndistricts = pd.read_csv('\/kaggle\/input\/learnplatform-covid19-impact-on-digital-learning\/districts_info.csv')\n\npath = '\/kaggle\/input\/learnplatform-covid19-impact-on-digital-learning\/engagement_data'\nengagement_pieces = glob.glob(path + '\/*.csv')\nli = []\n\nfor engagement in engagement_pieces:\n    df = pd.read_csv(engagement, index_col = None, header = 0)\n    district_id = engagement.split('\/')[-1].split('.')[0]\n    #for local machine used this version of split\n    #district_id = engagement.split('\/')[1].split('\\\\')[1].split('.')[0]\n    df['district_id'] = district_id\n    li.append(df)\n\nengagement = pd.concat(li)\nengagement = engagement.reset_index(drop = True)","a8b473e4":"pp.ProfileReport(products)","a3e36045":"pp.ProfileReport(districts)","839969c0":"pp.ProfileReport(engagement, minimal = True)","d0e8a843":"#rename LP ID\nproducts = products.rename({'LP ID':'lp_id'}, axis = 1)\n\n#change data types\nengagement['district_id'] = engagement['district_id'].astype(int)\nengagement['time'] = pd.to_datetime(engagement['time'])\n\n#fix brackets direction\ndistricts = districts.replace('\\[$', ']', regex = True)","f77041e2":"median = engagement['engagement_index'].median()\nengagement['engagement_index'].fillna(median, inplace = True)","5bcce427":"districts['state'].fillna('Other', inplace = True)\ndistricts['locale'].fillna('unidentified', inplace = True)","d65a2542":"products = products.dropna(subset = ['Sector(s)', 'Primary Essential Function'])\nengagement = engagement.dropna(subset = ['pct_access'])","284da430":"plt.plot(engagement['time'], engagement['engagement_index'])\nplt.title('Engagement Index in 2020')\nplt.xlabel('Time')\nplt.ylabel('Index')\nplt.show()","c59b5582":"#clean up a little\ngc.collect()","8571809a":"engagement = engagement.merge(districts, on = 'district_id').merge(products, on = 'lp_id').sort_values(by = ['time'])","3c30851b":"engagement.head()","ea0f7920":"plt.plot(engagement.loc[engagement['Sector(s)'] == 'PreK-12']['time'],\n         engagement.loc[engagement['Sector(s)'] == 'PreK-12']['engagement_index'])\nplt.title('Engagement Index in 2020 - PreK-12')\nplt.xlabel('Time')\nplt.ylabel('Index')\nplt.show()","8354c7e9":"plt.plot(engagement.loc[engagement['Sector(s)'] == 'PreK-12; Higher Ed; Corporate']['time'],\n         engagement.loc[engagement['Sector(s)'] == 'PreK-12; Higher Ed; Corporate']['engagement_index'])\nplt.title('Engagement Index in 2020 - PreK-12; Higher Ed; Corporate')\nplt.xlabel('Time')\nplt.ylabel('Index')\nplt.show()","ba1c0749":"plt.plot(engagement.loc[engagement['Sector(s)'] == 'PreK-12; Higher Ed']['time'],\n         engagement.loc[engagement['Sector(s)'] == 'PreK-12; Higher Ed']['engagement_index'])\nplt.title('Engagement Index in 2020 - PreK-12; Higher Ed')\nplt.xlabel('Time')\nplt.ylabel('Index')\nplt.show()","6eec7791":"plt.plot(engagement.loc[engagement['Sector(s)'] == 'Corporate']['time'],\n         engagement.loc[engagement['Sector(s)'] == 'Corporate']['engagement_index'])\nplt.title('Engagement Index in 2020 - Corporate')\nplt.xlabel('Time')\nplt.ylabel('Index')\nplt.show()","a50f6c68":"plt.plot(engagement.loc[engagement['Sector(s)'] == 'Higher Ed; Corporate']['time'],\n         engagement.loc[engagement['Sector(s)'] == 'Higher Ed; Corporate']['engagement_index'])\nplt.title('Engagement Index in 2020 - Higher Ed; Corporate')\nplt.xlabel('Time')\nplt.ylabel('Index')\nplt.show()","af6db453":"plt.plot(engagement.loc[engagement['state'] == 'Connecticut']['time'],\n         engagement.loc[engagement['state'] == 'Connecticut']['engagement_index'])\nplt.title('Engagement Index in 2020 - Connecticut')\nplt.xlabel('Time')\nplt.ylabel('Index')\nplt.show()","3146fd8b":"plt.plot(engagement.loc[engagement['state'] == 'Utah']['time'],\n         engagement.loc[engagement['state'] == 'Utah']['engagement_index'])\nplt.title('Engagement Index in 2020 - Utah')\nplt.xlabel('Time')\nplt.ylabel('Index')\nplt.show()","78052f46":"plt.plot(engagement.loc[engagement['state'] == 'Other']['time'],\n         engagement.loc[engagement['state'] == 'Other']['engagement_index'])\nplt.title('Engagement Index in 2020 - Other states')\nplt.xlabel('Time')\nplt.ylabel('Index')\nplt.show()","7816fd35":"plt.plot(engagement.groupby('state').agg({'engagement_index': ['mean']}))\nplt.xticks(rotation = 90)\nplt.show()","bf496753":"eng_mean = engagement.groupby('state').agg({'engagement_index': ['mean']})\neng_mean.columns = eng_mean.columns.get_level_values(0)\neng_mean.columns = ['engagement_mean']\neng_mean['code'] = ['AZ', 'CA', 'CT', 'DC', 'FL', 'IL', 'IN', 'MA', 'MI', 'MN', 'MO', 'NH', 'NJ', 'NY', 'NC', 'ND', 'OH', 'Other', 'TN', 'TX', 'UT', 'VA', 'WA', 'WI']\neng_mean.drop('Other')","f6fd798c":"fig = go.Figure(data = go.Choropleth(locations = eng_mean['code'],\n                                     z = eng_mean['engagement_mean'].astype(float),\n                                     locationmode = 'USA-states',\n                                     colorscale = 'Reds',\n                                     colorbar_title = 'Mean'))\n\nfig.update_layout(title_text = 'Engagement mean distribution by state',\n                  geo_scope = 'usa')\n\nfig.show()","677a23ab":"fig = px.bar(engagement.groupby(['state', \n                                  'pct_black\/hispanic'])['district_id'].count().reset_index(name = 'Total count'),\n      x = 'state', y = 'Total count', color = 'pct_black\/hispanic')\nfig.update_layout(legend = dict(orientation = 'h',\n                                yanchor = 'bottom',\n                                y = 1.02,\n                                xanchor = 'right',\n                                x = .9))\nfig.update_xaxes(categoryorder='category ascending')\nfig.show()","e73d411f":"fig = px.bar(engagement.groupby(['state', \n                                  'pct_free\/reduced'])['district_id'].count().reset_index(name = 'Total count'),\n      x = 'state', y = 'Total count', color = 'pct_free\/reduced')\nfig.update_layout(legend = dict(orientation = 'h',\n                                yanchor = 'bottom',\n                                y = 1.02,\n                                xanchor = 'right',\n                                x = .9))\nfig.update_xaxes(categoryorder='category ascending')\nfig.show()","ba8fa6b1":"fig = px.bar(engagement.groupby(['state', \n                                  'county_connections_ratio'])['district_id'].count().reset_index(name = 'Total count'),\n      x = 'state', y = 'Total count', color = 'county_connections_ratio')\nfig.update_layout(legend = dict(orientation = 'h',\n                                yanchor = 'bottom',\n                                y = 1.02,\n                                xanchor = 'right',\n                                x = .9))\nfig.update_xaxes(categoryorder='category ascending')\nfig.show()","83891e68":"plt.plot(engagement.loc[engagement['pct_black\/hispanic'] == '[0, 0.2]']['time'],\n         engagement.loc[engagement['pct_black\/hispanic'] == '[0, 0.2]']['engagement_index'])\nplt.title('Engagement Index in 2020 - Less than 20% black\/hispanic students')\nplt.xlabel('Time')\nplt.ylabel('Index')\nplt.show()","2c3c8056":"plt.plot(engagement.loc[engagement['pct_black\/hispanic'] == '[0.8, 1]']['time'],\n         engagement.loc[engagement['pct_black\/hispanic'] == '[0.8, 1]']['engagement_index'])\nplt.title('Engagement Index in 2020 - More than 80% black\/hispanic students')\nplt.xlabel('Time')\nplt.ylabel('Index')\nplt.show()","67a4f5cd":"fig, ax1 = plt.subplots()\nax1.plot(engagement.groupby(['pct_black\/hispanic']).agg({'engagement_index': ['mean']}), color = 'red')\nax1.tick_params(axis='y', labelcolor = 'red')\nax2 = ax1.twinx()\nax2.plot(engagement.groupby(['pct_black\/hispanic']).agg({'engagement_index': ['count']}), color = 'blue')\nax2.tick_params(axis='y', labelcolor = 'blue')\nplt.show()","0c88a850":"fig, ax1 = plt.subplots()\nax1.plot(engagement.groupby(['pct_free\/reduced']).agg({'engagement_index': ['mean']}), color = 'red')\nax1.tick_params(axis='y', labelcolor = 'red')\nax2 = ax1.twinx()\nax2.plot(engagement.groupby(['pct_free\/reduced']).agg({'engagement_index': ['count']}), color = 'blue')\nax2.tick_params(axis='y', labelcolor = 'blue')\nplt.show()","cd12bcab":"#This one does not look interesting\nplt.plot(engagement.groupby(['county_connections_ratio']).agg({'engagement_index': ['mean']}))\nplt.show()","380dedbf":"sns.catplot(x = 'pct_black\/hispanic', \n            y = 'engagement_index',\n            col = 'state',\n            col_wrap = 2,\n            hue = 'pct_black\/hispanic', \n            data = engagement.groupby(['state', 'pct_black\/hispanic'])['engagement_index'].mean().reset_index(),\n            kind = 'bar')","282e4b43":"sns.catplot(x = 'pct_free\/reduced', \n            y = 'engagement_index',\n            col = 'state',\n            col_wrap = 2,\n            hue = 'pct_free\/reduced', \n            data = engagement.groupby(['state', 'pct_free\/reduced'])['engagement_index'].mean().reset_index(),\n            kind = 'bar')","c83b4a32":"* The first 3 have similar patterns. They all have **PreK-12** inside, this have influence on plots' shapes. \n* **Corporate** education differs a little from them.\n* Indexes also differ, maximum of 160k for the first type and only 1000 for the last.\n\n##### I have no data to check my hypothesis about school schedule, but the last plot, containing only High Education and Corporate courses also has a similar shape. That fact can not be explained only by summer vacations and holidays.","f748b2f6":"### *Missing values*\n\n#### Engagement index\n\nengagement_index is highly skewed (see the profiler's report on engagement), so it would be better to use median","7593a3ce":"#### County connections","4253cad6":"#### Now we have 3 distinct dataset in memory. Let's look at each and decide, what to do next.","3e16136c":"### *Read the data*","3ba3141d":"### *Data description from the source*\n\n#### Product information data\nThe product file **products_info.csv** includes information about the characteristics of the top 372 products with most users in 2020. The categories listed in this file are part of LearnPlatform's product taxonomy. Data were labeled by our team. Some products may not have labels due to being duplicate, lack of accurate url or other reasons.\n\n| Name  | Description |\n|:-----:|:-----------:|\n| LP ID | The unique identifier of the product |\n| URL   | Web Link to the specific product |\n| Product Name | Name of the specific product |\n| Provider\/Company Name | Name of the product provider |\n| Sector(s) | Sector of education where the product is used |\n| Primary Essential Function | The basic function of the product. There are two layers of labels here. Products are first labeled as one of these three categories: 1. LC = Learning & Curriculum, 2. CM = Classroom Management, and 3. SDO = School & District Operations. Each of these categories have multiple sub-categories with which the products were labeled |\n\n#### District information data\nThe district file **districts_info.csv** includes information about the characteristics of school districts, including data from NCES (2018-19), FCC (Dec 2018), and Edunomics Lab. In this data set, we removed the identifiable information about the school districts. We also used an open source tool ARX (Prasser et al. 2020) to transform several data fields and reduce the risks of re-identification. For data generalization purposes some data points are released with a range where the actual value falls under. Additionally, there are many missing data marked as 'NaN' indicating that the data was suppressed to maximize anonymization of the dataset.\n\n| Name | Description |\n|:----:|:-----------:|\n| district_id |\tThe unique identifier of the school district |\n| state | The state where the district resides in |\n| locale | NCES locale classification that categorizes U.S. territory into four types of areas: City, Suburban, Town, and Rural. See [Locale Boundaries User's Manual](https:\/\/eric.ed.gov\/?id=ED577162) for more information |\n| pct_black\/hispanic | Percentage of students in the districts identified as Black or Hispanic based on 2018-19 NCES data |\n| pct_free\/reduced | Percentage of students in the districts eligible for free or reduced-price lunch based on 2018-19 NCES data |\n| county*connections*ratio | ratio (residential fixed high-speed connections over 200 kbps in at least one direction\/households) based on the county level data from FCC From 477 (December 2018 version). See FCC data for more information |\n| pptotalraw | Per-pupil total expenditure (sum of local and federal expenditure) from Edunomics Lab's National Education Resource Database on Schools (NERD$) project. The expenditure data are school-by-school, and we use the median value to represent the expenditure of a given school district |\n\n#### Engagement data\nThe engagement data are aggregated at school district level, and each file in the folder **engagement_data** represents data from one school district. The 4-digit file name represents *district_id* which can be used to link to district information in **district_info.csv**. The lp_id can be used to link to product information in product_info.csv.\n\n| Name | Description |\n|:----:|:-----------:|\n| time | date in \"YYYY-MM-DD\" |\n| lp_id | The unique identifier of the product |\n| pct_access | Percentage of students in the district have at least one page-load event of a given product and on a given day |\n| engagement_index | Total page-load events per one thousand students of a given product and on a given day |","c9c6048d":"#### Race\/ethnicity\n\nThis time I will compare two edge values - **0 to 0.2** and **0.8 to 1**","3f59e3f7":"#### State and locale\n\nI think the absence of state and locale id's can also mess further analysis. These rows also must be filled somehow, because I want to aggregate data by state later.","c93edaa6":"#### Some conslusion before 2nd part of analysis.\n\nThanks for comments, I will answer straight in the notebook. \nToday I've realized, that we do not have data for other years, before C-19. Conclusions based only on this data can be incorrect. I looked at school schedule, in general the behavior of this curve can be explained without influence of Covid.\n* [United States School Calendar 2021 and 2022](https:\/\/publicholidays.us\/school-holidays\/)\n\nI do not have access to previous year, but they can be similar. So let's look at some districts, I made a random choice:\n* [Madison City Schools in Alabama](https:\/\/publicholidays.us\/school-holidays\/alabama\/madison-city-schools\/)\n* [Aurora Public Schools in Colorado](https:\/\/publicholidays.us\/school-holidays\/colorado\/aurora-public-schools\/)\n* [Bethel School District in Oregon](https:\/\/publicholidays.us\/school-holidays\/oregon\/bethel-school-district\/)\n* [Washington County Public Schools in Maryland](https:\/\/publicholidays.us\/school-holidays\/maryland\/washington-county-public-schools\/)\n\nAll these schedules have some similarities:\n* **Start of school** - from 1st decade of August till 2nd decade of September\n* **End of school** - last days of May till 2nd decade of June.\nSo, the period from 2020-07 till 2020-08 with small index can be explained with school vacations.\n* **Thanksgiving Break and Christmas Break** - they both are here.\n* **The period from January to March** can be explained with a lack of interest to online courses after New Year's holidays. This must be compared to other years.\n* **Peak at the end of August** - start of school, students are choosing what to learn, they can visit the same pages again and again until made their choices and started to learn, after that plot becomes almost horizontal.\n\nAnd right now I do not know what to say about 1st decade of March.","449ecec1":"#### Geography","185cb8ec":"#### Other columns\n\nI will not touch other columns (percentages, county conn ratios), because this data must be real, not synthetic.","9ea0697b":"### *Question 2. What is the effect of the COVID-19 pandemic on online and distance learning, and how might this also evolve in the future?*\n\nThis question is passed for now - I'm not sure there is any relation between Covid-19 and engagement.\nBefore answering posterior questions, I'll make some transformations with data","a56c49ad":"### *Question 3. How does student engagement with different types of education technology change over the course of the pandemic?*\n\nHere are the plots of engagement flow for 5 sectors","457adfc6":"This plot has several zones:\n* First, end of 2020-02 - peak\n* First days of 2020-03 - fall\n* From 2nd decade of 2020-03 till 2020-07 - index is decreasing\n* From 2020-07 till 2020-08 there is a zone with small index\n* 2020-08 to 2020-09 is an increasing zone with a peak\n* From 2020-09 till 2021-01 is a period with constant high index\n* End of 2020 has local minimum - Christmas and New Year\n\nMy next step is to compare this to COVID flow.","ebcd4c3d":"##### In this case both indexes' values and patterns are similar. Ethnicity plays no role in engagement flow.","73362dc5":"### *Import*","5d1b373f":"#### Engagement by state and black\/hispanic percentage","afdde451":"I tried to compare mean of engagement index aggregated by state with ethnic and socioeconomic status, but these plots also did not show any pattern.","29b97557":"#### Engagement by state and socioeconomic status","1631c4d1":"#### Educational products\n\nDue to the interest to educational products, I will delete rows with NaNs in pct_access and last two columns.","499912db":"#### Pandas profiler is very great (at the same time very heavy and resource-consuming) package. It shows all statistic about our datasets, there's no need to add something else. Just conclusions.\n\n* **LP ID** has different names in **products** and **engagement**\n* **district_id** is represented as float (*real number*) though *int* will be enough - ID can not be a fraction\n* **time** is categorical, but must be a datetime format\n* there are bad brackets in **districts**, for example in **pct_black\/hispanic** column","9a6c70d8":"##### No need to continue with geo this way, patterns are similar (though the max index differs). If only we do not want to get detailed info about some state. States should be compared using some other type of plot.","04f2b4d9":"### *Question 1. What is the picture of digital connectivity and engagement in 2020? Engagement distribution plot will be the answer*","ea2b9d03":"### *Some more visualizations*\n\n#### Overall engagement variability: ethnic","2755a659":"### *Question 4. How does student engagement with online learning platforms relate to different geography? Demographic context (e.g., race\/ethnicity, ESL, learning disability)? Learning context? Socioeconomic status?*","505df22b":"Questions are:\n+ What is the picture of digital connectivity and engagement in 2020?\n+ What is the effect of the COVID-19 pandemic on online and distance learning, and how might this also evolve in the future?\n+ How does student engagement with different types of education technology change over the course of the pandemic?\n+ How does student engagement with online learning platforms relate to different geography? Demographic context (e.g., race\/ethnicity, ESL, learning disability)? Learning context? Socioeconomic status?\n+ Do certain state interventions, practices or policies (e.g., stimulus, reopening, eviction moratorium) correlate with the increase or decrease online engagement?","cf8b6195":"#### Socioeconomic"}}