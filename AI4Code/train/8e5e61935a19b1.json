{"cell_type":{"74f6d4bd":"code","dd3d6c8a":"code","09a9c3a5":"code","40b363e8":"code","dc11fe85":"code","a7bcf511":"code","deb09966":"code","e50abfff":"code","b2422fc0":"code","77c8373c":"code","50e4423e":"code","5f14ecde":"code","cd630424":"code","fd6f1821":"code","a430ed3a":"code","2b779c3e":"code","88969cef":"code","0da197fb":"code","139aff46":"code","f3811198":"code","41685586":"code","c45a39f4":"code","988f4a5e":"code","3734348d":"markdown","f3ea22d4":"markdown","b16d1212":"markdown","3cd702dd":"markdown","10de0c86":"markdown","cf327cbd":"markdown","373de390":"markdown","3254a056":"markdown","c1613362":"markdown","0f3802ab":"markdown","091cb5a1":"markdown","d540f3c5":"markdown","54b35a98":"markdown","e7cceab1":"markdown","6d33406a":"markdown","83ea13a2":"markdown","d55fe1c4":"markdown","d5f66c38":"markdown","45c207fb":"markdown","1b1abda1":"markdown"},"source":{"74f6d4bd":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.cluster import KMeans\nfrom sklearn import preprocessing\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","dd3d6c8a":"raw_data = pd.read_csv('\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\nraw_data.head()","09a9c3a5":"data = raw_data.set_index(['CustomerID'])","40b363e8":"mapping = { \"Gender\" : {\"Male\":0, \"Female\":1}} \ndata.replace(mapping, inplace=True)","dc11fe85":"data.head()","a7bcf511":"data.describe()","deb09966":"data.nunique()","e50abfff":"data.isnull().sum()","b2422fc0":"sns.pairplot(data)","77c8373c":"# pair plot with Gender\n\nsns.pairplot(data, hue = 'Gender', kind='reg')","50e4423e":"data.corr()","5f14ecde":"plt.matshow(data.corr())\nplt.colorbar()","cd630424":"corr = data.corr()\nsns.heatmap(corr, cmap='YlGnBu', linewidths='0.1')","fd6f1821":"sns.clustermap(corr)","a430ed3a":"corr.style.background_gradient(cmap='coolwarm')","2b779c3e":"## Building The Elbow Method Graph with full data\n\nwcss = []\nfor i in range(1,len(data)):\n    kmeans = KMeans(i)\n    kmeans.fit(data)\n    wcss.append(kmeans.inertia_)\nwcss","88969cef":"plt.plot(range(1,len(data)), wcss)","0da197fb":"wcss = []\nfor i in range(1,20):\n    kmeans = KMeans(i)\n    kmeans.fit(data)\n    wcss.append(kmeans.inertia_)\nwcss","139aff46":"plt.plot(range(1,20), wcss)","f3811198":"kmeans = KMeans(4)\nkmeans.fit(data)\nclusters = data.copy()\nclusters['prediction'] = kmeans.fit_predict(data)\nclusters[:15]","41685586":"plt.scatter(data['Spending Score (1-100)'],data['Annual Income (k$)'], c= clusters['prediction'], cmap='rainbow')\nplt.ylabel('Annual Income (k$)')\nplt.xlabel('Spending Score (1-100)')","c45a39f4":"kmeans = KMeans(5)\nkmeans.fit(data)\nclusters = data.copy()\nclusters['prediction'] = kmeans.fit_predict(data)\nplt.scatter(data['Spending Score (1-100)'],data['Annual Income (k$)'], c= clusters['prediction'], cmap='rainbow')\nplt.ylabel('Annual Income (k$)')\nplt.xlabel('Spending Score (1-100)')","988f4a5e":"kmeans = KMeans(6)\nkmeans.fit(data)\nclusters = data.copy()\nclusters['prediction'] = kmeans.fit_predict(data)\nplt.scatter(data['Spending Score (1-100)'],data['Annual Income (k$)'], c= clusters['prediction'], cmap='rainbow')\nplt.ylabel('Annual Income (k$)')\nplt.xlabel('Spending Score (1-100)')","3734348d":"### Here the cyan colour cluster could be divided into 2 parts","f3ea22d4":"## We'll Plot for k = 4,5,6 and check which value is best","b16d1212":"This is a simple example of KMeans clustering on Mall customers dataset for segregating the people depending upon their Annual income and Spending Score.","3cd702dd":"### This divided the middle cluster into further parts which is not required so K=5 looks like the best option hence we'll stop here as k=5 is the best approach","10de0c86":"### SNS Cluster Map","cf327cbd":"### By looking at Correlation matrix we can see that Age and Spending score are more linearly correlated than any other feature and Annual Income and Spending score are not at all linearly correlated ","373de390":"### This shows we have no null values in our data hence can now move forward with plotting","3254a056":"### Correlation matrix using SNS","c1613362":"### Correlation Matrix using Matplotlib","0f3802ab":"# Importing libraries","091cb5a1":"# We can look at this cluster graph and infer that the dataset is divided into 5 clusters\n\n## 1. Low income - Low Spending Score\n## 2. Low Income - High Spending Score\n## 3. Moderate Income - Moderate Spending Score\n## 4. High Income - Low Spending Score\n## 5. High Income - High Spending Score\n\n### There are a few Outliers as well in the data and we can choose either to neglect those or keep them for now as this is a very small dataset so the chances of overfitting are high","d540f3c5":"### By above plots we can see Annual Income and Spending score are forming clusters, Age and Spending score also form rough cluster and linear regressions are not a good way for this set of data","54b35a98":"# Reading and understanding Data","e7cceab1":"### There certainly can be another cluster for lower values of Spending Score so we'll try with k = 5","6d33406a":"# Pair plotting of data","83ea13a2":"### Looking at this we can see major curve is around 20, so we'll plot Elbow Curve again for range 1 to 20","d55fe1c4":"# Building Elbow method graph for identifying number of clusters","d5f66c38":"### I'll form corrlation matrix using 2-3 ways and you can pick the one you think is better for you","45c207fb":"# Correlation Matrix","1b1abda1":"### This provides us the number of unique values present in our data"}}