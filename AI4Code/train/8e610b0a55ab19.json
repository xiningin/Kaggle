{"cell_type":{"2a23aec9":"code","dbf0a867":"code","6b9c986b":"code","2e835d91":"code","3fcbacea":"code","626f993b":"code","66dd234d":"code","38c52d2c":"code","4fb5279c":"code","62765a77":"code","a78a5f00":"code","0067028f":"code","ad137e0d":"code","b5a55fef":"code","ed1f79db":"code","c82693e8":"code","4e07109c":"code","cda8c60a":"code","71c1b9bf":"code","f0ff4fd5":"code","abeae2fc":"code","f792fde3":"code","dbc9b6d4":"code","601dd872":"code","c6389ccd":"code","472180c2":"code","10e8e111":"code","df5c655d":"code","1ffc1455":"code","2ce6b8e6":"code","54d25f58":"code","d1ee694b":"code","817cae0d":"code","c9d725b2":"code","44133e17":"code","81f1d3fe":"code","58fd22e7":"code","3b243b57":"code","528f4eae":"code","d6829ca2":"code","0c9ca75f":"code","909f926e":"code","e8a3e9c3":"code","939b55c7":"code","70e1b6ce":"code","d91083bc":"code","521c1891":"code","6edfb31e":"code","5501d50f":"code","feefc300":"code","0dea2341":"code","3a420620":"code","5f894231":"code","1f258186":"code","27c20c09":"code","953b06aa":"code","b9850290":"code","b253d4fb":"code","4725e866":"code","fbe2a495":"code","f1f658f6":"code","fbef3f01":"markdown","8df6d93e":"markdown","0e2f7465":"markdown","ceebebea":"markdown","d2a2def3":"markdown","360135b5":"markdown","cc86d23b":"markdown","1ca70a1e":"markdown","14a02ee7":"markdown","61cfc1b7":"markdown","0d086083":"markdown","dfe6b229":"markdown","064577fd":"markdown","a70097c5":"markdown","6d9df602":"markdown","31d96589":"markdown","a408dc29":"markdown","075ff815":"markdown","044c4401":"markdown","a1f7dac9":"markdown","e83c4bb1":"markdown","b785d614":"markdown","1224c3ca":"markdown","c8eeec56":"markdown","43d7aafa":"markdown","98499482":"markdown","2e320d39":"markdown","26670af1":"markdown","0908adca":"markdown","db7c9fcc":"markdown","0fb88312":"markdown"},"source":{"2a23aec9":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nfrom google.cloud import bigquery","dbf0a867":"import bq_helper\n# create a helper object for this dataset\nbitcoin_blockchain = bq_helper.BigQueryHelper(active_project=\"bigquery-public-data\",\n                                              dataset_name=\"bitcoin_blockchain\")","6b9c986b":"bitcoin_blockchain.list_tables()","2e835d91":"bitcoin_blockchain.table_schema('blocks')","3fcbacea":"bitcoin_blockchain.table_schema('transactions')","626f993b":"bitcoin_blockchain.head('blocks')","66dd234d":"bitcoin_blockchain.head('transactions')","38c52d2c":"query4 = \"\"\"\nSELECT  TIMESTAMP_MILLIS(timestamp) AS day, output_pubkey_base58_error AS error from\n`bigquery-public-data.bitcoin_blockchain.transactions`JOIN\nUNNEST(outputs) WHERE output_pubkey_base58_error is not NULL limit 5000\n\"\"\"","4fb5279c":"bitcoin_blockchain.estimate_query_size(query4)","62765a77":"pubkey_error = bitcoin_blockchain.query_to_pandas_safe(query4, max_gb_scanned=4)","a78a5f00":"pubkey_error = pubkey_error.sort_values(by='day')","0067028f":"pubkey_error.head(10)","ad137e0d":"pubkey_error.tail(10)","b5a55fef":"pubkey_error.describe()","ed1f79db":"pubkey_error2 = pubkey_error.copy()\npubkey_error2['day'] = pubkey_error.day.apply(lambda x: str(x).split(' ')[0])","c82693e8":"pubkey_error2.head()","4e07109c":"error_count = pubkey_error2.groupby('day')['error'].count()","cda8c60a":"plt.figure(figsize=(15,8))\nplt.xticks(np.arange(error_count.shape[0])[::20], error_count.index[::20], rotation=90)\nplt.plot(error_count.index, error_count)\nplt.tight_layout()\nplt.show()","71c1b9bf":"query5 = \"\"\"\nSELECT TIMESTAMP_MILLIS(timestamp) AS day, input_pubkey_base58 AS input, output_pubkey_base58 AS output, \no.output_satoshis AS satoshi FROM \n`bigquery-public-data.bitcoin_blockchain.transactions` JOIN\nUNNEST(inputs), UNNEST(outputs) AS o WHERE 100000000000 < o.output_satoshis ORDER BY satoshi DESC limit 30000\n\"\"\"","f0ff4fd5":"bitcoin_blockchain.estimate_query_size(query5)","abeae2fc":"io_satoshi = bitcoin_blockchain.query_to_pandas_safe(query5, max_gb_scanned=63)","f792fde3":"io_satoshi.head(10)","dbc9b6d4":"io_satoshi.describe()","601dd872":"day = io_satoshi.day.apply(lambda x: str(x).split(' ')[0])","c6389ccd":"output_satoshi = io_satoshi.sort_values(by=\"satoshi\", ascending=False).groupby(['day','output'], as_index=False)['satoshi'].sum()\noutput_satoshi","472180c2":"output_satoshi[\"satoshi\"] = round(output_satoshi[\"satoshi\"] \/ 100000000)","10e8e111":"# Top10 of the sum of satoshi\nTop10 = output_satoshi.groupby(\"output\", as_index=False)['satoshi'].sum().sort_values(by='satoshi', ascending=False)[:10]\nTop10","df5c655d":"posi = np.arange(Top10.shape[0])\nplt.figure(figsize=(10,8))\nplt.xticks(posi,Top10.output, rotation=90)\nplt.bar(posi, Top10.satoshi)\nplt.title(\"Top10 addresses of the amount of bitcoins in output\")\nplt.ylabel(\"Bitcoins\")\nplt.tight_layout()\nplt.show()","1ffc1455":"output_satoshi.sort_values(by='satoshi',ascending=False)","2ce6b8e6":"output_satoshi.output.value_counts()","54d25f58":"frequent1 = output_satoshi[output_satoshi[\"output\"]=='3D2oetdNuZUqQHPJmcMDDHYoqkyNVsFk9r']\nfrequent1","d1ee694b":"plt.figure(figsize=(10,8))\nplt.plot(frequent1.day, frequent1.satoshi, marker='*', markersize=10)\nplt.ylabel(\"Bitcoins\")\nplt.title(\"The Changes in the amount of bit coins of the most frequently appearing output address\")\nplt.tight_layout()\nplt.show()","817cae0d":"frequent2 = output_satoshi[output_satoshi[\"output\"]=='1JrwWrt3TYUzMYFEBLX5hTo1zFsEY6tWZN']\nplt.figure(figsize=(10,8))\nplt.plot(frequent2.day, frequent2.satoshi, marker='*', markersize=10)\nplt.title(\"The Changes in the amount of bit coins of the secondary frequently appearing output address\")\nplt.tight_layout()\nplt.show()","c9d725b2":"output_satoshi2 = pd.DataFrame(output_satoshi['satoshi'].copy())\noutput_satoshi2[\"hour\"]= output_satoshi.day.apply(lambda x: str(x).split(' ')[1].split(':')[0])\noutput_satoshi2","44133e17":"each_hour = output_satoshi2.groupby(\"hour\",as_index=False)[\"satoshi\"].sum().sort_values(by='satoshi',ascending=False)\neach_hour","81f1d3fe":"plt.figure(figsize=(10,8))\nplt.bar(each_hour.hour, each_hour.satoshi)\nplt.ylabel(\"Bitcoins\")\nplt.xlabel(\"hour\")\nplt.title(\"The total amount of bitcoins \")\nplt.show()","58fd22e7":"each_hour_mean = output_satoshi2.groupby(\"hour\",as_index=False)[\"satoshi\"].mean().sort_values(by='satoshi',ascending=False)\neach_hour_mean","3b243b57":"plt.figure(figsize=(10,8))\nplt.bar(each_hour_mean.hour, each_hour_mean.satoshi)\nplt.ylabel(\"Bitcoins\")\nplt.xlabel(\"hour\")\nplt.title(\"The mean amount of bitcoins per transaction\")\nplt.show()","528f4eae":"output_satoshi2[\"hour\"].value_counts()","d6829ca2":"output_satoshi3 = pd.DataFrame(output_satoshi['satoshi'].copy())\noutput_satoshi3[\"day\"]= output_satoshi.day.apply(lambda x: str(x).split(' ')[0].split('-')[2])\noutput_satoshi3","0c9ca75f":"each_day = output_satoshi3.groupby(\"day\",as_index=False)[\"satoshi\"].sum().sort_values(by='satoshi',ascending=False)\neach_day","909f926e":"plt.figure(figsize=(10,8))\nplt.bar(each_day.day, each_day.satoshi)\nplt.ylabel(\"Bitcoins\")\nplt.xlabel(\"day\")\nplt.title(\"The total amount of bitcoins\")\nplt.show()","e8a3e9c3":"each_day_mean = output_satoshi3.groupby(\"day\",as_index=False)[\"satoshi\"].mean().sort_values(by='satoshi',ascending=False)\neach_day_mean","939b55c7":"plt.figure(figsize=(10,8))\nplt.bar(each_day_mean.day, each_day_mean.satoshi)\nplt.ylabel(\"Bitcoins\")\nplt.xlabel(\"day\")\nplt.title(\"The mean of the amount of bitcoins per transaction\")\nplt.show()","70e1b6ce":"# The number of  transactions\noutput_satoshi3[\"day\"].value_counts()","d91083bc":"each_day_std = output_satoshi3.groupby(\"day\")[\"satoshi\"].std()\neach_day_std","521c1891":"plt.figure(figsize=(10,8))\nplt.bar(np.arange(each_day_std.shape[0]), each_day_std)\nplt.ylabel(\"Bitcoins\")\nplt.xlabel(\"day\")\nplt.xticks(np.arange(each_day_std.shape[0]), each_day_std.index)\nplt.title(\"The std of the amount of bitcoins\")\nplt.show()","6edfb31e":"output_satoshi4 = pd.DataFrame(output_satoshi['satoshi'].copy())\noutput_satoshi4[\"month\"]= output_satoshi.day.apply(lambda x: str(x).split(' ')[0].split('-')[1])\noutput_satoshi4","5501d50f":"each_month = output_satoshi4.groupby(\"month\",as_index=False)[\"satoshi\"].sum().sort_values(by='satoshi',ascending=False)\neach_month","feefc300":"plt.figure(figsize=(10,8))\nplt.bar(each_month.month, each_month.satoshi)\nplt.ylabel(\"Bitcoins\")\nplt.xlabel(\"month\")\nplt.title(\"The total amount of bitcoins\")\nplt.show()","0dea2341":"September is No.1.","3a420620":"each_month_mean = output_satoshi4.groupby(\"month\",as_index=False)[\"satoshi\"].mean().sort_values(by='satoshi',ascending=False)\neach_month_mean","5f894231":"plt.figure(figsize=(10,8))\nplt.bar(each_month_mean.month, each_month_mean.satoshi)\nplt.ylabel(\"Bitcoins\")\nplt.xlabel(\"month\")\nplt.title(\"The mean of the amount of bitcoins per transaction\")\nplt.show()","1f258186":"September is the second lowest.","27c20c09":"# the numbers of transactions\noutput_satoshi4[\"month\"].value_counts()","953b06aa":"output_satoshi5 = pd.DataFrame(output_satoshi['satoshi'].copy())\noutput_satoshi5[\"year\"]= output_satoshi.day.apply(lambda x: str(x).split(' ')[0].split('-')[0])\noutput_satoshi5","b9850290":"each_year = output_satoshi5.groupby(\"year\",as_index=False)[\"satoshi\"].sum().sort_values(by='satoshi',ascending=False)\neach_year","b253d4fb":"plt.figure(figsize=(10,8))\nplt.bar(each_year.year, each_year.satoshi)\nplt.ylabel(\"Bitcoins\")\nplt.xlabel(\"year\")\nplt.title(\"The total amount of bitcoins \")\nplt.show()","4725e866":"each_year_mean = output_satoshi5.groupby(\"year\",as_index=False)[\"satoshi\"].mean().sort_values(by='satoshi',ascending=False)\neach_year_mean","fbe2a495":"plt.figure(figsize=(10,8))\nplt.bar(each_year_mean.year, each_year_mean.satoshi)\nplt.ylabel(\"Bitcoins\")\nplt.xlabel(\"year\")\nplt.title(\"The mean of the amount of bitcoins per transaction\")\nplt.show()","f1f658f6":"# the numbers of transactions\noutput_satoshi5[\"year\"].value_counts()","fbef3f01":"erroe comment is only one type (\"Cannot cast this script to a pay-to-address type\").","8df6d93e":"Very large number of errors was recorded on the specific days in 2015 and 2017.\u3000Did someone attack ?  \nAnd from around 2018-03 errors keep high level. Why?","0e2f7465":"# Month","ceebebea":"### The mean of the amount of bitcoins per transaction for each year","d2a2def3":"The shape of this graph is similar to the one above. This address exists only between 2013-08 and 2013-09.","360135b5":"### The mean of the amount of bitcoins per transaction for each month ","cc86d23b":"#### About the No.1 address(3D2oetdNuZUqQHPJmcMDDHYoqkyNVsFk9r)     the number of transactions :26","1ca70a1e":"The users of these addresses are individuals or companiesm?","14a02ee7":"### The total amount of bitcoins for each year","61cfc1b7":"## From here I use only Top 30000 transactions in which  \n## more than 100000000000  satoshis  is recorded ","0d086083":"### The mean amount of bitcoins per transaction for each hour****","dfe6b229":"### The mean of the amount of bitcoins per transaction for each day","064577fd":"#### the amount of transactions of each address","a70097c5":"The 27th has large values of mean and std. A part of the transactions may affect them. ","6d9df602":"the amount is sharply increased in 2011.","31d96589":"### Top10 addresses of the amount of bitcoins in output","a408dc29":"# Year","075ff815":"### The total amount of bitcoins for each month","044c4401":"The amount of Bitcoins at the first transaction of this address is very large compared to the subsequent transaction.","a1f7dac9":"The total amounts are large at 19,20 o'clock. People trade after their works?","e83c4bb1":"### The total amount of bitcoins for each hour","b785d614":"# Hour ","1224c3ca":"the mean value is sharply decreased in 2011. The reason are the rising in the value of Bitocoin and   \nthe increasing of the number of participants ?","c8eeec56":"The 12th is the largest. Is there any events?","43d7aafa":"### The total amount of bitcoins for each day","98499482":"# Day","2e320d39":"# Observing Bitcoin Data","26670af1":"## Observing with different time scales","0908adca":"#### About the No.2 address(1JrwWrt3TYUzMYFEBLX5hTo1zFsEY6tWZN) the number of transactions :25","db7c9fcc":"## Observing output_pubkey_base58_error","0fb88312":"### The std of the amount of bitcoins for each day"}}