{"cell_type":{"bf0b6f09":"code","325e3499":"code","d4cca3c9":"code","3a92ce66":"code","67182daa":"code","e3b3cac0":"code","45ca30ba":"code","787fed35":"code","86c9e4cd":"code","3b2e7da6":"markdown","d625013c":"markdown","c526ed9a":"markdown","015a10b3":"markdown","0493bd71":"markdown","c7816964":"markdown","09b1be70":"markdown"},"source":{"bf0b6f09":"!pip install --upgrade pip\n!pip uninstall -y allennlp\n!pip install transformers==4.1.1 typer\n!pip install -U pytorch-lightning\n!pip install https:\/\/github.com\/veritable-tech\/pytorch-lightning-spells\/archive\/master.zip","325e3499":"!mkdir -p \/src\/finetuning-t5\n!git clone https:\/\/github.com\/ceshine\/finetuning-t5.git -b mt5-classifier-single-token \/src\/finetuning-t5","d4cca3c9":"%cd \/src\/finetuning-t5\/mnli","3a92ce66":"!mkdir -p data\/kaggle\n!cp -r \/kaggle\/input\/multinli-nyu\/* data\/multinli_1.0\/\n!ls data\/kaggle\/","67182daa":"!mkdir -p cache\/kaggle\/\n!python preprocess\/preprocess_mnli.py\n!mkdir cache\/multinli\n!python preprocess\/tokenize_dataset.py multinli --tokenizer-name t5-large","e3b3cac0":"!SEED=333 python train.py --batch-size 32 --grad-accu 1 --max-len 128 --epochs 2 --t5-model t5-large --lr 3e-5 --dataset multinli --disable-progress-bar --valid-frequency 0.25","45ca30ba":"!python evaluate.py cache\/t5-large_best --corpus multinli --split-name test_matched --batch-size 16","787fed35":"!python evaluate.py cache\/t5-large_best --corpus multinli --split-name test_mismatched --batch-size 16","86c9e4cd":"!mv cache\/tb_logs \/kaggle\/working\n!mv cache\/t5-large_best \/kaggle\/working","3b2e7da6":"## Prepare the environment","d625013c":"## Export the Tensorboard log files and the trained model","c526ed9a":"## Get the code","015a10b3":"## Fine-tune the model","0493bd71":"## Preprocess the dataset","c7816964":"## Calculate accuracy of the \"mismatched\" dev set","09b1be70":"## Calculate accuracy of the \"matched\" dev set"}}