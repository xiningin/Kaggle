{"cell_type":{"6fc44ac2":"code","71b69f28":"code","99a03388":"code","273023b9":"code","f1736029":"code","7bf8df55":"code","caf99c32":"code","03f2bbcf":"code","3bfccc1d":"code","0ffe4f0a":"code","4857e856":"code","b19ce4c9":"code","9c8379eb":"code","9dbccff5":"code","8ef69102":"code","e763f1ae":"code","8aa9ddbf":"code","d1f208b9":"code","bcbbb19a":"code","4d915ff8":"code","2f5ef708":"markdown","f592af40":"markdown","c5bbdc7a":"markdown","0563fbab":"markdown"},"source":{"6fc44ac2":"#Importing all the necessary libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.experimental import enable_iterative_imputer\nfrom sklearn.impute import IterativeImputer, SimpleImputer\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder, MinMaxScaler\n\nfrom sklearn.model_selection import train_test_split, cross_val_score, RepeatedKFold, GridSearchCV\nfrom sklearn.linear_model import LogisticRegression, SGDClassifier\nfrom sklearn import metrics\nfrom sklearn.metrics import (\n    confusion_matrix, plot_confusion_matrix, accuracy_score, precision_score,\n    recall_score, f1_score, plot_roc_curve, plot_precision_recall_curve, precision_recall_curve,\n    roc_auc_score\n)","71b69f28":"#load and check the data\ntrain = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ntest = pd.read_csv(\"..\/input\/titanic\/test.csv\")","99a03388":"print(train.shape)\nprint(test.shape)","273023b9":"train.sample(5)","f1736029":"X = train.drop(['Survived'], axis=1)\nY = train.Survived","7bf8df55":"print(X.shape)\nprint(Y.shape)","caf99c32":"X.sample(5)","03f2bbcf":"test.sample(5)","3bfccc1d":"# Total missing values in each columns\ntrain.isnull().sum(axis=0)","0ffe4f0a":"# percentage of missing values in each columns\ntest.isnull().sum(axis=0)","4857e856":"pipeline1 = ColumnTransformer([\n    ('drop', 'drop', ['PassengerId', 'Name', 'Cabin', 'Ticket']),\n    ('ageimputer', IterativeImputer(max_iter=10, random_state=27), ['Age', 'Fare']),\n    ('embarkedimputer', SimpleImputer(strategy='most_frequent'), ['Embarked'])],\n    remainder='passthrough'\n)\n\npipeline2 = ColumnTransformer([\n    ('scaler', MinMaxScaler(), [0, 1, 5, 6]),\n    ('onehot', OneHotEncoder(), [2, 3, 4])\n])\n\npipeline = make_pipeline(pipeline1, pipeline2)","b19ce4c9":"pipeline.fit(X)\nX_train = pipeline.transform(X)\nX_test = pipeline.transform(test)","9c8379eb":"pd.DataFrame(X_train).sample(5)","9dbccff5":"pd.DataFrame(X_test).sample(5)","8ef69102":"lr = LogisticRegression(penalty='none', verbose=2)\nrr = SGDClassifier(penalty='l2', n_jobs=4, loss='log')\nls = SGDClassifier(penalty='l1', n_jobs=4, loss='log')\nen = SGDClassifier(penalty='elasticnet', n_jobs=4, loss='log')","e763f1ae":"metrics.SCORERS.keys()","8aa9ddbf":"cv = RepeatedKFold(n_splits=5, n_repeats=1, random_state=27)\n\ngrid_ridge_lasso = {\n    'alpha': np.arange(0, 1, 0.05),\n    'learning_rate': np.array(['constant']),\n    'eta0': np.array([0.1, 0.01, 0.001])\n}\n\ngrid_elastic = {\n    'alpha': np.arange(0, 1, 0.05),\n    'l1_ratio': np.arange(0, 1, 0.05),\n    'learning_rate': np.array(['constant']),\n    'eta0': np.array([0.1, 0.01, 0.001])\n}\n\nlr_score = cross_val_score(lr, X_train, Y, cv=cv, scoring='accuracy')\n\nrr_search = GridSearchCV(rr, grid_ridge_lasso, cv=cv, scoring='accuracy')\nrr_score = rr_search.fit(X_train, Y)\n\nls_search = GridSearchCV(ls, grid_ridge_lasso, cv=cv, scoring='accuracy')\nls_score = ls_search.fit(X_train, Y)\n\nen_search = GridSearchCV(en, grid_elastic, cv=cv, scoring='accuracy')\nen_score = en_search.fit(X_train, Y)","d1f208b9":"print(np.mean(lr_score))\nprint(rr_score.best_score_)\nprint(ls_score.best_score_)\nprint(en_score.best_score_)","bcbbb19a":"predictions = en_score.best_estimator_.predict(X_test)","4d915ff8":"pd.DataFrame({\n    'PassengerId': test.PassengerId,\n    'Survived': predictions\n}).to_csv('\/kaggle\/working\/submission_titanic_sgd_ls_lr.csv', index=False)","2f5ef708":"**Checking Missing values**","f592af40":"**Models**","c5bbdc7a":"# Name: Md. Azharul Islam\n# ID: 181-35-2329","0563fbab":"**Preprocessing Pipeline**"}}