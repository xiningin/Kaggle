{"cell_type":{"ae27b2e0":"code","59f1eb43":"code","1e69bd41":"code","c7ed9254":"code","9b19d503":"code","53f212ab":"code","36b438ca":"code","3f9f7071":"code","d79b3216":"code","582f7872":"code","98ecb9fa":"code","241da77d":"code","dbd6ec2c":"code","49ab8dfd":"code","813ce28b":"code","31185f36":"code","304ad290":"code","99d9e1df":"code","d6e453e2":"code","29bacf06":"code","c4d81f34":"code","b57afd8b":"code","8744d10c":"code","fd71c54f":"code","ff0e090a":"markdown","4f2f7a2f":"markdown","888e40c8":"markdown","40e0b5ed":"markdown","baa97348":"markdown","1c8876ee":"markdown","b7817da7":"markdown","e6297db4":"markdown","d2cf8001":"markdown","a020faa2":"markdown","9b21440d":"markdown","b4bdb75a":"markdown","756f3f7e":"markdown","ba1d38c1":"markdown","754095b7":"markdown","650cdcd8":"markdown","2c9e8d69":"markdown","98221ea7":"markdown","5c453a2a":"markdown","53abbd9a":"markdown","6186df07":"markdown","389bf415":"markdown","5fd8b2f0":"markdown","fedacace":"markdown","6efcc3fe":"markdown","46644cfe":"markdown","743a8ea5":"markdown","ff1ac471":"markdown"},"source":{"ae27b2e0":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","59f1eb43":"goals = pd.read_csv(\"\/kaggle\/input\/fifa-world-cup-2018-goals\/FifaWorldCup2018Goals.csv\")\ngoals.head()","1e69bd41":"goals.isnull().values.any()","c7ed9254":"matches = goals[['Home', 'Away', 'Stage']].drop_duplicates()\nmatches","9b19d503":"total_goals_scored_by_team = goals['ScoringTeam'].value_counts()\n\nplt.figure(figsize=(12, 6))\nsns.countplot(x='ScoringTeam', data=goals, order=total_goals_scored_by_team.index)\nplt.xticks(rotation=-60)\nplt.xlabel('Team')\nplt.ylabel('Goals scored')\nprint(\"Goals scored by every country bar plot:\")","53f212ab":"home_teams = matches['Home'].value_counts()\naway_teams = matches['Away'].value_counts()\n# During group stage every team needs to be both home side and away side at least once - we can just simple '+' for addition\ntotal_matches_by_team = home_teams + away_teams\n\n# Denmark and France played the only scoreless match so we will add it manually\ntotal_matches_by_team['France'] += 1\ntotal_matches_by_team['Denmark'] += 1\ntotal_matches_by_team = pd.DataFrame(total_matches_by_team, columns=['MatchPlayed'])\ntotal_matches_by_team.head()","36b438ca":"def get_stage(row):\n    if row['MatchPlayed'] == 3:\n        return 'Group'\n    if row['MatchPlayed'] == 4:\n        return 'R16'\n    if row['MatchPlayed'] == 5:\n        return 'QF'\n    \n    return 'FinalFour'\n\ntotal_matches_by_team['ReachedStage'] = total_matches_by_team.apply(lambda row: get_stage(row), axis=1)\ntotal_matches_by_team.head()","3f9f7071":"average_scored_goals_per_match = total_goals_scored_by_team \/ total_matches_by_team['MatchPlayed']\naverage_scored_goals_per_match.sort_values(ascending=False).plot(kind='bar', figsize=(12, 6))\nplt.xticks(rotation=-60)\nplt.xlabel('Team')\nplt.ylabel('Average goals scored')\nprint(\"Average goals scored per match for each country bar plot:\")","d79b3216":"goals_conceded_by_home_team = goals[goals['Home'] != goals['ScoringTeam']]['Home'].value_counts()\ngoals_conceded_by_away_team = goals[goals['Away'] != goals['ScoringTeam']]['Away'].value_counts()\n# There are some teams that did not concede a goal as an away team so we need to use add()\ntotal_goals_conceded_by_team = goals_conceded_by_home_team.add(goals_conceded_by_away_team, fill_value=0)\ntotal_goals_conceded_by_team.sort_values(ascending=False).head()","582f7872":"average_goals_conceded_per_match = total_goals_conceded_by_team \/ total_matches_by_team['MatchPlayed']\naverage_goals_conceded_per_match.sort_values(ascending=False).plot(kind='bar', figsize=(12, 6))\nplt.xticks(rotation=-60)\nplt.xlabel('Team')\nplt.ylabel('Average goals conceded')\nprint(\"Average goals conceded per match for each country bar plot:\")","98ecb9fa":"average_goals = pd.concat([average_scored_goals_per_match, average_goals_conceded_per_match], axis=1)\naverage_goals.columns = ['GoalsScored', 'GoalsConceded']\n\nstage_and_average_goals = average_goals.merge(total_matches_by_team, left_index=True, right_index=True)\nstage_and_average_goals.head()","241da77d":"sns.lmplot(x='GoalsScored', y='GoalsConceded', data=stage_and_average_goals,\n           fit_reg=True,\n           hue='ReachedStage', hue_order=['Group','R16','QF','FinalFour'])\n\n# Mark particular points\n# Note: These are not the real average goals values.\n# The annotation values are put in order to place the label on a good spot\nplt.annotate('Panama', (0.7, 3.45))\nplt.annotate('Senegal', (1.3, 1.15))\nplt.annotate('Tunisia', (1.55, 2.8))\nplt.annotate('Denmark', (0.75, 0.3))\nplt.annotate('Russia', (2.1, 1.5))\nplt.annotate('Belgium', (2.15, 0.65))","dbd6ec2c":"goals_per_stage = goals['Stage'].value_counts()\n\nround16 = goals_per_stage['Round16']\nquarterfinals = goals_per_stage['Quarterfinals']\nsemifinals = goals_per_stage['Semifinals']\nthird_place = goals_per_stage['ThirdPlace']\nfinal = goals_per_stage['Final']\n\ngoals_per_stage = goals_per_stage.drop(labels=['Round16', 'Quarterfinals', 'Semifinals', 'ThirdPlace', 'Final'])\ngoals_per_stage['Knockout'] = round16 + quarterfinals + semifinals + third_place + final\ngoals_per_stage.sort_values().plot(kind='barh')\nplt.xlabel('Average goals scored')\nplt.ylabel('Stage')","49ab8dfd":"sns.countplot(x='Type', data=goals, order=goals['Type'].value_counts().index)","813ce28b":"goals[(goals['Type'] == 'Penalty') | (goals['Type'] =='Freekick')]['ScoringTeam'].value_counts().plot(kind='bar')\nplt.xticks(rotation=-60)\nplt.xlabel('Team')\nplt.ylabel('Standard situation goals')","31185f36":"goals[goals['ScoringTeam'] == 'England']['Type'].value_counts().plot(kind='pie')","304ad290":"regular_goals = goals[goals['Type'] != 'Own']\nregular_goals.head(10)","99d9e1df":"regular_goals['Scorer'].value_counts().value_counts().plot(kind='barh')\nplt.xlabel('Number of goalscorers')\nplt.ylabel('Goals scored')","d6e453e2":"best_scorers = regular_goals['Scorer'].value_counts()\nbest_scorers.head(15)","29bacf06":"def calculate_goal(row):\n    return type_coefficient(row['Type']) * stage_coefficient(row['Stage']) * result_coefficient(row)\n    \ndef type_coefficient(goal_type):\n    if goal_type == 'Penalty':\n        return 0.75\n    if goal_type == 'Inside':\n        return 1.0\n    if goal_type == 'Outside':\n        return 1.5\n    if goal_type == 'Freekick':\n        return 2.0\n    \ndef stage_coefficient(stage):\n    if stage.startswith('Group'):\n        return 1.0\n    if stage == 'Round16':\n        return 1.25\n    if stage == 'Quarterfinals':\n        return 1.5\n    if stage == 'Semifinals' or stage == 'ThirdPlace':\n        return 1.75\n    if stage == 'Final':\n        return 2.0\n    \ndef result_coefficient(row):\n    result = row['Result'].split('-')\n    \n    if result[0] == result[1]:\n            # Final equalizer\n            if row['Result'] == row['FinalResult']:\n                return 1.5\n            \n            # Just equalizer\n            return 1.2\n        \n    if row['ScoringTeam'] == row['Home']:\n        # Goal for home team lead\n        if result[0] > result[1]:\n            # Winning goal home team\n            if row['Result'] == row['FinalResult']:\n                return 2\n            \n            # Just lead\n            return 1.5\n        \n        return 1\n    \n    # Goal for away team lead\n    if result[0] < result[1]:\n        # Winning goal away team\n        if row['Result'] == row['FinalResult']:\n            return 2\n            \n        # Just lead\n        return 1.5\n        \n    return 1","c4d81f34":"regular_goals['Value'] = regular_goals.apply(lambda row: calculate_goal(row), axis=1)\nregular_goals.head()","b57afd8b":"final_score = regular_goals[['Scorer', 'Value']].groupby(['Scorer']).sum().reset_index()\nfinal_score.columns = ['Scorer', 'GoalsValue']\nfinal_score.sort_values('GoalsValue', ascending=False).head(10)","8744d10c":"real_goals = pd.DataFrame(regular_goals['Scorer'].value_counts())\nreal_goals.columns = ['RealGoals']\n\nfinal_results = final_score.merge(real_goals, left_on='Scorer', right_index=True)\nfinal_results","fd71c54f":"sns.lmplot(x='RealGoals', y='GoalsValue', data=final_results)\n\n# Mark particular points\n# Note: These are not the real goals count and result values.\n# The annotation values are put in order to place the label on a good spot\nplt.annotate('Trippier', (1.0, 5.6))\nplt.annotate('Jedinak', (1.7, 1.5))\nplt.annotate('Mandzukic', (2.5, 7.7))\nplt.annotate('Mbappe', (3.7, 10.6))\nplt.annotate('Kane', (5.8, 8.0))","ff0e090a":"Not only that they scored the most goals from standard situations, but these goals make 1\/3 of their goals which obviously shows that they were particulary dangerous from these situations. Actually, if we take a look at the match highlights we can see that they scored 5 more goals after corner kicks and freekicks (which are marked as inside goals in the dataset) which increases the total sum of goals after standard situations to 9 or stunning 3\/4 of their goals. Nice job, Gareth Southgate!<br>\n<br>\n<font size='4'>Goalscorers analysis<\/font><br>\n<br>\nFirst, we will take all goals except own goals.","4f2f7a2f":"Panama was, by far, the worst defensive team in the tournament.<br>\nWe can see that none of the semifinal teams (France, Croatia, Belgium and England) is in top 5 defensive teams (France is best and ranked just 8th).<br>\nAnother famous quote, by this one widely used across multiple sports, is:<br>\n<center><i>Offense wins games. Defense wins championships.<\/i><\/center>\nWell... Not on this World cup as we can see.<br>\n<br>\nLets combine average scored\/conceded goals and add the data about the reached stage for each team into one dataframe.","888e40c8":"<font size=\"4\">Goals anaylsis<\/font>","40e0b5ed":"Read the dataset and have a glance at it.","baa97348":"Plot the average goals values and consider the reached stage.","1c8876ee":"Lets see who are the best goalscorers by this system.","b7817da7":"Of course, most of the scorers scored just one goal.<br>\n<br>\nWho were the best scorers?","e6297db4":"Check are there any missing values.","d2cf8001":"Apply the rules and calculate each goal value.","a020faa2":"As we can see, the data shows us the result of 63. This means that there was 1 scoreless match and actually that match was Denmark-France match from the group C. In comparison, the previous FIFA World Cup from 2014 had 7 scoreless matches.<br>\n<br>\nLets have a look at the number of goals score by every county.","9b21440d":"Now, we will check how many matches are there in the dataset. FIFA World Cup was expanded from 24 teams to 32 teams in 1998. The group stage consists of 8 groups with 4 teams and the 2 best teams advance to the round of 16. This format consists of 64 matches (including a 3rd place match).","b4bdb75a":"Based on the number of matches played, we will provide a category value of the reached stage for each team. That value is going to be used in one future plot.","756f3f7e":"As we can see, Harry Kane was the best goalscorer which provided him the Golden Boot award.<br>\n<br>\nIn my personal opinion, the basic goal count is not good and fair condition for this award. It is not the same if someone scores 3 penalties in group stage while somebody else scores 3 outside of the box goals in the knockout stage. So I decided to make a scoring system of my own with the following rules:<br>\n- goal worth by type  \n                      - penalty                  0.75\n                      - inside the box           1.00\n                      - outside the box          1.50\n                      - freekick                 2.00\n- goal worth by stage \n                      - group stage              1.00\n                      - round of 16              1.20\n                      - quarterfinals            1.50\n                      - semifinals and 3rd place 1.75\n                      - final                    2.00\n- goal worth by result after the goal was scored\n                      - losing goal              1.00\n                      - equalizer                1.20\n                      - final equalizer          1.50\n                      - leading goal             1.50\n                      - final leading\/winner     2.00\n<br>\nGoal worth = 'type' \\* 'stage' \\* 'result'","ba1d38c1":"Import statements","754095b7":"The best scoring teams are: Belgium (16), Croatia (14), France (14), England (12) and Russia (11). Then there is a 3 goals gap from the next best scoring team which is Brazil. Every team scored at least 2 goals.<br>\n<br>\nIn the world of football, Gary Lineker's quote about Germany is very well known:<br>\n<center><i>'Football is a simple game. 22 men chase the ball for 90 minutes and at the end, Germans always win.'<\/i><\/center><br>\nBut yeah... Not this time.<br>\nCurrent world champions at that time were a huge disapointement and got eliminated in the group stage, something that never happened to them (before this they got eliminated only once at the begining of tournament, in 1938, but at that World cup there were no group matches played as the tournament started directly with the round of 16).<br>\n<br>\nNow, we are going to calculate the number of matches played for every team.","650cdcd8":"Congratulations Kylian Mbappe on being the Most Valuable Goalscorer of the tournament!<br>\n<br>\nLets combine the results with the real goal counts for each player.","2c9e8d69":"And average conceded goals per match to see which teams had the best defense...","98221ea7":"Football logic should follow the rule where better teams score more and concede less (are closer to the bottom right corner) while worse teams score less and concede more (are closer to the upper left corner).<br>\nIf we take a look at the graph we can clearly see that is true as the regression lines move from upper-left position to the bottom-right position. Futhermore, a look at the groups of teams that reached the same stage and comparison of groups shows that teams that reached:<br>\n- round of 16 had very similar defense as teams which got eliminated in the group stage, but much better offense<br>\n- quarterfinals have siminar offense as teams from round of 16, but better defense<br>\n- final four actually had a bit worse defense than the teams from quarterfinals, but better offense<br>\n<br>\nI guess the quote should be:<br>\n<center><i>Offense wins round of 16. Defense wins quarterfinals. A bit of luck wins championships.<\/i><\/center>","5c453a2a":"For the end lets plot the real goals count and result values on a graph.","53abbd9a":"<font size=\"4\">Introduction<\/font><br>\n<br>\n<b>2018 FIFA World Cup<\/b> in Russia was the biggest sport event held in that particular year. Football once again proved to be the king of sports as millions around the world were waiting for highly anticipated 21st edition of the FIFA World Cup to kick off.<br>\n<br>\nAnd the world did truly get what it was waiting for.<br>\n<br>\nThe competition was full of wonderful goals and great performances, both team and individual. Benjamin Pavard got a well-deserved Goal of the tournament award for a stunning outside-the-box right foot volley against Argentina in Round of 16. In this kernel, I will make an analysis of the goals scored in the competition, as well as the analysis of the goalscorers.","6186df07":"Harry Kane did win the Golden Boot, but he is the biggest overachiever in the Golden Boot award race. His bad result in the new scoring system was affected by the facts that he scored 3 penalties and did not score any goal from round of 16 onwards. Another big overachiever is Mile Jedinak who scored 2 penalties (his only goals on the tournament).<br>\nSome players deserve much more praise for their efforts like Mbappe and Mandzukic. It is interesting to see Tripper's huge result with scoring only one goal (but that goal was a semifinal freekick leading goal).<br>\n<br>\n<br>\nThis is my first public kernel. I hope you like it!","389bf415":"Of course, most of the goals were scored from inside the box. It is interesting to see a high value for penalties - 22. Compraing to the last World cup 2014 Brazil were the value was 12, there is a 83.3% increase. Obviously, Video Assistant Referee (VAR) made a huge impact to the game.<br>\nUsually, in football, statistics say that there is one penalty every four matches, but in this World cup that number increased to one in every 3 matches.<br>\n<br>\nLets take a look at which teams scored the most goals from standard situations (situations which can be practiced during training). Standard situations in football are penalties, freekicks and corner kicks. This dataset does not provide information about which goals were scored after corner kick, but anyone who watched most of the tournament can probably remember that a good portion of penalties were given a result of corner kicks situations.","5fd8b2f0":"Values range from 0,67 to 2,28. Best scoring teams per match are: Belgium, Russia, Croatia and France. It is interesing to see Tunisia as the 7th best scoring team even though they finished the tournament in the group stage.<br>\n<br>\nLets calculate conceded goals as well.","fedacace":"As we can see England tops that list. Lets explore England's goal distribution by type.","6efcc3fe":"Now, lets take a look at the number of scorers which scored particular amount of goals.","46644cfe":"As it turns out, group stage matchday 2 and knockout stage had much more goals. While the group matchday 2 is not a surprise considering all the teams are still very motivated (unlike matchday 3) because the winners from matchday 1 want to keep the winning strike and losers have to go 'all-in' to pass the group stage, the fact that the knockout stage had the most goals was surprising to me. There were 47 goals in total in the knockout stage, while in 2014 FIFA World cup there were 'just' 35.<br>\n<br>\nLets take a look at the goal type distribution.","743a8ea5":"As the next step, we will calculate the average goals scored per match value and make a bar plot.","ff1ac471":"Looking at numbers and position of teams in graph we can see that Panama was clearly the worst team in the tournament while Belgium (finished 3rd) was the best. It is noticeable that there are some big outliers:<br>\n- Tunisia is much closer to the round of 16 group than the group stage group<br>\n- Senegal is in the middle of round of 16 group, but it was eliminated in the group stage*<br>\n- Denmark is closer to the group stage group<br>\n- Russia is not only close to the final four group, but actually went over to the better scoring side of that group<br>\n\nClearly we can see that some teams tournament results were far better than the performance (considering the goal statistics) like Denmark and some deserved far better result like Senegal and Russia.<br>\n<br>\n*Senegal definitely had a performance which should have deserved them the round of 16, but they were unfortunately eliminated in the group stage by the number of yellow cards given to them since Japan had the same points, goals scored, goals conceded and their matchup finished as a draw. This was the first time in history that yellow cards decided the team that goes through.<br>\n<br>\nNow, lets take a look at the number of goals scored by each stage\/round. All knockout matches are combined into a signle group in order to have the same amount of matches (16) in every group."}}