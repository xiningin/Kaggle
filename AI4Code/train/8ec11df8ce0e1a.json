{"cell_type":{"50d8bc3b":"code","0abe46c4":"code","80022c3f":"code","1032c850":"code","dd05dca5":"code","2bec523a":"code","509cca17":"code","043e9283":"code","6b2926c1":"code","29b1fb74":"code","1f758453":"code","7efccb24":"code","058b52aa":"code","0bddd6ff":"code","d17305d0":"code","9bbe45a9":"code","a0ba1fbc":"code","3c8d43ef":"code","4b382630":"code","520f98f3":"code","7c81b9f8":"code","68eaf269":"code","81dcaa4b":"code","2cb69c5c":"code","8e021efb":"code","51b44733":"code","93d314e5":"code","2c2e033c":"code","8fa5cd5f":"code","5861e3b1":"code","e426e908":"code","06964c66":"code","f5f59c17":"code","ab00c0f0":"code","96a7d95c":"code","ce0961b5":"code","b416a250":"code","44c24ca9":"code","404669c9":"code","c3d3d353":"code","34f5e9de":"code","ac10bdf7":"code","08ef398b":"code","611a6ba7":"code","f65d8fc8":"code","51a9b5cb":"markdown","575ce747":"markdown","305e1132":"markdown","7b023be6":"markdown","ab26063a":"markdown","ba8a3e31":"markdown","7c82b62b":"markdown","ea42cb3c":"markdown","fdae217e":"markdown","c02a647e":"markdown","203314fc":"markdown","136a2538":"markdown","8a9dad3d":"markdown","a7884cc8":"markdown","959c90bd":"markdown","13dad8fa":"markdown","d33764ef":"markdown","fe2b3a5f":"markdown","d3aef26a":"markdown","a4f49818":"markdown","38139a08":"markdown","e82c7778":"markdown","63b6adde":"markdown","85c16759":"markdown","c284f329":"markdown","74a9fda4":"markdown","129b4162":"markdown","f34c32df":"markdown","5b10716e":"markdown","dfb071b2":"markdown","12d1cc87":"markdown","0516bc9c":"markdown","6cefba88":"markdown","9b3b5dbd":"markdown","898ef157":"markdown","43da0acd":"markdown","2719ed1f":"markdown","81959e0c":"markdown","2a17f9be":"markdown"},"source":{"50d8bc3b":"!pip install --upgrade git+https:\/\/github.com\/goolig\/dsClass.git","0abe46c4":"import pandas as pd\nimport itertools\nfrom datetime import timedelta\nimport os\nimport matplotlib.pyplot as plt\nimport matplotlib.patches as mpatches\n%matplotlib inline\n\nimport seaborn as sns\nsns.set_context(\"poster\")\nplt.style.use('fivethirtyeight')\n#plt.style.use('ggplot')\nplt.rcParams['axes.labelweight'] = 'bold'\nplt.rcParams['axes.titleweight'] = 'bold'\nplt.rcParams['figure.titleweight'] = 'bold' \n\nfrom IPython.display import display, HTML\n\nimport numpy as np\nimport math\n\nimport datetime\nimport time\nimport sys\n\nimport networkx as nx\n\n\nimport sklearn\nprint(\"sklearn.__version__:\",sklearn.__version__)\n\nimport pylab as pl\nimport matplotlib.dates as mdates\n\n#print('Machine: {} {}\\n'.format(os.uname().sysname,os.uname().machine))\nprint(sys.version)\nfrom dsClass.path_helper import *","80022c3f":"import ipywidgets as widgets\nfrom ipywidgets import interact, interactive, fixed, interact_manual\nfrom IPython.display import display, Markdown","1032c850":"file_name = get_file_path(\"results_by_booth_2015 - english - v3_utf8.csv\")\nresult_df = pd.read_csv(file_name,delimiter=',')\nprint(\"Columns:\")\nprint(result_df.columns)\nprint()\nprint(\"df shape:\",result_df.shape)\nresult_df.tail(5)","dd05dca5":"result_df = result_df.dropna(axis=0, how='any')\nresult_df = result_df[result_df.votes > 0]\nresult_df.loc[result_df.Registered_voters == 0,'Registered_voters'] = result_df[result_df.Registered_voters == 0].votes\nresult_df.shape","2bec523a":"block_percent = 0.0325","509cca17":"all_registered_voters = result_df.Registered_voters.sum()\nall_votes = result_df.proper_votes.sum()\nprint(\"all registerd voters:\",all_registered_voters)\nprint(\"all_votes:\",all_votes)\nprint(\"vote percentage:\",all_votes\/all_registered_voters)\noverall_votes_per_party = result_df.iloc[:,8:].sum()\npercantage_vote_per_pary = overall_votes_per_party\/all_votes\npercantage_vote_per_pary = percantage_vote_per_pary[percantage_vote_per_pary.values>block_percent]\npercantage_vote_per_pary.sort_values(ascending=False).plot.bar(alpha=0.7)","043e9283":"# Print the large parties\nlarge_parties = percantage_vote_per_pary.index.values\nprint(large_parties)","6b2926c1":"non_party_col = list(result_df.iloc[:,0:8].columns)\nint_columns = []\nint_columns.extend(non_party_col)\nint_columns.extend(list(large_parties))\nprint(int_columns)","29b1fb74":"res_work_df = result_df.copy()\nres_work_df = res_work_df[int_columns]\nres_work_df_city = res_work_df.groupby(['settlement_name_english','Settlement_code'])[int_columns[4:]].sum().reset_index()\nprint(res_work_df_city.shape)\nres_work_df_city.head(5)","1f758453":"min_vote_rate = 0.6\nmin_proper_votes = 300","7efccb24":"res_work_df = res_work_df_city.copy()\nres_work_df['vote_rate'] = res_work_df.proper_votes \/ res_work_df.Registered_voters\nres_work_df = res_work_df[(res_work_df.vote_rate > min_vote_rate) & (res_work_df.proper_votes > min_proper_votes)]\nprint(res_work_df.shape)\nres_work_df.sample(10)","058b52aa":"res_work_df[res_work_df.settlement_name_english.str.contains(\"BE'ER SHEVA|TEL AVIV|JERU|HAI\")] # BE'ER SHEVA \/ TEL AVIV \/ JERUSALEM ","0bddd6ff":"res_work_df[res_work_df.vote_rate == np.inf]","d17305d0":"res_work_df_percentage_votes = res_work_df.iloc[:,6:-1].div(res_work_df.proper_votes, axis=0)\nres_work_df_percentage_votes.head(5)","9bbe45a9":"res_work_df_percentage_votes_transpose = res_work_df_percentage_votes.transpose()\nres_work_df_percentage_votes_transpose.head(11)","a0ba1fbc":"X = res_work_df_percentage_votes_transpose\nX.head(3)","3c8d43ef":"def above_median(fclist):\n    med = np.median(fclist)\n    return (fclist > med).astype(int)\n\nX = X.apply(above_median, axis=1)","4b382630":"X[1:10]","520f98f3":"names = res_work_df_percentage_votes_transpose.index.tolist()","7c81b9f8":"from sklearn.cluster import KMeans\n\nkm = KMeans(n_clusters=4, random_state=0).fit(X)\nclusters = km.labels_.tolist()\nclusters","68eaf269":"from sklearn.manifold import TSNE\n\ntsne = TSNE(n_components=2)\nresults_tsne = tsne.fit(X)\n\ncoords = results_tsne.embedding_\n\ncolors = ['blue','red','green','cyan','magenta','yellow','black','white']\nlabel_colors = [colors[i] for i in clusters]\n\nplt.subplots_adjust(bottom = 0.1)\nplt.scatter(\n    coords[:, 0], coords[:, 1], marker = 'o', c=label_colors\n    )\n\n#names = distance.index.values.tolist()\nfor label, x, y in zip(names, coords[:, 0], coords[:, 1]):\n    plt.annotate(\n        label,\n        xy = (x, y), xytext = (-20, 20),\n        textcoords = 'offset points', ha = 'right', va = 'bottom',\n        bbox = dict(boxstyle = 'round,pad=0.5', fc = 'yellow', alpha = 0.5),\n        arrowprops = dict(arrowstyle = '->', connectionstyle = 'arc3,rad=0'))\n\nplt.show()\n","81dcaa4b":"from sklearn.metrics.pairwise import pairwise_distances\nfrom sklearn.preprocessing import MinMaxScaler\n\nx = res_work_df_percentage_votes_transpose\n\nres = pairwise_distances(x, metric='correlation') # cosine \/ jaccard \/ correlation \/ euclidean\n\ndistance = pd.DataFrame(res, index=res_work_df_percentage_votes_transpose.index, \n                        columns= res_work_df_percentage_votes_transpose.index)\n\ndistance","2cb69c5c":"import scipy\nfrom scipy.cluster import hierarchy\n\nlabels = distance.index.values.tolist()\nsq_distance = scipy.spatial.distance.squareform(distance)\n\nZ = hierarchy.linkage(sq_distance, 'single')\n#plt.figure()\n#dn = hierarchy.dendrogram(Z)\n\nhierarchy.set_link_color_palette(['m', 'c', 'y', 'k'])\nfig, axes = plt.subplots(1, 1, figsize=(16, 6))\n#dn1 = hierarchy.dendrogram(Z, ax=axes[0], above_threshold_color='y', orientation='top', labels=labels)\ndn1 = hierarchy.dendrogram(Z, ax=axes, above_threshold_color='y', orientation='top', labels=labels)\n#dn2 = hierarchy.dendrogram(Z, ax=axes[1], above_threshold_color='#bcbddc', orientation='right', labels=labels)\nhierarchy.set_link_color_palette(None)  # reset to default after use\nplt.show()","8e021efb":"new_order_distance = distance.reindex(dn1['ivl'])\nnew_order_distance = new_order_distance[dn1['ivl']] ","51b44733":"import seaborn as sns\nax = sns.heatmap(new_order_distance)","93d314e5":"distance_cutoff = 1\nparties = percantage_vote_per_pary.index.tolist()\nparties","2c2e033c":"import itertools\ndist_list = list(distance.index)\nall_2_org_combos = itertools.combinations(dist_list, 2)\nmax_dist = distance.max().max()\n\n# Generate graph with nodes: \nG=nx.Graph()\n\nfor p in parties:\n    G.add_node(p,\n               name=p,\n               p_vote=float(percantage_vote_per_pary[p]),             \n               comm=\"0\") \n    \n# Connect nodes:\nfor combo in all_2_org_combos:\n    combo_dist = distance[combo[0]][combo[1]]\n    opp_dist = combo_dist - max_dist\n    if distance[combo[0]][combo[1]] < distance_cutoff:\n        G.add_edge(combo[0],combo[1],weight=float(abs(opp_dist)))\n        \n\nn = G.number_of_nodes()\nm = G.number_of_edges()     \nprint(\"number of nodes in graph G: \",n)\nprint(\"number of edges in graph G: \",m)\nprint()","8fa5cd5f":"#! conda install -c conda-forge python-louvain\n#! pip install python-Louvain","5861e3b1":"import community\ncommunities = community.best_partition(G)\nmod = community.modularity(communities,G)\nprint(\"modularity:\", mod)","e426e908":"G","06964c66":"if m > 0:         \n    for k,v in communities.items():\n        #for n in C:\n        G.nodes[k]['comm'] = str(v)\nelse:\n    print(\"Not runnig Community algorithm because the graph has no edges\")","f5f59c17":"com_values = [communities.get(node) for node in G.nodes()]\n\np_votes = [d['p_vote'] for n,d in G.nodes(data=True)]\nnode_size=[v * 3000 for v in p_votes]\n\n#pos=nx.spring_layout(G)\n#pos=nx.spectral_layout(G)\n#pos=nx.random_layout(G)\n#pos=nx.circular_layout(G)\n#pos = nx.shell_layout(G)\npos=nx.fruchterman_reingold_layout(G)\nnx.draw_networkx(G,pos, cmap = plt.get_cmap('jet'), node_color = com_values, node_size=node_size, with_labels=True)","ab00c0f0":"com_values = [communities.get(node) for node in G.nodes()]\np_votes = [d['p_vote'] for n,d in G.nodes(data=True)]\nnode_size=[v * 3000 for v in p_votes]\n\nnum_nodes = G.number_of_nodes()\nnum_edges = G.number_of_edges()\n\noptions_list = [\"spring_layout\", \"planar_layout\", \"circular_layout\", \"random_layout\", \"shell_layout\", \"spectral_layout\"]\n\nw_dropdown = widgets.Dropdown(\n    options=options_list,\n    value=options_list[0],\n    description='Layout:',\n    disabled=False,\n)\n\ndef display_plot(layout):\n    if layout==\"spring_layout\":\n        pos=nx.spring_layout(G, k=0.3, iterations=20, scale=2)\n    elif layout==\"planar_layout\": \n        pos=nx.planar_layout(G)\n    elif layout==\"circular_layout\":\n        pos=nx.circular_layout(G)\n    elif layout==\"random_layout\":\n        pos=nx.random_layout(G)\n    elif layout==\"shell_layout\":\n        pos=nx.shell_layout(G) \n    elif layout==\"spectral_layout\":\n        pos=nx.spectral_layout(G)      \n    else:    \n        print(\"problrm with choosing a layout\")\n        \n    plt.figure(figsize=(16,6))     \n    if num_edges > 1:\n        nx.draw_networkx(G,pos, cmap = plt.get_cmap('jet'), node_color = com_values, with_labels=True,  alpha=0.8, font_size=14)\n    else:\n        nx.draw_networkx(G,pos, cmap = plt.get_cmap('jet'), with_labels=True,  alpha=0.8, font_size=16)\n    plt.show() \n\ndisplay(Markdown(\"# Choose layout for network display\"))\ninteract(display_plot, layout=w_dropdown);","96a7d95c":"graphFileName = \"parties.gexf\"\nnx.write_gexf(G, graphFileName, encoding='utf-8')","ce0961b5":"res_work_df_percentage_votes.head(5)","b416a250":"#Q1 \n","44c24ca9":"distance_cutoff = 0.01\nmin_proper_votes = 1000","404669c9":"#Q2\n","c3d3d353":"#Q3","34f5e9de":"#Q4","ac10bdf7":"#Q5","08ef398b":"#Q6","611a6ba7":"#Q7","f65d8fc8":"#Q8","51a9b5cb":"# Data Import","575ce747":"## Check if there bad rows with infinite values","305e1132":"### Q4: Network Generation\n\u05e2\u05dc\u05d9\u05db\u05dd \u05dc\u05d9\u05e6\u05d5\u05e8 \u05d2\u05e8\u05e3 \u05d5\u05d1\u05d5 \u05db\u05dc \u05e7\u05d5\u05d3\u05e7\u05d5\u05d3 \u05d4\u05d5\u05d0 \u05d9\u05e9\u05d5\u05d1 \u05e9\u05e2\u05d5\u05de\u05d3 \u05d1\u05ea\u05e0\u05d0\u05d9 \u05de\u05d4\u05e1\u05e2\u05d9\u05e3 \u05d4\u05e7\u05d5\u05d3\u05dd, \u05d5\u05d1\u05d9\u05df \u05e9\u05ea\u05d9 \u05e2\u05e8\u05d9\u05dd \u05e7\u05d9\u05d9\u05de\u05ea \u05e7\u05e9\u05ea \u05d0\u05dd \u05d4\u05de\u05e8\u05d7\u05e7 \u05e9\u05d7\u05d9\u05e9\u05d1\u05ea\u05dd \u05d1\u05e1\u05e2\u05d9\u05e3 1 \u05d1\u05d9\u05df \u05d4\u05e2\u05e8\u05d9\u05dd \u05e7\u05d8\u05df \u05de0.015, \u05d4\u05e9\u05ea\u05de\u05e9\u05d5 \u05d1\u05de\u05d8\u05e8\u05d9\u05e6\u05ea \u05d4\u05de\u05e8\u05d7\u05e7\u05d9\u05dd \u05de\u05e1\u05e2\u05d9\u05e3 1.\n\n\u05db\u05de\u05d4 \u05e7\u05d5\u05d3\u05e7\u05d5\u05d3\u05d9\u05dd \u05d9\u05e9 \u05d1\u05d2\u05e8\u05e3?\n\u05db\u05de\u05d4 \u05e7\u05e9\u05ea\u05d5\u05ea \u05d9\u05e9 \u05d1\u05d2\u05e8\u05e3?\n","7b023be6":"\u05d1\u05e1\u05e2\u05d9\u05e3 \u05d6\u05d4 \u05e2\u05dc\u05d9\u05db\u05dd \u05dc\u05d9\u05e6\u05d5\u05e8 \u05e9\u05e0\u05d9 \u05de\u05d9\u05dc\u05d5\u05e0\u05d9\u05dd \u2013 hash tables, \u05d1\u05e8\u05d0\u05e9\u05d5\u05df (dict_idx2set_name) \u05d4\u05de\u05e4\u05ea\u05d7\u05d5\u05ea \u05d9\u05d4\u05d9\u05d5 \u05d4\u05d0\u05d9\u05e0\u05d3\u05e7\u05e1\u05d9\u05dd \u05e9\u05dc \u05d4\u05e2\u05e8\u05d9\u05dd \u05d1\u05d3\u05d0\u05d8\u05d0 \u05e1\u05d8 \u05d4\u05de\u05e7\u05d5\u05e8\u05d9 (res_work_df.index) \u05d5\u05d4\u05e2\u05e8\u05db\u05d9\u05dd \u05e9\u05dc \u05d4\u05de\u05d9\u05dc\u05d5\u05df \u05d9\u05d4\u05d9\u05d5 \u05e9\u05de\u05d5\u05ea \u05d4\u05d9\u05e9\u05d5\u05d1 \u05d1\u05d0\u05e0\u05d2\u05dc\u05d9\u05ea. \u05d1\u05de\u05d9\u05dc\u05d5\u05df \u05d4\u05e9\u05e0\u05d9 (dict_set_name2proper_votes) \u05d4\u05de\u05e4\u05ea\u05d7 \u05d4\u05d5\u05d0 \u05e9\u05dd \u05d4\u05d9\u05e9\u05d5\u05d1 \u05d1\u05d0\u05e0\u05d2\u05dc\u05d9\u05ea \u05d5\u05d4\u05e2\u05e8\u05da \u05d9\u05d4\u05d9\u05d4 \u05db\u05de\u05d5\u05ea \u05d4\u05e6\u05d1\u05e2\u05d5\u05ea \u05d7\u05d5\u05e7\u05d9\u05d5\u05ea.\n\u05d4\u05d3\u05d2\u05d9\u05de\u05d5 \u05e9\u05dc\u05d9\u05e4\u05d4 \u05dc\u05d3\u05d5\u05d2\u05de\u05d4 \u05de\u05db\u05dc \u05d0\u05d7\u05d3 \u05de\u05d4\u05de\u05d9\u05dc\u05d5\u05e0\u05d9\u05dd.\n","ab26063a":"# Overall Votes Per Party","ba8a3e31":"# 2015 Elections","7c82b62b":"\u05e4\u05d5\u05e0\u05e7\u05e6\u05d9\u05d5\u05ea \u05e2\u05d6\u05e8:\n* \u05d9\u05e6\u05d5\u05e8 \u05d2\u05e8\u05e3 \u05d7\u05d3\u05e9: nx.Graph()\n* \u05d4\u05d5\u05e1\u05e4\u05ea \u05e7\u05d5\u05d3\u05e7\u05d5\u05d3: G.add_node\n* \u05d4\u05d5\u05e1\u05e4\u05ea \u05e7\u05e9\u05ea: G.add_edge\n* \u05dc\u05e1\u05d9\u05d5\u05dd, \u05d4\u05d3\u05e4\u05d9\u05e1\u05d5 \u05d0\u05ea \u05db\u05de\u05d5 \u05d4\u05e7\u05e9\u05ea\u05d5\u05ea \u05d5\u05db\u05de\u05d5\u05ea \u05d4\u05e7\u05d5\u05d3\u05e7\u05d5\u05d3\u05d9\u05dd:\n* n = G.number_of_nodes()\n* m = G.number_of_edges()\n","ea42cb3c":"## Visualize Clusters","fdae217e":"## Q3: Create list of cities that hold all the constraints\n\n\u05e2\u05dc\u05d9\u05db\u05dd \u05dc\u05d9\u05e6\u05d5\u05e8 \u05e8\u05e9\u05d9\u05de\u05d4 \u05e9\u05dc \u05d4\u05d0\u05d9\u05e0\u05d3\u05e7\u05e1\u05d9\u05dd \u05e9\u05dc \u05d4\u05e2\u05e8\u05d9\u05dd, \u05d1\u05d4\u05dd \u05db\u05de\u05d5\u05ea \u05d4\u05d4\u05e6\u05d1\u05e2\u05d5\u05ea \u05d4\u05d9\u05d9\u05ea\u05d4 \u05d2\u05d3\u05d5\u05dc\u05d4 \u05de1000. \u05d4\u05d3\u05e4\u05d9\u05e1\u05d5 \u05d0\u05ea \u05d2\u05d5\u05d3\u05dc \u05d4\u05e8\u05e9\u05d9\u05de\u05d4.\n\n\u05db\u05ea\u05d1\u05d5 \u05d1\u05de\u05d9\u05dc\u05d9\u05dd \u05d0\u05d5 \u05d4\u05d3\u05e4\u05d9\u05e1\u05d5 \u05dc\u05de\u05e1\u05da - \u05db\u05de\u05d4 \u05e2\u05e8\u05d9\u05dd \u05e2\u05d5\u05e0\u05d5\u05ea \u05dc\u05d3\u05e8\u05d9\u05e9\u05d4?","c02a647e":"\u05d4\u05d3\u05e4\u05d9\u05e1\u05d5 \u05d0\u05ea \u05d4\u05e8\u05e9\u05ea. \u05d4\u05e9\u05ea\u05de\u05e9\u05d5 \u05d1\u05e4\u05d5\u05e0\u05e7\u05e6\u05d9\u05d4 nx.draw_networkx. \u05e0\u05d9\u05ea\u05df \u05dc\u05d4\u05e2\u05d6\u05e8 \u05dc\u05de\u05e9\u05dc \u05d1 nx.spring_layout \u05db\u05d3\u05d9 \u05dc\u05de\u05e6\u05d5\u05d0 \u05d0\u05ea \u05d4\u05de\u05d9\u05e7\u05d5\u05dd \u05d4\u05d0\u05d5\u05e4\u05d8\u05d9\u05de\u05dc\u05d9 \u05dc\u05db\u05dc \u05e2\u05d9\u05e8, \u05d9\u05e9 \u05e4\u05d5\u05e0\u05e7\u05e6\u05d9\u05d5\u05ea \u05e0\u05d5\u05e1\u05e4\u05d5\u05ea \u05e9\u05e2\u05d5\u05e9\u05d5\u05ea \u05d6\u05d0\u05ea. \u05e7\u05d1\u05e2\u05d5 \u05d0\u05ea \u05d2\u05d5\u05d3\u05dc \u05db\u05dc \u05e2\u05d9\u05e8 \u05dc\u05e4\u05d9 \u05db\u05de\u05d5\u05ea \u05d4\u05d4\u05e6\u05d1\u05e2\u05d5\u05ea\\\u05d3\u05e8\u05d2\u05ea\u05d4 (\u05db\u05de\u05d5\u05ea \u05e7\u05e9\u05ea\u05d5\u05ea).","203314fc":"## Q6: Add communitites information to the nodes in the network","136a2538":"# Clean Data","8a9dad3d":"# Remove low votings rates","a7884cc8":"## Q1: Build Distance matrix and view it","959c90bd":"## Q2: Create dictionaries if neccassary","13dad8fa":"## Q8 Calculate:\n\n### Sum over network\n- Using the network, sum proper votes for each community \n- Print the top 5 communities (in sum of votes) and the cities that compose them\n- For one of the cities in a top-5 community, print the votes for each party ","d33764ef":"## Build Network\n\n### Build the network of cities with the following attributes\n- distance_cutoff = 0.01\n- min_proper_votes = 1000 : use only cities where proper_votes > min_proper_votes\n- Data for each node: city code, city name, proper votes, community\n- Edge weight: similarity ","fe2b3a5f":"# Q9: Generate gexf file to view in Gephi\n* Save network to a gexf file format\n* Upload file in Gephi (install it localy from https:\/\/gephi.org\/users\/download\/ or use gephi online: https:\/\/www.rollapp.com\/app\/gephi)\n* Order layout using: OpenOrd \/ Yifan Hu \/ Fruchterman Reingold\n* Appearance of nodes:\n* Color nodes by community\n* Node size by number of votes (proper votes)\n* Label size by number of votes as well\n* Take a screen-shot of the entire network\n* Take a screen-shot of the largest community (sum over proper votes)\n* \u05d0\u05ea \u05d4\u05ea\u05de\u05d5\u05e0\u05d5\u05ea \u05d4\u05d2\u05d9\u05e9\u05d5 \u05d1\u05e7\u05d5\u05d1\u05e5 zip \u05d1\u05d4\u05d2\u05e9\u05d4 \u05d4\u05e0\u05e4\u05e8\u05d3\u05ea \u05e9\u05e0\u05e4\u05ea\u05d7\u05d4 \u05d1\u05de\u05d5\u05d3\u05dc. \n","d3aef26a":"## Run K-Means\n- Tanspose matrix\n- Convert numeric voting rate to (1,0) where 1 means the voting rate in that settelment was above the median","a4f49818":"# Group by City and Filter Out Small Parties","38139a08":"\u05d4\u05e0\u05ea\u05d5\u05e0\u05d9\u05dd \u05d0\u05e9\u05e8 \u05e7\u05d9\u05d1\u05dc\u05ea\u05dd \u05de\u05db\u05d9\u05dc\u05d9\u05dd \u05d0\u05ea \u05e8\u05d9\u05db\u05d5\u05d6 \u05ea\u05d5\u05e6\u05d0\u05d5\u05ea \u05d4\u05d1\u05d7\u05d9\u05e8\u05d5\u05ea \u05e2\u05d1\u05d5\u05e8 \u05d4\u05d1\u05d7\u05d9\u05e8\u05d5\u05ea \u05dc\u05db\u05e0\u05e1\u05ea \u05dc\u05d9\u05e9\u05e8\u05d0\u05dc \u05d1\u05e9\u05e0\u05ea 2015. \u05db\u05dc \u05e8\u05e9\u05d5\u05de\u05d4 \u05de\u05ea\u05d0\u05e8\u05ea \u05d0\u05ea \u05d4\u05ea\u05d5\u05e6\u05d0\u05d5\u05ea \u05e9\u05dc \u05e7\u05dc\u05e4\u05d9 \u05d0\u05d7\u05d3. \u05d4\u05e7\u05dc\u05e4\u05d9 \u05de\u05d6\u05d5\u05d4\u05d4 \u05dc\u05e4\u05d9 \u05de\u05d6\u05d4\u05d4 \u05d4\u05d9\u05e9\u05d5\u05d1 \u05d5\u05de\u05e1\u05e4\u05e8 \u05d4\u05e7\u05dc\u05e4\u05d9. \u05e9\u05dd \u05d4\u05d9\u05e9\u05d5\u05d1 \u05e0\u05d9\u05ea\u05df \u05d2\u05dd \u05d1\u05e2\u05d1\u05e8\u05d9\u05ea \u05d5\u05d1\u05d0\u05e0\u05d2\u05dc\u05d9\u05ea. \u05de\u05dc\u05d1\u05d3 \u05d6\u05d0\u05ea \u05e2\u05d1\u05d5\u05e8 \u05db\u05dc \u05e8\u05e9\u05d5\u05de\u05d4 \u05d9\u05d3\u05d5\u05e2 \u05db\u05de\u05d4 \u05de\u05e6\u05d1\u05d9\u05e2\u05d9\u05dd \u05e8\u05e9\u05d5\u05de\u05d9\u05dd \u05e2\u05d1\u05d5\u05e8\u05d4 \u05e7\u05d9\u05d9\u05de\u05d9\u05dd, \u05db\u05de\u05d4 \u05d4\u05e6\u05d1\u05e2\u05d5\u05ea \u05d4\u05d9\u05d5 \u05d1\u05e4\u05d5\u05e2\u05dc, \u05db\u05de\u05d4 \u05d4\u05e6\u05d1\u05e2\u05d5\u05ea \u05e0\u05e4\u05e1\u05dc\u05d5, \u05db\u05de\u05d4 \u05d4\u05e6\u05d1\u05e2\u05d5\u05ea \u05d7\u05d5\u05e7\u05d9\u05d5\u05ea \u05d4\u05ea\u05d1\u05e6\u05e2\u05d5 \u05d1\u05e7\u05dc\u05e4\u05d9 \u05d6\u05d5, \u05d5\u05e9\u05d0\u05e8 \u05d4\u05e9\u05d3\u05d5\u05ea \u05de\u05ea\u05d0\u05e8\u05d9\u05dd \u05d0\u05ea \u05db\u05de\u05d5\u05ea \u05d4\u05e7\u05d5\u05dc\u05d5\u05ea \u05e2\u05d1\u05d5\u05e8 \u05db\u05dc \u05de\u05e4\u05dc\u05d2\u05d4.","e82c7778":"# Distance Matrix\n- http:\/\/scikit-learn.org\/stable\/modules\/generated\/sklearn.metrics.pairwise.pairwise_distances.html\n- https:\/\/docs.scipy.org\/doc\/scipy\/reference\/spatial.distance.html#module-scipy.spatial.distance","63b6adde":"\u05dc\u05db\u05dc \u05e7\u05d5\u05d3\u05e7\u05d5\u05d3, \u05d4\u05d5\u05e1\u05d9\u05e4\u05d5 \u05d0\u05ea \u05d4\u05de\u05d9\u05d3\u05e2 \u05d1\u05e0\u05d5\u05d2\u05e2 \u05dc\u05e7\u05d4\u05d9\u05dc\u05d4 \u05e9\u05dc\u05d5. \n\u05db\u05d3\u05d9 \u05dc\u05de\u05dc\u05d0 \u05d0\u05ea \u05d4\u05e1\u05e2\u05d9\u05e3, \u05e2\u05dc\u05d9\u05db\u05dd \u05dc\u05e2\u05d1\u05d5\u05e8 \u05d1\u05dc\u05d5\u05dc\u05d0\u05d4 \u05e2\u05dc \u05db\u05dc \u05e4\u05e8\u05d9\u05d8 \u05e9\u05d4\u05d7\u05d6\u05d9\u05e8\u05d4 \u05d4\u05e4\u05d5\u05e0\u05e7\u05e6\u05d9\u05d4 best_partition \u05d5\u05dc\u05d4\u05d6\u05d9\u05df \u05d0\u05ea \u05e2\u05e8\u05da \u05d4\u05e7\u05d4\u05d9\u05dc\u05d4 \u05d4\u05de\u05ea\u05d0\u05d9\u05dd \u05dc\u05e7\u05d5\u05d3\u05e7\u05d5\u05d3. \u05e0\u05d9\u05ea\u05df \u05dc\u05d4\u05d6\u05d9\u05df \u05e2\u05e8\u05da value \u05dc\u05e7\u05d5\u05d3\u05e7\u05d5\u05d3 K \u05d1\u05e6\u05d5\u05e8\u05d4 \u05d4\u05d1\u05d0\u05d4:\n\nG.node[k]['comm'] = value\n","85c16759":"## Hierarchical Clustering","c284f329":"# Intersting  links:\n- https:\/\/github.com\/jtorrents\/pydata_bcn_NetworkX\/blob\/master\/NetworkX_SNA_workshop_with_solutions.ipynb","74a9fda4":"# Clustering","129b4162":"## Draw Network\n- https:\/\/networkx.github.io\/documentation\/networkx-1.10\/reference\/generated\/networkx.drawing.nx_pylab.draw_networkx.html\n- https:\/\/networkx.github.io\/documentation\/networkx-1.10\/reference\/drawing.html","f34c32df":"# Build Network","5b10716e":"# Calculate percentage votes for each city-party","dfb071b2":"## Communities and Modularity\n- https:\/\/en.wikipedia.org\/wiki\/Modularity_%28networks%29\n- https:\/\/en.wikipedia.org\/wiki\/Community_structure\n- https:\/\/en.wikipedia.org\/wiki\/Louvain_Modularity","12d1cc87":"## Generate gexf file to view in Gephi\n- Save network to a gexf file format\n- Upload file in Gephi\n- Order layout using: OpenOrd \/ Yifan Hu \/ Fruchterman Reingold\n- Appearance of nodes:\n  - Color nodes by community\n  - Node size by number of votes (proper votes)\n  - Label size by number of votes as well","0516bc9c":"## Distance Matrix\n- The distance will be between each city - try the correlation metric first\n- The vector of each city will be composed of the relative votes for each party","6cefba88":"# Now Generate a Similar Network For Cities ","9b3b5dbd":"## Q7 Draw Network\n- Set node size according to votes \/ degree\n- Try different layouts","898ef157":"# Imports","43da0acd":"## Heatmap of Distance Matrix Reordered as the Dendrogram","2719ed1f":"## With widgets\n* https:\/\/ipywidgets.readthedocs.io\/en\/stable\/examples\/Widget%20Basics.html\n* https:\/\/ipywidgets.readthedocs.io\/en\/stable\/examples\/Widget%20List.html","81959e0c":"\u05d0\u05ea\u05dd \u05de\u05ea\u05d1\u05e7\u05e9\u05d9\u05dd \u05dc\u05d7\u05e9\u05d1 \u05de\u05d8\u05e8\u05d9\u05e6\u05ea \u05de\u05e8\u05d7\u05e7\u05d9\u05dd \u05d1\u05d9\u05df \u05e2\u05d9\u05e8 \u05dc\u05e2\u05d9\u05e8 \u05d5\u05dc\u05d4\u05d3\u05e4\u05d9\u05e1 \u05d0\u05ea \u05e2\u05e9\u05e8\u05ea \u05d4\u05e9\u05d5\u05e8\u05d5\u05ea \u05d5\u05d4\u05e2\u05de\u05d5\u05d3\u05d5\u05ea \u05d4\u05e8\u05d0\u05e9\u05d5\u05e0\u05d5\u05ea \u05e9\u05d1\u05d4. \u05d4\u05de\u05e8\u05d7\u05e7 \u05de\u05d7\u05d5\u05e9\u05d1 \u05e2\"\u05d9 \u05e4\u05d5\u05e0\u05e7\u05e6\u05d9\u05d9\u05ea \u05e7\u05d5\u05e8\u05dc\u05e6\u05d9\u05d4 (\u05e4\u05d9\u05e8\u05e1\u05d5\u05df). \u05db\u05dc \u05e2\u05d9\u05e8 \u05de\u05d9\u05d5\u05e6\u05d2\u05ea \u05e2\"\u05d9 \u05d5\u05e7\u05d8\u05d5\u05e8 \u05d5\u05d1\u05d5 \u05db\u05de\u05d5\u05ea \u05d4\u05e6\u05d1\u05e2\u05d5\u05ea \u05d9\u05d7\u05e1\u05d9\u05ea \u05dc\u05db\u05dc \u05de\u05e4\u05dc\u05d2\u05d4 (res_work_df_percentage_votes).","2a17f9be":"## Q5: Run community algorithm\n\u05d1\u05d0\u05de\u05e6\u05e2\u05d5\u05ea \u05de\u05d5\u05d3\u05dc \u05d4\u05e7\u05d4\u05d9\u05dc\u05d5\u05ea, \u05e2\u05dc\u05d9\u05db\u05dd \u05dc\u05de\u05e6\u05d5\u05d0 \u05d0\u05ea \u05d4\u05d7\u05dc\u05d5\u05e7\u05d4 \u05d4\u05d0\u05d5\u05e4\u05d8\u05d9\u05de\u05dc\u05d9\u05ea \u05e9\u05dc \u05d4\u05d2\u05e8\u05e3, \u05d5\u05d0\u05ea \u05d4\u05de\u05d5\u05d3\u05dc\u05e8\u05d9\u05d5\u05ea \u05e9\u05dc\u05d5.\n\u05d4\u05e9\u05ea\u05de\u05e9\u05d5 \u05d1\u05d7\u05d1\u05d9\u05dc\u05ea \u05d4\u05e7\u05d4\u05d9\u05dc\u05d5\u05ea (import community) \u05d5\u05d1\u05e4\u05d5\u05e0\u05e7\u05e6\u05d9\u05d5\u05ea best_partition \u05d5 modularity \u05d1\u05d4\u05ea\u05d0\u05dd \u05db\u05d3\u05d9 \u05dc\u05de\u05dc\u05d0 \u05d0\u05ea \u05d4\u05e1\u05e2\u05d9\u05e3. \u05d4\u05d3\u05e4\u05d9\u05e1\u05d5 \u05dc\u05de\u05e1\u05da \u05d0\u05ea \u05db\u05de\u05d5\u05ea \u05d4\u05e7\u05d4\u05d9\u05dc\u05d5\u05ea \u05e9\u05e0\u05de\u05e6\u05d0\u05d5, \u05d5\u05d0\u05ea \u05d4\u05de\u05d5\u05d3\u05d5\u05dc\u05e8\u05d9\u05d5\u05ea.\n\u05dc\u05d0\u05d7\u05e8 \u05de\u05db\u05df, \u05de\u05e6\u05d0\u05d5 \u05d0\u05ea \u05d4\u05e7\u05d4\u05d9\u05dc\u05d4 \u05d4\u05d2\u05d3\u05d5\u05dc\u05d4 \u05d1\u05d9\u05d5\u05ea\u05e8 \u05d1\u05d2\u05e8\u05e3 \u05d5\u05d4\u05d3\u05e4\u05d9\u05e1\u05d5 \u05dc\u05de\u05e1\u05da \u05d0\u05ea \u05d2\u05d5\u05d3\u05dc\u05d4.\n\n\n- How many communities?\n- How many nodes in the largest community?\n- What is the modularity score?"}}