{"cell_type":{"d1977e4b":"code","9734dc30":"code","26d6fc9e":"code","72820b12":"code","d009e469":"code","30d91f1d":"code","318bd274":"code","c09e4cb7":"code","b541dc60":"markdown","b7f64a80":"markdown","816371c7":"markdown"},"source":{"d1977e4b":"import pandas as pd\nIS_LOCAL = False\nimport os\nif(IS_LOCAL):\n    PATH=\"..\/input\/heart.csv\"\nelse:\n    PATH=\"..\/input\/\"\nprint(os.listdir(PATH))\n\nds = pd.read_csv(PATH+'\/heart.csv')\nds.head()","9734dc30":"#importing some useful libraries\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\nds.describe()","26d6fc9e":"ds.hist('age')\nds.hist('cp')\nds.hist('trestbps')\nds.hist('chol')\nds.hist('fbs')\nds.hist('restecg')\nds.hist('thalach')\nds.hist('exang')\nds.hist('oldpeak')\nds.hist('slope')\nds.hist('ca')\nds.hist('thal')\nds.hist('target')\n","72820b12":"matrix = ds.corr()\nmatrix","d009e469":"targets = ds.pop('target').values\ndiscard_data = ds.pop('fbs')\nX = ds.values\n","30d91f1d":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, targets, test_size=.3, random_state=30)\n\n\nfrom sklearn.tree import DecisionTreeClassifier","318bd274":"classifier = DecisionTreeClassifier()\n\nclassifier.fit(X_train, y_train)\n\nclassifier.score(X_test, y_test)\ny_pred = classifier.predict(X_test)\n\nfrom sklearn.metrics import confusion_matrix\nconfusion_matrix(y_test, y_pred)\n","c09e4cb7":"from sklearn.metrics import classification_report\nprint(classification_report(y_test, y_pred))\n\nimport graphviz\nfrom sklearn.tree import export_graphviz\n\ndot_data  = export_graphviz(classifier, feature_names=ds.columns, class_names=['Saudavel', 'Doente'])\ngraph = graphviz.Source(dot_data)\ngraph\n\nfrom joblib import dump, load\n\ndump(classifier, 'classifier_001')\n\nnew_classifier = load('classifier_001')\n\nnew_classifier.score(X_test, y_test)\n\n","b541dc60":"Let's see the correlation matrix, to better comprehension about how connected and if we can disconsider some data (in fact I didn't disconsider any data in this notebook, but in my tests I've ignored \"chol\" and \"tbs\" data, but the accuracy have decreased near to 61%)","b7f64a80":"Let us assume that, this model can be predicted using a Decision Tree classifier.\nFirst, loading the data and looking into it","816371c7":"Now that we,ve seen how the data is distributed, we'll try to plot some histograms to understand better the data"}}