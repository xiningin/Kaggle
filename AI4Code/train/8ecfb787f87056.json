{"cell_type":{"ae75e346":"code","3cddec50":"code","f995f495":"code","cafb0e09":"code","90a10e76":"code","6e4d1b6b":"code","72eab6cb":"code","bed49863":"code","0504a988":"code","1d533d33":"code","6467d2bf":"code","f3482e81":"code","45568289":"code","7a16cfec":"markdown","2cc5eb96":"markdown","a4dcdb10":"markdown","d2ba7cdf":"markdown"},"source":{"ae75e346":"import numpy as np\nimport pandas as pd\n\nfrom sklearn.model_selection import train_test_split\n\nfrom sklearn.ensemble import RandomForestClassifier\n\nimport shap","3cddec50":"data = pd.read_csv(\"\/kaggle\/input\/water-potability\/water_potability.csv\")","f995f495":"data","cafb0e09":"data.info()","90a10e76":"data.isna().sum()","6e4d1b6b":"data.dropna(inplace=True)","72eab6cb":"def preprocess_inputs(df):\n    df = df.copy()\n    \n    y = df['Potability']\n    X = df.drop('Potability', axis=1)\n    \n    X_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.7, shuffle=True, random_state=1)\n    \n    return X_train, X_test, y_train, y_test","bed49863":"X_train, X_test, y_train, y_test = preprocess_inputs(data)","0504a988":"X_train","1d533d33":"y_train","6467d2bf":"model = RandomForestClassifier(random_state=1)\nmodel.fit(X_train, y_train)","f3482e81":"acc = model.score(X_test, y_test)\nprint(\"Accuracy: {:.2f}%\".format(acc * 100))","45568289":"explainer = shap.TreeExplainer(model)\nshap_values = explainer.shap_values(X_test)\nshap.summary_plot(shap_values, X_test, class_names=model.classes_)","7a16cfec":"## Getting Started","2cc5eb96":"## Feature Impact With SHAP Values","a4dcdb10":"## Training Model","d2ba7cdf":"## Preprocessing"}}