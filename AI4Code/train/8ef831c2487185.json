{"cell_type":{"7fa0f077":"code","4fb027f0":"code","60821b1e":"code","f4071a70":"code","ca8ce5b5":"code","941755e3":"code","70c28322":"code","55511991":"code","a2cf5dd7":"code","3d53ae6f":"code","b0cbf531":"code","1d506918":"code","4660c15b":"code","fd67e6d0":"code","c3271544":"code","880bcfbe":"code","0aa120ed":"code","ce1dbfe4":"code","f116bde2":"code","d2659c8a":"code","20aecaa2":"code","e87a5c38":"code","fadd78f8":"code","5e20f27a":"code","b77f7185":"code","b6586ae1":"code","03bc9d66":"code","5b75e7a3":"code","f5b0067a":"code","7144d258":"code","223d9cfb":"code","d7ff7e9a":"code","333b69c8":"code","4f0c2bd0":"code","2eff160c":"markdown","9225bfde":"markdown","0795f34c":"markdown","36d85c8e":"markdown","24fc1bdb":"markdown","3ac80521":"markdown","ad643d35":"markdown","82e9446f":"markdown","cb8e24d1":"markdown","71f03a81":"markdown","012d17b2":"markdown","dc9dd55c":"markdown","439e1c9b":"markdown","08426af5":"markdown","bdc459fc":"markdown","4cf9ef2c":"markdown","17e5c1f7":"markdown"},"source":{"7fa0f077":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","4fb027f0":"import pandas as pd\ndata = pd.read_csv('..\/input\/titanic\/train.csv')\ntest = pd.read_csv('..\/input\/titanic\/test.csv')\ndata.head()","60821b1e":"import seaborn as sns\nsns.set(style=\"darkgrid\")\nsns.catplot(x='Survived',y='Age',hue='Sex',data=data)","f4071a70":"sns.catplot(x='Survived',y='Age',hue='Sex',data=data,kind='point')","ca8ce5b5":"sns.catplot(x='Sex',y='Survived',hue='Pclass',data=data,kind='point')","941755e3":"sns.lmplot(x='Survived',y='Fare',col='Sex',row='Pclass',data=data,x_jitter=0.1)","70c28322":"data = data.replace({'male':1,'female':0,'S':0,'C':1,'Q':2})\ntest = test.replace({'male':1,'female':0,'S':0,'C':1,'Q':2})\ndata.head()","55511991":"data.isna().sum()","a2cf5dd7":"data = data.drop('Cabin',axis=1)\ntest = test.drop('Cabin',axis=1)\ndata.head()","3d53ae6f":"data['Age'] = data['Age'].fillna(data['Age'].mean())","b0cbf531":"data['Embarked'].mode()","1d506918":"data['Embarked'] = data['Embarked'].fillna(0)","4660c15b":"test.isna().sum()","fd67e6d0":"test['Age'] = test['Age'].fillna(test['Age'].mean())","c3271544":"test['Fare'] = test['Fare'].fillna(test['Fare'].mean())","880bcfbe":"data.dtypes","0aa120ed":"test.dtypes","ce1dbfe4":"data['Age'] = data['Age'].astype(int)\ndata['Embarked'] = data['Embarked'].astype(int)","f116bde2":"data.head()","d2659c8a":"test.head()","20aecaa2":"test['Age'] = test['Age'].astype(int)","e87a5c38":"data.groupby(['Sex','Survived']).size()","fadd78f8":"data.corr(method='pearson')","5e20f27a":"data.head()","b77f7185":"data = data.drop(['Name','Ticket','PassengerId'],axis=1)\ntest = test.drop(['Name','Ticket','PassengerId'],axis=1)","b6586ae1":"data.head()","03bc9d66":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import classification_report\nfrom sklearn.model_selection import train_test_split\nX = data.drop('Survived',axis=1)\nY = data['Survived']\nX_train, X_test, Y_train, Y_test = train_test_split(X,Y,test_size=0.1,random_state=10)\nlogreg = LogisticRegression()\nlogreg.fit(X_train,Y_train)\nY_pred = logreg.predict(X_test)\nprint(classification_report(Y_test,Y_pred))\nprint(accuracy_score(Y_test,Y_pred))","5b75e7a3":"#accuracy using CV\naccuracy = cross_val_score(logreg,X,Y,cv=10)\nprint(accuracy.mean())","f5b0067a":"from sklearn.naive_bayes import GaussianNB\ngnb = GaussianNB()\ngnb.fit(X_train,Y_train)\nY_predGNB = gnb.predict(X_test)\nprint(classification_report(Y_test,Y_predGNB))\nprint(accuracy_score(Y_test,Y_predGNB))","7144d258":"#Accuracy using CV \naccuracy_gnb = cross_val_score(gnb,X,Y,cv=10,scoring='accuracy')\nprint(accuracy_gnb.mean())","223d9cfb":"from sklearn.svm import SVC, LinearSVC\nsvc = SVC()\nsvc.fit(X_train, Y_train)\nY_pred_SVC = svc.predict(X_test)\nprint(classification_report(Y_test,Y_pred_SVC))\nprint(accuracy_score(Y_test,Y_pred_SVC))","d7ff7e9a":"#Now using CV\naccuracy_svc = cross_val_score(svc,X,Y,cv=10,scoring='accuracy')\nprint(accuracy_svc.mean())","333b69c8":"from sklearn.ensemble import RandomForestClassifier\nclf = RandomForestClassifier(n_estimators=200)\nclf.fit(X_train,Y_train)\nY_pred_RF = clf.predict(X_test)\nprint(classification_report(Y_test,Y_pred_RF))\nprint(accuracy_score(Y_test,Y_pred_RF))            ","4f0c2bd0":"#Now using CV\naccuracy_rf = cross_val_score(clf,X,Y,cv=5,scoring='accuracy')\nprint(accuracy_rf.mean())","2eff160c":"Let us find out the correlation between all the variables","9225bfde":"So,finally we have achieved the accuracy of 82% with the help of Random forest classifier, we can also implement grid search to find out what value of n_estimators will be best to fit the model","0795f34c":"let's check the data types of the both the datasets","36d85c8e":"Now convert age into integer as age will always be an integer.","24fc1bdb":"This graph shows the survival rate with respect to age and gender. we can clearly see that mid-age range has the higher chances of survival.","3ac80521":"Drop Name,PassengerID and Ticket columns as these three columns doesn't contain any specific information as far as survival rate is concerned","ad643d35":"it's clearly visible that sex is highly correlated with survival rate.","82e9446f":"Visualization of independent variables with target variable using seaborn library","cb8e24d1":"Now, let's apply cross validation on the whole dataset","71f03a81":"This graph shows that probability of survival for females is more than males.","012d17b2":"Now let's do the same for test data.","dc9dd55c":"This graph clearly shows that females belonging to passenger class 1 have the highest chance of survival.","439e1c9b":"Now, let's check if there are any null values in the dataset","08426af5":"As cabin is having almost 80% of null values. so, its better to drop this column","bdc459fc":"Now let's fill the null values in age and embarked. i am going to fill age column with the mean as it is a continous variable and will convert it into integer afterwards and fill embarked with the mode of the column as it is a categorical data.","4cf9ef2c":"Now we will prepare our dataset for exploration","17e5c1f7":"First of all let's start with Logistic regression to see the accuracy with which we can predict our test dataset"}}