{"cell_type":{"ca455abb":"code","df71cdad":"code","707db41c":"code","0bc2b058":"code","c35eb070":"code","ad034611":"code","e96eebda":"code","f75dd49c":"code","89fae247":"code","9d5f9821":"code","b60b6c18":"code","f26db178":"code","47c83dae":"code","79ed6a4e":"code","0d9639c5":"code","563d8fbd":"markdown","32b5ed58":"markdown","228f8dc4":"markdown","6c97d35f":"markdown","c398c010":"markdown","f96e6136":"markdown","989eed0c":"markdown","86beb301":"markdown","87eca08f":"markdown","00b97e0b":"markdown"},"source":{"ca455abb":"import numpy as np\nimport pandas as pd\nimport cv2\nfrom keras.preprocessing import image\nimport matplotlib.pyplot as plt\nplt.style.use('fivethirtyeight')","df71cdad":"#settings\npd.options.display.max_columns = 999","707db41c":"train = pd.read_csv('..\/input\/shopee-product-detection-student\/train.csv')\ntest = pd.read_csv('..\/input\/shopee-product-detection-student\/test.csv')","0bc2b058":"train['category'] = train['category'].astype('object')\ncategory_replace = {0:'00',1:'01',2:'02',3:'03',4:'04',5:'05',6:'06',7:'07',8:'08',9:'09'}\ntrain['category'] = train['category'].replace(category_replace.keys(), category_replace.values()).astype('str')","c35eb070":"train.info()","ad034611":"train.head()","e96eebda":"fig, [ax1, ax2] = plt.subplots(1,2, figsize=(10,4))\n\ntrain['category'].astype('int').plot.hist(bins=42, ax=ax1);\nplt.xlabel('category');\nprint(train['category'].describe())\nprint('\\nmedian counts: {:.2f}'.format(train['category'].value_counts().median()))\nprint('mean counts: {:.2f}'.format(train['category'].value_counts().mean()))\nax2.hist(train['category'].value_counts(), bins=42)\nax1.set_xlabel('category'), ax2.set_xlabel('counts')\n\npd.DataFrame(train['category'].value_counts().sort_values()).T","f75dd49c":"PATH = \"..\/input\/shopee-product-detection-student\/train\/train\/train\/\"","89fae247":"#we'll plot 10 random photos everytime we run this command\nfig, axes = plt.subplots(1,10,figsize=(15,5))\nfor [filename, category], ax in zip(train.values[np.random.randint(low=1,high=train.shape[0],size=10)], axes):\n    img = image.load_img(PATH+category+'\/'+filename, target_size=(300,300))\n    ax.imshow(img), ax.text(0,0,category,c='red'), ax.axis('off')","9d5f9821":"#we'll plot 10 random photos everytime we run this command\nfig, axes = plt.subplots(1,10,figsize=(15,5))\nfor [filename, category], ax in zip(train[train['category'] == '33'].values[np.random.randint(low=1,high=train[train['category'] == '33'].shape[0],size=10)], axes):\n    img = image.load_img(PATH+category+'\/'+filename, target_size=(300,300))\n    ax.imshow(img), ax.text(0,0,category,c='red'), ax.axis('off')","b60b6c18":"#we'll plot 10 random photos everytime we run this command\nfig, axes = plt.subplots(1,10,figsize=(15,5))\nfor [filename, category], ax in zip(train[train['category'] == '17'].values[np.random.randint(low=1,high=train[train['category'] == '33'].shape[0],size=10)], axes):\n    img = image.load_img(PATH+category+'\/'+filename, target_size=(300,300))\n    ax.imshow(img), ax.text(0,0,category,c='red'), ax.axis('off')","f26db178":"#we'll plot 10 random photos everytime we run this command\nfig, axes = plt.subplots(1,10,figsize=(15,5))\nfor [filename, category], ax in zip(train[train['category'] == '37'].values[np.random.randint(low=1,high=train[train['category'] == '33'].shape[0],size=10)], axes):\n    img = image.load_img(PATH+category+'\/'+filename, target_size=(300,300))\n    ax.imshow(img), ax.text(0,0,category,c='red'), ax.axis('off')","47c83dae":"#we'll plot 10 random photos everytime we run this command\nfig, axes = plt.subplots(1,10,figsize=(15,5))\nfor [filename, category], ax in zip(train[train['category'] == '30'].values[np.random.randint(low=1,high=train[train['category'] == '33'].shape[0],size=10)], axes):\n    img = image.load_img(PATH+category+'\/'+filename, target_size=(300,300))\n    ax.imshow(img), ax.text(0,0,category,c='red'), ax.axis('off')","79ed6a4e":"#we'll plot 10 random photos everytime we run this command\nfig, axes = plt.subplots(1,10,figsize=(15,5))\nfor [filename, category], ax in zip(train[train['category'] == '24'].values[np.random.randint(low=1,high=train[train['category'] == '33'].shape[0],size=10)], axes):\n    img = image.load_img(PATH+category+'\/'+filename, target_size=(300,300))\n    ax.imshow(img), ax.text(0,0,category,c='red'), ax.axis('off')","0d9639c5":"#we'll plot 10 random photos everytime we run this command\nfig, axes = plt.subplots(1,10,figsize=(15,5))\nfor [filename, category], ax in zip(train[train['category'] == '03'].values[np.random.randint(low=1,high=train[train['category'] == '33'].shape[0],size=10)], axes):\n    img = image.load_img(PATH+category+'\/'+filename, target_size=(300,300))\n    ax.imshow(img), ax.text(0,0,category,c='red'), ax.axis('off')","563d8fbd":"# Load Data","32b5ed58":"## Let's plot the category with the least labels","228f8dc4":"Looks like what we need for covid","6c97d35f":"We are not lucky enough to observe the noisy data Shopee said. We shall leave it to the machine to tell us when we start to build our predictive models.","c398c010":"# Visualizing photos","f96e6136":"Let's plot some image","989eed0c":"The data is left skewed, some of the category has far fewer labels than the majority","86beb301":"It's actually quite easy to guess what are the categories. However, hard coding is both not allowed and not recommended. It'll take forever if we were to manually label every single items","87eca08f":"## Let's plot the category with the most labels","00b97e0b":"# Library"}}