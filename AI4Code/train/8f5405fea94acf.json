{"cell_type":{"30a82f5f":"code","f7bbdd5e":"code","26a3fe90":"code","3fbaef46":"code","1c2334ce":"code","e4bfb9bc":"code","f068c209":"markdown","156eda17":"markdown","cf3bf093":"markdown","645f4fe4":"markdown","49e444b6":"markdown"},"source":{"30a82f5f":"# Importing the libraries\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd","f7bbdd5e":"# Importing the dataset\ndataset = pd.read_csv('..\/input\/mall-customers\/Mall_Customers.csv')\ndataset.head()","26a3fe90":"# taking last and second last columns as input as specified in our problem.\nX = dataset.iloc[:, [3, 4]].values","3fbaef46":"# creating dendogram to find no. of suitable clusters\nimport scipy.cluster.hierarchy as sch\nplt.figure(figsize=(20,10))\ndendrogram = sch.dendrogram(sch.linkage(X, method='ward'))\nplt.title('Dendrogram')\nplt.xlabel('Customers')\nplt.ylabel('Euclidean distances')\nplt.show()","1c2334ce":"# Training the Hierarchical Clustering model on the dataset\nfrom sklearn.cluster import AgglomerativeClustering\nhc = AgglomerativeClustering(n_clusters = 5, affinity = 'euclidean', linkage = 'ward')\ny_hc = hc.fit_predict(X)","e4bfb9bc":"# Visualising the clusters\nplt.figure(figsize=(20,10))\nplt.scatter(X[y_hc == 0, 0], X[y_hc == 0, 1], s = 100, c = 'red', label = 'Cluster 1')\nplt.scatter(X[y_hc == 1, 0], X[y_hc == 1, 1], s = 100, c = 'blue', label = 'Cluster 2')\nplt.scatter(X[y_hc == 2, 0], X[y_hc == 2, 1], s = 100, c = 'green', label = 'Cluster 3')\nplt.scatter(X[y_hc == 3, 0], X[y_hc == 3, 1], s = 100, c = 'cyan', label = 'Cluster 4')\nplt.scatter(X[y_hc == 4, 0], X[y_hc == 4, 1], s = 100, c = 'magenta', label = 'Cluster 5')\nplt.title('Clusters of customers')\nplt.xlabel('Annual Income (k$)')\nplt.ylabel('Spending Score (1-100)')\nplt.legend()\nplt.show()","f068c209":"# Visualization\nwe will be using matplotlib to visualize our clusters","156eda17":"# Introduction\n\nHello my fellow kagglers! In this notebook, we will be learning Hierarchical Clustering. \nSo, let's get started without wasting our time. \n\n# Lets import required libraries.\n","cf3bf093":"*If we draw a straight line across the maximum distance in between 150 and 200, we will get 5 clusters as shown in the Dendrogram.*\n\n# Model training\nwe will use Agglomerative Clustering for this problem to train our model.","645f4fe4":"# optimal number of cluster\nto find the optimal number of clusters we will use dendogram.","49e444b6":"# Let's import our dataset and take a look at it."}}