{"cell_type":{"55263ca7":"code","5017bdbd":"code","ec24669b":"code","fd5dc3ca":"code","6ee468f4":"code","9cc3fff7":"code","9ce831b6":"code","f649ec56":"code","5a15cf44":"code","ccb339ba":"code","eb30249f":"code","d792b051":"code","c1c7c3a3":"code","d69c328b":"markdown","ca18a273":"markdown","cfcc1045":"markdown","c3c554b0":"markdown","9ef848b7":"markdown"},"source":{"55263ca7":"import pandas as pd\nimport numpy as np\nimport ast # for dict parsing down the track","5017bdbd":"test = pd.read_csv('..\/input\/test_v2.csv',dtype={'fullVisitorId': 'str'})","ec24669b":"submission_sample = pd.read_csv('..\/input\/sample_submission_v2.csv',dtype={'fullVisitorId': 'str'})\nsubmission_sample.shape","fd5dc3ca":"submission_sample.head()","6ee468f4":"test.shape","9cc3fff7":"test_prep = test.copy()\ntest_prep['PredictedLogRevenue'] = 0\nsubmission_no_return = test_prep.groupby('fullVisitorId',as_index=False).PredictedLogRevenue.sum()\nsubmission_no_return.head()","9ce831b6":"submission_no_return.shape","f649ec56":"submission_no_return.to_csv('submission_no_return.csv',index=False)","5a15cf44":"test_prep_2 = test.copy()\ntest_prep_2['Revenue'] = test_prep_2['totals'].apply(lambda x: ast.literal_eval(x).get('transactionRevenue',np.nan))","ccb339ba":"test_prep_2['Revenue'] =pd.to_numeric(test_prep_2['Revenue'],errors='coerce')","eb30249f":"submission_right_answer = test_prep_2.groupby('fullVisitorId',as_index=False).Revenue.sum()\nsubmission_right_answer['PredictedLogRevenue'] = submission_right_answer.Revenue.apply(lambda x: np.log(x+1))\nsubmission_right_answer.drop(columns='Revenue',inplace=True)\nsubmission_right_answer.head()","d792b051":"submission_right_answer.shape","c1c7c3a3":"submission_right_answer.to_csv('submission_right_answer.csv',index=False)","d69c328b":"## 2. Submission File Aggregating Right Answer","ca18a273":"## 3. How do these perform?\nNo return customers? Scores **RMSE of 2.11** <br>\n![Predictably bad](https:\/\/imgur.com\/YSxDQbh.png)\nRight answer? Scores **RMSE of 0.00** <br>\n![So good](https:\/\/imgur.com\/roUWAdp.png)\n","cfcc1045":"# End Joke","c3c554b0":"## 1. Submission File Predicting No Return Customers","9ef848b7":"# Joke Submissions for the GA Customer Revenue Prediction Competition\nBecause life is too short, this workbook: <br>\n1. Generates a submission file that predicts **no return customers** (because the proportion of return to new customers in a given time period is **TINY**, and this will likely be a hard benchmark to beat come Feb!)\n2. Generates a submission file that calculates the **right answer** through aggregating the revenue per customer in the test file - in essence, calculating the \"hidden\" answer (because it feels great being at the top of a leaderboard, even when you know your method cannot generalize :p)"}}