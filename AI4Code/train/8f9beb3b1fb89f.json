{"cell_type":{"f54b747a":"code","e5b71269":"code","3900ae80":"code","ee27dbe4":"code","d9faada1":"code","1069b71b":"code","5c1a8147":"code","bcdad1bc":"code","d69f78de":"code","2f00e3ea":"code","981678f0":"code","a407e091":"code","b5b138ba":"code","6def4def":"code","ed590220":"code","5606dd9a":"code","9caa29af":"code","5322a07d":"code","3397cf89":"code","9bbd76fe":"code","c753b77f":"code","3b55bf6b":"code","9e9cbaea":"code","a52d6595":"code","bb06bb8a":"code","7b1f536d":"code","11cfe9ed":"code","ffa91315":"code","6328a7ef":"code","ed68d419":"code","54240301":"code","62d95e7f":"code","7f0b5cb3":"code","7bfdd340":"code","983eceed":"code","29727c71":"code","bc15164d":"code","7a46ebdd":"code","173e019f":"markdown","22c4d98b":"markdown","7d1ae351":"markdown","d07988cf":"markdown","22fe60bf":"markdown","ff332471":"markdown","1816b463":"markdown","8d026559":"markdown","ae536952":"markdown","0438bacf":"markdown","1ec5c9e6":"markdown","a6aa4dc3":"markdown","1af77a55":"markdown","5bfd4c0b":"markdown","634ebece":"markdown","51b1e903":"markdown","59208ccd":"markdown","ce080d00":"markdown","d6fa1205":"markdown","cf47b319":"markdown"},"source":{"f54b747a":"import numpy as np\nimport pandas as pd\nimport geopandas as gpd\n\nimport datetime as dt\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","e5b71269":"df_bicycle_thefts = gpd.read_file(\"\/kaggle\/input\/TPS_Toronto_Bicycle_Thefts.geojson\")","3900ae80":"df_bicycle_thefts.info()","ee27dbe4":"df_bicycle_thefts.sample(3)","d9faada1":"# Convert the cost of bicycles from string representation to a float for numerical analysis\n\ndef clean_cost(value):\n    if type(value) == str:\n        return float(value)\n    else:\n        return value\n\ndf_bicycle_thefts.Cost_of_Bike = df_bicycle_thefts.Cost_of_Bike.apply(clean_cost)","1069b71b":"\n\ndf_bicycle_thefts.Occurrence_Date = pd.to_datetime(df_bicycle_thefts.Occurrence_Date)\ndf_bicycle_thefts.Occurrence_Time = pd.to_datetime(df_bicycle_thefts.Occurrence_Time)\ndf_bicycle_thefts['Occurance_DateTime'] = dt.datetime.now()\n\nfor index, row in df_bicycle_thefts.iterrows():    \n    df_bicycle_thefts.at[index,'Occurance_DateTime'] = dt.datetime(\n        row['Occurrence_Date'].year,\n        row['Occurrence_Date'].month,\n        row['Occurrence_Date'].day,\n        row['Occurrence_Time'].hour,\n        row['Occurrence_Time'].minute,\n        row['Occurrence_Time'].second\n    )","5c1a8147":"df_bicycle_thefts = df_bicycle_thefts[[\n    'event_unique_id',\n    'Primary_Offence',       \n    'Division',\n    'City',\n    'Location_Type',\n    'Bike_Make',\n    'Bike_Model',\n    'Bike_Type',\n    'Bike_Speed',\n    'Bike_Colour',\n    'Cost_of_Bike',\n    'Status',\n    'Lat',\n    'Long',\n    'Occurance_DateTime',\n]]","bcdad1bc":"df_bicycle_thefts['Year'] = df_bicycle_thefts.Occurance_DateTime.apply(lambda x: x.year)\ndf_bicycle_thefts['Month'] = df_bicycle_thefts.Occurance_DateTime.apply(lambda x: x.month)\ndf_bicycle_thefts['Day'] = df_bicycle_thefts.Occurance_DateTime.apply(lambda x: x.day)\ndf_bicycle_thefts['Hour'] = df_bicycle_thefts.Occurance_DateTime.apply(lambda x: x.hour)\ndf_bicycle_thefts['Minute'] = df_bicycle_thefts.Occurance_DateTime.apply(lambda x: x.minute)\ndf_bicycle_thefts['Day_of_week'] = df_bicycle_thefts.Occurance_DateTime.apply(lambda x: x.isoweekday())\ndf_bicycle_thefts['Day_of_year'] = df_bicycle_thefts.Occurance_DateTime.apply(lambda x: x.toordinal() - dt.date(x.year, 1, 1).toordinal() + 1)\ndf_bicycle_thefts['Week_of_year'] = df_bicycle_thefts.Occurance_DateTime.apply(lambda x: x.isocalendar()[1])","d69f78de":"# The final format of our dataframe\n\ndf_bicycle_thefts.iloc[0]","2f00e3ea":"import plotly.express as px\nimport plotly.graph_objects as go","981678f0":"# making normalize to be True will show the percentage of the total for all traces instead of the tally the proportions\ndf_data = df_bicycle_thefts['Status'].value_counts(normalize = False)\n\nfig = px.bar(\n    data_frame = df_data,\n    x = df_data.index,\n    y = df_data\n)\nfig.update_layout(\n    xaxis_title = 'Status of Bicycle Theft',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Proportion of Bicycles Thefts by their Stolen Status'\n)\nfig.show()","a407e091":"fig = go.Figure()\n\nfor status in df_bicycle_thefts.Status.value_counts().sort_index().index:\n    df_data = df_bicycle_thefts[df_bicycle_thefts.Status == status].Year.value_counts().sort_index()\n    fig.add_trace(\n        go.Scatter(\n            x = df_data.index,\n            y = df_data,\n            mode = 'lines+markers',\n            name = status\n        )\n    )\n    \nfig.update_layout(\n    xaxis_title = 'Year',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Proportion of Bicycles Thefts in Toronto by Stolen Status and Year',\n    yaxis_type = 'log'\n)\nfig.show()","b5b138ba":"df_data = df_bicycle_thefts['Division'].value_counts(normalize = False)\n\nfig = px.bar(\n    data_frame = df_data,\n    x = df_data.index,\n    y = df_data,    \n)\nfig.update_layout(\n    xaxis_title = 'Division',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Proportion of Bicycles Thefts by the Division in Toronto they were Stolen in',\n    xaxis_type = 'category'\n)\nfig.show()","6def4def":"df_data = df_bicycle_thefts['Location_Type'].value_counts(normalize = False).head(12)\n\nfig = px.bar(\n    data_frame = df_data,\n    x = df_data.index,\n    y = df_data,    \n)\nfig.update_layout(\n    xaxis_title = 'Location Type',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Top 12 Types of Locations for Bicycle Thefts in Toronto',\n    xaxis_type = 'category'\n)\nfig.show()","ed590220":"df_data = df_bicycle_thefts['Primary_Offence'].value_counts(normalize = False).head(12)\n\nfig = px.bar(\n    data_frame = df_data,\n    x = df_data.index,\n    y = df_data,    \n)\nfig.update_layout(\n    xaxis_title = 'Offense Type',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Top 12 Types of Offences that involve Bicycle Thefts in Toronto',\n    xaxis_type = 'category'\n)\nfig.show()","5606dd9a":"df_data = df_bicycle_thefts['Bike_Colour'].value_counts(normalize = False).head(12)\n\nfig = px.bar(\n    data_frame = df_data,\n    x = df_data.index,\n    y = df_data,    \n)\nfig.update_layout(\n    xaxis_title = 'Bicycle Colour',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Top 12 types of Bicycles Colours of Stolen Bicycles',\n    xaxis_type = 'category'\n)\nfig.show()","9caa29af":"df_data = df_bicycle_thefts['Year'].value_counts(normalize = False)\n\nfig = px.bar(\n    data_frame = df_data,\n    x = df_data.index,\n    y = df_data,    \n)\nfig.update_layout(\n    xaxis_title = 'Year',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Proportion of Bicycles Thefts in Toronto by Year',\n)\nfig.show()","5322a07d":"months = ['January', 'February', 'March', 'April', \n          'May', 'June', 'July', 'August',\n          'September', 'October', 'November', 'December']","3397cf89":"df_data = df_bicycle_thefts['Month'].value_counts(normalize = False)\n\nfig = px.bar(\n    data_frame = df_data,\n    x = df_data.index,\n    y = df_data,\n)\nfig.update_layout(\n    xaxis_title = 'Month',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Proportion of Bicycles Thefts in Toronto by Month of Year',\n)\nfig.update_xaxes(\n    tickvals = list(range(1,13)),\n    ticktext = months\n)\nfig.show()","9bbd76fe":"fig = go.Figure()\n\nfor year in df_bicycle_thefts.Year.value_counts().sort_index().index:\n    fig.add_trace(\n        go.Scatter(\n            x = df_bicycle_thefts[df_bicycle_thefts.Year == year].Month.value_counts().sort_index().index,\n            y = df_bicycle_thefts[df_bicycle_thefts.Year == year].Month.value_counts().sort_index(),\n            mode = 'lines+markers',\n            name = year\n        )\n    )\n    \nfig.update_layout(\n    xaxis_title = 'Month',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Proportion of Bicycles Thefts in Toronto by Month of all Years',\n)\nfig.update_xaxes(\n    tickvals = list(range(1,len(months) + 1)),\n    ticktext = months\n)\nfig.show()","c753b77f":"df_data = df_bicycle_thefts['Week_of_year'].value_counts(normalize = False)\n\nfig = px.bar(\n    data_frame = df_data,\n    x = df_data.index,\n    y = df_data,\n)\nfig.update_layout(\n    xaxis_title = 'Week of Year',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Proportion of Bicycles Thefts in Toronto by Week of Year',\n)\nfig.show()","3b55bf6b":"fig = go.Figure()\n\nfor year in df_bicycle_thefts.Year.value_counts().sort_index().index:\n    fig.add_trace(\n        go.Scatter(\n            x = df_bicycle_thefts[df_bicycle_thefts.Year == year].Week_of_year.value_counts().sort_index().index,\n            y = df_bicycle_thefts[df_bicycle_thefts.Year == year].Week_of_year.value_counts().sort_index(),\n            mode = 'lines+markers',\n            name = year\n        )\n    )\n    \nfig.update_layout(\n    xaxis_title = 'Week of Year',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Proportion of Bicycles Thefts in Toronto by Week of Year',\n)\nfig.show()","9e9cbaea":"days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']","a52d6595":"df_data = df_bicycle_thefts['Day_of_week'].value_counts(normalize = False)\n\nfig = px.bar(\n    data_frame = df_data,\n    x = df_data.index,\n    y = df_data,\n)\nfig.update_layout(\n    xaxis_title = 'Day of Week',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Proportion of Bicycles Thefts in Toronto by Day of Week',\n)\nfig.update_xaxes(\n    tickvals = list(range(1,len(days) + 1)),\n    ticktext = days\n)\nfig.show()","bb06bb8a":"fig = go.Figure()\n\nfor year in df_bicycle_thefts.Year.value_counts().sort_index().index:\n    fig.add_trace(\n        go.Scatter(\n            x = df_bicycle_thefts[df_bicycle_thefts.Year == year].Day_of_week.value_counts().sort_index().index,\n            y = df_bicycle_thefts[df_bicycle_thefts.Year == year].Day_of_week.value_counts().sort_index(),\n            mode = 'lines+markers',\n            name = year\n        )\n    )\n    \nfig.update_layout(\n    xaxis_title = 'Day of Week',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Proportion of Bicycles Thefts in Toronto by Day of Week',\n)\nfig.update_xaxes(\n    tickvals = list(range(1,len(days) + 1)),\n    ticktext = days\n)\nfig.show()","7b1f536d":"df_data = df_bicycle_thefts['Hour'].value_counts(normalize = False)\n\nfig = px.bar(\n    data_frame = df_data,\n    x = df_data.index,\n    y = df_data,\n)\nfig.update_layout(\n    xaxis_title = 'Hour (24 hours)',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Proportion of Bicycles Thefts in Toronto by Hour of Day',\n)\nfig.show()","11cfe9ed":"fig = go.Figure()\n\nfor year in df_bicycle_thefts.Year.value_counts().sort_index().index:\n    fig.add_trace(\n        go.Scatter(\n            x = df_bicycle_thefts[df_bicycle_thefts.Year == year].Hour.value_counts().sort_index().index,\n            y = df_bicycle_thefts[df_bicycle_thefts.Year == year].Hour.value_counts().sort_index(),\n            mode = 'lines+markers',\n            name = year\n        )\n    )\n    \nfig.update_layout(\n    xaxis_title = 'Hour (24 hours)',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Proportion of Bicycles Thefts in Toronto by Hour of Day',\n)\nfig.show()","ffa91315":"fig = go.Figure(\n    data = go.Scatterpolar(\n        r = df_bicycle_thefts.Hour.value_counts().sort_index(),\n        theta = df_bicycle_thefts.Hour.apply(lambda x: str(x).zfill(2) + ' Hr').value_counts().sort_index().index,\n        fill = 'toself',\n    )\n)\n\nfig.update_layout(\n    title = 'Proportion of Bicycles Thefts in Toronto by Hour of Day',\n    showlegend = False,\n    polar = dict(\n        radialaxis = dict(\n            visible = True,\n            angle = 90,\n        ),\n        angularaxis = dict(\n            rotation = -90,\n            direction = 'clockwise'\n        )\n    )    \n)\n\nfig.show()","6328a7ef":"df_data = pd.pivot_table(\n    df_bicycle_thefts,\n    values = 'Day',\n    index = 'Year',\n    columns = 'Month',\n    aggfunc = len\n)\n\n#fig = px.imshow(df_data)\nfig = go.Figure(\n    data = go.Heatmap(\n        z = df_data,\n        x = df_data.columns.map(lambda x: months[x-1]),\n        y = df_data.index,\n    )\n)\nfig.update_layout(\n    xaxis_title = 'Months',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Heatmap of Bicycles Thefts in Toronto by Month and Year',\n)\nfig.show()","ed68d419":"df_data = pd.pivot_table(\n    df_bicycle_thefts,\n    values = 'Day',\n    index = 'Year',\n    columns = 'Day_of_week',\n    aggfunc = len\n)\n\n#fig = px.imshow(df_data)\nfig = go.Figure(\n    data = go.Heatmap(\n        z = df_data,\n        x = df_data.columns.map(lambda x: days[x-1]),\n        y = df_data.index,\n    )\n)\nfig.update_layout(\n    xaxis_title = 'Weekday',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Heatmap of Bicycles Thefts in Toronto by Weekday and Year',\n)\nfig.show()","54240301":"df_data = pd.pivot_table(\n    df_bicycle_thefts,\n    values = 'Day',\n    index = 'Month',\n    columns = 'Day_of_week',\n    aggfunc = len\n)\n\n#fig = px.imshow(df_data)\nfig = go.Figure(\n    data = go.Heatmap(\n        z = df_data,\n        x = df_data.columns.map(lambda x: days[x-1]),\n        y = df_data.index.map(lambda x: months[x-1]),\n    )\n)\nfig.update_layout(\n    xaxis_title = 'Weekday',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Heatmap of Bicycles Thefts in Toronto by Weekday and Month',\n)\nfig.show()","62d95e7f":"df_data = pd.pivot_table(\n    df_bicycle_thefts,\n    values = 'Day',\n    index = 'Year',\n    columns = 'Hour',\n    aggfunc = len\n)\n\n#fig = px.imshow(df_data)\nfig = go.Figure(\n    data = go.Heatmap(\n        z = df_data,\n        x = df_data.columns,\n        y = df_data.index,\n    )\n)\nfig.update_layout(\n    xaxis_title = 'Hour (24 hours)',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Heatmap of Bicycles Thefts in Toronto by Hour of day and Year',\n)\nfig.show()","7f0b5cb3":"df_data = pd.pivot_table(\n    df_bicycle_thefts,\n    values = 'Day',\n    index = 'Month',\n    columns = 'Hour',\n    aggfunc = len\n)\n\n#fig = px.imshow(df_data)\nfig = go.Figure(\n    data = go.Heatmap(\n        z = df_data,\n        x = df_data.columns,\n        y = df_data.index.map(lambda x: months[x-1]),\n    )\n)\nfig.update_layout(\n    xaxis_title = 'Hour (24 hours)',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Heatmap of Bicycles Thefts in Toronto by Hour of Day and Month',\n)\nfig.show()","7bfdd340":"df_data = pd.pivot_table(\n    df_bicycle_thefts,\n    values = 'Day',\n    index = 'Day_of_week',\n    columns = 'Hour',\n    aggfunc = len\n)\n\n#fig = px.imshow(df_data)\nfig = go.Figure(\n    data = go.Heatmap(\n        z = df_data,\n        x = df_data.columns,\n        y = df_data.index.map(lambda x: days[x-1]),\n    )\n)\nfig.update_layout(\n    xaxis_title = 'Hour (24 hours)',\n    yaxis_title = 'Proportion of Incidents',\n    title = 'Heatmap of Bicycles Thefts in Toronto by Hour of Day and Weekday',\n)\nfig.show()","983eceed":"df_bicycle_thefts.iloc[0]","29727c71":"fig = px.scatter_mapbox(\n    data_frame = df_bicycle_thefts[df_bicycle_thefts.Cost_of_Bike.notnull()],\n    lat = 'Lat',\n    lon = 'Long',\n    color = 'Status',\n    size = 'Cost_of_Bike',\n)\nfig.update_layout(\n    title = \"Map of Bicycle Theft incidents by Stolen Status\",\n    mapbox_style = \"carto-darkmatter\"\n)\nfig.show()","bc15164d":"fig = px.scatter_mapbox(\n    data_frame = df_bicycle_thefts[df_bicycle_thefts.Cost_of_Bike.notnull()],\n    lat = 'Lat',\n    lon = 'Long',\n    color = 'Primary_Offence',\n    size = 'Cost_of_Bike',\n)\nfig.update_layout(\n    title = \"Map of Bicycle Theft incidents by their Primary Offence\",\n    mapbox_style=\"carto-darkmatter\"\n)\nfig.show()","7a46ebdd":"fig = px.scatter_mapbox(\n    data_frame = df_bicycle_thefts[df_bicycle_thefts.Cost_of_Bike.notnull()],\n    lat = 'Lat',\n    lon = 'Long',\n    color = 'Location_Type',\n    size = 'Cost_of_Bike',\n)\nfig.update_layout(\n    title = \"Map of Bicycle Theft incidents by their Type of Location\",\n    mapbox_style = \"carto-darkmatter\"\n)\nfig.show()","173e019f":"If you enjoyed my content, please rememer to upvote the notebook. If you have any questions, feel free to comment below or message me on [LinkedIn](https:\/\/www.linkedin.com\/in\/jaydeep-mistry\/)","22c4d98b":"I prefer to add columns that store the computed values for the dates and time of all rows. This helps keep the code a bit cleaner instead of computing these values for every graph, and reduces the computation required","7d1ae351":"# Data Cleaning","d07988cf":"## free map styles:\n* white-bg\n* open-street-map\n* carto-positron\n* carto-darkmatter\n* stamen-terrain\n* stamen-toner\n* stamen-watercolor","22fe60bf":"A major issue with this dataset is that the date and time are save as two separate variables. I personally prefer to combine them into one datetime object as shown below.","ff332471":"# Data Visualization & Analysis","1816b463":"Insight: Bicycle thefts seen to be increasing in the summer months more than the previous years","8d026559":"Insight: Number of bicycle thefts are increasing year over year","ae536952":"Insight: Roads sides, Appartments, and Homes are where bicycle thefts happen the most","0438bacf":"Insight: Bicycle thefts seem to be happen most during 9am, 12noon, and 4pm rush hours. This may be a reflection of when the bicycle thefts are reported, and not necessarily when the incidents happen. People who have their bicycle's stolen may be going to or leaving work, and that is when they discover their bicycle is stolen and report the crime, however the crime itself may be happening just before those peak hours.","1ec5c9e6":"Insight: Bicycle thefts seem to follow a cyclical pattern where the insidents proportions keep increasing and decreasing periodically over 4 weeks peaks\/troughs","a6aa4dc3":"# TPS | Data Analyst Job Interview Notes\n\nHello! Last year I had gone to a job interview for a Data Analyst for the [Toronto Police Services Data Analytics Division](http:\/\/data.torontopolice.on.ca\/pages\/data-analytics). One of the rounds of the interview required me to find insights from their Bicycle Thefts dataset. This notebook represents notes that I had made for that interview. This notebook contains a lot of code I wrote for data querying, visualization, and analysis that I found very useful, and I hope you can find it useful as well.\n\n\nIf you enjoyed my content, please rememer to upvote the notebook. If you have any questions, feel free to comment below or message me on [LinkedIn](https:\/\/www.linkedin.com\/in\/jaydeep-mistry\/)","1af77a55":"Insight: Most stolen bicycles have not been recovered","5bfd4c0b":"Insight: Over the years the number of bicycle thefts have shifted from being stolen on Fridays, to now the middle of the week Wednedays\/Thursdays","634ebece":"Insight: Black is the most common colour of bicycles to be stolen. However, this may just be a reflection of the bicycle industry as a whole as most bicycles made may have a black colour, and not that black bicycles are more likely to be stolen.","51b1e903":"Insight: Certain Divisions report significantly more bicycle thefts than others, with a long tail distribution","59208ccd":"Insight: The number of Bicycle thefts have increased year over year, whereas the number of recovered bicycles has practically remained the same","ce080d00":"Insight: Most bicycles stolen are under $ 5,000 price range, and just a bicycle theft, and not a combinaton of other types of offences","d6fa1205":"This section contains graphs followed by insights that I noted for each graph","cf47b319":"Insight: Bicycle thefts have shifted to happen moreso over weekdays during working hours of 9am to 4pm"}}