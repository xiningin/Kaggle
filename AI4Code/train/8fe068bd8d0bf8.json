{"cell_type":{"d22f1b83":"code","2a97b433":"code","b75d0501":"code","69871d6f":"code","e8c28716":"code","35ec0fdc":"code","6f013039":"code","84a7a96b":"code","f9a175b1":"code","43b1b713":"code","10a65fe6":"code","50f2d806":"code","a9df44f0":"code","981cf126":"code","3f1299af":"code","ea826b83":"code","e6e1e1af":"markdown","915e2095":"markdown","218f0c98":"markdown","2008d221":"markdown","78b90a1a":"markdown"},"source":{"d22f1b83":"!pip install darts","2a97b433":"from darts.dataprocessing.transformers import Scaler\nfrom darts import TimeSeries\nfrom darts.utils.timeseries_generation import gaussian_timeseries, linear_timeseries, sine_timeseries\nfrom darts.models import RNNModel, TCNModel, TransformerModel, NBEATSModel, BlockRNNModel\nfrom darts.metrics import mape, smape\nimport matplotlib.pyplot as plt\nplt.style.use('seaborn')\nplt.rcParams[\"figure.figsize\"] = (20,15)\nimport pandas as pd","b75d0501":"data0 = pd.read_csv(\"..\/input\/google-stock-data\/GOOG.csv\")\ndata0[-1:]","69871d6f":"data1=data0[['Date','Close']]","e8c28716":"data2=data1[-501:].reset_index(drop=True)\ndata2['Date']=pd.to_datetime(data2['Date'])\nprint(len(data2))\ndata2","35ec0fdc":"data2.info()","6f013039":"data2p=data2.copy()\ndata2p.index=data2p['Date']\ndata2p=data2p.drop('Date',axis=1)\ndata2p","84a7a96b":"#index=date(datetime64[ns])\n#Missing dates are acceptable\ndata2p.plot(label='Google Stock')\nplt.legend()","f9a175b1":"# define prediction period\nfrom datetime import datetime\nfrom datetime import date\nfrom datetime import timedelta\n# latest date in data4\nstart0 = datetime.strptime('2020-06-30','%Y-%m-%d').date()\nend0   = datetime.strptime('2022-01-01','%Y-%m-%d').date()\ndates0=[]\nfor i in range(1,(end0-start0).days):\n    dates0+=[(start0+timedelta(i)).strftime('%Y-%m-%d') ]\nprint(dates0[0:5])\nprint(dates0[-5:])","43b1b713":"data3=pd.DataFrame(columns=['Date'],data = dates0)\ndata3['Date']=pd.to_datetime(data3['Date'])\ndata3","10a65fe6":"data3=data3.merge(data2,how='left',on='Date')\ndata3=data3.fillna(method='ffill')\ndata3","50f2d806":"data3.info()","a9df44f0":"#Missing dates are not acceptable\nseries_stock=TimeSeries.from_dataframe(data3, time_col='Date', value_cols='Close')\nprint(type(series_stock))","981cf126":"scaler_stock = Scaler()\nstock_scaled = scaler_stock.fit_transform(series_stock)\nstock_scaled.plot(label='Close')\nplt.legend(loc='best');","3f1299af":"train_stock, val_stock = stock_scaled[:400], stock_scaled[400:]\nmodel = NBEATSModel(input_chunk_length=24, output_chunk_length=12, n_epochs=100, random_state=0)\nmodel.fit(train_stock, verbose=True)","ea826b83":"pred = model.predict(n=100, series=train_stock)\nstock_scaled.plot(label='actual')\npred.plot(label='forecast')\nplt.legend()\nprint(f'MAPE :{mape(pred,val_stock)}')","e6e1e1af":"# Prepare library","915e2095":"# Google Stock Prediction Darts\nhttps:\/\/github.com\/unit8co\/darts","218f0c98":"# Model Fit & Predict","2008d221":"# Prepare dataset","78b90a1a":"# Create Darts.TimeSeries"}}