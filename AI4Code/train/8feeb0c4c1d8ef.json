{"cell_type":{"6b6de425":"code","1df9d332":"code","f09abe16":"code","23430e0f":"code","4718bedb":"code","342bfbb5":"code","1ad0c063":"code","9d775a67":"code","4ee85164":"code","fbb004d3":"code","748d5e93":"code","af3c3864":"code","161e929a":"code","f52aed65":"code","e1d9f6a4":"code","8b127516":"code","2cdb71c7":"code","dd4feb3b":"code","741b6480":"code","3c817393":"markdown"},"source":{"6b6de425":"!wget https:\/\/datahack-prod.s3.amazonaws.com\/test_file\/test_pFkWwen.csv\n!wget https:\/\/datahack-prod.s3.amazonaws.com\/train_file\/train_yaOffsB.csv","1df9d332":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nfrom sklearn.model_selection import cross_val_score\n\nfrom catboost import CatBoostClassifier\nfrom xgboost import XGBClassifier\n","f09abe16":"train_df = pd.read_csv('train_yaOffsB.csv')\ntest_df = pd.read_csv('test_pFkWwen.csv')\n\ntrain_df.drop('ID', inplace=True, axis=1)","23430e0f":"train_df.dtypes","4718bedb":"train_df.isna().sum()","342bfbb5":"sns.countplot(x='Crop_Damage', data=train_df)","1ad0c063":"train_df.boxplot(column=['Estimated_Insects_Count'], by='Crop_Damage', grid=False)","9d775a67":"cols = ['Crop_Type','Soil_Type','Pesticide_Use_Category','Season']\nfig, ax = plt.subplots(nrows=2, ncols=2, figsize=(8,8))\nfor idx, col_name in enumerate(cols):\n    row = int(idx\/2)\n    col = int(idx%2)\n    sns.countplot(x=col_name, hue='Crop_Damage', ax=ax[row, col], data=train_df)","4ee85164":"pd.crosstab([train_df.Pesticide_Use_Category, train_df.Soil_Type], train_df.Crop_Type)","fbb004d3":"sns.scatterplot(train_df['Number_Weeks_Used'], train_df['Estimated_Insects_Count'])","748d5e93":"train_df.corr()","af3c3864":"train_df['Daily_avg'] = round(train_df['Number_Weeks_Used']\/train_df['Number_Doses_Week'], 2)\ntrain_df['Daily_avg'].fillna(value=0, inplace=True)\n\ntest_df['Daily_avg'] = round(test_df['Number_Weeks_Used']\/test_df['Number_Doses_Week'], 2)\ntest_df['Daily_avg'].fillna(value=0, inplace=True)","161e929a":"y = train_df.pop('Crop_Damage')\nX = train_df\n\ntest_ids = test_df.pop('ID')","f52aed65":"X.fillna(value=-999, inplace=True)\ntest_df.fillna(value=-999, inplace=True)","e1d9f6a4":"catboost = CatBoostClassifier(iterations=2000, learning_rate=0.03, verbose=500)\ncatboost.fit(X, y)","8b127516":"sum(cross_val_score(catboost, X, y, cv=5))\/5","2cdb71c7":"xgboost = XGBClassifier()\nxgboost.fit(X, y)\nsum(cross_val_score(xgboost, X, y, cv=5))\/5","dd4feb3b":"catboost_preds = catboost.predict_proba(test_df)\nxgboost_preds = xgboost.predict_proba(test_df)","741b6480":"final_res = []\nfor idx in range(len(xgboost_preds)):\n    final_res.append(np.argmax((xgboost_preds[idx]*.4 + catboost_preds[idx]*.6)\/2))\n\npd.DataFrame({'ID': test_ids, 'Crop_Damage':final_res}).to_csv('submission.csv', index=False)","3c817393":"# Prediction"}}