{"cell_type":{"91e93f83":"code","89be8544":"code","12af8151":"code","d74a7365":"code","63bd7f37":"code","33cc5f07":"code","a580394a":"code","c819d28e":"code","5045e3dc":"code","5818f5e8":"code","d8188f7f":"code","ee095c6e":"code","0fe92679":"code","56d7a2c0":"code","413bacac":"code","d2deeb9c":"code","041a2fb6":"code","ac89589b":"code","602ba1f1":"code","eada3198":"code","587dfb10":"code","bd20ed2c":"code","adb6c764":"code","6ea37bfc":"code","ea4896c8":"code","c16796b9":"code","c8d7787f":"code","426f7a05":"code","539794d6":"code","7d00c69e":"markdown","3880c592":"markdown","c2ae40c9":"markdown","a20a3cc4":"markdown","9953d8e3":"markdown","2f81a864":"markdown","30df5780":"markdown","1ae72e41":"markdown","e68ee6ab":"markdown","ab3a113c":"markdown","b3f6d465":"markdown","6507dc0a":"markdown","ffa3740e":"markdown","50c76d6d":"markdown","01db76a0":"markdown","f509480b":"markdown","108899e2":"markdown","e4a51fd6":"markdown","c3c7c6c9":"markdown","52ec2178":"markdown","181dd1e9":"markdown","33e99be9":"markdown","8284cc13":"markdown","daebec1e":"markdown","838dfcfa":"markdown","65d693ae":"markdown","7a71123b":"markdown","0267200e":"markdown","58b8850f":"markdown","ce0a263b":"markdown","78274adb":"markdown","b40a93ff":"markdown","3797af4c":"markdown","d2210d8a":"markdown","2e6ed6d8":"markdown","d386450c":"markdown","6a90d1b0":"markdown","115e48cf":"markdown","926846d2":"markdown","cb9cc70c":"markdown"},"source":{"91e93f83":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore')\n\n#Source of data: KCDC (Korea Centers for Disease Control & Prevention)\n#https:\/\/www.kaggle.com\/kimjihoo\/coronavirusdataset\npatient = pd.read_csv('\/kaggle\/input\/coronavirusdataset\/patient.csv')\npatient.head(5)","89be8544":"patient.info()","12af8151":"patient['state'].value_counts()","d74a7365":"patient['age'] = 2020 - patient['birth_year']","63bd7f37":"deceased = patient.loc[patient['state'] == 'deceased']\nreleased = patient.loc[patient['state'] == 'released']\nisolated = patient.loc[patient['state'] == 'isolated']","33cc5f07":"#Adding one more feature to deceased dataset which will contain the number of days patient survived.\ndate_column = [\"confirmed_date\",\"deceased_date\"]\nfor i in date_column:\n    deceased[i] = pd.to_datetime(deceased[i])\ndeceased[\"no_of_days_survived\"] = deceased[\"deceased_date\"] - deceased[\"confirmed_date\"]\ndeceased.head(5)","a580394a":"#Adding one more feature to deceased dataset which will contain the number of days patient was admitted before discharged.\ndate_column = [\"confirmed_date\",\"released_date\"]\nfor i in date_column:\n    released[i] = pd.to_datetime(released[i])\nreleased[\"no_of_days_treated\"] = released[\"released_date\"] - released[\"confirmed_date\"]\nreleased.head(5)","c819d28e":"print('The percentage of released patient is: ',(len(released) * 100) \/ len(patient))\nprint('The percentage of deceased patient is: ',(len(deceased) * 100) \/ len(patient))\nprint('The percentage of isolated patient is: ',(len(isolated) * 100) \/ len(patient))","5045e3dc":"state = 'Isolated', 'Released', 'Deceased'\nsizes = [(len(isolated) * 100) \/ len(patient),(len(released) * 100) \/ len(patient),(len(deceased) * 100) \/ len(patient)]\nexplode = (0,1,2)\nfig, ax = plt.subplots()\nax.pie(sizes, explode=explode, labels=state, autopct='%.1f%%',\n        shadow=False, startangle=30)\nax.axis('equal')\nplt.legend()\nplt.title('Pie Chart')\nplt.show()","5818f5e8":"sns.FacetGrid(patient, hue=\"state\", size=5) \\\n .map(sns.distplot, \"age\") \\\n .add_legend()\nplt.title('PDF with age')\nplt.grid()\nplt.show()","d8188f7f":"counts, bin_edges = np.histogram(deceased['age'], bins=10, density = True)\npdf = counts\/(sum(counts))\ncdf = np.cumsum(pdf)\nplt.plot(bin_edges[1:], pdf)\nplt.plot(bin_edges[1:], cdf, label = 'Death')\n\ncounts, bin_edges = np.histogram(released['age'], bins=10, density = True)\npdf = counts\/(sum(counts))\ncdf = np.cumsum(pdf)\nplt.plot(bin_edges[1:], pdf)\nplt.plot(bin_edges[1:], cdf, label = 'Recovered')\n\nplt.xlabel('Age of patient')\nplt.ylabel('Percentage')\nplt.legend()\nplt.grid()\nplt.show()","ee095c6e":"#Countplot the ith state feature.\npatient.state.value_counts().plot.bar().grid()","0fe92679":"sns.countplot(x=\"sex\", hue=\"state\", data=patient).grid()","56d7a2c0":"sns.boxplot(x = 'state',y = 'age', data = patient)\nplt.title('Box plot of age')\nplt.grid()\nplt.show()","413bacac":"sns.violinplot(x = 'state', y= 'age', data = patient, size = 4)\nplt.title('Violin plot of age')\nplt.grid()\nplt.show()","d2deeb9c":"patient.region.value_counts().plot.bar().grid()","041a2fb6":"plt.figure(figsize=(15,5))\npatient.infected_by.value_counts().plot.bar().grid()","ac89589b":"plt.figure(figsize=(15,5))\npatient.confirmed_date.value_counts().plot.bar().grid()","602ba1f1":"plt.figure(figsize=(10,5))\npatient.released_date.value_counts().plot.bar().grid()","eada3198":"plt.figure(figsize=(10,5))\npatient.deceased_date.value_counts().plot.bar().grid()","587dfb10":"sns.set_style(\"whitegrid\")\nsns.FacetGrid(patient, hue = 'state', size = 7)\\\n.map(plt.scatter, 'age', 'region')\\\n.add_legend()\nplt.title('Scatter plot : region vs age')\nplt.show()","bd20ed2c":"import plotly\nimport plotly.graph_objs as go\nplotly.offline.init_notebook_mode()\ntrace = go.Scatter3d(\n    x= patient['age'],\n    y=patient['country'],\n    z=patient['infection_reason'],\n    mode='markers',\n    marker={\n        'size': 10,\n        'opacity': 0.8,\n    }\n)\nlayout = go.Layout(\n    margin={'l': 0, 'r': 0, 'b': 0, 't': 8}\n)\ndata = [trace]\nplot_figure = go.Figure(data=data, layout=layout)\nplotly.offline.iplot(plot_figure)","adb6c764":"#Calculating total number of confirmed cases for each day\ncase_count_per_day = patient.groupby('confirmed_date').patient_id.count()\ncase_count_per_day = pd.DataFrame(case_count_per_day)","6ea37bfc":"#Calculating cumulative sum of confirmed cases as date increased(total number of cases increases as date changes)\ndata = case_count_per_day.cumsum()\n#Picking up the continuous data w.r.t. dates\ndataset = data.iloc[16:]","ea4896c8":"# This var will be used to predict the cases till next 7 days\ndays_in_future = 7\ndates = pd.date_range('2020-2-20','2020-3-11')\n\n#This is to predict the cases for future dates\nfuture_y_pred = np.array([i for i in range(len(dates)+days_in_future)]).reshape(-1, 1)\n\n#This var will be used to compute the R^2\ny_pred = np.array([i for i in range(len(dates))]).reshape(-1, 1)","c16796b9":"#Re-shaping the data\nx = np.array([i for i in range(len(dates))]).reshape(-1, 1) # index -> ndarray\ny = np.array(dataset).reshape(-1, 1) # count->ndarray","c8d7787f":"from sklearn.linear_model import LinearRegression\n\nlinear_model = LinearRegression()\nlinear_model.fit(x, y)\nlinear_pred = linear_model.predict(future_y_pred)","426f7a05":"y_pred = linear_model.predict(y_pred)\nr_sq = linear_model.score(x,y)\nprint(\"The coefficient of determination(R^2) for this model is: \"+\"{:.2f}\".format(r_sq*100),'%\\n')","539794d6":"#Size of graph\nplt.figure(figsize=(15,6))\n\n#Plotting linear model predicted number case for each date(curent + future dates)\nplt.plot(linear_pred, color='red', label='Predicted count')\n\n#Plotting actual number of cases for each date\nplt.plot(dataset, label='Actual count')\n\n#Labeling X and Y axes.\nplt.xlabel('Dates')\nplt.ylabel('Total number of cases')\n\n#Drawing a vertical line which touches linear model predicted last value\nplt.vlines(x=len(linear_pred)-1, ymin=0, ymax=12000, linestyles='dotted')\nplt.text(x=len(linear_pred)+2, y=5000, s='predicted no. of\\ncases by next week',color='black',\\\n         fontsize =15,horizontalalignment='center') \nplt.xticks(rotation=90)\n\nplt.legend()\nplt.show()","7d00c69e":"<h3>9] Bar Plot:-<\/h3>","3880c592":"<h4>Step 5:<\/h4>\nFitting the model and predicting the output.","c2ae40c9":"<h4>Observation:-<\/h4>\n* Most of the patient got infected by the patient with ID 31.","a20a3cc4":"<h4>Observation:-<\/h4>\n* On 5th March, unfortunately most of the patient died.","9953d8e3":"<h4>Observation:-<\/h4>\n* On 4th March, most of the patient has been discharged.","2f81a864":"<h3>8] Violin Plot:-<\/h3>","30df5780":"<h4>Observation:-<\/h4>\n* On 1st March, most of the patient got confirmation that they are corona +ve.","1ae72e41":"Importing the required packages and csv file:","e68ee6ab":"<ul>\n    <li>The given dataset is collected by KCDC for Korea, China and Mongolia country.<\/li>\n \u00a0 \u00a0<li>Only 0.4% of patient died but also only 0.7% of patient recovered and still around 98.9% of patient are under isolation.<\/li>\n    <li>So, the death probability is low but also recovering from this virus is difficult.<\/li>\n    <li>The most of the patient died within a 5 days after confirmation. So, the treatment of corona virus has to be started immediately after confirmation as it's impact is really hazardous.<\/li>\n    <li>The patient with age between 35 and 45 years is more likely to get released but this is not true in all cases.<\/li>\n    <li>Most of the patient with age greater than 55 couldn't survived from this virus.<\/li>\n    <li>In Daegu and Gyeongsangbuk-do region, most of the patient died.<\/li>\n    <li>The one of the main reason for corona virus spread is due to contact with infected patient.<\/li>\n    <li>As this dataset is imbalanced, so predicting the survival chances is difficult. But we can observer the most likey reason for virus spread, maximum number of infected patient in particular region.<\/li>\n    <li>So, even though death percentage is low but recovering from this virus is difficult.<\/li>\n<\/ul>","ab3a113c":"The above pie chart shows that around 98.9% of total patient is under isolation whereas around 0.7% patient got discharged and unfortunately 0.4% patient couldn't survived.\n\n<b>Note: <\/b> Observation percentage may vary from pie chart as dataset keeps on updating. ","b3f6d465":"<h4>Step 3:<\/h4>\nSelecting the range of dates and total number of future date that want to be predicted.","6507dc0a":"<h4>Step 2:<\/h4>\nComputing the cumulative sum of case for each date.","ffa3740e":"Now, lets create new dataframes for each state i.e. isolated,released and deceased.","50c76d6d":"<h3>12] Linear Regression:-<\/h3>","01db76a0":"Adding new feature age by subtracting current year with birth year feature.","f509480b":"<h3>4] Probability distribution function:-<\/h3>","108899e2":"<h3>13] Conclusion:-<\/h3>","e4a51fd6":"<h3>10] 2D-scatter Plot:-<\/h3>","c3c7c6c9":"The above countplot shows the state of the patient of male and female.<br><br>\n<h4>Observation:-<\/h4>\n* Most of the patient who didn't survive is male patient.","52ec2178":"<h4>Observation:-<\/h4>\n* Most of the patient belongs to capital area region.<br>\n* From Daegu and Gyeongsangbuk-do region most of the patient died.","181dd1e9":"<h4>Observation:-<\/h4>\n* By observing the rate of change of total number of cases as date changes, we've predicted the expected total number of cases for next week(i.e. 7th day).\n* The predicted total number of cases for next week(i.e. on 18th March) is approximately 11900.\n<br><br>\n<b>Note: <\/b>\nAs this dataset get keeps on updating, the static textual observation and graphical representation may vary. So the graphical representation will always show the updated dynamic result(i.e. predicted number of cases).","33e99be9":"<h4>Step 1:<\/h4>\nComputing total number of cases for each confirmed date.","8284cc13":"<h4>Step 4:<\/h4>\nRe-shaping the data to fit it in our model.","daebec1e":"<h3>5] Cumulative density function:-<\/h3>","838dfcfa":"<h4>Step 7:<\/h4>\n\nPlotting the graph with confirmed date in X-axes and linear model predicted and actual number of case in Y-axes.","65d693ae":"<h3>3] Data pre-processing:-<\/h3>","7a71123b":"<h4>Observation:-<\/h4>\n* Most of the patient who didn't survived has age between 60 and 80.<br>\n* Most of the patient who got discharged has age between 45 and 55.","0267200e":"Out of 7k+ patients, there are 50+ patients who got discharge and 30+ patients couldn't survive from this disease whereas remaining patients are still under isolation.","58b8850f":"<h4>Observation:-<\/h4>\n* Most of the people who was infected by corona virus belongs to capital area region.","ce0a263b":"<h4>Observation:-<\/h4>\n* Almost 50% of patient who got discharge has age less than 42.<br>\n* More than 75% of patient who didn't survived has age greater than 60.","78274adb":"<h3>7] Box Plot:-<\/h3>","b40a93ff":"* Coefficient of determination of 96.91% shows that more than 96% of the data fit our linear regression model.\n* Generally, a higher coefficient indicates a better fit for the model.","3797af4c":"The above graph shows the PDF and CDF for deceased and released patient with age in X-axis.<br><br>\n<h4>Observation:-<\/h4>\n* We can observer that almost 62% of the patient who recovered has age less than 50 years.\n<br>\n* All the patient who didn't survive has age greater than 40 and almost 80% of deceased patient has age greater than 55.","d2210d8a":"<h3>11] 3D-scatter Plot:-<\/h3>","2e6ed6d8":"<h4>Explanation & problem statement:<\/h4>\n* The number of cases from one day to next day are completely random as the number of cases increases day by day are independent of each other.\n* As of now let's assume number of new cases each day is proportional to the number of existing cases, it means each day it's get multiplied by a constant.\n* Intuitively it means as the date changes, the number of confirmed cases also increases as they both are directly proportional to each other.\n* So, if we compare total cases from one day to next day, then tracking the changes between number of cases is nothing but the growth factor.\n* Simply growth factor is the ratio between two successive changes and that resultant ratio is the constant that get multiplied each day.\n* So, with existing accumulated data(number of cases each day), we'll predict the expected number of cases for future dates by using Linear Regresion which is one of the simplest but powerful concept of machine learning.\n","d386450c":"<h3>6] Count Plot:-<\/h3>","6a90d1b0":"<h4>Step 6:<\/h4>\nCalculating coefficient of determination(R^2).","115e48cf":"<h4>Observation:-<\/h4>\n* In Korea country, most of the people got infected by corona virus due to two resons(i.e. contact with patient and visit to Daegu) irrespective of their ages.<br>\n* So we can conclude that contact with infected patient is the main reason for corona spread.","926846d2":"<h4>Input and Output:<\/h4>\n* In this model, we'll take all unique confirmed date and total number of cases for that date as an input.\n* So, I'll use only confirmed_date and patient_id feature in my linear regression model.\n* For all confirmed date, we'll compute total count of case for that date using patient_id feature as patient id is unique for every patient.\n* For every confirmed date, it's count value will be sum of total case for that day plus sum of total case for all preceding date(i.e. accumulated count).\n* And the output that we'll compute is the prediction of total number of case for future dates.","cb9cc70c":"<h4>Observation:-<\/h4>\n* Most of the patient who didn't survive has age of 60.<br>\n* Most of the patient who got discharge has age of 40."}}