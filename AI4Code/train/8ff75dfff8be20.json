{"cell_type":{"0568f21e":"code","65284a04":"code","5aa07d9d":"code","e0bbd0eb":"code","4ac2e04f":"code","8aaaaea1":"code","0af492c0":"code","4bd25fe7":"code","1b1a28ab":"code","3c3d5e22":"code","5f711673":"code","391b064c":"code","483ef3e0":"code","52a5ef57":"code","845686a9":"markdown","f31b6598":"markdown","5adc9498":"markdown"},"source":{"0568f21e":"import pandas as pd\n\nfull_url = '\/kaggle\/input\/quotes1\/quotes.csv'\n\nrating = pd.read_csv(full_url)","65284a04":"rating.head()","5aa07d9d":"print(\"Rating:\",rating.shape)","e0bbd0eb":"cleaned = rating.drop(columns=['author'])","4ac2e04f":"cleaned['overview'].head()","8aaaaea1":"from sklearn.feature_extraction.text import TfidfVectorizer\n\n\ntfidf = TfidfVectorizer(stop_words='english',ngram_range=(1,3),min_df=3,analyzer='word')\n\ncleaned['overview']=cleaned['overview'].fillna('')\n\ntfidf_matrix = tfidf.fit_transform(cleaned['overview'])\n\ntfidf_matrix.shape","0af492c0":"tfidf.get_feature_names()[:5]","4bd25fe7":"from sklearn.metrics.pairwise import linear_kernel\n\ncosine_sim = linear_kernel(tfidf_matrix, tfidf_matrix)","1b1a28ab":"print(cosine_sim.shape)\nprint(cosine_sim[2])","3c3d5e22":"indices = pd.Series(cleaned.index, index=cleaned['tags']).drop_duplicates()","5f711673":"indices[:10]","391b064c":"def get_recommendations(title,cosine_sim=cosine_sim):\n    \n    idx = indices[title]\n    \n    sim_scores = list(enumerate(cosine_sim[idx]))\n    \n    sim_scores = sorted(sim_scores, key = lambda x: x[1], reverse = True)\n    \n    sim_scores = sim_scores[1:10]\n    \n    quote_indices = [i[0] for i in sim_scores]\n    \n    return cleaned['tags'].iloc[quote_indices]","483ef3e0":"get_recommendations('essential, happiness, love')","52a5ef57":"get_recommendations('friendship, love, trust')","845686a9":"![cosine_similarity_formula.png](attachment:cb23ccc7-22ea-49c8-b33e-dafa21e82c2d.png)","f31b6598":"![kaggle_recommend_system3.jpg](attachment:4e8130ca-d41d-4363-b12e-2f7b66591bc8.jpg)","5adc9498":"**Cosine Similarity**\n\nCosine similarity measures the similarity between two vectors of an inner product space. It is measured by the cosine of the angle between two vectors and determines whether two vectors are pointing in roughly the same direction. It is often used to measure document similarity in text analysis.\n\nA document can be represented by thousands of attributes, each recording the frequency of a particular word (such as a keyword) or phrase in the document.\nhttps:\/\/www.sciencedirect.com\/topics\/computer-science\/cosine-similarity\n"}}