{"cell_type":{"46cf5c93":"code","b192a129":"markdown"},"source":{"46cf5c93":"import pandas as pd\nimport numpy as np\n\ndef concat_row(r):\n    if r['WTeamID'] < r['LTeamID']:\n        res = str(r['Season'])+\"_\"+str(r['WTeamID'])+\"_\"+str(r['LTeamID'])\n    else:\n        res = str(r['Season'])+\"_\"+str(r['LTeamID'])+\"_\"+str(r['WTeamID'])\n    return res\n\n# Delete leaked from train\ndef delete_leaked_from_df_train(df_train, df_test):\n    df_train['Concats'] = df_train.apply(concat_row, axis=1)\n    df_train_duplicates = df_train[df_train['Concats'].isin(df_test['ID'].unique())]\n    df_train_idx = df_train_duplicates.index.values\n    df_train = df_train.drop(df_train_idx)\n    df_train = df_train.drop('Concats', axis=1)\n    \n    return df_train \n\ndef read_data(inFile, sep=','):\n    df_op = pd.read_csv(filepath_or_buffer=inFile, low_memory=False, encoding='utf-8', sep=sep)\n    return df_op\n\nPATH = \"\/kaggle\/input\/ncaaw-march-mania-2021\/\"\ndf_test = read_data(PATH+\"WSampleSubmissionStage1.csv\")\ndf_train = read_data(PATH+\"WNCAATourneyCompactResults.csv\")\n\nprint(\"SIZE TRAIN BEFORE :\")\nprint(df_train.shape)\ndf_train = delete_leaked_from_df_train(df_train, df_test)\nprint()\nprint(\"SIZE TRAIN AFTER :\")\nprint(df_train.shape)","b192a129":"Here is a function I used to delete leaked data from the training dataset.\n\nConsidering the result I got, it seems we have leaked data.\n\nUPDATE:\n\nThe Kaggle Team said we do not need to delete the leaked data as two teams may play several games during the same season -- and have different results for each game. It is good to know, anyway.  "}}