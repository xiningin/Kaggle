{"cell_type":{"9b98295b":"code","d30d9034":"code","d65a9409":"code","74b2e975":"code","60eafd72":"code","aa306c51":"code","dad7fe23":"code","d9cc0371":"code","19af416e":"code","baed7e3e":"code","2b1d72b8":"code","cac4d905":"markdown","c70a9707":"markdown","fdbf3d84":"markdown","8e2f2fd3":"markdown","d2b7669d":"markdown","2992eada":"markdown","29723898":"markdown","7a072cca":"markdown","7683149c":"markdown"},"source":{"9b98295b":"import tensorflow as tf\nimport os\nimport math\nimport numpy as np\nimport cv2 as cv\nimport random as rd\nimport matplotlib.pyplot as plt\n\n\nrd.seed(1)","d30d9034":"paths = []\nfor dirname, _, filenames in os.walk('..\/input\/apparel-dataset'):\n    for filename in filenames:\n        paths.append(os.path.join(dirname, filename))\n        \npaths = sorted(paths)","d65a9409":"file = open('..\/input\/multilabel-classification\/model.json', 'r')\nloaded_model = tf.keras.models.model_from_json(file.read())","74b2e975":"loaded_model.load_weights('..\/input\/multilabel-classification\/best.h5')","60eafd72":"loaded_classes = open('..\/input\/multilabel-classification\/classes.txt', 'r')\nloaded_classes = loaded_classes.read().split('\\n')\nprint(loaded_classes)","aa306c51":"def open_image(path: str):\n    img = cv.imread(path)\n    img = cv.cvtColor(img, cv.COLOR_BGR2RGB)\n    img = cv.resize(img, (96, 96))\n    img = np.expand_dims(img \/ 255.0, axis=0)\n    return img","dad7fe23":"img = open_image(paths[10000])\nplt.imshow(img[0])\nplt.show()","d9cc0371":"def make_prediction(img):\n    pred = loaded_model.predict(img)\n    y1, y2 = np.argsort(pred[0])[-2:]\n    return loaded_classes[y1], loaded_classes[y2]","19af416e":"plt.imshow(img[0])\nplt.xlabel(' '.join(make_prediction(img)))\nplt.show()","baed7e3e":"!wget https:\/\/www.nativeshoes.com\/on\/demandware.static\/-\/Sites-nas-catalog-us\/default\/dw13de5269\/Nav_Mens_Shoes_Feature.jpg","2b1d72b8":"new_img = open_image('.\/Nav_Mens_Shoes_Feature.jpg')\nplt.imshow(new_img[0])\nplt.xlabel(' '.join(make_prediction(new_img)))\nplt.show()","cac4d905":"# Make model predicton and decode output","c70a9707":"# Open and preprocess image","fdbf3d84":"# Test model with new image","8e2f2fd3":"# Load model weights","d2b7669d":"# Show image with predicted label","2992eada":"# Load the model from JSON file","29723898":"# Load classes and show it","7a072cca":"# Load the Apparel Dataset","7683149c":"Code for training this model will be found here https:\/\/www.kaggle.com\/dkuznetsov\/multilabel-classification-training"}}