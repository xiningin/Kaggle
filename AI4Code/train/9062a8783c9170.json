{"cell_type":{"c548263a":"code","65c0425d":"code","e246b28e":"code","f7606a67":"code","1481226b":"code","843f39f3":"code","643c3bbf":"code","1665d582":"code","bd2571e6":"code","0614ccf2":"markdown","b03a88bc":"markdown","d923e45c":"markdown","59863709":"markdown","88055ba2":"markdown","b660eb7a":"markdown","489b0c23":"markdown","5fb1df22":"markdown","929ef51e":"markdown","838ab0d9":"markdown","85404659":"markdown"},"source":{"c548263a":"import pandas as pd\ndata=pd.read_csv('..\/input\/health-care-data-set-on-heart-attack-possibility\/heart.csv')\ndata.head()","65c0425d":"data.info()","e246b28e":"X=data[data.columns[data.columns!='target']]\nX.head()","f7606a67":"Y=data['target']\nY.head()","1481226b":"X.corrwith(Y)","843f39f3":"from sklearn.model_selection import train_test_split\ntrain_x, test_x, train_y,test_y=train_test_split(X,Y,random_state=0,test_size=0.2)\nprint(train_y.shape, test_y.shape)","643c3bbf":"from sklearn.ensemble import RandomForestClassifier\nbest_estimator=0\nbest_depth=0\nacc=0\nfor i in range(1,10):\n    for j in range(1,10):\n        classifier=RandomForestClassifier(n_estimators=i,max_depth=j,random_state=0,class_weight={0:sum(train_y==0),1:sum(train_y==1)})\n        classifier.fit(train_x,train_y)\n        if(classifier.score(test_x,test_y) > acc):\n            best_estimator=i\n            best_depth=j\n            acc=classifier.score(test_x,test_y)\nprint('Best Estimator: ',best_estimator,'\\nBest Estimator: ',best_depth,'\\nAccuracy: ',acc)\n","1665d582":"best_classifier=RandomForestClassifier(n_estimators=8,max_depth=5,random_state=0,class_weight={0:sum(train_y==0),1:sum(train_y==1)})\nbest_classifier.fit(train_x,train_y)\nprint('Train - Accuracy: ',round(best_classifier.score(train_x,train_y)*100,2),'%')\nprint('Test - Accuracy: ',round(best_classifier.score(test_x,test_y)*100,2),'%')","bd2571e6":"from sklearn.metrics import confusion_matrix\ncfmt=confusion_matrix(test_y,best_classifier.predict(test_x))\nprint(cfmt)","0614ccf2":"## **Seperating target column from data**","b03a88bc":"## **Using best parameters**","d923e45c":"# **Importing Data**","59863709":"### **Brief info about null and non-null for preprocessing**","88055ba2":"## **Splitting data into train and split (ratio: 80:20)**","b660eb7a":"#### **Give upvote if you like my work, Thank you**","489b0c23":"## **Confusion Matrix**","5fb1df22":"## **Correlation b\/w features and target**","929ef51e":"## **Seperating feature columns from data**","838ab0d9":"#### **Train and test acurracy are nearly same, so model is not overfitting or underfitting**","85404659":"## **Using Random Forest with parameter tuning **(n_estimators,max_depth)****"}}