{"cell_type":{"de225c38":"code","c524c437":"code","a80eacc6":"code","7bf0b3c9":"code","dc353eff":"code","3d27f782":"code","70c6d6d3":"code","9c5d7f52":"code","b113704c":"code","9f3fc13d":"code","4ec15513":"code","d601a7aa":"code","06d6fa94":"code","5d4d0030":"code","81a93573":"code","22bb912b":"code","a99baed7":"code","14f262d4":"code","f22c82ec":"code","1be931a3":"code","420278e1":"code","216c99b9":"code","e3580b3f":"code","b79506dd":"code","e45be816":"code","f5d169a3":"code","67b31baf":"code","f985bcf9":"code","d7ddc1fb":"code","d761bd14":"code","28683936":"code","58eb9344":"code","eea6d134":"code","84956395":"code","c9206cfa":"code","1d774e83":"code","fb49c1bb":"code","7f6cf8b7":"code","5ecddfda":"code","6da1c96f":"code","6bc910a9":"code","6135c21e":"code","f9a1d097":"code","4f19b827":"code","02f9827c":"code","e95e1769":"code","8d72e9f6":"code","fe64f45d":"code","5f5a6619":"code","0d52aa0d":"code","a149a780":"code","6dd1c682":"code","649fb020":"code","788259a0":"code","1edd1790":"code","61f9515d":"code","67b8e951":"markdown","d0eae6dc":"markdown","8bc2d600":"markdown","9d3f66ca":"markdown","2dd99971":"markdown","1700c5cc":"markdown","b269f0a8":"markdown","dcac821f":"markdown","c8b1e7ee":"markdown","22947911":"markdown","cb779a26":"markdown","af0da62b":"markdown","8f105072":"markdown","6cb0ef7a":"markdown","55efc52e":"markdown","c42f7fbb":"markdown","1a91c516":"markdown","11979729":"markdown","af1688e4":"markdown","84fe875c":"markdown","e1ab1a03":"markdown","c1ef9cc9":"markdown","f7588d67":"markdown","115a779b":"markdown"},"source":{"de225c38":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns","c524c437":"car = pd.read_csv(\"..\/input\/usa-cers-dataset\/USA_cars_datasets.csv\")","a80eacc6":"car.head()","7bf0b3c9":"car.drop(\"Unnamed: 0\",axis=1)","dc353eff":"car.isna().sum()","3d27f782":"car[\"brand\"].value_counts().plot()","70c6d6d3":"maxprice=car.groupby(\"brand\")\nmaxprice=maxprice[\"model\",\"price\"].max()\nmaxprice=maxprice.sort_values(by=\"price\",ascending=False)\nmaxprice.plot(kind=\"bar\")","9c5d7f52":"carmodel = car[\"model\"].value_counts().plot()\n","b113704c":"car[\"year\"].value_counts().plot(kind=\"bar\")","9f3fc13d":"carmodel=car.groupby(\"year\")\ncarmodel=carmodel[\"brand\",\"price\"].max()\ncarmodel=carmodel.sort_values(by=\"year\",ascending=False)\ncarmodel\n","4ec15513":"car[\"title_status\"].value_counts().plot(kind=\"bar\")","d601a7aa":"maxmileage=car.groupby(\"brand\")\nmaxmileage=maxmileage[\"model\",\"mileage\"].max()\nmaxmileage=maxmileage.sort_values(by=\"mileage\",ascending=False)\nmaxmileage","06d6fa94":"car[\"mileage\"].mean()","5d4d0030":"car[\"color\"].value_counts().plot()","81a93573":"car_state=car.groupby(\"country\")\ncar_state=car_state[\"state\",\"brand\",\"year\",\"price\"].max()\ncar_state\n\n","22bb912b":"car[\"country\"].value_counts().plot(kind=\"bar\")","a99baed7":"country=car.groupby(\"country\")\ncountry=country[\"state\"].max()\ncountry","14f262d4":"car.columns","f22c82ec":"car.head()","1be931a3":"car=car.drop([\"Unnamed: 0\",\"year\",\"vin\",\"lot\",\"condition\"],axis=1)","420278e1":"car.columns","216c99b9":"x=car.drop(\"price\",axis=1)\ny=car[\"price\"]","e3580b3f":"from sklearn.preprocessing import LabelEncoder","b79506dd":"le = LabelEncoder()","e45be816":"x = x.apply(le.fit_transform)","f5d169a3":"x.head()","67b31baf":"\nfrom sklearn.model_selection import train_test_split,GridSearchCV\nx_train,x_test, y_train, y_test = train_test_split(x,y, test_size = 0.20, random_state=42)","f985bcf9":"# Applying Stochastic gradient descent regressor techinique ","d7ddc1fb":"from sklearn.linear_model import SGDRegressor","d761bd14":"lin_model=SGDRegressor()","28683936":"param_grid = {\n    'alpha': 10.0 ** -np.arange(1, 7),\n    'loss': ['squared_loss', 'huber', 'epsilon_insensitive'],\n    'penalty': ['l2', 'l1', 'elasticnet'],\n    'learning_rate': ['constant', 'optimal', 'invscaling'],\n}","58eb9344":"sgd = GridSearchCV(lin_model, param_grid)","eea6d134":"import warnings\nwarnings.filterwarnings(\"ignore\",category=DeprecationWarning)\nwarnings.filterwarnings(\"ignore\",category=FutureWarning)","84956395":"sgd.fit(x_train, y_train)","c9206cfa":"y_pred=sgd.predict(x_test)","1d774e83":"from sklearn.metrics import r2_score","fb49c1bb":"r2=-(r2_score(y_test,y_pred))","7f6cf8b7":"r2","5ecddfda":"from sklearn import ensemble\nfrom sklearn.ensemble import GradientBoostingRegressor\nmodel = ensemble.GradientBoostingRegressor()\nmodel.fit(x_train, y_train)","6da1c96f":"y_pred2=model.predict(x_test)","6bc910a9":"r2=r2_score(y_test,y_pred2)","6135c21e":"r2","f9a1d097":"from sklearn.ensemble import RandomForestRegressor\n\nforest_reg = RandomForestRegressor(random_state=42)\nforest_reg.fit(x_train, y_train)","4f19b827":"y_pred3=forest_reg.predict(x_test)","02f9827c":"r2=r2_score(y_test,y_pred3)","e95e1769":"r2","8d72e9f6":"# At last will apply simple linear regression technique ","fe64f45d":"#creat linear regression\nfrom sklearn.linear_model import LinearRegression\nlin_model=LinearRegression()\nlin_model.fit(x_train,y_train)","5f5a6619":"y_pred4=lin_model.predict(x_test)","0d52aa0d":"r2=r2_score(y_test,y_pred4)","a149a780":"\nr2\n","6dd1c682":"y_predection=forest_reg.predict(x)","649fb020":"y_predection","788259a0":"new_price = pd.DataFrame(y_predection)\nnew_price","1edd1790":"car[\"predict_price\"]=new_price","61f9515d":"car.head()","67b8e951":"# From canada and ontario state, it is dodge brand car listed with max price.\n# From USA and Wyoming state, it is toyota brand car listed with max price.","d0eae6dc":"# R2 is very low using SGD technique Hence will explore another technique to improve R2","8bc2d600":"# Exploratory Data Analysis\n\n# Drop : unnamed :0 Column ","9d3f66ca":"# Max. listed car color is White","2dd99971":"# Applying label encoding on all the independent variable\n","1700c5cc":"# Max number of car are from USA","b269f0a8":"# Max number of car  are from the state : ontario ( Canada ) and wyoming ( USA) ","dcac821f":"# Droping few variable which has least impact on price","c8b1e7ee":"# Max. number of car model present for auction is of : Door ( Model)","22947911":"# Maximum number of car brand available for auction : - Ford : 1200 (approx) in number","cb779a26":"# R2 incresed to 0.64 applying RandomForestRegressor","af0da62b":"# Max. number of car listed with title status of  : Clean vehicle","8f105072":"# Checking if there is any null value available","6cb0ef7a":"# Will forecast predicted price of all the car avaiable for sale by using forest regressor technique with highest R2 value that is 0.64","55efc52e":"# Best mileage car brand is : peterbilt with model: Truck","c42f7fbb":"# R2 has improved to 0.63 by using GradientBoostingRegressor","1a91c516":"# Maximum price of car : model is : Mercedes benz","11979729":"# now you can check and compare actual and predicted price below","af1688e4":"# Car with highest auction price listed is of brand : Nissan   ","84fe875c":"# spliting the data in to test and train","e1ab1a03":"# Max no. of car having vehicle registration number of year : 2019","c1ef9cc9":"# will apply random forest regressor technique","f7588d67":"# Now will apply Gradient Boosting Regressor technique","115a779b":"# Seprating target and independent varibale"}}