{"cell_type":{"989391e1":"code","9c00435d":"code","c5d1aabd":"code","2b267149":"code","b1f28633":"code","16afeb07":"code","aaa97c68":"code","ffbbcad6":"code","cf948671":"code","d5aac9a3":"code","d9270667":"code","1bc61b8e":"code","ae802315":"code","56a82f62":"code","d4fe49f7":"code","44923834":"code","ec4a124a":"code","533c50cc":"code","4afe1f97":"code","9a12f1fa":"code","b9677f71":"code","f66098d7":"code","b359cac6":"code","8b76532f":"code","46eb0848":"code","01464b6b":"code","e62a9ac3":"code","1253ab30":"code","69f92f10":"code","473b8278":"code","03970d9d":"code","cc8d59d2":"code","0fa30e69":"code","6389367a":"code","09ca72f4":"code","86d2efee":"code","65e21da6":"code","4f6d14c2":"code","e7facb95":"code","ebf81ee0":"code","4a1a1c2b":"code","93c76fcb":"code","07844d16":"code","dd2a41fa":"code","11156edc":"code","5d4684ad":"code","94bf10f1":"code","3e35e41d":"markdown","e1a4e090":"markdown","8ec512ea":"markdown","15e47a88":"markdown","0ddf0dfa":"markdown","a183ba4f":"markdown","763fa2fc":"markdown","0fc73da8":"markdown","62bd5e24":"markdown","14e998bf":"markdown","70b723fa":"markdown","78df0097":"markdown","bf716f61":"markdown","4c4e74e1":"markdown","39523b98":"markdown","5c34ff8f":"markdown","bc13d82f":"markdown","c0b33b0e":"markdown","9ee0ffc4":"markdown","ed5c4189":"markdown","19ec78d5":"markdown","c6eb88d0":"markdown","556b1102":"markdown","6cd4a4f7":"markdown","b12b2edd":"markdown"},"source":{"989391e1":"import matplotlib.pyplot as plt\nimport seaborn as sns\nimport pandas as pd\nimport numpy as np\nimport os\n\nprint(os.listdir(\"..\/input\"))","9c00435d":"data = pd.read_csv('..\/input\/heart.csv')\n\ndata.head()","c5d1aabd":"data.isnull().sum()","2b267149":"data.drop([48,92,158,163,164,251,281], inplace=True)","b1f28633":"data2 = data.copy()\n\ndata2.columns = ['Age', 'Sex', 'Chest Pain Type', 'Resting Blood Pressure', 'Cholesterol', 'Fasting Blood Sugar', 'Rest ECG', 'Max Heart Rate Achieved',\n       'Exercise Induced Angina', 'st Depression', 'st Slope', 'Number Major Vessels', 'Thalassemia', 'Heart Desease']\n\ndata2.replace({'Sex':{0:'Female',1:'Male'},\n              'Chest Pain Type':{0:'Asymptomatic',1:'Atypical Angina',2:'Non-Anginal Pain',3:'Typical Angina'},\n              'Fasting Blood Sugar':{1:'> 120 mg\/dl',0:'< 120 mg\/dl'},\n              'Rest ECG':{0:'Left Ventricular Hypertrophy',1:'Normal',2:'ST-T wave abnormality'},\n              'Exercise Induced Angina':{1:'Yes',0:'No'},\n              'st Slope':{0:'Downsloping',1:'Flat',2:'Upsloping'},\n              'Thalassemia':{1:'Fixed Defect',2:'Normal',3:'Reversable Defect'},\n              'Heart Desease':{0:'Yes',1:'No'}\n              },inplace=True)\n","16afeb07":"sns.set(rc={'figure.figsize':(8,6)},style='white',palette=\"Reds_d\")","aaa97c68":"ax = sns.heatmap(data2.corr().round(2),annot=True)","ffbbcad6":"ax = sns.distplot(data2.Age)\npd.DataFrame(data2.Age.describe().round(2)).transpose()","cf948671":"ax = sns.kdeplot(data2[data2['Sex']=='Male']['Age'],shade=True)\nax = sns.kdeplot(data2[data2['Sex']=='Female']['Age'],shade=True)\nax = ax.set_xlabel('Age')\nplt.legend(['Male','Female'])\n\ndata2.groupby('Sex').Age.describe().round(2)","d5aac9a3":"ax = sns.boxplot(data=data2, x='Chest Pain Type', y='Age', width=0.5)\ndata2.groupby('Chest Pain Type').Age.describe().round(2)","d9270667":"ax = sns.lmplot(data=data2, x='Age', y='Resting Blood Pressure')\ndata2.groupby(pd.cut(data2[\"Age\"],5))['Resting Blood Pressure'].describe()","1bc61b8e":"ax = sns.lmplot(data=data2, x='Age', y='Cholesterol')\ndata2.groupby(pd.cut(data2[\"Age\"],5))['Cholesterol'].describe()","ae802315":"ax = sns.boxplot(data=data2, x='Fasting Blood Sugar', y='Age', width=0.5)\ndata2.groupby('Fasting Blood Sugar').Age.describe().round(2)","56a82f62":"ax = sns.boxplot(data=data2, x='Rest ECG', y='Age', width=0.5)\ndata2.groupby('Rest ECG').Age.describe().round(2)","d4fe49f7":"ax = sns.lmplot(data=data2, x='Age', y='Max Heart Rate Achieved')\ndata2.groupby(pd.cut(data2[\"Age\"],5))['Max Heart Rate Achieved'].describe()","44923834":"ax = sns.boxplot(data=data2, x='Exercise Induced Angina', y='Age', width=0.5)\ndata2.groupby('Exercise Induced Angina').Age.describe().round(2)","ec4a124a":"ax = sns.lmplot(data=data2, x='Age', y='st Depression')\ndata2.groupby(pd.cut(data2[\"Age\"],5))['st Depression'].describe()","533c50cc":"ax = sns.boxplot(data=data2, x='st Slope', y='Age', width=0.5)\ndata2.groupby('st Slope').Age.describe().round(2)","4afe1f97":"ax = sns.boxplot(data=data2, x='Number Major Vessels', y='Age', width=0.5)\ndata2.groupby('Number Major Vessels').Age.describe().round(2)","9a12f1fa":"ax = sns.boxplot(data=data2, x='Thalassemia', y='Age', width=0.5)\ndata2.groupby('Thalassemia').Age.describe().round(2)","b9677f71":"ax = sns.boxplot(data=data2, x='Heart Desease', y='Age', width=0.5)\ndata2.groupby('Heart Desease').Age.describe().round(2)","f66098d7":"ax = sns.countplot(data=data2,x=\"Sex\",hue=\"Heart Desease\")","b359cac6":"print(round(len(data2[(data2['Sex']=='Male') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Sex']=='Male')]),2))\nprint(round(len(data2[(data2['Sex']=='Female') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Sex']=='Female')]),2))","8b76532f":"ax = sns.kdeplot(data2[data2['Heart Desease']=='Yes']['Age'],shade=True)\nax = sns.kdeplot(data2[data2['Heart Desease']=='No']['Age'],shade=True)\nax = ax.set_xlabel('Age')\nax = plt.legend(['Yes','No'])\n\ndata2.groupby('Heart Desease').Age.describe().round(2)","46eb0848":"ax = sns.countplot(data=data2,x=\"Chest Pain Type\",hue=\"Heart Desease\")","01464b6b":"print(len(data2[(data2['Chest Pain Type']=='Typical Angina') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Chest Pain Type']=='Typical Angina')]))\nprint(len(data2[(data2['Chest Pain Type']=='Non-Anginal Pain') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Chest Pain Type']=='Non-Anginal Pain')]))\nprint(len(data2[(data2['Chest Pain Type']=='Atypical Angina') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Chest Pain Type']=='Atypical Angina')]))\nprint(len(data2[(data2['Chest Pain Type']=='Asymptomatic') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Chest Pain Type']=='Asymptomatic')]))","e62a9ac3":"ax = sns.boxplot(data=data2,x='Heart Desease', y='Resting Blood Pressure')\ndata2.groupby('Heart Desease')['Resting Blood Pressure'].describe().round(2)","1253ab30":"ax = sns.boxplot(data=data2,x='Heart Desease', y='Cholesterol')\ndata2.groupby('Heart Desease')['Cholesterol'].describe().round(2)","69f92f10":"ax = sns.countplot(data=data2,x=\"Fasting Blood Sugar\",hue=\"Heart Desease\")","473b8278":"print(len(data2[(data2['Fasting Blood Sugar']=='> 120 mg\/dl') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Fasting Blood Sugar']=='> 120 mg\/dl')]))\nprint(len(data2[(data2['Fasting Blood Sugar']=='< 120 mg\/dl') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Fasting Blood Sugar']=='< 120 mg\/dl')]))","03970d9d":"ax = sns.countplot(data=data2,x=\"Rest ECG\",hue=\"Heart Desease\")","cc8d59d2":"print(len(data2[(data2['Rest ECG']=='Left Ventricular Hypertrophy') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Rest ECG']=='Left Ventricular Hypertrophy')]))\nprint(len(data2[(data2['Rest ECG']=='Normal') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Rest ECG']=='Normal')]))\nprint(len(data2[(data2['Rest ECG']=='ST-T wave abnormality') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Rest ECG']=='ST-T wave abnormality')]))","0fa30e69":"ax = sns.boxplot(data=data2,x='Heart Desease', y='Max Heart Rate Achieved')\ndata2.groupby('Heart Desease')['Max Heart Rate Achieved'].describe().round(2)","6389367a":"ax = sns.countplot(data=data2,x=\"Exercise Induced Angina\",hue=\"Heart Desease\")","09ca72f4":"print(len(data2[(data2['Exercise Induced Angina']=='No') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Exercise Induced Angina']=='No')]))\nprint(len(data2[(data2['Exercise Induced Angina']=='Yes') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Exercise Induced Angina']=='Yes')]))","86d2efee":"ax = sns.boxplot(data=data2,x='Heart Desease', y='st Depression')\ndata2.groupby('Heart Desease')['st Depression'].describe().round(2)","65e21da6":"ax = sns.countplot(data=data2,x=\"st Slope\",hue=\"Heart Desease\")","4f6d14c2":"print(len(data2[(data2['st Slope']=='Downsloping') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['st Slope']=='Downsloping')]))\nprint(len(data2[(data2['st Slope']=='Upsloping') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['st Slope']=='Upsloping')]))\nprint(len(data2[(data2['st Slope']=='Flat') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['st Slope']=='Flat')]))","e7facb95":"ax = sns.countplot(data=data2,x=\"Number Major Vessels\",hue=\"Heart Desease\")","ebf81ee0":"print(len(data2[(data2['Number Major Vessels']==3) & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Number Major Vessels']==3)]))\nprint(len(data2[(data2['Number Major Vessels']==2) & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Number Major Vessels']==2)]))\nprint(len(data2[(data2['Number Major Vessels']==1) & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Number Major Vessels']==1)]))\nprint(len(data2[(data2['Number Major Vessels']==0) & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Number Major Vessels']==0)]))","4a1a1c2b":"ax = sns.countplot(data=data2,x=\"Thalassemia\",hue=\"Heart Desease\")","93c76fcb":"print(len(data2[(data2['Thalassemia']=='Fixed Defect') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Thalassemia']=='Fixed Defect')]))\nprint(len(data2[(data2['Thalassemia']=='Normal') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Thalassemia']=='Normal')]))\nprint(len(data2[(data2['Thalassemia']=='Reversable Defect') & (data2['Heart Desease']=='Yes')])\/len(data2[(data2['Thalassemia']=='Reversable Defect')]))","07844d16":"data2.drop(['Resting Blood Pressure','Cholesterol', 'Fasting Blood Sugar'],axis=1,inplace=True)\n\ny = data2['Heart Desease']\n\ndata2.drop(['Heart Desease'],axis=1, inplace=True)\n\nx = data2","dd2a41fa":"y.replace({'Heart Desease':{'Yes':0,'No':1}},inplace=True)","11156edc":"x = pd.get_dummies(x)","5d4684ad":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import train_test_split, cross_val_score\nfrom sklearn.metrics import accuracy_score, cohen_kappa_score, confusion_matrix\nfrom sklearn.svm import LinearSVC\n\nX_train, X_test, y_train, y_test = train_test_split(x,y,test_size=0.2)","94bf10f1":"clf = RandomForestClassifier(n_estimators=100, max_depth=5,random_state=0)\nscores = cross_val_score(clf, X_train, y_train, cv=5)\nprint(\"Accuracy: {:.2f} (+\/- {:.2f})\".format(scores.mean(), scores.std() * 2))\n\n\nclf.fit(X_train,y_train)\nprint(\"Test score: {:.2f}\".format(accuracy_score(y_test,clf.predict(X_test))))\nprint(\"Cohen Kappa score: {:.2f}\".format(cohen_kappa_score(y_test,clf.predict(X_test))))\nax = sns.heatmap(confusion_matrix(y_test,clf.predict(X_test)),annot=True)\nax= ax.set(xlabel='Predicted',ylabel='True',title='Confusion Matrix')","3e35e41d":"## Steps of this Kernel\n1. Check missing data\n2. Fix the Dataset\n3. Exploratory analysis","e1a4e090":"No statistical difference.","8ec512ea":"First let's see the correaltion Age has with the other variables.","15e47a88":"Cholesterol doesnt influence on heart desease.","0ddf0dfa":"## Analysing Age Influence on the other Variables","a183ba4f":"We can see that heart deseases occur more on people with 60 years old","763fa2fc":"Proportionally 3 and 2 Major Vessels have more Heart Deseases.","0fc73da8":"Proportionally Thalassemia of Reversable effect have more Heart Desease.","62bd5e24":"No missing data, let's proceed to the next step.","14e998bf":"## Introduction\n\nThe dataset is provided by [UCI Machine Learning Repository][1], the original database contains 76 attributes, but all published experiments refer to using a subset of 14 of them:\n\n1. Age: The person's age in years\n2. Sex: The person's sex (1=male, 0=female)\n3. Chest Pain type (Value 1: typical angina, Value 2: atypical angina, Value 3: non-anginal pain, Value 4: asymptomatic)*\n4. Resting Blood Pressure (mm Hg on admission to the hospital)\n5. Serum Cholestoral in mg\/dl\n6. Fasting Blood Sugar (> 120 mg\/dl, 1 = true; 0 = false)\n7. Resting Electrocardiographic results  (0 = normal, 1 = having ST-T wave abnormality, 2 = showing probable or definite left ventricular hypertrophy by Estes' criteria)*\n8. Maximum Heart Rate achieved \n9. Exercise Induced Angina (1 = yes; 0 = no)\n10. Oldpeak = ST depression induced by exercise relative to rest \n11. The slope of the peak exercise ST segment (Value 1: upsloping, Value 2: flat, Value 3: downsloping)*\n12. Number of Major Vessels (0-3) colored by flourosopy \n13. Thalassemia (3 = normal; 6 = fixed defect; 7 = reversable defect)*\n14. Heart disease (0 = no, 1 = yes)*\n\n\n*according to this [post][2] on the discussion of this dataset we have some problems. So here it goes the CORRECT description of the kaggle dataset:\n\n    cp: chest pain type\n    -- Value 0: asymptomatic\n    -- Value 1: atypical angina\n    -- Value 2: non-anginal pain\n    -- Value 3: typical angina\n\n    restecg: resting electrocardiographic results\n    -- Value 0: showing probable or definite left ventricular hypertrophy by Estes' criteria \n    -- Value 1: normal\n    -- Value 2: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\n\n    slope: the slope of the peak exercise ST segment\n    -- 0: downsloping\n    -- 1: flat\n    -- 2: upsloping\n\n    thal: \n    -- 1 = fixed defect\n    -- 2 = normal \n    -- 3 = reversable defect\n\n    target (maybe THE most important feature): 0 = disease, 1 = no disease\n\n    A few more things to consider:\n    data #92, 158, 164, 163, 164 and 251 have ca=4 which is incorrect. In the original Cleveland dataset they are NaNs (so they should be removed)\n    data #48 and 281 have thal = 0, also incorrect. They are also NaNs in the original dataset.\n\n\n[1]:https:\/\/archive.ics.uci.edu\/ml\/datasets\/Heart+Disease\n[2]:https:\/\/www.kaggle.com\/ronitf\/heart-disease-uci\/discussion\/105877\n\n","70b723fa":"Proportionally Exercise Induced Angina have more Heart deseases.","78df0097":"St Depression have higher values to Heart Desease","bf716f61":"From the data obtained by the above graphs, we can say that Age has some weak impact on the other variables.","4c4e74e1":"Now that we fixed the dataset let's go to the next step.","39523b98":"## Analysing the cause of Heart Desease","5c34ff8f":"Proportionally the Rest EEG: ST-T wave abnormality have more Heart Deseases.","bc13d82f":"Resting Blood Presure doesnt influence on HEart Desease.","c0b33b0e":"Proportionally the Chest Pain: Asymptomatic have more Heart Deseases.","9ee0ffc4":"Proportionally Man have more Heart Desease.","ed5c4189":"Proportionally st Slope of type Flat have more Heart Deseases.","19ec78d5":"For correcting the database we should follow this:\n\n    data #92, 158, 163, 164 and 251 have ca=4 which is incorrect. In the original Cleveland dataset they are NaNs (so they should be removed)\n    data #48 and 281 have thal = 0, also incorrect. They are also NaNs in the original dataset.","c6eb88d0":"As we can see, age have some positive correaltion with Number of Major Vessels, Resting Blood Pressure, Cholesterol and st Depression. And a negative correlation with Max Heart Rate Achieved.","556b1102":"Max Heart Rate Achieved have lower values to Heart Desease.","6cd4a4f7":"So, we can say the variables that influences in Heart Desease:\n> Sex\n\n> Age\n\n>Chest Pain\n\n>Rest EEG\n\n>Max HEart Rate Achieved\n\n>Exercise Induced Angina\n\n>St Depression\n\n>st Slope\n\n>Major Vessels\n\n>Thalassemia","b12b2edd":"# An exploratory study of Heart Desease"}}