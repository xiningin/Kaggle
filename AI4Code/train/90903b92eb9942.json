{"cell_type":{"3d093097":"code","fb926f62":"code","8a93a25e":"code","f34af748":"code","501a2358":"code","56970d1c":"code","71a15b6f":"code","629e283b":"code","22627828":"code","cac71aa5":"code","cc0e7a79":"code","03c5d63f":"code","3b899b2d":"code","ae8ae3a2":"code","5cf1f2fa":"code","aa1af606":"code","ddd29bd0":"code","f5416297":"code","e0708a4b":"code","34836fe9":"code","0d0c0f25":"code","0c689d85":"markdown","4ac8d72f":"markdown","bf7c0fdf":"markdown","f4155b7d":"markdown","22320740":"markdown","fb352d53":"markdown","7f2100f6":"markdown","9741d251":"markdown","c23d6505":"markdown","6aee6e45":"markdown","c1a1a436":"markdown","fa410494":"markdown"},"source":{"3d093097":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","fb926f62":"\ndata = pd.read_csv(\"..\/input\/diabetes.csv\")\ndata.head()\n","8a93a25e":"data.info()","f34af748":"non_zero = ['Glucose','BloodPressure','SkinThickness','Insulin','BMI']\nfor coloumn in non_zero:\n    data[coloumn] = data[coloumn].replace(0,np.NaN)\n    mean = int(data[coloumn].mean(skipna = True))\n    data[coloumn] = data[coloumn].replace(np.NaN,mean)\n    print(data[coloumn])","501a2358":"from sklearn.model_selection import train_test_split\nX =data.iloc[:,0:8]\ny =data.iloc[:,8]\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state=0, stratify=y)\nX.head()","56970d1c":"#feature Scaling\nfrom sklearn.preprocessing import StandardScaler\nsc_X = StandardScaler()\nX_train = sc_X.fit_transform(X_train)\nX_test = sc_X.transform(X_test)\n","71a15b6f":"from sklearn import svm\nsvm1 = svm.SVC(kernel='linear', C = 0.01)\nsvm1.fit(X_test,y_test)","629e283b":"y_train_pred = svm1.predict(X_train)\ny_test_pred = svm1.predict(X_test)","22627828":"\ny_test_pred","cac71aa5":"from sklearn.metrics import accuracy_score,confusion_matrix","cc0e7a79":"confusion_matrix(y_test,y_test_pred)","03c5d63f":"accuracy_score(y_test,y_test_pred)","3b899b2d":"df=pd.DataFrame({'Actual':y_test, 'Predicted':y_test_pred})\ndf","ae8ae3a2":"from sklearn.model_selection import GridSearchCV","5cf1f2fa":"param = {'C':(0,0.01,0.5,0.1,1,2,5,10,50,100,500,1000)}","aa1af606":"svm1 = svm.SVC(kernel = 'linear')","ddd29bd0":"svm.grid = GridSearchCV(svm1,param,n_jobs=1,cv=10,verbose=1,scoring='accuracy')","f5416297":"svm.grid.fit(X_train,y_train)","e0708a4b":"svm.grid.best_params_","34836fe9":"linsvm_clf = svm.grid.best_estimator_","0d0c0f25":"accuracy_score(y_test,linsvm_clf.predict(X_test))","0c689d85":"We created our linear model with C as 0.01. But how to ensure its the best value. Once option is to change is manually. We can assign different values and run the code one by one.but this process is very lenghty and time consuming.","4ac8d72f":"For data X we are taking all the rows of coloumn ranging from 0 to 7. Similary for y we are taking all the rows for the 8th coloumn.\n\nWe have train_test_split which we had imported during the start of the program and we have defined test size as 0.2 which implies out of all the data 20% will be kept aside to test the data at a later stage.","bf7c0fdf":"We have araay of data but we need to evalute our model to check the accuracy. Lets start it with confusion matrix","f4155b7d":"This will give us the result of the best C value for the model","22320740":"Lets check the confusion matrix","fb352d53":"We will use grid search where we will assign different values of C and from the dictionary of value our model will tell use which is the best value for C as per the model. To do so we need to import GridsearchCV","7f2100f6":"We have the confusion matrix where the diagnol with 118 and 36 shows the correct value and 0,0 shows the prediction that we missed.\n\nWe will check the accuracy score","9741d251":"This is the best accuracy we can get out of the above C values.","c23d6505":"cv represnet cross validation. verbose is 1: represnt the amount of message we will be getting. ","6aee6e45":"We have  accuracy score of 0.78\n\n","c1a1a436":"In the similar way we can try for Kernel ='poly'. But for rbf we need to define gaama values as well.\nparam = {'C':(0,0.01,0.5,0.1,1,2,5,10,50,100,500,1000)}, 'gamma':(0,0.1,0.2,2,10)\n    and with normal one value of C \n    from sklearn import svm\nsvm1 = svm.SVC(kernel='rbf',gamma=0.5, C = 0.01)\nsvm1.fit(X_test,y_test)","fa410494":"We will read the csv file through pd.read_csv.And through head() we can see top 5 rows. There are some factors where the values cannot be zero. For example Glucose value cannot be 0 for a human. Similary BloodPressure,SkinThickness,Insulin and BMI cannot be zero for a human."}}