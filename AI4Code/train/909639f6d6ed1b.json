{"cell_type":{"51e70b80":"code","6a0ec5f0":"code","8c6a509d":"code","05e689a8":"code","6f8bf831":"code","8c436780":"code","82134712":"code","0034f2b6":"code","724542e0":"code","85e0cda0":"code","0f9b57ed":"code","919442f9":"code","7d1232f2":"code","edfc653e":"code","8176ff22":"code","ce159e89":"code","f6b7a8e9":"code","6291592a":"code","7b90cb8e":"code","517467af":"code","42104639":"code","29996221":"code","40cb0874":"code","f36ffa65":"code","3df7e0e7":"code","cae3a037":"code","c86d2648":"code","17bdc960":"code","25775512":"code","0d62681a":"code","6b27c5fa":"code","e5e4f2f1":"code","c85968b4":"code","294fa8c0":"code","8d8da7c8":"code","cfb7e948":"code","53be1c4b":"code","183d41bc":"code","0e8b0be3":"code","28e5a933":"code","6a630f7c":"code","b2e889fc":"code","a3fc4b47":"code","5e3d1e08":"code","aa0664b6":"code","27b6f026":"code","17e6cdc2":"code","1f5220a0":"markdown","71f4e64c":"markdown","ae274a72":"markdown","08d1b87f":"markdown","0c6e5339":"markdown","7d1062d9":"markdown","0e921a4f":"markdown","8a9b5f87":"markdown","45ba9863":"markdown","67b4356c":"markdown","26904ea6":"markdown","1a3443a4":"markdown","287abc38":"markdown","3a804782":"markdown","d4097452":"markdown","9b21a8b8":"markdown","2c40d24d":"markdown","94262ff9":"markdown","1b061ff6":"markdown","29fbf3b8":"markdown","3f71ade6":"markdown","7fdce0db":"markdown","69f8108f":"markdown"},"source":{"51e70b80":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.plotly as py\nfrom plotly.offline import init_notebook_mode,iplot\ninit_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nseed=5\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\nimport gc\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","6a0ec5f0":"train_identity=pd.read_csv('..\/input\/train_identity.csv',index_col='TransactionID')\ntest_identity=pd.read_csv('..\/input\/test_identity.csv',index_col='TransactionID')\ntrain_transaction=pd.read_csv('..\/input\/train_transaction.csv',index_col='TransactionID')\ntest_transaction=pd.read_csv('..\/input\/test_transaction.csv',index_col='TransactionID')\nsub=pd.read_csv('..\/input\/sample_submission.csv',index_col='TransactionID')","8c6a509d":"print('Shape of train identity :',train_identity.shape)\nprint('Shape of test identity :',test_identity.shape)\nprint('Shape of train transaction :',train_transaction.shape)\nprint('Shape of test transaction :',test_transaction.shape)","05e689a8":"train_identity.head()","6f8bf831":"train_transaction.head()","8c436780":"train_df=pd.merge(train_identity,train_transaction,how='right',on='TransactionID')\ntest_df=pd.merge(test_identity,test_transaction,how='right',on='TransactionID')","82134712":"del train_identity,test_identity,train_transaction,test_transaction","0034f2b6":"train_df.info()","724542e0":"def downcast(df):\n    float_cols=[col for col in df.columns if df[col].dtype=='float']\n    df[float_cols]=df[float_cols].astype('float32')\n    int_cols=[col for col in df.columns if df[col].dtype=='int']\n    df[int_cols]=df[int_cols].astype('int16')\n    return df    ","85e0cda0":"train_df=downcast(train_df)\ntest_df=downcast(test_df)","0f9b57ed":"train_df.to_csv('IEEE_train.csv')\ntest_df.to_csv('IEEE_test.csv')","919442f9":"print(train_df.shape)\nprint(test_df.shape)","7d1232f2":"train_df.info()","edfc653e":"def null_values(df):\n    series_1=pd.Series(df.isnull().sum(),name='Total null values')\n    series_2=pd.Series(series_1*100\/df.shape[0],name='Percentage of null values')\n    null_df=pd.concat([series_1,series_2],axis=1).sort_values(by='Percentage of null values',ascending=False)\n    return null_df","8176ff22":"null_df=null_values(train_df)","ce159e89":"null_df.head()","f6b7a8e9":"def fill_missing(df):\n    num_cols=[col for col in df.columns if df[col].dtype=='float32' or df[col].dtype=='int16']\n    for col in num_cols:\n        df[col]=df[col].fillna(df[col].mean())\n    obj_cols=[col for col in df.columns if df[col].dtype=='object']\n    for col in obj_cols:\n        df[col]=df[col].fillna(df[col].mode()[0])\n        \n    return df","6291592a":"train_df=fill_missing(train_df)\ntest_df=fill_missing(test_df)","7b90cb8e":"num_cols=[col for col in train_df.columns if train_df[col].dtype=='int16' or train_df[col].dtype=='float32']\nnum_cols.remove('isFraud')\ntrain_df['mean']=train_df[num_cols].mean(axis=1)\ntest_df['mean']=test_df[num_cols].mean(axis=1)\ntrain_df['max']=train_df[num_cols].max(axis=1)\ntest_df['max']=test_df[num_cols].max(axis=1)\ntrain_df['min']=train_df[num_cols].min(axis=1)\ntest_df['min']=test_df[num_cols].min(axis=1)\ntrain_df['median']=train_df[num_cols].median(axis=1)\ntest_df['median']=test_df[num_cols].median(axis=1)\ntrain_df['skew']=train_df[num_cols].skew(axis=1)\ntest_df['skew']=test_df[num_cols].skew(axis=1)\ntrain_df['kurt']=train_df[num_cols].kurt(axis=1)\ntest_df['kurt']=test_df[num_cols].kurt(axis=1)","517467af":"#blue represents train while orange represents test\n#I had tried setting labels but the legends of adjacent plots used to overlap.\nfig,ax=plt.subplots(10,10,figsize=(16,16))\nplt.tight_layout()\nfor i in range(10):\n    for j in range(10):\n        sns.distplot(train_df[num_cols[i*10+j]],ax=ax[i,j],hist=False)\n        sns.distplot(test_df[num_cols[i*10+j]],ax=ax[i,j],hist=False)\n        ax[i,j].set_xlabel(num_cols[i*10+j])\n        plt.legend()\n        \n\nplt.show()","42104639":"fig,ax=plt.subplots(10,10,figsize=(16,16))\nplt.tight_layout()\nfor i in range(10):\n    for j in range(10):\n        sns.distplot(train_df[num_cols[i*10+j+100]],ax=ax[i,j],hist=False)\n        sns.distplot(test_df[num_cols[i*10+j+100]],ax=ax[i,j],hist=False)\n        ax[i,j].set_xlabel(num_cols[i*10+j+100])\n        plt.legend()\n        \n\nplt.show()","29996221":"fig,ax=plt.subplots(10,10,figsize=(16,16))\nplt.tight_layout()\nfor i in range(10):\n    for j in range(10):\n        sns.distplot(train_df[num_cols[i*10+j+200]],ax=ax[i,j],hist=False)\n        sns.distplot(test_df[num_cols[i*10+j+200]],ax=ax[i,j],hist=False)\n        ax[i,j].set_xlabel(num_cols[i*10+j+200])\n        plt.legend()\n        \n\nplt.show()","40cb0874":"fig,ax=plt.subplots(10,10,figsize=(16,16))\nplt.tight_layout()\nfor i in range(10):\n    for j in range(10):\n        sns.distplot(train_df[num_cols[i*10+j+300]],ax=ax[i,j],hist=False)\n        sns.distplot(test_df[num_cols[i*10+j+300]],ax=ax[i,j],hist=False)\n        ax[i,j].set_xlabel(num_cols[i*10+j+300])\n        plt.legend()\n        \n\nplt.show()","f36ffa65":"sns.distplot(train_df['V339'],label='train',hist=False)\nsns.distplot(test_df['V339'],label='test',hist=False)\nplt.legend()","3df7e0e7":"obj_cols=[col for col in train_df.columns if train_df[col].dtype=='object']\n\nfig,ax=plt.subplots(3,2,figsize=(10,10))\n\nfor i in range(3):\n    j=0\n    sns.countplot(train_df[obj_cols[i*2+j]],ax=ax[i,j])\n    sns.countplot(test_df[obj_cols[i*2+j]],ax=ax[i,j+1])\n    ax[i,j].set_title('Train')\n    ax[i,j+1].set_title('Test')\n    ax[i,j].set_xlabel(obj_cols[i*2+j])\n    ax[i,j+1].set_xlabel(obj_cols[i*2+j])\n    \nplt.tight_layout()    \nplt.show()","cae3a037":"fig,ax=plt.subplots(3,2,figsize=(10,10))\n\nfor i in range(3):\n    j=0\n    sns.countplot(train_df[obj_cols[i*2+j+6]],ax=ax[i,j])\n    sns.countplot(test_df[obj_cols[i*2+j+6]],ax=ax[i,j+1])\n    ax[i,j].set_title('Train')\n    ax[i,j+1].set_title('Test')\n    ax[i,j].set_xlabel(obj_cols[i*2+j+6])\n    ax[i,j+1].set_xlabel(obj_cols[i*2+j+6])\n    \nplt.tight_layout()    \nplt.show()","c86d2648":"fig,ax=plt.subplots(3,2,figsize=(10,10))\n\nfor i in range(3):\n    j=0\n    sns.countplot(train_df[obj_cols[i*2+j+12]],ax=ax[i,j])\n    sns.countplot(test_df[obj_cols[i*2+j+12]],ax=ax[i,j+1])\n    ax[i,j].set_title('Train')\n    ax[i,j+1].set_title('Test')\n    ax[i,j].set_xlabel(obj_cols[i*2+j+12])\n    ax[i,j+1].set_xlabel(obj_cols[i*2+j+12])\n    \nplt.tight_layout()    \nplt.show()","17bdc960":"fig,ax=plt.subplots(3,2,figsize=(10,10))\n\nfor i in range(3):\n    j=0\n    sns.countplot(train_df[obj_cols[i*2+j+18]],ax=ax[i,j])\n    sns.countplot(test_df[obj_cols[i*2+j+18]],ax=ax[i,j+1])\n    ax[i,j].set_title('Train')\n    ax[i,j+1].set_title('Test')\n    ax[i,j].set_xlabel(obj_cols[i*2+j+18])\n    ax[i,j+1].set_xlabel(obj_cols[i*2+j+18])\n    \nplt.tight_layout()    \nplt.show()","25775512":"fig,ax=plt.subplots(3,2,figsize=(10,10))\n\nfor i in range(3):\n    j=0\n    sns.countplot(train_df[obj_cols[i*2+j+24]],ax=ax[i,j])\n    sns.countplot(test_df[obj_cols[i*2+j+24]],ax=ax[i,j+1])\n    ax[i,j].set_title('Train')\n    ax[i,j+1].set_title('Test')\n    ax[i,j].set_xlabel(obj_cols[i*2+j+24])\n    ax[i,j+1].set_xlabel(obj_cols[i*2+j+24])\n    \nplt.tight_layout()    \nplt.show()","0d62681a":"fig,ax=plt.subplots(1,2,figsize=(10,10))\n\nsns.countplot(train_df[obj_cols[30]],ax=ax[0])\nsns.countplot(test_df[obj_cols[30]],ax=ax[1])\nax[0].set_title('Train')\nax[1].set_title('Test')\nax[0].set_xlabel(obj_cols[30])\nax[1].set_xlabel(obj_cols[30])\n    \nplt.tight_layout()    \nplt.show()","6b27c5fa":"#Blue represents Non Fraud while orange represents Fraud\nfig,ax=plt.subplots(10,10,figsize=(16,16))\nplt.tight_layout()\nfor i in range(10):\n    for j in range(10):\n        sns.distplot(train_df[train_df['isFraud']==0][num_cols[i*10+j]],ax=ax[i,j],hist=False)\n        sns.distplot(train_df[train_df['isFraud']==1][num_cols[i*10+j]],ax=ax[i,j],hist=False)\n        ax[i,j].set_xlabel(num_cols[i*10+j])\n        \n        \n\nplt.show()","e5e4f2f1":"fig,ax=plt.subplots(10,10,figsize=(16,16))\nplt.tight_layout()\nfor i in range(10):\n    for j in range(10):\n        sns.distplot(train_df[train_df['isFraud']==0][num_cols[i*10+j+100]],ax=ax[i,j],hist=False)\n        sns.distplot(train_df[train_df['isFraud']==1][num_cols[i*10+j+100]],ax=ax[i,j],hist=False)\n        ax[i,j].set_xlabel(num_cols[i*10+j+100])\n        plt.legend()\n        \n\nplt.show()","c85968b4":"fig,ax=plt.subplots(10,10,figsize=(16,16))\nplt.tight_layout()\nfor i in range(10):\n    for j in range(10):\n        sns.distplot(train_df[train_df['isFraud']==0][num_cols[i*10+j+200]],ax=ax[i,j],hist=False)\n        sns.distplot(train_df[train_df['isFraud']==1][num_cols[i*10+j+200]],ax=ax[i,j],hist=False)\n        ax[i,j].set_xlabel(num_cols[i*10+j+200])\n        plt.legend()\n        \n\nplt.show()","294fa8c0":"fig,ax=plt.subplots(10,10,figsize=(16,16))\nplt.tight_layout()\nfor i in range(10):\n    for j in range(10):\n        sns.distplot(train_df[train_df['isFraud']==0][num_cols[i*10+j+300]],ax=ax[i,j],hist=False)\n        sns.distplot(train_df[train_df['isFraud']==1][num_cols[i*10+j+300]],ax=ax[i,j],hist=False)\n        ax[i,j].set_xlabel(num_cols[i*10+j+300])\n        plt.legend()\n        \n\nplt.show()\n","8d8da7c8":"sns.distplot(train_df[train_df['isFraud']==0]['V339'],hist=False,label='Non Fraud')\nsns.distplot(train_df[train_df['isFraud']==1]['V339'],hist=False,label='Fraud')\nplt.legend()\nplt.xlabel('V339')\nplt.show()","cfb7e948":"fig,ax=plt.subplots(3,2,figsize=(10,10))\n\nfor i in range(3):\n    j=0\n    sns.countplot(train_df[train_df['isFraud']==0][obj_cols[i*2+j]],ax=ax[i,j])\n    sns.countplot(train_df[train_df['isFraud']==1][obj_cols[i*2+j]],ax=ax[i,j+1])\n    ax[i,j].set_title('Non_Fraud')\n    ax[i,j+1].set_title('Fraud')\n    ax[i,j].set_xlabel(obj_cols[i*2+j])\n    ax[i,j+1].set_xlabel(obj_cols[i*2+j])\n    \nplt.tight_layout()    \nplt.show()","53be1c4b":"fig,ax=plt.subplots(3,2,figsize=(10,10))\n\nfor i in range(3):\n    j=0\n    sns.countplot(train_df[train_df['isFraud']==0][obj_cols[i*2+j+6]],ax=ax[i,j])\n    sns.countplot(train_df[train_df['isFraud']==1][obj_cols[i*2+j+6]],ax=ax[i,j+1])\n    ax[i,j].set_title('Non_Fraud')\n    ax[i,j+1].set_title('Fraud')\n    ax[i,j].set_xlabel(obj_cols[i*2+j+6])\n    ax[i,j+1].set_xlabel(obj_cols[i*2+j+6])\n    \nplt.tight_layout()    \nplt.show()","183d41bc":"fig,ax=plt.subplots(3,2,figsize=(10,10))\n\nfor i in range(3):\n    j=0\n    sns.countplot(train_df[train_df['isFraud']==0][obj_cols[i*2+j+12]],ax=ax[i,j])\n    sns.countplot(train_df[train_df['isFraud']==1][obj_cols[i*2+j+12]],ax=ax[i,j+1])\n    ax[i,j].set_title('Non_Fraud')\n    ax[i,j+1].set_title('Fraud')\n    ax[i,j].set_xlabel(obj_cols[i*2+j+12])\n    ax[i,j+1].set_xlabel(obj_cols[i*2+j+12])\n    \nplt.tight_layout()    \nplt.show()","0e8b0be3":"fig,ax=plt.subplots(3,2,figsize=(10,10))\n\nfor i in range(3):\n    j=0\n    sns.countplot(train_df[train_df['isFraud']==0][obj_cols[i*2+j+18]],ax=ax[i,j])\n    sns.countplot(train_df[train_df['isFraud']==1][obj_cols[i*2+j+18]],ax=ax[i,j+1])\n    ax[i,j].set_title('Non_Fraud')\n    ax[i,j+1].set_title('Fraud')\n    ax[i,j].set_xlabel(obj_cols[i*2+j+18])\n    ax[i,j+1].set_xlabel(obj_cols[i*2+j+18])\n    \nplt.tight_layout()    \nplt.show()","28e5a933":"fig,ax=plt.subplots(3,2,figsize=(10,10))\n\nfor i in range(3):\n    j=0\n    sns.countplot(train_df[train_df['isFraud']==0][obj_cols[i*2+j+24]],ax=ax[i,j])\n    sns.countplot(train_df[train_df['isFraud']==1][obj_cols[i*2+j+24]],ax=ax[i,j+1])\n    ax[i,j].set_title('Non_Fraud')\n    ax[i,j+1].set_title('Fraud')\n    ax[i,j].set_xlabel(obj_cols[i*2+j+24])\n    ax[i,j+1].set_xlabel(obj_cols[i*2+j+24])\n    \nplt.tight_layout()    \nplt.show()","6a630f7c":"fig,ax=plt.subplots(1,2,figsize=(10,10))\n\nsns.countplot(train_df[train_df['isFraud']==0][obj_cols[30]],ax=ax[0])\nsns.countplot(train_df[train_df['isFraud']==1][obj_cols[30]],ax=ax[1])\nax[0].set_title('Non_Fraud')\nax[1].set_title('Fraud')\nax[0].set_xlabel(obj_cols[30])\nax[1].set_xlabel(obj_cols[30])\n    \nplt.tight_layout()    \nplt.show()","b2e889fc":"fig,ax=plt.subplots(2,1,figsize=(10,10))\nsns.distplot(train_df['mean'],ax=ax[0],label='train')\nsns.distplot(test_df['mean'],ax=ax[0],label='test')\nax[0].set_title('Train and Test Mean Column')\nplt.legend()\n\n\nsns.distplot(train_df[train_df['isFraud']==0]['mean'],ax=ax[1],label='Non Fraud')\nsns.distplot(train_df[train_df['isFraud']==1]['mean'],ax=ax[1],label='Fraud')\nax[1].set_title('Fraud and Non Fraud Mean Column')\nplt.legend()\n\nplt.tight_layout()\nplt.show()","a3fc4b47":"fig,ax=plt.subplots(2,1,figsize=(10,10))\nsns.distplot(train_df['max'],ax=ax[0],label='train')\nsns.distplot(test_df['max'],ax=ax[0],label='test')\nax[0].set_title('Train and Test Max Column')\nplt.legend()\n\nsns.distplot(train_df[train_df['isFraud']==0]['max'],ax=ax[1],label='Non Fraud')\nsns.distplot(train_df[train_df['isFraud']==1]['max'],ax=ax[1],label='Fraud')\nax[1].set_title('Fraud and Non Fraud Max Column')\nplt.legend()\n\nplt.tight_layout()\nplt.show()","5e3d1e08":"fig,ax=plt.subplots(2,1,figsize=(10,10))\nsns.distplot(train_df['min'],ax=ax[0],label='train')\nsns.distplot(test_df['min'],ax=ax[0],label='test')\nax[0].set_title('Train and Test Min Column')\nplt.legend()\n\nsns.distplot(train_df[train_df['isFraud']==0]['min'],ax=ax[1],label='Non Fraud')\nsns.distplot(train_df[train_df['isFraud']==1]['min'],ax=ax[1],label='Fraud')\nax[1].set_title('Fraud and Non Fraud Min Column')\nplt.legend()\n\nplt.tight_layout()\nplt.show()","aa0664b6":"fig,ax=plt.subplots(2,1,figsize=(10,10))\nsns.distplot(train_df['median'],ax=ax[0],label='train')\nsns.distplot(test_df['median'],ax=ax[0],label='test')\nax[0].set_title('Train and Test Median Column')\nplt.legend()\n\nsns.distplot(train_df[train_df['isFraud']==0]['median'],ax=ax[1],label='Non Fraud')\nsns.distplot(train_df[train_df['isFraud']==1]['median'],ax=ax[1],label='Fraud')\nax[1].set_title('Fraud and Non Fraud Median Column')\nplt.legend()\n\nplt.tight_layout()\nplt.show()","27b6f026":"fig,ax=plt.subplots(2,1,figsize=(10,10))\nsns.distplot(train_df['skew'],ax=ax[0],label='train')\nsns.distplot(test_df['skew'],ax=ax[0],label='test')\nax[0].set_title('Train and Test Skew Column')\nplt.legend()\n\nsns.distplot(train_df[train_df['isFraud']==0]['skew'],ax=ax[1],label='Non Fraud')\nsns.distplot(train_df[train_df['isFraud']==1]['skew'],ax=ax[1],label='Fraud')\nax[1].set_title('Fraud and Non Fraud Skew Column')\nplt.legend()\n\nplt.tight_layout()\nplt.show()","17e6cdc2":"fig,ax=plt.subplots(2,1,figsize=(10,10))\nsns.distplot(train_df['kurt'],ax=ax[0],label='train')\nsns.distplot(test_df['kurt'],ax=ax[0],label='test')\nax[0].set_title('Train and Test Kurt Column')\nplt.legend()\n\nsns.distplot(train_df[train_df['isFraud']==0]['kurt'],ax=ax[1],label='Non Fraud')\nsns.distplot(train_df[train_df['isFraud']==1]['kurt'],ax=ax[1],label='Fraud')\nax[1].set_title('Fraud and Non Fraud Kurt Column')\nplt.legend()\n\nplt.tight_layout()\nplt.show()","1f5220a0":"**Visualization of new engineered features**","71f4e64c":"Here again, we try to find features which have similar and features which have different distributions in case of Fraudulent and Non-Fraudulent data. In many cases, Fraudulent data(orange) features have sharply peaked distributions. ","ae274a72":"**Important step not go out of RAM**","08d1b87f":"Similar .","0c6e5339":"Most of the train and test feature distributions look similar. Some distributions like that of TransactionDT, card1,card2,addr1,addr2,etc. almost exactly overlap, that's a bit strange I guess. Some distributions like that of C9,id13,id21(peaks at different value) are significantly different.","7d1062d9":"**Visualizing all numerical features for Train and Test Data **","0e921a4f":"**Fill missing values of numerical features with their mean and that of categorical feature with their mode.**","8a9b5f87":"**Save these downcasted dataframes becausing downcasting was time consuming**","45ba9863":"**Generate some  new features**","67b4356c":"**Visualizing all categorical features for Fraud and Non-Fraudulent transactions.**","26904ea6":"**Visualizing all categorical features of Train and Test set**","1a3443a4":"This is my first competition so I am pretty excited. All the best to everyone reading my kernel. Hope you get to learn something about this dataset through my kernel. Please upvote if you like the kernel. ","287abc38":"Some distributions like that of V77,V78,V86,V87 are seemingly different. Here again, many look similar, some are just shifted versions while some are completely different. We do similar analysis for the rest of the numerical features.","3a804782":"**Loading the data**","d4097452":"The kurtosis is shifted as well.","9b21a8b8":"Distribution of unique values of id_16 is different in Fraudulent and Non-Fraudulent transactions. id 27 has only 1 unique in case of Fraudulent transactions. We do similar analysis for further categorical features.","2c40d24d":"**Downcast the dataframes to free up upto 1 GB RAM. **","94262ff9":"**Importing basic libraries and modules**","1b061ff6":"All the distributions are similar in train and test","29fbf3b8":"Train and test skewness is a bit shifted. ","3f71ade6":"Similar distributions for train-test as well as for fraud-nonfraud combo.","7fdce0db":"id_31 has too many unique values. id_34 has more unique values in train than in test. We do similar analysis for rest of the categorical features.","69f8108f":"**Visualizing all numerical features for Fraudulent and Non-Fraudulent transactions.**"}}