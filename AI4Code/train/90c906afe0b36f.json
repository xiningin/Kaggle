{"cell_type":{"40d469e0":"code","c2cd0fa1":"code","bffb401c":"code","c3b69110":"code","a3ee7af0":"code","f6e9c59c":"code","5a8954f7":"markdown","e543f8ca":"markdown","c3d690e8":"markdown","6d65fe29":"markdown","f64f0549":"markdown"},"source":{"40d469e0":"import pandas as pd\nimport plotly.express as px\n\n\ndata = pd.read_csv(\"..\/input\/fortune-global-2000-companies-till-2021\/fortune_2000_in_2021.csv\")\ndata.head()","c2cd0fa1":"def convert_to_numeric(col: str, data: pd.DataFrame = data) -> pd.Series:\n    \"\"\"Get numeric values for the specified `col` i.e convert '$1M to 1000000.\n\n    Parameters\n    ----------\n    col : str\n        The name of a column in the dataset `data`.\n    data : pandas.core.frame.DataFrame\n        A dataset having columns with numeric values stored as strings.\n\n    Returns\n    -------\n    pandas.core.series.Series\n        Numeric values.\"\"\"\n    scale = data[col].str.contains(\"M\").map({True: 1e6, False: 1e9})\n    digits = (\n        data[col]\n        .str.replace(\",\", \"\")\n        .str.extract(\"(\\d+\\.?\\d*)\", expand=False)\n        .astype(\"float\")\n    )\n    return digits * scale\n\n\nnumeric_columns = [\"Assets\", \"Market Value\", \"Sales\", \"Profit\"]\n\nfor col in numeric_columns:\n    data[col] = convert_to_numeric(col)\n\ndata.head()","bffb401c":"colors = [\"skyblue\", \"navy\", \"steelblue\", \"#55ee55\"]\nn = 10\ntop_n = data.nsmallest(n, columns=\"Rank\")\n\n\nbar_chart = px.bar(\n    top_n,\n    x=\"Name\",\n    y=numeric_columns,\n    barmode=\"stack\",\n    color_discrete_sequence=colors,\n    height=550,\n    width=800,\n    title=f\"Top {n} Companies\",\n    template=\"simple_white\",\n)\nbar_chart.update_layout(\n    font_family=\"serif\", title_font_size=20, title_x=0.5, hovermode=\"x unified\"\n)\nbar_chart.update_traces(hovertemplate=\"%{y}\")\nbar_chart.update_xaxes(fixedrange=True, tickangle=-45, title=\"Company\")\nbar_chart.update_yaxes(fixedrange=True, title=\"Value\")\nbar_chart.show()\n\n\npie_chart = px.pie(\n    names=numeric_columns,\n    values=data[numeric_columns].sum(),\n    color_discrete_sequence=colors,\n    hole=0.5,\n    height=480,\n    width=800,\n    title=\"Overall (Sum)\",\n)\npie_chart.update_traces(hovertemplate=\"<i>%{label}<\/i>: <b>%{value:.3s}<\/b>\")\npie_chart.update_layout(font_family=\"serif\", title_font_size=20, title_x=0.5)\npie_chart.show()","c3b69110":"fig = px.bar(\n    top_n,\n    x=\"Name\",\n    y=[\"Sales\", \"Profit\"],\n    barmode=\"stack\",\n    color_discrete_sequence=[\"steelblue\", \"#55ee55\"],\n    height=550,\n    width=800,\n    title=f\"Performance of the Top {n} Companies\",\n    template=\"simple_white\",\n)\nfig.update_layout(\n    font_family=\"serif\", title_font_size=20, title_x=0.5, hovermode=\"x unified\"\n)\nfig.update_traces(hovertemplate=\"%{y}\")\nfig.update_xaxes(fixedrange=True, tickangle=-45, title=\"Company\")\nfig.update_yaxes(fixedrange=True, title=\"Value\")","a3ee7af0":"fig = px.bar(\n    top_n,\n    x=\"Name\",\n    y=[\"Market Value\", \"Assets\"],\n    barmode=\"stack\",\n    color_discrete_sequence=[\"blue\", \"skyblue\"],\n    height=550,\n    width=800,\n    title=f\"Value of the Top {n} Companies\",\n    template=\"simple_white\",\n)\nfig.update_layout(\n    font_family=\"serif\", title_font_size=20, title_x=0.5, hovermode=\"x unified\"\n)\nfig.update_traces(hovertemplate=\"%{y}\")\nfig.update_xaxes(fixedrange=True, tickangle=-45, title=\"Company\")\nfig.update_yaxes(fixedrange=True, title=\"Value\")","f6e9c59c":"correlation_with_rank = data.corrwith(data[\"Rank\"])\n\n\nfor column, color in zip(numeric_columns, colors):\n    fig = px.scatter(\n        data.nsmallest(100, columns=\"Rank\"),\n        x=\"Rank\",\n        y=column,\n        color=\"Rank\",\n        color_continuous_scale=[color, \"#fee\"],\n        hover_data=[\"Name\"],\n        trendline=\"ols\",\n        width=480,\n        height=480,\n        template=\"simple_white\",\n        title=(\n            f\"Relationship between Rank and {column}<br>\"\n            f\"<sup>Correlation: {correlation_with_rank[column]:.4f}<\/sup>\"\n        ),\n    )\n    fig.update_layout(\n        font_family=\"serif\", margin=dict(l=0, r=0, b=0), title_font_size=18, title_x=0.5\n    )\n    fig.update_xaxes(fixedrange=True)\n    fig.update_yaxes(fixedrange=True)\n    fig.show()","5a8954f7":"# Contribution of the Various Components","e543f8ca":"# Value of Top Ranking Companies\n\nIt is rather interesting that the highest ranked company has a lower market value than its peers. But it more than makes up for it by having the largest asset volume.","c3d690e8":"# Performance of Top Ranking Companies\n\nMaking the most sales or profit doesn't necessarily guarantee the highest ranking.","6d65fe29":"# Relationship between Rank and Performance, Value","f64f0549":"## Get numeric values for Sales, Profit, Assets & Market Value"}}