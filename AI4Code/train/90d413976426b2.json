{"cell_type":{"76dc27be":"code","02328170":"code","277c6825":"code","109f4d44":"code","9a2dfc11":"code","d42a7638":"code","0d2c30be":"markdown","2cd99f5f":"markdown","9deee3c8":"markdown","9f4031a4":"markdown","44e8a8db":"markdown"},"source":{"76dc27be":"import pandas  as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\ntrain_data = pd.read_csv('..\/input\/titanic\/train.csv')\ntest_data  = pd.read_csv('..\/input\/titanic\/test.csv')\n\nfeatures = [\"Sex\", \"Pclass\"]\n\nX_train       = pd.get_dummies(train_data[features])\ny_train       = train_data[\"Survived\"]\nX_test        = pd.get_dummies(test_data[features])\n\nfrom sklearn import tree\nmodel = tree.DecisionTreeClassifier(criterion='gini',\n                                         splitter='best',\n                                         max_depth=2,\n                                         random_state=42)\nmodel.fit(X_train, y_train)","02328170":"import pickle\npickle.dump(model, open(\"titanic_model.sav\", 'wb'))","277c6825":"def make_a_prediction(Sex,Pclass):\n    import pickle\n    \n    if Sex == 1:\n        Sex_female = 1\n        Sex_male   = 0\n    else:\n        Sex_female = 0\n        Sex_male   = 1\n        \n    x = [[Pclass,Sex_female,Sex_male]]\n    # read in the model\n    my_model = pickle.load(open('..\/input\/titanic-pickle-save\/titanic_model.sav','rb'))\n    # make a prediction\n    prediction = my_model.predict(x)\n    if prediction == 0:\n        return \"not survived\"\n    else:\n        return \"survived\"","109f4d44":"# female in 3rd class:\nprint(make_a_prediction(1,3))","9a2dfc11":"# female in 1st class:\nprint(make_a_prediction(1,1))","d42a7638":"# male in 1st class:\nprint(make_a_prediction(0,1))","0d2c30be":"Looks like everything is working fine!","2cd99f5f":"# Saving our machine learning model to a file using [pickle](https:\/\/docs.python.org\/3\/library\/pickle.html)\nWhen deploying our machine learning model using web frameworks such as [Django](https:\/\/www.djangoproject.com\/) or [Flask](https:\/\/flask.palletsprojects.com) we will need to save our model to a file. He we shall provide an example of doing this by writing out a python [pickle](https:\/\/docs.python.org\/3\/library\/pickle.html) file.\n## A simple model of the Titanic\nWe shall use a very simple model of the [Titanic data](https:\/\/www.kaggle.com\/c\/titanic) which is just based on [sex and class](https:\/\/www.kaggle.com\/carlmcbrideellis\/titanic-some-sex-a-bit-of-class-and-a-tree). In this simple model everyone dies except females who were in either 1st or 2nd class:","9deee3c8":"now try out the model (`1` for female, `0` for male)\nRemember, in this simple model everyone dies except females who were in either 1st or 2nd class.","9f4031a4":"now to save this model as a [pickle](https:\/\/docs.python.org\/3\/library\/pickle.html) file. We provide a name for our saved model, here `titanic_model.sav`, which will be written out in binary mode (`wb`):","44e8a8db":"Now we run our notebook, and the pickle file `titanic_model.sav` should be located in the **Output** section. \n\nFor the purposes of this demonstration I have saved the `titanic_model.sav` as a kaggle [dataset](https:\/\/www.kaggle.com\/carlmcbrideellis\/titanic-pickle-save) which we can now load back in and use.\n# Load in and use our pickle model"}}