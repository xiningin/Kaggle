{"cell_type":{"82a1dde4":"code","700fa96d":"code","c0586b68":"code","db64bb67":"code","fbc4694b":"code","e2b64dff":"code","444cda0d":"code","65da79c9":"code","9dc9c23a":"code","afa7bbcc":"code","1a3e6a33":"code","3c991399":"code","d10a0f08":"code","ae8de8d3":"code","69b3d3d1":"code","247287ad":"code","05f8ec3e":"code","3d520337":"code","9c48819a":"code","e6f16582":"code","558daf48":"code","62a97587":"code","0ce37584":"code","0ac6afdb":"code","ccd585b9":"code","fdcefadb":"code","7bd60680":"code","567c57b7":"code","d03bd152":"code","3c57d08b":"code","8a8622f2":"code","7c9b3f75":"code","e02c5e4e":"code","0b3a3717":"code","6034c268":"code","4cf16af5":"code","2ce897f4":"code","68923203":"code","89409356":"code","ea5b3e15":"code","6e27cc0a":"code","c3df955a":"code","c4e6bf16":"code","9e8a2fbb":"code","0be5bb3d":"code","be0db970":"markdown","4918ff4f":"markdown","8909942b":"markdown","34268fec":"markdown","a4dbfc0f":"markdown","76baa8a3":"markdown","bf3815ab":"markdown","967a462e":"markdown","da9f8f04":"markdown","0ad812f8":"markdown","6e4d8503":"markdown","8872e3db":"markdown","128a1c96":"markdown","bb95e16d":"markdown","1e27f6cd":"markdown","47976cb0":"markdown","52a224fb":"markdown","0780d7bb":"markdown","676d8428":"markdown","954074a7":"markdown","5498f343":"markdown","0d4a0063":"markdown","e54ba3f8":"markdown","279ae632":"markdown","cae5b332":"markdown","55def8e1":"markdown","e7fb1741":"markdown","9e1f0b00":"markdown","c40ae35d":"markdown","cb2b432b":"markdown","17dd8201":"markdown","8ddf2658":"markdown","96ca94b0":"markdown","04566c3c":"markdown","159f3441":"markdown","fcb08f14":"markdown","44e53b14":"markdown","63dca385":"markdown","3e0e2da7":"markdown","daafeed6":"markdown","c4e3595b":"markdown","da1858af":"markdown","0c86c4ce":"markdown","a5dbc33f":"markdown","3f7ab4ca":"markdown","5259a0ea":"markdown","431a55b1":"markdown","977b8eb7":"markdown","5c13b30d":"markdown","439a2038":"markdown","73698df0":"markdown","5c9d8eb9":"markdown","5b0f80d5":"markdown","8536a72e":"markdown","110bb0fe":"markdown","4aa251c1":"markdown","a2257cb4":"markdown"},"source":{"82a1dde4":"import pandas as pd\nimport glob\nimport math\nimport numpy as np\nimport os as os\nimport matplotlib.pylab as plt\n%matplotlib inline\nfrom matplotlib.pylab import rcParams\nplt.style.use('fivethirtyeight')\nrcParams['figure.figsize'] = 20, 8\n\n#path = \"X:\/Historico_Cotacoes\/teste\/alpha_data\/\"\nnomeArq = '..\/input\/alphacart12018.csv'\n\n#pwd = os.getcwd() # guarda o path corrente\n#os.chdir(os.path.dirname(path)) # muda para o path dos arquivos\n\ndateparse = lambda dates: pd.datetime.strptime(dates, '%Y-%m-%d')\n#df = pd.read_csv(os.path.basename(nomeArq), parse_dates=[\"datetime\"], index_col=\"datetime\",date_parser=dateparse)\ndf = pd.read_csv(nomeArq, parse_dates=[\"datetime\"], index_col=\"datetime\",date_parser=dateparse)","700fa96d":"df['2018-08-28' : '2018-08-28'].head(15)","c0586b68":"## Definindo a data de inicio das observacoes, quandotodos os ativos possuem dados\nstart_date = \"2013-01-01\"\nend_date = \"2018-12-31\"\ns = df.loc[start_date:end_date] \ndf = s.copy()","db64bb67":"combined = df.sort_index(ascending=True)\nd_decimals = 2    \ncombined['adj_close'] = combined['adj_close'].apply(lambda x: round(x, d_decimals))\ncomb = combined.copy()","fbc4694b":"combined = comb.copy()\ncombined.head()","e2b64dff":"combined.info()","444cda0d":"comb = combined.copy()\ncomb.reset_index(inplace = True)\ncomb.head()","65da79c9":"# Checando e eliminando os feriados nacionais brasileiros\nferiados = ['2013-01-01', '2013-01-25', '2013-02-11', '2013-02-12', '2013-02-13', '2013-02-18', '2013-03-29', '2013-04-21', '2013-05-01', '2013-05-30', '2013-07-09', '2013-09-07', '2013-11-15', '2013-11-20', '2013-12-25', '2014-01-01', '2014-01-25', '2014-03-03', '2014-03-04', '2014-03-05', '2014-04-18', '2014-04-21', '2014-05-01', '2014-06-19', '2014-07-09', '2014-09-07', '2014-11-20', '2014-12-25', '2015-01-01', '2015-01-25', '2015-02-25', '2015-02-16', '2015-02-17', '2015-02-18', '2015-04-03', '2015-04-21', '2015-05-01', '2015-06-04', '2015-07-09', '2015-09-07', '2015-10-12', '2015-11-02', '2015-11-20', '2015-12-25', '2016-01-01', '2016-01-25', '2016-02-08', '2016-02-09', '2016-02-10', '2016-03-25', '2016-04-21', '2016-05-01', '2016-05-26', '2016-07-09', '2016-09-07', '2016-10-12', '2016-11-02', '2016-11-15', '2016-12-25', '2017-01-01', '2017-01-25', '2017-02-27', '2017-02-28', '2017-03-01', '2017-04-14', '2017-04-21', '2017-05-01', '2017-06-15', '2017-07-09', '2017-09-07', '2017-10-12', '2017-11-02', '2017-11-15', '2017-11-20', '2017-12-25', '2018-01-01', '2018-01-25', '2018-02-25', '2018-02-12', '2018-02-13', '2018-02-14', '2018-03-30', '2018-04-21', '2018-05-01', '2018-05-31', '2018-07-09', '2018-09-07', '2018-10-12', '2018-11-02', '2018-11-15', '2018-11-20', '2018-12-25']\ndf = comb[~comb['datetime'].isin(feriados)]\ncombined = df.sort_index(ascending=True)\ncombined.head()","9dc9c23a":"df_cum_ativos =  combined.groupby('datetime')['adj_close'].sum().reset_index()","afa7bbcc":"df_cum_ativos.head()","1a3e6a33":"# reconstruindo o indice da serie temporal de dados acumulados por data\nkeys = 'datetime'\ndf_cum_ativos.set_index(keys, drop=True, append=False, inplace=True)","3c991399":"# outliers:\nout_drop = ['2013-04-26', '2013-07-26', '2013-12-24', '2013-12-31', '2014-06-12', '2014-12-24', '2014-12-31', \\\n            '2015-12-24', '2015-12-31', '2016-12-30']\ndf = df_cum_ativos.copy()\ndf.drop(pd.to_datetime(out_drop), inplace=True)\ndf_cum_ativos = df.copy()\n# inspecionando o \u00edndice datetime reconstru\u00eddo\ndf_cum_ativos.head()","d10a0f08":"# resumo dos 5 \u00faltimos registros da s\u00e9rie\ndf_cum_ativos.tail()","ae8de8d3":"# Vamos isolar agora apenas os dados que entrar\u00e3o no modelo (colunas 'adj_close' e 'datetime' que \u00e9 o \u00edndice)\ncols = ['adj_close']\ndfcot = df_cum_ativos[cols].copy() # faz uma c\u00f3pia \nport = dfcot.copy() ","69b3d3d1":"## Substitui pre\u00e7os Zero pela m\u00e9dia\ndf = port.copy()\nmask = (df['adj_close'] != 0)\nnomask = (df['adj_close'] == 0)\nNumeric_columns = ['adj_close']\nmeans = df.loc[mask, Numeric_columns].mean()\ndf.loc[nomask, Numeric_columns] = means\nport = df.copy()","247287ad":"# Tracando uma primeira visualizacao do portfolio\nnp.warnings.filterwarnings(\"ignore\")\n\n# Fig prepare\nfig = plt.figure(figsize=(20, 8))\nplt.ylim(200, 550)\n\nplt.rc('axes', axisbelow=True)\nax = plt.subplot(111)\n\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.title(\"Portfolio de Pre\u00e7os Di\u00e1rios Ajustados\")\n#plt.axis(['2013-01-01','2018-12-31', 0.0, 1.0], bin=100)\n\nplt.plot(port, 'k-', alpha=0.5);","05f8ec3e":"# Tracando a MM de 21 per\u00edodos (30 dias corridos)\nfig = plt.figure(figsize=(20, 8))\nr = port.rolling(window = 21)\nplt.ylim(200, 550)\nplt.plot(port, '-k', alpha = 0.50)\nplt.title(\"Portfolio e sua Media Movel de 21 dias - MM21 - em vermelho\")\nplt.plot(r.mean(), '-r');\nplt.show();","3d520337":"# Ajustando a estacionariedade da s\u00e9rie com log\nport_ret = np.log10(port).diff().dropna()","9c48819a":"# Primera plotagem ap\u00f3s ajuste por log\n# plt.plot(port_ret, '-k', alpha=0.5);\n\n# Fig prepare\nfig = plt.figure(figsize=(20, 6))\naxis = fig.add_subplot(111)\nplt.ylim(-0.1, 0.1)\n\nplt.rc('axes', axisbelow=True)\nax = plt.subplot(111)\nylabel = 'Valores Log'\nxlabel = '\u00daltimos 5 anos (2013 a 2018)'\nplt.xlabel(xlabel, fontdict=None, labelpad=None)\nplt.ylabel(ylabel, fontdict=None, labelpad=None)\n\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.title(\"Retornos do Portfolio ap\u00f3s amortecimento por Log\")\n#plt.axis(['2013-01-01','2018-12-31', 0.0, 1.0], bin=100)\n\nplt.plot(port_ret, '-k', alpha=0.50);","e6f16582":"port1 = np.cumprod(np.r_[port.values[0], np.power(10, port_ret.values.reshape(len(port_ret)))]) # produto acumulado e exp \"element wize\"\n\n# Fig prepare\nfig = plt.figure(figsize=(20, 8))\naxis = fig.add_subplot(111)\nplt.plot(port1, alpha=0.75);","558daf48":"# Fig prepare\nrcParams['figure.figsize'] = 20, 8\ng = port_ret.hist(bins=21, alpha=0.75);","62a97587":"rcParams['figure.figsize'] = 20, 8\nr = port_ret.rolling(window = 21)\nplt.plot(port_ret, '-k', alpha = 0.50)\nplt.plot(r.std(), '-r');","0ce37584":"import statsmodels.tsa as tsa\nimport statsmodels.api as sm\nfrom pandas import tseries as ts\n\nnp.warnings.filterwarnings(\"ignore\")\n\nmodel=sm.tsa.ARMA(port_ret.as_matrix(), (1,0)).fit(trend = 'c')\n\n#model = sm.tsa.ARMA(port_ret.as_matrix(), (1,0)).fit(trend = 'c')\nprint(model.summary());","0ac6afdb":"m = model.params\nprint(m);","ccd585b9":"port_ar_proc = tsa.arima_process.ArmaProcess(np.r_[1, -model.params], [1])\nport_ar_sim = port_ar_proc.generate_sample(len(port_ret))*model.resid.std()","fdcefadb":"# Fig prepare\nfig = plt.figure(figsize=(20, 8))\nplt.rc('axes', axisbelow=True)\nax = plt.subplot(211)\n\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.title(\"Retorno Real\")\nplt.ylim(-0.1, 0.1)\n# plt.axis([1, 1000, -0.1, 0.1])\nplt.plot(port_ret, 'k', alpha = 0.6)\n\nax = plt.subplot(212)\nplt.title(\"Retorno Simulado\")\nplt.ylim(-0.1, 0.1)\n# plt.axis([1, 1000, -0.1, 0.1])\n\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.plot(port_ar_sim)\n\nplt.show();","7bd60680":"port1 = np.cumprod(np.r_[port.values[1], np.power(10, port_ar_sim)]) # produto acumulado e 10^p \"element wize\"","567c57b7":"# Fig prepare\nfig = plt.figure(figsize=(20, 8))\nplt.rc('axes', axisbelow=True)\nax = plt.subplot(211)\n\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.title(\"S\u00e9rie Original\")\nplt.ylim(100, 1000)\nplt.plot(port, 'k', alpha = 0.75)\n\nax = plt.subplot(212)\nplt.ylim(100, 1000)\n#plt.xlim(150, 1250)\n#plt.axis([150, 1200, 100, 700])\nplt.title(\"S\u00e9rie Simulada a partir do Modelo\")\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.plot(port1)\n\nplt.show();","d03bd152":"# Fig prepare\nfig = plt.figure(figsize=(20, 8))\nplt.rc('axes', axisbelow=True)\nax = plt.subplot(211)\n\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.title(\"Retornos (ou res\u00edduos) Reais\")\nplt.ylim(-0.1, 0.1)\n# plt.axis([1, 1000, -0.1, 0.1])\nplt.plot(port_ret, 'k', alpha = 0.6)\n\nax = plt.subplot(212)\nplt.title(\"Residuos simulados a partir do modelo ARMA\")\nplt.ylim(-0.1, 0.1)\n# plt.axis([1, 1000, -0.1, 0.1])\n\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.plot(model.resid)\n\nplt.show();","3c57d08b":"from arch import arch_model","8a8622f2":"# O modelo envolve elevar ao quadrado valores muito pequenos. Multiplicaremos os valores da serie de retornos que ser\u00e1\n# usada por 100, para diminuirmos a chance de diverg\u00eancia do modelo.\n\nam = arch_model(port_ret*100, p=1, q=1)\nres = am.fit(disp='off')\nprint(res.summary())","7c9b3f75":"# Fig prepare\nfig = plt.figure(figsize=(20, 8))\nplt.rc('axes', axisbelow=True)\nax = plt.subplot(211)\n\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.title(\"Res\u00edduos Reais\")\nplt.ylim(-0.1, 0.1)\n# plt.axis([0, 1000, -0.1, 0.1])\nplt.plot(port_ret, 'k', alpha = 0.75)\n\nax = plt.subplot(212)\nplt.title(\"Res\u00edduos Simulados via Modelo\")\nplt.ylim(-0.1, 0.1)\n# plt.axis([0, 1000, -0.1, 0.1])\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.plot((res.resid\/(res.conditional_volatility*100)))\n\nplt.show();","e02c5e4e":"# Fun\u00e7\u00e3o para simula\u00e7\u00e3o \ndef simulate_garch(params, nobs, var=0):\n    e = np.random.randn(nobs)\n    var = np.zeros(len(e)) + var\n    x = np.zeros(len(e))\n    corr = 0.10200\n    for t in range(len(e)):\n        var[t] = params[1] + params[2] * x[t-1] ** 2 + params[3] * var[t-1]\n        x[t] = params[0] + e[t] * np.sqrt(var[t])\n        \n    return x+corr","0b3a3717":"# Visualizando os par\u00e2metros gerados pelo modelo\nres.params","6034c268":"port_am_sim = simulate_garch(res.params, len(port_ret))","4cf16af5":"# Fig prepare\nfig = plt.figure(figsize=(15, 8))\nplt.rc('axes', axisbelow=True)\nax = plt.subplot(211)\n\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.ylim(-0.1, 0.1)\nplt.title(\"Retornos do Portfolio\")\n# plt.axis([0, 1000, -0.1, 0.1])\nplt.plot(port_ret, 'k', alpha = 0.5)\n\nax = plt.subplot(212)\n# plt.axis([0, 1000, -0.1, 0.1])\nplt.ylim(-0.1, 0.1)\nplt.title(\"Retornos Simulados do Portfolio - Modelo Garch\")\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.plot(port_am_sim\/100)\n\nplt.show();","2ce897f4":"# Valores foram restaurados ao original, redividindo-os por 100, antes de simul\u00e1-los\nport1 = np.cumprod(np.r_[port.values[1], np.exp(port_am_sim\/100)]) # produto acumulado e exp \"element wize\"","68923203":"# Fig prepare\nfig = plt.figure(figsize=(20, 8))\nplt.rc('axes', axisbelow=True)\nax = plt.subplot(211)\n\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.title(\"Valores Originais do Portfolio\")\nplt.ylim(200, 750)\n# plt.axis([0, 1000, 2, 5])\nplt.plot(port, 'k', alpha = 0.5)\n\nax = plt.subplot(212)\nplt.title(\"Valores Simulados do Portfolio\")\nplt.ylim(200, 750)\nax.yaxis.grid(color='lightgray')\nplt.plot(port1)\n\nplt.show();","89409356":"# Fig prepare\nfig = plt.figure(figsize=(15, 8))\nplt.rc('axes', axisbelow=True)\nax = plt.subplot(211)\n\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.title(\"Res\u00edduos Reais do Modelo\")\nplt.ylim(-0.1, 0.1)\n# plt.axis([0, 1000, -0.1, 0.1])\nplt.plot(port_ret, 'k', alpha = 0.5)\n\nax = plt.subplot(212)\nplt.title(\"Res\u00edduos Simulados via Modelo\")\nplt.ylim(-0.1, 0.1)\n# plt.axis([0, 1000, -0.1, 0.1])\n#ax.yaxis.grid(color='lightgray', linestyle='dashed')\nax.yaxis.grid(color='lightgray')\nplt.plot((res.resid\/res.conditional_volatility)\/100)\n\nplt.show();","ea5b3e15":"# preparando a serie para tomarmos seus \u00faltimos 252 dias (um ano \u00fatil)\n# e preparando para tra\u00e7ar o gr\u00e1fico das predi\u00e7\u00f5es\nport2 = port.copy()\nport2 = port2.reset_index()\nport2.head()","6e27cc0a":"# eliminando a data do \u00edndice e deixando apenas a s\u00e9rie de valores ajustados do portfolio\nport2.drop('datetime', axis=1, inplace=True)","c3df955a":"port2.head()","c4e6bf16":"len(port2)","9e8a2fbb":"# Preparacao da figura\nfig = plt.figure(figsize=(20, 8))\nplt.rc('axes', axisbelow=True)\nax = plt.subplot(111)\nax.yaxis.grid(color='lightgray')\n\nplt.title(\"Estimativas para o valor do Portfolio\")\nplt.xlabel('Ultimos 252 dias \u00fateis em azul e a previs\u00e3o dos pr\u00f3ximos 21 dias em verde')\n\nplt.ylim(350, 550)\nplt.axis([1160, 1435, 350, 550])\n\nplt.plot(port2.tail(252))\n\npaths = np.zeros((100,21))\nlim = len(port2)\n\nfor i in range(100):\n    port_am_sim = simulate_garch(res.params, 20)\/100              ## restaurando os valores simulados dividindo por 100 \n    path = np.cumprod(np.r_[port.values[-1], np.exp(port_am_sim)])\n    paths[i,:] = path\n    plt.plot(range(lim, lim+21), path, 'g', alpha = 0.10)\n\nplt.plot(range(lim, lim+21), np.mean(paths, 0), '-r');\n","0be5bb3d":"'''\n\n## Buscando ativos no Alpha_vantage Service e gravando localmente numa pasta\n#\n# Parametros Default da Interface\n#\n# api_key: str     = None\n# output_size: str = 'compact'\n# datatype: str    = 'json'\n# export: bool     = False\n# export_path: str = '~\/av_data'\n# output: str      = 'csv'\n# clean: bool      = False\n# proxy: dict      = {}\n\nimport pandas as pd\nimport time\nfrom alphaVantageAPI.alphavantage import AlphaVantage\n\n#\n# A classe AlphaVantage possui os seguintes requisitos:\n#\n# (1) Cadastro previo no site http:\/\/www.alphavantage.co\/support\/ # A api-key, aqui referida, deve se obtida\n#\n# (2) ATENCAO: para instalar a biblioteca alphaVantage aqui utilizada, N\u00c3O SIGA O PROCEDIMENTO pip INDICADO NO SITE.\n#     SIGA O PROCEDIMENTO ABAIXO:\n#          \n#     pip install alphaVantage-api\n# \n# (3) O objetivo deste notebook \u00e9 o de, apenas, compartilhar conhecimentos a respeito das habilidades de an\u00e1lise\n#     das S\u00e9ries Temporais, tema extremamente carente de exemplos pr\u00e1ticos de implementa\u00e7\u00e3o, pelo menos, em \n#     l\u00edngua Portuguesa. A an\u00e1lise de s\u00e9ries temporais \u00e9 reconhecidamente uma habilidade pouco desenvolvida e \n#     carente de profissionais de Data Science que as saibam modelar e interpretar. \n#\n#\n# (4) Valores default\n\napi_key = 'SUA_API_KEY'\nav = AlphaVantage(\n        api_key=api_key,\n        output_size='full',\n        datatype='pandas',\n        export=True,\n        export_path='alpha_data\\\\',\n        output='csv',\n        clean=True,\n        proxy={}\n    )\n\n# Aqui ser\u00e3o usados pre\u00e7os ajustados, obtidos com periodicidade diaria (Daily Adjusted). Outras periodicidades est\u00e3o\n# dispon\u00edveis via a mesma biblioteca. \n# N\u00e3o h\u00e1 garantia, entretanto, quanto \u00e0 qualidade dos dados fornecidos.\n\n#\n# portfolio =  ['ABEV3.SA', 'EZTC3.SA', 'GRND3.SA', 'HGTX3.SA', '1PETR3.SA', 'EGIE3.SA',  \\\n#              'VALE3.SA', 'CIEL3.SA', '1ITUB3.SA', 'ITSA3.SA', 'RADL3.SA', 'PSSA3.SA',  \\\n#              'WEGE3.SA', 'LREN3.SA', 'MDIA3.SA']\n#\n\n#\n# O portfolio aqui estudade consiste numa carteira de a\u00e7\u00f5es ON de empresas brasileiras, com bons fundamentos.\n# Mas poderia ser qualquer outro portfolio de ativos, que possu\u00edsse, pelo meno 50 pontos observ\u00e1veis no tempo.\n#\n# Ao grupo de a\u00e7\u00f5es selecionadas foram inclu\u00eddas VALE e PETROBRAS, pela magnitude do volume burst\u00e1til \n# historicamente movimentado por elas.\n#\n# N\u00e3o h\u00e1, neste estudo, qualquer sugest\u00e3o ou recomenda\u00e7\u00e3o de aquisi\u00e7\u00e3o ou aliena\u00e7\u00e3o de qualquer dos ativos \n# mencionados.\n#\n# Para a AlphaVantage PETR3 = PBR e ITUB3 = ITUB\n#\n\ncarteira =  ['ABEV3.SA', 'EZTC3.SA', 'GRND3.SA', 'HGTX3.SA', 'PBR', 'EGIE3.SA',  \\\n             'VALE3.SA', 'CIEL3.SA', 'ITUB', 'ITSA3.SA', 'RADL3.SA', 'PSSA3.SA',  \\\n             'WEGE3.SA', 'LREN3.SA', 'MDIA3.SA']\n\nfor nome in carteira:\n    pd = av.data(symbol=nome, function='DA') \n    print(\"Proc.: \", nome)\n    time.sleep(7) \nprint()\nprint('OK!')\n\n''';","be0db970":"## Conclus\u00e3o\n\nVimos aqui um exemplo simples de como realizar a an\u00e1lise de s\u00e9ries temporais usando Python, al\u00e9m da aplica\u00e7\u00e3o de conceitos b\u00e1sicos de modelagem. \n\nO entendimento do comportamento de uma s\u00e9rie temporal de portf\u00f3lio \u00e9 informa\u00e7\u00e3o extremamente valiosa para aqueles que dirigem empresas e que necessitem de tomar decis\u00f5es que envolvam risco. As decis\u00f5es de antecipa\u00e7\u00e3o, posterga\u00e7\u00e3o de aquisi\u00e7\u00f5es, execu\u00e7\u00e3o de manuten\u00e7\u00f5es, realiza\u00e7\u00e3o de investimentos, renova\u00e7\u00e3o de contratos, enfim, quaisquer decis\u00f5es econ\u00f4micas que envolvam risco, podem ter qualidade muito melhorada, a partir da an\u00e1lise de s\u00e9ries temporais constru\u00eddas a partir das vari\u00e1veis envolvidas.\n\nEspero que esta aplica\u00e7\u00e3o pr\u00e1tica ajude a melhorarmos o conhecimento e a aplica\u00e7\u00e3o da an\u00e1lise de s\u00e9ries temporais pelas empresas de nosso pa\u00eds, t\u00e3o carente de boas decis\u00f5es.\n\nRecomendamos a leitura da **PARTE 2** deste estudo, que aborda o **M\u00e9todo da Fronteira Eficiente** na gest\u00e3o de risco dos portf\u00f3lios.","4918ff4f":"- os res\u00edduos ainda s\u00e3o menos parecidos, o que indica espa\u00e7o para melhorarmos o modelo. Por\u00e9m diferen\u00e7as podem ser notadas pois, parte da informa\u00e7\u00e3o comportamental foi transferida para os coeficientes obtidos. ","8909942b":"## Trabalhando com a varia\u00e7\u00e3o dos valores (retornos) do portfolio, no tempo.\u00b6","34268fec":"- exibindo os par\u00e2metros (coeficientes) obtidos no modelo ARMA","a4dbfc0f":" - Colocando o banco de dados (dataframe) do portfolio em ordem crescente de data, apenas para inspe\u00e7\u00e3o de registros.","76baa8a3":"## Voltando com os pre\u00e7os $p_t$ originais\nlog$(\\frac{p_t}{p_{t-1}})$ ==> $p_t = p_{t-1} exp(x_t)$","bf3815ab":"### Anexo: demonstra\u00e7\u00e3o do uso da API do servi\u00e7o AlphaVantage\n\nPara instalar use **pip install alphaVantage-api** \ne em seguida, para garantir a vers\u00e3o mais atual, **pip install --upgrade alphaVantage-api** ","967a462e":"- Reconstruindo e inspecionando o \u00edndice de datas e eliminando valores an\u00f4malos (outliers)","da9f8f04":"- plotando os retornos, real e simulado ($x_t$)","0ad812f8":"- a s\u00e9rie de varia\u00e7\u00e3o de pre\u00e7os costuma ser estacion\u00e1ria. Seja $x_t$ esta varia\u00e7\u00e3o. Ent\u00e3o: <br>\n$x_t$ = log($p_t$) - log($p_{t-1}$)<br>\n= log$(\\frac{p_t}{p_{t-1}})$\n\n- as observa\u00e7\u00f5es ocorrem diariamente, nos dias \u00fateis. O ano \u00fatil tem dura\u00e7\u00e3o m\u00e9dia de 252 dias. \n- o aspecto da s\u00e9rie de retornos \u00e9 o seguinte:","6e4d8503":"- Eliminando outliers (valores an\u00f4malos)","8872e3db":"- a seguir, a lista dos quinze ativos componentes do portf\u00f3lio e respectivos pre\u00e7os em 28\/08\/2018, \u00faltimo dia \u00fatil de agosto:","128a1c96":"**Stastmodels** suporta, dentre outros, os seguintes tipos de modelos:\n- Modelos de regress\u00e3o linear (Linear regression models);\n- Modelos lineares generalizados (Generalized linear models);\n- Modelos de efeitos discretos (Discrete choice models);\n- Modelos lineares robustos (Robust linear models);\n- Fun\u00e7\u00f5es diversas para an\u00e1lises de s\u00e9ries temporais (models and functions for time series);\n- Estimadores n\u00e3o param\u00e9tricos (nonparametric estimators);\n- Uma cole\u00e7\u00e3o de datasets de exemplos (collection of of datasets for examples);\n- Grande n\u00famero de testes estat\u00edsticos (statistical tests);\n- Ferramentas para produ\u00e7\u00e3o de tabelas em diversos formatos(Tools for Text, LaTex, HTML, Stata into NumPy and Pandas formats);\n- Fun\u00e7\u00f5es de plotagem (plotting functions); e\n- Extenso conjunto de testes unit\u00e1rios para garantir resultados corretos (unit tests).\n\nObs.: para maiores informa\u00e7\u00f5es, ver biblioteca [statsmodels](http:\/\/statsmodels.sourceforge.net\/), para Python.","bb95e16d":"## Tentativa de explicar $x_t$ (s\u00e9rie de retornos)","1e27f6cd":"Usaremos, inicialmente, um modelo autorregressivo para tentar explicar o comportamento da s\u00e9rie de retornos do portf\u00f3lio. Este modelo ter\u00e1 como base os modelos ARIMA (AutoRegressive Integrated Moving Average Model) mas usar\u00e1, apenas, a \"por\u00e7\u00e3o\" autorregressiva.","47976cb0":"Foram efetuadas 100 estimativas para os pr\u00f3ximos 21 dias \u00fateis, demostrando a m\u00e9dia esperada em vermelho e o cone de volatilidade poss\u00edvel, em verde.","52a224fb":"- Checando os primeiros registros da s\u00e9rie:","0780d7bb":"## Predi\u00e7\u00f5es","676d8428":"## Recuperando a s\u00e9rie original $p_t$, a partir da simula\u00e7\u00e3o","954074a7":"Obs,: notar que valores muito grandes, ou muito pequenos, podem influir na converg\u00eancia do modelo. Os retornos geralmente s\u00e3o pequenos (na ordem de grandeza) e as vezes uma multiplica\u00e7\u00e3o (por 100 ou 1000) visa a torn\u00e1-los mais significativos diminuindo, desta forma, as chances do modelo divergir. Por\u00e9m, antes da plotagem, os valores s\u00e3o restaurados aos valores originais.","5498f343":"- A seguir, s\u00e3o exibidos os par\u00e2metros (coeficiente) obtidos a partir do modelo ARCH usado.","0d4a0063":"A s\u00e9rie de retornos (gr\u00e1fico acima) \u00e9 tipicamente estacion\u00e1ria.","e54ba3f8":"- A seguir, procedemos a um \"alisamento\" da s\u00e9rie por meio de logaritma\u00e7\u00e3o dos pre\u00e7os do portfolio e calculamos a varia\u00e7\u00e3o (retornos) dos valores, tornando a s\u00e9rie tipicamente estacion\u00e1ria.","279ae632":"#### Rio de Janeiro, 30\/08\/3018\n[Antonio Roberto Mendes Barber\u00e1](https:\/\/rbarbera2.wixsite.com\/backlog\/)","cae5b332":"- notar que os res\u00edduos s\u00e3o quase id\u00eanticos, o que sugere que toda a informa\u00e7\u00e3o comportamental persistiu nos res\u00edduos. Isto indica que o modelo n\u00e3o funcionou bem como estimador, pois quase nenhuma informa\u00e7\u00e3o foi, de fato, retida nos coeficientes obtidos.","55def8e1":"## Simulando os retornos $x_t$ com os coeficientes obtidos pelo modelo ARMA","e7fb1741":"# Parte 1. Montando e analisando a s\u00e9rie temporal de um portf\u00f3lio\nEm face da cr\u00f4nica escassez de dados hist\u00f3ricos p\u00fablicos brasileiros de pre\u00e7os de produtos, optamos por montar um portfolio composto, exclusivamente, de a\u00e7\u00f5es. Foram selecionadas quinze boas empresas da B3\/Bovespa, que t\u00eam apresentado bons fundamentos, contendo dados hist\u00f3ricos de pre\u00e7os (fechamento ajustados) desde o in\u00edcio da participa\u00e7\u00e3o destas empresas na BOVESPA. \n\nH\u00e1, no portfolio criado, empresas que ingressaram no mercado h\u00e1 pouco menos de cinco anos. Por esta raz\u00e3o, foi considerado para a referida an\u00e1lise, apenas o per\u00edodo de 01\/01\/2013 a 30\/08\/2018, intervalo em que todas as empresas apresentavam informa\u00e7\u00f5es de pre\u00e7os ajustados. \n\nForam utilizados os modelos ARMA e GARCH, na tentativa de explica\u00e7\u00e3o do comportamento das s\u00e9ries.\n\n**Sugiro que leia a PARTE 2. deste artigo, que est\u00e1 sendo publicada em separado e ilustrar\u00e1 o uso do M\u00e9todo da Fronteira Eficiente para gest\u00e3o de portf\u00f3lios**, enunciado por [Harry Max Markowitz] (https:\/\/pt.wikipedia.org\/wiki\/Harry_Max_Markowitz). \n\nMarkowitz foi o primeiro a constatar, via modelos matem\u00e1ticos, que o risco individual de um ativo (aqui entendido como o desvio padr\u00e3o dos retornos hist\u00f3ricos) na realidade, n\u00e3o \u00e9 a vari\u00e1vel mais relevante. Cada investimento possui determinado risco e retorno esperados. Portanto, considera-se que o retorno a ser obtido num investimento seja igual ao respectivo valor esperado dos retornos obtidos ao longo de determinado intervalo de tempo, ponderado por sua participa\u00e7\u00e3o dentro do portfolio. Entendemos aqui, como portfolio, qualquer conjunto de ativos agrupados, cujo valor \u00e9 observado ao longo do tempo, segundo intervalos regulares. \n\nSendo assim, ao adicionarmos v\u00e1rios ativos componentes de um portf\u00f3lio, o risco e retorno esperados, ao atuarem em conjunto, podem mostrar mais efici\u00eancia, do que a an\u00e1lise de cada investimento isolado, pelo efeito da correla\u00e7\u00e3o entre eles. \nConsideramos, portanto, que o risco de um portf\u00f3lio ser\u00e1 fun\u00e7\u00e3o da correla\u00e7\u00e3o **$\\rho$** entre todos os ativos componentes. Sua varia\u00e7\u00e3o ter\u00e1 comportamento n\u00e3o-linear e, por consequ\u00eancia, o retorno do portf\u00f3lio ser\u00e1 uma combina\u00e7\u00e3o proporcional dos retornos dos ativos que o constituem.\n\nDesta forma, as correla\u00e7\u00f5es observadas entre os ativos componentes, se forem pequenas, ou at\u00e9 mesmo inversas, tendem a proteger o portf\u00f3lio de grandes oscila\u00e7\u00f5es, sobretudo em momentos de stress.","9e1f0b00":"- vamos usar o passado de $x_t$ e tentar explicar seu futuro. <br>\nPortanto, seja $x_t = \\mu + \\phi_{1}x_{t-1} + e_t$ <br>\nEsta express\u00e3o descreve um **processo autorregressivo**. \u00c9 como se fiz\u00e9ssemos uma regress\u00e3o de $x_t$, sobre o passado de $x_t$ ($x_{t-1}, x_{t-2}, ... x_{t-j}$), onde j \u00e9 o per\u00edodo da m\u00e9dia m\u00f3vel usada. \n\nO modelo deve tentar reproduzir as propriedades estat\u00edsticas da s\u00e9rie de pre\u00e7os do portf\u00f3lio. Para isto usamos a biblioteca **statsmodels**.","c40ae35d":"## M\u00e9dia, mediana e m\u00e9dias m\u00f3veis.\n\n### D\u00favidas comuns entre os conceitos de m\u00e9dia e mediana.\n\nM\u00e9dia e mediana s\u00e3o medidas estat\u00edsticas que possuem papel semelhante, no que se refere \u00e0 compreens\u00e3o da tend\u00eancia do valor central de um conjunto de medidas que realizamos. Embora a m\u00e9dia tenha se popularizado como o ponto m\u00e9dio em uma amostra destas medidas, ela possui a desvantagem de ser muito afetada por um valor \u00fanico, seja ele muito alto, ou muito baixo, se comparado ao restante das medidas que tomamos. \u00c9 por isto que a mediana \u00e9, em determinados casos, considerada a melhor medida do ponto m\u00e9dio de uma s\u00e9rie de observa\u00e7\u00f5es.\n\n- Mediana.\n\nGrosseiramente falando, a mediana \u00e9 descrita como o valor num\u00e9rico que separa a metade superior, de um conjunto de medidas, da sua metade inferior. Elas precisam estar ordenadas crescente, ou decrescentemente. O valor da mediana ser\u00e1 sempre igual, para ambas as ordena\u00e7\u00f5es. A mediana pode ser calculada  em rela\u00e7\u00e3o a uma amostra de medidas, ou para uma popula\u00e7\u00e3o inteira de medidas. Uma mediana pode ser calculada listando-se os n\u00fameros (ou medidas) em ordem crescente e, em seguida, localizando-se o n\u00famero central desta s\u00e9rie de n\u00fameros. Se houver dois n\u00fameros iguais, a mediana passa a ser a m\u00e9dia aritm\u00e9tica destes dois n\u00fameros.\n\n- Media.\n\nM\u00e9dia, em geral, \u00e9 referida como a m\u00e9dia aritm\u00e9tica de um conjunto de medidas (amostra de medidas), ou distribui\u00e7\u00e3o de medidas (ou, ainda, popula\u00e7\u00e3o de medidas). \u00c9 calculada somando-se todos os valores e dividindo a quantidade obtida pelo n\u00famero de valores.\n\n**Obs 1**.: quando a distribui\u00e7\u00e3o das medidas \u00e9 normal, usamos a m\u00e9dia. Quando a distribui\u00e7\u00e3o \u00e9 n\u00e3o normal (enviesada), usamos a mediana. H\u00e1 outros tipos de m\u00e9dias, definidas na matem\u00e1tica, mas que s\u00e3o pouco usadas em estat\u00edstica.\n\n- Media Movel Simples (de pre\u00e7os, por exemplo):\n\nA m\u00e9dia m\u00f3vel simples \u00e9 formada por meio do c\u00e1lculo do pre\u00e7o m\u00e9dio de um ativo, ao longo de um determinado n\u00famero de per\u00edodos no tempo. Por exemplo, a m\u00e9dia m\u00f3vel simples de 21 dias (de pre\u00e7os de uma a\u00e7\u00e3o da Bovespa, apenas para exemplificar), seria a soma de 21 dias de pre\u00e7os de fechamento, tomados a partir da data de hoje, dividida por vinte e um. O pr\u00f3ximo ponto da m\u00e9dia m\u00f3vel de 21 dias, seria a soma dos pr\u00f3ximos 21 dias de pre\u00e7os, dividida por vinte e um e assim sucessivamente, \u00e0 medida que os dias fossem passando. \n\nSe fosse calculada a partir valores passados, fixa-se uma data de in\u00edcio e toma-se os valores a partir dela, de 21 em 21 dias e calcula-se as respectivas m\u00e9dias, dia ap\u00f3s dia, at\u00e9 a date de hoje.\n\n**Obs 2**.: uma outra m\u00e9dia m\u00f3vel frequentemente usada \u00e9 a exponencial, cuja defini\u00e7\u00e3o foge ao escopo deste estudo.","cb2b432b":"- Checando o resultado da restri\u00e7\u00e3o do intervalo de datas","17dd8201":"## Vamos usar algo diferente\n\nL\u00e1 no in\u00edcio observamos que o desvio padr\u00e3o dos retornos possu\u00eda uma certa din\u00e2mica. Vamos usar um modelo que possa descrever esta din\u00e2mica do desvio padr\u00e3o. Os modelos da fam\u00edlia GARCH podem fazer isto. \n\nUsaremos a biblioteca [ARCH](https:\/\/arch.readthedocs.io\/en\/latest\/) Toolbox, que d\u00e1 suporte \u00e0s seguintes funcionalidades:\n\n- Modelos univariados de volatilidade (Univariate volatility models);\n- Modelos baseados em Bootstrapping;\n- Procedimentos de m\u00faltipla compara\u00e7\u00e3o (multiple comparison procedures); e\n- Testes de ra\u00edzes unit\u00e1rias (unit root tests). \n","8ddf2658":"- Disponibilizando a biblioteca:","96ca94b0":"- A seguir, a primeira \"fotografia\" do portf\u00f3lio no per\u00edodo estudado.","04566c3c":"## A distribui\u00e7\u00e3o dos retornos $x_t$ deve ser pr\u00f3xima \u00e0 da distribui\u00e7\u00e3o normal (gaussiana)\n- histograma de $x_t$:","159f3441":"- \u00c9 mostrado, a seguir, o c\u00f3gigo Python que disponibiliza as bibliotecas usadas e l\u00ea os dados do portf\u00f3lio.","fcb08f14":"- Em seguida, s\u00e3o substitu\u00eddas as eventuais datas que apresentem pre\u00e7os \"zero\", pela m\u00e9dia de pre\u00e7os dos ativos.","44e53b14":"- Primeiras estat\u00edsticas da base","63dca385":"# Objetivo\n\nO objetivo deste artigo (notebook) \u00e9 compartilhar conhecimentos a respeito de algumas das habilidades necess\u00e1rias \u00e0 an\u00e1lise das S\u00e9ries Temporais (TS), tema extremamente carente de exemplos de aplica\u00e7\u00e3o pr\u00e1tica, sobretudo em L\u00edngua Portuguesa, no que diz respeito ao seu estudo e modelagem.\n\nA modelagem de s\u00e9ries temporais \u00e9 tema de extrema relev\u00e2ncia para o estudo e o entendimento do comportamento de vari\u00e1veis no tempo. Pode ser associada a procedimentos usados em intelig\u00eancia artificial, especialmente os de **deep learning** (redes neurais) e torna a modelagem de s\u00e9ries temporais ainda mais carente de profissionais de **\"data science\"** que dominem ambas as t\u00e9cnicas, de modo poderem utilizar o estado da arte tecnol\u00f3gico, para a interpreta\u00e7\u00e3o da rela\u00e7\u00e3o risco\/retorno de portf\u00f3lios de ativos. ","3e0e2da7":"- a MM21 de $x_t$ varia pouco. A varia\u00e7\u00e3o \u00e9 pr\u00f3xima de zero.\n- o desvio padr\u00e3o de $x_t$ apresenta oscila\u00e7\u00f5es, ou seja, possui uma din\u00e2mica que vale \u00e0 pena ser melhor observada.","daafeed6":"Como os modelos GARCH n\u00e3o fornecem uma fun\u00e7\u00e3o pronta para fazermos predi\u00e7\u00f5es (simula\u00e7\u00f5es preditivas), construiremos uma a seguir:","c4e3595b":"- Checagem de datas an\u00f4malas (feriados nacionais e estaduais, cuja serie AlphaVantage apresentou alguns defeitos)","da1858af":"Obs.: o processo de como os dados dos ativos foram extra\u00eddos para a montagem do portf\u00f3lio aparece ao final desta PARTE 1, no item **ANEXO** deste artigo, em c\u00f3digo Python comentado.","0c86c4ce":"# AN\u00c1LISE DE PORTF\u00d3LIO - PARTE 1.\n# Um estudo de caso usando s\u00e9ries temporais com Python","a5dbc33f":"A seguir, acumulamos os pre\u00e7os dos ativos por data, criando a serie dos totais di\u00e1rios do portfolio em cada datetime. Esta ser\u00e1 a serie cujos retornos ser\u00e3o estudados e predi\u00e7\u00f5es ser\u00e3o realizadas","3f7ab4ca":"## Recuperando a s\u00e9rie original $p_t$","5259a0ea":"## A seguir, observa-se o comportamento do desvio padr\u00e3o dos retornos e a m\u00e9dia m\u00f3vel de 21 per\u00edodos (MM21).","431a55b1":"## Formas alternativas para a observa\u00e7\u00e3o e modelagem de s\u00e9ries temporais\n1. Modelos ARIMA [AutoRegressive Integrated Moving Averages](https:\/\/rae.fgv.br\/rae\/vol29-num2-1989\/modelos-arima-abordagem-box-jenkins-aplicacao-na-previsao-ibovespa-curtissimo-pr).\n2. Modelos GARCH [Generalized AutoRegressive Conditional Heteroskedasticity](http:\/\/www.diva-portal.org\/smash\/get\/diva2:576215\/FULLTEXT02).\n3. Modelos VAR\/Cointegra\u00e7\u00e3o [Vectors AutoRegressive\/CoIntegration](http:\/\/www.eeb.sei.ba.gov.br\/pdf\/2014\/fd\/analise_de_cointegracao.pdf)\n4. [Redes Neurais](https:\/\/www.sciencedirect.com\/science\/article\/pii\/S2212567115016743) aplicadas a s\u00e9ries temporais.\n5. [L\u00f3gica Fuzzi](http:\/\/homepages.dcc.ufmg.br\/~gfrancis\/kdmile\/papers\/wip\/STF_v1.pdf) em s\u00e9ries temporais\n6. KNN [K-nearest neighbor](http:\/\/www.teses.usp.br\/teses\/disponiveis\/55\/55134\/tde-21112016-150659\/pt-br.php) em s\u00e9ries temporais.\n7. SVM [Support Vector Machines](https:\/\/www.marinha.mil.br\/spolm\/sites\/www.marinha.mil.br.spolm\/files\/102161.pdf) em s\u00e9ries temporais e outros...","977b8eb7":"- Inspecionando os 5 \u00faltimos registros da s\u00e9rie","5c13b30d":"A seguir, \u00e9 apresentado o c\u00f3digo Python que implementa o modelo ARMA em sua parte autorregressiva, aplicando-o \u00e0 s\u00e9rie de retornos do portf\u00f3lio. O objetivo \u00e9 o de obter coeficientes $\\mu$, $\\phi$ e $e_t$ adequados para serem usados na equa\u00e7\u00e3o linear apresentada anteriormente.","439a2038":"## Conceitos b\u00e1sicos utilizados\n\n- **S\u00e9rie Temporal**<br>\nUma s\u00e9rie temporal pode ser considerada como um conjunto de dados observados e ordenados segundo algum par\u00e2metro de tempo, \nonde os dados devem apresentar alguma depend\u00eancia serial entre eles, quandos tomados a intervalos de tempo equidistantes (hor\u00e1rios, di\u00e1rio, semanal, mensal,trimestral, anual, etc.).\n\nAs s\u00e9ries temporais s\u00e3o classificadas, segundo sua variabilidade, como **estacion\u00e1rias** e **erg\u00f3digas** (ou n\u00e3o estacion\u00e1rias).\n\n- **S\u00e9ries Temporais Estacion\u00e1rias**<br>\nS\u00e3o aquelas cujos valores observados variam em torno de um determinado valor m\u00e9dio. Suas estat\u00edsticas n\u00e3o s\u00e3o afetadas por varia\u00e7\u00f5es no tempo.\n\n- **S\u00e9rie Temporais n\u00e3o Estacion\u00e1rias, ou Erg\u00f3digas**<br>\nS\u00e3o aquelas que os valores observados variam apresentando alguma tend\u00eancia, seja ela de crescimento ou descrescimento, em torno, ou n\u00e3o, de um valor m\u00e9dio. A maioria das s\u00e9ries do mundo real \u00e9 de natureza n\u00e3o estacion\u00e1ria.\n\nAs s\u00e9ries temporais podem ser, ainda, classificadas como discretas, cont\u00ednuas, determin\u00edsticas, estoc\u00e1sticas, multivariadas e multidimensionais. \n\nSegundo Mendenhall (Mendenhall, 1993) as s\u00e9ries temporais podem ser representadas como a combina\u00e7\u00e3o de quatro componentes \"n\u00e3o observ\u00e1veis\", a seguir:\n\n- componente de tend\u00eancia;\n- componente c\u00edclico;\n- componente sazonal; e\n- componente de erro.","73698df0":"$x_t = \\mu + e_t$ <br>\n<br>\nonde, <br>\n<br>\n$e_t = z_t\\sigma_t$ <br>\n${\\sigma_t}^2 = \\omega + \\alpha_1{e_{t-1}}^2 + \\beta_1{\\sigma_{t-1}}^2$\n\n$z_t$   **~**  $N(O,1)$","5c9d8eb9":"## Olhando os res\u00edduos do modelo","5b0f80d5":"Como o gr\u00e1fico nos mostra a s\u00e9rie de pre\u00e7os do portf\u00f3lio n\u00e3o \u00e9 estacion\u00e1ria. E os modelos estat\u00edsticos foram desenvolvidos e testados para uso com s\u00e9ries estacion\u00e1rias. \n\n- A seguir, tra\u00e7amos a m\u00e9dia m\u00f3vel de 21 per\u00edodos (MM21) do portf\u00f3lio.","8536a72e":"O gr\u00e1fico preditivo nos traz a mensagem de que o valor do portf\u00f3lio tende a crescer (tend\u00eancia de alta) nos pr\u00f3ximos 21 dias (linha vermelha),  mas que pode oscilar entre o valor estimado m\u00ednimo de R\\$415,00 e o m\u00e1ximo de R\\$512,00 (cone de volatilidade em verde).","110bb0fe":"## Descri\u00e7\u00e3o dos pr\u00e9-requisitos, cria\u00e7\u00e3o e abertura do arquivo de portfolio\n\nForam usados pre\u00e7os ajustados, com periodicidade di\u00e1ria (Daily Adjusted) obtidos a partir da API (Application Program Interface) fornecida pelo servi\u00e7o internacional gratuito - AlphaVantage. Outras periodicidades encontram-se dispon\u00edveis, via a mesma API, podendo ser utilizado o mesmo conjunto de bibliotecas para Python.\n\nN\u00e3o tivemos a preocupa\u00e7\u00e3o de aferir a consist\u00eancia dos dados fornecidos. Fisemoas, apenas, o tratamento das eventuais aus\u00eancias de dados e separamos as eventuais anomalias not\u00f3rias (\"outliers\"). O prop\u00f3sito deste artigo \u00e9 educacional e a inten\u00e7\u00e3o foi, t\u00e3o somente, a de ilustrarmos o tema por meio da aplica\u00e7\u00e3o pr\u00e1tica de algumas das mais consagradas t\u00e9cnicas de an\u00e1lise de portf\u00f3lios, mostrando, igualmente, como apenas alguns comandos Python, tornam poss\u00edvel a obten\u00e7\u00e3o de um olhar aprofundado e, ao mesmo tempo de r\u00e1pida e barata obten\u00e7\u00e3o de resultados, mesmo quando s\u00e3o utilizados modelos te\u00f3ricos de razo\u00e1vel complexidade.\n\nO portfolio aqui montado e estudado consiste numa carteira de a\u00e7\u00f5es ordin\u00e1rias nominais (ON), composta de empresas brasileiras que no momento do estudo apresentavam bons fundamentos. Entretanto, como j\u00e1 foi mencionado, **poder\u00edamos estar analisando qualquer outro portfolio de ativos, que possu\u00edsse, pelo menos, 50 pontos com dados observ\u00e1veis, no tempo**.\n\nAo grupo de a\u00e7\u00f5es selecionadas foram inclu\u00eddas as da VALE e da PETROBRAS, pela import\u00e2ncia econ\u00f4mica destas empresas no mercado de capitais brasileiro, bem como pela magnitude do volume burst\u00e1til historicamente movimentado por elas.\n\u00c9 importante observar que **n\u00e3o h\u00e1, neste estudo, qualquer sugest\u00e3o ou recomenda\u00e7\u00e3o de aquisi\u00e7\u00e3o, ou de aliena\u00e7\u00e3o de quaisquer dos ativos mencionados**.\n\nPara o servi\u00e7o AlphaVantage, **PETR3 = PBR e ITUB3 = ITUB**\n\nO portf\u00f3lio foi constru\u00eddo a partir dos seguintes ativos:\n\nABEV3.SA - Cia. de Bebidas das Am\u00e9ricas (Cervejas e Refrigerantes - antiga AMBV3)<br>\nEZTC3.SA - EZ Tec Empreendimentos e Participa\u00e7\u00f5es S.A. (Constru\u00e7\u00e3o e Incorpora\u00e7\u00e3o exclusivamente em S\u00e3o Paulo)<br>\nGRND3.SA - Grendene S.A. (Cal\u00e7ados)<br>\nHGTX3.SA - Cia. Hering S.A. (Vestu\u00e1rio)<br>\nPBR (PETR3) - Petr\u00f3leo Brasileiro S\/A (Petr\u00f3leo e G\u00e1s)<br>\nEGIE3.SA - Engie Brasil Energia S.A. (Energia - antiga Tractebel ou TBLE3)<br>\nVALE3.SA - Vale S.A. (Minera\u00e7\u00e3o)<br>\nCIEL3.SA - Cielo S.A. (Servi\u00e7os Financeiros)<br>\nITUB (ITUB3) - Banco ITAU UNIBANCO<br>\nITSA3.SA - Itausa Investimentos Itau S\/A (Servi\u00e7os Financeiros)<br>\nRADL3.SA - Raia Drogasil S.A. (Farmaceutico)<br>\nPSSA3.SA - Porto Seguro S.A. (Seguros)<br>\nWEGE3.SA - WEG S.A.(Equipamentos Industriais)<br>\nLREN3.SA - Lojas Renner S.A. (Vestu\u00e1rio e Cal\u00e7ados)<br>\nMDIA3.SA - M. Dias Branco S.A. Ind\u00fastria e Com\u00e9rcio de Alimentos (Alimentos Diversos)<br>\n\nA \u00f3tica proposta na observa\u00e7\u00e3o do portf\u00f3lio envolve uma perspectiva de prazo mais longo (m\u00ednimo de cinco anos), equivalente \u00e0 \u00f3tica do investidos \"buy & hold\". S\u00e3o poss\u00edveis, contudo, rec\u00e1lculos a qualquer periodicidade, desde que ela seja di\u00e1ria,  ou mais agregada (p.ex. semanal, mensal ou anual). N\u00e3o foram considerados dados intraday. Portanto, a s\u00e9rie de pre\u00e7os \u00e9 di\u00e1ria e optamos por utilizar apenas a m\u00e9dia m\u00f3veis de 21 dias (equivalente a 30 dias corridos) para simplificar o trabalho. Poderiam ter sido usadas, adicionalmente, outras m\u00e9dias m\u00f3veis.\n\nO investidor que opera \"buy & hold\" procura captar tend\u00eancias de prazo mais longo. Por isto, normalmente prefere a\u00e7\u00f5es do tipo ON (o mesmo tipo de a\u00e7\u00e3o do controlador - com direito a voto) e que possuam garantia de TAG Along de, pelo menos 80%. As a\u00e7\u00f5es escolhidas geralmente possuem boa liquidez e, pelo menos, 25% de free float.","4aa251c1":"- Selecionando os dados no intervalo de observa\u00e7\u00f5es em estudo.","a2257cb4":"## Olhando os res\u00edduos baseados no modelo ARCH usado."}}