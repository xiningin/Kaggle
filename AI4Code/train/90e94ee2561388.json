{"cell_type":{"cb3ab0d3":"code","9cc802d5":"code","1370b8ff":"code","be16b7cc":"code","6b56bfef":"code","1b1d9369":"code","a9ccf752":"code","94d66805":"code","bb51e80b":"code","01a8727e":"code","14f35480":"code","0fb249fa":"code","26e4dd22":"markdown","9da4d196":"markdown","bb703b67":"markdown","b070b4ca":"markdown","1d6445c9":"markdown","c23964eb":"markdown","38aa7489":"markdown","0ed3bfd1":"markdown","506dd037":"markdown","17279372":"markdown","82785a1b":"markdown"},"source":{"cb3ab0d3":"#importing data and checking columns\n\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport numpy as np\n\ndf = pd.read_csv('\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv', usecols=['Gender', 'Age', 'Annual Income (k$)','Spending Score (1-100)'])\ndf.columns = ['Gender', 'Age', 'Income', 'Score']\ndf.head()","9cc802d5":"df.info()","1370b8ff":"df.isnull().sum()","be16b7cc":"df.describe().T","6b56bfef":"plt.figure(figsize=(10,5))\n_= sns.heatmap(df.corr(), annot = True, cmap = 'YlOrBr', fmt='.1g', vmin = -0.5, vmax = 0.5)\nplt.title(\"Correlation between features for customers\", size=15, pad=10)\nplt.show()","1b1d9369":"plt.figure(figsize=(15,5))\ncols = df.select_dtypes(exclude=['object']).columns\n\ncolors = ['red', 'green', 'orange']\n\nfor i, col in enumerate(cols):\n    plt.subplot(1,3, i+1)\n    ax = sns.histplot(data=df, x=col, color = colors[i], bins='fd', kde=True)\n    plt.title('Distribution of {}'.format(col), size=15, pad=10)\n    ax.set_ylabel('N\u00ba of Customers')\n    ax.set(xlabel=None)\n    ax.set(yticklabels=[])\n    \nplt.show()\n\n","a9ccf752":"#Categorizing the Score\n\nbins = [0, 20, 40, 60, 80, 100, np.inf]\nnames = ['Low', 'Low', 'Medium', 'Medium', 'High','High']\npd.set_option('display.max_rows', df.shape[0]+1)\ndf['Score_Category'] = pd.cut(df['Score'], bins, labels=names, ordered=False)\n\n\n\n#showing the number of Customers in each Score Category\nCategory_count = pd.DataFrame(df.value_counts('Score_Category').reset_index())\nCategory_count = Category_count.rename(columns={0: 'N\u00ba of Customers'})\nCategory_count","94d66805":"\n_ = sns.pairplot(df, hue='Score_Category', markers='d')\n_.map_diag(sns.histplot)\n\nplt.show()","bb51e80b":"from sklearn.cluster import KMeans\nfrom sklearn.preprocessing import StandardScaler\n\n#selecting variables and scaling the data\n\nsamples = df[['Age', 'Income', 'Score']]\nscaler = StandardScaler()\nsamples_scaled = scaler.fit_transform(samples)\n\n#applying the elbow method\ninertia = []\nfor i in range(1, 10):\n    km = KMeans(n_clusters=i).fit(samples_scaled)\n    inertia.append(km.inertia_)\n\nsns.lineplot(x=range(1,10), y=inertia)\nplt.title('Elbow method inertia')\nplt.xlabel('K')\nplt.ylabel('Inertia')\nplt.show()\n","01a8727e":"knn = KMeans(n_clusters=4)\nknn.fit(samples_scaled)\nclusters = knn.predict(samples_scaled)\n\ndf['classification'] = clusters","14f35480":"fig, axes = plt.subplots(1,2, figsize=(15,5))\n_ = sns.scatterplot(data = df, x='Age', y='Income', hue='classification',palette='deep', size='Score', sizes=(10,500), alpha=0.5, ax=axes[0])\n_ = sns.scatterplot(data = df, x='Age', y='Score', hue='classification',palette='deep', size='Income', sizes=(10,500), alpha=0.5, ax=axes[1])","0fb249fa":"fig, axes = plt.subplots(1,3, figsize=(15,5))\n_ = sns.boxplot(data = df, x='classification', y='Income',palette='deep',ax=axes[0])\n_ = sns.boxplot(data = df, x='classification', y='Score',palette='deep',ax=axes[1])\n_ = sns.boxplot(data = df, x='classification', y='Age',palette='deep',ax=axes[2])","26e4dd22":"We can have some thoughts about where the clusters are with both scatterplots, we can see that one group has a good balance between Income and Score as another group have score below the average but the income is higher than 80K in its average.\n\nA boxplot with the label may give more usefull insights.","9da4d196":"## EDA with the classification labels\n\nTo check where are our clusters based on Income and Score related to the age, we have two scatter plots. \n\nThe first one is Age versus Income, with score as size and the second one is Age versus Score with Income as the size. \n\n","bb703b67":"# It does not seem we have any issue with data types and null values\n\nNow let's move to statistics","b070b4ca":"# What the EDA tells us about customers:\n\n### Correlation:\n\nIt does not look we have a strong correlation between any feature. \n\nAlthough income and score does have a positive correlation,\nas it is not strong we could guess that most of people can keep their score high \nindependent of the amount of their income.\n\nThis would not be a problem if their income are sufficient enough to keep the score relevant, \n\n### Distribution:\n\nAge and Income are positive skewed. \n\nMost of customers have a Score between 40 and 60.\n\n\n### Pairplot: \n\nScore and income have natural clusters: \n\nThe cluster with most customers have average income and average score.\nWe also have customers with high income and low score that could be the target as they could be easy to converge\n. \nWe also have a group with low income and low score, low income and high score and high income and high score.\n\n\n### Conclusions before clustering\n\n\nWe checked that we cannot rely only on the score feature to plan a marketing strategy, because it does not have a strong positive correlation to the income, which means that customers can keep their score high independent of their income, thus their score may not be sustainable and the conversion rate could not be satisfying for this group if for example people with high score have debt to be payed. \n\nAlthough income seems to be the easy feature that the marketing team can converge, the low proportion of customers with high income (above 80k) makes the return of the investment of a plan targeting people with high income not attractive. \n\nIt's worth to target target people between 30 and 50 years old rather than if they targeted customers with high income just because of the proportion of customers from the latter. \n\nAs most of customers are between the age of 30 and 50 and they have an income that can keep their score sustainable i would recommend, only seeing the EDA, to target this group.\n\n\n","1d6445c9":"# Conclusions from clustering and advice for the marketing team.\n\nIn terms of target groups, i would recommend targeting the group with income above 80k, We have two groups in this situation. One of them has a high score as the other one has the lowest score, which can indicate some potential to conversion. The age of both groups are between 30 and 47 years old.\n\nThe other two groups have Incomes below the average income although the Score of one of them is the second highest. I would not recommend  them as a target because their score does not seem to be sustainable so a marketing strategy targeting groups with this characteristics would not have room to convert customers. The age of one group is below 30 years old and the age of the second group is above 50 years old.\n\nIf we desire, we could push it further and label each group as high priority,medium priority and low priority. We can customize advertisement for each group and predict the label for new customers so each group would receive customized advertises and new customers would get customized ads as their predicted label.\n\n\n## After the analysis, some final thoughts about the data.\n\n\nThe Score metric seems like an egagement metric. It would be helpful to know how it was thought. \n\nIncreasing the average score seems like a goal for the marketing team, and the Kmeans clusters may be helpful with insights for target groups.\n\nWith this in mind, i would advice to gather more data about customer behavior to add to demographic variables.\n\nSo as a plus to the clusterization, a ML model to predict the score based on customer behavior data may also be helpful to increase the average score of customers.\n\n# if you have come to the end, thank you. Hope it was helpful. If you have any feedback please feel free to comment :) if you wish to support my work please leave a upvote. I appreciate it!\n\n","c23964eb":"# Pairplot to find first patterns\n\nBefore the plot i will categorize the Score so we can add the view of patters by score category.\n\n* Low: Score below 40\n* Medium: Score between 41 and 80\n* High:  Score above 81","38aa7489":"## Distribution of the features","0ed3bfd1":"## Correlation between the features","506dd037":"## Finding patters with Kmeans Clustering\n\n\nsteps:\n\n* Scaling the data with StandardScaler\n\n* Fitting the scaled data\n\n* Finding out optimal number of clusters with the elbow method.\n\n* Assigning the cluster column in the data as Classification to check what we can find out based on our cluster labels about the customers.\n","17279372":"\n\n\n# Introduction:\n\n\nLet's start the introduction stating the business problem we need to solve:\n> ##### You own the mall and want to understand the customers like who can be easily converge Target Customers so that the sense can be given to marketing team and plan the strategy accordingly.\n> \n\nSo we want to tell the marketing team which group of customers that can be easily converge so they can plan the strategy to the selected group. \n\n### **The data we have:**\n\n* **CustomerID:** Unique ID assigned to the customer\n* **Gender:** Gender of the customer (Male - Female)\n* **Age:** Age of the Customer\n* **Annual Income:**  Annual Income of the Customer\n* **Spending Score:** Score assigned by the mall on customer behavior and spending nature\n\n\n\n\n\n\nSo the EDA will try to understand the Spending Score, their age and their income.\n\nScore is based on customer behavior, so i would assume that income is not counted for the score. \n\nCustomers with high score might be already engaged with spending in the mall, and they may keep spending with an income below the average of the customers for example using credit cards.\n\nWith this in mind, let's move to the Exploratory Data Analysis\n\n\n","82785a1b":"## Exploratory Data Analysis\n\n### **Steps:**\n* Checking data types and null values\n* Basic stastistics of the features\n* Heatmap to show any strong correlation between features\n* Distribution of the features\n* Pairplot to find patterns"}}