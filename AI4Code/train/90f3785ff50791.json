{"cell_type":{"040cbdd8":"code","99819a1f":"code","f1d930c9":"code","1e1a6643":"code","0c2a86e1":"code","71b35b1c":"code","68c6fbdb":"code","5497f2d2":"code","3eac528d":"code","1e0fcb73":"code","82104784":"code","94bf471a":"code","208fb73e":"code","0f766106":"code","579cd29e":"code","42bdbe76":"code","295e1650":"code","6ad4c687":"code","c517ec83":"code","72407fa0":"code","ba7127a0":"code","5c32d153":"code","7abb5fb7":"code","dfcc450e":"code","0676b1d2":"code","9a761262":"code","80020ded":"code","919e46b9":"code","c43fa3a4":"code","901cfc71":"code","c72bee59":"code","c2377136":"code","5dec29a9":"code","01864829":"code","e321a8ce":"markdown","f8cde324":"markdown","9bfa534f":"markdown","2122e08e":"markdown","78dffc83":"markdown","3d5ee050":"markdown","5f9153d4":"markdown","0b44c5b6":"markdown","9d69b8e0":"markdown","5dcc37f8":"markdown","90cf9993":"markdown","d64cd2a7":"markdown","2a538115":"markdown","6a5bd18d":"markdown","67845b0d":"markdown","658634cc":"markdown","b0604809":"markdown","f0d35445":"markdown","394c3fd3":"markdown","3126cf2e":"markdown","c8eaf0c8":"markdown","f55bd35b":"markdown","00fcaecc":"markdown"},"source":{"040cbdd8":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport plotly.express as ex\nimport plotly.figure_factory as ff\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","99819a1f":"import matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style('darkgrid')","f1d930c9":"s_data = pd.read_csv('\/kaggle\/input\/all-space-missions-from-1957\/Space_Corrected.csv')\ns_data = s_data[s_data.columns[2:]].copy()\ns_data.head(3)","1e1a6643":"s_data['Datum'] = pd.to_datetime(s_data['Datum'])\n","0c2a86e1":"rockes_status_dict = {'StatusRetired':1,'StatusActive':2}\nstatus_mission_dict = {'Prelaunch Failure':1,'Partial Failure':3,'Failure':2,'Success':4}\n\ns_data['Status Rocket'].replace(rockes_status_dict,inplace=True)\ns_data['Status Mission'].replace(status_mission_dict,inplace=True)\n","71b35b1c":"#creating the day of launch\ns_data['LaunchDay'] = s_data['Datum'].apply(lambda x: x.weekday())\n#creating the hour of launch\ns_data['LaunchTime'] = s_data['Datum'].apply(lambda x: x.hour)\n#creating the year of launch\ns_data['LaunchYear'] = s_data['Datum'].apply(lambda x: x.year)\n#creating the month of launch\ns_data['LaunchMonth'] = s_data['Datum'].apply(lambda x: x.month)\n\n","68c6fbdb":"s_data['Country'] = s_data['Location'].apply(lambda x: x.split(',')[-1])\ns_data = s_data[s_data['Country'].isin(s_data['Country'].value_counts().index[:17])]","5497f2d2":"s_data","3eac528d":"#extract data with no missing values in the rocket price data\ns_data_n = s_data[~s_data[' Rocket'].isna()].copy()\ns_data_n[' Rocket'] = s_data_n[' Rocket'].replace('5,000.0 ',500)\ns_data_n[' Rocket'] = s_data_n[' Rocket'].replace('1,160.0 ',116)\ns_data[' Rocket'] = s_data[' Rocket'].replace('5,000.0 ',500)\ns_data[' Rocket'] = s_data[' Rocket'].replace('1,160.0 ',116)\n\ns_data_n[' Rocket'] = s_data_n[' Rocket'].astype('float64')\ns_data[' Rocket'] = s_data[' Rocket'].astype('float64')\n\ns_data_n","1e0fcb73":"plt.figure(figsize=(20,11))\nax = sns.countplot(s_data['Company Name'],order=s_data['Company Name'].value_counts().index)\nax.set_xticklabels(ax.get_xticklabels(),rotation=90,fontsize=15)\nax.set_xlabel(ax.get_xlabel(),fontsize=16)\nax.set_ylabel(ax.get_ylabel(),fontsize=16)\nax.set_title('Distribution Of Different Companies And Amount Of Space Mission Laucned By Them',fontsize=17)\nplt.show()","82104784":"fig = ff.create_distplot([s_data[' Rocket']],['Rocket'],curve_type='kde',bin_size=50)\nfig.update_layout(title='Distribution Of Different Rocket Prices',height=900)\nfig.show()\n","94bf471a":"fig = ff.create_distplot([s_data['LaunchTime']],['LaunchTime'],curve_type='kde',bin_size=2)\nfig.update_layout(title='distribution Of Different Space Mission Launch Times',height=900)\nfig.show()\n","208fb73e":"plt.figure(figsize=(20,11))\nax = sns.countplot(s_data['LaunchDay'],palette='mako')\n#ax.set_xticklabels(ax.get_xticklabels(),rotation=90,fontsize=15)\n#ax.set_xlabel(ax.get_xlabel(),fontsize=16)\n#ax.set_ylabel(ax.get_ylabel(),fontsize=16)\nax.set_title('Distribution Of Different Space Mission Launch Days Of Week',fontsize=17)\nax.patches[2].set_fc('r')\nplt.show()","0f766106":"plt.figure(figsize=(20,11))\nax = sns.countplot(s_data['LaunchMonth'],palette='mako')\n#ax.set_xticklabels(ax.get_xticklabels(),rotation=90,fontsize=15)\n#ax.set_xlabel(ax.get_xlabel(),fontsize=16)\n#ax.set_ylabel(ax.get_ylabel(),fontsize=16)\nax.set_title('Distribution Of Different Space Mission Launch Months',fontsize=17)\nax.patches[5].set_fc('r')\nax.patches[11].set_fc('r')\nplt.show()","579cd29e":"plt.figure(figsize=(20,11))\nax = sns.countplot(s_data['Country'],palette='mako',order=s_data['Country'].value_counts().index)\n#ax.set_xticklabels(ax.get_xticklabels(),rotation=90,fontsize=15)\n#ax.set_xlabel(ax.get_xlabel(),fontsize=16)\n#ax.set_ylabel(ax.get_ylabel(),fontsize=16)\nax.set_title('Distribution Of Different Space Mission Launch Country',fontsize=17)\nax.patches[0].set_fc('r')\nax.patches[1].set_fc((0.6,0,0))\nplt.show()","42bdbe76":"plt.figure(figsize=(20,11))\nax = sns.countplot(s_data['Country'],palette='mako',order=s_data['Country'].value_counts().index,hue=s_data['Status Mission'])\nax.set_xticklabels(ax.get_xticklabels(),rotation=90,fontsize=15)\n#ax.set_xlabel(ax.get_xlabel(),fontsize=16)\n#ax.set_ylabel(ax.get_ylabel(),fontsize=16)\nax.set_title('Distribution Of Different Space Mission Statuses',fontsize=17)\nplt.legend(labels=status_mission_dict.keys(),loc=1,prop={'size':20})\nplt.show()","295e1650":"plt.figure(figsize=(20,11))\nax = sns.countplot(s_data[s_data['Status Mission'] == 2]['Country'],palette='mako')\nax.set_xticklabels(ax.get_xticklabels(),rotation=90,fontsize=15)\n#ax.set_xlabel(ax.get_xlabel(),fontsize=16)\n#ax.set_ylabel(ax.get_ylabel(),fontsize=16)\nax.set_title('Distribution Of Failed Space Launches In Different Countries',fontsize=17)\n#plt.legend(labels=status_mission_dict.keys(),loc=1,prop={'size':20})\nplt.show()","6ad4c687":"plt.figure(figsize=(20,11))\nax = sns.countplot(s_data['LaunchYear'],palette='mako',hue=s_data['Status Mission'])\nax.set_xticklabels(ax.get_xticklabels(),rotation=90,fontsize=15)\n#ax.set_xlabel(ax.get_xlabel(),fontsize=16)\n#ax.set_ylabel(ax.get_ylabel(),fontsize=16)\nax.set_title('Distribution Of Different Space Mission Statuses',fontsize=17)\nplt.legend(labels=status_mission_dict.keys(),loc=1,prop={'size':20})\nplt.show()","c517ec83":"from wordcloud import WordCloud, STOPWORDS \nstopwords = set(STOPWORDS)\ncomment_words = '' \nfor val in s_data.Detail: \n    val = str(val) \n    tokens = val.split() \n    for i in range(len(tokens)): \n        tokens[i] = tokens[i].lower() \n    comment_words += \" \".join(tokens)+\" \"\ncomment_words = set(comment_words.split())\ncomment_words = \" \".join(comment_words)\nwordcloud = WordCloud(width = 800, height = 800, \n                background_color ='black', \n                stopwords = stopwords, \n                min_font_size = 10).generate(comment_words) \n  \n# plot the WordCloud image                        \nplt.figure(figsize = (20, 11), facecolor = None) \nplt.imshow(wordcloud) \nplt.axis(\"off\") \nplt.tight_layout(pad = 0) \n  \nplt.show() ","72407fa0":"sn_cor = s_data_n.corr()\nplt.figure(figsize=(20,11))\nax = sns.heatmap(sn_cor,annot=True,cmap='mako')\nax.set_title('Correlation Between Features Where Rocket Price Is Not Missing',fontsize=19)\nplt.show()","ba7127a0":"sn_cor = s_data.corr()\nplt.figure(figsize=(20,11))\nax = sns.heatmap(sn_cor,annot=True,cmap='mako')\nax.set_title('Correlation Between Features Where Rocket Price Is Missing',fontsize=19)\nplt.show()","5c32d153":"from sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split,cross_val_score\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.linear_model import LinearRegression\nfrom xgboost import XGBRegressor","7abb5fb7":"X = s_data_n[['Status Rocket','LaunchYear']]\ny = s_data_n[' Rocket']\ntrain_x,test_x,train_y,test_y = train_test_split(X,y)\n# Linear Regression\nlr_pipe = Pipeline(steps=[('Scale',StandardScaler()),('model',LinearRegression())])\nlr_pipe.fit(train_x,train_y)\ns = np.sqrt(-1*cross_val_score(lr_pipe,X,y,cv=5,scoring='neg_mean_squared_error'))\nprint(\"LinearRegression Mean RMSE Score Across 5 Folds = \",s.mean())","dfcc450e":"xgb_pipe = Pipeline(steps=[('Scale',StandardScaler()),('model',XGBRegressor(n_estimators=500,learning_rate=0.03))])\nxgb_pipe.fit(train_x,train_y)\ns = np.sqrt(-1*cross_val_score(xgb_pipe,X,y,cv=5,scoring='neg_mean_squared_error'))\nprint(\"XGB Mean RMSE Score Across 5 Folds = \",s.mean())","0676b1d2":"xgb_model = XGBRegressor(n_estimators=1000,learning_rate=0.05)\nxgb_model.fit(train_x,train_y,eval_set=[(test_x[0:20],test_y[0:20])],early_stopping_rounds=5,verbose=False)\nxgb_predict = xgb_model.predict(test_x)\nxgb_score = mean_squared_error(xgb_predict,test_y)\nxgb_score","9a761262":"print(\"XGB Mean RMSE After Parameter Tuning = \",np.sqrt(xgb_score))","80020ded":"Xm = s_data[s_data[' Rocket'].isna()][['Status Rocket','LaunchYear']]\nxgb_predict = xgb_model.predict(Xm)\nmissing_index = s_data[s_data[' Rocket'].isna()][' Rocket'].index.to_list()\ns_data.loc[missing_index,' Rocket'] = xgb_predict","919e46b9":"plt.figure(figsize=(20,11))\nax = sns.distplot(s_data[' Rocket'])\n#ax.set_xticklabels(ax.get_xticklabels(),rotation=90,fontsize=15)\n#ax.set_xlabel(ax.get_xlabel(),fontsize=16)\n#ax.set_ylabel(ax.get_ylabel(),fontsize=16)\nax.set_title('Distribution Of Different Rocket Prices After Predicting Missing Values',fontsize=17)\nplt.show()","c43fa3a4":"from sklearn.ensemble import RandomForestClassifier,AdaBoostClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import classification_report","901cfc71":"X = s_data_n[[' Rocket','LaunchYear']]\ny = s_data_n['Status Rocket']\ntrain_x,test_x,train_y,test_y = train_test_split(X,y)\n","c72bee59":"ada_pipe = Pipeline(steps=[('scale',StandardScaler()),('model',AdaBoostClassifier(learning_rate=0.3,random_state=42))])\nada_pipe.fit(train_x,train_y)\nada_pipe.score(test_x,test_y)\n\nprint(classification_report(ada_pipe.predict(test_x),test_y))","c2377136":"RF_pipe = Pipeline(steps=[('scale',StandardScaler()),('model',RandomForestClassifier(n_estimators=100,random_state=42))])\nRF_pipe.fit(train_x,train_y)\nRF_pipe.score(test_x,test_y)\nprint(classification_report(RF_pipe.predict(test_x),test_y))","5dec29a9":"DT_pipe = Pipeline(steps=[('scale',StandardScaler()),('model',DecisionTreeClassifier(max_leaf_nodes=5))])\nDT_pipe.fit(train_x,train_y)\nDT_pipe.score(test_x,test_y)\nprint(classification_report(DT_pipe.predict(test_x),test_y))","01864829":"s_data.to_csv('Data_With_Predicted_Rocket_Prices_For_Missing Values.csv',index=False)\n","e321a8ce":"### Feature Correlations","f8cde324":"# EDA","9bfa534f":"# Model Selection And Evaluation","2122e08e":"### Most space missions were launched in around 2:30 am or between 20pm and 22pm or around 10 am as can be observed by the trimodal distribution above","78dffc83":"# Preprocessing","3d5ee050":"### When looking in the whole data including the missing price values we see that it confirms the correlation we saw in the smaller sample of this population in the perivous heatmap shown above","5f9153d4":"### The Usa have the height amount of Failed on launch missions.","0b44c5b6":"### We can see that RVSN USSR has the heighest count of space missions followed by Arianespace and General Dynamics","9d69b8e0":"### Lets See if a diffrent model can lower the RMSE of the linear regression ","5dcc37f8":"### So we see we have somthing of a bimodal distribution where most of the rocket prices range between a couple of milions of dollars to 100 and the second group is between 400 and 500 million. we can use this to estimate the average prices and predict all the missing prices in our data.","90cf9993":"### Colored in red we see that most mission are launched midweek where most of the mission were launched on Tuesday","d64cd2a7":"### Most of the space mission launched in most of the countries are successful where the USA has the heighest number of Partial Failures ","2a538115":"### We see that most of the models tested provide accuracy scores between 0.80 and 0.90 which is less likely to be a result of overfitting ","6a5bd18d":"## Predicting Rocket Price","67845b0d":"# Feature Engineering","658634cc":"### Most common words in rocket model names","b0604809":"# Introduction\n\n![](https:\/\/iotway.io\/images\/blog\/starlink\/header.png)\n\nHello to all my fellow kagglers, before diving into the kernel and starting working in the data lets first define some goals and question we would like to answer.\n\n### Our Modeling And Prediction Goals\n1) Predicting The Status Of A Mission\n\n2) Predicting The Cost Of A Rockets Price\n\n### Question We Will Try To Answer\n1) Are there any patterns in the timeseries data and the mission status, meaning is there an hour\/day\/month\/year in which mission were\/are more successful?\n\n2) Are there any patterns in the location of launch , is there a continent or country in which mission are usually more likley to succeed?  \n\n3) Which company makes the cheapest\/most expensive rockets\n\nNow that we defind our objectives we can start looking into our data","f0d35445":"### A space mission is most likely to be launched in June of in December according to our data meaning once every 6 months.","394c3fd3":"### Apparently we see that we have fair correlation between the rocket price and the status of the rocket as well as between the launch year and the status  and the launch year and the rocket price. this is a key insight for us in order to predict the rocekt price. ","3126cf2e":"### So we maneged to create a model that will predict a rocket price with an RMSE of 106 in average ,lets predict all the missing values in our data and take a look at what we got","c8eaf0c8":"### It is clear that in the early years meaning 1960-1976 there where more launches and of those there was a heigher precentage of Partial Failures in in comparison to the late 2000's where we have a hiegher success rate in mission launching and a lower rate of partial failures! ","f55bd35b":"## Predicting Rocket Status Using The Launch Year And The Rockets Price","00fcaecc":"### The majority of space mission were launched from Russia Or the USA"}}