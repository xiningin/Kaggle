{"cell_type":{"1498611d":"code","58bb10ee":"code","3c726486":"code","ce2119d0":"code","11c112cb":"code","cda80ef7":"code","73bd146d":"code","970ae654":"code","bf83c7f6":"code","70ba0475":"code","8bd44489":"code","57143a75":"code","855bf182":"code","28f3163f":"code","5fdefd90":"code","1ffc7ad1":"code","65987f87":"code","fbf3e1ef":"code","09894b26":"code","3eb232c3":"code","4a9f6bfd":"code","a4ab3ff5":"code","9f9820ae":"code","d3082590":"code","2ce81bf5":"code","b854b30a":"code","b69223a7":"code","28838e75":"code","64cdf7cf":"code","3a353504":"code","5a6c4cf6":"code","279c37b1":"code","70231344":"code","a6a8a74d":"code","55d1ce81":"code","eb55d70f":"markdown"},"source":{"1498611d":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport statsmodels.api as sm\nimport statsmodels.formula.api as smf\nimport scipy.stats as st\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.discriminant_analysis import LinearDiscriminantAnalysis, QuadraticDiscriminantAnalysis\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.linear_model import LogisticRegression","58bb10ee":"df=pd.read_csv('..\/input\/coronary-arterydisease\/hd_c.csv')\n","3c726486":"df.columns","ce2119d0":"df.index","11c112cb":"df.shape","cda80ef7":"np.sum(df.isna())","73bd146d":"df.head()","970ae654":"df.describe()","bf83c7f6":"df['sex']=pd.get_dummies(df['sex'])\ndf['chest_pain']=pd.get_dummies(df['chest_pain'])\ndf['blood.sugar']=pd.get_dummies(df['blood.sugar'])\ndf['rest.ecg']=pd.get_dummies(df['rest.ecg'])\ndf['exang']=pd.get_dummies(df['exang'])\ndf['ST.slope']=pd.get_dummies(df['ST.slope'])","70ba0475":"df.head()","8bd44489":"df['y'].value_counts()\n","57143a75":"df['y'].value_counts()","855bf182":"import seaborn as sns\nsns.kdeplot(df['age'],color='y')\nplt.axvline(35,color='r')\nplt.axvline(65,color='g')","28f3163f":"df.columns","5fdefd90":"df.sex.value_counts()","1ffc7ad1":"plt.pie(df['sex'].value_counts(),labels=['fmale','male']);\n","65987f87":"cp=df['chest_pain'].value_counts()\nst = df['ST.slope'].value_counts()\nst","fbf3e1ef":"sns.categorical.barplot(df['chest_pain'],df['ST.slope'])","09894b26":"df['chest_pain'].value_counts()","3eb232c3":"df2 = df.groupby(df['chest_pain']).count().unstack()\ndf2.head()","4a9f6bfd":"df['ST.slope'].value_counts()","a4ab3ff5":"sns.kdeplot(df['systolic..num.'])\nplt.axvline(np.mean(df['systolic..num.']),color='red')","9f9820ae":"sns.kdeplot(df['cholestrol.num.'])\n\nplt.axvline(np.mean(df['cholestrol.num.']),color='red');","d3082590":"df['blood.sugar'].value_counts()","2ce81bf5":"df['rest.ecg'].value_counts()","b854b30a":"df['exang'].value_counts()","b69223a7":"pd.get_dummies(df)","28838e75":"df.rename(columns ={'ST.depression..num.':'st','blood.sugar':'blood','rest.ecg':'rest','systolic..num.':'sys', 'cholestrol.num.':'col','ST.slope':'slope' ,'thalium.hr.num.':'thal'},inplace=True)\ndf.columns","64cdf7cf":"# fullmodel =smf.glm(formula='y~ age+sex+chest_pain+sys+col+blood+rest+thal+exang+st+slope',family=sm.families.Binomial(),data=df).fit()\n# fullmodel.summary()\nfullmodel =smf.glm(formula='y~ age+sex+chest_pain+sys+col+blood+rest+thal+exang+st+slope',data=df).fit()\nfullmodel.summary()","3a353504":"df.head()","5a6c4cf6":"X =df.loc[:,['age', 'sex', 'chest_pain', 'sys', 'col', 'blood', 'rest', 'thal','exang', 'st', 'slope']]\ny=df['y']\n","279c37b1":"X_train,X_test,y_train,y_test =train_test_split(X,y,test_size = 0.2)","70231344":"lda=LinearDiscriminantAnalysis()\nqda =QuadraticDiscriminantAnalysis()\ngnb = GaussianNB()\nlr = LogisticRegression(penalty='none',solver = 'newton-cg')\n\nlda.fit(X_train,y_train)\nqda.fit(X_train,y_train)\ngnb.fit(X_train,y_train)\nlr.fit(X_train,y_train)","a6a8a74d":"\nprint('LDA score    : ',lda.score(X_test,y_test))\nprint('QDA score    : ',qda.score(X_test,y_test))\nprint('NBayes score : ',gnb.score(X_test,y_test))\nprint('LogesticR    : ',lr.score(X_test,y_test))","55d1ce81":"print('LDA:\\n\\n',confusion_matrix(y_test,lda.predict(X_test)))\nprint('QDA:\\n\\n',confusion_matrix(y_test,qda.predict(X_test)))\nprint('\\nNBayes Confusion Matrix: \\n \\n ',confusion_matrix(y_test,gnb.predict(X_test)))\nprint('\\nLogesticR confusion Matrix: \\n \\n',confusion_matrix(y_test,lr.predict(X_test)))","eb55d70f":"# EDA"}}