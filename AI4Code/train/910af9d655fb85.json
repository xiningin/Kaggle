{"cell_type":{"3d189b82":"code","c1df8728":"code","69df6a89":"code","b739767f":"code","4f7d5a78":"code","ee0d91de":"code","3614e969":"code","7f2aaace":"code","172dfa42":"code","62389391":"code","8cd869ae":"code","368dd519":"code","bbcb5066":"code","a67d6b84":"code","b11c5ab3":"code","9ea0adf0":"code","1f8b3731":"code","81f9c13d":"code","5497f306":"code","626f487f":"code","97634c0a":"code","3ebdf2ff":"code","3dec0c5c":"code","c3119df8":"code","0551d597":"code","d010bcf2":"markdown","06daff6a":"markdown","7006214b":"markdown","194d8b0c":"markdown","a80d2a5f":"markdown","835f829e":"markdown","1e6db816":"markdown","097e14e1":"markdown","a7778d30":"markdown","126a8490":"markdown","f4072205":"markdown","5f71d1d4":"markdown","f6142aa1":"markdown","dd524c21":"markdown","aa1188ae":"markdown","82928666":"markdown","7350a33c":"markdown","17a628ad":"markdown","4e51ad2a":"markdown"},"source":{"3d189b82":"#importing the libraries\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport seaborn as sns\nfrom sklearn.metrics import mean_squared_error, r2_score\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression","c1df8728":"#getting the data\ndf = pd.read_csv(\"..\/input\/startup-logistic-regression\/50_Startups.csv\")","69df6a89":"#show the first five elements of the dataframe\ndf.head()","b739767f":"#segregation of numerical columns and categorical columns\n\ncat_col = df.select_dtypes(include=['object']).columns\nnum_col = df.select_dtypes(exclude=['object']).columns\ndf_cat = df[cat_col]\ndf_num = df[num_col]","4f7d5a78":"#Informations about the dataframe\ndf.info()","ee0d91de":"#analyzing if there is null values\ndf_null = df.isna().mean()\ndf_null.sort_values(ascending = False)","3614e969":"df.dtypes","7f2aaace":"outliers = ['Profit']\nplt.rcParams['figure.figsize'] = [8,8]\nsns.boxplot(data=df[outliers], orient=\"v\", palette=\"Set1\" ,whis=1.5,saturation=1, width=0.7)\nplt.title(\"Outliers Variable Distribution\", fontsize = 14, fontweight = 'bold')\nplt.ylabel(\"Profit Range\", fontweight = 'bold')\nplt.xlabel(\"Continuous Variable\", fontweight = 'bold')\ndf.shape","172dfa42":"#checking for duplicates\n\ndf.loc[df.duplicated()]","62389391":"#Visualizing the diferent startup locations\nplt.rcParams['figure.figsize'] = [5,5]\nax=df['State'].value_counts().plot(kind='bar',stacked=True, colormap = 'Set1', color= \"green\")\nax.title.set_text('State Locations')\nplt.xlabel(\"Names of the States\",fontweight = 'bold')\nplt.ylabel(\"Count of States\",fontweight = 'bold')","8cd869ae":"plt.figure(figsize=(8,8))\n\nplt.title('Startup Profit Distribution Plot')\nsns.distplot(df['Profit'])","368dd519":"ax = sns.pairplot(df[num_col])","bbcb5066":"plt.figure(figsize = (8, 8))\nsns.heatmap(df.corr(), cmap=\"RdYlGn\")\nplt.show()","a67d6b84":"plt.figure(figsize=(8, 8))\nsns.boxplot(x = 'State', y = 'Profit', data = df)\nplt.show()","b11c5ab3":"#Separating the dependent and independent values\nX = df.iloc[:, :-1].values\ny = df.iloc[:, -1].values","9ea0adf0":"#transforming the categorical value\nct = ColumnTransformer(transformers = [(\"enconder\", OneHotEncoder(), [3])],\n                       remainder = \"passthrough\")\nX = np.array(ct.fit_transform(X))","1f8b3731":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2)","81f9c13d":"regressor = LinearRegression()\nregressor.fit(X_train, y_train)","5497f306":"y_pred = regressor.predict(X_test)\nnp.set_printoptions(precision = 2)\nprint(np.concatenate((y_pred.reshape(len(y_pred), 1), y_test.reshape(len(y_test), 1)), 1))","626f487f":"r2_score(y_pred, y_test)","97634c0a":"print(\"R2 value is \" + str(r2_score(y_pred, y_test)))\nprint(\"The Mean Squared Error is \" + str(mean_squared_error(y_test, y_pred)))","3ebdf2ff":"# getting the coeficients of the model\nregressor.coef_","3dec0c5c":"#getting the constant of the model\nregressor.intercept_","c3119df8":"#Visualizing once again the independent variables\nX[:5, :]","0551d597":"#Visualizing once again the dataset\ndf.head()","d010bcf2":"Just by looking, seems that the values (the predicted values and the real values) are very close to each other.","06daff6a":"The R2 score is 0,967 which represents an accuracy of the linear regression of 96,7%. This is a very good model to predict future values of profits in Startups.","7006214b":"### Section 3 - Getting the Model","194d8b0c":"We can notice that the R2 value of 0,967 is an awesome number to predict in which startup a venture fund should invest.\nSome things is interesting to notice:\n* The Research & Development spend is proportional to the profit. So is good to invest in firms or companies that have a policy in invest a good part of its profit in Research and Development;\n* The Marketing spend is also proportional to the profit (however not in the same level of Reserach & Development spend). This could happen because the clients know better the portfolio and\/or quality of the firm. Also, the Marketing is responsible to show the Startup to the world.\n* The Administration spend has no correlation with the profit. So a good thing the Startups should do is decrease the spend is this sector.\n","a80d2a5f":"Insights:\n* All outliers presented are in the state of New York. \n* The startups located in the state of California have a greater range between the minimum and the maximum profit.","835f829e":"As can be noticed, there aren't null values in the dataset so it won't be necessary a preprocessing to take care about it.","1e6db816":"Creating a label to show the equations:\n\n$ x_{1} $ = R&D Spend\n\n$ x_{2} $ = Administration Spend\n\n$ x_{3} $ = Marketing Spend\n\n$ d_{1} $ = Boolean variable to represent if the startup is in the state of California or not\n\n$ d_{2} $ = Boolean variable to represent if the startup is in the state of Florida or not\n\n$ d_{3} $ = Boolean variable to represent if the startup is in the state of New York or not\n\n$y$ = Profit\n\n\nSo, the equation is:\n\n$y = 0,813x_{1} - 0,0161x_{2} + 0,0247x_{3} - 526d_{1} - 28d_{2} + 555d_{3}$","097e14e1":"Once again it is not necessary to make any preprocess because the dataset does not have any repeated values.","a7778d30":"### Section 1 - Data Analysis and Insights","126a8490":"### Section 4 - Conclusions","f4072205":"The objective of this problem is to build a model to predict which Startups could give the best investment return. This could be useful to venture funds know in what firm (startup) invest.","5f71d1d4":"# **Predicting values with Multiple Linear Regression**","f6142aa1":"The heatmap of correlations seems to confirm the same things shown in the previous graphics.","dd524c21":"Insights:\n* The distribution of profit of the startups are very similar to a Gaussian. In other words, the average profit (which is 100k) is the most frequent.","aa1188ae":"### Section 2 - Getting the training set and the test set","82928666":"Insights:\n* As expected by intuition, the more you invest in Research and Development,greater your profit.\n* The marketing spend seems to be proportional with the profit. The reason could be that the more clients knowing the product (or service) of the startup, greater the revenue.\n* The administration spend seems to have no relation with the profit.","7350a33c":"This problem resolution is going to be organized in the following sections:\n* **Section 1** - Data Analysis and Insights\n* **Section 2** - Getting the training set and the test set\n* **Section 3** - Getting the model\n* **Section 4** - Conclusions about the model","17a628ad":"Insight:\n* The locations of the startups are very balanced","4e51ad2a":"It is noticed that there is an outlier in the profit. However, it won't be removed in sake of the amount of data that is few (just 50 entries)"}}