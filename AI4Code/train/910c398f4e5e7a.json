{"cell_type":{"a1996d93":"code","ba41af31":"code","58558b21":"code","9361f381":"code","1518ee13":"code","226973db":"code","36d381ab":"code","fe2dbf4c":"code","391d8c9b":"code","95acee46":"markdown"},"source":{"a1996d93":"import os\nos.chdir('\/kaggle\/input\/red-wine-quality-cortez-et-al-2009\/')\nprint(os.getcwd())","ba41af31":"import numpy as np\nimport pandas as pd\nimport tensorflow as tf\nimport seaborn as sn\nimport matplotlib.pyplot as plt\nfrom sklearn.cluster import KMeans","58558b21":"# data import and view\ndf = pd.read_csv('winequality-red.csv')\nprint(df.head(),df.shape)","9361f381":"#### \n# label the wines:\n# let's say bad wines are scored 1-3, fair wines are 4-6, good wines are 7-9\n\ndf['grade'] = ['bad' if (x >= 1) & (x <= 3) else 'fair' if (x >= 4) & (x <= 6) else 'good' for x in df['quality']] \nprint(df)","1518ee13":"# features correlation with quality\nprint(df.corr()['quality'])","226973db":"train_features = df.columns[:-2]\n\nfor i in train_features:\n    plt.show(sn.violinplot(df['grade'],df[i],order=['bad','fair','good'],palette='muted',inner=\"quartile\"))\n    plt.show()","36d381ab":"print('mean of criteria for good, fair and bad wines:')\nbad_col = df[df['grade']=='bad'].mean().round(3)\nfair_col = df[df['grade']=='fair'].mean().round(3)\ngood_col = df[df['grade']=='good'].mean().round(3)\ndf_mean = pd.DataFrame([bad_col,fair_col,good_col],index=['bad_col','fair_col','good_col']).T\nprint(df_mean)","fe2dbf4c":"km = KMeans(n_clusters=3, init='k-means++', n_init=100, max_iter=20, \n               tol=0.0001, verbose=0, random_state=None, copy_x=True, algorithm='auto')\ndf['result'] = km.fit_predict(df[train_features])","391d8c9b":"compare = df[['result','quality']]\ncompare.groupby('result').hist()\n","95acee46":"###############################\n\n**So, a good wine is considered to be:**\n* High fixed acidity\n* Low volatile acidity\n* High citric acid\n* Low chlorides\n* Low density\n* Low pH\n* High sulphates\n* High alcohol\n\n###############################"}}