{"cell_type":{"28c85bf2":"code","5c4d5ed0":"code","8505ae62":"code","fc135350":"code","fc7dc02f":"code","1847e7d1":"code","6942050a":"code","538e4c6f":"code","ca59182d":"code","bd382d2c":"code","09844dd5":"code","58df935c":"code","385590ff":"code","92b08861":"code","91c4b7e5":"code","a8d45f59":"code","2c141208":"markdown","ee33e7c5":"markdown","1e6b31f1":"markdown","6748ec4a":"markdown","a93d4b8a":"markdown","95eadfd6":"markdown","1568f4f4":"markdown","71ecbae5":"markdown","f431d62a":"markdown","d3e978d7":"markdown","9f940016":"markdown"},"source":{"28c85bf2":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","5c4d5ed0":"import matplotlib.pyplot as plt\nfrom PIL import Image\n\nimport plotly.offline as py\npy.init_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nimport plotly.tools as tls\n\npd.options.mode.chained_assignment = None\npd.options.display.max_columns = 9999\npd.options.display.float_format = '{:20, .2f}'.format\n","8505ae62":"train_df = pd.read_csv(\"..\/input\/train_relationships.csv\")\ntrain_df.head()","fc135350":"train_df.shape","fc7dc02f":"files = [os.path.join(dp, f) for dp, dn, fn in os.walk(os.path.expanduser(\"..\/input\/train\")) for f in fn]\ntrain_images_df = pd.DataFrame({\n    'files': files,\n    'familyId': [file.split('\/')[3] for file in files],\n    'kinId': [file.split('\/')[4] for file in files],\n    'uniqueId': [file.split('\/')[3] + '\/' + file.split('\/')[4] for file in files]\n})\ntrain_images_df.head()","1847e7d1":"print(\"Total number of members in the dataset: {0}\".format(train_images_df[\"uniqueId\"].nunique()))\nprint(\"Total number of families in the dataset: {0}\".format(train_images_df[\"familyId\"].nunique()))","6942050a":"family_with_most_pic = train_images_df[\"familyId\"].value_counts()\nkin_with_most_pic = train_images_df[\"uniqueId\"].value_counts()\nprint(\"Family with maximum number of images: {0}, Image Count: {1}\".format(family_with_most_pic.index[0], family_with_most_pic[0]))\nprint(\"Member with maximum number of images: {0}, Image Count: {1}\".format(kin_with_most_pic.index[0], kin_with_most_pic[0]))","538e4c6f":"family_series = family_with_most_pic[:25]\nlabels = (np.array(family_series.index))\nsizes = (np.array((family_series \/ family_with_most_pic.sum()) * 100))\n\ntrace = go.Pie(labels=labels, values=sizes)\nlayout = go.Layout(title='Pic Count by Families')\ndata = [trace]\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig, filename='Families')","ca59182d":"most_pic_members = train_images_df[train_images_df[\"uniqueId\"] == kin_with_most_pic.index[0]].files.values\nfig, ax = plt.subplots(4, 6, figsize=(50, 40))\nrow = 0\ncol = 0\nfor index in range(len(most_pic_members[:24])):\n    with open(most_pic_members[index], 'rb') as f:\n        img = Image.open(f)\n        ax[row][col].imshow(img)\n\n        if(col < 5):\n            col = col + 1\n        else: \n            col = 0\n            row = row + 1\nfig.show()","bd382d2c":"family_with_most_members = train_images_df.groupby(\"familyId\")[\"kinId\"].nunique().sort_values(ascending=False)\nprint(\"Family with maximum number of members: {0}, Member Count: {1}\".format(family_with_most_members.index[0], family_with_most_members[0]))\nprint(\"Family with least number of members: {0}, Member Count: {1}\".format(\n    family_with_most_members.index[len(family_with_most_members)-1], \n    family_with_most_members[len(family_with_most_members)-1]))\n","09844dd5":"large_family_df = train_images_df[train_images_df[\"familyId\"]  == family_with_most_members.index[0]]\nlarge_family_df.head()","58df935c":"\n\n\ndef render_bar_chart(data_df, column_name, title, filename):\n    series = data_df[column_name].value_counts()\n    count = series.shape[0]\n    \n    trace = go.Bar(x = series.index, y=series.values, marker=dict(\n        color=series.values,\n        showscale=True\n    ))\n    layout = go.Layout(title=title)\n    data = [trace]\n    fig = go.Figure(data=data, layout=layout)\n    py.iplot(fig, filename=filename)\n    \n    \nrender_bar_chart(large_family_df, 'uniqueId', 'Pic Count by Members', 'members')","385590ff":"def render_images(large_family_df):\n    large_family_pics = [large_family_df.loc[large_family_df.loc[large_family_df[\"uniqueId\"] == aKin].index[0]][\"files\"] for aKin in large_family_df[\"uniqueId\"].unique()]\n    nrows = round(len(large_family_pics) \/ 6) + 1\n\n\n    fig, ax = plt.subplots(nrows, 6, figsize=(50, 40))\n    row = 0\n    col = 0\n    for index in range(len(large_family_pics)):\n        with open(large_family_pics[index], 'rb') as f:\n            img = Image.open(f)\n            ax[row][col].imshow(img)\n\n            if(col < 5):\n                col = col + 1\n            else: \n                col = 0\n                row = row + 1\n    fig.show()\nrender_images(large_family_df)","92b08861":"large_family_df = train_images_df[train_images_df[\"familyId\"]  == family_with_most_members.index[1]]\nrender_images(large_family_df)\nrender_bar_chart(large_family_df, 'uniqueId', 'Pic Count by Members', 'members')","91c4b7e5":"large_family_df = train_images_df[train_images_df[\"familyId\"]  == family_with_most_members.index[2]]\nrender_images(large_family_df)\nrender_bar_chart(large_family_df, 'uniqueId', 'Pic Count by Members', 'members')","a8d45f59":"train_df = pd.read_csv(\"..\/input\/train_relationships.csv\")\ntrain_df.head()","2c141208":"## Third family with largest number of members","ee33e7c5":"## Some Interesting Facts\n* How many unique faces are there?  \n**2316**  \n* How many familys are there?  \n**470**\n* What is the total number of images in the train set?  \n**12379**\n* In train data, how many relationship combinations are present?  \n**3598**\n\n## Largest Families\n\n* Which is the largest family?  \nIt's **British Royal Family**\n* Which is the second largest family?  \nIt's family of **Jeff Bridges** \n* Who's got maximum number of images?  \n**Prince William**, Duke of Cambridge\n\n## More Info on Largest Family\n* Which family got more number of members?  \n**F0601** with **41** Members\n* Which family got least number of members?  \n**F0275** with **1** Members\n* Which family got maximum number of images?  \n**F0601, 776 Images**\n* Which family maximum number of members?  \n**F0601, 41 Members**\n* Which member got maximum number of images?  \n**F0601\/MID6**, Image Count: **95**\n* Is there an anomaly in the data?  \n**No** but the largest family data might bias the learning\n","1e6b31f1":"## Create Image Identification DF","6748ec4a":"## Train Set","a93d4b8a":"## British Royal Family\nLets look at the family with max members","95eadfd6":"##  Objective\nObjective of this kernel is to \n- Quickly get an idea of the dataset and the images\n- Tricky coding that helps one to consummate all image info in a data frame.\n- Render some insights well ahead of getting into technical stuff\n- Exploration of the dataset and distribution using intuitive plots","1568f4f4":"## Count: Family and Kin","71ecbae5":"## Pic of Every Member from British Royalty\nThis snippet of code picks the first picture of every member of the family.","f431d62a":"## Data Augmentation","d3e978d7":"About 30% of the pics fall under 1 family and this might result bias. Treating this bias is key for prediction accuracy.","9f940016":"## Jeff Bridges and his Family\nFamily with second largest collection of pictures."}}