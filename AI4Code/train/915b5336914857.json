{"cell_type":{"56365e88":"code","02871ca8":"code","45474ecd":"code","b34573cb":"code","6f345e98":"code","5d9c6ff5":"code","447630b6":"code","5fce1fac":"code","eeaa2902":"code","1e209c6a":"code","c515044d":"code","783cc620":"code","0357ee31":"code","3ee6cb09":"code","52200090":"code","49e9763e":"code","47ca61fc":"code","672699d3":"code","9ecea4ca":"code","b65ec5a1":"code","2ad70c5d":"code","d2410520":"code","5812475f":"code","dc0a9be9":"code","5682744b":"code","0e6ad74c":"code","793b6f2f":"code","81f64cfd":"code","ed7b7bb3":"code","578611d6":"code","87e4799c":"code","0d9dc05d":"code","095031d3":"markdown","7deec08e":"markdown","d186d986":"markdown","7fb441ff":"markdown","b7676f8f":"markdown","682fb8ac":"markdown","cda9a2ff":"markdown","6196d03e":"markdown","01ed6798":"markdown","134529b8":"markdown","f5585ebb":"markdown","29739787":"markdown","8788e98c":"markdown"},"source":{"56365e88":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","02871ca8":"df  = pd.read_csv('..\/input\/USA_Housing.csv')","45474ecd":"#let's see the number of rows and columns\ndf.shape","b34573cb":"df.info()","6f345e98":"# So, we have 6 countinuos variable and one categorical variable. \n# Now, lets look at some of the data.\ndf.head()","5d9c6ff5":"df.describe()","447630b6":"# lets see if there is any null\/missing values in the datasets or not. It's important to remove or\n# replace all the missing values before moving further. \ndf.isna().sum()","5fce1fac":"# We don't have any missing values. So, we are good to go. \n# Now, let's understand the correlation between variable by plotting correlation plot.\ndf.corr()","eeaa2902":"plt.figure(figsize=(12,10))\nsns.heatmap(df.corr(), annot=True)","1e209c6a":"# As we can see that price is more correlated to Avg. Income Area, House Age and Area Population than Number of Bedrooms and Rooms. Lets see these metrics in tabular format.\ndf.corr().Price.sort_values(ascending=False)","c515044d":"sns.pairplot(df)","783cc620":"# As we can see here in the last line of graph that all the features seems to be in a linear relationship with price except Avg. Area Number of Bedroom.\n# We can also see this by plotting a separate graph\n\nplt.scatter(df.Price, df[['Avg. Area Income']])","0357ee31":"sns.distplot(df.Price)","3ee6cb09":"# We can see the price plot seems like a bell shaped curve and all the price is normally distributed.","52200090":"plt.figure(figsize=(12,10))\nplt.subplot(2,3,1)\nplt.title(\"price\")\nplt.boxplot(df.Price)\n\nplt.subplot(2,3,2)\nplt.title(\"Average income\")\nplt.boxplot(df[\"Avg. Area Income\"])\nplt.subplot(2,3,3)\nplt.title(\"Avg. Area House Age\")\nplt.boxplot(df[\"Avg. Area House Age\"])\nplt.subplot(2,3,4)\nplt.title(\"Avg. Area Number of Rooms\")\nplt.boxplot(df[\"Avg. Area Number of Rooms\"])\nplt.subplot(2,3,5)\nplt.title(\"Avg. Area Number of Bedrooms\")\nplt.boxplot(df[\"Avg. Area Number of Bedrooms\"])\nplt.subplot(2,3,6)\nplt.title(\"Area Population\")\nplt.boxplot(df[\"Area Population\"])","49e9763e":"df = df.drop(['Address'], axis=1)\ndf.head()","47ca61fc":"from sklearn import preprocessing\npre_process = preprocessing.StandardScaler()","672699d3":"feature = df.drop(['Price'], axis = 1)\nlabel = df.Price\n\n# Now, we have feature and label for machine learning algorithms. Now, we can scale the data by using standard scaler.\n\nfeature = pre_process.fit_transform(feature)","9ecea4ca":"feature \n#this is how the scaled data looks like.","b65ec5a1":"from sklearn.model_selection import train_test_split\nfeature_train, feature_test, label_train, label_test = train_test_split(feature, label.values, test_size = 0.2, random_state = 19)","2ad70c5d":"from sklearn import linear_model\nlinear_regression = linear_model.LinearRegression()\nlinear_regression.fit(feature_train, label_train)","d2410520":"from sklearn.metrics import r2_score, mean_squared_error\n\nscore = r2_score(linear_regression.predict(feature_train), label_train)\nerror = mean_squared_error(linear_regression.predict(feature_train), label_train)","5812475f":"score, error","dc0a9be9":"linear_regression.coef_","5682744b":"linear_regression.intercept_","0e6ad74c":"pd.DataFrame(linear_regression.coef_, index=df.columns[:-1], columns=['Values'])","793b6f2f":"# Applying this on test data.\nscore_test = r2_score(linear_regression.predict(feature_test), label_test)\nscore_test","81f64cfd":"ransac = linear_model.RANSACRegressor()\nransac.fit(feature_train, label_train)\n\n# Scoring the Ransac model\n\nransac_r2_score = r2_score(ransac.predict(feature_test), label_test)\nransac_r2_score","ed7b7bb3":"ridge_model = linear_model.Ridge()\nridge_model.fit(feature_train, label_train)\n\n# Scoring the Ridge Regression\n\nridge_r2_score = r2_score(ridge_model.predict(feature_test), label_test)\nridge_r2_score\n","578611d6":"from sklearn import tree\ntree_model = tree.DecisionTreeRegressor()\ntree_model.fit(feature_train, label_train)\n\n# Scoring the Ridge Regression\n\ntree_r2_score = r2_score(tree_model.predict(feature_test), label_test)\ntree_r2_score","87e4799c":"from sklearn.ensemble import RandomForestRegressor\nrandom_model = RandomForestRegressor()\nrandom_model.fit(feature_train, label_train)\n\n# Scoring the Ridge Regression\n\nrandom_r2_score = r2_score(tree_model.predict(feature_test), label_test)\nrandom_r2_score","0d9dc05d":"data = [score_test, ransac_r2_score, ridge_r2_score, tree_r2_score,random_r2_score]\nindex = ['Linear Regression', 'Ransac Regression', 'Ridge Regression', 'Decision Tree Regressor', 'Random Forest Regressor']\npd.DataFrame(data, index=index, columns=['Scores']).sort_values(ascending = False, by=['Scores'])","095031d3":"**Ridge Regression**","7deec08e":"**Understanding the data**","d186d986":"![](http:\/\/)**Testing Decision Tree Model**","7fb441ff":"* Six columns have Float64 datatype.\n* One column(Address)  have object datatype.","b7676f8f":"Before jumping into code directly its import to follow some basics. I have divided this kernel into 7 parts.\n\n* Understanding your data\n* Data Cleaning(if required)\n* Outlier treatment\n* Scaling the data into machine learning readbable format\n* Dividing the data into train\/test\n* Applying machine learning algorithm\n* Testing the effectiveness of the machine learning Algorithm\n* Trying different Algorithms","682fb8ac":"**Detection and remove of Outliers**","cda9a2ff":"![](http:\/\/)**Divding the data into train\/test**","6196d03e":"**Random Forest Regressor**","01ed6798":"**Applying machine learning algorithm**","134529b8":"Till now, we had a detailed look at the given data and fortunately we don't have any missing values. So, the data cleaning is not required for this data.\n\nWe will also be deleting the address data, as it does not seem that useful.'","f5585ebb":"* Describe method will show the statitical information of continues variable column.","29739787":"Some Other Algorithms\n\n**RANSAC Regressor**","8788e98c":"![](http:\/\/)**Scale the data - Prepare the data to feed into the machine learning algorithm**"}}