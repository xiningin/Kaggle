{"cell_type":{"e9588f36":"code","740e7378":"code","8c619d53":"code","3b02740c":"code","4ad05d1a":"code","595a9a4b":"code","7c751b3b":"code","c9e2dffd":"code","1312df7c":"code","158908da":"code","2d26744f":"code","5e29bc5d":"code","c79b2843":"code","339714a7":"code","208c7f32":"markdown","68f59c36":"markdown","d7508ad2":"markdown","5401e6b1":"markdown","65ee97a2":"markdown"},"source":{"e9588f36":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n       \nfrom IPython.core.interactiveshell import InteractiveShell\nInteractiveShell.ast_node_interactivity = \"all\"\npd.set_option('display.max_columns', 60)\npd.set_option('display.max_rows', 500)\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","740e7378":"from sklearn.ensemble import RandomForestClassifier\nfrom xgboost.sklearn import XGBClassifier\nimport xgboost as xgb\nfrom catboost import CatBoostClassifier\n\nfrom sklearn.model_selection import GridSearchCV , RandomizedSearchCV\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score, log_loss","8c619d53":"train_df = pd.read_csv(os.path.join(dirname,'train.csv'))\ntest_df = pd.read_csv(os.path.join(dirname,'test.csv'))","3b02740c":"features = train_df.columns[1:-1]\nknown_x = train_df[features]\nknown_y = train_df[train_df.columns[-1]]\ntest_x = test_df[features]","4ad05d1a":"train_x,val_x, train_y, val_y = train_test_split(known_x,known_y,train_size=0.8,random_state = 0)","595a9a4b":"cat1 =  CatBoostClassifier(iterations=1500,learning_rate = 0.1, max_depth = 4,l2_leaf_reg = 7,\n                           loss_function = 'MultiClass' ,eval_metric = 'MultiClass',random_seed = 0,verbose = 0)","7c751b3b":"cat1.fit(train_x, train_y, eval_set = (val_x,val_y))","c9e2dffd":"stage1_pred_cat = cat1.predict_proba(test_x)","1312df7c":"xgb1 = XGBClassifier(subsample= 0.6,reg_alpha= 0.1,min_child_weight= 3,max_depth= 6,\n            learning_rate= 0.03,gamma= 0.0,colsample_bytree= 0.6, seed=27)","158908da":"xgb1.fit(known_x, known_y,eval_metric='logloss')\nstage1_pred_xgb = xgb1.predict_proba(test_x)","2d26744f":"stage1_cat_df = pd.DataFrame(stage1_pred_cat, columns = cat1.classes_)\nstage1_xgb_df = pd.DataFrame(stage1_pred_xgb, columns = xgb1.classes_)","5e29bc5d":"blend_df = (stage1_cat_df*0.8) + (stage1_xgb_df*0.2) ","c79b2843":"test_df[blend_df.columns] = blend_df","339714a7":"submit_df = test_df[['id','Class_1','Class_2','Class_3','Class_4']]\nsubmit_df.to_csv('avg_blend_CatXgb_submission.csv', index = False)","208c7f32":"#### A introduction to blending in models. ","68f59c36":"### Average Blending","d7508ad2":"#### CatBoost","5401e6b1":"#### Blending","65ee97a2":"#### XGB"}}