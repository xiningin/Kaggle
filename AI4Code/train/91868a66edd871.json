{"cell_type":{"4b9d6388":"code","b892441d":"code","227a879c":"code","b2ba7152":"code","19b1685a":"code","b385b277":"code","c2a34747":"code","da6a7fca":"code","3f024d77":"code","f07ccba5":"code","47a53abb":"code","ca8f5aef":"code","7ad869ae":"code","9c382c7b":"code","6fed5e22":"code","0578d4ad":"markdown"},"source":{"4b9d6388":"import numpy as np\nimport pandas as pd\nfrom pathlib import Path","b892441d":"ls ..\/input\/rsna-intracranial-hemorrhage-detection\/","227a879c":"train = pd.read_csv(\"..\/input\/rsna-intracranial-hemorrhage-detection\/stage_1_train.csv\")\nsample = pd.read_csv(\"..\/input\/rsna-intracranial-hemorrhage-detection\/stage_1_sample_submission.csv\")\ntrain_images_path_list = list(Path(\"..\/input\/rsna-intracranial-hemorrhage-detection\/stage_1_train_images\/\").glob(\"*\"))\ntest_images_path_list = list(Path(\"..\/input\/rsna-intracranial-hemorrhage-detection\/stage_1_test_images\/\").glob(\"*\"))","b2ba7152":"display(train.shape)\ndisplay(sample.shape)\n\ntrain['Label'].value_counts()","19b1685a":"len(train_images_path_list), len(test_images_path_list)","b385b277":"len(train_images_path_list) * 6","c2a34747":"train.head(7)","da6a7fca":"sample.head(7)","3f024d77":"train['Image ID'] = train['ID'].apply(lambda x: x.split('_')[1])\ntrain['Sub-type'] = train['ID'].apply(lambda x: x.split('_')[2])\ntrain = pd.pivot_table(train, index='Image ID', columns='Sub-type')","f07ccba5":"train.head()","47a53abb":"train.mean()","ca8f5aef":"sample['Sub-type'] = sample['ID'].apply(lambda x:x.split('_')[2])\nsample.loc[sample['Sub-type'] == 'any', 'Label'] = train.mean()[0]\nsample.loc[sample['Sub-type'] == 'epidural', 'Label'] = train.mean()[1]\nsample.loc[sample['Sub-type'] == 'intraparenchymal', 'Label'] = train.mean()[2]\nsample.loc[sample['Sub-type'] == 'intraventricular', 'Label'] = train.mean()[3]\nsample.loc[sample['Sub-type'] == 'subarachnoid', 'Label'] = train.mean()[4]\nsample.loc[sample['Sub-type'] == 'subdural', 'Label'] = train.mean()[5]","7ad869ae":"sample = sample.drop('Sub-type', axis=1)","9c382c7b":"sample.to_csv('submit.csv', index=False)","6fed5e22":"sample.head()","0578d4ad":"* There are 6 Sub-type per image\n* https:\/\/www.kaggle.com\/c\/rsna-intracranial-hemorrhage-detection\/overview\/hemorrhage-types\n    <img src='https:\/\/cdn.discordapp.com\/attachments\/507208726864855060\/623862702955036702\/RSNA_Intracranial_Hemorrhage_Detection_Kaggle.png'>\n\nLet's see the label for each sub-type."}}