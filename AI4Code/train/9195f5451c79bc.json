{"cell_type":{"97ea6169":"code","996a5460":"code","0a470edc":"code","d4ab4615":"code","d22384dc":"code","32f4d20f":"code","2ad36444":"code","ac5e157c":"code","b8a99af7":"code","42c1594b":"code","65d07dc0":"code","b05f6798":"code","630473d3":"code","7ca36228":"code","4caa64de":"code","5f7e6ea7":"code","249b7b26":"code","f014aa76":"code","c26b1ff3":"code","7b35e89d":"code","f608284f":"code","c787c38b":"code","959c691e":"code","4bd964b7":"code","354233f7":"code","bcda90f5":"code","4347f7de":"code","809284d2":"code","63e967c1":"code","7090ee78":"code","2cd9757b":"code","104a0f75":"code","5ddf8aad":"code","72eadb74":"code","dfd5a2f4":"code","6ccbd413":"code","1c10a5ff":"code","c84c4c9d":"code","dbe39232":"code","40bc3586":"code","295d0fcc":"code","c0d1b1ff":"code","2a1acbd3":"markdown","b5a144ff":"markdown","5d4259a4":"markdown","b1154920":"markdown","ca17067f":"markdown","7f1cad90":"markdown","26fa4902":"markdown","203f0c29":"markdown","2324741f":"markdown","308db600":"markdown","a6a2ae8d":"markdown","bb33b55b":"markdown","81031929":"markdown","a64ea7c6":"markdown","1957e986":"markdown","92137e81":"markdown","ab76c505":"markdown","5bad1ee3":"markdown","3aeffc31":"markdown","870bf78f":"markdown","c24b02e5":"markdown","adbb6981":"markdown","116a2daa":"markdown","8102d94e":"markdown","f1f77e0f":"markdown","03ffd441":"markdown","b76aac2d":"markdown"},"source":{"97ea6169":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","996a5460":"import matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom nltk.tokenize import RegexpTokenizer\nfrom sklearn import preprocessing\nfrom scipy.sparse import hstack\nimport pandas_profiling","0a470edc":"#load dataset\ndf = pd.read_csv(\"\/kaggle\/input\/movies-on-netflix-prime-video-hulu-and-disney\/MoviesOnStreamingPlatforms_updated.csv\")","d4ab4615":"df = df.iloc[:, 1:]    #remove unnamed index column\ndf.head()","d22384dc":"df.info()","32f4d20f":"df.Type.unique()","2ad36444":"df.isnull().sum()","ac5e157c":"miss = pd.DataFrame(df.isnull().sum())\nmiss = miss.rename(columns={0: \"miss_count\"})\nmiss[\"missing%\"] = (miss.miss_count\/len(df.ID))*100\nmiss","b8a99af7":"#mssing %>50%\ndf.drop(['Rotten Tomatoes', 'Age'], axis =1, inplace=True)\n# dropping NA from following columns\ndf.dropna(subset=[\n    'IMDb', 'Directors', 'Genres', 'Country', 'Language', 'Runtime'\n], inplace = True)\n\ndf.reset_index(inplace=True, drop=True)\n\n#converting into object tyype\n\ndf.Year = df.Year.astype(\"object\")","42c1594b":"df.info()","65d07dc0":"#check distribution of year using distplot\nplt.figure(figsize = (20, 5))\nsns.distplot(df['Year'])\nplt.show()\n","b05f6798":"#distribution of IMDB Rating\nplt.figure(figsize = (20,5))\nsns.distplot(df['IMDb'])\nplt.show()\n","630473d3":"# lets plot the length of movies\nsns.distplot(df['Runtime'])\nplt.show()","7ca36228":"def movie_count(platform, count=False):\n    \"\"\"A function to count the movies in differnet Streaming platform\"\"\"\n    if count==False:\n        print('Platform {} Count : {}'.format(platform, df[platform].sum()))\n        \n    else:\n        return df[platform].sum()","4caa64de":"#lets see the count\nmovie_count('Netflix')\nmovie_count('Prime Video')\nmovie_count('Disney+')","5f7e6ea7":"#lets find on each plaform\nplatform = 'Prime Video', 'Netflix', 'Hulu', 'Disney+'\ns = [movie_count('Prime Video', count = True),\n     movie_count('Netflix', count = True),\n     movie_count('Hulu', count = True),\n     movie_count('Disney+', count = True),\n    ]\n\nexplode= (0.1, 0.1, 0.1, 0.1)\n\n#plot\nfig1, ax1 = plt.subplots()\nax1.pie(s, \n       labels = platform,\n       autopct = '%1.1f%%',\n       explode = explode,\n       shadow = True,\n       startangle=100)\n\nax1.axis = ('equal')\nplt.title('Distribution of OTT')\nplt.show()","249b7b26":"# split genre by ',' and then stack it one after the other.\n#apply will create the mupltiple columns for each genre and 'stack' will stack them\n#in single column\n\ng = df['Genres'].str.split(',').apply(pd.Series,1).stack()\n\ng.index = g.index.droplevel(-1)\n\n#assign name\ng.name = 'Genres'\n\n#delete column\n\ndel df['Genres']\n\n#join new column\ndf_genres = df.join(g)\n\n","f014aa76":"plt.figure(figsize=(20,10))\nsns.countplot(x='Genres', data = df_genres)\nplt.xticks(rotation=90)\nplt.title(\"Genre wise movies\")\nplt.show()","c26b1ff3":"#same process as above \n#split-->apply-->stack()\n\nc = df['Country'].str.split(',').apply(pd.Series, 1).stack()\nc.index = c.index.droplevel(-1)\n\n#assign name\nc.name = 'Country'\n\n#delete column\ndel df['Country']\n\ndf_country = df.join(c)","7b35e89d":"df_country.head()","f608284f":"#plot\ndf_country['Country'].value_counts()[:10].plot(kind=\"bar\", figsize=(15,5))\nplt.show()","c787c38b":"#split\nl = df['Language'].str.split(',').apply(pd.Series,1).stack()\n\nl.index = l.index.droplevel(-1)\n\nl.name = \"Language\"\n\ndel df['Language']\n\ndf_language = df.join(l)","959c691e":"df_language['Language'].value_counts()[:10].plot(kind = 'bar', figsize =(15,3))\nplt.show()","4bd964b7":"df.columns","354233f7":"#apply melt() function --> converts wide dataframe into a long dataframe\ndf_Imdb = pd.melt(df, id_vars = ['ID', 'Title', 'Year', 'IMDb', 'Type', 'Runtime'], var_name = 'platform')\n\ndf_Imdb = df_Imdb[df_Imdb.value==1]\ndf_Imdb.drop(columns=[\"value\"], axis=1, inplace=True)\n","bcda90f5":"#plot the graph\ng = sns.FacetGrid(df_Imdb, col=\"platform\")\ng.map(plt.hist, \"IMDb\")\nplt.show()","4347f7de":"# we have already droped the Age \n#lets reload the data\ndf = pd.read_csv(\"\/kaggle\/input\/movies-on-netflix-prime-video-hulu-and-disney\/MoviesOnStreamingPlatforms_updated.csv\")\ndf=df.iloc[:,1:]\ndf.ID = df.ID.astype(\"object\")\n\n# melting platform columns to create visualization\ndf2 = pd.melt(df, id_vars=[\"ID\",\"Title\",\"Year\",\"Age\",\"IMDb\",\"Rotten Tomatoes\",\"Type\",\"Runtime\"], var_name=\"platform\")\ndf2 = df2[df2.value==1]\ndf2.drop(columns=[\"value\"],axis=1,inplace=True)","809284d2":"df2.head(5)","63e967c1":"# Total runtime in different platform\n\nax = sns.barplot(x=\"platform\", y=\"Runtime\",hue=\"Age\", estimator=sum, data=df2)\n","7090ee78":"#load data again\ndf = pd.read_csv(\"\/kaggle\/input\/movies-on-netflix-prime-video-hulu-and-disney\/MoviesOnStreamingPlatforms_updated.csv\")\ndf = df.iloc[:, 1:]","2cd9757b":"#find missing values\nmiss = pd.DataFrame(df.isnull().sum())\nmiss = miss.rename(columns={0: \"miss_count\"})\nmiss[\"missing%\"] = (miss.miss_count\/len(df.ID))*100\nmiss","104a0f75":"#mssing %>50%\ndf.drop(['Rotten Tomatoes', 'Age'], axis =1, inplace=True)\n# dropping NA from following columns\ndf.dropna(subset=[\n    'IMDb', 'Directors', 'Genres', 'Country', 'Language', 'Runtime'\n], inplace = True)\n\ndf.reset_index(inplace=True, drop=True)\n\n#converting into object tyype\n\ndf.Year = df.Year.astype(\"object\")\ndf.ID = df.ID.astype(\"object\")","5ddf8aad":"#select variable\nnumerical_df = df.select_dtypes(include=['float64', \"int64\"])","72eadb74":"#use preprocessing\n\n#create minmax scaler\nscaler = preprocessing.MinMaxScaler(feature_range=(0,1))\n\n#create dataframe\nnumerical_df_max = pd.DataFrame((scaler.fit_transform(numerical_df)))\n\n#assign column names\nnumerical_df_max.columns = numerical_df.columns\n\nnumerical_df_max.head()","dfd5a2f4":"from sklearn.metrics.pairwise import cosine_similarity\n\n#compute cosine similarity\nsig = cosine_similarity(numerical_df_max, numerical_df_max)\n\n#reverse maping of indices and titles\nindices = pd.Series(df.index, index = df['Title']).drop_duplicates()","6ccbd413":"indices.head()","1c10a5ff":"def give_recomendation(title, sig = sig):\n    \"\"\"return the index of series of indices\"\"\"\n    #get the index corresponding to original_title\n    idx = indices[title]\n    \n    #get the pairwise similarity scores\n    sig_scores = list(enumerate(sig[idx]))\n    \n    #sort the movies\n    sig_scores = sorted(sig_scores, key=lambda x: x[1], reverse=True)\n    \n    #scores of 10 most similar movies\n    movie_indices = [i[0] for i in sig_scores]\n    #top 10 most similar movies\n    return df['Title'].iloc[movie_indices]","c84c4c9d":"#lets try\ngive_recomendation(\"The Matrix\", sig= sig)","dbe39232":"#the function performs all the important preprocessing steps\ndef preprocess(df):\n    \n    #combining all text columns\n    # Selecting all object data type and storing them in list\n    s = list(df.select_dtypes(include=['object']).columns)\n    \n    \n    # Removing ID and Title column\n    s.remove(\"Title\")\n    s.remove(\"ID\")\n    \n    # Joining all text\/object columns using commas into a single column\n    df['all_text']= df[s].apply(lambda x: ','.join(x.dropna().astype(str)),axis=1)\n\n    # Creating a tokenizer to remove unwanted elements from our data like symbols and numbers\n    token = RegexpTokenizer(r'[a-zA-Z]+')\n\n    # Converting TfidfVector from the text\n    cv = TfidfVectorizer(lowercase=True,stop_words='english',ngram_range = (1,1),tokenizer = token.tokenize)\n    text_counts= cv.fit_transform(df['all_text'])\n\n    # Aelecting numerical variables\n    ndf = df.select_dtypes(include=['float64',\"int64\"])\n\n    # Scaling Numerical variables\n    scaler = preprocessing.MinMaxScaler(feature_range=(0, 1))\n\n    # Applying scaler on our data and converting i into a data frame\n    ndfmx = pd.DataFrame((scaler.fit_transform(ndf)))\n    ndfmx.columns=ndf.columns    \n\n    # Adding our adding numerical variables in the TF-IDF vector\n    IMDb = ndfmx.IMDb.values[:, None]\n    X_train_dtm = hstack((text_counts, IMDb))\n    \n    Netflix = ndfmx.Netflix.values[:, None]\n    X_train_dtm = hstack((X_train_dtm, Netflix))\n    \n    Hulu = ndfmx.Hulu.values[:, None]\n    X_train_dtm = hstack((X_train_dtm, Hulu))\n    \n    Prime = ndfmx[\"Prime Video\"].values[:, None]\n    X_train_dtm = hstack((X_train_dtm, Prime))\n    \n    Disney = ndfmx[\"Disney+\"].values[:, None]\n    X_train_dtm = hstack((X_train_dtm, Disney))\n    \n    Runtime = ndfmx.Runtime.values[:, None]\n    X_train_dtm = hstack((X_train_dtm, Runtime))\n    \n    return X_train_dtm","40bc3586":"# Preprocessing data\nmat = preprocess(df)\nmat.shape","295d0fcc":"# using cosine similarity\nfrom sklearn.metrics.pairwise import cosine_similarity\n\n#compute the sigmoid kernel\nsig2= cosine_similarity(mat, mat)\n\n#reverse mapping of indices and movie titles\nindices = pd.Series(df.index, index=df['Title']).drop_duplicates()","c0d1b1ff":"give_recomendation(\"The Matrix\", sig = sig2)","2a1acbd3":"# Lets build two recomendor system\n\n### 1. Using only Numerical column","b5a144ff":"# Distribute according to language","5d4259a4":"lots of movies lies between 5 to 7","b1154920":"# Lets visualize by plots","ca17067f":"### 2. Using Numerical and Textual Columns","7f1cad90":"### So finally we have made a basic recommendor system.\n\nFeel free to fork and improve the model.","26fa4902":"write a function to get recomedation based on similartiy score","203f0c29":"#### Step 2 : applying the function to our data and creating a sparse matrix","2324741f":"Here we can see Age and Rotten tomatoes has lots of missing values\n\n**lets find percentage of missing values**","308db600":" scaling the numerical variable using a minmax scaler to reduce model complexity","a6a2ae8d":"# LEts build our model\n\nThere are three ttypes of recommender systems:\n1. **Content based methods**\n2. **Collaborative Filtering Methods**\n3. **Hybrid Methods**","bb33b55b":"# Work with missing values","81031929":"1. Drop columns which has more than 50% missing values\n2. Drop NA from less than 50%\n3. Reset Index","a64ea7c6":" most movies are made between 2000 to 2020","1957e986":"## Lets distribute the movie based on platforms","92137e81":"Here, recommended movies are not up to the mark. The reason behind this poor result is that you are using only movie ratings, movie runtimes, and platform variables. You can improve this by using other information such as genre, directors, and country.","ab76c505":"compute similarity score","5bad1ee3":"**Sources**:\n* Data Cammp\n* Medium\n* Kaggle","3aeffc31":"# Distribute IMDB rating on Each Platform","870bf78f":"#### Step4 : Getting a recommendation from our improved system","c24b02e5":"# distribute according to country","adbb6981":"#### Step 3: Again apply cosine similarity to compute the similarity score","116a2daa":"#### STep 1 \nuse textual columns into single column then use tokenizer and TF-IDF Vectorizer to create a sparse matrix.\n* Selecting all object data types and storing them in a list.\n* Removing ID and Title column.\n* Joining all text\/object columns using commas into a single column.\n* Creating a tokenizer to remove unwanted elements from our data like symbols and numbers.\n* Converting TfidfVector from the text After that we will do numerical columns pre-processing\n* Selecting numerical variables into a data Frame\n* Scaling Numerical variables using minmax scaler (0,1) range\n* Adding numerical variables in the TF-IDF vectors sparse matrix using hstack function (hstack is used to add horizontal arrays into a sparse matrix).","8102d94e":"# The End","f1f77e0f":"# Movie Distribution according to GENRE","03ffd441":"# Runtime per platform alogn the age group","b76aac2d":"#### Itss clearly visible that Age and Rotten tomatoes has more than 50% missing values"}}