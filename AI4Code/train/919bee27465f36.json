{"cell_type":{"5aec2270":"code","8842d18f":"code","aa954347":"code","6027ce1a":"code","69e934c3":"code","300cb443":"code","72262daa":"code","7e7bff75":"code","16be68e9":"code","23ea4b64":"code","24de589a":"code","e82ab377":"code","9e36e606":"code","ec59bb9b":"code","b984a9f9":"code","3a581432":"code","0c3065cd":"code","224675b4":"code","d7eaef57":"code","37328ed1":"code","c4dfc9f6":"code","339c9ebb":"code","d76563e0":"code","5afc438b":"code","510b003f":"code","5d2bbc39":"code","8ddaa518":"code","8153d601":"code","d6d86a05":"code","a29e5e78":"code","1ac6d598":"code","8585f644":"code","aac59f54":"code","31ef5f38":"code","7e92685c":"code","ca16b53b":"code","ea131943":"code","1da0373f":"code","ae5dc8bc":"code","f1f3e58c":"code","20d402a8":"code","a4a8a84e":"code","f980b31e":"code","f884d26f":"code","5a8ee2c8":"code","6bf52802":"code","20bddc12":"code","8413e73c":"code","d67434cc":"code","dd34d062":"markdown","f743cb49":"markdown","b870acd4":"markdown","6d44a0b8":"markdown","2b66f442":"markdown","e0191805":"markdown","d342ffe2":"markdown","28743ff3":"markdown","f0dd4760":"markdown","cd854c2d":"markdown","e05b0a65":"markdown","66cb1c64":"markdown","978f2214":"markdown","3e71eea2":"markdown"},"source":{"5aec2270":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.linear_model import LogisticRegression\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport os\nprint(os.listdir(\".\"))","8842d18f":"# reading data\ntrain = pd.read_csv(\"..\/input\/loan-prediction-data\/train.csv\")\ntest = pd.read_csv(\"..\/input\/loan-prediction-data\/test.csv\")","aa954347":"train.shape, test.shape","6027ce1a":"train.head(3)","69e934c3":"test.head(3)","300cb443":"train=train.drop(columns=['Loan_ID'])\ntest=test.drop(columns=['Loan_ID'])","72262daa":"train.columns","7e7bff75":"test.columns","16be68e9":"train.describe()","23ea4b64":"train.info()","24de589a":"train.Loan_Status.value_counts(normalize = True)","e82ab377":"sns.countplot(train['Loan_Status'],label=\"Count\")","9e36e606":"sns.countplot(train['Gender'],label=\"Count\")","ec59bb9b":"### Data Visualization libraries\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\ncategorical_columns = ['Gender', 'Married', 'Dependents', 'Education', 'Self_Employed', 'Property_Area','Credit_History','Loan_Amount_Term']\n\n\nfig,axes = plt.subplots(4,2,figsize=(12,15))\nfor idx,cat_col in enumerate(categorical_columns):\n    row,col = idx\/\/2,idx%2\n    sns.countplot(x=cat_col,data=train,hue='Loan_Status',ax=axes[row,col])\n\n\nplt.subplots_adjust(hspace=1)","b984a9f9":"train.isnull().sum()","3a581432":"train[\"Gender\"].fillna(train[\"Gender\"].mode()[0],inplace=True)\ntrain[\"Married\"].fillna(train[\"Married\"].mode()[0],inplace=True)\ntrain['Dependents'].fillna(train[\"Dependents\"].mode()[0],inplace=True)\ntrain[\"Self_Employed\"].fillna(train[\"Self_Employed\"].mode()[0],inplace=True)\ntrain[\"Credit_History\"].fillna(train[\"Credit_History\"].mode()[0],inplace=True)\ntrain[\"Loan_Amount_Term\"].fillna(train[\"Loan_Amount_Term\"].mode()[0],inplace=True)","0c3065cd":"train.isnull().sum()","224675b4":"train[\"Loan_Amount_Term\"].mode()[0]","d7eaef57":"train[\"Loan_Amount_Term\"].value_counts()","37328ed1":"train[\"LoanAmount\"].fillna(train[\"LoanAmount\"].median(),inplace=True)","c4dfc9f6":"train.isnull().sum()","339c9ebb":"test.isnull().sum()","d76563e0":"# Imputation of missing values for test data\n\ntest[\"Gender\"].fillna(test[\"Gender\"].mode()[0],inplace=True)\ntest[\"Married\"].fillna(test[\"Married\"].mode()[0],inplace=True)\ntest['Dependents'].fillna(test[\"Dependents\"].mode()[0],inplace=True)\ntest[\"Self_Employed\"].fillna(test[\"Self_Employed\"].mode()[0],inplace=True)\ntest[\"Credit_History\"].fillna(test[\"Credit_History\"].mode()[0],inplace=True)\ntest[\"Loan_Amount_Term\"].fillna(test[\"Loan_Amount_Term\"].mode()[0],inplace=True)\ntest[\"LoanAmount\"].fillna(test[\"LoanAmount\"].median(),inplace=True)\ntest.head()","5afc438b":"test.isnull().sum()","510b003f":"train[\"Total_Income\"]=(train[\"ApplicantIncome\"]+train[\"CoapplicantIncome\"])\n# train[\"LoanAmount\"]=train[\"LoanAmount\"]*12\n# train[\"EMI\"]=train[\"LoanAmount\"]\/12\n# train[\"Balance_Income\"] = train[\"Total_Income\"]-(train[\"EMI\"]*12)\ntrain[\"Income_Loan_Amount_Ratio\"]=train[\"Total_Income\"]\/train[\"LoanAmount\"]\n# train[\"ApplicantIncome_Loan_Amount_Ratio\"]=train[\"ApplicantIncome\"]\/train[\"LoanAmount\"]\n# train[\"Income_credit_history_ratio\"]=train[\"Total_Income\"]*(train[\"Credit_History\"]+1)\n# train[\"Amount_credit_history_ratio\"]=train[\"LoanAmount\"]*(train[\"Credit_History\"]+1)\n# train[\"Balance_Income_loan_Amount\"]=train[\"Balance_Income\"]\/(train[\"LoanAmount\"])\n# train[\"Balance_Income_EMI\"]=train[\"Balance_Income\"]\/(train[\"EMI\"])\n# train[\"Income_Balance_Income_Ratio\"]=train[\"Total_Income\"]\/train[\"Balance_Income\ntrain.columns","5d2bbc39":"numerical_columns = ['ApplicantIncome', 'CoapplicantIncome', 'LoanAmount','Total_Income','Income_Loan_Amount_Ratio']\nfig,axes = plt.subplots(1,5,figsize=(17,5))\nfor idx,cat_col in enumerate(numerical_columns):\n    sns.boxplot(y=cat_col,data=train,x='Loan_Status',ax=axes[idx])\n\nprint(train[numerical_columns].describe())\nplt.subplots_adjust(hspace=1)","8ddaa518":"test[\"Total_Income\"]=(test[\"ApplicantIncome\"]+test[\"CoapplicantIncome\"])\n# train[\"LoanAmount\"]=train[\"LoanAmount\"]*12\n# train[\"EMI\"]=train[\"LoanAmount\"]\/12\n# train[\"Balance_Income\"] = train[\"Total_Income\"]-(train[\"EMI\"]*12)\ntest[\"Income_Loan_Amount_Ratio\"]=test[\"Total_Income\"]\/test[\"LoanAmount\"]\n# train[\"ApplicantIncome_Loan_Amount_Ratio\"]=train[\"ApplicantIncome\"]\/train[\"LoanAmount\"]\n# train[\"Income_credit_history_ratio\"]=train[\"Total_Income\"]*(train[\"Credit_History\"]+1)\n# train[\"Amount_credit_history_ratio\"]=train[\"LoanAmount\"]*(train[\"Credit_History\"]+1)\n# train[\"Balance_Income_loan_Amount\"]=train[\"Balance_Income\"]\/(train[\"LoanAmount\"])\n# train[\"Balance_Income_EMI\"]=train[\"Balance_Income\"]\/(train[\"EMI\"])\n# train[\"Income_Balance_Income_Ratio\"]=train[\"Total_Income\"]\/train[\"Balance_Income\ntest.columns","8153d601":"train_encoded = pd.get_dummies(train,drop_first=True)\ntrain_encoded.head()\n","d6d86a05":"test_encoded = pd.get_dummies(test,drop_first=True)\ntest_encoded.head()","a29e5e78":"################# Splitting into Train -Test Data #######\nfrom sklearn.model_selection import train_test_split\n\n########## Split Features and Target Varible ############\nX = train_encoded.drop(columns='Loan_Status_Y')\ny = train_encoded[['Loan_Status_Y']]\n\n################# Splitting into Train -Test Data #######\nfrom sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,stratify =y,random_state =42)\n","1ac6d598":"y.head()","8585f644":"X_train.shape,X_test.shape,y_train.shape,y_test.shape","aac59f54":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score,f1_score\nLR_model = LogisticRegression(random_state=1)\nLR_model.fit(X_train,y_train)\nLR_prediction_result=LR_model.predict(X_test)\n\nLR_score_logistic =accuracy_score(LR_prediction_result,y_test)*100 \nLR_score_logistic\n\nprint(\"Training Data Set Accuracy: \", LR_score_logistic)\nprint(\"Training Data F1 Score \", f1_score(LR_prediction_result,y_test)*100)","31ef5f38":"# LR with Stratified K-fold\n\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score,f1_score\nfrom sklearn.model_selection import StratifiedKFold\nfrom statistics import mean, stdev\n\nLR_model = LogisticRegression(random_state=42)\n# LR_model.fit(X_train,y_train)\n# LR_prediction_result=LR_model.predict(X_test)\n\n# Create StratifiedKFold object. \nskf = StratifiedKFold(n_splits=10, shuffle=True, random_state=42) \nlst_accu_stratified = [] \n   \nfor train_index, test_index in skf.split(X, y): \n    X_train_fold, X_test_fold = X.loc[train_index], X.loc[test_index] \n    y_train_fold, y_test_fold = y.loc[train_index], y.loc[test_index] \n    LR_model.fit(X_train_fold, y_train_fold)\n#     lst_accu_stratified.append(LR_model.score(X_test_fold, y_test_fold)) \n    LR_prediction_result=LR_model.predict(X_test_fold)\n    lst_accu_stratified.append(accuracy_score(LR_prediction_result,y_test_fold)*100) \n   \n# Print the output. \nprint('List of possible accuracy:', lst_accu_stratified) \nprint('\\nMaximum Accuracy That can be obtained from this model is:', \n      max(lst_accu_stratified), '%') \nprint('\\nMinimum Accuracy:', \n      min(lst_accu_stratified), '%') \nprint('\\nOverall Accuracy:', \n      mean(lst_accu_stratified), '%') \n# LR_score_logistic =accuracy_score(LR_prediction_result,y_test)*100 \n# LR_score_logistic\n\n# print(\"Training Data Set Accuracy: \", LR_score_logistic)\n# print(\"Training Data F1 Score \", f1_score(LR_prediction_result,y_test)*100)","7e92685c":"LR_prediction_result_test=LR_model.predict(test_encoded)","ca16b53b":"LR_prediction_result_test","ea131943":"from sklearn.tree import DecisionTreeClassifier\nDT_model = DecisionTreeClassifier(random_state=1)\nDT_model.fit(X_train,y_train)\nDT_prediction_result=DT_model.predict(X_test)\nDT_score =accuracy_score(DT_prediction_result,y_test)*100 \nDT_score","1da0373f":"DT_prediction_result_test=DT_model.predict(test_encoded)","ae5dc8bc":"DT_prediction_result_test","f1f3e58c":"from sklearn.ensemble import RandomForestClassifier\nRF_model = RandomForestClassifier(random_state=1,max_depth=10,n_estimators=50)\nRF_model.fit(X_train,y_train)\nRF_prediction_result=RF_model.predict(X_test)\nRF_score = accuracy_score(RF_prediction_result,y_test)*100\nRF_score","20d402a8":"RF_prediction_result_test=RF_model.predict(test_encoded)","a4a8a84e":"RF_prediction_result_test","f980b31e":"importances = pd.Series(RF_model.feature_importances_,index=X.columns)\nimportances.plot(kind='barh', figsize=(12,8))","f884d26f":"from sklearn.neighbors import KNeighborsClassifier\nknn_model = KNeighborsClassifier(n_neighbors=3)\nknn_model.fit(X_train,y_train)\nKNN_prediction_result=knn_model.predict(X_test)\nKNN_score = accuracy_score(KNN_prediction_result,y_test)*100\nKNN_score","5a8ee2c8":"KNN_prediction_result_test=knn_model.predict(test_encoded)","6bf52802":"KNN_prediction_result_test","20bddc12":"from sklearn.naive_bayes import GaussianNB\nNB_model = GaussianNB()\nNB_model.fit(X_train,y_train)\nNB_prediction_result=NB_model.predict(X_test)\nNB_score = accuracy_score(NB_prediction_result,y_test)*100\nNB_score","8413e73c":"NB_prediction_result_test=knn_model.predict(test_encoded)","d67434cc":"NB_prediction_result_test","dd34d062":"# Splitting data","f743cb49":"# Dropping unnecessary columns","b870acd4":"Now we will see the LoanAmount variable. As it is a numerical variable, we can use mean or median to impute the missing values.\n\nWe will use median to fill the null values as earlier we saw that loan amount have outliers so the mean will not be the proper approach as it is highly affected by the presence of outliers.","6d44a0b8":"# Logistic Regression","2b66f442":"# New feature derivation","e0191805":"# Imputation of missing values","d342ffe2":"For Numercical Columns, there is no significant relation to Loan approval status.","28743ff3":"# K- Nearest Neighbours","f0dd4760":"# Decision Trees","cd854c2d":"# Naive Bayes","e05b0a65":"Total_Income = ApplicantIncome + CoapplicantIncome\nIncome_Loan_Amount_Ratio = Total_Income \/ LoanAmount","66cb1c64":"# Random Forest","978f2214":"# Encoding","3e71eea2":"# AN APPROACH FOR PREDICTION OF LOAN ELIGIBILITY IN BANKING SYSTEM USING MACHINE LEARNING CLASSIFICATION ALGORITHMs"}}