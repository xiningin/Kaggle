{"cell_type":{"def845f1":"code","6e3c2edf":"code","d458c8d6":"code","6f24ca82":"code","407cac60":"code","a0ea0ae3":"code","14156e04":"code","8392bb3a":"code","92a9ccde":"code","1c2860ca":"code","3f7c69cc":"code","a891034c":"code","e34662ff":"code","c84759a8":"code","2605947e":"code","25630f6b":"code","8389d728":"code","373a4924":"code","59dba964":"code","a34951bf":"code","29fcab2f":"code","a95744ea":"code","687ceb86":"code","53a5caf2":"code","2f440262":"code","0be5dd46":"code","3f3db2af":"code","58d3175a":"code","69d286df":"code","3540ad5f":"code","6db49fe9":"code","64ebec5e":"code","7c0008af":"code","8410a99d":"code","b630d95a":"code","1ff74493":"code","513a7c80":"code","b76d1acd":"code","eb69f524":"code","337c7874":"code","0a32b598":"code","4f54cfc2":"code","e6b31d57":"code","7970cf87":"code","f087e8b7":"code","a0ef43fe":"code","b206298a":"markdown"},"source":{"def845f1":"!pip install autoviz\n!pip install auto-sklearn\n#pip install delayed","6e3c2edf":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport missingno as msno\nimport warnings\n\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.model_selection import StratifiedKFold\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import linear_model\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.metrics import classification_report, confusion_matrix\nfrom sklearn.metrics import mean_squared_error\nimport plotly.express as px\nimport plotly.figure_factory as ff\nimport plotly.graph_objs as go\nimport sys","d458c8d6":"data = pd.read_csv('..\/input\/fetal-health-classification\/fetal_health.csv')\ndata.head()","6f24ca82":"data.describe().T\n","407cac60":"data.info()","a0ea0ae3":"data.isnull().sum()","14156e04":"from pandas_profiling import ProfileReport\n\nprofile = ProfileReport(data)\nprofile","8392bb3a":"corrmat = data.corr()\nplt.subplots(figsize=(18,18))\nsns.heatmap(corrmat,annot=True, square=True, vmin=0, vmax=1,cmap=\"YlGnBu\");","92a9ccde":"from autoviz.AutoViz_Class import AutoViz_Class\nAV = AutoViz_Class()\ntarget='fetal_health'\ndfv = AV.AutoViz(filename=\"\",sep=',', depVar=target, dfte=data, header=0, verbose=1, \n                 lowess=False, chart_format='svg', max_rows_analyzed=150000, max_cols_analyzed=30)","1c2860ca":"histogram=px.histogram(data_frame=data,x=\"histogram_variance\",nbins=100)\n\n\nhistogram.show()","3f7c69cc":"histogram=px.histogram(data_frame=data,x=\"abnormal_short_term_variability\",nbins=100,color=\"fetal_health\")\n\n\nhistogram.show()","a891034c":"histogram=px.histogram(data_frame=data,x=\"baseline value\",nbins=100,color=\"fetal_health\",marginal=\"rug\")\n\n\nhistogram.show()","e34662ff":"histogram=px.histogram(data_frame=data,x=\"histogram_mode\",nbins=100,color=\"fetal_health\",marginal=\"box\")\n\n\nhistogram.show()","c84759a8":"hist_data =[data[\"histogram_mode\"].values]\ngroup_labels = ['histogram_mode'] \nff.create_distplot(hist_data, group_labels)","2605947e":"ax=data[\"fetal_health\"].value_counts().plot(figsize=(10, 10), kind=\"bar\")","25630f6b":"total = data[\"fetal_health\"].sum()\nnormal = total - 471\nsuspect = total - 1831\npathological = total - 1950","8389d728":"plt.figure(figsize = (12,12))\n\nax = plt.pie([normal, suspect, pathological], labels=[\"Normal\", \"Suspect\", \"Pathological\"], colors = [\"#5F9EA0\", \"#B0E0E6\", \"#ADD8E6\"], autopct=\"%1.0f%%\")","373a4924":"data.hist(figsize = (20,20), color = \"#FFC300\")\n","59dba964":"from pandas.plotting import scatter_matrix\n\nscatterMatrix = scatter_matrix(data,figsize=(50, 50), color = \"#FFC300\")\n","a34951bf":"sns.lmplot(data =data,x=\"accelerations\",y=\"fetal_movement\",palette=\"viridis\", hue=\"fetal_health\",legend_out=False)\nplt.show()","29fcab2f":"sns.lmplot(data =data,x=\"prolongued_decelerations\",y=\"fetal_movement\",palette=\"viridis\", hue=\"fetal_health\",legend_out=False)\nplt.show()","a95744ea":"data.columns","687ceb86":"cols=['baseline value', 'accelerations', 'fetal_movement',\n       'uterine_contractions', 'light_decelerations', 'severe_decelerations',\n       'prolongued_decelerations', 'abnormal_short_term_variability',\n       'mean_value_of_short_term_variability',\n       'percentage_of_time_with_abnormal_long_term_variability',\n       'mean_value_of_long_term_variability']","53a5caf2":"for i in cols:\n    sns.swarmplot(x=data[\"fetal_health\"], y=data[i], color=\"black\", alpha=0.5 )\n    sns.boxenplot(x=data[\"fetal_health\"], y=data[i], palette=\"viridis\")\n    plt.show()","2f440262":"shades =[\"#f7b2b0\",\"#c98ea6\",\"#8f7198\",\"#50587f\", \"#003f5c\"]\nplt.figure(figsize=(20,10))\nsns.boxenplot(data = data,palette = \"viridis\")\nplt.xticks(rotation=90)\nplt.show()","0be5dd46":"from scipy.stats import probplot,skew\n\nfor i in cols:\n    fig, axes = plt.subplots(1, 3, figsize=(20,4))\n    sns.distplot(data[i],kde=False, ax=axes[0])\n    sns.boxplot(data[i], ax=axes[1])\n    probplot(data[i], plot=axes[2])\n    skew_val=round(data[i].skew(), 1)\n    axes[1].set_yticklabels([])\n    axes[1].set_yticks([])\n    axes[0].set_title(i + \" | Distplot\")\n    axes[1].set_title(i + \" | Boxplot\")\n    axes[2].set_title(i + \" | Probability Plot - Skew: \"+str(skew_val))\n    plt.show()","3f3db2af":"features = ['baseline value', 'accelerations', 'fetal_movement',\n       'uterine_contractions', 'light_decelerations', 'severe_decelerations',\n       'prolongued_decelerations', 'abnormal_short_term_variability',\n       'mean_value_of_short_term_variability',\n       'percentage_of_time_with_abnormal_long_term_variability',\n       'mean_value_of_long_term_variability', 'histogram_width',\n       'histogram_min', 'histogram_max', 'histogram_number_of_peaks',\n       'histogram_number_of_zeroes', 'histogram_mode', 'histogram_mean',\n       'histogram_median', 'histogram_variance', 'histogram_tendency']","58d3175a":"X = pd.DataFrame(data=data, columns=features)\ny = pd.DataFrame(data=data, columns=['fetal_health'])\ny = y.astype(int)","69d286df":"X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42, test_size=0.30)","3540ad5f":"knn=KNeighborsClassifier()\nknn.fit(X_train,y_train)\npred=knn.predict(X_test)","6db49fe9":"print(classification_report(y_test, pred))\n","64ebec5e":"cm = confusion_matrix(y_test, pred)\ncm","7c0008af":"parameters = {'n_neighbors':[4,5,6,7],\n              'leaf_size':[1,3,5],\n              'algorithm':['auto', 'kd_tree'],\n              'n_jobs':[-1]}\n\n#Fit the model\nmodel = GridSearchCV(knn, param_grid=parameters)\nmodel.fit(X_train,y_train)","8410a99d":"model.best_params_","b630d95a":"model.best_score_ ","1ff74493":"best_model=KNeighborsClassifier(leaf_size=1,n_neighbors=5)\nbest_model.fit(X_train,y_train)","513a7c80":"pred=best_model.predict(X_test)","b76d1acd":"print(classification_report(y_test, pred))\n","eb69f524":"cm = confusion_matrix(y_test, pred)\ncm","337c7874":"def plot_confusion_matrix(cm, classes, normalized=True, cmap='bone'):\n    plt.figure(figsize=[7, 6])\n    norm_cm = cm\n    if normalized:\n        norm_cm = cm.astype('float') \/ cm.sum(axis=1)[:, np.newaxis]\n        sns.heatmap(norm_cm, annot=cm, fmt='g', xticklabels=classes, yticklabels=classes, cmap=cmap)\n\nplot_confusion_matrix(cm, ['Normal', 'Suspect', 'Pathological'])","0a32b598":"from sklearn.ensemble import RandomForestRegressor\n\nmodel_base= RandomForestRegressor(random_state = 42,max_depth=5,max_features=\"auto\",n_estimators=5)\nmodel_base.fit(X_train, y_train)\npred = model_base.predict(X_test)\n","4f54cfc2":"\ntest_pred = model_base.predict(X_test)\ntrain_pred = model_base.predict(X_train)","e6b31d57":"feature_names = ['baseline value', 'accelerations', 'fetal_movement',\n       'uterine_contractions', 'light_decelerations', 'severe_decelerations',\n       'prolongued_decelerations', 'abnormal_short_term_variability',\n       'mean_value_of_short_term_variability',\n       'percentage_of_time_with_abnormal_long_term_variability',\n       'mean_value_of_long_term_variability', 'histogram_width',\n       'histogram_min', 'histogram_max', 'histogram_number_of_peaks',\n       'histogram_number_of_zeroes', 'histogram_mode', 'histogram_mean',\n       'histogram_median', 'histogram_variance', 'histogram_tendency']\n\ntarget_names = [\"fetal_health\"]\n","7970cf87":"importances = model_base.feature_importances_\nindices = np.argsort(importances)\n\nplt.figure(figsize=(16,8))\n\nplt.title('Feature Importances')\nplt.barh(range(len(indices)), importances[indices], color='r', align='center',)\nplt.yticks(range(len(indices)), [feature_names[i] for i in indices])\nplt.xlabel('Relative Importance')\n\nplt.yticks( horizontalalignment='right', fontweight='light')\nplt.ylabel('Importance'); plt.title('Variable Importances');plt.yticks(size=15)\nplt.tight_layout()\n\nplt.show()","f087e8b7":"from sklearn import tree\n\nplt.figure(figsize=(15,10))\nax=tree.plot_tree(model_base.estimators_[1], filled=True)\nplt.show()","a0ef43fe":"plt.figure(figsize=(20,20))\nfor i in range(len(model_base.estimators_)):\n    tree.plot_tree(model_base.estimators_[i],filled=True)\n    plt.savefig('fig'+str(i))\n    plt.show()","b206298a":"# models"}}