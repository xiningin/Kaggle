{"cell_type":{"2f7146a9":"code","26605318":"code","01b0e2d7":"code","c03db7f9":"code","45929302":"code","e8e521b9":"code","d1f2ab35":"code","e403ac80":"code","3ee59df7":"code","b4460c2e":"code","3c66bba1":"code","6b79b92a":"code","a265675e":"code","eaca6b54":"code","0d5e45fd":"code","d76b1bdd":"code","1ed04e28":"code","01ac5ae0":"code","144490cc":"code","9d465a34":"code","4cb35437":"code","c3b0a8a2":"code","f55c9204":"code","5e32a489":"code","d8a406b2":"code","0e4ebb2e":"code","97ab3477":"code","4306e7f7":"code","2d21120d":"code","bca89411":"code","0bcfcdd0":"code","a124b542":"code","07dfe41d":"code","6c19a417":"code","9b6e4f84":"code","975f93ab":"code","de15e330":"code","bacbfbd5":"code","2ca318d6":"code","c4f6a986":"markdown","8394ff10":"markdown","06d09e06":"markdown"},"source":{"2f7146a9":"import numpy as np\nimport pandas as pd\nfrom nltk.corpus import stopwords\nimport string\nfrom nltk.stem import WordNetLemmatizer","26605318":"data=pd.read_csv('..\/input\/nlp-getting-started\/train.csv',index_col=0)\ntest=pd.read_csv('..\/input\/nlp-getting-started\/test.csv',index_col=0)","01b0e2d7":"data.fillna('',inplace=True)","c03db7f9":"test.fillna('',inplace=True)","45929302":"data.head()","e8e521b9":"test.head()","d1f2ab35":"finaldata=data['keyword']+' '+data['location']+' '+data['text']\ntestdata=test['keyword']+' '+test['location']+' '+test['text']\nfinaltarget=data['target']","e403ac80":"finaldata.head()","3ee59df7":"testdata.head()","b4460c2e":"finaltarget.head()","3c66bba1":"WNL=WordNetLemmatizer()\ndef text_process(data):\n    msg=[c for c in data if c not in string.punctuation]\n    msg=''.join(msg)\n    msg=[word for word in msg.split() if word.lower() not in stopwords.words('english')]\n    msg=[WNL.lemmatize(word) for word in msg ]\n    return msg","6b79b92a":"finaldata.head(10).apply(text_process)","a265675e":"from sklearn.feature_extraction.text import CountVectorizer,TfidfTransformer","eaca6b54":"CV=CountVectorizer(analyzer=text_process)","0d5e45fd":"CV.fit(finaldata)","d76b1bdd":"CV.vocabulary_","1ed04e28":"finaldata=CV.transform(finaldata)","01ac5ae0":"finaldata.nnz","144490cc":"Tfidf=TfidfTransformer()\nTfidf.fit(finaldata)\nTfidf_val=Tfidf.transform(finaldata)","9d465a34":"testdata=CV.transform(testdata)\ntestdata=Tfidf.transform(testdata)","4cb35437":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.naive_bayes import MultinomialNB","c3b0a8a2":"sentiment=MultinomialNB()\nsentiment.fit(Tfidf_val,finaltarget)\nresult1=sentiment.predict(testdata)\n\nRFC=RandomForestClassifier()\nRFC.fit(Tfidf_val,finaltarget)\nresult2=RFC.predict(testdata)","f55c9204":"rslt=pd.DataFrame(index=test.index)\nrslt['Naive Bayes']=result1\nrslt['Random Forest']=result2","5e32a489":"rslt['Naive Bayes'].value_counts()","d8a406b2":"rslt['Random Forest'].value_counts()","0e4ebb2e":"from sklearn.svm import SVC","97ab3477":"svc=SVC()","4306e7f7":"svc.fit(Tfidf_val,finaltarget)\nsvm=svc.predict(testdata)","2d21120d":"rslt['svm']=svm","bca89411":"rslt['svm'].value_counts()","0bcfcdd0":"from sklearn.model_selection import GridSearchCV\ngrid={'C':[0.01,0.1,1,10,100],'gamma':[0.001,.01,0.1,1,10]}","a124b542":"g=GridSearchCV(SVC(),grid,verbose=2)","07dfe41d":"g.fit(Tfidf_val,finaltarget)","6c19a417":"g.best_estimator_","9b6e4f84":"grid=g.predict(testdata)","975f93ab":"rslt['grid']=grid","de15e330":"rslt['grid'].value_counts()","bacbfbd5":"rslt.head()","2ca318d6":"#rslt.to_csv('prediction.csv')","c4f6a986":"### With Grid Search","8394ff10":"# Support Vector Machine","06d09e06":"# Naive Bayes & Random Forest"}}