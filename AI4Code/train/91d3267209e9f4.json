{"cell_type":{"548d8846":"code","6636ded8":"code","7e3ebcba":"code","e074dce9":"code","8d0f70d7":"markdown"},"source":{"548d8846":"import pandas as pd\nimport numpy as np\nimport random as rnd\n\n# visualization\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n","6636ded8":"import pandas as pd\n# acidentes2018_todas_causas_tipos = pd.read_csv(\"..\/input\/acidentes2018_todas_causas_tipos.csv\",encoding='latin',low_memory=False)\ndatatran2017 = pd.read_csv(\"..\/input\/datatran2017.csv\",encoding='latin',sep=\";\",error_bad_lines=False)\ndatatran2018 = pd.read_csv(\"..\/input\/datatran2018.csv\",encoding='latin',sep=\";\",error_bad_lines=False)\ndatatran2019 = pd.read_csv(\"..\/input\/datatran2019.csv\",encoding='latin',sep=\";\",error_bad_lines=False)\n\ndados = [datatran2017,datatran2018,datatran2019]\ndataset = 1","7e3ebcba":"fase_dia={'(null)':None,\n          'Amanhecer':'Dawn',\n          'Anoitecer':'Nightfall',\n          'Plena noite':'Full night',\n          'Pleno dia':'Full day'}\n\n\ndia_semana={'Segunda':'Monday',\n            'Ter\u00e7a':'Tuesday',\n            'Quarta':'Wednesday',\n            'Quinta':'Thursday',\n            'Sexta':'Friday',\n            'S\u00e1bado':'Saturday',\n            'Domingo':'Sunday'}\nfor dataset in range(len(dados)):\n    dados[dataset]['data_inversa'] =  pd.to_datetime(pd.Series(dados[dataset]['data_inversa']), format=\"%Y-%m-%d\")\n    dados[dataset]['horario'] =  pd.to_datetime(pd.Series(dados[dataset]['horario']), format=\"%H:%M:%S\")\n    dados[dataset]['horario'] =  dados[dataset]['horario'].apply(lambda x: x.strftime('%H'))\n\n    dados[dataset]['fase_dia'] = dados[dataset]['fase_dia'].map(fase_dia).astype(str)\n    dados[dataset]['dia_semana'] = dados[dataset]['dia_semana'].map(dia_semana).astype(str)\n\n","e074dce9":"g = {}\nplot = []\n\n\n\nfor datset in range(len(dados)):\n    g[dataset]= dados[dataset].groupby(['horario','data_inversa'],as_index=False).count().iloc[:,range(3)]\n    g[dataset] = g[dataset].dropna()\n    g[dataset].rename(columns={'id':'total'},inplace=True)\n    g[dataset]['Month'] = g[dataset]['data_inversa'].apply(lambda x: x.strftime('%m %B'))\n    plot.append(pd.pivot_table(g[dataset], values='total', index=['Month'] , columns=['horario'], aggfunc=np.sum))\n\nfig = {}\nfor dataset in range(len(plot)):\n    fig[dataset]=plt.figure()\n    if dataset ==0:\n        ano = \"2017\"\n    elif dataset == 1:\n        ano = \"2018\"\n    else:\n        ano = \"2019\"\n    ax = fig[dataset].add_subplot(1, 1, 1)\n    ax.set_title(label=\"Acidentes Por Hor\u00e1rio e M\u00eas : Ano \"+ ano)\n    ax = sns.heatmap(plot[dataset],linewidths=.2,cmap='inferno_r')    \n    \nplt.show()\n\n\n\n","8d0f70d7":"## the csv data can be found in https:\/\/www.prf.gov.br\/portal\/dados-abertos\/acidentes "}}