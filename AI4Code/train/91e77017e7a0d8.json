{"cell_type":{"2ff7fd86":"code","c22489cf":"code","1380dbee":"code","68cc8d1a":"code","137aeefa":"code","3a87d2cb":"code","9ad84548":"code","4f53c6ac":"code","03282c77":"code","d3c237c2":"markdown"},"source":{"2ff7fd86":"# This Python 3 environment comes with many helpful analytics libraries installed\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom sklearn.linear_model import ElasticNet\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error","c22489cf":"train = pd.read_csv('\/kaggle\/input\/petfinder-pawpularity-score\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/petfinder-pawpularity-score\/test.csv')\n","1380dbee":"train['Pawpularity'] = (train['Pawpularity']-min(train['Pawpularity']))\/(max(train['Pawpularity'])-min(train['Pawpularity']))\n#m = (x -xmin) \/ (xmax -xmin)\n#y_unscaled = (train['Pawpularity']*(100-1))+1 ","68cc8d1a":"# define data\nx = train.drop(columns='Id').iloc[:,:12]\ny = train['Pawpularity']","137aeefa":"# split data\nx_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.0001,random_state=5)","3a87d2cb":"len(y_test)","9ad84548":"# modeling\nregr = ElasticNet(alpha=0.7, l1_ratio=0.2, random_state=0)\nregr.fit(x_train,y_train)","4f53c6ac":"# get coef,intercept\ny_pre = regr.predict(x_test)\ntest_pre = regr.predict(test.iloc[:,1:])\nmse = mean_squared_error(y_test,y_pre)\nrmse = np.sqrt(mse)\nrmse","03282c77":"test['Pawpularity'] = (test_pre*(100-1))+1\ntest\nsubmission = test.drop(columns=['Subject Focus','Eyes','Face','Action','Accessory','Group','Collage','Human','Occlusion','Info','Blur','Near'],axis=0)\nsubmission.to_csv('submission.csv', index=False)","d3c237c2":"test"}}