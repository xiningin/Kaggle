{"cell_type":{"456cab0f":"code","7be018e6":"code","dcf8a093":"code","3a298f88":"code","806fa633":"code","aa61ee4b":"code","76174986":"code","520131e7":"code","9d975a65":"code","5d230bef":"code","cd57c672":"code","03a75f08":"code","e4f50f6b":"code","ff53919e":"code","856eed93":"code","119ede5c":"code","fe006955":"code","4f6e372a":"code","e8831e12":"code","c3003859":"code","3504849e":"code","7f3001fe":"code","46cc9c20":"code","82522fc6":"code","7a116a15":"code","864500dd":"code","f83fe04b":"code","2c3a68f9":"code","7fb3da02":"code","6183a982":"code","a81ca34d":"code","3440b047":"code","73dd34af":"code","75da2147":"code","741e19ed":"code","21c9cf6d":"code","54dabcc9":"code","f5b8c94d":"code","ef5a4bef":"code","c6d1552e":"code","57eab551":"code","653afc77":"code","b9420329":"code","3ba66bbf":"code","0885e1f3":"code","fcf216f1":"code","4b2e71ca":"code","6d449e0b":"markdown","aa76a7cc":"markdown","61b4236d":"markdown","4618c39d":"markdown","0e2982a8":"markdown","8243823a":"markdown","59b18344":"markdown","dc29df5e":"markdown","4d968c9a":"markdown","95f77d13":"markdown","524f0690":"markdown","d12b3ff6":"markdown"},"source":{"456cab0f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","7be018e6":"train_df= pd.read_csv('\/kaggle\/input\/hackerearth-machine-learning-exhibit-art\/dataset\/train.csv')\n\ntest_df = pd.read_csv('\/kaggle\/input\/hackerearth-machine-learning-exhibit-art\/dataset\/test.csv')\nsubmit = pd.read_csv('\/kaggle\/input\/hackerearth-machine-learning-exhibit-art\/dataset\/sample_submission.csv')","dcf8a093":"train_df.isnull().sum()","3a298f88":"train_df['Artist Reputation'] = train_df['Artist Reputation'].fillna(train_df['Artist Reputation'].mode()[0])\n\ntrain_df['Height'] = train_df['Height'].fillna(train_df['Height'].mode()[0])\ntrain_df['Width'] = train_df['Width'].fillna(train_df['Width'].mode()[0])\ntrain_df['Weight'] = train_df['Weight'].fillna(train_df['Weight'].mode()[0])\ntrain_df['Material'] = train_df['Material'].fillna(train_df['Material'].mode()[0])\ntrain_df['Transport'] = train_df['Transport'].fillna(train_df['Transport'].mode()[0])\ntrain_df['Remote Location'] = train_df['Remote Location'].fillna(train_df['Remote Location'].mode()[0])","806fa633":"train_df[['Artist Reputation','Artist Name']].value_counts()","aa61ee4b":"train_df.isnull().sum()","76174986":"train_df.head()","520131e7":"test_df['Artist Reputation'] = test_df['Artist Reputation'].fillna(test_df['Artist Reputation'].mode()[0])\n\ntest_df['Height'] = test_df['Height'].fillna(test_df['Height'].mode()[0])\ntest_df['Width'] = test_df['Width'].fillna(test_df['Width'].mode()[0])\ntest_df['Weight'] = test_df['Weight'].fillna(test_df['Weight'].mode()[0])\n\ntest_df['Transport'] = test_df['Transport'].fillna(test_df['Transport'].mode()[0])\n","9d975a65":"df = pd.concat([train_df.drop('Cost',axis=1),test_df],axis=0)","5d230bef":"df.isnull().sum()","cd57c672":"df.describe()\nprint(df.shape,train_df.shape,test_df.shape)","03a75f08":"sns.boxplot(x=df['Height'])","e4f50f6b":"#df = df.drop(['Artist Name'],axis=1)\nprint(\"Skewness: %f\" % train_df['Cost'].skew())\nprint(\"Kurtosis: %f\" % train_df['Cost'].kurt())\nlen(df)\nskewed_features = df.select_dtypes(exclude='object').apply(lambda x: x.skew()).sort_values(ascending=False)\nprint(skewed_features)","ff53919e":"q25,q75 = np.percentile(df.Height,[25,75])\nq25,q75","856eed93":"df.Height = [df.Height.mode()[0] if i >46 else i for i in df.Height]\ndf.Weight = [df.Weight.mode()[0] if i >54153 else i for i in df.Weight]\ndf.Width = [df.Width.mode()[0] if i >16 else i for i in df.Width]\ndf['Price Of Sculpture'] = [df['Price Of Sculpture'].mode()[0] if i >16 else i for i in df['Price Of Sculpture']]\n\n","119ede5c":"sns.boxplot(x=df['Height'])\n","fe006955":"import datetime as datetime\nfrom datetime import date\n","4f6e372a":"t1 = pd.to_datetime(df['Scheduled Date']) \nt2 = pd.to_datetime(df['Delivery Date'])","e8831e12":"df['delay'] = (t1 - t2).dt.days\ndf.delay \n","c3003859":"# droping Unique features ......\n\n\ndf = df.drop(['Customer Location','Scheduled Date','Delivery Date','Customer Id','Artist Name'],axis=1)\n\ndf.head()\n\n\n","3504849e":"df.head()","7f3001fe":"#sns.distplot(train_df.Cost)\n#sns.jointplot(y=train_df.Cost,x=np.arange(0,6500))","46cc9c20":"# correlation heatmap for all features\nplt.figure(figsize=(12,6))\ncorr = train_df.corr()\nmask = np.zeros_like(corr, dtype=np.bool)\nmask[np.triu_indices_from(mask)] = True\nsns.heatmap(corr, mask = mask, annot=True)\nplt.show()","82522fc6":"from sklearn.preprocessing import LabelEncoder,OneHotEncoder\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.pipeline import make_pipeline ,Pipeline\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score , mean_squared_error","7a116a15":"from sklearn.compose import make_column_transformer\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.preprocessing import OneHotEncoder,StandardScaler,MinMaxScaler,minmax_scale\nfrom sklearn.model_selection import train_test_split , cross_val_score\nfrom sklearn.feature_selection import SelectKBest\nfrom sklearn.metrics import mean_squared_log_error\nfrom sklearn.model_selection import validation_curve\n\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import GridSearchCV ,RandomizedSearchCV\nfrom sklearn.tree import plot_tree\nfrom sklearn.ensemble import RandomForestRegressor,AdaBoostRegressor,GradientBoostingRegressor\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.svm import SVR\nfrom sklearn.linear_model import LogisticRegression","864500dd":"train_df.shape,test_df.shape,df.shape","f83fe04b":"# functions must use \ndef log1p(vec):\n    return np.log1p(abs(vec))\n\ndef expm1(x):\n    return np.expm1(x)\n\n","2c3a68f9":"one = OneHotEncoder()\nscaler =MinMaxScaler()\nRFR = RandomForestRegressor()\nfs = SelectKBest()","7fb3da02":"\nprint(df.select_dtypes(include='object').columns)\ndf.select_dtypes(exclude='object').columns","6183a982":"ct = make_column_transformer((one,['Material', 'International', 'Express Shipment',\n                             'Installation Included', 'Transport', 'Fragile', 'Customer Information','Remote Location']),\n                             (scaler,['Artist Reputation', 'Height', 'Width', 'Weight', 'Price Of Sculpture','Base Shipping Price']),\n                             remainder ='passthrough')","a81ca34d":"# separate train and test sets\nX_train=df[:6500]\nXf_test =df[6500:]\n\ny=train_df['Cost']\ny=log1p(y)\nX_train,X_test,y_train,y_test = train_test_split(X_train,y,test_size=0.1,random_state=42)","3440b047":" \nlinear = LinearRegression()\nrandom = RandomForestRegressor(n_estimators=100,random_state=42,n_jobs=-1,max_features=4)\ndecision = DecisionTreeRegressor( criterion=\"friedman_mse\", splitter= 'random')","73dd34af":"from sklearn.ensemble import StackingRegressor\n\nestimators = [\n        ('RFC' ,RandomForestRegressor(n_estimators=11,criterion=\"friedman_mse\", random_state = 42)),\n        ('LR',  LinearRegression()),\n        ('DTC', DecisionTreeRegressor()),\n        ('SVC', AdaBoostRegressor()),\n        \n]\n\nclf = StackingRegressor(\n    estimators=estimators, \n    final_estimator= GradientBoostingRegressor())","75da2147":"import xgboost as xgb\nxgb = xgb.XGBRegressor(max_depth=3, n_estimators=250, learning_rate=0.01,\n                            n_jobs=-1,random_state=101,subsample=0.8)","741e19ed":"model = make_pipeline(ct,linear)\nmodel.fit(X_train,y_train)\nmodel2 = make_pipeline(ct,random)\nmodel2.fit(X_train,y_train)\n\nmodel3 = make_pipeline(ct,decision)\nmodel3.fit(X_train,y_train)\nmodel4 = make_pipeline(ct,clf)\nmodel4.fit(X_train,y_train)\nmodel5 = make_pipeline(ct,xgb)\nmodel5.fit(X_train,y_train)","21c9cf6d":"models ={'linear':model}\nmodels['random'] = model2\nmodels['decision'] = model3\nmodels['stack']  = model4\nmodels['xgb'] = model5","54dabcc9":"y_pred  = model.predict(X_test)\ny_pred = np.round(expm1(y_pred),2)\ny_pred","f5b8c94d":"def rmse(y_test,y_pred):\n    rmse= np.sqrt(mean_squared_error(y_test,y_pred))\n    return rmse\n\n","ef5a4bef":"models.keys()","c6d1552e":"import plotly.graph_objects as go\n\ndef compare_models(models):\n    training_rmse = [rmse(y_train,model.predict(X_train)) for model in models.values()]\n    validate_rmse = [cross_val_rmse(model) for model in models.values()] \n    testing_rmse = [rmse(y_test,model.predict(X_test)) for model in models.values()]\n    names = list(models.keys())\n    fig = go.Figure([\n                      go.Bar(x=names ,y=training_rmse ,name='traing_rmse'),\n                      go.Bar(x=names ,y=validate_rmse ,name='validate_rmse'),\n                      go.Bar(x=names ,y=testing_rmse ,name='testing_rmse',opacity=.3)])\n    return fig","57eab551":"fig = compare_models(models)\nfig.update_yaxes(range=[2,40],title=\"rmse\")\nfig.show()","653afc77":"model.get_params().keys()","b9420329":"#val = validation_curve(model,X_train,y_train,param_name=\"randomforestregressor__n_estimators\",param_range=np.arange(100,300,100),cv=5)","3ba66bbf":"ys_pred = model.predict(Xf_test)\nys_pred = np.round(expm1(ys_pred),2)\n\nys_pred","0885e1f3":"test_df.head()","fcf216f1":"subb = pd.DataFrame({'Customer Id':test_df['Customer Id'],'Cost':ys_pred})\nsubb.shape","4b2e71ca":"subb.to_csv('hackthon5_1.csv', index=False)","6d449e0b":"## Missing Data","aa76a7cc":"## Submission","61b4236d":"## Datetime","4618c39d":"df.Height = [df.Height.mode()[0] if i >46 else i for i in df.Height]\ndf.Weight = [df.Weight.mode()[0] if i >54153 else i for i in df.Weight]\ndf.Width = [df.Width.mode()[0] if i >16 else i for i in df.Width]\ndf['Price Of Sculpture'] = [df['Price Of Sculpture'].mode()[0] if i >16 else i for i in df['Price Of Sculpture']]\n\n","0e2982a8":"## Insights ....","8243823a":"## What about rmse:)","59b18344":"## Pre_processing:)","dc29df5e":"you can clearly see importance of price price of sculpture","4d968c9a":"## UP Vote if u like :) \n","95f77d13":"## Data sets Loading....","524f0690":"\n\n\n## Outliers handling","d12b3ff6":"## make_pipeline:)"}}