{"cell_type":{"f2b3d6eb":"code","1d656571":"code","f4049cb0":"code","de0518a6":"code","d1536510":"code","daa5ada5":"code","deeebe3a":"code","919adfdd":"code","fffddee8":"code","95d04fb7":"code","9c547cb8":"code","b07a4167":"code","bb0f81c5":"code","72af4f15":"code","83f6d269":"code","fd4b96b3":"code","413861bb":"code","74d09e1a":"code","30454943":"code","e49c0955":"code","c964896f":"code","14e18e4c":"code","be9ade7d":"code","56107303":"code","948608e2":"code","d4b19032":"code","d9349cbc":"code","4b08a51b":"code","49b163d7":"code","22bb88f6":"code","4aac7094":"markdown","70197ed2":"markdown","2cf2ad76":"markdown","90c2508e":"markdown","9ec7cd78":"markdown","85983943":"markdown","cf904f62":"markdown","3dbbff8b":"markdown","14acecbc":"markdown","26b8d3f7":"markdown","2eefc883":"markdown","d35032f3":"markdown","2d3a69db":"markdown","a6caa31d":"markdown","8f5f6487":"markdown"},"source":{"f2b3d6eb":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","1d656571":"import warnings\nwarnings.filterwarnings('ignore') \n\nimport pandas  as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nplt.style.use('fivethirtyeight')","f4049cb0":"df = pd.read_csv('..\/input\/wine-reviews\/winemag-data-130k-v2.csv')\ndf.head()","de0518a6":"df.shape","d1536510":"#Let's drop the id column\ndf.drop(\"Unnamed: 0\",axis=1, inplace=True)","daa5ada5":"#let's drop the duplicates\ndf.drop_duplicates(inplace = True)\nprint(f\"data shape after removing duplicates{df.shape}\")","deeebe3a":"# let's check the distribution of price and points columns\nplt.rcParams['figure.figsize']=15,4\nplt.subplot(121)\nsns.distplot(df['price'])\n\nplt.subplot(122)\nsns.distplot(df['points'])\n\nplt.suptitle('Distribution of wine bottle price and points \\n', fontsize=20)\nplt.show()","919adfdd":"#let's check the impact of rating on price\nplt.rcParams['figure.figsize']=15,5\nsns.barplot(df['points'], df['price'], palette='hot')\nplt.grid()\nplt.title('Impact of points on wine price \\n', fontsize=20)\nplt.show()\n","fffddee8":"z=df.groupby(['country'])['price','points'].mean().reset_index().sort_values('price',ascending=False)\nplt.rcParams['figure.figsize']=(10,15)\nsns.barplot(x = 'price', y=\"country\", data=z, palette='plasma')\nplt.title('Average Wine prices in diffrent countries')\nplt.xlabel('Average wine price')\nplt.ylabel('Countries')\nplt.show()","95d04fb7":"plt.rcParams['figure.figsize']=(6,6)\nsize=df['country'].value_counts().sort_values(ascending=False).head(5)\n\ndef absolute_value(val):\n    a  = np.round(val\/100.*size.sum())\n    return a\n\nplt.pie(size, labels=size.index, autopct=absolute_value, explode = [0,0,0,0,0.1])\n\nplt.title('Top 5 wine manufacturing countries \\n', fontsize=20)\nplt.show()","9c547cb8":"#let's analyze the top countries wine bottles\nTop_countries=('US', 'France', 'Italy', 'Spain', 'Portugal')\ndf_coun=df.loc[df['country'].isin(Top_countries)]\n\nplt.rcParams['figure.figsize']=(15,5)\nsns.barplot(x=df_coun['country'], y=df_coun['price'], palette='plasma')\nplt.title('comparing average wine price between top manufacturing countries')","b07a4167":"df_coun[['country','points']].groupby(['country']).agg(['min',\n                                              'mean', 'max']).style.background_gradient(cmap='viridis')","bb0f81c5":"# let's check the popular grape varities\nplt.rcParams['figure.figsize']=(6,6)\nsize=df['variety'].value_counts().sort_values(ascending=False).head(5)\n\ndef absolute_value(val):\n    a  = np.round(val\/100.*size.sum())\n    return a\n\nplt.pie(size, labels=size.index, autopct=absolute_value, explode = [0,0,0,0,0.1])\n\nplt.title('popularly used wine grape varities \\n', fontsize=20)\nplt.show()","72af4f15":"#let's analyze the top 5 grapes varities used wine bottles price and points given by taster\nTop_grape=('Pinot Noir', 'Chardonnay', 'Cabernet Sauvignon', 'Red Blend', 'Bordeaux-style Red Blend')\ndf_grape=df.loc[df['variety'].isin(Top_grape)]\n\nplt.rcParams['figure.figsize']=(15,5)\nsns.barplot(x=df_grape['variety'], y=df_grape['price'], palette='plasma')\nplt.title('comparing average wine price between popular grape varities')\nplt.show()","83f6d269":"df_grape[['variety','points']].groupby(['variety']).agg(['min',\n                                              'mean', 'max']).style.background_gradient(cmap='viridis')","fd4b96b3":"df['winery'].nunique()","413861bb":"# as we have more wineries in this dataset let's extract top 100 wineries\nTop_winery = df['winery'].value_counts().sort_values(ascending=False).head(100).index.tolist()\ndf_winery=df.loc[df['winery'].isin(Top_winery)]\n","74d09e1a":"plt.rcParams['figure.figsize']=15,6\nsns.boxplot(x=df_winery['country'], y=df_winery['price'])\nplt.title(\"Price distribution of wine bottles in each country from the top 100 wineries\")\nplt.xticks(rotation = 70)\nplt.show()","30454943":"plt.rcParams['figure.figsize']=15,6\nsns.violinplot(x=df_winery['country'], y=df_winery['points'])\nplt.title(\"Points distribution of wine bottles in each country from the top 100 wineries\")\nplt.xticks(rotation = 70)\nplt.show()","e49c0955":"# let's check the popular taster name\nplt.rcParams['figure.figsize']=(6,6)\nsize=df['taster_name'].value_counts().sort_values(ascending=False).head(5)\n\ndef absolute_value(val):\n    a  = np.round(val\/100.*size.sum())\n    return a\n\nplt.pie(size, labels=size.index, autopct=absolute_value, explode = [0,0,0,0,0.1])\n\nplt.title('Popular Wine Tasters \\n', fontsize=20)\nplt.show()","c964896f":"df_rv = df.loc[df['taster_name'].isin(['Roger Voss'])]\ndf_ms = df.loc[df['taster_name'].isin(['Michael Schachner'])]\ndf_kk = df.loc[df['taster_name'].isin([\"Kerin O\u2019Keefe\"])]\ndf_pg = df.loc[df['taster_name'].isin(['Paul Gregutt'])]\ndf_vb = df.loc[df['taster_name'].isin(['Virginie Boone'])]","14e18e4c":"plt.rcParams['figure.figsize']=15,25\nplt.subplot(521)\nsns.distplot(df_rv['price'])\nplt.title('Roger Voss')\nplt.subplot(522)\nsns.distplot(df_rv['points'])\n\nplt.subplot(523)\nsns.distplot(df_ms['price'], color= 'red')\nplt.title('Michael Schachner')\nplt.subplot(524)\nsns.distplot(df_ms['points'], color= 'red')\n\nplt.subplot(525)\nsns.distplot(df_kk['price'], color= 'blue')\nplt.title(\"Kerin O'Keefe\")\nplt.subplot(526)\nsns.distplot(df_kk['points'], color= 'blue')\n\nplt.subplot(527)\nsns.distplot(df_pg['price'], color= 'black')\nplt.title('Paul Gregutt')\nplt.subplot(528)\nsns.distplot(df_pg['points'], color= 'black')\n\nplt.subplot(529)\nsns.distplot(df_vb['price'], color= 'green')\nplt.title('Virginie Boone')\nplt.subplot(5,2,10)\nsns.distplot(df_vb['points'], color= 'green')\n\nplt.suptitle(\"Popular taster's price and points distributions \\n\", fontsize=20)\nplt.show()","be9ade7d":"#check whether the length of reviews has any impact on ratings of the wine\n#for that we first calculate the length and keep it in separate column\ndf['len'] = df['description'].apply(len)","56107303":"#let's check the impact\ndf[['points','len']].groupby(['points']).agg(['min', 'mean', 'max']).style.background_gradient(cmap='viridis')","948608e2":"#cleaning the reviews\n#let's remove punctuations\nimport string\ndef punct_remove(messy_str):\n    clean_list = [char for char in messy_str if char not in string.punctuation]\n    clean_str = ''.join(clean_list)\n    return clean_str\ndf['description'] = df['description'].apply(punct_remove)","d4b19032":"#let's remove stop words\n\nfrom nltk.corpus import stopwords\nfrom nltk.tokenize import word_tokenize\n\nstop = stopwords.words('english')\n\nstop_words = []\n\nfor item in stop:\n    new_item = punct_remove(item)\n    stop_words.append(new_item)\n    \ndef stopwords_remove(messy_str):\n    messy_str = word_tokenize(messy_str)\n    return [word.lower() for word in messy_str\n           if word.lower() not in stop_words]\n\ndf['description'] = df['description'].apply(stopwords_remove)","d9349cbc":"#let's drop the numbers as well\nimport re\ndef num_remove(list_text):\n    list_text_new = []\n    for i in list_text:\n        if not re.search('\\d', i):\n            list_text_new.append(i)\n    return ' '.join(list_text_new)\n\ndf['description'] = df['description'].apply(num_remove)","4b08a51b":"import nltk\nnltk.download('vader_lexicon')","49b163d7":"from nltk.sentiment.vader import SentimentIntensityAnalyzer\nsid = SentimentIntensityAnalyzer()\n\ntrain_sentiment = []\n\nfor i in df['description']:\n    train_sentiment.append(sid.polarity_scores(i).get('compound'))\n    \ntrain_sentiment = np.asarray(train_sentiment)\ndf['sentiment'] = pd.Series(data = train_sentiment)","22bb88f6":"df[['points',\n    'sentiment']].groupby(['points']).agg(['min',\n                                           'mean', 'max']).style.background_gradient(cmap='viridis')","4aac7094":"* Points by the tasters for the portugal and spain wine bottles are lesser. And their average price also lesser than other countries, this also proves that there is a linear relationship between points and price column.\n* France wine bottles are getting higher points and those are costlier as well.","70197ed2":"* **Roger** tasted and reviewed wines bottles in the price range of 1 to 100 mostly, and he is the one who tasted and review the costlier wine bottle. Most of the time he gave 88 points.\n* **Michael** tasted and reviewed wines bottles in the price range of 1 to 100 mostly, and he gave 87 points most of the time.\n* **Kerin** tasted and reviewed wines bottles in the price range of 1 to 100 mostly, and he gave 87 points most of the time.\n* **Paul** tasted and reviewed wines bottles in the price range of 1 to 50 mostly, then he gave 88 and 90 points most of the time.\n* **Virginie** tasted and reviewed wines bottles in the price range of 1 to 100 mostly, and she gave 90 points most of the time.\n","2cf2ad76":"* In the top 5 wine production countries, France country wine bottles are costlier than others \n* Spain and Portugal wine bottles are cheaper than other top countries","90c2508e":"* Roger Voss, Michael Schachner, Kerin O\u2019Keefe, Paul Gregutt, Virginie Boone are the popular wine taster and reviewers. ","9ec7cd78":"* if the wine bottles are costliers the points by tasters also highers\n* there is a linear relationship between points and price columns","85983943":"* Wine bottles average price in switzerland is higher than all other countries\n* Average price of Wine bottles from Switzerland, England, France, Germany, and Hungary are above 40, all other countries wine bottles are cheaper ","cf904f62":"* We can observe a significant impact here; if the points are greater, the average length of the review is also higher; similarly, if the points are lower, the average length of the review is also shorter. \n* This obviously indicates that if the taster like the flavour more, he will give a lengthier review.","3dbbff8b":"* Also Red blend and Chardonnay grape variety wine bottles are getting lesser points from the tasters.","14acecbc":"* Red blend and Chardonnay grape variety wine bottles are cheaper than other popular grapes","26b8d3f7":"**Analysis of wine bottles from the top 100 wineries:**\n* On an average Germany and Austria wine bottles are getting higher points from the tasters.\n* New zealand wine varieties are getting lesser points than other countries","2eefc883":"* 'Pinot Noir', 'Chardonnay', 'Cabernet Sauvignon', 'Red Blend', 'Bordeaux-style Red Blend' are the top 5 grape varieties used for wine production in the whole.","d35032f3":"* US, France, Italy, Spain, Portugal are the top 5 countries where the wine production is higher","2d3a69db":"**Analysis of wine bottles from the top 100 wineries:**\n* France wine bottles are costlier and the wine price variability also much higher in france\n* Only in US, France, Chile, and Germany, the Wine bottles price are above 200.\n* Romania wines are cheaper than other top wineries and there is no much varieties also.","a6caa31d":"* Based on the above table, we may conclude that there is no acceptable sentiment pattern for this data. Because all of the wine ratings are above 80, the majority of the reviews are positive. \n* All of the tasters' wine reviews appear to be positive reviews, and all of the sentiment scores indicate that everything in this dataset is good.\n* These sentiment scores are of no use at all","8f5f6487":"* Majority of the wine bottle's cost is below 100\n* points given by tasters majorly ranges between 86 and 91\n* none of the wine bottles got points lesser than 80"}}