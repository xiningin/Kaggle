{"cell_type":{"c7b109e9":"code","77ea565e":"code","8de983fd":"code","5a9ad4c7":"code","55705d59":"code","e28968c6":"code","d51e9bd2":"code","80bb8e82":"code","b5bcd91d":"code","f3eb619e":"code","3a963c46":"code","401eb919":"code","ddec6ca8":"code","5b49f00f":"code","afbf1214":"code","40a0241a":"code","161cb5d9":"code","64631319":"code","f8fe4955":"code","0451ec00":"code","99b0f452":"code","9bed5ad2":"code","65e8fb00":"code","7f53d145":"markdown","8ba24105":"markdown","e594c5a6":"markdown","8525f7e2":"markdown","59f92839":"markdown","4471f1c5":"markdown","52ce2ea6":"markdown","1ea716e6":"markdown","17400764":"markdown","36772f9e":"markdown","440e2f18":"markdown"},"source":{"c7b109e9":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nplt.style.use('seaborn')\nimport os","77ea565e":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","8de983fd":"train = pd.read_csv('\/kaggle\/input\/Kannada-MNIST\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/Kannada-MNIST\/test.csv')","5a9ad4c7":"train.label.value_counts().plot.bar(rot=0,title='Number of train samples by label');","55705d59":"plt.imshow(train[train.columns[1:]].sample(1).values.ravel().reshape(28,28));","e28968c6":"from sklearn.model_selection import train_test_split","d51e9bd2":"train_, test_ = train_test_split(train,test_size=0.33,random_state=42,stratify=train.label)","80bb8e82":"'train',train_.label.value_counts() \/ len(train_),'test',test_.label.value_counts() \/ len(test_)","b5bcd91d":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn import metrics","f3eb619e":"%%time\nknn = KNeighborsClassifier(n_neighbors=3)\nknn.fit(train_[train_.columns[1:]],train_['label'])","3a963c46":"%%time\nknn_results = test_.copy()\nknn_results['y_pred'] = knn.predict(test_[test_.columns[1:]])","401eb919":"print(metrics.classification_report(knn_results.label,knn_results.y_pred))","ddec6ca8":"sns.heatmap(metrics.confusion_matrix(knn_results.label,knn_results.y_pred),annot=True,fmt='d');","5b49f00f":"import xgboost as xgb","afbf1214":"%%time\nxgc = xgb.XGBClassifier(objective='multi:softmax',num_class=train.label.nunique(),n_estimators=300)\nxgc.fit(train_[train_.columns[1:]],train_['label'],verbose=1000)","40a0241a":"%%time\nxgc_results = test_.copy()\nxgc_results['y_pred'] = xgc.predict(test_[test_.columns[1:]])","161cb5d9":"print(metrics.classification_report(xgc_results.label,xgc_results.y_pred))","64631319":"sns.heatmap(metrics.confusion_matrix(xgc_results.label,xgc_results.y_pred),annot=True,fmt='d');","f8fe4955":"dig = pd.read_csv('\/kaggle\/input\/Kannada-MNIST\/Dig-MNIST.csv')\ntrain_plus_dig = pd.concat([train,dig],ignore_index=True)","0451ec00":"%%time\nfull_xgc = xgb.XGBClassifier(objective='multi:softmax',num_class=train_plus_dig.label.nunique(),n_estimators=300)\nfull_xgc.fit(train_plus_dig[train_plus_dig.columns[1:]],train_plus_dig['label'],verbose=1000)","99b0f452":"train_plus_dig","9bed5ad2":"%%time\nfull_xgc_results = test.copy()\nfull_xgc_results['y_pred'] = full_xgc.predict(test[test.columns[1:]])","65e8fb00":"full_xgc_results['id'] = list(range(0,len(test)))\nfull_xgc_results[['id','y_pred']].rename(columns={'y_pred':'label'}).to_csv('submission.csv',index=False)","7f53d145":"# Kannada Digit Recogniser\n\nRe-Running my notebook for [Digit recogniser](https:\/\/www.kaggle.com\/cristianfat\/digit-recogniser)","8ba24105":"**Check if the data it's fair splitted based on label**","e594c5a6":"**Train \/ Test data**","8525f7e2":"**XGBoost**","59f92839":"## Imports","4471f1c5":"**Random Sample to Image**","52ce2ea6":"**Train on Full Data then create submission file**","1ea716e6":"**Load data**","17400764":"## Data","36772f9e":"**Number of train samples by label**","440e2f18":"**KNN**"}}