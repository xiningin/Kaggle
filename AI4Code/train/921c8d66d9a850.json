{"cell_type":{"0f23e8c7":"code","244876fc":"code","7e7c4e07":"code","61343ff4":"code","93f1c8fe":"code","b5c16672":"code","216adfbe":"code","9b2bc533":"code","d5f2f067":"code","5bb3cafe":"code","1a723f69":"code","dcc55d65":"code","761961f0":"code","3dd50a23":"code","8c02251d":"code","2a6ef63e":"code","b987a37f":"code","a777b60b":"code","e6e2392a":"code","87830316":"code","b8beeca8":"code","b8af3f19":"code","9d93edfb":"markdown","50fbbe38":"markdown","4828a55b":"markdown"},"source":{"0f23e8c7":"#Import Libraries\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.metrics import mean_absolute_error\n\n#preprocessing\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import PolynomialFeatures","244876fc":"# column headers \n_headers = ['CIC0', 'SM1', 'GATS1i', 'NdsCH', 'Ndssc', 'MLOGP', 'response'] \n# read in data \ndf = pd.read_csv('https:\/\/raw.githubusercontent.com\/PacktWorkshops\/The-Data-Science-Workshop\/master\/Chapter06\/Dataset\/qsar_fish_toxicity.csv', names=_headers, sep=';') ","7e7c4e07":"df.head()","61343ff4":"# Let's split our data \n\nfeatures = df.drop('response', axis=1).values \nlabels = df[['response']].values \nX_train, X_eval, y_train, y_eval = train_test_split(features, labels, test_size=0.2, random_state=0) \nX_val, X_test, y_val, y_test = train_test_split(X_eval, y_eval, random_state=0) ","93f1c8fe":"model = LinearRegression() ","b5c16672":"model.fit(X_train, y_train) ","216adfbe":"y_pred = model.predict(X_val) ","9b2bc533":"r2 = model.score(X_val, y_val) \nprint('R^2 score: {}'.format(r2)) ","d5f2f067":"_ys = pd.DataFrame(dict(actuals=y_val.reshape(-1), predicted=y_pred.reshape(-1))) \n_ys.head() ","5bb3cafe":"# Let's compute our MEAN ABSOLUTE ERROR\nmae = mean_absolute_error(y_val, y_pred)\nprint('MAE: {}'.format(mae))","1a723f69":"#Let's get the R2 score\nr2 = model.score(X_val, y_val)\nprint('R^2 score: {}'.format(r2))","dcc55d65":"#create a pipeline and engineer quadratic features\nsteps = [\n    ('scaler', MinMaxScaler()),\n    ('poly', PolynomialFeatures(2)),\n    ('model', LinearRegression())\n]","761961f0":"#create a Linear Regression model\nmodel = Pipeline(steps)","3dd50a23":"#train the model\nmodel.fit(X_train, y_train)","8c02251d":"#predict on validation dataset\ny_pred = model.predict(X_val)","2a6ef63e":"#compute MAE\nmae = mean_absolute_error(y_val, y_pred)\nprint('MAE: {}'.format(mae))","b987a37f":"# let's get the R2 score\nr2 = model.score(X_val, y_val)\nprint('R^2 score: {}'.format(r2))","a777b60b":"from sklearn.externals import joblib","e6e2392a":"joblib.dump(model, '.\/model.joblib')","87830316":"m2 = joblib.load('.\/model.joblib')","b8beeca8":"m2_preds = m2.predict(X_val)","b8af3f19":"ys = pd.DataFrame(dict(predicted=y_pred.reshape(-1), m2=m2_preds.reshape(-1)))\nys.head()\n","9d93edfb":"# work on qsar fish dataset","50fbbe38":"# computing MAE for second model","4828a55b":"# splitting data"}}