{"cell_type":{"e4bf2a4a":"code","25be20b8":"code","2857691e":"code","24612eb0":"code","e4f0e937":"code","6e115425":"markdown"},"source":{"e4bf2a4a":"%cd \/kaggle\/working\n!git clone https:\/\/github.com\/ultralytics\/yolov5 # clone\n!cp -r \/kaggle\/input\/yolov5-lib-ds \/kaggle\/working\/yolov5\n%cd yolov5\n%pip install -qr requirements.txt  # install\n\nfrom yolov5 import utils\ndisplay = utils.notebook_init()  # check","25be20b8":"# Install W&B \n!pip install -q --upgrade wandb\n\n# Login \nimport wandb\n\nfrom kaggle_secrets import UserSecretsClient\nuser_secrets = UserSecretsClient() \n\npersonal_key_for_api = user_secrets.get_secret(\"WNB\")\n! wandb login $personal_key_for_api","2857691e":"import os\nimport yaml\n\ncwd = '\/kaggle\/working\/'\n\ndata = hyperparams = {'lr0': 0.01,\n 'lrf': 0.1, \n 'momentum': 0.937,  \n 'weight_decay': 0.0005,\n 'warmup_epochs': 5.0, #3.0\n 'warmup_momentum': 0.8, #0.8\n 'warmup_bias_lr': 0.1, #0.1\n 'box': 0.05,\n 'cls': 0.5, #0.5\n 'cls_pw': 1.0,\n 'obj': 1.0,\n 'obj_pw': 1.0,\n 'iou_t': 0.2,\n 'anchor_t': 4.0,\n 'fl_gamma': 0.0,\n 'hsv_h': 0.015,\n 'hsv_s': 0.7,#0.7\n 'hsv_v': 0.3,#0.3\n 'degrees': 0.0,\n 'translate': 0.1,\n 'scale': 0.7, #0.5\n 'shear': 0.0,\n 'perspective': 0.0,\n 'flipud': 0.0,\n 'fliplr': 0.5,\n 'mosaic': 0.5, #1.0 # 0.0 was better\n 'mixup': 0.5, #0.0\n 'copy_paste': 0.0}\n\nwith open(os.path.join( cwd, 'hyper.yaml' ), 'w') as outfile:\n    yaml.dump(data, outfile, default_flow_style=False)","24612eb0":"\ncwd = '\/kaggle\/working\/'\ndata = dict(\n    path  = cwd,\n    train = '..\/input\/cotsyolostratifiedkfold\/COTS-YOLOv5-StratifiedKFold\/images\/train',\n    val   = '..\/input\/cotsyolostratifiedkfold\/COTS-YOLOv5-StratifiedKFold\/images\/val',\n    nc    = 1,\n    names = ['cots'],\n    )\nwith open(os.path.join( cwd , 'custom.yaml'), 'w') as outfile:\n    yaml.dump(data, outfile, default_flow_style=False)\n\nf = open(os.path.join( cwd , 'custom.yaml'), 'r')\nprint('\\nyaml:')\nprint(f.read())","e4f0e937":"!python train.py --img 960\\\n--hyp \/kaggle\/working\/hyper.yaml\\\n--batch 8\\\n--epochs 30\\\n--data \/kaggle\/working\/custom.yaml\\\n--weights yolov5l.pt ","6e115425":"Reference : https:\/\/www.kaggle.com\/awsaf49\/great-barrier-reef-yolov5-train"}}