{"cell_type":{"ae3d8464":"code","2615f28d":"code","6f7e1ffe":"code","88e206eb":"code","3bd74629":"code","5ed0aa47":"code","128fa949":"code","6aa03451":"code","e63c4800":"code","37992c0c":"code","7ace748a":"code","cd80f6fc":"code","8cb1bf42":"code","5ab7cf60":"code","b75a3230":"code","0db3fcb1":"code","5e37bc33":"code","38328c83":"code","1beb3206":"code","657257b1":"code","e4f9666c":"code","414dfc08":"code","dc280ce6":"code","b1c09c99":"code","9046c848":"code","315dd2fb":"code","4be9b159":"code","c82df390":"code","096263eb":"code","883aae5a":"markdown","f03d65e2":"markdown","40afb7b6":"markdown","42c05e83":"markdown","575f875c":"markdown"},"source":{"ae3d8464":"conda install -c conda-forge pytorch-tabnet","2615f28d":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","6f7e1ffe":"df_train = pd.read_csv('..\/input\/song-popularity-prediction\/train.csv')\ndf_train","88e206eb":"df_train.isnull().sum()","3bd74629":"df_train.isnull().sum()\/len(df_train)","5ed0aa47":"df_train.mean()","128fa949":"df_train = df_train.fillna(df_train.mean())\ndf_train","6aa03451":"df_test = pd.read_csv('..\/input\/song-popularity-prediction\/test.csv')\ndf_test","e63c4800":"df_test.isnull().sum()\/len(df_test)","37992c0c":"df_test = df_test.fillna(df_test.mean())\ndf_test","7ace748a":"df_train['song_popularity'].value_counts()","cd80f6fc":"df_train['song_popularity'].value_counts()\/len(df_train)","8cb1bf42":"X = df_train.drop('song_popularity', axis=1)\nX.head()","5ab7cf60":"y = df_train['song_popularity']\ny","b75a3230":"from sklearn.model_selection import train_test_split\nfrom sklearn.metrics import roc_auc_score","0db3fcb1":"train_x, valid_x, train_y, valid_y = train_test_split(X, y, test_size=0.20, stratify = y)","5e37bc33":"train_x, valid_x, train_y, valid_y = train_x.values, valid_x.values, train_y.values, valid_y.values ","38328c83":"from pytorch_tabnet.tab_model import TabNetClassifier\n\nclf = TabNetClassifier()","1beb3206":"# eval_metric=['auc']\nclf.fit(\n  train_x, train_y, eval_set=[(valid_x, valid_y)], eval_metric=['auc']\n)\npreds = clf.predict(valid_x)","657257b1":"preds","e4f9666c":"clf.predict_proba(valid_x)","414dfc08":"preds = clf.predict(df_test.values)\npreds","dc280ce6":"prob = clf.predict_proba(df_test.values)\nprob","b1c09c99":"prob[:, 1:2]","9046c848":" sample_submission = pd.read_csv(\"..\/input\/song-popularity-prediction\/sample_submission.csv\")","315dd2fb":"sample_submission","4be9b159":"sample_submission.song_popularity = prob[:, 1:2]","c82df390":"sample_submission ","096263eb":"sample_submission.to_csv('pred.csv', index=False)","883aae5a":"## Filling with mean train","f03d65e2":"## Reading train","40afb7b6":"## Filling the mean","42c05e83":"## Split","575f875c":"## Reading test data"}}