{"cell_type":{"4fe998d2":"code","4c9f71f3":"code","2d1da027":"code","2b671703":"code","436b514e":"code","af211386":"code","db1a0a8c":"code","a67e8243":"code","9b5c13d0":"code","ec66c3a3":"code","7db09990":"code","b8aa663f":"code","0266377b":"code","8188aa04":"code","cd8066be":"code","7f302a9c":"code","e97e66c8":"code","ba6c9570":"code","3c991dbc":"code","df2fd348":"code","ff2c6715":"code","b7285ee2":"code","f3f340aa":"code","a116592e":"code","d81d2905":"code","f804488c":"code","6efd1616":"code","8dc1e175":"code","a01de834":"code","3f1cada3":"code","7b55849c":"markdown","7a792dad":"markdown","256b39f2":"markdown","380cb9c5":"markdown","a3a3202c":"markdown","b08e545b":"markdown","f88b6975":"markdown","3779372f":"markdown","beba2ca5":"markdown","c663bcb0":"markdown","4f056842":"markdown","358e7b63":"markdown","4cbf5314":"markdown","5fddf482":"markdown","7a6b8bc4":"markdown"},"source":{"4fe998d2":"#Import the libraries\nimport math\nimport numpy as np\nimport pandas as pd\nimport datetime\nfrom sklearn.preprocessing import MinMaxScaler\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import LSTM\nfrom keras.layers import Dropout\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nplt.style.use('fivethirtyeight')","4c9f71f3":"itemCategories=pd.read_csv(\"..\/input\/competitive-data-science-predict-future-sales\/item_categories.csv\")\nitems=pd.read_csv(\"..\/input\/competitive-data-science-predict-future-sales\/items.csv\")\nsalesTrain=pd.read_csv(\"..\/input\/competitive-data-science-predict-future-sales\/sales_train.csv\")\nsubmission=pd.read_csv(\"..\/input\/competitive-data-science-predict-future-sales\/sample_submission.csv\")\nshops=pd.read_csv(\"..\/input\/competitive-data-science-predict-future-sales\/shops.csv\")\ntest=pd.read_csv(\"..\/input\/competitive-data-science-predict-future-sales\/test.csv\")\ntest.columns.values","2d1da027":"print(\"itemCategories:\", itemCategories.shape)\nprint(\"items:\",items.shape)\nprint(\"salesTrain\",salesTrain.shape)\nprint(\"submission\",submission.shape)\nprint(\"shops\",shops.shape)\nprint(\"test\",test.shape)","2b671703":"itemCategories.info()\nitems.info()\nsalesTrain.info()\nsubmission.info()\nshops.info()\ntest.info()","436b514e":"itemCategories.head(5)","af211386":"items.head(5)","db1a0a8c":"df = salesTrain.groupby(by=['date'],sort=True,as_index=False).count()\ndf","a67e8243":"submission.head(5)","9b5c13d0":"shops.head(5)","ec66c3a3":"test.head(5)","7db09990":"def show_missing_values(function_data):\n#Veri setindeki eksik de\u011ferleri bulal\u0131m\n    number_of_sample=function_data.shape[0]\n    check_isnull=function_data.isnull().sum()\n    \n    check_isnull=check_isnull[check_isnull!=0].sort_values(ascending=False)\n\n    if check_isnull.shape[0]==0:\n        print(\"Data set does not contain missing data\")\n    else:\n        print(\"Data set contains missing data\")","b8aa663f":"show_missing_values(itemCategories)\nshow_missing_values(items)\nshow_missing_values(salesTrain)\nshow_missing_values(submission)\nshow_missing_values(shops)\nshow_missing_values(test)","0266377b":"plt.figure(figsize=(16,8))\nplt.title(\"Tarih ve Fiyat Sat\u0131\u015flar\u0131\")\nplt.plot(df.date,df.item_price)\nplt.xlabel('Date',fontsize=12)\nplt.ylabel('Price',fontsize=12)\nplt.show()","8188aa04":"df = salesTrain.groupby(by=['shop_id'],sort=True,as_index=False).count()\ndf","cd8066be":"plt.figure(figsize=(16,8))\nplt.title(\"Tarih ve Fiyat Sat\u0131\u015flar\u0131\")\nplt.plot(shops.shop_name,df.item_price)\nplt.xlabel('Shop Name',fontsize=18)\nplt.ylabel('Sum Price',fontsize=18)\nplt.show()","7f302a9c":"data = salesTrain.filter(['item_cnt_day'])\n\ndataset = data.head(1000)\n\ntraining_data_lenght = (math.ceil( len(dataset) * .8))\ntraining_data_lenght","e97e66c8":"scaler = MinMaxScaler(feature_range=(0, 1)) \nscaled_data = scaler.fit_transform(dataset)\nscaled_data.size","ba6c9570":"train_data = scaled_data[ 0:training_data_lenght,: ]\ntrain_data.size","3c991dbc":"x_train=[]\ny_train=[]\nfor i in range(60,len(train_data)):\n    x_train.append(train_data[i-60 :i,0])\n    y_train.append(train_data[i,0])\n","df2fd348":"x_train, y_train = np.array(x_train), np.array(y_train)","ff2c6715":" x_train = np.reshape (x_train, (x_train.shape [0], x_train.shape [1], 1))","b7285ee2":"model = Sequential()\nmodel.add(LSTM(units=50, return_sequences=True,input_shape = ( x_train.shape[1] , 1)))\nmodel.add(LSTM(units=50, return_sequences=False))\nmodel.add(Dense(units=25))\nmodel.add(Dense(units=1))","f3f340aa":"model.compile(optimizer='adam', loss='mean_squared_error')","a116592e":"model.fit(x_train, y_train, batch_size=1, epochs=1)","d81d2905":" test_data = scaled_data[training_data_lenght - 60:,:]","f804488c":"x_test = []\ny_test =  dataset[scaled_data.size : , : ] \nfor i in range(60,len(test_data)):\n    x_test.append(test_data[i-60:i,0])","6efd1616":"x_test = np.array(x_test)","8dc1e175":"x_test = np.reshape(x_test, (x_test.shape[0],x_test.shape[1],1))","a01de834":"predictions = model.predict(x_test) \npredictions = scaler.inverse_transform(predictions)","3f1cada3":"rmse=np.sqrt(np.mean(((predictions- y_test)**2)))\nrmse","7b55849c":"item_cnt_day den olu\u015fan bir dataframe olu\u015fturuldu\nDataFrame diziye d\u00f6n\u00fc\u015ft\u00fcr\u00fcld\u00fc\nE\u011fitim verilerinin y\u00fczde 80 aktar\u0131ld\u0131","7a792dad":"Test verisinin numpy dizisine d\u00f6n\u00fc\u015ft\u00fcr\u00fclmesi","256b39f2":"Modelden tahmin edilen verilerin al\u0131nmas\u0131","380cb9c5":"Veri setinde ki eksik de\u011ferlerin bulunmas\u0131","a3a3202c":"Modelin ortalama kare hatas\u0131 (MSE) kayb\u0131 i\u015flevini kullanarak derlenmesi","b08e545b":"E\u011fitim veri seti kullanarak modelin e\u011fitilmesi. \nEpochs t\u00fcm veri k\u00fcmesinin sinir a\u011f\u0131 \u00fczerinden ileri ve geri aktar\u0131ld\u0131\u011f\u0131nda ki yineleme say\u0131s\u0131d\u0131r. ","f88b6975":"x_train ve y_train numpy dizelerine d\u00f6n\u00fc\u015ft\u00fcr\u00fcld\u00fc.","3779372f":"Tablo da bulunan satur ve s\u00fctun say\u0131s\u0131","beba2ca5":"Bir tane test datas\u0131 olu\u015fturuldu.","c663bcb0":"RMSE k\u00f6k ortalama kare hatas\u0131n\u0131n hesaplanmas\u0131 \nModelin do\u011frulu\u011funa dair bir \u00f6l\u00e7\u00fctt\u00fcr.\n0 de\u011feri model ile ger\u00e7ek de\u011ferlerin tamamen e\u015fle\u015fti\u011fini g\u00f6sterir.\nDe\u011ferin d\u00fc\u015f\u00fck olmas\u0131 modelin iyi oldu\u011funu g\u00f6sterir","4f056842":"Verileri 3 boyutlu olarak olu\u015fturuyoruz.\n\u00d6rnek say\u0131s\u0131 Zaman Ad\u0131m Say\u0131s\u0131 \n\u00d6zellik Say\u0131s\u0131\nLSTM modeli 3 boyutlu bir veriseti bekliyor.","358e7b63":"\u00d6rne\u011fin 11'\u0131nc\u0131 sat\u0131\u015f say\u0131s\u0131n\u0131 tahmin etmek istiyoruz bunun i\u00e7in son 60 g\u00fcn item_cnt_day de\u011ferlerini i\u00e7eren bir e\u011fitim veri k\u00fcmesi olu\u015fturuldu.","4cbf5314":"LSTM modeli olu\u015fturma i\u015flemi ","5fddf482":" Verileri 3 boyutlu olacak \u015fekilde yeniden \u015fek,llendirme\n \u00d6rnek say\u0131s\u0131, Zaman ad\u0131m\u0131 say\u0131s\u0131 ve \u00d6zellik say\u0131s\u0131 ","7a6b8bc4":"Veri seti 0 ile 1 aras\u0131nda \u00f6l\u00e7eklendirildi.\nSinir a\u011f\u0131na girmeden \u00f6nce verilerin \u00f6l\u00e7eklendirilmesi gerekir bu iyi bir y\u00f6ntemdir."}}