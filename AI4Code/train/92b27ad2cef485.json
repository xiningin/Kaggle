{"cell_type":{"8e750879":"code","4cc33e8b":"code","1be252de":"code","6bac9d36":"code","c4c51121":"code","599f0d14":"code","c4cd8135":"code","0f6b0508":"code","09ac8d26":"code","f327aabf":"code","fe1a2490":"code","468fe7b4":"markdown","544cc43f":"markdown","0aa10c3f":"markdown","22345b97":"markdown"},"source":{"8e750879":"import os\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","4cc33e8b":"sucursales = pd.read_csv(\"\/kaggle\/input\/precios-claros-precios-de-argentina\/sucursales.csv\") \nsucursales","1be252de":"productos = pd.read_csv(\"\/kaggle\/input\/precios-claros-precios-de-argentina\/productos.csv\") \nproductos","6bac9d36":"# precios de la semana pasada\nprecios_last_w = pd.read_csv(\"\/kaggle\/input\/precios-claros-precios-de-argentina\/precios_20200412_20200413.csv\")\n# precios de esta semana\nprecios_current_w = pd.read_csv(\"\/kaggle\/input\/precios-claros-precios-de-argentina\/precios_20200419_20200419.csv\")\n\nprecios_current_w","c4c51121":"sucursales_prov = sucursales[[\"id\", \"provincia\"]]\nsucursales_prov[\"id_prov\"] = sucursales[\"comercioId\"].astype(str) + \"-\" + sucursales[\"banderaId\"].astype(str) +  \"-\" + sucursales[\"provincia\"]\nsucursales_prov","599f0d14":"precios_last_w = precios_last_w.join(sucursales_prov.set_index(\"id\"), on=\"sucursal_id\")\nprecios_current_w = precios_current_w.join(sucursales_prov.set_index(\"id\"), on=\"sucursal_id\")\nprecios_current_w","c4cd8135":"precios_current_w.rename(columns={\"precio\": \"precio_19abril\"}, inplace=True)\nprecios_last_w.rename(columns={\"precio\": \"precio_12abril\"}, inplace=True)","0f6b0508":"precios_last_w","09ac8d26":"precios = pd.merge(precios_last_w, precios_current_w, on=[\"producto_id\", \"id_prov\", \"provincia\"],  how=\"inner\").dropna()[[\"producto_id\", \"id_prov\", \"provincia\", \"precio_12abril\", \"precio_19abril\"]]\nprecios = pd.merge(precios, productos[[\"id\", \"marca\", \"nombre\"]], left_on=\"producto_id\", right_on=\"id\").drop('id', axis=1)\nprecios[\"diferencia\"] = precios[\"precio_19abril\"] - precios[\"precio_12abril\"]\nprecios[\"diferencia_porcentual\"] = precios[\"diferencia\"].abs() \/ precios[\"precio_12abril\"] * 100\nprecios","f327aabf":"precios.to_csv(\"precios_20200412_vs_20200419.csv\", index=False)","fe1a2490":"precios[precios.provincia == \"AR-C\"].sort_values(\"diferencia_porcentual\", ascending=False)[:50]","468fe7b4":"Listo! tenemos nuestro dataframe. Guardemoslo.\n","544cc43f":"## Ejemplo: Los 50 productos que m\u00e1s aumentaron (porcentualmente) en C\u00f3rdoba","0aa10c3f":"Los precios est\u00e1n indentificados por sucursal y hay una sucursal testigo por provincia, pero no necesariamente es la misma todas las semanas. Para poder comparar, debemos normalizar a un indentificador que \"banderaId-comercioId-provincia\"","22345b97":"## Armando un dataframe unificado\n\nAhora podemos armar un dataset que permita comparar precios, con identificador, precio de la semana pasada y actual, y el identificador \"normalizado por provincia\", incorporando nombre y marca del producto y la diferencia de precio"}}