{"cell_type":{"464c4598":"code","43bfa3d5":"code","7966dd69":"code","7c41fefe":"code","8e97c5f6":"code","ebfc9716":"code","eb26a4a7":"code","dbf67b18":"code","1733897f":"code","a671bcdb":"code","3ff6b7bd":"code","a4a89747":"code","66a51bff":"code","108c73ea":"code","3a252517":"code","4f0a5bd5":"code","61ffbc90":"code","11384fed":"code","98c270ae":"markdown","733313e2":"markdown","9a7f4dea":"markdown","5f8152b4":"markdown"},"source":{"464c4598":"import pandas as pd\nimport numpy as np\n!pip install --quiet pycountry_convert\nfrom pycountry_convert import country_name_to_country_alpha3\nimport warnings\nwarnings.filterwarnings('ignore')\nimport plotly.express as px\nimport os","43bfa3d5":"data = pd.read_csv('..\/input\/all-space-missions-from-1957\/Space_Corrected.csv')\ndata[:5]","7966dd69":"data.info()","7c41fefe":"data.drop(['Unnamed: 0', 'Unnamed: 0.1'], axis=1, inplace=True)\ndata.rename({' Rocket': 'Cost'}, axis=1, inplace=True)","8e97c5f6":"data.Cost.unique()","ebfc9716":"data['Cost'].loc[data['Cost'] == '5,000.0 '] = '5.0'\ndata['Cost'].loc[data['Cost'] == '1,160.0 '] = '1.16'\ndata.Cost = data.Cost.astype(float).fillna(0.0)","eb26a4a7":"data['date'] = pd.to_datetime(data['Datum'])\ndata['year'] = data['date'].apply(lambda datetime: datetime.year)","dbf67b18":"data['country'] = data['Location'].str.split(', ').str[-1]\ndata['country'].loc[data['country'] == 'Shahrud Missile Test Site'] = \"Iran\"\ndata['country'].loc[data['country'] == 'New Mexico'] = 'USA'\ndata['country'].loc[data['country'] == 'Yellow Sea'] = \"China\"\ndata['country'].loc[data['country'] == 'Pacific Missile Range Facility'] = \"USA\"\ndata['country'].loc[data['country'] == 'Pacific Ocean'] = \"USA\"\ndata['country'].loc[data['country'] == 'Barents Sea'] = 'Russia'\ndata['country'].loc[data['country'] == 'Gran Canaria'] = 'USA'","1733897f":"def get_iso(col):\n    try:\n        iso_3 = country_name_to_country_alpha3(col)\n    except:\n        iso_3 = 'Unknown'\n    return iso_3\n\ndata['iso_alpha'] = data['country'].apply(lambda x: get_iso(x))","a671bcdb":"data_map = pd.DataFrame(data.groupby(['country', 'iso_alpha'])['iso_alpha'].agg(Missions='count')).reset_index()","3ff6b7bd":"fig = px.scatter_geo(data_map, locations=\"iso_alpha\",\n                     color=\"country\",\n                     hover_name=\"country\",\n                     size=\"Missions\",\n                     projection=\"natural earth\")\nfig.show()","a4a89747":"table = pd.pivot_table(data, values='year', index='country',\n                    columns='Status Mission', aggfunc='count', fill_value=0)\ntable['Success (in prc)'] = table['Success'] \/ table.sum(axis=1)\ntable.style.format({'Success (in prc)' : '{:.2%}'})\\\n           .background_gradient(cmap='Reds')\\\n           .background_gradient(cmap='Blues',subset=[\"Success\"])\\\n           .background_gradient(cmap='YlOrBr',subset=[\"Success (in prc)\"])","66a51bff":"data_r = data.Detail.value_counts()\ndata_r = data_r[data_r > 1]","108c73ea":"table = data[data.Detail.isin(data_r.index)].groupby(['country', 'Company Name', 'Detail', 'Status Mission'])['Status Mission'].agg(Count='count')\ntable.style.background_gradient(cmap='YlOrBr',subset=[\"Count\"])","3a252517":"data_fail = data[(data['Status Mission'] != 'Success') & (data['Cost'] != 0)]","4f0a5bd5":"fig = px.bar(data_fail, x='Company Name', y='Cost', color='country', title = 'Failure costs')\nfig.show()","61ffbc90":"fig = px.sunburst(data_fail, path=['country', 'Company Name'], values='Cost', color='country',\n                  title='')\nfig.update_layout(autosize=False, width=600, height=600)\nfig.show()","11384fed":"data_fail.Cost.sum()","98c270ae":"NASA estimates that the average space shuttle mission costs 450$ millions","733313e2":"**Visualization**","9a7f4dea":"3B 725M $ is a total cost of failure in spacecraft (only from this dataset)","5f8152b4":"**Preprocessing**"}}