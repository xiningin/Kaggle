{"cell_type":{"d299f88b":"code","3de6d0f1":"code","faa79d19":"code","70bcb846":"code","bcd6b911":"code","178f558e":"code","3d28ffd5":"code","2589e8c7":"code","0d8455e3":"code","d31a1598":"code","af0846cd":"code","cc672321":"code","216a9c25":"code","5af5ead0":"code","28beab53":"code","a6806d27":"code","a1bdce00":"code","6673409b":"code","c0786630":"code","1ea25f4f":"code","f0412cd1":"code","86b677ae":"code","0e5cc726":"code","a24c2dec":"markdown","21a7e3ca":"markdown","b81088d1":"markdown","e9bb4497":"markdown","718f6ec4":"markdown","018a9560":"markdown","521627b4":"markdown","14f8a764":"markdown","02cd5d45":"markdown","f4755026":"markdown","f3992aa4":"markdown","4d171708":"markdown","8b6e03c6":"markdown","b3322b8f":"markdown","e59bf9c9":"markdown","058c7d5f":"markdown","79f09a42":"markdown","2b74758f":"markdown","23bc9360":"markdown","a99a9967":"markdown","c3d59515":"markdown","da9d1208":"markdown","25ab6bd1":"markdown"},"source":{"d299f88b":"import pandas as pd \nimport numpy as np \nimport matplotlib.pyplot as plt\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error, r2_score","3de6d0f1":"dataframe_train=pd.read_csv(\"..\/input\/house-price-prediction-challenge\/train.csv\")\ndataframe_train","faa79d19":"dataframe_test=pd.read_csv(\"..\/input\/house-price-prediction-challenge\/test.csv\")\ndataframe_test","70bcb846":"df_train=dataframe_train.drop(([\"UNDER_CONSTRUCTION\", \"RERA\", \"BHK_NO.\",\"POSTED_BY\",\"READY_TO_MOVE\",\"RESALE\",\"BHK_OR_RK\",\"ADDRESS\"]),axis=1)\ndf_train","bcd6b911":"plt.figure(figsize=(30,6))\nplt.subplot(131)\nplt.scatter(df_train['SQUARE_FT'], df_train['TARGET(PRICE_IN_LACS)'])\nplt.xlabel('SQUARE_FT')\nplt.ylabel('TARGET(PRICE_IN_LACS)')\nplt.subplot(132)\nplt.scatter(df_train['LONGITUDE'], df_train['TARGET(PRICE_IN_LACS)'])\nplt.xlabel('LONGITUDE')\nplt.ylabel('TARGET(PRICE_IN_LACS)')\nplt.subplot(133)\nplt.scatter(df_train['LATITUDE'], df_train['TARGET(PRICE_IN_LACS)'])\nplt.xlabel('LATITUDE')\nplt.ylabel('TARGET(PRICE_IN_LACS)')","178f558e":"df_test=dataframe_test.drop(([\"UNDER_CONSTRUCTION\", \"RERA\", \"BHK_NO.\",\"POSTED_BY\",\"READY_TO_MOVE\",\"RESALE\",\"BHK_OR_RK\",\"ADDRESS\"]),axis=1)\ndf_test","3d28ffd5":"df_train_values=df_train.values\nX_train=df_train_values[:,0:3]\ny_train=df_train_values[:,3]","2589e8c7":"X_train.shape,y_train.shape","0d8455e3":"y_train=y_train.reshape(-1,1)\nX_train.shape,y_train.shape","d31a1598":"df_test_values=df_test.values\nX_test=df_test_values[:,0:3]\nX_test.shape","af0846cd":"lin_reg_model=LinearRegression()\nlin_reg_model.fit(X_train,y_train)","cc672321":"y_prediction=lin_reg_model.predict(X_train)\ny_prediction","216a9c25":"rmse=np.sqrt(mean_squared_error(y_train,y_prediction))\nrmse","5af5ead0":"r2_score(y_train,y_prediction)","28beab53":"dataframe_train['predicted_price_linear_regression']=y_prediction\ndataframe_train","a6806d27":"y_prediction_test=lin_reg_model.predict(X_test)\ny_prediction_test","a1bdce00":"dataframe_test['predicted_price_linear_regression']=y_prediction_test\ndataframe_test","6673409b":"decision_tree_model= DecisionTreeRegressor()\ndecision_tree_model.fit(X_train,y_train)\ny_prediction_tree=decision_tree_model.predict(X_train)\n\ny_prediction_tree_test=decision_tree_model.predict(X_test)\ny_prediction_tree_test\n\nprint(\"RMSE:\",np.sqrt(mean_squared_error(y_train,y_prediction_tree)))\nprint(\"R_square:\",r2_score(y_train,y_prediction_tree))","c0786630":"dataframe_train['predicted_price_decision_tree_regression']=y_prediction_tree\ndataframe_train","1ea25f4f":"dataframe_test['predicted_price_decision_regression']=y_prediction_tree_test\ndataframe_test","f0412cd1":"random_forest_model=RandomForestRegressor(n_estimators=200, random_state=7)\nrandom_forest_model.fit(X_train,y_train)\n\ny_prediction_random_forest=random_forest_model.predict(X_train)\n\ny_prediction_random_forest_test=random_forest_model.predict(X_test)\n\n\nprint(\"RMSE:\",np.sqrt(mean_squared_error(y_train,y_prediction_random_forest)))\nprint(\"R_square:\",r2_score(y_train,y_prediction_random_forest))","86b677ae":"dataframe_train['predicted_price_decision_random_forest_regression']=y_prediction_random_forest\ndataframe_train","0e5cc726":"dataframe_test['predicted_price_random_forest_regression']=y_prediction_random_forest_test\ndataframe_test","a24c2dec":"# 3- load  test.csv of the house-price-prediction-challenge dataset","21a7e3ca":"# 13- check Root Of Mean Square Error (RMSE)","b81088d1":"# 16- make a prediction using X_test with trained model","e9bb4497":"# 7- separate the independent values into X_train and depended value into y_train (price)","718f6ec4":"# 20- add the decision tree prediction values end of the test dataframe ","018a9560":"# 11- create the LinearRegression() model for training","521627b4":"# 21- create RandomForestRegressor() and train model with X_train, y_train then make prediction using X_train and X_test with trained random_forest_model, finally check the RMSE and r2_score","14f8a764":"# 15- add the linear regression prediction values end of the train dataframe and compare true price and predicted price","02cd5d45":"# 2- load  train.csv of the house-price-prediction-challenge dataset ","f4755026":"# 14- check r2_score","f3992aa4":"# 22- add the prediction values end of the train dataframe and compare true price, linear_regression predicted price, decision tree predicted price and random forest predicted price","4d171708":"# 9- reshape the y_train array","8b6e03c6":"# 1- import necessary library","b3322b8f":"# 8- check the shape of X_train and y_train","e59bf9c9":"# 6- drop unrelated columns, which don't effect the house price, in test.csv of the house-price-prediction-challenge dataset","058c7d5f":" # 17- add the prediction values end of the test dataframe ","79f09a42":"# 19- add the prediction values end of the train dataframe and compare true price, linear_regression predicted price and decision tree predicted price","2b74758f":"# 23- add the random forest prediction values end of the test dataframe ","23bc9360":"# 12- make a prediction using X_train with trained model so as to compare true price and predicted price made by our LinearRegression() model. ","a99a9967":"# 4- drop unrelated columns, which don't effect the house price, in train.csv of the house-price-prediction-challenge dataset","c3d59515":"# 10- export test data into X_test","da9d1208":"# 18- create DecisionTreeRegressor() and train model with X_train, y_train then make prediction using X_train and X_test with trained decision_tree_model, finally check the RMSE and r2_score","25ab6bd1":"# 5- Check the scatter plot of the dataset in order to check which approach gives max r2_score and min Root of Mean Square Error (RMSE)\n\n# As can be seen when the graphs are examined, there is a nonlinear relationship between the price variable and other variables. For this reason, the (RMSE) value we will obtain with linear regression will be high and the (r2_score) value will be low. Decision Tree and Random Forest will yield lower (RMSE) and higher (r2_score) values."}}