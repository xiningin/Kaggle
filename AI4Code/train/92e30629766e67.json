{"cell_type":{"2fde7634":"code","83c046d6":"code","dc7808f8":"code","37bbaded":"code","fffd3f3f":"code","489b561f":"code","ecb02348":"code","e7aeb9c0":"code","1a5fc3a8":"code","9e56ed77":"code","1d652cb4":"code","1246e9ce":"code","cdf7b974":"code","54060c8c":"code","6a1d8dd4":"code","c7a530c2":"code","e0e5d4af":"code","8d694db9":"code","ec5bb367":"code","ddbc3b5a":"code","7ccb6cb1":"code","1a491075":"code","ac98857e":"code","6411b8bf":"code","afad641b":"code","ac802b40":"markdown"},"source":{"2fde7634":"import numpy as np\nimport pandas as pd \nimport matplotlib.pyplot as mpl\nimport seaborn as sns\nimport plotly.graph_objects as go\nimport plotly.express as px\nimport plotly.io as pio\nfrom mpl_toolkits.basemap import Basemap\nfrom datetime import datetime\nfrom fbprophet import Prophet\nfrom plotly.subplots import make_subplots\n\n","83c046d6":"# data1 = pd.read_csv('covid19 (2).csv')\ndata1 = pd.read_csv('\/kaggle\/input\/corona-virus-report\/covid_19_clean_complete.csv')\n","dc7808f8":"data1.head()","37bbaded":"import copy\ndata2 = data1.copy()","fffd3f3f":"data2.head()","489b561f":"data2.info()","ecb02348":"d = data1['Date'].value_counts().sort_index()","e7aeb9c0":"print(d.index[0])\n# this is the straing date in dataset","1a5fc3a8":"print(d.index[-1])\n# this is the ending date in dataset","9e56ed77":"data1['Active'] = data1['Confirmed']-data1['Deaths']-data1['Recovered']","1d652cb4":"# VISUALIZATION\nmpl.style.use(['ggplot']) \n# for ggplot-like style","1246e9ce":"data2['Date'] = pd.to_datetime(data2['Date'])\ndata2['Date'] = data2['Date'].dt.strftime('%m\/%d\/%Y')\ndata2 = data2.fillna('-')\nfig = px.density_mapbox(data2, lat='Lat', lon='Long', z='Confirmed', radius=20,zoom=1, hover_data=[\"Country\/Region\",'Province\/State',\"Confirmed\"],mapbox_style=\"carto-positron\", animation_frame = 'Date', range_color= [0, 2000],title='Spread of Covid-19')\nfig.update_layout(margin={\"r\":0,\"t\":30,\"l\":0,\"b\":0})\nfig.show()","cdf7b974":"m=Basemap(llcrnrlon=-180, llcrnrlat=-90,urcrnrlon=180,urcrnrlat=90)\n# m = Basemap(llcrnrlon=-10.5,llcrnrlat=33,urcrnrlon=10.,urcrnrlat=46., resolution='i', projection='cass', lat_0 = 39.5, lon_0 = 0.)\n\nm.drawmapboundary(fill_color='#A6CAE0', linewidth=0)\nm.fillcontinents(color='grey', alpha=0.7, lake_color='grey')\nm.drawcoastlines(linewidth=0.1, color=\"white\")\n \n# Add a marker per city of the data frame!\nm.plot(data1['Lat'], data1['Long'], linestyle='none', marker=\"o\", markersize=4, alpha=0.4, c=\"yellow\",  markeredgewidth=1)","54060c8c":"recent = data1[data1['Date'] == data1['Date'].max()]\nworld = recent.groupby('Country\/Region')['Confirmed','Active','Deaths'].sum().reset_index()\nworld.tail(10)\n# len(world)","6a1d8dd4":"world['size'] = world['Deaths'].pow(0.2)\nfig = px.scatter_geo(world, locations=\"Country\/Region\",locationmode='country names', color=\"Deaths\",\n                     hover_name=\"Country\/Region\", size=\"size\",hover_data = ['Country\/Region','Deaths'],\n                     projection=\"natural earth\",title='Death count::')\nfig.show()","c7a530c2":"world['size'] = world['Active'].pow(0.2)\nfig = px.scatter_geo(world, locations=\"Country\/Region\",locationmode='country names', color=\"Active\",\n                     hover_name=\"Country\/Region\", size=\"size\",hover_data = ['Country\/Region','Active'],\n                     projection=\"natural earth\",title='active cases in different areas of world::')\nfig.show()","e0e5d4af":"top = data1[data1['Date'] == data1['Date'].max()]\nrecents = top.groupby(by = 'Country\/Region')['Confirmed'].sum().sort_values(ascending = False).head(20).reset_index()\n\nmpl.figure(figsize= (10,7))\n# mpl.xticks(fontsize = 5)\n# mpl.yticks(fontsize = 5)\nmpl.xlabel(\"Total cases\")\nmpl.ylabel('Country')\nmpl.title(\"Countries with max cases\")\nax = sns.barplot(x = recents.Confirmed, y = recents['Country\/Region'])\nfor i, (value, name) in enumerate(zip(recents.Confirmed,recents['Country\/Region'])):\n    ax.text(value, i-.05, f'{value:,.0f}',  size=10, ha='left',  va='center')\nax.set(xlabel='Total cases', ylabel='Country')","8d694db9":"# predicts for future lets say, august\n\ntime_series_data = data1[['Date', 'Confirmed']].groupby('Date', as_index = False).sum()\ntime_series_data.columns = ['ds', 'y']\ntime_series_data.ds = pd.to_datetime(time_series_data.ds)\n","ec5bb367":"time_series_data.head()","ddbc3b5a":"train_range = np.random.rand(len(time_series_data)) < 0.8\ntrain_ts = time_series_data[train_range]\ntest_ts = time_series_data[~train_range]\ntest_ts = test_ts.set_index('ds')","7ccb6cb1":"# now, les try prophet model ","1a491075":"prophet_model = Prophet()\nprophet_model.fit(train_ts)","ac98857e":"future = pd.DataFrame(test_ts.index)\npredict = prophet_model.predict(future)\nforecast = predict[['ds', 'yhat', 'yhat_lower', 'yhat_upper']]\nforecast = forecast.set_index('ds')","6411b8bf":"prediction_fig = go.Figure() \nprediction_fig.add_trace(go.Scatter(\n                x= time_series_data.ds,\n                y= time_series_data.y,\n                name = \"true values\",\n                line_color= \"red\",\n                opacity= 0.8))\nprediction_fig.add_trace(go.Scatter(\n                x= forecast.index,\n                y= forecast.yhat,\n                name = \"Predicted values\",\n                line_color= \"yellow\",\n                opacity= 0.8))\nprediction_fig.update_layout(title_text= \"Forecasting::\", \n                             xaxis_title=\"time(months)\", yaxis_title=\"prediction of Cases\",)\n\nprediction_fig.show()","afad641b":"prophet_model = Prophet()\nprophet_model.fit(time_series_data)\n\nfuture = prophet_model.make_future_dataframe(periods=150)\nforecast = prophet_model.predict(future)\nforecast = forecast.set_index('ds')\n\nprediction_fig = go.Figure() \nprediction_fig.add_trace(go.Scatter(\n                x= time_series_data.ds,\n                y= time_series_data.y,\n                name = \"Actual\",\n                line_color= \"green\",\n                opacity= 0.8))\nprediction_fig.add_trace(go.Scatter(\n                x= forecast.index,\n                y= forecast.yhat,\n                name = \"Prediction\",\n                line_color= \"yellow\",\n                opacity= 0.8))\nprediction_fig.update_layout(title_text= \"Forecasting\", \n                             xaxis_title=\"time(months)\", yaxis_title=\"prediction of cases\",)\n\nprediction_fig.show()","ac802b40":"hello everyone!!\n\n> In this notebook i have tried to analyse covid19 dataset and predict the number of cases for upcoming months.i have used **fbprophet model** for forecasting.\n> this model produces a  straightforward, reasonable, accurate and customised forecast many datasets."}}