{"cell_type":{"98bcd372":"code","8b15b1b6":"code","2e6600df":"code","19863268":"code","22c78e18":"code","5d2eb86e":"code","1b3c225f":"code","856e19ae":"code","80dc210f":"markdown","e9d67a2e":"markdown","f1e591b5":"markdown","b185f64a":"markdown","b01c1938":"markdown","38309798":"markdown"},"source":{"98bcd372":"# importing required packages\nimport pandas as pd\nimport numpy as np\nfrom sklearn.model_selection import train_test_split, RepeatedStratifiedKFold, cross_val_score\nfrom sklearn.discriminant_analysis import LinearDiscriminantAnalysis \nfrom sklearn import datasets\nimport matplotlib.pyplot as plt","8b15b1b6":"# load iris dataset\niris=datasets.load_iris()","2e6600df":"# convert dataset into a pandas dataframe\ndf = pd.DataFrame(data = np.c_[iris['data'], iris['target']],\n                 columns = iris['feature_names'] + ['target'])\ndf['species'] = pd.Categorical.from_codes(iris.target, iris.target_names)\ndf.columns = ['s_length', 's_width', 'p_length', 'p_width', 'target', 'species']\n","19863268":"df.head()","22c78e18":"# fitting the model\nX = df[['s_length', 's_width', 'p_length', 'p_width']]\ny = df['species']\n\nmodel = LinearDiscriminantAnalysis()\nmodel.fit(X, y)","5d2eb86e":"# evaluating the model\ncv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)\nscores = cross_val_score(model, X, y, scoring='accuracy', cv=cv, n_jobs=-1)\nprint(np.mean(scores))","1b3c225f":"X = iris.data\ny = iris.target\nmodel = LinearDiscriminantAnalysis()\ndata_plot = model.fit(X, y).transform(X)\ntarget_names = iris.target_names\n\n\nplt.figure()\ncolors = ['red', 'green', 'blue']\nlw = 2\nfor color, i, target_name in zip(colors, [0, 1, 2], target_names):\n    plt.scatter(data_plot[y == i, 0], data_plot[y == i, 1], alpha=.8, color=color,\n                label=target_name)\n\nplt.legend(loc='best', shadow=False, scatterpoints=1)\nplt.show()","856e19ae":"# define new observation\nnew = [5, 2, 1, .4]\n\n# predict which class the new observation belongs to\nmodel.predict([new])","80dc210f":"### Prediction\nWe can also use the model to predict which class a new flower belongs to, based on input values","e9d67a2e":"### Visualize the results","f1e591b5":"The model predicts this new observation to belong to the species called setosa.","b185f64a":"# Linear Discriminant Analysis\n\nWe are going to implement LDA using the iris dataset. We can get the dataset from scikit-learn package. Iris is a three class dataset.","b01c1938":"### We\u2019ll build a linear discriminant analysis model to classify which species a given flower belongs to.\n We\u2019ll use the following predictor variables in the model:\n\n    Sepal length\n    Sepal width\n    Petal length\n    Petal width\n    \nAnd we\u2019ll use them to predict the response variable Species, which takes on the following three potential classes:\n\n    setosa\n    versicolor\n    virginica","38309798":"We can clearly see that the three classes are seperated and can be distinguished easily."}}