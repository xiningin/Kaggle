{"cell_type":{"3c3a0135":"code","2495c1d5":"code","219471a6":"code","1caa1d8d":"code","9e7a67e1":"code","224ee2ed":"code","913815b2":"code","b70f7f2d":"code","5af7ff9f":"markdown","abe471ca":"markdown","99039651":"markdown","99729e70":"markdown","7597f4b9":"markdown","dcd7c950":"markdown","924b1eb7":"markdown","860da104":"markdown"},"source":{"3c3a0135":"!pip install -qq --upgrade wandb","2495c1d5":"import os\nimport random\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom tqdm import tqdm\n\nimport wandb\nwandb.login()","219471a6":"ROOT_PATH = '..\/input\/happy-whale-and-dolphin'\nIMGS_DIR = f'{ROOT_PATH}\/train_images'\ndf = pd.read_csv(f'{ROOT_PATH}\/train.csv')\ndf.head()","1caa1d8d":"unique_species = df.species.unique()\nprint(unique_species)\nprint('Num of unique species: ', len(unique_species))","9e7a67e1":"df.species.value_counts()","224ee2ed":"print('Number of unique individual_ids: :', len(df.individual_id.unique()))","913815b2":"df.individual_id.value_counts()","b70f7f2d":"# Initialize a W&B run\nrun = wandb.init(project='happywhale_eda')\n\n# Initialize an empty W&B Table\ndata_table = wandb.Table(columns=['individual_id', 'image_1', 'image_2', 'image_3', 'image_4', 'image_5'])\n\nfor unique_id, tmp_df in tqdm(df.groupby('individual_id')):\n    if len(tmp_df) > 5:\n        # Sample 5 images randomly\n        sample_imgs = random.sample(list(tmp_df.image.values), 5)\n        # Add data to the table row-wise\n        data_table.add_data(unique_id,\n                            wandb.Image(f'{IMGS_DIR}\/{sample_imgs[0]}'),\n                            wandb.Image(f'{IMGS_DIR}\/{sample_imgs[1]}'),\n                            wandb.Image(f'{IMGS_DIR}\/{sample_imgs[2]}'),\n                            wandb.Image(f'{IMGS_DIR}\/{sample_imgs[3]}'),\n                            wandb.Image(f'{IMGS_DIR}\/{sample_imgs[4]}'))\n        \n# Log the table\nwandb.log({'mapping_table': data_table})\n\n# Finish the run\nwandb.finish()","5af7ff9f":"> There are species with just one image associated with them. It's gonna be hard to cluster these individual species. It would be worse if they belong to sparse species. ","abe471ca":"> Most of the species have `_whale` or `_dolphine` identifiers. \n\n> There are total of 30 unique species. \n\n> `beluga` is whale; what's `globis`?","99039651":"> Images are of varying sizes.\n\n> Images are of whale\/dolphin humpback (+dorsal fins, backs, heads and flanks).","99729e70":"## Map `individual_id` to Images\n\nWe will be using [W&B Tables](https:\/\/docs.wandb.ai\/guides\/data-vis) feature to easily build log images belonging to unique `individual_id`. W&B Tables is like a 2D grid (spreadsheet) which supports rich media and interactiveness. For simplicity and memory consideration we will log at max 5 images per unique id. We are also going to log for those ids that has more than 5 images. This is our first look at the data. ","7597f4b9":"## `species`","dcd7c950":"Check out this cool Table here: http:\/\/wandb.me\/happywhale-tables\n\n![img](https:\/\/i.imgur.com\/txSOmzH.mp4)","924b1eb7":"## `individual_id`s","860da104":"> It's gonna be hard to identify few species. "}}