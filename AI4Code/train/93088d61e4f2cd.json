{"cell_type":{"394069fb":"code","8f23252c":"code","c9390118":"code","8059bc7c":"code","bd827ff6":"code","3d01a371":"code","fe71707a":"code","51fb8eb7":"code","99e6f32b":"code","dfbf25ae":"code","03d3911a":"code","16ad0abc":"code","460618c7":"code","be936486":"code","9c39b6d0":"code","aaccdf0b":"code","4fe63496":"markdown","b86cc830":"markdown","8cba2f16":"markdown","547333fb":"markdown","b5a6b425":"markdown","e92f9577":"markdown","c1775ad4":"markdown"},"source":{"394069fb":"!pip install pycaret","8f23252c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom pycaret.regression import setup, compare_models, blend_models, finalize_model, predict_model","c9390118":"train = pd.read_csv('..\/input\/home-data-for-ml-course\/train.csv')\ntest = pd.read_csv('..\/input\/home-data-for-ml-course\/test.csv')","8059bc7c":"train.corr()['SalePrice'].sort_values(ascending= False)","bd827ff6":"sns.scatterplot(train['GrLivArea'], train['SalePrice']);","3d01a371":"train.drop(index = train[(train['GrLivArea'] > 4000) & (train['SalePrice']<300000)].index, inplace= True)","fe71707a":"all_data = pd.concat([train, test])","51fb8eb7":"all_data2 = all_data.drop(columns = ['Id'])\nall_data2['MSSubClass'] = all_data2['MSSubClass'].astype('object')\nall_data2 = pd.get_dummies(all_data2)\nall_data2","99e6f32b":"all_data2 = all_data2.fillna(-1)","dfbf25ae":"train2 = all_data2[:len(train)]\ntest2 = all_data2[len(train):]","03d3911a":"fig, ax = plt.subplots(1, 2, figsize=(12,6))\nsns.distplot(train2['SalePrice'], ax=ax[0])\nsns.distplot(np.log(train2['SalePrice']), ax=ax[1])\nplt.tight_layout()\nplt.show()","16ad0abc":"train2['SalePrice'] = np.log(train2['SalePrice'])","460618c7":"def pycaret_model(train, target, test, n_select, fold, opt):\n  print('Setup Your Data....')\n  setup(data=train,\n              target=target,\n              normalize = True,\n              silent= True)\n  \n  print('Comparing Models....')\n\n  best = compare_models(sort=opt, n_select=n_select, fold = fold, exclude=['xgboost'])\n  print('Blending Models....')\n  blended = blend_models(estimator_list= best, fold=fold, optimize=opt)\n  pred_holdout = predict_model(blended)\n  print('Finallizing Models....')\n  final_model = finalize_model(blended)\n  print('Done...!!!')\n  pred_esb = predict_model(final_model, test)\n  re = pred_esb['Label']\n\n  return re","be936486":"result = np.exp(pycaret_model(train2, 'SalePrice', test2, 3, 10, 'RMSE'))","9c39b6d0":"sub = pd.read_csv('..\/input\/home-data-for-ml-course\/sample_submission.csv')\nsub['SalePrice'] = result\nsub","aaccdf0b":"sub.to_csv('sub.csv', index=False)","4fe63496":"## **There are 2 outliers!!!**\n\n*  **GrLivArea > 4000**\n*  **SalePrice < 300000**","b86cc830":"# Modeling!!!","8cba2f16":"## Preprocessing!","547333fb":"## Data Load","b5a6b425":"# Using pycaret, You can easily be on top 2% !!","e92f9577":"## Target Data is skewed!! So we need to scale it","c1775ad4":"## Need to remove outliers!"}}