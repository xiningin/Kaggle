{"cell_type":{"f612e8f2":"code","12bd3d67":"code","2eeabe46":"code","ff86047d":"code","9eae27e1":"code","178cff97":"code","3f002111":"code","1319b469":"code","28523860":"code","3c0ed96c":"markdown","25885289":"markdown"},"source":{"f612e8f2":"import numpy as np\nimport pandas as pd","12bd3d67":"ratings = pd.read_csv('..\/input\/movielens\/ratings.csv')\nmovies = pd.read_csv('..\/input\/movielens\/movies.csv')\n\nmovies = movies.set_index('movieId')\nratings = ratings.set_index('userId')","2eeabe46":"def best_seller_recom(n_items):\n    return movies.loc[mean_ratings.sort_values(ascending=False)[:n_items].index]['title']","ff86047d":"mean_ratings = ratings.groupby(['movieId'])['rating'].mean()\nbest_seller_recom(5)","9eae27e1":"ratings = pd.read_csv('..\/input\/movielens\/ratings.csv')\nmovies = pd.read_csv('..\/input\/movielens\/movies.csv')\n\nratings = ratings.drop('timestamp', axis=1)","178cff97":"from sklearn.model_selection import train_test_split\nx = ratings.copy()\ny = ratings['userId']\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, stratify=y)\n\nmean_ratings = x_train.groupby(['movieId'])['rating'].mean()","3f002111":"def RMSE(y_true, y_pred):\n    return np.sqrt(np.mean((np.array(y_true) - np.array(y_pred))**2))\n\ndef score(model):\n    id_pairs = zip(x_test['userId'], x_test['movieId'])\n    y_pred = np.array([model(user, movie) for (user, movie) in id_pairs])\n    y_true = np.array(x_test['rating'])\n    return RMSE(y_true, y_pred)","1319b469":"def best_seller(user_id, movie_id):\n    if movie_id in mean_ratings:\n        return mean_ratings[movie_id]\n    else:\n        return 3.0","28523860":"score(best_seller)","3c0ed96c":"# Best Seller \ucd94\ucc9c","25885289":"# \uc815\ud655\ub3c4 \uce21\uc815"}}