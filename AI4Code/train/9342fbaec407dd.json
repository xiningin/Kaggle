{"cell_type":{"7eb3f9e1":"code","99c604a5":"code","b3d8b8dd":"code","47b2f8da":"code","28484775":"code","41c74d03":"code","a6194737":"code","66fa6400":"code","c7828f23":"code","961397ce":"code","606d4769":"code","ccc04bf9":"markdown"},"source":{"7eb3f9e1":"from load_kaggle import load_kaggle","99c604a5":"subm, train, test = load_kaggle()\nprint(train.shape)\ntrain.head()","b3d8b8dd":" ### you can do either pip install from pypi or from the github\n# !pip install deep_autoviml\n# !pip install git+https:\/\/github.com\/AutoViML\/deep_autoviml.git","47b2f8da":"from deep_autoviml import deep_autoviml as deepauto","28484775":"######   D E F A U L T S    S E T T I N G S   F O R   D E E P    A U T O  V I M L ###\nkeras_model_type =  \"fast1\" ## try \"fast\" first, then \"fast1\" and \"fast2\", finally \"auto\"\n### always set early_stopping to True first and then change it to False\n#### You always need 15 max_trials to get something decent #####\n#### always set tuner to \"storm\" and then \"optuna\". \n### NLP char limit kicks off NLP processing. Feature Cross later.\nmodel_options = {'nlp_char_limit':50, 'cat_feat_cross_flag':\"both\",\n                 'max_trials': 10, \"tuner\": \"storm\"}\nkeras_options = {\"patience\":10, 'class_weight': True, 'early_stopping': True, \n                 'lr_scheduler': ''}\nproject_name = 'TPS_March'\nsave_model_flag = False","41c74d03":"target = 'target'","a6194737":"model, cat_vocab_dict = deepauto.fit(train, target, keras_model_type=keras_model_type,\n\t\tproject_name=project_name, keras_options=keras_options,  \n\t\tmodel_options=model_options, save_model_flag=True, use_my_model='',\n\t\tmodel_use_case='', verbose=1)","66fa6400":"predictions = deepauto.predict(model, project_name, test_dataset=test,\n                                 keras_model_type=keras_model_type, \n                                 cat_vocab_dict=cat_vocab_dict)","c7828f23":"y_preds = predictions[0][:,1]\ny_preds","961397ce":"\nsubm[target] = y_preds\nsubm.head()","606d4769":"subm.to_csv('submission.csv',index=False)\nsubm.head()","ccc04bf9":"# deep_autoviml is a tensorflow 2.5-powered, keras-based, model and pipeline building auto-ml library\n## It will automatically do the following:\n- Load a preselected keras model template that will select the hidden layers\n- Load train, test files containing training and testing data\n- For NLP task: select a BERT or USE model along with preprocessors\n- Run a tuner named Storm-Tuner to select the best hyper params\n- Train and run predictions using just one line of code each\n## Keras preprocessing layers enable you to encapsulate feature engineering and hidden layers into the model itself. This makes the process for training and predictions the same: just feed input data (in the form of files or dataframes) and the model will take care of all preprocessing before predictions."}}