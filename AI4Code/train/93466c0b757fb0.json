{"cell_type":{"8c0c214d":"code","0931e7f1":"code","d7d48406":"code","03dfaefe":"code","c205c5d2":"code","60016e48":"code","9ca9fa30":"code","fbf9c99e":"code","4a67d69a":"code","3ef5dfe3":"code","90c17f03":"code","74d03751":"code","36260ad1":"code","328ccd71":"code","e8a87855":"code","15d29cf0":"code","a6e0933b":"code","5110afc6":"code","60c06d51":"code","f71da298":"code","6d094b17":"code","173dca8b":"code","09607ccc":"code","bda97ba9":"markdown","9a1199b3":"markdown","db0186a8":"markdown","6c23a681":"markdown"},"source":{"8c0c214d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n\n# %matplotlib inline\nplt.style.use(\"ggplot\")\n\nimport sklearn\nfrom sklearn.decomposition import TruncatedSVD\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","0931e7f1":"amazon_rate = pd.read_csv('..\/input\/amazon-ratings\/ratings_Beauty.csv')\namazon_rate= amazon_rate.dropna()\namazon_rate.head()\n#print(amazon_rate.shape)","d7d48406":"popular = pd.DataFrame(amazon_rate.groupby('ProductId')['Rating'].count())\nBest = popular.sort_values('Rating',ascending=False)\nBest.head(10)","03dfaefe":"Best.head(30).plot(kind='bar')","c205c5d2":"amazon_rating = amazon_rate.head(10000)","60016e48":"utlity_matrix = amazon_rating.pivot_table(values='Rating',index='UserId',columns= 'ProductId',fill_value=0)\nutlity_matrix.head()","9ca9fa30":"utlity_matrix.shape","fbf9c99e":"X = utlity_matrix.T\nX.head()","4a67d69a":"X.shape","3ef5dfe3":"SVD = TruncatedSVD(n_components=10)\ndecomposed = SVD.fit_transform(X)\ndecomposed.shape","90c17f03":"correlation = np.corrcoef(decomposed)\ncorrelation","74d03751":"X.sample(3)","36260ad1":"i = X.index[400]\nproduct = list(X.index)\nproduct_ID = product.index(i)\nproduct_ID\n","328ccd71":"corr_prodID = correlation[product_ID]\ncorr_prodID","e8a87855":"Recommend = list(X.index[corr_prodID > 0.9])\nRecommend.remove(i)\nRecommend[0:8]","15d29cf0":"Product_descrip = pd.read_csv('..\/input\/product-description-amazon\/product_descriptions.csv')\nProduct_descrip = Product_descrip.dropna()\nProduct_descrip.head()","a6e0933b":"Prod_descrip = Product_descrip.head(700)\nProd_descrip['product_description'].head(10)","5110afc6":"from sklearn.feature_extraction.text import TfidfVectorizer, CountVectorizer\nfrom sklearn.neighbors import NearestNeighbors\nfrom sklearn.cluster import KMeans\nfrom sklearn.metrics import adjusted_rand_score","60c06d51":"vectorizer = TfidfVectorizer(stop_words='english')\nData = vectorizer.fit_transform(Prod_descrip[\"product_description\"])\nData","f71da298":"X=Data\n\nkmeans = KMeans(n_clusters = 10, init = 'k-means++')\ny_kmeans = kmeans.fit_predict(X)\nplt.plot(y_kmeans, \".\")\nplt.show()\n","6d094b17":"# Cluster \n\nTrue_k = 10\nmodel = KMeans(n_clusters=True_k, init='k-means++', max_iter=100, n_init=1)\nmodel.fit(Data)","173dca8b":"print(\"Top terms\/ Clusters :\" )\norder = model.cluster_centers_.argsort()[:,::-1]\nterms = vectorizer.get_feature_names()\nfor a in range(True_k):\n    print(\"Cluster %d:\" % a),\n    for i in order[a, :10]:\n        print(' %s' % terms[i]),\n    print","09607ccc":"print(\"Cluster ID:\")\nM = vectorizer.transform([\"privacy\"])\nPrediction = model.predict(M)\nprint(Prediction)","bda97ba9":"Recommendation system ","9a1199b3":"Taking product '9790781946'","db0186a8":"Recommendation top 10 products\n","6c23a681":"Isolating a product ID from correlating\nAssuming that customer buys With a product ID\n"}}