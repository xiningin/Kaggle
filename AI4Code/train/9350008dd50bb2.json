{"cell_type":{"2b90faa2":"code","2b9460c7":"code","897ec21e":"code","f5ddcb93":"code","87c54b3a":"code","25401b02":"code","bca7cfc8":"code","b00db3d7":"code","8cdceecf":"code","bf80d656":"code","d71979c9":"code","0b77b4aa":"code","6d9aea79":"code","61cfcf9b":"code","7aa6097d":"code","eab9d859":"code","0c17e1f1":"code","24777ca3":"code","55551568":"code","52d83583":"code","4f2694f3":"code","3ab2c6a6":"markdown","04660daa":"markdown","4d2b137b":"markdown","326334d5":"markdown","97d87175":"markdown","5100d31d":"markdown"},"source":{"2b90faa2":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","2b9460c7":"#importing dataset\ndf=pd.read_csv('..\/input\/heart-failure-prediction\/heart.csv')\ndf.head()","897ec21e":"df.shape","f5ddcb93":"df.info()","87c54b3a":"df.describe()","25401b02":"df.isnull().sum()\n#There is no null values","bca7cfc8":"sns.pairplot(df,hue='HeartDisease')\n","b00db3d7":"corr = df.corr()\ncorr.style.background_gradient(cmap='coolwarm')","8cdceecf":"fig = plt.figure(figsize = (15,20))\nax = fig.gca()\ndf.hist(ax = ax)","bf80d656":"df.HeartDisease.value_counts().plot(kind='bar')\nplt.xlabel(\"Heart Diseases or Not\")\nplt.ylabel(\"Count\")\nplt.title(\"Heart Diseases\")\n#Here we can see that dataset is not much imbalanced so there is no need to balance.","d71979c9":"cat = ['Sex','ChestPainType','RestingECG','ExerciseAngina','ST_Slope']","0b77b4aa":"from sklearn.preprocessing import LabelEncoder\nlb=LabelEncoder()\ndf[cat] = df[cat].apply(lb.fit_transform)\n","6d9aea79":"from sklearn.model_selection import train_test_split\n\nX_train, X_test = train_test_split(df,test_size=0.2,random_state=0)\n","61cfcf9b":"X_train.shape","7aa6097d":"!pip install mxnet autogluon","eab9d859":"from autogluon.tabular import TabularDataset, TabularPredictor\nfrom autogluon.tabular.models.knn.knn_rapids_model import KNNRapidsModel\nfrom autogluon.tabular.models.lr.lr_rapids_model import LinearRapidsModel","0c17e1f1":"X_train.head()","24777ca3":"label = 'HeartDisease'","55551568":"predictor = TabularPredictor(\n    label=label\n).fit(\n    X_train,\n    presets='best_quality',\n    hyperparameters={\n        KNNRapidsModel: {},\n        LinearRapidsModel: {},\n        'RF': {},\n        'XGB': {'ag_args_fit': {'num_gpus': 1}},\n        'CAT': {'ag_args_fit': {'num_gpus': 1}},\n        'GBM': [{}, {'extra_trees': True, 'ag_args': {'name_suffix': 'XT'}}, 'GBMLarge'],\n        'NN': {'ag_args_fit': {'num_gpus': 1}},\n        'FASTAI': {'ag_args_fit': {'num_gpus': 1}},\n    },\n)","52d83583":"pred_probs = predictor.predict_proba(X_test)\npred_probs.head(5)","4f2694f3":"predictor.leaderboard(silent=True)","3ab2c6a6":"# Data Exploration","04660daa":"# Using AutoGluon","4d2b137b":"# Data Preprocessing","326334d5":"  5. Which are most useful variable in classification? Prove using correlation.","97d87175":"\n Now we can plot the distribution of data wrt dependent variable i.e HeartDisease","5100d31d":"# **Heart Failure Prediction Using AutoGluon!**\nIn this notebook we will see a short demonstration of an automl library i.e AutoGluon for classification task. Please Upvote if you find something usefull."}}