{"cell_type":{"8fc48469":"code","0d0353c4":"code","573b5fdc":"code","13fc1e85":"code","438237d9":"code","41885aeb":"code","27eb86b0":"code","ff85b0c3":"code","af92b53e":"code","a3711ca6":"code","6bad49d5":"code","29369b2f":"code","e6bf01b6":"code","d203952d":"code","71d5c1c5":"code","af8a6a32":"code","a2d0fe5d":"code","c5aa315e":"code","2fe02d33":"code","8fe92c85":"code","4021e6c3":"code","40ef9629":"code","42a21625":"code","bedc885a":"code","6a31ebc7":"code","8273a793":"code","b81cddd3":"markdown","424afc9a":"markdown","8a5f969d":"markdown","93da8be2":"markdown","9fa4dbc8":"markdown","d5b38f9e":"markdown","2cb21831":"markdown","feb48149":"markdown","fbadc588":"markdown","c84303d5":"markdown","844bcf22":"markdown","d13acd29":"markdown","40e7d037":"markdown","1e890787":"markdown","d819b92b":"markdown","cade119d":"markdown","deb6923d":"markdown","ff2ec6b7":"markdown","f9e10ce0":"markdown","4f221056":"markdown"},"source":{"8fc48469":"import pandas as pd\nimport sklearn\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sns\n\nfrom sklearn.linear_model import LinearRegression, Lasso, Ridge\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.model_selection import cross_val_score","0d0353c4":"dtrain = pd.read_csv(\"..\/input\/atividade-regressao-PMR3508\/train.csv\", index_col=['Id'])","573b5fdc":"dtrain.shape","13fc1e85":"dtrain.describe()","438237d9":"dtrain.head()","41885aeb":"mascara=np.triu(np.ones_like(dtrain.corr(), dtype=np.bool))\n\nplt.figure(figsize=(10,10))\nsns.heatmap(dtrain.corr(), annot=True, mask=mascara, vmin=-1.0, vmax=1.0, cmap=\"summer\")\nplt.show()","27eb86b0":"dtest=pd.read_csv(\"..\/input\/atividade-regressao-PMR3508\/test.csv\" , index_col=['Id'])","ff85b0c3":"dtest.shape","af92b53e":"dtest.head()","a3711ca6":"dtest","6bad49d5":"dtrain[\"rooms_per_household\"]=dtrain[\"total_rooms\"]\/dtrain[\"households\"]\ndtrain[\"rooms_per_population\"]=dtrain[\"total_rooms\"]\/dtrain[\"population\"]\ndtrain[\"lat_long\"]=dtrain[\"latitude\"]\/dtrain[\"longitude\"]\ndtrain[\"long_lat\"]=dtrain[\"longitude\"]\/dtrain[\"latitude\"]\n\ndtest[\"rooms_per_household\"]=dtest[\"total_rooms\"]\/dtest[\"households\"]\ndtest[\"lat_long\"]=dtest[\"latitude\"]\/dtest[\"longitude\"]\n\nlista_atributos=[\"rooms_per_household\",\"lat_long\",\"median_income\"]","29369b2f":"dtrain.corr()[\"median_house_value\"].sort_values()","e6bf01b6":"dtrain.drop_duplicates(keep=\"first\", inplace=True)","d203952d":"Ydtrain = dtrain.pop(\"median_house_value\").values.astype(float)\nXdtrain = dtrain[lista_atributos]\n\nXdtest = dtest[lista_atributos]","71d5c1c5":"Xdtrain","af8a6a32":"Xdtest","a2d0fe5d":"from sklearn.preprocessing import StandardScaler\n\nprepro = StandardScaler()\nXdtrain = prepro.fit_transform(Xdtrain)\nXdtest = prepro.fit_transform(Xdtest)","c5aa315e":"regression = LinearRegression()\nscore_reglin = cross_val_score(regression, Xdtrain, Ydtrain, cv=7)\n\nprint(\"Linear Regression: \",score_reglin.mean())","2fe02d33":"lasso = Lasso()\nscore_lasso = cross_val_score(lasso, Xdtrain, Ydtrain, cv=7)\n\nprint(\"Lasso: \",score_lasso.mean())","8fe92c85":"ridge = Ridge()\nscore_ridge = cross_val_score(ridge, Xdtrain, Ydtrain, cv=7)\n\nprint(\"Ridge: \",score_ridge.mean())","4021e6c3":"knn = KNeighborsRegressor(n_neighbors=24, p=1)\nscore_knn = cross_val_score(knn, Xdtrain, Ydtrain, cv=9)\n\nprint(\"KNN: \",score_knn.mean())","40ef9629":"knn.fit(Xdtrain, Ydtrain)","42a21625":"Ydtest = knn.predict(Xdtest)","bedc885a":"Ydtest","6a31ebc7":"submission = pd.DataFrame()\nsubmission[0] = dtest.index\nsubmission[1] = Ydtest\nsubmission.columns = [\"Id\",\"median_house_value\"]\nsubmission.head()","8273a793":"submission.to_csv(\"submission.csv\", index = False)","b81cddd3":"A fun\u00e7\u00e3o pandas.DataFrame.shape() retorna uma tupla contendo as dimens\u00f5es do objeto\nDataFrame.","424afc9a":"Com o comando .drop_duplicates(), \u00e9 feita a remo\u00e7\u00e3o de linhas duplicadas.","8a5f969d":"## 3. Modelos de predi\u00e7\u00e3o\n### 3.1. Regress\u00e3o Linear\nO primeiro modelo que utilizaremos \u00e9 o de Regress\u00e3o Linear, utilizando a m\u00e9trica R2. ","93da8be2":"### 3.4. KNN\nPor fim, analisaremos a estrat\u00e9gia KNN.","9fa4dbc8":"A fun\u00e7\u00e3o pandas.DataFrame.head() permite visualizar as primeiras n linhas do objeto DataFrame\n(5 por padr\u00e3o).","d5b38f9e":"### 2.2. Prepara\u00e7\u00e3o dos dados\n\nO pr\u00f3ximo passo \u00e9 criar novas tabelas com os dados que ser\u00e3o considerados para a constru\u00e7\u00e3o do modelo, com base nas an\u00e1lises feitas acima.","2cb21831":"### 1.2. DataFrames: Dados de Treino\n\nO pr\u00f3ximo passo \u00e9 criar as vari\u00e1veis para armazenar os arquivos csv (\"comma-separated values\", ou\n\"valores separados por v\u00edrgula\", em tradu\u00e7\u00e3o livre) contendo a base de dados de treino.","feb48149":"## 1. Introdu\u00e7\u00e3o\n\n### 1.1. Importa\u00e7\u00e3o das bibliotecas\n\nInicialmente, importamos as bibliotecas necess\u00e1rias para fazer a an\u00e1lise dos dados.\nA biblioteca pandas \u00e9 a principal respons\u00e1vel pela an\u00e1lise de dados.\nA sklearn, por sua vez, \u00e9 focada na \u00e1rea de intelig\u00eancia artificial.\nPor fim, a matplotlib \u00e9 usada primordialmente para a plotagem de gr\u00e1ficos.","fbadc588":"Com a an\u00e1lise do gr\u00e1fico acima, fica claro que boa parte dos atributos possuem alta correla\u00e7\u00e3o entre si, mas quase nenhuma correla\u00e7\u00e3o com a classe **median_house_value** (que \u00e9 o foco do nosso estudo). Por\u00e9m, o atributo **median_income** \u00e9 o que apresenta maior influ\u00eancia na classe em quest\u00e3o, ent\u00e3o o analisaremos melhor a seguir.","c84303d5":"### 1.3. Sele\u00e7\u00e3o de Dados\nDiante da quantidade consider\u00e1vel de atributos, faz-se necess\u00e1rio avaliar quais deles possuem correla\u00e7\u00e3o entre si.","844bcf22":"J\u00e1 a fun\u00e7\u00e3o describe() permite fazer uma r\u00e1pida an\u00e1lise dos dados num\u00e9ricos das tabelas, como m\u00e9dia, valores m\u00e1ximos e m\u00ednimos.","d13acd29":"### 3.3. Ridge\nAqui, faremos a regress\u00e3o Ridge, mantendo em mente os valores medidos e comparando com os demais.","40e7d037":"## 4. Modelo de Testes\nComo a maior pontua\u00e7\u00e3o obtida foi a da estrat\u00e9gia KNN, usaremos ela para a cria\u00e7\u00e3o do modelo para a base de testes.","1e890787":"## 2. An\u00e1lise dos dados\n\nO pr\u00f3ximo passo consiste em analisar os dados que mais diretamente parecem influenciar o target (median_house_value). Os tipos de dados que demonstram um comportamento n\u00e3o explicitamente relacionado ao valor residencial m\u00e9dio ser\u00e3o posteriormente ignorados na constru\u00e7\u00e3o do modelo.","d819b92b":"### 1.4. DataFrames: Dados de Teste\n\nAgora, ser\u00e1 feita a leitura do arquivo .csv contendo os dados de teste. Tal arquivo n\u00e3o cont\u00e9m a coluna \"median_house_value\", e \u00e9 justamente ela que ser\u00e1 estimada a seguir com a an\u00e1lise dos dados do arquivo de treino.","cade119d":"### 2.1. Cria\u00e7\u00e3o de novos atributos\n\nEm seguida, analisaremos alguns novos atributos que potencialmente possuem alta correla\u00e7\u00e3o com o target.","deb6923d":"### 3.2. Lasso\nEm seguida, faremos a regress\u00e3o lasso, comparando os valores alcan\u00e7ados por valida\u00e7\u00e3o cruzada aqui com os anteriores.","ff2ec6b7":"Para o treinamento do modelo, faz-se a separa\u00e7\u00e3o dos dados dos atributos.","f9e10ce0":"### 2.3. Pr\u00e9-processamento\nO pr\u00f3ximo passo consiste na normaliza\u00e7\u00e3o dos dados, atrav\u00e9s do StandardScaler.","4f221056":"## PMR3508-2020: Modelo de Regress\u00e3o \n### Valor Residencial M\u00e9dio na Calif\u00f3rnia"}}