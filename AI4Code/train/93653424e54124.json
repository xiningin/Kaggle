{"cell_type":{"ec3f4695":"code","50389d05":"code","046764f1":"code","493db72a":"code","b8b9e4c2":"code","453becd4":"code","42b63848":"code","91db467b":"code","75846db3":"code","c795c963":"code","dd8755bf":"code","385bbd55":"code","905c7b88":"code","1b690a7b":"code","e6021a3b":"code","1c5a50c8":"code","d69840d1":"code","7ed6e260":"code","e41103eb":"code","57d50ba9":"code","26706786":"code","d5895f56":"code","16dee1f7":"code","600d3e0f":"code","fd716341":"code","9671b402":"code","09396f0c":"code","5549e570":"code","bda76bbc":"code","21cab4cd":"code","ca373c02":"code","aa8bcb17":"code","51f155ca":"code","54184eb5":"code","849366c2":"code","22c33f92":"code","ca6a8c6c":"code","c8a0899c":"code","7fc086a0":"code","4da69c99":"code","a677e658":"code","61b43b57":"code","0d40f17a":"code","24d51e18":"code","58dfad7b":"code","ce4e6833":"code","f79c07bc":"code","dc5dd4b4":"code","243c4fc3":"code","0a5b6772":"code","070b01f5":"code","b8311786":"code","dcac9871":"code","fedcf948":"code","226acefc":"code","46f3b9e9":"code","bc95bfe9":"code","da87da47":"code","4744a386":"code","b30d4eb2":"code","dbd98657":"code","d42eebfe":"code","04e1bb3f":"code","dbffa811":"code","64ec4e5b":"code","377cec3c":"code","0c6cf19c":"code","0298ac95":"markdown","cb93cbdb":"markdown","f9cc7347":"markdown","39c3cbe0":"markdown"},"source":{"ec3f4695":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\n","50389d05":"x=np.array([6.5,6.8,7.0,8.0,8.5,9.8,10.5,5.5,5.0])\nx_=np.mean(x)\ny=np.array([180,195,210,235,280,350,400,170,160])\ny_=np.mean(y)","046764f1":"plt.scatter(x,y)","493db72a":"slope=np.sum((x-x_)*(y-y_))\/np.sum((x-x_)**2)","b8b9e4c2":"slope","453becd4":"np.cov(x,y,ddof=1)\/np.var(x,ddof=1)","42b63848":"intercept=y_-slope*(x_)\nintercept","91db467b":"ypred=intercept+slope*(x)","75846db3":"ypred","c795c963":"y","dd8755bf":"plt.plot(y,ypred,\"*\")","385bbd55":"np.sum((y-ypred))","905c7b88":"from sklearn.linear_model import LinearRegression","1b690a7b":"X=pd.DataFrame(x)","e6021a3b":"#inbuiltr mmodel approach\nmodel=LinearRegression()\nmodel.fit(X,y)\nmodel.predict(X)","1c5a50c8":"ypred #  formula approach","d69840d1":"model.coef_","7ed6e260":"model.intercept_","e41103eb":"plt.plot(x,y,'*')\nplt.plot(x,ypred,'o-')","57d50ba9":"X1=pd.DataFrame([7.5])","26706786":"model.predict(X1)","d5895f56":"import statsmodels.formula.api as smf","16dee1f7":"A=pd.DataFrame({'bmi':[6.5,6.8,7.0,8.0,8.5,9.8,10.5,5.5,5.0],'glu':[180,195,210,235,280,350,400,170,160]})","600d3e0f":"statmoddel=smf.ols('glu~bmi',A).fit()","fd716341":"yypred=statmoddel.predict(A['bmi'])","9671b402":"statmoddel.params","09396f0c":"statmoddel.summary()","5549e570":"plt.plot(y,ypred,'*')","bda76bbc":"cor=np.corrcoef(y,ypred)\ncor","21cab4cd":"cor*cor","ca373c02":"sse=sum((y-ypred)**2)\nsse","aa8bcb17":"var=sum((y-np.mean(y))**2)\nvar","51f155ca":"1-(sse\/var)","54184eb5":"Data=pd.read_csv('..\/input\/car-mpg (1).csv')","849366c2":"Data.describe().T","22c33f92":"Data.head()","ca6a8c6c":"Data.info()","c8a0899c":"Data['hp'].unique()","7fc086a0":"temp=pd.DataFrame(Data.hp.str.isdigit())","4da69c99":"temp[temp['hp']==False]","a677e658":"Data.hp.replace('?',np.NaN,inplace=True)","61b43b57":"Data.hp.unique()","0d40f17a":"Data[Data.isnull().any(axis=1)]","24d51e18":"Data.hp=Data.hp.fillna(Data['hp'].median())","58dfad7b":"Data.hp.dtype","ce4e6833":"Data.hp=Data.hp.astype('float64')","f79c07bc":"Data.hp.dtype","dc5dd4b4":"Data.info()","243c4fc3":"Data=Data.drop('car_name',axis=1)","0a5b6772":"Data.corr()","070b01f5":"sns.pairplot(Data,diag_kind='kde')","b8311786":"Data.columns","dcac9871":"import statsmodels.formula.api as smf\nm1=smf.ols('mpg~cyl+disp+hp+wt+acc+yr+origin+car_type',Data).fit()","fedcf948":"m1.summary()","226acefc":"Data=Data.drop('acc',axis=1)","46f3b9e9":"m1=smf.ols('mpg~cyl+disp+hp+wt+yr+origin+car_type',Data).fit()","bc95bfe9":"m1.summary()","da87da47":"x=Data.drop('mpg',axis=1)\ny=Data[['mpg']]","4744a386":"from sklearn.model_selection import train_test_split","b30d4eb2":"X_train,X_test,Y_train,Y_test=train_test_split(x,y,test_size=0.3,random_state=2)","dbd98657":"from sklearn.linear_model import LinearRegression","d42eebfe":"LR=LinearRegression()\nLR.fit(X_train,Y_train)\nmpg_pred=LR.predict(X_test)","04e1bb3f":"LR.score(X_test,Y_test)# adjusted R2","dbffa811":"from sklearn import metrics","64ec4e5b":"rmse=np.sqrt(metrics.mean_squared_error(Y_test,mpg_pred))\nrmse","377cec3c":"LR.score(X_test,Y_test)","0c6cf19c":"plt.plot(Y_test,mpg_pred,'*')","0298ac95":"# linear regression ","cb93cbdb":"# R2","f9cc7347":"###### heare the p value for Acc is higher that 0.05 then we it is not much significant in the linear model so we are droping acc","39c3cbe0":"# Linear regression "}}