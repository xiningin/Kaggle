{"cell_type":{"c451901b":"code","6aa0345c":"code","46854800":"code","4cc048bb":"code","225251f9":"code","c263905e":"code","ba38490e":"code","73620106":"code","8485bae3":"code","7154f2ad":"code","9686185b":"code","5191dde5":"code","7df63ce4":"code","39dde3c8":"code","26ca57e9":"code","57bf09fe":"code","89dd8737":"code","204c5a4e":"code","de16c362":"code","8c499b5e":"code","05a7e8f9":"code","32ccbc24":"code","7d4b5f35":"code","6a20c714":"code","cd0e5cba":"code","3bec0a5d":"code","f7039ade":"code","1b57747a":"code","167690cf":"markdown","2d0a2c90":"markdown","30457e93":"markdown","811f6d1b":"markdown"},"source":{"c451901b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","6aa0345c":"import pandas as pd\nfrom surprise import Reader, SVD, Dataset, accuracy\nfrom surprise.model_selection import GridSearchCV, train_test_split, cross_validate","46854800":"# movies and their ratings have been merged\n\nmovie = pd.read_csv('..\/input\/moviee-rating\/movie.csv')\nrating = pd.read_csv('..\/input\/moviee-rating\/rating.csv')\ndf = movie.merge(rating, how=\"left\", on=\"movieId\")\ndf.head()\n","4cc048bb":"df.shape","225251f9":"# random 4 movies ID have been chosen\n\nmovie_ids = [130219, 356, 4422, 541]\nmovies = [\"The Dark Knight (2011)\",\n          \"Cries and Whispers (Viskningar och rop) (1972)\",\n          \"Forrest Gump (1994)\",\n          \"Blade Runner (1982)\"]","c263905e":"sample_df = df[df.movieId.isin(movie_ids)]","ba38490e":"sample_df.shape","73620106":"sample_df.head()","8485bae3":"# creating user movie matirix\n\nuser_movie_df = sample_df.pivot_table(index=[\"userId\"], columns=[\"title\"], values=\"rating\")","7154f2ad":"user_movie_df.shape\nuser_movie_df.head()","9686185b":"# surprise module wants to have specific scale\n\nreader = Reader(rating_scale=(1, 5))","5191dde5":"# surprise module wants to have specific df shape\n\ndata = Dataset.load_from_df(sample_df[['userId', 'movieId', 'rating']], reader)","7df63ce4":"trainset, testset = train_test_split(data, test_size=.25)","39dde3c8":"# Create empty SVD model\nsvd_model = SVD()\n\n# fitting\nsvd_model.fit(trainset)","26ca57e9":"# prediction\npredictions = svd_model.test(testset)","57bf09fe":"accuracy.rmse(predictions)","89dd8737":"cross_validate(svd_model, data, measures=['RMSE', 'MAE'], cv=5, verbose=True)","204c5a4e":"user_movie_df.head()","de16c362":"# Guessing ID=541 movie rating for user1\nsvd_model.predict(uid=1.0, iid=541, verbose=True)","8c499b5e":"# Guessing ID=356 movie rating for user1\nsvd_model.predict(uid=1.0, iid=356, verbose=True)","05a7e8f9":"# GridSearchCV\nparam_grid = {'n_epochs': [5, 50], 'lr_all': [0.002, 0.004]}\n\n# number of epochs = number of iteration\n# lr_all = learning rate","32ccbc24":"gs = GridSearchCV(SVD, param_grid, measures=['rmse', 'mae'], cv=5, n_jobs=-1, joblib_verbose=True)","7d4b5f35":"gs.fit(data)","6a20c714":"gs.best_score['rmse']","cd0e5cba":"gs.best_params['rmse']","3bec0a5d":"svd_model = SVD(**gs.best_params['rmse'])\ndata = data.build_full_trainset()\nsvd_model.fit(data)","f7039ade":"svd_model.predict(uid=1.0, iid=541, verbose=True)","1b57747a":"svd_model.predict(uid=1.0, iid=356, verbose=True)","167690cf":"# Final model ve Prediction","2d0a2c90":"# MODEL TUNNING","30457e93":"# MODELLING","811f6d1b":"![image.png](attachment:931196e6-4be8-4870-8090-7d8dade8cf39.png)"}}