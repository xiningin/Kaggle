{"cell_type":{"3729c544":"code","3d060473":"code","3aeeb9c8":"code","eb3b3317":"code","1baabcf1":"code","076397af":"code","2ad1de5e":"code","34907530":"code","12de0bcf":"code","d6b35be9":"code","1319babb":"code","0b70f925":"code","a80143f1":"code","3baa0d2a":"code","7439238f":"code","cfe32ec0":"code","3f18c2e2":"code","58ccfeea":"code","1dc9b2af":"code","08df561d":"markdown","7e6e8823":"markdown","cf0eaa2e":"markdown","9fd25866":"markdown","0b632f41":"markdown","0322f46c":"markdown","866b09a3":"markdown","e94577b8":"markdown","d7eae6f4":"markdown","eefdb95b":"markdown","ebefbe33":"markdown","317d31c9":"markdown"},"source":{"3729c544":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\n\n\ntrain = pd.read_csv('\/kaggle\/input\/petfinder-pawpularity-score\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/petfinder-pawpularity-score\/test.csv')\nsubmission = pd.read_csv('\/kaggle\/input\/petfinder-pawpularity-score\/sample_submission.csv')","3d060473":"submission","3aeeb9c8":"import pandas_profiling\n# train.profile_report()\ntrain.iloc[0]","eb3b3317":"print(train.isnull().sum(),'\\n------------\\n',\n        test.isnull().sum())","1baabcf1":"train[train['Pawpularity']==1]","076397af":"train[train['Pawpularity']==100]","2ad1de5e":"import matplotlib.pyplot as plt\nimport cv2\n\ntrain_path = \"..\/input\/petfinder-pawpularity-score\/train\"\n# \u6700\u521d\u306eID\u306e\u5199\u771f\u3092\u78ba\u8a8d\npath = os.path.join(train_path,train[\"Id\"].iloc[0]+\".jpg\")","34907530":"img = cv2.imread(path)\nimg = cv2.cvtColor(img,cv2.COLOR_BGR2RGB)\nplt.imshow(img)","12de0bcf":"lists = ['Accessory', 'Human', 'Occlusion', 'Blur']\ntmp_train = train.copy()\n# \u9b45\u529b\u5ea650\u4ee5\u4e0b\u306e\u5199\u771f\u306e\u5e73\u5747\u5024\u3092\u6c42\u3081\u308b\nlow = tmp_train[tmp_train['Pawpularity']<=50]\n# \u9b45\u529b\u5ea650\u4ee5\u4e0a\u306e\u5199\u771f\u306e\u5e73\u5747\u5024\u3092\u6c42\u3081\u308b\nhigh = tmp_train[tmp_train['Pawpularity']>50]","d6b35be9":"for l in lists:\n    print('\u3010low\u3011 {} : {}'.format(l,low[l].mean()))\n    print('\u3010high\u3011 {} : {}'.format(l,high[l].mean()))\n    if low[l].mean() > high[l].mean():\n        print('low\u306e\u65b9\u304c\u9ad8\u3044')\n    else:\n        print('high\u306e\u65b9\u304c\u9ad8\u3044')\n    print('---------------------------')","1319babb":"tmp_train.drop(lists, axis=1, inplace=True)\n# Id, Pawpularity\u4ee5\u5916\u306e8\u30ab\u30e9\u30e0\nfor i in range(1, 9):\n    print('\u3010low\u3011 {} : {}'.format(low.columns[i],low.iloc[:, i].mean()))\n    print('\u3010high\u3011 {} : {}'.format(high.columns[i],high.iloc[:, i].mean()))\n    if low.iloc[:, i].mean() > high.iloc[:, i].mean():\n        print('low\u306e\u65b9\u304c\u9ad8\u3044')\n    else:\n        print('high\u306e\u65b9\u304c\u9ad8\u3044')\n    print('---------------------------')","0b70f925":"train_id = train['Id']\ntest_id = test['Id']\n\ny_train = train['Pawpularity']\nX_train = train.drop(['Id','Pawpularity'], axis=1)\nX_test = test.drop(['Id'], axis=1)","a80143f1":"from sklearn.model_selection import train_test_split\n\nX_train, X_valid, y_train, y_valid = \\\n    train_test_split(X_train, y_train, test_size=0.3, shuffle=True, random_state=0)","3baa0d2a":"X_test.dtypes","7439238f":"# \u30c7\u30fc\u30bf\u306f\u8a13\u7df4\u7528\u3068\u30c6\u30b9\u30c8\u7528\u306e2\u7a2e\u985e\u3092\u767b\u9332\u3059\u308b\nimport lightgbm as lgb\n\nlgb_train = lgb.Dataset(X_train, y_train)\nlgb_eval = lgb.Dataset(X_valid, y_valid, reference=lgb_train)","cfe32ec0":"params = {\n    'metric': 'rmse'\n}\n\nmodel = lgb.train(params, lgb_train,\n                 valid_sets=[lgb_train, lgb_eval],\n                 verbose_eval=10,\n                 num_boost_round=1000,\n                 early_stopping_rounds=10)\ny_pred = model.predict(X_test, num_iteration=model.best_iteration)","3f18c2e2":"y_pred[:10]","58ccfeea":"sub = pd.read_csv('\/kaggle\/input\/petfinder-pawpularity-score\/sample_submission.csv')\n\nsub['Pawpularity'] = y_pred\nsub.to_csv('submission.csv', index=False)","1dc9b2af":"sub","08df561d":"#### \u6b20\u640d\u5024\u306b\u95a2\u3057\u3066\ntrain\u3001test\u3068\u3082\u306b\u6b20\u640d\u5024\u306f\u5b58\u5728\u3057\u306a\u3044\u306e\u3067\u88dc\u5b8c\u4f5c\u696d\u306f\u4e0d\u8981","7e6e8823":"## \u4eee\u8aac\n#### Pawpularity(\u9b45\u529b\u5ea6)\u304c\u4f4e\u3044\u5199\u771f\u306e\u7279\u5fb4\n1. Accessory, Human, Occlusion, Blur\u306e\u30c7\u30fc\u30bf\u304c1\u306e\u6642\n    * \u3064\u307e\u308a\u3001\u4f59\u5206\u306a\u60c5\u5831\u3001\u30ce\u30a4\u30ba\u304c\u591a\u304f\u3042\u308b\u5834\u5408\n2. \u4e0a\u8a18\u30ab\u30e9\u30e0\u4ee5\u5916\u306e\u5024\u304c0\u306e\u65b9\u304c\u591a\u3044\u6642\n    * \u7279\u5fb4\u304c\u5c11\u306a\u3044\u306e\u3067\u9b45\u529b\u5ea6\u304c\u6e1b\u5c11\u3059\u308b\n\n#### Pawpularity(\u9b45\u529b\u5ea6)\u304c\u9ad8\u3044\u5199\u771f\u306e\u7279\u5fb4\n1. Accessory, Human, Occlusion, Blur\u306e\u30c7\u30fc\u30bf\u304c0\u306e\u6642\n    * \u4f59\u5206\u306a\u60c5\u5831\u3001\u30ce\u30a4\u30ba\u304c\u5c11\u306a\u3044\u5834\u5408\n2. \u4e0a\u8a18\u30ab\u30e9\u30e0\u4ee5\u5916\u306e\u5024\u304c\uff11\u306e\u65b9\u304c\u591a\u3044\u6642\n    * \u7279\u5fb4\u304c\u591a\u3044\u306e\u3067\u9b45\u529b\u5ea6\u304c\u5897\u52a0\u3059\u308b","cf0eaa2e":"#### \u30c7\u30fc\u30bf\u6982\u8981\u3092\u628a\u63e1\u3059\u308b","9fd25866":"#### \u5b66\u7fd2\u3001\u4e88\u6e2c","0b632f41":"#### \u9b45\u529b\u5ea61\u306e\u30c7\u30fc\u30bf\u3068100\u306e\u30c7\u30fc\u30bf\u3092\u78ba\u8a8d\u3057\u3066\u307f\u308b\n\u203b\u9b45\u529b\u5ea60\u306f\u5b58\u5728\u3057\u306a\u3044","0322f46c":"#### \u63d0\u51fa\u5f62\u5f0f\u3092\u78ba\u8a8d\u3059\u308b\nId(\u5199\u771f)\u306b\u7d10\u4ed8\u3044\u305fPawpularity(\u9b45\u529b\u5ea6)\u3092\u4e88\u6e2c\u3059\u308b\u3002","866b09a3":"* \u4eee\u8aac\u306e2\u756a\u76ee\u306b\u95a2\u3057\u3066\u3001\u3042\u307e\u308a\u6709\u610f\u5dee\u306f\u898b\u3089\u308c\u306a\u304b\u3063\u305f\n\n\u4ee5\u4e0a\u3088\u308a\u4eee\u8aac\u306f\u7279\u306b\u91cd\u8981\u8996\u3059\u308b\u70b9\u3067\u306f\u306a\u3044\u3002","e94577b8":"* \u4eee\u8aac\u306e1\u756a\u76ee\u306b\u95a2\u3057\u3066\u3001\u3042\u307e\u308a\u6709\u610f\u5dee\u306f\u898b\u3089\u308c\u306a\u304b\u3063\u305f\u3002","d7eae6f4":"## LGBM\u3067submit\u3057\u3066\u307f\u308b","eefdb95b":"#### 2\u306e\u4eee\u8aac","ebefbe33":"#### 1\u306e\u4eee\u8aac","317d31c9":"#### \u30ab\u30e9\u30e0\u3092\u7406\u89e3\u3059\u308b(DeepL\u7ffb\u8a33)\n\u5404\u30da\u30c3\u30c8\u306e\u5199\u771f\u306b\u306f\uff0c\u4ee5\u4e0b\u306e\u7279\u5fb4\u306e\u305d\u308c\u305e\u308c\u306b\u3064\u3044\u3066\uff0c1\uff08Yes\uff09\u307e\u305f\u306f0\uff08No\uff09\u306e\u5024\u304c\u4ed8\u3051\u3089\u308c\u3066\u3044\u6d41\u3002\n* Focus - \u30da\u30c3\u30c8\u306f\u3001\u6574\u7136\u3068\u3057\u305f\u80cc\u666f\u306e\u4e2d\u3067\u3001\u8fd1\u3059\u304e\u305a\u9060\u3059\u304e\u305a\u3001\u969b\u7acb\u3063\u3066\u3044\u308b\u3002\n* Eyes - \u4e21\u76ee\u304c\u6b63\u9762\u307e\u305f\u306f\u305d\u308c\u306b\u8fd1\u3044\u65b9\u5411\u3092\u5411\u3044\u3066\u304a\u308a\u3001\u5c11\u306a\u304f\u3068\u30821\u3064\u306e\u76ee\/\u77b3\u304c\u304d\u3061\u3093\u3068\u30af\u30ea\u30a2\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n* Face - \u6b63\u9762\u307e\u305f\u306f\u305d\u308c\u306b\u8fd1\u3044\u65b9\u5411\u3092\u5411\u3044\u3066\u3044\u308b\u3001\u306f\u3063\u304d\u308a\u3068\u3057\u305f\u9854\u3002\n* Bear - 1\u5339\u306e\u30da\u30c3\u30c8\u304c\u5199\u771f\u306e\u304b\u306a\u308a\u306e\u90e8\u5206\u3092\u5360\u3081\u3066\u3044\u308b\uff08\u304a\u304a\u3088\u305d\u5199\u771f\u306e\u5e45\u307e\u305f\u306f\u9ad8\u3055\u306e50\uff05\u4ee5\u4e0a\uff09\u3002\n* Action - \u30da\u30c3\u30c8\u304c\u4f55\u304b\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u8d77\u3053\u3057\u3066\u3044\u308b\u6700\u4e2d\uff08\u4f8b\uff1a\u30b8\u30e3\u30f3\u30d7\uff09\u3002\n* Accessory - \u9996\u8f2a\u3084\u30ea\u30fc\u30c9\u3092\u9664\u304f\u3001\u4ed8\u968f\u3059\u308b\u7269\u7406\u7684\u307e\u305f\u306f\u30c7\u30b8\u30bf\u30eb\u7684\u306a\u30a2\u30af\u30bb\u30b5\u30ea\u30fc\/\u5c0f\u9053\u5177\uff08\u4f8b\uff1a\u304a\u3082\u3061\u3083\u3001\u30c7\u30b8\u30bf\u30eb\u30b9\u30c6\u30c3\u30ab\u30fc\uff09\u3002\n* Group - 1\u5339\u4ee5\u4e0a\u306e\u30da\u30c3\u30c8\u304c\u5199\u3063\u3066\u3044\u308b\u3053\u3068\u3002\n* Collage - \u30c7\u30b8\u30bf\u30eb\u7684\u306b\u30ec\u30bf\u30c3\u30c1\u3055\u308c\u305f\u5199\u771f\uff08\u30c7\u30b8\u30bf\u30eb\u30d5\u30a9\u30c8\u30d5\u30ec\u30fc\u30e0\u3092\u4f7f\u7528\u3057\u305f\u3082\u306e\u3001\u8907\u6570\u306e\u5199\u771f\u3092\u7d44\u307f\u5408\u308f\u305b\u305f\u3082\u306e\u306a\u3069\uff09\u3002\n* Human - \u5199\u771f\u306b\u5199\u3063\u3066\u3044\u308b\u4eba\u9593\u3002\n* Occlusion - \u7279\u5b9a\u306e\u671b\u307e\u3057\u304f\u306a\u3044\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u30da\u30c3\u30c8\u306e\u4e00\u90e8\u3092\u906e\u3063\u3066\u3044\u308b\u72b6\u614b\uff08\u4f8b\uff1a\u4eba\u9593\u3001\u30b1\u30fc\u30b8\u3001\u30d5\u30a7\u30f3\u30b9\uff09\u3002\u3059\u3079\u3066\u306e\u906e\u853d\u7269\u304c\u30aa\u30af\u30eb\u30fc\u30b8\u30e7\u30f3\u3068\u306f\u9650\u3089\u306a\u3044\u3002\n* Info - \u30ab\u30b9\u30bf\u30e0\u3067\u8ffd\u52a0\u3055\u308c\u305f\u30c6\u30ad\u30b9\u30c8\u3084\u30e9\u30d9\u30eb\uff08\u4f8b\uff1a\u30da\u30c3\u30c8\u306e\u540d\u524d\u3001\u8aac\u660e\uff09\u3002\n* Blur - \u7279\u306b\u30da\u30c3\u30c8\u306e\u76ee\u3084\u9854\u306a\u3069\u3001\u76ee\u7acb\u3063\u305f\u30d4\u30f3\u30dc\u30b1\u3084\u30ce\u30a4\u30ba\u304c\u3042\u308b\u72b6\u614b\u3002\u30d6\u30e9\u30fc\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u306f\u3001\u300c\u76ee\u300d\u5217\u306f\u5e38\u306b0\u306b\u8a2d\u5b9a\u3055\u308c\u307e\u3059\u3002"}}