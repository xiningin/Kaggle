{"cell_type":{"7671dcae":"code","4df6e295":"code","181dc850":"code","954c50b7":"code","6013ce32":"code","0cd55740":"code","4b2779e6":"code","46925523":"code","08e1db86":"code","431e5aeb":"code","f4a82356":"code","01e06102":"code","bb047845":"code","55f02727":"code","1ecbc07c":"code","0470f817":"code","23d9ff83":"code","0528826e":"code","ce18395f":"code","e0e1f8a5":"markdown","60ac3b2b":"markdown","45a45493":"markdown","f3a4f4aa":"markdown","8e684cb1":"markdown"},"source":{"7671dcae":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.preprocessing import StandardScaler\n\nfrom sklearn.cluster import KMeans\nfrom sklearn.decomposition import PCA","4df6e295":"data = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","181dc850":"data","954c50b7":"data.drop('CustomerID', axis=1, inplace=True)","6013ce32":"encoder = LabelEncoder()\ndata['Gender'] = encoder.fit_transform(data['Gender'])\n\ngender_mappings = {index: label for index, label in enumerate(encoder.classes_)}\ngender_mappings","0cd55740":"scaler = StandardScaler()\nscaled_data = pd.DataFrame(scaler.fit_transform(data), columns=data.columns)","4b2779e6":"scaled_data","46925523":"max_clusters = 50","08e1db86":"kmeans_tests = [KMeans(n_clusters=i, n_init=10) for i in range(1, max_clusters)]\ninertias = [kmeans_tests[i].fit(scaled_data).inertia_ for i in range(len(kmeans_tests))]","431e5aeb":"plt.figure(figsize=(7, 5))\nplt.plot(range(1, max_clusters), inertias)\nplt.xlabel(\"Number of Clusters\")\nplt.ylabel(\"Inertia\")\nplt.title(\"Choosing the Number of Clusters\")\nplt.show()","f4a82356":"kmeans = KMeans(n_clusters=10, n_init=10)\nkmeans.fit(scaled_data)","01e06102":"clusters = kmeans.predict(scaled_data)\nclusters","bb047845":"pca = PCA(n_components=2)\n\nreduced_data = pd.DataFrame(pca.fit_transform(scaled_data), columns=['PC1', 'PC2'])","55f02727":"reduced_data","1ecbc07c":"kmeans.cluster_centers_","0470f817":"reduced_centers = pca.transform(kmeans.cluster_centers_)\nreduced_centers","23d9ff83":"reduced_data['cluster'] = clusters","0528826e":"reduced_data","ce18395f":"plt.figure(figsize=(14, 10))\n\nplt.scatter(reduced_data[reduced_data['cluster'] == 0].loc[:, 'PC1'], reduced_data[reduced_data['cluster'] == 0].loc[:, 'PC2'], color='red')\nplt.scatter(reduced_data[reduced_data['cluster'] == 1].loc[:, 'PC1'], reduced_data[reduced_data['cluster'] == 1].loc[:, 'PC2'], color='blue')\nplt.scatter(reduced_data[reduced_data['cluster'] == 2].loc[:, 'PC1'], reduced_data[reduced_data['cluster'] == 2].loc[:, 'PC2'], color='yellow')\nplt.scatter(reduced_data[reduced_data['cluster'] == 3].loc[:, 'PC1'], reduced_data[reduced_data['cluster'] == 3].loc[:, 'PC2'], color='orange')\nplt.scatter(reduced_data[reduced_data['cluster'] == 4].loc[:, 'PC1'], reduced_data[reduced_data['cluster'] == 4].loc[:, 'PC2'], color='cyan')\nplt.scatter(reduced_data[reduced_data['cluster'] == 5].loc[:, 'PC1'], reduced_data[reduced_data['cluster'] == 5].loc[:, 'PC2'], color='magenta')\nplt.scatter(reduced_data[reduced_data['cluster'] == 6].loc[:, 'PC1'], reduced_data[reduced_data['cluster'] == 6].loc[:, 'PC2'], color='brown')\nplt.scatter(reduced_data[reduced_data['cluster'] == 7].loc[:, 'PC1'], reduced_data[reduced_data['cluster'] == 7].loc[:, 'PC2'], color='pink')\nplt.scatter(reduced_data[reduced_data['cluster'] == 8].loc[:, 'PC1'], reduced_data[reduced_data['cluster'] == 8].loc[:, 'PC2'], color='green')\nplt.scatter(reduced_data[reduced_data['cluster'] == 9].loc[:, 'PC1'], reduced_data[reduced_data['cluster'] == 9].loc[:, 'PC2'], color='purple')\n\nplt.scatter(reduced_centers[:, 0], reduced_centers[:, 1], color='black', marker='x', s=300)\n\nplt.xlabel(\"PC1\")\nplt.ylabel(\"PC2\")\n\nplt.show()","e0e1f8a5":"# Preprocessing","60ac3b2b":"# Getting Started","45a45493":"# PCA","f3a4f4aa":"# Data Visualization","8e684cb1":"# Clustering"}}