{"cell_type":{"5a0a56b2":"code","0f720682":"code","5fe24b56":"code","285a85f2":"code","f265eec3":"code","9f993365":"code","11c18de2":"code","95adaf11":"code","ca41fbbe":"code","bd39964e":"code","3b80cd43":"code","8118eab0":"markdown","456df931":"markdown","81c31c62":"markdown","74294a21":"markdown","50ae9145":"markdown"},"source":{"5a0a56b2":"import numpy as np\nimport pandas as pd\n\nfrom sklearn.model_selection import train_test_split, GridSearchCV\n\nfrom sklearn.ensemble import RandomForestRegressor","0f720682":"data = pd.read_csv('..\/input\/wild-blueberry-yield-prediction\/Data in Brief\/Data in Brief\/WildBlueberryPollinationSimulationData.csv')","5fe24b56":"data","285a85f2":"data.info()","f265eec3":"def preprocess_inputs(df):\n    df = df.copy()\n    \n    # Drop Row# column\n    df = df.drop('Row#', axis=1)\n    \n    # Split df into X and y\n    y = df['yield']\n    X = df.drop('yield', axis=1)\n    \n    # Train-test split\n    X_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.7, shuffle=True, random_state=1)\n    \n    return X_train, X_test, y_train, y_test","9f993365":"X_train, X_test, y_train, y_test = preprocess_inputs(data)","11c18de2":"X_train","95adaf11":"y_train","ca41fbbe":"model = RandomForestRegressor(random_state=1)\nmodel.fit(X_train, y_train)\n\ny_pred = model.predict(X_test)\n\nrmse = np.sqrt(np.mean((y_test - y_pred)**2))\nr2 = 1 - (np.sum((y_test - y_pred)**2) \/ np.sum((y_test - y_test.mean())**2))\n\nprint(\"     RMSE: {:.2f}\".format(rmse))\nprint(\"R^2 Score: {:5f}\".format(r2))","bd39964e":"params = {\n    'n_estimators': [50, 100, 150, 200],\n    'max_depth': [2, 4, 6, 8, 10]\n}\n\nmodel = GridSearchCV(RandomForestRegressor(random_state=1), params)\nmodel.fit(X_train, y_train)\n\ny_pred = model.predict(X_test)\n\nrmse = np.sqrt(np.mean((y_test - y_pred)**2))\nr2 = 1 - (np.sum((y_test - y_pred)**2) \/ np.sum((y_test - y_test.mean())**2))\n\nprint(\"     RMSE: {:.2f}\".format(rmse))\nprint(\"R^2 Score: {:5f}\".format(r2))","3b80cd43":"model.best_params_","8118eab0":"# Preprocessing","456df931":"# Task for Today  \n\n***\n\n## Blueberry Yield Prediction  \n  \nGiven *data about wild blueberries*, let's try to predict the **yield** for a given record.  \n  \nWe will use a random forest regression model to make our predictions.","81c31c62":"# Data Every Day  \n\nThis notebook is featured on Data Every Day, a YouTube series where I train models on a new dataset each day.  \n\n***\n\nCheck it out!  \nhttps:\/\/youtu.be\/AHF7mbBOUgM","74294a21":"# Training","50ae9145":"# Getting Started"}}