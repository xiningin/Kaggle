{"cell_type":{"68246156":"code","830177db":"code","d95ccdb9":"code","6d0165d5":"code","628f4ab4":"code","73056343":"code","2d9843d9":"code","434fe6d8":"code","d290688d":"code","9016d90f":"code","2ee3491b":"code","b775d93c":"code","b479472a":"code","bbde7211":"code","84e789bd":"code","1c19ad83":"code","56a906fb":"code","9511cba6":"code","f36f7229":"code","86be8922":"code","c2c9bdb0":"code","ba9aae29":"code","9f06ce7a":"code","48ae2a8e":"code","8824ee73":"code","c84b295c":"code","bfcdf47d":"code","6b6ca83a":"code","e2070cc1":"code","f660cebd":"code","80f7770e":"code","cae36f1f":"code","8b8b5103":"code","19f392df":"code","b023b2da":"code","4a5bfded":"code","40ae46c9":"code","a73f27a7":"code","4a941a72":"code","c6776511":"code","83720286":"code","78f61517":"code","c2226973":"code","2d091a2a":"code","0b9db554":"code","9c0c5eba":"code","617bcfde":"code","8ac4cc40":"code","d5a0a145":"code","dff5073a":"code","33b56cd6":"code","1edde490":"code","91c7b246":"code","2928d491":"code","0a6ae70b":"code","bef41661":"code","782620d3":"code","9e49b06c":"markdown","26a64d3c":"markdown","5ff90aa0":"markdown","071f5224":"markdown","42446a0b":"markdown","a11c8662":"markdown","fc23238c":"markdown","0d787587":"markdown","371bd321":"markdown","c35ceda0":"markdown","ef97c054":"markdown","30843925":"markdown","44c628d8":"markdown","c9e44986":"markdown"},"source":{"68246156":"import pandas as pd\ncolumns = ['surgery','Age','Hospital ID','rectal temperature','pulse','respiratory rate','temperature of extremities','peripheral pulse',\"mucous membranes\",'capillary refill time','pain','peristalsis','abdominal distension','nasogastric tube','nasogastric reflux','nasogastric reflux PH','rectal examination - feces','abdomen',' packed cell volume','total protein','abdominocentesis appearance','abdomcentesis total protein','outcome','surgical lesion?','1','2','3','path']\ndf = pd.read_csv('https:\/\/archive.ics.uci.edu\/ml\/machine-learning-databases\/horse-colic\/horse-colic.data', sep = ' ', header = None, na_values='?', names = columns)","830177db":"df.head()","d95ccdb9":"len(df.columns)","6d0165d5":"df.info()","628f4ab4":"#Dropping columns having significant number of NaN values\ndf.drop('nasogastric reflux PH', axis=1, inplace = True)\ndf.drop('abdomcentesis total protein', axis=1, inplace = True)\ndf.drop('abdominocentesis appearance', axis=1, inplace = True)\ndf.drop('nasogastric tube', axis=1, inplace = True)\ndf.drop('abdomen', axis=1, inplace = True)\ndf.drop('rectal examination - feces', axis=1, inplace = True)","73056343":"df['Age'].replace({9:2}, inplace = True)\ndf['outcome'].replace({1:'lived', 2:'died', 3:'euthenized'}, inplace = True)\ndf['Age'].replace({1:'Adult', 2:'Young'}, inplace = True)\ndf['pain'].replace({1:'No Pain', 2:'Depressed', 3:'Mild pain', 4:'Severe Pain', 5:'Greaterthansevere'}, inplace = True)","2d9843d9":"#Heatmap for missing values\nimport seaborn as sns\nsns.heatmap(df.isnull(), cbar=False)","434fe6d8":"#BarGraph of missing values for clearer visualisation\nnull = df.isnull().sum()\n\nfrom matplotlib import pyplot as plt\n\nplt.figure(figsize=(20,10))\nplt.bar(range(len(null)),null)\nplt.xlabel('Features')\nplt.ylabel('missing')\nplt.xticks(list(range(len(df.columns))), list(df.columns.values), rotation='vertical')\nplt.show\n\nprint(null)","d290688d":"#Columns containing NaN values\nnull = pd.concat([df.isnull().sum()], axis = 1, keys = ['NA'] )\nnull.loc[(null.NA>0)]","9016d90f":"#Filtering columns having continous variables \nfor col in df.columns.values:\n    if (len(df[col].value_counts())> 5) and (df[col].isnull().sum() > 0):\n        print(col)","2ee3491b":"#Filling columns containing continous variables with MEAN\ndf['surgery'].fillna(df['surgery'].mode()[0], inplace = True)\ndf['rectal temperature'].fillna(df['rectal temperature'].mean(), inplace = True)\ndf['pulse'].fillna(df['pulse'].mean(), inplace = True)\ndf['respiratory rate'].fillna(df['pulse'].mean(), inplace = True)\ndf['mucous membranes'].fillna(df['pulse'].mean(), inplace = True)\ndf[' packed cell volume'].fillna(df['pulse'].mean(), inplace = True)\ndf['total protein'].fillna(df['total protein'].mean(), inplace = True)\n\n##Filling columns containing categorical variables with MODE\nfor col in df.columns.values:\n    if (df[col].isnull().sum()>0):  \n        if (df[col].dtype == 'float64'):\n            df[col].fillna(df[col].mode()[0], inplace = True)","b775d93c":"null = pd.concat([df.isnull().sum()], axis = 1, keys = ['NA'])\nnull.loc[(null['NA']>0)]               ","b479472a":"\nimport seaborn as sns\nsns.countplot(data=df, x=\"outcome\");\nprint(df.outcome.value_counts())","bbde7211":"#Finding relations between features and taget variable(outcome) by visualising data\n#Relation between outcome and degree of pain experienced by the horse\nsns.countplot(data=df, x='outcome', hue = 'pain')\n","84e789bd":"#Relation between outcome and degree of age of the horse\n\nsns.countplot(data=df, x='outcome', hue = 'Age')","1c19ad83":"#Converting variables to categorical datatype for better analysis\ndf['outcome'] = df['outcome'].astype('category').cat.codes\ndf['Age'] = df['Age'].astype('category').cat.codes\ndf['pain'] = df['pain'].astype('category').cat.codes","56a906fb":"#Finding correlation between features and target variables\ncorr= df.corr()","9511cba6":"core = abs(corr.outcome.sort_values(ascending = False))\ncore.sort_values(ascending = False)","f36f7229":"#Heatmap of correlations\nsns.heatmap(corr, vmax=0.85)","86be8922":"#Removing columns which have insignificant impact on our target variable \"outcome\" (corr<0.1)\ndf.drop('path',axis = 1 , inplace = True)\ndf.drop('3',axis = 1 , inplace = True)\ndf.drop('rectal temperature',axis = 1 , inplace = True)\ndf.drop('pain',axis = 1 , inplace = True)\ndf.drop('mucous membranes',axis = 1 , inplace = True)","c2c9bdb0":"#Cleaned and processed train dataset\ndisplay(df.head())\ndisplay(df.shape)","ba9aae29":"columns = ['surgery','Age','Hospital ID','rectal temperature','pulse','respiratory rate','temperature of extremities','peripheral pulse',\"mucous membranes\",'capillary refill time','pain','peristalsis','abdominal distension','nasogastric tube','nasogastric reflux','nasogastric reflux PH','rectal examination - feces','abdomen',' packed cell volume','total protein','abdominocentesis appearance','abdomcentesis total protein','outcome','surgical lesion?','1','2','3','path']\ndfs = pd.read_csv('https:\/\/archive.ics.uci.edu\/ml\/machine-learning-databases\/horse-colic\/horse-colic.test', sep = ' ', header = None, na_values='?', names = columns)","9f06ce7a":"display(dfs.head())\ndisplay(len(dfs.columns))\ndisplay(dfs.info())\ndisplay(dfs.shape)","48ae2a8e":"#Visualising missing data\nsns.heatmap(dfs.isnull(),cbar=False, cmap='Pastel1')","8824ee73":"null = dfs.isnull().sum()\n\nfrom matplotlib import pyplot as plt\n\nplt.figure(figsize=(20,10))\nplt.bar(range(len(null)),null)\nplt.xlabel('Features')\nplt.ylabel('missing')\nplt.xticks(list(range(len(dfs.columns))), list(dfs.columns.values), rotation='vertical')\nplt.show\n\nprint(null)","c84b295c":"#Dropping columns with significant number of missing values\ndfs.drop('nasogastric reflux PH', axis=1, inplace = True)\ndfs.drop('abdomcentesis total protein', axis=1, inplace = True)\ndfs.drop('abdominocentesis appearance', axis=1, inplace = True)\ndfs.drop('nasogastric tube', axis=1, inplace = True)\ndfs.drop('abdomen', axis=1, inplace = True)\ndfs.drop('rectal examination - feces', axis=1, inplace = True)","bfcdf47d":"dfs.drop('path',axis = 1 , inplace = True)\ndfs.drop('3',axis = 1 , inplace = True)\ndfs.drop('rectal temperature',axis = 1 , inplace = True)\ndfs.drop('pain',axis = 1 , inplace = True)\ndfs.drop('mucous membranes',axis = 1 , inplace = True)","6b6ca83a":"dfs['Age'].replace({9:2}, inplace = True)\ndfs['outcome'].replace({1:'lived', 2:'died', 3:'euthenized'}, inplace = True)\ndfs['Age'].replace({1:'Adult', 2:'Young'}, inplace = True)\n","e2070cc1":"null = pd.concat([dfs.isnull().sum()], axis = 1, keys = ['NA'] )\nnull.loc[(null.NA>0)]","f660cebd":"for col in dfs.columns.values:\n    if (len(dfs[col].value_counts())> 5) and (dfs[col].isnull().sum() > 0):\n        print(col)","80f7770e":"dfs['surgery'].fillna(dfs['surgery'].mode()[0], inplace = True)\ndfs['pulse'].fillna(dfs['pulse'].mean(), inplace = True)\ndfs['respiratory rate'].fillna(dfs['pulse'].mean(), inplace = True)\ndfs[' packed cell volume'].fillna(dfs['pulse'].mean(), inplace = True)\ndfs['total protein'].fillna(dfs['total protein'].mean(), inplace = True)\n\nfor col in dfs.columns.values:\n    if (dfs[col].isnull().sum()>0):  \n        if (dfs[col].dtype == 'float64'):\n            dfs[col].fillna(df[col].mode()[0], inplace = True)","cae36f1f":"null = pd.concat([dfs.isnull().sum()], axis = 1, keys = ['NA'])\n(null.loc[(null['NA']>0)])","8b8b5103":"dfs.dropna(axis=0, inplace =True)","19f392df":"dfs['outcome'] = dfs['outcome'].astype('category').cat.codes\ndfs['Age'] = dfs['Age'].astype('category').cat.codes","b023b2da":"#Separating features and target variable from both test and train dataset\nxtrain = df.drop(\"outcome\", axis=1)\nytrain = df[\"outcome\"]\nxtest  = dfs.drop(\"outcome\", axis=1)\nytest  = dfs[\"outcome\"]","4a5bfded":"xtrain.head()","40ae46c9":"#RandomForestClassifier Model\nfrom sklearn.ensemble import RandomForestClassifier\nrf = RandomForestClassifier(random_state=14 , n_jobs= -1)\nfrom pprint import pprint\npprint(rf.get_params())","a73f27a7":"#RandomizedSearchCV for best hyperparameter range\nfrom sklearn.model_selection import RandomizedSearchCV\nn_est=[100,140,180,220]\nbootstrap = [True,False]\nmsl = [2,3,4]\nmss=[1,2,3]\nmf=[.5,1,'auto']\ncriterion = ['gini', 'entropy']\nmaxd=[10,15,20,30,40,None]\n","4a941a72":"random_grid = {'n_estimators': n_est,\n               'max_features': mf,\n               'max_depth': maxd,\n               'min_samples_split': mss,\n               'min_samples_leaf': msl,\n               'bootstrap': bootstrap,\n               'criterion' : criterion}","c6776511":"pprint(random_grid)","83720286":"rf_random = RandomizedSearchCV(estimator = rf, param_distributions = random_grid, n_iter = 100, cv = 5, verbose=2, random_state=14, n_jobs = -1)","78f61517":"rf_random.fit(xtrain, ytrain)","c2226973":"rf_random.best_params_","2d091a2a":"#GridSearchCV for finding better hyperparameters \nfrom sklearn.model_selection import GridSearchCV\ngrid_param= {'n_estimators':[150, 180, 200,300,500],\n             'min_samples_split':[2,4,6],\n             'min_samples_leaf': [1,2,3,4],\n             'max_features': [0.5, 'auto'],\n             'max_depth': [10,15,20],\n             'criterion': ['entropy'],\n             'bootstrap': [True]}","0b9db554":"rf = RandomForestClassifier()","9c0c5eba":"grid_search =  GridSearchCV(estimator = rf, param_grid = grid_param, \n                          cv = 3, n_jobs = -1, verbose = 2)","617bcfde":"grid_search.fit(xtrain, ytrain)","8ac4cc40":"grid_search.best_params_","d5a0a145":"#Importing Confusion Matrix to describe the performance of a classification model \nfrom sklearn.metrics import confusion_matrix \nfrom sklearn.metrics import accuracy_score \nfrom sklearn.metrics import classification_report \n#To calculate F-Measure\nfrom sklearn.metrics import f1_score","dff5073a":"#Random Forest Classifier Model\nrf = RandomForestClassifier(n_estimators=300, criterion='entropy', min_samples_leaf=2,\n                            min_samples_split=4,\n                            max_depth=10)","33b56cd6":"rf.fit(xtrain, ytrain)\nrf.score(xtrain, ytrain)","1edde490":"pred = rf.predict(xtest)\n#Confusion Matrix for Random Forest\nactual = ytest\npredicted = pred\nresult = confusion_matrix(actual,predicted)","91c7b246":"print ('Confusion Matrix :')\nprint(result) \nprint('Accuracy Score :',accuracy_score(actual, predicted)) \nprint ('Report : ')\nprint (classification_report(actual, predicted))","2928d491":"#Decision tree Classifier Model\nfrom sklearn.tree import DecisionTreeClassifier\n\ndt = DecisionTreeClassifier(max_depth = 3)\ndt.fit(xtrain, ytrain)","0a6ae70b":"prediction = dt.predict(xtest)\n#Confusion Matrix for Decision Tree\nactual = ytest\npredicted = prediction\nresult = confusion_matrix(actual,predicted)","bef41661":"print ('Confusion Matrix :')\nprint(result) \nprint('Accuracy Score :',accuracy_score(actual, predicted)) \nprint ('Report : ')\nprint (classification_report(actual, predicted) )","782620d3":"accuracy_dt= round(dt.score(xtrain, ytrain) * 100, 2)\naccuracy_rf= round(rf.score(xtrain, ytrain) * 100, 2)\nprint(\"Train accuracy of Random Forest Classifier is \",accuracy_rf,\"%\")\nprint(\"Train accuracy of Decision Tree Classifier is \",accuracy_dt,\"%\")","9e49b06c":"### The dataset has 23 features and has a good mix of categorical and continuous features. It has a large number of features and instances with missing values, therefore understanding methods to replace these missing values and using it in modeling is made more practical in this treatment. Huge fraction of missing data (30%) is in fact a notable feature of this dataset.\n### The data consists of attributes that are continuous, as well as categorical in type. \n### Also, the presence of self-predictors makes working with this dataset instructive from a practical standpoint.","26a64d3c":"## Importing Test Dataset","5ff90aa0":"# Processing Test dataset before analysis","071f5224":"## White blank spaces account for the missing data in the entire dataframe represented by Pink","42446a0b":"# Horse-Colic Dataset from UCI Machine Learning Repository","a11c8662":"# For a better insight and efficiency let's find correlation between features and \"outcome\" which is our target variable","fc23238c":"# Data Analysis","0d787587":"## Data Processing for analysis","371bd321":"## Cleaning Train dataset","c35ceda0":"## This shows that features like pulse, surgical lesion,packed cell volume are having strong relations with our target variable which implies that these features play the most crucial role in classifying the target variable compared to other features. ","ef97c054":"## Importing Train data ","30843925":"## Cleaning Test dataset","44c628d8":"Removing columns which have insignificant impact on our target variable \"outcome\" (corr<.9) as seen from Train dataset\n","c9e44986":"#### If this notebook helped you in learning, please drop an upvote! :)"}}