{"cell_type":{"9e007710":"code","0e974019":"code","c095ce02":"code","7d0238ab":"code","93478fd2":"code","339dac3d":"markdown","dbe83c7b":"markdown","3ee48b7c":"markdown"},"source":{"9e007710":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nX_train = pd.read_csv('\/kaggle\/input\/manomanocentralesupelec\/X_train.csv')\ny_train = pd.read_csv('\/kaggle\/input\/manomanocentralesupelec\/y_train.csv')\nX_test = pd.read_csv('\/kaggle\/input\/manomanocentralesupelec\/X_test.csv')\nX_train.shape, y_train.shape, X_test.shape","0e974019":"print('Features: ', X_train.columns)\nprint('Target: ', y_train.columns)","c095ce02":"from sklearn.metrics import mean_squared_error\nX_train['conversion_rate'] = y_train['conversion_rate']\nX_train['m_total_vu'] = y_train['m_total_vu']\n\naverage_conversion_rate = X_train[X_train.s_date <= '2020-01-15']['conversion_rate'].mean()\nprint('Average conversion rate', average_conversion_rate)\nprint('Estimated WRMSE:', mean_squared_error(\n    y_true=X_train[X_train.s_date > '2020-01-15']['conversion_rate'],\n    y_pred=[average_conversion_rate] * (X_train.s_date > '2020-01-15').sum(),\n    sample_weight=X_train[X_train.s_date > '2020-01-15']['m_total_vu']\n))","7d0238ab":"y_sub = pd.DataFrame({'id': X_test['id'], 'conversion_rate': average_conversion_rate})\ny_sub.head()","93478fd2":"y_sub.to_csv('\/kaggle\/working\/sample_submission.csv', index=False)","339dac3d":"## Dummy algorithm : Average Conversion Rate","dbe83c7b":"## Generate submission","3ee48b7c":"### Estimate WRMSE"}}