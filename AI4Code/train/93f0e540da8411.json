{"cell_type":{"5c9df3cb":"code","60e0e355":"code","c96d8281":"code","1e4bc1fd":"code","1137ee2d":"code","734ac6b0":"code","89a458fc":"code","d1d081a0":"code","eee5342e":"code","16c6e2ec":"code","8031c52f":"code","02efa047":"code","c1694301":"code","9392b27d":"code","2a789cf4":"code","b5f04520":"code","55f639a9":"code","1f34b922":"code","8f98bb2c":"code","c092180f":"markdown","91acc76e":"markdown","a5a2dcf1":"markdown","bac2a4a4":"markdown","5f8244f1":"markdown","da7f943e":"markdown","6a90660a":"markdown","92aecddd":"markdown","1f671edf":"markdown","18beb6cc":"markdown","3432f862":"markdown","98c75a96":"markdown","903274a7":"markdown","2f66098c":"markdown","5dea3bd0":"markdown","ea335128":"markdown","e9181db6":"markdown","ee62c699":"markdown","98ce4496":"markdown","3779b45e":"markdown","4916e00e":"markdown","c211c745":"markdown","db3f0cae":"markdown","db73c4e3":"markdown","d1f2e1ee":"markdown","a854907a":"markdown","9bd3c7ab":"markdown","f1837527":"markdown","58bf6f93":"markdown","76d8cbea":"markdown","baf87c93":"markdown","2d4f2cc5":"markdown","2e60ba2e":"markdown","0bce2280":"markdown"},"source":{"5c9df3cb":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\ndf = pd.read_csv('\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","60e0e355":"df.head()","c96d8281":"df.describe()","1e4bc1fd":"df.isnull().sum()","1137ee2d":"df.shape #To check the number of rows and columns in the dataset.","734ac6b0":"df.info() # To check for the data types in the dataset.","89a458fc":"sns.countplot(df['Gender'])","d1d081a0":"sns.distplot(df['Age'])","eee5342e":"sns.distplot(df['Annual Income (k$)'])","16c6e2ec":"sns.distplot(df['Spending Score (1-100)'])","8031c52f":"sns.pairplot(df[[ 'Gender', 'Age', 'Annual Income (k$)','Spending Score (1-100)']])","02efa047":"plt.rcParams['figure.figsize'] = (14, 8)\nsns.heatmap(df[[ 'Gender', 'Age', 'Annual Income (k$)','Spending Score (1-100)']].corr(), cmap = 'magma_r', annot = True, linewidths=.5)\nplt.title('Heatmap', fontsize = 20)\nplt.show()","c1694301":"plt.rcParams['figure.figsize'] = (16, 7)\ng = sns.catplot(x=\"Gender\", y=\"Spending Score (1-100)\", kind=\"violin\", inner=None, data=df)\nsns.swarmplot(x=\"Gender\", y=\"Spending Score (1-100)\", color=\"k\", size=3, data=df, ax=g.ax);\nplt.title('Gender vs Spending Score', fontsize = 16)\nplt.xlabel('Gender')\nplt.ylabel('Spending Score (1-100)')\n","9392b27d":"plt.rcParams['figure.figsize'] = (16, 7)\ng = sns.catplot(x=\"Gender\", y=\"Annual Income (k$)\", kind=\"violin\", inner=None, data=df)\nsns.swarmplot(x=\"Gender\", y=\"Annual Income (k$)\", color=\"k\", size=3, data=df, ax=g.ax);\nplt.title('Gender vs Annual Income', fontsize = 16)\nplt.xlabel('Gender')\nplt.ylabel('Annual Income (k$)')","2a789cf4":"sns.catplot(x=\"Gender\", y=\"Age\", kind=\"box\", data=df);","b5f04520":"data=df.iloc[:,[3,4]].values\nfrom sklearn.cluster import KMeans\nwcss=[] # within cluster sum of square\nfor i in range(1,11):\n    kmeans=KMeans(n_clusters=i, init='k-means++',random_state=0)\n    kmeans.fit(data)\n    wcss.append(kmeans.inertia_) #inertia_ = to find the wcss value\n\nplt.plot(range(1,11),wcss)\nplt.title('The Elbow Method')\nplt.xlabel('Number of Clusters')\nplt.ylabel('WCSS')\nplt.show()","55f639a9":"\nkmeans=KMeans(n_clusters=5,init='k-means++',random_state=0)\ny_kmeans=kmeans.fit_predict(data)\n\n#plotting the the clusters\nfig,ax = plt.subplots(figsize=(14,6))\nax.scatter(data[y_kmeans==0,0],data[y_kmeans==0,1],s=100,c='red',label='Cluster 1')\nax.scatter(data[y_kmeans==1,0],data[y_kmeans==1,1],s=100,c='blue',label='Cluster 2')\nax.scatter(data[y_kmeans==2,0],data[y_kmeans==2,1],s=100,c='green',label='Cluster 3')\nax.scatter(data[y_kmeans==3,0],data[y_kmeans==3,1],s=100,c='cyan',label='Cluster 4')\nax.scatter(data[y_kmeans==4,0],data[y_kmeans==4,1],s=100,c='magenta',label='Cluster 5')\n\nax.scatter(kmeans.cluster_centers_[:,0],kmeans.cluster_centers_[:,1],s=400,c='yellow',label='Centroid')\nplt.title('Cluster Segmentation of Customers')\nplt.xlabel('Annual Income(K$)')\nplt.ylabel('Spending Score(1-100)')\nplt.legend()\nplt.show()","1f34b922":"data = df.iloc[:,[2,4]].values\nfrom sklearn.cluster import KMeans\nwcss=[]  # within cluster sum of square\nfor i in range(1,11):\n    kmeans=KMeans(n_clusters=i, init='k-means++',random_state=0)\n    kmeans.fit(data)\n    wcss.append(kmeans.inertia_)  # inertia_ = to find the wcss value\n\nplt.plot(range(1,11),wcss)\nplt.title('The Elbow Method')\nplt.xlabel('Number of Clusters')\nplt.ylabel('WCSS')\nplt.show()","8f98bb2c":"kmeans=KMeans(n_clusters=4,init='k-means++',random_state=0)\ny_kmeans=kmeans.fit_predict(data)\n\n#Plotting the clusters\nfig,ax = plt.subplots(figsize=(14,6))\nax.scatter(data[y_kmeans==0,0],data[y_kmeans==0,1],s=100,c='red',label='Cluster 1')\nax.scatter(data[y_kmeans==1,0],data[y_kmeans==1,1],s=100,c='blue',label='Cluster 2')\nax.scatter(data[y_kmeans==2,0],data[y_kmeans==2,1],s=100,c='green',label='Cluster 3')\nax.scatter(data[y_kmeans==3,0],data[y_kmeans==3,1],s=100,c='cyan',label='Cluster 4')\n\nax.scatter(kmeans.cluster_centers_[:,0],kmeans.cluster_centers_[:,1],s=400,c='yellow',label='Centroid')\nplt.title('Cluster Segmentation of Customers')\nplt.xlabel('Age')\nplt.ylabel('Spending Score(1-100)')\nplt.legend()\nplt.show()","c092180f":"# Data Visualisation","91acc76e":"# Mall Customers Segmentation using K-Means Clustering \n","a5a2dcf1":"let's now check for the relationship between different features by using a pairplot.","bac2a4a4":"## Bivariate Analysis","5f8244f1":"**Observations:**\n* Age of the customers ranges from 18-70. This shows that the mall attracts has shops and things which suite all age group people.\n* Average age of customers is 39.\n* Average income of customers is 60 K$.\n* Average spending score of customers is 50.\n","da7f943e":"### Conclusion:","6a90660a":"![](http:\/\/)![](http:\/\/)","92aecddd":"Using on the k-means clustering we have managed to form different clusters based on different features. Mall management can target the clusters with average spending score to increase their profit and should also maintain good relationship with premium customers with high spending score.They should also work on coming up with new innovative ideas to upgrade the customers with low spending score.","1f671edf":"**Observations:**\n* Most of the customers are in the 20-40 age group.\n* Spending score is high for the customers in the age group of 20-40.\n* Spending score is high for customers with very low and very high income.\n","18beb6cc":"# K-Means Clustering","3432f862":"### Gender vs Age","98c75a96":"### Annual Income","903274a7":"![](https:\/\/zonretail.com\/wp-content\/uploads\/2018\/04\/shopping-malls.jpg)","2f66098c":"### Age","5dea3bd0":"## k-means clustering based on Age","ea335128":"### Gender","e9181db6":"Malls and shopping complexes often compete with each other to increase their customer base and hence make huge profits. To achieve this task machine learning is being applied in many stores already.It is amazing to realize the fact that how machine learning can aid in such ambitions. AI and ML already have been intimately involved in online shopping since, well, the beginning of online shopping. You can\u2019t use Amazon or any other shopping service without getting recommendations, which are often personalized based on the vendor\u2019s understanding of your traits: your purchase history, your browsing history, and possibly much more. The shopping complexes make use of their customer's data and develop ML models to target the right customers.This not only increases sales but also makes their business efficient.","ee62c699":"Female customers are more compared to male customers.","98ce4496":"## Univariate Analysis","3779b45e":"### Spending score","4916e00e":"#### Elbow method to find the optimal number of Clusters","c211c745":"Annual income of the customers also follows right skewed normal distrbution.","db3f0cae":"### Gender vs Spending Score","db73c4e3":"![](http:\/\/)Age of the customers follows right skewed normal distrbution.","d1f2e1ee":"### Please do upvote if you like this Notebook!","a854907a":"From the above figure, we can see that last most significant slope occurs at k = 4 , hence we will have 4 clusters in this case.","9bd3c7ab":"### Heatmap","f1837527":"* From the above figure, we can see that last most significant slope occurs at k = 5 , hence we will have 5 clusters in this case.","58bf6f93":"Spending score of the customers roughly follws normal distribution.","76d8cbea":"### Gender vs Annual Income","baf87c93":"First step in any data science problem is to check for missing\/null values. Let's just check that first.","2d4f2cc5":"As we can see thankfully there are no missing values in this particular dataset. ","2e60ba2e":"As we can see there is not much correlation between the features.","0bce2280":"## k-means clustering based on annual income"}}