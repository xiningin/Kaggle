{"cell_type":{"8f486992":"code","7ec72d94":"code","79fc63f4":"code","7e52df97":"code","6fa9efec":"code","e11d1256":"code","a362fd23":"code","e5c60953":"code","4014beaf":"code","d75b8c97":"markdown","f2bd5a3c":"markdown","ee783d02":"markdown","dfb33782":"markdown","bdbe185c":"markdown","62fc5a49":"markdown"},"source":{"8f486992":"import numpy as np","7ec72d94":"eps = 1.0e-6\n# cosine similarity\n# eps: avoid dividing by 0\ndef cosSim(inA, inB):\n    denom = np.linalg.norm(inA) * np.linalg.norm(inB)\n    return float(inA * inB.T) \/ (denom + eps)","79fc63f4":"# Matrix of user to item\n# row: user, column: item\nA = np.mat([[5, 5, 3, 0, 5, 5], [5, 0, 4, 0, 4, 4], [0, 3, 0, 5, 4, 5], [5, 4, 3, 3, 5, 5]])","7e52df97":"print('A is {} by {} matrix: '.format(A.shape[0], A.shape[1]))\nprint(A)","6fa9efec":"U, S, VT = np.linalg.svd(A.T)\nV = VT.T\nSigma = np.diag(S)\nprint('AT shape = ', A.T.shape)\nprint('U shape = ', U.shape)\nprint('VT shape = ', VT.shape)\nprint('S = ', S)\nprint('Sigma = \\n', Sigma)","e11d1256":"# Use first 2 singular values\nr = 2\n# Get approximate U, Sigma, VT\nUr = U[:, :r]\nSr = Sigma[:r, :r]\nVr = V[:, :r]\nprint('Ur(matrix of item to latent factor), shape = ', Ur.shape)\nprint('Sr(matrix of singular values), shape = ', Sr.shape)\nprint('Vr(matrix of user to latent factor), shape = ', Vr.shape)","a362fd23":"# Vector of new user to item\nnew = np.mat([[5, 5, 0, 0, 0, 5]])\nnewresult = new * Ur * np.linalg.inv(Sr)\nprint('Vector of new user to latent factor = ', newresult)","e5c60953":"cos_sim = np.array([cosSim(newresult, vi) for vi in Vr])\nrecommended_user_id = np.argsort(-cos_sim)[0]\nprint('Most similar user id = ', recommended_user_id)\nprint('Cosine similarity = ', cos_sim[0])","4014beaf":"recommended_item_id = []\nfor idx, item in enumerate(np.ndarray.flatten(np.array(new))):\n    if item == 0 and A[recommended_user_id, idx] != 0:\n        recommended_item_id.append(idx)\nprint('Recommended item id = ', recommended_item_id)","d75b8c97":"## Compute vector of new user to latent factor","f2bd5a3c":"## SVD:  get matrix of user and item to latent factor\nUr: matrix of item to latent factor<br\/>\nVr: matrix of user to latent factor<br\/>\n> Sr: matrix of singular values","ee783d02":"## Recommend items by most similar user","dfb33782":"## Define a function for cosine similarity","bdbe185c":"## Compare vector's similarity of new user and original users to latent factors:  find most similar user","62fc5a49":"## Create user-item matrix: 4 users, 6 items"}}