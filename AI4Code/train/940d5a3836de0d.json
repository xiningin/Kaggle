{"cell_type":{"c25df16a":"code","28b41c49":"code","1fc1bd9d":"code","35cf744e":"code","ef5438e8":"code","cb5460e2":"code","bf28a605":"code","f72ae9ed":"code","6a32b05d":"code","35246ccf":"code","33e2b384":"code","4720ba70":"code","9a237364":"code","046294d6":"code","f743f13a":"code","044cf32e":"code","4ab76d0d":"code","4cdc6408":"code","cf48fa5f":"code","95594da4":"code","70fa5434":"code","c0e38dbc":"code","554be2bf":"code","b0a38317":"markdown","33974ba4":"markdown","466dd7a7":"markdown"},"source":{"c25df16a":"!pip install pycaret","28b41c49":"!pip install seaborn==0.11.0","1fc1bd9d":"from pycaret.utils import enable_colab \nenable_colab()","35cf744e":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom pycaret.classification import *","ef5438e8":"df = pd.read_csv('\/kaggle\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')","cb5460e2":"df.head()","bf28a605":"df.info()","f72ae9ed":"df.shape","6a32b05d":"plt.figure(figsize=(18,10))\nsns.heatmap(df.corr(),\n            vmin=-1,\n            cmap='coolwarm',\n            annot=True)\nplt.show()","35246ccf":"deaths = len(df[df['DEATH_EVENT'] == 1])\/len(df)\nsurvivors = len(df[df['DEATH_EVENT'] == 0])\/len(df)\n\nprint('% death class: ',round(deaths,2))\nprint('% survived class: ',round(survivors,2))","33e2b384":"g = sns.displot(df, x=\"serum_creatinine\", hue=\"DEATH_EVENT\", element=\"step\")\ng.fig.set_size_inches(12,7)","4720ba70":"g = sns.displot(df, x=\"ejection_fraction\", hue=\"DEATH_EVENT\", element=\"step\")\ng.fig.set_size_inches(12,7)","9a237364":"sns.set_theme(style=\"darkgrid\")\n\ng = sns.displot(\n    df, x=\"serum_creatinine\", col=\"DEATH_EVENT\", row=\"sex\",\n    binwidth=0.3, height=3, facet_kws=dict(margin_titles=True))\n\ng.fig.set_size_inches(14,8)","046294d6":"sns.set_theme(style=\"darkgrid\")\n\ng = sns.displot(\n    df, x=\"ejection_fraction\", col=\"DEATH_EVENT\", row=\"sex\",\n    binwidth=5, height=3, facet_kws=dict(margin_titles=True))\n\ng.fig.set_size_inches(14,8)","f743f13a":"g = sns.catplot(x=\"DEATH_EVENT\", y=\"serum_creatinine\", data=df,ax=(12,8))\ng.fig.set_size_inches(12,7)","044cf32e":"g = sns.catplot(x=\"DEATH_EVENT\", y=\"ejection_fraction\", data=df,ax=(12,8))\ng.fig.set_size_inches(12,7)","4ab76d0d":"df.plot.scatter(x='serum_sodium', y='serum_creatinine', c='DEATH_EVENT', colormap='coolwarm',s=40 ,figsize=(12,7), title='Creatinine to Sodium')","4cdc6408":"# Creating figure \nfig = plt.figure(figsize = (16, 9)) \nax = plt.axes(projection =\"3d\")\n\n# Add x, y gridlines  \nax.grid(b = True, color ='grey',  \n        linestyle ='-.', linewidth = 0.3,  \n        alpha = 0.2)  \n  \n# Creating plot \nsctt = ax.scatter3D(df['serum_sodium'], df['serum_creatinine'], df['ejection_fraction'], \n                    alpha = 0.8, \n                    c = df['DEATH_EVENT'],\n                    s = 40) \n  \nplt.title('Creatinine to Sodium to Ejection Fraction') \nax.set_xlabel('serum_sodium', fontweight ='bold')  \nax.set_ylabel('serum_creatinine', fontweight ='bold')  \nax.set_zlabel('ejection_fraction', fontweight ='bold') \nfig.colorbar(sctt, ax = ax, shrink = 0.5, aspect = 5) \n  \n# show plot \nplt.show() ","cf48fa5f":"dfnew = df[['age','ejection_fraction','serum_creatinine','DEATH_EVENT']]","95594da4":"experiment1 = setup(data = dfnew, target = 'DEATH_EVENT', session_id=123,\n                  normalize = True, \n                  transformation = True, \n                  numeric_features=['ejection_fraction'],\n                  bin_numeric_features = ['age'],\n                  log_experiment = True, experiment_name = 'heart_failure1')","70fa5434":"top3 = compare_models(n_select = 3)","c0e38dbc":"model = create_model('catboost', fold = 5)","554be2bf":"tuned_model = tune_model(model, optimize = 'Accuracy')","b0a38317":"# **EXPLORATORY DATA ANALYSIS**","33974ba4":"# **MODEL TRAINING WITH PYCARET**","466dd7a7":"# **LOAD PACKAGES**"}}