{"cell_type":{"337364d8":"code","8a0b5b46":"code","6f80894c":"code","050f9ba9":"code","86f462de":"code","04f97181":"code","6ec833b7":"code","69fb5d10":"code","de52a378":"code","4cc55c21":"code","0261b7ff":"code","7a0b3ace":"markdown","0c617abf":"markdown","3735f67f":"markdown","82c20025":"markdown","842e4e63":"markdown","495ced9c":"markdown","c2f2c466":"markdown","218a889e":"markdown","9c73e2ff":"markdown","83490018":"markdown","0bb6dcd9":"markdown","6b514f92":"markdown"},"source":{"337364d8":"import numpy as np\nimport pandas as pd\nimport statsmodels.api as sm\n\ndf = pd.read_csv('..\/input\/students-data-for-mlr\/amsPredictionSheet1-201009-150447.csv')\ndf","8a0b5b46":"y = df['ESE']\nx = sm.add_constant(df[['Attendance', 'MSE', 'HRS']])\nz = df[['Attendance', 'MSE', 'HRS']]\nprint(x, y, z)","6f80894c":"x_transpose = x.T\nx_transpose","050f9ba9":"a = x_transpose.dot(x)\na_inverse = np.linalg.inv(a)\na_inverse","86f462de":"B = a_inverse.dot(x_transpose.dot(y))\nB","04f97181":"def predict_y(x1, x2, x3):\n    y_hat = B[1]*x1 + B[2]*x2 + B[3]*x3 + B[0]\n    return y_hat;","6ec833b7":"ESE_pre = predict_y(df['Attendance'], df['MSE'], df['HRS'])\nESE_pre","69fb5d10":"r_square = 1 - sum((y-ESE_pre)*(y-ESE_pre))\/sum((y-y.mean())*(y-y.mean()))\nr_square","de52a378":"import matplotlib.pyplot as plt\nplt.scatter(df['HRS'], y)\nplt.scatter(df['HRS'], ESE_pre)\nplt.show()","4cc55c21":"plt.scatter(df['MSE'], y)\nplt.scatter(df['MSE'], ESE_pre)\nplt.show()","0261b7ff":"plt.scatter(df['Attendance'], y)\nplt.scatter(df['Attendance'], ESE_pre)\nplt.show()","7a0b3ace":"The above function will predict the marks of End semester examination. Lets predict the marks of the ESE with given data.","0c617abf":"Now lets implement this formula in our module and get the values of all parameters. Before that, I will put all input variables and output variables in seperate matrices.","3735f67f":"<h1 style = \"color:purple; font-size: 50px; text-align:center; font-weight:bolder;\">Multiple Linear Regression using Matrix operation & OLS<\/h1>","82c20025":"So, The value of R<sup>2<\/sup> is 0.58. So, we can say that, our model is quite efficient.","842e4e63":"<p style = \"text-align:center\">Thank You<\/p>","495ced9c":"The formula to find the parameters of the above equation is as follows. This formula is in the form of matrix and it return a matrix of all parameters. The formula ia as follows:<br>\n![](https:\/\/cdn-images-1.medium.com\/max\/498\/1*Bt1LjOBnr9vkwPTotwM2yA.png)","c2f2c466":"**In this notebook, I am going to build a multivariate linear regression using Ordinary least square method. To build this model, I will use a dataset of 73 students. It includes attendance, Mid semester exam marks, number of hours he\/she studied one day before the exam, and the marks of the End semester exam.**","218a889e":"Yes, I have got the values of parameters. So, the equation of the multivariate linear regression is as follows:","9c73e2ff":"The following figure shows the equation of the multivariate linear regression and the simple linear ragression. We can see the basic difference from that.<br><br>\n![](https:\/\/miro.medium.com\/max\/3444\/1*uLHXR8LKGDucpwUYHx3VaQ.png)","83490018":"To check, how efficient our model is? Let's calculate the value of R<sup>2<\/sup>.","0bb6dcd9":"First of all, I will import some usefull libraries of python. Then, I will read a csv file which contains the data of the students.","6b514f92":"Now, I will try to plot some graphs, along with all input variables."}}