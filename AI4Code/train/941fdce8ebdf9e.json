{"cell_type":{"8e962e52":"code","37965234":"code","61b8a49c":"code","da007373":"code","54254a96":"code","2af5e84f":"code","de30c17a":"code","ce633a5c":"code","8a7176cf":"code","18a7f3e6":"code","862ac7a4":"code","e6c0b95e":"code","e2d3a9fa":"code","26724389":"code","c643753f":"code","30d79d07":"code","4325c836":"code","084cd31e":"code","d3cb1b77":"code","b440bde7":"code","d0ad2b50":"code","91275331":"code","0b881de9":"code","7e12b387":"code","98ed4235":"code","cb568cf7":"code","dfee9ef7":"code","349a2d79":"code","4ddbb04f":"code","c3d4a31a":"code","27970a82":"code","4efc842d":"code","2b75b8d5":"code","eee5bbcf":"code","02ab0dc3":"code","a97dae5a":"code","2b88d897":"code","5749d51c":"code","d14b5ca0":"code","e5609093":"code","cba1542f":"code","71c62ffa":"code","75c21439":"code","ae335021":"code","4b8456b6":"code","44d1e081":"code","bc8292ea":"code","4f52daa8":"code","453ea162":"code","35ef0e37":"code","0c1639f2":"code","1b47c427":"code","9700cf8d":"code","ad39eea7":"code","5be9f58a":"code","1d8526af":"code","06ea42c9":"code","74e7c367":"code","a8baefce":"code","0f25b6ba":"code","9615b24c":"code","4260ec86":"code","d060c37f":"code","ac5b1c75":"code","46230842":"code","ac7b2b17":"code","f1d94fa7":"code","49cac4c7":"code","f8fd56f7":"code","a6797421":"code","96b460b2":"code","601b4f08":"code","f8b523a3":"code","8d5214fe":"code","48157598":"code","f4dc6eab":"code","a20f6e41":"code","df75a785":"code","7a6dde64":"code","534bceb5":"code","c534ace8":"code","db4a8b81":"code","3dbf31f4":"code","3775723e":"code","45832125":"code","314cdd8f":"code","6b6a8abd":"code","2174a659":"code","83c230d8":"code","a7b0ebcf":"code","5420dd15":"code","4361978c":"code","b343216d":"code","164576fb":"code","255826fc":"code","87fa8646":"code","994f4828":"code","2ec95e28":"code","45294e8b":"code","25c5e3a5":"code","adb7c827":"code","43727e35":"code","9b6ef1ba":"code","0297950b":"code","d6ac10b5":"code","d168278c":"markdown","95158a40":"markdown","52a9178c":"markdown","31226eaf":"markdown","c22488a0":"markdown","38dc0a53":"markdown","077a5435":"markdown"},"source":{"8e962e52":"import numpy as np\nimport pandas as pd\nimport os\n\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","37965234":"submission_format = pd.read_csv(\"\/kaggle\/input\/titanic\/gender_submission.csv\")","61b8a49c":"submission_format.head()","da007373":"train_data_orig = pd.read_csv(\"\/kaggle\/input\/titanic\/train.csv\")\ntrain_data=train_data_orig.copy()\ntrain_data.head()","54254a96":"test_data_orig = pd.read_csv(\"\/kaggle\/input\/titanic\/test.csv\")\ntest_data=test_data_orig.copy()\ntest_data.head()","2af5e84f":"distinct_classes,value_counts=np.unique(train_data.Survived,return_counts=True)","de30c17a":"train_data.shape","ce633a5c":"train_data.isnull().sum()","8a7176cf":"test_data.isnull().sum()","18a7f3e6":"train_data.drop('Cabin',axis=1,inplace=True)\ntest_data.drop('Cabin',axis=1,inplace=True)","862ac7a4":"\ntrain_data.isnull().sum()","e6c0b95e":"test_data.isnull().sum()","e2d3a9fa":"train_data.head()","26724389":"train_data.drop('PassengerId',axis=1,inplace=True)","c643753f":"testPIds=test_data['PassengerId']\ntest_data.drop('PassengerId',axis=1,inplace=True)","30d79d07":"train_data.head()","4325c836":"test_data.head()","084cd31e":"def change_gender_num(s):\n    if (s=='male'):\n        return 1\n    else:\n        return 0\n    \ntrain_data['Sex']=train_data['Sex'].apply(change_gender_num)\ntest_data['Sex']=test_data['Sex'].apply(change_gender_num)","d3cb1b77":"train_data.head()","b440bde7":"test_data.head()","d0ad2b50":"train_data['relatives']=train_data['SibSp']+train_data['Parch']+1\ntrain_data.drop(['SibSp','Parch'],axis=1,inplace=True)","91275331":"test_data['relatives']=test_data['SibSp']+test_data['Parch']+1\ntest_data.drop(['SibSp','Parch'],axis=1,inplace=True)","0b881de9":"train_data.head()","7e12b387":"test_data.head()","98ed4235":"len(train_data.Ticket.unique())","cb568cf7":"train_data.drop('Ticket',axis=1,inplace=True)","dfee9ef7":"test_data.drop('Ticket',axis=1,inplace=True)","349a2d79":"train_data.head()","4ddbb04f":"test_data.head()","c3d4a31a":"def get_title(name):\n    return name.strip().split(',')[1].split('.')[0]\n    \ntrain_data['title']=train_data['Name'].apply(get_title)\ntrain_data.drop('Name',axis=1,inplace=True)\n\ntest_data['title']=test_data['Name'].apply(get_title)\ntest_data.drop('Name',axis=1,inplace=True)","27970a82":"train_data.head()","4efc842d":"test_data.head()","2b75b8d5":"import matplotlib\nimport matplotlib.pyplot as plt\nmatplotlib.rcParams['figure.figsize']=(15,10)","eee5bbcf":"(keys,values)=np.unique(train_data[train_data.Survived==1].title,return_counts=True)","02ab0dc3":"keys","a97dae5a":"plt.bar(keys,values,align='center', alpha=0.5,color='r')\nplt.xlabel('Title')\nplt.ylabel('Number of people survived')\nplt.title('Survived vs Title')\nplt.show()","2b88d897":"train_data.Age.fillna(train_data.Age.mean(),inplace=True)","5749d51c":"test_data.Age.fillna(test_data.Age.mean(),inplace=True)","d14b5ca0":"train_data.isnull().sum()","e5609093":"test_data.isnull().sum()","cba1542f":"train_data.fillna(train_data.Embarked.value_counts().idxmax(),inplace=True)","71c62ffa":"test_data.fillna(test_data.Fare.mean(),inplace=True)","75c21439":"survived_train_data=train_data[train_data.Survived==1]","ae335021":"survived_train_data.Embarked.unique()","4b8456b6":"(keys,values)=np.unique(survived_train_data.Embarked,return_counts=True)","44d1e081":"plt.bar(keys,values,align='center', alpha=0.5,color='g')\nplt.xlabel('Port')\nplt.ylabel('Number of people survived')\nplt.title('Survived vs Port')\nplt.show()","bc8292ea":"dummies=pd.get_dummies(train_data.Embarked)","4f52daa8":"dummies_test=pd.get_dummies(test_data.Embarked)","453ea162":"train_data2=pd.concat([train_data,dummies],axis='columns')","35ef0e37":"test_data2=pd.concat([test_data,dummies_test],axis='columns')","0c1639f2":"train_data2.drop('Embarked',axis=1,inplace=True)","1b47c427":"test_data2.drop('Embarked',axis=1,inplace=True)","9700cf8d":"train_data2.shape","ad39eea7":"test_data2.shape","5be9f58a":"train_data2.head()","1d8526af":"test_data2.shape","06ea42c9":"thresh_title_counts=10\ntitle_names=(train_data2.title.value_counts() < thresh_title_counts)","74e7c367":"train_data2['title']=train_data2.title.apply(lambda x:'Misc' if title_names.loc[x]==True else x)","a8baefce":"distinct_keys=list(train_data2['title'].value_counts().keys())","0f25b6ba":"distinct_keys.remove('Misc')","9615b24c":"distinct_keys","4260ec86":"test_data2['title']=test_data2.title.apply(lambda x:'Misc' if x not in distinct_keys else x)","d060c37f":"test_data2['title'].value_counts()","ac5b1c75":"train_data2.shape","46230842":"test_data2.shape","ac7b2b17":"dummies_embarked_train=pd.get_dummies(train_data2['title'])","f1d94fa7":"dummies_embarked_test=pd.get_dummies(test_data2['title'])","49cac4c7":"train_data3=pd.concat([train_data2,dummies_embarked_train],axis='columns')","f8fd56f7":"test_data3=pd.concat([test_data2,dummies_embarked_test],axis='columns')","a6797421":"train_data3.drop('title',axis=1,inplace=True)","96b460b2":"test_data3.drop('title',axis=1,inplace=True)","601b4f08":"train_data3.head()","f8b523a3":"test_data3.head()","8d5214fe":"train_data3.isnull().sum()","48157598":"test_data3.isnull().sum()","f4dc6eab":"yTrain=train_data3.Survived\ntrain_data4=train_data3.drop('Survived',axis=1)\nxTrain=train_data4.values","a20f6e41":"xTest=test_data3.values","df75a785":"print (xTrain.shape)\nprint (xTest.shape)","7a6dde64":"from sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix,classification_report","534bceb5":"xTrain_small,xTest_small,yTrain_small,yTest_small=train_test_split(xTrain,yTrain)","c534ace8":"xTrain_small.shape","db4a8b81":"from sklearn.svm import SVC\nfrom sklearn.model_selection import GridSearchCV","3dbf31f4":"clf_best_fit=SVC(kernel='linear')","3775723e":"clf=SVC(kernel='linear')","45832125":"clf.fit(xTrain_small,yTrain_small)","314cdd8f":"clf.score(xTest_small,yTest_small)","6b6a8abd":"yTest_predicted_small=clf.predict(xTest_small)","2174a659":"confusion_matrix(yTest_small,yTest_predicted_small)","83c230d8":"print (classification_report(yTest_small,yTest_predicted_small))","a7b0ebcf":"yPredicted=clf.predict(xTest)","5420dd15":"from sklearn.ensemble import RandomForestClassifier\n\nclf = RandomForestClassifier(random_state=0)\nclf.fit(xTrain_small,yTrain_small)","4361978c":"clf.score(xTest_small,yTest_small)","b343216d":"from sklearn.linear_model import LogisticRegression\n\nclf_logistic_regression=LogisticRegression(max_iter=1000)\nclf_logistic_regression.fit(xTrain_small,yTrain_small)","164576fb":"clf.score(xTest_small,yTest_small)","255826fc":"final_dataFrame=pd.DataFrame()\nfinal_dataFrame['PassengerId']=testPIds","87fa8646":"final_dataFrame.head()","994f4828":"from sklearn.neural_network import MLPClassifier","2ec95e28":"clf=MLPClassifier(hidden_layer_sizes=(20,10),max_iter=1000,activation='logistic')\nclf.fit(xTrain_small,yTrain_small)","45294e8b":"clf.score(xTest_small,yTest_small)","25c5e3a5":"yPredicted_MLP_Small=clf.predict(xTest_small)","adb7c827":"print (classification_report(yTest_small,yPredicted_MLP_Small))","43727e35":"print (confusion_matrix(yTest_small,yPredicted_MLP_Small))","9b6ef1ba":"yPredicted_MLP=clf.predict(xTest)","0297950b":"final_dataFrame['Survived']=yPredicted_MLP","d6ac10b5":"final_dataFrame.to_csv('titanic.csv', index=False)\nprint(\"Your submission was successfully saved!\")","d168278c":"## Passenger ID's are unique to each passenger hence dropping it","95158a40":"### So from the data people women with 'Miss' title were the maximum to survive","52a9178c":"## SKLEARN NEURAL NETWORKS","31226eaf":"## People who embarked from port S were the maximum to survive so it is an important feature","c22488a0":"## The feature SibSip and Parch both point to the number of family members on board for the persion so combining both these columns into 1","38dc0a53":"## Since we have 687 null values out of 891 for cabin hence dropping the cabin column","077a5435":"## Ticket also has many unique values so removing it"}}