{"cell_type":{"57c37d5c":"code","33545058":"code","0692c184":"code","661b57ab":"code","330cd29c":"code","4971ddbc":"code","cfe998a0":"code","0318adab":"code","72eaad73":"code","60506f01":"code","2cd63425":"code","446b441f":"code","3bbde6a4":"code","f93958ef":"code","932a926d":"code","74358673":"code","02dbabc8":"code","9c5e6b66":"code","88679c06":"code","0a6b2c75":"code","ccd8c6b3":"code","1692e643":"code","2faec7d7":"code","c90fa1b9":"markdown","b7e10da1":"markdown","2bbd74ec":"markdown","057ba701":"markdown","da9f48ea":"markdown","e8e49d75":"markdown","c5bde266":"markdown","4feaf0c1":"markdown","40663aa6":"markdown","dc2604a3":"markdown","4123da85":"markdown"},"source":{"57c37d5c":"!pip install pyspark #install pySpark","33545058":"import pyspark\nfrom pyspark.sql import SparkSession","0692c184":"spark= SparkSession.builder.getOrCreate()","661b57ab":"path= \"..\/input\/world-happiness-report-2021\/world-happiness-report.csv\"\ndata= spark.read.csv(path)","330cd29c":"data.show(10)","4971ddbc":"data.printSchema()","cfe998a0":"from pyspark.sql.types import StructType, StructField, StringType, IntegerType, FloatType","0318adab":"new_schema= StructType([StructField(\"Country\", StringType(), True),\n                        StructField(\"Year\", StringType(), True),\n                        StructField(\"Life_Ladder\", StringType(), True),\n                        StructField(\"Log_Gdp\", StringType(), True),\n                        StructField(\"Social_support\", StringType(), True),\n                        StructField(\"Healthy_life_expectancy\", StringType(), True),\n                        StructField(\"Freedom_to_make_life_choices \", StringType(), True),\n                        StructField(\"Generosity\", StringType(), True),\n                        StructField(\"Perceptions_of_corruption\", StringType(), True),\n                        StructField(\"Positive_affect\", StringType(), True),\n                        StructField(\"Negative_affect\", StringType(), True)\n                       ])","72eaad73":"data= spark.read.csv(path, schema=new_schema)\ndata.show(3)","60506f01":"for i in data.columns:\n    if i != \"Country\":\n        data= data.withColumn(i+\"_\",data[i].cast(FloatType())).drop(i)\ndata= data.withColumn('Year',data['Year_'].cast(IntegerType())).drop(\"Year_\")","2cd63425":"data.printSchema()","446b441f":"data.show(5)","3bbde6a4":"data.show(4)","f93958ef":"print(data.count())\ndata=data.na.drop()\ndata.show(5)\nprint(data.count())","932a926d":"country_data = data.groupBy('Country').count().show()","74358673":"Af_data= data.filter(data['Country']==\"Afghanistan\")\nAf_data= Af_data.drop('Country')\nprint(\"Number of rows that collected from Afghanistan =\", Af_data.count())\nAf_data.show(12)","02dbabc8":"Af_data.groupBy().avg('Positive_affect_').show()\nAf_data.groupBy().avg('Negative_affect_').show()","9c5e6b66":"path_2021= \"..\/input\/world-happiness-report-2021\/world-happiness-report-2021.csv\"\ndata_2021= spark.read.csv(path_2021, schema=new_schema)","88679c06":"data_2021.show(3)","0a6b2c75":"for i in data_2021.columns:\n    if i != \"Country\":\n        data_2021= data_2021.withColumn(i+\"_\",data_2021[i].cast(FloatType())).drop(i)\ndata_2021= data_2021.withColumn('Year',data_2021['Year_'].cast(IntegerType())).drop(\"Year_\")\n","ccd8c6b3":"data_2021.show(10)","1692e643":"all_data= data.union(data_2021)","2faec7d7":"all_data.show(5)","c90fa1b9":"## Question3: what is tha average of Positive and Negative affect in Afghanistan?","b7e10da1":"# <center>Importing spark and data<\/center>\n","2bbd74ec":"## 1.2 Changing datatype","057ba701":"## 1.1 Creat a schema ","da9f48ea":"## 1.3 Drop null values","e8e49d75":"# <center>Adding 2021 Dataset to the main data<\/center>","c5bde266":"## <center style=\"color:Blue\">World Happiness Dataset with Spark<\/center>\n\n<center><img src=\"https:\/\/steemitimages.com\/1280x0\/https:\/\/www.psychologies.co.uk\/sites\/default\/files\/styles\/psy2_page_header\/public\/wp-content\/uploads\/2012\/03\/happy.jpg\"><\/center>","4feaf0c1":"## <center>Let's make it looks better<\/center>","40663aa6":"# <center> Data Exploration <\/center>","dc2604a3":"## Question2: How many Country there are?","4123da85":"## Question2: How many data rows collected from Afghanistan?"}}