{"cell_type":{"9e886523":"code","5c7eaf6e":"code","6689f4ee":"code","35ce1333":"code","7da504b9":"code","f03a5ae6":"code","d921de24":"code","e07af301":"code","f2019797":"code","ffea100d":"code","372bed2c":"code","e945b4dc":"code","7b1d5939":"code","8d0d9586":"code","b7b29673":"code","5848e947":"code","939ef539":"code","86a62bbb":"code","b401013e":"code","c615b880":"code","2461b5e4":"code","6db3db3c":"code","d7a15fb4":"code","09b397e7":"code","de9a9375":"code","71c65d5e":"code","265fdd96":"code","67ca6dff":"code","02bd0086":"code","79193253":"code","5e923aee":"code","d3b2a2c2":"code","7b4d26bb":"code","f62b464e":"code","11633b4f":"code","705121df":"code","410f6bf1":"code","fa79fe33":"code","f68e3c7e":"code","eb8a331b":"code","61f27d78":"code","f755e078":"code","051a25e4":"code","c10a5ba3":"code","36ac3793":"code","e5b53180":"code","fc96d57a":"code","442cec84":"code","d83afcea":"code","76d23035":"code","4bb2acd1":"code","5f72e25c":"code","f61a826c":"markdown","ca22e434":"markdown","a0fc9883":"markdown","e436b922":"markdown","6122576c":"markdown","cf0906cf":"markdown","80d909b2":"markdown","5619333f":"markdown","9ae22ef4":"markdown","15000046":"markdown","06643d40":"markdown","5126ced2":"markdown","f18bb7f0":"markdown","e7ae5dfc":"markdown"},"source":{"9e886523":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns ","5c7eaf6e":"data=pd.read_csv('..\/input\/machine-predictive-maintenance-classification\/predictive_maintenance.csv')","6689f4ee":"data.head()","35ce1333":"data.isnull().any()","7da504b9":"data.drop('UDI',axis=1,inplace=True)","f03a5ae6":"data['Target'].value_counts()","d921de24":"data['Failure Type'].value_counts()","e07af301":"plt.figure(figsize=(10,6))\nsns.countplot(data=data,x='Failure Type')\nplt.show()","f2019797":"data['Product ID'].value_counts()","ffea100d":"data.drop(['Product ID','Failure Type'],axis=1,inplace=True)\n","372bed2c":"data.columns","e945b4dc":"corr=data.corr()\nsns.heatmap(corr,annot=True,cmap='Pastel1',fmt='.2f',linewidth=0.1,linecolor='white')\nplt.show()","7b1d5939":"print(data['Type'].value_counts())\nplt.figure(figsize=(7,5))\nsns.countplot(data=data,x='Type')\nplt.show()","8d0d9586":"plt.figure(figsize=(7,5))\nsns.countplot(data=data,x='Target')\nplt.show()","b7b29673":"data_1=pd.get_dummies(data['Type'])","5848e947":"data=pd.concat([data,data_1],axis=1)\ndata.drop('Type',axis=1,inplace=True)","939ef539":"data.head()","86a62bbb":"data.info()","b401013e":"from imblearn.over_sampling import SMOTE\nfrom sklearn.model_selection import train_test_split","c615b880":"smote=SMOTE(random_state=42)","2461b5e4":"x=data.drop('Target',axis=1)\ny=data['Target']","6db3db3c":"print(x.shape,y.shape)","d7a15fb4":"x_ovs,y_ovs=smote.fit_resample(x,y)","09b397e7":"print(x_ovs.shape,y_ovs.shape)","de9a9375":"xtran,xtest,ytran,ytest=train_test_split(x_ovs,y_ovs,test_size=0.2,random_state=42)","71c65d5e":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.metrics import accuracy_score,f1_score,confusion_matrix","265fdd96":"param={'n_estimators': [50,100,300,500],\n      'max_depth':[2,5,7],\n      'min_samples_split':[2,5,9]}","67ca6dff":"rf=RandomForestClassifier()","02bd0086":"grd_rf=GridSearchCV(rf,param_grid=param,cv=2)","79193253":"grd_rf.fit(xtran,ytran)","5e923aee":"grd_rf.best_params_","d3b2a2c2":"rf_1=RandomForestClassifier(**grd_rf.best_params_)\nrf_1=rf_1.fit(xtran,ytran)","7b4d26bb":"y_pred=rf_1.predict(xtest)","f62b464e":"accuracy_score(y_pred,ytest)","11633b4f":"f1_score(y_pred,ytest)","705121df":"rf_1.feature_importances_","410f6bf1":"plt.figure(figsize=(7,5))\nplt.bar(xtran.columns,rf_1.feature_importances_)\nplt.xticks(rotation=60)\nplt.show()","fa79fe33":"xtran.columns","f68e3c7e":"x_ovs.columns","eb8a331b":"x_ovs.rename(columns={'Air temperature [K]':'Air_temp','Process temperature [K]':'Process_temperature',\n                     'Rotational speed [rpm]':'Rotational_speed',\n                      'Torque [Nm]':'Torque','Tool wear [min]':'Tool_wear'},inplace=True)","61f27d78":"xtran,xtest,ytran,ytest=train_test_split(x_ovs,y_ovs,test_size=0.1,random_state=42)","f755e078":"import xgboost as xgb\nxg=xgb.XGBClassifier(use_label_encoder=False)","051a25e4":"params={'n_estimators':[500,700,800,900],\n       'max_depth':[1,3,5,7,9],\n       'learning_rate':[0.01,0.1],\n        'objective':['binary:logistic'],\n        'eval_metric':['error']\n       }","c10a5ba3":"grd_xgb=GridSearchCV(xg,param_grid=params,cv=2)","36ac3793":"grd_xgb.fit(xtran,ytran)","e5b53180":"grd_xgb.best_params_\n","fc96d57a":"xbg=xgb.XGBClassifier(**grd_xgb.best_params_)","442cec84":"xbg.fit(xtran,ytran)","d83afcea":"y_pred_1=xbg.predict(xtest)","76d23035":"accuracy_score(y_pred_1,ytest)","4bb2acd1":"f1_score(y_pred_1,ytest)","5f72e25c":"confusion_matrix(y_pred_1,ytest)","f61a826c":"From the above accuracy score and f1 score the xgboost algorithm just works better than random forest","ca22e434":"Count plot for Target variable","a0fc9883":"# **Data Cleaning**","e436b922":"The prediction of machine maintaiance consists of\n* Data cleaning\n* Visualization\n* Oversampling\n* Using random forest \n* using xgboost","6122576c":"Product ID seems not usefull because it is unique for each instance...","cf0906cf":"# **Oversampling**","80d909b2":"Count plot for Type","5619333f":"Heat map","9ae22ef4":"The shape after over sample using SMOTE","15000046":"# **Using XGboost**","06643d40":"# **Using Random forest**","5126ced2":"From the above countplot the imbalance of target column is seen ","f18bb7f0":"# **Visualization**","e7ae5dfc":"Oversampling the Target[1] class with SMOTE"}}