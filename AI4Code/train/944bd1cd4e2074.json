{"cell_type":{"cafc122c":"code","ea32e311":"code","70ed57c1":"code","dff13255":"code","d9b3ba34":"code","10e930c7":"code","af06e3b5":"code","ff8a63ff":"code","44ec5553":"code","4b60b11c":"code","dbf9a7ab":"code","1a06ff6a":"markdown"},"source":{"cafc122c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","ea32e311":"# ==================\n# Library\n# ==================\nimport warnings\nwarnings.simplefilter('ignore')\nimport pandas as pd\nimport numpy as np\nimport sys\nimport time\nimport datetime\nfrom contextlib import contextmanager\nimport logging\nfrom tqdm import tqdm_notebook as tqdm\nimport feather\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import LabelEncoder\nfrom gensim.models import FastText\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.decomposition import TruncatedSVD","70ed57c1":"# ==================\n# Constant\n# ==================\nTRAIN_PATH = \"\/kaggle\/input\/machine-learning-challenge-osaka-2020\/train.csv\"\nTEST_PATH = \"\/kaggle\/input\/machine-learning-challenge-osaka-2020\/test.csv\"\nREVIEW_TRAIN_PATH = \"\/kaggle\/input\/machine-learning-challenge-osaka-2020\/review_train.csv\"\nREVIEW_TEST_PATH = \"\/kaggle\/input\/machine-learning-challenge-osaka-2020\/review_test.csv\"","dff13255":"# ===============\n# Settings\n# ===============\nSAVE_PATH = \"review_tfidf.feather\"","d9b3ba34":"# \u30c7\u30fc\u30bf\u306e\u30ed\u30fc\u30c9\ntrain_review = pd.read_csv(REVIEW_TRAIN_PATH)\ntest_review = pd.read_csv(REVIEW_TEST_PATH)","10e930c7":"# \u30c7\u30fc\u30bf\u306e\u7d50\u5408\nreview_all = pd.concat([train_review[[\"title\",\"review\"]],test_review[[\"title\",\"review\"]]]).reset_index(drop=True)","af06e3b5":"# title\u3068review\u3092\u4e00\u3064\u306b\u307e\u3068\u3081\u307e\u3059\nreview_all[\"text\"] = review_all[\"title\"] + \" \" + review_all[\"review\"]","ff8a63ff":"tv = TfidfVectorizer()\nreview_all[\"text\"] = review_all[\"text\"].astype(str)\nX = tv.fit_transform(review_all[\"text\"])","44ec5553":"# TruncatedSVD\u3067\u6b21\u5143\u524a\u6e1b\u3057\u307e\u3059\nn_components = 20\nsvd = TruncatedSVD(n_components=n_components)\nX = svd.fit_transform(X)","4b60b11c":"df = pd.DataFrame(X, columns=[f\"tfidf_{i}\" for i in range(n_components)])","dbf9a7ab":"df.to_feather(SAVE_PATH)","1a06ff6a":"## tfidf\u3067review\u3092\u30d9\u30af\u30c8\u30eb\u5316\u3057\u307e\u3059\n\u203breview data\u306erating\u3092\u6d3b\u7528\u3057\u305f\u7279\u5fb4\u91cf\u4f5c\u6210\u306e\u4e00\u90e8\u3067\u3059\u3002"}}