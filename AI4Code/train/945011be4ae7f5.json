{"cell_type":{"dc1c116c":"code","6d5098ed":"code","d91acb46":"code","3a621f60":"code","835a9620":"code","61e58cbc":"code","28579685":"code","95336c9a":"code","a492c4e4":"code","2e203010":"code","6fa8d77f":"code","1eb1ec0c":"code","0c8ed747":"code","6b984cf3":"code","cbbfea0c":"code","d9809cc8":"code","d6ea4e38":"code","9e202c3a":"code","1ead8e06":"code","e38e7ee2":"markdown","cdd68f6b":"markdown","3d09cbf2":"markdown","d5200164":"markdown","3768e54d":"markdown","d25541fd":"markdown","44f36620":"markdown","01fa5f5d":"markdown","16b3e08f":"markdown","971613bd":"markdown","9f2e0cb2":"markdown","2ed4c10c":"markdown","f9ebc0e7":"markdown"},"source":{"dc1c116c":"import pandas as pd, numpy as np, matplotlib.pyplot as plt, seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","6d5098ed":"data= pd.read_csv('..\/input\/drug-classification\/drug200.csv')","d91acb46":"data.head()","3a621f60":"data.info()","835a9620":"data2= data.drop(['Age','Na_to_K'],axis=1)\nfor x in data2:\n    print(pd.DataFrame(data[x].value_counts()))","61e58cbc":"data.shape","28579685":"fig, ax= plt.subplots(2, 2, figsize=(10,13))\nax[0,0].bar(data2['Sex'].unique(), data2['Sex'].value_counts())\nax[0,0].set_title('Sex')\nax[0,1].bar(data2['Cholesterol'].unique(), data2['Cholesterol'].value_counts())\nax[0,1].set_title('Cholesterol')\nax[1,0].bar(data2['Drug'].unique(), data2['Drug'].value_counts())\nax[1,0].set_title('Drug')\nax[1,1].bar(data2['BP'].unique(), data2['BP'].value_counts())\nax[1,1].set_title('BP')     ","95336c9a":"from sklearn.preprocessing import LabelEncoder\nle= LabelEncoder()\nfor i in data2.columns:\n    data2[i] = le.fit_transform(data2[i])\n    print(i, le.classes_)","a492c4e4":"data2['Age']= pd.Series(data['Age'])\ndata2['Na_to_K']= pd.Series(data['Na_to_K'])\nfor col in data2.columns:\n    data2[col]= data2[col].astype('int64')\nx= data2.drop('Drug', axis=1)\ny= data2['Drug']","2e203010":"data2.head()","6fa8d77f":"round(data2.describe().T,3)","1eb1ec0c":"sns.heatmap(x.corr().abs() , annot= True)","0c8ed747":"data.shape","6b984cf3":"women= data2[data2['Sex']==0]\nmen= data2[data2['Sex']==1]","cbbfea0c":"high_f= women[women['BP']==0].Age.dropna()\nlow_f= women[women['BP']==1].Age.dropna()\nnormal_f= women[women['BP']==2].Age.dropna()\n\nhigh_m= men[men['BP']==0].Age.dropna()\nlow_m= men[men['BP']==1].Age.dropna()\nnormal_m= men[men['BP']==2].Age.dropna()\n\nfig, ax= plt.subplots(2,2, figsize=(10,12))\nsns.distplot(high_f, label=\"Female High BP\", ax=ax[0,0], bins=15, kde=False)\nsns.distplot(high_m, label=\"Male High BP\", ax=ax[0,0], bins=15, kde=False)\nax[0,0].legend()\nax[0,0].set_title('HIGH BP')\n\nsns.distplot(low_f, label=\"Female Low BP\", ax=ax[0,1], bins=15, kde=False)\nsns.distplot(low_m, label=\"Male High BP\", ax=ax[0,1], bins=15, kde=False)\nax[0,1].legend()\nax[0,1].set_title('LOW BP')\n\nsns.distplot(normal_f, label=\"Female Normal BP\", ax=ax[1,0], bins=15, kde=False)\nsns.distplot(normal_m, label=\"Male Normal BP\", ax=ax[1,0], bins=15, kde= False)\nax[1,0].legend()\nax[1,0].set_title('NORMAL BP')\nax[1,1].cla()","d9809cc8":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test = train_test_split(x,y, test_size= 0.3, random_state=0)","d6ea4e38":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.linear_model import SGDClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.model_selection import GridSearchCV,KFold","9e202c3a":"def result_using_non_tree_classifier(x_train,x_test,y_train,y_test):\n    kf = KFold(n_splits=5, random_state=None)\n    scores= []\n    algos1={'KNN' : {'model' : KNeighborsClassifier(n_jobs= -1) , \n                    'param' : {'n_neighbors' : np.arange(1,20,3).tolist() , 'weights' : ['distance' , 'uniform']}\n                    },\n            \n            'SGD' : {'model' : SGDClassifier(),\n                    'param' : {'penalty' : ['l2', 'l1', 'elasticnet'], 'loss' : ['hinge','log','modified_huber','perceptron']}\n                    },\n            \n            'GaussianNB' : {'model': GaussianNB(),\n                            'param':{}\n                           }\n           }\n    for algo_name, params in algos1.items() :\n        Grid1 = GridSearchCV(params['model'], params['param'], cv=kf, return_train_score=False)\n        Grid1.fit(x_train, y_train)\n        ypred= Grid1.predict(x_test)\n        scores.append({\n            'model' : algo_name,\n            'best_score': Grid1.best_score_ ,\n            'best_params' : Grid1.best_params_\n        })\n    return pd.DataFrame(scores,columns=['model','best_score','best_params'])\nresult_using_non_tree_classifier(x_train,x_test,y_train,y_test)","1ead8e06":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score\nresult= []\nRF = RandomForestClassifier(oob_score=False, \n                            random_state=42, \n                            warm_start=True,\n                            n_jobs=-1)\nfor n_trees in [15, 20, 30, 40, 50, 100, 150, 200, 300, 400]:\n    RF.set_params(n_estimators= n_trees)     # Use this to set the number of trees\n    RF.fit(x_train,y_train)\n    ypred= RF.predict(x_test)\n    result.append(pd.Series({\n        'num_trees' : n_trees,\n        'accuracy' : accuracy_score(ypred, y_test)\n    }))\nresults= pd.concat(result, axis=1).T.set_index('num_trees')\nresults","e38e7ee2":"Surprisingly, RANDOM FOREST predicts with 100% accuracy!","cdd68f6b":"## Counting unique Categorical values","3d09cbf2":"## Plotting Categorical values","d5200164":"## Finding the correlation","3768e54d":"## Making function for prediction","d25541fd":"## If there is any kind of mistake do let me know in the comments. Please!","44f36620":"From the above Data Frame, we can conclude that 'GaussianNB' comes out to be the better option of all the other classifiers.","01fa5f5d":"## Encoding the data","16b3e08f":"## Trying Random Forest","971613bd":"## EXPLORING THE DATA","9f2e0cb2":"Here, we can see:\n \n i) WOMEN in the Age group of 15-35 years tend to have HIGHER BP than MEN. But, after 37 years MEN tend to have higher BP.\n \n ii) MEN in the Age group of 37-56 years tend to have LOWER BP than WOMEN.\n \n iii) MEN with NORMAL BP occurs after 50 years of age, but, we can see WOMEN have comparatively larger number than MEN\n     throughout the ages.\n","2ed4c10c":"We can see, there is no null value in the data.","f9ebc0e7":"We are not going to remove any column."}}