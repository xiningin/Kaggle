{"cell_type":{"deb02103":"code","2800475a":"code","83f78e01":"code","95cb1fea":"code","c89cde34":"code","09fa49dd":"code","4aa0e761":"code","69dda433":"code","e1f5a82a":"code","dbdff493":"code","50fd8d45":"code","cb9f4109":"code","8dfe31af":"code","11aaae62":"code","21b31476":"code","3717421f":"code","80aa90ac":"code","ee6c0641":"markdown","48797dc7":"markdown","7db1374a":"markdown","8b043fe0":"markdown","0b6472ca":"markdown"},"source":{"deb02103":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import OrdinalEncoder\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn.metrics import r2_score, mean_squared_error","2800475a":"train = pd.read_csv(\"\/kaggle\/input\/osic-pulmonary-fibrosis-progression\/train.csv\")\ntest = pd.read_csv(\"\/kaggle\/input\/osic-pulmonary-fibrosis-progression\/test.csv\")\nsample = pd.read_csv(\"\/kaggle\/input\/osic-pulmonary-fibrosis-progression\/sample_submission.csv\")\ntrain.head()","83f78e01":"print(\"Training data size is :\",train.shape[0])\nprint(\"Testing data size is :\",test.shape[0])","95cb1fea":"train.isna().sum()","c89cde34":"train_cat = OrdinalEncoder().fit_transform(train[['Sex', 'SmokingStatus']]) \ntrain_cat = pd.DataFrame({'Sex': train_cat[:, 0], 'SmokingStatus': train_cat[:, 1]})","09fa49dd":"train_num = StandardScaler().fit_transform(train[['Weeks', 'Percent','Age']])  # standard scaling \ntrain_num = pd.DataFrame({'Weeks': train_num[:, 0], 'Percent': train_num[:, 1],'Age':train_num[:,2]})","4aa0e761":"df = pd.concat([train_cat, train_num, train['FVC']], axis = 1)","69dda433":"X = df.drop('FVC',axis =1)\ny = df['FVC']","e1f5a82a":"X_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.2, random_state=42)","dbdff493":"params = {'n_estimators': 300,\n          'max_depth': 7,\n          'learning_rate': 0.01}\n\nreg = GradientBoostingRegressor(**params)\n\n%time reg.fit(X_train, y_train)\n\ny_pred = reg.predict(X_test)\n\nmse = mean_squared_error(y_test, y_pred)\n\nprint(\"The mean squared error (MSE) on test set: {}\".format(mse))","50fd8d45":"test_score = np.zeros((params['n_estimators'],), dtype=np.float64)\nfor i, y_pred in enumerate(reg.staged_predict(X_test)):\n    test_score[i] = reg.loss_(y_test, y_pred)\n\nfig = plt.figure(figsize=(6, 6))\nplt.subplot(1, 1, 1)\nplt.title('Deviance')\nplt.plot(np.arange(params['n_estimators']) + 1, reg.train_score_, 'b-',\n         label='Training Set Deviance')\nplt.plot(np.arange(params['n_estimators']) + 1, test_score, 'r-',\n         label='Test Set Deviance')\nplt.legend(loc='upper right')\nplt.xlabel('Boosting Iterations')\nplt.ylabel('Deviance')\nfig.tight_layout()\nplt.show()","cb9f4109":"from xgboost import XGBRegressor\n\nparams = {'n_estimators': 300,\n          'max_depth': 7,\n          'learning_rate': 0.25}\n\nmodel = XGBRegressor(**params)\n\n%time model.fit(X_train,y_train)\n\ny_pred = model.predict(X_test)\n\nmse = mean_squared_error(y_test, y_pred)\n\nprint(\"The mean squared error (MSE) on test set: {}\".format(mse))\n\nprint(model.feature_importances_)","8dfe31af":"test_score = np.zeros((params['n_estimators'],), dtype=np.float64)\nfor i, y_pred in enumerate(reg.staged_predict(X_test)):\n    test_score[i] = reg.loss_(y_test, y_pred)\n\nfig = plt.figure(figsize=(6, 6))\nplt.subplot(1, 1, 1)\nplt.title('Deviance')\nplt.plot(np.arange(params['n_estimators']) + 1, reg.train_score_, 'b-',\n         label='Training Set Deviance')\nplt.plot(np.arange(params['n_estimators']) + 1, test_score, 'r-',\n         label='Test Set Deviance')\nplt.legend(loc='upper right')\nplt.xlabel('Boosting Iterations')\nplt.ylabel('Deviance')\nfig.tight_layout()\nplt.show()","11aaae62":"test_cat = OrdinalEncoder().fit_transform(test[['Sex', 'SmokingStatus']]) # categorical Encoding \ntest_cat = pd.DataFrame({'Sex': test_cat[:, 0], 'SmokingStatus': test_cat[:, 1]})\ntest_num = StandardScaler().fit_transform(test[['Weeks', 'Percent','Age']])  # standard scaling \ntest_num = pd.DataFrame({'Weeks': test_num[:, 0], 'Percent': test_num[:, 1],'Age':test_num[:,2]})\nXtest = pd.concat([test_cat, test_num], axis = 1)","21b31476":"y_pred_score = reg.predict(Xtest)\ny_pred_score","3717421f":"pred = pd.DataFrame(y_pred_score,columns = ['FVC'])\npred['Confidence'] = pred['FVC'].std()","80aa90ac":"sub = pd.DataFrame({'Patient_Week': sample.Patient_Week, 'FVC': pred['FVC']})\nsub = sub[['Patient_Week', 'FVC',]]\nfilename = 'submission.csv'\nsub['Confidence'] = pred['Confidence']\nsub.to_csv(filename, index=False) \nsub.head()","ee6c0641":"# train Test Split","48797dc7":"# Gradient Boosting Regressor","7db1374a":"# Scaleing Numerical feature","8b043fe0":"# XGB Regressor","0b6472ca":"# Encoding Categorical Feature"}}