{"cell_type":{"a458a8b9":"code","4d2505bf":"code","8ffce34b":"code","03f2e56a":"code","5e55a8f3":"code","8766e7f8":"code","2d6f19d9":"code","31fef507":"code","43446f53":"code","1aa5ac0b":"code","d173b611":"code","2f6a8026":"code","e2632bc9":"code","47b3288d":"code","bb6357df":"code","ba2620aa":"code","7db69b40":"code","dfc899d8":"code","3211d7da":"code","3cbbcf67":"code","fb134302":"code","8010b7c0":"code","93eb57ce":"code","9d5ef67e":"code","2a399eeb":"markdown","e0d1cf81":"markdown","15f7081d":"markdown","529d2f72":"markdown","4288fadf":"markdown"},"source":{"a458a8b9":"import pandas as pd\nimport plotly.io as pio\nimport plotly.express as px\nimport plotly.offline as py\nfrom plotly.offline import iplot \nimport plotly.graph_objects as go","4d2505bf":"# import dash\n!pip install jupyter-dash\nfrom jupyter_dash import JupyterDash\nimport dash\nimport dash_html_components as html","8ffce34b":"data = pd.read_csv('\/kaggle\/input\/france-air-quality-data\/france_air_quality_data_merged.csv')\ndata.head()\n","03f2e56a":"print(data[\"City\"].unique())","5e55a8f3":"print(data[\"Specie\"].unique())","8766e7f8":"my_cities = ['Bordeaux', 'Grenoble', 'Toulouse']\ndf_myCities = data.loc[data[\"City\"].isin(my_cities)] \ndf_myCities.head()","2d6f19d9":"df_myCities = df_myCities.reset_index()[['Date','City','Specie','count']]\ndf_myCities = df_myCities[df_myCities.Specie.apply(lambda x: x == \"pm25\" or x == \"pm10\" or x == \"no2\" or x == \"o3\" or x == \"so2\" or x == \"co\")] \ndf_myCities","31fef507":"fig = px.bar(df_myCities, x = 'Specie', y = \"count\", animation_frame = \"Date\", color = \"City\")\nfig.show()","43446f53":"df_Bdx = df_myCities[data['City']== 'Bordeaux']\nfig_Bdx = px.line(df_Bdx, x=\"Date\", y=\"count\", color=\"Specie\", title=\"Pollutant counts by time in Bordeaux\")\nfig_Bdx.update_traces(mode=\"markers+lines\")\nfig_Bdx.show()","1aa5ac0b":"df_Grn = df_myCities[data['City']== 'Grenoble']\nfig_Grn = px.line(df_Grn, x=\"Date\", y=\"count\", color=\"Specie\", title=\"Pollutant counts by time in Grenoble\")\nfig_Grn.update_traces(mode=\"markers+lines\")\nfig_Grn.show()","d173b611":"df_Toul = df_myCities[data['City']== 'Toulouse']\nfig_Toul = px.line(df_Toul, x=\"Date\", y=\"count\", color=\"Specie\", title=\"Pollutant counts by time in Toulouse\")\nfig_Toul.update_traces(mode=\"markers+lines\")\nfig_Toul.show()","2f6a8026":"def generate_scatter_plots(input_df, name_specie):    \n    df_specie = input_df[input_df['Specie'] == name_specie]\n    fig = px.line(df_specie, x=\"Date\", y=\"count\", color='City', title= str(name_specie)+\" counts by time\")\n    return fig","e2632bc9":"fig_pm25 = generate_scatter_plots(df_myCities,\"pm25\")  \nfig_pm25.show()","47b3288d":"fig_pm10 = generate_scatter_plots(df_myCities,\"pm10\")  \nfig_pm10.show()","bb6357df":"fig_so2 = generate_scatter_plots(df_myCities,\"so2\")  \nfig_so2.show()","ba2620aa":"fig_no2 = generate_scatter_plots(df_myCities,\"no2\")  \nfig_no2.show()","7db69b40":"fig_o3 = generate_scatter_plots(df_myCities,\"o3\")  \nfig_o3.show()","dfc899d8":"fig_co = generate_scatter_plots(df_myCities,\"co\")  \nfig_co.show()","3211d7da":"df_co = df_myCities[df_myCities['Specie']== 'co']\ndf_co","3cbbcf67":"df_pm25 = df_myCities[df_myCities['Specie'] == 'pm25']\n","fb134302":"def create_df_monthly(input_df):\n    by_month = pd.to_datetime(input_df['Date']).dt.to_period('M').value_counts().sort_index()\n    by_month.index = pd.PeriodIndex(by_month.index)\n    df_month = by_month.rename_axis('month').reset_index(name='counts')\n    return df_month","8010b7c0":"df_monthly = create_df_monthly(df_pm25)\n# df_monthly","93eb57ce":"def scatter_plot(input_df, name_specie):\n    fig = go.Figure(data=go.Scatter(x=input_df['month'].astype(dtype=str), \n                        y=input_df['counts'],\n                        marker_color='indianred', text=\"counts\"))\n    fig.update_layout({\"title\": str(name_specie) + ' counts by months',\n                   \"xaxis\": {\"title\":\"Months\"},\n                   \"yaxis\": {\"title\":\"Total counts\"},\n                   \"showlegend\": False})\n    fig.update_traces(mode=\"markers+lines\", hovertemplate=None)\n\n    return fig","9d5ef67e":"fig_pm25 = scatter_plot(df_monthly, \"pm25\")\nfig_pm25.show()","2a399eeb":"### **All pollutant counts by time for a city**","e0d1cf81":"### **Each pollutant counts by time for all three cities**","15f7081d":"### **In progress: Generate scatter plots with monthly averages**","529d2f72":"### Apparently there is no data available for \"co\" specie.","4288fadf":"### **Animated bar plot of pollutants for all cities**"}}