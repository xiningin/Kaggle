{"cell_type":{"a2d4631b":"code","9d8847ee":"code","ba09a487":"code","d4e44be4":"code","17f840dd":"code","d328db8f":"code","8df63007":"code","80adf10e":"code","a24f81b7":"code","2c45a374":"code","989f456d":"code","6d181911":"markdown","7ab0f128":"markdown","662da783":"markdown","14401635":"markdown","47f1c571":"markdown","27d1ad62":"markdown","3f9b4980":"markdown","4f73ade6":"markdown","8c348158":"markdown","dcd78c00":"markdown","1238f3ca":"markdown","d97c6b76":"markdown","b463dbaa":"markdown","f0081955":"markdown","82350c00":"markdown"},"source":{"a2d4631b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","9d8847ee":"episodes_df = pd.read_csv('\/kaggle\/input\/the-office-episodes-data\/the_office_episodes.csv',\n                          parse_dates=['original_air_date'])\nimdb_df = pd.read_csv('\/kaggle\/input\/the-office-episodes-data\/the_office_imdb.csv',\n                      parse_dates=['original_air_date'])\n\nepisodes_df.head()","ba09a487":"# Only keep relevant columns from the IMDb dataset to avoid duplication.\nimdb_df = imdb_df[['title', 'original_air_date', 'imdb_rating', 'total_votes', 'desc']]\n\nthe_office_df = episodes_df.merge(imdb_df, how='left', on=['title', 'original_air_date'])\n\nthe_office_df.head()","d4e44be4":"sns.lmplot(x=\"episode_num_overall\", y=\"imdb_rating\", hue=\"season\", data=the_office_df, height=6, aspect=2, ci=None)\nplt.xlabel(\"Episode\")\nplt.ylabel(\"IMDb Rating\")\nplt.title(\"IMDb Ratings for The Office episodes\")","17f840dd":"sns.lmplot(x=\"episode_num_overall\", y=\"us_viewers\", hue=\"season\", data=the_office_df, height=6, aspect=2, ci=None)\nplt.xlabel(\"Episode\")\nplt.ylabel(\"US Viewers\")\nplt.title(\"US Viewers for The Office episodes\")\nplt.ticklabel_format(style='plain', axis='y')","d328db8f":"writers_df = the_office_df['written_by'].value_counts()[:10].sort_values()\nwriters_df.plot(kind='barh', figsize=(14,6), legend=False,\n                title=\"Who wrote the most episodes of The Office?\")\nplt.ylabel(\"Writer(s)\");","8df63007":"directors_df = the_office_df['directed_by'].value_counts()[:10].sort_values()\ndirectors_df.plot(kind='barh', figsize=(14,6), legend=False,\n                title=\"Who directed the most episodes of The Office?\")\nplt.ylabel(\"Director\");","80adf10e":"best_writers = the_office_df.groupby('written_by')['imdb_rating'].agg(['mean', 'count']).sort_values(by='mean')\n\n# combine the writers names with their episode counts\nlabels = ['{} ({})'.format(name, best_writers.loc[name, 'count']) for name in best_writers.index]\nbest_writers.index = labels\n\nbest_writers.plot(kind='barh', figsize=(14,14), y='mean', legend=False,\n                   title=\"The Office Writers by Average IMDb Rating\")","a24f81b7":"character_names = ['Michael', 'Dwight', 'Jim', 'Pam', 'Andy', 'Kevin',\n                   'Angela', 'Oscar', 'Erin', 'Ryan', 'Darryl']\n\nfor char_name in character_names:\n    the_office_df[char_name] = np.where(the_office_df['desc'].str.contains(char_name), 1, 0)\n    \nthe_office_df.head()","2c45a374":"char_colors = {'Michael': '#4e79a7', 'Dwight': '#e15759', 'Pam': '#f28e2b', \n               'Jim': '#76b7b2', 'Kevin': '#59a14f', 'Angela': '#edc948',\n               'Oscar': '#b07aa1', 'Erin': '#ff9da7', 'Andy': '#9c755f',\n               'Ryan': '#bab0ac', 'Darryl': '#A2E4B8'}\n\nseries_stars = the_office_df[character_names].sum().sort_values()\ncolors = [char_colors[char] for char in series_stars.index]\nseries_stars.plot.barh(figsize=(10, 6), color=colors,\n                       title='The Office Character Mentions in Episode Descriptions');","989f456d":"fig, axes = plt.subplots(9, 1, figsize=(10,18), sharex=True)\n\nfor s in range(1, 10):\n    gb = the_office_df[['season'] + character_names].groupby('season').sum()\n    season_stars = gb.T[s].sort_values().tail(3) # top 3 characters in each season\n    colors = [char_colors[char] for char in season_stars.index]\n    season_stars.plot.barh(ax=axes[s-1], title='Season ' + str(s), color=colors)\nfig.suptitle(\"The Office Character Mentions in Episodes by Season\")\nfig.tight_layout();","6d181911":"[Paul Feig](https:\/\/en.wikipedia.org\/wiki\/Paul_Feig) (too many credits to list) was the most frequent director on *The Office*.","7ab0f128":"### Which seasons have the highest number of viewers?","662da783":"There are a few interesting points here:\n- Season 1 had steadily declining viewership. I've read that the show was only saved by Steve Carell suddenly becoming a huge star after the release of [*The 40-Year-Old Virgin*](https:\/\/en.wikipedia.org\/wiki\/The_40-Year-Old_Virgin).\n- There are a couple of outlier data points during season 5 when the show aired two episodes following the Super Bowl, but it looks like none of those extra viewers became regular fans of the show.\n- After Carell's departure, we see the same drop in viewership that we saw in IMDb ratings, and the same increase at the end of the series.","14401635":"### Who are the fan-favorite The Office writers?\n Let's see who had the highest average IMDb rating among writers.","47f1c571":"### Load and Merge the episode data and IMDb ratings files\nA short example notebook to show how to load and merge the data from the two files in The Office dataset. The common columns are Title and Air Date.","27d1ad62":"[Mindy Kaling](https:\/\/en.wikipedia.org\/wiki\/Mindy_Kaling) (Kelly Kapoor) wrote the most episodes with 21. B.J. Novak (Ryan) was also among the regular cast, and Michael Schur had a recurring role as Dwight's cousin Mose.","3f9b4980":"### Who wrote the most episodes of The Office?\n\nOne of the unique things about *The Office* is that many of the cast members were also writers on the show. Let's see who among the wrote the most episodes. There were many different writing teams on the show, so we'll only look at the top ten.","4f73ade6":"We can see that Michael remains the main character throughout the first seven seasons of the show, but the focus on supporting characters changes from one season to the next, usually some combination of Dwight, Jim, and Pam. Andy's character is elevated in importance after Michael leaves The Office. Also note that there are fewer mentions overall in seasons 1 because that season has fewer episodes than the rest.","8c348158":"### Who directed the most episodes of The Office?","dcd78c00":"It looks like the writing team of [Greg Daniels](https:\/\/en.wikipedia.org\/wiki\/Greg_Daniels) & [Mindy Kaling](https:\/\/en.wikipedia.org\/wiki\/Mindy_Kaling) (Kelly Kapoor) had the highest average rating. Note that Mindy Kaling's 21 episodes had an impressive average rating just over 8.0.","1238f3ca":"### Who are the most important characters on The Office?\n\nIn [The Office Lines Data Analysis](https:\/\/www.kaggle.com\/bcruise\/the-office-lines-data-analysis) I analyzed a data set of the lines of dialogue from all nine seasons to see which characters the series focused on most often. Let's see if we get similar results by looking at how often each character is mentioned in the IMDb episode descriptions.\n\nWe'll start by adding a column to the IMDb data set for each main character, noting whether that character's name is mentioned in the description for each episode.","d97c6b76":"### Which seasons have the highest IMDb ratings?","b463dbaa":"Now we can sum the columns to get the total number of mentions for each character for the entire series.","f0081955":"It looks like seasons 2-5 are fan favorites, with a slow decline in ratings in the following seasons. There were several highly-rated episodes near the end of season 7, and again at the end of the series in season 9. Season 8 had by far the lowest ratings. This was the season following the departure of [Steve Carell](https:\/\/en.wikipedia.org\/wiki\/Steve_Carell).","82350c00":"As expected, Michael Scott is the most often mentioned character, followed by Dwight, Jim, Pam, and Andy. We can also look at who was mentioned most often in each season to see if focus changes throughout the series."}}