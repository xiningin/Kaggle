{"cell_type":{"6113bea9":"code","eadb303f":"code","e27e903e":"code","10a74b0f":"code","f66fb4b6":"code","2e71cf63":"code","22109fb7":"code","4767881f":"code","b743c6be":"code","ea04e1c8":"code","7e4ca463":"code","f3c4c999":"code","d326ac6b":"code","6346a18f":"code","4f4ff050":"code","5afe6966":"code","96d5237b":"code","252379cf":"code","cc4e533b":"code","cd7b60d5":"code","d4feae1c":"code","c05317c1":"code","8784c4e1":"code","6a46b975":"code","99145d8a":"code","814c2e99":"code","97b70ce4":"code","02b276cb":"code","a9dd2f4f":"code","f5cd0b74":"code","54ca26ab":"markdown","413b9f69":"markdown","ad661a4b":"markdown","ffcb675a":"markdown"},"source":{"6113bea9":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","eadb303f":"import pandas as pd\nimport numpy as np\nimport xgboost as xgb\nfrom scipy import stats\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.svm import SVC, LinearSVC\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.linear_model import Perceptron\nfrom sklearn.linear_model import SGDClassifier\nfrom sklearn.svm import SVR\nfrom lightgbm import LGBMRegressor\nfrom xgboost import XGBRegressor\nfrom mlxtend.regressor import StackingRegressor\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.preprocessing import RobustScaler\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.linear_model import Lasso, Ridge\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.metrics import accuracy_score\npd.pandas.set_option(\"display.max_columns\",None)\nprint(\"all necessary libraries are imported\")","e27e903e":"jokes=pd.read_csv('..\/input\/joke-rating-prediction\/train_MaefO4x\/jokes.csv')\ntrain=pd.read_csv('..\/input\/joke-rating-prediction\/train_MaefO4x\/train.csv')\ntest=pd.read_csv('..\/input\/joke-rating-prediction\/test_MElQnvy\/test.csv')","10a74b0f":"jokes.head()","f66fb4b6":"train.head()","2e71cf63":"test.head()","22109fb7":"jokes.isnull().any()","4767881f":"train.isnull().any()","b743c6be":"test.isnull().any()","ea04e1c8":"jokes.shape,train.shape,test.shape","7e4ca463":"train['user_id'].nunique()","f3c4c999":"test['user_id'].nunique()","d326ac6b":"train.Rating.plot(kind='hist')","6346a18f":"train['Rating'].plot(kind='density',figsize=(14,4))","4f4ff050":"y=train['Rating']\ny","5afe6966":"train.drop(['Rating'],axis=1,inplace=True)","96d5237b":"train.head()","252379cf":"test.head()","cc4e533b":"x_train,x_test,y_train,y_test=train_test_split(train,y,test_size=0.33,random_state=True)","cd7b60d5":"model=RandomForestRegressor(n_estimators=100,min_samples_leaf=100,\n                            oob_score = True,\n                            random_state=42,\n                            max_features='auto',\n                            n_jobs=4,\n                           min_samples_split=2)","d4feae1c":"model","c05317c1":"model.fit(x_train,y_train)\npred=model.predict(x_test)\nmean_absolute_error(pred,y_test)","8784c4e1":"pred1=model.predict(test)","6a46b975":"submission=pd.read_csv(\"..\/input\/joke-rating-prediction\/sample_submission_5ms57N3.csv\")\nsubmission","99145d8a":"submission['id']=test['id']","814c2e99":"test['id'].shape","97b70ce4":"pred1.shape","02b276cb":"submission['Rating']=pred1","a9dd2f4f":"pd.DataFrame(submission,columns=['id','Rating']).to_csv('jokes.csv',index=False)","f5cd0b74":"pd.read_csv(\"jokes.csv\")","54ca26ab":"# Visulaziation","413b9f69":"# Unique users in train and test data set","ad661a4b":"# Checking for missing values","ffcb675a":"# Model Building"}}