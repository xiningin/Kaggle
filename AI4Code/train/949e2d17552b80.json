{"cell_type":{"2b583a72":"code","4a888e2a":"code","c8adba3b":"code","d3149ab9":"code","f67d4b24":"code","f3b570e7":"code","68765512":"code","28cbe7fb":"code","5566fd0c":"code","ea5fc738":"code","d8018321":"code","3843a20a":"code","f7c6ea71":"code","eccf503b":"code","2f0918de":"code","877fb460":"code","55ac4610":"code","7775089e":"code","62c3e535":"code","ab81ab5d":"markdown","fe62aab9":"markdown","abd91eb5":"markdown","b1cbc3e5":"markdown","f9788857":"markdown","ef37b09c":"markdown","d199e9b9":"markdown","d1fca168":"markdown","63fb6081":"markdown","6b393f8d":"markdown","7a1bbd26":"markdown","04e5701a":"markdown","7401bce7":"markdown","264a390d":"markdown","18d5eee7":"markdown","474cf436":"markdown","942a380c":"markdown","0c5ef0fb":"markdown","68416fcc":"markdown","9ef9691e":"markdown","b7d0d784":"markdown"},"source":{"2b583a72":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport statsmodels.api as sm\nimport seaborn as sns\nsns.set()","4a888e2a":"data=pd.read_csv('..\/input\/101-simple-linear-regressioncsv\/1.01. Simple linear regression.csv')\ndata","c8adba3b":"data.describe()\n#\n#SAT=Critical Reading + Mathematics + Writing\n#GPA=Grade Point Average\n","d3149ab9":"y=data['GPA']\nx1=data['SAT']","f67d4b24":"plt.scatter(x1,y)\nplt.xlabel('SAT')\nplt.ylabel('GPA')","f3b570e7":"# y=b0+b1x1\n\nx=sm.add_constant(x1)\n\nresults=sm.OLS(y,x).fit()\n#Contain Ordinary Least Square Regression \nresults.summary()","68765512":"plt.scatter(x1,y)\nyhat=0.2750+0.0017*x1 #yHat=0.275+0.0017x1 Regression Line\nfig=plt.plot(x1,yhat, lw=4,c='orange',label='Regression Line')\nplt.xlabel('SAT',fontsize='20')\nplt.ylabel('GPA',fontsize='20')\nplt.show()","28cbe7fb":"raw_data=pd.read_csv('..\/input\/103-dummiescsv\/1.03. Dummies.csv')\nraw_data","5566fd0c":"data=raw_data.copy()","ea5fc738":"#Change Yes=1 , and No = 0\ndata['Attendance']=data['Attendance'].map({'Yes':1,'No':0})\ndata","d8018321":"data.describe()","3843a20a":"y=data['GPA']\nx1=data[['SAT','Attendance']]","f7c6ea71":"x=sm.add_constant(x1)\nresults=sm.OLS(y,x).fit()\nresults.summary()","eccf503b":"plt.scatter(data['SAT'],y,c=data['Attendance'],cmap='RdYlGn_r')\nyHat_no=0.6439+0.0014*data['SAT']\nyHat_yes=0.8665+0.0014*data['SAT']\nfig=plt.plot(data['SAT'],yHat_no,lw=2,c='#006837')\nfig=plt.plot(data['SAT'],yHat_yes,lw=2,c='#a50026')\n\nplt.xlabel('SAT',fontsize=20)\nplt.ylabel('GPA',fontsize=20)\nplt.show()","2f0918de":"x\n# Const actually added with the add_constant() method we use prior to fitting the model , it is simulation of x0","877fb460":"new_data=pd.DataFrame({'const':1,'SAT':[1700,1670],'Attendance':[0,1]})\nnew_data=new_data[['const','SAT','Attendance']]\nnew_data","55ac4610":"#Rename the index 0:Bob and 1:Alice\nnew_data.rename(index={0:'Bob',1:'Alice'})","7775089e":"#The appropriate method that allow us to predict the values is the fitted regression dot predict\n#The fitted regressions for us is variable results , results= sm.OLS(y,x).fit()\npredictions = results.predict(new_data)\npredictions","62c3e535":"#I will transform into a data frame and join it with the first one\npredictionsDataFrame=pd.DataFrame({'Predictions':predictions})\njoined=new_data.join(predictionsDataFrame)\njoined.rename(index={0:'Bob',1:'Alice'})","ab81ab5d":"**The Red one is the one who attandance , and vice versa**","fe62aab9":"**Plotting the Simple Regression Line**","abd91eb5":"We can see that , the predicted GPA at graduation for Bob is 3.02 , and for Alice is 3.20 ","b1cbc3e5":"### Plotting The Data","f9788857":"Because GPA cannot be predicted solely by student as a score , but also by their HighSchool GPA , Income , Gender etc .  **If we want a good models , we need Multiple Regression , in order to address the higher complexity of problems **\n\nI will use the Attendance variable for mutiple regression <br>\nNote : If attendance is more than 75% is 1 , and if below 75% is 0\n","ef37b09c":" ## Regression itself","d199e9b9":"### **Define dependent and the independent variables**","d1fca168":"### **Load Data**","63fb6081":"## **Look at the R-Squared , Adj.R-Squared , and try to compare from the Simple Linear Regression , it explain that the Attendance variable can be such powerful variable for Mutiple Regression**","6b393f8d":"## **Importing **","7a1bbd26":"# **Mutiple Linear Regression (y= \u03b20+ \u03b21x1+\u03b22x2+...+\u03b2kxk + \u0190) ** ","04e5701a":"GPA = 0.6439+0.0014*SAT + 0.2226*Attendance <br>\n\nIf did not attend (Attendance = 0) <br>\nGPA=0.6439+0.0014*SAT+0.2226*0<br>\nGPA=0.6439+0.0014*SAT\n\nIf Attends (Attendance = 1) <br>\nGPA=0.6439+0.0014*SAT+0.2226*1<br>\nGPA=0.8665+0.0014*SAT\n\n","7401bce7":"## **Mutiple Regression**","264a390d":"### **How to read the OLS Regression Above**\n\nStat Models has 3 main tables :\n* A Model Summary\n* Coefficients table\n* Some Adittional Test\n\n**Coefficient Table** <br>\n0.2750 means b0 <br>\n0.0017 means b1\n\nyHat=b0+b1x1 <br>\nyHat = 0.2750+0.0017*x1 <br>\nGPA = 0.2750+0.0017*SAT <br>\n**std err ** shows the accuracy of prediction for each variable (Lower means better) <br>\nSAT score is a significant variable when predicting GPA because SAT has 0.000 in **P> | t |**\n\n**A Model Summary**\n* Dep. Variable means variable that we want to predict , which is **GPA** \n* Model : OLS (Ordinary Least Square) , OLS is the common method to estimate the linear regression , **this method will find the line which minimises the Sum of the Squared Error** ( Lower Error = better explanatory power ) \n\nThere is other method like : \n* Generalized least squares\n* Maximum likelihood estimation\n* Bayesian Regression\n* Gaussian process regression\n\nIn this tutorial im using OLS because it quite simple and powerful enough \n\n**R-Squared** is measured how powerful the regression \n* R-Squared = Variability explained by the regression \/ Total variability of the dataset\n* R-Squared using values ranging from 0 to 1 , if R-Squared = 0 means your regression explains NONE of the variability , if 1 means regression explains the ENTIRE variability\n\nExample : Our R-Squared has 0.406 , in other words SAT scores explained 41% of variability of college grades , but since it is far away from 90% we may conclude that we are missing some important information . Other determinants must be consider such as gender,income or maybe marital status.\n\n**Conclusion : ** R- Squared measure goodness of fit , the more factore you include in regression the higher the R Squared \n\n**F-statistic : **  is important for regression as it give us some important insights (Higher mean Better), **the lower the F-Statistic the closer to an non-significant model** . You can use this tool to compare with other models . \n\n\n\n\n\n\n\n","18d5eee7":"### Explore The Data","474cf436":"We create new data that predict 2 students :\n* Bob , who got 1700 on SAT and did **NOT attend**\n* Alice , who got 1670 on SAT and **attended**","942a380c":"# **Simple Linear Regression (y= \u03b20+ \u03b21x1+\u0190) **","0c5ef0fb":"## **Create first regression**","68416fcc":"## **Make Predictions based on the regression we already create**","9ef9691e":"**Why would i predict GPA with SAT** ? \n* The SAT is considered one of the best estimators of intellectual capacity and capability\n*  Almost all collage (ex: USA) are using the SAT as a proxy for admission\n* The SAT stood the test of time\n\n**SAT** = Critical reading + Mathematics + Writing <br>\n**GPA** = Grade Point Average\n\nCreating a linear regression which predicts GPA based on the SAT score","b7d0d784":"## **Load Data**"}}