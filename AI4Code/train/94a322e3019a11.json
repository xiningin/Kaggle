{"cell_type":{"bf22449d":"code","6d6472d8":"code","e7e09435":"code","15fd4f20":"code","267c6fcf":"code","6e168676":"code","6a425f07":"code","9d5e12d1":"code","8d2baec0":"code","72192db6":"code","f508621d":"code","442d167b":"code","182fdaec":"code","ea2a6578":"code","e83f83fc":"code","3f32331f":"code","d04e40b3":"code","c9d11807":"code","d90010de":"code","a8f8372a":"code","36108a8e":"code","48b0b205":"code","36703b69":"code","7d18cd83":"markdown"},"source":{"bf22449d":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns","6d6472d8":"df=pd.read_csv(\"..\/input\/WA_Fn-UseC_-Telco-Customer-Churn.csv\")","e7e09435":"df.head(15)","15fd4f20":"df.dtypes","267c6fcf":"df.drop(\"customerID\",axis=1,inplace=True)","6e168676":"df.isnull().sum()\n","6a425f07":"df.Dependents=df.Dependents.replace({\"No\":0, \"Yes\":1})\ndf.Partner=df.Partner.replace({\"No\":0, \"Yes\":1})\ndf.PhoneService=df.PhoneService.replace({\"No\":0, \"Yes\":1})\ndf.OnlineSecurity=df.OnlineSecurity.replace({\"No\":0,\"No internet service\":0, \"Yes\":1})\ndf.OnlineBackup=df.OnlineBackup.replace({\"No\":0,\"No internet service\":0, \"Yes\":1})\ndf.DeviceProtection=df.DeviceProtection.replace({\"No\":0,\"No internet service\":0, \"Yes\":1})\ndf.StreamingTV=df.StreamingTV.replace({\"No\":0,\"No internet service\":0,\"Yes\":1})\ndf.StreamingMovies=df.StreamingMovies.replace({\"No\":0,\"No internet service\":0, \"Yes\":1})\ndf.PaperlessBilling=df.PaperlessBilling.replace({\"No\":0, \"Yes\":1})\ndf.TechSupport=df.TechSupport.replace({\"No\":0,\"No internet service\":0, \"Yes\":1})\ndf.Churn=df.Churn.replace({\"No\":0, \"Yes\":1})\ndf.MultipleLines=df.MultipleLines.replace({\"No\":0,\"No phone service\":0,\"Yes\":1})","9d5e12d1":"df.head(5)","8d2baec0":"sns.countplot(\"MultipleLines\",data=df)\nplt.show()\n","72192db6":"sns.countplot(\"Churn\",data=df,hue=\"gender\")\nplt.show()\n","f508621d":"a=list(df[\"Contract\"].value_counts().values)\ndef make_autopct(a):\n    def my_autopct(pct):\n        total = sum(a)\n        val = int(round(pct*total\/100.0))\n        return '{p:.2f}%  ({v:d})'.format(p=pct,v=val)\n    return my_autopct\n\nplt.pie(a,labels=[\"Monthly\",\"Two Year\",\"One Year\"],explode=(0.001,0.03,0.08), autopct=make_autopct(a))\nfig = plt.gcf()\nfig.set_size_inches(8,8)\nplt.show()","442d167b":"df1=df[(df[\"InternetService\"]==\"DSL\") | (df[\"InternetService\"]== \"Fiber optic\")]\nsns.countplot(\"InternetService\",data=df1,hue=\"StreamingMovies\")\nfig = plt.gcf()\nfig.set_size_inches(10,5)\nplt.show()\n","182fdaec":"group_size=list(df.InternetService.value_counts().values)\ngroup_names=list(df.InternetService.value_counts().index)\na=df.groupby([df.InternetService,df.Contract],as_index=False).count()\nddf = pd.DataFrame({\"service\":a.InternetService,\"contract\":a.Contract,\"value\":a.gender})\nsubgroup_size=list(list(ddf.value.values))\nsubgroup_names=list(ddf.contract.values)\n\ntemp=group_size[0]\ngroup_size[0]=group_size[1]\ngroup_size[1]=temp\ntemp1=group_names[0]\ngroup_names[0]=group_names[1]\ngroup_names[1]=temp1\n\nfig, ax = plt.subplots()\nax.axis('equal')\nmypie, _ = ax.pie(group_size, radius=1.3, labels=group_names,startangle=90)\nplt.setp( mypie, width=0.5, edgecolor='white')\nfig.set_size_inches(8,8)\nplt.title('Distribution of type of service & type of contract')\nmypie2, _ = ax.pie(subgroup_size, radius=1.3-0.3, labels=subgroup_names, labeldistance=0.3,startangle=90,autopct='%.1f%%')\nplt.setp( mypie2, width=0.4, edgecolor='white')\n\nplt.margins(0,0)\n\nplt.show()\n","ea2a6578":"a=df.groupby([df.InternetService,df.Contract],as_index=False).count()\ndsl=list(ddf[ddf.service==\"DSL\"].value)\nfib=list(ddf[ddf.service==\"Fiber optic\"].value)\n\ndef make_autopct(dsl):\n    def my_autopct(pct):\n        total = sum(dsl)\n        val = int(round(pct*total\/100.0))\n        return '{p:.2f}%  ({v:d})'.format(p=pct,v=val)\n    return my_autopct\n\n\nplt.pie(dsl,labels=[\"Monthly\",\"One Year\",\"Two Year\"],autopct=make_autopct(dsl),explode=(0.02,0.02,0.02),)\nplt.title(\"Distribution of DSL\")\nfig = plt.gcf()\nfig.set_size_inches(5,5)\nplt.show()\n\nplt.pie(fib,labels=[\"Monthly\",\"One Year\",\"Two Year\"],autopct=make_autopct(fib),explode=(0.02,0.02,0.02),)\nplt.title(\"Distribution of Fiber optic\")\nfig = plt.gcf()\nfig.set_size_inches(5,5)\nplt.show()\n","e83f83fc":"sns.catplot(x=\"InternetService\", y=\"tenure\", hue=\"Contract\", kind=\"bar\", data=df)\nplt.show()","3f32331f":"sns.distplot(df[\"tenure\"],hist=True,vertical=True)","d04e40b3":"sns.boxplot(x=\"Churn\", y=\"tenure\", data=df)\nplt.show()","c9d11807":"d=pd.get_dummies(df.InternetService)\ndf=pd.concat([df, d], axis=1)\ne=pd.get_dummies(df.Contract)\ndf=pd.concat([df, e], axis=1)\ndf=df.drop([\"InternetService\",\"Contract\",\"PaymentMethod\",\"TotalCharges\",\"MonthlyCharges\"],axis=1)\ndf.gender=df.gender.replace({\"Female\":0, \"Male\":1})","d90010de":"X=df.loc[:,df.columns!=\"Churn\"].values\ny=df.loc[:,df.columns==\"Churn\"].values.flatten()\n","a8f8372a":"from sklearn.model_selection import train_test_split\nX_train , X_test, y_train, y_test=train_test_split(X,y,test_size=0.2,random_state=42)","36108a8e":"#Model 1 - Logistic Regression\nfrom sklearn.linear_model import LogisticRegression\nmodel = LogisticRegression()\nmodel.fit(X_train, y_train)\ny_pred=model.predict(X_test)\nfrom sklearn.metrics import accuracy_score\nprint(accuracy_score(y_test,y_pred)*100)","48b0b205":"#Model 2 - Random Forest Classifier\nfrom sklearn.ensemble import RandomForestClassifier\nmodelrf = RandomForestClassifier(n_estimators=2,oob_score=True,min_samples_leaf = 40)\nmodelrf.fit(X_train,y_train)\ny_predrf=modelrf.predict(X_test)\nprint(accuracy_score(y_test,y_predrf)*100)","36703b69":"#Model 3 - Support Vector Machine\nfrom sklearn import svm\nmodelsvm=svm.SVC(kernel=\"linear\")\nmodelsvm.fit(X_train,y_train)\ny_predsvm=modelsvm.predict(X_test)\nprint(accuracy_score(y_test,y_predsvm)*100)","7d18cd83":"**PREDICTION**"}}