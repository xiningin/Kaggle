{"cell_type":{"86061161":"code","ebb109c0":"code","92229555":"code","a31f0e74":"code","44d72fa3":"code","fc21855c":"code","5aa564ac":"code","92aff449":"code","2a11b788":"code","30c995f8":"code","9e63fe6a":"code","db93c395":"code","9759c7c5":"code","99751ca1":"code","5739bc1d":"code","563baf4e":"code","920a761b":"code","2ed88698":"code","fad321bf":"code","a35d7259":"code","75f3560d":"code","164b2291":"code","a0a76568":"code","9d831e45":"code","0f07c63d":"code","2d80118d":"code","e2ee03d6":"markdown","0b549326":"markdown","3fcbaf71":"markdown","500c1f18":"markdown","b6755f1a":"markdown","101c2656":"markdown","7808ad7a":"markdown","b6ba1d13":"markdown","eea285bf":"markdown","1fc93dcf":"markdown","88fce5a2":"markdown","f4f3d9eb":"markdown","590c9c60":"markdown","5930a822":"markdown","a19aafee":"markdown","061428f3":"markdown","a6ea1c9c":"markdown","06b8419d":"markdown","c1b5d908":"markdown","56c9df67":"markdown","8415d95a":"markdown","179ea266":"markdown","f4a215be":"markdown","b5b9988e":"markdown","58a1fb24":"markdown","787d7930":"markdown","368b790a":"markdown","7b597138":"markdown","f17884e0":"markdown","7ad8e90e":"markdown"},"source":{"86061161":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport plotly.express as px\nimport plotly.graph_objects as go","ebb109c0":"customer_df = pd.read_csv(\"\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")\ncustomer_df.head()","92229555":"# shape of the dataset\nprint(customer_df.shape)","a31f0e74":"# my personal reusable function for detecting missing data\ndef missing_value_describe(data):\n    # check missing values in the data\n    missing_value_stats = (data.isnull().sum() \/ len(data)*100)\n    missing_value_col_count = sum(missing_value_stats > 0)\n    missing_value_stats = missing_value_stats.sort_values(ascending=False)[:missing_value_col_count]\n    print(\"Number of columns with missing values:\", missing_value_col_count)\n    if missing_value_col_count != 0:\n        # print out column names with missing value percentage\n        print(\"\\nMissing percentage (desceding):\")\n        print(missing_value_stats)\n    else:\n        print(\"No missing data!!!\")\nmissing_value_describe(customer_df)","44d72fa3":"px.histogram(customer_df, y=\"Spending Score (1-100)\", \n             marginal=\"rug\", title=\"Spending score distribution\")","fc21855c":"customer_df.Gender.value_counts()","5aa564ac":"px.box(customer_df, x=\"Spending Score (1-100)\", y=\"Gender\",\n          color=\"Gender\", points='all',\n          title=\"Distribution of spending score by gender\")","92aff449":"# male customer spending score statistic summary\ncustomer_df.query(\"Gender == 'Male'\")[\"Spending Score (1-100)\"].describe()","2a11b788":"# female customer spending score statistic summary\ncustomer_df.query(\"Gender == 'Female'\")[\"Spending Score (1-100)\"].describe()","30c995f8":"px.histogram(customer_df, x=\"Age\", title=\"Customer age distribution\", nbins=10)","9e63fe6a":"customer_df.Age.describe()","db93c395":"# create a new column of age group with increment of 10 units\ndef bin_age(age):\n    if age < 20: return \"10-19\"\n    elif age < 30: return \"20-29\"\n    elif age < 40: return \"30-39\"\n    elif age < 50: return \"40-49\"\n    elif age < 60: return \"50-49\"\n    elif age < 70: return \"60-69\"\n    else: return \"70-79\"\n\ncustomer_df[\"age_group\"] = customer_df.Age.apply(bin_age)","9759c7c5":"customer_df[\"age_group\"].unique()","99751ca1":"age_group_order = ['10-19', '20-29', '30-39', '40-49', '50-49', '60-69', '70-79']\npx.box(customer_df, y=\"Spending Score (1-100)\", x=\"age_group\",\n       title=\"Distribution of spending score by age group and gender group\",\n       color=\"Gender\",\n       category_orders={\"age_group\": age_group_order},\n       facet_row=\"Gender\")","5739bc1d":"age_group_order = ['10-19', '20-29', '30-39', '40-49', '50-49', '60-69', '70-79']\npx.box(customer_df, y=\"Annual Income (k$)\", x=\"age_group\",\n       title=\"Distribution of annual income by age group and gender group\",\n       color=\"Gender\",\n       category_orders={\"age_group\": age_group_order},\n       facet_row=\"Gender\")","563baf4e":"customer_df.drop([\"CustomerID\"], axis=1).corr()","920a761b":"px.scatter(customer_df, \n       x=\"Annual Income (k$)\", y=\"Spending Score (1-100)\", \n       color=\"Gender\",\n       hover_name=\"Spending Score (1-100)\",\n       title=\"Non-linear relationship between the annual income and spending score\")","2ed88698":"px.scatter(customer_df, \n       x=\"Age\", y=\"Spending Score (1-100)\", \n       color=\"Gender\",\n       hover_name=\"Spending Score (1-100)\",\n       title=\"Non-linear relationship between the age and spending score\")","fad321bf":"from sklearn.cluster import KMeans\nfrom yellowbrick.cluster import KElbowVisualizer\n\nX = customer_df[[\"Age\", \"Annual Income (k$)\", \"Spending Score (1-100)\"]]\n\nmodel = KMeans()\nvisualizer = KElbowVisualizer(model, k=(1, 10))\n\nvisualizer.fit(X)  \nvisualizer.show();","a35d7259":"# fit kmean model with k=4\nkmeans = KMeans(n_clusters=4, random_state=2)\nkmeans.fit(X)\nX[\"cluster\"] = kmeans.predict(X)\nX.head()","75f3560d":"# cluster centers\nkmeans.cluster_centers_","164b2291":"px.scatter_3d(X, x=\"Annual Income (k$)\", y=\"Spending Score (1-100)\", z=\"Age\",\n                    color = 'cluster', title=\"Supermarket member segmentation\")","a0a76568":"px.box(X, x=\"cluster\", y=\"Annual Income (k$)\",points='all', color=\"cluster\",\n          title=\"Distribution of annual income by cluster\")","9d831e45":"px.box(X, x=\"cluster\", y=\"Age\",points='all', color=\"cluster\",\n          title=\"Distribution of customer age by cluster\")","0f07c63d":"px.box(X, x=\"cluster\", y=\"Spending Score (1-100)\",points='all', color=\"cluster\",\n          title=\"Distribution of spending score by cluster\")","2d80118d":"# number of customers in each cluster\npd.DataFrame(X.value_counts(\"cluster\").reset_index(drop=True), columns=[\"customer count\"])","e2ee03d6":"#### Is there any missing data?","0b549326":"## 1. Read CSV with Pandas","3fcbaf71":"### 2.2 What are the spending score distributions of different age groups?","500c1f18":"![image.png](attachment:50a2d3bc-3207-48ca-a275-f8a5e142beff.png)\n### This exploratory data analysis notebook will analyze the supermarket customer background and spending data and create customer segmentation using K-mean clustering.","b6755f1a":"### Interpretation of the segmentation:\n\nFrom the above K-mean clustering model results with the optimal k selected using elbow method, we can observe 4 interesting clusters colored by orange, blue, yellow, and purple.\n\n\n\nAnalyzing the clusters, we can see the what each cluster represent:\n1. Cluster 0: customer group with median spendings core of 16.5, median annual income of 80K, and median age of 41.5.\n2. Cluster 1: customer group with median spendings core of 74, median annual income of 28K, and median age of 23.\n3. Cluster 2: customer group with median spendings core of 47, median annual income of 54K, and median age of 48.\n4. Cluster 3: customer group with median spendings core of 83, median annual income of 79K, and median age of 32.\n\nIn other words regarding to the segmentation visualizations:\n1. Cluster 0 customers are in their 40s, having high income, but spend frequently with low spending score.\n2. Cluster 1 customers are in their 20s and don't have a lot of income and spend very frequently in the supermarket.\n3. Cluster 2 customers are older custoemrs in their late 40 to 50s, having lower income than cluster 0 and spend less frequently.\n4. Cluster 3 customers are in their 30s, having high come and spends most frequently in the supermarket.","101c2656":"### 3. K-mean modeling for supermarket member segmentation","7808ad7a":"### Observation:\nThe distribution of the customer age data is relatively normal centered around the age range of 30-39 with total count of 61 customers.","b6ba1d13":"### 2.3 What are the annual income distributions of different age groups?","eea285bf":"### If you like this one, check out other notebooks I have written:\n\n* [Historic NBA Drafting, Game, and Player Analysis](https:\/\/www.kaggle.com\/agilesifaka\/historic-nba-drafting-game-and-player-analysis)\n* [Analysis of Netflix Content Information](https:\/\/www.kaggle.com\/agilesifaka\/analysis-of-netflix-content-information)\n* [Exploratory Analysis of Vancouver Crime Data](https:\/\/www.kaggle.com\/agilesifaka\/exploratory-analysis-of-vancouver-crime-data)","1fc93dcf":"### Thank you for reading all the way to here!\n### Please give me an upvote if you enjoy reading this data analysis and modeling interpretation.","88fce5a2":"### Dataset description:\n\nCurrently, we have 200 entires of the supermarket customer demographic data. Here is a quick overview of the dataset columns:\n\n1. CustomerID: the customer ID indexed by the membership system\n2. Gender: the gender of the supermarket customer\n3. Age: the age of the supermarket member\n4. Annual Income (`k$`): the annual income of the customers with a unit of 1000 dollars\n5. Spending Score (1-100): the spending score from 1-100. 100 means the customer is a active shopper","f4f3d9eb":"#### Great! We don't have missing data.","590c9c60":"Where\n\n$C_1, C_2, C_3$ are centroids\n$P_i$s are points within that cluster\n$distance$ is the usual Euclidean distance.\n\nThe inertia decreases as K increases. We can't just pick k that minimize the inertia because inertia can be minimize to 0 as k going to the size of the dataset.\n\n> The intuition is that increasing the number of clusters will naturally improve the fit (explain more of the variation), since there are more parameters (more clusters) to use, but that at some point this is over-fitting, and the elbow reflects this.","5930a822":"### 2.1 What's the spending score distribution of the male and the female customers?","a19aafee":"## 2. Exploratory data analysis of the member data","061428f3":"### Observation:\nFrom the summary above, we can see the Pearson coefficients between different variables. We don't see strong linear correlation between the age, income, and the spending score. ","a6ea1c9c":"### Let me break it down to 2D plots for further analysis.","06b8419d":"### Observation:\nFrom the spending score distribution histogram binned by increment of 10, we can see there are 3 spikes around spending score of 10-19, 40-49, and 70-79 with max count of 39 customers fall in to the spending score range of 40-49. The data is centered around the spending score range of 40-49.","c1b5d908":"### Observation:\nFrom the above plot, we could argue that 4 clusters (the point of inflection on the curve) are enough.","56c9df67":"### 2.0 What's the distribution of the spending score?","8415d95a":"### Observation:\u00b6\nFrom the above visualizations, we see non-linear relationship between the age, income, and the spending score. We can't just fit a linear model to model the spending score. However, we can use unsupervised clustering algorithm like K-mean to cluster the customer into different segments.","179ea266":"![image.png](attachment:06b7619f-d0e9-47e0-801e-28fb5a3982b9.png)","f4a215be":"![image.png](attachment:e17956bb-9095-4265-945d-b4e5eb8bdf9d.png)","b5b9988e":"### Observation:\nFrom the above box plots, we can observe that the highest median annual income for male customers is 78K for age group of 30-39 and the highest medina annual income for female customers is 74K for age group of 30-39. The age group of 30-39 is also the age group with the highest spending score from the box plots in the previous section.","58a1fb24":"### Observations:\n\nFrom the cluster customer count, we can observe that we have higher cluster count of 95 in the cluster 0 segmentation which is people who are in their 40s with the high income people and spend less frequently.\n\n### Suggestions:\nCreate marketing campaign targeting cluster 0 to increase the spending score to convert high income less frequent shoppers to more frequent shoppers.","787d7930":"### 2.4 What are the correlations between the spending score, age, and income?","368b790a":"### Observation:\nFrom the above box plots, we can observe that the distributions of the two gender groups share similar pattern for the two age groups of 20-29 and 30-39. The median spending scores of 30-39 are the highest comparing to other age groups.","7b597138":"#### Determining the k of k-mean for clustering:\n\nI will use [elbow method](https:\/\/tinyurl.com\/29a9m8yv) here: looks at the sum of intra-cluster distances, which is also referred to as inertia. Intra-cluster distance is the distance between each cluster center and the points within the cluster.","f17884e0":"### Observation:\nFrom the above visualizations, we can observe that there is no clear distinction between the medians and the top quantiles of the customer spending scores compared for the female and male customers. The 1st quantile of the male spending score is 10.5 unit lower than the 1st quantile of the female spending score. The max (99) of the spending scores for female is higher than the max (97) of the male spending scores. The min (5) of the spending scores for female is higher than the min (1) of the male spending scores. ","7ad8e90e":"#### Visualize the customer segmentations"}}