{"cell_type":{"c77c2d28":"code","7c659a95":"code","79b8ab4b":"code","70aacb91":"code","014571b2":"code","07f08757":"code","fc5e4397":"code","b1e88afb":"code","099c6185":"code","a8e86bc8":"code","a528ad2e":"code","375c6eaf":"code","9f6e8969":"code","ed4eb86a":"code","0a0680dc":"markdown","82d1e13d":"markdown","28638303":"markdown","e7a56ab7":"markdown","026d846e":"markdown","d76eb1df":"markdown","beecf5b9":"markdown","3219da40":"markdown"},"source":{"c77c2d28":"import numpy as np\nimport pandas as pd\nfrom pandas import DataFrame, Series\nimport missingno as mn\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nfrom sklearn.model_selection import train_test_split","7c659a95":"data = pd.read_csv('\/kaggle\/input\/insurance\/insurance.csv')\ndata.head(10)","79b8ab4b":"mn.matrix(data)\nplt.show()","70aacb91":"data['smoker'] = np.where(data['smoker'] == \"yes\",1,0)\ndata['sex'] = np.where(data['sex'] == \"female\", 1, 0)\ndata","014571b2":"mpl.rcParams['figure.dpi'] = 300\nplt.rcParams.update({'font.size': 5})\nnp.random.seed(19680801)\ncolors = np.random.rand(len(data))\nplt.figure(figsize=(5, 4))\nplt.subplot(3, 2, 1)\nplt.scatter(data['age'],data['charges'],s=5,c=colors,alpha=0.5)\nplt.xlabel('Age')\nplt.subplot(3, 2, 2)\nplt.scatter(data['sex'],data['charges'],s=5,c=colors,alpha=0.5)\nplt.xlabel('sex(1 is female)')\nplt.subplot(3, 2, 3)\nplt.scatter(data['bmi'],data['charges'],s=5,c=colors,alpha=0.5)\nplt.xlabel('BMI')\nplt.subplot(3, 2, 4)\nplt.scatter(data['children'],data['charges'],s=5,c=colors,alpha=0.5)\nplt.xlabel('No of children')\nplt.subplot(3, 2, 5)\nplt.scatter(data['smoker'],data['charges'],s=5,c=colors,alpha=0.5)\nplt.xlabel('smoker?')\nplt.tight_layout()\nplt.show()","07f08757":"X = np.array(data.iloc[:, :5])\ny = np.array(data['charges'])\nXn = np.ones((X.shape[0],X.shape[1]+1))\nXn[:,1:] = X\nX = Xn\ntheta = np.zeros((X.shape[1],1))\nalpha = 0.01","fc5e4397":"mu = np.mean(X,axis= 0)\nsigma = np.std(X, axis = 0)\nX[:,1] = (X[:,1]-mu[1])\/sigma[1]\nX[:,3] = (X[:,3]-mu[3])\/sigma[3]","b1e88afb":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)\nm = X_train.shape[0]\ny_train = y_train.reshape((y_train.shape[0],1))\ny_test = y_test.reshape((y_test.shape[0],1))","099c6185":"J_values = np.zeros(3000)\nfor i in range(3000):\n    J_values[i] = (np.sum((X_train.dot(theta)-y_train)**2))\/(2*m)\n    theta = theta - (alpha\/m)*((X_train.T).dot((X_train.dot(theta)-y_train)))\nplt.plot(range(3000),J_values)\nplt.xlabel('iteration')\nplt.ylabel('Cost function')\nplt.show()","a8e86bc8":"y_predicted = X_test.dot(theta)\nrmse = np.sqrt((np.sum((y_predicted-y_test)**2))\/y_predicted.shape[0])\nprint(theta)\nrmse","a528ad2e":"for i in range(20):\n    print(f\"{y_predicted[i]} {y_test[i]}\")","375c6eaf":"from sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_squared_error, r2_score","9f6e8969":"regr = LinearRegression()\nregr.fit(X_train,y_train)\ny_predicted = regr.predict(X_test)\nprint(np.sqrt(mean_squared_error(y_test, y_predicted)))\nprint(regr.coef_)","ed4eb86a":"for i in range(20):\n    print(f\"{y_predicted[i]} {y_test[i]}\")","0a0680dc":"## Converting sex data and smoker data to binary","82d1e13d":"## Dividing in test and train datasets","28638303":"# Predicting Medical insurance\n[Dataset](https:\/\/www.kaggle.com\/mirichoi0218\/insurance)\n\nFeatures used:\n1. Age\n2. Sex(converted to binary)\n3. Body Mass Index\n4. No of children\n5. Does the person smoke?\n\nModel : `Multivariate linear regression`","e7a56ab7":"## Plotting each feature wrt label","026d846e":"## Manual Gradient Decent","d76eb1df":"## Regression using sklearn's inbuilt method","beecf5b9":"## feature normalization so that gradient decent is faster","3219da40":"## Checking if we need to clean data"}}