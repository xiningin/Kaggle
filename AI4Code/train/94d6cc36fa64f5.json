{"cell_type":{"8407a9ef":"code","a3c9093b":"code","7770a935":"code","6ff3f732":"code","1e7dcbe1":"code","968f6106":"code","b50faa04":"code","b6429636":"code","5e50b7ae":"code","3d1777f8":"code","683bc139":"code","56991779":"code","4369c05a":"code","1c1941ef":"code","7bb7566d":"markdown","51822614":"markdown","1db49430":"markdown","44781e36":"markdown","1de4976a":"markdown","f177b3d9":"markdown","87657db8":"markdown","3a5e4618":"markdown","774a1082":"markdown","43a71dd6":"markdown","1112b79d":"markdown","862a9c24":"markdown","c2681206":"markdown","b42f5dc9":"markdown","e36dba92":"markdown","f3a8f1c0":"markdown","3ef9588d":"markdown","b4050e75":"markdown","dfb3a552":"markdown","4c1cf028":"markdown","ea991059":"markdown","935775bc":"markdown","72333836":"markdown","9b5db681":"markdown","1c2516e6":"markdown","68c3e6cb":"markdown","1e8aa177":"markdown","a714febe":"markdown","881becca":"markdown","542680ee":"markdown","c0e957ac":"markdown","816877f9":"markdown","c1b70276":"markdown","5ca4eb3e":"markdown"},"source":{"8407a9ef":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport math\nimport statistics\nimport scipy.stats","a3c9093b":"players2016_17=pd.read_csv(\"..\/input\/players2016-21\/players2016-17.csv\")\nplayers2017_18=pd.read_csv(\"..\/input\/players2016-21\/players2017-18.csv\")\nplayers2018_19=pd.read_csv(\"..\/input\/players2016-21\/players2018-19.csv\")\nplayers2019_20=pd.read_csv(\"..\/input\/players2016-21\/players2019-20.csv\")\nplayers2020_21=pd.read_csv(\"..\/input\/players2016-21\/players2020-21.csv\")\n\nplayers2016_17['season']='2016_17'\nplayers2017_18['season']='2017_18'\nplayers2018_19['season']='2018_19'\nplayers2019_20['season']='2019_20'\nplayers2020_21['season']='2020_21'\n\nplayers=pd.concat([players2016_17,players2017_18,players2018_19,players2019_20,players2020_21])\n\nother=['web_name','team']\nplayers=players.reindex(columns=(['web_name']+['team']+list([a for a in players.columns if a not in other])))\n","7770a935":"players.head(5)","6ff3f732":"top_goals=players.groupby(\"web_name\")[\"goals_scored\"].sum().sort_values(ascending=False).head(10).reset_index()\nsns.set()\nplt.figure(figsize=(12,6))\nsns.barplot(x=\"web_name\",y=\"goals_scored\",data=top_goals)\nplt.xlabel(\"Player\")\nplt.ylabel(\"Total Goals scored\")\nplt.title(\"Top 10 goalscorers\")\nplt.show()","1e7dcbe1":"totalpts=players.groupby(\"web_name\")[\"total_points\"].sum().sort_values(ascending=False).head(10).reset_index()\nsns.set()\nsns.set_palette('colorblind')\nplt.figure(figsize=(12,6))\nsns.pointplot(x=\"web_name\",y=\"total_points\",hue=\"web_name\",data=totalpts)\nplt.xlabel(\"Player\")\nplt.ylabel(\"Total Goals scored\")\nplt.title(\"Top 10 point-scorers\")\nplt.legend(\"\")\nplt.ylim(600,1100)\nplt.show()","968f6106":"cont=players.groupby(['web_name']).agg({'goals_scored':'sum','assists':'sum'})\ncont[\"total\"]=cont[\"goals_scored\"]+cont[\"assists\"]\ncontributions=cont.sort_values(\"total\",ascending=False).head(15).drop(\"total\",axis=1)\ncontributions.plot(kind=\"bar\",figsize=(15,9),stacked=True,color=['steelblue','green'])\nplt.xlabel(\"Player\")\nplt.ylabel(\"Goal Contributions\")\nplt.legend()\nplt.title(\"Players with maximum goal contributions\")\nplt.show()","b50faa04":"team_avg=players.groupby([\"team\",\"web_name\"]).aggregate({\"total_points\":\"sum\",\"season\":\"nunique\"}).reset_index()\nteam_avg['avg_points']=team_avg['total_points']\/team_avg['season']\nteam_avgg=team_avg.groupby(\"team\")['avg_points'].agg(average=\"mean\").reset_index().sort_values(\"average\",ascending=False).reset_index(drop=True)\n\nplt.figure(figsize=(12,6))\nsns.set_palette('muted')\nsns.barplot(x=\"team\",y=\"average\",data=team_avgg)\nplt.legend(\"\")\nplt.xlabel(\"Team Name\")\nplt.ylabel(\"Average Points\")\nplt.title(\"Average Points per team\")\nplt.ylim(25,60)\nplt.show()","b6429636":"pts_game=players.groupby(['web_name']).aggregate({'total_points':'sum','minutes':'sum'}).reset_index()\npts_game['points_per_game']=pts_game['total_points']\/pts_game['minutes']*90\npts_game['points_per_game']=pts_game['points_per_game'].fillna(0)\npts_game=pts_game[pts_game.minutes>=3150]\npts_per_game=pts_game.nlargest(20,'points_per_game')\nplt.figure(figsize=(12,6))\nsns.set_palette('bright')\nsns.scatterplot(x=\"web_name\",y=\"points_per_game\",size=\"minutes\",data=pts_per_game)\nplt.xticks(rotation='vertical')\nplt.legend(\"\")\nplt.xlabel(\"Player\")\nplt.ylabel(\"Average Points per Game\")\nplt.title(\"Players with highest points per game(more than 3150 minutes)\")\nplt.ylim(5,8)\nplt.show()","5e50b7ae":"pts_season=players.groupby(\"web_name\").aggregate({\"total_points\":\"mean\",\"season\":\"count\",\"minutes\":\"sum\"}).reset_index()\nmax_pts_season=pts_season[pts_season.minutes>=3150].nlargest(20,\"total_points\")\nplt.figure(figsize=(12,6))\nsns.scatterplot(x=\"web_name\",y=\"total_points\",size=\"season\",data=max_pts_season,color=\"orange\")\nplt.xticks(rotation='vertical')\nplt.legend(\"\")\nplt.xlabel(\"Player\")\nplt.ylabel(\"Avg. points per season\")\nplt.title(\"Top 20 players with most avg. points per season\")\nplt.show()","3d1777f8":"top2=['Man_City','Liverpool']\nother6=['Chelsea','Man_Utd','Arsenal','Spurs']\nothergood=['Leicester','West_Ham','Everton']\nothers=['Others']\nplayers['team_cat']=np.where(players['team'].isin(top2),'Man_City\/Liverpool',np.where(players['team'].isin(other6),'Man_Utd\/Chelsea\/Arsenal\/Spurs',np.where(players['team'].isin(othergood),'Leicester\/West_Ham\/Everton','Others')))\nplt.figure(figsize=(12,6))\nplay=players[players.minutes>3000].reset_index()\nsns.kdeplot(play['total_points'][play.team_cat=='Man_City\/Liverpool'],color='red',label='Man City, Liverpool')\nsns.kdeplot(play['total_points'][play.team_cat=='Man_Utd\/Chelsea\/Arsenal\/Spurs'],color='blue',label='Rest of the top 6')\nsns.kdeplot(play['total_points'][play.team_cat=='Leicester\/West_Ham\/Everton'],color='black',label='Almost top 6')\nsns.kdeplot(play['total_points'][play.team_cat=='Others'],color='green',label='Others')\nplt.legend(loc='upper right')\nplt.xlabel('Total points in a season')\nplt.ylabel('Density')\nplt.title('Density of total points by team quality')\nplt.show()","683bc139":"plt.figure(figsize=(12,6))\nsns.kdeplot(play['now_cost'][play.team_cat=='Man_City\/Liverpool'],color='red',label='Man City, Liverpool')\nsns.kdeplot(play['now_cost'][play.team_cat=='Man_Utd\/Chelsea\/Arsenal\/Spurs'],color='blue',label='Rest of the top 6')\nsns.kdeplot(play['now_cost'][play.team_cat=='Leicester\/West_Ham\/Everton'],color='black',label='Almost top 6')\nsns.kdeplot(play['now_cost'][play.team_cat=='Others'],color='green',label='Others')\nplt.legend(loc='upper right')\nplt.xlabel('Cost of player')\nplt.ylabel('Density')\nplt.title('Player cost by team quality')\nplt.show()","56991779":"goalkeepers=play[play.element_type==1].reset_index()\ndefenders=play[play.element_type==2].reset_index()\nmidfielders=play[play.element_type==3].reset_index()\nforwards=play[play.element_type==4].reset_index()\nplt.figure(figsize=(12,6))\nsns.kdeplot(goalkeepers['total_points'],color='blue',label='Goalkeepers')\nsns.kdeplot(defenders['total_points'],color='orange',label='Defenders')\nsns.kdeplot(midfielders['total_points'],color='green',label='Midfielders')\nsns.kdeplot(forwards['total_points'],color='red',label='Forwards')\nplt.legend(loc='upper right')\nplt.xlabel('Total Points in a season')\nplt.ylabel('Density')\nplt.title('Total Points by Position')\nplt.show()\n","4369c05a":"gk=goalkeepers.groupby('web_name').agg({'clean_sheets':'sum','minutes':'sum'}).reset_index()\ngoalk=gk[gk.minutes>3150].nlargest(10,'clean_sheets')\nplt.figure(figsize=(12,6))\nsns.set_palette('colorblind')\nsns.barplot(x=\"web_name\",y=\"clean_sheets\",data=goalk)\nplt.xlabel('Player')\nplt.ylabel('Clean Sheets')\nplt.title('Most Clean Sheets')\nplt.legend(\"\")\nplt.show()","1c1941ef":"goalies=goalkeepers[goalkeepers.minutes>=3150]\nscipy.stats.pearsonr(goalies.total_points,goalies.now_cost)","7bb7566d":"## 2. Top 10 Point-Scorers ##","51822614":"As we can see, forwards have a much higher peak than any other position. However, they have VERY heavy tails, especially on the lower side, indicating that forwards largely score anywhere from 130 to 220 points on average. Midfielders have a lower peak, but have a tail that stretches well above 250. Thus, midfielders score less than forwards on average, but midfielders can definitely cross 250+ points as well as forwards can. Defenders have a peak around midfielders. This might be because of the tough nature of the Premier League, where teams not conceding isn't very common (although Manchester City and Liverpool are challenging this conception). Clean sheets give defenders more points than midfielders. Midfielders get points mostly from goals and assists, and clean sheet games provide neither. Defenders might also have more points because of full-backs usually being involved in attack as much as a midfielder. Joao Cancelo, Reece James and Trent Alexander-Arnold are providing reasonable proof of this in this season. \n","1db49430":"We first import the datasets and combine them to get a single dataset. We then specify the season and team every entry indicates. \n\n","44781e36":"This graph shows players like Giroud, Coutinho and Hazard who missed out on the cumulative rankings, mostly because they played lesser seasons than other players. The scatterplot has dots in various sizes. The bigger the dot, the more seasons the player has played. As expected, Giroud, Coutinho and Hazard have smaller dots.","1de4976a":"We now look at the cost per player. These costs are multiplied by 10, and hence show values like 80 when they should have been 8.0 otherwise. Costs per player also follow a similar pattern as total points per player, seen in the previous graph. Tier 1 players cost the most on average, but they have fat tails, indicating that the cost per player are distributed much more than other tiers. Tier 2 peaks are lower than tier 1, but have heavier tails as well, showing that quite a few tier 2 players have higher costs. This might include players like Kane, Son, etc. Tier 3 peak is just below tier 2, while most of the tier 4 players cost around 5.0.","f177b3d9":"It is said that forwards and midfielders usually score much more than defenders and goalkeepers. Let us find out if that is true. ","87657db8":"## 4. Team-Wise Average Points per Season ##","3a5e4618":"## 9. Are expensive goalkeepers worth it? ##","774a1082":"## 1. Top 10 Goalscorers ##","43a71dd6":"## 5. Top 20 Average Points per Game ##","1112b79d":"Even though we have looked at cumulative individual performances over the 5-year period, it is necessary to look at average performances so that we don't miss out on the performances of players who might have scored points very well, but missed out on cumulative rankings because of having played less seasons, and hence, less games.","862a9c24":"Hi everyone! I am a beginner at data analysis, having learned a bit about R last year. This is my first try at any form of data analysis using Python. All constructive criticism is welcome!\n\nFantasy Premier League is a very popular(and free!) fantasy football competition, revolving around the English Premier League. Every participant has to pick a team of 15 players, with a budget constraint of 100 pounds. Every participant then earns points based on the performances of the players they have chosen for the given gameweek. Players can be transferred in and out of teams at regular intervals. Every team competes with other teams to win leagues, knockout competitions, etc. \n\nBeing such a popular way by which people engage with football, there is huge data analysis potential in Fantasy Premier League(FPL).","c2681206":"## 8. Player Performance by Position ##","b42f5dc9":"This one is different than the last analysis since we take into account average by seasons here. The difference is that if a player gets injured midway through the season, he plays less minutes, but the whole season is counted. Thus, injury-prone players would be lower down the rankings here.","e36dba92":"I have used the datasets provided at https:\/\/github.com\/vaastav\/Fantasy-Premier-League\/tree\/master\/data. Many thanks to vaastav for creating such amazing datasets, and allowing them for use! The data sets contain FPL data for the last 5 seasons, i.e. from 2016-17 to 2020-21. I have largely analysed the data over the 5-season period, rather than individual seasons. My analysis is mostly based on finding out the best goalscorers and point-scorers and a comparison of players' performance based on the position they play in and the team they play for. I have also altered the original database to give actual team names for all players, having included Arsenal, Chelsea, Everton, Leicester City, Liverpool, Manchester City, Manchester United, Tottenham Hotspurs and West Ham, and classifying all other teams into the category 'Others'.\n\nIn the Premier League, there are many players who play very less games, and hence, in much of the code, I have used certain criteria to filter out the players who have played more than a certain threshold, in order to remove obscure results.\n\nSo, let's get started!\n\n","f3a8f1c0":"## 3. Top 15 Goal-Contributors ##","3ef9588d":"The regression value is 0.5336605. Python also conducted a hypothesis test alongside, with H0: regression value = 0 vs H1: regression value \u2260 0. A p-value(the second value in the result) above 0.05 would indicate that H0 can't be rejected. \nThe p-value in the result is below 0.5, suggesting that H0 can be rejected, and thus, the regression value of 0.5336605 is not equal to 0, and thus, is significant. \n\nThus, a goalkeeper with higher cost does give higher points. The exact return as compared to cost may not be very high, but there definitely is a positive relationship. However, this might also be because costly goalkeepers usually play for better teams, and thus, their chances of keeping clean sheets (which is the number 1 reason for goalkeepers scoring more points) are higher as compared to other goalkeepers. Substitute goalkeepers usually have a lower cost as well, and thus don't get to play much. Even though we have dealt with the second problem to some extent by keeping the 3150 minute criteria, there is bound to be some effect.","b4050e75":"The second graph shows that goals are not the only parameter which cause more points. Although Kane has more goals than Salah, Salah overtakes him in total points earned over the period, probably because he had much more assists than Kane. Other notable players who weren't in the top 10 goalscorers but are present here include De Bruyne, S\u00e1nchez and Azpilicueta.\n\nTo further my point, let us look at the top 15 goal contributors over the 5-year period, which will include goals and assists.","dfb3a552":"Manchester City and Liverpool have dominated the Premier League for the last 5 years (even though rival fans may disagree). I have divided the teams into 4 categories, by the basis of team-quality, based on their performance in the Premier League in the last 5 seasons. Manchester City and Liverpool form tier 1, while tier 2 consists of Chelsea, Manchester United, Arsenal and Tottenham Hotspurs, the rest of the top 6 teams. Tier 3 consists of Leicester City, West Ham and Everton, teams which are\/have been on the brink of top 6. All the teams other categorised as 'Others' are still included in the new category of 'Others', making up the 4th tier.","4c1cf028":"As we can see, teams like Man City, Chelsea and Arsenal leapfrog teams like Spurs and Liverpool when average points per season are considered, even though Spurs and Liverpool have some of the highest individual performances. This shows that Spurs might be over-reliant on individual players like Kane and Son for their points, while Liverpool might be getting most of their fantasy points from players like Salah, Man\u00e9 and Firmino. Other teams like Man City, thus, show a more equitable distribution of points over their players. Even though they also have players in the top individual performers, their fantasy points are generated without over-reliance on a few players.","ea991059":"There are a number of variables, but we won't be using a lot of them. Let us begin with our analysis!","935775bc":"Goalkeepers follow a very normal-like curve, earning a little less than 150 on average. This raises the question whether investing more into goalkeepers is even worth it. If a 4.0 goalkeeper gives the same amount of points as a 6.0 goalkeeper, wouldn't one be better off with 2 4.0 goalkeepers and save 4.0 pounds?","72333836":"We first look at individual goalkeeper performances over the seasons, and then perform a regression test to see whether higher cost goalkeepers lead to higher points.","9b5db681":"As we can see, Coutinho, Giroud and Ag\u00fcero are nowhere to be found on the list here. This is because they were highly injury-prone players, with their careers being constantly disrupted by injuries. Thus, being injury-prone, they are lower down the order there, but we can say that whenever they played, they scored a lot of points!","1c2516e6":"## 6. Top 20 Average Points per Season ##","68c3e6cb":"Now that we have imported the datasets, let us take a look at what the main dataset 'players' looks like.","1e8aa177":"We now see the regression value between goalkeeper costs and goalkeeper points.","a714febe":"As we can see, tier 1 teams definitely score more than other teams, with their peak(indicating highest density) being above 150. 4th tier teams score the lowest points on average, with their peak around a little over 100. 3rd tier teams score more than tier 4 teams, having a peak just below 150. Tier 2 teams score just a little above tier 3 teams, probably because of bad Arsenal and Spurs performances over the previous seasons. \nNote that the data I have used in the graph is filtered to include only those players having played more than 3000 minutes. This is why the peaks here suggest a different average season points by team as was suggested by the chart in the 4th graph.","881becca":"Thus, we can see that when we include both goals and assists, players like De Bruyne, Mahrez, Rashford, Zaha, etc. also come into the fray, since they have a higher proportion of assists in their goal contributions than most other players. ","542680ee":"Ederson, by far, has the most clean sheets. Given Manchester City's success, it isn't surprising, even though he didn't play in the 2016-17 season. Alisson is also not present here since he joined Liverpool only in 2018-19. ","c0e957ac":"## 7. Player Performance by team-quality ##","816877f9":"Let us now take a look at team-wise points, to ascertain which teams are more consistent with their point-distribution.","c1b70276":"This finally wraps things up for this (hopefully interesting) project. Please comment below if you have any suggestions, or had some problems with understanding my logic. \nI had a really fun time making this project, and I hope you had a good time going through it as well!","5ca4eb3e":"As we can see, Kane is the highest scorer across the last 5 seasons, with a little less than 120 goals scored during the period. The 10th highest scorer, Lukaku, is at a little above 50, so we can see that the highest goalscorers were, well and truly, much above the rest. \n\nLet us continue."}}