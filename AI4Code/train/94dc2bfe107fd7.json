{"cell_type":{"6f8e200a":"code","467db605":"code","96817140":"code","98c477de":"code","2ab22278":"code","b933aa0e":"code","834229e6":"code","c9be3fe5":"markdown","f1d50e2d":"markdown","3e02d0ee":"markdown","74f9386c":"markdown","b6b5efa6":"markdown","6a2ae68e":"markdown","3180027a":"markdown","111bcd9b":"markdown","f0d2ae27":"markdown"},"source":{"6f8e200a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport plotly.express as px\nfrom plotly.offline import plot, iplot, init_notebook_mode\ninit_notebook_mode(connected=True)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","467db605":"#Import the data and read in the CSV\nfilename = '\/kaggle\/input\/customer-base-global-retail-bank\/cube v2.csv'\ndf1 = pd.read_csv(filename)\n\n#Set the standard color palette\ncolours = ['#E6B0AA', '#CD6155', '#A93266', '#641E16']","96817140":"#Format the data by market\ndfmarket2 = df1.groupby('Market')['Numcust'].sum().reset_index()\nmarketdict = {'AUH':'AU',\n'CAN':'CAN',\n'HK':'HKG',\n'MX': 'MEX',\n'MYH': 'MYS',\n'SGH': 'SGP',\n'UAE': 'ARE',\n'UK': 'GBR',\n'US': 'USA'}\ndfmarket2['Market'] = dfmarket2['Market'].map(marketdict)\ndfmarket2.rename(columns = {'Numcust': 'Number of customers'}, inplace = True)\n\nfig1a = px.scatter_geo(dfmarket2, locations = 'Market', size = 'Number of customers', hover_name = 'Market')\nfig1a.update_layout(title = 'Number of customers by market', geo = dict(resolution = 50, landcolor = '#Efefef', showframe = True, coastlinecolor = 'white', countrycolor = 'white'))\nfig1a.show()","98c477de":"#Summarise the data by proposition\ndfprop = df1.groupby('Proposition')['Numcust'].sum().reset_index()\n\n#Build the graph\nfig2 = px.pie(dfprop, values = 'Numcust', names = 'Proposition', title = 'Proportion of customers by proposition')\nfig2.update_traces(marker = dict(colors = colours))\nfig2.show()","2ab22278":"#Get the data in shape\ndfrev = df1.groupby('Proposition')['Revenue'].sum().reset_index()\n\n#Build the figure\nfig4 = px.bar(dfrev, x = 'Proposition', y = 'Revenue')\nfig4.update_layout(title = 'Total revenue by proposition', plot_bgcolor = 'white')\nfig4.update_traces(marker = dict(color = colours))\nfig4.show()","b933aa0e":"#Get the data in the format to analyse revenue\ndfrevenue = df1.groupby('Proposition')[['Numcust','Revenue']].sum().reset_index()\ndfrevenue['Revenue per customer'] = dfrevenue['Revenue'] \/ dfrevenue['Numcust']\n\n#Build the chart\nfig3 = px.bar(dfrevenue, x = 'Proposition', y = 'Revenue per customer')\nfig3.update_layout(title = 'Revenue per customer', plot_bgcolor = 'white')\nfig3.update_traces(marker = dict(color = colours))\nfig3.show()","834229e6":"#Calculate the productd penetration as a percentage\ndfprodholding = df1.groupby('Proposition')['Numcust','CA_holders','Card_holders','Ins_holders','Inv_holders','Mort_holders'].sum()\ndfprodholding['CA_pen'] = dfprodholding['CA_holders'] \/ dfprodholding['Numcust']\ndfprodholding['Card_pen'] = dfprodholding['Card_holders'] \/ dfprodholding['Numcust']\ndfprodholding['Ins_pen'] = dfprodholding['Ins_holders'] \/ dfprodholding['Numcust']\ndfprodholding['Inv_pen'] = dfprodholding['Inv_holders'] \/ dfprodholding['Numcust']\ndfprodholding['Mort_pen'] = dfprodholding['Mort_holders'] \/ dfprodholding['Numcust']\n\n#Get the data into the format to build a grouped bar chart\ndfprodpen = dfprodholding.drop(columns = ['Numcust', 'CA_holders','Card_holders','Ins_holders','Inv_holders','Mort_holders'])\ndfprodpen = dfprodpen.reset_index()\ndfprodpen2 = pd.melt(dfprodpen, id_vars = ['Proposition'])\ndfprodpen2['variable'] = dfprodpen2['variable'].map({'CA_pen': 'Current account', 'Card_pen': 'Credit card', 'Ins_pen': 'Insurance', 'Inv_pen':'Investments', 'Mort_pen': 'Mortgage'})\n\n    \n#Build the chart\n\nfig5 = px.bar(dfprodpen2, x = 'variable',y = 'value', color = 'Proposition', barmode = 'group', title = 'Product penetration by proposition', color_discrete_map={\n                \"1. Gold\": '#E6B0AA',\n                \"2. Silver\": \"#CD6155\",\n                \"3. Bronze\": \"#A93266\"\n                })\n\n\nfig5.update_layout(plot_bgcolor = 'white', yaxis = dict(tickformat = '.0%', title = 'Penetration'), xaxis = dict(title = 'Products'))\n\nfig5.show()","c9be3fe5":"# Exploratory Data Analysis: customers of a global retail bank\n\nIn my day job, I am responsible for customer analysis for the retail bank of one of the largest financial institutions in the world. One of the challenges we have is providing quick sizing of our customer base by various demographic and financial factors.  The data is stored in different data warehouses, with inconsistency in the categories and data availability.  We solved this through building a 'customer cube' which we refresh each month, and have a dash application that allows business users to self serve this information. \n\nDue to confidentiality of course I cannot share the real customer information.  But this dataset gives a flavour of the metrics we use, and my github profile has the code build the dash app that is based off this data. \n\nHope it gives some insight into how we review our customer base in banks.\n\n","f1d50e2d":"# Customers by market \nFirst, we want to understand the number of customers by market - some of our markets are very big, some are very small and have a specific strategic focus.","3e02d0ee":"We make more money from Gold customers overall.  But there are fewer Gold customers by some distance.  Do we make a lot more money from Gold customers on a per customer basis?","74f9386c":"We can see that UK, Hong Kong and Mexico make up the bulk of customers, closely followed by the US.","b6b5efa6":"\n# Customers by proposition\nNext we want to understand the makeup of customers by proposition, do we have more customers who are 'gold' or do we have more customers who are 'bronze?\n\n","6a2ae68e":"We can see that there are far fewer customers that are 'gold' versus the other propositions.  But do we make more money from these customers?","3180027a":"We can clearly see that Gold customers hold more insurance and investment products.  We could hypothesise that insurance and investment products make more money, (and in retail banking investments are certainly profitable) but to really answer this question we need the balances and margins of these products. ","111bcd9b":"![](http:\/\/blog.strands.com\/hubfs\/banking_new_business_model.jpg)","f0d2ae27":"# Product holdings\nWe clearly make more money from gold customers on a per customer basis, these customers are really valuable to us.  Is there particular products this is being driven by?"}}