{"cell_type":{"67886405":"code","063b8aba":"code","3cee536e":"code","08a16ba9":"code","a05afefe":"code","b023c752":"code","1ec1b798":"code","7daecf61":"code","68818c89":"code","561e2797":"code","8987f452":"code","d22222ec":"code","09349c10":"code","201073a4":"code","0d76a024":"code","d38f3470":"code","8bc991ca":"code","8c547973":"code","554f8b52":"code","7672f4b6":"code","c6aa9ade":"code","cf804d08":"code","b2921d69":"code","8de289c1":"code","2bff8767":"code","3180da74":"code","62c0b9d6":"code","70229c06":"code","21402863":"code","6e581967":"code","0677f78b":"code","5762d424":"code","cdcaf549":"code","91d7dc70":"code","08f1b607":"code","480aa42c":"code","789748b5":"code","8a177c1c":"code","dfacd83d":"code","53e599d0":"code","d85cb6e8":"code","791454c1":"code","10bd12d2":"code","9ab9a111":"code","5a4e2727":"code","7b8fe996":"code","f2b61086":"code","d92bce8c":"code","649ada23":"code","8ffc73a0":"code","4c7c1b83":"code","eb055eed":"code","6d62bd84":"code","92ef0caf":"code","7c8a7f67":"markdown","643bdcf9":"markdown","2409bdb7":"markdown","16592c34":"markdown"},"source":{"67886405":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","063b8aba":"# Linear Algebra, Data Manipulation\nimport numpy as np\nimport pandas as pd\n\n# Plots\nimport seaborn as sns\npal_hls = sns.hls_palette(100, l=.3, s=.8).as_hex() # Seaborn Color Palette for colors\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\nsns.set_style('darkgrid')\n\n# Interactive Plots\nimport plotly.express as px\nfrom plotly.offline import init_notebook_mode\nimport plotly.graph_objects as go\ninit_notebook_mode()\n\n# Ignore Warnings\nimport warnings\nwarnings.filterwarnings(\"ignore\")","3cee536e":"games = pd.read_csv(\"..\/input\/nfl-big-data-bowl-2022\/games.csv\")\ngames","08a16ba9":"games[\"month\"] = games[\"gameDate\"].apply(lambda x: int(x.split(\"\/\")[0]))\ngames[\"day\"] = games[\"gameDate\"].apply(lambda x: int(x.split(\"\/\")[1]))\ngames[\"hour\"] = games[\"gameTimeEastern\"].apply(lambda x: int(x.split(\":\")[0]))","a05afefe":"def plotlybar(data, column, title):\n    df = pd.DataFrame()\n\n    df[column] = data[column].value_counts().index # Gets all the unique seasons\n    df[\"gamesCount\"] = data[column].value_counts().values # Gets the gamesCount for those unique seasons\n    df[\"percent\"] = round(df.gamesCount \/ len(data) * 100, 1) # The Percent of games played that season\n\n    # Bar plot using plotly bar plot\n    fig = px.bar(df, \n                y='gamesCount',\n                x=column,\n                text='percent',\n                height=600, width=950,\n                title=f\"<b>{title}<\/b>\", color=pal_hls[:len(df)])\n    fig.update_traces(texttemplate='%{text}%', textposition='outside') # The text at the top of the bar plot\n    fig.update_layout(\n        xaxis = dict(dtick = 1),\n        showlegend=False) # Fixing the problem with the x ticks here\n    fig.show()\n","b023c752":"plotlybar(games, \"season\", \"Number of Games Played Every Season\")\n","1ec1b798":"title_font_dict = {\"fontsize\": 16, \"fontweight\": \"bold\"}\n\nplt.figure(figsize=(10, 5), dpi=100)\nsns.countplot(x='season', data=games, hue='month', lw=2)\nplt.title('Games in Year\/Season', fontdict=title_font_dict)\nplt.legend([\"January\", \"September\", \"October\", \"November\", \"December\"],\n               loc='center right', bbox_to_anchor=(1.2, 0.5), ncol=1)\nplt.show()","7daecf61":"plotlybar(games, \"month\", \"Number of Games Played Every Month\")","68818c89":"plotlybar(games, \"day\", \"Number of Games Held Every Day\")","561e2797":"plotlybar(games, \"gameTimeEastern\", \"Number of Games played on different gameTimeEastern\")\n","8987f452":"plotlybar(games, \"hour\", \"Number of Games played on different gameTimeEastern(ignoring minutes)\")","d22222ec":"plotlybar(games, \"week\", \"Number of Games Held Every week\")","09349c10":"players = pd.read_csv('..\/input\/nfl-big-data-bowl-2022\/players.csv')\nplayers","201073a4":"players_heights = players[\"height\"] # Get the Height data from DataFrame\nplayers_heights = players_heights.apply(lambda x: x.split(\"-\")) # Split the heights by hyphen (\"-\")\n\n# Convert Heights to Centimeters and add them to DataFrame\nplayers[\"height\"] = players_heights.apply(lambda x: int(x[0]) * 12 + int(x[1]) if len(x) == 2 else int(x[0])) * 2.54\n\n# Convert Weights to Kilograms and them to DataFrame\nplayers[\"weight\"] = round(players.weight * 0.453592, 2)\n\nplayers","0d76a024":"players[\"birthYear\"] = 0\nplayers[\"birthMonth\"] = 0","d38f3470":"#There are NA values in birthDate so that we should drop them\nplayers.dropna(subset=[\"birthDate\"], inplace=True)","8bc991ca":"for idx, row in players.iterrows():\n    if len(row['birthDate'].split('\/')) == 3: # 05\/17\/1994 \n        players.loc[idx, 'birthYear'] = row['birthDate'].split('\/')[2]\n        players.loc[idx, 'birthMonth'] = row['birthDate'].split('\/')[0]\n        \n    elif len(row['birthDate'].split('-')) == 3: # 1995-05-05\n        players.loc[idx, 'birthYear'] = row['birthDate'].split('-')[0]\n        players.loc[idx, 'birthMonth'] = row['birthDate'].split('-')[1]","8c547973":"players","554f8b52":"fig = plt.figure(figsize=(20, 15), dpi=80)\n\nbirth_year_dist = players.birthYear.value_counts().sort_index()\nax1 = fig.add_subplot(221)\nsns.barplot(x=birth_year_dist.index, y=birth_year_dist.values, ax=ax1)\nax1.tick_params(axis='x', rotation=45)\nax1.set_title(\"Birth Year Distribution\", fontdict=title_font_dict)\n\nbirth_month_dist = players.birthMonth.value_counts().sort_index()\nax2 = fig.add_subplot(222)\nsns.barplot(x=birth_month_dist.index, y=birth_month_dist.values, ax=ax2)\nax2.set_title(\"Birth Month Distribution\", fontdict=title_font_dict)\n\nax3 = fig.add_subplot(223)\nsns.histplot(players.weight, ax=ax3)\nax3.set_title(\"Weight(Kg) Distribution\", fontdict=title_font_dict)\n\nax4 = fig.add_subplot(224)\nsns.histplot(players.height, ax=ax4, bins=10)\nax4.set_title(\"Height(cm) Distribution\", fontdict=title_font_dict);","7672f4b6":"fig = plt.figure(figsize=(20, 12), dpi=80)\ntitle_font_dict = {\"fontsize\": 16, \"fontweight\": \"bold\"}\n\nax1 = fig.add_subplot(211)\nsns.boxplot(players.weight, ax=ax1, width=0.5)\nax1.set_title(\"Weight(Kg) Distribution\", fontdict=title_font_dict)\n\nax2 = fig.add_subplot(212)\nsns.boxplot(players.height, ax=ax2, width=0.5)\nax2.set_title(\"Height(cm) Distribution\", fontdict=title_font_dict);","c6aa9ade":"print(f\"Youngest Player Born in: {players.birthYear.max()}\")\nprint(f\"Oldest Player Born in: {players.birthYear.min()}\")","cf804d08":"plt.figure(figsize=(10, 6), dpi=100)\nsns.regplot(x=players.weight, y=players.height, line_kws={\"color\": \"orange\"})\nplt.title(\"Player Weight(Kg) vs Player Height(cm)\");","b2921d69":"# Seeing Which college has given the most number of players\n\ncollege_count = players.collegeName.value_counts()[:25]\n\nfig = px.bar(x=college_count.index, y=college_count.values,\n             labels={\"x\":\"College Name\", \"y\":\"Count\"}, title=\"<b>Players College Count<\/b>\")\nfig.update_layout(\n  width=1300,\n  height=500,\n)\nfig.show()","8de289c1":"position_count = players.Position.value_counts()\n\nfig = px.bar(x=position_count.index, y=position_count.values,\n             labels={\"x\":\"Position\", \"y\":\"Count\"}, title=\"<b>Players Position Count<\/b>\")\nfig.update_layout(\n  width=1300,\n  height=500,\n)\nfig.show()","2bff8767":"plays = pd.read_csv(\"..\/input\/nfl-big-data-bowl-2022\/plays.csv\")\nplays","3180da74":"plt.figure(figsize=(15, 12))\nsns.heatmap(plays.corr(), annot=True)","62c0b9d6":"plays.info()","70229c06":"plotlybar(plays, \"quarter\", \"Number of Plays every quater\")\n","21402863":"plotlybar(plays, \"down\", \"Number of Plays every down\")\n","6e581967":"plotlybar(plays, \"yardsToGo\", \"Number of Plays every yardsToGo\")","0677f78b":"plotlybar(plays, \"specialTeamsPlayType\", \"Number of Playes per specialTeamsPlayType\")","5762d424":"plotlybar(plays, \"possessionTeam\", \"Number of Playes per possessionTeam\")\n","cdcaf549":"plt.figure(figsize=(10, 12), dpi=100)\n\nax1 = plt.subplot(211)\nsns.histplot(plays.kickLength, ax=ax1)\nax1.set_title(\"Kick Length Distribution\", fontdict=title_font_dict)\nax1.set_xticks(np.arange(0, 85, 10));\n\nax2 = plt.subplot(212)\nsns.boxplot(plays.kickLength, ax=ax2, width=0.5)\nax2.set_title(\"Kick Length Distribution\", fontdict=title_font_dict)\nax2.set_xticks(np.arange(0, 85, 10));","91d7dc70":"columns = [\"quarter\", \"down\", \"preSnapHomeScore\", \"preSnapVisitorScore\", \"kickReturnYardage\", \"kickLength\", \"yardsToGo\", \"kickBlockerId\",\n           \"yardlineNumber\", \"penaltyYards\", \"playResult\"]\n\nplays_temp = plays[columns]\nplays_temp","08f1b607":"plt.figure(figsize=(12, 8), dpi=80)\nsns.heatmap(plays_temp.corr(), annot=True)\nplt.title(\"Correlation Heat Map\", fontdict=title_font_dict);","480aa42c":"plt.figure(figsize=(15, 6), dpi=100)\n\nax1 = plt.subplot(121)\nsns.boxplot(\n    x = plays_temp.quarter,\n    y = plays_temp.preSnapHomeScore,\n    ax=ax1\n)\nax1.set_title(\"quarter vs preSnapHomeScore\", fontdict=title_font_dict)\n\nax2 = plt.subplot(122)\nsns.boxplot(\n    x = plays_temp.quarter,\n    y = plays_temp.preSnapVisitorScore,\n    ax=ax2\n)\nax2.set_title(\"quarter vs preSnapVisitorScore\", fontdict=title_font_dict);","789748b5":"plt.figure(figsize=(15, 6), dpi=100)\n\nax1 = plt.subplot(121)\nsns.boxplot(\n    x = plays_temp.down,\n    y = plays_temp.kickReturnYardage,\n    ax=ax1\n)\nax1.set_title(\"down vs kickReturnYardage\", fontdict=title_font_dict)\n\nax2 = plt.subplot(122)\nsns.boxplot(\n    x = plays_temp.down,\n    y = plays_temp.kickLength,\n    ax=ax2\n)\nax2.set_title(\"down vs kickLength\", fontdict=title_font_dict);\n","8a177c1c":"plt.figure(figsize=(25, 8))\n\nax1 = plt.subplot(131)\nsns.boxplot(\n    x = plays_temp.yardsToGo,\n    y = plays_temp.kickReturnYardage,\n    ax=ax1\n)\nax1.set_title(\"yardsToGo vs kickReturnYardage\", fontdict=title_font_dict)\n\nax2 = plt.subplot(132)\nsns.boxplot(\n    x = plays_temp.yardsToGo,\n    y = plays_temp.kickLength,\n    ax=ax2\n)\nax2.set_title(\"yardsToGo vs kickLength\", fontdict=title_font_dict);\n\nax3 = plt.subplot(133)\nsns.boxplot(\n    x = plays_temp.yardsToGo,\n    y = plays_temp.kickBlockerId,\n    ax=ax3\n)\nax3.set_title(\"yardsToGo vs kickBlockerId\", fontdict=title_font_dict);","dfacd83d":"plt.figure(figsize=(20, 10))\n\nax1 = plt.subplot(121)\nsns.regplot(\n    x = plays_temp.yardlineNumber,\n    y = plays_temp.playResult,\n    ax=ax1, line_kws={\"color\": \"orange\"}, scatter_kws={\"color\": \"#396EB0\"},\n)\nax1.set_title(\"yardlineNumber vs playResult\", fontdict=title_font_dict)\n\nax2 = plt.subplot(122)\nsns.regplot(\n    x = plays_temp.yardlineNumber,\n    y = plays_temp.kickLength,\n    ax=ax2, line_kws={\"color\": \"#396EB0\"}, scatter_kws={\"color\": \"orange\"},\n    marker=\"+\"\n)\nax2.set_title(\"yardlineNumber vs kickLength\", fontdict=title_font_dict);","53e599d0":"plt.figure(figsize=(20, 10))\n\nax1 = plt.subplot(121)\nsns.regplot(\n    x = plays_temp.kickLength,\n    y = plays_temp.kickReturnYardage,\n    ax=ax1, line_kws={\"color\": \"orange\"}, scatter_kws={\"color\": \"#396EB0\"},\n)\nax1.set_title(\"kickLength vs kickReturnYardage\", fontdict=title_font_dict)\n\nax2 = plt.subplot(122)\nsns.regplot(\n    x = plays_temp.kickLength,\n    y = plays_temp.playResult,\n    ax=ax2, line_kws={\"color\": \"#396EB0\"}, scatter_kws={\"color\": \"orange\"},\n    marker=\"+\"\n)\nax2.set_title(\"kickLength vs playResult\", fontdict=title_font_dict);","d85cb6e8":"tracking2020 = pd.read_csv('..\/input\/nfl-big-data-bowl-2022\/tracking2020.csv')\ntracking2020.head()","791454c1":"# Downloading and Saving Field Image for BackGround\nimport urllib.request\nurllib.request.urlretrieve(\"https:\/\/upload.wikimedia.org\/wikipedia\/commons\/thumb\/c\/c5\/AmFBfield.svg\/1200px-AmFBfield.svg.png\", \"field.png\")\n\nfrom PIL import Image\n#set a local image as a background\nimage_filename = 'field.png'\nplotly_logo = Image.open(image_filename)","10bd12d2":"def plot_tracking_data(gameId, playId=False, position=False):\n    team_names = [\"home\", \"away\", \"football\"]\n    colors = [\"#396EB0\", \"#116530\", \"red\"]\n    \n    if playId:\n        temp_tracking_df = tracking2020.query(f'gameId == {gameId} and playId == {playId}')\n        teams = 3\n    elif position:\n        temp_tracking_df = tracking2020.query(f'gameId == {gameId} and position == \"{position}\"')\n        teams = 2\n        \n    fig = go.Figure()\n    \n    for i in range (teams):\n        fig.add_trace(go.Scatter(\n            x = temp_tracking_df.query(f\"team == '{team_names[i]}'\").x,\n            y = temp_tracking_df.query(f\"team == '{team_names[i]}'\").y,\n            mode = \"markers\",\n            name=team_names[i],\n            marker=dict(color=colors[i])\n        ))\n        \n    if playId:\n        title = f\"<b>Tracking Data - gameId = {gameId} and playId = {playId}<\/b>\"\n    elif position:\n        title = f\"<b>Tracking Data - gameId = {gameId} and position = {position}<\/b>\"\n        \n    fig.update_layout(\n        template=\"plotly_white\",\n        autosize=False,\n        width=1000,\n        height=550,\n        images= [dict(source=plotly_logo,\n                      xref=\"paper\", yref=\"paper\",x=0, y=1, sizex=1, sizey=1,\n                      layer=\"below\", opacity=0.5)],\n        xaxis=dict(showgrid=False),\n        yaxis=dict(showgrid=False),\n        title=title,\n        xaxis_title=\"x\",\n        yaxis_title=\"y\",\n    )\n    fig.show()","9ab9a111":"plot_tracking_data(gameId=2020092707, playId=1186)","5a4e2727":"plot_tracking_data(gameId=2020102600, playId=250)","7b8fe996":"plot_tracking_data(gameId=2021010307, playId=2460)","f2b61086":"temp_tracking_df = tracking2020.query(f'gameId == 2021010307 and position == \"RB\"')","d92bce8c":"plot_tracking_data(gameId=2020102508, position=\"CB\")","649ada23":"plot_tracking_data(gameId=2020101112, position=\"LB\")","8ffc73a0":"plot_tracking_data(gameId=2020102507, position=\"RB\")","4c7c1b83":"import base64\n\ndef animated_game(gameId, playId, speed):\n    temp_tracking_df = tracking2020[tracking2020['gameId'] == gameId]\n\n    temp_tracking_query = (tracking2020['gameId'] == gameId) & (tracking2020['playId'] == playId)\n\n    temp_tracking_df = (\n        tracking2020[temp_tracking_query][['x', 'y', 'time', 'nflId', 'team', 'displayName']]\n        .fillna(0.)\n        .sort_values(['team', 'time'])\n    )\n\n    fig = px.scatter(\n        temp_tracking_df,\n        x='x',\n        y='y',\n        animation_frame='time',\n        color='team',\n        animation_group=\"nflId\",\n        hover_name=\"displayName\"\n    )\n    fig.update_traces(marker=dict(size=12,line=dict(width=2,color='DarkSlateGrey')),\n                      selector=dict(mode='markers'))\n    fig.update_layout(\n        template=\"plotly_white\",\n        autosize=False,\n        width=1000,\n        height=600,\n        title=f'Animation Every Players in the play {playId} of Game {gameId}',\n        images= [dict(source=plotly_logo,\n                      xref=\"paper\", yref=\"paper\",x=0, y=1, sizex=1, sizey=1,\n                      layer=\"below\", opacity=0.5)],\n        xaxis=dict(showgrid=False),\n        yaxis=dict(showgrid=False)\n    )\n    fig.layout.updatemenus[0].buttons[0].args[1][\"frame\"][\"duration\"] = speed\n    fig.show()","eb055eed":"gameId = 2021010300\nplayId = 40\nspeed = 60\n\nanimated_game(gameId, playId, speed)","6d62bd84":"gameId = 2020111510\nplayId = 1987\nspeed = 60\n\nanimated_game(gameId, playId, speed)","92ef0caf":"gameId = 2020121302\nplayId = 1320\nspeed = 60\n\nanimated_game(gameId, playId, speed)","7c8a7f67":"### PLEASE UPVOTE if you like this notebook. It will keep me motivated to update my notebook.","643bdcf9":"<h1><center>NFL Big Data Bowl 2022<\/center><\/h1>\n\n<center><img src=\"https:\/\/deadline.com\/wp-content\/uploads\/2021\/01\/NFL-ball.jpg?crop=0px%2C33px%2C1226px%2C687px&resize=681%2C383\"><\/center>","2409bdb7":"#### What are you trying to do in this notebook ?\n\nIn this notebook I will predict how many yards a team will gain on a rushing play in an NFL regular season game. I will loop through a series of rushing plays; for each play. I'll use the information that is provided in this notebook and it will predict how many yards the team will gain on the play as a cumulative probability distribution. Once I'll make that prediction, I can move on to the next rushing play.\n\n#### Why are you trying it ?\n\nThis competition is different from most Kaggle Competitions in that:\n\n* In this kaggle notebook I may not other data sources, GPU, or internet access.\n* This is a two-stage competition. In Stage One I can edit my Notebooks and improve my model, where Public Leaderboard scores are based on my predictions on rushing play.\n* The purpose of this competition is to control the flow of information that is to ensure the future data to make predictions for the current rushing play.","16592c34":"#### Are the proposed findings actionable?\n#### Is this a way of looking at tracking data that is novel?\n\nMy notebook is to generate actionable, practical, and novel insights from player tracking data that corresponds to special teams play. \n\nThere are several points but are not limited to:\n\n* Create a new special teams metric. \n* Quantify special teams strategy. \n* Rank special teams players. \nSubmissions that examine one idea more thoroughly are preferred versus those that examine several ideas somewhat thoroughly.\n\n\n#### Is this project creative?\n\nWell, this competition has both creative and analytical properties."}}