{"cell_type":{"578aada9":"code","42d367e7":"code","443ed7d5":"code","e19c0c87":"code","a1977306":"code","62c2e274":"code","fd3c4065":"code","afb098a1":"code","1a0d6b60":"code","1b580db4":"code","b33e36e4":"code","13597f57":"code","393f4cc4":"code","ca85f983":"code","41c15c24":"code","10c69959":"code","185c25f3":"code","d5efa6f0":"code","783cef6e":"code","eb6c198e":"code","7b6cc65f":"code","adef4de2":"code","e973421b":"code","28865f50":"code","d07808b5":"code","8ebca66e":"code","c7a4a0af":"code","aa3bc89f":"code","7b3297ed":"code","6c43a812":"code","efb97998":"code","41ffbe1b":"code","f9dc7cf2":"code","407eaad0":"code","7453c428":"code","1ad69ef0":"markdown","1fdf8b82":"markdown","1526a5f1":"markdown","e1616dbc":"markdown"},"source":{"578aada9":"import pandas as pd\nimport seaborn as sb\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nfrom plotly.offline import init_notebook_mode, iplot\ninit_notebook_mode(connected=True)","42d367e7":"data = pd.read_csv('..\/input\/weather-dataset-rattle-package\/weatherAUS.csv')","443ed7d5":"data.info()","e19c0c87":"data.head()","a1977306":"data['Date']=data.Date.apply(lambda x:x[:4])\ndata['Date']=data['Date'].astype('int')","62c2e274":"data.isna().sum()","fd3c4065":"data.corr()","afb098a1":"data2 = data.apply(lambda x:x.fillna(x.median()) if x.dtype=='float' else x.fillna(x.value_counts().index[0]))","1a0d6b60":"data2['RainToday'].value_counts()","1b580db4":"fig = px.scatter(data2, y=\"Evaporation\", x=\"Humidity3pm\",size=\"Rainfall\",color=\"RainTomorrow\",hover_name=\"Location\",template='plotly_dark',log_y=True, size_max=40)\n\nfig.update_traces(marker=dict(line=dict(width=1,color='white')))\nfig.show()","b33e36e4":"sb.histplot(y=data['Rainfall'],x=data['Date'])\nplt.title('year wise rainfall')\nplt.show()","13597f57":"fig = px.pie(data2, values='Rainfall', names='WindGustDir')\nfig.update_layout(title=' Rainfall vs wind gust direction')\nfig.show()","393f4cc4":"df = data2\nfig = px.pie(df, values='Rainfall', names='Location')\nfig.update_layout(title='rainfall vs location')\nfig.show()","ca85f983":"fig = px.area(df, x=\"Humidity3pm\", y=\"Rainfall\", color=\"WindGustDir\",line_group=\"Location\")\nfig.show()","41c15c24":"tomorrow = data[['Rainfall','Sunshine','Humidity9am','Humidity3pm','Cloud9am','Cloud3pm','RainToday','RainTomorrow']]","10c69959":"print(tomorrow.isna().sum())","185c25f3":"tomorrow=tomorrow.apply(lambda x:x.fillna(x.median()) if x.dtype=='float' else x.fillna(x.value_counts().index[0]))","d5efa6f0":"print(tomorrow.isna().sum())","783cef6e":"tomorrow['RainToday'],_=pd.factorize(tomorrow.RainToday)\ntomorrow['RainTomorrow'],_=pd.factorize(tomorrow.RainTomorrow)","eb6c198e":"tomorrow.head()","7b6cc65f":"tomorrow.corr()","adef4de2":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import *\nfrom sklearn.model_selection import GridSearchCV","e973421b":"features=['Rainfall','Sunshine','Humidity9am','Humidity3pm','Cloud9am','Cloud3pm','RainToday']","28865f50":"x=tomorrow[features]\ny=tomorrow['RainTomorrow']","d07808b5":"x_train,x_test,y_train,y_test=train_test_split(x,y,random_state=5,test_size=0.3)","8ebca66e":"param_grid = {\n                 'n_estimators': [5, 10, 15, 20],\n                 'max_depth': [2, 5, 7, 9]\n             }\ngrid_clf = GridSearchCV(RandomForestClassifier(), param_grid, cv=10)\ngrid_clf.fit(x_train, y_train)","c7a4a0af":"grid_clf. best_estimator_","aa3bc89f":"grid_clf. best_params_","7b3297ed":"grid_clf.cv_results_","6c43a812":"ran = RandomForestClassifier(max_depth=9, n_estimators=50, random_state=1)","efb97998":"ran.fit(x_train,y_train)","41ffbe1b":"ran_pred = ran.predict(x_test)","f9dc7cf2":"print(accuracy_score(y_test,ran_pred))","407eaad0":"from sklearn.model_selection import cross_val_score\n\nclf = ran\n\nscores = cross_val_score(clf, x,y, cv=10)\nprint('validation scores :\\n',scores)","7453c428":"print(classification_report(y_test,ran_pred))","1ad69ef0":"# data visualization","1fdf8b82":"# weather in Australia","1526a5f1":"## The model predicts with 84% accuracy","e1616dbc":"# model building"}}