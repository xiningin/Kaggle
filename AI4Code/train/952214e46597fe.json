{"cell_type":{"1fba7464":"code","c9f7d47d":"code","27ba946c":"code","d462df39":"code","554b54db":"code","e74fe650":"code","b81f60b1":"code","107baea3":"code","8be18ba2":"code","311dece8":"code","211e992b":"code","deb6eefc":"code","4f66af54":"code","a920f089":"code","1beecd07":"code","dd91fc39":"code","2fd6fc2b":"code","246b3d33":"code","7d91ad83":"code","be7d9e8e":"code","b6d02fc5":"code","d8f54c0e":"code","5e093aa5":"code","01be57b6":"code","78a0e7bf":"code","63e0fdb2":"code","69445cb3":"code","8ced0eb0":"code","a2eb8020":"code","2ea2ed09":"markdown","cea50794":"markdown","0c5ef71b":"markdown","081803a1":"markdown","b130a97a":"markdown","a414e6b4":"markdown","809c529f":"markdown","f57c86b2":"markdown","2af1d680":"markdown","38de1dfe":"markdown","c576da95":"markdown","812bfc49":"markdown","7e7c2033":"markdown","b8480533":"markdown","4f07cb4f":"markdown","1ebc05b0":"markdown","199c043f":"markdown","f3227666":"markdown","b399dbf7":"markdown","7b6e28b3":"markdown","dbd43378":"markdown","1cd79116":"markdown","47aeeacb":"markdown"},"source":{"1fba7464":"import pandas as pd\nimport numpy as np\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras import layers\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import accuracy_score\nimport matplotlib.pyplot as plt\nfrom tensorflow.keras.layers import Dense, BatchNormalization\nfrom tensorflow.keras.initializers import RandomNormal, Constant\nimport seaborn as sns","c9f7d47d":"df = pd.read_csv('\/kaggle\/input\/iba-ml1-final-project\/train.csv')\ndf.head(10)","27ba946c":"df.drop(df[df['Product_Category'] == 'Chemises'].index, inplace = True)\ndf.drop(df[df['Product_Category'] == 'Casual bottoms'].index, inplace = True)","d462df39":"df.describe()","554b54db":"sns.heatmap(df.isnull(), cmap='viridis')","e74fe650":"unique_cnt = []\nfor x in df.columns:\n    unique_cnt.append([x,len(df[x].unique()),df[x].isnull().sum()])\nprint(\"Dataframe Dimension: {} Rows, {} Columns\".format(*df.shape))\npd.DataFrame(unique_cnt, columns=[\"Column\",\"Unique\",\"Missing\"]).set_index(\"Column\").T","b81f60b1":"categories = [\"Recommended\",\"Rating\"]\nf, axis = plt.subplots(1,len(categories), figsize=(14,4), sharex=False)\n\nfor i,x in enumerate(categories):\n    sns.countplot(y=x, data=df,order=df[x].value_counts().index, ax=axis[i])\naxis[0].set_ylabel(\"Recommendation status of the product\")\naxis[1].set_ylabel(\"Ratings of the products\")\nplt.show()","107baea3":"plt.figure(figsize=(10,10))\nvalues =df.Recommended.value_counts()\nlabels=df['Recommended'].value_counts().index\nplt.pie(values,labels=labels,autopct='%.2f')\nplt.title(\"Pie-chart of the Recommended values \",fontsize=30)\nplt.legend()\nplt.show()","8be18ba2":"plt.figure(figsize=(10,10))\nvalues =df.Rating.value_counts()\nlabels=df['Rating'].value_counts().index\nplt.pie(values,labels=labels,autopct='%.2f')\nplt.title(\"Pie-chart of the Rating values \",fontsize=30)\nplt.legend()\nplt.show()","311dece8":"plt.figure(figsize=(20,10))\n\nsns.histplot(data=types, x=\"Recommended\",hue='Rating', multiple=\"dodge\")","211e992b":"plt.figure(figsize=(15, 8))\nsns.histplot(data=df, x=\"Age\",kde=True)\n","deb6eefc":"categories = [\"Division\",\"Department\"]\nf, axis = plt.subplots(1,len(categories), figsize=(15,12), sharex=False)\n\nfor i,x in enumerate(categories):\n    sns.countplot(x=x, data=df,order=df[x].value_counts().index, ax=axis[i])\n    axis[i].set_title(\"Count Categories in {}\".format(x))\n    axis[i].set_xlabel(\"\")\n    axis[i].set_xlabel(\"Count of frequency\")\naxis[0].set_ylabel(\"Category\")\naxis[1].set_ylabel(\"\")\nplt.show()","4f66af54":"plt.subplots(figsize=(18,5))\nsns.countplot(data=df, x=\"Product_Category\",order=df[\"Product_Category\"].value_counts().index)\nplt.title(\"Count of Product Category\")\nplt.xlabel(\"Count\")\nplt.show()","a920f089":"plt.figure(figsize=(8, 8))\nsns.set_theme()\ntypes=df[[\"Division\",\"Department\",'Rating','Recommended']]\ntypes=types.dropna() \n#Foundation\nsns.histplot(data=types, x=\"Division\",hue='Recommended', multiple=\"dodge\")","1beecd07":"sns.histplot(data=types, x=\"Department\",hue='Recommended', multiple=\"dodge\")","dd91fc39":"plt.figure(figsize=(10,10))\nsns.boxplot(x='Rating', y='Age', data=df)","2fd6fc2b":"plt.figure(figsize=(10,10))\nsns.violinplot(x='Recommended', y='Age', data=df)","246b3d33":"# rating = df.groupby('Rating').mean()\nrating = df.groupby('Rating').mean()\n\n# rating=rating.drop('Id',  axis='columns', inplace=True)\nrating.corr()","7d91ad83":"sns.heatmap(data=rating.corr(), annot=True)","be7d9e8e":"df=df.dropna()","b6d02fc5":"import nltk\n# nltk.download('wordnet')\n# nltk.download('stopwords')\nfrom nltk.tokenize import RegexpTokenizer\nfrom nltk.stem import WordNetLemmatizer,PorterStemmer\nfrom nltk.corpus import stopwords\nimport re\nlemmatizer = WordNetLemmatizer()\nstemmer = PorterStemmer() \n\ndef preprocess(sentence):\n    \n    sentence=str(sentence)\n    sentence = sentence.lower()\n    sentence=sentence.replace('{html}',\"\") \n    cleanr = re.compile('<.*?>')\n    cleantext = re.sub(cleanr, '', sentence)\n    rem_url=re.sub(r'http\\S+', '',cleantext)\n    rem_num = re.sub('[0-9]+', '', rem_url)\n    tokenizer = RegexpTokenizer(r'\\w+')\n    tokens = tokenizer.tokenize(rem_num)  \n    filtered_words = [w for w in tokens if len(w) > 2 if not w in stopwords.words('english')]\n    stem_words=[stemmer.stem(w) for w in filtered_words]\n    lemma_words=[lemmatizer.lemmatize(w) for w in stem_words]\n    return \" \".join(filtered_words)","d8f54c0e":"df['Review']=df['Review'].map(lambda s:preprocess(s)) \ndf[\"Review_Title\"]=df[\"Review_Title\"].map(lambda s:preprocess(s)) ","5e093aa5":"body_text = '\\n'.join(df['Review'])\ntitle_text='\\n'.join(df['Review_Title'])","01be57b6":"from wordcloud import WordCloud\n\ncloud = WordCloud(background_color='black',\n               width=1600, height=800,max_words=100,).generate(body_text)\n# plt.imshow(cloud, interpolation='bilinear')\nplt.figure(figsize=(15,7.5))\nplt.axis('off')\nplt.imshow(cloud)\nplt.show()","78a0e7bf":"cloud = WordCloud(background_color='black',\n               width=1600, height=800,max_words=150,).generate(title_text)\n# plt.imshow(cloud, interpolation='bilinear')\nplt.figure(figsize=(15,7.5))\nplt.axis('off')\nplt.imshow(cloud)\nplt.show()","63e0fdb2":"worst_rating=df[df['Rating']==1]['Review']\nworst_rating='\\n'.join(worst_rating)\n#.apply(body_text)\ncloud = WordCloud(background_color='black',\n               width=1600, height=800,max_words=150,).generate(worst_rating)\nplt.figure(figsize=(15,7.5))\nplt.axis('off')\nplt.imshow(cloud)\nplt.show()","69445cb3":"best_rating=df[df['Rating']==5]['Review']\nbest_rating='\\n'.join(best_rating)\n#.apply(body_text)\ncloud = WordCloud(background_color='black',\n               width=1600, height=800,max_words=150,).generate(best_rating)\nplt.figure(figsize=(15,7.5))\nplt.axis('off')\nplt.imshow(cloud)\nplt.show()","8ced0eb0":"recommended_words=df[df['Recommended']==1]['Review']\nrecommended_words='\\n'.join(recommended_words)\n#.apply(body_text)\ncloud = WordCloud(background_color='black',\n               width=1600, height=800,max_words=150,).generate(recommended_words)\nplt.figure(figsize=(15,7.5))\nplt.axis('off')\nplt.imshow(cloud)\nplt.show()","a2eb8020":"unrecommended_words=df[df['Recommended']==0]['Review']\nunrecommended_words='\\n'.join(unrecommended_words)\n#.apply(body_text)\ncloud = WordCloud(background_color='black',\n               width=1600, height=800,max_words=150,).generate(unrecommended_words)\nplt.figure(figsize=(15,7.5))\nplt.axis('off')\nplt.imshow(cloud)\nplt.show()","2ea2ed09":"Illustrated pie-chart diagrams show the distribution percentage of the each categorical value over the dataset, which provides better information about the data. So, as it is described, more than the half of the products got highest rating value which is 5, 1\/3 of the data got good rating points such as 3 and 4, and approximately 10 percent of the data got the lower scores (1,2).","cea50794":"This demonstration shows the mostly used words in the review title of all the products, and we can mostly see positive words about the products, such as beautiful, magnificent, love, cute, excellent, etc.","0c5ef71b":"Data cleaning process","081803a1":"With the following plot, we are describing the null values of the dataset,which is not too much in comparison with other datasets.","b130a97a":"Here we describe all of the product categories in the dataset, and clothes is situated as 1st as we see. Here we don't have tops as category, so they may be included into the clothes or other category","a414e6b4":"Here, I have decided to show the mostly used words for describing the products with the worst (1) rating. We can see that, fit, look, color, material, size and so on are some of the mostly used words and obviously those features of the products are the most important criteria while evaluating the clothes. We have general words such as \"clothe\" and \"top\" which is probably used to describe the product. Words like \"loved\",\"nice\" or \"cute\" for example is probably used with \"not\" before them.","809c529f":"Plotted histogram describes the distribution of the target variables around the data, as we see most of the products are recommended and obviously got highest rating values such as 5. From this we can also realize that data is distributed unevenly.","f57c86b2":"Here, the number of null (missing) values and unique values are described for each feature columns.","2af1d680":"From this correlation plot, we can see that, recommended status of the product and age is slightly positively correlated, other than that, there is negative correlation between the described variables.","38de1dfe":"Here I am dropping the two categories which doesn't exist in other dataframe and appear only once or twice in this dataframe. Therefore I decided that it is not useful, and while dropping I can have the fixed size of categorical values for all data frames(test data for submission and train_test split)","c576da95":"This violin plot also shows the recommendation status of the products based on the users age, but because most of the users are between 40 and 50 years old, it is not possible to have better prediction about their preference based on the violin plot. We may only see the small variations in the plot.","812bfc49":"As we have discussed, mean of the rating values for the ages are between the 40 and 50. Slightly older people seems to not like the product (based on the rating 1 boxplot) in comparison with others.","7e7c2033":"This plot shows the mostly used words in the review columns of all products, and we can see words related to the clothes, such as clothes, top, skirt, fabric etc. are most of the used words. Mostly used word is \"clothe\" which is clothes but written in the wrong form, which can be either related to the data itself or our lemmatization and stemming procedure.","b8480533":"In the above plots, division and the department of the products are described, and mostly reviewed products are Tops and Clothes as it shows, it may be related to the age of the reviewers or their gender.","4f07cb4f":"Above plots are just for showing the which categories have higher chances of getting selected by the users, and we may assume that Intimates have higher chances of the getting selected from the plot. Other than that, tops are obviously selected more, because they were dominant in the dataset.","1ebc05b0":"This plot shows the age category of the reviewers and most of them are Generation X and Millenials generations. So, we may approximate that their reviewers would make more sense, because they are supposed to have more experience in evaluating the products.","199c043f":"In this plot, distribution of the rating values over the recommendation status of the product is plotted. Most of the recommended products got higher scores (3-4 and mostly 5) and unrecommended products usually got 3 or less rating points in the websites. What is interesting, even some products which got 4 as a rating point which is accepted as good point is unrecommended, so it shows some people are just perfectionist and want the best product to buy.","f3227666":"Starting from this part, the graphical representation of the dataset will be described.","b399dbf7":"In this final plot, I have described the words which is used for not recommended products, where we can see again size, quality, material, color and some other types of features which is making the users to complain.","7b6e28b3":"In the next line, we will join all the words into one string to illustrate them using wordcloud","dbd43378":"In this plot, I have choosen the words of the product with the highest rating (5) which is also similar to the most of the words of the dataset, because most of the products got 5 rating point. So flattering, excellent, love, magnificent are obviously used in the good meaning for this product.","1cd79116":"As a matter of demonstration, I wanted to describe the product reviews based on the recommendation status of the product and firstly plotted the words used for the recommended products, which is again similar to the 5-rating based reviews and most of the words of the dataset.","47aeeacb":"I will drop the nan values for demonstrating the mostly used words by using wordcloud, otherwise it shows nan as mostly used word for title of the text"}}