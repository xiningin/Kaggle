{"cell_type":{"039a8681":"code","59e6f07c":"code","d3af7632":"code","7d405154":"code","dc6e21e9":"code","bd07df5d":"code","1d47c62e":"code","03be878f":"code","b490594f":"code","a400b3a6":"code","ade1f9bd":"code","bf8d4bb3":"code","25392c06":"code","4a226877":"code","aa3f11c0":"code","324245f7":"code","14f6581a":"code","6b7031f8":"code","25973a16":"code","fba9ad8f":"code","bc10d829":"code","dad6da35":"code","69177a09":"code","ede1b576":"code","1a1d4aa9":"code","69bb54bc":"code","3362ba6a":"code","d5b7c899":"code","af1f44bc":"code","20b8709b":"code","11d86716":"code","243ad3fe":"code","fac9f81b":"code","9f830ca4":"code","f0e39d25":"code","81561720":"code","ee0e047c":"code","98160749":"code","7c292b09":"code","2e2503a9":"markdown"},"source":{"039a8681":"import warnings\nwarnings.filterwarnings('ignore')\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.metrics import confusion_matrix,f1_score\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report\nimport re","59e6f07c":"df = pd.read_csv(\"..\/input\/twitter-hate-speech\/train_E6oV3lV.csv\")\ndf.head()","d3af7632":"hate_tweet = df[df.label == 1]\nhate_tweet.head()","7d405154":"normal_tweet = df[df.label == 0]\nnormal_tweet.head()","dc6e21e9":"# Hate Word clouds\nfrom os import path\nfrom PIL import Image\nfrom wordcloud import WordCloud, STOPWORDS, ImageColorGenerator\ntext = \" \".join(review for review in hate_tweet.tweet)\nwordcloud = WordCloud(max_font_size=50, max_words=100, background_color=\"white\").generate(text)\nfig = plt.figure(figsize = (20, 6)) \nplt.imshow(wordcloud, interpolation=\"bilinear\")\nplt.axis(\"off\")\nplt.show()","bd07df5d":"#distributions\ndf_Stat=df[['label','tweet']].groupby('label').count().reset_index()\ndf_Stat.columns=['label','count']\ndf_Stat['percentage']=(df_Stat['count']\/df_Stat['count'].sum())*100\ndf_Stat","1d47c62e":"def process_tweet(tweet):\n    return \" \".join(re.sub(\"(@[A-Za-z0-9]+)|([^0-9A-Za-z \\t])\", \" \",tweet.lower()).split())","03be878f":"df['processed_tweets'] = df['tweet'].apply(process_tweet)\ndf.head()","b490594f":"#As this dataset is highly imbalance we have to balance this by over sampling\ncnt_non_fraud = df[df['label'] == 0]['processed_tweets'].count()\ndf_class_fraud = df[df['label'] == 1]\ndf_class_nonfraud = df[df['label'] == 0]\ndf_class_fraud_oversample = df_class_fraud.sample(cnt_non_fraud, replace=True)\ndf_oversampled = pd.concat([df_class_nonfraud, df_class_fraud_oversample], axis=0)\n\nprint('Random over-sampling:')\nprint(df_oversampled['label'].value_counts())","a400b3a6":"# Split data into training and test sets\nfrom sklearn.model_selection import train_test_split\nX = df_oversampled['processed_tweets']\ny = df_oversampled['label']\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, stratify = None)","ade1f9bd":"from sklearn.feature_extraction.text import CountVectorizer, TfidfTransformer\ncount_vect = CountVectorizer(stop_words='english')\ntransformer = TfidfTransformer(norm='l2',sublinear_tf=True)","bf8d4bb3":"x_train_counts = count_vect.fit_transform(X_train)\nx_train_tfidf = transformer.fit_transform(x_train_counts)","25392c06":"print(x_train_counts.shape)\nprint(x_train_tfidf.shape)","4a226877":"x_test_counts = count_vect.transform(X_test)\nx_test_tfidf = transformer.transform(x_test_counts)","aa3f11c0":"from sklearn.ensemble import RandomForestClassifier\nmodel = RandomForestClassifier(n_estimators=500)\nmodel.fit(x_train_tfidf,y_train)","324245f7":"predictions = model.predict(x_test_tfidf)","14f6581a":"\nprint(confusion_matrix(y_test,predictions))\nprint(classification_report(y_test, predictions))","6b7031f8":"#Building XGBoost Model\nfrom xgboost import XGBClassifier\nmodel_bow = XGBClassifier(random_state=22,learning_rate=0.9)\nmodel_bow.fit(x_train_tfidf,y_train)","25973a16":"predict_xgb = model_bow.predict(x_test_tfidf)","fba9ad8f":"print(confusion_matrix(y_test,predict_xgb))\nprint(classification_report(y_test,predict_xgb))","bc10d829":"#SVM Model\nfrom sklearn import svm\nlin_clf = svm.LinearSVC()\nlin_clf.fit(x_train_tfidf,y_train)","dad6da35":"predict_svm = lin_clf.predict(x_test_tfidf)","69177a09":"from sklearn.metrics import confusion_matrix,f1_score\nprint(confusion_matrix(y_test,predict_svm))\nprint(classification_report(y_test, predict_svm))","ede1b576":"#Logistic Regression Model\nfrom sklearn.linear_model import LogisticRegression","1a1d4aa9":"logreg = LogisticRegression(random_state=42)","69bb54bc":"#Building Logistic Regression  Model\nlogreg.fit(x_train_tfidf,y_train)","3362ba6a":"predict_log = logreg.predict(x_test_tfidf)","d5b7c899":"print(confusion_matrix(y_test,predict_log))\nprint(classification_report(y_test, predict_log))","af1f44bc":"from sklearn.naive_bayes import MultinomialNB\nNB = MultinomialNB()\nNB.fit(x_train_tfidf, y_train)","20b8709b":"predict_nb = NB.predict(x_test_tfidf)","11d86716":"print(confusion_matrix(y_test,predict_nb))\nprint(classification_report(y_test, predict_nb))","243ad3fe":"#Test Data Set\ndf_test = pd.read_csv(\"..\/input\/twitter-hate-speech\/test_tweets_anuFYb8.csv\")\ndf_test.head()","fac9f81b":"df_test.shape","9f830ca4":"df_test['processed_tweets'] = df_test['tweet'].apply(process_tweet)\ndf_test.head()","f0e39d25":"X = df_test['processed_tweets']\nx_test_counts = count_vect.transform(X)\nx_test_tfidf = transformer.transform(x_test_counts)","81561720":"df_test['predict_nb'] = NB.predict(x_test_tfidf)\ndf_test[df_test['predict_nb']==1]","ee0e047c":"\ndf_test['predict_svm'] = NB.predict(x_test_tfidf)\ndf_test['predict_rf'] = model.predict(x_test_tfidf)\ndf_test.head()","98160749":"\nfile_name = 'test_predictions_Twitter Hate Analysis.csv'\ndf_test.to_csv(file_name,index=False)\n","7c292b09":"# **Results**\n\n#Algorithms                                  F1-Score\n\n#SVM                                            99%\n\n#Random Forest                                  98%\n\n#XG Boost                                       91%\n\n#Navie Bayes                                    95%\n\n#Logistic Regression                            98%\n \n","2e2503a9":"## **Problem**\n Use of Social media has been increasing day by day and also hate Speech is also increasing along with number of users. So it is tough challenge for companies to monitor each and every tweet of users, so we are developing a machine learning model to identify the hate speech tweets automatically which saves lot of resources for companies. In this problem, the data set given has only 25% of hate tweets, so when we build a model usin this data the model performs better on the normal tweets which doesn't solve our problem. So we need to oversample the hate tweets so that the two classes will be equal and our model works better."}}