{"cell_type":{"72feb34d":"code","156d0b25":"code","3d14ce40":"code","92b25490":"code","7034c7b5":"code","1fe5bbc5":"code","c44d8f1f":"code","d09d22d4":"markdown","2b6828fe":"markdown","d982ab9c":"markdown","eff452ed":"markdown","f5d5600d":"markdown","70344af0":"markdown","0b49c39b":"markdown"},"source":{"72feb34d":"!pip install -q -U datasets > \/dev\/null","156d0b25":"from transformers import AutoModelWithLMHead, AutoTokenizer\nfrom datasets import load_dataset\nimport random, warnings\nwarnings.filterwarnings(\"ignore\")","3d14ce40":"tokenizer = AutoTokenizer.from_pretrained(\"mrm8488\/t5-base-finetuned-wikiSQL\")\nmodel = AutoModelWithLMHead.from_pretrained(\"mrm8488\/t5-base-finetuned-wikiSQL\")","92b25490":"def get_sql(query):\n    \n    input_text = \"translate English to SQL: %s <\/s>\" % query\n    \n    features = tokenizer([input_text], return_tensors='pt')\n\n    output = model.generate(input_ids=features['input_ids'], \n               attention_mask=features['attention_mask'])\n\n    return tokenizer.decode(output[0])","7034c7b5":"valid_dataset = load_dataset('wikisql', split='validation')","1fe5bbc5":"valid_dataset[0]","c44d8f1f":"for idx in random.sample(range(len(valid_dataset)), 250):\n    print(f\"Text: {valid_dataset[idx]['question']}\")\n    print(f\"Pred SQL: {get_sql(valid_dataset[idx]['question'])}\")\n    print(f\"True SQL: {valid_dataset[idx]['sql']['human_readable']}\\n\")","d09d22d4":"<h2><center>Translating Text to SQL with T5 Transformer<\/center><\/h2>\n\n![](https:\/\/i.imgur.com\/jVFMMWR.png)\n\n<h4><center>Image Source:  <a href=\"https:\/\/ai.googleblog.com\/2020\/02\/exploring-transfer-learning-with-t5.html\">Google AI Blog<\/a><\/center><\/h4>","2b6828fe":"### Predict Function","d982ab9c":"### Sample Validation Data","eff452ed":"### Libraries \ud83d\udcda\u2b07","f5d5600d":"### Import the T5-base model [fine-tuned on WikiSQL](https:\/\/huggingface.co\/mrm8488\/t5-base-finetuned-wikiSQL?text=My+name+is+Wolfgang+and+I+live+in+Berlin) from [\ud83e\udd17\/transformers](https:\/\/github.com\/huggingface\/transformers) [thanks to [Manuel Romero](https:\/\/huggingface.co\/mrm8488)]","70344af0":"### Prediction on WikiSQL Validation Set","0b49c39b":"### Install Transformers Datasets (to get [wikiSQL dataset](https:\/\/huggingface.co\/nlp\/viewer\/?dataset=wikisql))"}}