{"cell_type":{"027a6114":"code","a8f163ac":"code","bb97f149":"code","6cb545b7":"code","308f1899":"code","c2aa32f4":"code","5475599f":"code","e1cdcfce":"code","6dda453a":"code","645819d7":"code","b1f664d9":"code","4785d952":"code","f9fd27a1":"code","e38e82e0":"markdown","b3b704e5":"markdown","87be4455":"markdown","8b6bbc3e":"markdown","78fb0029":"markdown","65363a88":"markdown","c197f062":"markdown"},"source":{"027a6114":"import os\nimport numpy as np\nimport pandas as pd\nfrom pathlib import Path\n\npd.set_option('max_columns', None)\npd.set_option('max_rows', None)","a8f163ac":"show_files=0\n\nif show_files:\n    for dirname, _, filenames in os.walk('\/kaggle\/input'):\n        for filename in filenames:\n            print(os.path.join(dirname, filename))","bb97f149":"train=pd.read_csv('\/kaggle\/input\/siim-isic-melanoma-classification\/train.csv')\ntest=pd.read_csv('\/kaggle\/input\/siim-isic-melanoma-classification\/test.csv')\ndups=pd.read_csv('\/kaggle\/input\/siim-list-of-duplicates\/2020_Challenge_duplicates.csv')\n\n# TRAIN_IMG=Path('\/kaggle\/input\/siim-isic-melanoma-classification\/jpeg\/train\/')\n# TEST_IMG=Path('\/kaggle\/input\/siim-isic-melanoma-classification\/jpeg\/test\/')","6cb545b7":"train.head()","308f1899":"dups.head()","c2aa32f4":"len(dups)","5475599f":"unq=np.unique(dups['ISIC_id'].values)\nlen(unq)","e1cdcfce":"def extract_data(partition, verbose=1):\n    \n    print(f\"Partition: {partition}\")\n    \n    if partition=='train':\n        df=train.copy()\n    else:\n        df=test.copy()\n        \n    mask_df=dups['partition']==partition\n\n    \n    original=dups[mask_df].merge(df, left_on='ISIC_id', right_on='image_name')\n\n        \n    paired=dups[mask_df].merge(df, left_on='ISIC_id_paired', right_on='image_name')\n    \n    if verbose:\n        print(f\"The total number of entries: {mask_df.sum()}\")    \n        print(f\"The length of 'original': {len(original)}\")    \n        print(f\"The length of 'paired': {len(paired)}\")\n    \n    return original, paired, df","6dda453a":"original_train, paired_train, _ = extract_data('train')","645819d7":"original_train.head()","b1f664d9":"def check_consistency(partition, verbose=0):\n    \n    original, paired, df = extract_data(partition, verbose=verbose)\n    \n    cols=[c for c in df.columns if c not in ['image_name']]\n\n    for c in cols:\n        print(\"=\"*100)\n        print(f\"{c}:\")\n        mask_c=np.equal(original[c].fillna('na').values, paired[c].fillna('na').values)\n        if mask_c.all():\n            print(f\"The values of '{c}' are in a perfect agreement between the original and paired images.\")\n        else:\n            print(f\"The values of {c} differ between the original and paired images.\\n\")\n            df_cols=['ISIC_id', 'ISIC_id_paired', c]\n            df=original.loc[~mask_c, df_cols]\n            df[c+'_o']=df.pop(c)\n            df[c+'_p']=paired.loc[~mask_c, c]\n            print(df)\n    print(\"=\"*100)","4785d952":"check_consistency('train')","f9fd27a1":"check_consistency('test')","e38e82e0":"### Loadng libraries and data","b3b704e5":"### The consistency check","87be4455":"Here is a function that we will use to make data frames holding tabular data for original and paired images present in a given partition (`train` or `test`). ","8b6bbc3e":"### A quick peek at the list of duplicates","78fb0029":"### Conclusion\n\nWe see that there are some tabular data that differ between the original and paired images. Fortunately, the number of such data points is small, so they should not affect our final results in any significant way. ","65363a88":"### Motivation\n\nNow, we [know it officially](https:\/\/www.kaggle.com\/c\/siim-isic-melanoma-classification\/discussion\/161943) that there are duplicate images in the data set. The hosts have officially provided a list of duplicates which I put in a [public data set](https:\/\/www.kaggle.com\/graf10a\/siim-list-of-duplicates). The purpose of this notebook is to check the consistency of the tabular data between the orignal images and their duplicates. ","c197f062":"Now, let's make a function for consistency checking -- we want to make sure that the original and the paired tabular data are the same (or almost the same)."}}