{"cell_type":{"c9a1b2d6":"code","f3cd0746":"code","1bef15aa":"code","773fab1b":"code","83ee39f8":"code","f76f5979":"code","045dc198":"code","d16430eb":"code","fa900899":"code","d27947d8":"code","c42a375c":"code","4a1a3e5d":"code","d12be62e":"code","8bcc6d28":"code","8478b376":"code","d485499a":"code","2055fc86":"code","ef044f20":"code","5f636003":"code","185df3b6":"code","598caae9":"code","ce744c17":"code","ce78fc97":"markdown","4e730128":"markdown","d326b73c":"markdown","2e5fcf10":"markdown","ce67c93f":"markdown","a6f9c489":"markdown","e6b91b43":"markdown"},"source":{"c9a1b2d6":"!pip install ppscore","f3cd0746":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom pylab import rcParams\nimport ppscore as pps\n\n%matplotlib inline\n\nrcParams['figure.figsize'] = 15, 8\npd.options.display.max_columns = None","1bef15aa":"data = pd.read_csv(\"\/kaggle\/input\/fetal-health-classification\/fetal_health.csv\")","773fab1b":"data.head(10)","83ee39f8":"data.isna().sum()","f76f5979":"data.info()","045dc198":"data['fetal_health'].value_counts()","d16430eb":"sns.countplot(data['fetal_health'])\nplt.show()","fa900899":"data.describe()","d27947d8":"sns.heatmap(data.corr(), annot=True, fmt='.1f')\nplt.show()","c42a375c":"f, axes = plt.subplots(2, 3)\nsns.barplot(x='fetal_health', y='abnormal_short_term_variability', data=data, ax=axes[0][0])\nsns.barplot(x='fetal_health', y='prolongued_decelerations', data=data, ax=axes[0][1])\nsns.barplot(x='fetal_health', y='accelerations', data=data, ax=axes[0][2])\nsns.barplot(x='fetal_health', y='percentage_of_time_with_abnormal_long_term_variability', data=data, ax=axes[1][0])\nsns.barplot(x='fetal_health', y='histogram_mode', data=data, ax=axes[1][1])\nsns.barplot(x='fetal_health', y='uterine_contractions', data=data, ax=axes[1][2])\nplt.show()","4a1a3e5d":"from sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score, classification_report, roc_curve, roc_auc_score, f1_score","d12be62e":"X = data.drop(['fetal_health'], axis=1)\ny = data['fetal_health']\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42, shuffle=True)\nX_train","8bcc6d28":"rfc = RandomForestClassifier()\nrfc.fit(X_train, y_train)","8478b376":"y_pred = rfc.predict(X_test)","d485499a":"print(classification_report(y_test, y_pred))","2055fc86":"from sklearn.model_selection import GridSearchCV","ef044f20":"GBM_params =  { \n    'n_estimators': [200, 500, 800, 1000],\n    'max_features': ['auto', 'sqrt', 'log2'],\n    'max_depth' : [4,5,6,7,8,10],\n    'criterion' :['gini', 'entropy']\n}","5f636003":"GBM_model = GridSearchCV(rfc, GBM_params, cv=10, n_jobs=-1, verbose=2).fit(X_train, y_train)","185df3b6":"GBM_model.best_params_","598caae9":"upgraded_rfc = RandomForestClassifier(criterion='entropy', max_depth=10, max_features='sqrt', n_estimators=500)\nupgraded_rfc.fit(X_train, y_train)\nup_y_pred = upgraded_rfc.predict(X_test)","ce744c17":"print(classification_report(y_test, y_pred))\nprint(classification_report(y_test, up_y_pred))","ce78fc97":"1. We can see that Pathological class has the highest abnormal_short_term_variability\n2. prolongued_decelerations has the highest value for Pathological class\n3. Normal class has highest accelerations, so if the accelerations is low then there is high chance of getting Suspect\/Pathological fetus\n4. Others doens't have obvious impact, as there are mix type of impact","4e730128":"**Managed to increase the precision and f1-score but lossed 0.2 score for Suspect recall score**","d326b73c":"**The problem is now that the target variable is imbalanced and we have more normal than the other two labels**","2e5fcf10":"**Where are going to try and build tree based model as there is some imbalanced data as tree based model can split the features based on the conditions**","ce67c93f":"Fetal Health\n\n1 - Normal\n2 - Suspect\n3 - Pathological","a6f9c489":"**Among the features, here a few features that can have significant impact on fetal_health**\n\n1. prolongued_decelerations\n2. abnormal_short_term_variability\n3. accelerations\n4. percentage_of_time_with_abnormal_long_term_variability","e6b91b43":"Well that is not bad, good recall score, but predicting suspect class is still a bit less good"}}