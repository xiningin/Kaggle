{"cell_type":{"f4f18b97":"code","bb618f5d":"code","87234797":"code","1922d62f":"code","fb6ae02c":"code","4190718b":"code","c88005a3":"code","841b6e0a":"code","9f10c2f6":"code","46023778":"code","b16e46bb":"code","e694dadd":"code","2312a33e":"code","e686f41a":"code","65261b39":"code","b00736d7":"code","fb751e25":"code","e15b4638":"code","eaf92fe5":"code","02154a5e":"code","fec2860a":"code","5472f6e8":"code","4eddd1ee":"code","631c1f4a":"code","d84e6960":"code","e8131d8b":"code","73116a04":"code","3307be32":"code","7cd78226":"code","c27292b6":"code","633fad30":"code","996cb143":"code","8df9a9c5":"code","5bba2a07":"code","a26ae111":"code","006cd6c5":"code","2dbcee3f":"code","fc04218d":"code","4be342a9":"code","73e8465d":"code","030cd496":"code","685c76fb":"code","d4b2cd57":"code","209f20bc":"markdown","5eb941a7":"markdown","cb926a5f":"markdown","39705e41":"markdown","b74837d3":"markdown","1eb0769c":"markdown","d25f4884":"markdown","705fe901":"markdown","f0a9aa46":"markdown","a419e998":"markdown","b90128a5":"markdown","50c023d7":"markdown","e41d8219":"markdown","839ca427":"markdown","93fad85f":"markdown","4154e278":"markdown","64ebed13":"markdown","10cbbd41":"markdown","31a9ba9c":"markdown","cc907564":"markdown"},"source":{"f4f18b97":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","bb618f5d":"import os\ndata = pd.read_csv('\/kaggle\/input\/titanic_data.csv')","87234797":"data.head(10)","1922d62f":"data.shape","fb6ae02c":"data.info()","4190718b":"sns.boxplot(data['Age']);","c88005a3":"(20+22+20+24+80)\/5","841b6e0a":"20,20,22,24,80","9f10c2f6":"data.Age.median()","46023778":"data['Age'].fillna(data.Age.median(),inplace=True)","b16e46bb":"data.info()","e694dadd":"data.head()","2312a33e":"data['family_size'] = data['SibSp']+data['Parch']+1","e686f41a":"data.head()","65261b39":"cols_to_remove = ['PassengerId','Name','SibSp','Parch','Fare']\ndata.drop(cols_to_remove, axis=1, inplace=True)","b00736d7":"data.head()","fb751e25":"data['Sex'].unique()","e15b4638":"data_with_dummies = pd.get_dummies(data, columns=['Sex'],drop_first=True)","eaf92fe5":"data_with_dummies.head()","02154a5e":"sns.pairplot(data_with_dummies);","fec2860a":"data_with_dummies.head()","5472f6e8":"data_with_dummies.columns","4eddd1ee":"features = ['Pclass', 'Age', 'family_size', 'Sex_male']\ntarget = ['Survived']","631c1f4a":"x = data_with_dummies[features]\ny = data_with_dummies[target]","d84e6960":"x.head()","e8131d8b":"y.head()","73116a04":"from sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2, random_state=96)","3307be32":"print('x-train shape', x_train.shape)\nprint('x-test shape', x_test.shape)\nprint('y-train shape', y_train.shape)\nprint('y-test shape', y_test.shape)","7cd78226":"from sklearn.linear_model import LogisticRegression","c27292b6":"log_reg = LogisticRegression()","633fad30":"log_reg.fit(x_train, y_train)","996cb143":"y_pred = log_reg.predict(x_test)","8df9a9c5":"y_pred","5bba2a07":"log_reg.predict_proba(x_test)[:,1]","a26ae111":"y_pred.sum()","006cd6c5":"from sklearn.metrics import confusion_matrix, accuracy_score","2dbcee3f":"confusion_matrix(y_test, y_pred)","fc04218d":"pd.DataFrame(confusion_matrix(y_test, y_pred))","4be342a9":"pd.DataFrame(confusion_matrix(y_test, y_pred), columns=['predicted_not_survived','predicted_survived'], index=['actual_not_survived','actual_survived'])","73e8465d":"(105+41)\/(105+18+15+41)","030cd496":"accuracy_score(y_test, y_pred)","685c76fb":"41\/(41+18)","d4b2cd57":"pd.DataFrame([[90,10],[0,0]], columns=['predicted_negative','predicted_positive'], index=['actual_negative','actual_positive'])","209f20bc":"<a id='section1'><\/a>\n### 1. Problem Statement","5eb941a7":"## Table of Contents\n\n1. [Problem Statement](#section1)<br>\n2. [Data Loading and Description](#section2)\n3. [Preprocessing](#section3)\n4. [Logistic Regression](#section4)<br>\n    - 4.1 [Preparing X and y using pandas](#section401)<br>\n    - 4.2 [Splitting X and y into training and test dataset](#section402)<br>\n    - 4.3 [Logistic regression in scikit-learn](#section403)<br>\n    - 4.4 [Using the Model for Prediction](#section404)<br>\n5. [Model evaluation](#section5)<br>","cb926a5f":"__Error__ is the _deviation_ of the values _predicted_ by the model with the _true_ values.<br\/>\nWe will use __accuracy score__ and __confusion matrix__ for evaluation.","39705e41":"To apply any machine learning algorithm on your dataset, basically there are 4 steps:\n1. Load the algorithm\n2. Instantiate and Fit the model to the training dataset\n3. Prediction on the test set\n4. Evaluation of the model","b74837d3":"<a id='section402'><\/a>\n## 4.2 Splitting X and y into training and test datasets.","1eb0769c":"| Column Name   | Description                                               |\n| ------------- |:-------------                                            :| \n| PassengerId   | Passenger Identity                                        | \n| Survived      | Whether passenger survived or not                         |  \n| Pclass        | Class of ticket                                           | \n| Name          | Name of passenger                                         |   \n| Sex           | Sex of passenger                                          |\n| Age           | Age of passenger                                          |\n| SibSp         | Number of sibling and\/or spouse travelling with passenger |\n| Parch         | Number of parent and\/or children travelling with passenger|                                       \n| Fare          | Price of ticket                                           |","d25f4884":"<a id='section3'><\/a>\n## 3. Preprocessing the data","705fe901":"<a id='section404'><\/a>\n## 4.4 Using the Model for Prediction","f0a9aa46":"<a id='section4'><\/a>\n## 4. Logistic Regression","a419e998":"<a id='section403'><\/a>\n## 4.3 Logistic regression in scikit-learn","b90128a5":"# Logistic Regression on titanic dataset","50c023d7":"100\n\n90 negative\n10 positive\n\n90%\n0%","e41d8219":"<a id='section2'><\/a>\n### 2. Data Loading and Description","839ca427":"- Dealing with missing values<br\/>\n    - Replacing missing values of __Age__ with median values.","93fad85f":"#### Importing the Dataset","4154e278":"- The dataset consists of the information about people boarding the famous RMS Titanic. Various variables present in the dataset includes data of age, sex, fare, ticket etc. \n- The dataset comprises of __891 observations of 9 columns__. Below is a table showing names of all the columns and their description.","64ebed13":"<a id='section5'><\/a>\n## 5. Model evaluation ","10cbbd41":"The goal is to __predict survival__ of passengers travelling in RMS __Titanic__ using __Logistic regression__.","31a9ba9c":"<a id='section401'><\/a>\n## 4.1 Preparing X and y using pandas","cc907564":"classwise \n\n100% accurate for negative cases ::\n0% accurate for positive cases"}}