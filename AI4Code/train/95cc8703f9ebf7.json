{"cell_type":{"6ac71ac9":"code","580e26dd":"code","3086adae":"code","7268e1e0":"code","e0af0471":"code","4ee0c2fc":"code","53775da8":"code","c793c1bf":"code","b4626abe":"code","7c2434ea":"code","d486bb54":"code","738d5693":"code","08ebbf01":"code","6826b69e":"code","36e9ba6f":"code","b5c2c6be":"code","81f9e7e8":"code","23dd7b27":"code","fd03999d":"code","42dee819":"code","8d74a899":"code","90815eb9":"code","c830a7d5":"code","122c4e4c":"code","54e134b2":"code","c2fce519":"code","170aa563":"code","cef50ba0":"code","34e8f5f8":"code","349820f6":"code","343e8893":"markdown","48ba9c31":"markdown","752731e3":"markdown","003474f6":"markdown","a9c911a3":"markdown","dd1df37f":"markdown","2a5fdb3f":"markdown","8c61546b":"markdown","9e554abf":"markdown","d50ab03f":"markdown","a6c02ffe":"markdown","cc973d02":"markdown","64e2708d":"markdown","35d9670f":"markdown","fdcd3349":"markdown","d0b8db0a":"markdown","e39db756":"markdown","275ce0f9":"markdown","9b92566c":"markdown","84fb64f8":"markdown","ded8bb44":"markdown","5aa18802":"markdown","68d50447":"markdown","e810f06c":"markdown","6e5f0234":"markdown","7a54bbb5":"markdown","67ad1923":"markdown","c8974604":"markdown","4d492b92":"markdown","1a278d00":"markdown","92e79548":"markdown","b4666778":"markdown","18d9369b":"markdown","09f6d2f0":"markdown"},"source":{"6ac71ac9":"import seaborn as sns\nimport matplotlib.pyplot as plt\nimport numpy as np \nimport os \nimport pandas as pd\nfrom scipy import stats\nimport pycountry\nimport geopandas","580e26dd":"print(os.listdir('..\/input'))","3086adae":"filename = \"..\/input\/master.csv\"\ndf = pd.read_csv(filename)\nprint(df.head())","7268e1e0":"df.rename(columns={\"suicides\/100k pop\":\"suicides_pop\",\"HDI for year\":\"HDI_for_year\",\n                  \" gdp_for_year ($) \":\"gdp_for_year\",\" gdp_per_capita ($) \":\"gdp_per_capita\",\n                    \"gdp_per_capita ($)\":\"gdp_per_capita\"}, inplace=True)\nprint(df.columns)","e0af0471":"df[\"gdp_for_year\"] = df[\"gdp_for_year\"].str.replace(\",\",\"\").astype(np.int64)\ndf[\"age\"] = df[\"age\"].str.replace(\"5-14 years\",\"05-14 years\")","4ee0c2fc":"df_men = df[df.sex == \"male\"]\ndf_women = df[df.sex == \"female\"]\nsns.lineplot(df_men.year, df.suicides_no, ci = None)\nsns.lineplot(df_women.year, df.suicides_no, ci = None)\nplt.legend([\"male\", 'female'])\nplt.show()","53775da8":"df_age = df.groupby([\"year\",\"age\"])[\"suicides_no\", \"population\"].sum()\ndf_reset = df_age.copy().reset_index()\nplt.figure(figsize=(9,6))\nsns.lineplot(\"year\", df_reset.suicides_no*100\/df_reset.population, hue = \"age\",\n             data = df_reset, linewidth = 2.5, style = \"age\", markers=True\n            , dashes=False)\nplt.xticks(rotation = 90)\nplt.show()","c793c1bf":"df_generation = df.groupby([\"year\", \"generation\"])[\"suicides_no\", \"population\"].sum()\ndf_generation_reset = df_generation.copy().reset_index()\nplt.figure(figsize=(9,6))\nsns.lineplot(\"year\", df_generation_reset.suicides_no*100\/df_generation_reset.population, hue = \"generation\", \n            data = df_generation_reset, linewidth = 2.5, style = \"generation\", markers=True\n            , dashes=False)\nplt.xticks(rotation = 90)\nplt.show()","b4626abe":"df1 = df.groupby(\"country\")[\"suicides_no\"].sum()\ncountry_name = list(df1.index.get_level_values(0))\nlen(country_name)","7c2434ea":"countries = {}\nfor country in pycountry.countries:\n    countries[country.name] = country.alpha_3","d486bb54":"country_not_in_list = [i for i in country_name[:] if i not in countries.keys()]\ncountry_not_in_list","738d5693":"df.replace(\"Republic of Korea\", \"Korea, Republic of\", inplace = True)\ndf.replace('Czech Republic', \"Czechia\", inplace = True)\ndf.replace('Macau', 'Macao', inplace = True)\ndf.replace('Saint Vincent and Grenadines', \"Saint Vincent and the Grenadines\", inplace = True)","08ebbf01":"df_suino = df.groupby([\"country\",\"year\"])[\"suicides_no\"].sum()\ndf_sum = df_suino.sort_index(ascending=True)[:] * 100\n\ndf_pop = df.groupby([\"country\",\"year\"]).population.sum()\ndf_pop_sum = df_pop.sort_index(ascending=False)[:]\n\ndf_total = df_sum \/ df_pop_sum\ndf_total.head(10)","6826b69e":"country_dict={}\nfor country in df_total.index.get_level_values(0):\n    if country not in country_dict.keys():\n        country_dict[country] = df_total[country].mean()\n    else:\n        pass\n\ntup = list(country_dict.items())\ntup.sort(key= lambda pair:pair[1], reverse = True)\n\ncountry_list = [a[0] for a in tup]\ncountry_suicide = [a[1] for a in tup]","36e9ba6f":"plt.figure(figsize=(8,32))\nsns.barplot(x=country_suicide[:],y=country_list[:], palette=\"GnBu\")\nplt.xlabel(\"ratio of suicide\")\nplt.ylabel(\"country\")\nplt.title(\"suicide rate vs country\")\nplt.show()","b5c2c6be":"country_dict = dict()\nfor idx in range(len(country_list)):\n    country_dict[countries[country_list[idx]]] = country_suicide[idx]","81f9e7e8":"new_country_dict = {}\nnew_country_dict[\"iso_a3\"] = list(country_dict.keys())\nnew_country_dict[\"suicide_rate\"] = list(country_dict.values())\nnew_country_df = pd.DataFrame(new_country_dict)\nnew_country_df.head()","23dd7b27":"world = geopandas.read_file(geopandas.datasets.get_path('naturalearth_lowres'))\ncities = geopandas.read_file(geopandas.datasets.get_path('naturalearth_cities'))\nworld.head()","fd03999d":"result = pd.merge(world, new_country_df, on = \"iso_a3\")\nresult.head()","42dee819":"ax = result.plot()\nax.set_title(\"world suicide rate\")\nresult.plot(column='suicide_rate', ax = ax, legend=True)","8d74a899":"plt.figure(figsize = (9,6))\nfor country in country_list[:10]:\n    plt.plot(df_total[country].index,df_total[country].values, label=country, marker=\"o\")\nplt.xlabel(\"year\")\nplt.ylabel(\"ratio of suicide\")\nplt.legend()\nplt.show()","90815eb9":"plt.figure(figsize = (9,6))\ndf_gdp = df.groupby([\"country\",\"year\"]).gdp_per_capita.mean()\nfor country in country_list[:10]:\n    plt.plot(df_gdp[country].index,df_gdp[country].values, label=country, marker=\"o\")\nplt.xlabel(\"year\")\nplt.ylabel(\"gdp_per_capita\")\nplt.legend()\nplt.show()","c830a7d5":"plt.figure(figsize = (9,6))\nfor country in country_list[:10]:\n    sns.regplot(x=df_gdp[country].values, y=df_total[country].values, label = country)\nplt.xlabel(\"gdp_per_capita\")\nplt.ylabel(\"ratio of suicides\")\nplt.ylim(0,0.06)\nplt.xlim(0)\nplt.legend()\nplt.show()\n\ncorr_eff = {}\nfor country in country_list[:10]:\n    slope, intercept, r_value, p_value, std_err = stats.linregress(df_gdp[country].values,df_total[country].values)\n    corr_eff[country] = float(r_value)\n    \nsns.barplot(x=list(corr_eff.keys()), y=list(corr_eff.values()), palette = \"YlOrRd\")\nplt.xticks(rotation = 90)\nplt.xlabel(\"Country\")\nplt.ylabel(\"correlation coeff.\")\nplt.title(\"GDP vs suicides\")\nplt.show()","122c4e4c":"corr_eff = {}\np_value_eff = {}\nfor country in country_list[:]:\n    slope, intercept, r_value, p_value, std_err = stats.linregress(df_gdp[country].values, df_total[country].values)\n    corr_eff[country] = float(r_value)\n    p_value_eff[country] = float(p_value)\n\ngdp_tup = list(corr_eff.items())\ngdp_tup.sort(key= lambda pair:pair[1], reverse = False)\ndgp_relation = {a[0]:a[1] for a in gdp_tup}\n\nplt.figure(figsize=(18,12))\nsns.barplot(x=list(dgp_relation.keys()), y=list(dgp_relation.values()), palette = \"YlOrRd\")\nplt.xticks(rotation = 90)\nplt.xlabel(\"Country\")\nplt.ylabel(\"correlation coeff.\")\nplt.title(\"GDP vs suicides\")\nplt.show()","54e134b2":"high_relation_gdp = {a:b for a,b in dgp_relation.items() if b <= -0.6}\nprint(len(high_relation_gdp))\nhigh_relation_gdp","c2fce519":"positive_relation_gdp = {a:b for a,b in corr_eff.items() if b > 0.6}\npositive_relation_tup = list(positive_relation_gdp.items())\npositive_relation_tup.sort(key= lambda pair:pair[1], reverse = True)\npositive_relation = {a[0]:a[1] for a in positive_relation_tup}\nprint(len(positive_relation))\npositive_relation","170aa563":"city_list = list({a:b for a,b in positive_relation.items()})\nfor country in city_list[:10]:\n    plt.plot(df_gdp[country].index,df_gdp[country].values, label=country, marker=\"o\")\nplt.xlabel(\"year\")\nplt.ylabel(\"gdp_per_capita\")\nplt.legend()\nplt.show()\n\nfor country in city_list[:10]:\n    plt.plot(df_total[country].index,df_total[country].values, label=country, marker=\"o\")\nplt.xlabel(\"year\")\nplt.ylabel(\"ratio of suicide\")\nplt.legend()\nplt.show()","cef50ba0":"plt.figure(figsize = (9,6))\nsns.barplot(x=\"year\", y=\"suicides_pop\", hue=\"age\",\n            ci = None,data = (df[df[\"country\"] == \"Korea, Republic of\"]) )\nplt.xticks(rotation = 90)\nplt.title(\"suicide rate of Korea\" )\nplt.legend()    \nplt.show()","34e8f5f8":"without_relation_gdp = {a:b for a,b in corr_eff.items() if -0.3 < b < 0.3}\nno_relation_gdp = [i for i in country_list[:20] if i in without_relation_gdp.keys()]\nno_relation_gdp","349820f6":"plt.figure(figsize = (9,6))\nsns.barplot(x=\"year\", y=\"suicides_pop\", hue=\"age\",\n            ci = None,data = (df[df[\"country\"] == \"Japan\"]) )\nplt.xticks(rotation = 90)\nplt.title(\"suicide rate of Japan\" )\nplt.legend()    \nplt.show()","343e8893":"No matter which year it is, the suicides number of male are about three times higher than of female. How about the age?","48ba9c31":"Use geopandas library to get information of countries, including coordinate.","752731e3":"Rearrange the dataset.","003474f6":"Before ploting the suicide rate of each countries, we calcuate the suicide rate for each year, and then take the average of number as rate.","a9c911a3":"Double check country name if the name in country list are not the same.  ","dd1df37f":"It's clearly that the suicide rate of some top10 countries dramatically increased after 1990. In addition, the rate in others are still high during 1990 to 2000. The transition to the economy and democracy in former Soviet Union countries may be the main reasons. Although there have been numerous studies of the increase in mortality, such as alcoholism, economic hardship, despression and so on, but there is still no one accepted as the most significant factor of the mortality crisis. Let's find out.","2a5fdb3f":"We'll map the suicide rate afterward, so we need to transfer the country name into country code.\nWe choose alpha3 country code.","8c61546b":"Define a new dataframe. The columns are country code and suicide rate.","9e554abf":"From this image we can see that the gdp_per_capita has no differece during 1990 to 2000. In other words, the economic situation were remain stagnant and  some countries got worse until 2002, after 2005, all countries' gdp start growing. \n\nWe also know that the whole gdp_per_capita dropped within 2008 because of the financial crisis.  However, these ratio were still better than that before 2000. To see the relationship between suicide rate and gdp_per_capita, we plot the regression plot of two parameters. ","d50ab03f":"Although the suicide rate of the elderly has improved, the rate of young people is still not low. This shows that the social pressure haven't been relieved.","a6c02ffe":"Plot the age structure of Japan.","cc973d02":"Let's see the performance of sex. ","64e2708d":"What's going on with old people in Korea!? After 2000, the suicide rate of people over 75 years old is almost double. Was Korea society not friendly to the old people or the enviroment depressed the old people? As we mentioned early, age is a factor of high suicide rate. A country should setup social welfare to take care of old people just in case.\n\nOn the other hand, the rate of people whose age is over 24 are growing after 1992. This phenomenon reflects the increasing burden on society, like salary,  academic pressure, family and so on.","35d9670f":"We found that there are four country names are different, so we rename these names.","fdcd3349":"Obviously, the suicide rate is getting higher when the age is higher. That is, age is a factor of suicide. ","d0b8db0a":"Last but not least, how about the countries with high suicide rate not related to the gdp_per_capita!? Let's see which countries meet the condition.","e39db756":"Amazing! The suicide rate is highly correlated to the gdp_per_capita of top10 countries. Let's find out whether others have the same trend. \n","275ce0f9":"Merge two dataframe together.","9b92566c":"result = pd.merge(world, new_country_df, on = \"iso_a3\")\nresult.head()","84fb64f8":"About one third countries have high relationship with gdp_per_capita. We can say that gdp is another reason of high suicide rate.","ded8bb44":"We arange the country list and see how many countries are in the dataset, then calculate the suicide rate of countries.","5aa18802":"Let's see how many csv files are in this topic.\n","68d50447":"For top 10, seven tenth were former Soviet Union countries, located in eastern europe and Russia. Japan and Korea are also high-suicide-rate countries. Let's talk about the disintegration of Soviet Union.\n\nFirstly, see what happened to the suicide rate year by year.","e810f06c":"OK! We can plot the top 20 countries.","6e5f0234":"Rename the columns.","7a54bbb5":"It's weird that the gdp_per_capita and suicide rate of Korea are growing faster. Does it mean that there are social problems that cause the situation like that!? ","67ad1923":"Then we replace the keys of dictionary with alpha3 country code.","c8974604":"Only one file in this topic. take a look at the dataset.","4d492b92":"Following are the countries which relation coefficient are higher than 0.6 .","1a278d00":"Before 2000, we can see that the highest suicide rate is G.I. generation, and this generation is also known as WW2 generation. They suffered from the worldwide great depression before WW2, at this time, the income, profit, taxes are decreased seriously, so this generation experienced economic and social turmoil.\n\nDid this kind of social impact affect the suicide rate of G.I. generation? Compare to the Silent generation after 2000, the suicide rate is not that high. \n\nInterestingly, the suicide rate of Generation X and Millenials increase step by step. Besides, the suicide rate increases rapidly once the average age of generation is over 20. Does it mean that the suicide rate of young persons rise when they are independent of their parents? In other words, healthy family is helpful to the suicide rate. Let's take a look.","92e79548":"## Introduction\nThe suicide rate in lots of countries have been quite high for many years, including the developing and developed countries. At the begining, we'll see the suicide rate of sex, and then the age and generation. Next we'll plot the rank of suicide rate, it's clearly to understand the distribution of the suicide rate. Finally, we'll find out the key factors of high suicide rate.","b4666778":"## Conclusion\nIn general, the suicide rate is related to several factors. First, national GDP per person. We have seen that the suicide rate in many countries is highly correlated with the gdp of the whole country, which shows that the degree of national wealth has a certain degree of reduction in suicide rate.\n\nSecond, the age. According to the suicide rate of each level of age, the rate of elderly is higher, so young people should care more about the elderly. Moreover, the country welfare of the elderly may also impact the rate.\n\nThird, the social pressure. A healthy society can make citizens feel safe and satisfied, so how to relieve the social pressure becomes a significant topic for every country. Our purpose is not only reduce the suicide rate but also to build a better world.","18d9369b":"Lots of countries' suicide rate are negatively high related to gdp_per_capita, but there are some countries have opposite outcome. It's impressive.\n\nNext, we calculate how many countries with correlation coefficient below -0.6 . ","09f6d2f0":"Let's take a look at suicide rate and gdp_per_capita of these countries."}}