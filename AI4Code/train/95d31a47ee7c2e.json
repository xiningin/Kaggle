{"cell_type":{"822a7120":"code","28e33899":"code","bc714fa3":"code","8dc13d39":"code","e5551d1f":"code","f49a2716":"code","554060ac":"code","2b42f92f":"code","0648b8a7":"code","8c8b1bef":"code","a0fee208":"code","19ccf80a":"code","7d9b49fa":"code","356250fa":"code","63ca5a2a":"code","19f8d36f":"code","a25cff9e":"code","9fa5f67d":"code","9986e90c":"code","0127b9f7":"code","2a8b5e08":"code","f8081554":"code","906473b6":"markdown","77cd2830":"markdown","c7fc491e":"markdown","17bb2169":"markdown"},"source":{"822a7120":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","28e33899":"df=pd.read_csv('..\/input\/spam-text-message-classification\/SPAM text message 20170820 - Data.csv')\ndf.head()","bc714fa3":"df['Category'].value_counts()","8dc13d39":"df['Category'].value_counts(normalize=True)","e5551d1f":"df['Category'] = df['Category'].map({'ham':0,'spam':1})","f49a2716":"df.head()","554060ac":"y=df['Category']\nX=df['Message']\nprint(y.shape,X.shape)","2b42f92f":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)","0648b8a7":"from sklearn.feature_extraction.text import CountVectorizer\nvect = CountVectorizer(stop_words='english')","8c8b1bef":"vect.fit(X_train)\nX_traint= vect.transform(X_train)\nX_testt= vect.transform(X_test)","a0fee208":"X_traint.shape","19ccf80a":"vect.get_stop_words()","7d9b49fa":"from sklearn.metrics import accuracy_score,roc_auc_score,confusion_matrix,roc_curve","356250fa":"from sklearn.naive_bayes import MultinomialNB\nmnb= MultinomialNB()","63ca5a2a":"mnb.fit(X_traint,y_train)\n\ny_train_pred=mnb.predict(X_traint)\ny_train_prob=mnb.predict_proba(X_traint)[:,1]\n\nprint('Train')\nprint('Confusion Matrix:\\n',confusion_matrix(y_train,y_train_pred))\nprint('\\nAccuracy Score:',accuracy_score(y_train,y_train_pred))\nprint('AUC:',roc_auc_score(y_train,y_train_prob))","19f8d36f":"y_test_pred=mnb.predict(X_testt)\ny_test_prob=mnb.predict_proba(X_testt)[:,1]\n\nprint('Test')\nprint('Confusion Matrix:\\n',confusion_matrix(y_test,y_test_pred))\nprint('\\nAccuracy Score:',accuracy_score(y_test,y_test_pred))\nprint('AUC:',roc_auc_score(y_test,y_test_prob))","a25cff9e":"fpr,tpr,thresholds = roc_curve(y_test,y_test_prob)","9fa5f67d":"thresholds[0]=thresholds[0]-1","9986e90c":"plt.plot(fpr,tpr,\"b\")\nplt.plot(fpr,fpr,\"g\")\nplt.plot(fpr,thresholds,'r')\nplt.show()","0127b9f7":"spm = pd.DataFrame({'fpr':fpr,'tpr':tpr,'thresholds':thresholds})\nspm.head()","2a8b5e08":"spm[spm['fpr']==0]","f8081554":"spm[(spm['fpr']==0) & (spm['tpr']>0.5)]","906473b6":"There are 7003 features (words) in the object vect, it will count how many times each feature occurs in one sentence and fills that row. This is done for all 3900 rows.","77cd2830":"## Vectorizing the Messages","c7fc491e":"## Naive Bayes Classification Model","17bb2169":"So here if the probability of the mail being a spam is greater than 0.986659, it will be classified as spam else it will be ham."}}