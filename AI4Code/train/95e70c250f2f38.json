{"cell_type":{"08a0ae02":"code","7c6436b4":"code","52ac2ed5":"code","a244ca1f":"code","42b708e6":"code","81c3bd4c":"code","e98951d4":"code","5111487e":"code","64b9bf1b":"code","c135dbae":"code","ae2e887e":"code","165e6b20":"code","815c59eb":"code","5a894884":"code","47c9e5b8":"code","a8637d95":"code","6ef2e40a":"code","3aa9d3db":"code","afbd30da":"code","d3992bf7":"code","3cd4b629":"code","38853ea0":"markdown","8e74d09e":"markdown","755e811b":"markdown","2e5ad98f":"markdown","38eb5342":"markdown","ae64c1f0":"markdown","2528ac15":"markdown","5cd30f0c":"markdown","02e3506c":"markdown","a531b3a0":"markdown","6da1dd17":"markdown","a43fb6da":"markdown","7ca23449":"markdown","8d29a9ad":"markdown"},"source":{"08a0ae02":"# Importing libraries\nimport nltk\nimport numpy as np\nimport pandas as pd\nimport pprint, time\nimport random\nfrom sklearn.model_selection import train_test_split\nfrom nltk.tokenize import word_tokenize\nimport math","7c6436b4":"# reading the Treebank tagged sentences\nwsj = list(nltk.corpus.treebank.tagged_sents())","52ac2ed5":"# samples: Each sentence is a list of (word, pos) tuples\nwsj[:3]","a244ca1f":"# converting the list of sents to a list of (word, pos tag) tuples\ntagged_words = [tup for sent in wsj for tup in sent]\nprint(len(tagged_words))\ntagged_words[:10]","42b708e6":"# question 1: Find the number of unique POS tags in the corpus\n# you can use the set() function on the list of tags to get a unique set of tags, \n# and compute its length\ntags = [pair[1] for pair in tagged_words]\nunique_tags = set(tags)\nlen(unique_tags)","81c3bd4c":"# question 2: Which is the most frequent tag in the corpus\n# to count the frequency of elements in a list, the Counter() class from collections\n# module is very useful, as shown below\n\nfrom collections import Counter\ntag_counts = Counter(tags)\ntag_counts","e98951d4":"# the most common tags can be seen using the most_common() method of Counter\ntag_counts.most_common(5)","5111487e":"# list of POS tags in NLTK\nnltk.help.upenn_tagset()","64b9bf1b":"# question 3: Which tag is most commonly assigned to the word w.\nbank = [pair for pair in tagged_words if pair[0].lower() == 'bank']\nbank","c135dbae":"# question 3: Which tag is most commonly assigned to the word w.\nexecutive = [pair for pair in tagged_words if pair[0].lower() == 'executive']\nexecutive","ae2e887e":"# 4. how many words with the tag 'VBD' (verb, past tense) end with 'ed'\npast_tense_verbs = [pair for pair in tagged_words if pair[1]=='VBD']\ned_verbs = [pair for pair in past_tense_verbs if pair[0].endswith('ed')]\nprint(len(ed_verbs) \/ len(past_tense_verbs))\ned_verbs[:20]","165e6b20":"# 5. how many words with the tag 'VBG' end with 'ing'\nparticiple_verbs = [pair for pair in tagged_words if pair[1]=='VBG']\ning_verbs = [pair for pair in participle_verbs if pair[0].endswith('ing')]\nprint(len(ing_verbs) \/ len(participle_verbs))\ning_verbs[:20]","815c59eb":"# question: what fraction of adjectives JJ are followed by a noun NN\n\n# create a list of all tags (without the words)\ntags = [pair[1] for pair in tagged_words]\n\n# create a list of JJ tags\njj_tags = [t for t in tags if t == 'JJ']\n\n# create a list of (JJ, NN) tags\njj_nn_tags = [(t, tags[index+1]) for index, t in enumerate(tags) \n              if t=='JJ' and tags[index+1]=='NN']\n\nprint(len(jj_tags))\nprint(len(jj_nn_tags))\nprint(len(jj_nn_tags) \/ len(jj_tags))","5a894884":"# question: what fraction of determiners DT are followed by a noun NN\ndt_tags = [t for t in tags if t == 'DT']\ndt_nn_tags = [(t, tags[index+1]) for index, t in enumerate(tags) \n              if t=='DT' and tags[index+1]=='NN']\n\nprint(len(dt_tags))\nprint(len(dt_nn_tags))\nprint(len(dt_nn_tags) \/ len(dt_tags))","47c9e5b8":"# question: what fraction of modals MD are followed by a verb VB?\nmd_tags = [t for t in tags if t == 'MD']\nmd_vb_tags = [(t, tags[index+1]) for index, t in enumerate(tags) \n              if t=='MD' and tags[index+1]=='VB']\n\nprint(len(md_tags))\nprint(len(md_vb_tags))\nprint(len(md_vb_tags) \/ len(md_tags))","a8637d95":"# splitting into train and test\nrandom.seed(1234)\ntrain_set, test_set = train_test_split(wsj, test_size=0.3)\n\nprint(len(train_set))\nprint(len(test_set))\nprint(train_set[:2])","6ef2e40a":"# Lexicon (or unigram tagger)\nunigram_tagger = nltk.UnigramTagger(train_set)\nunigram_tagger.evaluate(test_set)","3aa9d3db":"# specify patterns for tagging\n# example from the NLTK book\npatterns = [\n    (r'.*ing$', 'VBG'),              # gerund\n    (r'.*ed$', 'VBD'),               # past tense\n    (r'.*es$', 'VBZ'),               # 3rd singular present\n    (r'.*ould$', 'MD'),              # modals\n    (r'.*\\'s$', 'NN$'),              # possessive nouns\n    (r'.*s$', 'NNS'),                # plural nouns\n    (r'^-?[0-9]+(.[0-9]+)?$', 'CD'), # cardinal numbers\n    (r'.*', 'NN')                    # nouns\n]","afbd30da":"regexp_tagger = nltk.RegexpTagger(patterns)\n# help(regexp_tagger)","d3992bf7":"regexp_tagger.evaluate(test_set)","3cd4b629":"# rule based tagger\nrule_based_tagger = nltk.RegexpTagger(patterns)\n\n# lexicon backed up by the rule-based tagger\nlexicon_tagger = nltk.UnigramTagger(train_set, backoff=rule_based_tagger)\n\nlexicon_tagger.evaluate(test_set)","38853ea0":"Thus, NN is the most common tag followed by IN, NNP, DT, -NONE- etc. You can read the exhaustive list of tags using the NLTK documentation as shown below.","8e74d09e":"### 3.2 Lexicon (Unigram) Tagger\n\nLet's now try training a lexicon (or a unigram) tagger which assigns the most commonly assigned tag to a word. \n\nIn NLTK, the `UnigramTagger()`  can be used to train such a model.","755e811b":"## 3. Lexicon and Rule-Based Models for POS Tagging\n\nLet's now see lexicon and rule-based models for POS tagging. We'll first split the corpus into training and test sets and then use built-in NLTK taggers. \n\n### 3.1 Splitting into Train and Test Sets","2e5ad98f":"### 2. Exploratory Analysis\n\nLet's now conduct some basic exploratory analysis to understand the tagged corpus. To start with, let's ask some simple questions:\n1. How many unique tags are there in the corpus? \n2. Which is the most frequent tag in the corpus?\n3. Which tag is most commonly assigned to the following words:\n    - \"bank\"\n    - \"executive\"\n","38eb5342":"## 2. Exploratory Analysis Continued\n\nLet's now try observing some tag patterns using the fact the some tags are more likely to apper after certain other tags. For e.g. most nouns NN are usually followed by determiners DT (\"The\/DT constitution\/NN\"), adjectives JJ usually precede a noun NN (\" A large\/JJ building\/NN\"), etc. \n\nTry answering the following questions:\n1. What fraction of adjectives JJ are followed by a noun NN? \n2. What fraction of determiners DT are followed by a noun NN?\n3. What fraction of modals MD are followed by a verb VB?","ae64c1f0":"### 3.4 Combining Taggers\n\nLet's now try combining the taggers created above. We saw that the rule-based tagger by itself is quite ineffective since we've only written a handful of rules. However, if we could combine the lexicon and the rule-based tagger, we can potentially create a tagger much better than any of the individual ones.\n\nNLTK provides a convenient way to combine taggers using the 'backup' argument. In the following code, we create a regex tagger which is used as a backup tagger to the lexicon tagger, i.e. when the tagger is not able to tag using the lexicon (in case of a new word not in the vocabulary), it uses the rule-based tagger. \n\nAlso, note that the rule-based tagger itself is backed up by the tag 'NN'.\n","2528ac15":"## POS Tagging - Lexicon and Rule Based Taggers\n\nLet's look at the two most basic tagging techniques - lexicon based (or unigram) and rule-based. \n\nIn this guided exercise, you will explore the WSJ (wall street journal) POS-tagged corpus that comes with NLTK and build a lexicon and rule-based tagger using this corpus as the tarining data. \n\nThis exercise is divided into the following sections:\n1. Reading and understanding the tagged dataset\n2. Exploratory analysis\n3. Lexicon and rule-based models:\n    - Creating and evaluating a lexicon POS tagger\n    - Creating and evaluating a rule-based POS tagger","5cd30f0c":"Thus, we see that the probability of certain tags appearing after certain other tags is quite high, and this fact can be used to build quite efficient POS tagging algorithms. ","02e3506c":"In the list mentioned above, each element of the list is a sentence. Also, note that each sentence ends with a full stop '.' whose POS tag is also a '.'. Thus, the POS tag '.' demarcates the end of a sentence.\n\nAlso, we do not need the corpus to be segmented into sentences, but can rather use a list of (word, tag) tuples. Let's convert the list into a (word, tag) tuple.","a531b3a0":"### 3.3. Rule-Based (Regular Expression) Tagger\n\nNow let's build a rule-based, or regular expression based tagger. In NLTK, the `RegexpTagger()` can be provided with handwritten regular expression patterns, as shown below.\n\nIn the example below, we specify regexes for gerunds and past tense verbs (as seen above), 3rd singular present verb (creates, moves, makes etc.), modal verbs MD (should, would, could), possesive nouns (partner's, bank's etc.), plural nouns (banks, institutions), cardinal numbers CD and finally, if none of the above rules are applicable to a word, we tag the most frequent tag NN.  ","6da1dd17":"### 2. Exploratory Analysis Contd.\n\nUntil now, we were looking at the frequency of tags assigned to particular words, which is the basic idea used by lexicon or unigram taggers. Let's now try observing some rules which can potentially be used for POS tagging. \n\nTo start with, let's see if the following questions reveal something useful:\n\n4. What fraction of words with the tag 'VBD' (verb, past tense) end with the letters 'ed'\n5. What fraction of words with the tag 'VBG' (verb, present participle\/gerund) end with the letters 'ing'","a43fb6da":"We now have a list of about 100676 (word, tag) tuples. Let's now do some exploratory analyses.","7ca23449":"### 1. Reading and understanding the tagged dataset","8d29a9ad":"Even a simple unigram tagger seems to perform fairly well. "}}