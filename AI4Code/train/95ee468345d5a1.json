{"cell_type":{"41185be5":"code","6f2c9458":"code","e0034f79":"code","44ed4c08":"code","12912c29":"code","03d9a225":"code","795ef956":"code","beeaf7a3":"code","11ae8989":"code","614948a7":"code","b78df6ad":"code","99616492":"code","46adb17b":"code","c5c6ae2e":"code","7ed1f77e":"code","299f8526":"code","73d6a667":"markdown","27449ff9":"markdown","1c6f428a":"markdown","4b090c25":"markdown","9f49495f":"markdown","f7af4366":"markdown","40c53337":"markdown","5d354c70":"markdown","b0a6cc12":"markdown","257969a6":"markdown","66ce8154":"markdown","a5f26e8c":"markdown","d46bb0b3":"markdown","46b34a92":"markdown","40947d11":"markdown","be27d301":"markdown"},"source":{"41185be5":"import os\nimport pandas as pd\nfrom fastai.text.all import *","6f2c9458":"# Defining where it stored:\npath = \"..\/input\/can-generate-automatic-commentary-for-ipl-cricket\/IPL_Match_Highlights_Commentary.csv\"\n\n# Taking a look at it:\ndata = pd.read_csv(path)\ndata.head(3)","e0034f79":"os.makedirs(\".\/input\", exist_ok = False)","44ed4c08":"# Taking a look at the shape of the csv\ndata.shape","12912c29":"for i in range(10790):\n    commentary = data.Commentary[i]               # This is the text of row 'i'.\n    f = open(\".\/input\/\" + str(i) + \".txt\", \"w\")   # This writes a new text file.\n    f.write(commentary)                             \n    f.close()                                     # This saves it.","03d9a225":"f = open(\".\/input\/0.txt\", \"r\")\nprint(f.read())","795ef956":"# Grabbing the text files now:\n\ninputpath = \".\/input\"\ntextfiles = get_text_files(inputpath)","beeaf7a3":"get_comments = partial(get_files)","11ae8989":"commentary_loader = DataBlock(\n    blocks = TextBlock.from_folder(inputpath, is_lm = True),\n    get_items = get_comments, splitter = RandomSplitter(0.1)\n).dataloaders(inputpath, path = inputpath, bs = 64, seq_len = 70)","614948a7":"commentary_loader.show_batch(max_n = 2)","b78df6ad":"learn = language_model_learner(commentary_loader, AWD_LSTM, drop_mult = 0.3, metrics = accuracy).to_fp16()","99616492":"learn.fit_one_cycle(5, 2e-2)","46adb17b":"learn.fit_one_cycle(5, 1e-2)","c5c6ae2e":"learn.predict(\"and there goes the ball towards\", 20, temperature = 0.5)","7ed1f77e":"learn.predict(\"the ball flies\", 20, temperature = 0.7)","299f8526":"learn.predict(\"Gayle hits\", 20, temperature = 0.89)","73d6a667":"# Introducing the Data:\nImporting Libraries, then taking the data out to look at it.","27449ff9":"Producing the <font color = 'orange'>DataLoader<\/font> which we will load on to the learner to train the model on:","1c6f428a":"Since there are 10,790 rows or examples, lets grab them and convert them into text files that we will store in our new folder:","4b090c25":"Yes we did.","9f49495f":"# Training\nFinally <font color = 'orange'>training the model<\/font>. \nWe train it for 10 epochs with learning rates of 0.02 for the first half and  0.01 for the second one.","f7af4366":"# Predicting \nThis might become your favourite part since we predict here.","40c53337":"In this notebook, lets try to use the <font color = 'blue'>transcripts of commentaries<\/font> of the <font color = 'blue'>past 12 years<\/font> given in the IPL. We will be attempting to create a Language Model which can do basic sentence formation around the commentary.","5d354c70":"# Table of Content\n\n## 1. Introducing the Data\n## 2. Preprocessing\n## 3. Training \n## 4. Predicting","b0a6cc12":"Taking a look at the data:","257969a6":"# Preprocessing\nWe read and play around the with the files in this section.","66ce8154":"Cricket is the most popular sport in the Indian subcontinent. Every year millions of people in India and from across the world flock to screens and stadiums to watch the IPL. \nThe <font color = 'blue'>Indian Premier League<\/font> is the arguably the most anticipated event of the year in India. Several teams with celebrity cricketers participate and compete with each other. \n\n![](https:\/\/hdsportsnews.com\/wp-content\/uploads\/2020\/01\/1578248592_vivo-ipl-2020-schedule-pdf-download-time-table-match-list-date.jpg)\n","a5f26e8c":"In Conclusion: It works decently with an accuracy of 47% which means it can make a legible sentence half the time.\n\nThis will be the end of this notebook. I am grateful for you taking out time to learn deep learning and going through this notebook. If you liked it, an upvote will be appreciated. I hope you have a nice day! :)","d46bb0b3":"Using the <font color = 'green'>FastAI Library<\/font> here because of its ability to give state of the art results and feasibility in Natural Language Processing. OS will be used to transfer files. While Pandas is our usual.","46b34a92":"Reading the data in the csv file:","40947d11":"Kaggle does not allow me to write in the files that it provides in default so we will be creating a new folder in the Output section. We don't have any text files so we will be extracting the text data from the csv. For that we will be using OS to create a new folder first:","be27d301":"Lets look at the first one to see if we got it right:"}}