{"cell_type":{"12041b19":"code","f20ea51b":"code","d30ed6e4":"code","048176b7":"code","ff70ae23":"code","b1026249":"code","b419c6f1":"code","f95931b2":"code","557f4712":"code","3e175c62":"code","16479536":"code","ba0834d8":"code","f734b213":"code","aabbfe64":"code","3d443efe":"code","b38fd87e":"code","2c52b939":"code","98f57014":"code","294968e5":"code","c6dce65e":"code","4571d044":"code","d03539e3":"code","c4d563b6":"code","b3fbf1b8":"code","2f602cb5":"code","134f5fe7":"code","6a40cbf5":"code","3298560b":"code","79feda53":"code","91833aed":"code","7cc4d520":"code","d7a42181":"code","d2b18bcf":"code","14d581a0":"code","9e63ae2b":"code","52e19a57":"code","580efb41":"code","7fd6b7f9":"code","e7687ef6":"code","54f099cf":"code","96def105":"code","0d4e52db":"code","a8adaaf1":"code","0b355c74":"code","4a2e7e47":"code","6a365bdf":"code","7286447f":"code","d293e2f7":"code","36991ac9":"code","4adbb32a":"code","525a7ca6":"code","8091ad99":"code","cd467898":"code","15b3ad05":"code","baec4f3c":"code","491e96b6":"code","57558763":"code","9135341a":"code","c028cf2c":"code","53840468":"code","58edd73d":"code","31f4f8c8":"markdown","06362b10":"markdown","60f540fe":"markdown","5a96128a":"markdown","4b705422":"markdown","63740298":"markdown","b796dc13":"markdown","ddf7af30":"markdown","64b69d3a":"markdown","581cdece":"markdown","4f25887c":"markdown","57ecb726":"markdown","3d4b0fc0":"markdown","9ef9e95d":"markdown","a38cdefe":"markdown","f237352d":"markdown","529c2883":"markdown","4ee5b3a6":"markdown"},"source":{"12041b19":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings(\"ignore\")","f20ea51b":"train_df=pd.read_csv(\"..\/input\/predicting-pulsar-starintermediate\/pulsar_data_train.csv\")\ntest_df=pd.read_csv(\"..\/input\/predicting-pulsar-starintermediate\/pulsar_data_test.csv\")","d30ed6e4":"train_df.head()","048176b7":"test_df.head()","ff70ae23":"train_df.shape","b1026249":"test_df.shape","b419c6f1":"train_df.describe()","f95931b2":"train_df.info()","557f4712":"train_df.isnull().sum()","3e175c62":"plt.figure(figsize=(12,12))\ntrain_df.boxplot(rot=90)","16479536":"def boxPlotter(dataset, columnName):\n    sns.catplot(x=\"target_class\", y=columnName, data=dataset, kind=\"box\");\nfor column in train_df.drop(\"target_class\",axis=1).columns:\n    boxPlotter(train_df, column)","ba0834d8":"train_df.columns","f734b213":"#columns Rename\ntrain_df.rename({' Mean of the integrated profile':\"integrated_profile_Mean\",\n                ' Standard deviation of the integrated profile':\"integrated_profile_Std\",\n                 ' Excess kurtosis of the integrated profile':\"integrated_profile_Excess\",\n                 ' Skewness of the integrated profile':\"integrated_profile_Skewness\",\n                 ' Mean of the DM-SNR curve':\"DM-SNR_Mean\",\n                 ' Standard deviation of the DM-SNR curve':\"DM-SNR_Std\",\n                 ' Excess kurtosis of the DM-SNR curve':\"DM-SNR_Excess\",\n                 ' Skewness of the DM-SNR curve':\"DM-SNR_Skewness\",\n                }, inplace=True,axis=1)","aabbfe64":"train_df.columns","3d443efe":" round(train_df['target_class'].value_counts()\/train_df.shape[0]*100,2).plot.pie(autopct='%1.1f%%',shadow=True, startangle=30,explode = [0.0, 0.2])","b38fd87e":"sns.pairplot(data = train_df , hue = 'target_class', corner = True)","2c52b939":"sns.displot(data=train_df, x=\"integrated_profile_Mean\",hue=train_df[\"target_class\"], kind=\"kde\")","98f57014":"sns.displot(data=train_df, x=\"integrated_profile_Std\",hue=train_df[\"target_class\"], kind=\"kde\")","294968e5":"sns.displot(data=train_df, x=\"integrated_profile_Excess\",hue=train_df[\"target_class\"], kind=\"kde\")","c6dce65e":"sns.displot(data=train_df, x=\"integrated_profile_Skewness\",hue=train_df[\"target_class\"], kind=\"kde\")","4571d044":"sns.displot(data=train_df, x=\"DM-SNR_Mean\",hue=train_df[\"target_class\"], kind=\"kde\")","d03539e3":"sns.displot(data=train_df, x=\"DM-SNR_Std\",hue=train_df[\"target_class\"], kind=\"kde\")","c4d563b6":"sns.displot(data=train_df, x=\"DM-SNR_Excess\",hue=train_df[\"target_class\"], kind=\"kde\")","b3fbf1b8":"sns.displot(data=train_df, x=\"DM-SNR_Skewness\",hue=train_df[\"target_class\"], kind=\"kde\")","2f602cb5":"mask=np.triu(np.ones_like(train_df.corr(),dtype=bool))\n\nplt.figure(figsize=(10,8))\nsns.heatmap(train_df.corr(),annot=True,mask=mask,cmap= \"vlag\")","134f5fe7":"train_df.corr()[\"target_class\"].sort_values(ascending=False)","6a40cbf5":"train_df.isnull().sum()","3298560b":"test_df.isnull().sum()","79feda53":"test_df.shape","91833aed":"sns.heatmap(train_df.isnull())\n","7cc4d520":"train_df = train_df.ffill().add(train_df.bfill()).div(2)","d7a42181":"test_df = test_df.ffill().add(test_df.bfill()).div(2)","d2b18bcf":"train_df.isnull().sum()","14d581a0":"test_df.isnull().sum()","9e63ae2b":"plt.figure(figsize=(10,8))\ntrain_df.boxplot(rot=90)","52e19a57":"train_df.plot(kind = \"box\" , subplots = True , figsize = (18,15) ,  layout = (3,4))\nplt.show()\n","580efb41":"train_df.columns","7fd6b7f9":"def find_outliers(x):\n    q1 = np.percentile(x, 25)\n    q3 = np.percentile(x, 75)\n    iqr = q3-q1 \n    floor = q1 - 1.5*iqr\n    ceiling = q3 + 1.5*iqr\n\n    return ceiling,floor","e7687ef6":"for col in train_df.columns[:-1]:\n    ur,lr=find_outliers(train_df[col])\n    print(\"For: \",col,\":\")\n    d=train_df.shape[0]-train_df[(train_df[col]>=lr) & (train_df[col]<=ur) ].shape[0]\n    print(\"length of outliers data= \",d)\n    print(\"percentage of outliers data= {:0.2f} %\".format((d\/train_df.shape[0])*100))\n    print(\"__________________________________________________________________________\")","54f099cf":"for col in train_df.columns[:-1]:\n    ur,lr=find_outliers(train_df[col])\n    train_df[col]=np.where(train_df[col]>ur,ur,train_df[col])\n    train_df[col]=np.where(train_df[col]<lr,lr,train_df[col])","96def105":"plt.figure(figsize=(10,8))\ntrain_df.boxplot(rot=90)","0d4e52db":"df=train_df.copy()","a8adaaf1":"from sklearn.model_selection import train_test_split","0b355c74":"X=df.drop(\"target_class\",axis=1)\nY=df[\"target_class\"]","4a2e7e47":"Y.value_counts()","6a365bdf":"#! pip install -U imbalanced-learn","7286447f":"from imblearn.over_sampling import SMOTE\n\nsmote =SMOTE(sampling_strategy=\"minority\")\n\nx_sm,y_sm= smote.fit_resample(X,Y)\ny_sm.value_counts()","d293e2f7":"y_sm.shape","36991ac9":"x_sm.shape","4adbb32a":"X_train , X_test , Y_train , Y_test = train_test_split(x_sm,y_sm, test_size=0.25 , random_state=42)","525a7ca6":"from sklearn.preprocessing import StandardScaler\nss = StandardScaler()\nX_train = ss.fit_transform(X_train)\nX_test = ss.fit_transform(X_test)","8091ad99":"from sklearn.model_selection import GridSearchCV\nfrom sklearn.svm import SVC\nfrom sklearn.metrics import accuracy_score,confusion_matrix,classification_report,plot_confusion_matrix,ConfusionMatrixDisplay,roc_curve , roc_auc_score,plot_roc_curve\n","cd467898":"svc_rbf = SVC(random_state=0,C=100, gamma=10 , kernel='rbf',probability=True)\nsvc_rbf.fit(X_train, Y_train)\ny_pred_svc_rbf = svc_rbf.predict(X_test)\nprint('Model accuracy score: {0:0.4f}'. format(accuracy_score(Y_test, y_pred_svc_rbf)))","15b3ad05":"# Check for overfitting and underfitting\nprint(f\"Training Data Score: {svc_rbf.score(X_train, Y_train)}\")\nprint(f\"Testing Data Score: {svc_rbf.score(X_test, Y_test)}\")","baec4f3c":"print(classification_report(Y_test, y_pred_svc_rbf))\ncm2 = confusion_matrix(Y_test, y_pred_svc_rbf)\ndisp = ConfusionMatrixDisplay(cm2).plot(cmap=plt.cm.Blues)","491e96b6":"plot_roc_curve(svc_rbf, X_test, Y_test)","57558763":"svc_linear = SVC(random_state=0,C=100,gamma=10,kernel='linear')\nsvc_linear.fit(X_train, Y_train)\ny_pred_svc_linear = svc_linear.predict(X_test)","9135341a":"print('Model accuracy score: {0:0.4f}'. format(accuracy_score(Y_test, y_pred_svc_linear)))","c028cf2c":"# Check for overfitting and underfitting\nprint(f\"Training Data Score: {svc_linear.score(X_train, Y_train)}\")\nprint(f\"Testing Data Score: {svc_linear.score(X_test, Y_test)}\")\n","53840468":"print(classification_report(Y_test, y_pred_svc_linear))\ncm2 = confusion_matrix(Y_test, y_pred_svc_linear)\ndisp = ConfusionMatrixDisplay(cm2).plot(cmap=plt.cm.Blues)","58edd73d":"plot_roc_curve(svc_linear, X_test, Y_test)","31f4f8c8":"   ### SVM model","06362b10":" # Modeling","60f540fe":"- **High correlation with target_class:**\n    - `Excess kurtosis of the integrated profile`>> 0.79\n    - `Skewness of the integrated profile`  >> 0.71\n    - `Mean of the integrated profile`>> -0.68 (Negative correlation)\n    - `Standard deviation of the DM-SNR curve` >> 0.5\n","5a96128a":"________________________________________","4b705422":"# scalling","63740298":"__SVM model with rbf kernel__","b796dc13":"- \"Excess kurtosis of the integrated profile\" >> 1735 null value\n- \"Standard deviation of the DM-SNR curve \" >> 1178 null value\n- \"Skewness of the DM-SNR curve\" >> 625 null value","ddf7af30":"- columns \"Mean of the integrated profile\",\"Standard deviation of the integrated profile\",\"Excess kurtosis of the DM-SNR curve\":  almost have a normal distribution. as the mean is close to median .\n\n- columns\"Mean of the integrated profile\",\"Mean of the DM-SNR curve\",\"Standard deviation of the DM-SNR curve\",\"Skewness of the DM-SNR curve\": std is large as there are large difference between min and max. that indicates the values are widespread in relationship to the mean.\n\n","64b69d3a":"# EDA","581cdece":"- **High correlation between:**\n    - `Skewness of the integrated profile` & `Excess kurtosis of the integrated profile`  >> 0.94\n    - `Skewness of the DM-SNR curve` & `Excess kurtosis of the DM-SNR curve`  >> 0.92\n    - `Mean of the DM-SNR curve` & `Standard deviation of the DM-SNR curve`  >> 0.8\n\n","4f25887c":"# Dealing with imbalancing","57ecb726":"# 2.dealing with outliears","3d4b0fc0":"__SVM model with linear kernel__","9ef9e95d":"# Data Preprocessing","a38cdefe":"# Split target feature","f237352d":"### 1. Filling Missing values","529c2883":"##### The data has:\n- 12528 sample \n- 9 columns\n- all the columns are numerical(float).\n- there are null values in \n\n    1-\"Excess kurtosis of the integrated profile\" \n    \n    2-\"Standard deviation of the DM-SNR curve \" \n    \n    3-\"Skewness of the DM-SNR curve\" columns","4ee5b3a6":"dataset is implanced \n- 0 class >> 90.8% \n- 1 class >> 9.2%\n\n0 class is very large than 1 class"}}