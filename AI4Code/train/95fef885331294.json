{"cell_type":{"a95a7781":"code","5e0f9736":"code","35474952":"code","60862b38":"code","7c9f55e0":"code","f870718e":"code","8ef74003":"code","8f3a321e":"code","8f03dd30":"code","6e668770":"code","6edc7768":"code","a7ace41a":"markdown","41a5e871":"markdown","3a37b3b8":"markdown","6617410b":"markdown","a556f30a":"markdown","e7f96ae3":"markdown","c1de304d":"markdown","12d2bcee":"markdown","f0ebf59c":"markdown","da1ef77a":"markdown","59611e49":"markdown","1c2b1dc4":"markdown","0fdbe1dc":"markdown","abd8df0b":"markdown","79084e61":"markdown","226132b0":"markdown","f2bf7b3d":"markdown","4348a1b2":"markdown","7c7a2f21":"markdown","9a4b7c2a":"markdown","b1d799e6":"markdown","db49abfc":"markdown","13e6075e":"markdown","22c7874f":"markdown","99158c8c":"markdown","5b2994e2":"markdown","75350d4b":"markdown","efc3d8ef":"markdown","f3982010":"markdown"},"source":{"a95a7781":"import matplotlib.pyplot as plt\nimport cv2\n%matplotlib inline","5e0f9736":"import os\ntrain_path = '\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/train\/NORMAL\/'\nimages = os.listdir(train_path)","35474952":"normal_img =  cv2.imread('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/train\/NORMAL\/IM-0372-0001.jpeg')\nplt.imshow(normal_img)\nplt.title('Normal Patient X RAY')","60862b38":"pneu_img = cv2.imread('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/train\/PNEUMONIA\/person1548_virus_2689.jpeg')\nplt.imshow(pneu_img)\nprint('x ray of pneumonia patient')","7c9f55e0":"import numpy\nimport tensorflow\nimport tensorflow\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Conv2D\nfrom tensorflow.keras.layers import MaxPooling2D\nfrom tensorflow.keras.layers import Flatten\nfrom tensorflow.keras.layers import Dense\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator, load_img\nfrom sklearn.metrics import classification_report, confusion_matrix","f870718e":"\n# let's build the CNN model\n\ncnn = Sequential()\n\n#Convolution\ncnn.add(Conv2D(32, (3, 3), activation=\"relu\", input_shape=(64, 64, 3)))\n\n#Pooling\ncnn.add(MaxPooling2D(pool_size = (2, 2)))\n\n# 2nd Convolution\ncnn.add(Conv2D(32, (3, 3), activation=\"relu\"))\n\n# 2nd Pooling layer\ncnn.add(MaxPooling2D(pool_size = (2, 2)))\n\n#3rd Convolution\ncnn.add(Conv2D(32,(3,3),activation='relu'))\n\n#3rd Pooling Layer\ncnn.add(MaxPooling2D(pool_size=(2,2)))\n\n# Flatten the layer\ncnn.add(Flatten())\n\n# Fully Connected Layers\ncnn.add(Dense(activation = 'relu', units = 128))\ncnn.add(Dense(activation = 'sigmoid', units = 1))\n\n# Compile the Neural network\ncnn.compile(optimizer = 'adam', loss = 'binary_crossentropy', metrics = ['accuracy'])","8ef74003":"num_of_test_samples = 600\nbatch_size = 32","8f3a321e":"# Fitting the CNN to the images\n# The function ImageDataGenerator augments your image by iterating through image as your CNN is getting ready to process that image\n\ntrain_datagen = ImageDataGenerator(rescale = 1.\/255,\n                                   shear_range = 0.2,\n                                   zoom_range = 0.2,\n                                   horizontal_flip = True)\n\ntest_datagen = ImageDataGenerator(rescale = 1.\/255)  #Image normalization.\n\ntraining_set = train_datagen.flow_from_directory('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/train\/',\n                                                 target_size = (64, 64),\n                                                 batch_size = 32,\n                                                 class_mode = 'binary')\n\nvalidation_generator = test_datagen.flow_from_directory('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/val\/',\n    target_size=(64, 64),\n    batch_size=32,\n    class_mode='binary')\n\ntest_set = test_datagen.flow_from_directory('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/test\/',\n                                            target_size = (64, 64),\n                                            batch_size = 32,\n                                            class_mode = 'binary')","8f03dd30":"cnn.summary()","6e668770":"cnn_model = cnn.fit_generator(training_set,\n                         steps_per_epoch = 163,\n                         epochs = 1,\n                         validation_data = validation_generator,\n                         validation_steps = 624)","6edc7768":"test_accu = cnn.evaluate_generator(test_set,steps=624)\nprint('The testing accuracy is :',test_accu[1]*100, '%')","a7ace41a":"# SUMMARY OF OUR MODEL","41a5e871":"# No need to be scared. If this looks intimidating don't worry, it is pretty easy to implement. ","3a37b3b8":"Computers, learn\/see in not such a different way from us. They will, however, need to look and analyze thousands upon thousands of images before they can generalize and say that a yellow umbrella falls under the same category as a black umbrella. This is because what they see are not pictures, but numerical representaions of pixels describing these pictures. So while we see 'things in pictures, a computer sees this","6617410b":"### OKAY ! SO WERE YOU ABLE TO SPOT DIFFERENCES ? ","a556f30a":"## SOME TERMS\n**Kernel** : In Convolutional neural network, the kernel is nothing but a filter that is used to extract the features from the images. The kernel is a matrix that moves over the input data, performs the dot product with the sub-region of input data, and gets the output as the matrix of dot products.\n\n**MAX POOLING** : \nMax pooling is a pooling operation that selects the maximum element from the region of the feature map covered by the filter. Thus, the output after max-pooling layer would be a feature map containing the most prominent features of the previous feature map.\n\n**STRIDE** : Stride just means the amount a filter moves during a covolution operation. So, a stride of 1 means that the filter will slide 1 pixel after each covolution operation as shown in this animation.","e7f96ae3":"Using Keras , we can easily implement CNN , lets start importing libraries","c1de304d":"So, Question is what is in this dataset and what we have to do : There are XRay images of ribcage of many pateints and there are two type of images :\n\n    1. Patients having Pneumonia\n    2.Those who are normal","12d2bcee":"# WHOW !! WE JUST MADE A CNN MODEL THAT CAN PREDICT PNEUMONIA WITH 85 PERCENT SURITY ! CONGO","f0ebf59c":"![image.png](attachment:image.png)","da1ef77a":"![image.png](attachment:image.png)","59611e49":"## STEPS INVLOVED IN CNN","1c2b1dc4":"THANKS , THAT IT IS FOR BASICS , I WOULD MAKE MORE CNN NOTEBOOKS ON EXCITING DATASETS , LET US LEARN TOGETHER","0fdbe1dc":"![image.png](attachment:image.png)","abd8df0b":"# MANIPULATING OUR DATA","79084e61":"* A convolution does this by multiplying two matrices and yielding a third, smaller matrix.\n* The Network takes an input image, and uses a filter (or kernel) to create a feature map describing the image.\n* In the convolution operation, we take a filter (usually 2x2 or 3x3 matrix ) and slide it over the image matrix. The coresponding numbers in both matrices are multiplied and and added to yield a single number describing that input space. This process is repeated all over the image.\n* We use different filters to pass over our inputs, and take all the feature maps, put them together as the final output of the convolutional layer.\n* We then pass the output of this layer through a non-linear activation function. The most commonly used one is ReLU.\n* The next step of our process involves further reducing the dimensionality of the data which will lower the computation power required for training this model. This is achieved by using a Pooling Layer. The most commonly used one is max pooling which takes the maximum value in the window created by a filter. This significantly reduces the training time and preserves significant information.","226132b0":"![image.png](attachment:image.png)","f2bf7b3d":"![image.png](attachment:image.png)","4348a1b2":"# HOW DOES COMPUTERS SEE IMAGES ???????????","7c7a2f21":"****but first how does humans see ?****\n\nWhen light hits the retina (a light-sensitive layer of tissue at the back of the eye), special cells called photoreceptors turn the light into electrical signals. These electrical signals travel from the retina through the optic nerve to the brain. Then the brain turns the signals into the images you see","9a4b7c2a":"# ENOUGH TALK ! SHOW ME THOSE IMAGES DUDE !\n","b1d799e6":"Well I am no expert in reading XRAYs and i cant tell what differences are there , Did You understand difference between normal and pneumonia's one ?\n\nSo , There are two ways to understand these XRAYS:\n\n### 1. Go to a medical school , spend lot of money , invest lot of time and then come again after years to read it , this seems quite hard though\n### 2. Watch all the images , look for patterns in both classes and understand those differences and then come again to visualise and understand it ","db49abfc":"Let us do the second one but rather let us computer do us for it , we just have to write codes !!","13e6075e":"Total Parameters in this DEEP CNN is 167,105","22c7874f":" A Convolutional Neural Network is a special type of an Artificial Intelligence implementation which uses a special mathematical matrix manipulation called the convolution operation to process data from the images.","99158c8c":"# DO NOT PANIC : CNN to RESCUE","5b2994e2":"## Explaing this model\n1.Initially there are three convolutional layer and subsequently three max pooling layer to pick important features from convolution matrix\n\n2.Flatten Layer flattens n-dimension matrix into 1-D so that it could be passed into Dense Layers\n\n3.Two Dense Layers which are fully conncectes : first layers has 128 neurons and another has 1 neuron to give results which would be binary","75350d4b":"> Also, recall that your family was there to teach you what things are. You know something is an umbrella because you look at it and someone told you that this specific object is called an umbrella. Your brain, then stores that association and you don't have to be taught this again.","efc3d8ef":"![image.png](attachment:image.png)","f3982010":"# I AM WRITING THIS NOTEBOOK TO UNDERSTND HOW CNN WORKS AND SHARE WHATEVER I KNOW WITH ALL THE BEGINEERS WHO ARE EXCITED BY CNN AND WONDERS IT CAN DO , LET US LEARN MORE ABOUT CNN"}}