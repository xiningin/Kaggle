{"cell_type":{"10e4ae07":"code","fe2d5a32":"code","b8870d72":"code","6910412e":"code","3911138d":"code","a1304d9f":"code","3716b7b1":"code","27223a93":"code","945f9cb2":"code","7491f873":"code","f2137246":"code","1bbdb726":"code","2c8db1f2":"code","2b7f07d2":"code","7023e054":"code","92f6d977":"code","db9428c7":"markdown","e268aea1":"markdown","4e8b9347":"markdown","b1ff4e02":"markdown"},"source":{"10e4ae07":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport sklearn\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.decomposition import PCA as PCA\nfrom sklearn.metrics import silhouette_samples\nimport matplotlib.pyplot as plt\nfrom matplotlib import cm\nimport warnings\nwarnings.filterwarnings('ignore')","fe2d5a32":"data = pd.read_csv('..\/input\/ammonium-prediction-in-river-water\/test.csv')","b8870d72":"print('shape = ', data.shape)\nprint(data.columns)","6910412e":"data = data.drop(['Id',], axis=1)\ndata = data.dropna()\ndata.info()\n\n","3911138d":"data.head(10)","a1304d9f":"g = sns.PairGrid(data[['1', '2', '3', '4']])\ng.map_diag(sns.kdeplot)\ng.map_offdiag(sns.kdeplot, n_levels=10);","3716b7b1":"g = sns.PairGrid(data[['1', '2', '3', '4']], palette=\"GnBu_d\")\ng.map(plt.scatter, s=50, edgecolor=\"white\")\ng.add_legend();","27223a93":"g = sns.PairGrid(data[['1', '2', '3', '4']])\ng.map_diag(plt.hist)\ng.map_offdiag(plt.scatter)\ng.add_legend();","945f9cb2":"g = sns.PairGrid(data[['1', '2', '3', '4']])\ng = g.map_diag(plt.hist, histtype=\"step\", linewidth=3)\ng = g.map_offdiag(plt.scatter)\ng = g.add_legend()","7491f873":"fig = plt.figure(figsize=(15,15))\nax1 = fig.add_subplot(3,3,1)\nsns.barplot(y='1',x='2', data=data);\nax2 = fig.add_subplot(3,3,2)\nsns.barplot(y='3',x='4', data=data);\nax3 = fig.add_subplot(3,3,3)\nsns.barplot(y='5',x='6', data=data);","f2137246":"\npca = PCA(n_components=2)\npca.fit(data)\nXpca = pca.transform(data)\nsns.set()\nplt.figure(figsize=(8,8))\nplt.scatter(Xpca[:,0],Xpca[:,1], c='Red')\nplt.show()","1bbdb726":"from sklearn.manifold import TSNE\ntsn = TSNE()\nres_tsne = tsn.fit_transform(data)\nplt.figure(figsize=(8,8))\nplt.scatter(res_tsne[:,0],res_tsne[:,1]);","2c8db1f2":"from sklearn.cluster import AgglomerativeClustering as AggClus","2b7f07d2":"clus_mod = AggClus(n_clusters=3)\nassign = clus_mod.fit_predict(data)\nplt.figure(figsize=(8,8))\nsns.set(style='darkgrid',palette='muted')\ncmap = sns.cubehelix_palette(dark=.3, light=.8, as_cmap=True)\nsns.scatterplot(x=res_tsne[:,0],y=res_tsne[:,1],s=100, hue=assign, palette='Set1');","7023e054":"from scipy.cluster.hierarchy import dendrogram, ward\nsns.set(style='white')\nplt.figure(figsize=(10,7))\nlink = ward(res_tsne)\ndendrogram(link)\nax = plt.gca()\nbounds = ax.get_xbound()\nax.plot(bounds, [30,30],'--', c='k')\nax.plot(bounds,'--', c='k')\nplt.show()","92f6d977":"clus_mod = AggClus(n_clusters=5)\nassign = clus_mod.fit_predict(data)\nplt.figure(figsize=(8,8))\nsns.set(style='darkgrid',palette='muted')\ncmap = sns.cubehelix_palette(dark=.3, light=.8, as_cmap=True)\nsns.scatterplot(x=res_tsne[:,0],y=res_tsne[:,1],s=50, hue=assign, palette='copper');","db9428c7":"** New grafics**","e268aea1":"Resources used in the work:\n\n* https:\/\/seaborn.pydata.org\/generated\/seaborn.PairGrid.html\n* https:\/\/scikit-learn.org\/stable\/modules\/generated\/sklearn.cluster.AgglomerativeClustering.html\n* https:\/\/scikit-learn.org\/stable\/auto_examples\/cluster\/plot_agglomerative_dendrogram.html#sphx-glr-auto-examples-cluster-plot-agglomerative-dendrogram-py\n* https:\/\/towardsdatascience.com\/machine-learning-algorithms-part-12-hierarchical-agglomerative-clustering-example-in-python-1e18e0075019","4e8b9347":"## Data clustering","b1ff4e02":"Thanks to:\n [Vitalii Mokin](https:\/\/www.kaggle.com\/vbmokin)"}}