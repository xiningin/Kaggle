{"cell_type":{"4787053a":"code","c03d922f":"code","222f67f3":"code","4e2c4350":"code","f3887cf9":"code","559e6e0c":"code","0806ad53":"code","d1a37e20":"code","cc5103d9":"code","82e20946":"code","caafb4e7":"markdown","432c8109":"markdown","73b07103":"markdown","f1943728":"markdown","d21adc2b":"markdown","9e9545f7":"markdown"},"source":{"4787053a":"!pip install ipython-autotime\n%load_ext autotime","c03d922f":"import os,re\n\nimport numpy as np\nimport pandas as pd\n\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport matplotlib.pyplot as plt\n\nimport tensorflow as tf","222f67f3":"data_path = '..\/input\/cc-live-proj\/'\ndata = pd.read_csv(data_path + 'AI-DataTrain.csv')\ntest_data = pd.read_csv(data_path + 'AI-DataTest.csv')\n\nprint('Data shape: ',data.shape)\nprint('Test_data shape:', test_data.shape)","4e2c4350":"test_data.head()","f3887cf9":"model = tf.keras.models.load_model('..\/input\/question-weighing-system-training\/qws.h5')\nmodel.summary()","559e6e0c":"model.save('model')\nx = tf.keras.models.load_model('\/kaggle\/working\/model')\nx.summary()","0806ad53":"def get_data_features(df):\n    pdata = df.apply(pd.Series.value_counts)\n    pdata = pdata.T[[0,1]].values\n    pdata = pdata\/df.shape[0]\n    return pdata\n\n\ndef estimate_weights(features):\n    weights = model.predict(features)\n    return weights\n\n\ndef output_csv(df,weights):\n    questions_pool = df.columns.values\n    dataqw = {'Question':questions_pool, 'Weights':weights}\n    qwdf = pd.DataFrame(data=dataqw)\n    return qwdf","d1a37e20":"def get_weights(df):\n    features = get_data_features(df)\n    weights = estimate_weights(features).T[0]\n    csv = output_csv(df,weights)\n    return csv","cc5103d9":"df = get_weights(test_data)\ndf.to_csv('submission.csv')\ndf","82e20946":"fig = go.Figure(data=[\n    go.Bar(name='Weights', x=df.Question, y=df.Weights)\n])\n# Change the bar mode\nfig.update_layout(\n    title_text='Weights for Question in Test data',\n    xaxis_tickangle=-45,\n    xaxis_title=\"Question Number\",\n    yaxis_title=\"Weights\",\n    title=dict(\n        y=0.9,\n        x=0.5,\n        xanchor='center',\n        yanchor='top',\n        font=dict(\n            size=24,\n        )\n    )\n)\nfig.show()","caafb4e7":"# Predictions","432c8109":"# Importing dependencies and libraries","73b07103":"# Reading the data","f1943728":"# Loading the model","d21adc2b":"# Helper functions","9e9545f7":"# THE END"}}