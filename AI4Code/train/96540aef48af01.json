{"cell_type":{"5267c9e6":"code","3e583cd1":"code","5c05f7f5":"code","be14b1e1":"code","456f7545":"code","926a9279":"code","a7155863":"code","a78e9932":"code","47e9b7fc":"code","ffb441d0":"code","acadcc27":"code","43cca7ec":"code","4296a256":"code","6794d764":"code","83a28115":"code","6a69de3e":"code","62e250a3":"code","61173898":"code","24deb73c":"code","2f108278":"code","8a7e73bd":"code","7e1ef2fd":"code","e12c75c7":"code","ecf4bbd8":"code","24e5e329":"code","9087d828":"code","0ae2cc2b":"code","9f8a23d0":"code","c34e7e35":"code","409f3c74":"code","32aa2c47":"code","df30f315":"code","e7af5e8b":"code","fcdd1c52":"code","d7800162":"code","8b9b5199":"code","96dc68d5":"code","61da77a4":"code","ea9c90ec":"code","4cae1517":"markdown","b49ed4e1":"markdown","8062ec96":"markdown","b36365eb":"markdown","f373b83c":"markdown","f8d2a37d":"markdown","2609dd66":"markdown","a8c67852":"markdown","6e1490e0":"markdown","9216e3c0":"markdown","034e3fc4":"markdown","65086bb4":"markdown","0c004a5e":"markdown","e2d5b852":"markdown","e3862709":"markdown","7d7778d0":"markdown","27a9fe7f":"markdown","aac705d4":"markdown"},"source":{"5267c9e6":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","3e583cd1":"import warnings\nwarnings.filterwarnings('ignore')\n\n# Importing matplotlib and seaborn\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nfrom sklearn import tree\nfrom sklearn.externals.six import StringIO\nfrom sklearn import preprocessing\nfrom sklearn import utils","5c05f7f5":"file_path = '\/kaggle\/input\/suicide-rates-overview-1985-to-2016\/master.csv'\n# import the data\ns_master = pd.read_csv(file_path)\ns_master.head()","be14b1e1":"print(s_master.shape)\nprint(s_master.describe())","456f7545":"# Unique values in each column\ns_master.nunique()","926a9279":"# % of null values in each column\nround(100*(s_master.isnull().sum()\/len(s_master.index)), 2)","a7155863":"# Dropping redundant fields\ns_master = s_master.drop([\"HDI for year\",\"country-year\",\"suicides\/100k pop\"],axis=1)","a78e9932":"# Renaming columns with proper convention\ns_master = s_master.rename(columns={\" gdp_for_year ($) \":\"gdp_for_year_usd\",\"gdp_per_capita ($)\":\"gdp_per_capita_usd\"})\ns_master.head()","47e9b7fc":"# Normalizing the gdp_for_year_usd data\ns_master[\"gdp_for_year_usd\"] = s_master[\"gdp_for_year_usd\"].str.replace(',','').astype('int64')","ffb441d0":"# Observe Unique Values\nprint(s_master[\"country\"].unique())\nprint(s_master[\"year\"].unique())\nprint(s_master[\"age\"].unique())\nprint(s_master[\"generation\"].unique())","acadcc27":"# Let's see the correlation matrix \nplt.figure(figsize = (20,15))        # Size of the figure\nsns.heatmap(s_master.corr(),annot = True,cmap=\"YlGnBu\")\nplt.show()","43cca7ec":"# Let's see the Pair plot\nplt.figure(figsize = (20,10))        # Size of the figure\nsns.pairplot(s_master.corr())\nplt.show()","4296a256":"def cfuncPlot(var,df):\n    plt.figure(figsize=(20, 10))\n    plt.subplot(2,2,1)\n    sns.countplot(x=var,  data=df, order = df[var].value_counts(normalize=True, sort=True).index)\n    plt.subplot(2,2,2)\n    ax = (df[var].value_counts(normalize=True, sort=True)*100).plot.pie(autopct='%1.1f%%')\n    plt.show()","6794d764":"cfuncPlot(\"sex\",s_master)","83a28115":"cfuncPlot(\"age\",s_master)","6a69de3e":"cfuncPlot(\"generation\",s_master)","62e250a3":"# Total No of Suicides based on country\nsui_no = s_master.groupby(['country']).suicides_no.sum()\nsui_no1 = pd.DataFrame(sui_no)\nsui_no1.reset_index(inplace=True)\nplt.figure(figsize=(10,25))\nax = sns.barplot(x=\"suicides_no\", y=\"country\", data=sui_no1.sort_values(by=['suicides_no'],ascending=False), orient = \"h\")\nplt.title('Counts by country')\nplt.show()\n\nsui_no10 = sui_no1.sort_values(by=['suicides_no'],ascending=False).head(4)\n\n# Top 4 countries with MAX Suicides\ntop_4 = list(sui_no10['country'])\nprint(\"The top 4 countries with highest number of Suicides are:\")\nprint(top_4)","61173898":"# GDP per capita based on country\nplt.figure(figsize=(10,25))\nax = sns.barplot(x=\"gdp_per_capita_usd\", y=\"country\", data=s_master, orient = \"h\")\nplt.title('GDP Per Capita for each County')\nplt.show()","24deb73c":"sui_no_yr = s_master.groupby(['year']).suicides_no.sum()\nsui_no_yr1 = pd.DataFrame(sui_no_yr)\nsui_no_yr1.reset_index(inplace=True) \nplt.figure(figsize=(10,25))\nax = sns.barplot(x=\"suicides_no\", y=\"year\", data=sui_no_yr1, orient = \"h\")\nplt.title('Counts by Year')\nplt.show()","2f108278":"def sex_plot(df):    \n    sui_no_sex = df.groupby(['sex']).suicides_no.sum()\n    sui_no_sex = pd.DataFrame(sui_no_sex) \n    sui_no_sex.index = sui_no_sex.index.set_names(['sex'])\n    sui_no_sex.reset_index(inplace=True)\n    plt.figure(figsize=(25,20))\n    plt.subplot(2,2,1)\n    sns.barplot(x=\"sex\", y=\"suicides_no\", data=sui_no_sex)\n\n    plt.subplot(2,2,2)\n    explode = (0.05,0.05)\n    ax = (sui_no_sex[\"suicides_no\"]).plot.pie(autopct='%1.1f%%', labels=sui_no_sex['sex'].values,shadow=True, startangle=0,explode=explode)\n    plt.show()\n    \nsex_plot(s_master)   ","8a7e73bd":"def age_grp_plot(df):    \n    sui_no_age = df.groupby(['age']).suicides_no.sum()\n    sui_no_age = pd.DataFrame(sui_no_age) \n    sui_no_age.index = sui_no_age.index.set_names(['age'])\n    sui_no_age.reset_index(inplace=True)\n    plt.figure(figsize=(25,20))\n    plt.subplot(2,2,1)\n    sns.barplot(y=\"age\", x=\"suicides_no\", data=sui_no_age,orient = \"h\")\n    plt.subplot(2,2,2)\n    explode = (0.05,0.05,0.05,0.2,0.05,0.05)\n    ax = (sui_no_age[\"suicides_no\"]).plot.pie(autopct='%1.1f%%', labels=sui_no_age['age'].values,shadow=True, startangle=0,explode=explode)\n    plt.show()\n    \nage_grp_plot(s_master)    ","7e1ef2fd":"def gen_plot(df):    \n    sui_no_gen = df.groupby(['generation']).suicides_no.sum()\n    sui_no_gen = pd.DataFrame(sui_no_gen) \n    sui_no_gen.index = sui_no_gen.index.set_names(['generation'])\n    sui_no_gen.reset_index(inplace=True)\n    plt.figure(figsize=(25,20))\n    plt.subplot(2,2,1)\n    sns.barplot(y=\"generation\", x=\"suicides_no\", data=sui_no_gen,orient = \"h\")\n    plt.subplot(2,2,2)\n    explode = (0.05,0.05,0.05,0.2,0.05,0.05)\n    ax = (sui_no_gen[\"suicides_no\"]).plot.pie(autopct='%1.1f%%', labels=sui_no_gen['generation'].values,shadow=True, startangle=0,explode=explode)\n    plt.show()\n    \ngen_plot(s_master)","e12c75c7":"def mv_1(df):    \n    sui_no_sex = df.groupby(['sex','age']).suicides_no.sum()\n    sui_no_sex = pd.DataFrame(sui_no_sex) #.reset_index(inplace=True)\n    sui_no_sex.index = sui_no_sex.index.set_names(['sex', 'age'])\n    sui_no_sex.reset_index(inplace=True)\n    #print(sui_no_sex.head())\n    plt.figure(figsize=(10,10))\n    sns.barplot(x='sex', y='suicides_no', hue='age', data=sui_no_sex)\n    \nmv_1(s_master)    ","ecf4bbd8":"def mv_2(df):    \n    sui_no_sex = df.groupby(['sex','generation']).suicides_no.sum()\n    sui_no_sex = pd.DataFrame(sui_no_sex) #.reset_index(inplace=True)\n    sui_no_sex.index = sui_no_sex.index.set_names(['sex', 'generation'])\n    sui_no_sex.reset_index(inplace=True)\n    plt.figure(figsize=(10,10))\n    sns.barplot(x='sex', y='suicides_no', hue='generation', data=sui_no_sex)\n    \nmv_2(s_master)  ","24e5e329":"sui_no_yr = s_master.groupby(['year',\"sex\"]).suicides_no.sum()\nsui_no_yr1 = pd.DataFrame(sui_no_yr)\nsui_no_yr1.reset_index(inplace=True) \nplt.figure(figsize=(10,25))\nax = sns.barplot(x=\"suicides_no\", y=\"year\", hue='sex', data=sui_no_yr1, orient = \"h\")\nplt.title('Counts by Year')\nplt.show()","9087d828":"print(\"The top 4 countries with highest number of Suicides are:\",top_4)","0ae2cc2b":"top4_df = s_master[s_master['country'].isin(top_4)]\ntop4_df.head(-1)","9f8a23d0":"df_Russia = top4_df[top4_df['country'].isin([\"Russian Federation\"])]\ndf_Russia.head()","c34e7e35":"sex_plot(df_Russia)\ngen_plot(df_Russia)\nmv_1(df_Russia)\nmv_2(df_Russia)","409f3c74":"df_USA = top4_df[top4_df['country'].isin([\"United States\"])]\ndf_USA.head()","32aa2c47":"# Lets see the relations\nsex_plot(df_USA)\nage_grp_plot(df_USA)\ngen_plot(df_USA)\nmv_1(df_USA)\nmv_2(df_USA)","df30f315":"s_master.generation.replace(['Boomers', 'Generation X', 'Generation Z', 'G.I. Generation', 'Millenials', 'Silent'], \n                        ['0', '1', '2', '3', '4', '5'], inplace=True)\n\ns_master.sex.replace(['male', 'female'], ['0', '1'], inplace=True)\n\ndef means(arr):\n    return str(np.array(arr).mean())\ns_master.age.replace(['15-24 years', '25-34 years', '35-54 years', '5-14 years', '55-74 years', '75+ years'], \n                 [means([15, 24]), means([25, 34]), means([35, 54]), \n                  means([5, 14]), means([55, 74]), means([75])], inplace=True)\ns_master = s_master.drop(['country'],axis=1)","e7af5e8b":"# import standard scalar\nfrom sklearn.preprocessing import StandardScaler\n\n# extract columns\ncols = s_master.columns\n\n# apply standard scalar\nscaler = StandardScaler()\n\n# produce scaled features\ns_master = scaler.fit_transform(s_master)\n\n# convert to data frame\ns_master = pd.DataFrame(s_master, columns=cols)\ns_master.head()","fcdd1c52":"from sklearn.ensemble import RandomForestRegressor\n\nfrom sklearn.metrics import mean_absolute_error, accuracy_score\nfrom sklearn.metrics import classification_report, confusion_matrix\n\nfrom sklearn.model_selection import train_test_split","d7800162":"sucide_df = s_master.drop([\"suicides_no\"],axis=1)\ny = s_master['suicides_no']","8b9b5199":"# divide the dataset into the train and test sections, keeping test size of30% \ntrain_x, test_x, train_y, test_y = train_test_split(sucide_df,y, test_size = 0.3)\nprint(train_x.shape, train_y.shape)\nprint(test_y.shape, test_x.shape)\nprint(train_x.head())","96dc68d5":"model = RandomForestRegressor(n_estimators=100, random_state=42)\nmodel.fit(train_x, train_y)\npred_y = model.predict(test_x)","61da77a4":"plt.figure(figsize=(10, 5))\nplt.scatter(test_y, pred_y, s=20)\nplt.title('Predicted vs. Actual')\nplt.xlabel('Actual Suicides')\nplt.ylabel('Predicted Suicides')\n\nplt.plot([min(test_y), max(test_y)], [min(test_y), max(test_y)])\nplt.tight_layout()","ea9c90ec":"# Evaluating the Algorithm\nfrom sklearn import metrics\nprint('Mean Absolute Error:', metrics.mean_absolute_error(test_y, pred_y))  \nprint('Mean Squared Error:', metrics.mean_squared_error(test_y, pred_y))  \nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(test_y, pred_y)))\nprint('R2 Score:', metrics.r2_score(test_y, pred_y))","4cae1517":"#### Lets do some country based analysis for top 4 suicide count countries","b49ed4e1":"Above plot shows correlation between continuous features in the dataset","8062ec96":"#### Plotting Categorical Variables","b36365eb":"### Multivariate Analysis\n\nTotal Suicide count by sex and age group","f373b83c":"###### Suicides distributed between generation","f8d2a37d":"## Visualizing the Data","2609dd66":"It can be clearly seen that in males the age group between 35-54 has the highest suicide rate.\nIn Females also we observe a similar pattern but number are considerably less\n\n#### Lets compare Generations now","a8c67852":"### Bivariate Analysis\n\nTotal Suicides Count per country","6e1490e0":"USA also shows similar trends","9216e3c0":"#### Trends in Russia seems to be inline with world. Rather I would say Russian trends implacted that of world\n\n### Lets try for United States","034e3fc4":"### Lets Do for Russia","65086bb4":"Human Development index is nearly 70% null. Since it is not correct to replace null with zeros because we are unsure of data we can drop this column going ahead. Also since we alrady have no of suicides we can skip suicides\/100k pop","0c004a5e":"###### Suicide count distributed between age group","e2d5b852":"### Standardizing the Data","e3862709":"Among men boomers have the highest no of suicides. Refer https:\/\/en.wikipedia.org\/wiki\/Generation for more clarity on Generation\n\n#### Lets do an yearly comparison of suicides between males and females","7d7778d0":"###### Total suicides count by year","27a9fe7f":"###### Suicide count distributed between sex","aac705d4":"## Model Implementation\n\nWe are using Random forest regressor for this part"}}