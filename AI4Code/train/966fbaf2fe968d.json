{"cell_type":{"3f5f51a1":"code","0fa9a049":"code","5ae58212":"code","b0ded265":"code","08959fc2":"code","61d3cf40":"code","f0da760d":"code","20ed6aea":"code","6ed1b9cb":"code","cb48d798":"code","ce4a6250":"code","b61b5813":"code","49ce3e6c":"code","c7660f36":"code","31865de4":"code","14eb9975":"code","3c3b3155":"code","c4618da6":"code","b77cd056":"code","2f42ecc9":"code","b1ef1778":"code","db6faadc":"code","1788fb7f":"code","eef05ae5":"code","34a4e098":"code","aabd9ce3":"code","9519830b":"code","ba920047":"markdown"},"source":{"3f5f51a1":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","0fa9a049":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","5ae58212":"from fastai.vision import *\nfrom fastai.metrics import error_rate","b0ded265":"bs = 64","08959fc2":"path = Path(\"..\/input\/images\/\")","61d3cf40":"path_img = path\/'images'","f0da760d":"fnames = get_image_files(path_img)\nfnames[:5]","20ed6aea":"np.random.seed(2)\npat = r'\/([^\/]+)_\\d+.jpg$'","6ed1b9cb":"data = ImageDataBunch.from_name_re('.', fnames, pat, ds_tfms=get_transforms(), size=224, bs=bs,num_workers=0\n                                  ).normalize(imagenet_stats)","cb48d798":"data.device","ce4a6250":"data.show_batch(rows=3, figsize=(7,6))","b61b5813":"print(data.classes)\nlen(data.classes),data.c","49ce3e6c":"learn = create_cnn(data, models.resnet34, metrics=error_rate)","c7660f36":"learn.fit_one_cycle(4)","31865de4":"learn.save('stage-1')","14eb9975":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","3c3b3155":"interp.plot_top_losses(9, figsize=(15,11))","c4618da6":"doc(interp.plot_top_losses)","b77cd056":"interp.plot_confusion_matrix(figsize=(12,12), dpi=60)","2f42ecc9":"interp.most_confused(min_val=2)","b1ef1778":"learn.unfreeze()","db6faadc":"learn.fit_one_cycle(1)","1788fb7f":"learn.load('stage-1');","eef05ae5":"learn.lr_find()","34a4e098":"learn.recorder.plot()","aabd9ce3":"learn.fit_one_cycle(2, max_lr=slice(1e-6,1e-4))","9519830b":"learn.recorder.plot_metrics()","ba920047":"### Min lr value is around 3.6 e-05, choose a max lr of 1e-04 and min around "}}