{"cell_type":{"eec855e4":"code","33812ab7":"code","2f76036f":"code","66af1871":"code","7abf2d4e":"code","1675f83c":"code","52ff0142":"code","9aa3022d":"code","3bc40fc8":"code","0cdaa81c":"code","203f9d66":"code","7a03cc26":"code","d6d6b5f9":"code","a0325a16":"code","7aead4be":"code","9c0aed1d":"code","e2b2c5cb":"code","042eaa17":"markdown","7521bcd2":"markdown","3bff339e":"markdown","329b8583":"markdown","ff5a0954":"markdown","f2a829a9":"markdown","5585a860":"markdown","5ebed86b":"markdown","944258ab":"markdown","c847a0e3":"markdown","9a74b378":"markdown"},"source":{"eec855e4":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport os\nimport tensorflow as tf\nfrom sklearn.model_selection import train_test_split\nfrom tensorflow.keras.utils import to_categorical\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Dropout, Conv2D, MaxPooling2D, GlobalAveragePooling2D, LeakyReLU, Flatten\nfrom tensorflow.keras.optimizers import Adam\nfrom tensorflow.keras.losses import SparseCategoricalCrossentropy\nfrom tensorflow.keras.callbacks import EarlyStopping, ModelCheckpoint, ReduceLROnPlateau\n\nimport warnings\nwarnings.filterwarnings('ignore')","33812ab7":"train_data = pd.read_csv(\"..\/input\/digit-recognizer\/train.csv\")\ntest_data = pd.read_csv(\"..\/input\/digit-recognizer\/test.csv\")","2f76036f":"def show_image(train_image, label, index):\n    image_shaped = train_image.values.reshape(28,28)\n    plt.subplot(3, 6, index+1)\n    plt.imshow(image_shaped, cmap=plt.cm.gray)\n    plt.title(label)\n\n\nplt.figure(figsize=(18, 8))\nsample_image = train_data.sample(18).reset_index(drop=True)\nfor index, row in sample_image.iterrows():\n    label = row['label']\n    image_pixels = row.drop('label')\n    show_image(image_pixels, label, index)\nplt.tight_layout()","66af1871":"x = train_data.drop(columns=['label']).values.reshape(train_data.shape[0],28,28,1)\ny = to_categorical(train_data['label']) ","7abf2d4e":"x = x\/255","1675f83c":"train_ds = tf.data.Dataset.from_tensor_slices((x, y))\ntrain_ds = train_ds.shuffle(2500)\n\nval_ds = tf.data.Dataset.from_tensor_slices((x, y))\nval_ds = val_ds.shuffle(2500)","52ff0142":"train_ds = train_ds.skip(8000).batch(32)\nval_ds = val_ds.take(8000).batch(32)","9aa3022d":"train_ds","3bc40fc8":"model = Sequential()\nmodel.add(Conv2D(32, (3,3), activation='relu', input_shape=(28, 28,1)))\nmodel.add(MaxPooling2D(2, 2))\n\nmodel.add(Conv2D(64, (3,3), activation='relu'))\nmodel.add(MaxPooling2D(2, 2))\n\nmodel.add(Flatten())\nmodel.add(Dense(128, activation='relu'))\nmodel.add(Dense(10, activation='softmax'))\nmodel.summary()","0cdaa81c":"model.compile(optimizer=Adam(learning_rate=0.002), loss='categorical_crossentropy', metrics=['accuracy'])","203f9d66":"call_back = ModelCheckpoint('model.h5', verbose=1, monitor='val_accuracy', save_best_only=True)","7a03cc26":"history = model.fit(train_ds, validation_data=val_ds, epochs=15, callbacks=[call_back])","d6d6b5f9":"model = tf.keras.models.load_model('.\/model.h5')","a0325a16":"test_data = test_data.values.reshape(test_data.shape[0],28,28,1)\ntest_data = test_data \/ 255","7aead4be":"pred = model.predict(test_data, verbose=1)","9c0aed1d":"predicted = []\nfor i in range(len(pred.round())):\n    predicted.append(np.argmax(pred.round()[i]))","e2b2c5cb":"submission_file = pd.read_csv(\"..\/input\/digit-recognizer\/sample_submission.csv\")\nsubmission_file['Label'] = predicted\nsubmission_file.to_csv('MySubmission.csv', index=False)","042eaa17":"**Splitting Data for Validation**","7521bcd2":"**Ploting Image**","3bff339e":"**Preparing test Data**","329b8583":"**Submission**","ff5a0954":"**Seperating Lable and Pixels**","f2a829a9":"**Loading the best model**","5585a860":"***Model Build***","5ebed86b":"**Prediction**","944258ab":"**Callback to save the best model**","c847a0e3":"**Normalazing (0 to 255) to (0 to 1)**","9a74b378":"**Loading Test and Train Dataset**"}}