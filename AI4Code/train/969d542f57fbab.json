{"cell_type":{"762c0afa":"code","ce21df5a":"code","1f128efe":"code","570ed320":"code","64dcca07":"code","6f9a3c72":"code","e09a7129":"code","5accb393":"code","d6afe301":"code","9216ba5e":"code","aa2a9ebb":"code","2fcf1990":"code","ca3186b6":"code","45cbce00":"code","4ae1ea1a":"code","96643c96":"code","c9e883be":"code","ac8ca0b5":"code","60d2dd15":"code","97e60965":"code","a75ad421":"code","384274a3":"code","2b0f2d5c":"code","f767686f":"code","c77a115a":"code","3c5defff":"code","9630417e":"code","0595a026":"code","44985657":"code","d1b5b502":"code","f7ca0137":"code","b31abf0b":"code","3fb9e5fb":"code","c3c77161":"code","37618101":"code","c6528f00":"code","734308a9":"code","7c4c12e0":"code","cc3941cf":"code","607f56aa":"code","e244549b":"code","61b45b47":"code","5b9a29ac":"code","15ee781c":"code","4e315f36":"code","41a21b08":"code","5186fe1f":"code","8c4bdf15":"code","c89f804b":"code","b9edbea0":"code","80894797":"code","82cfaad0":"code","b38391f7":"code","721e46cb":"code","240ebd29":"code","7d86e5dd":"code","bfd15b19":"code","cf3a8c35":"code","ae8503a0":"code","501fb8e1":"code","1e0fbacf":"code","ccfc423d":"code","cc7eeea1":"code","fce7e9dd":"code","1eee956d":"code","24e10ad1":"code","236381b4":"code","1059252b":"code","9118034c":"code","62590cbd":"code","544aba32":"code","40853cf7":"code","39b8da97":"code","cd08684e":"code","b5411aa6":"code","1afc2e9c":"code","fafe011a":"code","dabc92a1":"code","27ac0562":"code","bfc6edbd":"markdown"},"source":{"762c0afa":"import pandas as pd\nimport glob\nfrom plotly import offline\nimport plotly.graph_objs as go\n\n\npd.set_option('max.columns', None)\noffline.init_notebook_mode()\nconfig = dict(showLink=False)","ce21df5a":"\nvideo_review = pd.read_csv('..\/input\/video_review.csv')\nvideo_review.head()","1f128efe":"def load_layout():\n    \"\"\"\n    Returns a dict for a Football themed Plot.ly layout \n    \"\"\"\n    layout = dict(\n        title = \"Player Activity\",\n        plot_bgcolor='darkseagreen',\n        showlegend=True,\n        xaxis=dict(\n            autorange=False,\n            range=[0, 120],\n            showgrid=False,\n            zeroline=False,\n            showline=True,\n            linecolor='black',\n            linewidth=1,\n            mirror=True,\n            ticks='',\n            tickmode='array',\n            tickvals=[10,20, 30, 40, 50, 60, 70, 80, 90, 100, 110],\n            ticktext=['Goal', 10, 20, 30, 40, 50, 40, 30, 20, 10, 'Goal'],\n            showticklabels=True\n        ),\n        yaxis=dict(\n            title='',\n            autorange=False,\n            range=[-3.3,56.3],\n            showgrid=False,\n            zeroline=False,\n            showline=True,\n            linecolor='black',\n            linewidth=1,\n            mirror=True,\n            ticks='',\n            showticklabels=False\n        ),\n        shapes=[\n            dict(\n                type='line',\n                layer='below',\n                x0=0,\n                y0=0,\n                x1=120,\n                y1=0,\n                line=dict(\n                    color='white',\n                    width=2\n                )\n            ),\n            dict(\n                type='line',\n                layer='below',\n                x0=0,\n                y0=53.3,\n                x1=120,\n                y1=53.3,\n                line=dict(\n                    color='white',\n                    width=2\n                )\n            ),\n            dict(\n                type='line',\n                layer='below',\n                x0=10,\n                y0=0,\n                x1=10,\n                y1=53.3,\n                line=dict(\n                    color='white',\n                    width=10\n                )\n            ),\n            dict(\n                type='line',\n                layer='below',\n                x0=20,\n                y0=0,\n                x1=20,\n                y1=53.3,\n                line=dict(\n                    color='white'\n                )\n            ),\n            dict(\n                type='line',\n                layer='below',\n                x0=30,\n                y0=0,\n                x1=30,\n                y1=53.3,\n                line=dict(\n                    color='white'\n                )\n            ),\n            dict(\n                type='line',\n                layer='below',\n                x0=40,\n                y0=0,\n                x1=40,\n                y1=53.3,\n                line=dict(\n                    color='white'\n                )\n            ),\n            dict(\n                type='line',\n                layer='below',\n                x0=50,\n                y0=0,\n                x1=50,\n                y1=53.3,\n                line=dict(\n                    color='white'\n                )\n            ),\n            dict(\n                type='line',\n                layer='below',\n                x0=60,\n                y0=0,\n                x1=60,\n                y1=53.3,\n                line=dict(\n                    color='white'\n                )\n            ),dict(\n                type='line',\n                layer='below',\n                x0=70,\n                y0=0,\n                x1=70,\n                y1=53.3,\n                line=dict(\n                    color='white'\n                )\n            ),dict(\n                type='line',\n                layer='below',\n                x0=80,\n                y0=0,\n                x1=80,\n                y1=53.3,\n                line=dict(\n                    color='white'\n                )\n            ),\n            dict(\n                type='line',\n                layer='below',\n                x0=90,\n                y0=0,\n                x1=90,\n                y1=53.3,\n                line=dict(\n                    color='white'\n                )\n            ),dict(\n                type='line',\n                layer='below',\n                x0=100,\n                y0=0,\n                x1=100,\n                y1=53.3,\n                line=dict(\n                    color='white'\n                )\n            ),\n            dict(\n                type='line',\n                layer='below',\n                x0=110,\n                y0=0,\n                x1=110,\n                y1=53.3,\n                line=dict(\n                    color='white',\n                    width=10\n                )\n            )\n        ]\n    )\n    return layout\n\nlayout = load_layout()","570ed320":"# Loading and plotting functions\n\ndef load_plays_for_game(GameKey):\n    \"\"\"\n    Returns a dataframe of play data for a given game (GameKey)\n    \"\"\"\n    play_information = pd.read_csv('..\/input\/play_information.csv')\n    play_information = play_information[play_information['GameKey'] == GameKey]\n    return play_information\n\n\ndef load_game_and_ngs(ngs_file=None, GameKey=None):\n    \"\"\"\n    Returns a dataframe of player movements (NGS data) for a given game\n    \"\"\"\n    if ngs_file is None:\n        print(\"Specifiy an NGS file.\")\n        return None\n    if GameKey is None:\n        print('Specify a GameKey')\n        return None\n    # Merge play data with NGS data    \n    plays = load_plays_for_game(GameKey)\n    ngs = pd.read_csv(ngs_file, low_memory=False)\n    merged = pd.merge(ngs, plays, how=\"inner\", on=[\"GameKey\", \"PlayID\", \"Season_Year\"])\n    return merged\n\n\ndef plot_play(game_df, PlayID, player1=None, player2=None, custom_layout=False):\n    \"\"\"\n    Plots player movements on the field for a given game, play, and two players\n    \"\"\"\n    game_df = game_df[game_df.PlayID==PlayID]\n    \n    GameKey=str(pd.unique(game_df.GameKey)[0])\n    HomeTeam = pd.unique(game_df.Home_Team_Visit_Team)[0].split(\"-\")[0]\n    VisitingTeam = pd.unique(game_df.Home_Team_Visit_Team)[0].split(\"-\")[1]\n    YardLine = game_df[(game_df.PlayID==PlayID) & (game_df.GSISID==player1)]['YardLine'].iloc[0]\n    \n    traces=[]   \n    if (player1 is not None) & (player2 is not None):\n        game_df = game_df[ (game_df['GSISID']==player1) | (game_df['GSISID']==player2)]\n        for player in pd.unique(game_df.GSISID):\n            player = int(player)\n            trace = go.Scatter(\n                x = game_df[game_df.GSISID==player].x,\n                y = game_df[game_df.GSISID==player].y,\n                text = game_df[game_df.GSISID==player].Time,\n                hoverinfo = 'text',\n                name='GSISID '+str(player),\n                mode='markers'\n            )\n            traces.append(trace)\n    else:\n        print(\"Specify GSISIDs for player1 and player2\")\n        return None\n    \n    if custom_layout is not True:\n        layout = load_layout()\n        layout['title'] =  HomeTeam + \\\n        ' vs. ' + VisitingTeam + \\\n        '<br>Possession: ' + \\\n        YardLine.split(\" \")[0] +'@'+YardLine.split(\" \")[1]\n    data = traces\n    fig = dict(data=data, layout=layout)\n    play_description = game_df[(game_df.PlayID==PlayID) & (game_df.GSISID==player1)].iloc[0][\"PlayDescription\"]\n    print(\"\\n\\n\\t\",play_description)\n    offline.iplot(fig, config=config)\n    ","64dcca07":"time_data = ['2016-08-12 02:07:47:600','2016-08-20 21:04:15:800','2016-08-19 23:53:46.400','2016-08-28 00:28:47.600','2016-09-02 00:33:39.100',\n            '2016-09-02 00.13.24.200','2016-10-16 18:46:54.300','2016-10-16 19:38:01.400','2016-11-06 21:00:52.800','2016-11-20 20:41:57.200',\n            '2016-11-27 19:21:55.800','2016-11-27 20:32:16.000','2016-12-11 20:30:37.200','2016-12-16 04:19:02.700','2016-12-18 20:20:51.500',\n            '2016-12-18 20.55.49.100','2016-12-18 19:16:08.700','2016-12-20 03:19:55.100','2016-12-24 19:59:49.300','2017-08-18 01:39:15.000',\n            '2017-08-20 01:29:19.200','2017-08-20 01:42:36.800','2017-08-31 23:10:42.500','2017-09-01 01:24:07.800','2017-09-01 03:10:23.800',\n            '2017-09-08 03:10:57.300','','2017-10-01 15:39:58.200','2017-10-08 21:48:30.500','','2017-11-19 19:16:21.400','2017-11-26 18:59:23.700',\n            '2017-12-03 19:51:17.000','','2017-12-10 21:27:21.400','2017-12-15 02:03:15.800','2017-12-17 23:13:36.300']","6f9a3c72":"game = load_game_and_ngs('..\/input\/NGS-2016-pre.csv',GameKey=video_review['GameKey'][0]) #2016-08-12 02:07:47:600","e09a7129":"plot_play(game_df=game, PlayID=video_review['PlayID'][0], player1=float(video_review['GSISID'][0]), player2=float(video_review['Primary_Partner_GSISID'][0]))","5accb393":"game = load_game_and_ngs('..\/input\/NGS-2016-pre.csv',GameKey=video_review['GameKey'][1]) #2016-08-20 21:04:15:800","d6afe301":"plot_play(game_df=game, PlayID=video_review['PlayID'][1], player1=float(video_review['GSISID'][1]), player2=float(video_review['Primary_Partner_GSISID'][1]))","9216ba5e":"game = load_game_and_ngs('..\/input\/NGS-2016-pre.csv',GameKey=video_review['GameKey'][2]) #2016-08-19 23:53:46.400","aa2a9ebb":"plot_play(game_df=game, PlayID=video_review['PlayID'][2], player1=float(video_review['GSISID'][2]), player2=float(video_review['Primary_Partner_GSISID'][2]))","2fcf1990":"game = load_game_and_ngs('..\/input\/NGS-2016-pre.csv',GameKey=video_review['GameKey'][3]) #2016-08-28 00:28:47.600","ca3186b6":"plot_play(game_df=game, PlayID=video_review['PlayID'][3], player1=float(video_review['GSISID'][3]), player2=float(video_review['Primary_Partner_GSISID'][3]))","45cbce00":"game = load_game_and_ngs('..\/input\/NGS-2016-pre.csv',GameKey=video_review['GameKey'][4]) #2016-09-02 00:33:39.100","4ae1ea1a":"plot_play(game_df=game, PlayID=video_review['PlayID'][4], player1=float(video_review['GSISID'][4]), player2=float(video_review['Primary_Partner_GSISID'][4]))","96643c96":"game = load_game_and_ngs('..\/input\/NGS-2016-pre.csv',GameKey=video_review['GameKey'][5]) #2016-09-02 00.13.24.200","c9e883be":"plot_play(game_df=game, PlayID=video_review['PlayID'][5], player1=float(video_review['GSISID'][5]), player2=float(video_review['Primary_Partner_GSISID'][5]))","ac8ca0b5":"game = load_game_and_ngs('..\/input\/NGS-2016-reg-wk1-6.csv',GameKey=video_review['GameKey'][6]) #2016-10-16 18:46:54.300","60d2dd15":"plot_play(game_df=game, PlayID=video_review['PlayID'][6], player1=float(video_review['GSISID'][6]), player2=float(video_review['Primary_Partner_GSISID'][6]))","97e60965":"game = load_game_and_ngs('..\/input\/NGS-2016-reg-wk1-6.csv',GameKey=video_review['GameKey'][7]) #2016-10-16 19:38:01.400","a75ad421":"plot_play(game_df=game, PlayID=video_review['PlayID'][7], player1=float(video_review['GSISID'][7]), player2=float(video_review['Primary_Partner_GSISID'][7]))","384274a3":"game = load_game_and_ngs('..\/input\/NGS-2016-reg-wk7-12.csv',GameKey=video_review['GameKey'][8]) #2016-11-06 21:00:52.800","2b0f2d5c":"plot_play(game_df=game, PlayID=video_review['PlayID'][8], player1=float(video_review['GSISID'][8]), player2=float(video_review['Primary_Partner_GSISID'][8]))","f767686f":"game = load_game_and_ngs('..\/input\/NGS-2016-reg-wk7-12.csv',GameKey=video_review['GameKey'][9]) #2016-11-20 20:41:57.200","c77a115a":"plot_play(game_df=game, PlayID=video_review['PlayID'][9], player1=float(video_review['GSISID'][9]), player2=float(video_review['Primary_Partner_GSISID'][9]))","3c5defff":"game = load_game_and_ngs('..\/input\/NGS-2016-reg-wk7-12.csv',GameKey=video_review['GameKey'][10]) #2016-11-27 19:21:55.800","9630417e":"plot_play(game_df=game, PlayID=video_review['PlayID'][10], player1=float(video_review['GSISID'][10]), player2=float(video_review['Primary_Partner_GSISID'][10]))","0595a026":"game = load_game_and_ngs('..\/input\/NGS-2016-reg-wk7-12.csv',GameKey=video_review['GameKey'][11]) #2016-11-27 20:32:16.000","44985657":"plot_play(game_df=game, PlayID=video_review['PlayID'][11], player1=float(video_review['GSISID'][11]), player2=float(video_review['Primary_Partner_GSISID'][11]))","d1b5b502":"game = load_game_and_ngs('..\/input\/NGS-2016-reg-wk13-17.csv',GameKey=video_review['GameKey'][12]) #2016-12-11 20:30:37.200","f7ca0137":"plot_play(game_df=game, PlayID=video_review['PlayID'][12], player1=float(video_review['GSISID'][12]), player2=float(video_review['Primary_Partner_GSISID'][12]))","b31abf0b":"game = load_game_and_ngs('..\/input\/NGS-2016-reg-wk13-17.csv',GameKey=video_review['GameKey'][13]) #2016-12-16 04:19:02.700","3fb9e5fb":"plot_play(game_df=game, PlayID=video_review['PlayID'][13], player1=float(video_review['GSISID'][13]), player2=float(video_review['Primary_Partner_GSISID'][13]))","c3c77161":"game = load_game_and_ngs('..\/input\/NGS-2016-reg-wk13-17.csv',GameKey=video_review['GameKey'][14]) #2016-12-18 20:20:51.500","37618101":"plot_play(game_df=game, PlayID=video_review['PlayID'][14], player1=float(video_review['GSISID'][14]), player2=float(video_review['Primary_Partner_GSISID'][14]))","c6528f00":"game = load_game_and_ngs('..\/input\/NGS-2016-reg-wk13-17.csv',GameKey=video_review['GameKey'][15]) #2016-12-18 20.55.49.100","734308a9":"plot_play(game_df=game, PlayID=video_review['PlayID'][15], player1=float(video_review['GSISID'][15]), player2=float(video_review['Primary_Partner_GSISID'][15]))","7c4c12e0":"game = load_game_and_ngs('..\/input\/NGS-2016-reg-wk13-17.csv',GameKey=video_review['GameKey'][16])#2016-12-18 19:16:08.700","cc3941cf":"plot_play(game_df=game, PlayID=video_review['PlayID'][16], player1=float(video_review['GSISID'][16]), player2=float(video_review['Primary_Partner_GSISID'][16]))","607f56aa":"game = load_game_and_ngs('..\/input\/NGS-2016-reg-wk13-17.csv',GameKey=video_review['GameKey'][17])#2016-12-20 03:19:55.100","e244549b":"plot_play(game_df=game, PlayID=video_review['PlayID'][17], player1=float(video_review['GSISID'][17]), player2=float(video_review['Primary_Partner_GSISID'][17]))","61b45b47":"game = load_game_and_ngs('..\/input\/NGS-2016-reg-wk13-17.csv',GameKey=video_review['GameKey'][18]) #2016-12-24 19:59:49.300","5b9a29ac":"plot_play(game_df=game, PlayID=video_review['PlayID'][18], player1=float(video_review['GSISID'][18]), player2=float(video_review['Primary_Partner_GSISID'][18]))","15ee781c":"game = load_game_and_ngs('..\/input\/NGS-2017-pre.csv',GameKey=video_review['GameKey'][19]) #2017-08-18 01:39:15.000","4e315f36":"plot_play(game_df=game, PlayID=video_review['PlayID'][19], player1=float(video_review['GSISID'][19]), player2=float(video_review['Primary_Partner_GSISID'][19]))","41a21b08":"game = load_game_and_ngs('..\/input\/NGS-2017-pre.csv',GameKey=video_review['GameKey'][20])# 2017-08-20 01:29:19.200","5186fe1f":"plot_play(game_df=game, PlayID=video_review['PlayID'][20], player1=float(video_review['GSISID'][20]), player2=float(video_review['Primary_Partner_GSISID'][20]))","8c4bdf15":"game = load_game_and_ngs('..\/input\/NGS-2017-pre.csv',GameKey=video_review['GameKey'][21]) #2017-08-20 01:42:36.800","c89f804b":"plot_play(game_df=game, PlayID=video_review['PlayID'][21], player1=float(video_review['GSISID'][21]), player2=float(video_review['Primary_Partner_GSISID'][21]))","b9edbea0":"game = load_game_and_ngs('..\/input\/NGS-2017-pre.csv',GameKey=video_review['GameKey'][22]) #2017-08-31 23:10:42.500","80894797":"plot_play(game_df=game, PlayID=video_review['PlayID'][22], player1=float(video_review['GSISID'][22]), player2=float(video_review['Primary_Partner_GSISID'][22]))","82cfaad0":"game = load_game_and_ngs('..\/input\/NGS-2017-pre.csv',GameKey=video_review['GameKey'][23]) #2017-09-01 01:24:07.800","b38391f7":"plot_play(game_df=game, PlayID=video_review['PlayID'][23], player1=float(video_review['GSISID'][23]), player2=float(video_review['Primary_Partner_GSISID'][23]))","721e46cb":"game = load_game_and_ngs('..\/input\/NGS-2017-pre.csv',GameKey=video_review['GameKey'][24]) #2017-09-01 03:10:23.800","240ebd29":"plot_play(game_df=game, PlayID=video_review['PlayID'][24], player1=float(video_review['GSISID'][24]), player2=float(video_review['Primary_Partner_GSISID'][24]))","7d86e5dd":"game = load_game_and_ngs('..\/input\/NGS-2017-reg-wk1-6.csv',GameKey=video_review['GameKey'][25]) #2017-09-08 03:10:57.300","bfd15b19":"plot_play(game_df=game, PlayID=video_review['PlayID'][25], player1=float(video_review['GSISID'][25]), player2=float(video_review['Primary_Partner_GSISID'][25]))","cf3a8c35":"game = load_game_and_ngs('..\/input\/NGS-2017-reg-wk1-6.csv',GameKey=video_review['GameKey'][26]) ","ae8503a0":"plot_play(game_df=game, PlayID=video_review['PlayID'][26], player1=float(video_review['GSISID'][26]), player2=float(video_review['Primary_Partner_GSISID'][26]))","501fb8e1":"game = load_game_and_ngs('..\/input\/NGS-2017-reg-wk1-6.csv',GameKey=video_review['GameKey'][27]) #2017-10-01 15:39:58.200","1e0fbacf":"plot_play(game_df=game, PlayID=video_review['PlayID'][27], player1=float(video_review['GSISID'][27]), player2=float(video_review['Primary_Partner_GSISID'][27]))","ccfc423d":"game = load_game_and_ngs('..\/input\/NGS-2017-reg-wk1-6.csv',GameKey=video_review['GameKey'][28])  #2017-10-08 21:48:30.500","cc7eeea1":"plot_play(game_df=game, PlayID=video_review['PlayID'][28], player1=float(video_review['GSISID'][28]), player2=float(video_review['Primary_Partner_GSISID'][28]))","fce7e9dd":"game = load_game_and_ngs('..\/input\/NGS-2017-reg-wk7-12.csv',GameKey=video_review['GameKey'][29])  ","1eee956d":"plot_play(game_df=game, PlayID=video_review['PlayID'][29], player1=float(video_review['GSISID'][29]), player2=float(video_review['Primary_Partner_GSISID'][29]))","24e10ad1":"game = load_game_and_ngs('..\/input\/NGS-2017-reg-wk7-12.csv',GameKey=video_review['GameKey'][30])  #2017-11-19 19:16:21.400","236381b4":"plot_play(game_df=game, PlayID=video_review['PlayID'][30], player1=float(video_review['GSISID'][30]), player2=float(video_review['Primary_Partner_GSISID'][30]))","1059252b":"game = load_game_and_ngs('..\/input\/NGS-2017-reg-wk7-12.csv',GameKey=video_review['GameKey'][31])  #2017-11-26 18:59:23.700","9118034c":"plot_play(game_df=game, PlayID=video_review['PlayID'][31], player1=float(video_review['GSISID'][31]), player2=float(video_review['Primary_Partner_GSISID'][31]))","62590cbd":"game = load_game_and_ngs('..\/input\/NGS-2017-reg-wk13-17.csv',GameKey=video_review['GameKey'][32])  #2017-12-03 19:51:17.000","544aba32":"plot_play(game_df=game, PlayID=video_review['PlayID'][32], player1=float(video_review['GSISID'][32]), player2=float(video_review['Primary_Partner_GSISID'][32]))","40853cf7":"game = load_game_and_ngs('..\/input\/NGS-2017-reg-wk13-17.csv',GameKey=video_review['GameKey'][33])  ","39b8da97":"plot_play(game_df=game, PlayID=video_review['PlayID'][33], player1=float(video_review['GSISID'][33]), player2=0)","cd08684e":"game = load_game_and_ngs('..\/input\/NGS-2017-reg-wk13-17.csv',GameKey=video_review['GameKey'][34])  #2017-12-10 21:27:21.400","b5411aa6":"plot_play(game_df=game, PlayID=video_review['PlayID'][34], player1=float(video_review['GSISID'][34]), player2=float(video_review['Primary_Partner_GSISID'][34]))","1afc2e9c":"game = load_game_and_ngs('..\/input\/NGS-2017-reg-wk13-17.csv',GameKey=video_review['GameKey'][35])  #2017-12-15 02:03:15.800","fafe011a":"plot_play(game_df=game, PlayID=video_review['PlayID'][35], player1=float(video_review['GSISID'][35]), player2=float(video_review['Primary_Partner_GSISID'][35]))","dabc92a1":"game = load_game_and_ngs('..\/input\/NGS-2017-reg-wk13-17.csv',GameKey=video_review['GameKey'][36])   #2017-12-17 23:13:36.300","27ac0562":"plot_play(game_df=game, PlayID=video_review['PlayID'][36], player1=float(video_review['GSISID'][36]), player2=float(video_review['Primary_Partner_GSISID'][36]))","bfc6edbd":"I've slightly edit the starter kernel and use it to plot the path of player verus time, and manually record the impact time of 34 concussions that involves two players. The timing may be a little off so feel free to point out labeling error."}}