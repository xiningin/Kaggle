{"cell_type":{"1c0cab6c":"code","eaff48fa":"code","10cc4572":"code","1c79c3b5":"code","af028655":"code","4667ea76":"code","575fea80":"code","4ca2a705":"code","5e41fb7e":"code","0d56f931":"code","6a72b3b1":"code","1bf6ef5d":"markdown","4fd6a8e7":"markdown","948644a2":"markdown","51080fdc":"markdown","50b9bb39":"markdown","26e935c2":"markdown","e8a7c973":"markdown","2b2a18c4":"markdown","b2295b55":"markdown","f304bb07":"markdown","9c787ea4":"markdown"},"source":{"1c0cab6c":"import h2o\nfrom h2o.automl import H2OAutoML\nh2o.init(max_mem_size='16G')","eaff48fa":"data_path = \"..\/input\/used-cars-price-prediction\/train-data.csv\"\n# Load data into H2O\ndf = h2o.import_file(data_path)","10cc4572":"df.head()","1c79c3b5":"splits = df.split_frame(ratios=[0.8],seed=42)\ntrain = splits[0]\ntest = splits[1]","af028655":"y = \"Price\" \nx = df.columns \nx.remove(y) \nx.remove('New_Price') \n","4667ea76":"aml = H2OAutoML(max_runtime_secs=120, seed=42)\naml.train(x=x,y=y, training_frame=train)","575fea80":"lb = aml.leaderboard\nlb.head()","4ca2a705":"# Get model ids for all models in the AutoML Leaderboard\nmodel_ids = list(aml.leaderboard['model_id'].as_data_frame().iloc[:,0])\n# Get the \"All Models\" Stacked Ensemble model\nse = h2o.get_model([mid for mid in model_ids if \"StackedEnsemble_AllModels\" in mid][0])\n# Get the Stacked Ensemble metalearner model\nmetalearner = h2o.get_model(se.metalearner()['name'])","5e41fb7e":"%matplotlib inline\nmetalearner.std_coef_plot()","0d56f931":"pred = aml.predict(test)\npred.head()","6a72b3b1":"h2o.save_model(aml.leader, path=\".\/Cars_Price_Prediction_model_bin\")\n","1bf6ef5d":"## 7. Predicting Using Leader Model\n","4fd6a8e7":"# 4. References\n\nThis section provides more resources on the topic if you are looking to go deeper.\n\n* https:\/\/www.h2o.ai\/hybrid-cloud\/explain\/\n* https:\/\/github.com\/h2oai\/h2o-tutorials\n* https:\/\/towardsdatascience.com\/a-deep-dive-into-h2os-automl-4b1fe51d3f3e\n* https:\/\/www.alibabacloud.com\/blog\/6-top-automl-frameworks-for-machine-learning-applications-may-2019_595317","948644a2":"## 8. Saving the Leader Model\n","51080fdc":"# 3. Case Study","50b9bb39":"## 2. Loading data into H2O\n","26e935c2":"## 5. Run AutoML","e8a7c973":"# 1. Automated Machine Learning: AutoML\n\nAutomated machine learning (AutoML) is the process of automating the end-to-end process of applying machine learning to real-world problems. AutoML tends to automate the maximum number of steps in an ML pipeline \u2014 with a minimum amount of human effort \u2014 without compromising the model\u2019s performance.\n\n![image.png](attachment:9784a6db-90a6-400d-aa68-877d6d5f1d50.png)\n\nAutomated machine learning can be thought of as the standard machine learning process with the automation of some of the steps involved. AutoML very broadly includes:\n\n* Automating certain parts of data preparation, e.g. imputation, standardization, feature selection, etc.\n* Being able to generate various models automatically, e.g. random grid search, Bayesian Hyperparameter Optimization, etc.\n* Getting the best model out of all the generated models, which most of the time is an Ensemble, e.g. ensemble selection, stacking, etc.\n\n\n\n\n# 2. H2O\u2019s Automatic Machine Learning (AutoML)\n\n\n\n\n![image.png](attachment:406c6134-a653-4b7c-a36c-20ad0d7f3091.png)\n\n\nH2O is a fully open-source, distributed in-memory machine learning platform with linear scalability. H2O supports the most widely used statistical & machine learning algorithms, including gradient boosted machines, generalized linear models, deep learning, and many more.\n![image.png](attachment:cef2d8e3-eca1-46a3-9a5e-2555095e202e.png)![image.png](attachment:44366527-5936-490e-9fa4-5a7fceb979f7.png)\n\n\n\n\nH2O also has an industry-leading AutoML functionality (available in H2O \u22653.14) that automates the process of building a large number of models, to find the \u201cbest\u201d model without any prior knowledge or effort by the Data Scientist. H2O AutoML can be used for automating the machine learning workflow, which includes automatic training and tuning of many models within a user-specified time-limit.\n\n\nSome of the important features of H2O\u2019s AutoML are:\n\n* Open-source, distributed (multi-core + multi-node) implementations of cutting edge ML algorithms.\n* Availability of core algorithms in high-performance Java. including APIs in R, Python, Scala, web GUI.\n* Easily deployable models to production as pure Java code.\n* Seamlessly works on Hadoop, Spark, AWS, your laptop, etc.\n\n\n\n### Who is it for?\nH2O\u2019s AutoML can also be a helpful tool for the novice as well as advanced users. It provides a simple wrapper function that performs a large number of modeling-related tasks that would typically require many lines of code. This essentially frees up the time to focus on other aspects of the data science pipeline, such as data preprocessing, feature engineering, and model deployment.\n\n\n\n![image.png](attachment:d229618a-76a4-43af-b7ed-233f2c0a201c.png)","2b2a18c4":"## 4. Specifying the Response and Predictor variables","b2295b55":"## 3. Splitting the dataset into train and test datasets","f304bb07":"## 6. Ensemble Exploration\n","9c787ea4":"## 1. Start H2O"}}