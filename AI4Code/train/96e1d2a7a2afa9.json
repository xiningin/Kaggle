{"cell_type":{"c7fbcc53":"code","9b36cacf":"code","aaee05ad":"code","9adcef71":"code","3cd578c4":"code","e5d78b66":"code","df7a2cfb":"code","40db00d0":"code","fded7925":"code","5e9fabfb":"code","75b141de":"code","e0970d05":"code","f2a4744f":"code","430ff9c0":"code","6cfcc389":"code","675021c6":"code","cb0f0fff":"code","06012a8f":"code","2b537b77":"code","82552700":"code","9af09199":"code","350f68f2":"code","1142c1a7":"markdown"},"source":{"c7fbcc53":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","9b36cacf":"tran=pd.read_csv('..\/input\/petfinder-pawpularity-score\/train.csv')\ntest=pd.read_csv('..\/input\/petfinder-pawpularity-score\/test.csv')","aaee05ad":"column=[col for col in tran.columns if col not in ['Id','Pawpularity']]","9adcef71":"x=tran[column]\ny=tran['Pawpularity']","3cd578c4":"print(x.shape,y.shape)","e5d78b66":"from sklearn.model_selection import train_test_split, GridSearchCV,KFold\nfrom sklearn.metrics import mean_squared_error\nxtrain,xtest,ytrain,ytest=train_test_split(x,y,random_state=42,test_size=0.2)","df7a2cfb":"from catboost import CatBoostRegressor","40db00d0":"cat=CatBoostRegressor(random_state=42,eval_metric='RMSE')","fded7925":"kfold=KFold(n_splits=5,shuffle=True,random_state=42)","5e9fabfb":"params={'learning_rate': [0.01,0.1,0.05],\n       'depth':[8,10,15],\n       'iterations':[10,30,50],\n    }","75b141de":"grid_cat=GridSearchCV(estimator=cat,param_grid=params,cv=kfold)","e0970d05":"grid_cat=grid_cat.fit(xtrain,ytrain,verbose=0)","f2a4744f":"grid_cat.best_params_","430ff9c0":"grid_cat.best_score_","6cfcc389":"cat1=CatBoostRegressor(**grid_cat.best_params_)","675021c6":"cat1.fit(xtrain,ytrain,verbose=0)","cb0f0fff":"y_pred=cat1.predict(xtest)","06012a8f":"np.sqrt(mean_squared_error(ytest,y_pred))","2b537b77":"test_id=test['Id']\ntest.drop('Id',inplace=True,axis=1)","82552700":"sub=cat1.predict(test)","9af09199":"submission=pd.DataFrame(sub,columns=['Pawpularity'])\nsubmission=pd.concat([test_id,submission],axis=1)","350f68f2":"submission.to_csv('submission.csv',index=False)","1142c1a7":"In this competetition, our goal is to predict pawpularity of pet's profile based on appearance of pet profile. "}}