{"cell_type":{"22414afb":"code","bbedaede":"code","60061e8f":"code","40c91c02":"code","2d0e973f":"code","cc2c4205":"markdown","2c619785":"markdown","c8661df1":"markdown","308f5fd1":"markdown"},"source":{"22414afb":"!pip install tensorflow_io","bbedaede":"import os\nimport tensorflow as tf\nimport tensorflow_io as tfio\nfrom tqdm.notebook import tqdm","60061e8f":"# Reading DICOM images\n\ndef read_dicom(path):\n    image_bytes = tf.io.read_file(path)\n    image = tfio.image.decode_dicom_image(\n        image_bytes, \n        dtype = tf.uint16\n    )\n    \n    image = tf.squeeze(image, axis = 0)\n    \n    image = tf.image.resize(\n        image, \n        (500, 500), \n        preserve_aspect_ratio = True\n    )\n    \n    image = image - tf.reduce_min(image)\n    image = image \/ tf.reduce_max(image)\n    image = tf.cast(image * 255, tf.uint8)\n    \n    return image","40c91c02":"# Destination folder\ndestination = \"train_jpeg\"\nos.makedirs(\"train_jpeg\", exist_ok = True)","2d0e973f":"# Source folder\nsource = \"..\/input\/vinbigdata-chest-xray-abnormalities-detection\/train\"\n\nfor name in tqdm(sorted(os.listdir(source))[:100]):\n    image = read_dicom(os.path.join(source, name))\n    image = tf.io.encode_jpeg(\n        image, \n        quality = 100, \n        format = 'grayscale'\n    )\n    \n    name = name.replace(\".dicom\", \".jpeg\")\n    tf.io.write_file(os.path.join(destination, name), image)","cc2c4205":"## Install libraries","2c619785":"# VinBigData Chest X-ray Abnormalities Detection\n\n* The aim of this notebook is to demonstrate how to create JPEG images from DICOM images using TensorFlow only. \n* This notebook may be useful to those who wish to use TensorFlow to handle DICOM images and build models using JPEG images (other alternatives include TFRecord).\n\n**Note** \n* It may take a long time to convert all images and the images occupy much space, even if they are resized.\n* You may want to use a GPU for this notebook to run successfully (I got errors without it :P). Using PyDICOM instead may be slightly faster.","c8661df1":"## Save JPEG images","308f5fd1":"## Read DICOM images"}}