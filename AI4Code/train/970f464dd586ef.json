{"cell_type":{"71816d9e":"code","d6361237":"code","245d2399":"code","b4282eee":"code","eb44bbc4":"code","d31f148e":"code","02ecbc9e":"code","9746bbfc":"code","fe089079":"code","a77c0a33":"code","ad478318":"code","754dc1eb":"code","86a20c43":"code","6d78c61f":"code","250b297d":"code","0b2c4379":"code","233d37cc":"markdown","5fe97537":"markdown","1f3bdd46":"markdown","a4fd1b91":"markdown","8ad9777c":"markdown","e6d54d87":"markdown","59cfdde2":"markdown","5b1cf6cf":"markdown","9c39f612":"markdown","04d8ce3c":"markdown"},"source":{"71816d9e":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n\n!pip install arch >\/dev\/null\nfrom arch.univariate import ARX,  ARCH, GARCH\nfrom sklearn.metrics import mean_squared_error\nfrom fbprophet import Prophet\n\nimport warnings\nwarnings.filterwarnings('ignore')","d6361237":"df_full = pd.read_csv('\/kaggle\/input\/binance-bitcoin-futures-price-10s-intervals\/prices_btc_Jan_11_2020_to_Jan_07_2021.txt',names=['Price'])\ndf_min  = pd.read_csv('\/kaggle\/input\/binance-bitcoin-futures-price-10s-intervals\/prices_btc_Jan_11_2020_to_May_22_2020.txt',names=['Price'])","245d2399":"df_full = df_full.set_index(pd.date_range(\"2020-01-11\", periods=len(df_full), freq=\"10S\"))\ndf_min = df_min.set_index(pd.date_range(\"2020-01-11\", periods=len(df_min), freq=\"10S\"))","b4282eee":"df_full.tail()","eb44bbc4":"df_min.tail()","d31f148e":"df_full.plot(figsize=(20,12))\nplt.show()","02ecbc9e":"df_full['log_return'] = df_full.Price.apply(np.log1p).diff()\n\n\ndf_full.log_return.plot(figsize=(10,10))\nplt.show()","9746bbfc":"train, test = df_full[:-15], df_full[-15:]","fe089079":"ar = ARX(train.log_return.dropna(), lags=[1,2,3,4,5])\nprint(ar.fit().summary())","a77c0a33":"ar.volatility = GARCH(p=1, o=1, q=1)\nres = ar.fit(disp=\"off\")\nprint(res.summary())","ad478318":"pred = res.forecast(horizon=15)","754dc1eb":"pred_ar = train.Price.iloc[-1] + pred.mean.dropna().apply(np.expm1).cumsum()\npred_ar.values[0]","86a20c43":"mean_squared_error(test.Price.values, pred_ar.values[0])","6d78c61f":"df_full['ds'] = df_full.index","250b297d":"df_full['ds'] = df_full.index\n\ndf_prophet = df_full[['ds','Price']]\ndf_prophet.columns = ['ds','y']\nmodel = Prophet()\nmodel.fit(df_prophet[:-15])\npred = model.predict(df_prophet.reset_index())\npred.values","0b2c4379":"mean_squared_error(test.Price.values, pred.values)","233d37cc":"## Adding the timestamp","5fe97537":"# Model Estimation","1f3bdd46":"# Visualising the Price data","a4fd1b91":"## Under Construction ....","8ad9777c":"The price data is non-stationary --> transformation is needed","e6d54d87":"### Resources\n* https:\/\/www.kaggle.com\/joshuaswords\/eda-gold-price-prediction-prophet","59cfdde2":"## Log-transformation and Log-returns data","5b1cf6cf":"## ARIMA -- GARCH","9c39f612":"## Prophet","04d8ce3c":"The mean and variance are constant"}}