{"cell_type":{"101e177d":"code","33e3ba7d":"code","0106f361":"code","98ca1ced":"code","2607e41a":"code","be68912b":"code","a4b78dce":"code","0092a3cf":"code","1c0981f9":"code","149dd232":"code","91bfc49d":"code","1712a408":"code","0eb81ffc":"code","e6f73cc0":"code","d8202326":"code","6e4b0a99":"markdown"},"source":{"101e177d":"#importing libraries\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score","33e3ba7d":"#importing data from my activity url\nfile_url = 'https:\/\/raw.githubusercontent.com\/PacktWorkshops\/The-Data-Science-Workshop\/master\/Chapter04\/Dataset\/phpB0xrNj.csv'","0106f361":"#reading data\ndf = pd.read_csv(file_url)","98ca1ced":"df.head()","2607e41a":"#data preprocessing\ny = df.pop('class')","be68912b":"#splitting train and test data.\nX_train, X_test, y_train, y_test = train_test_split(df, y, test_size=0.3, random_state=888)","a4b78dce":"#training model\ndef train_rf(X_train, y_train, random_state=888, n_estimators=10, max_depth=None, min_samples_leaf=1, max_features='sqrt'):\n  rf_model = RandomForestClassifier(random_state=random_state, n_estimators=n_estimators, max_depth=max_depth, min_samples_leaf=min_samples_leaf, max_features=max_features)\n  rf_model.fit(X_train, y_train)\n  return rf_model","0092a3cf":"rf_1 = train_rf(X_train, y_train)\nrf_1.get_params()","1c0981f9":"#getting model prediction\ndef get_preds(rf_model, X_train, X_test):\n  train_preds = rf_model.predict(X_train)\n  test_preds = rf_model.predict(X_test)\n  return train_preds, test_preds","149dd232":"trn_preds, tst_preds = get_preds(rf_1, X_train, X_test)","91bfc49d":"#printing accuracy\ndef print_accuracy(y_train, y_test, train_preds, test_preds):\n  train_acc = accuracy_score(y_train, train_preds)\n  test_acc = accuracy_score(y_test, test_preds)\n  print(train_acc)\n  print(test_acc)\n  return train_acc, test_acc","1712a408":"trn_acc, tst_preds = print_accuracy(y_train, y_test, trn_preds, tst_preds)","0eb81ffc":"def fit_predict_rf(X_train, X_test, y_train, y_test, random_state=888, n_estimators=10, max_depth=None, min_samples_leaf=1, max_features='sqrt'):\n  rf_model = train_rf(X_train, y_train, random_state=random_state, n_estimators=n_estimators, max_depth=max_depth, min_samples_leaf=min_samples_leaf, max_features=max_features)\n  train_preds, test_preds = get_preds(rf_model, X_train, X_test)\n  train_acc, test_acc = print_accuracy(y_train, y_test, train_preds, test_preds)\n  return rf_model, train_preds, test_preds, train_acc, test_acc","e6f73cc0":"#training and testing model for accuracy.\nrf_model_1, trn_preds_1, tst_preds_1, trn_acc_1, tst_acc_1 = fit_predict_rf(X_train, X_test, y_train, y_test, random_state=888, n_estimators=20, max_depth=None, min_samples_leaf=1, max_features='sqrt')","d8202326":"#training and testing model again for higher accuracy\nrf_model_2, trn_preds_2, tst_preds_2, trn_acc_2, tst_acc_2 = fit_predict_rf(X_train, X_test, y_train, y_test, random_state=888, n_estimators=50, max_depth=None, min_samples_leaf=1, max_features='sqrt')","6e4b0a99":"# Here is my work on numerical dataset."}}