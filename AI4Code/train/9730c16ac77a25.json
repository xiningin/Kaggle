{"cell_type":{"b831f94b":"code","e14a62ac":"code","315d37af":"code","1722473a":"code","2dc6bb6b":"markdown","24097048":"markdown","055e9e72":"markdown","1680caf2":"markdown","766a2575":"markdown","ad7eccad":"markdown","811cea75":"markdown","36386d43":"markdown","91a94bb2":"markdown","d2f9b800":"markdown","c92844d7":"markdown","ae8a0df1":"markdown","e88be31e":"markdown","997213a0":"markdown","062f267e":"markdown"},"source":{"b831f94b":"install.packages('ggplot2')","e14a62ac":"setwd('C:\/Users\/user\/Desktop\/\uc0c8 \ud3f4\ub354')\ngetwd()\n\ninstall.packages(\"UsingR\")\n\nlibrary(readr)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(UsingR)\n\ndata2 = read_csv('data2.csv')\ndata2\ndata2 = as.data.frame(data2); data2\n\n\ndata3 = read.csv('data3.csv')\nhead(data3)\n\nname_area = data3$\uc790\uce58\uad6c\n\nnew = data3$\ud574\ub2f9\uc5ed.\ud638\uc120.; head(new)\nnew2 = strsplit(new, split = ' '); new2\n\nlength = data3[,4]; length\n\n\nnew2_unlist = unlist(new2)\nindex = regexpr(\"\\\\W\", new2_unlist)\n\na = substr(new2_unlist, start = 1, stop = index-1)\nb = substr(new2_unlist, start = index+1, stop = nchar(new2_unlist)-1)\n\nnew_data_frame = data.frame(b,a)\nnew_data_frame\nd = rep(name_area, length)\nnew_data_frame = data.frame(new_data_frame, d)\n\ncolnames(new_data_frame) = c('\ud638\uc120', '\uc5ed\uc0ac\uba85', '\uc790\uce58\uad6c')\nhead(new_data_frame)\n\ndata2\norder_data2 = data2[order(data2[,1], data2[,2]), ]\norder_data2\n\norder_new_data_frame = new_data_frame[order(new_data_frame[,1], \n                                            new_data_frame[,2]),]\n\n\norder_new_data_frame\n\nnrow(order_data2)\nnrow(order_new_data_frame)\nlength(d)\n\n\n#-----\ub2e4\ub978 \ucef4\ud4e8\ud130\ub85c \ub370\uc774\ud130\ub9cc \uc804\ucc98\ub9ac \uacfc\uc815\ud558\uc5ec \uc0c8\ub85c csv \ud30c\uc77c\uc744 \ub9cc\ub4e4\uc5b4\uc11c \uc791\uc5c5---\n#order_data2 \ub370\uc774\ud130 \uc804\ucc98\ub9ac\n  #\ud568\uc218 \ub9cc\ub4e4\uae30\nsubstrRight <- function(x, n){\n  substr(x, nchar(x)-n+1, nchar(x))\n}\n\n  #\uc5ed\uc0ac\uba85\uc5d0\uc11c \ub05d\uae00\uc790 \ubd80\ub974\uae30\nc=substrRight(order_data2['\uc5ed\uc0ac\uba85'][,1], 1)\n\n  # \uc5ed\uc0ac\uba85\uc5d0\uc11c \ub05d\uae00\uc790\uac00 \uc22b\uc790\ub85c \ub05d\ub098\ub294 \uac83\uc744 \uc9c0\uc6b0\uae30\ntemp=c()\nfor (i in 1:length(c)){\n  if(!is.na(as.numeric(c))[i]){\n    temp[i]=substr(order_data2['\uc5ed\uc0ac\uba85'][,1][i], start = 1,\n                   stop = nchar(order_data2['\uc5ed\uc0ac\uba85'][,1][i])-1)\n  } else{\n    temp[i]=order_data2['\uc5ed\uc0ac\uba85'][,1][i]\n  }\n}\ntemp1=c()\nd=substrRight(temp, 1)\n\n  #\uc22b\uc790 \uc9c0\uc6b0\uace0 \ub098\uc11c \ub05d\uae00\uc790\uac00 \uc5ed\uc73c\ub85c \ub05d\ub098\ub294 \uac83\uc744 \uc9c0\uc6b0\uae30 (ex-> \uc11c\uc6b8\uc5ed-> \uc11c\uc6b8)\nfor (i in 1:length(d)){\n  if(d[i]==\"\uc5ed\"){\n    temp1[i]=substr(temp[i], start = 1,\n                   stop = nchar(temp[i])-1)\n  } else{\n    temp1[i]=temp[i]\n  }\n}\n\ntemp1\n\norder_data2$\uc5ed\uc0ac\uba85<-temp1\n\n  #data2\uc5d0 data3\uc758 \uc790\uce58\uad6c\ub97c \ud638\uc120\uacfc \uc5ed\uc0ac\uba85\uacfc \ub9e4\uce6d\ud558\uc5ec \ub07c\uc6b0\uae30\ndd=merge(order_data2,order_new_data_frame,by=c(\"\ud638\uc120\",\"\uc5ed\uc0ac\uba85\"))\ndd\n\nwrite.csv(dd, 'newdata.csv')\n\n#----------\n\nnewdata = read.csv('newdata.csv')\ndata1 = read.csv('data1.csv')\nstr(data1)\ntable(data1$\uc870\uc0ac\uc77c\uc790)\n\n\nclass(data1)\nt = as.numeric(data1[2,6:44])\nhours = rep(5:24, each = 2)\ncha = rep(':', length(hours))\nminutes = rep(c('00', '30'), length(hours)\/2)\ntime = paste0(hours, cha, minutes)[-1]\ntime[39] = '00:30'\nymd = c(rep('220101', length(time)-1), rep('220102', 1))\np = paste(ymd, time)\nPO = as.POSIXct(p, format = '%y%m%d %H:%M')\nt2 = as.numeric(data1[3,6:44])\n\ndf = data.frame(PO, t, t2)\nggplot(df, aes(x = PO, y = t, group = 1)) +\n  geom_line(color = 'hotpink') +\n  geom_line(aes(x = PO, y = t2))\n\n#--------------------------\n#\ud638\uc120 \n#\ub4a4\uc5d0 \ud638\uc120 \uae00\uc790 \uc790\uc6b0\uae30& 1~9\ud638\uc120\uc774 \uc544\ub2cc\uac70 2\ud638\uc120\uc73c\ub85c \ubc14\uafd4\uc90c\ndata1$\ud638\uc120<-gsub(\"\ud638\uc120\", \"\", data1$\ud638\uc120) #\ub4a4\uc5d0 \ud638\uc120 \uc9c0\uc6b0\uae30\nclass(data1$\ud638\uc120) #\ud638\uc120\uc758 \ub370\uc774\ud130 \ud615\ud0dc \ud30c\uc545  -> \ub530\ub77c\uc11c 2\ud638\uc120\uc740 258+48\uac1c\uc5ec\uc57c\ub428\ntable(data1$\ud638\uc120) #\ud638\uc120\uc758 \ud14c\uc774\ube14 \ud655\uc778\ntable(is.na(as.numeric(data1$\ud638\uc120)))\nis.na(as.numeric(data1$\ud638\uc120))[1]\n\nfor(i in 1:length(data1$\ud638\uc120)){\n  if (is.na(as.numeric(data1$\ud638\uc120))[i]){\n    data1$\ud638\uc120[i]<-\"2\"\n  }else{\n    data1$\ud638\uc120[i]<-data1$\ud638\uc120[i]\n  }\n}\ntable(data1$\ud638\uc120) #2\ud638\uc120\uc774 306\uac1c\ub85c \ub9de\uc74c \n\n\ndata1\n\n#\ud638\uc120\uacfc \uc5ed\uba85\uc744 \uae30\uc900\uc73c\ub85c \uad6c \ucd94\uac00\no=merge(data1,order_new_data_frame,by.x=c('\uc5ed\uba85','\ud638\uc120'),by.y=c('\uc5ed\uc0ac\uba85','\ud638\uc120'),all=T)\n\n#\ud544\uc694\uc5c6\ub294 \ub370\uc774\ud130 \uc0ad\uc81c\nnew_data1=o[-which(is.na(o$\uc870\uc0ac\uc77c\uc790)),]\nnew_data1\n\n\n#-------------------1\ud638\uc120 \ud3c9\uc77c\ub9cc\n\ndata1_line1 = new_data1[new_data1$\ud638\uc120 == 1 & new_data1$\uc870\uc0ac\uc77c\uc790 =='\ud3c9\uc77c',]\nt = t(as.data.frame(data1_line1[,6:44]))\nt = data.frame(PO, t)\n\ntemp = c()\nfor(i in 2:ncol(t)){\n  temp = c(temp, t[,i])\n}\ntemp\ndf2 = data.frame(rep(PO, length(temp)\/39), temp)\n\nnames = paste(data1_line1$\uc5ed\uba85, data1_line1$\uad6c\ubd84)\nnames = rep(names, each = 39)\n\ndf2 = data.frame(df2, names)\ncolnames(df2) = c('PO', 'y', 'names')\nPO_hm = strftime(PO, format = '%H:%M')\n\n\nggplot1 = ggplot(df2, aes(x = PO, y = y, fill = names, colour = names)) +\n  geom_line() +\n  scale_x_continuous(breaks = PO, labels = PO_hm) +\n  labs(title = '1\ud638\uc120 \ud3c9\uc77c \uc5ed\ubcc4 \ud63c\uc7a1\ub3c4',\n       x = '\uc2dc\uac04', y = '\ud63c\uc7a1\ub3c4(%)',\n       fill = '\ubc94\ub840') +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.title = element_blank(),\n        axis.text.x = element_text(angle = 45, hjust = 1))\nggplot1\n\n#----------2\ud638\uc120 \ud3c9\uc77c\ub9cc----\n\ndata1_line2 = new_data1[new_data1$\ud638\uc120 =='2'&new_data1$\uc870\uc0ac\uc77c\uc790 =='\ud3c9\uc77c',]\nt2 = t(as.data.frame(data1_line2[,6:44]))\nt2 = data.frame(PO, t2)\n\ntemp2 = c()\nfor(i in 2:ncol(t2)){\n  temp2 = c(temp2, t2[,i])\n}\ntemp2\ndf_2 = data.frame(rep(PO, length(temp2)\/39), temp2)\nnames_2 = paste(data1_line2$\uc5ed\uba85, data1_line2$\uad6c\ubd84)\nnames_2 = rep(names_2, each = 39)\n\ndf_2 = data.frame(df_2, names_2)\ncolnames(df_2) = c('PO', 'y', 'names')\nPO_hm_2 = strftime(PO, format = '%H:%M')\n\nggplot2 = ggplot(df_2, aes(x = PO, y = y, fill = names, colour = names)) +\n  geom_line() +\n  scale_x_continuous(breaks = PO, labels = PO_hm) +\n  labs(title = '2\ud638\uc120 \ud3c9\uc77c \uc5ed\ubcc4 \ud63c\uc7a1\ub3c4',\n       x = '\uc2dc\uac04', y = '\ud63c\uc7a1\ub3c4(%)',\n       fill = '\ubc94\ub840') +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.title = element_blank(),\n        axis.text.x = element_text(angle = 45, hjust = 1))\n\nggplot2  \n\n#-------------3\ud638\uc120\ndata1_line3 = new_data1[new_data1$\ud638\uc120 =='3'&new_data1$\uc870\uc0ac\uc77c\uc790 =='\ud3c9\uc77c',]\nt3 = t(as.data.frame(data1_line3[,6:44]))\nt3 = data.frame(PO, t3)\n\ntemp3 = c()\nfor(i in 2:ncol(t3)){\n  temp3 = c(temp3, t3[,i])\n}\ntemp3\ndf_3 = data.frame(rep(PO, length(temp3)\/39), temp3)\nnames_3 = paste(data1_line3$\uc5ed\uba85, data1_line3$\uad6c\ubd84)\nnames_3 = rep(names_3, each = 39)\n\ndf_3 = data.frame(df_3, names_3)\ncolnames(df_3) = c('PO', 'y', 'names')\nPO_hm_3 = strftime(PO, format = '%H:%M')\n\nggplot3 = ggplot(df_3, aes(x = PO, y = y, fill = names, colour = names)) +\n  geom_line() +\n  scale_x_continuous(breaks = PO, labels = PO_hm) +\n  labs(title = '3\ud638\uc120 \ud3c9\uc77c \uc5ed\ubcc4 \ud63c\uc7a1\ub3c4',\n       x = '\uc2dc\uac04', y = '\ud63c\uc7a1\ub3c4(%)',\n       fill = '\ubc94\ub840') +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.title = element_blank(),\n        axis.text.x = element_text(angle = 45, hjust = 1))\n\nggplot3  \n\n#----------------1\ud638\uc120 \uc8fc\ub9d0\ndata1_line1_sat = new_data1[new_data1$\ud638\uc120 =='1'&new_data1$\uc870\uc0ac\uc77c\uc790 =='\ud1a0\uc694\uc77c',]\ndata1_line1_sun = new_data1[new_data1$\ud638\uc120 =='1'&new_data1$\uc870\uc0ac\uc77c\uc790 =='\uc77c\uc694\uc77c',]\nt1_sat = t(as.data.frame(data1_line1_sat[,6:44]))\nt1_sun = t(as.data.frame(data1_line1_sun[,6:44]))\nt1_weekend = (t1_sat + t1_sun)\/2 \n\nt1_weekend = data.frame(PO, t1_weekend)\n\ntemp1_weekend = c()\nfor(i in 2:ncol(t1_weekend)){\n  temp1_weekend = c(temp1_weekend, t1_weekend[,i])\n}\ntemp1_weekend\ndf_1_weekend = data.frame(rep(PO, length(temp1_weekend)\/39), temp1_weekend)\nnames_1 = paste(data1_line1_sat$\uc5ed\uba85, data1_line1_sat$\uad6c\ubd84)\nnames_1 = rep(names_1, each = 39)\n\ndf_1_weekend = data.frame(df_1_weekend, names_1)\ncolnames(df_1_weekend) = c('PO', 'y', 'names')\nPO_hm = strftime(PO, format = '%H:%M')\n\nggplot1_weekend = ggplot(df_1_weekend, aes(x = PO, y = y, fill = names, colour = names)) +\n  geom_line() +\n  scale_x_continuous(breaks = PO, labels = PO_hm) +\n  labs(title = '1\ud638\uc120 \uc8fc\ub9d0 \uc5ed\ubcc4 \ud63c\uc7a1\ub3c4',\n       x = '\uc2dc\uac04', y = '\ud63c\uc7a1\ub3c4(%)',\n       fill = '\ubc94\ub840') +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.title = element_blank(),\n        axis.text.x = element_text(angle = 45, hjust = 1))\n\nggplot1_weekend  \n\n\n#----------------1\ud638\uc120 \uac00\uc124\uac80\uc815\nx1_week = new_data1[new_data1$\ud638\uc120==1 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud3c9\uc77c',][,6:42]\nx1_week_time_averge = apply(x1_week, 2, mean)\n\ny1_sat = new_data1[new_data1$\ud638\uc120==1 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud1a0\uc694\uc77c',][,6:42]\ny1_sun = new_data1[new_data1$\ud638\uc120==1 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\uc77c\uc694\uc77c',][,6:42]\ny1_weekend = (y1_sat + y1_sun)\/2\ny1_weekend_time_averge = apply(y1_weekend, 2, mean)\n\npar(mfrow = c(1,2))\nplot(x1_week_time_averge)\nplot(y1_weekend_time_averge)\n\n\ndif_1 = x1_week_time_averge - y1_weekend_time_averge\nt.test(dif_1, alternative = 'two.sided')\n\n\n#--------------------2\ud638\uc120 \uac00\uc124\uac80\uc815\n\nx2_week = new_data1[new_data1$\ud638\uc120==2 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud3c9\uc77c',][,6:42]\nx2_week_time_averge = apply(x2_week, 2, mean)\n\ny2_sat = new_data1[new_data1$\ud638\uc120==2 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud1a0\uc694\uc77c',][,6:42]\ny2_sun = new_data1[new_data1$\ud638\uc120==2 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\uc77c\uc694\uc77c',][,6:42]\ny2_weekend = (y2_sat + y2_sun)\/2\ny2_weekend_time_averge = apply(y2_weekend, 2, mean)\n\npar(mfrow = c(1,2))\nplot(x2_week_time_averge)\nplot(y2_weekend_time_averge)\n\ndif_2 = x2_week_time_averge - y2_weekend_time_averge\nt.test(dif_2, alternative = 'two.sided')\n\n\n#--------------------3\ud638\uc120 \uac00\uc124\uac80\uc815\n\nx3_week = new_data1[new_data1$\ud638\uc120==3 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud3c9\uc77c',][,6:42]\nx3_week_time_averge = apply(x3_week, 2, mean)\n\ny3_sat = new_data1[new_data1$\ud638\uc120==3 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud1a0\uc694\uc77c',][,6:42]\ny3_sun = new_data1[new_data1$\ud638\uc120==3 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\uc77c\uc694\uc77c',][,6:42]\ny3_weekend = (y3_sat + y3_sun)\/2\ny3_weekend_time_averge = apply(y3_weekend, 2, mean)\n\npar(mfrow = c(1,2))\nplot(x3_week_time_averge)\nplot(y3_weekend_time_averge)\n\ndif_3 = x3_week_time_averge - y3_weekend_time_averge\nt.test(dif_3, alternative = 'two.sided')\n\n#--------------------4\ud638\uc120 \uac00\uc124\uac80\uc815\n\nx4_week = new_data1[new_data1$\ud638\uc120==4 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud3c9\uc77c',][,6:42]\nx4_week_time_averge = apply(x4_week, 2, mean)\n\ny4_sat = new_data1[new_data1$\ud638\uc120==4 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud1a0\uc694\uc77c',][,6:42]\ny4_sun = new_data1[new_data1$\ud638\uc120==4 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\uc77c\uc694\uc77c',][,6:42]\ny4_weekend = (y4_sat + y4_sun)\/2\ny4_weekend_time_averge = apply(y4_weekend, 2, mean)\n\npar(mfrow = c(1,2))\nplot(x4_week_time_averge)\nplot(y4_weekend_time_averge)\n\ndif_4 = x4_week_time_averge - y4_weekend_time_averge\nt.test(dif_4, alternative = 'two.sided')\n\n#--------------------5\ud638\uc120 \uac00\uc124\uac80\uc815\n\nx5_week = new_data1[new_data1$\ud638\uc120== 5 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud3c9\uc77c',][,6:42]\nx5_week_time_averge = apply(x5_week, 2, mean)\n\ny5_sat = new_data1[new_data1$\ud638\uc120==5 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud1a0\uc694\uc77c',][,6:42]\ny5_sun = new_data1[new_data1$\ud638\uc120==5 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\uc77c\uc694\uc77c',][,6:42]\ny5_weekend = (y5_sat + y5_sun)\/2\ny5_weekend_time_averge = apply(y5_weekend, 2, mean)\n\npar(mfrow = c(1,2))\nplot(x5_week_time_averge)\nplot(y5_weekend_time_averge)\n\ndif_5 = x5_week_time_averge - y5_weekend_time_averge\nt.test(dif_5, alternative = 'two.sided')\n\n#--------------------6\ud638\uc120 \uac00\uc124\uac80\uc815\n\nx6_week = new_data1[new_data1$\ud638\uc120== 6 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud3c9\uc77c',][,6:42]\nx6_week_time_averge = apply(x6_week, 2, mean)\n\ny6_sat = new_data1[new_data1$\ud638\uc120==6 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud1a0\uc694\uc77c',][,6:42]\ny6_sun = new_data1[new_data1$\ud638\uc120==6 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\uc77c\uc694\uc77c',][,6:42]\ny6_weekend = (y6_sat + y6_sun)\/2\ny6_weekend = y6_weekend[complete.cases(y6_weekend), ]\ny6_weekend_time_averge = apply(y6_weekend, 2, mean)\npar(mfrow = c(1,2))\nplot(x6_week_time_averge)\nplot(y6_weekend_time_averge)\n\ndif_6 = x6_week_time_averge - y6_weekend_time_averge\nt.test(dif_6, alternative = 'two.sided')\n\n#--------------------7\ud638\uc120 \uac00\uc124\uac80\uc815\n\nx7_week = new_data1[new_data1$\ud638\uc120== 7 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud3c9\uc77c',][,6:42]\nx7_week_time_averge = apply(x7_week, 2, mean)\n\ny7_sat = new_data1[new_data1$\ud638\uc120==7 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud1a0\uc694\uc77c',][,6:42]\ny7_sun = new_data1[new_data1$\ud638\uc120==7 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\uc77c\uc694\uc77c',][,6:42]\ny7_weekend = (y7_sat + y7_sun)\/2\ny7_weekend[is.na(y7_weekend)] = 0\ny7_weekend_time_averge = apply(y7_weekend, 2, mean)\npar(mfrow = c(1,2))\nplot(x7_week_time_averge)\nplot(y7_weekend_time_averge)\n\ndif_7 = x7_week_time_averge - y7_weekend_time_averge\nt.test(dif_7, alternative = 'two.sided')\n\n#--------------------8\ud638\uc120 \uac00\uc124\uac80\uc815\n\nx8_week = new_data1[new_data1$\ud638\uc120== 8 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud3c9\uc77c',][,6:42]\nx8_week_time_averge = apply(x8_week, 2, mean)\n\ny8_sat = new_data1[new_data1$\ud638\uc120==8 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud1a0\uc694\uc77c',][,6:42]\ny8_sun = new_data1[new_data1$\ud638\uc120==8 & new_data1$\uc870\uc0ac\uc77c\uc790 == '\uc77c\uc694\uc77c',][,6:42]\ny8_weekend = (y8_sat + y8_sun)\/2\ny8_weekend_time_averge = apply(y8_weekend, 2, mean)\n\npar(mfrow = c(1,2))\nplot(x8_week_time_averge)\nplot(y8_weekend_time_averge)\n\ndif_8 = x8_week_time_averge - y8_weekend_time_averge\nt.test(dif_8, alternative = 'two.sided')\n\n#----------------\uc131\ubd81\ubcc4 \ud63c\uc7a1\ub3c4 \ud3c9\uc77c\/\uc8fc\ub9d0 \uac00\uc124\uac80\uc815---------------------\nsungbuk_week = new_data1[new_data1$\uc790\uce58\uad6c == '\uc131\ubd81\uad6c'& new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud3c9\uc77c',][,6:45]\nsungbuk_week = sungbuk_week[!is.na(sungbuk_week$\uc790\uce58\uad6c),][,1:37]\nsungbuk_week_time_averge = apply(sungbuk_week, 2, mean)\n\nsungbuk_sat = new_data1[new_data1$\uc790\uce58\uad6c == '\uc131\ubd81\uad6c'& new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud1a0\uc694\uc77c',][,6:45]\nsungbuk_sat = sungbuk_sat[!is.na(sungbuk_sat$\uc790\uce58\uad6c),][,1:37]\n\nsungbuk_sun = new_data1[new_data1$\uc790\uce58\uad6c == '\uc131\ubd81\uad6c'& new_data1$\uc870\uc0ac\uc77c\uc790 == '\uc77c\uc694\uc77c',][,6:45]\nsungbuk_sun = sungbuk_sun[!is.na(sungbuk_sun$\uc790\uce58\uad6c),][,1:37]\n\nsungbuk_weekend = (sungbuk_sat + sungbuk_sun) \/ 2\nsungbuk_weekend_time_average = apply(sungbuk_weekend, 2, mean)\n\nplot(sungbuk_week_time_averge)\nplot(sungbuk_weekend_time_average)\n\ndif_sungbuk = sungbuk_week_time_averge - sungbuk_weekend_time_average\nt.test(dif_sungbuk, alternative = 'two.sided')\n\n\n#----------------\uac15\ub0a8 \ud63c\uc7a1\ub3c4 \ud3c9\uc77c\/\uc8fc\ub9d0 \uac00\uc124\uac80\uc815---------------------\ngangnam_week = new_data1[new_data1$\uc790\uce58\uad6c == '\uac15\ub0a8\uad6c'& new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud3c9\uc77c',][,6:45]\ngangnam_week = gangnam_week[!is.na(gangnam_week$\uc790\uce58\uad6c),][,1:37]\ngangnam_week_time_averge = apply(gangnam_week, 2, mean)\n\ngangnam_sat = new_data1[new_data1$\uc790\uce58\uad6c == '\uac15\ub0a8\uad6c'& new_data1$\uc870\uc0ac\uc77c\uc790 == '\ud1a0\uc694\uc77c',][,6:45]\ngangnam_sat = gangnam_sat[!is.na(gangnam_sat$\uc790\uce58\uad6c),][,1:37]\n\ngangnam_sun = new_data1[new_data1$\uc790\uce58\uad6c == '\uac15\ub0a8\uad6c'& new_data1$\uc870\uc0ac\uc77c\uc790 == '\uc77c\uc694\uc77c',][,6:45]\ngangnam_sun = gangnam_sun[!is.na(gangnam_sun$\uc790\uce58\uad6c),][,1:37]\n\ngangnam_weekend = (gangnam_sat + gangnam_sun) \/ 2\ngangnam_weekend_time_average = apply(gangnam_weekend, 2, mean)\n\nplot(gangnam_week_time_averge)\nplot(gangnam_weekend_time_average)\n\ndif_gangnam = gangnam_week_time_averge - gangnam_weekend_time_average\nt.test(dif_gangnam, alternative = 'two.sided')\n\n\n#-------------------\n#\ub300\uae30 \uc0b0\uc810\ub3c4\n#-------------------------\ninstall.packages('ggbreak')\nlibrary(ggbreak)\nlibrary(dplyr)\nnew_order_data2<-read.csv(\"newdata.csv\")\nnew_order_data2 %>%\n  ggplot(aes(x = \uc5ed\uc0ac\uba85)) + \n  geom_point(aes(y = CO, group = 1, color = 'CO')) +\n  geom_point(aes(y = HCHO, group = 1, color = 'HCHO')) +\n  geom_point(aes(y = CO2, group = 1, color = 'CO2')) +\n  geom_point(aes(y = PM10, group = 1, color = 'PM10')) +\n  scale_y_break(c(max(new_order_data2$CO), min(new_order_data2$HCHO)), scale = 1.5)+\n  scale_y_break(c(max(new_order_data2$HCHO), min(new_order_data2$PM10)), scale = 1.5) +\n  scale_y_break(c(max(new_order_data2$PM10), min(new_order_data2$CO2)), scale = 1.5)\n\n#\ub300\uae30\ubcc4 \uc0c1\uad00\uad00\uacc4\n#\uc0c1\uad00\uad00\uacc4 \ub098\ud0c0\ub0b4\uae30\ncornew=cor(data2[,3:6])\n#\uc0c1\uad00\ud589\ub82c \ub9cc\ub4e4\uae30\nlibrary(corrplot)\ncol=colorRampPalette(c(\"#BB4444\",\"#EE9988\",\"#FFFFFF\",\"#77AADD\",\"#4477AA\"))\ncorrplot(cornew,\n         method = 'color',\n         col=col(200),\n         type='lower',\n         order='hclust',\n         addCoef.col = \"black\",\n         tl.col=\"black\",\n         tl.srt=45,\n         diag=F)\n\n#\uc790\uce58\uad6c\ubcc4\ub85c \uadf8\ub8f9\ud654\ud558\uc5ec 4\uac00\uc9c0 \ud658\uacbd \uc131\ubd84 \ud3c9\uade0\ud55c \ub370\uc774\ud130 \ud504\ub808\uc784 \ub9cc\ub4e4\uae30\nlibrary(dplyr)\nmean_poll=as.data.frame(dd %>% \n                          group_by(\uc790\uce58\uad6c) %>% \n                          summarise(mean_PM10=mean(PM10),\n                                    mean_CO2=mean(CO2),\n                                    mean_HCHO=mean(HCHO),\n                                    mean_CO=mean(CO)))\nmean_poll\n\n#\uc9c0\ub3c4 \uc2dc\uac01\ud654 \ud558\uae30\n#\uc790\uce58\uad6c\uc704\uce58 \uc778\ub371\uc2a4 \uc7a1\uae30\n  #\uc11c\uc6b8\ud2b9\ubcc4\ud788 \uace0\uc720 \ubc88\ud638 \ub2e4\uc6b4\nid=read.csv('seoul_id.csv',fileEncoding = 'CP949',encoding='UTF-8')\n  #\uc790\uce58\uad6c\ub07c\ub9ac \ubb36\uc5b4\uc11c \uace0\uc720\ubc88\ud638\ub97c \uc55e \ub370\uc774\ud0c0 \ud504\ub808\uc784\uc5d0 \ub123\uae30\nmean_poll=merge(mean_poll,id,by.x='\uc790\uce58\uad6c',by.y='\uc2dc\uad70\uad6c\uba85')\n\n  #\uc9c0\ub3c4\uc2dc\uac01\ud654 \ubcf8\uaca9\ud654\ninstall.packages(\"ggmap\")\ninstall.packages(\"ggplot2\")\ninstall.packages('raster')\ninstall.packages('rgeos')\ninstall.packages('maptools')\ninstall.packages('rgdal')\nlibrary('ggmap')\nlibrary('ggplot2')\nlibrary('raster')\nlibrary('rgeos')\nlibrary('maptools')\nlibrary('rgdal')\n  \n  #\uacbd\ub3c4 \uc704\ub3c4 \ub370\uc774\ud130\uc640 \ud569\uce58\uae30\nmap_shape<-shapefile('TL_SCCO_SIG.shp')\nmap <- spTransform(map_shape, CRSobj = CRS('+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs'))\nnew_map<-fortify(map,region='SIG_CD')\nView(new_map)\n\nnew_map$id<-as.numeric(new_map$id)\nseoul_map<-new_map[new_map$id<=11740,]\n\nM<-merge(seoul_map,mean_poll,by='id')\n  #\uc790\uce58\uad6c\ubcc4 4\uac1c\uc758 \ud658\uacbd\uc131\ubd84 \ubd84\ud3ec \uc0b4\ud53c\uae30\na=ggplot()+\n  geom_polygon(data=M,\n               aes(x=long,\n                   y=lat,\n                   group=group,\n                   fill=mean_CO2),\n               color='white')+\n  scale_fill_gradient(low = \"#FFDFD3\", \n                     high = 'hotpink', \n                     space = \"Lab\", \n                     guide = \"colourbar\")\nb=ggplot()+\n  geom_polygon(data=M,\n               aes(x=long,\n                   y=lat,\n                   group=group,\n                   fill=mean_CO),\n               color='white')+\n    scale_fill_gradient(low = \"#FFDFD3\", \n                        high = 'hotpink', \n                        space = \"Lab\", \n                        guide = \"colourbar\")\nc=ggplot()+\n  geom_polygon(data=M,\n               aes(x=long,\n                   y=lat,\n                   group=group,\n                   fill=mean_PM10),\n               color='white')+\n  scale_fill_gradient(low = \"#FFDFD3\", \n                      high = 'hotpink', \n                      space = \"Lab\", \n                      guide = \"colourbar\")\nd=ggplot()+\n  geom_polygon(data=M,\n               aes(x=long,\n                   y=lat,\n                   group=group,\n                   fill=mean_HCHO),\n               color='white')+\n  scale_fill_gradient(low = \"#FFDFD3\", \n                      high = 'hotpink', \n                      space = \"Lab\", \n                      guide = \"colourbar\")\n\nlibrary(gridExtra)\nlibrary(grid)\ngrid.arrange(a,b,c,d,ncol=2,nrow=2,top=textGrob(\"environmental substances\"))\n\n#----------------------------\n\n#environmental substances \uc9c0\ub3c4 \uc2dc\uac01\ud654 \ud55c\uac70\uc5d0\uc11c \ud55c\uae00 \ucd94\uac00 \nlibrary(dplyr)\nm<-merge(mean_poll,seoul_map,by='id')\ngue_inform=as.data.frame(m %>% \n                           group_by(\uc790\uce58\uad6c) %>% \n                           summarise(long=round(mean(long),3),\n                                     lat=mean(lat),\n                                     CO2=mean(mean_CO2),\n                                     CO=mean(mean_CO),\n                                     HCHO=mean(mean_HCHO),\n                                     PM10=mean(mean_PM10))) \ne=ggplot()+\n  geom_polygon(data=M,\n               aes(x=long,\n                   y=lat,\n                   group=group,\n                   fill=mean_CO2),\n               color=\"white\")+\n  labs(fill = \"CO2 mean\") + \n  scale_fill_gradient(low = \"#FFDFD3\", \n                      high = \"hotpink\", \n                      space = \"Lab\", \n                      guide = \"colourbar\")+\n  theme_void() + \n  theme(legend.position = c(.15, .85)) +\n  geom_text(data = gue_inform, \n            aes(x = long, \n                y = lat, \n                label = paste(\uc790\uce58\uad6c,round(CO2,2),sep='\\n')))\n\nf=ggplot()+\n  geom_polygon(data=M,\n               aes(x=long,\n                   y=lat,\n                   group=group,\n                   fill=mean_CO),\n               color='white')+\n  scale_fill_gradient(low = \"#FFDFD3\", \n                      high = 'hotpink', \n                      space = \"Lab\", \n                      guide = \"colourbar\")+\n  theme_void() + \n  theme(legend.position = c(.15, .85)) +\n  geom_text(data = gue_inform, \n            aes(x = long, \n                y = lat, \n                label = paste(\uc790\uce58\uad6c,round(CO,2),sep='\\n')))\n\ng=ggplot()+\n  geom_polygon(data=M,\n               aes(x=long,\n                   y=lat,\n                   group=group,\n                   fill=mean_PM10),\n               color='white')+\n  scale_fill_gradient(low = \"#FFDFD3\", \n                      high = 'hotpink', \n                      space = \"Lab\", \n                      guide = \"colourbar\")+\n  theme_void() + \n  theme(legend.position = c(.15, .85)) +\n  geom_text(data = gue_inform, \n            aes(x = long, \n                y = lat, \n                label = paste(\uc790\uce58\uad6c,round(PM10,2),sep='\\n')))\n\nh=ggplot()+\n  geom_polygon(data=M,\n               aes(x=long,\n                   y=lat,\n                   group=group,\n                   fill=mean_HCHO),\n               color='white')+\n  scale_fill_gradient(low = \"#FFDFD3\", \n                      high = 'hotpink', \n                      space = \"Lab\", \n                      guide = \"colourbar\")+\n  theme_void() + \n  theme(legend.position = c(.15, .85)) +\n  geom_text(data = gue_inform, \n            aes(x = long, \n                y = lat, \n                label = paste(\uc790\uce58\uad6c,round(HCHO,2),sep='\\n')))\n\n  \ngrid.arrange(e,f,g,h,ncol=2,top=textGrob(\"environmental substances\"))\n\n\n#----------------------------- \ud63c\uc7a1\ub3c4 \uc9c0\ub3c4\uc2dc\uac01\ud654\nnew_data1$X8\uc2dc00\ubd84<-ifelse(is.na(new_data1$X8\uc2dc00\ubd84),\n                         0,new_data1$X8\uc2dc00\ubd84) \nnew_data1$X18\uc2dc00\ubd84<-ifelse(is.na(new_data1$X18\uc2dc00\ubd84),\n                          0,new_data1$X18\uc2dc00\ubd84) \n\ntable(is.na(new_data1$X8\uc2dc00\ubd84)) \ntable(is.na(new_data1$X18\uc2dc00\ubd84)) \n\nnew_data2<-data.frame(\"\uc790\uce58\uad6c\"=new_data1$\uc790\uce58\uad6c,\n                      \"\uc5ed\uc0ac\uba85\"=new_data1$\uc5ed\uba85,\"\ud638\uc120\"=new_data1$\ud638\uc120,\n                      \"8\uc2dc\ud63c\uc7a1\ub3c4\"=new_data1$X8\uc2dc00\ubd84,\"18\uc2dc\ud63c\uc7a1\ub3c4\"=new_data1$X18\uc2dc00\ubd84)\nlibrary(dplyr)\nconfuse1<-as.data.frame(new_data2 %>% \n                         group_by(\uc790\uce58\uad6c) %>% \n                         summarise('X8\uc2dc\ud63c\uc7a1\ub3c4'=mean(X8\uc2dc\ud63c\uc7a1\ub3c4),\n                                   'X18\uc2dc\ud63c\uc7a1\ub3c4'=mean(X18\uc2dc\ud63c\uc7a1\ub3c4)))\n\n\nconfuse2=merge(confuse1,id,by.x='\uc790\uce58\uad6c',by.y='\uc2dc\uad70\uad6c\uba85')\n\nconfuse<-merge(seoul_map,confuse2,by='id')\n\n\ni=ggplot()+\n  geom_polygon(data=confuse,\n               aes(x=long,\n                   y=lat,\n                   group=group,\n                   fill=X8\uc2dc\ud63c\uc7a1\ub3c4),\n               color=\"white\")+\n  labs(fill = \"8hours\") + \n  scale_fill_gradient(low = \"#FFDFD3\", \n                      high = 'hotpink', \n                      space = \"Lab\", \n                      guide = \"colourbar\")\n\nj=ggplot()+\n  geom_polygon(data=confuse,\n               aes(x=long,\n                   y=lat,\n                   group=group,\n                   fill=X18\uc2dc\ud63c\uc7a1\ub3c4),\n               color=\"white\")+\n  labs(fill = \"18hours\") + \n  scale_fill_gradient(low = \"#FFDFD3\", \n                      high = \"hotpink\", \n                      space = \"Lab\", \n                      guide = \"colourbar\")\n\ngrid.arrange(i,j,ncol=2,top=textGrob(\"The level of confusion in the subway station\"))\n\n#-------------\uc704 \uc9c0\ub3c4 \uc2dc\uac01\ud654\uc5d0 \ud55c\uae00 \ucd94\uac00 \ngue_inform2<-as.data.frame(confuse %>% \n  group_by(\uc790\uce58\uad6c) %>% \n  summarise(mean_8\uc2dc=mean(X8\uc2dc\ud63c\uc7a1\ub3c4),\n            mean_18\uc2dc=mean(X18\uc2dc\ud63c\uc7a1\ub3c4),\n            long=mean(long),\n            lat=mean(lat)))\nk=ggplot()+\n  geom_polygon(data=confuse,\n               aes(x=long,\n                   y=lat,\n                   group=group,\n                   fill=X8\uc2dc\ud63c\uc7a1\ub3c4),\n               color=\"white\")+\n  labs(fill = \"8hours\") + \n  scale_fill_gradient(low = \"#FFDFD3\", \n                      high = 'hotpink', \n                      space = \"Lab\", \n                      guide = \"colourbar\")+\n  theme_void() + \n  theme(legend.position = c(.15, .85)) +\n  geom_text(data = gue_inform2, \n            aes(x = long, \n                y = lat, \n                label = paste(\uc790\uce58\uad6c,round(mean_8\uc2dc,2),sep='\\n')))\n\n\nl=ggplot()+\n  geom_polygon(data=confuse,\n               aes(x=long,\n                   y=lat,\n                   group=group,\n                   fill=X18\uc2dc\ud63c\uc7a1\ub3c4),\n               color=\"white\")+\n  labs(fill = \"18hours\") + \n  scale_fill_gradient(low = \"#FFDFD3\", \n                      high = \"hotpink\", \n                      space = \"Lab\", \n                      guide = \"colourbar\")+\n  theme_void() + \n  theme(legend.position = c(.15, .85))+\n  geom_text(data = gue_inform2, \n            aes(x = long, \n                y = lat, \n                label = paste(\uc790\uce58\uad6c,round(mean_18\uc2dc,2),sep='\\n')))\ngrid.arrange(k,l,ncol=2,top=textGrob(\"The level of confusion in the subway station\"))\n\n","315d37af":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","1722473a":"df=pd.read_csv('\/kaggle\/input\/statjbnu1\/vehicles.csv')\ndf.head()","2dc6bb6b":"### References","24097048":"### Data Description ","055e9e72":"### Read Data ","1680caf2":"# \uc804\ubd81\ub300\ud559\uad50 \ud1b5\uacc4\ud559\uacfc \ub370\uc774\ud130\uacbd\uc9c4\ub300\ud68c (2022) ","766a2575":"`-` \uc5c5\ub85c\ub4dc\ub41c \ub370\uc774\ud130 \ud655\uc778 ","ad7eccad":"- \ud300\uc7a5: \ucc28\uc7ac\uc6d0(201612792)\n- \ud300\uc6d0: \uae40\uc740\ud638(201612774), \uc870\uc11c\uc5f0(201816976)","811cea75":"- https:\/\/www.kaggle.com\/austinreese\/craigslist-carstrucks-data","36386d43":"### Data Analysis","91a94bb2":"### Conclusion and Summary","d2f9b800":"`-` read data ","c92844d7":"... ","ae8a0df1":"... ","e88be31e":"... ","997213a0":"### \ud300\uba85: Dream_come=T","062f267e":"### Import "}}