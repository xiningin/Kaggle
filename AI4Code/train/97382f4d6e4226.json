{"cell_type":{"19f19c94":"code","995c1400":"code","c2c9f683":"code","f32564dc":"code","088a9fba":"code","d5b19138":"code","749941a9":"code","74790a9e":"markdown"},"source":{"19f19c94":"# Install packages\n!pip install --upgrade google-cloud-translate==2.0.0\n!pip install --upgrade google-auth","995c1400":"# Handle credentials\nimport json\nfrom google.oauth2 import service_account\nfrom kaggle_secrets import UserSecretsClient\n\nuser_secrets = UserSecretsClient()\nsecret_value = user_secrets.get_secret(\"translation-playground\")\n\nservice_account_info = json.loads(secret_value)\ncredentials = service_account.Credentials.from_service_account_info(\n    service_account_info)","c2c9f683":"# Setup client & translation function\nfrom google.cloud import translate_v2 as translate\n\ntranslate_client = translate.Client(credentials=credentials)\n\ndef translate(text, target_lang, source_lang=\"en\"):\n    try:    \n        result = translate_client.translate(text, target_language=target_lang, source_language=source_lang)\n        return result['translatedText']\n    except:\n        return \"\"","f32564dc":"# Test it\nprint(translate(\"This is a very nice text to translate\", \"de\"))\n","088a9fba":"import pandas as pd\n\ndata = pd.read_csv(\"..\/input\/womens-ecommerce-clothing-reviews\/Womens Clothing E-Commerce Reviews.csv\")\ndata.head()\n\n#data = data[:10]","d5b19138":"data['Review Text DE'] = data.apply(lambda row: translate(row['Review Text'], \"de\"), axis = 1)\n\ndata.head()","749941a9":"data.to_csv(\"\/kaggle\/working\/Reviews_DE.csv\");","74790a9e":"# Introduction\n\nThis notebook shows how to use the [Google's Translation API](https:\/\/cloud.google.com\/translate) to translate review texts from a popular dataset from English to German. To do so, we're\n\n- Using a user-defined secret to store a service account credential within Kaggle (and provide it to the API from within Kernels). If you're forking this Kernel, you have to provide your own\n- Install the necessary packages\n- Initialize the API client and wrap the call in a function\n- Read the input CSV\n- Row by row, call the Translation API and populate a new column to our data\n- Write down the results data\n\n(this naively calls the Translation API row by row. For better performance, use it in [batch mode](https:\/\/cloud.google.com\/translate\/docs\/advanced\/batch-translation))\n"}}