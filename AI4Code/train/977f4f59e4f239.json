{"cell_type":{"d5f41260":"code","4e42bbf7":"code","a2617ab9":"code","be2b518d":"code","929f1858":"code","258cfdcc":"code","c289ab94":"code","670ae519":"code","34f4155c":"code","cc57d895":"code","c8a15950":"markdown","33bd598e":"markdown","f05f460f":"markdown","dab1aab1":"markdown","f60c9653":"markdown","96765dfe":"markdown","5560e96e":"markdown","ede2f320":"markdown","02441c0c":"markdown"},"source":{"d5f41260":"from copy import deepcopy\nimport warnings\n \nwarnings.filterwarnings(\"ignore\")\n \nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\n \nsns.set_style(\"whitegrid\")\n \n%matplotlib inline","4e42bbf7":"data_folder = \"https:\/\/raw.githubusercontent.com\/XelorR\/kaggle_tabular_playground_may21\/master\/input\/tabular-playground-series-may-2021\"\n \ntrain = pd.read_csv(f\"{data_folder}\/train.csv\")\ntest = pd.read_csv(f\"{data_folder}\/test.csv\")\nsample_submission = pd.read_csv(f\"{data_folder}\/sample_submission.csv\")\n \ntrain.shape, test.shape, sample_submission.shape","a2617ab9":"def describe_nums(df, sort_by=\"unique\"):\n    return (\n        df.nunique()\n        .to_frame()\n        .rename(columns={0: \"unique\"})\n        .join(df.describe().T, how=\"left\")\n        .sort_values([sort_by], ascending=False)\n        .style.bar([\"mean\"])\n        .background_gradient(subset=[\"50%\"], cmap=\"viridis\")\n        .background_gradient(subset=[\"std\"], cmap=\"Reds\")\n        .bar(\"unique\", color=\"lightblue\")\n    )\n \n \ndef show_IQR(series, bins_n=None):\n \n    perc_25 = series.quantile(0.25, interpolation=\"midpoint\")\n    perc_75 = series.quantile(0.75, interpolation=\"midpoint\")\n    IQR = perc_75 - perc_25\n \n    print(\n        f\"Unique values count: {series.nunique()}\",\n        f\"\\nQ1: {perc_25}\\nQ3: {perc_75}\\nIQR: {IQR}\",\n        f\"\\nOutliers borders: [{perc_25 - 1.5*IQR}, {perc_75 + 1.5*IQR}]\",\n    )\n \n    fig, axes = plt.subplots(ncols=2, figsize=(16, 6))\n    sns.distplot(series.values, bins=bins_n, color=\"#50248f\", ax=axes[0]).set(\n        xlabel=series.name,\n        ylabel=\"Quantity (frequency)\",\n        title=series.name + \" distribution\\n\",\n    )\n \n    sns.boxplot(series.values, color=\"#38d1ff\", ax=axes[1]).set(\n        xlabel=series.name, title=series.name + \" distribution\\n\"\n    )\n \n    plt.show()\n \n \ndef show_by_cat(df, cat, numeric):\n    fig, ax = plt.subplots(figsize=(12, 6))\n    sns.boxplot(\n        x=cat,\n        y=numeric,\n        data=df,\n        ax=ax,\n    )\n    ax.set_title(\"Boxplot for: \" + cat + \" vs \" + numeric)\n    plt.show()","be2b518d":"train.columns","929f1858":"describe_nums(train.loc[:, train.columns.str.startswith(\"feature\")])","258cfdcc":"# zeros are outliers, let's exclude it for more clear picture\n \nfor c in train.columns:\n    if c.startswith(\"feature\"):\n        show_IQR(train.query(f\"{c} != 0\")[c], None)","c289ab94":"plt.figure(figsize=(50,30))\nsns.heatmap(train[[c for c in train.columns if c.startswith(\"feature\")]].replace({0, np.nan}).corr(), annot=True, cmap=\"viridis\")","670ae519":"train.target.value_counts().to_frame().reset_index().sort_values([\"index\"]).set_index(\"index\").style.bar(color=\"lightblue\")","34f4155c":"train.drop([\"id\"], axis=1).groupby(\"target\").nunique().T","cc57d895":"for col in train.columns[train.columns.str.startswith(\"feature\")]:\n    show_by_cat(train.query(f\"{col} != 0\").sort_values([\"target\"]), \"target\", col)","c8a15950":"## By-feature deep dive\n \nWork in progress","33bd598e":"## Distribution plots","f05f460f":"# Functions","dab1aab1":"# Reading data\n \nUploaded dataset to githib to use similarity with **colab**, **kaggle** and **local**.","f60c9653":"## Target distribution\n \nDataset is imbalanced: only 8490 rows belongs to class 1 while 57497 (more than half) belongs to class 2\n \nTarget classes distributed quite similarly for most of variables, except some features:\n\n- class 3 is wider than others: features 21, 26, 40, 42, 43, 45\n- class 3 is too thin: 36, 34\n- classes 2 and 3 are wider than 1 and 4: 33, 49\n- feature 12 is maybe ordinal (represent months?)\n- class 1 is wider than others: 6, 27, 37, 38\n- features 2, 13, 22, 36 have to low number of unique values","96765dfe":"## Describe","5560e96e":"- all features looks like nominative or ordinal variables\n- all features have more low values\n- all features have a lot of zeros","ede2f320":"## Correlation\n \n \nThere is no important correlation in this dataset","02441c0c":"# EDA"}}