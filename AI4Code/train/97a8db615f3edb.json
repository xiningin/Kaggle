{"cell_type":{"27cc2c14":"code","63b882f7":"code","7e5180aa":"code","b271f79a":"code","16681a5d":"code","48713598":"code","43c756fb":"code","a11ff43d":"code","dc4825b2":"code","bdd8f63c":"code","a67660e7":"code","c86f9eaf":"code","f865b44e":"code","f1087647":"code","e5eee4db":"code","3a04738f":"code","c33bee6a":"code","7d6aae7c":"code","e3ce4a17":"code","cc5b833d":"code","23306ca2":"code","66bd8963":"code","0fba1de8":"code","96fc676d":"code","e29855a4":"code","7399d33a":"code","8206af4f":"markdown","dbf77bbd":"markdown","c322b9f7":"markdown"},"source":{"27cc2c14":"import warnings\nwarnings.filterwarnings(\"ignore\")\nimport pandas as pd\nimport numpy as np\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.feature_selection import SelectFromModel\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.linear_model import Lasso\nfrom sklearn.svm import LinearSVC\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.feature_selection import RFE\nfrom sklearn.linear_model import RidgeCV, LassoCV, Ridge, Lasso\nfrom warnings import simplefilter\nsimplefilter(action='ignore', category=FutureWarning)\nfrom sklearn.datasets import make_blobs\nimport xgboost as xgb\nfrom sklearn.metrics import mean_squared_error","63b882f7":"df = pd.read_csv(\"..\/input\/eda-missing-values-outliers\/after_eda.csv\")\ndf","7e5180aa":"df = df.assign(latitude_longitude = df.restaurant_latitude + df.restaurant_longitude)\ndf","b271f79a":"new_df = df.drop(['air_store_id','station_name','area','genre','week_year_visit','restaurant_id'], axis=1)\nnew_df","16681a5d":"new_df.to_csv(\".\/new_df.csv\",index = False)\nnew_df","48713598":"new_df1 = new_df.drop(['sum_visitors'], axis=1)\nnew_df1","43c756fb":"df_col = new_df1.describe()\n#(include ='int64')\ndf_col.columns","a11ff43d":"varSel = pd.DataFrame({'Variable': df_col.columns})\nvarSel","dc4825b2":"nm = df_col.columns\nnm = nm.append(pd.Index(['sum_visitors']))\nnm","bdd8f63c":"df2 = df[nm].copy()\ndf2.head()","a67660e7":"X = df2.iloc[:,:-1]\nX.head()","c86f9eaf":"y = df2.iloc[:,-1:]\ny.head()","f865b44e":"lassomod = Lasso(alpha=0.01).fit(X, y.values.ravel())","f1087647":"model = SelectFromModel(lassomod, prefit=True)\nmodel.get_support()","e5eee4db":"varSel['Lasso'] = model.get_support()\n#.astype('int64')\nvarSel","3a04738f":"xg_reg = xgb.XGBRegressor(objective ='reg:linear', colsample_bytree = 0.3, learning_rate = 0.1,\n                max_depth = 5, alpha = 10, n_estimators = 10).fit(X,y.values.ravel())","c33bee6a":"model = SelectFromModel(xg_reg, prefit=True)\nmodel.get_support()","7d6aae7c":"varSel['XGboost'] = model.get_support()\n#.astype('int64')\nvarSel","e3ce4a17":"varSel['Sum'] = np.sum(varSel,axis=1)\nvarSel","cc5b833d":"varSel.groupby('Sum')['Variable'].count()","23306ca2":"# We can now decide a threshold for selecting our variables!","66bd8963":"varSel[varSel['Sum']>=1]","0fba1de8":"variables = varSel[varSel['Sum']>=1].iloc[:, [0]]\nvariables","96fc676d":"variables_to_columns = variables.transpose().iloc[:].head()\ndf_variables_to_columns = pd.DataFrame(variables_to_columns)\nsum_visitors = ['sum_visitors']\ndf_variables_to_columns['sum_visitors'] = sum_visitors\ndf_variables_to_columns.to_csv('first_variables_data.csv',index = False)\ndf_variables_to_columns","e29855a4":"top_columns = pd.read_csv(\".\/first_variables_data.csv\",header = 1).columns\ntop_columns","7399d33a":"df_After_Feature_Selection = pd.DataFrame(new_df[top_columns])\ndf_After_Feature_Selection.to_csv(\".\/First_Feature_Selection.csv\",index = False)\ndf_After_Feature_Selection","8206af4f":"### Variable Selection using LASSO (L1 penalization)","dbf77bbd":"### Variable Selection using XGboost","c322b9f7":"### Summarization and Selection of Variables \n"}}