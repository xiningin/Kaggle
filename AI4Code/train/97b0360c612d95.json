{"cell_type":{"a77ed700":"code","faed96f1":"code","847313a0":"code","b08a1fa9":"code","7484591b":"markdown"},"source":{"a77ed700":"import os\nimport nltk\nfrom gensim.models.word2vec import Word2Vec\n\nwords = []\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        with open(os.path.join(dirname, filename)) as f:\n            ss = nltk.sent_tokenize(f.read(),language=\"russian\")\n            for s in ss:\n                words.append(nltk.tokenize.word_tokenize(s, language=\"russian\"))\n","faed96f1":"num_features = 200\nmin_word_count = 1\nnum_workers = 4\nwindow_size = 6\nsubsampling = 1e-3\n\nmodel = Word2Vec(\n       words,\n       workers=num_workers,\n       size = num_features,\n       min_count=min_word_count,\n       window = window_size,\n       sample=subsampling\n)\nmodel.init_sims(replace=True)\nmodel.save(\"\/kaggle\/working\/model\")\nmodel.wv.save_word2vec_format(\"\/kaggle\/working\/model.w2v\")\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","847313a0":"# Test the model, standard example king + women - man = ? \nfrom gensim.models.word2vec import Word2Vec\nmodel = Word2Vec.load(\"\/kaggle\/working\/model\")\n\nprint(model.wv.most_similar(positive= [\"\u043a\u043e\u0440\u043e\u043b\u044c\", \"\u0436\u0435\u043d\u0449\u0438\u043d\u0430\"], negative=[\"\u043c\u0443\u0436\u0447\u0438\u043d\u0430\"]))","b08a1fa9":"print(model.wv.most_similar(positive= [\"\u0447\u0442\u0438\u0432\u043e\"]))","7484591b":"And response as expected is \"Queen\" follow-up by \"Princess\""}}