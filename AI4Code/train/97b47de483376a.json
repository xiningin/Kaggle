{"cell_type":{"ec90922b":"code","abd9d546":"code","7238c773":"code","9b12809f":"code","fc83ccd1":"code","796ef2de":"code","1ad73c37":"code","ebed428d":"code","129a4c1c":"code","7ff441d1":"code","520af14b":"code","5d6aaca9":"code","16e48ae3":"code","3f2d56f0":"code","905858a5":"code","e6ead5d1":"code","8f37026f":"code","53d36814":"code","265fd849":"code","b4127a21":"code","72a8c688":"code","29d3d239":"code","4c1eed1c":"code","b519b187":"code","457a88fb":"code","573f146b":"code","c0aa406a":"code","5fc0ae43":"code","3cf629fb":"code","d8800e1c":"code","67d80a50":"code","77b058c7":"code","7df516cb":"code","933ba6fe":"code","3eac24c6":"code","46aa4532":"code","65f15035":"code","bb081262":"code","232493be":"code","bd58ca6a":"code","4efad0fc":"code","ffc5896f":"code","7f4d176a":"code","ab1834c8":"code","bac17cc0":"code","c6417407":"code","80b1a6a0":"code","a9034b4c":"code","74d83fe6":"code","b41d9176":"code","988a29e6":"code","f981989e":"code","0c323ee9":"code","5a19908f":"code","b5d2e9f0":"code","ea3b82e5":"code","77c8989e":"code","1ec8d7dc":"code","3ff44b88":"code","9fac8d39":"code","e63df431":"code","debe2d63":"code","873525f9":"code","a3f4ba8d":"code","a5483e83":"code","3bc87508":"code","ec869ca3":"code","3315f22c":"markdown","da0a716d":"markdown","e7300919":"markdown","b0bb72ec":"markdown","fca0c6cc":"markdown","cb94e278":"markdown","b7d3b9bd":"markdown","ad6c65fb":"markdown","9d48fc40":"markdown","ff1d0562":"markdown","7cd90c06":"markdown","dfedeb33":"markdown","2993b58f":"markdown","5cf666da":"markdown","9a295807":"markdown","95e589bc":"markdown","14380c1c":"markdown","bad63219":"markdown","37fb438c":"markdown","f03fecdf":"markdown","aa9a49f0":"markdown","f58014f7":"markdown","951a2eb2":"markdown","0ef695c6":"markdown","a3ddd436":"markdown","910c7903":"markdown","23bc3fff":"markdown","eaf19a70":"markdown","3d7be7f2":"markdown","17140d2b":"markdown","4df1b294":"markdown","d797327b":"markdown","d2ef1861":"markdown","43ad00f4":"markdown","17db1d62":"markdown","45e697ed":"markdown","14269abb":"markdown","43f8880e":"markdown","a98e330c":"markdown","b29d9138":"markdown","62ab97ca":"markdown","782e5145":"markdown","4d69f6d4":"markdown","852fcf59":"markdown","03964d28":"markdown","f29f1196":"markdown","8c702257":"markdown","b3859bbc":"markdown","b7129fe2":"markdown","930ebc3f":"markdown","135c37a1":"markdown","eb8a69f0":"markdown","8107402e":"markdown","b4f091d1":"markdown","6c77069c":"markdown","1863e8c5":"markdown","8ad79377":"markdown","7bb8a8ce":"markdown","fa94bf29":"markdown","0abd162d":"markdown","b502ab43":"markdown","287fb863":"markdown","ca4e81ae":"markdown","243a0f77":"markdown","41ef4abf":"markdown","e818f538":"markdown","2d02cc0d":"markdown","78a61469":"markdown","dbe1b68d":"markdown","dfaa8e69":"markdown","a929db42":"markdown","0a728f8d":"markdown","1e0775d8":"markdown","7f5b27fa":"markdown","5c9b1e56":"markdown","4155700f":"markdown","97d1b6cf":"markdown","14c99da4":"markdown","a0d5feca":"markdown","d88547ea":"markdown","e62647d4":"markdown","eb3b5ff8":"markdown","5dbd5268":"markdown"},"source":{"ec90922b":"import numpy as np \nimport pandas as pd \nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom wordcloud import WordCloud,STOPWORDS\nimport string\nimport re\nimport pickle as pkl\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')\n\nfrom scipy.sparse import csr_matrix\nfrom sklearn.neighbors import NearestNeighbors\n\n# change defaults\nsns.set_context('notebook')\nsns.set_style('darkgrid')\nsns.set_palette('rainbow')","abd9d546":"#Columns Names\nbook_cols = ['ISBN', 'bookTitle', 'bookAuthor', 'yearOfPublication', 'publisher', 'imageUrlS', 'imageUrlM', 'imageUrlL']\nrating_cols = ['userId','ISBN','bookRating']\nuser_cols = ['userId','location','age']\n\nbooks = pd.read_csv('..\/input\/book-recommendation-data\/BX-Books.csv',\n                    sep=';', error_bad_lines=False, encoding='latin-1')\nbooks.columns = book_cols\n\nratings = pd.read_csv('..\/input\/book-recommendation-data\/BX-Book-Ratings.csv',\n                      sep=';', error_bad_lines=False, encoding='latin-1')\nratings.columns = rating_cols\n\nusers = pd.read_csv('..\/input\/book-recommendation-data\/BX-Users.csv',\n                    sep=';', error_bad_lines=False, encoding='latin-1')\nusers.columns = user_cols","7238c773":"books.head(2)","9b12809f":"ratings.head(2)","fc83ccd1":"users.head(2)","796ef2de":"books.info()","1ad73c37":"books.yearOfPublication.unique()","ebed428d":"books.loc[books.yearOfPublication == 'DK Publishing Inc',:]","129a4c1c":"books.loc[books.ISBN == '078946697X','imageUrlL'] = 'http:\/\/images.amazon.com\/images\/P\/078946697X.01.LZZZZZZZ.jpg'\nbooks.loc[books.ISBN == '078946697X','imageUrlM'] = 'http:\/\/images.amazon.com\/images\/P\/078946697X.01.MZZZZZZZ.jpg'\nbooks.loc[books.ISBN == '078946697X','imageUrlS'] = 'http:\/\/images.amazon.com\/images\/P\/078946697X.01.THUMBZZZ.jpg'\nbooks.loc[books.ISBN == '078946697X','publisher'] = 'DK Publishing Inc'\nbooks.loc[books.ISBN == '078946697X','yearOfPublication'] = '2000'\nbooks.loc[books.ISBN == '078946697X','bookAuthor'] = 'Michael Teitelbaum'\nbooks.loc[books.ISBN == '078946697X','bookTitle'] = 'DK Readers: Creating the X-Men, How It All Began (Level 4: Proficient Readers)'","7ff441d1":"books.loc[books.ISBN == '0789466953','imageUrlL'] = 'http:\/\/images.amazon.com\/images\/P\/0789466953.01.LZZZZZZZ.jpg'\nbooks.loc[books.ISBN == '0789466953','imageUrlM'] = 'http:\/\/images.amazon.com\/images\/P\/0789466953.01.MZZZZZZZ.jpg'\nbooks.loc[books.ISBN == '0789466953','imageUrlS'] = 'http:\/\/images.amazon.com\/images\/P\/0789466953.01.THUMBZZZ.jpg'\nbooks.loc[books.ISBN == '0789466953','publisher'] = 'DK Publishing Inc'\nbooks.loc[books.ISBN == '0789466953','yearOfPublication'] = '2000'\nbooks.loc[books.ISBN == '0789466953','bookAuthor'] = 'James Buckley'\nbooks.loc[books.ISBN == '0789466953','bookTitle'] = \"DK Readers: Creating the X-Men, How Comic Books Come to Life (Level 4: Proficient Readers)\"","520af14b":"books.loc[books.yearOfPublication == 'Gallimard',:]","5d6aaca9":"books.loc[books.ISBN == '2070426769','imageUrlL'] = 'http:\/\/images.amazon.com\/images\/P\/2070426769.01.LZZZZZZZ.jpg'\nbooks.loc[books.ISBN == '2070426769','imageUrlM'] = 'http:\/\/images.amazon.com\/images\/P\/2070426769.01.MZZZZZZZ.jpg'\nbooks.loc[books.ISBN == '2070426769','imageUrlS'] = 'http:\/\/images.amazon.com\/images\/P\/2070426769.01.THUMBZZZ.jpg'\nbooks.loc[books.ISBN == '2070426769','publisher'] = 'Gallimard'\nbooks.loc[books.ISBN == '2070426769','yearOfPublication'] = '2003'\nbooks.loc[books.ISBN == '2070426769','bookAuthor'] = 'Jean-Marie Gustave Le Cl\u00c3?\u00c2\u00a9zio'\nbooks.loc[books.ISBN == '2070426769','bookTitle'] = \"Peuple du ciel, suivi de 'Les Bergers\"","16e48ae3":"books_data = books[['ISBN', 'bookTitle','imageUrlS', 'imageUrlM', 'imageUrlL']]\nbooks = books[['ISBN', 'bookTitle', 'bookAuthor', 'yearOfPublication', 'publisher']]","3f2d56f0":"books.loc[(books.ISBN == '2070426769') | (books.ISBN == '078946697X') | (books.ISBN == '0789466953'),: ]","905858a5":"books.yearOfPublication = pd.to_numeric(books.yearOfPublication, errors='coerce')","e6ead5d1":"books.loc[(books.yearOfPublication > 2006) | (books.yearOfPublication == 0),'yearOfPublication'] = np.NAN","8f37026f":"books.yearOfPublication.fillna(round(books.yearOfPublication.mean()),inplace=True)\nconvert_dict = {'yearOfPublication': np.int64,}\nbooks = books.astype(convert_dict)","53d36814":"books.loc[books.publisher.isnull(),:]","265fd849":"books.loc[(books.bookTitle == 'Tyrant Moon'),:]","b4127a21":"books.loc[(books.bookTitle == 'Finders Keepers'),:]","72a8c688":"books.loc[(books.bookAuthor == 'Elaine Corvidae') | (books.bookAuthor == 'Linnea Sinclair'),:]","29d3d239":"books.loc[(books.ISBN == '193169656X'),'publisher'] = 'Unknown'\nbooks.loc[(books.ISBN == '1931696993'),'publisher'] = 'Unknown'","4c1eed1c":"books.loc[books.bookAuthor.isnull(),:]","b519b187":"books.loc[(books.ISBN == '9627982032'),'bookAuthor'] = 'Unknown'","457a88fb":"users.info()","573f146b":"users.loc[(users.age > 90) | (users.age < 4), 'age'] = np.nan","c0aa406a":"users.age = users.age.fillna(users.age.mean())\nusers.age = users.age.astype(np.int64)","5fc0ae43":"ratings.info()","3cf629fb":"ratings.bookRating.unique()","d8800e1c":"\nn_users = users.shape[0]\nn_books = books.shape[0]\nprint(n_users * n_books)","67d80a50":"ratings_new = ratings[ratings.ISBN.isin(books.ISBN)]","77b058c7":"ratings_new = ratings_new[ratings_new.userId.isin(users.userId)]\n#Note: All users who rated are already inside users dataset","7df516cb":"sparsity = 1 - (len(ratings_new)\/(n_users*n_books))\nprint(\"No. of users = \" + str(n_users) + \", No. of Books = \" + str(n_books) \n      + \"\\nThe Following Dataset has \" + str(sparsity*100) + \" % Sparsity\")","933ba6fe":"rating_explicit = ratings_new.loc[ratings_new.bookRating != 0, :]\nrating_implicit = ratings_new.loc[ratings_new.bookRating == 0, :]\nprint(\"Explicit Ratings data shape = \" + str(rating_explicit.shape) + \"\\nImplicit Ratings data shape = \" + str(rating_implicit.shape))","3eac24c6":"plt.figure(figsize=(9, 5))\nplt.title('Explicit Rating Counts')\nsns.countplot(x = 'bookRating', data = rating_explicit);","46aa4532":"def clean_text(text):\n    #removal of url\n    text = re.sub(r'https?:\/\/\\S+|www\\.\\S+|http?:\/\/\\S+',' ',text) \n    \n    #removal of html tags\n    text = re.sub(r'<.*?>',' ',text) \n    \n    text = re.sub(\"[\"\n                           u\"\\U0001F600-\\U0001F64F\"  # removal of emoticons\n                           u\"\\U0001F300-\\U0001F5FF\"  # symbols & pictographs\n                           u\"\\U0001F680-\\U0001F6FF\"  # transport & map symbols\n                           u\"\\U0001F1E0-\\U0001F1FF\"  # flags (iOS)\n                           u\"\\U00002702-\\U000027B0\"\n                           u\"\\U000024C2-\\U0001F251\"\n                           \"]+\",' ',text)\n    \n    \n    #remove newline char\n    text = re.sub('\\n', '', text)\n    \n    return text","65f15035":"books.bookTitle = books.bookTitle.apply(lambda x:clean_text(x))","bb081262":"merged_data = pd.merge(books, ratings_new, on='ISBN')\nmerged_data =  merged_data.sort_values('ISBN', ascending=True)\nmerged_data.head()","232493be":"most_read = merged_data.bookTitle.value_counts().reset_index()\nmost_read.columns = ['bookTitle','count']\n\nplt.figure(figsize = (10,10))\nplt.title(\"Most Read Books\")\nsns.barplot(x = 'count', y = 'bookTitle', data = most_read.head(30));","bd58ca6a":"top_rated = merged_data[['bookTitle','bookRating']]\ntop_rated = top_rated.groupby('bookTitle', as_index=False)['bookRating'].mean()\ntop_rated = top_rated.sort_values('bookRating',ascending=False).reset_index()\ntop_rated = top_rated[['bookTitle','bookRating']]\n\ntop_rated.head()","4efad0fc":"top_rated.tail()","ffc5896f":"avg_data = merged_data.groupby('bookTitle', as_index=False)['bookRating'].mean()\ntemp = merged_data.bookTitle.value_counts().reset_index()\ntemp.columns = ['bookTitle','count']\nmost_rated_by_reads = pd.merge(avg_data,temp,on='bookTitle')\n\nmost_rated_by_reads = most_rated_by_reads.sort_values('count',ascending=False)\n\nplt.figure(figsize=(12,10))\nplt.title(\"Average Ratings of Most Read books\")\nsns.barplot(x = 'bookRating', y = 'bookTitle', data = most_rated_by_reads.head(30));","7f4d176a":"title_length = books.bookTitle.str.split().map(lambda x: len(x))\nplt.figure(figsize=(8,6))\nplt.title('Number of books with a specific title length')\nsns.histplot(title_length, bins=25, color = 'lightgreen', linewidth = 2, edgecolor = 'black');","ab1834c8":"yearOP = books['yearOfPublication'].value_counts().reset_index()\n\nyearOP.columns = ['value', 'count']\n\nyearOP['year'] = yearOP['value'].astype(str) + ' year'\n\nyearOP = yearOP.sort_values('count',ascending=False)\n\nplt.figure(figsize=(12,10))\nplt.title('Top 30 years of publishing')\nsns.barplot(data = yearOP.head(30), x='count', y=\"year\");","bac17cc0":"top_author = books['bookAuthor'].value_counts().reset_index()\ntop_author.columns = ['Author', 'count']\ntop_author['Author'] = top_author['Author']\ntop_author = top_author.sort_values('count',ascending=False)\n\nplt.figure(figsize=(12,10))\nplt.title('Top 30 Authors according to most books')\nsns.barplot(data = top_author.head(30), x = 'count', y = 'Author');","c6417407":"top_publisher = books['publisher'].value_counts().reset_index()\ntop_publisher.columns = ['Publisher', 'count']\ntop_publisher['Publisher'] = top_publisher['Publisher']\ntop_publisher = top_publisher.sort_values('count',ascending=False)\n\nplt.figure(figsize=(12,10))\nplt.title('Top 30 Publishers according to most books')\nsns.barplot(data = top_publisher.head(30), x = 'count', y = 'Publisher');","80b1a6a0":"user_age = users.age\nplt.figure(figsize=(10,6), tight_layout=True)\nplt.title('Number of users according to user age')\nsns.histplot(user_age, bins=25, linewidth = 2, color = 'cyan', edgecolor = 'black');","a9034b4c":"author_string = \" \".join(books['bookAuthor'].astype(str))\ntitle_string = \" \".join(books['bookTitle'].astype(str))\npublisher_string = \" \".join(books['publisher'].astype(str))\nstop_words = set(STOPWORDS)\n\ndef wordcloud(string,title =\"unknown\"):\n    wc = WordCloud(width=800,height=500,mask=None,random_state=21,\n                   stopwords=stop_words).generate(string)\n    fig=plt.figure(figsize=(16,8))\n    plt.title(title)\n    plt.axis('off')\n    plt.imshow(wc)","74d83fe6":"wordcloud(author_string,'Author Name words')","b41d9176":"wordcloud(title_string,'Title text words')","988a29e6":"wordcloud(publisher_string,'Publisher Name words')","f981989e":"ratings_count = pd.DataFrame(rating_explicit.groupby(['ISBN'])['bookRating'].sum())\ntop_10 = ratings_count.sort_values('bookRating', ascending = False).head(10)\nprint(\"Following books are recommended\")\ntop_10.merge(books, left_index = True, right_on = 'ISBN').reset_index()","0c323ee9":"# #Content Based Recommendation \n# # Be sure to import the libraries needed\n# content_data = books[['bookTitle','bookAuthor','publisher']]\n# content_data = content_data.astype(str)\n# content_data['content'] = content_data['bookTitle'] + ' ' + content_data['bookAuthor'] + ' ' + content_data['publisher']\n# content_data = content_data.reset_index()\n# indices = pd.Series(content_data.index, index=content_data['bookTitle'])","5a19908f":"# count = CountVectorizer(stop_words='english')\n\n# count_matrix = count.fit_transform(content_data['content'])\n\n# cosine_sim_content = cosine_similarity(count_matrix, count_matrix)","b5d2e9f0":"# def get_recommendations(title, cosine_sim=cosine_sim_content):\n#     idx = indices[title]\n\n#     # Get the pairwsie similarity scores of all books with that book\n#     sim_scores = list(enumerate(cosine_sim_content[idx]))\n\n#     # Sort the books based on the similarity scores\n#     sim_scores = sorted(sim_scores, key=lambda x: x[1], reverse=True)\n\n#     # Get the scores of the 10 most similar books\n#     sim_scores = sim_scores[1:11]\n\n#     # Get the book indices\n#     book_indices = [i[0] for i in sim_scores]\n\n#     # Return the top 10 most similar books\n#     return list(content_data['original_title'].iloc[book_indices])\n\n# def book_shows(book):\n#     for book in book:\n#         print(book)","ea3b82e5":"counts1 = ratings_new['userId'].value_counts()\nratings_data = ratings_new[ratings_new['userId'].isin(counts1[counts1 >= 100].index)]\ncounts = ratings_data['bookRating'].value_counts()\nratings_data = ratings_data[ratings_data['bookRating'].isin(counts[counts >= 100].index)]","77c8989e":"merged_new = pd.merge(ratings_data,books,on='ISBN')\ncolumns = ['yearOfPublication', 'publisher', 'bookAuthor']\nmerged_new = merged_new.drop(columns, axis=1)","1ec8d7dc":"number_rating = merged_new.groupby('bookTitle')['bookRating'].count().reset_index()\nnumber_rating.rename(columns={'bookRating':'number of rating'},inplace=True)\nnumber_rating.head()","3ff44b88":"final_ratings = merged_new.merge(number_rating,on='bookTitle') \nfinal_ratings.head()","9fac8d39":"final_ratings = final_ratings[final_ratings['number of rating']>=30] ","e63df431":"print(\"Shape Before :\" + str(final_ratings.shape))\nfinal_ratings.drop_duplicates(['userId','bookTitle'],inplace=True)\nprint(\"Shape After  :\" + str(final_ratings.shape))","debe2d63":"book_pivot = final_ratings.pivot_table(columns='userId',index='bookTitle',values='bookRating')\nbook_pivot.shape","873525f9":"book_pivot.fillna(0,inplace=True)\nbook_pivot","a3f4ba8d":"book_sparse=csr_matrix(book_pivot)\nmodel=NearestNeighbors(metric='cosine',algorithm='brute')\nmodel.fit(book_sparse)","a5483e83":"def recommend(book_name):\n    book_id = np.where(book_pivot.index==book_name)[0][0]\n    distances,suggestions=model.kneighbors(book_pivot.iloc[book_id,:].values.reshape(1,-1),n_neighbors = 11)\n    \n    \n    books=[]\n    for i in range(len(suggestions)):\n        if i==0:\n            print(\"The suggestions for \",book_name,\"are : \")\n        if not i:\n            books = book_pivot.index[suggestions[i]]\n    for i in range(1,len(books)):\n         print(str(i) + \": \" + books[i] )       \n                \n            \nrecommend('The Sum of All Fears (Jack Ryan Novels)')","3bc87508":"books_name_Murl = books_data[['bookTitle', 'imageUrlM']]","ec869ca3":"books_name_Murl.to_csv('Book_names_with_urlM.csv')\n\nfinal_ratings.to_csv('Final_Ratings.csv')\n\nwith open('model.pkl', 'wb') as file:\n      \n    # A new file will be created\n    pkl.dump(model, file)\n    ","3315f22c":"Replacing NANs with mean value of users and converting data type to int","da0a716d":"We can observe from above that some author names are mixed up in year data like 'DK Publishing Inc' and 'Gallimard'  \nChecking the rows having 'DK Publishing Inc' as yearOfPublication using [DataFrame.loc[]](https:\/\/pandas.pydata.org\/pandas-docs\/stable\/reference\/api\/pandas.DataFrame.loc.html) method","e7300919":"Using [Seaborn](https:\/\/towardsdatascience.com\/seaborn-python-8563c3d0ad41) Library for ploting a [countplot](https:\/\/www.geeksforgeeks.org\/countplot-using-seaborn-in-python\/)","b0bb72ec":"Column yearOfPublication should be set having dtype as int, hence checking the unique values of yearOfPublication using [Series.unique()](https:\/\/pandas.pydata.org\/docs\/reference\/api\/pandas.Series.unique.html) method","fca0c6cc":"Checking for number of null values and data types of data provided inside columns","cb94e278":"Merging Books and Ratings data using [pd.merge()](https:\/\/www.geeksforgeeks.org\/python-pandas-merging-joining-and-concatenating\/)","b7d3b9bd":"### Visualising top 30 publishers with most books","ad6c65fb":"Filling the NAN values with zeros","9d48fc40":"Making two new ratings dataframes where ratings which are other than 0 are present and vice a versa","ff1d0562":"# Upvote this notebook if it help you in any way","7cd90c06":"Storing Image URLs in different DataFrame because we don't need them now","dfedeb33":"Dataset [Sparsity](https:\/\/campus.datacamp.com\/courses\/recommendation-engines-in-pyspark\/recommending-movies?ex=3) Calculation","2993b58f":"### Top rated books(average rating according to number of users)","5cf666da":"Applying clean_text() function on bookTitle column","9a295807":"### Visualising top 30 authors with most books","95e589bc":"Creating string variables for bookAuthor, bookTitle and publisher, also creating a function to plot [WordCloud()](https:\/\/www.geeksforgeeks.org\/generating-word-cloud-python\/) ","14380c1c":"Using [Series.fillna()](https:\/\/pandas.pydata.org\/docs\/reference\/api\/pandas.Series.fillna.html) to fill the NAN values with mean value of the years and then converting data type to int","bad63219":"Creating title_length data for every title in bookTitle column and ploting a histplot","37fb438c":"Displaying first two entries of Books data using [DataFrame.head()](https:\/\/pandas.pydata.org\/docs\/reference\/api\/pandas.DataFrame.head.html)","f03fecdf":"# Book Recommendation Project     \n\nHave you ever wondered for a system which suggest a new set of books for your previously read books !?.   \nWell [Recommendation Systems](https:\/\/en.wikipedia.org\/wiki\/Recommender_system#:~:text=A%20recommender%20system%2C%20or%20a,would%20give%20to%20an%20item.) are there to help, they are very common to us due to continuous demand and need to get the best book to read.  \nA recommendation system is a subclass of information filtering system that seeks to predict the \"rating\" or \"preference\" a user would give to an item.  \nThey are primarily used in commercial applications. (source - Wikipedia)\n\nIn this Project we analyse and preprocess the [Book Crossing Dataset](https:\/\/www.kaggle.com\/mohitnirgulkar\/book-recommendation-data) collected by [Cai-Nicolas Ziegler](http:\/\/www2.informatik.uni-freiburg.de\/~cziegler\/BX\/)   \nand apply Machine Learning to recommend different books from a book you previously read.   \nWhole code below is in [Python](https:\/\/www.python.org\/) using various libraries. Open source library [Scipy](https:\/\/www.scipy.org\/) is used for preprocessing and [Scikit-Learn](https:\/\/scikit-learn.org\/) is used for creating the model.\n\n<p align=\"center\">\n    <br clear=\"right\"\/>\n    <img src=\"https:\/\/d15fwz9jg1iq5f.cloudfront.net\/wp-content\/uploads\/2019\/07\/31184107\/BlogPreview.png\" alt=\"Books\" width=\"800\" height=\"1000\" \/>\n<\/p>","aa9a49f0":"Verifying the changes in publication year ","f58014f7":"Displaying first two entries of Ratings data","951a2eb2":"We count the number of books published by a publisher and plot top 30 of them","0ef695c6":"We consider those book who have been rated more than 30 times","a3ddd436":"We may observe many books with average rating equal to 10 and 0 as many of the books are rated only once, hence this can't show us a good visualisation","910c7903":"# 7. Saving Model and Files\n","23bc3fff":"# 6. Machine Learning Modelling and Output","eaf19a70":"# 2. Data Cleaning","3d7be7f2":"We count the number of times a book is published in a particular year and plot a barplot","17140d2b":"There are Two Books with wrong year entries, Hence we will correct them below","4df1b294":"bookRatings are always under 0-10, also Ratings dataset will have n_users $\\times$ n_books entries if every user rated every item,","d797327b":"### Importing Dependancies","d2ef1861":"Assinging the Null publisher values as 'Unknown'","43ad00f4":"With the new ratings data we merge the Books data using pd.merge() and drop irrelavant columns","17db1d62":"Function for cleaning title text using [Regex](https:\/\/en.wikipedia.org\/wiki\/Regular_expression) Library","45e697ed":"### Visualising top 30 most read books with there average ratings","14269abb":"Checking for Null bookAuthor names ","43f8880e":"### Visualising most frequent words in Author, Title and Publisher string","a98e330c":"### Checking Ratings Data","b29d9138":"#  Table of Contents\n\n\n 1. Dependancies and Dataset\n\n 2. Data Cleaning\n\n 3. Data Exploration\n \n 4. Popularity Based Recommendation\n \n 5. Data Preprocessing\n \n 6. Machine Learning Modelling and Output\n \n 7. Saving Model and Files","62ab97ca":"Checking the rows having 'Gallimard' as yearOfPublication","782e5145":"Checking for Null values and data types of Ratings data","4d69f6d4":"Looks like it doesn't have any NAN values, So let's have a look at bookRating values","852fcf59":"# 5. Data Preprocessing","03964d28":"### Visualising Explicit Rating Counts","f29f1196":"### Importing Datasets","8c702257":"Displaying most frequent words in publisher names","b3859bbc":"### Visualising top 30 years with most book being published","b7129fe2":"### Checking Users Data","930ebc3f":"# 3. Data Exploration","135c37a1":"### Checking Books Data","eb8a69f0":"# 4. Popularity Based Recommendation","8107402e":"### Cleaning Title text","b4f091d1":"Using [scipy](https:\/\/www.scipy.org\/) library's [compressed sparse row matrix](https:\/\/docs.scipy.org\/doc\/scipy\/reference\/generated\/scipy.sparse.csr_matrix.html) to create sparse book matrix with book_pivot as input   \nWe then use this sparse matrix to provide an input to the scikit-learn's [NearestNeighbors model](https:\/\/scikit-learn.org\/stable\/modules\/generated\/sklearn.neighbors.NearestNeighbors.html#sklearn.neighbors.NearestNeighbors) with [brute algorithm](https:\/\/www.kdnuggets.com\/2020\/10\/exploring-brute-force-nearest-neighbors-algorithm.html) and [metric cosine](https:\/\/www.machinelearningplus.com\/nlp\/cosine-similarity\/).","6c77069c":"Checking with rows having bookTitle as Tyrant Moon to see if we can get any clues","1863e8c5":"Below we show top 10 recommendations based on popularity using sum of bookRating values to choose which is popular.    \nIt is evident that books authored by [J.K. Rowling](https:\/\/www.jkrowling.com\/) are one of the most popular","8ad79377":"Creating a DataFrame number_rating with count of number of times a book is being rated   \n[Using DataFrame.rename()](https:\/\/pandas.pydata.org\/pandas-docs\/stable\/generated\/pandas.DataFrame.rename.html) to rename columns","7bb8a8ce":"We count the number of times a book written by an author and plot a barplot for the top 30 authors","fa94bf29":"No clues for Tyrant Moon , Hence checking with rows having bookTitle as Finders Keepers to see if we can get any clues","0abd162d":"### Visualising the age distribution of the users","b502ab43":"### Visualising top 30 most read books","287fb863":"Using [Series.value_counts()](https:\/\/pandas.pydata.org\/docs\/reference\/api\/pandas.Series.value_counts.html) and [sns.barplot](https:\/\/seaborn.pydata.org\/generated\/seaborn.barplot.html) for creating data and visualisation respectively","ca4e81ae":"Creating  a pivot table for final_ratings dataframe with columns as userId and index as bookTitle with values as bookRatings with the help of [DataFrame.pivot_table()](https:\/\/pandas.pydata.org\/pandas-docs\/stable\/reference\/api\/pandas.DataFrame.pivot_table.html)","243a0f77":"### If you are having small dataset it's worth trying code below using cosine similarity matrix for content based recommendation","41ef4abf":"Creating final_ratings DataFrame for every bookTitle with bookRatings and number of ratings","e818f538":"Lets give the Null bookAuthor value as 'Unknown'","2d02cc0d":"No clues here either as every book has different publishers , So checking  with rows having author Elaine Corvidae and Linnea Sinclair","78a61469":"Displaying most frequent words in author names","dbe1b68d":"From above we can say that the dataset is very sparse,  \nRatings dataset should have books only which exist in our books dataset, unless new books are added to books dataset","dfaa8e69":"Age values below 4 and above 90 does not make much sense for our book rating case, hence replacing these by NANs","a929db42":"Users with less than 100 ratings, and books with less than 100 ratings are excluded","0a728f8d":"Using [DataFrame.groupby()](https:\/\/pandas.pydata.org\/pandas-docs\/stable\/reference\/api\/pandas.DataFrame.groupby.html) and [DataFrame.sort_values()](https:\/\/pandas.pydata.org\/pandas-docs\/stable\/reference\/api\/pandas.DataFrame.sort_values.html) for ploting a barplot","1e0775d8":"# 1. Dependancies and Dataset","7f5b27fa":"Displaying first two entries of users Data","5c9b1e56":"### Visualising Count of Books with a specific length","4155700f":"Also Ratings dataset should have ratings from users which exist in users dataset, unless new users are added to users dataset","97d1b6cf":"Using [DataFrame.info()](https:\/\/pandas.pydata.org\/pandas-docs\/version\/0.23\/generated\/pandas.DataFrame.info.html) method to check number of null values and Data types of the data","14c99da4":"The value 0 for year is invalid and as this dataset was published in 2004, I have assumed the the years after 2006 to be \ninvalid keeping some margin in case dataset was updated thereafer setting invalid years as NaN","a0d5feca":"Creating a function which will recommend 10 new books for the book you read according to the suggestions provided the model","d88547ea":"Converting year data from object type to numeric using [pd.to_numeric](https:\/\/pandas.pydata.org\/docs\/reference\/api\/pandas.to_numeric.html) and if error occurs replacing them with NAN values","e62647d4":"Checking if there are NULL values present in publisher column using [Series.isnull()](https:\/\/pandas.pydata.org\/docs\/reference\/api\/pandas.Series.isnull.html)","eb3b5ff8":"Droping duplicate records from final_ratings using [DataFrame.drop_duplicates()](https:\/\/pandas.pydata.org\/docs\/reference\/api\/pandas.DataFrame.drop_duplicates.html) and checking the change of DataFrame size","5dbd5268":"Displaying most frequent words in title text"}}