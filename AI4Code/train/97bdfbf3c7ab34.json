{"cell_type":{"6420c0ae":"code","ba569d86":"code","2b10a60f":"code","b13b55db":"code","91393154":"code","1e0b3c53":"code","0a1cc8a5":"code","327ecea7":"code","d3ab0bb6":"markdown","d078f92e":"markdown"},"source":{"6420c0ae":"import numpy as np\nimport pandas as pd\nimport os\nprint(os.listdir(\"..\/input\"))","ba569d86":"# load train & test set\ntrain_df = pd.read_csv('..\/input\/train.csv')\ntest_df = pd.read_csv('..\/input\/test.csv')\nsub = pd.read_csv('..\/input\/sample_submission.csv')\nprint(train_df.shape, test_df.shape, sub.shape)","2b10a60f":"predict = pd.DataFrame(columns=['index', 'pred'])\nprint(predict.shape)","b13b55db":"from sklearn.linear_model import LogisticRegression\nfrom sklearn import metrics\n\nfor i in range(512):\n    print('Processing data set # '+str(i))\n    train = train_df[train_df['wheezy-copper-turtle-magic']==i]\n    test = test_df[test_df['wheezy-copper-turtle-magic']==i]\n    index = test.index\n    X_train = train.drop(['id', 'wheezy-copper-turtle-magic', 'target'], axis=1).values\n    Y_train = train['target'].values\n    X_test = test.drop(['id', 'wheezy-copper-turtle-magic'], axis=1).values\n    model = LogisticRegression(solver='liblinear', penalty='l1', C=0.05)\n    model.fit(X_train, Y_train)\n    Y_pred_train = model.predict(X_train)\n    print('AUC is ', metrics.roc_auc_score(Y_train, Y_pred_train))\n    preds = model.predict_proba(X_test)\n    for i in range(len(index)):\n        predict = predict.append({'index':index[i], 'pred':preds[i,1]}, ignore_index=True)","91393154":"temp = predict\ntemp.sort_values(by=['index'], inplace=True)\ntemp.head()","1e0b3c53":"temp = temp.set_index('index')\ntemp.head()","0a1cc8a5":"sub['target'] = temp['pred']\nsub.head(20)","327ecea7":"sub.to_csv('submission.csv',index=False)","d3ab0bb6":"#### Thank you [Chris Deotte][1] for the sharing your insightful [kernel][2]. I learned a lot from it. Here, I'm just following what you did. Thanks again.\n[1]: https:\/\/www.kaggle.com\/cdeotte\n[2]: https:\/\/www.kaggle.com\/cdeotte\/logistic-regression-0-800\n#### There is so much sharing in this competition. It's amazing!","d078f92e":"Started on 21 June 2019"}}