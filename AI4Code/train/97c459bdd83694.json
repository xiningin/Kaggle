{"cell_type":{"ec9c6b6d":"code","ff22a2f7":"code","bfdf7df4":"code","c40d61ae":"code","2314a00d":"code","4cb619b8":"code","85a0e0ea":"code","df7922ee":"code","47e16302":"code","4f5e4b11":"code","ec142c11":"code","d62f1659":"code","eb023344":"code","a13b971c":"markdown","78f619e7":"markdown","9d2a7d47":"markdown","b05512ad":"markdown","52bcbf50":"markdown","3a126c6e":"markdown","5fd983a8":"markdown","7b9f5495":"markdown","f0c5a365":"markdown"},"source":{"ec9c6b6d":"!pip install natsort\n!pip install videofig\nfrom natsort import natsorted \nimport numpy as np \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.preprocessing import StandardScaler\nimport xgboost\nimport cv2\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nimport os\n%matplotlib inline\n","ff22a2f7":"data=pd.read_csv('\/kaggle\/input\/brain-tumor\/Brain Tumor.csv')\ndata","bfdf7df4":"scalable=['Mean', 'Variance', 'Standard Deviation', 'Entropy',\n       'Skewness', 'Kurtosis', 'Contrast', 'Energy', 'ASM', 'Homogeneity',\n       'Dissimilarity', 'Correlation', 'Coarseness']\n\n\ndata[scalable]=StandardScaler().fit_transform(data[scalable])\ndata","c40d61ae":"sns.swarmplot(x=y, y= data['Homogeneity'])\nplt.title(\"Distribution of image Homogenity, by Class\")\n\n","2314a00d":"class1=data['Class']== 1\nclass0=data['Class']== 0\n_data=data.copy()\n_data=data.drop('Image',axis=1,inplace=False)\nsns.distplot(a= _data[class1]['Energy'], label=\"Tumor\")\nsns.distplot(a = _data[class0]['Energy'], label=\"No tumor\" )\n\nplt.title(\"Distribution of image Energy, by Class\")\nplt.legend()","4cb619b8":"sns.distplot(a= _data[class1]['Entropy'], label=\"Tumor\")\nsns.distplot(a = _data[class0]['Entropy'], label=\"No tumor\" )\nplt.title(\"Distribution of image Entropy, by Class\")\nplt.legend()","85a0e0ea":"fig = plt.figure()  \nfolder='\/kaggle\/input\/brain-tumor\/Brain Tumor\/Brain Tumor\/'\nimgs=[os.path.join(folder,img) for img in os.listdir(folder) if img.endswith('.jpg')]\nimgs=natsorted(imgs)\n\nimg=cv2.imread(imgs[3760],cv2.IMREAD_GRAYSCALE)\n\nim = plt.imshow(img,  interpolation='none', aspect='auto',cmap ='gray', vmin=0, vmax=255)   \nplt.title('No Tumor')","df7922ee":"img=cv2.imread(imgs[3],cv2.IMREAD_GRAYSCALE)\n\nim = plt.imshow(img,  interpolation='none', aspect='auto',cmap ='gray', vmin=0, vmax=255)   \nplt.title('Tumor')","47e16302":"y=data.Class\ny","4f5e4b11":"from collections import OrderedDict\n\nmodel = xgboost.XGBRegressor(colsample_bytree=0.4,\n                 gamma=0,                 \n                 learning_rate=0.07,\n                 max_depth=3,\n                 min_child_weight=1.5,\n                 n_estimators=10000,                                                                    \n                 reg_alpha=0.75,\n                 reg_lambda=0.45,\n                 subsample=0.6,\n                 seed=42) \nmodel.fit(data.drop(['Image','Class'],axis=1,inplace=False),y)\nOrderedDict(sorted(model.get_booster().get_fscore().items(),key=lambda t: t[1], reverse=True))","ec142c11":"logr= LogisticRegression(dual=False, verbose=1, random_state=  4)\nlogr.fit(X_train , y_train )\nlogr.score(X_valid,y_valid)","d62f1659":"RFclf = RandomForestClassifier(n_estimators = 2000, random_state= 4 ,verbose=1)\nRFclf.fit( X_train, y_train  )\nRFclf.score(X_valid,y_valid)","eb023344":"knn=KNeighborsClassifier( algorithm='auto' ,leaf_size= 50,n_neighbors= 5)\nknn.fit(X_train,y_train )\nknn.score ( X_valid,y_valid)","a13b971c":"# Logistic Regression","78f619e7":"# Data Correlations","9d2a7d47":"# Random Forest","b05512ad":"# Data Analysis","52bcbf50":"# Most impactful features","3a126c6e":"# KNN","5fd983a8":"**First Order Features**\n\n\n* **Mean** : \n*Gives the contribution of individual pixel intensity for the entire image*\n* **Variance** : \n*Used to find how each pixel varies from the neighbouring pixel* \n* **Standard Deviation** : \n*measures the deviation of measured Values or the data from its mean.*\n* **Skewness** : \n*measures of symmetry, or more precisely, the lack of symmetry.* \n* **Kurtosis** : \n*describes the peakedness of e.g. a frequency distribution*\n\n**Second Order Features** \n\n\n* **Contrast** : \n*the difference in luminance or colour across the image*\n* **Energy** : \n*It's the rate of change in the color\/brightness\/magnitude of the pixels over local areas.*\n* **ASM (Angular second moment)** : \n*is a measure of textural Uniformity of an image*\n* **Entropy** : \n*is a statistical measure of randomness that can be used to characterize the texture of the image*\n* **Homogeneity** :\n*homogeneity expresses how similar certain elements (pixels) of the image are. *\n* **Dissimilarity** : \n*is a numerical measure of how different two data objects are.*\n* **Correlation** : \n*Correlation is the process of moving a filter mask often referred to as kernel over the image and computing the sum of products at each location(CNN alike)*\n* **Coarseness** : \n*Describes the roughness\/harshness of a texture*\n\n**Labels**\n* **Class** :  \n\n**1 = Tumor**\n\n**0 = Not Tumor**","7b9f5495":"# Scaling","f0c5a365":"As the **previous graphs** suggested , the more ***un-uniform*** and ***un-structured*** the pixels values are,the more likely it is to have cancer\n\nThus,probably the best approach to take is some [Anomaly Detection](https:\/\/en.wikipedia.org\/wiki\/Anomaly_detection) algorithm\n"}}