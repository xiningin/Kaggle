{"cell_type":{"88e4c851":"code","74e89ce3":"code","009f2935":"code","b4532f95":"code","7b3905eb":"code","929bd022":"code","41bc2fee":"code","d81686c4":"code","281549b1":"code","e1c13086":"code","6d07b116":"code","9335926f":"code","e9124679":"code","cfad6423":"code","f081c3fe":"markdown","6a337303":"markdown","8a76f26f":"markdown","a4e0e9a0":"markdown","88a819c2":"markdown","7e94d06e":"markdown","255f5149":"markdown","9497e888":"markdown","7ee043ab":"markdown","03fcd60a":"markdown","2eb04ab1":"markdown","5032f9c3":"markdown"},"source":{"88e4c851":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline","74e89ce3":"path = 'https:\/\/s3-api.us-geo.objectstorage.softlayer.net\/cf-courses-data\/CognitiveClass\/DA0101EN\/automobileEDA.csv'\ndf = pd.read_csv(path)\ndf.head()","009f2935":"df.dtypes","b4532f95":"df.describe()","7b3905eb":"df.dtypes\nfor x in df:\n    if df[x].dtypes == \"int64\":\n        df[x] = df[x].astype(float)\n        print (df[x].dtypes)\n\n ","929bd022":"df = df.select_dtypes(exclude=['object'])\ndf=df.fillna(df.mean())\nX = df.drop('price',axis=1)\ny = df['price']","41bc2fee":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=0)","d81686c4":"from sklearn.ensemble import RandomForestRegressor\nregressor = RandomForestRegressor(n_estimators = 1000, random_state = 42)\nregressor.fit(X_train, y_train)","281549b1":"y_pred = regressor.predict(X_test)","e1c13086":"df=pd.DataFrame({'Actual':y_test, 'Predicted':y_pred})\ndf","6d07b116":"from sklearn import metrics\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y_test, y_pred))\nprint('Mean Squared Error:', metrics.mean_squared_error(y_test, y_pred))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test, y_pred)))","9335926f":"# Calculate the absolute errors\nerrors = abs(y_pred - y_test)\n# Print out the mean absolute error (mae)\nprint('Mean Absolute Error:', round(np.mean(errors), 2), 'degrees.')\n\n# Calculate mean absolute percentage error (MAPE)\nmape = 100 * (errors \/ y_test)\n# Calculate and display accuracy\naccuracy = 100 - np.mean(mape)\nprint('Accuracy:', round(accuracy, 2), '%.')","e9124679":"import seaborn as sns\nplt.figure(figsize=(5, 7))\n\n\nax = sns.distplot(y, hist=False, color=\"r\", label=\"Actual Value\")\nsns.distplot(y_pred, hist=False, color=\"b\", label=\"Fitted Values\" , ax=ax)\n\n\nplt.title('Actual vs Fitted Values for Price')\n\n\nplt.show()\nplt.close()","cfad6423":"# Import tools needed for visualization\nfrom sklearn.tree import export_graphviz\nimport pydot\n# Pull out one tree from the forest\nTree = regressor.estimators_[5]\n# Import tools needed for visualization\nfrom sklearn.tree import export_graphviz\nimport pydot\n# Pull out one tree from the forest\nTree = regressor.estimators_[5]\n# Export the image to a dot file\nfrom sklearn import tree\nplt.figure(figsize=(25,15))\ntree.plot_tree(Tree,filled=True, \n              rounded=True, \n              fontsize=14);","f081c3fe":"Preparing the Data\nAs with the classification task, in this section we will divide our data into attributes and labels and consequently into training and test sets. We will create 2 data set,one for price while the other (df-price).\nSince pur dataframe has many data in object format, for this analysis we are removing all the coloumn with object type and for all NaN value we are removig that row","6a337303":"dtypes gives the data type of coloumn","8a76f26f":"df.head() will give us the details fo top 5 rows of every cooloumn. We can use df.tail() to get the last 5 rows and similiary df.head(10) to get top 10 rows.\n\nThe data is about cars and we need to predict the price of car using the above data\n\nWe will be using Decision Tree to get the price of the car. ","a4e0e9a0":"Let's check the accuracy of our prediction.","88a819c2":"Here the X variable contains all the columns from the dataset, except 'Price' column, which is the label. The y variable contains values from the 'Price' column, which means that the X variable contains the attribute set and y variable contains the corresponding labels.","7e94d06e":"Let's check the difference between Actual and predicted values","255f5149":"The mean absolute error for our algorithm is 1993.2901175839186, which is less than 20 percent of the mean of all the values in the 'Price' column. This means that our algorithm did a  prediction, but it needs lot of improvement.","9497e888":"Accuracy of 87.8% is not a very great score and there are lot of scope for improvement.","7ee043ab":"To train the tree, we will  use the Random Forest class and call the fit method.\nWe will have random forest with 1000 decision tree.","03fcd60a":"In the above dataframe all the coloumns are not numeric. So we will consider only those coloumn whose values are in numeric and will  make all numeric to float.","2eb04ab1":"The above is the graph between the actual and predicted values.\nLet's visualize the Random Forest ","5032f9c3":"Lets predict the price"}}