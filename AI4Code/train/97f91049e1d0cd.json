{"cell_type":{"f4e320b5":"code","249ee47b":"code","dfecd593":"code","de77636b":"code","946b9e83":"code","f06fc707":"code","70b13b86":"code","3690a92b":"code","e0bce7ee":"code","4b338f4b":"code","b0bf25b8":"code","2ccbdedc":"code","bd5d2de6":"code","6788fb4e":"code","ec482b31":"code","4f795701":"code","7ae5e95e":"code","6530e171":"code","b67deb3c":"code","0a50aefd":"code","38ed58df":"code","23c8759d":"code","cbe3365e":"code","f57d9a53":"code","78c754f5":"code","d6028839":"code","bc88b7ed":"code","9fa00c9b":"code","dbaf3576":"code","ab2f581c":"code","df4d5963":"code","ce241a31":"code","74397dde":"code","d7ff3a5c":"code","88113d0a":"markdown","3a507c2b":"markdown","6b2432db":"markdown","4db4bc8e":"markdown","fffe3a60":"markdown"},"source":{"f4e320b5":"from IPython.display import Image\nImage(url='https:\/\/miro.medium.com\/max\/844\/1*MyKDLRda6yHGR_8kgVvckg.png')","249ee47b":"# Importing the essential Libraries\nimport pandas as pd\nimport numpy as np","dfecd593":"# Reading the Dataset\ndf = pd.read_csv('..\/input\/customer-churn-dataset\/Churn_Modelling.csv')","de77636b":"df.head()","946b9e83":"df.shape","f06fc707":"df.columns","70b13b86":"df.dtypes","3690a92b":"# Printing Unique Values of the categorical variables\nprint(df['Geography'].unique())\nprint(df['Gender'].unique())\nprint(df['NumOfProducts'].unique())\nprint(df['HasCrCard'].unique())\nprint(df['IsActiveMember'].unique())","e0bce7ee":"# Checking if there are null values or not\ndf.isnull().sum()","4b338f4b":"df.describe()","b0bf25b8":"df.head()","2ccbdedc":"# Including only Potential Predictors as independent varibles\nfinal_dataset = df[['CreditScore', 'Geography', 'Gender', 'Age', 'Tenure', 'Balance', 'NumOfProducts', 'HasCrCard', 'IsActiveMember', 'EstimatedSalary', 'Exited']]","bd5d2de6":"final_dataset.head()","6788fb4e":"# Converting the categorical variables into numerical and avoiding Dummy Varibale Trap\nfinal_dataset = pd.get_dummies(final_dataset, drop_first=True)","ec482b31":"final_dataset.head()","4f795701":"import seaborn as sns","7ae5e95e":"import matplotlib.pyplot as plt","6530e171":"labels = 'Exited', 'Retained'\nsizes = [df.Exited[df['Exited']==1].count(), df.Exited[df['Exited']==0].count()]\nexplode = (0, 0.1)\nfig1, ax1 = plt.subplots(figsize=(10, 8))\nax1.pie(sizes, explode=explode, labels=labels, autopct='%1.1f%%',\n        shadow=True, startangle=90)\nax1.axis('equal')\nplt.title(\"Proportion of customer churned and retained\", size = 20)\nplt.show()","b67deb3c":"sns.pairplot(final_dataset)","0a50aefd":"# import matplotlib.pyplot as plt\n%matplotlib inline","38ed58df":"# Plotting The Correlations between all the features\ncorrmat = final_dataset.corr()\ntop_corr_features = corrmat.index\nplt.figure(figsize=(20,20))\nsns.heatmap(final_dataset[top_corr_features].corr(), annot=True, cmap='RdYlGn')","23c8759d":"final_dataset.head()","cbe3365e":"# Splitting the Dataset into Dependent and Independent Variables\nX = final_dataset.iloc[:, [0,1,2,3,4,5,6,7,9,10,11]]\ny = final_dataset.iloc[:, 8].values","f57d9a53":"X.head()","78c754f5":"y","d6028839":"# Splitting the dataset into Training and Testing Data\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.2, random_state = 42)","bc88b7ed":"# Standardizing the Dataset\nfrom sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)","9fa00c9b":"print(X_train)","dbaf3576":"## Feature Importance\nfrom sklearn.ensemble import ExtraTreesRegressor\nmodel = ExtraTreesRegressor()\nmodel.fit(X,y)","ab2f581c":"print(model.feature_importances_)","df4d5963":"from sklearn.ensemble import RandomForestClassifier\nrf = RandomForestClassifier()\nrf.fit(X_train,y_train)","ce241a31":"y_pred = rf.predict(X_test)","74397dde":"from sklearn.metrics import accuracy_score, confusion_matrix\ncm = confusion_matrix(y_test,y_pred)\nprint(cm)\nprint(accuracy_score(y_test,y_pred))","d7ff3a5c":"# pickling the Model\nimport pickle\n\nfile = open('Anmol.pkl', 'wb')\npickle.dump(rf, file)","88113d0a":"# Random Forest Classifier","3a507c2b":"Following Factors are:\n1. Credit score\n2. Location of the Customer\n3. Gender\n4. Age\n5. Tenure\n6. Account Balance\n7. Number of Bank Products Customer Uses\n8. Has Credit Card\n9. Is Active Member\n10. Estimated Salary","6b2432db":"# Customer Churn Prediction","4db4bc8e":"From the heatmap , we find that teh Age, Balance and the Geography of the Customer are Most important features","fffe3a60":"### In this project, we will predict whether a customer will leave the bank or not based on many factors"}}