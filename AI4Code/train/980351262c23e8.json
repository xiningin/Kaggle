{"cell_type":{"1ef1b447":"code","6763a4d6":"code","1242af30":"code","cd4b377d":"code","20ff5a9a":"code","84290c36":"code","e25e346a":"code","70b6682d":"code","ef008038":"code","4ff02469":"code","4cf758c3":"code","693553a6":"code","f75490e5":"code","5012824f":"code","b0ca141e":"code","c40650df":"code","214b1148":"markdown","525043d2":"markdown","915ad796":"markdown","e08401e2":"markdown","8d327334":"markdown","63267517":"markdown","57f52297":"markdown","12d1f733":"markdown","b2f5e50f":"markdown","3b201163":"markdown","1de97f74":"markdown"},"source":{"1ef1b447":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.model_selection import train_test_split, GridSearchCV\n\npd.set_option(\"display.max_columns\", 102)","6763a4d6":"train = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/test.csv')\nsample_submission = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/sample_submission.csv')","1242af30":"print(f'Train data shape:{train.shape}')\nprint(f'test data shape:{test.shape}')","cd4b377d":"train.head()","20ff5a9a":"train.columns","84290c36":"train.info()","e25e346a":"train.describe()","70b6682d":"f = plt.figure(figsize=(15,8))\n\nax = f.add_subplot()\nsns.countplot(train['loss'])\nax.set_title('Count plot of loss')","ef008038":"X = np.array(train.drop(['id', 'loss'], axis = 1).copy())\ny = train['loss'].values #for classification","4ff02469":"X_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.3, random_state=42)","4cf758c3":"rf_model = RandomForestRegressor(n_estimators=200,max_depth=8, random_state=42)","693553a6":"rf_model.fit(X_train, y_train)","f75490e5":"print(f'Val RMSE: {np.sqrt(mean_squared_error(rf_model.predict(X_val), y_val))}')","5012824f":"X_test = test.drop('id', axis=1).copy()","b0ca141e":"sample_submission['loss'] = rf_model.predict(X_test).astype(int)\nsample_submission.to_csv('submission.csv', index=None)","c40650df":"sample_submission.head()","214b1148":"params = {\n    'n_estimators': [200, 300],\n    'max_features': ['auto', 'sqrt', 'log2'],\n    'max_depth' : [4,5,6,7,8]\n}","525043d2":"grid.best_params_","915ad796":"grid = GridSearchCV(rf_model, param_grid=params, cv=3, n_jobs=-1, verbose=500)","e08401e2":"In this notebook we going to train a regression machine learning model to predict the `loss` variable. Also we are going to visualize the data set with various visualizing tools. \n\nIf you find this help ful please do **upvote**, It motivates me to publish new notebooks.\n\nP.S: This notebook is taking some time to train...I will optimize it in future versions\n\nHappy learning :)","8d327334":"**NOTE**:\n- \ud83d\udccc We need to model loss of the model as shown above\n- \ud83d\udccc `loss` has values ranging from 0 to 42","63267517":"grid.best_score_","57f52297":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 10px;\n              color:white;\n          text-align:center;\">\nModel \ud83e\udd16\n             \n<\/p>\n<\/div>","12d1f733":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\"> \n\n<p style=\"padding: 10px;\n              color:white;\n          text-align:center;\">\nEDA \ud83d\udcca\ud83d\udcc8\n             \n<\/p>\n<\/div>","b2f5e50f":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 10px;\n              color:white;\n          text-align:center;\">\nLoading libraries \ud83d\udcda\ud83d\udcda\n    \n             \n<\/p>\n<\/div>","3b201163":"# **Tabular Playground Series Aug 2021** \u2728","1de97f74":"### Let's look at the loss variable"}}