{"cell_type":{"e860f349":"code","b05639a4":"code","290c294e":"code","40024632":"code","f2a2565c":"code","90426c6f":"code","55b040ca":"code","f694a6bd":"code","385e692d":"code","364e5b0c":"code","a91e378a":"code","a9a33e7a":"code","fcee8c96":"code","6beffebd":"code","0c5e6765":"code","2f6de4b5":"code","5cfc7304":"code","cacf8037":"code","eae19e8b":"code","7a3ad1be":"code","d0858a86":"code","e9cd6232":"code","92c7906b":"code","c4c20769":"code","2b69a398":"code","67d377e9":"code","499c5bad":"code","824e3b33":"code","eb2a860f":"code","c2b69250":"code","f986b279":"code","4df0649d":"code","5aacfa66":"code","cda230d8":"code","46f8f524":"code","9039a744":"code","0b7cb43f":"code","dfb57874":"code","ce1ae96c":"code","777ed5b4":"code","77c07910":"code","253845a2":"code","57d6b276":"code","2a8a8f2f":"code","02951330":"code","96e8f63e":"code","65d209e5":"code","0d1a0e49":"code","24b29050":"code","94c6a4ce":"code","6ec1dcb6":"code","6561c8fd":"code","ab65ac8f":"code","05e652fa":"code","c03a98e7":"code","fa10ca88":"code","d73c1425":"code","4b1e90b4":"code","593c3c0e":"code","44ec6b88":"code","9647ccd8":"code","600b2e29":"code","57fe4bd8":"code","ff55afed":"code","79eb282a":"code","51093050":"code","eacbfa3c":"code","562162f7":"code","34c760fd":"code","04184274":"code","2fbe5c38":"code","16c39de4":"code","0916e18b":"code","7068fe42":"code","92260eba":"code","a7da2077":"code","e420d38d":"code","39ed0096":"code","5d99f410":"code","a55bc348":"code","10ff5fb5":"code","719e48b2":"code","07b86e2c":"code","7d5e7698":"code","24f1b9cf":"code","1ce06b0c":"code","071b859d":"code","7a58d0fa":"code","740def06":"code","d2077657":"code","1e80cf42":"code","7aef4976":"code","7f1e2ef2":"code","9ac57c02":"code","ef0afc08":"code","30b40ba6":"code","3cd2e2e6":"code","1c0642b3":"code","fbe5fb95":"code","a908ebdf":"code","a85d578f":"code","4d208137":"code","6f95b7e9":"code","1d5da33f":"code","632e6e6e":"code","efa15b74":"code","6646cfe4":"code","5c1dd4af":"code","ef09e1ff":"code","56bcb97f":"code","3199ac35":"code","7f6c8a05":"code","ad174c69":"code","4cfd537d":"code","9c9ed123":"code","45205844":"code","e2ca4f20":"code","aa72d06c":"code","1d92ff1a":"code","4bb60992":"code","ed6aebb2":"code","a64350eb":"code","dc7e25f3":"code","801d40bf":"code","ca807af5":"code","2aa23658":"code","36c9b014":"code","714a6203":"code","15357149":"code","2e55afe6":"code","11109d61":"code","e2673471":"code","80fe0cd2":"code","cce057e0":"code","e30cd31b":"code","0c856b3c":"code","dae0dae4":"code","111ce67f":"code","c57af493":"code","1857e6a3":"code","7ccef532":"code","e679d458":"code","b2fd6cc9":"code","ae3c8cb1":"code","70d9c63c":"code","00e2f2e5":"markdown","d7a7adc1":"markdown","ddefd3c4":"markdown","e87d9f9d":"markdown","61f1365e":"markdown","cb84209a":"markdown","a3ebccc1":"markdown","2dd542d2":"markdown","f5a2b754":"markdown","49b63405":"markdown","77265fb4":"markdown","1d4e5399":"markdown","d6728882":"markdown","db1d10b4":"markdown","f2da32b8":"markdown","58d32213":"markdown","d576a1eb":"markdown","99f5ad07":"markdown","2ccdb262":"markdown","e5b04a34":"markdown","87caf3c1":"markdown","09951b17":"markdown","e40feedf":"markdown","8ea285df":"markdown","8ea41224":"markdown","5bcc4b8a":"markdown","18bb9190":"markdown","70cd2656":"markdown","d0506dcc":"markdown","5a0465fb":"markdown","3ca240f9":"markdown","8cd2b7cb":"markdown","63cc4164":"markdown","d59d121f":"markdown","a56af824":"markdown","5c9cb57a":"markdown","c4f7d82a":"markdown","6325ff76":"markdown","305e2bc3":"markdown","55e1cc38":"markdown","53465298":"markdown","9afa7963":"markdown"},"source":{"e860f349":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\nimport pandas as pd\n%matplotlib inline\nimport random\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom subprocess import check_output\n#print(check_output([\"store.csv\", \"..\/input\"]).decode(\"utf8\"))\nsales = pd.read_csv('..\/input\/store.csv') # load the dataset\n# Any results you write to the current directory are saved as output.","b05639a4":"sales[:5]","290c294e":"sales.shape # There are 10000 rows and 5 columns","40024632":"sales.describe() # Describe shows a quick statistic summary of your data","f2a2565c":"sales.info()","90426c6f":"sales['reps'].unique() ","55b040ca":"sales['region'].unique()","f694a6bd":"print(sales.qty.max())\nprint(sales.qty.min())","385e692d":"print(sales.revenue.max())\nprint(sales.revenue.min())","364e5b0c":"# Count of transactions made by each rep\npd.value_counts(sales.reps, sort=True)","a91e378a":"# Get a summary of sales made by a particular rep called Seet\ngb = sales.groupby(['reps'])\ngb.get_group('Seet').head(10)","a9a33e7a":"seet = gb.get_group('Seet').qty\nseet.value_counts().plot(kind='bar')\nplt.xlabel('Quantity')\nplt.ylabel('Count of Transactions')\nplt.title('sale by rep \"Seet\"');","fcee8c96":"# the pivot table is used here to start aggregating the data and summarizing it by grouping the reps with their region. \npd.pivot_table(sales,index=[\"region\",\"reps\",\"product\"],aggfunc=np.sum)[:12]","6beffebd":"total_rev = sales.groupby('region')['revenue'].apply(lambda x: x.sum())\ntotal_rev.sort_values(ascending=False)","0c5e6765":"df_w = sales[sales['region'] == 'West']  \nsales_west = df_w.groupby('reps')['revenue'].apply(lambda x: x.sum())\n\ndf_e = sales[sales['region'] == 'East']   \nsales_east = df_e.groupby('reps')['revenue'].apply(lambda x: x.sum())\n\ndf_n = sales[sales['region'] == 'North']   \nsales_north = df_n.groupby('reps')['revenue'].apply(lambda x: x.sum())\n\ndf_s = sales[sales['region'] == 'South']   \nsales_south = df_s.groupby('reps')['revenue'].apply(lambda x: x.sum())\n\ntotal_rev_rep = sales.groupby('reps')['revenue' ].apply(lambda x: x.sum())\ntotal_rev_rep [:5]  # total revenue generated by each rep","2f6de4b5":"sales_west # revenues generated by reps in the western region","5cfc7304":"total_tr = sales.groupby('reps')['revenue' ].apply(lambda x: x.count())\ntotal_tr[:5]","cacf8037":"sales.reps.unique().size  # Get a count of uniques values of reps","eae19e8b":"total_rev_rep.sum()","7a3ad1be":"product_tr = sales.groupby('product')['qty'].apply(lambda x: x.count())\nproduct_tr.sort_values(ascending=False)","d0858a86":"sales.groupby(['product']).qty.count().sort_values(ascending=False).plot(kind='bar')\nplt.xlabel('Products', fontsize=12)\nplt.ylabel('Total number of transactions', fontsize=12)\nplt.title('Plot of \"Products\" and \"Transactions\"');","e9cd6232":"dk = sales.groupby(['product'])\ndk1 = dk.get_group('Alpen').qty.value_counts()\ndk1.plot(kind='bar')\n\nplt.xlabel('Quantity')\nplt.ylabel('Count of Transactions')\nplt.title('sale of product \"Alpen\"');","92c7906b":"product_sum = sales.groupby('product')['qty'].apply(lambda x: x.sum())\nproduct_sum.sort_values(ascending=False)","c4c20769":"product_sum.sum()","2b69a398":"sales.groupby(['product']).qty.sum().sort_values(ascending=False).plot(kind='bar')\nplt.xlabel('Products', fontsize=12)\nplt.ylabel('Total quantity sold', fontsize=12)\nplt.title('Plot of \"Products\" and \"Quantity\"');","67d377e9":"print('Number of Reps - South region:', sales_south.size, 'Revenue generated is:', sales_south.sum())\nprint('Number of Reps - West region:', sales_west.size,  'Revenue generated is:', sales_west.sum())\nprint('Number of Reps - North region:', sales_north.size, 'Revenue generated is:', sales_north.sum())\nprint('Number of Reps - East region:', sales_east.size, 'Revenue generated is:', sales_east.sum())","499c5bad":"total_rev = sales.groupby('region')['revenue'].apply(lambda x: x.sum())\ntotal_rev.sort_values(ascending=False)","824e3b33":"total_rev.sort_values(ascending=False).plot(kind='bar', fontsize=12)\nplt.title('Regionwise - Revenue generated')\nplt.xlabel('Region', fontsize=12)\nplt.ylabel('Revenue', fontsize=12);","eb2a860f":"print('Average Revenue generated in South Region is:', sales_south.mean())\nprint('Average Revenue generated in West Region is:', sales_west.mean())\nprint('Average Revenue generated in North region is:', sales_north.mean())\nprint('Average Revenue generated in East Region is:', sales_east.mean())","c2b69250":"df_n = sales[sales['region'] == 'North']   \nproductsales_north = df_n.groupby('product')['revenue'].apply(lambda x: x.sum())\nproductsales_north.sort_values(ascending=False)\n\ndf_s = sales[sales['region'] == 'South']   \nproductsales_south = df_s.groupby('product')['revenue'].apply(lambda x: x.sum())\nproductsales_south.sort_values(ascending=False)\n\ndf_w = sales[sales['region'] == 'West']   \nproductsales_west = df_w.groupby('product')['revenue'].apply(lambda x: x.sum())\nproductsales_west.sort_values(ascending=False)\n\ndf_e = sales[sales['region'] == 'East']   \nproductsales_east = df_e.groupby('product')['revenue'].apply(lambda x: x.sum())\nproductsales_east.sort_values(ascending=False)\n\nproductsales = sales.groupby('product')['revenue'].apply(lambda x: x.sum())\nproductsales.sort_values(ascending=False)\n\ndf_sales = pd.DataFrame(product_tr)\ndf_sales.columns = [ 'transactions']\ndf_sales.reset_index()\n\ndf_sales1 = pd.DataFrame(productsales)\ndf_sales1.reset_index()\n\nproduct_qty = sales.groupby('product')['qty'].apply(lambda x: x.sum())\ndf_sales2 = pd.DataFrame(product_qty)\n\nproduct_tr_rev = pd.concat([df_sales2,df_sales1], axis=1)\nproduct_tr_rev.reset_index(inplace=True)\nproduct_tr_rev[:5]","f986b279":"product_qty = pd.concat([df_sales,df_sales1], axis=1)\nproduct_tr_rev['unit_price'] = product_tr_rev.revenue\/product_tr_rev.qty\nproduct_tr_rev","4df0649d":"unit_p = product_tr_rev.groupby('product')['unit_price'].apply(lambda x: x.sum())\nunit_p.sort_values(ascending=False)","5aacfa66":"unit_p.plot(kind='bar')\nplt.ylabel('Unit Price', fontsize=12)\nplt.xlabel('Product', fontsize=12);","cda230d8":"productsales.sort_values(ascending=False).plot(kind='bar', fontsize=12)\nplt.title('Total Revenue generated by each Product')\nplt.ylabel('Total Revenue', fontsize=12)\nplt.xlabel('Product', fontsize=12);","46f8f524":"qty_p = product_tr_rev.groupby('product')['qty'].apply(lambda x: x.sum())\nqty_p.plot(kind='bar', fontsize=12)\nplt.title('Total Quantity generated by each Product')\nplt.ylabel('Total Quantity', fontsize=12)\nplt.xlabel('Product', fontsize=12);","9039a744":"region_p = sales.groupby(['product', 'region'])['qty'].apply(lambda x: x.sum())\nregion_p.plot(kind='barh', fontsize=12,figsize=(15,10) )\nplt.title('Regionwise sale of products and total quantity')\nplt.ylabel('Product, Region', fontsize=12)\nplt.xlabel('Total Quantity', fontsize=12);","0b7cb43f":"region_rev = sales.groupby(['product', 'region'])['revenue'].apply(lambda x: x.sum())\nregion_rev.plot(kind='barh', fontsize=12,figsize=(15,10) )\nplt.title('Regionwise sale of products and total revenue')\nplt.ylabel('Product, Region', fontsize=12)\nplt.xlabel('Total Revenue', fontsize=12);","dfb57874":"sales['revenue'].idxmax()  # highest value is in the 8425th row of revenue column","ce1ae96c":"sales.revenue.nlargest(3)","777ed5b4":"df_sales = pd.DataFrame(total_tr)\ndf_sales.columns = [ 'transactions']\ndf_sales.reset_index()\n\ndf_sales1 = pd.DataFrame(total_rev_rep)\ndf_sales1.reset_index()\n\nsales_tr = pd.concat([df_sales,df_sales1], axis=1)\nsales_tr.reset_index(inplace=True)\nsales_tr[:5]","77c07910":"import scipy\nfrom scipy.cluster.hierarchy import dendrogram, linkage\nfrom scipy.cluster.hierarchy import fcluster\nfrom scipy.cluster.hierarchy import cophenet\nimport scipy.cluster.hierarchy as sch\nfrom scipy.spatial.distance import pdist\nfrom pylab import rcParams\nimport seaborn as sb\nimport sklearn.metrics as sm","253845a2":"X_s = sales_tr.iloc[:, [1,2]].values\nX_s[:3]","57d6b276":"labelist = sales_tr['reps'].tolist()\nfig = plt.figure(figsize=(15,10))\ndendrogram = sch.dendrogram(sch.linkage(X_s, method = 'ward'),leaf_font_size=12,leaf_rotation=90, labels=labelist)\nplt.axhline(y=10000)\nplt.axhline(y=30000)\nplt.xlabel('Names of Reps')\nplt.ylabel('Revenues');","2a8a8f2f":"from sklearn.cluster import AgglomerativeClustering","02951330":"import scipy.cluster.hierarchy as sch","96e8f63e":"hc = AgglomerativeClustering(n_clusters= 5, affinity= 'euclidean',linkage='ward')","65d209e5":"y_hc = hc.fit_predict(X_s)\ny_hc1 = pd.DataFrame(y_hc)","0d1a0e49":"fig = plt.figure(figsize=(15,10))\nplt.scatter(X_s[y_hc == 0,0], X_s[y_hc == 0,1],  c ='red', label='Cluster 1')\nplt.scatter(X_s[y_hc == 1,0], X_s[y_hc == 1,1],  c ='blue', label='Cluster 2')\nplt.scatter(X_s[y_hc == 2,0], X_s[y_hc == 2,1],  c ='green', label='Cluster 3')\nplt.scatter(X_s[y_hc == 3,0], X_s[y_hc == 3,1],  c ='maroon', label='Cluster 4')\nplt.scatter(X_s[y_hc == 4,0], X_s[y_hc == 4,1],  c ='brown', label='Cluster 5')\nplt.title('Cluster of Transactions and Revenue')\nplt.xlabel('Count of Transactions')\nplt.ylabel('Revenue')\nplt.legend()\nplt.show();","24b29050":"# You can segregate the transaction which is over 325  and there is only one instance\nsales_tr[sales_tr['transactions']>325]","94c6a4ce":"sales_tr[sales_tr['transactions']>250]","6ec1dcb6":"sales_tr[(sales_tr['transactions']>250) & (sales_tr['transactions']<350)]","6561c8fd":"sales_tr[(sales_tr['transactions']>150) & (sales_tr['transactions']<250)]","ab65ac8f":"sales_tr[(sales_tr['revenue']>10000) & (sales_tr['revenue']<15000)]","05e652fa":"sales_tr[(sales_tr['revenue']>20000)]","c03a98e7":"sales_tr[(sales_tr['revenue']>15000) & (sales_tr['revenue']<20000)]","fa10ca88":"hc = AgglomerativeClustering(n_clusters= 8, affinity= 'euclidean',linkage='ward')","d73c1425":"y_hc = hc.fit_predict(X_s)","4b1e90b4":"fig = plt.figure(figsize=(15,10))\nplt.scatter(X_s[y_hc == 0,0], X_s[y_hc == 0,1], s=100, c ='red', label='Cluster 1')\nplt.scatter(X_s[y_hc == 1,0], X_s[y_hc == 1,1], s=100, c ='blue', label='Cluster 2')\nplt.scatter(X_s[y_hc == 2,0], X_s[y_hc == 2,1], s=100, c ='green', label='Cluster 3')\nplt.scatter(X_s[y_hc == 3,0], X_s[y_hc == 3,1], s=100, c ='maroon', label='Cluster 4')\nplt.scatter(X_s[y_hc == 4,0], X_s[y_hc == 4,1], s=100, c ='cyan', label='Cluster 5')\nplt.scatter(X_s[y_hc == 5,0], X_s[y_hc == 5,1], s=100, c ='pink', label='Cluster 6')\nplt.scatter(X_s[y_hc == 6,0], X_s[y_hc == 6,1], s=100, c ='yellow', label='Cluster 7')\nplt.scatter(X_s[y_hc == 7,0], X_s[y_hc == 7,1], s=100, c ='gray', label='Cluster 8')\n\nplt.title('Dendrogram Plot of Hierarchial Clustering of Transactions and Revenue')\nplt.xlabel('No. of Transactions')\nplt.ylabel('Revenue')\nplt.legend()\nplt.show();","593c3c0e":"sales_tr[(sales_tr['revenue']>32000) & (sales_tr['transactions']>300)]","44ec6b88":"sales_tr[(sales_tr['revenue']>22000) & (sales_tr['transactions']<300)]","9647ccd8":"product_tr_rev[:5]","600b2e29":"X_p = product_tr_rev.iloc[:, [1,2]].values\nX_p[:3]","57fe4bd8":"labelist = product_tr_rev['product'].tolist()\nfig = plt.figure(figsize=(15,10))\ndendrogram = sch.dendrogram(sch.linkage(X_p, method = 'ward'),leaf_font_size=12,leaf_rotation=90, labels=labelist)\n\nplt.axhline(y=15000)\nplt.axhline(y=100000)","ff55afed":"labelist = product_tr_rev['product'].tolist()\nfig = plt.figure(figsize=(15,10))\ndendrogram = sch.dendrogram(sch.linkage(X_p, method = 'complete'),leaf_font_size=12,leaf_rotation=90, labels=labelist)\n\nplt.axhline(y=15000)\nplt.axhline(y=100000)","79eb282a":"hcp = AgglomerativeClustering(n_clusters= 4, affinity= 'euclidean',linkage='ward')\ny_hcp = hcp.fit_predict(X_p)","51093050":"fig = plt.figure(figsize=(15,10))\nplt.scatter(X_p[y_hcp == 0,0], X_p[y_hcp == 0,1],  c ='red', label='Cluster 1')\nplt.scatter(X_p[y_hcp == 1,0], X_p[y_hcp == 1,1],  c ='blue', label='Cluster 2')\nplt.scatter(X_p[y_hcp == 2,0], X_p[y_hcp == 2,1],  c ='green', label='Cluster 3')\nplt.scatter(X_p[y_hcp == 3,0], X_p[y_hcp == 3,1],  c ='purple', label='Cluster 4')\n\nplt.title('Product Segmentation - n_clusters= 4, affinity= euclidean,linkage=ward')\nplt.xlabel('No. of Transactions')\nplt.ylabel('Revenue')\nplt.legend()\nplt.show();","eacbfa3c":"hcp1 = AgglomerativeClustering(n_clusters= 12, affinity= 'euclidean',linkage='ward')\ny_hcp1 = hcp1.fit_predict(X_p)","562162f7":"fig = plt.figure(figsize=(15,10))\nplt.scatter(X_p[y_hcp1 == 0,0], X_p[y_hcp1 == 0,1],  c ='red', label='Cluster 1')\nplt.scatter(X_p[y_hcp1 == 1,0], X_p[y_hcp1 == 1,1],  c ='blue', label='Cluster 2')\nplt.scatter(X_p[y_hcp1 == 2,0], X_p[y_hcp1 == 2,1],  c ='green', label='Cluster 3')\nplt.scatter(X_p[y_hcp1 == 3,0], X_p[y_hcp1 == 3,1],  c ='maroon', label='Cluster 4')\nplt.scatter(X_p[y_hcp1 == 4,0], X_p[y_hcp1 == 4,1],  c ='cyan', label='Cluster 5')\nplt.scatter(X_p[y_hcp1 == 5,0], X_p[y_hcp1 == 5,1],  c ='pink', label='Cluster 6')\nplt.scatter(X_p[y_hcp1 == 6,0], X_p[y_hcp1 == 6,1],  c ='yellow', label='Cluster 7')\nplt.scatter(X_p[y_hcp1 == 7,0], X_p[y_hcp1 == 7,1],  c ='brown', label='Cluster 8')\nplt.scatter(X_p[y_hcp1 == 8,0], X_p[y_hcp1 == 8,1],  c ='orange', label='Cluster 9')\nplt.scatter(X_p[y_hcp1 == 9,0], X_p[y_hcp1 == 9,1],  c ='purple', label='Cluster 10')\nplt.scatter(X_p[y_hcp1 == 10,0], X_p[y_hcp1 == 10,1],  c ='gray', label='Cluster 11')\nplt.scatter(X_p[y_hcp1 == 11,0], X_p[y_hcp1 == 11,1],  c ='maroon', label='Cluster 12')\n\n\nplt.title('Product Segmentation, n_clusters= 12, affinity= euclidean,linkage=ward')\nplt.ylabel('Revenue')\nplt.xlabel('No. of Transactions')\nplt.legend()\nplt.show();","34c760fd":"region_pr = pd.DataFrame(sales.groupby('region')['revenue'].apply(lambda x: x.sum()))\n\nregion_pr.columns = [ 'revenue']\nregion_pr.reset_index()","04184274":"region_pr_sale = pd.DataFrame(sales.groupby('region')['product'].apply(lambda x: x.count()))\n\nregion_pr_sale.columns = [ 'transactions']\nregion_pr_sale.reset_index()","2fbe5c38":"region_prd_tr = pd.concat([region_pr_sale,region_pr], axis=1)\nregion_prd_tr.reset_index(inplace=True)\nregion_prd_tr","16c39de4":"X_r = region_prd_tr.iloc[:, [1,2]].values\nX_r","0916e18b":"labelist = region_prd_tr['region'].tolist()\nfig = plt.figure(figsize=(15,10))\ndendrogram = sch.dendrogram(sch.linkage(X_r, method = 'ward'),leaf_font_size=12,leaf_rotation=90, labels=labelist)\n#dendrogram.update({'width':10000, 'height':5000})\nplt.axhline(y=15000)\nplt.axhline(y=100000)\nplt.xlabel('Region')\nplt.ylabel('Revenue')\nplt.title('Hierarchical Clustering Dendrogram - Region and Revenue');","7068fe42":"hcr = AgglomerativeClustering(n_clusters= 4, affinity= 'euclidean',linkage='ward')\ny_hcr = hcr.fit_predict(X_r)","92260eba":"fig = plt.figure(figsize=(15,10))\nplt.scatter(X_r[y_hcr == 0,0], X_r[y_hcr == 0,1],  c ='red', label='Cluster 1 - West')\nplt.scatter(X_r[y_hcr == 1,0], X_r[y_hcr == 1,1],  c ='blue', label='Cluster 2 - South')\nplt.scatter(X_r[y_hcr == 2,0], X_r[y_hcr == 2,1],  c ='green', label='Cluster 3 - North')\nplt.scatter(X_r[y_hcr == 3,0], X_r[y_hcr == 3,1],  c ='purple', label='Cluster 4 - East')\n\nplt.title('Cluster of Transactions and Product')\nplt.ylabel('No. of Transactions')\nplt.xlabel('Revenue')\nplt.legend()\nplt.show()","a7da2077":"sale = sales.iloc[:, [1,2,3]]\nsale[:5]","e420d38d":"pd.pivot_table(sales,index=[\"region\",\"product\"],aggfunc=sum)","39ed0096":"pd.pivot_table(sales,index=[\"region\",\"product\"],aggfunc=sum).plot(kind='barh',figsize=(15,13));","5d99f410":"productsales.sort_values(ascending=False)\nfig, ax = plt.subplots(figsize=(9,8))\nexplode = (0.02,0.03,0.04,0.05,0.06,0.07,0.08, 0.09, 0.10, .21,.12,.13)\nax.pie(productsales, labels = None, autopct='%1.1f%%', startangle=90, shadow = True, explode = explode)\nax.legend(bbox_to_anchor=(1,1.2),fontsize='large', labels=productsales.index);","a55bc348":"pd.pivot_table(sales,index=[\"region\",\"reps\",\"product\"])[:12]","10ff5fb5":"sns.kdeplot(product_tr_rev.qty, product_tr_rev.revenue)","719e48b2":"product_tr_rev[(product_tr_rev['qty']>5000) & (product_tr_rev['revenue']>150000)]","07b86e2c":"sns.kdeplot(product_tr_rev.qty, product_tr_rev.unit_price)","7d5e7698":"product_tr_rev[(product_tr_rev['unit_price']>50)]  ","24f1b9cf":"df_n = sales[sales['region'] == 'North']   \nprd_north = df_n.groupby('product')['qty','revenue'].apply(lambda x: x.sum())\nprd_north","1ce06b0c":"prd_north.plot(kind=\"bar\", figsize=(10,8))\nplt.title('North Region Sales', fontsize = 15)\nplt.ylabel('Revenue', fontsize = 15)\nplt.xlabel('Product', fontsize = 15);","071b859d":"total_rev.sort_values(ascending=False)\nfig, ax = plt.subplots(figsize=(9,8))\nexplode = (0.02,0.03,0.04,0.05)\nax.pie(total_rev, labels = None, autopct='%1.1f%%', startangle=90, shadow = True, explode = explode)\nax.legend(bbox_to_anchor=(1,1.2),fontsize='large', labels=total_rev.index);","7a58d0fa":"sales[:5]","740def06":"from sklearn.preprocessing import LabelEncoder # encoding all the text categorical data into numerical data\nle = LabelEncoder()","d2077657":"sales['region'] = le.fit_transform(sales['region'])\nsales.head()","1e80cf42":"le.classes_ # view the encoded classes","7aef4976":"cols = ['qty', 'revenue']\ndf = sale[cols]\nX = df.iloc[:,[0,1]].values\nX[:3]","7f1e2ef2":"y = sales.iloc[:,4].values\ny","9ac57c02":"from sklearn.cluster import KMeans\n\nnumber_of_clusters=4\nkm = KMeans(n_clusters=number_of_clusters)\n\nkm.fit(X)\n","ef0afc08":"print(km.labels_)\nprint(km.cluster_centers_)","30b40ba6":"# create a array for label colors\ncolors = ['red', 'blue', 'green','brown']\n# assign color to each cluster\npred_colors = [colors[label] for label in km.labels_]","3cd2e2e6":"# plot the KMeans clusters\nplt.figure(figsize=(10,8))\nplt.scatter(X[:, 0], X[:, 1], c=pred_colors)\nplt.xlabel('Quantity')\nplt.ylabel('Revenue')\nplt.title('KMeans clusters, n = 4');","1c0642b3":"df[(df['qty']>12) & (df['revenue']>1000)]","fbe5fb95":"sales.loc[9590]","a908ebdf":"cols1 = ['region', 'revenue']\ndf1 = sales[cols1]\nX1 = df1.iloc[:,[0,1]].values\nnumber_of_clusters=6\nkm = KMeans(n_clusters=number_of_clusters)\nkm.fit(X1)\n","a85d578f":"colors = ['blue', 'green','purple','brown', 'yellow','red']\npred_colors = [colors[label] for label in km.labels_]\n\nplt.figure(figsize=(10,8))\nplt.scatter(X1[:, 0], X1[:, 1], c=pred_colors)\nplt.xlabel('Region')\nplt.ylabel('Revenue')\nplt.title('KMeans clusters, n=6');","4d208137":"df1[(df1['region']==1) & (df1['revenue']>1500)]","6f95b7e9":"cols2 = ['region', 'qty']\ndf2 = sales[cols2]\nX2 = df2.iloc[:,[0,1]].values","1d5da33f":"number_of_clusters=6\nkm = KMeans(n_clusters=number_of_clusters)\nkm.fit(X2)","632e6e6e":"plt.figure(figsize=(10,8))\nplt.scatter(X2[:, 0], X2[:, 1], c=pred_colors)\nplt.xlabel('Region')\nplt.ylabel('Quantity')\nplt.title('KMeans clusters, n = 4');","efa15b74":"sales_tr[:5]","6646cfe4":"X3 = sales_tr.iloc[:,[1,2]].values","5c1dd4af":"number_of_clusters=6\nkm = KMeans(n_clusters=number_of_clusters)\nkm.fit(X3)","ef09e1ff":"sales_tr['reps'] = le.fit_transform(sales_tr['reps'])\nsales_tr.head()","56bcb97f":"le.classes_","3199ac35":"colors = ['blue', 'green','purple','brown', 'yellow','red']\npred_colors = [colors[label] for label in km.labels_]\nplt.figure(figsize=(8, 8))\nplt.scatter(X3[:, 0], X3[:, 1], c=pred_colors)\nplt.title('KMeans clusters')\nplt.xlabel('Count of Transactions')\nplt.ylabel('Revenue');","7f6c8a05":"sales_tr[(sales_tr['transactions']>350) & (sales_tr['revenue']>31500)]","ad174c69":"X4 = sales_tr.iloc[:,[0,2]].values\nnumber_of_clusters=6\nkm = KMeans(n_clusters=number_of_clusters)\nkm.fit(X4)","4cfd537d":"colors = ['blue', 'green','purple','brown', 'cyan','red']\npred_colors = [colors[label] for label in km.labels_]\nplt.figure(figsize=(8, 8))\nplt.scatter(X4[:, 0], X4[:, 1], c=pred_colors)\nplt.title('KMeans clusters')\nplt.xlabel('Reps')\nplt.ylabel('Total Revenue')","9c9ed123":"sales_tr[(sales_tr['reps']<10) & (sales_tr['revenue']>25000)]","45205844":"X5 = sales_tr.iloc[:,[0,1]].values\nnumber_of_clusters=6\nkm = KMeans(n_clusters=number_of_clusters)\nkm.fit(X5)\ncolors = ['blue', 'green','purple','brown', 'cyan','red']\npred_colors = [colors[label] for label in km.labels_]\nplt.figure(figsize=(8, 8))\nplt.scatter(X5[:, 0], X5[:, 1], c=pred_colors)\nplt.title('KMeans clusters')\nplt.xlabel('Reps')\nplt.ylabel('Count of Transactions');","e2ca4f20":"X6 = sales_tr.iloc[:,[1,2]].values\nnumber_of_clusters=6\nkm = KMeans(n_clusters=number_of_clusters)\nkm.fit(X6)\nplt.figure(figsize=(10, 8))\nplt.scatter(X6[:, 0], X6[:, 1], c=pred_colors)\nplt.title('KMeans clusters')\nplt.ylabel('Total Revenue')\nplt.xlabel('Count of Transactions')","aa72d06c":"# Two subplots\nf, axarr = plt.subplots(1, 2, sharey=True, figsize=(12,10))\n\naxarr[0].scatter(X6[:, 0], X6[:, 1], c=pred_colors)\naxarr[0].set_title('Revenue-Transactions')\n#axarr[0].label('Total Revenue')\n#axarr[0].label('Count of Transactions')\naxarr[1].scatter(X4[:, 0], X4[:, 1], c=pred_colors)\n#axarr[1].label('Reps')\n\naxarr[1].set_title('Revenue by Reps');\n","1d92ff1a":"sales_tr[(sales_tr['transactions']<150) & (sales_tr['revenue']>10000)]","4bb60992":"from sklearn.linear_model import LinearRegression","ed6aebb2":"sales_tr.corr()","a64350eb":"X = sales_tr['transactions'].tolist()\ny = sales_tr['revenue'].tolist()","dc7e25f3":"# create a plot to view the correlation between X and y\nplt.figure(1, figsize=(10, 8))\nplt.title('Transactions vs Revenue')\nplt.xlabel('Transactions')\nplt.ylabel('Revenue')\nplt.scatter(X[:10000], y[:10000], color='blue')\nplt.show()","801d40bf":"feature_cols = ['transactions']\nX = sales_tr[feature_cols]\ny = sales_tr.revenue\n\n# instantiate and fit\nlm2 = LinearRegression()\nlm2.fit(X, y)\n\n# print the coefficients\nprint(lm2.intercept_)\nprint(lm2.coef_)\nlist(zip(feature_cols, lm2.coef_))","ca807af5":"220.348 + 92.1567*50","2aa23658":"sns.pairplot(sales_tr, x_vars=['transactions'], y_vars='revenue', size=10, aspect=0.8, kind='reg')","36c9b014":"# print the R-squared value for the model\nlm2.score(X, y)","714a6203":"from sklearn import metrics\n# Predict\ny_pred = lm2.predict(X)\ny_pred[:2]\n","15357149":"import seaborn as sns","2e55afe6":"plt.figure(figsize=(12,10))\nsns.heatmap(sales_tr.corr(),annot = True,cmap=\"YlGnBu\");","11109d61":"from pandas.tools.plotting import scatter_matrix\nscatter_matrix(sales_tr, figsize=(12,8), alpha=0.3);","e2673471":"sns.jointplot('revenue', 'transactions', data=sales_tr, size = 10);","80fe0cd2":"sns.lmplot('transactions', 'revenue',data=sales_tr, size = 10);","cce057e0":"sales_tr[\"transactions\"].plot(kind=\"box\",figsize=(9,9))","e30cd31b":"# visualize the relationship between the features and the response using scatterplots\nsns.pairplot(sales_tr, x_vars=['reps','transactions'], y_vars='revenue', size=7, aspect=0.7);","0c856b3c":"# set a seed for reproducibility\nnp.random.seed(12345)\n\n# create a Series of booleans in which roughly 0.4 are True\nnums = np.random.rand(len(sales))\nmask_large = nums > 0.4\n\n# initially set Size to small, then change 60% to be large\nsales['size'] = 'small'\n\n# sales.loc is a purely label-location based indexer for selection by label\nsales.loc[mask_large, 'size'] = 'large'\nsales.head()","dae0dae4":"sales['size'].value_counts()","111ce67f":"# create a new Series called Size_large\nsales['large_size'] = le.fit_transform(sales['size'])\nsales.head()","c57af493":"# create X and y\nfeature_cols = ['qty', 'large_size']\nX = sales[feature_cols]\ny = sales.revenue\n\n# instantiate\nlm = LinearRegression()\n# fit\nlm.fit(X, y)\n\n# print coefficients\nlist(zip(feature_cols, lm.coef_))","1857e6a3":"# set a seed for reproducibility\nnp.random.seed(123456)\n\n# assign roughly some percentage of observations to each group (20% to rural, 30% to suburban, 50% to urban)\nnums = np.random.rand(len(sales))\nmask_suburban = (nums > 0.2) & (nums < 0.5)\nmask_urban = nums > 0.5\nsales['Area'] = 'rural'\n# sales.loc is a purely label-location based indexer for selection by label\nsales.loc[mask_suburban, 'Area'] = 'suburban'\nsales.loc[mask_urban, 'Area'] = 'urban'\nsales.head()","7ccef532":"sales.Area.value_counts()","e679d458":"# create three dummy variables using get_dummies\npd.get_dummies(sales.Area, prefix='Area').head()","b2fd6cc9":"area_dummies = pd.get_dummies(sales.Area, prefix='Area')\narea_dummies.head()","ae3c8cb1":"sales_df = pd.concat([sales, area_dummies], axis=1)\nsales_df.head()","70d9c63c":"# create X and y\nfeature_cols = ['qty', 'large_size',  'Area_suburban', 'Area_urban']\nX = sales_df[feature_cols]\ny = sales_df.revenue\n\n# instantiate and fit\nlm3 = LinearRegression()\nlm3.fit(X, y)\n\n# print the coefficients\nlist(zip(feature_cols, lm3.coef_))","00e2f2e5":"****Geographic Segmentation****","d7a7adc1":"****Clustering Algorithms used here are:****\n\n* Hierarchical clustering\n* KMeans","ddefd3c4":"**** 2) Building a KMeans Clustering Model****","e87d9f9d":"****Using the Model for Prediction****","61f1365e":"****Interpreting the large_size coefficient****\n\nFor a given quantity, a large size is associated with a decrease in revenue of 0.47 rupees (as compared to a small size, which is called the baseline level).\n\nWhat if we had reversed the 1\/0 coding and created the feature small_size' instead?\nThe coefficient would be the same, except that it would be negative instead of positive\nAs such, your choice of category for the baseline does not matter, all that changes is your interpretation of the coefficient.","cb84209a":"Let's create a new feature called Area, and randomly assign observations to be rural, suburban, or urban.","a3ebccc1":"****Handling Categorical Features with More than Two Categories****\n\nWe will create one of our features as categorical.\nLet's create a new feature called 'size', and randomly assign observations to be small or large:","2dd542d2":"****Count or the number of transactions carried out by each rep****","f5a2b754":"Thus, we would predict Revenue of 4,828.18 rupees in that market.","49b63405":"****Encoding the Data****\n","77265fb4":"****Plotting the Least Squares Line****","1d4e5399":"****Questions:****\n\n* Is there a relationship between transactions and revenue? \n* How strong is that relationship?\n* If we increase our transaction count by 50, will there be an increase in revenue? \n* Given a increase in transaction in a particular market, Can the revenue be predicted?\n* How strong is that relationship?\n","d6728882":"A total of 33874 units were sold","db1d10b4":"****Visualize data****","f2da32b8":"****1) Building a Hierarchical clustering model****","58d32213":"The kernel density estimate may be less familiar, but it can be a useful tool for plotting the shape of a distribution. \nThe KDE plots encodes the density of observations on one axis with height along the other axis.","d576a1eb":"****How do we interpret the coefficients?****\n\nAn increase in 1 unit quantity is associated with 26.5 rupee increase in revenue.\n\nHolding all other variables fixed, a suburban area is associated with an decrease in revenue of 0.59 rupeess (as compared to the baseline level, which is rural).\nAn urban area is associated with a decrease in revenue of 2.70 rupees (as compared to rural).","99f5ad07":"There are 72 reps working with the company","2ccdb262":"Using the Model for Prediction\nLet's say that there was a new market where the transaction was 50 units.\n\nWhat would we predict the revenue in that market?\n \ny=-220.348+92.1567\u00d750","e5b04a34":"We want to see the revenue and quantity broken down by the products,and region... we would like to use pivot table.\n\nIn this case, the company management wants to understand sales in more details:\n- How much revenue is the reps generating in their respective regions?\n- What products are fast moving in terms of the quantity and revenue generated?\n- Who sells what products at what quantity in which region?\n","87caf3c1":"Alpen generated the highest revenue and Halls the lowest.","09951b17":"****KDE - Visualizing the distribution of a dataset****","e40feedf":"****number_of_clusters=6****","8ea285df":"****Make a pie chart****","8ea41224":"****number_of_clusters=4****","5bcc4b8a":"****Simple Linear Regression****","18bb9190":"****Transactions - Revenue Segmentation****","70cd2656":"****Product classification****","d0506dcc":"You will observe from the figure that East contributes to 16% of revenue, North - 36%, South - 17.5%, & West - 30.3%","5a0465fb":"**** What are count of transactions for each product ?****","3ca240f9":"**Explore and analyse data to extract valuable insights of the data **","8cd2b7cb":"Galaxy is the highest priced product and Halls is the lowest priced product.","63cc4164":"****Plot of Count of Transactions and Revenue****","d59d121f":"****Summary of Transactions and Revenue****","a56af824":"****Summary of Revenue generated by reps in each region****","5c9cb57a":"****Interpreting Model Coefficients****\n\nA \"unit\" increase in Transaction is associated with a 92.15 rupee increase in Revenue.","c4f7d82a":"What are a few key things we learn from this output?\n\np-values are small.\nThere is association between transactions and revenue\nThis model has a R-squared value of 0.948.\nThis model provides a good fit","6325ff76":"Total revenue generated by all the reps for the company is Rs. 9,05,702.21 covering 12 brands involving 10,000 transactions in all the 4 regions","305e2bc3":"****What is the Unit Price of each product?****","55e1cc38":"****What is the total quantity sold for each product ?****","53465298":"****Product Segmentation****","9afa7963":"****Per Capita Revenue ****\n\n(Average revenue = Total Revenue \/ No of Sales Reps) "}}