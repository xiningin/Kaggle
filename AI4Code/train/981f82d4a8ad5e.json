{"cell_type":{"99dc4e66":"code","e9bc6ef3":"code","08ef3590":"code","8ebc50af":"code","ebd9173b":"code","a25684f0":"code","ed9df2f8":"code","da21445c":"code","0cfdf98b":"code","12b3f001":"markdown","8f3c7a49":"markdown"},"source":{"99dc4e66":"import pandas as pd\nfrom tensorflow import keras\nfrom tensorflow.keras import layers\nfrom kerastuner.tuners import RandomSearch","e9bc6ef3":"df=pd.read_csv('..\/input\/air-quality\/Real_Combine.csv')\ndf.head()","08ef3590":"X=df.iloc[:,:-1] ## independent features\ny=df.iloc[:,-1] ## dependent features","8ebc50af":"\ndef build_model(hp):\n    model = keras.Sequential()\n    for i in range(hp.Int('num_layers', 2, 20)):\n        model.add(layers.Dense(units=hp.Int('units_' + str(i),\n                                            min_value=32,  # min value for neuron\n                                            max_value=512,  # max value\n                                            step=32),\n                               activation='relu'))\n    model.add(layers.Dense(1, activation='linear'))\n    model.compile(\n        optimizer=keras.optimizers.Adam(\n            hp.Choice('learning_rate', [1e-2, 1e-3, 1e-4])),\n        loss='mean_absolute_error',\n        metrics=['mean_absolute_error'])\n    return model","ebd9173b":"tuner = RandomSearch(\n    build_model,\n    objective='val_mean_absolute_error',\n    max_trials=5,\n    executions_per_trial=3, # 5*3 =15 trails(iteration) for each instances\n    directory='project',\n    project_name='Air Quality Index')","a25684f0":"tuner.search_space_summary()","ed9df2f8":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=0)","da21445c":"tuner.search(X_train, y_train,\n             epochs=5,\n             validation_data=(X_test, y_test))","0cfdf98b":"tuner.results_summary()","12b3f001":"# Keras Tuner- Decide Number of Hidden Layers And Neuron In Neural Network","8f3c7a49":"### Hyperparameters\n1. How many number of hidden layers we should have?\n1. How many number of neurons we should have in hidden layers?\n1. Learning Rate"}}