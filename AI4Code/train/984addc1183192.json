{"cell_type":{"bbdf1027":"code","f1dbd51f":"code","ba792b76":"code","3d536be2":"code","9c64f264":"code","b536d0d3":"code","e27c082f":"code","f8882830":"code","a570c605":"code","4992789c":"code","cdbecd95":"code","54bcfd8e":"code","a903da02":"code","e5ddf94a":"code","38a90033":"code","d88c1ac2":"code","98364a07":"code","1882196a":"code","689431e9":"code","bae3006b":"code","973cecca":"code","8c4fcc97":"code","49d3e3de":"code","b1d31801":"code","9e162acc":"code","12e1e1f4":"code","2c6242e9":"markdown","bef20a43":"markdown","a706c550":"markdown","c1bd4ec7":"markdown","cffab731":"markdown","637d324a":"markdown","2573f317":"markdown","48406b80":"markdown","ef892bbb":"markdown","bb6ee258":"markdown","38e41be7":"markdown","e9244b95":"markdown","9b3b9433":"markdown","856db2aa":"markdown","ad7f9cb0":"markdown","1f84ae6f":"markdown","49421f74":"markdown","cab477d3":"markdown","494880e0":"markdown","f29baf14":"markdown","0f8e7ef9":"markdown","2be32962":"markdown","92b876d7":"markdown","c784daae":"markdown","ae4ed7d9":"markdown"},"source":{"bbdf1027":"import numpy as np\nimport pandas as pd\nimport gc\nfrom tqdm.notebook import tqdm\n\n# \u6a5f\u68b0\u5b66\u7fd2\nfrom sklearn.model_selection import GroupKFold\nfrom sklearn.metrics import roc_auc_score\nfrom sklearn.metrics import f1_score\nimport lightgbm as lgb\n\n\n# \u53ef\u8996\u5316\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# \u8b66\u544a\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a\u3059\u308b\nimport warnings\nwarnings.filterwarnings('ignore')","f1dbd51f":"# \u8868\u793a\u884c\u6570\u30fb\u5217\u6570\u306e\u8a2d\u5b9a\npd.set_option('display.max_columns', 50)\npd.set_option('display.max_rows', 50)","ba792b76":"train = pd.read_csv(\"\/kaggle\/input\/marketing-dsg\/train.csv\")\ntest = pd.read_csv(\"\/kaggle\/input\/marketing-dsg\/test.csv\")\ntrain_prior_order = pd.read_csv(\"\/kaggle\/input\/marketing-dsg\/train_prior_order.csv\")\ntest_prior_order = pd.read_csv(\"\/kaggle\/input\/marketing-dsg\/test_prior_order.csv\")\nproducts = pd.read_csv(\"\/kaggle\/input\/marketing-dsg\/products.csv\")\ndepartments = pd.read_csv(\"\/kaggle\/input\/marketing-dsg\/departments.csv\")\nsample_submission = pd.read_csv(\"\/kaggle\/input\/marketing-dsg\/sample_submission.csv\")","3d536be2":"print(\"\u3010train\u3011\", train.shape)\ndisplay(train.head())\nprint(\"\u3010test\u3011\", test.shape)\ndisplay(test.head())\nprint(\"\u3010train_prior_order\u3011\", train_prior_order.shape)\ndisplay(train_prior_order.head())\nprint(\"\u3010test_prior_order\u3011\", test_prior_order.shape)\ndisplay(test_prior_order.head())\nprint(\"\u3010products\u3011\", products.shape)\ndisplay(products.head())\nprint(\"\u3010departments\u3011\", departments.shape)\ndisplay(departments.head())","9c64f264":"prior_order = train_prior_order.append(test_prior_order)","b536d0d3":"prior_order.shape","e27c082f":"prior_order = pd.merge(prior_order, products, on='product_id', how='left')\nprior_order = pd.merge(prior_order, departments, on='department_id', how='left')","f8882830":"# \u6ce8\u6587\u3054\u3068\u306b\u30e6\u30cb\u30fc\u30af\u306a\u5024\u3092\u6b8b\u3059\nprior_order_unique = prior_order.drop_duplicates('order_id')","a570c605":"sns.countplot(x=\"reordered\", data=prior_order)","4992789c":"# \u5546\u54c1\u3092\u30ad\u30fc\u306b\u96c6\u7d04\u3057\u3066\u5546\u54c1\u306e\u51fa\u73fe\u56de\u6570\u3092\u8abf\u3079\u308b\nproduct_count = prior_order.groupby(\"product_id\").count()[['order_id']].reset_index().rename(columns={'order_id':'product_count'})\nproduct_count.sort_values('product_count', ascending=False, inplace=True)\n\nproduct_count = pd.merge(product_count, products, on='product_id', how='left')\nproduct_count = pd.merge(product_count, departments, on='department_id', how='left')","cdbecd95":"# \u8ca9\u58f2\u70b9\u6570\u30c8\u30c3\u30d710\u306e\u5546\u54c1\nproduct_count.head(10)","54bcfd8e":"# \u8ca9\u58f2\u56de\u6570\u4e0a\u4f4d10\u4ef6\u306e\u8868\u793a\nsns.barplot(x=\"product_count\", y=\"product_name\", data=product_count.head(10))","a903da02":"sns.countplot(x=\"order_dow\", data=prior_order_unique)","e5ddf94a":"plt.figure(figsize=(20, 5))\nsns.countplot(x=\"order_hour_of_day\", data=prior_order_unique)","38a90033":"plt.figure(figsize=(20, 5))\nsns.distplot(prior_order_unique['days_since_prior_order'], kde=False, bins=30, color='blue')","d88c1ac2":"prior_order_unique['days_since_prior_order'].describe()","98364a07":"product_reorder = prior_order.groupby(\"product_id\").mean()[['reordered']].reset_index()\nproduct_reorder.sort_values('reordered', ascending=False, inplace=True)\n\nproduct_reorder = pd.merge(product_reorder, products, on='product_id', how='left')\nproduct_reorder = pd.merge(product_reorder, departments, on='department_id', how='left')","1882196a":"product_reorder.head(10)","689431e9":"# \u518d\u6ce8\u6587\u7387\u30e9\u30f3\u30ad\u30f3\u30b0top10\nsns.barplot(x=\"reordered\", y=\"product_name\", data=product_reorder.head(10))","bae3006b":"user_reorder = prior_order.groupby(\"user_id\").mean()[['reordered']].reset_index()\nuser_reorder.sort_values('reordered', ascending=False, inplace=True)","973cecca":"# \u8cfc\u8cb7\u3057\u305f\u5546\u54c1\u306e\u306a\u304b\u3067\u518d\u6ce8\u6587\u7387\u304c\u591a\u3044\u4e0a\u4f4d5\u4eba\nuser_reorder.head(5)","8c4fcc97":"# user_id == 26489\u306e\u30e6\u30fc\u30b6\u304c\u3069\u3093\u306a\u8cfc\u8cb7\u3092\u3057\u3066\u3044\u308b\u304b\u3092\u898b\u3066\u307f\u308b\nprior_order.query('user_id == 26489')","49d3e3de":"sns.countplot(y=\"product_name\", data=prior_order.query('user_id == 26489'))","b1d31801":"plt.figure(figsize=(20, 5))\nsns.distplot(prior_order.groupby(\"order_id\").count()[['user_id']], kde=False, bins=50, color='blue')","9e162acc":"prior_order.groupby(\"order_id\").count()[['user_id']].describe()","12e1e1f4":"plt.figure(figsize=(20, 5))\nsns.barplot(x=\"days_since_prior_order\",y=\"reordered\", data=prior_order.groupby('days_since_prior_order').mean()[['reordered']].reset_index())","2c6242e9":"### \u3069\u306e\u66dc\u65e5\u306b\u3088\u304f\u6ce8\u6587\u304c\u3042\u308b\u304b\uff1f","bef20a43":"# \u63a2\u7d22\u7684\u30c7\u30fc\u30bf\u89e3\u6790\n\u30c7\u30fc\u30bf\u306b\u5bfe\u3059\u308b\u7406\u89e3\u3092\u6df1\u3081\u308b\u305f\u3081\u306b\u30c7\u30fc\u30bf\u306b\u3064\u3044\u3066\u69d8\u3005\u306a\u8996\u70b9\u3067\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002","a706c550":"\u30d0\u30ca\u30ca\u3084\u30a4\u30c1\u30b4\u306e\u3088\u3046\u306a\u751f\u9bae\u98df\u54c1\u304c\u3088\u304f\u58f2\u308c\u3066\u3044\u308b","c1bd4ec7":"### \u6700\u3082\u518d\u6ce8\u6587\u3057\u3084\u3059\u3044user_id\u306f\uff1f","cffab731":"\u3060\u3044\u305f\u30441\u56de\u306e\u6ce8\u6587\u3067\u306f8\u500b\u304f\u3089\u3044\u8cfc\u5165\u3059\u308b\u4eba\u304c\u666e\u901a\u30011\u756a\u591a\u3044\u4eba\u306f145\u500b\u6ce8\u6587\u3057\u3066\u3044\u308b","637d324a":"### \u518d\u6ce8\u6587\u3067\u3042\u308b\u5272\u5408","2573f317":"1\u9031\u9593\u304f\u3089\u3044\u306e\u9593\u9694\u3067\u6ce8\u6587\u304c\u884c\u308f\u308c\u308b\u3053\u3068\u304c\u983b\u5ea6\u3068\u3057\u3066\u306f\u591a\u3044\u3002  \n\u6700\u5927\u304c30\u65e5\u306730\u65e5\u3060\u3051\u30c7\u30fc\u30bf\u306e\u4ef6\u6570\u304c\u591a\u3044\u306e\u3067\u3001\u3082\u3057\u304b\u3059\u308b\u306830\u65e5\u4ee5\u4e0a\u306f30\u65e5\u306b\u96c6\u7d04\u3055\u308c\u3066\u3044\u308b\u53ef\u80fd\u6027\uff1f","48406b80":"# \u30c7\u30fc\u30bf\u8aad\u307f\u8fbc\u307f","ef892bbb":"### 1\u56de\u306e\u6ce8\u6587\u3067\u4f55\u5546\u54c1\u304f\u3089\u3044\u540c\u6642\u306b\u8cb7\u3046\u304b\uff1f","bb6ee258":"# \u30d1\u30c3\u30b1\u30fc\u30b8\u8aad\u307f\u8fbc\u307f","38e41be7":"\u534a\u6570\u4ee5\u4e0a\u306f\u904e\u53bb\u306b\u305d\u306e\u30e6\u30fc\u30b6\u304c\u518d\u6ce8\u6587\u3057\u305f\u3053\u3068\u304c\u3042\u308b\u5546\u54c1  \n\u30b9\u30fc\u30d1\u30fc\u3068\u3044\u3046\u7279\u6027\u4e0a\u3001\u518d\u6ce8\u6587\u306f\u304b\u306a\u308a\u3055\u308c\u3084\u3059\u3044\u3088\u3046\u306b\u601d\u3048\u308b","e9244b95":"# \u5404\u30c7\u30fc\u30bf\u306e\u4e2d\u8eab\u306e\u78ba\u8a8d","9b3b9433":"99\u56de\u306e\u6ce8\u6587\u306e\u3046\u306180\u56de\u4ee5\u4e0a\u306fOriginal Pure Creamy Almond Milk\u3092\u6ce8\u6587\u3057\u3066\u3044\u308b","856db2aa":"### \u518d\u6ce8\u6587\u3055\u308c\u3084\u3059\u3044\u5546\u54c1\u30e9\u30f3\u30ad\u30f3\u30b0","ad7f9cb0":"\u6642\u9593\u3068\u3057\u3066\u306f\u4eba\u9593\u306e\u6d3b\u52d5\u6642\u9593\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u305d\u3046\u306a\u306e\u3067\u3001\u73fe\u5730\u306e\u6642\u9593\u306b\u8fd1\u3044\u3088\u3046\u306b\u601d\u3048\u308b","1f84ae6f":"### \u58f2\u308c\u3066\u308b\u5546\u54c1\u30e9\u30f3\u30ad\u30f3\u30b0\u30c8\u30c3\u30d710","49421f74":"### \u524d\u56de\u304b\u3089\u306e\u6ce8\u6587\u65e5\u6570\u306f\u3069\u306e\u304f\u3089\u3044\u304c\u591a\u3044\u304b\uff1f","cab477d3":"### \u5546\u54c1\u306e\u51fa\u73fe\u56de\u6570\u5206\u5e03","494880e0":"### \u524d\u56de\u304b\u3089\u306e\u6ce8\u6587\u304b\u3089\u4f55\u65e5\u76ee\u304c\u4e00\u756a\u518d\u8cfc\u5165\u3057\u3084\u3059\u3044\u304b\uff1f","f29baf14":"\u4e0e\u3048\u3089\u308c\u305f\u30c7\u30fc\u30bf\u306b\u306f\u66dc\u65e5\u306e\u5b9a\u7fa9\u304c\u3055\u308c\u3066\u3044\u306a\u3044\u304c\u3001\u50be\u5411\u3068\u3057\u30660-1\u3060\u3051\u7570\u306a\u308b\u305f\u3081\u3053\u306e\u65e5\u304c\u9031\u672b\u306e\u53ef\u80fd\u6027\u304c\u3042\u308b","0f8e7ef9":"## \u904e\u53bb\u306e\u6ce8\u6587\u5c65\u6b74","2be32962":"### \u3069\u306e\u6642\u9593\u5e2f\u306b\u6ce8\u6587\u304c\u3042\u308b\u304b\uff1f","92b876d7":"### \u5546\u54c1\u30fb\u30ab\u30c6\u30b4\u30ea\u306e\u60c5\u5831\u3068\u7d50\u5408","c784daae":"### \u30e6\u30cb\u30fc\u30af\u306a\u6ce8\u6587\u3054\u3068\u306b1\u884c\u3060\u3051\u6b8b\u3057\u305f\u30c7\u30fc\u30bf","ae4ed7d9":"\u8cfc\u5165\u9593\u9694\u304c\u3042\u304f\u3068\u518d\u8cfc\u5165\u7387\u306f\u4e0b\u304c\u3063\u3066\u3044\u308b\u3088\u3046\u306b\u307f\u3048\u308b"}}