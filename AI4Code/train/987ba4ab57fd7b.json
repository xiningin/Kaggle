{"cell_type":{"ac38a712":"code","a5d39718":"code","68dfcc57":"code","50620ca9":"code","d0b0b12c":"code","40e1951c":"code","06844ebd":"code","272dfb8f":"code","2da88f2b":"code","7e9a65ab":"markdown","273fa3a9":"markdown","5f947ab4":"markdown","26816df4":"markdown","7968f3df":"markdown","94601adc":"markdown"},"source":{"ac38a712":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport joblib\nfrom xgboost import XGBRegressor","a5d39718":"train = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/test.csv')\nprint('train shape:',train.shape)\nprint('test shape:',test.shape)","68dfcc57":"# Train data\nX_train = train.drop(columns = ['loss','id'])\ny_train = train['loss'].values\n\n# Test data\nX_test=test.drop(columns = ['id'])\nprint('Train set:', X_train.shape)\nprint('Test set:', X_test.shape)","50620ca9":"study = joblib.load(\"..\/input\/tps-aug-2021-xgboost-201-with-optuna-part-1-2\/xgb_study.pkl\")","d0b0b12c":"model = XGBRegressor(\n    **study.best_params, \n    tree_method='gpu_hist', \n    learning_rate=0.01, \n    booster='gbtree'\n)","40e1951c":"model.fit(X_train, \n          y_train,\n          eval_metric=\"rmse\",\n          verbose=True)","06844ebd":"y_pred = model.predict(X_test)","272dfb8f":"preds = pd.read_csv(\"..\/input\/tabular-playground-series-aug-2021\/sample_submission.csv\")\npreds.loss = y_pred\npreds.head()","2da88f2b":"preds.to_csv('submission_xgbboost_201.csv', index=False)","7e9a65ab":"# Submission","273fa3a9":"# Load datasets","5f947ab4":"# Load tuned hyperparameters obtained from [XGBoost 201 - with Optuna Part 1\/2](https:\/\/www.kaggle.com\/aayush26\/tps-aug-2021-xgboost-201-with-optuna-part-1-2\/notebook)","26816df4":"# Prediction","7968f3df":"# Imports","94601adc":"# Model training"}}