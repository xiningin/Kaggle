{"cell_type":{"9d3c65ff":"code","b7cc1c78":"code","9b9d9b06":"code","4a2a5f8f":"code","80751829":"code","cdf9571e":"code","5f8fa5c1":"code","d7517110":"code","4899d7ae":"code","f458137b":"code","3af7b9bc":"code","b94e64de":"markdown","ee065b0b":"markdown","b9751320":"markdown","68307118":"markdown","0d6df173":"markdown","9d4ad3a6":"markdown","30b45e46":"markdown","bd79daab":"markdown","197786c8":"markdown","6bef4f9e":"markdown","56aafbc0":"markdown","d892cc17":"markdown","35842a0b":"markdown","11f6ec51":"markdown","60f50b93":"markdown","47466a56":"markdown"},"source":{"9d3c65ff":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","b7cc1c78":"file = '..\/input\/30-days-of-ml\/train.csv'\ndata = pd.read_csv(file)\nprint(data.shape)\ndata.head()","9b9d9b06":"data.describe(include='all')","4a2a5f8f":"cat_columns = data.select_dtypes(include=['object']).columns\nnum_columns = data.select_dtypes(exclude=['object']).columns\nprint('Categorical columns: {}'.format(cat_columns.values))\nprint('Numerical columns: {}'.format(num_columns.values))\nprint(data.isnull().any())","80751829":"categorical = cat_columns\nnumerical = num_columns.drop(['id', 'target'])\ndataset = data.drop('id', axis = 1)","cdf9571e":"plt.figure(figsize=(20,10))\nplt.subplots_adjust(hspace=0.4, wspace=0.4)\nfor i, cat_attrib in enumerate(categorical):\n    plt.subplot(3, 5, i+1)\n    sns.histplot(dataset[cat_attrib])\n    plt.title(cat_attrib)\nplt.show()","5f8fa5c1":"plt.figure(figsize=(20,10))\nplt.subplots_adjust(hspace=0.4, wspace=0.4)\nfor i, cat_attrib in enumerate(categorical):\n    plt.subplot(3, 5, i+1)\n    sns.boxplot(x=cat_attrib, y='target', data=dataset[[cat_attrib, 'target']])\n    plt.title(cat_attrib)\nplt.show()","d7517110":"plt.figure(figsize=(20,10))\nplt.subplots_adjust(hspace=0.4, wspace=0.4)\nfor i, num_attrib in enumerate(numerical):\n    plt.subplot(3, 5, i+1)\n    sns.histplot(dataset[num_attrib], bins=20, kde=True)\n    plt.title(num_attrib)\nplt.show()","4899d7ae":"sns.histplot(dataset.target, bins=20, kde=True);","f458137b":"plt.figure(figsize=(5,7))\nsns.boxplot(y='target', data=dataset, orient='v')\nplt.show()\niqr = (dataset.target.quantile(0.75)-dataset.target.quantile(0.25))\nhi_out = dataset.target.quantile(0.75) + 1.5*iqr\nlo_out = dataset.target.quantile(0.25) - 1.5*iqr\nhi_per = dataset.target.where(dataset.target>hi_out).count() \\\n         \/ dataset.target.count() * 100\nlo_per = dataset.target.where(dataset.target<lo_out).count() \\\n         \/ dataset.target.count() * 100\nprint('High outliers: >{:.4f} ({:.2f}%)'.format(hi_out, hi_per))\nprint('Low outliers: <{:.4f} ({:.2f}%)'.format(lo_out, lo_per))","3af7b9bc":"plt.figure(figsize=(20,10))\nsns.heatmap(dataset.corr(), annot=True, cmap='twilight_shifted');","b94e64de":"# Distribution of numerical attributes","ee065b0b":"# Read training data and provide a initial basic analysis","b9751320":"Frequency graphics allows analysis of the categorical attributes, considering the internal distribution of their classes. Attributes \u2018cat4\u2019, \u2018cat6\u2019, \u2018cat7\u2019, and, probably, \u2018cat2\u2019 and \u2018cat3\u2019 have a high concentration in just one internal value. For this reason, these attributes seem to have low relevance for modelling and could be considered for removing.","68307118":"# Correlation matrix between all numerical attributes and the target","0d6df173":"The synthetic dataset provided for the 30 Days of ML competition has 26 columns and 30,000 instances, with attributes artificial labelled and fulfilled. For this reason, featuring engineering considering the meaning and of these attributes is not possible. The dataset contains 10 categorical attributes, 14 numerical attributes, and a numeric target value. There is also an id attribute that was dropped, with no meaning for data analysis.","9d4ad3a6":"# Get categorical and numerical attributes. Check for missing values.","30b45e46":"# Variation of the target value in each categorical attribute","bd79daab":"Considering the target's histogram, it presents a left-skewed with and very few instances with values below 7.","197786c8":"# **Exploratory Data Analysis**","6bef4f9e":"# Set variables for categorical and numerical attributes","56aafbc0":"# Distribution of the target","d892cc17":"The boxplot of the target enlightened the existence of outliers that must be considered to be dropped out.","35842a0b":"# Frequency distribution of categorical attributes","11f6ec51":"Although there is a difference in the frequency of each class in the categorical attributes, comparing the target attribute with each class of the categorical attributes through the boxplots, it was not possible to infer any suggestion.","60f50b93":"The correlation heatmap shows very weak correlations between numerical attributes and the target. Some attributes present moderate correlation coefficients between each other.","47466a56":"Histograms of the numerical attributes demonstrate a dispersed distribution of these attributes, except for \u2018cont0\u2019 and \u2018count6\u2019 that seem to have a Gaussian distribution."}}