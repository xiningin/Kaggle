{"cell_type":{"9d893750":"code","e966d875":"code","cb60fda0":"code","584067d4":"code","a0efab88":"code","7c77de44":"code","ca8ae389":"code","34fddb4f":"code","9ee48012":"code","fc117d08":"code","af846dec":"code","f10b7f60":"code","c1da3658":"code","13e85e00":"code","08130407":"code","4306ce84":"code","5d735c0d":"code","9b8b3dc9":"code","1b658c95":"code","122aad29":"code","67fa9d87":"code","f3a4ea82":"code","232f4441":"code","a49108a4":"code","a9eee85f":"code","7cbe970e":"code","e188d91b":"code","66b0fcbc":"code","59352a30":"code","3da24271":"code","0d55ea83":"code","e736a53f":"code","9e5f57bd":"code","065741ef":"code","f63d2843":"code","8a5a310b":"code","807b7bca":"code","a5d003ff":"code","1c27031d":"code","2274cc39":"code","dd5bf4c1":"code","1882795c":"code","cb1e8590":"code","8a7078d0":"code","148def0b":"code","50915034":"code","efcbbaf7":"code","8068efa7":"code","37ef9564":"code","2b05343a":"code","d0d8a51f":"code","25a6c810":"code","da77fed2":"code","e4b53c53":"code","d41ef019":"code","24b3a663":"code","0216e290":"code","653abff6":"code","8a46d865":"code","428ffe68":"code","6c1a4e08":"code","126eb12e":"code","b13cce29":"code","930123c0":"code","8343e91b":"code","663e1c57":"code","a38519d9":"markdown"},"source":{"9d893750":"import pandas as pd\ndata=pd.read_csv(\"..\/input\/tabular-playground-series-dec-2021\/train.csv\")\ndata.head()","e966d875":"data.info()","cb60fda0":"Wilderness_Area_cols = [col for col in data.columns if 'Wilderness_Area' in col]\nWilderness_Area_cols","584067d4":"Wilderness_Area=data[Wilderness_Area_cols]\nWilderness_Area.head()","a0efab88":"df_n = Wilderness_Area.apply(lambda x: x.idxmax(), axis = 1)\ndf_n.head()","7c77de44":"Wilderness_Area=pd.DataFrame(df_n, columns=['Wilderness'])\nWilderness_Area.head()","ca8ae389":"Wilderness_Area.Wilderness.value_counts()","34fddb4f":"Wilderness_Area.Wilderness=Wilderness_Area.Wilderness.map({'Wilderness_Area1':'Area1',\n                                                           'Wilderness_Area2':'Area2',\n                                                          'Wilderness_Area3':'Area3',\n                                                          'Wilderness_Area4':'Area4'})\nWilderness_Area.Wilderness.value_counts()","9ee48012":"data=data.drop(['Wilderness_Area1','Wilderness_Area2','Wilderness_Area3','Wilderness_Area4'],axis=1)\ndata.head()","fc117d08":"data=pd.concat([data, Wilderness_Area], axis=1)\ndata.head()","af846dec":"Soil_Type_cols = [col for col in data.columns if 'Soil_Type' in col]\nSoil_Type_cols","f10b7f60":"Soil_Type=data[Soil_Type_cols]\nSoil_Type.head()","c1da3658":"df_n = Soil_Type.apply(lambda x: x.idxmax(), axis = 1)\ndf_n.head()","13e85e00":"Soil_Type=pd.DataFrame(df_n, columns=['Soil'])\nSoil_Type.head()","08130407":"Soil_Type.Soil.value_counts()","4306ce84":"Soil_Type.Soil = Soil_Type.Soil.str.replace('Soil_', '')\nSoil_Type.Soil.value_counts()","5d735c0d":"data=data.drop(Soil_Type_cols,axis=1)\ndata.head()","9b8b3dc9":"data=pd.concat([data, Soil_Type], axis=1)\ndata.head()","1b658c95":"data.info()","122aad29":"data.nunique()","67fa9d87":"round(data.Cover_Type.value_counts()*100\/len(data),2)","f3a4ea82":"data.Cover_Type.value_counts()","232f4441":"data=data[data.Cover_Type!=5]\ndata=data[data.Cover_Type!=4]\ndata=data[data.Cover_Type!=6]\ndata=data[data.Cover_Type!=7]\ndata=data.sample(n=100000)\ndata.reset_index(drop=True, inplace=True)\ndata.shape","a49108a4":"round(data.Cover_Type.value_counts()*100\/len(data),2)","a9eee85f":"data.Cover_Type=data.Cover_Type.map({1:0,2:1,3:2})\nround(data.Cover_Type.value_counts()*100\/len(data),2)","7cbe970e":"data.Cover_Type.unique()","e188d91b":"pd.options.display.float_format = '{:.2f}'.format\ndata.describe()","66b0fcbc":"data.nunique().sort_values(ascending=False)","59352a30":"!pip install pycaret[full]","3da24271":"from pycaret.classification import *","0d55ea83":"forest= setup(data=data,\n          target = \"Cover_Type\",  session_id=42,\n          normalize=True,\n          train_size = 0.8, # training over 80% of available data\n          handle_unknown_categorical = True, \n          remove_multicollinearity = True, #drop one of the two features that are highly correlated with each other\n          ignore_low_variance = True,#all categorical features with statistically insignificant variances are removed from the dataset.    \n          ignore_features=['Id'],\n          categorical_features=['Wilderness'],\n              high_cardinality_features=['Soil'],\n          combine_rare_levels = True,\n          fix_imbalance = True,\n          unknown_categorical_method= 'most_frequent',\n          transformation = True,silent=True\n         )","e736a53f":"xgboost = create_model('xgboost')\nxgboost","9e5f57bd":"lightgbm = create_model('lightgbm')\nlightgbm","065741ef":"catboost = create_model('catboost')\ncatboost","f63d2843":"rf = create_model('rf')\nrf","8a5a310b":"et = create_model('et')\net","807b7bca":"gbc = create_model('gbc')\ngbc ","a5d003ff":"blender = blend_models(estimator_list = [xgboost,lightgbm,catboost,\n                                        rf,et,gbc], method = 'soft')\nblender","1c27031d":"plot_model(blender,plot = 'confusion_matrix',use_train_data=True)","2274cc39":"plot_model(blender,plot = 'confusion_matrix')","dd5bf4c1":"plot_model(blender,plot = 'class_report',use_train_data=True)","1882795c":"plot_model(blender,plot = 'class_report')","cb1e8590":"predict_model(blender)","8a7078d0":"final_blender_soft_6models = finalize_model(blender)\nfinal_blender_soft_6models","148def0b":"test=pd.read_csv(\"..\/input\/tabular-playground-series-dec-2021\/test.csv\")\ntest.head()","50915034":"Wilderness_Area_cols = [col for col in test.columns if 'Wilderness_Area' in col]\nWilderness_Area_cols","efcbbaf7":"Wilderness_Area=test[Wilderness_Area_cols]\nWilderness_Area.head()","8068efa7":"df_n = Wilderness_Area.apply(lambda x: x.idxmax(), axis = 1)\ndf_n.head()","37ef9564":"Wilderness_Area=pd.DataFrame(df_n, columns=['Wilderness'])\nWilderness_Area.head()","2b05343a":"Wilderness_Area.Wilderness.value_counts()","d0d8a51f":"Wilderness_Area.Wilderness=Wilderness_Area.Wilderness.map({'Wilderness_Area1':'Area1',\n                                                           'Wilderness_Area2':'Area2',\n                                                          'Wilderness_Area3':'Area3',\n                                                          'Wilderness_Area4':'Area4'})\nWilderness_Area.Wilderness.value_counts()","25a6c810":"test=test.drop(['Wilderness_Area1','Wilderness_Area2','Wilderness_Area3','Wilderness_Area4'],axis=1)\ntest.head()","da77fed2":"test=pd.concat([test, Wilderness_Area], axis=1)\ntest.head()","e4b53c53":"Soil_Type_cols = [col for col in test.columns if 'Soil_Type' in col]\nSoil_Type_cols","d41ef019":"Soil_Type=test[Soil_Type_cols]\nSoil_Type.head()","24b3a663":"df_n = Soil_Type.apply(lambda x: x.idxmax(), axis = 1)\ndf_n.head()","0216e290":"Soil_Type=pd.DataFrame(df_n, columns=['Soil'])\nSoil_Type.head()","653abff6":"Soil_Type.Soil = Soil_Type.Soil.str.replace('Soil_', '')\nSoil_Type.Soil.value_counts()","8a46d865":"test=test.drop(Soil_Type_cols,axis=1)\ntest.head()","428ffe68":"test=pd.concat([test, Soil_Type], axis=1)\ntest.head()","6c1a4e08":"predictions=predict_model(final_blender_soft_6models,data =test)\npredictions.head()","126eb12e":"predictions=predictions[['Id','Label']]\npredictions.head()","b13cce29":"predictions.Label.value_counts()","930123c0":"predictions.Label=predictions.Label.map({0:1,1:2,2:3})\npredictions.Label.value_counts()","8343e91b":"predictions.columns = ['Id', 'Cover_Type']\npredictions.head()","663e1c57":"predictions.to_csv('.\/predictions.csv',index=False)","a38519d9":"We used Voting Classifier\n\nestimator_list = xgboost,lightgbm,catboost, rf,et & gbc\n\nmethod = soft"}}