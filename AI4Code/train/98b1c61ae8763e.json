{"cell_type":{"07e60407":"code","645a6ead":"code","f5331fc3":"code","8e3ab4b5":"code","1fe260cb":"code","3d789e1b":"code","cc9ca9a5":"code","0368ff98":"code","80c3c04f":"code","cb650f0a":"code","8215a391":"code","15f21591":"code","8f914e9d":"code","7064348d":"code","949a49fa":"code","c4c7ca76":"code","cb3ccf96":"code","5e70930e":"code","956844f4":"code","06c248ae":"code","169edf3b":"code","2e55d305":"code","c246182f":"code","7268beca":"code","27aad316":"code","1514b71f":"code","a8fb5ff2":"code","ea8eeca6":"markdown","edc1aad6":"markdown","10549662":"markdown","0321c61a":"markdown","271df3e7":"markdown","09d6658f":"markdown","883de28c":"markdown","b63900e2":"markdown","c211f1a5":"markdown","edbde8c9":"markdown","62ec837a":"markdown","5ea69fa2":"markdown","ddfc4a0b":"markdown","fe919620":"markdown","0c37e3d5":"markdown","4a9daa75":"markdown","3656b272":"markdown","c43cc835":"markdown","071da108":"markdown","bc4ea0eb":"markdown","b9edf198":"markdown","5fa2c8af":"markdown","9ada526a":"markdown","778df316":"markdown","7d155b60":"markdown","3fd9339b":"markdown"},"source":{"07e60407":"import zipfile\nimport tempfile\nimport json\nimport re\nfrom datetime import date\n\nimport requests\nimport pandas as pd\nimport seaborn as sns\nfrom dateutil.parser import parse\nimport matplotlib.pyplot as plt\n\nsns.set()","645a6ead":"# Source: 'http:\/\/api.eia.gov\/bulk\/EBA.zip'\ndata = open('..\/input\/eba-feb-2021\/EBA.txt').readlines()\n","f5331fc3":"ercot_data = []\nfor d in data:\n  if 'ERCO' in d:\n    j = json.loads(d)\n    if 'ERCO' in j['name']:\n      ercot_data.append(j)\n  \n# filter out duplicated UTC\nercot_data = [d for d in ercot_data if 'local time' in d['name']]\nercot_data = {d['name']: d for d in ercot_data}","8e3ab4b5":"gen_data = {re.search(r'Net generation from (.*) for Electric Reliability', k).group(1): v for k, v in ercot_data.items() if 'Net generation from' in k}","1fe260cb":"df = pd.DataFrame({\n    'Time': pd.DataFrame(gen_data['coal']['data'])[0].map(lambda x: parse(x.split('-')[0])),\n    'Coal': pd.DataFrame(gen_data['coal']['data'])[1],\n    'Nuclear': pd.DataFrame(gen_data['nuclear']['data'])[1],\n    'Other': pd.DataFrame(gen_data['solar']['data'])[1] + pd.DataFrame(gen_data['other']['data'])[1],\n    'Natural Gas': pd.DataFrame(gen_data['natural gas']['data'])[1],\n    'Wind': pd.DataFrame(gen_data['wind']['data'])[1],\n}).set_index('Time')","3d789e1b":"subset = df[df.index.map(lambda x: x.date()) >= date(2021, 1, 1)].sort_index()","cc9ca9a5":"# ERCOT's outage data is stored for the past 30 days, and it's stored in a very\n# annoying way. So rather than hammering their servers each time to collect the\n# outage data, which will eventually become obsolete anyway, I just stored it in\n# a CSV. The code for reproducing that CSV is in this cell.\n\n# import io\n# import re\n# from datetime import datetime, date\n# from multiprocessing.dummy import Pool\n\n# import bs4\n# import pandas as pd\n# import requests\n\n\n# url = 'http:\/\/mis.ercot.com\/misapp\/GetReports.do?reportTypeId=13103&' \\\n#       'reportTitle=Hourly%20Resource%20Outage%20Capacity&showHTMLView=&mimicKey'\n# r = requests.get(url)\n# soup = bs4.BeautifulSoup(r.text)\n\n# csv_urls = ['http:\/\/mis.ercot.com\/' + td.parent.find('a')['href'] \n#             for td in soup.findAll('td', text=re.compile('.*csv.zip'))]\n\n# pool = Pool(5)\n\n# data = []\n\n# for idx, r in enumerate(pool.imap(requests.get, csv_urls)):\n#     data.append(dict(pd.read_csv(io.BytesIO(r.content), compression='zip').iloc[0]))\n\n# outages = pd.DataFrame(data)\n# outages['Date'] = outages['Date'].map(parse)\n# outages['Hour'] = outages['HourEnding'].map(int) - 1\n# outages['Time'] = outages.apply(lambda r: datetime(year=r['Date'].year, month=r['Date'].month, day=r['Date'].day,\n#                                                    hour=r['Hour']), axis=1)\n# outages.rename(columns={'TotalIRRMW': 'Renewable Outages',\n#                         'TotalResourceMW': 'Thermal Outages'}, inplace=True)\n# outages = outages[outages['Time'].map(lambda x: x.date()) >= date(2021, 1, 1)][['Time', 'Renewable Outages', 'Thermal Outages']].rename(columns={\n#     'Time': 'Date',\n# }).set_index('Date')\n\n# outages.plot(xlabel='Time', ylabel='MW', color=['#823200', '#53065C']);\n\noutages = pd.read_csv('..\/input\/ercot-outages-feb-2021\/ERCOT_outages.csv')\n\noutages['Date'] = outages['Date'].map(parse)\noutages.set_index('Date', inplace=True)\n","0368ff98":"subset.T.sum().plot(figsize=(12, 8), xlabel='Hour', ylabel='MW Generated', \n                    color='#000000');","80c3c04f":"subset.plot(figsize=(12, 8), xlabel='Hour', ylabel='MW Generated');","cb650f0a":"subset.plot.area(figsize=(12, 8), xlabel='Hour', ylabel='MW Generated');","8215a391":"subset.divide(subset.T.sum(), axis=0).multiply(100).plot.area(\n    figsize=(12, 8), xlabel='Hour', ylabel='% of Generation'\n  );","15f21591":"subset[subset.index.map(lambda x: x.date() <= date(2021, 2, 8))]['Wind'].plot(figsize=(12, 8), xlabel='Hour', ylabel='MW Generated');","8f914e9d":"subset[subset.index.map(lambda x: x.date() <= date(2021, 2, 8))]['Wind'].describe()","7064348d":"subset[subset.index.map(lambda x: x.date() <= date(2021, 2, 8))][['Natural Gas', 'Wind']].plot.area(\n    figsize=(12, 8), xlabel='Hour', ylabel='MW Generated', \n    color=['#c04d53', '#7e75b1']\n);","949a49fa":"subset[subset.index.map(lambda x: x.date() <= date(2021, 2, 8))][['Natural Gas', 'Wind']].corr()","c4c7ca76":"subset[subset.index.map(lambda x: x.date() <= date(2021, 2, 8))][['Natural Gas', 'Wind']].divide(\n    subset[subset.index.map(lambda x: x.date() <= date(2021, 2, 8))][['Natural Gas', 'Wind']].T.sum(), axis=0\n).multiply(100).plot.area(figsize=(12, 8), xlabel='Hour', ylabel='% of Gas-Wind', \n            color=['#c04d53', '#7e75b1']);","cb3ccf96":"subset[['Natural Gas', 'Wind']].plot.area(\n    figsize=(12, 8), xlabel='Hour', ylabel='MW Generated', \n    color=['#c04d53', '#7e75b1']\n);","5e70930e":"outages.plot(xlabel='Time', ylabel='MW', figsize=(20, 8), color=['#823200', '#53065C']);","956844f4":"gas_vs_thermal = df[df.index.map(lambda x: x.date()) >= date(2021, 2, 1)].join(outages)[['Natural Gas', 'Thermal Outages']]\ngas_vs_thermal.plot(figsize=(20, 8), color=['#c04d53', '#823200'],\n                    xlabel='Time', ylabel='MW');","06c248ae":"gas_vs_thermal.corr()","169edf3b":"gas_vs_thermal[gas_vs_thermal.index.map(lambda x: x.date()) >= date(2021, 2, 10)].corr()","2e55d305":"coal_vs_thermal = df[df.index.map(lambda x: x.date()) >= date(2021, 2, 1)].join(outages)[['Coal', 'Thermal Outages']]\ncoal_vs_thermal.plot(figsize=(20, 8), color=['#4a75ae', '#344F73'],\n                    xlabel='Time', ylabel='MW');","c246182f":"coal_vs_thermal.corr()","7268beca":"nuclear_vs_thermal = df[df.index.map(lambda x: x.date()) >= date(2021, 2, 1)].join(outages)[['Nuclear', 'Thermal Outages']]\nnuclear_vs_thermal.plot(figsize=(20, 8), color=['#da8256', '#91573A'],\n                    xlabel='Time', ylabel='MW');","27aad316":"nuclear_vs_thermal.corr()","1514b71f":"wind_vs_renewables = df[df.index.map(lambda x: x.date()) >= date(2021, 2, 1)].join(outages)[['Wind', 'Renewable Outages']]\nwind_vs_renewables.plot(figsize=(20, 8), color=['#7e75b1', '#53065C'],\n                        xlabel='Time', ylabel='MW');","a8fb5ff2":"wind_vs_renewables.corr()","ea8eeca6":"Wait a second, what's that positive correlation doing there? That suggests that natural gas production is not inversely correlated with thermal outages. Maybe that's just noise from the wind-gas flucutation. What if we look at just the time period after wind starts dropping off the grid (Feb. 9)?","edc1aad6":"Okay that looks more like what we would expect. Once we remove the normal fluctuation caused by the wind-gas trade-off, natural gas does indeed get hit by generation outages.","10549662":"It's all over the place. Yes, wind would \"reliably\" (about 75% of the time) deliver 5.7+ GW  But it even under normal conditions, it ranged from a whopping 22.4 GW to a measly 1.0 GW.","0321c61a":"So when policy makers say that wind generators failed en masse, they're absolutely correct. However, what they're leaving out is that wind is so unreliable that it didn't make a difference anyway. The grid just assumes that the wind will drop off entirely anytime it feels like it, and so it basically has no part to play in resource adequacy.\n\nThis doesn't strike me as particularly flattering to wind, but it does mean that wind is not the appropriate scapegoat for reliability issues. Because, again, wind is not really a stand-alone resource; it's designed to run in tandem with (and be completely compensated for by) natural gas, which is exactly what we see happening when wind generation starts dropping off on February 9:","271df3e7":"Interesting aside, that's one of the Texas South Units (which are on the Gulf) going offline. Those are regulated by the Federal Nuclear Regulatory Commission. Further, it's pretty clear that the reactor went offline due to cold weather.\n\nThese two facts together strongly cut against any narrative that federal control is _ipso facto_ better than state control on the issue of winterization or reliability, or that greedy generators ignored winterization recommendations that a generator with more oversight would have followed. It's hard to get more regulated than a nuclear reactor, though I confess I'm not anything an expert on NRC regulations.","09d6658f":"Notice the extremely strong negative correlation:","883de28c":"Notice the sharp spike in production, starting around the 9th. That's to meet demand from the winter storm.\n\nLet's break it out by generation source into one very busy graph, so you can stare into the chaos and know it's not just stacked bar charts lying to your eyes:","b63900e2":"So what about the February 9 outages? That was mostly wind. Does that mean wind is to blame? If we had that generation, we'd be okay right?\n\nNo. Here's the dirty little secret about wind: Wind is so unreliable that it basically doesn't constitute a separate power source at all. Here's wind generation over the past month or so under normal conditions","c211f1a5":"Okay but seriously here's a proper graph:\n","edbde8c9":"Even under normal operating conditions, wind and gas are extremely strongly negatively correlated:","62ec837a":"Notice the gas generation vs. the thermal outages. Gas generation starts dropping off at exactly the same time as the thermal outages are reported. Obviously, the drop in generation is due to outages, likely relating to lack of winterization.","5ea69fa2":"Here's ERCOT's outages over the past month. Notice a few things:\n\n1.   We had about 15 GW of (what I assume were) planned outages already. That's not unusual, that's standard maintenance. I believe the bulk of maintenance outages are done in the spring and fall, but it isn't unusual to have some in the winter.\n2.   There were two big unplanned\/forced outage events. One was on February 9, when around 15 GW of renewable capacity went offline. The second was on February 15, when another 20 GW or so went offline (proportionally from renewables and thermal).\n\nERCOT only provides outage data for aggregated Intermittent and Non-Intermittent power (basically, renewables vs. thermal), but it's reasonable to assume that most of the renewable outages were wind (there isn't much solar capacity).\n\n","ddfc4a0b":"And of course the same story for wind. It's generation dropped at precisely the same time as and almost perfectly in step with the renewable outages:","fe919620":"# Wind Energy and Texas Outages\nOne of my favorite things things about the past week or so is watching the WSJ newsroom argue with the WSJ editorial board about the role of wind in the recent generation crisis in Texas. Both sides are making arguments that make a lot of sense in isolation, but the problem is pulling together the disaparate factoids about wind and gas into a single, coherent narrative.\n\nIt's the weekend and the power is back on, so I decided to do a quick data exploration of ERCOT's actual generation over the past few weeks to see if we could answer the question, \"Was wind to blame?\". Luckily, the EIA keeps up-to-the-minute data (ERCOT releases it on monthly intervals).\n\nThe answer, for reasons explained below, is \"Not really, but that's not exactly to wind's credit.\"\n\nA little bit about me: I was an electric utilies lawyer (though it's been a few years) and I am a data scientist (though not a very good one), so there's some expertise on display here but mostly just mashing data together into charts and trying to interpret them.\n\nI included my code so people could check my work (I didn't bother to make it pretty let alone comply with PEP-8, it's for reproducibility not for reference. I tried to front-load it so you can just scroll past it and focus on the graphs and commentary.","0c37e3d5":"Let's take a look at ERCOT's real-time generation data since January for all sources.","4a9daa75":"This point (that wind energy's unreliability is not to blame) becomes even stronger when we compare the EIA's generation data to ERCOT's outage data.","3656b272":"Same story for coal:","c43cc835":"Dame story for nuclear:","071da108":"It might be tempting to say that this strong correlation means wind energy is more susceptible to cold than other power sources. That might actually be correct, except for one thing: all forms of energy generation can be winterized, including wind.\n\nSo rather than pinning the \"blame\" on wind qua wind, it might be better to better to pin the \"blame\" on winterization (across all power sources).","bc4ea0eb":"Notice a few things:\n\n\n1.   Demand really started spiking around February 9 to meet load. 60+ GW is a lot for any season, but especially winter.\n2.   Around February 9, a very sizable chunk of wind power dropped off the grid.\n3.   Around February 15, a very sizable chunk of all power sources dropped off the grid.\n\nOf the February 15 outages, it looks like it was evenly split throughout generation sources. It looks like almost all generation failed in equal measure, which is even clearer if we look at the relative energy mix. The relative share of each power source (except wind) stays constant:","b9edf198":"So pulling all of that together, here's the summary:\n\n1.   Yes, we lost a lot of wind generation\n2.   Yes, wind is very unreliable.\n3.   Strangely, those two facts are not correlated here.\n4.   Wind generation fell because of the same generation outages that affected every major power source roughly in proportion to their output.\n5.   \"Luckily\" wind is so unreliable that no one counts on it.\n6.   Ergo the wind outages weren't to \"blame\"\n\nBasically, \"Wind energy didn't perform very well, but no one expected it to, so no harm, no foul.\" This argument is valid and sound, as far as it goes, but not a particularly strong defense of wind. However, it does mean that we need to look further than \"renewables\" to properly explain last week's outages.\n\n\n","5fa2c8af":"Instead, wind power is probably better thought of as a gas-wind pairing.\n\nTo explain: Intermittent generation and AC voltages go together like oil and vinegar. The entire electric grid operates on the principle of very precisely calibrated stability. The electrons-in must equal the electrons-out pretty much all the time, so that the AC keeps oscilating at 60 hz, plus or minus basically nothing. Any sudden surges or drops and everything collapses. But wind is extremely intermittent, so in order to maintain a stable electric grid, we need to have on-demand generation ready to stabilize the grid when the wind stops blowing.\n\nEnter natural gas: for various technical reasons, it is much easier\/more economical to use natural gas plants to supply power on very short notice. These \"peaking\" units stabilize the intermittent generation from wind power. You can see this by looking at the combined generation from wind and gas during normal operations.\n\nCombined, they make up about 25 GW of generation, but at any given moment one or the other is doing most of the work:","9ada526a":"Basically, wind is a \"nice to have\" not a \"must have.\" If all the wind drops off the grid (as it does pretty frequently), its complementary gas generation just steps up to pick up the slack.\n\nSo rather than even thinking about wind generation as a stand-alone resource, from a reliabilty standpoint it's better to think of wind-gas... a combined energy source that produces clean, cheap wind energy when possible but otherwise produces gas energy.\n\nThe only real question is what percentage of the total wind-gas generation is being generated by wind:","778df316":"This is a pretty strong correlation (stronger than any other correlation besides nuclear):","7d155b60":"Notice the negative correlation:","3fd9339b":"As an aside, it doesn't look like gas did too badly here. Yes, there are reports of gas infrastructure freezing and gas shortages (prices were sky-high, strongly bolstering the shortages theory), and yes gas did lose a lot in absolute terms because it was shouldering most of the load, but gas _as a share of generation_ stayed flat throughout the whole crisis. So I don't think it's fair to pin this primarily on the gas infrastructure."}}