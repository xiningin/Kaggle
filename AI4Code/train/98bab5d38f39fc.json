{"cell_type":{"33de08db":"code","4597bd42":"code","3524e7b9":"code","7b08ae4d":"code","6e25b3dd":"code","fd815a10":"code","8e8a8ae4":"code","157fb2fb":"code","1840dce6":"code","52a527e4":"code","c4e9898b":"code","aafccfdf":"code","b0278aea":"code","3b87e62c":"code","b0686c5c":"code","24539c6c":"code","2831a4e8":"code","ba80a2b8":"code","0e3e4114":"code","af1b2334":"code","74d41d79":"code","246cbbae":"code","47ed3372":"code","16f43a0d":"code","8cd795da":"code","c50cc515":"code","830df583":"code","ced6a37b":"code","ab599857":"code","89302450":"code","5191b84a":"code","5d0af40a":"code","193a8905":"code","0a5e133e":"code","f650c0ad":"code","cc9bf7b4":"code","40a8d779":"code","0bac98f7":"code","a1eaa1f8":"code","3324126a":"markdown","0f90919e":"markdown","08a37bbc":"markdown","77f8dd26":"markdown","db0c32ea":"markdown","7b778264":"markdown","2241df43":"markdown","53014a84":"markdown","74ff86ac":"markdown"},"source":{"33de08db":"import pandas as pd\nimport numpy as np\nfrom sklearn.cluster import KMeans\nimport matplotlib.pyplot as plt\nfrom sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import r2_score,mean_squared_error,mean_absolute_error\n\n%matplotlib inline","4597bd42":"df = pd.read_csv(\"\/kaggle\/input\/california-housing-prices\/housing.csv\")","3524e7b9":"df.head()","7b08ae4d":"df['median_house_value'].hist(bins=40)","6e25b3dd":"df.shape","fd815a10":"ax = df.hist(figsize=[20, 18], bins = 50)","8e8a8ae4":"ax = pd.plotting.scatter_matrix(df, alpha=0.2, figsize = [20, 20])","157fb2fb":"df['peopleperrooms'] = df['households']\/df['total_rooms']","1840dce6":"df['latlon'] = df['longitude'] * df['latitude']","52a527e4":"df['roomsperbedrooms'] = df['total_rooms']\/df['total_bedrooms']","c4e9898b":"df['peopleperbedrooms'] = df['households']\/df['total_bedrooms']","aafccfdf":"df['ageperpop'] = df['housing_median_age']\/df['households']","b0278aea":"df['ageperbeds'] = df['housing_median_age']\/df['total_bedrooms']","3b87e62c":"list(df.columns.values)","b0686c5c":"df.head()","24539c6c":"ax = pd.plotting.scatter_matrix(df[['median_house_value', \n                                    'peopleperrooms', \n                                    'latlon', \n                                    'roomsperbedrooms',\n                                    'peopleperbedrooms',\n                                    'ageperpop',\n                                    'ageperbeds']], figsize = [32, 28])","2831a4e8":"df[df.isnull().any(axis=1)]","ba80a2b8":"df = df[~df.isnull().any(axis=1)]","0e3e4114":"plt.scatter(df['longitude'], df['latitude'], marker = \".\")","af1b2334":"X = df[['longitude','latitude']]\nmeans = KMeans(n_clusters=60, random_state=0).fit(X)","74d41d79":"means.cluster_centers_[0:5]","246cbbae":"fig, ax = plt.subplots(figsize=(10, 8))\nax.scatter(df['longitude'], df['latitude'], marker = \".\")\ncentroids = means.cluster_centers_\n\nax.scatter(centroids[:, 0], centroids[:, 1], color = \"black\", marker = \",\")","47ed3372":"df['geo_cluster'] = means.predict(X)","16f43a0d":"df.groupby(\"geo_cluster\")['median_house_value'].mean().head()","8cd795da":"df.groupby(\"geo_cluster\")['median_house_value'].mean().sort_values().head()","c50cc515":"index = df.groupby(\"geo_cluster\")['median_house_value'].mean().sort_values().index\nnew_index = range(0, 60)\ndict_index = dict(zip(index, new_index))\ndict_index","830df583":"df['geo_cluster_ordered'] = df['geo_cluster'].apply(lambda x: dict_index[x])","ced6a37b":"df.head()","ab599857":"df.groupby('ocean_proximity')['median_house_value'].mean()","89302450":"values = df.groupby('ocean_proximity')['median_house_value'].mean()\nnew_values = dict(zip(values.index, values.values))\nnew_values","5191b84a":"df['n_ocean_proximity'] = df['ocean_proximity'].apply(lambda x: new_values[x])","5d0af40a":"ax = pd.plotting.scatter_matrix(df[['median_house_value', 'n_ocean_proximity', 'geo_cluster_ordered']], alpha=0.8, figsize = [40, 36])","193a8905":"X = df.drop(columns=['median_house_value', 'ocean_proximity', 'latlon', 'geo_cluster'])\ny = df['median_house_value']","0a5e133e":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)","f650c0ad":"model = GradientBoostingRegressor().fit(X_train, y_train)","cc9bf7b4":"y_pred = model.predict(X_test)","40a8d779":"print(np.sqrt(mean_squared_error(y_test,y_pred)))","0bac98f7":"r2_score(y_test, y_pred)","a1eaa1f8":"mean_absolute_error(y_test, y_pred)","3324126a":"# Create clustering for lat and long","0f90919e":"# Split Dataset Into Training and Test","08a37bbc":"# Basic Data Exploration","77f8dd26":"# Transform ocean_proximity into a numerical feature","db0c32ea":"# Prediction","7b778264":"# Creating New Features ","2241df43":"## Remove null data","53014a84":"# Results","74ff86ac":"- Let's order the clusters centers by housing value and use this as a feature."}}