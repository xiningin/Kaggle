{"cell_type":{"ed3654fa":"code","ae6d0912":"code","26dd1c2b":"code","c104a4cb":"code","3f64b8a3":"code","82988274":"code","b6254b33":"code","0220cc9b":"code","6fb6e8bb":"code","d8f9c6d3":"code","0e993f1a":"code","e14b3aac":"code","c4f143df":"code","07b7d6cc":"code","a078b47c":"code","7d2c9864":"code","ceae0fb8":"code","aee61cf7":"code","405d2515":"code","738d730e":"code","3e853982":"code","9d6d034e":"code","17c86f88":"code","cedaafa1":"code","670a09ed":"code","58fa0415":"code","67c93285":"code","a0274e29":"code","5fc8d9f3":"markdown","a5341eae":"markdown","7209ef27":"markdown","43c49449":"markdown"},"source":{"ed3654fa":"import numpy as np\nimport pandas as pd","ae6d0912":"from pathlib import Path\n\npath = Path('..\/input\/covid-19-nlp-text-classification\/')\n\ntrain = pd.read_csv(path \/ 'Corona_NLP_train.csv', encoding = 'latin1')\ntest = pd.read_csv(path \/ 'Corona_NLP_test.csv', encoding = 'latin1')","26dd1c2b":"train.head()","c104a4cb":"train['Sentiment'].value_counts()","3f64b8a3":"import matplotlib.pyplot as plt\nimport seaborn as sns","82988274":"sns.set_style('darkgrid')\nplt.figure(figsize = (8, 8))\nsns.countplot(x = train['Sentiment'] , palette = 'viridis')\nplt.show()","b6254b33":"train.head()","0220cc9b":"train = train.drop(columns = ['UserName', 'ScreenName', 'Location', 'TweetAt'])","6fb6e8bb":"train.reset_index(drop=True, inplace=True)\ntrain.head()","d8f9c6d3":"from fastai.text.all import *","0e993f1a":"dls = TextDataLoaders.from_df(train, valid_pct = 0.1, text_col = 'OriginalTweet', label_col = 'Sentiment', bs = 64, is_lm = True)","e14b3aac":"dls.show_batch()","c4f143df":"learn = language_model_learner(dls, AWD_LSTM, drop_mult = 0.3)","07b7d6cc":"learn.lr_find()","a078b47c":"learn.fit_one_cycle(1, lr_max = slice(1e-2, 1e-1))","7d2c9864":"learn.save('fine_tuned')\nlearn.save_encoder('fine_tuned_enc')","ceae0fb8":"TEXT = \"This pandemic is destroying our lives\"\nN_WORDS = 40\nN_SENTENCES = 2\npreds = [learn.predict(TEXT, N_WORDS, temperature=0.75) \n         for _ in range(N_SENTENCES)]","aee61cf7":"print(\"\\n\".join(preds))","405d2515":"data_class = TextDataLoaders.from_df(train, valid_pct = 0.1, text_col = 'OriginalTweet', label_col = 'Sentiment', bs = 64, text_vocab = dls.vocab)","738d730e":"data_class.show_batch()","3e853982":"learn = text_classifier_learner(data_class, AWD_LSTM, drop_mult=0.5, metrics=[accuracy])\nlearn.load_encoder('fine_tuned_enc')","9d6d034e":"learn.lr_find()","17c86f88":"learn.fit_one_cycle(5, 1e-3)","cedaafa1":"learn.unfreeze()\nlearn.fit_one_cycle(5)","670a09ed":"interp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_top_losses(k = 5)","58fa0415":"interp.plot_confusion_matrix()","67c93285":"learn.predict(\"This pandemic is destroying our lives\")","a0274e29":"learn.predict(\"Let us all be hopeful for a new tomorrow!\")","5fc8d9f3":"### Classifying Covid tweets using the FastAI library and Universal Language Model Fine-tuning for Text Classification (ULMFiT)","a5341eae":"#### Please give an upvote if you like this simple kernel.","7209ef27":"Please Give an upvote if you like this notebook.\n\nKeep learning, keep sharing!","43c49449":"The last year has been rough but as Helen Keller says \"Keep your face to the sunshine and you shall never see a shadow\", we should all be hopeful for the new dawn. \n![](https:\/\/www.finsyn.com\/wp-content\/uploads\/2020\/03\/It%E2%80%99s-Always-Darkest-Before-the-Dawn-845x325.jpg)"}}