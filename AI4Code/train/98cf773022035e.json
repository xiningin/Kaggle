{"cell_type":{"8b7b42bc":"code","af93e9fa":"code","11cad898":"code","44b57690":"code","5c1ddb5c":"code","f2d495ee":"code","da944a9a":"code","4668004a":"code","ae7d4d8d":"code","c5f5bde5":"code","3c46bf35":"code","c2738e90":"code","6376e0d9":"code","dfac22ee":"code","019a2cc2":"code","a2cdd77e":"code","687ab038":"code","fc78ce1b":"code","4fc64d40":"code","bcfae59c":"code","55be25d3":"markdown","301df49a":"markdown","10f2ec3d":"markdown","8762d3c8":"markdown","21c6ea42":"markdown","72982cf8":"markdown","16b7b8e0":"markdown","013be41b":"markdown","9a60be18":"markdown","b5f210ba":"markdown","cd928b5b":"markdown","c5f6e50d":"markdown","ad3aea9b":"markdown"},"source":{"8b7b42bc":"## import Libraries\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","af93e9fa":"df=pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","11cad898":"df.head()","44b57690":"df.shape","5c1ddb5c":"# Remove customer ID\n\ndf.drop('CustomerID', axis=1, inplace=True)","f2d495ee":"df.head()","da944a9a":"df.isnull().sum().sort_values(ascending=False)","4668004a":"# encode Female as 1 and male 0\n\ndf['Gender'] = np.where(df['Gender']=='Male',0,1)","ae7d4d8d":"df.head()","c5f5bde5":"from sklearn.cluster import KMeans\nwcss = []\nfor i in range(1, 15):\n    kmeans = KMeans(n_clusters = i, init = 'k-means++', random_state = 42)\n    kmeans.fit(df)\n    wcss.append(kmeans.inertia_)\nplt.plot(range(1, 15), wcss)\nplt.title('The Elbow Method')\nplt.xlabel('n: Number of clusters')\nplt.ylabel('WCSS')\nplt.show()","3c46bf35":"clstr = KMeans(n_clusters = 6, init = 'k-means++', random_state = 42)","c2738e90":"y_kmeans = clstr.fit_predict(df)\n\nprint(y_kmeans)","6376e0d9":"df['group']=y_kmeans","dfac22ee":"df.head()","019a2cc2":"plt.figure(figsize=(10,6))\n\nplt.scatter(x=df[df['group']==0]['Annual Income (k$)'],y=df[df['group']==0]['Spending Score (1-100)'], s=100, color='blue', label='C1')\nplt.scatter(x=df[df['group']==1]['Annual Income (k$)'],y=df[df['group']==1]['Spending Score (1-100)'],  s=100,color='green', label='C2')\nplt.scatter(x=df[df['group']==2]['Annual Income (k$)'],y=df[df['group']==2]['Spending Score (1-100)'],  s=100, color='red', label='C3')\nplt.scatter(x=df[df['group']==3]['Annual Income (k$)'],y=df[df['group']==3]['Spending Score (1-100)'],  s=100,color='cyan', label='C4')\nplt.scatter(x=df[df['group']==4]['Annual Income (k$)'],y=df[df['group']==4]['Spending Score (1-100)'],  s=100,color='yellow', label='C5')\nplt.scatter(x=df[df['group']==5]['Annual Income (k$)'],y=df[df['group']==5]['Spending Score (1-100)'], s=100, color='orange', label='C6')\n\n\n\n# Decorate\n\nplt.title('Cluster of customer')\nplt.xlabel('Annual Income (k$)')\nplt.ylabel('Spending Score (1-100)')\nplt.legend(loc='upper left');\nplt.show()","a2cdd77e":"clstr = KMeans(n_clusters = 5, init = 'k-means++', random_state = 42)","687ab038":"y_kmeans = clstr.fit_predict(df)\n\nprint(y_kmeans)","fc78ce1b":"df['group']=y_kmeans","4fc64d40":"df.head()","bcfae59c":"plt.figure(figsize=(10,6))\n\nplt.scatter(x=df[df['group']==0]['Annual Income (k$)'],y=df[df['group']==0]['Spending Score (1-100)'], s=100, color='blue', label='C1')\nplt.scatter(x=df[df['group']==1]['Annual Income (k$)'],y=df[df['group']==1]['Spending Score (1-100)'],  s=100,color='green', label='C2')\nplt.scatter(x=df[df['group']==2]['Annual Income (k$)'],y=df[df['group']==2]['Spending Score (1-100)'],  s=100, color='red', label='C3')\nplt.scatter(x=df[df['group']==3]['Annual Income (k$)'],y=df[df['group']==3]['Spending Score (1-100)'],  s=100,color='cyan', label='C4')\nplt.scatter(x=df[df['group']==4]['Annual Income (k$)'],y=df[df['group']==4]['Spending Score (1-100)'],  s=100,color='yellow', label='C5')\n\n\n# Decorate\n\nplt.title('Cluster of customer')\nplt.xlabel('Annual Income (k$)')\nplt.ylabel('Spending Score (1-100)')\nplt.legend(loc='upper left');\nplt.show()","55be25d3":"# THE END....!","301df49a":"#### Customer Id is just like primary key for each customer and can be removed","10f2ec3d":"#### So, The total number of cluster is 5","8762d3c8":"#### Change the categorical variable to numeric.","21c6ea42":"## Take n_clusters = 5","72982cf8":"#### Read the dataset","16b7b8e0":"#### It's a very small dataset ","013be41b":"### From above scatter plot we can observe that C2 and C5 are getting overlap.","9a60be18":"#### Look for missing values","b5f210ba":"## This Looks Good","cd928b5b":"## Take n_clusters = 6 ","c5f6e50d":"#### From above graph, we can observe before n=5,6 slope is decreasing sharply and after n=5,6 slope is decreasing slowly. So, we can conclude that number of cluster can be 5 or 6.","ad3aea9b":"### Now let's use elbow method to find suitable number of cluster"}}