{"cell_type":{"a3952e40":"code","435a6dac":"code","ec2e1308":"code","a9673f21":"code","fcb7e9a8":"code","1432e8c0":"code","f7de9538":"code","365ecc68":"code","f1e14c63":"code","5c28db89":"code","98863dc9":"code","7ec06063":"code","49dbf81c":"code","8d9b7a48":"code","19d3fe9b":"code","ea9c6651":"code","5874c860":"markdown","1bb70e42":"markdown","fae9b0f2":"markdown","f43563c1":"markdown","6da8ca6a":"markdown","ca6199cf":"markdown","4ff8a3cb":"markdown","683981a6":"markdown","5c32f34e":"markdown","19c7f51e":"markdown","e5eef95c":"markdown","15f8144a":"markdown"},"source":{"a3952e40":"import numpy as np\nimport pandas as pd\npd.set_option('display.max_columns', None)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style('darkgrid')\nimport plotly.express as px\nimport warnings\nwarnings.filterwarnings('ignore')","435a6dac":"data = pd.read_csv('https:\/\/drive.google.com\/uc?id=1T4ak0Nyvt-mrpZPCgAo0aVq4b6LrfCA1')\ndata.head(1)","ec2e1308":"data.isnull().sum().sum()","a9673f21":"plt.figure(figsize=(15,6))\nsns.heatmap(data.isnull(), cmap='cool')\nplt.show()","fcb7e9a8":"print(f'Initial Null Values - {data.isnull().sum().sum()}')\nfor i in data.columns:\n    if data[i].isnull().sum() > 20:\n        data.drop(i, axis=1, inplace=True)\nprint(f'Final Null Values - {data.isnull().sum().sum()}')","1432e8c0":"print(data.shape)\ndata.dropna(inplace=True)\ndata.shape","f7de9538":"data.rename(columns = {'Unnamed: 0':'Id', 'q0001':'Masculinity'}, inplace=True)","365ecc68":"for i in data.columns:\n    if (data[i] == 'Not selected').sum() > 400:\n        data.drop(i, axis=1, inplace=True)\ndata.shape","f1e14c63":"X = data.drop(['Id', 'Masculinity'], axis=1)","5c28db89":"from sklearn.preprocessing import MinMaxScaler, LabelEncoder\nlabel = LabelEncoder()\nfor i in X.columns:\n    X[i] = label.fit_transform(X[i])\nX.head(2)","98863dc9":"scaler = MinMaxScaler()\nfor i in X.columns:\n    X[i] = scaler.fit_transform(X[[i]])\nX.head(2)","7ec06063":"from sklearn.decomposition import PCA\npca = PCA(2)\nX = pca.fit_transform(X)","49dbf81c":"from sklearn.cluster import KMeans\n\nl  = []\nfor i in range(1,10):\n    model = KMeans(n_clusters=i, random_state = 42)\n    model.fit(X)\n    l.append(model.inertia_)","8d9b7a48":"plt.figure(figsize=(10,5))\nplt.plot(range(1, 10), l)\nplt.show()","19d3fe9b":"model = KMeans(n_clusters=3, random_state=42)\n\ny = model.fit_predict(X)","ea9c6651":"plt.figure(figsize=(15,8))\nplt.scatter(X[y == 0, 0], X[y == 0, 1], s = 100, c = 'red', marker='+', label = 'Somewhat masculine')\nplt.scatter(X[y == 1, 0], X[y == 1, 1], s = 100, c = 'blue', marker='+', label = 'Very masculine')\nplt.scatter(X[y == 2, 0], X[y == 2, 1], s = 100, c = 'green', marker='+', label = 'Not at all masculine')\nplt.scatter(model.cluster_centers_[:,0],model.cluster_centers_[:,1], s = 100, color='black', label='centroid')\nplt.legend()\nplt.show()","5874c860":"## Loading Dataset","1bb70e42":"![](https:\/\/miro.medium.com\/max\/809\/0*tamvSiqDneDfw2Vr)","fae9b0f2":"## Model Training","f43563c1":"## Data Cleaning","6da8ca6a":"## Visualizing Output","ca6199cf":"## Removing Unnecessary Columns ","4ff8a3cb":"## Selecting correct number of Clusters using Elbow Method","683981a6":"### We'll select 3 as the number of clusters","5c32f34e":"## Feature Scaling","19c7f51e":"## Importing Libraries","e5eef95c":"## Removing Null Values","15f8144a":"## Label Encoding"}}