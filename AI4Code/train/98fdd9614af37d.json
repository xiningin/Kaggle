{"cell_type":{"c6a7b654":"code","860d0485":"code","47d16e5f":"code","907e30fe":"code","1ac92124":"code","72455d97":"code","f1fdc302":"code","ae8ab600":"code","06570afd":"code","16ab34bb":"code","5df65375":"code","88a52601":"code","530b6ea5":"code","defdaeec":"code","0b7bf49f":"code","e72e637a":"code","01b317bc":"code","54bb3890":"code","d521c8a9":"code","a9f08c29":"code","6e782e1a":"code","f1a3bfdf":"code","0bccb11a":"code","0174de72":"code","28c7baab":"code","918ef4c4":"code","f9706041":"code","10b39d57":"code","c01ce53f":"code","3cbaeb8a":"code","f0922a85":"code","2342219f":"code","fae993e1":"code","9b337e94":"code","133fcc49":"code","a007f0de":"code","a8ab3ee8":"code","47dc4100":"code","cbc59019":"code","5c67017e":"code","b979afb3":"code","f2ee2d2b":"code","3d4af6de":"code","7ab0dd05":"code","7096b874":"code","b53e0212":"code","285d0bc2":"code","ec62a1ca":"code","7d2a84e3":"code","2d53d4e4":"code","7a0ae4ac":"code","8c078b6f":"code","ba8d2ab0":"code","5ddd9544":"code","8550c7d1":"code","5d0e48fa":"code","b4508655":"code","1da85754":"code","335ee7ff":"code","86feea2a":"code","943cc640":"code","4688de14":"code","7705af7c":"code","e069d022":"code","8dc8d42e":"code","e7882e89":"code","f82e36d9":"code","22f5650a":"code","c8f3df92":"code","500db798":"code","2b49abf6":"code","3dc238dc":"markdown","b299beb3":"markdown","f7410253":"markdown","c3948018":"markdown","c11584bb":"markdown","607f93ee":"markdown","bf53b064":"markdown","49602455":"markdown","63cdd662":"markdown","1bdc4b17":"markdown","46e38e26":"markdown","94f69cde":"markdown","e87f8862":"markdown","fea27139":"markdown","9261c54e":"markdown","acc8b02e":"markdown","da416595":"markdown"},"source":{"c6a7b654":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","860d0485":"df=pd.read_csv(\"\/kaggle\/input\/us-accidents\/US_Accidents_Dec20_Updated.csv\")","47d16e5f":"df.columns","907e30fe":"df.info()","1ac92124":"df.describe()","72455d97":"df.head(3)","f1fdc302":"len(df.columns)","ae8ab600":"percentage_of_missing_values=df.isna().sum()\/len(df)*100\npercentage_of_missing_values[percentage_of_missing_values!=0].plot(kind=\"bar\")","06570afd":"df.columns","16ab34bb":"df.head()","5df65375":"df[\"Temperature(F)\"]=df[\"Temperature(F)\"].fillna(df[\"Temperature(F)\"].median())\ndf[\"Humidity(%)\"]=df[\"Humidity(%)\"].fillna(df[\"Humidity(%)\"].median())\ndf[\"Visibility(mi)\"]=df[\"Visibility(mi)\"].fillna(df[\"Visibility(mi)\"].median())\n","88a52601":"df.dropna(subset=[\"City\"],inplace=True)","530b6ea5":"df[\"Weather_Condition\"]=df[\"Weather_Condition\"].fillna(df[\"Weather_Condition\"].mode()[0])","defdaeec":"df.isna().sum()\n","0b7bf49f":"df.head(3)","e72e637a":"import seaborn as sns\nimport matplotlib.pyplot as plt","01b317bc":"plt.figure(figsize=(20,7))\nsns.countplot(x=\"State\",data=df)\nplt.yscale(\"log\")\nplt.title(\"STATES WITH NUMBER OF ACCIDENTS\",fontsize=20)\nplt.show()","54bb3890":"top_cities=df[\"City\"].value_counts().sort_values()[-20:].reset_index()\ntop_cities.columns=[\"city\",\"number_of_accidents\"]\n","d521c8a9":"plt.figure(figsize=(10,7))\nsns.barplot(x=\"city\",y=\"number_of_accidents\",data=top_cities)\nplt.title(\"TOP 10 CITIES WITH HIGHEST NUMBER OF ACCIDENTS\",fontsize=20)\nplt.xticks(rotation=40)\nplt.show()","a9f08c29":"top_streets=df[\"Street\"].value_counts().sort_values()[-20:].reset_index()\ntop_streets.columns=[\"street_name\",\"number_of_accidents\"]","6e782e1a":"plt.figure(figsize=(10,6))\nsns.barplot(x=top_streets[\"street_name\"],y=top_streets[\"number_of_accidents\"])\nplt.xticks(rotation=90)\nplt.title(\"TOP 20 STREETS WITH MAXIMUM NUMBER OF ACCIDENTS \",fontsize=20)\nplt.show()\n","f1a3bfdf":"df[\"Severity\"].value_counts()","0bccb11a":"plt.figure(figsize=(10,6))\nsns.countplot(x=\"Severity\",data=df)\nplt.yscale(\"log\")\nplt.title(\"COUNT OF SEVERITY\",fontsize=20)\nplt.show()","0174de72":"df.columns","28c7baab":"df[\"year\"]=pd.DatetimeIndex(df[\"Start_Time\"]).year","918ef4c4":"df[\"month\"]=pd.DatetimeIndex(df[\"Start_Time\"]).month","f9706041":"df[\"dayofweek\"]=pd.DatetimeIndex(df[\"Start_Time\"]).dayofweek","10b39d57":"df[\"day\"]=pd.DatetimeIndex(df[\"Start_Time\"]).day","c01ce53f":"yearly_accidents=df[\"year\"].value_counts().reset_index()\nyearly_accidents.columns=[\"year\",\"accidents\"]","3cbaeb8a":"import plotly.express as px","f0922a85":"px.bar(x=yearly_accidents[\"year\"],y=yearly_accidents[\"accidents\"])","2342219f":"df[\"month\"].unique()","fae993e1":"df[\"month\"]=df[\"month\"].map({1:\"janurary\",\n                2:\"feburary\",\n                3:\"march\",\n                4:\"april\",\n                5:\"may\",\n                6:\"june\",\n                7:\"july\",\n                8:\"august\",\n                9:\"september\",\n                10:\"october\",\n                11:\"november\",\n                12:\"december\"})","9b337e94":"monthly_accidents=df[\"month\"].value_counts().reset_index()\nmonthly_accidents.columns=[\"month\",\"accidents\"]","133fcc49":"monthly_accidents=df[[\"month\",\"year\"]].value_counts().reset_index()\nmonthly_accidents.columns=[\"month\",\"year\",\"number_of_accidents\"]","a007f0de":"plt.figure(figsize=(15,8))\nsns.barplot(x=\"month\",y=\"number_of_accidents\",hue=\"year\",data=monthly_accidents)","a8ab3ee8":"df[\"day\"].unique()","47dc4100":"weekly_accidents=df[[\"dayofweek\",\"year\"]].value_counts().reset_index()\nweekly_accidents.columns=[\"day_of_the_week\",\"year\",\"number_of_accidents\"]\n","cbc59019":"df[\"dayofweek\"].unique()","5c67017e":"df[\"dayofweek\"]=df[\"dayofweek\"].map({0:\"sunday\",\n                                         1:\"monday\",\n                                         2:\"tuesday\",\n                                        3:\"wednesday\",\n                                        4:\"thursday\",\n                                        5:\"friday\",\n                                        6:\"saturday\"})","b979afb3":"\nplt.figure(figsize=(10,6))\nsns.barplot(x=\"day_of_the_week\",y=\"number_of_accidents\",hue=\"year\",data=weekly_accidents)","f2ee2d2b":"df.columns","3d4af6de":"df[\"Severity\"]","7ab0dd05":"\n\n\n\n\n\n\ndf[[\"Severity\",\"year\"]]","7096b874":"pd.crosstab(df[\"year\"],df[\"Severity\"]).plot(kind=\"bar\")\n","b53e0212":"df.columns","285d0bc2":"range_temp = pd.cut(df['Temperature(F)'], 5)\nrange_temp.unique()","ec62a1ca":"df[\"Temperature(F)\"].value_counts()","7d2a84e3":"df.loc[ (df['Temperature(F)'] <= 10), 'Temperature(F)']=1\ndf.loc[ (df['Temperature(F)'] > 10) & (df['Temperature(F)'] <= 50), 'Temperature(F)']=2\ndf.loc[ (df['Temperature(F)'] > 50) & (df['Temperature(F)'] <= 90), 'Temperature(F)']=3\ndf.loc[ (df['Temperature(F)'] > 90) & (df['Temperature(F)'] <= 130),'Temperature(F)' ]=4\ndf.loc[  df['Temperature(F)'] > 130, 'Temperature(F)']=5","2d53d4e4":"weather_dist = df['Temperature(F)'].value_counts().reset_index()\nweather_dist.columns=[\"range_temp\",\"number_of_accidents\"]\nweather_dist","7a0ae4ac":"weather_dist.range_temp=weather_dist.range_temp.map({1.0:\"below 10 degree F\",\n                            2.0:\"from 10 to 50 degree F\",\n                            3.0:\"from 50 to 90 degree F\",\n                            4.0:\"from 90 to 130 degree F\",\n                             5.0:\"above 130 degree F\"})","8c078b6f":"\npx.bar(x=weather_dist[\"range_temp\"],y=weather_dist[\"number_of_accidents\"])\n","ba8d2ab0":"df.columns","5ddd9544":"df.loc[(df[\"Humidity(%)\"]<=20),\"Humidity(%)\"]=1\ndf.loc[(df[\"Humidity(%)\"]>20) & (df[\"Humidity(%)\"]<=40),\"Humidity(%)\"]=2\ndf.loc[(df[\"Humidity(%)\"]>40) & (df[\"Humidity(%)\"]<=60),\"Humidity(%)\"]=3\ndf.loc[(df[\"Humidity(%)\"]>60) & (df[\"Humidity(%)\"]<=80),\"Humidity(%)\"]=4\ndf.loc[(df[\"Humidity(%)\"]>80) & (df[\"Humidity(%)\"]<=100),\"Humidity(%)\"]=5\ndf.loc[(df[\"Humidity(%)\"]>100),\"Humidity(%)\"]=6\n\n","8550c7d1":"df[\"Humidity(%)\"].unique()","5d0e48fa":"ax=sns.countplot(df[\"Humidity(%)\"])\nfor i in ax.patches:\n    count = '{:,.1f}'.format(i.get_height())\n    x = i.get_x()+i.get_width()-0.60\n    y = i.get_height()+10000\n    ax.annotate(count, (x, y))\nplt.show()","b4508655":"len(df[\"Weather_Condition\"].unique())","1da85754":"df[\"Weather_Condition\"].value_counts()","335ee7ff":"df[[\"Weather_Condition\",\"Severity\"]].value_counts().sort_values()[-10:]","86feea2a":"np.arange(1,5)","943cc640":"for x in range(1,5):\n    plt.subplots(figsize=(10,6))\n    df.loc[df[\"Severity\"] == x]['Weather_Condition'].value_counts().sort_values()[-10:].plot(kind=\"bar\")","4688de14":"for x in np.arange(1,5):\n    plt.subplots(figsize=(12,5))\n    df.loc[df[\"Severity\"] == x]['Weather_Condition'].value_counts().sort_values(ascending=False).head(20).plot.bar(width=0.5,color='y',edgecolor='k',align='center',linewidth=1)\n    plt.xlabel('Weather Condition',fontsize=16)\n    plt.ylabel('Accident Count',fontsize=16)\n    plt.title('20 of The Main Weather Conditions for Accidents of Severity ' + str(x),fontsize=16)\n    plt.xticks(fontsize=16)\n    plt.yticks(fontsize=16)","7705af7c":"values=[\"Fog\",\"Light Rain\",\"Rain\",\"Heavy Rain\",\"Snow\"]","e069d022":"for x in [\"Fog\",\"Light Rain\",\"Rain\",\"Heavy Rain\",\"Snow\"]:\n    plt.subplots(1,2,figsize=(10,6))\n    plt.subplot(1,2,1)\n    df.loc[df[\"Weather_Condition\"]==x][\"Severity\"].value_counts().sort_values().plot(kind=\"bar\")\n    plt.suptitle(\"Severity for \"+str(x),fontsize=20)\n    plt.xlabel(\"severity\")\n    plt.ylabel(\"number_of_deaths\")\n    plt.subplot(1,2,2)\n    df.loc[df[\"Weather_Condition\"] == x]['Severity'].value_counts().plot.pie(autopct='%1.0f%%',fontsize=16)","8dc8d42e":"df.columns","e7882e89":"df[\"Start_Time\"]=pd.DatetimeIndex(df[\"Start_Time\"])","f82e36d9":"df.End_Time=pd.DatetimeIndex(df.End_Time)","22f5650a":"df['Duration'] = df.End_Time - df.Start_Time ","c8f3df92":"df['Duration']","500db798":"df['Duration'] = df['Duration'].apply(lambda x:round(x.total_seconds() \/ 60) )\nprint(\"The overall mean duration is: \", (round(df['Duration'].mean(),3)), 'min')","2b49abf6":"len(df['Duration'].unique())","3dc238dc":"## Clean the data:","b299beb3":"#### As we can see in Number column there is 60% of the missing values .\n#### There is also 45%  missing values in the precipitation.\n#### 40% missing value in the wind column\n#### Instead of fill the missing values it is better to remove those columns:","f7410253":"sns.set(style=\"whitegrid\")\nplt.figure(figsize=(8,5))\ntotal = float(len(train_df))\nax = sns.countplot(x=\"event\", hue=\"event\", data=train_df)\nplt.title('Data provided for each event', fontsize=20)\nfor p in ax.patches:\n    percentage = '{:.1f}%'.format(100 * p.get_height()\/total)\n    x = p.get_x() + p.get_width()\n    y = p.get_height()\n    ax.annotate(percentage, (x, y),ha='center')\nplt.show()","c3948018":"### import Libraries:","c11584bb":"#### ALso there are some columns which are of no use it is better to remove those columns:\n#### like the column country we know we are doing analysis on only one country US. so there is non use of that column:","607f93ee":"### weather:","bf53b064":"df.drop([\"Number\"],axis=1,inplace=True)\ndf.drop([\"Precipitation(in)\"],axis=1,inplace=True)\ndf.drop([\"Wind_Chill(F)\"],axis=1,inplace=True)","49602455":"#### 02. Impute the missing values of categorical column:","63cdd662":"### import data-set","1bdc4b17":"### Get the basic info. about the data-set:","46e38e26":"##### in city column we will remove the missing rows:\n","94f69cde":"#### 01. impute the missing values of numerical columns:","e87f8862":"df.drop([\"Start_Lat\"],axis=1,inplace=True)\ndf.drop([\"Start_Lng\"],axis=1,inplace=True)\ndf.drop([\"End_Lat\"],axis=1,inplace=True)\ndf.drop([\"End_Lng\"],axis=1,inplace=True)\ndf.drop([\"Airport_Code\"],axis=1,inplace=True)\ndf.drop([\"Zipcode\"],axis=1,inplace=True)\ndf.drop([\"Country\"],axis=1,inplace=True)\ndf.drop([\"Timezone\"],axis=1,inplace=True)\ndf.drop([\"Pressure(in)\"],axis=1,inplace=True)\ndf.drop([\"Wind_Direction\"],axis=1,inplace=True)\ndf.drop([\"Wind_Speed(mph)\"],axis=1,inplace=True)\ndf.drop([\"Amenity\"],axis=1,inplace=True)\ndf.drop([\"Give_Way\"],axis=1,inplace=True)\ndf.drop([\"No_Exit\"],axis=1,inplace=True)\ndf.drop([\"Roundabout\"],axis=1,inplace=True)\ndf.drop([\"Stop\"],axis=1,inplace=True)\ndf.drop([\"Traffic_Calming\"],axis=1,inplace=True)\ndf.drop([\"Turning_Loop\"],axis=1,inplace=True)\ndf.drop([\"Astronomical_Twilight\"],axis=1,inplace=True)\ndf.drop([\"Nautical_Twilight\"],axis=1,inplace=True)\ndf.drop([\"Civil_Twilight\"],axis=1,inplace=True)\ndf.drop([\"Sunrise_Sunset\"],axis=1,inplace=True)\ndf.drop([\"Weather_Timestamp\"],axis=1,inplace=True)\n","fea27139":"for s in [\"Fog\",\"Light Rain\",\"Rain\",\"Heavy Rain\",\"Snow\"]:\n    plt.subplots(1,2,figsize=(12,5))\n    plt.suptitle('Accident Severity Under ' + s,fontsize=16)\n    plt.subplot(1,2,1)\n    df.loc[df[\"Weather_Condition\"] == s]['Severity'].value_counts().plot.bar(width=0.5,color='y',edgecolor='k',align='center',linewidth=1)\n    plt.xlabel('Severity',fontsize=16)\n    plt.ylabel('Accident Count',fontsize=16)\n    plt.xticks(fontsize=16)\n    plt.yticks(fontsize=16)\n    plt.subplot(1,2,2)\n    df.loc[df[\"Weather_Condition\"] == s]['Severity'].value_counts().plot.pie(autopct='%1.0f%%',fontsize=16)","9261c54e":"#### NOW IMPUTE THE MISSING VALUES:","acc8b02e":"#### Now our data is clean :","da416595":"### LET'S DO SOME ANALYSIS:"}}