{"cell_type":{"540aa9eb":"code","002b8600":"code","b019946c":"code","162be4f8":"code","2d5ac1c9":"code","973ea8a6":"code","269eda19":"code","0573c2e1":"code","ddbd4d46":"code","ebc690c7":"code","9189c31b":"code","a5d86a6c":"code","d7f0ab37":"code","5babc1c6":"markdown","cb1bf94f":"markdown","feb780bf":"markdown","3b57185c":"markdown","d5dbbacf":"markdown","68640d4f":"markdown","d486858f":"markdown","e2ed9d1e":"markdown","a364a455":"markdown","0d635636":"markdown","9aa846dc":"markdown","9074d5c5":"markdown","114c4acb":"markdown","43ecd17d":"markdown","b69a2116":"markdown"},"source":{"540aa9eb":"import matplotlib.pyplot as plt\nimport pandas as pd\nimport pylab as pl\nimport numpy as np\n%matplotlib inline","002b8600":"df = pd.read_csv(\"..\/input\/FuelConsumptionCo2.csv\")\n\n# take a look at the dataset\ndf.head()","b019946c":"# summarize the data\ndf.describe()","162be4f8":"cdf = df[['ENGINESIZE','CYLINDERS','FUELCONSUMPTION_COMB','CO2EMISSIONS']]\ncdf.head(9)","2d5ac1c9":"viz = cdf[['CYLINDERS','ENGINESIZE','CO2EMISSIONS','FUELCONSUMPTION_COMB']]\nviz.hist()\nplt.show()","973ea8a6":"plt.scatter(cdf.FUELCONSUMPTION_COMB, cdf.CO2EMISSIONS,  color='blue')\nplt.xlabel(\"FUELCONSUMPTION_COMB\")\nplt.ylabel(\"Emission\")\nplt.show()","269eda19":"plt.scatter(cdf.ENGINESIZE, cdf.CO2EMISSIONS,  color='blue')\nplt.xlabel(\"Engine size\")\nplt.ylabel(\"Emission\")\nplt.show()","0573c2e1":"plt.scatter(cdf.CYLINDERS, cdf.CO2EMISSIONS,  color='blue')\nplt.xlabel(\"Cylinders\")\nplt.ylabel(\"Emission\")\nplt.show()","ddbd4d46":"msk = np.random.rand(len(df)) < 0.8\ntrain = cdf[msk]\ntest = cdf[~msk]","ebc690c7":"plt.scatter(train.ENGINESIZE, train.CO2EMISSIONS,  color='blue')\nplt.xlabel(\"Engine size\")\nplt.ylabel(\"Emission\")\nplt.show()","9189c31b":"from sklearn import linear_model\nregr = linear_model.LinearRegression()\ntrain_x = np.asanyarray(train[['ENGINESIZE']])\ntrain_y = np.asanyarray(train[['CO2EMISSIONS']])\nregr.fit (train_x, train_y)\n# The coefficients\nprint ('Coefficients: ', regr.coef_)\nprint ('Intercept: ',regr.intercept_)","a5d86a6c":"plt.scatter(train.ENGINESIZE, train.CO2EMISSIONS,  color='blue')\nplt.plot(train_x, regr.coef_[0][0]*train_x + regr.intercept_[0], '-r')\nplt.xlabel(\"Engine size\")\nplt.ylabel(\"Emission\")","d7f0ab37":"from sklearn.metrics import r2_score\n\ntest_x = np.asanyarray(test[['ENGINESIZE']])\ntest_y = np.asanyarray(test[['CO2EMISSIONS']])\ntest_y_ = regr.predict(test_x)\n\nprint(\"Mean absolute error: %.2f\" % np.mean(np.absolute(test_y_ - test_y)))\nprint(\"Residual sum of squares (MSE): %.2f\" % np.mean((test_y_ - test_y) ** 2))\nprint(\"R2-score: %.2f\" % r2_score(test_y_ , test_y) )","5babc1c6":"Lets first have a descriptive exploration on our data.","cb1bf94f":"**Simple Regression Model**","feb780bf":"**Creating train and test dataset**","3b57185c":"we can plot the fit line over the data:","d5dbbacf":"**Modeling**","68640d4f":"Train data distribution","d486858f":"we can plot each of these fearues:","e2ed9d1e":"Using sklearn package to model data.","a364a455":"**Evaluation**\n","0d635636":"Lets select some features to explore more.","9aa846dc":"Now, lets plot each of these features vs the Emission, to see how linear is their relation:","9074d5c5":"**DATA EXPLORATION**","114c4acb":"**Plot outputs**","43ecd17d":"**Reading the data in**","b69a2116":"we compare the actual values and predicted values to calculate the accuracy of a regression model. Evaluation metrics provide a key role in the development of a model,\n\nThere are different model evaluation metrics, lets use MSE here to calculate the accuracy of our model based on the test set:\n- Mean absolute error: \n- Mean Squared Error (MSE): \n- Root Mean Squared Error (RMSE).\n- R-squared."}}