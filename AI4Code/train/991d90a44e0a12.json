{"cell_type":{"af299739":"code","623ac756":"code","ac6d3dc7":"code","1994d3c4":"code","a8efa270":"code","b33f1029":"code","6bd864fb":"code","db5ad49a":"code","8b985be1":"code","42012889":"code","fa0cede9":"code","66a28446":"code","27c91d82":"code","e79862bd":"code","3adade76":"code","fc41da2f":"code","8f8fac43":"code","c4027090":"code","5a3fed58":"code","3fe1c931":"code","afcce8c0":"code","3496dc28":"code","e0e9b62a":"code","3b01145a":"markdown","c3dafc22":"markdown","f196b6a9":"markdown","1c2723e8":"markdown","06609db2":"markdown"},"source":{"af299739":"#import library\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nplt.style.use('seaborn')\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn import metrics","623ac756":"df = pd.read_csv('..\/input\/assembly-election-results-kerala-2021\/Assemby Constituency_Kerala_2021.csv')","ac6d3dc7":"df.shape","1994d3c4":"df.head()","a8efa270":"df.describe()","b33f1029":"df.info()","6bd864fb":"#heatmap correlation \nplt.figure(figsize = (8,6))\nsns.heatmap(df.corr(), annot = True, cmap = 'viridis')\nplt.title(\"Pearson Correlation\")\nplt.show()","db5ad49a":"#visualize type of constituenccy\nplt.figure(figsize = (8,6))\nchart = df['Type'].value_counts().sort_values(ascending = False).plot(kind = 'bar', color = 'indigo')\nchart.set_xticklabels(chart.get_xticklabels(), rotation = 1)\nplt.title(\"Type of Constituency\")\nplt.xlabel(\"Type\")\nplt.ylabel(\"Count\")\nplt.show()","8b985be1":"#visualize type of constituency ~ total electors\nplt.figure(figsize = (8,6))\nsns.boxplot(data = df, x = 'Type', y = 'Total Electors')\nplt.title(\"Type of Constituency ~ Total Electors\")\nplt.xlabel(\"Type\")\nplt.ylabel(\"Total Electors\")\nplt.show()","42012889":"#visualize type of constituency ~ total votes\nplt.figure(figsize = (8,6))\nsns.boxplot(data = df, x = 'Type', y = 'Total Votes', palette = 'Set1')\nplt.title(\"Type of Constituency ~ Total Votes\")\nplt.xlabel(\"Type\")\nplt.ylabel(\"Total Votes\")\nplt.show()","fa0cede9":"#visualize type of constituency ~ polling percentage\nplt.figure(figsize = (8,6))\nsns.boxplot(data = df, x = 'Type', y = 'Poll%', palette = 'Set2')\nplt.title(\"Type of Constituency ~ Polling Percentage\")\nplt.xlabel(\"Type\")\nplt.ylabel(\"Poll %\")\nplt.show()","66a28446":"#visualize type of constituency ~ margin\nplt.figure(figsize = (8,6))\nsns.boxplot(data = df, x = 'Type', y = 'Margin')\nplt.title(\"Type of Constituency ~ Margin\")\nplt.xlabel(\"Type\")\nplt.ylabel(\"Margin\")\nplt.show()","27c91d82":"#visualize type of constituency ~ margin percentage\nplt.figure(figsize = (8,6))\nsns.boxplot(data = df, x = 'Type', y = 'Margin %', palette = 'Set1')\nplt.title(\"Type of Constituency ~ Margin Percentage\")\nplt.xlabel(\"Type\")\nplt.ylabel(\"Margin %\")\nplt.show()","e79862bd":"#visualize district of election\nplt.figure(figsize = (8,6))\ndf['District'].value_counts().sort_values().plot(kind = 'barh', color = 'dodgerblue')\nplt.title(\"District of Election\")\nplt.xlabel(\"District\")\nplt.ylabel(\"Count\")\nplt.show()","3adade76":"#visualize histogram of each attribute\ndf.hist(figsize = (13,10), color = 'darkorange')\nplt.show()","fc41da2f":"#handling categorical data\ndf = pd.get_dummies(df, drop_first = True)\ndf.head()","8f8fac43":"#split data\nX = df.drop('Total Votes', axis = 1)\ny = df['Total Votes']\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, random_state = 0)\nprint(X_train.shape)\nprint(y_train.shape)\nprint(X_test.shape)\nprint(y_test.shape)","c4027090":"#build model\nlr = LinearRegression()\n%time lr.fit(X_train, y_train)","5a3fed58":"#prediction\ny_pred = lr.predict(X_test)\nprint(y_pred)","3fe1c931":"#check MAE, MSE, RMSE & R-Squared\nprint('Mean Absolute Error : ', metrics.mean_absolute_error(y_test, y_pred).round(2))\nprint('Mean Squared Error : ', metrics.mean_squared_error(y_test, y_pred).round(2))\nprint('Root Mean Squared Error : ', np.sqrt(metrics.mean_absolute_error(y_test, y_pred).round(2)))\nprint('R-Squared : ', metrics.r2_score(y_test, y_pred))","afcce8c0":"#visualize model\nx = y_test\ny = y_pred\n\nplt.figure(figsize = (8,6))\nplt.title(\"Linear Regression Model\")\nplt.plot(x, y, 'o', color = 'orangered')\n\nm, b = np.polyfit(x, y, 1)\nplt.plot(x, m * x + b, color = 'royalblue')\nplt.show()","3496dc28":"#distribution\nplt.figure(figsize = (8,6))\nsns.distplot(df['Total Votes'], color = 'darkred')\nplt.title(\"Distribution of Total Votes\")\nplt.show()","e0e9b62a":"#defining feature\ncoef = pd.Series(lr.coef_, index = X.columns)\n\nimp_coef = pd.concat([coef.sort_values().head(10),\n                     coef.sort_values().tail(10)])\n\n#visualize feature\nplt.figure(figsize = (10,6))\nimp_coef.plot(kind = 'barh', color = 'blueviolet')\nplt.title(\"Feature Importance\")\nplt.xlabel('Score')\nplt.ylabel('Features')\nplt.show()","3b01145a":"# Check Feature Importance ","c3dafc22":"# Constituencywise Assembly Election Results of Kerala in 2021 ","f196b6a9":"# Data Extraction","1c2723e8":"# Linear Regression Model","06609db2":"# Visualization"}}