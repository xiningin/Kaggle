{"cell_type":{"f27ba990":"code","93cb10cf":"code","dfe0ee58":"code","403958d4":"code","dccf86e0":"code","6fe17666":"code","ad523143":"code","57eea22e":"code","255d99df":"code","dca24f82":"code","7b8beb94":"code","e4f47717":"code","3a5538d4":"code","f9387b3b":"code","c5fd096f":"code","540c2b26":"code","adddef52":"code","13ee3f3a":"code","c763dfc2":"code","f5290800":"code","015394de":"code","47fbfb6d":"code","e60e67d7":"code","92a762d9":"code","00826121":"code","68ccbbae":"code","c662ccb5":"code","05f8bf39":"code","28614773":"code","86a7cf95":"code","ae6cee2e":"code","b170f8a4":"code","386ccfd0":"code","79fbf1d8":"code","f2ce9ecb":"markdown","def95880":"markdown","2f1559ba":"markdown","af59bc47":"markdown","f9a261b9":"markdown"},"source":{"f27ba990":"import pandas as pd \nimport numpy as np\n\ndata = pd.read_csv(\"..\/input\/heart-failure-prediction\/heart.csv\")\ndata.head()","93cb10cf":"data.info()","dfe0ee58":"#Giri\u015f k\u0131sm\u0131nda \u00f6zellik bilgilerinde de g\u00f6r\u00fcld\u00fc\u011f\u00fc gibi baz\u0131 \u00f6zelliklerimiz object daha sonra\n#bu \u00f6zellikleri say\u0131sal ifadelere \u00e7evirece\u011fiz","403958d4":"#Eksik veri y\u00fczdesi #\neksik_data = data.isnull().sum()\ntoplam_y\u00fczde = (eksik_data.sum()\/data.shape[0])*100\nprint(f'Eksik veri y\u00fczdesi: %{toplam_y\u00fczde}')","dccf86e0":"####object s\u00fctunlar\u0131 d\u00f6n\u00fc\u015ft\u00fcrme###\ndata[\"Sex\"] = data.Sex.map({\"M\":0,\"F\":1})\ndata[\"ChestPainType\"] = data.ChestPainType.map({\"TA\":0,\"ATA\":1,\"NAP\":2,\"ASY\":3})\ndata[\"RestingECG\"] = data.RestingECG.map({\"Normal\":0,\"ST\":1,\"LVH\":2})\ndata[\"ExerciseAngina\"] = data.ExerciseAngina.map({\"Y\":1,\"N\":0})\ndata[\"ST_Slope\"] = data.ST_Slope.map({\"Up\":1,\"Flat\":0,\"Down\":2})\n\ndata.head()","6fe17666":"data = data.astype(float)\ndata.head()","ad523143":"import matplotlib.pyplot as plt \nimport seaborn as sns","57eea22e":"data.describe()","255d99df":"fig = plt.figure(figsize = (15,20))\nax = fig.gca()\ndata.hist(ax = ax)\nplt.show()","dca24f82":"#Bu grafiklerden baz\u0131 \u00e7\u0131kar\u0131mlar yapabiliriz:\n#1- Erkek say\u0131s\u0131 kad\u0131n say\u0131s\u0131ndan daha fazla\n#2- FastingBS genel olarak 120 mg\/dl \u00fczeri \u00e7\u0131km\u0131\u015f\n#3- \u00c7o\u011funluk 50-60 ya\u015f aral\u0131\u011f\u0131nda\n#4- RestingECG \u00e7o\u011funlukta normal\n#5- ChestPainType genel olarak asemptomatik\n#6- Hedef de\u011fi\u015fkenimiz dengeli ","7b8beb94":"hedef= data.HeartDisease.value_counts()\nprint(f'HeartDisease 1 say\u0131s\u0131= {hedef[1]}, HeartDisease 0 say\u0131s\u0131={hedef[0]}')","e4f47717":"plt.figure(figsize=(15,8))\nsns.heatmap(data.corr(), annot = True)\nplt.show()","3a5538d4":"X_new = data.iloc[:,0:11]\ny_new= data.iloc[:,-1]\nX_new.head()","f9387b3b":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test = train_test_split(X_new,y_new,test_size=.2,random_state=42) ","c5fd096f":"from sklearn.preprocessing import StandardScaler\n\nscaler = StandardScaler()\n\nX_train = scaler.fit_transform(X_train)\nX_test = scaler.transform(X_test)","540c2b26":"import tensorflow as tf\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Activation, Dropout\nfrom tensorflow.keras.callbacks import EarlyStopping","adddef52":"model = Sequential()\n\nmodel.add(Dense(units= 12,activation=\"relu\"))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(units=12,activation=\"relu\"))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(units=8,activation=\"relu\"))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(units=6,activation=\"relu\"))\n\nmodel.add(Dense(units=4,activation=\"relu\"))\n\nmodel.add(Dense(units=3,activation=\"relu\"))\n\nmodel.add(Dense(units=1,activation=\"sigmoid\"))\n\n\nmodel.compile(optimizer=\"adam\", loss=\"binary_crossentropy\")","13ee3f3a":"earlyStopping = EarlyStopping(monitor=\"val_lose\",mode=\"min\",verbose=1,patience=25)\nmodel.fit(X_train, y_train, validation_data=(X_test, y_test), verbose=1, epochs=250, callbacks=[earlyStopping])","c763dfc2":"kay\u0131pVeri = pd.DataFrame(model.history.history)\nkay\u0131pVeri.plot()","f5290800":"y_pred = model.predict(X_test)\ny_pred = np.round(y_pred).astype(int)\ny_pred[:20]","015394de":"from sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import f1_score\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import recall_score,precision_score,classification_report,roc_auc_score,roc_curve","47fbfb6d":"cm=confusion_matrix(y_test,y_pred)\nconf_matrix=pd.DataFrame(data=cm,columns=['Tahmin:0','Tahmin:1'],index=['Ger\u00e7ek:0','Ger\u00e7ek:1'])\nplt.figure(figsize = (8,5))\nsns.heatmap(conf_matrix, annot=True,fmt='d',cmap=\"YlGnBu\")","e60e67d7":"ysa_accuracy = accuracy_score(y_test,y_pred)\nprint(f\"YSA do\u011fruluk de\u011feri {round(ysa_accuracy*100,2)}%\")","92a762d9":"print(classification_report(y_test,y_pred))","00826121":"r_a = roc_auc_score(y_test,y_pred)\nr_a","68ccbbae":"model = Sequential()\n\nmodel.add(Dense(units= 12,activation=\"relu\"))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(units=12,activation=\"relu\"))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(units=10,activation=\"relu\"))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(units=9,activation=\"relu\"))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(units=7,activation=\"relu\"))\n\nmodel.add(Dense(units=7,activation=\"relu\"))\n\nmodel.add(Dense(units=5,activation=\"relu\"))\nmodel.add(Dense(units=3,activation=\"relu\"))\nmodel.add(Dense(units=2,activation=\"relu\"))\nmodel.add(Dense(units=1,activation=\"sigmoid\"))\n\n\nmodel.compile(optimizer=\"adam\", loss=\"binary_crossentropy\")","c662ccb5":"earlyStopping = EarlyStopping(monitor=\"val_lose\",mode=\"min\",verbose=1,patience=25)\nmodel.fit(X_train, y_train, validation_data=(X_test, y_test), verbose=1, epochs=250, callbacks=[earlyStopping])","05f8bf39":"kay\u0131pVeri_2 = pd.DataFrame(model.history.history)\nkay\u0131pVeri_2.plot()","28614773":"y_pred_2 = model.predict(X_test)\ny_pred_2 = np.round(y_pred_2).astype(int)\ny_pred_2[:20]","86a7cf95":"cm_2=confusion_matrix(y_test,y_pred_2)\nconf_matrix=pd.DataFrame(data=cm_2,columns=['Tahmin:0','Tahmin:1'],index=['Ger\u00e7ek:0','Ger\u00e7ek:1'])\nplt.figure(figsize = (8,5))\nsns.heatmap(conf_matrix, annot=True,fmt='d',cmap=\"YlGnBu\")","ae6cee2e":"ysa_accuracy_2 = accuracy_score(y_test,y_pred_2)\nprint(f\"YSA do\u011fruluk de\u011feri {round(ysa_accuracy_2*100,2)}%\")","b170f8a4":"r_a_2 = roc_auc_score(y_test,y_pred_2)\nr_a_2","386ccfd0":"comparison = pd.DataFrame({\n    \"YSA_Model_1\":{'Accuracy':ysa_accuracy, 'AUC':r_a},\n    \"YSA_Model_2\":{'Accuracy':ysa_accuracy_2, 'AUC':r_a_2}\n}).T\ncomparison","79fbf1d8":"fig = plt.gcf()\nfig.set_size_inches(15, 15)\ntitles = ['AUC','Accuracy']\nfor title,label in enumerate(comparison.columns):\n    plt.subplot(2,2,title+1)\n    sns.barplot(x=comparison.index, y = comparison[label], data=comparison)\n    plt.xticks(fontsize=9)\n    plt.title(titles[title])\nplt.show()","f2ce9ecb":" **1-)VER\u0130 SET\u0130N\u0130 TANIYALIM**","def95880":"***\u00d6zellik Bilgileri***\n\n1.Age:Hastan\u0131n ya\u015f bilgisi\n\n2.Sex:Cinsiyet bilgisi(M=Erkek,F=Kad\u0131n)\n\n3.ChestPainType:G\u00f6\u011f\u00fcs a\u011fr\u0131s\u0131 tipi(TA=Tipik Anjina,ATA=Atipik Anjina,NAP=Anjinal olmayan \na\u011fr\u0131,ASY=Asemptomatik)\n\n4.RestingBP:Dinlenme kan bas\u0131nc\u0131(mmHg)\n\n5.Cholesterol:Serum Kolesterol\u00fc(mm\/dl)\n\n6.FastingBS:A\u00e7l\u0131k kan \u015fekeri d\u00fczeyi(1 = FastingBS>120 mg\/dl, 0==di\u011fer)\n\n7.RestingECG:\u0130stirahat EKG durumu(Normal=Normal, ST=ST-T dalga anomalili\u011fi, LVH=Estes kriterlerine g\u00f6re olas\u0131 veya kesin sol ventrik\u00fcl hipertrofisi)\n\n8.MaxHR:Maximum kalp at\u0131\u015f h\u0131z\u0131\n\n9.ExerciseAngina:Egzersize ba\u011fl\u0131 anjina(Y=evet, N=hay\u0131r)\n\n10.Oldpeak:ST(depresyonda \u00f6l\u00e7\u00fclen say\u0131sal de\u011fer)\n\n11.ST_Slope:ST segmentinin e\u011fimi(Up=Yukar\u0131 ,Flat=D\u00fcz ,Down=A\u015fa\u011f\u0131)\n\n12.HeartDisease:Hedef De\u011fi\u015fken(1=Kalp Hastal\u0131\u011f\u0131, 0=Normal)","2f1559ba":"**Modelde Katman Say\u0131lar\u0131n\u0131 De\u011fi\u015ftirirsek Sonu\u00e7 Ne Olur**","af59bc47":"**EDA**","f9a261b9":"**Bu \u00e7al\u0131\u015fmada yapay sinir a\u011flar\u0131 kullan\u0131larak 2 farkl\u0131 modelin sonu\u00e7lar\u0131 kar\u015f\u0131la\u015ft\u0131r\u0131lm\u0131\u015ft\u0131r.\nK\u00fc\u00e7\u00fck bir fark olsa da katman say\u0131s\u0131n\u0131n art\u0131r\u0131lmas\u0131 accuracy ve roc_auc de\u011ferlerini y\u00fckseltmi\u015ftir.**\n\n***E\u011fer buraya kadar geldiysen ele\u015ftiri ve \u00f6nerilerini yazmay\u0131 ve upvote yapmay\u0131 unutma!\nIf you've come this far, don't forget to write your comments and suggestions and upvote!***"}}