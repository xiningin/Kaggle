{"cell_type":{"a4459f74":"code","681083fd":"code","e1198bf9":"code","ae333bda":"code","ed93dbe3":"code","b4a9880f":"code","e36e4250":"code","9113ba25":"code","91bb87bb":"code","3648c863":"code","164af0c2":"code","41d12302":"code","24cefb6d":"code","fbe189af":"code","5c9fda12":"code","a077beb3":"code","ca6bc64d":"code","3c6d0474":"code","2c3b2c69":"code","0a776ba1":"markdown","c393f9a3":"markdown","ba219af6":"markdown","8a977465":"markdown","480f26f4":"markdown","f0768338":"markdown","91ec626b":"markdown","53ce4e19":"markdown","8ef79a28":"markdown","d00f2904":"markdown"},"source":{"a4459f74":"# packages\n\n# standard\nimport numpy as np\nimport pandas as pd\n\n# plots\nimport matplotlib.pyplot as plt","681083fd":"# load monthly data\ndf = pd.read_csv('..\/input\/gold-prices\/monthly_csv.csv')\n\n# add a few features\ndf['logPrice'] = np.log(df.Price)\ndf['logChange'] = df.logPrice.diff()\ndf['percChange'] = df.Price.pct_change()\n\n# extract year\ndf['Year'] = df['Date'].apply(lambda x : x[0:4]).astype(int)\n\n# show results\ndf","e1198bf9":"# first overview plot\nfig, ax = plt.subplots(figsize=(16,6))\nax.plot(df.Date, df.Price, marker='.')\nax.xaxis.set_major_locator(plt.MaxNLocator(20)) # reduce number of x-labels\nplt.grid()\nplt.show()","ae333bda":"# use only years from 1971 on:\ndf = df.iloc[252:].copy().reset_index(drop=True)\n# preview\ndf.head()","ed93dbe3":"# overview plot\nfig, ax = plt.subplots(figsize=(16,6))\nax.plot(df.Date, df.Price, marker='.')\nax.xaxis.set_major_locator(plt.MaxNLocator(20)) # reduce number of x-labels\nplt.grid()\nplt.show()","b4a9880f":"# basic stats (on monthly basis)\ndf.describe()","e36e4250":"# plot relative changes\nfig, ax = plt.subplots(figsize=(16,6))\nax.scatter(df.Date, df.percChange, marker='.')\nax.xaxis.set_major_locator(plt.MaxNLocator(20)) # reduce number of x-labels\nplt.title('Relative changes [monthly]')\nplt.grid()\nplt.show()","9113ba25":"# distribution of relative changes\nplt.figure(figsize=(12,4))\ndf.percChange.plot(kind='hist', bins=50, color='gold')\nplt.title('Relative changes [monthly]')\nplt.grid()\nplt.show()","91bb87bb":"# distribution of log changes\nplt.figure(figsize=(12,4))\ndf.logChange.plot(kind='hist', bins=50, color='gold')\nplt.title('Log changes [monthly]')\nplt.grid()\nplt.show()","3648c863":"# look for autocorrelations\nplt.acorr(df.percChange, maxlags=20)\nplt.title('Autocorrelations of percChange')\nplt.grid()\nplt.show()","164af0c2":"# calc autocorrelation for lag 1 (month)\ndf.percChange.corr(df.percChange.shift(1), method='pearson')","41d12302":"# check using rank correlation as well\ndf.percChange.corr(df.percChange.shift(1), method='spearman')","24cefb6d":"# visualize\nxx = np.asarray(df.percChange.shift(1))\nyy = np.asarray(df.percChange)\n\nplt.figure(figsize=(6,6))\nplt.scatter(xx[1:],yy[1:], alpha=0.5) # leave out first point (prev = NA)\n# add regression line\nmm,bb = np.polyfit(xx[1:],yy[1:],1)\nplt.plot(xx, mm*xx + bb, c='magenta')\nplt.title('Autocorrelation - Lag = 1 Month')\nplt.xlabel('Month')\nplt.ylabel('Month + 1')\nplt.grid()\nplt.show()","fbe189af":"# calc autocorrelation for lag 2 (month)\ndf.percChange.corr(df.percChange.shift(2), method='pearson')","5c9fda12":"# visualize\nxx = np.asarray(df.percChange.shift(2))\nyy = np.asarray(df.percChange)\n\nplt.figure(figsize=(6,6))\nplt.scatter(xx[2:],yy[2:], alpha=0.5) # leave out first point (prev = NA)\n# add regression line\nmm,bb = np.polyfit(xx[2:],yy[2:],1)\nplt.plot(xx, mm*xx + bb, c='magenta')\nplt.title('Autocorrelation - Lag = 2 Month')\nplt.xlabel('Month')\nplt.ylabel('Month + 1')\nplt.grid()\nplt.show()","a077beb3":"threshold_x = 0.15\ndf_ext = df[abs(df.percChange)>threshold_x]\ndf_ext","ca6bc64d":"# summing up the log changes of 12 months gives us the log change for the full year\ndf_annual_returns = pd.DataFrame(df.groupby('Year')['logChange'].sum())\n# add also simple return (exp(logR)-1)\ndf_annual_returns['Return'] = np.exp(df_annual_returns.logChange)-1\ndf_annual_returns","3c6d0474":"# plot annual returns\nplt.figure(figsize=(16,4))\ndf_annual_returns.Return.plot(kind='bar')\nplt.title('Annual returns')\nplt.grid()\nplt.show()","2c3b2c69":"df[(df.Year==1979) | (df.Date=='1978-12')] # we also need the last month of 1978 as \"offset\"","0a776ba1":"# Exploration of historical monthly gold prices\n\n## Table of Contents\n* [Explore price development](#1)\n* [Autocorrelations](#2)\n* [Most extreme movements](#3)\n* [Evaluate annual returns for each year](#4)","c393f9a3":"<a id='2'><\/a>\n# Autocorrelations","ba219af6":"<a id='4'><\/a>\n# Evaluate annual returns for each year","8a977465":"#### We see that before the 1970s not much happened. This was due to the Bretton Woods system which tied currencies, including the USD, to gold. In August 1971 the US stopped the convertibility between USD and gold meaning the end of the Bretton Woods system. More details see: https:\/\/en.wikipedia.org\/wiki\/Bretton_Woods_system\n\n#### In this analysis we will therefore use only the data from 1971 on.","480f26f4":"#### For a 1 month lag there seems to be a certain correlation. Let's dive deeper into that:","f0768338":"#### Let's look at the most successful year 1979 in detail:","91ec626b":"#### Try the same with lag 2 (months):","53ce4e19":"<a id='1'><\/a>\n# Explore price development","8ef79a28":"#### Please note, that 2020 is not a complete year here!","d00f2904":"<a id='3'><\/a>\n# Most extreme movements"}}