{"cell_type":{"3d008c94":"code","a0c70d12":"code","97ac026a":"code","33a85b5b":"code","a3d265e4":"code","48680d8a":"code","69748b5b":"code","81ee1981":"code","bb1116a4":"code","bfbf8200":"code","e22d138f":"code","ab4700c5":"code","1542c7f8":"code","e5dfacd4":"code","cc824876":"code","59c3006f":"code","9fc97f1c":"code","02330540":"code","c2fc6886":"code","9e4cb2f0":"code","be9b7ce1":"code","b5fecb65":"code","3d6e2836":"code","665a57b4":"code","28ba5478":"code","11938dfd":"code","dd001ffb":"code","814d74ba":"code","4cbbb513":"code","0137f102":"code","a8fdec60":"code","0061f788":"code","ca992eb6":"code","8f9623f9":"markdown","dcc5e1f8":"markdown","778ca6df":"markdown","0ef60b25":"markdown","ff7a6a5e":"markdown","e02d6bf6":"markdown","3eb72bad":"markdown","524fe70b":"markdown","cffcaaa2":"markdown","40b12135":"markdown","531490c0":"markdown","b855e143":"markdown"},"source":{"3d008c94":"import pandas as pd #for analysis\nimport numpy as np #linear algebra\n\n#for visualization\nimport matplotlib.pylab as plt\nfrom matplotlib import pyplot as plot\n%matplotlib inline\nimport seaborn as sns","a0c70d12":"df= pd.read_csv('..\/input\/carpriceprediction\/CarPrice_Assignment.csv')","97ac026a":"#take a look at a sample data to understand the dataset\ndf.head()","33a85b5b":"#let us know the types of the attributes\ndf.dtypes","a3d265e4":"#check the size of the data\ndf.shape","48680d8a":"#let us know the descriptive statistics of the numrical variables\ndf.describe()","69748b5b":"#let us know the descriptive statistics of the categorical variable\ndf.describe(include=\"object\")","81ee1981":"#checking for the missing values in the dataset\ndf.isnull().sum()","bb1116a4":"#removing 'car_ID'\ndf.drop('car_ID',axis=1,inplace=True)","bfbf8200":"df['CarName'].unique()","e22d138f":"df['CarName'] = df['CarName'].str.split(' ',n=1,expand=True)\ndf.head(2)","ab4700c5":"df['CarName'].unique()","1542c7f8":"df['CarName'].replace({'vokswagen':'volkswagen','vw':'volkswagen', 'toyouta':'toyota','porcshce':'porsche',  'Nissan':'nissan','maxda':'mazda'},inplace =True)\ndf['CarName'].unique()","e5dfacd4":"df.corr()['price']","cc824876":"sns.pairplot(data=df)","59c3006f":"plot.figure(figsize=(20,15))\nplt.subplot(3,3,1)\nsns.boxplot(x= 'fueltype', y= 'price',data= df)\nplt.subplot(3,3,2)\nsns.boxplot(x= 'aspiration', y= 'price',data= df)\nplt.subplot(3,3,3)\nsns.boxplot(x= 'doornumber', y= 'price',data= df)\nplt.subplot(3,3,4)\nsns.boxplot(x= 'carbody', y= 'price',data= df)\nplt.subplot(3,3,5)\nsns.boxplot(x= 'drivewheel', y= 'price',data= df)\nplt.subplot(3,3,6)\nsns.boxplot(x= 'enginelocation', y= 'price',data= df)\nplt.subplot(3,3,7)\nsns.boxplot(x= 'enginetype', y= 'price',data= df)\nplt.subplot(3,3,8)\nsns.boxplot(x= 'cylindernumber', y= 'price',data= df)\nplt.subplot(3,3,9)\nsns.boxplot(x= 'fuelsystem', y= 'price',data= df)","9fc97f1c":"#check the size before remove variables\ndf.shape","02330540":"#remove the unnecessary variables from the data set\ndf.drop(['symboling','doornumber','carheight','fuelsystem','enginelocation','boreratio','stroke','compressionratio','peakrpm'],axis=1,inplace=True)","c2fc6886":"#check the size after remove variables\ndf.shape","9e4cb2f0":"#let us seperate the variables to change.\ncategory = ['CarName','fueltype','aspiration','carbody','drivewheel','enginetype','cylindernumber']","be9b7ce1":"#let us create dummy variables\ndummy_var = pd.get_dummies(df[category])\ndummy_var.head(2)","b5fecb65":"#add a dummy variables to the dataset\ndf = pd.concat([df,dummy_var],axis =1)\ndf.head(1)","3d6e2836":"#remove the original categorical variables\ndf.drop(category,axis =1,inplace=True)\ndf.shape","665a57b4":"df.head()","28ba5478":"# for model devolpment\nfrom sklearn.feature_selection import SelectKBest, f_regression\nfrom sklearn.linear_model import Ridge\nfrom sklearn.model_selection import train_test_split","11938dfd":"#assign a variable for independent and dependent variables\nX = df.drop('price',axis=1)\ny = df['price']","dd001ffb":"#Feature Selection\nX_selected = SelectKBest(f_regression,k=15).fit_transform(X,y)","814d74ba":"#dividin into training and test set\nX_train,X_test,y_train,y_test = train_test_split(X_selected,y,test_size =0.20)","4cbbb513":"#Alpha tuning\n#create scoring list\nfitscores =[]\npredictscores =[]\n#logspace list of alpha\nalphas = np.logspace(-1, 4, num=25)\n#alpha iteration and fit with Ridge regression\nfor alpha in alphas:\n    estimator = Ridge(alpha = alpha)\n    estimator.fit(X_train,y_train)\n    fitscores.append(estimator.score(X_train,y_train))\n    predictscores.append(estimator.score(X_test,y_test))","0137f102":"#look at actual score\nfitscores[0]","a8fdec60":"#look at predictive score\npredictscores[0]","0061f788":"#visualize a scores\nax = plt.gca()\nax.set_xscale('log')\nax.plot(alphas, fitscores,'g', label = 'Train')\nax.plot(alphas, predictscores,'b', label = 'Test')\nplt.ylim([0,1])\nplt.xlabel('alpha')\nplt.ylabel('Correlation Coefficient')\nplt.legend()\nplt.title('Tune regularization')","ca992eb6":"#model on training and test data\nridgeEstimator = Ridge(alpha = 45)\nridgeEstimator.fit(X_train,y_train)\nridgeEstimator.score(X_train,y_train)\nridgeEstimator.score(X_test,y_test)\nplt.plot(y_train,ridgeEstimator.predict(X_train),'r*', label = 'Train')\nplt.plot(y_test,ridgeEstimator.predict(X_test),'bs', label = 'Test')\nplt.legend()\nplt.xlabel('Actual price')\nplt.ylabel('Predicted price')\nplt.title('Prediction Plot')","8f9623f9":"Let us do the feature selection using the correlation method.","dcc5e1f8":"Car names are not in the right format. So we can change that for our convenience.","778ca6df":"Some repeating Car names are in the array.Let's clean it.","0ef60b25":"After know the correlation coefficient,we do tha visualization to check the relationship between the variables.  ","ff7a6a5e":"findings:\n* Engine location has a significant difference between the catogories.But there is a large gap in the counts of the categories. \n> front ->202,\n> rear ->2.\n* From above box plot,we can select the following variables.\n> fuel type,\n> aspiration,\n> carbody,\n> drive wheel, \n> engine type,\n> cylinder number","e02d6bf6":"Let us visualize the categorical variables. ","3eb72bad":"To do the prediction, first we load the dataset","524fe70b":"Let us start by importing libraries","cffcaaa2":"Findings:\n* Totally **7** numerical variables are having a linear relationship to the dependent variable \"price\".\n* ****Postive linear relationship:****\n> carlength,\n> carwidth,\n> curbweight,\n> enginesize,\n> horsepower\n* ****Negative linear relationship:****\n> citympg,\n> highwaympg\n \n","40b12135":"* As categorical variables are difficult to use in statistical prediction, we have to change it to numrical variables. \n* To change the variables, we use 'One Hot Encoding' method.","531490c0":"#### ****Objective:****\nThe goal of the notebook is to predict the price of the car. The dataset contains a sample of 205 car details.","b855e143":"Variable 'car id' is not useful for the prediction. So remove it from dataset. "}}