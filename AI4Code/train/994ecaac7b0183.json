{"cell_type":{"3290ea78":"code","d966bc69":"code","45a0139e":"code","5df2f310":"code","a603edfb":"code","9d368454":"code","bf22a683":"code","73fa0fca":"code","2be23c83":"code","88fdbb6e":"code","5bb90321":"code","6cc9aa64":"code","f82e4935":"code","030dcb58":"code","1f5421c3":"code","c4ab7ce4":"code","d6737f14":"code","99daa6d3":"code","fdd29e62":"code","22fd5913":"code","3c43d775":"code","05cac410":"code","22ce611b":"code","9e046df4":"code","02ac0bd3":"code","5b6573ee":"code","a108127b":"code","ff264edd":"code","13891d3c":"code","8efaba24":"code","c2bdb91b":"code","5c9b681c":"code","7daec45a":"code","ac36d60f":"code","a257d46e":"code","c8214bb5":"code","97112964":"code","c151fb49":"code","f8e7f360":"code","517b50b9":"code","26d6a7b9":"code","f2c79f4f":"code","8ab943ef":"code","a9f03bd0":"code","e915acff":"code","6218f89e":"code","add1bef1":"code","7c3c1d6d":"code","060c9fa3":"code","d59a6b5d":"code","fde46118":"code","6a5d9750":"code","6509d2b2":"code","b6790995":"code","56830e21":"code","a6ee0263":"code","eabf199d":"code","0e7e6055":"code","0a9439cf":"code","a843ac63":"code","90feda79":"code","7b94c523":"code","d23fb516":"code","08fadda1":"code","1cd5c50c":"code","eee0b4f8":"code","13778f49":"code","759b3c9e":"code","079294a8":"code","c721724d":"code","3c996b62":"code","968be82f":"code","42ce2e17":"code","4524d003":"code","572a3d65":"code","b82460da":"code","ebf6fd1f":"code","df259565":"code","d9d69bb8":"code","d87cf01c":"markdown","44b781b4":"markdown","bd086091":"markdown","1ba1959d":"markdown","2b52e59c":"markdown","79238e73":"markdown","ecbcadb1":"markdown","d61ecc94":"markdown","d7be31ec":"markdown","0d1ae527":"markdown","b629eb80":"markdown","0ad1613a":"markdown"},"source":{"3290ea78":"#GENERAL\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport random\nimport time\n#PATH PROCESS\nimport os\nimport os.path\nfrom pathlib import Path\nimport glob\nfrom scipy.io import loadmat\nimport nibabel as nib\n#IMAGE PROCESS\nfrom PIL import Image\nfrom keras.preprocessing import image\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nimport cv2\nfrom keras.applications.vgg16 import preprocess_input, decode_predictions\nfrom keras.preprocessing import image\nfrom skimage.feature import hessian_matrix, hessian_matrix_eigvals\nfrom scipy.ndimage.filters import convolve\nfrom skimage import data, io, filters\nimport skimage\nfrom skimage.morphology import convex_hull_image, erosion\nfrom IPython import display\nfrom scipy.ndimage import gaussian_filter\nfrom mpl_toolkits.mplot3d.art3d import Poly3DCollection\n#SCALER & TRANSFORMATION\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import MinMaxScaler\nfrom keras.utils.np_utils import to_categorical\nfrom sklearn.model_selection import train_test_split\nfrom keras import regularizers\nfrom sklearn.preprocessing import LabelEncoder\n#ACCURACY CONTROL\nfrom sklearn.metrics import confusion_matrix, accuracy_score, classification_report, roc_auc_score, roc_curve\nfrom sklearn.model_selection import GridSearchCV, cross_val_score\nfrom sklearn.metrics import mean_squared_error, r2_score\n#OPTIMIZER\nfrom keras.optimizers import RMSprop,Adam,Optimizer,Optimizer, SGD\n#MODEL LAYERS\nfrom tensorflow.keras.models import Sequential\nfrom keras.layers import Dense, Dropout, Flatten, Conv2D, MaxPool2D, BatchNormalization,MaxPooling2D,BatchNormalization,\\\n                        Permute, TimeDistributed, Bidirectional,GRU, SimpleRNN,\\\nLSTM, GlobalAveragePooling2D, SeparableConv2D, ZeroPadding2D, Convolution2D, ZeroPadding2D,Reshape, Conv2DTranspose,\\\nLeakyReLU, GaussianNoise, GlobalMaxPooling2D, ReLU, Input, Concatenate\nfrom keras import models\nfrom keras import layers\nimport tensorflow as tf\nfrom keras.applications import VGG16,VGG19,inception_v3\nfrom keras import backend as K\nfrom keras.utils import plot_model\nfrom keras.datasets import mnist\nimport keras\nfrom keras.models import Model\n#IGNORING WARNINGS\nfrom warnings import filterwarnings\nfilterwarnings(\"ignore\",category=DeprecationWarning)\nfilterwarnings(\"ignore\", category=FutureWarning) \nfilterwarnings(\"ignore\", category=UserWarning)","d966bc69":"Example_Train_NII_Path = \"..\/input\/heart-mri-image-dataset-left-atrial-segmentation\/imagesTr\/la_016.nii\"\nExample_Label_NII_Path = \"..\/input\/heart-mri-image-dataset-left-atrial-segmentation\/labelsTr\/la_016.nii\"","45a0139e":"Example_Reading_Train_NII = nib.load(Example_Train_NII_Path)\nExample_Reading_Label_NII = nib.load(Example_Label_NII_Path)","5df2f310":"print(type(Example_Reading_Train_NII))","a603edfb":"print(Example_Reading_Train_NII) # general info","9d368454":"print(Example_Reading_Train_NII.affine)","bf22a683":"print(Example_Reading_Train_NII.extra)","73fa0fca":"print(Example_Reading_Train_NII.dataobj.dtype)","2be23c83":"print(Example_Reading_Train_NII.get_data_dtype())","88fdbb6e":"print(Example_Reading_Train_NII.get_filename())","5bb90321":"print(Example_Reading_Train_NII.get_fdata())","6cc9aa64":"print(Example_Reading_Train_NII.file_map.keys())","f82e4935":"print(Example_Reading_Train_NII.file_map.items())","030dcb58":"print(Example_Reading_Train_NII.file_map[\"image\"].filename)","1f5421c3":"print(Example_Reading_Train_NII.get_qform())","c4ab7ce4":"print(Example_Reading_Train_NII.get_data()) # image","d6737f14":"print(Example_Reading_Train_NII.get_data().shape)","99daa6d3":"print(Example_Reading_Train_NII.get_data()[0].shape)","fdd29e62":"Example_ALL_Images = Example_Reading_Train_NII.get_data()\nExample_ALL_Labels = Example_Reading_Label_NII.get_data()","22fd5913":"print(Example_ALL_Images[0].shape)\nprint(Example_ALL_Labels[0].shape)","3c43d775":"print(Example_ALL_Images[Example_ALL_Images.shape[0]\/\/2].shape)","05cac410":"print(Example_ALL_Images.shape[0]\/\/2)","22ce611b":"print(Example_ALL_Images[Example_ALL_Images.shape[0]\/\/2])","9e046df4":"print(Example_ALL_Labels[Example_ALL_Images.shape[0]\/\/2].shape)","02ac0bd3":"figure,axis = plt.subplots(1,2,figsize=(10,10))\n\nPlot_Color_Op = axis[0].imshow(Example_ALL_Images[Example_ALL_Images.shape[0]\/\/2])\naxis[0].set_xlabel(Example_ALL_Images.shape)\naxis[0].set_ylabel(Example_ALL_Images.size)\naxis[0].set_title(\"IMAGE\")\n\naxis[1].imshow(Example_ALL_Labels[Example_ALL_Images.shape[0]\/\/2])\naxis[1].set_xlabel(Example_ALL_Labels[Example_ALL_Images.shape[0]\/\/2].shape)\naxis[1].set_ylabel(Example_ALL_Labels[Example_ALL_Images.shape[0]\/\/2].size)\naxis[1].set_title(\"MASK\")\n\nfigure.colorbar(Plot_Color_Op, ax=axis.ravel().tolist(), shrink=0.3, ticks=range(10),label='LAYER')","5b6573ee":"figure,axis = plt.subplots(1,2,figsize=(10,10))\n\nPlot_Color_Op = axis[0].imshow(Example_ALL_Images[Example_ALL_Images.shape[0]\/\/2],cmap=\"jet\")\naxis[0].set_xlabel(Example_ALL_Images.shape)\naxis[0].set_ylabel(Example_ALL_Images.size)\naxis[0].set_title(\"IMAGE\")\n\naxis[1].imshow(Example_ALL_Labels[Example_ALL_Images.shape[0]\/\/2],cmap=\"jet\")\naxis[1].set_xlabel(Example_ALL_Labels[Example_ALL_Images.shape[0]\/\/2].shape)\naxis[1].set_ylabel(Example_ALL_Labels[Example_ALL_Images.shape[0]\/\/2].size)\naxis[1].set_title(\"MASK\")\n\nfigure.colorbar(Plot_Color_Op, ax=axis.ravel().tolist(), shrink=0.3, ticks=range(10),label='LAYER')","a108127b":"figure,axis = plt.subplots(1,2,figsize=(10,10))\n\nPlot_Color_Op = axis[0].imshow(Example_ALL_Images[Example_ALL_Images.shape[0]\/\/2],cmap=\"hot\")\naxis[0].set_xlabel(Example_ALL_Images.shape)\naxis[0].set_ylabel(Example_ALL_Images.size)\naxis[0].set_title(\"IMAGE\")\n\naxis[1].imshow(Example_ALL_Labels[Example_ALL_Images.shape[0]\/\/2],cmap=\"hot\")\naxis[1].set_xlabel(Example_ALL_Labels[Example_ALL_Images.shape[0]\/\/2].shape)\naxis[1].set_ylabel(Example_ALL_Labels[Example_ALL_Images.shape[0]\/\/2].size)\naxis[1].set_title(\"MASK\")\n\nfigure.colorbar(Plot_Color_Op, ax=axis.ravel().tolist(), shrink=0.3, ticks=range(10),label='LAYER')","ff264edd":"figure,axis = plt.subplots(1,2,figsize=(10,10))\n\nPlot_Color_Op = axis[0].imshow(Example_ALL_Images[Example_ALL_Images.shape[0]\/\/2],cmap=\"Spectral\")\naxis[0].set_xlabel(Example_ALL_Images.shape)\naxis[0].set_ylabel(Example_ALL_Images.size)\naxis[0].set_title(\"IMAGE\")\n\naxis[1].imshow(Example_ALL_Labels[Example_ALL_Images.shape[0]\/\/2],cmap=\"Spectral\")\naxis[1].set_xlabel(Example_ALL_Labels[Example_ALL_Images.shape[0]\/\/2].shape)\naxis[1].set_ylabel(Example_ALL_Labels[Example_ALL_Images.shape[0]\/\/2].size)\naxis[1].set_title(\"MASK\")\n\nfigure.colorbar(Plot_Color_Op, ax=axis.ravel().tolist(), shrink=0.3, ticks=range(10),label='LAYER')","13891d3c":"figure,axis = plt.subplots(1,2,figsize=(12,12))\n\nPicking_Example_IMG = Example_ALL_Images[Example_ALL_Images.shape[0]\/\/2] \/ 255.\nPicking_Example_Label = Example_ALL_Labels[Example_ALL_Images.shape[0]\/\/2] \/ 255.\n\naxis[0].imshow(Picking_Example_IMG)\naxis[0].set_xlabel(Picking_Example_IMG.shape)\naxis[0].set_ylabel(Picking_Example_IMG.size)\naxis[0].set_title(\"IMAGE\")\n\nPlot_Color_Op = axis[1].imshow(Picking_Example_Label)\naxis[1].set_xlabel(np.mean(Picking_Example_Label))\naxis[1].set_ylabel(Picking_Example_Label.size)\naxis[1].set_title(\"MASK\")\n\nfigure.colorbar(Plot_Color_Op, ax=axis.ravel().tolist(), shrink=0.3, ticks=range(10),label='LAYER')","8efaba24":"Main_NII_Path = Path(\"..\/input\/heart-mri-image-dataset-left-atrial-segmentation\/imagesTr\")\nLabel_NII_Path = Path(\"..\/input\/heart-mri-image-dataset-left-atrial-segmentation\/labelsTr\")","c2bdb91b":"NII_Images = list(Main_NII_Path.glob(r\"*.nii\"))\nNII_Labels = list(Label_NII_Path.glob(r\"*.nii\"))","5c9b681c":"print(len(NII_Images))\nprint(len(NII_Labels))","7daec45a":"Images_Series = pd.Series(NII_Images,name=\"IMAGE\").astype(str)\nLabels_Series = pd.Series(NII_Labels,name=\"LABEL\").astype(str)","ac36d60f":"Main_Data = pd.concat([Images_Series,Labels_Series],axis=1)","a257d46e":"print(Main_Data.head(-1))","c8214bb5":"Or_1_0 = []\nImage_List = []\nLabel_List = []\n\nfor i_img,i_mask in zip(Main_Data[\"IMAGE\"].values,Main_Data[\"LABEL\"].values):\n\n    Reading_Train_NII = nib.load(i_img)\n    Reading_Label_NII = nib.load(i_mask)\n    \n    X_Images = Reading_Train_NII.get_data()\n    X_Labels = Reading_Label_NII.get_data()\n     \n    Selecting_Image = X_Images[X_Images.shape[0]\/\/2] \/ 255.\n    Selecting_Label = X_Labels[X_Images.shape[0]\/\/2] \/ 255.\n    \n    if np.mean(Selecting_Label) > 0:\n        Or_1_0.append(1)\n        Selecting_Image = Selecting_Image.astype(\"float32\")\n        Selecting_Label = Selecting_Label.astype(\"float32\")\n    \n        Image_List.append(Selecting_Image)\n        Label_List.append(Selecting_Label)\n    else:\n        Or_1_0.append(0)","97112964":"    \nfor i_img,i_mask in zip(Main_Data[\"IMAGE\"].values,Main_Data[\"LABEL\"].values):\n    Reading_Train_NII = nib.load(i_img)\n    Reading_Label_NII = nib.load(i_mask)\n    \n    X_Images = Reading_Train_NII.get_data()\n    X_Labels = Reading_Label_NII.get_data()\n     \n    Selecting_Image = X_Images[X_Images.shape[0]\/\/2] \/ 255.\n    Selecting_Label = X_Labels[X_Images.shape[0]\/\/2] \/ 255.\n    \n    print(np.shape(Selecting_Image))\n    print(np.shape(Selecting_Label))\n    print(\"---\"*20)","c151fb49":"print(Or_1_0)","f8e7f360":"print(len(Or_1_0))","517b50b9":"Main_Data[\"1_OR_0\"] = Or_1_0","26d6a7b9":"print(Main_Data.head(-1))","f2c79f4f":"print(len(Image_List))\nprint(len(Label_List))","8ab943ef":"print(Image_List[0].shape)\nprint(Label_List[0].shape)","a9f03bd0":"print(type(Image_List[0]))\nprint(type(Label_List[0]))","e915acff":"Testing_Trans = cv2.resize(Image_List[8],(256,256))","6218f89e":"print(Testing_Trans.shape)","add1bef1":"plt.imshow(Testing_Trans)","7c3c1d6d":"True_Seg = Main_Data[Main_Data[\"1_OR_0\"] == 1]","060c9fa3":"Image_List = []\nLabel_List = []\n\nfor i_img,i_mask in zip(True_Seg[\"IMAGE\"].values,True_Seg[\"LABEL\"].values):\n\n    Reading_Train_NII = nib.load(i_img)\n    Reading_Label_NII = nib.load(i_mask)\n    \n    X_Images = Reading_Train_NII.get_data()\n    X_Labels = Reading_Label_NII.get_data()\n     \n    Selecting_Image = X_Images[X_Images.shape[0]\/\/2] \/ 255.\n    Selecting_Label = X_Labels[X_Images.shape[0]\/\/2] \/ 255.\n    \n    Selecting_Image = Selecting_Image.astype(\"float32\")\n    Selecting_Label = Selecting_Label.astype(\"float32\")\n    \n    Resized_IMG = cv2.resize(Selecting_Image,(256,256))\n    Resized_LABEL = cv2.resize(Selecting_Label,(256,256))\n    \n    Image_List.append(Resized_IMG)\n    Label_List.append(Resized_LABEL)","d59a6b5d":"print(len(Image_List))\nprint(len(Label_List))","fde46118":"for indexing_i in range(len(Image_List)):\n    print(\"---\"*10)\n    print(Image_List[indexing_i].shape)\n    print(Label_List[indexing_i].shape)","6a5d9750":"print(np.shape(np.array(Image_List)))\nprint(np.shape(np.array(Label_List)))","6509d2b2":"figure,axis = plt.subplots(1,2,figsize=(12,12))\n\nPicking_Example_IMG = Image_List[0]\nPicking_Example_Label = Label_List[0]\n\naxis[0].imshow(Picking_Example_IMG)\naxis[0].set_xlabel(Picking_Example_IMG.shape)\naxis[0].set_ylabel(Picking_Example_IMG.size)\naxis[0].set_title(\"IMAGE\")\n\naxis[1].imshow(Picking_Example_Label)\naxis[1].set_xlabel(np.mean(Picking_Example_Label))\naxis[1].set_ylabel(Picking_Example_Label.size)\naxis[1].set_title(\"MASK\")","b6790995":"figure,axis = plt.subplots(1,2,figsize=(12,12))\n\nPicking_Example_IMG = Image_List[2]\nPicking_Example_Label = Label_List[2]\n\naxis[0].imshow(Picking_Example_IMG)\naxis[0].set_xlabel(Picking_Example_IMG.shape)\naxis[0].set_ylabel(Picking_Example_IMG.size)\naxis[0].set_title(\"IMAGE\")\n\naxis[1].imshow(Picking_Example_Label)\naxis[1].set_xlabel(np.mean(Picking_Example_Label))\naxis[1].set_ylabel(Picking_Example_Label.size)\naxis[1].set_title(\"MASK\")","56830e21":"figure,axis = plt.subplots(1,2,figsize=(12,12))\n\nPicking_Example_IMG = Image_List[8]\nPicking_Example_Label = Label_List[8]\nPicking_Example_Label = Picking_Example_Label.astype(\"uint8\")\nPicking_Example_IMG = Picking_Example_IMG.astype(\"uint8\")\n\nCanny_Image = cv2.Canny(Picking_Example_Label,10,100)\n\nNP_Kernel = np.ones((5,5),np.uint8)\nDilation_Image = cv2.dilate(Canny_Image,NP_Kernel,iterations = 5)\n\nBlend_Image = cv2.addWeighted(Picking_Example_IMG,0.8,Dilation_Image,0.4,0.5)\n\naxis[0].imshow(Picking_Example_IMG)\naxis[0].set_xlabel(Picking_Example_IMG.shape)\naxis[0].set_ylabel(Picking_Example_IMG.size)\naxis[0].set_title(\"IMAGE\")\n\naxis[1].imshow(Blend_Image)\naxis[1].set_xlabel(np.mean(Blend_Image))\naxis[1].set_ylabel(Blend_Image.size)\naxis[1].set_title(\"MASK\")","a6ee0263":"figure,axis = plt.subplots(1,2,figsize=(12,12))\n\nPicking_Example_IMG = Image_List[0]\nPicking_Example_Label = Label_List[0]\nPicking_Example_Label = Picking_Example_Label.astype(\"uint8\")\nPicking_Example_IMG = Picking_Example_IMG.astype(\"uint8\")\n\nCanny_Image = cv2.Canny(Picking_Example_Label,10,100)\n\nNP_Kernel = np.ones((5,5),np.uint8)\nDilation_Image = cv2.dilate(Canny_Image,NP_Kernel,iterations = 5)\n\nBlend_Image = cv2.addWeighted(Picking_Example_IMG,0.8,Dilation_Image,0.4,0.5)\n\naxis[0].imshow(Picking_Example_IMG)\naxis[0].set_xlabel(Picking_Example_IMG.shape)\naxis[0].set_ylabel(Picking_Example_IMG.size)\naxis[0].set_title(\"IMAGE\")\n\naxis[1].imshow(Blend_Image,cmap=\"jet\")\naxis[1].set_xlabel(np.mean(Blend_Image))\naxis[1].set_ylabel(Blend_Image.size)\naxis[1].set_title(\"MASK\")","eabf199d":"figure,axis = plt.subplots(1,2,figsize=(12,12))\n\nPicking_Example_IMG = Image_List[0]\nPicking_Example_Label = Label_List[0]\nPicking_Example_Label = Picking_Example_Label.astype(\"uint8\")\nPicking_Example_IMG = Picking_Example_IMG.astype(\"uint8\")\n\nCanny_Image = cv2.Canny(Picking_Example_Label,10,100)\n\nNP_Kernel = np.ones((5,5),np.uint8)\nDilation_Image = cv2.dilate(Canny_Image,NP_Kernel,iterations = 5)\n\nBlend_Image = cv2.addWeighted(Picking_Example_IMG,0.8,Dilation_Image,0.4,0.5)\n\naxis[0].imshow(Picking_Example_IMG)\naxis[0].set_xlabel(Picking_Example_IMG.shape)\naxis[0].set_ylabel(Picking_Example_IMG.size)\naxis[0].set_title(\"IMAGE\")\n\naxis[1].imshow(Blend_Image,cmap=\"hot\")\naxis[1].set_xlabel(np.mean(Blend_Image))\naxis[1].set_ylabel(Blend_Image.size)\naxis[1].set_title(\"MASK\")","0e7e6055":"figure,axis = plt.subplots(1,2,figsize=(12,12))\n\nPicking_Example_IMG = Image_List[11]\nPicking_Example_Label = Label_List[11]\nPicking_Example_Label = Picking_Example_Label.astype(\"uint8\")\nPicking_Example_IMG = Picking_Example_IMG.astype(\"uint8\")\n\nBlend_Image = cv2.addWeighted(Picking_Example_IMG,0.8,Picking_Example_Label,0.4,0.5)\n\naxis[0].imshow(Picking_Example_IMG)\naxis[0].set_xlabel(Picking_Example_IMG.shape)\naxis[0].set_ylabel(Picking_Example_IMG.size)\naxis[0].set_title(\"IMAGE\")\n\naxis[1].imshow(Blend_Image)\naxis[1].set_xlabel(np.mean(Blend_Image))\naxis[1].set_ylabel(Blend_Image.size)\naxis[1].set_title(\"MASK\")","0a9439cf":"figure,axis = plt.subplots(1,2,figsize=(12,12))\n\nPicking_Example_IMG = Image_List[11]\nPicking_Example_Label = Label_List[11]\nPicking_Example_Label = Picking_Example_Label.astype(\"uint8\")\nPicking_Example_IMG = Picking_Example_IMG.astype(\"uint8\")\n\nBlend_Image = cv2.addWeighted(Picking_Example_IMG,0.8,Picking_Example_Label,0.4,0.5)\n\naxis[0].imshow(Picking_Example_IMG)\naxis[0].set_xlabel(Picking_Example_IMG.shape)\naxis[0].set_ylabel(Picking_Example_IMG.size)\naxis[0].set_title(\"IMAGE\")\n\naxis[1].imshow(Blend_Image,cmap=\"gray\")\naxis[1].set_xlabel(np.mean(Blend_Image))\naxis[1].set_ylabel(Blend_Image.size)\naxis[1].set_title(\"MASK\")","a843ac63":"X_TRAIN = np.array(Image_List,dtype=\"float32\")\nX_LABEL = np.array(Label_List,dtype=\"float32\")","90feda79":"print(X_TRAIN.shape)\nprint(X_LABEL.shape)","7b94c523":"X_TRAIN = X_TRAIN.reshape(X_TRAIN.shape[0],X_TRAIN.shape[1],X_TRAIN.shape[2],1)\nX_LABEL = X_LABEL.reshape(X_LABEL.shape[0],X_LABEL.shape[1],X_LABEL.shape[2],1)","d23fb516":"print(X_TRAIN.shape)\nprint(X_LABEL.shape)","08fadda1":"print(X_TRAIN[0:-1].shape)","1cd5c50c":"Encoder = Sequential()\n#\nEncoder.add(Conv2D(32,(5,5),kernel_initializer = 'he_normal',use_bias=True,name=\"ENCODER_INPUT\"))\nEncoder.add(BatchNormalization())\nEncoder.add(ReLU())\n#\nEncoder.add(Conv2D(64,(5,5),kernel_initializer = 'he_normal',use_bias=True))\nEncoder.add(BatchNormalization())\nEncoder.add(ReLU())\n#\nEncoder.add(Conv2D(128,(2,2),kernel_initializer = 'he_normal',use_bias=True))\nEncoder.add(BatchNormalization())\nEncoder.add(ReLU())\n#\nEncoder.add(Conv2D(128,(2,2),kernel_initializer = 'he_normal',use_bias=True))\nEncoder.add(BatchNormalization())\nEncoder.add(ReLU())\n\n\n\nDecoder = Sequential()\n#\nDecoder.add(Conv2DTranspose(128,(2,2)))\nDecoder.add(ReLU())\n#\nDecoder.add(Conv2DTranspose(64,(2,2)))\nDecoder.add(ReLU())\n#\nDecoder.add(Conv2DTranspose(32,(5,5)))\nDecoder.add(ReLU())\n#\nDecoder.add(Conv2DTranspose(1,(5,5),name=\"DECODER_OUTPUT\"))","eee0b4f8":"AE_Structure = Sequential([Encoder,Decoder])","13778f49":"AE_Structure.compile(loss=\"binary_crossentropy\",optimizer=Adam(lr=0.0000001),metrics=[\"accuracy\"])","759b3c9e":"AE_Model = AE_Structure.fit(X_TRAIN[0:-1],X_LABEL[0:-1],epochs=100)","079294a8":"Prediction_MASK = AE_Structure.predict(X_TRAIN[:10])","c721724d":"figure,axis = plt.subplots(1,2,figsize=(14,14))\nimg_number = 1\n\nOriginal_Img = X_TRAIN[img_number]\nPredict_Mask = Prediction_MASK[img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[1].imshow(Predict_Mask,cmap=\"jet\")\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")","3c996b62":"figure,axis = plt.subplots(1,2,figsize=(14,14))\nimg_number = 2\n\nOriginal_Img = X_TRAIN[img_number]\nPredict_Mask = Prediction_MASK[img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[1].imshow(Predict_Mask,cmap=\"hot\")\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")","968be82f":"figure,axis = plt.subplots(1,2,figsize=(14,14))\nimg_number = 3\n\nOriginal_Img = X_TRAIN[img_number]\nPredict_Mask = Prediction_MASK[img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[1].imshow(Predict_Mask,cmap=\"jet\")\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")","42ce2e17":"figure,axis = plt.subplots(1,2,figsize=(14,14))\nimg_number = 7\n\nOriginal_Img = X_TRAIN[img_number]\nPredict_Mask = Prediction_MASK[img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[1].imshow(Predict_Mask,cmap=\"jet\")\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")","4524d003":"figure,axis = plt.subplots(1,3,figsize=(14,14))\nimg_number = 9\n\nOriginal_Img = X_TRAIN[img_number]\nPredict_Mask = Prediction_MASK[img_number]\nMain_Mask = X_LABEL[img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[1].imshow(Main_Mask)\naxis[1].set_xlabel(Main_Mask.shape)\naxis[1].set_ylabel(Main_Mask.size)\naxis[1].set_title(\"MASKING\")\naxis[2].imshow(Predict_Mask,cmap=\"jet\")\naxis[2].set_xlabel(Predict_Mask.shape)\naxis[2].set_ylabel(Predict_Mask.size)\naxis[2].set_title(\"PREDICTION\")","572a3d65":"figure,axis = plt.subplots(1,3,figsize=(14,14))\nimg_number = 1\n\nOriginal_Img = X_TRAIN[img_number]\nPredict_Mask = Prediction_MASK[img_number]\nMain_Mask = X_LABEL[img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[1].imshow(Main_Mask)\naxis[1].set_xlabel(Main_Mask.shape)\naxis[1].set_ylabel(Main_Mask.size)\naxis[1].set_title(\"MASKING\")\naxis[2].imshow(Predict_Mask,cmap=\"jet\")\naxis[2].set_xlabel(Predict_Mask.shape)\naxis[2].set_ylabel(Predict_Mask.size)\naxis[2].set_title(\"PREDICTION\")","b82460da":"figure,axis = plt.subplots(1,3,figsize=(14,14))\nimg_number = 5\n\nOriginal_Img = X_TRAIN[img_number]\nPredict_Mask = Prediction_MASK[img_number]\nMain_Mask = X_LABEL[img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[1].imshow(Main_Mask)\naxis[1].set_xlabel(Main_Mask.shape)\naxis[1].set_ylabel(Main_Mask.size)\naxis[1].set_title(\"MASKING\")\naxis[2].imshow(Predict_Mask,cmap=\"jet\")\naxis[2].set_xlabel(Predict_Mask.shape)\naxis[2].set_ylabel(Predict_Mask.size)\naxis[2].set_title(\"PREDICTION\")","ebf6fd1f":"print(X_TRAIN[17:].shape)","df259565":"Prediction_NON_SEEN = AE_Structure.predict(X_TRAIN[17:])","d9d69bb8":"figure,axis = plt.subplots(1,2,figsize=(14,14))\nimg_number = 17\n\nOriginal_Img = X_TRAIN[img_number]\nPredict_Mask = Prediction_NON_SEEN[0]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[1].imshow(Predict_Mask,cmap=\"jet\")\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")","d87cf01c":"# PACKAGES AND LIBRARIES","44b781b4":"#### READING PROCESS","bd086091":"#### EXAMPLE PATH","1ba1959d":"# HISTORY\n\n* This repository is associated with the Left Atrial Segmentation Challenge 2013 (LASC'13). LASC'13 was part of the STACOM'13 workshop, held in conjunction with MICCAI'13. Seven international research groups, comprising 11 algorithms, participated in the challenge.\n\n* For a detailed report, please refer to:\n\n* Tobon-Gomez C, Geers AJ, Peters, J, Weese J, Pinto K, Karim R, Ammar M, Daoudi A, Margeta J, Sandoval Z, Stender B, Zheng Y, Zuluaga, MA, Betancur J, Ayache N, Chikh MA, Dillenseger J-L, Kelm BM, Mahmoudi S, Ourselin S, Schlaefer A, Schaeffter T, Razavi R, Rhode KS. Benchmark for Algorithms Segmenting the Left Atrium From 3D CT and MRI Datasets. IEEE Transactions on Medical Imaging, 34(7):1460\u20131473, 2015.\n\n* The challenge is also featured on Cardiac Atlas Project.\n\n* The Python scripts in this repository take as input a segmentation and output the two evaluation metrics described in the paper.\n\n* The data and code of the challenge have been made publicly available to serve as a benchmark for left atrial segmentation algorithms.\n\n\n* **CT**: Computed tomography\n* **GT**: Ground truth\n* **MRI**: Magnetic resonance imaging\n* **LA**: Left atrium\n* **LASC**'13: Left Atrial Segmentation Challenge 2013\n* **PV**: Pulmonary vein\n\n\n* The benchmark consists of 30 CT and 30 MRI datasets. Per modality, 10 datasets are for training of segmentation algorithms and 20 datasets are for testing.\n\n#### The MRI datasets are publicly available on Figshare:\n* Training\n* Testing\n* Results","2b52e59c":"#### EXAMPLE VISION","79238e73":"#### WHAT IS NII\n\n\n* NII files mostly belong to NIfTI-1 Data Format by Neuroimaging Informatics Technology Initiative. NIfTI-1 is adapted from the widely used ANALYZE 7.5 file format. The hope is that older non-NIfTI-aware software that uses the ANALYZE 7.5 format will still be compatible with NIfTI-1.\n\n\n**Identifier:**\tHex: 00 00 01 5C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n\n\n* You need a suitable software like NIfTI-1 Data Format from Neuroimaging Informatics Technology Initiative to open a NII file. Without proper software you will receive a Windows message \"How do you want to open this file?\" or \"Windows cannot open this file\" or a similar Mac\/iPhone\/Android alert.","ecbcadb1":"# OVERVIEW","d61ecc94":"#### TO ARRAY","d7be31ec":"# MODEL","0d1ae527":"# DATA PROCESS","b629eb80":"#### PATH PROCESS","0ad1613a":"#### CHECKING"}}