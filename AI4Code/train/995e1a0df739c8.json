{"cell_type":{"e6236cb0":"code","302e9a2d":"code","e9d3e211":"code","291749d8":"code","3ec624ca":"code","8f9ed402":"code","1237af02":"code","7ffd4398":"code","ff94244c":"code","44ad8f60":"code","b2f87dd9":"code","a319cf96":"code","a67049db":"code","13f6e285":"code","4b9b7025":"code","4cd3f9f2":"code","914dfe87":"code","c23d8bf1":"code","8257503f":"code","eca4e502":"code","047ea447":"code","7d118cde":"code","4376f795":"code","d4fb6ff2":"markdown","df9984cc":"markdown","134f5c11":"markdown","d5ef06f6":"markdown","664b46d6":"markdown","a3f71593":"markdown","556a06c5":"markdown","36cf8d4d":"markdown","a5b54653":"markdown","e5582626":"markdown","6759ee3b":"markdown","d2146217":"markdown","57940878":"markdown"},"source":{"e6236cb0":"!pip install drdigit-brezniczky==0.0.12","302e9a2d":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport drdigit as drd\nimport austria_2019_ep_preprocessing as pp\n\n# the below line allows publishing the kernel, for experimenting\n# just comment it out - saves time by caching some calculations\n# across Python sessions\ndrd.set_option(physical_cache_path=\"\")  \n\ndf, info = pp.get_preprocessed_data()","e9d3e211":"df.head()","291749d8":"info","3ec624ca":"len(df)","8f9ed402":"df[\"group\"] = df[info.area_code].str.slice(0, 4)\n\nnp.mean(df.groupby(\"group\").aggregate({\"GKZ\": len}))","1237af02":"tests = {}\n\nfor party in info.parties[0:3]:\n    for filter_by in [\"by row\", \"by municipality\"]:\n        filtered = drd.filter_df(df, group_column=\"group\",\n                                 value_columns=[party],\n                                 entire_groups=filter_by == \"by municipality\",\n                                 min_value=100)\n        print(\"%s by %s: %d\" % (party, filter_by, len(filtered)))\n        tests[(party, filter_by)] = drd.LodigeTest(\n            digits=filtered[\"ld_\" + party],\n            group_ids=filtered[\"group\"],\n            bottom_n=20,\n            ll_iterations=5000,\n            quiet=True  # this looks a lot better in these online notebooks\n        )","7ffd4398":"# calculate and print the test p-values\n# this takes a while, the calculations are carried out in a lazy fashion\n# (sort of, when someone asks for the result)\n\nfor spec, test in tests.items():\n    print(spec, test.p)","ff94244c":"for party, filter_by in sorted(tests.keys()):\n    test = tests[(party, filter_by)]\n    drd.plot_entropy_distribution(\n        actual_total_ent=test.likelihood,\n        p=test.p,\n        entropies=test.cdf.sample,\n        title=\"%s filtered on the %s level\" % (party, filter_by),\n    )","44ad8f60":"df_susp = drd.filter_df(df, value_columns=[\"\u00d6VP\"], min_value=100)\n\nscores = drd.get_group_scores(df_susp[\"group\"], df_susp[\"ld_\u00d6VP\"], \n                              [df_susp[info.valid_votes], df_susp[\"ld_\u00d6VP\"]], \n                              [df_susp[\"ld_FP\u00d6\"], df_susp[\"ld_SP\u00d6\"]],\n                             quiet=True)","b2f87dd9":"help(drd.filter_df)","a319cf96":"ranking = pd.DataFrame(dict(group=scores.index, score=scores))\nranking.sort_values([\"score\"], inplace=True)\nranking.head()","a67049db":"len(ranking)","13f6e285":"plt.hist(ranking.score, bins=20)\nplt.show()","4b9b7025":"def get_top_group(index):\n    group = ranking.iloc[index][\"group\"]\n    return df[df.group==group][[\"group\", \"GKZ\", info.valid_votes, \"\u00d6VP\", \"SP\u00d6\", \"FP\u00d6\"]]\n    \nget_top_group(0)","4cd3f9f2":"get_top_group(1)","914dfe87":"get_top_group(2)","c23d8bf1":"get_top_group(3)","8257503f":"old_figsize = plt.rcParams[\"figure.figsize\"]\ntry:\n    plt.rcParams[\"figure.figsize\"] = [9, 7]\n    drd.plot_explanatory_fingerprint_responses(fontsize=16)\nfinally:\n    plt.rcParams[\"figure.figsize\"] = old_figsize","eca4e502":"len(df_susp)","047ea447":"def plot_party_fingerprint(party, start_perc, end_perc):\n    l = len(ranking)\n    groups = ranking.group[int(l * start_perc):int(l * end_perc)]\n    df_act = df_susp[df_susp[\"group\"].isin(groups)]\n    drd.plot_fingerprint(df_act[party], df_act[info.valid_votes], df_act[info.registered_voters], \n                         \"%s from %d %% to %d %%\" % (party, start_perc * 100, end_perc * 100))\n\n\nplot_party_fingerprint(\"\u00d6VP\", 0, 0.5)\nplot_party_fingerprint(\"\u00d6VP\", 0.5, 1.0)","7d118cde":"plot_party_fingerprint(\"SP\u00d6\", 0, 0.50)\nplot_party_fingerprint(\"SP\u00d6\", 0.50, 1.00)","4376f795":"plot_party_fingerprint(\"FP\u00d6\", 0, 0.50)\nplot_party_fingerprint(\"FP\u00d6\", 0.50, 1.00)","d4fb6ff2":"To analyze the data using DrDigit we will need to form a number of digit groups first. For this, the below generates the group ID - hopefully these are geographic areas, particularly municipalities (by spot checks the \"GKZ\" area codes are hierarchically organized in that way), though this concept is flawed in case of Vienna (an improvement for the future).","df9984cc":"# Closing words\n\nIt is You who decides what you believe.\n\nThanks to the exploding analytical space You are in a better position than ever to check on your beliefs.\n\nAny suspicion in your country? It might be easier than you'd think to just grab some data and take a look! Or to go and count the votes yourself... or something else - taking things in your hands.\n\nDemocracies exist as long as voters maintain them.","134f5c11":"More info for the mighty:\n\n* The [GitHub repo](https:\/\/github.com\/brezniczky\/ep_elections_2019_hun) hosting the analyses - this all comes from a Hungarian election fraud proof attempt\n\n* Specifically, the [Polish analysis](https:\/\/www.kaggle.com\/brezniczky\/poland-2019-ep-elections-doctoring-quick-check\/) and the [Hungarian document](https:\/\/nbviewer.jupyter.org\/github\/brezniczky\/ep_elections_2019_hun\/blob\/master\/report.ipynb) containing the above (a very slightly different earlier version) and some yet-to-be-implemented fraud check strategies and a lot of details about the methodology. It is very applied and I am just an enthusisast.\n\n* Where these fingerprint plots come from: a scientifically much more correct and verbose detailing of similar and different approaches to electoral fraud investigation [Forensic analysis of Turkish elections in 2017\u20132018](https:\/\/journals.plos.org\/plosone\/article?id=10.1371\/journal.pone.0204975) by Peter Klimek, Ra\u00fal Jim\u00e9nez, Manuel Hidalgo, Abraham Hinteregger, Stefan Thurner from 2018. Actually the above plots are a modified version in that they are weighted by the vote count relating to the ward that each point represents, prior to the smoothing, so thus we can observe the distribution of votes rather than the preference-turnout relationship of electoral wards.\n\n* The [DrDigit Python package](https:\/\/github.com\/brezniczky\/drdigit\/) (feel free to contribute!, see [Issue #1](https:\/\/github.com\/brezniczky\/drdigit\/issues\/1) - there are many methods that could be put to a package, you are welcome to report bugs, share thoughts, experiences etc.)","d5ef06f6":"First of all, I am not a statistician, but an enthusiastic hobbyist. Expect humps, bumps and speculations :)\n\n# Brief motivation\/context\n\nIt's about taking a look at Austrian data, but at the same time a demo of a (very early version of a) package to help with the detection of digit doctoring, also playing with theories, and a bit of motivation for you to **do your share and keep an eye on your local elections**.\n\nAt the time writing, four countries will hold elections in the aftermath of the 2019 European Parliamentary elections, within two months' time.\n\nThree of these are interesting in the sense that populist parties have gained a huge influence in each, and potential for Russian influence could be easily identified for each one as well. Of course, it can easily happen that there is some other influence, and that one is higher.\n\nThese examinations may be far from a scientific quality, but what better than building conspiracy theories on top of numbers over the weekend? :)\n\n## The elections to prepare for, three countries to pick from\n\n1. Hungary, 13th October - e.g. see [\"Moscow's trojan horse\"](https:\/\/www.foreignaffairs.com\/articles\/central-europe\/2014-08-06\/moscows-trojan-horse) from 2014, by Jan Werner-M\u00fcller, professor at Princeton, about Fidesz, the most popular (?) Hungarian party\n2. Poland, 13th October - e.g. PiS, the most popular Polish party, is very much a populist party, and with very good ties with Fidesz, albeit not pro-Russia (although being openly that would be kind of a political suicide there I suppose)\n3. Austria, 29th September - e.g. see the [Strache scandal](https:\/\/en.wikipedia.org\/wiki\/Ibiza_affair): someone really thought that the Russians are among the go-to people if you want to win an election\n\nThe most interesting and suspicious one is probably Hungary to the author. This country is left with what remains of the dossiers documenting the ex-members of the local soviet era secret police members held secret (allegedly, with more complete copies in Moscow ;) ). That might mean Russia remains to hold an unknown degree of influence there, and a sizeable potential for blackmailing, not only for them. The proposal for these to be published has been downvoted [at least 18 times](https:\/\/24.hu\/kozelet\/2018\/10\/30\/tizennyolcadszor-is-leszavazta-a-fidesz-az-ugynokaktak-nyilvanossagat\/) by now by our esteemed Fidesz party, which has turned into a pro-Russia rightwing whatever from a once liberal-civic party, around the time an alleged amount of kompromats have allegedly [moved from maffia into Russian hands](https:\/\/atlatszo.hu\/2017\/02\/14\/valtozatok-egy-kompromatra\/). Of course, our second most popular party is also an interesting one, likely infiltrated by [Russian spies](https:\/\/444.hu\/tag\/kgbela). Interdepartmental competition? :) So many popssibilities. They both voted on the extension of the Paks nuclear power plant by Rosatom in 2014, in those turbulent years when sustainable energy was already showing a rapid global spreadth, and exponential price falls made it nearly obvious (except for a large percentage of the way overpaid slow thinkers in the Hungarian Parliament) that it'll soon be almost impossible to justify not preferring it over the nuke.\n\nWell, who knows.\n\nThe second one would be Poland. Not too sure about the state of such dossiers there, but such strategic artifacts not turning completely to light was surely in the best interests of the leaving Soviet forces. And there are all sorts of suspicions about a sad incident, [the Smolensk air disaster, 2010](https:\/\/en.wikipedia.org\/wiki\/Smolensk_air_disaster) of the not too distant past.\n\nThe third one is Austria, definitely never part of the USSR (still close to the borders :) also subject to multiple waves of immigration - of course, including an influx from ex-soviet states, including I suppose Eastern Germany).\n\nOkay, beyond crazy theories, I guess it is just a nice idea to reflect on potential discrepancies in the quality of counted votes at least, in expectation of these coming elections, in the case of the very recently concluded EP ones. The below approach can help highlighting areas where the vote counting quality at least is likely to have gone unusually far South, and may do so again soon.\n\nHaving had a go at the first two (see links at the bottom if interested), Austria is the final one in the series of countries to be taken a look at before any other.\n\n(Portugal will also hold elections on the 6th of October, but I have even fewer reasons to suspect anything there than in Austria... or probably the Antarctica :) )","664b46d6":"# Wild thoughts\n\nNot sure if there's anything to notice on these charts at this stage - the best data found to date from Austria is much much less detailed (consists of fewer records) than that from Poland (data for >20k wards) or Hungary (~13k electoral wards).\n\nFrom this little amount, we could (had we been able to rule out suspicious correlations) conjecture that the contrast between more and less suspicious areas would look very odd for \u00d6VP, and there may even be a bit of smudge in the high share\/high turnout corner, but this can all easily be down to some spurious correlation and the hectics of a Gaussian kernel being used in the distribution estimation.\n\nBut if we stick with wanting to notice things...:\n\nThe vote shares from less to more suspicious\n\n* \u00d6VP: \ud83d\ude0a improve a lot\n* SP\u00d6: \ud83d\ude1e worsen a lot \n* FP\u00d6: = roughly stagnate\n\nInterestingly, the top suspicious areas seem to exhibit much more multimodality than the less suspicious ones.\n\nA few things should be noted:\n- It was hard to see what was happening on the final plots, using kernel smoothing on the plots helped a lot (it was much worse before ...), and top candidates look interesting - if there was a somewhat well designed electoral fraud, carried out by a larger number of people, that could very easily look like this! The patterns could be explained, for instance, by a virtual ballot stuffing (doctoring), that then clearly favoured \u00d6VP, disfavoured SP\u00d6, but how invented numbers would go unnoticed by the counting system - I cannot comment on that.\n- It is very interesting that the top suspect charts are very visibly more multimodal than the bottom ones. It would be very interesting to color these plots to see if these clusters are due to something trivial, such as ward count correlated with political preference, perhaps alongside geographical location (such as in case of Poland) or municipality size.\n- One thing to check is whether Vienna results tended to appear towards the end of the list. It seemed like that after a very quick glance. This, similary to the previous point, may mean that some practically noticeable bias is still there in the ranking (this is not at all a finished branch of the explorations yet). However, \"loner\" wards are probably okay to get a high probablility score such as 1.0, and parts of Vienna effectively seem to form standalone 1-ward groups in the data when examined by groups formed of those defined by equality of the first four characters of GKZ codes, so then that explains the phenomenon.\n\n# Conclusion\n\nWhilst I could detail wild theories, such as a botnet of vote counters (I sincerely think something similar is a possibility in Hungary) - one problem with voluntary vote counting is that it's probably easy to infiltrate - I guess it's best to both wait to see more clearly, for others opinion (esp. people capable of cross-checking these with geopolitical specifics, if that at all seems for worthwhile for them to do), as well as to just continue with looking into the details behind these shiny (yes I can create even uglier ones! :D) but very possibly deceiving plots.\n\nWhat I would raise is that it appears as if \u00d6VP's results were recorded with a slight bit of undue sloppiness.\n\n(Oh yes, and please note that there is a lot of testing and bug hunting ahead!)","a3f71593":"As we may notice, the plots change both in degree of dispersion and mean value as we progress from top to bottom suspects, for each three examined parties.","556a06c5":"# A quick assessment of the 2019 Austrian EP election results\n\n#### J\u00e1nos Brezniczky\n\n\"People, Not Technology, Weakest Security Link\" - Kevin Mitnick\n\n#### Last updated: 31\/08\/2019","36cf8d4d":"# Preprocessing","a5b54653":"# 1. Initial assessment\n\nA test only reliant on the last digits of the numbers is employed to narrow down which parties' results may have been tampered with or treated with less love and care towards accuracy.","e5582626":"The below plots present how the distribution of the votes for the top suspects (0% to 50% of the ranking) is different from that in case of the bottom suspects.","6759ee3b":"# 3. (Weighted) fingerprint plots\n\nElection fingerprint plots depict (expect a patch) how the voter turnout and a party's vote share relate to each other.\nThis party is recommended to be the winner. Weighting these by the actual votes gives us a picture of how the actual vote volume is distributed over the (turnout, vote share) coordinates, relating to where the votes come from.\n\nBelow is a brief explanation of some distortions, which would appear as a smearing of the \"patch\", we could look for.\n\nThe concept of this analysis is that if we are lucky, one or more of these smears are correlated with the regularity score in one way or another.","d2146217":"By the way, it is possible to check the help of the functions in the package - feel free to gather more understanding in that way:","57940878":"<a id=\"ref_2\"><\/a>\n\n# 2. Scoring and ranking\n\nWell, we could say that that isn't significantly unusual and we'd be right to a good degree.\n\nHowever, sometimes it is just difficult to look at the right segment of the data where things become more characteristic, so I won't just stop here.\n\nLet's score and rank the \u00d6VP based column contents where the tests seemed to suggest a higher chance of detectable tampering.\n\nI chose the by row filtered data because - although it comes up slightly more regular - it is just bigger."}}