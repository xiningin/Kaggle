{"cell_type":{"00f57713":"code","df4877a0":"code","b4060430":"code","23f225cb":"code","341900be":"markdown","c0fd9b8e":"markdown","028f404f":"markdown"},"source":{"00f57713":"import glob\n\nimport pandas as pd\n\nimport pydicom\n\nimport tqdm","df4877a0":"# Paths\ninput_path = \"..\/input\/rsna-intracranial-hemorrhage-detection\"\ntrain_imgs = glob.glob(f\"{input_path}\/stage_1_train_images\/*\")","b4060430":"def save_value(img_data, name, value):\n    if type(value) == pydicom.multival.MultiValue:\n        for i, j in enumerate(value):\n            save_value(img_data, f\"{name}_{i}\", j)\n    else:\n        if type(value) == pydicom.uid.UID:\n            value = str(value)\n        elif type(value) == pydicom.valuerep.DSfloat:\n            value = float(value)\n        img_data[name] = value\n\ndef get_data_dict(img):\n    img_data = {}\n    for i in img.iterall():\n        if i.name == \"Pixel Data\":\n            continue\n        name = i.name.replace(\" \", \"_\").replace(\"(\", \"\").replace(\")\", \"\").lower()\n        save_value(img_data, name, i.value)\n    return img_data\n\ndef get_list_data(imgs):\n    list_data = []\n    for i in tqdm.tqdm(imgs):\n        img = pydicom.read_file(i)\n        img_data = get_data_dict(img)\n        list_data.append(img_data)\n    return list_data\n\ndef get_df_data(imgs):\n    list_data = get_list_data(imgs)\n    return pd.DataFrame(list_data)\n\ndf_imgs = get_df_data(train_imgs)\ndf_imgs.head()","23f225cb":"df_imgs.to_csv(\"df_dicom_metadata.csv\", index=False)","341900be":"# Read loop","c0fd9b8e":"# Save output","028f404f":"Let's create a CSV with all the metadata of the DICOM images so we can do a better analysis of that data.\n\n# Import"}}