{"cell_type":{"ce36c8d6":"code","6dfd5489":"code","508bac0a":"code","6261f8c7":"code","a61c48e8":"code","93b1a06c":"code","85504484":"code","5dcdaa4a":"code","a7906d29":"code","31ae80c9":"code","7e18dccf":"code","5d23607c":"code","f8542b24":"code","da70a813":"code","70d909f6":"code","35315cbf":"code","395b93cb":"code","d7e8a10e":"code","15379485":"code","52d39762":"code","3381906b":"code","3576c5a5":"code","14c45d93":"code","80c34c26":"code","fcdf836e":"markdown","d1a77fb9":"markdown","9ddde53d":"markdown","d6f93658":"markdown","8d687e3a":"markdown","64c07ed8":"markdown","81f4ab5a":"markdown","2726b024":"markdown","22d5bdcd":"markdown","fb9cc27c":"markdown","b2c4f85e":"markdown","9aa3f94e":"markdown","4fc7fe73":"markdown","88526162":"markdown","74041e04":"markdown","276393fa":"markdown"},"source":{"ce36c8d6":"import numpy as np\nimport pandas as pd","6dfd5489":"!pip install fastai2","508bac0a":"!pip install fastcore==0.1.35 ##Currently supported with fastai2","6261f8c7":"import fastcore\nfastcore.__version__","a61c48e8":"import fastai2\nfastai2.__version__","93b1a06c":"from fastai2.tabular.all import *","85504484":"df_test= pd.read_csv('\/kaggle\/input\/titanic-extended\/test.csv')\ndf_train= pd.read_csv('..\/input\/titanic-extended\/train.csv')\ndf_train.head()","5dcdaa4a":"df_train.describe()","a7906d29":"df_train.isnull().sum().sort_index()\/len(df_train)","31ae80c9":"df_train.dtypes\ng_train =df_train.columns.to_series().groupby(df_train.dtypes).groups\ng_train","7e18dccf":"cat_names= [\n        'Name', 'Sex', 'Ticket', 'Cabin', \n        'Embarked', 'Name_wiki', 'Hometown', \n        'Boarded', 'Destination', 'Lifeboat', \n        'Body'\n]\n\ncont_names = [ \n    'PassengerId', 'Pclass', 'SibSp', 'Parch', \n    'Age', 'Fare', 'WikiId', 'Age_wiki','Class'\n ]\n\n","5d23607c":"splits = RandomSplitter(valid_pct=0.2)(range_of(df_train))\n\nto = TabularPandas(df_train, procs=[Categorify, FillMissing,Normalize],\n                   cat_names = cat_names,\n                   cont_names = cont_names,\n                   y_names='Survived',\n                   splits=splits)","f8542b24":"#df_train.dtypes\ng_train =to.train.xs.columns.to_series().groupby(to.train.xs.dtypes).groups\ng_train","da70a813":"to.train.xs.Age_na.head()","70d909f6":"to.train","35315cbf":"to.train.xs","395b93cb":"to.train.ys.values.ravel()","d7e8a10e":"from sklearn.ensemble import RandomForestClassifier\n\nX_train, y_train = to.train.xs, to.train.ys.values.ravel()\nX_valid, y_valid = to.valid.xs, to.valid.ys.values.ravel()","15379485":"X_train.head()","52d39762":"rnf_classifier= RandomForestClassifier(n_estimators=100, n_jobs=-1)\nrnf_classifier.fit(X_train,y_train)","3381906b":"y_pred=rnf_classifier.predict(X_valid)\n\n\nfrom sklearn.metrics import accuracy_score\n\naccuracy_score(y_pred, y_valid)","3576c5a5":"g_train =df_test.columns.to_series().groupby(df_test.dtypes).groups\n\ncat_names= [\n        'Name', 'Sex', 'Ticket', 'Cabin', \n        'Embarked', 'Name_wiki', 'Hometown', \n        'Boarded', 'Destination', 'Lifeboat', \n        'Body'\n]\n\ncont_names = [ \n    'PassengerId', 'Pclass', 'SibSp', 'Parch', \n    'Age', 'Fare', 'WikiId', 'Age_wiki','Class'\n ]","14c45d93":"test = TabularPandas(df_test, procs=[Categorify, FillMissing,Normalize],\n                   cat_names = cat_names,\n                   cont_names = cont_names,\n                   )\n\nX_test= test.train.xs\n\nX_test.dtypes\ng_train =X_test.columns.to_series().groupby(X_test.dtypes).groups\n\nX_test= X_test.drop('Fare_na', axis=1)\n\ny_pred=rnf_classifier.predict(X_test)\ny_pred= y_pred.astype(int)","80c34c26":"output= pd.DataFrame({'PassengerId':df_test.PassengerId, 'Survived': y_pred})\noutput.to_csv('my_submission_titanic.csv', index=False)\noutput.head()","fcdf836e":"using the same for target value","d1a77fb9":"# Top1%: FastAI Beginner Tutorial","9ddde53d":"# Submission","d6f93658":"#  Importing and Loading files","8d687e3a":"# TabularPandas","64c07ed8":"Using RandomForestClassifier for solving this problem\n\nand taking out X_train and y_train values like we showed before\n","81f4ab5a":"Just taking abit statistical look into data.","2726b024":"Generally what happens is, we cannot use the output of tabularpandas straightaway. So we need to access it as follows.. just taking peek at train data(for validation data replace train with valid)","22d5bdcd":"using 'xs' to get the table in the manner we are used to see it. Notice that it is without 'Survived' column","fb9cc27c":"We have table without any hardcore preprocessing all we did was just to use fastai tabular function to get this","b2c4f85e":"Here you can see 'Age_na', 'WikiId_na', 'Age_wiki_na', 'Class_na' . Which were created becoz their columns had missing values","9aa3f94e":"We just Trained randomforest classifier and predicting accuracy on validation set","4fc7fe73":"# Install FastAI","88526162":"Getting names of columns according to its datatype.\n\nThis will allow us to understand which feature is int, float, and object(categorical)\n","74041e04":"Calculating the average null values we have in our data. It is important to know. Just to get intuition about data ","276393fa":"Now this might be a bit puzzling if you are new to fastai. And its completely alright.\n\ncat_names refers to the features which are categorical.\n\ncont_names refers to the features which are continuous. For example : int and float\n\nfastai needs them in order to do preprocessing for you properly\n"}}