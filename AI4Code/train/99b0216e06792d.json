{"cell_type":{"746f13f0":"code","6d5a62e8":"code","bee8a979":"code","8b498344":"code","018aa3f6":"code","6f72594a":"code","2e602457":"code","e2c74f7e":"code","82b5f4a1":"code","a0d9e3d9":"code","58263afe":"code","b677c9a9":"code","c22052e2":"code","eacc5cb8":"code","64d84050":"code","e0424129":"code","bb649329":"code","09133c50":"code","19fc26a7":"code","fcc764ae":"code","c534858f":"code","eb60b308":"code","69e989f4":"code","76bd2640":"code","7988e0e5":"code","88f8d9ac":"code","398785e3":"code","16277f71":"code","8debf99a":"code","6220a2be":"code","005fce55":"code","679ef4a0":"code","33b99853":"code","fa48d8b1":"code","4e5b1aa7":"code","5dd80860":"code","a5a01d4f":"code","331274ae":"code","0c834ed8":"code","6e4b3a20":"code","f4ca89d0":"code","2211e1d4":"code","6f5a951c":"code","137ea510":"code","8fd6d5b4":"markdown","67494690":"markdown","e90c867a":"markdown","23b0c849":"markdown","cfdd07e4":"markdown","6bf0b571":"markdown","37e99314":"markdown","d4524aa4":"markdown","c87bf3f7":"markdown","06109592":"markdown","e1ae2b8f":"markdown","ffe9a6dd":"markdown","427a2bc8":"markdown","87fd2bcf":"markdown","900f2d7c":"markdown","32cead73":"markdown"},"source":{"746f13f0":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","6d5a62e8":"!pip install cmapPy\nfrom cmapPy.pandasGEXpress.parse import parse","bee8a979":"data = parse('\/kaggle\/input\/data-analyst-intern\/data_analyst_intern\/PAAD.gct')\nprint(type(data))","8b498344":"# Read all portion of data\ncol_meta_data = data.col_metadata_df\nrow_meta_data = data.row_metadata_df\nmy_data = data.data_df","018aa3f6":"# Columns meta data\ncol_meta_data.head()","6f72594a":"# Shape of columns metadata\ncol_meta_data.shape","2e602457":"# Number of missing values in each column of col_meta_data\nmissing_val_count_by_column = (col_meta_data.isnull().sum())\nmissing_val_count_by_col = missing_val_count_by_column[missing_val_count_by_column > 0].sort_values(ascending=False)\nprint(f\"Total {len(missing_val_count_by_col)} columns have missing value, and\",\n      f\"Total {col_meta_data.isnull().sum().sum()} missing values in dataset\")\nplt.figure(figsize=(10, 7))\nsns.countplot(data=missing_val_count_by_col, y= missing_val_count_by_col )","e2c74f7e":"# Explore each columns of col_meatadata\nfor col in col_meta_data.columns:\n    print(f\"{col}:   {len(col_meta_data[col].unique())} unique values:\")","82b5f4a1":"# drop columns which have constant value\nfor col in col_meta_data.columns:\n    if len(col_meta_data[col].unique())<2:\n        col_meta_data.drop(columns=col, inplace=True)\n","a0d9e3d9":"col_meta_data.shape","58263afe":"col_meta_data.adenocarcinoma_invasion.value_counts()","b677c9a9":"conts_mRNA = col_meta_data.mRNAseq_cluster.value_counts()\nplt.figure(figsize=(10,4))\nsns.barplot(x=conts_mRNA.index,y=conts_mRNA.values,)\nplt.ylabel('Number of Patient')\nplt.xlabel('RNA sequence cluster Types')\nplt.title('levels of individual isoforms')\nplt.legend()\nfor i, index in enumerate(conts_mRNA.index):\n    val = conts_mRNA.values[i]\n    val_pcn = round(((val)\/sum(conts_mRNA.values))*100, 2)\n    print(f\"RNA sequence cluster:{index} types patient is {val_pcn}% of total \")","c22052e2":"mRNA_seq_group = col_meta_data.groupby(['mRNAseq_cluster', 'vital_status'])['vital_status'].count().reset_index(name='counts')\nplt.figure(figsize=(10, 5))\nsns.barplot(x='mRNAseq_cluster', y='counts', hue='vital_status', data=mRNA_seq_group)\nplt.ylabel('Number of Patient')\nplt.xlabel('RNA sequence cluster Types')\nplt.title('Vital status of patient by mRNA sequence cluster types ')","eacc5cb8":"for cluster_type in mRNA_seq_group.mRNAseq_cluster.unique():\n    data = mRNA_seq_group[mRNA_seq_group.mRNAseq_cluster==cluster_type]\n    live_pcn = round((data[data['vital_status']=='alive']['counts']\n                      \/sum(data.counts.values))*100, 2)\n    dead_pcn = round((data[data['vital_status']=='dead']['counts']\/\n                     sum(data.counts.values))*100, 2)\n    print(f\"mRNAseq_cluster type {cluster_type} patient dead {dead_pcn.values[0]}% times\")\n    print(f\"mRNAseq_cluster type {cluster_type} patient alive {live_pcn.values[0]}% times\")\n    print(\"\\n\")\n    \n    ","64d84050":"col_meta_data.sample_type.value_counts()","e0424129":"sample_type_group = col_meta_data.groupby(['sample_type', 'vital_status'])['vital_status'].count().reset_index(name='counts')\nplt.figure(figsize=(8, 3))\nsns.barplot(x='sample_type', y='counts', hue='vital_status', data=sample_type_group)\nplt.ylabel('Number of Patient')\nplt.xlabel('Types of cancer')\nplt.title('Vital status vs cancer type ')","bb649329":"col_meta_data.adenocarcinoma_invasion.value_counts()","09133c50":"sns.catplot(x='vital_status', y='maximum_tumor_dimension', hue='sample_type', data=col_meta_data)","19fc26a7":"sns.boxplot(x='vital_status', y='maximum_tumor_dimension', data=col_meta_data)","fcc764ae":"col_meta_data.pathologic_stage.value_counts()","c534858f":"pathologic_stage_group = col_meta_data.groupby(['pathologic_stage', 'vital_status'])['vital_status'].count().reset_index(name='counts')\nplt.figure(figsize=(10, 5))\nsns.barplot(x='pathologic_stage', y='counts', hue='vital_status', data=pathologic_stage_group)","eb60b308":"\npathologic_m_group = col_meta_data.groupby(['pathologic_m', 'vital_status'])['vital_status'].count().reset_index(name='counts')\nplt.figure(figsize=(10, 5))\nsns.barplot(x='pathologic_m', y='counts', hue='vital_status', data=pathologic_m_group)","69e989f4":"\npathologic_n_group = col_meta_data.groupby(['pathologic_n', 'vital_status'])['vital_status'].count().reset_index(name='counts')\nplt.figure(figsize=(10, 5))\nsns.barplot(x='pathologic_n', y='counts', hue='vital_status', data=pathologic_n_group)","76bd2640":"pathologic_t_group = col_meta_data.groupby(['pathologic_t', 'vital_status'])['vital_status'].count().reset_index(name='counts')\nplt.figure(figsize=(10, 5))\nsns.barplot(x='pathologic_t', y='counts', hue='vital_status', data=pathologic_t_group)","7988e0e5":"print(row_meta_data.index[:5])\nprint(row_meta_data.shape)\nrow_meta_data.head()","88f8d9ac":"my_data.head()","398785e3":"# Number of missing values in each column of my data\nmissing_val_count_by_column = (my_data.isnull().sum())\nmissing_val_count_by_col = missing_val_count_by_column[missing_val_count_by_column > 0].sort_values(ascending=False)\nprint(f\"Total {len(missing_val_count_by_col)} columns have missing value, and\",\n      f\"Total {my_data.isnull().sum().sum()} missing values in dataset\")\nplt.figure(figsize=(10, 7))\nsns.countplot(data=missing_val_count_by_col, y= missing_val_count_by_col )","16277f71":"from sklearn.impute import SimpleImputer\nmy_imputer = SimpleImputer()\nimputed_my_data = pd.DataFrame(my_imputer.fit_transform(my_data))\n\n# Fill in the lines below: imputation removed column names; put them back\nimputed_my_data.columns = my_data.columns\nimputed_my_data.index = my_data.index\n\nimputed_my_data.head()","8debf99a":"print(len(my_data.columns.unique()))\nprint(len(col_meta_data.index.unique()))\n# Lets combine col_meta_data and my_data","6220a2be":"col_to_merge = ['sample_type', 'mRNAseq_cluster','adenocarcinoma_invasion', 'vital_status', 'maximum_tumor_dimension', 'pathologic_stage', 'pathologic_m', 'pathologic_n', 'pathologic_t']\nparticipant_id = col_meta_data.participant_id\ntarget_variable = col_meta_data.sample_type\ncol_meta_data = col_meta_data.set_index('participant_id')\nimputed_my_data = imputed_my_data.rename(columns=participant_id).T\n#imputed_my_data = imputed_my_data.join(col_meta_data[col_to_merge])\nimputed_my_data.head()","005fce55":"for col in col_to_merge:\n    imputed_my_data[col] = col_meta_data[col]\nimputed_my_data.head(2)","679ef4a0":"def cat_to_numeric(x):\n    if x=='Solid Tissue Normal':\n        return 0\n    elif x=='Primary solid Tumor':\n        return 1\n    else:\n        return 2\ntarget_variable = target_variable.map(lambda x: cat_to_numeric(x))\ntarget_variable.value_counts().plot(kind='bar')","33b99853":"def remove_nulls(df):\n\n    rows = df.shape[0]\n    columns = df.shape[1]\n    null_cols = 0\n    list_of_nulls_cols = []\n    for col in list(df.columns):\n        null_values_rows = df[col].isnull().sum()\n        null_rows_pcn = round(((null_values_rows)\/rows)*100, 2)\n        col_type = df[col].dtype\n        if null_values_rows > 0:\n            print(\"The column {} has {} null values. It is {}% of total rows.\".format(col, null_values_rows, null_rows_pcn))\n            print(\"The column {} is of type {}.\\n\".format(col, col_type))\n            null_cols += 1\n            list_of_nulls_cols.append(col)\n            df[[col]] = df[[col]].apply(lambda x: x.fillna(method='backfill'))\n            print(f\"The column {col} has removed {null_values_rows} null values\")\n    null_cols_pcn = round((null_cols\/columns)*100, 2)\n    print(\"The DataFrame has {} columns with null values. It is {}% of total columns.\".format(null_cols, null_cols_pcn))\n    return df\n\nmy_data = remove_nulls(imputed_my_data.select_dtypes(exclude='object'))","fa48d8b1":"imputed_my_data.isnull().sum().sum()","4e5b1aa7":"\nfrom sklearn.preprocessing import StandardScaler\nX_std = StandardScaler().fit_transform(imputed_my_data.drop(columns=col_to_merge))\n\nfrom sklearn.decomposition import PCA as sklearnPCA\nn_components = 100\nsklearn_pca = sklearnPCA(n_components=n_components)\nY_sklearn = sklearn_pca.fit_transform(X_std)","5dd80860":"cum_sum = sklearn_pca.explained_variance_ratio_.cumsum()\n\nexplained_var = round(sklearn_pca.explained_variance_ratio_.sum()*100, 2)\n\ncum_sum = cum_sum*100\n\nfig, ax = plt.subplots(figsize=(8,8))\nplt.bar(range(n_components), cum_sum, label='Cumulative _Sum_of_Explained _Varaince', color = 'b',alpha=0.5)\nplt.title(f\"Around {explained_var}% of variance is explained by the Fisrt {n_components} principle component \");","a5a01d4f":"from sklearn.decomposition import PCA as sklearnPCA\nsklearn_pca = sklearnPCA(n_components=3)\nX_reduced  = sklearn_pca.fit_transform(X_std)\nY=target_variable\nfrom mpl_toolkits.mplot3d import Axes3D\nplt.clf()\nfig = plt.figure(1, figsize=(10,6 ))\nax = Axes3D(fig, elev=-150, azim=110,)\nax.scatter(X_reduced[:, 0], X_reduced[:, 1], X_reduced[:, 2],cmap=plt.cm.Paired,linewidths=10)\nax.set_title(\"First three PCA directions\")\nax.set_xlabel(\"1st eigenvector\")\nax.w_xaxis.set_ticklabels([])\nax.set_ylabel(\"2nd eigenvector\")\nax.w_yaxis.set_ticklabels([])\nax.set_zlabel(\"3rd eigenvector\")\nax.w_zaxis.set_ticklabels([])","331274ae":"fig = plt.figure(1, figsize=(10,6))\nsns.scatterplot(X_reduced[:, 0],  X_reduced[:, 1],hue=Y)\nplt.title(\"This The 2D Transformation of above graph \")","0c834ed8":"imputed_my_data = imputed_my_data[imputed_my_data['adenocarcinoma_invasion']=='yes']\nimputed_my_data.shape","6e4b3a20":"ifn_sig = pd.read_csv('\/kaggle\/input\/data-analyst-intern\/data_analyst_intern\/type1_IFN.txt', header=None)\nifn_sig.columns = ['member']\nifn_sig.head()","f4ca89d0":"ifn_sig_data = imputed_my_data[ifn_sig['member'].to_list()]\nifn_sig_data.shape","2211e1d4":"X_std = StandardScaler().fit_transform(ifn_sig_data)\nn_components = 2\nsklearn_pca = sklearnPCA(n_components=n_components)\nX_reduced  = sklearn_pca.fit_transform(X_std)\nfig = plt.figure(1, figsize=(10,6))\nsns.scatterplot(X_reduced[:, 0],  X_reduced[:, 1],hue=imputed_my_data['sample_type'])\n","6f5a951c":"!pip install gsva\nfrom GSVA import gsva\nfrom plotnine import *\nfrom sklearn.manifold import TSNE","137ea510":"XV = TSNE(n_components=2).\\\n    fit_transform(ifn_sig_data.T)\ndf = pd.DataFrame(XV).rename(columns={0:'x',1:'y'})\n(ggplot(df,aes(x='x',y='y'))\n + geom_point(alpha=0.2)\n)","8fd6d5b4":"**Interferons (IFNs)** are a group of signaling proteins made and released by host cells in response to the presence of several pathogens, such as viruses, bacteria, parasites, and also tumor cells. Type I interferons (IFNs) are a large subgroup of interferon proteins that help regulate the activity of the immune system. The genes responsible for type 1 Interferons is called Type 1 IFN signature and consists a set of 25 genes in homo sapiens.\n\nLet's read these 25 IFN signature","67494690":"on average which has higher tumor dimension are most likely to dead.","e90c867a":"the neuroendocrine tumors clearly not separable from the adenocarcinoma tumors?\n# 2\nLets Remove the neuroendocrine tumors from the dataset so that it contains only the adenocarcinoma tumor samples. The histology for the different tumor samples is contained in the my_data.","23b0c849":"### What can be said about the variance of the PCA?","cfdd07e4":"Columns metadata explain about behaviour of patient. Lets see the description of some variables of this data.\n* **sample_type** is our **target variable** which tells that which patient have cancer tumor or not.\n* **participant_id** unique value for each patient.\n* **mRNAseq_cluster**  estimates of the levels of individual isoforms within the cell of RNA sequence.\n* **bcr_patient_barcode** and **bcr_patient_uuid** representing the metadata of the participants and their samples.\n* **vital_status** Current status of patient(live\/death). (may pose data leakage)\n* **adenocarcinoma_invasion** Tells about cancer grows and spreads to near cell or not.\n* **maximum_tumor_dimension** Size of Tumor, tumor size is strongly related to chances for survival.\n* **pathologic_stage** Stage of cancer (amount or spread of cancer in the body)\n* **pathologic_m** The M refers to whether the cancer has metastasized. This means that the cancer has spread from the primary tumor to other parts of the body\n* **pathologic_n** The N refers to the the number of nearby lymph nodes that have cancer.\n* **pathologic_t** The T refers to the size and extent of the main tumor. The main tumor is usually called the primary tumor.\n\nLet's explore some variables:","6bf0b571":"* **The T refers** to the size and extent of the main tumor. The main tumor is usually called the primary tumor.\n* **The N refers** to the the number of nearby lymph nodes that have cancer.\n* **The M refers** to whether the cancer has metastasized. This means that the cancer has spread from the primary tumor to other parts of the body.\n* majority of patient have **pathologic_t3** and **pathologic_n1** types stages.","37e99314":"### Visualize the data whole data using PCA.","d4524aa4":"### Load Dataset","c87bf3f7":"Approx every patient cancer grows and spreads into body cells.","06109592":"this rid show the types of RNA sequence(18465 different types of RNA seq).","e1ae2b8f":"**pathologic stages are as follow:**\n* **stage 0:** Abnormal cells are present but have not spread to nearby tissue.Data set have not this stage because approx all **adenocarcinoma_invasion ** value is True.\n* **stage i**, **stage ii**,**stage iii** Cancer is present. The higher the number, the **larger the cancer tumor** and the more it has spread into nearby tissues.\n* **stage iv** The cancer has spread to distant parts of the body.\n","ffe9a6dd":"Types of tumer not play role in current vital status of patient. There is 50-50 chance of patient are currently alive or dead","427a2bc8":"# Data Exploration\n\n* Here we have a dataset of normalized RNA Sequencing reads for pancreatic cancer tumors. The measurement consists of ~20,000 genes for 183 pancreatic cancer tumors. The **file format is GCT** , a tab-delimited file used for sharing gene expression data and metadata (details for each sample) for samples.\n* **GCT file:** The GCT file format, a tab-delimited text-based format pairing matrix expression values with row and column metadata, allowing comparison of both transcriptional and contextual differences across samples. A schematic of a sample GCT file is pictured below.\n![gct data format](https:\/\/github.com\/cmap\/cmapPy\/raw\/f3fdf016095bb08d9402ec9b6d3ebf6e603d20a1\/tutorials\/GCT_mockup.png)\nLet's dive into data, and explore it.","87fd2bcf":"Here we parse our dataset into GCToo pandas dataframe instance which contains 3 component dataframes (row_metadata_df, column_metadata_df, and data_df). Lets see individual dataframe and explore it. ","900f2d7c":"Clearly 65% of time patient are dead if mRNAseq_cluster type is 1 and 3.\nmRNAseq_cluster 1, 3, 4 are risky types then 2, 5 ","32cead73":"# Introduction\nThis notebook is a part of Assignment provided by Elucidata for 6 months internship in data science.\n\nThe motive of this notebook is to explore and analyse the **cancers patient** based on their **genes structure**.\n\n### Cancers\n1. Cancer arises from the transformation of normal cells into tumour cells in a multistage process that generally progresses from a pre-cancerous lesion to a malignant tumour. \n\n1. Cancer is a leading cause of death worldwide, accounting for an estimated 9.6 million deaths in 2018. The most common cancers are:\n * Lung (2.09 million cases)\n * Breast (2.09 million cases)\n * Colorectal (1.80 million cases)\n * Prostate (1.28 million cases)\n * Skin cancer (non-melanoma) (1.04 million cases)\n * Stomach (1.03 million cases)\n1. **Pancreatic Adenocarcinoma (PAAD)** is the third most common cause of death from cancer, with an overall 5-year survival rate of less than 5%, and is predicted to become the second leading cause of cancer mortality in the United States by 2030.\n1. Cancer mortality can be reduced if cases are detected and treated early. In this assignment we are going to analyse the previous data of **genes structure** to detect the cancer patient and provide early treatment.\n1. **Genes Structures**: **Ribonucleic acid (RNA)** is a polymeric molecule essential in various biological roles in coding, decoding, regulation and expression of genes. RNA and DNA are nucleic acids, and, along with lipids, proteins and carbohydrates, constitute the four major macromolecules essential for all known forms of life. **RNA-Seq (RNA sequencing)**, is a sequencing technique to detect the quantity of RNA in a biological sample at a given moment.\n"}}