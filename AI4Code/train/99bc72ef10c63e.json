{"cell_type":{"91635201":"code","3f55f962":"code","5a479465":"code","5eae702f":"code","5eb978b1":"code","76892e32":"code","76068d19":"code","8d1da901":"code","ae151a92":"code","f91aadc5":"code","b21a001a":"code","93b52bd0":"code","95c98246":"markdown","442bdcbd":"markdown","98c61f4b":"markdown","3bfa9925":"markdown","af41a6ae":"markdown","efd71872":"markdown","3d0c8f8d":"markdown","e383229e":"markdown","ea9f5e77":"markdown","04f84c40":"markdown"},"source":{"91635201":"#Importing Necessary Libraries\nimport numpy as np \nimport pandas as pd \nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split # Import train_test_split function\nfrom sklearn import svm #Import svm model\nfrom sklearn import metrics #Import scikit-learn metrics module for accuracy calculation\nfrom sklearn.metrics import confusion_matrix,roc_curve,roc_auc_score,accuracy_score, plot_confusion_matrix,classification_report\n","3f55f962":"#Importing dataset\n\ndf = pd.read_csv('..\/input\/heartdataset\/heart.csv')","5a479465":"df.head()","5eae702f":"df.describe()","5eb978b1":"df.plot(kind = 'scatter',x = 'age', y = 'chol',alpha = 0.5, color = 'red')\nplt.xlabel('Age')\nplt.ylabel('Cholesterol')\nplt.title('Age-Cholesterol Plot')","76892e32":"x = df.drop('target',axis = 1) \ny = df.target","76068d19":"x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3,random_state=100)","8d1da901":"from sklearn.model_selection import GridSearchCV\nml = svm.SVC()\n\nparam_grid = {'C': [ 1, 10, 100, 1000,10000], \n              'gamma': [1,0.1,0.01,0.001,0.0001],\n              'kernel': ['rbf']} \ngrid = GridSearchCV(ml, param_grid, refit = True, verbose = 1,cv=15)\n\ngrid_search=grid.fit(x_train, y_train)","ae151a92":"print(grid_search.best_params_)\n","f91aadc5":"accuracy = grid_search.best_score_ *100\nprint(\"Accuracy for our training dataset with tuning is : {:.2f}%\".format(accuracy) )","b21a001a":"y_test_hat=grid.predict(x_test)\ntest_accuracy=accuracy_score(y_test,y_test_hat)*100\ntest_accuracy\nprint(\"Accuracy for our testing dataset with tuning is : {:.2f}%\".format(test_accuracy) )","93b52bd0":"confusion_matrix(y_test,y_test_hat)\ndisp=plot_confusion_matrix(grid, x_test, y_test,cmap=plt.cm.Blues)","95c98246":"> Details about Dataset\n\n1.age: The person\u2019s age in years\n\n2.sex: The person\u2019s sex (1 = male, 0 = female)\n\n3.cp: The chest pain experienced (Value 1: typical angina, Value 2: atypical angina, Value 3: non-anginal pain, Value 4: asymptomatic)\n\n4.trestbps: The person\u2019s resting blood pressure (mm Hg on admission to the hospital) chol: The person\u2019s cholesterol measurement in mg\/dl\n\n5.fbs: The person\u2019s fasting blood sugar (> 120 mg\/dl, 1 = true; 0 = false)\n\n6.restecg: Resting electrocardiographic measurement (0 = normal, 1 = having ST-T wave abnormality, 2 = showing probable or definite left ventricular hypertrophy by Estes\u2019 criteria)\n\n7.thalach: The person\u2019s maximum heart rate achieved\n\n8.exang: Exercise induced angina (1 = yes; 0 = no)\n\n9.oldpeak: ST depression induced by exercise relative to rest (\u2018ST\u2019 relates to positions on the ECG plot. See more here)\n\n10.slope: the slope of the peak exercise ST segment (Value 1: upsloping, Value 2: flat, \n\n11.Value 3: downsloping)\n\n12.ca: The number of major vessels (0-3)\n\n13.thal: A blood disorder called thalassemia (3 = normal; 6 = fixed defect; 7 = reversible defect)\n\n14.target: Heart disease (0 = no, 1 = yes)","442bdcbd":"# We will use medical data to predict if the person has heart disease or not.","98c61f4b":"**Finding Test-Model Accuracy**","3bfa9925":"**Exploratory Data Analysis**","af41a6ae":"**Fetching Best Hyperparameters**","efd71872":"29 patients were predicted that they will have Heart Disease,the Prediction was CORRECT (True-Positive)\n\n41 patients were predicted that they will NOT have Heart Disease,the Prediction was CORRECT \n(True-Negative)\n\n17 patients were predicted that they will have Heart Disease but the Prediction was WRONG (False-Positive)\n\n4 patients were predicted that they will NOT have Heart Disease but the Prediction was WRONG (False-Negative)","3d0c8f8d":"**Creating and Training SVM Classifier Modal**\n\nFor hyperparameter tuning we have 3 parameters to consider:\n\nKernel=rbf (radial basis function): kernel functions are used to map the original dataset (linear\/nonlinear ) into a higher dimensional space with a view to making it a linear dataset.\n\nC parameter: It is a hypermeter in SVM to control error. It acts as a penalty parameter, a small value of C will result in a larger margin separating the hyperplane. If we don\u2019t want our training points to be misclassified, then we go for a large value of C, which will result in a smaller margin separating plane, but it can lead to an overfitting problem where the model may not generalize well on training data.\n\nGamma parameter: This will decide the curvature of the decision boundary, higher the gamma, the greater is the curvature of the decision boundary.","e383229e":"**Splitting dataset into Train and Test Set**","ea9f5e77":"**Data Preprocessing**","04f84c40":"**Plotting a Confusion Matrix**"}}