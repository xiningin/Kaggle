{"cell_type":{"071d207e":"code","556c3753":"code","6ed41e68":"code","5f21d55e":"code","28dcdd08":"code","fee95244":"code","090f515b":"code","1f1b5cce":"code","eb2b4787":"code","d4aec400":"code","fc70d29a":"markdown","a87163e0":"markdown","b5d69de5":"markdown","d96a0a61":"markdown","a95bc5a5":"markdown","3eae1ab3":"markdown","ec9ad5ab":"markdown"},"source":{"071d207e":"import tensorflow as tf\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport IPython.display as display\nimport json","556c3753":"train_df = pd.read_csv('..\/input\/cassava-leaf-disease-classification\/train.csv')\ntrain_df.head()\n","6ed41e68":"train_df.label.value_counts()","5f21d55e":"(train_df.label.value_counts()\/train_df.shape[0])*100","28dcdd08":"labels_file = '..\/input\/cassava-leaf-disease-classification\/label_num_to_disease_map.json'\nf= open(labels_file)\nlabels = json.load(f)\nf.close()\nlabels","fee95244":"TRAIN_FILES = tf.io.gfile.glob('..\/input\/cassava-leaf-disease-classification\/train_tfrecords'+'\/*.tfrec')\nTRAIN_FILES","090f515b":"raw_dataset = tf.data.TFRecordDataset(TRAIN_FILES)\nraw_dataset","1f1b5cce":"for raw_record in raw_dataset.take(1):\n    example = tf.train.Example()\n    example.ParseFromString(raw_record.numpy())\n    print(example)","eb2b4787":"image_feature_description = {\n    \n    \"image\": tf.io.FixedLenFeature([],tf.string),\n    \"image_name\": tf.io.FixedLenFeature([],tf.string),\n    \"target\": tf.io.FixedLenFeature([],tf.int64)\n    \n}\n\ndef _parse_image_function(example_proto):\n    return tf.io.parse_single_example(example_proto, image_feature_description)\nparsed_image_dataset = raw_dataset.map(_parse_image_function)\nparsed_image_dataset","d4aec400":"count = {\n    '0':0,\n    '1':0,\n    '2':0,\n    '3':0,\n    '4':0\n}\n\ni=0\n\nfor image_features in parsed_image_dataset.take(200):\n\n    if i>=25:\n        break\n    image_raw = image_features['image'].numpy()\n    label = image_features['target'].numpy().astype(str)\n    if count[label]<5:\n        i+=1\n        print(i)\n        count[label]+=1\n        print(labels[label])\n        display.display(display.Image(data=image_raw))","fc70d29a":"Next: Training and inference on TPU using TF Records https:\/\/www.kaggle.com\/senkmp\/simple-tpu-training-and-inference-using-tf-records","a87163e0":"\ud83c\udf1d","b5d69de5":"Let me know if this notebook is helpful","d96a0a61":"**Data is higly imabalanced towards 'Cassava Mosaic Disease (CMD)'**","a95bc5a5":"## Load tf records","3eae1ab3":"## 5 image exapmples from each category","ec9ad5ab":"Know the feature desction of tfrecord files"}}