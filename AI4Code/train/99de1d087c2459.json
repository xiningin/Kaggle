{"cell_type":{"88284358":"code","8f38aa08":"code","840d7a42":"code","22d267a2":"code","ee5c88ca":"code","31390949":"code","2493c135":"code","b7713e08":"code","b9f6dc24":"code","aaf95573":"code","c8939c4f":"code","e52e4900":"code","44a0198e":"code","e7e6dadd":"code","3d2362ba":"code","95be25c5":"code","0e42ebd4":"code","1de916fa":"code","f2cdd027":"code","2d4c9723":"code","c2e7d3d3":"code","f7f62abe":"code","c844bbfa":"code","4e7a3468":"code","7bc5c877":"code","18045298":"code","f10ab763":"code","a408ca59":"code","16c74b8f":"markdown","33b2349f":"markdown","7a7a0025":"markdown","97c3702e":"markdown","dc1e7ec2":"markdown","c8a0d2f9":"markdown","27c0329b":"markdown","38809310":"markdown"},"source":{"88284358":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport calendar\nimport matplotlib.pyplot as plt\n%matplotlib inline","8f38aa08":"df = pd.read_csv('\/kaggle\/input\/Order sales data_01.csv',encoding = 'latin')\ndf_org = df.copy()                    #Keep a reference of original data\ndf.head()","840d7a42":"df.info()","22d267a2":"#Convert Order date to Date format\ndf['Order Date'] = pd.to_datetime(df['Order Date'])","ee5c88ca":"#Create a column and fetch only month from Order Date\ndf['Order Month'] = df['Order Date'].dt.month","31390949":"df['Order Month'] = df['Order Month'].apply(lambda x : calendar.month_abbr[x])","2493c135":"df['Order Month'].head()","b7713e08":"#Group by Month and get sum of Sales and find out highest Sales Month\nhighsalesmonth = df.groupby('Order Month',as_index = False)['Sales'].sum()\nhighsalesmonth.sort_values('Sales',ascending = False).head(1)","b9f6dc24":"dfcor = df[['Discount','Sales']]\n#Calculate Correlation between Discount and Sales\ndfcor.corr()","aaf95573":"ax = sns.regplot(x='Discount',y='Sales',data = df, color='g')\nplt.figure(figsize = [7,7])\nsns.set_style('darkgrid')","c8939c4f":"#Group by Customer Segement and Product category and get the count\ndfcustseg = df.groupby(['Customer Segment','Product Category'],as_index=False)['Order ID'].count()\ndfcustseg","e52e4900":"#Plot a graph to check any affinity between Customer Segment and Product Category\nsns.barplot(x = 'Customer Segment', y ='Order ID', hue = 'Product Category', data = dfcustseg)\nplt.figure(figsize = (20,15))\nplt.show()","44a0198e":" dfloyal = df[['Customer Name','Order Date']]\n dfloyal.head()","e7e6dadd":"dfloyal.sort_values(by = ['Customer Name','Order Date'], inplace = True)","3d2362ba":"dfloyal.reset_index(inplace=True)","95be25c5":"dfloyal.drop('index',axis =1,inplace=True)\ndfloyal.head()","0e42ebd4":"#To get loyal Customer first calculate average days betwen visits for all customers\ndfloyal['Frequency']  = 0\nrows = dfloyal.shape[0]\n\nfor i in range(rows-1):\n  if dfloyal['Customer Name'][i+1]==dfloyal['Customer Name'][i]:\n    dfloyal['Frequency'][i+1] = (dfloyal['Order Date'][i+1]-dfloyal['Order Date'][i])\/np.timedelta64(1,'D')","1de916fa":"dfloyal.head()","f2cdd027":"dfloyalcust = dfloyal.groupby('Customer Name',as_index=False)['Frequency'].mean()\ndfloyalcust.head(10)","2d4c9723":"#Calculate average Frequency between each visit for all customer\ndfloyalcust.Frequency.mean()","c2e7d3d3":"#Considering average frequency betwen visits for each customer as 116, write a query to update Loyal Customer if average frequency for each customer is <116 else update as Non loyal customer\ndfloyalcust['Loyal Customer'] = 'NA'\ndfloyalcust['Loyal Customer'] = np.where(dfloyalcust['Frequency']>116,'Yes','No')","f7f62abe":"dfloyalcust.head(10)","c844bbfa":"#Is there any correlation between profit and sales\ndfprofitsales = df[['Profit', 'Sales']]\ndfprofitsales.head()","4e7a3468":"dfprofitsales.corr()","7bc5c877":"from sklearn.linear_model import LinearRegression\nreg = LinearRegression()\nX = dfprofitsales['Sales']\nX = X.values.reshape(-1,1)\ny = dfprofitsales['Profit']\ny = y.values.reshape(-1,1)","18045298":"reg.fit(X,y)","f10ab763":"SalesVal = pd.Series(5000)\nSalesVal = SalesVal.values.reshape(-1,1)","a408ca59":"reg.predict(SalesVal)","16c74b8f":"# Who all are my loyal customers? Are these customers behave different from remaining customers?","33b2349f":"# 2. How discounts have a impact on my sales?","7a7a0025":"# Does any customer segment has affinity towards any particular product\/category?","97c3702e":"# 1. Which month of the year will companyX generate high sales?","dc1e7ec2":"There is very negligible negative correlatiob between Discount and Sales which is pretty apparent from below graph.","c8a0d2f9":"Load the data","27c0329b":"Its pretty clear from graph that Office Supplies is most popular Product Category among all Customer Segments.","38809310":"Import required libraries"}}