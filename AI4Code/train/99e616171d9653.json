{"cell_type":{"48a963e6":"code","e6a79b1a":"code","e3000688":"code","0b898bdd":"code","343243df":"code","6aae975a":"code","f1d1b67c":"code","bd491690":"code","59683989":"code","723163ab":"markdown","fd463368":"markdown","96e2137d":"markdown","f413dd89":"markdown","6760f787":"markdown","e6229e93":"markdown","cf4bb0ad":"markdown","66179da5":"markdown"},"source":{"48a963e6":"import pandas, numpy\nimport os\nimport matplotlib.pyplot as plot\nfrom tqdm import tqdm","e6a79b1a":"data_train = pandas.read_csv(os.path.join('\/', 'kaggle', 'input', 'ozon-masters-2020', 'gtrain.csv'))\ndata_test = pandas.read_csv(os.path.join('\/', 'kaggle', 'input', 'ozon-masters-2020', 'gtest.csv'))","e3000688":"nsteps_indices = []\ntest_nsteps_indices = []\n\nfor k in range(1, 6):\n    nsteps_indices.append(numpy.array(data_train[data_train.steps == k].index))\n    test_nsteps_indices.append(numpy.array(data_test[data_test.steps == k].index))","0b898bdd":"N, N2 = 22, 484\n\nSIZE = (data_train.shape[0], N, N)\n\ny_train = data_train.iloc[:, 2+N2:2+2*N2].to_numpy().reshape(SIZE)\nx_train = data_train.iloc[:, 2:2+N2].to_numpy().reshape(SIZE)\n\nTSIZE = (data_test.shape[0], N, N)\n\nx_test = data_test.iloc[:, 2:2+N2].to_numpy().reshape(TSIZE)\ny_test = numpy.empty(TSIZE, dtype = 'float32')","343243df":"magic_square = numpy.mean(y_train, axis = 0)\n\nplot.imshow(magic_square)\nplot.title('\u041c\u0430\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043a\u0432\u0430\u0434\u0440\u0430\u0442')\nplot.show()","6aae975a":"magic_square_brer_train = numpy.mean(x_train, axis = 0)\nmagic_square_brer_test = numpy.mean(x_test, axis = 0)\n\nf, axes = plot.subplots(1, 2)\n\naxes[0].imshow(magic_square_brer_train.reshape(N, N))\naxes[0].set_title('\u0411\u0440\u0430\u0442 \u043c\u0430\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043a\u0432\u0430\u0434\u0440\u0430\u0442\u0430')\n\naxes[1].imshow(magic_square_brer_test.reshape(N, N))\naxes[1].set_title('\u0415\u0433\u043e \u0431\u043b\u0438\u0437\u043d\u0435\u0446')\n\nplot.show()","f1d1b67c":"def bayes_predict(image, steps_indices, nsteps_range = range(5)):\n    ONE_CP = numpy.empty((N, N, N, N), dtype = 'float32')\n    ZERO_CP = numpy.empty((N, N, N, N), dtype = 'float32')\n    result = numpy.empty((N, N), dtype = 'float32')\n\n    for nsteps_ in nsteps_range:\n        indices = steps_indices[nsteps_]\n\n        nstep_x_train = x_train[nsteps_indices[nsteps_]]\n        nstep_y_train = y_train[nsteps_indices[nsteps_]]\n\n        items2pred = image[indices]\n\n        # \u0414\u043b\u044f \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0447\u0438\u0441\u043b\u0430 \u0448\u0430\u0433\u043e\u0432 \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u043c \u043c\u0430\u0442\u0440\u0438\u0446\u044b \u0443\u0441\u043b\u043e\u0432\u043d\u044b\u0445 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0435\u0439.\n        with tqdm(total = N2, desc = '\u0427\u0438\u0441\u043b\u043e \u0448\u0430\u0433\u043e\u0432 = %d -> \u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430' % (nsteps_ + 1), bar_format = \"{desc}:   [ \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c: {remaining}; \u043f\u0440\u043e\u0448\u043b\u043e: {elapsed} ] {percentage:3.0f}%|{bar}\") as pbar:\n            for i in range(N):\n                for j in range(N):\n                    ZERO_CP[i, j, :] = numpy.mean(nstep_x_train[nstep_y_train[:, i, j] == 0], axis = 0)\n                    ONE_CP[i, j, :] = numpy.mean(nstep_x_train[nstep_y_train[:, i, j] == 1], axis = 0)\n                    ######################################\n                    pbar.update(1)\n\n        # \u041f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c...\n        with tqdm(total = items2pred.shape[0], desc = '\u0427\u0438\u0441\u043b\u043e \u0448\u0430\u0433\u043e\u0432 = %d -> \u041f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u0435' % (nsteps_ + 1), bar_format = \"{desc}: [ \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c: {remaining}; \u043f\u0440\u043e\u0448\u043b\u043e: {elapsed} ] {percentage:3.0f}%|{bar}\") as pbar:\n            for k in range(items2pred.shape[0]):\n\n                item2pred = items2pred[k]\n                inverted = item2pred ^ 1\n\n                for i in range(N):\n                    for j in range(N):\n                        c = (ONE_CP[i, j] * item2pred + inverted * (1 - ONE_CP[i, j])).prod()\n                        d = (ZERO_CP[i, j] * item2pred + inverted * (1 - ZERO_CP[i, j])).prod()\n\n                        v = magic_square.item(i, j)\n\n                        # \u0412 \u0447\u0438\u0441\u043b\u0438\u0442\u0435\u043b\u0435 \u043d\u0430\u043c\u0435\u0440\u0435\u043d\u043d\u043e \u043d\u0435 \u0443\u043c\u043d\u043e\u0436\u0430\u0435\u043c \u043d\u0430 magic_square.itemset(i, j), \u043f\u043e\u0441\u043a\u043e\u043b\u044c\u043a\u0443 \u0442\u0430\u043a \u043c\u0435\u0434\u043b\u0435\u043d\u043d\u0435\u0435.\n                        result.itemset(i, j, c \/ (v * c + (1 - v) * d))\n\n                # \u0423\u043c\u043d\u043e\u0436\u0430\u0435\u043c \u0441\u0440\u0430\u0437\u0443 \u0432\u0441\u044e \u043c\u0430\u0442\u0440\u0438\u0446\u0443 \u0437\u0434\u0435\u0441\u044c.\n                result *= magic_square\n\n                y_test[indices[k], :] = result\n                ######################################\n                pbar.update(1)","bd491690":"bayes_predict(x_test, test_nsteps_indices)","59683989":"columns = []\n\nfor k in range(N2):\n    columns.append(f'y_{k}')\n    \nanswer = numpy.int32(y_test + .5).reshape(data_test.shape[0], N2)\n\nsubmission = pandas.DataFrame(answer, columns = columns)\n\nsubmission.insert(0, 'id', data_test['id'].values)\nsubmission.to_csv('submission.csv', index = False)","723163ab":"## \u0424\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0442\u0432\u0435\u0442\u0430","fd463368":"\u041e\u0442\u0441\u044e\u0434\u0430 \u0432\u0438\u0434\u043d\u043e, \u0447\u0442\u043e \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u044f \\\\(1\\\\) \u043d\u0430 \u043f\u043e\u0431\u043e\u0447\u043d\u044b\u0445 \u0434\u0438\u0430\u0433\u043e\u043d\u0430\u043b\u044f\u0445 \u00ab\u043c\u0430\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043a\u0432\u0430\u0434\u0440\u0430\u0442\u0430\u00bb \u043f\u0440\u0438\u043c\u0435\u0440\u043d\u043e \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u0430 \u0438 \u044d\u0442\u0430 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c \u0432\u043e\u0437\u0440\u0430\u0441\u0442\u0430\u0435\u0442 \u043e\u0442 \u0441\u0435\u0432\u0435\u0440\u043e-\u0437\u0430\u043f\u0430\u0434\u043d\u043e\u0433\u043e \u0443\u0433\u043b\u0430 \u043a \u044e\u0433\u043e-\u0432\u043e\u0441\u0442\u043e\u0447\u043d\u043e\u043c\u0443. \u041d\u0435\u0442\u0440\u0443\u0434\u043d\u043e \u0443\u0431\u0435\u0434\u0438\u0442\u044c\u0441\u044f, \u0447\u0442\u043e \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440 \u043c\u0430\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043a\u0432\u0430\u0434\u0440\u0430\u0442\u0430 \u043d\u0435\u0441\u0438\u043b\u044c\u043d\u043e \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f, \u0435\u0441\u043b\u0438 \u043c\u044b \u0443\u0441\u0440\u0435\u0434\u043d\u044f\u0435\u043c \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u043e\u0442\u0432\u0435\u0442\u044b \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u043c\u0443 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0443 \u0448\u0430\u0433\u043e\u0432 \\\\(s\\\\). \u0420\u0430\u0437\u0443\u043c\u0435\u0435\u0442\u0441\u044f, \\\\(P(y_{ij} = 0) = 1 - P(y_{ij} = 1)\\\\).\n\n\u0414\u0430\u0432\u0430\u0439\u0442\u0435 \u043f\u043e\u0441\u0442\u0440\u043e\u0438\u043c \u0431\u0440\u0430\u0442\u044c\u0435\u0432-\u0431\u043b\u0438\u0437\u043d\u0435\u0446\u043e\u0432 \u043c\u0430\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043a\u0432\u0430\u0434\u0440\u0430\u0442\u0430, \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c\u044b\u0445 \u0443\u0441\u0440\u0435\u0434\u043d\u0435\u043d\u0438\u0435\u043c \u0432\u0445\u043e\u0434\u043e\u0432 \\\\(x_{train}\\\\) \u0438 \\\\(x_{test}\\\\) \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e.","96e2137d":"\u0420\u0430\u0437\u0434\u0435\u043b\u0438\u043c \u0442\u0435\u0441\u0442\u043e\u0432\u0443\u044e \u0438 \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0443\u044e \u0432\u044b\u0431\u043e\u0440\u043a\u0438 \u043d\u0430 \u0433\u0440\u0443\u043f\u043f\u044b \u0438\u043d\u0434\u0435\u043a\u0441\u043e\u0432 \u043f\u043e \u0447\u0438\u0441\u043b\u0443 \u0448\u0430\u0433\u043e\u0432.","f413dd89":"## \u041c\u0430\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043a\u0432\u0430\u0434\u0440\u0430\u0442 \u0438 \u0435\u0433\u043e \u0431\u0440\u0430\u0442\u044c\u044f-\u0431\u043b\u0438\u0437\u043d\u0435\u0446\u044b\n\u0414\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u0432\u044b\u0447\u0438\u0441\u043b\u0438\u0442\u044c \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c \\\\(P(y_{ij} = 1)\\\\) \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u044f \\\\(1\\\\) \u0432 \u043f\u043e\u0437\u0438\u0446\u0438\u0438 \\\\((i, j)\\\\) \u0443 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e\u0439 \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u044b \\\\(Y\\\\) \u043f\u0440\u043e\u0432\u0435\u0434\u0435\u043c \u0443\u0441\u0440\u0435\u0434\u043d\u0435\u043d\u0438\u0435 \u0438\u043c\u0435\u044e\u0449\u0438\u0445\u0441\u044f \u0432 \u043d\u0430\u0448\u0435\u043c \u0440\u0430\u0441\u043f\u043e\u0440\u044f\u0436\u0435\u043d\u0438\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0445 \u043e\u0442\u0432\u0435\u0442\u043e\u0432. \u0412 \u0442\u043e\u043c, \u0447\u0442\u043e \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0438 \\\\(P(y_{ij} = 1)\\\\) \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442\u0441\u044f \u044d\u0442\u0438\u043c \u0443\u0441\u0440\u0435\u0434\u043d\u0435\u043d\u0438\u0435\u043c, \u043c\u044b \u0443\u0431\u0435\u0434\u0438\u043c\u0441\u044f \u043f\u043e\u0437\u0434\u043d\u0435\u0435.","6760f787":"## \u0418\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0445 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a","e6229e93":"\u041a\u0430\u043a \u043c\u044b \u0432\u0438\u0434\u0438\u043c, \u043e\u043d\u0438 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043f\u043e\u0445\u043e\u0436\u0438. \u0421\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e, \u043c\u043e\u0436\u043d\u043e \u043f\u0440\u0435\u0434\u043f\u043e\u043b\u043e\u0436\u0438\u0442\u044c, \u0447\u0442\u043e \u043d\u0430\u0431\u043e\u0440 \\\\(y_{test}\\\\), \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u0442\u044c, \u0443\u0441\u0442\u0440\u043e\u0435\u043d \u0442\u0430\u043a, \u0447\u0442\u043e \u0435\u0433\u043e \u0441\u0440\u0435\u0434\u043d\u0435\u0435 \u0431\u043b\u0438\u0437\u043a\u043e \u043a \u043c\u0430\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u043c\u0443 \u043a\u0432\u0430\u0434\u0440\u0430\u0442\u0443. \u042d\u0442\u043e \u0434\u0430\u0435\u0442 \u043d\u0430\u043c \u043f\u043e\u043b\u043d\u044b\u0435 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0442\u044c \u0431\u0430\u0439\u0435\u0441\u043e\u0432\u0441\u043a\u0438\u0439 \u043f\u043e\u0434\u0445\u043e\u0434, \u0441\u0447\u0438\u0442\u0430\u044f, \u0447\u0442\u043e \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0438 \\\\(P(y_{ij} = 1)\\\\) \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442\u0441\u044f \u0438\u0437 \u043c\u0430\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043a\u0432\u0430\u0434\u0440\u0430\u0442\u0430.\n\n## \u0411\u0430\u0439\u0435\u0441\u043e\u0432\u0441\u043a\u0438\u0439 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0432 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0438\n\n\u0412 \u043f\u0440\u0435\u0434\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f\u0445 \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438, \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c \\\\(P(X = X^0 | y_{ij} = 1)\\\\) \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u043c \u0432 \u0432\u0438\u0434\u0435 \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u043d\u043e\u0433\u043e \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u043e\u0431\u044b\u0442\u0438\u0439 \\\\(x_{st} = x_{st}^0\\\\) \u043f\u0440\u0438\n\\\\(y_{ij} = 1\\\\). \u0422\u043e\u0433\u0434\u0430\n\\\\[\nP(X = X^0 | y_{ij} = 1)\n=\\prod_{s, t = 1}^{22}\nP(x_{st} = x_{st}^0 | y_{ij} = 1).\n\\\\]\n\u0412\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \\\\(P(x_{st} = x_{st}^0 | y_{ij} = 1)\\\\) \u0432\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u043c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c:\n1. \u0437\u0430\u043f\u043e\u043c\u0438\u043d\u0430\u0435\u043c \u0432\u0441\u0435 \u0438\u043d\u0434\u0435\u043a\u0441\u044b, \u0434\u043b\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \\\\(y_{train}\\\\) \u0432 \u043f\u043e\u0437\u0438\u0446\u0438\u0438 \\\\((i, j)\\\\) \u0438\u043c\u0435\u0435\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \\\\(1\\\\);\n1. \u043f\u0440\u043e\u0432\u043e\u0434\u0438\u043c \u0443\u0441\u0440\u0435\u0434\u043d\u0435\u043d\u0438\u0435 \u043d\u0430\u0431\u043e\u0440\u0430 \\\\(x_{train}\\\\) \u043f\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u043c \u0438\u043d\u0434\u0435\u043a\u0441\u0430\u043c, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043e\u0431\u043e\u0437\u043d\u0430\u0447\u0438\u043c \u0447\u0435\u0440\u0435\u0437 \\\\(AVG[x_{train} | y_{train}[i, j] = 1]\\\\);\n1. \u0435\u0441\u043b\u0438 \\\\(x_{st}^0 = 1\\\\), \u0442\u043e \u043f\u043e\u043b\u043e\u0436\u0438\u043c\n\\\\[\nP(x_{st} = x_{st}^0 | y_{ij} = 1) = AVG[x_{train} | y_{train}[i, j] = 1]_{st}.\n\\\\]\n\u0412 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435 \u2014\n\\\\[\nP(x_{st} = x_{st}^0 | y_{ij} = 1) = 1 - AVG[x_{train} | y_{train}[i, j] = 1]_{st}.\n\\\\]\n\n\u0412\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \\\\(P(X = X^0 | y_{ij} = 0)\\\\) \u0432\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u0442\u0441\u044f \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e.\n\n\u0420\u0430\u0437\u0443\u043c\u0435\u0435\u0442\u0441\u044f, \u0432\u0441\u0435 \u0443\u0441\u0440\u0435\u0434\u043d\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0432\u043e\u0434\u044f\u0442\u0441\u044f \u043f\u043e \u043f\u043e\u0434\u0438\u043d\u0434\u0435\u043a\u0441\u0430\u043c, \u043e\u0442\u0432\u0435\u0447\u0430\u044e\u0449\u0438\u043c \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u043c\u0443 \u0447\u0438\u0441\u043b\u0443 \u0448\u0430\u0433\u043e\u0432.","cf4bb0ad":"## \u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445","66179da5":"# \u041a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u0444\u043e\u0440\u043c\u0443\u043b\u044b \u0411\u0430\u0439\u0435\u0441\u0430\n\n\u041f\u043e\u0441\u043a\u043e\u043b\u044c\u043a\u0443 \u0437\u0430\u0434\u0430\u0447\u0430 \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0432 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0434\u043b\u044f \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043d\u0430\u0431\u043e\u0440\u0430 \u043d\u0443\u043b\u0438\u043a\u043e\u0432 \u0438 \u0435\u0434\u0438\u043d\u0438\u0447\u0435\u043a \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u043d\u0430\u0431\u043e\u0440\u0430 \u043d\u0443\u043b\u0438\u043a\u043e\u0432 \u0438 \u0435\u0434\u0438\u043d\u0438\u0447\u0435\u043a, \u0442\u043e \u0432\u043e\u0437\u043d\u0438\u043a\u0430\u044e\u0442 \u0435\u0441\u0442\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0438 \u0441 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c\u044e \u0438 \u0444\u043e\u0440\u043c\u0443\u043b\u043e\u0439 \u0411\u0430\u0439\u0435\u0441\u0430, \u0441\u043c\u044b\u0441\u043b \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u043a\u0430\u043a \u0440\u0430\u0437 \u0438 \u0437\u0430\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u0432 \u043d\u0435\u0447\u0435\u0442\u043a\u043e\u043c \u0432\u044b\u0432\u043e\u0434\u0435 \u00ab\u0447\u0442\u043e \u0436\u0435 \u0442\u0430\u043c \u043d\u0430 \u0441\u0430\u043c\u043e\u043c \u0434\u0435\u043b\u0435 \u0431\u044b\u043b\u043e\u00bb.\n\n\u041f\u0443\u0441\u0442\u044c \\\\(X^0=(x_{ij}^0)\\\\) \u2014 \u0432\u0445\u043e\u0434\u043d\u0430\u044f \u043c\u0430\u0442\u0440\u0438\u0446\u0430, \u0434\u043b\u044f \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0441\u0442\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \\\\(Y=(y_{ij})\\\\). \u041d\u0430\u0441 \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u0443\u0435\u0442 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c \u0442\u043e\u0433\u043e, \u0447\u0442\u043e \\\\(y_{ij} = 1\\\\) \u043f\u0440\u0438 \u0442\u043e\u043c, \u0447\u0442\u043e \\\\(x_{ij} = x_{ij}^0\\\\), \u0442.\u0435.\n\\\\[\np_{ij} \\triangleq P(y_{ij} = 1 | X = X^0).\n\\\\]\n\u0415\u0441\u043b\u0438 \u043c\u044b \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u043c \u044d\u0442\u0443 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043f\u0430\u0440 \u0438\u043d\u0434\u0435\u043a\u0441\u043e\u0432 \\\\(i\\\\) \u0438 \\\\(j\\\\), \u0442\u043e\n\u043c\u0430\u0442\u0440\u0438\u0446\u0443 \\\\(P = (p_{ij})\\\\) \u043c\u043e\u0436\u043d\u043e \u0441\u0447\u0438\u0442\u0430\u0442\u044c \u043f\u0440\u0438\u0431\u043b\u0438\u0436\u0435\u043d\u043d\u044b\u043c \u043e\u0442\u0432\u0435\u0442\u043e\u043c, \u0442\u0430\u043a \u043a\u0430\u043a \u0447\u0435\u043c \u0431\u043e\u043b\u044c\u0448\u0435 \\\\(p_{ij}\\\\), \u0442\u0435\u043c \u0431\u043e\u043b\u044c\u0448\u0435 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c \u0442\u043e\u0433\u043e, \u0447\u0442\u043e \\\\(y_{ij} = 1\\\\), \u0438, \u043d\u0430\u043e\u0431\u043e\u0440\u043e\u0442, \u0447\u0435\u043c \u043c\u0435\u043d\u044c\u0448\u0435 \\\\(p_{ij}\\\\), \u0442\u0435\u043c \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u0435\u0435, \u0447\u0442\u043e \\\\(y_{ij} = 0\\\\).\n\n\u041f\u043e \u0444\u043e\u0440\u043c\u0443\u043b\u0435 \u0411\u0430\u0439\u0435\u0441\u0430\n\\\\[\nP(y_{ij} = 1 | X = X^0) = \\frac{P(y_{ij} = 1) P(X = X^0 | y_{ij} = 1)}{P(y_{ij} = 1) P(X = X^0 | y_{ij} = 1) + P(y_{ij} = 0) P(X = X^0 | y_{ij} = 0)}.\n\\tag{B}\n\\\\]\n\n\u0412\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0432 \u043f\u0440\u0430\u0432\u043e\u0439 \u0447\u0430\u0441\u0442\u0438 (B) \u0431\u0443\u0434\u0435\u043c \u043f\u0440\u0438\u0431\u043b\u0438\u0436\u0435\u043d\u043d\u043e \u0432\u044b\u0447\u0438\u0441\u043b\u044f\u0442\u044c \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u0438\u043c\u0435\u044e\u0449\u0438\u0445\u0441\u044f \u043d\u0430\u0431\u043e\u0440\u043e\u0432 \u0432\u0445\u043e\u0434\u043e\u0432 \\\\(x_{train}\\\\) \u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0445 \u043e\u0442\u0432\u0435\u0442\u043e\u0432 \\\\(y_{train}\\\\).\n\n\u0414\u043b\u044f \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0432\u0445\u043e\u0434\u0430 \\\\(X^0=(x_{ij}^0)\\\\), \u0432\u044b\u0447\u0438\u0441\u043b\u0438\u0432 \u043c\u0430\u0442\u0440\u0438\u0446\u0443 \\\\(P = (p_{ij})\\\\), \u043e\u0442\u0432\u0435\u0442\u043e\u043c \u0431\u0443\u0434\u0435\u043c \u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \\\\([P]\\\\), \u0433\u0434\u0435 \\\\([\\cdot]\\\\) \u2014 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044f \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043e\u043a\u0440\u0443\u0433\u043b\u0435\u043d\u0438\u044f, \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u043c\u0430\u044f \u043f\u043e\u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043d\u043e."}}