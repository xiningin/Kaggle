{"cell_type":{"3df7b3af":"code","399ac4b7":"code","9b6647f8":"code","e317cb29":"code","698ac5b2":"code","6f280316":"code","25892e48":"code","deac8521":"code","2110827b":"code","a84dad2b":"code","82c589bb":"code","a8b71d72":"code","16d93b24":"code","54dd0da5":"code","9d744321":"code","09a7b777":"code","28c583b0":"code","e354201c":"code","d7c4a280":"code","1db6b45b":"code","1d26c0ff":"code","4a286161":"code","720953ff":"code","13b59e47":"code","256fa240":"code","fe57e576":"code","0a121cf9":"code","c51f9c1f":"code","4a442f14":"code","c1695e98":"code","dcd560b3":"code","d661f3f6":"code","eaedf013":"code","fe62a2cb":"markdown"},"source":{"3df7b3af":"import numpy as np\nimport pandas as pd","399ac4b7":"train = pd.read_csv(\"..\/input\/tabular-playground-series-apr-2021\/train.csv\",index_col='PassengerId')\ntrain.head()","9b6647f8":"test = pd.read_csv(\"..\/input\/tabular-playground-series-apr-2021\/test.csv\",index_col='PassengerId')","e317cb29":"train.info()","698ac5b2":"y = train.pop('Survived')\ny.isnull().sum()","6f280316":"train.info()","25892e48":"num_col = [col for col in train.columns if train[col].dtype in ['int64','float64']]\nnum_col","deac8521":"cat_cols = [col for col in train.columns if train[col].dtype == 'O']\ncat_cols","2110827b":"card = [train[col].nunique() for col in cat_cols]\ncard","a84dad2b":"two_cat = ['Sex','Embarked']","82c589bb":"train.hist()","a8b71d72":"X_train_sel = train[num_col+two_cat]\nX_train_sel.head()","16d93b24":"from sklearn.pipeline import Pipeline\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.preprocessing import OrdinalEncoder","54dd0da5":"my_num_preproc = Pipeline(steps=[\n    ('imputer',SimpleImputer()),\n    ('scaler',StandardScaler())\n])","9d744321":"my_cat_preproc = Pipeline(steps=[\n    ('cat_imputer',SimpleImputer(strategy='most_frequent')),\n    ('ord',OneHotEncoder(handle_unknown='ignore'))\n])","09a7b777":"my_tranf = ColumnTransformer([\n    ('num',my_num_preproc,num_col),\n    ('cat',my_cat_preproc,two_cat)\n])","28c583b0":"# from sklearn.ensemble import RandomForestClassifier\n# forest = RandomForestClassifier()","e354201c":"# from xgboost import XGBClassifier\n# xgboost =  XGBClassifier(alpha=14,\n#                      eta= 0.1,\n#                      max_depth=6,\n#                         reg_lambda=5)","d7c4a280":"from xgboost import XGBClassifier\nxgboost =  XGBClassifier()","1db6b45b":"my_pipe = Pipeline(steps=[\n    ('preproc',my_tranf),\n    ('model',xgboost)])","1d26c0ff":"from sklearn.model_selection import GridSearchCV ","4a286161":"params = [\n    {'model__eta':[0.05,0.1],\n     'model__max_depth':[6],\n     'model__lambda':[15,5],\n     'model__alpha':[21,14]\n    }\n]","720953ff":"# params = [\n#     {'model__n_estimators':[10,100],\n#      'model__min_samples_split':[2,3,4],\n#      'model__min_impurity_decrease':[0,1,10],\n#      'model__bootstrap':[True,False]\n#     }\n# ]","13b59e47":"gs = GridSearchCV(my_pipe,params,cv=5,scoring='accuracy',n_jobs=-1,verbose=1)","256fa240":"# gs = my_pipe","fe57e576":"gs.fit(X_train_sel,y)","0a121cf9":"gs.best_estimator_","c51f9c1f":"gs.best_score_","4a442f14":"gs.best_params_","c1695e98":"pred = pd.DataFrame(gs.predict(test[num_col+two_cat]))\npred.index = test[num_col+two_cat].index\npred","dcd560b3":"pred.columns = ['Survived']","d661f3f6":"pred","eaedf013":"pred.to_csv('out.txt')","fe62a2cb":"# Prepare Pipeline"}}