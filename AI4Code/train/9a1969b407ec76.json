{"cell_type":{"36be61f0":"code","8697323d":"code","e9736fe1":"code","d8fe05ad":"code","48f3b67a":"code","2ab6544d":"code","49e60f09":"code","4e6f0388":"code","d926cbbd":"code","4f872a8f":"code","2fa8feb4":"code","1651e669":"code","adf8b9a2":"code","209ce6f8":"code","a86a2599":"code","f536a394":"code","cf58cf4c":"code","3158d446":"code","fdd80a47":"code","946e9eba":"markdown","a61f25ba":"markdown"},"source":{"36be61f0":"import pandas as pd\nimport numpy as np\nfrom sklearn.feature_selection import SelectFromModel\nfrom sklearn.svm import LinearSVC\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.feature_selection import RFE\nfrom warnings import simplefilter\nfrom sklearn.ensemble import RandomForestClassifier","8697323d":"df = pd.read_csv(\"..\/input\/1st-feature-selection-lasso-xgboost\/new_df.csv\")\ndf","e9736fe1":"df_col = df.describe()\ndf_col = df_col.drop(['sum_visitors'], axis=1)\n#(include ='int64')\ndf_col.columns","d8fe05ad":"varSel = pd.DataFrame({'Variable': df_col.columns})\nvarSel","48f3b67a":"nm = df_col.columns\nnm = nm.append(pd.Index(['sum_visitors']))\nnm","2ab6544d":"df = df[nm].copy()\ndf.head()","49e60f09":"X = df.iloc[:,:-1]\nX.head()","4e6f0388":"y = df.iloc[:,-1:]\ny.head()","d926cbbd":"rfmod = RandomForestClassifier(max_depth=16).fit(X, y.values.ravel())\n#(max_depth=16)\n#rfmod.feature_importances_","4f872a8f":"model = SelectFromModel(rfmod, prefit=True)\nmodel.get_support()","2fa8feb4":"varSel['RandomForest'] = model.get_support()\n#.astype('int64')\nvarSel","1651e669":"varSel['Sum'] = np.sum(varSel,axis=1)\nvarSel","adf8b9a2":"varSel.groupby('Sum')['Variable'].count()","209ce6f8":"# We can now decide a threshold for selecting our variables!","a86a2599":"varSel[varSel['Sum']>=1]","f536a394":"variables = varSel[varSel['Sum']>=1].iloc[:, [0]]\nvariables","cf58cf4c":"variables_to_columns = variables.transpose().iloc[:].head()\ndf_variables_to_columns = pd.DataFrame(variables_to_columns)\nsum_visitors = ['sum_visitors']\ndf_variables_to_columns['sum_visitors'] = sum_visitors\ndf_variables_to_columns.to_csv('third_variables_data.csv',index = False)\ndf_variables_to_columns","3158d446":"top_columns = pd.read_csv(\".\/third_variables_data.csv\",header = 1).columns\ntop_columns","fdd80a47":"df_After_Feature_Selection = pd.DataFrame(df[top_columns])\ndf_After_Feature_Selection.to_csv(\".\/Third_Feature_Selection.csv\",index = False)\ndf_After_Feature_Selection","946e9eba":"### Summarization and Selection of Variables ","a61f25ba":"### Variable Selection using Random Forest"}}