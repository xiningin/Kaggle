{"cell_type":{"ecd76e6d":"code","664cfd7c":"code","a8cb74de":"code","8401d4fd":"code","339bd708":"code","ef6281e9":"code","db6c18c8":"code","7c052344":"code","06fb9cf9":"code","d738a933":"code","f7359bf5":"code","d3197bea":"code","5dd8245a":"code","de02528d":"code","d89afcb0":"code","c735e3aa":"code","62370e1a":"code","fa6f2a1f":"code","124fb9be":"code","6d9dd4f9":"code","945b211a":"code","8984bfb7":"code","404c3de8":"code","507b3caf":"code","74b6bc0d":"code","210971c5":"code","2450b856":"code","97503c6e":"code","95ef1b34":"code","a21632f4":"code","2bcec8a2":"code","6858e403":"code","5d0631b7":"code","ac8a0cd1":"code","7453c506":"code","14c2de51":"code","bc41f76f":"code","08be5229":"code","eb74b108":"code","0ec90265":"code","dbf8cc83":"code","9c548e9e":"code","e7105b8c":"code","65e902ec":"code","d6d9303d":"markdown","628a2e9c":"markdown","b25cb077":"markdown","df144ac0":"markdown","20d1bcfb":"markdown","fc657031":"markdown","11a02a8d":"markdown","9cfe03ff":"markdown","664a7a6d":"markdown","5b4ef9f8":"markdown","0ec7af4e":"markdown","bb9c4bcd":"markdown","bef877a0":"markdown","c961f076":"markdown","970bec5b":"markdown","f1448cbf":"markdown","0e3cecda":"markdown","6c39cbb1":"markdown","ec946ead":"markdown","dc27ae8c":"markdown","1f205154":"markdown","a5dbae9f":"markdown","f2842c40":"markdown","0461c128":"markdown","b15299b6":"markdown"},"source":{"ecd76e6d":"from sklearn.cluster import KMeans\nimport pandas as pd\nfrom sklearn.preprocessing import MinMaxScaler\nfrom matplotlib import pyplot as plt\n%matplotlib inline","664cfd7c":"df = pd.read_csv(\"..\/input\/kmeans\/k-means.csv\")\ndf.head()","a8cb74de":"df.info()","8401d4fd":"plt.scatter(df.age,df.income)\nplt.xlabel('age')\nplt.ylabel('income')","339bd708":"from sklearn.cluster import KMeans","ef6281e9":"km=KMeans(n_clusters=3)\ny_predicted=km.fit_predict(df[['age','income']])","db6c18c8":"y_predicted","7c052344":"df['cluster']=y_predicted\ndf.head()","06fb9cf9":"km.cluster_centers_","d738a933":"df1=df[df.cluster==0]\ndf2=df[df.cluster==1]\ndf3=df[df.cluster==2]","f7359bf5":"plt.scatter(df1.age,df1['income'],color='red')\nplt.scatter(df2.age,df2['income'],color='green')\nplt.scatter(df3.age,df3['income'],color='black')\nplt.scatter(km.cluster_centers_[:,0],km.cluster_centers_[:,1],color='purple',marker='*',label='centroid')\nplt.xlabel('age')\nplt.ylabel('income')\nplt.legend()","d3197bea":"from sklearn.preprocessing import MinMaxScaler","5dd8245a":"scaler=MinMaxScaler()","de02528d":"scaler.fit(df[['income']])\ndf.income=scaler.transform(df[['income']])\n\nscaler.fit(df[['age']])\ndf.age=scaler.transform(df[['age']])","d89afcb0":"df.head()","c735e3aa":"km=KMeans(n_clusters=3)\ny_predicted=km.fit_predict(df[['age','income']])","62370e1a":"y_predicted","fa6f2a1f":"df['cluster']=y_predicted\ndf.head()","124fb9be":"km.cluster_centers_","6d9dd4f9":"df1=df[df.cluster==0]\ndf2=df[df.cluster==1]\ndf3=df[df.cluster==2]","945b211a":"plt.scatter(df1.age,df1['income'],color='red')\nplt.scatter(df2.age,df2['income'],color='green')\nplt.scatter(df3.age,df3['income'],color='black')\nplt.scatter(km.cluster_centers_[:,0],km.cluster_centers_[:,1],color='purple',marker='*',label='centroid')\nplt.xlabel('age')\nplt.ylabel('income')\nplt.legend()","8984bfb7":"km.inertia_","404c3de8":"sse = []\nk_rng = range(1,10)\nfor k in k_rng:\n    km = KMeans(n_clusters=k)\n    km.fit(df[['age','income']])\n    sse.append(km.inertia_)","507b3caf":"sse","74b6bc0d":"plt.xlabel('K')\nplt.ylabel('Sum of squared error')\nplt.plot(k_rng,sse)","210971c5":"from sklearn.datasets import load_iris","2450b856":"iris=load_iris()","97503c6e":"df = pd.DataFrame(iris.data,columns=iris.feature_names)\ndf.head()","95ef1b34":"df['flower']=iris.target","a21632f4":"df.head()","2bcec8a2":"df.drop(['sepal length (cm)','sepal width (cm)','flower'],axis=1,inplace=True)","6858e403":"df.head()","5d0631b7":"plt.scatter(df[['petal length (cm)']],df[['petal width (cm)']])","ac8a0cd1":"scaler.fit(df[['petal length (cm)']])\ndf['petal length (cm)']=scaler.transform(df[['petal length (cm)']])","7453c506":"scaler.fit(df[['petal width (cm)']])\ndf['petal width (cm)']=scaler.transform(df[['petal width (cm)']])","14c2de51":"df.head()","bc41f76f":"km=KMeans(n_clusters=3)\ny_predicted=km.fit_predict(df[['petal length (cm)','petal width (cm)']])","08be5229":"km.cluster_centers_","eb74b108":"y_predicted\ndf['cluster']=y_predicted","0ec90265":"df1=df[df.cluster==0]","dbf8cc83":"df2=df[df.cluster==1]\ndf3=df[df.cluster==2]","9c548e9e":"plt.scatter(df1['petal length (cm)'],df1['petal width (cm)'],color='red')\nplt.scatter(df2['petal length (cm)'],df2['petal width (cm)'],color='green')\nplt.scatter(df3['petal length (cm)'],df3['petal width (cm)'],color='black')\nplt.scatter(km.cluster_centers_[:,0],km.cluster_centers_[:,1])","e7105b8c":"sse=[]\nk_rng = range(1,10)\nfor k in k_rng:\n  km=KMeans(n_clusters=k)\n  km.fit(df[['petal length (cm)','petal width (cm)']])\n  sse.append(km.inertia_)\n","65e902ec":"plt.plot(k_rng,sse)\nplt.xlabel('k')\nplt.ylabel('sum of squared error')","d6d9303d":"Convert IRIS dataset into dataframe using pandas","628a2e9c":"now make the object of MinMaxScalar","b25cb077":"we have to find the name of flower in this dataset","df144ac0":"Now these cluster values we add to dataframe (df).","20d1bcfb":"We make three clusters (n_clusters=3)\n\nand train the model using fit method\n","fc657031":"Print the cluster centers.","11a02a8d":"Read the dataframe using pandas","9cfe03ff":"Now we show different clusters using different colours and the centroid by a purple star.","664a7a6d":"As you can see the graph is not appropriate and the centroids are not perfectly formed. Now we will work again on this dataset to set the centroids and get the better results.\n\n\nNow we transform our data and make every value between 0 to 1.","5b4ef9f8":"In this notebook we learn about what is K-MEANS, how to implement, how we find the clusters.\nIn this notebook I take 2 Datasets to perform.\n\n1) Income dataset\n\n2) Iris dataset\n\n\nFirst we take a simple dataset for a warmup.\n\nIn this notebook we identify and predict which age group has the highest chances of getting more income.\nIn this dataset we have two columns age and income and 22 number of rows.\n\nFirst import all the necessary libraries","0ec7af4e":"Find relation between petal length and width","bb9c4bcd":"Find the number of rows and columns to identify the volume of data","bef877a0":"2)  Now we use IRIS dataset\n\nimport IRIS dataset from sklearn","c961f076":"Now you can learn what is Kmeans algorithm, how it works, what are the methods to look into.\nNow explore youself on the other documentations.","970bec5b":"Now you can see in the above graph, we easily identify the clusters in data.\n\n\nNow fit and transform the data","f1448cbf":"You can see there we will make a proper cluster and predict the better result accordingly","0e3cecda":"As you seen above, now the centroids are in perfect position and make the perfect clusters.\n\n\n","6c39cbb1":"Transform the data","ec946ead":"to identify the relation\/cluster of data, I draw the scatter plot between age income.","dc27ae8c":"Apply the KMeans model on this data again using fit method","1f205154":"Now we find Sum of squared distances of samples to their closest cluster center.","a5dbae9f":"WE use KMeans clustering to build a model.\n\n# **KMeans**\nK-means clustering is a method of vector quantization, originally from signal processing, that aims to partition n observations into k clusters in which each observation belongs to the cluster with the nearest mean (cluster centers or cluster centroid), serving as a prototype of the cluster. \n\n\nNow we import KMenas through sklearn.","f2842c40":"Now we make different dataframes of each cluster.","0461c128":"Now we find the relation bertween Number of clusters and sum of squared error","b15299b6":"Clean the data -- remove unnecessary columns"}}