{"cell_type":{"09531336":"code","1801f924":"code","11cdc929":"code","6d78a2c7":"code","e5c612e7":"code","15b21971":"code","21affe59":"code","90727b29":"code","b5277a10":"markdown","ae5656e6":"markdown","73e2fec8":"markdown","dc9e2065":"markdown","16fde4d8":"markdown","e2ddc88c":"markdown","5d9c0395":"markdown","16d21e82":"markdown","54bb3713":"markdown"},"source":{"09531336":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","1801f924":"!pip install autokeras","11cdc929":"import tqdm\nfrom sklearn.metrics import classification_report\n\ndata = pd.read_csv('\/kaggle\/input\/tabular-playground-series-aug-2021\/train.csv')","6d78a2c7":"y = data.loss.values\nX = data.drop(['loss'], axis = 1).values\n\nprint(\"train_shape\",X.shape)\nprint(\"label shape\", y.shape)","e5c612e7":"import tensorflow as tf\n\nimport autokeras as ak","15b21971":"# Initialize the structured data regressor.\nreg = ak.StructuredDataRegressor(\n    loss=\"mean_squared_error\",\n    overwrite=True,\n    objective=\"val_loss\",\n    max_trials=10,\n    project_name=\"tps_august\"\n)  # It tries 10 different models.\n\n\nreg.fit(\n    # The path to the train.csv file.\n    '\/kaggle\/input\/tabular-playground-series-aug-2021\/train.csv',\n    # The name of the label column.\n    \"loss\",\n    epochs=100,\n)","21affe59":"predicted_y = reg.predict('..\/input\/tabular-playground-series-aug-2021\/test.csv')","90727b29":"sub = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/sample_submission.csv')\nsub.loss = predicted_y\nsub.to_csv('sub.csv')","b5277a10":"# Lets Auto-Keras\n\nHello everyone, in this notebook I will show you how to use auto-keras for TPS August.","ae5656e6":"## Define autokeras model\n\nHere we will try the Structured data Regressor, since the data is in table format.","73e2fec8":"Install the auto-keras package","dc9e2065":"Load the data","16fde4d8":"Import the Libraries","e2ddc88c":"### Get X and y.\n\nIn the actual submission there is a bit of feature engineering involved, howver since I am only demonstrating the power of auto-keras package, I will not be doing any feature engineering here.","5d9c0395":"# Score: 7.99319\n\n### We achieved a score of 7.99319 which not very bad considering there was no feature engineering involved at all and we did not try to come up with a sophisticated method to make predictions.\n\n### Currently the top score is 7.84, so the auto-keras model is 0.15 behind it only.\n\n### With some feature engineering and hyperparameter optimisation while defining the model, I managed to achieve a score of 7.849, so it is clear that auto keras shows a lot of potential when it comes to structured data\n\n## Do upvote if you like it, and do let me know if you want to see more automl methods","16d21e82":"### Make predictions","54bb3713":"### Write to submission file"}}