{"cell_type":{"18c83913":"code","e4fcb5e3":"code","f747336c":"code","ce1ac44f":"code","78b11ec1":"code","c262f3de":"code","4dbe5737":"code","b00d3d9a":"code","02cfc8d7":"code","d09c1974":"code","cc0baccf":"code","bca0be96":"code","d8aa0e26":"code","0128ad6d":"code","e6a5fd0d":"code","093db224":"code","929c33db":"code","8f5bd5b1":"code","0689f976":"code","1a6c4ac3":"code","83a0498b":"code","87e37ecb":"code","aaca751f":"code","76d750d8":"code","a25845e7":"code","bb6c1645":"code","07e25955":"code","5ce2fd62":"code","6723fb19":"code","1fa5f926":"code","798e7542":"code","7a04929d":"code","66802401":"code","73f109ec":"code","f77b456e":"code","1107fdb4":"code","807210cc":"code","ba63b4c4":"code","ce6eb5b9":"code","bb1b2237":"code","5a002020":"code","a0c41def":"code","34068b67":"code","c5a85ada":"code","d193b070":"code","67e7deda":"code","d3172c67":"code","166ae1c9":"code","6b19b9dc":"code","22bb99c6":"code","d9dceb7e":"code","0a86dce1":"code","0f5f829b":"code","27a0352f":"code","6cd3cc42":"code","5f1ca1c9":"code","c6a5ee26":"code","3870f029":"markdown","4b67ab47":"markdown","393adbf5":"markdown","21dc180b":"markdown","ca6759b4":"markdown","623ebb0f":"markdown","71bdf684":"markdown","b0c89337":"markdown","7e16f630":"markdown","f8f2aa7c":"markdown","f6cd11fc":"markdown","bd83e37b":"markdown","805303ae":"markdown","b0f30d8f":"markdown","4044d6c0":"markdown","73a9d3d9":"markdown","4dc144f3":"markdown","dc2fd196":"markdown","650c4651":"markdown","00e87900":"markdown","637619c6":"markdown","adf8610b":"markdown","ad15cc31":"markdown","81e89987":"markdown","c8f9e681":"markdown","9ab54404":"markdown","7e071a5c":"markdown","318a611c":"markdown","2ef64c3e":"markdown","b2da219d":"markdown","7edf6b59":"markdown","826b66d3":"markdown","d544713c":"markdown","ecaf8097":"markdown","21a72cba":"markdown","5fc0fcf4":"markdown","2bf9aa82":"markdown"},"source":{"18c83913":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","e4fcb5e3":"df = pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')\ndf.head()","f747336c":"df.info()","ce1ac44f":"df.describe()","78b11ec1":"df.shape","c262f3de":"df1 = df.copy()\n#Seperate copy of df will be used for visualizations purpose","4dbe5737":"df1['output'].value_counts()","b00d3d9a":"print(\"Categorical Variables: 'sex', 'cp', 'fbs', 'restecg', 'exng', 'thall', 'caa', 'slp' \")\nprint(\"Numerical Variables: 'age', 'trtbps', 'chol', 'thalachh', 'oldpeak \")","02cfc8d7":"df1[df1['thall'] == 0]","d09c1974":"df1[df1['caa'] == 4]","cc0baccf":"df1['thall'].replace({0:2}, inplace=True)","bca0be96":"df1['caa'].replace({4:1}, inplace=True)","d8aa0e26":"print(df1['sex'].unique())\nprint(df1['cp'].unique())\nprint(df1['fbs'].unique())\nprint(df1['restecg'].unique())\nprint(df1['exng'].unique())\nprint(df1['thall'].unique())\nprint(df1['slp'].unique())\nprint(df1['output'].unique())","0128ad6d":"corr_df1 = df1.corr()\ncorr_df1['output'].sort_values(ascending=False)","e6a5fd0d":"plt.figure(figsize=(12,10))\nsns.heatmap(corr_df1, annot=True)","093db224":"df1['sex'] = df1['sex'].map({1:\"Male\", 0:\"Female\"})\ndf1['cp'] = df1['cp'].map({3:\"Asymptomatic\", 2:\"Non-Anginal\", 1:\"Atypical\", 0:\"Typical\"})\ndf1['fbs'] = df1['fbs'].map({1:\">=120\", 0:\"<120\"})\ndf1['restecg'] = df1['restecg'].map({0:\"Normal\", 1:\" ST-T wave abnormality\", 2:\"probable or definite left ventricular hypertrophy\"})\ndf1['exng'] = df1['exng'].map({1:\"Yes\", 0:\"No\"})\ndf1['thall'] = df1['thall'].map({1:\"Fixed Defect\", 2:\"Normal\", 3:\"Reversible Defect\"})\ndf1['slp'] = df1['slp'].map({0:\"Downsloping\", 1:\"Flat\", 2:\"Upsloping\"})\ndf1['output'] = df1['output'].map({1:\"High chances\", 0:\"Low Chances\"})","929c33db":"df1.head()","8f5bd5b1":"sns.histplot(x='age', hue='output', bins=30, data=df1)\nplt.title(\"Heart Attack Counts w.r.t Age\");","0689f976":"sns.histplot(x='trtbps', hue='output', bins=40, data=df1)\nplt.title(\"Heart Attack Counts w.r.t Resting Blood Pressure\");","1a6c4ac3":"sns.histplot(x='chol', hue='output',bins=40, data=df1)\nplt.title(\"Heart Attack Counts w.r.t Cholesterol Level in mg\/dl\");","83a0498b":"sns.histplot(x='oldpeak', hue='output', bins=30, data=df1)\nplt.title(\"Heart Attack Counts w.r.t ST depression induced by exercise relative to rest\");","87e37ecb":"plt.figure(figsize=(8,5))\nsns.countplot(x='output', hue='sex', data=df1)\nplt.title(\"Heart Attack Counts w.r.t Sex\");","aaca751f":"plt.figure(figsize=(8,5))\nsns.countplot(x='output', hue='cp', data=df1)\nplt.title(\"Heart Attack Counts w.r.t Chest Pain\");","76d750d8":"plt.figure(figsize=(8,5))\nsns.countplot(x='output', hue='fbs', data=df1)\nplt.title(\"Heart Attack Counts w.r.t Fasting Blood Sugar\");","a25845e7":"plt.figure(figsize=(8,5))\nsns.countplot(x='output', hue='restecg', data=df1)\nplt.title(\"Heart Attack Counts w.r.t Resting ECG Results\");","bb6c1645":"plt.figure(figsize=(8,5))\nsns.countplot(x='output', hue='exng', data=df1)\nplt.title(\"Heart Attack Counts w.r.t Exercise Induced Angina\");","07e25955":"plt.figure(figsize=(8,5))\nsns.countplot(x='output', hue='thall', data=df1)\nplt.title(\"Heart Attack Counts w.r.t Thalium Stress Test Results\");","5ce2fd62":"plt.figure(figsize=(8,5))\nsns.countplot(x='output', hue='slp', data=df1)\nplt.title(\"Heart Attack Counts w.r.t The slope of the peak exercise ST segment\");","6723fb19":"df1[df1.duplicated()]","1fa5f926":"df1.drop_duplicates(inplace=True)\ndf1.head()","798e7542":"sns.boxplot(df1['chol'])","7a04929d":"sns.boxplot(df1['thalachh'])","66802401":"sns.boxplot(df1['trtbps'])","73f109ec":"df1.drop(df1[df1['chol'] > 500].index, inplace = True)","f77b456e":"df1['chol'].max()","1107fdb4":"df2 = df.copy()\ndf2.head()","807210cc":"df2.shape","ba63b4c4":"df2.drop_duplicates(inplace=True)\ndf2.head()","ce6eb5b9":"df2.drop(df2[df2['chol'] > 500].index, inplace = True)","bb1b2237":"y = df2['output']\nX = df2.drop('output', axis=1)","5a002020":"X.head()","a0c41def":"y.head()","34068b67":"print(X.shape)\nprint(y.shape)","c5a85ada":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=101)","d193b070":"print(X_train.shape)\nprint(y_train.shape)\nprint(X_test.shape)\nprint(y_test.shape)","67e7deda":"from sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\nX_train_scaled = scaler.fit_transform(X_train)","d3172c67":"X_train_scaled","166ae1c9":"X_test_scaled = scaler.transform(X_test)\nX_test_scaled","6b19b9dc":"print(X_train_scaled.shape)\nprint(X_test_scaled.shape)","22bb99c6":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.ensemble import AdaBoostClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier\n\nfrom sklearn.ensemble import VotingClassifier\n\nkn_clf = KNeighborsClassifier()\nlog_clf = LogisticRegression()\nsvm_clf = SVC()\ndt_clf = DecisionTreeClassifier()\nrnd_clf = RandomForestClassifier()\nada_clf = AdaBoostClassifier()\ngdb_clf = GradientBoostingClassifier()\n\nestimators_list = [('KNeighborsClassifier', kn_clf), ('LogisticRegression', log_clf), ('SVC', svm_clf), ('DecisionTreeClassifier', dt_clf),('RandomForestClassifier', rnd_clf),('AdaBoostClassifier', ada_clf), ('GradientBoostingClassifier', gdb_clf)]\nvoting_clf = VotingClassifier(estimators=estimators_list, voting='hard')\nvoting_clf.fit(X_train_scaled, y_train)","d9dceb7e":"from sklearn.metrics import accuracy_score\nfor name, clf in (estimators_list):\n  clf.fit(X_train_scaled, y_train)\n  y_pred = clf.predict(X_test_scaled)\n  print(name, accuracy_score(y_test, y_pred))","0a86dce1":"from sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import precision_score, recall_score\n\nrf = RandomForestClassifier(random_state=101)\nrf.fit(X_train_scaled,y_train)\nrf_pred = rf.predict(X_test_scaled)\nprint(\"Accuracy:\", accuracy_score(y_test,rf_pred))\nprint(\"Confusion matrix:\\n\", confusion_matrix(y_test,rf_pred))\nprint(\"Precision Score:\\n\", precision_score(y_test, rf_pred))\nprint(\"Recall Score:\\n\", recall_score(y_test, rf_pred))","0f5f829b":"from sklearn.model_selection import cross_val_predict\nfrom sklearn.metrics import roc_auc_score\n\ny_proba = cross_val_predict(rf, X_train_scaled, y_train, cv=5, method='predict_proba')\ny_scores = y_proba[:, 1]\nroc_auc_score(y_train, y_scores)\n","27a0352f":"y_proba = cross_val_predict(rf, X_test_scaled, y_test, cv=5, method='predict_proba')\ny_scores = y_proba[:, 1]\nroc_auc_score(y_test, y_scores)\n","6cd3cc42":"X_test_random = X_test_scaled[42].reshape(1,-1)\nX_test_random","5f1ca1c9":"y_test_random = y_test.iloc[42]\ny_test_random","c6a5ee26":"print(rf.predict(X_test_random))","3870f029":"## Exploratory Data Analysis :","4b67ab47":"Age range about 37-55 have higher chances of Heart Attack. Age range 55-70 have lower chances of Heart Attacks","393adbf5":"### Predicting on a random instance:","21dc180b":"### Displaying Unique categories types of the categorical features","ca6759b4":"## Splitting into Training and Test Set","623ebb0f":"Non-Anginal chest pains leads to higher Heart Attacks than the others types of pains. Typical Pains might greatly indicate lower chances of Heart Attack.","71bdf684":"## Reading the DataFrame :","b0c89337":"### *Removing the cholesterol outlier and 1 duplicate row found during EDA*","7e16f630":"Thallium Test Results indicating Type 2 shows higher chances of Heart Attacks","f8f2aa7c":"### *Upon seperate researching on the database 'thall = 0' and 'caa = 4' are not valid types. So replacing such values by its median*","f6cd11fc":"### Checking for Skewness :","bd83e37b":"### Plotting CountPlots for the Categorical Variables against Output Label :","805303ae":"Cholesterol Level in the range of 200 - 270 have higher chances of heart Attacks","b0f30d8f":"### *Slightly skewed outputs but not worth concerning*","4044d6c0":"Males have higher chances of Heart Attacks. But this attribute shouldn't be a deciding factor","73a9d3d9":"Resting blood pressure in the range of 120-140 have higher chances of heart attacks.","4dc144f3":"No firm conclusion can be derived from here. Also evident from its low correlation (-0.028..) with chances of heart attack","dc2fd196":"### *Seems there is 1 row of duplicate data. We'll remove that*","650c4651":"Having ST-T wave normality increases chances of Heart Attacks.","00e87900":"## Gathering Basic Info about the Data :","637619c6":"### Histogram Plots for the Numerical Variables against Output Label :","adf8610b":"### Checking for Duplicate Rows :","ad15cc31":"### ROC-AUC Score:","81e89987":"### Replacing category type numbers by their names for easy visualiations","c8f9e681":"Uplsloping of the peak exercise ST segment leads to higher Heart Attacks","9ab54404":"Range between 0-0.8 have higher chances of Heart Attacks","7e071a5c":"## Defining Machine Learning Models","318a611c":"### *Considering Random Forest as our Best Model:*","2ef64c3e":"### Checking for significant outliers","b2da219d":"Absence of Exercise Induced Angima increases chances of Heart Attacks","7edf6b59":"### Finding Correlations","826b66d3":"### Now seperating data to form Input and Output Variables :","d544713c":"## Scaling the Data","ecaf8097":"## Moving to Prediction ","21a72cba":"### *We need a higher Recall score compared to the Precision score. So the above results are good enough*","5fc0fcf4":"### *Based on correlations data, Chest pain, thallach, slp has high positive correlations with high chances of higher attacks.*\n\n### *Similarly, caa, exng, oldpeak, thall has high negative correlation with high chances of heart attacks*\n\n### *Sex and age seems to moderately affect the chances of Heart Attacks.* \n\n### *Cholesterol and tbs seems to have slight effect on Heart Attack chances*","2bf9aa82":"### *Seems like there is 1 concerning outlier in cholesterol boxplot having chol > 500. So we'll remove the row having that value of chol. Outliers of other features doesn't seem to be of much concern*"}}