{"cell_type":{"18931413":"code","a3dbdbe9":"code","9e794fa2":"code","4a4bd2de":"code","9f2da0e1":"code","5ede6b0e":"code","6c9ac097":"code","05540c85":"code","69009b9f":"code","e5a01762":"code","8ab4ef0d":"code","3fd456ab":"code","2f962471":"code","2f58b3a6":"code","386ebd4e":"code","49fbd8f1":"code","3b108adc":"code","59ad0b56":"code","35ee35a5":"code","d62810a6":"code","b51f89a0":"code","18eb8d22":"code","008c0543":"code","c6ac26ae":"code","7debb62d":"code","3000671b":"code","9cda7827":"code","be519839":"code","be729064":"code","b7f5d9c9":"code","f4426918":"code","95a3316a":"code","a1ab0e67":"code","1f9d2ed5":"code","ea913a6e":"code","6c7167d3":"code","5eb587fc":"code","d0202868":"code","e87d882c":"code","8b2d4d32":"code","208c6ede":"code","b25d14db":"code","689dc9fc":"code","6e89d262":"code","4710464e":"code","9e1b7b58":"code","ac6ecae8":"code","272ac710":"code","5524de30":"code","3600fb17":"code","99ea4440":"code","a389c54c":"code","1f134c44":"code","ad7f1f22":"code","4b9dd01c":"code","59bd0552":"code","2e84af50":"code","b8ba5b37":"code","d05ded8b":"code","3238ad85":"code","83e4bccf":"code","02496cd5":"code","dbc35d89":"code","c4725fa4":"code","98c09d1d":"markdown","cd49e68a":"markdown","49030446":"markdown","5353792f":"markdown","99af9897":"markdown","c0553163":"markdown","78e2863b":"markdown","c07b152a":"markdown","c91df2df":"markdown","dadb5d70":"markdown","cdfd206c":"markdown","b850f4fc":"markdown","a075ec7f":"markdown","40980305":"markdown","a47e333e":"markdown","35e0e8dc":"markdown","828ed6d7":"markdown","eaddd478":"markdown","f06e0416":"markdown","bef12e2e":"markdown","e5bd4a63":"markdown","3506d638":"markdown","ecbb8f6d":"markdown","da81e913":"markdown","1337b82a":"markdown","a3d9aa30":"markdown","745d01c6":"markdown","4d46c935":"markdown","b441997f":"markdown"},"source":{"18931413":"import random\nimport numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Supress some errors\nfrom pandas.plotting import register_matplotlib_converters\nregister_matplotlib_converters()\n\nplt.style.use('bmh')\n%matplotlib inline","a3dbdbe9":"train = pd.read_csv(\"\/kaggle\/input\/ashrae-energy-prediction\/train.csv\")\ntrain.head()","9e794fa2":"print(f\"Number of data points in training set {len(train)}\")","4a4bd2de":"pd.Series(train['building_id'], dtype=\"category\").describe()","9f2da0e1":"print(f\"Number of unique building_ids in training set {pd.Series(train['building_id'], dtype='category').describe()['unique']}\")","5ede6b0e":"plt.figure(figsize=(10,6))\nplt.hist(list(train['building_id'].value_counts()), bins=14)\nplt.title(\"Number of data points for each building_id\")\nplt.xlabel(\"Number of data points \")\nplt.ylabel(\"Number of building with that many data points\")\nplt.show()","6c9ac097":"train['building_id'].value_counts().describe()","05540c85":"train['timestamp'] = pd.to_datetime(train['timestamp'])\ntrain['timestamp'].describe()","69009b9f":"print(f\"Number of unique timestamps is {train['timestamp'].describe()['unique']}\")\nprint(f\"last  timestamp is {train['timestamp'].describe()['last']}\")\nprint(f\"first timestamp is {train['timestamp'].describe()['first']}\")","e5a01762":"tcounts = train['timestamp'].value_counts()\nplt.figure(figsize=(10,6))\nplt.plot(tcounts.index, tcounts, '*')\nplt.title(\"data distribution wrt time\")\nplt.xlabel(\"time stamp\")\nplt.ylabel(\"data points\")\nplt.show()","8ab4ef0d":"train['meter'].value_counts()","3fd456ab":"plt.figure(figsize=(10,6))\nplt.bar([\"electricity\",\"chilledwater\", \"steam\", \"hotwater\"], train['meter'].value_counts())\nplt.xlabel(\"Meter ids\")\nplt.ylabel(\"counts\")\nplt.show()","2f962471":"print(\"Number of data points for each unique meter\")\nprint((train[\"meter\"] + train[\"building_id\"]*10).value_counts().describe())","2f58b3a6":"plt.figure(figsize=(10,6))\nplt.hist((train[\"meter\"] + train[\"building_id\"]*10).value_counts(), bins=50)\nplt.title(\"Number of data points for each unique meter\")\nplt.xlabel(\"Number of data points \")\nplt.ylabel(\"Number of unique meters with that many data points\")\nplt.show()","386ebd4e":"train['meter_reading'].describe()","49fbd8f1":"nonzero = train['meter_reading'][train['meter_reading'] != 0.0]","3b108adc":"print(f\"total number of readings          {len(train['meter_reading'])}\")\nprint(f\"total number of non-zero readings {len(nonzero)}\")","59ad0b56":"# ploting non zero values less than 1000 as very high values screw the plot\n# len(nonzero[nonzero <= 1000] is 16723689\nplt.figure(figsize=(10,10))\nplt.hist(nonzero[nonzero <= 1000], bins=100)\nplt.title(\"non-zero meter readings  < 1000\")\nplt.show()","35ee35a5":"fig, axes = plt.subplots(2, 2, figsize=(15,10))\n\na = train['meter_reading'][train['meter'] == 0]\nnonzero = a[ a != 0.0]\nprint(f\"total number of readings for meter type electricity          {len(a)}\")\nprint(f\"total number of non-zero readings for meter type electricity {len(nonzero)}\")\naxes[0,0].hist(nonzero[nonzero <= 1000], bins=40)\naxes[0,0].set_title(\"meter readings for meter type electricity\");\n\na = train['meter_reading'][train['meter'] == 1]\nnonzero = a[ a != 0.0]\nprint(f\"total number of readings for meter type chilledwater          {len(a)}\")\nprint(f\"total number of non-zero readings for meter type chilledwater {len(nonzero)}\")\naxes[0,1].hist(nonzero[nonzero <= 1000], bins=40)\naxes[0,1].set_title(\"meter readings for meter type chilledwater\")\n\na = train['meter_reading'][train['meter'] == 2]\nnonzero = a[ a != 0.0]\nprint(f\"total number of readings for meter type steam                 {len(a)}\")\nprint(f\"total number of non-zero readings for meter type steam        {len(nonzero)}\")\naxes[1,0].hist(nonzero[nonzero <= 1000], bins=40)\naxes[1,0].set_title(\"meter readings for meter type steam\")\n\na = train['meter_reading'][train['meter'] == 3]\nnonzero = a[ a != 0.0]\nprint(f\"total number of readings for meter type hotwater              {len(a)}\")\nprint(f\"total number of non-zero readings for meter type hotwater     {len(nonzero)}\")\naxes[1,1].hist(nonzero[nonzero <= 1000], bins=40)\naxes[1,1].set_title(\"meter readings for meter type hotwater\")\n\n\nplt.tight_layout()\nplt.show()","d62810a6":"train['unique_meter'] = train[\"meter\"] + train[\"building_id\"]*10\n\nk = 5\nfig, axes = plt.subplots(5, 1, figsize=(5*k, 10), sharex=True)\nfig.suptitle(\"Some randomly sampled Series of meter reading over entire time period\")\nl = list(train['unique_meter'].unique())\nfor i, j in enumerate(random.choices(l, k=k)):\n    x = train[train['unique_meter']==j]\n    axes[i].plot(x['timestamp'], x['meter_reading'], alpha=0.9)\nplt.show()","b51f89a0":"k = 5\ndays = 15\nfig, axes = plt.subplots(5, 1, figsize=(5*k, 10))\nfig.suptitle(f\"Some randomly sampled Series of meter reading over {days} days\")\nl = list(train['unique_meter'].unique())\nfor i, j in enumerate(random.choices(l, k=k)):\n    x = train[train['unique_meter']==j]\n    axes[i].plot(x['timestamp'][:24*days], x['meter_reading'][:24*days], alpha=0.9)\nplt.show()","18eb8d22":"train['log_meter_reading'] = np.log1p(train[\"meter_reading\"])\nnonzero = train['log_meter_reading'][train['log_meter_reading'] != 0.0]\nplt.figure(figsize=(10,10))\nplt.hist(nonzero, bins=100)\nplt.title(\"non-zero log1p meter readings\")\nplt.show()","008c0543":"fig, axes = plt.subplots(2, 2, figsize=(15,10))\n\na = train['log_meter_reading'][train['meter'] == 0]\nnonzero = a[ a != 0.0]\naxes[0,0].hist(nonzero, bins=40)\naxes[0,0].set_title(\"log1p meter readings for meter type electricity\");\n\na = train['log_meter_reading'][train['meter'] == 1]\nnonzero = a[ a != 0.0]\naxes[0,1].hist(nonzero, bins=40)\naxes[0,1].set_title(\"log1p meter readings for meter type chilledwater\")\n\na = train['log_meter_reading'][train['meter'] == 2]\nnonzero = a[ a != 0.0]\naxes[1,0].hist(nonzero, bins=40)\naxes[1,0].set_title(\"log1p meter readings for meter type steam\")\n\na = train['log_meter_reading'][train['meter'] == 3]\nnonzero = a[ a != 0.0]\naxes[1,1].hist(nonzero, bins=40)\naxes[1,1].set_title(\"log1p meter readings for meter type hotwater\")\n\nplt.tight_layout()\nplt.show()","c6ac26ae":"k = 5\nfig, axes = plt.subplots(5, 1, figsize=(5*k, 10), sharex=True)\nfig.suptitle(\"Some randomly sampled Series of meter reading over entire time period\")\nl = list(train['unique_meter'].unique())\nfor i, j in enumerate(random.choices(l, k=k)):\n    x = train[train['unique_meter']==j]\n    axes[i].plot(x['timestamp'], x['log_meter_reading'], alpha=0.9)\nplt.show()","7debb62d":"k = 5\ndays = 15\nfig, axes = plt.subplots(5, 1, figsize=(5*k, 10))\nfig.suptitle(f\"Some randomly sampled Series of meter reading over {days} days\")\nl = list(train['unique_meter'].unique())\nfor i, j in enumerate(random.choices(l, k=k)):\n    x = train[train['unique_meter']==j]\n    axes[i].plot(x['timestamp'][:24*days], x['log_meter_reading'][:24*days], alpha=0.9)\nplt.show()","3000671b":"test = pd.read_csv(\"\/kaggle\/input\/ashrae-energy-prediction\/test.csv\")\ntest.head()","9cda7827":"print(f\"Number of data points in testing set {len(test)}\")","be519839":"pd.Series(test['building_id'], dtype=\"category\").describe()","be729064":"if np.all(test['building_id'].value_counts().index.sort_values() == train['building_id'].value_counts().index.sort_values()):\n    print(\"the building_id's in train and test match\")","b7f5d9c9":"plt.figure(figsize=(10,6))\nplt.hist(list(test['building_id'].value_counts()))\nplt.title(\"Number of data points for each building_id\")\nplt.xlabel(\"Number of data points\")\nplt.ylabel(\"Number of building with that many data points\")\nplt.show()","f4426918":"test['building_id'].value_counts().value_counts()","95a3316a":"timestamps = pd.to_datetime(test['timestamp'])\ntimestamps.describe()","a1ab0e67":"print(f\"Number of unique timestamps is {timestamps.describe()['unique']}\")\nprint(f\"last  timestamp is {timestamps.describe()['last']}\")\nprint(f\"first timestamp is {timestamps.describe()['first']}\")","1f9d2ed5":"tcounts = timestamps.value_counts()\nplt.figure(figsize=(10,6))\nplt.plot(tcounts.index, tcounts, '*')\nplt.title(\"data distribution wrt time\")\nplt.xlabel(\"time stamp\")\nplt.ylabel(\"data points\")\nplt.show()","ea913a6e":"test['meter'].value_counts() ","6c7167d3":"plt.figure(figsize=(10,6))\nplt.bar([\"electricity\",\"chilledwater\", \"steam\", \"hotwater\"], test['meter'].value_counts())\nplt.xlabel(\"Meter ids\")\nplt.ylabel(\"counts\")\nplt.show()","5eb587fc":"if np.array(train[\"meter\"] + train[\"building_id\"]*10).sort() == np.array(test[\"meter\"] + test[\"building_id\"]*10).sort():\n    print(\"the meters in test set are all present in training set\")","d0202868":"print(\"Number of data points for each unique meter\")\nprint((test[\"meter\"] + test[\"building_id\"]*10).value_counts().describe())","e87d882c":"meta = pd.read_csv(\"\/kaggle\/input\/ashrae-energy-prediction\/building_metadata.csv\")\nmeta.head()","8b2d4d32":"nul = meta.isnull()\nfor i in nul.columns:\n    print(f\"column name:{i}\\t len:{len(nul[i])} number of null values : {np.sum(nul[i])}\")","208c6ede":"if np.all(meta['building_id'].value_counts().index.sort_values() == train['building_id'].value_counts().index.sort_values()):\n    print(\"the building_id's in train and meta_data match\")","b25d14db":"pd.Series(meta['primary_use'], dtype=\"category\").value_counts()","689dc9fc":"plt.figure(figsize=(8,10))\nplt.barh(meta['primary_use'].apply(str).value_counts().index, meta['primary_use'].value_counts())\nplt.ylabel(\"primary use\")\nplt.xlabel(\"counts\")\nplt.show()","6e89d262":"meta['square_feet'].describe()","4710464e":"plt.figure(figsize=(10,6))\nplt.hist(meta['square_feet'], bins=20)\nplt.ylabel(\"bin counts\")\nplt.xlabel(\"square feet\")\nplt.show()","9e1b7b58":"year = meta['year_built']\nyear.describe()","ac6ecae8":"plt.figure(figsize=(15,6))\nplt.hist(meta['year_built'], bins=2017-1900-1, rwidth=0.8)\nplt.ylabel(\"bin counts\")\nplt.xlabel(\"year\")\nplt.title(\"Year built\")\nplt.show()","272ac710":"meta['floor_count'].value_counts()","5524de30":"nonnull = meta['floor_count'][~ meta['floor_count'].isnull()]\nplt.figure(figsize=(10,6))\nplt.bar(nonnull.apply(str).value_counts().index, nonnull.value_counts())\nplt.xlabel(\"Floor counts\")\nplt.ylabel(\"Instances\")\nplt.show()","3600fb17":"wtrain = pd.read_csv(\"\/kaggle\/input\/ashrae-energy-prediction\/weather_train.csv\")\nwtrain['timestamp'] = pd.to_datetime(wtrain['timestamp'])\nwtrain.head()","99ea4440":"wtest = pd.read_csv(\"\/kaggle\/input\/ashrae-energy-prediction\/weather_test.csv\")\nwtest['timestamp'] = pd.to_datetime(wtest['timestamp'])\nwtest.head()","a389c54c":"print(\"weather train\")\nprint(\"\")\nnul = wtrain.isnull()\nfor i in nul.columns:\n    print(f\"column name:{i: <{20}}len:{len(nul[i])} \\tnumber of null values : {np.sum(nul[i])}\")\n\nprint(\"\")\nprint(\"-\"*80)\nprint(\"weather test\")\nprint(\"\")\nnul = wtest.isnull()\nfor i in nul.columns:\n    print(f\"column name:{i: <{20}}len:{len(nul[i])} \\tnumber of null values : {np.sum(nul[i])}\")\nassert np.all(wtrain['site_id'].unique() == wtest['site_id'].unique())","1f134c44":"wtrain.groupby(\"site_id\")['timestamp'].describe()[[ 'count', 'unique']].head()","ad7f1f22":"wtest.groupby(\"site_id\")['timestamp'].describe()[[ 'count', 'unique']].head()","4b9dd01c":"plt.figure(figsize=(9,4))\nfor i in range(16):\n    site = wtrain[wtrain['site_id']== i]\n    plt.plot(site['timestamp'], site['air_temperature'])\nplt.xlabel(\"Time\")\nplt.ylabel(\"Temperature\")\nplt.title(\"Temperature at different sites in train data\")\nplt.show()","59bd0552":"plt.figure(figsize=(20,6))\nfor i in range(16):\n    site = wtest[wtest['site_id']== i]\n    plt.plot(site['timestamp'], site['air_temperature'])\nplt.xlabel(\"Time\")\nplt.ylabel(\"Temperature\")\nplt.title(\"Temperature at different sites in test data\")\nplt.show()","2e84af50":"plt.figure(figsize=(9,4))\nfor i in range(16):\n    site = wtrain[wtrain['site_id']== i]\n    plt.plot(site['timestamp'], site['dew_temperature'])\nplt.xlabel(\"Time\")\nplt.ylabel(\"Dew Temperature\")\nplt.title(\"Dew Temperature at different sites in train data\")\nplt.show()","b8ba5b37":"plt.figure(figsize=(20,6))\nfor i in range(16):\n    site = wtest[wtest['site_id']== i]\n    plt.plot(site['timestamp'], site['dew_temperature'])\nplt.xlabel(\"Time\")\nplt.ylabel(\"Dew Temperature\")\nplt.title(\"Dew Temperature at different sites in test data\")\nplt.show()","d05ded8b":"plt.figure(figsize=(9,4))\nfor i in range(16):\n    site = wtrain[wtrain['site_id']== i]\n    plt.plot(site['timestamp'], site['sea_level_pressure'], alpha=0.8)\nplt.xlabel(\"Time\")\nplt.ylabel(\"sea_level_pressure\")\nplt.title(\"sea_level_pressure at different sites in train data\")\nplt.show()","3238ad85":"plt.figure(figsize=(20,6))\nfor i in range(16):\n    site = wtest[wtest['site_id']== i]\n    plt.plot(site['timestamp'], site['sea_level_pressure'], alpha=0.8)\nplt.xlabel(\"Time\")\nplt.ylabel(\"sea_level_pressure\")\nplt.title(\"sea_level_pressure at different sites in test data\")\nplt.show()","83e4bccf":"plt.figure(figsize=(9,4))\nfor i in range(16):\n    site = wtrain[wtrain['site_id']== i]\n    plt.plot(site['timestamp'], site['wind_speed'], alpha=0.8)\nplt.xlabel(\"Time\")\nplt.ylabel(\"wind_speed\")\nplt.title(\"wind_speed at different sites in train data\")\nplt.show()","02496cd5":"plt.figure(figsize=(20,6))\nfor i in range(16):\n    site = wtest[wtest['site_id']== i]\n    plt.plot(site['timestamp'], site['wind_speed'], alpha=0.8)\nplt.xlabel(\"Time\")\nplt.ylabel(\"wind_speed\")\nplt.title(\"wind_speed at different sites in test data\")\nplt.show()","dbc35d89":"sub = pd.read_csv(\"\/kaggle\/input\/ashrae-energy-prediction\/sample_submission.csv\")\nsub.head()","c4725fa4":"if len(sub['row_id']) == len(test['row_id']):\n    print(\"The lengths of submission.csv and test.csv match\")","98c09d1d":"# ASHRAE - Great Energy Predictor III\n### How much energy will a building consume?\nAssessing the value of energy efficiency improvements can be challenging as there's no way to truly know how much energy a building would have used without the improvements. The best we can do is to build counterfactual models. Once a building is overhauled the new (lower) energy consumption is compared against modeled values for the original building to calculate the savings from the retrofit. More accurate models could support better market incentives and enable lower cost financing.\n\nThis competition challenges you to build these counterfactual models across four energy types based on historic usage rates and observed weather. The dataset includes three years of hourly meter readings from over one thousand buildings at several different sites around the world.","cd49e68a":"# Submission","49030446":"# Train.csv","5353792f":"### wind speed","99af9897":"## Building ids","c0553163":"### Temperature ","78e2863b":"### many buildings in test set have same number of occurrences","c07b152a":"## Timestamps","c91df2df":"## square_feet","dadb5d70":"### More on weather soon","cdfd206c":"# weather","b850f4fc":"## Meter id","a075ec7f":"### Dew temperature","40980305":"# Thank you for reading this do upvote if you like it","a47e333e":"### most of unique meters have 8494 datapoints","35e0e8dc":"### ALL unique meters have 17520 datapoints in test set","828ed6d7":"## Meter reading","eaddd478":"## primary use","f06e0416":"## floor count","bef12e2e":"## Building ids","e5bd4a63":"### Sea level pressure","3506d638":"# test.csv","ecbb8f6d":"# building metadata","da81e913":"### imports","1337b82a":"## Meter id","a3d9aa30":"## year built","745d01c6":"## Timestamps","4d46c935":"### Looks like at each time stamp we have equal number of test points","b441997f":"### log1p of meter_reading"}}