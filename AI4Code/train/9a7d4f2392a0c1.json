{"cell_type":{"d2dd2c36":"code","25dc7bc0":"code","9b862c78":"code","5100c5fa":"code","dcfb7f7d":"code","8ca3d3c1":"code","d55f8f5e":"code","22057df0":"code","1d324178":"code","d02b540f":"code","f9e223fb":"code","c810d003":"code","03bf3427":"code","3c718276":"code","9d6efbf7":"code","ae073be1":"code","0dadec71":"code","63230022":"code","c38b244f":"code","4acb0ddb":"code","54f90efa":"code","848b27e0":"code","e523824d":"code","163b0a74":"code","09aac044":"code","db70e92c":"code","501c8ae9":"code","cbd6ef8b":"code","657832fe":"markdown","d09d40df":"markdown","9372038b":"markdown","296fb7d1":"markdown","38965145":"markdown","7307fdf0":"markdown","dfd836d7":"markdown","d62af86e":"markdown","9b4df908":"markdown","4859bc7c":"markdown","09bd45d5":"markdown","6afb627c":"markdown","09e8ca28":"markdown","a16e8acc":"markdown","fe8fc396":"markdown","8cc56e37":"markdown"},"source":{"d2dd2c36":"#Importando bibliotecas\nimport scipy\nimport numpy as np \nimport pandas as pd \nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import confusion_matrix, accuracy_score\nfrom sklearn.ensemble import RandomForestClassifier\n\nplt.style.use(\"ggplot\")\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n        \n#Importando dataset\ndf = pd.read_csv(\"..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv\")\ndf.head()","25dc7bc0":"df.isnull().sum()","9b862c78":"df.describe().T","5100c5fa":"df.info()","dcfb7f7d":"fig, a = plt.subplots(4, figsize=(15,15))\ncolumns = list(df.drop(columns= ['quality']).columns)\nj = 0\n\nfor i in range(4):          \n        sns.boxplot(x= df[columns[j]], ax = a[i])\n        j += 1","8ca3d3c1":"fig, a = plt.subplots(3, figsize=(15,15))\n\ndf[\"fixed acidity\"], fitted_lambda = scipy.stats.boxcox(df[\"fixed acidity\"] ,lmbda=None)   \nsns.boxplot(x= df[\"fixed acidity\"], ax = a[0], color=\"Blue\")\n\ndf[\"volatile acidity\"], fitted_lambda = scipy.stats.boxcox(df[\"volatile acidity\"] ,lmbda=None)   \nsns.boxplot(x= df[\"volatile acidity\"], ax = a[1], color=\"Blue\")\n\ndf[\"residual sugar\"], fitted_lambda = scipy.stats.boxcox(df[\"residual sugar\"] ,lmbda=None)   \nsns.boxplot(x= df[\"residual sugar\"], ax = a[2], color=\"Blue\")","d55f8f5e":"fig, ax = plt.subplots(4, figsize=(15,20))\n\nfor i in range(4):             \n        sns.boxplot(x= df[columns[j]], ax = ax[i])\n        j += 1","22057df0":"fig, a = plt.subplots(4, figsize=(15,15))\n\ndf[\"chlorides\"], fitted_lambda = scipy.stats.boxcox(df[\"chlorides\"] ,lmbda=None)   \nsns.boxplot(x= df[\"chlorides\"], ax = a[0], color=\"Blue\")\n\ndf[\"free sulfur dioxide\"], fitted_lambda = scipy.stats.boxcox(df[\"free sulfur dioxide\"] ,lmbda=None)   \nsns.boxplot(x= df[\"free sulfur dioxide\"], ax = a[1], color=\"Blue\")\n\ndf[\"total sulfur dioxide\"], fitted_lambda = scipy.stats.boxcox(df[\"total sulfur dioxide\"] ,lmbda=None)   \nsns.boxplot(x= df[\"total sulfur dioxide\"], ax = a[2], color=\"Blue\")\n\ndf[\"density\"], fitted_lambda = scipy.stats.boxcox(df[\"density\"] ,lmbda=None)   \nsns.boxplot(x= df[\"density\"], ax = a[3], color=\"Blue\")","1d324178":"fig, ax2 = plt.subplots(3, figsize=(15,20))\n\nfor i in range(3):             \n        sns.boxplot(x= df[columns[j]], ax = ax2[i])\n        j += 1","d02b540f":"df.columns","f9e223fb":"fig, a = plt.subplots(3, figsize=(15,15))\n'pH', 'sulphates', 'alcohol'\ndf[\"pH\"], fitted_lambda = scipy.stats.boxcox(df[\"pH\"] ,lmbda=None)   \nsns.boxplot(x= df[\"pH\"], ax = a[0], color=\"Blue\")\n\ndf[\"sulphates\"], fitted_lambda = scipy.stats.boxcox(df[\"sulphates\"] ,lmbda=None)   \nsns.boxplot(x= df[\"sulphates\"], ax = a[1], color=\"Blue\")\n\ndf[\"alcohol\"], fitted_lambda = scipy.stats.boxcox(df[\"alcohol\"] ,lmbda=None)   \nsns.boxplot(x= df[\"alcohol\"], ax = a[2], color=\"Blue\")","c810d003":"plt.figure(figsize=(13,8))\nsns.heatmap(df.corr(), annot= True, cmap= \"Reds\", vmin= -1, vmax= 1)\nplt.title(\"Correlation map\")","03bf3427":"sns.scatterplot(y= df[\"citric acid\"], x= df[\"fixed acidity\"], hue= df.quality)\n","3c718276":"sns.scatterplot(y= df[\"density\"], x= df[\"fixed acidity\"], hue= df.quality)","9d6efbf7":"sns.scatterplot(y= df[\"pH\"], x= df[\"fixed acidity\"], hue= df.quality)","ae073be1":"sns.scatterplot(y= df[\"density\"], x= df[\"alcohol\"], hue= df.quality)","0dadec71":"sns.countplot(df.quality)","63230022":"fig, ax1 = plt.subplots(4, figsize=(15,20))\ncolumns = list(df.drop(columns= ['quality']).columns)\nk = 0\n\nfor i in range(4):          \n        sns.boxplot(x = df.quality, y= df[columns[k]], ax = ax1[i])\n        k += 1\n        ","c38b244f":"fig, ax = plt.subplots(4, figsize=(15,20))\n\nfor i in range(4):             \n        sns.boxplot(x = df.quality, y= df[columns[k]], ax = ax[i])\n        k += 1","4acb0ddb":"fig, ax2 = plt.subplots(3, figsize=(15,20))\n\nfor i in range(3):             \n        sns.boxplot(x = df.quality, y= df[columns[k]], ax = ax2[i])\n        k += 1","54f90efa":"fig, ax1 = plt.subplots(3, 4, figsize=(20,17))\ncolumns = list(df.columns)\nk = 0\n\nfor i in range(3):\n    for j in range(4):\n        sns.distplot( df[columns[k]], ax = ax1[i][j])\n        k += 1","848b27e0":"# Preparando dados de qualidade\ndf['quality'] = ['good' if x>=6.5 else \"bad\" for x in df['quality']]\n\nprevisores = df.drop(columns=\"quality\").values\nclasse = df[\"quality\"].values\n\nX_treinamento, X_teste, y_treinamento, y_teste = train_test_split(previsores, classe, test_size = 0.3, random_state = 0)\nvalor = []","e523824d":"floresta = RandomForestClassifier(n_estimators = 100)\nfloresta.fit(X_treinamento, y_treinamento)\nprevisoes = floresta.predict(X_teste)\n\nscore = accuracy_score(y_teste, previsoes)\n\nprint(f\"Matriz confus\u00e3o: \\n{confusion_matrix(y_teste, previsoes)}\")\nprint(f\"\\n\\nAccuracy: {accuracy_score(y_teste, previsoes)}\")\n\nvalor.append((\"Random Forest Classifier\", score))","163b0a74":"nb = GaussianNB()\nnb.fit(X_treinamento, y_treinamento)\nprevisoes = nb.predict(X_teste)\n\nscore = accuracy_score(y_teste, previsoes)\n\nprint(f\"Matriz confus\u00e3o: \\n{confusion_matrix(y_teste, previsoes)}\")\nprint(f\"\\n\\nAccuracy: {accuracy_score(y_teste, previsoes)}\")\n\nvalor.append((\"Naive Bayes\",score))","09aac044":"neighbors = KNeighborsClassifier(n_neighbors=3)\nneighbors.fit(X_treinamento, y_treinamento)\nprevisoes = neighbors.predict(X_teste)\n\nscore = accuracy_score(y_teste, previsoes)\n\nprint(f\"Matriz confus\u00e3o: \\n{confusion_matrix(y_teste, previsoes)}\")\nprint(f\"\\n\\nAccuracy: {accuracy_score(y_teste, previsoes)}\")\n\nvalor.append((\"KNeighbors Classifier\", score))","db70e92c":"tree = DecisionTreeClassifier(random_state=1)\ntree.fit(X_treinamento, y_treinamento)\nprevisoes = tree.predict(X_teste)\n\nscore = accuracy_score(y_teste, previsoes)\n\nprint(f\"Matriz confus\u00e3o: \\n{confusion_matrix(y_teste, previsoes)}\")\nprint(f\"\\n\\nAccuracy: {accuracy_score(y_teste, previsoes)}\")\n\nvalor.append((\"Decision Tree Classifier\", score))","501c8ae9":"modelos = pd.DataFrame(valor, columns = ['Name', 'Accuracy'])\nmodelos.sort_values(by= 'Accuracy')","cbd6ef8b":"plt.figure(figsize=(8,5))\nsns.barplot(y= modelos.Name, x= modelos.Accuracy, order= [\"Random Forest Classifier\", \"Decision Tree Classifier\", \"KNeighbors Classifier\", \"Naive Bayes\"])\nplt.title(\"Modelos\")","657832fe":"## KNeighbors","d09d40df":"# II. Visualizando e entendendo o dataset","9372038b":"# I. Importando banco de dados","296fb7d1":"## Naive Bayes","38965145":"Boxplot p\u00f3s remo\u00e7\u00e3o","7307fdf0":"Rela\u00e7\u00f5es interessantes do heat map:\n\n* O \"alcool\" \u00e9 um fator que pode determinar, um pouco, a qualidade do seu vinho.\n* O \"fixed acidity\" e o \"citric acid\" s\u00e3o substancias muito correlacionadas, elas afetam outras duas caracteristicas do vinho, a \" e o \"pH\". A rela\u00e7\u00e3o entre a acidez do vinho e a densidade \u00e9 proporcional, ou seja, quanto mais acido for o vinho maior ser\u00e1 a sua densidade, j\u00e1 a rela\u00e7\u00e3o entre a acidez e o pH \u00e9 inversamente proporcional, ou seja, quanto mais acido for o vinho menor ser\u00e1 o seu pH, isso ocorre pelo fato de que subst\u00e2ncias \u00e1cidas t\u00eam um pH menor.\n* Vinhos com um alto teor alco\u00f3lico s\u00e3o menos densos.","dfd836d7":"## Decision Tree","d62af86e":"# III. Modelos","9b4df908":"Boxplot p\u00f3s remo\u00e7\u00e3o","4859bc7c":"Verificando valores faltantes ","09bd45d5":"Boxplot p\u00f3s remo\u00e7\u00e3o","6afb627c":"## Random Forest","09e8ca28":"## Rela\u00e7\u00e3o entre a qualidade do vinho e suas caracteristicas","a16e8acc":"Como foi visto no heatmap, vinhos com um alto teor alco\u00f3lico costumam ter uma alta qualidade, por\u00e9m isso n\u00e3o significa que o alcool seja um fator desicivo para a qualidade do vinho, visto que a qualidade depende de varios fatores, com isso, \u00e9 possivel observar vinhos com um alto teor alco\u00f3lico e uma qualidade baixa.","fe8fc396":"O fator que impacta significativamente a qualidade do vinho \u00e9 o \"volatile acidity\", quanto menor for o melhor ser\u00e1 o vinho.\n","8cc56e37":"## Removendo outliers"}}