{"cell_type":{"0a3b843e":"code","26e0f984":"code","a98e7f59":"code","b1960cd9":"code","05f2043d":"code","c1f0ef85":"code","f5ec52ce":"code","80cfe081":"code","f5ad0110":"code","fa513dd4":"code","305a01e5":"code","3c2921ad":"code","d3244fc7":"code","c5999b3c":"code","68c45de6":"code","01c5358e":"code","2b511dce":"code","5c728069":"code","9897ccfe":"code","c27a8014":"code","fa9d0300":"code","b9a7b49d":"code","9a564da9":"code","a7d67822":"code","dbc1d453":"code","f8895dc7":"code","49f7fecd":"code","c4438b87":"code","ae7f5f08":"code","e6da6733":"code","2929efac":"code","04b56269":"code","27df1e60":"code","67f1dac4":"code","5fe0185b":"code","47e4bdf0":"code","cb9ca415":"code","90a27132":"code","6083954d":"code","07c83851":"code","e4acca85":"code","b49f3c14":"code","82d684cf":"code","014cf9c8":"code","9e8c91ac":"code","a2e3589d":"code","8af0fee9":"code","ae5a8a06":"code","8a70fe4a":"code","de55dc17":"code","84dacd49":"code","6dba7797":"code","9a929ac4":"code","06ec5fd2":"code","c888f9ea":"code","735a0d88":"code","e35e077e":"code","169ed480":"code","691aa798":"code","a2a4c39a":"code","74ebcf42":"code","4312ab8d":"code","3558f75c":"code","e03fde0b":"code","020be8c4":"code","2a37510d":"code","405534f0":"code","b5273664":"code","04b0c058":"code","146915d2":"code","3238ff5c":"code","bcef490e":"code","8aee055d":"code","7572deda":"code","273a654c":"code","9fd427f1":"code","7c2e36ec":"code","cbf0a9de":"code","82eeaf86":"code","682a2287":"code","cd702030":"code","8d198b28":"code","ba02b343":"code","a15be4ba":"code","cef7b3f1":"code","2d237a84":"code","2b318217":"code","1155ee4b":"code","99a8de1f":"code","e3d24fb0":"code","ec59aa32":"code","e4a10840":"code","37d4902d":"code","15fe07df":"code","72248d50":"code","d38e4983":"code","556f13fc":"code","bbc850a6":"code","6c20efe6":"code","00d06c72":"code","52c52862":"code","3b8873ef":"code","cd088d1f":"code","5ecc7a93":"code","693f525d":"code","5b4fc844":"code","6b0cf3c5":"code","894d3a8d":"code","327e7afe":"code","64811f1c":"code","0b58947a":"code","f53fb54d":"code","401ce26c":"code","3ffd21b9":"markdown","17d2a29a":"markdown","6b3639c2":"markdown","d43658b1":"markdown","b737b58d":"markdown","47203b1a":"markdown","1edf87c6":"markdown","ba0ae5f6":"markdown","83b1f4f5":"markdown","efeabf81":"markdown","2bc8e1ac":"markdown","20c38415":"markdown","373feb98":"markdown","15495e3b":"markdown","3e0c5983":"markdown","86821644":"markdown","d7676381":"markdown","2e057a6d":"markdown","c324734d":"markdown","74c3a129":"markdown","5b1389b3":"markdown","46cce6f2":"markdown","dec23afd":"markdown","f57c99a5":"markdown","f283a413":"markdown","7eb5b17d":"markdown","6ff0dee6":"markdown","91091f8c":"markdown","605c7d6c":"markdown","437bf58f":"markdown","e7707a31":"markdown","cbdf75e1":"markdown","46415564":"markdown","e2b1b412":"markdown","24fe43a6":"markdown","c8d5ce0f":"markdown","816a17ec":"markdown","54439c28":"markdown","235d0897":"markdown","b4cb00e7":"markdown","4e7144de":"markdown","0cd6d222":"markdown","4a6298e8":"markdown","82a84486":"markdown","838e6492":"markdown","08d59101":"markdown","dabf05bf":"markdown","abc95b42":"markdown","397941d7":"markdown","342eb740":"markdown","9b567f19":"markdown","3f5594c6":"markdown","12a8957d":"markdown","1a17081b":"markdown","98a5d993":"markdown","1d4bc02d":"markdown","40e6fee0":"markdown","bb57b76c":"markdown","44bd0e0a":"markdown","163f8d41":"markdown","b4a65c74":"markdown","c41c499c":"markdown","6b5b99f1":"markdown","bf864c07":"markdown","9590826c":"markdown","45c037a4":"markdown","070f7f01":"markdown","69062624":"markdown","20d3447e":"markdown","b577be36":"markdown","7c034eab":"markdown","73ad9972":"markdown","3304e7e0":"markdown","cbec2641":"markdown","e77607ca":"markdown","989ab7a5":"markdown","4d023b15":"markdown","5b5814ed":"markdown","5536cdea":"markdown","74eef75a":"markdown","c61a3220":"markdown","9cef1b45":"markdown","93596dde":"markdown","cb75b7b2":"markdown","1394e65e":"markdown","5b811f7c":"markdown","f1d6c72b":"markdown","dada0c39":"markdown","92ec334f":"markdown","bc7284b8":"markdown","df280643":"markdown","69efd75f":"markdown","c8b5d4db":"markdown","d3885e07":"markdown","11b9e779":"markdown","c8ebe32b":"markdown","f1adef8e":"markdown","dfecc223":"markdown","7cbe43b1":"markdown","bf69a52a":"markdown","bba0df58":"markdown"},"source":{"0a3b843e":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport lightgbm as lgb\nfrom sklearn.model_selection import KFold\nimport warnings\nimport gc\nimport time\nimport sys\nimport datetime\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.metrics import mean_squared_error\nwarnings.simplefilter(action='ignore', category=FutureWarning)\nwarnings.filterwarnings('ignore')\nfrom sklearn import metrics\n\nplt.style.use('seaborn')\nsns.set(font_scale=2)\npd.set_option('display.max_columns', 500)","26e0f984":"dtypes = {\n        'MachineIdentifier':                                    'category',\n        'ProductName':                                          'category',\n        'EngineVersion':                                        'category',\n        'AppVersion':                                           'category',\n        'AvSigVersion':                                         'category',\n        'IsBeta':                                               'int8',\n        'RtpStateBitfield':                                     'float16',\n        'IsSxsPassiveMode':                                     'int8',\n        'DefaultBrowsersIdentifier':                            'float16',\n        'AVProductStatesIdentifier':                            'float32',\n        'AVProductsInstalled':                                  'float16',\n        'AVProductsEnabled':                                    'float16',\n        'HasTpm':                                               'int8',\n        'CountryIdentifier':                                    'int16',\n        'CityIdentifier':                                       'float32',\n        'OrganizationIdentifier':                               'float16',\n        'GeoNameIdentifier':                                    'float16',\n        'LocaleEnglishNameIdentifier':                          'int8',\n        'Platform':                                             'category',\n        'Processor':                                            'category',\n        'OsVer':                                                'category',\n        'OsBuild':                                              'int16',\n        'OsSuite':                                              'int16',\n        'OsPlatformSubRelease':                                 'category',\n        'OsBuildLab':                                           'category',\n        'SkuEdition':                                           'category',\n        'IsProtected':                                          'float16',\n        'AutoSampleOptIn':                                      'int8',\n        'PuaMode':                                              'category',\n        'SMode':                                                'float16',\n        'IeVerIdentifier':                                      'float16',\n        'SmartScreen':                                          'category',\n        'Firewall':                                             'float16',\n        'UacLuaenable':                                         'float32',\n        'Census_MDC2FormFactor':                                'category',\n        'Census_DeviceFamily':                                  'category',\n        'Census_OEMNameIdentifier':                             'float16',\n        'Census_OEMModelIdentifier':                            'float32',\n        'Census_ProcessorCoreCount':                            'float16',\n        'Census_ProcessorManufacturerIdentifier':               'float16',\n        'Census_ProcessorModelIdentifier':                      'float16',\n        'Census_ProcessorClass':                                'category',\n        'Census_PrimaryDiskTotalCapacity':                      'float32',\n        'Census_PrimaryDiskTypeName':                           'category',\n        'Census_SystemVolumeTotalCapacity':                     'float32',\n        'Census_HasOpticalDiskDrive':                           'int8',\n        'Census_TotalPhysicalRAM':                              'float32',\n        'Census_ChassisTypeName':                               'category',\n        'Census_InternalPrimaryDiagonalDisplaySizeInInches':    'float16',\n        'Census_InternalPrimaryDisplayResolutionHorizontal':    'float16',\n        'Census_InternalPrimaryDisplayResolutionVertical':      'float16',\n        'Census_PowerPlatformRoleName':                         'category',\n        'Census_InternalBatteryType':                           'category',\n        'Census_InternalBatteryNumberOfCharges':                'float32',\n        'Census_OSVersion':                                     'category',\n        'Census_OSArchitecture':                                'category',\n        'Census_OSBranch':                                      'category',\n        'Census_OSBuildNumber':                                 'int16',\n        'Census_OSBuildRevision':                               'int32',\n        'Census_OSEdition':                                     'category',\n        'Census_OSSkuName':                                     'category',\n        'Census_OSInstallTypeName':                             'category',\n        'Census_OSInstallLanguageIdentifier':                   'float16',\n        'Census_OSUILocaleIdentifier':                          'int16',\n        'Census_OSWUAutoUpdateOptionsName':                     'category',\n        'Census_IsPortableOperatingSystem':                     'int8',\n        'Census_GenuineStateName':                              'category',\n        'Census_ActivationChannel':                             'category',\n        'Census_IsFlightingInternal':                           'float16',\n        'Census_IsFlightsDisabled':                             'float16',\n        'Census_FlightRing':                                    'category',\n        'Census_ThresholdOptIn':                                'float16',\n        'Census_FirmwareManufacturerIdentifier':                'float16',\n        'Census_FirmwareVersionIdentifier':                     'float32',\n        'Census_IsSecureBootEnabled':                           'int8',\n        'Census_IsWIMBootEnabled':                              'float16',\n        'Census_IsVirtualDevice':                               'float16',\n        'Census_IsTouchEnabled':                                'int8',\n        'Census_IsPenCapable':                                  'int8',\n        'Census_IsAlwaysOnAlwaysConnectedCapable':              'float16',\n        'Wdft_IsGamer':                                         'float16',\n        'Wdft_RegionIdentifier':                                'float16',\n        'HasDetections':                                        'int8'\n        }","a98e7f59":"%time train = pd.read_csv(\"..\/input\/train.csv\", dtype=dtypes)\n%time test = pd.read_csv(\"..\/input\/test.csv\", dtype=dtypes)","b1960cd9":"print(train.shape, test.shape)","05f2043d":"train['HasDetections'].value_counts().plot.bar()\nplt.title('HasDetections(target)')","c1f0ef85":"%%time\n# checking missing data\ntotal = train.isnull().sum().sort_values(ascending = False)\npercent = (train.isnull().sum()\/train.isnull().count()*100).sort_values(ascending = False)\nmissing_train_data  = pd.concat([total, percent], axis=1, keys=['Total', 'Percent'])\n","f5ec52ce":"missing_train_data.head(50)","80cfe081":"train_small = train # train.sample(frac=0.2).copy() # not small for now","f5ad0110":"print(train_small['PuaMode'].dtypes)","fa513dd4":"sns.countplot(x='PuaMode', hue='HasDetections',data=train_small)\nplt.show()","305a01e5":"print(train_small['Census_ProcessorClass'].dtypes)","3c2921ad":"sns.countplot(x='Census_ProcessorClass', hue='HasDetections',data=train_small)\nplt.show()","d3244fc7":"print(train_small['DefaultBrowsersIdentifier'].dtypes)","c5999b3c":"fig, ax = plt.subplots(1, 2, figsize=(16, 8))\nsns.kdeplot(train_small.loc[train['HasDetections'] == 0, 'DefaultBrowsersIdentifier'], ax=ax[0], label='NoDetection(0)')\nsns.kdeplot(train_small.loc[train['HasDetections'] == 1, 'DefaultBrowsersIdentifier'], ax=ax[0], label='HasDetection(1)')\n\ntrain_small.loc[train['HasDetections'] == 0, 'DefaultBrowsersIdentifier'].hist(ax=ax[1])\ntrain_small.loc[train['HasDetections'] == 1, 'DefaultBrowsersIdentifier'].hist(ax=ax[1])\nax[1].legend(['NoDetection(0)', 'HasDetection(1)'])\n\nplt.show()","68c45de6":"print(train_small['Census_IsFlightingInternal'].dtypes)","01c5358e":"fig, ax = plt.subplots(1, 2, figsize=(16, 8))\nsns.kdeplot(train_small.loc[train['HasDetections'] == 0, 'Census_IsFlightingInternal'], ax=ax[0], label='NoDetection(0)')\nsns.kdeplot(train_small.loc[train['HasDetections'] == 1, 'Census_IsFlightingInternal'], ax=ax[0], label='HasDetection(1)')\n\ntrain_small.loc[train['HasDetections'] == 0, 'Census_IsFlightingInternal'].hist(ax=ax[1])\ntrain_small.loc[train['HasDetections'] == 1, 'Census_IsFlightingInternal'].hist(ax=ax[1])\nax[1].legend(['NoDetection(0)', 'HasDetection(1)'])\n\nplt.show()","2b511dce":"train_small.loc[train['HasDetections'] == 1, 'Census_IsFlightingInternal'].value_counts()","5c728069":"train_small.loc[train['HasDetections'] == 0, 'Census_IsFlightingInternal'].value_counts()","9897ccfe":"print(train_small['Census_InternalBatteryType'].dtypes)","c27a8014":"train_small['Census_InternalBatteryType'].value_counts()","fa9d0300":"def group_battery(x):\n    x = x.lower()\n    if 'li' in x:\n        return 1\n    else:\n        return 0\n    \ntrain_small['Census_InternalBatteryType'] = train_small['Census_InternalBatteryType'].apply(group_battery)","b9a7b49d":"sns.countplot(x='Census_InternalBatteryType', hue='HasDetections',data=train_small)\nplt.show()","9a564da9":"null_cols_to_remove = ['DefaultBrowsersIdentifier', 'PuaMode',\n                       'Census_IsFlightingInternal', 'Census_InternalBatteryType']\n\ntrain.drop(null_cols_to_remove, axis=1, inplace=True)\ntest.drop(null_cols_to_remove, axis=1, inplace=True)","a7d67822":"categorical_features = [\n        'ProductName',                                          \n        'EngineVersion',                                        \n        'AppVersion',                                           \n        'AvSigVersion',                                         \n        'Platform',                                             \n        'Processor',                                            \n        'OsVer',                                                \n        'OsPlatformSubRelease',                                 \n        'OsBuildLab',                                           \n        'SkuEdition',                                           \n        'SmartScreen',                                          \n        'Census_MDC2FormFactor',                                \n        'Census_DeviceFamily',                                  \n        'Census_PrimaryDiskTypeName',                           \n        'Census_ChassisTypeName',                               \n        'Census_PowerPlatformRoleName',                         \n        'Census_OSVersion',                                     \n        'Census_OSArchitecture',                                \n        'Census_OSBranch',                                      \n        'Census_OSEdition',                                     \n        'Census_OSSkuName',                                     \n        'Census_OSInstallTypeName',                             \n        'Census_OSWUAutoUpdateOptionsName',                     \n        'Census_GenuineStateName',                              \n        'Census_ActivationChannel',                             \n        'Census_FlightRing',                                    \n]","dbc1d453":"def plot_category_percent_of_target(col):\n    fig, ax = plt.subplots(1, 1, figsize=(15, 10))\n    cat_percent = train_small[[col, 'HasDetections']].groupby(col, as_index=False).mean()\n    cat_size = train_small[col].value_counts().reset_index(drop=False)\n    cat_size.columns = [col, 'count']\n    cat_percent = cat_percent.merge(cat_size, on=col, how='left')\n    cat_percent['HasDetections'] = cat_percent['HasDetections'].fillna(0)\n    cat_percent = cat_percent.sort_values(by='count', ascending=False)[:20]\n    sns.barplot(ax=ax, x='HasDetections', y=col, data=cat_percent, order=cat_percent[col])\n\n    for i, p in enumerate(ax.patches):\n        ax.annotate('{}'.format(cat_percent['count'].values[i]), (p.get_width(), p.get_y()+0.5), fontsize=20)\n\n    plt.xlabel('% of HasDetections(target)')\n    plt.ylabel(col)\n    plt.show()","f8895dc7":"col = categorical_features[0]\nplot_category_percent_of_target(col)","49f7fecd":"col = categorical_features[1]\nplot_category_percent_of_target(col)","c4438b87":"col = categorical_features[2]\nplot_category_percent_of_target(col)","ae7f5f08":"col = categorical_features[3]\nplot_category_percent_of_target(col)","e6da6733":"col = categorical_features[4]\nplot_category_percent_of_target(col)","2929efac":"col = categorical_features[5]\nplot_category_percent_of_target(col)","04b56269":"col = categorical_features[6]\nplot_category_percent_of_target(col)","27df1e60":"col = categorical_features[7]\nplot_category_percent_of_target(col)","67f1dac4":"col = categorical_features[8]\nplot_category_percent_of_target(col)","5fe0185b":"col = categorical_features[9]\nplot_category_percent_of_target(col)","47e4bdf0":"col = categorical_features[10]\nplot_category_percent_of_target(col)","cb9ca415":"col = categorical_features[11]\nplot_category_percent_of_target(col)","90a27132":"col = categorical_features[12]\nplot_category_percent_of_target(col)","6083954d":"col = categorical_features[13]\nplot_category_percent_of_target(col)","07c83851":"col = categorical_features[14]\nplot_category_percent_of_target(col)","e4acca85":"col = categorical_features[15]\nplot_category_percent_of_target(col)","b49f3c14":"col = categorical_features[16]\nplot_category_percent_of_target(col)","82d684cf":"col = categorical_features[17]\nplot_category_percent_of_target(col)","014cf9c8":"col = categorical_features[18]\nplot_category_percent_of_target(col)","9e8c91ac":"col = categorical_features[19]\nplot_category_percent_of_target(col)","a2e3589d":"col = categorical_features[20]\nplot_category_percent_of_target(col)","8af0fee9":"col = categorical_features[21]\nplot_category_percent_of_target(col)","ae5a8a06":"col = categorical_features[22]\nplot_category_percent_of_target(col)","8a70fe4a":"col = categorical_features[23]\nplot_category_percent_of_target(col)","de55dc17":"col = categorical_features[24]\nplot_category_percent_of_target(col)","84dacd49":"col = categorical_features[25]\nplot_category_percent_of_target(col)","6dba7797":"numeric_features = [\n        'IsBeta',                                               \n        'RtpStateBitfield',                                     \n        'IsSxsPassiveMode',                                     \n        'DefaultBrowsersIdentifier',                            \n        'AVProductStatesIdentifier',                            \n        'AVProductsInstalled',                                  \n        'AVProductsEnabled',                                    \n        'HasTpm',                                               \n        'CountryIdentifier',                                    \n        'CityIdentifier',                                       \n        'OrganizationIdentifier',                               \n        'GeoNameIdentifier',                                    \n        'LocaleEnglishNameIdentifier',                          \n        'OsBuild',                                              \n        'OsSuite',                                              \n        'IsProtected',                                          \n        'AutoSampleOptIn',                                      \n        'SMode',                                                \n        'IeVerIdentifier',                                      \n        'Firewall',                                             \n        'UacLuaenable',                                         \n        'Census_OEMNameIdentifier',                             \n        'Census_OEMModelIdentifier',                            \n        'Census_ProcessorCoreCount',                            \n        'Census_ProcessorManufacturerIdentifier',               \n        'Census_ProcessorModelIdentifier',                      \n        'Census_PrimaryDiskTotalCapacity',                      \n        'Census_SystemVolumeTotalCapacity',                     \n        'Census_HasOpticalDiskDrive',                           \n        'Census_TotalPhysicalRAM',                              \n        'Census_InternalPrimaryDiagonalDisplaySizeInInches',    \n        'Census_InternalPrimaryDisplayResolutionHorizontal',    \n        'Census_InternalPrimaryDisplayResolutionVertical',      \n        'Census_InternalBatteryNumberOfCharges',                \n        'Census_OSBuildNumber',                                 \n        'Census_OSBuildRevision',                               \n        'Census_OSInstallLanguageIdentifier',                   \n        'Census_OSUILocaleIdentifier',                          \n        'Census_IsPortableOperatingSystem',                     \n        'Census_IsFlightsDisabled',                             \n        'Census_ThresholdOptIn',                                \n        'Census_FirmwareManufacturerIdentifier',                \n        'Census_FirmwareVersionIdentifier',                     \n        'Census_IsSecureBootEnabled',                           \n        'Census_IsWIMBootEnabled',                              \n        'Census_IsVirtualDevice',                               \n        'Census_IsTouchEnabled',                                \n        'Census_IsPenCapable',                                  \n        'Census_IsAlwaysOnAlwaysConnectedCapable',              \n        'Wdft_IsGamer',                                         \n        'Wdft_RegionIdentifier',                                \n]","9a929ac4":"def plot_category_percent_of_target_for_numeric(col):\n    fig, ax = plt.subplots(1, 2, figsize=(20, 8))\n    cat_percent = train_small[[col, 'HasDetections']].groupby(col, as_index=False).mean()\n    cat_size = train_small[col].value_counts().reset_index(drop=False)\n    cat_size.columns = [col, 'count']\n    cat_percent = cat_percent.merge(cat_size, on=col, how='left')\n    cat_percent['HasDetections'] = cat_percent['HasDetections'].fillna(0)\n    cat_percent = cat_percent.sort_values(by='count', ascending=False)[:20]\n    cat_percent[col] = cat_percent[col].astype('category')\n    sns.barplot(ax=ax[0], x='HasDetections', y=col, data=cat_percent,  order=cat_percent[col])\n\n    for i, p in enumerate(ax[0].patches):\n        ax[0].annotate('{}'.format(cat_percent['count'].values[i]), (p.get_width(), p.get_y()+0.5), fontsize=20)\n\n    ax[0].set_title('Barplot sorted by count', fontsize=20)\n\n    sns.barplot(ax=ax[1], x='HasDetections', y=col, data=cat_percent)\n    for i, p in enumerate(ax[0].patches):\n        ax[1].annotate('{}'.format(cat_percent['count'].sort_index().values[i]), (0, p.get_y()+0.6), fontsize=20)\n    ax[1].set_title('Barplot sorted by index', fontsize=20)\n\n    plt.xlabel('% of HasDetections(target)')\n    plt.ylabel(col)\n    plt.subplots_adjust(wspace=0.5, hspace=0)\n    plt.show()\n\ndef plot_kde_hist_for_numeric(col):\n    fig, ax = plt.subplots(1, 2, figsize=(16, 8))\n    sns.kdeplot(train_small.loc[train['HasDetections'] == 0, col], ax=ax[0], label='NoDetection(0)')\n    sns.kdeplot(train_small.loc[train['HasDetections'] == 1, col], ax=ax[0], label='HasDetection(1)')\n\n    train_small.loc[train['HasDetections'] == 0, col].hist(ax=ax[1], bins=100)\n    train_small.loc[train['HasDetections'] == 1, col].hist(ax=ax[1], bins=100)\n\n    plt.suptitle(col, fontsize=30)\n    ax[0].set_yscale('log')\n    ax[0].set_title('KDE plot')\n    \n    ax[1].set_title('Histogram')\n    ax[1].legend(['NoDetection(0)', 'HasDetection(1)'])\n    ax[1].set_yscale('log')\n    plt.show()","06ec5fd2":"col = numeric_features[0]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","c888f9ea":"col = numeric_features[1]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","735a0d88":"col = numeric_features[2]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","e35e077e":"col = numeric_features[3]\n\nplot_kde_hist_for_numeric(col)\n# plot_category_percent_of_target_for_numeric(col)","169ed480":"col = numeric_features[4]\n\nplot_kde_hist_for_numeric(col)\n# plot_category_percent_of_target_for_numeric(col)","691aa798":"col = numeric_features[5]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","a2a4c39a":"col = numeric_features[6]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","74ebcf42":"col = numeric_features[7]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","4312ab8d":"col = numeric_features[8]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","3558f75c":"col = numeric_features[9]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","e03fde0b":"col = numeric_features[10]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","020be8c4":"col = numeric_features[11]\n\nplot_kde_hist_for_numeric(col)\n# plot_category_percent_of_target_for_numeric(col)","2a37510d":"col = numeric_features[12]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","405534f0":"col = numeric_features[13]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","b5273664":"col = numeric_features[14]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","04b0c058":"col = numeric_features[15]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","146915d2":"col = numeric_features[16]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","3238ff5c":"col = numeric_features[17]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","bcef490e":"col = numeric_features[18]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","8aee055d":"col = numeric_features[19]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","7572deda":"col = numeric_features[20]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","273a654c":"col = numeric_features[21]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","9fd427f1":"col = numeric_features[22]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","7c2e36ec":"col = numeric_features[23]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","cbf0a9de":"col = numeric_features[24]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","82eeaf86":"col = numeric_features[25]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","682a2287":"col = numeric_features[26]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","cd702030":"col = numeric_features[27]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","8d198b28":"col = numeric_features[28]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","ba02b343":"col = numeric_features[29]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","a15be4ba":"col = numeric_features[30]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","cef7b3f1":"col = numeric_features[31]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","2d237a84":"col = numeric_features[32]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","2b318217":"col = numeric_features[34]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","1155ee4b":"col = numeric_features[36]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","99a8de1f":"col = numeric_features[37]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","e3d24fb0":"col = numeric_features[38]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","ec59aa32":"col = numeric_features[39]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","e4a10840":"col = numeric_features[40]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","37d4902d":"col = numeric_features[41]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","15fe07df":"col = numeric_features[42]\n\nplot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","72248d50":"col = numeric_features[43]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","d38e4983":"col = numeric_features[44]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","556f13fc":"col = numeric_features[45]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","bbc850a6":"col = numeric_features[46]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","6c20efe6":"col = numeric_features[47]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","00d06c72":"col = numeric_features[48]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","52c52862":"col = numeric_features[49]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","3b8873ef":"col = numeric_features[50]\n\n# plot_kde_hist_for_numeric(col)\nplot_category_percent_of_target_for_numeric(col)","cd088d1f":"corr = train_small.corr()['HasDetections']","5ecc7a93":"abs(corr).sort_values(ascending=False)","693f525d":"def corr_heatmap(cols):\n    correlations = train_small[cols+['HasDetections']].corr()\n    # Create color map ranging between two colors\n    cmap = sns.diverging_palette(220, 10, as_cmap=True)\n    fig, ax = plt.subplots(figsize=(10, 10))\n    sns.heatmap(correlations, cmap=cmap, vmax=1.0, center=0, fmt='.2f',\n                square=True, linewidths=.5, annot=True, cbar_kws={\"shrink\": .75})\n    plt.show()","5b4fc844":"corr_heatmap(numeric_features[:10])","6b0cf3c5":"corr_heatmap(numeric_features[10:20])","894d3a8d":"corr_heatmap(numeric_features[20:30])","327e7afe":"corr_heatmap(numeric_features[30:40])","64811f1c":"corr_heatmap(numeric_features[40:])","0b58947a":"corr = train_small.corr()","f53fb54d":"upper = corr.where(np.triu(np.ones(corr.shape), k=1).astype(np.bool))\nupper.head()","401ce26c":"threshold = 0.3\nfor i, df in (upper.iterrows()):\n    for ele in df[df.abs() > threshold].items():\n        if ele[0] == i:\n            break\n        else:\n            plt.figure(figsize=(7, 7))\n            sns.lmplot(x=i, y=ele[0], data=train_small[:100000], hue='HasDetections', palette='Set1', scatter_kws={'alpha':0.3})\n            plt.show()\n            print('{:50}, {:50} : {}'.format(i, ele[0], ele[1]))","3ffd21b9":"### 2.1.26 Census_IsFlightingInternal - NA","17d2a29a":"### 2.2.24 Census_ProcessorCoreCount - Number of logical cores in the processor","6b3639c2":"### 2.2.49 Census_IsAlwaysOnAlwaysConnectedCapable - Retreives information about whether the battery enables the device to be AlwaysOnAlwaysConnected .","d43658b1":"### 2.2.44 Census_IsSecureBootEnabled - Indicates if Secure Boot mode is enabled.","b737b58d":"### 2.2.3 IsSxsPassiveMode - NA","47203b1a":"### 2.2.19 IeVerIdentifier - NA","1edf87c6":"### 2.1.16 Census_PowerPlatformRoleName - Indicates the OEM preferred power management profile","ba0ae5f6":"### 1.1.5 Census_InternalBatteryType","83b1f4f5":"### Census_PrimaryDiskTotalCapacity - Amount of disk space on primary disk of the machine in MB","efeabf81":"### 2.1.10 SkuEdition - The goal of this feature is to use the Product Type defined in the MSDN to map to a 'SKU-Edition' name that is useful in population reporting. ","2bc8e1ac":"### 2.2.35 Census_OSBuildNumber - OS Build number extracted from the OsVersionFull. Example - OsBuildNumber = 10512 or 10240","20c38415":"### 2.2.40 Census_IsFlightsDisabled - Indicates if the machine is participating in flighting.","373feb98":"### 2.2.38 Census_OSUILocaleIdentifier - NA","15495e3b":"### 2.2.1 IsBeta - Defender state information e.g. false","3e0c5983":"- Some difference exists there. But, the samples are quite few, so remove this feature.","86821644":"### 2.1.19 Branch of the OS extracted from the OsVersionFull","d7676381":"### 2.2.31 Census_InternalPrimaryDiagonalDisplaySizeInInches - Retrieves the physical diagonal length in inches of the primary display","2e057a6d":"### 2.2.51 Wdft_RegionIdentifier - NA","c324734d":"### 2.2.16 IsProtected - This is a calculated field derived from the Spynet Report's AV Products field.\n- a. TRUE if there is at least one active and up-to-date antivirus product running on this machine. b. FALSE if there is no active AV product on this machine, or if the AV is active, but is not receiving the latest updates. c. null if there are no Anti Virus Products in the report. Returns: Whether a machine is protected.","74c3a129":"## 1.1 Read dataset","5b1389b3":"## 2.2 numeric features","46cce6f2":"### 2.1.2 EngineVersion - Defender state information e.g. 1.1.12603.0","dec23afd":"### 1.1.4 Census_IsFightingInternal","f57c99a5":"### 2.2.26 Census_ProcessorModelIdentifier - NA","f283a413":"- As you can see, almost value of 'Census_IsFlightingInternal' is 0.0. Just remove.","7eb5b17d":"#### Many features are categorical and the pairs which have high correlations are also composed of categorial features.\n#### I think that the keypoint is to make some features which have categories with high probability of infection from malwares.\n#### some features are redundant.","6ff0dee6":"### 2.2.30 Census_TotalPhysicalRAM - Retrieves the physical RAM in MB","91091f8c":"### 2.2.13 LocaleEnglishNameIdentifier - English name of Locale ID of the current user","605c7d6c":"## 1.2 Check the target","437bf58f":"- DefaultBrowsersIdentifier means ' ID for the machine's default browser'.\n- Is this feature meaningful?","e7707a31":"### 2.2.39 Census_IsPortableOperatingSystem - Indicates whether OS is booted up and running via Windows-To-Go on a USB stick.","cbdf75e1":"- This parted was taken from the helpful kernel. https:\/\/www.kaggle.com\/theoviel\/load-the-totality-of-the-data","46415564":"### 2.2.41 Census_ThresholdOptIn - NA","e2b1b412":"### 2.1.13 Census_DeviceFamily - AKA DeviceClass. Indicates the type of device that an edition of the OS is intended for. ","24fe43a6":"### 2.1.6 Processor - This is the process architecture of the installed operating system","c8d5ce0f":"- The meaning of 'Census_ProcessorClassr' is 'Number of logical cores in the processor'.\n- You can check that the more logical cores, the more probable infection with malwares.\n- This feature could be a good features only or component for the combinations with other features. Keep this and think it!","816a17ec":"### 2.1.5 Platform - Calculates platform name (of OS related properties and processor property)","54439c28":"- Exploring data is an exciting journey. During this, we can mine some interesting intuition for high AUC!","235d0897":"### 2.2.45 Census_IsWIMBootEnabled - NA","b4cb00e7":"### 2.2.22 Census_OEMNameIdentifier - NA","4e7144de":"### 2.2.12 GeoNameIdentifier - ID for the geographic region a machine is located in","0cd6d222":"### 2.2.42 Census_FirmwareManufacturerIdentifier - NA","4a6298e8":"### 2.2.7 AVProductsEnabled - NA","82a84486":"### 2.2.29 Census_HasOpticalDiskDrive - True indicates that the machine has an optical disk drive (CD\/DVD)","838e6492":"### 2.2.2 RtpStateBitfield - NA","08d59101":"### 2.2.50 Wdft_IsGamer - Indicates whether the device is a gamer device or not based on its hardware combination.","dabf05bf":"- The difference is quite small. Do you think that some malwares recognize and select machine based on the type of battery?\n- Battery is very important part for life of machine. I think that malware will focus on other hardware and software parts of machine. remove this.","abc95b42":"### 2.2.23 Census_OEMModelIdentifier - NA","397941d7":"### 2.1.7 Census_OSVersion - Numeric OS version Example - 10.0.10130.0","342eb740":"### 2.2.6 AVProductsInstalled - NA","9b567f19":"### 1.1.1 PuaMode","3f5594c6":"### 2.2.32 Census_InternalPrimaryDisplayResolutionHorizontal - Retrieves the number of pixels in the horizontal direction of the internal display.","12a8957d":"### 2.2.10 CityIdentifier - ID for the city the machine is located in","1a17081b":"### 2.1.24 Census_GenuineStateName - Friendly name of OSGenuineStateID. 0 = Genuine","98a5d993":"### 2.1.18 Census_OSArchitecture - Architecture on which the OS is based","1d4bc02d":"# 1. Read and check dataset","40e6fee0":"### 2.2.8 HasTpm - True if machine has tpm","bb57b76c":"### 2.2.43 Census_FirmwareVersionIdentifier - NA","44bd0e0a":"### 2.1.17 Census_OSVersion - Numeric OS version Example","163f8d41":"### 2.2.47 Census_IsTouchEnabled - Is this a touch device ?","b4a65c74":"## 3. Correlations","c41c499c":"### 2.1.14 Census_PrimaryDiskTotalCapacity - Amount of disk space on primary disk of the machine in MB","6b5b99f1":"### 2.1.15 Census_ChassisTypeName - Retrieves a numeric representation of what type of chassis the machine has","bf864c07":"### 2.2.25 Census_ProcessorManufacturerIdentifier - NA","9590826c":"- Wow, very-well balanced target! Fun with this competition :).","45c037a4":"### 2.2.33 Census_InternalPrimaryDisplayResolutionVertical - Retrieves the number of pixels in the vertical direction of the internal display","070f7f01":"### 2.2.4 DefaultBrowsersIdentifier - ID for the machine's default browser","69062624":"### 2.1.1 ProductName - Defender state information e.g. win8defender","20d3447e":"### 2.2.21 UacLuaenable - This attribute reports whether or not the \"administrator in Admin Approval Mode\" user type is disabled or enabled in UAC. The value reported is obtained by reading the regkey HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLUA.","b577be36":"### 2.2.5 AVProductStatesIdentifier - ID for the specific configuration of a user's antivirus software","7c034eab":"### 2.1.11 SmartScreen - This is the SmartScreen enabled string value from registry. This is obtained by checking in order, ","73ad9972":"### 2.2.15 OsSuite - Product suite mask for the current operating system.","3304e7e0":"## 1.2 Check the dataset","cbec2641":"### 1.1.2 Census_ProcessorClass","e77607ca":"### 2.2.46 Census_IsVirtualDevice - Identifies a Virtual Machine (machine learning model)","989ab7a5":"### 1.1.3 DefaultBrosersIdentifier","4d023b15":"### 2.2.11 OrganizationIdentifier - ID for the organization the machine belongs in, organization ID is mapped to both specific companies and broad industries","5b5814ed":"### 2.1.3 AppVersion - Defender state information e.g. 4.9.10586.0","5536cdea":"### 2.1.8 OsPlatformSubRelease - Returns the OS Platform sub-release (Windows Vista, Windows 7, Windows 8, TH1, TH2)","74eef75a":"### 2.1.20 Census_OSEdition - Edition of the current OS","c61a3220":"### 2.1.23 Census_OSWUAutoUpdateOptionsName - Friendly name of the WindowsUpdate auto-update settings on the machine.","9cef1b45":"## 2.1 Categorical features","93596dde":"### 2.1.25 Census_ActivationChannel - Retail license key or Volume license key for a machine.","cb75b7b2":"### 2.1.4 AvSigVersion - Defender state information e.g. 1.217.1014.0","1394e65e":"### 2.2.17 AutoSampleOptIn - This is the SubmitSamplesConsent value passed in from the service, available on CAMP 9+","5b811f7c":"# To be updated. Please votes if you think this kernel is helpful!","f1d6c72b":"### 2.2.9 CountryIdentifier - ID for the country the machine is located in","dada0c39":"- PuaMode, Census_ProcessorClass, DefaultBrowsersIdentifier, Census_IsFlightingInternal and Census_InternalBatteryType have over 70% null data.\n- Let's check their distribution regarding to the target.\n- Because datasets are large, let's compare the distributions using 10% of train.[](http:\/\/)","92ec334f":"### 2.1.22 Census_PrimaryDiskTypeName - Friendly name of Primary Disk Type - HDD or SSD","bc7284b8":"- You can see that the datasets are large.","df280643":"### 2.2.28 Census_SystemVolumeTotalCapacity - The size of the partition that the System volume is installed on in MB","69efd75f":"### 2.2.20 Firewall - This attribute is true (1) for Windows 8.1 and above if windows firewall is enabled, as reported by the service.","c8b5d4db":"### 2.2.48 Census_IsPenCapable - Is the device capable of pen input ?","d3885e07":"### 2.1.21 Census_OSSkuName - OS edition friendly name","11b9e779":"### 2.2.37 Census_OSInstallLanguageIdentifier - NA","c8ebe32b":"## 2. Exploratory data analysis","f1adef8e":"### 2.2.18 SMode - This field is set to true when the device is known to be in 'S Mode', as in, Windows 10 S mode, where only Microsoft Store apps can be installed","dfecc223":"### 2.1.12 Census_MDC2FormFactor - A grouping based on a combination of Device Census level hardware characteristics.**","7cbe43b1":"- I think this feature means the type of batteries of each machine.\n- Oh, no....These days, most batteries are lithum-ion battery.\n- So, Let's group them into lithum-batter group and non0-lithum-battery group","bf69a52a":"### 2.2.14 OsBuild - Build of the current operating system","bba0df58":"### 2.1.9 OsBuildLab - Build lab that generated the current OS. Example: 9600.17630.amd64fre.winblue_r7.150109-2022"}}