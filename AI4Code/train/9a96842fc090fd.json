{"cell_type":{"8e21c383":"code","1b071ab3":"code","a6645060":"code","b05edf32":"code","666a6417":"code","b6438588":"code","e8b5ca11":"code","13bf7868":"code","b5bc807e":"code","2f93d53e":"code","8c32ec68":"code","2f9bcb53":"code","2e3ab68d":"code","e20775ee":"code","b1e62c89":"code","79158c74":"code","313b9cc2":"code","c9c034ee":"code","b8fe89a0":"code","865f7e42":"code","7434713b":"code","1035b39e":"code","4e0aad06":"code","39b43a63":"code","20f28668":"code","077c3b79":"code","ebd727d7":"markdown","e124594e":"markdown","077deaa9":"markdown","0c3d0db7":"markdown","858a1bd5":"markdown","a94d4a7b":"markdown","3b1eaf5f":"markdown","012938b5":"markdown","76be8f9d":"markdown","558edf40":"markdown","ad1bdc0c":"markdown","a5d963b9":"markdown","6fee0b39":"markdown"},"source":{"8e21c383":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","1b071ab3":"%matplotlib inline\n#DATA MANIPULATION\nimport numpy as np \nimport pandas as pd \n\n#DATA VISUALISATION\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n#STYLE MANIPULATIONS\nsns.set_style(\"whitegrid\")\nplt.style.use(\"fivethirtyeight\")\npd.set_option(\"display.float_format\", \"{:.4f}\".format)\npd.set_option(\"display.max_columns\", 80)\npd.set_option(\"display.max_rows\", 80)\n\n#MACHINE LEARNING\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.model_selection import validation_curve\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import confusion_matrix\n\n\n","a6645060":"df=pd.read_csv('..\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')\ndf.head()","b05edf32":"#VARIABLES TYPES\ndf.dtypes.value_counts().plot.pie( autopct='%1.1f%%',shadow=True, startangle=90)\ndf.dtypes.value_counts()\n","666a6417":"#Take AN IDEA ABOUT THE DATA\n\ndf.shape\n","b6438588":"df.isna().sum()\n","e8b5ca11":"#A DESCRIPTION ABOUT THE DATA :\ndf.describe()","13bf7868":"#KNOWING THE VARIABLES BETTER:\nfor column in df.columns:\n    print(f\"{column}: Number of unique values {df[column].nunique()}\")\n    print(\"==========================================================\")","b5bc807e":"# DEATH_EVENT VISUALIZATION:\ntarget=\"DEATH_EVENT\"\ndf[target].value_counts().plot.pie( autopct='%1.1f%%',shadow=True, startangle=90)\nplt.show()","2f93d53e":"explode = (0, 0.07)\nlabels = ['Female', 'Male']\ndf.groupby('sex').size().plot(kind='pie',textprops={'fontsize': 20}, colors=['violet', 'blue'],explode=explode,startangle=90,labels=labels,autopct='%1.1f%%',shadow=True,label='gender')\nplt.show()","8c32ec68":"cnt=df.groupby(['DEATH_EVENT','sex']).size() #1:male and 2:female\nprint(cnt)","2f9bcb53":"#DOES THE SEX HAVE AND EFFECT ON THE DEATH_EVENT(TARGET) ? \nplt.figure(figsize=(30,20))\nplt.subplot(4, 4, 5)\nplt.hist(df[df[\"sex\"]==1][\"DEATH_EVENT\"].reset_index(drop=True), alpha=0.6, label=\"Male\",color='blue')\nplt.hist(df[df[\"sex\"]==0][\"DEATH_EVENT\"].reset_index(drop=True), alpha=0.6, label=\"Female\",color='violet')\nplt.title('sex and death_event')\nplt.legend()\n\n\n#DOES THE ANAEMIA HAVE AN EFFECT ON THE DEATH_EVENT ?\nplt.subplot(4, 4,1)\nplt.hist(df[df[\"anaemia\"]==1][\"DEATH_EVENT\"].reset_index(drop=True), alpha=0.6, label=\"Yes\",color='darkblue')\nplt.hist(df[df[\"anaemia\"]==0][\"DEATH_EVENT\"].reset_index(drop=True), alpha=0.6, label=\"No\",color='pink')\nplt.title('anaemia and death_event')\nplt.legend()\n\n#DOES THE DIABETES HAVE AN EFFECT ON THE DEATH_EVENT ? \nplt.subplot(4, 4, 2)\nplt.hist(df[df[\"diabetes\"]==1][\"DEATH_EVENT\"].reset_index(drop=True), alpha=0.6, label=\"Yes\",color='crimson')\nplt.hist(df[df[\"diabetes\"]==0][\"DEATH_EVENT\"].reset_index(drop=True), alpha=0.6, label=\"No\",color='plum')\nplt.title('diabetes and death_event')\nplt.legend()\n\n\n#DOES THE HIGH_BLOOD_PRESSURE HAVE AN EFFECT ON THE DEATH_EVENT ? \nplt.subplot(4, 4, 3)\nplt.hist(df[df[\"high_blood_pressure\"]==1][\"DEATH_EVENT\"].reset_index(drop=True), alpha=0.6, label=\"Yes\",color='red')\nplt.hist(df[df[\"high_blood_pressure\"]==0][\"DEATH_EVENT\"].reset_index(drop=True), alpha=0.6, label=\"No\",color='black')\nplt.title('HBP and death_event')\nplt.legend()\n\n\n#DOES THE SMOKING HAVE AN EFFECT ON THE DEATH_EVENT ?\nplt.subplot(4, 4, 4)\nplt.hist(df[df[\"smoking\"]==1][\"DEATH_EVENT\"].reset_index(drop=True), alpha=0.6, label=\"Yes\",color='red')\nplt.hist(df[df[\"smoking\"]==0][\"DEATH_EVENT\"].reset_index(drop=True), alpha=0.6, label=\"No\",color='black')\nplt.title('smoking and death_event')\nplt.legend()\nplt.show()\n","2e3ab68d":"#WE WANT TO SEE THE RELATIONS BETWEEN THE FEATURES\nsns.pairplot(df, hue=\"DEATH_EVENT\")\nplt.show()","e20775ee":"plt.figure(figsize=(10,8))\ncorrelation=df.corr()\nsns.heatmap(correlation,annot=True,mask=np.triu(np.ones_like(correlation, dtype=np.bool)), fmt=\".2f\", cmap='Blues',\n           vmin=-1, vmax=1, cbar_kws={\"shrink\": .8})\nplt.show()","b1e62c89":"X=df.drop(['DEATH_EVENT'],axis=1)\ny=df['DEATH_EVENT']","79158c74":"X_train, X_test, y_train, y_test = train_test_split(X,y, test_size=0.2)\nprint(X_train.shape)\nprint(y_train.shape)","313b9cc2":"X=df[['creatinine_phosphokinase','ejection_fraction','high_blood_pressure','platelets','serum_creatinine','serum_sodium','sex','smoking','time']].values\ny=df[['DEATH_EVENT']].values\n#SPLIT\nX_train, X_test, y_train, y_test = train_test_split(X,y, test_size=0.2)\ny_train=y_train.ravel()\ny_test=y_test.ravel()\n\n\n","c9c034ee":"model=LogisticRegression()\nmodel.fit(X_train,y_train)\ny_pred=model.predict(X_test)\n","b8fe89a0":"#SCORE\nmodel.score(X_test,y_test)","865f7e42":"plt.figure(figsize=(10,8))\nn=40\nplt.plot(y_test[:n])\nplt.plot(y_pred[:n],'o')\nplt.show()","7434713b":"#COEFFICIENT\nprint(model.coef_,model.intercept_)","1035b39e":"model=RandomForestClassifier()\nmodel.fit(X_train,y_train)","4e0aad06":"#SCORE \nmodel.score(X_test,y_test)","39b43a63":"cross_val_score(RandomForestClassifier(),X_train,y_train,cv=5,scoring='accuracy')","20f28668":"#ACCURACY MEAN:\ncross_val_score(RandomForestClassifier(),X_train,y_train,cv=5,scoring='accuracy').mean()","077c3b79":"#PLOT\nk=np.arange(1,50)\ntrain_score, val_score=validation_curve(RandomForestClassifier(),X_train,y_train,'n_estimators',k,cv=5)\nplt.plot(k,val_score.mean(axis=1),label='val')\nplt.plot(k,train_score.mean(axis=1),label='train')\nplt.legend()\nplt.show()","ebd727d7":"# BUILDING THE MODEL :","e124594e":"_  the plots above show us the effect of each feature on death event. we mentioned earlier that sex can't be a judge in this study in particular because the number of males and female is not the same. Second we couldn't say that anaemia causes heart failure but we can definitely see that patients who had anaemia represent the majority of the death event cases compared with patients who had not. the same thing could be said about patients who suffer from diabetes and high blood pressure. for the smoking feature it is not the case according to the plot 'smoking and death event' but we can see that an important number of patients who died from heart failure were smokers.\n\n--> then we can assume as mentioned before that those features and maybe others could worsen the case of patients susceptible to die because of heart failure, but can't say if any o them lead to heart failure alone.","077deaa9":"### RandomForestClassifier:","0c3d0db7":"# **DATA VISUALIZATION :**","858a1bd5":"-->  The pie chart shows that the number of females is less than males in these observations so we cannot decide whether the Death Event has something to do with the gender of the patients.","a94d4a7b":"--> WE DON'T HAVE ANY MISSING VALUE IN OUR DATA (NAN)","3b1eaf5f":"### LOGISTIC REGRESSION:","012938b5":"# DATA PREPROCESSING :","76be8f9d":"#### ACCURACY:","558edf40":"--> The heatmap shows the correlation between the features if we consider the correlation between Death Event and other features, we can see that only time has a low negative correlation (to the death event(target)); serum creatinine has a low correlation with it and finally ejection fraction has also a low correlation but negatively.","ad1bdc0c":"# **CORRELATION:**","a5d963b9":"**SPLIT THE DATA**","6fee0b39":"![heartdiseases759.jpg](attachment:heartdiseases759.jpg)"}}