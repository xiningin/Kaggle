{"cell_type":{"2d15438a":"code","4e9455cd":"code","c1c5dc81":"code","dfe7a0fd":"code","f9747b3c":"code","901b73ad":"code","b269f846":"code","804ba57d":"code","adda1ba3":"code","7422eef3":"code","50fb1e73":"code","0d178364":"code","3d1c5e61":"code","09e86cc6":"code","81c1aae5":"markdown","7ce1589f":"markdown","838ea39e":"markdown","c9e7de4c":"markdown","079ed17e":"markdown","3653415b":"markdown","49c3cd5a":"markdown","50b0750f":"markdown","ab180249":"markdown","9e62f39c":"markdown","cf6e1182":"markdown","e676da34":"markdown","dccb856e":"markdown"},"source":{"2d15438a":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","4e9455cd":"import pandas as pd","c1c5dc81":"data_df = pd.read_csv(\"\/kaggle\/input\/mobile-students-from-abroad-in-europe\/educ_uoe_mobs01.tsv\", sep='\\t')","dfe7a0fd":"print(list(data_df.columns))","f9747b3c":"data_df.head()","901b73ad":"data_df.tail()","b269f846":"pivot_data_col = data_df.columns[0]\nyear_columns = data_df.columns[1:]","804ba57d":"data_df['unit'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[0])\ndata_df['isced11'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[1])\ndata_df['isced13'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[2])\ndata_df['sex'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[3])\ndata_df['geo']     = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[4])","adda1ba3":"selected_columns = list(['unit', 'isced11', 'isced13', 'sex', 'geo']) +  list(year_columns)\ndata_df = data_df[selected_columns]","7422eef3":"data_tr_df = data_df.melt(id_vars=['unit', 'isced11', 'isced13', 'sex', 'geo'], \n        var_name=\"year\", \n        value_name=\"value\")\ndata_tr_df['geo'] = data_tr_df['geo'].apply(lambda x: str(x))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"e\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"b\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"u\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"c\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"d\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"z\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"p\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\": \", \"NAN\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: float(x))","50fb1e73":"print(f\"Transformed data shape: {data_tr_df.shape} (rows\/columns)\")\ndata_tr_df.head()","0d178364":"data_tr_df.tail()","3d1c5e61":"import pandas_profiling\npandas_profiling.ProfileReport(data_tr_df)","09e86cc6":"data_tr_df.to_csv(\"mobile_students_from_abroad_in_europe.csv\", index=False)","81c1aae5":"# Export data in csv format","7ce1589f":"# A very preliminary exploratory data analysis\n\nThis would be a very short exploratory data analysis. The role of this Kernel is just to show how we can prepare the annual data for analysis and we already did this.","838ea39e":"The first column is a composed one, containing 5 different information (unit, isced11 education indicator, isced13 education indicator, sex, geography). The next columns are temporal values, the years value.","c9e7de4c":"Next, we pivot the time columns using `melt` operation in pandas.  \nWe also make sure we transform `date` to be an integer (here is a year data).  \nWe set `value` to be a float, after we replace \": \" (for N\/A) with `NAN`.","079ed17e":"We select now only the new columns resulted from splitting the `pivot_data_col` and the time columns.","3653415b":"Let's also take a look to few of the rows.","49c3cd5a":"# Analysis preparation\n\n## Load packages","50b0750f":"Let's glimpse the data columns.","ab180249":"# Introduction\n\nWe show in this Kernel how we can process the data to prepare it for easier processing. Let's check the data files.","9e62f39c":"## Load the data\n\nThe datafiles are in TSV format. We will read the files using pandas, just include in the function call the `sep` (tab separator data).\nWe demonstrate first how to read and process the Annual data.","cf6e1182":"# Data pre-processing\n\nWe start by defining two working lists.","e676da34":"Let's inspect the result.","dccb856e":"Then, we split from `pivot_data_col` the 5 separate fields:\n* unit;\n* isced11 - ISCED-11 education attainment level classification;   \n* isced13 - ISCED-13 education attainment level classification;    \n* sex (F, M or T);\n* geo - geography - mainly countries but also aggregated countries in EU;"}}