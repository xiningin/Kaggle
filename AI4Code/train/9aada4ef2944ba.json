{"cell_type":{"0b75806d":"code","29f86b4e":"code","8e077817":"code","e0060d19":"code","011e8afb":"code","0cb75433":"code","bffab822":"code","a1860b60":"code","d8bc20f8":"code","f35b0cbf":"markdown","6e4dcfbe":"markdown","dfa9d4bc":"markdown","28b5a693":"markdown","560e719c":"markdown","bde3505e":"markdown","6685c9d3":"markdown","3fa9bccb":"markdown","7558cfc0":"markdown","0c6f2812":"markdown","ecd8c4d9":"markdown","f8357ee8":"markdown","ba3c039a":"markdown"},"source":{"0b75806d":"## all you have to do is load library\nimport tensorflow as tf\nfrom tensorflow import keras\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","29f86b4e":"train=pd.read_csv('..\/input\/digit-recognizer\/train.csv')\ntest=pd.read_csv('..\/input\/digit-recognizer\/test.csv')\nsubmit=pd.read_csv('..\/input\/digit-recognizer\/sample_submission.csv')\ntrain.head()","8e077817":"## we usually use x_train,x_test,y_train,y_test ...\n\ny_train=train['label']\nx_train=train.drop('label',axis=1)\n\n## np.array is method\n\nx_train=np.array(x_train,dtype=np.float32)\/255\ntest=np.array(test,dtype=np.float32)\/255\n\nx_train=x_train.reshape(-1,28,28,1)\ntest=test.reshape(-1,28,28,1)\n\n## first tensorflow method\n## we change label : [1,2,3,4, ... ] -> \n## [[0,0,0,0,1, ..],\n##  [0,1,0,0,0, ..]]\n## ...\ny_train=tf.keras.utils.to_categorical(y_train)","e0060d19":"input_layer=tf.keras.layers.Input((28,28,1))\n\n## why we need to use activation func?\n## because Using the activation function,\n## the output value for the input value does not come out linear.\n## so the linear classifier can be made into a nonlinear system.\n\n## convolution used to image classfication.\n\nconv_layer=tf.keras.layers.Conv2D(64,(3,3),activation=tf.nn.relu,input_shape=(28,28,1))(input_layer)\n\n## Dropout is a method for solving Overfitting, one of the problems in deep learning.\n\ndropout=tf.keras.layers.Dropout(0.25)(conv_layer)\nconv_layer=tf.keras.layers.Conv2D(64,(3,3),activation=tf.nn.relu)(dropout)\n\n## maxpool is sub-sampling\n## it indicates that 'pool' reduces data shape.\n\nmaxpool_layer=tf.keras.layers.MaxPool2D((2,2))(conv_layer)\ndropout=tf.keras.layers.Dropout(0.25)(maxpool_layer)\n\n## flatten : 2d array to 1d array\n\nflatten=tf.keras.layers.Flatten()(dropout)\ndense=tf.keras.layers.Dense(128,activation=tf.nn.relu)(flatten)\ndropout=tf.keras.layers.Dropout(0.25)(dense)\ndense=tf.keras.layers.Dense(64,activation=tf.nn.relu)(dropout)\ndropout=tf.keras.layers.Dropout(0.25)(dense)\n\n## The softmax function estimates the probability of belonging \n## to each class by receiving an n-dimensional vector if there are n classes to be classified.\n\noutput_layer=tf.keras.layers.Dense(10,activation=tf.nn.softmax)(dropout)\nmodel=tf.keras.models.Model(input_layer,output_layer)","011e8afb":"model.summary()","0cb75433":"from tensorflow.keras.preprocessing.image import ImageDataGenerator\n\n## It's well done in English.\n\ndatagen=ImageDataGenerator(\n    zoom_range=0.1, # zoom in\n    shear_range=15, # twist?\n    rotation_range=20, # rotation\n    width_shift_range=0.2, \n    horizontal_flip=False,\n    validation_split=0.25\n)\n\ndatagen.fit(x_train)\ngenerator_train=datagen.flow(x_train,y_train,subset='training',batch_size=256)\ngenerator_valid=datagen.flow(x_train,y_train,subset='validation',batch_size=64)","bffab822":"model.compile(optimizer='Adam',metrics=['accuracy'],loss='categorical_crossentropy')\nmodel.fit(generator_train,validation_data=generator_valid,epochs=2)","a1860b60":"pred=model.predict(test)\nsubmit['Label']=np.argmax(pred,axis=1)\nsubmit.head()","d8bc20f8":"submit.to_csv('cnn.csv',index=False)","f35b0cbf":"### load library","6e4dcfbe":"### image generator","dfa9d4bc":"<h1 style=\"padding:20px;background-color:black;color:white;text-align:center\"> hello everyone. let's code with me.<\/h1>","28b5a693":"![](https:\/\/ifh.cc\/g\/nRxPT5.png)","560e719c":"### summary","bde3505e":"### prediction & submit","6685c9d3":"## Please write it down first.\u2714","3fa9bccb":"### model compile & train","7558cfc0":"### data view\n\nthere is pixel 0~783 and label.\nwe need to change array.","0c6f2812":"### modeling ","ecd8c4d9":"### next ...","f8357ee8":"you need to learn about details.\n \nwhat is batch?  \nimagegenerator? why i use it? what for?  \nparameters? is it important?     \nlayer? is there another layer?   \nand Is cnn layer used only for images?  \nCan I use a different layer?  \n...\n\nYou have to keep asking why.","ba3c039a":"### preprocessing "}}