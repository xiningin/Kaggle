{"cell_type":{"d8b1ae30":"code","6995ba5e":"code","d41867d8":"code","b2e4ed9d":"code","a178a6da":"code","5af97511":"code","66dee5ec":"code","12fa0fad":"code","ee1f4e4d":"code","0cf142bf":"code","5c63608e":"code","5d9d4a57":"code","9df895b5":"code","23aacc76":"code","e15d4bce":"code","773ebd45":"code","1bbc1626":"code","b04ef7a7":"code","739f3e78":"code","fbe88597":"code","b93940e9":"code","c79a764f":"code","1504c617":"code","e56fd62e":"code","a03efa6a":"code","b4abbe64":"code","51914037":"code","26467779":"code","d9987f3a":"code","ec555095":"code","ae42464e":"code","2351800c":"code","daf4bfb8":"code","03ef2096":"code","56ad0ba2":"code","4c5f507f":"code","4fe901ec":"code","9af8329a":"code","a7239f9a":"code","a2e52a06":"code","8e38ec63":"code","1bccbdca":"code","ec915b02":"code","34c53788":"code","fb3c812b":"code","5791869a":"code","1887252d":"code","eded6d8d":"code","8136b3b8":"code","e51957c0":"code","d9d315f3":"code","dc9fa09b":"code","42371ac3":"code","b10c3261":"code","28c35f25":"code","217df129":"code","525e4d6c":"code","fc88aa6f":"code","ca51f3c7":"code","78fd8009":"code","ae5cf24f":"code","5f2d6a7f":"code","877e1d36":"code","26f4cfd4":"code","071806a5":"code","5a1051cf":"code","ace7982e":"code","d9b28818":"code","a5f14df2":"code","97ac2e04":"code","5e004f40":"code","1e69b72c":"code","006a3ecb":"code","a74f23f9":"code","4f948db4":"code","09242c63":"markdown","3575f1ca":"markdown","ceddb323":"markdown","2bf2ac67":"markdown","cff2dacb":"markdown","492803aa":"markdown","0681071d":"markdown","6b58561d":"markdown","e7720fec":"markdown","e9866d76":"markdown","7dac9d58":"markdown","15e4405e":"markdown","7d3f69f5":"markdown","2cf4a848":"markdown","60467225":"markdown","2dddbcc4":"markdown","d617716c":"markdown","339ac97c":"markdown","ebb8ae25":"markdown"},"source":{"d8b1ae30":"\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt \nimport seaborn as sns\nfrom statistics import median, mean, mode\n\n%matplotlib inline","6995ba5e":"train_data = pd.read_csv(\"\/kaggle\/input\/credit-default-prediction-ai-big-data\/train.csv\")\ntest_data = pd.read_csv(\"\/kaggle\/input\/credit-default-prediction-ai-big-data\/test.csv\")","d41867d8":"train_data","b2e4ed9d":"test_data","a178a6da":"train_data.info()\nprint('*' * 100, '\\n')\ntest_data.info()","5af97511":"print(train_data.nunique())\nprint('*' * 80, '\\n')\nprint(test_data.nunique())","66dee5ec":"print(\"Train Data Purpose columns unique values counts\", train_data['Purpose'].nunique())\nprint('*' * 80, '\\n')\nprint(\"Test Data Purpose columns unique values counts\", test_data['Purpose'].nunique())","12fa0fad":"train_data['Credit Default'].value_counts()","ee1f4e4d":"# Deleting spaces between names and interchanging with underscore\n\ntrain_data.columns = ['_'.join(col.split(' ')).lower() for col in train_data.columns]\ntest_data.columns = ['_'.join(col.split(' ')).lower() for col in test_data.columns]","0cf142bf":"print(train_data.columns)\nprint('*' * 80, '\\n')\nprint(test_data.columns)","5c63608e":"train_data.credit_default.value_counts()","5d9d4a57":"1e2 * train_data['credit_default'].value_counts()\/len(train_data)","9df895b5":"## using round function\n\nround(1e2 * train_data['credit_default'].value_counts()\/len(train_data), 2)","23aacc76":"train_null = train_data.isnull().sum()\ntrain_null","e15d4bce":"test_null = test_data.isnull().sum()\ntest_null","773ebd45":"#Display percentage of null values in each column\n\nmiss = train_data.isnull().sum() \/ len(train_data) * 100\nmiss = miss[miss > 0]\nmiss.sort_values(inplace=True)\nmiss","1bbc1626":"fig=plt.figure(figsize=(20,8))\ntrain_null.plot(kind='bar')\nplt.title('Percentage of Train Data Null values in the Columns')\nplt.grid()","b04ef7a7":"sns.heatmap(train_data.isnull())","739f3e78":"#Display percentage of null values in each column\n\nmiss = test_data.isnull().sum() \/ len(test_data) * 100\nmiss = miss[miss > 0]\nmiss.sort_values(inplace=True)\nmiss","fbe88597":"fig=plt.figure(figsize=(20,8))\ntest_null.plot(kind='bar')\nplt.title('Percentage of Test Data Null values in the Columns')\nplt.grid()","b93940e9":"sns.heatmap(test_data.isnull())","c79a764f":"summary = train_data.describe()\nsummary = summary.T\nsummary","1504c617":"summary = test_data.describe()\nsummary = summary.T\nsummary","e56fd62e":"print(train_data.years_in_current_job.value_counts(dropna = False))","a03efa6a":"years_in_current_job_map = {'10+ years': 10,'9 years': 9,'8 years': 8,'7 years':7,'6 years':6,\n                            '5 years': 5, '4 years': 4, '3 years':3, '2 years': 2,'1 year': 1, '< 1 year':0 }\ntrain_data['years_in_current_job'] = train_data['years_in_current_job'].map(years_in_current_job_map)","b4abbe64":"print(train_data.years_in_current_job.value_counts(dropna = False))","51914037":"print(test_data.years_in_current_job.value_counts(dropna = False))","26467779":"years_in_current_job_map = {'10+ years': 10,'9 years': 9,'8 years': 8,'7 years':7,'6 years':6,\n                            '5 years': 5, '4 years': 4, '3 years':3, '2 years': 2,'1 year': 1, '< 1 year':0 }\ntest_data['years_in_current_job'] = test_data['years_in_current_job'].map(years_in_current_job_map)","d9987f3a":"print(test_data.years_in_current_job.value_counts(dropna = False))","ec555095":"print(train_data['bankruptcies'].value_counts(dropna = False))\nprint('*' * 80)\nprint(train_data['months_since_last_delinquent'].value_counts(dropna = False))\nprint('*' * 80)\nprint(train_data['credit_score'].value_counts(dropna = False))\nprint('*' * 80)\nprint(train_data['annual_income'].value_counts(dropna = False))","ae42464e":"print(train_data.isnull().sum())","2351800c":"\ntrain_data.bankruptcies                  =  train_data.bankruptcies.agg(lambda x : x.fillna(x.median()))\ntrain_data.years_in_current_job          =  train_data.years_in_current_job.agg(lambda x : x.fillna( x.median()))\ntrain_data.months_since_last_delinquent  =  train_data.months_since_last_delinquent.agg(lambda x : x.fillna( x.median()))\ntrain_data.credit_score                  =  train_data.credit_score.agg(lambda x : x.fillna(x.median()))\ntrain_data['annual_income']              = train_data['annual_income'].agg(lambda x : x.fillna(x.mean()))","daf4bfb8":"train_data.isnull().sum()","03ef2096":"print(test_data['years_in_current_job'].value_counts(dropna = False))\nprint('*' * 80)\nprint(test_data['bankruptcies'].value_counts(dropna = False))\nprint('*' * 80)\nprint(test_data['months_since_last_delinquent'].value_counts(dropna = False))\nprint('*' * 80)\nprint(test_data['credit_score'].value_counts(dropna = False))\nprint('*' * 80)\nprint(test_data['annual_income'].value_counts(dropna = False))","56ad0ba2":"test_data.isnull().sum()","4c5f507f":"\ntest_data.bankruptcies                  =  test_data.bankruptcies.agg(lambda x : x.fillna(x.median()))\ntest_data.years_in_current_job          =  test_data.years_in_current_job.agg(lambda x : x.fillna(x.median()))\ntest_data.months_since_last_delinquent  =  test_data.months_since_last_delinquent.agg(lambda x : x.fillna(x.median()))\ntest_data.credit_score                  =  test_data.credit_score.agg(lambda x : x.fillna(x.median()))\ntest_data['annual_income']              =  test_data['annual_income'].agg(lambda x : x.fillna(x.mean()))","4fe901ec":"test_data.isnull().sum()","9af8329a":" train_data","a7239f9a":"print(\"Train Data :-\")\n\nprint(\"Home Ownership unique values :\", train_data['home_ownership'].nunique())\n\nprint(\"Purpose unique values        :\", train_data['purpose'].nunique())\n\nprint(\"Term unique values           :\", train_data['term'].nunique())","a2e52a06":"print(\"Test Data:-\")\n\nprint(\"Home Ownership unique values :\", test_data['home_ownership'].nunique())\n\nprint(\"Purpose unique values        :\", test_data['purpose'].nunique())\n\nprint(\"Term unique values           :\", test_data['term'].nunique())","8e38ec63":"train_data = train_data[train_data.purpose != 'renewable energy']","1bccbdca":"train_data.purpose.value_counts()","ec915b02":"train_data.credit_default.value_counts()","34c53788":"sns.countplot(train_data.credit_default)\nplt.grid()","fb3c812b":"train_data.columns","5791869a":"train_data = pd.get_dummies(train_data, drop_first = True)\ntrain_data","1887252d":"train_data.columns","eded6d8d":"test_data","8136b3b8":"test_data.columns","e51957c0":"test_data = pd.get_dummies(test_data, drop_first =True)\ntest_data","d9d315f3":"X_train = train_data.drop(['credit_default','id'], axis = 1)\ny_train =train_data.credit_default\nX_test = test_data.drop('id', axis = 1)","dc9fa09b":"X_train.shape","42371ac3":"X_test.shape","b10c3261":"y_train.shape","28c35f25":"X_train","217df129":"X_test","525e4d6c":"y_train","fc88aa6f":"\nfrom sklearn.preprocessing import StandardScaler\nsc_X = StandardScaler()\nX_train = sc_X.fit_transform(X_train)\nX_test = sc_X.transform(X_test)\n","ca51f3c7":"X_train","78fd8009":"X_test","ae5cf24f":"from sklearn.linear_model import LogisticRegression","5f2d6a7f":"linear_model = LogisticRegression()\nlinear_model.fit(X_train, y_train)","877e1d36":"linear_model.score(X_train, y_train)","26f4cfd4":"linear_pred = linear_model.predict(X_test)","071806a5":"linear_pred","5a1051cf":"from sklearn.tree import DecisionTreeClassifier","ace7982e":"DT_Classification = DecisionTreeClassifier()\nDT_Classification.fit(X_train, y_train)","d9b28818":"DT_pred = DT_Classification.predict(X_test)","a5f14df2":"DT_Classification.score(X_train, y_train)","97ac2e04":"DT_pred","5e004f40":"from sklearn.ensemble import RandomForestClassifier","1e69b72c":"RF_Classification = RandomForestClassifier()\nRF_Classification.fit(X_train, y_train)","006a3ecb":"RF_pred = RF_Classification.predict(X_test)","a74f23f9":"RF_Classification.score(X_train, y_train)","4f948db4":"RF_pred","09242c63":"### Logistic Regression Modeling Buliding","3575f1ca":"### EDA","ceddb323":"## Spliting Train Data, Test Data","2bf2ac67":"## importing Libraries","cff2dacb":"we observe in train data purpose column have 15 unique values, it's means 15 types of purpose to take a loan.\nAnd same to the observe the test data purpose column have 14 unique values, it means 14 types of purpose to take a loan.\n","492803aa":"### Submitted Data","0681071d":"## Data Cleaning ","6b58561d":"Train data and test data 4 columns 1) years_in_current_job,2) annual_income,3) credit_score 4)months_since_last_delinquent.\n \nNow its Handling Missing value.","e7720fec":"## Handling Null Values","e9866d76":"Apply Get Dummies non ordinal varibles like Home_Ownership, Purpose, Term varible.","7dac9d58":"Test Data Non ordinal varibles apply to Get dummies ","15e4405e":"Since Renewable energy category is missing in test data so after converting it in dummy variable it will create a mismatch in modelling. Since number of columns in dummy variable will be one less . Hence dropping it now.","7d3f69f5":"### Train data shape 7500 rows and 18 colounms \n### Test data shape 2500 rows and 17 colounms","2cf4a848":"# Loan Default Prediction","60467225":"### Random Forest Classification Model Buliding","2dddbcc4":"Train data and Test data description:-\n\nHome Ownership - home ownership type\nAnnual Income - annual income\nYears in current job - the number of years in the current job\nTax Liens - tax encumbrances\nNumber of Open Accounts - the number of open accounts\nYears of Credit History - number of years of credit history\nMaximum Open Credit - the largest open loan\nNumber of Credit Problems - the number of credit problems\nMonths since last delinquent - the number of months since the last delay in payment\nBankruptcies - bankruptcy\nPurpose - the purpose of the loan\nTerm - loan term (short term, long term)\nCurrent Loan Amount - the current loan amount\nCurrent Credit Balance - current credit balance\nMonthly Debt - monthly debt\nCredit Default - the fact of default on credit obligations (0 - repaid on time, 1 - delay)","d617716c":"### Decision Tree Classification Model Buliding","339ac97c":"## Train data contain some null values, object data type clounms and integer, folat data type colounms.\n## Test data contain null values, object data type, integer, float data type colounms.","ebb8ae25":"## Feature Scaling"}}