{"cell_type":{"1dffaf90":"code","70e8a712":"code","e1054316":"code","a2f467a5":"code","2dad3585":"code","4c3cec8b":"code","e55d5f1b":"code","42076916":"code","a63227e7":"code","19c9b593":"code","fe92088a":"code","c8ae0fee":"code","887816b3":"code","d96b2f9d":"code","823fdb02":"code","7e4aa2b7":"code","90788739":"code","5f424fa8":"code","9adec30c":"code","8b066c2b":"code","76c96dbe":"code","e437c990":"code","7f7cb17f":"code","f1a894f7":"code","544bd6e2":"code","926ea562":"code","c553399a":"markdown","effaccb3":"markdown","1d4a4e9f":"markdown","1984da81":"markdown","c24836bc":"markdown","59c94bb1":"markdown","52eddc01":"markdown","e0458406":"markdown","2055d39c":"markdown","0716ba8d":"markdown","0d6b6209":"markdown","60a66fa7":"markdown","0d844eba":"markdown","67e957c4":"markdown","0ff13572":"markdown","aecc9d65":"markdown","c32eadd3":"markdown","d28e5fd9":"markdown","3da87ccf":"markdown","586b4e88":"markdown","aae1f8fd":"markdown","c501bdb4":"markdown"},"source":{"1dffaf90":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","70e8a712":"# Importing the libraries\n\nimport os \nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')\nfrom sklearn.cluster import KMeans\nfrom sklearn.metrics import silhouette_score","e1054316":"## Data \n\ndf=pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")\ndf.head()","a2f467a5":"# Exploratory data analysis\n\ndf.info()","2dad3585":"df.describe()","4c3cec8b":"# Top 5 customers with highest spending scores\n\ndf.nlargest(5,'Spending Score (1-100)')","e55d5f1b":"# Top 5 customers with lowest spending score\n\ndf.nsmallest(5,'Spending Score (1-100)')","42076916":"# gender count plot\nsns.countplot(x=df['Gender'],data=df)","a63227e7":"# spending score countplot\nsns.countplot(x=df['Spending Score (1-100)'],data=df)","19c9b593":"# box plot\n\nsns.boxplot(y=df['Age'])","fe92088a":"sns.boxplot(y=df['Annual Income (k$)'])","c8ae0fee":"# scatter plot\nsns.set_style('darkgrid')\nx=df['Spending Score (1-100)']\ny=df['Annual Income (k$)']\nsns.scatterplot(x,y,hue=df['Age'])","887816b3":"Age_18_20=df[(df['Age']>=18) &(df['Age']<=20)]\nAge_20_25=df[(df['Age']>20) & (df['Age']<=25)]\nAge_25_30=df[(df['Age']>25) & (df['Age']<=30)]\nAge_30_35=df[(df['Age']>30) & (df['Age']<=35)]\nAge_35_40=df[(df['Age']>35) & (df['Age']<=40)]\nAge_40_45=df[(df['Age']>40) & (df['Age']<=45)]\nAge_45_50=df[(df['Age']>45) & (df['Age']<=50)]\nAge_50_55=df[(df['Age']>50) & (df['Age']<=55)]\nAge_55_60=df[(df['Age']>55) & (df['Age']<=60)]\nAge_60_65=df[(df['Age']>60) & (df['Age']<=65)]\nAge_65above=df[df['Age']>65]\n\nxaxis=['18_20','20_25','25_30','30_35','35_40','40_45','45-50','50-55','55-60','60-65','65above']\nyaxis=[len(Age_18_20),len(Age_20_25),len(Age_25_30),len(Age_30_35),len(Age_35_40),len(Age_40_45),len(Age_45_50),len(Age_50_55),len(Age_55_60),len(Age_60_65),len(Age_65above)]\n\nplt.figure(figsize=(12,10))\nsns.barplot(x=xaxis,y=yaxis)","d96b2f9d":"# normalization scale down data between(0 to 1)\nfrom sklearn.preprocessing import normalize\n\nx=df.iloc[:,[3,4]]\nNew_df=normalize(x)\n","823fdb02":"# new dataframe\nNew_df[1:10]","7e4aa2b7":"# within cluster sum of square \nWcss=[]","90788739":"for i in range(1,11):\n    km=KMeans(n_clusters=i,init='k-means++',max_iter=300,n_init=10,random_state=0)\n    km.fit(New_df)\n    Wcss.append(km.inertia_)","5f424fa8":"Wcss","9adec30c":"km.cluster_centers_","8b066c2b":"cluster=km.labels_\ncluster","76c96dbe":"sns.set_style('darkgrid')\nplt.plot(range(1,11),Wcss)\nplt.title('Elbow curve')\nplt.xlabel('Number of cluster')\nplt.ylabel('Within cluster sum of square')\n\n\n","e437c990":"from sklearn.metrics import silhouette_score\nsc= []\nfor k in range(2,8):\n    km = KMeans(n_clusters=k,init = 'k-means++',max_iter=300,n_init=10,random_state=0).fit(New_df)\n    sc.append([k, silhouette_score(New_df, km.labels_)])","7f7cb17f":"sc","f1a894f7":"sns.set_style('darkgrid')\nplt.plot(pd.DataFrame(sc)[0],pd.DataFrame(sc)[1])\nplt.xlabel('Number of clusters')\nplt.ylabel('Silhouette score')\n","544bd6e2":"# predicting the cluster \n\nkm=KMeans(n_clusters=3,init='k-means++',max_iter=300,n_init=10,random_state=0)\nCluster=km.fit_predict(New_df)","926ea562":"#Plotting scatter plot of clusters along with their highlighted clusters.\nsns.set_style('darkgrid')\nplt.figure(figsize=(10,6))\nplt.scatter(New_df[Cluster==0,0],New_df[Cluster==0,1],s=50,c='red',label='Cluster 1',marker='+') #X[y_means==0,0] for x-coordinates for cluter1,X[y_means==0,1] for y-coordinates ,s for size of datapoint\nplt.scatter(New_df[Cluster==1,0],New_df[Cluster==1,1],s=50,c='blue',label='Cluster 2',marker='o')\nplt.scatter(New_df[Cluster==2,0],New_df[Cluster==2,1],s=50,c='green',label='Cluster 3',marker='*')\nplt.scatter(km.cluster_centers_[:,0],km.cluster_centers_[:,1],s=250,c='yellow',label='Centroids') #Centroids are highlighted with bigger size\n\nplt.title('Clusters of Clients')\nplt.xlabel('Annual Income (k$)')\nplt.ylabel('Spending Score (1-100)')\nplt.legend();","c553399a":"As shown in graph , elbow is formed at number 5 on x-axis.This is the optimal number of cluster for this data.","effaccb3":"* Summary statistics tell us that mean and median are approx same of variable Age and Annual income.\n* Though spending score is integer but it is not a continuos variable .mean spending score is 26 and median is 50 . \n\n","1d4a4e9f":"# silhouette score\n\n* Silhouette Coefficient or silhouette score is a metric used to calculate the goodness of a clustering technique. Its value ranges from -1 to 1.\n* silhouette score tells how far away the data points in one cluster from the datapoints in another cluster.\n* Silhouette Score = (b-a)\/max(a,b)\n* where, a= average intra-cluster distance i.e the average distance between each point within a cluster.\n         b= average inter-cluster distance i.e the average distance between all clusters.\n\n","1984da81":"## Visualization ","c24836bc":"## Steps\n\n* About data\n* problem statement\n* Reading data\n* Exploratory data analysis\n* Visualization\n* Feature scaling\n* Creating clusters\n* silhouette score \n* Visualizing the clusters\n* Conclusion","59c94bb1":"# Conclusion\n\nAfter analysis we can conclude that the client who has higher income and having high spending score , these are target customer for mall marketing compaigns and it would  be very important to understand what kind of product are bought by these clients ,there purchase history to increase the sales.\n\n\n\n\n","52eddc01":"## Feature scaling\n\nThe goal of feature scaling is to scale down the feature between some interval so that machine learning model can easily performed mathematical operation . If we don't do feature scaling then the machine learning model gives higher weightage to higher values and lower weightage to lower values and model may be overfitted.","e0458406":"Most of the customers are between the age group 30 and 35 and the lowest customers are between age 60 and 65","2055d39c":"## Creatig clusters","0716ba8d":"* No outliers in the dataset.","0d6b6209":"**Creating K-means clustering**\n\n* The clustering means grouping the similar things together.\n\n* K- means clustering is a unsupervised machine learning algorithm which group the data into k number of clusters .\n\n**Steps of K-means:**\n*  Initialize the cluster\n*  Assign datapoints to cluster\n*  update cluster centroid\n*  Repeat 2-3 steps until stopping condition is met.\n\n","60a66fa7":"## Visualizing the clusters","0d844eba":"# Important tips !\n\n* It's important to preprocess your data\n* Applying feature reduction , feature scaling technique would speed up the process and improve results.\n* Number of clusters may effect after applying feature scaling.\n* K-means is sensitive to outliers.\n\n","67e957c4":"**Interpretation**\n\nCluster1 :In this cluster client earn highest income but don't spend too much money \n\nCluster2 :In this cluster client earn high income and have high spending score .\n\nCluster3 :In this cluster client doesn't earn too much but have highest spending score.\n","0ff13572":"**Problem statement**\n\nMall and want to know their Target Customers so that the sense can be given to marketing team and plan the strategy accordingly.\n","aecc9d65":"info() function provide the information about data .Data has 5 columns and 200rows and out of 5 columns 4 are int and 1 is object .No feature has null values or missing values.","c32eadd3":"* These are the customers who has highest spending scores , near to 100 .","d28e5fd9":"**About data**\n\nBig mall in specific city that contains information of it's clients.The clients that subscribe to membership card.When the client subscribe to the card they provide information such as their Gender,Age,and Annual income,therefore the mall has the purchase history each of it's client member and besed on there purchase history last column i.e Spending Score is obtained.The spending score is indicates how much a customer spend based on parameter like customer behaviour and purchasing history and the spending score is between (1-100).The closer the score to 1, less spend made by client and vise versa.","3da87ccf":" I have set initialization to \"k-means++\".This is to avoid random initialization trap.","586b4e88":"silhouette score for cluster 3 is closer to 1 which means this cluster is best for this data.","aae1f8fd":"**Don't know outliers ? here is the answer**\n* An outliers is the data point that differ significantly from other observation .\n* Reason being may be due to variability in the data or it may be due to experimental error.\n","c501bdb4":"Spending score of age between 20 to 30 is more than any age group ."}}