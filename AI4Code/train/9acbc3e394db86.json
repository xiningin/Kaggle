{"cell_type":{"eb01b6d0":"code","6b5bff06":"code","b7ca5658":"code","f248c8c1":"code","9878adb4":"code","b3bd0f02":"code","c255b5f9":"code","b8927822":"code","8bec3a57":"code","bf1755a9":"code","7a74be3e":"code","7e392e3f":"code","1e6202c6":"code","e86355d5":"code","df540fdf":"code","b84d043a":"code","1c7f0e08":"code","649f7df3":"code","13edfec9":"code","3ec2c075":"code","aa36c9b1":"code","82074188":"code","f2da24d2":"code","65800e10":"code","33afd51d":"code","480e7b5e":"code","967ee190":"code","85537d1e":"markdown","0fb821c2":"markdown","85a01d70":"markdown"},"source":{"eb01b6d0":"#import libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom matplotlib.colors import ListedColormap\nimport seaborn as sns\n\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.metrics import accuracy_score, confusion_matrix\nfrom sklearn.neighbors import KNeighborsClassifier, NeighborhoodComponentsAnalysis, LocalOutlierFactor\nfrom sklearn.decomposition import PCA\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","6b5bff06":"#load data\ndata = pd.read_csv('..\/input\/breast-cancer-wisconsin-data\/data.csv')\ndata.head(7)","b7ca5658":"#drop the column with all missing values and unnecessary values\ndata.drop([\"Unnamed: 32\",\"id\"],inplace=True,axis=1)","f248c8c1":"data=data.rename(columns= {\"diagnosis\":\"target\"})","9878adb4":"sns.countplot(data[\"target\"])\nplt.show()\nprint(data.target.value_counts())","b3bd0f02":"data[\"target\"]=[1 if i.strip()== \"M\" else 0 for i in data.target]\n","c255b5f9":"print(len(data))","b8927822":"data.head()","8bec3a57":"#Count the number of rows and columns in the daha set\nprint(\"Data Shape:\",data.shape)","bf1755a9":"data.info()","7a74be3e":"#count the number of empty values(NaN, NAN, na) in each column\ndata.isna().sum()","7e392e3f":"data.describe()","1e6202c6":"#correlation\ncorr_matrix=data.corr()\nsns.clustermap(corr_matrix,annot=True,fmt=\".2f\")\nplt.title(\"Correlation Between Features\")\nplt.show()","e86355d5":"threshold = 0.75\nfiltre = np.abs(corr_matrix[\"target\"]) > threshold\ncorr_features =corr_matrix.columns[filtre].tolist()\nsns.clustermap(data[corr_features].corr(),annot=True,fmt=\".2f\")\nplt.title(\"Correlation Between Features w Corr Threshold 0.75\")\nplt.show()\n","df540fdf":"sns.pairplot(data[corr_features],diag_kind=\"kde\",markers =\"+\",hue=\"target\")\nplt.show()","b84d043a":"#outlier\ny= data.target\nx= data.drop([\"target\"],axis=1)\ncolumns =x.columns.tolist()\n\nclf=LocalOutlierFactor()\ny_pred=clf.fit_predict(x)\nX_score =clf.negative_outlier_factor_\n\noutlier_score=pd.DataFrame()\noutlier_score[\"score\"] = X_score\n\n#threshold\nthreshold =-2.5\nfiltre = outlier_score[\"score\"] < threshold\noutlier_index=outlier_score[filtre].index.tolist()\n\nplt.figure(figsize=(21,5))\nplt.scatter(x.iloc[outlier_index,0],x.iloc[outlier_index,1],color=\"blue\",s=50,label=\"Outliers\")\nplt.scatter(x.iloc[:,0],x.iloc[:,1],color=\"k\",s=3,label=\"Data Points\")\n\nradius = (X_score.max() - X_score)\/(X_score.max()-X_score-X_score.min())\noutlier_score[\"radius\"] = radius\nplt.scatter(x.iloc[:,0],x.iloc[:,1],s=1000*radius,edgecolors=\"r\",facecolors=\"none\",label=\"Outlier Scores\")\nplt.legend()\nplt.show()","1c7f0e08":"#drop outliers\nx=x.drop(outlier_index)\ny=y.drop(outlier_index).values","649f7df3":"#train test split\ntest_size=0.3\nX_train,X_test,Y_train,Y_test=train_test_split(x,y,test_size=test_size,random_state=42)\n","13edfec9":"scaler=StandardScaler()\nX_train=scaler.fit_transform(X_train)\nX_test=scaler.transform(X_test)\n\nX_train_df=pd.DataFrame(X_train,columns = columns)\nX_train_df_describe =X_train_df.describe()\nX_train_df[\"target\"] =Y_train\n\ndata_melted=pd.melt(X_train_df,id_vars=\"target\",\n                   var_name=\"features\",\n                   value_name=\"value\")\n\nplt.figure(figsize=(21,5))\nsns.boxplot(x=\"features\",y=\"value\",hue=\"target\",data=data_melted)\nplt.xticks(rotation=90)\nplt.show()","3ec2c075":"sns.pairplot(X_train_df[corr_features],diag_kind=\"kde\",markers=\"+\",hue=\"target\")\nplt.show()","aa36c9b1":"#basic knn method\nknn=KNeighborsClassifier(n_neighbors=2)\nknn.fit(X_train,Y_train)\ny_pred=knn.predict(X_test)\ncm=confusion_matrix(Y_test,y_pred)\nacc=accuracy_score(Y_test,y_pred)\nscore=knn.score(X_test,Y_test)\nprint(\"Score:\",score)\nprint(\"CM:\",cm)","82074188":"#choose best parameters\ndef KNN_Best_Params(x_train,x_test,y_train,y_test):\n    k_range=list(range(1,31))\n    weight_options=[\"uniform\",\"distance\"]\n    print()\n    param_grid=dict(n_neighbors =k_range,weights=weight_options)\n    \n    knn=KNeighborsClassifier()\n    grid=GridSearchCV(knn,param_grid,cv=10,scoring=\"accuracy\")\n    grid.fit(x_train,y_train)\n    \n    print(\"Best Training Score: {} with parameters: {}\".format(grid.best_score_,grid.best_params_))\n    print()\n    \n    knn=KNeighborsClassifier(**grid.best_params_)\n    knn.fit(x_train,y_train)\n    \n    y_pred_test=knn.predict(x_test)\n    y_pred_train=knn.predict(x_train)\n    \n    cm_test=confusion_matrix(y_test,y_pred_test)\n    cm_train=confusion_matrix(y_train,y_pred_train)\n    \n    acc_test=accuracy_score(y_test,y_pred_test)\n    acc_train=accuracy_score(y_train,y_pred_train)\n    print(\"Test Score: {}, Train Score: {}\".format(acc_test,acc_train))\n    print()\n    print(\"CM Test: \",cm_test)\n    print(\"CM Train: \",cm_train)\n    \n    \n    return grid\n\n\ngrid = KNN_Best_Params(X_train,X_test,Y_train,Y_test)","f2da24d2":"#pca\nscaler = StandardScaler()\nx_scaled =scaler.fit_transform(x)\n\npca=PCA(n_components=2)\npca.fit(x_scaled)\nX_reduced_pca=pca.transform(x_scaled)\npca_data =pd.DataFrame(X_reduced_pca,columns =[\"p1\",\"p2\"])\npca_data[\"target\"] = y\nsns.scatterplot(x=\"p1\",y=\"p2\",hue=\"target\",data=pca_data)\nplt.title(\"PCA: p1 vs p2\")\nplt.show()","65800e10":"X_train_pca,X_test_pca,Y_train_pca,Y_test_pca=train_test_split(X_reduced_pca,y,test_size=test_size,random_state=42)\ngrid_pca= KNN_Best_Params(X_train_pca,X_test_pca,Y_train_pca,Y_test_pca)","33afd51d":"cmap_light =ListedColormap([\"orange\",\"cornflowerblue\"])\ncmap_bold=ListedColormap([\"darkorange\",\"darkblue\"])\n\nh=.05\nX=X_reduced_pca\nx_min,x_max=X[:,0].min()-1,X[:,0].max() + 1\ny_min,y_max =X[:,1].min() - 1,X[:,1].max() + 1\nxx,yy =np.meshgrid(np.arange(x_min,x_max,h),\n                  np.arange(y_min,y_max,h))\nZ=grid_pca.predict(np.c_[xx.ravel(),yy.ravel()])\n\nZ=Z.reshape(xx.shape)\nplt.figure()\nplt.pcolormesh(xx,yy,Z,cmap=cmap_light)\n\nplt.scatter(X[:,0],X[:,1],c=y,cmap=cmap_bold,\n           edgecolor=\"k\",s=20)\nplt.xlim(xx.min(),xx.max())\nplt.ylim(yy.min(),yy.max())\nplt.title(\"%i - Class Classification (k = %i, weights ='%s')\"\n        %(len(np.unique(y)),grid_pca.best_estimator_.n_neighbors,grid_pca.best_estimator_.weights))\nplt.legend()\nplt.show()","480e7b5e":"nca=NeighborhoodComponentsAnalysis(n_components=2,random_state=42)\nnca.fit(x_scaled,y)\nX_reduced_nca=nca.transform(x_scaled)\n\nnca_data=pd.DataFrame(X_reduced_nca,columns=[\"p1\",\"p2\"])\nnca_data[\"target\"]=y\nsns.scatterplot(x=\"p1\",y=\"p2\",hue=\"target\",data=nca_data)\nplt.title(\"NCA: p1 vs p2\")\nplt.show()","967ee190":"X_train_nca,X_test_nca,Y_train_nca,Y_test_nca=train_test_split(X_reduced_nca,y,test_size=test_size,random_state=42)\ngrid_nca= KNN_Best_Params(X_train_nca,X_test_nca,Y_train_nca,Y_test_nca)\n\ncmap_light =ListedColormap([\"orange\",\"cornflowerblue\"])\ncmap_bold=ListedColormap([\"darkorange\",\"darkblue\"])\n\nh=.2\nX=X_reduced_nca\nx_min,x_max=X[:,0].min()-1,X[:,0].max() + 1\ny_min,y_max =X[:,1].min() - 1,X[:,1].max() + 1\nxx,yy =np.meshgrid(np.arange(x_min,x_max,h),\n                  np.arange(y_min,y_max,h))\nZ=grid_nca.predict(np.c_[xx.ravel(),yy.ravel()])\n\nZ=Z.reshape(xx.shape)\nplt.figure()\nplt.pcolormesh(xx,yy,Z,cmap=cmap_light)\n\nplt.scatter(X[:,0],X[:,1],c=y,cmap=cmap_bold,\n           edgecolor=\"k\",s=20)\nplt.xlim(xx.min(),xx.max())\nplt.ylim(yy.min(),yy.max())\nplt.title(\"%i - Class Classification (k = %i, weights ='%s')\"\n        %(len(np.unique(y)),grid_nca.best_estimator_.n_neighbors,grid_nca.best_estimator_.weights))\nplt.legend()\nplt.show()","85537d1e":"EDA","0fb821c2":"**Missing value: none**","85a01d70":"#bad=1,good=0"}}