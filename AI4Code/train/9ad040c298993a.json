{"cell_type":{"81c637ea":"code","ceb53e82":"code","1040112c":"code","5099530c":"code","96d60093":"code","65063843":"code","e98d04b9":"code","1493db32":"code","a0e500d1":"code","a53df577":"code","2020315c":"code","2c760f88":"code","d695e40f":"code","daaee359":"code","242c5af5":"code","14c79a8f":"code","55989e45":"code","223537a0":"code","7b21570b":"code","95529cbc":"code","c3393fd9":"code","0a0a9f0a":"code","444af174":"code","e2a37d28":"code","0718334f":"code","b6580d90":"code","5d742b45":"code","ba21dfbf":"code","8df85c43":"code","5d3b0e39":"code","6a76790a":"code","d7ae09ae":"code","be09aeec":"code","cf574233":"code","02cd3e17":"code","80386ca8":"code","fabdc9e4":"code","43bc17b7":"code","38b254ce":"code","b88a6e99":"code","a8e541ae":"code","e7cc1fd0":"code","be8377f2":"code","c7da99d8":"code","52443da4":"code","ed92c19e":"code","dffa6b94":"code","a39750ef":"code","32176921":"code","eb0bb8bb":"code","c6892f07":"code","1ff07591":"code","65adcda3":"code","0fefdf6c":"code","8aa4c335":"code","5eb14186":"code","4daa5848":"code","b033cdc8":"code","8fa2210b":"code","59fa37f1":"code","e6808ba4":"code","7c63da52":"code","b4d779a9":"code","c667a16c":"code","25bd67b4":"code","f884cc56":"code","a55447df":"code","6ef30bde":"code","c2bb614e":"code","0df9711d":"code","76c34526":"code","a1b3b6a7":"code","0457b442":"code","29fb1d35":"code","853db295":"code","18f5361a":"code","f18263f0":"code","efa35158":"code","cdec357a":"code","3d744db1":"code","5511fb4e":"code","7d3f19c1":"code","29d9ea06":"code","37b6a04d":"code","46069bfb":"code","4de22e9c":"code","5bfede99":"code","383af14a":"code","3784861c":"code","918142da":"code","c652aced":"code","9528dba1":"code","ad05a48d":"code","ae4df09d":"code","63d12284":"code","15dfb0be":"code","8839e0dc":"code","a61ee470":"code","1a4b7c69":"code","908a3eca":"code","b0e77f4a":"code","85c82189":"code","41132a5c":"markdown","d9a824cb":"markdown","5735cbe9":"markdown","e50f1295":"markdown","3a035a2c":"markdown","2d86629b":"markdown","cdc616c4":"markdown","16970ea1":"markdown","cf26596e":"markdown","8141a116":"markdown","218fa52e":"markdown","ddc87cbc":"markdown","3b1a8c49":"markdown","c348c372":"markdown","1d9df34e":"markdown","64fc4c1c":"markdown","1809f4ff":"markdown","47755094":"markdown","49278d3c":"markdown","4f022d7a":"markdown","95328951":"markdown","e68f756c":"markdown","1d939cd4":"markdown","7105d31e":"markdown","0c8ceb1d":"markdown","383c7c16":"markdown","15e36b53":"markdown","f9a26554":"markdown","4bfda96b":"markdown","197bab02":"markdown","3728666e":"markdown","5ce14f56":"markdown","67184829":"markdown","07117414":"markdown","1d7f627f":"markdown","b46a8376":"markdown","de1bc422":"markdown","8f06b609":"markdown","715677e2":"markdown","7a617d45":"markdown","75d7da6d":"markdown","78713131":"markdown","921c8d37":"markdown","ad87aa93":"markdown","81254045":"markdown","7ae8dbf8":"markdown","4fd71ed4":"markdown","2f789979":"markdown","dd27fd52":"markdown","51ed2bf0":"markdown","76600bc0":"markdown","af0506e7":"markdown"},"source":{"81c637ea":"import os\nimport numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom scipy.stats import chi2_contingency,ttest_ind\nfrom statsmodels.stats.proportion import proportions_ztest\n\nfrom sklearn.preprocessing import StandardScaler\n\nfrom sklearn.model_selection import train_test_split,GridSearchCV,RandomizedSearchCV,cross_val_score\nfrom imblearn.over_sampling import SMOTE\n\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import GaussianNB\n\nfrom sklearn.metrics import accuracy_score,confusion_matrix,f1_score,precision_score,recall_score,roc_auc_score\nfrom sklearn.metrics import classification_report,plot_roc_curve\n\nfrom sklearn.ensemble import AdaBoostClassifier","ceb53e82":"print(os.listdir('..\/input'))","1040112c":"df = pd.read_csv('\/kaggle\/input\/online-shoppers-intention\/online_shoppers_intention.csv')\ndf.head()","5099530c":"print('Rows:{}'.format(df.shape[0]))\nprint('Columns:{}'.format(df.shape[1]))","96d60093":"df.info()","65063843":"df.isna().sum()","e98d04b9":"df.dropna(inplace=True)","1493db32":"num = ['Administrative', 'Administrative_Duration', 'Informational',\n       'Informational_Duration', 'ProductRelated', 'ProductRelated_Duration',\n       'BounceRates', 'ExitRates', 'PageValues', 'SpecialDay']","a0e500d1":"df[num].describe()","a53df577":"# Distribution of customers on Revenue\nplt.figure(figsize=(15,5))\n\nplt.subplot(1,2,1)\ndf['Revenue'].value_counts().plot(kind='bar',color='blue',alpha=0.8)\n#plt.title('Revenue Analysis')\nplt.xlabel('True\/False')\nplt.ylabel('Number of counts');\n\nplt.subplot(1,2,2)\nsize = df['Revenue'].value_counts().values\nlabels = df['Revenue'].value_counts().index\ncolors = ['green', 'red']\nexplode = [0, 0.2]\nplt.pie(size, colors = colors, labels = labels, explode = explode, shadow = True, autopct = '%.2f%%',)\nplt.suptitle('Revenue Analysis');","2020315c":"# Distribution of customers on Weekends\nplt.figure(figsize=(15,5))\n\nplt.subplot(1,2,1)\ndf['Weekend'].value_counts().plot(kind='bar',color='blue',alpha=0.8)\n#plt.title('Weekend Analysis')\nplt.xlabel('True\/False')\nplt.ylabel('Number of counts');\n\nplt.subplot(1,2,2)\nsize = df['Weekend'].value_counts().values\nlabels = df['Weekend'].value_counts().index\ncolors = ['green', 'red']\nexplode = [0, 0.2]\nplt.pie(size, colors = colors, labels = labels, explode = explode, shadow = True, autopct = '%.2f%%',)\nplt.suptitle('Weekend Analysis');","2c760f88":"# Distribution of customers based on VisitorType\nplt.figure(figsize=(15,5))\n\nplt.subplot(1,2,1)\ndf['VisitorType'].value_counts().plot(kind='bar',color='blue',alpha=0.8)\n#plt.title('Weekend Analysis')\nplt.xlabel('True\/False')\nplt.ylabel('Number of counts');\n\nplt.subplot(1,2,2)\nsize = df['VisitorType'].value_counts().values\nlabels = df['VisitorType'].value_counts().index\ncolors = ['green','red','blue']\nexplode = [0,0.2,0]\nplt.pie(size, colors = colors, labels = labels, explode = explode, shadow = True, autopct = '%.2f%%',)\nplt.suptitle('VisitorType Analysis');","d695e40f":"# Distribution of customers based on Traffic Type\nsns.countplot(df['TrafficType'],palette='coolwarm')\nplt.title('Different Sources')\nplt.xlabel('Traffic Type')\nplt.ylabel('count');","daaee359":"# Distribution of customers based on Region\nsns.countplot(df['Region'],palette='husl')\nplt.title('Different Region')\nplt.xlabel('Region')\nplt.ylabel('count');","242c5af5":"#Distribution of customers based on Browser\nsns.countplot(df['Browser'],palette='pastel')\nplt.title('Browser Used')\nplt.xlabel('Browser')\nplt.ylabel('count');","14c79a8f":"#Distribution of customers based on Operating Systems\nsns.countplot(df['OperatingSystems'],palette='inferno')\nplt.title('Operating Systems Used')\nplt.xlabel('Operating Systems')\nplt.ylabel('count');","55989e45":"#Distribution of customers on Months\nsns.countplot(df['Month'],palette='inferno')\nplt.title('Customers on Different months')\nplt.xlabel('Months')\nplt.ylabel('count')\nplt.show()","223537a0":"# Analysis on duration spent in different pages\nplt.figure(figsize=(10,5))\n\nplt.subplot(3,1,1)\nsns.boxplot(df['Administrative_Duration'],palette='dark')\nplt.title('Duration (in secs) in Administrative Pages')\nplt.show()\n\nplt.subplot(3,1,2)\nsns.boxplot(df['Informational_Duration'],palette='dark')\nplt.title('Duration (in secs) in Informational Pages')\nplt.show()\n\nplt.subplot(3,1,3)\nsns.boxplot(df['ProductRelated_Duration'],palette='dark')\nplt.title('Duration (in secs) in Product Pages')\nplt.show()","7b21570b":"# Analysis on various factors like bounce rates,exit rates etc\nplt.figure(figsize=(20,10))\n\nplt.subplot(2,2,1)\nsns.distplot(df['BounceRates'],color='blue')\nplt.title('Distribution of Bounce Rates');\n\nplt.subplot(2,2,2)\nsns.distplot(df['ExitRates'],color='red')\nplt.title('Distribution of Exit Rates');\n\nplt.subplot(2,2,3)\nsns.distplot(df['PageValues'],color='green',kde=False)\nplt.title('Distribution of Page Values');\n\nplt.subplot(2,2,4)\nsns.distplot(df['SpecialDay'],color='blue',kde=False)\nplt.title('Distribution of Special Day');","95529cbc":"ct = pd.crosstab(df['Revenue'],df['Weekend'])\nct.plot(kind='bar',stacked=True,colormap='jet')\nplt.title('Revenue vs Weekend');","c3393fd9":"ct = pd.crosstab(df['Revenue'],df['Weekend'])\nct","0a0a9f0a":"print('{:.2f}% making transactions during weekends'.format((499\/2868)*100))\nprint('{:.2f}% making transactions during week days'.format((1409\/9462)*100))","444af174":"ct = pd.crosstab(df['Revenue'],df['VisitorType'])\nct.plot(kind='bar',stacked=True,colormap='jet')\nplt.title('Revenue vs VisitorType');","e2a37d28":"ct = pd.crosstab(df['Revenue'],df['VisitorType'])\nct","0718334f":"print('{:.2f}% of new visitors are making transactions'.format((422\/1694)*100))\nprint('{:.2f}% of returning visitors are making transactions'.format((1470\/10551)*100))","b6580d90":"ct=pd.crosstab(df['TrafficType'],df['Revenue'])\nct.plot(kind='bar',stacked=True,colormap='jet')\nplt.title('Revenue vs TrafficType');","5d742b45":"ct=pd.crosstab(df['Region'],df['Revenue'])\nct.plot(kind='bar',stacked=True,colormap='jet')\nplt.title('Revenue vs Region');","ba21dfbf":"ct=pd.crosstab(df['Browser'],df['Revenue'])\nct.plot(kind='bar',stacked=True,colormap='jet')\nplt.title('Revenue vs Browser');","8df85c43":"ct=pd.crosstab(df['OperatingSystems'],df['Revenue'])\nct.plot(kind='bar',stacked=True,colormap='jet')\nplt.title('Revenue vs Operating Systems');","5d3b0e39":"ct=pd.crosstab(df['Month'],df['Revenue'])\nct.plot(kind='bar',stacked=True,colormap='jet')\nplt.title('Revenue vs Month');","6a76790a":"sns.stripplot(df['Revenue'],df['BounceRates'])\nplt.show()","d7ae09ae":"sns.stripplot(df['Revenue'],df['ExitRates'])\nplt.show()","be09aeec":"sns.stripplot(df['Revenue'],df['PageValues'])\nplt.show()","cf574233":"sns.violinplot(df['Revenue'],df['SpecialDay'])\nplt.show()","02cd3e17":"sns.boxplot(df['Revenue'],df['Administrative'])\nplt.show()","80386ca8":"sns.boxplot(df['Revenue'],df['Administrative_Duration'])\nplt.show()","fabdc9e4":"sns.boxplot(df['Revenue'],df['Informational'])\nplt.show()","43bc17b7":"sns.boxplot(df['Revenue'],df['Informational_Duration'])\nplt.show()","38b254ce":"sns.boxplot(df['Revenue'],df['ProductRelated'])\nplt.show()","b88a6e99":"sns.boxplot(df['Revenue'],df['ProductRelated_Duration'])\nplt.show()","a8e541ae":"df1 = df.copy()","e7cc1fd0":"df['Revenue'] = df['Revenue'].astype('int64')\ndf['Weekend'] = df['Weekend'].astype('int64')","be8377f2":"df = pd.get_dummies(df,drop_first=True)","c7da99d8":"df.head()","52443da4":"df.info()","ed92c19e":"y = df['Revenue']\nX = df.drop(['Revenue'],axis=1)","dffa6b94":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)","a39750ef":"models = {'Decision Tree':DecisionTreeClassifier(random_state=42),\n        'Random Forest':RandomForestClassifier(n_estimators=50,random_state=42),\n        'K Nearest Neighbors':KNeighborsClassifier(n_neighbors=5),\n        'Naive Bayes':GaussianNB()\n        }","32176921":"for name, algo in models.items():\n    model = algo\n    model.fit(X_train, y_train)\n    y_pred = model.predict(X_test)\n    print(name)\n    print('Train Score :',model.score(X_train, y_train)*100)\n    print('Test Score :',accuracy_score(y_test, y_pred)*100)\n    print('Precision :',precision_score(y_test,y_pred,average='micro')*100)\n    print('Recall :',recall_score(y_test,y_pred,average='micro')*100)\n    print('F1 Score :',f1_score(y_test,y_pred)*100)\n    print('AUC Score :',roc_auc_score(y_test,y_pred)*100)\n    print('Confusion matrix: ')\n    print(confusion_matrix(y_test,y_pred))\n    print('\\n')","eb0bb8bb":"y=df['Revenue']\nX=df.drop(['Revenue'],axis=1)\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)","c6892f07":"sm=SMOTE(random_state=42)\nX_train, y_train = sm.fit_sample(X_train, y_train)","1ff07591":"for name, algo in models.items():\n    model = algo\n    model.fit(X_train, y_train)\n    y_pred = model.predict(X_test)\n    print(name)\n    print('Train Score :',model.score(X_train, y_train)*100)\n    print('Test Score :',accuracy_score(y_test, y_pred)*100)\n    print('Precision :',precision_score(y_test,y_pred,average='micro')*100)\n    print('Recall :',recall_score(y_test,y_pred,average='micro')*100)\n    print('F1 Score :',f1_score(y_test,y_pred)*100)\n    print('AUC Score :',roc_auc_score(y_test,y_pred)*100)\n    print('Confusion matrix: ')\n    print(confusion_matrix(y_test,y_pred))\n    print('\\n')","65adcda3":"y=df['Revenue']\nX=df.drop(['Revenue'],axis=1)\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)","0fefdf6c":"sc=StandardScaler()\nX_train=sc.fit_transform(X_train)\nX_test=sc.transform(X_test)\n\nsm=SMOTE(random_state=42)\nX_train, y_train = sm.fit_sample(X_train, y_train)","8aa4c335":"for name, algo in models.items():\n    model = algo\n    model.fit(X_train, y_train)\n    y_pred = model.predict(X_test)\n    print(name)\n    print('Train Score :',model.score(X_train, y_train)*100)\n    print('Test Score :',accuracy_score(y_test, y_pred)*100)\n    print('Precision :',precision_score(y_test,y_pred,average='micro')*100)\n    print('Recall :',recall_score(y_test,y_pred,average='micro')*100)\n    print('F1 Score :',f1_score(y_test,y_pred)*100)\n    print('AUC Score :',roc_auc_score(y_test,y_pred)*100)\n    print('Confusion matrix: ')\n    print(confusion_matrix(y_test,y_pred))\n    print('\\n')","5eb14186":"# Filter based Method : Multi-collinearity\nmask = np.zeros_like(df.corr(),dtype=np.bool)\nmask[np.triu_indices_from(mask)] = True\nfig,ax= plt.subplots()\nfig.set_size_inches(20,15)\nsns.heatmap(df.corr(),\n           annot=True,\n           mask = mask,\n           cmap = 'RdBu_r',\n           linewidths=0.1,\n           linecolor='white',\n           vmax = .9,\n           square=True)\nbottom, top = ax.get_ylim()\nax.set_ylim(bottom + 0.5, top - 0.5)\nplt.title(\"Correlations Among Features\", y = 1.03,fontsize = 20)\nplt.show()","4daa5848":"ct=pd.crosstab(df1['Revenue'],df1['Month'])\nchi_value,p_value,dof,ec=chi2_contingency(ct)\nprint('p-value of Month :',p_value)","b033cdc8":"ct=pd.crosstab(df1['Revenue'],df1['OperatingSystems'])\nchi_value,p_value,dof,ec=chi2_contingency(ct)\nprint('p-value of Month :',p_value)","8fa2210b":"ct=pd.crosstab(df1['Revenue'],df1['Browser'])\nchi_value,p_value,dof,ec=chi2_contingency(ct)\nprint('p-value of Month :',p_value)","59fa37f1":"ct=pd.crosstab(df1['Revenue'],df1['Region'])\nchi_value,p_value,dof,ec=chi2_contingency(ct)\nprint('p-value of Month :',p_value)","e6808ba4":"ct=pd.crosstab(df1['Revenue'],df1['TrafficType'])\nchi_value,p_value,dof,ec=chi2_contingency(ct)\nprint('p-value of Month :',p_value)","7c63da52":"ct=pd.crosstab(df1['Revenue'],df1['Weekend'])\nprint(ct)","b4d779a9":"count=np.array([1409,499])\nobs=np.array([9462,2868])\nzstat,p_value=proportions_ztest(count,obs) \nprint('p-value of Weekend :',p_value)","c667a16c":"new_data=df1.groupby('Revenue')\nnew_data_rev=new_data.get_group(1)\nnew_data_no_rev=new_data.get_group(0)","25bd67b4":"tstat,p_value=ttest_ind(new_data_rev['Administrative'],new_data_no_rev['Administrative'])\nprint('p-value of Administartive :',p_value)","f884cc56":"tstat,p_value=ttest_ind(new_data_rev['Administrative_Duration'],new_data_no_rev['Administrative_Duration'])\nprint('p-value of Administartive_Duration :',p_value)","a55447df":"tstat,p_value=ttest_ind(new_data_rev['Informational'],new_data_no_rev['Informational'])\nprint('p-value of Informational :',p_value)","6ef30bde":"tstat,p_value=ttest_ind(new_data_rev['Informational_Duration'],new_data_no_rev['Informational_Duration'])\nprint('p-value of Informational_Duration :',p_value)","c2bb614e":"tstat,p_value=ttest_ind(new_data_rev['ProductRelated'],new_data_no_rev['ProductRelated'])\nprint('p-value of ProductRelated :',p_value)","0df9711d":"tstat,p_value=ttest_ind(new_data_rev['ProductRelated_Duration'],new_data_no_rev['ProductRelated_Duration'])\nprint('p-value of Informational_Duration :',p_value)","76c34526":"tstat,p_value=ttest_ind(new_data_rev['BounceRates'],new_data_no_rev['BounceRates'])\nprint('p-value of BounceRates :',p_value)","a1b3b6a7":"tstat,p_value=ttest_ind(new_data_rev['ExitRates'],new_data_no_rev['ExitRates'])\nprint('p-value of ExitRates :',p_value)","0457b442":"tstat,p_value=ttest_ind(new_data_rev['PageValues'],new_data_no_rev['PageValues'])\nprint('p-value of PageValues :',p_value)","29fb1d35":"tstat,p_value=ttest_ind(new_data_rev['SpecialDay'],new_data_no_rev['SpecialDay'])\nprint('p-value of SpecialDay :',p_value)","853db295":"y=df['Revenue']\nX=df.drop(['Revenue','Region','Administrative','Informational','ProductRelated','BounceRates'],axis=1)\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)","18f5361a":"sc=StandardScaler()\nX_train=sc.fit_transform(X_train)\nX_test=sc.transform(X_test)\n\nsm=SMOTE(random_state=42)\nX_train, y_train = sm.fit_sample(X_train, y_train)","f18263f0":"for name, algo in models.items():\n    model = algo\n    model.fit(X_train, y_train)\n    y_pred = model.predict(X_test)\n    print(name)\n    print('Train Score :',model.score(X_train, y_train)*100)\n    print('Test Score :',accuracy_score(y_test, y_pred)*100)\n    print('Precision :',precision_score(y_test,y_pred,average='micro')*100)\n    print('Recall :',recall_score(y_test,y_pred,average='micro')*100)\n    print('F1 Score :',f1_score(y_test,y_pred)*100)\n    print('AUC Score :',roc_auc_score(y_test,y_pred)*100)\n    print('Confusion matrix: ')\n    print(confusion_matrix(y_test,y_pred))\n    print('\\n')","efa35158":"# param-grid\n\n# dt-grid\ndt_grid = {'criterion':['gini','entropy'],\n           'max_features':['auto','sqrt','log2'],\n           'splitter':['best','random'],\n           'max_depth':[5,10,15]}\n\n# rf grid\nrf_grid = {'criterion':['gini','entropy'],\n           'n_estimators':np.arange(10, 500, 50),\n           'max_features':['auto','sqrt','log2'],\n           'max_depth':[None,5,8,10],\n           'min_samples_split': np.arange(2, 20, 2),\n           'min_samples_leaf': np.arange(1, 20, 2)}\n\n# KNN Grid\nknn_grid = {'n_neighbors':np.arange(1,21)}","cdec357a":"# Randomized Search CV-DT\nrs_dt = RandomizedSearchCV(DecisionTreeClassifier(random_state=42),\n                   param_distributions=dt_grid,\n                   cv=5,\n                   n_iter=20,\n                   verbose=2)\n\n# Fitting model\nrs_dt.fit(X_train,y_train);","3d744db1":"rs_dt.best_params_","5511fb4e":"y_pred = rs_dt.predict(X_test)","7d3f19c1":"print('Randomized Search CV Decision Tree')\nprint(f'Train Score :{rs_dt.score(X_train,y_train)*100:.2f}%')\nprint(f'Test Score :{rs_dt.score(X_test,y_test)*100:.2f}%')\nprint(f'AUC Score :{roc_auc_score(y_test,y_pred)*100:.2f}%')","29d9ea06":"# Randomized Search CV-RF\nrs_rf = RandomizedSearchCV(RandomForestClassifier(random_state=42),\n                   param_distributions=rf_grid,\n                   cv=5,\n                   n_iter=20,\n                   verbose=2)\n\n# Fitting model\nrs_rf.fit(X_train,y_train);","37b6a04d":"rs_rf.best_params_","46069bfb":"y_pred = rs_rf.predict(X_test)","4de22e9c":"print('Randomized Search CV Random Forest')\nprint(f'Train Score :{rs_rf.score(X_train,y_train)*100:.2f}%')\nprint(f'Test Score :{rs_rf.score(X_test,y_test)*100:.2f}%')\nprint(f'AUC Score :{roc_auc_score(y_test,y_pred)*100:.2f}%')","5bfede99":"# Randomized Search CV-KNN\nrs_knn = RandomizedSearchCV(KNeighborsClassifier(),\n                   param_distributions=knn_grid,\n                   cv=5,\n                   n_iter=20,\n                   verbose=2)\n\n# Fitting model\nrs_knn.fit(X_train,y_train);","383af14a":"rs_knn.best_params_","3784861c":"y_pred = rs_knn.predict(X_test)","918142da":"print('Randomized Search CV KNN')\nprint(f'Train Score :{rs_knn.score(X_train,y_train)*100:.2f}%')\nprint(f'Test Score :{rs_knn.score(X_test,y_test)*100:.2f}%')\nprint(f'AUC Score :{roc_auc_score(y_test,y_pred)*100:.2f}%')","c652aced":"model = AdaBoostClassifier(\n    RandomForestClassifier(n_estimators=360,\n                           min_samples_split=16,\n                           min_samples_leaf=1,\n                           max_features='sqrt',\n                           max_depth=None,\n                           criterion='entropy',\n                           random_state=42),\n    n_estimators=200\n)\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)","9528dba1":"print('Train Score :',model.score(X_train, y_train)*100)\nprint('Test Score :',accuracy_score(y_test, y_pred)*100)\nprint('Precision :',precision_score(y_test,y_pred,average='micro')*100)\nprint('Recall :',recall_score(y_test,y_pred,average='micro')*100)\nprint('F1 Score :',f1_score(y_test,y_pred)*100)\nprint('AUC Score :',roc_auc_score(y_test,y_pred)*100)\nprint('Confusion matrix: ',confusion_matrix(y_test,y_pred))","ad05a48d":"y_pred = rs_rf.predict(X_test)","ae4df09d":"plot_roc_curve(rs_rf,X_test,y_test);","63d12284":"# Classification report\nprint(classification_report(y_test,y_pred))","15dfb0be":"# Confusion Matrix\nsns.heatmap(confusion_matrix(y_test,y_pred),\n            annot=True)\nplt.xlabel('Actual Values')\nplt.ylabel('Predicted Values');","8839e0dc":"confusion_matrix(y_test,y_pred)","a61ee470":"# best params\nrs_rf.best_params_","1a4b7c69":"# New model with best params\nmodel = RandomForestClassifier(n_estimators=360,\n                               min_samples_split=16,\n                               min_samples_leaf=1,\n                               max_features='sqrt',\n                               max_depth=None,\n                               criterion='entropy',\n                               random_state=42)\nmodel.fit(X_train,y_train)","908a3eca":"feature_names = list(X.columns)","b0e77f4a":"feature_imp = pd.Series(model.feature_importances_,index=feature_names).sort_values(ascending=False)\nfeature_imp","85c82189":"sns.barplot(feature_imp,feature_imp.index)\nplt.xlabel('Feature Importance Score')\nplt.ylabel('Features')\nplt.title('Importance of Features')\nplt.show()","41132a5c":"Most of the people are visiting website during week days. Should provide some offers on weekends.","d9a824cb":"## Libraries","5735cbe9":"## Loading Dataset","e50f1295":"Revenue is not having much collinearity with any of the features. Only Page Values is having a correlation of 0.49.\nBut as expected administrative and administrative duration,imformational and informational_duration,product realted and product_related duration is having multi-collinearity. Also bounce rates and exit rates is also having a multicollinearity","3a035a2c":"## Categorical Features Encoding","2d86629b":"# Online Shoppers Intention","cdc616c4":"The website is common among region 1 customers. Should give promotions in other regions to improve sales","16970ea1":"Highly right skewed data. Outliers are present in the time spent. But we can't do any transformations, since this can happen in real time","cf26596e":"## Base Model","8141a116":"Operating System 2 is commonly used","218fa52e":"So all numerical features are significant","ddc87cbc":"## Imbalanced Dataset","3b1a8c49":"We will remove the missing values","c348c372":"Increase in the adoption and penetration of Internet has turned the online marketplace into an important distribution channel where consumers and businesses interact with each other. But the fact that the conversion rates have not increased at the same rate leads to the needs for solutions. We will analyze the different features like time duration in pages, bounce\/exit rates, page value etc and predict whether they are making transaction or not.\n","1d9df34e":"Only 14% are new visitors. So new strategy should be developed to attract new customers","64fc4c1c":"Browser 2 is commonly used","1809f4ff":"## Feature Selection","47755094":"## Data","49278d3c":"Only month and visitor type are object datatype","4f022d7a":"Choosing best model parameters from Randomized Search CV:Random Forest","95328951":"Bounce rate is low for success transaction","e68f756c":"![Image%201.jpg](attachment:Image%201.jpg)","1d939cd4":"As expected, since transactions are less, page values will be less. Also when considering bounce rates, most frequent value is 0. So, that means customers are visiting website, checking through different pages but revert back due to different reasons.","7105d31e":"## Info about Dataset","0c8ceb1d":"The success of transaction depends mainly on page values,exit rate and the duration spent in different pages","383c7c16":"Here 'Revenue' is the dependent variable. Since it is having boolean output, the problem is binary classification","15e36b53":"## Feature Importance","f9a26554":"It's clear that the dataset is highly imbalanced dataset. We should do some sampling techniques to avoid this problem.","4bfda96b":"Even though more people are visiting website in May, highest transaction rate is in November","197bab02":"## Exploratory Data Analysis","3728666e":"Here even though operating sysytems,browser,region and traffic type is having integer data type, they represents different categories","5ce14f56":"## Standard Scaling-Modelling","67184829":"As the dataset is highly imbalanced, there is high train and test score. But AUC scores are less.","07117414":"## Problem Definition","1d7f627f":"Balanced dataset can be created by using SMOTE technique or any other resampling techniques.We will apply resampling techniques to the training dataset and keep the validation set as such.","b46a8376":"From the above plots, it is difficult to find whether these variables are significant or not. So we have to do statistical test for that.","de1bc422":"Here we assign the confidence level as 95% and found the feature 'region' as insignificant.","8f06b609":"## Boosting","715677e2":"10 months are considered here, (exception January and April). In this May is the month, where the website is more commonly used.November,March and December are also considerable\nOne of the top Turkish Traditional Festival (Ahirkapi Hidirellez Festival) is happening in May. Also national youth and sports day is celebrated in May.","7a617d45":"Here, the transaction rate of new visitors are almost doubled that of returning visitor","75d7da6d":"We will also check the statistical significance of the features","78713131":"### Analysis wrt dependent variable","921c8d37":"Traffic Source 2 is the best advertising source for the website. Should consider other sources and decide whether it is needed or not","ad87aa93":"## Features","81254045":"* Administrative: Number of pages visited by the visitor about account management\n* Administrative duration: Total amount of time (in seconds) spent by the visitor on account management related pages\n* Informational: Number of pages visited by the visitor about Web site, communication and address information of the shopping site\n* Informational duration: Total amount of time (in seconds) spent by the visitor on informational pages\n* Product related: Number of pages visited by visitor about product related pages\n* Product related duration: Total amount of time (in seconds) spent by the visitor on product related pages\n\nThe values of these features are derived from the URL information of the pages visited by the user and updated in real time when a user takes an action, e.g. moving from one page to another.\n\n* Bounce rate: Average bounce rate value of the pages visited by the visitor\n* Exit rate: Average exit rate value of the pages visited by the visitor\n* Page value: Average page value of the pages visited by the visitor\n\nThe metrics measured by \"Google Analytics\" for each page in the e-commerce site.\n\n* Special Day: The \"Special Day\" feature indicates the closeness of the site visiting time to a specific special day (e.g. Mother\u2019s Day, Valentine's Day) in which the sessions are more likely to be finalized with transaction. The value of this attribute is determined by considering the dynamics of e-commerce such as the duration between the order date and delivery date. For example, for Valentina\u2019s day, this value takes a nonzero value between February 2 and February 12, zero before and after this date unless it is close to another special day, and its maximum value of 1 on February 8.\n\nThe dataset also includes operating system, browser, region, traffic type, visitor type as returning or new visitor, a Boolean value indicating whether the date of the visit is weekend, and month of the year.","7ae8dbf8":"Choosing best model as randomized search cv based random forest","4fd71ed4":"## Hyper Parameter Tuning","2f789979":"## Modelling after Feature Selection","dd27fd52":"## Evaluation","51ed2bf0":"The dataset was downloaded from UCI repository. This data was taken from a leading distribution company in Turkey.","76600bc0":"## Randomized Search CV","af0506e7":"There is not a significant difference in transactions rates on weekdays and weekends. 75% of the customers are visiting websites on weekdays,but transaction rate is very low"}}