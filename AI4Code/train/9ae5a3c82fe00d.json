{"cell_type":{"fd052547":"code","caa5f2c1":"code","bdbe0881":"code","5521d8a6":"code","20eb211f":"code","190e6629":"code","80576c3d":"code","348c7f2f":"markdown","92372487":"markdown"},"source":{"fd052547":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport lightgbm as lgb\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session\n","caa5f2c1":"%time\ntrain = pd.read_csv('..\/input\/ventilator-pressure-prediction\/train.csv',index_col=0)\ntest  = pd.read_csv('..\/input\/ventilator-pressure-prediction\/test.csv', index_col=0)\nsample_submission     = pd.read_csv('..\/input\/ventilator-pressure-prediction\/sample_submission.csv')","bdbe0881":"idxmax_time_step = train.groupby('breath_id')['time_step'].idxmax()\nlast_value_u_in = train.loc[idxmax_time_step, ['breath_id','u_in']]\nlast_value_u_in.columns = ['breath_id','last_value_u_in']\n\ntrain = train.merge(last_value_u_in, on='breath_id')\ntrain","5521d8a6":"idxmax_time_step = test.groupby('breath_id')['time_step'].idxmax()\nlast_value_u_in = test.loc[idxmax_time_step, ['breath_id','u_in']]\nlast_value_u_in.columns = ['breath_id','last_value_u_in']\n\ntest = test.merge(last_value_u_in, on='breath_id')\ntest","20eb211f":"lgb_model = lgb.LGBMRegressor()\nlgb_model.fit(train.drop(['breath_id', 'pressure'], axis=1), train['pressure'])","190e6629":"test['pressure'] = lgb_model.predict(test.drop('breath_id', axis=1))\nsample_submission['pressure'] = test['pressure']","80576c3d":"sample_submission.to_csv('sample_submission.csv', index=False)","348c7f2f":"It's obvious that `presure` would be getting closer to `u_in` in the end\n\nSo let's use the last value of `u_in` in time series as new feature","92372487":"![image.png](attachment:c3a70d5d-79a3-45e0-9228-d7d0246bc7de.png)"}}