{"cell_type":{"fdb06a65":"code","c51a8fae":"markdown"},"source":{"fdb06a65":"import pandas as pd\nimport numpy as np\n\ndef concat_row(r):\n    if r['WTeamID'] < r['LTeamID']:\n        res = str(r['Season'])+\"_\"+str(r['WTeamID'])+\"_\"+str(r['LTeamID'])\n    else:\n        res = str(r['Season'])+\"_\"+str(r['LTeamID'])+\"_\"+str(r['WTeamID'])\n    return res\n\n# Delete leaked from train\ndef delete_leaked_from_df_train(df_train, df_test):\n    df_train['Concats'] = df_train.apply(concat_row, axis=1)\n    df_train_duplicates = df_train[df_train['Concats'].isin(df_test['ID'].unique())]\n    df_train_idx = df_train_duplicates.index.values\n    df_train = df_train.drop(df_train_idx)\n    df_train = df_train.drop('Concats', axis=1)\n    \n    return df_train \n\ndef read_data(inFile, sep=','):\n    df_op = pd.read_csv(filepath_or_buffer=inFile, low_memory=False, encoding='utf-8', sep=sep)\n    return df_op\n\nPATH = \"\/kaggle\/input\/ncaam-march-mania-2021\/\"\ndf_test = read_data(PATH+\"MSampleSubmissionStage1.csv\")\ndf_train = read_data(PATH+\"MNCAATourneyCompactResults.csv\")\n\nprint(\"SIZE TRAIN BEFORE :\")\nprint(df_train.shape)\ndf_train = delete_leaked_from_df_train(df_train, df_test)\nprint()\nprint(\"SIZE TRAIN AFTER :\")\nprint(df_train.shape)\n\n","c51a8fae":"Here is a function I used in the similar last year competition.\n\nIt deletes leaked data from the training set.\n\nUPDATE\n\nI considered that during one season, two teams can have only one game; if there are several, that means we have leaked data. Nevertheless, according to [what Kaggle team mentioned later](https:\/\/www.kaggle.com\/c\/ncaaw-march-mania-2021-spread\/discussion\/222375#1219345), this is not true, as two teams can play several games during the same season. All the data must be used for training, as there are not very many samples.\n"}}