{"cell_type":{"16cfba6a":"code","cc96a90a":"code","2e2770af":"code","831f84dd":"code","ef29478a":"code","451f810b":"code","d77f36d1":"code","e9c9f964":"code","4cba594d":"code","6adb40a0":"code","be8e65be":"code","1d2d9398":"code","5b3e1e62":"code","86165f4f":"code","2dcf3cdf":"code","3679d079":"code","ac15e44a":"code","602682a7":"code","3205092e":"code","ff3ac302":"code","4133e913":"code","055a48e4":"code","8dcb3ad9":"code","928a7aae":"code","1da301a1":"code","7068cc57":"code","cb0f5803":"code","4a3801bb":"code","cb4da7a6":"code","42695d75":"markdown","cc4c561c":"markdown","37a9d315":"markdown","0bd445ad":"markdown","247c8e2a":"markdown","1cc446e7":"markdown","16d25fd1":"markdown","7a98d0be":"markdown","fdd38f60":"markdown","5cd03d62":"markdown","5d0f4799":"markdown","60b33316":"markdown","8eedd316":"markdown","4477ebf6":"markdown","a382e60b":"markdown","e6818df9":"markdown","437d27ef":"markdown","a6d53f6e":"markdown","3321b0bb":"markdown","7056259b":"markdown"},"source":{"16cfba6a":"# Build Machine Learning Model menggunakan Linear Regression\n# Dataset yang digunakan adalah harga rumah Bengaluru\n# Model diadaptasi dari tutorial Youtube Codebasic\n# Link youtube = https:\/\/www.youtube.com\/watch?v=rdfbcdP75KI&list=PLeo1K3hjS3uu7clOTtwsp94PcHbzqpAdg\n# Github = https:\/\/github.com\/codebasics","cc96a90a":"import pandas as pd\ndf = pd.read_csv(\"..\/input\/bengaluru_house_prices.csv\")\ndf.head()\ndf.info()","2e2770af":"df2 = df.drop(['area_type','availability','society','balcony'], axis='columns')\ndf2.head()","831f84dd":"display(df2.info())\ndisplay(df2.isnull().sum())\n\ndf2 = df2.dropna()\ndf2.info()","ef29478a":"df2['bhk'] = df2['size'].apply(lambda i: int(i.split(' ')[0]))\ndf2 = df2.drop(['size'], axis=1)\ndf2.info()","451f810b":"def is_float(x):\n    try:\n        float(x)\n    except:\n        return False\n    return True\n\ndf2[~df2['total_sqft'].apply(is_float)]","d77f36d1":"def convert_sqft_to_num(x):\n    tokens = x.split('-')\n    if len(tokens) == 2:\n        return (float(tokens[0])+float(tokens[1]))\/2\n    try:\n        return float(x)\n    except:\n        return None \ndf3 = df2.copy()\ndf3['total_sqft'] = df3['total_sqft'].apply(convert_sqft_to_num)","e9c9f964":"display(df3.info())\ndf3 = df3.dropna()\ndf3.info()","4cba594d":"df4 = df3.copy()\ndisplay(len(df4.location.unique()))\ndf4['location'] = df4['location'].apply(lambda i: i.strip())\nx = df4['location'].value_counts()\ndisplay(x.shape)\ndisplay(x[x<=10].shape)\nlen(x[x>10])","6adb40a0":"loc_less10 = x[x<=10]\nlen(df4['location'].unique())","be8e65be":"df4['location'] = df4['location'].apply(lambda i: 'other' if i in loc_less10 else i)\nlen(df4['location'].unique())","1d2d9398":"display(df4.info())\ndf4.head()","5b3e1e62":"df5 = df4[~(df4['total_sqft']\/df4['bhk'] < 300)] ### ~ artinya komplement\ndf5.info()","86165f4f":"df6 = df5.copy()\ndf6['price_per_sqft'] = df6['price']*100000 \/ df6['total_sqft']\ndf6.price_per_sqft.describe()","2dcf3cdf":"df7 = pd.DataFrame()\nfor key, sub in df6.groupby('location'):\n    m = sub['price_per_sqft'].mean()\n    st = sub['price_per_sqft'].std()\n    new_df = sub[(sub['price_per_sqft'] > (m-st))&(sub['price_per_sqft'] < (m+st))]\n    df7 = pd.concat([df7,new_df], ignore_index=True)\ndf7                                     ","3679d079":"df7.bath.unique()\ndf7.shape","ac15e44a":"df8 = df7[df7['bath'] < df7['bhk']+2]\ndf8.shape","602682a7":"import plotly.express as px\nfig = px.box(y=df8['bath'])\n# fig = px.hist(y=df7['bath'])\nfig.show()\nfig = px.histogram(x=df8['bath'])\nfig.show()","3205092e":"dummies = pd.get_dummies(df8.location)\ndummies.head()","ff3ac302":"df9 = pd.concat([df8,dummies], axis='columns')\ndf9.head()","4133e913":"df10 = df9.drop(['location','price_per_sqft','other'], axis=1)\ndisplay(df10.head())\ndf10.shape","055a48e4":"X = df10.drop(['price'],axis=1)\nY = df10.price\ndisplay(X.head())\ndisplay(Y.head())","8dcb3ad9":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test = train_test_split(X,Y,test_size=0.2,random_state=10)","928a7aae":"from sklearn.linear_model import LinearRegression\nlr_clf = LinearRegression()\nlr_clf.fit(x_train,y_train)\nlr_clf.score(x_test,y_test) ## Default using R^2 Scoring","1da301a1":"from sklearn.model_selection import ShuffleSplit\nfrom sklearn.model_selection import cross_val_score\n\ncv = ShuffleSplit(n_splits = 10, test_size = 0.2, random_state = 0)\ncross_val_score(LinearRegression(),X,Y,cv=cv).mean()","7068cc57":"## Ridge Regression\nfrom sklearn.linear_model import Ridge\n\ncross_val_score(Ridge(),X,Y,cv=cv).mean()","cb0f5803":"## Lasso Regression\nfrom sklearn.linear_model import Lasso\n\ncross_val_score(Lasso(),X,Y,cv=cv).mean()","4a3801bb":"import numpy as np\ndef predict_price(location,sqft,bath,bhk):    \n    loc_index = np.where(X.columns==location)[0][0]\n\n    x = np.zeros(len(X.columns))\n    x[0] = sqft\n    x[1] = bath\n    x[2] = bhk\n    if loc_index >= 0:\n        x[loc_index] = 1\n\n    return lr_clf.predict([x])[0]","cb4da7a6":"predict_price('1st Phase JP Nagar',1000, 3, 3)","42695d75":"R^2 yang kita dapat dari 3 model diatas adalah LinearRegression = 0.788, RidgeRegression = 0.787, LassoRegression = 0.665. Untuk itu kita akan menggunakan Linear Regression sebagai model terbaik","cc4c561c":"## Dimensional Reduction (kolom Location)","37a9d315":"## Outlier By Total sqft","0bd445ad":"## Cleaning Data (kolom sqft)","247c8e2a":"__Remove Outlier By Range__","1cc446e7":"Skor model yang sudah kita buat 0.79, ini bukan hasil yang baik. Mari kita coba meningkatkan model menggunakan Ridge Regression dan Lasso ","16d25fd1":"Nilai maximum dari price_per_sqft 176470, sedangkan nilai minimum : 267. Dalam dataset ini jelas terlihat range yang besar, untuk itu kita akan menghapus outlier per location berdasar mean dan standard deviasinya","7a98d0be":"### Use Cross Validation to score our model","fdd38f60":"## Cleaning Data (Kolom bhk)","5cd03d62":"## Treating Missing Values","5d0f4799":"Dari data di atas terdapat 1287 lokasi berbeda, terdapat 1047 lokasi yang hanya memiliki rumah tidak lebih dari 10 unit, dimensi ini bisa kita reduction dengan mengubah lokasi dibawah 10 unit menjadi 'other'","60b33316":"## Using One Hot Encoder for Feature Location","8eedd316":"## Outlier by Bath","4477ebf6":"Dalam suatu rumah mungkin semua kamar memiliki kamar mandi pribadi plus 1 kamar mandi tamu, tapi kecil kemungkinan dalam 1 rumah memiliki 2 kamar mandi lebih banyak daripada kamar tidur. Rumah yang memiliki 2 kamar mandi lebih banyak daripada kamar tidur kita anggap outlier","a382e60b":"Skor R^2 dari model Linear Rrgression yang dibuat adalah 0.83. Saya rasa ini cukup baik, mari kita coba skor model menggunakan Cross Validation","e6818df9":"Pada model Linear Regression kita akan menggunakan features dengan tipe data numeric dan 1 feautre tipe categori, feature yang akan kita gunakan adalah (location,size, total_sqft, dan bath). Kolom 'price' akan kita gunakan sebagai target.","437d27ef":"## Drop Column","a6d53f6e":"## Build Model","3321b0bb":"__Remove Outlier By Bisnis Mind__\n\nSebagai data scientist, saat anda berdiskusi dengan manager bisnis anda, dia akan mengatakan luas bhk secara normal adalah 300 square per feet. Jika ada dalam dataset tersebut yang luas kamarnya kurang dari 300 sqft maka akan kita anggap sebagai outlier.","7056259b":"## Test model for view properties"}}