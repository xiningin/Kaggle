{"cell_type":{"99a973d2":"code","3a49cab2":"code","5b3466f5":"code","ce53ac21":"code","af9055af":"code","07c2a1ba":"code","8fdf48ff":"code","5b34beea":"code","eb6e14b9":"code","8dc51f9e":"code","e5c17440":"code","778a8d25":"code","585db965":"code","63f04b97":"code","5d04993a":"code","ac1a848d":"code","5d1e1acd":"code","3bb7f29c":"code","126135c7":"code","580dadad":"code","cdb48904":"code","949108cf":"code","5890e0c1":"code","4f20a793":"code","08524221":"code","331a4127":"code","b0ffcee8":"code","7a70d713":"code","80f3f9ef":"code","a4d2d8b5":"code","e95dd008":"code","fb6f23e3":"code","352c3912":"markdown","b82127bb":"markdown","1a9b68e8":"markdown","7f31f2e2":"markdown","1763f71e":"markdown","fd6bc4b8":"markdown","afe13836":"markdown","5e8e1b87":"markdown","066e91b3":"markdown","9e83fd98":"markdown","1bc81eb3":"markdown","dc5fbf61":"markdown","44ddac89":"markdown"},"source":{"99a973d2":"import numpy as np #numpy is useful for making arrays \nimport pandas as pd #to make dataframes(structured table)\nfrom sklearn.model_selection import train_test_split #to allow training data and test data\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score #to check performance of model\n","3a49cab2":"# load the dataset to a pandas dataframe\ncredit_card_data = pd.read_csv(\"..\/input\/creditcardfraud\/creditcard.csv\")","5b3466f5":"# 1st five rows of data set\ncredit_card_data.head()","ce53ac21":"credit_card_data.tail() #last five rows","af9055af":"#dataset informations\ncredit_card_data.info()","07c2a1ba":"#checking the no. of missing values in each column\ncredit_card_data.isnull().sum()","8fdf48ff":"#check distribution of legit transactions & fraudulent transactions.\ncredit_card_data['Class'].value_counts()","5b34beea":" #seperating the data for analysis \nlegit = credit_card_data[credit_card_data.Class == 0]\nfraud = credit_card_data[credit_card_data.Class == 1]","eb6e14b9":"print(legit.shape)\nprint(fraud.shape)","8dc51f9e":"#statistical measures of data\nlegit.Amount.describe()","e5c17440":"fraud.Amount.describe()","778a8d25":"#compare the values for both transaction\ncredit_card_data.groupby('Class').mean()","585db965":"#Dealing with unbalance data","63f04b97":"legit_sample = legit.sample(n=492)","5d04993a":"#concatenating two dataframes\nnew_dataset = pd.concat([legit_sample, fraud],axis=0) #axis =0 row wise axis = 1 column wise","ac1a848d":"new_dataset.head()","5d1e1acd":"new_dataset.tail()","3bb7f29c":"new_dataset['Class'].value_counts()","126135c7":"new_dataset.groupby('Class').mean() \n#to check good sample or bad sample we have to compare it with previous data we can observe that good sample contains similar mean as compare to previous data","580dadad":"x = new_dataset.drop(columns = 'Class',axis=1)\ny = new_dataset['Class']","cdb48904":"print(x)","949108cf":"print(y)","5890e0c1":"x_train, x_test, y_train, y_test = train_test_split(x, y,test_size = 0.2, stratify=y, random_state=2)","4f20a793":"''' we created 4 arrays here because x and y train will store the 80% data and their\ncorresponding labels and x&y test will store 20% data and their corresponding labels''' \n","08524221":"''' test size = 0.2 denotes we are taking 20% of data as our test data\nstratify denotes even distribution of class between x train and x test '''","331a4127":"print(x.shape,x_train.shape,x_test.shape)","b0ffcee8":"model = LogisticRegression()","7a70d713":"# training the Logistic Regression Model with Training Data\nmodel.fit(x_train,y_train)","80f3f9ef":"# accuracy on training data \nx_train_prediction = model.predict(x_train) #this will predict y_train values corresponding to x_train\ntraining_data_accuracy = accuracy_score(x_train_prediction, y_train) #will compare values predicted by our model with values stored in y_train","a4d2d8b5":"print('Accuracy on training data:',training_data_accuracy)","e95dd008":"# accuracy on test data\nx_test_prediction = model.predict(x_test)\ntest_data_accuracy = accuracy_score(x_test_prediction, y_test)","fb6f23e3":"print('Accuracy on Test Data:',test_data_accuracy)","352c3912":"Build a sample dataset containing similar distribution of normal transaction and fraudulent transactions.","b82127bb":"Logistic Regression","1a9b68e8":"This dataset is highly unbalanced","7f31f2e2":"Mean for fraudulent is more","1763f71e":"We dont have any missing values in this dataset.","fd6bc4b8":"Split the data into training data and test data ","afe13836":"0 --> Normal Transaction\n1 -- > Fraudulent transaction ","5e8e1b87":"Accuracy score","066e91b3":"Number of fraudulent transactions --> 492","9e83fd98":"Splitting data into features and targets","1bc81eb3":"Model Evaluation","dc5fbf61":"Model Training","44ddac89":"UNDER-SAMPLING "}}