{"cell_type":{"8b44c8f5":"code","e170f924":"code","8aea14a2":"code","234c5a7d":"code","3fc90235":"code","763e30c1":"code","14a05e58":"code","fdc38299":"code","06d93f09":"code","ecd8a8a5":"code","42e7798b":"code","dc68e32a":"markdown","f7fb85c3":"markdown","02b3db6c":"markdown","351b1152":"markdown","62f9de05":"markdown"},"source":{"8b44c8f5":"import numpy as np\nimport pandas as pd\nimport cv2\nimport matplotlib.pyplot as plt\n\nfrom tqdm import tqdm\nfrom tqdm.notebook import tqdm as note_book_tqdm","e170f924":"note_book_tqdm.pandas(desc=\"progress: \")","8aea14a2":"train = pd.read_csv('..\/input\/shopee-product-matching\/train.csv')","234c5a7d":"train.shape","3fc90235":"train.head()","763e30c1":"def dhash(image_name, hashSize=8):\n    \"\"\"calculation to create a numerical representation of the image.\"\"\"\n    image_path = f'..\/input\/shopee-product-matching\/train_images\/{image_name}'\n    image = cv2.imread(image_path, )\n    gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)\n    resized = cv2.resize(gray, (hashSize + 1, hashSize))\n    diff = resized[:, 1:] > resized[:, :-1]\n    return sum([2 ** i for (i, v) in enumerate(diff.flatten()) if v])","14a05e58":"# Add hash value as column\ntrain.loc[:, 'ImageHash'] = train.image.progress_apply(dhash)","fdc38299":"# Remove rows with the same hash value\ntrain = train.drop_duplicates(['ImageHash'])","06d93f09":"train.shape","ecd8a8a5":"train = train.drop_duplicates(['title'])","42e7798b":"train.shape","dc68e32a":"# Result\nDuplicate images from __34250__ images to __31307__ images were removed.","f7fb85c3":"# Data Loading","02b3db6c":"# Setting","351b1152":"# Purpose\nIn this notebook, I'll be removing duplicated images in shopee training dataset.  \nI referred to the discussion below.  \n[shopee-product-matching\/discussion\/224604](https:\/\/www.kaggle.com\/c\/shopee-product-matching\/discussion\/224604)  \nAnd I referred to the following article.  \n[Detect and remove duplicate images from a dataset for deep learning - PyImageSearch](https:\/\/www.pyimagesearch.com\/2020\/04\/20\/detect-and-remove-duplicate-images-from-a-dataset-for-deep-learning\/)","62f9de05":"# Additional processing\nTry removing the data with the same title."}}