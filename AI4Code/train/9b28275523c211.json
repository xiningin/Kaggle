{"cell_type":{"01ec65c2":"code","16ad77e4":"code","71a1fa9a":"code","b5e6d76d":"code","85466d87":"code","fb7eb8e0":"code","a66fb3f6":"code","6fdc8d85":"code","ebd8f7e5":"code","af7a0fc9":"code","37146a3a":"code","212b91eb":"code","5aa36ccf":"code","4c0247c4":"code","f7f8c4c6":"code","05582bde":"code","3ac745e5":"code","bb5ac51f":"code","2ff5fab9":"code","4560b9ff":"code","21232e09":"code","f90318e1":"code","f9afe348":"code","ba86cad4":"code","ddedfbd0":"code","9bbb2cee":"code","7b858a37":"code","c1c5c5db":"code","cd3ae085":"code","aef94dd8":"code","7663358d":"code","e3139591":"code","2d6c4751":"code","a403987d":"code","cb6e01a2":"code","43ea711c":"code","de4e5218":"code","1e7c5270":"code","81c98da9":"code","e04ff645":"code","55375770":"code","40e63653":"code","aba5c0d4":"code","3f575002":"code","0a4dcab4":"code","4d1be481":"code","9fbb7757":"code","75218fc8":"markdown","a46063c7":"markdown","61a5c1cd":"markdown","de03a960":"markdown","fe0da272":"markdown","c164288d":"markdown","12a87deb":"markdown","34bedbdf":"markdown","ec3cf00b":"markdown","1f8cb5d7":"markdown","568c4e55":"markdown","c174ae02":"markdown","ef62b301":"markdown","0a4354cc":"markdown","526e6042":"markdown","a6e4f125":"markdown","09ded293":"markdown","bd501d76":"markdown","2ad0b224":"markdown","bf679baf":"markdown","2f058633":"markdown","5a71859f":"markdown","f9005625":"markdown","01d50317":"markdown","a774f77d":"markdown","624740da":"markdown","0c5dd746":"markdown","889d4ebe":"markdown","04be1153":"markdown","c9ea3f5b":"markdown","a915d580":"markdown","fa746a87":"markdown","889c0e4e":"markdown","3d924cb9":"markdown","f84c70e9":"markdown","2d30c69c":"markdown","10229f99":"markdown","f6e47877":"markdown","ca4eb21b":"markdown","ecc942a8":"markdown","00e1bc52":"markdown"},"source":{"01ec65c2":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport datetime as dt\n\nimport sklearn\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.cluster import KMeans\nfrom sklearn.metrics import silhouette_score\n\nfrom scipy.cluster.hierarchy import linkage\nfrom scipy.cluster.hierarchy import dendrogram\nfrom scipy.cluster.hierarchy import cut_tree","16ad77e4":"# Suppress warnings\nimport warnings\nwarnings.filterwarnings(\"ignore\")","71a1fa9a":"df_country = pd.read_csv(\"..\/input\/unsupervised-learning-on-country-data\/Country-data.csv\", sep=\",\", encoding=\"ISO-8859-1\", header=0)","b5e6d76d":"df_country.head()","85466d87":"df_country.info()","fb7eb8e0":"df_country.columns","a66fb3f6":"df_country.shape","6fdc8d85":"# missing values\nround(100*(df_country.isnull().sum())\/len(df_country), 2)","ebd8f7e5":"#Converting exports,imports and health spending percentages to absolute values.\ndf_country['exports'] = df_country['exports']*df_country['gdpp']\/100\ndf_country['imports'] = df_country['imports']*df_country['gdpp']\/100\ndf_country['health'] = df_country['health']*df_country['gdpp']\/100","af7a0fc9":"df_country.head()","37146a3a":"df_country.corr()","212b91eb":"plt.figure(figsize = (20,10))        \nsns.heatmap(df_country.corr(),annot = True, cmap=\"YlGnBu\")","5aa36ccf":"#The final matrix would only contain the data columns. Hence let's drop the country column\ndata=df_country.drop(['country'],axis=1)\ndata.head()","4c0247c4":"from sklearn.preprocessing import StandardScaler\nstandard_scaler = StandardScaler()\ndf_c = standard_scaler.fit_transform(data)","f7f8c4c6":"df_c.shape","05582bde":"fig, axs = plt.subplots(3,3,figsize = (15,15))\n\n# Child Mortality Rate : Death of children under 5 years of age per 1000 live births\n\ntop10_child_mort = df_country[['country','child_mort']].sort_values('child_mort', ascending = False).head(10)\nplt1 = sns.barplot(x='country', y='child_mort', data= top10_child_mort, ax = axs[0,0])\nplt1.set(xlabel = '', ylabel= 'Child Mortality Rate')\n\n# Fertility Rate: The number of children that would be born to each woman if the current age-fertility rates remain the same\ntop10_total_fer = df_country[['country','total_fer']].sort_values('total_fer', ascending = False).head(10)\nplt1 = sns.barplot(x='country', y='total_fer', data= top10_total_fer, ax = axs[0,1])\nplt1.set(xlabel = '', ylabel= 'Fertility Rate')\n\n# Life Expectancy: The average number of years a new born child would live if the current mortality patterns are to remain same\n\nbottom10_life_expec = df_country[['country','life_expec']].sort_values('life_expec', ascending = True).head(10)\nplt1 = sns.barplot(x='country', y='life_expec', data= bottom10_life_expec, ax = axs[0,2])\nplt1.set(xlabel = '', ylabel= 'Life Expectancy')\n\n# Health :Total health spending as %age of Total GDP.\n\nbottom10_health = df_country[['country','health']].sort_values('health', ascending = True).head(10)\nplt1 = sns.barplot(x='country', y='health', data= bottom10_health, ax = axs[1,0])\nplt1.set(xlabel = '', ylabel= 'Health')\n\n# The GDP per capita : Calculated as the Total GDP divided by the total population.\n\nbottom10_gdpp = df_country[['country','gdpp']].sort_values('gdpp', ascending = True).head(10)\nplt1 = sns.barplot(x='country', y='gdpp', data= bottom10_gdpp, ax = axs[1,1])\nplt1.set(xlabel = '', ylabel= 'GDP per capita')\n\n# Per capita Income : Net income per person\n\nbottom10_income = df_country[['country','income']].sort_values('income', ascending = True).head(10)\nplt1 = sns.barplot(x='country', y='income', data= bottom10_income, ax = axs[1,2])\nplt1.set(xlabel = '', ylabel= 'Per capita Income')\n\n\n# Inflation: The measurement of the annual growth rate of the Total GDP\n\ntop10_inflation = df_country[['country','inflation']].sort_values('inflation', ascending = False).head(10)\nplt1 = sns.barplot(x='country', y='inflation', data= top10_inflation, ax = axs[2,0])\nplt1.set(xlabel = '', ylabel= 'Inflation')\n\n\n# Exports: Exports of goods and services. Given as %age of the Total GDP\n\nbottom10_exports = df_country[['country','exports']].sort_values('exports', ascending = True).head(10)\nplt1 = sns.barplot(x='country', y='exports', data= bottom10_exports, ax = axs[2,1])\nplt1.set(xlabel = '', ylabel= 'Exports')\n\n\n# Imports: Imports of goods and services. Given as %age of the Total GDP\n\nbottom10_imports = df_country[['country','imports']].sort_values('imports', ascending = True).head(10)\nplt1 = sns.barplot(x='country', y='imports', data= bottom10_imports, ax = axs[2,2])\nplt1.set(xlabel = '', ylabel= 'Imports')\n\nfor ax in fig.axes:\n    plt.sca(ax)\n    plt.xticks(rotation = 90)\n    \nplt.tight_layout()\nplt.savefig('eda')\nplt.show()","3ac745e5":"fig, axs = plt.subplots(3,3, figsize = (15,7.5))\nplt1 = sns.boxplot(df_country['child_mort'], ax = axs[0,0])\nplt2 = sns.boxplot(df_country['health'], ax = axs[0,1])\nplt3 = sns.boxplot(df_country['life_expec'], ax = axs[0,2])\nplt4 = sns.boxplot(df_country['total_fer'], ax = axs[1,0])\nplt5 = sns.boxplot(df_country['income'], ax = axs[1,1])\nplt6 = sns.boxplot(df_country['inflation'], ax = axs[1,2])\nplt7 = sns.boxplot(df_country['gdpp'], ax = axs[2,0])\nplt8 = sns.boxplot(df_country['imports'], ax = axs[2,1])\nplt9 = sns.boxplot(df_country['exports'], ax = axs[2,2])\n\n\nplt.tight_layout()","bb5ac51f":"df_country.describe()","2ff5fab9":"data_c = ['child_mort', 'exports', 'health', 'imports', 'income',\n       'inflation', 'life_expec', 'total_fer', 'gdpp']\n\nfor i in data_c:\n    percentiles = data[i].quantile([0.05, 0.95]).values\n    data[i][data[i] <= percentiles[0]] = percentiles[0]\n    data[i][data[i] >= percentiles[1]] = percentiles[1]","4560b9ff":"data.head()","21232e09":"# Treating (statistical) outliers\ngrouped_df = df_country.groupby('country')['income'].sum()\ngrouped_df = grouped_df.reset_index()\ngrouped_df.head()","f90318e1":"Q1 = grouped_df.income.quantile(0.05)\nQ3 = grouped_df.income.quantile(0.95)\nIQR = Q3 - Q1\ngrouped_df = grouped_df[(grouped_df.income >= Q1 - 1.5*IQR) & (grouped_df.income <= Q3 + 1.5*IQR)]","f9afe348":"standard_scaler = StandardScaler()\ndf_scaled = standard_scaler.fit_transform(data)\ndf_scaled.shape","ba86cad4":"#Calculating the Hopkins statistic\nfrom sklearn.neighbors import NearestNeighbors\nfrom random import sample\nfrom numpy.random import uniform\nimport numpy as np\nfrom math import isnan\n \ndef hopkins(X):\n    d = X.shape[1]\n    #d = len(vars) # columns\n    n = len(X) # rows\n    m = int(0.1 * n) \n    nbrs = NearestNeighbors(n_neighbors=1).fit(X.values)\n \n    rand_X = sample(range(0, n, 1), m)\n \n    ujd = []\n    wjd = []\n    for j in range(0, m):\n        u_dist, _ = nbrs.kneighbors(uniform(np.amin(X,axis=0),np.amax(X,axis=0),d).reshape(1, -1), 2, return_distance=True)\n        ujd.append(u_dist[0][1])\n        w_dist, _ = nbrs.kneighbors(X.iloc[rand_X[j]].values.reshape(1, -1), 2, return_distance=True)\n        wjd.append(w_dist[0][1])\n \n    H = sum(ujd) \/ (sum(ujd) + sum(wjd))\n    if isnan(H):\n        print(ujd, wjd)\n        H = 0\n \n    return H","ddedfbd0":"hopkins(df_country.drop('country', axis = 1))","9bbb2cee":"# k-means with some arbitrary k\nkmeans = KMeans(n_clusters=4, max_iter=50, random_state=100)\nkmeans.fit(df_scaled)","7b858a37":"kmeans.labels_","c1c5c5db":"ssd = []\nrange_n_clusters = [2,3,4,5,6,7,8,9,10,11]\n\nfor num_clusters in range_n_clusters:\n    kmeans = KMeans(n_clusters=num_clusters, max_iter=50, random_state=50)\n    kmeans.fit(df_scaled)\n    \n    ssd.append(kmeans.inertia_)\n    \n# plot the SSDs for each n_clusters\n# ssd\nplt.plot(ssd)","cd3ae085":"# silhouette analysis\nrange_n_clusters = [2, 3, 4, 5, 6, 7, 8,9,10,11]\n\nfor num_clusters in range_n_clusters:\n    \n    # intialise kmeans\n    kmeans = KMeans(n_clusters=num_clusters, max_iter=50, random_state=50)\n    kmeans.fit(df_scaled)\n    \n    cluster_labels = kmeans.labels_\n    \n    # silhouette score\n    silhouette_avg = silhouette_score(df_scaled, cluster_labels)\n    print(\"For n_clusters={0}, the silhouette score is {1}\".format(num_clusters, silhouette_avg))\n    \n    ","aef94dd8":"# final model with k=3\nkmeans = KMeans(n_clusters=3, max_iter=50, random_state=50)\nkmeans.fit(df_scaled)","7663358d":"kmeans.labels_","e3139591":"# assign the label\ndata['cluster_id'] = kmeans.labels_\ndata.head()","2d6c4751":"#plot\nsns.boxplot(x='cluster_id', y='income', data=data)","a403987d":"#plot\nsns.boxplot(x='cluster_id', y='gdpp', data=data)","cb6e01a2":"#plot\nsns.boxplot(x='cluster_id', y='child_mort', data=data)","43ea711c":"fig, axs = plt.subplots(3,3, figsize = (15,7.5))\nplt1 = sns.boxplot(x='cluster_id', y = 'child_mort', data=data, ax = axs[0,0])\nplt2 = sns.boxplot(x='cluster_id', y = 'health', data=data, ax = axs[0,1])\nplt3 = sns.boxplot(x='cluster_id', y = 'life_expec', data=data, ax = axs[0,2])\nplt4 = sns.boxplot(x='cluster_id', y = 'total_fer', data=data, ax = axs[1,0])\nplt5 = sns.boxplot(x='cluster_id', y = 'income', data=data, ax = axs[1,1])\nplt6 = sns.boxplot(x='cluster_id', y = 'inflation', data=data, ax = axs[1,2])\nplt7 = sns.boxplot(x='cluster_id', y = 'gdpp', data=data, ax = axs[2,0])\nplt8 = sns.boxplot(x='cluster_id', y = 'imports', data=data, ax = axs[2,1])\nplt9 = sns.boxplot(x='cluster_id', y = 'exports', data=data, ax = axs[2,2])\n\n\nplt.tight_layout()","de4e5218":"df_country['cluster_id'] = kmeans.labels_\ncluster_2_kmeans = df_country[['cluster_id','country', 'child_mort', 'gdpp', 'income' ]].loc[df_country['cluster_id'] == 2].reset_index()\ncluster_2_kmeans.shape","1e7c5270":"cluster_2_kmeans.sort_values(by = ['child_mort', 'gdpp', 'income'], ascending = [False, True, True]).head(5)","81c98da9":"df_scaled = pd.DataFrame(df_scaled)\ndf_scaled.head()","e04ff645":"data.head()","55375770":"# single linkage\nmergings = linkage(df_scaled, method=\"single\", metric='euclidean')\ndendrogram(mergings)\nplt.show()","40e63653":"# complete linkage\nmergings = linkage(df_scaled, method=\"complete\", metric='euclidean')\ndendrogram(mergings)\nplt.show()","aba5c0d4":"# 3 clusters\ncluster_labels = cut_tree(mergings, n_clusters=3).reshape(-1, )\ncluster_labels","3f575002":"# assign cluster labels\ndata['cluster_labels'] = cluster_labels\ndata.head()","0a4dcab4":"# plots\nfig, axs = plt.subplots(3,3, figsize = (15,7.5))\nplt1 = sns.boxplot(x='cluster_labels', y = 'child_mort', data=data, ax = axs[0,0])\nplt2 = sns.boxplot(x='cluster_labels', y = 'health', data=data, ax = axs[0,1])\nplt3 = sns.boxplot(x='cluster_labels', y = 'life_expec', data=data, ax = axs[0,2])\nplt4 = sns.boxplot(x='cluster_labels', y = 'total_fer', data=data, ax = axs[1,0])\nplt5 = sns.boxplot(x='cluster_labels', y = 'income', data=data, ax = axs[1,1])\nplt6 = sns.boxplot(x='cluster_labels', y = 'inflation', data=data, ax = axs[1,2])\nplt7 = sns.boxplot(x='cluster_labels', y = 'gdpp', data=data, ax = axs[2,0])\nplt8 = sns.boxplot(x='cluster_labels', y = 'imports', data=data, ax = axs[2,1])\nplt9 = sns.boxplot(x='cluster_labels', y = 'exports', data=data, ax = axs[2,2])\n\n\nplt.tight_layout()","4d1be481":"df_country['cluster_labels'] = cluster_labels\ncluster_0_hc = df_country[['cluster_labels','country', 'child_mort', 'gdpp', 'income' ]].loc[df_country['cluster_labels'] == 0].reset_index()\ncluster_0_hc.shape","9fbb7757":"cluster_0_hc.sort_values(by = ['child_mort', 'gdpp', 'income'], ascending = [False, True, True]).head(5)","75218fc8":"# Hierarchical Clustering","a46063c7":"**Observations**\n1. Haiti has highest child mortality rate and least Life expectatncy.\n2. Niger has highest Fertility Rate.\n3. Eritrea has lowest spending on Health.\n4. Burundi has lowest GDP per capita\n5. The republic of Congo has lowest Per Capita Income\n6. Inflation rates of Nigeria are the highest\n7. Myanmar doesn't export or import much(lowest exports and imports)","61a5c1cd":"### - We have a good hopkins score implies that the dataset has high tendency to cluster\n- Let's proceed with K-means and Hierarchical Clustering","de03a960":"We observe the following correlations from the plot.\n\n- gdpp and income are most highly correlated with correlation of 0.9\n- child_mortality and life_expentency are highly correlated with correlation of -0.89\n- child_mortality and total_fertility are highly correlated with correlation of 0.85\n- imports and exports are highly correlated with correlation of 0.74\n- life_expentency and total_fertility are highly correlated with correlation of -0.76","fe0da272":"### Outlier Analysis\nWe will see how values in each columns are distributed using boxplot","c164288d":"###### Rescaling the data","12a87deb":"**Haiti is in the highest need for HELP foundation followed by Sierre Leone, Chad, CAR, Mali among other AFRICAN countries.**","34bedbdf":"### We can see that both K means and Hierarchical clustering with K=3 gave us similar results. We are able to group the countries which we can provide to HELP international CEO to focus on the most.\n\n- There are 43-48 backward countries which HELP international CEO should target to focus on.\n\n**Top 5 of those are:\n1. Haiti\n2. Sierra Leone\n3. Chad\n4. Central African Republic\n5. Mali**\n\namong other African countries.","ec3cf00b":"###### There are 2 types of outliers\n1. Domain specific\n2. Statistical\n\nLet's treat statistical outliers","1f8cb5d7":"#### K-Means Clustering and Hierarchical Clustering","568c4e55":"### Let's see which are those countries\n","c174ae02":"# EDA","ef62b301":"**Observations**\n1. We can see a direct relation between the socioeconomic factors in the above boxplots\n2. The cluster with highest income group has better health, highest gdpp, higher life expectancy, higher imports and exports, lowest child mortality, lower inflation rates and lower fertility rates.\n3. While the countries with lower gdpp, imports and exports have lower income, higher child mortality, inflation and fertility.\n\n- Cluster 1 are the better placed countries in terms of socio-economic status, health and development.\n- **Cluster 2 countries would need help for development as this group forms highest child mortality, lowest gdpp and lowest income group.**","0a4354cc":"###### K-means with some arbitatary K","526e6042":"#### Sum of squared Distance (SSD)","a6e4f125":"### Silhouette Analysis\n\n$$\\text{silhouette score}=\\frac{p-q}{max(p,q)}$$\n\n$p$ is the mean distance to the points in the nearest cluster that the data point is not a part of\n\n$q$ is the mean intra-cluster distance to all the points in its own cluster.\n\n* The value of the silhouette score range lies between -1 to 1. \n\n* A score closer to 1 indicates that the data point is very similar to other data points in the cluster, \n\n* A score closer to -1 indicates that the data point is not similar to the data points in its cluster.","09ded293":"###### Single Linkage","bd501d76":"- As we can see there are a number of outliers in the data.\n- Keeping in mind we need to identify backward countries based on socio economic and health factors.\n- We will cap the outliers to values accordingly for analysis.","2ad0b224":"-- We can observe that there is no missing values in the dataset\n\n- So this data seems largely clean,but we have a lot of variables and making and visualising proper clusters will be a   difficulty.\n- Let's plot the correlation matrix and check if the data is indeed highly correlated","bf679baf":"## Finding optimal number of clusters","2f058633":"Univariate Analysis\n\nWe need to choose the countries that are in the direst need of aid. Hence, we need to identify those countries with using some socio-economic and health factors that determine the overall development of the country.\n\nWe will have a look on the lowest 10 countries for each factor.\n\n1. **Child Mortality Rate** : Death of children under 5 years of age per 1000 live births\n2. **Fertility Rate**: The number of children that would be born to each woman if the current age-fertility rates remain the same\n3. **Life Expectancy**: The average number of years a new born child would live if the current mortality patterns are to remain same\n4. **Health** :Total health spending as %age of Total GDP.\n5. **The GDP per capita** : Calculated as the Total GDP divided by the total population.\n6. **Per capita Income** : Net income per person\n7. **Inflation**: The measurement of the annual growth rate of the Total GDP\n8. **Exports:** Exports of goods and services. Given as %age of the Total GDP\n9. **Imports:** Imports of goods and services. Given as %age of the Total GDP","5a71859f":"**Overview**<br>\nGiven the datset of countries with socioeconomic and health information. Categorise the countries using some socio-economic and health factors that determine the overall development of the country. Also, suggest the countries which needs more focus.\n\nApply both K-means clustering and Hierarchical Clustering.\n\nThe steps are broadly:\n\n1. Read and understand the data\n2. Clean the data\n3. Prepare the data for modelling\n4. Modelling\n5. Final analysis and reco","f9005625":"##### Read the dataset","01d50317":"###### Complete Linkage","a774f77d":"**Below are the countries which need help from HELP Foundation and the CEO should focus upon**","624740da":"###### Health, import and export are given as percentage values, lets convert them to absolute values based on gdpp","0c5dd746":"- we observe that a lot of the data variables are of different orders of magnitude. \n- Let's standardise the values using Standard Scaler","889d4ebe":"# 1. Read and Visualize the data","04be1153":"**There are 48 countries in cluster 2 which need help for development as per K-means Clustering**","c9ea3f5b":"#### Hopkin's Score","a915d580":"<a We can see that there is no missing values in the dataset a>","fa746a87":"# Clustering without PCA","889c0e4e":"**Observations**\n- Here cluster 2 forms the better placed countries in terms of socio-economic status and Cluster 0 is a group of countries which would need help with lowest gdpp, income and highest child mortality rates.","3d924cb9":"- Lets check the correlation matrix and Heatmap","f84c70e9":"**Observations**\n- Cluster 1 comprises of highest income countries, Cluster 0 forms mid income and cluster 0 forms lowest income countries\n- There is a huge gap between hioghest and lowest incomes' countries","2d30c69c":"We observe the following about the outliers.\n\n- All variables have outliers on the upper side (higher values) except for life_expec which has outliers on the down side (less values) indicating that usually the life expectancy in most countries is above 50 except for 3 countries.","10229f99":"# 4. Clustering","f6e47877":"# 3. Prepare the data for modelling","ca4eb21b":"Thank you for going through this notebook. :)","ecc942a8":"# 2. Clean the data\n\n- Check for missing values\n- Check for outliers","00e1bc52":"### Model with k=3"}}