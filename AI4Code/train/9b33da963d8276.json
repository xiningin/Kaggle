{"cell_type":{"7e834edb":"code","f627406a":"code","9e591eb0":"code","c23924de":"code","e28e6543":"code","558c1e61":"code","0cd39039":"code","ed64130d":"code","f60e6337":"code","b80e09d2":"code","015cc673":"code","d4a35c58":"code","8a0b7543":"markdown","56b4bd90":"markdown","937ef346":"markdown","83957931":"markdown","2a807eef":"markdown","0032cecf":"markdown","24e52f95":"markdown"},"source":{"7e834edb":"!pip install autokeras","f627406a":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix\n%matplotlib inline\nfrom autokeras.image.image_supervised import ImageClassifier\nnp.random.seed(2)\n\nimport itertools\nfrom keras.utils.np_utils import to_categorical # convert to one-hot-encoding","9e591eb0":"train_data = pd.read_csv('\/kaggle\/input\/Kannada-MNIST\/train.csv')\ntest_data = pd.read_csv('\/kaggle\/input\/Kannada-MNIST\/test.csv')","c23924de":"print (train_data.shape)\ntrain_data.head()","e28e6543":"print (test_data.shape)\ntest_data.head()","558c1e61":"X_test_id = test_data['id']\ntrain_data['label'].value_counts()","0cd39039":"y_train = train_data['label']\nX_train = train_data.drop(['label'], axis = 1)\nX_test = test_data.drop(['id'], axis = 1)","ed64130d":"# Regularization of values\nX_train = X_train\/255.0\nX_test = X_test\/255.0\n\n# Reshaping for an Image rather than line data.\nX_train = X_train.values.reshape(-1,28,28,1)\nX_test = X_test.values.reshape(-1,28,28,1)\n\n#y_train = to_categorical(y_train, num_classes = 10)\n\nX_train, X_val, y_train, y_val = train_test_split(X_train, y_train, test_size=0.2)","f60e6337":"clf = ImageClassifier(verbose=True)\nclf.fit(X_train, y_train, time_limit=3 * 60 * 60)\nclf.final_fit(X_train, y_val, X_val, y_val, retrain=True)\nY = clf.evaluate(X_val, y_val)\nprint(Y)","b80e09d2":"preds = clf.predict(X_test)\npreds = np.argmax(preds,axis=1,out=None)","015cc673":"submission = pd.DataFrame({\n    'id' : X_test_id,\n    'label' : preds\n})","d4a35c58":"submission.to_csv('submission.csv',index=False)","8a0b7543":"# Make Submission","56b4bd90":"# Foreword\n\nThe original AutoKeras paper: https:\/\/arxiv.org\/pdf\/1806.10282.pdf\nDocumentation: https:\/\/autokeras.com\/start\/","937ef346":"# Install Required Packages","83957931":"# Import Libraries","2a807eef":"# Data Preparation","0032cecf":"# Data Import","24e52f95":"# AutoKeras Model"}}