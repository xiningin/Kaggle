{"cell_type":{"dd5e3fa8":"code","3188f363":"code","5eb23e0b":"code","cb39505f":"code","e6a63d13":"code","61c2e415":"code","d233929f":"code","9d01e74d":"code","b9383bc7":"code","479940fc":"code","0ec7f12e":"code","e47421df":"code","1d80720d":"code","790a28e8":"code","2fdada47":"code","a16cc232":"markdown","1fbda0b2":"markdown","f1237228":"markdown","00f102fe":"markdown","d0d6e20b":"markdown","2b71013b":"markdown"},"source":{"dd5e3fa8":"# manupulating libraries       \nimport numpy as np        # linear algebra\nimport pandas as pd       # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n\n# built-in function & Dataset Library\n\nfrom surprise       import Dataset, Reader, SVD, accuracy  \nfrom tqdm           import trange       # Progress bar library\n","3188f363":"train=pd.read_csv('..\/input\/joke-rating-prediction\/Joke rating prediction\/train.csv')\njokes=pd.read_csv(\"..\/input\/joke-rating-prediction\/Joke rating prediction\/jokes.csv\")\ntest=pd.read_csv(\"..\/input\/joke-rating-prediction\/Joke rating prediction\/test.csv\")","5eb23e0b":"print('train:\\n',train.head())\nprint('\\njokes:\\n',jokes.head())\nprint('\\ntest:\\n',test.head())","cb39505f":"rating=train['Rating'].sort_values(ascending=False)","e6a63d13":"rating.head(10)","61c2e415":"# Loading custom dataset & rating scale parameter\ndf=pd.DataFrame(train[['user_id','joke_id','Rating']])\nreader=Reader(rating_scale=(-10, 10))","d233929f":"# columns corresponding order of userid, jokeid,rating\ndata=Dataset.load_from_df(df[['user_id','joke_id','Rating']],reader)","9d01e74d":"from surprise.model_selection import train_test_split\ntrain_set, test_set = train_test_split(data, test_size=.25)","b9383bc7":"svd_model = SVD()\nsvd_model.fit(train_set)","479940fc":"predictions = svd_model.test(test_set)","0ec7f12e":"# compute Root Mean Squared Error\naccuracy.rmse(predictions)\n","e47421df":"pred = []\n","1d80720d":"for i in trange(test.shape[0]):\n    pred.append((test.iloc[i,0], svd_model.predict(test.iloc[i, 1], test.iloc[i, 2])[3]))\n","790a28e8":"pdf = pd.DataFrame(pred, columns = ['id', 'Rating'])\n","2fdada47":"pdf.to_csv('submission.csv', index = False)\n","a16cc232":"\n**1.Import Libarary**","1fbda0b2":"**2. Read Dataset**","f1237228":"Thanks for Reading!!!","00f102fe":"**Problem Statement:**\n\nThis is a practice problem to predict the joke ratings given by users who provide the ratings provided by the same users for another set of jokes. This dataset is taken from the famous Joker Online Prank Recommendation System dataset","d0d6e20b":"**3. Display Head (top 5 row) of dataset**","2b71013b":"**Split Train & Test data**"}}