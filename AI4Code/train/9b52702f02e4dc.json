{"cell_type":{"2dc5f6ff":"code","d757918a":"code","79c4aa95":"code","732e63f2":"code","22b0f7bb":"code","af3fe006":"code","6045420a":"code","fbb0233e":"code","4a3149da":"code","9f796018":"code","56525fe8":"code","44b446a2":"code","a4163c75":"code","94c5ab6d":"code","a020c5f2":"code","753c1763":"code","8289cda0":"code","72cb63f8":"code","d84a5b01":"code","cd23f749":"code","c71e8ee1":"code","61ce228b":"code","61db7733":"code","d796bb4e":"code","951be1de":"markdown","6b163229":"markdown"},"source":{"2dc5f6ff":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nprint(os.listdir(\"..\/input\"))\nfrom tqdm import tqdm_notebook as tqdm\nimport matplotlib.pyplot as plt","d757918a":"df_test = pd.read_csv('..\/input\/test.csv')\ndf_test.drop(['ID_code'], axis=1, inplace=True)\ndf_test = df_test.values\n\nunique_samples = []\nunique_count = np.zeros_like(df_test)\nfor feature in tqdm(range(df_test.shape[1])):\n    _, index_, count_ = np.unique(df_test[:, feature], return_counts=True, return_index=True)\n    unique_count[index_[count_ == 1], feature] += 1\n\n# Samples which have unique values are real the others are fake\nreal_samples_indexes = np.argwhere(np.sum(unique_count, axis=1) > 0)[:, 0]\nsynthetic_samples_indexes = np.argwhere(np.sum(unique_count, axis=1) == 0)[:, 0]\n\nprint(len(real_samples_indexes))\nprint(len(synthetic_samples_indexes))","79c4aa95":"train=pd.read_csv(\"..\/input\/train.csv\")\ntest=pd.read_csv(\"..\/input\/test.csv\")","732e63f2":"test=test.iloc[real_samples_indexes]\nfeatures = [c for c in train.columns if c not in ['ID_code', 'target']]","22b0f7bb":"for x in features[0:10]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","af3fe006":"for x in features[10:20]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","6045420a":"for x in features[20:30]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","fbb0233e":"for x in features[30:40]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","4a3149da":"for x in features[40:50]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","9f796018":"for x in features[50:60]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","56525fe8":"for x in features[60:70]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","44b446a2":"for x in features[70:80]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","a4163c75":"for x in features[80:90]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","94c5ab6d":"for x in features[90:100]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","a020c5f2":"for x in features[100:110]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","753c1763":"for x in features[110:120]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","8289cda0":"for x in features[120:130]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","72cb63f8":"for x in features[130:140]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","d84a5b01":"for x in features[140:150]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","cd23f749":"for x in features[150:160]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","c71e8ee1":"for x in features[160:170]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","61ce228b":"for x in features[170:180]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","61db7733":"for x in features[180:190]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","d796bb4e":"for x in features[190:]:\n    aux=train.groupby(x).agg({'ID_code':'count','target':'sum'}).reset_index()\n    aux['target0']=aux.ID_code-aux.target\n    auxt=test.groupby(x).agg({'ID_code':'count'}).reset_index()\n    plt.figure(figsize=(20,4))\n    plt.plot(auxt[x],auxt.ID_code,label='test')\n    plt.plot(aux[x],aux.ID_code,color='red',alpha=0.4,label='train')\n    plt.legend()\n    plt.title(x)\n    plt.show()\n    plt.figure(figsize=(20,4))\n    plt.plot(aux[x],aux.target0,label='0')\n    plt.plot(aux[x],aux.target,color='red',alpha=0.7,label='1')\n    plt.legend()\n    plt.title(x+'target0\/1')\n    plt.show()","951be1de":"Train vs Real Test and \nTrain target 0 vs Train target 1","6b163229":"real test from https:\/\/www.kaggle.com\/yag320\/list-of-fake-samples-and-public-private-lb-split\n@YaG320"}}