{"cell_type":{"d1fd4e21":"code","133d0297":"code","a707e490":"code","79bdb45b":"code","529aa559":"code","eb4df226":"code","04329d1c":"code","3b200550":"code","aa614721":"code","31f3b767":"code","8609a09d":"code","bbd0df0a":"code","49d060b1":"code","01c56285":"code","ba921e00":"code","75af0ac4":"code","68debf49":"code","ffbee8ee":"code","5530d607":"code","9cd1c496":"code","7ae0ee3a":"code","259dc65f":"code","553a89b6":"code","1e1edbd5":"code","cb04d43b":"code","7cbf4ac4":"code","820c7f05":"code","90ff788c":"code","a7d7f433":"code","ce5e3aa1":"code","1e51736e":"code","99971268":"code","c4712881":"code","76ef4641":"code","00d04d58":"code","2729bd76":"code","e26e2204":"code","d0e8854d":"code","eda590a3":"code","5e26b4f7":"code","22b05274":"code","d8c3cd55":"code","6fdfcc57":"code","da146cc5":"code","3eda8a93":"code","b340e8a3":"code","7dad75ce":"code","b643f1b9":"code","6bf4205b":"code","06a79bf7":"markdown","35b93963":"markdown","8d7f3569":"markdown","70e184a0":"markdown","ee3bb620":"markdown","0c8e4375":"markdown","37228fc5":"markdown","610346bf":"markdown","d87939f8":"markdown","03e831c7":"markdown"},"source":{"d1fd4e21":"import pandas as pd\nimport numpy as np\nimport warnings\nwarnings.filterwarnings(\"ignore\")","133d0297":"df=pd.read_csv(\"..\/input\/fetalhr\/CTG.csv\")","a707e490":"df.head()","79bdb45b":"df=df.drop([\"FileName\",\"Date\",\"SegFile\",\"b\",\"e\"],axis=1)","529aa559":"df.head()","eb4df226":"df.columns","04329d1c":"df.shape","3b200550":"df.isnull().sum()","aa614721":"df=df.dropna()","31f3b767":"df.isnull().sum()","8609a09d":"df.dtypes","bbd0df0a":"X=df[['LBE', 'LB', 'AC', 'FM', 'UC', 'DL',\n       'DS', 'DP', 'DR']]\nY=df[[\"NSP\"]]","49d060b1":"from sklearn.preprocessing import StandardScaler, MinMaxScaler\nScaler=StandardScaler()\nX=Scaler.fit_transform(X)\n","01c56285":"\nfrom sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,Y,test_size=0.3,random_state=42)","ba921e00":"from sklearn.svm import SVC\n\nsvm_clf=SVC(kernel=\"poly\",degree=6,coef0=5,gamma=0.1)\nsvm_clf=svm_clf.fit(X_train,y_train)\ny_pred=svm_clf.predict(X_test)\n","75af0ac4":"from sklearn.metrics import accuracy_score, precision_score, f1_score, recall_score, confusion_matrix","68debf49":"print(confusion_matrix(y_test,y_pred))","ffbee8ee":"f1_score(y_test,y_pred,average='weighted')","5530d607":"\naccuracy_score(y_test,y_pred)","9cd1c496":"precision_score(y_test,y_pred,average='weighted')","7ae0ee3a":"recall_score(y_test,y_pred,average=\"weighted\")","259dc65f":"from sklearn.tree import DecisionTreeClassifier","553a89b6":"tree_clf=DecisionTreeClassifier(min_samples_split=6, min_samples_leaf=4, max_depth=6, )\ntree_clf=tree_clf.fit(X_train,y_train)\ny_pred=tree_clf.predict(X_test)","1e1edbd5":"accuracy_score(y_test,y_pred)","cb04d43b":"recall_score(y_test,y_pred,average=\"weighted\")","7cbf4ac4":"precision_score(y_test,y_pred,average='weighted')","820c7f05":"from sklearn.tree import export_graphviz\nexport_graphviz(\ntree_clf, out_file=\"tree.dot\",\nfeature_names=['LBE', 'LB', 'AC', 'FM', 'UC', 'DL',\n       'DS', 'DP', 'DR'],\nclass_names=\"NSP\",\nrounded=True,\nfilled=True)","90ff788c":"from subprocess import check_call\ncheck_call(['dot','-Tpng','tree.dot','-o','tree.png'])","a7d7f433":"from sklearn.ensemble import VotingClassifier, RandomForestClassifier","ce5e3aa1":"svm_clf=SVC(kernel=\"poly\",degree=6,coef0=5,gamma=0.1,probability=True)\ndecision_tree=DecisionTreeClassifier(min_samples_split=6, min_samples_leaf=4, max_depth=6)\nrnd_clf=RandomForestClassifier()\nvoting_clf=VotingClassifier(estimators=[(\"svm\",svm_clf),('rf',rnd_clf),(\"decision_tree\",decision_tree)],voting=\"hard\")","1e51736e":"voting_clf.fit(X_train,y_train)","99971268":"for clf in (rnd_clf, svm_clf,decision_tree, voting_clf):\n    clf.fit(X_train, y_train)\n    y_pred = clf.predict(X_test)\n    print(clf.__class__.__name__, accuracy_score(y_test, y_pred))","c4712881":"from sklearn.ensemble import BaggingClassifier","76ef4641":"bag_clf=BaggingClassifier(DecisionTreeClassifier(),n_estimators=500,n_jobs=-1,max_samples=100, bootstrap=True)","00d04d58":"bag_clf.fit(X_train,y_train)\ny_pred=bag_clf.predict(X_test)","2729bd76":"print(accuracy_score(y_test,y_pred))","e26e2204":"##This accuracy is better than our previous decision tree model\n##Therefore, we will again call ensemble technique.","d0e8854d":"voting_clf=VotingClassifier(estimators=[(\"svm\",svm_clf),('rf',rnd_clf),(\"bagging_clf\",bag_clf)],voting=\"hard\")","eda590a3":"for clf in (rnd_clf, svm_clf,bag_clf, voting_clf):\n    clf.fit(X_train, y_train)\n    y_pred = clf.predict(X_test)\n    print(clf.__class__.__name__, accuracy_score(y_test, y_pred))","5e26b4f7":"##Using trial and hit method, and performing out-of-box evaluation\n##Since a predictor never sees the oob instances during training, it can be evaluated on these instances,\n##without the need for a separate validation set or cross-validation. You can evaluate the ensemble itself by\n##averaging out the oob evaluations of each predictor.","22b05274":"bag_clf=BaggingClassifier(DecisionTreeClassifier(),n_estimators=500,n_jobs=-1,max_samples=100, bootstrap=True,oob_score=True)\nbag_clf.fit(X_train,y_train)\ny_pred=bag_clf.predict(X_test)\nprint(bag_clf.oob_score_)\nprint(accuracy_score(y_test,y_pred))","d8c3cd55":"from sklearn.ensemble import AdaBoostClassifier","6fdfcc57":"ada_clf=AdaBoostClassifier(DecisionTreeClassifier(max_depth=1),n_estimators=1000,learning_rate=0.1)","da146cc5":"ada_clf.fit(X_train,y_train)\ny_pred=ada_clf.predict(X_test)","3eda8a93":"print(accuracy_score(y_test,y_pred))","b340e8a3":"from xgboost import XGBClassifier\nxgb_clf=XGBClassifier(learning_rate=0.001)\nxgb_clf.fit(X_train,y_train)\ny_pred=xgb_clf.predict(X_test)","7dad75ce":"print(accuracy_score(y_test,y_pred))","b643f1b9":"voting_clf=VotingClassifier(estimators=[(\"svm\",svm_clf),(\"xgb_clf\",xgb_clf)],voting=\"hard\")\n","6bf4205b":"for clf in (svm_clf,xgb_clf, voting_clf):\n    clf.fit(X_train, y_train)\n    y_pred = clf.predict(X_test)\n    print(clf.__class__.__name__, accuracy_score(y_test, y_pred))","06a79bf7":"## Calculating different metrics","35b93963":"# Applying XGBoost","8d7f3569":"# Decision Tree Classifier","70e184a0":"# Applying the ADAboost ","ee3bb620":"### CHecking for appropriate values of gamma","0c8e4375":"## Classifiying the NSP into, Normal=1; Suspect=2; Pathologic=3","37228fc5":"## As, we can observe that there is a slight increase in the overall acuracy while using the ensemble model.","610346bf":"## FileName:\tof CTG examination\t\n## Date:\tof the examination\t\n## b:\tstart instant\t\n## e:\tend instant\t\n## LBE:\tbaseline value (medical expert)\t\n## LB:\tbaseline value (SisPorto)\t\n## AC:\taccelerations (SisPorto)\t\n## FM:\tfoetal movement (SisPorto)\t\n## UC:\tuterine contractions (SisPorto)\t\n## ASTV:\tpercentage of time with abnormal short term variability  (SisPorto)\t\n## mSTV:\tmean value of short term variability  (SisPorto)\t\n## ALTV:\tpercentage of time with abnormal long term variability  (SisPorto)\t\n## mLTV:\tmean value of long term variability  (SisPorto)\t\n## DL:\tlight decelerations\t\n## DS:\tsevere decelerations\t\n## DP:\tprolongued decelerations\t\n## DR:\trepetitive decelerations\t\n## Width:\thistogram width\t\n## Min:\tlow freq. of the histogram\t\n## Max:\thigh freq. of the histogram\t\n## Nmax:\tnumber of histogram peaks\t\n## Nzeros:\tnumber of histogram zeros\t\n## Mode:\thistogram mode\t\n## Mean:\thistogram mean\t\n## Median:\thistogram median\t\n## Variance:\thistogram variance\t\n## Tendency:\thistogram tendency: -1=left assymetric; 0=symmetric; 1=right assymetric\t\n## A:\tcalm sleep\t\n## B:\tREM sleep\t\n## C:\tcalm vigilance\t\n## D:\tactive vigilance\t\n## SH:\tshift pattern (A or Susp with shifts)\t\n## AD:\taccelerative\/decelerative pattern (stress situation)\t\n## DE:\tdecelerative pattern (vagal stimulation)\t\n## LD:\tlargely decelerative pattern\t\n## FS:\tflat-sinusoidal pattern (pathological state)\t\n## SUSP:\tsuspect pattern\t\n## CLASS:\tClass code (1 to 10) for classes A to SUSP\t\n## NSP:\tNormal=1; Suspect=2; Pathologic=3\t\n","d87939f8":"# Using the ensemble technique","03e831c7":"## Peforming the scaling"}}