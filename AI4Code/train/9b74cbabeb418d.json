{"cell_type":{"124d6393":"code","ae67663f":"code","fb6ed7a6":"code","8e383722":"code","d8863ab9":"code","fd55a885":"code","ab2b8eca":"code","bd6ff22e":"code","c1c16339":"code","ab89a572":"code","03f36242":"code","f77a9de6":"code","7b0d22c8":"code","fffff2e5":"code","34216648":"code","82de7ac3":"code","ba24cf72":"code","c6cd4a73":"code","e73d606d":"code","79dd53c6":"code","fdce51f3":"markdown","213d17dc":"markdown","1d1c2cae":"markdown","46d5428c":"markdown","c2ab522c":"markdown"},"source":{"124d6393":"from fastai.vision import *\nfrom fastai.metrics import accuracy","ae67663f":"# Copy for FastAI\n!mkdir -p data\n!cp -R ..\/input\/dsnet-kaggledays-hackathon\/train\/train data\/train\n!cp -R ..\/input\/dsnet-kaggledays-hackathon\/test\/test data\/test\n!cp ..\/input\/dsnet-kaggledays-hackathon\/sample_submission.csv data\/sample_submission.csv","fb6ed7a6":"DATA_DIR = Path('data')","8e383722":"bs = 64","d8863ab9":"data = ImageDataBunch.from_folder(DATA_DIR, valid_pct=0.2, ds_tfms=get_transforms(), bs=bs, size=224).normalize(imagenet_stats)\n","fd55a885":"data.show_batch(rows=3, figsize=(7,6))","ab2b8eca":"learn = cnn_learner(data, models.resnet34, metrics=accuracy)","bd6ff22e":"learn.model","c1c16339":"learn.lr_find()","ab89a572":"learn.recorder.plot()","03f36242":"learn.fit_one_cycle(5, 1e-2\/2)","f77a9de6":"# Save the model\nlearn.save('simple-model')","7b0d22c8":"# Load the model\nlearn.load('simple-model');","fffff2e5":"# Load submission file\nsample_df = pd.read_csv(DATA_DIR\/'sample_submission.csv')\nsample_df.head()","34216648":"# Generate test predictions\nlearn.data.add_test(ImageList.from_df(sample_df,DATA_DIR,folder='test'))","82de7ac3":"# Load up submission file\npreds,y = learn.get_preds(DatasetType.Test)","ba24cf72":"# Convert predictions to classes\npred_classes = [data.classes[c] for c in list(preds.argmax(dim=1).numpy())]\npred_classes[:10]","c6cd4a73":"# Add the prediction\nsample_df.predicted_class = pred_classes\nsample_df.head()","e73d606d":"# Save the submission file\nsample_df.to_csv('submission.csv',index=False)\n\nfrom IPython.display import FileLink\nFileLink('submission.csv')","79dd53c6":"# Clean up (for commit)\n!cp -R data\/models models # Move the models out\n!rm -rf data # Delete the data","fdce51f3":"**This is a fork of @crazydiv fastai-starter kernel.**\n\nYou can easily get this score by making the following changes from the fastai-starter kernel:\n\n- Use better Resnet Model(usually Resnet18< Resnet 34< Resnet 50< Resnet 101) give better accuracy and takes more time to train though\n- Use pretrained model(Don't forget to turn on Internet in the Kaggle Kernel section).\n\nAlso according @init27 it's highly recommended to watch Lecture 1 of fast.ai for this competition.\n","213d17dc":"## More things you can do \n\nYou can improve the accuracy even more by using following techniques in Deep Learning which usually works:\n- Using [Data augmentation](https:\/\/towardsdatascience.com\/introduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42)\n- Try out [Discriminative Learning rates](https:\/\/www.kaggle.com\/kurianbenoy\/starter-kernel-fastai-discriminative-learning)\n- And train for more epochs(isn't  it so obvious)","1d1c2cae":"## Model","46d5428c":"## Data","c2ab522c":"## Inference"}}