{"cell_type":{"ac5ba96d":"code","0b453e2c":"code","b4f80fbc":"code","175b896d":"code","92de285b":"code","818f6989":"code","2554303e":"code","40282e0f":"code","c7d5fcf1":"code","83c10e80":"code","d4d32714":"code","6450c50b":"code","60aeebe5":"markdown","a5bfe5e4":"markdown","dcddb4f7":"markdown","c2bb2050":"markdown","bd070c72":"markdown","eac63d5e":"markdown","c9f7b75d":"markdown","ddfeb1d8":"markdown","bb8b7c9c":"markdown","ae31e80f":"markdown","457b563d":"markdown","d92f0432":"markdown"},"source":{"ac5ba96d":"import numpy as np\nimport pandas as pd\nimport os \nimport tensorflow as tf\nimport tensorflow.keras as keras\nfrom keras import Model\nfrom keras.applications import DenseNet121\nfrom keras.preprocessing import image\nfrom keras.applications.densenet import preprocess_input, decode_predictions\nfrom keras.layers import GlobalMaxPooling2D\nfrom keras.utils import plot_model\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg\nimport cv2\nimport pathlib\nfrom sklearn.metrics.pairwise import linear_kernel","0b453e2c":"path = '..\/input\/fashion-product-images-dataset\/fashion-dataset\/fashion-dataset\/'\ndataset_path = pathlib.Path(path)\nimages=os.listdir(dataset_path)\nimages","b4f80fbc":"plt.figure(figsize=(20,20))\nfor i in range(10, 20):\n    plt.subplot(6, 10, i-10+1)\n    cloth_img =  mpimg.imread(path + 'images\/100'+ str(i) +'.jpg')\n    plt.imshow(cloth_img)\n    plt.axis(\"off\")\nplt.subplots_adjust(wspace=-0.5, hspace=1)\nplt.show()","175b896d":"df = pd.read_csv(path + \"styles.csv\", nrows=6000, error_bad_lines=False)\ndf['image'] = df.apply(lambda x: str(x['id']) + \".jpg\", axis=1)\ndf = df.reset_index(drop=True)\nprint(df.shape)\ndf.head(5)","92de285b":"#image dim\nimg_width, img_height, chnl = 200, 200, 3\n\n# DenseNet121\ndensenet = DenseNet121(include_top=False, weights='imagenet', input_shape=(img_width, img_height, chnl))\ndensenet.trainable = False\n\n# Add Layer Embedding\nmodel = keras.Sequential([\n    densenet,\n    GlobalMaxPooling2D()\n])\n\nmodel.summary()","818f6989":"def img_path(img):\n    return path + 'images\/' + img\ndef model_predict(model, img_name):\n    # Reshape\n    img = image.load_img(img_path(img_name), target_size=(img_width, img_height))\n    # img to Array\n    x   = image.img_to_array(img)\n    # Expand Dim (1, w, h)\n    x   = np.expand_dims(x, axis=0)\n    # Pre process Input\n    x   = preprocess_input(x)\n    return model.predict(x).reshape(-1)","2554303e":"df_copy      = df\ndf_embedding = df_copy['image'].apply(lambda x: model_predict(model, x))\ndf_embedding        = df_embedding.apply(pd.Series)\ndf_embedding.head(5)","40282e0f":"cosine_sim = linear_kernel(df_embedding, df_embedding)","c7d5fcf1":"indices = pd.Series(range(len(df)), index=df.index)","83c10e80":"def get_recommendations(index, df, cosine_sim=cosine_sim):\n    idx = indices[index]\n\n    # Get the pairwsie similarity scores of all clothes with that one\n    sim_scores = list(enumerate(cosine_sim[idx]))\n\n    # Sort the clothes based on the similarity scores\n    sim_scores = sorted(sim_scores, key=lambda x: x[1], reverse=True)\n\n    # Get the scores of the 5 most similar clothes\n    sim_scores = sim_scores[1:6]\n\n    # Get the clothes indices\n    cloth_indices = [i[0] for i in sim_scores]\n\n    # Return the top 10 most similar movies\n    return df['image'].iloc[cloth_indices]","d4d32714":"chosen_img_indx = 755\n\nrecommendation = get_recommendations(chosen_img_indx, df, cosine_sim)\nrecommendation_list = recommendation.to_list()\n#chosen image\nchosen_img =  mpimg.imread(path + 'images\/' + df.iloc[chosen_img_indx].image)\nplt.title(\"Chosen image\")\nplt.imshow(chosen_img)\n#recommended images\nplt.figure(figsize=(20,20))\nj=0\nfor i in recommendation_list:\n    plt.subplot(6, 10, j+1)\n    cloth_img =  mpimg.imread(path + 'images\/'+ i)\n    plt.imshow(cloth_img)\n    plt.axis(\"off\")\n    j+=1\nplt.title(\"recommended images\")\nplt.subplots_adjust(wspace=-0.5, hspace=1)\nplt.show()","6450c50b":"chosen_img_indx = 2500\n\nrecommendation = get_recommendations(chosen_img_indx, df, cosine_sim)\nrecommendation_list = recommendation.to_list()\n#chosen image\nchosen_img =  mpimg.imread(path + 'images\/' + df.iloc[chosen_img_indx].image)\nplt.title(\"Chosen image\")\nplt.imshow(chosen_img)\n#recommended images\nplt.figure(figsize=(20,20))\nj=0\nfor i in recommendation_list:\n    plt.subplot(6, 10, j+1)\n    cloth_img =  mpimg.imread(path + 'images\/'+ i)\n    plt.imshow(cloth_img)\n    plt.axis(\"off\")\n    j+=1\nplt.title(\"recommended images\")\nplt.subplots_adjust(wspace=-0.5, hspace=1)\nplt.show()","60aeebe5":"Function of model prediction","a5bfe5e4":"Bulding Clothes Recommendation System using DenseNet121","dcddb4f7":"Checking the result ","c2bb2050":"Getting indices","bd070c72":"Getting recommendations using the cosine similarity","eac63d5e":"DataFrame with categories and adding column of image names","c9f7b75d":"# Clothes Recommendation System (DenseNet121)","ddfeb1d8":"Building data frame of model prediction for all our images from dataset (getting embedding for all items in dataset)","bb8b7c9c":"Importing libraries","ae31e80f":"Setting the Pre-Trained model DenseNet121","457b563d":"Showing 10 images in dataset","d92f0432":"Computing a cosine similarity to calculate a numeric quantity that denotes the similarity between two images. It is relatively easy and fast to calculate."}}