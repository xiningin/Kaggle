{"cell_type":{"207f2301":"code","b776d234":"code","a720cc42":"code","81f0d49c":"code","58bf95c8":"code","5cf4bd33":"code","f9c8c9e1":"code","e46c853b":"code","482c3663":"code","7d007aa0":"code","24077508":"code","b80b73db":"code","8639c3e2":"code","b1ab2142":"code","196c91a3":"code","947f8d91":"code","8a6d195a":"code","2e3b4844":"code","f101e092":"code","904d5ba9":"code","13487ff0":"code","651f4c04":"code","a532e27b":"code","fa94a119":"code","4593e3bb":"code","0b9ff8c6":"code","ff457b5f":"code","2f69484f":"markdown","852af86a":"markdown","41b667d8":"markdown","2ff6e5fa":"markdown","e19b0b12":"markdown","07b17bd3":"markdown","87715e60":"markdown","76e0f0fa":"markdown","d9a96802":"markdown","7a19207c":"markdown","3b2874dd":"markdown","66d9936a":"markdown","0e4662f8":"markdown","22c3f4cc":"markdown","9df2d376":"markdown","32e7751f":"markdown","d8dfda59":"markdown","b13b7416":"markdown","2b4fe5d4":"markdown","6297c3d2":"markdown","99a56d71":"markdown","40fec5d4":"markdown","98fcbf1e":"markdown","4963f850":"markdown","2354dd90":"markdown","97a4594e":"markdown","9ff23a25":"markdown","baff0d67":"markdown","786ef81c":"markdown","23b76fcf":"markdown","de0d3b72":"markdown","1f30bc23":"markdown","1c941cd6":"markdown","b0b29667":"markdown","8fedd0bd":"markdown","d6d5f637":"markdown"},"source":{"207f2301":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","b776d234":"import matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","a720cc42":"df=pd.read_csv(\"..\/input\/universities\/College_Data\",index_col=0)\ndf.head()","81f0d49c":"df.info()","58bf95c8":"df.describe(include=\"all\")","5cf4bd33":"df.corr()\n#Here we see the correlation between variables.","f9c8c9e1":"plt.figure(figsize=(15,10))\nmask = np.zeros_like(df.corr(), dtype=np.bool)\nmask[np.triu_indices_from(mask)] = True\nsns.heatmap(df.corr(),cmap=\"magma\",annot=True,linewidths=0, linecolor='white',cbar=True,mask=mask)","e46c853b":"plt.figure(figsize=(15,10))\nmask = np.zeros_like(df.corr(), dtype=np.bool)\nmask[np.triu_indices_from(mask)] = True\nsns.heatmap(df[df[\"Private\"]== \"Yes\"].corr(),cmap=\"plasma\",annot=True,linewidths=0, linecolor='white',cbar=True,mask=mask)","482c3663":"plt.figure(figsize=(15,10))\nmask = np.zeros_like(df.corr(), dtype=np.bool)\nmask[np.triu_indices_from(mask)] = True\nsns.heatmap(df[df[\"Private\"]== \"No\"].corr(),cmap=\"inferno\",annot=True,linewidths=0, linecolor='white',cbar=True,mask=mask)","7d007aa0":"plt.figure(figsize=(15,10))\nsns.scatterplot(x=\"Grad.Rate\", y=\"Room.Board\",data=df,hue=\"Private\")","24077508":"sns.lmplot(x=\"Outstate\", y=\"F.Undergrad\",data=df,hue=\"Private\",size=15)","b80b73db":"plt.figure(figsize=(15,10))\ndf[df[\"Private\"] == \"Yes\"][\"Grad.Rate\"].hist(color=\"blue\",bins=50,label=\"Private = Yes\",alpha=0.4)\ndf[df[\"Private\"] == \"No\"][\"Grad.Rate\"].hist(color=\"red\",bins=50,label=\"Private = No\",alpha=0.4)\nplt.legend()","8639c3e2":"g = sns.FacetGrid(df, hue=\"Private\",size=6,aspect=2,palette=\"husl\")\ng = g.map(plt.hist, \"Grad.Rate\",bins=20,alpha=0.6)\nsns.set()\nplt.legend()","b1ab2142":"df[df[\"Grad.Rate\"] > 100]","196c91a3":"df[\"Grad.Rate\"][\"Cazenovia College\"] =100","947f8d91":"g = sns.FacetGrid(df, hue=\"Private\",size=6,aspect=2,palette=\"Set2\")\ng = g.map(plt.hist, \"Grad.Rate\",bins=20,alpha=0.6)\nsns.set()","8a6d195a":"from IPython.display import Image\nurl=\"https:\/\/i.stack.imgur.com\/FQhxk.jpg\"\nImage(url,width=800, height=800)","2e3b4844":"url=\"https:\/\/i.stack.imgur.com\/vc01j.png\"\nImage(url,width=800, height=800)","f101e092":"from sklearn.cluster import KMeans","904d5ba9":"kmeans=KMeans(n_clusters=2)\n#here we reate an instance of a K Means model with 2 clusters.","13487ff0":"kmeans.fit(df.drop(\"Private\",axis=1))\n#we fit the model to all the data except for the Private labelwhich is the target of the data","651f4c04":"kmeans.cluster_centers_\n# Here are the cluster center vectors","a532e27b":"kmeans.labels_\n#Here the algorithm separate the variable into two groups without knowing they are private or state universities.","fa94a119":"def converter(private):\n    if private == \"Yes\":\n        return 1\n    else:\n        return 0","4593e3bb":"df[\"Cluster\"]=df[\"Private\"].apply(converter)\n# here we apply our function and create a new column with numerical values as 0's and 1's.","0b9ff8c6":"df.head()\n#Now our target variable is ready for comparison ","ff457b5f":"from sklearn.metrics import confusion_matrix, classification_report\nprint(confusion_matrix(df[\"Cluster\"],kmeans.labels_))\nprint(4*\"\\n\")\nprint(classification_report(df[\"Cluster\"],kmeans.labels_))","2f69484f":"* The overall goal is to divide data into distinct groups such that observations within each group are similar","852af86a":"*This algorithm allows us to cluster and label data as an unsupervised machine learning algorithm","41b667d8":"* In the plot above there seems to be a private school with a graduation rate of higher than 100%. Now we will find it","2ff6e5fa":"* Below we will compare private and state universities in terms of graduation rate by using faced grid","e19b0b12":"* We have the same plot with the reassigned graduation rate. Now the highest graduation rate is now higher than %100.","07b17bd3":"The data contains 18 variables which are explained as follows:\n* Private: A factor with levels No and Yes indicating private or public university\n* Apps: Number of applications received\n* Accept: Number of applications accepted\n* Enroll: Number of new students enrolled\n* Top10perc: Pct. new students from top 10% of H.S. class\n* Top25perc: Pct. new students from top 25% of H.S. class\n* F.Undergrad: Number of fulltime undergraduates\n* P.Undergrad: Number of parttime undergraduates\n* Outstate: Out-of-state tuition\n* Room.Board: Room and board costs\n* Books: Estimated book costs\n* Personal: Estimated personal spending\n* PhD: Pct. of faculty with Ph.D.\u2019s\n* Terminal: Pct. of faculty with terminal degree\n* S.F.Ratio: Student\/faculty ratio\n* perc.alumni Pct. alumni who donate\n* Expend Instructional expenditure per student\n* Grad.Rate Graduation rate","87715e60":"## 3. General Information About K Means Clustering Algorithm:","76e0f0fa":"* In the heatmap above we only see the correlations of variables for state universities","d9a96802":"* The algorithm\n\n        -Choose a number of Clusters K\n        -Randomly assign each point to a specific cluster\n        -Until clusters stop changing, repeat the following steps:\n        -For each cluster, compute the cluster's centroid by taking the mean vector points in the cluster\n        -Assign each data point to the cluster for which the centroid is the closest","7a19207c":"# 2. Explanatory Data Analysis:","3b2874dd":"* The data contain 777 rows and 18 columns or variables","66d9936a":"In the plot above, we see the number of cluster on the x-axis and within group sum of squares.\n\nWe try to choose a K Value where we won't get much information by increasing the number of classes, which means that we will not significantly within groups sum of squares by increase the number of clusters.\n\nThe number 2 or 3 is the most ideal in this plot because it is the first point the elbow shape happens and avoid to increase the number clusters more.","0e4662f8":"*We apply this algorithm for unlabeled data and it attempts to group similar clusters in unlabeled data.","22c3f4cc":"* Types of clustering problems that we can apply this algorithm is:\n\n    -Clustering Similar Documents\n    -Cluster Customers based on their Features\n    -Market Segmentation\n    -Identify Similar Physical Groups","9df2d376":"* Now below, we will create a stacked histogram showing Out of State Tuition based on whether it is a private university or state university","32e7751f":"## 4. How does the algorithm work:","d8dfda59":"* As seen in the plot above, private universities have higher graduation rates than the state universities.","b13b7416":"* Out of tuition for both private and state universities are normally distributed, but it is higher in the private universities than state universities.","2b4fe5d4":"## 5. Implementing K Means Clustering and Evaluation the Performance of the Algorithm:","6297c3d2":"The first observation about data is shown in top-left of the figure above.\n\nIn the step 1 in the algorithm, each observation is randomly assigned to a cluster.\n\nIn the step 2a in the algorithm,the cluster centroid for each cluster is computed, which are shown as large colored disk as shown top-right of the figure.\n\nInitially these centroids are almost overlapping as we can see from the figure because initial cluster assignments are chosen randomly.\n\nIn the step 2a in the algorithm(bottom-left of the figure above), each observation is assigned to the neares centroid.\n\nIn bottom-center of the figure above, step 2a once again is performed which lead to new cluster centroids.\n\nWe basically keep repeating these steps until there is no new cluster which means data points are being reassigned to a new cluster centroid.\n\nAt the bottom-right, we have the results obtained after about 10 iterations","99a56d71":"* Above we can see the overall statistical information about the variables","40fec5d4":"To perform K Mean Clustering, we have to decide how many clusters we expect in the data.\n\nThere is no easy answer for choosing a best K Value, but we can use elbow method to achieve a good K Value for the algorithm.\n\nThe basic idea behind this method is that it plots the various values of cost with changing k. As the value of K increases, there will be fewer elements in the cluster. So average distortion will decrease. The lesser number of elements means closer to the centroid. So, the point where this distortion declines the most is the elbow point.\n\nFirst of all, we compute the sum of squared errors(SSE) for some values of K(example, 2,3,4,6,etc).The SSE is the sum of squared distance between each member of the cluster and its centroid.\n\nIf we plot K value against the SSE,the error decreases as the K Value increases because if the number of cluster increases, they should be smaller. Accordingly the distortion becomes also smaller.\n\nFrom this perspective, the idea of using elbow method is to choose K Value at which SSE decreases abruptly, and this produces an elbow effect as we can see in the following picture.","98fcbf1e":"* Before comparing them we need to create a new column for df called 'Cluster', which is a 1 for a Private school, and a 0 for a public school. We have to tranform the categorical values into numeric ones.","4963f850":"* As seen in plot above, the number of fulltime undergraduates with Out-of-state tuition are much more higher in state universities(r=0.35 versus 0.19)","2354dd90":"# 1. General Information About the Data","97a4594e":"* Now we will evalute the performance of the algorithm, in normal situation we will not have the chance to evaluate the performance because we will not have the labels beforehand in many cases. But in this tutorial we have the labels and thus can compare the results with the actual labels.","9ff23a25":"* We will reassign a new graduation rate for this college.","baff0d67":"* Below we will create a scatterplot of F.Undergrad( Number of fulltime undergraduates) versus Outstate(Out-of-state tuition) where the points are colored by the Private column.","786ef81c":"* Here is the visualization how the algorithm works:","23b76fcf":"*Below in the heatmap, we will visualize all of the correlations with r of the data","de0d3b72":"* In the heatmap above we only see the correlations of variables for private universities","1f30bc23":"*Below we will separate the correlation of variables according the university is a private or state university","1c941cd6":"* Now we will evaluate and visualize variable for private and state universities in the same plots in order to get better insights and compare them\n*First we will create a scatterplot of Grad.Rate(Graduation rate) versus Room.Board(Room and Board Costs) where the points are colored by the Private column","b0b29667":"*There is a correlation between graduation rate and room costs, but not strong(0.424942) as seen in the table below.\n\n* In private universities, there is higher correlation than the state universities(0.39 versus 0.22 as seen in the heatmaps)","8fedd0bd":"* How to choose a K Value for the Algorithm:","d6d5f637":"* Not so bad considering the algorithm is purely using the features to cluster the universities into 2 distinct groups"}}