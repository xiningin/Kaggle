{"cell_type":{"29b6af7f":"code","05bf67ae":"code","4a6178ed":"code","8e299c8a":"code","ca5fc0c2":"code","00aab31c":"code","9c538ae1":"code","b2d6c9ee":"code","6824ec7c":"code","e0479d96":"code","cdec6429":"code","103e89fc":"code","e300d5ef":"code","3e390af3":"code","a145afa9":"code","6f246c80":"code","792a09cf":"code","989097f7":"code","601089b0":"code","c788ebdc":"code","64ca9036":"code","a15ca485":"code","cd0f8403":"code","f9df996c":"code","3cdfb364":"code","31832679":"code","9b765280":"code","bc698a6b":"code","71b45ef6":"code","2980dfb8":"code","186a6eeb":"code","3fa9fe3e":"code","a4d1d4d2":"markdown","06360cd2":"markdown","c93c786d":"markdown","97a2a5fd":"markdown","f7d6b53a":"markdown","f2f298b4":"markdown","d11fca12":"markdown"},"source":{"29b6af7f":"import pandas as pd \nimport numpy as np \nimport matplotlib.pyplot as plt\nimport seaborn as sns","05bf67ae":"df = pd.read_csv(\"..\/input\/breast-cancer-wisconsin-data\/data.csv\")","4a6178ed":"df.head()","8e299c8a":"df.info()","ca5fc0c2":"df.drop([\"id\",\"Unnamed: 32\"],axis =1, inplace = True)","00aab31c":"df[\"diagnosis\"] =df[\"diagnosis\"].map({\"M\":1,\"B\":0}).astype(int)","9c538ae1":"sns.countplot(df[\"diagnosis\"])","b2d6c9ee":"from sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import MinMaxScaler","6824ec7c":"X = df.drop(\"diagnosis\", axis =1)\ny= df[\"diagnosis\"]","e0479d96":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)","cdec6429":"scaler = MinMaxScaler()","103e89fc":"X_train = scaler.fit_transform(X_train)\nX_test = scaler.transform(X_test)","e300d5ef":"from tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dropout, Dense","3e390af3":"pd.DataFrame(X_train).head()","a145afa9":"model = Sequential()\nmodel.add( Dense(30,activation = \"relu\"))\nmodel.add( Dense(15,activation = \"relu\"))\nmodel.add( Dense(1,activation = \"sigmoid\"))","6f246c80":"model.compile(optimizer=\"adam\", loss=\"binary_crossentropy\",metrics=['accuracy'])","792a09cf":"model.fit(X_train,y_train,epochs=600, validation_data=(X_test,y_test))","989097f7":"losses = pd.DataFrame(model.history.history)","601089b0":"losses.plot(xlabel = \"epochs\", ylabel = \"loss\", title= \"Overfitted model\")","c788ebdc":"model.evaluate(X_test,y_test)","64ca9036":"from tensorflow.keras.callbacks import EarlyStopping\n","a15ca485":"## create new model \nmodel = Sequential()\nmodel.add( Dense(30,activation = \"relu\"))\nmodel.add( Dense(15,activation = \"relu\"))\nmodel.add( Dense(1,activation = \"sigmoid\"))\n\nmodel.compile(optimizer=\"adam\", loss=\"binary_crossentropy\",metrics=['accuracy'])","cd0f8403":"stopping = EarlyStopping(monitor=\"val_loss\", mode= \"min\", patience=25)","f9df996c":"model.fit(X_train,y_train,validation_data=(X_test,y_test), epochs = 600, callbacks=stopping)","3cdfb364":"pd.DataFrame(model.history.history).plot(xlabel = \"epochs\", ylabel = \"loss\",title= \"Early Stopping\")","31832679":"model.evaluate(X_test,y_test)","9b765280":"from tensorflow.keras.layers import Dropout","bc698a6b":"## create new model \nmodel = Sequential()\nmodel.add( Dense(30,activation = \"relu\"))\nmodel.add(Dropout(0.5))\n\nmodel.add( Dense(15,activation = \"relu\"))\nmodel.add(Dropout(0.5))\n\nmodel.add( Dense(1,activation = \"sigmoid\"))\n\nmodel.compile(optimizer=\"adam\", loss=\"binary_crossentropy\",metrics=['accuracy'])","71b45ef6":"stopping = EarlyStopping(monitor=\"val_loss\",patience = 25, mode = \"min\")","2980dfb8":"model.fit(X_train,y_train,epochs = 600, callbacks=stopping, validation_data=(X_test,y_test))","186a6eeb":"pd.DataFrame(model.history.history).plot(xlabel = \"epochs\", ylabel = \"loss\/accuracy\", title = \"Dropout\")","3fa9fe3e":"model.evaluate(X_test,y_test)","a4d1d4d2":"### add layers and compile ","06360cd2":"![square_peg_in_round_hole_2.jpg](attachment:221298ac-c094-4e84-9c97-a30bde2d4b47.jpg)","c93c786d":"# Prediction - benign or malignant","97a2a5fd":"# Scaling ","f7d6b53a":"# Combating Overfitting in Deep Learning models using Early Stopping and Dropout layers\nThis kernel is used as an example for the article [How to stop Overfitting your ML and Deep Learning models](https:\/\/medium.com\/@andrew.schleiss\/how-to-stop-overfitting-your-ml-and-deep-learning-models-bb8324ace80b)","f2f298b4":"# Dropout with Early stopping","d11fca12":"# Early stopping "}}