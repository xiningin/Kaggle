{"cell_type":{"a4fe1275":"code","5617c134":"code","d5cfb39a":"code","e0f638ea":"code","e52f33b6":"code","b5eb87c5":"code","10a06490":"code","20776f5d":"code","3945f825":"code","96e57f80":"code","c42610b3":"code","200697e1":"code","32348acf":"code","24eb7d8a":"code","d4a6c91f":"code","3dac7b7d":"code","1245657d":"code","8eebba2d":"code","d4f3047e":"code","843ac365":"code","da950a04":"code","bace3171":"code","466ce09f":"code","e59b5700":"code","f81d3074":"code","c83ccf91":"code","c795e208":"code","f7494a8c":"code","16e1cce4":"code","7107da3a":"code","ce2fba9c":"code","1f21c0e1":"code","9e5298de":"code","bb79d107":"code","14ae1934":"code","3ab1b72a":"code","d08081fd":"code","2091f922":"code","95d15771":"code","eacccc6d":"code","2286049e":"code","9e82e49b":"code","fda0a49a":"code","51f10196":"code","99073489":"code","82af6fa4":"code","12efb119":"code","04631fa4":"code","a283d150":"code","ed195e58":"code","42756448":"code","79d490c3":"code","fc285e4d":"code","14ad88e3":"code","d380b73f":"code","28412e74":"code","faef987f":"code","d0a3ac97":"code","30103c1a":"code","bbbc6efe":"code","9211b730":"code","2ef0ece5":"code","4656b689":"code","437e287a":"code","919e2808":"code","70979095":"code","c4e63f52":"code","9dbdcd63":"code","e598d9e5":"code","2e2afed1":"code","5ea7672a":"code","eb09c314":"code","97c6ddb6":"code","b8ae6cd5":"code","0efdcda3":"code","5362f0ae":"code","7b3545c2":"code","7b6053e8":"code","ecba813e":"code","127988c6":"code","78f93b13":"code","c05e3307":"code","e1a6828b":"code","61156320":"markdown","11322c5a":"markdown","c3264ffc":"markdown","cf6d2f87":"markdown","1fe89845":"markdown","919779dc":"markdown","73e336c2":"markdown","18b9f16d":"markdown","7393aa83":"markdown","8853cb71":"markdown","025055dc":"markdown","0418fce4":"markdown","d38e8ac1":"markdown","e71e0e28":"markdown","8e2bea26":"markdown","8cf600bf":"markdown","b1f345fe":"markdown","d8080623":"markdown","1e50c6bf":"markdown","4bcee7b1":"markdown","ef163174":"markdown","67b9f67d":"markdown","61240456":"markdown","a3886c6a":"markdown","5d7467b3":"markdown","0d0e17f9":"markdown","573a2c4e":"markdown","f7d4040f":"markdown","8bb5129a":"markdown","33312862":"markdown","4d057e9b":"markdown"},"source":{"a4fe1275":"# Supress Warnings\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# Import the numpy and pandas package\n\nimport numpy as np\nimport pandas as pd\n\n# Data Visualisation\n\nimport matplotlib.pyplot as plt \nimport seaborn as sns","5617c134":"#Importing dataset\nmedia = pd.DataFrame(pd.read_csv(\"..\/input\/mediacompany.csv\"))\nmedia.head()","d5cfb39a":"# Checking Duplicates\nsum(media.duplicated(subset = 'Date')) == 0\n# No duplicate values","e0f638ea":"# Dropping the unwanted column\nmedia = media.drop('Unnamed: 7',axis = 1)","e52f33b6":"#Let's explore the top 5 rows\nmedia.head()","b5eb87c5":"media.shape","10a06490":"media.info()","20776f5d":"media.describe()","3945f825":"# Checking Null values\nmedia.isnull().sum()*100\/media.shape[0]\n# There are no NULL values in the dataset, hence it is clean.","96e57f80":"# Outlier Analysis\nfig, axs = plt.subplots(2,2, figsize = (10,5))\nplt1 = sns.boxplot(media['Views_show'], ax = axs[0,0])\nplt2 = sns.boxplot(media['Visitors'], ax = axs[0,1])\nplt3 = sns.boxplot(media['Views_platform'], ax = axs[1,0])\nplt4 = sns.boxplot(media['Ad_impression'], ax = axs[1,1])\n\nplt.tight_layout()","c42610b3":"# Data preparation","200697e1":"# Converting date to Pandas datetime format\nmedia['Date'] = pd.to_datetime(media['Date'], dayfirst = False )\n# Date is in the format YYYY-MM-DD","32348acf":"media.head()","24eb7d8a":"# Let's derive day of week column from date ","d4a6c91f":"media['Day_of_week'] = media['Date'].dt.dayofweek","3dac7b7d":"media.head()","1245657d":"# Target Variable\n# Views Show","8eebba2d":"sns.boxplot(media['Views_show'])","d4f3047e":"# days vs Views_show\nmedia.plot.line(x='Date', y='Views_show')","843ac365":"# Inference\n# we can observe a pattern in the plot.","da950a04":"sns.barplot(data = media,x='Day_of_week', y='Views_show')","bace3171":"# Inference\n# we can see that Views are more on 'Sunday' and 'Saturday'(weekends) and decline on subsequent days.","466ce09f":"# Hence we can think of another matrix \"Weekend\" that is 1 for weekends and 0 for weekdays.","e59b5700":"di = {5:1, 6:1, 0:0, 1:0, 2:0, 3:0, 4:0}\nmedia['weekend'] = media['Day_of_week'].map(di)","f81d3074":"media.head()","c83ccf91":"sns.barplot(data = media,x='weekend', y='Views_show')","c795e208":"# viewership is higher on weekends.","f7494a8c":"# plot for Date vs Views_show and days vs Ad_impressions\nax = media.plot(x=\"Date\", y=\"Views_show\", legend=False)\nax2 = ax.twinx()\nmedia.plot(x=\"Date\", y=\"Ad_impression\", ax=ax2, legend=False, color=\"r\")\nax.figure.legend()\n","16e1cce4":"sns.scatterplot(data = media, x = 'Ad_impression', y = 'Views_show')","7107da3a":"# we can see that the views as well as ad impressions show a weekly pattern.","ce2fba9c":"sns.scatterplot(data = media, x = 'Visitors', y = 'Views_show')","1f21c0e1":"# Inference: Show views are some what proportionately related to Visitors","9e5298de":"sns.scatterplot(data = media, x = 'Views_platform', y = 'Views_show')","bb79d107":"# Inference: Show views are some what proportionately related to Platform views","14ae1934":"sns.barplot(data = media,x='Cricket_match_india', y='Views_show')","3ab1b72a":"# Inference: Show views slightly declines when there is a cricket match.","d08081fd":"sns.barplot(data = media,x='Character_A', y='Views_show')","2091f922":"# Inference: Presence of Character A improves the show viewership.","95d15771":"from sklearn.preprocessing import MinMaxScaler","eacccc6d":"scaler = MinMaxScaler()","2286049e":"# Apply scaler() to all the columns except the 'yes-no' and 'dummy' variables\nnum_vars = ['Views_show','Visitors','Views_platform','Ad_impression']\n\nmedia[num_vars] = scaler.fit_transform(media[num_vars])","9e82e49b":"media.head()","fda0a49a":"# Let's check the correlation coefficients to see which variables are highly correlated","51f10196":"sns.heatmap(media.corr(),annot = True)","99073489":"# Putting feature variable to X\nX = media[['Visitors','weekend']]\n\n# Putting response variable to y\ny = media['Views_show']","82af6fa4":"from sklearn.linear_model import LinearRegression","12efb119":"# Representing LinearRegression as lm(Creating LinearRegression Object)\nlm = LinearRegression()","04631fa4":"# fit the model to the training data\nlm.fit(X,y)","a283d150":"import statsmodels.api as sm\n#Unlike SKLearn, statsmodels don't automatically fit a constant, \n#so you need to use the method sm.add_constant(X) in order to add a constant. \nX = sm.add_constant(X)\n# create a fitted model in one line\nlm_1 = sm.OLS(y,X).fit()\nprint(lm_1.summary())","ed195e58":"# Inference:\n# Visitors as well as weekend column are significant.","42756448":"# Putting feature variable to X\nX = media[['Visitors','weekend','Character_A']]\n\n# Putting response variable to y\ny = media['Views_show']","79d490c3":"import statsmodels.api as sm\n#Unlike SKLearn, statsmodels don't automatically fit a constant, \n#so you need to use the method sm.add_constant(X) in order to add a constant. \nX = sm.add_constant(X)\n# create a fitted model in one line\nlm_2 = sm.OLS(y,X).fit()\nprint(lm_2.summary())","fc285e4d":"# we have seen that views of today effects views of tomorrow. So to take that in account we will create a Lag variable.","14ad88e3":"# Create lag variable\nmedia['Lag_Views'] = np.roll(media['Views_show'], 1)\nmedia.head()","d380b73f":"media.Lag_Views[0] = 0","28412e74":"media.head()","faef987f":"# Putting feature variable to X\nX = media[['Visitors','Character_A','Lag_Views','weekend']]\n\n# Putting response variable to y\ny = media['Views_show']","d0a3ac97":"import statsmodels.api as sm\n#Unlike SKLearn, statsmodels don't automatically fit a constant, \n#so you need to use the method sm.add_constant(X) in order to add a constant. \nX = sm.add_constant(X)\n# create a fitted model in one line\nlm_3 = sm.OLS(y,X).fit()\nprint(lm_3.summary())","30103c1a":"# Inference:\n# It leaves visitor insignificant.","bbbc6efe":"# Putting feature variable to X\nX = media[['weekend','Character_A','Views_platform']]\n\n# Putting response variable to y\ny = media['Views_show']","9211b730":"import statsmodels.api as sm\n#Unlike SKLearn, statsmodels don't automatically fit a constant, \n#so you need to use the method sm.add_constant(X) in order to add a constant. \nX = sm.add_constant(X)\n# create a fitted model in one line\nlm_4 = sm.OLS(y,X).fit()\nprint(lm_4.summary())","2ef0ece5":"# Putting feature variable to X\nX = media[['weekend','Character_A','Visitors']]\n\n# Putting response variable to y\ny = media['Views_show']","4656b689":"import statsmodels.api as sm\n#Unlike SKLearn, statsmodels don't automatically fit a constant, \n#so you need to use the method sm.add_constant(X) in order to add a constant. \nX = sm.add_constant(X)\n# create a fitted model in one line\nlm_5 = sm.OLS(y,X).fit()\nprint(lm_5.summary())","437e287a":"# Putting feature variable to X\nX = media[['weekend','Character_A','Visitors','Ad_impression']]\n\n# Putting response variable to y\ny = media['Views_show']","919e2808":"import statsmodels.api as sm\n#Unlike SKLearn, statsmodels don't automatically fit a constant, \n#so you need to use the method sm.add_constant(X) in order to add a constant. \nX = sm.add_constant(X)\n# create a fitted model in one line\nlm_6 = sm.OLS(y,X).fit()\nprint(lm_6.summary())","70979095":"# Inference\n# we can observe a pattern in the plot.","c4e63f52":"# Putting feature variable to X\nX = media[['weekend','Character_A','Ad_impression']]\n\n# Putting response variable to y\ny = media['Views_show']","9dbdcd63":"import statsmodels.api as sm\n#Unlike SKLearn, statsmodels don't automatically fit a constant, \n#so you need to use the method sm.add_constant(X) in order to add a constant. \nX = sm.add_constant(X)\n# create a fitted model in one line\nlm_7 = sm.OLS(y,X).fit()\nprint(lm_7.summary())","e598d9e5":"#Ad impression in million\nmedia['ad_impression_million'] = media['Ad_impression']\/1000000","2e2afed1":"# Putting feature variable to X\nX = media[['weekend','Character_A','ad_impression_million','Cricket_match_india']]\n\n# Putting response variable to y\ny = media['Views_show']","5ea7672a":"import statsmodels.api as sm\n#Unlike SKLearn, statsmodels don't automatically fit a constant, \n#so you need to use the method sm.add_constant(X) in order to add a constant. \nX = sm.add_constant(X)\n# create a fitted model in one line\nlm_8 = sm.OLS(y,X).fit()\nprint(lm_8.summary())","eb09c314":"# Putting feature variable to X\nX = media[['weekend','Character_A','ad_impression_million']]\n\n# Putting response variable to y\ny = media['Views_show']","97c6ddb6":"import statsmodels.api as sm\n#Unlike SKLearn, statsmodels don't automatically fit a constant, \n#so you need to use the method sm.add_constant(X) in order to add a constant. \nX = sm.add_constant(X)\n# create a fitted model in one line\nlm_9 = sm.OLS(y,X).fit()\nprint(lm_9.summary())","b8ae6cd5":"# Making predictions using the model\nX = media[['weekend','Character_A','ad_impression_million']]\nX = sm.add_constant(X)\nPredicted_views = lm_9.predict(X)","0efdcda3":"from sklearn.metrics import mean_squared_error, r2_score\nmse = mean_squared_error(media.Views_show, Predicted_views)\nr_squared = r2_score(media.Views_show, Predicted_views)","5362f0ae":"print('Mean_Squared_Error :' ,mse)\nprint('r_square_value :',r_squared)","7b3545c2":"#Actual vs Predicted\nc = [i for i in range(1,81,1)]\nfig = plt.figure()\nplt.plot(c,media.Views_show, color=\"blue\", linewidth=2.5, linestyle=\"-\")\nplt.plot(c,Predicted_views, color=\"red\",  linewidth=2.5, linestyle=\"-\")\nfig.suptitle('Actual and Predicted', fontsize=20)              # Plot heading \nplt.xlabel('Index', fontsize=18)                               # X-label\nplt.ylabel('Views', fontsize=16)                               # Y-label","7b6053e8":"# Error terms\nc = [i for i in range(1,81,1)]\nfig = plt.figure()\nplt.plot(c,media.Views_show-Predicted_views, color=\"blue\", linewidth=2.5, linestyle=\"-\")\nfig.suptitle('Error Terms', fontsize=20)              # Plot heading \nplt.xlabel('Index', fontsize=18)                      # X-label\nplt.ylabel('Views_show-Predicted_views', fontsize=16)                # Y-label","ecba813e":"# Making predictions using the model\nX = media[['weekend','Character_A','Visitors']]\nX = sm.add_constant(X)\nPredicted_views = lm_5.predict(X)","127988c6":"from sklearn.metrics import mean_squared_error, r2_score\nmse = mean_squared_error(media.Views_show, Predicted_views)\nr_squared = r2_score(media.Views_show, Predicted_views)","78f93b13":"print('Mean_Squared_Error :' ,mse)\nprint('r_square_value :',r_squared)","c05e3307":"#Actual vs Predicted\nc = [i for i in range(1,81,1)]\nfig = plt.figure()\nplt.plot(c,media.Views_show, color=\"blue\", linewidth=2.5, linestyle=\"-\")\nplt.plot(c,Predicted_views, color=\"red\",  linewidth=2.5, linestyle=\"-\")\nfig.suptitle('Actual and Predicted', fontsize=20)              # Plot heading \nplt.xlabel('Index', fontsize=18)                               # X-label\nplt.ylabel('Views', fontsize=16)                               # Y-label","e1a6828b":"# Error terms\nc = [i for i in range(1,81,1)]\nfig = plt.figure()\nplt.plot(c,media.Views_show-Predicted_views, color=\"blue\", linewidth=2.5, linestyle=\"-\")\nfig.suptitle('Error Terms', fontsize=20)              # Plot heading \nplt.xlabel('Index', fontsize=18)                      # X-label\nplt.ylabel('Views_show-Predicted_views', fontsize=16)                # Y-label","61156320":"## Data Inspection","11322c5a":"## Model building","c3264ffc":"## Multiple Linear Regression","cf6d2f87":"#### Running first model (lm1) Visitors, weekend","1fe89845":"#### Visitors","919779dc":"#### Running fifth model (lm5) Character_A, weekend & Visitors","73e336c2":"### Problem Statement:\nA digital media company (similar to Voot, Hotstar, Netflix, etc.) had launched a show. Initially, the show got a good response, but then witnessed a decline in viewership. The company wants to figure out what went wrong.\n\n\n### Approach:\nWe are concerned about determining the driver variable for show viewership. This is the case of pridiction rather than projection where we are more interested in predicting the key driver variables and their impact rather than forcasting the results.\n\nFirst we will list down the potential reasons for the decline in viewershp.<br>\n\nThe potential reasons could be:\n1. Decline in the number of people coming to the platform\n2. Fewer people watching the video\n3. A Decrease in marketing spend?\n4. Competitive shows, e.g. cricket\/ IPL\n5. Special holidays\n6. Twist in the story\n\n\n### Data\nWe have been given data for the period of 1 March 2017 to 19 May 2017.<br>\nWith Columns as<br> \nViews_show         : Number of times the show was viewed<br>\nVisitors           : Number of visitors who browsed the platform, but not necessarily watched a video.<br>\nViews_platform\t   : Number of times a video was viewed on the platform<br>\nAd_impression\t   : Proxy for marketing budget. Represents number of impressions generated by ads<br>\nCricket_match_india: If a cricket match was being played. 1 indicates match on a given day, 0 indicates there wasn't<br>\nCharacter_A        : Describes presence of Character A. 1 indicates character A was in the episode, 0 indicates she\/he wasn't","18b9f16d":"#### Views Platform","7393aa83":"#### Ad Impressions","8853cb71":"#### Deriving Matrices","025055dc":"## Reading and Understanding the Data","0418fce4":"#### Running sixth model (lm6) Character_A, weekend, Visitors & Ad_impressions","d38e8ac1":"#### Date","e71e0e28":" Ad Impressions and Character A as the driver variables that could explain the\nviewership pattern. Based on industry experience, ad impressions are directly proportional to the\nmarketing budget. Thus, by increasing the marketing budget, a better viewership could be\nachieved. Similarly, Character A\u2019s absence and presence created a significant change in show viewership.\nCharacter A\u2019s presence brings viewers to the show. Thus, these two variables could be acted upon to\nimprove show viewership.","8e2bea26":"#### Running second model (lm2) visitors, weekend & Character_A","8cf600bf":"### Univariate analysis","b1f345fe":"#### Making predictions using lm5","d8080623":"#### Rescaling the Features","1e50c6bf":"#### Making predictions using lm 9 ","4bcee7b1":"#### Running fourth model (lm4) Character_A, weekend & Views_platform","ef163174":"#### Character A","67b9f67d":"#### Running third model (lm3) visitors, Character_A, Lag_views & weekend","61240456":"#### Day of week","a3886c6a":"# Media Company Case Study","5d7467b3":"#### Running seventh model (lm8) Character_A, weekend, Visitors, ad_impressions_million & Cricket_match_india","0d0e17f9":"#### Running seventh model (lm7) Character_A, weekend & Ad_impressions","573a2c4e":"## Data Cleaning","f7d4040f":"#### Running seventh model (lm9) Character_A, weekend & ad_impressions_million","8bb5129a":"## Exploratory Data Analysis","33312862":"#### Cricket Match","4d057e9b":"#### Weekend"}}