{"cell_type":{"b2390b8c":"code","10becda8":"code","0471d878":"code","ce9b8d96":"code","240b6258":"code","41fc3db6":"code","7c7ca40d":"code","947a1be5":"code","cfe168ab":"code","c826d427":"code","a3a3da17":"code","6ce03784":"code","3dc738f1":"code","472bc5e7":"code","189aa77b":"code","853ec9e2":"code","5c700d6f":"code","3fafb578":"code","dfb167cd":"code","71d808a2":"code","14b9bdaf":"code","ade6d40f":"code","f49af7d3":"code","2d76ca37":"code","d55b5824":"code","6aff1a6b":"code","476593cc":"code","370724ce":"code","d6592c99":"code","95b03606":"code","4e11432d":"code","97351fe8":"code","0f7a05ab":"code","d6a3a9b8":"code","e6353111":"code","f6ad32e8":"code","21b2e231":"code","bc0a737c":"markdown","861ddfc3":"markdown","3a73dfe2":"markdown","6f533349":"markdown","643c941b":"markdown","0605b008":"markdown","de62d34d":"markdown","d81398a0":"markdown","839dc62e":"markdown","2ce55216":"markdown","3e9aa22f":"markdown","28cd1523":"markdown","a5c00994":"markdown","786052bb":"markdown","68304745":"markdown","f5af5166":"markdown","480d8831":"markdown","85ce09c3":"markdown","70675052":"markdown","d7451079":"markdown","61fdc1ce":"markdown","f447dd97":"markdown","25800773":"markdown","6365bf54":"markdown","c2a4c9cf":"markdown","2c370735":"markdown","953f5320":"markdown","59bd7172":"markdown","2a4f2b34":"markdown","0bdd11fc":"markdown","cd1f7498":"markdown"},"source":{"b2390b8c":"# Import Libreries\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","10becda8":"data = pd.read_csv('..\/input\/StudentsPerformance.csv')","0471d878":"data.head()","ce9b8d96":"# Some statistics about the data","240b6258":"data.describe()","41fc3db6":"data.info()","7c7ca40d":"data['gender'].value_counts()","947a1be5":"sns.catplot(x='gender',kind='count',data=data,height=4.5,palette='viridis')\nplt.title('Gender')","cfe168ab":"data['gender'].replace({'male':'0','female':'1'},inplace=True)","c826d427":"data['race\/ethnicity'].value_counts()","a3a3da17":"data[\"race\/ethnicity\"].sort_values()\nsns.catplot(x='race\/ethnicity',kind='count',data=data,height=4.5,palette='viridis',\n            order=['group A','group B','group C','group D','group E'])","6ce03784":"data['race\/ethnicity'].replace({'group A':'1','group B':'2', 'group C':'3',\n                               'group D':'4','group E':'5'},inplace=True)","3dc738f1":"data['lunch'].value_counts()","472bc5e7":"sns.catplot(x='lunch',kind='count',data=data,height=4.5,palette='viridis')","189aa77b":"data['lunch'].replace({'free\/reduced':'0','standard':'1'},inplace=True)","853ec9e2":"data['test preparation course'].value_counts()","5c700d6f":"sns.catplot(x='test preparation course',kind='count',data=data,height=4.5,palette='viridis')","3fafb578":"data['test preparation course'].replace({'none':'0','completed':'1'},inplace=True)","dfb167cd":"data['parental level of education'].value_counts()","71d808a2":"data[\"race\/ethnicity\"].sort_values()\nsns.catplot(x='parental level of education',kind='count',data=data,height=4.5,aspect=2,palette='viridis',\n            order=[\"some high school\",\"high school\",\"associate's degree\",\"some college\",\n                   \"bachelor's degree\",\"master's degree\"],)","14b9bdaf":"data['parental level of education'].replace({'some high school':'1','high school':'1',\"associate's degree\":'2',\n                                        'some college':'3',\"bachelor's degree\":'4',\"master's degree\":'5'},inplace=True)","ade6d40f":"data.head()","f49af7d3":"# Now we will look a little deeper on some interesting plots of our data, in order to get some insights","2d76ca37":"sns.set(rc={'figure.figsize':(20,6)})\nsns.countplot(x='writing score', hue='test preparation course',data=data, palette='viridis')\nplt.title('Writing Score by Test Preparation Course')","d55b5824":"plt.figure(figsize=(10, 6))\nsns.scatterplot(x='math score',y='reading score', hue='gender',data=data, palette='viridis')\nplt.title('Math score VS Readind Score by Gender')","6aff1a6b":"# Take a look at our objectives distribution\nplt.figure(figsize=(8, 4))\nplt.hist(x='writing score',bins=10,data=data)","476593cc":"sns.set(rc={'figure.figsize':(20,6)})\nsns.countplot(x='writing score', hue='lunch',data=data, palette='viridis')","370724ce":"X = data[['gender','race\/ethnicity','parental level of education','lunch','test preparation course','math score','reading score']]","d6592c99":"y = data['writing score']","95b03606":"# Split the data to train and test\nfrom sklearn import model_selection\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3)","4e11432d":"# implementation of Linear Regression model using scikit-learn and K-fold for stable model\nfrom sklearn.linear_model import LinearRegression\nkfold = model_selection.KFold(n_splits=10)\nlr = LinearRegression()\nscoring = 'r2'\nresults = model_selection.cross_val_score(lr, X, y, cv=kfold, scoring=scoring)\nlr.fit(X_train,y_train)\nlr_predictions = lr.predict(X_test)\nprint('Coefficients: \\n', lr.coef_)","97351fe8":"from sklearn import metrics\n\nprint('MAE:', metrics.mean_absolute_error(y_test, lr_predictions))\nprint('MSE:', metrics.mean_squared_error(y_test, lr_predictions))\nprint('RMSE:', np.sqrt(metrics.mean_squared_error(y_test, lr_predictions)))","0f7a05ab":"from sklearn.metrics import r2_score\nprint(\"R_square score: \", r2_score(y_test,lr_predictions))","d6a3a9b8":"from sklearn.tree import DecisionTreeRegressor\ndtr = DecisionTreeRegressor(random_state = 42)\ndtr.fit(X_train,y_train)\ndtr_predictions = dtr.predict(X_test) \n\n# R^2 Score\nprint(\"R_square score: \", r2_score(y_test,dtr_predictions))","e6353111":"from sklearn.ensemble import RandomForestRegressor\nrfr = RandomForestRegressor(n_estimators = 100)\nrfr.fit(X_train,y_train)\nrfr_predicitions = rfr.predict(X_test) \n\n# R^2 Score\nprint(\"R_square score: \", r2_score(y_test,rfr_predicitions))","f6ad32e8":"from sklearn import ensemble\nclf = ensemble.GradientBoostingRegressor(n_estimators = 400, max_depth = 5, min_samples_split = 2,\n          learning_rate = 0.1, loss = 'ls')\nclf.fit(X_train, y_train)\nclf_predicitions = clf.predict(X_test) \nprint(\"R_square score: \", r2_score(y_test,clf_predicitions))","21b2e231":"y = np.array([r2_score(y_test,lr_predictions),r2_score(y_test,dtr_predictions),r2_score(y_test,rfr_predicitions),\n           r2_score(y_test,clf_predicitions)])\nx = [\"LinearRegression\",\"RandomForest\",\"DecisionTree\",\"Grdient Boost\"]\nplt.bar(x,y)\nplt.title(\"Comparison of Regression Algorithms\")\nplt.ylabel(\"r2_score\")\nplt.show()","bc0a737c":"We can see that there are no missing values","861ddfc3":"## Decision Trees","3a73dfe2":"Now, when all our fields are numeric, we can continue with the project and make some exploratory data analysis","6f533349":"We can see that the scores distribution is a __Normal distrution__, where most of the student's score is between __65 to 80__","643c941b":"***","0605b008":"We can see that there is a __nice correlation__ between the math score and the reading score. We can also see that __female__ (Green) has a better score at the reading exams","de62d34d":"***","d81398a0":"***","839dc62e":"***","2ce55216":"We will first split the data to our predictors variables and our criterion variable","3e9aa22f":"***","28cd1523":"## Exploratory Data Analysis","a5c00994":"## Gardient Boosting","786052bb":"***","68304745":"For questions and remarks - please write me a comment.","f5af5166":"***","480d8831":"## Linear Regression##","85ce09c3":"Now let's convert the data to numeric so the machine learning algorithms could be trained and make predictions.","70675052":"The Linear Regression has the highest R^2 Score.","d7451079":"Hi!","61fdc1ce":"For those interested in looking at the full notebook - https:\/\/github.com\/NadavKiani\/Students-Performance-in-Exams\n","f447dd97":"This is my first Kernel, hope you'll love it!","25800773":"We can see that the students who __ate lunch__, had a __better__ score at the writing test.","6365bf54":"***","c2a4c9cf":"# Student Performence in Exams - Writing Score","2c370735":"# Machine Learning","953f5320":"***","59bd7172":"Now we will show a comparison between all the models that we got","2a4f2b34":"***","0bdd11fc":"We can see from this plot that most of the students who got a high score at the writing test, __study__ at the test preparation course. We can understand that the preparation course is __helping__ the students at the writing test","cd1f7498":"## Random Forest"}}