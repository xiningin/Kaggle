{"cell_type":{"094fc68b":"code","ff68c19e":"code","56145479":"code","5270ab7f":"code","8ea240ee":"code","f0a28da2":"code","3789e0d7":"code","8448911b":"code","23ddb4a3":"code","d1b8870f":"code","da0c0267":"code","abcf06f7":"code","0a246adc":"code","c18fa98d":"code","c52d01cc":"code","b1bfd396":"code","a2c65ec2":"code","104cb3a7":"code","2a3aca57":"code","fc8664d9":"code","0f2ca932":"code","9f927323":"code","e6dfe8c7":"code","5cb1758c":"code","3828a154":"code","26bbfef5":"code","640c2823":"code","54eb36f9":"code","7eb4fc78":"code","174546f9":"code","501bcf86":"code","731fd7fe":"code","a12bb66e":"code","c21b415a":"code","0e88c098":"code","e8a1bf6e":"code","ce9e0dd8":"code","7b23344e":"code","9aefea52":"code","a317f33e":"code","e1248ac2":"code","d4b5f443":"code","efb772e0":"code","29014011":"code","ade92ab6":"code","83e73a9f":"code","82724561":"code","be3fed58":"code","643aa450":"code","e93678cd":"code","55723286":"code","48aa5636":"code","90230313":"code","93690579":"code","facc59c3":"code","d642b63a":"code","11c18269":"code","7d0bb8f2":"code","7871b4f7":"code","8d5d0cea":"code","623049b9":"code","92258473":"code","4d8bccc5":"markdown","81638deb":"markdown","9ec90332":"markdown","7109fb97":"markdown","c0a7e620":"markdown","0c1b7510":"markdown","ab50ad5a":"markdown","ae090933":"markdown","c07aa1e7":"markdown","15f4c38c":"markdown","116232a5":"markdown","9fa5b101":"markdown","2991268c":"markdown","35d3a3f6":"markdown","8c5bb78a":"markdown","96b2b36f":"markdown","0329d2a9":"markdown","e8f25026":"markdown","04e4a6c1":"markdown","b0de1e10":"markdown","e6650297":"markdown","9d1152f4":"markdown","310823f3":"markdown","70c7cad7":"markdown","f255f733":"markdown","3bbe1dfc":"markdown","9de17bb1":"markdown","5bb3bccb":"markdown","93d4abee":"markdown","efb8deb1":"markdown","e406f4ac":"markdown","3626bda9":"markdown","82be31ee":"markdown","bc196529":"markdown","45ede752":"markdown","4b2e84ff":"markdown","3d28b0c4":"markdown","bebcc697":"markdown","a0aa9969":"markdown","d81a50ed":"markdown","db798f5e":"markdown","6d5da07d":"markdown","acb462c3":"markdown","82c2b202":"markdown","07656f86":"markdown","c492ebda":"markdown","302831d5":"markdown","62f41f44":"markdown"},"source":{"094fc68b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","ff68c19e":"#loading the dataset\nh=pd.read_csv('\/kaggle\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')\nh.head()","56145479":"h.shape","5270ab7f":"h.info()","8ea240ee":"h.describe()","f0a28da2":"h.isnull().sum()","3789e0d7":"#renaming the target column\nh.rename(columns={'DEATH_EVENT':'death_event'},inplace=True)","8448911b":"h.columns","23ddb4a3":"#converting age into int type\nh['age']=h['age'].astype('int64')","d1b8870f":"h.info()","da0c0267":"import matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nimport plotly\n#plotly.offline.init_notebook_mode(connected = True)","abcf06f7":"plt.figure(figsize=(10,10))\nsns.distplot(h['age'],bins=30)","0a246adc":"plt.figure(figsize=(10,10))\nsns.distplot(h['creatinine_phosphokinase'])\nplt.xticks(range(0,10000,500))","c18fa98d":"plt.figure(figsize=(10,10))\nsns.distplot(h['ejection_fraction'],bins=25)","c52d01cc":"plt.figure(figsize=(10,10))\nsns.distplot(h['platelets'])","b1bfd396":"plt.figure(figsize=(10,10))\nsns.distplot(h['serum_sodium'])","a2c65ec2":"plt.figure(figsize=(10,10))\nsns.distplot(h['serum_creatinine'])","104cb3a7":"plt.figure(figsize=(10,10))\nsns.distplot(h['time'],bins=30)","2a3aca57":"h['anaemia'].value_counts(normalize=True)*100","fc8664d9":"(h['anaemia'].value_counts(normalize=True)*100).plot(kind='bar',color=['b','r'],rot=0)","0f2ca932":"h['diabetes'].value_counts(normalize=True)*100","9f927323":"(h['diabetes'].value_counts(normalize=True)*100).plot(kind='bar',color=['b','r'],rot=0)","e6dfe8c7":"h['high_blood_pressure'].value_counts(normalize=True)*100","5cb1758c":"(h['high_blood_pressure'].value_counts(normalize=True)*100).plot(kind='bar',color=['b','r'],rot=0)","3828a154":"h['sex'].value_counts(normalize=True)*100","26bbfef5":"h['smoking'].value_counts(normalize=True)*100","640c2823":"h['death_event'].value_counts(normalize=True)*100","54eb36f9":"x=h.drop(columns='death_event')\ny=h['death_event']\n\nfrom sklearn.ensemble import ExtraTreesClassifier\nmodel = ExtraTreesClassifier()\nmodel.fit(x,y)\nprint(model.feature_importances_) \nfeat_importances = pd.Series(model.feature_importances_, index=x.columns)\nfeat_importances.nlargest(12).plot(kind='barh')\nplt.show()","7eb4fc78":"#determining correlation\nplt.figure(figsize=(15,15))\nsns.heatmap(h.corr(),annot=True)","174546f9":"px.box(h,'time')","501bcf86":"px.box(h,'ejection_fraction')","731fd7fe":"#detecting the outliers\nh[h['ejection_fraction']>=70]","a12bb66e":"#removing the outliers\nh=h[h['ejection_fraction']<70]\nh.head()","c21b415a":"px.box(h,'serum_creatinine')","0e88c098":"#converting discrete values into categorical for analysis\nh['anaemia'].replace({1:'Yes',0:'No'},inplace=True)\nh['diabetes'].replace({1:'Yes',0:'No'},inplace=True)\nh['high_blood_pressure'].replace({1:'Yes',0:'No'},inplace=True)\nh['smoking'].replace({1:'Yes',0:'No'},inplace=True)\nh['death_event'].replace({1:'Yes',0:'No'},inplace=True)\nh['sex'].replace({1:\"Men\",0:\"women\"},inplace=True)","e8a1bf6e":"e=px.scatter(h,'age',color='death_event',\n             title=\"Distribution of death_event on basis of age\",size='age')\ne.show()","ce9e0dd8":"e=px.scatter(h,'creatinine_phosphokinase',color='death_event',\n             title=\"Distribution of death_event on basis of Creatinine Phosphokinase (in mcg\/L)\",size='creatinine_phosphokinase')\ne.show()","7b23344e":"e=px.scatter(h,'serum_creatinine',color='death_event',\n             title=\"Distribution of death_event on basis of Serum Creatinine(in mg\/dL)\",size='serum_creatinine')\ne.show()","9aefea52":"e=px.scatter(h,'serum_sodium',color='death_event',\n             title=\"Distribution of death_event on basis of serum sodium(mEq\/L)\",size='serum_sodium')\ne.show()","a317f33e":"e=px.scatter(h,'ejection_fraction',color='death_event',\n             title=\"Distribution of death_event on basis of Ejection fraction (in %)\",size='ejection_fraction')\ne.show()","e1248ac2":"e=px.scatter(h,'platelets',color='death_event',\n             title=\"Distribution of death_event on basis of Platelets (in kiloplates\/ML)\",size='platelets')\ne.show()","d4b5f443":"e=px.scatter(h,'time',color='death_event',\n             title=\"Distribution of death_event on basis of Follow-up period (in days)\",size='time')\ne.show()","efb772e0":"sns.countplot(\"death_event\",data=h,hue='smoking')","29014011":"sns.countplot(\"death_event\",data=h,hue='anaemia')","ade92ab6":"sns.countplot(\"death_event\",data=h,hue='sex')","83e73a9f":"sns.countplot(\"death_event\",data=h,hue='diabetes')","82724561":"sns.countplot(\"death_event\",data=h,hue='high_blood_pressure')","be3fed58":"sns.barplot(y='age',x='diabetes',data=h,ci=None)","643aa450":"sns.barplot(y='age',x='high_blood_pressure',data=h,ci=None)","e93678cd":"#continuous variable analysis with respect to target variable\nd=px.scatter(h,'serum_sodium',color='death_event',hover_data=['creatinine_phosphokinase',\n                                                                             'serum_creatinine','ejection_fraction',\n                                                                             'time','platelets'])\nd.show()","55723286":"#discrete variable analysis with respect to target variable\nw=px.bar(h,'death_event',color='death_event',hover_data=['sex','diabetes','anaemia','high_blood_pressure','smoking'])\nw.show()","48aa5636":"#encoding the strings into numbers of needed features\nh['death_event'].replace({'Yes':1,'No':0},inplace=True)\nh['anaemia'].replace({'Yes':1,'No':0},inplace=True)\nh['diabetes'].replace({'Yes':1,'No':0},inplace=True)\nh['high_blood_pressure'].replace({'Yes':1,'No':0},inplace=True)\nh['smoking'].replace({'Yes':1,'No':0},inplace=True)\nh['sex'].replace({\"Men\":1,\"women\":0},inplace=True)","90230313":"#model fitting without feature selection\nx1=h.drop(columns=['death_event'])\ny1=h['death_event']","93690579":"from sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix,roc_auc_score,classification_report\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier as KNN\nfrom sklearn.ensemble import VotingClassifier ","facc59c3":"train_x,test_x,train_y,test_y=train_test_split(x1,y1,test_size=0.2,random_state=0,shuffle=True)\nsc=StandardScaler()\ntrain_x=sc.fit_transform(train_x)\ntest_x=sc.transform(test_x)","d642b63a":"lr=LogisticRegression(random_state=0)\ndt=DecisionTreeClassifier(random_state=0)\nknn=KNN()\nclassifiers = [('Logistic Regression', lr),\n('K Nearest Neighbours', knn),\n('Decision Tree', dt)]","11c18269":"vc=VotingClassifier(estimators=classifiers)\nvc.fit(train_x,train_y)","7d0bb8f2":"y_pred=vc.predict(test_x)\nroc_auc_score(test_y,y_pred)","7871b4f7":"#model fitting with feature selection\nx2=h.iloc[:,[4,7,11]]\nx2.head()","8d5d0cea":"train_x,test_x,train_y,test_y=train_test_split(x2,y1,test_size=0.2,random_state=0,shuffle=True)\nsc=StandardScaler()\ntrain_x=sc.fit_transform(train_x)\ntest_x=sc.transform(test_x)\nvc=VotingClassifier(estimators=classifiers)\nvc.fit(train_x,train_y)\ny_pred=vc.predict(test_x)\nroc_auc_score(test_y,y_pred)","623049b9":"cm=confusion_matrix(test_y,y_pred)\nplt.figure(figsize=(10,10))\nsns.heatmap(cm, cmap=plt.cm.Blues,annot=True)\nplt.title(\"Ensemble Model - Confusion Matrix\")\nplt.yticks(range(2), [\"Actual Heart Not Failed\",\"Actual Heart Fail\"], fontsize=16)\nplt.xticks(range(2), [\"Predicted Heart Not Failed\",\" Predicted Heart Fail\"], fontsize=16)\nplt.show()","92258473":"print(classification_report(test_y,y_pred))","4d8bccc5":"* Most of the CPK levels exist below 1000 mcg\/L. \n* The curve represents right skewed distribution.","81638deb":"Individuals who are below 60 mostly are diabetic.","9ec90332":"* Method of correlation is pearson.\n* 'age','serum_creatinine','anaemia','creatinine_phosphokinase',high_blood_pressure' shows positive correlation in which serum_creatinine has maximum positive correlation.\n* 'diabetes','ejection_fraction','platelets','serum_sodium','time','smoking' shows negative correlation in which time has maximum negative correlation.","7109fb97":"As the age increases there is a risk of high_blood_pressure.","c0a7e620":"**If you like this notebook do upvote it.**\n\nDo provide your valuable feedback.\n\nDo checkout my other notebooks at https:\/\/www.kaggle.com\/tmchls","0c1b7510":"* Fatality rate of men is more than women.\n* Also,survival rate of men is more than women.\n* Due to proportion of more men in the dataset(65%) then women this can be possible.\n* We can say that Gender doesn't relate to heart failure.","ab50ad5a":"## BIVARIATE ANALYSIS","ae090933":"Approx 57% people don't have anaemia i.e low level of haemoglobin.","c07aa1e7":"* Higher level of creatinine_phosphokinase ( > 540 mcg\/L) will cause more heart problems resulting in fatality.\n* Linear Relationship between these two features.","15f4c38c":"* When the serum_sodium levels inside a body drops below 135 mEq\/L, it increases the chance of deaths.\n* Inverse Relationship exists between this two features (negative correlation).","116232a5":"* When the ejection_fraction levels inside a body drops below 40 %, it increases the chance of heart failure.\n* Inverse Relationship exists between this two features (negative correlation).","9fa5b101":"* If an individual has more than one components that affect heart health at a severe level than chances for his\/her death will be more.\n* If an patient has **more platelets,more sodium concentration,less creatinine_phosphokinase,more ejection fraction,less serum_creatinine,more follow-up period in his\/her blood** then they will survive from an heart failure.\n* If a user has more components in control than those who are not in control,then they will likely survive.\n* Therefore this proves that all the **continuous** factors are **independent from each other and are only related with the target variable(death_event).**\n* Most percent of the people survived the heart disease.","2991268c":"* If an individual has more than one components that affect heart health at a severe level than chances for his\/her death will be more.\n* If a user has more components in control than those who are not in control,then they will likely survive.\n* Therefore this proves that all the **discrete** factors are **independent from each other and aren't much related with the target variable(death_event) as it was seen in above analysis.**\n* Most percent of the people survived the heart disease.","35d3a3f6":"The model has an baseline ROC SCORE of 0.83 without feature selection.","8c5bb78a":"The mortalities caused during follow up period in case of an heart attack are less in proportion (approx 68%).","96b2b36f":"* Most of the serum creatinine levels are between 0 to 2 mg\/DL.\n\n* The curve shows right skewed distribution.\n","0329d2a9":"## MODEL BUILDING","e8f25026":"* 41 observations are **True positives**.(Actual positive observation == Predicted positive observation).It means people who don't have heart failure are correctly classified as it is by the algorithm.\n* 2 observations are **False positives**. (Actual positive observation == Predicted negative observation).It means people who don't have heart failure are incorrectly classified as people with heart failure.\n* 3 observation is **False negative**. (Actual negative observation == Predicted positive observation).It means people who have heart failure are incorrectly classified as people with no heart failure.\n* 14 observations are **True negatives**. (Actual negative observation == Predicted negative observation).It means people who have heart failure are correctly classified as it is by the algorithm.","04e4a6c1":"* Most of the serum_sodium levels are between 130 to 140 mEq\/L.\n\n* The curve shows left skewed distribution.","b0de1e10":"Two outliers when fraction is more or greater than 70%.","e6650297":"**INSIGHTS**-\n\n* anaemia,diabetes,high_blood_pressure,sex,smoking and DEATH_EVENT are discrete values(0 and 1) rest of the features are continuous in     nature.\n\n* No encoding needed as all features are numeric.\n\n* Target variable is DEATH_EVENT which represents mortality by heart disease.\n\n* In creatinine_phosphokinase and platelets there is a huge difference between 75th quartile and maximum values which depicts presence of outliers.\n\n* Age has a mean value of approx 61 which means most of the people are around 60 years of age.\n\n* No missing values in the dataset.\n\n* According to the datset given,1 denotes men and 0 denotes women in sex column.","9d1152f4":"Outliers present here can be ignored as in reality cases exist where people have their creatinine levels at a severe level.","310823f3":"## FEATURE SELECTION","70c7cad7":"Diabetes doesn't largely affect fatality rate.The people who aren't diabetic can also die of heart attack because of severe levels in other factors.","f255f733":"### Discrete features","3bbe1dfc":"Approx 65% of people don't have high blood pressure.","9de17bb1":"### Continuous Features","5bb3bccb":"Smoking doesn't largely affect fatality rate.The people who don't smoke can also die of heart attack because of severe levels in other factors.\n","93d4abee":"With feature selection the model has an ROC score of 0.885.","efb8deb1":"Most of the people are or below 60 and the curve represents right skewed distribution.","e406f4ac":"\n\n* Most of the platelets count exist between 200000 and 400000 kiloplatelets\/ML.\n\n* The curve shows right skewed distribution.","3626bda9":"## MULTIVARIATE ANALYSIS","82be31ee":"The ejection fraction levels are mostly 40% or less than 40%.","bc196529":"High BP doesn't largely affect fatality rate.The people who don't have high BP can also die of heart attack because of severe levels in other factors.","45ede752":"* Whether anaemic or not the fatality rate is almost same in both cases.\n* Anaemia also doesn't largely affect fatality rate.The people who don't have anaemia can also die of heart attack because of severe levels in other factors.","4b2e84ff":"### Discrete Variables","3d28b0c4":"The most important features are 'time','ejection_fraction' and 'serum_creatinine'.We will use these in model building.","bebcc697":"* When follow-up period decreases(< 80 days),the probability of death increases.\n* Inverse Relationship exists between this two features (negative correlation).","a0aa9969":"Most of the people are men(approx 65%).","d81a50ed":"Approx 58% people don't have diabetes.","db798f5e":"* Individuals having age more than 59 years have the higher probability of deaths during follow-up period. \n* age and death_event has a linear relationship which means as age increases the probability of death from heart attacks will also increase.","6d5da07d":"No outliers in time.","acb462c3":"* People having serum_creatinine levels more than 1.2 mg\/dL have higher chance of death.\n* Linear Relationship exists between these two features.","82c2b202":"* When the platelet levels inside a body drops below 256000 kiloplatelets\/ML, it increases the chance of deaths.\n* Inverse Relationship exists between this two features (negative correlation).","07656f86":"### Continuous variables","c492ebda":"## UNIVARIATE ANALYSIS","302831d5":"Most of the heart attacks have a follow up-period below 100 days.","62f41f44":"Approx 68% the people don't smoke. "}}