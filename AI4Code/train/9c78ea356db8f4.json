{"cell_type":{"31d7c010":"code","a06feec1":"code","2d7c93a6":"code","6fb7cf2c":"code","763d2638":"code","4d3ef936":"code","450005d9":"code","4b957d16":"code","e30274ba":"code","5f0dea70":"code","71b662dc":"code","10933d39":"code","f30e91de":"code","32f349c2":"markdown","c1ad9142":"markdown"},"source":{"31d7c010":"import pandas as pd\nimport random \nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.feature_extraction.text import TfidfVectorizer","a06feec1":"random.seed(0)\ndf = pd.read_csv(\"..\/input\/jigsaw-toxic-comment-classification-challenge\/train.csv\")\ndf['y'] = (df[['toxic', 'severe_toxic', 'obscene', 'threat', 'insult', 'identity_hate']].sum(axis=1) > 0 ).astype(int)\ndf = df[['comment_text', 'y']].rename(columns={'comment_text': 'text'})\ndf.head(4)","2d7c93a6":"vec = TfidfVectorizer()\nX = vec.fit_transform(df['text'])","6fb7cf2c":"classifier = RandomForestClassifier(n_estimators = 15, criterion = 'entropy', random_state = 0)\nclassifier.fit(X,df['y'])","763d2638":"# Predicting the Test set results\nscore = classifier.score(X,df['y'])","4d3ef936":"df_val = pd.read_csv(\"..\/input\/jigsaw-toxic-severity-rating\/validation_data.csv\")","450005d9":"X_less_toxic = vec.transform(df_val['less_toxic'])\nX_more_toxic = vec.transform(df_val['more_toxic'])","4b957d16":"p1 = classifier.predict_proba(X_less_toxic)\np2 = classifier.predict_proba(X_more_toxic)","e30274ba":"# Validation Accuracy\n(p1[:, 1] < p2[:, 1]).mean()","5f0dea70":"df_sub = pd.read_csv(\"..\/input\/jigsaw-toxic-severity-rating\/comments_to_score.csv\")\nX_test = vec.transform(df_sub['text'])\np3 = classifier.predict_proba(X_test)","71b662dc":"df_sub['score'] = p3[:, 1]","10933d39":"print(df_sub['score'].count())\nprint(df_sub['score'].nunique())","f30e91de":"sub=df_sub[['comment_id', 'score']].to_csv(\"submission.csv\", index=False)","32f349c2":"## Feature Extraction","c1ad9142":"## Submission"}}