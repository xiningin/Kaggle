{"cell_type":{"33da0879":"code","8834d115":"code","74f1f63f":"code","dfc17f27":"code","5bd414f7":"code","3bbbf68e":"code","f32c8989":"code","565a00bd":"code","f43d455c":"code","d0d49b40":"code","f18f3b68":"code","546c3dcf":"code","8f69fe06":"code","3ef3215d":"code","6133f05f":"code","f7ac4b13":"code","ee45595e":"code","1ea65711":"code","0d1956c3":"code","d7284f4b":"code","3f8a815d":"markdown"},"source":{"33da0879":"import random, os\nimport numpy as np\nimport torch\nfrom fastai.vision.all import *","8834d115":"\nprint(os.listdir(\"..\/input\/cell-images-for-detecting-malaria\/cell_images\/cell_images\"))","74f1f63f":"path = Path(\"..\/input\/cell-images-for-detecting-malaria\/cell_images\/cell_images\")","dfc17f27":"path.ls()","5bd414f7":"fns = get_image_files(path)","3bbbf68e":"fns","f32c8989":"failed = verify_images(fns)\nfailed","565a00bd":"cells = DataBlock(\n    blocks=(ImageBlock, CategoryBlock), \n    get_items=get_image_files, \n    splitter=RandomSplitter(valid_pct=0.2, seed=42),\n    get_y=parent_label,\n    item_tfms=Resize(128))","f43d455c":"dls = cells.dataloaders(path)","d0d49b40":"dls.valid.show_batch(max_n=4, nrows=1)","f18f3b68":"cells = cells.new(item_tfms=Resize(128, ResizeMethod.Squish), batch_tfms=aug_transforms(mult=2))\ndls = cells.dataloaders(path)\ndls.train.show_batch(max_n=8, nrows=2, unique = True)","546c3dcf":"learn = cnn_learner(dls, resnet34, metrics=error_rate)\n","8f69fe06":"learn.fine_tune(6)","3ef3215d":"interp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_confusion_matrix(figsize=(10,8))","6133f05f":"interp.plot_top_losses(5, nrows=5)","f7ac4b13":"learn.save('stage-1')","ee45595e":"preds, y_true=learn.get_preds()\ny_true.shape, preds.shape","1ea65711":"y_true=y_true.numpy() \npreds=np.argmax(preds.numpy(), axis=-1)\ny_true.shape, preds.shape","0d1956c3":"from sklearn.metrics import auc, roc_curve, precision_recall_curve, classification_report\nclasses = list(dls.vocab)\nreport = classification_report(y_true, preds, target_names=classes)\nprint(report)","d7284f4b":"learn.show_results()","3f8a815d":"I used this notebook for reference. Check out this notebook as well.\nhttps:\/\/www.kaggle.com\/ingbiodanielh\/malaria-detection-with-fastai-v2\n"}}