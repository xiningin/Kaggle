{"cell_type":{"cc65071d":"code","87df4a73":"code","54bdc887":"code","5696f90a":"code","9e4c768d":"code","12a2b849":"code","ded0dcf3":"code","a6071399":"code","5b96db25":"code","7f3f33c4":"code","b267632b":"code","d20705ab":"code","091364f5":"code","2b4b8929":"code","6f805cf2":"code","df20e47d":"code","ad0edeb6":"code","0863169b":"code","881808b9":"code","98ae3b47":"code","b0bcebea":"code","516dbb41":"code","3e6e8aa0":"code","90cf492e":"code","ab4c8c2a":"code","42da30a5":"code","be8ec84a":"code","279ce172":"code","8b6ca7a7":"code","adfa4910":"code","cbd8139d":"code","d530740b":"code","7d507127":"code","87d5447c":"code","232db365":"code","6ac3523f":"code","6ab412a7":"code","4092854c":"code","5a0032cc":"code","95dbc2be":"code","f78bbab9":"code","2de5ccea":"code","3776e641":"code","76d19d39":"code","5297c02e":"code","e9b1627e":"code","c1d06647":"code","5e9126f5":"code","939e5db6":"code","4b848397":"code","8fdd2803":"code","b4227c11":"code","ec7627ca":"code","594bb850":"code","4eff98d9":"code","e53fec12":"code","3d1bd79b":"code","d0206d2d":"code","703ffd2f":"code","3aa0af51":"markdown","7db13bbf":"markdown","899f675b":"markdown","fb33d7ad":"markdown","49d64da5":"markdown","5e5db132":"markdown","a83f48b5":"markdown","8c2824f6":"markdown","5c3bfd9d":"markdown","f2fd951e":"markdown","8c281e5c":"markdown","e6590760":"markdown","36f8fa2d":"markdown","0d9012a8":"markdown","532aa9b4":"markdown","3b4bff23":"markdown","5bfbfcc4":"markdown","5ec9398c":"markdown","a4a1efd2":"markdown","5ecd61a9":"markdown","8aecdf59":"markdown","dbc00bd0":"markdown"},"source":{"cc65071d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nfrom collections import Counter\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","87df4a73":"data = pd.read_csv('..\/input\/data-analyst-jobs\/DataAnalyst.csv', index_col=\"Unnamed: 0\")\n\ndata.info()","54bdc887":"data.head()","5696f90a":"data['Job Title'] = data['Job Title'].replace({'Sr. Data Analyst': 'Senior Data Analyst', \n                                               'Sr Data Analyst': 'Senior Data Analyst',\n                                               'Sr Analyst, Data': 'Senior Data Analyst',\n                                               'Data Analyst Junior': 'Junior Data Analyst'})\ndata['Job Title'].nunique()","9e4c768d":"data['Job Title'].value_counts()[:30]","12a2b849":"test = data['Salary Estimate'].str.split('-', expand=True)\ndata['MinSalary'] = pd.to_numeric(test[0].str.extract('(\\d+)', expand=False))\ndata['MaxSalary'] = pd.to_numeric(test[1].str.extract('(\\d+)', expand=False))\n\ndata.head()","ded0dcf3":"data['Job Title'].value_counts()[:30]","a6071399":"def plot_salary(y, salary, amt=30, title=''):\n    l = list(data[y].value_counts().iloc[:amt].index)\n    temp = data[data[y].isin(l)]\n    \n    salary_order = temp.groupby(y)[salary].mean().sort_values(ascending=False).index.values\n    \n    chart = sns.catplot(data=temp, y=y, x=salary, kind='box', \n                    order=salary_order, \n                    height=10, aspect=1)\n    \n    plt.title(title)\n#     chart.set_xticklabels(rotation=45)\n\ndef least_freq(group, target, min_counts=3, max_counts=11):\n    counts = Counter(data[group])\n    sal = data[data[group]\\\n                   .isin([x for x in counts if (counts[x] > min_counts & counts[x] < max_counts)])]\\\n    .groupby(group)[target].mean().reset_index()\n\n    return sal.sort_values(by=(target),ascending=False).head(10)","5b96db25":"plot_salary('Job Title', 'MinSalary', amt=12, title='Minimum Salary by Job Title')","7f3f33c4":"plot_salary('Job Title', 'MaxSalary', amt=12, title='Maximum Salary by Job Title')","b267632b":"least_freq('Job Title', 'MinSalary')","d20705ab":"least_freq('Job Title', 'MaxSalary')","091364f5":"data['Location'].nunique()","2b4b8929":"data['Location'].value_counts()[:30]","6f805cf2":"plot_salary('Location', 'MinSalary', title='Minimum salary (in x$10k) by location')","df20e47d":"plot_salary('Location', 'MaxSalary', title='Maximum salary (in x$10k) by location')","ad0edeb6":"least_freq('Location', 'MinSalary')","0863169b":"least_freq('Location', 'MaxSalary')","881808b9":"plot_salary('Headquarters', 'MinSalary', title='Minimum salary (in x$10k) by headquarters')","98ae3b47":"plot_salary('Headquarters', 'MaxSalary', title='Maximum salary (in x$10k) by headquarters')","b0bcebea":"least_freq('Headquarters', 'MinSalary')","516dbb41":"least_freq('Headquarters', 'MaxSalary')","3e6e8aa0":"split = data['Location'].str.split(',', expand=True)\ndata['City'] = split[0]\ndata['Country_State'] = split[1].str.strip()\n\ndata.head()","90cf492e":"split = data['Headquarters'].str.split(',', expand=True)\ndata['CityHQ'] = split[0]\ndata['Country_State_HQ'] = split[1].str.strip()\n\ndata.head()","ab4c8c2a":"data['Country_State'] = data['Country_State'].replace({'Arapahoe': 'CO'})\ndata['Country_State'].nunique()","42da30a5":"data['Country_State'].value_counts()","be8ec84a":"data['Country_State_HQ'].nunique()","279ce172":"data['Country_State_HQ'].value_counts()[:30]","8b6ca7a7":"plot_salary('Country_State', 'MinSalary', title='Minimum salary (in x$10k) by country\/state')","adfa4910":"plot_salary('Country_State', 'MaxSalary', title='Maximum salary (in x$10k) by country\/state')","cbd8139d":"plot_salary('Country_State_HQ', 'MinSalary', title='Minimum salary (in x$10k) by headquarters')","d530740b":"plot_salary('Country_State_HQ', 'MaxSalary', title='Maximum salary (in x$10k) by headquarters')","7d507127":"least_freq('Country_State_HQ', 'MinSalary', min_counts=0, max_counts=7)","87d5447c":"least_freq('Country_State_HQ', 'MaxSalary', min_counts=0, max_counts=7)","232db365":"data['Sector'].nunique()","6ac3523f":"data['Sector'].value_counts()","6ab412a7":"plot_salary('Sector', 'MinSalary', title='Minimum salary (in x$10k) by sector')","4092854c":"plot_salary('Sector', 'MaxSalary', title='Maximum salary (in x$10k) by sector')","5a0032cc":"def by_multiple(group, target, min_counts=11):\n    counts = Counter(data[group[0]])\n    sal = data[data[group[0]]\\\n               .isin([x for x in counts if counts[x] > min_counts])]\\\n               .groupby(group)[target[0]].mean().reset_index()\n\n    return sal.sort_values(by=(target),ascending=False).head(10)","95dbc2be":"by_multiple(['Job Title', 'Sector'], ['MinSalary'])","f78bbab9":"by_multiple(['Sector', 'Job Title'], ['MinSalary'])","2de5ccea":"by_multiple(['Job Title', 'Sector'], ['MaxSalary'])","3776e641":"by_multiple(['Sector', 'Job Title'], ['MaxSalary'])","76d19d39":"chart = sns.catplot(data=data, x='Job Title', y='MinSalary', kind='bar', hue='Sector',\n                    order=data['Job Title'].value_counts().iloc[:5].index, \n                    height=10, aspect=2)\n\nchart.set_xticklabels(rotation=45)","5297c02e":"chart = sns.catplot(data=data, x='Job Title', y='MaxSalary', kind='bar', hue='Sector',\n                    order=data['Job Title'].value_counts().iloc[:5].index, \n                    height=10, aspect=2)\n\nchart.set_xticklabels(rotation=45)","e9b1627e":"chart = sns.catplot(data=data, x='Job Title', y='MinSalary', kind='bar', hue='Sector',\n                    order=data['Job Title'].value_counts().iloc[5:10].index, \n                    height=10, aspect=2)\n\nchart.set_xticklabels(rotation=45)","c1d06647":"chart = sns.catplot(data=data, x='Job Title', y='MaxSalary', kind='bar', hue='Sector',\n                    order=data['Job Title'].value_counts().iloc[5:10].index, \n                    height=10, aspect=2)\n\nchart.set_xticklabels(rotation=45)","5e9126f5":"chart = sns.catplot(data=data, x='Job Title', y='MinSalary', kind='bar', hue='Sector',\n                    order=data['Job Title'].value_counts().iloc[10:15].index, \n                    height=10, aspect=2)\n\nchart.set_xticklabels(rotation=45)","939e5db6":"chart = sns.catplot(data=data, x='Job Title', y='MaxSalary', kind='bar', hue='Sector',\n                    order=data['Job Title'].value_counts().iloc[10:15].index, \n                    height=10, aspect=2)\n\nchart.set_xticklabels(rotation=45)","4b848397":"chart = sns.catplot(data=data, x='Job Title', y='MinSalary', kind='bar', hue='Sector',\n                    order=data['Job Title'].value_counts().iloc[15:20].index, \n                    height=10, aspect=2)\n\nchart.set_xticklabels(rotation=45)","8fdd2803":"chart = sns.catplot(data=data, x='Job Title', y='MaxSalary', kind='bar', hue='Sector',\n                    order=data['Job Title'].value_counts().iloc[15:20].index, \n                    height=10, aspect=2)\n\nchart.set_xticklabels(rotation=45)","b4227c11":"min_sal = data.groupby(['Company Name', 'Job Title', 'Rating', 'Sector', 'Country_State'])['MinSalary'].mean().reset_index()\nmin_sal.sort_values(by=(['Rating', 'MinSalary']),ascending=False).head(10)","ec7627ca":"min_sal = data.groupby(['Company Name', 'Job Title', 'Rating', 'Sector', 'Country_State'])['MaxSalary'].mean().reset_index()\nmin_sal.sort_values(by=(['Rating', 'MaxSalary']),ascending=False).head(10)","594bb850":"by_multiple(['Job Title', 'Company Name', 'Rating', 'Sector', 'Country_State'], ['MinSalary', 'Rating'])","4eff98d9":"by_multiple(['Job Title', 'Company Name', 'Rating', 'Sector', 'Country_State'], ['MaxSalary', 'Rating'])","e53fec12":"min_sal = data[data['Job Title']=='Junior Data Analyst'].groupby(['Company Name', 'Rating', 'Sector', 'Country_State'])['MinSalary'].mean().reset_index()\nmin_sal.sort_values(by=(['Rating', 'MinSalary']),ascending=False).head(20)","3d1bd79b":"max_sal = data[data['Job Title']=='Junior Data Analyst'].groupby(['Company Name', 'Rating', 'Sector', 'Country_State'])['MaxSalary'].mean().reset_index()\nmax_sal.sort_values(by=(['Rating', 'MaxSalary']),ascending=False).head(20)","d0206d2d":"min_sal = data[data['Sector']=='Arts, Entertainment & Recreation']\\\n                .groupby(['Company Name', 'Rating', 'Sector', 'Country_State'])['MinSalary']\\\n                .mean().reset_index()\n\nmin_sal.sort_values(by=(['Rating', 'MinSalary']),ascending=False).head(20)","703ffd2f":"max_sal = data[data['Sector']=='Arts, Entertainment & Recreation']\\\n            .groupby(['Company Name', 'Rating', 'Sector', 'Country_State'])['MaxSalary']\\\n            .mean().reset_index()\n\nmax_sal.sort_values(by=(['Rating', 'MaxSalary']),ascending=False).head(20)","3aa0af51":"# Split city and country\/state\n\nLet's try splitting up location and headquarters by their city and state\/country:","7db13bbf":"These queries prioritizes **most frequent job titles** then the average min\/max salary, then the rating.","899f675b":"**Top 30 average minimum and maximum salaries by headquarters**","fb33d7ad":"The highest average minimum and maxiumum salaries are in less frequent locations but are mostly all in California.","49d64da5":"Get the top 30 most common data analyst jobs:","5e5db132":"Illinois has the highest average minimum salary, and California has the highest average maximum salary.","a83f48b5":"Staffigo Technical Servies has 14 different locations in the US for a Junior Data Analyst in the Information Technology sector.","8c2824f6":"# Group Salary by Job Title\n\nRename similar job titles to the most frequent ones.","5c3bfd9d":"# Group Salary by Location","f2fd951e":"# Highest salary jobs by location and rating\n\nThese queries prioritizes the highest average min\/max salary, then rating. It also shows other important columns like the company name, job title, sector and the country\/state that the job is located.","8c281e5c":"For the most frequent locations, San Jose, CA has the highest average minimum and maximum salary. Below are the least frequent locations and their minimum and maximum average salaries:","e6590760":"Create box plots for min and max salary by job title:","36f8fa2d":"# Salary by Job Title and Sector","0d9012a8":"For the top 12 most frequent data analyst jobs, Lead Data Analyst has the highest average minimum and maximum salary. Below the least frequent highest average minimum and maximum salary jobs are shown.","532aa9b4":"Arapahoe is a county in Colorado, so let's replace it with the state:","3b4bff23":"# Read file","5bfbfcc4":"## Salaries of least popular job titles by sector","5ec9398c":"### Why is the 'Arts, Entertainment & Recreation' sector a high-paying industry?\n\nPeopleFun is a mobile game development company. Roar Digital and FanDuel are about online fantasy sports with betting.","a4a1efd2":"Split up the salary estimate into minimum and maximum salary:","5ecd61a9":"The Biotech and Pharmaceuticals sector has the highest average minimum and maximum salaries.","8aecdf59":"## For Junior Data Analyst\n\nIf you're starting out as a Junior Data Analyst, the company with the highest salaries and rating are:","dbc00bd0":"# Group Salary by Sector"}}