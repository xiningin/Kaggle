{"cell_type":{"0a0b893d":"code","dd1cca31":"code","9c2fd01b":"code","324512f5":"code","107201c1":"code","a142644c":"code","b31db104":"code","30e4c89e":"code","56827a35":"code","7561c40d":"code","8bc58f3e":"code","45efe43b":"code","c4384867":"code","d4d55658":"code","16d0caf3":"code","ff83b43d":"markdown"},"source":{"0a0b893d":"import pandas as pd","dd1cca31":"df=pd.read_csv('..\/input\/stock-sentiment-analysis\/Stock_Dataa.csv', encoding = \"ISO-8859-1\")","9c2fd01b":"df.head()","324512f5":"train = df[df['Date'] < '20150101']\ntest = df[df['Date'] > '20141231']","107201c1":"# Removing punctuations\ndata=train.iloc[:,2:27]\ndata.replace(\"[^a-zA-Z]\",\" \",regex=True, inplace=True)\n\n# Renaming column names for ease of access\nlist1= [i for i in range(25)]\nnew_Index=[str(i) for i in list1]\ndata.columns= new_Index\ndata.head(5)\n\n","a142644c":"# Convertng headlines to lower case\nfor index in new_Index:\n    data[index]=data[index].str.lower()\ndata.head(1)","b31db104":"' '.join(str(x) for x in data.iloc[1,0:25])","30e4c89e":"headlines = []\nfor row in range(0,len(data.index)):\n    headlines.append(' '.join(str(x) for x in data.iloc[row,0:25]))","56827a35":"headlines[0]","7561c40d":"from sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.ensemble import RandomForestClassifier","8bc58f3e":"## implement BAG OF WORDS\ncountvector=CountVectorizer(ngram_range=(2,2))\ntraindataset=countvector.fit_transform(headlines)","45efe43b":"# implement RandomForest Classifier\nrandomclassifier=RandomForestClassifier(n_estimators=200,criterion='entropy')\nrandomclassifier.fit(traindataset,train['Label'])","c4384867":"## Predict for the Test Dataset\ntest_transform= []\nfor row in range(0,len(test.index)):\n    test_transform.append(' '.join(str(x) for x in test.iloc[row,2:27]))\ntest_dataset = countvector.transform(test_transform)\npredictions = randomclassifier.predict(test_dataset)","d4d55658":"## Import library to check accuracy\nfrom sklearn.metrics import classification_report,confusion_matrix,accuracy_score","16d0caf3":"matrix=confusion_matrix(test['Label'],predictions)\nprint(matrix)\nscore=accuracy_score(test['Label'],predictions)\nprint(score)\nreport=classification_report(test['Label'],predictions)\nprint(report)","ff83b43d":"## Stock Sentiment Analysis using News Headlines"}}