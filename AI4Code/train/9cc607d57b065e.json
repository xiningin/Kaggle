{"cell_type":{"2f966f06":"code","49088fbf":"code","0da84855":"code","93ddbce6":"code","5f2e678d":"code","d99c9624":"code","aa24b20b":"code","2b0229e4":"code","5dc237b4":"code","4d9b96bf":"code","42e80f85":"code","5bf4100a":"code","3536fe32":"code","6d0d7297":"code","1fa93839":"code","3f78c320":"code","8eb7fd69":"code","144b9962":"code","7f5131b1":"code","14b118d2":"code","c2ab0cd0":"code","a3efc253":"code","71539a75":"code","d7aab2f1":"code","41be8f83":"code","b60edc20":"code","543879c9":"code","fe9bc2d8":"code","6a45ca27":"code","825cfc1e":"code","1812164d":"code","7c8d6b1f":"code","b740ac9b":"code","c33540ba":"code","6214b3b1":"code","4ea662f2":"markdown","74696f5a":"markdown","85c19d85":"markdown","d7155849":"markdown","32b03000":"markdown","bd2ad376":"markdown","9315e3d1":"markdown","e9259fa6":"markdown","2dd6fc11":"markdown","cceb6651":"markdown","af9ff123":"markdown","f550404b":"markdown","5c3da79a":"markdown","8a32fbc8":"markdown","e318bcd2":"markdown","3ecdffe0":"markdown","e29023b5":"markdown","595fe07e":"markdown","96ca6e3f":"markdown","d684254c":"markdown","b98a0d17":"markdown","4fc874f7":"markdown","4be0e339":"markdown","97425473":"markdown","3ec1dcf6":"markdown"},"source":{"2f966f06":"import numpy as np \nimport pandas as pd ","49088fbf":"data_2017 = pd.read_csv('..\/input\/open-medic-2017\/OPEN_MEDIC_2017.CSV',sep=';',encoding='latin-1')\ndata_2018 = pd.read_csv('..\/input\/open-medic-2018\/OPEN_MEDIC_2018.CSV',sep=';',encoding='latin-1')\ndata_2019 = pd.read_csv('..\/input\/open-medic-2019\/OPEN_MEDIC_2019.CSV',sep=';',encoding='latin-1')","0da84855":"data_2017.shape","93ddbce6":"data_2018.shape","5f2e678d":"data_2019.shape","d99c9624":"data_2017.head()","aa24b20b":"data_2018.head()","2b0229e4":"data_2019.head()","5dc237b4":"data_2017[\"Year\"]=\"2017\"\ndata_2018[\"Year\"]=\"2018\"\ndata_2019[\"Year\"]=\"2019\"","4d9b96bf":"data_2017.columns","42e80f85":"data_2018.columns","5bf4100a":"data_2019.columns","3536fe32":"columns= ['ATC1', 'l_ATC1', 'ATC2', 'L_ATC2', 'ATC3', 'L_ATC3', 'ATC4', 'L_ATC4',\n       'ATC5', 'L_ATC5', 'CIP13', 'L_CIP13', 'TOP_GEN', 'GEN_NUM', 'AGE',\n       'SEXE', 'BEN_REG', 'PSP_SPE', 'BOITES', 'REM', 'BSE','YEAR']","6d0d7297":"data_2017.columns =  columns\ndata_2018.columns =  columns\ndata_2019.columns =  columns","1fa93839":"data_concat = pd.concat([data_2017,data_2018,data_2019])","3f78c320":"data_concat.shape","8eb7fd69":"data_concat","144b9962":"#Percentage of NAN Values \nNAN = [(c, data_concat[c].isna().mean()*100) for c in data_concat]\nNAN = pd.DataFrame(NAN, columns=[\"column_name\", \"percentage\"])\nNAN","7f5131b1":"data_concat =data_concat.drop(['ATC1','ATC2','ATC3','ATC4','ATC5','CIP13','L_ATC3','L_ATC4','L_ATC5','TOP_GEN','GEN_NUM'],axis=1)\n","14b118d2":"data_concat.shape","c2ab0cd0":"sex_map  = {1:'Masculin',2:'Feminin',9:'Inconnu'}\ndata_concat['SEXE'] = data_concat['SEXE'].map(sex_map)","a3efc253":"data_concat['SEXE']","71539a75":"region_map = {5:'''Outre-mer ''',11:'Ile-de-France', 24:'Centre-Val de Loire', 27:'Bourgogne-Franche-Comt\u00e9',\n            28:'Normandie',32:'Nord-Pas-de-Calais-Picardie', 44:'Alsace-Champagne-Ardenne-Lorraine',\n             52:'Pays de la Loire', 53:'Bretagne',75:'Aquitaine-Limousin-Poitou-Charentes',\n             76:'Languedoc-Roussillon-Midi-Pyr\u00e9n\u00e9es',84:'Auvergne-Rh\u00f4ne-Alpes',93:'''Provence-Alpes-C\u00f4te d'Azur et Corse''',\n            0:'Inconnue',9:'Inconnue',99:'Inconnue'}\ndata_concat['BEN_REG'] = data_concat['BEN_REG'].map(region_map)","d7aab2f1":"data_concat['BEN_REG']","41be8f83":"Prescriber_map = {1:'M\u00e9decine generale liberale',2:'Anesth\u00e9siste-r\u00e9animateur lib\u00e9ral', \n             3:'Pathologie cardio-vasculaire liberale', 4:'Chirurgie liberale',\n            5:'Dermatologie et de v\u00e9n\u00e9r\u00e9ologie liberale',6:'Radiologie liberale',\n             7:'Gynecologie obstetrique liberale',\n             8:'Gastro-ent\u00e9rologue et hepatologie liberale', 9:'M\u00e9decine interne lib\u00e9ral',\n             11:'Oto rhino-laryngologie liberale',12:'P\u00e9diatrie liberale',\n             13:'Pneumologie liberale',\n            14:'Rhumatologie liberale',15:'Ophtalmologie liberale',17:'Psychiatrie liberale' ,            \n             18:'Stomatologie liberale',31:'M\u00e9decine physique et de r\u00e9adaptation lib\u00e9rale',\n             32:'Neurologie lib\u00e9rale',\n             35:'Nephrologie lib\u00e9rale',37:'Anatomie-cytologie-pathologique lib\u00e9rale',\n             38:'Directeur laboratoire m\u00e9decin lib\u00e9ral',\n             42:'Endocrinologie et metabolismes lib\u00e9ral',90:'Prescripteurs salaries',\n             98:'Dentistes, Auxiliaires m\u00e9dicaux, Laboratoires, Sages-femmes',99:'Valeur inconnue',\n}\ndata_concat['PSP_SPE'] = data_concat['PSP_SPE'].map(Prescriber_map)\n","b60edc20":"data_concat['PSP_SPE'] ","543879c9":"age_map = {0:'0 to 19 years',20:'20 to 59 years', 60:'Over 60 years', 99:'Age Inconnu'}\ndata_concat['AGE'] = data_concat['AGE'].map(age_map)\n","fe9bc2d8":"data_concat['AGE']","6a45ca27":"data_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('''MEDICAMENTS POUR LES TROUBLES DE L'ACIDITE''','''TROUBLES DE L'ACIDITE''') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('''MEDICAMENTS POUR LES TROUBLES FONCTIONNELS GASTROINTESTINAUX''','''TROUBLES FONCTIONNELS GASTROINTESTINAUX''') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('MEDICAMENTS DE LA DIGESTION, ENZYMES INCLUSES','DIGESTION, ENZYMES INCLUSES') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('MEDICAMENTS DU DIABETE','DIABETE') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('AUTRES MEDICAMENTS DES VOIES DIGESTIVES ET DU METABOLISME','AUTRES DES VOIES DIGESTIVES ET DU METABOLISME') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('MEDICAMENTS AGISSANT SUR LE SYSTEME RENINE-ANGIOTENSINE','SYSTEME RENINE-ANGIOTENSINE') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('MEDICAMENTS CONTRE LE PSORIASIS','CONTRE LE PSORIASIS') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('MEDICAMENTS UROLOGIQUES','UROLOGIQUES') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('TOPIQUES POUR DOULEURS ARTICULAIRES OU MUSCULAIRES','DOULEURS ARTICULAIRES OU MUSCULAIRES') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('MEDICAMENTS POUR LE TRAITEMENT DES DESORDRES OSSEUX','TRAITEMENT DES DESORDRES OSSEUX') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('AUTRES MEDICAMENTS DES DESORDRES MUSCULOSQUELETTIQUES','AUTRES DES DESORDRES MUSCULOSQUELETTIQUES') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('AUTRES MEDICAMENTS DU SYSTEME NERVEUX','AUTRES DU SYSTEME NERVEUX') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('MEDICAMENTS POUR LES SYNDROMES OBSTRUCTIFS DES VOIES AERIENNES','SYNDROMES OBSTRUCTIFS DES VOIES AERIENNES') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('MEDICAMENTS DU RHUME ET DE LA TOUX','RHUME ET TOUX') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('''AUTRES MEDICAMENTS DE L'APPAREIL RESPIRATOIRE''','''AUTRES DE L'APPAREIL RESPIRATOIRE''') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('MEDICAMENTS OPHTALMOLOGIQUES','OPHTALMOLOGIQUES') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('MEDICAMENTS OTOLOGIQUES','OTOLOGIQUES') \ndata_concat[\"L_ATC2\"]= data_concat[\"L_ATC2\"].replace('MEDICAMENTS POUR DIAGNOSTIC','DIAGNOSTIC') ","825cfc1e":"data_concat[\"L_ATC2\"]","1812164d":"new_cip=[]\nfor cip in data_concat[\"L_CIP13\"]:\n    i = 0\n    while ((i < len(cip)) and (not(cip[i].isdigit()))):\n        i= i+1\n    new_cip.append(cip[:i-1].capitalize() )","7c8d6b1f":"data_concat['Drug_Name']=new_cip","b740ac9b":"data_concat =data_concat.drop(['L_CIP13'],axis=1)","c33540ba":"data_concat['Drug_Name']","6214b3b1":"data_concat.head()","4ea662f2":"\n<font color='black'>-> Like we see there are some difference like age and AGE, L_CIP13, l_cip_13.<\/font>\n\n","74696f5a":"\n#  <font color='green'> Data Preparation <\/font>","85c19d85":"\n<font color='black'>Let's take a first look at our Datasets<\/font>","d7155849":"\n\n<font color='black'>We have 5 million rows and 22 columns.\n\nNow our data is ready for the next step. <\/font>\n\n","32b03000":"**In our case we will use 11 columns :**\n\n1. L_ACT1: Anatomical Main Group Label\n1. L_ACT2: The family of medicines\n1. CIP13: Contains the drug name\n1. AGE: Age at time of care\n1. SEXE: Sex\n1. BEN_REG: Beneficiary\u2019s Region of Residence\n1. PSP_SPE: Prescriber\n1. REM: Amount Repaid\n1. BSE: Repayment Basis\n1. BOITES: Number of boxes delivered\n1. YEAR: YEAR","bd2ad376":"<font color='red'> **Now we will make some values transformation** <\/font>","9315e3d1":"<font color='red'> **Data after preparation** <\/font>","e9259fa6":"<font color='black'>Now we will concatenate the 3 Datasets. <\/font>\n","2dd6fc11":"Extract the Drug Name from 'L_CIP13' column.","cceb6651":"\n<font color='black'>First of all let's check that the 3 datasets have the same columns names.<\/font>\n","af9ff123":"<font color='red'> **Data selection** <\/font>","f550404b":"For exemple in the Sex column :\n*  1 -> Masculin (Male)\n*  2 -> Feminin (Female)\n*  9 -> Inconnu (Unknown)","5c3da79a":"<font color='black'>Add new column \"Year\" to sepcify the year 2017, 2018 and 2019<\/font>\n","8a32fbc8":"\n#  <font color='blue'> Drug expenditure in France - Data Preparation <\/font>","e318bcd2":"\n<font color='black'>Let's drop the other columns <\/font>\n","3ecdffe0":"\n\n<font color='gris'>Create the drug name column and drop the old one <\/font>\n","e29023b5":" <font color='black'>We will use 3 datasets : OPEN MEDIC 2017, OPEN MEDIC 2018, and OPEN MEDIC 2019.<\/font>","595fe07e":"\n<font color='black'>Let's show a sample of our data.<\/font>","96ca6e3f":"#  <font color='green'> Import Datasets <\/font>","d684254c":"# Stay tuned for the next updates and do not forget the <font color='red'> UPVOTE <\/font> :)","b98a0d17":"\n\n<font color='black'>To Concatenate the 3 datasets we should have the same columns names, So let's do that in the next step. <\/font>\n\n","4fc874f7":"# I hope you find this kernel useful\n# Your <font color='red'> UPVOTES <\/font> would be highly appreciated","4be0e339":"<font color='red'> **Concatenate datasets** <\/font>","97425473":"\n\n\n<font color='black'>What about checking missing Values ? <\/font>\n\n","3ec1dcf6":"\n <font color='black'>-> So we have more thant 5.5 million rows and 21 columns<\/font>"}}