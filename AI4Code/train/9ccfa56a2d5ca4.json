{"cell_type":{"1286b8dc":"code","784e1a60":"code","9a57f145":"code","7f236cc4":"code","448d2e07":"code","124bd3e9":"code","b2d7c986":"code","ae7247ac":"code","dbd99f9a":"code","7367d326":"code","995de2fd":"code","f2b597e0":"code","4ad48a60":"code","c350e8f7":"code","a236c0e7":"code","ddd5dd95":"code","50ebf705":"code","39d3d65d":"code","0430acd4":"code","163d7f7c":"code","c1824fd1":"code","d2dc1730":"code","19631206":"code","b02d4624":"code","272c01e1":"code","b9bb76c9":"code","a20181a2":"code","e4ece7a8":"code","ca6ca78c":"code","a5a8a62b":"code","c40dcca1":"code","0e3bcab6":"code","0aa82c07":"code","cabf5fca":"code","c458dfb6":"code","be41feed":"code","51896d69":"markdown","427b9458":"markdown","3c291ce9":"markdown","fd7300c4":"markdown","cd5c44cd":"markdown","5c1df5f2":"markdown","7c4897af":"markdown","abff475e":"markdown","a4e8160d":"markdown","de6300d5":"markdown","baaac6c6":"markdown","f1fae581":"markdown","86a8ea8f":"markdown","bdb18c44":"markdown","67e16bc2":"markdown","5f0f5c6a":"markdown","6d28d7bd":"markdown","fbf11ecb":"markdown","b5f2a3a8":"markdown","cd716eb3":"markdown","1f6d04be":"markdown","0eb1d849":"markdown","f2d6c452":"markdown","e2d4053d":"markdown","cb1a28d4":"markdown","4c80fafc":"markdown","c3687888":"markdown"},"source":{"1286b8dc":"import pandas as pd\nimport numpy as np  \nimport seaborn as sns \npal = sns.color_palette()\nfrom wordcloud import WordCloud\nimport plotly.express as px\nimport matplotlib.pyplot as plt\n%matplotlib inline\nfrom sklearn import preprocessing\nimport glob\nimport plotly.offline as py\nimport plotly.graph_objs as go\nimport plotly.tools as tls\nfrom keras.models import Sequential\nfrom tensorflow.keras.layers import Activation, Dense, Dropout","784e1a60":"districts_data = pd.read_csv(\"..\/input\/learnplatform-covid19-impact-on-digital-learning\/districts_info.csv\")","9a57f145":"districts_data.head()","7f236cc4":"districts_data.shape","448d2e07":"districts_data.info()","124bd3e9":"districts_data.dtypes","b2d7c986":"districts_data = districts_data.drop_duplicates()","ae7247ac":"len(districts_data)","dbd99f9a":"plt.figure(figsize=(12,10));\nsns.countplot(x=districts_data.state);\nplt.xticks(rotation=90);","7367d326":"districts_data[\"state\"].value_counts().head(15).plot(kind = 'pie', autopct='%1.1f%%', figsize=(10, 10), startangle=0).legend();","995de2fd":"plt.figure(figsize=(12,10));\nsns.countplot(x=districts_data.locale);\nplt.xticks(rotation=90);","f2b597e0":"districts_data[\"locale\"].value_counts().head(10).plot(kind = 'pie', autopct='%1.1f%%', figsize=(10, 10)).legend();","4ad48a60":"sns.countplot(data= districts_data, x = \"pct_black\/hispanic\");\nplt.show();","c350e8f7":"sns.countplot(data= districts_data, x = \"pct_free\/reduced\");\nplt.show();","a236c0e7":"sns.countplot(data= districts_data, x = \"county_connections_ratio\");\nplt.show();","ddd5dd95":"plt.figure(figsize=(12,10));\nsns.countplot(x=districts_data.pp_total_raw);\nplt.xticks(rotation=90);","50ebf705":"products_data = pd.read_csv(\"..\/input\/learnplatform-covid19-impact-on-digital-learning\/products_info.csv\")\n#products_data","39d3d65d":"products_data.head()","0430acd4":"plt.tight_layout();\nproducts_data[\"Sector(s)\"].value_counts().head(10).plot(kind = 'pie', autopct='%1.1f%%', \n                                                        figsize=(10, 10), startangle=0,\n                                                        labeldistance=1.1,pctdistance=0.5).legend();","163d7f7c":"plt.figure(figsize=(12,10));\nsns.countplot(x=products_data[\"Primary Essential Function\"]);\nplt.xticks(rotation=90);","c1824fd1":"CSV_files=pd.DataFrame()\naddress = glob.glob('..\/input\/learnplatform-covid19-impact-on-digital-learning\/engagement_data\/*.csv')\ncount=0\nfor i in address:\n    with open(i, \"rb\") as data_of_files:\n        data=pd.read_csv(data_of_files)\n        CSV_files=pd.concat([CSV_files,data], axis=0)\n        count=count+1\n        if count==233:\n            break  \nCSV_files","d2dc1730":"CSV_files.hist(figsize=(20,20),bins = 20, color=\"blue\")\nplt.title(\"Numeric Features Distribution\");\nplt.show();","19631206":"colormap = plt.cm.magma\nplt.figure(figsize=(14,12));\nplt.title('Pearson Correlation of Features', y=1.05, size=15);\nsns.heatmap(CSV_files.corr(),linewidths=0.1,vmax=1.0, \n            square=True, cmap=colormap, linecolor='white', annot=True);","b02d4624":"data_total = CSV_files.isnull().sum()\ndata_percent = ((CSV_files.isnull().sum()\/CSV_files.shape[0])*100).round(2)\nmissing_data = pd.concat([data_total, data_percent],\n                                axis=1, \n                                keys=['Data_Total', 'Data_Percent %'],\n                                sort = True)\nmissing_data.style.bar(color = ['red'])","272c01e1":"CSV_files['time'] = pd.to_datetime(CSV_files['time'])","b9bb76c9":"print(products_data[\"LP ID\"].nunique())\nprint(CSV_files[\"lp_id\"].nunique())","a20181a2":"products_engagement_data = pd.merge(products_data,CSV_files, \n                                    left_on='LP ID', right_on='lp_id')\nproducts_engagement_data.head()","e4ece7a8":"del CSV_files","ca6ca78c":"path = '..\/input\/learnplatform-covid19-impact-on-digital-learning\/engagement_data' \nall_files = glob.glob(path + \"\/*.csv\")\n\nli = []\n\nfor filename in all_files:\n    df = pd.read_csv(filename, index_col=None, header=0)\n    district_id = filename.split(\"\/\")[4].split(\".\")[0]\n    df[\"district_id\"] = district_id\n    li.append(df)\n    \nengagement_data = pd.concat(li)\nengagement_data = engagement_data.reset_index(drop=True)\nengagement_data.head()","a5a8a62b":"print(engagement_data[\"district_id\"].nunique())\nprint(districts_data[\"district_id\"].nunique())","c40dcca1":"engagement_data[\"district_id\"] = engagement_data[\"district_id\"].astype(str).astype(int)\ndistricts_engagement_data = pd.merge(districts_data, engagement_data, left_on='district_id', right_on='district_id')\ndistricts_engagement_data.head()","0e3bcab6":"def plot_time_series(df,col1,col2,col3):\n    max_list = df[[col1,col2]]\\\n        .groupby([col1])[col2].mean()\\\n        .sort_values(ascending=False).index[:5].tolist()\n\n    df = df[df[col1].isin(max_list)]\\\n                    .reset_index(drop=True)[[col3, col1, col2]]\n    df = df.pivot_table(index=col3, columns=col1, values=col2)\n\n    fig = px.line(df, facet_col=col1, facet_col_wrap=1, width=800, height=800)\n    fig.update_layout(\n                      title=(col1 + \" , \" + col2 + \" , \" + col3).title(),\n                      title_x=0.39,\n                      template=\"plotly\",\n                      paper_bgcolor='#f5f7f7',\n                      font = {'family': 'Serif', 'size': 15}\n                     )\n    fig.show()","0aa82c07":"plot_time_series(districts_engagement_data,\"state\",\"pct_access\",\"time\")\nplot_time_series(districts_engagement_data,\"state\",\"engagement_index\",\"time\")\nplot_time_series(districts_engagement_data,\"locale\",\"pct_access\",\"time\")\nplot_time_series(districts_engagement_data,\"locale\",\"engagement_index\",\"time\")","cabf5fca":"from geopy.geocoders import Nominatim\ngeolocator = Nominatim(user_agent=\"Ruch\")\n\ndef feature_generation(df):\n    lat=[]\n    long=[]\n    for i in df['state']: \n        location = geolocator.geocode(i)\n        try:\n            lat.append(location.latitude)\n            long.append(location.longitude)\n        except:\n            lat.append(\"NA\")\n            long.append(\"NA\")\n    df['Latitude'] = lat\n    df['Longitude'] = long\n    \n    return df\n\ndef map_df(df,col1,col2):\n    df = pd.DataFrame(df[[col1,col2]]\\\n            .groupby([col1])[col2].mean()\\\n            .sort_values(ascending=False)[:20]).reset_index()\n    \n    df = feature_generation(df)\n    \n    return df\n\nstate_access = map_df(districts_engagement_data, \"state\", \"pct_access\")\nstate_engagement_index = map_df(districts_engagement_data, \"state\", \"engagement_index\")","c458dfb6":"import folium\nfrom folium import Choropleth, Circle, Marker\nfrom folium.plugins import HeatMap, MarkerCluster\nnorth_america_map = folium.Map(location=[38.9, -77.05], tiles='Stamen Watercolor', zoom_start=3)\nnorth_america_map","be41feed":"import math\nmc = MarkerCluster()\nfor idx, row in state_access.iterrows():\n    if not math.isnan(row['Longitude']) and not math.isnan(row['Latitude']):\n        popup = \"\"\"\n        State : <b>%s<\/b><br>\n        Percentage Access : <b>%s<\/b><br>\n        \"\"\" % (row['state'], row['pct_access'])\n        mc.add_child(Marker([row['Latitude'], row['Longitude']],tooltip=popup))\n    north_america_map.add_child(mc)\nnorth_america_map","51896d69":"## 1. Importing Libraries","427b9458":"### 2.5.1 Base Map","3c291ce9":"### There are 233 rows or district ids and 7 columns in the dataset","fd7300c4":"### State wise distribution shows that Illinois, Utah, Connecticut and Massachusetts have the maximum data points","cd5c44cd":"## 2.3 Load the data - Engagement data","5c1df5f2":"## 2.5 Geospatial Analysis","7c4897af":"#### Maximum districs have high speed connection ratio","abff475e":"![image.png](attachment:3744f3f1-78b9-4959-9918-5a08a658f16b.png)","a4e8160d":"## 2.4 Merge the data","de6300d5":"## 2.1 Load the data - Districts data","baaac6c6":"#### Percentage of students in the district have at least one page-load event of a given product (pct_access) and on a given day is one of the main drivers for engagement index","f1fae581":"## 2.2 Load the data - Products data","86a8ea8f":"### 2.2.1 Exploratory Data Analysis","bdb18c44":"#### Per pupil total expenditure in majority of the districts is in the range of 8K-10K dollars","67e16bc2":"#### Primary essential function is the digital learning platform ","5f0f5c6a":"#### Maximum districts have about 20-40% students eligible for free or reduced price lunch","6d28d7bd":"#### Maximum districts have black and hispanic population upto maximum of 20%","fbf11ecb":"### 2.1.1 Exploratory Data Analysis","b5f2a3a8":"#### We checked for duplicates and dropped them, however the number of rows remained constant meaning that there are no duplicates in the original data","cd716eb3":"### All the columns except district_id are object types","1f6d04be":"#### Distribution of locale shows that maximum data entries belong to Suburb locale","0eb1d849":"#### Further updates coming soon, stay tuned, thanks for your patience so far","f2d6c452":"#### Maximum missing value is in engagement index, however since it has very high correlation with pct_access (which has lesser missing values), we can use this relationship as a proxy to impute the missing values","e2d4053d":"#### The products are used maximum in PreK-12 sector","cb1a28d4":"### 2.5.2 State and Percentage Access (Top 20)","4c80fafc":"### 2.1.2 Data Visualization","c3687888":"#### We can notice that a lot of columns have missing values (almost all the columns except district_id)"}}