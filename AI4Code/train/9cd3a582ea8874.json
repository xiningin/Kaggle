{"cell_type":{"c3a63af2":"code","b88be904":"code","c8aa8c17":"code","ff491672":"code","4b35bfac":"code","aeb664c8":"code","7e8f16b1":"code","f56ab788":"code","a3e5b7e0":"code","ed06aaba":"code","7f51dde6":"code","54abc6d5":"code","7b2163e2":"code","83c5ac5d":"code","1913100c":"code","56c1776e":"code","a7aab860":"code","7ad1d00d":"code","34e9d5a6":"code","935e03dc":"code","0e9f2cae":"code","8e41d90f":"code","83e38e37":"code","6c0f900e":"code","babbce61":"code","5a0b2f38":"code","31cbfc4b":"code","a8849d69":"code","a06101eb":"code","d8a011cf":"markdown","57c2192a":"markdown","43824964":"markdown","273e084e":"markdown","d4dfd9c2":"markdown","bfa9ff17":"markdown","bdd30942":"markdown","fd806ff6":"markdown","e39811ba":"markdown","67411a37":"markdown","e572caea":"markdown","2f1c3cdd":"markdown","bc75764e":"markdown","51fb833c":"markdown","7dd34fd0":"markdown","dec4157a":"markdown"},"source":{"c3a63af2":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\n\nimport warnings\nwarnings.simplefilter(action='ignore', category=FutureWarning)","b88be904":"train = pd.read_csv('..\/input\/tabular-playground-series-jul-2021\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-jul-2021\/test.csv')\nsub = pd.read_csv('..\/input\/tabular-playground-series-jul-2021\/sample_submission.csv')","c8aa8c17":"train","ff491672":"train.info()","4b35bfac":"train.describe().T","aeb664c8":"test","7e8f16b1":"test.info()","f56ab788":"sub","a3e5b7e0":"plt.figure(figsize=(9,9))\nsns.heatmap(train.drop('date_time',axis = 1).corr(), vmax=1, square=True,annot=True,cmap='RdBu')\nplt.show()","ed06aaba":"sns.pairplot(train.drop('date_time',axis = 1))","7f51dde6":"sns.jointplot('target_benzene', 'sensor_2', data=train)","54abc6d5":"sns.jointplot('target_carbon_monoxide', 'target_benzene', data=train)","7b2163e2":"sns.jointplot('target_nitrogen_oxides', 'target_carbon_monoxide', data=train)","83c5ac5d":"!pip install pycaret==2.3.1","1913100c":"!pip install shap","56c1776e":"from pycaret.regression import setup, create_model, tune_model, finalize_model, predict_model, interpret_model\nimport shap","a7aab860":"train1 = train.drop(['date_time','target_benzene','target_nitrogen_oxides'], axis=1)\ntrain1.head()","7ad1d00d":"reg1 = setup(data=train1, target='target_carbon_monoxide', session_id=1)","34e9d5a6":"selected1 = create_model(\"lightgbm\")\ntuned1 = tune_model(selected1)","935e03dc":"final1 = finalize_model(tuned1)\npred1 = predict_model(final1, data=test)\ninterpret_model(final1)","0e9f2cae":"train2 = train.drop(['date_time','target_carbon_monoxide','target_nitrogen_oxides'], axis=1)\ntrain2.head()","8e41d90f":"reg2 = setup(data=train2, target='target_benzene', session_id=2)","83e38e37":"selected2 = create_model(\"lightgbm\")\ntuned2 = tune_model(selected2)","6c0f900e":"final2 = finalize_model(tuned2)\npred2 = predict_model(final2, data=test)\ninterpret_model(final2)","babbce61":"train3 = train.drop(['date_time','target_carbon_monoxide','target_benzene'], axis=1)\ntrain3.head()","5a0b2f38":"reg3 = setup(data=train3, target='target_nitrogen_oxides', session_id=3)","31cbfc4b":"selected3 = create_model(\"lightgbm\")\ntuned3 = tune_model(selected3)","a8849d69":"final3 = finalize_model(tuned3)\npred3 = predict_model(final3, data=test)\ninterpret_model(final3)","a06101eb":"sub.target_carbon_monoxide = pred1.Label\nsub.target_benzene = pred2.Label\nsub.target_nitrogen_oxides = pred3.Label\nsub.to_csv('lightgbm_submission.csv',index=False)\nsub","d8a011cf":"### Benzene","57c2192a":"## Overview","43824964":"## Nitrogen oxides","273e084e":"## Predict and check SHAP with LightGBM\nSHAP\u3067\u7279\u5fb4\u91cf\u306e\u91cd\u8981\u5ea6\u3092\u78ba\u8a8d\u3057\u305f\u3044\u306e\u3067\u3001\u3044\u3063\u305f\u3093\u3001PyCaret\u3092\u4f7f\u3063\u3066LightGBM\u3067\u4e88\u6e2c\u3057\u3066SHAP\u3092\u8868\u793a\u3057\u307e\u3059\u3002","d4dfd9c2":"\u30b9\u30b3\u30a2 : **0.30025** ","bfa9ff17":"Carbon monoxide\u3001Benzene\u306fsensor_2\u3001Nitrogen oxides\u306fsensor_5\u304c\u4e88\u6e2c\u3059\u308b\u969b\u306b\u91cd\u8981\u5ea6\u304c\u9ad8\u3044\u3088\u3046\u3067\u3059\u3002  \n\u3053\u308c\u3089\u3092\u30b5\u30d6\u30df\u30c3\u30c8\u3057\u3066\u307f\u307e\u3059\u3002","bdd30942":"# Tabular Playground Series - Jul 2021\n\u307e\u305a\u306f\u3001\u30c7\u30fc\u30bf\u306e\u4e2d\u8eab\u3092\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002\ntarget_carbon_monoxide\u3001target_benzene\u3001target_nitrogen_oxides\u306e3\u7a2e\u985e\u3092\u4e88\u6e2c\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u3002\u30d9\u30f3\u30bc\u30f3\u304c\u5165\u3063\u3066\u3044\u308b\u3053\u3068\u304b\u3089\u3001\u81ea\u52d5\u8eca\u306e\u6392\u6c17\u30ac\u30b9\u306b\u3088\u308b\u5927\u6c17\u6c5a\u67d3\u306e\u4e88\u6e2c\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u308f\u308c\u307e\u3059\u3002","fd806ff6":"### Correlation coefficient\n","e39811ba":"## Correlation","67411a37":"### Carbon monoxide","e572caea":"\u6563\u5e03\u56f3\u3092\u898b\u308b\u3068\u3001\u30bb\u30f3\u30b5\u30fc1\uff5e5\u306f\u3001\u30d9\u30f3\u30bc\u30f3\u3068\u306f\u5f37\u3044\u76f8\u95a2\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u4e00\u9178\u5316\u70ad\u7d20\u3084\u7a92\u7d20\u9178\u5316\u7269\u3068\u306e\u76f8\u95a2\u306f\u5916\u308c\u5024\u304c\u76ee\u7acb\u3061\u307e\u3059\u3002","2f1c3cdd":"### Relationship between benzene and sensor_2\ntarget_benzene\u3068sensor_2\u306f\u3001\u666e\u901a\u306b\u5f0f\u304c\u66f8\u3051\u305d\u3046\u306a\u3050\u3089\u3044\u6b63\u306e\u5f37\u3044\u76f8\u95a2\u304c\u3042\u308a\u307e\u3059\u306d\u3002","bc75764e":"### Relationship between carbon monoxide and nitrogen oxides\ntarget_nitrogen_oxides\u3068target_carbon_monoxide\u306f\u3001\u307e\u3041\u307e\u3041\u306a\u6b63\u306e\u76f8\u95a2\u304c\u3042\u308a\u307e\u3059\u3002\u5916\u308c\u5024\u306f\u898b\u5f53\u305f\u308a\u307e\u305b\u3093\u3002","51fb833c":"### Distribution chart","7dd34fd0":"### Relationship between carbon monoxide and benzene\ntarget_carbon_monoxide\u3068target_benzene\u306f\u5f37\u3081\u306e\u6b63\u306e\u76f8\u95a2\u3067\u3059\u304c\u3001\u5916\u308c\u5024\u304c\u76ee\u7acb\u3061\u307e\u3059\u3002","dec4157a":"\u76f8\u95a2\u3092\u898b\u308b\u3068  \n\u3000\u30fbtarget_benzene\u3068sensor2\u306f\u3001\u5f37\u3044\u6b63\u306e\u76f8\u95a2  \n\u3000\u30fbtarget_carbon_monoxide\u3068target_benzene\u306f\u3001\u5916\u308c\u5024\u3092\u5bfe\u8c61\u5916\u306b\u3059\u308c\u3070\u5f37\u3044\u6b63\u306e\u76f8\u95a2   \n\u3000\u30fbtarget_nitrogen_oxides\u3068target_carbon_monoxide\u306f\u3001\u3084\u3084\u5f37\u3044\u6b63\u306e\u76f8\u95a2  \n\u304c\u3042\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n\u3053\u308c\u3089\u3092\u5927\u304d\u306a\u56f3\u3067\u898b\u3066\u307f\u307e\u3059\u3002"}}