{"cell_type":{"6c345a75":"code","56340be7":"code","fbe309aa":"code","376dce4b":"code","029cab1d":"code","56c163e6":"code","ff4ff84d":"code","516fd28b":"code","326a1ac8":"code","bdce6be6":"code","5af7acd1":"markdown","44456312":"markdown","f283a5d8":"markdown","c8fd6f61":"markdown","e378a30f":"markdown"},"source":{"6c345a75":"import csv\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg\nfrom PIL import Image\nimport os\nimport numpy as np\nimport pandas as pd\nfrom sklearn.manifold import TSNE\nfrom sklearn.preprocessing import Normalizer\nfrom matplotlib.offsetbox import AnnotationBbox, OffsetImage\nfrom sklearn.decomposition import TruncatedSVD","56340be7":"def load_data(path):\n    data = {}\n    with open(path) as f:\n        header = True\n        headers = []\n        for cols in csv.reader(f):\n            if header:\n                header = False\n                headers = cols.copy()\n                for h in headers: data[h] = []\n                continue\n            for n, cols in enumerate(cols):\n                data[headers[n]].append(cols)\n    return data\n\ndef load_icons(path):\n    icons = {}\n    files = os.listdir(path)\n    for file in files:\n        icons[(file[:-4]).upper()] = (Image.open(path + \"\/\" + file)).resize((100, 100))\n\n    return icons","fbe309aa":"operators = load_data(\"..\/input\/tom-clancys-r6-operators-and-weapons\/operators.csv\")\nweapons = load_data(\"..\/input\/tom-clancys-r6-operators-and-weapons\/weapons.csv\")\nicons = load_icons(\"..\/input\/r6-operator-icons\")","376dce4b":"weapons_df = pd.DataFrame(weapons).drop([\"Operator\", \"Organization\", \"Damage Suppressed\", \"Class\"], axis=1)\nweapons_df = pd.get_dummies(weapons_df, columns=[\"Type\", \"Role\", \"Suppressor\", \"ACOG\", \"Range\"])","029cab1d":"def get_weapon_info(weapon_name, weapons):\n    res = weapons_df[weapons_df.Name==weapon_name].drop(\"Name\", axis=1).values.tolist()\n    if len(res)>0:\n        return res[0]\n    else:\n        return [0]*(len(weapons_df.columns)-1)\n\n# used when an operator has less than 3 primaries or less than two secondaries (average)\ndef merge_weapon_features(f1, f2):\n    return ((np.array(f1, dtype=float) + np.array(f2, dtype=float)) \/ 2).tolist()\n","56c163e6":"# fixing rate of fire\nweapons_df.ROF.replace(\"Semi-Auto\", 1, inplace=True)\nweapons_df.ROF.replace(\"Pump\", 1, inplace=True)\n","ff4ff84d":"pt_features = []\nfor i in range(len(operators[\"Name\"])):\n    features = []\n    features.append(operators[\"Armor\"][i])\n    features.append(operators[\"Speed\"][i])\n    features.append(operators[\"Difficulty\"][i])\n\n    features.extend(get_weapon_info(operators[\"Primary1\"][i], weapons))\n    if operators[\"Primary2\"][i] == \"\":\n        features.extend(get_weapon_info(operators[\"Primary1\"][i], weapons))\n        features.extend(get_weapon_info(operators[\"Primary1\"][i], weapons))\n    else:\n        features.extend(get_weapon_info(operators[\"Primary2\"][i], weapons))\n        if operators[\"Primary3\"][i] == \"\":\n            f1 = get_weapon_info(operators[\"Primary1\"][i], weapons)\n            f2 = get_weapon_info(operators[\"Primary2\"][i], weapons)\n            features.extend(merge_weapon_features(f1, f2))\n        else:\n            features.extend(get_weapon_info(operators[\"Primary3\"][i], weapons))\n\n    features.extend(get_weapon_info(operators[\"Secondary1\"][i], weapons))\n    if operators[\"Secondary2\"][i] == \"\":\n        features.extend(get_weapon_info(operators[\"Secondary1\"][i], weapons))\n    else:\n        features.extend(get_weapon_info(operators[\"Secondary2\"][i], weapons))\n\n    pt_features.append(np.array(features, dtype=float))","516fd28b":"tsne = TSNE(n_components=2, perplexity=10, verbose=1, init='random', random_state=42)\npts = tsne.fit_transform(pt_features)","326a1ac8":"fig, ax = plt.subplots(figsize=(15, 15))\nax.scatter(pts[:, 0], pts[:, 1])\n\nfor n, pt in enumerate(pts):\n    img = icons[operators[\"Name\"][n]]\n    ab = AnnotationBbox(OffsetImage(img, zoom=0.6), (pt[0], pt[1]), frameon=False)\n    ax.add_artist(ab)\n\nplt.grid()\nplt.show()\n","bdce6be6":"with open(\"results.csv\", mode='w', newline='') as file:\n    writer = csv.writer(file, delimiter=',')\n    if len(pts[0]) == 2:\n        writer.writerow([\"Name\", 'X', 'Y'])\n        for label, pt in zip(operators, pts):\n            writer.writerow([label, pt[0], pt[1]])\n            \n    if len(pts[0]) == 3:\n        writer.writerow([\"Name\", 'X', 'Y', 'Z'])\n        for label, pt in zip(operators, pts):\n            writer.writerow([label, pt[0], pt[1], pt[2]])","5af7acd1":"One hot encoding for the categorical features","44456312":"TSNE fitting and transforming","f283a5d8":"Loading operators, weapons and icons data<br>\nIcons can be found [here](https:\/\/marcopixel.eu\/r6-operatoricons\/) under CC-A 4.0 (credits: [@marcopixel](http:\/\/marcopixel.eu\/), [@dtSniper](https:\/\/twitter.com\/sniperdt), [@joeyfjj\n](https:\/\/twitter.com\/joeyfjj))","c8fd6f61":"Building features","e378a30f":"Dump results to file"}}