{"cell_type":{"a7f36ba6":"code","fad6aa79":"code","ff8c1363":"code","bb098cb4":"code","770cb05e":"code","9deaffa0":"code","ca325662":"code","be4f9313":"code","67096505":"code","f301ceec":"code","6a822d4d":"code","42df626b":"code","10bf8092":"code","fd3120a6":"code","f05ecf41":"code","68374e1a":"code","257c8205":"code","44706527":"code","b8e4ecb7":"code","072eccd2":"code","f1f50766":"markdown","25e97f18":"markdown","d4c7feb9":"markdown","34fbaacb":"markdown","7d473bf3":"markdown","7b8796b6":"markdown","58385bb3":"markdown","61b50627":"markdown","ff35c5e1":"markdown","5d59a6f8":"markdown"},"source":{"a7f36ba6":"import pandas as pd\r\nimport numpy as np\r\nimport matplotlib.pyplot as plt\r\nimport seaborn as sns\r\nprint('Priyatama is ready!')","fad6aa79":"df = pd.read_csv('..\/input\/mines-vs-rocks\/sonar.all-data.csv', header=None)\r\ndf.head()","ff8c1363":"df.describe()","bb098cb4":"df[60].value_counts()","770cb05e":"df.select_dtypes(include='object')","9deaffa0":"X = df.drop(60, axis=1)\ny=df[60]","ca325662":"from sklearn.model_selection import train_test_split\r\nX_train, X_valid, y_train, y_valid = train_test_split(X, y, test_size=0.35, random_state=21)","be4f9313":"from sklearn.ensemble import RandomForestClassifier\r\nfrom sklearn.metrics import f1_score,confusion_matrix\r\nfrom sklearn.metrics import accuracy_score\r\n\r\n#random forest classifier with n_estimators=10 (default)\r\nclf_rf = RandomForestClassifier(random_state=43)      \r\nclr_rf = clf_rf.fit(X_train,y_train)\r\n\r\nac = accuracy_score(y_valid,clf_rf.predict(X_valid))\r\nprint('Accuracy is: ',round(ac*100), ' %')\r\ncm = confusion_matrix(y_valid,clf_rf.predict(X_valid))\r\nsns.heatmap(cm,annot=True,fmt=\"d\")","67096505":"from sklearn.model_selection import cross_val_predict\r\nclf_rf = RandomForestClassifier(random_state=43)      \r\nval_preds = cross_val_predict(clr_rf,X,y, cv=5)\r\nac_2 = accuracy_score(y,val_preds)\r\nprint('Accuracy is: ',round(ac_2*100), ' %')\r\ncm_2 = confusion_matrix(y,val_preds)\r\nsns.heatmap(cm_2,annot=True,fmt=\"d\")","f301ceec":"clf_rf_3 = RandomForestClassifier(n_estimators=7,random_state=43)      \r\nval_preds_3 = cross_val_predict(clf_rf_3,X,y, cv=5)\r\nac_3 = accuracy_score(y,val_preds_3)\r\nprint('Accuracy is: ',round(ac_3*100), ' %')\r\ncm_3 = confusion_matrix(y,val_preds_3)\r\nsns.heatmap(cm_3,annot=True,fmt=\"d\")","6a822d4d":"from sklearn.feature_selection import RFE\r\nclf_rf_4 = RandomForestClassifier()      \r\nrfe = RFE(estimator=clf_rf_4, n_features_to_select=5, step=1)\r\nrfe = rfe.fit(X_train, y_train)\r\nprint('Chosen best 5 feature by rfe:',X_train.columns[rfe.support_])","42df626b":"rfe_col=X_train.columns[rfe.support_].values.tolist()","10bf8092":"X2 = X.filter(rfe_col)\r\ny2 = y.copy()","fd3120a6":"clf_rf_4 = RandomForestClassifier(random_state=43)      \r\nval_preds_4 = cross_val_predict(clf_rf_4,X2,y2, cv=5)\r\nac_4 = accuracy_score(y2,val_preds_4)\r\nprint('Accuracy is: ',round(ac_4*100), ' %')\r\ncm_4 = confusion_matrix(y2,val_preds_4)\r\nsns.heatmap(cm_4,annot=True,fmt=\"d\")","f05ecf41":"from sklearn.feature_selection import RFECV\r\n\r\n# The \"accuracy\" scoring is proportional to the number of correct classifications\r\nclf_rf_5 = RandomForestClassifier(n_estimators=7) \r\nrfecv = RFECV(estimator=clf_rf_5, step=1, cv=10,scoring='accuracy')\r\nrfecv = rfecv.fit(X, y)\r\n\r\nprint('Optimal number of features :', rfecv.n_features_)\r\nprint('Best features :', X.columns[rfecv.support_])","68374e1a":"# Plot number of features VS. cross-validation scores\r\nplt.figure()\r\nplt.xlabel(\"Number of features selected\")\r\nplt.ylabel(\"Cross validation score of number of selected features\")\r\nplt.plot(range(1, len(rfecv.grid_scores_) + 1), rfecv.grid_scores_)\r\nplt.show()","257c8205":"fil_col=X.columns[rfecv.support_].values.tolist()","44706527":"X3 = X.filter(fil_col)\r\ny3 = y.copy()","b8e4ecb7":"X3_train, X3_valid, y3_train, y3_valid = train_test_split(X3, y3, test_size=0.33, random_state=21)","072eccd2":"clf_rf_6 = RandomForestClassifier(random_state=43)\r\nclf_rf_6 = clf_rf_6.fit(X3_train, y3_train)\r\nval_preds_6 = clf_rf_6.predict(X3_valid)\r\nac_6 = accuracy_score(y3_valid,val_preds_6)\r\nprint('Accuracy is: ',round(ac_6*100), ' %')\r\ncm_6 = confusion_matrix(y3_valid,val_preds_6)\r\nsns.heatmap(cm_6,annot=True,fmt=\"d\")","f1f50766":"## 4.2. Cross validation accuracy using Random Forest Classifier.","25e97f18":"## 4.3. Recursive feature elimination (RFE) with random forest.","d4c7feb9":"# 1. Environment Setup.","34fbaacb":"## We acheived maximum of 81% accuracy using Random Forest Classifier & Recursive feature elimination with cross validation.","7d473bf3":"# 4. Model Designing.","7b8796b6":"## 4.1. Accuracy score using Random Forest Classifier.","58385bb3":"# 5. Final Model & Conclusion.","61b50627":"## 4.4. Recursive feature elimination with cross validation and random forest classification","ff35c5e1":"# 3. Exploring the dataset.","5d59a6f8":"# 2. Load the dataset."}}