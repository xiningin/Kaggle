{"cell_type":{"07d1f2f7":"code","b2e62dad":"code","c6378e7d":"code","a48966ec":"code","ecdc14be":"code","a6f2f5d9":"code","31f4e802":"code","b5008d26":"code","13174fad":"code","4be49bf5":"code","d51d2175":"code","2842a6cd":"code","ff1cd7a1":"code","a441d2f6":"code","9c0ab7e5":"code","6926a7fd":"code","58f82a7c":"code","c5db782e":"code","91efc85f":"code","75f59f3b":"code","ca3a6610":"code","d82aded5":"code","3ad05f69":"code","f5604d1b":"code","f40627c5":"code","482b20f7":"code","5e2d6683":"code","e6e817e0":"code","a87e5aaa":"code","11a6f68b":"code","cf4247b2":"code","6f4e4447":"code","08652950":"code","c0eb1b50":"code","9a0457c6":"code","6faf333d":"code","5552f281":"code","59c95476":"code","49d1728d":"code","4d5b8ae4":"code","61c9a6a3":"code","0bd01d94":"code","2395c500":"code","ceb5e2cb":"code","2499e087":"code","d8cc8264":"code","01a30422":"code","038eb4f3":"code","7251938f":"code","69e35a34":"code","8e7d5e0d":"code","92ee1d40":"code","7e1cdb74":"code","83ecf203":"code","cb11b093":"code","345da1da":"code","1fec30cc":"markdown","5ff1f1a5":"markdown","5f6cabf5":"markdown","b1f99efa":"markdown","0d08535d":"markdown","7adbc2e8":"markdown","6c70e0b6":"markdown","93e3b13c":"markdown","bed0f427":"markdown","8b6d6e11":"markdown","e84c7d85":"markdown","e266acf7":"markdown","eb47df71":"markdown","54722a32":"markdown","c5deda11":"markdown","d4c370aa":"markdown","f3ca5fbe":"markdown","65dbff60":"markdown","8fa90dc2":"markdown","d98ca092":"markdown","6a62b533":"markdown","45efeb3f":"markdown","66b7a638":"markdown","69f945fd":"markdown","1ec69f3c":"markdown","8e57fed9":"markdown","f6a3fbf0":"markdown","b415ade5":"markdown","1277ae2c":"markdown","c6aab96e":"markdown","368f707b":"markdown","8a7281ea":"markdown","bf328add":"markdown","c7df4f33":"markdown","1f52a6b9":"markdown","3bc191d2":"markdown","4bbcb529":"markdown","422df5f9":"markdown","1b8c445a":"markdown","11083dac":"markdown","0027e481":"markdown","01ba4e58":"markdown","62c64042":"markdown","62a52dce":"markdown","bcb70fc9":"markdown","db5d701d":"markdown","d47e39de":"markdown","3c43c056":"markdown","4a92c452":"markdown","15e72397":"markdown","5784122f":"markdown","bd910a40":"markdown","f5130559":"markdown","4f99e8ff":"markdown","0f75f106":"markdown","f9cc83de":"markdown","692dce3c":"markdown","6361796f":"markdown","c94a9aeb":"markdown","1fda9d45":"markdown","a5daa97e":"markdown","c055b419":"markdown"},"source":{"07d1f2f7":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport random as r\nimport warnings\nwarnings.filterwarnings('ignore')","b2e62dad":"kills = pd.read_csv('..\/input\/pubg-match-deaths\/deaths\/kill_match_stats_final_0.csv')","c6378e7d":"kills = kills.dropna(axis = 0, how = \"any\") #we will drop all rows with NA values","a48966ec":"kills.head()","ecdc14be":"kills.info()","a6f2f5d9":"kills[\"kill_distance\"] = ((kills[\"killer_position_x\"] - kills[\"victim_position_x\"]) ** 2 + (kills[\"killer_position_y\"] - kills[\"victim_position_y\"]) ** 2) ** (1\/2)","31f4e802":"kills[\"place_diff\"] = kills[\"victim_placement\"] - kills[\"killer_placement\"]","b5008d26":"winners = dict(kills[kills[\"killer_placement\"] == 1][[\"killer_name\", \"match_id\"]].groupby(\"match_id\").size())","13174fad":"kills[\"winner_kills\"] = kills[\"match_id\"].map(winners, kills[\"match_id\"])","4be49bf5":"kills.head()","d51d2175":"def remove_outliers(kills, var):\n    lower_bound = np.quantile(kills[var], 0.25) - (1.5 * (np.quantile(kills[var], 0.75) - np.quantile(kills[var], 0.25)))\n    upper_bound = np.quantile(kills[var], 0.75) + (1.5 * (np.quantile(kills[var], 0.75) - np.quantile(kills[var], 0.25)))\n    kills = kills[(kills[var] >= lower_bound) & (kills[var] <= upper_bound)]\n    return kills\n\ndef distribution_cont(kills, var):\n    if var == \"kill_distance\":\n        kills = remove_outliers(kills, var)\n    plt.hist(kills[var])\n    plt.axvline(x = np.mean(kills[var]), c = \"r\")\n    plt.text(0.7, 0.9, f\"Mean: {round(np.mean(kills[var]), 2)}\", transform = plt.gca().transAxes)\n    plt.xlabel(f\"{var}\")\n    plt.ylabel(\"Count\")\n    plt.title(f\"Distribution of {var}\")\n    plt.show()\n    \ndef basic_plot(kills, var):\n    if var == \"killed_by\":\n        grouped = kills.groupby(var).size().sort_values(ascending = False).head(10)\n        plt.xticks(rotation = 90)\n    else:\n        grouped = kills.groupby(var).size().sort_values(ascending = False)\n    plt.bar(grouped.index.values, grouped.values)\n    plt.title(f\"{var} Distribution\")\n    plt.show()","2842a6cd":"[distribution_cont(kills, i) for i in [\"killer_placement\", \"victim_placement\", \"place_diff\"]]","ff1cd7a1":"[distribution_cont(kills, i) for i in [\"killer_position_x\", \"killer_position_y\", \"victim_position_x\", \"victim_position_y\", \"kill_distance\"]]","a441d2f6":"[distribution_cont(kills, i) for i in [\"time\"]]","9c0ab7e5":"[distribution_cont(kills, i) for i in [\"winner_kills\"]]","6926a7fd":"basic_plot(kills, \"map\")","58f82a7c":"basic_plot(kills, \"killed_by\")","c5db782e":"erangel = kills[kills[\"map\"] == \"ERANGEL\"]","91efc85f":"erangel_sample = erangel.sample(n = 5, random_state = 1)","75f59f3b":"img = plt.imread(\"..\/input\/pubg-match-deaths\/erangel.jpg\")\nplt.subplots(figsize = (12,12))\nplt.imshow(img,aspect='auto', extent=[0, 800000, 0, 800000])\nplt.scatter(erangel_sample[\"killer_position_x\"], erangel_sample[\"killer_position_y\"], c = \"r\", s = 100)\nplt.scatter(erangel_sample[\"victim_position_x\"], erangel_sample[\"victim_position_y\"], c = \"g\", s = 100)\nplt.legend([\"Killer\", \"Victim\"], loc = \"upper right\")\nplt.show()","ca3a6610":"miramar = kills[kills[\"map\"] == \"MIRAMAR\"]","d82aded5":"miramar_sample = miramar.sample(n = 5, random_state = 1)","3ad05f69":"img = plt.imread(\"..\/input\/pubg-match-deaths\/miramar.jpg\")\nplt.subplots(figsize = (12,12))\nplt.imshow(img, aspect='auto', extent=[0, 800000, 0, 800000])\nplt.scatter(miramar_sample[\"killer_position_x\"], miramar_sample[\"killer_position_y\"], c = \"r\", s = 100)\nplt.scatter(miramar_sample[\"victim_position_x\"], miramar_sample[\"victim_position_y\"], c = \"g\", s = 100)\nplt.legend([\"Killer\", \"Victim\"], loc = \"upper right\")\nplt.show()","f5604d1b":"def get_player_movement(kills, match_id, player_name):\n    game = kills[kills[\"match_id\"] == match_id]\n    player = game[(game[\"killer_name\"] == player_name) | (game[\"victim_name\"] == player_name)].sort_values(by = \"time\")\n    m = player.iloc[0][\"map\"]\n    place = int(player.iloc[0][\"killer_placement\"])\n    kills = len(list(player[player[\"killer_name\"] == player_name][\"killer_name\"]))\n    killer_name = player.iloc[-1][\"killer_name\"]\n    killed_by = player.iloc[-1][\"killed_by\"]\n    \n    if m == \"ERANGEL\":\n        img = plt.imread(\"..\/input\/pubg-match-deaths\/erangel.jpg\")\n    else:\n        img = plt.imread(\"..\/input\/pubg-match-deaths\/miramar.jpg\")\n    plt.subplots(figsize = (12,12))\n    plt.imshow(img, aspect='auto', extent=[0, 800000, 0, 800000])\n    plt.scatter(player[\"killer_position_x\"].iloc[0:-2], player[\"killer_position_y\"].iloc[0:-2], c = \"g\", s = 100)\n    plt.scatter(player[\"victim_position_x\"].iloc[-1], player[\"victim_position_y\"].iloc[-1], c = \"r\", s = 100)\n    if place != 1:\n        plt.title(f\"{player_name}'s Game (Place: #{place}, Kills: {kills}, Killed by {killer_name} with {killed_by})\")\n        plt.legend([\"Kill\", \"Point of Death\"], loc = \"upper right\")\n    else:\n        plt.title(f\"{player_name}'s Game (Place: #{place}, Kills: {kills})\")\n        plt.legend([\"Kill\", \"Last Kill\"], loc = \"upper right\")","f40627c5":"rand_match = kills.iloc[r.randint(0, 11908315)]","482b20f7":"get_player_movement(kills, rand_match[\"match_id\"], rand_match[\"killer_name\"])","5e2d6683":"rand_match2 = kills.iloc[r.randint(0, 11908315)]","e6e817e0":"get_player_movement(kills, rand_match2[\"match_id\"], rand_match2[\"killer_name\"])","a87e5aaa":"rand_match3 = kills.iloc[r.randint(0, 11908315)]","11a6f68b":"get_player_movement(kills, rand_match3[\"match_id\"], rand_match3[\"killer_name\"])","cf4247b2":"distances = remove_outliers(kills, \"kill_distance\")","6f4e4447":"sns.violinplot(data = distances, y = \"kill_distance\")\nplt.title(\"Kill Distance Distribution\")\nplt.show()","08652950":"def prop_list(lst):\n    weapons = list(lst)\n    weapon_props = []\n    distinct_weapons = list(set(weapons))\n    for i in distinct_weapons:\n        counter = 0\n        for j in weapons:\n            if i == j:\n                counter += 1\n        weapon_props.append(counter \/ len(weapons))\n    return dict(zip(distinct_weapons, weapon_props))","c0eb1b50":"distances[\"weapon_prop\"] = distances[\"killed_by\"].map(prop_list(distances[\"killed_by\"]), distances[\"killed_by\"])","9a0457c6":"def get_weapons_range(distances, perc_low, perc_high):\n    lower_quantile = np.quantile(distances[\"kill_distance\"], perc_low)\n    upper_quantile = np.quantile(distances[\"kill_distance\"], perc_high)\n    distances2 = distances[(distances[\"kill_distance\"] >= lower_quantile) & (distances[\"kill_distance\"] <= upper_quantile)]\n    \n    weapon_counts = distances2.groupby(\"killed_by\").size().sort_values(ascending = False).head(10)\n    \n    distances2[\"weapon_prop_filtered\"] = distances2[\"killed_by\"].map(prop_list(distances2[\"killed_by\"]), distances2[\"killed_by\"])\n    distances2[\"conditional_prob\"] = (distances2[\"weapon_prop_filtered\"] - distances2[\"weapon_prop\"])\n    distinct_props = distances2[[\"killed_by\", \"conditional_prob\"]].drop_duplicates().sort_values(by = \"conditional_prob\", ascending = False).head(10)\n    \n    plt.subplots(figsize = (10,6))\n    plt.subplot(1,2,1)\n    sns.barplot(weapon_counts.index.values, weapon_counts.values)\n    plt.xticks(rotation = 90)\n    plt.title(f\"By Frequency ({perc_low} to {perc_high} Percentile)\")\n    plt.subplot(1,2,2)\n    sns.barplot(distinct_props[\"killed_by\"], distinct_props[\"conditional_prob\"])\n    plt.xticks(rotation = 90)\n    plt.title(f\"By Proportion Diff ({perc_low} to {perc_high} Percentile)\")\n    plt.xlabel(None)\n    plt.ylabel(None)\n    plt.show()    ","6faf333d":"get_weapons_range(distances, 0, 0.05)","5552f281":"get_weapons_range(distances, 0.05, 0.25)","59c95476":"get_weapons_range(distances, 0.25, 0.75)","49d1728d":"get_weapons_range(distances, 0.75, 1)","4d5b8ae4":"kills.head()","61c9a6a3":"sns.violinplot(data = kills, y = \"time\")\nplt.title(\"Time Distribution\")\nplt.show()","0bd01d94":"def weapons_time(kills, min_time, max_time = max(list(kills[\"time\"]))):\n    \n    time_range = kills[(kills[\"time\"] >= min_time) & (kills[\"time\"] <= max_time)]\n    grouped_time = time_range.groupby(\"killed_by\").size().sort_values(ascending = False)\n    top_10 = grouped_time.head(10)\n    deaths = sum(list(grouped_time.values))\n    \n    sns.barplot(top_10.index.values, top_10.values)\n    plt.title(f\"Top 10 Weapons ({min_time} to {max_time} sec.); {deaths} Total Deaths\")\n    plt.xticks(rotation = 90)\n    plt.show()","2395c500":"weapons_time(kills, 0, 60)","ceb5e2cb":"weapons_time(kills, 0, 180)","2499e087":"weapons_time(kills, np.quantile(kills[\"time\"], 0.25), np.quantile(kills[\"time\"], 0.75))","d8cc8264":"weapons_time(kills, np.quantile(kills[\"time\"], 0.9))","01a30422":"final_kills = kills[(kills[\"killer_placement\"] == 1) & (kills[\"victim_placement\"] == 2)]","038eb4f3":"grouped_final_kills = final_kills.groupby(\"killed_by\").size().sort_values(ascending = False).head(10)","7251938f":"sns.barplot(grouped_final_kills.index.values, grouped_final_kills.values)\nplt.xticks(rotation = 90)\nplt.title(\"Top 10 Weapons For Final Kills\")\nplt.show()","69e35a34":"inc_wins = kills","8e7d5e0d":"place = prop_list(inc_wins[\"killer_placement\"])","92ee1d40":"inc_wins[\"kill_prop\"] = inc_wins[\"killer_placement\"].map(place, inc_wins[\"killer_placement\"])","7e1cdb74":"place_df = inc_wins[[\"killer_placement\", \"kill_prop\"]].drop_duplicates().sort_values(by = \"killer_placement\", ascending = False)","83ecf203":"plt.scatter(place_df[\"kill_prop\"], place_df[\"killer_placement\"])\nplt.plot(place_df[\"kill_prop\"], place_df[\"killer_placement\"])\nplt.xlabel(\"Proportion of Kills\")\nplt.ylabel(\"Placement (1-100)\")\nplt.title(\"Overall Proportion of Kills by Placement\")\nplt.show()","cb11b093":"miramar_wins = inc_wins[inc_wins[\"map\"] == \"MIRAMAR\"]\nerangel_wins = inc_wins[inc_wins[\"map\"] == \"ERANGEL\"]\nplace_m = prop_list(miramar_wins[\"killer_placement\"])\nplace_e = prop_list(erangel_wins[\"killer_placement\"])\nmiramar_wins[\"kill_prop\"] = miramar_wins[\"killer_placement\"].map(place_m, miramar_wins[\"killer_placement\"])\nerangel_wins[\"kill_prop\"] = erangel_wins[\"killer_placement\"].map(place_e, erangel_wins[\"killer_placement\"])\nplace_df_m = miramar_wins[[\"killer_placement\", \"kill_prop\"]].drop_duplicates().sort_values(by = \"killer_placement\", ascending = False)\nplace_df_e = erangel_wins[[\"killer_placement\", \"kill_prop\"]].drop_duplicates().sort_values(by = \"killer_placement\", ascending = False)","345da1da":"plt.subplot(1,2,1)\nplt.scatter(place_df_e[\"kill_prop\"], place_df_e[\"killer_placement\"])\nplt.plot(place_df_e[\"kill_prop\"], place_df_e[\"killer_placement\"])\nplt.xlabel(\"Proportion of Kills\")\nplt.title(\"Erangel\")\nplt.subplot(1,2,2)\nplt.scatter(place_df_m[\"kill_prop\"], place_df_m[\"killer_placement\"])\nplt.plot(place_df_m[\"kill_prop\"], place_df_m[\"killer_placement\"])\nplt.xlabel(\"Proportion of Kills\")\nplt.title(\"Miramar\")\nplt.show()","1fec30cc":"This question may seem self-explanatory as killing other players is positive, and being the last team standing is required to win the game.  However, it might not be that simple.  Many players in PUBG and similar video games try \"camping\", a strategy that involves hiding while other players take eachother out and lose health.  Campers usually stay in one spot, so they usually don't interact with many players.  It is a feasible idea that many players who play it safe ultimately come out on top, while many other players who are reckless and achieve many kills get themselves killed in the process.","5ff1f1a5":"Killers are very often eliminated shortly after their victims (or sometimes they go on to win the game).","5f6cabf5":"### Maps","b1f99efa":"Now, let's track a given single player's journey through the game until their victory or point of death.  The function will take a player with atleast one kill as a parameter, as well as a match id to prevent different games with the same player from overlapping.","0d08535d":"This variable will tell us the amount of kills achieved by the winner(s) of each game (1st place finishers), and will be constant along each match id.  There can multiple players in 1st place due to many of the games being team matches, so these kills are added together.","7adbc2e8":"#### The End of the Game","6c70e0b6":"This function will graph the 10 most common weapons within a given time range.","93e3b13c":"## Basic Distributions","bed0f427":"### Feature Engineering","8b6d6e11":"* Very short distance weapons: punching, grenades, cars\n* Short distance weapons: S1897, S686, S12K, Micro UZI\n* Medium distance weapons: M416, UMP9, SCAR-L, AKM\n* Long distance weapons: Kar98k, Mini 14, SKS\n* Overall common weapons:  AKM, SCAR-L, M416, M16A4, UMP9 (Also depicted in previous section)\n* \"Down and Out\" is not a weapon, though it is the most common cause of death overall, especially at medium and long distance ranges.\n* The most common overall weapons are unsurprisingly medium distance weapons, as this covers the typical distance range of a kill.","e84c7d85":"#### Short Distance Kills","e266acf7":"This section will help us stategize which weapons a player should use when possible depending on the distance from their enemy.  We will get rid of outliers, many of which are likely due to glitches in the game.  \n\n","eb47df71":"The time variable can only tell us so much about the later stages of the game because different games have various lengths.  This plot will give us an idea of the best weapons in the game.  They must be the best because players tend to accumlate better weapons as the game goes on and they kill more people.  The weapons used by 1st place finishers to take out 2nd place finishers must be quite powerful.","54722a32":"### Placement","c5deda11":"### Miramar","d4c370aa":"We can answer this question using our prop_list function from before, as each row represents a kill.","f3ca5fbe":"According to this very consistent pattern, more kills do strongly correlate with a higher placement, therefore camping is usually a bad strategy.  1st place finishers average twice the amount of kills as 2nd place finishers.  Interestingly, there exists a slight imperfection in the exponential pattern between about 10th place and 30th place.","65dbff60":"There are many additional variables that can be extracted here.","8fa90dc2":"### Position and Distance","d98ca092":"## Which Weapons are Most Common From Different Distances?","6a62b533":"## To be continued? :)","45efeb3f":"Player Unknown's Battlegrounds (PUBG), is a first person shooter game where the goal is to be the last player standing.  You are placed on a giant circular map that shrinks as the game goes on, and you must find weapons, armor, and other supplies in order to kill other players \/ teams and survive.  More can be read about the game [here](https:\/\/en.wikipedia.org\/wiki\/PlayerUnknown's_Battlegrounds#Mobile_versions).  In this notebook, I will be analyzing kill statistics in order to learn more about the game and make recommendations on winning strategies.  Leave a like and\/or comment if you enjoy! :)","66b7a638":"In this section, we will plot sample points of killers and victims on both the Erangel and Miramar maps.  Points may completely overlap due to very close range kills.  This will help us understand the setting of the game, as we can visualize typical distances of kills.","69f945fd":"## Which Weapons are Most Common in Different Points of the Game?","1ec69f3c":"### Winner Kills","8e57fed9":"This section will be similar to the previous one, though we will compare weapon use to the time variable instead of the distance variable.","f6a3fbf0":"### Weapons \/ Causes of Death","b415ade5":"Outliers were removed from the kill distance data.","1277ae2c":"We can use the pythagorean formula to get the distance between each killer and victim.","c6aab96e":"First, a closer look at the distribution of time (in seconds), which is also skewed towards lower time values.  This is due to every game starting at 0 and counting up.","368f707b":"### Erangel","8a7281ea":"#### Insights","bf328add":"## Do More Kills Improve Winning Chances?","c7df4f33":"#### Winner Kills","1f52a6b9":"#### Medium Distance Kills","3bc191d2":"Note that this is a cumulative variable in seconds.","4bbcb529":"#### The First Minute","422df5f9":"## Preparing the Data","1b8c445a":"#### Kill Distance","11083dac":"Erangel is a far more common map than Miramar.","0027e481":"We now have data that can be analyzed.","01ba4e58":"There is no significant difference here.","62c64042":"### Player Movements","62a52dce":"#### Very Short Distance Kills","bcb70fc9":"## Mapping the Game","db5d701d":"### Time","d47e39de":"We have 5 total datasets that will later be concatinated, but for now, we will use this single dataset as a sample to avoid taking up a lot of memory.  This is approximately 20% of the data.","3c43c056":"* Beginning of Game Weapons: Punching, M16A4, S1897\n* Middle of Game Weapons: M16, M16A4, AKM, SCAR-L\n* End of Game Weapons: M16, SCAR-L\n* The best weapons in the game are likely M16 and SCAR-L","4a92c452":"This variable will tell us the difference in placement between the killer and victim.  There are up to 100 players a game, so placement can range from 1st place to 100th place.\n\nNote: This value can be negative because players are placed as a team.  For example, if player x kills player y, but player x's entire team is eliminated before player y's entire team, the placement difference for the given row will be negative.","15e72397":"#### The Middle of the Game","5784122f":"There are hardly any deaths in the first minute of the game within the data, so lets expand our search to the first 3 minutes.","bd910a40":"#### Placement Difference","f5130559":"#### Insights","4f99e8ff":"There are too many weapons\/causes of death to represent on one graph, so only the 10 most common are shown.","0f75f106":"#### Long Distance Kills","f9cc83de":"# PUBG Kills Analysis Notebook ","692dce3c":"The average winning team kills about 10 players.","6361796f":"#### The First 3 Minutes","c94a9aeb":"We will now create a function that plots the most lethal weapons in a given percentile range.  The first plot will show the raw frequency of weapons used within the range.  The second plot will show the difference between the overall proportion (all percentiles) of weapon usage and proportion for only the given percentile range.  \n\nNote: The second plot is necessary as the first plot may reflect many weapons \/ causes of death that are common among the entirety of the data but not necessarily specific to the given percentile range.  The second plot tells us relative percentage which gives us an idea of the exclusively short, medium, or long range weapons.","1fda9d45":"Here is another look at our kill distance distribution as a violin plot.  Most kills are very short distance, so these deaths will be split into two parts (very short distance and short distance).","a5daa97e":"### On Which Map is This Effect Greatest?","c055b419":"### The Most Common Weapons on the Final Kills"}}