{"cell_type":{"e7e6d947":"code","7220b75d":"code","4861d89e":"code","a9bab255":"code","2f491667":"code","bbb84b53":"code","05c8fa99":"code","7f03d560":"code","38f65fdc":"code","5e8cdbad":"code","6e3daa68":"code","245f24a7":"code","9a9d3a25":"code","3aa4b470":"code","41aebbb3":"code","d4bea3c2":"code","93e9dcf0":"code","c08de738":"code","7f5ecc8f":"code","011501f7":"code","6eb55df0":"code","ab15631b":"code","c0435c8b":"code","2287abff":"code","1bdc9e27":"code","f8cb37f8":"code","17fdadf6":"code","8f7efb05":"code","2305bc68":"code","03caaf36":"code","335fc1de":"code","bfa47e6f":"code","2096d8eb":"code","daccc116":"code","665faecd":"code","cfc08bc8":"code","84e276b5":"code","f0070696":"code","51b27c2e":"code","f10d0e27":"code","3962c755":"code","c3a9f3a6":"code","99a57096":"code","ff8daded":"code","7457566f":"code","9d590c26":"code","95278689":"markdown","a79f3088":"markdown","d4322610":"markdown","b16f82fe":"markdown","e1eb1a52":"markdown","97ba7748":"markdown","68e7f08c":"markdown","165de6b2":"markdown","c32fdc5c":"markdown","a2fcb9ef":"markdown","8658540b":"markdown","c93df09d":"markdown","e1138742":"markdown","91959862":"markdown","919e4137":"markdown","d75b72de":"markdown","fbba7be9":"markdown","36c7fa36":"markdown","13aad6a1":"markdown","da479493":"markdown","057b880c":"markdown","d1d0f710":"markdown","054d8899":"markdown","1b921584":"markdown","9c244fdc":"markdown","118301bd":"markdown","a13f4c98":"markdown","1c51e557":"markdown","6892a551":"markdown","7c578c7a":"markdown","aaf8da7d":"markdown","018682ff":"markdown","7cfd0ec2":"markdown","f5efbb60":"markdown","ae9ffe82":"markdown","109aff0b":"markdown","e3f169ec":"markdown","03042444":"markdown","e50c2fcf":"markdown","ccc97d71":"markdown","4e6e7067":"markdown"},"source":{"e7e6d947":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","7220b75d":"pip install chart_studio","4861d89e":"#importing essential libraries\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport warnings\nimport plotly.express as px\nimport plotly.io as pio\nwarnings.filterwarnings(\"ignore\")","a9bab255":"import plotly.graph_objects as go","2f491667":"df= pd.read_csv(\"..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv\")","bbb84b53":"df.head()","05c8fa99":"df.describe()","7f03d560":"df.isnull().sum()","38f65fdc":"df.shape","5e8cdbad":"plt.figure(figsize= (15,6))\nsns.set_style(\"darkgrid\")\nsns.heatmap(df.corr(),annot= True)\nplt.show()","6e3daa68":"ax= px.histogram(df,x= \"age\", template= \"plotly_dark\",color= \"output\",title='Age distribution')\nax.show()","245f24a7":"ax= px.pie(df, names= \"output\",template= \"plotly_dark\",title= \"chances of heart attack\",hole= 0.5)\nax.show()","9a9d3a25":"ax= px.pie(df, names= \"sex\",template= \"plotly_dark\",title= \"sex\",hole=.7)\nax.show()","3aa4b470":"ax= px.pie(df, names= \"cp\",template= \"plotly_dark\",title= \" Chest pain types \",hole=.7)\nax.show()","41aebbb3":"ax= px.sunburst(df, names= \"cp\",path= [\"output\",\"cp\"],template= \"plotly_dark\",title= \"Chest pain based on heart attack chances\")\nax.show()","d4bea3c2":"ax = px.scatter(df, x=\"age\", y=\"trtbps\",size=\"trtbps\", color=\"output\",\n                size_max=20,template= \"plotly_dark\",title=\"resting blood pressure\/age correlation\")\nax.show()","93e9dcf0":"ax= px.scatter(df,x= \"age\",y= \"chol\",marginal_x='histogram', marginal_y='histogram',size=\"chol\", size_max=20,\n              template= \"plotly_dark\",color= \"output\",title=\"age and cholestrol correlation\")\nax.show()","c08de738":"ax = px.scatter_3d(df, x=\"age\", y=\"trtbps\", z=\"chol\",template= \"plotly_dark\",color=\"output\")\nax.show()","7f5ecc8f":"ax= px.treemap(df,path= [\"fbs\",\"output\"],template= \"plotly_dark\",color= \"output\",title=\"blood sugar treemap\")\nax.show()","011501f7":"fig = px.histogram(df, x='thalachh', color=\"output\",title= \"maximum heart rate achieved\",template= \"plotly_dark\")\nfig.show()","6eb55df0":"ax= px.sunburst(df,path= [\"output\",\"caa\"],template= \"plotly_dark\",title= \"No of major blood vessels based on heart attack chances\")\nax.show()","ab15631b":"#importing essential libraries\nfrom sklearn.metrics import confusion_matrix,classification_report,accuracy_score\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.ensemble import AdaBoostClassifier\nfrom xgboost import XGBClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import GridSearchCV","c0435c8b":"df.var()","2287abff":"#Using log transformation\ndf[\"age\"]= np.log(df.age)","1bdc9e27":"df[\"trtbps\"]= np.log(df.trtbps)\ndf[\"chol\"]= np.log(df.chol)\ndf[\"thalachh\"]= np.log(df.thalachh)","f8cb37f8":"df.var()","17fdadf6":"px.box(df,template= \"plotly_dark\")","8f7efb05":"df.describe()","2305bc68":"#train test split\nlabel= df[\"output\"]\ntrain= df.drop(\"output\",axis= 1)\n","03caaf36":"x_train,x_test,y_train,y_test= train_test_split(train,label,test_size= 0.25,random_state= 5)","335fc1de":"scores= []\nfor i in range(1,50):\n    knn= KNeighborsClassifier(n_neighbors= i)\n    knn.fit(x_train,y_train)\n    scores.append(accuracy_score(y_test,knn.predict(x_test)))","bfa47e6f":"plt.figure(figsize= (15,6))\nsns.lineplot(np.arange(1,50),scores)\nplt.show()","2096d8eb":"knn= KNeighborsClassifier(n_neighbors= 13)\nknn.fit(x_train,y_train)\nknnpred = knn.predict(x_test)\naccuracy_score(y_test,knnpred)","daccc116":"#confusion matrix\ncm= confusion_matrix(y_test,knnpred)\nsns.heatmap(cm,annot= True)","665faecd":"#classification report\ncr= classification_report(y_test,knnpred)\ncr\n","cfc08bc8":"lr= LogisticRegression()\nlr.fit(x_train,y_train)\nlrpred= lr.predict(x_test)\naccuracy_score(y_test,lrpred)\n","84e276b5":"#confusion matrix\ncm= confusion_matrix(y_test,lrpred)\nsns.heatmap(cm,annot= True)","f0070696":"#classification report\nclassification_report(y_test,lrpred)\n","51b27c2e":"rf= RandomForestClassifier()\nrf.fit(x_train,y_train)\nrfpred= rf.predict(x_test)\naccuracy_score(y_test,rfpred)","f10d0e27":"dc= DecisionTreeClassifier()\ndc.fit(x_train,y_train)\npreddc= dc.predict(x_test)\naccuracy_score(y_test,preddc)","3962c755":"#parameter tuning\ndc= DecisionTreeClassifier()\nparams= {'criterion':['gini','entropy'],'max_depth':[1,3,10,50,100,200]}\ngrid = GridSearchCV(dc,params, cv=5)\ngrid.fit(x_train,y_train)","c3a9f3a6":"grid.best_params_","99a57096":"grid.best_score_","ff8daded":"\nad=AdaBoostClassifier(learning_rate= 0.2,n_estimators= 100)\nad.fit(x_train,y_train)\nadpred= ad.predict(x_test)\naccuracy_score(y_test,adpred)","7457566f":"gb= GradientBoostingClassifier()\ngb.fit(x_train,y_train)\npredgb= gb.predict(x_test)\naccuracy_score(y_test,predgb)","9d590c26":"xgb= XGBClassifier()\nxgb.fit(x_train,y_train)\naccuracy_score(y_test,xgb.predict(x_test))","95278689":"Distribution of resting blood pressure and age(scatter plot) with chances of heart attack","a79f3088":"The treemap shows most patients having blood sugar less than 120mg\/dl having greater chances of heart attack","d4322610":"The accuracy score is 0.92(92%)","b16f82fe":"3d scatter plot showing correlation between age,cholestrol and blood pressure also additional dimension is added based on output(chance of heart attack)","e1eb1a52":"chol : cholestoral in mg\/dl fetched via BMI sensor","97ba7748":"# GradientBoostingClassifier****","68e7f08c":"There are no missing values in the dataset","165de6b2":"Lets check variance in th features","c32fdc5c":"Correlation heatmap for different features in the dataset","a2fcb9ef":"0= less chance of heart attack 1= more chance of heart attack","8658540b":"Patients having higher chance of heart attack have  majority of no blood vessels","c93df09d":"Around 54% of the patients in the dataset have chances of heart attack","e1138742":"all features are now normally distributed","91959862":"![](https:\/\/www.unitedregional.org\/wp-content\/uploads\/2016\/01\/GettyImages-1126117038-768x513.jpg)","919e4137":"Majority of the patients experience chest pain type 1:typical angina(47.2%) followed by type 2 ie:type non angina pain,only 7% patients are aymptotic(type 3)","d75b72de":"accuracy score for xgboost: 0.8552631578947368","fbba7be9":"# ****RANDOM FOREST CLASSIFIER","36c7fa36":"# **conclusion: KNN model gave best result with a accuracy score of 0.9210526315789473(92%)**","13aad6a1":"# ****LOGISTIC REGRESSION","da479493":"trtbps : resting blood pressure (in mm Hg)","057b880c":"accuracy score (logistic regression): 0.8852459016393442","d1d0f710":"Patients with higher chances of heart attack majorly have type 2 chest pain followed by type1 and type0\nMajority of people having less chance of heart attack experience type 0 chest pain ie typical angina","054d8899":"Distribution based on maximum heart rate and chances of heart attack","1b921584":"# XGBOOST****","9c244fdc":"All the values in the dataset are numerical hence no need of label encoding","118301bd":"**ClASSIFICATION PART**","a13f4c98":"The n_neighbors values of 13 gives the best prediction score ","1c51e557":"# ****KNN classification with basic model tuning","6892a551":"Distribution of sex shows that 68.3% of patients are of type 1 sex while 31.7% are of type 0","7c578c7a":"accuracy score for gradientboost :0.8947368421052632","aaf8da7d":"The age column is normally distributed with most of the patients ranging in 50 to 65 age also having most chance of heart attack","018682ff":"accuracy score for decision tree classifier: 0.7631578947368421","7cfd0ec2":"There 303 records with 14 columns","f5efbb60":"\n\n    Age : Age of the patient\n\n    Sex : Sex of the patient\n\n    exang: exercise induced angina (1 = yes; 0 = no)\n\n    ca: number of major vessels (0-3)\n\n    cp : Chest Pain type chest pain type\n        \n    Value 0: typical angina\n    Value 1: atypical angina\n    Value 2: non-anginal pain\n    Value 3: asymptomatic\n\n    trtbps : resting blood pressure (in mm Hg)\n\n    chol : cholestoral in mg\/dl fetched via BMI sensor\n\n    fbs : (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)\n\n    rest_ecg : resting electrocardiographic results\n        Value 0: normal\n        Value 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\n        Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria\n\n    thalach : maximum heart rate achieved\n\n    target : 0= less chance of heart attack 1= more chance of heart attack\n","ae9ffe82":"fbs : (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)","109aff0b":"accuracy score for random forest: 0.8947368421052632","e3f169ec":"# AdaBoostClassifier****","03042444":"The age ,trtbps,chol,thalach  have higher levels of variance hence needs to be normalized      ","e50c2fcf":"thalach : maximum heart rate achieved","ccc97d71":"accuracy score for adaboost : 0.8552631578947368","4e6e7067":"    Chest pain types\n    Value 0: typical angina\n    Value 1: atypical angina\n    Value 2: non-anginal pain\n    Value 3: asymptomatic"}}