{"cell_type":{"be9c80c6":"code","d24f0dea":"code","bbc89fb3":"code","c4bbb1ae":"code","508dbbcd":"code","6de11e34":"code","4f264a1d":"code","16b8dbd7":"code","8b8b99fb":"code","22375b40":"code","933714fc":"code","2ef4a793":"code","8fd73a87":"code","eb8c5f45":"code","75d8d223":"code","4429eadb":"code","bd10d68d":"code","091e6bdf":"code","776a7c80":"code","648bb105":"code","4f8b3427":"code","0202b455":"code","4ce893bc":"code","ec6aadc1":"code","f5081150":"code","00c92b62":"code","7473b007":"code","8b420e9e":"code","0d714ba1":"code","015879b1":"code","e04cbe9c":"code","331a2336":"code","db3cbfa8":"code","76dd71e8":"code","6d8dcebc":"code","a2523722":"code","4053e35c":"code","f7e63697":"code","f5304799":"code","5f4fa430":"code","99eb10f9":"code","d7019703":"code","8e6a7d04":"code","431fb840":"code","6fe7b66e":"code","59b4be2b":"code","ce2022a4":"code","fde16689":"code","b35b847b":"code","6f4de92d":"code","860723ef":"code","fc5e7398":"code","afc346ea":"code","cd4a3996":"code","43e04905":"markdown","23d6ffe7":"markdown","8d565466":"markdown","eab27867":"markdown","5d7bd89d":"markdown","4d03a7d2":"markdown","56cd388a":"markdown"},"source":{"be9c80c6":"import numpy as np\nimport pandas as pd\nimport seaborn as sns \nimport matplotlib.pyplot as plt\nimport datetime as dt","d24f0dea":"df = pd.read_csv(\"\/kaggle\/input\/weather-dataset-rattle-package\/weatherAUS.csv\")\ndf","bbc89fb3":"df.columns.tolist()   ","c4bbb1ae":"#df['month'] = df['Date'].dt.month\ndf['Date'] = pd.to_datetime(df['Date'])\ndf['Month'] = df['Date'].dt.month","508dbbcd":"df.drop(['Date'],axis=1, inplace = True)\ndf.head(10)","6de11e34":"print(\"Percentage of null values in columns\")\n100*np.round(df.isnull().sum()\/len(df), 2)","4f264a1d":"df.describe().T","16b8dbd7":"df.shape","8b8b99fb":"df.dropna(subset = [\"RainTomorrow\"], inplace = True)\ndf[\"RainTomorrow\"].replace({'No': 0, 'Yes': 1},inplace = True)\ndf[\"RainTomorrow\"] = df.RainTomorrow.astype(\"int64\")","22375b40":"df.head()","933714fc":"df.shape","2ef4a793":"df.isnull().sum()","8fd73a87":"print (df['WindGustDir'].describe())\nprint()\nprint (df['WindGustDir'].unique())\ndf['WindGustDir'] = df['WindGustDir'].fillna('W')      # replacing with top value to avoid nan values in the specific column\nwind1 = {'W' : 1, 'WNW' : 2, 'WSW' : 3, 'NE' : 4, 'NNW' : 5, 'N' : 6, 'NNE' :7, 'SW' : 8, 'ENE' : 9, 'SSE' : 10,\n       'S' : 11, 'NW' : 12, 'SE' : 13, 'ESE': 14, 'E' : 15, 'SSW' : 16}\ndf['WindGustDir'] = df['WindGustDir'].map(wind1)\nprint()\nprint(df['WindGustDir'].dtypes)\ndf              ","eb8c5f45":"df.info()","75d8d223":"def cat_plot(column):\n    plt.figure(figsize = (50,20))\n    plt.subplot(1, 2, 1)\n    plt.pie(x = df[column].value_counts(), labels = df[column].value_counts().index, autopct=\"%.1f%%\", pctdistance =0.7)\n    plt.subplot(1, 2, 2)\n    sns.countplot(x = column, data = df, hue = \"RainTomorrow\")","4429eadb":"cat_plot('Location')","bd10d68d":"cat_plot('WindDir9am')","091e6bdf":"cat_plot('WindDir3pm')","776a7c80":"cat_plot('RainToday')","648bb105":"def num_plot(column, discrete = False):\n    if discrete : \n        plt.figure(figsize = (15,7))\n        sns.countplot(x = column, data = df, hue = \"RainTomorrow\")\n        plt.show()\n    else :\n        plt.figure(figsize = (15,7))\n        sns.jointplot(x = column, y = \"RainTomorrow\", data = df, kind = \"reg\")","4f8b3427":"num_plot('MinTemp')","0202b455":"num_plot('Rainfall')","4ce893bc":"num_plot('Evaporation')","ec6aadc1":"num_plot('Sunshine')","f5081150":"df","00c92b62":"print (df['WindDir9am'].unique())\nprint(df['WindDir9am'].describe())\ndf['WindDir9am']= df['WindDir9am'].fillna('N')\nwind2 = {'W' : 1, 'NNW' : 2, 'SE' : 3, 'ENE' : 4, 'SW' : 5, 'SSE' : 6, 'S' : 7, 'NE' : 8, 'N' : 9, 'SSW' : 10, 'WSW' :11,\n       'ESE' : 12, 'E' : 13, 'NW' : 14, 'WNW' : 15, 'NNE' : 16}\ndf['WindDir9am'] = df['WindDir9am'].map(wind2)\nprint()\nprint(df['WindDir9am'].dtypes)\ndf ","7473b007":"print (df['WindDir3pm'].unique())\nprint (df['WindDir3pm'].describe())\ndf['WindDir3pm']= df['WindDir3pm'].fillna('SE')  #replacing NaN value with top value\n\nwind3 = {'WNW' :1, 'WSW':2, 'E':3, 'NW':4 , 'W': 5 , 'SSE':6 , 'ESE':7 , 'ENE':8 , 'NNW':9, 'SSW':10,\n       'SW' : 11, 'SE' : 12, 'N':13 , 'S': 14, 'NNE' : 15, 'NE' : 16}\ndf['WindDir3pm'] = df['WindDir3pm'].map(wind3)\ndf['WindDir3pm']= df['WindDir3pm'].astype(int)\nprint()\nprint(df['WindDir3pm'].dtypes)\ndf           ","8b420e9e":"df.info()","0d714ba1":"maxtemp = list(df[df[\"MaxTemp\"].isnull()].index)\n\ndf.groupby([\"Month\"])[\"MaxTemp\"].mean()","015879b1":"for i in maxtemp:\n    if df[\"Month\"][i] == 1:\n        df[\"MaxTemp\"][i] = 30\n    elif df[\"Month\"][i] == 2:\n        df[\"MaxTemp\"][i] = 29\n    elif df[\"Month\"][i] == 3:\n        df[\"MaxTemp\"][i] = 27\n    elif df[\"Month\"][i] == 4:\n        df[\"MaxTemp\"][i] = 24\n    elif df[\"Month\"][i] == 5:\n        df[\"MaxTemp\"][i] = 20\n    elif df[\"Month\"][i] == 6:\n        df[\"MaxTemp\"][i] = 17\n    elif df[\"Month\"][i] == 7:\n        df[\"MaxTemp\"][i] = 17\n    elif df[\"Month\"][i] == 8:\n        df[\"MaxTemp\"][i] = 18\n    elif df[\"Month\"][i] == 9:\n        df[\"MaxTemp\"][i] = 21\n    elif df[\"Month\"][i] == 10:\n        df[\"MaxTemp\"][i] = 24\n    elif df[\"Month\"][i] == 11:\n        df[\"MaxTemp\"][i] = 26\n    else:\n        df[\"MaxTemp\"][i] = 28","e04cbe9c":"df","331a2336":"mintemp = list(df[df[\"MinTemp\"].isnull()].index)\ndf.groupby([\"Month\"])[\"MinTemp\"].mean()","db3cbfa8":"for i in mintemp:\n    if df[\"Month\"][i] == 1:\n        df[\"MinTemp\"][i] = 18\n    elif df[\"Month\"][i] == 2:\n        df[\"MinTemp\"][i] = 18\n    elif df[\"Month\"][i] == 3:\n        df[\"MinTemp\"][i] = 16\n    elif df[\"Month\"][i] == 4:\n        df[\"MinTemp\"][i] = 13\n    elif df[\"Month\"][i] == 5:\n        df[\"MinTemp\"][i] = 10\n    elif df[\"Month\"][i] == 6:\n        df[\"MinTemp\"][i] = 8\n    elif df[\"Month\"][i] == 7:\n        df[\"MinTemp\"][i] = 7\n    elif df[\"Month\"][i] == 8:\n        df[\"MinTemp\"][i] = 7\n    elif df[\"Month\"][i] == 9:\n        df[\"MinTemp\"][i] = 9\n    elif df[\"Month\"][i] == 10:\n        df[\"MinTemp\"][i] = 12\n    elif df[\"Month\"][i] == 11:\n        df[\"MinTemp\"][i] = 14\n    else:\n        df[\"MinTemp\"][i] = 16","76dd71e8":"df.isnull().sum()","6d8dcebc":"location = {'Albury' :0, 'BadgerysCreek' : 1, 'Cobar' : 2, 'CoffsHarbour' :3, 'Moree' : 4,\n       'Newcastle' : 5, 'NorahHead' : 6, 'NorfolkIsland' : 7, 'Penrith': 8, 'Richmond' : 9,\n       'Sydney': 10, 'SydneyAirport' : 11, 'WaggaWagga' : 12, 'Williamtown': 13,\n       'Wollongong' : 14, 'Canberra' : 15, 'Tuggeranong': 16, 'MountGinini' :17, 'Ballarat' : 18,\n       'Bendigo' : 19, 'Sale' : 20, 'MelbourneAirport' : 21, 'Melbourne' : 22, 'Mildura' : 23,\n       'Nhil' : 24, 'Portland' : 25, 'Watsonia' : 26, 'Dartmoor' : 27, 'Brisbane' : 28, 'Cairns' : 29,\n       'GoldCoast' : 30, 'Townsville' : 31, 'Adelaide' : 32, 'MountGambier' : 33, 'Nuriootpa' : 34,\n       'Woomera' : 35, 'Albany' : 36, 'Witchcliffe': 37, 'PearceRAAF' : 38, 'PerthAirport' : 39,\n       'Perth' : 40, 'SalmonGums' : 41, 'Walpole' : 42, 'Hobart' : 43, 'Launceston' : 44,\n       'AliceSprings' : 45, 'Darwin' : 46, 'Katherine': 47, 'Uluru' : 48}\ndf['Location'] = df['Location'].map(location)\n# creating dictionary function and mapping\n\ndf['Location'].unique() #checking unique values","a2523722":"df['RainToday'].fillna(df['RainToday'].mode()[0], inplace=True)\nrToday = {'No':0 ,'Yes' : 1}\ndf['RainToday']= df['RainToday'].map(rToday)\ndf['RainToday']= df['RainToday'].astype(int)\n\nprint(df['RainToday'].dtypes)\n","4053e35c":"df.info()","f7e63697":"df.isnull().sum()","f5304799":"missing = df.select_dtypes([\"int64\", \"float64\"])\n\nfor column in missing.columns:\n    df[column].fillna(df[column].mean(), inplace = True)\n\n","5f4fa430":"df.isnull().sum()","99eb10f9":"df.head(20)","d7019703":"from collections import Counter\ndef outliers(data,columns):\n    aykiri_indexler=[]\n    for i in columns:\n        Q1 = data[i].quantile(0.25)\n        Q3 = data[i].quantile(0.75)\n        IQR = Q3 -Q1\n        alt_sinir = Q1 - 1.5*IQR\n        ust_sinir = Q3 + 1.5*IQR\n        filtre = ((data[i] < alt_sinir) | (data[i] > ust_sinir))\n        aykiri_gozlemler = data[i][filtre]\n        aykiri_index = aykiri_gozlemler.index\n        aykiri_indexler.extend(aykiri_index)\n        \n    aykiri_indexler = Counter(aykiri_indexler)\n    ortak_indexler = [i for i,v in aykiri_indexler.items() if v>2]\n    return ortak_indexler","8e6a7d04":"x = df.select_dtypes([\"float64\", \"int64\"])\ndelete_index = outliers(df,x.columns)\ndf = df.drop(delete_index,axis=0).reset_index(drop=True)","431fb840":"df.shape","6fe7b66e":"df.columns.tolist","59b4be2b":"# Correlation map among numeric attributes\ncorrmat = df.corr()\ncmap = sns.diverging_palette(260,-10,s=50, l=75, n=6, as_cmap=True)\nplt.subplots(figsize=(18,18))\nsns.heatmap(corrmat,cmap= cmap,annot=True, square=True)","ce2022a4":"X = df[['Location', 'MinTemp', 'MaxTemp', 'Rainfall', 'Evaporation', 'Sunshine',\n       'WindGustDir', 'WindGustSpeed', 'WindDir9am', 'WindDir3pm',\n       'WindSpeed9am', 'WindSpeed3pm', 'Humidity9am', 'Humidity3pm',\n       'Pressure9am', 'Pressure3pm', 'Cloud9am', 'Cloud3pm', 'Temp9am',\n       'Temp3pm', 'RainToday','Month']]\ny = df['RainTomorrow']","fde16689":"from sklearn.preprocessing import StandardScaler \nscaler = StandardScaler()  \nX = scaler.fit_transform(X)  ","b35b847b":"X","6f4de92d":"from sklearn.model_selection import train_test_split     #data splitting\nX_train, X_test, y_train, y_test = train_test_split(X,y, test_size=0.25, random_state=12)","860723ef":"from sklearn.neural_network import MLPClassifier\nmlp = MLPClassifier(random_state=20, max_iter=100000, hidden_layer_sizes=30,learning_rate= 'adaptive', activation='tanh').fit(X_train, y_train)\nmlp.score(X_test, y_test)","fc5e7398":"from sklearn.ensemble import RandomForestClassifier\nrf = RandomForestClassifier(max_depth=20,max_features=None, n_estimators=200, random_state=12).fit(X_train, y_train)\nrf.score(X_test, y_test)","afc346ea":"from sklearn.svm import SVC\nSVC = SVC(kernel='rbf', gamma ='auto', max_iter = -1).fit(X_train, y_train)\nSVC.score(X_test, y_test)","cd4a3996":"from sklearn.ensemble import VotingClassifier\nclf = VotingClassifier( estimators=[('mlp', mlp), ('rf', rf), ('SVC', SVC)], voting='hard')\nclf.fit(X_train,y_train)\nclf.score(X_test,y_test)","43e04905":"from sklearn.linear_model import LogisticRegression\nlr = LogisticRegression(random_state=0).fit(X_train, y_train)\nlr.score(X_test, y_test)","23d6ffe7":"from sklearn.tree import DecisionTreeClassifier\ndt = DecisionTreeClassifier(max_depth=10, random_state=12,max_features=None).fit(X_train, y_train)\ndt.score(X_test, y_test)","8d565466":"from sklearn.ensemble import AdaBoostClassifier\nadb = AdaBoostClassifier(n_estimators=100,algorithm = 'SAMME', learning_rate = 1.5, random_state=0).fit(X_train, y_train)\nadb.score(X_test, y_test)","eab27867":"ax1 = sns.boxplot(x=df['MinTemp'])","5d7bd89d":"from sklearn.neighbors import KNeighborsClassifier\nknn = KNeighborsClassifier(n_neighbors = 5)\nknn.fit(X_train, y_train)\nknn.score(X_test, y_test)","4d03a7d2":"from sklearn import preprocessing\nmin_max_scaler = preprocessing.MinMaxScaler()\nX = min_max_scaler.fit_transform(X)","56cd388a":"ax2 = sns.boxplot(x=df['MaxTemp'])"}}