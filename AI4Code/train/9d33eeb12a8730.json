{"cell_type":{"354ef655":"code","fb9eba6b":"code","a8099c51":"code","0d785b1e":"code","60ecf7b2":"code","3e554fe7":"code","9e282e17":"code","a0d33ddd":"code","fd3fe6a0":"code","dc5fba17":"code","30565f2a":"code","186cd7e7":"code","c0e083ca":"code","5d4d0d97":"code","4e3a7cbb":"code","ca8223ba":"code","b91d2380":"code","aaedbe82":"code","f192fd10":"code","1bc0a6ea":"code","481eea1e":"code","db7f7af7":"code","f29d1e85":"code","68de45ee":"code","fa44dbf7":"code","4b8ca464":"code","ba2bd057":"code","cc2429aa":"code","38a1c8b7":"code","4e7048dc":"code","a9763ebf":"code","27b2fe29":"code","1216b911":"markdown","d18a9507":"markdown","45a8c940":"markdown","52661b0b":"markdown","c24468c1":"markdown","e983ec45":"markdown","550f2fee":"markdown","80315b1e":"markdown","eefc6bb8":"markdown","19c373b6":"markdown","e27372c4":"markdown","8119675f":"markdown"},"source":{"354ef655":"import pandas as pd\n\nimport plotly\nimport plotly.plotly as py\nimport plotly.graph_objs as go\nfrom plotly.offline import init_notebook_mode, iplot\nfrom plotly import tools\n\ninit_notebook_mode(connected=True)","fb9eba6b":"path2data = '..\/input\/'","a8099c51":"df_politicians = pd.read_csv(path2data + 'deputies_dataset.csv', low_memory=False)\ndf_dirty_politicians = pd.read_csv(path2data + 'dirty_deputies_v2.csv', low_memory=False)","0d785b1e":"print('Dataset shape: {}'.format(df_politicians.shape))","60ecf7b2":"df_politicians['receipt_date'] = pd.to_datetime(df_politicians['receipt_date'])\ndf_politicians['month'] = df_politicians['receipt_date'].dt.month\ndf_politicians['year'] = df_politicians['receipt_date'].dt.year\ndf_politicians['day'] = df_politicians['receipt_date'].dt.day","3e554fe7":"df_politicians.head()","9e282e17":"# get data from 2013 to 2017\ndf_politicians = df_politicians[ (df_politicians['year']>=2013) &  (df_politicians['year']<=2017)]","a0d33ddd":"df_dirty_politicians['receipt_date'] = pd.to_datetime(df_dirty_politicians['refund_date'])\ndf_dirty_politicians['month'] = df_dirty_politicians['receipt_date'].dt.month\ndf_dirty_politicians['year'] = df_dirty_politicians['receipt_date'].dt.year\ndf_dirty_politicians['day'] = df_dirty_politicians['receipt_date'].dt.day","fd3fe6a0":"df_dirty_politicians.head()","dc5fba17":"trace1 = go.Bar(\n            x=df_politicians.groupby(['state_code'])['receipt_value'].sum().sort_values(ascending=True).values,\n            y=df_politicians.groupby(['state_code'])['receipt_value'].sum().sort_values(ascending=True).index,\n            orientation = 'h'\n)\n\ntrace2 = go.Bar(\n            x=df_politicians.groupby(['political_party'])['receipt_value'].sum().sort_values(ascending=True).values,\n            y=df_politicians.groupby(['political_party'])['receipt_value'].sum().sort_values(ascending=True).index,\n            orientation = 'h'\n)\n\nfig = tools.make_subplots(rows=1, cols=2)\n\nfig.append_trace(trace1, 1, 1)\nfig.append_trace(trace2, 1, 2)\n\nfig['layout'].update(height=600, width=1000, title='Receipt Value counter')\niplot(fig, filename='simple-subplot-with-annotations')","30565f2a":"df_politicians.groupby(['deputy_name', 'political_party'])['receipt_value'].sum().sort_values(ascending=True)[-10:]","186cd7e7":"deputy_name = 'Jair Bolsonaro' # change here to analyze other deputy","c0e083ca":"deputy_data = df_politicians[df_politicians['deputy_name'] == deputy_name]","5d4d0d97":"deputy_data.head()","4e3a7cbb":"receipt_value_month_year = deputy_data.groupby(['year','month'])['receipt_value'].sum().to_frame().unstack(level=-1)\nreceipt_value_month_year.columns = receipt_value_month_year.columns.droplevel(0)","ca8223ba":"receipt_value_month_year.head()","b91d2380":"data = []\nyears = receipt_value_month_year.index\n\nfor idx in range(0, len(years)):\n\n    trace = go.Bar(\n        x=receipt_value_month_year.iloc[0].index,\n        y=receipt_value_month_year.iloc[idx],\n        name=str(years[idx])\n    )\n    data.append(trace)\n    \nlayout = go.Layout(\n    barmode='group'\n)\n\nfig = go.Figure(data=data, layout=layout)\nfig['layout'].update(height=600, width=1000, title='Receipt Value in each month')\niplot(fig, filename='grouped-bar')","aaedbe82":"deputy_data['receipt_description'].unique()","f192fd10":"fig = {\n    'data': [{'labels': deputy_data.groupby(['receipt_description'])['receipt_value'].sum().index,\n              'values': deputy_data.groupby(['receipt_description'])['receipt_value'].sum().values,\n              'type': 'pie'}],\n    'layout': {'title': 'Expenses distribution for each service',\n              'height': 400, \n               'width':1000}\n     }\n\niplot(fig, filename='basic_pie_chart')","1bc0a6ea":"deputy_data[deputy_data['receipt_description'] == 'Airline tickets'].groupby(['establishment_name'])['receipt_value'].sum().sort_values(ascending=False)","481eea1e":"deputy_airline_df = deputy_data[deputy_data['receipt_description'] == 'Airline tickets']","db7f7af7":"data = [go.Scatter(\n          x=deputy_airline_df['receipt_date'],\n          y=deputy_airline_df['receipt_value'],\n          mode = 'markers'\n    )]\n\niplot(data)","f29d1e85":"nb_trips = deputy_airline_df.groupby(['receipt_date'])['receipt_date'].count().sort_values(ascending=False)","68de45ee":"nb_trips.head(10)","fa44dbf7":"deputy_airline_df[deputy_airline_df['receipt_date'] == nb_trips.index[0]]","4b8ca464":"aux = deputy_data[deputy_data['receipt_description'] == 'Postal Services'].groupby(['establishment_name'])['receipt_value'].sum().to_frame()\naux.sort_values('receipt_value', ascending=False, inplace=True)","ba2bd057":"aux","cc2429aa":"types_of_postal_services = deputy_data[deputy_data['receipt_description'] == 'Postal Services']['establishment_name'].unique()","38a1c8b7":"print('Types of postal services: {}'.format(len(types_of_postal_services)))","4e7048dc":"data = []\nfor ps in types_of_postal_services:\n\n    aux = deputy_data[(deputy_data['receipt_description'] == 'Postal Services') & (deputy_data['establishment_name'] == ps)]\n    trace = go.Box(\n        x=aux['receipt_value'].values,\n        name = ps\n    )\n    \n    data.append(trace)\n\nlayout = go.Layout(\n    width=800,\n    yaxis=dict(\n        zeroline=False\n    ),\n)\n\nfig = go.Figure(data=data, layout=layout)\niplot(fig)","a9763ebf":"dpa = deputy_data[deputy_data['receipt_description'] == 'Dissemination of the Parliamentary Activity.'].groupby(['establishment_name', 'year'])['receipt_value'].sum().to_frame().unstack(level=-1)\ndpa.columns = dpa.columns.droplevel(0)","27b2fe29":"dpa","1216b911":"**Load Data**","d18a9507":"# Dissemination of the Parliamentary Activity.","45a8c940":"**Exploratory Data Analysis**","52661b0b":"# Postal Services","c24468c1":"**Distribution of paid services**\n\n","e983ec45":"**Brazil's House of Deputies Reimbursements**\n\nThis notebook, makes an analysis of the  Brazilian deputies expenses from 2013 to 2017.","550f2fee":"# Number of trips by day\n\nAs can be seen below, there are deputies who have made many trips in just one day.","80315b1e":"# Individual analysis","eefc6bb8":"**Trajectory of receipt value in each month**\n\nAs can be seen, December is the month in which the number of expenses is higher","19c373b6":"# Airline Tickets","e27372c4":"**Receipt values by deputies of each state and Political**\n\nAs can be seen from the chart below, most of the expenses are from deputies from the state of Sao Paulo. With regard to the political party, the one that had the highest expenses in the analyzed period was the PT (146M).","8119675f":"![](http:\/\/www.vermelho.org.br\/admin\/arquivos\/biblioteca\/cd99755.jpg)"}}