{"cell_type":{"6848c82d":"code","e83cc0bc":"code","33aab768":"code","44e497fd":"code","99319d60":"code","244b5954":"code","dd246af9":"code","6bc03ef8":"code","7b7d6b0e":"code","17608084":"code","bb4ca3d6":"code","a538b9c1":"code","004c0812":"code","94cffc2a":"code","615ca286":"code","4343b291":"code","e8aa96c1":"code","e5bb4208":"code","0b9256d2":"code","3cf9b7f4":"code","82483fc0":"code","29fed66a":"code","1fcce862":"code","96652c3f":"code","536404f6":"code","81f7c326":"code","7f434f03":"code","f1425790":"code","0a1f012e":"code","50afe390":"code","3675a19e":"code","55c50d3d":"code","80dedf10":"code","dae9a573":"code","8f1ea199":"code","b16941f8":"code","85e6d561":"markdown","546dcd9e":"markdown","28d37efe":"markdown","9413c24a":"markdown","8c3a6568":"markdown"},"source":{"6848c82d":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","e83cc0bc":"heart_data= pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')","33aab768":"heart_data.head()","44e497fd":"heart_data.describe()","99319d60":"heart_data.info()","244b5954":"plt.rcParams['figure.figsize']=(20,10)\nsns.countplot(heart_data['age'])\nplt.xlabel('Age', size=18)\nplt.ylabel('Count',size=18)\nplt.title('Age Distribution', size=25)","dd246af9":"#1- men 0-women\nheart_data.sex.value_counts(normalize= True)","6bc03ef8":"plt.rcParams['figure.figsize']=(8,8)\nsns.countplot(heart_data['sex'])\nplt.xlabel('Sex', size=18)\nplt.ylabel('Count',size=18)\nplt.title('Sex Distribution', size=25)","7b7d6b0e":"plt.rcParams['figure.figsize']=(8,8)\nsns.countplot(heart_data['cp'])\nplt.xlabel('Chest Pain Type', size=18)\nplt.ylabel('Count',size=18)\nplt.title('Type of chest pain Distribution', size=25)","17608084":"# trtbps: resting blood pressure (in mm Hg)\nplt.rcParams['figure.figsize']=(20,10)\nplt.hist(heart_data['trtbps'], color=['pink'], bins=(80,100,110,120,130,140,150,160,190))\nplt.xlabel('trtbps', size=18)\nplt.ylabel('Count',size=18)\nplt.title('trtbps Distribution', size=25)","bb4ca3d6":"# chol : cholestoral in mg\/dl fetched via BMI sensor\nplt.rcParams['figure.figsize']=(20,10)\nplt.hist(heart_data['chol'], color=['pink'])\nplt.xlabel('Cholestoral level', size=18)\nplt.ylabel('Count',size=18)\nplt.title('cholestoral Distribution', size=25)","a538b9c1":"# fbs : (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)\nplt.rcParams['figure.figsize']=(8,8)\nsns.countplot(heart_data['fbs'])\nplt.xlabel('fbs', size=18)\nplt.ylabel('Count',size=18)\nplt.title('fasting blood sugar Distribution', size=25)","004c0812":"#rest_ecg : resting electrocardiographic results\n#-Value 0: normal\n#-Value 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\n#-Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria\nplt.rcParams['figure.figsize']=(8,8)\nsns.countplot(heart_data['restecg'])\nplt.xlabel('rest_ecg', size=18)\nplt.ylabel('Count',size=18)\nplt.title('rest ecg Distribution', size=25)","94cffc2a":"#thalach : maximum heart rate achieved\nplt.rcParams['figure.figsize']=(20,10)\nplt.hist(heart_data['thalachh'], color=['pink'])\nplt.xlabel('Thalachh', size=18)\nplt.ylabel('Count',size=18)\nplt.title('Thalachh Distribution', size=25)","615ca286":"#exng: exercise induced angina (1 = yes; 0 = no)\nplt.rcParams['figure.figsize']=(8,8)\nsns.countplot(heart_data['exng'])\nplt.xlabel('exng', size=18)\nplt.ylabel('Count',size=18)\nplt.title('exng Distribution', size=25)","4343b291":"plt.rcParams['figure.figsize']=(20,10)\nplt.hist(heart_data['oldpeak'], color=['pink'])\nplt.xlabel('Oldpeak', size=18)\nplt.ylabel('Count',size=18)\nplt.title('oldpeak Distribution', size=25)","e8aa96c1":"#slp: slope - the slope of the peak exercise ST segment (2 = upsloping; 1 = flat; 0 = downsloping)\nplt.rcParams['figure.figsize']=(8,8)\nsns.countplot(heart_data['slp'])\nplt.xlabel('slope', size=18)\nplt.ylabel('Count',size=18)\nplt.title('Slope', size=25)","e5bb4208":"#caa - number of major vessels (0-4) colored by flourosopy\nplt.rcParams['figure.figsize']=(8,8)\nsns.countplot(heart_data['caa'])\nplt.xlabel('no of vessels', size=18)\nplt.ylabel('Count',size=18)\nplt.title('No of vessels', size=25)","0b9256d2":"#thall - 2 = normal; 1 = fixed defect; 3 = reversable defect\nplt.rcParams['figure.figsize']=(8,8)\nsns.countplot(heart_data['thall'])\nplt.xlabel('Thall', size=18)\nplt.ylabel('Count',size=18)\nplt.title('Thall distribution', size=25)","3cf9b7f4":"plt.figure(figsize=(20,30))\n\nplt.subplot(5,2,1)\nplt.title('Prevalence of Heart attack by Sex',fontsize=15)\nsns.countplot(heart_data['output'], hue=heart_data['sex'])\n\nplt.subplot(5,2,2)\nplt.title('Prevalence of Heart attack by Chest Pain',fontsize=15)\nsns.countplot(heart_data['output'], hue=heart_data['cp'])\n\nplt.subplot(5,2,3)\nplt.title('Prevalence of Heart attack by fasting blood sugar > 120 mg\/dl',fontsize=15)\nsns.countplot(heart_data['output'],hue=heart_data['fbs'])\n\nplt.subplot(5,2,4)\nplt.title('Prevalence of Heart attack by restecg',fontsize=15)\nsns.countplot(heart_data['output'],hue = heart_data['restecg'])\n\nplt.subplot(5,2,5)\nplt.title('Prevalence of Heart attack by Exercise induced angina',fontsize=15)\nsns.countplot(heart_data['output'],hue=heart_data['exng'])\n\nplt.subplot(5,2,6)\nplt.title('Prevalence of Heart attack by slp',fontsize=15)\nsns.countplot(heart_data['output'],hue=heart_data['slp'])\n\nplt.subplot(5,2,7)\nplt.title('Prevalence of Heart attack by number of major vessels',fontsize=15)\nsns.countplot(heart_data['output'],hue=heart_data['caa'])\n\nplt.subplot(5,2,8)\nplt.title('Prevalence of Heart attack by thall',fontsize=15)\nsns.countplot(heart_data['output'],hue=heart_data['thall'])\n","82483fc0":"# output reprsents whether the person had a heart-attack (output=1) or not (output=0)\ndata = pd.crosstab(heart_data['age'], heart_data['output'])\ndata.div(data.sum(1).astype(float),axis=0).plot(kind='bar', stacked=True, figsize=(20,10), color=['blue','pink'])\n\nplt.title('Prevalence of heart attack by age', fontsize = 30)\nplt.xlabel('Age', fontsize = 15)\nplt.legend()\nplt.show()","29fed66a":"# output reprsents whether the person had a heart-attack (output=1) or not (output=0)\n# trtbps: resting blood pressure (in mm Hg)\ndata = pd.crosstab(heart_data['trtbps'], heart_data['output'])\ndata.div(data.sum(1).astype(float),axis=0).plot(kind='bar', stacked=True, figsize=(20,10), color=['blue','pink'])\n\nplt.title('Prevalence of heart attack by resting blood pressure', fontsize = 30)\nplt.xlabel('trtbps', fontsize = 15)\nplt.legend()\nplt.show()","1fcce862":"data = pd.crosstab(heart_data['chol'], heart_data['output'])\ndata.div(data.sum(1).astype(float),axis=0).plot(kind='hist', stacked=True, figsize=(20,10), color=['blue','pink'])\n\nplt.title('Prevalence of heart attack by cholestrol', fontsize = 30)\nplt.xlabel('cholestrol', fontsize = 15)\nplt.legend()\nplt.show()","96652c3f":"#thalach : maximum heart rate achieved\ndata = pd.crosstab(heart_data['thalachh'], heart_data['output'])\ndata.div(data.sum(1).astype(float),axis=0).plot(kind='hist', stacked=True, figsize=(20,10), color=['blue','pink'])\n\nplt.title('Prevalence of heart attack by maximum heart rate achieved', fontsize = 30)\nplt.xlabel('thalachh', fontsize = 15)\nplt.legend()\nplt.show()","536404f6":"data = pd.crosstab(heart_data['oldpeak'], heart_data['output'])\ndata.div(data.sum(1).astype(float),axis=0).plot(kind='hist', stacked=True, figsize=(20,10), color=['blue','pink'])\n\nplt.title('Prevalence of heart attack by oldpeak', fontsize = 30)\nplt.xlabel('thalachh', fontsize = 15)\nplt.legend()\nplt.show()","81f7c326":"corr_matrix = heart_data.corr()\ncorr_matrix","7f434f03":"plt.figure(figsize=(20,10))\nsns.heatmap(corr_matrix, annot=True)","f1425790":"heart_data['age']= heart_data['age']\/max(heart_data['age'])\nheart_data['trtbps']= heart_data['trtbps']\/max(heart_data['trtbps'])\nheart_data['cp']= heart_data['cp']\/max(heart_data['cp'])\nheart_data['chol']= heart_data['chol']\/max(heart_data['chol'])\nheart_data['thalachh']= heart_data['thalachh']\/max(heart_data['thalachh'])","0a1f012e":"heart_data.describe()","50afe390":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split( heart_data.drop(['output'],axis=1), heart_data.output, test_size=0.2, random_state=0,\n                                                    stratify = heart_data.output)","3675a19e":"# Logistic Regression\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import GridSearchCV\n\nclf= LogisticRegression()\nparams= {\"C\":np.logspace(-3,3,7), \"penalty\":[\"l1\",\"l2\"]}# l1 lasso l2 ridge\n\nclf_grid= GridSearchCV(estimator= clf, param_grid= params, cv=5)\nclf_grid.fit(X_train,y_train)\n","55c50d3d":"from sklearn.metrics import accuracy_score\n\ny_pred= clf_grid.predict(X_test)\nacc= accuracy_score(y_test, y_pred)\nprint('Accuracy is: ', acc)","80dedf10":"# RandomForest Classifier\nfrom sklearn.ensemble import RandomForestClassifier\nclassifier = RandomForestClassifier(n_estimators = 10, criterion = 'entropy', random_state = 0)\nclassifier.fit(X_train, y_train)","dae9a573":"from sklearn.metrics import accuracy_score\n\ny_pred2= classifier.predict(X_test)\nacc2= accuracy_score(y_test, y_pred2)\nprint('Accuracy is: ', acc2)","8f1ea199":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import GridSearchCV\n\nclassifier=KNeighborsClassifier()\n\nparams1 = {\n    'n_neighbors': (1,10, 1),\n    'leaf_size': (20,40,1),\n    'p': (1,2),\n    'weights': ('uniform', 'distance'),\n    'metric': ('minkowski', 'chebyshev'),}\nclf2_grid= GridSearchCV(estimator= classifier, param_grid= params1, cv=5)\nclf2_grid.fit(X_train,y_train)","b16941f8":"from sklearn.metrics import accuracy_score\n\ny_pred3= clf2_grid.predict(X_test)\nacc3= accuracy_score(y_test, y_pred3)\nprint('Accuracy is: ', acc3)","85e6d561":"### As we can see there are no null values","546dcd9e":"## So far we have established a few important points.\n\n### 1 - As resting blood pressure increasres, so to does risk of heart disease\n\n### 2 - Rising Choloseterol does not appear to be a major indicator\n\n### 3 - A low Max HR acheived is a big warning sign.\n\n### 4 - Risk of heart disease increases with age\n\n### 5 - In general, 40 to 58 aged people have more chance of heart attack.\n\n### 6- Risk increases for Chest Pain - Non-anginal type\n\n### 7- Hishest risk is when number of major vessels - 0\n\n### 9- Thalium Stress Test Result - 2\n\n### 10- Old peak - between 0-0.5","28d37efe":"#### From above figure, It seems like people below the age of 57 are less prone to heart attack and people betwween the age of 55-60 are prone to have heart attack.","9413c24a":"# Univariate Analysis","8c3a6568":"Age : Age of the patient\n\nSex : Sex of the patient\n\nexang: exercise induced angina (1 = yes; 0 = no)\n\nca: number of major vessels (0-3)\n\ncp : Chest Pain type chest pain type\n\nValue 1: typical angina\nValue 2: atypical angina\nValue 3: non-anginal pain\nValue 4: asymptomatic\ntrtbps : resting blood pressure (in mm Hg)\n\nchol : cholestoral in mg\/dl fetched via BMI sensor\n\nfbs : (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)\n\nrest_ecg : resting electrocardiographic results\n\nValue 0: normal\nValue 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\nValue 2: showing probable or definite left ventricular hypertrophy by Estes' criteria\nthalach : maximum heart rate achieved\n\ntarget : 0= less chance of heart attack 1= more chance of heart attack"}}