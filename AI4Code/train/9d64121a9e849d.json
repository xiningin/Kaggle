{"cell_type":{"387979d4":"code","a4c2a681":"code","d4df8969":"code","41ef0d8a":"code","cd3edace":"code","2bc21732":"code","f9c39646":"code","54cfb654":"code","e4b4f87c":"code","d3c935d9":"code","a24af0ce":"code","cc62394c":"markdown","cba0ca2f":"markdown","a2f20ddc":"markdown","39d7a4f6":"markdown","5077f685":"markdown","45d3c747":"markdown","99956ab6":"markdown","bae19a48":"markdown","987df86f":"markdown"},"source":{"387979d4":"import numpy as np\nimport pandas as pd\nimport os\nimport gc\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(style='darkgrid')","a4c2a681":"# loading the data\ntrain = pd.read_feather('..\/input\/riiid-train-data-multiple-formats\/riiid_train.feather', \n                        columns=['user_id', 'timestamp', 'user_answer', 'answered_correctly'])\nquestions = pd.read_csv('..\/input\/riiid-test-answer-prediction\/questions.csv')","d4df8969":"# aggregation(max value of timestamp per user) \nagg_df = train.groupby('user_id')['timestamp'].max().reset_index()\nagg_df = agg_df.sort_values('timestamp', ascending=False) \nagg_df['day'] = agg_df['timestamp'] \/ (1000*60*60*24)\nagg_df['day'].describe()","41ef0d8a":"agg_df.head()","cd3edace":"plt.figure(figsize=(10,4))\nplt.hist(agg_df['day'])\nplt.xlabel('elapsed days')\nplt.ylabel('number of users')","2bc21732":"train = train[train.answered_correctly>=0]\n\n# Calculate the percentage of correct answers per user\nagg_df = train.groupby('user_id')['answered_correctly'].agg(['count', 'sum']).reset_index()\nagg_df.columns = ['user_id', 'total_answer_cnt', 'correct_cnt']\nagg_df['correct_rate'] = agg_df['correct_cnt'] \/ agg_df['total_answer_cnt']\nagg_df.sort_values(['correct_rate', 'total_answer_cnt'], ascending=False).head(20)","f9c39646":"# Calculate the percentage of each answer number selected by each user.\nagg_df = train.groupby(['user_id', 'user_answer'])['answered_correctly'].count().reset_index()\nagg_df.columns = ['user_id', 'user_answer', 'answer_cnt']\nagg_df['total_answer_cnt'] = agg_df.groupby('user_id').transform('sum')['answer_cnt']\nagg_df['selection_rate'] = agg_df['answer_cnt'] \/ agg_df['total_answer_cnt']\nagg_df","54cfb654":"agg_df.sort_values(['selection_rate', 'total_answer_cnt'], ascending=False).head(20)","e4b4f87c":"agg_df = train.groupby('user_id')['user_answer'].count().reset_index()\nagg_df.columns = ['user_id', 'total_answer_cnt']","d3c935d9":"vc = agg_df['total_answer_cnt'].value_counts()\nvc.head(20)","a24af0ce":"plt.figure(figsize=(15,4))\nplt.bar(vc.index, vc)\nplt.xlim(0,100)\nplt.xlabel('total answer count')\nplt.ylabel('number of users')","cc62394c":"(total_answer_cnt=30) are remarkably high.  \nAnd then there are round number like 40 and 50.  \n\nThere may be a total of 30 questions to test user skills when to start using the app.  \nBasically are there 10 questions per a attempt?","cba0ca2f":"user_id:48102728 answered all 41 questions correctly.  \nbut the numbers aren't surprising. (The real TOEIC test has 200 questions.)","a2f20ddc":"Most are used for a few days or months.  \nbut the longest users have been using it for more than 1000days!","39d7a4f6":"# users who keep choosing the same answer","5077f685":"There are quite a few users who always pick the same number.  \nAre they abandoning answers?","45d3c747":"They're either continuous learners or, if they're not, they're app developers.","99956ab6":"# by the way,  \nI noticed a things in the investigation above.  \nMany users with total_answer_cnt of 30.  \nLet us just check one last thing.","bae19a48":"# Time elapsed since the user started using the app","987df86f":"# correct answer to all questions"}}