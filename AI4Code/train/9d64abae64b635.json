{"cell_type":{"93c18320":"code","62ec954d":"code","5945fb23":"code","26f3862a":"code","61a0235e":"code","6bd388e1":"code","90a43b94":"code","235b3b61":"code","dac95810":"code","5b8c2369":"markdown"},"source":{"93c18320":"!pip install openpyxl -q","62ec954d":"import numpy as np \nimport pandas as pd\nimport seaborn as sns\nimport itertools as it\nimport matplotlib.pyplot as plt","5945fb23":"tab1 = pd.read_excel('..\/input\/india-sugar-semiannual-report\/India.xlsx', sheet_name='tab1')\ntab2 = pd.read_excel('..\/input\/india-sugar-semiannual-report\/India.xlsx', sheet_name='tab2')\ntab3 = pd.read_excel('..\/input\/india-sugar-semiannual-report\/India.xlsx', sheet_name='tab3')","26f3862a":"year = [2019, 2020, 2021]\nmonth = range(1, 13)\ndate = [f'{y}-{m}' for y, m in it.product(year, month)]\n\n\ndf1 = pd.DataFrame(data=date, columns=['DateTime'])\ndf1['DateTime'] = pd.to_datetime(df1['DateTime']) # Unfortunately, datetime does not accept data without days, \ndf1['Value'] = 0                                  # so they will use day 01 as default. this won't affect analysis  \ndf1['Sugar Type'] = 'Centrifugal'                 # that much but is something to keep in mind.\n\nfor y in year:\n    df1.loc[df1['DateTime'].dt.year == y, 'Value'] = tab1[y].to_numpy()","61a0235e":"df2 = pd.DataFrame(data=date, columns=['DateTime'])\ndf2['DateTime'] = pd.to_datetime(df2['DateTime'])\ndf2['Value'] = 0\ndf2['Sugar Type'] = 'Gur(Jaggery)'\n\nfor y in year:\n    df2.loc[df2['DateTime'].dt.year == y, 'Value'] = tab2[y].to_numpy()","6bd388e1":"df = pd.concat([df1, df2], axis=0)","90a43b94":"df['Year'] = df['DateTime'].dt.year\ndf['Month'] = df['DateTime'].dt.month\n\ndf = df.drop('DateTime', axis=1)\n\ndf","235b3b61":"df3 = pd.concat([tab3['State'], tab3['State'], tab3['State']], ignore_index=True)\n\nprod = pd.concat([tab3[2020], tab3[2021], tab3[2022]], ignore_index=True, axis = 0)\n\n\ndf3 = pd.concat([df3, prod], axis = 1)\n\ndf3['Year'] = 2020\ndf3.iloc[10:20, 2] = 2021\ndf3.iloc[20:30, 2] = 2022\n\n\ndf3 = df3.rename(columns={0:'Production'})\n\ndf3","dac95810":"df.to_csv('semi_annual_sugar_sales.csv', index=False)\ndf3.to_csv('sugar_production.csv', index=False)","5b8c2369":"This notebook is a quick way to adjust the data files into a acceptable format by kaggle standards, making it easier to manipulate and analyse. Without further a do, let's begin."}}