{"cell_type":{"7f9032cb":"code","89e03980":"code","d8778eb3":"code","e9739aca":"code","322d7845":"code","5a207515":"code","d1fc866e":"code","d8a4c2c3":"code","d0f4efdc":"code","9c984cbd":"code","4931b26f":"code","994f4bb4":"code","c9062903":"code","57251d03":"code","02f177f8":"code","c6b9082a":"code","567493c5":"code","c94e932c":"code","d2073a7d":"code","a80f0814":"code","177942ed":"code","2a41b3ec":"code","592bc728":"code","5d1f8b84":"markdown","58b97d7b":"markdown","2991b9db":"markdown","b77ac9c2":"markdown","6cc45393":"markdown","4f7252cb":"markdown","d3061a6b":"markdown","a759534e":"markdown","98b8ed8e":"markdown","a1fdf17b":"markdown","8c1495f4":"markdown","f20811f3":"markdown","6823d39b":"markdown","3dab0008":"markdown","060c4122":"markdown","7c256f4e":"markdown","79b2880a":"markdown","499b99fa":"markdown","bba18f8b":"markdown","0cdc9df3":"markdown","f2316ec7":"markdown","b33890e6":"markdown","126f6427":"markdown","e98b50fe":"markdown","30db2768":"markdown","cbc97a4f":"markdown"},"source":{"7f9032cb":"import pandas as pd\nimport seaborn as sns\nimport plotly.graph_objects as go\nimport numpy as np\nimport yaml\nfrom collections import Counter\nfrom sklearn.preprocessing import OneHotEncoder, LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.manifold import TSNE\nfrom catboost import CatBoostClassifier, Pool","89e03980":"def split_to_onehot(df, col):\n    \"\"\"\n    This method converts features separated by '|' into one-hot vectors.\n    Additionally it drops unnecessary values, which present only in\n    test set \/ train set or have only one value.\n    \"\"\"\n    # Getting all unique ganres values.\n    unique = []\n    for i in df.index:\n        unique.extend(df.loc[i, col].split(\"|\"))\n    if \"\" in unique:\n        unique.remove(\"\")\n    unique = list(set(unique))\n\n    # Putting values into binary form\n    onehot = df.loc[:, [\"Category\"]]\n    onehot[unique] = np.zeros((len(unique),), dtype=np.int8)\n    for i in df.index:\n        g = set(df.loc[i, col].split(\"|\"))\n        for j in g:\n            if j != \"\":\n                onehot.loc[i, j] = 1\n\n    # Dropping unnecessary values\n    _a = onehot.groupby(\"Category\").sum()\n    only_one = list(_a.sum()[_a.sum() == 1].index)\n    only_train = list(_a.loc[\"none\"][_a.loc[\"none\"] == 0].index)\n    only_test = list(_a.loc[[\"like\", 'dislike']].sum()[_a.loc[[\"like\", 'dislike']].sum() == 0].index)\n    _a = set(only_one + only_train + only_test)\n    onehot = onehot.drop(_a, axis=1)\n\n    return onehot\n\n\ndef onehot_to_tsne2(df, title):\n    \"\"\"\n    This method converts one-hot representation into two tsne values.\n    Such operation is needed to shrink the dimentionality of the dataset\n    \"\"\"\n    onehot = df.drop(\"Category\", axis=1)\n    embedding = TSNE(n_components=2, init=\"pca\")\n    embedded = embedding.fit_transform(onehot)\n    embedded = pd.DataFrame(embedded, columns=[f\"{title}_tsne1\", f\"{title}_tsne2\"]).astype('float64')\n    return embedded","d8778eb3":"train = pd.read_csv(\"..\/input\/mymusicalprefrences\/train.csv\")\ntest = pd.read_csv(\"..\/input\/mymusicalprefrences\/test.csv\")\ndf = pd.concat([train, test]).reset_index(drop=True)\ntr_mask = ~df.Category.isna()","e9739aca":"df[\"Category\"] = df[\"Category\"].fillna(\"none\").replace({0:\"dislike\",1:\"like\"}) ","322d7845":"df[\"isMajor\"], df[\"Key\"] = df[\"Key\"].apply(lambda x: x.split(\" \")[1]), df[\"Key\"].apply(lambda x: x.split(\" \")[0])\ndf = pd.get_dummies(df, columns=[\"Key\"], prefix=[\"Key\"])\ndf.loc[:,\"isMajor\"] = (df[\"isMajor\"]==\"Major\").astype(int)","5a207515":"# Lets create the decade feature, to detect some music of 80th, 90th etc. as a specific janre\ndf.loc[:,\"Release_decade\"] = (df.loc[:,\"Release_year\"]\/\/10 * 10)\n# Cause of the small number of values, we will put all <90th toone value, called 80th\ndf.loc[df.loc[:,\"Release_decade\"]<1990,\"Release_decade\"] = 1980 ","d1fc866e":"ganres_onehot = split_to_onehot(df, \"Artists_Genres\")\ngenres_embedded = onehot_to_tsne2(ganres_onehot, \"Genres\")\ndf = pd.concat([df,genres_embedded], axis=1)\ndf = df.drop(\"Artists_Genres\", axis=1)","d8a4c2c3":"df[\"BPM\"] = df[\"BPM\"].apply(lambda x: str(x)[1:] if str(x)[0]=='`' else x)\ndf[['Energy', 'Happiness', 'Dancebility','BPM']] = df[['Energy', 'Happiness', 'Dancebility','BPM']].fillna(0)\ndf[['Energy%', 'Happiness%', 'Dancebility%']] = df[['Energy', 'Happiness', 'Dancebility']].apply(lambda x: x\/sum(x), axis=1)\ndf[['Energy%', 'Happiness%', 'Dancebility%']] = df[['Energy%', 'Happiness%', 'Dancebility%']].fillna(0)","d0f4efdc":"df.Labels = df.Labels.fillna('NA')\nlabels_onehot = split_to_onehot(df, \"Labels\")\nlabels_embedded = onehot_to_tsne2(labels_onehot, \"Labels\")\ndf = pd.concat([df,labels_embedded[[\"Labels_tsne1\",\"Labels_tsne2\"]]], axis=1)\ndf = df.drop(\"Labels\", axis=1)","9c984cbd":"df.Artists = df.Artists.fillna(\"NA\")\nallstars = []\nfor i in df.index:\n    allstars.extend(df.loc[i, \"Artists\"].split(\"|\"))\n# We will put some threshold, not to put some rare artists into one-hot vector.\nthreshold = 3\nothers = Counter(allstars)\nothers = [k for k in others if others[k]<=threshold]\nin_train, in_test = [], []\nfor i in df.loc[tr_mask].index:\n    in_train.extend(df.loc[i, \"Artists\"].split(\"|\"))\nfor i in df.loc[~tr_mask].index:\n    in_test.extend(df.loc[i, \"Artists\"].split(\"|\"))\n\nonly_test = set(in_test) - set(in_train)\nonly_train = set(in_train) - set(in_test)\nallstars = list(set(allstars) - set(others) - only_test - only_train)\nothers = set(others) | only_test | only_train\n\nres = []\ndef prune(x):\n    vector = np.zeros(len(allstars)+1) #for others\n    x = [i for i in x.split(\"|\")]\n    for i in range(len(allstars)):\n        vector[i]=1 if allstars[i] in x else 0\n    if len(x)>sum(vector):\n        vector[-1]=1\n    res.append(vector)\n\ndf[\"Artists\"].apply(prune)\nonehot_artists = pd.DataFrame(res, columns = allstars+[\"Others\"], index=df.index)\n\ndf[\"Other_Artists\"] = onehot_artists[\"Others\"]\nonehot_artists = onehot_artists.drop(\"Others\", axis=1)\nonehot_artists[\"Category\"] = df[\"Category\"]\n\nartists_embedded = onehot_to_tsne2(onehot_artists, \"Artists\")\n\ndf = pd.concat([df,artists_embedded[[\"Artists_tsne1\",\"Artists_tsne2\"]]], axis=1)\ndf = df.drop(\"Artists\", axis=1)","4931b26f":"artists_encoder = LabelEncoder()\ndf[\"Track\"] = artists_encoder.fit_transform(df[\"Track\"])","994f4bb4":"df[\"Version\"] = df[\"Version\"].fillna(\"NA\")\nversions = set(df[\"Version\"])\ndf[list(versions)] = OneHotEncoder().fit_transform(df[[\"Version\"]]).toarray()\ndf = df.drop([\"Version\",\"NA\"], axis=1)","c9062903":"df[\"Album_type\"] = df[\"Album_type\"].fillna(\"NA\")\nversions = set(df[\"Album_type\"])\ndf[list(versions)] = OneHotEncoder().fit_transform(df[[\"Album_type\"]]).toarray()\ndf = df.drop([\"Album_type\",\"NA\"], axis=1)","57251d03":"df[\"Album\"] = df[\"Album\"].fillna(\"NA\")\nganres_onehot = split_to_onehot(df, \"Album\")\nalbum_embedded = onehot_to_tsne2(onehot_artists, \"Album\")\ndf = pd.concat([df,album_embedded[[\"Album_tsne1\",\"Album_tsne2\"]]], axis=1)\ndf = df.drop(\"Album\", axis=1)","02f177f8":"df[\"Vocal \"] = df[\"Vocal \"].fillna('N')\nonehot = np.zeros((len(df),2))\nfor i in range(len(df)):\n    v = df.iloc[i][\"Vocal \"]\n    if v == 'F':\n        onehot[i] = [1,0]\n    elif v == 'M':\n        onehot[i] = [0,1]\n    elif v == 'F|M':\n        onehot[i] = [1,1]\ndf[[\"Fem_voc\",\"Mal_voc\"]] = onehot\ndf = df.drop(\"Vocal \",axis=1)","c6b9082a":"df[\"Country\"] = df[\"Country\"].fillna(\"NA\")\ncountry_onehot = split_to_onehot(df, \"Country\")\ncountry_onehot = country_onehot.drop(\"Category\", axis=1)\ndf = pd.concat([df,country_onehot], axis=1)\ndf = df.drop(\"Country\", axis=1)\n\ndf = df.drop([\"Track\", \"Release_year\", \"BPM\", \"Energy\", \"Dancebility\", \"Happiness\"], axis=1)","567493c5":"df","c94e932c":"x, y = df.loc[tr_mask].iloc[:,2:], df.loc[tr_mask,\"Category\"]\ndeploy = df.loc[~tr_mask].iloc[:,2:]\n\ncat_features_index = np.where(x.dtypes != float)[0]\n\nX_train, X_test, y_train, y_test = train_test_split(x, y, test_size=0.1, shuffle=True)\npool = Pool(X_train, y_train, cat_features=cat_features_index, feature_names=list(x.columns))","d2073a7d":"best_params = {\n            'depth': 8,\n            'iterations': 500,\n            'l2_leaf_reg': 25,\n            'learning_rate': 0.05,\n            'random_strength': 0.5,\n    }","a80f0814":"model_cat = CatBoostClassifier(**best_params,\n                               loss_function='Logloss',\n                               eval_metric='Accuracy',\n                               nan_mode='Min',\n                               thread_count=8,\n                               task_type='CPU',\n                               verbose=True)","177942ed":"model_cat.fit(pool,\n              eval_set=(X_test, y_test),\n              verbose_eval=300,\n              use_best_model=True,\n              plot=False)","2a41b3ec":"sample = pd.read_csv(\"..\/input\/mymusicalprefrences\/sample_submition.csv\")\nsample[\"Category\"] = model_cat.predict(deploy)\nsample[\"Category\"] = (sample[\"Category\"]==\"like\").astype(int)","592bc728":"sample.to_csv(\".\/deploy.csv\", index=False)","5d1f8b84":"# Tracks\n\nLabaelEncoder - \u043c\u0435\u043d\u044f\u0435\u0442 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u043f\u0435\u0440\u0435\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0435","58b97d7b":"# \u0424\u0438\u0447\u0430 Artists\n\u041c\u043e\u0435 \u043f\u043e\u0447\u0442\u0435\u043d\u0438\u0435, \u044f \u0440\u0430\u0437\u043e\u0431\u0440\u0430\u043b\u0441\u044f \u0441 \u0442\u0435\u043c, \u043a\u0430\u043a \u0442\u0443\u0442 \u043e\u0442\u0441\u0435\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u0440\u044b, \u0432\u043e\u0437\u044c\u043c\u0443 \u043d\u0430 \u0437\u0430\u043c\u0435\u0442\u043a\u0443, \u044f \u0431\u044b \u0442\u0430\u043a \u043e\u0444\u043a \u043d\u0435 \u0441\u043c\u043e\u0433 \u043d\u0430 \u0434\u0430\u043d\u043d\u043e\u043c \u044d\u0442\u0430\u043f\u0435 :(\n\n(Feature engeneering -- \u043a\u0440\u0443\u0442\u0430\u044f \u0448\u0442\u0443\u043a\u0430 \u0441\u043a\u0430\u0436\u0443 \u044f \u0432\u0430\u043c)","2991b9db":"\u041f\u0443\u043d\u043a\u0442 \"Explorational Data Analysis\" \u044f \u0431\u043b\u0430\u0433\u043e\u043f\u043e\u043b\u0443\u0447\u043d\u043e \u0441\u043a\u0438\u043f\u0430\u044e, \u043c\u043d\u0435 \u043d\u0435\u0447\u0435\u0433\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0438\u043b\u0438 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c.","b77ac9c2":"\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e \u043c\u044b\u0441\u043b\u044c \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0438\u0442\u043e\u0433\u043e\u0432\u044b\u0439 dataframe \u043d\u0430 \u044d\u043a\u0440\u0430\u043d, \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0447\u0442\u043e \u0432\u044b\u0448\u043b\u043e","6cc45393":"# \u0424\u0438\u0447\u0438 Tracks, Version, Album_type\n","4f7252cb":"\u0421\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u0442\u0443\u0442 \u043c\u044b \u043e\u0431\u044a\u044f\u0432\u043b\u044f\u0435\u043c \u043d\u0443\u0436\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438: (\u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u044e, \u0447\u0442\u043e \u0440\u0430\u0441\u0448\u0430\u0440\u0438\u043b, \u0430 \u043d\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \u043a\u043e\u043f\u0438\u043f\u0430\u0441\u0442\u0438\u043b Heh)\n1. split_to_onehot -- \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u0432 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u044f\u0445 \u043f\u0440\u043e \u044d\u0442\u0443 \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u0432\u0441\u0451 \u043f\u043e \u0444\u0430\u043a\u0442\u0443, \u0438\u043c\u0445\u043e \u043a\u0440\u0443\u0442\u043e \u043f\u0440\u043e\u0430\u043f\u0433\u0440\u0435\u0439\u0436\u0435\u043d\u043d\u0430\u044f get_dummies \u0444\u0443\u043d\u043a\u0446\u0438\u044f pandas\n2. onehot_to_tsne2 -- \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u0442 onehot \u0432\u0435\u043a\u0442\u043e\u0440 \u0432 2 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f t-SNE\n\n(\u043e\u0442 \u0441\u0435\u0431\u044f \u0434\u043e\u0431\u0430\u0432\u043b\u044e \u0442\u0443\u0442 \u044f \u0432\u043e\u043e\u0431\u0449\u0435 \u043d\u0435 \u043f\u043e\u043d\u044f\u043b, \u0447\u0442\u043e \u0442\u0443\u0442 \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442,\n\u043f\u043e\u043d\u044f\u0442\u043d\u043e\u0435 \u0434\u0435\u043b\u043e \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 T-\u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043a\u0430\u043a\u0438\u043c-\u0442\u043e \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u0432 \u0434\u0432\u0443\u043c\u0435\u0440\u043d\u043e\u043c \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0435 \u0441\u043e\u043e\u0442\u043d\u043e\u0441\u0438\u0442 \u043b\u0430\u0439\u043a\/\u0434\u0438\u0437\u043b\u0430\u0439\u043a \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0436\u0430\u043d\u0440\u0430 \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u0440\u0443\u0433\u0438\u0445 \u0436\u0430\u043d\u0440\u043e\u0432, \u043d\u043e \u0447\u0442\u043e \u0433\u043e\u0432\u043e\u0440\u044f\u0442 \u044d\u0442\u0438 \u0446\u0438\u0444\u0440\u044b \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c\u044b\u0435 \u0432 tsne_1 \u0438 tsne_2 \u043d\u0435 \u043e\u0441\u043e\u0431\u043e \u043f\u043e\u043d\u044f\u0442\u043d\u043e)\n\n![](https:\/\/sun1-23.userapi.com\/impg\/fuIS9M9256ICXbmJqflX6CvQI35rTeaDAkJq5Q\/cI9kd7CX0OE.jpg?size=50x0&quality=88&crop=67,67,378,378&sign=cfd5b496130488fc8883229da2b868be&ava=1)\n\n\u041f\u044b\u0442\u0430\u043b\u0441\u044f \u043a\u0441\u0442\u0430\u0442\u0438 \u043f\u043e\u044d\u043a\u0441\u043f\u0435\u0440\u0435\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c, \u043d\u043e \u043d\u0435 \u043f\u043e\u043d\u044f\u043b, \u0447\u0442\u043e \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f\n\n3. \u0412\u0441\u0435 \u0447\u0442\u043e \u0441\u0432\u044f\u0437\u0430\u043d\u043e \u0441 \u0430\u043d\u0430\u043b\u0438\u0437\u043e\u043c \u0438 \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u0435\u043c \u0433\u0440\u0430\u0444\u0438\u043a\u043e\u0432 \u044f \u043f\u043e\u043d\u044f\u043b \u0438\u0437 \u043f\u0435\u0440\u0432\u043e\u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043d\u0435 \u0441\u0442\u0430\u043b \u0432\u043a\u043b\u044e\u0447\u0430\u0442\u044c \u0432 \u0440\u0430\u0431\u043e\u0442\u0443\n\n![](https:\/\/cdn.cloudflare.steamstatic.com\/steamcommunity\/public\/images\/avatars\/85\/85fe4e876c918fd01805bcb0592dbe279b6b02e9_medium.jpg)","d3061a6b":"\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0440\u0430\u0431\u043e\u0442\u044b \u043a\u043e\u043c\u043f\u043e\u0437\u0438\u0446\u0438\u0438 \u0434\u0435\u0440\u0435\u0432\u044c\u0435\u0432 \u0441 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0439","a759534e":"![](https:\/\/www.looperman.com\/media\/avatars\/lrg\/looperman-avatar-02989330.jpg)\n\n# \u041f\u0440\u0438\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e \u0441\u043c\u043e\u0442\u0440\u044f\u0449\u0438\u0445!\n\u0414\u0430, \u044f \u0440\u0435\u0448\u0438\u043b \u043d\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0432\u0441\u0435 \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u043e\u043c\u0443, \u0434\u0430 - \u044f. \u041f\u043e\u0435\u0445\u0430\u043b\u0438!\n\n\u041f\u043e\u0447\u0442\u0438 \u0432\u0435\u0441\u044c \u043a\u043e\u0434 \u044f \u0432\u0437\u044f\u043b \u0438\u0437 \"Final project: Example solution\" \u043f\u043e \u043f\u0440\u0438\u0447\u0438\u043d\u0435 \u0442\u043e\u0433\u043e, \u0447\u0442\u043e Keras \u0440\u0435\u0448\u0438\u043b \u0443\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043c\u043d\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0443 54 -- \u043d\u0430\u043e\u0442\u0440\u0435\u0437 \u043e\u0442\u043a\u0430\u0437\u044b\u0432\u0430\u043b\u0441\u044f \u043e\u0431\u0443\u0447\u0430\u0442\u044c\u0441\u044f \u0432\u044b\u0448\u0435 54% \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u043e\u0432 \u0440\u0430\u0441\u043f\u043e\u0437\u043d\u0430\u0432\u0430\u043d\u0438\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435, \u0432\u044b \u0442\u043e\u043b\u044c\u043a\u043e \u0432\u0434\u0443\u043c\u0430\u0439\u0442\u0435\u0441\u044c 54!!!","98b8ed8e":"\u0414\u0435\u043b\u0438\u043c \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u0443\u044e \u0432\u044b\u0431\u043e\u0440\u043a\u0443 \u043d\u0430 \u0432\u0445\u043e\u0434\u044b\u0435 \u0438 \u0432\u044b\u0445\u043e\u0434\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u043f\u043e\u0441\u0442\u0443\u043f\u0430\u0442\u044c \u043d\u0430 \u0432\u0445\u043e\u0434 \u043c\u043e\u0434\u0435\u043b\u0438 \u043a\u043b\u0430\u0441\u0441\u0430 CatBoostClassifier\n\n\u0422\u0430\u043a\u0436\u0435 \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u043c \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u0443\u044e \u0438 \u0442\u0435\u0441\u0442\u043e\u0432\u0443\u044e \u0432\u044b\u0431\u043e\u0440\u043a\u0438 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u043e\u0439 \u043c\u0430\u0441\u043a\u0438\n\n\u0422\u0430\u043a\u0436\u0435 \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u043c \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u0443\u044e \u0432\u044b\u0431\u043e\u0440\u043a\u0443 \u043d\u0430 2:\n* \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u0430\u044f: _train\n* \u0432\u044b\u0431\u043e\u0440\u043a\u0443 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438: _test\n","a1fdf17b":"# \u0423\u0440\u0430\u0430\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u0444\u0438\u0447\u0430 Country\n\n(\u0443\u0441\u0442\u0430\u043b \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c, \u0430 \u0447\u0442\u043e\u0431\u044b \u0431\u044b\u043b\u043e \u0431\u044b, \u0435\u0441\u043b\u0438 \u0431\u044b \u044f \u044d\u0442\u043e \u0432\u0441\u0435 \u0437\u0430\u043a\u043e\u0434\u0438\u043b \u0441\u0430\u043c, \u044f \u0431\u044b \u0443\u0436\u0435 \u0431\u044b\u043b \u043d\u0430 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c \u0443\u0440\u043e\u0432\u043d\u0435 \u0431\u044b\u0442\u0438\u044f)\n\nP.S. \u0412\u0435\u0440\u0438\u043c \u0432 \u0442\u043e, \u0447\u0442\u043e \u043f\u043e\u0441\u043b\u0435 \u0440\u0430\u0437\u0431\u043e\u0440\u0430 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0439 \u044d\u0442\u043e\u0433\u043e \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043c\u043e\u0439 \u0444\u0438\u0447\u0435-\u0438\u043d\u0436\u0435\u043d\u0435\u0440\u0438\u043d\u0433 \u0430\u043f\u043d\u0443\u043b\u0441\u044f \u043d\u0430 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c, \u043f\u043e\u043a\u0430 \u0432\u0441\u0451 \u043f\u043e\u043d\u0438\u043c\u0430\u044e + \u0437\u0430\u043a\u0440\u0435\u043f\u043b\u044f\u044e\n\n![](https:\/\/yt3.ggpht.com\/a-\/AN66SAz7wc-1cAsBolho0LYpvSWtU1x0FvZMLpU9Bw=s88-mo-c-c0xffffffff-rj-k-no)","8c1495f4":"# \u0412\u044b\u0431\u043e\u0440 \u043c\u043e\u0434\u0435\u043b\u0438 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f\n\n\u0417\u0414\u0415\u0421\u042c \u041d\u0410\u0427\u0418\u041d\u0410\u042e\u0422\u0421\u042f \u0420\u0410\u0421\u0425\u041e\u0416\u0414\u0415\u041d\u0418\u042f \u0418 \u041c\u041e\u0418 \u041c\u042b\u0421\u041b\u0418+\u0422\u0420\u0410\u0418\n\nKeras \u0432\u044b\u0448\u0435 54% \u043d\u0430 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u043d\u0435 \u043f\u043e\u0434\u043d\u044f\u043b\u0441\u044f \u043f\u043e\u0441\u043b\u0435 3 \u0447\u0430\u0441\u043e\u0432 \u0442\u0440\u0430\u0435\u0432, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u044f \u0437\u0430\u0431\u0438\u043b \u0438 \u0440\u0435\u0448\u0438\u043b \u0437\u0430\u043a\u044d\u0442\u0431\u0443\u0441\u0442\u0438\u0442\u044c\n","f20811f3":"# \u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043c\u043e\u0435\u0439 \u043c\u043e\u0434\u0435\u043b\u0438\nbest_params - \u043d\u0430\u0438\u0432\u044b\u0441\u0448\u0438\u0439 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 (69.3%)\n\nLogLoss - \u043f\u043e\u0442\u043e\u043c\u0443 \u0447\u0442\u043e \u0431\u0438\u043d\u0430\u0440\u043d\u0430\u044f \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f\n","6823d39b":"# \u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u0438\u044f \u0444\u0438\u0447\u0435\u0439 \n\n\u041f\u0440\u043e\u0441\u0442\u044b\u043c\u0438 \u0441\u043b\u043e\u0432\u0430\u043c\u0438, \u0447\u0442\u043e \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442\u044c:\n1. \u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u043c \u0432\u0441\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0441\u043b\u043e\u0432 \u0432 \u0447\u0438\u0441\u043b\u0430, \u0443\u0433\u0430\u0434\u0430\u0439\u0442\u0435 \u0431\u043b\u0430\u0433\u043e\u0434\u0430\u0440\u044f \u0447\u0435\u043c\u0443? \u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \"split_to_onehot\" \u0438 \"onehot_to_tsne2\"\n2. \u0418\u0449\u0435\u043c \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0442\u0438 \u0432 \u0434\u0430\u043d\u043d\u044b\u0445\n3. \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0444\u0438\u0447\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043b\u0447\u0448\u0435 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u044e\u0442 \u043d\u0430\u0448\u0438 \u0434\u0430\u043d\u043d\u044b\u0435 (\u043d\u0443 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u043e\u0441\u0442\u044b\u043b\u043a\u0430 \u043d\u0430 1 \u043f\u0443\u043d\u043a\u0442 \u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u0438)\n\nLet's go!","3dab0008":"\u0422\u0440\u0435\u043d\u0438\u0440\u0443\u0435\u043c \u043e\u0431\u044a\u0435\u043a\u0442 \u043a\u043b\u0430\u0441\u0441\u0430 \u043d\u0430 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435, \u043e\u0446\u0435\u043d\u0438\u0432\u0430\u0435\u043c \u043f\u043e \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\u043c \u0432\u044b\u0431\u043e\u0440\u043a\u0438 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438\n\n\u0414\u043b\u044f \u0431\u043e\u0440\u044c\u0431\u044b \u0441 \u043f\u0435\u0440\u0435\u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435\u043c \u0438\u0441\u043e\u043f\u043b\u044c\u0437\u0443\u044e \"EarlyStopping\"","060c4122":"# \u0424\u0438\u0447\u0430 Labels\n\u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u0430 \u0432 \u0446\u0435\u043b\u043e\u043c \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u0430\u044f \u0442\u043e\u0439, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043c\u044b \u043f\u0440\u043e\u0434\u0435\u043b\u044b\u0432\u0430\u043b\u0438 \u0441 \u0436\u0430\u043d\u0440\u0430\u043c\u0438, \u043d\u043e\u0443 \u043a\u043e\u043c\u0435\u043d\u0442\u0441","7c256f4e":"# Album_type","79b2880a":"# \u0424\u0438\u0447\u0430 Key\n\u0421\u0442\u0440\u0430\u043d\u043d\u043e \u0447\u0442\u043e, \u043d\u043e\u0442\u044b \u043d\u0430 \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u043e\u043c \u044d\u0442\u043e Key\n\n\u0417\u0430\u0432\u0430\u043d\u0445\u043e\u0442\u044d\u043d\u043a\u043e\u0434\u0438\u043b\u0438 \u043c\u0430\u0436\u043e\u0440\/\u043c\u0438\u043d\u043e\u0440 + \u043d\u043e\u0442\u044b, \u0430 \u0442\u0430\u043a\u0436\u0435 \u0434\u0440\u043e\u043f\u043d\u0443\u043b\u0438 \u0441\u0442\u043e\u043b\u0431\u0435\u0446 \u043d\u043e\u0442 \u0438\u0437 \u0434\u0430\u0442\u0430\u0444\u0440\u0435\u0439\u043c\u0430","499b99fa":"# \u041f\u043e\u0434\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u0438 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043e\u043a\n\u0427\u0442\u043e\u0431\u044b \u0443\u043f\u0440\u043e\u0441\u0442\u0438\u0442\u044c \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u0441 \u043d\u0430\u0431\u043e\u0440\u043e\u043c \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u0435\u0433\u043e \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044e - \u043c\u044b \u0441\u043e\u0431\u0435\u0440\u0435\u043c \u0432\u0441\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438 \u0441\u043e\u0437\u0434\u0430\u0434\u0438\u043c \u043c\u0430\u0441\u043a\u0443, \u0447\u0442\u043e\u0431\u044b \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u044c \u043d\u0430\u0431\u043e\u0440\u044b \u0434\u043b\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0438 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. \u041c\u0430\u0441\u043a\u0430 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u0443\u044e \u0438 \u0442\u0435\u0441\u0442\u043e\u0432\u0443\u044e \u0432\u044b\u0431\u043e\u0440\u043a\u0438 \u043f\u043e \u043b\u0430\u0439\u043a\u0430\u043c\/\u0434\u0430\u0437\u043b\u0438\u0430\u0439\u043a\u0430\u043c. \u0422\u0430\u043c \u0433\u0434\u0435 Nan - \u0442\u0435\u0441\u0442\u043e\u0432\u0430\u044f, \u0442.\u043a. \u043e\u043d\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442\n\n\u0417\u0430\u043c\u0435\u0447\u0430\u043d\u0438\u0435 \u043b\u0430\u0439\u043a\u0438!=\u0441\u043e\u0431\u0430\u0447\u043a\u0438","bba18f8b":"![](https:\/\/memepedia.ru\/wp-content\/uploads\/2021\/04\/grustnyj-i-veselyj-din-norris.jpg)\n\n\u041f\u043e\u043b\u0443\u0447\u0438\u043b\u043e\u0441\u044c \u043f\u0435\u0440\u043f\u0440\u044b\u0433\u043d\u0443\u0442\u044c \n\n\u0431\u0430\u0440\u044c\u0435\u0440 69% \u0437\u0430 10 \u043f\u043e\u043f\u044b\u0442\u043e\u043a_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._.       \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u043e\u0441\u044c","0cdc9df3":"\u0421\u043e\u0437\u0434\u0430\u0435\u043c \u043e\u0431\u044a\u0435\u043a\u0442 \u043a\u043b\u0430\u0441\u0441\u0430 \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0435\u043c \u0432 \u043d\u0435\u0433\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b:","f2316ec7":"# \u0424\u0438\u0447\u0430 Release Year\n\n\u0422\u0443\u0442 \u043c\u044b \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0444\u0438\u0447\u0443 Release_decade, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0432\u0435\u0441\u0442\u0438 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0443 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u0434\u0435\u043a\u0430\u0434\u044b \u043e\u0442 \u043b\u0430\u0439\u043a\u0430\/\u0434\u0438\u0437\u043b\u0430\u0439\u043a\u0430\/none\n\n\u0422\u043e\u043b\u044c\u043a\u043e \u0441\u0435\u0439\u0447\u0430\u0441 \u0434\u043e\u0448\u043b\u043e, \u0447\u0442\u043e \u0432 \u0433\u0440\u0430\u0444\u0438\u043a\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f none - \u044d\u0442\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0438 (\u0440\u0430\u043d\u044c\u0448\u0435 \u0434\u0443\u043c\u0430\u043b, \u0447\u0442\u043e \u0432 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u0431\u044b\u043b \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u0432\u043e\u0437\u0434\u0435\u0440\u0436\u0430\u0442\u044c\u0441\u044f \u043e\u0442 \u0433\u043e\u043b\u043e\u0441\u0430 - none, \u043d\u043e \u043f\u043e\u0441\u043e\u043c\u0442\u0440\u0435\u043b \u0432\u0435\u0437\u0434\u0435 \u0435\u0441\u0442\u044c \u043b\u0430\u0439\u043a \u0438\u043b\u0438 \u0434\u0438\u0437\u043b\u0430\u0439\u043a)","b33890e6":"# \u0424\u0438\u0447\u0438 Energy,Happiness,Dancebility, BPM\n\u0422\u0443\u0442 \u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043d\u0435 \u0442\u0440\u043e\u0433\u0430\u0435\u043c \u0441\u0442\u043e\u043b\u0431\u0446\u044b, \u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u043d\u043e\u0432\u044b\u0435 Energy%  Happiness%  Dancebility%\n\n+ \u0440\u0430\u0437\u043e\u0431\u0440\u0430\u043b\u0441\u044f \u043a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0442 \u043b\u044f\u043c\u0431\u0434\u0430-\u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043d\u0430 \u044d\u0442\u043e\u043c \u0448\u0430\u0433\u0435","126f6427":"# \u0424\u0438\u0447\u0430 Genres\n\u0420\u0430\u0437\u0431\u0438\u043b\u0438 \u043d\u0430 \u043a\u0443\u0447\u0443 \u0436\u0430\u043d\u0440\u043e\u0432 \u0432\u0430\u043d\u0445\u043e\u0442\u043e\u043c, \u0430 \u043f\u043e\u0442\u043e\u043c \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u043b\u0438 \u043f\u043e t-SNE \u043d\u0430 2 \u0442\u0438\u043f\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0435 \u0442\u0435\u0440\u044f\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438, \u0434\u0440\u043e\u043f\u043d\u0443\u043b\u0438 \u0441\u0442\u043e\u043b\u0438\u0431\u043a \u0436\u0430\u043d\u0440\u043e\u0432","e98b50fe":"# Version\n\u0417\u0432\u0430\u0430\u043d\u0445\u043e\u0442\u044d\u043d\u043a\u043e\u0434\u0438\u043b\u0438 \u0432\u0435\u0440\u0441\u0438\u0438\n\n\u042f \u043a\u0441\u0442\u0430\u0442\u0438 \u0440\u0430\u0437\u043e\u0431\u0440\u0430\u043b\u0441\u044f \u0432 \u043e\u0442\u043b\u0438\u0447\u0438\u044f\u0445 \"LabaelEncoder\" \u043e\u0442 \"OneHotEncoder\"","30db2768":"# \u0424\u0438\u0447\u0430 Album\n\u0410\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e \u0436\u0430\u043d\u0440\u0430\u043c \u0438 \u043f\u0440\u043e\u0447\u0435\u043c\u0443","cbc97a4f":"# \u0424\u0438\u0447\u0430 Vocal\n\u0417\u0430\u0432\u0430\u043d\u0445\u043e\u0442\u0438\u043b\u0438 \u043c\u0443\u0436\u0441\u043a\u043e\u0439\/\u0436\u0435\u043d\u0441\u043a\u0438\u0439 \u0432\u043e\u043a\u0430\u043b\n\n(\u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442\u0441\u044f \u0432\u0441\u0435\u0433\u043e \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 2 \u0433\u0435\u043d\u0434\u0435\u0440\u0430 \u0432\u0441\u0435 \u0442\u0430\u043a\u0438)"}}