{"cell_type":{"e57d8ff8":"code","24d635a4":"code","92f07f73":"code","b22d9000":"code","1cb177e4":"code","855d278f":"code","1285ad5c":"code","eced9bf7":"code","234e32dc":"code","740449ea":"code","78580e2b":"code","72749173":"code","7138bd77":"code","b6c100da":"code","cda4441d":"code","12fd5aa3":"code","4e31b657":"code","d4e25c80":"code","c2e17da2":"code","e8df41dd":"code","50925004":"code","0d68826a":"code","582420db":"code","436feade":"code","b773a10a":"code","5b7fce07":"code","3b2fe6c7":"code","0355b9b4":"code","4833fc49":"code","965f7362":"code","5e99ed3c":"code","5a09f6d7":"code","c51e0a42":"code","344f578f":"code","500b5956":"code","f23bd41f":"code","14ca8d22":"code","28c461ac":"code","d29bdf36":"code","49ff6863":"code","d66f170d":"code","815f9f1c":"code","3b1f9870":"code","92e7a602":"code","60d68e48":"code","2d472ff6":"code","712b0092":"code","f3aefe00":"code","e67d60d8":"code","05bbdc8b":"code","c0f757ba":"code","acbfb95b":"code","88b4406e":"code","7995c6d9":"code","07db3737":"code","a2d1b7cf":"code","f984e761":"code","6ff7f971":"code","4b014931":"code","ca338e3e":"code","15bfd773":"code","df7032e3":"markdown","17bbcf90":"markdown","c6d45a9e":"markdown","77ab9208":"markdown","0a8b9df6":"markdown","8f5f3ea1":"markdown","a69cf7cb":"markdown"},"source":{"e57d8ff8":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","24d635a4":"df_train =pd.read_csv(\"..\/input\/titanic\/train.csv\")\ndf_test =pd.read_csv(\"..\/input\/titanic\/test.csv\")\n","92f07f73":"df_train.head()","b22d9000":"df_train.describe()","1cb177e4":"df_train.shape\n","855d278f":"df_test.shape","1285ad5c":"df_test.head()","eced9bf7":"df_train.info()\nprint(\"-\"*40)\ndf_test.info()","234e32dc":"df_train.isnull().sum()","740449ea":"df_test.isnull().sum()","78580e2b":"sns.heatmap(df_train.isnull(),yticklabels=False,cbar=False,cmap='viridis')","72749173":"sns.set_style('whitegrid')\nsns.countplot(x='Survived',data=df_train)","7138bd77":"sns.set_style('whitegrid')\nsns.countplot(x='Survived',data=df_train,hue='Sex',palette='RdBu_r')","b6c100da":"sns.set_style('whitegrid')\nsns.countplot(x='Survived',data=df_train,hue='Pclass',palette='rainbow')","cda4441d":"sns.distplot(df_train['Age'].dropna(),kde=False,color='green',bins=20)","12fd5aa3":"sns.countplot(x='SibSp',data=df_train)","4e31b657":"sns.distplot(df_train['Fare'].dropna(),kde=False,color='blue',bins=20)","d4e25c80":"plt.figure(figsize=(12,7))\nsns.boxplot(x='Pclass',y='Age',data=df_train,palette='winter')","c2e17da2":"def impute_age_train(cols):\n    Age=cols[0]\n    Pclass=cols[1]\n    if pd.isnull(Age):\n        if Pclass ==1:\n            return 37\n        elif Pclass ==2:\n            return 29\n        else:\n            return 24\n    else:\n        return Age\n    ","e8df41dd":"df_train['Age'] = df_train[['Age','Pclass']].apply(impute_age_train,axis=1)","50925004":"sns.heatmap(df_train.isnull(),yticklabels=False,cbar=False,cmap='viridis')","0d68826a":"df_train.drop('Cabin',axis=1,inplace=True)","582420db":"df_train.head()","436feade":"pd.get_dummies(df_train['Embarked'],drop_first=True).head()\n","b773a10a":"sex=pd.get_dummies(df_train['Sex'],drop_first=True)\nembark=pd.get_dummies(df_train['Embarked'],drop_first=True)","5b7fce07":"df_train.drop(['Sex','Embarked','Name','Ticket'],axis=1,inplace=True)","3b2fe6c7":"df_train.head()","0355b9b4":"df_train=pd.concat([df_train,sex,embark],axis=1)\n","4833fc49":"df_train.isnull().sum()","965f7362":"df_train.head()","5e99ed3c":"df_train.drop('Survived',axis=1).head()","5a09f6d7":"df_train['Survived'].head()","c51e0a42":"# Splitting the train data for training the model \nfrom sklearn.model_selection import train_test_split","344f578f":"x_train,x_test,y_train,y_test =train_test_split(df_train.drop('Survived',axis=1),\n                                               df_train['Survived'], test_size=0.30,\n                                               random_state=101)","500b5956":"from sklearn.linear_model import LogisticRegression","f23bd41f":"logmodel =LogisticRegression()\nlogmodel.fit(x_train,y_train)","14ca8d22":"predictions =logmodel.predict(x_test)","28c461ac":"from sklearn.metrics import confusion_matrix","d29bdf36":"accuracy =confusion_matrix(y_test,predictions)","49ff6863":"accuracy","d66f170d":"from sklearn.metrics import accuracy_score","815f9f1c":"accuracy=accuracy_score(y_test,predictions)\naccuracy","3b1f9870":"# Saving the model\n\nimport joblib\njoblib.dump(logmodel, \"logistic_regression.pkl\")\n\n","92e7a602":"df_test.head()","60d68e48":"plt.figure(figsize=(12,7))\nsns.boxplot(x='Pclass',y='Age',data=df_test,palette='winter')","2d472ff6":"# Mean imputation of 'Age'\ndef impute_age_test(cols):\n    Age=cols[0]\n    Pclass=cols[1]\n    if pd.isnull(Age):\n        if Pclass ==1:\n            return 42\n        elif Pclass ==2:\n            return 27\n        else:\n            return 24\n    else:\n        return Age\n    ","712b0092":"df_test['Age'] = df_test[['Age','Pclass']].apply(impute_age_test,axis=1)","f3aefe00":"sns.heatmap(df_test.isnull(),yticklabels=False,cbar=False,cmap='viridis')","e67d60d8":"df_test.drop('Cabin',axis=1,inplace=True)","05bbdc8b":"new_test =df_test.fillna(method=\"ffill\")","c0f757ba":"new_test.isnull().sum()","acbfb95b":"pd.get_dummies(new_test['Embarked'],drop_first=True).head()\n","88b4406e":"sex=pd.get_dummies(new_test['Sex'],drop_first=True)\nembark=pd.get_dummies(new_test['Embarked'],drop_first=True)","7995c6d9":"new_test.drop(['Sex','Embarked','Name','Ticket'],axis=1,inplace=True)","07db3737":"new_test.head()","a2d1b7cf":"new_test=pd.concat([new_test,sex,embark],axis=1)\n","f984e761":"new_test.isnull().sum()","6ff7f971":"import joblib\n\nclassifier = joblib.load(\"logistic_regression.pkl\")","4b014931":"Y_pred = classifier.predict(new_test)\n\nY_pred = Y_pred.astype(np.int16)\npredictions = pd.DataFrame({'PassengerId':new_test['PassengerId'],'Survived':Y_pred})\npredictions.shape","ca338e3e":"predictions.head()\n\n","15bfd773":"#saving predictions as csv file\nfilename = 'Titanic Predictions 1.csv'\n\npredictions.to_csv(filename,index=False)\n\nprint('Saved file: ' + filename)\n\n","df7032e3":"# Exploratory data analysis","17bbcf90":"# Using Logistic regression","c6d45a9e":"#  **Loading the required libraries**","77ab9208":"# Mean imputation of 'Age'","0a8b9df6":"# **Visualizing for missing values**","8f5f3ea1":"# predicting test.csv","a69cf7cb":"# Loading test.csv and train.csv"}}