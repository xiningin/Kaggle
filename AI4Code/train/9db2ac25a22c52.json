{"cell_type":{"112fd55e":"code","3f4daa1c":"code","0c24959f":"code","dc66b48b":"code","abb48c0e":"code","b9d8f925":"code","4895b39e":"code","ad324611":"code","c427f3cd":"code","80ba0558":"code","bc0a6b3a":"code","735fa45e":"code","c67488f7":"code","2442620c":"code","a90c3a9a":"code","146ad6b0":"code","2c72993a":"code","a672fd31":"code","035e045d":"code","39b00d8a":"code","3b9e3795":"code","7b3c193c":"code","74ec03f5":"code","295abdbe":"code","f2d1496a":"code","e3dcd472":"code","9a5d0820":"code","042cd39c":"code","c48a300c":"code","d59f61f1":"code","3732a120":"code","801dc55b":"code","bf0dea5e":"code","9a41f0e8":"code","d31a0d8c":"code","edb0ec84":"markdown","d61da920":"markdown","056c7a57":"markdown","7afd9f9e":"markdown","9f7ba3b6":"markdown","81303eb7":"markdown"},"source":{"112fd55e":"import numpy as np\nimport matplotlib.pyplot as plt\nimport math\nimport random\nimport pandas as pd\nimport scipy.stats as stat\nfrom collections import Counter\nfrom scipy.stats import t\nfrom scipy.stats import norm\nfrom sklearn.utils import shuffle\n\nimport os\n\npath = os.environ['PATH']\n\nif path.startswith('C'):\n    IN_KAGGLE = False\nelse:\n    IN_KAGGLE = True","3f4daa1c":"# Para uso com fun\u00e7\u00f5es da biblioteca standard (ex random.randint)\nrandom.seed(1)\n# Para uso com fun\u00e7\u00f5es da biblioteca numpy (ex np.random.randint)\nnp.random.seed(1)\n\n# Quando for passada como par\u00e2metro a seed\nrandom_state = 1","0c24959f":"# Calcula n\u00famero de desvios na distribui\u00e7\u00e3o t de student para determinada confianca\n\n\ndef calcula_Z_tstudent(confianca, tamanho_amostra):\n    mean = 0\n    std = 1\n    rv = t(df=(tamanho_amostra-1))\n    return rv.interval(confianca)[1]","dc66b48b":"# Calcula n\u00famero de desvios na distribui\u00e7\u00e3o normal para determinada confianca\n\n\ndef calcula_Z_normal(confianca):\n    mean = 0\n    std = 1\n    rv = norm(loc=mean, scale=std)\n    return rv.interval(confianca)[1]","abb48c0e":"# Calcula n\u00famero de desvios na distribui\u00e7\u00e3o normal para determinada confianca e m\u00faltiplas propor\u00e7\u00f5es\n\ndef calcula_Z_Multiplas_Proporcoes(confianca, numero_proporcoes):\n    area = math.pow(  confianca, 1\/(numero_proporcoes-1) )\n    return calcula_Z_normal(area)","b9d8f925":"# Recupera amostra da popula\u00e7\u00e3o\n\ndef recupera_amostra(populacao, tamanho_amostra):\n    tamanho_amostra = int(tamanho_amostra)\n    if type(populacao) is pd.DataFrame:\n        return populacao.sample(tamanho_amostra)\n    else:\n        #return populacao[np.random.randint(0, len(populacao), tamanho_amostra)]\n        return [populacao[i] for i in np.random.randint(0, len(populacao), tamanho_amostra)]\n","4895b39e":"# Fun\u00e7\u00e3o que calcula intervalo de confian\u00e7a para m\u00e9dia com base em uma amostra e a confian\u00e7a desejada\n\ndef calcula_intervalo_media(amostra, confianca, tamanho_populacao):\n    tamanho_amostra = len(amostra)\n    \n    #1-Calcule a m\u00e9dia da amostra ex. media_amostra = np.mean(amostra)\n    media_amostra = np.mean(amostra)\n\n    #2-Calcule o desvio da amostra ex. desvio_amostra = np.std(amostra)\n    desvio_amostra = np.std(amostra)\n\n    #3-Calcule quantos desvios precisar\u00e1 para seu grau de confi\u00e2n\u00e7a ex. numero_desvios = calcula_numero_desvios_tstudent_para_confianca(confian\u00e7a, tamanho_amostra)\n    numero_desvios = calcula_Z_tstudent(confianca, tamanho_amostra)\n\n    #4-Calcule o desvio das amostras ex. desvio_amostras = desvio_amostra\/np.sqrt(tamanho_amostra)\n    desvio_amostras = desvio_amostra\/np.sqrt(tamanho_amostra)\n\n    #5-Calcule a margem de erro ex. margem_erro = numero_desvios*desvio_amostras\n    margem_erro = numero_desvios*desvio_amostras\n    \n    if tamanho_amostra>0.05*tamanho_populacao:\n        margem_erro = margem_erro * (np.sqrt(tamanho_populacao-tamanho_amostra)\/np.sqrt(tamanho_populacao-1))\n\n    #6-Calcule o intervalo ex. inferior = media_amostra-margem_erro, superior = media_amostra+margem_erro\n    inferior = media_amostra-margem_erro\n    superior = media_amostra+margem_erro\n\n    return inferior,superior","ad324611":"# Fun\u00e7\u00e3o que calcula intervalo de confian\u00e7a para propor\u00e7\u00e3o de determinado valor com base em uma amostra e a confian\u00e7a desejada\n# O par\u00e2metro valor representa a categoria na amostra para a qual se deseja o intervalo de confian\u00e7a da propor\u00e7\u00e3o, por exemplo o nome de um candidato\n\ndef calcula_intervalo_proporcao(amostra, confianca, valor, tamanho_populacao):\n    tamanho_amostra = len(amostra)\n    \n    proporcao_valor = Counter(amostra)[valor]\/tamanho_amostra\n    \n    numero_desvios = calcula_Z_tstudent(confianca, tamanho_amostra)\n\n    margem_erro = numero_desvios*np.sqrt(proporcao_valor*(1-proporcao_valor))\/np.sqrt(tamanho_amostra)\n    \n    if tamanho_amostra>0.05*tamanho_populacao:\n        margem_erro = margem_erro * (np.sqrt(tamanho_populacao-tamanho_amostra)\/np.sqrt(tamanho_populacao-1))\n\n    inferior = proporcao_valor-margem_erro\n    superior = proporcao_valor+margem_erro\n\n    return inferior,superior","c427f3cd":"# Fun\u00e7\u00e3o para c\u00e1lculo do n\u00famero de amostras para m\u00e9dias e somas\n\ndef Tamanho_Amostra_Valor_Pontual(Tamanho_Populacao, Grau_Confianca, Variancia, Margem_Erro):\n    Numero_Desvios = calcula_Z_normal(Grau_Confianca)\n    return math.ceil( \n            (Tamanho_Populacao * math.pow(Numero_Desvios,2) * Variancia) \/ \\\n            ( (Tamanho_Populacao-1)*math.pow(Margem_Erro,2) + math.pow(Numero_Desvios,2)*Variancia )\n            )","80ba0558":"# Fun\u00e7\u00e3o para c\u00e1lculo do n\u00famero de amostras para propor\u00e7\u00f5es simples\n\ndef Tamanho_Amostra_Proporcao_Simples(Tamanho_Populacao, Grau_Confianca, Proporcao, Margem_Erro):\n    Numero_Desvios = calcula_Z_normal(Grau_Confianca)\n    return math.ceil( \n            (Tamanho_Populacao * math.pow(Numero_Desvios,2) * Proporcao * (1-Proporcao)) \/ \\\n            ( (Tamanho_Populacao-1)*math.pow(Margem_Erro,2) + math.pow(Numero_Desvios,2)*Proporcao*(1-Proporcao) )\n            )","bc0a6b3a":"# Fun\u00e7\u00e3o para c\u00e1lculo do tamanho da amostra para propor\u00e7\u00f5es m\u00faltiplas\n\ndef Tamanho_Amostra_Proporcao_Multipla(Tamanho_Populacao, Confianca, Numero_Proporcoes, Margem_Erro):\n    Confianca_ = calcula_Z_Multiplas_Proporcoes(Confianca, Numero_Proporcoes)\n    return math.ceil( \n            (Tamanho_Populacao * math.pow(Confianca_,2) * 0.25 ) \/ \\\n            ( (Tamanho_Populacao-1)*math.pow(Margem_Erro,2) + math.pow(Confianca_,2)*0.25 )\n            )","735fa45e":"def grafico(planilha, coluna):\n    planilha[coluna].value_counts().plot(kind='bar')\n    plt.xlabel(coluna)\n    plt.ylabel('Quantidade')\n\n    plt.title(coluna)\n    plt.grid(True)\n    plt.show()\n    \n    print(planilha[coluna].value_counts()\/len(planilha))","c67488f7":"def histograma(planilha, coluna):\n    n, bins, patches = plt.hist(planilha[coluna],  facecolor='g', alpha=0.75, bins=50)\n    plt.xlabel(coluna)\n    plt.ylabel('Quantidade')\n\n    plt.title(coluna)\n    plt.grid(True)\n    plt.show()\n    print('M\u00e9dia {}, desvio padr\u00e3o {}'.format(planilha[coluna].mean(),planilha[coluna].std()))\n    ","2442620c":"def aplicaPolitica(PopulacaoControle,PopulacaoTeste ):\n    PopulacaoControlePosPolitica = PopulacaoControle.copy()\n    PopulacaoControlePosPoliticaMediaSalario = PopulacaoControlePosPolitica.Salario.mean()\n    PopulacaoControlePosPoliticaMediaSalario = PopulacaoControlePosPoliticaMediaSalario * 1.1\n    PopulacaoControlePosPolitica.Salario = PopulacaoControlePosPolitica.Salario * norm(loc=PopulacaoControlePosPoliticaMediaSalario, scale=0.1*PopulacaoControlePosPoliticaMediaSalario).rvs(size=TamanhoPopulacaoControle)\n\n    PopulacaoTestePosPolitica = PopulacaoTeste.copy()\n    PopulacaoTestePosPoliticaMediaSalario = PopulacaoTestePosPolitica.Salario.mean()\n    PopulacaoTestePosPoliticaMediaSalario = PopulacaoTestePosPoliticaMediaSalario * 1.3\n    PopulacaoTestePosPolitica.Salario = PopulacaoTestePosPolitica.Salario * norm(loc=PopulacaoTestePosPoliticaMediaSalario, scale=0.1*PopulacaoTestePosPoliticaMediaSalario).rvs(size=TamanhoPopulacaoTeste)\n\n    return PopulacaoControlePosPolitica, PopulacaoTestePosPolitica","a90c3a9a":"populacao = pd.read_excel('..\/input\/votacaosimuladaeleicaopresidencialbrasil2018\/populacao.xlsx', index_col=0) ","146ad6b0":"populacao.head()","2c72993a":"len(populacao)","a672fd31":"histograma(populacao,'Salario')","035e045d":"histograma(populacao,'Idade')","39b00d8a":"grafico(populacao,'Regiao')","3b9e3795":"grafico(populacao,'Voto')","7b3c193c":"grafico(populacao,'Sexo')","74ec03f5":"Margem_Erro_Salario = 100\nMargem_Erro_Proporcao_Sexo = 0.05\nMargem_Erro_Proporcao_Votos = 0.05\n    \nGrau_Confianca = 0.95","295abdbe":"Tamanho_Amostra = 30\namostra = recupera_amostra(populacao, Tamanho_Amostra)\n\nVariancia_Salario_Estimada = amostra.Salario.var()\nprint(Variancia_Salario_Estimada)\n\nProporcao_Sexo_M = sum (amostra.Sexo=='M')\/Tamanho_Amostra\nprint(Proporcao_Sexo_M)","f2d1496a":"amostra.head()","e3dcd472":"Tamanho_Populacao = len(populacao)","9a5d0820":"#Tamanho_Amostra_Salario\n\nTamanho_Amostra_Salario = Tamanho_Amostra_Valor_Pontual(Tamanho_Populacao, Grau_Confianca, Variancia_Salario_Estimada, Margem_Erro_Salario)\nprint (Tamanho_Amostra_Salario)","042cd39c":"#Tamanho_Amostra_Sexo\n\nTamanho_Amostra_Sexo = Tamanho_Amostra_Proporcao_Simples(Tamanho_Populacao, Grau_Confianca, Proporcao_Sexo_M, Margem_Erro_Proporcao_Sexo)\n\nprint (Tamanho_Amostra_Sexo)","c48a300c":"#Tamanho_Amostra_Votacao  \n\nTamanho_Amostra_Votacao = Tamanho_Amostra_Proporcao_Multipla(Tamanho_Populacao, Grau_Confianca, 4, Margem_Erro_Proporcao_Votos)\nprint (Tamanho_Amostra_Votacao)","d59f61f1":"amostra = pd.read_excel('..\/input\/amostra\/amostra.xlsx', index_col=0) \namostra.head()","3732a120":"inferior,superior = calcula_intervalo_media(amostra.Salario, Grau_Confianca, Tamanho_Populacao)\nprint('Intervalo da m\u00e9dia {} {}'.format(inferior,superior))\nprint('Margem de erro {}'.format((superior-inferior)\/2))","801dc55b":"inferior,superior = calcula_intervalo_proporcao(amostra.Sexo, Grau_Confianca, 'M', Tamanho_Populacao)\nprint('Intervalo de confian\u00e7a M {} {}'.format(inferior,superior))\nprint('Margem de erro {}'.format((superior-inferior)\/2))","bf0dea5e":"inferior,superior = calcula_intervalo_proporcao(amostra.Voto, Grau_Confianca, 'B', Tamanho_Populacao)\nprint('Intervalo de confian\u00e7a B {} {}'.format(inferior,superior))\nprint('Margem de erro {}'.format((superior-inferior)\/2))","9a41f0e8":"inferior,superior = calcula_intervalo_media(amostra.Idade, Grau_Confianca, Tamanho_Populacao)\nprint('Intervalo da m\u00e9dia {} {}'.format(inferior,superior))\nprint('Margem de erro {}'.format((superior-inferior)\/2))","d31a0d8c":"inferior,superior = calcula_intervalo_proporcao(amostra.Regiao, Grau_Confianca, 'Sudeste', Tamanho_Populacao)\nprint('Intervalo de confian\u00e7a B {} {}'.format(inferior,superior))\nprint('Margem de erro {}'.format((superior-inferior)\/2))","edb0ec84":"Calcule o intervalo de confi\u00e2n\u00e7a para a propor\u00e7\u00e3o de votos do candidato B na popula\u00e7\u00e3o\nCompare o intervalo com a propor\u00e7\u00e3o real da popula\u00e7\u00e3o\nCompare a margem de erro calculada com a margem de erro inicialmente proposta","d61da920":"Utilize uma base j\u00e1 carregada\nNo modo de edi\u00e7\u00e3o do notebook, canto superior direito, selecione \"Add Data\"\n\nProcure a base que deseja, neste exemplo \"VotacaoSimuladaEleicaoPresidencialBrasil2018\"","056c7a57":"Calcule o intervalo de confi\u00e2n\u00e7a para a propor\u00e7\u00e3o de sexo masculino na popula\u00e7\u00e3o\nCompare o intervalo com a propor\u00e7\u00e3o real da popula\u00e7\u00e3o\nCompare a margem de erro calculada com a margem de erro inicialmente proposta","7afd9f9e":"Calcule o intervalo de confi\u00e2n\u00e7a para a m\u00e9dia de sal\u00e1rios na popula\u00e7\u00e3o\nCompare o intervalo com a m\u00e9dia real da popula\u00e7\u00e3o\nCompare a margem de erro calculada com a margem de erro inicialmente proposta","9f7ba3b6":"1- Valor pontual - Sal\u00e1rio\n2- Propor\u00e7\u00e3o simples - Sexo\n3- Propor\u00e7\u00e3o m\u00faltipla  - Votos","81303eb7":"Calcule o intervalo de confian\u00e7a para a idade m\u00e9dia da popula\u00e7\u00e3o e a propor\u00e7\u00e3o de habitantes da regi\u00e3o sudeste\nCalcule o tamanho da amostra necess\u00e1rio para ambas as vari\u00e1veis\nA amostra fornecida tem tamanho suficiente para realizar os c\u00e1lculos pedidos?"}}