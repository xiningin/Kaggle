{"cell_type":{"4bd35b4c":"code","6c729f27":"code","b87ce18a":"code","0e0c9dde":"code","276cf57a":"code","593bc8d0":"code","af69e23f":"code","7a929357":"code","b6f95f16":"code","d84480e8":"code","1c3486c6":"code","21f8b1b3":"code","cdf2b3de":"code","dc678230":"code","c40c8f8d":"code","bddbf4e0":"code","156a6ae8":"markdown","cacffd40":"markdown","a9d8586f":"markdown","5913cc49":"markdown","c86bc96d":"markdown","03622034":"markdown","d0af181d":"markdown","54f5e235":"markdown","0d161b19":"markdown","d088a235":"markdown"},"source":{"4bd35b4c":"import os\nos.listdir('..\/input\/segmented-bob-ross-images\/train\/images\/')[:5]","6c729f27":"from PIL import Image","b87ce18a":"imgs_dir = '..\/input\/segmented-bob-ross-images\/train\/images\/'\nImage.open(imgs_dir + 'painting53.png')","0e0c9dde":"Image.open(imgs_dir + 'painting224.png')","276cf57a":"len(os.listdir('..\/input\/segmented-bob-ross-images\/train\/images\/'))","593bc8d0":"Image.open(imgs_dir + 'painting336.png')","af69e23f":"import numpy as np\nsegmaps_dir = '..\/input\/segmented-bob-ross-images\/train\/labels\/'\nsegmap = np.array(Image.open(segmaps_dir + 'painting224.png'))\nsegmap","7a929357":"np.unique(segmap)","b6f95f16":"import pandas as pd\npd.read_csv(\n    \"..\/input\/segmented-bob-ross-images\/labels.csv\", header=None,\n    names=['Class']\n)","d84480e8":"np.array(Image.open(imgs_dir + 'painting224.png')).shape","1c3486c6":"np.array(Image.open(imgs_dir + 'painting20.png')).shape","21f8b1b3":"import matplotlib.pyplot as plt\nfig, axarr = plt.subplots(1, 2, figsize=(12, 4))\naxarr[0].imshow(np.array(Image.open(imgs_dir + 'painting224.png')))\naxarr[1].imshow(np.array(Image.open(segmaps_dir + 'painting224.png')))","cdf2b3de":"fig, axarr = plt.subplots(1, 2, figsize=(12, 4))\naxarr[0].imshow(np.array(Image.open(imgs_dir + 'painting20.png')))\naxarr[1].imshow(np.array(Image.open(segmaps_dir + 'painting20.png')))","dc678230":"fig, axarr = plt.subplots(1, 2, figsize=(12, 4))\naxarr[0].imshow(np.array(Image.open(imgs_dir + 'painting10.png')))\naxarr[1].imshow(np.array(Image.open(segmaps_dir + 'painting10.png')))","c40c8f8d":"%ls ..\/input\/segmented-bob-ross-images\/","bddbf4e0":"import matplotlib.pyplot as plt\nfig, axarr = plt.subplots(1, 2, figsize=(12, 4))\naxarr[0].imshow(np.array(Image.open(imgs_dir + 'painting74.png')))\naxarr[1].imshow(np.array(Image.open('..\/input\/segmented-bob-ross-images\/painting74.png')))","156a6ae8":"## Data exploration","cacffd40":"The class labels used are borrowed from the [ADE20K ontology](https:\/\/groups.csail.mit.edu\/vision\/datasets\/ADE20K\/). The list of labels is kept very simple, with just nine classes total, because the dataset is very small, with just 250 images.","a9d8586f":"The label key is available in the `labels.csv` file.","5913cc49":"To download all of the original paintings (without segmentation maps) see the [jwilber\/Bob_Ross_Paintings](https:\/\/github.com\/jwilber\/Bob_Ross_Paintings) repo on GitHub.","c86bc96d":"As you can see in the case above, the images were created using a screen capture of some kind, and are of sometimes uneven quality. Some images have cropped-out watermarks on them or appear to be zoomed-in versions of the originals.\n\nThe segmentation maps are in the `labels\/` folder.","03622034":"All of the images have been resized so that they (and the segmentation maps) are the same `337x450px` size.\n\nSome example segmentation maps follow:","d0af181d":"Each image is available in the `\/train\/images\/` folder under a name like `paintingN.png`, where `N` is the painting's number. Paintings are organized in the order in which they appeared on Bob Ross's \"The Joy of Painting\". E.g. `painting220.png` is the 220th painting he created in the series.\n\nHere's an interesting bit of trivia for you: Bob Ross actually painted three versions of each painting that appeared on the show. The first is a preliminary version that we painted while preparing for the episode. The second is the version he paints onscreen. The third is a more detailed version that he painted for inclusion in his art book. Bob Ross painted a total of. Many of these paintings were given away.\n\nOnly a subset of ~250 of the ~400 paintings created on the show are included in this dataset. The paintings included are those which have a square or rectangular frame (Bob Ross sometimes used other types of frames, including once painting inside of an outline of the state of Florida) and which don't have any man-made features.","54f5e235":"Unfortunately one segmentation map ended up on the wrong filepath for unclear reasons:","0d161b19":"This dataset consists of ~250 Bob Ross images, their segmentation maps, and a label key. First we'll take a look at the images:","d088a235":"## Modeling\n\nThis data was used to train GauGAN, an image-to-image GAN model, that is able to take segmentation maps as input and produces \"Bob Ross like\" paintings as output. See [the forthcoming article describing the project](https:\/\/medium.com\/@aleksey.bilogur\/building-a-guagan-app-on-spell-article-d206f1c3c5f3) for more details on this model and how it works.\n\n## Your challenge\n\nYour challenge, should you choose to accept it: can you train a machine learning model on this data that learns to output paintings in Bob Ross's distinct style?"}}