{"cell_type":{"e168eee9":"code","91b05fee":"code","743b801a":"code","ba5b1498":"code","b3a2bbf2":"code","f67abe21":"code","ce699d0b":"code","14f29f7f":"code","45382c52":"code","f583fe90":"code","84c8b665":"code","8ce47c41":"code","e3c6530f":"code","25d2bc20":"markdown","54ca89b7":"markdown","09fc3e31":"markdown","2902021e":"markdown","3b432c64":"markdown","c34421bc":"markdown","3ca1dcca":"markdown","0e08ebc0":"markdown","e7268c7e":"markdown","c9177490":"markdown","538e8b20":"markdown"},"source":{"e168eee9":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n","91b05fee":"from sklearn.ensemble import IsolationForest\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report","743b801a":"data = pd.read_csv(\"..\/input\/creditcardfraud\/creditcard.csv\")\ndata","ba5b1498":"data.info()","b3a2bbf2":"data.describe().T","f67abe21":"X = data.drop(['Time','Class'],axis=1).values\ny = data['Class'].astype(bool).values","ce699d0b":"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.2,stratify=y)\nX_train.shape, X_test.shape, y_train.shape, y_test.shape","14f29f7f":"y_train.mean(), y_test.mean()","45382c52":"model = IsolationForest(contamination=y_train.mean()) # \u0434\u043e\u043b\u044e \u0432\u044b\u0431\u0440\u043e\u0441\u043e\u0432 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u043c \u0441\u0440\u0435\u0434\u043d\u0435\u043c\u0443 \u043d\u0430 \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0435\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435\nmodel.fit(X_train)","f583fe90":"conv_pred = lambda pred : pd.Series(pred).apply(lambda x: 1 if x == -1 else 0).values","84c8b665":"pred_y_train = conv_pred(model.predict(X_train))\npred_y_test = conv_pred(model.predict(X_test))","8ce47c41":"print(classification_report(y_train,pred_y_train))","e3c6530f":"print(classification_report(y_test,pred_y_test))","25d2bc20":"# \u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435","54ca89b7":"# \u0432\u044b\u0434\u0435\u043b\u044f\u0435\u043c X \u0438 y","09fc3e31":"# \u0411\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 \u043f\u043e\u0434\u0442\u044f\u0433\u0438\u0432\u0430\u0435\u043c","2902021e":"# \u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0432 test","3b432c64":"\u041d\u0430 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u044c \u043e\u0442\u043b\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 27% \u0432\u044b\u0431\u0440\u043e\u0441\u043e\u0432","c34421bc":"# \u0421\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u0434\u0430\u043d\u043d\u044b\u0435","3ca1dcca":"\u041d\u0430 \u0442\u0435\u0441\u0442\u0435 \u043c\u043e\u0434\u0435\u043b\u044c \u043e\u0442\u043b\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 29% \u0432\u044b\u0431\u0440\u043e\u0441\u043e\u0432","0e08ebc0":"# \u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0432 train","e7268c7e":"# \u0420\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u043c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u0438 \u0442\u0435\u0441\u0442","c9177490":"# \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0438 \u0443\u0447\u0438\u043c \u043c\u043e\u0434\u0435\u043b\u044c","538e8b20":"# \u041f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c"}}