{"cell_type":{"14132611":"code","2d2d04d4":"code","39b06c46":"code","5e0e197a":"code","3a4ee57f":"code","93b39e01":"code","7c8872f9":"code","86bb9555":"code","fb4bb5cc":"code","5a853a51":"code","497d94f1":"code","afbf6d1b":"code","d928ad9b":"markdown","371f4149":"markdown"},"source":{"14132611":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport os\nprint(os.listdir(\"..\/input\"))\n","2d2d04d4":"df=pd.read_csv(\"..\/input\/human-activity-recognition-with-smartphones\/train.csv\")\ndf_test=pd.read_csv(\"..\/input\/human-activity-recognition-with-smartphones\/test.csv\")\ndf","39b06c46":"print(\"Missing values:\",df.isnull().values.any())","5e0e197a":"df['Activity'].value_counts()","3a4ee57f":"df2=df.drop(['subject'],axis=1)\na=set(df['Activity'])\ndf2_test=df_test.drop(['subject'],axis=1)\nprint(a)","93b39e01":"temp=df['Activity'].value_counts()\n\ndta = pd.DataFrame({'Type': temp.index,\n                   'Occurrence': temp.values\n                  })\n\nplt.bar(dta['Type'],dta['Occurrence'])\nplt.xticks(rotation=75)\nplt.xlabel('Type Of Activity')\nplt.ylabel('No of Occurrence')\nplt.show()","7c8872f9":"len(df2.columns)\nX=pd.DataFrame(df2.drop('Activity',axis=1))\nY=df2.Activity.values.astype(object)\nX_test=pd.DataFrame(df2_test.drop('Activity',axis=1))\nY_test=df2_test.Activity.values.astype(object)\n\nfrom sklearn.preprocessing import StandardScaler\n\nx_scaled=StandardScaler().fit_transform(X)\nx_testscaled=StandardScaler().fit_transform(X_test)\n\nfrom sklearn.preprocessing import LabelEncoder\n\ny=LabelEncoder().fit_transform(Y)\ny_test=LabelEncoder().fit_transform(Y_test)","86bb9555":"from sklearn.model_selection import cross_val_score\nfrom sklearn.svm import SVC\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\n\nclf=[SVC(),GaussianNB(),DecisionTreeClassifier(),RandomForestClassifier()]\nname=['Support Vector','Naive Bayes','Decision Tree','Random Forest']\nprint('Accuracy')\nfor model,names in zip(clf,name):\n    print(names)\n    print(cross_val_score(model,x_scaled,y,cv=5))\n","fb4bb5cc":"params_grid = [{'kernel': ['rbf'], 'gamma': [0.001,0.01,0.1,1],\n                     'C': [1, 10, 100, 1000]},\n                    {'kernel': ['linear'], 'C': [1, 10, 100, 1000]}]\n\nfrom sklearn.model_selection import GridSearchCV\n\n\nsvm_model=GridSearchCV(SVC(),params_grid,cv=5,n_jobs=-1)\nsvm_model.fit(x_scaled,y)\nprint('Grid best parameter (max accuracy): ',svm_model.best_params_)\nprint('Grid best score: (accuracy)',svm_model.best_score_)\n","5a853a51":"svm_final=svm_model.best_estimator_\nprint(\"Training score: \",svm_final.score(x_scaled,y))\nprint(\"Testing score\",svm_final.score(x_testscaled,y_test))","497d94f1":"import seaborn as sb\nfrom sklearn.metrics import confusion_matrix\n\nsvm_predicted=svm_final.predict(x_testscaled)\nsvm_confuse=confusion_matrix(y_test,svm_predicted)\ndf_cm=pd.DataFrame(svm_confuse)\n\nplt.figure(figsize=(5.5,4))\nsb.heatmap(df_cm,annot=True,fmt='g')\nplt.title(\"Confusion Matrix Heatmap\")\nplt.xlabel(\"True Label\")\nplt.ylabel(\"Predicted Label\")\nplt.show()\n","afbf6d1b":"from sklearn.metrics import classification_report\nprint(\"Classification Report\")\nprint(classification_report(y_test,svm_predicted))\nprint(\"Training score: \",svm_final.score(x_scaled,y))\nprint(\"Testing score\",svm_final.score(x_testscaled,y_test))","d928ad9b":"The Human Activity Recognition database was built from the recordings of 30 study participants performing activities of daily living (ADL) while carrying a waist-mounted smartphone with embedded inertial sensors. \n\nDataset by UCI Machine Learning https:\/\/www.kaggle.com\/uciml\/human-activity-recognition-with-smartphones\n\nAlgorithm used Support Vector Machine Classifier\nAccuracy Achieved: 96%","371f4149":"# Human Activity Recognition with Smartphone Data"}}