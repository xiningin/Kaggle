{"cell_type":{"56f4f3d0":"code","d9db8f20":"code","34978897":"code","168cc811":"code","a7d80093":"code","4a15e703":"code","1664197c":"markdown"},"source":{"56f4f3d0":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n\nfrom bokeh.plotting import figure, show, output_notebook\nfrom bokeh.models import ColumnDataSource, HoverTool\n\noutput_notebook()\n\n# import data\ndata = pd.read_csv(\"..\/input\/restaurant-scores-lives-standard.csv\")\n\n# convert 'inspection date' to datetime format\ndata['inspection_date'] = pd.to_datetime(data['inspection_date'])\n\n# sort\ndata = data.sort_values(by=['inspection_date'])","d9db8f20":"# get the newest data on number of restaurants with high risks violations\nnew_high_risk = data[(data['inspection_date'] == data['inspection_date'].iloc[-1]) & (data['risk_category'] == 'High Risk')]\n\n# number of inspections\nprint(\"Number of inspections overall:\", data['inspection_id'].nunique())\n\n# newest inpsection with high risks\nprint(\"Latest inspections:\", data['inspection_date'].iloc[-1], \", Number of restaurants with high risk violations: \", new_high_risk['business_id'].nunique())","34978897":"# number of violations in each category by day\n\n# create dataframes for each type of risks\nlow_risk = data[data['risk_category'] == 'Low Risk']\nlow_risk = low_risk[['inspection_date', 'risk_category']].groupby('inspection_date')['risk_category'].count().reset_index()\n\nmoderate_risk = data[data['risk_category'] == 'Moderate Risk']\nmoderate_risk = moderate_risk[['inspection_date', 'risk_category']].groupby('inspection_date')['risk_category'].count().reset_index()\n\nhigh_risk = data[data['risk_category'] == 'High Risk']\nhigh_risk = high_risk[['inspection_date', 'risk_category']].groupby('inspection_date')['risk_category'].count().reset_index()\n\n# plot graph\nTOOLS = 'crosshair,save,pan,box_zoom,reset,wheel_zoom'\np = figure(title=\"Number of violations by category per day\", y_axis_type=\"linear\", plot_height = 400, tools = TOOLS, plot_width = 800,\n          x_axis_type=\"datetime\")\np.xaxis.axis_label = 'Date'\np.yaxis.axis_label = 'Total violations by category'\n\np.line(low_risk['inspection_date'], low_risk['risk_category'], color='green', alpha=0.5, legend='Low Risk')\n\np.line(moderate_risk['inspection_date'], moderate_risk['risk_category'], color='orange', alpha=0.5, legend='Moderate Risk')\n\np.line(high_risk['inspection_date'], high_risk['risk_category'], color='red', alpha=0.5, legend='High Risk')\n\np.legend.location = \"top_left\"\n\np.add_tools(HoverTool(\n    tooltips=[\n        ('date', '@x{%F}'),\n        ('Number of violations', '@y')\n    ],\n    formatters={\n        'x': 'datetime', # use 'datetime' formatter for 'date' field\n                                  # use default 'numeral' formatter for other fields\n    },\n    # display a tooltip whenever the cursor is vertically in line with a glyph\n    mode='vline'\n))\n\nshow(p)","168cc811":"# number of inspections by years\/month\/day\ninspection = data[['inspection_date', 'inspection_id']].drop_duplicates()\n\nx = inspection.groupby('inspection_date')['inspection_id'].nunique().reset_index()\n\n# plot graph\nTOOLS = 'save,pan,box_zoom,reset,wheel_zoom'\np = figure(title=\"Number of inspections per day\", y_axis_type=\"linear\", plot_height = 400, tools = TOOLS, plot_width = 800,\n          x_axis_type=\"datetime\")\np.xaxis.axis_label = 'Date'\np.yaxis.axis_label = 'Total Inspections'\n\np.line(x['inspection_date'], x['inspection_id'], color='navy', alpha=0.5)\n\np.add_tools(HoverTool(\n    tooltips=[\n        ('date', '@x{%F}'),\n        ('Number of inspections', '@y')\n    ],\n    formatters={\n        'x': 'datetime', # use 'datetime' formatter for 'date' field\n                                  # use default 'numeral' formatter for other fields\n    },\n    # display a tooltip whenever the cursor is vertically in line with a glyph\n    mode='vline'\n))\n\nshow(p)","a7d80093":"# inspection_score: median\/mean overall\/by year\/by month\/by day\/by neighborhood\n\nscore = data[['inspection_date', 'inspection_score']].drop_duplicates().dropna()\n\ny = score.groupby('inspection_date')['inspection_score'].mean().reset_index()\n\n# plot graph\nTOOLS = 'save,pan,box_zoom,reset,wheel_zoom'\np = figure(title=\"Average inspection score per day\", y_axis_type=\"linear\", plot_height = 400, tools = TOOLS, plot_width = 800,\n          x_axis_type=\"datetime\")\np.xaxis.axis_label = 'Date'\np.yaxis.axis_label = 'Average score'\n\np.line(y['inspection_date'], y['inspection_score'], color='navy', alpha=0.5)\n\np.add_tools(HoverTool(\n    tooltips=[\n        ('date', '@x{%F}'),\n        ('Average score', '@y')\n    ],\n    formatters={\n        'x': 'datetime', # use 'datetime' formatter for 'date' field\n                                  # use default 'numeral' formatter for other fields\n    },\n    # display a tooltip whenever the cursor is vertically in line with a glyph\n    mode='vline'\n))\n\nshow(p)","4a15e703":"# Bins will be 5 scores, so the number of bins is (length of interval \/ 5). Min and max scores are used for the range\n#max score always will be 100, min score could change\n\nmin_score = data['inspection_score'].min()\nscore_hist, edges = np.histogram(data['inspection_score'].dropna(), \n                                 bins = int((100 - min_score) \/ 5),\n                                 range = [min_score, 100])\n\n# Put the information in a dataframe\n\nscores = pd.DataFrame({'scores': score_hist,\n                       'left': edges[:-1],\n                       'right': edges[1:]})\n\n# Add a column showing the extent of each interval\nscores['s_interval'] = ['%d to %d' % (left, right) for left, right in zip(scores['left'], scores['right'])]\n\n# Convert dataframe to a ColumnDataSource\nsrc = ColumnDataSource(scores)\n\n# Create histogram using Bokeh\np = figure(plot_height = 600, plot_width = 600, \n           title = 'Histogram of Inspection Score',\n           x_axis_label = 'Inspection score', \n           y_axis_label = 'Number of inspections')\n\n# Add a quad glyph\np.quad(source=src, bottom=0, top='scores', \n       left='left', right='right', \n       fill_color='red', line_color='black', fill_alpha = 0.75,\n       hover_fill_alpha = 1.0, hover_fill_color = 'navy')\n\n# add HoverTool\nhover = HoverTool(tooltips=[('Scores', '@s_interval'),\n                        ('Num of Restaurants', '@scores')])\n\np.add_tools(hover)\n\n# Show the plot\nshow(p)","1664197c":"This dashboard was created during the <a href=\"https:\/\/www.kaggle.com\/rtatman\/dashboarding-with-notebooks-day-1?utm_medium=email&utm_source=intercom&utm_campaign=dashboarding-event\">December 2018 Kaggle's Dashboard training.<\/a> It is hosted online by Google Cloud Platform and scheduled to run every Sunday at midnight. "}}