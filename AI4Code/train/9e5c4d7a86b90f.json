{"cell_type":{"850933dc":"code","1e9229ff":"markdown"},"source":{"850933dc":"import sqlite3\nimport os\n\n#Export count\ncount = 500\n\n# Remove existing db, if present\nif os.path.exists(\"articles.sqlite\"):\n    os.remove(\"articles.sqlite\")\n\n# Create db and attach existing db\ndb = sqlite3.connect(\"articles.sqlite\")\ndb.execute(\"ATTACH '..\/input\/cord-19-etl\/cord19q\/articles.sqlite'as indb\")\ncur = db.cursor()\n\n# Copy data\ncur.execute(\"CREATE TABLE articles AS SELECT * FROM indb.articles WHERE tags IS NOT NULL ORDER BY RANDOM() LIMIT \" + str(count))\ncur.execute(\"CREATE TABLE sections AS SELECT * FROM indb.sections s WHERE s.article IN (SELECT id FROM articles)\")\n\n# Show counts\ncur.execute(\"SELECT COUNT(*) FROM articles\")\nprint(\"Total articles exported %d\" % cur.fetchone())\n\ncur.execute(\"SELECT COUNT(*) FROM sections\")\nprint(\"Total sections exported %d\" % cur.fetchone())\n\n# Commit and close\ndb.commit()\ndb.close()","1e9229ff":"# CORD-19 Slim\n\nExports a small sample set of CORD-19 documents to a new database."}}