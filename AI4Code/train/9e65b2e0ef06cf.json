{"cell_type":{"c955b670":"code","da3159ba":"code","e30148f4":"code","72690705":"code","ad25542e":"code","d747a779":"code","606e7297":"code","36338f7c":"code","fd47addf":"code","a5c561a8":"code","63b6d7cb":"code","5ee18f1b":"code","99b703c9":"code","799cec37":"code","ebeed8fe":"code","dadeb31d":"code","63d41283":"code","3151feea":"code","1ff997b2":"code","fc5b8f30":"code","4bff183c":"code","8dc44312":"code","c2ac3ec4":"code","1d6fe845":"code","839e714f":"code","234240bb":"code","1d86beb3":"code","740f08b9":"code","69656440":"code","54e59f77":"code","fc5e723f":"code","96126b1c":"code","54d9475c":"code","a03b0c09":"code","3012b41b":"code","8b8843e9":"markdown","586ad1ce":"markdown","352ab551":"markdown","34af593b":"markdown","f579a271":"markdown","1927ca8f":"markdown","fcfa7c87":"markdown","5e278a75":"markdown","774bea5c":"markdown","02ce3764":"markdown","b6f8296c":"markdown","ad77b912":"markdown","52b8435a":"markdown"},"source":{"c955b670":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import mean_squared_error as mse\nfrom sklearn.metrics import confusion_matrix,accuracy_score\nfrom sklearn.model_selection import train_test_split,GridSearchCV\n\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","da3159ba":"X_full = pd.read_csv('..\/input\/pima-indians-diabetes-database\/diabetes.csv')","e30148f4":"X_full.shape","72690705":"X_full.info()","ad25542e":"X_full.describe()","d747a779":"print('Number of rows missing Glucose: {0}'.format(len(X_full.loc[X_full['Glucose'] == 0])))\nprint('Number of rows missing Blood Pressure: {0}'.format(len(X_full.loc[X_full['BloodPressure'] == 0])))\nprint('Number of rows missing Insulin: {0}'.format(len(X_full.loc[X_full['Insulin'] == 0])))\nprint('Number of rows missing BMI: {0}'.format(len(X_full.loc[X_full['BMI'] == 0])))\nprint('Number of rows missing Skin Thickness: {0}'.format(len(X_full.loc[X_full['SkinThickness'] == 0])))\nprint('Number of rows missing Age: {0}'.format(len(X_full.loc[X_full['Age'] == 0])))","606e7297":"x = X_full['Glucose'].median()\nX_full['Glucose'].replace(0,x,inplace=True)\nx = X_full['BloodPressure'].median()\nX_full['BloodPressure'].replace(0,x,inplace=True)\nx = X_full['Insulin'].median()\nX_full['Insulin'].replace(0,x,inplace=True)\nx = X_full['BMI'].median()\nX_full['BMI'].replace(0,x,inplace=True)\nx = X_full['SkinThickness'].median()\nX_full['SkinThickness'].replace(0,x,inplace=True)","36338f7c":"figure = plt.figure(figsize =(10,10))\nsns.heatmap(X_full.corr(),annot=True,cmap=\"YlGnBu\")","fd47addf":"X_full['Outcome'].value_counts()","a5c561a8":"X_full.isna().sum(axis=0)","63b6d7cb":"len(X_full['Age'].unique())","5ee18f1b":"figure = plt.figure(figsize =(6,6))\nax = sns.histplot(x=\"Age\",hue =\"Outcome\" ,data=X_full,multiple=\"dodge\", shrink=.8)","99b703c9":"plt.hist(X_full['BMI'],bins=100)\nplt.show()","799cec37":"X_full['BMI_levels']=pd.cut(X_full['BMI'],bins=[0, 18.5, 24.99, 29.99,34.99,39.99,100],labels=[0,1,2,3,4,5])","ebeed8fe":"plt.hist(X_full['BMI_levels'])\nplt.show()","dadeb31d":"figure = plt.figure(figsize =(6,6))\nax = sns.histplot(x = 'BMI_levels',hue =\"Outcome\",data=X_full ,multiple=\"dodge\", shrink=.8 )","63d41283":"plt.hist(X_full['Glucose'],bins=100)\nplt.show()","3151feea":"X_full['Glucose_levels']=pd.cut(X_full['Glucose'],bins=[0, 140 , 200],labels=[0,1])","1ff997b2":"figure = plt.figure(figsize =(6,6))\nax = sns.histplot(x = 'Glucose_levels',hue =\"Outcome\",data=X_full,multiple=\"dodge\", shrink=.8 )","fc5b8f30":"X_full.head()","4bff183c":"X_org = X_full.drop(columns=['BMI_levels','Glucose_levels'])","8dc44312":"Y = X_full['Outcome']\nX = X_full.drop(columns=['Outcome'])\nX_train,X_test,y_train,y_test = train_test_split(X,Y,test_size=0.2,random_state=42,stratify = Y)","c2ac3ec4":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nX_train_scaled = scaler.fit_transform(X_train)\nX_test_scaled = scaler.transform(X_test)","1d6fe845":"from sklearn import svm\nsupport_vector_classifier = svm.SVC(kernel=\"linear\",).fit(X_train_scaled,y_train)\ny_pred = support_vector_classifier.predict(X_test_scaled)\ncm = confusion_matrix(y_test,y_pred)\nprint(\"Our Accuracy is: \", (cm[0][0]+cm[1][1])\/(cm[0][0]+cm[1][1]+cm[0][1]+cm[1][0]))\nprint(accuracy_score(y_test,y_pred))","839e714f":"print(classification_report(y_test,y_pred))","234240bb":"y_trainpred = support_vector_classifier.predict(X_train_scaled)\nprint(\"The mean squared error of train is:\",mse(y_train,y_trainpred))","1d86beb3":"print(\"The mean squared error of test is:\",mse(y_test,y_pred))","740f08b9":"svm_params ={\"C\":np.arange(1,20)}\nsvms = svm.SVC(kernel=\"linear\")\nsvm_cv = GridSearchCV(svms,svm_params,cv=8)\nsvm_cv.fit(X_train_scaled,y_train)\nprint(svm_cv.best_score_)\nprint(svm_cv.best_params_)","69656440":"svm_tuned = svm.SVC(kernel=\"linear\",C=2).fit(X_train_scaled,y_train)\ny_pred2 = svm_tuned.predict(X_test_scaled)\ncm2 = confusion_matrix(y_test,y_pred2)\nprint(cm2)\nprint(accuracy_score(y_test,y_pred2))","54e59f77":"print(classification_report(y_test,y_pred2))","fc5e723f":"from sklearn.linear_model import LogisticRegression\nLRmodel = LogisticRegression(random_state=0).fit(X_train_scaled,y_train)\nLRy_pred = LRmodel.predict(X_test_scaled)\nLRcm = confusion_matrix(y_test,LRy_pred)\nprint(\"Our Accuracy is: \", (LRcm[0][0]+LRcm[1][1])\/(LRcm[0][0]+LRcm[1][1]+LRcm[0][1]+LRcm[1][0]))\nprint(accuracy_score(y_test,LRy_pred))","96126b1c":"print(classification_report(y_test,LRy_pred))","54d9475c":"LR_params ={\"C\":np.arange(1,20)}\nLRs = LogisticRegression(random_state=0)\nLR_cv = GridSearchCV(LRs,LR_params,cv=8)\nLR_cv.fit(X_train_scaled,y_train)\nprint(LR_cv.best_score_)\nprint(LR_cv.best_params_)","a03b0c09":"LR_tuned = LogisticRegression(random_state=0,C=3).fit(X_train_scaled,y_train)\nLRy_pred2 = LR_tuned.predict(X_test_scaled)\nLRcm2 = confusion_matrix(y_test,LRy_pred2)\nprint(LRcm2)\nprint(accuracy_score(y_test,LRy_pred2))","3012b41b":"print(classification_report(y_test,LRy_pred2))","8b8843e9":"## cross validation over multibli models","586ad1ce":"## If woman BMI is:\n\n1. below 18.5 \u2013 she is in the underweight range -> 0\n1. between 18.5 and 24.9 \u2013 she is in the healthy weight range -> 1\n1. between 25 and 29.9 \u2013 she is in the overweight range -> 2\n1. between 30 and 39.9 \u2013 she is in the obese range -> 3\n1. other -> 4","352ab551":"### Splitting the dataset for training & testing and standardizing the data\u00b6\n","34af593b":"outcome is highly correlated with ['Glucose','BMI','Age','Pregriancies']","f579a271":"### SVM","1927ca8f":"![image.png](attachment:c731f680-8300-43bf-8f20-c1b68f09ee63.png)","fcfa7c87":"will have to make statified sampling to over come the difference between count of 0 and 1 samples","5e278a75":"['Pregnancies',Glucose',BloodPressure','SkinThickness','Insulin','BMI'] canot have 0 as value but the min is 0 so replace it with the mdian value","774bea5c":"there is no catigorical features or missing values","02ce3764":"## For a 2 hour GTT\"glucose tolerance test\" with 75 g intake\n1. a glucose level below 7.8 mmol\/L (140 mg\/dL) is normal\n1. Blood plasma glucose between 7.8 mmol\/L (140 mg\/dL) and 11.1 mmol\/L (200 mg\/dL) indicate \"impaired glucose tolerance\"\n1. and levels at or above 11.1 mmol\/L at 2 hours confirm a diagnosis of diabetes","b6f8296c":"768 samples with 9 features","ad77b912":"there is not a number in the data","52b8435a":"### LogisticRegression"}}