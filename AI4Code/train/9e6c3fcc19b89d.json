{"cell_type":{"cbcf1a9e":"code","1662a2d4":"code","31356542":"code","17ecff8e":"code","2e74b840":"code","20fd81a8":"code","7420b0a2":"code","1b2fb555":"code","8bd5b7d0":"code","c47a0b67":"code","b3cc1816":"code","a2058896":"code","c192539f":"code","b09bae84":"code","5acf7fd9":"code","38daa868":"code","ff2ce156":"code","24a5ec0d":"code","ffdd21f1":"code","65802760":"code","fc4e1dfe":"code","bc2da0a6":"code","96e0831d":"code","6ff44a68":"code","b0b10f72":"code","6c55a366":"code","fdd88853":"code","09b4095e":"code","403bff29":"code","519f2bb2":"code","b0611d79":"code","8397ca26":"code","6d32b8ce":"code","84198a78":"code","7a8da7c4":"code","69962d8a":"code","c158e39d":"code","fb9cbbee":"code","3044811e":"code","45881b62":"code","0379cb52":"code","9254b42d":"markdown","a0854737":"markdown","f935f89f":"markdown","e3357b57":"markdown","a201afdd":"markdown","3abd888c":"markdown","0f7f6e00":"markdown","ed4cb1d9":"markdown"},"source":{"cbcf1a9e":"import tensorflow as tf\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport random \nimport zipfile","1662a2d4":"model = tf.keras.applications.ResNet50(weights = 'imagenet')","31356542":"train = '..\/input\/cat-and-dog\/null'\n","17ecff8e":"sample_image = tf.keras.preprocessing.image.load_img(r'..\/input\/cat-and-dog\/test_set\/test_set\/cats\/cat.4003.jpg', target_size=(224,224))","2e74b840":"plt.imshow(sample_image)","20fd81a8":"type(sample_image)","7420b0a2":"sample_image = tf.keras.preprocessing.image.img_to_array(sample_image)","1b2fb555":"type(sample_image)","8bd5b7d0":"np.shape(sample_image)","c47a0b67":"sample_image = np.expand_dims(sample_image, axis =0)","b3cc1816":"sample_image.shape","a2058896":"sample_image.max()","c192539f":"sample_image.min()","b09bae84":"sample_image = tf.keras.applications.resnet50.preprocess_input(sample_image)","5acf7fd9":"sample_image.max()","38daa868":"sample_image.min()","ff2ce156":"predictions = model.predict(sample_image)","24a5ec0d":"print('predictions: ', tf.keras.applications.resnet50.decode_predictions(predictions, top = 5))","ffdd21f1":"base_model = tf.keras.applications.ResNet50(weights = 'imagenet', include_top = False)","65802760":"base_model.summary()","fc4e1dfe":"x = base_model.output","bc2da0a6":"x = tf.keras.layers.GlobalAveragePooling2D()(x)","96e0831d":"x = tf.keras.layers.Dense(1024, activation='relu')(x)\nx = tf.keras.layers.Dense(1024, activation='relu')(x)\nx = tf.keras.layers.Dense(1024, activation='relu')(x)\nx = tf.keras.layers.Dense(512, activation='relu')(x)\npreds = tf.keras.layers.Dense(2, activation='sigmoid')(x)","6ff44a68":"model = tf.keras.models.Model(inputs = base_model.input, outputs = preds)","b0b10f72":"model.summary()","6c55a366":"for i, layer in enumerate(model.layers):\n  print(i, layer.name)","fdd88853":"for layer in model.layers[:175]:\n  layer.trainable = False","09b4095e":"for layer in model.layers[175:]:\n  layer.trainable = True","403bff29":"train_datagen = tf.keras.preprocessing.image.ImageDataGenerator(preprocessing_function=tf.keras.applications.resnet50.preprocess_input)","519f2bb2":"train_generator = train_datagen.flow_from_directory('..\/input\/cat-and-dog',\n                                                    target_size = (224,224),\n                                                    color_mode = 'rgb',\n                                                    batch_size = 32,\n                                                    class_mode = 'categorical',\n                                                    shuffle = True)","b0611d79":"model.compile(optimizer='Adam', loss='categorical_crossentropy', metrics=['accuracy'])","8397ca26":"history = model.fit_generator(generator=train_generator,\n                              epochs = 30)","6d32b8ce":"acc = history.history['accuracy']\nloss = history.history['loss']\n\nplt.figure()\nplt.plot(acc, label='Training Accuracy')\nplt.ylabel('Accuracy')\nplt.title('Training Accuracy')\n\nplt.figure()\n\nplt.plot(loss, label='Training Loss')\nplt.ylabel('Loss')\nplt.title('Training Loss')\nplt.xlabel('epoch')\nplt.show()","84198a78":"sample_image = tf.keras.preprocessing.image.load_img(r'..\/input\/cat-and-dog\/test_set\/test_set\/cats\/cat.4012.jpg', target_size=(224,224))","7a8da7c4":"plt.imshow(sample_image)","69962d8a":"sample_image = tf.keras.preprocessing.image.img_to_array(sample_image)\nnp.shape(sample_image)","c158e39d":"sample_image = np.expand_dims(sample_image, axis = 0)\nnp.shape(sample_image)","fb9cbbee":"sample_image = tf.keras.applications.resnet50.preprocess_input(sample_image)","3044811e":"predictions = model.predict(sample_image)\nprint(predictions)","45881b62":"sample_image = tf.keras.preprocessing.image.load_img(r'..\/input\/cat-and-dog\/test_set\/test_set\/dogs\/dog.4014.jpg', target_size=(224,224))\nplt.imshow(sample_image)","0379cb52":"sample_image = tf.keras.preprocessing.image.img_to_array(sample_image)\nsample_image = np.expand_dims(sample_image, axis = 0)\nsample_image = tf.keras.applications.resnet50.preprocess_input(sample_image)\npredictions = model.predict(sample_image)\nprint(predictions)","9254b42d":"# **Model evaluation**","a0854737":"Initially I did the training with 10 epochs, but I saw the possibility of increasing them, as it was possible to improve the algorithm, we could still increase the epochs, but it would take a long time for this study.\n\nwhen activating the network, I performed the test with softmax, but because we are looking for only two classes, I opted for sigmoid.","f935f89f":"# **Transfer learning and model reuse**","e3357b57":"The chance of being classified as a cat is almost 0% and a dog over 95%.","a201afdd":"The chances of being classified as a cat is over 70% and a dog is practically 0%","3abd888c":"# **Tests with the pre-trained model**","0f7f6e00":"# **Importing the model with pre-trained weights**","ed4cb1d9":"# **If you find this notebook useful, support with an upvote** \ud83d\udc4d"}}