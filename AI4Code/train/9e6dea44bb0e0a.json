{"cell_type":{"4285f79b":"code","6e906806":"code","a98b9205":"code","b96a933e":"code","de92a1c4":"code","c9235ea4":"code","66da83d5":"code","16dfa9d6":"code","f0d878d8":"code","c3f64d90":"code","0697c9b7":"code","2083129d":"code","881be3d2":"code","e5109edb":"markdown","a7bb1d0d":"markdown","0416a9b3":"markdown","9d714adf":"markdown","15d9acf6":"markdown","9c33dd87":"markdown","b0c170cb":"markdown","13534470":"markdown","112d5e07":"markdown","5ca8106b":"markdown","d73c6ac9":"markdown"},"source":{"4285f79b":"import pandas as pd\nimport sqlite3\nimport numpy as np\nimport seaborn as sns\nsns.set()\nimport matplotlib.pyplot as plt\n\ndatabase = '..\/input\/soccer\/database.sqlite'\ncon = sqlite3.connect(database)\n\ntables = pd.read_sql(\"\"\"SELECT *\n                        FROM sqlite_master\n                        WHERE type='table';\"\"\", con)\ntables","6e906806":"countries = pd.read_sql_query(\"SELECT * from Country\", con)\nmatches = pd.read_sql_query(\"SELECT * from Match\", con)\nleagues = pd.read_sql_query(\"SELECT * from League\", con)\nteams = pd.read_sql_query(\"SELECT * from Team\", con)\nplayer = pd.read_sql_query(\"SELECT * from Player\",con)\nplayer_attributes = pd.read_sql_query(\"SELECT * from Player_Attributes\",con)\nsequence = pd.read_sql_query(\"SELECT * from sqlite_sequence\",con)\nteam_attributes = pd.read_sql_query(\"SELECT * from Team_Attributes\",con)","a98b9205":"countries.head()\nleagues.head()\nmatches.head()\nteams.head()\nplayer.head()\nplayer_attributes.head()\nsequence.head()\nteam_attributes.head()","b96a933e":"countries_leagues = countries.merge(leagues,left_on=\"id\",right_on=\"id\",how=\"outer\")\ncountries_leagues = countries_leagues.drop(\"id\",axis = 1)\ncountries_leagues = countries_leagues.rename(columns={'name_x':\"country\", 'name_y':\"league\"})","de92a1c4":"matches.head()","c9235ea4":"#subsetting data with necessary columns\nmatches_new = matches[['id', 'country_id', 'league_id', 'season', 'stage', 'date',\n                   'match_api_id', 'home_team_api_id', 'away_team_api_id',\n                    'home_team_goal', 'away_team_goal']]\n\nmatches_new = matches_new.drop(\"id\",axis=1)","66da83d5":"#merge leauge data with match data\ndata = matches_new.merge(countries_leagues,left_on=\"country_id\",right_on=\"country_id\",how=\"outer\")\n#Unique values in data\ndata.nunique()","16dfa9d6":"plt.figure(figsize=(17,10))\ncorr = data.corr()\nax = sns.heatmap(corr, annot=True, cmap='magma').set_title('Correlation of independent variables by using Pearson',fontsize=14)\n","f0d878d8":"sns.set()\ndata.groupby(\"league\").agg({\"home_team_goal\":\"sum\"\n                            ,\"away_team_goal\":\"sum\"}).plot(kind=\"hist\",figsize = (16,7),edgecolor = \"k\",linewidth =1)\nplt.legend(loc = \"best\" , prop = {\"size\" : 14})\nplt.xlabel(\"total goals\")\nplt.title('Frequency score goals Home and away',fontsize=14);","c3f64d90":"sns.set()\nplt.figure(figsize=(14,8))\nax = sns.countplot(y = data[\"league\"],\n                   order=data[\"league\"].value_counts().index,\n                   linewidth = 1,\n                   edgecolor = \"k\"*data[\"league\"].nunique()\n                 )\nfor i,j in enumerate(data[\"league\"].value_counts().values):\n    ax.text(.8,i,j,weight = \"bold\")\nplt.title(\"Matches by league\")\nplt.show()","0697c9b7":"data['date'] = pd.to_datetime(data['date'])\ndata['year'] = data['date'].dt.year","2083129d":"fig, (ax1, ax2) = plt.subplots(1,2, figsize=(16.5,7))\nax1=data.groupby(['year']).agg({\"home_team_api_id\":[\"sum\"]}).plot(ax=ax1, marker='.',linewidth=0.795,color='royalblue',markersize=17.23)\nax1.set_ylabel('Totally matches of home side ',fontsize=12)\nax2=data.groupby(['year']).agg({\"away_team_api_id\":[\"sum\"]}).plot(ax=ax2, marker='.',linewidth=0.795,color='darkorange',markersize=17.23)\nax2.set_ylabel('Totally matches of away side',fontsize=12)\nplt.show();","881be3d2":"plt.figure(figsize=(14,11))\nsns.countplot(y = data[\"season\"],hue=data[\"league\"],palette=\"Dark2\")\nplt.title(\"MATCHES PLAYED IN EACH LEAGUE BY SEASON\")\nplt.show()","e5109edb":"---\n#### Frequency score goals Home and away","a7bb1d0d":"- **We going to use EUROPEAN FOOTBALL DATABASE for futhering data analysis**","0416a9b3":"---\n#### Correlation of independent variables","9d714adf":"---\n**I) Cleaning and Preparing data**\n\n---","15d9acf6":"**Discover all of the tables**","9c33dd87":"#### Matches by League","b0c170cb":"**Import Data**","13534470":"---\n#### MATCHES PLAYED IN EACH LEAGUE BY SEASON","112d5e07":"![](https:\/\/www.telegraph.co.uk\/content\/dam\/betting\/Better-Collective\/footballer-air-kicking.jpg?imwidth=1400)","5ca8106b":"> ## European Soccer Database","d73c6ac9":"### Data visualization"}}