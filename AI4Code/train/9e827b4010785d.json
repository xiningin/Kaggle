{"cell_type":{"2d964d94":"code","af3c6044":"code","40269d4b":"code","5bf5fe0b":"code","926df807":"code","67dab11d":"code","a54d3af8":"code","41536074":"code","61cc78b6":"code","43d4902b":"code","14442357":"code","c6b942bb":"code","8b78a573":"code","3fb6c8cf":"code","ee0942ff":"code","a6337eef":"code","3ad74b72":"code","761a1147":"code","7eda0233":"code","007a37fd":"code","d79cc64b":"code","c9b60ee2":"code","a2c729af":"code","0e888015":"code","50efed56":"code","b9489bb9":"code","345c7008":"code","7fe9bd5f":"code","dbb5bb2e":"code","891c281b":"code","a419b80a":"code","96929572":"code","b131ac1a":"code","a1153466":"code","4e48eaf5":"code","5c9d3824":"markdown","00be2194":"markdown","6e6adddd":"markdown","ece78dd9":"markdown","1eea4668":"markdown","69dda2e5":"markdown","4c45642c":"markdown","05648038":"markdown","b5ca0c61":"markdown","300f9387":"markdown","f4317d3b":"markdown","2c84a282":"markdown","5ef43fe1":"markdown","dac8ada3":"markdown","0bc64dd1":"markdown","7ec63829":"markdown","f03dd5fa":"markdown","ec9b10b8":"markdown","801dd6b0":"markdown","4443bcd1":"markdown","3555f6da":"markdown","8f91b47a":"markdown","46ae4e54":"markdown","6e43ac4f":"markdown","68622617":"markdown","9f70fb3c":"markdown"},"source":{"2d964d94":"# import libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","af3c6044":"# Import datase\nhealth_data = pd.read_csv('..\/input\/insurance\/insurance.csv')\nhealth_data.head()","40269d4b":"health_data.describe()","5bf5fe0b":"health_data.dtypes","926df807":"health_data.isnull().sum()","67dab11d":"health_data.shape","a54d3af8":"plt.figure(figsize = (12,8))\nsns.set(style = 'whitegrid')\nsns.distplot(health_data['charges'], kde=True)\nplt.title('Total Charges Distribution')","41536074":"plt.figure(figsize = (12,8))\nsns.set(style = 'whitegrid')\nsns.distplot(np.log10(health_data['charges']), kde=True, color = 'g')\nplt.title('Total Charges Distribution - After Applying Log')","61cc78b6":"## Check distribution of data for Smoker and Non-Smokers\n\nf = plt.figure(figsize=(12,8))\n\nax = f.add_subplot(121)\nsns.distplot(health_data[(health_data.smoker == 'yes')][\"charges\"],color='r',ax=ax)\nax.set_title(\"Distribution Charges for Smokers\")\n\nax = f.add_subplot(122)\nsns.distplot(health_data[(health_data.smoker == 'no')][\"charges\"],color='g',ax=ax)\nax.set_title(\"Distribution Charges for Non-Smokers\")\n","43d4902b":"f, ax = plt.subplots(1, 1, figsize=(10, 5))\nax = sns.countplot(x='smoker', hue='sex', data=health_data, palette='cool')","14442357":"plt.figure(figsize= (10,5))\nplt.title(\"Age Distribution\")\nax = sns.distplot(health_data[\"age\"], color = 'r')","c6b942bb":"sns.catplot(x=\"smoker\", kind=\"count\",hue = 'sex', palette=\"rainbow\", data=health_data[(health_data.age >= 18) & (health_data.age <= 20)])\nplt.title(\"The number of smokers and non-smokers (18-20 years old)\")","8b78a573":"plt.figure(figsize = (10,5))\nplt.title('Charges for 18-20 Age Patients who smoke')\nsns.boxplot(x='charges', y='smoker', data=health_data[(health_data.age >= 18) & (health_data.age <= 20)])","3fb6c8cf":"plt.figure(figsize= (10,5))\nplt.title(\"BMI distribution\")\nax = sns.distplot(health_data[\"bmi\"], color = 'g')","ee0942ff":"plt.figure(figsize=(12,5))\nplt.title(\"Distribution of charges for patients with BMI greater than 25\")\nax = sns.distplot(health_data[(health_data.bmi >= 25)]['charges'], color = 'm')","a6337eef":"plt.figure(figsize=(12,5))\nplt.title(\"Distribution of charges for patients with BMI greater than 25\")\nax = sns.distplot(health_data[(health_data.bmi <= 25)]['charges'], color = 'm')","3ad74b72":"ax =sns.lmplot(x = 'age', y='charges', data = health_data, hue = 'smoker')","761a1147":"ax =sns.lmplot(x = 'bmi', y='charges', data = health_data, hue = 'smoker')","7eda0233":"ax =sns.lmplot(x = 'children', y='charges', data = health_data, hue = 'smoker')","007a37fd":"from sklearn.preprocessing import LabelEncoder\n\nle = LabelEncoder()\n\n#Sex\nle.fit(health_data['sex'].drop_duplicates())\nhealth_data['sex'] = le.transform(health_data['sex'])\n\n#smoker\nle.fit(health_data['smoker'].drop_duplicates())\nhealth_data['smoker'] = le.transform(health_data['smoker'])\n\n#region\nle.fit(health_data['region'].drop_duplicates())\nhealth_data['region'] = le.transform(health_data['region'])\n","d79cc64b":"health_data.dtypes","c9b60ee2":"plt.figure(figsize=(10,8))\nsns.heatmap(health_data.corr(), annot = True, cmap = 'YlGnBu')","a2c729af":"from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression","0e888015":"X = health_data.drop(['charges'], axis =1)\ny = health_data['charges'] \n\nX_train, X_test, y_train, y_test = train_test_split(X,y, train_size=0.7, random_state=42)","50efed56":"lr = LinearRegression()\nlr_model = lr.fit(X_train, y_train)\n\n#Prediction on train data\ny_train_pred = lr_model.predict(X_train)\n\n#Prediction on test data\ny_test_pred = lr_model.predict(X_test)","b9489bb9":"# Accuracy Score\nprint(lr_model.score(X_test, y_test))","345c7008":"from sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.metrics import r2_score,mean_squared_error","7fe9bd5f":"polynomial = PolynomialFeatures(degree=2)\npolynomial_model = polynomial.fit_transform(X)\n\nX_train, X_test, y_train, y_test = train_test_split(polynomial_model,y, train_size=0.7, random_state=42)\n\n# Build second LR model using polynomial features\nlr_model_2 = LinearRegression().fit(X_train,y_train)\n\n\n#PRedict the values\ny_train_pred = lr_model_2.predict(X_train)\n\n#Predict test values\ny_test_pred = lr_model_2.predict(X_test)","dbb5bb2e":"print(lr_model_2.score(X_test, y_test))","891c281b":"polynomial_LR_model = pd.DataFrame({'Actual Values': y_test, 'Predicted Values':y_test_pred})","a419b80a":"from sklearn.ensemble import RandomForestRegressor","96929572":"rfe = RandomForestRegressor(n_estimators =100,\n                           criterion = 'mse',\n                           random_state =42,\n                           n_jobs=-1)","b131ac1a":"rfe.fit(X_train, y_train)\n\n# predict train data\ny_pred_train = rfe.predict(X_train)\n\n# predict test data \ny_test_pred = rfe.predict(X_test)\n","a1153466":"print('R2 train data: %.3f, R2 test data: %.3f' % (\nr2_score(y_train,y_pred_train),\nr2_score(y_test,y_test_pred)))","4e48eaf5":"polynomial_LR_model.head(10)","5c9d3824":"Random Forest gives about 85% accuracy on the test.","00be2194":"### Step 1 : EDA ","6e6adddd":"Age is distributed from 18(minimum) to 65 (max) age. \nNow to check the effect of smoking on patients between age of 18 to 20.","ece78dd9":"**2. Linear Regression Using Polynomial Features**","1eea4668":"**1.Linear Regression Model**","69dda2e5":"We are up to 86% accuracy which is pretty good.","4c45642c":"There are smokers in the age of 18-20 as well.\n\nNeed to check what is the effect of smoking on Health Treatment cost for the patiients in the age of 18-20.","05648038":"### Step 2 : Encoding the categorical variables:","b5ca0c61":"**3. Random Forest Regressor**","300f9387":"There are no high correlations except with \"smoker\" column.","f4317d3b":"Now data is focused at the center.","2c84a282":"Total Distribution data is right skewed. To make it normal, natural log can be applied.","5ef43fe1":"This confirms that smoking causes more money on Health Care.\n\nAlso the cost of treatment increases as Age, BMI increases.","dac8ada3":"**Checking distribution of Total Charges**","0bc64dd1":"### Linear Regression using Polynomial Features gives about 88% Accuracy, which is highest amongst the three trained models.\n\n### Hence, we will consider this model for the predictions.","7ec63829":"We are getting a accuracy of 76%. We can increase accuracy using other algorithms.","f03dd5fa":"From data it is evident that Smokers spend more money for Health Care than the Non-smokers.","ec9b10b8":"### Step 3 : Model Building","801dd6b0":"Lets have a look at the distribution of Data using Age as the parameter.","4443bcd1":"Lets compare all the variables : Age, BMI, Smoking, Children","3555f6da":"A BMI of less than 18.5 means that a person is underweight. A BMI of between 18.5 and 24.9 is ideal. A BMI of between 25 and 29.9 is overweight. A BMI over 30 indicates obesity.\n\nHere Average BMI is 30 which is an indication of obesity.","8f91b47a":"Patients with BMI > 25 spend more on Health care than the patients with BMI < 25.","46ae4e54":"EDA using BMI:","6e43ac4f":"EDA for Smokers:","68622617":"Number of Male Smokers is larger than the Female Smokers. So it can be said that treatment cost in Men will be higher than the Female.","9f70fb3c":"Boxplot distribution shows that patients between age of 18 to 20 spend a lot more than patients those who dont smoke.\n\nThere are some outliers for Non-smokers, this can be indicator that these patients have terminal health issues."}}