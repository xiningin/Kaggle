{"cell_type":{"c833d81d":"code","1c206c69":"code","f6fdcb1f":"code","f492aaf9":"code","13b57b17":"code","e012f7ff":"code","2af24942":"code","09caf472":"code","decfa95a":"code","8bcb18c6":"code","b798a27c":"code","832b6a2a":"code","71320cee":"code","89d1ad54":"code","45323925":"code","deb41bb3":"code","e69f4f5f":"code","dbcb38db":"code","9f13b537":"code","026e894a":"code","e9517d84":"code","1c23df11":"code","70d9399c":"code","8388e8bf":"code","5af31201":"code","b2cd462f":"code","36324a1a":"code","4813ed50":"code","9310f29e":"code","9c59bbd2":"code","6e6e94cd":"code","2770fe51":"code","4dc9534a":"code","e7470ad0":"code","546de9c3":"code","f2d22afc":"code","5a68b20a":"code","32a359e3":"code","6a2a76d1":"markdown","b34d3891":"markdown","bdc12fb2":"markdown","6ee6909c":"markdown","b578083f":"markdown","9e42c8a8":"markdown","47b8b33e":"markdown","5e5ada26":"markdown","16128c94":"markdown","8fd8c2cd":"markdown","9d581e9d":"markdown","f2695038":"markdown","2b38cc59":"markdown","092486aa":"markdown","40557b7b":"markdown","7d8bce40":"markdown","08888a3e":"markdown"},"source":{"c833d81d":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n%matplotlib inline","1c206c69":"mall_df=pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\nmall_df.head()","f6fdcb1f":"mall_df.info()","f492aaf9":"mall_df.describe()","13b57b17":"mall_df.isnull().sum()","e012f7ff":"sns.heatmap(mall_df.corr() , annot=True,cmap='Oranges')","2af24942":"plt.figure(figsize=(25,10))\n# sns.set(font_scale =2)\n\np=sns.barplot(x='Age',y='Annual Income (k$)',data=mall_df,color='orange')\nplt.xticks(rotation=55,fontsize = 18)\n\nplt.show()\n","09caf472":"plt.figure(figsize=(20,7))\nplt.grid(True)\n\nsns.lineplot(data=mall_df, x='Age',y='Annual Income (k$)',color=\"orange\")\nplt.show()","decfa95a":"plt.figure(figsize=(4,6))\nsns.set(font_scale =1)\n\nsns.countplot(data=mall_df,x='Gender',palette='Oranges')\nplt.show()","8bcb18c6":"sns.pairplot(mall_df, hue= 'Gender',palette='Set2')\n","b798a27c":"plt.figure(figsize=(8, 5))\nsns.histplot(data=mall_df, x='Spending Score (1-100)',color='orange')","832b6a2a":"mall_df.select_dtypes(include='object').columns","71320cee":"gender = {'Male': 0,'Female': 1}\nmall_df.Gender = [gender[item] for item in mall_df.Gender]\nmall_df.head()","89d1ad54":"mall_df.info()","45323925":"from sklearn.preprocessing import StandardScaler","deb41bb3":"mall_df.drop('CustomerID' , axis=1,inplace=True)","e69f4f5f":"scaler=StandardScaler()","dbcb38db":"scaled_X=scaler.fit_transform(mall_df)","9f13b537":"# scaled_X","026e894a":"from sklearn.cluster import KMeans","e9517d84":"model=KMeans(n_clusters=2)","1c23df11":"cluster_labels=model.fit_predict(scaled_X)","70d9399c":"cluster_labels","8388e8bf":"len(scaled_X)\n","5af31201":"len(scaled_X)\n","b2cd462f":"mall_df['Cluster']=cluster_labels\n","36324a1a":"sns.heatmap(mall_df.corr(),annot=True,cmap='Oranges')","4813ed50":"mall_df.corr()['Cluster'].sort_values()","9310f29e":"plt.figure(figsize=(12,6))\nmall_df.corr()['Cluster'].sort_values().plot(kind='bar',color='orange')","9c59bbd2":"ssd=[]\n\nfor k in range(2,10):\n    model=KMeans(n_clusters=k)\n    \n    model.fit(scaled_X)\n    ssd.append(model.inertia_)","6e6e94cd":"ssd","2770fe51":"plt.plot(range(2,10), ssd, '*--',color='red')\nplt.xlabel('K Value')\nplt.ylabel('Sum of Squred Distances')","4dc9534a":"pd.Series(ssd).diff()","e7470ad0":"pd.Series(ssd).diff().plot(kind='bar',color='orange')","546de9c3":"new_model = KMeans(n_clusters=5)\nnew_cluster_labels= new_model.fit_predict(scaled_X)\n","f2d22afc":"# new_cluster_labels\n","5a68b20a":"mall_df['Cluster']=new_cluster_labels\nmall_df.head()","32a359e3":"sns.pairplot(mall_df, hue= 'Cluster',palette='Set2')\n","6a2a76d1":"## Introduction\nCustomer segmentation is the practice of dividing a customer base into groups of individuals that are similar in specific ways relevant to marketing, such as age, gender, interests and spending habits.\nCompanies employing customer segmentation operate under the fact that every customer is different and that their marketing efforts would be better served if they target specific, smaller groups with messages that those consumers would find relevant and lead them to buy something. Companies also hope to gain a deeper understanding of their customers' preferences and needs with the idea of discovering what each segment finds most valuable to more accurately tailor marketing materials toward that segment.","b34d3891":"## Creating and Fitting (K-means)","bdc12fb2":"## Data preparation","6ee6909c":"**finding the best k for our model, we use elbow method.**\n\n","b578083f":"### Scaling the features","9e42c8a8":"## Choosing K Value","47b8b33e":"## Data Visualisation","5e5ada26":"* Benefits of customer segmentation include:\n\nPersonalisation\nPersonalisation ensures that you provide exceptional customer experience.\nCustomer Retention\nIt is 16 times as costly to build a long-term business relationship with a new customer than simply to cultivate the loyalty of an existing customer.\nBetter ROI for marketing\nAffirmations that right marketing messages are sent to the right people based on their life cycle stage.\nReveal new opportunities\nCustomer segmentation may reveal new trends about products and it may even give the first mover\u2019s advantage in a product segment.","16128c94":"## Read Datasets and Check out the Data","8fd8c2cd":"![](https:\/\/stanford.edu\/~cpiech\/cs221\/img\/kmeansViz.png)","9d581e9d":"## Import Libraries","f2695038":"![](https:\/\/miro.medium.com\/max\/853\/1*Mi-XcOw-Bo2Wo0TfW5FArw.png)","2b38cc59":"## K-Means Clustering(Unsupervised Learning)\nK-means clustering is one of the simplest and popular unsupervised machine learning algorithms.\nTypically, unsupervised algorithms make inferences from datasets using only input vectors without referring to known, or labelled, outcomes.","092486aa":"* Here, I am using dataset which contains people's purchasing attributes in the Malls. Dataset is simple and has 5 features namely customer ID, Age, Gender, Annual Income and Spending Score.","40557b7b":"## How does the K-Means Algorithm Work?\nThe working of the K-Means algorithm is explained in the below steps:\n\n**Step-1:** Select the number K to decide the number of clusters.\n\n**Step-2:** Select random K points or centroids. (It can be other from the input dataset).\n\n**Step-3:** Assign each data point to their closest centroid, which will form the predefined K clusters.\n\n\n**Step-4:** Calculate the variance and place a new centroid of each cluster.\n\n**Step-5:** Repeat the third steps, which means reassign each datapoint to the new closest centroid of each cluster.\n\n**Step-6:** If any reassignment occurs, then go to step-4 else go to FINISH.\n\n**Step-7:** The model is ready.","7d8bce40":"## How to choose the value of \"K number of clusters\" in K-means Clustering?\n\nTo find the number of clusters in the data, the user needs to run the K-means clustering algorithm for a range of K values and compare the results. In general, there is no method for determining exact value of K, but an accurate estimate can be obtained using the following techniques.\n\nOne of the metrics that is commonly used to compare results across different values of K is the mean distance between data points and their cluster centroid. Since increasing the number of clusters will always reduce the distance to data points, increasing K will always decrease this metric, to the extreme of reaching zero when K is the same as the number of data points. Thus, this metric cannot be used as the sole target. Instead, mean distance to the centroid as a function of K is plotted and the \"elbow point,\" where the rate of decrease sharply shifts, can be used to roughly determine K.","08888a3e":"**now our data set has label.**"}}