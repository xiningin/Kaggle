{"cell_type":{"93e2ff4f":"code","a1bc482d":"code","5efb39f2":"code","546b9eaf":"code","205ff8b6":"code","9b2e4a8f":"code","6cb5bd80":"code","be4bcb1b":"code","d608b375":"code","66754917":"code","4ae1bf49":"code","e9c7bbbc":"code","1fb31d94":"markdown","e4b9978f":"markdown","27f606d0":"markdown","23a4c4c1":"markdown","f24b7706":"markdown","177b5d90":"markdown","67cbb6c0":"markdown","479d2258":"markdown","f63ef2d4":"markdown","37d8ea63":"markdown","8e74073c":"markdown","b9d94da5":"markdown","b868197e":"markdown","672f1e96":"markdown","41499747":"markdown","a4498ffe":"markdown","1773b30f":"markdown","3c28a9e8":"markdown","330042db":"markdown"},"source":{"93e2ff4f":"import numpy as np\nimport pandas as pd\nimport os\nimport seaborn as sns\nimport matplotlib.pyplot as plt","a1bc482d":"df = pd.read_csv('..\/input\/drug-classification\/drug200.csv')\n\ndf.head()","5efb39f2":"sns.countplot('Drug', data=df)\nplt.show()","546b9eaf":"plt.figure(figsize=(10, 10))\nsns.scatterplot(x='Age', y='Na_to_K', hue='Drug', data=df, s=100)\nplt.plot(range(10, 80), [15 for i in range(10, 80)], 'b--')\nplt.show()","205ff8b6":"df = df[df.Na_to_K <= 15]\ndf.head()","9b2e4a8f":"sns.countplot(x='Sex', hue='Drug', data=df)\nplt.show()","6cb5bd80":"sns.countplot(x='BP', hue='Drug', data=df)\nplt.show()","be4bcb1b":"df_low = df[df.BP == 'LOW']\ndf_high = df[df.BP == 'HIGH']","d608b375":"for i, drug in enumerate(set(df_high.Drug.values)):\n    sns.kdeplot(df_high[df_high.Drug == drug].Age, shade=True, legend=False)\nplt.legend(list(set(df_high.Drug.values)))\nplt.show()","66754917":"plt.figure(figsize=(10, 10))\nsns.scatterplot(x='Age', y='Na_to_K', hue='Drug', data=df_high, s=100)\nplt.plot([50 for i in range(5, 20)], range(5, 20), 'r--')\nplt.show()","4ae1bf49":"sns.countplot(x='Cholesterol', hue='Drug', data=df_low)\nplt.show()","e9c7bbbc":"im = plt.imread('..\/input\/decision-tree\/Blank Diagram.png')\nplt.figure(figsize=(20, 20))\nplt.imshow(im, cmap='gray')\nplt.show()","1fb31d94":"Checking sex as the next factor, the drugs seem to be equally allocated among each sex, so perhaps this factor is not a good predictor of prescription. ","e4b9978f":"A further condition always holds: if BP is normal, and Na_to_K is below 15, drug X is always allocated. Let's remove this case from our further analysis. Also notice that high blood pressure patients are exclusively given drugs A or B, while low blood pressure patients are exclusively given drug C or X.","27f606d0":"Each patient has a value for age, sex, blood pressure, cholesterol and Sodium to Potassium ratio in the blood (Na_to_K). We aim to classify their drug prescription based on these factors.","23a4c4c1":"Notice there is a clear difference in age distribution for those assigned these two drugs! The next plot shows this divide more clearly.","f24b7706":"We start with plotting the continuous variables in a scatter plot, with each drug type coloured differently. We check for obvious clusters whereby we can deduce a drug prescription based on Sodium to Potassium and\/or age. ","177b5d90":"# Initial Exploration","67cbb6c0":"We see that there are 5 different drugs, with the most part given Drug Y.","479d2258":"Through exploratory data analysis, we aim to provide a simple decision tree to decide which drug to give a patient, based on previous prescriptions to patients given in the dataset.","f63ef2d4":"# Data Analysis","37d8ea63":"# Decision Tree","8e74073c":"So, of those with high BP and Na to K <= 15, we prescribe drug A to those of age <=50, while those older than 50 are prescribed drug B. It now remains to consider those of low BP. For these, we consider the cholesterol.","b9d94da5":"# Imports and Reading Data","b868197e":"Next, we check blood pressure for this group. ","672f1e96":"Initially, we check how many people were given each drug, and how many different drugs there are.","41499747":"I love how simple this solution is! If you enjoyed it, please give this notebook an upvote :)","a4498ffe":"We see that if the patient has a high cholesterol, we prescribe drug C, while drug X is prescribed to those with normal cholesterol. This completes our analysis!","1773b30f":"We see a clear divide between those who were given drug Y: they all have an Na to K value greater than 15. Thus, this is our first criteria in our algorithm. It is therefore enough to consider those with Na_to_K <= 15 from this point.","3c28a9e8":"The following decision tree sums up our findings in the EDA, and gives a simple algorithm to decide which drug to prescribe!","330042db":"We consider the age distribution among the high blood pressure group."}}