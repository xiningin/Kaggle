{"cell_type":{"10475622":"code","cb7a2c15":"code","7e17f46d":"code","0d215d98":"code","ecf66062":"code","1471ae15":"code","f5c60c4f":"markdown"},"source":{"10475622":"import pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","cb7a2c15":"# list of (weight, submission file path)\n# supports n number of files\n# make sure the weights sum up to 1 always.\nweight_model_paths_pairs = [\n    (.05, '..\/input\/blending\/submission_2.csv'),\n    (.95, '..\/input\/blending\/submission_probed_f93_blended.csv')]","7e17f46d":"# verify weights sum up to ~1\nres = 0\nfor x, y in weight_model_paths_pairs:\n    res = res + x;\nprint(res)","0d215d98":"targets = ['target']\n\nsubmissions = []\nfor weight, path in weight_model_paths_pairs:\n    df = pd.read_csv(path)\n    df[targets] = df[targets] * weight\n    submissions.append(df)\n\nensembled_output = pd.concat(submissions).groupby(['id']).sum().reset_index()","ecf66062":"ensembled_output.head()","1471ae15":"ensembled_output.to_csv('submission_weighted_ensemble_1.csv', index=False)","f5c60c4f":"### Intuition: Multiple models lead a better model.\u00b6\n\n#### Open question:\n\n1. How to decide the weights for different model outputs?\n  1. One way is weight the better performing model more.\n\n\n#### Credits\n1. https:\/\/www.kaggle.com\/ambrosm\/tpsnov21-012-leaderboard-probing\n2. https:\/\/www.kaggle.com\/vipin20\/nov-tps-ensemble\n\n\nUpvote for support!! and kudos to the above mentioned notebooks!!"}}