{"cell_type":{"99e1d173":"code","d9b15690":"code","832fa570":"code","cc3d3d0c":"code","242299dc":"code","d31429a6":"code","f641fbb9":"code","470742b1":"code","d7400f34":"code","80867fb4":"code","df243ae0":"code","3d8f5dfc":"markdown","d5bd85e7":"markdown","539d043d":"markdown","2140b6f9":"markdown","72a47714":"markdown","3a35e5cb":"markdown","16640e0f":"markdown","efaca2f6":"markdown","c69d8800":"markdown","43e079f1":"markdown","5903489b":"markdown","0bdc1da8":"markdown","6f5591bb":"markdown","b8ae945b":"markdown","dc5c79ff":"markdown","6c1a8ff2":"markdown","bcd69c3b":"markdown","ef5d083c":"markdown"},"source":{"99e1d173":"from kaggle_environments import make, evaluate\n\n# Create the game environment\n# Set debug=True to see the errors if your agent refuses to run\nenv = make(\"connectx\", debug=True)\n\n# List of available default agents, each agent is essentially an AI which can play the aim\nprint(list(env.agents))","d9b15690":"# Two random agents(which select a random non-full column) play one game round\nenv.run([\"random\", \"random\"])\n\n# Show the game\nenv.render(mode=\"ipython\")","832fa570":"env.play([\"random\", None], width=500, height=450)","cc3d3d0c":"# Selects middle column\ndef agent_middle(obs, config):\n    return config.columns\/\/2","242299dc":"import random\n\ndef agent_random(obs, config):\n    valid_moves = [col for col in range(config.columns) if obs.board[col] == 0]\n    return random.choice(valid_moves)","d31429a6":"# Selects leftmost valid column\ndef agent_leftmost(obs, config):\n    valid_moves = [col for col in range(config.columns) if obs.board[col] == 0]\n    return valid_moves[0]","f641fbb9":"# Agents play one game round\nenv.run([agent_leftmost, agent_random])\n\n# Show the game\nenv.render(mode=\"ipython\")","470742b1":"import numpy as np\n\n# To learn more about the evaluate() function, check out the documentation here: (insert link here)\ndef get_win_percentages(agent1, agent2, n_rounds=100):\n    # Use default Connect Four setup\n    config = {'rows': 6, 'columns': 7, 'inarow': 4}\n    # Agent 1 goes first (roughly) half the time          \n    outcomes = evaluate(\"connectx\", [agent1, agent2], config, [], n_rounds\/\/2)\n    # Agent 2 goes first (roughly) half the time      \n    outcomes += [[b,a] for [a,b] in evaluate(\"connectx\", [agent2, agent1], config, [], n_rounds-n_rounds\/\/2)]\n    print(\"Agent 1 Win Percentage:\", np.round(outcomes.count([1,-1])\/len(outcomes), 2))\n    print(\"Agent 2 Win Percentage:\", np.round(outcomes.count([-1,1])\/len(outcomes), 2))\n    print(\"Number of Invalid Plays by Agent 1:\", outcomes.count([None, 0]))\n    print(\"Number of Invalid Plays by Agent 2:\", outcomes.count([0, None]))\n    print(\"Number of Draws (in {} game rounds):\".format(n_rounds), outcomes.count([0, 0]))","d7400f34":"get_win_percentages(agent1=agent_random, agent2=agent_random)","80867fb4":"get_win_percentages(agent1=agent_middle, agent2=agent_random)","df243ae0":"get_win_percentages(agent1=agent_leftmost, agent2=agent_random)","3d8f5dfc":"Agents are the things you create which interactive with the connect4 board.\n\nYour agent should be implemented as a Python function that accepts two arguments: obs and config. It returns an integer with the selected column, where indexing starts at zero. So, the returned value is one of 0-6, inclusive.\n\n","d5bd85e7":"You can use the player above to view the game in detail: every move is captured and can be replayed.\n\n","539d043d":"Which agent do you think performs better against the random agent: the agent that always plays in the middle (agent_middle), or the agent that chooses the leftmost valid column (agent_leftmost)? Let's find out!","2140b6f9":"To play against the you have created you can set the opponent to None","72a47714":"## config\n\nconfig contains three pieces of information:\n\nconfig.columns - number of columns in the game board (7 for Connect Four)\n\nconfig.rows - number of rows in the game board (6 for Connect Four)\n\nconfig.inarow - number of pieces a player needs to get in a row in order to win (4 for Connect Four)\n\n## obs\n\nobs.board - the game board (a Python list with one item for each grid location)\n\nobs.mark - the piece assigned to the agent (either 1 or 2)","3a35e5cb":"# Examples","16640e0f":"# Kaggle environment","efaca2f6":"# Evaluating agents","c69d8800":"For this we will be using kaggle kernels, these are online notebooks which are free to run","43e079f1":"An agent which always selects the middle column, whether it's valid or not! Note that if any agent selects an invalid move, it loses the game. An example of an invalid move would be where the agent picks a column which is already full","5903489b":"# Defining agents","0bdc1da8":"An agent which behaves identically to the \"random\" agent above.","6f5591bb":"An agent which selects the leftmost valid column.","b8ae945b":"# Getting Started","dc5c79ff":"For instance, for this game board:\n\n<img src=\"https:\/\/i.imgur.com\/kSYx4Nx.png\" width=\"20%\">\n \n    \nobs.board would be \n\n[0, 0, 0, 0, 0, 0, 0,\n\n 0, 0, 1, 1, 0, 0, 0,\n \n 0, 0, 2, 2, 0, 0, 0,\n \n 0, 2, 1, 2, 0, 0, 0,\n \n 0, 1, 1, 1, 0, 0, 0,\n \n 0, 2, 1, 2, 0, 2, 0].","6c1a8ff2":"The outcome of a single game is usually not enough information to figure out how well our agents are likely to perform. To get a better idea, we'll calculate the win percentages for each agent, averaged over multiple games. For fairness, each agent goes first half of the time.\n\nTo do this, we'll use the get_win_percentages() function (defined in a hidden code cell). To view the details of this function, click on the \"Code\" button below.","bcd69c3b":"Many of you will be familar with a game called connect 4, the aim of this game is simple, you need to get 4 of your pieces in a row before the opponent gets 4 in a row. \n\nThe aim of this challenge will be to create an AI to play the game.\n\n<img src=\"https:\/\/i.imgur.com\/40B1MGc.png\" >","ef5d083c":"1. You'll need to create a kaggle account [here](https:\/\/www.kaggle.com\/), and will need to verify this account with your phone number\n\n2. Duplicate this notebook by pressing the \"copy and edit button\" - you can create your own notebooks [here](https:\/\/www.kaggle.com\/notebooks\/welcome)"}}