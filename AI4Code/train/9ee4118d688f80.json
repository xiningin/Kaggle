{"cell_type":{"bd23ca27":"code","ac0de06f":"code","8f8f1553":"code","722c6e6a":"code","ea0193e3":"code","be939f1f":"code","b8484b06":"code","e6fe9810":"code","75f18946":"code","f0863ccf":"code","98b20b74":"code","e4c5c1ee":"code","3e0347d7":"code","59d7468c":"code","d57ed7fe":"code","0343ee3a":"code","c03e8c56":"code","1935c880":"code","49cac864":"code","f4900e9d":"code","399edeb9":"markdown","16b254c7":"markdown","56d14733":"markdown","c1d2be46":"markdown"},"source":{"bd23ca27":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","ac0de06f":"from fastai.vision import *\nfrom fastai.metrics import error_rate","8f8f1553":"path = Path(\"\/kaggle\/input\/\")","722c6e6a":"path.ls()","ea0193e3":"data = ImageDataBunch.from_folder(path, ds_tfms=get_transforms(), size=224, valid_pct=0.2, num_workers=0, bs=64).normalize(imagenet_stats)","be939f1f":"data.show_batch(rows=3, figsize=(7,6))","b8484b06":"learn = cnn_learner(data, models.resnet34, metrics=error_rate, model_dir=\"\/tmp\/model\/\")","e6fe9810":"import torch\ntorch.cuda.is_available()","75f18946":"learn.fit_one_cycle(4)","f0863ccf":"learn.save(\"stage-1-flower_recog\")","98b20b74":"interp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_top_losses(9, figsize=(15,11))","e4c5c1ee":"interp.plot_confusion_matrix(figsize=(12,12), dpi=60)","3e0347d7":"interp.most_confused(min_val=2)","59d7468c":"learn.lr_find()","d57ed7fe":"learn.recorder.plot()","0343ee3a":"learn.unfreeze()\nlearn.fit_one_cycle(2, max_lr=slice(1e-6,1e-3))","c03e8c56":"learn.model_dir = \"\/kaggle\/working\"\nlearn.save(\"stage-2-flower_recog\")","1935c880":"interp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_top_losses(9, figsize=(15,11))","49cac864":"interp.plot_confusion_matrix(figsize=(12,12), dpi=60)","f4900e9d":"interp.most_confused(min_val=2)","399edeb9":"## Training","16b254c7":"## Retraining","56d14733":"## Results","c1d2be46":"# Results Stage 2"}}