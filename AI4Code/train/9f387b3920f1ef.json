{"cell_type":{"20fbbd35":"code","7c267492":"code","6ee0f3f0":"code","79f9baca":"code","40de676a":"code","7dbde51c":"code","6d4aa45c":"code","9b56e265":"code","9860c5c3":"code","cc302e9a":"code","fbe1918f":"code","99d137e3":"code","be0561d6":"code","abf51d73":"code","ee54bad5":"code","60d12dc4":"code","99a4c71b":"code","b4a3eb91":"code","69c190f1":"code","7171c579":"code","3daeb6ae":"code","b13e10be":"code","e4af0447":"code","108de8b8":"code","ae11a4b9":"code","95f858f4":"code","4b07d63c":"code","8a24338e":"code","8082f176":"code","f75edd8e":"code","2c3b15ef":"code","eda30a02":"code","64d3e94b":"code","d9b47128":"code","159b7526":"code","7f8bbf0b":"code","aadfdbad":"code","53e1922b":"code","04719cca":"code","a0a9ac44":"code","e455d30a":"code","e1d34827":"code","8fb5bca3":"code","d6c5956b":"markdown","eef87937":"markdown","cb50dbf0":"markdown","b848ca3f":"markdown","2d1df7eb":"markdown","b6160b7a":"markdown","bdec637c":"markdown","fd2a43cc":"markdown","8bca6156":"markdown","a3d29b9a":"markdown","4df50605":"markdown","0c2898be":"markdown","ea5567a9":"markdown"},"source":{"20fbbd35":"\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","7c267492":"#Modules for EDA\nimport numpy as np \nimport pandas as pd \nimport seaborn as sns\nfrom matplotlib import pyplot as plt\nplt.style.use('fivethirtyeight')\n\n#Modules for ML(Recommendation)\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.neighbors import NearestNeighbors\nfrom sklearn.metrics.pairwise import cosine_similarity\n\n%matplotlib inline","6ee0f3f0":"df = pd.read_csv('..\/input\/top-100-korean-drama-mydramalist\/top100_kdrama.csv')\ndf.shape","79f9baca":"df.info()","40de676a":"synopsis = pd.read_csv('..\/input\/top-100-korean-drama-mydramalist\/top100_kdrama.csv',usecols=['Synopsis'])\nsynopsis.head()","7dbde51c":"df.head()","6d4aa45c":"kdrama_names = df[['Name']]\nkdrama_names.head()","9b56e265":"cols_for_recommend = ['Year of release', 'Number of Episode', 'Network', 'Duration', 'Content Rating', 'Rating']\ndf = df[cols_for_recommend]\ndf.head()","9860c5c3":"networks = []\n[networks.append(list(set(network.replace(' ','').split(',')))[0]) for network in df['Network']]\nnetworks[:5]","cc302e9a":"df['Network'] = networks\ndf['Network'].unique()","fbe1918f":"plt.figure(figsize=(7,7))\n\ndf['Network'].value_counts().plot(kind='barh')\n\nplt.gca().invert_yaxis()\nplt.title(\"Networks of Kdramas.\")\nplt.xlabel('Frequency')\nplt.show()\n\ndf['Network'].value_counts()","99d137e3":"df['Network'].replace(['OCN','Viki'],['Others','Others'],inplace=True)","be0561d6":"plt.figure(figsize=(7,7))\n\ndf['Network'].value_counts().plot(kind='barh')\n\nplt.gca().invert_yaxis()\nplt.title(\"Networks of Kdramas.\")\nplt.xlabel('Frequency')\nplt.ylabel('Network')\nplt.show()\n\ndf['Network'].value_counts()","abf51d73":"df['Duration'] = df['Duration'].str.replace('[A-Za-z]\\D+','',regex=True)\ndf['Duration'].head()","ee54bad5":"df['Duration'] = df['Duration'].str.replace(' ','',regex=True)\ndf['Duration'] = pd.to_numeric(df['Duration'])\ndf['Duration'].head()","60d12dc4":"plt.figure(figsize=(7,7))\nsns.histplot(data=df['Duration'])\nplt.title('Duration in minutes.')\nplt.show()","99a4c71b":"plt.figure(figsize=(7,7))\ndf['Content Rating'].value_counts().plot(kind='pie',autopct='%.2f%%')\nplt.title(\"Content Rating\")\nplt.show()","b4a3eb91":"df['Content Rating'].value_counts()","69c190f1":"sns.histplot(data=df[['Rating','Content Rating']],x='Rating',hue='Content Rating')\nplt.show()","7171c579":"df[['Rating']].describe()","3daeb6ae":"df.head()","b13e10be":"cols_to_encode = ['Network','Content Rating']\ndummies = pd.get_dummies(df[cols_to_encode],drop_first=True)\ndummies.head()","e4af0447":"df.drop(cols_to_encode, axis=1,inplace=True)\ndf.head()","108de8b8":"scale = MinMaxScaler()\nscalled = scale.fit_transform(df)","ae11a4b9":"i=0\nfor col in df.columns:\n    df[col] = scalled[:,i]\n    i += 1","95f858f4":"df.head()","4b07d63c":"new_df = pd.concat([df, dummies],axis=1)\nnew_df.shape","8a24338e":"new_df.head()","8082f176":"kdrama_names['Name'].loc[23]='kingdom'","f75edd8e":"new_df.index = [drama for drama in kdrama_names['Name']]\nsynopsis.index = [drama for drama in kdrama_names['Name']]","2c3b15ef":"new_df.head()","eda30a02":"def getRecommendation_dramas_for(drama_name,no_of_recommend=5,get_similarity_rate=False):\n    \n    kn = NearestNeighbors(n_neighbors=no_of_recommend+1,metric='manhattan')\n    kn.fit(new_df)\n    \n    distances, indices = kn.kneighbors(new_df.loc[drama_name])\n    \n    print(f'Similar K-Dramas for \"{drama_name[0]}\":')\n    nearest_dramas = [kdrama_names.loc[i][0] for i in indices.flatten()][1:]\n    if not get_similarity_rate:\n        return nearest_dramas\n    sim_rates = []\n    synopsis_ = []\n    for drama in nearest_dramas:\n        synopsis_.append(synopsis.loc[drama][0])\n        sim = cosine_similarity(new_df.loc[drama_name],[new_df.loc[drama]]).flatten()\n        sim_rates.append(sim[0])\n    recommended_dramas = pd.DataFrame({'Recommended Drama':nearest_dramas,'Similarity':sim_rates,'Synopsis':synopsis_})\n    recommended_dramas.sort_values(by='Similarity',ascending=True)\n    return recommended_dramas","64d3e94b":"rd1 = kdrama_names.loc[0]\nrd1","d9b47128":"getRecommendation_dramas_for(rd1,no_of_recommend=5)","159b7526":"rd2 = kdrama_names.loc[10]\nrd2","7f8bbf0b":"getRecommendation_dramas_for(rd2,get_similarity_rate=True)","aadfdbad":"rd3 = kdrama_names.loc[1]\nrd3","53e1922b":"getRecommendation_dramas_for(rd3,get_similarity_rate=True)","04719cca":"def print_similiar_drama_Synopsis(recommended_df):\n    rdf = recommended_df\n    rdf_cols = rdf['Synopsis']\n    dramas = rdf['Recommended Drama']\n    for i in range(5):\n        print(dramas[i])\n        print(rdf_cols[i])\n        print('\\n')","a0a9ac44":"rd4 = kdrama_names.loc[8]\nrd4","e455d30a":"rdf4 = getRecommendation_dramas_for(rd4,no_of_recommend=10,get_similarity_rate=True)\nprint_similiar_drama_Synopsis(rdf4)","e1d34827":"rd5 = kdrama_names.loc[99]\nrd5","8fb5bca3":"getRecommendation_dramas_for(rd5,no_of_recommend=5,get_similarity_rate=True)","d6c5956b":"# **Removing Duplicate values in Network column**","eef87937":"# **Name as separate DataFrame**","cb50dbf0":"# **One Hot Encoding**","b848ca3f":"# **Rating and Content Rating**","2d1df7eb":"# **Feature Scaling**","b6160b7a":"# **Duration in Minutes**","bdec637c":"# **Features using for Recommendation**","fd2a43cc":"# **Predicting Drama Recommendation**","8bca6156":"# **Network and Total KDramas**","a3d29b9a":"### **Similarly I have done Android App Recommendation and Amazon Book Recommendation**\n### **If you're interested then click on below links:**\n1. **<a href=\"https:\/\/www.kaggle.com\/nandalald\/android-app-recommendation\/\">Android App Recommendation<\/a>**\n2. **<a href=\"https:\/\/www.kaggle.com\/nandalald\/amazon-books-eda-recommendation\">Amazon Book Recommendation<\/a>**","4df50605":"# **Content Rating**","0c2898be":"# **Feature Engineering**","ea5567a9":"# **Setting OCN and ViKi networks to others because of less count**"}}