{"cell_type":{"b0d3e9a3":"code","80deb576":"code","8ad83ce3":"code","15e29a10":"code","50f51956":"code","8202d3f8":"code","01c9f447":"code","a42648db":"code","57ea7989":"code","98a73a4c":"code","70d11598":"code","a0c45a51":"code","a1743c21":"code","108ba9f2":"code","40dbf2e8":"code","146f0b33":"code","5cfcb5c1":"code","7e3ce8c0":"code","dd057810":"code","cb8667ba":"code","35e58d1c":"code","17ad2cf4":"code","e7279851":"code","61eb0086":"code","c745096e":"code","f049a7ac":"code","e9c8cce2":"code","283be62a":"code","ee144b80":"code","78eb418f":"code","c9ba0945":"code","0ff1fff2":"code","3351072f":"code","a0c091b1":"code","2d39d9b3":"code","7077e44e":"code","d84b906b":"code","958756f0":"code","166ae831":"code","5ef12626":"code","36df23a0":"code","55911db3":"code","86fecc63":"code","9d4fd312":"code","a846ac55":"code","bcbcceba":"code","93e63815":"code","589320ea":"code","06facef1":"code","0ea9b20b":"code","f77c50d2":"code","88c7d3d9":"code","db7ed860":"code","cd5bb1ae":"code","67e065de":"code","690ea929":"code","95ccc191":"code","ec7e379c":"code","9a4cbd9a":"code","7b1a565a":"code","d9ebd88b":"code","c8d45a6e":"code","f4981fc3":"code","3fc61ac5":"code","ffafa095":"code","dc1ec5b5":"code","c6df9295":"code","7a3319cf":"code","e1886545":"code","1aba0bd8":"code","90594930":"code","fcd7930c":"code","b73bb66b":"code","d38b2cdd":"code","261f7d48":"code","309b314b":"code","d7153513":"code","37418617":"code","e99714d4":"code","6f155afb":"code","883d81ca":"code","9f52b60c":"markdown","0cce7053":"markdown","1ac69fcc":"markdown","9ff63c3b":"markdown","58889e2f":"markdown","b4beb4ff":"markdown","e096843c":"markdown","9fbae84e":"markdown","27aaa896":"markdown","508ad75c":"markdown","5bbef787":"markdown","cb524787":"markdown","d99dd0ac":"markdown","ed2e4a34":"markdown","f7b240b5":"markdown","576adcff":"markdown","139446ad":"markdown","ffecfadd":"markdown","c5a5c482":"markdown","1f407ac0":"markdown","46165676":"markdown","a9e76f4f":"markdown","7812903e":"markdown","92f8cb92":"markdown","0915603e":"markdown","49e53795":"markdown","ec754bc4":"markdown","1780d06d":"markdown","8b2c5244":"markdown","50cf886c":"markdown","8ca88d37":"markdown","52c078d0":"markdown","f5a12db6":"markdown","a686cdb9":"markdown","01dffe66":"markdown","5dbe7052":"markdown","000b81d5":"markdown","21ba2b0d":"markdown","7c669dd2":"markdown","719ac705":"markdown","681cf78e":"markdown","2dac08db":"markdown","7bed1030":"markdown","4896ec5a":"markdown","8f4818bc":"markdown","21d09f94":"markdown","aaaf6733":"markdown","0399ed67":"markdown"},"source":{"b0d3e9a3":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns #importing seaborn module \nimport warnings\nfrom collections import Counter\nwarnings.filterwarnings('ignore')  #this will ignore the warnings.it wont display warnings in notebook\n#plt.style.use('fivethirtyeight')\nplt.style.use('ggplot')\nplt.rcParams['figure.figsize']=[6,3]\nplt.rcParams['figure.dpi']=80\n","80deb576":"data= pd.read_csv('..\/input\/loan-predication\/train_u6lujuX_CVtuZ9i (1).csv')","8ad83ce3":"#Missing Values\ndata.isnull().sum()","15e29a10":"plt.figure(figsize=(10,10))\nsns.heatmap(data.isnull(),cbar=False,cmap='YlGnBu')\nplt.ioff()","50f51956":"data.info()","8202d3f8":"#Dropping unwanted columns - Loan_ID\ndata.drop(['Loan_ID'],axis=1,inplace=True)\ndata.head()","01c9f447":"data['Loan_Status'] = data['Loan_Status'].map({'N':0,'Y':1})","a42648db":"fig,ax = plt.subplots(2,4,figsize=(16,10))\nsns.countplot('Loan_Status',data=data,ax=ax[0][0])\nsns.countplot('Gender',data=data,ax=ax[0][1])\nsns.countplot('Married',data=data,ax=ax[0][2])\nsns.countplot('Education',data=data,ax=ax[0][3])\nsns.countplot('Self_Employed',data=data,ax=ax[1][0])\nsns.countplot('Property_Area',data=data,ax=ax[1][1])\nsns.countplot('Credit_History',data=data,ax=ax[1][2])\nsns.countplot('Dependents',data=data,ax=ax[1][3])","57ea7989":"# Variable - ApplicantIncome\nsns.distplot(data['ApplicantIncome'],kde=True,bins=10)","98a73a4c":"# Variable - CoapplicantIncome\nsns.distplot(data['CoapplicantIncome'],kde=True,bins=10)","70d11598":"# Variable - LoanAmount\nsns.distplot(data['LoanAmount'],kde=True,bins=10)","a0c45a51":"# Variable - Loan_Amount_Term\nsns.distplot(data['Loan_Amount_Term'],kde=False,bins=10)","a1743c21":"data.Married.isnull().sum()","108ba9f2":"data['Married'].fillna(data['Married'].value_counts().index[0], inplace=True)","40dbf2e8":"data.Married.isnull().sum()","146f0b33":"data.Married.value_counts()","5cfcb5c1":"# Variable - Loan_Status\nf,ax=plt.subplots(1,2,figsize=(8,6))\ndata['Loan_Status'].value_counts().plot.pie(ax=ax[0],explode=[0,0.1],shadow=True,autopct='%1.1f%%')\nax[0].set_title('Loan_Status',fontsize=30)\nax[0].set_ylabel('Count')\nsns.set(font=\"Verdana\")\nsns.set_style(\"ticks\")\nsns.countplot('Loan_Status',hue='Married',linewidth=2.5,edgecolor=\".2\",data=data,ax=ax[1])\nplt.ioff()","7e3ce8c0":"# Variable - Married\nf,ax=plt.subplots(1,2,figsize=(8,8))\ndata['Married'].value_counts().plot.pie(ax=ax[0],explode=[0,0.1],shadow=True,autopct='%1.1f%%')\nax[0].set_title('Married',fontsize=30)\nax[0].set_ylabel('Count')\nsns.set(font=\"Verdana\")\nsns.set_style(\"ticks\")\nsns.countplot('Married',hue='Loan_Status',linewidth=2.5,edgecolor=\".2\",data=data,ax=ax[1])\nplt.ioff() ","dd057810":"#Catplot - Gives us the percentage of Loan_Status in different Married status and proprty types\nsns.catplot(x='Married',y='Loan_Status',kind='bar',data=data,col='Property_Area',hue='Education')","cb8667ba":"sns.catplot(x='Married',y='Loan_Status',kind='violin',data=data)","35e58d1c":"f,ax=plt.subplots(1,2,figsize=(10,8))\ndata[['Married','Loan_Status']].groupby(['Married']).mean().plot.bar(ax=ax[0])\nax[0].set_title('Loan_Status vs Married')\nsns.countplot('Married',hue='Loan_Status',data=data,ax=ax[1])\nax[1].set_title('Married:Loan_Status')\nplt.show()","17ad2cf4":"# Variable - Education\nf,ax=plt.subplots(1,2,figsize=(10,8))\ndata['Education'].value_counts().plot.pie(ax=ax[0],explode=[0,0.1],shadow=True,autopct='%1.1f%%')\nax[0].set_title('Education',fontsize=30)\nax[0].set_ylabel('Count')\nsns.set(font=\"Verdana\")\nsns.set_style(\"ticks\")\nsns.countplot('Education',hue='Loan_Status',linewidth=2.5,edgecolor=\".2\",data=data,ax=ax[1])\nplt.ioff()","e7279851":"#Catplot - Gives us the percentage of Loan_Status in different Married status and Property_Area\nsns.catplot(x='Education',y='Loan_Status',kind='bar',data=data,col='Married',hue='Property_Area')\n","61eb0086":"sns.catplot(x='Education',y='Loan_Status',kind='violin',data=data)","c745096e":"# Variable - Property_Area\nf,ax=plt.subplots(1,2,figsize=(8,6))\ndata['Property_Area'].value_counts().plot.pie(ax=ax[0],explode=[0,0,0.1],shadow=True,autopct='%1.1f%%')\nax[0].set_title('Property_Area',fontsize=30)\nax[0].set_ylabel('Count')\nsns.set(font=\"Verdana\")\nsns.set_style(\"ticks\")\nsns.countplot('Property_Area',hue='Loan_Status',linewidth=2.5,edgecolor=\".2\",data=data,ax=ax[1])\nplt.ioff()","f049a7ac":"#Catplot - Gives us the percentage of Loan_Status in different conditions\nsns.catplot(x='Property_Area',y='Loan_Status',kind='bar',data=data)\nsns.catplot(x='Property_Area',y='Loan_Status',kind='bar',data=data,hue=\"Married\",col='Education')\nsns.catplot(x='Property_Area',y='Loan_Status',kind='violin',data=data)\n","e9c8cce2":"# Variable - Gender\nf,ax=plt.subplots(1,2,figsize=(10,6))\ndata['Gender'].value_counts().plot.pie(ax=ax[0],explode=[0,0.1],shadow=True,autopct='%1.1f%%')\nax[0].set_title('Gender',fontsize=30)\nax[0].set_ylabel('Count')\nsns.set(font=\"Verdana\")\nsns.set_style(\"ticks\")\nsns.countplot('Gender',hue='Loan_Status',linewidth=2.5,edgecolor=\".2\",data=data,ax=ax[1])\nplt.ioff()","283be62a":"sns.catplot(x='Gender',y='Loan_Status',kind='bar',data=data,col='Property_Area',hue='Education')","ee144b80":"sns.catplot(x='Gender',y='Loan_Status',kind='bar',data=data)","78eb418f":"#Variable - ApplicantIncome\n#Histogram\ndata['ApplicantIncome'].hist(bins=40,color='orange')","c9ba0945":"#Genderwise ApplicantIncome Distribution\nf,ax=plt.subplots(1,2,figsize=(8,6))\nsns.distplot(data[data['Gender']=='Male'].ApplicantIncome,ax=ax[0])\nax[0].set_title('ApplicantIncome in Gender Male')\nsns.distplot(data[data['Gender']=='Female'].ApplicantIncome,ax=ax[1])\nax[1].set_title('ApplicantIncome in Gender Female')\nplt.show()","0ff1fff2":"#Loan status wise ApplicantIncome Distribution\nf,ax=plt.subplots(1,2,figsize=(8,6))\nsns.distplot(data[data['Loan_Status']==0].ApplicantIncome,ax=ax[0])\nax[0].set_title('ApplicantIncome in Loan_Status 0')\nsns.distplot(data[data['Loan_Status']==1].ApplicantIncome,ax=ax[1])\nax[1].set_title('ApplicantIncome in Loan_Status 1')\nplt.show()","3351072f":"sns.catplot(x='Gender',y='ApplicantIncome',data=data,kind='box')","a0c091b1":"sns.catplot(x='Gender',y='ApplicantIncome',data=data,kind='boxen',hue='Loan_Status', col='Property_Area')","2d39d9b3":"#Variable - CoapplicantIncome\ndata['CoapplicantIncome'].hist(bins=40,color='orange')","7077e44e":"#Genderwise CoapplicantIncome Distribution\nf,ax=plt.subplots(1,2,figsize=(8,6))\nsns.distplot(data[data['Gender']=='Male'].CoapplicantIncome,ax=ax[0])\nax[0].set_title('CoapplicantIncome in Gender Male')\nsns.distplot(data[data['Gender']=='Female'].CoapplicantIncome,ax=ax[1])\nax[1].set_title('CoapplicantIncome in Gender Female')\n\nplt.show()","d84b906b":"#Loan status wise CoapplicantIncome Distribution\nf,ax=plt.subplots(1,2,figsize=(8,6))\nsns.distplot(data[data['Loan_Status']==0].CoapplicantIncome,ax=ax[0])\nax[0].set_title('CoapplicantIncome in Loan_Status 0')\nsns.distplot(data[data['Loan_Status']==1].CoapplicantIncome,ax=ax[1])\nax[1].set_title('CoapplicantIncome in Loan_Status 1')\nplt.show()","958756f0":"sns.catplot(x='Gender',y='CoapplicantIncome',data=data,kind='box')","166ae831":"sns.catplot(x='Gender',y='CoapplicantIncome',data=data,kind='boxen',hue='Loan_Status', col='Property_Area')","5ef12626":"# Variable - Dependents\nf,ax=plt.subplots(1,2,figsize=(8,6))\ndata['Dependents'].value_counts().plot.pie(ax=ax[0],shadow=True,autopct='%1.1f%%')\nax[0].set_title('Dependents',fontsize=30)\nax[0].set_ylabel('Count')\nsns.set(font=\"Verdana\")\nsns.set_style(\"ticks\")\nsns.countplot('Dependents',hue='Loan_Status',linewidth=2.5,edgecolor=\".2\",data=data,ax=ax[1])\nplt.ioff()","36df23a0":"sns.catplot(x='Dependents',y='Loan_Status',kind='bar',data=data,col='Property_Area')","55911db3":"f,ax=plt.subplots(1,4,figsize=(20,8))\nsns.distplot(data[data['Dependents']=='0'].LoanAmount,ax=ax[0])\nax[0].set_title('LoanAmount in Dependents 0')\nsns.distplot(data[data['Dependents']=='1'].LoanAmount,ax=ax[1])\nax[1].set_title('LoanAmount in Dependents 1')\nsns.distplot(data[data['Dependents']=='2'].LoanAmount,ax=ax[2])\nax[2].set_title('LoanAmount in Dependents 2')\nsns.distplot(data[data['Dependents']=='3+'].LoanAmount,ax=ax[3])\nax[3].set_title('LoanAmount in Dependents 3+')\nplt.show()","86fecc63":"# Variable - Credit_History\nf,ax=plt.subplots(1,2,figsize=(8,6))\ndata['Credit_History'].value_counts().plot.pie(ax=ax[0],shadow=True,autopct='%1.1f%%')\nax[0].set_title('Credit_History',fontsize=30)\nax[0].set_ylabel('Count')\nsns.set(font=\"Verdana\")\nsns.set_style(\"ticks\")\nsns.countplot('Credit_History',hue='Loan_Status',linewidth=2.5,edgecolor=\".2\",data=data,ax=ax[1])\nplt.ioff()","9d4fd312":"sns.catplot(x='Education',y='Credit_History',kind='bar',data=data)","a846ac55":"sns.catplot(x='Credit_History',y='Loan_Status',kind='bar',data=data)","bcbcceba":"# Variable - Self_Employed\nf,ax=plt.subplots(1,2,figsize=(8,6))\ndata['Self_Employed'].value_counts().plot.pie(ax=ax[0],shadow=True,autopct='%1.1f%%')\nax[0].set_title('Self_Employed',fontsize=30)\nax[0].set_ylabel('Count')\nsns.set(font=\"Verdana\")\nsns.set_style(\"ticks\")\nsns.countplot('Self_Employed',hue='Loan_Status',linewidth=2.5,edgecolor=\".2\",data=data,ax=ax[1])\nplt.ioff()","93e63815":"sns.catplot(x='Self_Employed',y='Loan_Status',kind='bar',data=data,col='Property_Area',hue='Education')","589320ea":"#Variable - LoanAmount\nf,ax=plt.subplots(1,2,figsize=(8,6))\nsns.distplot(data[data['Gender']=='Male'].LoanAmount,ax=ax[0])\nax[0].set_title('LoanAmount in Gender Male')\nsns.distplot(data[data['Gender']=='Female'].LoanAmount,ax=ax[1])\nax[1].set_title('LoanAmount in Gender Female')\nplt.show()","06facef1":"f,ax=plt.subplots(1,2,figsize=(8,6))\nsns.distplot(data[data['Loan_Status']==0].LoanAmount,ax=ax[0])\nax[0].set_title('LoanAmount in Loan_Status 0')\nsns.distplot(data[data['Loan_Status']==1].LoanAmount,ax=ax[1])\nax[1].set_title('LoanAmount in Loan_Status 1')\nplt.show()","0ea9b20b":"sns.catplot(x='Gender',y='LoanAmount',data=data,kind='box')","f77c50d2":"sns.catplot(x='Self_Employed',y='LoanAmount',data=data,kind='box')","88c7d3d9":"sns.catplot(x='Gender',y='LoanAmount',data=data,kind='box',hue='Loan_Status', col='Married')","db7ed860":"#Variable - Loan_Amount_Term\nf,ax=plt.subplots(1,2,figsize=(16,8))\ndata['Loan_Amount_Term'].value_counts().plot.pie(ax=ax[0],shadow=True,autopct='%1.1f%%')\nax[0].set_title('Loan_Amount_Term',fontsize=30)\nax[0].set_ylabel('Count')\nsns.set(font=\"Verdana\")\nsns.set_style(\"ticks\")\nsns.countplot('Loan_Amount_Term',hue='Loan_Status',linewidth=2.5,edgecolor=\".2\",data=data,ax=ax[1])\nplt.ioff()","cd5bb1ae":"sns.catplot(x='Loan_Amount_Term',y='Loan_Status',kind='bar',data=data)","67e065de":"sns.catplot(x='Loan_Amount_Term',y='Loan_Status',kind='bar',data=data,col='Property_Area')","690ea929":"data.isnull().sum()","95ccc191":"# Imputing missing Dependents values\n\n# If loan status is 1 then, dependent = 2 else dependent=1\ndata.loc[(data.Dependents.isnull())&(data.Loan_Status==1),'Dependents'] = '2'\ndata.loc[(data.Dependents.isnull()),'Dependents'] = '1'","ec7e379c":"# Imputing missing Credit_History values\n\n# If loan status is 1 then, Credit_History = 1 else Credit_History=0\ndata.loc[(data.Credit_History.isnull())&(data.Loan_Status==1),'Credit_History'] = 1\ndata.loc[(data.Credit_History.isnull()),'Credit_History'] = 0\n","9a4cbd9a":"# Variable - LoanAmount\n# Explore LoanAmount vs categorical variables\ng = sns.factorplot(y=\"LoanAmount\",x=\"Credit_History\",data=data,kind=\"box\",hue=\"Gender\")\ng = sns.factorplot(y=\"LoanAmount\",x=\"Property_Area\",data=data,kind=\"box\", hue=\"Dependents\")\ng = sns.factorplot(y=\"LoanAmount\",x=\"Gender\", data=data,kind=\"box\",hue=\"Married\")\ng = sns.factorplot(y=\"LoanAmount\",x=\"Married\", data=data,kind=\"box\")\ng = sns.factorplot(y=\"LoanAmount\",x=\"Education\", data=data,kind=\"box\")\ng = sns.factorplot(y=\"LoanAmount\",x=\"Self_Employed\", data=data,kind=\"box\")\ng = sns.factorplot(y=\"LoanAmount\",x=\"Dependents\", data=data,kind=\"box\")","7b1a565a":"data[\"Gender\"] = data[\"Gender\"].map({\"Male\": 1, \"Female\":0})\n\ndata[\"Married\"] = data[\"Married\"].map({\"No\": 0, \"Yes\":1})\n\ndata[\"Education\"] = data[\"Education\"].map({\"Graduate\": 1, \"Not Graduate\":0})\n\ndata[\"Self_Employed\"] = data[\"Self_Employed\"].map({\"Yes\": 1, \"No\":0})\n\ndata[\"Dependents\"] = data[\"Dependents\"].map({\"0\": 0, \"1\":1,\"2\": 2, \"3+\":3})\n\ndata[\"Property_Area\"] = data[\"Property_Area\"].map({\"Urban\": 0, \"Rural\":1,\"2\": 2, \"Semiurban\":3})\n\n","d9ebd88b":"fig = plt.figure(figsize = (10,7))\ng = sns.heatmap(data[[\"LoanAmount\",\"Gender\",\"Married\",\"Education\",\"Self_Employed\",\"Dependents\"]].corr(),cmap=\"BrBG\",annot=True)\n","c8d45a6e":"index_NaN_LoanAmount = list(data[\"LoanAmount\"][data[\"LoanAmount\"].isnull()].index)\n\nfor i in index_NaN_LoanAmount :\n    LoanAmount_med = data[\"LoanAmount\"].median()\n    LoanAmount_pred = data[\"LoanAmount\"][((data['Gender'] == data.iloc[i][\"Gender\"]) & (data['Married'] == data.iloc[i][\"Married\"]) & (data['Education'] == data.iloc[i][\"Education\"]) & (data['Self_Employed'] == data.iloc[i][\"Self_Employed\"]) & (data['Dependents'] == data.iloc[i][\"Dependents\"]))].median()\n    if not np.isnan(LoanAmount_pred) :\n        data['LoanAmount'].iloc[i] = LoanAmount_pred\n    else :\n        data['LoanAmount'].iloc[i] = LoanAmount_med","f4981fc3":"data.LoanAmount.isnull().sum()","3fc61ac5":"g = sns.factorplot(x=\"Loan_Status\", y = \"LoanAmount\",data = data, kind=\"box\")\ng = sns.factorplot(x=\"Loan_Status\", y = \"LoanAmount\",data = data, kind=\"violin\")\n","ffafa095":"# Variable - Loan_Amount_Term\nfig = plt.figure(figsize = (10,7))\ng = sns.heatmap(data[[\"Loan_Amount_Term\",\"Gender\",\"Married\",\"Education\",\"Self_Employed\",\"Dependents\",\"Credit_History\",\"Property_Area\"]].corr(),cmap=\"BrBG\",annot=True)\n","dc1ec5b5":"index_NaN_Loan_Amount_Term = list(data[\"Loan_Amount_Term\"][data[\"Loan_Amount_Term\"].isnull()].index)\n\nfor i in index_NaN_Loan_Amount_Term :\n    Loan_Amount_Term_med = data[\"Loan_Amount_Term\"].median()\n    Loan_Amount_Term_pred = data[\"Loan_Amount_Term\"][((data['Gender'] == data.iloc[i][\"Gender\"]) & (data['Married'] == data.iloc[i][\"Married\"]) & (data['Education'] == data.iloc[i][\"Education\"]) & (data['Self_Employed'] == data.iloc[i][\"Self_Employed\"]) & (data['Dependents'] == data.iloc[i][\"Dependents\"]))].median()\n    if not np.isnan(Loan_Amount_Term_pred) :\n        data['Loan_Amount_Term'].iloc[i] = Loan_Amount_Term_pred\n    else :\n        data['Loan_Amount_Term'].iloc[i] = Loan_Amount_Term_med","c6df9295":"data.Loan_Amount_Term.isnull().sum()","7a3319cf":"g = sns.factorplot(x=\"Loan_Status\", y = \"Loan_Amount_Term\",data = data, kind=\"box\")\ng = sns.factorplot(x=\"Loan_Status\", y = \"Loan_Amount_Term\",data = data, kind=\"violin\")\n","e1886545":"#Variable 3 - Gender\ndata.Gender.value_counts()\n\n","1aba0bd8":"# Imputing missing Gender values\nfig = plt.figure(figsize = (10,7))\ng = sns.heatmap(data[[\"Gender\",\"Married\",\"Education\",\"Self_Employed\",\"Dependents\",\"Credit_History\",\"Property_Area\"]].corr(),cmap=\"BrBG\",annot=True)\n","90594930":"#Fill Null values with mode of Gender column\ndata['Gender'].fillna(data['Gender'].value_counts().index[0], inplace=True)\ndata.Gender.isnull().sum()","fcd7930c":"# Imputing missing Self_Employed values\n\n# If Credit_History is 1 then, impute Self_Employed = No else Yes\ndata.loc[(data.Self_Employed.isnull())&(data.Credit_History==1),'Self_Employed'] =0\ndata.loc[(data.Self_Employed.isnull()),'Self_Employed'] = 1\n","b73bb66b":"data.isnull().sum()","d38b2cdd":"#Final Pair plot\nsns.heatmap(data.corr(),annot=True,cmap='RdYlGn',linewidths=0.2,annot_kws={'size':12})\nfig=plt.gcf()\nfig.set_size_inches(10,8)\nplt.xticks(fontsize=14)\nplt.yticks(fontsize=14)\nplt.show()","261f7d48":"########## Train Test Split ##############\ndf_train = data.copy()\ndf_train.shape\n\ntrain = df_train.drop([\"Loan_Status\"],axis=1)\ntrain_ = df_train[\"Loan_Status\"]\n\nX_train = train.values\ny_train = train_.values","309b314b":"################### Feature Scaling ############################\nfrom sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX_train = sc.fit_transform(X_train)","d7153513":"from sklearn.model_selection import train_test_split, cross_val_predict,cross_validate\ntrain_x, test_x,train_y,test_y = train_test_split(X_train,y_train,test_size  = 0.2, random_state=0)\nprint(\"Train dataset shape: {0}, \\nTest dataset shape: {1}\".format(train_x.shape, test_x.shape))","37418617":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score, confusion_matrix\n##### Logistic Regression starts ######\n\nlogistic = LogisticRegression(max_iter=10000)\n#fitting the values for x and y\nlogistic.fit(train_x,train_y)\n\n#predictions from test data\nprediction = logistic.predict(test_x)\t\n#print(prediction)\n\n#calculating the accuracy\naccuracy_score = accuracy_score(test_y,prediction)\nprint(\"Accuracy Score Logistic Regresion  :\",accuracy_score)","e99714d4":"###### confusion matrix  starts ######\nfrom sklearn.metrics import accuracy_score, confusion_matrix\ncm_lgr1 = confusion_matrix(test_y,prediction) \nnames = np.unique(prediction)\nsns.heatmap(cm_lgr1, square=True, annot=True, cbar=False,xticklabels=names, yticklabels=names, cmap=\"YlGnBu\" ,fmt='g')\nplt.xlabel('Truth')\nplt.ylabel('Predicted')","6f155afb":"# Generic function for model building\nfrom sklearn.metrics import accuracy_score,precision_score,recall_score,f1_score\ndef fit_and_test(classifier, X_train, y_train, X_test, y_test, only_return_accuracy=False):\n  classifier.fit(X_train, y_train)\n  y_hat = classifier.predict(X_test)\n  print('accuracy:', accuracy_score(y_test, y_hat))\n  if not only_return_accuracy:\n    print('f1_score:', f1_score(y_test, y_hat))","883d81ca":"from sklearn.svm import  LinearSVC\nfor c in [0.001,0.01, 0.02, 0.05, 0.25, 0.5, 0.75, 1]:\n  svc = LinearSVC(C=c, max_iter=5000) # %\n  print (f'At C = {c}:-', end=' ')\n  fit_and_test(svc, train_x, train_y, test_x, test_y, True)","9f52b60c":"male LoanAmount lies between 0-250\nfemale LoanAmount lies between 0-200\nChances of having higher LoanAmount in male is more","0cce7053":"male co-applicant is having more income than female income","1ac69fcc":"Many Missing values. We will impute them later on. ","9ff63c3b":"If credit history is 1 then high chances (79.6%) of getting loan approved than 7.9% for credit history = 0","58889e2f":"If you are a graduate, then higher chances of having credit history=1  ","b4beb4ff":"Self employed status does not have much impact on loan approval","e096843c":"So we have imputed all NULL values, so lets start with Data pre-processing ","9fbae84e":"Mean CoapplicantIncome of male slightly higer than Females.","27aaa896":"Explore Numerical Variables","508ad75c":"#Univariate Analysis","5bbef787":"Support Vector Classifier","cb524787":"If you are in urban+Not graduate+not married = Loan approval is less**","d99dd0ac":"* male income lies between 150-10k\n* female income lies between 150-5k\n* Chances of having higher income in male is more","ed2e4a34":"84.2% have credit history & 15.8% have no history","f7b240b5":"* 36 months have lowest chance of loan approval followed by 480 months\n* 12,60 and 120 months have highest chance (100%) of loan approval","576adcff":"Loan amount depends upon Gender,Married, graduate, self-employed , dependents","139446ad":"#If you are in semiurban, then chances of getting \n#loan approved are more (76.8%) than \n#if you are in urban(65.8%) & Rural (61.5%)","ffecfadd":"Mean ApplicantIncome of male slightly higer than Females.","c5a5c482":"57.6% have no dependents & 8.5% have 3+ dependents","1f407ac0":"* In Rural area - Married status doesn't make any diff in loan approval\n* In other areas loan approval chances are more if you are married","46165676":"Heatmap of missing values","a9e76f4f":"IF you are married then loan amount is slightly higher then non-married","7812903e":"If you  are married, then chances of getting loan approved are more (71.8%) than if you are not married (62.9%).","92f8cb92":"Loan status  = Y for 68.7% & No for 31.3%","0915603e":"converting categorical variables to numerical values","49e53795":"Total 18 misclassified out of 123 test values","ec754bc4":"Variable - Married (Impute NAN values with mode of the variable)**","1780d06d":"Lets map target variable (Loan_status) from Yes\/No to 1\/0","8b2c5244":"Lets explore dataframe","50cf886c":"Mean LoanAmount of male slightly higer than Females.","8ca88d37":"Dependents = 2 have max chance of getting loan approved. 1 and 3 have min chance","52c078d0":"Imputing missing values ","f5a12db6":"Higher chances of getting loan approved if co-applicant income is more","a686cdb9":" 85.3% went for 360 months ","01dffe66":"If you are a graduate, then higher chances of having credit history=1 ","5dbe7052":"Male have higher co-applicant income than female in all three property areas","000b81d5":"Data Processing starts","21ba2b0d":"Overall 614 rows and 13 columns","7c669dd2":"Loan amount depends upon Gender,Married, graduate, self-employed , dependents confirmed by above heatmap. Hence we will impute values using these fields","719ac705":"Explore Categorical Variables","681cf78e":"* Conclusion : We achieved 85.36% accurcy with simple Logistic Regression and LinearSVC. Please Up Vote if you liked my Kernel","2dac08db":"If you are self employed then loan amount is higher","7bed1030":"85.9% ate not self-employed & 14.1% are self employed","4896ec5a":"loan approval chances are slightly more if you are male (69.3%) than female (67%)","8f4818bc":"If you  are graduate, then chances of getting loan approved are more (70.8%) than if you are not graduate (61.2%).","21d09f94":"Credit history has maximum correlaiton wth loan status which is obvious.","aaaf6733":"Not much variance","0399ed67":"Credit history as expected is the most important variable in deciding loan approval"}}