{"cell_type":{"bdc00d2b":"code","da7a11ad":"code","04cc4d75":"code","9e11c5ba":"code","b7f57993":"code","d496aa5b":"code","b44c765d":"code","5ae825e6":"code","375ad3f8":"code","821e12f5":"code","db51554e":"code","a6f507aa":"code","5c8cbafb":"code","77c65521":"markdown","a1665b9a":"markdown","2082c443":"markdown","a3fbf3e1":"markdown","096c6ad2":"markdown","150c13af":"markdown","17865ae3":"markdown","4ca4d9fa":"markdown","2b2bbbe1":"markdown","fe825f09":"markdown","f9770597":"markdown","e8ed322e":"markdown","9d63fb20":"markdown","c166aa8c":"markdown","6caaed05":"markdown","5c7c8f4b":"markdown","19fe04e8":"markdown"},"source":{"bdc00d2b":"import pandas as pd\nimport os\npath = '\/kaggle\/input\/berkeley-multimodal-human-action-database\/'\n\nfull_data = pd.DataFrame()\n\nfor entry in sorted(os.listdir(path)):\n    if os.path.isfile(os.path.join(path, entry)):\n        if entry.endswith('.txt'):\n            data = pd.read_csv(path+entry,sep=' ',header=None)\n            data.drop([129,130],inplace=True,axis=1)\n            data['classs'] = entry[-10:-8]\n            full_data = pd.concat([full_data,data],ignore_index=True)","da7a11ad":"full_data.shape","04cc4d75":"full_data.dtypes","9e11c5ba":"full_data.head()","b7f57993":"full_data.info()","d496aa5b":"x = full_data.drop([\"classs\"],axis=1)\ny = full_data.classs.values\nx.head()","b44c765d":"y = pd.DataFrame(y)\ny.iloc[:,0] = y.iloc[:,0].str.replace('t','1')\ny.iloc[:,0] = y.iloc[:,0].str.replace('-','2')\ny.astype('int32')","5ae825e6":"from sklearn.model_selection import train_test_split\n\nx_train, x_test, y_train, y_test = train_test_split(x,y,test_size=0.25,shuffle=True)\nprint('Shape of train data is : ',x_train.shape)\nprint('Shape of label data is : ',y_train.shape)","375ad3f8":"from keras.utils import to_categorical\ny_train = to_categorical(y_train)\ny_test = to_categorical(y_test)","821e12f5":"from keras.callbacks import EarlyStopping\nfrom tensorflow import keras\n\nearly_stop = EarlyStopping(monitor='loss', patience=2)\nmodel = keras.Sequential()\n\nmodel.add(keras.layers.Dense(128, activation='relu', input_shape=(129,)))\n\nmodel.add(keras.layers.Dense(256, activation='relu'))\n\nmodel.add(keras.layers.Dense(128, activation='relu'))\n\nmodel.add(keras.layers.Dense(256, activation='relu'))\n\nmodel.add(keras.layers.Dense(128, activation='relu'))\n\nmodel.add(keras.layers.Dense(64, activation='relu'))\n\nmodel.add(keras.layers.Dense(128, activation='relu'))\n\nmodel.add(keras.layers.Dense(256, activation='relu'))\n\nmodel.add(keras.layers.Dense(128, activation='relu'))\n\nmodel.add(keras.layers.Dense(64, activation='relu'))\n\nmodel.add(keras.layers.Dense(13, activation='softmax'))\n\nmodel.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])\nmodel.summary()","db51554e":"hist = model.fit(x_train , y_train , epochs=6, validation_split=0.20, batch_size= 128,callbacks=[early_stop])","a6f507aa":"from matplotlib import pyplot as plt\nprint(hist.history.keys())\n\nplt.plot(hist.history['loss'],label = 'Train loss')\nplt.plot(hist.history['val_loss'],label = 'Val loss')\nplt.legend()\nplt.show()","5c8cbafb":"hist2 = model.evaluate(x_test,y_test)","77c65521":"# Data\n**Hi, today I will show you how to classify Human Actions per sample with Deep Learning Methods.In previous notebooks that I shared, I already show you how to classify Human Action Data with classical Machine Learning Technics.\n![action_samples_surface_800.jpg](attachment:action_samples_surface_800.jpg)**","a1665b9a":"**Let's look train and validation loss.In the graph we can clearly see that validation loss is lower which is a very good result.**","2082c443":"**Thanks for read my notebook.If you encounter a problem in this notebook, please contact with me.If you like my notebook, please upvote to reach more people.Thanks :)**","a3fbf3e1":"**In this section, we split data as features and label.\"x\" variable is features and \"y\" variable is label of that features in order.**","096c6ad2":"# There are 13 actions:\n**1\tJumping in place\t\n2\tJumping jacks\t\n3\tBending - hands up all the way down\t\n4\tPunching (boxing)\t\n5\tWaving - two hands\t\n6\tWaving - one hand (right)\n7\tClapping hands\t\n8\tThrowing a ball\n9\tSit down then stand up\t\n10\tSit down\t\n11\tStand up\t\n12\tT-pose**","150c13af":"# Model Test\n\n- In this section, I tried my model in test data which the model hasn't seen yet.As you see, the accuracy is %98 which is better result than train and validation accuracy.so model works well.","17865ae3":"# Let's start code!\n**First, we import pandas and os library.Then, we iterate over all txt files and collect all joint data with labels in a dataframe.Every row of dataframe is a action in a sample, and there are 129 xyz joint coordinates and 1 class label named 'classs' column.**","4ca4d9fa":"**Now, we can split data as train and test data.**","2b2bbbe1":"**Let's have a look to data.**","fe825f09":"**(\"y\") Label data is in format of string,for 01-11 classes are basicly can be convertable to integer.But 12th class is like \"t-\" which is a string.So in this section we replace \"t-\" with \"12\" and convert it to integer.**","f9770597":"# Model Build\n\n- You can see the neuron number for all denses, I used 'relu' activation for this time, but you can change it to tune hyperparameters.The input shape is 129 which is features(columns) for all rows.\n- I choose optimizer 'adam', loss function 'categorical crossentropy'.\n- I also define a basic EarlyStopping to prevent overtrain.\n- Also, in model summary you can see the model clearly.In fact, I choose neuron numbers randomly with power of 2's.","e8ed322e":"**\"Y\" label data in format of integer, but we have to convert it to categorical to use in keras \"categorical crossentropy\" loss.**","9d63fb20":"**In this section, I want to have a look to memory usage of dataframe.You know that kaggle provide us 16GB memory and this dataframe is quaite big.I just wanted to see that \"can kaggle hardware handle this?\"**","c166aa8c":"# Train Area\n- I choose %20 of train data as validation data.\n- Batch size is 128.\n- 6 epochs used.","6caaed05":"**When we check data types of the dataframe we can clearly see that first 129 rows are x,y,z features in format of float and the last column named 'classs' is object in string format which is labels.**","5c7c8f4b":"# Data Storage Format\n\n- The files in database are in format of \"txt\".In txt files there are joint coordinates of 43 markers in human body in order.\n","19fe04e8":"**Let's check the data size of data.There are 2401920 rows(samples) and 130 features, last feature named 'classs' is label of that row.**"}}