{"cell_type":{"6b7d6835":"code","079d92de":"code","3ac5b4ab":"code","aed92aeb":"code","9fd7f94a":"code","832d8467":"code","1bcc4e0b":"code","beb55e88":"code","3bab63e4":"markdown"},"source":{"6b7d6835":"import numpy as np \nimport pandas as pd \nimport pandas_profiling as pp\n\nfrom catboost import Pool, CatBoostClassifier\nfrom sklearn.model_selection import train_test_split\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","079d92de":"test_csv = pd.read_csv('\/kaggle\/input\/titanic\/test.csv')\ntest_csv.head(5)\ntest= test_csv.fillna(0)\ntest.head(5)","3ac5b4ab":"train_csv = pd.read_csv('\/kaggle\/input\/titanic\/train.csv')\ntrain_csv.head(5)\ntrain = train_csv.fillna(0)\ntrain.head(5)","aed92aeb":"pp.ProfileReport(train_csv)","9fd7f94a":"X_train, X_test, y_train, y_test = train_test_split(train.drop([\"Survived\"], axis=1), train[\"Survived\"], test_size=0.2)","832d8467":"# Initialize data\n\n\ntrain_data = X_train[[\"Pclass\", \"Sex\", \"Age\", \"Fare\", \"Embarked\"]]\n\neval_data = X_test[[\"Pclass\", \"Sex\", \"Age\", \"Fare\", \"Embarked\"]]\n\ntrain_label = y_train\n\neval_label = y_test\n\n\ncat_features = [\"Sex\", \"Embarked\"]\n\n\ntrain_dataset = Pool(data=train_data,\n                     label=train_label,\n                     cat_features=cat_features)\n\neval_dataset = Pool(data=eval_data,\n                    label=eval_label,\n                    cat_features=cat_features)\n\n# Initialize CatBoostClassifier\nmodel = CatBoostClassifier(iterations=30)\n# Fit model with `use_best_model=True`\n\nmodel.fit(train_dataset,\n          use_best_model=True,\n          eval_set=eval_dataset)\n\nprint(\"Count of trees in model = {}\".format(model.tree_count_))\npreds = model.predict(test[[\"Pclass\", \"Sex\", \"Age\", \"Fare\", \"Embarked\"]])","1bcc4e0b":"output = pd.DataFrame({\"PassengerId\":test_csv[\"PassengerId\"],\"Survived\":preds}) ","beb55e88":"output.to_csv('my_submission.csv', index=False) ","3bab63e4":"\n\ny = train[\"Survived\"]\n\nfeatures = [\"Pclass\", \"Sex\", \"SibSp\", \"Parch\", \"Fare\"]\nX = pd.get_dummies(train[features])\nX_test = pd.get_dummies(test[features])\n\nmodel = RandomForestClassifier(n_estimators=100, max_depth=5, random_state=1)\nmodel.fit(X, y)\npredictions = model.predict(X_test)\n\noutput = pd.DataFrame({'PassengerId': test.PassengerId, 'Survived': predictions})\noutput.to_csv('my_submission.csv', index=False)\nprint(\"Your submission was successfully saved!\")"}}