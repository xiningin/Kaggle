{"cell_type":{"c1844493":"code","8d6af11e":"code","61700ddf":"code","418dbec8":"code","be5daa9e":"code","129cabb2":"code","8c75583c":"code","246a5aae":"code","95fc46d2":"code","caa0cabe":"code","929cd145":"code","2c78920b":"code","5f44da9f":"code","5587cf27":"code","01a0034f":"code","a2228b7b":"code","3655f8d5":"code","f3e90f94":"code","6757c2bb":"code","163355db":"code","70bbe99a":"code","3df88552":"code","0346f4ce":"code","86137410":"code","f40b441b":"code","22edb83e":"code","3bfa14d2":"code","a6b1a49d":"code","d855f2d9":"code","f6fe3225":"code","88a9b3a2":"code","7b907896":"code","b0ace61f":"code","cd8fa938":"code","bcc9f75c":"code","3ffc3545":"code","a71565bf":"code","3c033e82":"code","e2ef0692":"code","69c499b8":"code","2f18b085":"code","a4b98165":"markdown","13e7ba98":"markdown","68a186ae":"markdown","a0103bce":"markdown","c1d1a30f":"markdown","39e792b2":"markdown","d0051ab7":"markdown","bf1d4e8b":"markdown","433f3f2c":"markdown","58a85f34":"markdown","1acb921b":"markdown","a1f6fea4":"markdown"},"source":{"c1844493":"import numpy as np\nimport pandas as pd\nimport os\nfrom sklearn.impute import KNNImputer\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport statsmodels.api as sm\nimport scipy.stats as stats","8d6af11e":"df_test = pd.read_csv('\/kaggle\/input\/example-dataset-for-ab-test\/test_group.csv')\ndf_test.head()","61700ddf":"df_test[['Campaign Name','Date','Spend_USD','Number of Impressions','Reach','Number of Website Clicks',\n        'Number of Searches','Number of View Content','Number of Add to Cart','Number of Purchase']]=df_test['Campaign Name;Date;Spend [USD];# of Impressions;Reach;# of Website Clicks;# of Searches;# of View Content;# of Add to Cart;# of Purchase'].str.split(';',expand=True)\ndf_test = df_test.drop(['Campaign Name;Date;Spend [USD];# of Impressions;Reach;# of Website Clicks;# of Searches;# of View Content;# of Add to Cart;# of Purchase'],axis=1)\ndf_test = df_test.reset_index(drop=True)\ndf_test.head()","418dbec8":"df_test.info()","be5daa9e":"#change datatypes\ndf_test['Date'] = pd.to_datetime(df_test['Date'], format='%d.%m.%Y')\ndf_test.iloc[:,2:10] = df_test.iloc[:,2:10].apply(pd.to_numeric)\ndf_test.info()","129cabb2":"df_test.describe()","8c75583c":"df_control = pd.read_csv('\/kaggle\/input\/example-dataset-for-ab-test\/control_group.csv')\ndf_control.head()","246a5aae":"df_control[['Campaign Name','Date','Spend_USD','Number of Impressions','Reach','Number of Website Clicks',\n        'Number of Searches','Number of View Content','Number of Add to Cart','Number of Purchase']]=df_control['Campaign Name;Date;Spend [USD];# of Impressions;Reach;# of Website Clicks;# of Searches;# of View Content;# of Add to Cart;# of Purchase'].str.split(';',expand=True)\ndf_control = df_control.drop(['Campaign Name;Date;Spend [USD];# of Impressions;Reach;# of Website Clicks;# of Searches;# of View Content;# of Add to Cart;# of Purchase'],axis=1)\ndf_control = df_control.reset_index(drop=True)\ndf_control.head()","95fc46d2":"df_control.info()","caa0cabe":"#change datatypes\ndf_control['Date'] = pd.to_datetime(df_control['Date'], format='%d.%m.%Y')\ndf_control.iloc[:,2:10] = df_control.iloc[:,2:10].apply(pd.to_numeric)\ndf_control.info()","929cd145":"#There is a row with missing values. Let's fill the missing values with K-Nearest Neighbor.\nimputer = KNNImputer(weights='distance')\ndf_control.iloc[:,2:10]=pd.DataFrame(imputer.fit_transform(df_control.iloc[:,2:10]))","2c78920b":"df_control.info()","5f44da9f":"df_control.describe()","5587cf27":"#Combine two datasets into one and add new features for metrics evaluation\ndf = pd.concat([df_test,df_control])\ndf = df.reset_index()\ndf['USD Spend per Purchase'] = round(df['Spend_USD']\/df['Number of Purchase'],2)\ndf['CTR(%)'] = round(df['Number of Website Clicks']*100\/df['Number of Impressions'],2)\ndf['Conversion Rate(%)'] = round(df['Number of Purchase']*100\/df['Number of Website Clicks'],2)","01a0034f":"df.head()","a2228b7b":"df.tail()","3655f8d5":"df.describe()","f3e90f94":"sns.set_theme(style=\"ticks\")\ng = sns.jointplot(\n    data=df,\n    x=\"CTR(%)\", y=\"Conversion Rate(%)\", hue=\"Campaign Name\",\n    kind=\"kde\",\n)\nplt.show()","6757c2bb":"sns.set_theme(style=\"ticks\")\ng = sns.jointplot(\n    data=df,\n    x=\"Number of Website Clicks\", y=\"Number of Purchase\", hue=\"Campaign Name\",\n    kind=\"kde\",\n)\nplt.show()","163355db":"sns.set_theme(style=\"ticks\")\ng = sns.jointplot(\n    data=df,\n    x=\"Number of Add to Cart\", y=\"Number of Purchase\", hue=\"Campaign Name\",\n    kind=\"kde\",\n)\nplt.show()","70bbe99a":"sns.set_theme(style=\"ticks\")\ng = sns.jointplot(\n    data=df,\n    x=\"Spend_USD\", y=\"USD Spend per Purchase\", hue=\"Campaign Name\",\n    kind=\"kde\",\n)\nplt.show()","3df88552":"sns.set_theme(style=\"ticks\")\ng = sns.jointplot(\n    data=df,\n    x=\"Number of Impressions\", y=\"Reach\", hue=\"Campaign Name\",\n    kind=\"kde\",\n)\nplt.show()","0346f4ce":"total_spend = df.groupby(['Campaign Name'])['Spend_USD'].sum().reset_index()\ntotal_spend","86137410":"fig = plt.figure(figsize = (10, 6))\nplt.bar(total_spend['Campaign Name'], total_spend['Spend_USD'], width = 0.3)\nplt.xlabel(\"Campaign Name\")\nplt.ylabel(\"Total USD Spend\")\nplt.title(\"Total Spend by Group\", fontdict = {'fontsize' : 20})\nplt.show()","f40b441b":"spend_per_purchase = df.groupby(['Campaign Name'])['USD Spend per Purchase'].mean().reset_index()\nspend_per_purchase","22edb83e":"spend_per_purchase_uplift = (5.900000-4.986333)\/4.986333\nspend_per_purchase_uplift","3bfa14d2":"fig = plt.figure(figsize = (10,6))\nplt.bar(spend_per_purchase['Campaign Name'], spend_per_purchase['USD Spend per Purchase'], width = 0.4)\nplt.xlabel(\"Campaign Name\")\nplt.ylabel(\"Average USD Spend per Purchase\")\nplt.title(\"Average USD Spend per Purchase by Group\", fontdict = {'fontsize' : 20})\nplt.show()","a6b1a49d":"num_of_purchase = df.groupby(['Campaign Name'])['Number of Purchase'].sum().reset_index()\nnum_of_purchase","d855f2d9":"sns.set_theme(style=\"whitegrid\")\ng = sns.catplot(\n    data=df, kind=\"bar\",x=\"Campaign Name\",\n    y=\"Conversion Rate(%)\",\n    ci=\"sd\", palette=\"dark\", alpha=.6, height=6\n)\ng.despine(left=True)\ng.set_axis_labels(\"\", \"Conversion Rate(%)\")\nplt.title('Conversion Rate by Group', fontdict = {'fontsize' : 20})\nplt.show()","f6fe3225":"sns.set_theme(style=\"whitegrid\")\ng = sns.catplot(\n    data=df, kind=\"bar\",x=\"Campaign Name\",\n    y=\"CTR(%)\",\n    ci=\"sd\", palette=\"dark\", alpha=.6, height=6\n)\ng.despine(left=True)\ng.set_axis_labels(\"\", \"CTR(%)\")\nplt.title('CTR by Group', fontdict = {'fontsize' : 20})\nplt.show()","88a9b3a2":"sns.set_theme(style=\"whitegrid\")\ng = sns.catplot(\n    data=df, kind=\"bar\",x=\"Campaign Name\",\n    y=\"Number of Impressions\",\n    ci=\"sd\", palette=\"dark\", alpha=.6, height=6\n)\ng.despine(left=True)\ng.set_axis_labels(\"\", \"Number of Impressions\")\nplt.title('Number of Impressions by Group', fontdict = {'fontsize' : 20})\nplt.show()","7b907896":"sns.set_theme(style=\"whitegrid\")\ng = sns.catplot(\n    data=df, kind=\"bar\",x=\"Campaign Name\",\n    y=\"Reach\",\n    ci=\"sd\", palette=\"dark\", alpha=.6, height=6\n)\ng.despine(left=True)\ng.set_axis_labels(\"\", \"Number of Reach\")\nplt.title('Number of Reach by Group', fontdict = {'fontsize' : 20})\nplt.show()","b0ace61f":"df_2 = df.copy()\ndf_2 = df_2.drop(['index','Date'], axis=1)\ndf_2['Campaign Name'] = pd.get_dummies(df_2['Campaign Name'], drop_first=True)\ndf_2 = df_2.reset_index(drop=True)\ntest_g = df_2[df_2['Campaign Name']==1]\ncontrol_g = df_2[df_2['Campaign Name']==0]","cd8fa938":"test_group = test_g['Conversion Rate(%)']\ncontrol_group = control_g['Conversion Rate(%)']\ntest_group.describe()","bcc9f75c":"control_group.describe()","3ffc3545":"plt.figure(figsize=(20, 10))\nsns.kdeplot(control_group, label=\"Control\", shade = True, color = '#000000')\nsns.kdeplot(test_group, label=\"Test\", shade = True, color = '#B22222')\nplt.legend()","a71565bf":"sns.boxplot(df['Conversion Rate(%)'])","3c033e82":"print(np.where(df['Conversion Rate(%)']>25))","e2ef0692":"#remove the outliers\ndf_2 = df_2[df_2['Conversion Rate(%)']<25]\ntest_g = df_2[df_2['Campaign Name']==1]\ncontrol_g = df_2[df_2['Campaign Name']==0]\ntest_group = test_g['Conversion Rate(%)']\ncontrol_group = control_g['Conversion Rate(%)']","69c499b8":"#now plot the data distribution again\nplt.figure(figsize=(20, 10))\nsns.kdeplot(control_group, label=\"Control\", shade = True, color = '#000000')\nsns.kdeplot(test_group, label=\"Test\", shade = True, color = '#B22222')\nplt.legend()","2f18b085":"## H0: A = B  - Null Hypothesis\n## H1: A != B  - Alternative Hypothesis\n# set \u237a = 0.05\ntest = stats.ttest_ind(test_group,control_group, equal_var = True)\n\nprint(test)","a4b98165":"# Running T test\nAs the goal of this A\/B test is to figure out whether the new bidding type is bringing more conversions. Let's focus on the conversion rate.\n\n**Plot the Data Distribution**","13e7ba98":"Conclusion:\n    p value > 0.05, Null Hypothesis is accepted.\n    The new bidding type is not bringing higher conversion rate. ","68a186ae":"# Loading datasets","a0103bce":"# **Data Visualization**","c1d1a30f":"In the boxplot, we can see the values above 25 are acting as the outliers.","39e792b2":"Now the data distribution is close to normal, let's run the t test.","d0051ab7":"# Importing Labraries","bf1d4e8b":"Obervation: \n    The Control Group has more impressions and reaches, while the Test Group has a higher Click-Through Rate.","433f3f2c":"The data is not normally distributed. \nThe long tail implies that outliers exist.\nLet's detect and remove the outliers.","58a85f34":"# Data Cleaning","1acb921b":"Observation: \n    The number of purchases made by each group is considerably close; however, the test group has shown an uplift of more than 18% in the amount spent per purchase and therefore has a higher amount of total spend.","a1f6fea4":"**Background:** \n\nA company recently introduced a new bidding type, \u201caverage bidding\u201d, as an alternative to its exisiting bidding type, called \u201cmaximum bidding\u201d. One of our clients, \u2026.com, has decided to test this new feature and wants to conduct an A\/B test to understand if average bidding brings more conversions than maximum bidding.\n\nThe A\/B test has run for 1 month and \u2026.com now expects you to analyze and present the results of this A\/B test."}}