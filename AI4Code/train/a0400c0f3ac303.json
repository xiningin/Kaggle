{"cell_type":{"35679dfb":"code","f0108f63":"code","c5c66ead":"code","debcb0d1":"code","c67064f7":"code","ff7f8061":"code","db2ed432":"code","98de0be9":"code","4d9eab4a":"code","193748f8":"code","fe79ff72":"code","6202100b":"code","05521449":"code","e45159ed":"code","9f87b220":"code","2311f7f6":"code","b40dee5c":"code","502dce51":"code","76b556c3":"code","08b62b3d":"code","75b7ab6b":"code","8ad5855c":"code","e2f3ce07":"code","e0bdfebf":"code","08ac9630":"code","5161f115":"code","d2c28755":"code","9a46d64e":"code","2216a985":"code","0ec257c5":"code","d7e416b7":"code","7573489c":"code","98d9a625":"code","cdf237ae":"code","06d2ade9":"code","b938648f":"code","0d21fe8f":"markdown","75087314":"markdown","e803d624":"markdown","fdf8a331":"markdown","a4c154e1":"markdown","7f17258a":"markdown","3abd0736":"markdown","91e99c0c":"markdown","9bf4472d":"markdown","0f8a9048":"markdown","9d098140":"markdown","9271f04f":"markdown","df9c1b84":"markdown"},"source":{"35679dfb":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings(\"ignore\")","f0108f63":"df=pd.read_csv(\"\/kaggle\/input\/creditcardfraud\/creditcard.csv\")\ndf.head()","c5c66ead":"df.isna().sum()","debcb0d1":"df.duplicated().sum()","c67064f7":"df.drop_duplicates(keep=False,inplace=True)","ff7f8061":"x=df[\"Class\"].value_counts()\n\nfig,ax=plt.subplots(figsize=(10,6))\nax.barh([0],x.values[0],height = 0.7, color = 'black', alpha = 0.7)\nplt.text(-70000,0, '0 class', {'font': 'Serif','weight':'bold','Size': '16','style':'normal', 'color':'black'}, alpha = 0.7)\nplt.text(2,0, '99%',{'font':'Serif', 'weight':'bold','size':'16','color':'black'}, alpha = 0.7)\n\nax.barh([1],x.values[1],height = 0.7, color = '#b20710', alpha = 0.7)\nplt.text(-70000,1, '1 class', {'font': 'Serif','weight':'bold','Size': '16','style':'normal', 'color':'black'}, alpha = 0.7)\nplt.text(2,1, '1%',{'font':'Serif', 'weight':'bold','size':'16','color':'black'}, alpha = 0.7)\n\n\nfig.patch.set_facecolor('#f6f5f5')\nax.set_facecolor('#f6f5f5')\n\nplt.text(-1,1.7, 'How Output Class Is Distributed? ' ,{'font': 'Serif', 'Size': '25','weight':'bold', 'color':'black'}, alpha = 0.9)\n\nplt.text(-1,1.5, 'Looks like the data is highly imbalanced! \\n we need to do the under sampling or the over sampling to handle the imbalance in the data set!', \n        {'font':'Serif', 'size':'12.5','color': 'black'})\n\n\nax.axes.get_xaxis().set_visible(False)\nax.axes.get_yaxis().set_visible(False)\nax.spines['bottom'].set_visible(False)\nax.spines['left'].set_visible(True)\nax.spines['right'].set_visible(False)\nax.spines['top'].set_visible(False)\nfig.show()","db2ed432":"X=df.drop(\"Class\",axis=1)\ny=df[\"Class\"]","98de0be9":"from imblearn.combine import SMOTETomek\n","4d9eab4a":"smk = SMOTETomek(random_state=42)\nX,y=smk.fit_resample(X,y)","193748f8":"plt.figure(figsize=(10,6))\nax=y.value_counts().plot(kind=\"bar\")\nplt.show()","fe79ff72":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2,random_state=42)","6202100b":"import keras","05521449":"from keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import Dropout\n","e45159ed":"model=Sequential()","9f87b220":"# first layer \nmodel.add(Dense(units=20,kernel_initializer='he_normal',activation='relu',input_dim=30))","2311f7f6":"#2nd layer\nmodel.add(Dense(units=15,kernel_initializer='he_normal',activation='relu'))","b40dee5c":"#3rd layer\nmodel.add(Dense(units=1,kernel_initializer='he_normal',activation='sigmoid'))","502dce51":"# compiling!\nmodel.compile(optimizer='Adamax',loss='binary_crossentropy',metrics=['accuracy'])","76b556c3":"# Train the ANN\nhistory = model.fit(X_train, y_train, batch_size = 32, epochs = 20,validation_split=0.2)","08b62b3d":"\noutput=pd.DataFrame(history.history)\noutput","75b7ab6b":"import matplotlib.pyplot as plt\nfig,ax=plt.subplots(figsize=(10,6))\nfig.patch.set_facecolor('#f6f5f5')\nax.set_facecolor('#f6f5f5')\n\n\nplt.plot(output.loss,color=\"grey\")\nplt.plot(output.val_loss,color=\"#b20710\")\n\nax.text(1,42,\"Loss and Validation Loss\",{'font':'serif','size':20,'weight':'bold','color':'black'})\nax.text(10,38,'LOSS',{'font':'serif','size':20,'weight':'bold','color':'grey'})\nax.text(13,38,'|',{'font':'serif','size':20,'weight':'bold','color':'black'})\nax.text(14,38,'VAL-LOSS',{'font':'serif','size':20,'weight':'bold','color':'#b20710'})\n\n\n\nax.axes.get_xaxis().set_visible(False)\n#ax.axes.get_yaxis().set_visible(False)\nax.spines['bottom'].set_visible(False)\nax.spines['left'].set_visible(True)\nax.spines['right'].set_visible(False)\nax.spines['top'].set_visible(False)\n\n\nfig.show()\n","8ad5855c":"fig,ax=plt.subplots(figsize=(10,6))\nfig.patch.set_facecolor('#f6f5f5')\nax.set_facecolor('#f6f5f5')\n\n\nplt.plot(output.accuracy,color=\"grey\")\nplt.plot(output.val_accuracy,color=\"#b20710\")\n\nax.text(1,1.02,\"ACCURACY AND VALIDATION ACCURACY\",{'font':'serif','size':20,'weight':'bold','color':'black'})\nax.text(6,1,'ACCURACY',{'font':'serif','size':20,'weight':'bold','color':'grey'})\nax.text(12,1,'|',{'font':'serif','size':20,'weight':'bold','color':'black'})\nax.text(13,1,'VAL-ACCURACY',{'font':'serif','size':20,'weight':'bold','color':'#b20710'})\n\n\n\nax.axes.get_xaxis().set_visible(False)\n#ax.axes.get_yaxis().set_visible(False)\nax.spines['bottom'].set_visible(False)\nax.spines['left'].set_visible(True)\nax.spines['right'].set_visible(False)\nax.spines['top'].set_visible(False)\n\n\nfig.show()\n","e2f3ce07":"\n# Predicting the test set results\ny_pred = model.predict(X_test)\ny_pred = (y_pred > 0.5)","e0bdfebf":"from sklearn.metrics import classification_report\nfrom sklearn import metrics\nimport seaborn as sns","08ac9630":"sns.heatmap(metrics.confusion_matrix(y_test,y_pred),annot=True)","5161f115":"\nprint(classification_report(y_test, y_pred))","d2c28755":"from keras.wrappers.scikit_learn import KerasClassifier\nfrom sklearn.model_selection import GridSearchCV\n\n\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Activation, Embedding, Flatten, LeakyReLU, BatchNormalization, Dropout\nfrom keras.activations import relu, sigmoid\nfrom keras.layers import LeakyReLU\n\nfrom sklearn.preprocessing import StandardScaler","9a46d64e":"def create_model(layers, activation):\n    model = Sequential()\n    for i, nodes in enumerate(layers):\n        if i==0:\n            model.add(Dense(nodes,input_dim=X_train.shape[1]))\n            model.add(Activation(activation))\n        else:\n            model.add(Dense(nodes))\n            model.add(Activation(activation))\n    model.add(Dense(1)) # Note: no activation beyond this point\n    \n    model.compile(optimizer='adam', loss='binary_crossentropy',metrics=['accuracy'])\n    return model\n    \nmodel = KerasClassifier(build_fn=create_model, verbose=0)","2216a985":"model\n","0ec257c5":"layers = [[20], [40, 20], [45, 30, 15]]\nactivations = ['sigmoid', 'relu']\nparam_grid = dict(layers=layers, activation=activations, batch_size = [128, 256], epochs=[30])\ngrid = GridSearchCV(estimator=model, param_grid=param_grid)","d7e416b7":"grid_result = grid.fit(X_train, y_train)","7573489c":"[grid_result.best_score_,grid_result.best_params_]","98d9a625":"pred_y = grid.predict(X_test)\n\ny_pred = (pred_y > 0.5)\n\ny_pred","cdf237ae":"from sklearn.metrics import confusion_matrix\ncm = confusion_matrix(y_test, y_pred)","06d2ade9":"\nfrom sklearn.metrics import accuracy_score\nscore=accuracy_score(y_test,y_pred)","b938648f":"score","0d21fe8f":"<img src=\"https:\/\/images.unsplash.com\/photo-1556742031-c6961e8560b0?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=464&q=80\" width=\"900\" height=\"500\" align=\"centr\">","75087314":"<p style=\"font-family: Arials; font-size: 28px; text-align:center;font-style: bold; font-weight: bold; letter-spacing: 2px; color: grey; line-height:1.0\">HYPER PARA-METER TUNING!<\/p>","e803d624":"<p style=\"font-family: Arials; font-size: 28px; text-align:center;font-style: bold; font-weight: bold; letter-spacing: 2px; color: grey; line-height:1.0\">HANDLE IMBALANCING!.<\/p>","fdf8a331":"<p style=\"font-family: Arials; font-size: 20px; text-align:center;font-style: bold; font-weight: bold; letter-spacing: 2px; color: black; line-height:1.0\">There are no missing values present in the data set! Although there were some duplicate values. so i remove them.\n<\/p>","a4c154e1":"<p style=\"font-family: Arials; font-size: 20px; text-align:center;font-style: bold; font-weight: bold; letter-spacing: 2px; color: black; line-height:1.0\">As we can see we handle the imbalance of the data set. Both the classes have same ratio!. The technique that we used is Over-Sampling!\n<\/p>","7f17258a":"<p style=\"font-family: Arials; font-size: 28px; text-align:center;font-style: bold; font-weight: bold; letter-spacing: 2px; color: grey; line-height:1.0\">SOME ANALYSIS!.<\/p>","3abd0736":"<p style=\"font-family: Arials; font-size: 28px; text-align:center;font-style: bold; font-weight: bold; letter-spacing: 2px; color: grey; line-height:1.0\">IMPORT DATA SET!.<\/p>","91e99c0c":"<p style=\"font-family: Arials; font-size: 20px; text-align:center;font-style: bold; font-weight: bold; letter-spacing: 2px; color: black; line-height:1.0\">The model gives us the good accuracy but still let's do some hyper para meter tuning and see what we get!\n<\/p>","9bf4472d":"<p style=\"font-family: Arials; font-size: 28px; text-align:center;font-style: bold; font-weight: bold; letter-spacing: 2px; color: grey; line-height:1.0\">Let's lot the losses and accuracy!<\/p>","0f8a9048":"<p style=\"font-family: Arials; font-size: 28px; text-align:center;font-style: bold; font-weight: bold; letter-spacing: 2px; color: grey; line-height:1.0\">\ud83d\udd25Credit Card Fraud Detection Using ANN\ud83d\udd25\ud83d\udd25<\/p>","9d098140":"<p style=\"font-family: Arials; font-size: 18px; text-align:center;  letter-spacing: 2px; color: black; line-height:1.0\"> Credit card fraud is a form of identity theft in which criminals make purchases or obtain cash advances using a credit card account assigned to you. This can occur through one of your existing accounts, via theft of your physical credit card or your account numbers and PINs, or by means of new credit card accounts being opened in your name without your knowledge. Once they're in, thieves then run up charges and stick you and your credit card company with the bill.\n<br>\nCredit card issuers are acutely aware of this scourge, and are continually developing new methods to thwart unauthorized card usage. At the same time, however, resourceful fraudsters (including international organized crime syndicates) keep finding work-arounds for new security measures.\n<br>\nBecause card issuers are well-versed in dealing with card fraud, it's unlikely that being defrauded will cost you money out-of-pocket over the long haul, but necessary investigations can take months and, as discussed at greater length below, unaddressed credit card fraud can do major damage to your credit reports and scores. <\/p>","9271f04f":"<p style=\"font-family: Arials; font-size: 20px; text-align:center;font-style: bold; font-weight: bold; letter-spacing: 2px; color: #b20710; line-height:1.0\">Thanks for Reading the Notebook!\n    <br>\n    If you liked the notebook. Please do upvote!\ud83d\ude4c\n    <br>\n    Also any suggestions would be appriciated!\n<\/p>","df9c1b84":"<p style=\"font-family: Arials; font-size: 28px; text-align:center;font-style: bold; font-weight: bold; letter-spacing: 2px; color: grey; line-height:1.0\">IMPORT LIBRARIES.<\/p>"}}