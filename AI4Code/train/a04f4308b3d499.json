{"cell_type":{"67b9fa91":"code","ba35b84b":"code","ed9455d3":"code","6488f331":"code","65bf0866":"code","91aaf636":"code","fd8e14e8":"code","abc1b106":"code","cfd883e6":"code","836f5530":"code","0eca3f13":"code","02483c8b":"code","efa4919e":"code","5a847b0b":"code","062d62c4":"code","86a37e52":"code","58443a74":"code","aff5a466":"code","73b940ec":"code","7e2c0efe":"code","5c69c080":"code","a98614b0":"code","e9bf1efe":"code","b7e1b20f":"code","0d97e35a":"code","8e53aa56":"code","b25e0d33":"markdown","b421d811":"markdown","8b7fda5a":"markdown","958230e2":"markdown","c9c6c08d":"markdown","9ec3fb56":"markdown","fec66edb":"markdown","0999ef64":"markdown","ee282bfe":"markdown","898655cb":"markdown","8221fffe":"markdown","87366586":"markdown","afa80054":"markdown","78279f0d":"markdown","2ca720a0":"markdown"},"source":{"67b9fa91":"import numpy as np\nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy.stats import ttest_ind\nimport statsmodels.formula.api as smf","ba35b84b":"\ncar_df=pd.read_csv('..\/input\/auto-mpg.csv')\ncar_df.head()","ed9455d3":"car_df.shape","6488f331":"car_df.describe()","65bf0866":"car_df.info()","91aaf636":"car_df.horsepower.unique()","fd8e14e8":"car_df['horsepower']=car_df['horsepower'].replace('?',np.nan)","abc1b106":"# here the ? mark vales are replaced with the nan values so will check how many records got replaced\ncar_df['horsepower'].isnull().sum()","cfd883e6":"car_df['horsepower']=car_df['horsepower'].astype('float64')","836f5530":"car_df['horsepower'].dtype","0eca3f13":"# fill the nan values with median values\ncar_df['horsepower']=car_df['horsepower'].fillna(car_df['horsepower'].median())","02483c8b":"car_df['horsepower'].isnull().sum()","efa4919e":"corr_table=car_df.corr()\ncorr_table","5a847b0b":"plt.figure(figsize=(20,10))\ng=sns.heatmap(corr_table,annot=True)\ng.set(title='Correlation matrix of the car-mpg dataset')\nplt.show()          \n           ","062d62c4":"sns.pairplot(car_df,diag_kind='kde')\nplt.show()","86a37e52":"car_df['cylinders'].value_counts()","58443a74":"# for this we need to import statsmodels as shown below \nimport statsmodels.formula.api as smf","aff5a466":"test1=smf.ols('mpg~cylinders+displacement+horsepower+weight+acceleration+origin',car_df).fit()","73b940ec":"test1.summary()","7e2c0efe":"car_df=car_df.drop('acceleration',axis=1)\ncar_df.head()","5c69c080":"# i am removing the car name variable as i has nothing to to here\ncar_df=car_df.drop('car name',axis=1)\ncar_df.head()","a98614b0":"# importing the requried libaries for regression\n\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import KFold\nfrom sklearn import metrics\n","e9bf1efe":"y=car_df['mpg']\ny.head()","b7e1b20f":"x=car_df.iloc[:,1:]\nx.head()","0d97e35a":"kf=KFold(n_splits=5,shuffle=True,random_state=2)\nrmse=[]\nfor train,test in kf.split(x,y):\n    LR=LinearRegression()\n    #print(train)\n    xtrain=x.iloc[train]\n    xtest=x.iloc[test]\n    ytrain=y.iloc[train]\n    ytest=y.iloc[test]\n    LR.fit(xtrain,ytrain)\n    ypredict=LR.predict(xtest)\n    \n    rmse.append(np.sqrt(metrics.mean_squared_error(ytest,ypredict)))\n    \n    #r_value=LR.score(ytest,ypredict)\nprint('Rmse error in the first test is :%1.3f'%(rmse[0]))\nprint('Rmse error in the second test is:%1.3f'%(rmse[1]))\nprint('Rmse error in the third test is :%1.3f'%(rmse[2]))\nprint('Rmse error in the fourth test is:%1.3f'%(rmse[3]))\nprint('Rmse error in the fifth test is :%1.3f'%(rmse[4]))\n\nprint('Average mean rmse error i.e Bias error is: %1.3f'%(np.mean(rmse)))\n\nprint('Variance of rmse error i.e Variance error is: %1.3f'%(np.var(rmse,ddof=1)))\n\n#print('R2 value of the model is : %1.3f'%(r_value))\n    \n    \n    ","8e53aa56":"## predicting the mileage values for new values \n# cylinder=8,displacement=206,horsepower=200,weight=1900,modelyear=70,origin=2\nvalues=[[8,206,200,1900,70,2]]\nnew_mileage=LR.predict(values)\nprint('predicted new mileage for above values is %1.3f'%new_mileage)","b25e0d33":"## verifying the correlation of the variables above","b421d811":"### so now the hp variable got converted to integers and now we can proceed to check the correlation of the variables","8b7fda5a":"## Observation: In the horsepower values ? mark is included whichmakes the variable as object\n### need to replace the values and convert horsepower variable to integer","958230e2":"## This is my first machine learning study work \n## Any kind of advices and suggestion are appreciated.\n## Thanks in Advance","c9c6c08d":"## now i am spliting my dataframe into dependent and independent variable i.e x and y","9ec3fb56":"## Lets visualize the above values in the heat map","fec66edb":"## Inferences:\n \n ### Mpg column is having good corelation on cyl,disp,wt\n \n ### cyl ,disp and wt  and hp are having negative corelation \n \n ### next will check the data distribution using the pair plot","0999ef64":"# Next will be performing the statistical test to find the significance of variable so that we can reduce no.of variable ","ee282bfe":"## Observation:\n### Here the variable horsepower is not there though the horsepower variable is continious but still the describe is not showing values need to check whats wrong","898655cb":"## Inference as in the above summary the p value of the acc is greater than 0.05 so we can remove the acc variable from the dataset","8221fffe":"## Now we are good enough to train our regression model","87366586":"## Observation:\n### As you can see above the hp value are not integer values they are objects so need to check the values","afa80054":"#### 6 values got replaced as nan in horsepower variable\n\n### now need to convert the horsepower variable to interger and fill the nan values with median value of horsepower","78279f0d":"### here in the above columns most potential column that we need to predict is mpg(mileage)\n\n","2ca720a0":"## I am using here KFold method to train and test my model to get good metrices and performance"}}