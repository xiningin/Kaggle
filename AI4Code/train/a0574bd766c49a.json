{"cell_type":{"ea5dfa14":"code","c5b0c4e5":"code","58edf0b5":"code","85005fdc":"code","922040f0":"code","32304974":"code","0f47c0fc":"code","2e9bb24a":"code","74e86daa":"code","d4d9d6ea":"code","a0a9099f":"code","8f97469a":"code","f4e283a7":"code","353a60fe":"code","52c82bcb":"code","2bf52f1e":"code","837bfc6d":"code","3b4b02fd":"code","b9f8de44":"code","6eb455be":"code","538a22d1":"code","1ea3f3ed":"code","4cdd214f":"code","8c29618a":"code","606dc064":"code","4a2bb54a":"code","d66a16ee":"code","ecb30dee":"code","922c68fe":"markdown","2cd958f2":"markdown","5b4aebd2":"markdown","88ad5595":"markdown","3e5a0c3c":"markdown","effcdec4":"markdown","4b7b2153":"markdown","ecbbd2c7":"markdown","fb377ac2":"markdown","bd8086df":"markdown","c5839568":"markdown","3ecf516c":"markdown","9140760c":"markdown"},"source":{"ea5dfa14":"import numpy as np\nimport pandas as pd\n\nimport os\n\nos.listdir('..\/input')","c5b0c4e5":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","58edf0b5":"from fastai.imports import *\nfrom fastai.conv_learner import *\n\nfrom fastai.transforms import *\nfrom fastai.models import *\n\nfrom fastai.sgdr import *\nfrom fastai.plots import *\nfrom fastai.dataset import *\n\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split","85005fdc":"PATH = \"..\/input\"\nos.listdir(PATH)","922040f0":"train = pd.read_csv(f'{PATH}\/train.csv')\ntest = pd.read_csv(f'{PATH}\/test.csv')","32304974":"train[:5]\n\n#We need to seperate out the labels from the training set","0f47c0fc":"image = train.iloc[:,1:] # all rows from 1 column onwards\nlbl = train.iloc[:,0:1]","2e9bb24a":"img = image.as_matrix()\nimg = img.reshape(-1,28,28)\ntest_img = test.as_matrix()\ntest_img = test_img.reshape(-1,28,28)\n\nimg = np.stack((img,)*3, axis=-1).astype('float32')\ntest_img = np.stack((test_img,)*3, axis=-1).astype('float32')","74e86daa":"plt.imshow(img[4])","d4d9d6ea":"import warnings\nwarnings.filterwarnings('ignore')","a0a9099f":"train_img, val_img, train_lbl, val_lbl  = train_test_split(img, lbl, train_size=0.8, random_state=1)","8f97469a":"grp = [train_img, val_img, train_lbl, val_lbl, test_img]\nprint([e.shape for e in grp])\nprint([type(e) for e in grp])","f4e283a7":"train_lbl = train_lbl.values.flatten()\nval_lbl = val_lbl.values.flatten()","353a60fe":"arch= resnet34\nsz=28\ndata = ImageClassifierData.from_arrays(path='\/tmp', trn=(train_img\/255, train_lbl), val=(val_img\/255, val_lbl), classes=train_lbl,test=test_img\/255, tfms=tfms_from_model(arch, sz, max_zoom=1.1))","52c82bcb":"learn = ConvLearner.pretrained(arch, data, precompute=True)","2bf52f1e":"learn.lr_find()","837bfc6d":"learn.sched.plot_lr()","3b4b02fd":"learn.sched.plot()","b9f8de44":"learn = ConvLearner.pretrained(arch, data, precompute=True)","6eb455be":"learn.fit(0.01,9)","538a22d1":"%time log_pred_test, y_test=learn.TTA(is_test=True)\nprobs_test = np.mean(np.exp(log_pred_test),0)\nprobs_test.shape","1ea3f3ed":"df = pd.DataFrame(probs_test)","4cdd214f":"df.head()","8c29618a":"df = df.assign(Label=df.values.argmax(axis=1))\ndf = df.assign(ImageId=df.index.values +1)","606dc064":"df1=df[['ImageId', 'Label']]\n","4a2bb54a":"df1.head()","d66a16ee":"df1.shape","ecb30dee":"df1.to_csv('submission.csv', index=False)","922c68fe":"### The path","2cd958f2":"### Finding best learner rate","5b4aebd2":"### Seperating labels from training set\n\nfrom : https:\/\/www.geeksforgeeks.org\/python-extracting-rows-using-pandas-iloc\/\nPandas provide a unique method to retrieve rows from a Data frame. Dataframe.iloc[] method is used when the index label of a data frame is something other than numeric series of 0, 1, 2, 3\u2026.n or in case the user doesn\u2019t know the index label. FOr extracting multiple rows","88ad5595":"### getting data","3e5a0c3c":"### converting labels from dataframe into array","effcdec4":"### Splitting the training set into Train and Valid","4b7b2153":"### Imports","ecbbd2c7":"based on plot we will select 0.01 as the learning rate.","fb377ac2":"### Viewing as image  and loading to fast ai using image classification\n\nSince resnet has 3 channels we need to multiply teh np stack by 3","bd8086df":"### ConvLearner","c5839568":"### predicting in test data","3ecf516c":"### making a submission file","9140760c":"### training at optimum learning rate"}}