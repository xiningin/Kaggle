{"cell_type":{"35125705":"code","07c4bb7c":"code","cf913d18":"code","2fb12282":"code","154a3a06":"code","66164834":"code","36fe3b17":"code","e77edc24":"code","aeaf43d1":"code","e3f805ed":"code","9d788116":"code","d33df7a7":"markdown","438590d0":"markdown","d77d8c2b":"markdown","c681ecd9":"markdown","d0e966a0":"markdown","caf318b2":"markdown","06a82540":"markdown","d50a0196":"markdown","d4299510":"markdown"},"source":{"35125705":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport sqlite3\nimport matplotlib.pyplot as plt","07c4bb7c":"# Create a SQL connection to our SQLite database\ncon = sqlite3.connect('..\/input\/amazon-fine-food-reviews\/database.sqlite')","cf913d18":"type(con)","2fb12282":"pd.read_sql_query(\"SELECT * FROM Reviews\", con)","154a3a06":"most_review= pd.read_sql(\"\"\"SELECT ProductId, COUNT(Score) AS Number_of_Reviews, AVG(Score) AS Average_Review_Score\n                FROM Reviews\n                GROUP BY ProductId\n                ORDER BY COUNT(Score) DESC, AVG(Score) DESC\n                        \"\"\", con)\nmost_review","66164834":"y = most_review[\"Average_Review_Score\"]\nx = most_review['Number_of_Reviews']\n\nplt.axis([400, 600, 1, 5])\nplt.plot(x, y)\nplt.xlabel('Number_of_Reviews')\nplt.ylabel('Average_Review_Score')\nplt.title(label = \"Average_Score Vs Num_of_Reviews between 400 to 600\")","36fe3b17":"pd.read_sql(\"\"\"SELECT ProductId, COUNT(Score) AS Number_of_Reviews, AVG(Score) AS Average_Review_Score\n                FROM Reviews\n                GROUP BY ProductId\n                ORDER BY AVG(Score) DESC, COUNT(Score) DESC\n                LIMIT 30\n                        \"\"\", con)","e77edc24":"pd.read_sql(\"\"\"SELECT ProductId, HelpfulnessNumerator, Score, Summary\n                        FROM Reviews\n                        WHERE Score =5\n                        ORDER BY HelpfulnessNumerator DESC\n                        LIMIT 10\n                        \"\"\", con)","aeaf43d1":"pd.read_sql(\"\"\"SELECT ProductId, Score, Summary\n                        FROM Reviews\n                        WHERE Score =5 AND Id IN (SELECT Id FROM Reviews WHERE lower(Summary) LIKE '%dog food%')\n                        LIMIT 10\n                        \"\"\", con)","e3f805ed":"unsatisfied_customers = pd.read_sql(\"\"\"SELECT ProfileName, COUNT(Score) AS Number_of_Reviews, Score\n                        FROM Reviews\n                        WHERE Score = 1\n                        GROUP BY ProfileName\n                        ORDER BY COUNT(Score) DESC\n                        LIMIT 5\n                        \"\"\", con)\nunsatisfied_customers","9d788116":"x = unsatisfied_customers[\"ProfileName\"]\ny = unsatisfied_customers['Number_of_Reviews']\nfig = plt.figure()\nax = fig.add_axes([0,0,1,1])\ncustomer = [x[0],x[1],x[2],x[3],x[4]]\nreviews = [y[0],y[1],y[2],y[3],y[4]]\nax.set_title('Top 5 unsatisfied customer profile with average score of 1 Vs number of reviews given')\nax.set_xlabel(\"Customer Profile Names\")\nax.set_ylabel(\"Number of Review Score of 1 given\")\nax.bar(customer,reviews)\nplt.show()","d33df7a7":"#### We can see from below plot that there are some product with more than 500 reviews and still have good scores of 4.5 and above. These are the top selling products with satisfied customers.","438590d0":"#### Enquiring the top 10 review with score of 5 and HelpfulnessNumerator in descending order.","d77d8c2b":"#### Full table view of Amazon fine food reviews in the database.**","c681ecd9":"#### Enquiring the top 10 \"dog food\" review with Score of 5 in nested qurey.","d0e966a0":"#### Table of top 5 customers who are not happy with the products they purchased and have given scores of 1 and total number of review socres they have given. We can see which ProfileName has given the most review score of 1 and can further decide to contact them about their experience or investigate if they are simply the spam reviews. ","caf318b2":"#### We can see from below bar plot that Christopher hayes has given around 200 average review score of 1 which may be a spam review compared to other who have given total unhappy reviews around 40 to 70.","06a82540":"#### Table of top 30 productId with perfect review score of 5. We can see here that the number of reviews is only around 30 compared to the table above which has around 600 reviews.","d50a0196":"#### Table of top 30 ProductId with highest number of reviews. Then arranged by highest number of average review score. The reason why we need to include the highest number of reviews is that average review score of 5 with 1 review does not necessarily mean the it is the best selling product in the database. We can see that in next table.","d4299510":"### The aim of this Notebook is to explore Amazon find food review database using SQL and do exploratory data analysis in python. "}}