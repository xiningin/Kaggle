{"cell_type":{"8d28b498":"code","ea297b5f":"code","77be7c1f":"code","ead89060":"code","92b36007":"code","35c71dfb":"code","834a6f36":"code","28a50c17":"code","3601614e":"code","7822cbba":"code","07061bb7":"code","9f8d68b6":"code","1eeba1f2":"code","f3c82ba5":"code","2408571c":"code","27044b33":"code","f2c6d258":"code","8bac5788":"code","048f6a3b":"code","dc9980a1":"code","a725e38a":"code","577afbc1":"code","c08c1cc2":"code","62bd3fcc":"code","8b954a3a":"code","46ad8722":"code","0c4218d7":"code","1bc28b76":"code","2cdac625":"code","6655d0d5":"code","0a30920a":"code","d0916815":"code","4c1f89ac":"code","96cab059":"code","3ae1dbee":"code","4a303f4a":"code","1ce1d04d":"code","df24886d":"code","27a36c93":"code","39f75522":"code","9baa638d":"code","601862f2":"code","d738a763":"code","662b5a0d":"code","7c772c40":"code","fd3b59e0":"code","a20a5597":"code","4014b11a":"code","85304438":"code","471c265d":"code","e64f69ab":"code","bff04180":"code","35aa1747":"code","dd3d6d7c":"code","6377f965":"code","82fa5a94":"code","0135f8ef":"code","9329b9c4":"code","d2d30d48":"markdown","ad7c12bf":"markdown","6cc85939":"markdown","81956871":"markdown","ef1275f7":"markdown","5f21a28d":"markdown","5cdbfd24":"markdown","fefd2b17":"markdown","d73c9d7b":"markdown","9a7044f0":"markdown","551dd9e2":"markdown","4d60a318":"markdown","05358cde":"markdown","3030e9d5":"markdown","9c0e8432":"markdown","0021d648":"markdown","f8c0d6cb":"markdown"},"source":{"8d28b498":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom datetime import datetime\nfrom scipy import stats\nfrom scipy.stats import norm, skew, kurtosis\nfrom scipy.special import boxcox1p\nfrom scipy.stats import boxcox_normmax\nimport pylab as p\nimport warnings\nwarnings.filterwarnings('ignore')\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","ea297b5f":"train_data=pd.read_csv('\/kaggle\/input\/mobile-price-classification\/train.csv')\ntest_data=pd.read_csv('\/kaggle\/input\/mobile-price-classification\/test.csv')","77be7c1f":"test_data.head()","ead89060":"train_data.head()","92b36007":"test_data.columns","35c71dfb":"train_data.columns","834a6f36":"print('test_data : {}, train_data :{}'.format(test_data.shape, train_data.shape))","28a50c17":"test_data.info()","3601614e":"train_data.info()","7822cbba":"test_data.describe()","07061bb7":"train_data.describe()","9f8d68b6":"train_data['price_range'].value_counts()","1eeba1f2":"size = train_data['price_range'].value_counts()\nplt.figure(figsize=(8,6))\nplt.style.use('seaborn-paper')\nplt.pie(size, labels=[3,2,1,0],shadow=True, autopct='%1.1f%%', colors=['cyan','darkred', 'darkgreen', 'darkblue'])\nplt.title('A pie chart showing price range distributions among the data', fontsize=14, color='purple')\nplt.show()","f3c82ba5":"print('Kurtosis : {}'.format(kurtosis(train_data['price_range'])))\nprint('Skew : {}'.format(skew(train_data['price_range'])))","2408571c":"size = train_data['three_g'].value_counts()\nplt.figure(figsize=(8,6))\nplt.style.use('seaborn-paper')\nplt.pie(size, labels=[0,1],shadow=True, autopct='%1.1f%%', colors=['y', 'white'])\nplt.title('A pie chart showing three_g distributions among the data', fontsize=14, color='purple')\nplt.show()","27044b33":"size = train_data['four_g'].value_counts()\nplt.figure(figsize=(8,6))\nplt.style.use('seaborn-paper')\nplt.pie(size, labels=[0,1],shadow=True, autopct='%1.1f%%', colors=['cyan', 'green'])\nplt.title('A pie chart showing four_g distributions among the data', fontsize=14)\nplt.show()","f2c6d258":"plt.figure(figsize=(18,18))\ncorrelation = train_data.corr()\nsns.heatmap(correlation,square=True,annot=True,vmax=0.9, color='b')","8bac5788":"sns.catplot(x='price_range', y='ram', kind='swarm', data=train_data)","048f6a3b":"sns.catplot(x='price_range', y='ram', kind='box', data=train_data)","dc9980a1":"plt.figure(figsize=(10,8))\nsns.catplot(x='price_range', y='mobile_wt', kind='box', data=train_data)\nplt.title('Distributions between price_range with respect to mobile_wt', color='darkgreen', fontsize=13)","a725e38a":"plt.figure(figsize=(10,8))\nsns.catplot(x='price_range', y='px_height', kind='box', data=train_data)\nplt.title('Distributions between price_range with respect to px_height', color='darkgreen', fontsize=13)","577afbc1":"plt.figure(figsize=(10,8))\nsns.catplot(x='price_range', y='px_width', kind='box', data=train_data)\nplt.title('Distributions between price_range with respect to px_width', color='green', fontsize=13)","c08c1cc2":"plt.figure(figsize=(10,8))\nsns.catplot(x='price_range', y='battery_power', kind='box',hue='blue', data=train_data)\nplt.title('Distributions between price_range and bluetooth with respect to battery_power', color='darkred', fontsize=13)","62bd3fcc":"#Plotly to try and see some interactive graphs\nimport plotly.offline as pyo\nfrom plotly import __version__\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, iplot, plot\nimport cufflinks as cf\ncf.go_offline()\npyo.init_notebook_mode()\nprint(__version__)","8b954a3a":"train_data.iplot(kind='scatter', x='sc_w', y='sc_h', mode='markers', colors='black',size=10)","46ad8722":"train_data.iplot(kind='scatter', x='px_width', y='px_height', mode='markers', size=8)","0c4218d7":"train_data['fc'].iplot(kind='hist', bins=40, xTitle='Mega pixels', yTitle='Frequency', colors='cyan')\ntrain_data['pc'].iplot(kind='hist', bins=40, xTitle='Mega pixels',yTitle='Frequency', colors='darkred')","1bc28b76":"sns.pointplot(train_data['talk_time'], y=train_data['price_range'], data=train_data)\nplt.title('Point plot displaying how price ranges with talk_time', fontsize=13)","2cdac625":"test_data['px_area'] = test_data['px_height'] * test_data['px_width']\ntest_data['phone_area'] = test_data['sc_w'] * test_data['sc_h']\ntest_data.drop(['px_width', 'px_height', 'sc_w', 'sc_h', 'id'], axis=1, inplace=True)","6655d0d5":"train_data['px_area'] = train_data['px_height'] * train_data['px_width']\ntrain_data['phone_area'] = train_data['sc_w'] * train_data['sc_h']\ntrain_data.drop(['px_width', 'px_height', 'sc_w', 'sc_h'], axis=1, inplace=True)\ntrain_data","0a30920a":"from sklearn.model_selection import train_test_split\nX = train_data.drop('price_range', axis=1)\ny = train_data['price_range']","d0916815":"X_train, X_test, y_train, y_test = train_test_split(X,y, test_size=0.2, random_state=20)","4c1f89ac":"from sklearn.ensemble import RandomForestClassifier\nrnd = RandomForestClassifier(max_depth=8, n_estimators=700, random_state=0, n_jobs=-1)\nrnd.fit(X_train, y_train)","96cab059":"rnd.score(X_train, y_train)","3ae1dbee":"rnd.score(X_test, y_test)","4a303f4a":"from sklearn.linear_model import Lasso\nlasso = Lasso(alpha=0.001, max_iter=1000, random_state=20)\nlasso.fit(X_train, y_train)","1ce1d04d":"lasso.score(X_train, y_train)","df24886d":"lasso.score(X_test, y_test)","27a36c93":"from sklearn.linear_model import Ridge\nridge = Ridge(alpha=1, max_iter=1000, random_state=20)\nridge.fit(X_train, y_train)","39f75522":"ridge.score(X_train, y_train)","9baa638d":"ridge.score(X_test, y_test)","601862f2":"from sklearn.linear_model import LinearRegression\nlm = LinearRegression()\nlm.fit(X_train, y_train)","d738a763":"lm.score(X_train, y_train)","662b5a0d":"lm.score(X_test, y_test)","7c772c40":"from lightgbm import LGBMClassifier\nreg = LGBMClassifier(learning_rate=0.1, n_estimators=700,  max_depth=8, random_state=0, n_jobs=-1)\nreg.fit(X_train, y_train)","fd3b59e0":"reg.score(X_train, y_train)","a20a5597":"reg.score(X_test, y_test)","4014b11a":"from sklearn.linear_model import LogisticRegression\nmod = LogisticRegression(C=0.1, random_state=0, n_jobs=-1, max_iter=100)\nmod.fit(X_train, y_train)","85304438":"mod.score(X_train, y_train)","471c265d":"mod.score(X_test, y_test)","e64f69ab":"from sklearn.tree import DecisionTreeClassifier\ntrees = DecisionTreeClassifier(random_state=20, max_depth=5, criterion='entropy')\nmodel = trees.fit(X_train, y_train)\nmodel","bff04180":"trees.score(X_train, y_train)","35aa1747":"trees.score(X_test, y_test)","dd3d6d7c":"from sklearn.model_selection import GridSearchCV\nparams = {'max_depth':[5, 1], 'criterion':['entropy', 'gini'], 'random_state':[20,5]}\ngridz = GridSearchCV(DecisionTreeClassifier(), param_grid=params, refit=True,verbose=3)\ngridz.fit(X_train, y_train)","6377f965":"gridz.best_params_","82fa5a94":"gridz.best_estimator_","0135f8ef":"final_results = trees.predict(test_data)\nfinal_results","9329b9c4":"test_data = pd.read_csv('\/kaggle\/input\/mobile-price-classification\/test.csv')\ntest_data['id']\nfinal = pd.DataFrame({'id':test_data.id, 'price_range': final_results})\nfinal","d2d30d48":"From the above information we can tell that our price_range data follows a platykurtic type of kurtosis hence it has thin tails and a skewness of zero shows that our price_range follows a normal distribution","ad7c12bf":"\nGetting the dataset sizes","6cc85939":"Get more information about the datasets","81956871":"Looking carefully at the train and test datasets, i can see that the train data has a price_range column unlike the test data which instead has an id column","ef1275f7":"\n\nData descriptions","5f21a28d":"Much as the LGBMClassifier gives the perfect score for the train_data i think it over fits since the dataset is small plus i don't think it's best for my prediction since there's a slightly big deviation between the test score and train score as compared to other algorithms","5cdbfd24":"\n\n\n\n\nWell despite all the great scores from Lasso, Ridge and Linear Regression, we can't use either because our target variable is discrete and these are best suited for continous target variables i.e they will end up giving me predictions that are floats","fefd2b17":"id:Identification number\nbattery_power:Total energy a battery can store in one time measured in mAh\nblue:Has bluetooth or not\nclock_speed:speed at which microprocessor executes instructions\ndual_sim:Has dual sim support or not\nfc:Front Camera mega pixels\nfour_g:Has 4G or not\nint_memory:Internal Memory in Gigabytes\nm_dep:Mobile Depth in cm\nmobile_wt:Weight of mobile phone\nn_cores:Number of cores of processor\npc:Primary Camera mega pixels\npx_height:Pixel Resolution Height\npx_width:Pixel Resolution Width\nram:Random Access Memory in Megabytes\nsc_h:Screen Height of mobile in cm\nsc_w:Screen Width of mobile in cm\ntalk_time:longest time that a single battery charge will last when you are\nthree_g:Has 3G or not\ntouch_screen:Has touch screen or not\nwifi:Has wifi or not","d73c9d7b":"\n\nFrom the plot above we can see that there's a very high relationship between the price range and the ram in that as the ram increases, the price range also goes up.. meaning the ram is one of the very important faetures to look at while modeling to get the mobile price predictions","9a7044f0":"Load the train and test datasets and get their head()...","551dd9e2":"From the information above i can see that all the feaatures have numerical values i.e either floats or integers","4d60a318":"Heatmap above shows the relationship between different features in the data and as you can see the px_width & px_height and sc_w & sc_h are very highly related ...","05358cde":"From the above scatter maps we can see that we shall have to drop one of the features for our modeling since they are highly correlated hence making them very similar","3030e9d5":"Ridge gives very great scores of the test and train sets of the data so i believe its one of the models we should look at","9c0e8432":"Loading a few of the required libraries for our Exploratory Data Analysis","0021d648":"Using Lasso raises so many questions, as i raise the values of alpha to above 1, 10, 100, 1000 and so on, i tend to get very low scores tending to zero.. Let me try ridge and see how it scores here on our dataset","f8c0d6cb":"Ideally looking at our features, few features should be important which favours the use of Lasso Regression but looking at our  heatmap, not all features are as important so i guess we try using both Lasso and Ridge Regression to see our scores and see which model to use"}}