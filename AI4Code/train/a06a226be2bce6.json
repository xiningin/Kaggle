{"cell_type":{"46731b6c":"code","8c7185c9":"code","ca823758":"code","9461a43c":"code","ad315370":"code","741f1f7a":"code","201c901e":"markdown","caaf24e4":"markdown","5dd806d3":"markdown","0894403f":"markdown","54460542":"markdown","7425bc9f":"markdown"},"source":{"46731b6c":"import matplotlib.pyplot as plt\nimport tensorflow_hub as hub\nimport tensorflow as tf\nimport numpy as np\nimport cv2\n\ncontent_filename = '\/kaggle\/input\/images\/elgrito.jpg'\nstyle_filename = '\/kaggle\/input\/images\/kandinsky.jpg'\n\nmodel = hub.load('https:\/\/tfhub.dev\/google\/magenta\/arbitrary-image-stylization-v1-256\/2')\n\nprint(\"Ready\")","8c7185c9":"def load_image(img_path):\n    # Load image file and return tf image\n\timg = tf.io.read_file(img_path)\n\timg = tf.image.decode_image(img, channels = 3)\n\timg = tf.image.convert_image_dtype(img, tf.float32)\n\timg = img[tf.newaxis, :]\n\treturn img","ca823758":"content_image = load_image(content_filename)\nstyle_image = load_image(style_filename)","9461a43c":"stylized_image = model(tf.constant(content_image), tf.constant(style_image))[0]","ad315370":"plt.imshow(np.squeeze(stylized_image))\nplt.show()","741f1f7a":"cv2.imwrite('generated.jpg', cv2.cvtColor(np.squeeze(stylized_image)*255, cv2.COLOR_BGR2RGB))","201c901e":"### A few adjustments are required for the loaded images to be read by the model","caaf24e4":"### If you are satisfied with the results, save the generated art","5dd806d3":"### Proceed to load the content and style pictures","0894403f":"### Pass the images to the model","54460542":"### Show the results","7425bc9f":"## Test for the image style transfer by Ghiasi et al."}}