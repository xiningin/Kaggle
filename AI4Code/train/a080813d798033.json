{"cell_type":{"eb968f82":"code","8ef81e71":"code","e14400c1":"code","bdd95c05":"code","2a6c5c30":"code","9df630ed":"code","58455ed6":"code","251e70e4":"code","dfb3b580":"code","2f39feef":"code","4fbe852b":"code","068ca60e":"code","c1bd088b":"markdown","382846b5":"markdown","ef226c31":"markdown","8889cdb2":"markdown","afebc75f":"markdown","1ab23383":"markdown"},"source":{"eb968f82":"import bq_helper\nfrom bq_helper import BigQueryHelper\n# https:\/\/www.kaggle.com\/sohier\/introduction-to-the-bq-helper-package\nwbed = bq_helper.BigQueryHelper(active_project=\"bigquery-public-data\",\n                                   dataset_name=\"world_bank_intl_education\")\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","8ef81e71":"bq_assistant = BigQueryHelper(\"bigquery-public-data\", \"world_bank_intl_education\")\nbq_assistant.list_tables()","e14400c1":"bq_assistant.head(\"series_summary\", num_rows=10)","bdd95c05":"bq_assistant.table_schema(\"international_education\")","2a6c5c30":"query1 = \"\"\"\nSELECT\n  country_name,\n  AVG(value) AS average\nFROM\n  `bigquery-public-data.world_bank_intl_education.international_education`\nWHERE\n  indicator_code = \"SE.XPD.TOTL.GB.ZS\"\n  AND year > 2000\nGROUP BY\n  country_name\nORDER BY\n  average DESC\n;\n        \"\"\"\nresponse1 = wbed.query_to_pandas_safe(query1)\nresponse1.head(50)\n","9df630ed":"response1.plot.hist()","58455ed6":"le = response1[response1['average']<10]\nle\n\nme = response1[response1['average']>20]\nme","251e70e4":"query2 = \"\"\"\nSELECT\n  series_code,\n  indicator_name\nFROM\n  `bigquery-public-data.world_bank_intl_education.series_summary`\nWHERE\n  indicator_name like \"%education%\"\n ;\n        \"\"\"\nresponse2 = query_job.result()\nprint(response2)","dfb3b580":"bq_assistant.table_schema(\"country_summary\")\nquery3 = \"\"\"\nSELECT * from \n  `bigquery-public-data.world_bank_intl_education.country_summary`\nWHERE\n  short_name = \"India\"\n ;\n        \"\"\"\ndf = wbed.query_to_pandas_safe(query3)\nprint('Size of dataframe: {} Bytes'.format(int(df.memory_usage(index=True, deep=True).sum())))","2f39feef":"df.head(5)","4fbe852b":"bq_assistant.table_schema(\"international_education\")\n\nquery4 = \"\"\"\n SELECT indicator_name, value,year from \n   `bigquery-public-data.world_bank_intl_education.international_education`\n WHERE\n   country_name = \"India\"\n  ;\n         \"\"\"\ndf2 = wbed.query_to_pandas_safe(query4)","068ca60e":"df2","c1bd088b":"Of total government spending, what percentage is spent on education?\n","382846b5":"Which countries spend less than 10% on education and which spend more than 20% ? In other words, who are the outliers?\n","ef226c31":"What is the distribution of government spend on education?","8889cdb2":"**How to Query the World Bank: Education Data (BigQuery Dataset)**","afebc75f":"What is the indicator code for education?","1ab23383":"Thats a lot! Let' start exploring the country summary data for India\n"}}