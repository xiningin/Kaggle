{"cell_type":{"8beafcbd":"code","33bc476c":"code","a7c6c6d9":"code","8c139f79":"code","59904cd4":"code","cd563746":"code","4a98f1be":"code","9ef9fbe2":"code","be04f648":"code","118a45f5":"code","3370882e":"code","14a861a7":"code","8cedf923":"code","23cc4fcd":"code","6e9044f0":"code","5caf963b":"code","8b259cbc":"code","c7b5d286":"markdown","dffdb5f7":"markdown","5b9eb1a1":"markdown","5c20102c":"markdown","3314b6d3":"markdown","be3df37d":"markdown","23993d47":"markdown","bb71db6d":"markdown","aab79978":"markdown","2f62e1d6":"markdown","b26353c4":"markdown","298d0377":"markdown","87ee053e":"markdown","24ef224f":"markdown","e0ba5f2f":"markdown","0c381e07":"markdown"},"source":{"8beafcbd":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport xgboost as xgb\nfrom xgboost import XGBClassifier\n\n# import os\n# for dirname, _, filenames in os.walk('\/kaggle\/input'):\n#     for filename in filenames:\n#         print(os.path.join(dirname, filename))\n\n        \nfrom IPython.core.interactiveshell import InteractiveShell\nInteractiveShell.ast_node_interactivity = \"all\"\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\n\nfrom sklearn.metrics import accuracy_score\n","33bc476c":"df = pd.read_csv(\"\/kaggle\/input\/ultimate-ufc-dataset\/ufc-master.csv\")  # The train dataset \ndf_pred = pd.read_csv(\"\/kaggle\/input\/ultimate-ufc-dataset\/upcoming-event.csv\") # The pred dataset ","a7c6c6d9":"df['train_data'] = 1 \ndf_pred['train_data'] = 0 \ndf = pd.concat([df,df_pred])","8c139f79":"df.sample(5)","59904cd4":"def get_winner(color) : return 1 if color =='Red' else 0","cd563746":"df['won'] = df.Winner.apply(lambda x: get_winner(x))","4a98f1be":"#Feature selection\nfeatures = ['R_odds','B_odds','R_ev','B_ev','title_bout','weight_class','no_of_rounds',\\\n           'B_current_lose_streak','B_current_win_streak',\\\n            'B_wins','B_losses',\\\n            'B_age','B_Stance','B_Height_cms','B_Reach_cms','B_Weight_lbs',\\\n\n            'R_wins','R_losses',\\\n            'R_current_lose_streak','R_current_win_streak',\\\n           'R_age','R_Stance','R_Height_cms','R_Reach_cms','R_Weight_lbs'\n           ]\n\nselected_columns = features + [\"train_data\" , \"won\"]","9ef9fbe2":"df=pd.get_dummies(df[selected_columns])","be04f648":"X = df[df['train_data'] == 1]\ny = df['won'][df['train_data'] == 1]\n\nX_pred = df[df['train_data'] == 0 ]","118a45f5":"X = X.drop(['train_data','won'],axis = 1 )\nX_pred = X_pred.drop(['train_data','won'],axis = 1 )","3370882e":"from sklearn.model_selection import GridSearchCV  \nparam_list = {\n 'max_depth':range(1,6),\n 'min_child_weight':range(1,2),\n 'n_estimators': range(10,100,40)\n}\ngsearch1 = GridSearchCV(estimator = XGBClassifier( learning_rate =0.001, max_depth=5,\\\n                                                  min_child_weight=1, gamma=0, subsample=0.8, colsample_bytree=0.8,\\\n                                                  objective= 'binary:logistic', nthread=4, scale_pos_weight=1, seed=27),\\\n                                    param_grid = param_list, scoring='roc_auc',n_jobs=4,iid=False, cv=5)\ngsearch1 = gsearch1.fit(X,y)\n","14a861a7":"from sklearn.model_selection import GridSearchCV  \nparam_test1 = {\n 'max_depth':range(1,6),\n 'min_child_weight':range(1,2),\n 'n_estimators': range(10,100,40)\n}\ngsearch1 = GridSearchCV(estimator = XGBClassifier( learning_rate =0.001, max_depth=5,\\\n                                                  min_child_weight=1, gamma=0, subsample=0.8, colsample_bytree=0.8,\\\n                                                  objective= 'binary:logistic', nthread=4, scale_pos_weight=1, seed=27),\\\n                                    param_grid = param_test1, scoring='accuracy',n_jobs=4,iid=False, cv=5)\ngsearch1 = gsearch1.fit(X,y)","8cedf923":"print(f\"Best score = {gsearch1.best_score_}\")\nprint(f\"Best parameters = {gsearch1.best_params_ }\")","23cc4fcd":"final_xgb_model = XGBClassifier(learning_rate =0.001, max_depth=5,min_child_weight=1, gamma=0, subsample=0.8,\\\n                                colsample_bytree=0.8,objective= 'binary:logistic', nthread=4, scale_pos_weight=1, seed=27 )\nfinal_xgb_model= final_xgb_model.set_params(**gsearch1.best_params_)\nfinal_xgb_model.fit(X ,y)","6e9044f0":"import matplotlib.pyplot as plt \nfrom xgboost import plot_importance\nplot_importance(final_xgb_model)\nplt.show();","5caf963b":"final_prediction_proba =  pd.DataFrame(final_xgb_model.predict_proba(X_pred))\nfinal_prediction_proba.columns = ['pred_0','pred_1']\n\npredict_proba = pd.DataFrame({\"R_fighter\": df_pred['R_fighter'].values,\"B_fighter\":  df_pred['B_fighter'].values, \"R_prob\": final_prediction_proba['pred_1'].values,\"B_prob\": final_prediction_proba['pred_0'].values})\npredict_proba.head(10)\n#predict_proba.to_csv('predict_probab.csv',index=False)","8b259cbc":"final_prediction_abs =  pd.DataFrame({\"pred\":final_xgb_model.predict(X_pred)})\n\npredict_absolute = pd.DataFrame({\"R_fighter\": df_pred['R_fighter'].values,\"B_fighter\":  df_pred['B_fighter'].values, \"R_prob\": final_prediction_abs['pred'].values,\"B_prob\": 1-final_prediction_abs['pred'].values})\npredict_absolute.head(5)\npredict_absolute.to_csv('predict_absolute.csv',index=False)","c7b5d286":"### 1.Read the input files ","dffdb5f7":"### 4.Separate into X ( independent var - dataset )  and y ( dependent var ) datasets\n> Split the dataset back to train and pred datasets.","5b9eb1a1":"#### Assign a column to show which records belong to the pred dataset \/ train dataset","5c20102c":"### Final model","3314b6d3":"> Drop the y-var column from test set","be3df37d":"### Objective : Predict if Fighter_Red won or not.","23993d47":"### Create a feature importance graph to find which are the most important features ","bb71db6d":"### Import all the libraries and Estimators ","aab79978":"### 3. Dummify the categorical columns ","2f62e1d6":"Display the best estimator hyper-parameters & the best score ( from the result of various parameters in Grid Search ) ","b26353c4":"### 2.Select the features to be used for the model\n>  You can use your own features or select the ones from the original dataset","298d0377":"### 5.Do a Grid search with Cross-validation (5 fold)\n> This might take a long time based on the number of folds , parameters you chose and the CPU you have","87ee053e":"> This will create another column with 1 or 0 ","24ef224f":"### Function to create a column which will write the outcome as 1 \/ 0 \n","e0ba5f2f":"### Create the prediction - files Probability Prediction\n> If you want to create a probability of predictions ","0c381e07":"### Create the prediction files  - Absolute predictions "}}