{"cell_type":{"49a029c2":"code","14fe189b":"code","3b02a13f":"code","e8d2d30a":"code","b1525010":"code","4a7de639":"code","34888ecb":"code","428f78c6":"code","f46f5c0a":"code","e53c00ac":"code","527efc84":"code","c0464ee6":"code","84ecab20":"code","e9e9ff76":"code","c721460b":"markdown","66de9f95":"markdown","cb784baa":"markdown","936ac227":"markdown","8407239c":"markdown","3517e0bd":"markdown","1e1706bb":"markdown","f4001c94":"markdown","d05ca8a5":"markdown","42ed33fc":"markdown","8aabdf79":"markdown","4201fa0e":"markdown","29ffe92d":"markdown"},"source":{"49a029c2":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","14fe189b":"import pandas as pd","3b02a13f":"data_df = pd.read_csv(\"\/kaggle\/input\/research-development-personnel-in-europe\/rd_p_persocc.tsv\", sep='\\t')","e8d2d30a":"print(list(data_df.columns))","b1525010":"data_df.head()","4a7de639":"data_df.tail()","34888ecb":"pivot_data_col = data_df.columns[0]\nyear_columns = data_df.columns[1:]","428f78c6":"data_df['sectperf'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[0])\ndata_df['prof_pos'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[1])\ndata_df['sex'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[2])\ndata_df['unit'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[3])\ndata_df['geo']     = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[4])","f46f5c0a":"selected_columns = list(['sectperf', 'prof_pos', 'sex', 'unit', 'geo']) +  list(year_columns)\ndata_df = data_df[selected_columns]","e53c00ac":"data_tr_df = data_df.melt(id_vars=['sectperf', 'prof_pos', 'sex', 'unit', 'geo'], \n        var_name=\"year\", \n        value_name=\"value\")\ndata_tr_df['geo'] = data_tr_df['geo'].apply(lambda x: str(x))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"e\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"b\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"u\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"c\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"d\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"p\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\": \", \"NAN\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: float(x))","527efc84":"print(f\"Transformed data shape: {data_tr_df.shape} (rows\/columns)\")\ndata_tr_df.head()","c0464ee6":"data_tr_df.tail()","84ecab20":"import pandas_profiling\npandas_profiling.ProfileReport(data_tr_df)","e9e9ff76":"data_tr_df.to_csv(\"research_and_development_personnel.csv\", index=False)","c721460b":"Then, we split from `pivot_data_col` the 5 separate fields:\n* sectperf;\n* prof_pos;   \n* sex;    \n* unit;\n* geo - geography - mainly countries but also aggregated countries in EU;","66de9f95":"# A very preliminary exploratory data analysis\n\nThis would be a very short exploratory data analysis. The role of this Kernel is just to show how we can prepare the annual data for analysis and we already did this.","cb784baa":"# Data pre-processing\n\nWe start by defining two working lists.","936ac227":"We select now only the new columns resulted from splitting the `pivot_data_col` and the time columns.","8407239c":"Next, we pivot the time columns using `melt` operation in pandas.  \nWe also make sure we transform `date` to be an integer (here is a year data).  \nWe set `value` to be a float, after we replace \": \" (for N\/A) with `NAN`.","3517e0bd":"# Export data in csv format","1e1706bb":"# Analysis preparation\n\n## Load packages","f4001c94":"Let's also take a look to few of the rows.","d05ca8a5":"Let's inspect the result.","42ed33fc":"The first column is a composed one, containing 5 different information (sect_perf, prof_pos, sex, unit, geography). The next columns are temporal values, the years value.","8aabdf79":"# Introduction\n\nWe show in this Kernel how we can process the data to prepare it for easier processing. Let's check the data files.","4201fa0e":"## Load the data\n\nThe datafiles are in TSV format. We will read the files using pandas, just include in the function call the `sep` (tab separator data).\nWe demonstrate first how to read and process the Annual data.","29ffe92d":"Let's glimpse the data columns."}}