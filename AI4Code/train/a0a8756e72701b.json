{"cell_type":{"2689c9c9":"code","0605a492":"code","aa87b9b3":"code","a319f0a5":"code","81b712c4":"code","753644e2":"code","117ea79e":"code","c757f620":"code","20507f57":"code","f95bb057":"code","c033508f":"code","23df00b8":"code","a274790f":"code","049625ac":"code","a90700a6":"code","e007d38b":"code","e41b7ee2":"code","8df63beb":"code","cc1cdf6d":"code","1d7c3d4c":"code","087a3dab":"code","71535352":"markdown","149447f2":"markdown","310cd88e":"markdown","eb6f20ba":"markdown","401190b2":"markdown","ff85259e":"markdown","395ac970":"markdown","6e923b4c":"markdown"},"source":{"2689c9c9":"from keras.layers import Input,Lambda,Dense,Flatten,Conv2D,MaxPooling2D\nfrom keras.models import Model,Sequential\nfrom keras.applications.vgg16 import VGG16\nfrom keras.applications.vgg16 import preprocess_input\nfrom keras.preprocessing import image\nfrom keras.preprocessing.image import ImageDataGenerator\nimport numpy as np\nfrom glob import glob\nimport matplotlib.pyplot as plt","0605a492":"image_size=[224,224]\ntrain_path='..\/input\/labeled-chest-xray-images\/chest_xray\/train'\ntest_path='..\/input\/labeled-chest-xray-images\/chest_xray\/test'","aa87b9b3":"train_datagen=ImageDataGenerator(rescale=1.\/255,shear_range=0.2,zoom_range=0.2,horizontal_flip=True)\ntest_datagen=ImageDataGenerator(rescale=1.\/255)","a319f0a5":"train_data=train_datagen.flow_from_directory(train_path,target_size=(224,224),batch_size=32,class_mode='categorical')","81b712c4":"test_data=test_datagen.flow_from_directory(test_path,target_size=(224,224),batch_size=32,class_mode='categorical')","753644e2":"cnnmodel=Sequential()\ncnnmodel.add(Conv2D(64,(3,3),activation='relu',input_shape=(224,224,3)))\ncnnmodel.add(MaxPooling2D((2,2)))\ncnnmodel.add(Conv2D(64,(3,3),activation='relu'))\ncnnmodel.add(MaxPooling2D((2,2)))\ncnnmodel.add(Flatten())\ncnnmodel.add(Dense(32,activation='relu'))\ncnnmodel.add(Dense(2,activation='softmax'))","117ea79e":"cnnmodel.compile(optimizer='adam',loss='categorical_crossentropy',metrics=['accuracy'])","c757f620":"res_cnnmodel=cnnmodel.fit(train_data,validation_data=test_data,epochs=25)","20507f57":"# visualization of loss\nplt.plot(res_cnnmodel.history['loss'],label='train loss')\nplt.plot(res_cnnmodel.history['val_loss'],label='val loss')\nplt.legend()\nplt.show()","f95bb057":"pred_cnn=cnnmodel.predict(test_data)\npred_cnn=pred_cnn.argmax(axis=1)\npred_cnn","c033508f":"# VGG16 model\nvgg=VGG16(input_shape=image_size+[3],weights='imagenet',include_top=False)","23df00b8":"# As all the layers are trained already\nfor layer in vgg.layers:\n    layer.trainable=False","a274790f":"folders=glob('..\/input\/labeled-chest-xray-images\/chest_xray\/train\/*') # to get the number of output classes","049625ac":"x=Flatten()(vgg.output)\nprediction=Dense(len(folders),activation='softmax')(x)\nmodel=Model(inputs=vgg.input,outputs=prediction)","a90700a6":"model.summary()","e007d38b":"model.compile(loss='categorical_crossentropy',optimizer='adam',metrics='accuracy')","e41b7ee2":"r=model.fit(train_data,validation_data=test_data,epochs=10)","8df63beb":"# visualization of loss\nplt.plot(r.history['loss'],label='train loss')\nplt.plot(r.history['val_loss'],label='val loss')\nplt.legend()\nplt.show()","cc1cdf6d":"# prediction\npred_vgg=model.predict(test_data)\npred_vgg=pred_vgg.argmax(axis=1)\npred_vgg","1d7c3d4c":"train_accuracy=cnnmodel.evaluate(train_data)[1]\ntest_accuracy=cnnmodel.evaluate(test_data)[1]\nprint('Accuracy of CNN')\nprint('Train Accuracy: ',train_accuracy,'\\nTest Accuracy: ',test_accuracy)","087a3dab":"train_accuracy1=model.evaluate(train_data)[1]\ntest_accuracy1=model.evaluate(test_data)[1]\nprint('Accuracy of VGG16')\nprint('Train Accuracy: ',train_accuracy1,'\\nTest Accuracy: ',test_accuracy1)","71535352":"## **3.2 VGG16(Transfer Learning)**","149447f2":"## **3.1 CNN**","310cd88e":"## **1. Import Libraries**","eb6f20ba":"## **4. Evaluation**","401190b2":"# **THANK YOU**","ff85259e":"# **3.Models**","395ac970":"# **Pneumonia detection using VGG16(Deep Learning)**","6e923b4c":"## **2.Pre-Processing**"}}