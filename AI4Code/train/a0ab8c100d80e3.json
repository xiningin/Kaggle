{"cell_type":{"74ee8676":"code","14705349":"code","1ac072f8":"code","dbc677f9":"code","6aeaf8d8":"code","aa0e2f54":"code","d137260b":"code","70b2efb7":"code","7b3c663f":"code","28ac75fc":"code","3925b8ce":"code","1468fb10":"code","9d04b05b":"code","25979594":"code","2e7e3ef0":"code","395f7bbd":"code","23f3fd42":"code","50509230":"code","128baca2":"code","71b3534e":"code","7e70dc3e":"markdown","ef76cc77":"markdown","db7d24bc":"markdown","456bce38":"markdown","98071f7b":"markdown","7475f81b":"markdown","a44ae7e9":"markdown","14ae5347":"markdown","6bd4c84e":"markdown","7a03d7eb":"markdown","a176dd8a":"markdown","a5a9adf4":"markdown","33c60e02":"markdown","bcac5431":"markdown","563491db":"markdown","2a7e1870":"markdown","27f35d1f":"markdown","5410541f":"markdown","b2904107":"markdown","f5f61deb":"markdown","91480c97":"markdown","143a1d1a":"markdown","9a8d6ac0":"markdown"},"source":{"74ee8676":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\nimport matplotlib.pyplot as plt        \nimport seaborn as sns\nimport missingno\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","14705349":"# Parette Color Set\n\nNY_GIANTS_Color = [\"#0B2265\", \"#A71930\", \"#A5ACAF\"]\nNY_GIANTS = {0 : NY_GIANTS_Color[0], 1 : NY_GIANTS_Color[1], \n             \"Not Drinkable\" : NY_GIANTS_Color[0], \"Drinkable\" : NY_GIANTS_Color[1]}\n\n# Loading Data\ndf = pd.read_csv('\/kaggle\/input\/water-potability\/water_potability.csv')\n\n# Missing Value Check Visulization\nmissingno.matrix(df, color =(0.04, 0.13, 0.40))","1ac072f8":"# For understand easier\ndf.loc[df[\"Potability\"] == 1, \"Drink\"] = \"Drinkable\"\ndf.loc[df[\"Potability\"] == 0, \"Drink\"] = \"Not Drinkable\"","dbc677f9":"sns.countplot(x='Drink', data=df, palette=NY_GIANTS)","6aeaf8d8":"no_drink = df['Potability'][df.Potability == 0].count()\nok_drink = df['Potability'][df.Potability == 1].count()\n\nno_drink_percent = no_drink\/(ok_drink+no_drink)\n\nprint (\"Percentage of Not Drinkable Percentage: {:.4%}%\".format(no_drink_percent))","aa0e2f54":"# Null Check\ndf_null = df\ndf_null['Has_null'] = df_null.isnull().any(axis=1)\ndf_null\n\nsns.countplot(x=\"Has_null\", hue=\"Drink\", data=df_null, palette=NY_GIANTS)","d137260b":"no_null_ok_drink = df_null['Potability'][(df_null.Has_null == False) & (df.Potability == 1)].count()\nno_null_no_drink = df_null['Potability'][(df_null.Has_null == False) & (df.Potability == 0)].count()\n\nhas_null_ok_drink = df_null['Potability'][(df_null.Has_null == True) & (df.Potability == 1)].count()\nhas_null_no_drink = df_null['Potability'][(df_null.Has_null == True) & (df.Potability == 0)].count()\n\nno_null_percent = no_null_no_drink\/(no_null_no_drink+no_null_ok_drink)\nhas_null_percent = has_null_no_drink\/(has_null_no_drink+has_null_ok_drink)\n\nprint (\"No Null index - Percentage of Potability: {:.4%}%\".format(no_null_percent))\nprint (\"Has Null index - Percentage of Potability: {:.4%}%\".format(has_null_percent))","70b2efb7":"df = df.drop('Has_null', axis=1)\ndf = df.fillna(df.mean())\nmissingno.matrix(df, color =(0.04, 0.13, 0.40))","7b3c663f":"sns.pairplot(df, hue='Drink', palette=NY_GIANTS)","28ac75fc":"sns.set_theme(style=\"white\")\n\n# Compute the correlation matrix\ncorr = df.corr()\n\n# Generate a mask for the upper triangle\nmask = np.triu(np.ones_like(corr, dtype=bool))\n\n# Set up the matplotlib figure\nf, ax = plt.subplots(figsize=(15, 15))\n\n# Generate a custom diverging colormap\ncmap = sns.diverging_palette(10, 240, n=8)\n\n# Draw the heatmap with the mask and correct aspect ratio\nsns.heatmap(corr, mask=mask, cmap=cmap, center=0,vmax=0.2, vmin=-0.2,\n            annot=True, square=True, linewidths=0.5, cbar_kws={\"shrink\": .5})","3925b8ce":"fig = plt.figure(figsize=(15,20))\n\nfig=plt.subplot(3,3,1)\nsns.histplot(df, x=df.columns[0], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,2)\nsns.histplot(df, x=df.columns[1], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,3)\nsns.histplot(df, x=df.columns[2], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,4)\nsns.histplot(df, x=df.columns[3], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,5)\nsns.histplot(df, x=df.columns[4], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,6)\nsns.histplot(df, x=df.columns[5], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,7)\nsns.histplot(df, x=df.columns[6], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,8)\nsns.histplot(df, x=df.columns[7], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,9)\nsns.histplot(df, x=df.columns[8], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)","1468fb10":"df_ss = df\ndf_ss = df_ss.drop('Potability', axis=1)\ndf_ss = df_ss.drop('Drink', axis=1)\ndf_ss = (df_ss - df_ss.mean()) \/ df_ss.std()\ndf_ss = df_ss.abs()\ndf_ss['Drink'] = df['Drink']\n\nsns.pairplot(df_ss, hue='Drink', palette=NY_GIANTS)","9d04b05b":"sns.set_theme(style=\"white\")\n\n# Compute the correlation matrix\ncorr = df_ss.corr()\n\n# Generate a mask for the upper triangle\nmask = np.triu(np.ones_like(corr, dtype=bool))\n\n# Set up the matplotlib figure\nf, ax = plt.subplots(figsize=(15, 15))\n\n# Generate a custom diverging colormap\ncmap = sns.diverging_palette(10, 240, n=8)\n\n# Draw the heatmap with the mask and correct aspect ratio\nsns.heatmap(corr, mask=mask, cmap=cmap, center=0,vmax=0.2, vmin=-0.2,\n            annot=True, square=True, linewidths=0.5, cbar_kws={\"shrink\": .5})","25979594":"fig = plt.figure(figsize=(15,20))\n\nfig=plt.subplot(3,3,1)\nsns.histplot(df_ss, x=df_ss.columns[0], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,2)\nsns.histplot(df_ss, x=df_ss.columns[1], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,3)\nsns.histplot(df_ss, x=df_ss.columns[2], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,4)\nsns.histplot(df_ss, x=df_ss.columns[3], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,5)\nsns.histplot(df_ss, x=df_ss.columns[4], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,6)\nsns.histplot(df_ss, x=df_ss.columns[5], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,7)\nsns.histplot(df_ss, x=df_ss.columns[6], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,8)\nsns.histplot(df_ss, x=df_ss.columns[7], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)\n\nfig=plt.subplot(3,3,9)\nsns.histplot(df_ss, x=df_ss.columns[8], hue=\"Drink\", element=\"step\", palette=NY_GIANTS)","2e7e3ef0":"df_ss = df_ss.drop('Drink', axis=1)\ndf_ss['Potability'] = df['Potability']","395f7bbd":"data = df_ss.iloc[:,0:-1].to_numpy()\ntarget = df_ss.iloc[:,-1:]\n\nfrom sklearn.model_selection import train_test_split\n\ntrain_input, test_input, train_target, test_target = train_test_split(data, target, test_size=0.1, random_state=42)","23f3fd42":"from sklearn.model_selection import cross_validate","50509230":"from lightgbm import LGBMClassifier\nlgb = LGBMClassifier(random_state=42)\nscores = cross_validate(lgb, train_input, train_target, return_train_score=True, n_jobs=-1)\n\nprint(\"Train Accuracy : \", np.mean(scores['train_score']))\nprint(\"Test Accuracy : \",np.mean(scores['test_score']))","128baca2":"from xgboost import XGBClassifier\nxgb = XGBClassifier(random_state=42)\nscores = cross_validate(xgb, train_input, train_target, return_train_score=True, n_jobs=-1)\n\nprint(\"Train Score : \", np.mean(scores['train_score']))\nprint(\"Test Score : \", np.mean(scores['test_score']))","71b3534e":"from sklearn.experimental import enable_hist_gradient_boosting\nfrom sklearn.ensemble import HistGradientBoostingClassifier\n\nhgb = HistGradientBoostingClassifier(random_state=42)\nscores = cross_validate(hgb, train_input, train_target, return_train_score=True)\n\nprint(\"Train Score : \",np.mean(scores['train_score']))\nprint(\"Test Score : \",np.mean(scores['test_score']))","7e70dc3e":"# <h1 style='background:#0B2265; border:#A71930; border-width: thick; border-style: solid; color:white'><center> 3rd Down : Why is \"Water Quality\" dataset hard to solve?<\/center><\/h1> ","ef76cc77":"Yes I am wrong on my first hypothesis. \n\nI think I can put mean value on all null. Because Null would not impact on overall view.","db7d24bc":"I has doubt that observation, which has null, might be not drinkable.\n\nIf I am a warter inspector, I would not give OK sign to data on full inspection.","456bce38":"# <h1 style='background:#0B2265; border:#A71930; border-width: thick; border-style: solid; color:white'><center> 2nd Down : Bad News -- Too Low Correlation<\/center><\/h1> ","98071f7b":"No null, proceed next step.","7475f81b":"XG Boost","a44ae7e9":"# <h1 style='background:#0B2265; border:#A71930; border-width: thick; border-style: solid; color:white'><center> 4th Down : Prediction<\/center><\/h1> ","14ae5347":"\n\n\n\n\n# <h1 style='background:#0B2265; border:#A71930; border-width: thick; border-style: solid; color:white'><center>Water Quality : EDA<\/center><\/h1> ","6bd4c84e":"These graphs are like being hit by a shotgun.\n\nI could not see any clue for now.","7a03d7eb":"# <h1 style='background:#0B2265; border:#A71930; border-width: thick; border-style: solid; color:white'><center> 1st Down : Meaningful to Having Null? Nope!   <\/center><\/h1> ","a176dd8a":"I hope you - do not too deep dive this dataset for modeling, only what I have was overfitted result.\n\nBecause distribution on all features are overlapped, could not generate meaningful model.\n\nIf you optimize hyper parameters, you may +10% score than me, but I think that's it.","a5a9adf4":"# <h1 style='background:#0B2265; border:#A71930; border-width: thick; border-style: solid; color:white'><center> Loss Game! Conclusion <\/center><\/h1> ","33c60e02":"# Conclusion","bcac5431":"Ok... ratio looks like... I would be wrong.","563491db":"Potability(=Drinkable) shows very close on zero. Show no relationship with other features.\n\nThis is bad news.","2a7e1870":"# Feature Correlation","27f35d1f":"# Loading","5410541f":"# Features Distribution","b2904107":"LGBM","f5f61deb":"# Model","91480c97":"Why is \"Water Quality\" dataset hard to solve?\n\nBecause \n1. distribution between \"Drinkable\" and \"Not Drinkable\" are overlaped.\n2. They shows almost same average and standard distribution.\n3. Features are two ways : Drinkable warter should has not higher and also not lower on all factors.\n\nOn reason 3, for example, \"PH\" too low value on PH could not drinkable, and also too high value could not drinkable)\n\nBut shape of distribution might be chance to shold prolblem. ","143a1d1a":"# Null Check","9a8d6ac0":"Hist Gradient Boosting"}}