{"cell_type":{"624a634c":"code","c0b06c15":"code","520bce14":"code","189d3916":"code","7c5f4362":"code","7616efc8":"code","b50d2871":"code","4999b0f9":"code","5d68df96":"code","2b67b142":"code","9071b729":"code","19ba7967":"code","6809595d":"code","afd90e81":"code","dddfe9e9":"code","6867f36b":"code","e0515cfe":"code","140d4f08":"code","4d54175f":"code","5429e94e":"code","516b159d":"code","34d83899":"code","244a3516":"code","e50ba69f":"code","a8ad2259":"code","59ea419c":"code","afe958fb":"code","a91475e9":"code","198dbb24":"code","4e05c320":"code","fcfff985":"code","c241b0b4":"code","e88fff55":"code","730801d4":"code","d273d48f":"code","eb0c5261":"code","fe1fb87a":"code","f355df4a":"code","28b110a1":"code","2f9b708e":"code","a032ddfc":"code","3f94217a":"code","d31018c7":"code","9cf7f8fd":"code","b083eca0":"code","89ae524c":"code","6e0d3f77":"code","7438a3bd":"code","91a7c4b2":"code","9dfe36d9":"code","eba31872":"code","22d02760":"code","5c218c01":"code","af726a39":"code","7c97ab22":"code","d677f77b":"code","c601a45d":"code","7c01ee2f":"code","ce9a6014":"code","5f8d29c8":"code","3c4e4edd":"code","499e4f9a":"code","5d2b85d8":"code","d96787db":"code","818ad59e":"code","de065ff8":"code","4af6caf4":"code","622d7e01":"code","648aaec7":"code","62b3ea66":"code","ddb677b7":"code","fd2d323c":"code","12472a2b":"code","2ac07d66":"code","7f559efc":"code","62704dca":"code","8088eccb":"code","f468b595":"code","f6b2d775":"code","41c913b3":"code","b0748d07":"code","19376e9c":"code","e9bea051":"code","4fadf7ae":"code","d6d8acc1":"code","014567cb":"code","b0dc5c39":"code","07e08358":"code","d62a4a08":"code","5ec103bb":"code","1f43fcf8":"code","3bf9dee6":"code","c23a1fee":"code","1c9d8e8d":"code","ac741c99":"code","1f998ef4":"code","5dd2e037":"code","ef80f050":"code","6325d583":"code","8b91dff4":"code","52c248e3":"code","7d954842":"code","a154ff93":"code","a0969223":"code","30dd2171":"code","9ad4b98a":"code","d193314d":"code","e033538d":"code","a398db4c":"code","21a3f9db":"code","f93344b6":"code","413daa11":"markdown","250f3b43":"markdown","8fd29d5e":"markdown","7af1b300":"markdown","9abbb586":"markdown","a4dd917a":"markdown","485313fd":"markdown","f74bd788":"markdown","198afc2a":"markdown","298e831d":"markdown","661e18da":"markdown","0f7d40a2":"markdown","d3854a48":"markdown","efbd50c6":"markdown","2541f9f5":"markdown","ac78fd86":"markdown"},"source":{"624a634c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","c0b06c15":"!pip install calplot","520bce14":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport statsmodels as sm\nfrom statsmodels.graphics.mosaicplot import mosaic\nimport nltk \nimport spacy\nfrom spacy.matcher import PhraseMatcher\nimport calplot as cplt\nimport plotly.offline as py\nimport plotly.express as px\nimport cufflinks as cf","189d3916":"sns.set()\n%matplotlib inline","7c5f4362":"file='\/kaggle\/input\/africa-conflict-19972020\/Africa_1997-2020_Jan08.csv'","7616efc8":"africa = pd.read_csv(file, sep=';')","b50d2871":"africa.tail()","4999b0f9":"africa.info()","5d68df96":"africa.isnull().sum()[africa.isnull().sum()>0]","2b67b142":"africa.drop(columns=['ASSOC_ACTOR_1', 'ASSOC_ACTOR_2', 'ADMIN3', 'TIMESTAMP',\n                     'EVENT_ID_NO_CNTY', 'EVENT_ID_CNTY', 'ISO'], inplace=True)","9071b729":"africa.isnull().sum()[africa.isnull().sum()>0]","19ba7967":"africa.ACTOR2.fillna(' ', inplace=True)","6809595d":"africa.dropna(inplace=True)","afd90e81":"africa['LONGITUDE'] = pd.to_numeric(africa['LONGITUDE'], errors='coerce')\nafrica['LATITUDE'] = pd.to_numeric(africa['LATITUDE'], errors='coerce')","dddfe9e9":"def proper_date(row):\n    month = {'janvier': 1, 'f\u00e9vrier':2, 'mars':3, 'avril':4, 'mai':5,\n            'juin':6, 'juillet':7, 'ao\u00fbt':8, 'septembre':9, 'octobre':10,\n            'novembre':11, 'd\u00e9cembre':12}\n    c = row.split('-')\n    date = f'{c[0]}\/{month[c[1]]}\/{c[2]}'\n    return date","6867f36b":"africa['EVENT_DATE'] = africa['EVENT_DATE'].apply(proper_date)","e0515cfe":"africa['EVENT_DATE'] = pd.to_datetime(africa['EVENT_DATE'])","140d4f08":"africa.info()","4d54175f":"africa['EVENT_TYPE'].value_counts()","5429e94e":"africa['SUB_EVENT_TYPE'].value_counts()","516b159d":"africa['ACTOR1'].value_counts()","34d83899":"africa['ACTOR2'].value_counts()","244a3516":"africa['REGION'].value_counts()","e50ba69f":"africa['COUNTRY'].value_counts()","a8ad2259":"africa['ADMIN1'].value_counts()","59ea419c":"africa['ADMIN2'].value_counts()","afe958fb":"africa['LOCATION'].value_counts()","a91475e9":"africa['SOURCE_SCALE'].value_counts()","198dbb24":"africa['SOURCE'].value_counts()","4e05c320":"africa['TIME_PRECISION'].value_counts()","fcfff985":"africa['GEO_PRECISION'].value_counts()","c241b0b4":"obj_cols = [u  for u in africa.columns if (africa[u].dtype =='object') and (u != 'NOTES')]\nint_cols = [u  for u in africa.columns if africa[u].dtype =='int']\nfloat_cols = [u  for u in africa.columns if africa[u].dtype =='float']","e88fff55":"print(f'Object columns: {obj_cols}\\n\\nInteger columns: {int_cols}\\n\\nFloat columns: {float_cols}')","730801d4":"africa[['YEAR','LATITUDE','LONGITUDE','FATALITIES']].describe()","d273d48f":"africa[['YEAR','LATITUDE','LONGITUDE','FATALITIES']].corr()","eb0c5261":"africa.mode()","fe1fb87a":"africa.skew()","f355df4a":"africa.kurtosis()","28b110a1":"africa1 = africa[africa['TIME_PRECISION'] == 1]","2f9b708e":"fig = plt.figure(figsize=(20,10))\nfig.subplots_adjust(wspace=0.3, hspace=0.5)\nfor i, u in enumerate(int_cols+float_cols):\n    ax = fig.add_subplot(3,3,i+1)\n    sns.histplot(x=u, bins=20, data=africa)\n    ax.set_title('Histogram: ' +u)\nplt.show()","a032ddfc":"fig = plt.figure(figsize=(20,10))\nfig.subplots_adjust(wspace=0.3, hspace=0.5)\nfor i, u in enumerate(int_cols+float_cols):\n    ax = fig.add_subplot(3,3,i+1)\n    sns.boxplot(x=u, data=africa)\n    ax.set_title('Boxplot: ' +u)\nplt.show()","3f94217a":"plt.figure(figsize=(10,10))\nplt.pie(africa['EVENT_TYPE'].value_counts(), labels=africa['EVENT_TYPE'].value_counts().index, startangle=90, shadow=True)\nplt.title('Pie plot.')\nplt.legend(title=\"EVENT TYPE:\", loc='upper left')\nplt.show()","d31018c7":"fig, ax = plt.subplots(figsize=(5,20))\nmosaic(africa['SOURCE_SCALE'].value_counts(), horizontal=False, axes_label=False, ax=ax, title='1997-2020 Mosaic')\nplt.show()","9cf7f8fd":"interaction = pd.pivot_table(africa, values='INTERACTION', index='INTER2', columns='INTER1', aggfunc=np.count_nonzero)","b083eca0":"plt.figure(figsize=(10, 10))\nsns.heatmap(interaction, center=0, annot=True, fmt='.5g')\nplt.title('Number of conflict INTER1 vs INTER2 between 1997 to 2020.')\nplt.xlabel('INTER1 (ACTOR1)')\nplt.ylabel('INTER2 (ACTOR2)')\nplt.show()","89ae524c":"plt.figure(figsize=(10, 8))\nmask = np.triu(np.ones_like(interaction.corr()))\nsns.heatmap(interaction.corr(), center=0, annot=True, fmt='0.3g', mask=mask)\nplt.title('Similarity conflict ACTOR1 vs ACTOR2 between 1997 to 2020.')\nplt.xlabel('INTER1 (ACTOR1)')\nplt.ylabel('INTER2 (ACTOR2)')\nplt.show()","6e0d3f77":"fatalities_interaction =  pd.pivot_table(africa, values='FATALITIES', index='INTER2', columns='INTER1', aggfunc=np.sum)","7438a3bd":"plt.figure(figsize=(10, 10))\nsns.heatmap(fatalities_interaction, center=0, annot=True, fmt='.6g')\nplt.title('Fatalities caused by conflict ACTOR1 vs ACTOR2 between 1997 to 2020.')\nplt.xlabel('INTER1 (ACTOR1)')\nplt.ylabel('INTER2 (ACTOR2)')\nplt.show()","91a7c4b2":"plt.figure(figsize=(10, 8))\nmask1 = np.triu(np.ones_like(fatalities_interaction.corr()))\nsns.heatmap(fatalities_interaction.corr(), center=0, annot=True, fmt='0.3g', mask=mask1)\nplt.title('Similarity fatalities ACTOR1 vs ACTOR2 between 1997 to 2020.')\nplt.xlabel('INTER1 (ACTOR1)')\nplt.ylabel('INTER2 (ACTOR2)')\nplt.show()","9dfe36d9":"region_actor = pd.pivot_table(africa, values='FATALITIES', index='INTER1', columns='REGION', aggfunc=np.sum)","eba31872":"plt.figure(figsize=(10, 10))\nsns.heatmap(region_actor, center=0, annot=True, fmt='.6g')\nplt.title('Fatalities in each region caused by ACTOR1 between 1997 to 2020.')\nplt.ylabel('ACTOR1')\nplt.show()","22d02760":"plt.figure(figsize=(10, 8))\nmask2 = np.triu(np.ones_like(region_actor.corr()))\nsns.heatmap(region_actor.corr(), center=0, annot=True, fmt='0.3g', mask=mask2)\nplt.title('Similarity fatalities caused by actor1 between region of Africa.')\nplt.show()","5c218c01":"event_actor = pd.pivot_table(africa, values='FATALITIES', index='INTER1', columns='EVENT_TYPE', aggfunc=np.sum)","af726a39":"plt.figure(figsize=(12, 10))\nsns.heatmap(event_actor, center=0, annot=True, fmt='.6g')\nplt.title('Fatalities in each event_type caused by ACTOR1 between 1997 to 2020.')\nplt.ylabel('ACTOR1')\nplt.show()","7c97ab22":"plt.figure(figsize=(10, 8))\nmask3 = np.triu(np.ones_like(event_actor.corr()))\nsns.heatmap(event_actor.corr(), center=0, annot=True, fmt='0.3g', mask=mask3)\nplt.title('Similarity fatalities caused by actor1 between different event_type.')\nplt.show()","d677f77b":"event_region = pd.pivot_table(africa, values='FATALITIES', index='REGION', columns='EVENT_TYPE', aggfunc=np.sum)","c601a45d":"plt.figure(figsize=(12, 10))\nsns.heatmap(event_region, center=0, annot=True, fmt='.6g')\nplt.title('Fatalities in each region by event_type between 1997 to 2020.')\nplt.show()","7c01ee2f":"middle_africa = africa[africa['REGION'] == 'Middle Africa']","ce9a6014":"middle_africa.head()","5f8d29c8":"middle_africa['EVENT_TYPE'].value_counts()","3c4e4edd":"middle_africa['SUB_EVENT_TYPE'].value_counts()","499e4f9a":"middle_africa['COUNTRY'].value_counts()","5d2b85d8":"middle_africa['INTER1'].value_counts()","d96787db":"middle_africa['INTERACTION'].value_counts()","818ad59e":"middle_africa['ACTOR1'].value_counts()[middle_africa['ACTOR1'].value_counts()>100]","de065ff8":"need_cols = [\"ACTOR1\", \"ACTOR2\", \"REGION\", \"COUNTRY\", \"ADMIN1\", \"ADMIN2\",\n             \"LOCATION\", \"EVENT_TYPE\", \"SUB_EVENT_TYPE\", \"FATALITIES\", \"YEAR\",\n             \"LONGITUDE\",\"LATITUDE\", \"INTERACTION\"]","4af6caf4":"ext_data = africa[need_cols]","622d7e01":"year_data = ext_data[ext_data['YEAR'] == 2020]","648aaec7":"center_point = dict(lon=3, lat=11)\nfigx = px.density_mapbox(ext_data, lat='LATITUDE', lon='LONGITUDE', z=\"FATALITIES\",\n                        center = center_point, hover_name='COUNTRY', zoom = 5,\n                         range_color= [20, 20] , radius=20,\n                        mapbox_style= 'open-street-map', title='Conflict in Africa between 1997 and 2020',\n                        animation_frame='YEAR')\nfigx.update(layout_coloraxis_showscale=True)\nfigx.show()","62b3ea66":"def tokenizer(text):\n    \n    def is_token_allowed(token):\n        if(not token or token.is_stop or token.is_punct):\n            return False\n        return True\n    \n    def preprocess_token(token):\n        return token.lemma_.strip().lower()\n    \n    nlp = spacy.load(\"en_core_web_sm\")\n    \n    doc = nlp(text)\n    \n    filtered_token = [preprocess_token(token) for token in doc if is_token_allowed(token)]\n    \n    return filtered_token       ","ddb677b7":"year_country = africa[(africa['YEAR'] == 2008) & (africa['COUNTRY'] == 'Cameroon')]","fd2d323c":"text1 = ' '.join(year_country['NOTES'])\ntext = tokenizer(text1)","12472a2b":"source = ' '.join(year_country['SOURCE'])","2ac07d66":"event = ' '.join(year_country['EVENT_TYPE'])","7f559efc":"actors = ' '.join(year_country['ACTOR1'] + ', ' + year_country['ACTOR2']) ","62704dca":"print(f'Lenght of the text: {len(text)}.')","8088eccb":"print(f'Lexical richness of the text: {len(text)\/len(set(np.unique(text)))}.')","f468b595":"#wrd = \"biya\"\n#print(f'Count word: {text.count(wrd)}.\\nPercentage: {100 * text.count(wrd) \/ len(text)}')\n#plt.figure(figsize=(15,5))","f6b2d775":"fdist = nltk.FreqDist(text)","41c913b3":"fdist","b0748d07":"popular_word = list(set(fdist.keys()) - set(fdist.hapaxes()))","19376e9c":"pop_word = pd.Series({w:fdist[w] for w in sorted(popular_word)})","e9bea051":"fig, ax = plt.subplots(figsize=(10,15))\nmosaic(pop_word.sort_values(), ax=ax, horizontal=False, title='Popular words in the Note.')\nplt.show()","4fadf7ae":"bigrams = nltk.bigrams(text)","d6d8acc1":"cfd_b = nltk.FreqDist(bigrams)","014567cb":"fig1, ax1 = plt.subplots(figsize=(5, 10), dpi=100)\nmosaic({x[0][0]+' '+x[0][1]: x[1] for x in cfd_b.most_common(n=30)}, ax=ax1,  axes_label=False,\n       horizontal=False, title='30 most common bigrams.')\nplt.show()","b0dc5c39":"trigrams = nltk.trigrams(text)","07e08358":"cfd_t = nltk.FreqDist(trigrams)","d62a4a08":"cfd_t","5ec103bb":"cdic={x[0][0] + ' ' + x[0][1]+' '+x[0][2]: x[1] for x in cfd_t.most_common(n=30)}","1f43fcf8":"fig2, ax2 = plt.subplots(figsize=(8, 15), dpi=100)\nmosaic(cdic, ax=ax2,  axes_label=False,\n       horizontal=False, title='30 most common trigrams.')\nplt.show()","3bf9dee6":"nlp = spacy.load('en_core_web_sm')","c23a1fee":"doc = nlp(text1)","1c9d8e8d":"spacy.displacy.render(doc, style='ent')","ac741c99":"matcher = PhraseMatcher(nlp.vocab)\nterms = [\"high cost of living\"]\npatterns = [nlp.make_doc(t) for t in terms]\nmatcher.add(\"TerminologyList\", None, *patterns)\nmatches = matcher(doc)\nfor match_id, start, end in matches:\n    span = doc[start-15:end+15]\n    spacy.displacy.render(span, style='ent', jupyter=True)","1f998ef4":"sub_region = africa[(africa['YEAR'] == 2020) & (africa['REGION'] == 'Middle Africa')]","5dd2e037":"sub_region.tail()","ef80f050":"sns.countplot(x='INTER1', data=sub_region)\nplt.show()","6325d583":"_, ax = plt.subplots(figsize=(10,5))\nsub_region.ACTOR1.value_counts()[:10].plot(kind='bar', ax=ax, title='10 forces most present in the Middle Africa')\nplt.show()","8b91dff4":"_, ax = plt.subplots(figsize=(10,5))\nsub_region.COUNTRY.value_counts().plot(kind='bar', ax=ax, title='Countries in the Middle Africa.')\nplt.show()","52c248e3":"_, ax = plt.subplots(figsize=(10,5))\nsub_region.EVENT_TYPE.value_counts().plot(kind='bar', ax=ax, title='Countries in the Middle Africa.')\nplt.show()","7d954842":"fatalities_per_country = sub_region.groupby('COUNTRY')[\"FATALITIES\"].agg('sum')","a154ff93":"_, ax = plt.subplots(figsize=(10,5))\nfatalities_per_country.plot(kind='bar', ax=ax, title='Total fatalities per country ')\nax.set_ylabel('FATALITIES')\nplt.show()","a0969223":"cal_fatalities = sub_region.groupby('EVENT_DATE')['FATALITIES'].agg('sum')","30dd2171":"_, ax = plt.subplots(figsize=(15,5))\ncal_fatalities.plot(ax=ax)\nax.set_title('Daily fatalities.')\nplt.show()","9ad4b98a":"weekly_fatalities = cal_fatalities.resample('W').sum()\nmonthly_fatalities = cal_fatalities.resample('M', convention='end').sum()\nQ_fatalities = cal_fatalities.resample('Q', convention='start').sum()","d193314d":"_, ax = plt.subplots(figsize=(15,5))\nweekly_fatalities.plot(ax=ax)\nax.set_title('Weekly fatalities.')\nplt.show()","e033538d":"_, ax = plt.subplots(figsize=(15,5))\nmonthly_fatalities.plot(ax=ax)\nax.set_title('Monthly fatalities.')\nplt.show()","a398db4c":"_, ax = plt.subplots(figsize=(15,5))\nQ_fatalities.plot(kind='bar', ax=ax)\nax.set_title('Quarterly fatalities.')\nplt.show()","21a3f9db":"_, ax = plt.subplots(figsize=(15,5))\ncal_fatalities.diff().plot(ax=ax)\nax.set_title('Change rate fatalities.')\nplt.show()","f93344b6":"cplt.calplot(cal_fatalities, how=None, figsize=(15,5))\nax.set_title('Fatalities calendar for Middle Africa region.')\nplt.show()","413daa11":"## Text statistics","250f3b43":"# Africa: region","8fd29d5e":"## Relation between INTER1 (ACTOR1) and INTER2 (ACTOR2)","7af1b300":"## Collocation","9abbb586":"## TIME SERIES","a4dd917a":"## In each region, how many fatalities are there in each type of conflict event between 1997 to 2020?","485313fd":"# Text mining","f74bd788":"## Visualization","198afc2a":"# Geospatial Analysis","298e831d":"# Other visualization","661e18da":"### Clean event date","0f7d40a2":"## In each type of conflict event, how many fatalities the actors make between 1997 to 2020?","d3854a48":"# Exploratory data analysis","efbd50c6":"## In each region, how many fatalities the actors make in the conflict between 1997 to 2020?","2541f9f5":"## Explore","ac78fd86":"# cleaning and prepare data"}}