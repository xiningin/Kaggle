{"cell_type":{"9962e0a5":"code","0ddc7b36":"code","620d3876":"code","d535e6ce":"code","1e3b42e8":"code","e2e09d4c":"code","d5e372f2":"code","62939cdf":"code","b0c8fe9f":"code","5412a7b0":"code","27aeba0b":"code","f9b12f5a":"code","bf8d478f":"code","1bc1ab1e":"code","a43e024a":"code","8f68c40c":"code","b0d236b4":"code","f32e5b8a":"code","fa0fd6b4":"code","11a94a35":"code","39e179c6":"code","076bb177":"code","29a106b9":"code","3b0df90d":"code","ede91caf":"code","17954905":"code","54eb02dc":"code","12adfb77":"code","4c9cdc0a":"code","d002bec0":"code","9bbede34":"code","de520b63":"code","557d7169":"code","2191d486":"markdown","c64567dc":"markdown"},"source":{"9962e0a5":"# How Titanic ship sank?\nfrom IPython.display import Image\nImage(url= \"https:\/\/static1.squarespace.com\/static\/5006453fe4b09ef2252ba068\/t\/5090b249e4b047ba54dfd258\/1351660113175\/TItanic-Survival-Infographic.jpg?format=1000w\")","0ddc7b36":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","620d3876":"import seaborn as sns\nsns.set_theme(style='darkgrid')\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt \n%matplotlib inline","d535e6ce":"titanic_train_df = pd.read_csv('\/kaggle\/input\/titanic\/train.csv')\n\ntitanic_test_df = pd.read_csv('\/kaggle\/input\/titanic\/test.csv')\n\n\ntitanic_train_df.set_index('PassengerId', inplace=True)\ntitanic_train_df.head()","1e3b42e8":"titanic_train_df.info()","e2e09d4c":"pass_by_sex = titanic_train_df['Sex'].value_counts()\n\nmale_pc = (pass_by_sex['male']\/pass_by_sex.sum())*100\nfemale_pc = (pass_by_sex['female']\/pass_by_sex.sum())*100\n\nprint(\"{}% of passengers are male while {}% are female\".format(round(male_pc), round(female_pc)))","d5e372f2":"sns.countplot(data=titanic_train_df, x='Survived')","62939cdf":"sns.countplot(data=titanic_train_df, x='Sex', hue='Survived')","b0c8fe9f":"sns.countplot(data=titanic_train_df, x='Pclass')","5412a7b0":"sns.countplot(data=titanic_train_df, x='Pclass', hue='Survived')","27aeba0b":"sns.histplot(data=titanic_train_df, x='Age')","f9b12f5a":"sns.histplot(data=titanic_train_df, x='SibSp')","bf8d478f":"sns.histplot(data=titanic_train_df, x='Parch')\n#Age here is a continuous variable while Parch and SibSp are discrete","1bc1ab1e":"# Sex and Pclass are categorical while SibSp and Parch are discrete numerical attributes\nfeatures = ['Sex', 'Pclass', 'SibSp', 'Parch']\n\nX_train = pd.get_dummies(titanic_train_df[features])\ny_train = titanic_train_df['Survived']","a43e024a":"from sklearn.model_selection import cross_val_score, cross_val_predict\nfrom sklearn.metrics import f1_score, precision_score, recall_score, confusion_matrix\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.linear_model import LogisticRegression\n","8f68c40c":"forest_clf = RandomForestClassifier(random_state=42)\n\ny_pred = cross_val_predict(forest_clf, X_train, y_train, cv=3)","b0d236b4":"cross_val_score(forest_clf, X_train, y_train, cv=3, scoring='accuracy')","f32e5b8a":"conf_matrix = confusion_matrix(y_train, y_pred)\nconf_matrix","fa0fd6b4":"precision_score(y_train, y_pred)","11a94a35":"recall_score(y_train, y_pred)","39e179c6":"sns.heatmap(data=conf_matrix, cmap='YlGnBu', annot=True)","076bb177":"f1_score(y_train, y_pred)","29a106b9":"logit_model = LogisticRegression(random_state=42)\n\ny_pred = cross_val_predict(logit_model, X_train, y_train, cv=3)\ncross_val_score(logit_model, X_train, y_train, cv=3, scoring='accuracy')","3b0df90d":"conf_matrix = confusion_matrix(y_train, y_pred)\nconf_matrix","ede91caf":"precision_score(y_train, y_pred)","17954905":"recall_score(y_train, y_pred)","54eb02dc":"sns.heatmap(data=conf_matrix, cmap='YlGnBu', annot=True)","12adfb77":"f1_score(y_train, y_pred)","4c9cdc0a":"titanic_test_df.shape","d002bec0":"X_test = pd.get_dummies(titanic_test_df[features])","9bbede34":"logit_model.fit(X_train, y_train)\npredictions = logit_model.predict(X_test)\noutput = pd.DataFrame({'PassengerID':titanic_test_df.PassengerId, 'Survived':predictions})","de520b63":"output[:5]","557d7169":"output.to_csv('my_submission.csv', index=False)\nprint('Submission saved!')","2191d486":"# Building a RandomForestClassifier model\n\n* Excluding Age in the features set","c64567dc":"# Final Prediction from the model\n"}}