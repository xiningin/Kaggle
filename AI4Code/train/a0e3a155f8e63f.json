{"cell_type":{"cc3f007a":"code","cf8f867a":"code","d8f78b76":"code","db7bd092":"code","7b792192":"code","8ab60c4e":"code","62c65275":"code","f48e71b7":"code","1767d2ae":"code","8e009ef2":"code","6553fa13":"code","da144dc5":"code","ebe7c0f5":"code","9b36b93c":"code","1c564c96":"code","9bca9101":"code","c39d6a98":"code","f8ffdc88":"code","7b788549":"code","1fec720d":"code","1cb48bc7":"code","90c7f76d":"code","da789260":"code","67c4578f":"code","11185841":"code","c8726bed":"code","33f484ce":"code","e7cefe78":"code","7646f106":"code","7abbc465":"markdown","335b5df2":"markdown"},"source":{"cc3f007a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","cf8f867a":"df=pd.read_csv('\/kaggle\/input\/insurance\/insurance.csv')","d8f78b76":"data=df.copy()","db7bd092":"data.shape","7b792192":"data.head(10)","8ab60c4e":"data.info()","62c65275":"data.isnull().sum()","f48e71b7":"data.sample(50)","1767d2ae":"data.region.value_counts()","8e009ef2":"data.columns\n","6553fa13":"data.sex.value_counts()","da144dc5":"data.smoker.value_counts().plot.bar()","ebe7c0f5":"data.corr().T","9b36b93c":"f,ax=plt.subplots(figsize=(8,8))\nsns.heatmap(data.corr(),annot=True,fmt='.2f',ax=ax)\nplt.show()","1c564c96":"data.corr()['charges'].sort_values()","9bca9101":"from sklearn.preprocessing import LabelEncoder\n#sex\nle = LabelEncoder()\nle.fit(data.sex.drop_duplicates()) \ndata.sex = le.transform(data.sex)\n# smoker or not\nle.fit(data.smoker.drop_duplicates()) \ndata.smoker = le.transform(data.smoker)\n#region\nle.fit(data.region.drop_duplicates()) \ndata.region = le.transform(data.region)","c39d6a98":"data.head()","f8ffdc88":"f= plt.figure(figsize=(12,5))\n\nax=f.add_subplot(121)\nsns.distplot(data[(data.smoker == 1)][\"charges\"],color='c',ax=ax)\nax.set_title('Distribution of charges for smokers')\n\nax=f.add_subplot(122)\nsns.distplot(data[(data.smoker == 0)]['charges'],color='b',ax=ax)\nax.set_title('Distribution of charges for non-smokers')\nplt.show()","7b788549":"sns.catplot(x=\"smoker\", kind=\"count\",hue = 'sex', palette=\"pink\", data=data)\n","1fec720d":"plt.figure(figsize=(12,5))\nplt.title(\"Box plot for charges of women\")\nsns.boxplot(y=\"charges\", x=\"smoker\", data =  data[(data.sex == 1)])","1cb48bc7":"plt.figure(figsize=(12,5))\nplt.title(\"Distribution of bmi\")\nax = sns.distplot(data[\"bmi\"], color = 'm')","90c7f76d":"plt.figure(figsize=(12,5))\nplt.title(\"Distribution of charges for patients with BMI greater than 30\")\nax = sns.distplot(data[(data.bmi >= 30)]['charges'], color = 'm')","da789260":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import r2_score,mean_squared_error","67c4578f":"x","11185841":"x = data.drop(['charges'], axis = 1)\ny = data.charges\n\nx_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.2, random_state = 42)\nlr = LinearRegression().fit(x_train,y_train)\n\nprint(lr.score(x_test,y_test))","c8726bed":"pre=x.iloc[32:33,:]","33f484ce":"pre","e7cefe78":"lr.predict([[17,1,26,1,0,2]])","7646f106":"lr.predict(pre)","7abbc465":"y=data.iloc[:,[6]]","335b5df2":"x=data.iloc[:,[0]]"}}