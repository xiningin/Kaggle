{"cell_type":{"c8a4a732":"code","206240fc":"code","b03b1d43":"code","eec1cefb":"code","14bebfcf":"code","d5953112":"code","d7d64587":"code","d56d205f":"code","4d8247ab":"code","41704816":"code","a9dbd09a":"code","05131a24":"code","ebdca366":"code","1b8c6df1":"code","916c3825":"code","28fc30d3":"code","81bcf1c3":"code","a79863a1":"code","d237c240":"code","5b943861":"code","e2f58b0c":"code","f2b52d5e":"code","be9b1486":"code","72708cab":"code","47517d15":"code","4fee97d5":"code","2535e46c":"code","311c478f":"code","5e1994d9":"code","4d7cc489":"code","2073a682":"code","38675128":"code","91189b3e":"code","93c5abcd":"code","0ad8fa22":"code","17844955":"code","11323146":"code","6c995d4b":"code","1f3e9381":"code","72b0ae50":"code","7b52f0f7":"code","d68b3469":"code","f5994073":"code","bfa9f54c":"code","79a81b81":"code","4a6f219f":"code","0e66fb69":"code","96b135fc":"markdown"},"source":{"c8a4a732":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","206240fc":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport xgboost","b03b1d43":"train=pd.read_csv('..\/input\/covid19-global-forecasting-week-2\/train.csv')\ntest=pd.read_csv('..\/input\/covid19-global-forecasting-week-2\/test.csv')","eec1cefb":"test1=test","14bebfcf":"train.head(5)","d5953112":"test1.head(5)","d7d64587":"test.head(5)","d56d205f":"train.info()","4d8247ab":"fig = plt.figure(figsize=(16,8))\nax = fig.add_subplot(111)\ntrain.groupby('Date').mean().sort_values(by='ConfirmedCases', ascending=False)['ConfirmedCases'].plot('bar', color='r',width=0.3,title='Date Confirmed Cases', fontsize=10)\nplt.xticks(rotation = 90)\nplt.ylabel('Date')\nax.title.set_fontsize(30)\nax.xaxis.label.set_fontsize(10)\nax.yaxis.label.set_fontsize(10)\nprint(train.groupby('Date').mean().sort_values(by='ConfirmedCases', ascending=False)['ConfirmedCases'][[1,2]])\nprint(train.groupby('Date').mean().sort_values(by='ConfirmedCases', ascending=False)['ConfirmedCases'][[4,5,6]])","41704816":"#Country_Region top 30\ntrain.Country_Region.value_counts()[0:30].plot(kind='bar')\nplt.show()","a9dbd09a":"fig = plt.figure(figsize=(16,8))\nax = fig.add_subplot(111)\ntrain.groupby('Date').mean().sort_values(by='Fatalities', ascending=False)['Fatalities'].plot('bar', color='r',width=0.3,title='Date Fatalities Cases', fontsize=10)\nplt.xticks(rotation = 90)\nplt.ylabel('Date')\nax.title.set_fontsize(30)\nax.xaxis.label.set_fontsize(10)\nax.yaxis.label.set_fontsize(10)\nprint(train.groupby('Date').mean().sort_values(by='Fatalities', ascending=False)['Fatalities'][[1,2]])\nprint(train.groupby('Date').mean().sort_values(by='Fatalities', ascending=False)['Fatalities'][[4,5,6]])","05131a24":"#visualization of main places US,ITALY,CHINA,UK\n#US\nConfirmedCases_date_US = train[train['Country_Region']=='US'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_US = train[train['Country_Region']=='US'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_US = ConfirmedCases_date_US.join(fatalities_date_US)\n\n\n#China\nConfirmedCases_date_China = train[train['Country_Region']=='China'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_China = train[train['Country_Region']=='China'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_China = ConfirmedCases_date_China.join(fatalities_date_China)\n\n#Italy\nConfirmedCases_date_Italy = train[train['Country_Region']=='Italy'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Italy = train[train['Country_Region']=='Italy'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Italy = ConfirmedCases_date_Italy.join(fatalities_date_Italy)\n\n#Australia\nConfirmedCases_date_Australia = train[train['Country_Region']=='Australia'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Australia = train[train['Country_Region']=='Australia'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Australia = ConfirmedCases_date_Australia.join(fatalities_date_Australia)\n\n\n\nplt.figure(figsize=(15,10))\nplt.subplot(2, 2, 1)\ntotal_date_US.plot(ax=plt.gca(), title='US')\nplt.ylabel(\"Confirmed  cases\", size=13)\n\nplt.subplot(2, 2, 2)\ntotal_date_China.plot(ax=plt.gca(), title='China')\n\nplt.subplot(2, 2, 3)\ntotal_date_Italy.plot(ax=plt.gca(), title='Italy')\nplt.ylabel(\"Confirmed cases\", size=13)\n\nplt.subplot(2, 2, 4)\ntotal_date_Australia.plot(ax=plt.gca(), title='Australia')","ebdca366":"# Handling dates","1b8c6df1":"train['Date']= pd.to_datetime(train['Date']) \ntest['Date']= pd.to_datetime(test['Date'])","916c3825":"train = train.set_index(['Date'])\ntest = test.set_index(['Date'])","28fc30d3":"def create_time_features(df):\n    \"\"\"\n    Creates time series features from datetime index\n    \"\"\"\n    df['date'] = df.index\n    df['hour'] = df['date'].dt.hour\n    df['dayofweek'] = df['date'].dt.dayofweek\n    df['quarter'] = df['date'].dt.quarter\n    df['month'] = df['date'].dt.month\n    df['year'] = df['date'].dt.year\n    df['dayofyear'] = df['date'].dt.dayofyear\n    df['dayofmonth'] = df['date'].dt.day\n    df['weekofyear'] = df['date'].dt.weekofyear\n    \n    X = df[['hour','dayofweek','quarter','month','year',\n           'dayofyear','dayofmonth','weekofyear']]\n    return X","81bcf1c3":"create_time_features(train).head()\ncreate_time_features(test).head()","a79863a1":"train.head(5)","d237c240":"train.drop(\"date\", axis=1, inplace=True)\ntest.drop(\"date\", axis=1, inplace=True)","5b943861":"confirmed_corr=train.corr()['ConfirmedCases']\nconfirmed_corr.sort_values(ascending=False)","e2f58b0c":"fatalities_corr=train.corr()['Fatalities']\nfatalities_corr.sort_values(ascending=False)","f2b52d5e":"train.drop(\"dayofweek\", axis=1, inplace=True)\ntest.drop(\"dayofweek\", axis=1, inplace=True)","be9b1486":"train.drop(\"hour\", axis=1, inplace=True)\ntest.drop(\"hour\", axis=1, inplace=True)","72708cab":"train.drop(\"quarter\", axis=1, inplace=True)\ntest.drop(\"quarter\", axis=1, inplace=True)","47517d15":"train.drop(\"year\", axis=1, inplace=True)\ntest.drop(\"year\", axis=1, inplace=True)","4fee97d5":"train.drop(\"Province_State\", axis=1, inplace=True)\ntest.drop(\"Province_State\", axis=1, inplace=True)","2535e46c":"train.drop(\"Id\", axis=1, inplace=True)\ntest.drop(\"ForecastId\", axis=1, inplace=True)","311c478f":"test.info()","5e1994d9":"#to convert country_region into labels","4d7cc489":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\ndef FunLabelEncoder(df):\n    for c in df.columns:\n        if df.dtypes[c] == object:\n            le.fit(df[c].astype(str))\n            df[c] = le.transform(df[c].astype(str))\n    return df","2073a682":"train = FunLabelEncoder(train)\ntrain.info()","38675128":"test = FunLabelEncoder(test)\ntest.info()","91189b3e":"test.head(5)","93c5abcd":"x_train= train[['Country_Region', 'month', 'dayofyear', 'dayofmonth' , 'weekofyear']]\ny1 = train[['ConfirmedCases']]\ny2 = train[['Fatalities']]\nx_test = test[['Country_Region', 'month', 'dayofyear', 'dayofmonth' , 'weekofyear']]","0ad8fa22":"# now we will check the prediction\n","17844955":"model = xgboost.XGBRegressor()","11323146":"model.fit(x_train,y1)","6c995d4b":"#for confirmed cases\nprediction1 = model.predict(x_test)\nprediction1 = pd.DataFrame(prediction1)\nprediction1.columns = [\"ConfirmedCases_prediction\"]","1f3e9381":"prediction1.head()","72b0ae50":"#for fatalities\nmodel.fit(x_train,y2)\nprediction2 = model.predict(x_test)\nprediction2 = pd.DataFrame(prediction2)\nprediction2.columns = [\"Death_prediction\"]","7b52f0f7":"prediction2.head()","d68b3469":"\nsub_new = test1[[\"ForecastId\"]]\nsub_new","f5994073":"\nsubmit = pd.concat([prediction1,prediction2,sub_new],axis=1)\nsubmit.head()","bfa9f54c":"# Clean\nsubmit.columns = ['ConfirmedCases', 'Fatalities', 'ForecastId']\nsubmit = submit[['ForecastId','ConfirmedCases', 'Fatalities']]\n\nsubmit[\"ConfirmedCases\"] = submit[\"ConfirmedCases\"].astype(int)\nsubmit[\"Fatalities\"] = submit[\"Fatalities\"].astype(int)","79a81b81":"submit.info()","4a6f219f":"# Final Prediction\nsubmit.head(5)","0e66fb69":"submit.to_csv(\"submission.csv\",index=False)","96b135fc":"Overview\nCoronavirus disease(COVID-19) is an infectious disease caused by a new virus. The disease causes respiratory illness (like the flu) \nwith symptoms such as a cough, fever, and in more severe cases, difficulty breathing. You can protect yourself by washing your hands\nfrequently, avoiding touching your face,and avoiding close contact (1 meter or 3 feet) with people who are unwell.\n\nHow it spreads\nCoronavirus disease spreads primarily through contact with an infected person when they cough or sneeze. It also spreads when a person\ntouches a surface or object that has the virus on it, then touches their eyes, nose, or mouth.\n\nsymptoms\nPeople may be sick with the virus for 1 to 14 days before developing symptoms. The most common symptoms of coronavirus disease (COVID-19)\nare fever, tiredness, and dry cough. Most people (about 80%) recover from the disease without needing special treatment.\n\nPreventions\nYou can protect yourself and help prevent spreading the virus to others if you: Do \u2022 Wash your hands regularly for 20 seconds, with soap\nand water or alcohol-based hand rub \u2022 Cover your nose and mouth with a disposable tissue or flexed elbow when you cough or sneeze \u2022Avoid\nclose contact (1 meter or 3 feet) with people who are unwell \u2022 Stay home and self-isolate from others in the household if you feel unwell\n\nTreatments\nThere is no specific medicine to prevent or treat coronavirus disease (COVID-19). People may need supportive care to help them breathe.\n\nDetails of the challenge\nThis is week 2 of Kaggle's COVID19 forecasting series, following the Week 1 competition. This is the 2nd of at least 4 competitions we \nplan to launch in this series.\n\nBackground\nThe White House Office of Science and Technology Policy (OSTP) pulled together a coalition research groups and companies (including Kaggle)\nto prepare the COVID-19 Open Research Dataset (CORD-19) to attempt to address key open scientific questions on COVID-19. Those questions are\ndrawn from National Academies of Sciences, Engineering, and Medicine\u2019s (NASEM) and the World Health Organization (WHO).\n\nThe Challenge\nKaggle is launching a companion COVID-19 forecasting challenges to help answer a subset of the NASEM\/WHO questions. While the challenge\ninvolves forecasting confirmed cases and fatalities between April 1 and April 30 by region, the primary goal isn't only to produce accurate\nforecasts. It\u2019s also to identify factors that appear to impact the transmission rate of COVID-19.\n\nYou are encouraged to pull in, curate and share data sources that might be helpful. If you find variables that look like they impact the \ntransmission rate, please share your finding in a notebook.\n\nAs the data becomes available, we will update the leaderboard with live results based on data made available from the Johns Hopkins University\nCenter for Systems Science and Engineering (JHU CSSE).\n\nWe have received support and guidance from health and policy organizations in launching these challenges. We're hopeful the Kaggle community\ncan make valuable contributions to developing a better understanding of factors that impact the transmission of COVID-19.\n\n\nCompanies and Organizations\nThere is also a call to action for companies and other organizations: If you have datasets that might be useful, please upload them to Kaggle\u2019s\ndataset platform and reference them in this forum thread. That will make them accessible to those participating in this challenge and a resource\nto the wider scientific community.\n\nAcknowledgements\nJHU CSSE for making the data available to the public. The White House OSTP for pulling together the key open questions. The image comes from the\nCenter for Disease Control.****"}}