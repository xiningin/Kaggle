{"cell_type":{"e093f02f":"code","4cdb7992":"code","85c8fc54":"code","9e3d65b5":"code","faa60041":"code","cc04eaa6":"code","54f9051b":"code","a901eaea":"code","42f011bf":"code","37fdbd58":"code","e86396eb":"code","36f47823":"code","e97188ac":"code","05532c00":"code","0987e5d8":"code","8f936b60":"code","f40bee2c":"code","cdfd87b4":"code","218e783e":"code","0b971122":"code","8544c9c8":"code","939d1de9":"code","26254e99":"code","9e0366c3":"code","40ecffe5":"code","3934b50d":"code","17bcbfcb":"code","9638b259":"markdown","9caa036c":"markdown","9bd11c75":"markdown","3ad0ffbc":"markdown","5009c55b":"markdown","75095f6a":"markdown","8ab31103":"markdown","acc42387":"markdown","62e45389":"markdown","98207d20":"markdown","d6352c86":"markdown","c1e2f7fc":"markdown","ff885a73":"markdown","cf514516":"markdown","e2058ce7":"markdown","f25612e9":"markdown","773ee0ab":"markdown"},"source":{"e093f02f":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","4cdb7992":"from sklearn.datasets import load_breast_cancer","85c8fc54":"cancer = load_breast_cancer()","9e3d65b5":"cancer.keys()","faa60041":"print(cancer['DESCR'])","cc04eaa6":"cancer['feature_names']","54f9051b":"df_feat = pd.DataFrame(cancer['data'],columns=cancer['feature_names'])\ndf_feat.info()","a901eaea":"cancer['target']","42f011bf":"df_target = pd.DataFrame(cancer['target'],columns=['Cancer'])","37fdbd58":"from sklearn.model_selection import train_test_split","e86396eb":"X_train, X_test, y_train, y_test = train_test_split(df_feat, np.ravel(df_target), test_size=0.30, random_state=101)","36f47823":"from sklearn.svm import SVC","e97188ac":"model = SVC()","05532c00":"model.fit(X_train,y_train)","0987e5d8":"predictions = model.predict(X_test)","8f936b60":"from sklearn.metrics import classification_report,confusion_matrix","f40bee2c":"print(confusion_matrix(y_test,predictions))","cdfd87b4":"print(classification_report(y_test,predictions))","218e783e":"param_grid = {'C': [0.1,1, 10, 100, 1000], 'gamma': [1,0.1,0.01,0.001,0.0001], 'kernel': ['rbf']} ","0b971122":"from sklearn.model_selection import GridSearchCV","8544c9c8":"grid = GridSearchCV(SVC(),param_grid,refit=True,verbose=3)","939d1de9":"# May take awhile!\ngrid.fit(X_train,y_train)","26254e99":"grid.best_params_","9e0366c3":"grid.best_estimator_","40ecffe5":"grid_predictions = grid.predict(X_test)","3934b50d":"print(confusion_matrix(y_test,grid_predictions))","17bcbfcb":"print(classification_report(y_test,grid_predictions))","9638b259":"# Great job!","9caa036c":"The data set is presented in a dictionary form:","9bd11c75":"What fit does is a bit more involved then usual. First, it runs the same loop with cross-validation, to find the best parameter combination. Once it has the best combination, it runs fit again on all data passed to fit (without cross-validation), to built a single new model using the best parameter setting.","3ad0ffbc":"You can inspect the best parameters found by GridSearchCV in the best_params_ attribute, and the best estimator in the best\\_estimator_ attribute:","5009c55b":"# Exploratory Data Analysis\n\n","75095f6a":"We'll skip the Data Viz part for this lecture since there are so many features that are hard to interpret if you don't have domain knowledge of cancer or tumor cells. In your project you will have more to visualize for the data.","8ab31103":"# Gridsearch\n\nFinding the right parameters (like what C or gamma values to use) is a tricky task! But luckily, we can be a little lazy and just try a bunch of combinations and see what works best! This idea of creating a 'grid' of parameters and just trying out all the possible combinations is called a Gridsearch, this method is common enough that Scikit-learn has this functionality built in with GridSearchCV! The CV stands for cross-validation which is the\n\nGridSearchCV takes a dictionary that describes the parameters that should be tried and a model to train. The grid of parameters is defined as a dictionary, where the keys are the parameters and the values are the settings to be tested. ","acc42387":"## Set up DataFrame","62e45389":"One of the great things about GridSearchCV is that it is a meta-estimator. It takes an estimator like SVC, and creates a new estimator, that behaves exactly the same - in this case, like a classifier. You should add refit=True and choose verbose to whatever number you want, higher the number, the more verbose (verbose just means the text output describing the process).","98207d20":"\n___\n# Support Vector Machines with Python\n\nWelcome to the Support Vector Machines with Python Lecture Notebook!\n## Import Libraries","d6352c86":"# Train the Support Vector Classifier","c1e2f7fc":"## Train Test Split","ff885a73":"Then you can re-run predictions on this grid object just like you would with a normal model.","cf514516":"## Predictions and Evaluations\n\nNow let's predict using the trained model.","e2058ce7":"We can grab information and arrays out of this dictionary to set up our data frame and understanding of the features:","f25612e9":"Woah! Notice that we are classifying everything into a single class! This means our model needs to have it parameters adjusted (it may also help to normalize the data).\n\nWe can search for parameters using a GridSearch!","773ee0ab":"## Get the Data\n\nWe'll use the built in breast cancer dataset from Scikit Learn. We can get with the load function:"}}