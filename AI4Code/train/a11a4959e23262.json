{"cell_type":{"4c841942":"code","55f79f79":"code","d2b15623":"code","98cc750e":"code","ff88877a":"code","6b0b7854":"code","716f6c6d":"code","467293bd":"markdown","c4677c3e":"markdown","84b50bbd":"markdown","52f66776":"markdown","562796a6":"markdown"},"source":{"4c841942":"import tensorflow as tf\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport numpy as np\nimport PIL.Image\nimport time\nimport functools","55f79f79":"def load_img(path_to_img):\n  max_dim = 512\n  img = tf.io.read_file(path_to_img)\n  img = tf.image.decode_image(img, channels=3)\n  img = tf.image.convert_image_dtype(img, tf.float32)\n\n  shape = tf.cast(tf.shape(img)[:-1], tf.float32)\n  long_dim = max(shape)\n  scale = max_dim \/ long_dim\n\n  new_shape = tf.cast(shape * scale, tf.int32)\n\n  img = tf.image.resize(img, new_shape)\n  img = img[tf.newaxis, :]\n  return img","d2b15623":"def imshow(image, title=None):\n  if len(image.shape) > 3:\n    image = tf.squeeze(image, axis=0)\n\n  plt.imshow(image)\n  if title:\n    plt.title(title)","98cc750e":"content_image = load_img('\/kaggle\/input\/doom-crossing\/doom\/lzre9qnqo2q41.jpg')\nstyle_image = load_img('\/kaggle\/input\/doom-crossing\/animal_crossing\/kzabkt8igdu41.jpg')\n\nplt.subplot(1, 2, 1)\nimshow(content_image, 'Content Image')\n\nplt.subplot(1, 2, 2)\nimshow(style_image, 'Style Image')","ff88877a":"def tensor_to_image(tensor):\n  tensor = tensor*255\n  tensor = np.array(tensor, dtype=np.uint8)\n  if np.ndim(tensor)>3:\n    assert tensor.shape[0] == 1\n    tensor = tensor[0]\n  return PIL.Image.fromarray(tensor)","6b0b7854":"import tensorflow_hub as hub\nhub_module = hub.load('https:\/\/tfhub.dev\/google\/magenta\/arbitrary-image-stylization-v1-256\/1')\nstylized_image = hub_module(tf.constant(content_image), tf.constant(style_image))[0]\ntensor_to_image(stylized_image)","716f6c6d":"import tensorflow_hub as hub\nhub_module = hub.load('https:\/\/tfhub.dev\/google\/magenta\/arbitrary-image-stylization-v1-256\/1')\nstylized_image = hub_module(tf.constant(style_image), tf.constant(content_image))[0]\ntensor_to_image(stylized_image)","467293bd":"## Summary: a program that takes the style from animal crossing and applus it to a doom picture, I will load a pre trained style transfer model from tensorflow hub.","c4677c3e":"#### DOOM -> animal crossing","84b50bbd":"### Get the Images","52f66776":"#### Animal crossing -> DOOM","562796a6":"### Pre trained tensorflow model"}}