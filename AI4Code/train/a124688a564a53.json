{"cell_type":{"cd455b45":"code","c3e4f399":"code","df7cc296":"code","0a8b32ee":"code","2d323016":"code","71f1737d":"code","7811c3d6":"code","b6a7959e":"code","0d4502bf":"code","3d21b093":"code","69ce9167":"code","5b57ca78":"markdown","31673482":"markdown","51cc3145":"markdown","54b411db":"markdown","7b2b0065":"markdown","e5ec6b1a":"markdown"},"source":{"cd455b45":"import pandas as pd\nimport joblib","c3e4f399":"preprocessor = joblib.load('..\/input\/titanic-models\/pipeline.pkl')\nmodel = joblib.load('..\/input\/titanic-models\/rf_grid.pkl')","df7cc296":"test = pd.read_csv('..\/input\/titanic\/test.csv', sep=',')\nprint(\"test.shape: \", test.shape)\ntest.head()","0a8b32ee":"test.isnull().sum(axis = 0)","2d323016":"# We will start with some feature engineering. \n\n# Add a new column named 'FamSize' to the DataFrame. \n# This should be the sum of the 'SibSp' and 'Parch' columns. \ntest['FamSize'] = test.SibSp + test.Parch\n\n# We will use the function below to determine the deck letter for each passenger:\ndef set_deck(cabin):\n    if str(cabin) == 'nan':\n        return 'Missing'\n    return cabin[0]\n\n# Use the map() method of the train DataFrame to apply the function above \n# to the 'Cabin' column. Store the results in a new column named 'Deck'. \n\ntest['Deck'] = test.Cabin.map(set_deck)\ntest.head()","71f1737d":"# Create a list of numberical feature names. Use the following features: 'Age', 'FamSize', 'Fare'\n# Create a list of categorical feature names. Use the following features: 'Sex', 'Pclass', 'Deck', 'Embarked'\n# Combine the two previous lists into one list named 'features'\n\nfeatures_numerical = ['Age', 'FamSize', 'Fare']\nfeatures_categorical = ['Sex', 'Pclass', 'Deck', 'Embarked']\nfeatures = features_numerical + features_categorical\nprint(\"features: \", features)\n","7811c3d6":"# preprocessor transform \nX_test = preprocessor.transform(test[features])\n\n#ensure test shape matches model shape\nprint(\"X_test.shape: \", X_test.shape)","b6a7959e":"# predict\ny_pred = model.predict(X_test)","0d4502bf":"# Load gender_submission.csv\nsubmission = pd.read_csv('..\/input\/titanic\/gender_submission.csv')\nsubmission.head()","3d21b093":"# add predictions\nsubmission['Survived'] = y_pred\nsubmission.head()","69ce9167":"submission.to_csv('submission.csv', index=False, header=True)","5b57ca78":"# Update Submission","31673482":"# Load test data","51cc3145":"# Preprocessing","54b411db":"# Load Model and pipeline","7b2b0065":"# Import Statements","e5ec6b1a":"# Predict "}}