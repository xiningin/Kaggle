{"cell_type":{"e220d6fc":"code","a0988c31":"code","a93bb51b":"code","591c3e60":"code","ee054d82":"code","60a29cfe":"code","494fc0c6":"code","854872b9":"code","5b247af8":"code","22815376":"code","3b3b69cc":"code","43a3bd1c":"code","ad0ccbac":"code","9caa91e1":"code","aa92e731":"code","b99f6bfb":"code","db998e4f":"code","b5fdb1ca":"code","3ce7c4a8":"code","8c632f41":"code","8f087d47":"code","1c60c9c5":"code","ca3e5aa2":"code","d0e8f279":"code","534bfb34":"code","f0291bbd":"code","fa88218b":"code","1d5c6d2c":"code","de1b3a74":"code","49dcef52":"code","1b509374":"code","184ad752":"code","4fe74143":"code","668da511":"code","9b1fbee8":"code","fcc61247":"code","b3a6495c":"code","3957da4a":"code","06b9bfd9":"code","6e71781c":"code","6a399d2b":"code","bead08f8":"code","cc16ebb3":"code","c368df8c":"code","4f7ab6fd":"code","21ae6ce8":"code","5abf48cb":"code","5e57c3d9":"code","c1505ef2":"markdown","cac8419f":"markdown","1515bdba":"markdown","afc1063f":"markdown","ac194e61":"markdown","eeb2ef83":"markdown","d4bda5f9":"markdown","35fe721e":"markdown","3b7744af":"markdown","27294525":"markdown","b175d392":"markdown","45973b35":"markdown","cdca59b6":"markdown","47ed07e7":"markdown","231bc1d6":"markdown","b34d398b":"markdown","3b0b4692":"markdown","f6b9b25e":"markdown","b4e37d79":"markdown","6215fc3b":"markdown","06d53f3c":"markdown","28ddaf8c":"markdown","b9855e83":"markdown","8ad11cda":"markdown","702b7e52":"markdown","44963e7d":"markdown","c34a3122":"markdown","3a166516":"markdown","75db66eb":"markdown"},"source":{"e220d6fc":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a0988c31":"admissions_data = pd.read_csv(\"\/kaggle\/input\/graduate-admissions\/Admission_Predict_Ver1.1.csv\", index_col = \"Serial No.\")","a93bb51b":"admissions_data.head()","591c3e60":"([any(pd.isnull(admissions_data[c])) for c in admissions_data.columns])","ee054d82":"sns.heatmap(admissions_data.drop(\"Chance of Admit \", axis = 1).corr(), annot = True)","60a29cfe":"sns.heatmap(admissions_data.corr(),annot = True) #With the target variable included","494fc0c6":"#sns.scatterplot(x = admissions_data[\"GRE Score\"], y = admissions_data[\"CGPA\"])\n#plt.figure(8,6)\nsns.lmplot(data = admissions_data, x = \"GRE Score\", y = \"CGPA\")","854872b9":"sns.lmplot(data = admissions_data,x = \"TOEFL Score\", y = \"SOP\")","5b247af8":"sns.distplot(admissions_data.loc[(admissions_data[\"Research\"] == 1) & (admissions_data[\"University Rating\"] == 5),\"Chance of Admit \"])\nplt.title(\"University Rating 5, With research\")","22815376":"sns.distplot(admissions_data.loc[(admissions_data[\"Research\"] == 0) & (admissions_data[\"University Rating\"] == 5),\"Chance of Admit \"])\nplt.title(\"University rating 5, without research\")","3b3b69cc":"sns.distplot(admissions_data.loc[(admissions_data[\"Research\"] == 1) & (admissions_data[\"University Rating\"] == 1),\"Chance of Admit \"])\nplt.title(\"University rating 1, with research\")","43a3bd1c":"sns.distplot(admissions_data.loc[(admissions_data[\"Research\"] == 0) & (admissions_data[\"University Rating\"] == 1),\"Chance of Admit \"])\nplt.title(\"University rating 1, without research\")","ad0ccbac":"sns.lmplot(data = admissions_data.loc[admissions_data[\"University Rating\"] == 5], x = \"CGPA\", y = \"Chance of Admit \")#y = admissions_data.loc[admissions_data[\"University Rating\"] == 5, \"Chance of Admit \"])\nplt.title(\"University rating = 5\")","9caa91e1":"\nsns.lmplot(data = admissions_data.loc[(admissions_data[\"University Rating\"] == 1) | (admissions_data[\"University Rating\"] == 5)], x = \"CGPA\", y = \"Chance of Admit \", hue = \"University Rating\")","aa92e731":"admissions_data.head()","b99f6bfb":"p = sns.lmplot(data = admissions_data.loc[admissions_data[\"University Rating\"] >= 4] ,x = \"CGPA\", y = \"Chance of Admit \", hue = \"Research\")\nplt.title(\"University rating 4 and 5\")","db998e4f":"#With research\nfrom sklearn.linear_model import LinearRegression\nwith_research = LinearRegression()\nwith_research.fit(admissions_data.loc[(admissions_data[\"University Rating\"] >= 4) & (admissions_data[\"Research\"] == 1), \"CGPA\"].values.reshape(-1,1),admissions_data.loc[(admissions_data[\"University Rating\"] >= 4) & (admissions_data[\"Research\"] == 1), \"Chance of Admit \"])\nwith_research.coef_","b5fdb1ca":"#Without research\nwithout_research = LinearRegression()\nwithout_research.fit(admissions_data.loc[(admissions_data[\"University Rating\"] >= 4) & (admissions_data[\"Research\"] == 0), \"CGPA\"].values.reshape(-1,1),admissions_data.loc[(admissions_data[\"University Rating\"] >= 4) & (admissions_data[\"Research\"] == 0), \"Chance of Admit \"])\nwithout_research.coef_","3ce7c4a8":"p = sns.lmplot(data = admissions_data.loc[(admissions_data[\"University Rating\"] >= 4) & ((admissions_data[\"LOR \"] == 5) | (admissions_data[\"LOR \"] < 3))] ,x = \"CGPA\", y = \"Chance of Admit \", hue = \"LOR \")\nplt.title(\"University rating 4 and 5\")","8c632f41":"sns.regplot(data = admissions_data.loc[(admissions_data[\"University Rating\"] >= 4) & (admissions_data[\"SOP\"] == 5)], x = \"CGPA\", y = \"Chance of Admit \", label = \"SOP = 5\")\nsns.regplot(data = admissions_data.loc[(admissions_data[\"University Rating\"] >= 4) & (admissions_data[\"SOP\"] == 3)], x = \"CGPA\", y = \"Chance of Admit \", label = \"SOP = 3\")\nplt.legend()\nplt.title(\"University rating 4 and 5\")","8f087d47":"sns.lmplot(data = admissions_data.loc[(admissions_data[\"University Rating\"] >= 4)], x = \"LOR \", y = \"SOP\")\nplt.title(\"University rating 4 and 5\")","1c60c9c5":"sns.distplot(admissions_data.loc[admissions_data[\"University Rating\"] == 5, \"Chance of Admit \"])\nplt.title(\"University rating = 5\")","ca3e5aa2":"sns.distplot(admissions_data.loc[admissions_data[\"University Rating\"] == 4, \"Chance of Admit \"])\nplt.title(\"University rating = 4\")","d0e8f279":"sns.distplot(admissions_data.loc[admissions_data[\"University Rating\"] == 3, \"Chance of Admit \"])\nplt.title(\"University rating = 3\")","534bfb34":"sns.distplot(admissions_data.loc[admissions_data[\"University Rating\"] == 2, \"Chance of Admit \"])\nplt.title(\"University rating = 2\")","f0291bbd":"sns.distplot(admissions_data.loc[admissions_data[\"University Rating\"] == 1, \"Chance of Admit \"])\nplt.title(\"University rating = 1\")","fa88218b":"from sklearn.preprocessing import StandardScaler\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.linear_model import LinearRegression, Ridge\nscale = StandardScaler()\npreprocessor = ColumnTransformer(transformers = [('standard_scaler',scale,[\"GRE Score\",\"TOEFL Score\",\"CGPA\"])],remainder = \"passthrough\")\nlr_model = LinearRegression()\nlr_pipeline = Pipeline([(\"preprocess\",preprocessor),(\"model\",lr_model)])\n","1d5c6d2c":"admissions_data.columns","de1b3a74":"from sklearn.model_selection import train_test_split","49dcef52":"X = admissions_data.copy()\ny = X[\"Chance of Admit \"]\nX.drop(\"Chance of Admit \",axis = 1, inplace = True)","1b509374":"X_train,X_val,y_train,y_val = train_test_split(X,y,train_size = 0.8)","184ad752":"lr_pipeline.fit(X_train,y_train)","4fe74143":"preds = lr_pipeline.predict(X_val)","668da511":"from sklearn.metrics import mean_absolute_error","9b1fbee8":"mean_absolute_error(y_val,preds)","fcc61247":"lr_model.coef_,lr_model.intercept_","b3a6495c":"X_train_processed = pd.DataFrame(preprocessor.transform(X_train))\nX_train_processed.head()\n#X_train_processed.head()\nX_train_processed.columns = [\"GRE Score\",\"TOEFL Score\",\"CGPA\",\"University Rating\", \"SOP\", \"LOR\",\"Research\"]","3957da4a":"from sklearn.ensemble import RandomForestRegressor","06b9bfd9":"rf_model = RandomForestRegressor(n_estimators = 100)","6e71781c":"from sklearn.model_selection import GridSearchCV","6a399d2b":"#param_grid = {\"rf_model__n_estimators\":np.arange(100,1100,100)}\nrf_pipeline = Pipeline([(\"preprocess\",preprocessor),(\"model\",rf_model)])","bead08f8":"rf_search = GridSearchCV(rf_pipeline,param_grid = {\"model__n_estimators\":np.arange(100,1100,100)},n_jobs = -1)","cc16ebb3":"rf_search.fit(X_train,y_train)","c368df8c":"rf_search.best_params_","4f7ab6fd":"rf_search.best_score_","21ae6ce8":"rf_model = RandomForestRegressor(n_estimators = rf_search.best_params_[\"model__n_estimators\"])","5abf48cb":"rf_pipeline = Pipeline([(\"preprocess\",preprocessor),(\"model\",rf_model)])\nrf_pipeline.fit(X_train,y_train)","5e57c3d9":"mean_absolute_error(rf_pipeline.predict(X_val),y_val)","c1505ef2":"## Let's check some assumptions","cac8419f":"Since the slopes aren't very distinct, let us get the actual data from a linear model","1515bdba":"Is there self selection? i.e., do students know what their caliber is and apply accordingly?\n\nHow to check this : Plot distributions of chance of admit for every university rating. The rationale is that if all students apply blindly to all institutions, the ones with higher rating will have a wider distribution simply because they'll have a lot of low quality applicants who have lower chances of admission. Given what we saw above, we expect that the lower rated universities should also have a similar distribution because they tend to reject the high quality applicants. ","afc1063f":"#### An aside - Checking bias in data. Is there self selection?","ac194e61":"### Does Research\/LOR\/SOP save you when your CGPA sucks?","eeb2ef83":"Preprocessing steps - StandardScale GRE, TOEFL, GPA","d4bda5f9":" ### Does doing research improve your chance of admit to a higher ranked institution?\nLet us plot a distribution of acceptance percentages for an institution ranked 5 and research 1 vs 0","35fe721e":"### Not so simple model - Random forest regressor","3b7744af":"### How much does CGPA matter when it comes to admissions at better institutions?","27294525":"**We do see that the peak is shifted for a higher ranked institution if research is included**","b175d392":"This is quite strange in fact. What we see here is that the top universities only seem to have applicants who pretty much get in, while the lower ranked  universities seem to have the distribution we expected. There seem to be two types of self-selection here. The Universities themselves seem to self select as we saw above, and then the students also seem to self-select (i.e., only the topmost dudes even apply to top universities, while the lower ranked ones seem to be everyone's \"safety school\"). This is seen from the skew in the admission chances for the highly rated ones, and then the numbers slowly falling as the rating drops.","45973b35":"SOP seems to work just like LOR. After all, LOR and SOP seem to be correlated","cdca59b6":"Research does not seem to influence acceptance a lot for much for lower rated universities","47ed07e7":"A weak correlation, but a correlation nonetheless","231bc1d6":"It's quite obvious here that higher the CGPA the better the admission probability when it comes to higher calibre institutions. Let's check the same for lower caliber institutions also","b34d398b":"Let's do a mega heatmap of correlations because we don't have a lot of data and this is doable","3b0b4692":"Some observations of this mega heatmap(s) \n* GRE Score highly correlated with TOEFL score (makes sense - Verbal part of GRE is a more difficult form of TOEFL after all)\n* GRE Score highly correlated with CGPA (honestly a new observation for me!)\n* GRE and Research not very high correlation compared to others (different skillsets)\n* Surprising that university rating seems to be highly correlated with parameters here - Given that the acceptance probability is peaking at 0.7 (i.e., only relatively high acceptances in this dataset), is there self selection happening?","f6b9b25e":"### Simple model - Linear Regression","b4e37d79":"### TOEFL vs SOP correlation (checking the long standing assumption that the dude with the best english writes the best SOPs)","6215fc3b":"### GRE vs GPA correlation","06d53f3c":"**Such correlation, much wow!**","28ddaf8c":"The linear model is off by 4% on an average. Let's understand the coefficients before jumping on to more \"correct\" models","b9855e83":"What we see here is that only the high GPA dudes even get good Letters of Recommendation (we do see a correlation of 0.64 for this in the table). In the small overlap region it definitely shows that a stellar letter of recommendation can improve one's chances by a few percentage points (5% or so). The orange line however seems to overtake the green one if extrapolated, which again reinforces the fact that high GPA + bad reco can have a higher chance of admission than low GPA + stellar reco (i.e., GPA is more important)","8ad11cda":"The model basically says CGPA is the biggest marker of admission (as we usually expect), but given the positive correlation as a whole, we can also say that everyone does their part, especially research which has the second highest weight. I think the positive weight to university rating comes from the bias in the training set","702b7e52":"What we conclude from here (life lessons)\n* Don't lose hope if a lower ranked university rejects you, if you think you have stellar records. The admit from the higher ranked one is coming right up\n* If your GPA sucks, try to get some research done. It increases your chances of getting in","44963e7d":"The \"no research\" line's slope is higher than the \"with research\" line's slope. This and the plot show that if you have low CGPA, research can save you, but if your CGPA is high enough your research becomes less and less important. ","c34a3122":"The random forest doesn't give that much of an improvement over the simple linear model","3a166516":"**Are universities self selecting? i.e., do lower rated universities voluntarily reject people with high CGPA? Looks like it!**","75db66eb":"Check fo NaNs"}}