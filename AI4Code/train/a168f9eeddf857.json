{"cell_type":{"b5c38062":"code","a1889ba9":"code","260e528b":"code","af8af212":"code","5732a26d":"code","7792ebe9":"markdown","653bfa6f":"markdown","df595f49":"markdown","637c91b3":"markdown","82b6de61":"markdown"},"source":{"b5c38062":"import numpy as np\nimport pandas as pd\nimport itertools\n\nfrom catboost import Pool, CatBoostClassifier, cv\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\n\nimport os\n\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","a1889ba9":"train_df = pd.read_csv('\/kaggle\/input\/tabular-playground-series-feb-2022\/train.csv')\ntest_df = pd.read_csv('\/kaggle\/input\/tabular-playground-series-feb-2022\/test.csv')\n\ntrain_df.info()\n\ntrain_df.isnull().sum()\n\ntrain_df.fillna(-999,inplace=True)\ntest_df.fillna(-999,inplace=True)\n\nx = train_df.drop('target',axis=1)\ny = train_df.target\n\nprint(x.dtypes)","260e528b":"cate_features_index = np.where(x.dtypes != float)[0]\nxtrain,xtest,ytrain,ytest = train_test_split(x,y,train_size=.85,random_state=1234)\nmodel = CatBoostClassifier(eval_metric='Accuracy', iterations=1000, learning_rate=0.0015, use_best_model=True,random_seed=555, od_type = \"Iter\",  od_wait = 500)\nmodel.fit(xtrain,ytrain,cat_features=cate_features_index,eval_set=(xtest,ytest))","af8af212":"pred = model.predict(test_df)\npred_list = list(itertools.chain(*pred))","5732a26d":"submission = pd.DataFrame({'row_id':test_df['row_id'],'target': pred_list})\n\nsubmission.to_csv('submission.csv',index=False)","7792ebe9":"# Make predict","653bfa6f":"# Set categorial features, split dataset, create Catboost classifier and fit it. ","df595f49":"# **Tabular Playground with Catboost**\n\n![image.png](attachment:7aa76c40-3ffa-421e-8412-c28e2c7739e9.png)","637c91b3":"# Lets load dataset!","82b6de61":"# Submission"}}