{"cell_type":{"d7e92809":"code","a77d58ad":"code","29e23e81":"code","60673e64":"code","6ba98d51":"code","775e0f1b":"code","10a9471f":"code","8af21d26":"code","7f8c1356":"code","c6dbd44b":"code","c39de952":"code","78b102b7":"code","45b64c52":"code","35b6f100":"code","30d134f2":"code","d613a44b":"code","1546b095":"code","ebddd4f5":"code","348547f2":"code","13be1704":"code","89dd0332":"code","379ddecd":"code","44eca88f":"code","4f177b3d":"code","7cc0758b":"code","2ab7fc2b":"code","878cc43e":"code","2f0da01d":"code","0321e70d":"code","accc1faa":"code","0dd3a6d0":"code","a3440ce3":"code","3b5faf9e":"code","4ff58987":"markdown","62eda30f":"markdown","6d74f883":"markdown","883033e1":"markdown","2f4ebf72":"markdown"},"source":{"d7e92809":"import warnings\nwarnings.filterwarnings('ignore')\nimport numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt \nfrom sklearn.cluster import KMeans \n%matplotlib inline","a77d58ad":"Income_df = pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")","29e23e81":"import pandas_profiling","60673e64":"Income_df.profile_report()","6ba98d51":"import pandas as pd\nIncome_df = pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")\nIncome_df.head()","775e0f1b":"Income_df['Gender'] = Income_df['Gender'].map({'Male': 1, 'Female': 0})\nIncome_df.head()","10a9471f":"Income_df.describe()","8af21d26":"from sklearn.preprocessing import StandardScaler\nX = Income_df.values[:,1:]\nX = np.nan_to_num(X)\nClus_dataSet = StandardScaler().fit_transform(X)\nClus_dataSet[0:5]","7f8c1356":"clusterNum = 5\nk_means = KMeans(init = \"k-means++\", n_clusters = clusterNum, n_init = 12)\nk_means.fit(X)\nlabels = k_means.labels_\nprint(labels)","c6dbd44b":"Income_df[\"Clus_km\"] = labels\nIncome_df.head(5)","c39de952":"Income_df.groupby('Clus_km').mean()","78b102b7":"area = np.pi * ( X[:, 2])\nplt.scatter(X[:, 1], X[:, 3], s=area, c=labels.astype(np.float), alpha=0.5)\nplt.xlabel('Age', fontsize=18)\nplt.ylabel('Spedning Score', fontsize=16)\n\nplt.show()\n","45b64c52":"from mpl_toolkits.mplot3d import Axes3D \nfig = plt.figure(1, figsize=(8, 6))\nplt.clf()\nax = Axes3D(fig, rect=[0, 0, .95, 1], elev=48, azim=134)\n\nplt.cla()\n# plt.ylabel('Age', fontsize=18)\n# plt.xlabel('Income', fontsize=16)\n# plt.zlabel('Education', fontsize=16)\nax.set_xlabel('Spedning Score')\nax.set_ylabel('Age')\nax.set_zlabel('Income')\n\nax.scatter(X[:, 3], X[:, 1], X[:, 2], c= labels.astype(np.float))","35b6f100":"import numpy as np \nimport pandas as pd\nfrom scipy import ndimage \nfrom scipy.cluster import hierarchy \nfrom scipy.spatial import distance_matrix \nfrom matplotlib import pyplot as plt \nfrom sklearn import manifold, datasets \nfrom sklearn.cluster import AgglomerativeClustering \nimport pylab\n%matplotlib inline","30d134f2":"Income_df = pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")\nIncome_df['Gender'] = Income_df['Gender'].map({'Male': 1, 'Female': 0})\nIncome_df.head()","d613a44b":"featureset = Income_df.copy().drop('CustomerID', axis = 1)\nfeatureset.head()","1546b095":"from sklearn.preprocessing import MinMaxScaler\nx = featureset.values\nmin_max_scaler = MinMaxScaler()\nfeature_mtx = min_max_scaler.fit_transform(x)\nfeature_mtx [0:5]","ebddd4f5":"from sklearn.metrics.pairwise import euclidean_distances\ndist_matrix = euclidean_distances(feature_mtx,feature_mtx) \nprint(dist_matrix)","348547f2":"import scipy.cluster.hierarchy\nZ_using_dist_matrix = hierarchy.linkage(dist_matrix, 'complete')\npdf = pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")","13be1704":"fig = pylab.figure(figsize=(18,50))\ndef llf(id):\n    return '[%s %s %s %s %s %s]' % ( pdf['Age'][id] ,\"Years old\" , pdf['Gender'][id], \"with\" , pdf['Annual Income (k$)'][id], \"k$ Income\")\n    \ndendro = hierarchy.dendrogram(Z_using_dist_matrix,  leaf_label_func=llf, leaf_rotation=0, leaf_font_size =12, orientation = 'right')","89dd0332":"agglom = AgglomerativeClustering(n_clusters = 5, linkage = 'complete')\nagglom.fit(dist_matrix)\nagglom.labels_","379ddecd":"pdf['cluster_'] = agglom.labels_\npdf.head()","44eca88f":"import matplotlib.cm as cm\nn_clusters = max(agglom.labels_)+1\ncolors = cm.rainbow(np.linspace(0, 1, n_clusters))\ncluster_labels = list(range(0, n_clusters))\n\n# Create a figure of size 6 inches by 4 inches.\nplt.figure(figsize=(10,10))\n\nfor color, label in zip(colors, cluster_labels):\n    subset = pdf[pdf.cluster_ == label]\n    for i in subset.index:\n            plt.text(subset.Age[i], subset['Spending Score (1-100)'][i],str(subset['Gender'][i]), rotation=25) \n    plt.scatter(subset.Age, subset['Spending Score (1-100)'], s= subset['Annual Income (k$)']*5, c=color, label='cluster'+str(label),alpha=0.5)\n#    plt.scatter(subset.horsepow, subset.mpg)\nplt.legend()\nplt.title('Clusters')\nplt.xlabel('Age')\nplt.ylabel('Spending Score (1-100)')","4f177b3d":"pdf.groupby(['cluster_'])['cluster_'].count()","7cc0758b":"pdf['Gender'] = pdf['Gender'].map({'Male': 1, 'Female': 0})","2ab7fc2b":"agg_Incomes = pdf.groupby(['cluster_'])['Gender','Age','Annual Income (k$)','Spending Score (1-100)'].mean()\nagg_Incomes","878cc43e":"import numpy as np \nfrom sklearn.cluster import DBSCAN \nfrom sklearn.preprocessing import StandardScaler \nimport matplotlib.pyplot as plt \n%matplotlib inline","2f0da01d":"Income_df = pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")\nIncome_df['Gender'] = Income_df['Gender'].map({'Male': 1, 'Female': 0})\nIncome_df.head()","0321e70d":"from sklearn.preprocessing import StandardScaler\nX = Income_df.values[:,1:]\nX = np.nan_to_num(X)\nX = StandardScaler().fit_transform(X)\nX[0:5]","accc1faa":"epsilon = 0.8\nminimumSamples = 3\ndb = DBSCAN(eps=epsilon, min_samples=minimumSamples).fit(X)\nlabels = db.labels_\nlabels","0dd3a6d0":"core_samples_mask = np.zeros_like(db.labels_, dtype=bool)\ncore_samples_mask[db.core_sample_indices_] = True\ncore_samples_mask[0:10]","a3440ce3":"n_clusters_ = len(set(labels)) - (1 if -1 in labels else 0)\nn_clusters_","3b5faf9e":"unique_labels = set(labels)\nunique_labels","4ff58987":"# DBSCAN","62eda30f":"We are going to use three clustering methods: \n\n1.K-Mens <br>\n2.Hierarchical <br>\n3.DBSCAN","6d74f883":"# K-Means","883033e1":"# Mall Customer Segmentation Data\n\nYou can find the description of the data [here](https:\/\/www.kaggle.com\/vjchoudhary7\/customer-segmentation-tutorial-in-python)","2f4ebf72":"# Hierarchical Clustering"}}