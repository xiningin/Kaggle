{"cell_type":{"d75a2f9e":"code","1270ee16":"code","03cf3cd7":"code","f4f60a12":"code","49c1fb6b":"code","78b6961c":"code","45924afb":"code","739ca1be":"code","add531b2":"markdown","c6c079ba":"markdown","34e1559c":"markdown"},"source":{"d75a2f9e":"import numpy as np \nimport pandas as pd \nimport datetime\nimport plotly.graph_objects as go\nfrom ipywidgets import widgets","1270ee16":"df = pd.read_csv(\"\/kaggle\/input\/golden-globe-awards\/golden_globe_awards.csv\")","03cf3cd7":"df.head()","f4f60a12":"# creating a column comprised of year or award, nominee, and category with html formatting.\ndf['list_of_awards'] = \"<br>\"+df.year_award.apply(str) + \": \"  + \"(\" + df.nominee + \") \"+ df.category\ndf.head()","49c1fb6b":"# count number of wins and losses for each film\ni = pd.crosstab(index=[df['win'], df['film']],columns=[df['win']]).reset_index()\n\n# put all wins and loss details into a single column\ni['details'] = df.groupby(['win','film'])['list_of_awards'].apply(list).values\n\n# change the details into a list. Getting rid of any duplicate values won't work for lists as they aren't hashable in a dataframe.\ni.details = i.details.apply(lambda x: str(x).strip('[]'))\n\n# split details into two columns (winners\/losers)\ni['details_win'] = i.details\ni['details_lost'] = i.details\ni.loc[i.win, 'details_lost'] = \"\"\ni.loc[~i.win, 'details_win'] = \"\"\n\ntotal_wins_losses = i.groupby('film')[[False,True]].sum().reset_index()\ntotal_wins_losses['details_win'] = i.groupby('film')['details_win'].max().values\ntotal_wins_losses['details_lost'] = i.groupby('film')['details_lost'].max().values\ntotal_wins_losses['year'] = df.groupby('film')['year_award'].max().values\ntotal_wins_losses['nominations'] = total_wins_losses[False] + total_wins_losses[True]\n\n# split shows and films up based on number of years 'film' has been nominated.\nyears_nominated = df.groupby(['year_award','film'])['year_film'].count().reset_index()\nyears_nominated = years_nominated.groupby(['film'])['year_award'].count().reset_index()\nfilms = years_nominated[years_nominated.year_award == 1].film.values\nshows = years_nominated[~(years_nominated.year_award == 1)].film.values","78b6961c":"# slider to filter dates of 'film'\nyear = widgets.IntSlider(\n    value=total_wins_losses.year.min(),\n    min=total_wins_losses.year.min(),\n    max=total_wins_losses.year.max(),\n    step=1.0,\n    description='Year:',\n    continuous_update=False\n)\n\n# dropdown box\ntextbox = widgets.Dropdown(\n    description='Film or TV Show:',\n    value='Films',\n    options=['TV Shows','Films']\n)\nshow_or_film = {'TV Shows': shows, 'Films': films}\n\n# data shown when plot is first initialised\ndf2 = total_wins_losses[(total_wins_losses.film.isin(show_or_film[textbox.value])) & \n                      (total_wins_losses.year >= year.value)].sort_values(by=[True,False], ascending=False)[:15]\n\n# assigning an empty figure widget with two traces\ntrace1 = go.Bar(x=df2.film[:15], y=df2[True], name='Won', hovertext=df2.details_win)\ntrace2 = go.Bar(x=df2.film[:15], y=df2[False], name='Lost', hovertext=df2.details_lost)\ng = go.FigureWidget(data=[trace1, trace2],\n                    layout=go.Layout(\n                        title=str(textbox.value +\" with most wins since \" + str(year.value)),\n                        barmode='stack'\n                    ))","45924afb":"# updating the data whenever a widget is changed.\ndef response(change):\n    \n    df2 = total_wins_losses[(total_wins_losses.film.isin(show_or_film[textbox.value])) & \n                      (total_wins_losses.year >= year.value)].sort_values(by=[True,False], ascending=False)[:15]\n    \n    with g.batch_update():\n        g.data[0].x = df2.film\n        g.data[1].x = df2.film\n        \n        g.data[0].y = df2[True]\n        g.data[1].y = df2[False]\n        \n        g.data[0].hovertext = df2.details_win\n        g.data[1].hovertext = df2.details_lost\n        \n        g.layout.barmode = 'stack'\n        g.layout.xaxis.title = textbox.value\n        g.layout.title = str(textbox.value +\" with most wins since \" + str(year.value))\n\nyear.observe(response, names=\"value\")\ntextbox.observe(response, names=\"value\")","739ca1be":"container = widgets.HBox([year, textbox])\nwidgets.VBox([container, g])","add531b2":"Please upvote if you liked this notebook.","c6c079ba":"# Interactive Visualisation using Plotly","34e1559c":"You will need to run this notebook for the chart to update. If you do know a way to update the chart without forking the notebook I'd love to hear from you."}}