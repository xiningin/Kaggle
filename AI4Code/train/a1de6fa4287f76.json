{"cell_type":{"b6f19762":"code","da3251a2":"code","94b22eaf":"code","50854f3c":"code","91f2a54e":"code","242fb5ab":"code","be04df07":"code","164dcb14":"code","70a59b36":"code","f2f39a6a":"code","c2fc2aa3":"code","835b68b4":"code","7bcfec5d":"code","fb7d9eba":"code","16be502e":"code","62388af0":"code","3750c633":"code","9d69241c":"markdown","a19f35cb":"markdown","21054edc":"markdown","d3b23ae6":"markdown","85c9f2ae":"markdown","589a88be":"markdown","3bbb4aef":"markdown","5d338ba9":"markdown","ab7f54df":"markdown","8d7f7583":"markdown","1bcd52ca":"markdown","721c47e3":"markdown","2f58c96d":"markdown","e9fb5e3c":"markdown"},"source":{"b6f19762":"!pip install h2o","da3251a2":"import h2o\nfrom h2o.automl import H2OAutoML\nimport sys\nimport os\nimport math\nimport time\nimport random\nimport shutil\nfrom pathlib import Path\nfrom sklearn.model_selection import train_test_split, KFold\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.metrics import mean_squared_error\n\nimport scipy as sp\nimport numpy as np\nimport pandas as pd\nfrom sklearn.metrics import accuracy_score, mean_squared_error\n","94b22eaf":"train = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/train.csv')\ntrain","50854f3c":"train = train.drop(['id'],axis=1)\ntrain","91f2a54e":"train_add = pd.read_csv('..\/input\/tabular-denoising-residual-network\/yoof.csv')\ntrain_add = train_add.rename(columns={'loss':'pred'})\ntrain_add = train_add.drop(['ID'],axis=1)\ntrain = pd.concat([train,train_add],axis=1)\ntrain","242fb5ab":"target = train.loss\nx_train, x_test, y_train, y_test = train_test_split(train, target, test_size=0.2, random_state=42)","be04df07":"feature_columns = train.columns.values\nfeature_columns =feature_columns[:-2]\ntarget_column = 'loss'","164dcb14":"test = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/test.csv')\ntest = test.drop(['id'],axis=1)\ntest","70a59b36":"test_add = pd.read_csv('..\/input\/tabular-denoising-residual-network\/submission.csv')\ntest_add = test_add.rename(columns={'loss':'pred'})\ntest_add = test_add.drop(['ID'],axis=1)\ntest = pd.concat([test,test_add],axis=1)\ntest","f2f39a6a":"h2o.init()","c2fc2aa3":"x_train_hf = h2o.H2OFrame(x_train.copy())\nx_test_hf = h2o.H2OFrame(x_test.copy())","835b68b4":"aml = H2OAutoML(\n    seed=2021, \n    max_runtime_secs=100,\n    nfolds = 3,\n    exclude_algos = [\"DRF\"]\n)\n\naml.train(\n    x=list(feature_columns), \n    y=target_column, \n    training_frame=x_train_hf\n)","7bcfec5d":"x_train_hf[target_column] = x_train_hf[target_column].asfactor()\nlb = aml.leaderboard \nlb.head(rows = lb.nrows)","fb7d9eba":"preds = aml.predict(h2o.H2OFrame(x_test[feature_columns].copy()))\npreds_df = h2o.as_list(preds)\n","16be502e":"print('#############',np.sqrt(mean_squared_error(y_test, preds_df)),mean_squared_error(y_test, preds_df))","62388af0":"preds = aml.predict(h2o.H2OFrame(test[feature_columns].copy()))\npreds_df = h2o.as_list(preds)\npreds_df","3750c633":"sub = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/sample_submission.csv')\nsub.loss = preds_df\nsub.to_csv('submit.csv',index=False)\nsub","9d69241c":"\u3299\ud83d\udd30\ud83d\uddd1\u2b1b\ud83d\udfe5\ud83d\udfe8\ud83d\udfe9","a19f35cb":"<span style=\"color: orange; font-family: Segoe UI; font-size: 1.9em; font-weight: 300;\">Convert<\/span>","21054edc":" <pre>\n [\"DeepLearning\"] 7.97218\n [\"DRF\"]","d3b23ae6":"<span style=\"color: orange; font-family: Segoe UI; font-size: 1.9em; font-weight: 300;\">Evaluation<\/span>","85c9f2ae":"<span style=\"color: orange; font-family: Segoe UI; font-size: 1.9em; font-weight: 300;\">Setting<\/span>","589a88be":"![image.png](attachment:d121460a-300c-4d98-b4c2-ca30645d4621.png)","3bbb4aef":"![image.png](attachment:29cf6855-c7ba-4a9c-a9cc-6496ca4974b6.png)","5d338ba9":"<span style=\"color: orange; font-family: Segoe UI; font-size: 1.9em; font-weight: 300;\">H2O Start<\/span>","ab7f54df":"<span style=\"color: orange; font-family: Segoe UI; font-size: 1.9em; font-weight: 300;\">Inferece<\/span>","8d7f7583":"<span style=\"color: orange; font-family: Segoe UI; font-size: 1.9em; font-weight: 300;\">Training<\/span>","1bcd52ca":"### AutoML H2O","721c47e3":"### Final submission deadline - August 31, 2021","2f58c96d":"DRF (including both the Random Forest and Extremely Randomized Trees (XRT) models)\n\nGLM\n\nXGBoost (XGBoost GBM)\n\nGBM (H2O GBM)\n\nDeepLearning (Fully-connected multi-layer artificial neural network)\n\nStackedEnsemble","e9fb5e3c":"<span style=\"color: orange; font-family: Segoe UI; font-size: 1.9em; font-weight: 300;\">Submit<\/span>"}}