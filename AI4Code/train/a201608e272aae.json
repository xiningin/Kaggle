{"cell_type":{"822b637a":"code","d9469cc6":"code","c0e978ee":"code","1503f0bb":"code","876843fd":"code","2d626979":"code","30987808":"code","c0557b57":"code","3455e8d5":"code","baa26ccd":"code","c31855a6":"code","4e70cfe7":"code","8753df9e":"code","5e83e1a9":"code","a400164a":"code","5a2fb71d":"code","94a57ad9":"code","57efc477":"code","62a65f75":"code","808964bb":"code","6d776b61":"code","2053d3cb":"code","e07e10d9":"code","b4e63bf6":"code","a4a69038":"code","6ff430a1":"markdown","2d277fca":"markdown","aa7030ac":"markdown"},"source":{"822b637a":"import numpy as np \nimport pandas as pd \nimport os\nimport glob\nimport json\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nfrom collections import Counter\nimport gc\nfrom PIL import Image\n\n%matplotlib inline","d9469cc6":"!ls \/kaggle\/input\/imet-2020-fgvc7\/","c0e978ee":"train_df = pd.read_csv(\"\/kaggle\/input\/imet-2020-fgvc7\/train.csv\")\ntest_df = pd.read_csv(\"\/kaggle\/input\/imet-2020-fgvc7\/sample_submission.csv\")\nlabels_df = pd.read_csv(\"\/kaggle\/input\/imet-2020-fgvc7\/labels.csv\")","1503f0bb":"print(\"Train\", train_df.shape)\ntrain_df.sample(10).head()","876843fd":"print(\"Test\", test_df.shape)\ntest_df.sample(10).head()","2d626979":"labels_df.sample(10).head(10)","30987808":"labels_df[\"attribute_type\"] = labels_df.attribute_name.apply(lambda x: x.split(\"::\")[0])\nprint(labels_df[\"attribute_type\"].value_counts())\nsns.countplot(labels_df.attribute_type)","c0557b57":"labels_df.attribute_id.nunique()","3455e8d5":"1920 + 768 + 681 + 100 + 5 # number of attributes = N_CLASSES","baa26ccd":"labels_df.attribute_type.unique()","c31855a6":"labels_df[labels_df.attribute_type == \"tags\"]","4e70cfe7":"# https:\/\/www.kaggle.com\/ttahara\/eda-compare-number-of-culture-and-tag-attributes\ntrain_attr_ohot = np.zeros((len(train_df), len(labels_df)), dtype=int)\n\nfor idx, attr_arr in enumerate(train_df.attribute_ids.str.split(\" \").apply(lambda l: list(map(int, l))).values):\n    train_attr_ohot[idx, attr_arr] = 1\n    \nnames_arr = labels_df.attribute_name.values\ntrain_df[\"attribute_names\"] = [\", \".join(names_arr[arr == 1]) for arr in train_attr_ohot]\n\ntrain_df[\"attr_num\"] = train_attr_ohot.sum(axis=1)\ntrain_df[\"culture_attr_num\"] = train_attr_ohot[:, :398].sum(axis=1)\ntrain_df[\"tag_attr_num\"] = train_attr_ohot[:, 398:].sum(axis=1)","8753df9e":"# https:\/\/www.kaggle.com\/ttahara\/eda-compare-number-of-culture-and-tag-attributes\nfig = plt.figure(figsize=(5 * 5, 5 * 6))\nfig.subplots_adjust(wspace=0.5, hspace=0.5)\nfor i, (art_id, attr_names) in enumerate(train_df.sort_values(by=\"culture_attr_num\", ascending=False)[[\"id\", \"attribute_names\"]].values[:15]):\n    ax = fig.add_subplot(5, 3, i \/\/ 3 * 3 + i % 3 + 1)\n    im = Image.open(\"\/kaggle\/input\/imet-2020-fgvc7\/train\/{}.png\".format(art_id))\n    ax.imshow(im)\n    im.close()\n    attr_split = attr_names.split(\", \")\n    attr_culture = list(map(lambda x: x.split(\"::\")[-1], filter(lambda x: x[:7] == \"culture\", attr_split)))\n    attr_tag = list(map(lambda x: x.split(\"::\")[-1], filter(lambda x: x[:3] == \"tag\", attr_split)))\n    ax.set_title(\"art id: {}\\nculture: {}\\ntag: {}\".format(art_id, attr_culture, attr_tag))","5e83e1a9":"# https:\/\/www.kaggle.com\/ttahara\/eda-compare-number-of-culture-and-tag-attributes\nfig = plt.figure(figsize=(5 * 6, 5 * 5))\nfig.subplots_adjust(wspace=0.6, hspace=0.6)\nfor i, (art_id, attr_names) in enumerate(train_df.sort_values(by=\"tag_attr_num\", ascending=False)[[\"id\", \"attribute_names\"]].values[:12]):\n    ax = fig.add_subplot(4, 3, i \/\/ 3 * 3 + i % 3 + 1)\n    im = Image.open(\"\/kaggle\/input\/imet-2020-fgvc7\/train\/{}.png\".format(art_id))\n    ax.imshow(im)\n    im.close()\n    attr_split = attr_names.split(\", \")\n    attr_culture = list(map(lambda x: x.split(\"::\")[-1], filter(lambda x: x[:6] == \"culture\", attr_split)))\n    attr_tag = list(map(lambda x: x.split(\"::\")[-1], filter(lambda x: x[:3] == \"tag\", attr_split)))\n    ax.set_title(\"art id: {}\\nculture: {}\\ntag: {}\".format(art_id, attr_culture, attr_tag))","a400164a":"# https:\/\/www.kaggle.com\/ttahara\/eda-compare-number-of-culture-and-tag-attributes\nfig = plt.figure(figsize=(5 * 8, 5 * 7))\nfig.subplots_adjust(wspace=0.6, hspace=0.6)\nfor i, (art_id, attr_names) in enumerate(train_df[train_df.tag_attr_num == 1][[\"id\", \"attribute_names\"]].values[:49]):\n    ax = fig.add_subplot(7, 7, i \/\/ 7 * 7 + i % 7 + 1)\n    im = Image.open(\"\/kaggle\/input\/imet-2020-fgvc7\/train\/{}.png\".format(art_id))\n    ax.imshow(im)\n    im.close()\n    attr_split = attr_names.split(\", \")\n    attr_culture = list(map(lambda x: x.split(\"::\")[-1], filter(lambda x: x[:7] == \"culture\", attr_split)))\n    attr_tag = list(map(lambda x: x.split(\"::\")[-1], filter(lambda x: x[:3] == \"tag\", attr_split)))\n    ax.set_title(\"art id: {}\\nculture: {}\\ntag: {}\".format(art_id, attr_culture, attr_tag))","5a2fb71d":"fig = plt.figure(figsize=(5 * 8, 5 * 7))\nfig.subplots_adjust(wspace=0.6, hspace=0.6)\nfor i, (art_id, attr_names) in enumerate(train_df[train_df.tag_attr_num == 2][[\"id\", \"attribute_names\"]].values[:49]):\n    ax = fig.add_subplot(7, 7, i \/\/ 7 * 7 + i % 7 + 1)\n    im = Image.open(\"\/kaggle\/input\/imet-2020-fgvc7\/train\/{}.png\".format(art_id))\n    ax.imshow(im)\n    im.close()\n    attr_split = attr_names.split(\", \")\n    attr_culture = list(map(lambda x: x.split(\"::\")[-1], filter(lambda x: x[:7] == \"culture\", attr_split)))\n    attr_tag = list(map(lambda x: x.split(\"::\")[-1], filter(lambda x: x[:3] == \"tag\", attr_split)))\n    ax.set_title(\"art id: {}\\nculture: {}\\ntag: {}\".format(art_id, attr_culture, attr_tag))","94a57ad9":"fig = plt.figure(figsize=(5 * 8, 5 * 7))\nfig.subplots_adjust(wspace=0.6, hspace=0.6)\nfor i, (art_id, attr_names) in enumerate(train_df[train_df.tag_attr_num == 3][[\"id\", \"attribute_names\"]].values[:49]):\n    ax = fig.add_subplot(7, 7, i \/\/ 7 * 7 + i % 7 + 1)\n    im = Image.open(\"\/kaggle\/input\/imet-2020-fgvc7\/train\/{}.png\".format(art_id))\n    ax.imshow(im)\n    im.close()\n    attr_split = attr_names.split(\", \")\n    attr_culture = list(map(lambda x: x.split(\"::\")[-1], filter(lambda x: x[:7] == \"culture\", attr_split)))\n    attr_tag = list(map(lambda x: x.split(\"::\")[-1], filter(lambda x: x[:3] == \"tag\", attr_split)))\n    ax.set_title(\"art id: {}\\nculture: {}\\ntag: {}\".format(art_id, attr_culture, attr_tag))","57efc477":"train20 = pd.read_csv(\"\/kaggle\/input\/imet-2020-fgvc7\/train.csv\")\ntest20 = pd.read_csv(\"\/kaggle\/input\/imet-2020-fgvc7\/sample_submission.csv\")\nlabels20 = pd.read_csv(\"\/kaggle\/input\/imet-2020-fgvc7\/labels.csv\")","62a65f75":"train19 = pd.read_csv(\"\/kaggle\/input\/imet-2019-fgvc6\/train.csv\")\ntest19 = pd.read_csv(\"\/kaggle\/input\/imet-2019-fgvc6\/sample_submission.csv\")\nlabels19 = pd.read_csv(\"\/kaggle\/input\/imet-2019-fgvc6\/labels.csv\")","808964bb":"train20.shape, train19.shape","6d776b61":"np.intersect1d(train20.id.values , train19.id.values)","2053d3cb":"train19.head()","e07e10d9":"labels19.head()","b4e63bf6":"labels19[\"attribute_type\"] = labels19.attribute_name.apply(lambda x: x.split(\"::\")[0])\nprint(labels19[\"attribute_type\"].value_counts())\nsns.countplot(labels19.attribute_type)","a4a69038":"print (labels20.attribute_name.nunique())\nprint (labels19.attribute_name.nunique())\nprint (np.intersect1d(labels20.attribute_name.values , labels19.attribute_name.values).shape)","6ff430a1":"## Labels","2d277fca":"# 2020 vs 2019 Dataset","aa7030ac":"![](https:\/\/storage.googleapis.com\/kaggle-competitions\/kaggle\/13251\/logos\/header.png?t=2019-03-14-16-01-52)\n\n<br>\n\nJust simple visualization and quick insights ...\n\nBased on last year: https:\/\/www.kaggle.com\/ttahara\/eda-compare-number-of-culture-and-tag-attributes\n\n**I will hash the images and detect the repeated images between 2019 and 2020 data so we can identify the new images :)**\n\n```\nIn this dataset, you are presented with a large number of artwork images and associated attributes of the art. \nThe dataset has been expanded from the 2019 edition of this competition. \nMultiple modalities can be expected and the camera sources are unknown. \nThe photographs are often centered for objects, and in the case where the museum artifact is an entire room, the images are scenic in nature.\n```"}}