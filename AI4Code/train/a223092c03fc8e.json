{"cell_type":{"93e74fa2":"code","449efb68":"code","a3ede0db":"code","4cfdcec0":"code","f8bf6146":"code","455e3d7c":"code","2068392f":"markdown","feed9558":"markdown","9c81f611":"markdown","ccf36b01":"markdown","191ce655":"markdown"},"source":{"93e74fa2":"# Load everything\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns # visualizations\nimport os","449efb68":"# Read data\ndata_csv = \"\/kaggle\/input\/ecommerce-events-history-in-cosmetics-shop\/2019-Oct.csv\"\nraw_data = pd.read_csv(data_csv)\n\n# Get only purchases\nonly_purchases = raw_data.loc[raw_data.event_type == 'purchase']","a3ede0db":"raw_data.head()","4cfdcec0":"# With brands only\npurchases_with_brands = only_purchases.loc[only_purchases.brand.notnull()]\ntop_sellers = purchases_with_brands.groupby('brand').brand.agg([len]).sort_values(by='len', ascending=False)\ntop_sellers.head(20)","f8bf6146":"raw_data.loc[raw_data.user_session == \"26dd6e6e-4dac-4778-8d2c-92e149dab885\"].sort_values(by='event_time')","455e3d7c":"raw_data.loc[raw_data.user_id == 10280338].sort_values(by='event_time')","2068392f":"## Read data\n\nAnd prepare some filtered datasets. Keep in mind: this file contains about 42M rows, so it loads slowly.","feed9558":"# Data overview","9c81f611":"## All events of the same user","ccf36b01":"## User's journey\n\nThis example shows a common flow of a random user: what she\/he looked and what bought.","191ce655":"## Brands popularity\n\nShows the most popular brands (by total sales):"}}