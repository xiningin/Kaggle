{"cell_type":{"cb648812":"code","8c96e23c":"code","a5579d63":"code","9d519d7f":"code","2c77dbbd":"code","e83336e0":"code","12f67faf":"code","c2b70fb8":"code","f0e28162":"code","3110590c":"code","b3d0b910":"code","a91705d6":"code","1231414d":"code","c0ccc664":"code","69950b1f":"code","d029ed84":"code","7d68a0ed":"code","eb676b41":"code","80af3ffc":"code","8795731e":"code","f2409705":"code","a300781f":"code","e90c4c84":"code","15e2e0d2":"code","767a09af":"code","7d715ab2":"code","9e75baf5":"markdown","7c85965f":"markdown","a938f86e":"markdown","0a316513":"markdown","7e1d5ceb":"markdown","566dbf25":"markdown","19547f0e":"markdown","abfed2e3":"markdown","acf3cbab":"markdown","773d9cf4":"markdown","757a62ad":"markdown"},"source":{"cb648812":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score,classification_report,confusion_matrix","8c96e23c":"#Read train data\ntrain_data=pd.read_csv('..\/input\/digit-recognizer\/train.csv')\ntrain_data.head()","a5579d63":"#No.of Train data's row and column\ntrain_data.shape","9d519d7f":"#Read test data\ntest_data=pd.read_csv('..\/input\/digit-recognizer\/test.csv')\ntest_data.head()","2c77dbbd":"#NO. of Test data's row and column\ntest_data.shape","e83336e0":"#viewing the 4th row of train_data\na=train_data.iloc[3,1:].values\na=a.reshape(28,28)\nplt.imshow(a)","12f67faf":"#Label of 4th row\ntrain_data.iloc[3,0]","c2b70fb8":"x=train_data.iloc[:,1:]\ny=train_data.iloc[:,0]","f0e28162":"#Creating training and testing samples from train_data with a ratio of 7:3(train:test)\nfrom sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test=train_test_split(x,y,train_size=0.7,random_state=42)","3110590c":"model=RandomForestClassifier(n_estimators=200,max_samples=0.5)\nmodel.fit(x_train,y_train)","b3d0b910":"#Predicting the testing sample of train_data\npred=model.predict(x_test)","a91705d6":"#accuracy of training sample of train_data\nmodel.score(x_train,y_train)","1231414d":"#accuracy of testing sample of train_data\nmodel.score(x_test,y_test)","c0ccc664":"confusion_matrix(pred,y_test)","69950b1f":"print(classification_report(pred,y_test))","d029ed84":"#first 5 values of testing sample of train_data\ny_test[0:5]","7d68a0ed":"#first 5 values of predicting samples\npred[0:5]","eb676b41":"prediction=model.predict(test_data)\nprediction","80af3ffc":"prediction.shape","8795731e":"#Visualizing the 3rd row of test_data\nb=test_data.iloc[2,0:].values\nb=b.reshape(28,28)\nplt.imshow(b)","f2409705":"#The 3rd value of prediction data\nprediction[3]","a300781f":"#Visualizing the 1st row of test_data\nb1=test_data.iloc[0,0:].values\nb1=b1.reshape(28,28)\nplt.imshow(b1)","e90c4c84":"#1st value of prediction data\nprediction[0]","15e2e0d2":"print(\"Predicted \"+ str(y_test.iloc[np.where(y_test!=pred)[0][3]]) + \" as \"+str(pred[np.where(y_test!=pred)[0][3]]) )\nplt.imshow(np.array(x_test.iloc[np.where(y_test!=pred)[0][3]]).reshape(28,28))","767a09af":"np.where(train_data['label']==5)","7d715ab2":"b=train_data.iloc[51,1:].values\nb=b.reshape(28,28)\nplt.imshow(b)","9e75baf5":"Thus we can see that the model is predicting accurately all the five data.","7c85965f":"First import all the required libraries","a938f86e":"Now we can predict the output for the test_data using the above model","0a316513":"Using Random Classifier to build a model to predict the output of test_data.","7e1d5ceb":"Now we will crosscheck 5 values from the testing sample of train_data with predicted data","566dbf25":"**Viewing a random data from train_data and check with its label**","19547f0e":"Now we will see the wrongly predicted values and visualize the input digit. ","abfed2e3":"From Classification report we can see that the model has an accuracy of 96%.","acf3cbab":"Here 5 is assumed to be 3 by the model as the actual 5 learned by the model can be seen below: ","773d9cf4":"Here both the data are predicted correctly. Hence we can say that the model is pretty much useful in predicting handwritten digit.","757a62ad":"**Now we will first visualize some rows of test_data using matplot library and then check that image with the value of our predicted data**"}}