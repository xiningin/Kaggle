{"cell_type":{"c44a50d7":"code","a385fcfb":"code","5e96acc5":"code","7cab28ef":"code","7897854c":"code","6c0b2573":"code","47e0d7d9":"code","14939098":"code","e8c4d31b":"code","811b2472":"code","1632cf94":"code","639e5315":"code","24ea4463":"code","c2921f04":"code","10cdc42e":"code","1c431867":"code","3af3ce55":"code","e28f89bc":"code","811b4a88":"code","4712042c":"code","23c5af37":"code","e66cd045":"markdown","38829d57":"markdown","0feda1a9":"markdown","b1d5afae":"markdown","c72ff78b":"markdown","beaccc76":"markdown","8e9859b6":"markdown","f3ca8161":"markdown","1ff9aa04":"markdown","03c6ba11":"markdown","4e7e1ca3":"markdown","7361d6bc":"markdown","f6064519":"markdown"},"source":{"c44a50d7":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib.gridspec as gridspec\nimport matplotlib.ticker as ticke\nimport seaborn as sns\nimport os\nfrom glob import glob\nfrom os import listdir\nfrom os.path import join, isfile, isdir\nfrom PIL import Image\nfrom tqdm import tqdm\n%matplotlib inline","a385fcfb":"data = pd.read_csv('..\/input\/data\/Data_Entry_2017.csv')","5e96acc5":"data.head()","7cab28ef":"data.describe()","7897854c":"data.isnull().sum()","6c0b2573":"unique_pt = data['Patient ID'].nunique()\nprint(f'Total number of unique patient in this dataset is {unique_pt}')","47e0d7d9":"data = data[['Image Index','Finding Labels','Follow-up #','Patient ID','Patient Age','Patient Gender']]\n\n#create new columns for each decease\npathology_list = ['Cardiomegaly','Emphysema','Effusion','Hernia','Nodule','Pneumothorax','Atelectasis','Pleural_Thickening','Mass','Edema','Consolidation','Infiltration','Fibrosis','Pneumonia']\n\nfor pathology in pathology_list :\n    data[pathology] = data['Finding Labels'].apply(lambda x: 1 if pathology in x else 0)","14939098":"data.head()","e8c4d31b":"patient_age_max = data['Patient Age'].max()\npatient_age_min = data['Patient Age'].min()\n\nprint(f'maximum patient age is {patient_age_max}')\nprint(f'minimum patient age is {patient_age_min}')","811b2472":"patient_age = data['Patient Age'].value_counts()\nprint(patient_age)","1632cf94":"patient_age_above_100 = data[data['Patient Age'] >100]['Patient Age']\npatient_age_less_10 = data[data['Patient Age'] <10]['Patient Age']\n\nprint(f'There are ({len(patient_age_above_100)}) patients with age more than 100 years')\nprint(f'There are ({len(patient_age_less_10)}) patients with age less than 10 years')","639e5315":"above_100_years =data.loc[patient_age_above_100.index]\nabove_100_years","24ea4463":"less_10_years =data.loc[patient_age_less_10.index]\nless_10_years.head()","c2921f04":"no_finding_less_10 = less_10_years.loc[(less_10_years[pathology_list] !=0).any(axis=1)]\nlen(no_finding_less_10)","10cdc42e":"plt.figure(figsize=(15,10))\ngs = gridspec.GridSpec(8,1)\nax1 = plt.subplot(gs[:8, :])\n# ax2 = plt.subplot(gs[7, :])\ndata1 = pd.melt(data,\n             id_vars=['Patient Gender'],\n             value_vars = list(pathology_list),\n             var_name = 'Category',\n             value_name = 'Count')\ndata1 = data1.loc[data1.Count>0]\ng=sns.countplot(y='Category',hue='Patient Gender',data=data1, ax=ax1, order = data1['Category'].value_counts().index)\nax1.set( ylabel=\"\",xlabel=\"\")\nax1.legend(fontsize=20)\nax1.set_title('X Ray partition (total number = 121120)',fontsize=18);\n","1c431867":"df_age =pd.read_csv('..\/input\/data\/Data_Entry_2017.csv')\ng = sns.factorplot(x=\"Patient Age\", col=\"Patient Gender\",data=df_age, kind=\"count\",size=10, aspect=0.8,palette=\"GnBu_d\");\ng.set_xticklabels(np.arange(0,100))\ng.set_xticklabels(step=10)\ng.fig.suptitle('Age distribution by sex',fontsize=22);\ng.fig.subplots_adjust(top=.9)","3af3ce55":"f, axarr = plt.subplots(7, 2, sharex=True,figsize=(15, 20))\n\ni=0\nj=0\nx=np.arange(0,100,10)\nfor pathology in pathology_list :\n    g=sns.countplot(x='Age', hue=\"Patient Gender\",data=data[data['Finding Labels']==pathology], ax=axarr[i, j])\n    axarr[i, j].set_title(pathology)   \n    g.set_xlim(0,90)\n    g.set_xticks(x)\n    g.set_xticklabels(x)\n    j=(j+1)%2\n    if j==0:\n        i=(i+1)%7\nf.subplots_adjust(hspace=0.3)","e28f89bc":"f, (ax1,ax2) = plt.subplots( 2, figsize=(15, 10))\n\nfollow_up = data[data['Follow-up #']<15]\ng = sns.countplot(x='Follow-up #',data=follow_up,palette=\"GnBu_d\",ax=ax1);\n\nax1.set_title('Follow-up distribution');\ndata = df[df['Follow-up #']>14]\ng = sns.countplot(x='Follow-up #',data=follow_up,palette=\"GnBu_d\",ax=ax2);\nx=np.arange(15,100,10)\ng.set_ylim(15,450)\ng.set_xlim(15,100)\ng.set_xticks(x)\ng.set_xticklabels(x)\nf.subplots_adjust(top=1)","811b4a88":"#First display Top 10 multiple deseases\ndf=data.groupby('Finding Labels').count().sort_values()\n# df=df[['|' in index for index in data.index.values]]\ndata","4712042c":"#combining the path of all the folders of images.\n\nmy_glob = glob('..\/input\/data\/images*\/images\/*.png')\nall_image_paths = {os.path.basename(x): x for x in my_glob}\ndata['full_path'] = data['Image Index'].map(all_image_paths.get)","23c5af37":"data.drop('Finding Labels',axis =1 ,inplace=True)\ndata.head()","e66cd045":"# 1. NIH Chest X-ray Dataset\n\n## National Institutes of Health Chest X-Ray Dataset\nChest X-ray exams are one of the most frequent and cost-effective medical imaging examinations available. However, clinical diagnosis of a chest X-ray can be challenging and sometimes more difficult than diagnosis via chest CT imaging. The lack of large publicly available datasets with annotations means it is still very difficult, if not impossible, to achieve clinically relevant computer-aided detection and diagnosis (CAD) in real world medical sites with chest X-rays. One major hurdle in creating large X-ray image datasets is the lack resources for labeling so many images. Prior to the release of this dataset, (Openi)[https:\/\/openi.nlm.nih.gov\/] was the largest publicly available source of chest X-ray images with 4,143 images available.\n\nThis NIH Chest X-ray Dataset is comprised of 112,120 X-ray images with disease labels from 30,805 unique patients. **To create these labels, the authors used Natural Language Processing to text-mine disease classifications from the associated radiological reports.** **The labels are expected to be >90% accurate and suitable for weakly-supervised learning.** The original radiology reports are not publicly available but you can find more details on the labeling process in this Open Access paper: \"ChestX-ray8: Hospital-scale Chest X-ray Database and Benchmarks on Weakly-Supervised Classification and Localization of Common Thorax Diseases.\" [(Wang et al)](https:\/\/www.nih.gov\/news-events\/news-releases\/nih-clinical-center-provides-one-largest-publicly-available-chest-x-ray-datasets-scientific-community)\n.\n\n\n## 1.2 Data limitations:\nThe image labels are NLP extracted so there could be some erroneous labels but the NLP labeling accuracy is estimated to be >90%. Very limited numbers of disease region bounding boxes (See BBoxlist2017.csv) Chest x-ray radiology reports are not anticipated to be publicly shared. Parties who use this public dataset are encouraged to share their \u201cupdated\u201d image labels and\/or new bounding boxes in their own studied later, maybe through manual annotation\n\n\n\n### File contents\nImage format: 112,120 total images with size 1024 x 1024\n* images_001.zip: Contains 4999 images\n* images_002.zip: Contains 10,000 images\n* images_003.zip: Contains 10,000 images\n* images_004.zip: Contains 10,000 images\n* images_005.zip: Contains 10,000 images\n* images_006.zip: Contains 10,000 images\n* images_007.zip: Contains 10,000 images\n* images_008.zip: Contains 10,000 images\n* images_009.zip: Contains 10,000 images\n* images_010.zip: Contains 10,000 images\n* images_011.zip: Contains 10,000 images\n* images_012.zip: Contains 7,121 images\nREADME_ChestXray.pdf: Original README file\n\n### BBoxlist2017.csv: Bounding box coordinates. Note: Start at x,y, extend horizontally w pixels, and vertically h pixels\nImage Index: File name\nFinding Label: Disease type (Class label)\nBbox x\nBbox y\nBbox w\nBbox h\n\n### Dataentry2017.csv: Class labels and patient data for the entire dataset\nImage Index: File name\nFinding Labels: Disease type (Class label)\nFollow-up #\nPatient ID\nPatient Age\nPatient Gender\nView Position: X-ray orientation\nOriginalImageWidth\nOriginalImageHeight\nOriginalImagePixelSpacing_x\nOriginalImagePixelSpacing_y\n\n### 1.3 Class descriptions\nThere are 15 classes (14 diseases, and one for \"No findings\"). Images can be classified as \"No findings\" or one or more disease classes:\n\n* Atelectasis\n* Consolidation\n* Infiltration\n* Pneumothorax\n* Edema\n* Emphysema\n* Fibrosis\n* Effusion\n* Pneumonia\n* Pleural_thickening\n* Cardiomegaly\n* Nodule Mass\n* Hernia","38829d57":"**FINDINGS**\n\n1. Here we have **112120** records for different patient so let's find how many unique patient we have in this dataset and the distribution of them\n\n2. There is no null values in our dataframe ","0feda1a9":"### Display pathologies distribution by age&sex.","b1d5afae":"### There are more than 500 record for patient with age less than 10 years and hasn't any psotivie '1' for any type of diseases ","c72ff78b":"#### It's obvious that there are many outliers in age columns there are 16 records with ages more than 100 years and about 1400 record with ages less than 10 years they may children born with this lung diseases but let's investigate them deeper may they have a X-RAY in dataset but labeled as 'NO FINDINGS' \n\n* HINT no findings in data set mean columns in pathology_list all have 0\n","beaccc76":"### Try to find links between pathologies.","8e9859b6":"### Now check age distribution by sex:\n","f3ca8161":"### Display patient number by Follow-up ","1ff9aa04":"### DROP UNUSED COLUMNS AND EXPAND FINDING LABELS COLUMN","03c6ba11":"### Let's explore patient age column to figure out if there is any outliers ","4e7e1ca3":"<font size= 3.5>\n    \n    So lets drop Finding labels columns we don't need it anymore\n    \n<\/font>","7361d6bc":"# 1. DATA analysis\n\n## 1.1 DATA LOADING","f6064519":"# 2. DATA VISUALIZATION\n\n### number of each diseases by patient gender\n"}}