{"cell_type":{"471acf1d":"code","a15d17b8":"code","05396500":"code","ebd7c04a":"code","e2e7a9bd":"code","323d81e8":"code","1cb6fd8c":"markdown"},"source":{"471acf1d":"import pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","a15d17b8":"# list of (weight, submission file path)\n# supports n number of files\n# make sure the weights sum up to 1 always.\nweight_model_paths_pairs = [\n    (.10, '..\/input\/tps-oct-2021\/overfit_for_sure_lol.csv'),\n    (.80, '..\/input\/tps-oct-2021\/submission (11).csv'),\n    (.10, '..\/input\/tps-oct-2021\/submission (12).csv')]","05396500":"# verify weights sum up to ~1\nres = 0\nfor x, y in weight_model_paths_pairs:\n    res = res + x;\nprint(res)","ebd7c04a":"targets = ['target']\n\nsubmissions = []\nfor weight, path in weight_model_paths_pairs:\n    df = pd.read_csv(path)\n    df[targets] = df[targets] * weight\n    submissions.append(df)\n\nensembled_output = pd.concat(submissions).groupby(['id']).sum().reset_index()","e2e7a9bd":"ensembled_output.head()","323d81e8":"ensembled_output.to_csv('submission_weighted_ensemble_1.csv', index=False)","1cb6fd8c":"### Intuition: Multiple models lead a better model.\u00b6\n\n#### Open question:\n\n1. How to decide the weights for different model outputs?\n  1. One way is weight the better performing model more.\n\n\n#### Credits\n1. https:\/\/www.kaggle.com\/yamqwe\/stacking-3-folds-bagging-seeds\n2. https:\/\/www.kaggle.com\/vamsikrishnab\/exploring-submissions-and-power-averaging\n3. https:\/\/www.kaggle.com\/adityastark07\/basic-ensemble-of-public-nb\n\n\nUpvote for support!! and kudos to the above mentioned notebooks!!"}}