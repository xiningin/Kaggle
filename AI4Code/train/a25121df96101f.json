{"cell_type":{"b6eda204":"code","13e520c0":"code","d725d506":"code","c7c39764":"code","a67bac09":"code","0e93339a":"code","95b9f530":"markdown","95674599":"markdown","b8159e3f":"markdown","98535c45":"markdown","f6933fe7":"markdown","1f44a960":"markdown"},"source":{"b6eda204":"import itertools\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd","13e520c0":"x = pd.read_csv(\"..\/input\/market-based-optimization\/Market_Basket_Optimisation.csv\", header=None)\nx.describe()","d725d506":"products = pd.unique(pd.concat([x.iloc[:, col].dropna() for col in x.columns])).tolist()\n\nprint(\"Unique products:\", len(products))","c7c39764":"MIN_LENGTH = 2\nMAX_LENGTH = 3\n\nrelations = {}\nfor idx, row in x.iterrows():\n    row = row.dropna()\n    for i in range(MIN_LENGTH, MAX_LENGTH + 1):\n        for j in itertools.combinations(row, i):\n            if frozenset(j) in relations:\n                relations[frozenset(j)] += 1\n            else:\n                relations[frozenset(j)] = 1\n\nprint(\"Total associations:\\t\", len(relations))","a67bac09":"MIN_SUPPORT = int(len(x) * 0.02)\n\nsupported_relations = {}\nfor key, value in relations.items():\n    if value >= MIN_SUPPORT:\n        supported_relations[key] = value\n\nprint(\"Supported associations:\\t\", len(supported_relations))","0e93339a":"plot_relations = list(supported_relations.items())\nplot_relations = sorted(plot_relations, key=lambda r: len(r[0]), reverse=True)\n\nplt.subplots(figsize=(12, len(plot_relations) \/\/ 3))\nplt.title(\"Itemsets Frequencies (support >= {})\".format(MIN_SUPPORT), {\"fontsize\":20})\nfor key, value in plot_relations:\n    product = \"(\" + str(len(key)) + \") \" + \", \".join(sorted(list(key)))\n    if value >= MIN_SUPPORT: \n        plt.barh(product, value, color=\"#3333ee\")\n    else:\n        plt.barh(product, value, color=\"#cccccc\")\n    plt.text(value, product, str(value))","95b9f530":"### Mine every association","95674599":"### Load Market Basket Data","b8159e3f":"Sources:\n1. [Mining Frequent Itemsets using the Eclat \/ dEclat Algorithms](https:\/\/www.philippe-fournier-viger.com\/spmf\/Eclat_dEclat.php)\n2. [Machine Learning A-Z (Udemy course)](https:\/\/www.udemy.com\/course\/machinelearning\/learn\/lecture\/19875744)\n3. [ECLAT Algorithm](https:\/\/www.geeksforgeeks.org\/ml-eclat-algorithm\/)","98535c45":"### Select only the supported associations","f6933fe7":"# Association Rule Mining from Scratch","1f44a960":"### Visualization of supported associations"}}