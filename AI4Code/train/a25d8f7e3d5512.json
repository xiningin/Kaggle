{"cell_type":{"ff0f6a31":"code","787b54e7":"code","d286b920":"code","01a218df":"code","96679bf0":"code","24c97277":"code","0bd4b8fc":"code","c3f0eb97":"code","1dfa591a":"code","6496905d":"code","752eabf0":"code","b4c62768":"code","6cef9e05":"code","d1644146":"code","c8434fd0":"code","9e78e0a5":"code","cf529ce3":"code","5de404ee":"code","57dc4722":"code","dfb6c575":"code","3a1851dd":"code","6af98889":"code","52085b42":"code","09ad97d1":"code","d55e3271":"code","3d2b502e":"code","81420562":"code","52a5d4a7":"code","63fdb398":"code","ac4bc791":"code","955883d7":"code","17460bd9":"code","d11bbe51":"code","404ef589":"code","c97a653f":"code","954dcf88":"code","e8d879a0":"code","9c883544":"code","7c1f952e":"code","b2b7318f":"code","102974f4":"code","52c1955f":"code","622eed86":"markdown","9577478b":"markdown","4ffc1224":"markdown","1a749087":"markdown","f549bfd0":"markdown","3688979d":"markdown","03735db5":"markdown","fb002ca1":"markdown","e008a370":"markdown","b6a2d385":"markdown","c5e39f5c":"markdown","4d388443":"markdown","7a6b7ee4":"markdown","e4228b01":"markdown","8256558e":"markdown","87350e9a":"markdown","52dbccaf":"markdown","a04435b9":"markdown","1302377c":"markdown","ea34f884":"markdown","cfb705cf":"markdown"},"source":{"ff0f6a31":"import numpy as np \nimport pandas as pd \n\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","787b54e7":"df_train = pd.read_csv(\"\/kaggle\/input\/costa-rican-household-poverty-prediction\/train.csv\")\ndf_test = pd.read_csv(\"\/kaggle\/input\/costa-rican-household-poverty-prediction\/test.csv\")\n\ndf_train.shape, df_test.shape","d286b920":"df_train.head()","01a218df":"df_test.head()","96679bf0":"df_train.info()","24c97277":"df_test.info()","0bd4b8fc":"df_test.columns[df_test.dtypes==object]","c3f0eb97":"df_train.columns[df_train.dtypes==object]","1dfa591a":"df_train.describe()","6496905d":"df_test.describe()","752eabf0":"df_train.select_dtypes('object').head()","b4c62768":"df_train.isna().sum()","6cef9e05":"df_test.isna().sum()","d1644146":"df_train.columns[df_train.isna().sum()!=False]","c8434fd0":"df_test.columns[df_test.isna().sum()!=False]","9e78e0a5":"print(df_train['v2a1'].isna().sum())\nprint(df_train['v18q1'].isna().sum())\nprint(df_train['rez_esc'].isna().sum())\nprint(df_train['meaneduc'].isna().sum())\nprint(df_train['SQBmeaned'].isna().sum())","cf529ce3":"df_train['v2a1'] = df_train['v2a1'].fillna(0)\ndf_test['v2a1'] = df_test['v2a1'].fillna(0)","5de404ee":"df_train['v18q1'] = df_train['v18q1'].fillna(0)\ndf_test['v18q1'] = df_test['v18q1'].fillna(0)","57dc4722":"df_train[['meaneduc', 'SQBmeaned']].describe()","dfb6c575":"df_test[['meaneduc', 'SQBmeaned']].describe()","3a1851dd":"df_train['meaneduc'].fillna(0)\ndf_train['SQBmeaned'].fillna(0)","6af98889":"df_test['meaneduc'].fillna(0)\ndf_test['SQBmeaned'].fillna(0)","52085b42":"df_train['rez_esc'].fillna(0)\ndf_test['rez_esc'].fillna(0)","09ad97d1":"import matplotlib.pyplot as plt\ndf_train['Target'].plot.hist()","d55e3271":"df_train['Target'].value_counts()","3d2b502e":"df_train.head()","81420562":"df_train['edjefe'].value_counts()","52a5d4a7":"df_train['edjefa'].value_counts()","63fdb398":"df_train['dependency'].value_counts()","ac4bc791":"mapping = {\"yes\": 1, \"no\": 0}\n\nfor df in [df_train, df_test]:\n    df['dependency'] = df['dependency'].replace(mapping).astype(np.float64)\n    df['edjefa'] = df['edjefa'].replace(mapping).astype(np.float64)\n    df['edjefe'] = df['edjefe'].replace(mapping).astype(np.float64)\n\ndf_train[['dependency', 'edjefa', 'edjefe']].describe()","955883d7":"df_test.info()","17460bd9":"df_train.drop(['Id'],axis=1)\ndf_train.drop(['idhogar'],axis=1)","d11bbe51":"df_train.select_dtypes('object').head()","404ef589":"df_train = df_train.drop(columns = ['SQBmeaned', 'agesq'])\ndf_train.shape","c97a653f":"df_test = df_test.drop(columns = ['SQBmeaned', 'agesq'])\ndf_test.shape","954dcf88":"df_train.info()","e8d879a0":"from matplotlib import pyplot\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom xgboost import XGBClassifier","9c883544":"X=df_train.drop(['Id', 'idhogar', 'Target'], axis=1)\n\ny=df_train['Target']","7c1f952e":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, stratify=y)\n\nX_train.shape, y_train.shape","b2b7318f":"xgb = XGBClassifier()\nxgb.fit(X_train, y_train)\npred = xgb.predict(X_test)\nprint(accuracy_score(y_test, pred))\nprint(classification_report(y_test, pred))\nprint(confusion_matrix(y_test, pred))","102974f4":"import lightgbm as lgb\n\nlgb = lgb.LGBMClassifier()\nlgb.fit(X_train, y_train)\npreds = lgb.predict(X_test)\nprint(accuracy_score(y_test, preds))\nprint(classification_report(y_test, preds))\nprint(confusion_matrix(y_test, preds))","52c1955f":"z = pd.Series(lgb.predict(X_test),name=\"Target\")\ndf_entrega = pd.concat([df_test.Id,z], axis=1)\ndf_entrega.to_csv(\"\/kaggle\/working\/submission.csv\",index=False)","622eed86":"### Os valores NaN na coluna 'v2a1' s\u00e3o de pessoas que n\u00e3o pagaram o aluguel por algum motivo.","9577478b":"## Predi\u00e7\u00e3o do n\u00edvel de pobreza dom\u00e9stica na Costa Rica.","4ffc1224":"### Na coluna 'rez_esc'","1a749087":"### A maioria dos dados \u00e9 float e int, e poucos casos s\u00e3o object.\n### Quero saber quais colunas s\u00e3o do tipo object. Primeiro irei fazer nos dados de test e depois nos dados de train para verificar se h\u00e1 alguma diferen\u00e7a.","f549bfd0":"### A coluna 'meaneduc' e 'SQBmeaned' os dois dados.","3688979d":"### Temos valores \"yes\" e \"no\" nas colunas 'edjefe','edjefa' e 'dependency', tanto nos dados de treino quanto nos de teste.\n### Substituir esses valores por 'yes=1' e 'no=0'.","03735db5":"### Verificar os valores ausentes nos dados de treinamento.","fb002ca1":"## Agora que terminamos a an\u00e1lise e modifica\u00e7\u00f5es dos dados podemos seguir em frente para dividir os dados de treinamento.","e008a370":"### Gr\u00e1fico de nossa vari\u00e1vel target.","b6a2d385":"### Os dados da competi\u00e7\u00e3o s\u00e3o fornecidos em dois arquivos: 'train.csv' e 'test.csv'. O conjunto de treinamento possui 9557 linhas e 143 colunas enquanto o conjunto de teste possui 23856 linhas e 142 colunas. O conjunto de treinamento posssui uma coluna a mais, Target, que representa o n\u00edvel de pobreza em uma escala de 1-4.\n### 1 = pobreza extrema\n### 2 = pobreza moderada\n### 3 = fam\u00edlias vulner\u00e1veis\n### 4 = domic\u00edlios n\u00e3o vulner\u00e1veis","c5e39f5c":"### Existem algumas colunas que s\u00e3o os quadrado de outras colunas como SQBedjefe, SQBmeaned, SQBdepedndency,etc.Talvez elas sejam irrelevantes pois j\u00e1 existe uma coluna normal para elas.","4d388443":"### Verificar os valores ausentes nos dados de teste.","7a6b7ee4":"### No total s\u00e3o 5 colunas que possui valores ausentes.\n* 'v2a1' = pagamento mensal do aluguel.\n* 'v18q1' = n\u00famero de tablets que o domiciliar tem.\n* 'rez_esc' = anos de atraso escolar.\n* 'meaneduc' = educa\u00e7\u00e3o m\u00e9dia para adultos.\n* 'SQBmeaned' =  quadrado da m\u00e9dia de anos de escolaridade dos adultos (>=18) no domic\u00edlio.","e4228b01":"* 'Id' = identificador \u00fanico.\n* 'idhogar' = este \u00e9 um identificador \u00fanico para cada fam\u00edlia. Ele pode ser usado para criar caracter\u00edsticas dom\u00e9sticas, etc.\n* 'dependency' = Taxa de depend\u00eancia, calculada = (n\u00famero de membros da fam\u00edlia com menos de 19 ou mais de 64 anos)\/(n\u00famero de membros da fam\u00edlia entre 19 e 64 anos).\n* 'edjefe' = anos de educa\u00e7\u00e3o masculino.\n* 'edjefa' = anos de educa\u00e7\u00e3o feminino.","8256558e":"### Posso olhar em cada coluna separadamente.","87350e9a":"### Verificar as informa\u00e7\u00f5es nos dados de treinamento.","52dbccaf":"# Usando o XBGClassifier","a04435b9":"### Outra maneira de olhar os valores nulos \u00e9 filtrar por coluna.","1302377c":"### A coluna 'v18q1' possue uma rela\u00e7\u00e3o com a coluna 'v18q', essa \u00faltima diz se algu\u00e9m da fam\u00edlia tem um tablet.","ea34f884":"1. Preparar o dataset\n","cfb705cf":"### Verificar as informa\u00e7\u00f5es nos dados de teste."}}