{"cell_type":{"d8a6d5ec":"code","1b7d0abb":"code","0fe40d02":"code","181bffc8":"code","eb515b99":"code","e27a083e":"code","c8120a54":"code","5ebb676b":"code","a88f5da3":"code","bb0e57a9":"code","9353c8d1":"code","63cb9c1b":"code","65df6d08":"code","f899d832":"code","0d319269":"code","579d7b9e":"code","8288d2b9":"code","3c0ac94f":"code","45deff35":"code","c4276b4c":"code","5b171c37":"code","8b2c8596":"code","aa217cc1":"code","54244883":"code","67a3b264":"code","d4924cf8":"code","ee4a8ec8":"code","aa324cd5":"code","707fe216":"code","eb3c91d8":"code","6190b9ee":"code","2213c0e9":"markdown","790d352e":"markdown","f73934d9":"markdown","6937c168":"markdown","70c6ae15":"markdown","66bfaaa5":"markdown","810fbf58":"markdown","c3effb47":"markdown","0229ef26":"markdown","e9d629e5":"markdown"},"source":{"d8a6d5ec":"# importing libraries\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nimport warnings\nwarnings.filterwarnings(action=\"ignore\")\nimport matplotlib.pyplot as plt\n%matplotlib inline","1b7d0abb":"# importing dataset\ndf = pd.read_csv(\"\/kaggle\/input\/heart-disease-uci\/heart.csv\")","0fe40d02":"# Lets take a look at our dataset\ndf.head()","181bffc8":"# checking datatypes of attributes\ndf.info()","eb515b99":"# Statistical data\ndf.describe()","e27a083e":"# Checking for null values\ndf.isna().sum()","c8120a54":"print(\"Chest Pain types:\",df.cp.unique())","5ebb676b":"df.target.value_counts()","a88f5da3":"sns.countplot(df[\"sex\"], hue=\"target\", data=df)\nplt.show()","bb0e57a9":"df.groupby(\"target\").mean()","9353c8d1":"sns.countplot(df.target, palette=(\"Blues_d\"))\nplt.show()","63cb9c1b":"pd.crosstab(df.age,df.target).plot(kind=\"bar\",figsize=(20,8))\nplt.xlabel(\"Age\")\nplt.ylabel(\"Frequency\")\nplt.title(\"Heart Disease for Different Ages\")\nplt.show()","65df6d08":"plt.scatter(df.age[df.target==1],y= df.thalach[df.target==1], c=\"red\")\nplt.scatter(df.age[df.target==0], y=df.thalach[df.target==0])\nplt.ylabel(\"Heart Rate(Max)\")\nplt.xlabel(\"Age\")\nplt.title(\"Heart Rate vs Age Scatter Plot\")\nplt.show()","f899d832":"plt.scatter(df.age[df.target==1],y = df.trestbps[df.target==1],c=\"red\")\nplt.scatter(df.age[df.target==0], y=df.trestbps[df.target==0])\nplt.xlabel(\"Age\")\nplt.ylabel(\"Resting Blood Pressure\")\nplt.title(\"Resting Blood Pressure vs Age Scatter Plot\")\nplt.show()","0d319269":"pd.crosstab(df.slope,df.target).plot(kind=\"bar\",figsize=(10,7))\nplt.title('Heart Disease Frequency for Slope')\nplt.xlabel('Slope of The Peak Exercise ST Segment')\nplt.ylabel('Frequency')\nplt.show()","579d7b9e":"df.head()","8288d2b9":"a = pd.get_dummies(df['cp'], prefix = \"cp\")\nb = pd.get_dummies(df['thal'], prefix = \"thal\")\nc = pd.get_dummies(df['slope'], prefix = \"slope\")","3c0ac94f":"frames = [df, a, b, c]\ndf = pd.concat(frames, axis = 1)\ndf.head()","45deff35":"df = df.drop(columns = ['cp', 'thal', 'slope'])\ndf.head()","c4276b4c":"y = df.target.values\nX = df.drop(columns=\"target\")","5b171c37":"#Splitting data into training and testing set\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=24)","8b2c8596":"print(X_train.shape)\nprint(y_train.shape)\nprint(X_test.shape)\nprint(y_test.shape)","aa217cc1":"# Normalizing Data\nfrom sklearn.preprocessing import Normalizer\nscaler = Normalizer()\nX_train = scaler.fit_transform(X_train)\nX_test = scaler.fit_transform(X_test)","54244883":"from sklearn.linear_model import LogisticRegression\nmodel = LogisticRegression()\nmodel.fit(X_train,y_train)\ny_pred = model.predict(X_test)\n\nfrom sklearn.metrics import classification_report , accuracy_score\nreport = classification_report(y_test,y_pred)\nprint(report)\nprint(accuracy_score(y_test,y_pred))","67a3b264":"df1 = pd.DataFrame(y_test,y_pred)\ndf1.head(10)","d4924cf8":"from sklearn.svm import SVC\nmodel2 = SVC(verbose=True)\nmodel2.fit(X_train,y_train)\ny_pred2 = model2.predict(X_test)\nreport_svc = classification_report(y_test,y_pred2)\nprint(report_svc)\nprint(accuracy_score(y_test,y_pred2))","ee4a8ec8":"from sklearn.tree import DecisionTreeClassifier\nmodel3 = DecisionTreeClassifier(criterion=\"entropy\",max_depth=200)\nmodel3.fit(X_train,y_train)\ny_pred3 = model3.predict(X_test)\nreport_dtree = classification_report(y_pred3,y_test)\nprint(report_dtree)\nprint(accuracy_score(y_test,y_pred3))","aa324cd5":"from sklearn.naive_bayes import GaussianNB\nnb = GaussianNB()\nnb.fit(X_train, y_train)\ny_pred_nb = nb.predict(X_test)\nreport_nb = classification_report(y_pred_nb,y_test)\nprint(report_nb)\nacc = nb.score(X_test,y_test)*100\nprint(\"Accuracy of Naive Bayes:\",acc)","707fe216":"from sklearn.ensemble import RandomForestClassifier\nmodel_rf = RandomForestClassifier(n_estimators=1000, random_state=1)\nmodel_rf.fit(X_train,y_train)\ny_pred_rf = model_rf.predict(X_test)\nreport_rf2 = classification_report(y_test,y_pred_rf)\nprint(report_rf2)\nprint(accuracy_score(y_pred_rf,y_test))","eb3c91d8":"from sklearn.metrics import confusion_matrix\ncm_lr = confusion_matrix(y_test,y_pred)\ncm_svc = confusion_matrix(y_test,y_pred2)\ncm_dtree = confusion_matrix(y_test,y_pred3)\ncm_rf = confusion_matrix(y_test,y_pred_rf)\ncm_nb = confusion_matrix(y_test,y_pred_nb)","6190b9ee":"plt.figure(figsize=(24,12))\n\nplt.suptitle(\"Confusion Matrixes\",fontsize=24)\nplt.subplots_adjust(wspace = 0.4, hspace= 0.4)\n\nplt.subplot(2,3,1)\nplt.title(\"Logistic Regression Confusion Matrix\")\nsns.heatmap(cm_lr,annot=True,cmap=\"Blues\",fmt=\"d\",cbar=False, annot_kws={\"size\": 24})\n\nplt.subplot(2,3,3)\nplt.title(\"Support Vector Machine Confusion Matrix\")\nsns.heatmap(cm_svc,annot=True,cmap=\"Blues\",fmt=\"d\",cbar=False, annot_kws={\"size\": 24})\n\nplt.subplot(2,3,4)\nplt.title(\"Naive Bayes Confusion Matrix\")\nsns.heatmap(cm_nb,annot=True,cmap=\"Blues\",fmt=\"d\",cbar=False, annot_kws={\"size\": 24})\n\nplt.subplot(2,3,5)\nplt.title(\"Decision Tree Classifier Confusion Matrix\")\nsns.heatmap(cm_dtree,annot=True,cmap=\"Blues\",fmt=\"d\",cbar=False, annot_kws={\"size\": 24})\n\nplt.subplot(2,3,6)\nplt.title(\"Random Forest Confusion Matrix\")\nsns.heatmap(cm_rf,annot=True,cmap=\"Blues\",fmt=\"d\",cbar=False, annot_kws={\"size\": 24})\n\nplt.show()","2213c0e9":"# Confusion Matrixes","790d352e":"# **Heart Disease** - Classification Problem","f73934d9":"Data Atributes:\n\n* age - age in years \n* sex - (1 = male; 0 = female) \n* cp - chest pain type \n* trestbps - resting blood pressure (in mm Hg on admission to the hospital) \n* chol - serum cholestoral in mg\/dl \n* fbs - (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false) \n* restecg - resting electrocardiographic results \n* thalach - maximum heart rate achieved \n* exang - exercise induced angina (1 = yes; 0 = no) \n* oldpeak - ST depression induced by exercise relative to rest \n* slope - the slope of the peak exercise ST segment \n* ca - number of major vessels (0-3) colored by flourosopy \n* thal - 3 = normal; 6 = fixed defect; 7 = reversable defect \n* target - have disease or not (1=yes, 0=no)","6937c168":"### Support Vector Machine Classifier","70c6ae15":"### Decision Tree Classifier","66bfaaa5":"### Logistic Regression","810fbf58":"# Data Visualization","c3effb47":"# Model Selection","0229ef26":"### Random Forest Classifier","e9d629e5":"# Feature Engineering"}}