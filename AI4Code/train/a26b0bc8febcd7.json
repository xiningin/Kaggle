{"cell_type":{"a921ee91":"code","49619b28":"code","db2cdb43":"code","1571ac08":"code","26a8044c":"code","36d4cdf8":"code","cb485dc7":"code","48fd972e":"code","4fa5d0eb":"code","862a0655":"code","321a2a8a":"code","e9e689f1":"code","e0a98b3a":"code","126af9cc":"code","a137080e":"code","4cec5c52":"code","a7d5a3ff":"code","2843f441":"code","9c9aa658":"code","435253b9":"code","d5380862":"code","a6203f5a":"code","1e5f2b38":"code","c0fac916":"code","eb24e882":"code","2e00e337":"code","158ddccc":"code","b3d34a0b":"code","1cbb028e":"code","41ce8648":"code","f2116ff0":"code","507966cf":"code","f1e3619d":"code","c8767b81":"code","108faba0":"code","418671ea":"code","20f68f32":"code","bb44d1b8":"code","70af5bad":"code","ac8adf83":"code","413995ac":"code","9930df61":"code","3198ab2c":"code","b015226f":"code","0ca6e70c":"code","03d8d951":"code","5d42b067":"code","0b2386b4":"code","465802b5":"code","630affbd":"code","a68e952e":"code","74f66308":"code","1b291424":"code","0de7b08e":"code","d84ff664":"code","58319ef8":"code","4a6663a0":"code","f4264d32":"code","9139a4d4":"code","6ae9dc87":"code","4afb540a":"code","da7325a7":"code","d86f7f91":"code","02ec2cdf":"code","cc1e2e70":"code","a0a838c4":"code","64b9744f":"markdown"},"source":{"a921ee91":"import pandas as pd\ndata=pd.read_csv(\"..\/input\/tabular-playground-series-dec-2021\/train.csv\")\ndata.head()","49619b28":"data.info()","db2cdb43":"Wilderness_Area_cols = [col for col in data.columns if 'Wilderness_Area' in col]\nWilderness_Area_cols","1571ac08":"Wilderness_Area=data[Wilderness_Area_cols]\nWilderness_Area.head()","26a8044c":"df_n = Wilderness_Area.apply(lambda x: x.idxmax(), axis = 1)\ndf_n.head()","36d4cdf8":"Wilderness_Area=pd.DataFrame(df_n, columns=['Wilderness'])\nWilderness_Area.head()","cb485dc7":"Wilderness_Area.Wilderness.value_counts()","48fd972e":"Wilderness_Area.Wilderness=Wilderness_Area.Wilderness.map({'Wilderness_Area1':'Area1',\n                                                           'Wilderness_Area2':'Area2',\n                                                          'Wilderness_Area3':'Area3',\n                                                          'Wilderness_Area4':'Area4'})\nWilderness_Area.Wilderness.value_counts()","4fa5d0eb":"data=data.drop(['Wilderness_Area1','Wilderness_Area2','Wilderness_Area3','Wilderness_Area4'],axis=1)\ndata.head()","862a0655":"data=pd.concat([data, Wilderness_Area], axis=1)\ndata.head()","321a2a8a":"Soil_Type_cols = [col for col in data.columns if 'Soil_Type' in col]\nSoil_Type_cols","e9e689f1":"Soil_Type=data[Soil_Type_cols]\nSoil_Type.head()","e0a98b3a":"df_n = Soil_Type.apply(lambda x: x.idxmax(), axis = 1)\ndf_n.head()","126af9cc":"Soil_Type=pd.DataFrame(df_n, columns=['Soil'])\nSoil_Type.head()","a137080e":"Soil_Type.Soil.value_counts()","4cec5c52":"Soil_Type.Soil = Soil_Type.Soil.str.replace('Soil_', '')\nSoil_Type.Soil.value_counts()","a7d5a3ff":"data=data.drop(Soil_Type_cols,axis=1)\ndata.head()","2843f441":"data=pd.concat([data, Soil_Type], axis=1)\ndata.head()","9c9aa658":"data.info()","435253b9":"data.nunique()","d5380862":"round(data.Cover_Type.value_counts()*100\/len(data),2)","a6203f5a":"data.Cover_Type.value_counts()","1e5f2b38":"data=data[data.Cover_Type!=5]\ndata=data[data.Cover_Type!=4]\ndata=data[data.Cover_Type!=6]\ndata=data[data.Cover_Type!=7]\ndata=data.sample(n=100000)\ndata.reset_index(drop=True, inplace=True)\ndata.shape","c0fac916":"round(data.Cover_Type.value_counts()*100\/len(data),2)","eb24e882":"data.Cover_Type=data.Cover_Type.map({1:0,2:1,3:2})\nround(data.Cover_Type.value_counts()*100\/len(data),2)","2e00e337":"data.Cover_Type.unique()","158ddccc":"pd.options.display.float_format = '{:.2f}'.format\ndata.describe()","b3d34a0b":"data.nunique().sort_values(ascending=False)","1cbb028e":"!pip install pycaret[full]","41ce8648":"from pycaret.classification import *","f2116ff0":"forest= setup(data=data,\n          target = \"Cover_Type\",  session_id=42,\n          normalize=True,\n          train_size = 0.8, # training over 80% of available data\n          handle_unknown_categorical = True, \n          remove_multicollinearity = True, #drop one of the two features that are highly correlated with each other\n          ignore_low_variance = True,#all categorical features with statistically insignificant variances are removed from the dataset.    \n          ignore_features=['Id'],\n          categorical_features=['Wilderness'],\n              high_cardinality_features=['Soil'],\n          combine_rare_levels = True,\n          fix_imbalance = True,\n          unknown_categorical_method= 'most_frequent',\n          transformation = True,silent=True\n         )","507966cf":"xgboost = create_model('xgboost')\nxgboost","f1e3619d":"lightgbm = create_model('lightgbm')\nlightgbm","c8767b81":"catboost = create_model('catboost')\ncatboost","108faba0":"rf = create_model('rf')\nrf","418671ea":"et = create_model('et')\net","20f68f32":"gbc = create_model('gbc')\ngbc ","bb44d1b8":"blender = blend_models(estimator_list = [xgboost,lightgbm,catboost,\n                                        rf,et], method = 'soft')\nblender","70af5bad":"plot_model(blender,plot = 'confusion_matrix',use_train_data=True)","ac8adf83":"plot_model(blender,plot = 'confusion_matrix')","413995ac":"plot_model(blender,plot = 'class_report',use_train_data=True)","9930df61":"plot_model(blender,plot = 'class_report')","3198ab2c":"predict_model(blender)","b015226f":"final_blender_soft_6models = finalize_model(blender)\nfinal_blender_soft_6models","0ca6e70c":"test=pd.read_csv(\"..\/input\/tabular-playground-series-dec-2021\/test.csv\")\ntest.head()","03d8d951":"Wilderness_Area_cols = [col for col in test.columns if 'Wilderness_Area' in col]\nWilderness_Area_cols","5d42b067":"Wilderness_Area=test[Wilderness_Area_cols]\nWilderness_Area.head()","0b2386b4":"df_n = Wilderness_Area.apply(lambda x: x.idxmax(), axis = 1)\ndf_n.head()","465802b5":"Wilderness_Area=pd.DataFrame(df_n, columns=['Wilderness'])\nWilderness_Area.head()","630affbd":"Wilderness_Area.Wilderness.value_counts()","a68e952e":"Wilderness_Area.Wilderness=Wilderness_Area.Wilderness.map({'Wilderness_Area1':'Area1',\n                                                           'Wilderness_Area2':'Area2',\n                                                          'Wilderness_Area3':'Area3',\n                                                          'Wilderness_Area4':'Area4'})\nWilderness_Area.Wilderness.value_counts()","74f66308":"test=test.drop(['Wilderness_Area1','Wilderness_Area2','Wilderness_Area3','Wilderness_Area4'],axis=1)\ntest.head()","1b291424":"test=pd.concat([test, Wilderness_Area], axis=1)\ntest.head()","0de7b08e":"Soil_Type_cols = [col for col in test.columns if 'Soil_Type' in col]\nSoil_Type_cols","d84ff664":"Soil_Type=test[Soil_Type_cols]\nSoil_Type.head()","58319ef8":"df_n = Soil_Type.apply(lambda x: x.idxmax(), axis = 1)\ndf_n.head()","4a6663a0":"Soil_Type=pd.DataFrame(df_n, columns=['Soil'])\nSoil_Type.head()","f4264d32":"Soil_Type.Soil = Soil_Type.Soil.str.replace('Soil_', '')\nSoil_Type.Soil.value_counts()","9139a4d4":"test=test.drop(Soil_Type_cols,axis=1)\ntest.head()","6ae9dc87":"test=pd.concat([test, Soil_Type], axis=1)\ntest.head()","4afb540a":"predictions=predict_model(final_blender_soft_6models,data =test)\npredictions.head()","da7325a7":"predictions=predictions[['Id','Label']]\npredictions.head()","d86f7f91":"predictions.Label.value_counts()","02ec2cdf":"predictions.Label=predictions.Label.map({0:1,1:2,2:3})\npredictions.Label.value_counts()","cc1e2e70":"predictions.columns = ['Id', 'Cover_Type']\npredictions.head()","a0a838c4":"predictions.to_csv('.\/predictions.csv',index=False)","64b9744f":"We used Voting Classifier\n\nestimator_list = xgboost,lightgbm,catboost, rf & et\n\nmethod = soft"}}