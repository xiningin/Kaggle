{"cell_type":{"36eaeed1":"code","93dad918":"code","33106d4f":"code","6ad696aa":"code","ba6cf9b4":"code","126d7a1d":"code","5d5383e6":"code","a5c59f25":"code","f424695d":"code","58191019":"code","2c249a09":"code","8d381e09":"code","7973ad13":"code","9e2a3aa7":"code","5ca94cbd":"code","4801f061":"code","fd8ede4c":"code","e5a2e5f5":"markdown"},"source":{"36eaeed1":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np","93dad918":"data_path=\"..\/input\/the-best-sarcasm-annotated-dataset-in-spanish\/sarcasmo.tsv\"\ndata=pd.read_csv(data_path, sep='\\t')","33106d4f":"data.head()","6ad696aa":"data.isnull().sum()","ba6cf9b4":"features=data.iloc[:,1:2]","126d7a1d":"labels_Sarcasmo=data.iloc[:,2].values\nlabels_Sarcasmo=pd.get_dummies(labels_Sarcasmo)\nlabels_Sarcasmo=labels_Sarcasmo.iloc[:,0].values","5d5383e6":"labels_Sarcasmo.shape","a5c59f25":"import nltk\nnltk.download()","f424695d":"from nltk.stem import WordNetLemmatizer\nfrom nltk.corpus import stopwords\nimport re","58191019":"corpus=[]\nlemmatizer=WordNetLemmatizer()\nfor i in range(len(features.Locuci\u00f3n)):\n  sent=features.Locuci\u00f3n[i]\n  sent=re.sub(\"[^a-zA-Z]\",\" \",sent)\n  sent=sent.lower()\n  sent=sent.split()\n  \n  word_wt_sw=[]\n  for word in sent:\n    if word not in stopwords.words(\"spanish\"):\n      word_wt_sw.append(lemmatizer.lemmatize(word))\n  sentence=\" \".join(word_wt_sw)\n  corpus.append(sentence)\n","2c249a09":"corpus[1]","8d381e09":"features.Locuci\u00f3n[1]","7973ad13":"from sklearn.feature_extraction.text import CountVectorizer\ncv=CountVectorizer(max_features=5000)","9e2a3aa7":"X=cv.fit_transform(corpus)\ny=np.array(labels_Sarcasmo)","5ca94cbd":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2,random_state=0)\nfrom sklearn.naive_bayes import MultinomialNB\nnaivbas=MultinomialNB()","4801f061":"naivbas.fit(X_train,y_train)\ny_pred=naivbas.predict(X_test)","fd8ede4c":"from sklearn.metrics import confusion_matrix,accuracy_score\nprint(\"Accuarcy Score\",accuracy_score(y_pred,y_test))\nconfusion_matrix(y_pred,y_test)\n","e5a2e5f5":"**We can clearly see the differnce in the sentences as stop words are removed along with punctuations**"}}