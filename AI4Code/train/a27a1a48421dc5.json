{"cell_type":{"8e212b38":"code","48cda19a":"code","2b0a3fe2":"code","8c87ddc2":"code","31b08354":"code","acfcdeaf":"code","8194475f":"code","320ea054":"code","f2cceea2":"code","de7a65cc":"code","1287d9c5":"code","ac4ecde7":"code","57767732":"code","d9a37f71":"code","10551924":"code","195963f6":"code","927272c1":"code","2e5cd37c":"code","36770be6":"code","95da4fb0":"code","ac383fec":"code","56ec9f81":"code","039c93ad":"code","b7acc2dd":"code","73e8a8bd":"code","4048a516":"code","f819a05b":"code","a77e8b8a":"code","9fb6d789":"code","f61d938d":"code","e46fd4a2":"code","46144fde":"code","92200cff":"code","d71a83ef":"code","6cf920df":"code","68919b3a":"code","600398e1":"code","de7641cb":"code","e32ba812":"code","e0853135":"code","a7e21347":"code","9b3e9b8d":"code","113b4540":"code","07243e38":"code","85182912":"code","180dd1e5":"code","65c98f5b":"code","6c5a7edf":"code","700dce35":"code","9ae5ae48":"code","7b35fce1":"code","8d71eb4d":"code","4ed8967a":"markdown","b4ba7740":"markdown","86094865":"markdown","93a4e3fb":"markdown","5d8250ef":"markdown","24efbd8f":"markdown","f9a52b35":"markdown","00476798":"markdown","40afd1bc":"markdown","879ba852":"markdown","290a1a0c":"markdown","edc10ab7":"markdown","4458ebd9":"markdown","7cec1441":"markdown","769d9785":"markdown","724465b2":"markdown","aef511a1":"markdown","e2072b54":"markdown","087a82be":"markdown","1e2f35f9":"markdown"},"source":{"8e212b38":"  #Bibliotecas para manipula\u00e7\u00e3o dos dados\n\nimport pandas as pd\nimport numpy as np\nfrom datetime import datetime\n    \n    #Bibliotecas de gr\u00e1fico\nimport matplotlib.pyplot as plt\n%matplotlib inline\nfrom matplotlib.pylab import rcParams\nrcParams['figure.figsize']=20,10\nplt.style.use('ggplot')\nimport seaborn as sns\nimport plotly.offline as py\nimport plotly.graph_objs as go\npy.init_notebook_mode(connected=True)\nfrom plotly.subplots import make_subplots\n    \n    #Bibliotecas para constru\u00edmos a LSTM\nfrom keras.models import Sequential\nfrom keras.layers import LSTM,Dropout,Dense,LeakyReLU\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import train_test_split\n    #Bibliotecas para as m\u00e9tricas\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.metrics import mean_absolute_error\nfrom math import sqrt\nfrom scipy import stats\n\n    #Biblioteca para retirar avisos\nimport warnings\nwarnings.filterwarnings(\"ignore\")","48cda19a":"#carregando a base hist\u00f3rica da BBAS3\nbase=pd.read_excel('..\/input\/cotacaobbas3\/cotacao.xls',header=1, decimal=',')","2b0a3fe2":"#from pandas_datareader.data import DataReader\n#from datetime import datetime\n#base = DataReader('BBAS3.SA', data_source='yahoo', start='2010-11-01', end=datetime.now())","8c87ddc2":"#base.columns=['M\u00e1xima','M\u00ednima','Abertura','Fechado','Volume','Aj_Fechado']","31b08354":"base.head()","acfcdeaf":"#usando coluna 'Data' como \u00edndice\nbase.set_index('Data', inplace=True)","8194475f":"#invertendo dataset para ordem crescente de datas\nbase=base[::-1]","320ea054":"base.head()","f2cceea2":"base.tail()","de7a65cc":"base.info()","1287d9c5":"base.Varia\u00e7\u00e3o[0], type(base.Varia\u00e7\u00e3o[0])","ac4ecde7":"base.Varia\u00e7\u00e3o=(base['Varia\u00e7\u00e3o'].str.replace('%', '')).str.replace(',','.').astype('float')","57767732":"base.info()","d9a37f71":"#descri\u00e7\u00e3o dos dados\npd.set_option('display.float_format','{:.2f}'.format)\nbase.describe().transpose()","10551924":"base.corr()","195963f6":"corr=base.corr()\nmask = np.zeros_like(corr, dtype=np.bool)\nmask[np.triu_indices_from(mask, 1)] = True\nsns.heatmap(corr, mask=mask, cmap='RdBu', square=True, linewidths=.5)","927272c1":"per\u00edodo=base[1150:1200]\nfig = go.Figure(data=[go.Candlestick(x=per\u00edodo.index,\n                open=per\u00edodo['Abertura'],\n                high=per\u00edodo['M\u00e1xima'],\n                low=per\u00edodo['M\u00ednima'],\n                close=per\u00edodo['Fechado'])])\nfig.update_layout(\n    title='Candlestick BBAS3',\n    yaxis_title='Pre\u00e7o R$',\n    xaxis_rangeslider_visible=False\n    \n)\nfig.show()","2e5cd37c":"trace1 = go.Scatter(x =base.index,\n                    y = base.Abertura,\n                    mode = 'lines',\n                    name = 'Abertura',\n                    line = {'color': 'Blue'})\n\ntrace2 = go.Scatter(x = base.index,\n                    y =base.Fechado,\n                    mode = 'lines',\n                    name = 'Fechado',\n                    line = {'color': 'yellow'})\n\ntrace3 = go.Scatter(x = base.index,\n                    y =base.M\u00e1xima,\n                    mode = 'lines',\n                    name = 'M\u00e1xima',\n                    line = {'color': 'green'})\n\ntrace4 = go.Scatter(x = base.index,\n                    y =base.M\u00ednima,\n                    mode = 'lines',\n                    name = 'Minima',\n                    line = {'color': 'red'})\n\ntrace5 = go.Scatter(x = base.index,\n                    y =base.M\u00ednima,\n                    mode = 'lines',\n                    name = 'M\u00ednima',\n                    line = {'color': 'black'})\nlayout = go.Layout(title='S\u00e9rie hist\u00f3rica pre\u00e7os BBAS3 de 22\/04\/2015 \u00e0 20\/04\/2020',\n                   yaxis={'title':'Pre\u00e7o R$'},\n                   xaxis={'title': 'Data'})\ndata = [trace1, trace2,trace3,trace4,trace5]\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)","36770be6":"plt.figure(figsize=(10,7))\nsns.set_context('notebook', font_scale=1.5, rc={'font.size':20,\n                                               'axes.titlesize':20,\n                                               'axes.labelsize':18})\nsns.kdeplot(base['Abertura'],color='green')\nsns.rugplot(base['Abertura'],color='red')\nsns.distplot(base['Abertura'],color='green')\nsns.set_style('darkgrid')\n\nplt.xlabel('Distribuicao do Preco de Abertura');","95da4fb0":"plt.figure(figsize=(10,7))\nsns.set_context('notebook', font_scale=1.5, rc={'font.size':20,\n                                               'axes.titlesize':20,\n                                               'axes.labelsize':18})\nsns.kdeplot(base['Varia\u00e7\u00e3o'],color='green')\nsns.rugplot(base['Varia\u00e7\u00e3o'],color='red')\nsns.distplot(base['Varia\u00e7\u00e3o'],color='green')\nsns.set_style('darkgrid')\n\nplt.xlabel('Distribuicao da Varia\u00e7\u00e3o');","ac383fec":"#Vamos criar uma c\u00f3pia dos dados originais para podermos manipular os dados.\ndf = base.copy()","56ec9f81":"#criando dataframe das vari\u00e1veis preditoras e target\ndf_input=df[['Abertura', 'M\u00e1xima', 'M\u00ednima', 'Volume']]\ndf_output=df.Fechado\nnum_features=len(df_input.columns)","039c93ad":"#processo para normalizar os dados\ndataset = df_input.values.reshape((-1,num_features))\nscaler = MinMaxScaler(feature_range=(0, 1)) \ndataset = scaler.fit_transform(dataset)\n\ndatasety = df_output.values.reshape((-1,1))\nscaler = MinMaxScaler(feature_range=(0, 1)) \ndatasety = scaler.fit_transform(datasety)","b7acc2dd":"#'''Para treinar nossa rede, usaremos um intervalo de tempo para prevermos o nosso pr\u00f3ximo valor'''\nlook_back = 5\nfuture_target = 1","73e8a8bd":"'''Separando os dados em treino e teste.'''\ntam = int(len(df_input) * 0.70)\ndataset_teste = dataset[tam:]\ndataset_testey = datasety[tam:]\ndataset_treino = dataset[:tam]\ndataset_treinoy = datasety[:tam]","4048a516":"#Fun\u00e7\u00e3o de transforma\u00e7\u00e3o dos dados\ndef process_data(data,data2,look_back, forward_days,jump=1):\n    X,Y = [],[]\n    for i in range(0,len(data) -look_back -forward_days +1, jump):\n        X.append(data[i:(i+look_back)])\n        Y.append(data2[(i+look_back):(i+look_back+forward_days)])\n   \n    return np.array(X),np.array(Y)","f819a05b":"#aplicando fun\u00e7\u00e3o para gerar a matriz apropriada para rede\nX, y = process_data(dataset_treino,dataset_treinoy,look_back,future_target)\ny = np.array([list(a.ravel()) for a in y])\n\nx_test, y_test = process_data(dataset_teste,dataset_testey,look_back,future_target)\ny_test = np.array([list(a.ravel()) for a in y_test])","a77e8b8a":"len(x_test[-1])\n","9fb6d789":"\nX[0],y[0]","f61d938d":"X_train, X_validate, y_train, y_validate = train_test_split(X, y, test_size=0.20, random_state=42)","e46fd4a2":"#Definindo os n\u00fameros de neur\u00f4nios por camada\nn_first =128\nEPOCHS = 10\n#Construido o modelo\nmodel = Sequential()\nmodel.add(LSTM(n_first,input_shape = (look_back,num_features)))\nmodel.add(LeakyReLU(alpha=0.3))\nmodel.add(Dropout(0.3))\nmodel.add(Dense(future_target))\nmodel.compile(loss='mean_squared_error', optimizer='adam')\n\nhistory = model.fit(X_train,y_train,epochs=EPOCHS,validation_data=(X_validate,y_validate),shuffle=False,batch_size=2, verbose=1)","46144fde":"#Gr\u00e1fico do resultado da fun\u00e7\u00e3o perda por epochs\nplt.figure(figsize = (15,10))\nplt.plot(history.history['loss'], label='loss')\nplt.plot(history.history['val_loss'], label='val_loss')\nplt.xlabel(\"N\u00famero de Epochs\")\nplt.legend(loc='best',fontsize=15)\nplt.show()","92200cff":"#Salvando os valores preditos\nXt = model.predict(x_test)","d71a83ef":"#Voltando os dados para formato original\npredito=pd.DataFrame(scaler.inverse_transform(Xt.reshape(-1,1)))[0]\nteste= pd.DataFrame((scaler.inverse_transform(y_test.reshape(-1,1))))[0]","6cf920df":"RME=sqrt(mean_squared_error(teste, predito))\nRME","68919b3a":"RME=sqrt(mean_squared_error(teste, predito))\nRME","600398e1":"\nRME=sqrt(mean_squared_error(teste, predito))\nRME","de7641cb":"def mean_absolute_percentage_error(y_true, y_pred): \n    y_true, y_pred = (y_true, y_pred)\n\n\n    return np.mean(np.abs((y_true - y_pred) \/ y_true)) * 100","e32ba812":"MAPE=mean_absolute_percentage_error(teste,predito)\nMAPE","e0853135":"MAPE=mean_absolute_percentage_error(teste,predito)\nMAPE","a7e21347":"mae=mean_absolute_error(teste, predito)","9b3e9b8d":"mae","113b4540":"mae","07243e38":"trace1 = go.Scatter(x = df.index,\n                    y = teste,\n                    mode = 'lines',\n                    name = 'teste',\n                    line = {'color': 'blue'})\n\ntrace2 = go.Scatter(x = df.index,\n                    y = predito,\n                    mode = 'lines',\n                    name = 'Predito',\n                    line = {'color': 'red'})\nlayout = go.Layout(title='comparativo valor real e predito',\n                   yaxis={'title':'Pre\u00e7o R$'},\n                   xaxis={'title': 'Data'})\ndata = [ trace1,trace2]\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)","85182912":"    x=teste\n    y=predito\n    slope, intercept, r_value, p_value, std_err = stats.linregress(x, y)\n    print(\"R-squared: %f\" % r_value**2)\n    plt.figure(figsize = (15,10))\n    plt.plot(x, y, 'o', label='original data')\n    plt.plot(x, intercept + slope*x, 'r', label='fitted line')\n    plt.legend()\n    plt.show()","180dd1e5":"plt.figure(figsize = (15,10))\n#plt.plot(history.history['loss'], label='loss')\nplt.plot((teste-predito)\/predito*100,label='%erro')\nplt.xlabel(\"N\u00famero de observa\u00e7\u00f5es\")\nplt.legend(loc='best',fontsize=15)\nplt.show()","65c98f5b":"#fun\u00e7\u00e3o para observar a tend\u00eancia dos pre\u00e7os\ntend=pd.DataFrame({'dia_anterior':teste.shift(periods=1),'teste':teste,'predito':predito,'var':teste-teste.shift(periods=1)})\ntend['tend']=np.where(tend['var']>0,'subiu','baixou')\ntend['varp']=predito-tend.dia_anterior\ntend['pred']=np.where(tend['varp']>0,'subiu','baixou')\ntend['acertou']=tend.tend==tend.pred\n","6c5a7edf":"tend","700dce35":"acertos=sum(tend.acertou)\nacertos","9ae5ae48":"perc=round((sum(tend.acertou)\/len(tend)*100),2)","7b35fce1":"print(round((sum(tend.acertou)\/len(tend)*100),2),'%')","8d71eb4d":"print('Nosso modelo de treinamento acertou a previs\u00e3o de tend\u00eancia em', acertos,'de',len(tend),'cota\u00e7\u00f5es', 'performando em', perc,'% do total' )","4ed8967a":"Por fim criamos uma c\u00e9lula para fazer a verifica\u00e7\u00e3o do acerto de tend\u00eancias das varia\u00e7\u00f5es, considerando que a previs\u00e3o da tend\u00eancia seria \u00fatil para decis\u00e3o de compra ou venda da a\u00e7\u00e3o.","b4ba7740":"Com base nas informa\u00e7\u00f5es da fun\u00e7\u00e3o info() nota-se que a coluna 'Varia\u00e7\u00e3o' n\u00e3o \u00e9 do tipo num\u00e9rico, sendo necess\u00e1ria sua transforma\u00e7\u00e3o para a an\u00e1lise gr\u00e1fica que faremos adiante. ","86094865":"Outra analise interessante, \u00e9 a correla\u00e7\u00e3o entre as vari\u00e1veis que determina o grau de relacionamento entre duas vari\u00e1veis.","93a4e3fb":"> #   *Previs\u00e3o de Valores em Mercado de A\u00e7\u00f5es*\nProposta de Tema para Trabalho de Conclus\u00e3o do Curso de\nEspecializa\u00e7\u00e3o em Ci\u00eancia de Dados.\n\n    Proposto pelo professor Fernando Vieira da Silva\n\n    Alunos : Almir Rog\u00e9rio de Macedo RA 191338\n             Wagner Nardi Lopes      RA 191229\n             \n             \n# 1. Motiva\u00e7\u00e3o:\n\n\nAo analisar uma s\u00e9rie temporal hist\u00f3rica de um ativo no mercado de  a\u00e7\u00f5es \u00e9 poss\u00edvel notar pequenas oscila\u00e7\u00f5es caracter\u00edsticas em seus valores que se acentuam  em momentos de crescimento e per\u00edodos de crise [1]\nDiversos m\u00e9todos s\u00e3o adotados com intuito de prever melhor cen\u00e1rio poss\u00edvel para negocia\u00e7\u00f5es de compra ou venda de a\u00e7\u00f5es com inten\u00e7\u00e3o de obter melhores ganhos ou evitar perdas monet\u00e1rias, dentre esses a an\u00e1lise t\u00e9cnica na qual a premissa fundamental deste instrumental se baseia no fato de que as oscila\u00e7\u00f5es dos pre\u00e7os correntes dos ativos s\u00e3o correlacionados com o movimento de seus pre\u00e7os ocorrida no passado[2].\n\nA previs\u00e3o do mercado de a\u00e7\u00f5es usando a t\u00e9cnica de aprendizado de m\u00e1quina visa desenvolver modelos eficazes e eficientes que podem fornecer uma taxa mais alta de precis\u00e3o.[3]\n \n# 2. Objetivos:\n\n\nColetar dados de uma s\u00e9rie hist\u00f3rica de cota\u00e7\u00f5es de um ativo do mercado de a\u00e7\u00f5es com finalidade de analise e utiliza\u00e7\u00e3o para treinamento e cria\u00e7\u00e3o de um modelo para an\u00e1lise preditiva de seu valor para o dia seguinte com base nas entradas de dados anteriores.\nCarregar esses dados utilizando biblioteca Pandas em linguagem python.\nDe posse dos dados, analisar o dataframe gerados com pandas.\nEfetivar transforma\u00e7\u00f5es necess\u00e1rias para an\u00e1lise gr\u00e1fica dos dados.\nPreparar os dados para utiliza\u00e7\u00e3o em uma rede LSTM de aprendizado de m\u00e1quina.\nRealizar treinamento e predi\u00e7\u00f5es.\ncomparar os resultados das predi\u00e7\u00f5es.\n\n# 2. Resumo te\u00f3rio:\n\n\n\nPRedes Neurais Recorrentes (RNNs) da qual faz parte a LSTM (Long Short Term Memory) s\u00e3o capazes de reconhecer padr\u00f5es em sequ\u00eancia de dados em dimens\u00e3o temporal.[4]\nA c\u00e9lula Mem\u00f3ria Longa de Curto Prazo (LSTM) foi proposta em 1997 (https:\/\/goo.gl\/j39AGv) por Sepp Hochreiter e Jurgen Schmidhuber e aperfei\u00e7oada por muitos outros pesquisadores atrav\u00e9s dos anos.\nC\u00e9lulas LSTM gerenciam dois vetores de estado, e por raz\u00f5es de desempenho s\u00e3o mantidos separados por padr\u00e3o.\n\nArquitetura b\u00e1sica de uma c\u00e9lula LSTM\n<center><img src=\"https:\/\/encrypted-tbn0.gstatic.com\/images?q=tbn:ANd9GcTs8peb66aobWLfaKRZcCoHkCq3N96Zu0lU9Q&usqp=CAU\" width=\"600\"><\/img><\/center>\n \n\n\n\n\n\n\n\n\n\n\n\n\nA ideia chave \u00e9 que a rede possa aprender o que armazenar no estado de longo prazo, o que jogar fora e o que ler a partir dele.\nComo o estado de longo prazo c(t-1)  atravessa a rede da esquerda para a direita, onde passa primeiro por um forget gate, descartando algumas mem\u00f3rias e adicionando algumas novas mem\u00f3rias atrav\u00e9s da opera\u00e7\u00e3o de adi\u00e7\u00e3o (que acrescenta as mem\u00f3rias  que foram selecionadas por um input gate).\nO resultado c(t) \u00e9 enviado diretamente sem qualquer transforma\u00e7\u00e3o adicional. Ent\u00e3o algumas mem\u00f3rias s\u00e3o descartadas e algumas s\u00e3o adicionadas a cada intervalo de tempo. Ap\u00f3s a opera\u00e7\u00e3o de adi\u00e7\u00e3o, o estado de longo prazo \u00e9 copiado e passado pela fun\u00e7\u00e3o tanh, em seguida seu resultado \u00e9 filtrado pelo output gate, produzindo o estado de curto prazo h(t) (que \u00e9 igual \u00e0 sa\u00edda da c\u00e9lula para este intervalo de tempo y(t)). Abaixo \u00e9 demonstrado de onde v\u00eam as novas mem\u00f3rias e como funcionam as portas.\n\nPrimeiro o vetor de entrada atual x(t) e o estado de curto prazo anterior h(t-1) s\u00e3o fornecidos para quatro camadas diferentes totalmente conectadas. Todos servem a um prop\u00f3sito diferente:\n\nA camada principal \u00e9 aquela que produz g(t) e, normalmente, assume o papel de analisar as entradas atuais x(t) e o estado anterior (de curto prazo) h(t-1). Em uma c\u00e9lula b\u00e1sica n\u00e3o h\u00e1 nada al\u00e9m desta camada e sua sa\u00edda vai direto para y(t) e h(t). Em contraste, em uma c\u00e9lula LSTM a sa\u00edda dessa camada n\u00e3o se extingue diretamente, mas \u00e9 armazenada parcialmente no estado de longo prazo;\n\nAs tr\u00eas outras camadas s\u00e3o gate controllers. Como elas utilizam a fun\u00e7\u00e3o de ativa\u00e7\u00e3o log\u00edstica, suas sa\u00eddas variam de 0 a 1, suas sa\u00eddas s\u00e3o fornecidas para  opera\u00e7\u00f5es de multiplica\u00e7\u00e3o  elemento por elemento, ent\u00e3o se eles geram 0 (zeros), fecham o gate se geram 1 (um), os gates se abrem. Especificamente: \n\t\to forget date (controlado por f(t)), controla quais partes do estado de longo prazo devem ser apagadas;\n\t\to input gate (controlado por i(t)) controla quais partes de g(t) devem ser adicionadas ao estado de longo prazo;\n\t\to output gate (controlado por o(t)) controla quais partes do estado de longo prazo devem ser lidas e exibidas neste intervalo de tempo (ambos para h(t)) e y(t).\n\nEm resumo, uma c\u00e9lula LSTM pode aprender a reconhecer uma entrada importante (papel do input gate), armazen\u00e1-la no estado de longo prazo, aprender a preserv\u00e1-la pelo tempo necess\u00e1rio (papel do forget date) e aprender a extra\u00ed-la sempre que for preciso.\n\nA equa\u00e7\u00e3o abaixo resume como calcular em cada intervalo de tempo para uma \u00fanica inst\u00e2ncia, o estado de longo prazo da c\u00e9lula, seu estado de curto prazo e sua sa\u00edda.\n\n\n\n<center><img src=\"https:\/\/storage.googleapis.com\/kagglesdsdata\/datasets\/1044679\/1757591\/imagemformula.png?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=databundle-worker-v2%40kaggle-161607.iam.gserviceaccount.com%2F20201218%2Fauto%2Fstorage%2Fgoog4_request&X-Goog-Date=20201218T093648Z&X-Goog-Expires=172799&X-Goog-SignedHeaders=host&X-Goog-Signature=3804bb0dbd0d1b1776fcab0336a1ec4d5a3d79fe1281b47b8c36665b563d5a45a537bed2a3124388fb44d0ded7fd06f53aaa7c9eb433e4edb94636ab39cc3e68076d2ce4aa0988a0ff785850f0b503b890fb49d07782edf109221925848b0307fbfd99d245060a7a2020dbc223e7f8d7216b64c03ad41e884a3c7b0365d9bab2434fbba7d367e9dea218e2c3315c585e58f8c5614ad3d62ea46d57f5ff5fadcbbf9bf83c113ffa9e8b4be1bb21b97f078171bec37e02c9cee622787bfa86ee58207d383c75d28b5abc67d3526aadcd89ee2c8a698b9b57e3926587d511ac3e07fb30c1d176bef6dae6f8a9ef62cbf7592e56d1dc3e6c962f16bc4217b8544900\" width=\"600\"><\/img><\/center>\n\n\n\n\n\n\n\n\n\n\n\n\nWxi,Wxf, Wxo,Wxg s\u00e3o matrizes de peso de cada uma das quatro camadas para suas  com o vetor de entrada x(t); \n \nWhi, Whf, Who, Whg s\u00e3o  matrizes de peso de cada uma das quatro camadas para suas conex\u00f5es com o estado anterior de curto prazo h(t-1);\n\nbi, bf, bo, bg s\u00e3o os termos de polariza\u00e7\u00e3o para cada uma das quatro camadas.\n\n\nExtra\u00eddo de M\u00e3os \u00e0 Obra: Aprendizado de M\u00e1quina com Scikit-Learn & TensorFlow \u2013 Aur\u00e9lien G\u00e9ron \u2013 Editora O\u2019Reilly \u2013 Alta Books Editora 2019.\n\n# 3. Fonte de Dados:\nOs dados foram coletados em  (https:\/\/ri.bb.com.br\/servicos-para-investidores\/historico-de-cotacoes\/) no dia 17\/04\/2020 com base di\u00e1ria dos \u00faltimos 5 anos.\n\n# 4. Refer\u00eancias:\n\n1.TIB\u00daRCIO SILVA, C. A.; CARVALHO, C. C. de; NUNES, D. M. S. O Que Move o Pre\u00e7o da A\u00e7\u00e3o? Uma Abordagem sobre a Influ\u00eancia das Not\u00edcias no Mercado Acion\u00e1rio1\nhttps:\/\/pdfs.semanticscholar.org\/ec24\/faa7c107413ea3282e370f17f6a4932f0ba7.pdf \n\n2.SANTANA, Genilson Fernandes. O poder de previs\u00e3o da\nan\u00e1lise t\u00e9cnica: uma aplica\u00e7\u00e3o para o mercado futuro 'de\nIBOVESPA. S\u00e3o Paulo: EAESP\/FGV, 1997.\nhttps:\/\/bibliotecadigital.fgv.br\/dspace;\/bitstream\/handle\/10438\/5431\/1199700690.pdf \n\n3.Nti, I.K., Adekoya, A.F. & Weyori, B.A. A comprehensive evaluation of ensemble learning for stock-market prediction. J Big Data 7, 20 (2020). https:\/\/doi.org\/10.1186\/s40537-020-00299-5\n\n\n\n4.Material apreendido em aulas do curso de p\u00f3s em ci\u00eancias de dados turma 2019 (https:\/\/www.facens.br\/cursos\/pos-graduacao)\n\n5.Gorito, Matheus. Cientista de Dados e Engenheiro de Machine Learning no Banco do Brasil Workshop https:\/\/bbdataconweek.com.br\/predicao-do-preco-de-acoes-usando-redes-neurais (em 24\/07\/2020)\n\n6.https:\/\/paulovasconcellos.com.br\/como-criar-gr%C3%A1ficos-interativos-utilizando-plotly-e-python-\n3eb6eda57a2b\n\n\n7.https:\/\/medium.com\/alexandre-george-lustosa\/previs%C3%A3o-de-pre%C3%A7o-petr4-com-python-lstm-f93722be59e0\n\n\n8.https:\/\/plotly.com\/python\/candlestick-charts\/\n\n\n\n9.https:\/\/tc.com.br\/tc-school\/analise-tecnica\/candlesticks\/\n\n\n10.Aprendizado de M\u00e1quina com Scikit-Learn & TensorFlow \u2013 Aur\u00e9lien G\u00e9ron \u2013 Editora O\u2019Reilly \u2013 Alta Books Editora 2019\n\n\n\n\n\n\n","5d8250ef":"As var\u00e1veis open('Abertura), high('M\u00e1xima'), low('M\u00ednima') e close('Fechado') s\u00e3o usadas na constru\u00e7\u00e3o do gr\u00e1fico Candestick que \u00e9 popularmente aplicado em an\u00e1lise t\u00e9cnica, neste gr\u00e1fico \u00e9 apresentado o comportamento de varia\u00e7\u00e3o  num curto espa\u00e7o de tempo dentro da s\u00e9rie temporal, no nosso caso diariamente.","24efbd8f":"<center><img src=\"https:\/\/tc.com.br\/wp-content\/uploads\/2019\/07\/exemplo-at2.jpg\" width=\"600\"><\/img><\/center>","f9a52b35":"# Colunas do dataset:\n\n* Data    :  Data de abertura das negocia\u00e7\u00f5es no mercado da  bolsa de valores.\n* Abertura:  Pre\u00e7o no momento da abertura de mercado.\n* M\u00e1xima  :  Pre\u00e7o m\u00e1ximo ocorrido durante o dia.\n* M\u00ednima  :  Pre\u00e7o m\u00ednimo ocorrido durante o dia.\n* Fechado :  Ultimo pre\u00e7o registrado no fechamento de mercado.\n* M\u00e9dia   :  Quantidade de a\u00e7\u00f5es dividido pelo volume.\n* Varia\u00e7\u00e3o:  Varia\u00e7\u00e3o percentual do pre\u00e7o da a\u00e7\u00e3o comparado pre\u00e7o fechamento dia anterior.\n* Volume  :  Valor total negociado durante o dia.\n* Qtde de\n  A\u00e7\u00f5es   : N\u00famero de a\u00e7\u00f5es negociadas durante o dia.\n* Neg\u00f3cios: N\u00famero de neg\u00f3cios efetuados durante o dia.","00476798":"Com a fun\u00e7\u00e3o describe(), obtemos uma descri\u00e7\u00e3o estat\u00edstica das colunas do nosso dataset, nesse ponto tamb\u00e9m \u00e9 poss\u00edvel detectar a presen\u00e7a de eventuais outliers.","40afd1bc":"Agora carregamos o arquivo xls que cont\u00e9m a base hist\u00f3rica da BBAS3 previamente baixado.","879ba852":"Aplicamos novamente a fun\u00e7\u00e3o head() e na sequencia a fun\u00e7\u00e3o tail() para certificarmos que o dataset se apresenta na ordem crescente de datas e com intervalo de tempo pretendido.","290a1a0c":"H\u00e1 dois tipos de Candlestick, que depende do comportamento das vari\u00e1veis abertura e fechamento, se o ativo abriu com pre\u00e7o em baixa e fechou em alta: Candlestick de alta, se o ativo abriu com pre\u00e7o em alta e fechou em baixa: Candlestik de baixa.","edc10ab7":"Aqui apresentamos a distribui\u00e7\u00e3o do pre\u00e7o de abertura que demonstra o comportamento da frequ\u00eancia dos pre\u00e7os da a\u00e7\u00e3o e na sequ\u00eancia a frequ\u00eancia da varia\u00e7\u00e3o percentual","4458ebd9":"O dado coletado na coluna 'Varia\u00e7\u00e3o' \u00e9 do tipo 'str' formado por um n\u00famero e pelo caractere especial '%\", neste caso iremos eliminar o caractere especial e transformar o n\u00famero do tipo 'str' para tipo 'float para que posteriormente possamos fazer a an\u00e1lise gr\u00e1fica dessa vari\u00e1vel tamb\u00e9m.","7cec1441":"Observamos que a primeira linha corresponde a \u00faltima data coletada, e como queremos que nosso dataset se apresente em ordem crescente de datas iremos fazer nossa primeira altera\u00e7\u00e3o, e para isso \u00e9 utilizado a nota\u00e7\u00e3o de slice do PYTHON(fatiamento com passo negativo que inverte a ordem dos \u00edndices),mas antes iremos definir a coluna data como \u00edndice.","769d9785":"Temos nosso dataset em ordem crescente de dados, conhecemos o \u00ednicio e o fim e seu intervalo de tempo, mas ainda n\u00e3o sabemos o formato do conte\u00fado de cada coluna, seu tamanho real e se h\u00e1 algum dado faltante, para isso iremos utilizar a fun\u00e7\u00e3o info() que nos trar\u00e1 essas informa\u00e7\u00f5es e ainda nos mostrar\u00e1 o tamanho da mem\u00f3ria ocupada o total de linhas e colunas.","724465b2":"Na pr\u00f3xima c\u00e9lula apresentamos um gr\u00e1fico utilizando as colunas (Abertura,Fechado,M\u00e1xima,M\u00ednima e M\u00e9dia) que nos d\u00e1 a vis\u00e3o da varia\u00e7\u00e3o ocorrida ao longo dos 5 anos da s\u00e9rie hist\u00f3rica do nosso dataset.","aef511a1":"Em primeiro lugar temos que importar para nosso notebook as bibliotecas que j\u00e1 temos pr\u00e9-instaladas, para executar as diversas tarefas, dentre elas: manipula\u00e7\u00e3o dos dados, apresenta\u00e7\u00e3o dos gr\u00e1ficos e a constru\u00e7\u00e3o do modelo LSTM.","e2072b54":"Aqui se observa alto grau de correla\u00e7\u00e3o entre as vari\u00e1veis das colunas 'Abertura',\t'M\u00e1xima','M\u00ednima','Fechado'e'M\u00e9dia', o que j\u00e1 era esperado pois elas indicam a varia\u00e7\u00e3o que ocorre diariamente no pre\u00e7o das a\u00e7\u00f5es e veremos com mais detalhes no gr\u00e1fico de candlestick, as demais praticamente nada se correlacionam com exce\u00e7\u00f5es das colunas volume que mostram uma fraca correla\u00e7\u00e3o entre ela e com essas quatro e as colunas voume, quantidade de a\u00e7\u00f5es e neg\u00f3cios conforme poderemos ver no gr\u00e1fico abaixo o que indica que conforme o pre\u00e7o das a\u00e7\u00f5es variam, h\u00e1 alguma interfer\u00eancia nessas vari\u00e1veis.","087a82be":"Nota-se que a varia\u00e7\u00e3o do percentual apresenta um certo equil\u00edbrio mantendo uma faixa equivalente entre negativa e positiva com maior frequ\u00eancia pr\u00f3ximo ao zero com uma leve tend\u00eancia positiva.","1e2f35f9":"Utilizamos a fun\u00e7\u00e3o head() para visualizamos as v\u00e1ri\u00e1veis e as primeiras 5 linhas do nosso dataset."}}