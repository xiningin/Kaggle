{"cell_type":{"727ad2d2":"code","33942ecd":"code","2ba9e7dc":"code","271cf7e8":"code","eda8c804":"code","7657b7a2":"code","8a2efaf6":"code","1943196b":"code","d15d2686":"code","2ea68984":"code","37fb3e90":"markdown","0fefbf94":"markdown"},"source":{"727ad2d2":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport math\npd.options.display.max_columns = 999","33942ecd":"pitch_stat = pd.read_csv('\/kaggle\/input\/mlb-statcast-data\/Statcast_2020.csv')\npitch_stat = pitch_stat[(pitch_stat['balls'] <= 3)& (pitch_stat['strikes'] <= 2)]","2ba9e7dc":"pitch_stat['yR'] = 60-pitch_stat.release_extension\npitch_stat['tR'] = (-pitch_stat.vy0 - (pitch_stat.vy0**2-2*pitch_stat.ay*(50-pitch_stat.yR))**0.5)\/pitch_stat.ay\npitch_stat['vxR'] = pitch_stat.vx0 + pitch_stat.ax * pitch_stat.tR\npitch_stat['vyR'] = pitch_stat.vy0 + pitch_stat.ay * pitch_stat.tR\npitch_stat['vzR'] = pitch_stat.vz0 + pitch_stat.az * pitch_stat.tR\npitch_stat['dv0'] = pitch_stat.release_speed - (pitch_stat.vxR**2+pitch_stat.vyR**2+pitch_stat.vzR**2)**0.5\/1.467\npitch_stat['tf'] = (-pitch_stat.vyR-(pitch_stat.vyR**2-2*pitch_stat.ay*(pitch_stat.yR-17\/12))**0.5)\/pitch_stat.ay\n\npitch_stat['x_mvt'] = pitch_stat.plate_x - pitch_stat.release_pos_x - (pitch_stat.vxR\/pitch_stat.vyR)*(17\/12-pitch_stat.yR)\npitch_stat['z_mvt'] = pitch_stat.plate_z - pitch_stat.release_pos_z - (pitch_stat.vzR\/pitch_stat.vyR)*(17\/12-pitch_stat.yR) + 0.5*32.174*pitch_stat.tf**2\n\npitch_stat['vxbar'] = (2*pitch_stat.vxR+pitch_stat.ax*pitch_stat.tf)\/2\npitch_stat['vybar'] = (2*pitch_stat.vyR+pitch_stat.ay*pitch_stat.tf)\/2\npitch_stat['vzbar'] = (2*pitch_stat.vzR+pitch_stat.az*pitch_stat.tf)\/2\npitch_stat['vbar'] = (pitch_stat.vxbar**2+pitch_stat.vybar**2+pitch_stat.vzbar**2)**0.5\n\n\npitch_stat['adrag'] = -(pitch_stat.ax*pitch_stat.vxbar+pitch_stat.ay*pitch_stat.vybar+(pitch_stat.az+32.174)*pitch_stat.vzbar)\/pitch_stat.vbar\npitch_stat['Cd'] = pitch_stat.adrag\/(5.153E-03*pitch_stat.vbar**2)\n\npitch_stat['amagx'] = pitch_stat.ax+pitch_stat.adrag*pitch_stat.vxbar\/pitch_stat.vbar\npitch_stat['amagy'] = pitch_stat.ay+pitch_stat.adrag*pitch_stat.vybar\/pitch_stat.vbar\npitch_stat['amagz'] = pitch_stat.az+pitch_stat.adrag*pitch_stat.vzbar\/pitch_stat.vbar+32.174\npitch_stat['amag'] = (pitch_stat.amagx**2+pitch_stat.amagy**2+pitch_stat.amagz**2)**0.5\n\npitch_stat['Mx'] = 0.5*pitch_stat.amagx*pitch_stat.tf**2*12\npitch_stat['Mz'] = 0.5*pitch_stat.amagz*pitch_stat.tf**2*12\n\npitch_stat['Cl'] = pitch_stat.amag\/(5.153E-03*pitch_stat.vbar**2)\npitch_stat['S'] = 0.4*pitch_stat.Cl\/(1-2.32*pitch_stat.Cl)\n\npitch_stat['spinT'] = 78.92*pitch_stat.S*pitch_stat.vbar\npitch_stat['spinTX'] = pitch_stat.spinT*(pitch_stat.vybar*pitch_stat.amagz-pitch_stat.vzbar*pitch_stat.amagy)\/(pitch_stat.amag*pitch_stat.vbar)\npitch_stat['spinTY'] = pitch_stat.spinT*(pitch_stat.vzbar*pitch_stat.amagx-pitch_stat.vxbar*pitch_stat.amagz)\/(pitch_stat.amag*pitch_stat.vbar)\npitch_stat['spinTZ'] = pitch_stat.spinT*(pitch_stat.vxbar*pitch_stat.amagy-pitch_stat.vybar*pitch_stat.amagx)\/(pitch_stat.amag*pitch_stat.vbar)\n\npitch_stat['spin_check'] = (pitch_stat.spinTX**2+pitch_stat.spinTY**2+pitch_stat.spinTZ**2)**0.5-pitch_stat.spinT\n\npitch_stat['phi'] = np.arctan2(pitch_stat.amagz,pitch_stat.amagx)*180\/math.pi\npitch_stat['phi'] = pitch_stat['phi'] + pitch_stat['amagz'].apply(lambda x: 360 if x < 0 else 0)\npitch_stat['spin_eff'] = pitch_stat.spinT\/pitch_stat.release_spin_rate\n\npitch_stat['flag'] = pitch_stat['description'].apply(lambda x: 1 if x == 'swinging_strike' else 0)\npitch_stat['flag_2'] = pitch_stat['estimated_woba_using_speedangle'].apply(lambda x: 1 if x>= 0 else 0)","271cf7e8":"spin_dir = pd.read_csv('\/kaggle\/input\/spin-direction-2020\/spin_direction_pbp.csv')\npitch_stat = pd.merge(pitch_stat,spin_dir,on=['batter','pitcher','game_pk','pitch_number','inning'])","eda8c804":"yankee_df = pitch_stat[pitch_stat['home_team'] == 'NYY']\nyankee_df  = yankee_df [~pd.isna(yankee_df .description) & (yankee_df.release_speed > 0)] ","7657b7a2":"x = np.arange(360)\ny = np.arange(360)\n\nplt.scatter(yankee_df [(yankee_df.inning_topbot == 'Top') &(yankee_df.pitch_type == 'FF')]['phi']+90,yankee_df [(yankee_df.inning_topbot == 'Top') &(yankee_df.pitch_type == 'FF')]['release_spin_direction'])\nplt.plot(x,y)\nplt.xlim([0,360])\nplt.ylim([0,360])\nplt.xlabel('Inferred Axis')\nplt.ylabel('Observed Axis')\nplt.title('Yankees stadium away pitcher 2020')","8a2efaf6":"x = np.arange(360)\ny = np.arange(360)\n\nplt.scatter(yankee_df [(yankee_df.inning_topbot == 'Bot') &(yankee_df.pitch_type == 'FF')]['phi']+90,yankee_df [(yankee_df.inning_topbot == 'Bot') &(yankee_df.pitch_type == 'FF')]['release_spin_direction'])\nplt.plot(x,y)\nplt.xlim([0,360])\nplt.ylim([0,360])\nplt.xlabel('Inferred Axis')\nplt.ylabel('Observed Axis')\nplt.title('Yankees Stadium home pitcher fastball 2020')","1943196b":"cubs_df = pitch_stat[pitch_stat['home_team'] == 'CHC']\ncubs_df  = cubs_df[~pd.isna(cubs_df .description) & (cubs_df.release_speed > 0)] ","d15d2686":"x = np.arange(360)\ny = np.arange(360)\n\nplt.scatter(cubs_df[(cubs_df.inning_topbot == 'Top') &(cubs_df.pitch_type == 'FF')]['phi']+90,cubs_df[(cubs_df.inning_topbot == 'Top') &(cubs_df.pitch_type == 'FF')]['release_spin_direction'])\nplt.plot(x,y)\nplt.xlim([0,360])\nplt.ylim([0,360])\nplt.xlabel('Inferred Axis')\nplt.ylabel('Observed Axis')\nplt.title('Wrigley Field away pitcher fastball 2020')","2ea68984":"x = np.arange(360)\ny = np.arange(360)\n\nplt.scatter(cubs_df[(cubs_df.inning_topbot == 'Bot') &(cubs_df.pitch_type == 'FF')]['phi']+90,cubs_df[(cubs_df.inning_topbot == 'Bot') &(cubs_df.pitch_type == 'FF')]['release_spin_direction'])\nplt.plot(x,y)\nplt.xlim([0,360])\nplt.ylim([0,360])\nplt.xlabel('Inferred Axis')\nplt.ylabel('Observed Axis')\nplt.title('Wrigley Field home pitcher fastball 2020')","37fb3e90":"Calculate inferred pitch data using [Alan Nathan](https:\/\/twitter.com\/pobguy) calculator","0fefbf94":"The code below show the stadium bias for inferred vs actual spin axis"}}