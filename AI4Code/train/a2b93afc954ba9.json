{"cell_type":{"da849ce0":"code","829eb0f1":"code","bdfd0724":"code","a938c1f6":"code","abf2b052":"code","5c0bd655":"code","be2df9cc":"code","6e2601b9":"code","59307ff0":"code","c15ae336":"code","b63f2835":"code","dd0e20c3":"code","7f327439":"code","ae7fb2e5":"code","e3c070cc":"code","36d9b77e":"code","c6e4f5e6":"code","47cd0479":"code","e1494383":"code","e79fca77":"code","c8d25d09":"markdown"},"source":{"da849ce0":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nimport plotly.graph_objects as go\n\nfrom mpl_toolkits.mplot3d import Axes3D\nimport seaborn as sns\n\n\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n","829eb0f1":"df = pd.read_csv('..\/input\/streeteasy-dataset\/manhattan.csv')\ndf.head()","bdfd0724":"df.info()","a938c1f6":"df.isna().sum()","abf2b052":"x = df[['size_sqft','building_age_yrs']]\ny = df[['rent']]","5c0bd655":"x_train, x_test, y_train, y_test = train_test_split(x, y, train_size = 0.8, test_size = 0.2, random_state=6)\n\nols = LinearRegression()\n\nols.fit(x_train, y_train)","be2df9cc":"fig = plt.figure(figsize=(12,12))\nsns.scatterplot(data=df, x='bedrooms', y='rent',hue= 'neighborhood', palette = 'bright', sizes=(20, 200))","6e2601b9":"fig = px.scatter_3d(df, x='rent', y='size_sqft', z='building_age_yrs', color ='neighborhood', size='rent', size_max=20)\nfig.show()","59307ff0":"fig = plt.figure(figsize=(16,12))\nax = plt.subplot()\nsns.boxplot(data=df, x='neighborhood', y='rent')\nax.set_xticklabels(labels= df['neighborhood'].unique(), rotation = 90)\nplt.show()","c15ae336":"fig = plt.figure(figsize=(16,20))\nax = plt.subplot(2,1,1)\nplt.hist2d(df['rent'], df['building_age_yrs'])\nplt.xlabel('Rent', fontsize=20)\nplt.ylabel('Building age', fontsize=20)\nax = plt.subplot(2,1,2)\npd.plotting.autocorrelation_plot(df.rent)\n\nplt.show()","b63f2835":"sns.lmplot(data=df, x= 'size_sqft', y='rent', hue='has_patio')\nplt.show()","dd0e20c3":"X= df['size_sqft'].values.reshape(-1,1)\ny= df['rent'].values.reshape(-1,1)\nmodel = LinearRegression()\nmodel.fit(X,y)\ny_new = model.predict(X)","7f327439":"x = df.iloc[:, 2:len(df.columns)-2]\ny = df.iloc[:,1:2]\nx_train, x_test, y_train, y_test = train_test_split(x, y, train_size=0.8, test_size = 0.2, random_state = 6)","ae7fb2e5":"x_train","e3c070cc":"model= LinearRegression()\nmodel.fit(x_train, y_train)\ny_predict = model.predict(x_test)\napartment = [[1,1,620,16,1,98,1,0,1,0,0,1,1,0]]\n\npredict= model.predict(apartment)\npredict","36d9b77e":"plt.figure(figsize=(12,12))\nplt.scatter(y_test, y_predict, alpha=0.4)\nplt.xlabel(\"Prices: $Y_i$\")\nplt.ylabel(\"Predicted prices: $\\hat{Y}_i$\")\nplt.title(\"Actual Rent vs Predicted Rent\")\nplt.show()","c6e4f5e6":"model.coef_","47cd0479":"plt.figure(figsize=(12,12))\nax = plt.subplot(211)\nplt.scatter(df[['size_sqft']], df[['rent']], alpha=0.4)\n\nax = plt.subplot(212)\nplt.scatter(df[['min_to_subway']], df[['rent']], alpha=0.4)\nplt.show()","e1494383":"model.score(x_train, y_train)","e79fca77":"fig = plt.figure(1, figsize=(12, 14))\n\n\nelev = 43.5\nazim = -110\n\nax = Axes3D(fig, elev=elev, azim=azim)\n\nax.scatter(x_train[['size_sqft']], x_train[['building_age_yrs']], y_train, c='k', marker='+')\n\nax.plot_surface(np.array([[0, 0], [4500, 4500]]), np.array([[0, 140], [0, 140]]), ols.predict(np.array([[0, 0, 4500, 4500], [0, 140, 0, 140]]).T).reshape((2, 2)), alpha=.7)\n\nax.set_xlabel('Size (ft$^2$)')\nax.set_ylabel('Building Age (Years)')\nax.set_zlabel('Rent ($)')\n\nax.w_xaxis.set_ticklabels([])\nax.w_yaxis.set_ticklabels([])\nax.w_zaxis.set_ticklabels([])\nplt.show()","c8d25d09":"**Let's gonna prove this model with this flat: https:\/\/streeteasy.com\/rental\/2177438**\nThis apartment have: \nFeatures\tSonny\u2019s Apartment\nbedrooms\t1\nbathrooms\t1\nsize_sqft\t620 ft\u00b2\nmin_to_subway\t16 min\nfloor\t1\nbuilding_age_yrs\t98 (built in 1920)\nno_fee\t1\nhas_roofdeck\t0\nhas_washer_dryer\tYas\nhas_doorman\t0\nhas_elevator\t0\nhas_dishwasher\t1\nhas_patio\t1\nhas_gym\t0\n"}}