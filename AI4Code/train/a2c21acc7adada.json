{"cell_type":{"f8d9d4b6":"code","07dcaa39":"code","c06035f5":"code","4b58d76d":"code","4c2c49f3":"code","6453a405":"code","dd88609e":"code","112c48f0":"code","cbb775e0":"code","baabb210":"code","960d7a59":"markdown","d61a4400":"markdown","81528399":"markdown","7cd0918d":"markdown","246745a4":"markdown","226a7a39":"markdown","b5cad7c1":"markdown","3c54c677":"markdown","a1aefeaf":"markdown"},"source":{"f8d9d4b6":"import numpy as np\nimport pandas as pd\nfrom os import listdir\nimport os\nfrom collections import defaultdict\nimport cv2\nimport matplotlib.pyplot as plt\nfrom tqdm import tqdm\nfrom IPython.display import Image","07dcaa39":"files_location = '..\/input\/generated-car-ocr\/generated_60k'\nfiles = listdir(files_location)\nfiles[:5]","c06035f5":"def renameFiles():\n    vocab = {'\u0430' : 'a', '\u0432':'b', '\u0435':'e', '\u043a': 'k', '\u043c':'m','\u043d':'h', '\u043e':'o', '\u0440':'p', '\u0441':'c', '\u0442':'t', '\u0443':'y', '\u0445':'x'}\n    for file in tqdm(files):\n        fullPath = os.path.join(files_location, file)\n        newFile = file\n        for symbol in file:\n            if symbol in vocab:\n                newFile = newFile.replace(symbol, vocab[symbol])\n        os.rename(fullPath, os.path.join(files_location, np))\n# renameFiles()\n# files = listdir(files_location)","4b58d76d":"info = defaultdict(lambda : [])\nfailures = []\nfor file in tqdm(files):\n    fullPath = os.path.join(files_location, file)\n    try:\n        image = cv2.imdecode(np.fromfile(fullPath, dtype=np.uint8), cv2.IMREAD_UNCHANGED)\n    except:\n        failures.append(file)\n        continue\n    if image is None:\n        failures.append(file)\n        continue\n    info['file'].append(file)\n    number = file.split('.', 1)[0]\n    for i in range(0,6):\n        info[f'symbol{i + 1}'].append(number[i])\n    region = number[6:]\n    info['region'].append(int(region))\n    info['region_length'].append(len(region))\n    for i in range(0, 3):\n        if i < len(region):\n            info[f'region{i + 1}'].append(region[i])\n        else:\n            info[f'region{i + 1}'].append(' ')\n    info['height'].append(image.shape[0])\n    info['width'].append(image.shape[1])\n    info['ratio'].append(image.shape[0]\/image.shape[1])","4c2c49f3":"print(len(failures))\nImage(filename=os.path.join(files_location, failures[144]))","6453a405":"dataFrame = pd.DataFrame(info)\ndataFrame","dd88609e":"figure, axes = plt.subplots(3, 1,figsize=(10,13))\n\nfor index, name in enumerate(['ratio', 'width', 'height']):\n    axes[index].set_title(name)\n    dataFrame[name].hist(ax = axes[index])","112c48f0":"figure, axes = plt.subplots(4, 1,figsize=(10,23))\n\ndataFrame['region_length'].hist(ax = axes[0])\naxes[0].set_title('Region length')\n\ndataFrame['region1'].value_counts().plot(kind='bar', ax=axes[1], title = 'First region symbol')\ndataFrame['region2'].value_counts().plot(kind='bar', ax=axes[2], title = 'Second region symbol')\ndataFrame['region3'][dataFrame['region3'] != ' '].value_counts().plot(kind='bar', ax=axes[3], title = 'Third region symbol ')","cbb775e0":"figure, axes = plt.subplots(3, 1,figsize=(10,13))\n\nfor index, name in enumerate(['symbol1', 'symbol5', 'symbol6']):\n    axes[index].set_title(name)\n    dataFrame[name].value_counts().plot(kind='bar', ax = axes[index])","baabb210":"figure, axes = plt.subplots(3, 1,figsize=(10,13))\n\nfor index, name in enumerate(['symbol2', 'symbol3', 'symbol4']):\n    axes[index].set_title(name)\n    dataFrame[name].value_counts().plot(kind='bar', ax = axes[index])","960d7a59":"I wiil try to analyse the generated car plates  to understand if we can improve them somehow","d61a4400":"No we will plot the numeric data.\nAll images have same width and height.\nNothing curious.","81528399":"Things we have discovered:\n* Russian language is not very convinient for file names\n* There are 3 times less cars with region length 3\n* The distribution of numbers in region is not unifrom","7cd0918d":"The file names in dataset are all in russian. Lets rename them because kaggle does not speek Russian.","246745a4":"And at last the distibution for the rest of numbers.","226a7a39":"The last three digits of number are region code. It can have 3 or 2 numbers.\nWe will plot the distribution of length and frequency of numbers in each position\n","b5cad7c1":"Lets look at our images and calculate some metrics.","3c54c677":"Now we will plot the same information for letters","a1aefeaf":"CV2 can't read some images. You can see the artifacts."}}