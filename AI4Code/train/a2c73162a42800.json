{"cell_type":{"2b9ab62c":"code","1076044e":"code","10f29f60":"code","c32aff38":"code","881befec":"code","c14053d3":"code","ae5f4ec6":"code","c48f283b":"code","b4b15399":"code","c5dd789d":"code","64e44812":"code","ca7292d2":"code","51e96384":"code","01e80e2d":"code","91691c65":"code","a0256ed5":"code","91f3e196":"code","286485dc":"code","ed3cdee1":"code","7eb5862f":"code","707b1734":"code","232f9ef5":"code","abdca9a9":"code","ae41301a":"code","e07a0eb2":"code","4dc6dd0f":"code","640b4e47":"code","4f5a1e9e":"code","cafc5d05":"code","427d3692":"markdown","dc798bfb":"markdown","38658d07":"markdown","aa41ae58":"markdown","102eecbb":"markdown","acf59d6b":"markdown","c5e59a26":"markdown","78b75f00":"markdown","0690689e":"markdown","dcf4f014":"markdown","415e7e5e":"markdown","6ede4ca9":"markdown","9ee0dbdf":"markdown","6d638660":"markdown","f3245feb":"markdown","44d2c6cd":"markdown","b3519ca5":"markdown","fe0a6324":"markdown","c0c8a18d":"markdown","b852805e":"markdown","fbd50d8c":"markdown","44cd939c":"markdown","4db6e892":"markdown","1c6ae8b6":"markdown","df0411a9":"markdown","22ce2a35":"markdown","16cbca57":"markdown","a2bc343f":"markdown"},"source":{"2b9ab62c":"#Importing the necessary libraries.\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\n%matplotlib inline\nsns.set_style(\"darkgrid\")\nwarnings.filterwarnings(\"ignore\")\nimport os\nprint(os.listdir(\"..\/input\"))","1076044e":"#Importing the CSV data in form of dataframe.\ndf = pd.read_csv('..\/input\/heart.csv')\ndf.head()","10f29f60":"#Checking the info of the dataframe.\ndf.info()","c32aff38":"#Visualizing the data.\nfig,ax = plt.subplots(1,2,figsize=(10,5))\nax[0].set_title('Presence of Heart disease')\ndf['target'].value_counts().plot.pie(explode=[0.0,0.1],autopct='%.1f%%',shadow=True, cmap='Reds',ax= ax[0])\nax[0].set_ylabel(\"0 ->No , 1 ->Yes\")\nplt.title('Number of men and women')\ndf['sex'].value_counts().plot.pie(explode=[0.0,0.1],autopct='%.1f%%',shadow=True, cmap='Reds',ax= ax[1])\nax[1].set_ylabel(\"0 ->Female , 1 ->Male\");","881befec":"plt.figure(figsize = (5,5))\nsns.countplot(x = 'target',data = df,hue = 'sex',palette = 'husl')\nplt.xlabel('Present or not')\nplt.ylabel('Number of People')\nplt.legend(['Female','Male']);","c14053d3":"sns.distplot(df['age'],color='Purple',hist_kws={'alpha':0.5,'linewidth': 1}, kde_kws={'color': 'orange', 'lw': 3, 'label': 'KDE'});","ae5f4ec6":"plt.figure(figsize = (8,3))\nbins = [20,30,40,50,60,70,80]\ndf['age_bins']=pd.cut(df['age'], bins=bins)\ng1=sns.countplot(x='age_bins',data=df ,hue='target',palette='Greens',linewidth=1)\nplt.legend(['Absent','Present'])\nplt.xlabel('Age Group')\nplt.ylabel('Number of Patients')\nplt.title('Classification of number of people in different age groups on the basis of presence of disease');","c48f283b":"sns.countplot(x='cp',data=df,hue='target',palette='Purples',linewidth=1)\nplt.title('Chest Pain Measure vs Heart Disease presence')\nplt.ylabel('Number of Patients')\nplt.xlabel('Chest Pain Measure')\nplt.legend(['Disease Absent','Disease Present']);","b4b15399":"#Heatmap of the correlation.\nplt.figure(figsize=(12,12))\nsns.heatmap(df.corr(),square = True,annot=True,linewidths=1);","c5dd789d":"plt.figure(figsize = (15,5))\nsns.barplot(x=df['age_bins'],y=df['trestbps'],hue = df['target'])\nplt.xlabel('Age Group')\nplt.ylabel('Resting Blood Pressure')\nplt.title('Age Group to Resting Blood Pressure Analysis on the basis of presence of disease');","64e44812":"plt.figure(figsize = (7,5))\nsns.swarmplot(x='age_bins',y= 'chol',data=df,hue='target',palette='husl')\nplt.title('Analysis of Serum Cholestrol Measure for different Age Groups on the basis of presence of disease')\nplt.xlabel('Age Group')\nplt.ylabel('Serum Cholestrol Measure')\nplt.legend(['Disease Absent','Disease Present']);","ca7292d2":"plt.figure(figsize = (7,5))\nsns.violinplot(x=df['fbs'],y=df['age_bins'])\nplt.xlabel('Fasting Blood Pressure')\nplt.ylabel('Age Groups')\nplt.title('Age Group to Fasting Blood Pressure Analysis');","51e96384":"plt.figure(figsize = (7,5))\nsns.boxplot(x='target',y= 'slope',data=df,palette='husl')\nplt.title('The slope of the peak exercise ST segment vs Presence of Disease')\nplt.xlabel('Presence of Disease, 1- Yes : 0- No')\nplt.ylabel('The slope of the peak exercise ST segment');","01e80e2d":"sns.lmplot(x=\"trestbps\", y=\"chol\",data=df,hue='target')\nplt.title('Serum Cholestrol measure vs Resting Blood Pressure');","91691c65":"plt.figure(figsize=(10,6))\ncount= df['ca'].value_counts()\nsns.barplot(x=count.index, y=count.values)\nplt.ylabel(\"Number of ca values\")\nplt.xlabel(\"Different types of Ca values\")\nplt.title(\"Ca values count\");","a0256ed5":"plt.figure(figsize=(8,6))\nsns.scatterplot(x='chol',y='thalach',data=df,hue='target')\nplt.title('Serum Cholestrol measure vs Maximum Heart rate achieved analysis on the basis of presence of disease');","91f3e196":"plt.figure(figsize=(12,5))\nsns.barplot(x=df['age_bins'],y=df['thalach'],data = df)\nplt.title('Age vs Thalach analysis');","286485dc":"sns.jointplot(x = df['age'], y = df['oldpeak']);","ed3cdee1":"fig,ax=plt.subplots(figsize=(15,5))\nsns.heatmap(df.isnull(), annot=True, cmap = 'Purples')\nplt.title('Null value check');","7eb5862f":"#Droping the unnecessary columns and assigning the target column to y.\ndf.drop('age_bins',axis = 1,inplace = True)\ny = df['target']","707b1734":"#Changing the data to categorical.\ndf['sex']=df['sex'].astype('category')\ndf['cp']=df['cp'].astype('category')\ndf['fbs']=df['fbs'].astype('category')\ndf['restecg']=df['restecg'].astype('category')\ndf['exang']=df['exang'].astype('category')\ndf['slope']=df['slope'].astype('category')\ndf['ca']=df['ca'].astype('category')\ndf['thal']=df['thal'].astype('category')\ndf['target']=df['target'].astype('category')","232f9ef5":"#Getting dummies for our data for our model.\ndf=pd.get_dummies(df,drop_first=True)\ndf.head()","abdca9a9":"#Assigning the value of X.\nX=df.drop('target_1',axis = 1)\nX.info()","ae41301a":"#We are setting the test data to 25% of the total data.\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X,y, test_size=0.16, random_state=65)","e07a0eb2":"#Making an instance of Logistic Regression.\nfrom sklearn.linear_model import LogisticRegression\nlogmod = LogisticRegression()","4dc6dd0f":"#Fitting the training data to train our model.\nlogmod.fit(X_train,y_train)","640b4e47":"#Now lets predict off our test data!\npredictions = logmod.predict(X_test)","4f5a1e9e":"predictions","cafc5d05":"from sklearn.metrics import classification_report,confusion_matrix,accuracy_score\n\nlog_pred=logmod.predict(X_test)\nprint('Confusion Matrix: ')\nprint(confusion_matrix(y_test,log_pred))\nprint('\\n')\nprint('Classification report: ')\nprint(classification_report(y_test,log_pred))\nprint('\\n')\nprint('Accuracy score: {}%'.format(round(accuracy_score(y_test,log_pred)*100,2)))","427d3692":"Lets start by spilitting the data into training data and test data.","dc798bfb":"Lets check ST depression induced by exercise relative to rest at different ages.","38658d07":"Now lets see the Maximum Heart Rate achieved at different Age groups.","aa41ae58":"Amazing! There are no null values.\nSo lets prepare our data to create a machine learning model, in our case we will be using Logistic Regression.","102eecbb":"Now to check the Resting Blood Pressure for different Age groups on the basis of presence of disease.","acf59d6b":"Now that we have got the data lets prepare our model!","c5e59a26":"Now finally lets see how our model has performed!","78b75f00":"Lets check the presence of disease for different age groups in the given data. ","0690689e":"Looks like our model did pretty well!","dcf4f014":"Now lets check the Serum Cholestrol measure at different age groups on the basis of presence of disease.","415e7e5e":"Now lets check the number of patients with different type chest pain on the basis of presence of heart disease.","6ede4ca9":"Clearly the maximum Resting Blood Pressure is higher at the age of 60-70.","9ee0dbdf":"Lets compare Serum Cholestrol measure to Resting Blood Pressure now.","6d638660":"Fasting Blood Pressure is maximum in the age group of 70-80.","f3245feb":"So we see that there are 54.5% people in this dataset suffering from heart disease and 68.3% of the people in the dataset are men, so lets check how many men and women are specifically suffering from heart disease.","44d2c6cd":"So we can notice that there are more people suffering from heart disease in the 50-60 age group.","b3519ca5":"Clearly the maximum heart rate achieved is more for the younger people.","fe0a6324":"Now lets check the actual age distribution given in the dataset.","c0c8a18d":"So we can see that clearly more number of men are suffering from heart diseases as compared to women.While the range of men suffering from heart disease lies between 80-100, the number of women suffering from heart disease lies between 60-80.","b852805e":"Next we will see the Fasting Blood Sugar vs Age group analysis.","fbd50d8c":"There are maximum records with 0 as the number of major vessels or ca value.","44cd939c":"So we can see that Serum Cholestrol measure is highest in the age group of 50-60.","4db6e892":"# Attribute Info:\n* Age \n* Sex\n* Chest Pain\n* Resting Blood Pressure\n* Serum Cholestrol\n* Fasting Blood Pressure\n* Resting electrocardiographic results\n* Maximum heart rate achieved\n* Exercise induced angina\n* ST depression induced by exercise relative to rest\n* The slope of the peak exercise ST segment\n* Number of major vessels (0-3)\n* 3 = normal; 6 = fixed defect; 7 = reversable defect\n* Target - 1 or 0","1c6ae8b6":"Now lets check the Serum Cholestrol measure vs Maximum heart rate achieved on the basis of presence of disease.","df0411a9":"Now to compare the count of different ca value(Number of major vessels (0-3)).","22ce2a35":"Now to analyze the slope of the peak exercise ST segment on the basis of presence of disease.","16cbca57":"Lets check our predictions.","a2bc343f":"Now to check if there are any null values."}}