{"cell_type":{"a90f15fd":"code","477ab17c":"code","074ac958":"code","4f0a33e8":"code","6b614045":"code","4384da85":"code","f82c1f4b":"code","8117b594":"code","1b1947a5":"code","a0fc5499":"code","cbec2cc5":"code","30385d40":"code","b5b3a9d6":"code","12bbdf2a":"code","c7f2c5d4":"code","272877f5":"code","08a71843":"code","49ae7b89":"code","3524f3d7":"code","9127d65c":"code","fccc9bcb":"markdown","2b38f37e":"markdown","d08c8185":"markdown","5713d19d":"markdown","2d95fe16":"markdown","76e586b6":"markdown","14eeb80b":"markdown","19f51e84":"markdown"},"source":{"a90f15fd":"import pandas as pd\nimport numpy as np\nimport os\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns","477ab17c":"#Training Datasets\ntrain_feature= pd.read_csv('\/kaggle\/input\/lish-moa\/train_features.csv')\ntrain_targets_scored= pd.read_csv('\/kaggle\/input\/lish-moa\/train_targets_scored.csv')\ntrain_targets_nonscored= pd.read_csv('\/kaggle\/input\/lish-moa\/train_targets_nonscored.csv')","074ac958":"# Test & Sample Submission\ntest_features= pd.read_csv('\/kaggle\/input\/lish-moa\/test_features.csv')\nsample_sub=pd.read_csv('\/kaggle\/input\/lish-moa\/sample_submission.csv')","4f0a33e8":"train_feature.head()","6b614045":"test_features.head()","4384da85":"train_targets_nonscored.head()","f82c1f4b":"train_targets_scored.head()","8117b594":"sample_sub.head()","1b1947a5":"print(train_feature.shape)\nprint(train_targets_scored.shape)\nprint(train_targets_nonscored.shape)\nprint(test_features.shape)","a0fc5499":"import sys\n!cp ..\/input\/rapids\/rapids.0.15.0 \/opt\/conda\/envs\/rapids.tar.gz\n!cd \/opt\/conda\/envs\/ && tar -xzvf rapids.tar.gz > \/dev\/null\nsys.path = [\"\/opt\/conda\/envs\/rapids\/lib\/python3.7\/site-packages\"] + sys.path\nsys.path = [\"\/opt\/conda\/envs\/rapids\/lib\/python3.7\"] + sys.path\nsys.path = [\"\/opt\/conda\/envs\/rapids\/lib\"] + sys.path \n!cp \/opt\/conda\/envs\/rapids\/lib\/libxgboost.so \/opt\/conda\/lib\/","cbec2cc5":"import cupy\nimport cudf\nfrom cuml.neighbors import KNeighborsClassifier, NearestNeighbors\nimport cuml; cuml.__version__","30385d40":"train_features = pd.read_csv('..\/input\/lish-moa\/train_features.csv')\ntrain_targets = pd.read_csv('..\/input\/lish-moa\/train_targets_scored.csv')","b5b3a9d6":"# taken from https:\/\/www.kaggle.com\/stanleyjzheng\/baseline-nn-with-k-folds\nCOLS = ['cp_type','cp_dose']\nFE = []\nfor col in COLS:\n    for mod in train_features[col].unique():\n        FE.append(mod)\n        train_features[mod] = (train_features[col] == mod).astype(int)\ndel train_features['sig_id']\ndel train_features['cp_type']\ndel train_features['cp_dose']\nFE+=list(train_features.columns) \ndel train_targets['sig_id']\n\nprint(np.array(train_features.to_numpy(), dtype=np.float).shape)\nprint(np.array(train_targets.to_numpy(), dtype=np.float).shape)","12bbdf2a":"# taken from https:\/\/www.kaggle.com\/stanleyjzheng\/baseline-nn-with-k-folds\n\ntest_features = pd.read_csv('..\/input\/lish-moa\/test_features.csv')\n\n\nfor col in COLS:\n    for mod in test_features[col].unique():\n        test_features[mod] = (test_features[col] == mod).astype(int)\n\nsig_id = pd.DataFrame()\nsig_id = test_features.pop('sig_id')\ndel test_features['cp_type']\ndel test_features['cp_dose']\n\ncolumns = pd.read_csv('..\/input\/lish-moa\/train_targets_scored.csv')\ndel columns['sig_id']","c7f2c5d4":"from sklearn.model_selection import train_test_split, KFold\n\n# Train test split # CREATE 20% VALIDATION SET\nX_train, X_test, y_train, y_test = train_test_split(train_features, train_targets ,test_size=0.2, random_state=42)","272877f5":"from cuml.neighbors import KNeighborsClassifier, NearestNeighbors\n\n# GRID SEARCH FOR OPTIMAL K\naccs = []\nfor k in range(5,50):\n    knn = KNeighborsClassifier(n_neighbors=k)\n    knn.fit(X_train, y_train)\n    y_hat_p = knn.predict(X_test)\n    print(k,', ',end='')","08a71843":"y_hat_test = knn.predict(test_features)\nsub = pd.DataFrame(data=y_hat_test, columns=columns.columns)","49ae7b89":"sample = pd.read_csv('..\/input\/lish-moa\/sample_submission.csv')\nsub.insert(0, column = 'sig_id', value=sample['sig_id'])","3524f3d7":"sub.to_csv('submission.csv', index=False)","9127d65c":"sub.head()","fccc9bcb":"---\n---\n\n> <center><img src=\"https:\/\/www.websystemer.no\/wp-content\/uploads\/2020\/08\/beginners-guide-to-knn-with-cuml.gif\"><\/center>\n\n---\n---","2b38f37e":"For some bug I'm not able to submit!\n\nIssue: https:\/\/www.kaggle.com\/c\/lish-moa\/discussion\/180114","d08c8185":"---\n---\n\n> <center><font color=\"red\"><h1 style=\"text-transform: uppercase; text-shadow: 1px 1px;\"><b>Install RAPIDS 0.15.0 <font><\/font> <\/b><\/h1><\/center>\n\n\n---\n","5713d19d":"---\n---\n\n> <center><font color=\"red\"><h1 style=\"text-transform: uppercase; text-shadow: 1px 1px;\"><b>Submission<font><\/font> <\/b><\/h1><\/center>\n\n\n---\n","2d95fe16":"---\n---\n\n> <center><font color=\"red\"><h1 style=\"text-transform: uppercase; text-shadow: 1px 1px;\"><b>Data Pre-Processing<font><\/font> <\/b><\/h1><\/center>\n\n\n---\n","76e586b6":"---\n---\n\n> <center><font color=\"red\"><h1 style=\"text-transform: uppercase; text-shadow: 1px 1px;\"><b>Little Data Exploration <font><\/font> <\/b><\/h1><\/center>\n\n\n---\n","14eeb80b":"---\n---\n\n> <center><font color=\"red\"><h1 style=\"text-transform: uppercase; text-shadow: 1px 1px;\"><b>Building Model<font><\/font> <\/b><\/h1><\/center>\n\n\n---\n","19f51e84":"---\n---\n\n> <center><img src=\"https:\/\/rapids.ai\/assets\/images\/og_image.png\"><\/center>\n\n---\n---"}}