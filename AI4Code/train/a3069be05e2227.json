{"cell_type":{"5a99b0d6":"code","7e9a3954":"code","77ff07c3":"code","8139afd4":"code","832403bb":"code","a4addfe5":"code","5b16184d":"code","80b61b29":"code","b0c43ee4":"code","92be3d80":"code","084bbf1b":"code","349e4a25":"markdown","5ac714d6":"markdown","a4b4e993":"markdown","9d72c9aa":"markdown","ed048aae":"markdown","951aea74":"markdown","d6225c02":"markdown","d31e1207":"markdown","6cb1a29c":"markdown","b659cd98":"markdown","b2ae9f30":"markdown","7d367624":"markdown","d87aa228":"markdown","f58600f0":"markdown","145a0af6":"markdown","e1db7dd3":"markdown"},"source":{"5a99b0d6":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nfrom IPython.display import Image\n\ngames = pd.read_parquet('..\/input\/nfl-big-data-bowl-2022-preprocessing\/games.parquet')\nplays = pd.read_parquet('..\/input\/nfl-big-data-bowl-2022-preprocessing\/plays.parquet')\ntracking_data = pd.read_parquet('..\/input\/nfl-big-data-bowl-2022-preprocessing\/tracking_data.parquet')\n\n!pip install joypy\n!pip install colormath\n!pip install pwlf\n# !pip install -U pip\n# !pip install -U setuptools wheel\n# !pip install \"mxnet<2.0.0\"\n# !pip install autogluon.tabular\nfrom nfl_2022_load_data import *","7e9a3954":"Image('..\/input\/nfl-big-data-bowl-2022-media\/header.gif')","77ff07c3":"# Image('..\/input\/nfl-big-data-bowl-2022-media\/kicks_by_distance.png')","8139afd4":"plays['one'] = 1\ntemp = plays.groupby(['yards_kick_i','outcome'])['one'].sum().to_frame().reset_index()\ntemp = temp.pivot(index=['yards_kick_i'], columns=['outcome'], values=['one']).fillna(0)\ntemp.columns = temp.columns.droplevel(0)\ncols = temp.columns\ntemp['n'] = temp.sum(axis=1).astype(int)\nfor c in cols:\n    temp[c] = temp[c]\/temp['n']*100\ntemp = temp.reset_index().rename(columns={'yards_kick_i':'yards_kick'})[['yards_kick','Make','Miss','Miss - Short','Blocked','n']].copy()\ntemp['yards_kick'] = temp['yards_kick'].astype(int)\ntemp = temp.set_index('yards_kick')\ntemp.columns = ['Make (%)', 'Miss - Wide (%)', 'Miss - Short (%)', 'Miss - Blocked (%)', 'Total (n)']\ntemp.round(1)","832403bb":"Image('..\/input\/nfl-big-data-bowl-2022-media\/kick_events.png')","a4addfe5":"plays.agg({\n    'PlayId':'count',#'playDescription':'max',\n#     'time_kick':'mean',\n    'kicker_distance_at_kick':'mean','holder_distance_at_kick':'mean','kicker_minus_holder_at_kick':'mean',\n    'kicker_distance_at_snap':'mean','holder_distance_at_snap':'mean','kicker_minus_holder_at_snap':'mean',\n    'holder_minus_holder_at_snap':'mean',\n    'snap_time':'mean','place_time':'mean','hold_time':'mean','total_time':'mean',\n#        'kicker_distance_at_kick':'median','holder_distance_at_kick':'median','kicker_minus_holder_at_kick':'median',\n#     'kicker_disance_at_snap':'median','holder_distance_at_snap':'median','kicker_minus_holder_at_snap':'median'\n}).round(2).to_frame()\n\n# plays.agg({\n#     'PlayId':'count',#'playDescription':'max',\n# #     'time_kick':'mean',\n#     'kicker_distance_at_kick':'mean','holder_distance_at_kick':'mean','kicker_minus_holder_at_kick':'mean',\n#     'kicker_distance_at_snap':'mean','holder_distance_at_snap':'mean','kicker_minus_holder_at_snap':'mean',\n#     'holder_minus_holder_at_snap':'mean',\n#     'snap_time':'mean','place_time':'mean','hold_time':'mean','total_time':'mean',\n# #        'kicker_distance_at_kick':'median','holder_distance_at_kick':'median','kicker_minus_holder_at_kick':'median',\n# #     'kicker_disance_at_snap':'median','holder_distance_at_snap':'median','kicker_minus_holder_at_snap':'median'\n# }).hist(bins=15, figsize=(15, 6), layout=(2, 4))\n# plt.show()","5b16184d":"plays.groupby(['outcome']).agg({\n    'PlayId':'count',#'playDescription':'max',\n#     'time_kick':'mean',\n    'kicker_distance_at_kick':'mean','holder_distance_at_kick':'mean','kicker_minus_holder_at_kick':'mean',\n    'kicker_distance_at_snap':'mean','holder_distance_at_snap':'mean','kicker_minus_holder_at_snap':'mean',\n    'holder_minus_holder_at_snap':'mean',\n    'snap_time':'mean','place_time':'mean','hold_time':'mean','total_time':'mean',\n#        'kicker_distance_at_kick':'median','holder_distance_at_kick':'median','kicker_minus_holder_at_kick':'median',\n#     'kicker_disance_at_snap':'median','holder_distance_at_snap':'median','kicker_minus_holder_at_snap':'median'\n}).round(2).T","80b61b29":"plays.groupby(['yards_kick_i']).agg({\n    'PlayId':'count',#'playDescription':'max',\n#     'time_kick':'mean',\n    'kicker_distance_at_kick':'mean','holder_distance_at_kick':'mean','kicker_minus_holder_at_kick':'mean',\n    'kicker_distance_at_snap':'mean','holder_distance_at_snap':'mean','kicker_minus_holder_at_snap':'mean',\n    'holder_minus_holder_at_snap':'mean',\n    'snap_time':'mean','place_time':'mean','hold_time':'mean','total_time':'mean',\n#        'kicker_distance_at_kick':'median','holder_distance_at_kick':'median','kicker_minus_holder_at_kick':'median',\n#     'kicker_disance_at_snap':'median','holder_distance_at_snap':'median','kicker_minus_holder_at_snap':'median'\n}).round(1).T","b0c43ee4":"Image('..\/input\/nfl-big-data-bowl-2022-media\/holder_positioning.png')","92be3d80":"# Image('..\/input\/nfl-big-data-bowl-2022-media\/holder_positioning_close.gif')","084bbf1b":"# Image('..\/input\/nfl-big-data-bowl-2022-media\/holder_positioning_far.gif')","349e4a25":"*Have you ever wondered how kickers change their approach on longer field goal kicks?* \u2014 [It turns out they don't](https:\/\/www.nytimes.com\/2016\/11\/06\/sports\/football\/football-chip-shot-field-goal-kickers.html) (or at least they say they don't):\n\n> \"I kicked a 20-yard field goal the exact same way I would kick a 50-yard field goal.\" (Jay Feely)<br>\"If you try to alter your leg swing, you get in real trouble.\" (Robbie Gould)<br>\"I did my best to hit every kick the same every time. It just doesn\u2019t always work out.\" (Matt Stover)<br>\"You can\u2019t change your mechanics. You want the same leg swing.\" (Nick Folk)\n\n*What about whether the opponent is lining up in an aggressive block formation - does that change the kicking approach?* \u2014 [It doesn't for Dustin Hopkins](https:\/\/www.sbnation.com\/a\/nfl-preview-2019\/kickers):\n> \u201cI have a pretty high takeoff angle, and an oncoming kick rush shouldn\u2019t have any impact on getting my kick off. There was one game where I should have \u2014 last year, vs. Houston. It was a 63-yard kick and I didn\u2019t factor in a slight wind and cooler temperatures. But other than that, I try not to change anything. I make no adjustments...I\u2019m not worried about the rush. If I take care of what I need to take care of \u2014 if my timing\u2019s right and I\u2019m not slow \u2014 and the integrity of my line is good, then they can\u2019t really affect me either way.\u201d\n\n*If kickers aim for consistency, no matter the situation, then what about the holder? \u2014 Do holders ever adjust positioning (typically 7-8 yards behind the line of scrimmage) based on situation? Should they?*\n\nHolders have the potential to shave off an extra yard or two on long kicks by positioning closer to the line of scrimmage. Alternatively, they can line up further away, which could give the kicker more flexibility on kicking angle and in theory reduce the risk of a block (as the defense would have more distance to cover).\n\nAs part of the 2022 Big Data Bowl data, we can explore these trade-offs using Next Gen Stats (NGS) tracking data. This data provides insightful location information for the ball and each special teams player.\n","5ac714d6":"# Field Goal Unit Analytics - Optimal Holder Positioning\n\n* [Summary](#summary)\n\nOptimal \nAnalyzing \nfield goal unit positioning and execution\nTradeoff between distance and blocked\nOptimal field goal holder positioning","a4b4e993":"## 5. Conclusion - Possible Strategy Implications\n\nBelow are how strategy could be changed based on this research:\n\n* **Snapper** - FAST\n* **Holder** -blah\n\nsnaper\ndefense\nholder\nkicker","9d72c9aa":"<a id=\"summary\"><\/a>\n## 1. Summary\n\nIn the analysis below, I define new metrics using \"Next Gen Stats\" tracking data for evaluating field goal units. These innovative stats can help evaluate player skill in positions that are traditionally difficult to measure (i.e. long snapper, holder). These metrics are then used to evaluate the optimal strategy for positioning the holder, which is particularly important on long kicks. Holder positioning strategy must balance tradeoffs between: (1) closer to the line of scrimage - putting the kicker closer to the defense who is trying to block the kick vs. (2) further from the line of scrimmage - forcing the kicker to kick a longer kick. The results of this research show that holders tend to position themsevles further from the defense on longer kicks, which may not be optimal as unintuitively this actually increases the likelihood of a blocked kick.\n\nIt is believed that...this is due to giving more time to the defense + around the end.\nInstead teams should position the holder closer to the line of scrimmage (revealed unintuitive results where positioning the holder closer to the line of scrimmage reduces the risk of a blocked kick. \n\ndeep dive field goal unit\n\nWhile not the main area of focus, various player rankings are also included in the Appendix to help us understand how players compare best at different aspects of field goal execution.","ed048aae":"The assumption made is that the four sharpest changes in ball movement across time correspond to the events listed above. To avoid any sharp movements after the ball is kicked (i.e. blocked, hit extra point, etc.) ball movement data was restricted to five frames after the provided ball_kicked event.\n\n<i><span style=\"font-size:12px;\">[1]: It is worth noting that the ball_snap and ball_kicked events were already provided in the NGS data, however data quality audits revealed that these events weren't always accurate (i.e. often off by a few frames from what the ball\/player movement data would suggest). To improve accuracy, these events were re-calculated. However the provided snap and kick events were used as a \"prior\" for where the event was most likely to have taken place, and in the majority of cases the provided event time was within one frame of the calculated event event time.<\/span><\/i>\n\nTODO: Challenges - phantom ball","951aea74":"<a id=\"background\"><\/a>\n## 2. Background\n\nBefore getting too in-depth, we first must understand the basic dynamics of kicking \u2014 the further the kick, the more likely the kick will miss and\/or get blocked.","d6225c02":"<a id=\"methodology\"><\/a>\n## 4. Methodology\n\n### Data\n\nThis research was based on analyzing 6,070 field goal and extra point kick plays from the 2018-2020 NFL seasons. Note that ~1% of plays were filtered from the provided data set because of data quality issues (i.e. no tracking data, no kicker, missing snap\/kick event, ball movement data didn't show movement, etc.).\n\n### Play Events\nUsing the NGS data we can break a kick attempt into segements, corresponding to the following play events:\n1. **ball_snap** - The time that the ball was snapped (frame prior to ball movement)\n1. **ball_caught** - The time that the ball was caught by the snapper (frame where ball decellerates)\n1. **ball_placed** - The time that the ball was placed by the snapper (frame where ball movement stabalized)\n1. **ball_kicked** - The time that the ball was kicked (frame prior to ball movement)\n\nTo estimate when each of events occured<sub>1<\/sub>, a [Piecewise Linear Regression](https:\/\/jekel.me\/piecewise_linear_fit_py\/index.html) model was fit onto vertical (x-axis) ball movement data for each play. As we can see in the example play below, each of these events correspond to the ball changing speed\/direction.","d31e1207":"### How do behavior changes based on situation?","6cb1a29c":"Image('..\/input\/nfl-big-data-bowl-2022-media\/header.gif') # cool field \/hawks \/ home team\n\nkicks by distance (table)\n\nImage('..\/input\/nfl-big-data-bowl-2022-media\/kick_events.png')\n\nmetrics by outcome - miss\/made\/short\/block (table)\n\nmetrics by situation - kick distance (table)\n\nholder positioning joy\n\n----\n\nappendix\n\nteleporting ball example\nImage('..\/input\/nfl-big-data-bowl-2022-media\/teleporting_ball.gif')\n\nkickers approach by outcome diagram\n\nFastest Snappers\nImage('..\/input\/nfl-big-data-bowl-2022-media\/fastest_snappers.png')\n\tsnap_to_caught - The amount of time between ball_snap and ball_caught events (how fast the snapper snapepd the ball)\n\tsnap_distance - The (x-axis) distance traveled by ball between ball_snap and ball_caught\n\tsnap_speed - The speed of the snap (snap_distance \/ snap_to_caught)\n\nSnap and Hold Execution\nImage('..\/input\/nfl-big-data-bowl-2022-media\/snap_and_hold_execution.png')\n\tcaught_to_placed - The amount of time between ball_caught and ball_placed events (how fast the holder handled the ball)\n\t\n\tball_caught - The time that the ball was caught by the snapper (frame where ball decellerates)\n\tball_placed - The time that the ball was placed by the snapper (frame where ball movement stabalized)\n\nKick Timing\nImage('..\/input\/nfl-big-data-bowl-2022-media\/kick_timing.png')\n\tplaced_to_kicked - The amount of time between ball_placed and ball_kicked events (how long the ball was placed before it was kicked)\n\nOverall Kick Execution\nImage('..\/input\/nfl-big-data-bowl-2022-media\/overall_execution.png')\n\tsnap_to_kicked - The amount of time between ball_snap and ball_kicked events (sum of three prior components)\n\tadd col for make %\n\nHolder distance\/consistency\nImage('..\/input\/nfl-big-data-bowl-2022-media\/holder_distance.png')\n\tholder_positioning - The (x-axis) distance between the holder (at ball_snap) and line of scrimmage (based on ball_snap location)\n\tjoy plot by holder\/kicker example?\n\nKicker distance\/consistency\nImage('..\/input\/nfl-big-data-bowl-2022-media\/kicker_distance.png')\n\tkicker_positioning - The (x-axis) distance between the kicker (at ball_snap) and the holder (at ball_snap)","b659cd98":"show two plays - same distance, one blocked because started further back and blocked on the side (took longer) other not blocked","b2ae9f30":"### Metrics\n\nUsing NGS player\/ball location data and play events (described above), the following metrics are defined:\n* **snap_to_caught** - The amount of time between ball_snap and ball_caught events (how fast the snapper snapepd the ball)\n* **caught_to_placed** - The amount of time between ball_caught and ball_placed events (how fast the holder handled the ball)\n* **placed_to_kicked** - The amount of time between ball_placed and ball_kicked events (how long the ball was placed before it was kicked)\n* **snap_to_kicked** - The amount of time between ball_snap and ball_kicked events (sum of three prior components)\n* **snap_distance** - The (x-axis) distance traveled by ball between ball_snap and ball_caught\n* **snap_speed** - The speed of the snap (snap_distance \/ snap_to_caught)\n* **holder_positioning** - The (x-axis) distance between the holder (at ball_snap) and line of scrimmage (based on ball_snap location)\n* **kicker_positioning** - The (x-axis) distance between the kicker (at ball_snap) and the holder (at ball_snap)\n\nThese metrics can be used to help us learn innovative insight about kicking plays. For example, this data can help us understand how the snapper\/holder performance impact kick success, which players excel in different aspects, how stragegy\/approach adapts based on the situation, etc. \n\nSee Appendix A.1 for histogram?","7d367624":"### Most optimal holder positioning?","d87aa228":"<a id=\"results\"><\/a>\n## 5. Results\n\n### What do metrics change based on outcome?","f58600f0":"<a id=\"appendix\"><\/a>\n## Appendix\n\n<a id=\"a.2\"><\/a>\n### A.2. \"Teleporting ball\" example\n\nImage('..\/input\/nfl-big-data-bowl-2022-media\/teleporting_ball.gif')\n<!-- <video example> -->\n\n<a id=\"a.3\"><\/a>\n### A.3. Kickers approach by outcome\n\n<!-- <video of > -->\n\n<a id=\"a.4\"><\/a>\n### A.4. Fastest Snappers\n\nBelow we can see the average \"snap to catch\" time divided by \"snap distance\". This is an evaluation of snapper speed. Note that this does not capture snapper accuracy.\n\n<!-- <fastest snap to catch\/distance - snapper by year \/ sorted by avg> -->\n\n<a id=\"a.5\"><\/a>\n### A.5. Snap and hold execution\n\nBelow we can see the average \"catch to place\" time. This is an evaulation of both the snapper (accuracy) as well as the holder (ability to handle the snap and place quickly). \n\nWe average these across years and can see the correlated...\n\n<!-- <fastest snap to hold - snapper\/holder by year \/ sorted by avg> -->\n\n<a id=\"a.6\"><\/a>\n### A.6. Kick timing\n\nBewlow we can see the average \"place to kick\" time. This is an evaluation of the snapper (placing without issues) and kicker (timing their run - TODO word choice).\n\n<!-- <fastest place to kick - snapper\/kicker \/ sorted by avg> -->\n\n<a id=\"a.7\"><\/a>\n### A.7. Holder distance\/consistency\n\nBelow....\n\n<a id=\"a.8\"><\/a>\n### A.8. Kicker distance\/consistency\n\nBelow...\n","145a0af6":"<a id=\"considerations\"><\/a>\n## 4. Considerations \/ Caveats\n\nweather\ndata quality\nno vertical ball movement data - angle","e1db7dd3":"<a id=\"objective\"><\/a>\n## 3. Objective\n\nIn the analysis below I will define innovative metrics to evaluate field goal unit positioning and execution (applicable for both field goals and extra points). The goals of this research are to: (1) use these new metrics to learn about field goal unit behavior and execution; (2) broadly analyze which of these metrics have most impact on kick success; and (3) deep dive the most optimal strategy for positioning the holder on longer kicks."}}