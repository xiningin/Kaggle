{"cell_type":{"4608d611":"code","4fb2fc68":"code","d424af73":"code","ee76ee5f":"code","a6be5a4b":"code","15cac254":"code","8f04dcbb":"code","5fdf78e3":"code","2c126bd9":"code","fb98f82f":"code","d67be05f":"code","d952704a":"code","92211ce4":"code","d65eab7f":"code","44e81eee":"code","20335b73":"code","9438bc7e":"code","78cfcd62":"markdown","b8a6bb64":"markdown","584a1a66":"markdown","6cee7c35":"markdown","660f287f":"markdown","cd92efbe":"markdown","5017fc59":"markdown","45b0f09c":"markdown","b367bd10":"markdown","d2562edd":"markdown","a07c98f4":"markdown","c84bb10f":"markdown","2529a3e4":"markdown","acd6066b":"markdown","cbc8779c":"markdown","833db163":"markdown","6576ca19":"markdown","0be9912c":"markdown","caf7f68e":"markdown","e9411456":"markdown","29920176":"markdown","f41c0e97":"markdown","1a47fadf":"markdown","7454ae81":"markdown","9fbe4fd2":"markdown","8663dc09":"markdown","1e9de6d9":"markdown","2904a0af":"markdown","15f8cd58":"markdown","109c831a":"markdown"},"source":{"4608d611":"# # Importing necessary packages\nimport pandas as pd\nfrom matplotlib import pyplot as plt\n!pip install apyori\nfrom apyori import apriori","4fb2fc68":"df = pd.read_csv('..\/input\/groceries-dataset\/Groceries_dataset.csv')","d424af73":"df.head(3)","ee76ee5f":"df.isnull().sum()","a6be5a4b":"df.columns = ['member_id','date','items']","15cac254":"df.info()\ndf['date']= pd.to_datetime(df['date'])","8f04dcbb":"# # Top purchased items. \nitem_count=df[['member_id','items']].groupby('items',as_index=False)['member_id'].count(\n    ).sort_values(by='member_id',ascending=False)\nitem_count.rename(columns = {'member_id':'count'},inplace=True)\nitem_count.head()","5fdf78e3":"# # Graph.\nmy_color_pal = [\n    'MediumSeaGreen',\n    'LightSeaGreen',\n    'MediumAquaMarine',\n    'LightSkyBlue',\n    'LightSteelblue',\n    'PowderBlue',\n    'Plum',\n    'LightSalmon',\n    'LightPink',\n    'Moccasin',\n    ]\n\ny_axis = item_count['items'].head(10)\nx_axis = item_count['count'].head(10)\n\nplt.barh(y_axis,x_axis, color = my_color_pal,edgecolor='Silver')\n\nplt.title('Top Ten Purchased Items: Jan 2014 - Dec 2015', color='steelblue',\nfontfamily='times new roman',fontsize=18)\nplt.xlabel('Purchase Frequency')\n\nplt.show()\n","2c126bd9":"# # Average purchase count.\nmember_items = df.groupby('member_id', as_index=False)['items'].count()\nprint('On average, members purchased: {x} items.'.format(\n    x= round((member_items['items'].mean()),1)))","fb98f82f":"weekday_df = df[['member_id', 'date']]\n\nweekday_df = weekday_df.groupby('date', as_index=False)['member_id'].nunique()\n\nweekday_df['weekday'] = weekday_df['date'].dt.day_name()\n\nweekday_df = weekday_df.groupby('weekday', as_index=False)['member_id'].mean().sort_values(\n    by='member_id', ascending=False)\nweekday_df.rename(columns={'member_id': 'average_members'}, inplace=True)","d67be05f":"# # Graph\nx = weekday_df['weekday']\ny = weekday_df['average_members']\nplt.bar(x, y, color='MediumSeaGreen', edgecolor='black')\nplt.xticks(rotation=20)\nplt.title('Average Number of Member Transcations', color='steelblue',\n          fontfamily='times new roman', fontsize=18)\nplt.show()","d952704a":"basket_df = df.groupby(['member_id', 'date'], as_index=True)['items'].apply(lambda x: list(x))\n\ntransactions = basket_df.values.tolist()\n\ntransactions[:10]","92211ce4":"# # Using the apriori function to create the association rules.\nassociation_rules = apriori(transactions,\n                            min_support=0.0003,\n                            min_lift=2,\n                            min_confidence=0.05,\n                            min_length=2)\nassociation_results = list(association_rules)\n# # Using the association rules yiels 104 rules that meet the qualifications.\nprint(len(association_results))","d65eab7f":"results = []\nfor item in association_results:\n    itemset = item[0]\n    items = [x for x in itemset]\n\n    value0 = str(items[0])\n    value1 = str(items[1])\n    value3 = str(item[1])[:7]\n    value4 = str(item[2][0][2])[:7]\n    value5 = str(item[2][0][3])[:7]\n\n    rows = (value0, value1, value3, value4, value5)\n    results.append(rows)\n    columns = ['item_x', 'item_y', 'support', 'confidence', 'lift']\n\n    associations_df = pd.DataFrame(results, columns=columns)\n    associations_df.head(5)","44e81eee":"associations_df=associations_df.sort_values(by=['support', 'lift'],\n                            ascending=[False, False]).head(100)\nassociations_df.head(20)","20335b73":"# # Max support value.\nassociations_df.sort_values(by='support',ascending=False).head(1)","9438bc7e":"# # Max lift value. \nassociations_df.sort_values(by='lift',ascending=False).head(1)","78cfcd62":"<p style='font-size:16px;font-family:times new roman'>The itemset of fruit\/vegetable juice and sausage have the highest lift value of 8.29 and a relatively high confidence value of 50%. However, the support value is low suggesting that they are not purchased as frequently as other items in the dataset.<\/p>","b8a6bb64":"<p style='font-size:16px; font-family:times new roman'>It is no secret that retailers extract information from consumer data that can help them create effective marketing tactics. Market basket analysis is one application of association analysis, a technique used to find patterns in items within a large dataset[1]. In the Power of Habit, Charles Duhigg shares an anecdote about Target executives who were trying to identify which of their customers were pregnant. For retailers, like Target, this piece of information would allow them to identify customers who made frequent purchases like diapers or groceries or school supplies. \nMarket basket analysis is a tool that can help determine if there is a connection between items purchased together. Using a dataset full of transactional data from grocery stores, an exploratory analysis will be conducted to find any interesting trends. Additionally, the Apriori algorithm will be applied to the dataset to find the frequent itemset and using market basket analysis determine if an interesting association exists between items.<\/p>","584a1a66":"<p style='font-size:16px;font-family:times new roman'>It would be interesting to identify if it there was a disproportional number of purchases made on a certain day of the week. Do grocery stores have more members making purchases on a certain day of the week? <\/p>","6cee7c35":"<p style='font-size:16px;font-family:times new roman'>Change datatypes in dataframe.<\/p>","660f287f":"<h2 style='font-family:times new roman'> Setting up enviroment in Python <\/h2>","cd92efbe":"<p style='font-size:16px;font-family:times new roman'>Importing dataset, creating a Pandas dataframe.<\/p>","5017fc59":"1. [Moffit, Chris. (2017 July 3).Introduction to Market Basket Analysis in Python.](https:\/\/pbpython.com\/market-basket-analysis.html)\n2. [Dedhia, Heeral.(2020 Sep 17).Kaggle.](https:\/\/www.kaggle.com\/heeraldedhia\/groceries-dataset)\n3. [Jain Rashmi.(2017 March 24). A Beginner\u2019s Tutorial on Apriori Algorithm in Data Mining with R Implementation.Hackerearth.](https:\/\/www.hackerearth.com\/blog\/developers\/beginners-tutorial-apriori-algorithm-data-mining-r-implementation\/.)\n***\nThe following Kaggle notebooks used the same dataset and where very helpful in helping me understand the concepts of association rule learning and market basket analysis:\n1. [Heeral Dedhia's Market Basket Analsyis Using Apriori Algorithm](https:\/\/www.kaggle.com\/heeraldedhia\/market-basket-analysis-using-apriori-algorithm\/)\n2. [Anubha Singh's Groceries Association Rule Apriori Algorithm](https:\/\/www.kaggle.com\/cerolacia\/groceries-asscociation-rule-apriori-algorithm)\n3. [Gaurav Chopra's Introduction to Association Rule Mining](https:\/\/www.kaggle.com\/gauravchopracg\/introduction-to-association-rule-mining)  \n***\nThe following youtube videos helped me understand the concepts. \n1. [Market Basket Analysis with Excel](https:\/\/youtu.be\/aslTl6i-hpQ)\n2. [Apriori Algorithm Explained](https:\/\/youtu.be\/guVvtZ7ZClw)\n3. [Implementing Apriori algorithm in Python](https:\/\/youtu.be\/SVM_pX0oTU8)","45b0f09c":"\n<h1 style=\"font-family:times new roman;\"> <center>Grocery Market Basket Analysis<\/center> <\/h1>\n\n<p><center style=\"color:#159364; font-family:times new roman; font-size:16px\">Market basket analysis using Apriori algothrithm performed on grocery transactions dataset.<\/center><\/p>\n\n***","b367bd10":"<h2 style='font-family:times new roman'>References <\/h2>","d2562edd":"<h2 style='font-family:times new roman'>Recommendation<h2>","a07c98f4":"<h2 style='font-family:times new roman'>Data<\/h2>","c84bb10f":"<p style='font-size:16px;font-family:times new roman'>Check for null values.<\/p>","2529a3e4":"<h2 style='font-family:times new roman'>Cleaning Data<\/h2>","acd6066b":"<h2 style='font-family:times new roman'>Tableau Dashboard <h2>","cbc8779c":"![image1.png](attachment:f78add64-5fdd-4016-b9f1-e5af4bc27978.png)","833db163":"<p style='font-size:16px;font-family:times new roman'>Since there are many association rules that are possible the Apriori algorithm is used to placed constraints so that the most interesting rules are selected [3].<\/p>","6576ca19":"<p style='font-size:16px;font-family:times new roman'>To start off, the dataset is filtered and sorted to find the top items purchased by customers from January 2014 to December 2015. The data shows that milk, vegetables, and bread are the most frequently purchased items.<\/p>","0be9912c":"<p style='font-size:16px;font-family:times new roman'>The groceries in the dataset can expect anywhere from 19 to 21 transaction made my members across the week. However, it is evident that there is not a significant difference in the number of transactions made by the members from Thursday to Monday.<\/p>","caf7f68e":"<p style='font-size:16px;font-family:times new roman'>Preview dataset.<\/p>","e9411456":"<p style ='font-size:16px;font-family:times new roman'>There are 3,898 different members in the dataset and on average they purchased 10 items per trip. <\/p>","29920176":"<p style='font-size:16px;font-family:times new roman'>Before doing the market basket analysis, it will be useful to conduct a simple, exploratory analysis of the dataset. This may help identify interesting or relevant information regarding the data.<\/p>","f41c0e97":"![mba_grocery.png](attachment:ad399253-8397-4457-9005-046cb75bbf52.png)","1a47fadf":"<p style='font-size:16px;font-family:times new roman'>Support represents the popularity of an item in the itemset. Setting the support to a minimum value creates a threshold that identifies significant item pairs. Confidence signifies the likelihood of item Y being purchased when item X is purchased. The confidence value can be misleading if both items are popular. It could be that X and Y appear together frequently because of their individual popularity and not necessarily an association between them. Lift considers the popularity of item Y when determining the likelihood of it being purchased in the same transaction as item X. A lift value greater than one can be indicative of a pattern between the items.<\/p>","7454ae81":"<p style='font-size:16px;font-family:times new roman'>Change column names.<\/p>","9fbe4fd2":"<p style='font-size:16px;font-family:times new roman'>The dataset in this analysis is publicly available through Kaggle [2]. The dataset contains 38,765 rows of billing data collected from grocery stores from January 2014 to December 2015. The dataset includes the ID of the members, date of purchase and a description of the items. It should be noted that the data is limited in that it only contains two years\u2019 worth of data and no additional information on the grocery store(s) is provided.<\/p>","8663dc09":"<h2 style='font-family:times new roman'>Analysis<\/h2>","1e9de6d9":"<h2 style='font-family:times new roman'>Introduction<\/h2>","2904a0af":"<p style='font-size:16px;font-family:times new roman'>The results of applying Apriori to the dataset indicate that the items whole milk, and sausage have the highest support values and the lift is approximately 2.18. It can be assumed that yogurt and sausage are common breakfast items in the US and that is why they are purchased together frequently. <\/p>","15f8cd58":"<p style='font-size:16px;font-family:times new roman'>Data that contains information about consumer\u2019s purchasing habits is very valuable to retailers because by applying useful analysis tools like association rules, important trends and patterns can be uncovered. The exploratory analysis of the data revealed that the top purchased items were milk, vegetables, and bread. Members, on average, purchased ten items. It can be assumed that at least one of the top products will appear in the average member\u2019s grocery cart. If they are potentially only purchasing ten items, it will benefit the grocery stores to prioritize their top sellers. Market basket analysis can provide businesses with a clearer picture of what their customers are more likely to purchase. The grocery stores in this dataset can use the association rules created in this analysis to advertise certain items their members with discounts that will encourage them to purchase more. Finding the right connection between two items can be the difference between a member purchasing that eleventh or twelfth item.<\/p>","109c831a":"<p style='font-size:16px;font-family:times new roman'>In order to apply the Apriori algorithm, a new dataframe is created that contains a list of items each member purchased on each day.<\/p>"}}