{"cell_type":{"5838d9f7":"code","4ce2922f":"code","872428fe":"code","be8de4f3":"code","d5bb9ed7":"code","7141f22d":"code","a3d54b9c":"code","fe5eaa7e":"code","5bc95abf":"code","174b455c":"code","a8a49931":"code","85e781bb":"code","e563af13":"code","bd58c2bf":"code","0280185d":"code","1ed38ab1":"code","6e532721":"code","091e3fe7":"code","ed1545a1":"code","78393bdc":"code","4777a1f5":"code","20dd68d6":"code","cb1d0bab":"code","27959cd7":"markdown","a6394fbc":"markdown","c4507208":"markdown","fd1afb6e":"markdown","4838a50b":"markdown","9ee051e4":"markdown","bac86d53":"markdown","0341f2f4":"markdown","edddd8dc":"markdown","bdc39960":"markdown","56cf0070":"markdown","ebfc3754":"markdown","d49fd55d":"markdown","0967ec6c":"markdown","a69d0022":"markdown","ec99431e":"markdown","f32a610e":"markdown","9c9ff7e6":"markdown","59cc9428":"markdown","c1499ca1":"markdown","9f0546e9":"markdown"},"source":{"5838d9f7":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","4ce2922f":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nfrom sklearn.ensemble import ExtraTreesClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import accuracy_score","872428fe":"df = pd.read_csv(\"..\/input\/weather-dataset-rattle-package\/weatherAUS.csv\")\ndf.head()","be8de4f3":"l_columns = [x.lower() for x in df.columns]\ndf.columns = l_columns","d5bb9ed7":"name = []\nnull = []\nfor i in df.columns:\n    name.append(i)\n    null.append(df[i].isnull().sum() \/ len(df))\n    \nnull_desc = pd.DataFrame({\"col_name\" : name, \"null_per\": null})\nnull_desc.sort_values(by=\"null_per\", ascending=False)","7141f22d":"drop_col = null_desc[null_desc.null_per > 0.20].col_name.values\ndf.drop(drop_col, axis = 1, inplace=True)","a3d54b9c":"catogrical = [x for x in df.columns if df[x].dtype == \"object\"]\nnumeric = [x for x in df.columns if df[x].dtype == \"float64\"]","fe5eaa7e":"df[catogrical].isnull().sum()","5bc95abf":"for i in catogrical:\n    df[i].fillna(df[i].mode()[0], inplace=True)","174b455c":"for i in numeric:\n    df[i].fillna(df[i].mean(), inplace = True)","a8a49931":"df.isnull().sum()","85e781bb":"df[\"date\"] = pd.to_datetime(df.date)","e563af13":"for i in catogrical:\n    print(\"{} unique = {}\".format(i, df[i].nunique()))","bd58c2bf":"df[\"year\"] = df[\"date\"].dt.year\ndf[\"day\"] = df[\"date\"].dt.day\ndf[\"month\"] = df[\"date\"].dt.month","0280185d":"df.drop([\"date\", \"location\"],axis = 1, inplace=True)","1ed38ab1":"dummies = pd.get_dummies(df[['windgustdir','winddir9am','winddir3pm','raintoday','raintomorrow']], drop_first=True)\ndf1 = pd.concat([df, dummies], axis=1)\ndf1.drop(['windgustdir','winddir9am','winddir3pm','raintoday','raintomorrow'], axis = 1, inplace = True)","6e532721":"df1.rename(columns={\"raintoday_Yes\" : \"raintoday\", \"raintomorrow_Yes\" : \"raintomorrow\"}, inplace = True)","091e3fe7":"X = df1.iloc[:, : -1]\ny = df1.iloc[:, -1]","ed1545a1":"model = ExtraTreesClassifier()\nmodel.fit(X,y)","78393bdc":"plt.figure(figsize=(10, 35))\nfeature_rank = pd.Series(model.feature_importances_, index = X.columns)\nfeature_rank.sort_values().plot(kind = \"barh\")","4777a1f5":"imp_columns = feature_rank.nlargest(16).index\nX = df1[imp_columns]","20dd68d6":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2)\nknn = KNeighborsClassifier(n_neighbors = 10)\nknn.fit(X_train, y_train)","cb1d0bab":"predict = knn.predict(X_test)\nfrom sklearn.metrics import accuracy_score\nacc = accuracy_score(y_test, predict)\nacc","27959cd7":"> **Fill Null values in categorical features with more frequent values**","a6394fbc":"> 1. **Supervised classification Problem**\n> 2. **Use KNeighborsClassifier Algorithm**\n> 3. **Use ExtraTreesClassifier for feature Selection**\n> 4. **Accuracy of model = 84%**","c4507208":"> **One Hot encoding for categorical values**","fd1afb6e":"> ## Import Libararies","4838a50b":"<img src = \"https:\/\/www.skymetweather.com\/content\/wp-content\/uploads\/2020\/01\/RaininJanuary.jpg\" height=500 width=500 style=\"margin : auto;\">","9ee051e4":"> ## Model Building","bac86d53":"> **More unique values are not good for accurate prediction that's why, convert date column into three new columns**","0341f2f4":"> **Check Feature Importance** ","edddd8dc":"> **Translate column names in lower latter for easy to use**","bdc39960":"# Tomorrow Rain Prediction in Australia \n\n","56cf0070":"> ## Read Data","ebfc3754":"> ## About ","d49fd55d":"> **Select most 16 columns for prediction**","0967ec6c":"> **Fill Null values in numeric features with mean values**","a69d0022":"> **Drop Columns which have null values more than 20%**","ec99431e":"> ## Handle Null Values\n","f32a610e":"> ## Feature Engineering","9c9ff7e6":"> **Split data**","59cc9428":"> ## Check Accuracy","c1499ca1":"> **Split data into two types categorical and numeric**","9f0546e9":"> **Convert Date column in datetime format**"}}