{"cell_type":{"335f35e8":"code","d1f9f900":"code","fd3d3297":"code","28e9c2cc":"code","c3348b02":"code","c453ee4b":"code","17eb5a30":"code","ab9b428e":"code","87feb9e6":"code","a2c08ecc":"code","cb76a71a":"code","1a927649":"code","79a574bf":"code","259c9547":"code","eaaa8104":"code","96f15c21":"code","da280a0d":"code","6566ae7f":"code","7785074c":"code","f80fbede":"code","c5fc2fce":"code","38d089e2":"code","dd5bffcd":"code","55abe782":"code","46d12cbc":"code","4d8470a3":"code","e9415aab":"code","cd633a54":"code","e3f4ec0c":"code","e79024d8":"code","631fbf80":"markdown","fcc7630e":"markdown","bda3dc9a":"markdown","b3a7a087":"markdown","515bb908":"markdown","b1206929":"markdown","10f57396":"markdown","c974e7f9":"markdown","6874d031":"markdown","ea85be39":"markdown","df77ffa1":"markdown","e8ce7e80":"markdown","4f471c2f":"markdown","b3b30954":"markdown","507d9716":"markdown","d1fc04c4":"markdown","08291e63":"markdown","cfff64a2":"markdown"},"source":{"335f35e8":"#library\nimport os\nfrom datetime import datetime\nimport time\nfrom sklearn.preprocessing import StandardScaler\nimport plotly.express as px\nimport plotly.graph_objs as go\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport math\n\nimport statsmodels.api as sm\nfrom statsmodels.tsa.ar_model import AutoReg\nfrom statsmodels.tsa.arima_model import ARMA\nfrom statsmodels.tsa.stattools import adfuller\nfrom statsmodels.graphics.tsaplots import plot_acf\nfrom statsmodels.graphics.tsaplots import plot_pacf\nfrom statsmodels.tsa.arima_model import ARIMA\nfrom statsmodels.tsa.statespace.sarimax import SARIMAX\nfrom statsmodels.tsa.seasonal import seasonal_decompose\nfrom scipy import stats\nfrom itertools import product\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\ninfo = pd.read_csv(\"\/kaggle\/input\/g-research-crypto-forecasting\/asset_details.csv\")\nctrain = pd.read_csv(\"\/kaggle\/input\/g-research-crypto-forecasting\/train.csv\")","d1f9f900":"ctrain.head()","fd3d3297":"# Impute Missing Time Value\ndef c_time_sub(asset_id, data=ctrain):\n    df=data[ctrain[\"Asset_ID\"]==asset_id].set_index(\"timestamp\")\n    df=df.reindex(range(df.index[0],df.index[-1]+60,60), method=\"pad\")\n    return df\n\n# Subgroup Bitcoin\nbtc=c_time_sub(asset_id=1)\n(btc.index[1:] -btc.index[:-1]).value_counts().head()\n\n# Subgroup Ethereum\neth=c_time_sub(asset_id=6)\n(btc.index[1:] -btc.index[:-1]).value_counts().head()\n\n# Subgroup Cardano\nada=c_time_sub(asset_id=3)\n(ada.index[1:] -ada.index[:-1]).value_counts().head()","28e9c2cc":"# time frame selection: from datetime to timestamp\ntotimestamp= lambda s: np.int32(time.mktime(datetime.strptime(s,\"%d\/%m\/%Y\").timetuple()))\n\n# Log Return \ndef log_return(series, periods=1):\n    return np.log(series).diff(periods=periods)","c3348b02":"# Data Selection\ndef crypto_sub(asset_id ,data= ctrain ):\n    df = data[data[\"Asset_ID\"]==asset_id].reset_index(drop = True)\n    df['timestamp'] = pd.to_datetime(df['timestamp'], unit='s')\n    df = df.set_index('timestamp')\n    return df\n\n#Subgroup Bitcoin\nbtc1=crypto_sub(asset_id=1)\n\n#Subgroup Eth\neth1=crypto_sub(asset_id=6)\n\n#Subgroup Ada\nada1=crypto_sub(asset_id=3)\n","c453ee4b":"%matplotlib inline\ninfo_s=info.sort_values(\"Weight\")\nfig_index=px.bar(info_s,x=\"Asset_Name\" , y=\"Weight\", color=\"Weight\", title=\"Popular Cryptocurrency Weight Distribution\")\nfig_index.show()","17eb5a30":"# time frame selection: from datetime to timestamp\ntotimestamp= lambda s: np.int32(time.mktime(datetime.strptime(s,\"%d\/%m\/%Y\").timetuple()))\n\n# Log Return \ndef log_return(series, periods=1):\n    return np.log(series).diff(periods=periods)\n\nall2021=pd.DataFrame([])\nfor asset_id, asset_name in zip(info.Asset_ID, info.Asset_Name):\n    asset=ctrain[ctrain[\"Asset_ID\"]==asset_id].set_index(\"timestamp\")\n    asset=asset.loc[totimestamp(\"01\/01\/2021\"):totimestamp(\"21\/09\/2021\")]\n    asset=asset.reindex(range(asset.index[0],asset.index[-1]+60,60), method=\"pad\")\n    lret=log_return(asset.Close.fillna(0))[1:]\n    all2021=all2021.join(lret,rsuffix=asset_name,how=\"outer\")\n    \nplt.imshow(all2021.corr());\nplt.yticks(info.Asset_ID, info.Asset_Name.values)\nplt.xticks(info.Asset_ID, info.Asset_Name.values,rotation=\"vertical\");\nplt.colorbar()","ab9b428e":"# Impute Missing Time Value\ndef c_time_sub(asset_id, data=ctrain):\n    df=data[ctrain[\"Asset_ID\"]==asset_id].set_index(\"timestamp\")\n    df=df.reindex(range(df.index[0],df.index[-1]+60,60), method=\"pad\")\n    return df","87feb9e6":"#1. Subgroup Bitcoin\nbtc=c_time_sub(asset_id=1)\n(btc.index[1:] -btc.index[:-1]).value_counts().head()\nbtc.head()","a2c08ecc":"#2. Subgroup Ethereum\neth=c_time_sub(asset_id=6)\n(btc.index[1:] -btc.index[:-1]).value_counts().head()\neth.head()","cb76a71a":"#3. Subgroup Cardano\nada=c_time_sub(asset_id=3)\n(ada.index[1:] -ada.index[:-1]).value_counts().head()\nada.head()","1a927649":"# Create time interval for 2021\ndef dur(start,end,data):\n    df=data.loc[totimestamp(start): totimestamp(end)]\n    return df\n\nbtc2021= dur(start=\"01\/01\/2021\", end=\"21\/09\/2021\", data=btc)\neth2021= dur(start=\"01\/01\/2021\", end=\"21\/09\/2021\", data=eth)\nada2021= dur(start=\"01\/01\/2021\", end=\"21\/09\/2021\", data=ada)","79a574bf":"# Plot the Closing Price for BTC, ETH, ADA\nf= plt.figure(figsize=(10,12))  \n\ndef gplot(no , data, price, label, ylabel, color):\n    ax=f.add_subplot(no)\n    plt.plot(data[price], label=label, color=color)\n    plt.legend()\n    plt.xlabel(\"Time\")\n    plt.ylabel(ylabel)\n    return plt\n\ngplot(no=311, data=btc, price=\"Close\" , label=\"BTC 2021 Overall Performance\", ylabel=\"BTC Closing Price\", color=\"Lightskyblue\")\ngplot(no=312, data=eth, price=\"Close\" ,label=\"ETH 2021 Overall Performance\", ylabel=\"ETH Closing Price\", color=\"Coral\")\ngplot(no=313, data=ada, price=\"Close\" ,label=\"Cardano 2021 Overall Performance\", ylabel=\"ADA Closing Price\", color=\"khaki\")\n\nplt.tight_layout()\nplt.show()","259c9547":"f= plt.figure(figsize=(10,12))  \ngplot(no=311, data=btc, price=\"Target\" , label=\"BTC 2021 15min Return Residue\", ylabel=\"BTC residual return\", color=\"Aqua\")\ngplot(no=312, data=eth, price=\"Target\" ,label=\"ETH 2021 15min Return Residue\", ylabel=\"ETH residual return\", color=\"Pink\")\ngplot(no=313, data=ada, price=\"Target\" ,label=\"ADA 2021 15min Return Residue\", ylabel=\"ADA residual return\", color=\"gold\")\n\n\nplt.tight_layout()\nplt.show()","eaaa8104":"def c_chart(data,label):\n    candlestick = go.Figure(data = [go.Candlestick(x =data.index, \n                                               open = data[('Open')], \n                                               high = data[('High')], \n                                               low = data[('Low')], \n                                               close = data[('Close')])])\n    candlestick.update_xaxes(title_text = 'Time',\n                             rangeslider_visible = True)\n\n    candlestick.update_layout(\n    title = {\n        'text': '{:} Candelstick Chart'.format(label),\n        \"y\":0.8,\n        \"x\":0.5,\n        'xanchor': 'center',\n        'yanchor': 'top'})\n\n    candlestick.update_yaxes(title_text = 'Price in USD', ticksuffix = '$')\n    return candlestick\n\nbtc1.head()","96f15c21":"%matplotlib inline\nbtc_candle=c_chart(btc1[-90:], label=\"BTC Price\")\nbtc_candle.show()","da280a0d":"eth_candle=c_chart(eth1[100888:100988], label=\"ETH Price \")\neth_candle.show()","6566ae7f":"%matplotlib inline\nada_candle=c_chart(eth1[-500:-400], label=\"ETH Price \")\nada_candle.show()","7785074c":"# Function to Subset the Price variables\ndef mini_data(data):\n    df=data[[\"Close\",\"Low\",\"High\",\"Open\"]]\n    return df\n\nbtc1_mini=mini_data(btc1)\neth1_mini=mini_data(eth1)\nada1_mini=mini_data(ada1)\nbtc1.head()","f80fbede":"# Function to Plot\nplt.rcParams[\"figure.figsize\"]=(15,7)\n\ndef season_df(data, label):\n    df=data.resample(\"M\").mean()\n    seasonal_decompose(df.Close).plot()\n    print(label)\n    return plt.show()\n\nseason_df(data=btc1_mini, label=\"BTC Seasonal Decomposition\")","c5fc2fce":"#ETH Seasonal Plot\nseason_df(data=eth1_mini, label=\"ETH Seasonal Decomposition\")","38d089e2":"#ADA seasonal decompostion\nseason_df(data=ada1_mini, label=\"ADA Seasonal Decomposition\")","dd5bffcd":"#Box-Cox Transformation\nbtc_month=btc1_mini.resample(\"M\").mean()\nbtc_month[\"close_box\"], lmbda=stats.boxcox(btc_month.Close)\n\n#btc_month['close_box'], lmbda = stats.boxcox(btc_month.Close)","55abe782":"qs = range(0, 3)\nps = range(0, 3)\nd=1\nparameters = product(ps, qs)\nparameters_list = list(parameters)\nlen(parameters_list)\n\n# Model Selection\nresults = []\nbest_aic = float(\"inf\")\nwarnings.filterwarnings('ignore')\nfor param in parameters_list:\n    try:\n        model = SARIMAX(btc_month.close_box, order=(param[0], d, param[1])).fit(disp=-1)\n    except ValueError:\n        print('bad parameter combination:', param)\n        continue\n    aic = model.aic\n    if aic < best_aic:\n        best_model = model\n        best_aic = aic\n        best_param = param\n    results.append([param, model.aic])","46d12cbc":"result_table = pd.DataFrame(results)\nresult_table.columns = ['parameters', 'aic']\nprint(result_table.sort_values(by = 'aic', ascending=True).head())\nprint(best_model.summary())","4d8470a3":"best_model.plot_diagnostics(figsize=(15, 12))\nplt.show()","e9415aab":"def invboxcox(y,lmbda):\n    if lmbda == 0:\n        return(np.exp(y))\n    else:\n        return(np.exp(np.log(lmbda*y+1)\/lmbda))","cd633a54":"diff1 = btc_month[['Close']].diff()\ndiff1 = diff1.dropna()\nplt.plot(diff1)\nplt.title('First order difference')\nplt.show()","e3f4ec0c":"# ARIMA model\nmodel = ARIMA(btc_month[['Close']],order=(1,1,1))\narima_result = model.fit()\narima_result.summary()","e79024d8":"# Prediction\nbtc_month_pred = btc_month[['Close']]\ndate_list = [datetime(2021, 6, 20), datetime(2021, 7, 20), datetime(2021, 8, 21), datetime(2021, 9, 21)]\nfuture = pd.DataFrame(index=date_list, columns= btc_month.columns)\nbtc_month_pred = pd.concat([btc_month_pred, future])\nbtc_month_pred['forecast'] = invboxcox(best_model.predict(start=datetime(2018, 1, 31), end=datetime(2021, 5, 31)), lmbda)\nplt.figure(figsize=(18,10))\nbtc_month_pred.Close.plot()\nbtc_month_pred.forecast.plot(color='r', ls='--', label='Predicted Close')\nplt.legend()\nplt.title('Bitcoin monthly forecast')\nplt.ylabel('USD')\nplt.show()","631fbf80":"#### 4.2 Box - Cox Transformation","fcc7630e":"### 3.2 Return Rate for BTC, ETH, and ADA\nwe see the crypto currency price went up dramatically regardless of the type, we would like to investigate one step further for the Target variable.\n*Target : 15 minute resudualized returns.\n\n*Residual Return: An asset's residual return equals its excess return minus beta times the benchmark excess return.\n\nAs we can see ETH, and BTC residual return are relatively stable compared to ADA.\nThis might be a good implication that if the investor would take short time trading opportunities, ADA is a better choice. \n\nIf the investor is risk averse, BTC or ETH will be a better fit","bda3dc9a":"#### ETH Candlestick\n\nWe randomly pick a time interval for the ETh price, we see an over sold around 1:50am, and an overbuy around 02:05 am.","b3a7a087":"### 2.1 Weight Distribution Plot\nThe Bar plot shows Bitcoin, Ethereum, and Cardano are the three most popular crypto currency for trading or investment","515bb908":"### Thank you! \u8c22\u8c22 \ud83d\ude4f","b1206929":"#### 4.1 Seasonal Decomposition","10f57396":" ### 3.1 Closing Price Trend in 2021 \n\nwe will impute the missing time value using the \"pad\" method and present the overall closing price for Bitcoin, Etherum, Carnado \n ","c974e7f9":"## 4. ARIMA Model \n","6874d031":"#### Reference\nhttps:\/\/en.wikipedia.org\/wiki\/Cryptocurrency\n\nhttps:\/\/www.investopedia.com\/tech\/most-important-cryptocurrencies-other-than-bitcoin\/\n\nhttps:\/\/www.kaggle.com\/cstein06\/tutorial-to-the-g-research-crypto-competition\n\nhttps:\/\/www.kaggle.com\/odins0n\/g-research-plots-eda\n\nhttps:\/\/www.kaggle.com\/taniaj\/cryptocurrency-predictions-with-arima\n\n**Special Thanks to Candice** \u2764\ufe0f !","ea85be39":"## 2. Data Visualization\nwe will present the weight among the 14 different crypto currency and investigate three crypto currency in depth.\n\n#### Cryptocurrency summary:\n\n0. Bitcoin (BTC): launched in January 2009. It introduced a novel idea set out in a white paper by the mysterious Satoshi Nakamoto\u2014bitcoin offers the promise of an online currency that is secured without any central authority, unlike government-issued currencies.\n\n\n1. Ethereum (ETH): The goal behind Ethereum is to create a decentralized suite of financial products that anyone in the world can freely access, regardless of nationality, ethnicity, or fait.\n\n\n3. Litecoin(LTC): known as \u201csilver to Bitcoin\u2019s gold.\u201d It is Based on an open-source global payment network that is not controlled by any central authority and uses \u201cscrypt\u201d as a proof of work, which can be decoded with the help of consumer-grade CPUs.\n\n\n4. Cardano (ADA)\uff1aan \u201cOuroboros proof-of-stake\u201d cryptocurrency that was created with a research-based approach by engineers, mathematicians, and cryptography experts.\n\n\n5. Bitcoin Cash (BCH): an important place in the history of altcoins because it is one of the earliest and most successful hard forks of the original Bitcoin\n\n\n6. Stella(XLM): an open blockchain network designed to provide enterprise solutions by connecting financial institutions for the purpose of large transactions.(Transcations between banks)\n\n\n7. Dogecoin(DOGE): as the original \"memecoin\" caused a stir in 2021 as the price of the coin skyrocketed. (Popular because of Elon Musk)\n\n\n8. Binance Coin(BNB): a utility cryptocurrency that operates as a payment method for the fees associated with trading on the Binance Exchange. It is the third-largest cryptocurrency by market capitalization. (initiated from ETH)\n\n\n9. Monero(XMR): a secure, private, and untraceable currency.The development of this cryptocurrency is completely donation-based and community-driven.\n\n\n10. TRON: Founded in 2017 by a Singapore non-profit organization, aims to host a global entertainment system for the cost-effective sharing of digital content.\n\n\n11. IOTA: a distributed ledger designed to record and execute transactions between machines and devices in the Internet of Things (IoT) ecosystem.\n\n\n12. EOS.IO: a blockchain-based, decentralized platform used to develop, host, and run business applications, or dApps.\n\n\n13. Ethererum Classic: an open-source, decentralized, blockchain-based distributed cryptocurrency platform that runs smart contracts. It is as a split version of ETH.\n","df77ffa1":"## 3. Price History\n\nWe will use the Closing Price and Candlestick graph to capture the trends of the crypto currency.","e8ce7e80":"#### ADA Candle Stick\n\nOverbuying around 16:20","4f471c2f":"#### Investment Tips 2\nDuring the time interval 22:40 to 22:50, there is a series of downward red candle, which represent **Oversold.** Theoratically, the price would go up followed by a Oversold interval\n\n**Oversold** means it's trading below what would be a typical or average trading range(sometimes the investors also call it as true value). Normally, oversold draw buyers in the market.\n","b3b30954":"### 4.2 ARIMA for Bitcoin","507d9716":"#### Investment Tips 1\nWe can see there is tremedeous price increase for BTC, ETH, and ADA in 2021, which implies they are all good investment","d1fc04c4":"### 2.2 Cryptocurrency Log Return Correlation Plot for 2021\nFrom the Correlation plot we can see Bitcoin Cash is highly correlated with EOS.IO.\n\nBinance Coin is correlated with many crypto currencies, such as , Bitcoin, Bitcoin Cash, Cardano, Ethereum. \n\nWe can have a roughly conclude that Binance Coin, Bitcoin Cash prices have a strong relation with other cryptocurrencies. Whereas Dogecoin and Monero prices are quite independent. \nEalier we mentioned Monero is based a donation, which makes sense it is not correlated so much with other coins.\n","08291e63":"## 1. Introduction\n\nCrypto, a form of digital token or \u201ccoins\u201d that exist on a distributed and decentralized ledger called a blockchain, is a popular investment nowadays.\n\nA crypto is a collection of binary data which is designed to work as a medium of exchange. Individual coin ownership records are stored in a ledger, which is a computerized database using strong cryptography to secure transaction records, to control the creation of additional coins, and to verify the transfer of coin ownership.\n\n*KEY idea: Decentralization, Blockchain\n\nThis project consisite of three parts: \n1. Data visualtion for 14 popular cryptocurrency\n2. Price History for selected individual cryptocurrency\n3. Basic Arima Model for price prediction","cfff64a2":"### 3.3 Candlestick Chart \nCandlestick charts are used by traders to determine possible price movement based on past patterns."}}