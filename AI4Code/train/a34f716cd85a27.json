{"cell_type":{"5b9b29ca":"code","b93e920b":"code","bf1b4330":"code","372f536f":"code","e78e2aee":"code","140078b2":"code","af69f87c":"code","b6c7d719":"code","9cf5dea5":"code","61737719":"code","af129e8a":"code","96ed6677":"code","d9286a99":"code","2373bc8d":"code","565d0b47":"code","41442b5a":"code","0e46910e":"code","366a8457":"code","e27b4abd":"code","6415aeca":"code","ab830382":"code","61ad91de":"code","139618df":"code","50104277":"code","8a62b63c":"code","075b6540":"code","809966ff":"code","e9f916d6":"code","4207c7d1":"code","5aea69d6":"code","36dac04b":"code","66142757":"code","e4634b70":"code","d844141b":"code","b2ebbe1f":"code","787a9b97":"code","1b212d85":"code","bc142898":"code","bd89b438":"code","d0ada282":"code","be35a50f":"code","09175537":"code","373baf3a":"code","b572d956":"code","5bb413aa":"code","83e63434":"code","f106b3fd":"code","ea58c42b":"code","7a0c35e5":"markdown","ca5cf740":"markdown","63298890":"markdown","cb416666":"markdown","5aad3e84":"markdown","3642fea7":"markdown","bbd2f96a":"markdown","36238b59":"markdown","52f2daaa":"markdown","447a2c07":"markdown","fa8eb02d":"markdown","201c0e21":"markdown","24a16fbe":"markdown","dcc3525e":"markdown","239d11af":"markdown","f4fb2db7":"markdown","370fcb81":"markdown","b29ba1c6":"markdown","ed0d6f45":"markdown","d2df03ca":"markdown","a464f605":"markdown","7d8b7761":"markdown"},"source":{"5b9b29ca":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","b93e920b":"# !pip install geopandas","bf1b4330":"import pandas as pd\nPATH='\/kaggle\/input\/cft-shift2022\/'\n\ntrain = pd.read_csv(PATH+'train.csv')\ntest = pd.read_csv(PATH+'test.csv')","372f536f":"from shapely.geometry import box\nmin_longitude = min(test.longitude.min(), train.longitude.min())\nmax_longitude = max(test.longitude.max(), train.longitude.max())\nmin_latitude = min(test.latitude.min(), train.latitude.min())\nmax_latitude = max(test.latitude.max(), train.latitude.max())\nbig_box = box(min_longitude - 0.03, min_latitude - 0.03, max_longitude + 0.03, max_latitude + 0.03)","e78e2aee":"ALL =         '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp'\nTRAFFIC =     '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_traffic_a_free_1.shp'\nTRANSPORT =   '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_transport_free_1.shp'\nWATER =       '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_water_a_free_1.shp'\nWATERWAYS =   '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_waterways_free_1.shp'\nPOWF =        '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_pofw_free_1.shp'\nPOFW_A =      '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_pofw_a_free_1.shp'\nLANDUSE =     '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_landuse_a_free_1.shp'\nPLACES =      '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_places_free_1.shp'\nPLACES_A =    '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_places_a_free_1.shp'\nPOIS =        '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_pois_free_1.shp'\nPOIS_A =      '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_pois_a_free_1.shp'\nNATURAL =     '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_natural_free_1.shp'\nNATURAL_A =   '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_natural_a_free_1.shp'\nBUILDINGS_A = '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_buildings_a_free_1.shp'\nROADS =       '\/kaggle\/input\/osm-central-region-of-russia\/central-fed-district-latest-free.shp\/gis_osm_roads_free_1.shp'","140078b2":"import geopandas as gp\nPOIS_A_m = gp.read_file(POIS_A, bbox=big_box)\nTRANSPORT_m = gp.read_file(TRANSPORT, bbox=big_box)\nLANDUSE_m = gp.read_file(LANDUSE, bbox=big_box)","af69f87c":"WATER_m = gp.read_file(WATER, bbox=big_box)\nPOFW_A_m = gp.read_file(POFW_A, bbox=big_box)\nBUILDING_A_m = gp.read_file(BUILDINGS_A, bbox=big_box)","b6c7d719":"driver = [\n    {\n        'layer': POIS_A_m[POIS_A_m.code == 2083],\n        'distance': 0.5\n    },\n    {\n        'layer': POIS_A_m[POIS_A_m.code == 2082],\n        'distance': 0.5\n    },\n    {\n        'layer': TRANSPORT_m[TRANSPORT_m.code == 5651],\n        'distance': 3\n    },\n    {\n        'layer': TRANSPORT_m[TRANSPORT_m.code == 5601],\n        'distance': 1\n    },\n    {\n        'layer': POIS_A_m[POIS_A_m.code == 2081],\n        'distance': 1\n    },\n    {\n        'layer': POIS_A_m[POIS_A_m.code == 2084],\n        'distance': 1\n    },\n    {\n        'layer': POIS_A_m[POIS_A_m.code == 2010],\n        'distance': 1.5\n    },\n    {\n        'layer': LANDUSE_m[LANDUSE_m.code == 7201],\n        'distance': 3\n    },\n    {\n        'layer': LANDUSE_m[LANDUSE_m.code == 7202],\n        'distance': 1.5\n    },\n    {\n        'layer': LANDUSE_m[LANDUSE_m.code == 7206],\n        'distance': 0.5\n    },\n    {\n        'layer': TRANSPORT_m[TRANSPORT_m.code == 5621],\n        'distance': 0.4\n    },\n    {\n        'layer': TRANSPORT_m[TRANSPORT_m.code == 5620],\n        'distance': 0.6\n    },\n    {\n        'layer': POIS_A_m[POIS_A_m.code == 2301],\n        'distance': 0.7\n    },\n    {\n        'layer': POIS_A_m[POIS_A_m.code == 2303],\n        'code': 2303,\n        'distance': 0.7\n    },\n    {\n        'layer': POIS_A_m[POIS_A_m.code == 2201],\n        'distance': 1.4\n    },\n    {\n        'layer': POIS_A_m[POIS_A_m.code == 2501],\n        'distance': 0.5\n    },\n    \n    {\n        'layer': POIS_A_m[POIS_A_m.code == 2110],\n        'distance': 1\n    },\n    {\n        'layer': POIS_A_m[POIS_A_m.code == 2401],\n        'distance': 1.4\n    },\n    {\n        'layer': POIS_A_m[POIS_A_m.code == 2405],\n        'distance': 1.4\n    },\n    {\n        'layer': POIS_A_m[POIS_A_m.code == 2601],\n        'distance': 0.7\n    },\n    {\n        'layer': POIS_A_m[POIS_A_m.code == 2001],\n        'distance': 1\n    },\n    {\n        'layer': WATER_m[WATER_m.code == 8201],\n        'distance': 1\n    },\n    {\n        'layer': POFW_A_m,\n        'distance': 0.7\n    },\n    {\n        'layer': BUILDING_A_m[(BUILDING_A_m['type'] == 'retail')],\n        'distance': 0.7\n    },\n    {\n        'layer': BUILDING_A_m[(BUILDING_A_m['type'] == 'industrial')],\n        'distance': 1\n    },\n    {\n        'layer': BUILDING_A_m[(BUILDING_A_m['type'] == 'shed')],\n        'distance': 0.2\n    },\n    {\n        'layer': BUILDING_A_m[(BUILDING_A_m['type'] == 'garages')],\n        'distance': 0.2\n    }\n]","9cf5dea5":"def flatten(t):\n    return [item for sublist in t for item in sublist]\n\nnames0 = [\n    'kindergarten',\n    'school',\n    'airport',\n    'railway_station',\n    'university',\n    'college',\n    'prison',\n    'forest',\n    'park',\n    'cemetery',\n    'bus_stop',\n    'parking',\n    'restaurant',\n    'cafe',\n    'theatre',\n    'supermarket',\n    'hospital',\n    'hotel',\n    'hostel',\n    'bank',\n    'police',\n    'water',\n    'pofw',\n    'retail',\n    'industrial',\n    'shed',\n    'garages'\n]\n\nnames = ['id'] + flatten(list(map(lambda x: (x+'_count', x+'_area', x+'_inv_dist'), names0)))","61737719":"from shapely.geometry import box, Point\nimport geopandas as gpd\nfrom functools import reduce\n\nfactor = 10**6\n\ndef get_area(geometries, factor):\n    return reduce(lambda sum1, element2: sum1 + element2.area * factor, geometries, 0)\n\ndef get_min_way(start_point, geometries, factor):\n    if len(geometries) == 0: \n        return 0\n    minDist = min(geometries.distance(start_point))\n    if minDist == 0: return factor\n    return 1 \/ minDist\n    \ndef get_feature(longitude, latitude, obj, factor):\n    d = obj['distance'] \/ 111\n    bbox = box(longitude - d, latitude - d, longitude + d, latitude + d)\n    info = obj['layer']\n    info = info[info.geometry.intersects(bbox)]\n    \n    return info.shape[0], get_area(info.geometry, factor), get_min_way(Point(longitude, latitude), info.geometry, factor)\n\ndef get_features(longitude, latitude, factor):\n    feature_list = list(map(lambda obj: get_feature(longitude, latitude, obj, factor), driver))\n    return flatten(feature_list)","af129e8a":"from tqdm import tqdm\n\ndef save(dataframe, index):\n    output = open('\/kaggle\/working\/features_test.csv', 'w')\n    dataframe.to_csv(output, index=False)\n\ndef extract_features_for_dataset(dataframe: pd.DataFrame, minindex: int = 0, maxindex: int = 5, period: int = 100):\n    trainFeatures = []\n    for index, data in tqdm(dataframe.iterrows()):\n        if (index < minindex): continue\n        if ((index >= maxindex) & (maxindex != -1)): break\n            \n        main_info = [data.ID]\n        features = get_features(data.longitude, data.latitude, factor)\n        trainFeatures.append(main_info + features)\n        \n        if (index % period == period - 1): \n            save(pd.DataFrame(trainFeatures, columns=names), index \/ period)\n        \n    save(pd.DataFrame(trainFeatures, columns=names), 0)\n    return pd.DataFrame(trainFeatures, columns = names)","96ed6677":"%%time\nimport warnings\nwarnings.filterwarnings('ignore')\nfeatures_temp = extract_features_for_dataset(test, 0, 2000, 100)","d9286a99":"import pandas as pd\nfeatures_train = pd.read_csv('\/kaggle\/input\/with-dist-data\/features_train8000dist.csv')\nfeatures_test = pd.read_csv('\/kaggle\/input\/with-dist-data\/features_test4000dist.csv')","2373bc8d":"drawinglist = ['kindergarten_count', 'university_count', 'school_count', 'shed_count']\nfeatures_Kind_t = features_train[drawinglist + ['target']]","565d0b47":"import matplotlib.pyplot as plt\nimport seaborn as sns\n# sns.set_theme(style=\"whitegrid\")\nax = sns.countplot(x=\"kindergarten_count\", hue=\"target\", data=features_Kind_t)","41442b5a":"import matplotlib.pyplot as plt\nimport seaborn as sns\nfig, axs = plt.subplots(ncols=len(drawinglist))\nfig.tight_layout()\n\nfor index, value in enumerate(drawinglist):\n    sns.violinplot(x=\"target\", y=value,\n                    data=features_Kind_t, palette=\"Set2\",\n                    scale=\"count\", ax=axs[index]).set_title(value)","0e46910e":"from sklearn.model_selection import train_test_split\n\ny,X=features_train2.iloc[:, 1:2],features_train2.iloc[:, 2:]\ny = y.to_numpy().flatten()\n\n\nX_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.33, random_state=42)","366a8457":"y_test_ids,X_test = features_test.iloc[:, 0:1],features_test.iloc[:, 1:]","e27b4abd":"def feature_importances(importances, columns):\n    cat_iris_imp = pd.Series(importances, columns)\n    fig, ax = plt.subplots(figsize=(16,14))\n    cat_iris_imp.plot.bar(ax=ax)\n    ax.set_title(\"\u0412\u0430\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432\")\n    ax.set_ylabel('\u0412\u0430\u0436\u043d\u043e\u0441\u0442\u044c, %')\n    fig.tight_layout()","6415aeca":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV","ab830382":"_forest_clf = RandomForestClassifier(random_state=0)\nforest_parameters = [\n    {\n        \"max_depth\": [3, 5, 7], \n        \"n_estimators\": [20, 40],\n        \"max_features\": [5, 8, 16]\n    },\n]\nforest_clf = GridSearchCV(_forest_clf,forest_parameters, verbose=1,scoring='roc_auc')","61ad91de":"forest_clf.fit(X_train, y_train)","139618df":"forest_clf.best_params_","50104277":"from sklearn.metrics import roc_auc_score\nforest_auc=roc_auc_score(y_val, forest_clf.predict_proba(X_val)[:, 1])\nprint('Forest ROC-AUC:',forest_auc)","8a62b63c":"feature_importances(forest_clf.best_estimator_.feature_importances_, X_train.columns)","075b6540":"forest_proba = forest_clf.predict_proba(X_test)","809966ff":"from catboost import CatBoostClassifier\ncat_parameters = [\n    {\n        'depth': [10],\n        'learning_rate': [0.001],\n        'n_estimators': [125]\n    }\n]\n_cat_clf=CatBoostClassifier(\n    od_type='Iter',\n    od_wait=1000,\n    eval_metric='AUC'\n)\ncat_clf = GridSearchCV(_cat_clf,cat_parameters,verbose=0,scoring='roc_auc')","e9f916d6":"cat_clf.fit(X_train,y_train, verbose=0)","4207c7d1":"cat_clf.best_params_","5aea69d6":"cat_auc=roc_auc_score(y_val, cat_clf.predict_proba(X_val)[:, 1])\nprint('CatBoost ROC-AUC:',cat_auc)","36dac04b":"cat_proba = cat_clf.predict_proba(X_test)","66142757":"feature_importances(cat_clf.best_estimator_.get_feature_importance(), X_train.columns)","e4634b70":"dt_parameters = [\n    {\n        \"max_depth\": [5, 12, 17], \n        \"max_features\": [10, 20, 35, 50, 70],\n        \"splitter\": [\"best\", \"random\"]\n    },\n]","d844141b":"from sklearn.tree import DecisionTreeClassifier\n\n_dt_clf = DecisionTreeClassifier(random_state=0)\ndt_clf = GridSearchCV(_dt_clf, dt_parameters, verbose=1,scoring='roc_auc')","b2ebbe1f":"dt_clf.fit(X_train, y_train)","787a9b97":"dt_clf.best_params_","1b212d85":"dt_auc=roc_auc_score(y_val, dt_clf.predict_proba(X_val)[:, 1])\n\nprint('Decicion tree ROC-AUC:',dt_auc)","bc142898":"feature_importances(dt_clf.best_estimator_.feature_importances_, X_train.columns)","bd89b438":"dt_proba = dt_clf.predict_proba(X_test)","d0ada282":"import xgboost as xgb\nparameters = {\n  'learning_rate': [1e-1, 1e-2], #so called eta value\n  'max_depth': [5, 7, 9],\n  'subsample': [0.8],\n  'colsample_bytree': [0.7],\n  'n_estimators': [20, 45, 60] #number of trees, change it to 1000 for better results\n}\n\n_xgb_clf = xgb.XGBClassifier(\n    objective='binary:logistic',\n    booster='gbtree',\n    eval_metric='auc',\n    tree_method='hist',\n    grow_policy='lossguide',\n    use_label_encoder=False,\n    seed=5\n#     learning_rate= 1e-2,\n#     max_depth= 9,\n#     silent= 1,\n#     subsample= 0.8,\n#     colsample_bytree= 0.7,\n#     n_estimators=70\n)\n\n\nxgb_clf = GridSearchCV(_xgb_clf, parameters, scoring='roc_auc', verbose=1, refit=True)","be35a50f":"xgb_clf.fit(X_train, y_train)","09175537":"xgb_clf.best_params_","373baf3a":"xgb_auc=roc_auc_score(y_val, xgb_clf.predict_proba(X_val)[:, 1])\nprint('XGBoost ROC-AUC:',xgb_auc)","b572d956":"xgb_proba = xgb_clf.predict_proba(X_test)","5bb413aa":"import numpy as np\nprobas = [xgb_proba, cat_proba, forest_proba]\nprobas_avg = np.sum(probas, axis=0) \/ len(probas)","83e63434":"res = probas_avg[:,1:]\nanswer = y_test_ids.assign(target=res).rename(columns={'id': 'ID'})\nanswer.ID = answer.ID.astype(int)\nanswer.target = answer.target.astype(float)\nanswer.to_csv('\/kaggle\/working\/submission.csv', index=False)\npd.read_csv('\/kaggle\/working\/submission.csv')","f106b3fd":"list(map(lambda elem: elem, names0))","ea58c42b":"features_train2 = features_train[['id', 'target'] + list(map(lambda x: (x+'_inv_dist'), names0))]\nfeatures_train2","7a0c35e5":"### Features extraction","ca5cf740":"\u041d\u0438\u0436\u0435 \u043f\u0435\u0440\u0435\u0447\u0438\u0441\u043b\u0435\u043d\u044b \u0438\u043c\u0435\u043d\u0430 \u0441\u0442\u043e\u043b\u0431\u0446\u043e\u0432. \u041d\u0430\u043c\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0432 \u0440\u0430\u0439\u043e\u043d\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u0430, \u0438\u0445 \u0441\u0443\u043c\u043c\u0430\u0440\u043d\u043e\u0439 \u043f\u043b\u043e\u0449\u0430\u0434\u0438 \u0438 \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0435 \u0440\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0434\u043e \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0433\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u0442\u0430\u043a\u043e\u0433\u043e \u0442\u0438\u043f\u0430. \u041e\u0431\u0440\u0430\u0442\u043d\u043e\u0435 - \u0447\u0442\u043e\u0431\u044b \u0443\u043a\u0430\u0437\u0430\u0442\u044c 0 \u0432 \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u0442\u0430\u043a\u0438\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0432 \u044d\u0442\u043e\u043c \u0440\u0430\u0439\u043e\u043d\u0435 \u043d\u0435\u0442.","63298890":"### Train test","cb416666":"#### XGBoost","5aad3e84":"#### Decision Tree","3642fea7":"\u0417\u0434\u0435\u0441\u044c, \u043d\u0438\u0436\u0435, \u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u043c \u0442\u0435 \u0444\u0430\u0439\u043b\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u0430\u043b\u0435\u0435","bbd2f96a":"#### MLPC","36238b59":"### Consts and drivers","52f2daaa":"driver - \u0441\u043f\u0438\u0441\u043e\u043a \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432, \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0438\u0445 \u0446\u0443\u043b\u0435\u0432\u0443\u044e \u0432\u044b\u0431\u043e\u0440\u043a\u0443('layer') \u0438 \u043d\u0430\u0438\u0431\u043e\u043b\u044c\u0448\u0435\u0435 \u0440\u0430\u0441\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0435\u043c\u043e\u0435 \u0440\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043e\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0434\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u044d\u0442\u043e\u0433\u043e \u0442\u0438\u043f\u0430","447a2c07":"\u0412 \u0444\u0443\u043d\u043a\u0446\u0438\u044e extract_features_for_dataset \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u043c \u0434\u0430\u043d\u043d\u044b\u0435 (test \u0438\u043b\u0438 train), \u0433\u0440\u0430\u043d\u0438\u0446\u044b \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b\u0430 \\[min, max), \u0430 \u0442\u0430\u043a\u0436\u0435 \u043f\u0435\u0440\u0438\u043e\u0434 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0444\u0430\u0439\u043b. \u0414\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u044f\u0432\u044f\u0442\u0441\u044f \u0432 \u043f\u0430\u043f\u043a\u0435 \/kaggle\/working","fa8eb02d":"### Process","201c0e21":"mlp_clf.best_params_","24a16fbe":"big_box - \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 \u043e\u0431\u0440\u0435\u0437\u043a\u0438 \u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u043c\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445","dcc3525e":"from sklearn.neural_network import MLPClassifier \nfrom sklearn.model_selection import GridSearchCV\n\n_mlp_clf = MLPClassifier(\n    alpha=1e-5,\n    random_state=1\n)\nmlp_clf = GridSearchCV(_mlp_clf, tuned_parameters, verbose=1,scoring='roc_auc')","239d11af":"# \u0421\u043e\u0432\u043c\u0435\u0441\u0442\u043d\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430 \u042d\u0434\u0443\u0430\u0440\u0434\u0430 \u0425\u0443\u0441\u043d\u0443\u0442\u0434\u0438\u043d\u043e\u0432\u0430 \u0438 \u0412\u043b\u0430\u0434\u0438\u043c\u0438\u0440\u0430 \u041c\u044b\u043d\u043a\u0430","f4fb2db7":"#### Cat Boost","370fcb81":"#### Result","b29ba1c6":"tuned_parameters = [\n    {\n        'hidden_layer_sizes': [(50, 30), (150, 80, 30), (45, 20)],\n        'learning_rate_init': [0.01, 0.05, 0.001],\n        'max_iter': [1000, 200]\n    }\n]","ed0d6f45":"### Load data","d2df03ca":"mlp_clf.fit(X_train,y_train)","a464f605":"mlp_auc=roc_auc_score(y_val, mlp_clf.predict_proba(X_val)[:, 1])\n\nprint('Multilayer preceptron ROC-AUC:',mlp_auc)","7d8b7761":"#### Random Forest"}}