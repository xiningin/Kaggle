{"cell_type":{"ddffafa2":"code","7cf286f1":"code","0453cbde":"code","f92c67c4":"code","2d172e06":"code","88dbcb8d":"code","d9e529c8":"code","1de65888":"code","a869911c":"code","713fe72d":"code","54f5b882":"code","5a1d52d4":"code","114f29f9":"code","f2c1ad8d":"code","3478bad3":"code","91d8f3ce":"code","6a539432":"code","e53f6de0":"code","ba28fcda":"code","263c519a":"code","0db1f0ed":"code","ed3ade13":"markdown","b74c6ab3":"markdown","426a7cb2":"markdown","92955437":"markdown","0f1ed358":"markdown","63a1b1d0":"markdown","3b11b6d9":"markdown","acd8df7a":"markdown"},"source":{"ddffafa2":"# \uc2dc\ud5d8 \uc81c\uacf5\uc6a9\nimport pandas as pd\n# a = pd.read_csv(\"..\/input\/traval-insurance-exam\/train.csv\")\n# b = pd.read_csv('..\/input\/traval-insurance-exam\/test.csv')\n\n# pd.DataFrame(\ubcc0\uc218).to_csv('000000000.csv')\n\n# \ubcf4\ud5d8\uac00\uc785 \ud655\ub960\uc744 \ubb3b\ub294 \ubb38\uc81c\n\n\n# \ucd9c\ub825\ud615\ud0dc \n# index,y_pred\n# 0,0.15246735144689827\n# 1,0.9615112924356346\n# 2,0.15131398160778645\n# 3,0.23663288296712173\n# 4,0.9385824940846587\n# 5,0.15738583559845978\n","7cf286f1":"train = pd.read_csv(\"..\/input\/traval-insurance-exam\/train.csv\")\ntest = pd.read_csv('..\/input\/traval-insurance-exam\/test.csv')","0453cbde":"# \ud06c\uae30 \ud655\uc778\ntrain.shape, test.shape","f92c67c4":"# \ud0c0\uc785 \ud655\uc778\ntrain.info()","2d172e06":"# \uacb0\uce21\uce58 \ud655\uc778\ntrain.isnull().sum()","88dbcb8d":"# \uacb0\uce21\uce58 \ud655\uc778\ntest.isnull().sum()","d9e529c8":"train.describe()","1de65888":"train['TravelInsurance'].value_counts()","a869911c":"# \uc218\uce58\ud615 \ub370\uc774\ud130\uc640 \ubc94\uc8fc\ud615 \ub370\uc774\ud130 \ubd84\ub9ac \nn_train = train.select_dtypes(exclude='object').copy()\nc_train = train.select_dtypes(include='object').copy()\nn_test = test.select_dtypes(exclude='object').copy()\nc_test = test.select_dtypes(include='object').copy()","713fe72d":"# \uc218\uce58\ud615 \ubcc0\uc218\nfrom sklearn.preprocessing import RobustScaler\nscaler = RobustScaler()\ncols = ['Age', 'AnnualIncome', 'FamilyMembers', 'ChronicDiseases']\n\ndisplay(n_train.head())\nn_train[cols] = scaler.fit_transform(n_train[cols])\nn_test[cols] = scaler.transform(n_test[cols])\nn_train.head()","54f5b882":"# \ubc94\uc8fc\ud615 \ubcc0\uc218\ndisplay(c_train.head())\nc_train = pd.get_dummies(c_train)\nc_test = pd.get_dummies(c_test)\nc_train.head()","5a1d52d4":"# \ubd84\ub9ac\ud55c \ub370\uc774\ud130 \ub2e4\uc2dc \ud569\uce68\ntrain = pd.concat([n_train, c_train], axis=1)\ntest = pd.concat([n_test, c_test], axis=1)\nprint(train.shape, test.shape)\ntrain.head()","114f29f9":"from sklearn.model_selection import train_test_split\nX_tr, X_val, y_tr, y_val = train_test_split(train.drop('TravelInsurance', axis=1), \n                                            train['TravelInsurance'],\n                                            test_size=0.1,\n                                            random_state=1204)\nX_tr.shape, X_val.shape, y_tr.shape, y_val.shape","f2c1ad8d":"from sklearn.ensemble import RandomForestClassifier\nrf = RandomForestClassifier(n_estimators=400, max_depth=9, random_state=1204)\nrf.fit(X_tr, y_tr)\npred = rf.predict_proba(X_val)[:,1]","3478bad3":"from sklearn.metrics import roc_auc_score\nroc_auc_score(y_val, pred)","91d8f3ce":"pred = rf.predict_proba(test)[:,1]","6a539432":"# csv \ud30c\uc77c \uc0dd\uc131 (\uc608\uc2dc\uc640 \ub2e4\ub978 \ud615\ud0dc)\npd.DataFrame({'index':test.index,'y_pred':pred}).to_csv('0000.csv', index=False)","e53f6de0":"# \ub610\ub294\npd.DataFrame({'y_pred':pred}).reset_index().to_csv('1111.csv', index=False)","ba28fcda":"pd.read_csv(\".\/0000.csv\")","263c519a":"pd.read_csv(\".\/1111.csv\")","0db1f0ed":"y_test = pd.read_json(\"..\/input\/traval-insurance-exam\/y_test.json\")\nroc_auc_score(y_test, pred)","ed3ade13":"## \uac80\uc99d \ud3c9\uac00","b74c6ab3":"## \ud480\uc774\n- \uc544\ub798 \ud480\uc774\ub294 \uc608\uc2dc \uc77c \ubfd0\uc784","426a7cb2":"## test \ub370\uc774\ud130 \uc608\uce21","92955437":"## \ud3c9\uac00(\uccb4\uc810)","0f1ed358":"## \ub370\uc774\ud130 \uc804\ucc98\ub9ac","63a1b1d0":"## \ubaa8\ub378","3b11b6d9":"## EDA","acd8df7a":"## \uac80\uc99d \ub370\uc774\ud130 \ubd84\ub9ac"}}