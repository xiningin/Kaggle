{"cell_type":{"965e93bf":"code","718e4a95":"code","3f57b88a":"code","fb6d4dc5":"code","e6c58bea":"code","26610c66":"code","44b115d7":"code","1056a108":"code","13208725":"code","164570d7":"code","dc097455":"code","685b3332":"code","0126cfa8":"code","db5e8ce1":"code","947dff0d":"code","7db2fac5":"code","93d636ac":"code","af00d7f3":"code","770dafbe":"code","199c3d6f":"code","201b69ad":"code","41580488":"code","b9cae460":"code","44f9e686":"code","3478cf7c":"code","ca64d3f3":"code","8504fe5c":"code","67fd805c":"code","ab710796":"markdown","567e813a":"markdown","49b790eb":"markdown","c5784725":"markdown","778589e3":"markdown","d1f70602":"markdown","08e7d5d6":"markdown","3428f6a1":"markdown","ab1b38b8":"markdown","779601bb":"markdown","6462962e":"markdown","ccbf6ae9":"markdown","0014ca30":"markdown"},"source":{"965e93bf":"!pip install pycaret","718e4a95":"import pandas as pd\nimport numpy as np\nimport category_encoders as ce\nfrom sklearn.model_selection import train_test_split\nfrom pycaret.regression import *\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error,mean_absolute_error,r2_score\nimport pandas_profiling as pp\nimport matplotlib.pyplot as plt\nimport seaborn as sns","3f57b88a":"df = pd.read_csv(\"..\/input\/crop-price-prediction\/corn yield.csv\")","fb6d4dc5":"df.head()","e6c58bea":"df.isnull().sum()","26610c66":"for i in df:\n    print(i,df[i].value_counts(),sep=\"\\n\",end=\"\\n\")","44b115d7":"cols_to_be_removed = [\"Program\",\"Week Ending\",\"Ag District\",\"Ag District Code\",\"County\",\"County ANSI\",\"Zip Code\",\"Region\",\"Watershed\",\"CV (%)\",\"Domain Category\",\"Commodity\",\"Geo Level\",\"watershed_code\",\"Domain\"]","1056a108":"df.drop(columns=cols_to_be_removed,axis = 1,inplace=True)","13208725":"prof = pp.ProfileReport(df)","164570d7":"prof","dc097455":"df[\"State ANSI\"].fillna(0,inplace=True)","685b3332":"df.isnull().sum()","0126cfa8":"for i in df:\n    print(i,df[i].value_counts(),sep=\"\\n\",end=\"\\n\")","db5e8ce1":"df[\"Value\"] = df[\"Value\"].str.replace(',','')\ndf[\"State ANSI\"] = df[\"State ANSI\"].astype(\"int\")\ndf[\"Value\"] = df[\"Value\"].astype(\"float\")","947dff0d":"def one_hot_encoding(df,column):\n    one_hot_encoder=ce.OneHotEncoder(cols=column,return_df=True,use_cat_names=True)\n    df_final = one_hot_encoder.fit_transform(df)\n    return df_final","7db2fac5":"df = one_hot_encoding(df,\"Period\")\ndf = one_hot_encoding(df,\"Data Item\")\ndf = one_hot_encoding(df,\"State\")","93d636ac":"X = df.drop(\"Value\",axis = 1)\nY = df[\"Value\"]","af00d7f3":"X_train,X_test,Y_train,Y_test = train_test_split(X,Y,random_state=27,test_size=0.2)","770dafbe":"train,test = train_test_split(df, test_size=0.25,random_state= 27)","199c3d6f":"experiment = setup(\n    data = train,\n    target = 'Value',\n)","201b69ad":"compare_models()","41580488":"random_reg = RandomForestRegressor(n_estimators = 100, random_state = 0)","b9cae460":"random_reg.fit(X_train, Y_train)","44f9e686":"Y_pred = random_reg.predict(X_test)","3478cf7c":"mse = mean_squared_error(Y_pred,Y_test)\nmse","ca64d3f3":"mae = mean_absolute_error(Y_pred,Y_test)\nmae","8504fe5c":"r2_score = r2_score(Y_pred,Y_test)\nr2_score","67fd805c":"plot = sns.regplot(Y_pred,Y_test)\nplot.set(xlabel=\"Predicted\",ylabel = \"Actual\")\n","ab710796":"<b>As Random Forest Regressor gives more R<sup>2<\/sup> value we choose them for training our model \ud83d\udd25<\/b>","567e813a":"## One Hot encoding","49b790eb":"### Insights\n&emsp;The R<sup>2<\/sup> value between predicted and actual values shows a strong positive correlation\n","c5784725":"## Training Models","778589e3":"## Transforming data to required format","d1f70602":"## Data Overview","08e7d5d6":"## Importing Data","3428f6a1":"# Thank You \ud83e\udd17\n### I hope you had a good time reading my notebook. Pls do support and comment! \ud83d\ude0e","ab1b38b8":"## Evaluation Metrics","779601bb":"## Model Comparison","6462962e":"## Analysing Data","ccbf6ae9":"## Importing Packages","0014ca30":"<center><h1 class=\"list-group-item list-group-item-success\">CROP PRICE PREDICTION<\/h1><\/center>\n<br>\n<div>\n    <div class=\"row justify-content-space-between\">\n        <div class=\"col-lg-6\" style=\"padding:1em;height:100%\">\n            <img style=\"height:26em\" src = \"https:\/\/media.nationalgeographic.org\/assets\/photos\/120\/983\/091a0e2f-b93d-481b-9a60-db520c87ec33.jpg\" >\n        <\/div>\n        <div class=\"col-lg-6\" style=\"padding:1em;\">\n            <div>\n                <h3 style=\"font-size:1.4em\">Context<\/h3>\n                  <p>This dataset is focused on the crops which can reflect the price area and other attributes from that one can predict for future price yield by using some better attributes.<\/p>\n            <\/div><br>\n            <div>\n                <h3 style=\"font-size:1.4em;margin:2em 0\">Contents<\/h3>\n                <ul style = \"color:blue\">\n                    <li>Importing Packages<\/li>\n                    <li>Importing Data<\/li>\n                    <li>Analysing Data<\/li>\n                    <li>Data Overview<\/li>\n                    <li>Transforming data to required format<\/li>\n                    <li>One Hot encoding<\/li>\n                    <li>Model Comparison<\/li>\n                    <li>Training Models<\/li>\n                    <li>Evaluation Metrics<\/li>\n                <\/ul>\n            <\/div>\n        <\/div>\n    <\/div>\n<\/div>\n"}}