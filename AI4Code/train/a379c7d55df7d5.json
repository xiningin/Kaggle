{"cell_type":{"b485ec33":"code","b59ca99f":"code","40ffecff":"code","574c69be":"code","b0a72dbf":"code","1b3c4bb3":"code","a0db2e8d":"code","5d763b37":"code","39c2185f":"code","0d4c7e6e":"code","dbe84e9d":"code","f05ef447":"code","1ac2eee5":"code","fce07c86":"code","e676f2f2":"code","74ddf391":"code","245c0f9f":"code","b525499c":"code","a7ce3e9b":"code","1d6ba51c":"code","9b6ba91b":"code","c0ffe4ed":"code","17c3e7e4":"code","36349c54":"code","77653b70":"code","e35cf796":"code","5811939f":"code","a0b71147":"code","b14711be":"code","ce409b15":"code","e8aeb128":"code","dd9e355a":"code","9b19c04b":"code","31246cf3":"code","bf0f4dc1":"code","430fa7e3":"code","98f565ea":"code","9230911b":"code","cf6d2fb9":"code","88613ba6":"code","7b5bdf79":"code","46517ccf":"code","79e6917a":"code","e352d621":"code","5a32704a":"code","7603c4ba":"code","95955e8c":"code","468b7715":"code","cc8bb722":"code","27f69a3b":"code","a3875675":"code","edf78785":"code","5a50c289":"code","39cff8ed":"code","3d04339d":"code","a6c3b2d5":"code","463ff24f":"code","3f0b1b1f":"code","ca207746":"code","2abd28a1":"code","4369ebc1":"code","1f0bf1b8":"markdown","fa28a835":"markdown","36222c84":"markdown","78eaba36":"markdown","ce0da6a0":"markdown","ab97e5bb":"markdown","554ead1a":"markdown","d006fe7a":"markdown","63d05d0b":"markdown"},"source":{"b485ec33":"from shapely.geometry import Point\nimport pandas as pd\nimport geopandas as gpd\nimport contextily\nimport folium\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport os\nfrom urllib.request import urlretrieve\nimport zipfile","b59ca99f":"sns.set(font_scale=1.4)\nsns.set_style({'font.family': 'serif',\n               'fontname': 'Times New Roman'})","40ffecff":"if not os.path.exists('\/kaggle\/working\/mapas'):\n    os.makedirs('\/kaggle\/working\/mapas')","574c69be":"url_setores_censitarios = 'https:\/\/geoftp.ibge.gov.br\/organizacao_do_territorio\/malhas_territoriais\/malhas_de_setores_censitarios__divisoes_intramunicipais\/censo_2010\/setores_censitarios_shp\/am\/am_setores_censitarios.zip'","b0a72dbf":"%%time\n\nurlretrieve(url_setores_censitarios, '\/kaggle\/working\/mapas\/am_setores_censitarios.zip')","1b3c4bb3":"with zipfile.ZipFile('\/kaggle\/working\/mapas\/am_setores_censitarios.zip', 'r') as zip_ref:\n    zip_ref.extractall('\/kaggle\/working\/mapas\/')","a0db2e8d":"os.remove('\/kaggle\/working\/mapas\/am_setores_censitarios.zip')","5d763b37":"am_setores_gdf = gpd.read_file('\/kaggle\/working\/mapas\/13SEE250GC_SIR.shp')","39c2185f":"am_setores_gdf.shape","0d4c7e6e":"am_setores_gdf.head()","dbe84e9d":"am_setores_gdf.iloc[0].geometry","f05ef447":"am_setores_gdf.crs.to_string()","1ac2eee5":"am_setores_gdf = am_setores_gdf.to_crs(crs='EPSG:3857')","fce07c86":"am_setores_gdf.crs.to_string()","e676f2f2":"am_setores_gdf.head()","74ddf391":"ax = am_setores_gdf.plot(figsize=(15, 10), edgecolor='black', facecolor='none')\ncontextily.add_basemap(ax)\nax.set_axis_off()\nplt.show()","245c0f9f":"mao_setores_gdf = am_setores_gdf[am_setores_gdf['NM_MUNICIP'] == 'MANAUS']","b525499c":"mao_setores_gdf.shape","a7ce3e9b":"ax = mao_setores_gdf.plot(figsize=(15, 10), edgecolor='black', facecolor='none')\ncontextily.add_basemap(ax)\nax.set_axis_off()\nplt.show()","1d6ba51c":"ax = mao_setores_gdf.plot(figsize=(15, 10), edgecolor='black', column='TIPO', legend=True)\ncontextily.add_basemap(ax)\nax.set_axis_off()\nplt.show()","9b6ba91b":"mao_setores_urb_gdf = mao_setores_gdf[mao_setores_gdf['TIPO'] == 'URBANO']","c0ffe4ed":"mao_setores_urb_gdf.shape","17c3e7e4":"ax = mao_setores_urb_gdf.plot(figsize=(15, 10), edgecolor='black', facecolor='none')\ncontextily.add_basemap(ax)\nax.set_axis_off()\nplt.show()","36349c54":"mao_setores_urb_gdf.head()","77653b70":"mao_setores_urb_gdf['NM_BAIRRO'].unique()","e35cf796":"plt.figure(figsize=(50,8))\n\nax = sns.countplot(x='NM_BAIRRO', \n                   data=mao_setores_urb_gdf, \n                   order=mao_setores_urb_gdf['NM_BAIRRO'].value_counts().index)\n\nlabels = [item.get_text().replace(' ', '\\n') for item in ax.get_xticklabels()]\nax.set_xticklabels(labels, rotation = 90)\n\nax.set_xlabel('Bairros de Manaus (AM)')\nax.set_ylabel('Qtd. de setores censit\u00e1rios')\n\nplt.show()","5811939f":"ax = mao_setores_urb_gdf.plot(figsize=(50, 30), edgecolor='black', column='NM_BAIRRO', legend=True)\ncontextily.add_basemap(ax)\nax.set_axis_off()\nplt.show()","a0b71147":"mao_setores_urb_gdf.to_file('\/kaggle\/working\/mapas\/mao_setores_urb.json', driver='GeoJSON')","b14711be":"if not os.path.exists('\/kaggle\/working\/censo2010'):\n    os.makedirs('\/kaggle\/working\/censo2010')","ce409b15":"url_censo_2010_am = 'https:\/\/ftp.ibge.gov.br\/Censos\/Censo_Demografico_2010\/Resultados_do_Universo\/Agregados_por_Setores_Censitarios\/AM_20171016.zip'","e8aeb128":"%%time\n\nurlretrieve(url_censo_2010_am, '\/kaggle\/working\/censo2010\/AM_20171016.zip')","dd9e355a":"with zipfile.ZipFile('\/kaggle\/working\/censo2010\/AM_20171016.zip', 'r') as zip_ref:\n    zip_ref.extractall('\/kaggle\/working\/censo2010\/')","9b19c04b":"os.remove('\/kaggle\/working\/censo2010\/AM_20171016.zip')","31246cf3":"am_censo_entorno01_df = pd.read_csv('\/kaggle\/working\/censo2010\/AM\/Base informa\u00e7oes setores2010 universo AM\/CSV\/Entorno01_AM.csv', sep=';')","bf0f4dc1":"am_censo_entorno01_df.shape","430fa7e3":"am_censo_entorno01_df.head()","98f565ea":"am_censo_entorno01_df.dtypes","9230911b":"colunas = [\n    'V001', # Domic\u00edlios\n    'V008', 'V010', 'V012', # Ilumina\u00e7\u00e3o p\u00fablica\n    'V014', 'V016', 'V018', # Pavimenta\u00e7\u00e3o\n    'V020', 'V022', 'V024', # Cal\u00e7ada\n    'V038', 'V040', 'V042', # Rampa para cadeirante\n    'V044', 'V046', 'V048' # Arboriza\u00e7\u00e3o\n          ]  \nam_censo_entorno01_df[colunas] = am_censo_entorno01_df[colunas].replace('X', '0')","cf6d2fb9":"am_censo_entorno01_df[colunas] = am_censo_entorno01_df[colunas].astype(int, copy=False)","88613ba6":"am_censo_entorno01_df.dtypes","7b5bdf79":"am_gdf = am_censo_entorno01_df[['Cod_setor'] + colunas]\nam_gdf.head()","46517ccf":"%%capture\n\nam_gdf['ILUMINACAO'] = am_gdf.loc[:, 'V008':'V012'].sum(axis=1)\nam_gdf['PAVIMENTACAO'] = am_gdf.loc[:, 'V014':'V018'].sum(axis=1)\nam_gdf['CALCADA'] = am_gdf.loc[:, 'V020':'V024'].sum(axis=1)\nam_gdf['RAMPA_CADEIRANTE'] = am_gdf.loc[:, 'V038':'V042'].sum(axis=1)\nam_gdf['ARBORIZACAO'] = am_gdf.loc[:, 'V044':'V048'].sum(axis=1)","79e6917a":"am_gdf.head()","e352d621":"am_gdf = am_gdf.drop(columns=colunas[1:]).copy()\nam_gdf.head()","5a32704a":"am_gdf.columns = ['CD_GEOCODI', 'DOMICILIOS', 'ILUMINACAO', 'PAVIMENTACAO', 'CALCADA', 'RAMPA_CADEIRANTE', 'ARBORIZACAO']\nam_gdf.head()","7603c4ba":"%%capture\n\nmao_setores_urb_gdf['CD_GEOCODI'] = mao_setores_urb_gdf['CD_GEOCODI'].astype(int, copy=False)","95955e8c":"am_gdf = pd.merge(mao_setores_urb_gdf[['CD_GEOCODI', 'NM_BAIRRO', 'geometry']], am_gdf, on='CD_GEOCODI')\nam_gdf = am_gdf.dropna().copy()\nam_gdf.head()","468b7715":"am_gdf.shape","cc8bb722":"am_gdf.crs.to_string()","27f69a3b":"am_gdf = am_gdf.to_crs(crs='EPSG:4326')","a3875675":"am_gdf.crs.to_string()","edf78785":"am_gdf.head()","5a50c289":"coord_centro_manaus = [-3.1019400, -60.0250000]\nmapa_manaus = folium.Map(location=coord_centro_manaus, zoom_start=12)","39cff8ed":"mapa_manaus","3d04339d":"resolution, width, height = 100, 5, 5\n\nfor row in am_gdf.values:\n    setor_geo = folium.GeoJson(row[2])\n    \n    setor_geo_id = row[0]\n    setor_geo_bairro = row[1]\n    \n    html = '<h2>{}<\/h2>'.format('Setor Censit\u00e1rio: ' + str(setor_geo_id))\n    html += '<hr>'\n    html += '<p>{}<\/p>'.format('Bairro: ' + setor_geo_bairro)\n    html += '<hr>'\n    html += am_gdf[am_gdf['CD_GEOCODI'] == setor_geo_id][['DOMICILIOS', \n                                                          'ILUMINACAO', \n                                                          'PAVIMENTACAO']].to_html(index=False)\n    html += am_gdf[am_gdf['CD_GEOCODI'] == setor_geo_id][['CALCADA',\n                                                          'RAMPA_CADEIRANTE',\n                                                          'ARBORIZACAO']].to_html(index=False)\n    \n    iframe = folium.IFrame(html, width=(width*resolution)+20, height=(height*resolution)+20)\n    setor_geo.add_child(folium.Popup(iframe, max_width=2650))\n    \n    mapa_manaus.add_child(setor_geo)","a6c3b2d5":"mapa_manaus","463ff24f":"mapa_manaus.save('mapa_manaus_setores_censitarios.html')","3f0b1b1f":"am_gdf","ca207746":"coord_centro_manaus = [-3.1019400, -60.0250000]\nmapa_manaus = folium.Map(location=coord_centro_manaus, zoom_start=12)","2abd28a1":"folium.Choropleth(geo_data = am_gdf,\n                  name = 'Domic\u00edlios',\n                  data = am_gdf,\n                  columns = ['CD_GEOCODI', 'DOMICILIOS'],\n                  key_on = 'feature.properties.CD_GEOCODI',\n                  fill_color = 'RdGy',\n                  fill_opacity = 0.75,\n                  line_opacity = 0.75,\n                  legend_name = 'Domic\u00edlios').add_to(mapa_manaus)\n\nfolium.Choropleth(geo_data = am_gdf,\n                  name = 'Ilumina\u00e7\u00e3o P\u00fablica',\n                  data = am_gdf,\n                  columns = ['CD_GEOCODI', 'ILUMINACAO'],\n                  key_on = 'feature.properties.CD_GEOCODI',\n                  fill_color = 'RdGy',\n                  fill_opacity = 0.75,\n                  line_opacity = 0.75,\n                  legend_name = 'Ilumina\u00e7\u00e3o P\u00fablica').add_to(mapa_manaus)\n\nfolium.Choropleth(geo_data = am_gdf,\n                  name = 'Rampas para cadeirantes',\n                  data = am_gdf,\n                  columns = ['CD_GEOCODI', 'RAMPA_CADEIRANTE'],\n                  key_on = 'feature.properties.CD_GEOCODI',\n                  fill_color = 'RdGy',\n                  fill_opacity = 0.75,\n                  line_opacity = 0.75,\n                  legend_name = 'Rampas para cadeirantes').add_to(mapa_manaus)\n\nfolium.Choropleth(geo_data = am_gdf,\n                  name = 'Arboriza\u00e7\u00e3o',\n                  data = am_gdf,\n                  columns = ['CD_GEOCODI', 'ARBORIZACAO'],\n                  key_on = 'feature.properties.CD_GEOCODI',\n                  fill_color = 'RdGy',\n                  fill_opacity = 0.75,\n                  line_opacity = 0.75,\n                  legend_name = 'Arboriza\u00e7\u00e3o').add_to(mapa_manaus)\n\nfolium.LayerControl().add_to(mapa_manaus)","4369ebc1":"mapa_manaus.save('mapa_manaus_entorno.html')","1f0bf1b8":"### 2.2) Visualizando informa\u00e7\u00f5es de bairros","fa28a835":"### 1.2) Censo de 2010\n\n* Fonte: [Instituto Brasileiro de Geografia e Estat\u00edstica (IBGE)](https:\/\/www.ibge.gov.br\/geociencias\/downloads-geociencias.html)","36222c84":"![Arquivos da Base de Informa\u00e7\u00f5es por Setores Censit\u00e1rios.png](attachment:ba5691fd-ed95-4aea-8188-570a11fbd7a3.png)","78eaba36":"## 2) O que podemos extrair de informa\u00e7\u00f5es dos dados?","ce0da6a0":"# An\u00e1lise de dados do IBGE para a cidade de Manaus-AM\n\n## Resumo\n\nNeste notebook, iremos explorar dados do Censo de 2010 do IBGE utilizando a linguagem Python e as bibliotecas Folium e GeoPandas.","ab97e5bb":"### 2.1) Limpeza e transforma\u00e7\u00e3o de dados","554ead1a":"### 1.1) Setores censit\u00e1rios\n\n* Fonte: [Instituto Brasileiro de Geografia e Estat\u00edstica (IBGE)](https:\/\/www.ibge.gov.br\/geociencias\/organizacao-do-territorio\/malhas-territoriais\/26565-malhas-de-setores-censitarios-divisoes-intramunicipais.html?=&t=downloads)","d006fe7a":"### 2.3) Cria\u00e7\u00e3o de mapas coropl\u00e9ticos com os dados do IBGE","63d05d0b":"## 1) Fontes de dados"}}