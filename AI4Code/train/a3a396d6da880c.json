{"cell_type":{"17aa3cd8":"code","2e674627":"code","16866f9a":"code","99d8605d":"markdown","2f687900":"markdown","8af6d94f":"markdown","2299dc4b":"markdown","14aa6070":"markdown","e67c1c98":"markdown","c91cfb9a":"markdown","0094d23e":"markdown","d6878c9b":"markdown","2aca2097":"markdown","bedebd1e":"markdown"},"source":{"17aa3cd8":"!cp ..\/input\/fork-of-1-35-lightgbm-ann-2505f2-c4e96a\/* .","2e674627":"!ls","16866f9a":"!pip install pandarallel \n\nimport gc\n\nimport numpy as np\nimport pandas as pd\nfrom pathlib import Path\n\nfrom pandarallel import pandarallel\npandarallel.initialize()\n\nBASE_DIR = Path('..\/input\/mlb-player-digital-engagement-forecasting')\ntrain = pd.read_csv(BASE_DIR \/ 'train_updated.csv')\n\nnull = np.nan\ntrue = True\nfalse = False\n\nfor col in train.columns:\n\n    if col == 'date': continue\n\n    _index = train[col].notnull()\n    train.loc[_index, col] = train.loc[_index, col].parallel_apply(lambda x: eval(x))\n\n    outputs = []\n    for index, date, record in train.loc[_index, ['date', col]].itertuples():\n        _df = pd.DataFrame(record)\n        _df['index'] = index\n        _df['date'] = date\n        outputs.append(_df)\n\n    outputs = pd.concat(outputs).reset_index(drop=True)\n\n    outputs.to_csv(f'{col}_train.csv', index=False)\n    outputs.to_pickle(f'{col}_train.pkl')\n\n    del outputs\n    del train[col]\n    gc.collect()","99d8605d":"#### Thanks to: @lhagiimn   https:\/\/www.kaggle.com\/lhagiimn\/lightgbm-catboost-ann-2505f2\n\n#### https:\/\/www.kaggle.com\/columbia2131\/mlb-lightgbm-starter-dataset-code-en-ja\n\n#### https:\/\/www.kaggle.com\/mlconsult\/1-3816-lb-lbgm-descriptive-stats-param-tune\n\n#### https:\/\/www.kaggle.com\/batprem\/lightgbm-ann-weight-with-love\n\n#### https:\/\/www.kaggle.com\/mlconsult\/1-3816-lb-lbgm-descriptive-stats-param-tune\n\n#### https:\/\/www.kaggle.com\/ulrich07\/mlb-ann-with-lags-tf-keras\n","2f687900":"<div class=\"alert alert-success\">  \n<\/div>","8af6d94f":"<div class=\"alert alert-success\">  \n<\/div>","2299dc4b":"<div class=\"alert alert-success\">  \n<\/div>","14aa6070":"<div class=\"alert alert-success\">\n    <h1 align=\"center\">If you find this work useful, please don't forget upvoting :)<\/h1>\n<\/div>","e67c1c98":"## Training","c91cfb9a":"Train.csv is stored as a csv file with each column as follows.  \n\ntrain.csv\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u5404\u30ab\u30e9\u30e0\u3092csv\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u4fdd\u7ba1\u3057\u3066\u3044\u307e\u3059\u3002","0094d23e":"## Inference","d6878c9b":"<div class=\"alert alert-success\">  \n<\/div>","2aca2097":"## About Dataset","bedebd1e":"<div>\n    <h1 align=\"center\">MLB Player Digital Engagement Forecasting<\/h1>\n    <h1 align=\"center\">LightGBM + CatBoost + ANN 2505f2<\/h1>\n<\/div>"}}