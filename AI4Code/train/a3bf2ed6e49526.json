{"cell_type":{"30ba7348":"code","c36c6de4":"code","a1a24451":"code","e380b682":"code","c92d00fe":"code","38ea2f28":"code","31b72c20":"code","a68bd078":"code","6ba20f72":"code","83feb077":"code","b74d1555":"markdown","5d2b1037":"markdown","72fa89c1":"markdown","db028341":"markdown"},"source":{"30ba7348":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport collections\nimport cv2\nimport os\nfrom IPython.display import Image\nfrom IPython.display import display\nprint(os.listdir(\"..\/input\"))\nimport imagesize","c36c6de4":"train_df = pd.read_csv('..\/input\/train.csv')\ntrain_df.head()","a1a24451":"train_df.describe()","e380b682":"print(\"num_train=\", len(train_df))\nsns.distplot(train_df['diagnosis'], kde=False, rug=False, bins=None) ","c92d00fe":"test_df = pd.read_csv('..\/input\/test.csv')\ntest_df.head()","38ea2f28":"print(\"num_test=\", len(test_df))","31b72c20":"target_dirs = ['..\/input\/train_images', '..\/input\/test_images']\nfig, (ax1, ax2) = plt.subplots(2, 1, figsize=(20,20), sharex=True)\nfor target_dir, ax in zip(target_dirs, [ax1, ax2]):\n    # imagesize library doesn't read whole image, but metadata.\n    shapes = [[str(imagesize.get(\"{}\/{}\".format(target_dir, path)))] for path in os.listdir(target_dir)]\n\n    shapes_df = pd.DataFrame.from_records(shapes, columns=['image_size'])\n    shapes_df['image_size'] = pd.Categorical(shapes_df.image_size)\n    sns.countplot(shapes_df['image_size'], ax=ax).set_title(target_dir) \n    ","a68bd078":"def display_by_diagnosis(diagnosis):\n    target_class_df = train_df[train_df['diagnosis'] == diagnosis]\n\n    images = [Image(filename='..\/input\/train_images\/{}.png'.format(target_class_df.iloc[i].id_code), width=100, height=100) for i in range(0, 5)]\n    display(*images)    ","6ba20f72":"display_by_diagnosis(diagnosis=0)","83feb077":"display_by_diagnosis(diagnosis=4)","b74d1555":"### No DR","5d2b1037":"## Can you as human classify them?","72fa89c1":"### Proliferative DR","db028341":"## Image size distribution"}}