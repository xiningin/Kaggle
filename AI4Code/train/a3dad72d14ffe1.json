{"cell_type":{"30f9e6ff":"code","80443dfb":"code","c41a380e":"code","0a4fc3f3":"code","d3e76dac":"code","e7715b4f":"code","bc1893ab":"code","10e3576f":"code","3f662ac0":"code","b098ada4":"code","50e59068":"code","44911240":"code","45b688ec":"code","d435e3ad":"code","0dba1c5f":"code","fcbb3150":"code","11a4882a":"code","e537dd34":"code","3c6784f9":"code","37bde779":"code","90c8e40d":"code","723eeac6":"code","a5110714":"code","a7f7e955":"markdown","5bb141ca":"markdown","37c4ff24":"markdown","b2068751":"markdown","278ccdd5":"markdown","71ae6484":"markdown","32f52e6e":"markdown","18d44cec":"markdown","da7f34b4":"markdown","a633df27":"markdown","07001f87":"markdown","5114dee7":"markdown","fba230c8":"markdown","3b356bd9":"markdown","d63804d1":"markdown","504f7fb8":"markdown","73272630":"markdown","3760d43c":"markdown","08ad7ae4":"markdown","5ddce0ee":"markdown","26c70d03":"markdown","6f097ece":"markdown","36fc77e2":"markdown"},"source":{"30f9e6ff":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.\nimport matplotlib.pyplot as plt\nimport plotly.express as px\n%matplotlib inline","80443dfb":"calendar_df = pd.read_csv('..\/input\/m5-forecasting-accuracy\/calendar.csv', parse_dates=['date'], usecols=['date','d'])\n\n# udv\u00e6lger kun de datoer som ligger i sales_train_validation\n\ncalendar_stv = calendar_df[:1913] \ncalendar_stv.info()","c41a380e":"sales_train_validation = pd.read_csv('..\/input\/m5-forecasting-accuracy\/sales_train_validation.csv', index_col='id')\nsales_train_validation.head()","0a4fc3f3":"plt.style.use('ggplot')\nplt.rcParams['figure.figsize'] = [10, 5]\nax = sales_train_validation.groupby(['store_id'])['cat_id'].value_counts().plot(kind='bar', title=\"observationer i datas\u00e6t fordelt p\u00e5 store og kategory\")\nax.set_ylabel('# observationer')\nax.set_xlabel('Store - kategory')\n\nplt.show()","d3e76dac":"plt.style.use('ggplot')\nplt.rcParams['figure.figsize'] = [6, 2.5]\nax = sales_train_validation.groupby('state_id')['store_id'].nunique().plot(kind='bar', title=\"Butikker per stat\")\nax.set_ylabel('# butikker')\nax.set_xlabel('Stat')\nax.set_ylim(bottom=2)\nplt.yticks(np.arange(2,5,1))\n\nplt.show()","e7715b4f":"aggregate_state_sum = sales_train_validation.groupby(by=['state_id'],axis=0).sum()\naggregate_state_sum.columns = calendar_stv['date']\nagg_state_sum_trans = aggregate_state_sum.transpose()","bc1893ab":"from_year = '2015'\nplt.style.use('ggplot')\nplt.rcParams['figure.figsize'] = [20, 10]\nplt.rcParams['lines.linewidth'] = 2\nax = agg_state_sum_trans[from_year:].plot(title=\"Summeret salg per stat fra {}\".format(from_year))\nax.set_ylabel('Solgte enheder')\nplt.show()","10e3576f":"aggregate_state_mean = sales_train_validation.groupby(by=['state_id'],axis=0).mean()\naggregate_state_mean.columns = calendar_stv['date']\nagg_state_mean_trans = aggregate_state_mean.transpose()\nplt.style.use('ggplot')\nplt.rcParams['figure.figsize'] = [20, 10]\nplt.rcParams['lines.linewidth'] = 2\nax = agg_state_mean_trans['2015':].plot(title=\"Gennemsnitlig salg per stat\")\nax.set_ylabel('Solgte enheder')\nplt.show()","3f662ac0":"\naggregate_state_mean = sales_train_validation.groupby(by=['state_id', 'store_id'],axis=0).mean()\naggregate_state_mean.columns = calendar_stv['date']\nagg_state_mean_trans = aggregate_state_mean.transpose()\n\nplt.style.use('ggplot')\nplt.rcParams['figure.figsize'] = [25, 20]\nplt.rcParams['lines.linewidth'] = 2\nfig,ax = plt.subplots(3,1)\nfor i, state in enumerate(['CA','TX','WI'], start=0):\n    ax[i].plot(agg_state_mean_trans['2015':][state])\n    ax[i].set_title(\"Gennemsnitlig salg per butik i {}\".format(state))\n    ax[i].set_ylabel('Solgte enheder')\n    i = i+1\nplt.show()","b098ada4":"aggregate_state_category = sales_train_validation.groupby(by=['state_id', 'cat_id'],axis=0).sum()\n\naggregate_state_category.columns = calendar_stv['date']\n\nagg_state_trans = aggregate_state_category.transpose()\nfig,ax = plt.subplots(3,1)\nplt.style.use('ggplot')\nplt.rcParams['figure.figsize'] = [30, 25]\nplt.rcParams['lines.linewidth'] = 2\n#ax.legend()\nax[0].plot(agg_state_trans['CA']['2015':])\nax[0].set_title('CA')\nax[0].legend(('FOODS', 'HOBBIES', 'HOUSEHOLD'), loc='upper left')\nax[1].plot(agg_state_trans['TX']['2015':])\nax[1].set_title('TX')\nax[1].legend(('FOODS', 'HOBBIES', 'HOUSEHOLD'), loc='upper left')\nax[2].plot(agg_state_trans['WI']['2015':])\nax[2].set_title('WI')\nax[2].legend(('FOODS', 'HOBBIES', 'HOUSEHOLD'), loc='upper left')\nplt.show()\n","50e59068":"\ndef plot_state_category(sales_train_validation, calendar_dates, state, category='ALL', start_time='2015'):\n    sales_state_category = sales_train_validation.loc[sales_train_validation['state_id'] == state ]\n    if category != 'ALL' :\n        sales_state_category = sales_state_category.loc[sales_state_category['cat_id'] == category]\n    aggregate_ssc = sales_state_category.groupby(by=['dept_id'],axis=0).mean()\n\n    aggregate_ssc.columns = calendar_dates['date']\n\n    agg_ssc_trans = aggregate_ssc.transpose()\n    plt.style.use('ggplot')\n    plt.rcParams['figure.figsize'] = [25, 12]\n    plt.rcParams['lines.linewidth'] = 2\n    ax = agg_ssc_trans[start_time:].plot(title=\"MEANed numbers State: {}, Category: {}\".format(state, category))\n    ax.set_ylabel('Units sold')\n    plt.show()\n","44911240":"plot_state_category(sales_train_validation, calendar_stv, 'CA', category='FOODS', start_time='2013')","45b688ec":"plot_state_category(sales_train_validation, calendar_stv, 'TX', category='FOODS',start_time='2013')","d435e3ad":"plot_state_category(sales_train_validation, calendar_stv, 'WI', category='FOODS', start_time='2013')","0dba1c5f":"light_sales = sales_train_validation.drop(['item_id','dept_id','cat_id','store_id'], axis=1)\nlight_sales = light_sales.groupby('state_id').mean()\nlight_sales.columns = calendar_stv['date']\nlight_s_t = light_sales.transpose()","fcbb3150":"plt.style.use('ggplot')\nplt.rcParams['figure.figsize'] = [15, 10]\nfig, ax = plt.subplots(2,2)\nax[0][0].plot(light_s_t['20-12-2012':'31-12-2012'])\nax[0][0].set_title('2012')\nax[0][1].plot(light_s_t['20-12-2013':'31-12-2013'])\nax[0][1].set_title('2013')\nax[1][0].plot(light_s_t['20-12-2014':'31-12-2014'])\nax[1][0].set_title('2014')\nax[1][1].plot(light_s_t['20-12-2015':'31-12-2015'])\nax[1][1].set_title('2015')\nplt.show()","11a4882a":"sales_mean = sales_train_validation.mean()\nsales_mean.index = calendar_stv['date']\nsales_mean_trans = sales_mean.transpose()","e537dd34":"fig = px.scatter(sales_mean_trans, x=sales_mean_trans.index, y=sales_mean_trans.values, trendline='ols')\nfig.show()","3c6784f9":"store_dept = sales_train_validation.groupby(by= ['cat_id'], axis=0).mean()\nstore_dept.columns = calendar_stv['date']\nstore_trans = store_dept.transpose()","37bde779":"weekends = ['01-03-2015','01-04-2015','01-10-2015','01-11-2015','01-17-2015', '01-18-2015','01-24-2015', '01-25-2015', '01-31-2015', \n            '02-01-2015', '02-07-2015', '02-08-2015', '02-14-2015', '02-15-2015', '02-21-2015', '02-22-2015', '02-28-2015', \n            '03-01-2015', '03-07-2015', '03-08-2015', '03-14-2015', '03-15-2015', '03-21-2015', '03-22-2015', '03-28-2015',  '03-29-2015']","90c8e40d":"plt.style.use('ggplot')\nplt.rcParams['figure.figsize'] = [25, 5]\nax = store_trans['01-01-2015':'04-02-2015'].plot(title=\"Gns. salg 3 m\u00e5neder jan-mar 2015\")\nax.set_ylabel('# enheder')\nax.vlines(weekends, 0, 2.5, colors=['y','c'])\nplt.show()","723eeac6":"weekends= ['06-02-2012','06-02-2012','06-09-2012','06-10-2012', '06-16-2012','06-17-2012','06-23-2012', '06-24-2012', '06-30-2012', \n           '07-01-2012','07-07-2012','07-08-2012','07-14-2012', '07-15-2012','07-21-2012','07-22-2012', '07-28-2012', '07-29-2012', \n           '08-04-2012','08-05-2012','08-11-2012', '08-12-2012','08-18-2012','08-19-2012', '08-25-2012', '08-26-2012', '09-01-2012','09-02-2012'\n            ]\nplt.style.use('ggplot')\nplt.rcParams['figure.figsize'] = [25, 5]\nax = store_trans['06-01-2012':'09-02-2012'].plot(title=\"Gns. salg 3 m\u00e5neder jun-aug 2012\")\nax.set_ylabel('# enheder')\nax.vlines(weekends, 0, 2.5, colors=['y','c'])\nplt.show()","a5110714":"sales_train_validation.head(1)","a7f7e955":"Alle 3 stater f\u00f8lger samme m\u00f8ster:\n- st\u00f8rst salg af `Foods`\n- `Household` kommer p\u00e5 andenpladsen\n- `Hobbies` har mindst salg\n\nVare kategori kan have betydning for salg. Dette er dog ikke specielt overraskende, det virker logisk at der indk\u00f8bes flere varer i `FOODS`-kategorien, end i `HOUSEHOLD` og `HOBBIES`.","5bb141ca":"# **Salget p\u00e5 underkategorier **","37c4ff24":"# **Salget per butik i en stat**","b2068751":"# **Fordeling af varekategorier i de 3 stater**","278ccdd5":"Der er et lille opsving d. 3. juli (muligvis i forbindelse med 4. juli)\n\nMen ellers ser vi generelt samme tendens, nemlig at der indk\u00f8bes mere i weekenderne","71ae6484":"Som man kan ane p\u00e5 den bl\u00e5 linje, er der en opadg\u00e5ende tendens p\u00e5 gennemsnittet af alt salget.","32f52e6e":"# ** Hvad indeholder det?**\nog hvordan er data fordelt?","18d44cec":"Den 25. december hvert \u00e5r er der intet salg p\u00e5 nogen kategorier - Amerikanerne fejrer jul, butikkerne er formentlig lukkede.","da7f34b4":"I ovenst\u00e5ende graf vises det gennemsnitlige salg p\u00e5 kategorierne. Hver l\u00f8rdag\/s\u00f8ndan er markeret med en vertikal streg.\n- Gennemsnitssalget stiger typisk hver weekend. ","a633df27":"# ** Er der ugentlige udsving **","07001f87":"# **Trend**\nEr der en stigende eller faldende tendens i det samlede datas\u00e6t?","5114dee7":"## 25. december","fba230c8":"Sub kategorierne under foods ser ogs\u00e5 ud til at kunne vise nogle tendenser i antallet solgt under hver kategori.\n- Overkategorien `cat_id` virker pludselig overf\u00f8ldig - underkategorierne indeholde samme information og mere endnu","3b356bd9":"Der er 10 butikker, 3 vare kategorier med et ens antal varer i:\n- Foods, med 1437 varer\n- Household, med 1047 varer\n- Hobbies, med 565 varer\n\n30490 r\u00e6kker i datas\u00e6ttet svarer overens med:\n`antal_butikker * ( antal_varer_foods + antal_varer_household + antal_varer_hobbies )`","d63804d1":"# **Indl\u00e6s datoerne som datas\u00e6ttet er spredt ud over**\nDette er for senere at kunne omdanne d_1, d_2 osv til rigtige datoer.","504f7fb8":"Ved at unders\u00f8ge dataet er vi kommet frem til dette:\n- Store_id er en mere finmasket version af state_id, vi vil kunne fjerne state_id fra et tr\u00e6ningss\u00e6t da featuren er redundant\n- dept_id er en mere finmasket version af cat_id, vi vil kunne fjerne cat_id fra et tr\u00e6ningss\u00e6t, da featuren er redundant\n- datas\u00e6ttet har en stigende trend\n- Der er periodevise udsving i salget, der topper i weekenderne og er lavet midt p\u00e5 ugen.","73272630":"I CA er der is\u00e6r forskel p\u00e5 gns salget p\u00e5 butikkerne med st\u00f8rt og mindst salg. Det kan variere med ca 2 enheder. I de andre stater f\u00f8lges butikkerne mere ad, men der er stadig forskelle.\n- Det tyder p\u00e5 at 'store_id' m\u00e5ske kan indeholde nogle info vi kan bruge.\n- `store_id` i sig selv er betydningsl\u00f8st, men v\u00e6rdien kan m\u00e5ske indirekte sige noget om hvor stor et opland de enkelte butikker skal betjene.\n  - Hvis en butik har en stor befolkning i n\u00e6romr\u00e5det, er det oplagt at de folk benytter den butik.\n  - Men ved at kigge p\u00e5 `store_id` i sig selv, er det ikke noget vi kan afg\u00f8re.\n- `state_id` og `store_id` er to forskellige m\u00e5der at opg\u00f8re geografisk placering p\u00e5. `store_id` m\u00e5 antages at v\u00e6re mere pr\u00e6cist at bruge end `state_id`","3760d43c":"# **Opsamling p\u00e5 EDA**","08ad7ae4":"# **indl\u00e6s datas\u00e6ttet: sales_train_validation**","5ddce0ee":"# ** Det samlede salg per stat **","26c70d03":"`CA` s\u00e6lger flere enheder end de andre to stater. `TX` og `WI` f\u00f8lges nogenlunde ad.\n- Husk at staten `CA` har en butik mere end de andre!\n- Hvad sker der hvis man laver en graf med det gennemsnitlige salg?","6f097ece":"Der er ialt 10 butikker - staten `CA` har en butik mere end de andre to stater","36fc77e2":"N\u00e5r man kigger p\u00e5 salgsgennemsnittet f\u00f8lges de 3 stater mere ad, men `CA` er stadig umiddelbart f\u00f8rende.\n- M\u00e5ske er stat en faktor der kan hj\u00e6lpe n\u00e5r der skal tr\u00e6nes en model."}}