{"cell_type":{"8843e842":"code","e7841720":"code","58a82f8a":"code","fa5e15df":"code","0e8bf3db":"code","be703d90":"code","c8a8c869":"code","7d2d2f6d":"code","2be85aa1":"code","7ed6e26d":"code","8483c4ec":"code","40f915d5":"code","d372d15e":"code","d233fc86":"code","3a9b52d6":"code","6b598450":"code","1f75b2ca":"code","8cf1ec78":"code","671b24c1":"code","0e50ee85":"code","4357172c":"code","d95c76d9":"code","0d5db33b":"code","903584da":"code","a2f163ea":"code","6d7a0c3b":"code","2f633b3d":"markdown","46fc5e8c":"markdown","2ea13dd1":"markdown","7fa764db":"markdown","6f95232f":"markdown","56803abe":"markdown","e4b6059b":"markdown","2b3aa84f":"markdown","0f6076c7":"markdown","90f7e0ef":"markdown","910bbc9b":"markdown","ff6b5ed3":"markdown","518eed13":"markdown","5cfdb6ac":"markdown","23342b13":"markdown","0075f15d":"markdown","bd163562":"markdown","6f530b57":"markdown"},"source":{"8843e842":"from sklearn.cluster import KMeans\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.metrics import silhouette_score","e7841720":"df=pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\ndf.head()","58a82f8a":"df.shape","fa5e15df":"df.describe()","0e8bf3db":"df.rename(columns={'Spending Score (1-100)':'SpendingScore','Annual Income (k$)':'AnnualIncome'},inplace=True)\ndf.head()","be703d90":"sns.countplot(data=df,x='Gender',palette='Set2')","c8a8c869":"plt.figure(figsize=(15,10))\nplt.subplot(3,3,1)\nsns.distplot(df['Age'])\nplt.subplot(3,3,2)\nsns.distplot(df['AnnualIncome'],color='red')\nplt.subplot(3,3,3)\nsns.distplot(df['SpendingScore'],color='green')","7d2d2f6d":"sns.heatmap(df.iloc[:,1:5].corr(),annot=True,linewidths=0.2)","2be85aa1":"plt.figure(figsize=(10,7))\nsns.lineplot(x='AnnualIncome',y='SpendingScore',hue='Gender',data=df,ci=False,style='Gender',markers=True)","7ed6e26d":"plt.figure(figsize=(10,7))\nsns.lineplot(x='Age',y='SpendingScore',hue='Gender',data=df,ci=False,style='Gender',markers=True)","8483c4ec":"plt.figure(figsize=(20,10))\nx=0\nfor i in ['AnnualIncome','SpendingScore']:\n    x=x+1\n    plt.subplot(2,2,x)\n    sns.boxplot(data=df,x=i,y='Gender',palette='Set'+str(x))\nplt.show()","40f915d5":"lenc=LabelEncoder()\ndf['Gender']=lenc.fit_transform(df['Gender'])","d372d15e":"df.isna().sum()","d233fc86":"df.drop('CustomerID',axis=1,inplace=True)","3a9b52d6":"df.head()","6b598450":"cluster=list()\nfor i in range(1,11):\n    kmns=KMeans(n_clusters=i)\n    kmns.fit(df)\n    cluster.append(kmns.inertia_)\nplt.figure(figsize=(10,7))\nsns.lineplot(x=list(range(1,11)),y=cluster)","1f75b2ca":"n=3\nkmeans3=KMeans(n_clusters=n,n_init=10,max_iter=500)\nkmeans3.fit(df)","8cf1ec78":"df['clusters']=kmeans3.labels_\nkmeans3.cluster_centers_","671b24c1":"df.head()","0e50ee85":"print(silhouette_score(df.iloc[:,0:4],kmeans3.labels_))","4357172c":"plt.figure(figsize=(12, 8))\nsns.scatterplot(df['AnnualIncome'], df['SpendingScore'], hue=df['clusters'], palette='Set1',style=df['Gender'])","d95c76d9":"n=5\nkmeans5=KMeans(n_clusters=n,n_init=10,max_iter=500)\nkmeans5.fit(df)","0d5db33b":"df['clusters']=kmeans5.labels_\nkmeans5.cluster_centers_","903584da":"df.head()","a2f163ea":"print(silhouette_score(df.iloc[:,0:4],kmeans5.labels_))","6d7a0c3b":"plt.figure(figsize=(12, 8))\nsns.scatterplot(df['AnnualIncome'], df['SpendingScore'], hue=df['clusters'], palette='Set1',style=df['Gender'])","2f633b3d":"Now lets look at some basic details the dataset can tell us like the dimensions and count\/mean etc of the various features in the dataset. Also lets rename the 2 columns with long names into ones we can easily access.","46fc5e8c":"# 5 clusters","2ea13dd1":"# 3 clusters","7fa764db":"Now, a heatmap shows the two-dimensional graphical representation of data where the individual values that are contained in a matrix are represented as colors and the relation between each of them is shown in the matrix. It helps us analyze the relationship between different features in our dataset.","6f95232f":"In the plot below, we can clearly notice 3 clusters distinguished by color. Thus K-means has performed its job and assigned proper clusters to the data points.","56803abe":"# Visualization","e4b6059b":"The simple lineplot is created between 2 variables, with respect to gender.","2b3aa84f":"Plot some basic graphs with the help of matplotlib library and seaborn. \nThe countplot gives us an idea of how many examples are present in a given group in categorical data and here it is gender.","0f6076c7":"We notice 2 potential elbow points or \"bends\" i.e. one at approximately 3 and another at around 5. Thus we run K-means at both those points to form the requires clusters which we'll visualize eventually.","90f7e0ef":"# Unsupervised learning with K-Means for mall customer data segmentation.","910bbc9b":"The silhouette score is calculated using the mean intra-cluster distance and the mean nearest-cluster distance for each sample.The values of this score range from -1 to 1. Values almost equal to 0 indicate overlapping clusters. Values closer to 1 indicate the best possible clustering while negative values generally indicate that a sample has been assigned to the wrong cluster.","ff6b5ed3":"The next few steps are to check if all the values in the dataset are non-null and contain proper numerical values","518eed13":"We see and improvement in the silhouette score. Thus, plotting the clusters, we can distinguish the 5 groups.","5cfdb6ac":"Unsupervised learning refers to the machine learning algorithm that infers from data that is not labelled. It learns or studies the patterns in the data on it's own. K-means is a popular unsupervised learning algorithm that separates n observations into k clusters in which each observation belongs to the cluster with the nearest mean. Firstly, import all necessary modules.","23342b13":"A boxplot can also be used to visualize distributions.","0075f15d":"# K-Means","bd163562":"First, lets check the elbow curve for different number of clusters using a forloop to append the values of inertia of the K-means algorithm into a list and plotting them for a range of 1-10 clusters.\nK-Means algorithm clusters data by trying to separate samples in n groups of equal variance, minimizing a criterion known as the inertia or within-cluster sum-of-squares. Inertia tells us how far away the points within a cluster are.\nThe value of inertia decreases as the number of clusters increase. \nThe elbow point is the point in the graph when we notice a bend in the curve.","6f530b57":"Now lets look at the distplot(histogram) which gives the range of the different features;age, income and the spending score"}}