{"cell_type":{"33d94842":"code","555b160b":"code","c04f598b":"code","07236817":"code","626319e3":"code","a835f6c2":"code","1f3a8356":"code","b5d809d3":"code","a5d11128":"markdown","54e47a4d":"markdown","041e29cf":"markdown","92f479eb":"markdown"},"source":{"33d94842":"import numpy as np\nimport pandas as pd\nimport ijson\nfrom pandas.io.json import json_normalize","555b160b":"%%bash\n# we can use %%bash magic to print a preview of our file\n\nhead ..\/input\/roam_prescription_based_prediction.jsonl","c04f598b":"# read in data\nraw_data = pd.read_json(\"..\/input\/roam_prescription_based_prediction.jsonl\",\n                        lines=True,\n                        orient='columns')\nprint(raw_data.shape)\nraw_data.head()","07236817":"%time provider = pd.DataFrame([md for md in raw_data.provider_variables])\nprovider.head()","626319e3":"# add npi as index\nprovider['npi'] = raw_data.npi\nprovider.set_index('npi', inplace=True)\nprovider.head()","a835f6c2":"%time provider = json_normalize(data=raw_data.provider_variables)\nprovider.head()","1f3a8356":"%time rx_counts = pd.DataFrame([rx for rx in raw_data.cms_prescription_counts])","b5d809d3":"print(rx_counts.shape)\nrx_counts.head()","a5d11128":"We can see from above that we have nested values inside our cells.  There are several options for extracting these values.  In this kernel we will explore using list comprehensions and json_normalize.\n\n## Extract Prescriber Data\n### List Comprehension","54e47a4d":"# Working with JSON files in Python\nWorking with JSON files isn't the most fun.  While pandas has the read_json method that is useful for reading the .json file into a dataframe, we are often left with lists or dictionaries inside of columns.  Since nested column values aren't really helpful for analzying data, we'll explore some methods for unpacking the json and creating clean and orderly dataframes.","041e29cf":"### JSON Normalize","92f479eb":"## Extract Rx Data\n### List Comprehension"}}