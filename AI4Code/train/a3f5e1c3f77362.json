{"cell_type":{"a78d20a4":"code","d4af7a60":"code","340a23a4":"code","99f59f93":"code","b6af1d10":"code","4b6588ad":"code","88191257":"code","2fbaf853":"code","dc2716ff":"code","436e4e33":"code","2d981241":"code","a36f7c7b":"code","2c78244a":"code","3c56ce6d":"code","89b1f5b0":"code","20783afc":"code","5800719a":"code","e2069f42":"code","100db68c":"code","9b321d78":"code","8ae67aab":"code","fce72adb":"code","c067e167":"code","ddb22316":"code","af086ab9":"code","aac03330":"code","23458129":"code","ab586962":"code","b259d86b":"code","ca847e34":"code","d0c7df94":"code","73c5106d":"code","ce6c619a":"code","d7bf56e1":"code","d98719b3":"code","8d9fb0d3":"code","74da8b05":"code","38f1bfbd":"code","f3d22a4d":"code","3fc4c53a":"code","e58cb06d":"code","d9d35a4f":"code","1fb508f0":"code","fef3efa0":"code","96a64188":"code","22431802":"code","6841f018":"code","45ee459d":"code","b60fd31d":"code","305fac76":"code","84be4b77":"code","8f9cafd8":"code","5542f8b2":"code","d63028a5":"code","03706a08":"code","eb6a8872":"code","f3ce33d2":"code","6798bf68":"code","6292e004":"code","b0290dcb":"code","cad64aa3":"code","341f5e0a":"code","0e58e15a":"code","74c6f353":"code","b6ad589d":"code","91cff925":"code","211f931f":"code","8bbce3bd":"code","49680d0a":"code","30580ff5":"code","f4d32241":"code","0695db27":"code","ba279edd":"code","f6fb8a2e":"code","7fdd7e6c":"code","e23bf146":"code","65663669":"code","dec9f8c3":"code","f4ce1ee6":"code","8cb12bde":"code","198b5b02":"code","9214b425":"code","11bb68b6":"code","5eaec2d0":"code","4db2ac45":"code","d42cbb4e":"code","b9ea9efc":"code","dd3c920d":"code","a4025f42":"code","4cc25b4a":"code","15690f8b":"code","41f46c60":"code","587f5ee6":"code","cadc5cf7":"code","d069f63d":"code","0d3d9a8c":"code","5901cffe":"code","79b7345f":"code","4d253d47":"code","d5aa1118":"code","aa3d33e0":"code","c656dace":"code","4b85abc1":"code","95ee3a3f":"code","f9b0164f":"code","8cd2162a":"code","cd893769":"code","e97bf282":"code","3b477227":"code","29f8fa95":"code","96ad391d":"code","31b656b9":"code","73645989":"code","eb766e12":"code","e56bd34e":"code","7211c58f":"code","db31d108":"code","ea5a1cfe":"code","588cd59a":"code","d19795db":"markdown","3b6e571e":"markdown","67d1905a":"markdown","7e4fea9c":"markdown","da301bf2":"markdown","14abd866":"markdown","ea56ae06":"markdown","8f870387":"markdown","32dc74cc":"markdown","f105b8f8":"markdown","aa7ce691":"markdown","014866f2":"markdown","4a27be57":"markdown","85dd6039":"markdown","e26fbe49":"markdown","ac755b82":"markdown","a1dd12d6":"markdown","8f5c4230":"markdown","1bda4cc3":"markdown","420c914b":"markdown","9832b565":"markdown","d9f279aa":"markdown","28c17a05":"markdown","4dab3984":"markdown","a90c7500":"markdown","d5078bd0":"markdown","887a1f1e":"markdown","24c5a8ae":"markdown","9788ba04":"markdown","aaca6d32":"markdown","8c9922b4":"markdown","b4ae948b":"markdown","58e57dbc":"markdown","eabd4088":"markdown","410f4d45":"markdown","a121ffcc":"markdown","cb070689":"markdown","b10c48ac":"markdown","156a3d05":"markdown"},"source":{"a78d20a4":"import os\nfrom datetime import datetime as dt\nimport numpy as np\nimport pandas as pd\nimport math\nimport sys\nimport random as rn\n\nimport tensorflow as tf\nfrom tensorflow.keras.applications.xception import Xception\nfrom tensorflow.keras import Sequential as S\nfrom tensorflow.keras.layers import *\nfrom tensorflow.keras import optimizers\nfrom tensorflow.keras.regularizers import l2\nfrom tensorflow.keras.applications import EfficientNetB0, EfficientNetB3\nfrom keras import backend as K\n\nprint('Python       :', sys.version.split('\\n')[0])\nprint('Numpy        :', np.__version__)\nprint('Tensorflow   :', tf.__version__)\nprint('Keras        :', tf.keras.__version__)","d4af7a60":"import utils_module09122020 as utils","340a23a4":"# CURRENT_DIR = '.\/'  # \u0438\u043c\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0434\u043b\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b \nCURRENT_DIR = '..\/'  # \u0438\u043c\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0434\u043b\u044f \u043a\u0430\u0433\u0433\u043b\n\n# \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u0443\u0442\u0438 \u0432 \u043f\u0430\u043f\u043a\u0435 input \u0434\u043b\u044f \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0439 \u043a\u043e\u043d\u0441\u0442\u0430\u043d\u0442\u044b PATH_TO_FILE\nprint(os.listdir(CURRENT_DIR+'input\/'))","99f59f93":"PATH_to_FILE = CURRENT_DIR+'input\/sf-dl-car-classification\/'  # \u0438\u043c\u044f \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0441 \u0438\u0441\u0445\u043e\u0434\u043d\u044b\u043c\u0438 \u0444\u0430\u0439\u043b\u0430\u043c\u0438\nPATH_to_WORKDIR = CURRENT_DIR+'working\/'  # \u0438\u043c\u044f \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438\nPATH_to_FILE_RESULT = '..\/input\/last-result\/last_result.csv'\nPATH_to_FILE_descr = '..\/input\/last-result\/descr_result.pkl'\n\nRANDOM_SEED = 42  # \u0444\u0438\u043a\u0441\u0438\u0440\u0443\u0435\u043c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u0430 \u043f\u0441\u0435\u0432\u0434\u043e-\u0441\u043b\u0443\u0447\u0430\u0439\u043d\u044b\u0445 \u0447\u0438\u0441\u0435\u043b \u0434\u043b\u044f \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\nnp.random.seed(RANDOM_SEED)\nos.environ['PYTHONHASHSEED'] = '0'\nrn.seed(RANDOM_SEED)\n\n!pip3 freeze > requirements.txt  # \u0444\u0438\u043a\u0441\u0438\u0440\u0443\u0435\u043c \u0432\u0435\u0440\u0441\u0438\u0438 \u0432\u0441\u0435\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0434\u043b\u044f \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\n\nCURRENT_DATE = dt.now().strftime('[%d.%m.%Y]')  # \u0444\u0438\u043a\u0441\u0438\u0440\u0443\u0435\u043c \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u0434\u0430\u0442\u0443 \u0434\u043b\u044f \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044f \u0432\u0435\u0440\u0441\u0438\u0439 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u043e\u0432","b6af1d10":"# \u0443\u0442\u0438\u043b\u0438\u0442\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 GPU\nutils.check_GPU_ON()","4b6588ad":"df_train = pd.read_csv(PATH_to_FILE + 'train.csv')\ndf_submit = pd.read_csv(PATH_to_FILE + 'sample-submission.csv')","88191257":"# \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0432 \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u043f\u0430\u043f\u043a\u0435 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u0439 \u043f\u0430\u043f\u043a\u0438 \u0434\u043b\u044f \u0440\u0430\u0437\u044a\u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u0430\u0432\u0442\u043e\nPATH_to_IMAGES = utils.mkdir(PATH_to_WORKDIR, 'images_of_car')","2fbaf853":"utils.unzip(PATH_to_FILE, \n            PATH_to_IMAGES, \n            ['train.zip', 'test.zip'], \n            '\u0441 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0430\u043c\u0438 \u0430\u0432\u0442\u043e')","dc2716ff":"# \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043d\u0441\u0442\u0430\u043d\u0442\u044b \u0434\u043b\u044f \u043f\u0443\u0442\u0435\u0439 \u043a \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u044b\u043c \u0438 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u043c \u0444\u043e\u0442\u043e\nPATH_to_IMAGES_TRAIN = PATH_to_IMAGES + 'train\/'\nPATH_to_IMAGES_TEST = PATH_to_IMAGES + 'test_upload\/'","436e4e33":"df_train.head()","2d981241":"print('\u041a\u0440\u0430\u0442\u043a\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u043c \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435')\nutils.describe_without_plots_all_collumns(df_train, \n                                          short=True)","a36f7c7b":"print('\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043a\u0430\u043a\u0438\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u044b:')\ndf_train.Category.unique()","2c78244a":"utils.simple_plot_barv('\u0420\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043a\u043e\u043b-\u0432\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a (\u0441 % \u043e\u0442\u043a\u043b. \u043e\u0442 \u0441\u0440\u0435\u0434\u043d\u0435\u0433\u043e)', \n                       'Category', \n                       df_train, \n                       1.3, \n                       '\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f', \n                       '\u041a\u043e\u043b-\u0432\u043e \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u0432 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u0430\u0432\u0442\u043e')","3c56ce6d":"df_submit.head()","89b1f5b0":"print('\u041a\u0440\u0430\u0442\u043a\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435 \u0441 \u0448\u0430\u0431\u043b\u043e\u043d\u043e\u043c \u0441\u0430\u0431\u043c\u0438\u0448\u0435\u043d\u0430')\nutils.describe_without_plots_all_collumns(df_submit, \n                                          short=True)","20783afc":"utils.images_from_dataset_with_path('\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u043f\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f\u043c (\u0441\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043f\u043e \u043a\u0430\u0442.)', \n                                    '\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f:',\n                                    PATH_to_IMAGES_TRAIN, \n                                    df_train, \n                                    'Category', \n                                    range(10), \n                                    'Id', \n                                    RANDOM_SEED, \n                                    True)","5800719a":"utils.images_from_dataset_with_path('\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u043f\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 = 0 (\u0441\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043f\u043e \u043a\u0430\u0442.)', \n                                    '',\n                                    PATH_to_IMAGES_TRAIN, \n                                    df_train, \n                                    'Category', \n                                    np.zeros(10, dtype=int), \n                                    'Id', \n                                    RANDOM_SEED+2, \n                                    False)","e2069f42":"utils.images_from_dataset_with_path('\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u043f\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 = 1 (\u0441\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043f\u043e \u043a\u0430\u0442.)', \n                                    '',\n                                    PATH_to_IMAGES_TRAIN, \n                                    df_train, \n                                    'Category', \n                                    np.ones(10, dtype=int), \n                                    'Id', \n                                    RANDOM_SEED, \n                                    False)","100db68c":"utils.images_from_dataset_with_path('\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u043f\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 = 2 (\u0441\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043f\u043e \u043a\u0430\u0442.)', \n                                    '',\n                                    PATH_to_IMAGES_TRAIN, \n                                    df_train, \n                                    'Category', \n                                    np.ones(10, dtype=int)*2, \n                                    'Id', \n                                    RANDOM_SEED, \n                                    False)","9b321d78":"utils.images_from_dataset_with_path('\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u043f\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 = 3 (\u0441\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043f\u043e \u043a\u0430\u0442.)', \n                                    '',\n                                    PATH_to_IMAGES_TRAIN, \n                                    df_train, \n                                    'Category', \n                                    np.ones(10, dtype=int)*3, \n                                    'Id', \n                                    RANDOM_SEED+1, \n                                    False)","8ae67aab":"utils.images_from_dataset_with_path('\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u043f\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 = 4 (\u0441\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043f\u043e \u043a\u0430\u0442.)', \n                                    '',\n                                    PATH_to_IMAGES_TRAIN, \n                                    df_train, \n                                    'Category', \n                                    np.ones(10, dtype=int)*4, \n                                    'Id', \n                                    RANDOM_SEED, \n                                    False)","fce72adb":"utils.images_from_dataset_with_path('\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u043f\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 = 5 (\u0441\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043f\u043e \u043a\u0430\u0442.)', \n                                    '',\n                                    PATH_to_IMAGES_TRAIN, \n                                    df_train, \n                                    'Category', \n                                    np.ones(10, dtype=int)*5, \n                                    'Id', \n                                    RANDOM_SEED, \n                                    False)","c067e167":"utils.images_from_dataset_with_path('\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u043f\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 = 6 (\u0441\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043f\u043e \u043a\u0430\u0442.)', \n                                    '',\n                                    PATH_to_IMAGES_TRAIN, \n                                    df_train, \n                                    'Category', \n                                    np.ones(10, dtype=int)*6, \n                                    'Id', \n                                    RANDOM_SEED, \n                                    False)","ddb22316":"utils.images_from_dataset_with_path('\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u043f\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 = 7 (\u0441\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043f\u043e \u043a\u0430\u0442.)', \n                                    '',\n                                    PATH_to_IMAGES_TRAIN, \n                                    df_train, \n                                    'Category', \n                                    np.ones(10, dtype=int)*7, \n                                    'Id', \n                                    RANDOM_SEED, \n                                    False)","af086ab9":"utils.images_from_dataset_with_path('\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u043f\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 = 8 (\u0441\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043f\u043e \u043a\u0430\u0442.)', \n                                    '',\n                                    PATH_to_IMAGES_TRAIN, \n                                    df_train, \n                                    'Category', \n                                    np.ones(10, dtype=int)*8, \n                                    'Id', \n                                    RANDOM_SEED, \n                                    False)","aac03330":"utils.images_from_dataset_with_path('\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u043f\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 = 9 (\u0441\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043f\u043e \u043a\u0430\u0442.)', \n                                    '',\n                                    PATH_to_IMAGES_TRAIN, \n                                    df_train, \n                                    'Category', \n                                    np.ones(10, dtype=int)*9, \n                                    'Id', \n                                    RANDOM_SEED, \n                                    False)","23458129":"results_of_exp = pd.DataFrame()  # \u0434\u0430\u0442\u0430\u0444\u0440\u0435\u0439\u043c \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u043e\u0432\ndescr_hyperp_of_exp = {}  # \u0441\u043b\u043e\u0432\u0430\u0440\u044c \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432\n\n# \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0445 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u043e\u0432 \u0432 \u0434\u0430\u0442\u0430\u0441\u0435\u0442, \n# \u0432 \u0441\u043b\u043e\u0432\u0430\u0440\u044c \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u0442\u043e\u0432\n# \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u043d\u043e\u0432\u044b\u0439 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\nNUM_EXP, \\\nresults_of_exp, \\\ndescr_hyperp_of_exp = utils.load_result_last_cnn_fit(PATH_to_FILE_RESULT, \n                                                     PATH_to_FILE_descr)\n\n# \u0421\u0442\u0440\u043e\u043a\u0430 \u043d\u0438\u0436\u0435 \u0437\u0430\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0430, \u0442\u0430\u043a \u043a\u0430\u043a \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u043f\u0435\u0440\u0432\u044b\u0439 \u0437\u0430\u043f\u0443\u0441\u043a \u043d\u043e\u0443\u0442\u0431\u0443\u043a\u0430, \n# \u043a\u043e\u0433\u0434\u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u043e\u0432 \u043d\u0435\u0442\n# NUM_EXP = utils.hyperp('NUM_EXP',1,'\u041d\u043e\u043c\u0435\u0440 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430',results_of_exp,descr_hyperp_of_exp)  # \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0432\u0441\u0435\u0445 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0447\u0435\u0440\u0435\u0437 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u043c\u0435\u0442\u043e\u0434","ab586962":"print('\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0434\u043b\u044f \u0410\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u0444\u043e\u0442\u043e:')\nAUG_ROTATION_RANGE = utils.hyperp('AUG_ROTATION_RANGE', \n                                  5, \n                                  '\u0410\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f. \u0414\u0438\u0430\u043f\u0430\u0437\u043e\u043d \u0434\u043b\u044f \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u044b\u0445 \u043f\u043e\u0432\u043e\u0440\u043e\u0442\u043e\u0432 \u0432 \u0433\u0440\u0430\u0434\u0443\u0441\u0430\u0445',\n                                  results_of_exp,\n                                  descr_hyperp_of_exp)\nAUG_BRIGHTNES_RANGE = utils.hyperp('AUG_BRIGHTNES_RANGE', \n                                   [0.5, 1.5], \n                                   '\u0410\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f. \u0414\u0438\u0430\u043f\u0430\u0437\u043e\u043d \u0432\u044b\u0431\u043e\u0440\u0430 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0441\u0434\u0432\u0438\u0433\u0430 \u044f\u0440\u043a\u043e\u0441\u0442\u0438',\n                                   results_of_exp,\n                                   descr_hyperp_of_exp)\nAUG_WIDTH_SHIFT_RANGE = utils.hyperp('AUG_WIDTH_SHIFT_RANGE', \n                                     0.1, \n                                     '\u0410\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f. \u0414\u0438\u0430\u043f\u0430\u0437\u043e\u043d \u0432\u044b\u0431\u043e\u0440\u0430 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0441\u0434\u0432\u0438\u0433\u0430 \u0448\u0438\u0440\u0438\u043d\u044b',\n                                     results_of_exp,\n                                     descr_hyperp_of_exp)\nAUG_HEIGHT_SHIFT_RANGE = utils.hyperp('AUG_HEIGHT_SHIFT_RANGE', \n                                      0.1, \n                                      '\u0410\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f. \u0414\u0438\u0430\u043f\u0430\u0437\u043e\u043d \u0432\u044b\u0431\u043e\u0440\u0430 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0441\u0434\u0432\u0438\u0433\u0430 \u0432\u044b\u0441\u043e\u0442\u044b',\n                                      results_of_exp,\n                                      descr_hyperp_of_exp)\nAUG_HORIZONTAL_FLIP = utils.hyperp('AUG_HORIZONTAL_FLIP', \n                                   True, \n                                   '\u0410\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f. \u041b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u043e\u0433\u043e  \u043f\u0435\u0440\u0435\u0432\u043e\u0440\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u044f \u043f\u043e \u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u0438',\n                                   results_of_exp,\n                                   descr_hyperp_of_exp)\nAUG_RESCALE = utils.hyperp('AUG_RESCALE', \n                           1. \/ 255, \n                           '\u0410\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f. \u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442 \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. \u041c\u044b \u0443\u043c\u043d\u043e\u0436\u0430\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u044d\u0442\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 (\u043f\u043e\u0441\u043b\u0435 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432\u0441\u0435\u0445 \u0434\u0440\u0443\u0433\u0438\u0445 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0439)',\n                           results_of_exp,\n                           descr_hyperp_of_exp)\nAUG_VAL_SPLIT = utils.hyperp('AUG_VAL_SPLIT', \n                             0.15, \n                             '\u0410\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f. \u0414\u043e\u043b\u044f \u0432\u044b\u0431\u043e\u0440\u043a\u0438 \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c\u043e\u0439 \u0434\u043b\u044f \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438 \u0432\u043d\u0435 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0438',\n                             results_of_exp,\n                             descr_hyperp_of_exp)\nAUG_IMG_SIZE = utils.hyperp('AUG_IMG_SIZE', \n                            224, '\u0410\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f. \u0420\u0430\u0437\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u0431\u0443\u0434\u0435\u043c \u043f\u043e\u0434\u0430\u0432\u0430\u0442\u044c \u0432 \u043d\u0435\u0439\u0440\u043e\u0441\u0435\u0442\u044c',\n                            results_of_exp,\n                            descr_hyperp_of_exp)\nAUG_BATCH_SIZE = utils.hyperp('AUG_BATCH_SIZE', \n                              64, \n                              '\u0410\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f. \u0420\u0430\u0437\u043c\u0435\u0440 Batch',\n                              results_of_exp,\n                              descr_hyperp_of_exp)","b259d86b":"print('\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043a\u043e\u043d\u0441\u0442\u0430\u043d\u0442\u044b \u0442\u0438\u043f\u0430 \u0410\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438')\nAUG_TYPE = utils.hyperp('AUG_TYPE', \n                        'ImageDataGenerator', \n                        '\u0410\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f. \u0422\u0438\u043f',\n                        results_of_exp,\n                        descr_hyperp_of_exp)","ca847e34":"# \u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445\ntrain_generator, \\\nvalid_generator, \\\ntest_generator = utils.train_valid_test_generators(\n                    AUG_ROTATION_RANGE,           \n                    AUG_BRIGHTNES_RANGE,\n                    AUG_WIDTH_SHIFT_RANGE, \n                    AUG_HEIGHT_SHIFT_RANGE,\n                    AUG_HORIZONTAL_FLIP,\n                    AUG_RESCALE,\n                    AUG_VAL_SPLIT,\n                    PATH_to_IMAGES_TRAIN,\n                    PATH_to_IMAGES_TEST,\n                    df_submit,\n                    AUG_IMG_SIZE,\n                    AUG_BATCH_SIZE,\n                    RANDOM_SEED)","d0c7df94":"print('\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043a\u043e\u043d\u0441\u0442\u0430\u043d\u0442\u044b \u0442\u0438\u043f\u0430 \u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438')\nM_BASE_TYPE = utils.hyperp('M_BASE_TYPE', \n                           'Xception', \n                           '\u041c\u043e\u0434\u0435\u043b\u044c. \u0422\u0438\u043f \u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438',\n                           results_of_exp,\n                           descr_hyperp_of_exp)","73c5106d":"# \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043f\u0435\u0440\u0435\u043d\u043e\u0441 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f (Transfer learning)\n# \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043f\u0440\u0435\u0434\u043e\u0431\u0443\u0447\u0435\u043d\u043d\u0443\u044e \u0431\u0430\u0437\u043e\u0432\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c Xception \u0431\u0435\u0437 \u0433\u043e\u043b\u043e\u0432\u044b \u0442\u0430\u043a \u043a\u0430\u043a \u0431\u0443\u0434\u0435\u043c \u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0441\u0432\u043e\u044e\nbase_model = Xception(\n                    weights='imagenet', \n                    include_top=False, \n                    input_shape = (AUG_IMG_SIZE, AUG_IMG_SIZE, 3))","ce6c619a":"print('\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043a\u043e\u043d\u0441\u0442\u0430\u043d\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b \u0433\u043e\u043b\u043e\u0432\u044b \u0438 \u043a\u043e\u043c\u043f\u0438\u043b\u044f\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438') \nH_DROPOUT_RATE =  utils.hyperp('H_DROPOUT_RATE', \n                               0.25, \n                               '\u0413\u043e\u043b\u043e\u0432\u0430 \u043c\u043e\u0434\u0435\u043b\u0438. \u0412\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043d\u0435\u0439\u0440\u043e\u043d\u043e\u0432 \u0432 \u0441\u043b\u043e\u0435 Dropout',\n                               results_of_exp,\n                               descr_hyperp_of_exp)\nH_USE_BIAS =  utils.hyperp('H_USE_BIAS', \n                           'Default', \n                           '\u0413\u043e\u043b\u043e\u0432\u0430 \u043c\u043e\u0434\u0435\u043b\u0438. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u044d\u0444 \u0411\u0430\u0439\u0435\u0441 \u0432 \u043f\u043e\u043b\u043d\u043e\u0441\u0432\u044f\u0437\u043d\u043e\u043c \u0441\u043b\u043e\u0435',\n                           results_of_exp,\n                           descr_hyperp_of_exp)\nH_KERNEL_REG = utils.hyperp('H_KERNEL_REG', \n                            'Default', \n                            '\u0413\u043e\u043b\u043e\u0432\u0430 \u043c\u043e\u0434\u0435\u043b\u0438. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u043e\u0439 \u0440\u0435\u0433\u0443\u043b\u044f\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u0432 \u043f\u043e\u043b\u043d\u043e\u0441\u0432\u044f\u0437\u043d\u043e\u043c \u0441\u043b\u043e\u0435',\n                            results_of_exp,\n                            descr_hyperp_of_exp)\nH_BATCHNORM =  utils.hyperp('H_BATCHNORM', \n                            False, \n                            '\u0413\u043e\u043b\u043e\u0432\u0430 \u043c\u043e\u0434\u0435\u043b\u0438. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 BatchNormalization' ,\n                            results_of_exp,\n                            descr_hyperp_of_exp)\n\nC_LR = utils.hyperp('C_LR', \n                    1e-4, \n                    '\u041a\u043e\u043c\u043f\u0438\u043b\u044f\u0446\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438. \u0428\u0430\u0433 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438',\n                    results_of_exp,\n                    descr_hyperp_of_exp)\n\u0421_OPTIMIZER_TYPE = utils.hyperp('\u0421_OPTIMIZER_TYPE', \n                                'Adam', \n                                '\u041a\u043e\u043c\u043f\u0438\u043b\u044f\u0446\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438. \u0422\u0438\u043f \u043e\u043f\u0442\u0438\u043c\u0430\u0439\u0437\u0435\u0440\u0430',\n                                results_of_exp,\n                                descr_hyperp_of_exp)\nC_LOSS_TYPE = utils.hyperp('C_LOSS_TYPE', \n                           'categorical_crossentropy', \n                           '\u041a\u043e\u043c\u043f\u0438\u043b\u044f\u0446\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438. \u0422\u0438\u043f \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0442\u0435\u0440\u044c (loss-\u0444\u0443\u043d\u043a\u0446\u0438\u0438)',\n                           results_of_exp,\n                           descr_hyperp_of_exp)","d7bf56e1":"# \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u0433\u043e\u043b\u043e\u0432\u044b (\u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0441\u043b\u043e\u0438 \u043f\u043e\u0432\u0435\u0440\u0445 \u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438)\nhead = S([GlobalAveragePooling2D(), \n          Dense(256,activation='relu'),\n          Dropout(H_DROPOUT_RATE),\n          Dense(10, activation='softmax')])\n# \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u0442\u0443\u0442 \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u0442\u0441\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 baseline \n# \u0442\u043e\u043b\u044c\u043a\u043e \u0431\u0435\u0437 \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f\n\n\n# \u0421\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043f\u043e\u0434\u0445\u043e\u0434 \u043f\u0435\u0440\u0435\u043d\u043e\u0441 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f (Transfer learning)\nmodel = utils.model_assembler(base_model, head)\n\n# \u041a\u043e\u043c\u043f\u0438\u043b\u0438\u0440\u0443\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c\nmodel.compile(loss=C_LOSS_TYPE, \n              optimizer=optimizers.Adam(lr=C_LR), \n              metrics=['accuracy'])","d98719b3":"# \u0432\u044b\u0432\u043e\u0434\u0438\u043c \u043a\u0440\u0430\u0442\u043a\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043c\u043e\u0434\u0435\u043b\u0435\n# \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u043e\u0435 \u0441\u0430\u043c\u043c\u0430\u0440\u0438 \u043e\u0447\u0435\u043d\u044c \u0433\u0440\u043e\u043c\u043e\u0437\u0434\u043a\u0430\u044f \u043f\u043e\u0440\u0442\u044f\u043d\u043a\u0430 \u0432\u043d\u0438\u0437 \u0438 \u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0435\u0435 \u0443\u0442\u043e\u043c\u0438\u0442\u0435\u043b\u044c\u043d\u043e\n# \u044f \u043d\u0430\u0448\u0435\u043b \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u043e\u0432 \u043d\u0435\u0439\u0440\u043e\u0441\u0435\u0442\u0435\u0439 \u0441 \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u043f\u043e\u043b\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0435\u0439 \u043e \u0441\u043b\u043e\u044f\u0445 \u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u044f\u0445\n# \u043d\u043e \u043e\u043d\u0438 \u043d\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u044e\u0442\u0441\u044f \u0432 \u043a\u0430\u0433\u0433\u043b\n# \u0435\u0441\u043b\u0438 \u0432\u044b \u0437\u043d\u0430\u0435\u0442\u0435 \u0443\u0434\u043e\u0431\u043d\u044b\u0435 \u0441\u043f\u043e\u0441\u043e\u0431\u044b \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0435\u0434\u0435\u043b\u0435\u0439, \n# \u0442\u043e\u0433\u0434\u0430 \u043d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u043c\u043d\u0435 \u0438\u043b\u0438 \u0432 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u044f\u0445 \u043a \u043d\u043e\u0443\u0442\u0431\u0443\u043a\u0443\nutils.model_summary_short(model, \n                          base_model,\n                          ' (\u0438\u0437 baseline)')","8d9fb0d3":"print('\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043a\u043e\u043d\u0441\u0442\u0430\u043d\u0442 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438 (\u0438\u0437 baseline)') \nM_EPOCHS = utils.hyperp('M_EPOCHS', \n                        5, \n                        '\u041c\u043e\u0434\u0435\u043b\u044c. \u041a\u043e\u043b-\u0432\u043e \u044d\u043f\u043e\u0445 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438',\n                        results_of_exp,\n                        descr_hyperp_of_exp)\n\nM_CALLBACKS_TYPE = utils.hyperp('M_CALLBACKS_TYPE', \n                                'MC_T', \n                                '\u041c\u043e\u0434\u0435\u043b\u044c. \u0422\u0438\u043f callback: MC - ModelCheckpoint, ES - EarlyStopping, LRS - LearningRateScheduler, T - Time Callbacks',\n                                results_of_exp,\n                                descr_hyperp_of_exp)\nM_EPOCHS_DROP = utils.hyperp('M_EPOCHS_DROP', \n                             2, \n                             '\u041c\u043e\u0434\u0435\u043b\u044c. \u041a\u043e\u043b-\u0432\u043e \u044d\u043f\u043e\u0445 \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u0442\u043e\u0440\u043e\u0435 LR \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 sheduler',\n                             results_of_exp,\n                             descr_hyperp_of_exp)\nM_LR_UPDATE = utils.hyperp('M_LR_UPDATE', \n                           math.exp(-0.1), \n                           '\u041c\u043e\u0434\u0435\u043b\u044c. \u041a\u043e\u044d\u0444\u0444 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f LR \u0444\u0443\u043d\u043a\u0446\u0438\u0438 sheduler',\n                           results_of_exp,\n                           descr_hyperp_of_exp)","74da8b05":"# \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f Callbacks \ntime_cb = utils.TimingCallback()\ncallbacks_list = utils.callbacks_assembler(M_CALLBACKS_TYPE, \n                                           C_LR, \n                                           M_LR_UPDATE, \n                                           M_EPOCHS_DROP, \n                                           time_cb)","38f1bfbd":"# \u043a\u043e\u0434 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043d\u043e\u0443\u0442\u0431\u0443\u043a\u0430\n# \u043d\u0438\u0436\u0435 \u0438\u0434\u0435\u0442 \u043f\u043e\u043b\u043d\u0430\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u044d\u0442\u043e\u0433\u043e \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f\n# \u0438 \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0430 \u0441 \u043f\u0440\u043e\u0448\u043b\u044b\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u043d\u0430\u0433\u043b\u044f\u0434\u043d\u043e\u0441\u0442\u0438\n# \u0435\u0441\u043b\u0438 \u0432\u044b \u0437\u0430\u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438, \u0442\u043e\u0433\u0434\u0430 \u0437\u0430\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043a\u043e\u0434 \n# \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043b\u0443\u0447\u0448\u0435\u0439 \u0438\u0437 \u043e\u0431\u0443\u0447\u0435\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 (\u0441\u0442\u0440\u043e\u0447\u043a\u043e\u0439 \u043d\u0438\u0436\u0435)\n\n# # \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 (\u0438\u0437 baseline)\n# right_steps_per_epoch = len(train_generator)\n\n# history = model.fit_generator(train_generator,\n#                               steps_per_epoch = right_steps_per_epoch,\n#                               validation_data = valid_generator, \n#                               validation_steps = len(valid_generator),\n#                               epochs = M_EPOCHS,\n#                               callbacks = callbacks_list)","f3d22a4d":"# \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u0438\u0437 baseline\nprint('\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u0430 \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u0430\u044f \u043b\u0443\u0447\u0448\u0430\u044f \u0438\u0437 \u043e\u0431\u0443\u0447\u0435\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 (\u0438\u0437 baseline)')\nmodel.load_weights('..\/input\/last-result\/best_model_25_20201220__07_47.hdf5')\nutils.show_image('..\/input\/last-result\/pic_procces_model_fit_baseline_25.png',\n                '\u0421\u043a\u0440\u0438\u043d\u0448\u043e\u0442 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u0438\u0437 base_line', 14, 8, 0.95)\nhistory, time_cb = [], []\nmodel.save('best_model.hdf5')","3fc4c53a":"# \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u0438 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0442\u0440\u0438\u043a \u043d\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435 \u0434\u043b\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432\nprint('\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u043f\u043e\u0441\u043b\u0435 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u043d\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435:')\nmodel.load_weights('best_model.hdf5')\ntemp = model.evaluate_generator(valid_generator, verbose=1)","e58cb06d":"print('\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u043d\u0430 \u043b\u0443\u0447\u0448\u0435\u0439 \u043c\u043e\u0434\u0435\u043b\u0435')\nR_EVA_VAL_ACC = utils.hyperp('R_EVA_VAL_ACC', \n                             temp[1], \n                             '\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f. \u041e\u0446\u0435\u043d\u043a\u0430 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u043b\u0443\u0447\u0448\u0435\u0439 \u043c\u043e\u0434\u0435\u043b\u0435',\n                             results_of_exp,\n                             descr_hyperp_of_exp)\nR_EVA_VAL_LOSS = utils.hyperp('R_EVA_VAL_LOSS', \n                             temp[0], \n                             '\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f. \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0442\u0435\u0440\u044c \u043d\u0430 \u043b\u0443\u0447\u0448\u0435\u0439 \u043c\u043e\u0434\u0435\u043b\u0435',\n                             results_of_exp,\n                             descr_hyperp_of_exp)","d9d35a4f":"PATH_to_LAST_results_data = utils.save_model(PATH_to_WORKDIR,\n                                             PATH_to_WORKDIR,\n                                             model,\n                                             history, \n                                             time_cb, \n                                             results_of_exp,\n                                             descr_hyperp_of_exp,\n                                             True)\n# \u043c\u0435\u0442\u043e\u0434 \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438 \u0432 \u0434\u0430\u0442\u0430\u0441\u0435\u0442 \u0441 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\u043c\u0438\n# \u0442\u0430\u043a\u0436\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u0434\u0430\u0442\u0443 \u0438 \u0432\u0440\u0435\u043c\u044f \u0438 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430\n# \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442 \u0432 \u043c\u043e\u0434\u0435\u043b\u044c \u043b\u0443\u0447\u0448\u0443\u044e, \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u0435\u0435 \u0441 \u0438\u043c\u0435\u043d\u0435\u043c \u043d\u043e\u043c\u0435\u0440\u0430 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430, \u0434\u0430\u0442\u044b \u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u0438\n# \u043f\u043e\u0441\u043b\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0433\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432, \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442 \u0434\u0432\u0430 zip-\u0444\u0430\u0439\u043b\u0430 \u0438 \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \n# \u0443\u0434\u043e\u0431\u043d\u044b\u0435 \u0434\u043b\u044f \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u044f \u0441\u0441\u044b\u043b\u043a\u0438, \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0445 \u0441\u0435\u0431\u0435 \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443\n# \u043d\u0435 \u0437\u0430\u0431\u0443\u0434\u044c\u0442\u0435 \u0441\u0434\u0435\u043b\u0430\u0442\u044c Refresh \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u043f\u0430\u043f\u043a\u0438 \n# \u0438\u043b\u0438 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0434\u0432\u0430 \u0444\u0430\u0439\u043b\u0430 \u0441 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\u043c\u0438 \u0438 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f\u043c\u0438 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0432 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\n# \u0438 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0442\u044c \u0438\u0445 \u043f\u0440\u0438 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c \u0437\u0430\u043f\u0443\u0441\u043a\u0435","1fb508f0":"# \u0440\u0438\u0441\u0443\u0435\u043c \u0433\u0440\u0430\u0444\u0438\u043a\u0438 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0442\u0435\u0440\u044c \u043f\u043e \u044d\u043f\u043e\u0445\u0430\u043c\n# \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u043d\u0430 \u0433\u0440\u0430\u0444\u0438\u043a\u0435 \u043d\u043e\u043c\u0435\u0440 \u044d\u043a\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430, \u0434\u0430\u0442\u0430, \u0432\u0440\u0435\u043c\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0438 \u043e\u0446\u0435\u043d\u043e\u0447\u043d\u0430\u044f \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u043f\u043e \u0432\u0430\u043b \u0432\u044b\u0431\u043e\u0440\u043a\u0435\nutils.plot_acc_loss_fit_model_in_one (25, \n                                      results_of_exp,\n                                      ' (\u0438\u0437 baseline)')","fef3efa0":"# \u0432\u044b\u0432\u043e\u0434\u0438\u043c \u0441\u0432\u043e\u0434\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043f\u043e \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\u043c \nutils.show_result_exp(25,\n                      results_of_exp,\n                      descr_hyperp_of_exp,\n                      ' (baseline)')","96a64188":"# \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u043d\u043e\u0432\u044b\u0439 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0438\u0437 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0433\u043e\n# \u0442\u0430\u043a \u043a\u0430\u043a \u0441\u0435\u0441\u0438\u044f \u043d\u0435 \u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u043b\u0430\u0441\u044c\nprint('\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u043d\u043e\u0432\u044b\u0439 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442 Fine-Tuning (\u042d\u0442\u0430\u043f 1):')\nNUM_EXP = utils.new_exp_without_stop_session(results_of_exp)","22431802":"# \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u0438\u0441\u0445\u043e\u0434\u044f \u0438\u0437 \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0445\n# \u043f\u0440\u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u043c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u043a\u043e\u043d\u0441\u0442\u0430\u043d\u0442\u044b \u043d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 \n# \u043e\u043d\u043e \u0443\u0436\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043e \u0432 \u0441\u043b\u043e\u0432\u0430\u0440\u0435 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438\nprint('\u041d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u0438\u0441\u0445\u043e\u0434\u044f \u0438\u0437 \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0445 \u0434\u043b\u044f Fine-Tuning (\u042d\u0442\u0430\u043f 1)')\nAUG_ROTATION_RANGE = utils.hyperp('AUG_ROTATION_RANGE', \n                                  10, \n                                  '',\n                                  results_of_exp,\n                                  descr_hyperp_of_exp)\nAUG_IMG_SIZE = utils.hyperp('AUG_IMG_SIZE', \n                            320, \n                            '',\n                            results_of_exp,\n                            descr_hyperp_of_exp)\nAUG_BATCH_SIZE = utils.hyperp('AUG_BATCH_SIZE', \n                              32, \n                              '',\n                              results_of_exp,\n                              descr_hyperp_of_exp)\nAUG_VAL_SPLIT = utils.hyperp('AUG_VAL_SPLIT', \n                             0.05, \n                             '',\n                             results_of_exp,\n                             descr_hyperp_of_exp)\nAUG_RESCALE = utils.hyperp('AUG_RESCALE', \n                           1, \n                           '',\n                           results_of_exp,\n                           descr_hyperp_of_exp)","6841f018":"# \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435\ntrain_generator, \\\nvalid_generator, \\\ntest_generator = utils.train_valid_test_generators(\n                    AUG_ROTATION_RANGE,           \n                    AUG_BRIGHTNES_RANGE,\n                    AUG_WIDTH_SHIFT_RANGE, \n                    AUG_HEIGHT_SHIFT_RANGE,\n                    AUG_HORIZONTAL_FLIP,\n                    AUG_RESCALE,\n                    AUG_VAL_SPLIT,\n                    PATH_to_IMAGES_TRAIN,\n                    PATH_to_IMAGES_TEST,\n                    df_submit,\n                    AUG_IMG_SIZE,\n                    AUG_BATCH_SIZE,\n                    RANDOM_SEED)","45ee459d":"print('\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u043d\u043e\u0432\u044b\u0439 \u0442\u0438\u043f \u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u0434\u043b\u044f Fine-Tuning (\u042d\u0442\u0430\u043f 1)')\nM_BASE_TYPE = utils.hyperp('M_BASE_TYPE', \n                           'EfficientNetB3', \n                           '',\n                           results_of_exp,\n                           descr_hyperp_of_exp)","b60fd31d":"# \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0431\u0430\u0437\u043e\u0432\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c\nbase_model = EfficientNetB3(\n                    weights='imagenet', \n                    include_top=False, \n                    input_shape = (AUG_IMG_SIZE, \n                                   AUG_IMG_SIZE, \n                                   3))\n\n# \u043e\u0442\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u043e\u0431\u0443\u0447\u0430\u0435\u043c\u043e\u0441\u0442\u044c \u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438\nbase_model.trainable = False","305fac76":"print('\u041d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u0433\u043e\u043b\u043e\u0432\u044b \u0438 \u043a\u043e\u043c\u043f\u0438\u043b\u044f\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 \u0434\u043b\u044f Fine-Tuning (\u042d\u0442\u0430\u043f 1)')\nH_DROPOUT_RATE =  utils.hyperp('H_DROPOUT_RATE', \n                               0.25, \n                               '',\n                               results_of_exp,\n                               descr_hyperp_of_exp)\nH_USE_BIAS =  utils.hyperp('H_USE_BIAS', \n                           False, \n                           '',\n                           results_of_exp,\n                           descr_hyperp_of_exp)\nH_KERNEL_REG = utils.hyperp('H_KERNEL_REG', \n                            'l2', \n                            '',\n                            results_of_exp,\n                            descr_hyperp_of_exp)\nH_BATCHNORM =  utils.hyperp('H_BATCHNORM', \n                            True, \n                            '',\n                            results_of_exp,\n                            descr_hyperp_of_exp)\nC_LR = utils.hyperp('C_LR', \n                    1e-3, \n                    '',\n                    results_of_exp,\n                    descr_hyperp_of_exp)\n\u0421_OPTIMIZER_TYPE = utils.hyperp('\u0421_OPTIMIZER_TYPE', \n                                'Adam_amsgrad', \n                                '',\n                                results_of_exp,\n                                descr_hyperp_of_exp)\nC_LOSS_TYPE = utils.hyperp('C_LOSS_TYPE', \n                           'categorical_crossentropy', \n                           '\u041a\u043e\u043c\u043f\u0438\u043b\u044f\u0446\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438. \u0422\u0438\u043f \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0442\u0435\u0440\u044c (loss-\u0444\u0443\u043d\u043a\u0446\u0438\u0438)',\n                           results_of_exp,descr_hyperp_of_exp)","84be4b77":"# \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u0433\u043e\u043b\u043e\u0432\u044b (\u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0441\u043b\u043e\u0438 \u043f\u043e\u0432\u0435\u0440\u0445 \u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438) \n# \u0434\u043b\u044f Fine-Tuning (\u042d\u0442\u0430\u043f 1)\nhead = S([GlobalAveragePooling2D(), \n          Dense(128, use_bias=H_USE_BIAS, kernel_regularizer=H_KERNEL_REG),\n          BatchNormalization(axis=1), \n          Activation('relu'),\n          Dropout(H_DROPOUT_RATE),\n          Dense(10, activation='softmax')])\n\n\n# \u0421\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043f\u043e\u0434\u0445\u043e\u0434 \u043f\u0435\u0440\u0435\u043d\u043e\u0441 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f (Transfer learning)\nmodel = utils.model_assembler(base_model, \n                              head)\n\n# \u041a\u043e\u043c\u043f\u0438\u043b\u0438\u0440\u0443\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c\nmodel.compile(loss=C_LOSS_TYPE, \n              optimizer=optimizers.Adam(lr=C_LR, \n                                        amsgrad=True), \n              metrics=['accuracy'])","8f9cafd8":"# \u0432\u044b\u0432\u043e\u0434\u0438\u043c \u043a\u0440\u0430\u0442\u043a\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u043f\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c \u0438 \u0441\u043b\u043e\u044f\u043c\nutils.model_summary_short(model, \n                          base_model,\n                          ' Fine-Tuning (\u042d\u0442\u0430\u043f 1)')","5542f8b2":"print('\u041d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 \u0438 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f Fine-Tuning (\u042d\u0442\u0430\u043f 1)')\nM_EPOCHS = utils.hyperp('M_EPOCHS', \n                        15, \n                        '',\n                        results_of_exp,\n                        descr_hyperp_of_exp)\n\nM_CALLBACKS_TYPE = utils.hyperp('M_CALLBACKS_TYPE', \n                                'MC_ES_LRS_T', \n                                '',\n                                results_of_exp,\n                                descr_hyperp_of_exp)\nM_EPOCHS_DROP = utils.hyperp('M_EPOCHS_DROP', \n                             1, \n                             '',\n                             results_of_exp,\n                             descr_hyperp_of_exp)\nM_LR_UPDATE = utils.hyperp('M_LR_UPDATE', \n                           math.exp(-0.1), \n                           '',\n                           results_of_exp,\n                           descr_hyperp_of_exp)","d63028a5":"# \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c cb \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u0438 \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043a\u0438 cb \ntime_cb = utils.TimingCallback()\ncallbacks_list = utils.callbacks_assembler(M_CALLBACKS_TYPE, \n                                           C_LR, \n                                           M_LR_UPDATE, \n                                           M_EPOCHS_DROP, \n                                           time_cb)","03706a08":"# \u043a\u043e\u0434 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043d\u043e\u0443\u0442\u0431\u0443\u043a\u0430\n# \u043d\u0438\u0436\u0435 \u0438\u0434\u0435\u0442 \u043f\u043e\u043b\u043d\u0430\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u044d\u0442\u043e\u0433\u043e \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f\n# \u0438 \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0430 \u0441 \u043f\u0440\u043e\u0448\u043b\u044b\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u043d\u0430\u0433\u043b\u044f\u0434\u043d\u043e\u0441\u0442\u0438\n# \u0435\u0441\u043b\u0438 \u0432\u044b \u0437\u0430\u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438, \u0442\u043e\u0433\u0434\u0430 \u0437\u0430\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043a\u043e\u0434 \n# \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043b\u0443\u0447\u0448\u0435\u0439 \u0438\u0437 \u043e\u0431\u0443\u0447\u0435\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 (\u0441\u0442\u0440\u043e\u0447\u043a\u043e\u0439 \u043d\u0438\u0436\u0435)\n\n# # \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u0434\u043b\u044f Fine-Tuning (\u042d\u0442\u0430\u043f 1)\n# right_steps_per_epoch = len(train_generator)\n\n# history = model.fit_generator(train_generator,\n#                               steps_per_epoch = right_steps_per_epoch,\n#                               validation_data = valid_generator, \n#                               validation_steps = len(valid_generator),\n#                               epochs = M_EPOCHS,\n#                               callbacks = callbacks_list)","eb6a8872":"# # \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0440\u0430\u043d\u0435\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e\u0439 \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u042d\u0442\u0430\u043f\u0430 1 Fine-Tuning\nmodel.load_weights('..\/input\/last-result\/best_model_36_20201224__12_36.hdf5')\nprint('\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u0430 \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u0430\u044f \u043b\u0443\u0447\u0448\u0430\u044f \u0438\u0437 \u043e\u0431\u0443\u0447\u0435\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 Fine-Tuning (\u042d\u0442\u0430\u043f 1)')\nutils.show_image('..\/input\/last-result\/pic_procces_model_fit_ft1_1.png',\n                '\u0421\u043a\u0440\u0438\u043d\u0448\u043e\u0442\u044b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 Fine-Tuning (\u042d\u0442\u0430\u043f 1)', \n                 14, 10,0.92)\nutils.show_image('..\/input\/last-result\/pic_procces_model_fit_ft1_2.png',\n                '', 14, 10, 0.9)\nutils.show_image('..\/input\/last-result\/pic_procces_model_fit_ft1_3.png',\n                '', 14, 10, 0.9)\nhistory, time_cb = [], []\nmodel.save('best_model.hdf5')","f3ce33d2":"# \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u0438 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0442\u0440\u0438\u043a \u043d\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435 \u0434\u043b\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432\nprint('\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u043f\u043e\u0441\u043b\u0435 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u043d\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435:')\nmodel.load_weights('best_model.hdf5')\ntemp = model.evaluate_generator(valid_generator, verbose=1)","6798bf68":"print('\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u043e\u0446\u0435\u043d\u043a\u0443 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0442\u0435\u0440\u044c \u043d\u0430 \u043b\u0443\u0447\u0448\u0435\u0439 \u043c\u043e\u0434\u0435\u043b\u0435')\nR_EVA_VAL_ACC = utils.hyperp('R_EVA_VAL_ACC', \n                             temp[1], \n                             '',\n                             results_of_exp,\n                             descr_hyperp_of_exp)\nR_EVA_VAL_LOSS = utils.hyperp('R_EVA_VAL_LOSS', \n                             temp[0], \n                             '',\n                             results_of_exp,\n                             descr_hyperp_of_exp)","6292e004":"# \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438 \u0438 \u0432\u0441\u044e \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c\nprint('C\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c, \u0435\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f:')\nPATH_to_LAST_results_data = utils.save_model(PATH_to_WORKDIR,\n                                             PATH_to_WORKDIR,\n                                             model,\n                                             history, \n                                             time_cb, \n                                             results_of_exp,\n                                             descr_hyperp_of_exp,\n                                             True)","b0290dcb":"# \u0440\u0438\u0441\u0443\u0435\u043c \u0433\u0440\u0430\u0444\u0438\u043a\u0438 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u0438 \u0444\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0442\u0435\u0440\u044c \u043f\u043e \u044d\u043f\u043e\u0445\u0430\u043c\n# \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u043d\u0430 \u0433\u0440\u0430\u0444\u0438\u043a\u0435 \u043d\u043e\u043c\u0435\u0440 \u044d\u043a\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430, \u0434\u0430\u0442\u0430, \u0432\u0440\u0435\u043c\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0438 \u043e\u0446\u0435\u043d\u043e\u0447\u043d\u0430\u044f \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u043f\u043e \u0432\u0430\u043b \u0432\u044b\u0431\u043e\u0440\u043a\u0435\nutils.plot_acc_loss_fit_model_in_one (36, \n                                      results_of_exp,\n                                      ' F-Tuning (\u042d\u0442\u0430\u043f 1)')","cad64aa3":"# \u0432\u044b\u0432\u043e\u0434\u0438\u043c \u0441\u0432\u043e\u0434\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043f\u043e \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\u043c \nutils.show_result_exp(36,\n                      results_of_exp,\n                      descr_hyperp_of_exp,\n                      ' F-T (\u042d\u0442\u0430\u043f 1)')","341f5e0a":"# \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u043d\u043e\u0432\u044b\u0439 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0433\u0430\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0438\u0437 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0433\u043e\n# \u0442\u0430\u043a \u043a\u0430\u043a \u0441\u0435\u0441\u0438\u044f \u043d\u0435 \u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u043b\u0430\u0441\u044c\nprint('\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u043d\u043e\u0432\u044b\u0439 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442 Fine-Tuning (\u042d\u0442\u0430\u043f 2):')\nNUM_EXP = utils.new_exp_without_stop_session(results_of_exp)","0e58e15a":"# \u0440\u0430\u0437\u043c\u043e\u0440\u0430\u0436\u0438\u0432\u0430\u0435\u043c \u043f\u043e\u043b\u043e\u0432\u0438\u043d\u0443 \u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u043d\u0430\u0447\u0438\u043d\u0430\u044f \u0441 191 \u0441\u043b\u043e\u044f \u043a\u043e\u0433\u0434\u0430 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f block5\n# \u043a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e \u043d\u0430 \u043a\u0430\u0433\u043b \u043d\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044e \u043d\u0435\u0439\u0440\u043e\u0441\u0435\u0442\u0438 \u0441 \u0437\u0443\u043c\u043e\u043c, \n# \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0430\u043c \u0437\u0430\u043c\u043e\u0440\u043e\u0436\u0435\u043d\u043d\u044b\u0435 \u0441\u043b\u043e\u0438 \u0438 \u0433\u0434\u0435 \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0442 \u043f\u0440\u0438\u043c\u0435\u0440\u043d\u043e \u043f\u043e\u043b\u043e\u0432\u0438\u043d\u0430 \u044d\u0442\u0438\u0445 \u0441\u043b\u043e\u0435\u0432\n# \u043d\u043e \u044d\u0442\u043e \u043c\u043e\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u043f\u043e \u044d\u0442\u043e\u0439 [\u0441\u0441\u044b\u043b\u043a\u0435](https:\/\/dgschwend.github.io\/netscope\/quickstart.html) \n# \u0436\u0435\u043b\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u043f\u0435\u0440\u0435\u0434 \u0437\u0430\u043c\u043e\u0440\u043e\u0437\u043a\u043e\u0439 \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043d\u0430 \u043c\u043e\u0434\u0435\u043b\u044c, \n# \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u0440\u043e\u0432\u0435\u0441\u0442\u0438 \u043b\u0438\u043d\u0438\u044e \u0437\u0430\u043c\u043e\u0440\u043e\u0437\u043a\u0438 \u043c\u0435\u0436\u0434\u0443 bn \u0438 activation\ncount_l = 0\nfor layer in base_model.layers:\n    if (count_l >= 191) and (not isinstance(layer, BatchNormalization)): \n        layer.trainable = True\n    count_l += 1","74c6f353":"# \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u043a\u043e\u043c\u043f\u0438\u043b\u044f\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438\nprint('\u041d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a\u043e\u043c\u043f\u0438\u043b\u044f\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 \u0434\u043b\u044f Fine-Tuning (\u042d\u0442\u0430\u043f 2)')\nC_LR = utils.hyperp('C_LR', 1e-4, '',results_of_exp,descr_hyperp_of_exp)\n# \u0443\u043c\u0435\u043d\u044c\u0448\u0430\u0435\u043c \u0448\u0430\u0433","b6ad589d":"# \u0421\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c \nmodel = utils.model_assembler(base_model, \n                              head)\n\n# \u041a\u043e\u043c\u043f\u0438\u043b\u0438\u0440\u0443\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c\nmodel.compile(loss=C_LOSS_TYPE, \n              optimizer=optimizers.Adam(lr=C_LR, \n                                        amsgrad=True), \n              metrics=['accuracy'])","91cff925":"# \u0432\u044b\u0432\u043e\u0434\u0438\u043c \u043a\u0440\u0430\u0442\u043a\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u043f\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c \u0438 \u0441\u043b\u043e\u044f\u043c\nutils.model_summary_short(model, \n                          base_model,\n                          ' Fine-Tuning (\u042d\u0442\u0430\u043f 2)')","211f931f":"# \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c cb \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u0438 \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043a\u0438 cb \ntime_cb = utils.TimingCallback()\ncallbacks_list = utils.callbacks_assembler(M_CALLBACKS_TYPE, \n                                           C_LR, \n                                           M_LR_UPDATE, \n                                           M_EPOCHS_DROP, \n                                           time_cb)","8bbce3bd":"# \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u0443\u044e \u043d\u0430 1 \u042d\u0442\u0430\u043f\u0435 \u043c\u043e\u0434\u0435\u043b\u044c \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c\nprint('\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u0443\u044e \u043d\u0430 1 \u042d\u0442\u0430\u043f\u0435 \u043c\u043e\u0434\u0435\u043b\u044c \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c')\nmodel.load_weights('best_model.hdf5')\ntemp = model.evaluate_generator(valid_generator, verbose=1)","49680d0a":"# \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 \u0438 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f\nprint('\u041d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 \u0438 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f Fine-Tuning (\u042d\u0442\u0430\u043f 2)')\nM_EPOCHS = utils.hyperp('M_EPOCHS', 12, '',results_of_exp,descr_hyperp_of_exp)","30580ff5":"# \u043a\u043e\u0434 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043d\u043e\u0443\u0442\u0431\u0443\u043a\u0430\n# \u043d\u0438\u0436\u0435 \u0438\u0434\u0435\u0442 \u043f\u043e\u043b\u043d\u0430\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u044d\u0442\u043e\u0433\u043e \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f\n# \u0438 \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0430 \u0441 \u043f\u0440\u043e\u0448\u043b\u044b\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u043d\u0430\u0433\u043b\u044f\u0434\u043d\u043e\u0441\u0442\u0438\n# \u0435\u0441\u043b\u0438 \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438, \u0437\u0430\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043a\u043e\u0434 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 \u043d\u0438\u0436\u0435\n\n# # \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u0434\u043b\u044f Fine-Tuning (\u042d\u0442\u0430\u043f 2)\n# right_steps_per_epoch = len(train_generator)\n\n# history = model.fit_generator(train_generator,\n#                               steps_per_epoch = right_steps_per_epoch,\n#                               validation_data = valid_generator, \n#                               validation_steps = len(valid_generator),\n#                               epochs = M_EPOCHS,\n#                               callbacks = callbacks_list)","f4d32241":"# \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0440\u0430\u043d\u0435\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e\u0439 \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u042d\u0442\u0430\u043f\u0430 2 Fine-Tuning\nprint('\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u0430 \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u0430\u044f \u043b\u0443\u0447\u0448\u0430\u044f \u0438\u0437 \u043e\u0431\u0443\u0447\u0435\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 Fine-Tuning (\u042d\u0442\u0430\u043f 2)')\nmodel.load_weights('..\/input\/last-result\/best_model_42_20201225__15_54.hdf5')\nutils.show_image('..\/input\/last-result\/pic_procces_model_fit_ft2_1.png',\n                '\u0421\u043a\u0440\u0438\u043d\u0448\u043e\u0442\u044b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u042d\u0442\u0430\u043f\u0430 2 Fine-tuning', \n                 14, 12, 0.90)\nutils.show_image('..\/input\/last-result\/pic_procces_model_fit_ft2_2.png',\n                '', 14, 12, 0.9)\nhistory, time_cb = [], []\nmodel.save('best_model.hdf5')","0695db27":"# \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u0438 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0442\u0440\u0438\u043a \u043d\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435 \u0434\u043b\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432\nprint('\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u043f\u043e\u0441\u043b\u0435 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u043d\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435:')\nmodel.load_weights('best_model.hdf5')\ntemp = model.evaluate_generator(valid_generator, verbose=1)","ba279edd":"print('\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u043e\u0446\u0435\u043d\u043a\u0443 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0442\u0435\u0440\u044c \u043d\u0430 \u043b\u0443\u0447\u0448\u0435\u0439 \u043c\u043e\u0434\u0435\u043b\u0435')\nR_EVA_VAL_ACC = utils.hyperp('R_EVA_VAL_ACC', \n                             temp[1], \n                             '',\n                             results_of_exp,\n                             descr_hyperp_of_exp)\nR_EVA_VAL_LOSS = utils.hyperp('R_EVA_VAL_LOSS', \n                             temp[0], \n                             '',\n                             results_of_exp,\n                             descr_hyperp_of_exp)","f6fb8a2e":"# \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438 \u0438 \u0432\u0441\u044e \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c\nprint('C\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c, \u0435\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f:')\nPATH_to_LAST_results_data = utils.save_model(PATH_to_WORKDIR,\n                                             PATH_to_WORKDIR,\n                                             model,\n                                             history, \n                                             time_cb, \n                                             results_of_exp,\n                                             descr_hyperp_of_exp)","7fdd7e6c":"# \u0440\u0438\u0441\u0443\u0435\u043c \u0433\u0440\u0430\u0444\u0438\u043a\u0438 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0442\u0435\u0440\u044c \u043f\u043e \u044d\u043f\u043e\u0445\u0430\u043c\n# \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u043d\u0430 \u0433\u0440\u0430\u0444\u0438\u043a\u0435 \u043d\u043e\u043c\u0435\u0440 \u044d\u043a\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430, \u0434\u0430\u0442\u0430, \u0432\u0440\u0435\u043c\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0438 \u043e\u0446\u0435\u043d\u043e\u0447\u043d\u0430\u044f \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u043f\u043e \u0432\u0430\u043b \u0432\u044b\u0431\u043e\u0440\u043a\u0435\nutils.plot_acc_loss_fit_model_in_one (42, \n                                      results_of_exp,\n                                      ' F-Tuning (\u042d\u0442\u0430\u043f 2)')","e23bf146":"# \u0432\u044b\u0432\u043e\u0434\u0438\u043c \u0441\u0432\u043e\u0434\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043f\u043e \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\u043c \nutils.show_result_exp(42,\n                      results_of_exp,\n                      descr_hyperp_of_exp,\n                      ' F-T (\u042d\u0442\u0430\u043f 2)')","65663669":"# \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u043d\u043e\u0432\u044b\u0439 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0433\u0430\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0438\u0437 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0433\u043e\n# \u0442\u0430\u043a \u043a\u0430\u043a \u0441\u0435\u0441\u0438\u044f \u043d\u0435 \u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u043b\u0430\u0441\u044c\nprint('\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u043d\u043e\u0432\u044b\u0439 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442 Fine-Tuning (\u042d\u0442\u0430\u043f 3):')\nNUM_EXP = utils.new_exp_without_stop_session(results_of_exp)","dec9f8c3":"# \u0440\u0430\u0437\u043c\u043e\u0440\u0430\u0436\u0438\u0432\u0430\u0435\u043c \u0412\u0421\u042e \u0431\u0430\u0437\u043e\u0432\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c\nfor layer in base_model.layers:\n    if not isinstance(layer, BatchNormalization): \n        layer.trainable = True","f4ce1ee6":"# \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u043a\u043e\u043c\u043f\u0438\u043b\u044f\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438\nprint('\u041d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a\u043e\u043c\u043f\u0438\u043b\u044f\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 \u0434\u043b\u044f Fine-Tuning (\u042d\u0442\u0430\u043f 3)')\nC_LR = utils.hyperp('C_LR', \n                    1e-5, \n                    '',\n                    results_of_exp,\n                    descr_hyperp_of_exp)\n# \u0443\u043c\u0435\u043d\u044c\u0448\u0430\u0435\u043c \u0448\u0430\u0433","8cb12bde":"# \u0421\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c \nmodel = utils.model_assembler(base_model, \n                              head)\n\n# \u041a\u043e\u043c\u043f\u0438\u043b\u0438\u0440\u0443\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c\nmodel.compile(loss=C_LOSS_TYPE, \n              optimizer=optimizers.Adam(lr=C_LR, \n                                        amsgrad=True), \n              metrics=['accuracy'])","198b5b02":"# \u0432\u044b\u0432\u043e\u0434\u0438\u043c \u043a\u0440\u0430\u0442\u043a\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u043f\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c \u0438 \u0441\u043b\u043e\u044f\u043c\nutils.model_summary_short(model, \n                          base_model,\n                          ' Fine-Tuning (\u042d\u0442\u0430\u043f 3)')","9214b425":"# \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c cb \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u0438 \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043a\u0438 cb \ntime_cb = utils.TimingCallback()\ncallbacks_list = utils.callbacks_assembler(M_CALLBACKS_TYPE, \n                                           C_LR, \n                                           M_LR_UPDATE, \n                                           M_EPOCHS_DROP, \n                                           time_cb)","11bb68b6":"# \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u0443\u044e \u043d\u0430 2 \u042d\u0442\u0430\u043f\u0435 \u043c\u043e\u0434\u0435\u043b\u044c \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \nprint('\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u0443\u044e \u043d\u0430 2 \u042d\u0442\u0430\u043f\u0435 \u043c\u043e\u0434\u0435\u043b\u044c \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c')\nmodel.load_weights('best_model.hdf5')\ntemp = model.evaluate_generator(valid_generator, verbose=1)[1]","5eaec2d0":"# \u043a\u043e\u0434 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043d\u043e\u0443\u0442\u0431\u0443\u043a\u0430\n# \u043d\u0438\u0436\u0435 \u0438\u0434\u0435\u0442 \u043f\u043e\u043b\u043d\u0430\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u044d\u0442\u043e\u0433\u043e \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f\n# \u0438 \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0430 \u0441 \u043f\u0440\u043e\u0448\u043b\u044b\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u043d\u0430\u0433\u043b\u044f\u0434\u043d\u043e\u0441\u0442\u0438\n# \u0435\u0441\u043b\u0438 \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438, \u0437\u0430\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043a\u043e\u0434 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 \u043d\u0438\u0436\u0435\n\n# # \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 Fine-Tuning (\u042d\u0442\u0430\u043f 3)\n# right_steps_per_epoch = len(train_generator)\n# \n# history = model.fit_generator(train_generator,\n#                               steps_per_epoch = right_steps_per_epoch,\n#                               validation_data = valid_generator, \n#                               validation_steps = len(valid_generator),\n#                               epochs = M_EPOCHS,\n#                               callbacks = callbacks_list)","4db2ac45":"# \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0440\u0430\u043d\u0435\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e\u0439 \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u042d\u0442\u0430\u043f\u0430 3 Fine-Tuning\nprint('\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u0430 \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u0430\u044f \u043b\u0443\u0447\u0448\u0430\u044f \u0438\u0437 \u043e\u0431\u0443\u0447\u0435\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 Fine-Tuning (\u042d\u0442\u0430\u043f 3)')\nmodel.load_weights('..\/input\/last-result\/best_model_51_20201228__04_27.hdf5')\nutils.show_image('..\/input\/last-result\/pic_procces_model_fit_ft3_1.png',\n                '\u0421\u043a\u0440\u0438\u043d\u0448\u043e\u0442 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u042d\u0442\u0430\u043f\u0430 3 Fine-tuning', \n                 14, 16, 0.95)\nhistory, time_cb = [], []\nmodel.save('best_model.hdf5')","d42cbb4e":"# \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u0438 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043e\u0446\u0435\u043d\u043a\u0438 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435 \u0434\u043b\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432\nprint('\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u043f\u043e\u0441\u043b\u0435 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u043d\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435:')\nmodel.load_weights('best_model.hdf5')\ntemp = model.evaluate_generator(valid_generator, verbose=1)","b9ea9efc":"print('\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u043e\u0446\u0435\u043d\u043a\u0443 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0442\u0435\u0440\u044c \u043d\u0430 \u043b\u0443\u0447\u0448\u0435\u0439 \u043c\u043e\u0434\u0435\u043b\u0435')\nR_EVA_VAL_ACC = utils.hyperp('R_EVA_VAL_ACC', \n                             temp[1], \n                             '',\n                             results_of_exp,\n                             descr_hyperp_of_exp)\nR_EVA_VAL_LOSS = utils.hyperp('R_EVA_VAL_LOSS', \n                             temp[0], \n                             '',\n                             results_of_exp,\n                             descr_hyperp_of_exp)","dd3c920d":"# \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438 \u0438 \u0432\u0441\u044e \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c\nprint('C\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c, \u0435\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f:')\nPATH_to_LAST_results_data = utils.save_model(PATH_to_WORKDIR,\n                                             PATH_to_WORKDIR,\n                                             model,\n                                             history, \n                                             time_cb, \n                                             results_of_exp,\n                                             descr_hyperp_of_exp)","a4025f42":"# \u0440\u0438\u0441\u0443\u0435\u043c \u0433\u0440\u0430\u0444\u0438\u043a\u0438 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0442\u0435\u0440\u044c \u043f\u043e \u044d\u043f\u043e\u0445\u0430\u043c\n# \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u043d\u0430 \u0433\u0440\u0430\u0444\u0438\u043a\u0435 \u043d\u043e\u043c\u0435\u0440 \u044d\u043a\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430, \u0434\u0430\u0442\u0430, \u0432\u0440\u0435\u043c\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0438 \u043e\u0446\u0435\u043d\u043e\u0447\u043d\u0430\u044f \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u043f\u043e \u0432\u0430\u043b \u0432\u044b\u0431\u043e\u0440\u043a\u0435\nutils.plot_acc_loss_fit_model_in_one (51, \n                                      results_of_exp,\n                                      ' F-Tuning (\u042d\u0442\u0430\u043f 3)')","4cc25b4a":"# \u0432\u044b\u0432\u043e\u0434\u0438\u043c \u0441\u0432\u043e\u0434\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043f\u043e \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\u043c \nutils.show_result_exp(51,\n                      results_of_exp,\n                      descr_hyperp_of_exp,\n                      ' F-T (\u042d\u0442\u0430\u043f 3)')","15690f8b":"# \u0432\u044b\u0432\u043e\u0434\u0438\u043c \u0433\u0440\u0430\u0444\u0438\u043a \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0442\u0435\u0440\u044c \n# \u043f\u043e \u0440\u0430\u0437\u043d\u044b\u043c \u044d\u0442\u0430\u043f\u0430\u043c \u0442\u043e\u043d\u043a\u043e\u0439 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\nutils.plot_res_dif_exp_in_one([36,42,51],\n                              ['freeze\\nbase model\\n100%', \n                               'freeze\\nbase model\\n50%', \n                               'freeze\\nbase model\\n0%'],\n                              results_of_exp,\n                              0.4)","41f46c60":"# \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u043d\u043e\u0432\u044b\u0439 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0433\u0430\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0438\u0437 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0433\u043e\n# \u0442\u0430\u043a \u043a\u0430\u043a \u0441\u0435\u0441\u0438\u044f \u043d\u0435 \u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u043b\u0430\u0441\u044c\nprint('\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u043d\u043e\u0432\u044b\u0439 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442 Extra Fit (size+):')\nNUM_EXP = utils.new_exp_without_stop_session(results_of_exp)","587f5ee6":"# \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u0438\u0441\u0445\u043e\u0434\u044f \u0438\u0437 \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0445\n# \u043f\u0440\u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u043c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u043a\u043e\u043d\u0441\u0442\u0430\u043d\u0442\u044b \u043d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 \n# \u043e\u043d\u043e \u0443\u0436\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043e \u0432 \u0441\u043b\u043e\u0432\u0430\u0440\u0435 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438\nprint('\u041d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u0438\u0441\u0445\u043e\u0434\u044f \u0438\u0437 \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0445 \u0434\u043b\u044f Extra Fit (size+)')\nAUG_IMG_SIZE = utils.hyperp('AUG_IMG_SIZE', \n                            520, \n                            '',\n                            results_of_exp,\n                            descr_hyperp_of_exp)\nAUG_BATCH_SIZE = utils.hyperp('AUG_BATCH_SIZE', \n                              12, \n                              '',\n                              results_of_exp,\n                              descr_hyperp_of_exp)\n# \u043f\u0440\u0438\u0448\u043b\u043e\u0441\u044c \u0443\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c batch \u0434\u043e \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u0443\u043b\u043e\u0436\u0438\u0442\u044c\u0441\u044f \u0432 16\u0413\u0411 Tesla P100","cadc5cf7":"# \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435\ntrain_generator, \\\nvalid_generator, \\\ntest_generator = utils.train_valid_test_generators(\n                    AUG_ROTATION_RANGE,           \n                    AUG_BRIGHTNES_RANGE,\n                    AUG_WIDTH_SHIFT_RANGE, \n                    AUG_HEIGHT_SHIFT_RANGE,\n                    AUG_HORIZONTAL_FLIP,\n                    AUG_RESCALE,\n                    AUG_VAL_SPLIT,\n                    PATH_to_IMAGES_TRAIN,\n                    PATH_to_IMAGES_TEST,\n                    df_submit,\n                    AUG_IMG_SIZE,\n                    AUG_BATCH_SIZE,\n                    RANDOM_SEED)","d069f63d":"# \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0431\u0430\u0437\u043e\u0432\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u0437\u0430\u043d\u043e\u0432\u043e \u043d\u0430 \u043d\u043e\u0432\u044b\u0445 \u0440\u0430\u0437\u043c\u0435\u0440\u0430\u0445 \u0444\u043e\u0442\u043e\nbase_model = EfficientNetB3(\n                    weights='imagenet', \n                    include_top=False, \n                    input_shape = (AUG_IMG_SIZE, \n                                   AUG_IMG_SIZE, \n                                   3))","0d3d9a8c":"# \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u0433\u043e\u043b\u043e\u0432\u044b \u0438 \u043a\u043e\u043c\u043f\u0438\u043b\u044f\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438\nprint('\u041d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a\u043e\u043c\u043f\u0438\u043b\u044f\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 \u0434\u043b\u044f Extra Fit (size+)')\nC_LR = utils.hyperp('C_LR', \n                    1e-4, \n                    '',\n                    results_of_exp,\n                    descr_hyperp_of_exp)\n# \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u043c \u0448\u0430\u0433 \u0442\u0430\u043a \u043a\u0430\u043a \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442 \u043f\u043e\u043a\u0430\u0437\u0430\u043b \u0447\u0442\u043e \u043d\u0430 \u0448\u0430\u0433\u0435 \u0441 3 \u044d\u0442\u0430\u043f\u0430 \u043c\u043e\u0434\u0435\u043b\u044c \n# \u043d\u0435 \u0447\u0443\u0432\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u0430 \u0438 \u043d\u0435 \u0443\u0441\u043f\u0435\u0432\u0430\u0435\u0442 \u043e\u0431\u0443\u0447\u0438\u0442\u0441\u044f \u0437\u0430 12 \u044d\u043f\u043e\u0445","5901cffe":"# \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u0433\u043e\u043b\u043e\u0432\u044b (\u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0441\u043b\u043e\u0438 \u043f\u043e\u0432\u0435\u0440\u0445 \u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438)\nhead = S([GlobalAveragePooling2D(), \n          Dense(128, use_bias=H_USE_BIAS, kernel_regularizer=H_KERNEL_REG),\n          BatchNormalization(axis=1), \n          Activation('relu'),\n          Dropout(H_DROPOUT_RATE),\n          Dense(10, activation='softmax')])\n\n\n# \u0421\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043f\u043e\u0434\u0445\u043e\u0434 \u043f\u0435\u0440\u0435\u043d\u043e\u0441 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f (Transfer learning)\nmodel = utils.model_assembler(base_model, head)\n\n# \u041a\u043e\u043c\u043f\u0438\u043b\u0438\u0440\u0443\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c\nmodel.compile(loss=C_LOSS_TYPE, \n              optimizer=optimizers.Adam(lr=C_LR, \n                                        amsgrad=True), \n              metrics=['accuracy'])","79b7345f":"# \u0432\u044b\u0432\u043e\u0434\u0438\u043c \u043a\u0440\u0430\u0442\u043a\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u043f\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c \u0438 \u0441\u043b\u043e\u044f\u043c\nutils.model_summary_short(model, \n                          base_model,\n                          ' Extra Fit (size+)')","4d253d47":"# \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u0443\u044e \u043d\u0430 3 \u042d\u0442\u0430\u043f\u0435 \u043c\u043e\u0434\u0435\u043b\u044c \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \nprint('\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u0443\u044e \u043d\u0430 3 \u042d\u0442\u0430\u043f\u0435 \u043c\u043e\u0434\u0435\u043b\u044c \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c')\nmodel.load_weights('best_model.hdf5')\ntemp = model.evaluate_generator(valid_generator, verbose=1)","d5aa1118":"# \u0443\u0432\u0435\u043b\u0438\u0432\u0430\u0435\u043c \u043f\u043b\u0430\u0442\u043e \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e LR, \u0447\u0442\u043e\u0431\u044b \u043c\u043e\u0434\u0435\u043b\u044c \u0443\u0441\u043f\u0435\u043b\u0430 \u043e\u0431\u0443\u0447\u0438\u0442\u044c\u0441\u044f \u0437\u0430 \u0434\u0432\u0435 \u044d\u043f\u043e\u0445\u0438\nprint('\u041d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 \u0438 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f Extra Fit (size+)')\nM_EPOCHS_DROP = utils.hyperp('M_EPOCHS_DROP', \n                             2, '',\n                             results_of_exp,\n                             descr_hyperp_of_exp)","aa3d33e0":"# \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c cb \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u0438 \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043a\u0438 cb \ntime_cb = utils.TimingCallback()\ncallbacks_list = utils.callbacks_assembler(M_CALLBACKS_TYPE, \n                                           C_LR, \n                                           M_LR_UPDATE, \n                                           M_EPOCHS_DROP, \n                                           time_cb)","c656dace":"# \u043a\u043e\u0434 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043d\u043e\u0443\u0442\u0431\u0443\u043a\u0430\n# \u043d\u0438\u0436\u0435 \u0438\u0434\u0435\u0442 \u043f\u043e\u043b\u043d\u0430\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u044d\u0442\u043e\u0433\u043e \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f\n# \u0438 \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0430 \u0441 \u043f\u0440\u043e\u0448\u043b\u044b\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u043d\u0430\u0433\u043b\u044f\u0434\u043d\u043e\u0441\u0442\u0438\n# \u0435\u0441\u043b\u0438 \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438, \u0437\u0430\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043a\u043e\u0434 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 \u043d\u0438\u0436\u0435\n\n# # \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u0434\u043b\u044f Extra Fit (size+)\n# right_steps_per_epoch = len(train_generator)\n# \n# history = model.fit_generator(train_generator,\n#                               steps_per_epoch = right_steps_per_epoch,\n#                               validation_data = valid_generator, \n#                               validation_steps = len(valid_generator),\n#                               epochs = M_EPOCHS,\n#                               callbacks = callbacks_list)","4b85abc1":"# \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0440\u0430\u043d\u0435\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e\u0439 \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u043d\u0430 \u0443\u0432\u0435\u043b\u0438\u0447 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0438 520\nprint('\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u0430 \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u0430\u044f \u043b\u0443\u0447\u0448\u0430\u044f \u0438\u0437 \u043e\u0431\u0443\u0447\u0435\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 Extra Fit (size+)')\nmodel.load_weights('..\/input\/last-result\/best_model_56_20201231__11_36.hdf5')\nutils.show_image('..\/input\/last-result\/pic_procces_model_fit_520_1.png',\n                '\u0421\u043a\u0440\u0438\u043d\u0448\u043e\u0442 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u043d\u0430 \u0443\u0432\u0435\u043b\u0438\u0447. \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0438', \n                 14, 15, 0.95)\nutils.show_image('..\/input\/last-result\/pic_procces_model_fit_520_2.png',\n                '', \n                 14, 15, 0.95)\nhistory, time_cb = [], []\nmodel.save('best_model.hdf5')","95ee3a3f":"# \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u0438 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043e\u0446\u0435\u043d\u043a\u0438 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435 \u0434\u043b\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432\nprint('\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u043f\u043e\u0441\u043b\u0435 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u043d\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435:')\nmodel.load_weights('best_model.hdf5')\ntemp = model.evaluate_generator(valid_generator, verbose=1)","f9b0164f":"print('\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u043e\u0446\u0435\u043d\u043a\u0443 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0442\u0435\u0440\u044c \u043d\u0430 \u043b\u0443\u0447\u0448\u0435\u0439 \u043c\u043e\u0434\u0435\u043b\u0435')\nR_EVA_VAL_ACC = utils.hyperp('R_EVA_VAL_ACC', \n                             temp[1], \n                             '',\n                             results_of_exp,\n                             descr_hyperp_of_exp)\nR_EVA_VAL_LOSS = utils.hyperp('R_EVA_VAL_LOSS', \n                             temp[0], \n                             '',\n                             results_of_exp,\n                             descr_hyperp_of_exp)","8cd2162a":"# \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438 \u0438 \u0432\u0441\u044e \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c\nprint('C\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u043b\u0443\u0447\u0448\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c, \u0435\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f:')\nPATH_to_LAST_results_data = utils.save_model(PATH_to_WORKDIR,\n                                             PATH_to_WORKDIR,\n                                             model,\n                                             history, \n                                             time_cb, \n                                             results_of_exp,\n                                             descr_hyperp_of_exp)","cd893769":"# \u0440\u0438\u0441\u0443\u0435\u043c \u0433\u0440\u0430\u0444\u0438\u043a\u0438 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0442\u0435\u0440\u044c \u043f\u043e \u044d\u043f\u043e\u0445\u0430\u043c\n# \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u043d\u0430 \u0433\u0440\u0430\u0444\u0438\u043a\u0435 \u043d\u043e\u043c\u0435\u0440 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430, \u0434\u0430\u0442\u0430, \u0432\u0440\u0435\u043c\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0438 \u043e\u0446\u0435\u043d\u043e\u0447\u043d\u0430\u044f \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u043f\u043e \u0432\u0430\u043b \u0432\u044b\u0431\u043e\u0440\u043a\u0435\nutils.plot_acc_loss_fit_model_in_one (56, \n                                      results_of_exp,\n                                      ' Extra Fit (size+)')","e97bf282":"# \u0432\u044b\u0432\u043e\u0434\u0438\u043c \u0441\u0432\u043e\u0434\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043f\u043e \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\u043c \nutils.show_result_exp(56,\n                      results_of_exp,\n                      descr_hyperp_of_exp,\n                      ' Extra Fit')","3b477227":"test_generator.samples","29f8fa95":"test_generator.reset()\npredictions = model.predict_generator(test_generator, \n                                      steps=len(test_generator), \n                                      verbose=1) \npredictions = np.argmax(predictions, axis=-1) #multiple categories\nlabel_map = (train_generator.class_indices)\nlabel_map = dict((v,k) for k,v in label_map.items()) #flip k,v\npredictions = [label_map[k] for k in predictions]","96ad391d":"filenames_with_dir=test_generator.filenames\nsubmission = pd.DataFrame({'Id':filenames_with_dir, \n                           'Category':predictions}, \n                          columns=['Id', 'Category'])\nsubmission['Id'] = submission['Id'].replace('test_upload\/','')\nsubmission.to_csv('submission_56.csv', index=False)\nprint('Save submit')","31b656b9":"submission.head()","73645989":"from tensorflow.keras.preprocessing.image import ImageDataGenerator\n\n# \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435\ntest_datagen = ImageDataGenerator(rotation_range=5, \n                                  brightness_range=[0.5, 2.5], \n                                  width_shift_range=AUG_WIDTH_SHIFT_RANGE, \n                                  height_shift_range=AUG_HEIGHT_SHIFT_RANGE, \n                                  horizontal_flip=AUG_HORIZONTAL_FLIP)\n\ntest_generator = test_datagen.flow_from_dataframe(\n    dataframe=df_submit, \n    directory=PATH_to_IMAGES_TEST, \n    x_col='Id', \n    y_col=None, \n    target_size=(AUG_IMG_SIZE, AUG_IMG_SIZE), \n    batch_size=AUG_BATCH_SIZE, \n    class_mode=None, \n    shuffle=False, \n    seed=RANDOM_SEED\n    )","eb766e12":"NUM_PREDICTIONS_FOR_TTA = M_EPOCHS   \npredictions_TTA = []\n\nfor i in range(NUM_PREDICTIONS_FOR_TTA):\n    temp_predict = model.predict_generator(test_generator, verbose=1)\n    predictions_TTA.append(temp_predict)\n\nfinal_TTA_prediction = np.mean(np.array(predictions_TTA), axis=0)","e56bd34e":"final_TTA_prediction[:2]","7211c58f":"predictions = np.argmax(final_TTA_prediction, axis=-1)\nlabel_map = (train_generator.class_indices)\nlabel_map = dict((v,k) for k,v in label_map.items()) #flip k,v\npredictions = [label_map[k] for k in predictions]","db31d108":"filenames_with_dir=test_generator.filenames\nsubmission = pd.DataFrame({'Id':filenames_with_dir, \n                           'Category':predictions}, \n                          columns=['Id', 'Category'])\nsubmission['Id'] = submission['Id'].replace('test_upload\/','')\nsubmission.to_csv('submission_56_TTA.csv', index=False)\nprint('Save submit')","ea5a1cfe":"submission.head()","588cd59a":"# \u0447\u0438\u0441\u0442\u0438\u043c \u0440\u0430\u0431\u043e\u0447\u0443\u044e \u043f\u0430\u043f\u043a\u0443 \u043f\u0435\u0440\u0435\u0434 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435\u043c  \nutils.clean_HDD_befor_RUN_and_SAVE(PATH_to_WORKDIR,\n                           [PATH_to_IMAGES], \n                            ['best_model.hdf5'], \n                            ['.zip'])","d19795db":"## 7.4 \u0412\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 Fine-Tuning","3b6e571e":"8 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f - Volkswagen Passat","67d1905a":"***\u0420\u0435\u0437\u044e\u043c\u0435:***  \n\u042d\u0442\u043e \u043f\u0440\u0438\u043c\u0435\u0440 \u043d\u0430 \u0431\u0430\u0437\u0435 baseline (Transfer learning - Xception) \u0441 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u043d\u0430\u0447\u0430\u043b\u0438\u0441\u044c \u043c\u043d\u043e\u0433\u043e\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0435 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u044b \u043f\u043e \u0432\u044b\u0431\u043e\u0440\u0443 \u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u0438 \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0434\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u0442\u043e\u043d\u043a\u043e\u0439 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0435 (Fine_Tuning).  \n\n\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u043c \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u043e\u0432 \u0441\u0442\u0430\u043b\u0438 \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0438\u0441\u044c \u0434\u0430\u043b\u0435\u0435 \u0432 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438 \u0441 \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u043e\u043c (Transfer learning). \u041c\u043e\u0436\u043d\u043e \u0432\u044b\u0434\u0435\u043b\u0438\u0442\u044c \u0433\u043b\u0430\u0432\u043d\u044b\u0435 \u043c\u043e\u043c\u0435\u043d\u0442\u044b \u043f\u043e \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\u043c \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u044d\u043a\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u043e\u0432: \n- \u0431\u044b\u043b\u0430 \u0432\u044b\u0431\u0440\u0430\u043d\u0430 \u0431\u0430\u0437\u043e\u0432\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c EfficientNetB3 \n- BatchNormalization \u0432 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435 \u0433\u043e\u043b\u043e\u0432\u044b\n- \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u0430\u044f \u0440\u0435\u0433\u0443\u043b\u044f\u0440\u0438\u0437\u0430\u0446\u0438\u044f *l2* \u043f\u0430\u0440\u0430\u043b\u0435\u043b\u044c\u043d\u043e \u0441\u043e \u0441\u043b\u043e\u0435\u043c DROPOUT (\u043d\u0435\u0441\u043c\u043e\u0442\u0440\u044f \u043d\u0430 \u0442\u043e, \u0447\u0442\u043e \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u043c\u043d\u043e\u0433\u043e \u043c\u043d\u0435\u043d\u0438\u0439 \u043e \u0442\u043e\u043c, \u0447\u0442\u043e \u043f\u0430\u0440\u0430\u043b\u0435\u043b\u044c\u043d\u043e \u044d\u0442\u0438 \u0434\u0432\u0430 \u043c\u043e\u043c\u0435\u043d\u0442\u0430 \u044d\u0442\u043e \u043e\u0432\u0435\u0440\u043a\u0438\u043b) \u043f\u043e \u0444\u0430\u043a\u0442\u0443 \u043d\u0430 \u044d\u0442\u043e\u043c \u043f\u0440\u0438\u043c\u0435\u0440\u0435 \u0432\u043c\u0435\u0441\u0442\u0435 \u0441\u0440\u0430\u0431\u043e\u0442\u0430\u043b\u0438 \u0445\u043e\u0440\u043e\u0448\u043e. \u0411\u0435\u0437 \u0440\u0435\u0433\u0443\u043b\u044f\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u0438 \u043d\u0430 \u0440\u0435\u0433\u0438\u043b\u044f\u0440\u0438\u0437\u0430\u0446\u0438\u0438 *l1* \u0441\u043a\u043e\u0440 \u0445\u0443\u0436\u0435.\n- \u043f\u043e\u043b\u0435\u0437\u043d\u044b\u0439 \u0445\u0430\u043a - \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043d\u0435\u0439\u0440\u043e\u043d\u043e\u0432 \u0441\u043c\u0435\u0449\u0435\u043d\u0438\u044f \u0438\u0437 \u0441\u043b\u043e\u044f (use_bias=False) \u043f\u0435\u0440\u0435\u0434 BatchNormalization - \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u044d\u043a\u043e\u043d\u043e\u043c\u0438\u0442\u044c \u0440\u0430\u0441\u0447\u0435\u0442\u043d\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u0438 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0432\u0435\u043d\u043d\u043e \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0442\u044c \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f\n\n\u042d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u044b \u043f\u0440\u043e\u0432\u043e\u0434\u0438\u043b\u0438\u0441\u044c \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u043c [\u043d\u043e\u0443\u0442\u0431\u0443\u043a\u0435](https:\/\/www.kaggle.com\/sokolovaleks\/sf-dst-10-car-classification-sokolov-3?scriptVersionId=50603588) \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430. \u041a\u0440\u043e\u043c\u0435 \u044d\u0442\u043e\u0433\u043e \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u043e\u0432 \u0432 [\u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435 \u043d\u0430 github](https:\/\/github.com\/alex-sokolov2011\/skillfactory_rds\/tree\/master\/module_7) \u0438\u043b\u0438 \u0432 [\u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435 \u043d\u0430 kaggle](https:\/\/www.kaggle.com\/sokolovaleks\/last-result).\n","7e4fea9c":"# 3. \u0420\u0430\u0437\u0432\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0430\u043d\u0430\u043b\u0438\u0437 \u0434\u0430\u043d\u043d\u044b\u0445 (EDA)\n## 3.1. \u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0430\u043d\u0430\u043b\u0438\u0437","da301bf2":"# I hope you like my kernel. Thanks for upvote\n\u041d\u0430\u0434\u0435\u044e\u0441\u044c \u043d\u043e\u0443\u0442\u0431\u0443\u043a \u0432\u0430\u043c \u043f\u043e\u043d\u0440\u0430\u0432\u0438\u043b\u0441\u044f. \u041d\u0435 \u0441\u0442\u0435\u0441\u043d\u044f\u0439\u0442\u0435\u0441\u044c \u043f\u0438\u0441\u0430\u0442\u044c \u0432\u043e\u043f\u0440\u043e\u0441\u044b \u043b\u0438\u0447\u043d\u043e \u0438 \u0432 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u044f\u0445. \u0422\u0430\u043a\u0436\u0435 \u0431\u0443\u0434\u0443 \u0440\u0430\u0434 \u043b\u044e\u0431\u044b\u043c \u0437\u0430\u043c\u0435\u0447\u0430\u043d\u0438\u044f\u043c \u0438 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u044f\u043c \u043f\u043e \u0443\u043b\u0443\u0447\u0448\u0435\u043d\u0438\u044e \u043d\u043e\u0443\u0442\u0430. \n\n\u041d\u0443 \u0438 \u0435\u0441\u043b\u0438 \u043d\u043e\u0443\u0442\u0431\u0443\u043a \u043f\u043e\u043a\u0430\u0437\u0430\u043b\u0441\u044f \u0432\u0430\u043c \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u043d\u044b\u043c \u0438\u043b\u0438 \u043f\u043e\u043b\u0435\u0437\u043d\u044b\u043c, \u0442\u043e \u044f \u0431\u0443\u0434\u0443 \u0431\u043b\u0430\u0433\u043e\u0434\u0430\u0440\u0435\u043d \u0432\u0430\u043c \u0437\u0430 \u0430\u043f\u0432\u043e\u0439\u0442[1]\n\n[1] ***\u0410\u043f\u0432\u043e\u0439\u0442 - \u043a\u043d\u043e\u043f\u043a\u0430 \u0441\u043e \u0441\u0442\u0440\u0435\u043b\u043a\u043e\u0439 \u0432\u0432\u0435\u0440\u0445 \u0447\u0443\u0442\u044c \u043d\u0438\u0436\u0435 \u044d\u0442\u0438\u0445 \u0441\u0442\u0440\u043e\u043a \u043f\u043e\u0434 \u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u043b\u0438\u043d\u0438\u0435\u0439 :)***","14abd866":"## 6.3 \u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438","ea56ae06":"# 8. \u0414\u043e\u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u043d\u0430 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u043d\u043e\u043c \u0440\u0430\u0437\u043c\u0435\u0440\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f (Extra Fit)\n## 8.1 \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u0438 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435","8f870387":"# 9. \u0424\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u043c \u0444\u0430\u0439\u043b \u0441 \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c \u043d\u0430 \u0442\u0435\u0441\u0442\u0435\n#### 9.1. \u041f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u0435 \u0431\u0435\u0437 TTA","32dc74cc":"***\u0420\u0435\u0437\u044e\u043c\u0435 \u043f\u043e Fine-Tuning \u042d\u0442\u0430\u043f 3:***\n- \u041a\u043e\u043b-\u0432\u043e \u044d\u043f\u043e\u0445 \u043f\u043e\u0434\u043e\u0431\u0440\u0430\u043d\u043e \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u043e (\u043d\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u044d\u043f\u043e\u0445\u0435 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0438\u0437-\u0437\u0430 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u044f \u0440\u043e\u0441\u0442\u0430 \u043d\u0430 4 \u044d\u043f\u043e\u0445\u0430\u0445)\n- \u042d\u0442\u0430\u043f 3 \u0432\u044b\u0440\u0430\u0441\u0442\u0438\u043b VAL_ACC \u043d\u0430 **0.13%** \u0441 0.9636 \u0434\u043e 0.9689 \u0438 \u0441\u043d\u0438\u0437\u0438\u043b\u043e VAL_LOSS \u043d\u0430 **9%** \u0441 0.2123 \u0434\u043e 0.1932\n- \u0421\u0440\u0435\u0434\u043d\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043e \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044e \u0441 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u043c \u044d\u0442\u0430\u043f\u043e\u043c: \u043f\u0430\u043a\u0435\u0442\u0430 batch \u043f\u043e\u0441\u043b\u0435 \u043f\u043e\u043b\u043d\u043e\u0439 \u0440\u0430\u0437\u043c\u043e\u0440\u043e\u0437\u043a\u0438 \u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u0432\u044b\u0440\u043e\u0441\u043b\u043e \u043d\u0430 **15%** \u0441 3 \u0441\u0435\u043a. \u0434\u043e 3.45, \u0441\u0440\u0435\u0434\u043d\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u044d\u043f\u043e\u0445\u0438 \u0432\u044b\u0440\u043e\u0441\u043b\u043e \u043d\u0430 **22%** \u0441 509 \u0434\u043e 626 \u0441\u0435\u043a, \u043e\u0431\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u043e\u043a\u0440\u0430\u0442\u0438\u043b\u043e\u0441\u044c \u0434\u043e 5011 \u0441 6109, \u043d\u043e \u044d\u0442\u043e \u0431\u044b\u043b\u043e \u0441\u0432\u044f\u0437\u0430\u043d\u043e \u043a 8 \u044d\u043f\u043e\u0445\u0430\u043c\u0438 \u0438\u0437-\u0437\u0430 \u0440\u0430\u043d\u043d\u0435\u0433\u043e \u0441\u0442\u043e\u043f\u0430 \u043f\u043e Callback\n- \u0428\u0430\u0433 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043f\u043e\u0434\u043e\u0431\u0440\u0430\u043d \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u043e\n- \u041f\u0440\u043e\u0432\u0435\u0440\u0438\u043b \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0435 \u043f\u043b\u0430\u0442\u043e \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e LR \u0434\u043e 2, \u043d\u043e \u044d\u0442\u043e \u043d\u0435 \u043f\u043e\u0432\u043b\u0438\u044f\u043b\u043e \u043d\u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f\n- sheduler \u043f\u043e\u043a\u0430\u0437\u0430\u043b \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u043e \u0444\u043e\u0440\u043c\u0443\u043b\u0435 (LR * math.pow(LR_UPDATE, math.floor((1+epoch)\/EPOCHS_DROP)) \u0438 \u043f\u0440\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0438 LR_UPDATE \u0440\u0430\u0432\u043d\u043e\u043c \u0435 \u0432 \u0441\u0442\u0435\u043f\u0435\u043d\u0438 \u043c\u0438\u043d\u0443\u0441 \u043e\u0434\u043d\u0430 \u0434\u0435\u0441\u044f\u0442\u0430\u044f","f105b8f8":"# 11. \u041e\u0447\u0438\u0441\u0442\u043a\u0430 \u0434\u0438\u0441\u043a\u0430 \u043f\u0435\u0440\u0435\u0434 RunAndSave","aa7ce691":"# 7. Transfer learning \u0441 Fine-tuning\n## 7.1 \u042d\u0442\u0430\u043f 1. \u0417\u0430\u043c\u043e\u0440\u0430\u0436\u0438\u0432\u0430\u0435\u043c \u0431\u0430\u0437\u043e\u0432\u0443\u044e \u0447\u0430\u0441\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u0438 \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e","014866f2":"4 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f = Lada 2107","4a27be57":"## 8.2 \u0420\u0435\u0437\u044e\u043c\u0435 \u043f\u043e \u0434\u043e\u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044e \u043d\u0430 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u043d\u043e\u043c \u0440\u0430\u0437\u043c\u0435\u0440\u0435\n- \u0414\u043e\u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u044b\u0440\u0430\u0441\u0442\u0438\u043b\u043e VAL_ACC \u043d\u0430 **0.52%** \u0441 0.969 \u0434\u043e 0.9741 \u0438 \u0441\u043d\u0438\u0437\u0438\u043b\u043e VAL_LOSS \u043d\u0430 **15%** \u0441 0.1932 \u0434\u043e 0.1698\n- \u041a\u043e\u043b-\u0432\u043e \u044d\u043f\u043e\u0445 \u043f\u043e\u0434\u043e\u0431\u0440\u0430\u043d\u043e \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u043e (\u043d\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u044d\u043f\u043e\u0445\u0435 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0438\u0437-\u0437\u0430 \u043e\u0442\u0441\u0443\u0442\u0441\u0432\u0438\u044f \u0440\u043e\u0441\u0442\u0430 \u043d\u0430 4 \u044d\u043f\u043e\u0445\u0430\u0445)\n- \u0423\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0435 \u043f\u043b\u0430\u0442\u043e \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e LR \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043f\u043e\u0432\u043b\u0438\u044f\u043b\u043e \u043d\u0430 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435, \u0442\u0430\u043a \u043a\u0430\u043a \u0438\u043c\u0435\u043d\u043d\u043e \u043d\u0430 \u0432\u0442\u043e\u0440\u043e\u043c \u043a\u0440\u0443\u0433\u0435 \u0434\u043e\u0441\u0442\u0438\u0433\u0430\u043b\u0438\u0441\u044c \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\n- \u041e\u0431\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438 \u0441\u043e\u0441\u0442\u0430\u0432\u0438\u043b\u043e 38152 \u0441\u0435\u043a. (=7192+6109+5011+19840). \u042d\u0442\u043e \u043f\u0440\u0438\u043c\u0435\u0440\u043d\u043e 10.5 \u0447\u0430\u0441\u043e\u0432.","85dd6039":"# 5. \u041f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0439 \u0434\u043b\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438 (\u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f)","e26fbe49":"9 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f - Lada Samara 21099","ac755b82":"#### 3.2. \u0412\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0430\u043d\u0430\u043b\u0438\u0437 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a","a1dd12d6":"# 10. \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b:  \n- score \u043d\u0430 kaggle = 0.97558 (7 \u043c\u0435\u0441\u0442\u043e, Top 6%)  \n- \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f FT (EfficientNetB3, size=320, batch=32, Custom Head(128, Batch Normalization, use_bias=False, callback(MC_ES_LRS_T), \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043b\u0443\u0447\u0448\u0435 \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0432 \u043d\u043e\u0443\u0442\u0431\u0443\u043a\u0435)\n- \u0434\u043e\u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043d\u0430 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u043d\u043e\u043c \u0440\u0430\u0437\u043c\u0435\u0440\u0435 \u0444\u043e\u0442\u043e (size=520, batch=**12**) \u0432\u044b\u0440\u0430\u0441\u0442\u0438\u043b\u043e VAL_ACC \u043d\u0430 0.52% \u0441 0.969 \u0434\u043e 0.9741\n- score \u0431\u0435\u0437 TTA - 0.97423\n- score c TTA - 0.97558 (+0.13%)\n- \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u044d\u0442\u0430\u043f\u044b \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0435\u043a\u0442\u0430 \u0441 \u0442\u0430\u0439\u043c\u0438\u043d\u0433\u043e\u043c \u043c\u043e\u0436\u043d\u043e \u043d\u0430 [github](https:\/\/github.com\/alex-sokolov2011\/skillfactory_rds\/tree\/master\/module_7). \u0422\u0430\u043c \u0436\u0435:\n  - \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0432\u0441\u0435\u0445 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u043e\u0432 \u0432 \u0432\u0438\u0434\u0435 Pandas-\u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430 \n  - \u0438\u0441\u0445\u043e\u0434\u043d\u0438\u043a \u0444\u0430\u0439\u043b\u0430 utils_module09122020 \u0441\u043e \u0432\u0441\u0435\u043c\u0438 \u0443\u0442\u0438\u043b\u0438\u0442\u0430\u043c\u0438\n- \u043a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e \u043b\u0443\u0447\u0448\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043d\u0430 \u0433\u0438\u0442\u0445\u0430\u0431 \u0438\u0437-\u0437\u0430 \u0438\u0445 \u043e\u0431\u044a\u0435\u043c\u0430, \u043d\u043e \u043f\u0440\u0438 \u0436\u0435\u043b\u0430\u043d\u0438\u0438 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u0438\u0445 \u0438\u0437 \u043e\u0442\u043a\u0440\u044b\u0442\u043e\u0433\u043e [\u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430](https:\/\/www.kaggle.com\/sokolovaleks\/last-result) \n\n\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e \u043d\u0435 \u0445\u0432\u0430\u0442\u0438\u043b\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438, \u0447\u0442\u043e\u0431\u044b:  \n- \u0432\u044b\u0447\u0438\u0441\u043b\u0438\u0442\u044c \u043d\u0430 \u043a\u0430\u043a\u0438\u0445 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0430\u0445 \u043e\u0448\u0438\u0431\u0430\u0435\u0442\u0441\u044f \u043c\u043e\u0434\u0435\u043b\u044c\n- \u043f\u043e\u043f\u044b\u0442\u0430\u0442\u044c\u0441\u044f \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u044d\u0442\u043e\u0442 \u043a\u043b\u0430\u0441\u0441 \u0444\u043e\u0442\u043e \u0438\u0437\u0432\u043d\u0435 \u0432\u043d\u0435\u0448\u043d\u0438\u043c \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u043e\u043c\n- \u0434\u043e\u043e\u0431\u0443\u0447\u0438\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c \u043d\u0430 \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u043f\u0440\u0438\u043c\u0435\u0440\u0430\u0445 (\u0432 \u0442\u043e\u043c \u0447\u0438\u0441\u043b\u0435: \n  - 7 \u043a\u0430\u0442. - \u041b\u0430\u0434\u0430 2109, \u0430 9 \u043a\u0430\u0442. - \u041b\u0430\u0434\u0430 21099, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u0442\u043b\u0438\u0447\u0430\u044e\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0438\u043f\u043e\u043c \u043a\u0443\u0437\u043e\u0432\u0430 \u0441\u0437\u0430\u0434\u0438. \u0421\u043f\u0435\u0440\u0435\u0434\u0438 \u044d\u0442\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 \u0432\u044b\u043f\u0443\u0441\u043a\u0430\u044e\u0442\u0441\u044f \u043d\u0430 \u044d\u0434\u0435\u043d\u0442\u0438\u0447\u043d\u044b\u0445 \u0437\u0430\u043f\u0447\u0430\u0441\u0442\u044f\u0445. \u041f\u043e\u044d\u0442\u043e\u043c\u0443 \u0444\u043e\u0442\u043e \u0441\u043f\u0435\u0440\u0435\u0434\u0438 \u043f\u043e \u044d\u0442\u0438\u043c \u043c\u043e\u0434\u0435\u043b\u044f\u043c \u043d\u0435 \u043e\u0442\u043b\u0438\u0447\u0438\u043c\u044b \u0432 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u0435. \n  - \u043f\u0435\u0440\u0432\u0430\u044f \u0444\u043e\u0442\u043e \u0432 \u0442\u0435\u0441\u0442\u0435 305108.jpg \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0441\u044f \u043a \u043a\u0430\u0442. 2 - Lada Samara 2114 \u0438\u0437-\u0437\u0430 \u043d\u0430\u043b\u0438\u0447\u0438\u044f \u043c\u043e\u043b\u0434\u0438\u043d\u0433\u0430. \u041d\u043e \u0442\u0430\u043a \u043a\u0430\u043a \u0444\u043e\u0442\u043e \u0441\u0434\u0435\u043b\u0430\u043d\u043e \u0432 \u0442\u0435\u043c\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f \u0441\u0443\u0442\u043e\u043a \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u043d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 \u0447\u0442\u043e\u0431\u044b \u0432\u044b\u043a\u0440\u0443\u0442\u0438\u0442\u044c \u044f\u0440\u043a\u043e\u0441\u0442\u044c \u0438 \u043e\u043d\u0430 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u0446\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043a\u0430\u043a 7 \u0438 9 \u043a\u0430\u0442. \u041c\u043e\u0436\u043d\u043e \u0431\u044b\u043b\u043e \u0431\u044b \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u043f\u0440\u043e\u043c\u0435\u0436\u0443\u0442\u043e\u0447\u043d\u0443\u044e \u0441\u0435\u0442\u044c, \u0447\u0442\u043e\u0431\u044b \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043c\u043d\u044b\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0438 \u0434\u043e\u0443\u0447\u0438\u0442\u044c \u043d\u0430 \u043d\u0438\u0445 \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u043b\u0438 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e \u043f\u0440\u043e\u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u0442\u044c, \u043d\u043e \u044d\u0442\u043e \u0443\u0436\u0435 \u0431\u0443\u0434\u0435\u0442 \u043d\u0435 Single Model.\n- \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u0432\u044b\u0431\u0440\u043e\u0441\u043e\u0432 \u0432 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043e\u0431\u0443\u0447\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 (\u044f \u0442\u0430\u043c \u043a\u0440\u0430\u0435\u043c \u0433\u043b\u0430\u0437\u0430 \u0432\u0438\u0434\u0435\u043b \u0433\u0440\u0443\u0437\u043e\u0432\u0438\u043a :) \u043a\u043e\u0433\u0434\u0430 \u043f\u0440\u043e\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u043b \u0444\u043e\u0442\u043e)","8f5c4230":"## 6.2 \u041e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438","1bda4cc3":"\u0420\u0435\u0437\u044e\u043c\u0435: \n- \u0414\u043b\u044f \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u044b \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438 10 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0430\u0432\u0442\u043e Lada\n- \u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0441\u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b \u043f\u043e \u043a\u043e\u043b-\u0432\u0443 \u0444\u043e\u0442\u043e\n- \u0420\u0430\u0437\u043c\u0435\u0440\u044b \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0439 \u0440\u0430\u0437\u043b\u0438\u0447\u0430\u044e\u0442\u0441\u044f, \u043d\u043e \u0432 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u043c 640 \u043d\u0430 480. \u0426\u0432\u0435\u0442\u043d\u044b\u0435.\n- \u0412\u0441\u0435\u0433\u043e 22236 \u0444\u043e\u0442\u043e \u0432 \u0442\u043e\u043c \u0447\u0438\u0441\u043b\u0435:15561 \u0444\u043e\u0442\u043e \u0432 \u0442\u0440\u0435\u0439\u043d\u0435 \u0438 6675 \u0432 \u0442\u0435\u0441\u0442\u0435\n- \u041a\u043e\u043b-\u0432\u043e \u0444\u043e\u0442\u043e \u0432 \u0442\u0440\u0435\u0439\u043d\u0435 \u043d\u0435 \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0434\u043b\u044f \u0445\u043e\u0440\u043e\u0448\u0435\u0433\u043e \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438 \u043d\u0435\u0439\u0440\u043e\u043d\u043d\u043e\u0439 \u0441\u0435\u0442\u0438, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u0431\u0443\u0434\u0435\u043c \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0442\u044c \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u0432\u0438\u0434\u044b \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445","420c914b":"# 6. \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0438 \u043f\u0440\u0435\u0434\u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u043d\u0435\u0439\u0440\u043e\u0441\u0435\u0442\u0438\n## 6.1 \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438","9832b565":"## 1.2. \u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043d\u0441\u0442\u0430\u043d\u0442\u044b","d9f279aa":"7 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f - Lada Samara 2109","28c17a05":"0 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f = Lada Priora","4dab3984":"***\u0420\u0435\u0437\u044e\u043c\u0435 \u043f\u043e Fine-Tuning \u042d\u0442\u0430\u043f 2:***\n- \u041f\u043e \u0433\u0440\u0430\u0444\u0438\u043a\u0443 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0438 \u043c\u043e\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434, \u0447\u0442\u043e \u043a\u043e\u043b-\u0432\u043e \u044d\u043f\u043e\u0445 \u043f\u043e\u0434\u043e\u0431\u0440\u0430\u043d\u043e \u043d\u0435 \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u0442\u0430\u043a \u043a\u0430\u043a \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u0438 \u043f\u043e\u0442\u0435\u0440\u0438 \u043d\u0430\u0447\u0430\u043b\u0438 \u043d\u0430\u0431\u0438\u0440\u0430\u0442\u044c \u0442\u0435\u043c\u043f. \u041d\u0430\u0432\u0435\u0440\u043d\u044f\u043a\u0430 \u0441\u0442\u043e\u0438\u043b\u043e \u0434\u043e\u043e\u0431\u0443\u0447\u0438\u0442\u044c \u0434\u043e 15 \u044d\u043f\u043e\u0445 \u0438 \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0447\u0442\u043e \u0442\u0430\u043c, \u043d\u043e \u043c\u043d\u0435 \u0431\u044b\u043b\u043e \u043b\u0435\u043d\u044c \u0434\u0435\u043b\u0430\u0442\u044c \u0435\u0449\u0435 \u043e\u0434\u0438\u043d \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442, \u043f\u043e\u0442\u043e\u043c\u0443 \u0447\u0442\u043e \u044f \u0437\u0430\u043c\u0435\u0442\u0438\u043b \u044d\u0442\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u043d\u0430\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0440\u0435\u0437\u044e\u043c\u0435.\n- \u0421\u0440\u0435\u0434\u043d\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u0430\u043a\u0435\u0442\u0430 batch \u043f\u043e\u0441\u043b\u0435 \u0440\u0430\u0437\u043c\u043e\u0440\u043e\u0437\u043a\u0438 \u043f\u043e\u043b\u043e\u0432\u0438\u043d\u044b \u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u0432\u044b\u0440\u043e\u0441\u043b\u043e \u043d\u0430 **27%** \u0441 2.35 \u0441\u0435\u043a. \u0434\u043e 3, \u0441\u0440\u0435\u0434\u043d\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u044d\u043f\u043e\u0445\u0438 \u0432\u044b\u0440\u043e\u0441\u043b\u043e \u043d\u0430 **7%** \u0441 479 \u0434\u043e 509 \u0441\u0435\u043a. \u041f\u0440\u0438 \u044d\u0442\u043e\u043c \u043e\u0431\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u043e\u043a\u0440\u0430\u0442\u0438\u043b\u043e\u0441\u044c \u0434\u043e 6109 \u0441\u0435\u043a. \u0441 7192, \u044d\u0442\u043e \u0441\u0432\u044f\u0437\u0430\u043d\u043e \u0441 \u0442\u0435\u043c \u0447\u0442\u043e \u043a\u043e\u043b\u0432\u043e \u044d\u043f\u043e\u0445 \u0441\u043e\u043a\u0440\u0430\u0442\u0438\u043b\u043e\u0441\u044c \u0441 15 \u0434\u043e 12. \u0423\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0435 \u0441\u0440\u0435\u0434\u043d\u0435\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043d\u0430 \u044d\u043f\u043e\u0445\u0435 \u0432\u0441\u0435\u0433\u043e \u043d\u0430 7% \u043e\u0447\u0435\u043d\u044c \u0432\u0434\u043e\u0445\u043d\u043e\u0432\u043b\u044f\u0435\u0442, \u0445\u043e\u0442\u044f \u043a\u043e\u043b-\u0432\u043e \u0442\u0440\u0435\u043d\u0438\u0440\u0443\u0435\u043c\u044b\u0445 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0432\u044b\u0440\u043e\u0441\u043b\u043e \u0441 198154 \u0434\u043e 10,021,992. \u042f \u044d\u0442\u043e \u0441\u0432\u044f\u0437\u044b\u0432\u0430\u044e \u0441 \u0442\u0435\u043c, \u0447\u0442\u043e \u0432\u0441\u0435-\u0442\u0430\u043a\u0438 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0430 \u0441 \u043d\u0443\u043b\u044f \u0431\u043e\u043b\u0435\u0435 \u0442\u0440\u0443\u0434\u043e\u0435\u043c\u043a\u0430\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044f \u0438 \u044d\u0442\u043e \u0432\u0438\u0434\u043d\u043e \u043d\u0430 \u044d\u0442\u043e\u043c \u043f\u0440\u0438\u043c\u0435\u0440\u0435, \u0447\u0442\u043e \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u0435\u0449\u0435 \u0440\u0430\u0437 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0430\u0435\u0442 \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043c\u0435\u0442\u043e\u0434\u0430 \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0430 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f (Transfer learning)\n- \u042d\u0442\u0430\u043f 2 \u0432\u044b\u0440\u0430\u0441\u0442\u0438\u043b VAL_ACC \u043d\u0430 **12%** \u0441 0.8642 \u0434\u043e 0.9636 \u0438 \u0441\u043d\u0438\u0437\u0438\u043b\u043e VAL_LOSS \u043d\u0430 **67%** \u0441 0.6523 \u0434\u043e 0.2123\n- \u0428\u0430\u0433 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043f\u043e\u0434\u043e\u0431\u0440\u0430\u043d \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u043e\n- \u041f\u0440\u043e\u0432\u0435\u0440\u0438\u043b \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0435 \u043f\u043b\u0430\u0442\u043e \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e LR \u0434\u043e 2, \u043d\u043e \u044d\u0442\u043e \u043d\u0435 \u043f\u043e\u0432\u043b\u0438\u044f\u043b\u043e \u043d\u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f\n- sheduler \u043f\u043e\u043a\u0430\u0437\u0430\u043b \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u043e \u0444\u043e\u0440\u043c\u0443\u043b\u0435 (LR * math.pow(LR_UPDATE, math.floor((1+epoch)\/EPOCHS_DROP)) \u0438 \u043f\u0440\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0438 LR_UPDATE \u0440\u0430\u0432\u043d\u043e\u043c ***\u0435*** \u0432 \u0441\u0442\u0435\u043f\u0435\u043d\u0438 \u043c\u0438\u043d\u0443\u0441 \u043e\u0434\u043d\u0430 \u0434\u0435\u0441\u044f\u0442\u0430\u044f","a90c7500":"5 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f - Lada Niva","d5078bd0":"## 6.4 \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438","887a1f1e":"2 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f = Lada Samara 2114","24c5a8ae":"***\u0420\u0435\u0437\u044e\u043c\u0435 \u043f\u043e Fine-Tuning \u042d\u0442\u0430\u043f 1:***\n- \u041f\u043e \u0433\u0440\u0430\u0444\u0438\u043a\u0443 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0438 (val_acc \u0441\u0432\u0435\u0440\u0445\u0443 \u043d\u0430\u0434 acc) \u043c\u043e\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434, \u0447\u0442\u043e \u043a\u043e\u043b-\u0432\u043e \u044d\u043f\u043e\u0445 \u043f\u043e\u0434\u043e\u0431\u0440\u0430\u043d\u043e \u043d\u0435 \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u0438 \u0443 \u043c\u043e\u0434\u0435\u043b\u0438 \u0435\u0441\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0437\u0430\u043f\u0430\u0441 \u0432 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u0438 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0438 \u044d\u043f\u043e\u0445. \u041d\u043e \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0430 \u043f\u043e \u0433\u043b\u0443\u0431\u043e\u043a\u043e\u043c\u0443 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044e \u044f \u0440\u0435\u0448\u0438\u043b \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0442\u0441\u044f 15 \u044d\u043f\u043e\u0445\u0430\u043c\u0438, \u0447\u0442\u043e\u0431\u044b \u043b\u0443\u0447\u0448\u0435 \u0440\u0430\u0437\u043e\u0431\u0440\u0430\u0442\u044c\u0441\u044f \u0432\u043e \u0432\u0441\u0435\u0445 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u0430\u0445 \u0438 \u043f\u043e\u043f\u044b\u0442\u0430\u0442\u044c\u0441\u044f \u0432\u044b\u0436\u0430\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c \u043d\u0430 15 \u044d\u043f\u043e\u0445\u0430\u0445 (\u0438 \u043f\u043e \u043e\u0431\u044a\u0435\u043c\u0443 \u043d\u0435 \u0432\u044b\u0448\u0435 EfficientNetB3 = 48 MB).\n- \u0417\u0430\u0431\u0435\u0433\u0430\u044f \u0432\u043f\u0435\u0440\u0435\u0434 \u0441\u0440\u0435\u0434\u043d\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043e\u0434\u043d\u043e\u0439 \u044d\u043f\u043e\u0445\u0438 \u043d\u0430 1 \u042d\u0442\u0430\u043f\u0435 \u0432 \u0441\u0440\u0435\u0434\u043d\u0435\u043c (480 \u0441\u0435\u043a) \u043f\u0440\u043e\u0442\u0438\u0432 (1650 \u0441\u0435\u043a) \u043d\u0430 \u0434\u043e\u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438 \u043d\u0430 \u0431\u043e\u043b\u044c\u0448\u0438\u0445 \u0440\u0430\u0437\u043c\u0435\u0440\u0430\u0445 \u0444\u043e\u0442\u043e, \u0447\u0442\u043e \u043d\u0430\u0432\u043e\u0434\u0438\u0442 \u043d\u0430 \u043c\u044b\u0441\u043b\u044c \u0447\u0442\u043e \u043d\u0430 \u044d\u0442\u043e\u043c \u044d\u0442\u0430\u043f\u0435 \u0441\u043e\u0441\u0440\u0435\u0434\u043e\u0442\u043e\u0447\u0435\u043d \u0441\u0430\u043c\u044b\u0439 \u0432\u0430\u0436\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u0443\u0441\u043f\u0435\u0445\u0430 \u043d\u0430 \u043b\u0431. \u0420\u0438\u0441\u043a\u043d\u0443 \u043f\u0440\u0435\u0434\u043f\u043e\u043b\u043e\u0436\u0438\u0442\u044c, \u0447\u0442\u043e \u043b\u0443\u0447\u0448\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0441\u0438\u043d\u0433\u043b \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u043d\u0430 \u043b\u0431 \u0431\u044b\u043b\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u044b \u043d\u0430 \u0431\u043e\u043b\u044c\u0448\u0435\u043c \u043a\u043e\u043b-\u0432\u0435 \u044d\u043f\u043e\u0445 \u0438 \u0431\u043e\u043b\u0435\u0435 \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u044f\u0445 \u0432\u044b\u0448\u0435 EfficientNetB3\n- \u043d\u0430 \u043c\u043e\u0439 \u0432\u0437\u0433\u043b\u044f\u0434 \u0448\u0430\u0433 \u043f\u043e\u0434\u043e\u0431\u0440\u0430\u043d \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u043e, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u044c \u0432 \u043f\u043b\u0430\u0442\u043e \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e LR \u044f \u043d\u0435 \u0443\u0432\u0438\u0434\u0435\u043b, \u0442\u0430\u043a \u043a\u0430\u043a \u0433\u0440\u0430\u0444\u0438\u043a\u0438 \u0438\u043c\u0435\u044e\u0442 \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0445\u043e\u0440\u043e\u0448\u0438\u0439 \u043d\u0430\u043a\u043b\u043e\u043d \u043d\u0430 \u0434\u0430\u043d\u043d\u043e\u043c \u043a\u043e\u043b-\u0432\u0435 \u044d\u043f\u043e\u0445. \u0417\u0430\u043c\u0435\u0434\u043b\u0435\u043d\u0438\u0435 \u0442\u0435\u043d\u0434\u0435\u043d\u0446\u0438\u0438 \u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f \u043b\u0438\u043d\u0438\u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0442\u0435\u0440\u044c \u0437\u0430\u043c\u0435\u0442\u043d\u043e \u043d\u0430\u0447\u0438\u043d\u0430\u044f \u0441 14 \u044d\u043f\u043e\u0445\u0438, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u0442\u0435\u043c \u043a\u0442\u043e \u0440\u0435\u0448\u0438\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435\u0435 \u043a\u043e\u043b-\u0432\u043e \u044d\u043f\u043e\u0445 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u044e \u0437\u0430\u0448\u0438\u0442\u044c \u0432 sheduler \u043f\u043b\u0430\u0442\u043e \u0444\u0438\u043a\u0441\u043e\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0448\u0430\u0433\u0430 \u043d\u0430 2-3 \u044d\u043f\u043e\u0445\u0438\n- \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u043c\u0435\u0442\u043e\u0434\u043e\u043c evalute \u0438 \u0432\u043d\u0443\u0442\u0440\u0438 \u043c\u0435\u0442\u043e\u0434\u0430 fit_generator \u043e\u0442\u043b\u0438\u0447\u0430\u0435\u0442\u0441\u044f. \u041d\u043e \u0447\u0442\u043e\u0431\u044b \u0441\u0432\u0435\u0441\u0442\u0438 \u0438\u0445 \u043a \u0435\u0434\u0438\u043d\u043e\u043e\u0431\u0440\u0430\u0437\u0438\u044e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043e\u0442\u043a\u0430\u0437\u0430\u0442\u044c\u0441\u044f \u043e\u0442 \u043c\u0443\u043b\u044c\u0442\u0438\u0441\u0435\u0441\u0441\u0438\u043e\u043d\u043d\u043e\u0441\u0442\u0438 (use_multiprocessing=False), \u043d\u043e \u044d\u0442\u043e \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u0442 \u0432\u0440\u0435\u043c\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043f\u0440\u0438\u043c\u0435\u0440\u043d\u043e \u043d\u0430 20%. \u041d\u0430 \u044d\u0442\u0430\u043f\u0435 \u0442\u043e\u043d\u043a\u043e\u0439 \u043d\u0430\u0441\u0442\u0440\u043e\u043a\u0438 \u043d\u0435 \u043a\u0440\u0438\u0442\u0438\u0447\u043d\u043e, \u043d\u043e \u0437\u0430\u0431\u0435\u0433\u0430\u044f \u0432\u043f\u0435\u0440\u0435\u0434 \u043d\u0430 \u0434\u043e\u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438 \u0433\u0434\u0435 \u043e\u0431\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f 19840 \u0441\u0435\u043a. \u044d\u0442\u043e \u0441\u0442\u0430\u043b\u043e \u0431\u044b \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u043e\u0439, \u0430 \u043c\u043d\u0435 \u0445\u043e\u0442\u0435\u043b\u043e\u0441\u044c \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u044d\u0434\u0435\u043d\u0442\u0438\u0447\u043d\u043e\u0441\u0442\u044c \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u043d\u0430 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438 \u0438 \u043d\u0430 \u0434\u043e\u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 \u0438 \u043c\u0435\u043d\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e \u0438 \u0440\u0430\u0437\u043c\u0435\u0440 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f.","9788ba04":"# 2. \u0418\u043c\u043f\u043e\u0440\u0442 \u0438 \u043f\u0440\u0435\u0434\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445\n## 2.1. \u0418\u043c\u043f\u043e\u0440\u0442 \u0434\u0430\u043d\u043d\u044b\u0445","aaca6d32":"## 7.2 \u042d\u0442\u0430\u043f 2. \u0420\u0430\u0437\u043c\u043e\u0440\u043e\u0437\u043a\u0430 \u043f\u043e\u043b\u043e\u0432\u0438\u043d\u044b \u0441\u043b\u043e\u0435\u0432 \u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438","8c9922b4":"## 1.3. \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 GPU","b4ae948b":"1 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f = Ford Focus","58e57dbc":"6 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f - Lada Kalina","eabd4088":"### \u0418\u0442\u043e\u0433\u043e\u0432\u043e\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u0435 \u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440\u0430 \u0421\u043e\u043a\u043e\u043b\u043e\u0432\u0430\n### \u043f\u043e \u041f\u0440\u043e\u0435\u043a\u0442\u0443 7. Ford vs Ferrari: \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c \u0430\u0432\u0442\u043e \u043f\u043e \u0444\u043e\u0442\u043e\n####   \u042e\u043d\u0438\u0442 8. \u041d\u0435\u0439\u0440\u043e\u043d\u043d\u044b\u0435 \u0441\u0435\u0442\u0438 (\u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d 13.01.2021)\n---\n\n# 1. \u0418\u043c\u043f\u043e\u0440\u0442\u044b \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a, \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0445 \u043a\u043e\u043d\u0441\u0442\u0430\u043d\u0442, \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0438 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f\n## 1.1. \u0418\u043c\u043f\u043e\u0440\u0442\u044b \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a","410f4d45":"3 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f = Lada 110","a121ffcc":"## 7.3 \u042d\u0442\u0430\u043f 3. \u0420\u0430\u0437\u043c\u043e\u0440\u043e\u0437\u043a\u0430 \u0432\u0441\u0435\u0445 \u0441\u043b\u043e\u0435\u0432 \u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438","cb070689":"# 4. \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430 \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0412\u0421\u0415\u0425! \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u043e\u0432\n\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0438 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044f \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u044d\u0442\u0430\u043f\u043e\u0432:\n- \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e \u0434\u0430\u043d\u043d\u044b\u0445 (AUG)\n- \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0443 \u043e\u0441\u043d\u043e\u0432\u044b \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 (M)\n- \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b \u0433\u043e\u043b\u043e\u0432\u044b (H)\n- \u043a\u043e\u043c\u043f\u0438\u043b\u044f\u0446\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438 (C)\n- \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 - \u044d\u0442\u043e \u044d\u0442\u0430\u043f \u043c\u043d\u043e\u0433\u043e\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0445 \u043d\u0435\u0431\u043e\u043b\u044c\u0448\u0438\u0445 \u043f\u043e \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u043e\u0432 \u0434\u043b\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0434\u043b\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438\n- \u0434\u043e\u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 Fine-tuning  \n\n\u041d\u0430 \u043a\u0430\u0436\u0434\u043e\u043c \u044d\u0442\u0430\u043f\u0435 \u043d\u0430\u043c \u043f\u043e\u0442\u0440\u0435\u0431\u0443\u044e\u0442\u0441\u044f \u043a\u0430\u043a\u0438\u0435-\u0442\u043e \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b. \u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 h5(hdf5) \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0430\u0441\u0442\u0438\u0447\u043d\u043e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u0441 \u044d\u0442\u0430\u043f\u043e\u0432 (M) \u0438 (H) \u0441 \u043e\u0431\u0443\u0447\u0435\u043d\u043d\u044b\u043c\u0438 \u0432\u0435\u0441\u0430\u043c\u0438 \u043c\u043e\u0434\u0435\u043b\u0438. \u041c\u043d\u0435 \u043e\u043a\u0430\u0437\u0430\u043b\u043e\u0441\u044c \u044d\u0442\u043e\u0433\u043e \u043d\u0435 \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0434\u043b\u044f \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0445 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u044f \u0440\u0435\u0448\u0438\u043b \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u0430\u0442\u0430\u0441\u0435\u0442 \u0441 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\u043c\u0438 (R) \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u043e\u0432.","b10c48ac":"## 2.2. \u041f\u0440\u0435\u0434\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445","156a3d05":"## 9.2. \u041f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u0435 c TTA (Test time augmentation)"}}