{"cell_type":{"faa84e6a":"code","156ae4b0":"code","a3a024ba":"code","2b34d699":"code","8d88f543":"code","e81a451d":"code","2522c30e":"code","0a412aac":"code","62decee7":"code","70fdb7ce":"code","aafa882e":"code","a358d2fb":"code","3640b0e7":"code","7ee24592":"code","cb655a9a":"code","aa8a070a":"code","817c686e":"code","51360541":"code","d1606b68":"code","1b77be00":"code","33a0017e":"code","227b18b3":"code","25a31f86":"code","a7b3df07":"code","8a937fc4":"code","2a58c050":"code","aa779ffb":"code","1836432c":"code","5eb93d30":"code","d402797a":"code","b9feb8a2":"code","6e62974f":"code","9a3c2b5b":"code","6a8300e4":"code","f18867c3":"code","24fa5ead":"code","38105555":"code","d20def99":"code","bf30f4ad":"code","7f4c44c1":"code","f92f1375":"code","0e8c829e":"code","f1226891":"code","5b54a22e":"code","dec4ddb2":"code","ee59390d":"code","76929a22":"code","c4aa5b24":"code","e66cc4db":"code","441c981f":"code","5127416a":"code","f9bf9011":"code","bff8dcb6":"code","c2f2a361":"code","67d0941f":"code","d9936ebb":"code","ffd7525e":"code","f0726217":"code","f20fd9cf":"code","69d6e93b":"markdown","470fe4f4":"markdown","5777083c":"markdown","9c85b6e8":"markdown","18d9f40e":"markdown","b97dd7dc":"markdown","008b6807":"markdown","45a1539c":"markdown","9a7518ea":"markdown","49e9d280":"markdown","076bfa3a":"markdown","2cc68bf3":"markdown","3b71737c":"markdown","d571e287":"markdown","3269a305":"markdown","95836159":"markdown","93960d7a":"markdown","a3fe044a":"markdown","13e89d9c":"markdown","3cd8e230":"markdown","a3f2e3cf":"markdown","b0bf2d13":"markdown","9cd67b43":"markdown","37415a34":"markdown","6b69f576":"markdown","11bd4add":"markdown","95ac40ad":"markdown","b411a9ba":"markdown","051390e1":"markdown"},"source":{"faa84e6a":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.graph_objects as go\nimport plotly.express as px\n\n#importing libraries to use the library functions","156ae4b0":"train=pd.read_csv('..\/input\/insurance-cost-prediction\/train.csv')\n#train contains the file information  which is in csv format","a3a024ba":"train.head()","2b34d699":"train.columns\n#listing the column names of the dataset\/dataframe","8d88f543":"train.dtypes\n#checking the datatypes of different columns of the dataframe","e81a451d":"train.shape\n#shape of the dataframe ie no. of rows and columns","2522c30e":"train.duplicated().sum()\n#checking for any duplicates in the data","0a412aac":"train.isnull().sum()\n#checking for any null values in the data","62decee7":"train.info()\n#getting the information of dataframe such as no. of entries,data columns,non-null count,data types,etc","70fdb7ce":"train.describe()\n#checking for statistical summary such as count,mean,etc. of numeric columns","aafa882e":"sns.countplot(train.sex)\nplt.show()","a358d2fb":"sns.countplot(train.children,color=[0.3,0.9,0.0])\nplt.show()","3640b0e7":"sns.countplot(train.smoker,palette='Set1')\nplt.show()","7ee24592":"sns.countplot(train.region,color=[0.0,0.7,1.0])\nplt.show()","cb655a9a":"plt.hist(train.age, edgecolor='black', color='orange')\nplt.xlabel('Age')\nplt.ylabel('Count')\nplt.show()","aa8a070a":"sns.displot(train.bmi, color='darkviolet')\nplt.show()","817c686e":"sns.displot(train.charges, color='yellow')\nplt.show()","51360541":"#converting categorical columns to numerical ones\nfrom sklearn.preprocessing import LabelEncoder\n\nnumber = LabelEncoder()\ntrain['sex'] = number.fit_transform(train['sex'].astype('str'))\ntrain['smoker'] = number.fit_transform(train['smoker'].astype('str'))\ntrain['region'] = number.fit_transform(train['region'].astype('str'))\n\ntrain.head()","d1606b68":"sns.boxplot(data=train,orient='h',palette='Set2')\n#checking for any outliers in the data","1b77be00":"sns.boxplot(x=train['bmi'],palette='Set3')","33a0017e":"sns.boxplot(x=train['charges'],palette='Set1')","227b18b3":"Q1 = train.quantile(0.25)\nQ3 = train.quantile(0.75)\nIQR = Q3 - Q1\nprint(IQR)","25a31f86":"from scipy import stats\nz = np.abs(stats.zscore(train))\nprint(z)","a7b3df07":"threshold = 3\nprint(np.where(z > 3))","8a937fc4":"train=train[(z < 3).all(axis = 1)]","2a58c050":"train.shape","aa779ffb":"train.corr()\n#finding the correlation between different variables\/features","1836432c":"train_corr=train.corr()\nf,ax=plt.subplots(figsize=(12,7))\nsns.heatmap(train_corr,cmap='plasma',annot=True)\nplt.title(\"Correlation between features\",weight='bold',fontsize=18)\nplt.show()\n\n#plotting the heatmap for different features","5eb93d30":"X = train.drop('charges', axis = 1)\ny = train['charges']","d402797a":"categorical_val = []\ncontinous_val = []\nfor column in X.columns:\n    print('-------------------------------------------------------------------------------')\n    print(f\"{column} : {X[column].unique()}\")\n    if len(X[column].unique()) <= 4:\n        categorical_val.append(column)\n    else:\n        continous_val.append(column)","b9feb8a2":"categorical_val","6e62974f":"X = pd.get_dummies(X, columns = categorical_val)","9a3c2b5b":"X.head()","6a8300e4":"from sklearn.preprocessing import StandardScaler\n\ns_sc = StandardScaler()\ncol_to_scale = continous_val\nX[col_to_scale] = s_sc.fit_transform(X[col_to_scale])","f18867c3":"X.head()","24fa5ead":"# splitting the dataset into training and test sets\n\nfrom sklearn.model_selection import train_test_split\n\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size = 0.2, random_state = 0)\n\nprint(X_train.shape)\nprint(y_train.shape)\nprint(X_test.shape)\nprint(y_test.shape)","38105555":"from sklearn.linear_model import LinearRegression\nlr = LinearRegression()\nlr.fit(X_train,y_train)\ny_predict = lr.predict(X_train)\n\n# calculating the accuracies\nprint(\"Training Accuracy :\",lr.score(X_train,y_train)*100)\nprint(\"Testing Accuracy :\",lr.score(X_test,y_test)*100)","d20def99":"from sklearn.metrics import mean_squared_error,r2_score\nprint(\"Model Accuracy\",r2_score(y,lr.predict(X))*100)","bf30f4ad":"fig = px.scatter(x = y_train, y = y_predict, color_discrete_sequence=['hotpink'], trendline=\"ols\")\nfig.update_layout(title='Training Predicted Vs Actual values')\nfig.show()","7f4c44c1":"from sklearn.ensemble import RandomForestRegressor\nrfr = RandomForestRegressor()\nrfr.fit(X_train,y_train)\ny_predict = rfr.predict(X_train)\n\n# calculating the accuracies\nprint(\"Training Accuracy :\",rfr.score(X_train,y_train)*100)\nprint(\"Testing Accuracy :\",rfr.score(X_test,y_test)*100)","f92f1375":"from sklearn.metrics import mean_squared_error,r2_score\nprint(\"Model Accuracy\",r2_score(y,rfr.predict(X))*100)","0e8c829e":"fig = px.scatter(x = y_train, y = y_predict,color_discrete_sequence=['darkblue'], trendline=\"ols\")\nfig.update_layout(title='Training Predicted Vs Actual values')\nfig.show()","f1226891":"from xgboost import XGBRegressor\nxgb = XGBRegressor()\nxgb.fit(X_train,y_train)\ny_predict = xgb.predict(X_train)\n\n# calculating the accuracies\nprint(\"Training Accuracy :\",xgb.score(X_train,y_train)*100)\nprint(\"Testing Accuracy :\",xgb.score(X_test,y_test)*100)","5b54a22e":"from sklearn.metrics import mean_squared_error,r2_score\nprint(\"Model Accuracy\",r2_score(y,xgb.predict(X))*100)","dec4ddb2":"fig = px.scatter(x = y_train, y = y_predict, color_discrete_sequence=['crimson '], trendline=\"ols\")\nfig.update_layout(title='Training Predicted Vs Actual values')\nfig.show()","ee59390d":"from lightgbm import LGBMRegressor\nlgbm = LGBMRegressor()\nlgbm.fit(X_train,y_train)\ny_predict = lgbm.predict(X_train)\n\n# calculating the accuracies\nprint(\"Training Accuracy :\",lgbm.score(X_train,y_train)*100)\nprint(\"Testing Accuracy :\",lgbm.score(X_test,y_test)*100)","76929a22":"from sklearn.metrics import mean_squared_error,r2_score\nprint(\"Model Accuracy\",r2_score(y,lgbm.predict(X))*100)","c4aa5b24":"fig = px.scatter(x = y_train, y = y_predict, color_discrete_sequence=['orange'], trendline=\"ols\")\nfig.update_layout(title='Training Predicted Vs Actual values')\nfig.show()","e66cc4db":"#importing library and building model\nfrom catboost import CatBoostRegressor\ncboost=CatBoostRegressor(iterations=100, depth=10, learning_rate=0.1, loss_function='RMSE')\ncboost.fit(X_train, y_train,eval_set=(X_test, y_test),plot=True)","441c981f":"test=pd.read_csv('..\/input\/insurance-cost-prediction\/test.csv')\n#test contains the file information  which is in csv format\n\ntest.head()","5127416a":"test.shape\n#shape of the dataframe ie no. of rows and columns","f9bf9011":"# Checking for missing values\ntest.isna().sum()","bff8dcb6":"test['sex'] = number.fit_transform(test['sex'].astype('str'))\ntest['smoker'] = number.fit_transform(test['smoker'].astype('str'))\ntest['region'] = number.fit_transform(test['region'].astype('str'))\n\ntest.head()","c2f2a361":"df = pd.get_dummies(test, columns = categorical_val)\ndf.head()","67d0941f":"from sklearn.preprocessing import StandardScaler\n\ns_sc = StandardScaler()\ncol_to_scale = continous_val\ndf[col_to_scale] = s_sc.fit_transform(df[col_to_scale])\ndf.head()","d9936ebb":"#Using Linear Regression algorithm\ny_pred =cboost.predict(df)\ntest['charges'] = y_pred","ffd7525e":"test.head()","f0726217":"submission = test[['Id','charges']]\nsubmission","f20fd9cf":"submission.to_csv('submit.csv',index=False)","69d6e93b":"## Data Cleaning\nData cleansing or data cleaning is the process of detecting and correcting (or removing) corrupt or inaccurate records from a record set, table, or database and refers to identifying incomplete, incorrect, inaccurate or irrelevant parts of the data and then replacing, modifying, or deleting the dirty or coarse data.","470fe4f4":"### Predictive Modelling\nPredictive modeling is a powerful way to add intelligence to your application. It enables applications to predict outcomes against new data. The act of incorporating predictive analytics into your applications involves two major phases: model training and model deployment.\n\n#### Linear Regression\nLinear regression is a basic and commonly used type of predictive analysis.The overall idea of regression is to examine two things:\n\n(1) does a set of predictor variables do a good job in predicting an outcome (dependent) variable?\n\n(2) Which variables in particular are significant predictors of the outcome variable, and in what way do they\u2013indicated by the magnitude and sign of the beta estimates\u2013impact the outcome variable?\n\nThese regression estimates are used to explain the relationship between one dependent variable and one or more independent variables.","5777083c":"#### The charges of an individual mostly lie in the range of 0 to 15000.","9c85b6e8":"#### Correlation matrix\nCorrelation coefficients quantify the association between variables or features of a dataset. These statistics are of high importance for science and technology, and Python has great tools that you can use to calculate them. SciPy, NumPy, and Pandas correlation methods are fast, comprehensive, and well-documented.\n\nThe correlation matrix can be used to estimate the linear historical relationship between the returns of multiple assets. You can use the built-in . corr() method on a pandas DataFrame to easily calculate the correlation matrix. Correlation ranges from -1 to 1.","18d9f40e":"#### Good amount of individuals are healthy.","b97dd7dc":"## EDA with Data Visualization\nExploratory Data Analysis refers to the critical process of performing initial investigations on data so as to discover patterns,to spot anomalies,to test hypothesis and to check assumptions with the help of summary statistics and graphical representations.\n\nData visualization is the graphical representation of data in order to interactively and efficiently convey insights to clients, customers, and stakeholders in general.","008b6807":"##### 3) Z-score","45a1539c":"#### XGBoost","9a7518ea":"#### CatBoost","49e9d280":"##### 2) Inter Quantile Range(IQR)","076bfa3a":"##### 1) Detecting outliers using Boxplot","2cc68bf3":"#### Most of the individuals don't have children.","3b71737c":"#### A very few individuals smoke.","d571e287":"## Modelling and Prediction\n### Splitting the dataset\nTypically,we separate a data set into a training set and testing set, most of the data is used for training, and a smaller portion of the data is used for testing. Analysis Services randomly samples the data to help ensure that the testing and training sets are similar.","3269a305":"#### LightGBM","95836159":"## Categorical Columns","93960d7a":"#### Box plot for outliers\nIn descriptive statistics, a box plot is a method for graphically depicting groups of numerical data through their quartiles. Box plots may also have lines extending vertically from the boxes (whiskers) indicating variability outside the upper and lower quartiles, hence the terms box-and-whisker plot and box-and-whisker diagram. Outliers may be plotted as individual points.","a3fe044a":"## Feature Selection\nFeature Selection is the process where you automatically or manually select those features which contribute most to your prediction variable or output in which you are interested in. Having irrelevant features in your data can decrease the accuracy of the models and make your model learn based on irrelevant features.","13e89d9c":"#### Almost equal number of males and females are observed.","3cd8e230":"## Prediction on Test Data","a3f2e3cf":"#### There are individuals from different regions.","b0bf2d13":"## Scaling ","9cd67b43":"#### A lot of individuals are in their 20s.","37415a34":"# Insurance Cost Prediction\n### Predict individual medical cost billed by health insurance using linear regression","6b69f576":"## Submission File","11bd4add":"#### Random Forest\nRandom forest is like bootstrapping algorithm with Decision tree (CART) model. Say, we have 1000 observation in the complete population with 10 variables. Random forest tries to build multiple CART models with different samples and different initial variables. For instance, it will take a random sample of 100 observation and 5 randomly chosen initial variables to build a CART model. It will repeat the process (say) 10 times and then make a final prediction on each observation. Final prediction is a function of each prediction. This final prediction can simply be the mean of each prediction.","95ac40ad":"#### Heatmap\nA heatmap is a graphical representation of data in which data values are represented as colors. That is, it uses color in order to communicate a value to the reader. This is a great tool to assist the audience towards the areas that matter the most when you have a large volume of data.","b411a9ba":"#### Some outliers are observed in charges & bmi columns.","051390e1":"##### From the above heatmap ,we can conclude that :\n> #### Charges greatly depends upon features Age and Smoker."}}