{"cell_type":{"8b156edc":"code","793471c4":"code","6fe23111":"code","5fa513dd":"code","b3796d55":"code","ae522385":"code","604a9c14":"code","26993fbf":"code","4fff54bb":"code","ba3f8081":"code","b93fedf8":"code","9e505a2e":"code","4f280171":"code","4c04779c":"code","cd812eec":"code","8c1a462e":"code","e19b834a":"code","8c8fe99f":"code","85d00682":"code","1a29cd4e":"code","315d56f2":"code","882cef64":"code","d44682ce":"code","7112edbe":"code","327ac06e":"code","5234d47d":"code","300cb4a0":"code","fca0a744":"code","4e035c87":"code","225fecf1":"code","f3ba39cd":"code","55c5e110":"code","48c891da":"code","bad825b3":"code","2f50a555":"code","063a5b99":"code","8c02fdc1":"code","516db988":"code","a9098f80":"code","32248884":"code","dcebdbc9":"code","e46af1bb":"code","c201a109":"code","ea94734a":"code","d043430b":"code","c7b89a58":"code","d0a0277d":"code","dff5ebf8":"markdown","4fb4e7c0":"markdown","dc4eefaa":"markdown","50a43ab9":"markdown","489ee5f3":"markdown","c1175eff":"markdown","6649fe65":"markdown","e8a8ad82":"markdown"},"source":{"8b156edc":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nsns.set(color_codes=True)\nfrom sklearn.model_selection import train_test_split, cross_val_score\nfrom sklearn.model_selection import RandomizedSearchCV\nfrom sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score\nfrom sklearn.metrics import confusion_matrix, roc_curve, plot_roc_curve\nfrom sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier, ExtraTreesClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.linear_model import RidgeClassifier\nimport warnings\nwarnings.filterwarnings('ignore')","793471c4":"plt.rcParams['axes.labelsize'] = 15.\nplt.rcParams['xtick.labelsize'] = 15.\nplt.rcParams['ytick.labelsize'] = 15.\nplt.rcParams['legend.fontsize'] = 15.\nplt.rcParams['figure.figsize'] = [15.,8.]","6fe23111":"df = pd.read_csv('..\/input\/heart-disease-uci\/heart.csv')\ndf.head()","5fa513dd":"df.shape","b3796d55":"df.info()","ae522385":"df.describe()","604a9c14":"df.isna().sum()","26993fbf":"sns.countplot(data=df, x=\"target\", palette=\"magma\");","4fff54bb":"for i in df.columns[:13]:\n    sns.histplot(data=df, x=i, palette='magma')\n    plt.show()","ba3f8081":"plt.figure(figsize=(10,6))\nplt.scatter(df.age[df.target==0],\n           df.cp[df.target==0],\n           c='g')\nplt.scatter(df.age[df.target==1],\n           df.cp[df.target==1],\n           c=\"b\")\nplt.title(\"Age vc CP for Heart Disease\")\nplt.legend([\"No Disease\",\"aving Hneart Disease\"])\nplt.xlabel(\"Age\")\nplt.ylabel(\"Chest Pain\");","b93fedf8":"plt.figure(figsize=(10,6))\nplt.scatter(df.age[df.target==0],\n           df.thalach[df.target==0],\n           c=\"g\")\nplt.scatter(df.age[df.target==1],\n           df.thalach[df.target==1],\n           c=\"b\")\nplt.xlabel(\"Age\")\nplt.ylabel(\"Thalach\")\nplt.legend([\"No Disease\", \"Disease\"])\nplt.title(\"Age vs Thalach for Heart Disease\");","9e505a2e":"for i in df.columns[:14]:\n    sns.boxplot(data=df, x=i)\n    plt.show()","4f280171":"outliers_col = [\"trestbps\", \"chol\",\"fbs\",\"thalach\", \"oldpeak\", \"ca\",\"thal\"]","4c04779c":"for i in outliers_col[:]:\n    IQR = df[i].quantile(0.75)-df[i].quantile(0.25)\n    lower_bridge=df[i].quantile(0.25)-(IQR*1.5)\n    upper_bridge=df[i].quantile(0.75)+(IQR*1.5)\n    print(f' {i} : Lower Bridge: {lower_bridge}, Upper Bridge: {upper_bridge}')","cd812eec":"df.loc[df['trestbps']>=170, 'trestbps']=170\ndf.loc[df['trestbps']<=90, 'trestbps']=90\n\ndf.loc[df['chol']>=369.75, 'chol']=369.75\ndf.loc[df['chol']<=115.75, 'chol']=115.75\n\ndf.loc[df['fbs']>=0, 'fbs']=0\ndf.loc[df['fbs']<=0, 'fbs']=0\n\ndf.loc[df['thalach']>=214.75, 'thalach']=214.75\ndf.loc[df['thalach']<=84.75, 'thalach']=84.75\n\ndf.loc[df['oldpeak']>=4.0, 'oldpeak']=4.0\ndf.loc[df['oldpeak']<=-2.40, 'oldpeak']=-2.40\n\ndf.loc[df['ca']>=2.5, 'ca']=2.5\ndf.loc[df['ca']<=-1.5, 'ca']=-1.5\n\ndf.loc[df['thal']>=4.5, 'thal']=4.5\ndf.loc[df['thal']<=0.5, 'thal']=0.5","8c1a462e":"for i in df.columns[:14]:\n    sns.boxplot(data=df, x=i)\n    plt.show()","e19b834a":"sns.pairplot(data=df)","8c8fe99f":"corr = df.corr()\ncorr","85d00682":"sns.heatmap(corr,\n           cmap=\"Accent\",\n           annot=True);","1a29cd4e":"df.head()","315d56f2":"from sklearn.preprocessing import StandardScaler\nstandard = StandardScaler()\nfeatures_to_scale= [feature for feature in df.columns if feature not in ['target']]\ndf[features_to_scale] = standard.fit_transform(df[features_to_scale])","882cef64":"df.head()","d44682ce":"# train test split\nx = df.drop(['target'], axis=1)\ny = df['target']\n\nx_train, x_test, y_train, y_test = train_test_split(x,y, test_size=0.3, random_state=42)","7112edbe":"len(x_train), len(y_train)","327ac06e":"df.shape","5234d47d":"rf =  RandomForestClassifier().fit(x_train,y_train)\nrf.score(x_train,y_train)","300cb4a0":"rf.score(x_test,y_test)","fca0a744":"y_preds = rf.predict(x_test)\naccuracy_score(y_test,y_preds)","4e035c87":"sns.heatmap(confusion_matrix(y_test,y_preds), annot=True);","225fecf1":"acc_cv = cross_val_score(rf, x,y, scoring=\"accuracy\", cv=5, n_jobs=1)","f3ba39cd":"acc_cv.mean()","55c5e110":"from sklearn.metrics import classification_report","48c891da":"print(classification_report(y_test,y_preds))","bad825b3":"plot_roc_curve(rf,x_test,y_test)","2f50a555":"lr = LogisticRegression()\nlr.fit(x_train,y_train)\nlr.score(x_train,y_train)","063a5b99":"y_preds1= lr.predict(x_test)\nprint(f'Accuracy Score: {accuracy_score(y_test,y_preds1)}')\nsns.heatmap(confusion_matrix(y_test,y_preds1), annot=True)\nprint(classification_report(y_test,y_preds1))\nprint(plot_roc_curve(lr, x_test,y_test))","8c02fdc1":"ad = AdaBoostClassifier().fit(x_train,y_train)\ny_preds2 = ad.predict(x_test)\nprint(f'Accuracy Score: {accuracy_score(y_test,y_preds2)}')\nsns.heatmap(confusion_matrix(y_test,y_preds2), annot=True)\nprint(classification_report(y_test,y_preds2))\nprint(plot_roc_curve(lr, x_test,y_test))","516db988":"knn = KNeighborsClassifier().fit(x_train,y_train)\ny_preds3 = knn.predict(x_test)\nprint(f'Accuracy Score: {accuracy_score(y_test,y_preds3)}')\nsns.heatmap(confusion_matrix(y_test,y_preds3), annot=True)\nprint(classification_report(y_test,y_preds3))\nprint(plot_roc_curve(lr, x_test,y_test))","a9098f80":"knn = RidgeClassifier().fit(x_train,y_train)\ny_preds4 = knn.predict(x_test)\nprint(f'Accuracy Score: {accuracy_score(y_test,y_preds4)}')\nsns.heatmap(confusion_matrix(y_test,y_preds4), annot=True)\nprint(classification_report(y_test,y_preds4))\nprint(plot_roc_curve(lr, x_test,y_test))","32248884":"param_grid = [    \n    {'penalty' : ['l1', 'l2', 'elasticnet', 'none'],\n    'C' : np.logspace(-4, 4, 20),\n    'solver' : ['lbfgs','newton-cg','liblinear','sag','saga'],\n    'max_iter' : [100, 1000,2500, 5000]\n    }\n]\nlr_random = RandomizedSearchCV(lr, \n                              param_distributions=param_grid,\n                              cv=5,\n                              n_iter=100,\n                              verbose=2,\n                              n_jobs=-1,\n                              random_state=42)\nlr_random.fit(x_train,y_train)","dcebdbc9":"lr_random.best_params_","e46af1bb":"lr1_random = lr_random.best_params_","c201a109":"lr1_random","ea94734a":"log = LogisticRegression(solver ='newton-cg', penalty='l2',max_iter= 100, C= 0.08858667904100823)","d043430b":"log.fit(x_train,y_train)","c7b89a58":"log.score(x_train,y_train)","d0a0277d":"y_pred = log.predict(x_test)\nprint(f'Accuracy Score: {accuracy_score(y_test,y_pred)}')\nsns.heatmap(confusion_matrix(y_test,y_preds4), annot=True)\nprint(classification_report(y_test,y_preds4))\nprint(plot_roc_curve(lr, x_test,y_test))","dff5ebf8":"### AdaBoostClassifier","4fb4e7c0":"### RandomForestClassifier","dc4eefaa":"## Base Model","50a43ab9":"### Logistic Regression","489ee5f3":"### KNearestNeighbor Classifier","c1175eff":"### Outliers are removed","6649fe65":"## Hyperparameter Tuning ","e8a8ad82":"### RidgeClassifier"}}