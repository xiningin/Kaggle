{"cell_type":{"764225de":"code","27285335":"code","ee307480":"code","360820d9":"code","ae66a3f4":"code","cb476bca":"code","8c4d29e0":"code","d3b13d86":"code","27032730":"code","9464d64d":"code","8d12ed33":"markdown","d9755e71":"markdown","a2bd1860":"markdown","a22df33c":"markdown","9ec1fc1f":"markdown","b0903e41":"markdown","727b3264":"markdown","675b641f":"markdown"},"source":{"764225de":"import pandas as pd\nimport numpy as np\ndata = pd.read_csv('..\/input\/random-linear-regression\/train.csv')\ndata.head(3)","27285335":"import matplotlib.pyplot as plt\nx = data.x\ny = data.y\nplt.plot(x,y, 'o', color = 'black')\nplt.show()\n","ee307480":"print(\"number of record in dataset is {}\".format(len(data)))\ndata.isnull().sum()","360820d9":"data.dropna(inplace = True)\ndata.isnull().sum()","ae66a3f4":"x = data.x.values.reshape(-1,1)\ny = data.y.values.reshape(-1,1)","cb476bca":"from sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(x,y, test_size=0.33, random_state=143)","8c4d29e0":"from sklearn.linear_model import LinearRegression\nmodel = LinearRegression()\nmodel.fit(x_train, y_train)","d3b13d86":"y_predict = model.predict(x_test)\nplt.subplots(figsize=(10, 6))\nplt.scatter(x_test,y_test)\nplt.plot(x_test,y_predict,c='r')","27032730":"from sklearn.metrics import r2_score\nscore=r2_score(y_test,y_predict)\nscore","9464d64d":"residual = []\nfor i in range(len(y_test)):\n    residual.append(y_predict[i] - y_test[i])\nresidual = [item[0] for item in residual]\n# frequency distribution historigam\n#print(min(residual), max(residual))\n#print(residual)\nplt.hist(residual, bins=20, facecolor=\"blue\", edgecolor=\"black\", alpha=0.7 )\nplt.title(\"Frequency Distribution Historigam of Residual\")\nplt.show()","8d12ed33":"Since dataset contains 700 records but just contain one row of missing value, it will not effect the model, so we just delet the row","d9755e71":"### Linear Regression model\nWe already have the data training set, frist thing is to make sure that check if there's missing value in x and y","a2bd1860":"We simply split the data set into training data and test data using python ","a22df33c":"### Linear Regression exercise:\nWhen we use linear regression model, below 4 assuptions whould be satisfied\n- 1. Linear relationship: There exists a linear relationship between the independent variable, x, and the dependent variable, y.\n- 2. Independence: The residuals are independent. ...\n- 3. Homoscedasticity: The residuals have constant variance at every level of x.\n- 4. Normality: The residuals of the model are normally distributed. <br>\nFor this dataset, since all x and y are randomly generated, so we consider that it's independent from each other, meet requirement 2, as for others, we verify later.\nLet's import the dataset first","9ec1fc1f":"Since there're only 231 data in this Historigam of Residual, we tell from shape that it's roughly subject to Gaussian Distribution","b0903e41":"We draw the scatter plot to see if x and y has liear relationship, from plot below, we found that the scatter has the straigt line shape, thus we thank requirement 1 has been satisfied.","727b3264":"We use the trained model to predict y in test data","675b641f":"We measrue the performance of model using r2_score"}}