{"cell_type":{"9b7b0abf":"code","f31e98d2":"code","496cc50b":"code","f6c95a98":"code","d3855538":"code","8b7d5623":"code","11e0dd90":"code","b9feab1a":"code","a151029e":"code","9ebca9db":"markdown"},"source":{"9b7b0abf":"# Libraries\nimport pandas as pd\nimport h2o\nfrom h2o.automl import H2OAutoML","f31e98d2":"# Run H2O\nh2o.init(max_mem_size='16g')","496cc50b":"# Read data\ntrain = h2o.import_file('..\/input\/tabular-playground-series-mar-2021\/train.csv')\ntest = h2o.import_file('..\/input\/tabular-playground-series-mar-2021\/test.csv')","f6c95a98":"# Features\npredictors = train.columns[:-1]\ntarget = train.columns[-1]","d3855538":"# For binary classification, response should be a factor\ntrain[target] = train[target].asfactor()","8b7d5623":"# h2o train\naml = H2OAutoML(\n    nfolds=10,\n    sort_metric='auc',\n    stopping_metric='auc',\n    max_runtime_secs=3600*8,\n    seed=0\n)\n\naml.train(x=predictors, y=target, training_frame=train)","11e0dd90":"# View the AutoML Leaderboard\nlb = aml.leaderboard\nlb.head(rows=lb.nrows)","b9feab1a":"# Predictions\noutput = aml.leader.predict(test)\npredictions = h2o.as_list(output['p1'])","a151029e":"# Store results\nsubmission = pd.read_csv('..\/input\/tabular-playground-series-mar-2021\/test.csv', index_col='id')\nsubmission[target] = predictions.values\nsubmission[target].to_csv('submission.csv')","9ebca9db":"# H2O AutoML\n\n### [Documenation](https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/automl.html)"}}