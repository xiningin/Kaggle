{"cell_type":{"94499c3b":"code","05d2c2e1":"code","73bc5940":"code","fb3f574e":"code","e6f673b2":"code","cc61b326":"code","f0949314":"code","6d935fbe":"code","f838a9be":"code","29dd57f9":"code","91de6f7a":"code","ef8f86ef":"code","9b8685f2":"code","e440280b":"code","ce582b50":"code","00f8f61b":"code","1b540f14":"code","5604c4b9":"code","da35573a":"code","2d937caf":"code","cefd1827":"markdown","7897f395":"markdown","71a9826f":"markdown","5877c50c":"markdown","0be53e53":"markdown","d64b2dc6":"markdown","d105cbc9":"markdown","3cdd0fa5":"markdown","f1f532f1":"markdown","1090ba69":"markdown","de94b25a":"markdown","864f642d":"markdown","8d193117":"markdown","4ee55786":"markdown","000328ce":"markdown","70ab267d":"markdown","a6a28df8":"markdown"},"source":{"94499c3b":"# importing neccessary libraries\nimport pandas as pd\nimport numpy as np","05d2c2e1":"df=pd.read_csv('..\/input\/drug200.csv')\ndf.head(5)","73bc5940":"# summary of the dataframe\ndf.info()","fb3f574e":"# looking to see if there are any missing values\nmissing_data=df.isnull()\nmissing_data.head(5)","e6f673b2":"for column in missing_data.columns.values.tolist():\n    print(column)\n    print(missing_data[column].value_counts())\n    print('')","cc61b326":"df.describe()","f0949314":"df.corr()","6d935fbe":"# defining our feature matrix that will predict the target y value(drug)\nX = df[['Age', 'Sex', 'BP', 'Cholesterol', 'Na_to_K']].values\nX[0:5]","f838a9be":"# turn the categorical variables to numeric variables\nfrom sklearn import preprocessing","29dd57f9":"le_sex = preprocessing.LabelEncoder()\nle_sex.fit(['F','M'])\nX[:,1] = le_sex.transform(X[:,1]) \n\n\nle_BP = preprocessing.LabelEncoder()\nle_BP.fit([ 'LOW', 'NORMAL', 'HIGH'])\nX[:,2] = le_BP.transform(X[:,2])\n\n\nle_Chol = preprocessing.LabelEncoder()\nle_Chol.fit([ 'NORMAL', 'HIGH'])\nX[:,3] = le_Chol.transform(X[:,3]) \n\nX[0:5]\n","91de6f7a":"# defining the y target value\ny=df['Drug']\ny[0:5]","ef8f86ef":"# importing neccessary libraries\nfrom sklearn.model_selection import train_test_split","9b8685f2":"X_trainset, X_testset, y_trainset, y_testset=train_test_split(X, y, test_size=0.3, random_state=3)","e440280b":"X_trainset[0:5]","ce582b50":"# creating the Decision Tree Clasifier instance\nfrom sklearn.tree import DecisionTreeClassifier","00f8f61b":"drugTree = DecisionTreeClassifier(criterion=\"entropy\", max_depth = 4)\ndrugTree # it shows the default parameters","1b540f14":"# we will fit the X, y trainset. (training the dataset with X, y trainset values)\ndrugTree.fit(X_trainset,y_trainset)","5604c4b9":"# our model is ready and we can start defining predictions\npredTree = drugTree.predict(X_testset)","da35573a":"print (predTree [0:5])\nprint (y_testset [0:5])","2d937caf":"# our model is ready and we can check the accuracy of the model by importing metrics from sklearn\nfrom sklearn import metrics\nimport matplotlib.pyplot as plt\nprint(\"DecisionTrees's Accuracy: \", metrics.accuracy_score(y_testset, predTree))","cefd1827":"## Model Selecting and Set Up\n\nBased on the feature data set, even though we do have categorical variables, we can use Decision Tree to create a prediction model. In order to do that, we need to change the categorical variables such as Sex, Blood Pressure and Cholesterol to numerical variables.\n\nWe can define our Feature Matrix is as X and y as the response vector which is the target.","7897f395":"## Model Development","71a9826f":"There is a negative medium correlation between the age and, Sodium to Potassium ratio. The higher the age is the lower the sodium to potassium ratio is.","5877c50c":"# Introduction\n\nAs part of defining the right medicine and treatment for patients with same illness, we can create a prediction model by leveraging patient data and their response to a certain medication. Our goal in this project is to create a model to find the right medication for future patients with same illness. The problem that is in question which we are trying to solve is \"Can we create a machine learning algorithm where we can predict proper medication to a group of patient with same illness, based on their features such as age and gender?\" ","0be53e53":"We have selected Decision Tree as predictive modeling, defined our feature matrix and target. We can start setting up the decision tree.","d64b2dc6":"Based on the data set, our average age of patients is 44. The youngest patient is 15 and oldest patient is 74 years old. Please keep in mind that all of the patients have the same illness. ","d105cbc9":"## Conclusion\n\nBased on our analysis, by using the Age, Sex, Blood Pressure, Cholesterol and Sodium to Potasium ratio as feature matrix, we created a machine learning model to predict proper medication for a patient. ","3cdd0fa5":"We can see that there are no missing values within our dataset. We can start analyzing our data set. ","f1f532f1":"## Evaluation","1090ba69":"# Contents\n\n1. About the Data Set\n2. Data Collection and Understanding\n3. Data Exploration\n4. Model Selecting and Set Up\n5. Model Development\n6. Prediction\n7. Evaluation\n8. Conclusion","de94b25a":"We can also see that Sex, BP and Cholesterol are categorical variables. ","864f642d":"## Data Collection and Understanding","8d193117":"The classification score we get is based on: a set of labels predicted for a sample must exactlty match the corresponding set of labels. ","4ee55786":"We can see that the data set size is 1200 with 200 rows and 6 columns. The variables are correct data type; Age is integer, Sex, BP, Cholesterol and Drug is objects, Na_to_K is float.","000328ce":"## Data Exploration","70ab267d":"## Prediction","a6a28df8":"## About the Data Set\n\nThe features that are provided within the data set are outlined as below\n\n- Age : Age of the Patient\n- Sex : Gender of the Patient\n- BP  : Blood Pressure of the Patient\n- Cholesterol: Cholesterol of the Patient\n- Drug: Drug each patient responded to\n- Na_to_K: Sodium to Potasium Levels\n\n\n* Please note all patients in the dataset have the same illness."}}