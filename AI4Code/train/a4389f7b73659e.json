{"cell_type":{"e9cf5a7f":"code","a824d6a3":"code","7decf677":"code","2c2de985":"code","be383ac3":"code","dc36e2af":"code","ed2285ee":"code","a06dd282":"code","ad289109":"code","46c7c1d0":"code","5443ef7f":"code","4d4cbadc":"code","5c162d87":"code","60c1efe5":"code","5c6baeeb":"code","ff5c1ac5":"code","fcec2a9e":"code","f3db5ff3":"code","85269bbc":"code","f029a4bf":"markdown","4ba578a5":"markdown","7bf833cf":"markdown","30a016d6":"markdown","a33ed314":"markdown","bea37fdd":"markdown"},"source":{"e9cf5a7f":"import pandas as pd\nimport sklearn\nimport numpy as np\nimport os\ncwd = os.getcwd()","a824d6a3":"train_adult = pd.read_csv(\"..\/input\/adultb\/train_data.csv\" ,names=[\n        \"Age\", \"Workclass\", \"fnlwgt\", \"Education\", \"Education-Num\", \"Marital Status\",\n        \"Occupation\", \"Relationship\", \"Race\", \"Sex\", \"Capital Gain\", \"Capital Loss\",\n        \"Hours per week\", \"Country\", \"Target\"],\n        skiprows = 1,\n        sep=r'\\s*,\\s*',\n        engine='python',\n        na_values=\"?\")","7decf677":"test_adult = pd.read_csv(\"..\/input\/adultb\/test_data.csv\" ,names=[\n        \"Age\", \"Workclass\", \"fnlwgt\", \"Education\", \"Education-Num\", \"Marital Status\",\n        \"Occupation\", \"Relationship\", \"Race\", \"Sex\", \"Capital Gain\", \"Capital Loss\",\n        \"Hours per week\", \"Country\"],\n        skiprows = 1,\n        sep=r'\\s*,\\s*',\n        engine='python',\n        na_values=\"?\")","2c2de985":"natrain_adult = train_adult.dropna()\nnatest_adult = test_adult.dropna()","be383ac3":"import matplotlib.pyplot as plt\nnatest_adult[\"Capital Gain\"].value_counts().plot(kind='bar')\nnatrain_adult[\"Hours per week\"].value_counts().plot(kind='pie')","dc36e2af":"targetxrace = pd.crosstab(natrain_adult[\"Race\"],natrain_adult[\"Target\"],margins=False)\ntargetxrace.plot(kind='bar',stacked=False)\ntargetxrace","ed2285ee":"targetxrace = pd.crosstab(natrain_adult[\"Sex\"],natrain_adult[\"Target\"],margins=False)\ntargetxrace.plot(kind='bar',stacked=True)","a06dd282":"from sklearn import preprocessing\nadult_train = natrain_adult[[\"Age\", \"Workclass\", \"Education-Num\", \"Occupation\", \"Race\", \"Sex\", \"Capital Gain\", \"Capital Loss\",\n        \"Hours per week\"]]\nadult_test = natest_adult[[\"Age\", \"Workclass\", \"Education-Num\", \"Occupation\", \"Race\", \"Sex\", \"Capital Gain\", \"Capital Loss\",\n        \"Hours per week\"]]\nXtrainadult = adult_train.apply(preprocessing.LabelEncoder().fit_transform)\nYtrainadult = natrain_adult.Target\nXtestadult = adult_test.apply(preprocessing.LabelEncoder().fit_transform)","ad289109":"from sklearn.neighbors import KNeighborsClassifier as knnClassifier\nknn = knnClassifier(n_neighbors = 35)","46c7c1d0":"from sklearn.model_selection import cross_val_score\nscores = cross_val_score(knn, Xtrainadult, Ytrainadult,cv=10)\nscores","5443ef7f":"knn.fit(Xtrainadult, Ytrainadult)\npredYtest = knn.predict(Xtestadult)\npredYtest","4d4cbadc":"income = pd.DataFrame(predYtest)\nincome.to_csv(\"submission.csv\",header = [\"income\"], index_label = \"Id\")","5c162d87":"train = pd.read_csv(\"..\/input\/costa-rican-household-poverty-prediction\/train.csv\")\ntest = pd.read_csv(\"..\/input\/costa-rican-household-poverty-prediction\/test.csv\")","60c1efe5":"ntrain = train.dropna()","5c6baeeb":"from sklearn import preprocessing\nXtrain = train.iloc[:,0:-1]\nYtrain = train.Target\nXtest = test\nnXtrain = Xtrain.apply(preprocessing.LabelEncoder().fit_transform)\nnXtest = Xtest.apply(preprocessing.LabelEncoder().fit_transform)","ff5c1ac5":"from sklearn.neighbors import KNeighborsClassifier as KnnC\nknn = KnnC(n_neighbors = 30)","fcec2a9e":"from sklearn.model_selection import cross_val_score\nscores = cross_val_score(knn, nXtrain, Ytrain, cv=10)\nscore = np.mean(scores)","f3db5ff3":"knn.fit(nXtrain, Ytrain)\npredYtest = knn.predict(nXtest)","85269bbc":"poverty = pd.DataFrame(predYtest)\npoverty.to_csv(\"submission.csv\", header = [\"Target\"], index_label = 'Id')","f029a4bf":"Parse the data and create a classifier","4ba578a5":"There begins the notebook for the Costa Rican Household Poverty Analysis","7bf833cf":"Read the archives train and test","30a016d6":"Remove missing data","a33ed314":"Import all used libraries","bea37fdd":"Analysing the data through graphs"}}