{"cell_type":{"632a548f":"code","de8e7bf4":"code","880f3c80":"code","b5d78a3c":"code","da48e9ae":"code","b5f248d8":"code","2abb122b":"code","45250cd8":"code","dedc53e1":"code","2c75d678":"code","df3dbd1d":"code","f2e062f1":"code","34090a09":"code","048967fe":"code","10fa01ab":"code","8630a3ad":"code","d5b8104b":"code","82ed6c8c":"code","7f8c8500":"code","6c3c8c4c":"code","75b0c439":"code","cab5ef29":"code","a974ace0":"markdown"},"source":{"632a548f":"from fastai.text import *\nimport pandas as pd\nimport seaborn as sns","de8e7bf4":"!mkdir spamham\n!cp \/kaggle\/input\/spam-text-message-classification\/* \/kaggle\/working\/spamham","880f3c80":"path = Path('\/kaggle\/working\/spamham')\ndf = pd.read_csv(path\/'SPAM text message 20170820 - Data.csv')\ndf.head()","b5d78a3c":"df.isna().sum()","da48e9ae":"sns.countplot(df['Category'])","b5f248d8":"data_lm = (TextList\n    .from_csv(path, 'SPAM text message 20170820 - Data.csv', cols=1)\n    .split_by_rand_pct(0.1)\n    .label_for_lm()\n    .databunch(bs=64)\n)","2abb122b":"learn_lm = language_model_learner(data_lm, AWD_LSTM)\nlearn_lm.lr_find()\nlearn_lm.recorder.plot()","45250cd8":"learn_lm.fit_one_cycle(7, slice(0.05))","dedc53e1":"learn_lm.unfreeze()\nlearn_lm.lr_find()\nlearn_lm.recorder.plot()","2c75d678":"learn_lm.fit_one_cycle(15, slice(1e-3, 0.01))","df3dbd1d":"learn_lm.predict('Hi', 15)","f2e062f1":"learn_lm.save_encoder('enc')","34090a09":"datacls = (TextList\n    .from_csv(path, 'SPAM text message 20170820 - Data.csv', cols=1, vocab=data_lm.vocab)\n    .split_by_rand_pct(0.33, seed=42)\n    .label_from_df(0)\n    .databunch(bs=64)\n)","048967fe":"learn = text_classifier_learner(datacls, AWD_LSTM)\nlearn.load_encoder('enc')\nlearn.lr_find()\nlearn.recorder.plot()","10fa01ab":"learn.fit_one_cycle(8, slice(1e-3\/2))","8630a3ad":"learn.unfreeze()\nlearn.lr_find()\nlearn.recorder.plot()","d5b8104b":"learn.fit_one_cycle(10, slice(1e-2, 1e-3\/10))","82ed6c8c":"interp = TextClassificationInterpretation.from_learner(learn)","7f8c8500":"interp.plot_confusion_matrix()","6c3c8c4c":"cmx = interp.confusion_matrix()\nprint(f'Sensitivity: {cmx[1,1]\/cmx[1].sum()}')\nprint(f'Specificity: {cmx[0,0]\/cmx[0].sum()}')","75b0c439":"interp.show_intrinsic_attention(\"Would you like to buy this amazing product?\")","cab5ef29":"interp.show_top_losses(3)","a974ace0":"This is a simple notebook that shows amazing capabilities of the fastai library for NLP. If you want to know more, check out the course:\nhttps:\/\/youtu.be\/XfoYk_Z5AkI\n\nNLP is covered mostly in:\n* https:\/\/youtu.be\/MpZxV6DVsmM\n* https:\/\/youtu.be\/qqt3aMPB81c"}}