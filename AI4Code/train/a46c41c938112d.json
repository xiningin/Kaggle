{"cell_type":{"520a4466":"code","0b2e939d":"code","8201a935":"code","66e88439":"code","64b57909":"code","8f2053a3":"code","d8f7188a":"code","9dfc334e":"code","2ee1864b":"code","83c36861":"code","6ec7861b":"code","0e6e458b":"code","b46778d7":"code","7ff536a3":"code","dbd896a6":"code","a04c4069":"code","550c332b":"code","f17204b3":"code","d459e24b":"code","34d31adb":"code","87b2e7c1":"code","756f32b9":"code","3563978e":"code","835df77f":"code","950f2789":"code","7eb6af5b":"code","f1a04daa":"code","35b96b88":"code","4e8d535d":"code","dfbafdf6":"code","347644f1":"code","166e4ac8":"code","34f0ee76":"markdown","3b5b90cb":"markdown","3b69c738":"markdown","5e83fa9d":"markdown","491a41b5":"markdown","721c981e":"markdown","6a0adc30":"markdown","3bfdd04e":"markdown","4c14a10c":"markdown","d75c845c":"markdown","c30b8e97":"markdown","d5997565":"markdown","23230e69":"markdown","06809881":"markdown","4bc68328":"markdown","85172b33":"markdown","971f1525":"markdown","9c9c386e":"markdown","5deeb685":"markdown","38233ea1":"markdown","39242d48":"markdown","0926a2c3":"markdown","aa228b0e":"markdown","339c02b4":"markdown","9b0b95f0":"markdown","20c5ad53":"markdown","ce63c5c9":"markdown","91ce7e2b":"markdown","ee8eab85":"markdown","f6d75adb":"markdown","d2d30b8d":"markdown","231a5499":"markdown","96edd887":"markdown","5b9746cd":"markdown","f070cdfa":"markdown"},"source":{"520a4466":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')","0b2e939d":"df = pd.read_csv(\"..\/input\/early-stage-diabetes-risk-prediction-dataset\/diabetes_data_upload.csv\")\ndf1 = df.copy()\ndf","8201a935":"df.info()","66e88439":"df[\"Gender\"]=df[\"Gender\"].replace({\"Male\":0,\"Female\":1})\ndf['class']=df['class'].replace({'Positive':1,'Negative':0})\nfor col in df.columns:\n    if col not in [\"Age\",\"Gender\",\"class\"]:\n        df[col]=df[col].replace({'Yes':1,'No':0})\ndef age(i):\n    for x in range(10,100,10):\n        if i < x:\n            la = f'{x-10}-{x}'\n            return la\n            break\ndf1['Age Group'] = df1['Age'].apply(lambda x:age(x))\ndf","64b57909":"# green=\"#5bb46c\"\n# red=\"#e4564a\"\nred=\"#ff8c94\"\nblue=\"#5ab0ff\"\ngreen=\"#99ff99\"\ngreen='#63ee33'\nred=\"#ee3338\"\nsns.set_style(\"whitegrid\")\nplt.figure(figsize=(7,7))\ndf[\"class\"].value_counts().plot(kind=\"pie\",colors=[blue,'grey'],legend=True,labels=[\"Positive\",\"Negative\"],\n                               startangle=90,autopct='%1.1f%%')\nplt.title('\\nTarget Class Distribution',fontweight='bold',fontsize=14)\nplt.tight_layout()\nplt.show()","8f2053a3":"plt.figure(figsize=(12,8))\nax = sns.countplot(x='Age Group', data=df1, color= blue,order=['10-20', '20-30', '30-40', '40-50', \n                                                               '50-60', '60-70', '70-80', '80-90'])\nfor p in ax.patches:\n    ax.annotate('{:}'.format(p.get_height()), (p.get_x()+.30, p.get_height()+1))\n\nplt.title(\"\\nAge Distibution\",fontweight='bold',fontsize=14)\nplt.show()","d8f7188a":"cou = 1\nplt.figure(figsize=(15,20))\nprint('\\n\\n')\nfor i in df1.columns:\n    if i not in ['class','Age','Gender','Age Group']:\n        plt.subplot(5,3,cou)\n        plt.title(f'{i.title()}',fontweight='bold',fontsize=14)\n        cou += 1\n        plt.tight_layout()\n        df1[i].value_counts().plot(kind=\"pie\",colors=[blue,'grey'],legend=True,labels=[\"Yes\",\"No\"],\n        startangle=90,autopct='%1.1f%%')\n        plt.ylabel('')\n        plt.title(f'{i.title()}',fontweight='bold',fontsize=12)\n        plt.legend(loc = \"upper right\",fontsize=12)\nplt.tight_layout() \nplt.show()","9dfc334e":"plt.figure(figsize=(12,8))\nsns.heatmap(df.corr(),annot=True,cmap='BrBG')\nplt.title('Correlation Heatmap\\n',fontweight='bold',fontsize=14)\nplt.show()","2ee1864b":"plt.figure(figsize=(12,8))\nax = sns.countplot(x=\"Age Group\", data=df1,hue=\"class\",palette=[red,green],order=['10-20', '20-30', '30-40', '40-50', '50-60', '60-70', '70-80', '80-90'])\nbars = ax.patches\nhalf = int(len(bars)\/2)\nleft_bars = bars[:half]\nright_bars = bars[half:]\nfor left, right in zip(left_bars, right_bars):\n        height_l = left.get_height()\n        height_r = right.get_height()\n        total = height_l + height_r\n        l_per = height_l\/total\n        r_per = height_r\/total\n        if l_per == np.nan:\n            l_per = 100\n        if r_per == np.nan:\n            r_per = 100\n        ax.text(left.get_x() + left.get_width()\/2., height_l+2 , ' {0:.0%}'.format(l_per),va='center', ha=\"center\",size=12)\n        ax.text(right.get_x() + right.get_width()\/2., height_r+2 , ' {0:.0%}'.format(r_per),va='center', ha=\"center\",size=12)\nplt.tight_layout()\nplt.title(f'\\n\\nAge Group Analysis\\n',fontweight='bold',fontsize=14)\nplt.legend(loc = \"upper right\",fontsize=12)\nplt.show()","83c36861":"df1.groupby(\"Gender\")[\"class\"].value_counts().unstack()","6ec7861b":"ast = df1[df1[\"class\"]==\"Positive\"]\nast.drop(['Age','Age Group','Gender','class'],axis=1,inplace=True)\nast = ast.apply(pd.Series.value_counts).transpose()\nast['Showed The Symptom']=ast['Yes']\/(ast['Yes']+ast['No'])*100\nast[\"Didn't Show The Symptom\"]=ast['No']\/(ast['Yes']+ast['No'])*100\nast.drop(['Yes','No'],inplace=True,axis=1)\nprint('\\033[1m'+'\\n\\t People who were tested positive for Diabetes')\nprint('**********************************************************')\nast.sort_values(by = 'Showed The Symptom',ascending=False)","0e6e458b":"X = df.drop(\"class\",axis=1)\nY = df[\"class\"]\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X,Y, test_size=0.33, random_state=42)","b46778d7":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nX_train = scaler.fit_transform(X_train)\nX_test = scaler.fit_transform(X_test)\nX = scaler.fit_transform(X)","7ff536a3":"#importing scoring \nfrom sklearn.metrics import classification_report,confusion_matrix\nfrom sklearn.model_selection import cross_val_score","dbd896a6":"from sklearn.model_selection import GridSearchCV\nfrom sklearn.linear_model import LogisticRegression\nlr_model = LogisticRegression()","a04c4069":"lr_model = LogisticRegression(penalty='l2',C=1,max_iter=4)\nlr_model.fit(X_train,y_train)\npred = lr_model.predict(X_test)\nlrscore = lr_model.score(X_test,y_test)","550c332b":"lrscore = lr_model.score(X_test,y_test)\nlrcm = confusion_matrix(y_test,pred)\nlrcr = classification_report(y_test,pred)\nprint('Logistic Regression')\nprint('*******************')\nprint('Testscore')\nprint('---------')\nprint(lrscore)\nprint('\\n')\nprint('confusion Matrix')\nprint('----------------')\nprint(lrcm)\nprint('\\n')\nprint('Classification Report')\nprint('---------------------')\nprint(lrcr)                        ","f17204b3":"from sklearn.neighbors import KNeighborsClassifier\nknn = KNeighborsClassifier()\ngs = {'n_neighbors':range(1,25)}\nknn_param_search = GridSearchCV(knn,gs,cv=5)\nknn_param_search.fit(X_train,y_train)","d459e24b":"knn_param_search.best_params_","34d31adb":"knnscore = knn_param_search.score(X_test,y_test)\nknncm = confusion_matrix(y_test,pred)\nknncr = classification_report(y_test,pred)\nprint('K Nearest Neighbour')\nprint('*******************')\nprint('Testscore')\nprint('---------')\nprint(knnscore)\nprint('\\n')\nprint('confusion Matrix')\nprint('----------------')\nprint(knncm)\nprint('\\n')\nprint('Classification Report')\nprint('---------------------')\nprint(knncr)        ","87b2e7c1":"from sklearn.tree import DecisionTreeClassifier\ndt_model = DecisionTreeClassifier(random_state=10)\ndt_model.fit(X_train,y_train)\npred = dt_model.predict(X_test)","756f32b9":"dtscore = dt_model.score(X_test,y_test)\ndtcm = confusion_matrix(y_test,pred)\ndtcr = classification_report(y_test,pred)\nprint('Decision Tree')\nprint('*************')\nprint('Testscore')\nprint('---------')\nprint(dtscore)\nprint('\\n')\nprint('confusion Matrix')\nprint('----------------')\nprint(dtcm)\nprint('\\n')\nprint('Classification Report')\nprint('---------------------')\nprint(dtcr)        ","3563978e":"from sklearn.naive_bayes import GaussianNB\ngnb = GaussianNB()\ngnb.fit(X_train, y_train)\npred = gnb.predict(X_test)","835df77f":"nbscore = gnb.score(X_test,y_test)\nnbcm = confusion_matrix(y_test,pred)\nnbcr = classification_report(y_test,pred)\nprint('Na\u00efve Bayes')\nprint('***********')\nprint('Testscore')\nprint('---------')\nprint(nbscore)\nprint('\\n')\nprint('confusion Matrix')\nprint('----------------')\nprint(nbcm)\nprint('\\n')\nprint('Classification Report')\nprint('---------------------')\nprint(nbcr)      ","950f2789":"from sklearn.ensemble import RandomForestClassifier\nrf_model = RandomForestClassifier(n_estimators=15)\nrf_model.fit(X_train,y_train)\npred = gnb.predict(X_test)","7eb6af5b":"rfscore = rf_model.score(X_test,y_test)\nrfcm = confusion_matrix(y_test,pred)\nrfcr = classification_report(y_test,pred)\nprint('Random Forest')\nprint('*************')\nprint('Testscore')\nprint('---------')\nprint(rfscore)\nprint('\\n')\nprint('confusion Matrix')\nprint('----------------')\nprint(rfcm)\nprint('\\n')\nprint('Classification Report')\nprint('---------------------')\nprint(rfcr)     ","f1a04daa":"from sklearn.svm import SVC\nkernels = ['linear','rbf','poly']\nfor i in kernels:  \n    svm_model = SVC(kernel=i,C=2)\n    svm_model.fit(X_train,y_train)\n    print('For Kernel:',i)\n    print('Accuracy is:',svm_model.score(X_test,y_test))","35b96b88":"for i in range(0,11):\n    svm_model = SVC(kernel='poly',C=2,degree=i)\n    svm_model.fit(X_train,y_train)\n    print('For Degree:',i)\n    print('Accuracy is:',svm_model.score(X_test,y_test))","4e8d535d":"svm_model = SVC(kernel='poly',C=2,degree=7)\nsvm_model.fit(X_train,y_train)\npred = svm_model.predict(X_test)\nsvm_model.score(X_test, y_test)","dfbafdf6":"svmscore = svm_model.score(X_test,y_test)\nsvmcm = confusion_matrix(y_test,pred)\nsvmcr = classification_report(y_test,pred)\nprint('Support Vector Machine')\nprint('**********************')\nprint('Testscore')\nprint('---------')\nprint(svmscore)\nprint('\\n')\nprint('confusion Matrix')\nprint('----------------')\nprint(svmcm)\nprint('\\n')\nprint('Classification Report')\nprint('---------------------')\nprint(svmcr)      ","347644f1":"plt.figure(figsize=(12,12))\ncmtitl = ['Logistic Regression','K Nearest Neighbour','Decision Tree','Na\u00efve Bayes','Random Forest','Support Vector Machine']\ncms = [lrcm,knncm,dtcm,nbcm,rfcm,svmcm]\nnum=0\nfor x in cms:\n    plt.subplot(3,2,num+1,)\n    group_names = ['True Neg','False Pos','False Neg','True Pos']\n    group_counts = ['{0:0.0f}'.format(value) for value in x.flatten()]\n    group_percentages = ['{0:.2%}'.format(value) for value in x.flatten()\/np.sum(svmcm)]\n    labels = [f'{v1}\\n{v2}\\n{v3}' for v1, v2, v3 in   zip(group_names,group_counts,group_percentages)]\n    labels = np.asarray(labels).reshape(2,2)\n    sns.heatmap(x, annot=labels, annot_kws={\"fontsize\":13}, fmt='', cmap='binary')\n    plt.title(f'{cmtitl[num]}\\n',fontsize=14)\n    num += 1\n    plt.tight_layout()\nplt.show()","166e4ac8":"### Cross Validation\nfrom sklearn.model_selection import cross_val_score\nmdl =[lr_model,knn_param_search,dt_model,gnb,rf_model,svm_model]\nmdlnames=['Logistic Regression','K Nearest Neighbour','Decision Tree','Na\u00efve Bayes','Random Forest','Support Vector Machine']\nfor c,mn in enumerate(mdl):\n    crvlsc = cross_val_score(mn,X,Y,cv=10)\n    print(mdlnames[c])\n    print('*'*30)\n    print(f'Min:{crvlsc.min()}')\n    print(f'Max:{crvlsc.max()}') \n    print(f'Avg:{crvlsc.mean()}\\n')\n    ","34f0ee76":"   ### Distribution of Data\n  ","3b5b90cb":"---","3b69c738":"#### People between the age of 60-70 in the dataset has more chance of having Diabetes.\n---","5e83fa9d":"#### Females in the dataset turned out to be more more <font color =red>positive\n---","491a41b5":"#### Cross validation","721c981e":" #    <div align =center >Early Stage Diabetes Risk Prediction","6a0adc30":" ### Splitting the dataset into training and testing sets","3bfdd04e":"## Decision Tree","4c14a10c":"----","d75c845c":"### Correlation","c30b8e97":"### Data Set Information:\n\nThis has been collected using direct questionnaires from the patients of Sylhet Diabetes\nHospital in Sylhet, Bangladesh and approved by a doctor.\nData Set Information:\n\nThis has been collected using direct questionnaires from the patients of Sylhet Diabetes\nHospital in Sylhet, Bangladesh and approved by a doctor.\nAttribute Information:\n\n    Age 1.20-65\n    Sex 1. Male, 2.Female\n    Polyuria 1.Yes, 2.No.\n    Polydipsia 1.Yes, 2.No.\n    sudden weight loss 1.Yes, 2.No.\n    weakness 1.Yes, 2.No.\n    Polyphagia 1.Yes, 2.No.\n    Genital thrush 1.Yes, 2.No.\n    visual blurring 1.Yes, 2.No.\n    Itching 1.Yes, 2.No.\n    Irritability 1.Yes, 2.No.\n    delayed healing 1.Yes, 2.No.\n    partial paresis 1.Yes, 2.No.\n    muscle sti\u000bness 1.Yes, 2.No.\n    Alopecia 1.Yes, 2.No.\n    Obesity 1.Yes, 2.No.\n    Class 1.Positive, 2.Negative.\n    ","d5997565":"#### <div align = center>\\*\\*\\* End ***","23230e69":"###  Dataset Pre-Processing","06809881":"### Standardization of independant variables","4bc68328":"----","85172b33":"#### Polydipsia and Polyuria has some correlation\n**Polyuria** is a condition where the <font color = red>body urinates more than usual <\/font>and passes excessive or abnormally large amounts of urine each time you urinate. Polyuria is defined as the frequent passage of large volumes of urine \u2013 more than 3 litres a day compared to the normal daily urine output in adults of about 1 to 2 litres.\n\n **Polydipsia** is a medical name for the feeling of<font color =red> extreme thirstiness<\/font>. Polydipsia is often linked to urinary conditions that cause you to <font color = red>urinate a lot<\/font>. This can make your body feel a constant need to replace the fluids lost in urination. It can also be caused by physical processes that cause you to lose a lot of fluid.","971f1525":"## Confusion Matrix of all the models","9c9c386e":"## Na\u00efve Bayes","5deeb685":"## Random Forest","38233ea1":"## Support Vector Machine","39242d48":"### Analysing the symptoms","0926a2c3":"#### Polyuria and Polydipsia are the major symptoms if the patient has diabetes.\n\n1. **Polyuria** is a condition where the <font color = red>body urinates more than usual <\/font>and passes excessive or abnormally large amounts of urine each time you urinate. Polyuria is defined as the frequent passage of large volumes of urine \u2013 more than 3 litres a day compared to the normal daily urine output in adults of about 1 to 2 litres.\n\n2. **Polydipsia** is a medical name for the feeling of<font color =red> extreme thirstiness<\/font>. Polydipsia is often linked to urinary conditions that cause you to <font color = red>urinate a lot<\/font>. This can make your body feel a constant need to replace the fluids lost in urination. It can also be caused by physical processes that cause you to lose a lot of fluid.\n---","aa228b0e":"# <div align =center> EDA <\/div>","339c02b4":"---","9b0b95f0":"   # <div align = center>Model Building<\/div>","20c5ad53":"---","ce63c5c9":"### Analysis based on Gender","91ce7e2b":"\n**Polyuria** is a condition where the body urinates more than usual and passes excessive or abnormally large amounts of urine each time you urinate. Polyuria is defined as the frequent passage of large volumes of urine \u2013 more than 3 litres a day compared to the normal daily urine output in adults of about 1 to 2 litres.\n\n**Polydipsia** is a medical name for the feeling of extreme thirstiness. Polydipsia is often linked to urinary conditions that cause you to urinate a lot. This can make your body feel a constant need to replace the fluids lost in urination. It can also be caused by physical processes that cause you to lose a lot of fluid.\n\n**Genital** Thrush (or candidiasis) is a common condition caused by a type of yeast called Candida. It mainly affects the vagina, though may affect the penis too, and can be irritating and painful. Many types of yeast and bacteria naturally live in the vagina and rarely cause problems.\n\n**Partial Paresis** Paresis involves the weakening of a muscle or group of muscles. It may also be referred to as partial or mild paralysis. Unlike paralysis, people with paresis can still move their muscles. These movements are just weaker than normal.\n\n**Polyphagia** also known as hyperphagia, is the medical term for excessive or extreme hunger. It's different than having an increased appetite after exercise or other physical activity. While your hunger level will return to normal after eating in those cases, polyphagia won't go away if you eat more food.\n\n**Alopecia** Areata is a condition that causes hair to fall out in small patches, which can be unnoticeable.\n\n---","ee8eab85":"#### <div align = center>\\*\\*\\* End of EDA **","f6d75adb":"**Number of rows : 520 <br>\nNumber of columns : 17 <br>\nNo missing values**\n\n---","d2d30b8d":"## K Nearest Neighbour","231a5499":"---","96edd887":"## Logistic Regression","5b9746cd":"**Diabetes** is a disease that occurs when your blood glucose, also called<font color =red> blood sugar, is too high<\/font>. Blood glucose is your main source of energy and comes from the food you eat. Insulin, a hormone made by the pancreas, helps glucose from food get into your cells to be used for energy.","f070cdfa":"### Analysing the age group"}}