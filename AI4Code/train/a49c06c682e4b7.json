{"cell_type":{"c51fb492":"code","88b485d1":"code","41560a64":"code","5b5f64cc":"code","12f8339d":"code","c68da5b5":"code","105b313d":"markdown"},"source":{"c51fb492":"import pandas as pd\nimport numpy as np\n\nfiles = ['..\/input\/gb-vpp-pulp-fiction-abb651\/median_submission.csv',\n         '..\/input\/dnn-lstm-tpu\/median_submission.csv',\n         '..\/input\/vpp-a-basic-ensembling-technique-with-ridgecv\/submission_pp.csv'\n         ]\nscores=(1-np.array([0.1393,0.1389,0.1413]))\n\nscores=(scores)\/(np.sum(scores))\n\nprint(np.sum(scores))\ndictionary=dict(list(zip(files,list(scores))))\n\nsub = pd.read_csv('..\/input\/ventilator-pressure-prediction\/sample_submission.csv')\n\nframes=list()\nfor f,s in zip(files,scores):\n    f=pd.read_csv(f)\n    f['pressure']*=s\n    frames.append(f)\nsub['pressure'] = np.sum(np.concatenate([f['pressure'].values.reshape(-1, 1) for f in frames], axis=1), axis=1)\nsub.to_csv('submission.csv', index=False)\nsub.head(5)\n","88b485d1":"print(scores)","41560a64":"df_train = pd.read_csv(\"..\/input\/ventilator-pressure-prediction\/train.csv\")\nunique_pressures = df_train[\"pressure\"].unique()\nsorted_pressures = np.sort(unique_pressures)","5b5f64cc":"total_pressures_len = len(sorted_pressures)\n\ndef find_nearest(prediction):\n    insert_idx = np.searchsorted(sorted_pressures, prediction)\n    if insert_idx == total_pressures_len:\n        # If the predicted value is bigger than the highest pressure in the train dataset,\n        # return the max value.\n        return sorted_pressures[-1]\n    elif insert_idx == 0:\n        # Same control but for the lower bound.\n        return sorted_pressures[0]\n    lower_val = sorted_pressures[insert_idx - 1]\n    upper_val = sorted_pressures[insert_idx]\n    return lower_val if abs(lower_val - prediction) < abs(upper_val - prediction) else upper_val","12f8339d":"%%time\nsub[\"pressure\"] = sub[\"pressure\"].apply(find_nearest)","c68da5b5":"sub.to_csv(\"submission.csv\", index=False)","105b313d":"This notebook referred to the following.\n\nhttps:\/\/www.kaggle.com\/ambrosm\/vent-011-median-wins"}}