{"cell_type":{"258e6777":"code","ecd0cc9b":"code","92318b03":"code","6238508e":"code","37ef73a5":"code","719bd6be":"code","97f4433e":"code","6bcd5fff":"code","66100a41":"code","2164f631":"code","e147a6cc":"code","a745cace":"code","5fa8bdf6":"code","270ba92b":"code","223509aa":"markdown","6b7387d9":"markdown","7e59438e":"markdown","db74fe99":"markdown","a7c29609":"markdown","595304a5":"markdown","aa84bb51":"markdown","c752acea":"markdown","9b08f846":"markdown","eddd1d96":"markdown","65a8e334":"markdown","b5cb5f29":"markdown","e277b110":"markdown","eac006e0":"markdown"},"source":{"258e6777":"!pip install backtrader backtrader_plotting","ecd0cc9b":"import backtrader as bt\nfrom datetime import datetime\nimport matplotlib\n# \u4e92\u52d5\u5716\u8868\nfrom backtrader_plotting import Bokeh\n# Tradimo \u6216 Blackly\nfrom backtrader_plotting.schemes import Blackly","92318b03":"%matplotlib inline","6238508e":"cerebro = bt.Cerebro()","37ef73a5":"cerebro.broker.setcash(1e5)","719bd6be":"cerebro.broker.setcommission(\n    # \u5982\u679c\u6709\u8a2d\u5b9a margin \uff0c\u5247\u6b64\u50ad\u91d1\u70ba\u56fa\u5b9a\u6578\u91cf\uff0c\u53cd\u4e4b\u5247\u70ba\u767e\u5206\u6bd4 % \u6578\n    # \u6b64\u8655\u5247\u70ba\u8cb7\u3001\u8ce3\u56fa\u5b9a 2.0 \u6b50\u5143\n    commission=2.0,\n    \n    # \u7576\u9700\u8981\u6a21\u64ec\u4fdd\u8b49\u91d1\u4ea4\u6613(\u671f\u8ca8\u3001\u5408\u7d04\u4ea4\u6613)\u7b49\u64cd\u4f5c\u6642\u9700\u8981\u4f7f\u7528\n    # \u5982\u679c\u9019\u500b\u53c3\u6578\u662f 0 \uff0c\u5247\u4f63\u91d1\u70ba\u767e\u5206\u6bd4 % \u6578\n    margin=2000.0,\n    \n    # \u5728\u9032\u884c\u671f\u8ca8\u7b49\u4ea4\u6613\u6642\u53ef\u4ee5\u8a2d\u5b9a\u7684\u69d3\u687f\u500d\u6578\n    mult=10.0,\n    \n    # \u7576\u9700\u8981\u540c\u6642\u958b\u555f\u591a\u7b46\u4ea4\u6613\u6642\u53ef\u4ee5\u8a2d\u5b9a\uff0c\u6703\u4ee5\u540d\u7a31\u5340\u9694\u4ea4\u6613\u7e3e\u6548\n    name=\"Eurostoxxx50\"\n)\n","97f4433e":"# \u56fa\u5b9a\u8cfc\u8cb7 20 \u80a1\ncerebro.addsizer(bt.sizers.SizerFix, stake=20)","6bcd5fff":"# \u4ea4\u6613\u5206\u6790 (\u7b56\u7565\u52dd\u7387)\ncerebro.addanalyzer(bt.analyzers.TradeAnalyzer, _name='TradeAnalyzer')\n\n# \u4ea4\u6613\u57fa\u672c\u7d71\u8a08\u5206\u6790\ncerebro.addanalyzer(bt.analyzers.PeriodStats, _name='PeriodStats')\n\n# \u56de\u843d\u7d71\u8a08\ncerebro.addanalyzer(bt.analyzers.DrawDown, _name='DrawDown')\n\n# \u671f\u671b\u7372\u5229\/\u6a19\u6e96\u5dee System Quality Number\ncerebro.addanalyzer(bt.analyzers.SQN, _name='SQN')\n\n# \u590f\u666e\u6307\u6578 \ncerebro.addanalyzer(bt.analyzers.SharpeRatio, _name='SharpeRatio')","66100a41":"data = bt.feeds.YahooFinanceData(\n    # \u80a1\u7968\u8cc7\u6599\u4f4d\u7f6e\n    dataname='..\/input\/quantitative-trading\/TSLA.csv',\n    \n    # \u8cc7\u6599\u8d77\u59cb\u65e5\n    fromdate=datetime(2010, 7, 1),\n    \n    # \u8cc7\u6599\u7d50\u675f\u65e5\n    todate=datetime(2020, 1, 1)\n)\n","2164f631":"cerebro.adddata(data)","e147a6cc":"print('\u6295\u8cc7 > \u8d77\u59cb\u8cc7\u7522 %.2f \ud83d\udcb2' % cerebro.broker.getvalue())\ncerebro.run()\nprint('\u6295\u8cc7 > \u7d50\u675f\u8cc7\u7522 %.2f \ud83d\udcb2' % cerebro.broker.getvalue())","a745cace":"# cerebro.plot()","5fa8bdf6":"# b = Bokeh(style='bar', plot_mode='single', scheme=Blackly())\n# cerebro.plot(b)","270ba92b":"# 1. \u7e7c\u627f Backtrader\nclass BuyAndHold(bt.Strategy):\n    # 2. \u53ef\u4ee5\u8a2d\u5b9a\u9019\u500b\u7b56\u7565\u7684\u53ef\u8b8a\u53c3\u6578\n    params = (('slow', 15), ('fast', 5))\n    \n    # 3. \u5efa\u69cb\u5b50\uff1a\u521d\u59cb\u5316\u7b56\u7565\uff0c\u6709\u4e9b\u7b56\u7565\u9700\u8981\u6709\u6b77\u53f2\u8cc7\u6599\u8a55\u4f30\uff0c\u5c31\u9700\u8981\u5728\u6b64\u8a2d\u5b9a\n    def __init__(self):\n        pass\n    \n    # \u5728\u7b56\u7565\u958b\u59cb\u6642\u8abf\u7528\n    def start(self):\n        pass\n    \n    # \u7d00\u9304\u4ea4\u6613\u8a0a\u606f\uff0c\u53ef\u4ee5\u984d\u5916\u8a2d\u5b9a\u662f\u5426\u986f\u793a\u7d00\u9304\u3001\u65e5\u671f\u7b49\uff0c\u50cf\u4e00\u822c\u6211\u5011\u6539\u5beb\u51fd\u6578\u5373\u53ef\uff0c\u975e\u5e38\u76f4\u89ba\n    def log(self, txt):\n        pass\n    \n    # \u5728\u6bd4\u5c0d\u5b8c\u6700\u65b0\u7684\u6536\u76e4\u50f9\u683c\u5f8c\u8abf\u7528\n    def next(self):\n        \n        # \u8cb7\u5165\u51fd\u6578\n        buy_info = self.buy(\n            # \u4ea4\u6613\u6578\u91cf\uff0c\u9810\u8a2d\u53ef\u4ee5\u7531 getsizer \u53d6\u5f97\n            size=10,\n            \n            # \u5982\u679c\u9700\u8981\u8a2d\u5b9a\u9650\u50f9\u55ae\u7684\u8a71\uff0c\u53ef\u4ee5\u8a2d\u5b9a\u9019\u500b\u53c3\u6578\n            plimit=100\n        )\n        \n        # \u8ce3\u51fa\u51fd\u6578\n        sell_info = self.sell(\n            # \u4ea4\u6613\u6578\u91cf\uff0c\u9810\u8a2d\u53ef\u4ee5\u7531 getsizer \u53d6\u5f97\n            size=10,\n            \n            # \u5982\u679c\u9700\u8981\u8a2d\u5b9a\u9650\u50f9\u55ae\u7684\u8a71\uff0c\u53ef\u4ee5\u8a2d\u5b9a\u9019\u500b\u53c3\u6578\n            plimit=100\n        )\n        \n        pass\n    \n    # \u5728\u7b56\u7565\u7d50\u675f\u5f8c\u8abf\u7528\n    def stop(self):\n        pass\n    \n    # \u5728\u7b56\u7565\u653e\u7f6e\u8a02\u55ae\u5f8c\u8abf\u7528\uff0c\u53d6\u5f97\u8a02\u55ae\u8cc7\u8a0a\n    def notify_order(self, order):\n        pass\n    \n    # \u5728\u7b56\u7565\u4ea4\u6613\u5f8c\u8abf\u7528\uff0c\u53d6\u5f97\u4ea4\u6613\u8cc7\u8a0a\n    def notify_trade(self, trade):\n        pass","223509aa":"### \u8a2d\u5b9a\u904b\u884c\u74b0\u5883","6b7387d9":"### \u7e6a\u88fd\u4e92\u52d5\u5716\u8868","7e59438e":"## Backtrader","db74fe99":"## \u7b56\u7565\u683c\u5f0f\n\n---\n\n\u4ea4\u6613\u7b56\u7565\u7684\u958b\u767c\u975e\u5e38\u7c21\u55ae\uff0c\u53ea\u9700\u5148\u7e7c\u627f bt.Strategy\uff0c\u518d\u8abf\u7528\u5e7e\u9805\u985e\u5225\u51fd\u6578\u5373\u53ef [\u8a73\u7d30\u4f7f\u7528\u6587\u4ef6](https:\/\/www.backtrader.com\/docu\/strategy\/)","a7c29609":"### \u5c07\u8cc7\u6599\u5f15\u5165\u74b0\u5883","595304a5":"### \u7e6a\u88fd\u5716\u8868","aa84bb51":"### \u52a0\u5165\u5206\u6790\u6307\u6a19 (\u9078\u7528)\n\n\u53ef\u81ea\u884c\u8a2d\u5b9a _name \u547c\u53eb\u53c3\u6578\uff0c\u4f8b\u5982\u8a2d\u5b9a\u70ba 'SharpeRatio' \u5247\u53ef\u900f\u904e analyzers.SharpeRatio.get_analysis() \u53d6\u5f97\u66f4\u7d30\u7bc0\u7684\u5206\u6790","c752acea":"### \u904b\u884c\u74b0\u5883","9b08f846":"### \u5f15\u5165\u8cc7\u6599 - \u53ef\u4ee5\u662f [YAHOO Finance](https:\/\/finance.yahoo.com\/) \u4e2d\u4e0b\u8f09\u7684 CSV","eddd1d96":"### \u8a2d\u5b9a\u6301\u6709\u8cc7\u7522\n\n1e5 \u5c31\u662f 1 * 10 ^ 5","65a8e334":"## \u5b89\u88dd\u53ca\u5f15\u5165\u65b9\u5f0f","b5cb5f29":"### \u8a2d\u5b9a\u4ea4\u6613\u69d3\u687f\u500d\u7387","e277b110":"[Backtrader](https:\/\/www.backtrader.com\/) \u662f\u4e00\u500b\u57fa\u65bc Python \u8a9e\u8a00\u7684\u9032\u884c\u81ea\u52d5\u5316\u56de\u6eaf\u6e2c\u8a66\u7684\u5e73\u81fa\u3002\u53ef\u4ee5\u65b0\u589e\u81ea\u5b9a\u7fa9\u7684\u6307\u6a19\u548c\u4ea4\u6613\u7b56\u7565,\u63d0\u9ad8\u5c0d\u4ea4\u6613\u7cfb\u7d71\u56de\u6e2c\u7684\u6548\u7387\uff0c\u9019\u500b\u5de5\u5177\u53ef\u4ee5\u532f\u5165\u81ea\u5df1\u7684\u884c\u60c5\u8cc7\u6599\u6a94\u6848\uff0c\u4e5f\u53ef\u4ee5\u65b0\u589e\u81ea\u5b9a\u7fa9\u7684\u6307\u6a19\uff0c\u6e2c\u8a66\u7d50\u675f\u5f8c\u80fd\u986f\u793a\u6307\u6a19\u548c\u884c\u60c5\u5716\u8868\uff0c\u800c\u4e14\u53ef\u4ee5\u5c0d\u6307\u6a19\u7684\u4e0d\u540c\u5f15\u6578\u8a2d\u5b9a\u9032\u884c\u6279\u91cf\u6e2c\u8a66\uff01\n\n\u5982\u679c\u6709\u8208\u8da3\u9084\u53ef\u4ee5\u8ddf\u4e16\u754c\u4e0a\u6240\u6709\u6295\u8cc7\u5ba2\u5728 [\u5b98\u65b9\u8ad6\u58c7](https:\/\/community.backtrader.com\/) \u4ea4\u6d41","eac006e0":"### \u8a2d\u5b9a\u4ea4\u6613\u624b\u7e8c\u8cbb(\u7d93\u7406\u4eba\u50ad\u91d1\u3001\u5e73\u53f0\u624b\u7e8c\u8cbb)\n\n\u4ee5\u4e0b\u70ba\u5728\u4ea4\u6613 Euro Stoxx 50 ETF \u7684\u4ea4\u6613\u50ad\u91d1\u8a2d\u5b9a"}}