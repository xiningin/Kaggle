{"cell_type":{"f297ee9f":"code","e6762dc3":"code","58fd0a86":"code","df34c797":"code","c1f4670f":"code","6bf3f986":"code","ce248cfc":"code","7efe8369":"code","b4d8621e":"code","1ee4245c":"code","a9245b4c":"code","df2b4862":"code","f4f169c0":"code","e0fc656f":"code","46ad44ff":"code","ec7341c2":"code","c9915a5d":"code","a915e86c":"code","fa2b8369":"code","34043a25":"code","6f58d164":"code","4d8d2ba2":"code","ed35a19f":"code","68527c3e":"code","d29cb97a":"code","b0f0df6f":"code","a142cbd3":"code","12548293":"code","6f4deb7c":"code","54f571ea":"code","758dbbd6":"code","3326b1c5":"code","6d80e8cb":"code","679ae073":"code","f9fe9eb6":"code","4af259f7":"code","28935d4b":"code","072f1720":"code","cf246d06":"code","47fe9616":"code","88718d79":"code","5ef5db14":"code","cbb3dd28":"code","b8838195":"code","0f5da1c8":"code","57fb3a28":"code","ef768509":"code","1616cdc1":"code","56ea9edc":"code","c472a270":"code","c96aafec":"code","617f3a05":"code","8c041ae5":"code","ac8eb556":"code","9a77d7ce":"code","cf99b1d6":"code","c42998e5":"code","d6361254":"code","5622039a":"code","280c5b6c":"code","7d06b64c":"code","d72d12b4":"code","15195ffc":"code","ac03db9c":"code","edf07b17":"code","f8ea12ab":"code","c51aef0d":"code","84cdcb0d":"code","4a0050a0":"code","8e30d45c":"code","4833bbcb":"code","49230923":"code","0d520395":"code","78b799d5":"code","b5fd601f":"code","a79c777f":"code","9f844834":"code","d50ebb4b":"code","e0087387":"code","ef4ade1a":"code","9bcc6676":"markdown","06054128":"markdown","893f4971":"markdown","7a06c3dd":"markdown","8218b927":"markdown","aa478145":"markdown","7d1c2acd":"markdown","27468d56":"markdown","45a412ec":"markdown","ffe6422b":"markdown","c992dc39":"markdown","cb7b099a":"markdown","02cb0c5e":"markdown","1e0e5c0f":"markdown","0fb629bf":"markdown","e557d6ca":"markdown","d6c5a5d0":"markdown","cf3db938":"markdown","b241de3c":"markdown","2f04d20b":"markdown","49c11ecc":"markdown","ce6dcd27":"markdown","6a7fe725":"markdown","14314d84":"markdown","9e7afff4":"markdown","8ed8750d":"markdown","34e68f80":"markdown","5cd1c82a":"markdown","2545fbd1":"markdown","22c30dd2":"markdown","6f48c23f":"markdown","9ab1907d":"markdown","4c58a0d7":"markdown","b5ba1ce8":"markdown","eb77f855":"markdown","6188eda5":"markdown","8907d27b":"markdown","a3c2f542":"markdown","cf0a3c7e":"markdown","5eba1adb":"markdown","f3b3194b":"markdown","0b63ecfa":"markdown","9d732e75":"markdown","9ef75e30":"markdown","ac18c991":"markdown","bcbac3cc":"markdown","40de0b9b":"markdown","9d33b508":"markdown","de8446e4":"markdown","bb591d15":"markdown","4e8db549":"markdown","724c4333":"markdown","793f3981":"markdown","291fcadd":"markdown","9cbe6148":"markdown","7f11d952":"markdown"},"source":{"f297ee9f":"import numpy as np \nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')","e6762dc3":"data=pd.read_csv(\"..\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv\")","58fd0a86":"data.shape","df34c797":"data.head(10)","c1f4670f":"list(data.columns)","6bf3f986":"data=data.drop([\"id\"], axis=1)","ce248cfc":"# This code also helps us extract numeric columns, isn't that a good thing?\ndata.describe()","7efe8369":"data.info()","b4d8621e":"data_dtype = data.dtypes\ndata_dtype.value_counts()","1ee4245c":"# Let's look at the unique values for each column:\nfor i in data.columns:\n    print(i,data[i].unique())","a9245b4c":"data.isnull().sum().any()","df2b4862":"# Draw the missing values on the map.\nsns.heatmap(data.isnull(),cbar=True, cmap='viridis')","f4f169c0":"#The heat map shows the relationships between the columns and each other, it's good.\nfig, ax = plt.subplots(figsize=(15,15))\nsns.heatmap(data.corr(), annot=True, linewidths=.5, ax=ax)\nplt.show()","e0fc656f":"data.hist(figsize=(18,10))\nplt.show()","46ad44ff":"data[\"bmi\"].isnull().sum()","ec7341c2":"bmi_mean = data.bmi.mean()\nbmi_median = data.bmi.median()\ndata['bmi_mean'] = data.bmi.fillna(bmi_mean)\ndata['bmi_median'] = data.bmi.fillna(bmi_median)\n\n#Now let's draw the new columns\nsns.kdeplot(data['bmi_mean'],color='red',label='Mean')\nsns.kdeplot(data['bmi_median'],color='blue',label='Median')\nsns.kdeplot(data['bmi'],color='black',label='Original')\nplt.legend()\n","c9915a5d":"#Take a look at the exact results we got, the results are good, aren't they?\ndata.head(10)","a915e86c":"data[\"stroke\"].value_counts()","fa2b8369":"sns.countplot(data=data,x='stroke')","34043a25":"class_occur = data['stroke'].value_counts()\nclass_names = ['No Stroke','Stroke']\nfig, ax = plt.subplots()\nax.pie(class_occur, labels=class_names, autopct='%1.2f%%',\n        shadow=True, startangle=0, counterclock=False)\nax.axis('equal')  # Equal aspect ratio ensures that pie is drawn as a circle.\nax.set_title('Class distribution')\nplt.show()","6f58d164":"# Here we will convert that column to the three distinct elements.\ndata[\"gender\"]=data[\"gender\"].map({\"Male\":0 , \"Female\":1 , \"Other\":2})","4d8d2ba2":"# Let's look at the different values for that column.\ndata[\"gender\"].unique()","ed35a19f":"#The results of the previous code are interesting so let's look at the number of each of those values.\ndata[\"gender\"].value_counts()","68527c3e":"# The following figure shows that the number of women is higher than the number of men, so we may witness a bias in the results in favor of women.\nsns.countplot(data=data,x='gender')","d29cb97a":"sns.countplot(data=data,x='gender',hue='stroke')","b0f0df6f":"data[\"age\"].describe()","a142cbd3":"sns.boxplot('age',data=data) \nplt.xlabel('age Column Distribution')","12548293":"# Let's see the distribution of the data.\n#histogram\nsns.distplot(data['age'])","6f4deb7c":"# This instruction shows the number of unique elements in the column, not the values.\ndata[\"age\"].nunique()","54f571ea":"# I set this function to achieve what we want:\ndef age_groups(age):\n    if age >= 75:\n        return('+75 ')\n    elif age > 65:\n        return('66 - 75 ')\n    elif age > 55:\n        return('56 - 65 ')\n    elif age > 45:\n        return('46 - 55 ')\n    elif age > 35:\n        return('36 - 45 ')\n    elif age > 25:\n        return('26 - 35 ')\n    elif age > 18:\n        return('19 - 25 ')\n    elif age > 0:\n        return('0 - 18 ')\n    else:\n        return(None)","758dbbd6":"# Now I will create a new column to display the results.\ndata['Age_group'] = data['age'].apply(age_groups)","3326b1c5":"data.head(10)","6d80e8cb":"sns.countplot(data=data,x='gender',hue='Age_group')","679ae073":"fig = sns.FacetGrid(data, hue=\"stroke\",aspect=4)\nfig.map(sns.kdeplot,'age',shade= True)\noldest = data['age'].max()\nfig.set(xlim=(0,oldest))\nfig.add_legend()","f9fe9eb6":"data[\"hypertension\"].unique()","4af259f7":"sns.countplot(data=data,x='gender',hue='hypertension')","28935d4b":"plt.figure(figsize=(12,6))\nsns.countplot(x=\"Age_group\",hue=\"hypertension\" , data=data,palette=\"rocket\")","072f1720":"data[\"heart_disease\"].unique()","cf246d06":"fig = sns.FacetGrid(data, hue=\"heart_disease\",aspect=4)\nfig.map(sns.kdeplot,'age',shade= True)\noldest = data['age'].max()\nfig.set(xlim=(0,oldest))\nfig.add_legend()","47fe9616":"sns.countplot(data=data,x='hypertension',hue='heart_disease')","88718d79":"data[\"ever_married\"].unique()","5ef5db14":"# Here we will convert that column to the three distinct elements.\ndata[\"ever_married\"]=data[\"ever_married\"].map({\"Yes\":1 , \"No\":0 })","cbb3dd28":"sns.countplot(data=data,x='gender',hue='ever_married')","b8838195":"#Here is a more accurate ratio for married and unmarried people.\nclass_occur = data['ever_married'].value_counts()\nclass_names = ['Married','No married']\nfig, ax = plt.subplots()\nax.pie(class_occur, labels=class_names, autopct='%1.2f%%',\n        shadow=True, startangle=0, counterclock=False)\nax.axis('equal')  # Equal aspect ratio ensures that pie is drawn as a circle.\nax.set_title('Class distribution')\nplt.show()","0f5da1c8":"fig = sns.FacetGrid(data, hue=\"ever_married\",aspect=4)\nfig.map(sns.kdeplot,'gender',shade= True)\noldest = data['gender'].max()\nfig.set(xlim=(0,oldest))\nfig.add_legend()","57fb3a28":"fig = sns.FacetGrid(data, hue=\"stroke\",aspect=4)\nfig.map(sns.kdeplot,'gender',shade= True)\noldest = data['gender'].max()\nfig.set(xlim=(0,oldest))\nfig.add_legend()","ef768509":"sns.countplot(data=data,x='Age_group',hue='ever_married')","1616cdc1":"data.head()","56ea9edc":"data[\"work_type\"].unique()","c472a270":"data[\"work_type\"].value_counts()","c96aafec":"# Here we get the most accurate proportions.\nclass_occur = data['work_type'].value_counts()\nclass_names = ['Private', 'Self-employed', 'Govt_job', 'children', 'Never_worked']\nfig, ax = plt.subplots()\nax.pie(class_occur, labels=class_names, autopct='%1.2f%%',\n        shadow=True, startangle=0, counterclock=False)\nax.axis('equal')  # Equal aspect ratio ensures that pie is drawn as a circle.\nax.set_title('Class distribution')\nplt.show()","617f3a05":"sns.countplot(data=data,x='work_type',hue='ever_married')","8c041ae5":"sns.countplot(data=data,x='work_type',hue='stroke')","ac8eb556":"sns.countplot(data=data,x='work_type',hue='gender')","9a77d7ce":"# Of course, I can carry out this process through one of the tools, but it is okay, the conversion elements are few.\n# Here we will convert that column to the three distinct elements.\ndata[\"work_type\"]=data[\"work_type\"].map({'Private':0, 'Self-employed':1, 'Govt_job':2, 'children':3, 'Never_worked':4 })","cf99b1d6":"data[\"work_type\"].unique()","c42998e5":"data[\"Residence_type\"].value_counts()","d6361254":"# Here we get the most accurate proportions.\nclass_occur = data['Residence_type'].value_counts()\nclass_names = ['Urban', 'Rural']\nfig, ax = plt.subplots()\nax.pie(class_occur, labels=class_names, autopct='%1.2f%%',\n        shadow=True, startangle=0, counterclock=False)\nax.axis('equal')  # Equal aspect ratio ensures that pie is drawn as a circle.\nax.set_title('Class distribution')\nplt.show()","5622039a":"sns.countplot(data=data,x='Residence_type',hue='work_type')","280c5b6c":"sns.countplot(data=data,x='Residence_type',hue='gender')","7d06b64c":"data[\"avg_glucose_level\"].describe()","d72d12b4":"data[\"avg_glucose_level\"].value_counts()","15195ffc":"sns.boxplot('avg_glucose_level',data=data) \nplt.xlabel('avg_glucose_level Column Distribution')","ac03db9c":"sns.displot(data['avg_glucose_level'])","edf07b17":"# I set this function to achieve what we want:\ndef age_groups(age):\n    if age >= 145:\n        return('+146 ')\n    elif age > 135:\n        return('136 - 145 ')\n    elif age > 125:\n        return('126 - 135 ')\n    elif age > 115:\n        return('116 - 125 ')\n    elif age > 105:\n        return('106 - 115 ')\n    elif age > 95:\n        return('96 - 105 ')\n    elif age > 85:\n        return('86 - 95 ')\n    elif age > 75:\n        return('76 - 85 ')\n    elif age > 65:\n        return('66 - 75 ')\n    elif age > 54:\n        return('55 - 65')\n    else:\n        return(None)","f8ea12ab":"# Now I will create a new column to display the results.\ndata['avg_glucose_level_group'] = data['avg_glucose_level'].apply(age_groups)","c51aef0d":"data.head()","84cdcb0d":"fig = sns.FacetGrid(data, hue=\"Age_group\",aspect=4)\nfig.map(sns.kdeplot,'avg_glucose_level',shade= True)\noldest = data['avg_glucose_level'].max()\nfig.set(xlim=(0,oldest))\nfig.add_legend()","4a0050a0":"plt.figure(figsize=(12,6))\nsns.countplot(data=data,x='avg_glucose_level_group',hue='gender')","8e30d45c":"data[\"bmi_median\"].nunique()","4833bbcb":"data[\"bmi_median\"].describe()","49230923":"sns.boxplot('bmi_median',data=data) \nplt.xlabel('bmi_median Column Distribution')","0d520395":"sns.distplot(data['bmi_median']);","78b799d5":"data[\"smoking_status\"].unique()","b5fd601f":"#Let's see these values on the graph.\nsns.countplot(data=data,x='smoking_status')","a79c777f":"sns.countplot(data=data,x='smoking_status',hue='gender')","9f844834":"sns.countplot(data=data,x='smoking_status',hue='stroke')","d50ebb4b":"#Here we perform the process of data transformation to facilitate data visualizations.\ndata[\"smoking_status\"]=data[\"smoking_status\"].map({'formerly smoked':0, 'never smoked':1, 'smokes':2, 'Unknown':3 })","e0087387":"fig = sns.FacetGrid(data, hue=\"Age_group\",aspect=4)\nfig.map(sns.kdeplot,'smoking_status',shade= True)\noldest = data['smoking_status'].max()\nfig.set(xlim=(0,oldest))\nfig.add_legend()","ef4ade1a":"data[\"smoking_status\"].value_counts()","9bcc6676":"> **The rates of high blood pressure increase significantly, starting from the age of 36 and increasing until I reach the age of 80, and these values were referred to previously, in the same years the rates of heart attack increase in women.**\n\n> **focus more...**","06054128":"# EDA : FOR Gender column ","893f4971":"> **We note here the presence of some outliers far from all the larger data.**","7a06c3dd":"> **Women suffer from high blood pressure less than men, and this is due to the fact that the number of women included in the data is greater than the number of men.**","8218b927":"# EDA : for bmi_median column\n\n> bmi: body mass index","aa478145":"> **After looking at some reviews and papers, we can conclude that the relationship between body mass and stroke incidence is ambiguous. There are no bases that we can take in the analysis. We were able to establish a strong relationship between stroke disease and body mass, so to delve deeper into this problem we need to expand the data And adding more features that have a relationship between the two.**","7d1c2acd":"> **At that stage, I analyzed and explored the data in detail about ways to review the features affecting the goal and extract information from it, and that was the first stage.**\n\n> **In the next stage, I will use machine learning algorithms and neural networks to reach as accurate as possible the correct results of the test data.**\n\n# Thank you very much .","27468d56":"> **We note that married people working in the private sector are higher than the rest of the groups, and this can be due to several factors, including that the salaries of workers in the private sector are higher and therefore they can marry.**","45a412ec":"# EDA : General data exploration","ffe6422b":"# EDA : for stroke (target) column","c992dc39":"> **From the figure, we can say that the rates of stroke in women increase from the beginning of the year 35 to reach their maximum in the year 46 and continue until the year 55.**","cb7b099a":"> **The following figure is in order to determine the proportions of stroke incidence from no injury in the data.**","02cb0c5e":"> **From the figure, we notice that the rate of heart disease increases from the beginning of the year 50 and continues to increase steadily until it reaches the age of 80, and therefore this category is the most vulnerable to stroke disease.**","1e0e5c0f":"> **The percentage of married women is higher than the males.**","0fb629bf":"**This feature seems to be ineffective. It will be influential if we expand the data to include more features about each current column in the data. It also varies from one country to another in terms of education, income, health, marriage, and others, and this greatly affects the rate of stroke.**","e557d6ca":"> **The rate of marriage of men and women increases significantly from the year 35 and continues to rise until it reaches its maximum value in 55 years and then begins to decline slightly.**","d6c5a5d0":"**In the next few lines of code, I reviewed several features that affect the individual and that may lead to a stroke. I reviewed those features and explained the results we obtained in detail....\nEnjoy learning...**","cf3db938":"**It is clear that the percentage of workers in the private sector consists of married women, and therefore they are more likely to have a stroke.**","b241de3c":"# EDA : for Age column","2f04d20b":"> **In general, the number of cases of infection increases significantly between the sexes, starting from the age of 50 years and continues to rise frighteningly, reaching the maximum number of cases between 74 years and 80 years, according to the largest value in the age column that we have come to in the data.**","49c11ecc":"> **hypertension: 0 if the patient doesn't have hypertension, 1 if the patient has hypertension**","ce6dcd27":"> **To solve the problem of empty values in that column, I will replace those empty values. I will create two columns that will carry the new values, and I will replace the empty values with the mean and median of the original column, and to make sure that the results I got are the best results that I can reach, I will draw a normal distribution For data before substitution, for data after substitution with mean, and for data after substitution with median, all of this is in one form.**","6a7fe725":"\n<h1 align=\"center\"> Stroke data Analysis and Exploration<\/h1>\n<center><img src=\"https:\/\/th.bing.com\/th\/id\/OIP.jJJIzT7fHknFNlCVk1dJigHaEK?pid=ImgDet&rs=1\" width=\"60%\" >\n","14314d84":"**The difference between the place of residence is almost non-existent, so let's continue and see, perhaps the place of residence affects other things.....**","9e7afff4":"# Let's take a look at the data","8ed8750d":"# Reading Dataset","34e68f80":"> **Whenever a person suffers from an increased heart rate, he is also at risk of developing heart disease and consequently having a stroke.**","5cd1c82a":"> **heart_disease: 0 if the patient doesn't have any heart diseases, 1 if the patient has a heart disease**","2545fbd1":"> **To facilitate the analysis, we modified the previous split function and modified it for column division.**","22c30dd2":"# EDA : Deeper","6f48c23f":"> **Relying on the previous graphs, and since women are more numerous, the marriage rate of women is higher than men, and the rate of high blood pressure in women is higher than men, and based on the values of previous ages, we conclude that the incidence of stroke diseases among married people is higher.**","9ab1907d":"> **We note from the figure that there is no difference in the incidence of stroke disease or not, whether the person is a smoker or not, or a former smoker.**\n\n> **But we notice a very small increase in the incidence of stroke among smokers and former smokers.**\n\n> **So you have to quit smoking.**","4c58a0d7":"> **We note here that the number of infected women is slightly greater than the number of women, and this may be due to the fact that the data includes more women than men**","b5ba1ce8":"**But everything has its consequences. From the figure, we note the high rate of stroke among people working in the private sector.**","eb77f855":"# Handling Missing Values","6188eda5":"> **To facilitate the analysis process, I divided the age column into age groups, as follows:**\n* 0 - 18\n* 19 - 25 \n* 26 - 35 \n* 36 - 45 \n* 46 - 55 \n* 56 - 65 \n* 66 - 75 \n* +75 ","8907d27b":"# The End","a3c2f542":"> **Now let's start asking questions and answering them through analysis, let's change the plan. I will answer the questions without asking a question, meaning that I will leave the leadership to the data, where will it take me.**","cf0a3c7e":"# Missing Values:","5eba1adb":"# Here is a definition of these columns:\nAttribute Information\n* id: unique identifier\n* gender: \"Male\", \"Female\" or \"Other\"\n* age: age of the patient\n* hypertension: 0 if the patient doesn't have hypertension, 1 if the patient has hypertension\n* heart_disease: 0 if the patient doesn't have any heart diseases, 1 if the patient has a heart disease\n* ever_married: \"No\" or \"Yes\"\n* work_type: \"children\", \"Govt_jov\", \"Never_worked\", \"Private\" or \"Self-employed\"\n* Residence_type: \"Rural\" or \"Urban\"\n* avg_glucose_level: average glucose level in blood\n* bmi: body mass index\n* smoking_status: \"formerly smoked\", \"never smoked\", \"smokes\" or \"Unknown\"*\n* stroke: 1 if the patient had a stroke or 0 if not\n> * **Note: \"Unknown\" in smoking_status means that the information is unavailable for this patient**","f3b3194b":"**We note that women suffer more than men from fluctuations in the level of glucose sugar.**","0b63ecfa":"> **Let's start by asking questions and answering them through analysis, and in doing so we will get rid of missing and outliers and do aggregate data analytics.**\n\n**Let's continue.....**","9d732e75":"> **Here we note the accumulation of average data for glucose glucose between the values of 80 to 100, and we also note some outliers from the largest mass of data, which is higher than 150 for the glucose level.**\n\n> **I didn't get an explanation for why those outliers were.**\n\n> **So if you are a specialist or have an explanation, please tell me in the comments.**","9ef75e30":"> **It is very clear that the number of casualties in this data is very small.**","ac18c991":"> **The volume of data seems rather good in order to build a neural network if necessary**","bcbac3cc":"# EDA : for heart_disease column ","40de0b9b":"# EDA : for ever_married column","9d33b508":"# EDA : for avg_glucose_level column","de8446e4":"# EDA : for smoking_status column","bb591d15":"> **We note that the values combine between the values of 30 years and approximately 60 years.**","4e8db549":"> **It seems that we have missing values that we will deal with when we delve deeper into the analysis at the column level.**","724c4333":"# EDA : for work_type column","793f3981":"# EDA : for hypertension column","291fcadd":"> **From the normal distribution of the data that I obtained, we notice that the three curves apply to each other, and therefore this is an excellent indicator of the quality of the results, but there is something that bothers me, which is the upper part of the curve, but it is OK, so far.**","9cbe6148":"# EDA : for Residence_type column","7f11d952":"> **One of the columns has a positive skewness with a positive tail as well.**"}}