{"cell_type":{"152e5140":"code","90648555":"code","e98c695a":"code","1c5750cd":"code","0207580b":"code","ea2fafec":"code","46271600":"code","34552483":"code","587b1e3e":"code","31bd13a3":"code","3fb8144c":"code","9e95a1f5":"code","5cd0fc45":"code","3e29303d":"code","ed36ce32":"code","427435c4":"code","e07285ed":"code","3635259d":"code","fd473427":"code","4193accd":"code","41424c84":"code","4e8b1644":"code","149deeea":"code","753061c4":"code","e9047f7a":"code","b783656a":"code","02a77c4a":"code","2f497430":"code","dd0aeb26":"markdown","cc2719de":"markdown","f092db56":"markdown","96bd98c8":"markdown","c066e9fd":"markdown","4b71af8d":"markdown","984e2d37":"markdown","72ad481d":"markdown","eac61f5a":"markdown","788459c5":"markdown","dbc8f951":"markdown","7251ce06":"markdown","0a0a3012":"markdown","0adac318":"markdown","11d3088f":"markdown","51d5a9fe":"markdown","191e47ff":"markdown"},"source":{"152e5140":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","90648555":"locations=pd.read_csv('\/kaggle\/input\/zomato-restaurant-info-bengaluru\/zomato_locations.csv')\nlocations.head()","e98c695a":"print(locations.info())\nprint(locations.shape)","1c5750cd":"sns.set()\nsns.heatmap(locations.isnull(), cbar=False, yticklabels=False, cmap='viridis')","0207580b":"locations.isnull().sum()","ea2fafec":"plt.figure(figsize=(8,4))\nsns.heatmap(locations.corr(),cmap='Greens',annot=True)","46271600":"data_sort=locations.sort_values(by='avg_rating',ascending=False)\ndata_sort.head()","34552483":"#histogram of avg_rating\nplt.hist(data_sort['avg_rating'],10)","587b1e3e":"#\nk=pd.pivot_table(data_sort,index='avg_rating',values='count',aggfunc='sum')\nk.plot(kind='bar')","31bd13a3":"sns.catplot(x='avg_rating',kind='box',data=locations)","3fb8144c":"sns.relplot(x='lon',y='lat',hue='avg_rating',data=locations)","9e95a1f5":"import statsmodels.api as sm","5cd0fc45":"y=locations.iloc[:,4].values\nx=locations.iloc[:,1:4].values","3e29303d":"lin_model=sm.OLS(y,x).fit()\nlin_model.summary()","ed36ce32":"from scipy.stats import shapiro\ny_pred=lin_model.predict(x)\nresidual=y-y_pred\nshapiro(residual)","427435c4":"plt.hist(residual)","e07285ed":"#Residual Analysis\nprint(np.mean(residual))\nplt.plot(residual)","3635259d":"from sklearn.metrics import mean_squared_error\nMSE= mean_squared_error(y,y_pred)\nprint(r'The MSE is:',MSE)","fd473427":"data_c=locations.drop(columns=['Name'])\nx=locations.iloc[:,1:].values","4193accd":"#feature scaling\n#from sklearn.preprocessing import StandardScaler\n#from sklearn.preprocessing import MinMaxScaler\n#sc=StandardScaler()\n#sc=MinMaxScaler()\n#x=sc.fit_transform(x)","41424c84":"from sklearn.cluster import KMeans","4e8b1644":"#Finding optimal number of cluster\nwcss=[]\nfor i in range(1,15):\n    km=KMeans(n_clusters=i,init='k-means++',max_iter=300,n_init=10,random_state=0)\n    km.fit(x)\n    wcss.append(km.inertia_)\nplt.plot(range(1,15),wcss)\nplt.title('Elbow Method')\nplt.xlabel('Number of cluster')\nplt.ylabel('wcss')\nplt.show()","149deeea":"kmeans=KMeans(n_clusters=4,init=\"k-means++\",n_init=10,max_iter=300,random_state=0)\ny_kmeans=kmeans.fit_predict(x)","753061c4":"dd=pd.DataFrame(x,columns=['count','lat','lon','avg_rating'])\ndd['cluster'] = y_kmeans\npd.plotting.parallel_coordinates(dd, 'cluster')","e9047f7a":"#for visualization\nplt.scatter(x[y_kmeans==0,0],x[y_kmeans==0,1],s=100,c=\"red\",label=\"cluster-1\")\nplt.scatter(x[y_kmeans==1,0],x[y_kmeans==1,1],s=100,c=\"blue\",label=\"cluster-2\")\nplt.scatter(x[y_kmeans==2,0],x[y_kmeans==2,1],s=100,c=\"green\",label=\"cluster-3\")\nplt.scatter(x[y_kmeans==3,0],x[y_kmeans==3,1],s=100,c=\"cyan\",label=\"cluster-4\")\nplt.scatter(kmeans.cluster_centers_[:,0],kmeans.cluster_centers_[:,1],s=300,c=\"yellow\",label=\"Centroids\")\nplt.title(\"clusters of resturants\")\nplt.legend()\nplt.show()","b783656a":"#for dendogram \nimport scipy.cluster.hierarchy as sch\ndendogram=sch.dendrogram(sch.linkage(x,method=\"ward\"))\nplt.title(\"Dendrogram\")\nplt.xlabel(\"data\")\nplt.ylabel(\"Euclidean Distances\")\nplt.show()","02a77c4a":"#here we get 5 clusters\n#fitting HC_clustering to dataset\nfrom sklearn.cluster import AgglomerativeClustering\nhc=AgglomerativeClustering(n_clusters=4,affinity=\"euclidean\",linkage=\"ward\")\ny_hc=hc.fit_predict(x)","2f497430":"#for Visualization\nplt.scatter(x[y_hc==0,0],x[y_hc==0,1],s=100,c=\"red\",label=\"cluster-1\")\nplt.scatter(x[y_hc==1,0],x[y_hc==1,1],s=100,c=\"blue\",label=\"cluster-2\")\nplt.scatter(x[y_hc==2,0],x[y_hc==2,1],s=100,c=\"green\",label=\"cluster-3\")\nplt.scatter(x[y_hc==3,0],x[y_hc==3,1],s=100,c=\"cyan\",label=\"cluster-4\")\nplt.title(\"clusters of Resturants\")\nplt.legend()\nplt.show()","dd0aeb26":"# Data loading and Libraries","cc2719de":"we see that there is no correlations between given Features.","f092db56":"i)we see that there are total 12000 resturants having rating is 3.8 and approximately 9000 resturants having rating is 4.1.","96bd98c8":"We see that optimal number of cluster are 5.","c066e9fd":"we see that all regressor x1,x2,x3 having p_value is less then 0.05.Hence all three variables are significant.\nAlso R-squared and Adj.R-squared values are closer to 1. Here R-squared is 0.93 we say that 93% of data fit regression model.","4b71af8d":"From above analysis we say that model is not satisfying normality assumption. Hence model is not significant for prediction","984e2d37":"# Exploratory Analysis","72ad481d":"we see that there is no missing values in above sns plot.","eac61f5a":"# AgglomerativeClustering","788459c5":"we see that data is cluster into 4 groups","dbc8f951":"# Checking Missing values","7251ce06":"We see that pvalue is less then 0.05,Hence we reject null hypothesis.Hence residuals are Not normally distributed.","0a0a3012":"# Linear Regression","0adac318":"# Residual Analysis","11d3088f":"# K-Means Clustering","51d5a9fe":"i) we see that there are total 50 locations where highest rating is given for resturants.\nii)There is only one resturants which got zero rating.\nii)Most of resturants having rating is between 3 to 4.5","191e47ff":"we see that data is clustered into 4 groups"}}