{"cell_type":{"420b263b":"code","0a0dae03":"code","21b89440":"code","a43dec21":"code","cc61d1ec":"code","b74c18d8":"code","dfe53df2":"code","33ce7687":"code","90934f6f":"code","bdd55a70":"code","4d61ef48":"code","a3eef10e":"code","061e8533":"code","ab048a10":"code","2c1f14bc":"code","491933f7":"code","1e76051f":"code","2d506716":"code","fcdbae06":"code","d256aebe":"code","ed9f6491":"code","bb06f870":"code","ba22f8d9":"code","0534726f":"code","ca4bdcb0":"code","788e5f4c":"code","c848e094":"code","74295ea9":"code","12ec2677":"code","1d726b0f":"code","4849783f":"code","1b204a89":"code","92e557db":"code","78e1829c":"code","ca84886b":"code","f77d99c6":"code","5fca2d94":"code","f75fe4d6":"code","ce6f07c2":"code","cdf0480f":"code","c3058dbe":"code","80700ced":"code","99f5b54a":"code","f603b9a6":"code","626f57d4":"code","44fb4c3c":"code","a15492c4":"code","6de066e1":"code","6c168d29":"code","3085a66a":"code","4847d65a":"code","7b029c5c":"code","07ba1be9":"markdown","bdb70723":"markdown","0a091390":"markdown","79299f99":"markdown","64444516":"markdown","a12d2646":"markdown","22a0d47e":"markdown","e7f351e1":"markdown","e73f3f75":"markdown"},"source":{"420b263b":"import numpy as np                    #our math guy\nimport pandas as pd                   #our data handling guy\nimport matplotlib.pyplot as plt       #our plotting guy\nimport seaborn as sns                 #our artist lady\nimport plotly.express as px           #our painting grandmaster\n%matplotlib inline                    \n#to keep the paintins inside this frame only\n# Missing data\nimport warnings ## importing warnings library. \nwarnings.filterwarnings('ignore') ## Ignore warning\nimport missingno as msno\nimport os                             #idk really,but i don't mind\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","0a0dae03":"data_tittrain=pd.read_csv(\"..\/input\/titanic\/train.csv\")\ndata_tittest=pd.read_csv(\"..\/input\/titanic\/test.csv\")\ndata_sample=pd.read_csv(\"..\/input\/titanic\/gender_submission.csv\")","21b89440":"#what does sample submission looks like??\n#Ans:The final solution must be predicting whether one survives or not\n#It's a Binary  Classification problem\ndata_sample.head()","a43dec21":"#What does training data looks like?\ndata_tittrain.head()","cc61d1ec":"data_tittrain.sample(5)","b74c18d8":"%%HTML\n<div class='tableauPlaceholder' id='viz1516349898238' style='position: relative'><noscript><a href='#'><img alt='An Overview of Titanic Training Dataset ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ti&#47;Titanic_data_mining&#47;Dashboard1&#47;1_rss.png' style='border: none' \/><\/a><\/noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/> <param name='embed_code_version' value='3' \/> <param name='site_root' value='' \/><param name='name' value='Titanic_data_mining&#47;Dashboard1' \/><param name='tabs' value='no' \/><param name='toolbar' value='yes' \/><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ti&#47;Titanic_data_mining&#47;Dashboard1&#47;1.png' \/> <param name='animate_transition' value='yes' \/><param name='display_static_image' value='yes' \/><param name='display_spinner' value='yes' \/><param name='display_overlay' value='yes' \/><param name='display_count' value='yes' \/><param name='filter' value='publish=yes' \/><\/object><\/div>                <script type='text\/javascript'>                    var divElement = document.getElementById('viz1516349898238');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>","dfe53df2":"data_tittrain.columns","33ce7687":"data_tittrain.corr()","90934f6f":"#correlation map\nf,ax = plt.subplots(figsize=(18, 18))\nsns.heatmap(data_tittrain.corr(), annot=True, linewidths=.5, fmt= '.1f',ax=ax)\nplt.show()","bdd55a70":"data_tittrain.info()\ndata_tittrain.describe()","4d61ef48":"#what does the test data looks like??\ndata_tittest.head()","a3eef10e":"data_tittest.info()\ndata_tittest.describe()","061e8533":"data_tittest.columns","ab048a10":"data_tittest.corr()","2c1f14bc":"#correlation map\nf,ax = plt.subplots(figsize=(18, 18))\nsns.heatmap(data_tittest.corr(), annot=True, linewidths=.5, fmt= '.1f',ax=ax)\nplt.show()","491933f7":"merged = pd.concat([data_tittrain,data_tittest])","1e76051f":"merged.info()\nmerged.describe()","2d506716":"merged.corr()","fcdbae06":"#correlation map\nf,ax = plt.subplots(figsize=(18, 18))\nsns.heatmap(merged.corr(), annot=True, linewidths=.5, fmt= '.1f',ax=ax)\nplt.show()","d256aebe":"merged.head(259)","ed9f6491":"merged.columns","bb06f870":"merged.corr()","ba22f8d9":"fig=px.bar(merged,x='PassengerId',y='Fare',color='Sex',hover_data=['Name','Survived'])\nfig.show()\n#Inference:People who paid maximum fare were Cardeza group:Ms.Ward,Mr. and Mrs. Cardeza all 3 survived,Mr Gustave Leasurer survived too\n#After this fare group in the next highest paid fare,most women survived and most men in that group died..","0534726f":"fig=px.bar(merged,x='PassengerId',y='SibSp',color='Sex',hover_data=['Name','Survived'])\nfig.show()\n#Inference:The Biggest family on deck was sage family,All of them died because they refused to leave each other..I think the dataset is incomplete as in report there were 11 family members let's see if the are in the Parch group or not..","ca4bdcb0":"fig=px.bar(merged,x='PassengerId',y='Parch',color='Sex',hover_data=['Name','Survived'])\nfig.show()\n#Inference:Godwin Family was also hugely affected by this disaster..","788e5f4c":"fig=px.scatter(data_tittrain,x='SibSp',y='Parch',color='Sex',hover_data=['Name','Survived'])\nfig.show()\n#Inference:Shows who lost the lost most people was goodwin family,Anderson family,Panula family,Skooz family,Palsson family","c848e094":"fig=px.bar(data_tittrain,x='Pclass',color='Sex',hover_data=['Name','Survived'])\nfig.show()\n#Inference:There were a lot of poor men who died,the only men who had any chance of surviving this mess were 1st class men\n#exceptions:Women in class 1 and 2 who died were mrs earnest carter,mr hudson allison---I need to explore their stories\n#exceptions:Men in class 3 who survived mr.fridtjof madsen,oskar hadmen,bertram dean,ein lindqvist---need to explore their stories","74295ea9":"fig=px.bar(data_tittrain,x='Survived',color='Sex',hover_data=['Name','Survived'])\nfig.show()\n#Inference:Nearly Equal no of men and women survived,but way more men died as compared to women","12ec2677":"fig=px.bar(data_tittrain,x='Sex',color='Fare',hover_data=['Name','Survived'])\nfig.show()\n#Inference:Men paid around double in fare as compared to women in this ship..","1d726b0f":"fig=px.bar(data_tittrain,x='Sex',color='Fare',hover_data=['Name','Survived'])\nfig.show()","4849783f":"data_tittrain[\"Sex\"].value_counts()","1b204a89":"labels = 'male', 'female'\nsizes = [577, 314]\ncolors = ['gold', 'yellowgreen']\nexplode = (0.1, 0)  # explode 1st slice\n\n# Plot\nplt.pie(sizes, explode=explode, labels=labels, colors=colors,\nautopct='%1.1f%%', shadow=True, startangle=140)\n\nplt.axis('equal')\nplt.show()","92e557db":"data_tittest[\"Sex\"].value_counts()","78e1829c":"labels = 'male', 'female'\nsizes = [256, 152]\ncolors = ['gold', 'yellowgreen']\nexplode = (0.1, 0)  # explode 1st slice\n\n# Plot\nplt.pie(sizes, explode=explode, labels=labels, colors=colors,\nautopct='%1.1f%%', shadow=True, startangle=140)\n\nplt.axis('equal')\nplt.show()\n#Inference:There are more females in test data,which will impact survival rate...","ca84886b":"data_tittrain[\"Pclass\"].value_counts()","f77d99c6":"labels = 'Class1', 'Class2','Class3'\nsizes = [491, 216,184]\ncolors = ['gold', 'silver','brown']\nexplode = (0.1, 0.3,0.5)  # explode 1st slice\n\n# Plot\nplt.pie(sizes, explode=explode, labels=labels, colors=colors,\nautopct='%1.1f%%', shadow=True, startangle=140)\n\nplt.axis('equal')\nplt.show()\n#Inference:There are more richer people in train data,then test data...so there are two features that opposite to each other rich count and gender count in either of data","5fca2d94":"data_tittest['Pclass'].value_counts()","f75fe4d6":"labels = 'Class1', 'Class2','Class3'\nsizes = [218, 107,93]\ncolors = ['gold', 'silver','brown']\nexplode = (0.1, 0.3,0.5)  # explode 1st slice\n\n# Plot\nplt.pie(sizes, explode=explode, labels=labels, colors=colors,\nautopct='%1.1f%%', shadow=True, startangle=140)\n\nplt.axis('equal')\nplt.show()","ce6f07c2":"msno.bar(data_tittrain.sample(890),(28,10),color='red')\nplt.title('MISSING VALUES',fontsize=25)","cdf0480f":"corr = data_tittrain.corr()\nmask = np.zeros_like(corr)\nmask[np.triu_indices_from(mask)] = True\nwith sns.axes_style(\"white\"):\n    f, ax = plt.subplots(figsize=(9, 7))\n    ax = sns.heatmap(corr,mask=mask,square=True,annot=True,fmt='0.2f',linewidths=.8,cmap=\"Accent\",robust=True)","c3058dbe":"data_tittrain = data_tittrain.drop(columns=['Name','Cabin'])\ndata_tittrain['family_member'] = data_tittrain['SibSp'] + data_tittrain['Parch']\ndata_tittrain = data_tittrain.drop(columns=['SibSp', 'Parch'])","80700ced":"data_tittest = data_tittest.drop(columns=['Name','Cabin'])\ndata_tittest['family_member'] = data_tittest['SibSp'] + data_tittest['Parch']\ndata_tittest = data_tittest.drop(columns=['SibSp', 'Parch'])","99f5b54a":"data_tittrain.fillna(0,inplace=True)\ndata_tittest.fillna(0,inplace=True)","f603b9a6":"X = data_tittrain.drop(columns=['Survived'])\nY = data_tittrain['Survived']\n\n\n\n#choose the features we want to train, just forget the float data\ncate_features_index = np.where(X.dtypes != float)[0]","626f57d4":"from catboost import CatBoostClassifier, cv, Pool\nfrom sklearn.model_selection import train_test_split","44fb4c3c":"#make the x for train and test (also called validation data) \nxtrain,xtest,ytrain,ytest = train_test_split(X,Y,train_size=0.82,random_state=42)","a15492c4":"clf =CatBoostClassifier(eval_metric='Accuracy',use_best_model=True,random_seed=42)","6de066e1":"#now just to make the model to fit the data\nclf.fit(xtrain,ytrain,cat_features=cate_features_index,eval_set=(xtest,ytest), early_stopping_rounds=50)","6c168d29":"test_id = data_tittest.PassengerId\ndata_tittest.isnull().sum()","3085a66a":"prediction = clf.predict(data_tittest)","4847d65a":"len(test_id),len(prediction)","7b029c5c":"df_sub = pd.DataFrame()\ndf_sub['PassengerId'] = test_id\ndf_sub['Survived'] = prediction.astype(np.int)\n\ndf_sub.to_csv('gender_submission.csv', index=False)","07ba1be9":"![](https:\/\/i.imgur.com\/qm9r2Z0.jpg)","bdb70723":"Ans:418 rows* 11 columns removing the answer column of survived or not\n\nGeneral Inferences:\n* Again,Cabin and Age data are missing...Cabin is like joke here..91 only\n* These are the next 418 passengers other than 891 passengers so Total no of passengers is 1309\n* Class average is 2.26 meaning there were a lot of rich people here too..\n* Average age is 30 of 332 values we have ,min age is 0 and max age is 76,see the 25%,50%,75% distribution ,most  of the passengers were from 20-45 years\n* Average sibling 0.44,max sibling 8\n* Average parents count 0.39 ,max parents and family 9\n* Average fare paid is 35,minimum is 0 again,and maximum is 512 units","0a091390":"VariableNOtes\n\npclass: A proxy for socio-economic status (SES)\n1st = Upper\n2nd = Middle\n3rd = Lower\n\nage: Age is fractional if less than 1. If the age is estimated, is it in the form of xx.5\n\nsibsp: The dataset defines family relations in this way...\nSibling = brother, sister, stepbrother, stepsister\nSpouse = husband, wife (mistresses and fianc\u00e9s were ignored)\n\nparch: The dataset defines family relations in this way...\nParent = mother, father\nChild = daughter, son, stepdaughter, stepson\nSome children travelled only with a nanny, therefore parch=0 for them.","79299f99":"<div>\n<div class=\"alert alert-warning\" role=\"alert\">\n  Importing Packages and Data files(csv files)\n<\/div>","64444516":"<div>\n<div class=\"alert alert-danger\" role=\"ABout\">\n  About this Kernel\n<\/div>\n    \n---   \nProblem Description \n    \n>The sinking of the RMS Titanic is one of the most notorious shipwrecks in history. On April 15, 1912, during her maiden voyage, the Titanic sank after colliding with an iceberg, killing 1502 out of 2224 passengers and crews. This harrowing tragedy shocked the international community and led to better safety regulations for ships.\n\nObjective\n\n>In this problem, we're asked to complete the analysis of what sorts of passengers were likely to survive the tragedy using machine learning. So its our job to predict if a passenger survived from the sinking Titanic or not with the help of machine learning. So its a binary classification problem.","a12d2646":"Importing our datasets","22a0d47e":"Difference and similarity between test and training data?\n* 2.30 class,2.26...there are more poor people in training data..just a lil bit but they are there and will affect decision\n* MeanAge-> Train=29.699,Test=30.27....there are lil more no of older people in test data...don't forget there is a lot of missing data in age\n* Max aged in train data is 80 year old man and max aged in test data is 76 year old man(maybe woman)\n* Avg fare paid in train set is less than in test data,max and min are same..gotta look more deeply\n* Why they chose to divide the test and training data into 891\\\\418...there should be reason","e7f351e1":"<div class=\"progress\">\n  <div class=\"progress-bar\" role=\"progressbar\" style=\"width: 25%;\" aria-valuenow=\"25\" aria-valuemin=\"0\" aria-valuemax=\"100\">25%<\/div>\n<\/div>","e73f3f75":"Ans:891 rows * 21 columns with missing values in columns Age and Cabin,\n\nGeneral Inference in training data:\n* No of passengers in titanic:891\n* 38% people survived this tragedy\n* As the mean of class is 2.308..it means there are lot of poor people in training data #will affect the submission\n* Max aged person here is 80 year old man who even survived,lol..age will affect the submission\n* SIbsp means no of siblings\/spouses abord ship ,so basically people with families aboard who have numver greater than 0...will affect the submission\n* Parch of parents \/ children aboard the Titanic... will affect the situation\n* I don't think ticket no will have affect on submission\n* I think the  fair is directly proportional how rich they are...so will affect the situation\n* I think the place where they joined the ship may also have  affect...becuase different locality may have different levels health levels...Idk if that's right or wrong yet\n* I think which cabin they were in will also affect but i would need to recreate the whole seen here for that...I will do that if neccessary\n* Average fare is 32 dollars...minimum being 0 and max being 512 ...see how 25%,50%,75% change"}}