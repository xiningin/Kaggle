{"cell_type":{"2eaa6148":"code","5764e04b":"code","8f025454":"code","80c0e8c1":"code","f16d650b":"code","992731ad":"code","6799df24":"code","60b1a29e":"code","edc7d46c":"code","fe3266bd":"code","d5c4d6f8":"code","3b3daecc":"code","55c26db3":"code","1e92ec2b":"code","165a6410":"code","ed62e9ed":"code","bf819a29":"code","91b9dc8e":"code","c11c33b8":"code","5a9e4698":"code","f32cec75":"code","91cd7948":"code","76eb5dde":"code","7b703206":"code","4306d94d":"code","14c84ad7":"code","4c85dbf3":"code","57a8af4f":"code","65f39f0b":"code","360c5446":"code","3daf9d1b":"code","dd7ac56d":"markdown","d73368eb":"markdown","1c79d46a":"markdown","09a38399":"markdown","b00fe85a":"markdown","5852c2ce":"markdown","93eb9798":"markdown","994cb04a":"markdown","0a7f1b85":"markdown","be00ff77":"markdown","ce98e159":"markdown","d373b989":"markdown","0e3f5a39":"markdown","c959c74d":"markdown","5f95aff5":"markdown","29c6ca66":"markdown","a04d1519":"markdown","f92beb7d":"markdown","4ea02c18":"markdown","86f20855":"markdown","6943d86f":"markdown","c794a447":"markdown","6290bd41":"markdown","0953034a":"markdown","ec8023c5":"markdown","4a4a4833":"markdown","a810630a":"markdown","65bf7994":"markdown","e5a76d4a":"markdown","a39b5568":"markdown","7ed070c0":"markdown","19f7315c":"markdown","8bb5b16d":"markdown","ddc659ff":"markdown","f1f79920":"markdown","e475fb3c":"markdown","3c006495":"markdown","16379d4c":"markdown","a4f1b469":"markdown","a854cb16":"markdown"},"source":{"2eaa6148":"import pandas as pd \nimport numpy as np","5764e04b":"df=pd.read_csv(\"..\/input\/medicine-insurance-data\/insurance.csv\")\ndf=df.reset_index()","8f025454":"import seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff","80c0e8c1":"df.head()","f16d650b":"df.shape","992731ad":"df.isnull().sum()","6799df24":"df1=pd.DataFrame(df.groupby('sex')['index'].count().reset_index())\nfig = px.pie(df1, values='index', names='sex',color_discrete_sequence=px.colors.qualitative.Pastel2,\n             title='Sex Ratio')\nfig.show()","60b1a29e":"df2=pd.DataFrame(df.groupby('smoker')['index'].count().reset_index())\nfig = px.pie(df2, values='index', names='smoker',\n             color_discrete_sequence=px.colors.qualitative.Pastel1,\n             title='Percentage of Smokers and Non Smokers')\nfig.show()","edc7d46c":"df3=pd.DataFrame(df.groupby(['age','sex'])['age'].count())\ndf3.columns=['Number of people']\ndf3=df3.reset_index()\nfig=px.bar(df3, x=\"age\", y=\"Number of people\", color=\"sex\" ,\\\n           title=\"Number of Smokers and Non Smokers based on their ages\",color_discrete_map={\n        'male': 'deepskyblue',\n        'female': 'hotpink'})\nfig.update_layout(barmode='group')\nfig.update_layout(\nxaxis = dict(\n        tickmode = 'linear',\n        tick0 =0,\n        dtick =1),\nyaxis = dict(\n        tickmode = 'linear',\n        tick0 =0,\n        dtick =2)),\nfig.update_layout(\n    xaxis_title=\"Age\",\n    legend_title=\"Sex\",\n    font=dict(\n        size=10))\n","fe3266bd":"df4=df[df['smoker']=='yes'].reset_index()\ndf4=pd.DataFrame(df4.groupby(['region','sex'])['index'].count()).reset_index()\ndf4.columns=['region','sex','Number of smokers']\nfig=px.bar(df4, x=\"Number of smokers\", y=\"region\", color=\"sex\" ,color_discrete_map={\n        'male': 'lightgreen',\n        'female': 'grey'},title=\"Number of Smokers from different regions\")\nfig.update_layout(barmode='group')\nfig.update_layout(\nxaxis = dict(\n        dtick =1),yaxis = dict(\n        tickmode = 'linear',\n        tick0 =0,\n        dtick =1))\nfig.update_layout(\n    xaxis_title=\"Number of smokers\",\n    yaxis_title=\"Region\",\n    legend_title=\"Sex\",\n    font=dict(\n        size=10))","d5c4d6f8":"df5=pd.DataFrame(df.groupby(['sex','smoker'])['bmi'].mean())\ndf5=df5.reset_index()\nfig=px.bar(df5, x=\"smoker\", y=\"bmi\", color=\"sex\" ,color_discrete_map={\n        'male': 'orange',\n        'female': 'teal'},\\\n           title=\"Average BMI of a Male and a Female\")\nfig.update_layout(barmode='group')\nfig.update_layout(\nxaxis = dict(\n        dtick =1),yaxis = dict(\n        tickmode = 'linear',\n        tick0 =0,\n        dtick =50))\nfig.update_layout(\n    xaxis_title=\"Smoker\",\n    yaxis_title=\"BMI of the person\",\n    legend_title=\"Sex\",\n    font=dict(\n        size=10))","3b3daecc":"smoker=df[df['smoker']=='yes']\ndf6=pd.DataFrame(smoker.groupby(['age','sex'])['smoker'].count())\ndf6=df6.reset_index()\nfig=px.bar(df6, x=\"age\", y=\"smoker\", color=\"sex\" ,color_discrete_map={\n        'male': 'darkgrey',\n        'female': 'gold'},\n           title=\"Number of male and female smokers\")\nfig.update_layout(barmode='group')\nfig.update_layout(\nxaxis = dict(\n        dtick =1),yaxis = dict(\n        tickmode = 'linear',\n        tick0 =0,\n        dtick =1))\nfig.update_layout(\n    xaxis_title=\"Age of the person\",\n    yaxis_title=\"Number of smokers\",\n    legend_title=\"Sex\",\n    font=dict(\n        size=10))","55c26db3":"fig = px.scatter(df,x='age',y=\"charges\",color='smoker',color_discrete_map={\n        'yes': 'darkblue',\n        'no': 'orange'})\nfig.update_layout(\n    xaxis_title=\"Age of the person\",\n    yaxis_title=\"Medical Costs\",\n    legend_title=\"Smoker\/Non Smoker\",\n    font=dict(\n        size=10))","1e92ec2b":"df[['charges','age','smoker']].corr('spearman')","165a6410":"df7=pd.DataFrame(df.groupby(['children'])['index'].count()).reset_index()\ndf7.columns=['Number of children','Number of people having children']\nfig = px.pie(df7, values='Number of people having children', names='Number of children'\\\n             ,color_discrete_sequence=px.colors.sequential.RdBu,title='Percentage of people with Children')\nfig.show()","ed62e9ed":"sns.set(rc={'figure.figsize':(20,20)})\n\nax=sns.catplot(x=\"children\", y=\"age\", hue=\"smoker\",col='sex',\n            kind=\"violin\", split=True,\n            palette=['grey','white'], data=df)\nax.fig.suptitle('Number of Children people have based on different age groups',y=0.9)\nsns.set_xlabel=('Number of Children')\nsns.set_ylabel=('Age')\n","bf819a29":"sns.catplot(x=\"charges\", y=\"smoker\", hue='sex',col='region',row='children',\n                kind=\"box\", palette=['lightblue','pink'],\n                data=df)","91b9dc8e":"from sklearn import linear_model\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression","c11c33b8":"df['smoker'].replace(('yes', 'no'), (1, 0), inplace=True)","5a9e4698":"x=df['charges'].values.reshape(-1,1)\ny=df['smoker'].values.reshape(-1,1)","f32cec75":"x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.25,random_state=42)","91cd7948":"Lreg=LogisticRegression(solver='lbfgs')\nLreg.fit(x_train,y_train.ravel())","76eb5dde":"y_predict=Lreg.predict(x_test)\ny_predict","7b703206":"y_prob=Lreg.predict_proba(x_test)[:,1]\ny_prob=y_prob.reshape(-1,1)\ny_prob","4306d94d":"from sklearn.metrics import accuracy_score\nscore=accuracy_score(y_test,y_predict)\nscore","14c84ad7":"from sklearn.metrics import confusion_matrix\nconfusion_matrix(y_test,y_predict)","4c85dbf3":"tn,fp,fn,tp=confusion_matrix(y_test,y_predict).ravel()\nprint('tn:',tn)\nprint('fp:',fp)\nprint('fn:',fn)\nprint('tp:',tp)","57a8af4f":"from sklearn.metrics import classification_report\nprint(classification_report(y_test,y_predict))","65f39f0b":"from sklearn.metrics import roc_auc_score\nfrom sklearn.metrics import roc_curve,auc","360c5446":"log_ROC_AUC=roc_auc_score(y_test,y_predict)\nfpr,tpr,thresholds=roc_curve(y_test,y_prob)\nroc_auc=auc(fpr,tpr)","3daf9d1b":"plt.figure()\nplt.rcParams[\"figure.figsize\"] = (10,10)\nplt.plot(fpr,tpr,color='blue',label='ROC curve(area=%0.2f)' % roc_auc)\nplt.plot([0,1],[1,0],'r--')\nplt.xlim([0,1])\nplt.ylim([0,1.05])\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive Rate')\nplt.title('Reciever Operating Characteristics for the Logistic Regression model')\nplt.legend(loc='lower right')\nplt.show()","dd7ac56d":"**> IMPORTING LIBRARIES FOR DATA VISUALIZATION**","d73368eb":"# 4. Number of Smokers from different regions","1c79d46a":"**ACCURACY SCORE:**","09a38399":"# 6. Number of male and female smokers","b00fe85a":"**Probability of predicted dataset values matching with the actual dataset values:**","5852c2ce":"**We see that the prediction accuracy is pretty good with the ROC Curve Area=0.98.**","93eb9798":"# 5.  Average BMI of a Male and a Female","994cb04a":"**Inferences**:\n\n1. It can be seen that as the age of the person increases, his\/her expenditure on medical facilities also increases. Thus, it is people of higher age groups (40 or above), who might be good targets for an insurance facility. \n\n2. Also the medical costs incurred by a smoker a lot more than those by a non smoker. This shows that a smoker suffers from greater number of medical issues and thus, it would be a suitable for him to have an insurance so at to cover his health costs.","0a7f1b85":"# **Content of the Dataset**:\nThe dataset in this code consists of information from X insurance company about the medical costs incurred by its insurers. The dataset has the following columns:\n\n**Age**: Age of the primary beneficiary.\n\n**Sex**: Gender of the primary beneficiary (Female\/Male).\n\n**BMI**: Body Mass Index-providing an understanding of body, weights that are relatively high or low relative to height, objective index of body weight (kg \/ m ^ 2) using the ratio of height to weight, ideally 18.5 to 24.9\n\n**Children**: Number of children covered by health insurance \/ Number of dependents.\n\n**Smoker**: Smoking Habit (YES or NO).\n\n**Region**: The beneficiary's residential area in the US, northeast, southeast, southwest, northwest.\n\n**Charges**: Individual medical costs billed by health insurance company.\n\n**Who is a smoker?**-Anyone who has smoked tobacco products in the last one year is considered a smoker. Note that this is not just limited to cigarettes but all the other nicotine-based products, including cigars, and consumption of gutka and nicotine patch. Also, the frequency of smoking is not considered by insurers. You will be viewed as a smoker irrespective of whether you are a chain smoker or smoke socially.\n\nAs compared to a non-smoker, the life insurance premiums of someone who smokes can be 30%-40% higher.\n\nThe given code consists of three parts:\n1. **Basic Exploratory Data Analysis (EDA)** : With the help of different visualiszatuons, we have made some inferences about trends in variables or the relationship between two or more variables.\n\n2. **Logistic Regression Model:** A logistic regression model is prepared to predict if a person is smoker or not based on his medical costs.\n\n3. **ROC Analysis:** The logistic model is then tested  for the test data and confustion matrix and classification matrix are generated to check the performance of the model. Model accuracy is indicated by the ROC curve as well.","be00ff77":"![image.png](attachment:46b4a227-c65c-41ec-8cd7-3f2c96c04132.png)","ce98e159":"# > MEDICAL COSTS **(EDA + LOGISTIC REGRESSION + ROC ANALYSIS)**","d373b989":"***We can also confirm the Inference above by finding out the correlation coefficient between medical costs and age of the benefeciary.***","0e3f5a39":"**> LOADING THE DATASET**","c959c74d":"# EXPLORATORY DATA ANALYSIS (EDA)","5f95aff5":"**Inferences:**\n\n1. We can see that the Average BMI of a female smoker is less than that of a male smoker. A BMI index between 25-30 indicates a healthy body. However, a BMI greater than 30 indicates that the person is suffering from obesity. Since male smokers have a BMI greater than 30, they are at a greater risk of health problems in future and might require insurance facility.\n\n2. The Average BMI of a non smoker male and a non smoker female is almost equal.","29c6ca66":"**CONFUSION MATRIX**","a04d1519":"# 10. COMBINED CHART","f92beb7d":"# ROC ANALYSIS","4ea02c18":"**> There are no missing values in this dataset**","86f20855":"# 1. Sex Ratio ","6943d86f":"**Inferences:**\n\n1. It can be obeserved that the number of male smokers are either equal to or greater than female smokers for any region.\n\n2. Morover, the highest number of smokers belong to the southeast region, be it male or female.","c794a447":"**TRUE NEGATIVES, FALSE POSITIVES, FALSE NEGATIVES AND TRUE NEGATIVES**","6290bd41":"**Inferences**:\n\n1. It can be observed that the highest number of smokers belong to age group of 19 years and the average number of male smokers is equal to the average number of female smokers in that age group.\n\n2. Also, in the age group of 43 and people of older age groups (63 and 64), the number of female smokers is greater than the number of male smokers.This implies that females in these age groups might have a greater need of a health insurance.","0953034a":"**Predicted Values for Smoker (Yes=1,NO=0):**","ec8023c5":"# 2. Percentage of Smokers and Non Smokers","4a4a4833":"**CLASSIFICATION REPORT**","a810630a":"**Missing Values**","65bf7994":"# 9. Number of Children people have based on different age groups ","e5a76d4a":"**Inferences**:\n\n1. It can be observed that there are no people who have 5 children and who smoke.","a39b5568":"**Inferences:**\n\n1. We can see that among the people who smoke, the highest number of smokers are around the age of 18 and 19 (The Teenagers). One of the reasons for this could be peer pressure or bad influence from friends in high school or college.\n\n2. The next class of frequent smokers are the people of age 43. Such is suitable age for taking a health insurance.","7ed070c0":"**DATA OBSERVATION**","19f7315c":"***> The correlation is pretty significant.***","8bb5b16d":"# 7. Medical costs incurred by people of different age groups","ddc659ff":"# LOGISTIC REGRESSION MODEL","f1f79920":"**> IMPORTING MAIN LIBRARIES**","e475fb3c":"# 8. Percentage of people having Children","3c006495":"**ROC CURVE FOR THE TEST DATA SET**","16379d4c":"# 3. Number of Smokers and Non Smokers based on their ages","a4f1b469":"**NUMBER OF ROWS AND COLUMNS**","a854cb16":"**Inferences:**\n\n1. It can be observed that a majority of people have no children.\n\n2. A very few percentage of people have 4 or 5 children. There can be certain insurance plans that provides coverage to policyholder as well as their children. This data could be of use for making such plans."}}