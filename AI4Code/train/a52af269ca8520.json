{"cell_type":{"5f082456":"code","a18c7bfb":"code","8439c492":"code","ff81a8c0":"code","3a34ac55":"code","7767e6a1":"code","cc444fc8":"code","752fca91":"code","291b4d2d":"code","0481ef5c":"code","31f50b68":"code","889e4343":"code","a58818d5":"code","0060becb":"code","4a60864c":"code","7d519ae1":"code","4b7bc4e4":"code","ed5b5968":"code","415c1924":"code","9ced4896":"code","4b522c13":"code","994759b0":"code","f2ef505a":"code","64900ecc":"code","dfcc1601":"code","f5557452":"code","4b29c41e":"code","94269587":"code","ae4074fb":"code","34d02e3f":"code","d662f1c1":"markdown","69a0052c":"markdown","29c05130":"markdown","7500cd2c":"markdown","47fbd10f":"markdown","76d9b19c":"markdown"},"source":{"5f082456":"import os # os \uae30\ub2a5\uc744 \ud65c\uc6a9\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","a18c7bfb":"os.listdir(\"..\/input\/2021-immba-coding-workshop\")","8439c492":"train_raw = pd.read_csv(\"..\/input\/2021-immba-coding-workshop\/train.csv\")\ntest_raw = pd.read_csv(\"..\/input\/2021-immba-coding-workshop\/test.csv\")\nsample_submission = pd.read_csv(\"..\/input\/2021-immba-coding-workshop\/sample_submission.csv\")","ff81a8c0":"import matplotlib.pyplot as plt\nimport seaborn as sns","3a34ac55":"train_raw","7767e6a1":"train_raw.describe()","cc444fc8":"train = train_raw.drop(['id','date'], axis = 1)\ntest = test_raw.drop(['id','date'], axis = 1)","752fca91":"plt.figure(figsize=(14, 8))\nsns.heatmap(train.corr(), annot=True, cmap = 'summer')\nplt.show()","291b4d2d":"plt.figure(figsize=(14, 6))\nsns.regplot(x='sqft_living', y='price', data=train)\nplt.show()","0481ef5c":"plt.figure(figsize=(14, 6))\nsns.regplot(x='sqft_above', y='price', data=train)\nplt.show()","31f50b68":"plt.figure(figsize=(14, 6))\nsns.boxenplot(x='bedrooms', y='price', data=train)\nplt.show()","889e4343":"plt.figure(figsize=(14, 6))\nsns.boxenplot(x='grade', y='price', data=train)\nplt.show()","a58818d5":"def outlier(data):\n    q1,q3 = np.percentile(data, [25, 75])\n    iqr = q3-q1\n    lower = q1 - (iqr*1.5)\n    upper = q3 + (iqr*1.5)\n    \n    return np.where((data>upper)|(data<lower))\n\n","0060becb":"edit_grade = outlier(train['grade'])\nedit_bedrooms = outlier(train['bedrooms'])\nedit_sqft_living = outlier(train['sqft_living'])\nedit_sqft_above = outlier(train['sqft_above'])","4a60864c":"outlier_index = np.concatenate((edit_grade,edit_bedrooms,edit_sqft_living,edit_sqft_above), axis=None)\nprint(len(outlier_index))","7d519ae1":"not_outlier = []\nfor i in train.index:\n    if i not in outlier_index:\n        not_outlier.append(i)","4b7bc4e4":"train2 = train.loc[not_outlier]\ntrain2 = train2.reset_index(drop=True)\ntrain2","ed5b5968":"(15129-13384)\/15129","415c1924":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error","9ced4896":"x = train.drop('price', axis=1)\ny = train['price']","4b522c13":"x_train, x_val, y_train, y_val = train_test_split(x, y)","994759b0":"lr = LinearRegression()\nlr.fit(x_train, y_train)","f2ef505a":"lr.score(x_train, y_train)","64900ecc":"df_coeff = pd.DataFrame(x_train.columns)\ndf_coeff.columns = ['features']\ndf_coeff","dfcc1601":"df_coeff['coefficients'] = pd.Series(lr.coef_)\ndf_coeff","f5557452":"predict = lr.predict(x_val)","4b29c41e":"mse = mean_squared_error(y_val, predict)\nrmse = np.sqrt(mse)\n\nprint(\"rmse : {}\".format(rmse))","94269587":"pred_submission = lr.predict(test)\nsample_submission","ae4074fb":"sample_submission['price'] = pred_submission\nsubmission_yh = sample_submission\nsubmission_yh","34d02e3f":"submission_yh.to_csv(\"submit1_yh.csv\", index=False)","d662f1c1":"3. \uc2dc\uac01\ud654","69a0052c":"Outlier \uc81c\uac70\ub97c \ud1b5\ud574 \uc57d 11% \ub370\uc774\ud130\uac00 \uc0ad\uc81c\ub428","29c05130":"1. \ub370\uc774\ud130 \ub0b4\uc6a9 \ud655\uc778","7500cd2c":"4. Target(Price)\uc640 \uc0c1\uad00\uad00\uacc4\uac00 \ub192\uc544\ubcf4\uc774\ub294 feature\ub4e4\uc758 Outlier \uc81c\uac70  - sqft_living, sqft_above, grade, bedrooms","47fbd10f":"2. Object\ud615\ud0dc\uc758 \ub370\uc774\ud130 column \uc81c\uac70","76d9b19c":"0. Set up"}}