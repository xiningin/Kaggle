{"cell_type":{"704a4a8b":"code","a0bab2df":"code","525a7eb2":"code","7a690ef6":"code","a4268a81":"code","fd278f54":"code","5bcf8409":"code","e7be7f92":"code","d264a03c":"code","167341b8":"code","57bfca39":"code","c77689b5":"code","3dbecfe0":"markdown","c6874e4a":"markdown","80fd7ca7":"markdown","e48425c3":"markdown","48aba94c":"markdown","6d7a7e11":"markdown","d0a62526":"markdown","2b7fc073":"markdown","0b18f799":"markdown","e47f2b5f":"markdown","fcca0a18":"markdown","86596a95":"markdown","f4672a9e":"markdown","a2e37d8e":"markdown","1dc4476a":"markdown","f6c914fa":"markdown","177ac9b2":"markdown","170077be":"markdown","fba9fe02":"markdown","c95473fd":"markdown","75916303":"markdown","2dc7b119":"markdown"},"source":{"704a4a8b":"# Import libraries\nimport pandas as pd\nimport seaborn as sns \nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport pandasql as psql\nsql=psql.sqldf\nimport numpy as np\nsns.set_style(\"dark\")\n!pip install sidetable\nimport sidetable\n\n\n# Data Import\ndf = pd.read_csv('..\/input\/forest-fires-in-brazil\/amazon.csv', encoding='latin1')\ndf.head(5)","a0bab2df":"#Just renaming the number columns\ndf.rename(columns={'number':'number_fires'},inplace=True)\n\n#Getting the columns into a list\ncolunas=df.columns.to_list()\n\n#It was messing up my charts :D so I converted to string - but you should use pd.datetime for sure!\ndf['year']=df['year'].astype(str)\n\ndef missing_data(data):\n    total = data.isnull().sum()\n    percent = (data.isnull().sum()\/data.isnull().count()*100)\n    tt = pd.concat([total, percent], axis=1, keys=['Total', 'Percent'])\n    types = []\n    for col in data.columns:\n        dtype = str(data[col].dtype)\n        types.append(dtype)\n    tt['Types'] = types\n    return(np.transpose(tt))\n\nmissing=missing_data(df)\n\n\nprint(colunas)\nprint(missing)","525a7eb2":"#Mapping states by region \ndf['state'].unique()\n\nstate_region={'Acre':'North', 'Alagoas':'Northeast', 'Amapa':'North', 'Amazonas':'North', 'Bahia':'Northeast', 'Ceara':'Northeast',\n       'Distrito Federal':'Midwest', 'Espirito Santo':'Southeast', 'Goias':'Midwest', 'Maranhao':'Northeast',\n       'Mato Grosso':'Midwest', 'Minas Gerais':'Southeast', 'Par\u00e1':'North', 'Paraiba':'Northeast', 'Pernambuco':'Northeast',\n       'Piau':'Northeast', 'Rio':'Southeast', 'Rondonia':'North', 'Roraima':'North', 'Santa Catarina':'South',\n       'Sao Paulo':'Southeast', 'Sergipe':'Northeast', 'Tocantins':'North'}\ndf['region']=df['state'].map(state_region)\n\n#Ordering Months\nmonth_order={'Janeiro':'01', 'Fevereiro':'02', 'Mar\u00e7o':'03', 'Abril':'04', 'Maio':'05', 'Junho':'06', 'Julho':'07',\n       'Agosto':'08', 'Setembro':'09', 'Outubro':'10', 'Novembro':'11', 'Dezembro':'12'}\ndf['month_order']=df['month'].map(month_order)","7a690ef6":"#Using Sidetable to check how data is distributed.\n\ndf.stb.freq(['region'],style=True)","a4268a81":"#Now that we have this information lets see how many fires by region and state.\n\nfires_by_region=sql('''select region, round(sum(number_fires)) as number_fires, round(avg(number_fires)) as average_fires from df\n             group by region\n             order by number_fires desc''')   \n\n\n\nprint(fires_by_region)\n","fd278f54":"#Lets see the distribution by state & Region Now - And Take Only TOP 10\n\n#Using a little bit of SQL because Why Not?\nfires_by_regionandstate=sql('''select region,state,round(sum(number_fires)) as number_fires from df\n                          group by region,state\n                          order by number_fires desc\n                          limit 10''')\nprint(fires_by_regionandstate)","5bcf8409":"#Let's check the fires trend by region & year\n\n\n#Coming back to Pandas because Why Not?\n\nevolutionbyregion=df.groupby(['year','region']).sum().sort_values('year',ascending=True).unstack().fillna(0)         \n\nevolutionbyregion.plot(kind='bar',stacked=True,figsize=(25,9),colormap='Accent')\nplt.title('Evolution of Fires by Region', fontsize = 25)\nplt.xlabel('Year', fontsize = 20)\nplt.ylabel('Number of Fires', fontsize = 20)\nplt.xticks(fontsize = 15)\nplt.yticks(fontsize = 15)\nplt.legend(['Midwest','North','Northeast','South','Southeast'],bbox_to_anchor=(1, 0.5))\n","e7be7f92":"#Let's see how it is the trend per month\n\n\n#Sum of all the years\n\n\n\nforchartline=df.groupby(['year','region']).sum().sort_values('year',ascending=True).reset_index()\nc=sns.relplot(x=\"year\", y=\"number_fires\",\n                 col=\"region\",\n                 kind=\"line\", data=forchartline)\nc.set_xticklabels(rotation=90)\n\nforchartlinemonth=sql('''select region, month_order, sum(number_fires) as number_fires from df\n                      group by region,month_order\n                      order by month''')\n                      \n                                    \ng=sns.relplot(x='month_order',y='number_fires',col='region',kind='line',data=forchartlinemonth)\ng.set_xticklabels(rotation=90)","d264a03c":"#We need to identify which party was on power during the period we have available.\n\nparty_of_president={'1998':'PSDB', '1999':'PSDB', '2000':'PSDB', '2001':'PSDB', '2002':'PSDB', '2003':'PT', '2004':'PT', '2005':'PT',\n       '2006':'PT', '2007':'PT', '2008':'PT', '2009':'PT', '2010':'PT', '2011':'PT', '2012':'PT', '2013':'PT',\n       '2014':'PT', '2015':'PT', '2016':'PT', '2017':'PMDB'}\n\npresident={'1998':'FHC', '1999':'FHC', '2000':'FHC', '2001':'FHC', '2002':'Lula', '2003':'Lula', '2004':'Lula', '2005':'Lula',\n       '2006':'Lula', '2007':'Lula', '2008':'Lula', '2009':'Lula', '2010':'Lula', '2011':'Dilma', '2012':'Dilma', '2013':'Dilma',\n       '2014':'Dilma', '2015':'Dilma', '2016':'Dilma', '2017':'Temer'}\n\ndf['party']=df['year'].map(party_of_president)\ndf['president']=df['year'].map(president)\n\nprint(df.head(1))\n","167341b8":"party_year=df.groupby(['year','party','president']).mean().reset_index()\n\nchart = sns.catplot(x=\"year\", y=\"number_fires\",\n                hue=\"president\",kind='bar',\n                data=party_year,aspect=3)\nplt.title('Average Number of Fires by Year and President', fontsize = 25)\n","57bfca39":"#filtering our data to have only Mato Grosso\nmt=df[df['state']=='Mato Grosso']\n\npartidos={'1998':'PSDB', '1999':'PSDB', '2000':'PSDB', '2001':'PSDB', '2002':'PSDB', '2003':'Cidadania\/Maggi', '2004':'Cidadania\/Maggi', '2005':'Cidadania\/Maggi',\n       '2006':'Cidadania\/Maggi', '2007':'Cidadania\/Maggi', '2008':'Cidadania\/Maggi', '2009':'Cidadania\/Maggi', '2010':'PMDB', '2011':'PMDB', '2012':'PMDB', '2013':'PMDB',\n       '2014':'PMDB', '2015':'PSDB', '2016':'PSDB', '2017':'PSDB'}\n\nmt['party_state']=mt['year'].map(partidos)\n","c77689b5":"party_year_state=mt.groupby(['year','party_state']).mean().reset_index()\n\nchart2 = sns.catplot(x=\"year\", y=\"number_fires\",\n                hue=\"party_state\",kind='bar',\n                data=party_year_state,aspect=3)\nplt.title('Average Number of Fires by Year and Party in Mato Grosso', fontsize = 25)","3dbecfe0":"Looking quickly, it doesn't look like the distribution between the regions have changed from 1998-2017. **North and Northeast** are almost always on top in basically every year.\n\nFunny enough, during **2008 financial crisis** the number of fires were lower than some previous and future years...I guess there were not enough money to finance some fires..","c6874e4a":"# 1. Checking Data & Feature Eng","80fd7ca7":"Maybe you are not aware, but Brazil is completely divided into Left and Right Wing Parties. The discussions are fierce and every side tries to blame the other for every bad thing that happen to our country.\n\nIf you want to know more I advise you to search on google the terms Bolsonaro and Lula. Prepare some popcorn before you start it.\n\nI have my opinion (that's why is biased..duu) and I want to check if my assumptions are correct. Let's go!","e48425c3":"To be fair the analysis is not completely fair since PT (Left Wing) stayed in power from 2002 to 2016. However using the data that we have we conclude that the left wing didn't do their job and secured our beloved forest.\n","48aba94c":"# Quick & Simple dataviz using Tableau\nhttps:\/\/public.tableau.com\/views\/BrazilWildfires\/Dashboard1?:display_count=y&publish=yes&:origin=viz_share_link","6d7a7e11":"FYI - The only party that could be considered left on this list is the Cidadania which was called (PPS - Partido Popular Socialista) since they are currently opposed to Bolsonaro (extreme right) - However, as written above, during that time Cidadania Governor was Blairo Maggi which is a Billionare (agriculture lobby..)","d0a62526":"No missing data!","2b7fc073":"# 2. Analysis by Region","0b18f799":"**If you liked this notebook, please leave an upvote to support my work :)**","e47f2b5f":"Brazil is a very large country with a lot differences across regions. For ex. Northern region is the poorest (where I come from..) and Southeast is the economic hub of the country. That's why I want to differentiate them.","fcca0a18":"Year - Trend doesn't look so good for the us...\n\nMonth - The peak almost always happen mid-year - FYI in Brazil we different seasons by hemisphere\n\nFor ex - mid-year is Summer in North but Winter in South","86596a95":"<div class='tableauPlaceholder' id='viz1592068842149' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Br&#47;BrazilWildfires&#47;Dashboard1&#47;1_rss.png' style='border: none' \/><\/a><\/noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/> <param name='embed_code_version' value='3' \/> <param name='site_root' value='' \/><param name='name' value='BrazilWildfires&#47;Dashboard1' \/><param name='tabs' value='no' \/><param name='toolbar' value='yes' \/><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Br&#47;BrazilWildfires&#47;Dashboard1&#47;1.png' \/> <param name='animate_transition' value='yes' \/><param name='display_static_image' value='yes' \/><param name='display_spinner' value='yes' \/><param name='display_overlay' value='yes' \/><param name='display_count' value='yes' \/><param name='filter' value='publish=yes' \/><\/object><\/div>                <script type='text\/javascript'>                    var divElement = document.getElementById('viz1592068842149');                    var vizElement = divElement.getElementsByTagName('object')[0];                    if ( divElement.offsetWidth > 800 ) { vizElement.style.width='600px';vizElement.style.height='927px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='600px';vizElement.style.height='927px';} else { vizElement.style.width='100%';vizElement.style.height='977px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>","f4672a9e":"So..Yes. Northeast and North region have more fires.\n\nFor those who don't know Brazil regions - here a map - I come from the North - State of Par\u00e1 (Hi Mom!)\n","a2e37d8e":"Northeast and North Region contains more rows within our dataset. Does this reflects also in number of fires?","1dc4476a":"![brazil.png](attachment:brazil.png)","f6c914fa":":) Draw your own conclusions here :)","177ac9b2":"Let's do the same exercise and identify who was in power in the State placed in Rank 1 - Mato Grosso","170077be":"We can clearly see that even though **Midwest is in the 4th position in the fires ranking, one state from there has the highest amount of fires**.\n\nMato Grosso has a very dry weather but to be honest what has caused this is the influence of the **agricultural lobby that exists in Brazil**. **The Maggi Family** (Maggi Products) is very powerful there and one of them was even the governor for a while..","fba9fe02":"\u00a0\u00a0\u00a0![Vamos%20Fugir%20para%20a%20Floresta%20Capa%20para%20Facebook.png](attachment:Vamos%20Fugir%20para%20a%20Floresta%20Capa%20para%20Facebook.png)","c95473fd":"# Sources\nhttps:\/\/pt.wikipedia.org\/wiki\/Cidadania_(partido_pol%C3%ADtico)\n\nhttps:\/\/veja.abril.com.br\/politica\/pps-tira-socialista-do-nome-e-passa-a-se-chamar-cidadania\/\n\nhttps:\/\/pt.wikipedia.org\/wiki\/Lista_de_presidentes_do_Brasil","75916303":"# 3. Analysis by Goverment - Left or Right","2dc7b119":"**Context**\n\nForest fires are a serious problem for the preservation of the Tropical Forests. Understanding the frequency of forest fires in a time series can help to take action to prevent them. Brazil has the largest rainforest on the planet that is the Amazon rainforest. I'm personally affected by this because I'm Brazilian and I come from one of most touched areas by this fire (North)\n\n**Content**\n\nThis dataset report of the number of forest fires in Brazil divided by states. The series comprises the period of approximately 10 years (1998 to 2017). The data were obtained from the official website of the Brazilian government.\n\nhttp:\/\/dados.gov.br\/dataset\/sistema-nacional-de-informacoes-florestais-snif"}}