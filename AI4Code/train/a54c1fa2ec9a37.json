{"cell_type":{"72e2b6ed":"code","429db5ad":"code","db945672":"code","a2b8459f":"code","a1940e33":"code","66874f67":"code","a29afcbc":"code","feb0c90a":"code","6aee77ff":"code","66a56e83":"code","b8c33531":"code","ad5f4cb9":"code","be335d13":"code","2fc8c215":"code","6efea7fd":"code","781826c0":"code","d4c0bd2d":"code","da96c608":"code","29a4fd02":"code","fa39d18c":"code","83791f52":"code","3a2965b7":"code","f0e40292":"code","3082a5f7":"code","d061a921":"code","513b844c":"code","2e076d71":"code","785e0b77":"code","ddff1372":"code","626b9f6d":"code","fdc25b86":"code","9e4ca3f8":"code","55f738c3":"code","ea0a6951":"code","b863ceb3":"code","f02a4ddc":"code","8ef13db7":"code","25c450c6":"code","76ff641f":"code","4c674243":"code","f949f634":"code","f93f51d3":"code","7519e9f4":"code","d8a467e1":"code","b121fe82":"code","037127b2":"code","92a70646":"code","1f4dec61":"code","1242f782":"code","93f22c4f":"code","0a60fc39":"code","d7262538":"code","25146969":"code","91a500a8":"code","ec7a77ea":"code","3ac09bb6":"code","2f92ef53":"code","c35d6926":"code","099fe8fa":"code","19d32f1d":"code","03115a8a":"code","d6d204d8":"code","b1d7a6e5":"code","78ce6827":"code","5f41d0dc":"code","b19922d7":"code","85a188cc":"code","768b3076":"code","13237236":"code","d8f20801":"code","fdac39d4":"code","87cd6f65":"code","c4e8c548":"code","3f6dde53":"code","815b0406":"code","2aaa27da":"code","2be0adbd":"code","af2099cd":"code","2461a01b":"code","354dd2da":"code","f22b9fc3":"code","127e420e":"code","7ba28bdc":"code","a3a59651":"code","169a9c79":"code","bb761cae":"code","36bb62da":"code","352bfbe4":"code","6adcb75f":"code","0d1d247e":"code","8c098d0c":"code","4d565992":"code","90353312":"code","a067f2e9":"code","d3778291":"markdown","f255048b":"markdown","54a5f742":"markdown","1d5d7091":"markdown","c2208f16":"markdown","a258b0d2":"markdown","50246f35":"markdown","72f6ecee":"markdown","76c393c7":"markdown","375e2cae":"markdown","81681650":"markdown","a28b4dc4":"markdown","6c51814d":"markdown","fd66e35f":"markdown","cb836e4a":"markdown","e5d0f199":"markdown","5b1133ad":"markdown","9a36c5b1":"markdown","d2c4f587":"markdown","c6a4c5c0":"markdown","36190816":"markdown","555550e5":"markdown","4d03093f":"markdown","a1fd7d2f":"markdown","c86a259b":"markdown","259d2268":"markdown","20791465":"markdown","4dbb2f5d":"markdown","ea8cb7f3":"markdown","99ed0ad7":"markdown","355f1228":"markdown","673c2e0c":"markdown","6772684d":"markdown","95476db8":"markdown","9dfbc21e":"markdown","ee2468f7":"markdown","fa8f11cf":"markdown","9ef0de95":"markdown"},"source":{"72e2b6ed":"query = \"\"\"\nSELECT \n    COUNT(transactions.hash)\nFROM\n    `bigquery-public-data.crypto_ethereum.transactions` AS transactions\nWHERE block_timestamp < '2021-09-01 00:00:00'\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=90)","429db5ad":"print(\"Total number of transactions in the Ethereum network:\", df.iloc[0][\"f0_\"])","db945672":"query = \"\"\"\nSELECT \n    COUNT(*) \/ COUNT(DISTINCT(DATE(block_timestamp)))\nFROM\n    `bigquery-public-data.crypto_ethereum.transactions` AS transactions\nWHERE block_timestamp < '2021-09-01 00:00:00'\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=10)","a2b8459f":"print(\"Average number of transactions per day:\", df.iloc[0][\"f0_\"])","a1940e33":"query = \"\"\"\nSELECT \n    DATE(block_timestamp) as date, COUNT(*) as number_of_transactions\nFROM\n    `bigquery-public-data.crypto_ethereum.transactions` AS transactions\nWHERE\n    block_timestamp < '2021-09-01 00:00:00'\nGROUP BY date\nORDER BY date\n\"\"\"","66874f67":"from bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=10)","a29afcbc":"df.head()\ndf","feb0c90a":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.title(\"Number of transactions over time\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Number of transactions\", labelpad=20)\nsns.lineplot(x=\"date\", y=\"number_of_transactions\", data=df, color=\"purple\")\nplt.gcf().set_dpi(400)\nplt.show(fig)","6aee77ff":"df[df[\"number_of_transactions\"] == df[\"number_of_transactions\"].max()]","66a56e83":"df[\"number_of_transactions\"].sum()","b8c33531":"query = \"\"\"\nSELECT \n    DATE(block_timestamp) AS date, (SUM(value) \/ power(10,18)) AS total_value \nFROM\n    `bigquery-public-data.crypto_ethereum.transactions` AS transactions\nWHERE\n    block_timestamp < '2021-09-01 00:00:00'\nGROUP BY date\nORDER BY date\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=30)","ad5f4cb9":"df.head()","be335d13":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.title(\"Value of Ether transferred per day\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Ether transferred \", labelpad=20)\nsns.lineplot(x=\"date\", y=\"total_value\", data=df, color=\"purple\")\nplt.gcf().set_dpi(400)\nplt.show(fig)","2fc8c215":"df[df[\"total_value\"] == df[\"total_value\"].max()]","6efea7fd":"df[\"total_value\"].sum()","781826c0":"df[\"total_value\"].mean()","d4c0bd2d":"query = \"\"\"\nSELECT \n    DATE(timestamp) as date, SUM(gas_used) as gas_used\nFROM \n    `bigquery-public-data.crypto_ethereum.blocks`\nWHERE\n    timestamp < '2021-09-01 00:00:00'\nGROUP BY date\nORDER BY date\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=1)","da96c608":"df_cleaned = df[1:]\ndf_cleaned.head()","29a4fd02":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.title(\"Daily gas consumption\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Gas consumed\", labelpad=20)\nsns.lineplot(x=\"date\", y=\"gas_used\", data=df_cleaned, color=\"purple\")\nplt.gcf().set_dpi(400)\nplt.show(fig)","fa39d18c":"df[df[\"gas_used\"] == df[\"gas_used\"].max()]","83791f52":"df[\"gas_used\"].sum()","3a2965b7":"df[\"gas_used\"].mean()","f0e40292":"query = \"\"\"\nSELECT\n    DATE(block_timestamp) as date, avg(gas_price) as average_gas_price\nFROM \n    `bigquery-public-data.crypto_ethereum.transactions` \nWHERE \n    receipt_status = 1 AND block_timestamp < '2021-09-01 00:00:00'\nGROUP BY date\nORDER BY date\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\n# This establishes an authenticated session and prepares a reference to the dataset that lives in BigQuery.\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=29)","3082a5f7":"df.head()","d061a921":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.title(\"Average gas price per day\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Average gas price (in Wei)\", labelpad=20)\nsns.lineplot(x=\"date\", y=\"average_gas_price\", data=df, color=\"purple\")\nplt.gcf().set_dpi(400)\nplt.show(fig)","513b844c":"df[df[\"average_gas_price\"] == df[\"average_gas_price\"].max()]","2e076d71":"df[\"average_gas_price\"].sum()","785e0b77":"df[\"average_gas_price\"].mean()","ddff1372":"query = \"\"\"\n    SELECT first_transaction AS date, COUNT(*) AS no_of_addresses_making_first_txn\n    FROM (\n        SELECT from_address AS address, MIN(DATE(block_timestamp)) AS first_transaction\n        FROM `bigquery-public-data.crypto_ethereum.transactions`\n        WHERE value > 0 AND block_timestamp < '2021-09-01 00:00:00'\n        GROUP BY address\n        ORDER BY first_transaction\n    )\n    GROUP BY first_transaction\n    ORDER BY date\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=81)","626b9f6d":"df","fdc25b86":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.title(\"Active address growth per day\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Number of addresses making first transaction\", labelpad=20)\nsns.lineplot(x=\"date\", y=\"no_of_addresses_making_first_txn\", data=df, color=\"purple\")\nplt.gcf().set_dpi(400)\nplt.show(fig)","9e4ca3f8":"df[\"cumsum_addresses\"] = df[\"no_of_addresses_making_first_txn\"].cumsum()\ndf","55f738c3":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.title(\"Active address growth per day\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Cumulative number of addresses making first transaction\", labelpad=20)\nsns.lineplot(x=\"date\", y=\"cumsum_addresses\", data=df, color=\"purple\")\nplt.gcf().set_dpi(400)\nplt.show(fig)","ea0a6951":"query = \"\"\"\n    SELECT first_transaction AS date, COUNT(*) AS no_of_addresses_making_first_txn\n    FROM (\n        SELECT from_address AS address, MIN(DATE(block_timestamp)) AS first_transaction\n        FROM `bigquery-public-data.crypto_ethereum.transactions`\n        WHERE block_timestamp < '2021-09-01 00:00:00'\n        GROUP BY address\n        ORDER BY first_transaction\n    )\n    GROUP BY first_transaction\n    ORDER BY date\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=81)","b863ceb3":"df[\"cumsum_addresses\"] = df[\"no_of_addresses_making_first_txn\"].cumsum()\ndf","f02a4ddc":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.title(\"Active address growth per day\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Cumulative number of addresses making first transaction\", labelpad=20)\nsns.lineplot(x=\"date\", y=\"cumsum_addresses\", data=df, color=\"purple\")\nplt.gcf().set_dpi(400)\nplt.show(fig)","8ef13db7":"query = \"\"\"\nSELECT\n    COUNT(DISTINCT(address)) as number_of_contracts\nFROM\n    `bigquery-public-data.crypto_ethereum.contracts` \nWHERE \n    block_timestamp < '2021-09-01 00:00:00'\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=4.5)","25c450c6":"print(\"Total number of contracts:\", df.iloc[0][\"number_of_contracts\"])","76ff641f":"query = \"\"\"\nSELECT COUNT(DISTINCT(address)) as number_of_contracts, DATE(block_timestamp) as date\nFROM `bigquery-public-data.crypto_ethereum.contracts`\nWHERE \n    block_timestamp < '2021-09-01 00:00:00'\nGROUP BY date\nORDER BY date\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=4.5)","4c674243":"df.head()","f949f634":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.title(\"Number of Smart Contracts created per day\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Number of Smart Contracts\", labelpad=20)\nsns.lineplot(x=\"date\", y=\"number_of_contracts\", data=df, color=\"purple\")\nplt.gcf().set_dpi(400)\nplt.show(fig)","f93f51d3":"df[\"cumsum_number_of_contracts\"] = df[\"number_of_contracts\"].cumsum()\ndf.head()","7519e9f4":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.title(\"Cumulative number of Smart Contracts created per day\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Cumulative number of Smart Contracts\", labelpad=20)\nsns.lineplot(x=\"date\", y=\"cumsum_number_of_contracts\", data=df, color=\"purple\")\nplt.gcf().set_dpi(400)\nplt.show(fig)","d8a467e1":"query = \"\"\"\nSELECT COUNT(*) as contracts_created, DATE(block_timestamp) as date\nFROM `bigquery-public-data.crypto_ethereum.transactions` \nWHERE to_address IS null AND block_timestamp < '2021-09-01 00:00:00'\nGROUP BY date\nORDER BY date\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=62)","b121fe82":"df","037127b2":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.title(\"Number of Smart Contracts created per day (Directly by users)\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Number of Smart Contracts\", labelpad=20)\nsns.lineplot(x=\"date\", y=\"contracts_created\", data=df, color=\"purple\")\nplt.gcf().set_dpi(400)\nplt.show(fig)","92a70646":"df[\"cumsum_contracts_created\"] = df[\"contracts_created\"].cumsum()\ndf","1f4dec61":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.title(\"Cumulative number of Smart Contracts created per day (Directly by users)\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Cumulative number of Smart Contracts\", labelpad=20)\nsns.lineplot(x=\"date\", y=\"cumsum_contracts_created\", data=df, color=\"purple\")\nplt.gcf().set_dpi(400)\nplt.show(fig)","1242f782":"query = \"\"\"\nWITH a AS (\n    SELECT DATE(block_timestamp) AS date, SUM(value)\/POWER(10,18) AS contract_calls\n    FROM `bigquery-public-data.crypto_ethereum.transactions`\n    WHERE input != '0x' AND to_address IS NOT null AND block_timestamp < '2021-09-01 00:00:00'\n    GROUP BY date\n), \nb AS (\n    SELECT DATE(block_timestamp) AS date2, SUM(value)\/POWER(10,18) AS contract_creation\n    FROM `bigquery-public-data.crypto_ethereum.transactions`\n    WHERE to_address IS null AND block_timestamp < '2021-09-01 00:00:00'\n    GROUP BY date2\n), \nc AS (\n    SELECT DATE(block_timestamp) AS date3, SUM(value)\/POWER(10,18) AS ether_transfers\n    FROM `bigquery-public-data.crypto_ethereum.transactions`\n    WHERE input = '0x' AND value IS NOT null AND block_timestamp < '2021-09-01 00:00:00'\n    GROUP BY date3\n)\nSELECT contract_calls, ether_transfers, contract_creation, date\nFROM a JOIN c ON date=date3 JOIN b ON date=date2\nORDER BY date\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=331)","93f22c4f":"df","0a60fc39":"total_contract_calls = int(df[\"contract_calls\"].sum())\ntotal_ether_transfers = int(df[\"ether_transfers\"].sum())\ntotal_contract_creations = int(df[\"contract_creation\"].sum())","d7262538":"import matplotlib.pyplot as plt\nfrom matplotlib.gridspec import GridSpec\nimport numpy as np\n\nlabels = (str(total_contract_calls)+'\\ncontract_calls', str(total_ether_transfers)+'\\nether_transfers', str(total_contract_creations)+'\\ncontract_creations')\nsizes = [total_contract_calls, total_ether_transfers, total_contract_creations]\ncolors = [\"mediumspringgreen\", \"turquoise\", \"crimson\"]\nexplode = (0, 0.3, 0.2)  # explode 1st slice\n\nthe_grid = GridSpec(2, 2)\nplt.figure(1, figsize=(6, 3)) \nplt.subplot(the_grid[0, 1], aspect=2, title='Types of transactions in Ethereum')\nplt.rcParams.update({'font.size': 3})\nplt.pie(sizes, labels=labels, explode=explode, autopct='%0.1f%%', colors=colors)\nplt.gcf().set_dpi(300)\nplt.axis('equal')\nplt.show()","25146969":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\n# axs.set(yscale=\"log\")\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.rcParams.update({'font.size': 14})\nplt.title(\"Daily ether volume for ether transfers, contract calls, and contract creations\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Daily ether volume\", labelpad=20)\nsns.lineplot(x=\"date\", y=\"ether_transfers\", data=df, color=\"slategray\", label='ether_transfers')\nsns.lineplot(x=\"date\", y=\"contract_calls\", data=df, color=\"lawngreen\", label='contract_calls')\nsns.lineplot(x=\"date\", y=\"contract_creation\", data=df, color=\"purple\", label='contract_creations')\nplt.gcf().set_dpi(400)\nplt.show(fig)","91a500a8":"# Daily volume of ether transferred\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\naxs.set(yscale=\"log\")\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.rcParams.update({'font.size': 14})\nplt.title(\"Daily volume of ether transferred (measured in logarithmic scale)\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Ether volume\", labelpad=20)\nsns.lineplot(x=\"date\", y=\"ether_transfers\", data=df, color=\"crimson\", label='ether_transfers')\nsns.lineplot(x=\"date\", y=\"contract_calls\", data=df, color=\"navy\", label='contract_calls')\nplt.gcf().set_dpi(400)\nplt.show(fig)","ec7a77ea":"# KAGGLE NOT ABLE TO PROCESS: LARGE QUERY\n\n# query = \"\"\"\n# WITH value_table AS (\n#     SELECT to_address AS address, value AS value\n#     FROM `bigquery-public-data.crypto_ethereum.traces`\n#     WHERE to_address IS NOT null\n#         AND block_timestamp < '2021-09-01 00:00:00'\n#         AND status=1 \n#         AND (call_type NOT IN ('delegatecall', 'callcode', 'staticcall') OR call_type IS null)\n#     UNION ALL\n#         SELECT from_address AS address, -value AS value\n#         FROM `bigquery-public-data.crypto_ethereum.traces`\n#         WHERE from_address IS NOT null\n#             AND block_timestamp < '2021-09-01 00:00:00'\n#             AND status=1 \n#             AND (call_type NOT IN ('delegatecall', 'callcode', 'staticcall') OR call_type IS null)\n#     UNION ALL\n#         SELECT miner AS address, SUM(CAST(receipt_gas_used AS numeric) * CAST(gas_price AS numeric)) AS value\n#         FROM `bigquery-public-data.crypto_ethereum.transactions` AS transactions\n#         JOIN `bigquery-public-data.crypto_ethereum.blocks` AS blocks\n#         ON blocks.number = transactions.block_number\n#         WHERE block_timestamp < '2021-09-01 00:00:00'\n#         GROUP BY blocks.miner \n#     UNION ALL\n#         SELECT from_address AS address, -(CAST(receipt_gas_used AS numeric) * CAST(gas_price AS numeric)) AS value\n#         FROM `bigquery-public-data.crypto_ethereum.transactions`\n#         WHERE block_timestamp < '2021-09-01 00:00:00'\n# ), \n# a AS (\n#     SELECT SUM(value)\/POWER(10,18) AS balance, address \n#     FROM value_table\n#     GROUP BY address\n# ) \n# SELECT balance, row_number() over (\n#     ORDER BY balance DESC\n# ) AS number_of_addresses FROM a\n# ORDER BY balance DESC\n# \"\"\"\n\n# from bq_helper import BigQueryHelper\n\n# bq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\n# df = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=550)","3ac09bb6":"# df","2f92ef53":"# import matplotlib.pyplot as plt\n# import matplotlib as mpl\n# import seaborn as sns\n\n# fig, axs = plt.subplots(figsize=(20, 6))\n# axs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\n# plt.title(\"Ether balance distribution\", y=1.05)\n# plt.xlabel(\"Addresses\", labelpad=20)\n# plt.ylabel(\"Ether balance\", labelpad=20)\n# sns.lineplot(x=\"number_of_addresses\", y=\"balance\", data=df, color=\"purple\")\n# plt.gcf().set_dpi(400)\n# plt.show(fig)","c35d6926":"# SOME PROBLEM\n\n# query = \"\"\"\n# WITH value_table AS (\n#     SELECT to_address AS address, COUNT(DISTINCT(transactions.hash)) AS tx\n#     FROM `bigquery-public-data.crypto_ethereum.transactions` AS transactions\n#     WHERE to_address IS NOT null\n#         AND block_timestamp < '2021-09-01 00:00:00'\n#     GROUP BY address\n#     UNION ALL\n#         SELECT from_address AS address, COUNT(DISTINCT(transactions.hash)) as tx\n#         FROM `bigquery-public-data.crypto_ethereum.transactions` AS transactions\n#         WHERE from_address IS NOT null\n#             AND block_timestamp < '2021-09-01 00:00:00'\n#         GROUP BY address\n# ),\n# a AS (\n#     SELECT SUM(tx) AS transactions, address\n#     FROM value_table\n#     GROUP BY address\n# ),\n# b AS (\n#     SELECT transactions, row_number() over(\n#         ORDER BY transactions DESC\n#     ) AS address_rank FROM a\n# ),\n# c AS (\n#     SELECT transactions, floor(log(address_rank)*100) AS log_address_rank, address_rank\n#     FROM b\n# )\n# SELECT avg(transactions) AS transactions_avg, log_address_rank, COUNT(address_rank) AS number_of_addresses\n# FROM c\n# GROUP BY log_address_rank\n# ORDER BY transactions_avg DESC\n# \"\"\"\n\n# from bq_helper import BigQueryHelper\n\n# bq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\n# df = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=1)","099fe8fa":"# df","19d32f1d":"# import matplotlib.pyplot as plt\n# import matplotlib as mpl\n# import seaborn as sns\n\n# fig, axs = plt.subplots(figsize=(20, 6))\n# axs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\n# axs.xaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\n# plt.title(\"Ether transactions distribution\", y=1.05)\n# plt.xlabel(\"Number of Sender Addresses\", labelpad=20)\n# plt.ylabel(\"Ether transactions\", labelpad=20)\n# sns.lineplot(x=\"number_of_addresses\", y=\"transactions_avg\", data=df, color=\"purple\")\n# plt.axis([0, 40, 0, 8000000]) # Zoom in\n# plt.gcf().set_dpi(400)\n# plt.show(fig)","03115a8a":"query = \"\"\"\nWITH value_table AS (\n    SELECT to_address AS address, value AS value\n    FROM `bigquery-public-data.crypto_ethereum.traces`\n    WHERE to_address IS NOT null\n    AND block_timestamp < '2021-09-01 00:00:00'\n    AND status=1\n    AND (call_type NOT IN ('delegatecall', 'callcode', 'staticcall') OR call_type IS null)\n    \n    UNION ALL\n    \n    SELECT from_address AS address, -value AS value\n    FROM `bigquery-public-data.crypto_ethereum.traces`\n    WHERE from_address IS NOT null\n    AND block_timestamp < '2021-09-01 00:00:00'\n    AND status=1\n    AND (call_type NOT IN ('delegatecall', 'callcode', 'staticcall') OR call_type IS null)\n    \n    UNION ALL\n    \n    SELECT miner as address, SUM(CAST(receipt_gas_used AS NUMERIC) * CAST(gas_price AS NUMERIC)) AS value\n    FROM `bigquery-public-data.crypto_ethereum.transactions` AS transactions\n    JOIN `bigquery-public-data.crypto_ethereum.blocks` AS blocks\n    ON blocks.number = transactions.block_number\n    WHERE block_timestamp < '2021-09-01 00:00:00'\n    GROUP BY blocks.miner\n    \n    UNION ALL\n    \n    SELECT from_address as address, -(CAST(receipt_gas_used AS NUMERIC) * CAST(gas_price AS NUMERIC)) AS value\n    FROM  `bigquery-public-data.crypto_ethereum.transactions`\n    WHERE block_timestamp < '2021-09-01 00:00:00'\n)\nSELECT address, FLOOR(SUM(value) \/ power(10,18)) AS balance\nFROM value_table\nGROUP BY address\nORDER BY balance DESC\nLIMIT 10\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\n# This establishes an authenticated session and prepares a reference to the dataset that lives in BigQuery.\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=21)","d6d204d8":"df","b1d7a6e5":"query = \"\"\"\nWITH value_table AS (\n    SELECT to_address AS address, value AS value\n    FROM `bigquery-public-data.crypto_ethereum.traces`\n    WHERE to_address IS NOT null\n    AND block_timestamp < '2021-09-01 00:00:00'\n    AND status=1\n    AND (call_type NOT IN ('delegatecall', 'callcode', 'staticcall') OR call_type IS null)\n    \n    UNION ALL\n    \n    SELECT from_address AS address, -value AS value\n    FROM `bigquery-public-data.crypto_ethereum.traces`\n    WHERE from_address IS NOT null\n    AND block_timestamp < '2021-09-01 00:00:00'\n    AND status=1\n    AND (call_type NOT IN ('delegatecall', 'callcode', 'staticcall') OR call_type IS null)\n    \n    UNION ALL\n    \n    SELECT miner as address, SUM(CAST(receipt_gas_used AS NUMERIC) * CAST(gas_price AS NUMERIC)) AS value\n    FROM `bigquery-public-data.crypto_ethereum.transactions` AS transactions\n    JOIN `bigquery-public-data.crypto_ethereum.blocks` AS blocks\n    ON blocks.number = transactions.block_number\n    WHERE block_timestamp < '2021-09-01 00:00:00'\n    GROUP BY blocks.miner\n    \n    UNION ALL\n    \n    SELECT from_address as address, -(CAST(receipt_gas_used AS NUMERIC) * CAST(gas_price AS NUMERIC)) AS value\n    FROM  `bigquery-public-data.crypto_ethereum.transactions`\n    WHERE block_timestamp < '2021-09-01 00:00:00'\n),\na AS (\n    SELECT SUM(value)\/POWER(10,18) AS balance, address\n    FROM value_table\n    GROUP BY address\n    ORDER BY balance DESC\n),\nb AS (\n    SELECT to_address, COUNT(transactions.hash) AS tx_recipient\n    FROM  `bigquery-public-data.crypto_ethereum.transactions` AS transactions\n    WHERE block_timestamp < '2021-09-01 00:00:00'\n    GROUP BY to_address\n), \nc AS (\n    SELECT from_address, COUNT(transactions.hash) AS tx_sender\n    FROM  `bigquery-public-data.crypto_ethereum.transactions` AS transactions\n    WHERE block_timestamp < '2021-09-01 00:00:00'\n    GROUP BY from_address\n)\nSELECT from_address, tx_sender, balance\nFROM c LEFT JOIN a ON (a.address = c.from_address)\nORDER BY tx_sender DESC\nLIMIT 10\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\n# This establishes an authenticated session and prepares a reference to the dataset that lives in BigQuery.\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=63)","78ce6827":"df","5f41d0dc":"query = \"\"\"\nWITH value_table AS (\n    SELECT to_address AS address, value AS value\n    FROM `bigquery-public-data.crypto_ethereum.traces`\n    WHERE to_address IS NOT null\n    AND block_timestamp < '2021-09-01 00:00:00'\n    AND status=1\n    AND (call_type NOT IN ('delegatecall', 'callcode', 'staticcall') OR call_type IS null)\n    \n    UNION ALL\n    \n    SELECT from_address AS address, -value AS value\n    FROM `bigquery-public-data.crypto_ethereum.traces`\n    WHERE from_address IS NOT null\n    AND block_timestamp < '2021-09-01 00:00:00'\n    AND status=1\n    AND (call_type NOT IN ('delegatecall', 'callcode', 'staticcall') OR call_type IS null)\n    \n    UNION ALL\n    \n    SELECT miner as address, SUM(CAST(receipt_gas_used AS NUMERIC) * CAST(gas_price AS NUMERIC)) AS value\n    FROM `bigquery-public-data.crypto_ethereum.transactions` AS transactions\n    JOIN `bigquery-public-data.crypto_ethereum.blocks` AS blocks\n    ON blocks.number = transactions.block_number\n    WHERE block_timestamp < '2021-09-01 00:00:00'\n    GROUP BY blocks.miner\n    \n    UNION ALL\n    \n    SELECT from_address as address, -(CAST(receipt_gas_used AS NUMERIC) * CAST(gas_price AS NUMERIC)) AS value\n    FROM  `bigquery-public-data.crypto_ethereum.transactions`\n    WHERE block_timestamp < '2021-09-01 00:00:00'\n),\na AS (\n    SELECT SUM(value)\/POWER(10,18) AS balance, address\n    FROM value_table\n    GROUP BY address\n    ORDER BY balance DESC\n),\nb AS (\n    SELECT to_address, COUNT(transactions.hash) AS tx_recipient\n    FROM  `bigquery-public-data.crypto_ethereum.transactions` AS transactions\n    WHERE block_timestamp < '2021-09-01 00:00:00'\n    GROUP BY to_address\n), \nc AS (\n    SELECT from_address, COUNT(transactions.hash) AS tx_sender\n    FROM  `bigquery-public-data.crypto_ethereum.transactions` AS transactions\n    WHERE block_timestamp < '2021-09-01 00:00:00'\n    GROUP BY from_address\n)\nSELECT to_address, tx_recipient, balance\nFROM b LEFT JOIN a ON (a.address = b.to_address)\nORDER BY tx_recipient DESC\nLIMIT 10\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\n# This establishes an authenticated session and prepares a reference to the dataset that lives in BigQuery.\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=680)","b19922d7":"df","85a188cc":"query = \"\"\"\nWITH a AS (\n    SELECT DATE(block_timestamp) AS date, COUNT(*) AS contracts_creation\n    FROM  `bigquery-public-data.crypto_ethereum.traces` AS traces\n    WHERE block_timestamp < '2021-09-01 00:00:00'\n        AND trace_type = 'create'\n        AND trace_address IS null\n        GROUP BY date\n),\nb AS (\n    SELECT date, SUM(contracts_creation)\n    OVER (ORDER BY date) AS ccc, LEAD(date, 1) OVER (ORDER BY date) AS next_date\n    FROM a\n    ORDER BY date\n),\ncalendar AS (\n    SELECT date\n    FROM UNNEST(generate_date_array('2015-07-30', '2021-08-31')) AS date\n),\nc AS (\n    SELECT calendar.date, ccc\n    FROM b JOIN calendar ON b.date <= calendar.date\n    AND calendar.date < b.next_date\n    ORDER BY calendar.date\n),\nd AS (\n    SELECT date(block_timestamp) AS date1, COUNT(*) AS contracts_creation1\n    FROM  `bigquery-public-data.crypto_ethereum.traces` AS traces\n    WHERE block_timestamp < '2021-09-01 00:00:00'\n        AND trace_type = 'create'\n        AND trace_address IS NOT null\n        GROUP BY date1\n),\ne AS (\n    SELECT date1, SUM(contracts_creation1)\n    OVER (ORDER BY date1) AS ccc1, LEAD(date1, 1) OVER (ORDER BY date1) AS next_date1\n    FROM d\n    ORDER BY date1\n),\ncalendar1 AS (\n    SELECT date1\n    FROM UNNEST(generate_date_array('2015-07-30', '2021-08-31')) AS date1\n),\nf AS (\n    SELECT calendar1.date1, ccc1\n    FROM e JOIN calendar1 ON e.date1 <= calendar1.date1\n        AND calendar1.date1 < e.next_date1\n    ORDER BY calendar1.date1\n)\nSELECT date1, date, f.ccc1 as cumulative_contract_creation_by_contracts, c.ccc as cumulative_contract_creation_by_users\nFROM c JOIN f ON f.date1 = c.date\nORDER BY f.date1\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=62)","768b3076":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.rcParams.update({'font.size': 14})\nplt.title(\"Cumulative number of contracts created by users and of contracts created by other contracts\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Number of contracts\", labelpad=20)\nsns.lineplot(x=\"date\", y=\"cumulative_contract_creation_by_contracts\", data=df, color=\"crimson\", label='cumulative_contract_creation_by_contracts')\nsns.lineplot(x=\"date\", y=\"cumulative_contract_creation_by_users\", data=df, color=\"navy\", label='cumulative_contract_creation_by_users')\nplt.gcf().set_dpi(400)\nplt.show(fig)","13237236":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\n\nfig, axs = plt.subplots(figsize=(20, 6))\naxs.set(yscale=\"log\")\naxs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.rcParams.update({'font.size': 14})\nplt.title(\"Cumulative number of contracts created by users and of contracts created by other contracts\", y=1.05)\nplt.xlabel(\"Date\", labelpad=20)\nplt.ylabel(\"Number of contracts\", labelpad=20)\nsns.lineplot(x=\"date\", y=\"cumulative_contract_creation_by_contracts\", data=df, color=\"crimson\", label='cumulative_contract_creation_by_contracts')\nsns.lineplot(x=\"date\", y=\"cumulative_contract_creation_by_users\", data=df, color=\"navy\", label='cumulative_contract_creation_by_users')\nplt.gcf().set_dpi(400)\nplt.show(fig)","d8f20801":"query = \"\"\"\nSELECT COUNT(DISTINCT(from_address)) AS unique_creators\nFROM  `bigquery-public-data.crypto_ethereum.traces` AS traces\nWHERE block_timestamp < '2021-09-01 00:00:00'\n    AND trace_type='create'\n    AND trace_address IS null\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=340)","fdac39d4":"df","87cd6f65":"query = \"\"\"\nSELECT COUNT(output) AS unique_bytecodes\nFROM  `bigquery-public-data.crypto_ethereum.traces` AS traces\nWHERE block_timestamp < '2021-09-01 00:00:00'\n    AND trace_type='create'\n    AND trace_address IS null\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=340)\ndf","c4e8c548":"query = \"\"\"\nSELECT COUNT(DISTINCT(output)) AS unique_bytecodes\nFROM  `bigquery-public-data.crypto_ethereum.traces` AS traces\nWHERE block_timestamp < '2021-09-01 00:00:00'\n    AND trace_type='create'\n    AND trace_address IS null\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=340)","3f6dde53":"df","815b0406":"query = \"\"\"\nSELECT COUNT(DISTINCT(from_address)) AS unique_creators\nFROM  `bigquery-public-data.crypto_ethereum.traces` AS traces\nWHERE block_timestamp < '2021-09-01 00:00:00'\n    AND trace_type='create'\n    AND trace_address IS NOT null\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=340)","2aaa27da":"df","2be0adbd":"query = \"\"\"\nSELECT COUNT(output) AS unique_bytecodes\nFROM  `bigquery-public-data.crypto_ethereum.traces` AS traces\nWHERE block_timestamp < '2021-09-01 00:00:00'\n    AND trace_type='create'\n    AND trace_address IS NOT null\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=340)\ndf","af2099cd":"query = \"\"\"\nSELECT COUNT(DISTINCT(output)) AS unique_bytecodes\nFROM  `bigquery-public-data.crypto_ethereum.traces` AS traces\nWHERE block_timestamp < '2021-09-01 00:00:00'\n    AND trace_type='create'\n    AND trace_address IS NOT null\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=340)","2461a01b":"df","354dd2da":"query = \"\"\"\n    SELECT contracts.address, COUNT(1) AS tx_count\n    FROM `bigquery-public-data.crypto_ethereum.contracts` AS contracts\n    JOIN `bigquery-public-data.crypto_ethereum.transactions` AS transactions ON (transactions.to_address = contracts.address)\n    WHERE contracts.is_erc721 = TRUE AND contracts.block_timestamp < '2021-09-01 00:00:00'\n    GROUP BY contracts.address\n    ORDER BY tx_count DESC\n    LIMIT 10\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\n# This establishes an authenticated session and prepares a reference to the dataset that lives in BigQuery.\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=55)\ndf","f22b9fc3":"query = \"\"\"\n    SELECT contracts.address, COUNT(1) AS tx_count\n    FROM `bigquery-public-data.crypto_ethereum.contracts` AS contracts\n    JOIN `bigquery-public-data.crypto_ethereum.transactions` AS transactions ON (transactions.to_address = contracts.address)\n    WHERE contracts.is_erc20 = TRUE AND contracts.block_timestamp < '2021-09-01 00:00:00'\n    GROUP BY contracts.address\n    ORDER BY tx_count DESC\n    LIMIT 10\n\"\"\"\n\nfrom bq_helper import BigQueryHelper\n\n# This establishes an authenticated session and prepares a reference to the dataset that lives in BigQuery.\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\ndf = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=55)\ndf","127e420e":"# from google.cloud import bigquery\n# import pandas as pd\n\n# query = \"\"\"\n#     select format_timestamp('%Y-%m-%d' ,TIMESTAMP_TRUNC(block_timestamp, WEEK) ) as week,\n#     round(log10(receipt_gas_used), 1) as log10_gas_used, count(*) as ntx \n#     from `bigquery-public-data.crypto_ethereum.transactions`\n#     group by week, log10_gas_used\n#     order by week\n# \"\"\"\n\n# bq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\n# df = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=139)\n# df","7ba28bdc":"# df_pivot = pd.pivot_table(data=df, values='ntx', columns='week', index='log10_gas_used')\n# df_pivot.head()","a3a59651":"# from matplotlib import pylab as plt\n# %matplotlib inline\n# from matplotlib.pylab import rcParams\n# import numpy as np\n# import seaborn as sns\n\n# fig = plt.figure(figsize=(12,6))\n# ax=sns.heatmap(df_pivot, cmap='Reds', cbar_kws={'label': '# of txns'});\n# ax.invert_yaxis()","169a9c79":"# df['log10_ntx'] = np.log10( df['ntx'])\n# df_pivot = pd.pivot_table(data=df, values='log10_ntx', columns='week', index='log10_gas_used')\n\n# fig = plt.figure(figsize=(12,6))\n# ax=sns.heatmap(df_pivot, cmap='Blues', cbar_kws={'label': 'Log10(# of txns)'});\n# ax.invert_yaxis()","bb761cae":"# query = \"\"\"\n# WITH a as (\n#     SELECT \n#         DATE(block_timestamp) as date, SUM(value) as value\n#     FROM\n#         `bigquery-public-data.crypto_ethereum.traces`\n#     WHERE trace_type in ('genesis', 'reward')\n#         AND block_timestamp < '2021-09-01 00:00:00'\n#     GROUP BY date\n#     ORDER BY date\n# )\n# SELECT date, value \/ POWER(10, 18) AS supply FROM a\n# \"\"\"\n\n# from bq_helper import BigQueryHelper\n\n# bq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\n# df = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=108)\n# df","36bb62da":"# df_cleaned = df[1:]\n# df_cleaned.head()","352bfbe4":"# # Daily volume of ether transferred\n# import matplotlib.pyplot as plt\n# import matplotlib as mpl\n# import seaborn as sns\n\n# fig, axs = plt.subplots(figsize=(20, 6))\n# # axs.set(yscale=\"log\")\n# axs.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\n# plt.rcParams.update({'font.size': 14})\n# plt.title(\"Ether supply growth rate\", y=1.05)\n# plt.xlabel(\"Date\", labelpad=20)\n# plt.ylabel(\"Supply\", labelpad=20)\n# sns.lineplot(x=\"date\", y=\"supply\", data=df_cleaned, color=\"purple\", label='supply')\n# plt.gcf().set_dpi(400)\n# plt.show(fig)","6adcb75f":"# rtx_query = \"\"\"\n# WITH reverted_transactions_in_block as ( \n#     SELECT\n#       block_timestamp as timestamp,\n#       count(*) as count\n#     FROM\n#       `bigquery-public-data.crypto_ethereum.transactions`\n#     WHERE\n#       block_number > 4370000 -- first Byzantium block\n#       AND\n#       receipt_status = 0 -- reverted transaction indicator\n#       AND block_timestamp >= '2021-01-01 00:00:00'\n#       AND block_timestamp < '2021-08-31 00:00:00'\n#     GROUP BY\n#       1\n# )\n\n# SELECT\n#     *\n# FROM\n#     reverted_transactions_in_block\n# ORDER BY\n#     1 asc\n# \"\"\"\n\n# bq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\n# df_rtx = bq_assistant.query_to_pandas_safe(rtx_query, max_gb_scanned=7)","0d1d247e":"# df_rtx['date'] = pd.to_datetime(df_rtx.timestamp)\n# agg_rtx = df_rtx.resample('M', on='date').sum()","8c098d0c":"# agg_rtx.plot(y='count', title='Reverted Transactions on Ethereum (monthly totals)', figsize=(16, 9))","4d565992":"# # This table show us the most extreme cases for regular contract calls in ETH \n# query = \"\"\"\n#         SELECT `hash`, `value`, `gas_price` as `gas_price_in_wei`, `receipt_gas_used`, `receipt_cumulative_gas_used`, `gas_price` \/ 1000000000000000000 * `receipt_gas_used` as fee_in_ether, `block_timestamp`\n#         FROM `bigquery-public-data.crypto_ethereum.transactions`\n#         ORDER BY `receipt_gas_used` DESC\n#         LIMIT 10\n#         \"\"\"\n# bq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\n# df = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=139)\n# df","90353312":"# # This table show us the most extreme cases for regular transfers in ETH\n\n# query = \"\"\"\n#         SELECT `hash`,`value`, `gas_price` as `gas_price_in_wei`, `receipt_gas_used`, `receipt_cumulative_gas_used`, `gas_price` \/ 1000000000000000000 * `receipt_gas_used` as fee_in_ether, `block_timestamp`\n#         FROM `bigquery-public-data.crypto_ethereum.transactions`\n#         ORDER BY `gas_price` DESC\n#         LIMIT 10\n#         \"\"\"\n# bq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\n# df = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=139)\n# df","a067f2e9":"# # This table show us the most extreme cases for contract calls that also transfer value in ETH\n# # notice that \"up_front_cost = gas_price * gas_limit + value\" and here we are using gas_used instead of gas_limit\n\n# query = \"\"\"\n#         SELECT `hash`, `value`, `gas_price` as `gas_price_in_wei`, `receipt_gas_used`, `receipt_cumulative_gas_used`, `gas_price` \/ 1000000000000000000 * `receipt_gas_used` as fee_in_ether, (`gas_price` \/ 1000000000000000000 * `receipt_gas_used`) + `value` \/ 1000000000000000000 as up_front_cost_aprox_in_ether, `block_timestamp`\n#         FROM `bigquery-public-data.crypto_ethereum.transactions`\n#         WHERE `receipt_gas_used` > 21000\n#         ORDER BY `value` DESC\n#         LIMIT 10\n#         \"\"\"\n# bq_assistant = BigQueryHelper(\"bigquery-public-data\", \"crypto_ethereum\")\n# df = bq_assistant.query_to_pandas_safe(query, max_gb_scanned=139)\n# df","d3778291":"## Number of unique bytecodes of contract-created contracts","f255048b":"<hr\/>","54a5f742":"## Ether supply growth rate","1d5d7091":"## Average gas price per day","c2208f16":"<hr\/>","a258b0d2":"## Top 10 addresses measured by number of received transactions","50246f35":"## Contract creation transactions per day (Directly by users)","72f6ecee":"## Value of Ether transferred per day","76c393c7":"## Total number of transactions in the Ethereum network","375e2cae":"## Number of unique bytecodes of user-created contracts","81681650":"## What are the 10 most popular Ethereum tokens (ERC20 contracts), by number of transactions?","a28b4dc4":"## Total number of contracts","6c51814d":"# *Top 10 highest txns fees*","fd66e35f":"# Ethereum Analytics","cb836e4a":"### Content\n\nThe Ethereum blockchain data is available for exploration with BigQuery. All historical data is in the ethereum_blockchain dataset, which updates daily. We have leveraged this BigQuery dataset for our research project.\n\nThe Dataset consists of 7 tables which will be analysed throughout the project. The tables are-\n\n1. blocks\n2. contracts\n3. logs\n4. token_transfers\n5. tokens\n6. traces\n7. transactions","e5d0f199":"## Average number of transactions per day","5b1133ad":"## Ether Transactions distribution","9a36c5b1":"## Number of transactions over time","d2c4f587":"## Top 10 addresses measured by number of sent transactions","c6a4c5c0":"## Number of Smart Contracts created per day","36190816":"## Total number of bytecodes of user-created contracts","555550e5":"### Context\n\nBitcoin and other cryptocurrencies have captured the imagination of technologists, financiers, and economists. Digital currencies are only one application of the underlying blockchain technology. Like its predecessor, Bitcoin, the Ethereum blockchain can be described as an immutable distributed ledger. However, the set of capabilities have been extended by including a virtual machine that can execute arbitrary code stored on the blockchain known as **Smart Contracts**.\n\nBoth Bitcoin and Ethereum are essentially OLTP databases, and provide little in the way of OLAP (analytics) functionality. However the Ethereum dataset is notably distinct from the Bitcoin dataset:\n\n1. The Ethereum blockchain has as its primary unit of value Ether, while the Bitcoin blockchain has Bitcoin. However, the majority of value transfer on the Ethereum blockchain is composed of so-called tokens. Tokens are created and managed by smart contracts.\n\n\n2. Ether value transfers are precise and direct, resembling accounting ledger debits and credits. This is in contrast to the Bitcoin value transfer mechanism, for which it can be difficult to determine the balance of a given wallet address.\n\n\n3. Addresses can be not only wallets that hold balances, but can also contain smart contract bytecode that allows the programmatic creation of agreements and automatic triggering of their execution. An aggregate of coordinated smart contracts could be used to build a decentralized autonomous organization.","4d03093f":"## What are the 10 most popular Ethereum collectibles (ERC721 contracts), by number of transactions?","a1fd7d2f":"<hr\/>","c86a259b":"## Total number of bytecodes of contract-created contracts","259d2268":"##  Cumulative number of contracts created by users and of contracts created by other contracts","20791465":"# ------------------------ Gas usage distribution ------------------------","4dbb2f5d":"## Description","ea8cb7f3":"## Number of unique creators of user-created contracts","99ed0ad7":"## Number of unique creators of contract-created contracts","355f1228":"## Daily gas consumption","673c2e0c":"## Daily ether volume for ether transfers, contract calls, and contract creations","6772684d":"## Top 10 addresses measured by balance (value of ether)","95476db8":"## Dataset","9dfbc21e":"## Active Address Growth per day","ee2468f7":"# <----------------- Reverted Transactions over time ---------------->","fa8f11cf":"https:\/\/www.kaggle.com\/bigquery\/ethereum-blockchain","9ef0de95":"## Ether balance distribution"}}