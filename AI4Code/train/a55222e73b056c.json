{"cell_type":{"89a1c2b7":"code","5e761c41":"code","c359f930":"code","4c19ea42":"code","3571506d":"code","917db08c":"code","ffc2f362":"code","025020c0":"code","42ee4a6a":"code","5230a9ed":"code","2bf679b2":"code","5207738f":"code","30750850":"code","5b5f2534":"code","350342bb":"code","15d76997":"code","b2c297d5":"code","77189f76":"code","43a9a44d":"code","cda60772":"code","75cd8f76":"code","ac2d353c":"code","01042f42":"code","97712b30":"code","e31325e6":"code","06a894f3":"code","b5c9a3f5":"code","7c4a6083":"code","f90311c5":"code","99334624":"code","0d5e37cf":"markdown","ed64708b":"markdown","7d7c6b17":"markdown","62ea708b":"markdown","629371c8":"markdown","3ca403e9":"markdown","e305c151":"markdown","066784d8":"markdown","37c6989a":"markdown","daa9d503":"markdown","1d90c5bf":"markdown","8428db93":"markdown","223cf504":"markdown"},"source":{"89a1c2b7":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","5e761c41":"df = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","c359f930":"df.head()","4c19ea42":"df.info()","3571506d":"plt.figure(figsize=(12, 6))\nsns.histplot(data=df, x='Age')","917db08c":"plt.figure(figsize=(15, 6))\nsns.lineplot(data=df, x='Age', y='Spending Score (1-100)')","ffc2f362":"sns.pairplot(df, hue= 'Gender')","025020c0":"plt.figure(figsize=(3, 4))\nsns.countplot(data=df, x='Gender')","42ee4a6a":"plt.figure(figsize=(15, 6))\nsns.barplot(data=df,y='Spending Score (1-100)',x='Annual Income (k$)')\nplt.xticks(rotation=90);","5230a9ed":"plt.figure(figsize=(15, 6))\nsns.lineplot(data=df, x='Age', y='Annual Income (k$)')","2bf679b2":"df = df.drop('CustomerID', axis = 1)\nX = pd.get_dummies(df, drop_first=True)","5207738f":"X.head()","30750850":"from sklearn.preprocessing import StandardScaler","5b5f2534":"scaler= StandardScaler()","350342bb":"scaled_X= scaler.fit_transform(X)","15d76997":"from sklearn.cluster import KMeans","b2c297d5":"model = KMeans(n_clusters=2)","77189f76":"cluster_labels= model.fit_predict(scaled_X)","43a9a44d":"cluster_labels","cda60772":"len(scaled_X)","75cd8f76":"len(cluster_labels)","ac2d353c":"X['Cluster']=cluster_labels","01042f42":"sns.heatmap(X.corr())","97712b30":"X.corr()['Cluster'].sort_values()","e31325e6":"plt.figure(figsize=(6,4))\nX.corr()['Cluster'].sort_values().plot(kind='bar')","06a894f3":"ssd = []\nfor k in range (2, 10):\n    model=KMeans(n_clusters=k)\n    model.fit(scaled_X)\n    ssd.append(model.inertia_)","b5c9a3f5":"ssd","7c4a6083":"plt.plot(range(2,10), ssd, 'o--')\nplt.xlabel('K Value')\nplt.ylabel('Sum of Squared Distances')","f90311c5":"pd.Series(ssd).diff()","99334624":"pd.Series(ssd).diff().plot(kind='bar')","0d5e37cf":"# Introduction\n\n## K-Means Clustering\n\nK-means clustering is one of the most widely used unsupervised machine learning algorithms that forms clusters of data based on the similarity between data instances. For this particular algorithm to work, the number of clusters has to be defined beforehand. The K in the K-means refers to the number of clusters.\n\nThe K-means algorithm starts by randomly choosing a centroid value for each cluster. After that the algorithm iteratively performs three steps:\n\n* Find the Euclidean distance between each data instance and centroids of all the clusters;\n* Assign the data instances to the cluster of the centroid with nearest distance;\n* Calculate new centroid values based on the mean values of the coordinates of all the data instances from the corresponding cluster.\n\n","ed64708b":"# Creating and Fitting a KMeans Model","7d7c6b17":"**And according to the chart above, we understand that it is exactly the same group (age group 20 to about 41 years) that have a higher Spending Score.**","62ea708b":"# Import Libraries","629371c8":"**From Pairplot diagram, we can understand many things, including:**\n\n* Most of the annual income of customers is between 40k to 63k dollars and Spending Score of this group is between 40 to 60\n* Most customers over the age of 50 are Female.\n* Spending Score of Female is more tham male.\n\nLets drow some more diagrams:","3ca403e9":"## Dataset Description\n\nThis Dataset contains the basic information (ID, age, gender, income, spending score) about the customers.\n\n#### Content\nYou are owing a supermarket mall and through membership cards , you have some basic data about your customers like Customer ID, age, gender, annual income and spending score.\nSpending Score is something you assign to the customer based on your defined parameters like customer behavior and purchasing data.\n\n#### Problem Statement\nYou own the mall and want to understand the customers like who can be easily converge [Target Customers] so that the sense can be given to marketing team and plan the strategy accordingly.","e305c151":"# Choosing K Value","066784d8":"**The number of customers in the age group of 20 to about 41 years is more than other age groups.**","37c6989a":"# Import the Dataset","daa9d503":"# Data Preparing","1d90c5bf":"# Data Overview","8428db93":"# Scaling the Featues","223cf504":"# Exploratory Data Analysis"}}