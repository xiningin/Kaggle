{"cell_type":{"a6e22118":"code","47037d14":"code","8decd58e":"code","760a0f3f":"code","cadaca9b":"code","6e4eac01":"code","d5e450bf":"code","d5244965":"code","56c36575":"code","8dabdd83":"code","c087abc1":"code","b731ba48":"code","0581b430":"code","aa1b0613":"code","51377bcb":"code","d7f397a7":"code","4cd04699":"code","0baa2370":"code","ffad97cd":"code","f2eff63b":"code","cc75f256":"code","d8dec5f5":"code","a4c55d73":"code","6755336b":"code","929372d6":"code","fa7261bc":"code","bdea3c69":"code","992f3321":"code","6738998a":"code","a7679b28":"code","15814a8c":"code","f03e6f60":"code","506e0dd5":"code","be8cc5f3":"code","d90b4dce":"code","c39fe767":"code","75645c10":"code","c80c787f":"code","8e0a3a35":"code","eeb3fc1f":"code","63b216c5":"code","b3a75197":"code","476bba80":"code","164f6702":"code","dd7abf66":"code","49ce475d":"code","1d8e97e4":"code","256f2d8b":"code","96c3430b":"code","e9d0b3f3":"code","f952d957":"code","6f333e89":"code","34c6d4da":"code","33cd75e6":"code","969f5288":"code","bd85c35a":"code","d1cd2013":"code","775e58fc":"code","80045f8c":"code","8d747fcc":"code","193d9884":"code","9af8358c":"code","e53067c9":"code","435c9665":"code","5981a322":"code","a0eb5e84":"code","1ac3eff8":"markdown","13745c1e":"markdown","914a0fc0":"markdown","fd82b073":"markdown","a8554cc2":"markdown","b98a88e7":"markdown","b9d597b1":"markdown","ad89d116":"markdown","9bf86ac5":"markdown","677abfcd":"markdown","8f8df8fd":"markdown","a39ffc95":"markdown","7250222b":"markdown","c8cd1b0d":"markdown","2f6efedb":"markdown","5e27eecc":"markdown","c4babaee":"markdown","5ad9d7fc":"markdown","5710780b":"markdown","4775f0ee":"markdown","bc235dcd":"markdown","8ecf2a61":"markdown"},"source":{"a6e22118":"import numpy as np # linear algebra\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","47037d14":"df = pd.read_csv('..\/input\/insurance\/insurance.csv')","8decd58e":"df.head()","760a0f3f":"df.columns","cadaca9b":"# Looking for nomber of missing value in each column\ndf.isnull().sum()","6e4eac01":"#Calculate the average of the column\n#Lets calculate average of age.\navg_age = df['age'].mean()\navg_age","d5e450bf":"#Replace NaN by mean value\ndf['age'].replace(np.nan, avg_age, inplace=True)","d5244965":"# Lets check how many regions we have\ndf['region'].unique()","56c36575":"#df['region'] = df.region you can use both \ndf.region.value_counts()","8dabdd83":"df['age'].value_counts().sort_values(ascending=False)\n#as we can see 18 and 19 years old people are in the majority","c087abc1":"df['smoker'].value_counts()","b731ba48":"df.dtypes","0581b430":"#We will use numerical data, so we should convert 'sex','smoker' amd 'region' to numerical data\n# Encoding the data with map function\n\ndf['sex'] = df['sex'].map({'female':0,'male':1})\ndf['smoker'] = df['smoker'].map({'yes':1,'no':0})\ndf['region'] = df['region'].map({'southeast':0,'southwest':1,'northwest':2,'northeast':3})","aa1b0613":"df.head()","51377bcb":"df.describe().T","d7f397a7":"sns.regplot(x ='age', y = 'charges', data =df)\n# Weak Linear Relationship","4cd04699":"df['region'].value_counts()","0baa2370":"#Let's repeat the above steps but save the results to the dataframe \"region_value_counts\" and rename the column \n#'region' to 'value_counts'.\nregion_value_counts = df['region'].value_counts().to_frame()\nregion_value_counts.rename(columns={'region': 'value_counts'}, inplace=True)\nregion_value_counts","ffad97cd":"smoker_value_counts = df['smoker'].value_counts().to_frame()\nsmoker_value_counts.rename(columns ={'smoker': 'value_counts'},inplace =True)\nsmoker_value_counts","f2eff63b":"smoker_value_counts.index.name = 'Smoker'","cc75f256":"smoker_value_counts","d8dec5f5":"df['age'].unique()","a4c55d73":"#If we want to know, on average, which age_group and 'sex'  are charged more,\ndf_group_one = df[['age','sex','charges']]","6755336b":"df_group_one = df_group_one.groupby(['age','sex'], as_index =False).mean()","929372d6":"df_group_one","fa7261bc":"group_pivot = df_group_one.pivot(index = 'age',columns = 'sex')","bdea3c69":"group_pivot.T","992f3321":"df.corr()\n#weak correlation","6738998a":"sns.boxplot(x=\"sex\", y=\"charges\", data=df)","a7679b28":"from scipy import stats\n","15814a8c":"#Let's calculate the Pearson Correlation Coefficient and P-value of 'age' and 'charges'.\npearson_coef, p_value = stats.pearsonr(df['age'], df['charges'])\nprint(\"The Pearson Correlation Coefficient is\", pearson_coef, \" with a P-value of P =\", p_value) ","f03e6f60":"#sex vs charges\n#Let's calculate the Pearson Correlation Coefficient and P-value of 'sex' and 'charges'.\npearson_coef, p_value = stats.pearsonr(df['sex'], df['charges'])\nprint(\"The Pearson Correlation Coefficient is\", pearson_coef, \" with a P-value of P =\", p_value) ","506e0dd5":"#Binning the age column.\nbins = [17,35,55,1000]\nslots = ['Young adult','Senior Adult','Elder']\n\ndf['Age_range']=pd.cut(df['age'],bins=bins,labels=slots)","be8cc5f3":"df.head()","d90b4dce":"# I can check the number of unique values is a column\n# If the number of unique values <=40: Categorical column\n# If the number of unique values in a columns> 50: Continuous\n\ndf.nunique().sort_values()","c39fe767":"plt.figure(figsize=(25, 16))\nplt.subplot(2,3,1)\nsns.boxplot(x = 'smoker', y = 'charges', data = df)\nplt.title('Smoker vs Charges',fontweight=\"bold\", size=20)\nplt.subplot(2,3,2)\nsns.boxplot(x = 'children', y = 'charges', data = df,palette=\"husl\")\nplt.title('Children vs Charges',fontweight=\"bold\", size=20)\nplt.subplot(2,3,3)\nsns.boxplot(x = 'sex', y = 'charges', data = df, palette= 'husl')\nplt.title('Sex vs Charges',fontweight=\"bold\", size=20)\nplt.subplot(2,3,4)\nsns.boxplot(x = 'region', y = 'charges', data = df,palette=\"bright\")\nplt.title('Region vs Charges',fontweight=\"bold\", size=20)\nplt.subplot(2,3,5)\nsns.boxplot(x = 'Age_range', y = 'charges', data = df, palette= 'husl')\nplt.title('Age vs Charges',fontweight=\"bold\", size=20)\nplt.show()","75645c10":"plt.figure(figsize=(12,6))\nsns.barplot(x='region', y='charges', hue='sex', data=df, palette='Paired')\nplt.show()","c80c787f":"plt.figure(figsize=(12,6))\nsns.barplot(x = 'region', y = 'charges',hue='smoker', data=df, palette='cool')\nplt.show()","8e0a3a35":"plt.figure(figsize=(12,6))\nsns.barplot(x='region', y='charges', hue='children', data=df, palette='Set1')\nplt.show()","eeb3fc1f":"plt.figure(figsize=(12,6))\nsns.violinplot(x = 'children', y = 'charges', data=df, hue='smoker', palette='inferno')\nplt.show()","63b216c5":"#Heatmap to see correlation between variables\nplt.figure(figsize=(12, 8))\nsns.heatmap(df.corr(), cmap='RdYlGn', annot = True)\nplt.title(\"Correlation between Variables\")\nplt.show()","b3a75197":"sns.scatterplot(x=df['bmi'], y=df['charges'], hue=df['smoker'])","476bba80":"sns.lmplot(x=\"bmi\", y=\"charges\", hue=\"smoker\", data=df)","164f6702":"sns.swarmplot(x=df['smoker'],y=df['charges'])","dd7abf66":"df_group_two=df_group_one[['age', 'charges']].groupby(['age'])\ndf_group_two.head()","49ce475d":"df_group_two.get_group(18)['charges']\n#we see the 18 years old female(0) and male(1) charges","1d8e97e4":"# ANOVA\nf_val, p_val = stats.f_oneway(df_group_two.get_group(20)['charges'], df_group_two.get_group(40)['charges'], df_group_two.get_group(60)['charges'])  \n \nprint( \"ANOVA results: F=\", f_val, \", P =\", p_val)  ","256f2d8b":"from sklearn.linear_model import LinearRegression","96c3430b":"lm = LinearRegression()\nlm","e9d0b3f3":"X = df[['age','sex','bmi','region']]\nY = df['charges']","f952d957":"lm.fit(X,Y)","6f333e89":"Yhat = lm.predict(X)\nYhat[0:5]","34c6d4da":"lm.intercept_","33cd75e6":"lm.coef_","969f5288":"width = 6\nheight = 4\nplt.figure(figsize=(width, height))\nsns.regplot(x=\"bmi\", y=\"charges\", data=df)\nplt.ylim(0,)","bd85c35a":"y_data = df['charges']","d1cd2013":"x_data =df.drop('charges',axis =1)","775e58fc":"from sklearn.model_selection import train_test_split\n\n\nx_train, x_test, y_train, y_test = train_test_split(x_data, y_data, test_size=0.15, random_state=1)\n\n\nprint(\"number of test samples :\", x_test.shape[0])\nprint(\"number of training samples:\",x_train.shape[0])","80045f8c":"#Use the function \"train_test_split\" to split up the data set such that 40% of the data samples will be utilized for testing, set the parameter \"random_state\" equal to zero. The output of the function should be the following: \"x_train_1\" , \"x_test_1\", \"y_train_1\" and \"y_test_1\".","8d747fcc":"\nx_train1, x_test1, y_train1, y_test1 = train_test_split(x_data, y_data, test_size=0.4, random_state=0) \nprint(\"number of test samples :\", x_test1.shape[0])\nprint(\"number of training samples:\",x_train1.shape[0])","193d9884":"from sklearn.linear_model import LinearRegression","9af8358c":"lre=LinearRegression()  ","e53067c9":"lre.fit(x_train[['bmi']], y_train)   # we fit the model using the feature bmi","435c9665":"lre.score(x_test[['bmi']], y_test)   # claculates th R^2 on the test data","5981a322":"lre.score(x_train[['bmi']], y_train)  # we can see the R^2 is much smaller using the test data","a0eb5e84":"x_train1, x_test1, y_train1, y_test1 = train_test_split(x_data, y_data, test_size=0.1, random_state=0)\nlre.fit(x_train1[['bmi']],y_train1)\nlre.score(x_test1[['bmi']],y_test1)","1ac3eff8":"The scatter plot shows that while nonsmokers do tend to pay slightly more with increasing BMI, smokers pay much more. To further emphasize this fact, I have added two regression lines, corresponding to smokers and nonsmokers","13745c1e":"## Anova","914a0fc0":"## Exploratory Data Analysis","fd82b073":"We can notice that the regression line for smokers has a much steeper slope, relative to the line for nonsmokers. Lets conclude with categorical scatter plot.","a8554cc2":"As we can see all is numeric data now.","b98a88e7":"# Medical Cost Personal Dataset\n**Columns**\n\n**age**: age of primary beneficiary\n\n**sex**: insurance contractor gender: female, male\n\n**bmi**: bmi is defined as the body mass divided by the square of the body height, and is universally expressed in units of kg\/m\u00b2, resulting from mass in kilograms and height in metres\n\n**children**: Number of children covered by health insurance \/ Number of dependents\n\n**smoker**: Smoking\n\n**region**: the beneficiary's residential area in the US, northeast, southeast, southwest, northwest.\n\n**charges**: Individual medical costs billed by health insurance\n\nIn notebook I am trying determine predictive variables by analysing the dataset visualy","b9d597b1":"# Basic Grouping","ad89d116":"Conclusion:\n\nSince the p-value is < < 0.001, the correlation between age and charges is statistically significant, although the linear relationship isn't extremely strong (~0.585)","9bf86ac5":"### Lets convert data types to proper format\n\n","677abfcd":"## Model Development","8f8df8fd":"Conclusion: Since p-value is <0.001 , the correlation between sex and charges is statistically significant,and the linear realtionship is quite strong (0.88),close to 1","a39ffc95":"## Binning","7250222b":"# Training and Testing","c8cd1b0d":"So we dont have any missing value.","2f6efedb":"The Analysis of Variance (ANOVA) is a statistical method used to test whether there are significant differences between the means of two or more groups. ANOVA returns two parameters:\n\nF-test score: ANOVA assumes the means of all groups are the same, calculates how much the actual means deviate from the assumption, and reports it as the F-test score. A larger score means there is a larger difference between the means.\n\nP-value: P-value tells how statistically significant is our calculated score value.","5e27eecc":"From above plot we can see that, Smoking has the highest impact on medical costs, even though the costs are growing with age, bmi and children. Also people who have children generally smoke less","c4babaee":"As we can see from these barplots the highest charges due to smoking are still in the Southeast but the lowest are in the Northeast. People in the Southwest generally smoke more than people in the Northeast, but people in the Northeast have higher charges by gender than in the Southwest and Northwest overall. And people with children tend to have higher medical costs overall as well","5ad9d7fc":"## Linear Regression","5710780b":". Medical Charges are more for smoker than the non smoker.\n2. Medical Charges are more in Southeast Region\n3. Senior Adults are charged more","4775f0ee":"## Data Wrangling\n#### What is the purpose of Data Wrangling?\nData Wrangling is the process of converting data from the initial format to a format that may be better for analysis.","bc235dcd":"On average, non-smokers are charged less than smokers, and the customers who pay the most are smokers whereas the customers who pay the least are non-smokers. Hence, smoking habits determine the insurance charges.","8ecf2a61":"This grouped data is much easier to visualize when it is made into a pivot table.\n\n"}}