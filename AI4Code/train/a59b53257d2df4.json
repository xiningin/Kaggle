{"cell_type":{"f4ae5ad3":"code","9b2ccb5c":"code","c9c86802":"code","0a1030dc":"code","52d3ad12":"code","a4829847":"code","8f3416f8":"code","4cd4c0b7":"code","928fa842":"code","4dd5bd4f":"code","ed35f946":"code","12072e45":"code","1ec8c4fa":"code","b2480410":"code","71f522f6":"code","ac654cb2":"code","aa4cb1e7":"code","dbcafcc4":"code","f68872d9":"code","45be9b4c":"code","0003b497":"code","366eb484":"code","90ac3981":"code","a17c9d2f":"code","d70e6a7e":"code","825b2be6":"code","8fbf562d":"code","c9dea328":"code","ad751066":"code","f6101a8d":"code","90924920":"code","ef018793":"code","9b4bf9bc":"code","b2027b65":"code","0ee73860":"code","fe5d4a56":"code","19e4fd72":"code","851b9bf8":"code","143a50cf":"code","5026d655":"code","2a6f15f4":"code","0d128c21":"code","fbdd9e13":"code","a6d42c2d":"code","a37016e2":"code","58655d29":"code","04634782":"code","7fbe465e":"code","5419ad13":"code","72c0f85b":"code","9a7a43b7":"code","9609d364":"code","d1fe9eff":"code","e5587c9a":"code","d33f8cba":"code","8fdd5e0c":"code","13eb556b":"code","1b5f2bd2":"code","f6aa24be":"code","226908c7":"code","50cd04ca":"code","bb6a70c7":"code","a8115a83":"code","0cd4e153":"code","e099f14a":"code","17813c9c":"code","3e8cb2ae":"code","98589a55":"code","d189ee44":"code","f926c54d":"code","9905ed07":"code","554bde35":"code","f57d1faf":"code","12ab0634":"code","015bbdff":"code","849a1cca":"code","6f9be02d":"code","cd3ec54d":"code","e3a637d4":"code","e06d5c89":"code","295bb3f8":"code","6c9759d1":"code","8e0a53e3":"code","32d93c93":"code","fd9d899d":"code","59791e60":"code","fde1a4e8":"code","58488c8a":"code","87348fbd":"code","30228213":"code","dec2dc2f":"code","51961f10":"markdown"},"source":{"f4ae5ad3":"import pandas as pd\npd.set_option('display.max_columns', None)\npromo=pd.read_csv('..\/input\/promo-abuse-detection-for-payment-apps\/Promo_Abuse_Detection_Dataset.csv')\npromo.head()","9b2ccb5c":"promo.nunique().sort_values(ascending=False)","c9c86802":"promo['UserId'].value_counts().sort_values(ascending=False)[:1] #abuse detected","0a1030dc":"promo[promo['UserId']==13341428].head()","52d3ad12":"promo.loc[promo['Unnamed: 0'] == 16, \"Target\"] = 0\npromo.loc[promo['Unnamed: 0'] == 17, \"Target\"] = 1\npromo[promo['UserId']==13341428].head()","a4829847":"promo['Device Id'].value_counts().sort_values(ascending=False)[:1]#abuse detected","8f3416f8":"fix=promo[promo['Device Id']=='iosvd:++djsadjscior34728128MSASCDMVERww38rmbe8=:2537']\nfix.head()","4cd4c0b7":"i=sorted(fix['Unnamed: 0'].unique().tolist(),reverse=True)[:-1]\ni","928fa842":"promo.loc[promo['Unnamed: 0'] == 950, \"Target\"] = 0\nfor j in i:\n    promo.loc[promo['Unnamed: 0'] == j, \"Target\"] = 1\npromo[promo['Device Id']=='iosvd:++djsadjscior34728128MSASCDMVERww38rmbe8=:2537']","4dd5bd4f":"promo['Ref PC AC Number'].value_counts().sort_values(ascending=False)[:6]#abuse detected","ed35f946":"fix=promo[promo['Ref PC AC Number']=='IN312XXXXX1298']\nfix.head()","12072e45":"i=sorted(fix['Unnamed: 0'].unique().tolist(),reverse=True)[:-1]\ni","1ec8c4fa":"promo.loc[promo['Unnamed: 0'] == 656, \"Target\"] = 0\nfor j in i:\n    promo.loc[promo['Unnamed: 0'] == j, \"Target\"] = 1\npromo[promo['Ref PC AC Number']=='IN312XXXXX1298']","b2480410":"fix=promo[promo['Ref PC AC Number']=='IN312XXXXX1299']\nfix.head()","71f522f6":"i=sorted(fix['Unnamed: 0'].unique().tolist(),reverse=True)[:-1]\ni","ac654cb2":"promo.loc[promo['Unnamed: 0'] == 666, \"Target\"] = 0\nfor j in i:\n    promo.loc[promo['Unnamed: 0'] == j, \"Target\"] = 1\npromo[promo['Ref PC AC Number']=='IN312XXXXX1299']","aa4cb1e7":"fix=promo[promo['Ref PC AC Number']=='IN012XXXXX1188']\nfix.head()","dbcafcc4":"i=sorted(fix['Unnamed: 0'].unique().tolist(),reverse=True)[:-1]\ni","f68872d9":"promo.loc[promo['Unnamed: 0'] == 19, \"Target\"] = 0\nfor j in i:\n    promo.loc[promo['Unnamed: 0'] == j, \"Target\"] = 1\npromo[promo['Ref PC AC Number']=='IN012XXXXX1188']","45be9b4c":"fix=promo[promo['Ref PC AC Number']=='IN012XXXXX1190']\nfix.head()","0003b497":"i=sorted(fix['Unnamed: 0'].unique().tolist(),reverse=True)[:-1]\ni","366eb484":"promo.loc[promo['Unnamed: 0'] == 678, \"Target\"] = 0\nfor j in i:\n    promo.loc[promo['Unnamed: 0'] == j, \"Target\"] = 1\npromo[promo['Ref PC AC Number']=='IN012XXXXX1190']","90ac3981":"fix=promo[promo['Ref PC AC Number']=='IN012XXXXX1186']\nfix.head()","a17c9d2f":"i=sorted(fix['Unnamed: 0'].unique().tolist(),reverse=True)[:-1]\ni","d70e6a7e":"promo.loc[promo['Unnamed: 0'] == 18, \"Target\"] = 0\nfor j in i:\n    promo.loc[promo['Unnamed: 0'] == j, \"Target\"] = 1\npromo[promo['Ref PC AC Number']=='IN012XXXXX1186']","825b2be6":"fix=promo[promo['Ref PC AC Number']=='IN012XXXXX1185']\nfix.head()","8fbf562d":"i=sorted(fix['Unnamed: 0'].unique().tolist(),reverse=True)[:-1]\ni","c9dea328":"promo.loc[promo['Unnamed: 0'] == 658, \"Target\"] = 0\nfor j in i:\n    promo.loc[promo['Unnamed: 0'] == j, \"Target\"] = 1\npromo[promo['Ref PC AC Number']=='IN012XXXXX1185']","ad751066":"promo['Name']=promo['FirstName']+' '+promo['LastName']\npromo.nunique().sort_values(ascending=False)","f6101a8d":"promo=promo.drop(['FirstName','LastName'],axis=1)\npromo.head()","90924920":"promo['Name'].value_counts().sort_values(ascending=False)[:6]#abuse detected","ef018793":"fix=promo[promo['Name']=='amit kumar']\nfix.head()","9b4bf9bc":"i=sorted(fix['Unnamed: 0'].unique().tolist(),reverse=True)[:-1]\ni","b2027b65":"promo.loc[promo['Unnamed: 0'] == 595, \"Target\"] = 0\nfor j in i:\n    promo.loc[promo['Unnamed: 0'] == j, \"Target\"] = 1\npromo[promo['Name']=='amit kumar']","0ee73860":"fix=promo[promo['Name']=='akash gupta']\nfix.head()","fe5d4a56":"i=sorted(fix['Unnamed: 0'].unique().tolist(),reverse=True)[:-1]\ni","19e4fd72":"promo.loc[promo['Unnamed: 0'] == 822, \"Target\"] = 0\nfor j in i:\n    promo.loc[promo['Unnamed: 0'] == j, \"Target\"] = 1\npromo[promo['Name']=='akash gupta']","851b9bf8":"fix=promo[promo['Name']=='rohit kumar']\nfix.head()","143a50cf":"i=sorted(fix['Unnamed: 0'].unique().tolist(),reverse=True)[:-1]\ni","5026d655":"promo.loc[promo['Unnamed: 0'] == 886, \"Target\"] = 0\nfor j in i:\n    promo.loc[promo['Unnamed: 0'] == j, \"Target\"] = 1\npromo[promo['Name']=='rohit kumar']","2a6f15f4":"fix=promo[promo['Name']=='raman ralhan']\nfix.head()","0d128c21":"i=sorted(fix['Unnamed: 0'].unique().tolist(),reverse=True)[:-1]\ni","fbdd9e13":"promo.loc[promo['Unnamed: 0'] == 456, \"Target\"] = 0\nfor j in i:\n    promo.loc[promo['Unnamed: 0'] == j, \"Target\"] = 1\npromo[promo['Name']=='raman ralhan']","a6d42c2d":"fix=promo[promo['Name']=='sunil kumar']\nfix.head()","a37016e2":"i=sorted(fix['Unnamed: 0'].unique().tolist(),reverse=True)[:-1]\ni","58655d29":"promo.loc[promo['Unnamed: 0'] == 490, \"Target\"] = 0\nfor j in i:\n    promo.loc[promo['Unnamed: 0'] == j, \"Target\"] = 1\npromo[promo['Name']=='sunil kumar']","04634782":"round(promo.Name.isnull().sum()*100\/len(promo),2)","7fbe465e":"promo[['Name']]=promo[['Name']].fillna('Unknown')\nfix=promo[promo['Name']=='Unknown']#abuse detected as posssibility of hacker expected.\nfix.head()","5419ad13":"i=sorted(fix['Unnamed: 0'].unique().tolist(),reverse=True)\nlen(i)","72c0f85b":"for j in i:\n    promo.loc[promo['Unnamed: 0'] == j, \"Target\"] = 1\npromo.head()","9a7a43b7":"round(promo.Target.isnull().sum()*100\/len(promo),2)","9609d364":"promo.Target=promo.Target.fillna(0)\nround(promo.Target.value_counts()*100\/len(promo),2)","d1fe9eff":"promo[['Sim_OS','Sim_Info','Sim_User']] = promo['Sim Id'].str.split(':',expand=True)\npromo.head()","e5587c9a":"promo[['Device_OS','Device_Info','Device_User']] = promo['Device Id'].str.split(':',expand=True)\npromo.head()","d33f8cba":"promo=promo.drop(['Device Id','Sim Id'],axis=1)\npromo.head()","8fdd5e0c":"promo[['LastLoginTime','PresentLoginTime']].info()","13eb556b":"promo['LastLoginTime']=promo['LastLoginTime'].replace('01-01-1900 00:00','00:00:00')\npromo['LastLoginTime'].unique()","1b5f2bd2":"promo[['LastLoginTime_HH','LastLoginTime_MM','LastLoginTime_SS']] = promo['LastLoginTime'].str.split(':',expand=True)\npromo.head()","f6aa24be":"promo[['PresentLoginTime_HH','PresentLoginTime_MM','PresentLoginTime_SS']] = promo['PresentLoginTime'].str.split(':',expand=True)\npromo.head()","226908c7":"promo=promo.drop(['LastLoginTime','PresentLoginTime'],axis=1)\npromo.head()","50cd04ca":"promo[['Meta Data_1','Meta Data_2','Meta Data_3','Meta Data_4']] =promo['Meta Data'].str.split('-',expand=True)\npromo.head()","bb6a70c7":"promo[['Email_user','Email_Domain']] =promo['Email'].str.split('@',expand=True)\npromo.head()","a8115a83":"promo=promo.drop(['Email','Meta Data'],axis=1)\npromo.head()","0cd4e153":"promo[['Reg Client IP_1','Reg Client IP_2','Reg Client IP_3','Reg Client IP_4']] =promo['Reg Client IP'].str.split('.',expand=True)\npromo.head()","e099f14a":"promo=promo.drop(['Unnamed: 0','Reg Client IP'],axis=1)\npromo.head()","17813c9c":"promo.nunique().sort_values(ascending=False)","3e8cb2ae":"promo=promo.drop(['ProgramId','ProgramName','Meta Data_1','Meta Data_3','Status','Email_Domain','BadTryCount'],axis=1)\npromo.head()","98589a55":"promo['Reg Referral Code']=promo['Reg Referral Code'].str.strip().str[-3:]\npromo['Reg Referral Code'].head()","d189ee44":"promo['RegisteredOn']=pd.to_datetime(promo['RegisteredOn'])\npromo['Dob']=pd.to_datetime(promo['Dob'])\npromo.head()","f926c54d":"promo.info()","9905ed07":"promo[['UserId','Mobile','PostalCode']]=promo[['UserId','Mobile','PostalCode']].astype(object)\npromo.info()","554bde35":"promo.nunique().sort_values(ascending=False)","f57d1faf":"promo.columns","12ab0634":"promo.info()","015bbdff":"(promo.isnull().sum()*100\/len(promo)).sort_values(ascending=False)","849a1cca":"promo[['Reg Referral Code','Reg Referral Prefix']]=promo[['Reg Referral Code',\n                                                                 'Reg Referral Prefix']].fillna('Unknown')\n(promo.isnull().sum()*100\/len(promo)).sort_values(ascending=False)","6f9be02d":"promo.Gender.value_counts()","cd3ec54d":"promo['Gender']=promo['Gender'].fillna('U')\n(promo.isnull().sum()*100\/len(promo)).sort_values(ascending=False)","e3a637d4":"promo.nunique().sort_values(ascending=False)","e06d5c89":"promo.Name.value_counts()[:5]","295bb3f8":"!pip install pycaret","6c9759d1":"promo.nunique().sort_values(ascending=False)*100\/len(promo)","8e0a53e3":"promo.columns\n","32d93c93":"promo.info()","fd9d899d":"promo.nunique().sort_values(ascending=False)","59791e60":"!pip install pandas-profiling","fde1a4e8":"from pandas_profiling import ProfileReport\nProfileReport(promo, title=\"EDA Report\")","58488c8a":"data = promo.sample(frac=0.8, random_state=42)\ndata_unseen = promo.drop(data.index)\ndata.reset_index(inplace=True, drop=True)\ndata_unseen.reset_index(inplace=True, drop=True)\nprint('Data for Modeling: ' + str(data.shape))","87348fbd":"print('Unseen Data For Predictions: ' + str(data_unseen.shape))","30228213":"from pycaret.classification import *\npromo= setup(data =data, session_id=42,\n             target = 'Target',\n                  normalize = True, \n                  transformation = True, \n                  log_experiment = True,\n                  remove_multicollinearity = True, #rop one of the two features that are highly correlated with each other\n                  date_features=['RegisteredOn','Dob'],\n            categorical_features=[ 'Gender', 'UserId', 'Mobile', 'PostalCode',\n       'OS Type', 'Reg Referral Code', 'Reg Referral Prefix',\n       'Ref PC AC Number', 'Name', 'Sim_OS', 'Sim_Info', 'Sim_User',\n       'Device_OS', 'Device_Info', 'Device_User', 'LastLoginTime_HH',\n       'LastLoginTime_MM', 'LastLoginTime_SS', 'PresentLoginTime_HH',\n       'PresentLoginTime_MM', 'PresentLoginTime_SS', 'Meta Data_2',\n       'Meta Data_4', 'Email_user', 'Reg Client IP_1', 'Reg Client IP_2',\n       'Reg Client IP_3', 'Reg Client IP_4'],\n            high_cardinality_features =[ 'UserId', 'Mobile', 'PostalCode',\n       'OS Type', 'Reg Referral Code',\n       'Ref PC AC Number', 'Name', 'Sim_User',\n        'Device_User', 'LastLoginTime_HH',\n       'LastLoginTime_MM', 'LastLoginTime_SS', 'PresentLoginTime_HH',\n       'PresentLoginTime_MM', 'PresentLoginTime_SS',\n       'Meta Data_4', 'Email_user', 'Reg Client IP_1', 'Reg Client IP_2',\n       'Reg Client IP_3', 'Reg Client IP_4']  ,         \n            train_size = 0.8)","dec2dc2f":"compare_models()","51961f10":"There are few considerations , we are working with.\n- A device can be use once\n- Cashback to same account more than once is an abuse\n- Name with same email ID is an abuse"}}