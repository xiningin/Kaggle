{"cell_type":{"b60e11d5":"code","0102d79c":"code","ffcf2baf":"code","6b4bc4ec":"code","eeb75cb0":"code","1f17b698":"code","e7af46af":"code","a461d9a6":"code","f791c41c":"code","d6e10ada":"code","47bdf616":"code","d1d60cbc":"code","92db00ce":"code","8f45faf5":"code","ab679ca1":"code","d1c16610":"code","1be93029":"code","5570ebe8":"code","8798cdd4":"code","ba485a24":"code","bba7770f":"code","0abfc30b":"code","6b1e42dc":"code","c883fd78":"code","841dc211":"code","a78581b4":"code","2e6f2ab2":"code","1eef08fb":"code","ecdb4bd2":"code","42deeb0a":"code","8eeb120c":"code","1b7bff4c":"markdown","07957b01":"markdown","dd1433df":"markdown","6b49c041":"markdown","14e5d5eb":"markdown","7b703cba":"markdown","b76fb820":"markdown","c73a9c65":"markdown","dd1e435b":"markdown","9e3d0260":"markdown","c4a0c29c":"markdown","6164d6c2":"markdown","7610a6bb":"markdown"},"source":{"b60e11d5":"import numpy as np\nimport pandas as pd\nimport os\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n","0102d79c":"import matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly as py\nimport plotly.graph_objs as go\npy.offline.init_notebook_mode(connected = True)\n%matplotlib inline","ffcf2baf":"print(\"pandas version: {}\".format(pd.__version__))\nprint(\"numpy version: {}\".format(np.__version__))\nprint(\"seaborn version: {}\".format(sns.__version__))","6b4bc4ec":"customer=pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","eeb75cb0":"customer.head(10)","1f17b698":"customer.describe()","e7af46af":"customer.info()","a461d9a6":"customer.isnull().sum()","f791c41c":"sns.set(style = 'ticks')\nplt.figure(figsize = (15 , 6))\ni = 1\nfor value in ['Age' , 'Annual Income (k$)' , 'Spending Score (1-100)']:\n    plt.subplot(1 , 3 , i)\n    i +=1\n    sns.distplot(customer[value] , bins = 20, kde=False, color=\"#FF8C00\")\n    plt.title('Distribution of {}'.format(value))\nplt.tight_layout()","d6e10ada":"age_male = customer[customer['Gender']=='Male']['Age']\nage_female = customer[customer['Gender']=='Female']['Age']\n\nage_bin =range(10,75,5) # Minimum Age is 18, Maximum is 70\n\n# Histogram for Male\nfig, (ax1, ax2) = plt.subplots(nrows=1, ncols=2, figsize=(13,6), sharey=True)\nsns.distplot(age_male, bins=age_bin, kde=False, color='#3498db',ax=ax1, hist_kws=dict(edgecolor=\"y\", linewidth=1))\nax1.set_title('Males')\nax1.set_xticks(age_bin)\nax1.set_ylim(top=20)\nax1.set_ylabel('Count')\nax1.text(45,18,'Average Age: {}'.format(np.around(age_male.mean(),1)) , fontsize=12)\n\n# Histogram for Female\nsns.distplot(age_female, bins=age_bin, kde=False, color='#cc66ff',ax=ax2, hist_kws=dict(edgecolor=\"y\", linewidth=1))\nax2.set_title('Females')\nax2.set_xticks(age_bin)\nax2.set_ylim(top=20)\nax2.set_ylabel('Count')\nax2.text(45,18,'Average Age: {}'.format(np.around(age_female.mean(),1)) , fontsize=12)\nplt.show()","47bdf616":"inc_male = customer[customer['Gender']=='Male']['Annual Income (k$)']\ninc_female = customer[customer['Gender']=='Female']['Annual Income (k$)']\n\nincome_bin =range(10,150,10) # Minimum Income is 15K, Maximum is 137K\n\n# Histogram for Male\nfig, (ax1, ax2) = plt.subplots(nrows=1, ncols=2, figsize=(13,6), sharey=True)\nsns.distplot(inc_male, bins=income_bin, kde=False, color='#3498db',ax=ax1, hist_kws=dict(edgecolor=\"y\", linewidth=1))\nax1.set_title('Males')\nax1.set_xticks(income_bin)\nax1.set_ylim(auto=True)\nax1.set_ylabel('Count')\nax1.text(80,19,'Average Income: {}k$'.format(np.around(inc_male.mean(),1)) , fontsize=12)\n\n# Histogram for Female\nsns.distplot(inc_female, bins=income_bin, kde=False, color='#cc66ff',ax=ax2, hist_kws=dict(edgecolor=\"y\", linewidth=1))\nax2.set_title('Females')\nax2.set_xticks(income_bin)\nax2.set_ylim(auto=True)\nax2.set_ylabel('Count')\nax2.text(80,19,'Average Income: {}k$'.format(np.around(inc_female.mean(),1)) , fontsize=12)\nplt.show()","d1d60cbc":"spscore_male = customer[customer['Gender']=='Male']['Spending Score (1-100)']\nspscore_female = customer[customer['Gender']=='Female']['Spending Score (1-100)']\n\nspscore_bin =range(0,105,5) # Minimum Spending Score is 1, Maximum is 99\n\n# Histogram for Male\nsns.set_style(style='ticks', rc=None)\nfig, (ax1, ax2) = plt.subplots(nrows=1, ncols=2, figsize=(12,5), sharey=True)\nsns.distplot(spscore_male, bins=income_bin, kde=False, color='#3498db',ax=ax1, hist_kws=dict(edgecolor=\"y\", linewidth=1))\nax1.set_title('Males')\nax1.set_xticks(spscore_bin)\nax1.set_yticks(range(0,17,1))\nax1.set_xlim(1,100)\nax1.set_ylim(0,16)\nax1.set_ylabel('Count')\nax1.text(40,19,'Average Spending Score: {}'.format(np.around(spscore_male.mean(),1)) , fontsize=12)\n\n# Histogram for Female\nsns.distplot(spscore_female, bins=income_bin, kde=False, color='#cc66ff',ax=ax2, hist_kws=dict(edgecolor=\"y\", linewidth=1))\nax2.set_title('Females')\nax2.set_xticks(spscore_bin)\nax2.set_yticks(range(0,17,1))\nax2.set_xlim(1,100)\nax2.set_ylim(0,16)\nax2.set_ylabel('Count')\nax2.text(40,19,'Average Spending Score: {}'.format(np.around(spscore_female.mean(),1)) , fontsize=12)\nplt.show()","92db00ce":"sns.pairplot(data=customer, hue='Gender')","8f45faf5":"sns.heatmap(customer.corr(), cmap='coolwarm')","ab679ca1":"sns.jointplot(x='Annual Income (k$)', y='Spending Score (1-100)', data=customer, kind='reg')","d1c16610":"sns.lmplot(x='Annual Income (k$)', y='Spending Score (1-100)', data=customer, hue='Gender',aspect=1.5)","1be93029":"sns.lmplot(x='Age', y='Spending Score (1-100)', data=customer, hue='Gender',aspect=1.5)","5570ebe8":"sns.lmplot(x='Age', y='Annual Income (k$)', data=customer, hue='Gender', aspect=1.5)","8798cdd4":"cust = customer.drop(['CustomerID','Gender'], axis=1)\ncust.head()","ba485a24":"from sklearn.cluster import KMeans\nfind_cls=[]\nfor i in range(1,15):\n    kmean = KMeans(n_clusters=i)\n    kmean.fit(cust)\n    find_cls.append(kmean.inertia_)\n    \n   ","bba7770f":"find_cls","0abfc30b":"fig, axs = plt.subplots(figsize=(12,5))\nsns.lineplot(range(1,15),find_cls, ax=axs, marker='o' )\naxs.axvline(5, ls=\"--\", c=\"crimson\")\naxs.axvline(6, ls=\"--\", c=\"crimson\")\nplt.grid()\nplt.show()","6b1e42dc":"kmean_5cls = KMeans(n_clusters=5,init='k-means++')\nkmean_5cls.fit(cust)\n","c883fd78":"kmean_5cls.inertia_","841dc211":"kmean_5cls.cluster_centers_","a78581b4":"kmean_5cls.labels_","2e6f2ab2":"cust['cls_label']=kmean_5cls.labels_","1eef08fb":"cust.head()","ecdb4bd2":"fig, (ax1,ax2) = plt.subplots(1,2,figsize=(16,5),sharey=True)\n\nsns.scatterplot('Annual Income (k$)','Spending Score (1-100)', data=cust, hue='cls_label',\n                ax=ax1,palette='Set1', legend='full')\nax1.set_title('Annual Income VS Spending Score (1-100)')\nax1.scatter(kmean_5cls.cluster_centers_[:,1], \n            kmean_5cls.cluster_centers_[:,2], marker='D',c='Black') #Centre for Annual Income & Spending Score\nsns.scatterplot('Age','Spending Score (1-100)', data=cust, hue='cls_label', \n                ax=ax2, palette='Set1', legend='full')\nax2.set_title('Age VS Spending Score (1-100)')\nax2.scatter(kmean_5cls.cluster_centers_[:,0], \n            kmean_5cls.cluster_centers_[:,2], marker='D',c='Black') #Centre for Age & Spending Score\nplt.show()","42deeb0a":"from mpl_toolkits.mplot3d import Axes3D\n\nfig = plt.figure(figsize=(7, 7))\nax = Axes3D(fig, rect=[0, 0, .99, 1], elev=30, azim=-60)\nax.scatter(cust['Age'],\n           cust['Annual Income (k$)'],\n           cust['Spending Score (1-100)'],\n           c=cust['cls_label'],\n           s=35, edgecolor='b', cmap=plt.cm.Set1)\nax.set_xlabel('Age')\nax.set_ylabel('Annual Income (k$)')\nax.set_zlabel('Spending Score (1-100)')\nax.set_title('3D view of K-Means 5 clusters')\nax.dist = 12\n\nplt.show()","8eeb120c":"trace3d = go.Scatter3d(x= cust['Age'], y= cust['Spending Score (1-100)'], z= cust['Annual Income (k$)'],\n    mode='markers', marker=dict(color = cust['cls_label'], size= 5, opacity=0.7))\n\nlayout = go.Layout(\n    title = '3D View of Customer Segmentation',\n    margin=dict(l=65, r=50, b=65, t=90),\n    scene = dict(\n            xaxis = dict(title  = 'Age'),\n            yaxis = dict(title  = 'Spending Score'),\n            zaxis = dict(title  = 'Annual Income')\n        )\n)\nfig = go.Figure(data = trace3d, layout = layout)\nfig.show()","1b7bff4c":"# Selecting only Numeric data for clustering","07957b01":"# Clustering the Data","dd1433df":"# Data Analysis","6b49c041":"Average Income for Male (62.2k $) is more than Average Income of Female (59.2k $). Maximum Income group for Male & Female is same 70-80k $.","14e5d5eb":"# Plot Cluster with Centre","7b703cba":"# Selecting Cluster Value 5","b76fb820":"# 3D Plots for Age, Annual Income & Spending Score","c73a9c65":"There are 5 columns-\nCustomerID - Numerical\nGender - categorical or dichotomous \nAge - Numerical\nAnnual Income (k$)\t- Numerical\nSpending Score (1-100) - Numerical","dd1e435b":"Male Average is 39.8, Female Average is 38.1. Age distribution for femal has maximum customer in age group 30-35 , however for Male it is uniform","9e3d0260":"# Insight View of data using variaus plot","c4a0c29c":"There is no Null Value, data cleaning is not required","6164d6c2":"Female has more average spending score (52.5) than Male '48.5'.","7610a6bb":"# Finding Number of Cluster"}}