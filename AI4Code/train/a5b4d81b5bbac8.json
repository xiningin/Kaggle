{"cell_type":{"eff40b2a":"code","805e0be1":"code","1d2c11da":"code","1d148223":"code","5eafc229":"code","8d31d129":"code","098dfa1a":"code","fa0c6fd2":"code","fc9a1531":"code","bc72c3c6":"code","95a75a7a":"code","7e7f231a":"code","ac089175":"code","3d2be442":"code","2f9341c7":"markdown","bc54ccdd":"markdown"},"source":{"eff40b2a":"from load_kaggle import load_kaggle\nsubm,train, test = load_kaggle()","805e0be1":"train.head()","1d2c11da":"### we will drop the standard error column since it is not there in test ##\ntrain.drop('standard_error', axis=1,inplace=True)\nprint(train.shape)\ntrain.head()","1d148223":"test.head(2)","5eafc229":"#!pip install git+https:\/\/github.com\/AutoViML\/deep_autoviml.git\n#!pip install deep_autoviml","8d31d129":"from deep_autoviml import deep_autoviml as deepauto","098dfa1a":"nlp_column = 'excerpt'\ntarget = 'target'","fa0c6fd2":"project_name = \"commonlit\"\nkeras_model_type = 'auto'\nmodel_options = {'nlp_char_limit':10, 'cat_feat_cross_flag':False,\n                 'max_trials': 10, \"tuner\": \"storm\"}\nkeras_options = {\"patience\":10, 'class_weight': True, 'early_stopping': True, \n                 'lr_scheduler': 'onecycle2', \"optimizer\": 'RMS'}","fc9a1531":"model, cat_vocab_dict = deepauto.fit(train, target, keras_model_type=keras_model_type,\n\t\tproject_name=project_name, keras_options=keras_options,  \n\t\tmodel_options=model_options, save_model_flag=True, use_my_model='',\n\t\tmodel_use_case='', verbose=0)","bc72c3c6":"from deep_autoviml.utilities.utilities import plot_classification_results, print_regression_model_stats\nfrom sklearn.metrics import classification_report, confusion_matrix, balanced_accuracy_score","95a75a7a":"predictions = deepauto.predict(model, project_name, test_dataset=test,\n                                 keras_model_type=keras_model_type, \n                                 cat_vocab_dict=cat_vocab_dict)","7e7f231a":"y_probas = predictions[0]\ny_probas[:,:4]","ac089175":"subm[target] = y_probas.ravel()\nsubm.head()","3d2be442":"subm.to_csv('submission.csv', index=False)","2f9341c7":"for inum, each_t in enumerate(target):\n    labels = np.unique(y_test[:,inum]) ### sometimes there is less classes\n    plot_classification_results(y_test[:,inum], y_preds[:,inum], labels, labels, each_t) ","bc54ccdd":"## This is done using a new deep learning library called deep_autoviml\nhttps:\/\/github.com\/AutoViML\/deep_autoviml\n\n# Build keras pipelines and models in a single line of code! You can use this library for structured data, text, NLP, image whatever you want and combine deep and wide models etc. The amount of functionality in this single library is too numerous to list. Check it out yourself.\n\n![image.png](attachment:f936dc96-f5d7-42ef-8e28-54b8f9d3cc46.png)\n\nYou must add the \"load_kaggle\" Utility Script from File Menu in Kaggle above. Don't forget!\n"}}