{"cell_type":{"037378b8":"code","c48a7755":"code","5aa6cdd8":"code","106ee60d":"code","35d0c15e":"code","1d2b12d0":"code","1182a1b7":"code","edba3ed7":"markdown","5cedd05a":"markdown","808f5952":"markdown","25f104bb":"markdown","cab175e1":"markdown","976adbff":"markdown","a4b90266":"markdown","05f54819":"markdown"},"source":{"037378b8":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","c48a7755":"import cv2\nimport matplotlib.pyplot as plt","5aa6cdd8":"#Lets load the data\ntrain = pd.read_csv('..\/input\/ntt-data-global-ai-challenge-06-2020\/COVID-19_train.csv')\ntest = pd.read_csv('..\/input\/ntt-data-global-ai-challenge-06-2020\/COVID-19_test.csv')\n\n#Load images ( I took it from another kaggler). If you want to try with another dataset just replace \"Italy\" (put \"France\" as an Example)\nTIF = \"\/kaggle\/input\/ntt-data-global-ai-challenge-06-2020\/NTL-dataset\/tif\/\"\ntif_list = os.listdir(\"\/kaggle\/input\/ntt-data-global-ai-challenge-06-2020\/NTL-dataset\/tif\/\")\nitaly_list = [i for i in tif_list if i.startswith(\"Italy\")]\nitaly_list.sort()\n\n#List where we are going to save the differences between images.\nres_list = []\n\n","106ee60d":"\n#define spots. The lower_white variable could be considered as a thresshold\nlower_white = np.array([0,0,220], dtype=np.uint8)    \nupper_white = np.array([0,0,255], dtype=np.uint8)","35d0c15e":"for i in range(len(italy_list)-1):\n    Img = cv2.imread(TIF+italy_list[i])\n    Img2 = cv2.imread(TIF+italy_list[i+1])\n    \n    #change colors\n    Img = cv2.cvtColor(Img, cv2.COLOR_BGR2HSV)\n    Img2 = cv2.cvtColor(Img2, cv2.COLOR_BGR2HSV)\n    \n    #define masks\n    mask_white_1 = cv2.inRange(Img, lower_white, upper_white)\n    mask_white_2 = cv2.inRange(Img2, lower_white, upper_white)\n\n    #IMG1\n    result_white_1 = cv2.bitwise_and(Img, Img, mask=mask_white_1)\n    result_white_1 = cv2.cvtColor(result_white_1, cv2.COLOR_HSV2BGR)\n\n    #IMG2\n    result_white_2 = cv2.bitwise_and(Img2, Img2, mask=mask_white_2)\n    result_white_2 = cv2.cvtColor(result_white_2, cv2.COLOR_HSV2BGR)\n\n    #save the differences (Im sure there is a better way to perform this operation)                                        \n    difference = result_white_2 - result_white_1  \n    res_list.append(difference)\n    \n    \n\n#This is an output example\nplt.figure(figsize=(15,10))\nplt.subplot(2, 2, 1)\nplt.imshow(res_list[0])\nplt.subplot(2, 2, 2)\nplt.imshow(res_list[1])\nplt.subplot(2, 2, 3)\nplt.imshow(res_list[2])\nplt.subplot(2, 2, 4)\nplt.imshow(res_list[3])\n\n\n\n","1d2b12d0":"#white pixels on the image\nmovements = []\nfor i in range(len(res_list)):\n    n_white_pix = np.sum(res_list[i] >= 150)\n    movements.append(n_white_pix)    \nprint(movements)\n\n#Normalizing\nnorm = np.linalg.norm(movements)\nnormal_array = movements\/norm\nprint(normal_array)\n\n#the dates will be the average of each pair of periods\ndate = [\"2\/3 jan\", \"3\/3 jan\", \"1\/3 Feb\", \"2\/3 Feb\" ,\"3\/3 Feb\", \"1\/3 Mar\", \"2\/3 Mar\" ,\"3\/3 Mar\", \"1\/3 Apr\", \"2\/3 Apr\" ,\"3\/3 Apr\", \"1\/3 May\", \"2\/3 May\" ,\"3\/3 May\"]\n\n\nplt.figure(figsize=(15,10))\nplt.plot(date, normal_array)\nplt.show()\n\n\n\n\n","1182a1b7":"\nfig, ax = plt.subplots(figsize=(15,10))\nax.plot(train['Date'],train['Italy_new_cases'])\nplt.grid()\nplt.xticks(rotation='vertical')\nax.set(xlabel=\"Date\",\n       ylabel=\"cases\",\n       title=\"Italy cases over time\") ","edba3ed7":"As a final conclusion, i think light differences could be the key on this question, I will let you to test with another country as France (It seems to match well also), to see the results and guess what happened on each peak.\n\nThank you very much and every commentary will be well accepted. Also Forgive me for my level of programming, I'm a little out of practice.","5cedd05a":"Now, we have to apply the mask to every image, compare them and get the differences.","808f5952":"Let me put the Italy new cases statistics to guess when the people started freaking out and moving to his little towns.","25f104bb":"Hello guys! Hope everything is ok.\n\nFrom my point of view, one of the most difficult parts on this challenge is related with Satellite images. Which kind of information we can extract from the images and how it will affect to our models for predicting oil prices.\n\nSo, I have one theory. Maybe is not the best but i think we can link both worlds in different ways. This is just a draft about my thoughts.\n\nFirst of all, what is supposed to happen when a big pandemic like this impact the whole world? And a countrys government announce an alarm state?\nYes, the people run outside cities. So if we are right, we will find that the lights of the small cities on the outsides should be brighter, while the lights of the big cities will remain the same (the quality and resolution of the photos dont allow us to identify differences at these levels)\n\nThen, as a first step, we have to identify the light differences over time, giving a variation data for each 10 days period of time. Lets go!!","cab175e1":"Now we have to count the new pixels on the image for each period, create an array and normalize it.","976adbff":"So.. here it is! the biggest point seems to match with the moment when italy put its state of alarm, and also with the 2 weeks when all kind of trade was closed (there is at least no movement between 2\/3 March and 3\/3 March. Once those two weeks were over, the main industries were back (although the citizens were still at home), so we could explain the subsequent movements. \n\nOr maybe it is a coincidence! (remember that we dont have quality enough satellite images) but it seems to be more or less related right?","a4b90266":"This is important. If we want to measure the differences, we have to \"delete\" the cloud effect on the photos. Thats one of the challenges of analyzing the images, and my idea is to keep the brightest spots in the image. So lets define a mask. If you find a better way to do this, would be nice if you share it!","05f54819":"We are going to use Italy as first reference(Coronavirus FIFO :P) , but it will be simple to switch between countries. The idea is to compare image differences between 2 mean images. these differences will show how people have moved around the country from one period to another, and hopefully, we'll see spikes when the virus starts to spread and states set the national alarm."}}