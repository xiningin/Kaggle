{"cell_type":{"cd73e37b":"code","36d7adfe":"code","d07364a2":"code","630342db":"code","a1dfa2da":"code","5a02d98b":"code","eec3aad6":"code","2ad3e990":"code","50a7bd3e":"code","5c3ebbdd":"code","0df7f5ae":"code","79ba7fcd":"code","4caabfa2":"code","9571d45d":"code","404d33e3":"code","e03e22a0":"code","57a42102":"code","9dba31e2":"code","1991a396":"code","1459aeb6":"code","5c7656df":"code","24d46396":"markdown","f2813754":"markdown","6c7c35dc":"markdown","0ac12b74":"markdown","884aa550":"markdown","c4129f6b":"markdown","5f23eb13":"markdown","8efdc502":"markdown","3b171608":"markdown","2a43c18a":"markdown","a9a0d6a2":"markdown","f39b7c0d":"markdown","d8e9c1d2":"markdown","5eada120":"markdown","4fd9308f":"markdown","321ac902":"markdown","70048eaa":"markdown","bf3b4a4f":"markdown","dbb77d4c":"markdown","b7d1216c":"markdown","18d6ff13":"markdown"},"source":{"cd73e37b":"\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","36d7adfe":"# These two bad boys will help us plot our data and understand it a bit graphically:\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n# Importing some tools to preprocess the data:\nfrom sklearn.preprocessing import LabelEncoder, StandardScaler\nfrom sklearn.model_selection import train_test_split\n\n# Lets import some algorithms now:\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.metrics import accuracy_score, r2_score\n\n# Importing tools form Keras library in order to build Neural Network:\nfrom keras.losses import binary_crossentropy\nfrom keras.layers import Dense\nfrom keras.models import Sequential\nfrom keras.metrics import Accuracy\nfrom keras.optimizers import RMSprop, SGD, Adam\nfrom keras.optimizers.schedules import ExponentialDecay \n","d07364a2":"data = pd.read_csv(\"..\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv\", index_col='customerID')\ndata.head()\n","630342db":"data.isnull().sum()","a1dfa2da":"plt.figure(figsize=(7,7))\nsns.set_context(\"poster\", font_scale=0.7)\nsns.set_palette(['pink', 'skyblue'])\nsns.countplot(data['gender'])\n","5a02d98b":"plt.figure(figsize=(8,8))\nsns.set_context(\"poster\", font_scale=0.7)\nsns.set_palette(['k', 'darkgrey'])\nsns.countplot(data['SeniorCitizen'])\nplt.xticks([0,1], ['Not a SeniorCitizen', 'SeniorCitizen'])","eec3aad6":"c = (data.dtypes == 'object')\ncatcol = list(c[c].index)","2ad3e990":"encdata = data.copy()\nenc = LabelEncoder()\ncolumns = data.columns\nfor col in catcol:\n    encdata[col] = enc.fit_transform(encdata[col])\n    \nencdata = pd.DataFrame(encdata, columns=columns)","50a7bd3e":"plt.figure(figsize=(9,9))\nsns.heatmap(encdata.corr(), cmap='Blues')","5c3ebbdd":"plt.figure(figsize=(7,7))\nsns.set_context(\"poster\", font_scale=0.7)\nsns.set_palette(['pink', 'skyblue'])\nsns.scatterplot(data=data, x='TotalCharges', y='tenure', hue='Churn')","0df7f5ae":"plt.figure(figsize=(7,7))\nsns.set_context(\"poster\", font_scale=0.7)\nsns.set_palette(['pink', 'skyblue'])\nsns.scatterplot(data=data, x='MonthlyCharges', y='tenure', hue='Churn')","79ba7fcd":"data = pd.read_csv(\"..\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv\")\ndata.head()","4caabfa2":"y = data['Churn']\n\nenc = LabelEncoder()\ny = enc.fit_transform(y)\n\ndata.drop(['Churn', 'customerID'], axis=1, inplace=True)","9571d45d":"c = (data.dtypes == 'object')\ncatcol = list(c[c].index)","404d33e3":"for col in catcol:\n    data[col] = enc.fit_transform(data[col])","e03e22a0":"xtrain, xtest, ytrain, ytest = train_test_split(data, y, train_size=0.95, test_size=0.05)","57a42102":"DecModel = DecisionTreeClassifier()\n\nDecModel.fit(xtrain, ytrain)\n\nDecPreds = DecModel.predict(xtest)\n\naccuracy_score(DecPreds, ytest)","9dba31e2":"DecModel = RandomForestClassifier(n_estimators=1500)\n\nDecModel.fit(xtrain, ytrain)\n\nDecPreds = DecModel.predict(xtest)\n\naccuracy_score(DecPreds, ytest)","1991a396":"def neuralnet(xtrain, xtest, ytrain, ytest):\n    NModel = Sequential([\n    Dense(128, input_shape=(19,), activation='relu'),\n    Dense(240, activation='relu'),\n    Dense(32, activation='relu'),\n    Dense(1, activation='sigmoid')\n    ])\n    \n    adam = Adam(learning_rate=0.007)\n    \n    NModel.compile(optimizer=adam, loss='binary_crossentropy', metrics=['accuracy'])\n    \n    Fit = NModel.fit(xtrain, ytrain, epochs=50, validation_data=(xtest, ytest))\n    return Fit","1459aeb6":"scale = StandardScaler()\n\nscaledtrain = scale.fit_transform(xtrain)\nscaledtest = scale.transform(xtest)","5c7656df":"neuralnet(scaledtrain, scaledtest, ytrain, ytest)","24d46396":"Lets use the Churn as a label and predict on it:\n","f2813754":"Lets redo the whole preprocessing once again for my satisfaction:","6c7c35dc":"Defining the new list of categorical features since we dropped a couple of features:","0ac12b74":"Reading the data:\n","884aa550":"Thank you for going through this notebook! I hope this helped you.","c4129f6b":"Lets train a neural network on the scaled data:","5f23eb13":"No missing values! :D","8efdc502":"Label encoding the data:","3b171608":"How many senior citizens are there though compared to the non senior citizens?","2a43c18a":"Let's visualize it a little bit now, checking for the proportion of males and females:","a9a0d6a2":"Here's the little code to make a list of all categorical columns:","f39b7c0d":"Splitting the data into training and test sets now:","d8e9c1d2":"Lets predict on the data using Decision Tree Classifier","5eada120":"Lets predict on the data using Random Forest Classifier:","4fd9308f":"We can see from the data above that there is little correlation with the elements and with the naked eye, we wouldn't be able to conclude anything in my perspective. (feel free to correct me)","321ac902":"Since I am trying to find the correlation between the features in this dataset I will have to convert the categorical values into numerical values using the LabelEncoder.","70048eaa":"Finally plotting the HeatMap:","bf3b4a4f":"Way more non-senior citizens than senior citizens here.\n","dbb77d4c":"Defining a Neural Network for binary classification now:","b7d1216c":"Lets check the data for any missing values because the plotting tools such as seaborn and matplotlib don't exactly like it when you have even a single one(i.e it gives an error).","18d6ff13":"Now its time to use Standard Scaler:"}}