{"cell_type":{"615b6ff3":"code","e7770876":"code","38f3b6ff":"code","27397296":"code","c2e1a0ec":"code","cd894ec4":"code","88e9a20a":"code","00ced7c5":"code","cc4750da":"code","f39e2ea8":"code","f9614726":"code","d4965df6":"code","387b520f":"code","884a2253":"code","91d4a38e":"code","37f310f0":"code","4c1da580":"code","a5634df9":"code","3d1bbf35":"code","e67ac206":"code","642be97b":"code","c7a7ec4c":"code","c4112345":"code","dc643bea":"code","9c4b3309":"code","fc890f33":"code","809c1f18":"code","0922f8ec":"code","4ecab4c6":"code","1f9dcb71":"code","5ad788b8":"code","7dee1060":"code","38421ef1":"code","b358b046":"code","523a1854":"code","5addd209":"code","b208a242":"code","69e50166":"code","7e6aea2a":"code","5eff9da0":"code","182cfb71":"code","b8bc633c":"markdown","b22a8784":"markdown","9469ac9d":"markdown","8de36a87":"markdown","df796578":"markdown","6f081006":"markdown","2d3e46df":"markdown","37643c99":"markdown","9c489474":"markdown","7abf6c24":"markdown","ec6ae673":"markdown","fbc70238":"markdown","c20130db":"markdown","bce1160a":"markdown","44197887":"markdown","e048062e":"markdown","979bcb42":"markdown","f6f8916f":"markdown","bf869a29":"markdown","1b78a521":"markdown","9193e286":"markdown","cbd016d2":"markdown","d2fb69c2":"markdown","978262d8":"markdown","458abc71":"markdown","d8c0a70f":"markdown","de6f5939":"markdown","dafd88e9":"markdown","64938a39":"markdown","6a906c5e":"markdown","7895ae0d":"markdown","c8094b5b":"markdown","bac5ad01":"markdown","39474060":"markdown","671c8774":"markdown","fd32dcc9":"markdown","67cff347":"markdown","df0c0b78":"markdown","e6283c7c":"markdown"},"source":{"615b6ff3":"import matplotlib.pyplot as plt\nimport missingno as msno\nimport numpy as np\nimport pandas as pd\nimport scipy.cluster.hierarchy as sch\nimport seaborn as sns\nimport warnings\n\nfrom PIL import Image\nfrom scipy.cluster.hierarchy import cophenet\nfrom scipy.cluster.hierarchy import linkage,dendrogram,cut_tree\nfrom scipy.spatial.distance import pdist\nfrom sklearn.cluster import DBSCAN\nfrom sklearn.cluster import KMeans\nfrom sklearn.decomposition import PCA\nfrom sklearn.metrics import silhouette_samples, silhouette_score\nfrom sklearn.preprocessing import MinMaxScaler\nfrom yellowbrick.cluster import KElbowVisualizer\nfrom sklearn.cluster import DBSCAN","e7770876":"data = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\ndata.head()","38f3b6ff":"data.info()","27397296":"data = data.drop('CustomerID', axis=1)","c2e1a0ec":"data.shape","cd894ec4":"data.head()","88e9a20a":"data.describe()","00ced7c5":"msno.bar(data, color='blue')\nplt.show()","cc4750da":"print('Data columns with null values:',data.isnull().sum(), sep = '\\n')","f39e2ea8":"for x in data.select_dtypes(np.number).columns:\n    sns.boxplot(x=data[x], color='blue')\n    plt.show()","f9614726":"plt.rcParams['figure.figsize'] = (10, 8)\nsns.heatmap(data.corr(),annot=True,fmt='.1g',cmap='Blues')\n\nplt.rcParams['figure.figsize'] = (10, 8)\nsns.pairplot(data, aspect=1.5)","d4965df6":"plt.rcParams['figure.figsize'] = (10, 8)\nsns.pairplot(data, hue='Gender', aspect=1.5)","387b520f":"values = data['Gender'].value_counts()\nlabels = ['Female', 'Male']\n\nfig, ax = plt.subplots(figsize = (10, 8), dpi = 100)\nexplode = (0, 0.06)\n\npatches, texts, autotexts = ax.pie(values, labels = labels, autopct = '%1.2f%%', shadow = True,\n                                   startangle = 90, explode = explode)\n\nplt.setp(texts, size = 19, color = 'black')\n\nplt.setp(autotexts, size = 19, color = 'white')\nautotexts[1].set_color('white')\nplt.show()","884a2253":"data[\"Gender\"].value_counts()","91d4a38e":"ax = sns.boxplot(x=\"Gender\", y=\"Spending Score (1-100)\", data=data)\nplt.title(\"Spending Score by gender\", size = 19)","37f310f0":"pd.pivot_table(data=data, columns = \"Gender\", values = [\"Annual Income (k$)\", \"Spending Score (1-100)\"],\n               aggfunc = np.mean)","4c1da580":"ax = sns.boxplot(x=\"Gender\", y=\"Annual Income (k$)\", data=data)\nplt.title(\"Annual Income by gender\", size = 19)","a5634df9":"pd.pivot_table(data=data, columns = \"Gender\", values = [\"Annual Income (k$)\", \"Spending Score (1-100)\"],\n               aggfunc = np.std)","3d1bbf35":"plt.figure(figsize=(10,8))\nsns.scatterplot(x = data[\"Age\"], y = data[\"Spending Score (1-100)\"], hue = data[\"Gender\"])\nplt.title(\"Spending points by gender\", size = 19)","e67ac206":"plt.figure(figsize=(10,8))\nsns.scatterplot(data=data, x=\"Annual Income (k$)\", y=\"Spending Score (1-100)\", hue=\"Gender\")\nplt.title(\"Annual Income and Expenditure Scores by Gender\", size = 19)","642be97b":"A_1 = data.loc[data[\"Age\"] < 36]\nA_2 = data.loc[data[\"Age\"] > 35]\n\nA_1[\"Age_\"] = \"Young\"\nA_2[\"Age_\"] = \"Old\"\n\ndata_2 = pd.concat([A_1, A_2], axis = 0)\ndata_2[\"Age_\"].value_counts()\n\nplt.figure(figsize=(10,8))\nsns.scatterplot(x = data_2[\"Annual Income (k$)\"], y = data_2[\"Spending Score (1-100)\"], hue = data_2[\"Age_\"])\nplt.title(\"Annual Income and Spending Score for Young Customers Under 35 and Older Customers Over 35\", size = 19)","c7a7ec4c":"Y_1 = data.loc[data[\"Age\"] < 20]\nY_2 = data.loc[data[\"Age\"] > 19]\nY_3 = data.loc[data[\"Age\"] > 29]\nY_4 = data.loc[data[\"Age\"] > 39]\nY_5 = data.loc[data[\"Age\"] > 49]\nY_6 = data.loc[data[\"Age\"] > 59]\n\nY_1[\"Age_\"] = \"10Y\"\nY_2[\"Age_\"] = \"20Y\"\nY_3[\"Age_\"] = \"30Y\"\nY_4[\"Age_\"] = \"40Y\"\nY_5[\"Age_\"] = \"50Y\"\nY_6[\"Age_\"] = \"60Y\"\n\ndata_3 = pd.concat([Y_1, Y_2, Y_3, Y_4, Y_5, Y_6], axis = 0)\ndata_3[\"Age_\"].value_counts()\n\nplt.figure(figsize=(10,8))\nsns.scatterplot(x = data_3[\"Annual Income (k$)\"], y = data_3[\"Spending Score (1-100)\"], hue = data_3[\"Age_\"])\nplt.title(\"Spending Score and income scores by age\", size = 19)","c4112345":"data_3 = pd.concat([Y_1], axis = 0)\ndata_3[\"Age_\"].value_counts()\n\nplt.figure(figsize=(10,8))\nsns.scatterplot(x = data_3[\"Annual Income (k$)\"], y = data_3[\"Spending Score (1-100)\"], hue = data_3[\"Gender\"])\nplt.title (\"Annual Income and Spending Score for Teenagers\", Size = 19)\n\ndata_3 = pd.concat([Y_2], axis = 0)\ndata_3[\"Age_\"].value_counts()\n\nplt.figure(figsize=(10,8))\nsns.scatterplot(x = data_3[\"Annual Income (k$)\"], y = data_3[\"Spending Score (1-100)\"], hue = data_3[\"Gender\"])\nplt.title (\"Annual Income and Spending Score for Twenties\", Size = 19)\n\ndata_3 = pd.concat([Y_3], axis = 0)\ndata_3[\"Age_\"].value_counts()\n\nplt.figure(figsize=(10,8))\nsns.scatterplot(x = data_3[\"Annual Income (k$)\"], y = data_3[\"Spending Score (1-100)\"], hue = data_3[\"Gender\"])\nplt.title (\"Annual Income and Spending Score for Thirties\", Size = 19)\n\ndata_3 = pd.concat([Y_4], axis = 0)\ndata_3[\"Age_\"].value_counts()\n\nplt.figure(figsize=(10,8))\nsns.scatterplot(x = data_3[\"Annual Income (k$)\"], y = data_3[\"Spending Score (1-100)\"], hue =data_3[\"Gender\"])\nplt.title (\"Annual Income and Spending Score for Forties\", Size = 19)\n\ndata_3 = pd.concat([Y_5], axis = 0)\ndata_3[\"Age_\"].value_counts()\n\nplt.figure(figsize=(10,8))\nsns.scatterplot(x = data_3[\"Annual Income (k$)\"], y = data_3[\"Spending Score (1-100)\"], hue =data_3[\"Gender\"])\nplt.title (\"Annual Income and Spending Score for Fifties\", Size = 19)\n\ndata_3 = pd.concat([Y_6], axis = 0)\ndata_3[\"Age_\"].value_counts()\n\nplt.figure(figsize=(10,8))\nsns.scatterplot(x = data_3[\"Annual Income (k$)\"], y = data_3[\"Spending Score (1-100)\"], hue =data_3[\"Gender\"])\nplt.title (\"Annual Income and Spending Score for Sixties\", Size = 19)","dc643bea":"df = data.copy()\ndf_num = data.select_dtypes(np.number) \nscaler = MinMaxScaler()\nscaled_data = scaler.fit_transform(df_num)\nscaled_data = pd.DataFrame(scaled_data, columns= df_num.columns)\nscaled_data","9c4b3309":"df['Gender'] = df['Gender'].astype('category').cat.codes\nprocessed_df = pd.concat([scaled_data, df['Gender']], axis=1) \nprocessed_df","fc890f33":"sns.pairplot(processed_df, hue='Gender', aspect=1.5)","809c1f18":"coph=dict()\nfor method in ['ward','average','complete','single']:\n    mergings=linkage(processed_df,method=method)\n    c,d=cophenet(mergings,pdist(processed_df))\n    coph[method]=c\nprint(coph)\n\nprint('\\nOptimal Linkage Method:',max(coph))","0922f8ec":"fig = plt.figure(figsize=(25, 10))\ndendrogram=sch.dendrogram(sch.linkage(processed_df,method='ward'))\nplt.title(\"Dendrogram\")\nplt.xlabel(\"Customers\")\nplt.ylabel(\"Eucledian distance\")\nplt.show()","4ecab4c6":"X = processed_df[['Annual Income (k$)','Spending Score (1-100)']]\ndist_points_from_centroids = []\nslscore = []\nk = range(2,10)\nfor clusters in k:\n    model = KMeans(n_clusters=clusters, max_iter=1000, random_state=10).fit(X)\n    dist_points_from_centroids.append(model.inertia_)\n    slscore.append(silhouette_score(X,model.labels_))\nplt.xlabel(\"K\")\nplt.axvline(5,c='red')\nplt.ylabel(\"inertia\")\nplt.title(\"Elbow Method\")\nplt.plot(k,dist_points_from_centroids)","1f9dcb71":"plt.axvline(5,c='red')\nplt.xlabel(\"K\")\nplt.ylabel(\"score\")\nplt.title(\"Silhouette score\")\nplt.plot(k, slscore)","5ad788b8":"km=KMeans(n_clusters=5)","7dee1060":"km.fit(processed_df)","38421ef1":"cluster_centers=km.cluster_centers_\ncluster_centers","b358b046":"clusters=km.predict(processed_df)\nclusters","523a1854":"pca=PCA(n_components=4)\npca_data=pca.fit_transform(processed_df)","5addd209":"pca_data","b208a242":"pca_data.shape, data.shape, clusters.shape","69e50166":"pca_df=pd.DataFrame(pca_data, columns=['PC1', 'PC2', 'PC3', 'PC4'])\npca_df.head()","7e6aea2a":"pca_df['clusters']=clusters\npca_df.head()","5eff9da0":"pca_df['clusters'].value_counts()","182cfb71":"sns.scatterplot(pca_df.loc[pca_df['clusters']==0, 'PC1'], pca_df.loc[pca_df['clusters']==0, 'PC2'],color='pink')\nsns.scatterplot(pca_df.loc[pca_df['clusters']==1, 'PC1'], pca_df.loc[pca_df['clusters']==1, 'PC2'],color='red')\nsns.scatterplot(pca_df.loc[pca_df['clusters']==2, 'PC1'], pca_df.loc[pca_df['clusters']==2, 'PC2'],color='orange')\nsns.scatterplot(pca_df.loc[pca_df['clusters']==3, 'PC1'], pca_df.loc[pca_df['clusters']==3, 'PC2'],color='blue')\nsns.scatterplot(pca_df.loc[pca_df['clusters']==4, 'PC1'], pca_df.loc[pca_df['clusters']==4, 'PC2'],color='black')\n\nplt.legend(loc='best', bbox_to_anchor=(1.5, 1.5))\nplt.show()","b8bc633c":"#### 4.4 Silhouette method","b22a8784":"#### 4.1 Scaling","9469ac9d":"# Table of Content\n\n1. Header Files\n\n2. About Data Set\n\n3. Exploratory Data Analysis\n    \n    * 3.1 - Read Data\n    * 3.2 Variable Description\n    * 3.2 - Analysing Missing Values\n    * 3.3 - Analysing Outliers\n    * 3.4 - Analysing the data set\n    * 3.5 - Scaling\n    * 3.6 - Encoding\n    * Determining Optimal Linkage Method\n    \n4. Data preprocessing\n\n5. Modelling","8de36a87":"1. Customer ID - numerical - unique customer number, integer\n\n2. Gender - categorical - binary (Male\/Female)\n\n3. Age - numerical - integer\n\n4. Annual Income (k$) - numerical - integer\n\n5. Spending Score (1-100) - numerical - integer","df796578":"# 4. Data preprocessing","6f081006":"1. Younger customers under the age of 35 have higher spending scores.\n\n2. Older customers had lower spending scores.","2d3e46df":"My analysis results\n1. There are two groups with incomes between 80 and 140. Customers in the 0-40 range have a low spend score, and customers 60-100 have a high spend score.\n\n2. There are two groups with income between 0 and 40. Customers in the 0-40 range have a low spend score, and customers 60-100 have a high spend score.\n\n3. High annual income does not necessarily mean high expenditure score.","37643c99":"#### 3.8 Standard Deviation","9c489474":"#### 3.4 Missing cells","7abf6c24":"It can be seen that the proportion of **women is 12% higher** than that of men.","ec6ae673":"It can be seen that male customers have a higher income, but female customers have higher Spending Score.","fbc70238":"#### 4.3 Elbow method","c20130db":"High time complexity - Determining the optimal number of clusters using a dendrogram is confusing.","bce1160a":"1. It can be seen that the Spending Score of people in their 20s and 30s is high.\n\n2. All age groups have an annual income of 40-60k$ and a Spending Score of 40-60.","44197887":"# 2. About Data Set\n\nCustomer ID - Unique identification of customer\n\nGender - Sex of the customer\n\nAge - Age of customer\n\nAnnual Income - Income of salary in 1000's unit Dollars\n\nSpending Score - Readiness of customer to spend money","e048062e":"# 1. Header Files","979bcb42":"Cluster 5 received the highest score. This means that n_clusters = 5 is the right choice.","f6f8916f":"#### 3.9 Scatter plot","bf869a29":"![](http:\/\/icdn.2cda.pl\/g\/157025_75710482662543650778.gif)","1b78a521":"#### 3.1 Read the data","9193e286":"Looking at the graph, you can see that there is an even distribution of females and males overall. This is difficult to classify specifically by gender.","cbd016d2":"Convert Gender column to number and join","d2fb69c2":"My analysis results\n1. Age does not correlate well with Spending Score, showing that spending is independent of age.\n\n2. Age and annual income have a negative correlation. However, you may notice that age does not determine income.\n\n3. Annual income and Spending Score are positively correlated. It doesn't matter because there is no monolinear relationship!","978262d8":"1. 10's Features : \n\n        Customers with an annual income of 40-60k$ will have a Spending Score of 40-60.\n\n\n1. 20's Features :\n\n        Divided into 5 clusters.\n\n        Customers with an annual income of 40-60k$ will have a Spending Score of 40-60.\n                     \n\n1. 30's Features : \n\n        Divided into 5 clusters.\n\n        There are fewer clusters with low income and high consumption than other clusters.\n\n        Customers with an annual income of 40-60k$ will have a Spending Score of 40-60.\n                     \n\n1. 40's Features : \n\n        Divided into 3 clusters.\n\n        Spending Score are concentrated at 40-60.\n\n        Regardless of their income, they usually have a low Spending Score.\n\n        Customers with an annual income of 40-60k$ will have a Spending Score of 40-60.\n\n\n1. 50's Features :\n\n        Divided into 3 clusters.\n\n        Regardless of their income, they usually have a low Spending Score.\n\n        Customers with an annual income of 40-60k$ will have a Spending Score of 40-60.\n\n\n1. 60's Features :\n\n        Divided into 2 clusters.\n\n        Customers with an annual income of 40-60k$ will have a Spending Score of 40-60.\n        \n        \n        \n\nConclusions :\n\n\n        1. Customers in their 20s and over 35 years of age with a high consumption score are the main target of the market. \n\n        2. Customers over 50 show a moderate consumption pattern.","458abc71":"Let's take a look at each age group this time.","d8c0a70f":"Distinctive point\n1. **Customers over 40 years old do spending score not exceed 60 points!**\n\n2. Few customers under the age of 30 have a spending score score of 40 or less.\n\n3. Younger customers under the age of 30 can infer a higher spending score!","de6f5939":"The purpose of customer segmentation data is to divide customers into groups based on common characteristics so that each group can be marketed effectively and appropriately through customer segmentation.\nAll customers share a common need for a product or service, but they have behavioral differences due to age, gender, socioeconomic, lifestyle and other factors.","dafd88e9":"#### 3.2 Variable Description","64938a39":"#### 3.5 Analysing Outliers","6a906c5e":"#### 3.3 Data summary","7895ae0d":"# 5. Modelling","c8094b5b":"#### 3.7 PI chart","bac5ad01":"The standard deviation of annual income is 26, but it can be seen that the range of women's Spending Score is wide.","39474060":"#### 4.2 Dendrogram","671c8774":"In the elbow method you can see that there are 5 clusters.","fd32dcc9":"#### 3.6 Histogram, Pairplot ","67cff347":"#### 4.5 PCA","df0c0b78":"# 3. Data Preperation","e6283c7c":"Looking at the numbers and graphs, there are **no missing values!**"}}