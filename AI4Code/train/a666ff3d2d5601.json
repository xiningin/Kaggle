{"cell_type":{"1895f8d3":"code","352eaad5":"code","b6f3ce27":"code","9223c2dc":"code","19e3cee7":"code","f36e3caf":"markdown","70c64937":"markdown","5c672004":"markdown","b6571fc3":"markdown","52f00ea5":"markdown","e36d4f2c":"markdown","2652361b":"markdown","9860a879":"markdown"},"source":{"1895f8d3":"import numpy as np\nimport pandas as pd\nfrom tensorflow import keras","352eaad5":"model = keras.models.Sequential()\nmodel.add(keras.applications.Xception(input_shape=(300, 300, 3), weights=None, include_top=False))\nmodel.add(keras.layers.GlobalAveragePooling2D())\nmodel.add(keras.layers.Dense(5, activation='softmax'))\nmodel.summary()","b6f3ce27":"model.load_weights(\"..\/input\/cassava-xception-try\/best_weights_xception.h5\")","9223c2dc":"preds = []\nss = pd.read_csv('..\/input\/cassava-leaf-disease-classification\/sample_submission.csv')\n\nfor image in ss.image_id:\n    img = keras.preprocessing.image.load_img('..\/input\/cassava-leaf-disease-classification\/test_images\/' + image)\n    img = keras.preprocessing.image.img_to_array(img)\n    img = keras.preprocessing.image.smart_resize(img, (300, 300))\n    img = np.expand_dims(img, 0)\n    prediction = model.predict(img)\n    preds.append(np.argmax(prediction))\n\nmy_submission = pd.DataFrame({'image_id': ss.image_id, 'label': preds})\nmy_submission.to_csv('submission.csv', index=False) ","19e3cee7":"my_submission","f36e3caf":"# Preparing our Deep Learning model\n\nSince we already have our pretrained weights we will be passing **weights=None** for our **Xception** model and then later load our weights and assign to the model.\n\n**Remember**: We have to do this because the notebook rules are that the internet connection must be off but transfer learning techniques require internet connection to load the model weights in real time.","70c64937":"# Visualizing our submission file","5c672004":"**Outcomes from this notebook:**\n\n1. Understanding how you can use pretrained weights from a base model and use it to implement solutions faster.\n2. Understanding the hacks to develop a inference notebook.","b6571fc3":"# Loading our best weights","52f00ea5":"<h1><center><b> Cassava prediction notebook <\/b><\/center><\/h1>","e36d4f2c":"# Importing the necessary libraries","2652361b":"# Predicting on test dataset","9860a879":"This notebook contains the prediction part using the weights obtained from the baseline notebook.\n\nPlease go through the baseline notebook to understand how the best weights are obtained.\n\n**Link for baseline notebook:** https:\/\/www.kaggle.com\/pndeepak\/cassava-xception-baseline\n\nPS : This notebook does not require GPU to run."}}