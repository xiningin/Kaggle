{"cell_type":{"4fe27937":"code","d572d0a1":"code","eb588f89":"code","6561ce69":"code","5243c6e7":"code","cc1f82a4":"code","18bb0efb":"code","f02f78a1":"code","5ae8677d":"code","06cd6e11":"code","cb8e0ec3":"code","27bed671":"code","32de7c06":"code","3d8b52c1":"code","bfca68d8":"code","5e2425ba":"code","1ec6917e":"code","46b3ee14":"code","59f5506e":"code","4c8a0e95":"code","18ca94b9":"markdown","3c2a3d73":"markdown","afe3b5fe":"markdown","f13d2252":"markdown","17356b77":"markdown","f155c0cb":"markdown","020e337a":"markdown","639b5e5a":"markdown","c39bcc09":"markdown","3e91dd10":"markdown","1f2f514b":"markdown","dc31a987":"markdown","31a49a91":"markdown","a2bba827":"markdown","ab74f6f6":"markdown","fcb1e70b":"markdown","5ad5156b":"markdown","b24f246b":"markdown","de13ad36":"markdown","b2bb1148":"markdown","bc6d30ae":"markdown","c17406dc":"markdown"},"source":{"4fe27937":"#Importing basic libraries.\nimport matplotlib.gridspec as gridspec\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\nimport plotly.express as px\nimport statsmodels.api as sm\nimport seaborn as sns\nimport os\nimport time\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\n#Pandas setting for better visualization of dataframe.\npd.options.display.float_format='{:.2f}'.format\npd.set_option('display.max_columns', 500)\npd.set_option('display.max_colwidth', -1) ","d572d0a1":"dataset = pd.read_csv('..\/input\/easy-peasy-its-lemon-squeezy\/data.csv', parse_dates=['DateTimeOfAccident', 'DateReported'])\ndataset","eb588f89":"dataset.info()","6561ce69":"null = int(dataset['MaritalStatus'].isnull().sum())\nsize = int(len(dataset))\nprint('Missing Data is : {} or {:.2f}%'.format(null, null\/size*100))","5243c6e7":"dataset.select_dtypes(include=object).nunique()","cc1f82a4":"dataset_ = dataset.select_dtypes(include='object')\nfor col in dataset_.columns:\n    print('{}\\n'.format(col) + 'unique count : ' + '{}'.format(dataset[col].nunique()))\n    print(dataset[col].unique())\n    print('')","18bb0efb":"dataset.select_dtypes(exclude=object).describe()","f02f78a1":"dataset = dataset.dropna()\ndataset","5ae8677d":"dataset = dataset.drop('ClaimNumber', axis=1)\ndataset","06cd6e11":"dataset['ReportLeadTime'] = dataset['DateReported'] - dataset['DateTimeOfAccident']\ndataset['ReportLeadTime'] = dataset['ReportLeadTime'].dt.days\ndataset = dataset.drop(['DateTimeOfAccident', 'DateReported'], axis=1)\ndataset\n","cb8e0ec3":"dataset['PercentageFromInitial'] = dataset['UltimateIncurredClaimCost'] \/ dataset['InitialIncurredClaimsCost'] * 100\ndataset = dataset.drop(['InitialIncurredClaimsCost', 'UltimateIncurredClaimCost'], axis=1)\ndataset","27bed671":"fig = plt.figure(figsize=(28, 7), constrained_layout=False)\ngs = gridspec.GridSpec(1, 3, figure=fig)\nplt.suptitle('Count of Categorical Data\\n')\n\nax_1 = fig.add_subplot(gs[0, 0])\nsns.countplot(data=dataset, x='Gender', ax=ax_1)\nplt.title('Count of Gender')\n\n\nax_2 = fig.add_subplot(gs[0, 1])\nsns.countplot(data=dataset, x='MaritalStatus', ax=ax_2)\nplt.title('Count of MaritalStatus')\n\n\nax_3 = fig.add_subplot(gs[0, 2])\nsns.countplot(data=dataset, x='PartTimeFullTime', ax=ax_3)\nplt.title('Count of PartTimeFullTime')","32de7c06":"dataset.loc[dataset['Gender'] == 'U']","3d8b52c1":"dataset = dataset[dataset['Gender'] != 'U']\ndataset","bfca68d8":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\ndataset['Gender']=le.fit_transform(dataset['Gender'])\ndataset['MaritalStatus']=le.fit_transform(dataset['MaritalStatus'])\ndataset['PartTimeFullTime']=le.fit_transform(dataset['PartTimeFullTime'])\ndataset","5e2425ba":"x = dataset.iloc[:, 1:-1].values\ny = dataset.iloc[:,-1].values","1ec6917e":"from sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(x,y, test_size=0.2,random_state=27)","46b3ee14":"from sklearn.ensemble import RandomForestRegressor\nregressor = RandomForestRegressor(n_estimators = 150, random_state = 0)\nregressor.fit(x_train, y_train)","59f5506e":"y_pred = regressor.predict(x_test)\nnp.set_printoptions(precision=1)\nprint(np.concatenate((y_pred.reshape(len(y_pred),1), y_test.reshape(len(y_test),1)),1))","4c8a0e95":"from sklearn.metrics import r2_score\nr2_score(y_test, y_pred)","18ca94b9":"The `ClaimNumber` is dropped. It doesn't give us any neccessary information.","3c2a3d73":"### 2.1 Importing the Dataset","afe3b5fe":"<p style=\"background-color:#38006b;font-family:meiryo;color:#f3e5f5;font-size:180%;text-align:center;border-radius:40px 40px;\">2. THE DATASET<\/p>","f13d2252":"The information from above chart are :\n* The insurance policies bearer are mostly Men.\n* The insurance policies bearer are mostly Single.\n* The insurance policies bearer are mostly works Full Time.","17356b77":"The dataset have 24 features with 1 dependant variable. Parsing on `DateTimeofAccident` and `DateReported` done simultaneously. We can see some null data in the `MaritalStatus`. The non-null value is not same like other features. We will check it in later stage. The intuition of this dataset are :\n* Dropping `ClaimNumber` because it is just an index.\n* `DateTimeOfAccident` and `DateReported` can be used to make new feature called `ReportLeadTime` which contain information about how many days the reporting happened since the accident. After `ReportLeadTime` constructed, we will drop `DateTimeOfAccident` and `DateReported`.\n* Encoding the `Gender`, `MaritalStatus`, and `PartTimeFullTime`.\n* It is tempting to combine `DependentChildren` and `DependentsOther` into 1 feature called `Family`. In my understanding, there are differnece in benefit calculation on children and other family in insurance. Therefore, this time, We don't combine them.\n* I think it is better to set `PercentageFromInitial` as target variable. It is calculated to see how much the policies bearer get compared to the initial claim calculation.","f155c0cb":"<p style=\"background-color:#38006b;font-family:meiryo;color:#f3e5f5;font-size:180%;text-align:center;border-radius:40px 40px;\">THE NOTEBOOK<\/p>\n\n<p style=\"font-family:meiryo;font-size:120%;color:#38006b;text-align:justify\">I will use this notebook to try to predict how much the insurance company must pay for the employee claims in a company. From the dataset description,there are 54,000 insurance policies that can be used to train the model and do prediction.<\/p>\n\n<a id='top'><\/a>\n<p style=\"font-family:meiryo;font-size:120%;color:#38006b;text-align:left\">The feature of this dataset are :<\/p>\n\n* ClaimNumber: Unique policy identifier\n* DateTimeOfAccident: Date and time of accident\n* DateReported: Date that accident was reported\n* Age: Age of worker\n* Gender: Gender of worker\n* MaritalStatus: Martial status of worker. (M)arried, (S)ingle, (U)nknown.\n* DependentChildren: The number of dependent children\n* DependentsOther: The number of dependants excluding children\n* WeeklyWages: Total weekly wage\n* PartTimeFullTime: Binary (P) or (F)\n* HoursWorkedPerWeek: Total hours worked per week\n* DaysWorkedPerWeek: Number of days worked per week\n* ClaimDescription: 12 continuous variables pointing out to useful keywords\n* InitialIncurredClaimCost: Initial estimate by the insurer of the claim cost\n \n<p style=\"font-family:meiryo;font-size:120%;color:#38006b;text-align:left\">The target column is UltimateIncurredClaimCost which means total claims payments by the insurance company. <\/p>","020e337a":"<p style=\"background-color:#38006b;font-family:meiryo;color:#f3e5f5;font-size:180%;text-align:center;border-radius:40px 40px;\">3. EXPLORATORY DATA ANALYSIS (EDA)<\/p>","639b5e5a":"Now that our dataset is clean. We're ready for some EDA!","c39bcc09":"### 2.2 Dataset Overview","3e91dd10":"We did the calculation to get a new feature `ReportLeadTime`.","1f2f514b":"### 3.1 Categorical Data Analysis","dc31a987":"Let's pay no attention on `ClaimNumber`, `DateTimeOfAccident` and `DateReported` for now. There are only 3 unique values of `Gender`, 3 unique values of `MaritalStatus` and 2 unique values of `PartTimeFullTime`.","31a49a91":"### 2.3 Dataset Cleaning","a2bba827":"We dropped the data with unknown gender.","ab74f6f6":"#### 2.3.3 Making ReportLeadTime Feature","fcb1e70b":"We can see that someone does have 9 children. Awesome!","5ad5156b":"29 data is removed due to null value in `MaritalStatus`.","b24f246b":"<p style=\"background-color:#38006b;font-family:meiryo;color:#f3e5f5;font-size:180%;text-align:center;border-radius:40px 40px;\">1. IMPORTING LIBRARIES<\/p>","de13ad36":"#### 2.3.4 Making PercentageFromInitial Dependant Variable","b2bb1148":"#### 2.3.2 Dropping Index","bc6d30ae":"#### 2.3.1 Dropping Null Values","c17406dc":"There are only 29 or 0.05% of missing data. We can remove the null data from the dataset."}}