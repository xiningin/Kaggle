{"cell_type":{"e13c0654":"code","8b602558":"code","373d8cba":"code","7680de7e":"code","73e0841b":"code","2dcb7341":"code","452468d2":"code","24fb8078":"code","99cb64fc":"code","f85ad53b":"code","03ccd64e":"code","e9671a4f":"code","d2a5a7d8":"code","fc5a9d86":"code","63f76f76":"code","ae78933a":"code","e6da7926":"code","079aad7e":"code","f1991afe":"code","facfdeb7":"code","45e1750e":"code","eeeaea55":"code","d6844d48":"code","cf0e6cfa":"code","0208f77c":"code","a054e436":"code","97e6fd42":"markdown","f9b5df03":"markdown","f1405f08":"markdown","32f35069":"markdown","ed6dfca3":"markdown","5c106152":"markdown","4e70ca4d":"markdown","91123c6b":"markdown","c708794d":"markdown","5be6ef83":"markdown","f3ad107b":"markdown","8b1a2ab1":"markdown","d546ae3d":"markdown","0fe73f28":"markdown","f732ba4f":"markdown","ae162922":"markdown","421b8e75":"markdown","7661241b":"markdown","d508879a":"markdown","394716bc":"markdown","66bcb61b":"markdown","8ae5896f":"markdown","20406d20":"markdown","b8df1819":"markdown"},"source":{"e13c0654":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","8b602558":"import matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sns\n%matplotlib inline\nimport missingno as msno","373d8cba":"data = pd.read_csv('\/kaggle\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv')","7680de7e":"data.head()","73e0841b":"data.info()","2dcb7341":"data.isna().sum()","452468d2":"#looking for missing values\nmsno.matrix(data)","24fb8078":"plt.figure(figsize=(7,5))\nsns.countplot(x=data['quality'],palette='muted')","99cb64fc":"data.corr()['quality'].sort_values(ascending=False)","f85ad53b":"plt.figure(figsize=(8,6))\nsns.heatmap(data.corr(),cmap='Blues',linewidth=1,linecolor='Black')","03ccd64e":"plt.figure(figsize=(12,4))\nplt.subplot(1,2,1)\nsns.barplot(x = 'quality', y = 'fixed acidity', data = data,palette='pastel')\nplt.subplot(1,2,2)\nsns.barplot(x = 'quality', y = 'alcohol', data = data,palette='pastel')\nplt.tight_layout()\n","e9671a4f":"data['quality']=[1 if i >6.5 else 0 for i in data['quality']]\ndata['quality'].value_counts()","d2a5a7d8":"sns.histplot(data['alcohol'],palette='dark')","fc5a9d86":"plt.figure(figsize=(12,8))\nplt.subplot(2,2,1)\nsns.boxplot(x=data['alcohol'])\nplt.subplot(2,2,2)\nsns.boxplot(x=data['sulphates'])\nplt.subplot(2,2,3)\nsns.boxplot(x=data['citric acid'])\nplt.subplot(2,2,4)\nsns.boxplot(x=data['fixed acidity'])","63f76f76":"plt.figure(figsize=(12,8))\nplt.subplot(2,2,1)\nsns.boxplot(x=data['volatile acidity'])\nplt.subplot(2,2,2)\nsns.boxplot(x=data['total sulfur dioxide'])\nplt.subplot(2,2,3)\nsns.boxplot(x=data['density'])\nplt.subplot(2,2,4)\nsns.boxplot(x=data['chlorides'])","ae78933a":"data['zscore']=((data['citric acid']-data['citric acid'].mean())\/data['citric acid'].std())\nfilt=np.abs(data['zscore'])<3\ndata=data[filt]","e6da7926":"data['zscore2']=((data['alcohol']-data['alcohol'].mean())\/data['alcohol'].std())\nfilt=np.abs(data['zscore2'])<3\ndata=data[filt]\ndata['zscore3']=((data['total sulfur dioxide']-data['total sulfur dioxide'].mean())\/data['total sulfur dioxide'].std())\nfilt=np.abs(data['zscore3'])<3\ndata=data[filt]","079aad7e":"X=data.drop(['quality','zscore','zscore2','free sulfur dioxide','zscore3'],axis=1)\ny=data['quality']","f1991afe":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test =train_test_split(X,y,test_size=0.20,random_state=42)","facfdeb7":"# scaling the data\nfrom sklearn.preprocessing import StandardScaler\nscaling=StandardScaler()\nx_train=scaling.fit_transform(X_train)\nx_test=scaling.fit_transform(X_test)","45e1750e":"from sklearn.linear_model import LogisticRegression\nfrom sklearn import tree\nfrom sklearn.svm import SVC\nfrom sklearn.neighbors import KNeighborsClassifier\n","eeeaea55":"model=LogisticRegression()\nmodel.fit(x_train,y_train)\nmodel.score(x_test,y_test)","d6844d48":"model=tree.DecisionTreeClassifier()\nmodel.fit(x_train,y_train)\nmodel.score(x_test,y_test)","cf0e6cfa":"model=SVC()\nmodel.fit(x_train,y_train)\nmodel.score(x_test,y_test)","0208f77c":"for i in range(1,40):\n    model=KNeighborsClassifier( n_neighbors=i,metric='manhattan')\n    model.fit(x_train,y_train)\n    print(i+model.score(x_test,y_test))","a054e436":"model=KNeighborsClassifier( n_neighbors=8,metric='manhattan')\nmodel.fit(x_train,y_train)\nmodel.score(x_test,y_test)","97e6fd42":"most of our wine seems average with less than 50 wines which are high quality","f9b5df03":"1.  No clear insight how acidity affects quality\n2. Alcohol content increases , quality of wine bumps","f1405f08":"![image.png](attachment:adbb3c35-d24d-45f9-aa13-015f9fd3f273.png)![image.png](attachment:f442d888-c029-4a74-8616-4a530ee13528.png)","32f35069":"* # Z -score\n1. In simple terms, Z score is the number of standard deviations an observation is away from the mean.\n2. Formula = (observation-mean)\/std\n3. Removing outliers from citric acid","ed6dfca3":"# Total sulfur dioxide has some values very far .","5c106152":"#  Model ","4e70ca4d":"Turns out k=8 is optimal.","91123c6b":"# Logistic Regression","c708794d":"Using the **missingno** library, we can visualise this . BAM! All black as we have 0 missing values","5be6ef83":"Great! All of our columns are float64 so no conversion needed","f3ad107b":"# Transforming target variable\n1. Any wine with quality>6.5 is classified as good\n2. Other classifed as bad","8b1a2ab1":"1. Scaling data is important in an algorithm like KNN.","d546ae3d":"* residual sugar correlation is almost zero so i might drop it.\n* Alcohol has high correlation so it might have a big effect on quality","0fe73f28":"# similarly the outliers in alcohol and total sulphur dioxide must be removed.","f732ba4f":"# KNN\n1. Finding the optimum number of neighbors","ae162922":"# Correlation","421b8e75":"1. Using 80% data to train and 20% to test.","7661241b":"#  Decision tree classifier","d508879a":"# Exploratory data analysis\nlet's dive into the data","394716bc":"# Support Vector Machine","66bcb61b":"#   Noob? You're in the right place\nHey there! Even i am a beginer and in this notebook i will easily explain all the concepts ","8ae5896f":"# ~ 90% accuracy","20406d20":"# Outliers\n1. As a begineer, remember that KNN is affected by outliers more, hence it is sometimes optimal to remove them.\n2. I will use Z-score to determine the outliers.","b8df1819":"YESSSSS!!!! NO MISSING VALUES"}}