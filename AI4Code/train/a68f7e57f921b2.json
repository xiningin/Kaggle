{"cell_type":{"4b37cb14":"code","5b58d2eb":"code","7fed109a":"code","f38e3f41":"code","1f594cd1":"code","a7a640ff":"code","7eb7ce1e":"code","9e690eed":"code","3ffdbf56":"code","60cc134b":"code","1f4f39ba":"code","fe529268":"code","85d31bd1":"code","48aaa496":"code","f9c38adf":"code","ac671b3e":"code","a3699158":"code","581f318b":"code","590b146b":"code","83a789bb":"code","f59fb98c":"code","9459ff81":"code","9fdf22a8":"markdown","79b16818":"markdown","35af78bf":"markdown","1c75abb0":"markdown","0052c027":"markdown","a13e45a1":"markdown"},"source":{"4b37cb14":"import math\nfrom pathlib import Path\n\nimport numpy as np\nimport pandas as pd","5b58d2eb":"DATA_DIR = Path('\/kaggle\/input')\n\n# list all file paths in DATA_DIR and its subdirectories\nfor filepath in DATA_DIR.rglob('*'):\n     print(filepath)","7fed109a":"data_filepath = DATA_DIR \/ 'santander-customer-transaction-prediction'\n\ntrain_data = pd.read_csv(data_filepath \/ 'train.csv', index_col='ID_code')","f38e3f41":"train_data.head()","1f594cd1":"RANDOM_STATE = 24\nTARGET = 'target'","a7a640ff":"train_data.info()","7eb7ce1e":"# utility function\ndef missing_value_stats(dataframe):\n    count = dataframe.isna().sum().sort_values(ascending=False)\n    proportion = count \/ dataframe.shape[0]\n\n    missing_value_df = pd.concat([count, proportion], axis=1)\n    missing_value_df.columns = ['missing values', 'proportion']\n    return missing_value_df","9e690eed":"train_data_missing = missing_value_stats(train_data)\ntrain_data_missing[train_data_missing.proportion > 0]","3ffdbf56":"import matplotlib.pyplot as plt\nimport seaborn as sns\n\nplt.rcParams['figure.figsize'] = (14,8)\nsns.set_theme(style='whitegrid')","60cc134b":"columns = train_data.columns\ncols = 2\nrows = math.ceil(len(columns)\/cols)\nfig, axes = plt.subplots(rows, cols, figsize=(14, 8\/\/cols*rows))\nplt.tight_layout()\n\nfor i, col in enumerate(columns):\n    ax = axes[i\/\/cols, i%cols]\n    sns.histplot(data=train_data, x=col, hue=TARGET, element='step', ax=ax)\n    ax.set_title(f'Histogram of {col}', y=0.88)\n\nplt.show()","1f4f39ba":"from scipy import stats","fe529268":"features = train_data.columns[1:]\n\nanova_results = []\nfor col in features:\n    groupby = train_data.groupby(TARGET)[col]\n    categories = train_data[TARGET].dropna().unique()\n    anova_data = [\n        groupby.get_group(category) for category in categories\n    ]\n\n    F, p = stats.f_oneway(*anova_data)\n    anova_results.append([col, F, p])\n\ncolumns = ['feature', 'F-statistic', 'p-value']\nanova_df = pd.DataFrame(anova_results, columns=columns)\nanova_df = anova_df.sort_values('p-value').set_index('feature')\nanova_df","85d31bd1":"# get the columns whose p-value is statistically significant\nthreshold = 0.01\nsignificant_anova = anova_df[anova_df['p-value'] < threshold]\n\nprint(\"Features with significant ANOVA p-value: {}\".format(\n    significant_anova.shape[0]\n))\nprint(\"Features with insignificant ANOVA p-value: {}\".format(\n    anova_df.shape[0] - significant_anova.shape[0]\n))","48aaa496":"display(significant_anova.head())\ndisplay(significant_anova.tail())","f9c38adf":"from sklearn.feature_selection import mutual_info_classif","ac671b3e":"X = train_data.copy()\ny = X.pop(TARGET)","a3699158":"mi_scores = mutual_info_classif(X, y, random_state=RANDOM_STATE)\nmutual_info = pd.Series(mi_scores, index=X.columns,\n                        name='mutual_info')\nmutual_info = mutual_info.sort_values(ascending=False)\nnonzero_mutual_info = mutual_info[mutual_info != 0]\n\nprint('Number of features with non-zero MI score: {}'.format(\n    nonzero_mutual_info.shape[0]\n))\nprint('Number of features with zero MI score: {}'.format(\n    mutual_info.shape[0] - nonzero_mutual_info.shape[0]\n))","581f318b":"print(f'Top 5: \\n{nonzero_mutual_info.head()}\\n')\nprint(f'Bottom 5: \\n{nonzero_mutual_info.tail()}\\n')","590b146b":"fig, ax = plt.subplots()\ndata = nonzero_mutual_info.head(25)\n\nsns.barplot(x=data.values, y=data.index, ax=ax)\nax.set_title('Mutual information scores')\nplt.show()","83a789bb":"list(nonzero_mutual_info.head(25).index)","f59fb98c":"list_a = list(set(significant_anova.index) - set(nonzero_mutual_info.index))\nprint(f'Features with significant ANOVA p-value but zero mutual info: {len(list_a)}')\n\nlist_b = list(set(nonzero_mutual_info.index) - set(significant_anova.index))\nprint(f'Features with non-zero mutual info but insignificant ANOVA p-value: {len(list_b)}')","9459ff81":"fig, ax = plt.subplots()\ndata = nonzero_mutual_info[list_b].sort_values(ascending=False)\n\nsns.barplot(x=data.values, y=data.index, ax=ax)\nax.set_title('Mutual information scores')\nplt.show()","9fdf22a8":"# One-way ANOVA","79b16818":"# Santander Customer Transaction Prediction\n","35af78bf":"# Mutual information","1c75abb0":"# Loading the data","0052c027":"# Check for missing values","a13e45a1":"# Visualizing the distribution"}}