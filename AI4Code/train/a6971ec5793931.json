{"cell_type":{"874fab1d":"code","2602819e":"code","32a37ffb":"code","f30115f5":"code","6d333bc3":"code","38c76d52":"code","993dbb78":"code","6c06f9fb":"code","b87cdd58":"code","b9fbb621":"code","a0c5a43a":"code","6a27e53c":"code","8b2a9e30":"code","3428875a":"code","f939366d":"code","95519adc":"code","86fb1e2c":"code","036919be":"code","4111e2fb":"code","9bc6068f":"code","a86c10be":"code","f51196b2":"code","8fc28f2d":"code","480f54f5":"code","221efd0d":"code","a9faabdd":"code","66638fb0":"code","6b5ad21a":"code","16f59299":"code","a891533c":"code","a77f04e9":"code","663d8553":"code","c6cde7de":"code","61690dd1":"code","602d8fa3":"code","bed87492":"code","c11a451a":"code","4b8262b5":"code","29136ea2":"code","453191ac":"code","91ccca23":"code","65ca086d":"code","dce7a9b8":"code","25c936a7":"code","437ea38c":"code","9d49c3ec":"code","e911069d":"code","f6228e09":"code","8dd1787f":"code","6bdd1c6f":"code","5456e974":"markdown","42884e45":"markdown","e375210e":"markdown","65b307c9":"markdown","c5d55ff9":"markdown","f085b5ed":"markdown","5e0fcf93":"markdown","358d5deb":"markdown","d3219013":"markdown","e41f4df4":"markdown","020ce191":"markdown","d8873a76":"markdown","5339c9ae":"markdown","6b7b9ce1":"markdown","f6c17377":"markdown","a7f68260":"markdown","4a865c76":"markdown","906ae0ec":"markdown","80bcfec0":"markdown","8884d904":"markdown","670ed639":"markdown","393272d3":"markdown","24ac40e8":"markdown","e50215f2":"markdown"},"source":{"874fab1d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","2602819e":"import warnings\nimport seaborn as sns\nfrom colorama import Fore, Back, Style\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix, accuracy_score\nfrom mlxtend.plotting import plot_confusion_matrix\nfrom plotly.offline import plot, iplot, init_notebook_mode\nimport plotly.graph_objs as go\nfrom plotly.subplots import make_subplots\nimport plotly.express as px\nfrom statsmodels.formula.api import ols\nimport plotly.graph_objs as gobj\n\ninit_notebook_mode(connected=True)\nwarnings.filterwarnings('ignore')\nimport plotly.figure_factory as ff\n\n%matplotlib inline\n\nimport xgboost\nimport lightgbm\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom catboost import CatBoostClassifier","32a37ffb":"heart_data = pd.read_csv('\/kaggle\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')\nheart_data.head()","f30115f5":"heart_data['DEATH_EVENT'].value_counts()","6d333bc3":"#age distribution\nhist_data = [heart_data['age'].values]\ngroup_labels = ['age']\n\nfig = ff.create_distplot(hist_data, group_labels)\nfig.update_layout(title_text='Age Distribution Plot')\n\nfig.show()","38c76d52":"fig = px.box(heart_data, x='sex', y='age', points='all')\nfig.update_layout(\ntitle_text='Gender wise Age spread - Male = 1, Female = 0')\nfig.show()","993dbb78":"male = heart_data[heart_data['sex'] == 1] \nfemale = heart_data[heart_data['sex'] == 0] \n\nmale_survi = male[heart_data['DEATH_EVENT'] == 0]\nmale_not = male[heart_data['DEATH_EVENT'] == 1]\nfemale_survi = female[heart_data['DEATH_EVENT'] == 0]\nfemale_not = female[heart_data['DEATH_EVENT'] == 1]\n\nlabels = ['Male - Survived', 'Male - Not Survived', 'Female - Survived', 'Female - Not Survived']\nvalues = [len(male[heart_data['DEATH_EVENT'] == 0]), len(male[heart_data['DEATH_EVENT'] == 1]),\n          len(female[heart_data['DEATH_EVENT'] == 0]),len(female[heart_data['DEATH_EVENT'] == 1]),]\nfig = go.Figure(data=[go.Pie(labels=labels, values=values, hole=.4)])\nfig.update_layout(\ntitle_text = 'Analysis on Survival - Gender')\nfig.show()","6c06f9fb":"surv = heart_data[heart_data['DEATH_EVENT'] == 0]['age']\nnot_surv = heart_data[heart_data['DEATH_EVENT'] == 1]['age']\nhist_data = [surv, not_surv]\ngroup_labels = ['Survived', 'Not Survived']\nfig = ff.create_distplot(hist_data, group_labels, bin_size=0.5)\nfig.update_layout(\ntitle_text='Analysis in Age on Survival Status')\nfig.show()","b87cdd58":"fig = px.violin(heart_data, y='age', x='sex', color='DEATH_EVENT', box=True,points='all',hover_data=heart_data.columns)\nfig.update_layout(title_text='Analysis in Age and Gender on Survival Status')\nfig.show()","b9fbb621":"fig = px.violin(heart_data, y=\"age\", x=\"smoking\", color=\"DEATH_EVENT\", box=True, points=\"all\", hover_data=heart_data.columns)\nfig.update_layout(title_text=\"Analysis in Age and Smoking on Survival Status\")\nfig.show()","a0c5a43a":"fig = px.violin(heart_data, y=\"age\", x=\"diabetes\", color=\"DEATH_EVENT\", box=True, points=\"all\", hover_data=heart_data.columns)\nfig.update_layout(title_text=\"Analysis in Age and Diabetes on Survival Status\")\nfig.show()","6a27e53c":"fig = px.histogram(heart_data, x='creatinine_phosphokinase', color='DEATH_EVENT', marginal='violin',\n                  hover_data=heart_data.columns)\nfig.show()","8b2a9e30":"fig = px.histogram(heart_data, x='ejection_fraction', color='DEATH_EVENT', marginal='violin',\n                  hover_data=heart_data.columns)\nfig.show()","3428875a":"fig = px.histogram(heart_data, x='platelets', color='DEATH_EVENT', marginal='violin',\n                  hover_data=heart_data.columns)\nfig.show()","f939366d":"fig = px.histogram(heart_data, x=\"serum_creatinine\", color=\"DEATH_EVENT\", marginal=\"violin\", hover_data=heart_data.columns)\nfig.show()","95519adc":"surv = heart_data[heart_data['DEATH_EVENT']==0]['serum_sodium']\nnot_surv = heart_data[heart_data['DEATH_EVENT']==1]['serum_sodium']\nhist_data= [surv, not_surv]\ngroup_labels = ['Survived', 'Not Survived']\nfig = ff.create_distplot(hist_data, group_labels, bin_size=0.5)\nfig.update_layout(\ntitle_text='Analysis in Serum Sodium on Survival Status')\nfig.show()","86fb1e2c":"surv = heart_data[heart_data['DEATH_EVENT']==0]['serum_creatinine']\nnot_surv = heart_data[heart_data['DEATH_EVENT']==1]['serum_creatinine']\nhist_data= [surv, not_surv]\ngroup_labels = ['Survived', 'Not Survived']\nfig = ff.create_distplot(hist_data, group_labels, bin_size=0.5)\nfig.update_layout(\ntitle_text='Analysis in Serum Creatinine on Survival Status')\nfig.show()","036919be":"surv = heart_data[heart_data['DEATH_EVENT']==0]['ejection_fraction']\nnot_surv = heart_data[heart_data['DEATH_EVENT']==1]['ejection_fraction']\nhist_data= [surv, not_surv]\ngroup_labels = ['Survived', 'Not Survived']\nfig = ff.create_distplot(hist_data, group_labels, bin_size=0.5)\nfig.update_layout(\ntitle_text='Analysis in Ejection Fraction on Survival Status')\nfig.show()","4111e2fb":"import matplotlib.pyplot as plt\nplt.figure(figsize=(10,10))\nsns.heatmap(heart_data.corr(), vmin=-1, cmap='coolwarm', annot=True);","9bc6068f":"Features = ['time', 'ejection_fraction','serum_creatinine']\nx = heart_data[Features]\ny = heart_data['DEATH_EVENT']\nx_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.2, random_state=2)","a86c10be":"accuracy_list = []","f51196b2":"#logistic regression\n\nlog_reg = LogisticRegression()\nlog_reg.fit(x_train,y_train)\nlog_reg_pred = log_reg.predict(x_test)\nlog_reg_acc = accuracy_score(y_test, log_reg_pred)\naccuracy_list.append(log_reg_acc * 100)","8fc28f2d":"print('Accuracy of Logistic Regression is : ', '{:.2f}%'.format(100 * log_reg_acc))","480f54f5":"cm = confusion_matrix(y_test, log_reg_pred)\nplt.figure()\nplot_confusion_matrix(cm, figsize=(12,8), hide_ticks=True, cmap=plt.cm.Blues)\nplt.title('Logistic Regression Model - Confusion Matrix')\nplt.xticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.yticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.show()","221efd0d":"#svc\nsv_clf = SVC()\nsv_clf.fit(x_train,y_train)\nsv_clf_pred = sv_clf.predict(x_test)\nsv_clf_acc = accuracy_score(y_test, sv_clf_pred)\naccuracy_list.append(100*sv_clf_acc)","a9faabdd":"print('Accuracy of Support Vector is : ', '{:.2f}%'.format(100 * sv_clf_acc))","66638fb0":"cm = confusion_matrix(y_test, sv_clf_pred)\nplt.figure()\nplot_confusion_matrix(cm, figsize=(12,8), hide_ticks=True, cmap=plt.cm.Blues)\nplt.title('SVC Model - Confusion Matrix')\nplt.xticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.yticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.show()","6b5ad21a":"# K Neighbours Classifier\nkn_clf = KNeighborsClassifier(n_neighbors=6)\nkn_clf.fit(x_train,y_train)\nkn_pred = kn_clf.predict(x_test)\nkn_acc = accuracy_score(y_test,kn_pred)\naccuracy_list.append(kn_acc * 100)","16f59299":"print('Accuracy of KNeighbours is : ', '{:.2f}%'.format(100 * kn_acc))","a891533c":"cm = confusion_matrix(y_test, kn_pred)\nplt.figure()\nplot_confusion_matrix(cm, figsize=(12,8), hide_ticks=True, cmap=plt.cm.Blues)\nplt.title('KN  Model - Confusion Matrix')\nplt.xticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.yticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.show()","a77f04e9":"#Decision Tree Classifier\n\ndt_clf = DecisionTreeClassifier(max_leaf_nodes=3, random_state=0, criterion='entropy')\ndt_clf.fit(x_train,y_train)\ndt_pred = dt_clf.predict(x_test)\ndt_acc = accuracy_score(y_test,dt_pred)\naccuracy_list.append(dt_acc * 100)","663d8553":"print('Accuracy of DecisionTreeClassifier is : ', '{:.2f}%'.format(100 * dt_acc))","c6cde7de":"cm = confusion_matrix(y_test, dt_pred)\nplt.figure()\nplot_confusion_matrix(cm, figsize=(12,8), hide_ticks=True, cmap=plt.cm.Blues)\nplt.title('Decision Tree  Model - Confusion Matrix')\nplt.xticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.yticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.show()","61690dd1":"#RandomForest Classifier\n\nr_clf = RandomForestClassifier(max_features=0.5, max_depth=15, random_state=1)\nr_clf.fit(x_train,y_train)\nr_pred = r_clf.predict(x_test)\nr_acc = accuracy_score(y_test,r_pred)\naccuracy_list.append(r_acc * 100)","602d8fa3":"print('Accuracy of RandomForestClassifier is : ', '{:.2f}%'.format(100 * r_acc))","bed87492":"cm = confusion_matrix(y_test, r_pred)\nplt.figure()\nplot_confusion_matrix(cm, figsize=(12,8), hide_ticks=True, cmap=plt.cm.Blues)\nplt.title('Random Forest Model - Confusion Matrix')\nplt.xticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.yticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.show()","c11a451a":"# GradientBoostingClassifier\n\ngradientboost_clf = GradientBoostingClassifier(max_depth=2, random_state=1)\ngradientboost_clf.fit(x_train,y_train)\ngradientboost_pred = gradientboost_clf.predict(x_test)\ngradientboost_acc = accuracy_score(y_test, gradientboost_pred)\naccuracy_list.append(100*gradientboost_acc)","4b8262b5":"print('Accuracy of GradientBoostingClassifier is : ', '{:.2f}%'.format(100 * gradientboost_acc))","29136ea2":"cm = confusion_matrix(y_test, gradientboost_pred)\nplt.figure()\nplot_confusion_matrix(cm, figsize=(12,8), hide_ticks=True, cmap=plt.cm.Blues)\nplt.title('GradientBoostingClassifier Model - Confusion Matrix')\nplt.xticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.yticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.show()","453191ac":"#xgboost classifier\nxgb_clf = xgboost.XGBRFClassifier(max_depth=3, random_state=1)\nxgb_clf.fit(x_train,y_train)\nxgb_pred = xgb_clf.predict(x_test)\nxgb_acc = accuracy_score(y_test, xgb_pred)\naccuracy_list.append(100*xgb_acc)","91ccca23":"print('Accuracy of XGBRFClassifier is : ', '{:.2f}%'.format(100 * xgb_acc))","65ca086d":"cm = confusion_matrix(y_test, xgb_pred)\nplt.figure()\nplot_confusion_matrix(cm, figsize=(12,8), hide_ticks=True, cmap=plt.cm.Blues)\nplt.title('XGBRFClassifier Model - Confusion Matrix')\nplt.xticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.yticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.show()","dce7a9b8":"#  lightgbm \n\nlgb_clf = lightgbm.LGBMClassifier(max_depth=2, random_state=4)\nlgb_clf.fit(x_train,y_train)\nlgb_pred = lgb_clf.predict(x_test)\nlgb_acc = accuracy_score(y_test, lgb_pred)\naccuracy_list.append(100*lgb_acc)","25c936a7":"print('Accuracy of LGBMClassifier is : ', '{:.2f}%'.format(100 * lgb_acc))","437ea38c":"cm = confusion_matrix(y_test, lgb_pred)\nplt.figure()\nplot_confusion_matrix(cm, figsize=(12,8), hide_ticks=True, cmap=plt.cm.Blues)\nplt.title('LGBMClassifier Model - Confusion Matrix')\nplt.xticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.yticks(range(2), ['Heart Not Failed', 'Heart Fail'], fontsize=16)\nplt.show()","9d49c3ec":"# CatBoostClassifier\n\ncat_clf = CatBoostClassifier()\ncat_clf.fit(x_train,y_train)\ncat_pred = cat_clf.predict(x_test)\ncat_acc = accuracy_score(y_test, cat_pred)\naccuracy_list.append(100*cat_acc)","e911069d":"print(\"Accuracy of CatBoostClassifier is : \",\"{:.2f}%\".format(100* cat_acc))","f6228e09":"cm = confusion_matrix(y_test, cat_pred)\nplt.figure()\nplot_confusion_matrix(cm, figsize=(12,8), hide_ticks=True, cmap=plt.cm.Blues)\nplt.title(\"Cat Boost Classifier Model - Confusion Matrix\")\nplt.xticks(range(2), [\"Heart Not Failed\",\"Heart Fail\"], fontsize=16)\nplt.yticks(range(2), [\"Heart Not Failed\",\"Heart Fail\"], fontsize=16)\nplt.show()\n","8dd1787f":"model_list = ['Logistic Regression', 'SVC','KNearestNeighbours', 'DecisionTree', 'RandomForest',\n              'GradientBooster', 'XGBRF','LGBM', 'CatBoostClassifier']","6bdd1c6f":"plt.rcParams['figure.figsize'] = 20, 8\nsns.set_style('darkgrid')\nax = sns.barplot(x=model_list, y=accuracy_list, palette = 'husl', saturation=2.0)\nplt.xlabel('Classifier Models', fontsize=20)\nplt.ylabel('% of Accuracy', fontsize=20)\nplt.title('Accuracy of different Classifier Models', fontsize=20)\nplt.xticks(fontsize = 12, horizontalalignment = 'center', rotation = 8)\nplt.yticks(fontsize = 12)\nfor i in ax.patches:\n    width, height = i.get_width(), i.get_height()\n    x, y = i.get_xy()\n    ax.annotate(f'{round(height, 2)}%', ( x + width\/2, y + height* 1.02), ha='center', fontsize='x-large')\n    plt.show()","5456e974":"**Random Forest Classifier**","42884e45":"# Importing libraries","e375210e":"* Sex - Gender of patient value_counts1, Female - 0\n* Age - Age of patient\n* Diabetes - 0 = No, 1 = Yes\n* Anaemia - 0 = No, 1 = Yes\n* High_Blood_Pressure - 0 = No, 1 = Yes\n* Smoking - 0 = No, 1 = Yes\n* DEATH_EVENT - 0 = No, 1 = Yes","65b307c9":"**Heatmap**","c5d55ff9":"**K-Neighbours Classifier**","f085b5ed":"**Distribution plots Servived and Not-Survived**","5e0fcf93":"* Age wise 40 to 80 the spread is High\n* less that 40 age and higher than 80 age people are very low","358d5deb":"There are some factors that affects Death Evernt. This dataset contains person information like age, sex, blood pressure, smoke etc. We have to predict their DEATH EVENT. This dataset is VERY small so its better to not treat so serious this data.","d3219013":"**XGBoost Classifier**","e41f4df4":"# Data Modeling","020ce191":"* Survival is higher from 40 to 70 years old\n* The spread of Not survival is going through all ages.","d8873a76":"* The Survival is high for not smoking person 55 to 65, while for smoking person it is between 50 to 60\n* Death evernt for smoking person is high than not smoking person","5339c9ae":"# Does Age and Sex are an indication of Death Event?","6b7b9ce1":"**Train Test Split**","f6c17377":"**Hist Plots**","a7f68260":"**Support Vector**","4a865c76":"# Gender Factor Analysis","906ae0ec":"**LGBMClassifier**","80bcfec0":"**Gradient Boosting Classifier**","8884d904":"**Logistic Regression**","670ed639":"Age Report:\n* Survical spread is high in age flow of 40 to 70\n* The Survival is high for both male between 50 to 60 and female's age between 60 to 70 respectively","393272d3":"**Decision Tree Classifier**","24ac40e8":"**CatBoostClassifier**","e50215f2":"# Data Exploration"}}