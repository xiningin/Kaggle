{"cell_type":{"b26d48b2":"code","e5af5ec0":"code","5dc2aef1":"code","29b41f20":"code","8fc9bbb3":"code","9e292114":"code","8c925eb7":"code","112a80da":"code","41f94d70":"code","92ee18bf":"code","73a2030d":"code","86d27e8e":"code","5c610816":"code","dbc9bf9c":"code","01e0a5bb":"code","fe8d0176":"code","ca6d599c":"code","1a9932bd":"code","d3b33128":"code","8e14a15d":"code","98b19bd6":"code","7dd45e76":"code","e7c756d4":"code","6b635317":"code","1687ad55":"code","85d735f8":"code","ba3bf24d":"code","7d2b2b75":"code","c302e6c0":"code","f59a842b":"code","f02dacbc":"code","6ffe478e":"code","fed36313":"code","94e30546":"markdown","944cc9e9":"markdown","8cb5cdd1":"markdown","70c05477":"markdown","db5c24ea":"markdown","28a0c687":"markdown","542a76b3":"markdown","4c3bb5c4":"markdown","dd269286":"markdown","162fd354":"markdown","1eb44188":"markdown","71ddcf62":"markdown","a0b19fb5":"markdown","568731d4":"markdown","2e61b6fe":"markdown","371a6b8f":"markdown","eb956ec7":"markdown","2a3deabb":"markdown","7442ffe4":"markdown","a30eed22":"markdown","465dbe2f":"markdown","c2cb9d7c":"markdown","18b33879":"markdown","568cff5f":"markdown","66b4d85e":"markdown","670e1232":"markdown","62672c80":"markdown","777bbe59":"markdown","fe77eb32":"markdown"},"source":{"b26d48b2":"import pandas as pd\nimport numpy as np \nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport warnings\nwarnings.filterwarnings('ignore')","e5af5ec0":"diab_df= pd.read_csv('..\/input\/pima-indians-diabetes-database\/diabetes.csv')","5dc2aef1":"diab_df.head(5)","29b41f20":"diab_df.tail(5)","8fc9bbb3":"diab_df.duplicated().sum()","9e292114":"diab_df.shape","8c925eb7":"diab_df.info()","112a80da":"diab_df.isnull().sum()","41f94d70":"diab_df[['Glucose','BloodPressure','SkinThickness','Insulin','BMI']] = diab_df[['Glucose','BloodPressure','SkinThickness','Insulin','BMI']].replace(0,np.NaN)","92ee18bf":"diab_df.isnull().sum()","73a2030d":"diab_df.hist(figsize = (11,11), color=\"#008080\")","86d27e8e":"diab_df['Glucose'].fillna(diab_df['Glucose'].mean(), inplace = True)\ndiab_df['BloodPressure'].fillna(diab_df['BloodPressure'].mean(), inplace = True)\ndiab_df['SkinThickness'].fillna(diab_df['SkinThickness'].median(), inplace = True)\ndiab_df['Insulin'].fillna(diab_df['Insulin'].median(), inplace = True)\ndiab_df['BMI'].fillna(diab_df['BMI'].median(), inplace = True)","5c610816":"diab_df.isnull().sum()","dbc9bf9c":"diab_df.info()","01e0a5bb":"plt.figure(figsize=(10,5))\nplt.title('Diabetes Plot Yes\/No', fontsize=14)\nsns.countplot(x=\"Outcome\", data=diab_df, palette=('#23C552','#C52219'))\nplt.xlabel(\"Diabetes (0 = No, 1= Yes)\", fontsize=12)\nplt.ylabel(\"Count\", fontsize=12)\nplt.xticks(fontsize=12)\nplt.yticks(fontsize=12)\nplt.show()","fe8d0176":"fig, axes = plt.subplots(2, 4, figsize=(18, 12))\nfig.suptitle('Diabetes Outcome Distribution WRT All Independent Variables', fontsize=16)\n\nsns.boxplot(ax=axes[0, 0], x=diab_df['Outcome'], y=diab_df['Pregnancies'], hue=diab_df['Outcome'], palette=('#23C552','#C52219'))\naxes[0, 0].set_title(\"Diabetes Outcome vs Pregnancies\", fontsize=12)\n\nsns.boxplot(ax=axes[0, 1], x=diab_df['Outcome'], y=diab_df['Glucose'], hue=diab_df['Outcome'], palette=('#23C552','#C52219'))\naxes[0, 1].set_title(\"Diabetes Outcome vs Glucose\", fontsize=12)\n\nsns.boxplot(ax=axes[0, 2], x=diab_df['Outcome'], y=diab_df['BloodPressure'], hue=diab_df['Outcome'], palette=('#23C552','#C52219'))\naxes[0, 2].set_title(\"Diabetes Outcome vs BloodPressure\", fontsize=12)\n\nsns.boxplot(ax=axes[0, 3], x=diab_df['Outcome'], y=diab_df['SkinThickness'], hue=diab_df['Outcome'], palette=('#23C552','#C52219'))\naxes[0, 3].set_title(\"Diabetes Outcome vs SkinThickness\", fontsize=12)\n\nsns.boxplot(ax=axes[1, 0], x=diab_df['Outcome'], y=diab_df['Insulin'], hue=diab_df['Outcome'], palette=('#23C552','#C52219'))\naxes[1, 0].set_title(\"Diabetes Outcome vs Insulin\", fontsize=12)\n\nsns.boxplot(ax=axes[1, 1], x=diab_df['Outcome'], y=diab_df['BMI'], hue=diab_df['Outcome'], palette=('#23C552','#C52219'))\naxes[1, 1].set_title(\"Diabetes Outcome vs BMI\", fontsize=12)\n\nsns.boxplot(ax=axes[1, 2], x=diab_df['Outcome'], y=diab_df['DiabetesPedigreeFunction'], hue=diab_df['Outcome'], palette=('#23C552','#C52219'))\naxes[1, 2].set_title(\"Diabetes Outcome vs DiabetesPedigreeFunction\", fontsize=12)\n\nsns.boxplot(ax=axes[1, 3], x=diab_df['Outcome'], y=diab_df['Age'], hue=diab_df['Outcome'], palette=('#23C552','#C52219'))\naxes[1, 3].set_title(\"Diabetes Outcome vs Age\", fontsize=12)","ca6d599c":"sns.pairplot(diab_df, hue='Outcome', palette=('#23C552','#C52219'))","1a9932bd":"plt.figure(figsize=(12,10))\nsns.heatmap(diab_df.corr(), annot=True, cmap='RdYlGn')\nplt.title(\"Feature Correlation Matrix\",fontsize=20)\nplt.show()","d3b33128":"diab_df.describe()","8e14a15d":"diab_df['Outcome'].value_counts()","98b19bd6":"from sklearn.model_selection import train_test_split\nx = diab_df.drop(['Outcome'],axis=1)\ny = diab_df['Outcome']","7dd45e76":"from sklearn.preprocessing import StandardScaler\n\nsc= StandardScaler()\nx_scaled= sc.fit_transform(x)","e7c756d4":"x_train, x_test, y_train, y_test = train_test_split(x_scaled, y, test_size=0.3, random_state=0)","6b635317":"x_train.shape, y_train.shape","1687ad55":"x_test.shape, y_test.shape","85d735f8":"from sklearn.linear_model import LogisticRegression\nlogreg = LogisticRegression()\nlogreg.fit(x_train, y_train)\ny_pred = logreg.predict(x_test)","ba3bf24d":"from sklearn.metrics import confusion_matrix, accuracy_score\nconfmat = confusion_matrix(y_pred, y_test)\nconfmat","7d2b2b75":"from sklearn import metrics\ncm=metrics.ConfusionMatrixDisplay(confusion_matrix=metrics.confusion_matrix(y_pred,y_test,labels=logreg.classes_),\n                              display_labels=logreg.classes_)\ncm.plot(cmap=\"magma\")","c302e6c0":"accuracy_score(y_pred, y_test)","f59a842b":"from sklearn.ensemble import RandomForestClassifier\n\nrandom_forest = RandomForestClassifier(criterion = \"gini\", \n                                       min_samples_leaf = 1, \n                                       min_samples_split = 10,   \n                                       n_estimators=100, \n                                       max_features='auto', \n                                       oob_score=True, \n                                       random_state=1, \n                                       n_jobs=-1)\n\nrandom_forest.fit(x_train, y_train)\ny_pred = random_forest.predict(x_test)","f02dacbc":"confmat1 = confusion_matrix(y_pred, y_test)\nconfmat1","6ffe478e":"from sklearn import metrics\ncm=metrics.ConfusionMatrixDisplay(confusion_matrix=metrics.confusion_matrix(y_pred,y_test,labels=random_forest.classes_),\n                              display_labels=random_forest.classes_)\ncm.plot(cmap=\"magma\")","fed36313":"accuracy_score(y_pred, y_test)","94e30546":"**We can see that a few of the features are moderately correlated - Age and number of Pregnancies, Insulin and Glucose levels, Skin Thickness and BMI - but not so much as to cause concern.**","944cc9e9":"**After replacing NaN Values, the dataset is almost clean now. We can move ahead with our EDA.**","8cb5cdd1":"**So, there 768 records in 9 columns. Also, there are no null records as well as duplicate values.**","70c05477":"### **Applying Logistic Regression**","db5c24ea":"**Checking first 5 and last 5 records from the datasets**","28a0c687":"### **Model Accuracy with Logistic Regression: 76.19%**","542a76b3":"**First Let's split the data into train and test.**","4c3bb5c4":"**To fill these 0s with Nan values the let's see the data distribution.**","dd269286":"**But we can observe that, there are lot of 0s present in the dataset. It is better to replace zeros with NaN and after that counting them would be easier and 0s need to be replaced with suitable values.**","162fd354":"**From above Boxplot, we can see that those who are diabetic tends to have higher Glucose levels, Age, BMI, Pregnancies and Insulin measures.**","1eb44188":"**Load the important required libraries**","71ddcf62":"**Let's check the duplicate data in data set**","a0b19fb5":"### **Data Analysis On Diabetes Data Set**","568731d4":"![](https:\/\/image.freepik.com\/free-vector\/cute-happy-blood-drop-with-glucose-measuring-device-character-flat-style-cartoon-illustration-icon-isolated-white-normal-risk-diabetes-blood-sugar-glucometer-level_92289-457.jpg)","2e61b6fe":"**From above plot, we can say that there are less number of diabetic patients in the data set.**","371a6b8f":"### **Exploratory Data Analysis**","eb956ec7":"### **Model Accuracy with Random Forest: 77.05%**","2a3deabb":"# **Diabetes Prediction**\n\nThis dataset is originally from the National Institute of Diabetes and Digestive and Kidney Diseases. The objective of the dataset is to diagnostically predict whether or not a patient has diabetes, based on certain diagnostic measurements included in the dataset. Several constraints were placed on the selection of these instances from a larger database. In particular, all patients here are females at least 21 years old of Pima Indian heritage.\n\nThe datasets consists of several medical predictor variables and one target variable, Outcome. Predictor variables includes the number of pregnancies the patient has had, their BMI, insulin level, age, and so on.","7442ffe4":"**Computing confusion matrix**","a30eed22":"**Here we have just checked the distribution.**","465dbe2f":"### **Modelling**","c2cb9d7c":"**Computing Confusin Matrix**","18b33879":"**Data contains;**\n\n1. **Pregnancies:** Number of times pregnant\n\n2. **Glucose:** Plasma glucose concentration a 2 hours in an oral glucose tolerance test\n\n3. **BloodPressure:** Diastolic blood pressure (mm Hg)\n\n4. **SkinThickness:** Triceps skin fold thickness (mm)\n\n5. **Insulin:** 2-Hour serum insulin (mu U\/ml)\n\n6. **BMI:** Body mass index (weight in kg\/(height in m)^2)\n\n7. **DiabetesPedigreeFunction:** Diabetes pedigree function\n\n8. **Age:** Age (years)\n\n9. **Outcome:** 1 if diabetes, 0 if no diabetes","568cff5f":"### **Applying Random Forest**","66b4d85e":"**Let us load the data set**","670e1232":"**We can see here that, there were lot of 0s present in the above mentioned columns.**","62672c80":"**First Let's split the data in to x and y.**","777bbe59":"**Then we use the standard scaler to scale the data.**","fe77eb32":"**Let's aim to replace NaN values for the columns in accordance with their distribution**"}}