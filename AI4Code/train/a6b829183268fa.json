{"cell_type":{"29628d5d":"code","e689eaa0":"code","d34b131c":"code","4c742ad8":"code","38e31bf5":"code","0147ad75":"code","cc1ad6c1":"code","367e8cb9":"code","dffbbdfb":"code","303f2b52":"code","1debd0c8":"code","176a9662":"code","1e024183":"code","632f1102":"markdown","8046d1e3":"markdown","f21056c8":"markdown","654f4ee1":"markdown","ab341d5a":"markdown"},"source":{"29628d5d":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom sklearn.model_selection import train_test_split\nimport spacy\nfrom sklearn.svm import LinearSVC","e689eaa0":"data = pd.read_csv('\/kaggle\/input\/amazon-music-reviews\/Musical_instruments_reviews.csv')\ndata.head()","d34b131c":"(data.overall.value_counts() \/ data.overall.count()) * 100","4c742ad8":"data.loc[data.overall < 4, 'overall'] = 0\ndata.loc[data.overall >= 4, 'overall'] = 1\n(data.overall.value_counts() \/ data.overall.count()) * 100","38e31bf5":"(data.isnull().sum() \/ data.count()) * 100","0147ad75":"data.dropna(subset=['reviewText'], inplace=True)","cc1ad6c1":"(data.isnull().sum() \/ data.count()) * 100","367e8cb9":"nlp = spacy.load('en_core_web_lg')","dffbbdfb":"with nlp.disable_pipes():\n    doc_vectors = np.array([nlp(text).vector for text in data.reviewText])\n    \ndoc_vectors.shape","303f2b52":"X_train, X_test, y_train, y_test = train_test_split(doc_vectors, data.overall, test_size=0.1)","1debd0c8":"svc = LinearSVC(dual=False, max_iter=10000)\nsvc.fit(X_train, y_train)\nprint(f\"Accuracy {svc.score(X_test, y_test) * 100}\")","176a9662":"def predict(text):\n    with nlp.disable_pipes():\n        test_vector = nlp(text).vector\n    return svc.predict([test_vector])[0]","1e024183":"print(predict(\"I really enjoyed this product.\"))\nprint(predict(\"The sound was terrible. Product is overpriced.\"))\nprint(predict(\"The reed was very loose, but overall you get what you pay for.\"))\nprint(predict(\"You get so much for the price: the thousands of sounds\/software that come with it are really useful, especially for a starting producer . The product is well designed and the built is solid. Would totally recommend !\"))\nprint(predict(\"Software that came in the bundle took nearly 3 hours to upload, then found out it was corrupt!\"))","632f1102":"# Test Examples\nFew examples taken from amazon reviews.","8046d1e3":"# Vectorization and Model\nModel uses the core web lg model to vectorize dataset for Linear SVC classification","f21056c8":"Reviewer name is not used for training. Review text is though. Since less than 0.07% of data is missing, I will just be dropping those rows.","654f4ee1":"# Data Analysis","ab341d5a":"Value counts show that 5 star ratings account for 67.6% of the data set while the combination of 4,3,2,1 only account for 32.4%. My goal is to classify positive and negative samples, so I will be considering 5, 4 to be positive while 3, 2, 1 are negative"}}