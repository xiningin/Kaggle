{"cell_type":{"667b8b01":"code","ed0eefb5":"code","c4f8a82a":"code","5d9a300c":"code","5641238b":"code","2a3d8854":"code","fa7b3566":"code","da6ec55a":"code","50fafcfb":"code","adeb0052":"code","744684d6":"code","80aa3927":"code","0fac3716":"code","da696c57":"code","d841f1e6":"code","17a08ec1":"code","904b2e7b":"code","b6276c01":"code","6195578b":"code","134ff5b3":"markdown","4789877f":"markdown","8b858db9":"markdown","35c6bc8b":"markdown"},"source":{"667b8b01":"import keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Dropout, Flatten\nfrom keras.layers import Conv2D, MaxPooling2D\nfrom keras.utils import to_categorical\nfrom keras.preprocessing import image\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom tqdm import tqdm\n%matplotlib inline","ed0eefb5":"train = pd.read_csv('..\/input\/mechanical-tools-dataset\/labels_hammer-dataset_2020-10-10-11-57-53.csv')    # reading the csv file\ntrain.head()  ","c4f8a82a":"train.columns","5d9a300c":"train_image = []\nfor i in tqdm(range(train.shape[0])):\n    img = image.load_img('..\/input\/mechanical-tools-dataset\/Mechanical Tools Image dataset-20201009T110652Z-001\/Mechanical Tools Image dataset\/Hammer\/'+train['id'][i],target_size=(400,400,3))\n    img = image.img_to_array(img)\n    img = img\/255\n    train_image.append(img)\nX = np.array(train_image)","5641238b":"X.shape","2a3d8854":"plt.imshow(X[5])","fa7b3566":"plt.imshow(X[15])","da6ec55a":"y = np.array(train.drop(['id', 'Hammer'],axis=1))","50fafcfb":"y.shape","adeb0052":"y","744684d6":"X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42, test_size=0.1)","80aa3927":"model = Sequential()\nmodel.add(Conv2D(filters=16, kernel_size=(5, 5), activation=\"relu\", input_shape=(400,400,3)))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Dropout(0.25))\nmodel.add(Conv2D(filters=32, kernel_size=(5, 5), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Dropout(0.25))\nmodel.add(Conv2D(filters=64, kernel_size=(5, 5), activation=\"relu\"))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Dropout(0.25))\nmodel.add(Conv2D(filters=64, kernel_size=(5, 5), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Dropout(0.25))\nmodel.add(Flatten())\nmodel.add(Dense(128, activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(64, activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(6, activation='sigmoid'))","0fac3716":"model.summary()","da696c57":"model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])","d841f1e6":"model.fit(X_train, y_train, epochs=10, validation_data=(X_test, y_test), batch_size=16)","17a08ec1":"img = image.load_img('..\/input\/mechanical-tools-dataset\/Mechanical Tools Image dataset-20201009T110652Z-001\/Mechanical Tools Image dataset\/Hammer\/000050.jpg',target_size=(400,400,3))\nimg = image.img_to_array(img)\nimg = img\/255","904b2e7b":"classes = np.array(train.columns[0:])\nproba = model.predict(img.reshape(1,400,400,3))\ntop_3 = np.argsort(proba[0])[:-4:-1]\nfor i in range(3):\n    print(\"{}\".format(classes[top_3[i]])+\" ({:.3})\".format(proba[0][top_3[i]]))\nplt.imshow(img)\nproba","b6276c01":"img = image.load_img('..\/input\/mechanical-tools-dataset\/Mechanical Tools Image dataset-20201009T110652Z-001\/Mechanical Tools Image dataset\/Hammer\/000060.jpg',target_size=(400,400,3))\nimg = image.img_to_array(img)\nimg = img\/255","6195578b":"classes = np.array(train.columns[0:])\nproba = model.predict(img.reshape(1,400,400,3))\ntop_3 = np.argsort(proba[0])[:-4:-1]\nfor i in range(3):\n    print(\"{}\".format(classes[top_3[i]])+\" ({:.3})\".format(proba[0][top_3[i]]))\nplt.imshow(img)\nproba","134ff5b3":"# Loads Image and training set resized","4789877f":"**This model seems to underfit as training accuracy is lower than prediction accuracy, due to less training data**","8b858db9":"**Implementing deep learning model from scratch**","35c6bc8b":"**Before making predictions, we now need to preprocess the test images using the same steps we saw earlier, i.e, resizing and rescaling.**"}}