{"cell_type":{"241e41da":"code","b013060a":"code","4af3eb6f":"code","1df3b5c8":"code","2c08be45":"code","07393c6e":"code","1693256f":"code","39088a0f":"code","11fddc41":"code","19b971db":"code","d76344b7":"code","e05cd01c":"code","c8b6d9a5":"code","27ee1eff":"code","8969f10e":"code","81cb406f":"markdown","fb54ef66":"markdown","c52b2ac7":"markdown","a5641cf2":"markdown","134aa62a":"markdown"},"source":{"241e41da":"import numpy as np \nimport pandas as pd\n\ndf = pd.read_csv('..\/input\/alcohol-consumption\/gapminder_alcohol.csv')\ndf.head()","b013060a":"df.shape","4af3eb6f":"df.loc[df['country'] == 'Poland']","1df3b5c8":"df.nlargest(10, 'alcconsumption')","2c08be45":"df.describe()","07393c6e":"df['alcconsumption'].plot(kind='box')","1693256f":"df.plot(kind='scatter', x='incomeperperson', y='alcconsumption')","39088a0f":"#removing records with missing alcconsumption\ndf = df.loc[df['alcconsumption'] >= 0]\n\nX = df.drop(columns=['country', 'alcconsumption'])\ny = df['alcconsumption']","11fddc41":"# train\/test split\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.15, random_state=22)\nprint('Train: ', X_train.shape)\nprint('Test: ', X_test.shape)","19b971db":"# imputting missing values\nfrom sklearn.impute import SimpleImputer\nimp = SimpleImputer()\nX_train = imp.fit_transform(X_train)\nX_test = imp.transform(X_test)","d76344b7":"X_train = pd.DataFrame(X_train)\nX_test = pd.DataFrame(X_test)\n\nX_train.columns = X.columns\nX_test.columns = X.columns","e05cd01c":"X_train.describe()","c8b6d9a5":"from sklearn.ensemble import RandomForestRegressor\nreg = RandomForestRegressor(n_estimators=100, random_state=22, max_samples=0.7, min_samples_leaf=10)\nreg.fit(X_train, y_train)\nprint(reg.score(X_train, y_train))\nprint(reg.score(X_test, y_test))","27ee1eff":"from sklearn.metrics import mean_absolute_error\nprint('Train MAE: ', mean_absolute_error(y_train, reg.predict(X_train)))\nprint('Test MAE: ', mean_absolute_error(y_test, reg.predict(X_test)))","8969f10e":"# shap\nimport shap\nexplainer = shap.TreeExplainer(reg)\nshap_values = explainer.shap_values(X_test)\nshap.summary_plot(shap_values, X_test)","81cb406f":"## Let's start preparing model ","fb54ef66":"## Impact input variables for the predictions","c52b2ac7":"## Random forest regressor","a5641cf2":"# Can we observe any relation between income and aclohol consumption?","134aa62a":"# Which nation lead in alcohol consumption?"}}