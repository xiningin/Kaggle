{"cell_type":{"3bb49c2f":"code","aee8357b":"code","4fd5ff8a":"code","b3a4ce9e":"code","46e6544b":"code","df1765f4":"code","3c04e137":"code","b32384d2":"code","b63db3e2":"code","825252c1":"code","2bb50b66":"code","f7d478ab":"code","45cd03de":"code","fdc18770":"code","c3ca2bc7":"code","96fb6973":"code","cdcb472a":"code","e987f924":"code","46bca5ec":"code","b98f5b96":"code","e5dc4deb":"code","8be11d21":"code","06af8843":"code","8c28dc39":"code","6b63296f":"code","5d5a23ee":"code","a570e0d0":"code","3478b064":"code","6e0e8d55":"code","30ec0193":"code","23aebdde":"code","e2f2a8af":"code","4ee28cb3":"code","408115ea":"markdown","ecf21ec1":"markdown","06f3e6c1":"markdown","91b453ce":"markdown","85498159":"markdown","5177b29d":"markdown","c012dec2":"markdown","a8c86f8b":"markdown","c4c32ed0":"markdown","e17651ac":"markdown","c2afdd45":"markdown","73f73eb1":"markdown","1575f457":"markdown","de1c7056":"markdown","f62ce4b8":"markdown","c1eb2d1c":"markdown"},"source":{"3bb49c2f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","aee8357b":"df = pd.read_csv(\"\/kaggle\/input\/insurance\/insurance.csv\")","4fd5ff8a":"df.info()","b3a4ce9e":"df.isnull().sum().sum()","46e6544b":"df.describe()","df1765f4":"import matplotlib.pyplot as plt\nimport seaborn as sns","3c04e137":"var_list = ['age','bmi','children','charges','sex','smoker','region']\n\nfor column in var_list:\n    if column in ['sex','smoker','region']:\n        plt.figure(figsize = (5,5))\n    else:\n        plt.figure(figsize = (20,5))\n    sns.histplot(x=column,data=df)\n    plt.show()\n","b32384d2":"sns.pairplot(df)\nplt.show()","b63db3e2":"# plt.figure(figsize=(20,20))\nsns.pairplot(df,hue='sex')\nplt.show()","825252c1":"# plt.figure(figsize=(20,20))\nsns.pairplot(df,hue='smoker')\nplt.show()","2bb50b66":"# plt.figure(figsize=(20,20))\nsns.pairplot(df,hue='region')\nplt.show()","f7d478ab":"plt.figure(figsize=(10,10))\ncorr = df.corr()\nsns.heatmap(corr,annot=True)\nplt.show()","45cd03de":"sex = pd.get_dummies(df['sex'],drop_first = True)\ndf = pd.concat([df,sex],axis = 1)\ndf.info()","fdc18770":"smoker = pd.get_dummies(df['smoker'],drop_first = True)\ndf = pd.concat([df,smoker],axis = 1)\ndf.info()","c3ca2bc7":"region = pd.get_dummies(df['region'],drop_first = True)\ndf = pd.concat([df,region],axis = 1)\ndf.info()","96fb6973":"df.head()","cdcb472a":"df = df.drop(['sex','smoker','region'], axis = 1)\ndf.head()","e987f924":"y = df['charges']\nX = df.drop(['charges'],axis = 1)","46bca5ec":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size = 0.2,random_state=42)","b98f5b96":"from sklearn.preprocessing import MinMaxScaler\nmm = MinMaxScaler()\nmm.fit(X_train)\nX_train_transformed = mm.transform(X_train)\nX_test_transformed = mm.transform(X_test)","e5dc4deb":"X_train_transformed","8be11d21":"from sklearn.linear_model import LinearRegression","06af8843":"reg = LinearRegression()\nreg.fit(X_train_transformed, y_train)\nprint(reg.score(X_test_transformed, y_test))","8c28dc39":"from sklearn.ensemble import GradientBoostingRegressor","6b63296f":"reg = GradientBoostingRegressor()\nreg.fit(X_train_transformed, y_train)\nprint(reg.score(X_test_transformed, y_test))","5d5a23ee":"from sklearn.ensemble import RandomForestRegressor","a570e0d0":"reg = RandomForestRegressor()\nreg.fit(X_train_transformed, y_train)\nprint(reg.score(X_test_transformed, y_test))","3478b064":"from sklearn.linear_model import LassoCV,RidgeCV\nfrom xgboost import XGBRegressor\nfrom sklearn.ensemble import AdaBoostRegressor\nfrom sklearn.svm import SVR\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn.isotonic import IsotonicRegression","6e0e8d55":"estimators = [('RFC', RandomForestRegressor()),('GBR',GradientBoostingRegressor()),('Ada',AdaBoostRegressor())]","30ec0193":"from sklearn.ensemble import StackingRegressor","23aebdde":"final_estimator = LassoCV()","e2f2a8af":"reg = StackingRegressor(estimators=estimators,final_estimator=final_estimator)","4ee28cb3":"reg.fit(X_train_transformed, y_train)\nprint(reg.score(X_test_transformed, y_test))","408115ea":"Here, we observe the following trends: \n<ol>\n    <li>More the number of chidren, lesser the charges. But this could also be because people with 4 or more children are less.<\/li>\n    <li>We observe that as age increases, the charges also increases. This is expected<\/li>\n    <li>We observe people belonging to all age groups to have a good BMI around 30<\/li>\n<\/ol>","ecf21ec1":"No two variables are highly correlated.","06f3e6c1":"# Extracting data and gathering insights:","91b453ce":"# 1. Linear Regression","85498159":"# 2. Gradient Boosting Regressor","5177b29d":"**Converting categorical variables into numerical vectors:**","c012dec2":"# Model Building:","a8c86f8b":"# Please upvote this notebook if you found it helpful","c4c32ed0":"We observe that the range of values are different and there are categorical variable such as smoker present. This will be handled later.","e17651ac":"Here, we observe one key trend. Despite the number of people who smoke is less, **smokers** are generally charged more. Hence, one key thing to avoid is to not smoke, which will decrease the medical charges.","c2afdd45":"# 3. Random Forest Regressor","73f73eb1":"No apparent trend found even when visualising using **sex** as a filter.","1575f457":"No null values are present:","de1c7056":"No apparent trend found even when visualising using **region** as a filter.","f62ce4b8":"# 4. Stacking Regression","c1eb2d1c":"Here we observe the following trends:\n<ol>\n    <li>People belonging to a wide range of age (18-64) found. People in their 20's is slightly more than the remaining age brackets<\/li>\n    <li>BMI is normally distributed with majority of the people falling in the range 20-40<\/li>\n    <li>Most people seem to have no children. As the number of children increases, we see fewer parents<\/li>\n    <li>Most medical bills are below 20000<\/li>\n    <li>We observe almost an equal number of representation of males and females paying billing. The number of smokers are significantly less, which is surprising<\/li>\n    <li>All regions seems to have an equal representation except southeast which is slightly higher<\/li>\n<\/ol>"}}