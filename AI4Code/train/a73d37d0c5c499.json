{"cell_type":{"4ef03159":"code","c46e3c5d":"code","6b8d86d9":"code","f8f01cbd":"code","07a8eeb5":"code","781dbe37":"code","929a7c53":"code","3c1ece76":"code","d3234067":"code","4f92d151":"code","4b0f24ce":"code","5348c60e":"code","36d229f3":"code","aeedd037":"code","ac7fd7da":"code","702d23e3":"code","2bf0d675":"code","06bd23c9":"code","582f076b":"code","bec3dfac":"code","8c88756e":"code","4f9d277c":"code","9e9f5733":"code","c730da62":"code","8f892bce":"code","67eac91d":"code","4b38f13d":"code","592314d7":"code","a8bae42a":"code","780e8dd3":"code","782a7e43":"code","46214f9b":"code","86d7ad3b":"code","a42fabbd":"code","2aa8e904":"code","ea374c1c":"code","bdecf429":"code","8e902bb4":"code","4807c330":"code","d16b07a4":"code","1f4e064f":"code","fdb12285":"code","fa5b3362":"code","fd5ac434":"code","809a97c4":"code","f8db3ba0":"code","c813b992":"code","d8e28a72":"code","5c10eda0":"code","f660fa1f":"code","253a2687":"code","839412ed":"code","e4e6319d":"code","40073155":"code","9ec033a0":"code","e4c9c95b":"code","e7ca56e5":"code","07b67c73":"code","ff6519f0":"code","1a18186e":"code","b9141a55":"markdown","9647697c":"markdown","a08f52dd":"markdown","de5b657a":"markdown","aa1376d9":"markdown","a442a337":"markdown","0f79e54c":"markdown","effdd011":"markdown","eab7c1f3":"markdown","9e638f6b":"markdown","2504c80b":"markdown","8b8e7281":"markdown","95f0374c":"markdown","70e1658a":"markdown"},"source":{"4ef03159":"import pandas as pd\nimport sklearn\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import accuracy_score\nfrom sklearn import preprocessing","c46e3c5d":"adult_data = pd.read_csv(\"\/kaggle\/input\/ucirepository\/adult_data.csv\",\n        names=[\n        \"Age\", \"Workclass\", \"fnlwgt\", \"Education\", \"Education-Num\", \"Martial Status\",\n        \"Occupation\", \"Relationship\", \"Race\", \"Sex\", \"Capital Gain\", \"Capital Loss\",\n        \"Hours per week\", \"Country\", \"Target\"],\n        sep=r'\\s*,\\s*',\n        engine='python',\n        na_values=\"?\")","6b8d86d9":"adult_test = pd.read_csv(\"\/kaggle\/input\/ucirepository\/adult_data.csv\",\n        names=[\n        \"Age\", \"Workclass\", \"fnlwgt\", \"Education\", \"Education-Num\", \"Martial Status\",\n        \"Occupation\", \"Relationship\", \"Race\", \"Sex\", \"Capital Gain\", \"Capital Loss\",\n        \"Hours per week\", \"Country\", \"Target\"],\n        sep=r'\\s*,\\s*',\n        engine='python',\n        na_values=\"?\")","f8f01cbd":"adult_data.shape","07a8eeb5":"adult_test.shape","781dbe37":"adult_data[\"Country\"].value_counts()","929a7c53":"adult_data[\"Age\"].plot(kind=\"hist\",bins=73)","3c1ece76":"adult_data[\"Sex\"].value_counts().plot(kind=\"bar\")","d3234067":"adult_data[\"Target\"].value_counts().plot(kind=\"bar\")","4f92d151":"adult_data[\"Race\"].value_counts().plot(kind=\"bar\")","4b0f24ce":"adult_data","5348c60e":"adult_test","36d229f3":"adult_data.isnull().sum()","aeedd037":"adult_test.isnull().sum()","ac7fd7da":"adult_dt = adult_data.dropna()","702d23e3":"adult_tst = adult_test.dropna()","2bf0d675":"adult_dt.shape","06bd23c9":"adult_tst.shape","582f076b":"adult_dt.describe()","bec3dfac":"cols = ['Age', 'Capital Loss', 'Capital Gain', 'Education-Num', 'fnlwgt', 'Hours per week']\nsns.set()\nsns.pairplot(adult_dt, vars = cols, hue = 'Target')","8c88756e":"def freq(column):\n    return column*100\/\/float(column[-1])","4f9d277c":"Income_Country = pd.crosstab(adult_dt.Target, adult_dt.Country, margins=True)\nIncome_Country.apply(freq, axis=0)","9e9f5733":"Income_Sex = pd.crosstab(adult_dt.Target, adult_dt.Sex, margins=True)\nIncome_Sex.apply(freq, axis=0)","c730da62":"Income_Race = pd.crosstab(adult_dt.Target, adult_dt.Race, margins=True)\nIncome_Race.apply(freq, axis=0)","8f892bce":"Income_Sex.apply(freq, axis=0).plot(kind=\"bar\")","67eac91d":"Income_Race.apply(freq, axis=0).plot(kind=\"bar\")","4b38f13d":"Xadult = adult_dt[[\"Age\",\"Education-Num\",\"Capital Gain\", \"Capital Loss\", \"Hours per week\"]]","592314d7":"Yadult = adult_dt.Target","a8bae42a":"XtestAdult = adult_tst[[\"Age\",\"Education-Num\",\"Capital Gain\", \"Capital Loss\", \"Hours per week\"]]","780e8dd3":"YtestAdult = adult_tst.Target","782a7e43":"knn = KNeighborsClassifier(n_neighbors=3)","46214f9b":"scores = cross_val_score(knn, Xadult, Yadult, cv=10)","86d7ad3b":"scores","a42fabbd":"knn.fit(Xadult,Yadult)","2aa8e904":"YtestPred = knn.predict(XtestAdult)","ea374c1c":"YtestPred","bdecf429":"accuracy_score(YtestAdult,YtestPred)","8e902bb4":"nAdult_dt = adult_dt.apply(preprocessing.LabelEncoder().fit_transform)","4807c330":"nAdult_tst = adult_tst.apply(preprocessing.LabelEncoder().fit_transform)","d16b07a4":"Xadult = nAdult_dt.iloc[:,0:14]","1f4e064f":"Yadult = nAdult_dt.Target","fdb12285":"XtestAdult = nAdult_tst.iloc[:,0:14]","fa5b3362":"YtestAdult = nAdult_tst.Target","fd5ac434":"knn = KNeighborsClassifier(n_neighbors=30)","809a97c4":"scores = cross_val_score(knn, Xadult, Yadult, cv=10)","f8db3ba0":"scores","c813b992":"knn.fit(Xadult,Yadult)","d8e28a72":"YtestPred = knn.predict(XtestAdult)","5c10eda0":"YtestPred","f660fa1f":"accuracy_score(YtestAdult,YtestPred)","253a2687":"Xadult = nAdult_dt[[\"Age\", \"Workclass\", \"Education-Num\", \n        \"Occupation\", \"Race\", \"Sex\", \"Capital Gain\", \"Capital Loss\",\n        \"Hours per week\"]]","839412ed":"XtestAdult = nAdult_tst[[\"Age\", \"Workclass\", \"Education-Num\", \n        \"Occupation\", \"Race\", \"Sex\", \"Capital Gain\", \"Capital Loss\",\n        \"Hours per week\"]]","e4e6319d":"knn = KNeighborsClassifier(n_neighbors=30)","40073155":"knn.fit(Xadult,Yadult)","9ec033a0":"KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',\n           metric_params=None, n_jobs=1, n_neighbors=30, p=2,\n           weights='uniform')","e4c9c95b":"YtestPred = knn.predict(XtestAdult)","e7ca56e5":"accuracy_score(YtestAdult,YtestPred)","07b67c73":"df_out = pd.DataFrame({'income':YtestPred})","ff6519f0":"df_out.head()","1a18186e":"df_out.to_csv(\"submission.csv\", index = True, index_label = 'Id')","b9141a55":"Como pa\u00eds, ocupa\u00e7\u00e3o e a classe de trabalho s\u00e3o informa\u00e7\u00f5es que, de modo empirico, sabemos ter grande impacto nos rendimentos, al\u00e9m de os dados faltantes serem uma parcela pequena das linhas, n\u00e3o faz sentido retirar essas colunas. Vamos a principio seguir o exemplo do prof.\u00ba Cozman e eliminar essas linhas.","9647697c":"Vamos fazer a transforma\u00e7\u00e3o num\u00e9rica das vari\u00e1veis n\u00e3o num\u00e9ricas:","a08f52dd":"Pelo gr\u00e1fico acima, podemos ver a tend\u00eancia de brancos e asi\u00e1ticos de ganharem mais que pessoas de outras etnias. ","de5b657a":"Carregamento das bases adult de treino e testes, que foram obtidas no UCI repository, pois estava enfrentando alguns problemas com a base dispon\u00edvel no Kaggle.","aa1376d9":"Avaliando o tamanho das bases:","a442a337":"J\u00e1 \u00e9 poss\u00edvel ver que ambas as bases apresentam dados faltantes.","0f79e54c":"Com as informa\u00e7\u00f5es acima, podemos concluir que o franceses e taiwaneses recebem melhor, enquanto colombianos e dominicanos tem a maior propor\u00e7\u00e3o de baixos sal\u00e1rios.","effdd011":"Para descobrir onde e quanto s\u00e3o os dados faltantes:","eab7c1f3":"Podemos considerar que a base de dados \u00e9 majoritariamente composta por homens, brancos, americanos, jovens (20 - 40 anos) e com remunera\u00e7\u00e3o <=50K anual.","9e638f6b":"Podemos ver pelo gr\u00e1fico acima que mulheres tem a tend\u00eancia de ganhar menos que homens.","2504c80b":"Come\u00e7ando pela importa\u00e7\u00e3o dos pacotes necess\u00e1rios:","8b8e7281":"PMR3508 - Aprendizado de M\u00e1quina e Reconhecimento de Padr\u00f5es\n\nTestando kNN com a base adult","95f0374c":"J\u00e1 que o mesmo resultado foi atingido, a partir de agora testaremos mudan\u00e7as para analisar os dados.","70e1658a":"Realizando os mesmos passos para testar o procedimento:"}}