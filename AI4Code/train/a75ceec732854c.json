{"cell_type":{"5e5ab5b9":"code","c7e4635d":"code","984ccc78":"code","ff97fd89":"code","5d21a8bd":"code","acc6373a":"code","bd548ab1":"code","a74a851e":"code","e05b6c1d":"code","dc58d7b8":"code","a84c5ac2":"code","d74bf9d7":"code","7fa65237":"code","e367e7a7":"code","23f3f469":"markdown"},"source":{"5e5ab5b9":"#Import python packages\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt","c7e4635d":"#Import dataset\ndf_gold=pd.read_csv('..\/input\/learn-time-series-forecasting-from-gold-price\/gold_price_data.csv')","984ccc78":"print(\"Number of rows and columns:\", df_gold.shape)\ndf_gold.head(5)","ff97fd89":"df_gold.columns","5d21a8bd":"df_gold['Value'].mean(), df_gold['Value'].median()","acc6373a":"import plotly.graph_objs as go \nimport plotly.offline as pyo","bd548ab1":"fig = go.Figure(\n   data=[\n       go.Scatter(\n           x=df_gold['Date'],\n           y=df_gold['Value'],\n           mode='lines+markers+text',\n           line=dict(\n             color='#3498db',\n             width=4\n         )\n       )\n   ],\n   layout=go.Layout(\n       title='Gold Value Across Years',\n       paper_bgcolor='rgba(0,0,0,0)',\n       plot_bgcolor='rgba(0,0,0,0)',\n       xaxis = dict(\n                   showgrid = True,\n                   showline = True,\n                   ),\n       yaxis = dict(\n                    showgrid = True,\n                    showline = True,\n                    )\n                    )\n)\npyo.iplot(fig)","a74a851e":"# Select only the important features i.e. the date and price\ndata = df_gold[[\"Date\",\"Value\"]] # select Date and Price\n# Rename the features: These names are NEEDED for the model fitting\ndata = data.rename(columns = {\"Date\":\"ds\",\"Value\":\"y\"}) #renaming the columns of the dataset\ndata.head(5)","e05b6c1d":"data.describe()","dc58d7b8":"# FB Prophet Model for predictionsfrom fbprophet import Prophet\nfrom fbprophet import Prophet\n\nm = Prophet(daily_seasonality = True) # the Prophet class (model)\nm.fit(data) # fit the model using all data","a84c5ac2":"future_price = m.make_future_dataframe(periods=365) #we need to specify the number of days in future\nprediction = m.predict(future_price)\nm.plot(prediction)\nplt.title(\"Prediction of the Gold Price using the FB Prophet\")\nplt.xlabel(\"Date\")\nplt.ylabel(\"Value\")\nplt.show()","d74bf9d7":"#### Improving the Model\nm_2 = Prophet(n_changepoints=20, yearly_seasonality=True)\nm_2.fit(data) # fit the model using all data","7fa65237":"future_price = m_2.make_future_dataframe(periods=365) #we need to specify the number of days in future\nprediction = m_2.predict(future_price)\nm.plot(prediction)\nplt.title(\"Prediction of the Gold Price using the FB Prophet\")\nplt.xlabel(\"Date\")\nplt.ylabel(\"Value\")\nplt.show()","e367e7a7":"#End","23f3f469":"***Visualizing with trend***"}}