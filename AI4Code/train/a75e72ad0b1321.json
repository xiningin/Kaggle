{"cell_type":{"b472a60e":"code","5a91b45a":"code","71b2909f":"code","9cd02796":"code","de02533f":"code","11e6e6a5":"code","88ec6c9b":"code","cf2a253f":"code","5dd759df":"code","aa878aa5":"code","da2012bf":"code","a1f849ee":"code","d9782b34":"code","67b2e90c":"code","44266785":"code","64ab1c67":"code","cf4f15b0":"code","d944c166":"code","76c907b1":"code","5f277bbd":"code","df434983":"code","f0e45482":"code","69394f08":"markdown","fe970f4a":"markdown","1e3d2fb5":"markdown","839598ad":"markdown","5f0c3817":"markdown","a86bce4b":"markdown","c7853e87":"markdown","334b9552":"markdown","b199bbb2":"markdown","441e64e4":"markdown","4d2ee6ec":"markdown","8f5db3cf":"markdown","7d61084f":"markdown","7118cc8f":"markdown","9cf4fca1":"markdown","21a90849":"markdown","67e69898":"markdown","0d6bad19":"markdown"},"source":{"b472a60e":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","5a91b45a":"import pandas as pd\n\n\ncsv_train_data = pd.read_csv(\"\/kaggle\/input\/jigsaw-toxic-comment-classification-challenge\/train.csv.zip\")\ncomments = csv_train_data[\"comment_text\"]\ny_train = csv_train_data[[\"toxic\",\n                          \"severe_toxic\",\n                          \"obscene\",\n                          \"threat\",\n                          \"insult\",\n                          \"identity_hate\"\n                          ]]","71b2909f":"from tensorflow.keras.preprocessing.text import *\n\n\nmy_tokenizer = Tokenizer(num_words=10000)","9cd02796":"my_tokenizer.fit_on_texts(comments)\nmy_tokenizer.word_index","de02533f":"sequences = my_tokenizer.texts_to_sequences(comments)","11e6e6a5":"sequences[1]","88ec6c9b":"from keras.preprocessing.sequence import *\n\n\nx_train = pad_sequences(sequences, 50)","cf2a253f":"x_train[::]","5dd759df":"import numpy as np\nfrom keras.preprocessing import sequence\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Activation, Embedding, SpatialDropout1D\nfrom keras.layers import LSTM\nfrom keras.datasets import imdb","aa878aa5":"model = Sequential()","da2012bf":"model.add(Embedding(10000, 128, input_length=50))\nmodel.add(SpatialDropout1D(0.5))","a1f849ee":"model.add(LSTM(40, return_sequences=True))\nmodel.add(LSTM(40))\nmodel.add(Dense(6, activation=\"sigmoid\"))\nmodel.compile(loss = 'binary_crossentropy',\n               optimizer = 'adam',\n               metrics = ['accuracy'])","d9782b34":"from keras.callbacks import *\n\n\nh5 = \"model.h5\"\nmodel_checkpoint = ModelCheckpoint(h5,\n                                   monitor=\"val_accuracy\",\n                                   save_best_only=True,\n                                   verbose=0.2)\n","67b2e90c":"model.fit(x_train,\n          y_train,\n          epochs=3,\n          batch_size=256,\n          validation_split=0.2,\n          callbacks=[model_checkpoint])","44266785":"comments_test = pd.read_csv(\"\/kaggle\/input\/jigsaw-toxic-comment-classification-challenge\/test.csv.zip\")\ncomments_labels = pd.read_csv(\"\/kaggle\/input\/jigsaw-toxic-comment-classification-challenge\/test_labels.csv.zip\")\n\ncomments_test_with_labels = pd.merge(comments_test, comments_labels, on=\"id\")\ntoxic = comments_test_with_labels[\"toxic\"]\ncomments_test_without_toxic = comments_test_with_labels\ntest_ids = comments_test.id.values","64ab1c67":"sequences_test = my_tokenizer.texts_to_sequences(comments_test_without_toxic[\"comment_text\"])\n\nx_test = pad_sequences(sequences_test, maxlen=50)\ny_test = comments_test_without_toxic[[\"toxic\", \"severe_toxic\", \"obscene\", \"threat\", \"insult\", \"identity_hate\"]]","cf4f15b0":"model.load_weights(h5)\nmodel.evaluate(x_test, y_test, verbose=0.2)","d944c166":"predict = model.predict(x_test)\npredict.shape","76c907b1":"test_ids.shape\ntest_ids.reshape(-1, 1)\nsub_df = pd.DataFrame(predict, columns=csv_train_data.columns[2:])\nsub_df[\"id\"] = test_ids\nsub_df","5f277bbd":"columns = sub_df.columns.tolist()\ncolumns = columns[-1:] + columns[:-1]\nsub_df = sub_df[columns]","df434983":"my_test_non_toxic_comment = \"Hello world!\"\nmy_test_toxic_comment = \"I will kill u!\"\nfirst_sequence = my_tokenizer.texts_to_sequences([my_test_non_toxic_comment, my_test_toxic_comment])\npad_seq = pad_sequences(first_sequence, maxlen=50)\nresult = model.predict(pad_seq)\nresult","f0e45482":"sub_df.to_csv(\"submission.csv\", index=False, header=True)","69394f08":"\u0412\u043e\u0442 \u043f\u0440\u0438\u043c\u0435\u0440 \u043e\u0434\u043d\u043e\u0433\u043e \u0442\u0430\u043a\u043e\u0433\u043e \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u044f:","fe970f4a":"\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0447\u0438\u0441\u043b\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432, \u0441\u043e\u043e\u0442\u0432\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u0441\u043b\u043e\u0432\u0443 \u0432 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0445 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u044f\u0445","1e3d2fb5":"\u0414\u0435\u043b\u0430\u0435\u043c \u0447\u0435\u043a\u043f\u043e\u0438\u043d\u0442 c \u0444\u043b\u0430\u0433\u043e\u043c save_best_only \u0434\u043b\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0441\u0430\u043c\u043e\u0439 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0439 \u044d\u043f\u043e\u0445\u0438","839598ad":"\u0417\u0430\u043f\u0438\u0448\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 csv \u0432 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e","5f0c3817":"\u041f\u0440\u043e\u0442\u0435\u0441\u0442\u0438\u0440\u0443\u0435\u043c \u043d\u0435\u0439\u0440\u043e\u0441\u0435\u0442\u044c:","a86bce4b":"\u0417\u0430\u043f\u0438\u0448\u0435\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0432 csv","c7853e87":"\u0414\u0430\u043b\u0435\u0435 \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0435\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438 lstm","334b9552":"\u041a\u043e\u043c\u043f\u0438\u043b\u0438\u0440\u0443\u0435\u043c","b199bbb2":"1.   \u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0441\u043b\u043e\u0439 \u0434\u043e\u043b\u0433\u043e-\u043a\u0440\u0430\u0442\u043a\u043e\u0441\u0440\u043e\u0447\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438\n2.   \u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u043f\u043e\u043b\u043d\u043e\u0441\u0432\u044f\u0437\u043d\u044b\u0439 \u0441\u043b\u043e\u0439 \u0438\u0437 1 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u0434\u043b\u044f \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438, \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0430\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u0431\u0443\u0434\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u0438\u0433\u043c\u043e\u0438\u0434\u0430\u043b\u044c\u043d\u0443\u044e \u0444\u0443\u043d\u043a\u0446\u0438\u044e\n3.   \u041a\u043e\u043c\u043f\u0438\u043b\u0438\u0440\u0443\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c\n\n","441e64e4":"\u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0442\u043e\u043a\u0435\u043d\u0438\u0437\u0430\u0442\u043e\u0440 \u0438 \u043e\u0431\u0443\u0447\u0430\u0435\u043c \u0435\u0433\u043e\n\n\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u0441\u043b\u043e\u0432 = 10000","4d2ee6ec":"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u043c \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0435 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438 \u0438 \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u043c \u0438\u0445 \u0441 \u0442\u0430\u0431\u043b\u0438\u0446\u0435\u0439 \u043e\u0442\u0432\u0435\u0442\u043e\u0432 \u043f\u043e id","8f5db3cf":"<a href=\"https:\/\/colab.research.google.com\/github\/UV1L\/MyFirstNeutralNetwork\/blob\/main\/NeutralNetwork.ipynb\" target=\"_parent\"><img src=\"https:\/\/colab.research.google.com\/assets\/colab-badge.svg\" alt=\"Open In Colab\"\/><\/a>","7d61084f":"\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0447\u0438\u0441\u043b\u0435\u043d\u043d\u043e\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0439 \u0434\u043b\u0438\u043d\u043e\u0439 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u044f \u0432 50 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432","7118cc8f":"\u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u043c \u0432 \u0447\u0438\u0441\u043b\u043e\u0432\u043e\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435","9cf4fca1":"\u041e\u0431\u0443\u0447\u0430\u0435\u043c \u043d\u0435\u0439\u0440\u043e\u043d\u043d\u0443\u044e \u0441\u0435\u0442\u044c (\u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f, \u043e\u0442\u0432\u0435\u0442\u044b \u043a \u0434\u0430\u043d\u043d\u044b\u043c \u0434\u043b\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f, \u0447\u0438\u0441\u043b\u043e \u044d\u043f\u043e\u0445 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f, \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u0435\u0446\u0435\u043d\u0437\u0438\u0439 \u043f\u043e\u0441\u043b\u0435 \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0431\u0443\u0434\u0443\u0442 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u044b \u0432\u0435\u0441\u0430,\n\u043a\u0443\u0434\u0430 \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0442\u044c \u043a\u043e\u043b\u0431\u0435\u043a)","21a90849":"\u0421\u043a\u0430\u0447\u0430\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u0441 \u0441\u043e\u0440\u0435\u0432\u043d\u043e\u0432\u0430\u043d\u0438\u044f https:\/\/www.kaggle.com\/c\/jigsaw-toxic-comment-classification-challenge","67e69898":"\u041e\u0431\u0443\u0447\u0430\u0435\u043c \u0442\u043e\u043a\u0435\u043d\u0438\u0437\u0430\u0442\u043e\u0440 \u043d\u0430 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0445 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u044f\u0445, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u044b \u0434\u043e \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438","0d6bad19":"# **[\u041c\u043e\u044f \u043f\u0435\u0440\u0432\u0430\u044f \u043d\u0435\u0439\u0440\u043e\u043d\u043a\u0430](https:\/\/)**"}}