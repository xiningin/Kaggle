{"cell_type":{"ed9f3437":"code","884ee068":"code","f0792be8":"code","d78682a0":"code","b35db0f8":"code","1e0a4495":"code","fd0c0a01":"markdown","0cb0eebf":"markdown","bc21b666":"markdown","8d673c4e":"markdown","b1911815":"markdown","acac1aba":"markdown","fc5e6952":"markdown","16cccecf":"markdown"},"source":{"ed9f3437":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport folium\nfrom folium.plugins import HeatMap, HeatMapWithTime\nfrom netCDF4 import Dataset\nimport cartopy.crs as ccrs\nimport os","884ee068":"def plot_merra_data(data, title='', date='April 2020', label=\"kg m-2\"):\n    fig = plt.figure(figsize=(16,8))\n    ax = plt.axes(projection=ccrs.Robinson())\n    ax.set_global()\n    ax.coastlines(resolution=\"110m\",linewidth=1)\n    ax.gridlines(linestyle='--',color='black')\n    plt.contourf(lons, lats, data, transform=ccrs.PlateCarree(),cmap=plt.cm.jet)\n    plt.title(f'MERRA-2 {title} levels, {date}', size=14)\n    cb = plt.colorbar(ax=ax, orientation=\"vertical\", pad=0.02, aspect=16, shrink=0.8)\n    cb.set_label(f'{label}',size=12,rotation=0,labelpad=15)\n    cb.ax.tick_params(labelsize=10)\n    plt.show()","f0792be8":"KAGGLE_PATH = \"\/kaggle\/input\/earthdata-merra2-co\/\"\nfor file in os.listdir(KAGGLE_PATH):\n    file_date = file.split(\".\")[-2]\n    print(file, file_date)\n    file_path = os.path.join(KAGGLE_PATH, file)\n    data = Dataset(file_path, more=\"r\")\n    lons = data.variables['lon'][:]\n    lats = data.variables['lat'][:]\n    time = data.variables['time'][:]\n    COCL = data.variables['COCL'][:,:,:]; COCL = COCL[0,:,:]\n    plot_merra_data(COCL, title='CO Column Burden (COCL)', date=file_date, label=\"kg m-2\")","d78682a0":"for file in os.listdir(KAGGLE_PATH):\n    file_date = file.split(\".\")[-2]\n    print(file, file_date)\n    file_path = os.path.join(KAGGLE_PATH, file)\n    data = Dataset(file_path, more=\"r\")\n    lons = data.variables['lon'][:]\n    lats = data.variables['lat'][:]\n    time = data.variables['time'][:]\n    COEM = data.variables['COEM'][:,:,:]; COEM = COEM[0,:,:]\n    plot_merra_data(COEM, title='CO Emissions (COEM)', date=file_date, label=\"kg m-2 s-1\")","b35db0f8":"for file in os.listdir(KAGGLE_PATH):\n    file_date = file.split(\".\")[-2]\n    print(file, file_date)\n    file_path = os.path.join(KAGGLE_PATH, file)\n    data = Dataset(file_path, more=\"r\")\n    lons = data.variables['lon'][:]\n    lats = data.variables['lat'][:]\n    time = data.variables['time'][:]\n    TO3 = data.variables['TO3'][:,:,:]; TO3 = TO3[0,:,:]\n    plot_merra_data(TO3, title='Total column ozon (TO3)', date=file_date)","1e0a4495":"for file in os.listdir(KAGGLE_PATH):\n    file_date = file.split(\".\")[-2]\n    print(file, file_date)\n    file_path = os.path.join(KAGGLE_PATH, file)\n    data = Dataset(file_path, more=\"r\")\n    lons = data.variables['lon'][:]\n    lats = data.variables['lat'][:]\n    time = data.variables['time'][:]\n    COSC = data.variables['COSC'][:,:,:]; COSC = COSC[0,:,:]\n    plot_merra_data(COSC, title='CO Surface Concentration  (COSC)', date=file_date, label=\"1e-9\")","fd0c0a01":"## Batch process the archive\n\n\nWe are extracting the data in the whole archive (from all files), select a certain data column and visualize it (using a utility function defined above).","0cb0eebf":"### CO COSC Surface Concentration Volume [ppbv 1e-9]","bc21b666":"### CO Column Burden [kg m-2]","8d673c4e":"### CO Emissions [kg m-2 s-1]","b1911815":"### Total column ozone [Dobsons]","acac1aba":"## Introduction\n\nWe explain here how to read and plot EARTHDATA-MERRA2 Data Files.\n\n### Data Format\n\nThe data format used is nc4. This is a version of the [NetCDF](https:\/\/en.wikipedia.org\/wiki\/NetCDF) (Network Common Data Form) data format. To read such files, we need to use [netCDF4](https:\/\/pypi.org\/project\/netCDF4\/) Python package.\n\n### External Resources\n\nOn [NASA site](file:https:\/\/disc.gsfc.nasa.gov\/information\/howto) you can find a set of instructions how to read, explore and visualize data content from EARTHDATA-MERRA2 files. Here are multiple useful resources, one example is: [How to read and plot NetCDF MERRA-2 data in Python](https:\/\/disc.gsfc.nasa.gov\/information\/howto?title=How%20to%20read%20and%20plot%20NetCDF%20MERRA-2%20data%20in%20Python).\n\n### Meaning of columns:\n\nOn [NASA site](https:\/\/gmao.gsfc.nasa.gov\/pubs\/docs\/Bosilovich785.pdf) is explained the meaning of the columns.  \n\n\n| Name | Dim | Description | Units |    \n| --- | --- | --- | --- |  \n| COCL | tyx |CO  | Column Burden kg m-2 |  \n| COEM | tyx | CO | Emission kg m-2 s-1 |\n| COLS | tyx | CO | Chemical Loss kg m-2s-1 |\n| COPD |tyx  | CO | Chemical Production kg m-2 s-1  \n| COSC | tyx | CO | Surface Concentration in ppbv 1e-9  \n| TO3 | tyx | total column ozone | Dobsons   ","fc5e6952":"## Data Preparation\n\n### Load the packages","16cccecf":"### Utility function\n\nWe define a function for plotting the MERRA2 Data."}}