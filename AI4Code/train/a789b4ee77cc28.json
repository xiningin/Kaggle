{"cell_type":{"e999475e":"code","2e41d28e":"code","97560830":"code","c67a4cb6":"code","c7a2148d":"code","db0a45f2":"code","8e8030ad":"code","9140b616":"code","0696939f":"code","dc9109da":"code","e6fe47f1":"code","07f8ff28":"code","9554bbeb":"code","9949e4b6":"code","8e8235f7":"code","8ed99baf":"code","6eb89c0b":"code","7a9df5ca":"code","fa73cf17":"code","2b226f4b":"code","ce0ed547":"code","f65d7945":"code","19155c48":"code","4e4e88bc":"code","b57002ca":"code","8ff072bd":"code","40bbf9f3":"code","9362ada9":"code","fa209179":"code","6a6548c4":"code","b7df1600":"code","6dbc4c61":"code","b17cecc7":"code","90a2bd1b":"code","35afcf5a":"code","0d017ff0":"code","962bb4b4":"code","bd663751":"code","907d6620":"code","ea884fff":"markdown","c0f78ce0":"markdown","20ffb813":"markdown","6d3a21dc":"markdown","293ac9a2":"markdown","fec3f86a":"markdown","3e19d6f3":"markdown","18a412f6":"markdown","3e9cc0b0":"markdown","89910809":"markdown","ab38be06":"markdown","3a2fba2e":"markdown"},"source":{"e999475e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt # data visualization library\n%matplotlib inline\nimport seaborn as sns # interactive visualization library built on top on matplotlib\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.\ndf1 = pd.read_csv('\/kaggle\/input\/train.csv') # importing training data","2e41d28e":"df1.head() #checking the head of the data","97560830":"#Missing Values If Any\ndf1.isna().sum()","c67a4cb6":"print(len(df1[df1.label == 0]), 'Non-Hatred Tweets')\nprint(len(df1[df1.label == 1]), 'Hatred Tweets')\n# Class distribution in this data seems to be imbalanced.\n# F1 score should be used fot model performance evaluation in such situation. ","c7a2148d":"#importing different libraries for analysis, processing and classification\nimport nltk\nfrom sklearn import re #regular expression for text processing\nfrom nltk.corpus import stopwords\nfrom nltk.stem import WordNetLemmatizer #word stemmer class\nlemma = WordNetLemmatizer()\nfrom wordcloud import WordCloud, STOPWORDS\nfrom nltk import FreqDist \n# vectorizer \nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression #classification model\nfrom sklearn.metrics import confusion_matrix, classification_report, f1_score # performance evaluation criteria","db0a45f2":"def normalizer(tweet):\n    tweets = \" \".join(filter(lambda x: x[0]!= '@' , tweet.split()))\n    tweets = re.sub('[^a-zA-Z]', ' ', tweets)\n    tweets = tweets.lower()\n    tweets = tweets.split()\n    tweets = [word for word in tweets if not word in set(stopwords.words('english'))]\n    tweets = [lemma.lemmatize(word) for word in tweets]\n    tweets = \" \".join(tweets)\n    return tweets\n","8e8030ad":"df1['normalized_text'] = df1.tweet.apply(normalizer)","9140b616":"def extract_hashtag(tweet):\n    tweets = \" \".join(filter(lambda x: x[0]== '#', tweet.split()))\n    tweets = re.sub('[^a-zA-Z]',' ',  tweets)\n    tweets = tweets.lower()\n    tweets = [lemma.lemmatize(word) for word in tweets]\n    tweets = \"\".join(tweets)\n    return tweets","0696939f":"df1['hashtag'] = df1.tweet.apply(extract_hashtag)","dc9109da":"df1.head()","e6fe47f1":"# all tweets \nall_words = \" \".join(df1.normalized_text)\n#print(all_all_words)\n","07f8ff28":"#Hatred tweets\nhatred_words = \" \".join(df1[df1['label']==1].normalized_text)\n#print(hatred_words)","9554bbeb":"wordcloud = WordCloud(height=2000, width=2000, stopwords=STOPWORDS, background_color='white')\nwordcloud = wordcloud.generate(all_words)\nplt.imshow(wordcloud)\nplt.axis('off')\nplt.show()","9949e4b6":"wordcloud = WordCloud(height=2000, width=2000, stopwords=STOPWORDS, background_color='white')\nwordcloud = wordcloud.generate(hatred_words)\nplt.imshow(wordcloud)\nplt.axis('off')\nplt.show()","8e8235f7":"freq_all_hashtag = FreqDist(list((\" \".join(df1.hashtag)).split())).most_common(10)\nfreq_all_hashtag","8ed99baf":"freq_hatred_hashtag = FreqDist(list((\" \".join(df1[df1['label']==1]['hashtag'])).split())).most_common(10)\nfreq_hatred_hashtag","6eb89c0b":"df_allhashtag = pd.DataFrame(freq_all_hashtag, columns=['words', 'frequency'])\ndf_hatredhashtag = pd.DataFrame(freq_hatred_hashtag, columns=['words', 'frequency'])\nprint(df_allhashtag.head())\nprint(df_allhashtag.head())","7a9df5ca":"sns.barplot(x='words', y='frequency', data=df_allhashtag)\nplt.xticks(rotation = 45)\nplt.title('hashtag words frequency')\nplt.show()","fa73cf17":"sns.barplot(x='words', y='frequency', data=df_hatredhashtag)\nplt.xticks(rotation = 45)\nplt.title('hatred hashtag frequency')\nplt.show()","2b226f4b":"# to create sparse matrix corpus is created to pass to vectorizer\nlen(df1)\ncorpus = []\nfor i in range(0,31962):\n    corpus.append(df1['normalized_text'][i])\n#corpus","ce0ed547":"cv = CountVectorizer(stop_words=stopwords.words('english'))\ncv.fit(corpus)","f65d7945":"# creating dense matrix\nX = cv.transform(corpus).toarray()\ny = df1.iloc[:,1].values","19155c48":"# train test split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","4e4e88bc":"\nclassifier1 = LogisticRegression(C=10)\nclassifier1.fit(X_train, y_train)\n","b57002ca":"y_pred = classifier1.predict(X_test)\ny_prob = classifier1.predict_proba(X_test)","8ff072bd":"print(f1_score(y_test, y_pred))\nprint(classification_report(y_test, y_pred))\nprint(confusion_matrix(y_test, y_pred))","40bbf9f3":"tfidf = TfidfVectorizer(ngram_range=(1,3), min_df=10, stop_words=stopwords.words('english'))\nX1 = tfidf.fit_transform(corpus)","9362ada9":"X1_train, X1_test, y1_train, y1_test = train_test_split(X1, y, test_size=0.33, random_state=42)\nclassifier2 = LogisticRegression(C=10)\nclassifier2.fit(X1_train, y1_train)","fa209179":"y1_pred = classifier2.predict(X1_test)\ny1_prob = classifier2.predict_proba(X1_test)","6a6548c4":"print(f1_score(y1_test, y1_pred))\nprint(classification_report(y1_test, y1_pred))\nprint(confusion_matrix(y1_test, y1_pred))","b7df1600":"threshold = np.arange(0.1,0.9,0.1)\nscore = [f1_score(y1_test, ((y1_prob[:,1] >= x).astype(int))) for x in threshold]","6dbc4c61":"plt.plot(threshold, score)\nplt.xlabel('Threshold Probability')\nplt.ylabel('F1 score')\nplt.show()","b17cecc7":"df2 = pd.read_csv('\/kaggle\/input\/test.csv')\ndf2.head()","90a2bd1b":"df2['normalized_text'] = df2['tweet'].apply(normalizer)\n","35afcf5a":"# creating corpus\ncorpus_test = []\nfor i in range(0,17197):\n    corpus_test.append(df2.normalized_text[i])\n#corpus_test","0d017ff0":"Test_X = tfidf.transform(corpus_test)","962bb4b4":"pred_Y = classifier2.predict(Test_X)\nprob_Y = classifier2.predict_proba(Test_X)","bd663751":"df2['pred_label'] = pred_Y\nscores = (prob_Y[:,1] >= 0.5).astype(int)\ndf2['score'] = scores\n","907d6620":"df2[df2.pred_label == 1]","ea884fff":"**Extracting words with hashtag for further analysis**","c0f78ce0":"**Preprocessing**","20ffb813":"**Classification**\n\n**Logistic Regression (Linear Model)******","6d3a21dc":"**Analysing Hashtag words**\n\n**plotting the most common hashtag used in tweets**\n**all hashtag \nhatred hashtag**","293ac9a2":"**It can be seen that our model performed quiet good on the test data as well and made a quiet good prediction on class labels, this performance can probably be enhanced if we use SVM linear classifier which more powerfull than Logistic Regression and is also a good classifier for sentiment analysis.**","fec3f86a":"**Preprocessing the tweet column**","3e19d6f3":"**hatred tweets cloudword**","18a412f6":"**a maximum f1 score of 0.63 is achieved at threshold of 0.5 \nthus tweet with probability greater than or equal to 0.5 will be classified as hatred\nsince class distribution is imabalance we cannot use accurace as model performance evaluation method.**","3e9cc0b0":"**checking with TF-IDF vectorizer**\n*** Unigram, bi gram is used wih min_df = 10*******","89910809":"**All tweets cloudword**","ab38be06":"**performing classification model on our test data** ","3a2fba2e":"**To Create Cloud of words for all words and hatred words**"}}