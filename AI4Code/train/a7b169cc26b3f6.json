{"cell_type":{"bed2fa8e":"code","ef07dac0":"code","20001ccc":"code","cc0b49d7":"code","38199f52":"code","a97dd280":"code","6d3e9fda":"code","9b9528d9":"code","5d9a8392":"code","ff498c2d":"code","37765b75":"code","ca6a3b84":"code","8bf2efb6":"code","d0ba65b3":"code","720dd1dc":"code","a6171813":"code","3ac62108":"code","b73bcadd":"code","98313de2":"code","eac7e049":"code","88e8390b":"code","0dd4e2b5":"code","675b60fc":"code","9a55d00a":"code","37f4c4cf":"code","16f96305":"code","2662b15e":"code","bf35c131":"code","16753d17":"code","f6cac3ae":"code","c63f9746":"code","aa58c313":"code","37b9444d":"code","556332d3":"code","33445f40":"code","f62bfff9":"code","0eaa81ef":"code","8757cb19":"code","7bdc8465":"code","4df9bc39":"code","16c3905d":"code","259016a1":"code","7adab053":"code","21366477":"code","e1822589":"code","9ed17879":"code","1091fc81":"code","317f64e8":"code","80fb5874":"code","f3f09b3f":"code","1383de9b":"code","37013ade":"code","e4889e77":"code","5ef4ac2b":"code","b6ac323a":"code","1b2411a3":"code","53109c44":"code","88e9df8e":"code","b92873dd":"code","c99c5bec":"code","6c3b2421":"code","c0d59e4e":"code","c8c9b989":"code","09bb5458":"code","3a950c10":"code","50ad5143":"code","018b7d70":"code","806f9c3b":"code","c17c850c":"code","9c14b525":"code","6d19a5f8":"code","e4db9167":"markdown","4776e3da":"markdown","fcc7c58c":"markdown","e8f9c4fe":"markdown","804e10b9":"markdown","f0e2c41e":"markdown","9f7ed61e":"markdown"},"source":{"bed2fa8e":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","ef07dac0":"Netflix_data = pd.read_csv('..\/input\/netflix-shows\/netflix_titles.csv')\nNetflix_data.head()","20001ccc":"Netflix_data.shape","cc0b49d7":"Netflix_data.info()","38199f52":"Netflix_data.isnull().sum()","a97dd280":"Netflix_data.type.value_counts()","6d3e9fda":"import copy\nNetflix_Movie_data = copy.deepcopy(Netflix_data[Netflix_data.type == 'Movie'])\nNetflix_Shows_data = copy.deepcopy(Netflix_data[~(Netflix_data.type == 'Movie')])","9b9528d9":"Netflix_Movie_data.head()","5d9a8392":"Netflix_Movie_data.isnull().sum()","ff498c2d":"Netflix_Movie_data.duration.value_counts()[:1]","37765b75":"Netflix_Movie_data.duration.fillna('90 min',inplace=True)","ca6a3b84":"Netflix_Movie_data.rating.value_counts()","8bf2efb6":"Netflix_Movie_data.rating.fillna('TV-PG',inplace=True)","d0ba65b3":"Netflix_Movie_data.loc[Netflix_Movie_data.query('rating in [\"84 min\",\"66 min\",\"74 min\"]').index,'rating'] = 'TV-PG'","720dd1dc":"Netflix_Movie_data.country.value_counts()","a6171813":"Netflix_Movie_data.country.fillna('India',inplace=True)","3ac62108":"Netflix_Movie_data['country'] = Netflix_Movie_data.country.apply(lambda x: x.split(', '))","b73bcadd":"Netflix_Movie_data = Netflix_Movie_data[~Netflix_Movie_data.director.isna()]","98313de2":"Netflix_Movie_data = Netflix_Movie_data[~Netflix_Movie_data.cast.isna()]","eac7e049":"Netflix_Movie_data['director'] = Netflix_Movie_data.director.apply(lambda x: x.split(', '))","88e8390b":"Netflix_Movie_data['cast'] = Netflix_Movie_data.cast.apply(lambda x: x.split(', '))","0dd4e2b5":"Netflix_Movie_data['listed_in'] = Netflix_Movie_data.listed_in.apply(lambda x: x.split(', '))","675b60fc":"Netflix_Movie_data.date_added = pd.to_datetime(Netflix_Movie_data.date_added)","9a55d00a":"Netflix_Movie_data.drop(['show_id','description','type'],axis=1,inplace=True)","37f4c4cf":"Netflix_Movie_data.query('date_added.dt.year != release_year').head()","16f96305":"Netflix_Movie_data.drop(['release_year'],axis=1,inplace=True)","2662b15e":"Netflix_Movie_data['duration_in_min'] = Netflix_Movie_data.duration.apply(lambda x: x.split(' ')[0])","bf35c131":"Netflix_Movie_data.drop(['duration'],axis=1,inplace=True)","16753d17":"Netflix_Movie_data.set_index('date_added',drop=True,inplace=True)","f6cac3ae":"Netflix_Movie_data.head()","c63f9746":"Netflix_Movie_data.sort_index(inplace=True)","aa58c313":"Netflix_Movie_data.duration_in_min = Netflix_Movie_data.duration_in_min.astype('int')","37b9444d":"Netflix_Movie_data.head()","556332d3":"Netflix_Movie_data.rating.value_counts()","33445f40":"Little_Kids_CT = ['G','TV-Y','TV-G']\nOlder_Kids_CT = ['PG','TV-Y7','TV-Y7-FV','TV-PG']\nTeens_CT = ['PG-13','TV-14','TV-G']\nMature_CT = ['R','NC-17','TV-MA','NR','UR']\nRating_List = {'Little_Kids':Little_Kids_CT,'Older_Kids':Older_Kids_CT,\n               'Teens':Teens_CT,'Mature':Mature_CT}","f62bfff9":"for rating_nm,rating_ls in Rating_List.items():\n  print(rating_nm,rating_ls)","0eaa81ef":"for rating_nm,rating_ls in Rating_List.items():\n  Netflix_Movie_data.loc[Netflix_Movie_data.query('rating in @rating_ls').index,'rating'] = rating_nm","8757cb19":"Netflix_Movie_data['release_year'] = Netflix_Movie_data.index.year\nNetflix_Movie_data['release_quarter'] = Netflix_Movie_data.index.quarter\nNetflix_Movie_data['release_month'] = Netflix_Movie_data.index.month_name()","7bdc8465":"Netflix_Movie_data.head()","4df9bc39":"import warnings\nwarnings.filterwarnings('ignore')","16c3905d":"sns.countplot(Netflix_Movie_data['rating'],order=Netflix_Movie_data['rating'].value_counts().index,palette='rocket')\nplt.title('Count of movie ratings available on netflix')\nplt.show()","259016a1":"plt.figure(figsize=(15,6))\nsns.barplot(data=Netflix_Movie_data.groupby(['release_year','rating'],as_index=False).title.count(),x='release_year',y='title',hue='rating')\nplt.xlabel('Year')\nplt.ylabel('Ratings')\nplt.title('Year wise Movies Ratings')\nplt.legend(loc='upper left')\nplt.show()","7adab053":"Netflix_Movie_data.release_year.value_counts().sort_index()","21366477":"import copy\nNetflix_Movie_17_21_data = copy.deepcopy(Netflix_Movie_data.loc['2017':'2021'])","e1822589":"Netflix_Movie_17_21_data.rating = pd.Categorical(Netflix_Movie_17_21_data.rating, \n                      categories=[\"Little_Kids\",\"Teens\",\"Older_Kids\",\"Mature\"],\n                      ordered=True)","9ed17879":"Netflix_Movie_17_21_data.shape","1091fc81":"sns.countplot(Netflix_Movie_17_21_data['rating'],order=Netflix_Movie_17_21_data['rating'].value_counts().index,palette='rocket')\nplt.title('Count of movie ratings available on netflix')\nplt.show()","317f64e8":"plt.figure(figsize=(15,6))\nsns.barplot(data=Netflix_Movie_17_21_data.groupby(['release_year','rating'],as_index=False).title.count(),x='release_year',y='title',hue='rating')\nplt.xlabel('Year')\nplt.ylabel('Ratings')\nplt.title('Year wise movies rating category count')\nplt.legend(loc='upper left')\nplt.show()","80fb5874":"plt.figure(figsize=(15,6))\nsns.barplot(data=Netflix_Movie_17_21_data.groupby(['release_quarter','rating'],as_index=False).title.count(),x='release_quarter',y='title',hue='rating')\nplt.xlabel('Quarter')\nplt.ylabel('Ratings')\nplt.title('Quarter wise movies rating category count')\nplt.legend(loc='upper left')\nplt.show()","f3f09b3f":"plt.figure(figsize=(15,6))\nsns.barplot(data=Netflix_Movie_17_21_data.groupby(['release_month','rating'],as_index=False).title.count(),x='release_month',y='title',hue='rating')\nplt.xlabel('Month')\nplt.ylabel('Ratings')\nplt.title('Month wise movies rating category count')\nplt.legend(loc='upper left')\nplt.show()","1383de9b":"plt.figure(figsize=(15,6))\nsns.barplot(data=Netflix_Movie_17_21_data.groupby(['release_year','rating'],as_index=False).duration_in_min.sum(),x='release_year',y='duration_in_min',hue='rating')\nplt.xlabel('Year')\nplt.ylabel('Duration')\nplt.title('Year wise rating duration')\nplt.legend(loc='upper left')\nplt.show()","37013ade":"Netflix_Movie_17_21_data.director.apply(pd.Series).stack().value_counts()[:10].plot.pie(figsize=(15,6),autopct='%1.1f%%',fontsize=15, shadow=True)\nplt.title('Top 10 director with most movies from year 2017-2021',fontsize=18)\nplt.show()","e4889e77":"Netflix_Movie_17_21_data.cast.apply(pd.Series).stack().value_counts()[:10].plot.pie(figsize=(15,6),autopct='%1.1f%%',fontsize=15, shadow=True)\nplt.title('Top 10 Actors with most movies from year 2017-2021',fontsize=18)\nplt.show()","5ef4ac2b":"Netflix_Movie_17_21_data.country.apply(pd.Series).stack().value_counts()[:10].plot.pie(figsize=(15,6),autopct='%1.1f%%',fontsize=12, shadow=True,labeldistance=1.2)\nplt.title('Top 10 country with most movies from year 2017-2021',fontsize=18)\nplt.show()","b6ac323a":"Netflix_Movie_17_21_data.listed_in.apply(pd.Series).stack().value_counts()[:10].plot.pie(figsize=(15,6),autopct='%1.1f%%',fontsize=12, shadow=True,labeldistance=1.3)\nplt.title('Top 10 type of movies from year 2017-2021',fontsize=18)\nplt.show()","1b2411a3":"Netflix_Movie_17_21_data.head()","53109c44":"top_10_director = list(Netflix_Movie_17_21_data.director.apply(pd.Series).stack().value_counts()[:10].index)\ntop_10_cast = list(Netflix_Movie_17_21_data.cast.apply(pd.Series).stack().value_counts()[:10].index)\ntop_10_country = list(Netflix_Movie_17_21_data.country.apply(pd.Series).stack().value_counts()[:10].index)\ntop_10_listed_in = list(Netflix_Movie_17_21_data.listed_in.apply(pd.Series).stack().value_counts()[:10].index)","88e9df8e":"top_10_cast_rating_dict = {}\n\nfor cast_nm in top_10_cast:\n  top_10_cast_rating_dict[cast_nm] = Netflix_Movie_17_21_data[Netflix_Movie_17_21_data.cast.apply(pd.Series).values == cast_nm].groupby(['rating']).title.count()","b92873dd":"pd.DataFrame(top_10_cast_rating_dict).transpose()","c99c5bec":"pd.DataFrame(top_10_cast_rating_dict).transpose().plot.bar(figsize=(15,6))\nplt.title('Count of actors starred in each rating')\nplt.xlabel('Actors')\nplt.ylabel('Count of ratings')\nplt.xticks(rotation=40)\nplt.show()","6c3b2421":"top_10_cast_director_dict = {}\n\nfor director_nm in top_10_director:\n  top_10_cast_director_dict[director_nm] = Netflix_Movie_17_21_data[Netflix_Movie_17_21_data.director.apply(pd.Series).values == director_nm].groupby(['rating']).title.count()","c0d59e4e":"pd.DataFrame(top_10_cast_director_dict).transpose().plot.bar(figsize=(15,6))\nplt.title('Count of ratings made by director')\nplt.xlabel('Director')\nplt.ylabel('Count of ratings')\nplt.xticks(rotation=40)\nplt.show()","c8c9b989":"top_10_year_director_dict = {}\n\nfor _ in top_10_director:\n  top_10_year_director_dict[_] = Netflix_Movie_17_21_data[Netflix_Movie_17_21_data.director.apply(pd.Series).values == _].groupby(['release_year']).title.count()","09bb5458":"pd.DataFrame(top_10_year_director_dict).transpose().plot.bar(figsize=(15,6))\nplt.title('Count of movies made by director in each year')\nplt.xlabel('Director')\nplt.ylabel('Count of movies')\nplt.xticks(rotation=40)\nplt.show()","3a950c10":"top_10_director_duration_dict = {}\n\nfor _ in top_10_director:\n  top_10_director_duration_dict[_] = Netflix_Movie_17_21_data[Netflix_Movie_17_21_data.director.apply(pd.Series).values == _].duration_in_min.mean()","50ad5143":"pd.Series(top_10_director_duration_dict).plot.bar(figsize=(15,6),edgecolor='black')\nplt.title('Average duration of movies made by directors')\nplt.xlabel('Director')\nplt.ylabel('Average duration')\nplt.xticks(rotation=40)\nplt.show()","018b7d70":"top_10_country_rating_dict = {}\n\nfor _ in top_10_country:\n  top_10_country_rating_dict[_] = Netflix_Movie_17_21_data[Netflix_Movie_17_21_data.country.apply(pd.Series).values == _].groupby(['rating']).title.count()\n\npd.DataFrame(top_10_country_rating_dict).transpose().plot.bar(figsize=(15,6))\nplt.title('Count of ratings made each country')\nplt.xlabel('Country')\nplt.ylabel('Ratings')\nplt.xticks(rotation=40)\nplt.show()","806f9c3b":"top_10_country_duration_dict = {}\n\nfor _ in top_10_country:\n  top_10_country_duration_dict[_] = Netflix_Movie_17_21_data[Netflix_Movie_17_21_data.country.apply(pd.Series).values == _].duration_in_min.mean()\n\npd.Series(top_10_country_duration_dict).plot.bar(figsize=(15,6),edgecolor='black',color='green')\nplt.title('Average duration of movies in top 10 countries')\nplt.xlabel('Countries')\nplt.ylabel('Average duration')\nplt.xticks(rotation=40)\nplt.show()","c17c850c":"top_10_listed_in_rating_dict = {}\n\nfor _ in top_10_listed_in:\n  top_10_listed_in_rating_dict[_] = Netflix_Movie_17_21_data[Netflix_Movie_17_21_data.listed_in.apply(pd.Series).values == _].groupby(['rating']).title.count()\n\npd.DataFrame(top_10_listed_in_rating_dict).transpose().plot.bar(figsize=(15,6))\nplt.title('Count of ratings made by each movie type')\nplt.xlabel('Type of movie')\nplt.ylabel('Ratings')\nplt.xticks(rotation=40)\nplt.show()","9c14b525":"pd.DataFrame(top_10_listed_in_rating_dict).transpose()","6d19a5f8":"top_10_listed_in_duration_dict = {}\n\nfor _ in top_10_listed_in:\n  top_10_listed_in_duration_dict[_] = Netflix_Movie_17_21_data[Netflix_Movie_17_21_data.listed_in.apply(pd.Series).values == _].duration_in_min.mean()\n\npd.Series(top_10_listed_in_duration_dict).plot.bar(figsize=(15,6),edgecolor='black',color='yellow')\nplt.title('Average duration of movies in top 10 types')\nplt.xlabel('Types of movies')\nplt.ylabel('Average duration')\nplt.xticks(rotation=40)\nplt.show()","e4db9167":"Top 10 actors starred in Older Kids category movies frequently","4776e3da":"# **Analysis**","fcc7c58c":"# **Data PreProcessing**","e8f9c4fe":"In 'Children & Family Movies' no mature ratings movies were made","804e10b9":"We will be using data from 2017 to 2021 as majority of data resides in this date range.","f0e2c41e":"# **Exploratory Data Analysis 2**\n\n\n<img src='https:\/\/drive.google.com\/uc?export=view&id=1yH-BUyHr0FjvUkpqcgmcj9z_ITI9F-52' height=500 width=600>","9f7ed61e":"In above graph we can clearly see that during holidays season(4 quarter), most of films released were for Little Kids"}}