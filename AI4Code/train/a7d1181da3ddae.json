{"cell_type":{"54c8e15c":"code","c991aa8d":"code","5b92960b":"code","e954611e":"code","c0eee1e2":"code","dd0efdea":"code","22e432a3":"code","d7272236":"code","985aa4c5":"code","51fa95c2":"code","7b1a914b":"code","3ebc6d42":"code","2813b9a9":"code","5889bec5":"code","db1f2e70":"code","ef439941":"code","5e8dc3d0":"code","0623c497":"code","759eaa6b":"code","f26cc3de":"code","ea5104be":"code","319367b7":"code","c4c1b9bb":"code","1657c74c":"code","bd224341":"code","a748df48":"code","3f64a8b1":"code","cefad811":"code","2c8226d9":"code","6a50c23a":"code","223a493a":"code","629b7752":"code","f95aa587":"code","d788f308":"code","908bce45":"code","f905afdb":"code","f89f57fc":"code","4ceeaed5":"code","97fd8b16":"code","62069741":"code","2c457251":"code","0d363cf8":"code","8cbb1170":"code","d5e3da5c":"code","d24f1344":"code","7e3a6ea6":"code","ede69a19":"code","44eb3cf9":"code","55cab7c6":"code","bc7be3a9":"code","92c1d6d8":"code","e6d03cb9":"code","764f2c42":"code","905a914e":"code","91e8471e":"code","8a30f206":"code","9f4fdab7":"code","300268a5":"code","a7b67e4d":"code","4f3fee18":"code","b540a103":"code","636d8d8a":"code","331fca37":"code","5f5053b5":"code","1f8ce59a":"code","441e3115":"code","18e5fcbb":"code","122e79b4":"code","7bdc33f2":"code","c6ca5ff6":"code","4ee6ab15":"code","a3bf0044":"code","55e509cf":"code","2de2d562":"code","f3f9e9a1":"code","9c7719ad":"code","2b937740":"code","787dfada":"code","b71f308d":"code","ed635e14":"code","decc54b5":"code","f13aa7b4":"code","8ad972d5":"code","405f594d":"code","8c37e768":"markdown","d3863b79":"markdown","1964ade0":"markdown","803f4bd1":"markdown","2a9ebe26":"markdown","24904f63":"markdown","707da7c1":"markdown","184c08c1":"markdown","d0c5bdbe":"markdown","bd895c3e":"markdown","ce857a31":"markdown","c305c0ae":"markdown","08554bb3":"markdown","d565e8d2":"markdown","92105f54":"markdown","38573d8a":"markdown","cefa7521":"markdown","dc22fd3e":"markdown","ebc337d3":"markdown","c439931f":"markdown","37124bf3":"markdown","c0ff86db":"markdown","6668287a":"markdown","2d21d328":"markdown","ce094681":"markdown","5e234e06":"markdown","18f41503":"markdown","d003e52d":"markdown","6b04a0b5":"markdown","608570ae":"markdown","f05c07a1":"markdown","9af5675e":"markdown","0851015e":"markdown","ebe55853":"markdown","1fd9f34d":"markdown","52ac39ef":"markdown","7d73b2fd":"markdown","1f527565":"markdown","3b9058bb":"markdown","7268beaf":"markdown","e330c114":"markdown","6ff58667":"markdown","4b067b6e":"markdown","1645c28a":"markdown","722ed641":"markdown","0d31c1c8":"markdown","436a0615":"markdown","7e5583b9":"markdown","515f87c7":"markdown","ad107019":"markdown","347cd5ce":"markdown","0f150743":"markdown","16b37499":"markdown","29f63e69":"markdown","b2077417":"markdown","47a53a0e":"markdown","2cc04ff6":"markdown","895c4bd7":"markdown","a5b3a3b0":"markdown","b8150ff2":"markdown","bd32ac24":"markdown","a88042b1":"markdown","6a0c80fc":"markdown","df470fbc":"markdown","26a7218a":"markdown","dc5a7cd8":"markdown","c2538711":"markdown","033ce3e1":"markdown","91a1e7c7":"markdown","3e5c82d0":"markdown","21553794":"markdown","1c052fe2":"markdown","ed2c6a14":"markdown","d56deaa1":"markdown","e00b75b4":"markdown","90154950":"markdown","422897ff":"markdown","a3726bb8":"markdown","d55795a7":"markdown","81c07921":"markdown","44d0c87e":"markdown"},"source":{"54c8e15c":"import numpy as np\nimport pandas as pd \nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings(\"ignore\")\nsns.set_style(\"white\")\n\n%matplotlib inline","c991aa8d":"pd.set_option(\"display.max_rows\", None)\npd.set_option(\"display.max_columns\", None)","5b92960b":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","e954611e":"heart = pd.read_csv('\/kaggle\/input\/heart-disease-uci\/heart.csv')","c0eee1e2":"print(f\"Number of rows: {heart.shape[0]}\")\nprint(f\"Number of columns: {heart.shape[1]}\")","dd0efdea":"heart.head()","22e432a3":"heart.tail()","d7272236":"heart.sample(5)","985aa4c5":"heart.info()","51fa95c2":"heart.duplicated().sum()","7b1a914b":"duplicates = heart[heart.duplicated(keep = False)]\nduplicates","3ebc6d42":"heart.drop_duplicates(inplace = True)","2813b9a9":"heart.duplicated().sum()","5889bec5":"heart.reset_index(inplace = True, drop = True)","db1f2e70":"heart.iloc[163: 166]","ef439941":"heart[[\"sex\", \"cp\", \"fbs\", \"restecg\", \"exang\", \"slope\", \n       \"ca\", \"thal\", \"target\"]].nunique()","5e8dc3d0":"for column in heart.columns:\n    if heart[column].nunique() < 6:\n        print(f\"{column} : {heart[column].unique()}\") ","0623c497":"heart[heart['ca'] == 4].value_counts().sum()","759eaa6b":"heart[heart['thal'] == 0].value_counts().sum()","f26cc3de":"heart.replace({\"ca\" : {4: np.NaN}, \"thal\": {0: np.NaN}}, \n              inplace = True)","ea5104be":"heart.isnull().sum()","319367b7":"heart.groupby(\"target\")[\"ca\"].value_counts()","c4c1b9bb":"heart[\"ca\"].fillna(0, inplace = True)","1657c74c":"heart.groupby(\"target\")[\"thal\"].value_counts()","bd224341":"heart[heart[\"thal\"].isnull()]","a748df48":"heart.loc[[48], \"thal\"] = 2\nheart.loc[[280], \"thal\"] = 3","3f64a8b1":"heart[[\"ca\", \"thal\"]].isnull().sum()","cefad811":"heart[[\"ca\", \"thal\"]].dtypes","2c8226d9":"heart[[\"ca\", \"thal\"]] = heart[[\"ca\", \"thal\"]].astype(\"int64\")","6a50c23a":"heart[[\"ca\", \"thal\"]].dtypes","223a493a":"heart.rename(columns = {\"cp\": \"chest_pain\", \n                        \"trestbps\": \"blood_pressure\", \n                        \"chol\": \"cholesterol\", \n                        \"fbs\": \"blood_sugar\", \n                        \"restecg\": \"ecg_results\", \n                        \"thalach\": \"heart_rate\", \n                        \"exang\": \"exercise_angina\",\n                        \"oldpeak\": \"ST_depression\", \n                        \"slope\": \"ST_slope\", \n                        \"ca\": \"positive_vessels\", \n                        \"thal\": \"thallium\", \n                        \"target\": \"heart_disease\"}, \n             inplace = True)","629b7752":"heart1 = heart.copy()","f95aa587":"heart.replace({\"sex\": {0: 'female', 1: 'male'},\n              \"chest_pain\": {0: \"asymptomatic\", \n                             1: \"atypical angina\", \n                             2: \"non-angina\", 3: \"angina\"}, \n              \"ecg_results\": {0: \"hypertrophy\", \n                              1: \"normal\", 2: \"ST-T wave\"}, \n              \"ST_slope\": {0: \"downslope\", 1: \"flat\", \n                           2: \"upslope\"}, \n              \"thallium\": {1: \"fixed defect\", \n                           2: \"normal\", 3: \"reversable defect\"}}, \n              inplace = True)","d788f308":"heart.head(2)","908bce45":"percentage = round(heart[\"heart_disease\"].value_counts(normalize = True).mul(100), 1)\ncolors = [\"Lightblue\", \"Red\"]\nexplode = [0, 0.05]\n\nfig = plt.figure(figsize =(18, 5))\n\nax0 = fig.add_subplot(1, 2, 1)\nax1 = fig.add_subplot(1, 2, 2)\n\nax0 = sns.countplot(x = \"heart_disease\", data = heart, \n                    palette = colors, ax = ax0)\nax0.set_title(\"Number of Patients by Heart Disease Status\")\n\nax1 = percentage.plot(kind = \"pie\", colors = [\"red\", \"lightblue\"] , \n                      explode = explode, autopct = \"%1.1f%%\", \n                      shadow = True,figsize = (14, 4.5), \n                      labels = (\"Heart Disease\", \"Healthy\"),\n                      title = (\"Percentage of patients by\\\n                      Heart Disease Status\"))\n\nplt.subplots_adjust(wspace = 0.4)","f905afdb":"plt.figure(figsize = (12, 8))\nsns.heatmap(heart1.corr(), annot = True, cmap = \"coolwarm\")\nplt.show()","f89f57fc":"heart[[\"sex\", \"chest_pain\", \"blood_sugar\", \n       \"ecg_results\", \"exercise_angina\",\n       \"ST_slope\", \"positive_vessels\", \"heart_disease\", \n       \"thallium\"]] = heart[[\"sex\", \"chest_pain\", \n                             \"blood_sugar\", \"ecg_results\", \n                             \"exercise_angina\", \"ST_slope\", \n                             \"positive_vessels\", \n                             \"heart_disease\", \n                             \"thallium\"]].astype(\"category\")","4ceeaed5":"heart.describe().T","97fd8b16":"heart.describe(include = \"category\").T","62069741":"heart_cont_val = heart[[\"age\", \"blood_pressure\", \n                        \"cholesterol\", \"ST_depression\",\n                        \"heart_rate\", \"heart_disease\"]]\n\nsns.pairplot(heart_cont_val, hue = \"heart_disease\", \n             palette = [\"lightblue\", \"red\"])\nplt.show()","2c457251":"plt.figure(figsize = (13, 6))\n\nsns.countplot(\"age\", hue = \"heart_disease\", data = heart, \n              palette = [\"lightblue\", \"red\"])\nplt.title(\"Heart Disease by Age\")\n\nplt.show()","0d363cf8":"over_55 = (heart[\"age\"] >= 55).value_counts(normalize = True).mul(100)\nheart_older = heart[heart[\"age\"] >= 55][\"heart_disease\"].value_counts(normalize = True).mul(100)\nheart_younger = heart[heart[\"age\"] < 55][\"heart_disease\"].value_counts(normalize = True).mul(100)\n\nplt.figure(figsize = (18, 4.5))\nexplode = (0, 0.05)\n\nax0 = plt.subplot(1, 3, 1)\nax1 = plt.subplot(1, 3, 2)\nax2 = plt.subplot(1, 3, 3)\n\nax0 = over_55.plot(kind = \"pie\", shadow = True, \n                   explode = explode, autopct = \"%1.1f%%\", \n                   colors = [\"orange\", \"lightgreen\"], \n                   labels = [\"Under 55\", \"55 or over\"], \n                   title = \"Percentage of People\\\n                   Over and Under 55\", ax = ax0)\n\nax1 = heart_younger.plot(kind = \"pie\", shadow = True, \n                         explode = explode, autopct = \"%1.1f%%\", \n                         colors = [\"red\", \"lightblue\"],\n                         labels = [\"Heart Disease\", \"Healthy\"], \n                         title = \"Heart disease in Under 55\", \n                         ax = ax1)\n\nax2 = heart_older.plot(kind = \"pie\", shadow = True, \n                       explode = explode, autopct = \"%1.1f%%\", \n                       colors = [\"gold\", \"red\"],\n                       labels = [\"Healthy\", \"Heart Disease\"], \n                       title = \"Heart Disease in 55 or Over\", \n                       ax = ax2)\n\nplt.show()","8cbb1170":"plt.figure(figsize = (16, 4.5))\npercentage = heart[\"sex\"].value_counts(normalize = True).mul(100)\nexplode = [0, 0.05]\n\n\nax0 = plt.subplot(1, 2, 1)\nax1 = plt.subplot(1, 2, 2)\n\nax0 = sns.countplot(\"sex\", hue = \"heart_disease\",data = heart,\n                    palette = [\"lightblue\", \"red\"], ax = ax0)\nax0.set_title(\"Gender Distribution by Heart Disease Status\")\n\nax1 = percentage.plot(kind = \"pie\", shadow = True, \n                      colors = [\"lightblue\", \"lightgreen\"], \n                      explode = explode,\n                      autopct = \"%1.1f%%\", \n                      labels = [\"Male\", \"Female\"],\n                      title = \"Gender Distribution\")\n\nplt.show()","d5e3da5c":"hdisease_positive = heart[heart[\"heart_disease\"] == 1][\"sex\"].value_counts(normalize = True).mul(100)\nheart_diseasem = heart[heart[\"sex\"] == \"male\"][\"heart_disease\"].value_counts(normalize = True).mul(100)\nheart_diseasew = heart[heart[\"sex\"] == \"female\"][\"heart_disease\"].value_counts(normalize = True).mul(100)\nexplode = [0, 0.05]\n\nfig = plt.figure(figsize = (18, 4.5))\nax0 = plt.subplot(1, 3, 1)\nax1 = plt.subplot(1, 3, 2)\nax2 = plt.subplot(1, 3, 3)\n\nax0 = hdisease_positive.plot(kind = \"pie\", shadow = True, \n                             explode = explode, \n                             colors = [\"lightblue\", \"lightgreen\"], \n                             ax = ax0, autopct = \"%1.1f%%\", \n                             labels = [\"Male\", \"Female\"], \n                             title = \"Heart Disease by Gender\")\n\nax1 = heart_diseasem.plot(kind = \"pie\", shadow = True, \n                          explode = explode, \n                          colors = [\"lightblue\", \"red\"], \n                          ax = ax1,autopct = \"%1.1f%%\", \n                          labels = [\"Healthy\", \"Heart Disease\"], \n                          title = \"Men by Heart Disease Status\")\n\nax2 = heart_diseasew.plot(kind = \"pie\", shadow = True, \n                          explode = explode, \n                          colors = [\"red\", \"lightgreen\"], \n                          ax = ax2, autopct = \"%1.1f%%\", \n                          labels = [\"Heart Disease\",\"Healthy\"], \n                          title = \"Women by Heart Disease Status\")\n\nplt.show()\n","d24f1344":"fig = plt.figure(figsize = (16, 4.5))\ncolors = [\"lightblue\", \"red\"]\n\nax0 = plt.subplot(1, 2, 1)\nax1 = plt.subplot(1, 2, 2)\n\nsns.countplot(\"blood_sugar\", hue = \"heart_disease\", \n              data = heart, palette = colors, ax = ax0)\nax0.set_title(\"Blood Sugar Levels by Heart Disease Status\")\n\nsns.countplot(\"positive_vessels\", hue = \"heart_disease\", \n              data = heart, palette = colors)\nplt.title(\"Fluoroscopy Positive Vessels by Heart Disease Status\")\n\nplt.show()","7e3a6ea6":"fig = plt.figure(figsize = (16, 4.5))\ncolors = [\"lightblue\", \"red\"]\n\nax0 = plt.subplot(1, 2, 1)\nax1 = plt.subplot(1, 2, 2)\n\nax0 = sns.countplot(\"chest_pain\", hue = \"heart_disease\", \n                    data = heart, palette = colors, ax = ax0)\nax0.set_title(\"Type of Chest Pain by Heart Disease Status\")\n\nsns.countplot(\"exercise_angina\", hue = \"heart_disease\", \n              data = heart, palette = colors)\nax1.set_title(\"Exercise Angina by Heart Disease Status\")\n\nplt.show()","ede69a19":"plt.figure(figsize = (20, 4.5))\ncolors = [\"lightblue\", \"red\"]\n\nax0 = plt.subplot(1, 3, 1)\nax1 = plt.subplot(1, 3, 2)\nax2 = plt.subplot(1, 3, 3)\n\nsns.countplot(\"ecg_results\", hue = \"heart_disease\", \n              data = heart,  palette = colors, ax = ax0)\nax0.set_title(\"Electrocardiogram Results by Heart Disease\")\n\nsns.countplot(\"ST_slope\", hue = \"heart_disease\", \n              data = heart, palette = colors, ax = ax1)\nax1.set_title(\"ST-slope by Heart Disease\")\n\nsns.countplot(\"thallium\", hue = \"heart_disease\", \n              data = heart, palette = colors, ax = ax2)\nax2.set_title(\"Thallium Test Results by Heart Disease\")\n\nplt.show()","44eb3cf9":"plt.figure(figsize = (16, 17))\n\nax0 = plt.subplot(3, 2, 1)\nax1 = plt.subplot(3, 2, 2)\nax2 = plt.subplot(3, 2, 3)\nax3 = plt.subplot(3, 2, 4)\n\n\n\nsns.boxplot(x = \"ST_slope\", y = \"heart_rate\", \n            hue = \"heart_disease\", data = heart, \n            palette = [\"lightblue\", \"red\"], ax = ax0)\nsns.stripplot(x = \"ST_slope\", y = \"heart_rate\", \n              hue = \"heart_disease\", data = heart, \n              dodge = True, ax = ax0, jitter = 1)\nax0.set_title(\"Heart Rate by ST-slope and Heart Disease\")\n\nsns.boxplot(x = \"chest_pain\", y = \"heart_rate\", \n            hue = \"heart_disease\", data = heart, \n            palette = [\"lightblue\", \"red\"], ax = ax1)\nsns.stripplot(x = \"chest_pain\", y = \"heart_rate\", \n              hue = \"heart_disease\", data = heart, \n              dodge = True, ax = ax1, jitter = 1)\nax1.set_title(\" Heart Rate by Chest Pain and Heart Disease\")\n\nsns.boxplot(x = \"positive_vessels\", y = \"heart_rate\", \n            hue = \"heart_disease\", data = heart, \n            palette = [\"lightblue\", \"red\"], ax = ax2)\nsns.stripplot(x = \"positive_vessels\", y = \"heart_rate\", \n              hue = \"heart_disease\", data = heart, \n              ax = ax2, dodge = True, jitter = 1)\nax2.set_title(\"Heart Rate by Fluoroscopy Test and Heart Disease\")\n\nsns.violinplot(x = \"thallium\", y = \"heart_rate\", \n                     hue = \"heart_disease\", data = heart, \n                     palette = [\"lightblue\", \"red\"], ax = ax3)\nsns.stripplot(x = \"thallium\", y = \"heart_rate\", \n              hue = \"heart_disease\", \n              data = heart, ax = ax3, jitter = 1)\nax3.set_title(\"Heart Rate by Thallium Test and Heart Disease\")\n\n\nplt.subplots_adjust(hspace = 0.3)\n\nplt.show()\n","55cab7c6":"plt.figure(figsize = (16, 17))\n\nax0 = plt.subplot(3, 2, 1)\nax1 = plt.subplot(3, 2, 2)\nax2 = plt.subplot(3, 2, 3)\nax3 = plt.subplot(3, 2, 4)\n\nsns.boxplot(x = \"ST_slope\", y = \"ST_depression\", \n            hue = \"heart_disease\", data = heart, \n            palette = [\"lightblue\", \"red\"], ax = ax0)\nsns.stripplot(x = \"ST_slope\", y = \"ST_depression\", \n              hue = \"heart_disease\", data = heart, \n              ax = ax0, dodge = True, jitter = 1)\nax0.set_title(\"ST-depression by ST-slope and Heart Disease\")\n\nsns.boxplot(x = \"chest_pain\", y = \"ST_depression\", \n            hue = \"heart_disease\", data = heart, \n            palette = [\"lightblue\", \"red\"], ax = ax1)\nsns.stripplot(x = \"chest_pain\", y = \"ST_depression\", \n              hue = \"heart_disease\", data = heart, \n              ax = ax1, dodge = True, jitter = 1)\nax1.set_title(\"ST-Depression by Chest Pain and Heart Disease\")\n\nsns.boxplot(x = \"positive_vessels\", y = \"ST_depression\", \n            hue = \"heart_disease\", data = heart, \n            palette = [\"lightblue\", \"red\"], ax = ax2)\nsns.stripplot(x = \"positive_vessels\", y = \"ST_depression\",\n              hue = \"heart_disease\", data = heart, \n              ax = ax2, dodge = True, jitter = 1)\nax2.set_title(\"ST-depression by Fluoroscopy Test and Heart Disease\")\n\n\nsns.violinplot(x = \"thallium\", y = \"ST_depression\", \n               hue = \"heart_disease\", data = heart, \n               palette = [\"lightblue\", \"red\"], ax = ax3)\nsns.stripplot(x = \"thallium\", y = \"ST_depression\", \n              hue = \"heart_disease\", data = heart, \n              ax = ax3, jitter = 1)\nax3.set_title(\"ST-depression by Thallium Test and Heart Disease\")\n\n\nplt.subplots_adjust(hspace = 0.3)\n\nplt.show()","bc7be3a9":"plt.figure(figsize = (16, 5))\n\nax0 = plt.subplot(1, 2, 1)\nax1 = plt.subplot(1, 2, 2)\n\nsns.pointplot('sex', 'blood_pressure', hue = 'heart_disease', data = heart, palette =['lightblue', 'red'], ax = ax0)\nax0.set_title('Avg Blood Pressure by Gender and Heart Disease')\n\nsns.violinplot('sex', 'blood_pressure', hue = 'heart_disease', data = heart, palette =['lightblue', 'red'], \n              ax = ax1)\nsns.stripplot('sex', 'blood_pressure', hue = 'heart_disease', data = heart, ax = ax1)\nax1.set_title('Blood Pressure by Gender and Heart Disease')\n\nplt.show()","92c1d6d8":"from sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import confusion_matrix, accuracy_score, classification_report, roc_curve, roc_auc_score\nfrom sklearn.model_selection import train_test_split, cross_val_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier","e6d03cb9":"y = heart[[\"heart_disease\"]]\nX = heart.drop(\"heart_disease\", axis = 1)\n\nprint(f\"X: {X.shape}\") \nprint(f\"y: {y.shape}\") ","764f2c42":"X = pd.get_dummies(X, drop_first = True)\nX.head(2)","905a914e":"scaler = StandardScaler()","91e8471e":"X[[\"age\", \"blood_pressure\", \n   \"cholesterol\", \n   \"heart_rate\", \n   \"ST_depression\"]] = scaler.fit_transform(X[[\"age\", \n                                            \"blood_pressure\", \n                                            \"cholesterol\", \n                                            \"heart_rate\", \n                                            \"ST_depression\" ]])\nX.head()","8a30f206":"X_train, X_test, y_train, y_test = train_test_split(X, y, \n                                            test_size = 0.2, \n                                            random_state = 2)\n\n\nprint(f\"X_train: {X_train.shape}\")\nprint(f\"y_test: {y_test.shape}\")","9f4fdab7":"regr = LogisticRegression()\nregr.fit(X_train, y_train)","300268a5":"y_train_predict = regr.predict(X_train)","a7b67e4d":"sns.heatmap(confusion_matrix(y_train, y_train_predict), \n            annot = True, cmap = \"coolwarm\")\nplt.title('Confusion Matrix Train Set', size = 13)\nplt.xlabel('Predicted Values', size = 12)\nplt.ylabel('Actual Values', size = 12)\n\nplt.show()","4f3fee18":"print(classification_report(y_train, y_train_predict))","b540a103":"y_predict = regr.predict(X_test)","636d8d8a":"sns.heatmap(confusion_matrix(y_test, y_predict), annot = True, \n            cmap = \"coolwarm\")\nplt.title('Confusion Matrix Test Set', size = 13)\nplt.xlabel('Predicted Values', size = 12)\nplt.ylabel('Actual Values', size = 12)\n\nplt.show()","331fca37":"print(classification_report(y_test, y_predict))","5f5053b5":"accuracy = accuracy_score(y_test, y_predict)\nprint(f\"Logistic Regression Accuracy: {accuracy:.2f}\")","1f8ce59a":"from sklearn.metrics import roc_curve\ny_pred_proba = regr.predict_proba(X_test)[:,1]\nfpr, tpr, threshold = roc_curve(y_test, y_pred_proba)","441e3115":"sns.set_style(\"whitegrid\")\nplt.figure(figsize = (8, 5))\n\nplt.plot(fpr, tpr)\nplt.plot((0, 1), ls = '--')\nplt.xlabel(\"False Positive Rate\", size = 12)\nplt.ylabel(\"True Positive Rate\", size = 12)\nplt.title(\"Logistic Regression ROC curve\", size = 14)\nplt.show()","18e5fcbb":"auc = roc_auc_score(y_test, y_pred_proba)\nprint(f\"Logistic Regression AUC: {auc:.2f}\")","122e79b4":"accuracies = cross_val_score(estimator = regr, X = X, y = y, \n                             cv = 5)\naccuracies","7bdc33f2":"avg_accuracy = accuracies.mean()\nprint(f\"Average accuracy: {avg_accuracy:.2f}\")","c6ca5ff6":"heart1.head(2)","4ee6ab15":"Xf = heart1.drop(\"heart_disease\", axis = 1)\nyf = heart1[\"heart_disease\"]","a3bf0044":"Xf_train, Xf_test, yf_train, yf_test = train_test_split(Xf, yf, \n                                                test_size = 0.2, \n                                                random_state = 2)","55e509cf":"rdf = RandomForestClassifier(random_state = 2)\nrdf.fit(Xf_train, yf_train)","2de2d562":"yf_test_predict = rdf.predict(Xf_test)","f3f9e9a1":"sns.heatmap(confusion_matrix(yf_test, yf_test_predict), \n            annot = True, cmap = \"coolwarm\")\nplt.title('Confusion Matrix Random Forest',  size = 13)\nplt.xlabel('Predicted Values', size = 12)\nplt.ylabel('Actual Values', size = 12)\nplt.show()","9c7719ad":"print(classification_report(yf_test, yf_test_predict))","2b937740":"accuracy_f = accuracy_score(yf_test, yf_test_predict)\nprint(f\"Random Forest Accuracy: {accuracy_f:.2f}\")","787dfada":"yf_test_predict_prob = rdf.predict_proba(Xf_test)[:, 1]\nfpr, tpr, threshold = roc_curve(yf_test, yf_test_predict_prob)","b71f308d":"sns.set_style(\"whitegrid\")\nplt.figure(figsize = [8, 5])\n\nplt.plot(fpr, tpr)\nplt.plot((0,1), ls = \"--\")\nplt.title(\"Random Forest ROC curve\")\nplt.xlabel(\"False Positive Rate\")\nplt.ylabel(\"True Positive Rate\")\nplt.show()","ed635e14":"auc_f = roc_auc_score(yf_test, yf_test_predict_prob)\nprint(f\"Random Forest AUC: {auc_f:.2f}\")","decc54b5":"accuracies = cross_val_score(estimator = rdf, X = Xf, y = yf, \n                             cv = 5)\naccuracies","f13aa7b4":"avg_accuracyf = accuracies.mean()\nprint(f\"Random Forest Average Accuracy: {avg_accuracyf:.2f}\")","8ad972d5":"model_comparison = {\"Logistic Regression\": {\n                          \"Accuracy\": accuracy, \"AUC\": auc, \n                          \"Cross validation\": avg_accuracy}, \n                    \"Random Forest\": {\n                        \"Accuracy\": accuracy_f, \"AUC\": auc_f, \n                        \"Cross validation\": avg_accuracyf }}","405f594d":"model_comparison =pd.DataFrame(model_comparison)\nmodel_comparison = model_comparison[model_comparison.columns].round(decimals = 2)\nmodel_comparison.T","8c37e768":"### Logistic Regression\n\nLogistic regression is a classification model used to predict a binary outcome. It uses a sigmoid function to determine the probability that a specific observation belongs to a specific class. In our case the probability that a patient has heart disease. \n\nIf the probability is over a specified threshold, the patient will be classified as having heart disease. If instead the probability is below the threshold, the patient will be classified as healthy.","d3863b79":"**Scale continuous variables**","1964ade0":"When I replaced the missing values, the datatype of ca and thal was changed from integer to float.","803f4bd1":"**Heart disease and age**\n\n- The percentsges of people under 55-years-old and people over 55-years-old similar.\n\n- 69% of people under 55 has heart disease.\n\n- 41% of people over 55 has heart disease.\n\nAge is an important risk factor in heart disease because with time blood vessels can get damaged or get weaker and not perform as well as in younger age.\n\nIn this dataset, however, heart disease occurs more frequently in younger people.\n","2a9ebe26":"What is the most common value in the thal variable?","24904f63":"**Number of heart disease cases by age**","707da7c1":"**Inspect a few rows of the dataset**","184c08c1":"---","d0c5bdbe":"**Continuous variables**\n\n**age:** The distribution of age suggest that the average age of people with heart disease is lower that the average age of healthy people.\n\n**blood pressure:** the distribution of blood pressure in people with heart disease is very similar to the distribution in healthy people.\n\n**cholesterol:** the distribution of cholesterol in people with heart disease is very similar to the distribution in healthy people.\n\n**heart rate:** people with heart disease seem to have higher heart rate compared to healthy people.\n\n**ST_depression:** people with heart disease seem to have a lower ST_depression compared to healthy people.\n\nBlood pressure and cholesterol are two of the most important risk factors in heart disease. However for this dataset they might not be good predictors of heart disease.\n","bd895c3e":"The index was resetted correctly.","ce857a31":"**Create the random model classifier and fit it to the train set**","c305c0ae":"## Heart Disease\n\nHeart disease, also known as cardiovascular disease, is the leading cause of death in the US. It includes conditions that block or weak the vessels that carry blood-oxygen to the heart (coronary heart disease), as well as conditions that directly affect the cardiac muscle (i.e. congenital heart defects).\n\nIn this notebook I will compare the performance of Logistic Regression and Random Forest in predicting heart disease.","08554bb3":"**Cross Validation**","d565e8d2":"**Heatmap of Pearson correlation**\n\nPearson's correlation measure the linear correlation between two variables. The Pearson's coefficient r can assume values between -1 and 1.\n\n- -1: perfect negative correlation\n- 0 : no correlation\n- 1 : perfect positive correlation \n\nFor this graph I will use the heart1 copy of the dataset, which still has all the variables in numerical format.","92105f54":"**Change variable labels**\n\nTo make the exploratory data analysis easier to interpret, I will replace the numbers in the sex variable and in all the categorical variables with more than 2 options with the corresponding category. ","38573d8a":"**save a copy of the dataset**","cefa7521":"**Blood sugar**\n\n- High level of glucose in the blood have no effect on the number of heart disease cases.\n       \n**Number of vessels positive to fluoroscopy**\n\n- Heart disease is strongly associated with a negative test (no positive vessels).\n","dc22fd3e":"The dataset is balanced between patients with heart disease and healthy patients.","ebc337d3":"**Accuracy score**","c439931f":"**ECG results**\n\n- normal ecg is the most common in people with heart disease. \n\n**ST-Slope results**\n\n- upslope is most commonly associated with hearth disease\n\n- a flat slope(no slope) is the most common result in healthy people\n\n**Thallium test results:**\n\n- A normal thallium test is strongly associated with heart disease\n\n- A thallium test that shows a reversable defect is more commonly associated with healthy people","37124bf3":"**Get dummy variables for the categorical variables**","c0ff86db":"**Predict heart disease on the test set**","6668287a":"From the graph above, it seems that heart disease is more common in people under 55-years-old.  I will check the the percentage of heart disease cases in people under 55-years-old and in people over 55-years-old.","2d21d328":"**Heart disease and gender**\n\nThis dataset shows a surprisingly high incidence of heart disease in women. \n\n- 32% of the patients in the study are women, but they account for 44% of the heart disease cases\n\n- 75% of the women in the study have heart disease compared to 45% of men.","ce094681":"### Model Evaluation","5e234e06":"### Receiver Operating Characteristics curve (ROC curve)\n\nThe ROC curve shows how well the model can differentiate between classes.\n\nThe curve is created by plotting the rate of true positive values (TPR) against the rate of false positive values (FPR).\n\nTPR = TP\/TP + FN\n\nFPR = FP\/ TN + FP","18f41503":"**Reset the index**","d003e52d":"**Confusion Matrix**\n\n- The model correctly predicted all the true positive cases (with heart disease) \n\n- The model correctly predicted 28 out of 33 negative cases. 5 negative cases were predicted to be positive.\n\n**Type I errors:** 5\n\n**Type II errors:** 0","6b04a0b5":"### Statistic summary\n\n**Continuous variables**","608570ae":"**Dataset structure**","f05c07a1":"## Conclusions\n\nLogistic regression has performed better than Random Forest in terms of general accuracy and in cross validation. Both algorithms had an AUC of 0.95, which means that both models were able to differentiate between classes. Better results could be achieved by tuning the models but for this notebook I will stop here.\n\nThe analysis showed some interesting results:\n- high incidence of heart disease in women and younger people.\n- angina during exercise more common in healthy people.\n- normal results on the thallium and ecg tests as the most commonly associated with heart disease.\n\nIf you found the notebook interesting, please upvote. \n\nThank you.\n\nFeedbacks are appreciated.","9af5675e":"**Pairplot of continuous variables by heart disease status.**","0851015e":"**Check for duplicated entries**","ebe55853":"**Blood Pressure and Gender**\n\n- Healthy women have higher blood pressure compared to women with heart disease.\n- The blood pressure of healthy men is similar to the blood pressure of men with heart disease.","1fd9f34d":"**Area under the curve (AUC)**\n\nMeaning of AUC values:\n\n- **close to 1:** the model is able to separate between the classes.\n- **close to 0:** the model reciprocates between classes. \n- **0:** the model perfectly reciprocates between classes.\n- **0.5:** the model has no ability to separate between classes.","52ac39ef":"#### Dealing with missing values\n\nA common option when dealing with categorical variables is to replace the missing value with the mode (most common value) of the variable. I will replace the NaN with the most common value by target status.","7d73b2fd":"**Evaluate the model performance on the train set**","1f527565":"The dotted curve represent the performance of a random model. Points above the dotted line represent good classifications while points below the dotted line represent bad classifications.\n\nThe blue curve represent the performance of our model.","3b9058bb":"**Importing the libraries**","7268beaf":"The dataset contains only numerical variables.","e330c114":"### Dataset Summary\n\n**Variables**\n\nIndependent variables: 13\n\nDependent variables: 1\n\nContinuous variables: 5\n\nCategorical variables: 9\n\n**Data type**\n\nInteger: 13\n\nfloat: 1\n\n**Missing values:** 0\n","6ff58667":"**Classification Report**\n\n- **Precision:** TP\/(TP + FP)\n\n- **Recall:** TP\/(TP + FN)\n\n- **F1-score:** (2 x Recall x Precision)\/Reacall + Precision","4b067b6e":"### Heart Disease Risk Factors\n\nSome risk factors for heart disease include:\n\n- **age:** with age the wall of the blood vessesls tends to weaken.\n- **sex:** men are at higher risk of developing heart disease\n- **high blood pressure:** the high pressure can damage the blood vessels\n- **high colesterol levels:** high colesterol levels can induce the formation of plaques in the blood vessels causing an inappropiate blood flux.\n- **diabetes** high levels of sugars in the blood while fasting can contribute to the development of heart disease.\n\nOther risk factors that are not included in this dataset include:\n\n- Family history\n- Smoking\n- Obesity\n- Stress\n","1645c28a":"**Create the regression object and fit it to the train set**","722ed641":"**Cross Validation**\n\nCross-validation gives an idea of how well a model can generalize from our dataset.\n\nThe model has performed well on this combination of train and test set. To check how well the model can generalize, I will evalueate the model on 5 different combination of train and test sets.","0d31c1c8":"### Model Evaluation","436a0615":"**Confusion Matrix**\n\n- The model correctly predicted 27 out of 28 positive values. 1 positive value was predicted as negative\n- The model correctly predicted 26 out of 33 negative values. 7 negative value were predicted as positive\n\n**Type I errors:** 7\n\n**Type II errors:** 1","7e5583b9":"**ROC graph and AUC score**","515f87c7":"**Gender and heart disease**\n\n\n\nCheck the percentage of men and women with heart disease.","ad107019":"**Comparing the performance of Logistic Regression and Random Forest** ","347cd5ce":"**Importing the dataset**","0f150743":"From the table above it is clear that there are no independent variables strongly correlated to each other, so in case I decide to use a linear model, I can use all variables without worrying about multicollinearity. ","16b37499":"## Heart Disease Prediction","29f63e69":"**print the duplicated entries.**","b2077417":"Because it is very unlikely that two entries recorded one after the other have the same values for all the variables, I will consider this as an error in data entry and drop one of the rows. The proper way to proceede would be to check with the people that collected the data and ask if these two entries are duplicates or not (even because this dataset is only a portion of the original dataset).","47a53a0e":"**ST-slope**","2cc04ff6":"The most common value for thal is 3 in healthy people and 2 in people with heart disease.","895c4bd7":"**Change pandas settings to display all rows and columns**","a5b3a3b0":"The value 4 in ca and 0 in thal are not reported in the description.\n\nHow many entries have 4 in ca and\/or 0 in thal?","b8150ff2":"### Dataset Description\n\n\n**Variables**\n\n**1 age** in years\n\n**2 sex:** 0 = female; 1 = male\n\n**3 cp:** chest pain type ( 0 = typical angina ; 1 = atypical angina; 2 = non-anginal pain; 3 = asymptomatic)\n\n**4 trestbps:** resting blood pressure (mmHg at the admission to the hospital)\n\n**5 chol:** serum cholesterol in mg\/dl\n\n**6 fbs:** fasting blood sugar in mg\/dl (0 = < 120; 1 = > 120)\n\n**7 restecg:** resting electrocardiographic results (0 = hypertrophy; 1 = normal; 2 = having ST-T wave)\n\n**8 thalac:** maximum heart rate achieved\n\n**9 exang:** exercise induced angina (0 = no; 1 = yes)\n\n**10 oldpeak:** ST depression induced by exercise relative to rest\n\n**11 slope:** the slope of the peak exercise ST segment (0 = downslope; 1 = flat; 2 = upslope)\n\n**12 ca:** number of major vessels colored by flouroscopy (0-3)\n\n**13 thal:** thallium stress test. A nuclear imaging test that measures how well the blood flows into the heart \n             (1 = fixed defect; 2 = normal;  3 = reversable defect)\n\n**14 target:** 0 = no heart disease; 1 = heart disease\n\n","bd32ac24":"The most common value for ca in both people with heart disease and healthy people is 0, so I will replace NaN with 0.","a88042b1":"ca has 5 unique values and thal has 4 unique values. According to the dataset description these variables should have 4 and 3 unique values, respectively.\n\nPrint the unique values.","6a0c80fc":"**Separate the independent variables from the dependent variable**","df470fbc":"**Changing variable' names**\n\nThe name of some variables are not easy to interpret so I will change them.","26a7218a":"### Random Forest classification\n\nRandom Forest is an ensemble method that applies a number of decision trees to sub-samples of the dataset. The class of the specific observation is determined by averaging the results of the different trees. ","dc5a7cd8":"**Split the dataset in train and test set**","c2538711":"**Categorical variables**","033ce3e1":"**General information about the dataset**","91a1e7c7":"**Predict heart disease on the train set**","3e5c82d0":"## Exploratory data analysis (EDA)\n\nNumber and percentage of patients by heart disease status","21553794":"**Heart Disease by Gender**","1c052fe2":"Check if the number of unique values in the categorical variables matches the number reported in the dataset description.","ed2c6a14":"**Importing modules for Machine Learning and model evaluation**","d56deaa1":"**Categorical variables and heart disease**","e00b75b4":"**Chest pain**\n\n- A non-angina type of chest pain is the most common in people with heart disease  \n- Asymptomatic type of chest pain is associated with healthy individuals\n\n**Angina during exercise**\n\n- The lack of angina type chest pain during exercise is associated with heart disease","90154950":"**Multivariate analysis**\n\nIn this section I will plot the variables heart rate and ST-depression against the categorical varaibles ST-slope, chest_pain, positive_vessels and thallium test to check whether some particular combination of factors can help us predict heart disease.\n\n\n**Heart Rate**","422897ff":"**Predicting heart diseased on the test set**","a3726bb8":"Replace NaN with 2 in entry 48 and with 3 in entry 280.","d55795a7":"**ROC graph and AUC score**","81c07921":"Check the data type of ca and thal","44d0c87e":"Four entries have a ca value of 4 and two entries have a thal value of 2.\n\nBecause these values are not reported in the dataset description and their number is low, I will consider them as missing values.\n\nOf course the proper thing to do would be to check with the people that collected the data."}}