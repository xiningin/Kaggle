{"cell_type":{"c9eb5034":"code","b7b68244":"code","eb75e386":"code","279551cb":"code","6928ab8d":"code","53523197":"code","57df6fbe":"code","200d334a":"code","737e789b":"code","02edc133":"code","fccc0103":"code","dacf3dd4":"code","a315c368":"code","3fbe8926":"markdown","c56c459e":"markdown"},"source":{"c9eb5034":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","b7b68244":"import cv2\nimport random","eb75e386":"PATHDIR = \"..\/input\/gatos-e-cachorros\/\"\ncategories = [\"gatos\",\"cachorros\",\"outros\"]\n\nIMG_SIZE = 200\n\n\ndef create_training_data():\n    training_data = []\n    \n    for c in categories:\n        for img_name in os.listdir(os.path.join(PATHDIR,\"treino\/pequeno\",c)):\n            img_path = os.path.join(PATHDIR,\"treino\/pequeno\",c,img_name)\n            img_arr = cv2.imread(img_path,0)\n            try:\n                resized = cv2.resize(img_arr, (IMG_SIZE,IMG_SIZE))\n                norm_arr = resized\/255\n                training_data.append([norm_arr, categories.index(c)])\n            except Exception as e:\n                pass\n    random.shuffle(training_data)\n    return training_data\n\ntraining_data = create_training_data()","279551cb":"X = []\ny = []\n\nfor f,l in training_data:\n    X.append(f)\n    y.append(l)\n    \nX = np.array(X).reshape(-1, IMG_SIZE,IMG_SIZE,1)\ny = np.array(y)","6928ab8d":"import tensorflow as tf\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Conv2D, MaxPooling2D, Flatten, Dense, Dropout","53523197":"model = Sequential()\n\n#First Layer\nmodel.add(Conv2D(64, (3,3), input_shape = (IMG_SIZE,IMG_SIZE,1)))\nmodel.add(MaxPooling2D(pool_size= (2,2)))\nmodel.add(Flatten())\n\n#Second Layer\nmodel.add(Dense(128, activation=\"relu\"))\nmodel.add(Dropout(0.2))\n\n#Output Layer\nmodel.add(Dense(10, activation = \"softmax\"))\n\nmodel.summary()","57df6fbe":"model.compile(optimizer = \"adam\",\n             loss =\"sparse_categorical_crossentropy\",\n             metrics = [\"accuracy\"])\n\nmodel.fit(X,y, epochs = 100)","200d334a":"def create_testing_data():\n    testing_data = []\n    \n    for c in categories:\n        for img_name in os.listdir(os.path.join(PATHDIR,\"treino\/medio\",c)):\n            img_path = os.path.join(PATHDIR,\"treino\/medio\",c,img_name)\n            img_arr = cv2.imread(img_path,0)\n            try:\n                resized = cv2.resize(img_arr, (IMG_SIZE,IMG_SIZE))\n                norm_arr = resized\/255\n                testing_data.append([norm_arr, categories.index(c)])\n            except Exception as e:\n                pass\n    random.shuffle(testing_data)\n    return testing_data\n\ntest_data = create_testing_data()","737e789b":"X_test = []\ny_test = []\n\nfor f,l in test_data:\n    X_test.append(f)\n    y_test.append(l)\n    \nX_test = np.array(X_test).reshape(-1, IMG_SIZE, IMG_SIZE,1)\ny_test = np.array(y_test)","02edc133":"model.evaluate(X_test, y_test)","fccc0103":"import matplotlib.pyplot as plt","dacf3dd4":"#img_path = \"..\/input\/gatos-e-cachorros\/teste\/misturado\/cat.4007.jpg\"\n#img_path = \"..\/input\/gatos-e-cachorros\/teste\/misturado\/cat.4024.jpg\"\n#img_path = \"..\/input\/gatos-e-cachorros\/teste\/misturado\/dog.4001.jpg\"\n#img_path = \"..\/input\/gatos-e-cachorros\/teste\/misturado\/dog.4053.jpg\"\nimg_path = \"..\/input\/gatos-e-cachorros\/teste\/misturado\/iStock-518856308.jpg\"\n#img_path = \"..\/input\/gatos-e-cachorros\/teste\/misturado\/iStock-536613027-696x464.jpg\"\nimg_arr = cv2.imread(img_path,0)\nimg_arr = cv2.resize(img_arr, (IMG_SIZE,IMG_SIZE))\nnorm_arr = img_arr\/255\npred_img = (norm_arr)\n    \n    \npred_img = pred_img.reshape(200,200,1)","a315c368":"test_img = pred_img\ntest_img = test_img.reshape(1,IMG_SIZE,IMG_SIZE,1)\npredict_ = model.predict(test_img)[0]\n\nfor i in range(len(predict_)):\n    if(predict_[i] == max(predict_)):\n        if(i == 0):\n            print(\"Gato\")\n        elif(i == 1):\n            print(\"Cachorro\")                \n        else:\n            print(\"Outra coisa\")\n        \nplt.imshow(test_img.reshape(IMG_SIZE,IMG_SIZE), cmap='gray')","3fbe8926":"isto \u00e9 referente a bla bla bal","c56c459e":"# Treinamento de Gatos e Cachorros\n\n## Este notebook \u00e9 um estudo de CNN que para analisar se a imagem \u00e9 um gato, cachorro ou n\u00e3o s\u00e3o nenhum desses animais."}}