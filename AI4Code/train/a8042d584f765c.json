{"cell_type":{"d5e14af2":"code","1f12f610":"code","6aec69ca":"code","8841f9f3":"code","21310fde":"code","0ac3eba3":"code","1f516250":"code","f8f38199":"code","29668178":"code","954e3113":"code","0417c2c2":"code","e5f97f8e":"code","c3b08c46":"code","1170c645":"code","bf3b01ca":"code","6acde4c4":"code","1ae238d2":"code","64da1146":"code","09536a01":"code","1737f868":"code","977a686b":"code","96d9a23f":"code","a2a4e439":"code","306e7a77":"code","345e5c9d":"code","f78db684":"code","70adf923":"code","b576d1ab":"code","a053f899":"code","73f500ae":"code","b7366c36":"code","73b40761":"code","f89b8290":"code","a3173412":"code","8ea2e815":"code","d40847b1":"code","4d457343":"code","5edb9377":"code","f349138a":"code","9c589cfa":"code","76d5ae36":"code","0e19429c":"code","ea18088a":"code","4aa9c2d9":"code","797a48b8":"code","832d4ff4":"code","a10f8e94":"code","d9df3797":"code","49c37642":"code","5996a325":"code","5e32772b":"code","cbcc4a53":"code","f2f8f1ce":"code","7dee8b4c":"code","35ad87f3":"code","33ecda11":"code","28453222":"code","cc8e06a2":"code","6bd627f8":"code","6166becb":"code","ed13e107":"code","a4b80823":"code","b9ee5538":"code","e5fd2535":"code","75f7f46c":"code","3b1ad940":"markdown","4075bf6c":"markdown","6a522b44":"markdown","f073eeda":"markdown","b3f7cc9e":"markdown","f4dba1b8":"markdown","37f03c0a":"markdown","85d11671":"markdown","32f16a4a":"markdown","ba9cbcf7":"markdown","f0538ade":"markdown","602d1492":"markdown"},"source":{"d5e14af2":"import pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt","1f12f610":"import plotly.express as px","6aec69ca":"df=pd.read_csv(\"..\/input\/insurance\/insurance.csv\")","8841f9f3":"df","21310fde":"df.shape","0ac3eba3":"df.info()","1f516250":"df.describe()","f8f38199":"df.isnull().sum()","29668178":"plt.figure(figsize=(12,6))\nsns.displot(data=df,x='charges',kde=True)","954e3113":"round(df['smoker'].value_counts()\/df.shape[0]*100,2).plot.pie(autopct='%1.1f%%',colors=['#33cccc','#ff6666'])","0417c2c2":"sns.catplot(data=df,x='smoker',y='charges')","e5f97f8e":"#Relation between smoker and Charges\nfig = px.scatter(df, \n                 x='smoker', \n                 y='charges', \n                 opacity=0.8, \n                 hover_data=['sex'], \n                 title='smoker vs. Charges')\nfig.update_traces(marker_size=5)\nfig.show()","c3b08c46":"sns.barplot(x=df['smoker'],y=df['charges'])\nplt.xticks(rotation='vertical')\nplt.show()","1170c645":"fig = px.histogram(df, \n                   x='age', \n                   marginal='box', \n                   nbins=47, \n                   title='Distribution of Age')\nfig.update_layout(bargap=0.1)\nfig.show()","bf3b01ca":"#Relation between age and Charges\nplt.figure(figsize=(10,12))\nfig = px.scatter(df, \n                 x='age', \n                 y='charges', \n                 color='smoker', \n                 opacity=0.8, \n                 hover_data=['sex'], \n                 title='Age vs. Charges')\nfig.update_traces(marker_size=5)\nfig.show()","6acde4c4":"fig = px.histogram(df, \n                   x='bmi', \n                   marginal='box', \n                   color_discrete_sequence=['red'], \n                   title='Distribution of BMI (Body Mass Index)')\nfig.update_layout(bargap=0.1)\nfig.show()","1ae238d2":"#Relation between BMI and Charges\nfig = px.scatter(df, \n                 x='bmi', \n                 y='charges', \n                 color='smoker', \n                 opacity=0.8, \n                 hover_data=['sex'], \n                 title='BMI vs. Charges')\nfig.update_traces(marker_size=5)\nfig.show()","64da1146":"sns.catplot(x=\"children\", kind=\"count\", palette=\"ch:.25\", data=df)","09536a01":"fig = px.scatter(df, \n                 x='children', \n                 y='charges', \n                 color='smoker', \n                 opacity=0.8, \n                 hover_data=['sex'], \n                 title='Children vs. Charges')\nfig.update_traces(marker_size=5)\nfig.show()","1737f868":"round(df['sex'].value_counts()\/df.shape[0]*100,2).plot.pie(autopct='%1.1f%%',colors=['skyblue','pink'])","977a686b":"sns.catplot(data=df,x='sex',y='charges')","96d9a23f":"sns.catplot(data=df,x='sex',y='charges',hue='smoker')","a2a4e439":"#relation between region & charges\nsns.catplot(data=df,x='region',y='charges')","306e7a77":"sns.catplot(data=df,x='region',y='charges',hue='smoker')","345e5c9d":"def normalize(col):\n    return (df[col]-df[col].min())\/(df[col].max()-df[col].min())","f78db684":"normalize('charges')","70adf923":"df['charges']","b576d1ab":"df['region'].value_counts()","a053f899":"from sklearn.preprocessing import LabelEncoder","73f500ae":"LE={}\nfor col in ['sex','smoker','region']:\n    LE[col]=LabelEncoder()\n    df[col]=LE[col].fit_transform(df[col])","b7366c36":"df","73b40761":"plt.figure(figsize=(10,8))\nsns.heatmap(df.corr(),cbar=True,annot=True)","f89b8290":"x=df.drop('charges',axis=1)\ny=df['charges']","a3173412":"from sklearn.model_selection import train_test_split","8ea2e815":"X_train ,X_test,Y_train ,Y_test=train_test_split(x,y,test_size=0.15,random_state=0)","d40847b1":"X_train.shape","4d457343":"X_test.shape","5edb9377":"from sklearn.tree import DecisionTreeRegressor","f349138a":"dt=DecisionTreeRegressor(max_depth=5,max_features=5,random_state=123)","9c589cfa":"dt.fit(X_train,Y_train)","76d5ae36":"print('Train score : ',dt.score(X_train,Y_train)*100)","0e19429c":"print(\"Test score : \",dt.score(X_test,Y_test)*100)","ea18088a":"new=[[24,0,30.5,2,1,4]]\ndt.predict(new)","4aa9c2d9":"from sklearn.ensemble import RandomForestRegressor\nrf = RandomForestRegressor(n_estimators=80,max_depth=6,max_features=5,random_state=123)","797a48b8":"rf.fit(X_train,Y_train)","832d4ff4":"print('Train score : ',rf.score(X_train,Y_train)*100)","a10f8e94":"print(\"Test score : \",rf.score(X_test,Y_test)*100)","d9df3797":"rf.predict(new)","49c37642":"from sklearn.linear_model import LinearRegression","5996a325":"lr=LinearRegression()","5e32772b":"lr.fit(X_train,Y_train)","cbcc4a53":"print('Train score : ',lr.score(X_train,Y_train)*100)","f2f8f1ce":"print(\"Test score : \",lr.score(X_test,Y_test)*100)","7dee8b4c":"lr.predict(new)","35ad87f3":"from sklearn.svm import SVR","33ecda11":"svr=SVR(kernel='rbf')","28453222":"svr.fit(X_train,Y_train)","cc8e06a2":"print('Train score : ',svr.score(X_train,Y_train)*100)","6bd627f8":"print(\"Test score : \",svr.score(X_test,Y_test)*100)","6166becb":"svr.predict(new)","ed13e107":"from sklearn.neighbors import KNeighborsRegressor\nkreg = KNeighborsRegressor(n_neighbors=25)","a4b80823":"kreg.fit(X_train,Y_train)","b9ee5538":"print('Train score : ',kreg.score(X_train,Y_train)*100)","e5fd2535":"print(\"Test score : \",kreg.score(X_test,Y_test)*100)","75f7f46c":"kreg.predict(new)","3b1ad940":"# Test & Train","4075bf6c":"    - charges & smoker have a strong positive correlation\n    - charges & age have a weak positive correlation\n    - charges & bmi have a weak positive correlation\n    - charges & children have a very weak positive correlation\n    - charges & sex have a very weak positive correlation\n    - charges & region have a very very weak negative correlation","6a522b44":"# SVR","f073eeda":"________\n________\n________\n","b3f7cc9e":"\n### **`Samsung Innovation Campus || SIC`**\n_______\n  >   -  Hadeer Emad\n  >   - Abdelrahman Ehab\n  >   - zyad Farag","f4dba1b8":"## Decision Tree","37f03c0a":"# Random Forest Regressor","85d11671":"_____\n_____","32f16a4a":"# Medical Cost \n  > insurance dataset","ba9cbcf7":"# KNN Regressor","f0538ade":"# Linear Regression","602d1492":"__________\n_________\n# **`The Best for this data`**\n____________\n_________"}}