{"cell_type":{"2139693d":"code","01faae45":"code","24cab131":"code","2fa6cfab":"code","80a5881a":"code","7d87ef76":"markdown","078531df":"markdown","0a394002":"markdown","07c4cf27":"markdown"},"source":{"2139693d":"import os\nimport cv2\nimport matplotlib.pyplot as plt\n\ndataset_path = \"..\/input\/lfw-dataset\/lfw-deepfunneled\/lfw-deepfunneled\/\"\nfilter_path = \"..\/input\/haarcascades\/haarcascade_frontalface_default.xml\"\nprint(\"Number of sub folder in images folder =\",len(os.listdir(dataset_path)))","01faae45":"def detect_faces(image):\n    face_cascade = cv2.CascadeClassifier(filter_path)\n    bboxes = face_cascade.detectMultiScale(image, 1.3, 5)\n    return bboxes","24cab131":"def draw_bounding_boxes(image, bboxes):\n    for box in bboxes:\n        print(\"\\nBounding box co-ordinates =\",box)\n        x1, y1, w, h = box\n        cv2.rectangle(image, (x1, y1), (x1+w,y1+h), (0,255,0), 4)","2fa6cfab":"jk_rowling_imgs = \"..\/input\/lfw-dataset\/lfw-deepfunneled\/lfw-deepfunneled\/JK_Rowling\/\"\n\nprint(\"List of images in J.K.Rowling folder:\\n\",os.listdir(jk_rowling_imgs))","80a5881a":"# to display images using matplotlib\nplt.figure(1, figsize = (20, 5))\n\nfor index, image in enumerate(os.listdir(jk_rowling_imgs)):\n    image_path = jk_rowling_imgs + image\n    print(\"\\n\",index+1,\"Image file path =\",image)\n    \n    # read image as numpy array\n    image = cv2.imread(image_path)\n    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)\n    \n    # get bounding box co-ordinates for the image\n    bboxes = detect_faces(image)\n    \n    # draw bounding box around the face\n    draw_bounding_boxes(image, bboxes)\n    \n    # display the image with bounding box drawn\n    plt.subplot(1, len(os.listdir(jk_rowling_imgs)), index+1)\n    plt.subplots_adjust(wspace = 0.3)\n    plt.xticks([])\n    plt.yticks([])\n    plt.imshow(image)\n\nplt.show","7d87ef76":"## 4. Load an image, detect face and draw bounding box around the face\n\n- Let's choose a set of images and see how face is being detected","078531df":"## 2. Define method to detect faces","0a394002":"## 1. Some basic steps","07c4cf27":"## 3. Define method to draw bounding boxes around the face"}}