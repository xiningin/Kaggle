{"cell_type":{"171d646d":"code","14761edc":"markdown"},"source":{"171d646d":"import glob\nimport os\nimport cv2\nfrom tqdm.auto import tqdm\nfrom multiprocessing import Pool, cpu_count\n\ndef split_to_images(video_path):\n    video_name = os.path.basename(video_path).split('.')[0]\n    cam = cv2.VideoCapture(video_path)\n    frame_count = 1 # To make it consistant with train_labels.csv\n    while True:\n        successed, img = cam.read()\n        if not successed:\n            break\n        save_name = f'{SAVE_DIR}\/{video_name}_frame{frame_count:04}.jpg'\n        cv2.imwrite(save_name, img)\n        frame_count += 1\n    print(f'finished processing {video_name}')\n    \nif __name__ == '__main__': \n    SAVE_DIR = 'train_images'\n    os.makedirs(SAVE_DIR, exist_ok=True)\n\n    video_paths = sorted(\n        glob.glob('..\/input\/nfl-health-and-safety-helmet-assignment\/train\/*'))\n\n    num_cpu = cpu_count()\n    pool = Pool(num_cpu)\n    with tqdm(total=len(video_paths)) as t:\n        for _ in pool.imap_unordered(split_to_images, video_paths):\n            t.update(1)","14761edc":"ver3: Changed frame count to starting with 1 to match original csv files."}}