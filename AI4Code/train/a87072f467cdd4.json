{"cell_type":{"88c0bbe1":"code","9224ec46":"code","f85a1456":"code","c52ade70":"code","691e9a92":"code","206c1a97":"code","b9bb8c08":"code","c3b88dfa":"code","922f472b":"code","0a94d885":"code","4fd7bcab":"code","4e784ac7":"code","7286ef7a":"markdown","55ce41ef":"markdown","15363cd7":"markdown","6ebe56ae":"markdown","9f8e3574":"markdown","3efc9a62":"markdown","b108494f":"markdown","823028b9":"markdown"},"source":{"88c0bbe1":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt","9224ec46":"df = pd.read_csv(\"..\/input\/fifa-20-complete-player-dataset\/players_20.csv\")\n\n# extract players' names and cont. variables\ndf = df[['club', 'overall', 'potential', 'value_eur', 'wage_eur', 'international_reputation', 'weak_foot']]\n\n# replace null values with mean\ndf = df.fillna(df.mean())\n\n# selecting top 4, mid 4, and bottom 4 clubs\ndf_clubs = df[(df.club =='Manchester City') | (df.club =='Liverpool') | (df.club =='Chelsea') | (df.club == 'Tottenham Hotspur') |\n              (df.club =='Leiceter City') | (df.club =='West Ham United') | (df.club =='Watford') | (df.club == 'Crystal Palace') |\n              (df.club == 'Brighton & Hove Albion') |(df.club == 'Cardiff City') | (df.club == 'Fulham') | (df.club == 'Huddersfield Town')]\n\n# categorizing by top 4, mid 4, and bottom 4\ndf_clubs.club = df_clubs.club.replace({'Manchester City':'top 4', 'Liverpool':'top 4', 'Chelsea':'top 4', 'Tottenham Hotspur':'top 4',\n                                       'Leiceter City':'mid 4', 'West Ham United':'mid 4', 'Watford':'mid 4', 'Crystal Palace':'mid 4',\n                                       'Brighton & Hove Albion':'bottom 4', 'Cardiff City':'bottom 4', 'Fulham':'bottom 4', 'Huddersfield Town':'bottom 4'})\n\ndf_clubs.club.value_counts()","f85a1456":"# X - all features except the club , y - clubs\nX = df_clubs.iloc[:, 1:].values\ny = df_clubs.club.values\n\n# 80\/20 train & test split\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state = 1)\n\n# standardize data\nfrom sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nscaler.fit(X_train)\n\n# scale both the train and the test set\nX_train = scaler.transform(X_train)\nX_test = scaler.transform(X_test)","c52ade70":"from sklearn.tree import DecisionTreeClassifier\n\n# initialize the decision tree classifier\ndtc = DecisionTreeClassifier()\n\n# train the model\ndtc.fit(X_train, y_train)\n\n# get prediction\ny_pred = dtc.predict(X_test)","691e9a92":"from sklearn.metrics import confusion_matrix, accuracy_score\nfrom sklearn.model_selection import cross_val_score\n\nprint(\"-----------Confusion matrix-----------\")\nprint(pd.crosstab(y_test, y_pred, rownames=['True'], colnames=['Predicted'], margins=True))\nprint(\"--------------------------------------\")\n\nprint(\"Test set accuracy: {:.2f}\".format(accuracy_score(y_test, y_pred)))\nprint(\"=======================================\")\n\n# 10 fold CV\nacc = cross_val_score(dtc, X_test, y_test, cv=10)\nprint(\"\\n10-fold CV accuracy for each fold\\n {}\".format(acc))\nprint(\"\\n--------------------------------------\")\nprint(\"10-fold CV Average Accuracy: {:.2f}\".format(acc.mean()))","206c1a97":"df = pd.read_csv(\"..\/input\/fifa-20-complete-player-dataset\/players_20.csv\")\n\n# extract players' names and some cont. variables\ndf = df[['club', 'overall', 'potential', 'value_eur', 'wage_eur', 'international_reputation', 'weak_foot','skill_moves']]\n\n# replace null values with mean\ndf = df.fillna(df.mean())\n\n# selecting top 4, mid 4, and bottom 4 clubs\ndf_clubs = df[(df.club =='Manchester City') | (df.club =='Liverpool') | (df.club =='Chelsea') | (df.club == 'Tottenham Hotspur') |\n              (df.club =='Leiceter City') | (df.club =='West Ham United') | (df.club =='Watford') | (df.club == 'Crystal Palace') |\n              (df.club == 'Brighton & Hove Albion') |(df.club == 'Cardiff City') | (df.club == 'Fulham') | (df.club == 'Huddersfield Town')]\n\n# categorizing by top 4, mid 4, and bottom 4\ndf_clubs.club = df_clubs.club.replace({'Manchester City':'top 4', 'Liverpool':'top 4', 'Chelsea':'top 4', 'Tottenham Hotspur':'top 4',\n                                       'Leiceter City':'mid 4', 'West Ham United':'mid 4', 'Watford':'mid 4', 'Crystal Palace':'mid 4',\n                                       'Brighton & Hove Albion':'bottom 4', 'Cardiff City':'bottom 4', 'Fulham':'bottom 4', 'Huddersfield Town':'bottom 4'})\n\ndf_clubs.club.value_counts()","b9bb8c08":"# X - all features except the club , y - clubs\nX = df_clubs.iloc[:, 1:].values\ny = df_clubs.club.values\n\n# 80\/20 train & test split\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state = 1)\n\n# standardize data\nfrom sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nscaler.fit(X_train)\n\n# scale both the train and the test set\nX_train = scaler.transform(X_train)\nX_test = scaler.transform(X_test)","c3b88dfa":"from sklearn.tree import DecisionTreeClassifier\n\n# initialize the decision tree classifier\ndtc = DecisionTreeClassifier()\n\n# train the model\ndtc.fit(X_train, y_train)\n\n# get prediction\ny_pred = dtc.predict(X_test)","922f472b":"from sklearn.model_selection import GridSearchCV\n\n# initialize parameters\ndepths = np.arange(2,10)\nsplits = np.arange(2,10)\nleaves = [1, 2, 3]\nrandomState = [0]\n\nparams = {\"criterion\": (\"gini\", \"entropy\"), \"splitter\" : (\"best\", \"random\"), \n          \"max_depth\" : depths, \"min_samples_split\": splits, \"min_samples_leaf\": leaves, \"random_state\" : randomState}\n\n# apply gridsearchcv with 10 fold\ngs_dtc = GridSearchCV(dtc, params, cv = 10)\n\n# train the model\ngs_dtc.fit(X_train, y_train)","0a94d885":"gs_dtc.best_params_","4fd7bcab":"# initialize the best model\nbest_model = gs_dtc.best_estimator_\n\n# train the model again with the optimal params\nbest_model.fit(X_train, y_train)\n\n# get the prediction\ny_pred = best_model.predict(X_test)\n\nfrom sklearn.metrics import confusion_matrix, accuracy_score\nfrom sklearn.model_selection import cross_val_score\n\nprint(\"-----------Confusion matrix-----------\")\nprint(pd.crosstab(y_test, y_pred, rownames=['True'], colnames=['Predicted'], margins=True))\nprint(\"--------------------------------------\")\n\nprint(\"\\nTest set accuracy: {:.2f}\".format(accuracy_score(y_test, y_pred)))\nprint(\"=======================================\")","4e784ac7":"import graphviz\nfrom sklearn import tree\nfrom matplotlib.pyplot import figure\n\ndot_data = tree.export_graphviz(best_model, out_file=None,  \n                      filled=True, rounded=True,  \n                      special_characters=True)  \ngraph = graphviz.Source(dot_data)  \n\nplt.figure(figsize=(5,5))\n\ngraph \n\n# df = df[['club', 'overall', 'potential', 'value_eur', 'wage_eur', 'international_reputation', 'weak_foot','skill_moves']]","7286ef7a":"# Train & Test Split","55ce41ef":"# Data Cleaning\/Pre-processing","15363cd7":"# **Classifying Premier League Clubs in FIFA 20 with Decision Tree**\n\n- Author: Jaemin Lee (aka. Import Data)\n- [Import Data YouTube Channel](https:\/\/www.youtube.com\/channel\/UCYDacpfRrCX6_8oDDlzTgFw)\n- [Video Explanation](https:\/\/www.youtube.com\/watch?v=l6etd5mUkkY)\n\n","6ebe56ae":"# Model Evaluation","9f8e3574":"# Apply Decision Tree","3efc9a62":"# Import Libraries","b108494f":"Tune Parameters Using GridSearchCV","823028b9":"# Apply GridSearchCV to optimize parameters"}}