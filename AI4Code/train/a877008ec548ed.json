{"cell_type":{"10157d7f":"code","e74a0d18":"code","745ae99d":"code","19cada42":"code","e9e06ce0":"code","0bef748d":"code","36a9b6b8":"code","9f25208e":"code","ee98119f":"code","532e4326":"code","0ef7fe12":"code","7217c81a":"code","04baa10f":"code","62b0ed62":"code","8da16979":"code","6e46d285":"code","f2f13dcb":"markdown","9ad5bd5d":"markdown","84b985ba":"markdown","3ded780c":"markdown","498eae54":"markdown"},"source":{"10157d7f":"# install libraries\n! pip install tabula-py\n! apt install ghostscript\n! pip install camelot-py[cv]","e74a0d18":"import pandas as pd\nimport requests\nimport PyPDF2\nimport tabula\nimport camelot","745ae99d":"# load the table data\ndf_meta = pd.read_csv(\"..\/input\/CORD-19-research-challenge\/2020-03-13\/all_sources_metadata_2020-03-13.csv\")\nprint(df_meta.shape)","19cada42":"# save the paper pdf\ntitle = \"Clinical Characteristics of Coronavirus Disease 2019 in China\"\nidx = df_meta[df_meta['title']==title].index[0]\ndoi = df_meta['doi'][idx]\npdf_path = \"https:\/\/www.nejm.org\/doi\/pdf\/{}?articleTools=true\".format(doi)\nprint(\"title: {}\".format(title))\nprint(\"idx: {}\".format(idx))\nprint(\"doi: {}\".format(doi))\nprint(\"pdf_path: {}\".format(pdf_path))\nr = requests.get(pdf_path)\nwith open(\"tmp.pdf\",'wb') as file:\n        file.write(r.content)","e9e06ce0":"# extract tables using tabula\ntables = tabula.read_pdf(\"tmp.pdf\", pages = \"all\", multiple_tables = True)","0bef748d":"# check the shape of extracted tables\nfor i in range(len(tables)):\n    tmp = pd.DataFrame(tables[i])\n    print(\"table {:02d}, shape: {}\".format(i+1, tmp.shape))","36a9b6b8":"# check the table 1 at page 5, 6\ntables[4].head()","9f25208e":"tables[5].head()","ee98119f":"# check the table 2 at page 7, 8\ntables[6].head()","532e4326":"tables[7].head()","0ef7fe12":"# check the table 3 at page 9, 10\ntables[8]","7217c81a":"tables[9].head()","04baa10f":"# save\ntables[4].to_csv(\"table1_1.csv\", index=None)\ntables[5].to_csv(\"table1_2.csv\", index=None)\ntables[6].to_csv(\"table2_1.csv\", index=None)\ntables[7].to_csv(\"table2_2.csv\", index=None)\ntables[8].to_csv(\"table3_1.csv\", index=None)\ntables[9].to_csv(\"table3_2.csv\", index=None)","62b0ed62":"# try to extract tables using camelot\ntables = camelot.read_pdf('tmp.pdf')","8da16979":"# check the number of extracted tables\nprint(len(tables))","6e46d285":"# delete the pdf\n!rm tmp.pdf","f2f13dcb":"### Trying to extract tables using Camelot","9ad5bd5d":"### Trying to extract tables by Tabula","84b985ba":"The extracted tables are imperfect but possible to fix manually.","3ded780c":"camelot failed to extracted the tables from the paper.","498eae54":"[\"Clinical Characteristics of Coronavirus Disease 2019 in China\"](https:\/\/www.nejm.org\/doi\/full\/10.1056\/NEJMoa2002032) must be one of the most important paper. Here I try to extract the table data from the papers using the libraries, Tabula and Camelot."}}