{"cell_type":{"2d2c770c":"code","19ce357a":"code","b70a2c82":"code","f9bfe881":"markdown","70f1763b":"markdown","dd6d4bea":"markdown","cc62ef91":"markdown"},"source":{"2d2c770c":"#First lets import all the required libraries.\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\n#Using \u201cHeart Disease UCI\u201d dataset as all its columns are numeric.\ndata = pd.read_csv(\"..\/input\/heart.csv\")\n\n#Evaluating data texture (data type, null count & unique values) of dataset.\nindex = list(data.columns)\nnew_df = pd.DataFrame(index=index)\nfor ix in data.columns:\n    new_df.at[ix,'data_types'] = data[ix].dtypes\n    new_df.at[ix,'null_counts'] = data[ix].isnull().sum()\n    new_df.at[ix,'unique_values'] = data[ix].nunique()\nnew_df","19ce357a":"#Below function will cluster each values in a numeric column based on minimum and maximum value in a given group of range.\ndef rng_to_grp(min_n, max_n, grp, val):\n    min_n = min_n if min_n % 2 == 0 else min_n - 1\n    max_n = max_n if max_n % 2 == 0 else max_n + 1\n    arr = np.linspace(round(min_n,0), round(max_n,0), grp)\n    for i in arr:\n        if val <= i:\n            to_n = i\n            break\n    diff = arr[1] - arr[0]\n    from_n = to_n - diff\n    return str(round(from_n,0))+' to '+str(round(to_n,0))\n\n#Using the \"rng_to_grp\" function for clustering those 5 columns which has good spread of unique values.\nfor ix in data.index:\n    data.at[ix,'age_grp'] = rng_to_grp(data['age'].min(),data['age'].max(),10,data.at[ix,'age'])\n    data.at[ix,'trestbps_grp'] = rng_to_grp(data['trestbps'].min(),data['trestbps'].max(),10,data.at[ix,'trestbps'])\n    data.at[ix,'chol_grp'] = rng_to_grp(data['chol'].min(),data['chol'].max(),10,data.at[ix,'chol'])\n    data.at[ix,'thalach_grp'] = rng_to_grp(data['thalach'].min(),data['thalach'].max(),10,data.at[ix,'thalach'])\n    data.at[ix,'oldpeak_grp'] = rng_to_grp(data['oldpeak'].min(),data['oldpeak'].max(),10,data.at[ix,'oldpeak'])\n\n#Post clustering again evaluating data texture of dataset.\nindex = list(data.columns)\nnew_df = pd.DataFrame(index=index)\nfor ix in data.columns:\n    new_df.at[ix,'data_types'] = data[ix].dtypes\n    new_df.at[ix,'null_counts'] = data[ix].isnull().sum()\n    new_df.at[ix,'unique_values'] = data[ix].nunique()\nnew_df","b70a2c82":"#Adding a column \u201cCount\u201d with value 1 to dataset, in order to use as value in pivot_table.\ndata['Count'] = 1\n\n#Creating a function to plot a graph for clustered columns.\ndef plot_graph(x):\n    table = pd.pivot_table(data, values='Count', index=[x], columns=['target'], aggfunc=np.sum).fillna(0).reset_index()\n    table['find'] = table[x].apply(lambda x: x[:x.find('to',0)]).astype(float)\n    table = table.sort_values(['find'],ascending=True)\n    fig, ax = plt.subplots()\n    ax.stackplot(table[x], table[0], table[1], labels=[\"0\", \"1\"], colors=['g','r'], zorder=2)\n    ax.legend()\n    plt.grid(zorder=1)\n    plt.xticks(rotation=90)\n    plt.title(x)\n    plt.show()\n\n#Running \u201cplot_graph\u201d function for data visualization of clustered columns.\nplot_graph('age_grp')\nplot_graph('trestbps_grp')\nplot_graph('chol_grp')\nplot_graph('thalach_grp')\nplot_graph('oldpeak_grp')","f9bfe881":"As we can see clustered columns are added to dataset.","70f1763b":"As we can see all columns in dataset are numeric, there are no null values and 5 columns (age, trestbps, chol, thalach & oldpeak) has good spread of unique values.","dd6d4bea":"Hope you have find it useful, do leave your comments and feedbacks.","cc62ef91":"A lot of time while working on numeric columns we face inconsistency due to spread of different values.\n\nThis task can become smooth by clustering values in range for identifying a hidden pattern to focus on relevant issue.\n\nLet\u2019s find out how we can apply clustering on numeric columns."}}