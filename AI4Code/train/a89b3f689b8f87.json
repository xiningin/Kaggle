{"cell_type":{"d82db37a":"code","78ee63ed":"code","9f81fc15":"code","09e29d3d":"code","00d350ce":"code","bd140835":"code","16055686":"code","ea797c15":"code","68af9c0e":"code","2a5c70ec":"code","f4ba6208":"code","65c5d1ea":"code","ef1dd435":"code","2a94c8e3":"code","b5ecfe02":"code","60ddb78d":"code","24ac0556":"code","d4ff9743":"code","dd48c40a":"code","800f06f9":"code","0d7f2e97":"code","52f17244":"code","eb93036a":"code","b350916f":"code","f2d5b6b5":"code","bc9aaebc":"code","ad9fb52c":"code","9634d49b":"code","0467db14":"code","d717b212":"code","d9aea1ce":"code","126c288f":"code","b3fb4235":"code","604fbd74":"code","f93d17ee":"code","e78874c8":"code","76dc4eeb":"code","9e0941b4":"markdown"},"source":{"d82db37a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","78ee63ed":"raw_data=pd.read_csv('..\/input\/BlackFriday.csv')\n","9f81fc15":"raw_data.head()","09e29d3d":"raw_data.describe(include='all')","00d350ce":"data=raw_data.copy()","bd140835":"data.head()","16055686":"data_1=data.replace(np.nan,0)","ea797c15":"data_1.head()","68af9c0e":"data_1.describe(include='all')","2a5c70ec":"from sklearn.cluster import KMeans\nfrom sklearn.model_selection import train_test_split","f4ba6208":"import matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()","65c5d1ea":"data_1=data_1.drop(['User_ID'],axis=1)","ef1dd435":"data_1=data_1.drop(['Product_ID'],axis=1)","2a94c8e3":"data_2=data_1.copy()","b5ecfe02":"data_2['Gender']=data_2['Gender'].map({'F':0,'M':1})\ndata_2['Age']=data_2['Age'].map({'0-17':0,'18-25':1,'26-35':2,'36-45':3,'46-50':4,'51-55':5,'55+':6})\ndata_2['City_Category']=data_2['City_Category'].map({'A':0,'B':1,'C':2})\ndata_2['Stay_In_Current_City_Years']=data_2['Stay_In_Current_City_Years'].map({'0':0,'1':1,'2':2,'3':3,'4':4,'4+':5})","60ddb78d":"data_2.head()","24ac0556":"import statsmodels.api as sm\nfrom sklearn.linear_model import LinearRegression","d4ff9743":"y=data_2['Purchase']\nx1=data_2.drop(['Purchase'],axis=1)","dd48c40a":"x=sm.add_constant(x1)\nresult_sm=sm.OLS(y,x).fit()\nresult_sm.summary()","800f06f9":"x_train,x_test,y_train,y_test=train_test_split(x1,y,train_size=0.8,random_state=365)","0d7f2e97":"reg=LinearRegression()\nreg.fit(x_train,y_train)","52f17244":"reg.score(x_train,y_train)","eb93036a":"reg.intercept_","b350916f":"reg.coef_","f2d5b6b5":"reg_summary=pd.DataFrame(x1.columns.values,columns=['Features'])","bc9aaebc":"reg_summary['Weights']=reg.coef_","ad9fb52c":"reg_summary","9634d49b":"y_hat=reg.predict(x_train)","0467db14":"y_hat","d717b212":"sns.distplot(y_hat-y_train)","d9aea1ce":"y_hat_test=reg.predict(x_test)","126c288f":"predicted_purchase=y_hat_test","b3fb4235":"actual_purchase=y_test.reset_index(drop=True)","604fbd74":"results_summary=pd.DataFrame(predicted_purchase,columns=['Predicted Purchase'])\nresults_summary['Actual Purchase']=actual_purchase","f93d17ee":"results_summary['Residual']=actual_purchase-predicted_purchase\nresults_summary['Error']=np.absolute(results_summary['Residual']\/actual_purchase)*100","e78874c8":"results_summary.sort_values(by='Error')","76dc4eeb":"sns.catplot(x='Gender',y='Purchase',hue='City_Category',data=data_2)","9e0941b4":"### Since the Product 2 and Product 3 categories have values which are NA we replace them by 0"}}