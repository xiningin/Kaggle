{"cell_type":{"22721c94":"code","176f5372":"code","6f7498be":"code","5fdb6f42":"code","b593198d":"code","9db67fd0":"code","3803bc06":"code","6f5bcf15":"code","745f54ec":"code","072d72e7":"code","18fed738":"code","305eab4d":"code","381f2ab3":"code","e7299ab3":"code","a170de95":"code","f54cbdda":"code","0c91270f":"code","721b1acd":"code","47d03cad":"code","ebb1383f":"code","5e35b9ba":"code","4e0b79d6":"code","257beae9":"code","6d005661":"code","0fa32c3e":"code","4723d3a1":"code","f56b2fba":"code","65d9793c":"code","b2856ea0":"code","be1aa66e":"code","f0dc3eaf":"code","b25f19b7":"code","9506087b":"code","1b67535b":"code","77a29065":"code","fbf9164c":"code","b4b225df":"code","fd1e1a3c":"code","4e4ae3b1":"code","2c378c56":"code","b15c0b3c":"code","4c349951":"code","47d0ebd0":"code","2e626204":"code","bf89d803":"code","c91b0cc1":"code","10800e4f":"code","96d50cd8":"code","75226f4f":"code","d6b017fe":"code","ad79057a":"code","ba7370f8":"code","08ca14cf":"code","1b107969":"code","7f39befc":"code","ffb8e893":"code","f4a5bf55":"code","1106ad98":"code","ef08885a":"code","259a36a9":"code","0baeecff":"code","60a3e59b":"code","1e82565a":"code","6b6d2aab":"code","88f1e84d":"code","f9000b96":"code","4cff40c7":"code","e0265ed7":"code","5f293680":"code","48728552":"code","446a6e2c":"code","161a41f2":"code","8ac63447":"code","cbca46ca":"code","1d62c9a5":"code","54c0c4b2":"code","a386e3a6":"code","c7fcfaad":"code","a6ed0ac5":"code","ad7182e5":"code","9dc82f4a":"code","b6f849da":"markdown","b3d5f851":"markdown","0b598395":"markdown","02bc1a23":"markdown","c27303a9":"markdown","f6a24368":"markdown","218f0512":"markdown","4df43631":"markdown","d61d7dca":"markdown","d4a7bdeb":"markdown","16c80dfc":"markdown","8472e6f5":"markdown","0f8e7b29":"markdown"},"source":{"22721c94":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n","176f5372":"%matplotlib inline\nsns.set_style('whitegrid')","6f7498be":"import warnings\nwarnings.filterwarnings('ignore')","5fdb6f42":"df = pd.read_csv('..\/input\/insurance.csv')","b593198d":"df.head()","9db67fd0":"df.info()","3803bc06":"df.isnull().sum()","6f5bcf15":"sns.heatmap(df.isnull(),cmap=\"YlGnBu\")","745f54ec":"df.dtypes","072d72e7":"df[['sex','smoker','region']].head()","18fed738":"from sklearn.preprocessing import LabelEncoder","305eab4d":"le = LabelEncoder()\nle.fit(df.sex.drop_duplicates())\ndf.sex = le.transform(df.sex)","381f2ab3":"df['sex'].head()","e7299ab3":"le.fit(df.smoker.drop_duplicates())","a170de95":"df.smoker=le.transform(df.smoker)","f54cbdda":"le.fit(df.region.drop_duplicates())","0c91270f":"df.region = le.transform(df.region)","721b1acd":"df.head()","47d03cad":"df.dtypes","ebb1383f":"df.corr()","5e35b9ba":"sns.heatmap(df.corr(),cmap=\"YlGnBu\")","4e0b79d6":"corr_matrix = df.corr()","257beae9":"corr_matrix['charges'].sort_values(ascending=False)","6d005661":"sns.countplot(data=df,x='smoker',hue='sex')","0fa32c3e":"sns.countplot(data=df,x='smoker')","4723d3a1":"sns.countplot(data=df,x='region')","f56b2fba":"sns.countplot(data=df,x='sex')","65d9793c":"sns.countplot(data=df,x='smoker',hue='sex')","b2856ea0":"df['charges'].hist()","be1aa66e":"df['charges'].min()","f0dc3eaf":"df.charges.max()","b25f19b7":"f = plt.figure(figsize=(12,7))\nax = f.add_subplot(121)\nsns.distplot(df[df['smoker']==1]['charges'],color='g',ax=ax)\nplt.title('Distrubution of  charges for Smokers')\n\nax = f.add_subplot(122)\nsns.distplot(df[df['smoker']==0]['charges'],color='b',ax=ax)\nplt.title('Distrubution of  charges for Non-Smokers')","9506087b":"df[df['smoker']==0]['charges'].max()","1b67535b":"df[df['smoker']==0]['charges'].min()","77a29065":"df[df['smoker']==1]['charges'].min()","fbf9164c":"df[df['smoker']==1]['charges'].max()","b4b225df":"sns.catplot(x='sex',y='charges',hue='smoker',kind='violin',data=df)","fd1e1a3c":"plt.figure(figsize=(12,5))\nplt.title(\"Box plot for charges of women\")\nsns.boxplot(y=\"smoker\", x=\"charges\", data =  df[(df.sex == 1)] , orient=\"h\", palette = 'magma')","4e4ae3b1":"plt.figure(figsize=(12,5))\nplt.title(\"Box plot for charges of women\")\nsns.boxplot(y=\"smoker\", x=\"charges\", data =  df[(df.sex == 0)] , orient=\"h\", palette = 'magma')","2c378c56":"df.age.plot(kind='hist')","b15c0b3c":"df['age'].min()","4c349951":"df['age'].max()","47d0ebd0":"plt.figure(figsize=(12,8))\nsns.catplot(x='smoker',kind='count',hue='sex',data=df[(df.age<=23)])","2e626204":"df[(df['smoker']==0) & (df['age']<=23) &(df['sex']==0)].count()","bf89d803":"\nsns.jointplot(x=\"age\", y=\"charges\", data = df[(df.smoker == 0)],kind=\"kde\", color=\"m\")","c91b0cc1":"sns.jointplot(x=\"age\", y=\"charges\", data = df[(df.smoker == 1)],kind=\"kde\", color=\"g\")","10800e4f":"sns.distplot(df['bmi'])","96d50cd8":"plt.figure(figsize=(14,8))\nplt.title('Distribution of charges for patients with BMI greater than 30')\nax = sns.distplot(df[df.bmi>=30]['charges'],color='m')","75226f4f":"plt.figure(figsize=(14,8))\nplt.title('Distribution of charges for patients with BMI lesser than 30')\nax = sns.distplot(df[df.bmi<30]['charges'],color='g')","d6b017fe":"sns.jointplot(x=\"bmi\", y=\"charges\", data = df,kind=\"kde\", color=\"r\")","ad79057a":"sns.catplot(x=\"children\", kind=\"count\", data=df, size = 6)","ba7370f8":"sns.catplot(x=\"children\", kind=\"count\", hue='smoker',data=df, size = 6)","08ca14cf":"X = df.drop(['charges'],axis=1)\ny= df['charges']","1b107969":"X.head()","7f39befc":"y.head()","ffb8e893":"print(X.shape)\nprint(y.shape)","f4a5bf55":"from sklearn.linear_model import LinearRegression","1106ad98":"from sklearn.model_selection import train_test_split","ef08885a":"X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state=101)","259a36a9":"l_reg = LinearRegression()","0baeecff":"l_reg.fit(X_train,y_train)","60a3e59b":"y_pred = l_reg.predict(X_test)","1e82565a":"from sklearn.metrics import r2_score,mean_squared_error","6b6d2aab":"print(r2_score(y_test,y_pred))","88f1e84d":"print(mean_squared_error(y_test,y_pred))","f9000b96":"print(l_reg.score(X_test,y_test))","4cff40c7":"X_train.head()","e0265ed7":"y_train.head()","5f293680":"l_reg.predict([[48,1,35.625,4,0,0]])","48728552":"corr_matrix['charges']","446a6e2c":"X = df.drop(['region','charges'],axis=1)  ","161a41f2":"y = df.iloc[:,-1]","8ac63447":"X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state=101)","cbca46ca":"l_reg.fit(X_train,y_train)","1d62c9a5":"y_pred = l_reg.predict(X_test)","54c0c4b2":"l_reg.score(X_test,y_test)","a386e3a6":"mean_squared_error(y_test,y_pred)","c7fcfaad":"print(r2_score(y_test,y_pred))","a6ed0ac5":"X_train.head()","ad7182e5":"y_train.head()","9dc82f4a":"l_reg.predict([[18,0,38.280,0,0]])","b6f849da":"# Data Cleaning","b3d5f851":"# Importing libraries","0b598395":"Now its all clear and our data is ready to fit a Machine learning model.","02bc1a23":"\"here we observe that we don't have any missing values.\" ","c27303a9":"#### We observe that  smoker and age are much effects the charges","f6a24368":"we have 3 categorical featurs in our dataset.so we need to encode for better results","218f0512":"#### We need to find a better features for getting more accuracy and performance of the mdel. so we find correlation between the independent and dependent variavles.","4df43631":"# <b>Thank you. here i worked with a simle linear regression technique for beginers to understand how it works.<\/b>","d61d7dca":"# Importing Data","d4a7bdeb":"We have integers and object types in our dataset..","16c80dfc":"# Data analysis and visualization","8472e6f5":"##  Importing LabelEncoder for encoding categorical feaures","0f8e7b29":"Observe the minimum and maximum charges.."}}