{"cell_type":{"0d5350e1":"code","daa97264":"code","056dc4ff":"code","4f9bccc5":"code","25887d39":"code","a84725de":"code","88525d4a":"code","7021bfd2":"code","0c325e2e":"code","2478e5df":"code","bc248697":"code","d7a46df0":"code","ae856571":"code","92c7c1cf":"code","73ebabbf":"code","64a1b57f":"code","8d3e684b":"code","83d7e32a":"code","859bce61":"code","c0bbbba9":"code","7c488398":"code","214ec3c2":"code","01612a9f":"code","97514d90":"code","5739b6c4":"code","cfaa8728":"markdown","f2e65454":"markdown","c3c6a7a3":"markdown","6dc21aae":"markdown","02d8b2bb":"markdown","2e5c6164":"markdown","2cf95f87":"markdown","869c72dc":"markdown","5a359391":"markdown","091e76b5":"markdown","d4778869":"markdown","247e1095":"markdown","7fe90c2f":"markdown","5bf1f509":"markdown","44bc1a72":"markdown","e4bd2d46":"markdown","33c4f1c6":"markdown","178e78db":"markdown","437dac8c":"markdown","c985f482":"markdown","ec008747":"markdown","0777debf":"markdown","ddcb9bd7":"markdown","e02a6dd1":"markdown","233e1d21":"markdown"},"source":{"0d5350e1":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport datetime as dt\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","daa97264":"res_level = pd.read_csv(\"..\/input\/chennai_reservoir_levels.csv\")\nres_rfall = pd.read_csv(\"..\/input\/chennai_reservoir_rainfall.csv\")","056dc4ff":"res_level.head()","4f9bccc5":"res_rfall.head()","25887d39":"res_level.describe()","a84725de":"res_rfall.describe()","88525d4a":"# Rename the columns in both the data sets.\n\nres_level.columns = res_level.columns.str.lower() + \"_level\"\nres_rfall.columns = res_rfall.columns.str.lower() + \"_rfall\"","7021bfd2":"# Join water level and rainfall data sets to form a single dataset.\n\nres_master_df = res_level.merge(res_rfall, left_on = \"date_level\", right_on = \"date_rfall\")\nres_master_df = res_master_df.drop(columns = [\"date_rfall\"], errors = \"ignore\")\nres_master_df = res_master_df.rename(index = str, columns = {\"date_level\":\"recorded_date\"})\nres_master_df.head()","0c325e2e":"# Convert object to date data type.\n\nres_master_df[\"recorded_date\"] = pd.to_datetime(res_master_df[\"recorded_date\"], format = \"%d-%m-%Y\")","2478e5df":"# Extract year and month from recorded_date field.\n\nres_master_df[\"year\"] = res_master_df[\"recorded_date\"].dt.year\nres_master_df[\"month\"] = res_master_df[\"recorded_date\"].dt.month","bc248697":"res_master_df.head()","d7a46df0":"res_master_df[\"season\"] = np.select([res_master_df[\"month\"].isin([12, 1, 2]), \n                                     res_master_df[\"month\"].isin([3, 4, 5]),\n                                     res_master_df[\"month\"].isin([6, 7, 8, 9]),\n                                     res_master_df[\"month\"].isin([10, 11])], \n                                    [\"winter\", \"summer\", \"monsoon\", \"autumn\"])","ae856571":"# Group the data by year and season on each of the water level columns and merge all these data frames \n# into a single data frame for further analysis.\n\ndf_1 = pd.DataFrame(res_master_df.groupby([\"year\", \"season\"])[[\"poondi_level\", \"poondi_rfall\"]].agg(np.mean)).round(2)\ndf_2 = pd.DataFrame(res_master_df.groupby([\"year\", \"season\"])[[\"cholavaram_level\", \"cholavaram_rfall\"]].agg(np.mean)).round(2)\ndf_3 = pd.DataFrame(res_master_df.groupby([\"year\", \"season\"])[[\"redhills_level\", \"redhills_rfall\"]].agg(np.mean)).round(2)\ndf_4 = pd.DataFrame(res_master_df.groupby([\"year\", \"season\"])[[\"chembarambakkam_level\", \"chembarambakkam_rfall\"]].agg(np.mean)).round(2)\ndf_1.reset_index(inplace = True)\ndf_2.reset_index(inplace = True)\ndf_3.reset_index(inplace = True)\ndf_4.reset_index(inplace = True)\n\ndf_1 = df_1.merge(df_2, left_on = [\"year\", \"season\"], right_on = [\"year\", \"season\"])\ndf_1 = df_1.merge(df_3, left_on = [\"year\", \"season\"], right_on = [\"year\", \"season\"])\ndf_1 = df_1.merge(df_4, left_on = [\"year\", \"season\"], right_on = [\"year\", \"season\"])\n\nyear_season_group_df = df_1\n\ndel (df_1, df_2, df_3, df_4)","92c7c1cf":"def plot_water_level (ip_df, ip_reservoir):\n    \n    fig = plt.figure(figsize = (12, 9))\n    \n    df = ip_df[['year', 'season', ip_reservoir + '_level']]\n    df_1 = df.groupby('year')[ip_reservoir + '_level'].sum()\n    df_1 = df_1.reset_index()\n    df = df.merge(df_1, right_on = 'year', left_on = 'year')\n    df = df.rename(index = str, columns = {ip_reservoir + '_level_x':'water_level', ip_reservoir + '_level_y':'total_water_level'})\n    df['perc'] = round(df['water_level'] * 100 \/ df['total_water_level'], 2)\n    df['water_level'] = df['perc'].copy()\n    df = df.drop(columns = ['total_water_level', 'perc'], axis = 1)\n\n    def_water_level_df = pd.DataFrame({'year':df[\"year\"].unique().astype(str).tolist(), \n                                       'water_level':list(map(int, \"0\" * df[\"year\"].nunique()))})\n\n    water_level_df = pd.DataFrame({'year':df[\"year\"].unique().astype(str).tolist(),\n                                   'bar_bottom':list(map(int, \"0\" * df[\"year\"].nunique()))\n                                  })\n\n    water_level_rec = pd.DataFrame({'season':[], 'year':[], 'water_level':[]})\n\n    tmp_plot = plt.bar([], [], [])\n    plot_legend = {\"color\":[], \"plot\":[]}\n\n    for season in (['winter', 'summer', 'monsoon', 'autumn']):\n        water_level_rec = df.loc[df[\"season\"] == season, ['year', 'water_level']].copy()\n        water_level_rec['year'] = water_level_rec['year'].astype(str)\n\n        water_level_rec = def_water_level_df.merge(water_level_rec, \n                                                   how = 'left', \n                                                   right_on = 'year', \n                                                   left_on = 'year')\n\n        water_level_rec = water_level_rec.drop(columns = 'water_level_x', axis = 1)\n        water_level_rec = water_level_rec.rename(index = str, columns = {'water_level_y':'water_level'})\n        water_level_rec['water_level'] = water_level_rec['water_level'].fillna(0)\n\n        x = water_level_rec['year'].tolist()\n        y = water_level_rec['water_level'].tolist()    \n        bar_bottom = water_level_df['bar_bottom']\n\n        tmp_plot = plt.bar(x, y, bottom = bar_bottom)\n\n        for i in (water_level_df.itertuples(index = True, name = 'Pandas')):\n\n            i_iter_year = getattr(i, 'year')\n\n            for j in (water_level_rec.itertuples(index = True, name = 'Pandas')):\n                j_iter_year = getattr(j, 'year')\n                j_water_level = getattr(j, 'water_level')\n\n                if (i_iter_year == j_iter_year):\n                    water_level_df.loc[water_level_df['year'] == j_iter_year, 'bar_bottom'] += j_water_level\n                    break\n\n        for i in (np.arange(len(x))):\n\n            if (y[i] == 0):\n                continue\n\n            y_coord = round(water_level_df.loc[i, 'bar_bottom'] - y[i] \/ 2)\n\n            x_coord = x[i]\n\n            plt.text(x_coord, y_coord, str(y[i]) + '%', ha = 'center', fontsize = 8, color = 'white')\n\n        plot_legend[\"color\"].append(season.title())\n        plot_legend[\"plot\"].append(tmp_plot[0])\n\n    plt.xlabel(\"Year\")\n    plt.ylabel('Water level (Average per year per season - Proportionately)')\n    fig.suptitle(\"Reservoir : \" + ip_reservoir.title() + \"\\nAverage water level Year-wise Season-wise\")\n    plt.legend(plot_legend[\"plot\"], plot_legend[\"color\"])\n    plt.show()","73ebabbf":"plot_water_level (year_season_group_df, 'poondi')","64a1b57f":"year_season_group_df.loc[year_season_group_df['year']==2019, ]","8d3e684b":"plot_water_level (year_season_group_df, 'cholavaram')","83d7e32a":"plot_water_level (year_season_group_df, 'redhills')","859bce61":"plot_water_level (year_season_group_df, 'chembarambakkam')","c0bbbba9":"def plot_rain_fall (ip_df, ip_reservoir):\n    \n    fig = plt.figure(figsize = (12, 9))\n    \n    df = ip_df[['year', 'season', ip_reservoir + '_rfall']]\n    df_1 = df.groupby('year')[ip_reservoir + '_rfall'].sum()\n    df_1 = df_1.reset_index()\n    df = df.merge(df_1, right_on = 'year', left_on = 'year')\n    df = df.rename(index = str, columns = {ip_reservoir + '_rfall_x':'rain_fall', ip_reservoir + '_rfall_y':'total_rain_fall'})\n    df['perc'] = round(df['rain_fall'] * 100 \/ df['total_rain_fall'], 2)\n    df['rain_fall'] = df['perc'].copy()\n    df = df.drop(columns = ['total_rain_fall', 'perc'], axis = 1)\n\n    def_rain_fall_df = pd.DataFrame({'year':df[\"year\"].unique().astype(str).tolist(), \n                                     'rain_fall':list(map(int, \"0\" * df[\"year\"].nunique()))})\n\n    rain_fall_df = pd.DataFrame({'year':df[\"year\"].unique().astype(str).tolist(),\n                                 'bar_bottom':list(map(int, \"0\" * df[\"year\"].nunique()))\n                                 })\n\n    rain_fall_rec = pd.DataFrame({'season':[], 'year':[], 'rain_fall':[]})\n\n    tmp_plot = plt.bar([], [], [])\n    plot_legend = {\"color\":[], \"plot\":[]}\n\n    for season in (['winter', 'summer', 'monsoon', 'autumn']):\n        rain_fall_rec = df.loc[df[\"season\"] == season, ['year', 'rain_fall']].copy()\n        rain_fall_rec['year'] = rain_fall_rec['year'].astype(str)\n\n        rain_fall_rec = def_rain_fall_df.merge(rain_fall_rec, \n                                               how = 'left', \n                                               right_on = 'year', \n                                               left_on = 'year')\n\n        rain_fall_rec = rain_fall_rec.drop(columns = 'rain_fall_x', axis = 1)\n        rain_fall_rec = rain_fall_rec.rename(index = str, columns = {'rain_fall_y':'rain_fall'})\n        rain_fall_rec['rain_fall'] = rain_fall_rec['rain_fall'].fillna(0)\n\n        x = rain_fall_rec['year'].tolist()\n        y = rain_fall_rec['rain_fall'].tolist()    \n        bar_bottom = rain_fall_df['bar_bottom']\n\n        tmp_plot = plt.bar(x, y, bottom = bar_bottom)\n\n        for i in (rain_fall_df.itertuples(index = True, name = 'Pandas')):\n\n            i_iter_year = getattr(i, 'year')\n\n            for j in (rain_fall_rec.itertuples(index = True, name = 'Pandas')):\n                j_iter_year = getattr(j, 'year')\n                j_rain_fall = getattr(j, 'rain_fall')\n\n                if (i_iter_year == j_iter_year):\n                    rain_fall_df.loc[rain_fall_df['year'] == j_iter_year, 'bar_bottom'] += j_rain_fall\n                    break\n\n        for i in (np.arange(len(x))):\n\n            if (y[i] == 0):\n                continue\n\n            y_coord = round(rain_fall_df.loc[i, 'bar_bottom'] - y[i] \/ 2)\n\n            x_coord = x[i]\n\n            plt.text(x_coord, y_coord, str(y[i]) + '%', ha = 'center', fontsize = 8, color = 'white')\n\n        plot_legend[\"color\"].append(season.title())\n        plot_legend[\"plot\"].append(tmp_plot[0])\n\n    plt.ylabel('Rain fall (Average per year per season - Proportionately)')\n    fig.suptitle(\"Reservoir : \" + ip_reservoir.title() + \"\\nAverage rain fall Year-wise Season-wise\")\n    plt.legend(plot_legend[\"plot\"], plot_legend[\"color\"])\n    plt.show()","7c488398":"plot_rain_fall (year_season_group_df, 'poondi')","214ec3c2":"plot_rain_fall (year_season_group_df, 'cholavaram')","01612a9f":"plot_rain_fall (year_season_group_df, 'redhills')","97514d90":"plot_rain_fall (year_season_group_df, 'chembarambakkam')","5739b6c4":"# Water reservoir which is filled to the maximum capacity (as per data).\n\nyear_season_group_df[['poondi_level', 'cholavaram_level', 'redhills_level', 'chembarambakkam_level']].max()","cfaa8728":"### Analysis of Water levels for each reservoir\n\nLet's analyse the water levels for the 4 reservoirs across seasons for each of the years. Here, we are going to compute and compare proportion of average water levels in a season in each year.","f2e65454":"This gives us some background on the SI units used in measuring water levels and rain fall.\n\n### Water levels : mcft to tmc unit conversion\n\n1000 mcft = 1 tmc.\n\n#### What are mcft and tmc?\nmcft = Million Cubic Feet <br>\ntmc = Thousand Million Cubic Feet\n\n<b>tmc<\/b> is higher measurement compared to <b>mcft<\/b> in terms of SI units. Since, we have values as lower as 0.9 in reservoir level data set, its not wise to convert these values into tmc as it will lead to very very low values.\n\n### mcft to litres unit conversion:\n\n1 mcft = 28316846.59 litres\n\n<b>litres<\/b> is lower compared to <b>mcft<\/b> in SI units measurement. We can convert mcft to litres during our data analysis if required.\n\n### Rainfall : mm (millimeters)\n\nIt is the measure of precipitation in millimetres in height collected on each square meter during a certain period, equivalent to litres per square metre.","c3c6a7a3":"#### Analysis of Water level for \"Chembarambakkam\"","6dc21aae":"Observations on average rainfall around <b>Cholavaram<\/b> water reservoir in the period 2004-2019 across different seasons of each of these years:<br>\n- All years from 2004-2018, a good amount of rainfall has been seen in monsoon season.\n- In almost all years (except for few), we see an increase in the amount of rainfall in autumn season.\n- In winter season, we see good rainfall for almost all years except few.<br>\n<i><b>For e.g.<\/b> 2004, 2006, 2008, 2013 & 2017.<\/i>\n- Summer season we see less amount of rain in almost all years except 2004, 2016 & 2019 in which we see a considerable amount of rainfall.\n- As we do not have rainfall data for any other season for year 2019, we see a thumping rise in rainfall for summer season which may not be true if we include the missing data in this analysis. ","02d8b2bb":"Observations on water levels in <b>Redhills<\/b> water reservoir during 2004-2019 period:\n- Barring 2009, 2014, 2016 & 2018 years, we see high water levels across all years in winter season.\n- We can clearly see a drop in water levels in almost all years except 2009, 2014, 2016 & 2018.\n- Not every monsoon is followed by an increase in water level in autumn season as compared to water levels in the summer season.<br>\n<i><b>For e.g.<\/b> 2006, 2008, 2009, 2011, 2016 and 2018 average water level per day in autumn season is lower compared to summer season when it should be the other way around.<\/i>\n- Above might have been observed due to the fact that water evaporates a lot during summer season compared to other seasons around the year.\n- Observation made above might have been due to the fact that the water evaporates a lot during summer season compared to other seasons around any year than water precipitated.\n- Water level is pretty high in year 2019's winter season.\n- We do not have autumn season's data for year 2019.","2e5c6164":"Observations on average rainfall around <b>Poondi<\/b> water reservoir in the period 2004-2019 across different seasons of each of these years:<br>\n- Years 2007, 2010 and 2016 have seen high rainfall in monsoon season in comparison to other years in the same season.\n- In almost all years (except for few), an increase in amount of rainfall can be observed in autumn season.\n- In winter season, we can see few years with good rainfall.<br>\n<i><b>For e.g.<\/b> 2007, 2009-2012, 2015 and 2016<\/i>\n- Summer season we see less rainfalls in the years except 2004, 2006, 2008 & 2016 years in which we see a considerable amount of rainfall.\n- As we do not have rainfall data for any other season for year 2019, we see a thumping rise in rainfall for summer season which may not be true if we include the missing data in this analysis. ","2cf95f87":"#### Analysis of rainfall for \"Poondi\"","869c72dc":"Observations on average rainfall around <b>Redhills<\/b> water reservoir in the period 2004-2019 across different seasons of each of these years:<br>\n- All years we have seen high rainfall close to 20% or above in monsoon season.\n- In almost all years (except for few), we see an increase in the amount of rainfall in autumn season.\n- In winter season, we can see good rainfall for almost all years except few.<br>\n<i><b>For e.g.<\/b> 2004, 2006, 2008, 2013, 2017 and 2018<\/i>\n- Summer season we see less amount of rain in almost all years except 2004, 2010, 2016 & 2019 in which we see a considerable amount of rainfall.\n- As we do not have rainfall data for any other season for year 2019, we see a thumping rise in rainfall for summer season which may not be true if we include the missing data in this analysis. ","5a359391":"Observations on water levels in <b>Chembarambakkam<\/b> water reservoir during 2004-2019 period:\n- We see high water levels across almost all years in winter season except for some years.\n- Years 2009, 2013, 2014, 2016 & 2018 are exceptional because we see a rise in water levels in these years when compared to winter season in respective years. Otherwise, we see \"as usual\" a steep decrease in water level in summer season.\n- Not every monsoon is followed by an increase in water level in autumn season as compared to water levels in the summer season.\n- Above might have been observed due to the fact that water evaporates a lot during summer season compared to other seasons around the year.\n- Observation made above might have been due to the fact that the water evaporates a lot during summer season compared to other seasons around any year than water precipitated.\n- Water level is pretty high in year 2019's winter season; even compared to other 3 reservoirs.\n- We do not have autumn season's data for year 2019.","091e76b5":"Observations on average rainfall around <b>Chembarambakkam<\/b> water reservoir in the period 2004-2019 across different seasons of each of these years:<br>\n- Years 2007, 2010 and 2016 have seen high rainfall in monsoon season in comparison to other years in the same season.\n- In almost all years (except for few), we see an increase in the amount of rainfall in autumn season.\n- In winter season, we can see good rainfall for almost all years except few.<br>\n<i><b>For e.g.<\/b> 2004, 2006, 2008, 2013, 2014, 2017 and 2018<\/i>\n- Summer season we see less amount of rain in almost all years except 2014 & 2016 in which we see a considerable amount of rainfall.\n- We do not have data for year 2019 for this water reservoirs.","d4778869":"Based on \"month\" value parsed from recorded_date field, divide year period into 4 basic seasons (as per Wikipedia) to analyse the water levels and rainfall across seasons per year:<br>\n<t>a. <b>Winter<\/b> : Spans from December to February.<br>\n    b. <b>Summer<\/b> : Spans from March to May.<br>\n    c. <b>Monsoon<\/b> : Spans from Jun to September.<br>\n    d. <b>Autumn<\/b> : Spans from October to November.<br>","247e1095":"#### Few basic points to remember when analysing data of this kind of problem:\n\n- Rain is not the only source of increase in water level but it is main source indeed. Water level gets increased through water bubbling from the bottom of a water reservoir from underground waterbeds.\n\n- Increase in water level depends on:<br>\na. Amount of rain in and round the water reservoir and in the neighboring state from where the water gets flown.\nb. Increase in ground level water which sometimes gets moved from earth's waterbed to the water reservoir.\n\n- Rate of evaporation of water depends on:<br>\na. Surface area of the water reservoir which gets exposed to the sunlight.\nb. Depth of the reservoir. More deeper the reservoir is more amount of water gets collected.\n\n#### Overall observations on the given data set\n\n1. Though we see a very good amount of rain in monsoon we do not see a rise in water level eiter in monsoon or autumn seasons. Also, please note that a good amount of rain is not an indicator of the amount collected or flown to the water reservoir. Because, a heavy down pour in and around a water reservoir may or may not get collected in the reservoir. Some percentage of rain goes to drainage, some may get collected in nearby ponds or may get soaked into the ground.\n\n2. Water levels are quiet high in winter and autumn season when the temperature is not as high as we see during summer.\n\n3. As per the data, Poondi water reservoir seems to be having highest capacity among other water reservoirs given in the data.","7fe90c2f":"#### Analysis of rainfall for \"Redhills\"","5bf1f509":"#### Analysis of Water level for \"Cholavaram\"","44bc1a72":"Observations on water levels in <b>Poondi<\/b> water reservoir during 2004-2019 period:\n- The water levels are on the higher side during winter season across almost all the years except for 2012, 2014, 2018 and 2019 years.\n- Surprisingly, higher water levels are observed in the reservoir in summer season in years 2012, 2018 and 2019 compared to winter season. In the remaining years, the water levels have clearly come down in summer season as expected to happen.\n- Not every monsoon is followed by an increase in water level in autumn season as compared to water levels in the summer season.<br>\n<i><b>For e.g.<\/b> Year 2008, 2009, 2012, 2013, 2014, 2016 and 2018 average water level per day in autumn season is lower compared to summer season when it should be the other way around.<\/i>\n- Observation made above might have been due to the fact that the water evaporates a lot during summer season compared to other seasons around any year than water precipitated.\n- Water level is pretty high in year 2019's winter season.\n- We do not have autumn season's data for year 2019.","e4bd2d46":"#### Analysis of rainfall for \"Cholavaram\"","33c4f1c6":"#### Assumption:\n\nWater levels close to zero or absolutely zero means that the water level has gone down so much so that it does not get pass through even the gates of the water reservoir.","178e78db":"#### Assumption:\n\nFor this problem, though it makes no sense to compute average water levels per day for every year season of an year for all the years, it helps in comparing water levels in different seasons across an year.","437dac8c":"#### Analysis of rainfall for \"Chembarambakkam\"","c985f482":"#### Analysis of Water level for \"Poondi\"","ec008747":"### Analysis of Rainfall around for each reservoir\n\nLet's analyse the rainfall around the 4 water reservoirs across seasons for each of the years. Here, we are going to compute and compare proportion of average rainfall across seasons in each year.\n\n#### Function name : plot_rain_fall\n\nA user defined function to plot stacked bar chart for a reservoir across given years data proportionating the average rainfall (around reservoir) in a year across different seasons in that year.","0777debf":"#### Assumption:\n\nRainfall close to zero or absolutely zero does not mean it did not rain at all or may be it poured but not recorded.","ddcb9bd7":"#### Function name : plot_water_level\n\nA user defined function to plot stacked bar chart for a reservoir across given years data proportionating the average water levels in a year across different seasons in that year.","e02a6dd1":"Observations on water levels in <b>Cholavaram<\/b> water reservoir during 2004-2019 period:\n- Except for the years 2004, 2005 and 2017, the water levels are pretty high during winter season across a year in every other year.\n- In the summer season we see a clear dip in water levels across all the years.\n- Not every monsoon is followed by an increase in water level in autumn season as compared to water levels in the summer season.<br>\n<i><b>For e.g.<\/b> 2006, 2008, 2009, 2011, 2016 and 2018 average water level per day in autumn season is lower compared to summer season when it should be the other way around.<\/i>\n- Above might have been observed due to the fact that water evaporates a lot during summer season compared to other seasons around the year.\n- Observation made above might have been due to the fact that the water evaporates a lot during summer season compared to other seasons around any year than water precipitated.\n- Water level is pretty high in year 2019's winter season.\n- We do not have autumn season's data for year 2019.","233e1d21":"#### Analysis of Water level for \"Redhills\""}}