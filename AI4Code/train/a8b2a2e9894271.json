{"cell_type":{"af76d05b":"code","4358b653":"code","3bf29016":"code","43f93004":"code","89f8cf1a":"code","1fd20408":"code","51ca059d":"code","523e8d70":"code","038d962f":"code","7178a198":"code","f5d59dd6":"code","d44960af":"code","26a2bfb7":"code","035c4b13":"code","49a906ee":"code","432c4350":"code","f5309b66":"code","09c1874a":"markdown","9f728f87":"markdown","84d41996":"markdown","3f7752b8":"markdown","763db4c0":"markdown","7d50583d":"markdown","10ac6746":"markdown","62d9d986":"markdown","98c55a3d":"markdown","f66dc25f":"markdown","34bb7196":"markdown","08c6fe0f":"markdown","3db3e226":"markdown","874f25c7":"markdown","532608ae":"markdown","3009069a":"markdown","a4271f4c":"markdown","09459c85":"markdown"},"source":{"af76d05b":"# \u8f7d\u5165\u9700\u8981\u4f7f\u7528\u7684\u5305\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nimport os\n\npd.set_option('display.max_columns', None)\n# raw \u5bf9\u5e94\u539f\u59cb\u6570\u636e\uff0c processed \u5bf9\u4e8e\u5904\u7406\u540e\u7684\u6570\u636e\nraw_data_path = '..\/input\/member-repurchase-forecast\/'\nprocessed_data_path = '..\/input\/member-repurchase-forecast\/'","4358b653":"from IPython.core.interactiveshell import InteractiveShell\nInteractiveShell.ast_node_interactivity = 'all'","3bf29016":"df_train = pd.read_csv(os.path.join(raw_data_path, 'train.csv'), parse_dates=['first_active_month'])\ndf_test = pd.read_csv(os.path.join(raw_data_path, 'test.csv'), parse_dates=['first_active_month'])\ntransactions = pd.read_csv(os.path.join(raw_data_path, 'transactions.csv'))\ntransactions['purchase_date'] = pd.to_datetime(transactions['purchase_date'])","43f93004":"# \u884c\u3001\u5217\u6578\u91cf\u4e0e\u524d5\u7b14\u6837\u672c\nprint('Train', df_train.shape)\ndf_train.head(5)","89f8cf1a":"# \u57fa\u672c\u4fe1\u606f\ndf_train.info()","1fd20408":"# \u63cf\u8ff0\u6027\u7d71\u8a08\ndf_train.describe()","51ca059d":"#print('Test', df_test.shape)\n#df_test.head()\n\n# \u57fa\u672c\u8cc7\u8a0a\n#df_test.info()\n\n# \u63cf\u8ff0\u6027\u7d71\u8a08\n#df_test.describe()","523e8d70":"#print('Transactions', transactions.shape)\n#transactions.head()\n\n# \u57fa\u672c\u8cc7\u8a0a\n#transactions.info()\n\n# \u63cf\u8ff0\u6027\u7d71\u8a08\n#transactions.describe()","038d962f":"transactions.columns","7178a198":"# \u67f1\u72c0\u5716\ncol = 'target'\ndf_train.groupby([col])[col].count().plot(kind='bar', rot=0, figsize=[10, 6])","f5d59dd6":"# \u6216\u662f\u4f7f\u7528\u4e0b\u9762\u8fd9\u79cd\u65b9\u5f0f\ndf_train[col].value_counts().plot(kind = 'bar', rot = 0, figsize = [10,6])","d44960af":"# \u76f4\u65b9\u5716\ncol = 'feature_4'\nplt.figure(figsize=[10, 6])\nsns.distplot(df_train[col])\n\ncol = 'feature_5'\nplt.figure(figsize=[10, 6])\nsns.distplot(df_train[col])","26a2bfb7":"# \u67f1\u72c0\u5716\ncol = 'feature_1'\ndf_train.groupby([col])[col].count().plot(kind='bar', rot=0, figsize=[10, 6])\nplt.show()\n\ncol = 'feature_2'\ndf_train.groupby([col])[col].count().plot(kind='bar', rot=0, figsize=[10, 6])\nplt.show()\n\ncol = 'feature_3'\ndf_train.groupby([col])[col].count().plot(kind='bar', rot=0, figsize=[10, 6])\nplt.show()","035c4b13":"# \u67f1\u72c0\u5716\ncol = 'first_active_month'\ndf_train.groupby([col])[col].count().plot(kind='bar', figsize=[20, 6], title='First active month count in train set')\nplt.show()\n\ncol = 'first_active_month'\ndf_test.groupby([col])[col].count().plot(kind='bar', figsize=[20, 6], title='First active month count in test set')\nplt.show()","49a906ee":"# \u67f1\u72b6\u56fe - target vs. feature_1, feature_2, feature_3\ncol = 'feature_1'\ndf_train.groupby([col])['target'].sum().plot(kind='bar', rot=0, figsize=[10, 6], title = 'target vs %s' %col)\nplt.show()\n\ncol = 'feature_2'\ndf_train.groupby([col])['target'].mean().plot(kind='bar', rot=0, figsize=[10, 6])\nplt.show()\n\ncol = 'feature_3'\ndf_train.groupby([col])['target'].sum().plot(kind='bar', rot=0, figsize=[10, 6])\nplt.show()","432c4350":"# \u5206\u7ec4\u7bb1\u578b\u56fe - target vs. feature_4, feature_5\ncol = 'feature_4'\nplt.figure(figsize=[10, 6])\nsns.boxplot(x='target', y=col, data=df_train)\n\ncol = 'feature_5'\nplt.figure(figsize=[10, 6])\nsns.boxplot(x='target', y=col, data=df_train)","f5309b66":"# \u76f8\u5173\u6027\u70ed\u529b\u56fe\ndf_corr = df_train.loc[:, ['target', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5']]\nplt.figure(figsize=[10, 10])\nsns.heatmap(df_corr.corr(), cmap='Blues', square=True)","09c1874a":"## 2.4 \u65f6\u95f4\u578b\u53d8\u91cf\u5206\u5e03 - \u67f1\u72b6\u56fe\n\u5927\u90e8\u5206\u7684\u4f1a\u5458\u57282017\u5e74\u6ce8\u518c\uff0c\u4e26\u6709\u4e0a\u5347\u8d8b\u52bf","9f728f87":"### \u4f1a\u5458\u4ea4\u6613\u8bb0\u5f55","84d41996":"## 2.7 \u5404\u53d8\u91cf\u4e4b\u95f4\u7684\u7684\u7ebf\u6027\u76f8\u5173\u6027 - \u76f8\u5173\u6027\u70ed\u529b\u56fe","3f7752b8":"## 1. \u8d44\u6599\n### \u8d44\u6599\u63cf\u8ff0  \nRepurchase_train_baseline.csv - \u539f\u59cb\u8bad\u7ec3\u8d44\u6599\u96c6\uff0c\u5305\u542b\u4f1a\u5458\u7684ID\u4ee5\u53ca\u76f8\u5bf9\u5e94\u7684\u7279\u5f81\u3002\u5176\u4e2d\u5305\u542b\u9884\u6d4b\u76ee\u6807(target)\uff0c\u5bf9\u5e94\u9898\u76ee\u4e2d\u7684\u662f\u5426\u56de\u8d2d\u3002  \nRepurchase_test_baseline.csv - \u539f\u59cb\u6d4b\u8bd5\u8d44\u6599\u96c6\u3002  \ntransactions.csv - \u4f1a\u5458\u4ea4\u6613\u8bb0\u5f55\uff0c\u5305\u542b\u4f1a\u5458ID\u3001\u5546\u5bb6ID\u3001\u4ea4\u6613\u91d1\u984d\u3001\u54c1\u9879\u7b49\u4fe1\u606f\u3002  ","763db4c0":"## 1.2 \u8d44\u6599\u6982\u89c8","7d50583d":"## 2.2 \u6570\u503c\u578b\u53d8\u91cf\u5206\u5e03 - \u76f4\u65b9\u56fe","10ac6746":"## 1.1 \u8bfb\u53d6\u8d44\u6599","62d9d986":"### \u8bad\u7ec3\u8d44\u6599\u96c6","98c55a3d":"## 2.1 \u53d8\u91cf\u5206\u5e03\u56fe - \u67f1\u72b6\u56fe","f66dc25f":"## 2.5 \u76ee\u6807\u53d8\u91cf\u5728\u7c7b\u522b\u578b\u53d8\u91cf\u4e2d\u5404\u7c7b\u522b\u4e0b\u7684\u5206\u5e03\u72c0\u6cc1 - \u67f1\u72b6\u56fe","34bb7196":"### \u6d4b\u8bd5\u8d44\u6599\u96c6","08c6fe0f":"Based on the historical data of some members, predict who in another group of members will buy back products.\nUser data in the retail industry, including personal information, transaction records, etc., can help operations or marketing strategies","3db3e226":"## 2.6 \u6570\u503c\u578b\u53d8\u91cf\u5728\u5728\u76ee\u6807\u53d8\u91cf\u4e2d\u4e0d\u540c\u7c7b\u522b\u4e0b\u7684\u5206\u5e03\u72b6\u6001 - \u5206\u7ec4\u7bb1\u5f62\u56fe","874f25c7":"## 2.3 \u7c7b\u522b\u578b\u53d8\u91cf\u5206\u5e03 - \u67f1\u72b6\u56fe","532608ae":"## \u591a\u53d8\u91cf","3009069a":"## 2. \u8d44\u6599\u89c6\u89c9\u5316 & \u63a2\u7d22\u6027\u5206\u6790","a4271f4c":"## Initial setting","09459c85":"# Member Repurchase Forecast\n## Exploratory Data Analysis (EDA)"}}