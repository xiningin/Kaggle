{"cell_type":{"345a668d":"code","7814090c":"code","2405a801":"code","284b9ba4":"code","301c3602":"code","8555d4cb":"code","46641201":"code","44183e81":"code","eee26354":"code","e30d8050":"code","67af2a17":"code","dabecb3d":"code","92ae66c5":"code","21e762b7":"code","58adf66e":"code","7014d350":"code","2926f999":"code","8db9292a":"code","0f0078bf":"code","de952257":"markdown","3211a79c":"markdown","70f49ca5":"markdown","424a1d63":"markdown","c9fc00a0":"markdown","38f799fa":"markdown","e8252ba1":"markdown","29c0cde5":"markdown","bf3cd407":"markdown","a35f23cb":"markdown"},"source":{"345a668d":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk(''):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","7814090c":"bklyn_imdb = pd.read_csv(\"..\/input\/brooklyn-99-episode-data\/brooklyn99_imdb.csv\", parse_dates=[\"original_air_date\"])\nbklyn_ep = pd.read_csv(\"..\/input\/brooklyn-99-episode-data\/brooklyn99_episodes.csv\", parse_dates=[\"original_air_date\"])","2405a801":"bklyn_imdb.head()","284b9ba4":"bklyn_imdb.info()","301c3602":"bklyn_ep.head()","8555d4cb":"bklyn_ep.info()","46641201":"#first we clean the duplicated columns and description (not useful)\nbklyn_imdb.drop(columns=[\"season\",\"episode_num\", \"desc\"], inplace=True)\n\nbrk99_df = pd.merge(bklyn_ep, bklyn_imdb, how='left', on=[\"original_air_date\", \"title\"])","44183e81":"# prod_code is merely a combination of season and episode_num_in_season so we drop it too\nbrk99_df.drop(columns=[\"prod_code\"], inplace=True)\n\n# we reattribute the index to be the episode_num_overall\nbrk99_df.set_index(\"episode_num_overall\",drop=True, inplace=True)\n\n# For fun we will check if the length of the title has an impact on the ratings\nplt.figure(figsize=(5,10))\nsns.scatterplot(data=brk99_df, x=brk99_df[\"title\"].str.len(),\n                y=\"imdb_rating\", hue=\"season\", palette=\"rainbow\", legend=\"full\")","eee26354":"#so we drop title too\nbrk99_df.drop(columns=[\"title\"], inplace=True)","e30d8050":"plt.figure(figsize=(10,5))\nsns.scatterplot(data=brk99_df, x=\"episode_num_overall\", \n                y=\"imdb_rating\", hue=\"season\", palette=\"rainbow\", legend=\"full\")","67af2a17":"plt.figure(figsize=(10,5))\nsns.scatterplot(data=brk99_df, x=\"episode_num_overall\", \n                y=\"total_votes\", hue=\"season\", palette=\"rainbow\", legend=\"full\")","dabecb3d":"#from importlib import reload\n#reload(plt)\nplt.figure(figsize=(10,5))\n# This will remove one outlier: episode 1x15 at 15M Us viewers... \n# which was aired right after the SuperBowl XLVIII on February 2, 2014\nplt.ylim(0, 8000000) \nsns.scatterplot(data=brk99_df, x=\"episode_num_overall\", \n                y=\"us_viewers\", hue=\"season\", palette=\"rainbow\", legend=\"full\")","92ae66c5":"# This will remove one outlier: episode 1x15 at 15M Us viewers... \n# which was aired right after the SuperBowl XLVIII on February 2, 2014\nplt.ylim(0, 8000000) \n\nsns.scatterplot(data=brk99_df, x=\"imdb_rating\", y=\"us_viewers\",\n                hue=\"season\", legend=\"full\",palette=\"rainbow\")","21e762b7":"# first we'll look at the median ratings for all the seasons to have an idea of the impact of the writters\n# and directors on the quality of the episode\nprint(\"Median ratings per season:\\n\", brk99_df.groupby(\"season\")[\"imdb_rating\"].median())\nprint(\"\\nOverall meadian rating for the serie:\", brk99_df[\"imdb_rating\"].median())\n","58adf66e":"# here are the top 10 most common directors for Brooklyn 99\ntop10_dir = brk99_df[\"directed_by\"].value_counts().head(10).index\ndisplay(brk99_df[\"directed_by\"].value_counts().head(10))","7014d350":"# And here are the top 10 most common writters for Brooklyn 99\ntop10_wrt = brk99_df[\"written_by\"].value_counts().head(10).index\ndisplay(brk99_df[\"written_by\"].value_counts().head(10))","2926f999":"display(brk99_df[brk99_df[\"written_by\"].str.contains(\"Jackson\")])\ndisplay(brk99_df[brk99_df[\"written_by\"].str.contains(\"Goor\")])","8db9292a":"#let's check the median ratings for the 10 most common directors\ntop10_dir_df = brk99_df[brk99_df[\"directed_by\"].isin(top10_dir)]\nplt.figure (figsize=(20,5))\nplt.ylim(7.5, 10)\nsns.barplot(data=top10_dir_df, x=\"directed_by\", y=\"imdb_rating\")\n","0f0078bf":"#And now let's check the median ratings for the 10 most common writters\ntop10_wrt_df = brk99_df[brk99_df[\"written_by\"].isin(top10_wrt)]\nplt.figure (figsize=(20,5))\nplt.ylim(7.5, 10)\nsns.barplot(data=top10_wrt_df, x=\"written_by\", y=\"imdb_rating\")","de952257":"We will here check the impact from the writting and direction on the rating. As there are a multitude of writers and directors for all the episodes, we will focus only on the 10 most occuring ones.","3211a79c":"We can see on the plot above that the imdb_rating has a much higher standard deviation after the 5th season which corresponds to the switch from Fox to NBC following poor total viewers number (even though the critics were good).","70f49ca5":"Absolutely no impact ! Which is not really surprising but allows us to remove the title as well as it is not planned to perform any NLP on this.","424a1d63":"It is interesting to note than Dan Goor seems to be the only one to be present on both list.\nTo be noted: I did not accounted for the people writting or directed in duo (as it was often the case for Phil Augusta Jackson or Dan Goor). E.g Below","c9fc00a0":"We note that the median rating is pretty constant and high for all the seasons.","38f799fa":"You can clearly see on this chart the decreasing audience as well as the small regain after NBC acquired the rights of the serie. This shows that the global interest for the series was really decreasing year after year as the \"standard\" trajectory for serie audience is usually to increase for the last episodes of the season. Even though this is a bit less the case for humoristic serie where the scenario plot is less important.","e8252ba1":"What we can see is that Dan Goor, either as writter or director, is having a good impact on the imdb_rating of the series.","29c0cde5":"### Direction and writting impact","bf3cd407":"The plot representing total_votes shows as well the decreasing interest for the serie whose season spanned 8 years from september 2013 to september 2021.\nWe can hypothesize that the poor total_votes from season 8 is mainly due to the fact that it ended less than 2 months before data were extracted.","a35f23cb":"### Goal : What is driving the imdb_rating of Brooklyn 99 ?\n2 main questions to be answered :\n1. What is the evolution of the rating, total_votes and us_viewerers through the different seasons ?\n2. Does the writter or the director has any impact on the rating of the episodes ?"}}