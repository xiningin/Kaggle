{"cell_type":{"cda0be3b":"code","07ccc927":"code","9a147c4b":"code","f96f63c3":"code","c0e9908e":"code","a2d6e1e3":"code","4e870cf4":"code","09252e23":"code","6cb95b3a":"code","1e676bd9":"code","7edb8d0f":"code","d4961768":"code","5696e13c":"code","d05c3111":"code","961ca404":"code","a090ce5b":"code","1a5ebfc3":"code","e89b540c":"code","66d25c01":"code","dc8f6b21":"code","3fc53e25":"code","7ce96380":"code","794f7a48":"code","73a5faf0":"code","e6f840e0":"code","54946bb2":"code","ed36712d":"code","346cbf07":"code","59cd28bd":"code","fbc974a6":"code","a660214e":"code","0aa4715a":"code","f441e02f":"code","8366d5dc":"code","d6acb0ef":"code","7c97d819":"code","30150589":"code","449adcc5":"code","f99f78a1":"code","4e1f8558":"code","2833816d":"code","9b25af23":"code","85462325":"code","a4f0d36b":"code","0d0a8ebd":"markdown"},"source":{"cda0be3b":"### import all required library\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n","07ccc927":"df = pd.read_csv(\"..\/input\/vehicle-dataset-from-cardekho\/car data.csv\")\n","9a147c4b":"df.shape","f96f63c3":"print(df['Seller_Type'].unique())\nprint(df['Fuel_Type'].unique())\nprint(df['Transmission'].unique())\nprint(df['Owner'].unique())","c0e9908e":"df.isnull().sum().sum()","a2d6e1e3":"df.describe()","4e870cf4":"df.columns","09252e23":"final_dataset=df[['Year', 'Selling_Price', 'Present_Price', 'Kms_Driven',\n       'Fuel_Type', 'Seller_Type', 'Transmission', 'Owner']]","6cb95b3a":"final_dataset.head()","1e676bd9":"final_dataset['current_year']=2020\nfinal_dataset.head()","7edb8d0f":"final_dataset['no_year']=final_dataset['current_year']-final_dataset['Year']","d4961768":"final_dataset.head()","5696e13c":"final_dataset.drop(['Year'],axis=1,inplace=True)","d05c3111":"final_dataset.head()","961ca404":"final_dataset.drop(['current_year'],axis=1,inplace=True)","a090ce5b":"final_dataset.head()","1a5ebfc3":"final_dataset=pd.get_dummies(final_dataset,drop_first=True)","e89b540c":"final_dataset.head()","66d25c01":"final_dataset.corr()","dc8f6b21":"sns.pairplot(final_dataset)","3fc53e25":"corrmat=final_dataset.corr()\ntop_corr_features=corrmat.index\nplt.figure(figsize=(20,20))\nsns.heatmap(final_dataset[top_corr_features].corr(),annot=True,cmap='YlOrBr')","7ce96380":"final_dataset.head()","794f7a48":"X=final_dataset.iloc[:,1:]\ny=final_dataset.iloc[:,0]","73a5faf0":"X.head()","e6f840e0":"y.head()","54946bb2":"from sklearn.ensemble import ExtraTreesRegressor\nmodel=ExtraTreesRegressor()\nmodel.fit(X,y)","ed36712d":"print(model.feature_importances_)","346cbf07":"feat_importance=pd.Series(model.feature_importances_,index=X.columns)\nfeat_importance\nfeat_importance.nlargest(5).plot(kind='barh')\nplt.show()","59cd28bd":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=.3,random_state=0)","fbc974a6":"X_train.shape","a660214e":"X_test.shape","0aa4715a":"from sklearn.ensemble import RandomForestRegressor\nrf=RandomForestRegressor()","f441e02f":"# hyperparameter \n\nn_estimators=[int(x) for x in np.linspace(100,1200 ,12)]\nprint(n_estimators) ","8366d5dc":"n_estimators = [int(x) for x in np.linspace(start = 100, stop = 1200, num = 12)]\n# Number of features to consider at every split\nmax_features = ['auto', 'sqrt']\n# Maximum number of levels in tree\nmax_depth = [int(x) for x in np.linspace(5, 30, num = 6)]\n# max_depth.append(None)\n# Minimum number of samples required to split a node\nmin_samples_split = [2, 5, 10, 15, 100]\n# Minimum number of samples required at each leaf node\nmin_samples_leaf = [1, 2, 5, 10]","d6acb0ef":"from sklearn.model_selection import RandomizedSearchCV\n","7c97d819":"## crate the random grid\n\nrandom_grid={'n_estimators':n_estimators,\n            'max_features':max_features,\n            'max_depth':max_depth,\n            'min_samples_split':min_samples_split,\n            'min_samples_leaf': min_samples_leaf}\nprint(random_grid)","30150589":"rf=RandomForestRegressor()","449adcc5":"rf_random=RandomizedSearchCV(estimator=rf,param_distributions=random_grid,scoring='neg_mean_squared_error', n_iter=10,cv=5,verbose=2,random_state=42,n_jobs=1)","f99f78a1":"rf_random.fit(X_train,y_train)","4e1f8558":"prediction=rf_random.predict(X_test)","2833816d":"prediction","9b25af23":"sns.distplot(y_test-prediction)","85462325":"plt.scatter(y_test,prediction)","a4f0d36b":"import pickle\nfile=open('random_forest_regression_model.pkl','wb')\npickle.dump(rf_random,file)","0d0a8ebd":"# Feature importance"}}