{"cell_type":{"84a21fc4":"code","2359cba4":"code","c57a47ba":"code","74343051":"code","773f249f":"code","d25363a1":"code","360874e1":"code","7255123e":"code","097e68ca":"code","32e2ede5":"code","e98bfa06":"code","20201b81":"code","11dc537e":"code","0be95390":"code","52f67f52":"markdown","3255bdb7":"markdown","8e9f64e8":"markdown","598d887c":"markdown","3d8741b7":"markdown","86fc800e":"markdown","ecc9d2d5":"markdown","feb81a6c":"markdown","1f89ca4d":"markdown","365d55a6":"markdown","6254d773":"markdown","4b99b9b6":"markdown","6944aa86":"markdown","d027791b":"markdown","793362d3":"markdown"},"source":{"84a21fc4":"CREATE TABLE atp_top100 AS\n\tSELECT *\n\tFROM atp_rankings_current r INNER JOIN atp_players p ON r.player == p.player_id\n\tWHERE r.rank <= 100;","2359cba4":"ALTER TABLE atp_top100\n\tDROP COLUMN player;\nALTER TABLE atp_top100\n\tDROP COLUMN height;\nALTER TABLE atp_top100\n\tDROP COLUMN wikidata_id;","c57a47ba":"ALTER TABLE atp_top100\n\tADD COLUMN age INT;\n\nUPDATE atp_top100\nSET age = (20211122 - atp_top100.dob)\/10000 -- divide by 10000 to get the year, which is the age;","74343051":"ALTER TABLE atp_top100\n\tADD COLUMN r_d_str TEXT;\n\nUPDATE atp_top100\nSET r_d_str = CAST(atp_top100.ranking_date AS TEXT);\n\nUPDATE atp_top100\nSET r_d_str = SUBSTR(r_d_str, 1, LENGTH(r_d_str)-4) || '-' || SUBSTR(SUBSTR(r_d_str, -4), 1, LENGTH(SUBSTR(r_d_str, -4))-2) || '-' || SUBSTR(r_d_str, -2);\n\nALTER TABLE atp_top100\n\tADD COLUMN week_num INT;\n\t\nUPDATE atp_top100\nSET week_num = strftime('%W', atp_top100.r_d_str);","773f249f":"ALTER TABLE atp_top100\n\tADD COLUMN name_full TEXT;\n\t\nUPDATE atp_top100\nSET name_full = name_first || ' ' || name_last;","d25363a1":"ALTER TABLE atp_top100\n\tADD COLUMN dob_str TEXT;\n\nUPDATE atp_top100\nSET dob_str = CAST(dob AS TEXT);\n\nUPDATE atp_top100\nSET dob_str = SUBSTR(dob_str, 1, LENGTH(dob_str)-4) || '-' || SUBSTR(SUBSTR(dob_str, -4), 1, LENGTH(SUBSTR(dob_str, -4))-2) || '-' || SUBSTR(dob_str, -2);","360874e1":"SELECT DISTINCT name_full\nFROM atp_top100\nWHERE rank <= 5;","7255123e":"SELECT COUNT(DISTINCT name_full) AS number_of_player_over_30\nFROM atp_top100\nWHERE age >= 30 AND rank <= 25;\n\nSELECT DISTINCT name_full\nFROM atp_top100\nWHERE age >= 30 AND rank <= 25;","097e68ca":"SELECT COUNT(DISTINCT name_full) AS number_of_player_left_handed\nFROM atp_top100\nWHERE hand == 'L';\n\nSELECT DISTINCT name_full\nFROM atp_top100\nWHERE hand == 'L';","32e2ede5":"SELECT DISTINCT name_full\nFROM atp_top100\nWHERE ioc == 'CAN';","e98bfa06":"SELECT name_full, MIN(rank) AS highest_rank\nFROM atp_top100\nWHERE ioc == 'CAN'\nGROUP BY name_full;","20201b81":"SELECT a.r_d_str AS date, a.week_num, a.name_full, a.rank\nFROM atp_top100 AS a\nWHERE a.name_full == 'Roger Federer' AND a.rank <> (\n\tSELECT b.rank\n\tFROM atp_top100 AS b\n\tWHERE a.name_full == b.name_full AND a.ranking_date > b.ranking_date\n\tORDER BY b.ranking_date DESC\n\tLIMIT 1\n\t) -- subquery use temp table to compare rank changes\n\tOR a.week_num == 1 AND a.name_full == 'Roger Federer'; -- this line to capture week 1 rank","11dc537e":"SELECT name_full, MIN(rank) AS highest_rank, MAX(rank) AS lowest_rank, age, hand, ioc\nFROM atp_top100\nWHERE age == (\n\tSELECT MIN(age)\n\tFROM atp_top100\n\t)\nGROUP BY name_full;\n\nSELECT name_full, MIN(rank) AS highest_rank, MAX(rank) AS lowest_rank, age, hand, ioc\nFROM atp_top100\nWHERE age == (\n\tSELECT MAX(age)\n\tFROM atp_top100\n\t)\nGROUP BY name_full;","0be95390":"SELECT ioc, MIN(rank) AS highest_rank, COUNT(DISTINCT name_full) AS num_of_player\nFROM atp_top100\nGROUP BY ioc\nORDER BY num_of_player DESC;","52f67f52":"-- Data Cleaning\/Transforming\n-- drop unused columns (player is the same as player_id, remove one of them; not intereseted in height and wikidata_id)\n-- SQLite has limited functionality in dropping columns, it did not work for me to drop multiple columns in one line, but I manage with one at a time.","3255bdb7":"-- Who is the youngest top 100 rank player? Who is the oldest?","8e9f64e8":"-- How many players in the top 25 are over age 30 in 2021, and who are they?","598d887c":"-- atp_top100 table is exported as a csv file for further analysis and visualization with tableau public.\n\n## Tableau Public Visualization\nVisualization can be found [here](https:\/\/public.tableau.com\/app\/profile\/peter4709\/viz\/ATPTop100Men2021\/ATPTop100Men2021).\n\n## Insights\n* Out of top 100 ranked men on week #47, 83 are righthanded and 17 are lefthanded.\n* 79 are between the age of 22 and 33, 2 under the age of 20, and 1 over the age of 37, who is Roger Federer (40).\n* The 2 oldest players in the top 100 are both from Switzerland, Roger at 40 and Stan Wawrinka at 36.\n* Top 10 ranked players are all from Europe, the first non-EU ranked player is Felix Auger-Aliassime at rank 11.\n* In the top 20 ranked players, only 4 players are from non-EU countries, 2 from Canada, 1 from Chilie, and 1 from Argentina.\n* Speaking of Canadian players, 3 players are ranked top 100, Felix A-A (11), Denis Shapovalov (14), and Milos Raonic (70), who was rank 14 at the beginning of 2021.\n* Even though US has the highest # of players in the top 100 (at 12), none of them at in the top 20, highest being Taylor Fritz at 23.","3d8741b7":"-- use the date when the rank is first updated to figure out week #\n-- convert ranking_date to string in order to use the date functions, add '-' for proper format of date string","86fc800e":"-- Querying Samples, we can ask many questions for example the following:\n-- Who has ever ranked top 5 in 2021?","ecc9d2d5":"-- combine first name and last name into full name_first","feb81a6c":"-- How many top 100 players are from each country?","1f89ca4d":"-- What is their highest rank achieved?","365d55a6":"## ATP Top 100 Men 2021\n-----\n## Project Goal\n1. EDA of the datasets for the ATP top 100 ranked men tennis players\n1. Preprocessing with SQLite, data cleaning\/transforming and aggregating additional data for later analysis\n1. Sample querying for EDA\n1. Using tableau public visualization to aid with EDA process\n\n\n## Data Source\nOriginal datasets are by Jeff Sackmann \/ Tennis Abstract and are licensed under licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.The datasets can be found [here](https:\/\/github.com\/JeffSackmann\/tennis_atp). Datasets were last retrieved on 2021-11-24, and contained data up to 2021-11-22.\n\n## ETL with SQLite (Script)\n-- Combine two tables with only top 100 ATP rank players","6254d773":"-- How has Roger Federer's rank changes throughout the year?","4b99b9b6":"-- How many of the top 100 players are from Canada?","6944aa86":"-- calculate additional data for analysis and for ease of visulization later, specifically, age of players, full name, and week # in 2021 (rankings is updated once a week)\n-- SQLite does not have date data type, we can just use arithmitic formula to calculate age\n-- we will use the date when the data source is last updated as the current date, which is Nov 22, 2021","d027791b":"-- convert date of birth to date string format as well","793362d3":"-- How many of the top 100 ranked players in 2021 are left handed, and who are they?"}}