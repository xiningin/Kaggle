{"cell_type":{"c6299583":"code","22f62dc7":"code","1f4fff0c":"code","dfc36aad":"code","e0aa94df":"code","1c72dc0e":"code","02157f8c":"code","935ffc9c":"code","736e08db":"code","60176124":"code","0f537a0c":"code","7c1039ac":"code","bc57bc13":"code","8d7db9f3":"code","9aa6594a":"code","06675f4e":"code","ced918be":"code","96999fed":"code","c4c7ca46":"code","9c714ba8":"code","73dfc1d3":"markdown","f7cf5a4b":"markdown","a209cb4c":"markdown","ea459c0c":"markdown","d551cf60":"markdown","e8de64f4":"markdown","39e49fd8":"markdown","2519b545":"markdown","7e41fe44":"markdown","d82d85a1":"markdown","ffc9ae2c":"markdown","e475fd8a":"markdown","72914cfc":"markdown","f8f0ab60":"markdown","6128d2cf":"markdown","0e973617":"markdown","138cc6a2":"markdown","6e151006":"markdown","ce5cf06f":"markdown","a9d56c4e":"markdown","570aa8c9":"markdown","d408032d":"markdown","578fb3d1":"markdown","029f4c1c":"markdown","7dc6ef0d":"markdown","59a33e7d":"markdown","173894d3":"markdown","dd92d70f":"markdown"},"source":{"c6299583":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score","22f62dc7":"wine_data = pd.read_csv('..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv')\nwine_data.head()","1f4fff0c":"wine_data.info()","dfc36aad":"wine_data.isnull().sum()","e0aa94df":"# We can use a heatmap to check correlation between the variables.\ncorr = wine_data.corr()\nplt.figure(figsize=(8,8))\nsns.heatmap(corr,cbar=True,square=True,fmt='.1f',annot=True,cmap='Reds')","1c72dc0e":"qs = wine_data['quality'].unique()\nsorted(qs)","02157f8c":"# Sulphates vs Quality\nplt.figure(figsize=(10,10))\nx = wine_data.quality\ny = wine_data.sulphates\nplt.bar(x,y)\nplt.xlabel(\"Quality\")\nplt.ylabel(\"Sulphates\")\nplt.show()","935ffc9c":"# Volatile Acidity vs Quality\nplt.figure(figsize=(10,10))\nsns.barplot(x='quality',y='volatile acidity',data=wine_data)","736e08db":"# pH vs Quality\nplt.figure(figsize=(10,10))\nsns.barplot(x='quality',y='pH',data=wine_data)","60176124":"plt.figure(figsize=(10,10))\nsns.countplot(x=\"quality\", data=wine_data)","0f537a0c":"# We need to split the data\nX = wine_data.drop(['quality'],axis=1) # We need all the variables (columns) as independent variables so we're just dropping the target column to make things easier.","7c1039ac":"# Binarization\n# this function will take each wine quality and if it is 6 or more, it will be labelled as 1\/'good' wine.\ny = wine_data['quality'].apply(lambda quality: 1 if quality >= 6 else 0)","bc57bc13":"# Then we split the data into training and testing data\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size = 0.2, random_state = 2) # 80% data will be used for training the model and rest 20% for testing.","8d7db9f3":"print(X.shape,X_train.shape)","9aa6594a":"model = RandomForestClassifier()","06675f4e":"# Now we need to train the model\nmodel.fit(X_train,y_train) # fitting means training","ced918be":"train_pred = model.predict(X_train)\ntrain_pred","96999fed":"# Now let's check accuracy score on training data\nTraining_score = accuracy_score(train_pred,y_train) #(Basically comparing the original y_train and predictions and seeing difference\/error)\nprint(\"Accuracy Score:\",Training_score)","c4c7ca46":"test_pred = model.predict(X_test)\ntest_pred","9c714ba8":"# Accuracy Score\nTest_score = accuracy_score(test_pred,y_test) \nprint(\"Accuracy Score:\",Test_score)","73dfc1d3":"**Our model is 100% accurate on training data. WOAH.**","f7cf5a4b":"**Machine learning is divided into supervised and unsupervised learning. We train our model with data that we have previously acquired in supervised learning. In unsupervised learning, we have no data that we can train our model with.**\n\n**Supervised machine learning is divided into classification and regression. In classification, we predict discrete values, e.g. Yes\/No, Customer will purchase\/Won't purchase. But in regression, we predict continuous values, such as age, price, etc.**","a209cb4c":"# Conclusion","ea459c0c":"**First, we need to use the model to predict good\/poor quality from the training data. Then, we check our model's accuracy using accuracy score.**","d551cf60":"**A random forest is a machine learning technique that\u2019s used to solve regression and classification problems. It consists of many decision trees.  It is based on the concept of ensemble learning, which is a process of combining multiple classifiers to solve a complex problem and to improve the performance of the model.**\n\n**It contains a number of decision trees on various subsets of the given dataset and takes the average to improve the predictive accuracy of that dataset. The greater number of trees in the forest leads to higher accuracy and prevents the problem of overfitting.**","e8de64f4":"**We have more samples of wines with mediocre qualuty but very few samples for bad quality and great quality wines. If the dataset overall had more samples, maybe we'd have more samples for those and the results would be more reliable.**","39e49fd8":"# Splitting Data","2519b545":"So basically the workflow is like this: Import libraries and dataset -> check for missing values -> perform necessary imputation -> Exploratory Data Analysis -> split data -> train model -> check its accuracy -> improve model or try other ones.\n\n**To get better accuracy, try different models or use more training data.**","7e41fe44":"**This notebook is a guide for beginners into machine learning, random forest models to be more specific. There will be comments every step of the way so there is a clear understanding. We will be building a system that predicts quality of red wine.**","d82d85a1":"**We can make observations such as, as quantity of alcohol increases, the quality of red wine betters. But, as volatile acidity increases,the quality of red wine deteriorates.**","ffc9ae2c":"**Mediocre quality wines have high amounts of sulphates but interestingly, both poor and great quality wines have similar amounts of sulphates.**","e475fd8a":"# Importing libraries and dataset","72914cfc":"# Prediction and Evaluation of the Model","f8f0ab60":"# Random Forest","6128d2cf":"**As we can see, 1279 rows are used for testing out of 1599 which is about 80% of the data.**","0e973617":"# Model Building","138cc6a2":"# Introduction","6e151006":"# Missing Values","ce5cf06f":"**Wines with good quality have less volatile acidity.**","a9d56c4e":"**BUT, the model is only about 77% accurate on test data. 75+ % is good enough but it could be better. Maybe, if we used some other model.**","570aa8c9":"**We can see that the quality column has the values from 3-8. No 1 or 2. 3 being the worst quality and 8, the best.**","d408032d":"**Good thing we have no missing values in this dataset so no imputation (replacing missing values with other appropriate ones) necessary.**","578fb3d1":"# Supervised Machine Learning","029f4c1c":"**Now we need to separate the quality column and store it in 'y'. But before that, we need to binarize the y labels, for example into 1\/0 to represent good\/bad. We need to do this as there are way too many labels in that column.**","7dc6ef0d":"**We're going to use a random forest model.**","59a33e7d":"**But keep in mind that we used training data to check accuracy. We need to check using test data for a better understanding.**","173894d3":"# Exploratory Data Analysis","dd92d70f":"**pH of all types of wine are rather similar, close to 3.5, mildly acidic. But this could be disproved if there were more samples.**"}}