{"cell_type":{"9efb9f21":"code","52cd2809":"code","73101d2b":"code","f23462b5":"code","ac755bcb":"code","6b5eb580":"code","67da967f":"code","a4216a91":"code","57433f85":"code","633a1e35":"code","7999ebe0":"code","57d4ac13":"code","7358ab14":"code","9cee25c3":"code","0bf59468":"code","225bffd7":"code","a8dded4c":"code","3bbf0ed4":"code","d396d77a":"code","9924afb4":"code","f6ad69f3":"code","d6109ee9":"code","45cf4f2d":"code","7c7d5e17":"markdown","4308ea35":"markdown","59f8d5de":"markdown","a693e655":"markdown"},"source":{"9efb9f21":"import os\nimport numpy as np\nimport pandas as pd\nimport xgboost as xgb\nimport seaborn as sns\nfrom xgboost import DMatrix\nimport matplotlib.pyplot as plt\nfrom xgboost import plot_importance, plot_tree\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.metrics import confusion_matrix, recall_score\nimport lightgbm as lgb\nfrom sklearn.metrics import accuracy_score\nfrom tqdm import tqdm\n# \u30c1\u30e3\u30fc\u30c8\u7528\u8a2d\u5b9a\n# setting for chart\nimport plotly as py\nimport plotly.io as pio\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot\nfrom warnings import simplefilter\nsimplefilter(action='ignore', category=FutureWarning)\nsimplefilter(action='ignore', category=DeprecationWarning)\n\ninit_notebook_mode(connected=True)\nlayout=go.Layout(paper_bgcolor='rgba(0,0,0,0)', plot_bgcolor='rgba(250,250,250,0.8)')\nfig = go.Figure(layout=layout)\ntemplated_fig = pio.to_templated(fig)\npio.templates['my_template'] = templated_fig.layout.template\npio.templates.default = 'my_template'","52cd2809":"test_day_count = 200\ndef ready_data():\n    # \u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\n    # read csv and modify type of columns\n    df = pd.read_csv(\"\/kaggle\/input\/topix4\/TOPIX4.csv\", names=(\"Date\", \"Open\", \"High\", \"Low\", \"Close\")).drop(0)\n    df['Date'] = pd.to_datetime(df['Date'])\n    df = df[(df['Date'].dt.year >= 2010)].copy()\n    df.index = range(len(df))\n    df[\"Open\"] = df['Open'].astype(float)\n    df[\"Close\"] = df['Close'].astype(float)\n    df[\"High\"] = df['High'].astype(float)\n    df[\"Low\"] = df['Low'].astype(float)\n    # \u79fb\u52d5\u5e73\u5747\u7dda\u3068\u79fb\u52d5\u6a19\u6e96\u504f\u5dee\n    # moving average and deviation of moving average\n    df['EMA_9'] = df['Close'].ewm(9).mean().shift() \/ df['Close']\n    df['SMA_5'] = df['Close'].rolling(5).mean().shift() \/ df['Close']\n    df['SMA_10'] = df['Close'].rolling(10).mean().shift() \/ df['Close']\n    df['SMA_15'] = df['Close'].rolling(15).mean().shift() \/ df['Close']\n    df['SMA_30'] = df['Close'].rolling(30).mean().shift() \/ df['Close']\n    df['EMA_9_std'] = df['Close'].ewm(9).std().shift() \/ df['Close']\n    df['SMA_5_std'] = df['Close'].rolling(5).std().shift() \/ df['Close']\n    df['SMA_10_std'] = df['Close'].rolling(10).std().shift() \/ df['Close']\n    df['SMA_15_std'] = df['Close'].rolling(15).std().shift() \/ df['Close']\n    df['SMA_30_std'] = df['Close'].rolling(30).std().shift() \/ df['Close']\n    # \u6307\u6570\u5e73\u6ed1\u79fb\u52d5\u5e73\u5747\n    # Exponential Moving Average\n    # \u6307\u6570\u5e73\u6ed1\u79fb\u52d5\u5e73\u5747\u306e\u65e5\u672c\u8a9e\u306e\u8aac\u660e\u2193\n    # https:\/\/media-kojirokousi.com\/exponential-moving-average\/#:~:text=%E6%8C%87%E6%95%B0%E5%B9%B3%E6%BB%91%E7%A7%BB%E5%8B%95%E5%B9%B3%E5%9D%87%E7%B7%9A(EMA)%E3%81%AF%E3%80%81%E5%BE%93%E6%9D%A5%E3%81%AE,EMA%E3%81%A8%E5%91%BC%E3%81%B0%E3%82%8C%E3%81%BE%E3%81%99%E3%80%82\n    EMA_12 = pd.Series(df['Close'].ewm(span=12, min_periods=12).mean())\n    EMA_26 = pd.Series(df['Close'].ewm(span=26, min_periods=26).mean())\n    # MACD\n    # MACD\u306e\u65e5\u672c\u8a9e\u306e\u8aac\u660e\u2193\n    # https:\/\/www.sevendata.co.jp\/shihyou\/technical\/macd.html\n    df['MACD'] = pd.Series(EMA_12 - EMA_26)\/ df['Close']\n    df['MACD_signal'] = pd.Series(df.MACD.ewm(span=9, min_periods=9).mean())\/ df['Close']\n    df['RSI'] = relative_strength_idx(df).fillna(0)\n    df[\"Change_label\"] = change_rate(df)\n    return df\n\ndef relative_strength_idx(df, n=14):\n    close = df['Close']\n    # \u7d42\u5024\u306e\u524d\u65e5\u3068\u306e\u5dee\u5206\n    # diff from previous day\n    delta = close.diff()\n    delta = delta[1:]\n    pricesUp = delta.copy()\n    pricesDown = delta.copy()\n    # \u7d42\u5024\u306e\u4e0a\u304c\u308a\u306e\u307f\u3001\u4e0b\u304c\u308a\u306e\u307f\u3067\u305d\u308c\u305e\u308c\u30ab\u30e9\u30e0\u3092\u4f5c\u308b\n    pricesUp[pricesUp < 0] = 0\n    pricesDown[pricesDown > 0] = 0\n    # 14\u65e5\u9593\u306e\u5e73\u5747\u5024\u4e0a\u304c\u308a\u3068\u3001\u5e73\u5747\u5024\u4e0b\u304c\u308a\n    rollUp = pricesUp.rolling(n).mean()\n    rollDown = pricesDown.abs().rolling(n).mean()\n    rs = rollUp \/ rollDown\n    #100-0\u306b\u5909\u63db\n    rsi = 100.0 - (100.0 \/ (1.0 + rs))\n    return rsi\n\ndef change_rate(df):\n    #\u8a55\u4fa1\u306b\u7d42\u5024\u306e\u5909\u5316\u7387\u3092\u4f7f\u3046\u305f\u3081\n    #\u5927\u304d\u3044\u30d7\u30e9\u30b9\u3001\u5c0f\u3055\u3044\u30d7\u30e9\u30b9\u3001....\u5927\u304d\u3044\u30de\u30a4\u30ca\u30b9\u306e\u3088\u3046\u306a\u5f62\u3067\u30e9\u30d9\u30eb\u3067\u8003\u3048\u308b\u3053\u3068\u3082\u3067\u304d\u308b\n    # qualtile([0.2, 0.4, 0.6, 0.8])\u3067\u95be\u5024\u3092\u6c7a\u5b9a\n    df['Change_rate'] = df['Close'].pct_change()\n    df.loc[(df['Change_rate'] > -0.001714) & (df['Change_rate'] < 0.002856), 'Change_label'] = 0\n    df.loc[(df['Change_rate'] > -0.001714) & (df['Change_rate'] < 0.002856), 'weight'] = 1\n    df.loc[(df['Change_rate'] >= -0.008004) & (df['Change_rate'] <= -0.001714), 'Change_label'] = -1\n    df.loc[(df['Change_rate'] >= -0.008004) & (df['Change_rate'] <= -0.001714), 'weight'] = 1.2\n    df.loc[df['Change_rate'] < -0.008004, 'Change_label'] = -2\n    df.loc[df['Change_rate'] < -0.008004, 'weight'] = 1.5\n    df.loc[(df['Change_rate'] <= 0.008758) & (df['Change_rate'] >= 0.002856), 'Change_label'] = 1\n    df.loc[(df['Change_rate'] <= 0.008758) & (df['Change_rate'] >= 0.002856), 'weight'] = 1.2\n    df.loc[df['Change_rate'] > 0.008758, 'Change_label'] = 2\n    df.loc[df['Change_rate'] > 0.008758, 'weight'] = 1.5\n    return df['Change_label']\n\ndf = ready_data()\ndf.tail(100)","73101d2b":"# \u59cb\u5024\u3001\u9ad8\u5024\u3001\u5b89\u5024\u3001\u7d42\u5024\u306e\u30b0\u30e9\u30d5\n# graph of Open, High, Low, Close\nfig = make_subplots(rows=2, cols=1)\nfig.add_trace(go.Ohlc(x=df.Date,\n                      open=df.Open,\n                      high=df.High,\n                      low=df.Low,\n                      close=df.Close,\n                      name='Price'), row=1, col=1)\nfig.update(layout_xaxis_rangeslider_visible=False)\nfig.show()","f23462b5":"# ema\u3068sma\u306e\u30b0\u30e9\u30d5\n# graph of EMA and SMA\nfig = go.Figure()\nfig.add_trace(go.Scatter(x=df.Date, y=df.EMA_9, name='EMA 9'))\nfig.add_trace(go.Scatter(x=df.Date, y=df.SMA_5, name='SMA 5'))\nfig.add_trace(go.Scatter(x=df.Date, y=df.SMA_10, name='SMA 10'))\nfig.add_trace(go.Scatter(x=df.Date, y=df.SMA_15, name='SMA 15'))\nfig.add_trace(go.Scatter(x=df.Date, y=df.SMA_30, name='SMA 30'))\nfig.add_trace(go.Scatter(x=df.Date, y=df.Close, name='Close', opacity=0.2))\nfig.show()","ac755bcb":"# graph of MACD\n# MACD\u306e\u30b0\u30e9\u30d5\nEMA_12 = pd.Series(df['Close'].ewm(span=12, min_periods=12).mean())\nEMA_26 = pd.Series(df['Close'].ewm(span=26, min_periods=26).mean())\nfig = make_subplots(rows=2, cols=1)\nfig.add_trace(go.Scatter(x=df.Date, y=df.Close, name='Close'), row=1, col=1)\nfig.add_trace(go.Scatter(x=df.Date, y=EMA_12, name='EMA 12'), row=1, col=1)\nfig.add_trace(go.Scatter(x=df.Date, y=EMA_26, name='EMA 26'), row=1, col=1)\nfig.add_trace(go.Scatter(x=df.Date, y=df['MACD'], name='MACD'), row=2, col=1)\nfig.add_trace(go.Scatter(x=df.Date, y=df['MACD_signal'], name='Signal line'), row=2, col=1)\nfig.show()","6b5eb580":"fig = go.Figure(go.Scatter(x=df.Date, y=df.RSI, name='RSI'))\nfig.show()","67da967f":"def modify_and_split_data_for_xgb(df):\n    # \u2193\u524d\u65e5\u306e\u30c7\u30fc\u30bf\u3092\u7279\u5fb4\u91cf\u306b\u5165\u308c\u305f\u304c\u7279\u306b\u91cd\u8981\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u306f\u306a\u304b\u3063\u305f\u305f\u3081\u3001\u524a\u9664\n    # df['today_change_rate_label'] = df['Change_label']\n    \n    # \u524d\u65e5\u306e\u30c7\u30fc\u30bf\u304b\u3089\u3001\u7fcc\u65e5\u306e\u7d42\u5024\u3092\u4e88\u6e2c\u3059\u308b\u305f\u3081\u3001close\u3092shift\u3057\u3066\u3044\u308b\u3002\n    # \u2193we would like to predict tommorow's movement\n    df['Change_label'] = df['Change_label'].shift(-1)\n    df['weight'] = df['weight'].shift(-1)\n    df['Change_rate'] = df['Change_rate'].shift(-1)\n\n    df = df.iloc[33:] # Because of moving averages and MACD line\n    df = df[:-1]      # Because of shifting close price\n    df[\"Change_label\"] = df[\"Change_label\"].astype('int')\n    df = df.reset_index()\n    df = df.drop(['index'], 1)\n    test_df   = df.loc[len(df) - test_day_count:].copy()\n    train_df   = df.loc[: len(df) - test_day_count - 1].copy()\n\n#     \u30c6\u30b9\u30c8\u671f\u9593\u3092\u8a2d\u3051\u305a\u306b\u3001Change_label\u306e\u5272\u5408\u304c\u5747\u7b49\u306b\u306a\u308b\u3088\u3046\u306b\u5206\u5272\u3059\u308b\n#     train_df, valid_df = train_test_split(train_df, test_size=0.19, stratify=train_df.Change_label)\n    train_df, valid_df = train_test_split(train_df, test_size=0.19, stratify=train_df.Change_label, random_state=7843242)\n    return df, train_df, valid_df, test_df\ndf, train_df, valid_df, test_df = modify_and_split_data_for_xgb(df)","a4216a91":"def get_label_and_explanatory_variable(df):\n    drop_cols = ['Date', 'Open', 'Low', 'High', 'Close', 'Change_rate']\n    df = df.drop(drop_cols, 1)\n    # close\u306e\u5024\u3092\u4e88\u6e2c\u3059\u308b\u3053\u3068\u306b\u3059\u308b\u3002\n    label = df['Change_label'].copy()\n    explanatory = df.drop(['Change_label'], 1)\n    return explanatory, label\nX_train, y_train = get_label_and_explanatory_variable(train_df)\nX_valid, y_valid = get_label_and_explanatory_variable(valid_df)\nX_test, y_test = get_label_and_explanatory_variable(test_df)\neval_set = [(X_train, y_train), (X_valid, y_valid)]","57433f85":"weights = X_train[\"weight\"].astype('float')\nX_train = X_train.drop(\"weight\", axis=1)\nX_valid = X_valid.drop(\"weight\", axis=1)\nX_test = X_test.drop(\"weight\", axis=1)\neval_set = [(X_train, y_train), (X_valid, y_valid)]","633a1e35":"%%time\n# # grid Search\u306f\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3001\u30b3\u30e1\u30f3\u30c8\u3067\u4f7f\u3063\u305f\u308a\u4f7f\u308f\u306a\u304b\u3063\u305f\u308a\u3092\u5207\u308a\u66ff\u3048\u308b\n# # grid search needs not a little time, switch it by comment-out\n# parameters = {\n#     'n_estimators': [100, 200, 300, 400],\n#     'learning_rate': [0.001, 0.005, 0.01, 0.05],\n#     'max_depth': [8, 10, 12, 15],\n#     'gamma': [0.001, 0.005, 0.01, 0.02],\n#     'random_state': [42],\n#     'num_class' : [5]\n# }\n\n# eval_set = [(X_train, y_train), (X_valid, y_valid)]\n# model = xgb.XGBClassifier(objective='multi:softprob')\n# clf = GridSearchCV(model, parameters)\n\n# clf.fit(X_train, y_train)\n\n# print(f'Best params: {clf.best_params_}')\n# # 'gamma': 0.005, 'learning_rate': 0.005, 'max_depth': 10, 'n_estimators': 300, 'num_class': 5, 'random_state': 42}\n# print(f'Best validation score = {clf.best_score_}')\n\n# model = xgb.XGBClassifier(**clf.best_params_, objective='multi:softprob')\n## {'gamma': 0.02, 'learning_rate': 0.05, 'max_depth': 8, 'n_estimators': 200, 'num_class': 5, 'random_state': 42}\nmodel = xgb.XGBClassifier(n_estimators=200, \n    learning_rate=0.05,\n    max_depth= 8,\n    gamma=0.02,\n    random_state= 42,\n    num_class =5,\n    objective='multi:softprob')\nmodel.fit(X_train, y_train, eval_set=eval_set, verbose=False, sample_weight = weights)","7999ebe0":"evals_result = model.evals_result()\ntrain_metric = evals_result['validation_0']['merror']\nplt.plot(train_metric, label='train')\neval_metric = evals_result['validation_1']['merror']\nplt.plot(eval_metric, label='eval')\nplt.grid()\nplt.legend()\nplt.xlabel('rounds')\nplt.ylabel('squarederror')\nplt.show()","57d4ac13":"plot_importance(model);","7358ab14":"y_pred = model.predict(X_test)\nprint(f'y_true = {np.array(y_test)[:5]}')\nprint(f'y_pred = {y_pred[:5]}')\nprint(f'mean_squared_error = {mean_squared_error(y_test, y_pred)}')","9cee25c3":"predicted_prices = df.loc[len(df)-test_day_count:].copy()\npredicted_prices['Change_label'] = y_pred\n\nfig = make_subplots(rows=2, cols=1)\nfig.add_trace(go.Scatter(x=df.Date, y=df.Change_label,\n                         name='Truth',\n                         marker_color='LightSkyBlue'), row=1, col=1)\n\nfig.add_trace(go.Scatter(x=predicted_prices.Date,\n                         y=predicted_prices.Change_label,\n                         name='Prediction',\n                         marker_color='MediumPurple'), row=1, col=1)\n\nfig.add_trace(go.Scatter(x=predicted_prices.Date,\n                         y=y_test,\n                         name='Truth',\n                         marker_color='LightSkyBlue',\n                         showlegend=False), row=2, col=1)\n\nfig.add_trace(go.Scatter(x=predicted_prices.Date,\n                         y=y_pred,\n                         name='Prediction',\n                         marker_color='MediumPurple',\n                         showlegend=False), row=2, col=1)\n\nfig.show()","0bf59468":"# \u771f\u306e\u5206\u5e03\u3068\u4e88\u6e2c\u7d50\u679c\u306e\u5206\u5e03\n# graph of test_data and predicted_data\nfig = plt.figure()\nax = fig.add_subplot(1,1,1)\n\nax.hist([y_pred, y_test], bins=10, color=['red', 'blue'], label=['y_pred', 'y_test'])\nax.set_title('first histogram $\\mu=100,\\ \\sigma=15$')\nax.set_xlabel('x')\nax.set_ylabel('freq')\nfig.show()","225bffd7":"acc = accuracy_score(y_test, y_pred)\nprint(acc)","a8dded4c":"confusion_matrix(y_test, y_pred)","3bbf0ed4":"sns.heatmap(confusion_matrix(y_test, y_pred))","d396d77a":"datas = df.copy()\ndrop_cols = ['Date', 'Open', 'Low', 'High', 'Close', 'Change_rate', 'Change_label', 'weight']\ndatas = datas.drop(drop_cols, 1)\nall_pred = model.predict(datas)\nsns.heatmap(confusion_matrix(df.Change_label, all_pred))","9924afb4":"acc_his = pd.DataFrame(columns = ['Acc', 'Date', 'Change_rate'])\nfor i in range(0, len(df), 30):\n    datas = df.loc[i:i+30].copy()\n    ans = datas['Change_label']\n    rate = df.loc[i:i+30, 'Change_rate'].mean()\n    drop_cols = ['Date', 'Open', 'Low', 'High', 'Close', 'Change_rate', 'Change_label', 'weight']\n    datas = datas.drop(drop_cols, 1)\n    pred = model.predict(datas)\n    acc_his.loc[df.loc[i].Date] = [accuracy_score(ans, pred), df.loc[i].Date, rate]","f6ad69f3":"print(acc_his.corr())\nfig = plt.figure()\nax1 = fig.add_subplot(111)\nt = acc_his.Date\nfs = 1.0\ny1 = acc_his.Acc\nln1=ax1.plot(t, y1,'C0',label='Acc')\n\nax2 = ax1.twinx()\ny2 = acc_his.Change_rate\nln2=ax2.plot(t,y2,'C1',label='Change_rate')\n\nh1, l1 = ax1.get_legend_handles_labels()\nh2, l2 = ax2.get_legend_handles_labels()\nax1.legend(h1+h2, l1+l2, loc='lower right')\n\nax1.set_xlabel('Date')\nax1.set_ylabel('Acc')\nax1.grid(True)\nax2.set_ylabel('Change_rate')","d6109ee9":"for_dump = df.copy()\ndef simulate_based_on_predict(df):\n    money_his = pd.DataFrame(columns = ['Date', 'money'])\n    df = df.copy().reset_index()\n    df = df.drop(['index'], 1)\n    drop_cols = ['Date', 'Open', 'Low', 'High', 'Close', 'Change_rate', 'Change_label', 'weight']\n    datas = df.copy().drop(drop_cols, 1)\n    pred = model.predict(datas)\n    money = 1\n    for i in range(0, len(df)):\n        data = df.loc[i].copy()\n        today_pred = pred[i]\n#         df\u306b\u5165\u3063\u3066\u3044\u308bChange_rate\u306f\u6b21\u306e\u65e5\u306e\u5909\u5316\u7387\u306a\u306e\u3067\u3001\u3053\u308c\u3092\u4f7f\u3063\u3066\u826f\u3044\n        Change_rate = data.Change_rate\n        if (today_pred == -2):\n            money = (1 + Change_rate * -1) * money\n        elif (today_pred == -1):\n            money = (1 + Change_rate * -0.5) * money\n        elif (today_pred == 1):\n            money = (1 + Change_rate * 0.5) * money\n        elif (today_pred == 2):\n            money = (1 + Change_rate * 1) * money\n        money_his.loc[data.Date] = [data.Date, money]\n        for_dump.loc[i, \"pred\"] = pred[i]\n    return money, money_his\nmoney, money_his = simulate_based_on_predict(df.copy())\nprint(money)\nrecent_money, recent_money_his = simulate_based_on_predict(df.loc[len(df) - test_day_count:].copy())\nprint(recent_money)\nfig = go.Figure(go.Scatter(x=money_his.Date, y=money_his.money, name='money_history'))\nfig.show()\nfig = go.Figure(go.Scatter(x=recent_money_his.Date, y=recent_money_his.money, name='money_history'))\nfig.show()","45cf4f2d":"df.to_csv(\"for_dump.csv\")\nmoney_his.to_csv(\"money_his.csv\")\nrecent_money_his.to_csv(\"recent_money_his.csv\")","7c7d5e17":"\u3053\u306enotebook\u3092\u767a\u5c55\u3055\u305b\u3066\u4e88\u6e2c\u3084\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u3093\u3092\u884c\u306a\u3063\u305f\u3082\u306e\u304c\u3053\u3061\u3089\u306b\u306a\u308a\u307e\u3059\u3002  \nhttps:\/\/www.kaggle.com\/takahiro1127\/stock-price-prediction-by-xgb-and-wavelet  \nnotebook create from this notebook is here  \nhttps:\/\/www.kaggle.com\/takahiro1127\/stock-price-prediction-by-xgb-and-wavelet","4308ea35":"## \u30ea\u30bf\u30fc\u30f3\u8a08\u6e2c\u306b\u3064\u3044\u3066\/return \n\nW_0 = 1\n\nW_{t+1} =  ( 1 + r_{t+1} * w_t ) W_t\n\n### \u8a18\u53f7\n\n* W_t : \u6642\u523bt\u3067\u306e\u4fdd\u6709\u8cc7\u7523\u984d\n* r_t : \u6642\u523b{t-1} \u304b\u3089 \u6642\u523bt\u307e\u3067\u306eTOPIX\u5909\u5316\u7387\n* w_t : \u81ea\u5206\u306e\u6295\u8cc7\u6bd4\u7387\n\n### \u4e88\u6e2c\u3068\u6295\u8cc7\u6bd4\u7387\u306e\u95a2\u4fc2\n5\u5024\u5206\u985e\u554f\u984c\u3068\u3057\u3066\u4e88\u6e2c\u3092\u884c\u3063\u305f\u5834\u5408\n\u4e88\u6e2c\u306f\u3001\u6642\u70b9t\u3067\u6642\u70b9t+1\u306e\u4e88\u6e2c\u3092\u884c\u3063\u305f\u5834\u5408\u3092\u60f3\u5b9a\n\n* +2 : \u5927\u5e45\u306aTOPIX\u4e0a\u6607  => w_t =  1.0 \n* +1 : \u5c0f\u5e45\u306aTOPIX\u4e0a\u6607  => w_t =  0.5\n*  0 : TOPIX\u5909\u5316\u306a\u3057  \u3000=> w_t =  0.0\n* -1 : \u5c0f\u5e45\u306aTOPIX\u4e0b\u843d  => w_t = -0.5\n* -2 : \u5927\u5e45\u306aTOPIX\u4e0b\u843d  => w_t = -1.0","59f8d5de":"\ud83d\udc4d**\u3053\u306enotebook\u304c\u5f79\u306b\u7acb\u3063\u305f\u65b9\u306f\u662f\u975e\u3044\u3044\u306d\u3092\u304a\u9858\u3044\u3057\u307e\u3059**\ud83d\udc4d  \n\ud83d\udc4d**please upvote**\ud83d\udc4d","a693e655":"# stock price prediction\n![](https:\/\/miro.medium.com\/max\/2560\/0*R5pC0bAlYxH_nTlF.jpg)"}}