{"cell_type":{"7ba0e399":"code","4ff3fbb5":"code","13ff3fce":"code","90c0d9ea":"code","51f65752":"code","53a61cd2":"code","09d08f0f":"code","a7a66949":"code","33a776a9":"code","f164b240":"code","862fb04d":"code","ecd72d20":"code","fa3d46f7":"code","bc5f8be9":"code","7073b2f3":"code","11636961":"code","0e893283":"code","1ef81f18":"code","39deaa26":"code","f450aade":"code","8ef95712":"code","5dd41475":"code","812cd492":"code","dde62828":"code","66285055":"code","66ad5942":"code","1cac6888":"code","bdb1335f":"code","6fe9d065":"code","5197091e":"code","eda31f44":"code","3792d78c":"code","b59d7680":"code","0784ab06":"code","dc91a32c":"code","ba01e341":"code","0a70a2f2":"code","2a82190a":"code","9c528ae6":"code","08ea5872":"markdown","1341e45b":"markdown","f11abf32":"markdown","e73bc637":"markdown","eb4dca85":"markdown","1c456df4":"markdown","77bb0863":"markdown","219f880b":"markdown","75e1147a":"markdown","42034683":"markdown","b9e5f898":"markdown","da61b1ef":"markdown","d413bf5c":"markdown","941b06b9":"markdown","afef0f3c":"markdown","ec8258d4":"markdown"},"source":{"7ba0e399":"import pandas as pd\nimport numpy as np  \nimport matplotlib.pyplot as plt  \nimport seaborn as sns \nfrom sklearn.model_selection import train_test_split \nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import cross_val_score, GridSearchCV\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import r2_score\nimport warnings\nwarnings.filterwarnings('ignore')\n%matplotlib inline","4ff3fbb5":"train_dataset = pd.read_csv('..\/input\/codenation-enem2\/train.csv', index_col=0)\ntrain_dataset.head()","13ff3fce":"train_dataset['NU_NOTA_MT'].head()","90c0d9ea":"train_dataset.shape","51f65752":"train_dataset.info()","53a61cd2":"train_dataset.describe()","09d08f0f":"test_dataset = pd.read_csv('..\/input\/codenation-enem2\/test.csv')\ntest_dataset.head()","a7a66949":"test_dataset.shape","33a776a9":"test_dataset.info()","f164b240":"test_dataset.describe()","862fb04d":"# Generating the answer dataframe with 'NU_INSCRICAO' variable\nanswer = pd.DataFrame()\nanswer['NU_INSCRICAO'] = test_dataset['NU_INSCRICAO']\nanswer.head()","ecd72d20":"answer.shape","fa3d46f7":"var = ['NU_IDADE','IN_TREINEIRO','NU_NOTA_CN','NU_NOTA_CH','NU_NOTA_LC','NU_NOTA_REDACAO']\ntrain_dataset[var].corr()","bc5f8be9":"features = ['NU_NOTA_CN','NU_NOTA_CH','NU_NOTA_LC','NU_NOTA_REDACAO']","7073b2f3":"train_dataset[features].corr()","11636961":"plt.figure(figsize=(9,6))\nplt.title('Train Features')\nsns.heatmap(train_dataset[features].corr(), annot=True, cmap='Reds')\nplt.xticks(rotation=70)\nplt.show()","0e893283":"test_dataset[features].corr()","1ef81f18":"plt.figure(figsize=(9,6))\nplt.title('Test Features')\nsns.heatmap(test_dataset[features].corr(), annot=True, cmap='Reds')\nplt.xticks(rotation=70)\nplt.show()","39deaa26":"train_dataset[features].isnull().sum()","f450aade":"train_dataset['NU_NOTA_MT'].isnull().sum()","8ef95712":"test_dataset[features].isnull().sum()","5dd41475":"train_dataset['NU_NOTA_CN'].fillna(0, inplace=True)\ntrain_dataset['NU_NOTA_CH'].fillna(0, inplace=True)\ntrain_dataset['NU_NOTA_REDACAO'].fillna(0, inplace=True)\ntrain_dataset['NU_NOTA_LC'].fillna(0, inplace=True)\ntrain_dataset['NU_NOTA_MT'].fillna(0, inplace=True)\ntest_dataset['NU_NOTA_CN'].fillna(0, inplace=True)\ntest_dataset['NU_NOTA_CH'].fillna(0, inplace=True)\ntest_dataset['NU_NOTA_REDACAO'].fillna(0, inplace=True)\ntest_dataset['NU_NOTA_LC'].fillna(0, inplace=True)","812cd492":"train_dataset[features].isnull().sum()","dde62828":"train_dataset['NU_NOTA_MT'].isnull().sum()","66285055":"test_dataset[features].isnull().sum()","66ad5942":"X = train_dataset[features]\nX.head()","1cac6888":"y = train_dataset['NU_NOTA_MT']\ny.head()","bdb1335f":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1, random_state=0)","6fe9d065":"sc = StandardScaler()\nsc.fit(X_train)\nX_train = sc.transform(X_train)\nX_test = sc.transform(X_test)","5197091e":"lr = LinearRegression()\nlr.fit(X_train, y_train)","eda31f44":"# Getting predictions\ny_pred = lr.predict(X_test)","3792d78c":"# Getting r2 score\nr2_score(y_test, y_pred)","b59d7680":"# Perform Grid-Search\ngsc = GridSearchCV(\n    estimator=RandomForestRegressor(),\n    param_grid={'max_depth': range(3,7), \n                'n_estimators': (50, 100, 500, 1000),\n    },\n    cv=10, scoring='r2', verbose=0, n_jobs=-1)\n\ngrid_result = gsc.fit(X, y)\nbest_params = grid_result.best_params_\nrfr = RandomForestRegressor(max_depth=best_params[\"max_depth\"], n_estimators=best_params[\"n_estimators\"], random_state=False, verbose=False)\n\n# Perform K-Fold CV\nscores = cross_val_score(rfr, X, y, cv=10, scoring='r2')\nscores","0784ab06":"scores.mean() * 100","dc91a32c":"rfr.fit(train_dataset[features], train_dataset['NU_NOTA_MT'])","ba01e341":"y_pred = rfr.predict(test_dataset[features])\ny_pred","0a70a2f2":"answer['NU_NOTA_MT'] = y_pred\nanswer.head()","2a82190a":"answer.describe()","9c528ae6":"answer.to_csv('answer.csv', index=False, float_format='%.1f')","08ea5872":"- Checking for null values","1341e45b":"- Confirming if null values wer filled","f11abf32":"\nb) **Second hypothesis**: `NU_IDADE` and `IN_TREINEIRO` could be dropped, avoiding interferences in model predictions.\n","e73bc637":"- Filling null values with zeros","eb4dca85":"### Loading Dataset","1c456df4":"### Splitting dataset","77bb0863":"a) **First hypothesis**: `NU_IDADE` and `IN_TREINEIRO` are weakly correlated with other features.","219f880b":"### Importing libraries","75e1147a":"#### - Testing hypotseis to select features (based on D-Tale report)","42034683":"### Predicting Math Grad for Brazilian Enem \n\nIn Brazil, there is a high school national grading exam called ENEM (Exame Nacional do Ensino M\u00e9dio) which takes place yearly and sets grades for admission on most universities and colleges. The goal is to predict exam grades by using regression models.\n\nHere, two models were implemented: **Linear Regression** and **Random Forest**, and their performance was measured through r\u00b2 metric.\n\nLet's check it!","b9e5f898":" - **Random Forest with Cross-Validation**","da61b1ef":"- **Linear Regression**","d413bf5c":"### Modeling","941b06b9":"### Features scale normalization","afef0f3c":"### Data Analysis","ec8258d4":"### Data Preprocessing\n\nSince there are null data in the dataset, there are two approaches that can be taken:\n\n   > 1) Drop null values from the dataset. It could drastically decrease the samples to train the model;\n\n   > 2) Fill null values with zeros. It keeps the number of samples in the dataset.\n\n   > 3) Fill null values with the average value of the features. It keeps the number of samples in the dataset.\n\nHere, the null values will be filled with zeros (second approach). "}}