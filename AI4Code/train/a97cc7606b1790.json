{"cell_type":{"7d584961":"code","b020edd9":"code","5501550d":"code","65e122b4":"code","76ab85e2":"code","e6967bd4":"code","6cb4d025":"code","d4531860":"code","2492b858":"code","45ab3977":"code","c73e20c3":"code","74e6ef83":"code","7353cbf2":"code","5f587b90":"code","fc2daae3":"code","2b76d8d7":"code","e20f3b81":"code","f4d73dbe":"code","f836efcc":"code","771e22f2":"code","4ad2bfe3":"code","cc796371":"code","3a4e33e2":"code","7cb99848":"code","92411142":"code","937883fc":"code","e4be7806":"code","123f2fa7":"code","581d1ed5":"code","f7877499":"markdown","f871f1e2":"markdown","01fb4d24":"markdown","99d572c8":"markdown","6068c60a":"markdown"},"source":{"7d584961":"#import libraries\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport pandas_profiling\nimport seaborn as sns","b020edd9":"#importing the TMBD Training Dataset\nBox_Office_data = pd.read_csv('..\/input\/tmdb-box-office-prediction\/train.csv')","5501550d":"#Showing training Data\nBox_Office_data.head()","65e122b4":"#importing test dataset \nBox_Office_data_test = pd.read_csv('..\/input\/tmdb-box-office-prediction\/test.csv')","76ab85e2":"#Showing Test Data\nBox_Office_data_test.head()","e6967bd4":"Box_Office_data.info()","6cb4d025":"Box_Office_data.describe()","d4531860":"pandas_profiling.ProfileReport(Box_Office_data)","2492b858":"#distribution of Budget, popularity, runtime and revenue\nsns.set(rc={\"figure.figsize\": (12, 14)})\nplt.subplot(2,2,1)\nax=sns.kdeplot(Box_Office_data['budget'].values, shade = True)\nplt.title('Budget')\nplt.subplot(2,2,2)\nax=sns.kdeplot(Box_Office_data['popularity'].values, shade=True)\nplt.title('Popularity')\nplt.subplot(2,2,3)\nax=sns.kdeplot(Box_Office_data['runtime'].values, shade = True)\nplt.title('Runtime')\nplt.subplot(2,2,4)\nax=sns.kdeplot(Box_Office_data['revenue'].values, shade = True)\nplt.title('Revenue')\nplt.show()","45ab3977":"#linear relationship between Budget and Revenue\nf, ax = plt.subplots(figsize=(10, 12))\nsns.regplot(x=\"budget\", y=\"revenue\", data=Box_Office_data, ax=ax, color = 'red');","c73e20c3":"# Linear Relationship between Runtime and Revenue\nf, ax = plt.subplots(figsize=(10, 12))\nsns.regplot(x=\"runtime\", y=\"revenue\", data=Box_Office_data, ax = ax, color = 'green');","74e6ef83":"#Linear relationship between Revenue and Popularity\nf, ax = plt.subplots(figsize=(10, 12))\nsns.regplot(x=\"popularity\", y=\"revenue\", data=Box_Office_data, ax = ax, color = 'blue');","7353cbf2":"# joint plot distribution + Linear Relationship\nsns.jointplot(x=\"budget\", y=\"revenue\", data=Box_Office_data, kind=\"reg\",color = 'red');\nsns.jointplot(x=\"runtime\", y=\"revenue\", data=Box_Office_data, kind=\"reg\",color = 'green');\nsns.jointplot(x=\"popularity\", y=\"revenue\", data=Box_Office_data, kind=\"reg\",color = 'blue');","5f587b90":"#Revenue based on the Original Language of the movie\nsns.catplot(x=\"original_language\", y=\"revenue\",kind=\"bar\",height = 9, aspect = 2.0, data=Box_Office_data)","fc2daae3":"sns.relplot(x=\"runtime\", y=\"revenue\", kind=\"line\",height = 9, aspect = 2.0, data=Box_Office_data);","2b76d8d7":"# corelation between fields\nsns.pairplot(Box_Office_data, height=2.5)","e20f3b81":"\nX = Box_Office_data.iloc[:, np.r_[2:3,9:10,14]].values\ny = Box_Office_data.iloc[:, -1].values","f4d73dbe":"X_test = Box_Office_data_test.iloc[:, np.r_[2:3,9:10,14]].values","f836efcc":"# Taking Care of Missing data\nfrom sklearn.impute import SimpleImputer\nimputer = SimpleImputer(missing_values = np.nan, strategy = 'mean')\nimputer.fit(X[:,np.r_[2:3]])\nX[:,np.r_[2:3]] = imputer.transform(X[:,np.r_[2:3]])","771e22f2":"#Taking care of missing data in Test Data set\nimputer1 = SimpleImputer(missing_values = np.nan, strategy = 'mean')\nimputer1.fit(X_test[:, np.r_[2:3]])\nX_test[:, np.r_[2:3]] = imputer1.transform(X_test[:, np.r_[2:3]])","4ad2bfe3":"X[:, np.r_[2:3]].shape","cc796371":"# Performing Feature Scaling\nfrom sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX[:, 0:] = sc.fit_transform(X[:, 0:])\nX_test[:, 0:]=sc.transform(X_test[:, 0:])","3a4e33e2":"#Training the Random Forest Model on Training Data set\n#from sklearn.ensemble import RandomForestRegressor\n#regressor = RandomForestRegressor(n_estimators = 125, random_state = 100)\n#rf_model = regressor.fit(X,y)","7cb99848":"#Predicting Revenue for Test data set\n#y_pred = rf_model.predict(X_test)","92411142":"from sklearn.neural_network import MLPRegressor\nmlp = MLPRegressor(hidden_layer_sizes=(100,100,100,100,100,100),max_iter=500, random_state= 1)\nnn_model = mlp.fit(X,y)","937883fc":"y_pred = nn_model.predict(X_test)","e4be7806":"#Applying K-fold \n#from sklearn.model_selection import cross_val_score\n#accuracies = cross_val_score(estimator = nn_model, X = X, y = y, cv = 10)\n#print(\"Accuracy: {:.2f} %\".format(accuracies.mean()*100))\n#print(\"Standard Deviation: {:.2f} %\".format(accuracies.std()*100))","123f2fa7":"#Submitting the Output\nRevenue_prediction = pd.DataFrame({'id': Box_Office_data_test.id, 'revenue': y_pred})","581d1ed5":"Revenue_prediction.to_csv('kapilv_Box_Office_revenue_submission.csv', index=False)","f7877499":"# TMBD Box Office Revenue Prediction","f871f1e2":"![Best-M-Night-Shyamalan-Movies-and-Directing-Style-StudioBinder.jpg](attachment:Best-M-Night-Shyamalan-Movies-and-Directing-Style-StudioBinder.jpg)","01fb4d24":"# Exploring Data","99d572c8":"# Building A Neural Network","6068c60a":"# Feature Engineering & Model Training to Predict Revenue for Test Data"}}