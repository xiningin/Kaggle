{"cell_type":{"fa72fa52":"code","9e76a08f":"code","d4b03af1":"code","5038fedc":"code","8c18f8f5":"code","b7a992af":"code","d4ebcd04":"markdown","805362df":"markdown"},"source":{"fa72fa52":"!pip install pytorch-tabnet","9e76a08f":"import numpy as np\nimport pandas as pd\nfrom pytorch_tabnet.tab_model import TabNetClassifier\nfrom pytorch_tabnet.metrics import Metric\nfrom sklearn.model_selection import KFold, train_test_split\nfrom sklearn.metrics import roc_auc_score\nimport zipfile\nimport io","d4b03af1":"tabnet_zip = io.BytesIO()\nwith zipfile.ZipFile(tabnet_zip, 'w') as z:\n    z.write('..\/input\/tabnet\/model_params.json', arcname='model_params.json')\n    z.write('..\/input\/tabnet\/network.pt', arcname='network.pt')","5038fedc":"clf = TabNetClassifier()\nclf.load_model(tabnet_zip)","8c18f8f5":"test = pd.read_csv('..\/input\/tabular-playground-series-oct-2021\/test.csv')\nsample_submission = pd.read_csv('..\/input\/tabular-playground-series-oct-2021\/sample_submission.csv')","b7a992af":"test_arr = test.drop('id', axis=1).values\ntest_pred = clf.predict_proba(test_arr)\n\nsample_submission['target'] = test_pred[:,1]\nsample_submission.to_csv('tabnet_prediction.csv', index=False)","d4ebcd04":"**io.BytesIO()\u3067byte object\u3092\u4f5c\u6210\u3057\u3066\u3001\u7121\u7406\u3084\u308azip\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308b**","805362df":"# pytorch-tabnet pretrained model load\npytorch-tabnet\u306e`clf.save_model()`\u306fzip\u30d5\u30a1\u30a4\u30eb\u3067\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\u3057\u304b\u3057\u3001Kaggle\u3067\u306fzip\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u3068\u3001\u89e3\u51cd\u3057\u3066\u914d\u7f6e\u3055\u308c\u3066\u3057\u307e\u3044\u3001`clf.load_model()`\u304c\u51fa\u6765\u306a\u3044\u3067\u3059\u3002\u305d\u3053\u3067\u3001notebook\u5185\u3067byte object\u3092\u4f5c\u6210\u3001\u305d\u3053\u306bzip\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\u3059\u308b\u3053\u3067\u3001\u8aad\u307f\u8fbc\u307f\u3092\u53ef\u80fd\u306b\u3057\u3066\u307e\u3059\u3002\n\nIn pytorch-tabnet, `clf.save_model ()` is output as a zip file. However, in Kaggle, if you upload a zip file, it will be decompressed and placed.Therefore, `clf.load_model ()` cannot be done. So I create a byte object in the notebook and save the file as a zip file there."}}