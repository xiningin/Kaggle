{"cell_type":{"b3296bea":"code","a7f8d261":"code","2b7552cf":"code","c035adec":"code","c78bd224":"code","94223d9e":"code","e7c65307":"code","51d60d5c":"code","c96971f0":"code","bf9cfa06":"code","9a45af8e":"code","9cc9592f":"code","a64df9e2":"code","492d1a0e":"code","b9ed381a":"code","e2628ed2":"code","21a1d573":"code","aa3dbe55":"code","47dca9ca":"code","60fe84dd":"code","3cf9814d":"code","61af191e":"code","f38719e8":"markdown"},"source":{"b3296bea":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","a7f8d261":"df = pd.read_csv('..\/input\/train.csv')\ndf.describe(include='all')","2b7552cf":"df.drop(columns=['PassengerId', 'Name', 'Cabin', 'Ticket'], inplace=True)","c035adec":"df.head(5)","c78bd224":"df_dummy = pd.get_dummies(df)\ndf_dummy.head(4)","94223d9e":"df_dummy.describe(include='all')","e7c65307":"df_dummy['Age'].fillna(df_dummy['Age'].median(), inplace=True)\ndf_dummy.describe(include='all')","51d60d5c":"df_dummy.head(3)","c96971f0":"from sklearn.model_selection import train_test_split\nX = df_dummy.drop(columns=['Survived'])\ny = df_dummy['Survived']\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.8, random_state=0)","bf9cfa06":"from sklearn.ensemble import RandomForestClassifier as randomforest\nrfr = randomforest(random_state=0, n_estimators=100)\n\nrfr.fit(X_train, y_train)","9a45af8e":"rfr.score(X_test, y_test)","9cc9592f":"rfr.fit(X, y)","a64df9e2":"testdata = pd.read_csv('..\/input\/test.csv', index_col=0)\ntestdata.drop(columns=['Name', 'Cabin', 'Ticket'], inplace=True)\ntestdata_dummy = pd.get_dummies(testdata)\ntestdata_dummy.describe(include='all')","492d1a0e":"testdata_dummy['Age'].fillna(testdata_dummy['Age'].median(), inplace=True)\ntestdata_dummy['Fare'].fillna(testdata_dummy['Fare'].median(), inplace=True)","b9ed381a":"testdata_dummy.describe(include='all')","e2628ed2":"gender_submission = pd.read_csv('..\/input\/gender_submission.csv', index_col=0)\ntest = pd.concat([testdata_dummy, gender_submission], axis=1)\ntest.head(5)","21a1d573":"test.describe(include='all')","aa3dbe55":"X_test = test.drop(columns=['Survived'])\ny_test = test['Survived']","47dca9ca":"rfr.score(X_test, y_test)","60fe84dd":"y_pred = rfr.predict(X_test)\nresults = pd.DataFrame(X_test)\nresults['Survived'] = y_pred\nresults","3cf9814d":"from sklearn.metrics import accuracy_score\naccuracy_score(y_test, y_pred)","61af191e":"results.to_csv('Predict.csv', columns=['Survived'])","f38719e8":"# training to all data in train.csv"}}