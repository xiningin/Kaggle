{"cell_type":{"42245ae6":"code","f1a16197":"code","340652a4":"code","3174d7f2":"code","f059e4b1":"code","8a72d235":"code","ea2eee57":"code","6125ba6d":"code","c7295d86":"code","a94f1360":"code","3b37385d":"code","bc37d53c":"code","d8f95a9b":"code","b41f7754":"code","14d524d7":"code","e4fdfd31":"code","0d324171":"code","1912dd39":"code","fe0b644d":"code","484533fb":"code","74b6ca28":"code","2c7ef1b7":"markdown","48711c11":"markdown","aacc74a9":"markdown","d5379eb8":"markdown","935d2f4e":"markdown","793cdfa0":"markdown","4277a4f3":"markdown","dfde53a6":"markdown","76d71885":"markdown","49616869":"markdown","7ccb2e7e":"markdown","6c0025cd":"markdown","20980974":"markdown","fd5e8613":"markdown","acf915b1":"markdown","691beac8":"markdown","41b5005f":"markdown","339031b3":"markdown","43b9bb4a":"markdown","c6bd6fdc":"markdown","6b4eb29b":"markdown","fcea9ac4":"markdown","8d4e9f64":"markdown"},"source":{"42245ae6":"# Work with Data - the main Python libraries\nimport numpy as np\nimport pandas as pd\n\n# For import data from API\nimport requests\n\n# Visualization\nimport matplotlib.pyplot as plt\n\n# Modeling and Prediction\nfrom fbprophet import Prophet\nfrom fbprophet.make_holidays import make_holidays_df\nfrom fbprophet.diagnostics import cross_validation, performance_metrics\nfrom fbprophet.plot import plot_cross_validation_metric\nimport holidays\n\nimport warnings\nwarnings.simplefilter('ignore')","f1a16197":"# Download data vai API from the Portal of RNBO of Ukraine \nfor filename in ['main-data?mode=ukraine&fbclid=IwAR1vNXEE0nkmorUmGP4StG4cLrj1Z9VoX3c3Bi8dfltr0elgOj4b0M3ONvk']:\n    print(f'Download daily data from the Portal of RNBO of Ukraine')\n    url = f'https:\/\/api-covid19.rnbo.gov.ua\/charts\/{filename}'\n    myfile = requests.get(url)\n    open(filename, 'wb').write(myfile.content)\n    \ndf_data = pd.read_json('main-data?mode=ukraine&fbclid=IwAR1vNXEE0nkmorUmGP4StG4cLrj1Z9VoX3c3Bi8dfltr0elgOj4b0M3ONvk')\ndf_data","340652a4":"# Display the last 10 rows of the dataframe \"df_data\"\ndf_data.tail(10)","3174d7f2":"# Calculation daily data for number of confirmed cases\ndf_data['n_confirmed'] = df_data['confirmed'].diff()","f059e4b1":"# Filtering the missing data\ndata = df_data[['dates','n_confirmed']].dropna().reset_index(drop=True)\ndata['n_confirmed'] = data['n_confirmed'].astype('int')\ndata.tail(5)","8a72d235":"# Build the plot\ndata['n_confirmed'].plot()","ea2eee57":"# Prepairing data for modeling with Prophet\ndata.columns = ['ds', 'y']\ndata.tail()","6125ba6d":"# Removing zero values\ndata = data[data['y'] > 0].reset_index(drop=True)\ndata","c7295d86":"# Build the plot for July\ndf = data[(data['ds'] >= '2020-07-01') & (data['ds'] < '2020-08-01')]\ndf['y'].plot()","a94f1360":"# The smallest value\ndf.loc[113,:]","3b37385d":"# Selection data with the biggest wave\ndf2 = data[113:].reset_index(drop=True)\ndf2.head()","bc37d53c":"# Build Prophet model\nmodel = Prophet()\n\n# Training model for all data\nmodel.fit(data)","d8f95a9b":"# Build Prophet model with parameters ans structure \n# from the notebook https:\/\/www.kaggle.com\/vbmokin\/covid-19-in-ukraine-eda-forecasting \n# but without holidays\nmodel2 = Prophet(daily_seasonality=False, weekly_seasonality=False, yearly_seasonality=False, \n                changepoint_range=1, changepoint_prior_scale = 0.3)\nmodel2.add_seasonality(name='weekly', period=7, fourier_order=12, \n                      mode = 'multiplicative', prior_scale = 0.24)\nmodel2.add_seasonality(name='triply', period=3, fourier_order=2, \n                      mode = 'multiplicative', prior_scale = 0.15)\n\n# Training model for df2\nmodel2.fit(df2)","b41f7754":"# Make a forecast for 7 days ahead\nfuture = model.make_future_dataframe(periods = 7)\nforecast = model.predict(future)","14d524d7":"# Draw plot of the values with forecasting data\nfigure = model.plot(forecast, xlabel = 'Date', ylabel = 'Number of confirmed cases')","e4fdfd31":"# Draw plot with the components (trend and weekly seasonality) of the forecasts\nfigure_component = model.plot_components(forecast)","0d324171":"# Ouput the prediction for the next 7 days\nforecast[['yhat_lower', 'yhat', 'yhat_upper']] = forecast[['yhat_lower', 'yhat', 'yhat_upper']].astype('int')\nforecast[['ds', 'yhat_lower', 'yhat', 'yhat_upper']].tail(7)","1912dd39":"# Make a forecast for 7 days ahead\nfuture2 = model2.make_future_dataframe(periods = 7)\nforecast2 = model2.predict(future2)","fe0b644d":"# Draw plot of the values with forecasting data\nfigure2 = model2.plot(forecast2, xlabel = 'Date', ylabel = 'Number of confirmed cases')","484533fb":"# Draw plot with the components (trend and weekly seasonality) of the forecasts\nfigure_component2 = model2.plot_components(forecast2)","74b6ca28":"# Ouput the prediction for the next 7 days\nforecast2[['yhat_lower', 'yhat', 'yhat_upper']] = forecast2[['yhat_lower', 'yhat', 'yhat_upper']].astype('int')\nforecast2[['ds', 'yhat_lower', 'yhat', 'yhat_upper']].tail(7)","2c7ef1b7":"### For the biggest wave - df2","48711c11":"**ADDITIONAL TASK:** Try changing the parameters of the Prophet model and evaluate how this will affect the shape of the curve and the accuracy of the simulation","aacc74a9":"### For the biggest wave - df2","d5379eb8":"**TASK:** Make similar calculations for the dataframe df2 using model2:\n1. Make a forecast for it for 7 days ahead.\n2. Draw a plot of the values with forecasting data.\n3. Draw plot with the components (trend and weekly seasonality) of the forecasts.\n4. Ouput the prediction for the next 7 days.","935d2f4e":"<a class=\"anchor\" id=\"0\"><\/a>\n# [AI-ML-DS : Training for beginners](https:\/\/www.kaggle.com\/vbmokin\/ai-ml-ds-training-for-beginners-in-kaggle). Level 1 (very simple). 2020\n## Kaggle GM, Prof. [@vbmokin](https:\/\/www.kaggle.com\/vbmokin)\n### [Vinnytsia National Technical University](https:\/\/vntu.edu.ua\/), Ukraine\n#### [Chair of the System Analysis and Information Technologies](http:\/\/mmss.vntu.edu.ua\/index.php\/ua\/)","793cdfa0":"**TASK:** Display the last 10 rows of the dataframe \"df_data\".","4277a4f3":"## 1. Import libraries<a class=\"anchor\" id=\"1\"><\/a>\n\n[Back to Table of Contents](#0.1)","dfde53a6":"I hope you find this notebook useful and enjoyable.\n\nYour comments and feedback are most welcome.\n\n[Go to Top](#0)","76d71885":"# The concept of training:\n* the **last version (commit)** of the notebook has:\n        * the basic tasks (after \"TASK:\")\n        * the additional tasks for self-execution (after \"ADDITIONAL TASK:\")\n* the **previuos version (commit)** of the notebook has **answers** for the basic tasks","49616869":"### Selection data with the biggest wave","7ccb2e7e":"## Acknowledgements\n\n### Datasets:\n- official data of Ukraine (https:\/\/covid19.rnbo.gov.ua\/) - via API\n- my dataset [COVID-19 in Ukraine: daily data](https:\/\/www.kaggle.com\/vbmokin\/covid19-in-ukraine-daily-data) - for the next commits\n- my dataset with holidays data [COVID-19: Holidays of countries](https:\/\/www.kaggle.com\/vbmokin\/covid19-holidays-of-countries) - for the next commits\n\n### Notebooks:\n* [Data Science for tabular data: Advanced Techniques](https:\/\/www.kaggle.com\/vbmokin\/data-science-for-tabular-data-advanced-techniques)\n* [EDA for tabular data: Advanced Techniques](https:\/\/www.kaggle.com\/vbmokin\/eda-for-tabular-data-advanced-techniques)\n* [COVID-19 in Ukraine: EDA & Forecasting](https:\/\/www.kaggle.com\/vbmokin\/covid-19-in-ukraine-eda-forecasting)\n* [COVID-19 in 67 countries: daily Prophet forecast](https:\/\/www.kaggle.com\/vbmokin\/covid-19-in-67-countries-daily-prophet-forecast)\n\n### Libraries from GitHub:\n- https:\/\/facebook.github.io\/prophet\/\n- https:\/\/facebook.github.io\/prophet\/docs\/\n- https:\/\/github.com\/facebook\/prophet\n- https:\/\/github.com\/dr-prodigy\/python-holidays","6c0025cd":"#### Thanks to https:\/\/api-covid19.rnbo.gov.ua\/","20980974":"### For all data","fd5e8613":"## Dataset [COVID-19 in Ukraine: daily data](https:\/\/www.kaggle.com\/vbmokin\/covid19-in-ukraine-daily-data)","acf915b1":"## 5. Prediction & Visualization<a class=\"anchor\" id=\"5\"><\/a>\n\n[Back to Table of Contents](#0.1)","691beac8":"**ADDITIONAL TASK:** Try to specify another number (instead of 113) as a reference point (until the second wave in summer) or other.\nLook all data with plot here: https:\/\/covid19.rnbo.gov.ua\/","41b5005f":"**ADDITIONAL TASK:** Try to make a prediction for another value - not the number of new confirmed cases, but the number of deaths or other in the dataframe df_data.","339031b3":"## 2. Download data<a class=\"anchor\" id=\"2\"><\/a>\n\n[Back to Table of Contents](#0.1)","43b9bb4a":"<a class=\"anchor\" id=\"0.1\"><\/a>\n## Table of Contents\n\n1. [Import libraries](#1)\n1. [Download data](#2)\n1. [EDA & FE](#3)\n1. [Modeling](#4)\n1. [Prediction & Visualization](#5)","c6bd6fdc":"## 4. Modeling<a class=\"anchor\" id=\"4\"><\/a>\n\n[Back to Table of Contents](#0.1)","6b4eb29b":"### For all data","fcea9ac4":"## 3. EDA & FE<a class=\"anchor\" id=\"3\"><\/a>\n\n[Back to Table of Contents](#0.1)","8d4e9f64":"### It is recommended to start studying this course from another notebook \"[AI-ML-DS Training. L1T: Titanic - Decision Tree](https:\/\/www.kaggle.com\/vbmokin\/ai-ml-ds-training-l1t-titanic-decision-tree)\" - and then move on to this notebook."}}