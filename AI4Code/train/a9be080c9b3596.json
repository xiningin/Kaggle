{"cell_type":{"e0aa796c":"code","16b08273":"code","edeadeda":"code","fceb741b":"code","4758a4dc":"code","b50465d9":"code","85c575a7":"code","0485a2e9":"code","6a111430":"markdown","5d71bfa9":"markdown","c30e5f5f":"markdown"},"source":{"e0aa796c":"import pandas as pd\nimport numpy as np\n\ndata = pd.read_csv('..\/input\/piratesvsglobalwarmingcorrelationcausation\/pirates-vs-global-warming.csv')\n\ndata","16b08273":"data.corr()","edeadeda":"data.plot.scatter(x='global-average-temperature', y='number-of-pirates', marker='x');","fceb741b":"params = np.polyfit(data['global-average-temperature'], data['number-of-pirates'], 1)\nparams","4758a4dc":"x = data['global-average-temperature']\ndata['predicted-pirates'] = x * params[0] + params[1] \nax = data.plot.scatter(x='global-average-temperature', y='number-of-pirates')\ndata.plot(x='global-average-temperature', y='predicted-pirates', ax=ax, color='r');\nrmse = ((data['predicted-pirates'] - data['number-of-pirates']) ** 2).mean() ** 0.5\nprint(f\"rmse: {rmse}\")","b50465d9":"params = np.polyfit(data['global-average-temperature'], data['number-of-pirates'], 2)\nparams","85c575a7":"data['predicted-pirates'] = data['global-average-temperature']**2 * params[0] + data['global-average-temperature'] * params[1] + params[2]\nax = data.plot.scatter(x='global-average-temperature', y='number-of-pirates')\ndata.plot(x='global-average-temperature', y='predicted-pirates', ax=ax, color='r');\nrmse = ((data['predicted-pirates'] - data['number-of-pirates']) ** 2).mean() ** 0.5\nprint(f\"rmse: {rmse}\")","0485a2e9":"import matplotlib.pyplot as plt\nx1 = np.linspace(13, 17, 100)\ny1 = x1**2 * params[0] + x1*params[1] + params[2]\nplt.plot(x1, y1)\nplt.plot(data['global-average-temperature'], data['number-of-pirates'], 'x');","6a111430":"RMSE for quadratic is much lower, and also visually it seems like a better model.\n\nThe model looks like a set of lines at this point, rather than a continuous curve. \nTo fix this, you need to start using the Matplotlib library directly (Pandas is using this under the hood), or you need to create a new dataset\nhttps:\/\/www.w3schools.com\/python\/matplotlib_line.asp","5d71bfa9":"## Linear model\nFitting a line to predict the number of pirates","c30e5f5f":"## Quadratic model\nThis might be a better fit, as the line seems a bit too simplistic (underfitted)"}}