{"cell_type":{"6b3af4da":"code","61603b47":"code","dabd566c":"code","ce2e3591":"code","7b053166":"code","4b75deeb":"code","6c16b25d":"code","0a6fedc9":"code","b973b4cf":"code","43cdb7fb":"code","4ca6959e":"code","465e6b51":"code","ec7f0f3a":"code","b8c53f7f":"code","6ff2bc44":"code","9e6be170":"code","1d01db09":"code","0791dda5":"code","9dd9db39":"code","89d7f201":"code","5c0693ff":"code","7c0d4129":"code","78ba8ab7":"code","63070026":"code","23177266":"code","a581d880":"code","e7d5aa80":"code","f2cbe4b0":"code","499a41e6":"code","bfa7d957":"code","cbc79be4":"code","ef6b93ad":"code","7943c9e4":"code","99a01646":"code","9860c339":"code","e3166410":"code","19d01a3c":"code","43e4d998":"code","895decdb":"code","ea4d709a":"code","59b85b41":"code","6a42b752":"code","e35b5934":"code","cb3b54d8":"code","f7c281ae":"code","89e9a360":"code","90bb9e35":"code","0fe2f495":"code","f86ce148":"markdown","116c2532":"markdown","9dc0470e":"markdown","712c11d3":"markdown","c2349e27":"markdown","09b892c3":"markdown","b70d27a0":"markdown","f52b0920":"markdown","1a9ae08b":"markdown","b795d013":"markdown","89dee2cc":"markdown","e38d8506":"markdown","50e67283":"markdown","8da91b6b":"markdown","51f08e31":"markdown","d6f6534c":"markdown","8eb42cef":"markdown","acd4fd6e":"markdown","02583f98":"markdown","e86cb0d4":"markdown","e7394e41":"markdown","c3e9bd90":"markdown","b1a12f17":"markdown","9bc72259":"markdown","b40957a1":"markdown","79cda64a":"markdown","f9ecec8f":"markdown"},"source":{"6b3af4da":"\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\nfrom sklearn.model_selection import train_test_split,GridSearchCV, cross_val_score\n%matplotlib inline","61603b47":"wine_data = pd.read_csv(\"..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv\")","dabd566c":"wine_data.head(10)","ce2e3591":"wine_data.info()\n# No null values","7b053166":"wine_data.quality.value_counts()\n# we have 6 kind of quality scores and most of them are 5 and 6","4b75deeb":"wine_data.shape","6c16b25d":"sns.countplot(x='quality',data=wine_data)","0a6fedc9":"sns.set_style('whitegrid')\nsns.lineplot(data=wine_data, x=\"quality\", y=\"fixed acidity\")","b973b4cf":" \nsns.set_style('whitegrid')\nsns.lineplot(x = 'quality', y = 'volatile acidity', data = wine_data)","43cdb7fb":"sns.set_style('whitegrid')\nsns.lineplot(x = 'quality', y = 'citric acid', data = wine_data)","4ca6959e":"sns.set_style('whitegrid')\nsns.lineplot(x = 'quality', y = 'residual sugar', data = wine_data)","465e6b51":"sns.set_style('whitegrid')\nsns.lineplot(x = 'quality', y = 'chlorides', data = wine_data)","ec7f0f3a":"sns.set_style('whitegrid')\nsns.lineplot(x = 'quality', y = 'free sulfur dioxide', data = wine_data)","b8c53f7f":"sns.set_style('whitegrid')\nsns.lineplot(x = 'quality', y = 'total sulfur dioxide', data = wine_data)","6ff2bc44":"sns.set_style('whitegrid')\nsns.lineplot(x = 'quality', y = 'sulphates', data = wine_data)","9e6be170":"sns.set_style('whitegrid')\nsns.lineplot(x = 'quality', y = 'alcohol', data = wine_data)","1d01db09":"corr = wine_data.corr()\n#Plot figsize\nfig, ax = plt.subplots(figsize=(10, 8))\n#Generate Heat Map, allow annotations and place floats in map\nsns.heatmap(corr, cmap='coolwarm', annot=True, fmt=\".2f\")\n# No correlation found.","0791dda5":"#Dividing wine as good and bad by giving the limit for the quality\nbins = (2, 6.5, 8)\ngroup_names = ['bad', 'good']\nwine_data['quality'] = pd.cut(wine_data['quality'], bins = bins, labels = group_names)\n#from 2 to 6.5 it is considered as bad and 6.5 to 8 as good","9dd9db39":"wine_data.head(10)","89d7f201":"#Using Label encoder, transforming catagorical features to numerical features.\nlabel_quality = LabelEncoder()","5c0693ff":"wine_data['quality'] = label_quality.fit_transform(wine_data['quality'])","7c0d4129":"wine_data['quality'].value_counts()","78ba8ab7":"sns.countplot(wine_data['quality'])","63070026":"#Now seperate the dataset as response variable and feature variabes\nX = wine_data.drop('quality', axis = 1)\ny = wine_data['quality']","23177266":"from imblearn.over_sampling import RandomOverSampler","a581d880":"os =  RandomOverSampler(random_state=0)\nX_train_res, y_train_res = os.fit_resample(X, y)","e7d5aa80":"X_train_res.shape, y_train_res.shape","f2cbe4b0":"sns.countplot(y_train_res)","499a41e6":"#Train and Test splitting of data \nX_train, X_test, y_train, y_test = train_test_split(X_train_res, y_train_res, test_size = 0.2, random_state = 42)","bfa7d957":"sc = StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.fit_transform(X_test)","cbc79be4":"# Fitting Logistic Regression to the Training set\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score\nlr = LogisticRegression()\nlr.fit(X_train, y_train)","ef6b93ad":"# predicting cross validation score\ncv_lr = cross_val_score(estimator = lr, X = X_train, y = y_train, cv = 10)\nprint(\"CV: \", cv_lr.mean())\n\ny_pred_lr_train = lr.predict(X_train)\naccuracy_train = accuracy_score(y_train, y_pred_lr_train)\nprint(\"Training set: \", accuracy_train)\n\ny_pred_lr_test = lr.predict(X_test)\naccuracy_test = accuracy_score(y_test, y_pred_lr_test)\nprint(\"Test set: \", accuracy_test)","7943c9e4":"from sklearn.metrics import confusion_matrix\ncon_mat = confusion_matrix(y_test,y_pred_lr_test)\n\n\nprint('\\nCONFUSION MATRIX')\nplt.figure(figsize= (6,4))\nsns.heatmap(con_mat, annot = True,fmt='d',cmap=\"YlGnBu\")","99a01646":"from sklearn.neighbors import KNeighborsClassifier\nknn = KNeighborsClassifier()\nknn.fit(X_train, y_train)","9860c339":"# Predicting Cross Validation Score\ncv_knn = cross_val_score(estimator = knn, X = X_train, y = y_train, cv = 10)\nprint(\"CV: \", cv_knn.mean())\n\ny_pred_knn_train =knn.predict(X_train)\naccuracy_knn_train = accuracy_score(y_train, y_pred_knn_train)\nprint(\"Training set: \", accuracy_knn_train)\n\ny_pred_knn_test = knn.predict(X_test)\naccuracy_knn_test = accuracy_score(y_test, y_pred_knn_test)\nprint(\"Test set: \", accuracy_knn_test)","e3166410":"con_mat = confusion_matrix(y_test,y_pred_knn_test)\n\n\nprint('\\nCONFUSION MATRIX')\nplt.figure(figsize= (6,4))\nsns.heatmap(con_mat, annot = True,fmt='d',cmap=\"YlGnBu\")","19d01a3c":"from sklearn.ensemble import RandomForestClassifier\nrfc = RandomForestClassifier(n_estimators=200)\nrfc.fit(X_train, y_train)","43e4d998":"# Predicting Cross Validation Score\ncv_rfc = cross_val_score(estimator = rfc, X = X_train, y = y_train, cv = 10)\nprint(\"CV: \", cv_rfc.mean())\n\ny_pred_rfc_train =rfc.predict(X_train)\naccuracy_rfc_train = accuracy_score(y_train, y_pred_rfc_train)\nprint(\"Training set: \", accuracy_rfc_train)\n\ny_pred_rfc_test = rfc.predict(X_test)\naccuracy_rfc_test = accuracy_score(y_test, y_pred_rfc_test)\nprint(\"Test set: \", accuracy_rfc_test)","895decdb":"con_mat = confusion_matrix(y_test,y_pred_rfc_test)\n\n\nprint('\\nCONFUSION MATRIX')\nplt.figure(figsize= (6,4))\nsns.heatmap(con_mat, annot = True,fmt='d',cmap=\"YlGnBu\")","ea4d709a":"from sklearn.svm import SVC\nsvc = SVC()\nsvc.fit(X_train, y_train)","59b85b41":"cv_svc = cross_val_score(estimator = svc, X = X_train, y = y_train, cv = 10)\nprint(\"CV: \", cv_svc.mean())\n\ny_pred_svc_train =svc.predict(X_train)\naccuracy_svc_train = accuracy_score(y_train, y_pred_rfc_train)\nprint(\"Training set: \", accuracy_rfc_train)\n\ny_pred_svc_test = svc.predict(X_test)\naccuracy_svc_test = accuracy_score(y_test, y_pred_svc_test)\nprint(\"Test set: \", accuracy_svc_test)","6a42b752":"con_mat = confusion_matrix(y_test,y_pred_svc_test)\n\n\nprint('\\nCONFUSION MATRIX')\nplt.figure(figsize= (6,4))\nsns.heatmap(con_mat, annot = True,fmt='d',cmap=\"YlGnBu\")","e35b5934":"from sklearn.tree import DecisionTreeClassifier\nclassifier_dt = DecisionTreeClassifier()\nclassifier_dt.fit(X_train, y_train)","cb3b54d8":"# Predicting Cross Validation Score\ncv_dt = cross_val_score(estimator = classifier_dt, X = X_train, y = y_train, cv = 10)\nprint(\"CV: \", cv_dt.mean())\n\ny_pred_dt_train = classifier_dt.predict(X_train)\naccuracy_dt_train = accuracy_score(y_train, y_pred_dt_train)\nprint(\"Training set: \", accuracy_dt_train)\n\ny_pred_dt_test = classifier_dt.predict(X_test)\naccuracy_dt_test = accuracy_score(y_test, y_pred_dt_test)\nprint(\"Test set: \", accuracy_dt_test)","f7c281ae":"con_mat = confusion_matrix(y_test,y_pred_dt_test)\n\n\nprint('\\nCONFUSION MATRIX')\nplt.figure(figsize= (6,4))\nsns.heatmap(con_mat, annot = True,fmt='d',cmap=\"YlGnBu\")\n","89e9a360":"param = {\n    'C': [0.1,0.8,0.9,1,1.1,1.2,1.3,1.4],\n    'kernel':['linear', 'rbf'],\n    'gamma' :[0.1,0.8,0.9,1,1.1,1.2,1.3,1.4]\n}\ngrid_svc = GridSearchCV(svc, param_grid=param, scoring='accuracy', cv=10)","90bb9e35":"grid_svc.fit(X_train, y_train)","0fe2f495":"svc2 = SVC()\nsvc2.fit(X_train, y_train)\npred_svc2 = svc2.predict(X_test)\naccuracy_dt_test = accuracy_score(y_test,pred_svc2)\nprint(\"Test set: \", accuracy_dt_test)","f86ce148":"# <span id=\"7\"><\/span> Random forest","116c2532":"## <span id=\"1\"><\/span>  About Data","9dc0470e":"# <span id=\"6\"><\/span> K-Nearest Neighbour","712c11d3":"## Handeling imbalance dataset","c2349e27":"### we can see that fixed acidity does not provide much inforamation to classify quality.","09b892c3":"### Sulphates level goes higher with the quality of wine","b70d27a0":"#### Lets compare each and every feature with quality feature to get more insights","f52b0920":"### alcohol level goes higher with the quality of wine","1a9ae08b":"### Composition of chloride also go down as we go higher in the quality of the wine","b795d013":"### Thanks for reading.If you like the notebook,do upvote.","89dee2cc":"## <span id=\"2\"><\/span> Importing Libraries","e38d8506":"**fixed acidity**: most acids involved with wine or fixed or nonvolatile\n\n**volatile acidity**: the amount of acetic acid in wine\n\n**citric acid**: found in small quantities, citric acid can add 'freshness'                    and flavor to wines\n\n**residual sugar**: the amount of sugar remaining after fermentation stops\n\n**chlorides**: the amount of salt in the wine\n\n**free sulfur dioxide**: the free form of SO2 exists in equilibrium between                            molecular SO2 (as a dissolved gas) and bisulfite ion\n\n**total sulfur dioxide**: amount of free and bound forms of S02\n\n**density**: the density of water is close to that of water depending on the              percent alcohol and sugar content\n\n**pH**: describes how acidic or basic a wine is on a scale from 0 (very               acidic) to 14 (very basic)\n\n**sulphates**: a wine additive which can contribute to sulfur dioxide gas                   (S02) levels\n\n**alcohol**: the percent alcohol content of the wine\n             Output Variable:","50e67283":"# <span id=\"11\"><\/span>Conclusion\n### Random forest gives us highest accuracy.\n","8da91b6b":"![wine.jpeg](attachment:wine.jpeg)","51f08e31":"### Now we have same number for good and bad quality of wine.","d6f6534c":"### This notebook aims to classify the quality of red wine using various parameters or features. This will be a classification problem and will try to use various classification models to find best accuracy score.","8eb42cef":"# <span id=\"10\"><\/span>GridSeachCV","acd4fd6e":"### Composition of citric acid go higher as we go higher in the quality of the wine","02583f98":"# <span id=\"8\"><\/span> Support Vector Machine","e86cb0d4":"# <span id=\"9\"><\/span>Decision Tree","e7394e41":"### Lets summerize what we can infer from the above analysis.\n1. #### With the increase of the quality score, the composition of chlorides and volatile acidity decreases.\n\n2. #### With the increase for quality score, the compostion of alcohol, sulphates and citric acid increases.","c3e9bd90":"#### no specific relation","b1a12f17":"# <span id=\"4\"><\/span> Model Creation","9bc72259":"\n1. [About Data](#1)\n1. [Importing Libraries and Reading the Dataset](#2)\n1. [Data Visualization and Preprocessing and handling imbalance dataset](#3)\n1. [Model Creation](#4) \n    * [Logistic Regression](#5) \n    * [K-Nearest Neighbors(K-NN)](#6)\n    * [Random Forest](#7)\n    * [Support Vector Machine](#8)\n    * [Decision Tree](#9)\n    * [GridSearchCV](#10)\n    \n1. [Conclusion](#11)\n","b40957a1":"### As the quality score increases volatile acidity composition decreases.","79cda64a":"## <span id=\"3\"><\/span>  Data Visualization and preprocessing","f9ecec8f":"\n# <span id=\"5\"><\/span> Logistic Regression"}}