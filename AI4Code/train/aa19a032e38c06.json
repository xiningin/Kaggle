{"cell_type":{"384d4989":"code","2f1ebbd5":"code","4fb15951":"code","56e25ce4":"code","40a3f5b9":"code","7367deeb":"code","10a64c5d":"code","cc09921b":"code","d6455457":"code","a326f231":"code","da7284ad":"code","4df20912":"code","3e939158":"code","3a15283a":"code","5fae39aa":"code","6d9715c4":"code","a79d8132":"code","2db0eb7e":"code","52ece6a7":"code","46097f7f":"code","f7ba41a1":"code","127376ce":"code","50733ebd":"code","cc0d4b26":"code","c79d839b":"code","2bebb627":"code","120c47fa":"code","16bba14a":"code","6a7c330f":"code","e255ae89":"code","3085235b":"code","d13b7a55":"code","0d4dd12c":"code","41673db7":"code","6d913656":"code","4781add6":"code","5668b030":"code","c7a23c16":"code","0b96a52b":"code","f1285404":"code","b325b3e3":"code","f616d306":"code","1bd27a86":"code","1e370bd8":"code","e855cb9e":"code","6ae12943":"code","d486ed0e":"code","c6b5c494":"code","1e26b268":"code","6d3e5560":"code","c81eb2ee":"code","d62843f5":"code","e8e2b49a":"code","14fe0aa5":"markdown"},"source":{"384d4989":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nimport numpy as np # linear algebra\nfrom numpy.lib.stride_tricks import as_strided\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom pandas import Series, DataFrame\nfrom matplotlib import pyplot as plt\nplt.style.use('fivethirtyeight')\nplt.rcParams['figure.figsize'] = [12, 8]\nfrom sklearn.preprocessing import MinMaxScaler\nfrom datetime import timedelta\nimport datetime","2f1ebbd5":"a = pd.read_csv('..\/input\/solar-measurementspakistanlahorewb-esmapqc.csv', index_col='time', parse_dates=['time'])","4fb15951":"a['time']=a.index\n#a[\"time\"] =  pd.to_datetime(a[\"time\"])\n#a['date'] = pd.to_datetime(a['time']).dt.date\na['Month'] = pd.to_datetime(a['time']).dt.month\na['day'] = pd.to_datetime(a['time']).dt.day\na['hour'] = pd.to_datetime(a['time']).dt.hour\na['minute'] = pd.to_datetime(a['time']).dt.minute\n","56e25ce4":"x=7\ny=19\nb=a[a['hour'] >x]\nb=b[b['hour'] <y]\nc=b[(b['hour']==y-1) & (b['minute']>0)]\nindex=c.index\nfor i in index:\n    b = b.drop([i], axis=0)\nd=b[(b['hour']==x) & (b['minute']<10)]\nj=d.index\nfor i in j:\n    b = b.drop([i], axis=0)","40a3f5b9":"del b['comments']\n#del b['time']\n#del b['sensor_cleaning']\n#del b['']\n#del b['']\n#del b['']\n#del b['']\n#del b['']","7367deeb":"b=b.interpolate(method='time', axis=0, limit=None, inplace=False, limit_direction='forward', limit_area=None, downcast=None)","10a64c5d":"b.isnull().T.any().T.sum()","cc09921b":"def timeseries_to_supervised(data, lag=1):\n    df = pd.DataFrame(data)\n    columns = [df.shift(i) for i in range(1, lag+1)]\n    columns.append(df)\n    df = pd.concat(columns, axis=1)\n    return df","d6455457":"c=b.iloc[35:,:]","a326f231":"b=c","da7284ad":"c=b['ghi_pyr']\nd=timeseries_to_supervised(c, lag=60)","4df20912":"d","3e939158":"t1=d.iloc[:,0:1]\nt2=d.iloc[:,1:2]\nt3=d.iloc[:,2:3]\nt4=d.iloc[:,3:4]\nt5=d.iloc[:,4:5]\nt6=d.iloc[:,5:6]\nt7=d.iloc[:,6:7]\nt8=d.iloc[:,7:8]\nt9=d.iloc[:,8:9]\nt10=d.iloc[:,9:10]\nt11=d.iloc[:,10:11]\nt12=d.iloc[:,11:12]\nt13=d.iloc[:,12:13]\nt14=d.iloc[:,13:14]\nt15=d.iloc[:,14:15]\nt16=d.iloc[:,15:16]\nt17=d.iloc[:,16:17]\nt18=d.iloc[:,17:18]\nt19=d.iloc[:,18:19]\nt20=d.iloc[:,19:20]\nt21=d.iloc[:,20:21]\nt22=d.iloc[:,21:22]\nt23=d.iloc[:,22:23]\nt24=d.iloc[:,23:24]\nt25=d.iloc[:,24:25]\nt26=d.iloc[:,25:26]\nt27=d.iloc[:,26:27]\nt28=d.iloc[:,27:28]\nt29=d.iloc[:,28:29]\nt30=d.iloc[:,29:30]\nt31=d.iloc[:,30:31]\nt32=d.iloc[:,31:32]\nt33=d.iloc[:,32:33]\nt34=d.iloc[:,33:34]\nt35=d.iloc[:,34:35]\nt36=d.iloc[:,35:36]\nt37=d.iloc[:,36:37]\nt38=d.iloc[:,37:38]\nt39=d.iloc[:,38:39]\nt40=d.iloc[:,39:40]\nt41=d.iloc[:,40:41]\nt42=d.iloc[:,41:42]\nt43=d.iloc[:,42:43]\nt44=d.iloc[:,43:44]\nt45=d.iloc[:,44:45]\nt46=d.iloc[:,45:46]\nt47=d.iloc[:,46:47]\nt48=d.iloc[:,47:48]\nt49=d.iloc[:,48:49]\nt50=d.iloc[:,49:50]\nt51=d.iloc[:,50:51]\nt52=d.iloc[:,51:52]\nt53=d.iloc[:,52:53]\nt54=d.iloc[:,53:54]\nt55=d.iloc[:,54:55]\nt56=d.iloc[:,55:56]\nt57=d.iloc[:,56:57]\nt58=d.iloc[:,57:58]\nt59=d.iloc[:,58:59]\nt60=d.iloc[:,59:60]\nbb=b['ghi_pyr']","3a15283a":"t1.columns=['t-1']\nt2.columns=['t-2']\nt3.columns=['t-3']\nt4.columns=['t-4']\nt5.columns=['t-5']\nt6.columns=['t-6']\nt7.columns=['t-7']\nt8.columns=['t-8']\nt9.columns=['t-9']\nt10.columns=['t-10']\nt11.columns=['t-11']\nt12.columns=['t-12']\nt13.columns=['t-13']\nt14.columns=['t-14']\nt15.columns=['t-15']\nt16.columns=['t-16']\nt17.columns=['t-17']\nt18.columns=['t-18']\nt19.columns=['t-19']\nt20.columns=['t-20']\nt21.columns=['t-21']\nt22.columns=['t-22']\nt23.columns=['t-23']\nt24.columns=['t-24']\nt25.columns=['t-25']\nt26.columns=['t-26']\nt27.columns=['t-27']\nt28.columns=['t-28']\nt29.columns=['t-29']\nt30.columns=['t-30']\nt31.columns=['t-31']\nt32.columns=['t-32']\nt33.columns=['t-33']\nt34.columns=['t-34']\nt35.columns=['t-35']\nt36.columns=['t-36']\nt37.columns=['t-37']\nt38.columns=['t-38']\nt39.columns=['t-39']\nt40.columns=['t-40']\nt41.columns=['t-41']\nt42.columns=['t-42']\nt43.columns=['t-43']\nt44.columns=['t-44']\nt45.columns=['t-45']\nt46.columns=['t-46']\nt47.columns=['t-47']\nt48.columns=['t-48']\nt49.columns=['t-49']\nt50.columns=['t-50']\nt51.columns=['t-51']\nt52.columns=['t-52']\nt53.columns=['t-53']\nt54.columns=['t-54']\nt55.columns=['t-55']\nt56.columns=['t-56']\nt57.columns=['t-57']\nt58.columns=['t-58']\nt59.columns=['t-59']\nt60.columns=['t-60']\nbb.columns=['ghi_pyr']","5fae39aa":"aa=pd.concat([t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11,t12,t13,t14,t15,t16,t17,t18,t19,t20,t21,t22,t23,t24,t25,t26,t27,t28,t29,t30,t31,t32,t33,t34,t35,t36,t37,t38,t39,t40,t41,t42,t43,t44,t45,t46,t47,t48,t49,t50,t51,t52,t53,t54,t55,t56,t57,t58,t59,t60,bb], axis=1)","6d9715c4":"cc=aa.iloc[61:,:]","a79d8132":"z=cc['ghi_pyr']","2db0eb7e":"from sklearn.metrics import mutual_info_score\nimport math\ny=cc['t-1']\nm1=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-2']\nm2=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-3']\nm3=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-4']\nm4=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-5']\nm5=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-6']\nm6=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-7']\nm7=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-8']\nm8=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-9']\nm9=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-10']\nm10=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-11']\nm11=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-12']\nm12=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-13']\nm13=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-14']\nm14=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-15']\nm15=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-16']\nm16=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-17']\nm17=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-18']\nm18=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-19']\nm19=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-20']\nm20=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-21']\nm21=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-22']\nm22=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-23']\nm23=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-24']\nm24=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-25']\nm25=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-26']\nm26=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-27']\nm27=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-28']\nm28=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-29']\nm29=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-30']\nm30=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-31']\nm31=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-32']\nm32=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-33']\nm33=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-34']\nm34=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-35']\nm35=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-36']\nm36=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-37']\nm37=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-38']\nm38=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-39']\nm39=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-40']\nm40=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-41']\nm41=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-42']\nm42=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-43']\nm43=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-44']\nm44=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-45']\nm45=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-46']\nm46=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-47']\nm47=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-48']\nm48=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-49']\nm49=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-50']\nm50=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-51']\nm51=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-52']\nm52=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-53']\nm53=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-54']\nm54=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-55']\nm55=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-56']\nm56=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-57']\nm57=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-58']\nm58=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-59']\nm59=mutual_info_score(z, y, contingency=None)\n\ny=cc['t-60']\nm60=mutual_info_score(z, y, contingency=None)\n","52ece6a7":"ms1=m1\/5\nlogm1=math.log(ms1,10)\n\nms2=m2\/5\nlogm2=math.log(ms2,10)\n\nms3=m3\/5\nlogm3=math.log(ms3,10)\n\nms4=m4\/5\nlogm4=math.log(ms4,10)\n\nms5=m5\/5\nlogm5=math.log(ms5,10)\n\nms6=m6\/5\nlogm6=math.log(ms6,10)\n\nms7=m7\/5\nlogm7=math.log(ms7,10)\n\nms8=m8\/5\nlogm8=math.log(ms8,10)\n\nms9=m9\/5\nlogm9=math.log(ms9,10)\n\nms10=m10\/5\nlogm10=math.log(ms10,10)\n\nms11=m11\/5\nlogm11=math.log(ms11,10)\n\nms12=m12\/5\nlogm12=math.log(ms12,10)\n\nms13=m13\/5\nlogm13=math.log(ms13,10)\nms14=m14\/5\nlogm14=math.log(ms14,10)\nms15=m15\/5\nlogm15=math.log(ms15,10)\nms16=m16\/5\nlogm16=math.log(ms16,10)\nms17=m17\/5\nlogm17=math.log(ms17,10)\nms18=m18\/5\nlogm18=math.log(ms18,10)\nms19=m19\/5\nlogm19=math.log(ms19,10)\nms20=m20\/5\nlogm20=math.log(ms20,10)\n\nms21=m21\/5\nlogm21=math.log(ms21,10)\n\nms22=m22\/5\nlogm22=math.log(ms22,10)\n\nms23=m23\/5\nlogm23=math.log(ms23,10)\n\nms24=m24\/5\nlogm24=math.log(ms24,10)\n\nms25=m25\/5\nlogm25=math.log(ms25,10)\n\nms26=m26\/5\nlogm26=math.log(ms26,10)\n\nms27=m27\/5\nlogm27=math.log(ms27,10)\n\nms28=m28\/5\nlogm28=math.log(ms28,10)\n\nms29=m29\/5\nlogm29=math.log(ms29,10)\n\nms30=m30\/5\nlogm30=math.log(ms30,10)\n\nms31=m31\/5\nlogm31=math.log(ms31,10)\n\nms32=m32\/5\nlogm32=math.log(ms32,10)\n\nms33=m33\/5\nlogm33=math.log(ms33,10)\n\nms34=m34\/5\nlogm34=math.log(ms34,10)\n\nms35=m35\/5\nlogm35=math.log(ms35,10)\n\nms36=m36\/5\nlogm36=math.log(ms36,10)\n\nms37=m37\/5\nlogm37=math.log(ms37,10)\n\nms38=m38\/5\nlogm38=math.log(ms38,10)\n\nms39=m39\/5\nlogm39=math.log(ms39,10)\n\nms40=m40\/5\nlogm40=math.log(ms40,10)\n\nms41=m41\/5\nlogm41=math.log(ms41,10)\n\nms42=m42\/5\nlogm42=math.log(ms42,10)\n\nms43=m43\/5\nlogm43=math.log(ms43,10)\n\nms44=m44\/5\nlogm44=math.log(ms44,10)\n\nms45=m45\/5\nlogm45=math.log(ms45,10)\n\nms46=m46\/5\nlogm46=math.log(ms46,10)\n\nms47=m47\/5\nlogm47=math.log(ms47,10)\n\nms48=m48\/5\nlogm48=math.log(ms48,10)\n\nms49=m49\/5\nlogm49=math.log(ms49,10)\n\nms50=m50\/5\nlogm50=math.log(ms50,10)\nms51=m51\/5\nlogm51=math.log(ms51,10)\nms52=m52\/5\nlogm52=math.log(ms52,10)\nms53=m53\/5\nlogm53=math.log(ms53,10)\nms54=m54\/5\nlogm54=math.log(ms54,10)\nms55=m55\/5\nlogm55=math.log(ms55,10)\nms56=m56\/5\nlogm56=math.log(ms56,10)\nms57=m57\/5\nlogm57=math.log(ms57,10)\nms58=m58\/5\nlogm58=math.log(ms58,10)\nms59=m59\/5\nlogm59=math.log(ms59,10)\nms60=m60\/5\nlogm60=math.log(ms60,10)\n\n\n","46097f7f":"x=np.array(['t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11','t12','t13','t14','t15','t16','t17','t18','t19','t20','t21','t22','t23','t24','t25','t26','t27','t28','t29','t30','t31','t32','t33','t34','t35','t36','t37','t38','t39','t40','t41','t42','t43','t44','t45','t46','t47','t48','t49','t50','t51','t52','t53','t54','t55','t56','t57','t58','t59','t60'])\ny=np.array([logm1,logm2,logm3,logm4,logm5,logm6,logm7,logm8,logm9,logm10,logm11,logm12,logm13,logm14,logm15,logm16,logm17,logm18,logm19,logm20,logm21,logm22,logm23,logm24,logm25,logm26,logm27,logm28,logm29,logm30,logm31,logm32,logm33,logm34,logm35,logm36,logm37,logm38,logm39,logm40,logm41,logm42,logm43,logm44,logm45,logm46,logm47,logm48,logm49,logm50,logm51,logm52,logm53,logm54,logm55,logm56,logm57,logm58,logm59,logm60])","f7ba41a1":"print(logm1)\nprint(logm2)\nprint(logm3)\nprint(logm4)\nprint(logm5)\nprint(logm6)\nprint(logm7)\nprint(logm8)\nprint(logm53)\nprint(logm54)\nprint(logm55)\nprint(logm56)\nprint(logm57)\nprint(logm58)\nprint(logm59)\nprint(logm60)","127376ce":"import seaborn as sns\nsns.barplot(x, y)","50733ebd":"b","cc0d4b26":"f=b.iloc[61:,:]\ny=f['air_temperature']\nAT=mutual_info_score(z, y, contingency=None)\n#at=AT\/5\nxx=math.log(AT,10)\nprint('MI with air_temperature is', xx)\ny=f['relative_humidity']\nAT=mutual_info_score(z, y, contingency=None)\nxx=math.log(AT,10)\nprint('MI with relative_humidity is', xx)\ny=f['wind_speed']\nAT=mutual_info_score(z, y, contingency=None)\nxx=math.log(AT,10)\nprint('MI with wind_speed is', xx)\n\ny=f['wind_speed_of_gust']\nAT=mutual_info_score(z, y, contingency=None)\nxx=math.log(AT,10)\nprint('MI with wind_speed_of_gust is', xx)\n\ny=f['wind_from_direction_st_dev']\nAT=mutual_info_score(z, y, contingency=None)\nxx=math.log(AT,10)\nprint('MI with wind_from_direction_st_dev is', xx)\n\ny=f['wind_from_direction']\nAT=mutual_info_score(z, y, contingency=None)\nxx=math.log(AT,10)\nprint('MI with wind_from_direction is', xx)\n\ny=f['barometric_pressure']\nAT=mutual_info_score(z, y, contingency=None)\nxx=math.log(AT,10)\nprint('MI with barometric_pressure is', xx)\n","c79d839b":"a=f\na","2bebb627":"del a['ghi_rsi']\ndel a['dni']\ndel a['dhi']\ndel a['wind_speed']\ndel a['wind_from_direction']\ndel a['minute']\ndel a['sensor_cleaning']\ndel a['Month']\ndel a['day']\ndel a['hour']\ndel a['ghi_pyr']\ndel a['time']","120c47fa":"a","16bba14a":"aa=pd.concat([t57,t58,t59,t60,t3,t2,t1,bb], axis=1)\naa=aa.iloc[61:,:]","6a7c330f":"g=pd.concat([a,aa], axis=1)","e255ae89":"g","3085235b":"X=g.iloc[:,0:12].values\nY=g.iloc[:,1:13].values","d13b7a55":"l,m=X.shape\nimport math\ntrl= math.floor(0.75*l)","0d4dd12c":"X_train = X[:trl,:]\nX_test = X[trl:,:]\nY_train = Y[:trl,:]\nY_test = Y[trl:,:]","41673db7":"import keras\nfrom sklearn.preprocessing import MinMaxScaler\n# Scaling\nsc = MinMaxScaler(feature_range=(0,1))\ntrain_set_scaled = sc.fit_transform(X_train[:,:])\ndev_set_scaled = sc.fit_transform(X_test[:,:])\nY_train=sc.fit_transform(Y_train[:,:])\nY_test=sc.fit_transform(Y_test[:,:])\nprint(train_set_scaled.shape, dev_set_scaled.shape, Y_train.shape, Y_test.shape)","6d913656":"X_train = []\ny_train = []\nX_test = []\ny_test = []\n\nX_train, y_train = train_set_scaled[:,:], Y_train\nX_test, y_test = dev_set_scaled[:,:], Y_test\n\nprint(X_train.shape, y_train.shape, X_test.shape, y_test.shape)","4781add6":"def shape_for_lstm(input_df, seq_length=3):\n\n    raw_values = input_df\n    raw_shape = raw_values.shape\n    new_values = np.empty([raw_shape[0] - seq_length, seq_length, raw_shape[1]])\n    cur_pos = 0\n    for i in range(new_values.shape[0]):\n        next_pos = cur_pos + seq_length\n        new_values[i,:,:] = raw_values[cur_pos:next_pos,:]\n        cur_pos = cur_pos + 1\n    return new_values","5668b030":"x_train = shape_for_lstm(X_train, seq_length=3)\nx_test = shape_for_lstm(X_test, seq_length=3)\nY_train = shape_for_lstm(y_train, seq_length=3)\nY_test = shape_for_lstm(y_test, seq_length=3)","c7a23c16":"import numpy as np # linear algebra\nfrom numpy.lib.stride_tricks import as_strided\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom pandas import Series, DataFrame\nfrom matplotlib import pyplot as plt\nplt.style.use('fivethirtyeight')\nplt.rcParams['figure.figsize'] = [12, 8]\nfrom keras.models import Sequential\nfrom keras.layers import Dense, LSTM, Flatten\nfrom keras.optimizers import Adam\nimport keras.backend as K\nfrom sklearn.preprocessing import MinMaxScaler\nfrom datetime import timedelta","0b96a52b":"model = Sequential()\nmodel.add(LSTM(x_train.shape[2], input_shape=(x_train.shape[1], x_train.shape[2]), return_sequences=True))\nmodel.compile(optimizer=Adam(lr=0.001), loss='mean_squared_error', metrics=['mse'])\nmodel.fit(x_train, Y_train, batch_size=4, epochs=5, verbose=1)","f1285404":"Y_pred = model.predict(x_test, batch_size=1)","b325b3e3":"Y_pred.shape","f616d306":"j=Y_pred[:,2:3,:]\nk=Y_test[:,2:3,:]","1bd27a86":"k.shape","1e370bd8":"J=j.reshape(14027,12)\nK=k.reshape(14027,12)","e855cb9e":"yhat_inverse = sc.inverse_transform(J)\ntestY_inverse = sc.inverse_transform(K)","6ae12943":"yp=yhat_inverse[:,11:12]\nyt=testY_inverse[:,11:12]","d486ed0e":"def rmse(predictions, targets):\n    return np.sqrt(((predictions - targets) ** 2).mean())","c6b5c494":"rmse(yp,yt)","1e26b268":"df = pd.DataFrame(yp)\ndf1=pd.DataFrame(yt)","6d3e5560":"g=pd.concat([df, df1])","c81eb2ee":"g.to_csv('mycsvfile.csv',index=False)","d62843f5":"df.to_csv('mycsvfiledfpred.csv',index=False)","e8e2b49a":"df1.to_csv('mycsvfiledftst.csv',index=False)","14fe0aa5":"## ALSTM"}}