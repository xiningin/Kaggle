{"cell_type":{"821928a3":"code","5821ec06":"code","197cf03e":"code","9e4786d7":"code","24a2d464":"code","d22a45f9":"code","99e15abf":"code","62f01475":"code","6599a120":"code","029a5a6a":"code","85d291ee":"code","209e32ec":"code","0b8d912d":"code","75593900":"code","dc77a51f":"markdown","04406d93":"markdown","597cc140":"markdown","d345b16d":"markdown","14df81a8":"markdown","fa88b746":"markdown","a70fc8e6":"markdown","30c22e80":"markdown","9f68f3c9":"markdown","63fd546e":"markdown","1dfb7a82":"markdown","1c6b1fee":"markdown","06942b4c":"markdown"},"source":{"821928a3":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","5821ec06":"import pandas as pd","197cf03e":"data_df = pd.read_csv(\"\/kaggle\/input\/gender-overall-earnings-gap-in-europe\/teqges01.tsv\", sep='\\t')","9e4786d7":"print(list(data_df.columns))","24a2d464":"data_df.head()","d22a45f9":"data_df.tail()","99e15abf":"pivot_data_col = data_df.columns[0]\nyear_columns = data_df.columns[1:]","62f01475":"data_df['nace_r2'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[0])\ndata_df['indic_em'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[1])\ndata_df['sex'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[2])\ndata_df['isco08'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[3])\ndata_df['worktime']     = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[4])\ndata_df['age']     = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[5])\ndata_df['indic_se']     = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[6])\ndata_df['unit']     = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[7])\ndata_df['geo']     = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[8])","6599a120":"selected_columns = list(['nace_r2', 'indic_em', 'sex', 'isco08', 'worktime', 'age', 'indic_se', 'unit', 'geo']) +  list(year_columns)\ndata_df = data_df[selected_columns]","029a5a6a":"data_tr_df = data_df.melt(id_vars=['nace_r2', 'indic_em', 'sex', 'isco08', 'worktime', 'age', 'indic_se', 'unit', 'geo'], \n        var_name=\"year\", \n        value_name=\"value\")\ndata_tr_df['geo'] = data_tr_df['geo'].apply(lambda x: str(x))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"e\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"b\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"u\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"c\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"d\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"z\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\": \", \"NAN\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: float(x))","85d291ee":"print(f\"Transformed data shape: {data_tr_df.shape} (rows\/columns)\")\ndata_tr_df.head()","209e32ec":"data_tr_df.tail()","0b8d912d":"import pandas_profiling\npandas_profiling.ProfileReport(data_tr_df)","75593900":"data_tr_df.to_csv(\"gender_overall_earnings_gap_in_europe.csv\", index=False)","dc77a51f":"Next, we pivot the time columns using `melt` operation in pandas.  \nWe also make sure we transform `date` to be an integer (here is a year data).  \nWe set `value` to be a float, after we replace \": \" (for N\/A) with `NAN`.","04406d93":"Let's also take a look to few of the rows.","597cc140":"# Introduction\n\nWe show in this Kernel how we can process the data to prepare it for easier processing. Let's check the data files.","d345b16d":"# A very preliminary exploratory data analysis\n\nThis would be a very short exploratory data analysis. The role of this Kernel is just to show how we can prepare the annual data for analysis and we already did this.","14df81a8":"Then, we split from `pivot_data_col` the 9 separate fields:\n* nace_r2\n* indic_em\n* sex\n* isco08\n* worktime\n* age\n* indic_se\n* unit\n* geo","fa88b746":"Let's glimpse the data columns.","a70fc8e6":"# Analysis preparation\n\n## Load packages","30c22e80":"The first column is a composed one, containing 9 different information (nace_r2, indic_em, sex, isco08, worktime, age, indic_se, unit, geo). The next columns are temporal values, the years value.","9f68f3c9":"# Export data in csv format","63fd546e":"Let's inspect the result.","1dfb7a82":"# Data pre-processing\n\nWe start by defining two working lists.","1c6b1fee":"We select now only the new columns resulted from splitting the `pivot_data_col` and the time columns.","06942b4c":"## Load the data\n\nThe datafiles are in TSV format. We will read the files using pandas, just include in the function call the `sep` (tab separator data).\nWe demonstrate first how to read and process the Annual data."}}