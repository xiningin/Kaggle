{"cell_type":{"c6edb50c":"code","4f8c4f9e":"code","cf3af4bc":"code","870980b1":"code","710afb48":"code","0cb3acf8":"code","03b82eca":"code","4a2996d8":"code","7db9ffca":"code","4e2aea4e":"code","37f9dfc5":"code","df6ad329":"code","3f632064":"code","fb54309d":"code","58e3c54d":"code","3ac5a58f":"code","b579984e":"code","3206278d":"code","91f1b358":"code","685e15d3":"code","d4d31883":"code","722f8050":"code","01f3765e":"code","e94feff1":"code","1c420223":"code","108dc57f":"code","51e2b0d9":"code","dfe6715c":"code","001f4752":"code","d034d804":"code","3fe0607e":"code","aaa3701a":"code","2ec4004f":"code","e597b685":"code","cfe6bc23":"code","f8c097f5":"code","4c8c5762":"markdown","e5710984":"markdown","6fdec7ca":"markdown","79d00821":"markdown","881e1610":"markdown","f21159a9":"markdown","fda2865e":"markdown","73c21346":"markdown","85aca418":"markdown","e5a6d094":"markdown","6e0d70f9":"markdown","c5ad7396":"markdown","cafddaee":"markdown","ba5d826e":"markdown","c446f339":"markdown","8cbaa3d4":"markdown","b1d36bd0":"markdown","68e2e8ab":"markdown"},"source":{"c6edb50c":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","4f8c4f9e":"tran=pd.read_csv('..\/input\/petfinder-pawpularity-score\/train.csv')\ntest=pd.read_csv('..\/input\/petfinder-pawpularity-score\/test.csv')","cf3af4bc":"tran.head()","870980b1":"tran.columns","710afb48":"test.columns","0cb3acf8":"column=[col for col in tran.columns if col not in ['Id','Pawpularity']]","03b82eca":"x=tran[column]\ny=tran['Pawpularity']","4a2996d8":"print(x.shape,y.shape,test.shape)","7db9ffca":"test_id=test['Id']\ntest=test.drop('Id',axis=1)\ntest.shape","4e2aea4e":"tran.isnull().any()","37f9dfc5":"test.isnull().any()","df6ad329":"tran.drop('Id',axis=1,inplace=True)","3f632064":"tran_matrix=tran.corr()\nplt.figure(figsize=(10,8))\nsns.heatmap(tran_matrix,linewidth=0.1,linecolor='white',annot=True,cmap='Pastel1',fmt='.2f')\nplt.show()","fb54309d":"feature_variables=x.columns\ntarget_variable='Pawpularity'","58e3c54d":"from sklearn.decomposition import PCA\npca=PCA(n_components=2,random_state=42)\npca=pca.fit_transform(x)","3ac5a58f":"plt.figure(figsize=(8,7))\nplt.scatter(pca[:,0],pca[:,1],color='red')\nplt.show()","b579984e":"plt.hist(y,bins=10)\nplt.show()","3206278d":"y_log=np.log1p(y)\nplt.hist(y_log,bins=10)\nplt.show()","91f1b358":"from sklearn.model_selection import KFold\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import train_test_split,GridSearchCV\nimport xgboost as xgb","685e15d3":"fold=KFold(n_splits=5,random_state=42,shuffle=True)","d4d31883":"xtrain,xtest,ytrain,ytest=train_test_split(x,y_log,random_state=42,test_size=0.2)","722f8050":"print(xtrain.shape,ytrain.shape)","01f3765e":"param={'n_estimators' : [400,600,700,800,900],\n      'max_depth': [3,5,7,9],\n      'learning_rate':[0.01,0.05,0.1,0.03],\n      'objective':['reg:squarederror'],\n      'booster':['gbtree']}","e94feff1":"xgb_regressor=xgb.XGBRegressor()","1c420223":"xgb_grid=GridSearchCV(xgb_regressor,param,n_jobs=-1,cv=fold)","108dc57f":"xgb_grid.fit(xtrain,ytrain)","51e2b0d9":"xgb_grid.best_params_","dfe6715c":"xgb=xgb.XGBRegressor(**xgb_grid.best_params_)","001f4752":"xgb=xgb.fit(xtrain,ytrain)","d034d804":"y_pred=xgb.predict(xtest)","3fe0607e":"from sklearn.metrics import mean_squared_error\nmse=mean_squared_error(ytest,y_pred)\nrmse=np.sqrt(mse)\nrmse","aaa3701a":"sub=xgb.predict(test)\nsub.shape","2ec4004f":"sub=np.expm1(sub)","e597b685":"submission=pd.DataFrame({'Id':test_id,'Pawpularity':sub})","cfe6bc23":"submission","f8c097f5":"submission.to_csv('submission.csv',index=False)","4c8c5762":"Loading the .csv file","e5710984":"Droping train id column","6fdec7ca":"In this competetition, our goal is to predict pawpularity of pet's profile based on appearance of pet profile. ","79d00821":"**Heatmap analysis**","881e1610":"Checking pawpularity distribution ","f21159a9":"Listing test columns names","fda2865e":"Best parameters of gridsearchcv","73c21346":"Checking any null instances in train and test dataset","85aca418":"Spliting train and test dataset","e5a6d094":"Visualization of PCA ","6e0d70f9":"Filtering columns for x and y variables","c5ad7396":"sns.countplot(x=feature_variables,y=target_variable,data=tran)","cafddaee":"Listing train columns name","ba5d826e":"**Parameters for Gradient boosting Regressor algorithm**","c446f339":"RMSE value","8cbaa3d4":"**Using parameters of gridsearchcv for training new xgb regressor**","b1d36bd0":"Predicting new instances","68e2e8ab":"Using PCA to reduce dimension for analysis outlier"}}