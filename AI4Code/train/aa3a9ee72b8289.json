{"cell_type":{"a472ac29":"code","01e73d7e":"code","0ec47029":"code","a8c0e540":"code","85bdf5f7":"code","19fcb3e7":"code","359ad0b3":"code","8129c510":"code","40c359e6":"code","2f973da5":"code","47b29aa7":"code","e1311402":"code","f8dffb82":"code","d3df4c17":"markdown","17531178":"markdown","5df38803":"markdown"},"source":{"a472ac29":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","01e73d7e":"import pandas as pd\nimport numpy as np","0ec47029":"#load data set\ndata = pd.read_csv('\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","a8c0e540":"#checking data info\ndata.info()","85bdf5f7":"data = data.drop(['CustomerID','Gender'],axis=1)\ndata.head()","19fcb3e7":"#rename column\ndata = data.rename(columns={'Age':'age','Annual Income (k$)':'annual_income',\n                          'Spending Score (1-100)':'spending_score'})\ndata.head()","359ad0b3":"# Import K-means and find K optimum with elbow method\nfrom sklearn.cluster import KMeans","8129c510":"#make a new variable name X, make list containing inertia\nX = data\n\nclusters =[]\n\nfor i in range(1,15):\n    km = KMeans(n_clusters=i).fit(X)\n    clusters.append(km.inertia_)","40c359e6":"#visualization K-means\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns","2f973da5":"#making inertia plot\nfig, ax = plt.subplots(figsize =(10,5))\nsns.lineplot(x=list(range(1,15)),y=clusters, ax=ax)\nax.set_title('Elbow Method')\nax.set_xlabel('Cluster')\nax.set_ylabel('Inertia')","47b29aa7":"#make object of K-Means\nkm1 = KMeans(n_clusters=5).fit(X)","e1311402":"#adding lable column on in dataset\nX['Labels'] = km1.labels_\n\n","f8dffb82":"#making plot K-means with five clusters\nplt.figure(figsize=(10,5))\nsns.scatterplot(X['annual_income'],X['spending_score'],\n               hue=X['Labels'], palette = sns.color_palette('hls',5))\nplt.show()","d3df4c17":"data not have missing value, and each column of data already has the appropriate type.\n\nwe will drop customerID dan gender column because we don't needed these for make cluster model.\n","17531178":"we have making cluster with K optimum is 5","5df38803":"based on graph, K optimum when K = 5, because after K=5, the line does not experience a significant decrease"}}