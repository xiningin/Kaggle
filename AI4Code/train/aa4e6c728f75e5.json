{"cell_type":{"d11074ee":"code","b970de28":"code","b83e49b4":"code","d5edbfab":"code","ee831214":"code","4e343381":"code","097b6f26":"code","d3ffd485":"code","a305c8b7":"code","885de422":"code","e174205c":"code","e3391d45":"code","3e5625db":"code","56529ef4":"code","adb56bf0":"code","f6625876":"code","c9b69a2c":"code","d500f1f9":"code","46e02dd6":"code","f654176f":"code","f019d3b7":"code","8eaf8912":"code","6034c0d6":"code","a734c0fa":"code","a0ba0379":"code","10be9bbc":"code","b116f32c":"code","44f3e3af":"code","95994101":"code","2c9f0804":"code","d4400c7c":"code","64962c04":"code","4568b6ee":"code","ccaefb09":"code","59d1adeb":"code","85af4472":"code","11637131":"code","b8b7b7bb":"code","939ebd14":"code","acb8f57e":"code","596785f0":"code","7e6ab303":"code","15c9d615":"code","466e728a":"code","a6a1aabf":"code","5c5209d1":"markdown","7513eef9":"markdown","4c3352b1":"markdown","2b9c642e":"markdown"},"source":{"d11074ee":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","b970de28":"df_train = pd.read_csv('\/kaggle\/input\/big-mart-sales-prediction\/Train.csv')\ndf_test = pd.read_csv('\/kaggle\/input\/big-mart-sales-prediction\/Test.csv')","b83e49b4":"#Tamanho das bases\ndf_train.shape, df_test.shape","d5edbfab":"df_train","ee831214":"#Valores nulos\ndf_train.isnull().sum()","4e343381":"#Valores nulos\ndf_test.isnull().sum()","097b6f26":"df = df_train.append(df_test)","d3ffd485":"'NULOS', df.isnull().sum(), 'NULOS PERCENTUAL', (df.isnull().sum()\/len(df['Item_Identifier']))*100","a305c8b7":"df['Outlet_Size'].value_counts(dropna=False)","885de422":"df[(df['Outlet_Size'].isnull())].pivot_table(index=['Outlet_Identifier','Outlet_Type','Outlet_Location_Type'],aggfunc=\"count\" ,values='Item_Identifier', dropna=True)","e174205c":"df.pivot_table(index=['Outlet_Size','Outlet_Identifier','Outlet_Type','Outlet_Location_Type'],aggfunc=\"count\" ,values='Item_Identifier', dropna=True)","e3391d45":"df[(df['Item_Weight'].isnull())]['Item_Weight'].value_counts(dropna=False)","3e5625db":"df[df['Item_Weight'].isnull()]['Item_Identifier']","56529ef4":"df[~df['Item_Weight'].isnull()].pivot_table(index='Item_Identifier',aggfunc=['count','min','max','mean'] ,values='Item_Weight', dropna=False)","adb56bf0":"df['Outlet_Size'].value_counts(dropna=False)","f6625876":"df['Outlet_Size'].fillna(value=\"Small\", inplace=True)","c9b69a2c":"df['Outlet_Size'].value_counts(dropna=False)","d500f1f9":"df['Item_Weight'].isnull().value_counts(dropna=False)","46e02dd6":"firstT=df[~df['Item_Weight'].isnull()].pivot_table(index='Item_Identifier', values='Item_Weight', aggfunc='mean')","f654176f":"secondT=firstT.to_dict()['Item_Weight']","f019d3b7":"df['Item_Weight']=df['Item_Identifier'].map(secondT)","8eaf8912":"df['Item_Weight'].isnull().value_counts(dropna=False)","6034c0d6":"df['Item_Fat_Content'].unique()","a734c0fa":"df['Item_Fat_Content'].value_counts()","a0ba0379":"itemContent={'Low Fat':1, 'Regular': 2, 'LF': 1, 'reg': 2, 'low fat':1}\n\ndf['Item_Fat_Content'] = df['Item_Fat_Content'].replace(itemContent).astype(int)\n\ndf['Item_Fat_Content'].value_counts()","10be9bbc":"df['Item_Type'].unique()","b116f32c":"df['Item_Type'].value_counts()","44f3e3af":"itemType={'Fruits and Vegetables': 1,'Snack Foods': 2,'Household': 3,'Frozen Foods':4,'Dairy':5,'Baking Goods':6,'Canned':7,'Health and Hygiene':8,'Meat':9,'Soft Drinks':10,'Breads':11,'Hard Drinks':12,'Others':13,'Starchy Foods':14,'Breakfast': 15,'Seafood':16}\n\ndf['Item_Type'] = df['Item_Type'].replace(itemType).astype(int)\n\ndf['Item_Type'].value_counts()","95994101":"df['Outlet_Size'].unique()","2c9f0804":"df['Outlet_Size'].value_counts()","d4400c7c":"outletSize={'Small':1,'Medium':2,'High':3}\n\ndf['Outlet_Size'] = df['Outlet_Size'].replace(outletSize).astype(int)\n\ndf['Outlet_Size'].value_counts()","64962c04":"df['Outlet_Location_Type'].unique()","4568b6ee":"df['Outlet_Location_Type'].value_counts()","ccaefb09":"outletSize={'Tier 3': 3,'Tier 2': 2,'Tier 1': 1}\n\ndf['Outlet_Location_Type'] = df['Outlet_Location_Type'].replace(outletSize).astype(int)\n\ndf['Outlet_Location_Type'].value_counts()","59d1adeb":"df['Outlet_Type'].unique()","85af4472":"df['Outlet_Type'].unique()","11637131":"outletSize={'Supermarket Type1':4, 'Grocery Store': 1, 'Supermarket Type3': 3, 'Supermarket Type2':2}\n\ndf['Outlet_Type'] = df['Outlet_Type'].replace(outletSize).astype(int)\n\ndf['Outlet_Type'].value_counts()","b8b7b7bb":"df.info()","939ebd14":"x=df[~df['Item_Outlet_Sales'].isnull()]\ny=df[df['Item_Outlet_Sales'].isnull()]","acb8f57e":"from sklearn.model_selection import train_test_split\ntrain, valid = train_test_split(x, test_size=0.25, random_state=42)","596785f0":"items=['Item_Weight', 'Item_Fat_Content', 'Item_Visibility','Item_MRP','Outlet_Establishment_Year', 'Outlet_Size', 'Outlet_Location_Type',\n       'Outlet_Type']\ntarget='Item_Outlet_Sales'","7e6ab303":"from sklearn.ensemble import RandomForestRegressor\nforest_reg = RandomForestRegressor(random_state=42, n_jobs=-1)\nforest_reg.fit(train[items], train[target])\npredrf = forest_reg.predict(valid[items])\npredrf[:5], valid['Item_Outlet_Sales'].head(5)","15c9d615":"from sklearn.metrics import mean_squared_error\ny_true = list(valid['Item_Outlet_Sales'])\ny_pred = list(predrf)\nmean_squared_error(y_true, y_pred, squared=False)\n\npredrfteste = forest_reg.predict(y[items])","466e728a":"y['Item_Outlet_Sales']=predrfteste\n\ny[['Item_Identifier','Outlet_Identifier','Item_Outlet_Sales']]","a6a1aabf":"y[['Item_Identifier','Outlet_Identifier','Item_Outlet_Sales']].to_csv('trab.csv', index=False)","5c5209d1":"# **RANDOM FOREST**","7513eef9":"# **Datasets**","4c3352b1":"# Imputando valores faltantes","2b9c642e":"# **Train e Test split**"}}