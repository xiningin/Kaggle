{"cell_type":{"e4027f72":"code","e2e881aa":"code","fd070083":"code","f6b71095":"code","d874f3cf":"code","1a77b6e8":"code","7611ed4f":"code","72a8352c":"code","7744f2e4":"code","36170594":"code","19a74695":"code","41b25576":"code","9ae96f10":"code","cff2211e":"code","2a09f833":"code","f551d578":"code","5f88e80f":"code","e78f795f":"markdown","80996719":"markdown","6acafeaf":"markdown"},"source":{"e4027f72":"from tensorflow import keras\nfrom tensorflow.keras import layers\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nfrom sklearn.metrics import mean_absolute_error\nfrom tensorflow.keras.callbacks import TensorBoard","e2e881aa":"train = pd.read_csv(\"..\/input\/ventilator-pressure-prediction\/train.csv\")\n","fd070083":"train = train.sample(frac =.01,random_state = 90, replace = False)\ntrain.shape","f6b71095":"train.head()","d874f3cf":"train.isnull().sum()","1a77b6e8":"train.info()","7611ed4f":"train.corr()","72a8352c":"sns.scatterplot(x=train[\"pressure\"],y=train['u_in'])","7744f2e4":"sns.histplot( x=train[\"u_in\"],binwidth=5 ,kde=True)","36170594":"train = train.drop(\"breath_id\",axis=1)","19a74695":"X = train.drop(\"pressure\",axis=1)\ny = train[\"pressure\"]","41b25576":"model = keras.Sequential([\n    layers.Dense(512, activation='relu', input_shape=[6]),\n    layers.Dense(512, activation='relu'),\n    layers.Dense(512, activation='selu'),\n    layers.Dense(1),\n])","9ae96f10":"model.compile(\n    optimizer='adam',\n    loss='mae',\n)","cff2211e":"history = model.fit(\n    X, y,\n    validation_data=(X, y),\n    batch_size=256,\n    epochs=10,\n)","2a09f833":"model.save(\"saved_model\")","f551d578":"loaded_model = keras.models.load_model(\".\/saved_model\")","5f88e80f":"preds = loaded_model.predict(X[:1000])\nmae = mean_absolute_error(y[:1000],preds)\nprint(mae)","e78f795f":"![image.png](attachment:793b3950-32b5-4b3e-80e7-769a9ee082ac.png)","80996719":"# Defining,Compiling,Saving,Loading and predicting from the model","6acafeaf":"# Intro\nSaving your pre trained model will save you a lot of time . So to show how this works I have made this notebook :"}}