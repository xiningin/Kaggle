{"cell_type":{"a05d59b9":"code","32e1297a":"code","4e43aa7c":"code","f47ab22a":"code","8807d60b":"code","04753eda":"code","aad1dfa7":"code","635964d3":"code","6e3f1127":"code","688bb8de":"code","bc05ddc6":"code","32da2ae6":"code","57079ec4":"code","47ef44c2":"code","94d93443":"code","03aa9db9":"code","fcd4bc04":"code","0932e628":"code","93452c17":"code","6e8b8537":"code","4e9055fe":"code","bc11df65":"code","d759aba9":"code","5e9d458e":"code","f6349a25":"code","d196aead":"code","b0346746":"code","5f1bb54a":"code","43677405":"code","604bbb00":"code","d334fc04":"code","6852d253":"code","dfe8bfab":"code","d48a2f5a":"code","5122491f":"code","ed6c816b":"code","b3c833ba":"code","bdd1434b":"code","d0f4cf13":"code","39c9e494":"markdown","2374d0bb":"markdown","bcd089bc":"markdown","c03165fd":"markdown","36ba5023":"markdown","9203237c":"markdown","0c5f8f39":"markdown","96d2624d":"markdown","ae41e163":"markdown","65e0c3b1":"markdown","a698b2e4":"markdown","13bd3b3a":"markdown","9f94f2fe":"markdown","d1dd3441":"markdown","523b4a4f":"markdown","a776991c":"markdown","2e7d7465":"markdown","fc4f8a24":"markdown","31de9dc2":"markdown","ff98f770":"markdown","13868df3":"markdown","52a3e679":"markdown","d30710a9":"markdown","52579cab":"markdown","66274911":"markdown","082be903":"markdown","23e8df6f":"markdown","38d244a1":"markdown","1fc6504b":"markdown","6fbffb8f":"markdown","074336fb":"markdown"},"source":{"a05d59b9":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib\nimport matplotlib.pyplot as plt\n%matplotlib inline","32e1297a":"happy_one_df = pd.read_csv('..\/input\/world-happiness\/2015.csv')\nhappy_two_df = pd.read_csv('..\/input\/world-happiness\/2019.csv')","4e43aa7c":"happy_one_df.head(5)","f47ab22a":"happy_two_df.head(5)","8807d60b":"print(happy_one_df.shape, happy_two_df.shape)","04753eda":"print('There are {} countries in the 2015 dataset and {} countries in the 2019 dataset'.format(happy_one_df.shape[0], happy_two_df.shape[0]))","aad1dfa7":"# Before we go ahead, let's check if any value in the dataframes are null\ntotal_missing_one = happy_one_df.isna().sum()\ntotal_missing_two = happy_two_df.isna().sum()\nprint(total_missing_one, total_missing_two)\n# We can see that there are no null values","635964d3":"print(happy_one_df.columns)\nprint(happy_two_df.columns)\nhappy_one_df.drop(columns = ['Standard Error', 'Dystopia Residual'], inplace = True)\nhappy_one_df.rename(columns = {'Economy (GDP per Capita)':'GDP per capita', 'Health (Life Expectancy)':'Healthy life expectancy', 'Family':'Social support', 'Trust (Government Corruption)':'Perceptions of corruption'}, inplace = True)\nhappy_two_df.rename(columns = {'Country or region':'Country', 'Score':'Happiness Score', 'Overall rank':'Happiness Rank', 'Freedom to make life choices':'Freedom'}, inplace = True)","6e3f1127":"common = happy_one_df.merge(happy_two_df, on=['Country'])\nresult1 = happy_one_df[~happy_one_df.Country.isin(common.Country)]\nresult2 = happy_two_df[~happy_two_df.Country.isin(common.Country)]\nprint(result1['Country'])\nprint(result2['Country'])","688bb8de":"happy_two_df['Country'].replace({'Trinidad & Tobago': 'Trinidad and Tobago'}, inplace = True)\nhappy_one_df['Country'].replace({'North Cyprus': 'Northern Cyprus', 'Somaliland region': 'Somalia', 'Macedonia':'North Macedonia', 'Sudan':'South Sudan'}, inplace = True)","bc05ddc6":"print(happy_one_df.Region.unique(), happy_one_df.Region.nunique())","32da2ae6":"selected_columns = happy_one_df[[\"Country\",\"Region\"]]\nnew_df = selected_columns.copy()\nnew_df","57079ec4":"common = happy_two_df.merge(new_df, on=['Country'])\nhappy_three_df = common.copy()\nselect_countries1 = happy_two_df.loc[happy_two_df['Country'] == 'Namibia']\nselect_countries1 = select_countries1.append(happy_two_df.loc[happy_two_df['Country'] == 'Gambia'])\nselect_countries1['Region'] = ['Sub-Saharan Africa', 'Sub-Saharan Africa']\nselect_countries1\nhappy_three_df = pd.concat([happy_three_df, select_countries1])\nhappy_three_df.sort_values('Happiness Score', ascending = False, inplace = True)\nhappy_three_df.index = np.arange(0, 156)\nhappy_three_df","47ef44c2":"happy_one_df.describe()","94d93443":"happy_three_df.describe()","03aa9db9":"# Setting some initial parameters for the charts\nsns.set_style('darkgrid')\nmatplotlib.rcParams['font.size'] = 14\nmatplotlib.rcParams['figure.figsize'] = (9, 5)\nmatplotlib.rcParams['figure.facecolor'] = '#00000000'","fcd4bc04":"# Find the correlation using .corr() and then remove unwanted columns and rows.\ncorr_df = happy_three_df.corr()\ncorr_df.drop(columns= ['Happiness Rank', 'Happiness Score'], inplace = True)\ncorr_df.drop(['Happiness Rank'], inplace = True)\ncorr_df","0932e628":"sns.heatmap(corr_df, annot=True)","93452c17":"happy_factor_columns = ['GDP per capita', 'Social support', 'Healthy life expectancy', 'Freedom', 'Generosity', 'Perceptions of corruption']\nmatplotlib.rcParams['font.size'] = 20\nfig, axes = plt.subplots(3, 2, figsize=(50, 50))\n\nk = 0\nfor i in range(3):\n    for j in range(2):\n        column_name = happy_factor_columns[k]\n        axes[i,j].set_title('Happiness Score vs. ' + column_name)\n        sns.scatterplot(happy_three_df[column_name], happy_three_df['Happiness Score'],\n                        hue=happy_three_df['Region'], s=500, ax=axes[i,j]);\n        k = k + 1\n        axes[i][j].legend(fontsize='20', markerscale=4)","6e8b8537":"print('There are {} different regions and they are {}'.format(happy_three_df.Region.nunique(), happy_three_df.Region.unique()))","4e9055fe":"# By grouping the Countries by regions, we can see the number of countries in all ten regions\ncountry_counts_df = happy_three_df.groupby('Region')[['Country']].count()\ncountry_counts_df","bc11df65":"region_happy_df = happy_three_df.groupby('Region')[['Happiness Score']].mean().sort_values('Happiness Score', ascending=False)\nregion_happy_df","d759aba9":"# Visualization using a barplot will make it easier to see the amount of difference between the average scores\nregion_happy_df.reset_index(inplace=True)\nsns.set_color_codes(\"pastel\")\nmatplotlib.rcParams['font.size'] = 10\nmatplotlib.rcParams['figure.figsize'] = (20, 6)\nsns.barplot(x=\"Region\", y=\"Happiness Score\", data=region_happy_df, color=\"b\")","5e9d458e":"print('From this we can see that based on average Happiness Scores, {} is the happiest Region and {} is the least happiest Region in the world'\n      .format(region_happy_df.iloc[0]['Region'], region_happy_df.iloc[-1]['Region']))","f6349a25":"# Sort the countries according to the Happiness Score (the initial dataframe is already sorted but we do this just in case and also we need to work on a copy)\ncountry_happy_df = happy_three_df.sort_values('Happiness Score', ascending=False)\ncountry_happy_df.head(5)","d196aead":"print('The most frequent region in the top ten countries is {}'.format(country_happy_df.head(10)['Region'].mode()[0]))\nprint('The most frequent region in the lowest ten countries is {}'.format(country_happy_df.tail(10)['Region'].mode()[0]))","b0346746":"matplotlib.rcParams['figure.figsize'] = (20, 5)\nmatplotlib.rcParams['font.size'] = 10\nsns.barplot('Region', 'Happiness Score', data=country_happy_df, ci='sd')","5f1bb54a":"print('The happiest country is {} and the least happiest country is {}.'\n      .format(country_happy_df.iloc[0]['Country'], country_happy_df.iloc[-1]['Country']))","43677405":"# We take the first and last row and put it in a new dataframe for easier analysis\ncompare_df = country_happy_df.tail(1).copy()\ncompare_df = pd.concat([compare_df, country_happy_df.head(1).copy()])\ncompare_df.reset_index(drop=True, inplace=True)\ncompare_df","604bbb00":"# We do the following for ease of comparison between the features for both Countries\nnew_compare_df = compare_df.melt(id_vars = ['Country'])\nnew_compare_df.drop([0, 1, 16, 17], inplace = True)\nnew_compare_df.reset_index(drop=True, inplace=True)\n# The Happiness Scores for the countries are normalized to values between 0 and 10 so that the other features are more\n# comparable in the following barplot\nnew_compare_df.at[0, 'value'] = new_compare_df.iloc[0]['value'] \/ 10\nnew_compare_df.at[1, 'value'] = new_compare_df.iloc[1]['value'] \/ 10\nnew_compare_df","d334fc04":"sns.barplot(x='variable', y='value', hue='Country', data=new_compare_df);","6852d253":"new_group_df = new_compare_df.groupby('variable')[['value']].diff().dropna()\nnew_group_df","dfe8bfab":"# Comparing 2015 and 2019\nmatplotlib.rcParams['figure.figsize'] = (10, 5)\nplt.title(\"Distribution of Happiness Scores in 2015 and 2019\")\nplt.xlabel('Happiness Score')\nplt.ylabel('Number of Countries')\nplt.hist(happy_one_df['Happiness Score'], alpha=0.4, bins=[2, 3, 4, 5, 6, 7, 8]);\nplt.hist(happy_three_df['Happiness Score'], alpha=0.4, bins=[2, 3, 4, 5, 6, 7, 8]);","d48a2f5a":"high_2019_df = (happy_three_df[happy_three_df['Happiness Score'] > 5])\nhigh_2019_percent = high_2019_df.shape[0] \/ happy_three_df.shape[0] * 100\n\nlow_2019_df = (happy_three_df[happy_three_df['Happiness Score'] <= 5])\nlow_2019_percent = low_2019_df.shape[0] \/ happy_three_df.shape[0] * 100\n\nhigh_2015_df = (happy_one_df[happy_one_df['Happiness Score'] > 5])\nhigh_2015_percent = high_2015_df.shape[0] \/ happy_one_df.shape[0] * 100\n\nlow_2015_df = (happy_one_df[happy_one_df['Happiness Score'] <= 5])\nlow_2015_percent = low_2015_df.shape[0] \/ happy_one_df.shape[0] * 100\n\nprint('Percent of countries in the higher score range in 2019: {} \\nPercent of countries in the lower score range in 2019: {} \\nPercent of countries in the higher score range in 2015: {} \\nPercent of countries in the lower score range in 2015: {}'\n     .format(high_2019_percent, low_2019_percent, high_2015_percent, low_2015_percent))","5122491f":"# Merge the two datasets on the column Country and then find the change in the Happiness Scores\nselected_columns = happy_one_df[[\"Country\",\"Happiness Score\"]]\nnew_df = selected_columns.copy()\nmerge_df = happy_three_df.merge(new_df, on=['Country'])\nmerge_df['Score Change'] = merge_df['Happiness Score_x'] - merge_df['Happiness Score_y']\nmerge_df.head(5)","ed6c816b":"merge_df['Score Change'].describe()","b3c833ba":"max_increase = merge_df['Score Change'].idxmax()\nmax_i_country = merge_df.loc[max_increase]['Country']\n\nmax_decrease = merge_df['Score Change'].idxmin()\nmax_d_country = merge_df.loc[max_decrease]['Country']\n\nprint('The country whose happiness increased the most is {}, and the country whose happiness decreased the most is {}.'\n     .format(max_i_country, max_d_country))","bdd1434b":"increase_df_2019 = happy_three_df.loc[happy_three_df['Country'] == max_i_country]\nincrease_df_2015 = happy_one_df.loc[happy_one_df['Country'] == max_i_country]\nincrease_df_2019 = pd.concat([increase_df_2019, increase_df_2015])\nincrease_df_2019","d0f4cf13":"decrease_df_2019 = happy_three_df.loc[happy_three_df['Country'] == max_d_country]\ndecrease_df_2015 = happy_one_df.loc[happy_one_df['Country'] == max_d_country]\ndecrease_df_2019 = pd.concat([decrease_df_2019, decrease_df_2015])\ndecrease_df_2019","39c9e494":"In order to look at this, first let us look at the number of different regions and also how many countries there are in each region.","2374d0bb":"The first row is from the 2019 dataset and the second row is from the 2015 dataset.\n\nAs we can see for Berlin, except Freedom and Generosity, All the other factors have increased by significant amounts. This lead to a change of more than 1.5 in the Happiness Score and also increased the Happiness Rank for the country.","bcd089bc":"## Which country's happiness increased the most and which one's decreased the most?\nSince 2015, the Happiness Scores for the countries have changed due to change in the happiness factors. They may have increased or decreased. Here, we will look at the country whose happiness has increased the most and the country whose happiness has decreased the most.","c03165fd":"Hence, Benin is the country with the maximum increase in happiness and Venezuela is the country with the maximum decrease in happiness. Let us look ath their respective rows in the datasets and see why this has happened.","36ba5023":"Looking at this, we can see that:\n- Western Europe has a high standard deviation for the Happiness Score since the 21 countries in it have Happiness Scores that vary greatly from the average for the Region.\n- So, even though the most frequent region in the top happiest countries was Western Europe, due to the countries in that Region that have lower Scores, the average Happiness Score for that region is lower than Australia and New Zealand.\n- The standard deviation line is small for Australia and New Zealand region since this only includes two countries with almost similar Scores.","9203237c":"## How does each life factor affect the Happiness Score?\n\nIn order to analyse this, we find the correlation between the Happiness Score and each factor since higher the correlation, the more it affects the Score. We shall also see if there is any correlation between two factors.","0c5f8f39":"Let us also take a look at how the value for each factor affects the Happiness Score for each country. This is done using a scatterplot with each factor as the x axis and the Happiness Score as the y axis. The countries are colored according to their Region.","96d2624d":"Now that the datasets have been prepared, lets take a look at the feautures of each column such as mean, minimum and maximum value using `.describe()`.\n\nAs we can see below:\n- The mean Happiness Score in 2015 is around 5.376 and in 2019 it is around 5.407. This shows that the mean global Happiness Score has increased since 2015.\n- This could be due to the increase in the mean of some of the factors such as GDP per capita and Healthy life expectancy. However, a large increase would've been hindered by factors whose averages have decreased such as Freedom and Generosity.\n- It is quite alarming to see that the maximum value for Generosity has dropped by a significant amount from 2015 to 2019. However, there is a significant increase in the maximum values of Social support and Healthy life expectancy.\n- All the feautures have a minimum value of zero. This is either because the feature could not be calculated for that year or that specific feauture has been rated so poorly in the respective country.","ae41e163":"The datasets have different column names for the same features. This will be changed and also the columns that are not needed from the 2015 dataset will be removed.","65e0c3b1":"## How has happiness changed since 2015?\nWe will now compare the happiness in 2019 to the data from 2015 to see if there is any change.\n\nFirst, we will make overlapping histograms of the Happiness Scores for both years for better comparison.","a698b2e4":"### First look\nNow, let us take a look at the datasets by displaying five rows from each. As we can see, each Country and their Happiness Score and Rank are given along with the values for each feauture.","13bd3b3a":"Let us look at the most frequent Region in the top ten countries and the most frequent Region in the lowest ten countries.","9f94f2fe":"As we can see for Venezuela, except Social support, Healthy life expectancy and Generosity, all the other factors have decreased. These factors that have increased have only done so by a small amount. Hence, this has lead to an overall decrease in the Happiness Score by more than 2.1 and also greatly decreased the Happiness Rank of the country.\n\nA very significant decerase that can be seen here is the huge decrease in freedom.","d1dd3441":"To see the countries that are only there in one dataset and not the other, we take intersection of the datasets and then find the complement. When doing this we see that some of the countries are actually the same but have just been named differently. For consistency, we will rename these countries.","523b4a4f":"## How is the happiest country different from the least happiest country?\nLet us find and analyse the difference between the happiest country and least happiest country.\n\nTo do this, we take the first and last rows of the sorted dataset. Then we compare the Happiness Score and the value for each factor.","a776991c":"The following barplot shows the values for the normalized Happiness Score and the valuse of each happiness factor. The value for each country has been placed side by side for comparison. The table following the graph shows the numerical values depicting the difference between each value.","2e7d7465":"Now let's take a deeper look into the Happiness Report data and attempt to answer some questions\n- First we will look at the data from 2019 and understand the correlation between the Happiness Score and the features used to calculate it.\n- Then we will look at Region-wise scores and analyse the difference.\n- After that, we will look at the happiest and least happiest countries.\n- Then we will compare the 2019 data with the 2015 data  and see how much it has changed.","fc4f8a24":"We can see that the most frequent region in the 10 least happiest countries is the same as the least happiest region based on average Happiness Scores. However, this is not the same for the top 10 happiest countries. It is Western Europe instead of Australia and New Zealand. Why does this happen?\n\nLet us plot the Happiness Scores on a barplot along with the standard deviations for each Region.","31de9dc2":"Hence, we can see that the percentage of countries in the higher Happiness Score range has increased in 2019 as compared to 2015 by more than 3%. This supports the positive shift in Happiness Scores that we saw earlier from the histogram.","ff98f770":"## Which Region of the world is happiest and which is the least happiest?","13868df3":"## Data Preparation and Cleaning\n### Importing important libraries and Loading the datasets\nBefore we start, we need to import all the important libraries that are needed for the analysis.\nWe load the datasets into dataframes using Pandas. `happy_one_df` will contain the data for 2015 and `happy_two_df` will contain the data for 2019.","52a3e679":"From this, we can infer the following:\n\n- The Happiness Score depends the most on GDP per capita, Social support and Healthy life expectancy.\n- The Score is least dependent on Generosity and Perceptions of corruption.\n- Generosity has a larger correlation with Perceptions of corruption and Freedom than the overall Score.\n- The three main influencing factors of the Score, namely GDP per capita, Social support and Healthy life expectancy, are highly correlated with each other.\n- Freedom has a good correlation with the Happiness Score since it is understandable to think that a higher level of perceived freedom would make a person more happy.\n- Freedom is also related with Perceptions of corruption. A place that a person feels has less corruption would definitely make the person feel like they have more freedom to act as they wish.\n\nHence we can see that the Happiness Score is influenced to different degrees by each factor. We can also see that each factor also has a correlation with other factors.","d30710a9":"## Is the most frequent Region in the top ten countries the same as the happiest Region?\n- Is the most frequent Region in the lowest ten countries the same as the least happiest Region?\n- If they are different, what causes this?","52579cab":"## Exploratory Analysis, Visualization and Answering Questions","66274911":"Looking at the above description of the Score Change column, we can see that the average change in the Happiness Score is a small positive amount.\n\nWe can also see that there is a country that has had the maximum increase in happiness (given by max) and a country with maximum decrease in happiness (given by min). Let us find these countries and see why this has happened.","082be903":"As we can see:\n- In most of the graphs, as the value for the life factor increases, so does the Happiness Score.\n- In all graphs, the highest Score regions tend to be Western Europe, Australia and New Zealand and North America. From these graphs we can see that these 'happiest' regions tend to have a higher value for each life factor.\n- Except Generosity and Perceptions of corruption (the factors having least correlation with the Score), the other factors have almost a linear and directly proportional relationship with the Happiness Score.","23e8df6f":"# World Happiness Analysis\n\n### World Happiness Report\n\nThe World Happiness Report is published annually by the United Nations and ranks countries by how happy their citizens assess themselves to be. The rankings are based on a few important life factors that have been shown to directly impact overall perceived happiness, namely:\n- GDP per capita\n- Social support\n- Healthy life expectancy\n- Freedom\n- Generosity\n- Perceptions of corruption\n\nEach factor is a number between 0 (being the worst) and 10 or 1  (being the best) depending on the factor. Based on these factors, the overall Happiness Score of the country is calculated. Then based on these scores, the countries are ranked in order of their Happiness.\n\nIn this, I will be analysing the World Happiness Report dataset for the year 2019, and then comparing it to the data from 2015 to see what has changed.\n\nDatasets used:\n- [Kaggle - World Happiness Report](https:\/\/www.kaggle.com\/unsdsn\/world-happiness\/)","38d244a1":"From this distribution of Happiness, where blue depicts 2015 and orange depicts 2019, we can see that there has been a positive shift in the happiness scores. There are more scores in the higher score range (score > 5) and less scores in the lower score range (score <= 5).\n\nTo better understand this, let us look at the percentage of happiness scores in the lower and higher range in both years.","1fc6504b":"For region-wise Happiness Score comparison, we need a Region column in the 2019 dataset.\n\nFirst let's look at the number of unique Regions. As we can see, there are 10 different Regions that the countries are classified into.\n\nFor adding the Region column, we will take the countries and regions there in the 2015 dataset and find the intersection with the 2019 dataset. However, there are some countries that are not there in 2015. These will need their Region to be explicitly given (Namibia and Gambia).","6fbffb8f":"From above, it can be seen that:\n- The Happiness Score for Finland is much greater than South Sudan by a value of almost 5.\n- Except for Generosity, the other happiness factors for Finland have higher values than that of South Sudan. Such higher values are what consequently made the Happiness Score of Finland so much higher.\n- Although Genorosity in Finland is lower than that in the least happiest country, this did not affect the Happiness Score that much because as we saw earlier, there was low correlation between Generosity and the overall Happiness Score for a country.\n\nHence, we can see that the difference between the happiest country and least happiest country is that the happiest country has higher values for most of the happiness factors.","074336fb":"Now, we can look at the average Happiness Score in each region"}}