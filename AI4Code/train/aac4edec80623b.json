{"cell_type":{"c7d7bb12":"code","c909d8ae":"code","8e1a0ec1":"code","7b3118fc":"code","3364db1e":"code","b02c863b":"code","82f6d25b":"code","d5e85a47":"code","68077442":"code","b351bd2c":"code","061e22f9":"code","21776165":"code","e005d26c":"code","a35b53e7":"markdown"},"source":{"c7d7bb12":"# import library and data\nimport pandas as pd\nimport numpy as np\n\ndf = pd.read_csv('..\/input\/bigdatacertificationkr\/basic2.csv', engine='python')\ndf.head()","c909d8ae":"# convert type of the 'Date' column\ndf['Date'] = pd.to_datetime(df['Date'])\ndf.info()","8e1a0ec1":"# event column\uc5d0 \ub300\ud574\uc11c, \uc870\uac74\uc5d0 \ub530\ub77c\uc11c \ud560\uc778\uc728\uc744 mapping\ud558\ub294 \ud568\uc218\ndef to_80(x):\n    if x == 1:\n        return 0.8\n    else:\n        return 1\n\n# \uc870\uac74\uc744 \ubc18\uc601\ud574 \uc6d4\ubcc4\ub85c groupby\ud55c \ub4a4 \uac00\uc7a5 \ud070 \uae08\uc561\uc744 \ub3c4\ucd9c\ud558\ub294 \ud568\uc218\ndef max_sales(df, year):\n    # \uc870\uac74\uc5d0 \ud574\ub2f9\ud558\ub294 \ubd80\ubd84\n    df['discount'] = df['Events'].map(to_80)\n    df['new_sales'] = df['Sales'] * df['discount']\n    \n    # \uc5f0\ub3c4\uc5d0 \ub530\ub77c\uc11c filtering\ud55c \ub4a4, \uc6d4\ubcc4\ub85c group sum\uc744 \uad6c\ud568\n    df['year'] = df['Date'].dt.year\n    df['month'] = df['Date'].dt.month\n    filtered = df[df['year'] == year]\n    groupsum = filtered[['month', 'new_sales']].groupby(by='month').sum()\n    \n    # \ucd5c\ub313\uac12 \ubc18\ud658\n    max_sum = groupsum['new_sales'].max()\n    \n    return max_sum","7b3118fc":"max_22 = max_sales(df, 2022)\nmax_23 = max_sales(df, 2023)\n\nprint(max_22)\nprint(max_23)","3364db1e":"print(int(round(abs(max_22 - max_23), 0)))","b02c863b":"# \ub77c\uc774\ube0c\ub7ec\ub9ac \ubd88\ub7ec\uc624\uae30\nimport pandas as pd","82f6d25b":"# \ub370\uc774\ud130 \ubd88\ub7ec\uc624\uae30 (datatime\uceec\ub7fc \uc9c0\uc815)\ndf = pd.read_csv(\"..\/input\/bigdatacertificationkr\/basic2.csv\", \n                 parse_dates=['Date'])","d5e85a47":"df.head()","68077442":"# \ub0a0\uc9dc \uceec\ub7fc \uc0dd\uc131\ndf['year'] = df['Date'].dt.year\ndf['month'] = df['Date'].dt.month\ndf['day'] = df['Date'].dt.day\ndf['dayofweek'] = df['Date'].dt.dayofweek","b351bd2c":"# \uc774\ubca4\ud2b8\uac00 1\uc778 sales\uac12\uc740 80%\ub9cc \ubc18\uc601\n\ndef event_sales(x):\n    if x['Events'] == 1:\n        x['Sales2'] = x['Sales']*0.8\n    else:\n        x['Sales2'] = x['Sales']\n    return x\n\n\ndf = df.apply(lambda x: event_sales(x), axis=1) #1\uc77c \uacbd\uc6b0 row, 0\uc77c \uacbd\uc6b0 \uceec\ub7fc\ndf.head()","061e22f9":"# 2022\ub144 \uc6d4\ubcc4 \ud569\uacc4 \uc911 \uac00\uc7a5 \ud070 \uac12\ncond = df['year'] == 2022\ndf1 = df[cond]\nsale1 = df1.groupby('month')['Sales2'].sum().max()\nsale1\n\ndf1.groupby('month')['Sales2'].sum()","21776165":"# 2023\ub144 \uc6d4\ubcc4 \ud569\uacc4 \uc911 \uac00\uc7a5 \ud070 \uac12\ncond = df['year'] == 2023\ndf2 = df[cond]\nsale2 = df2.groupby('month')['Sales2'].sum().max()\nsale2","e005d26c":"# \uacb0\uacfc\uac12 \ubc18\uc62c\ub9bc \ud6c4 \uc815\uc218 \ucd9c\ub825\nint(round(abs(sale1 - sale2),0))","a35b53e7":"### \uc8fc\uc5b4\uc9c4 \ub370\uc774\ud130\uc5d0\uc11c 2022\ub144 \uc6d4\ubcc4 Sales \ud569\uacc4 \uc911 \uac00\uc7a5 \ud070 \uae08\uc561\uacfc \n### 2023\ub144 \uc6d4\ubcc4 Sales \ud569\uacc4 \uc911 \uac00\uc7a5 \ud070 \uae08\uc561\uc758 \ucc28\uc774\ub97c \uc808\ub300\uac12\uc73c\ub85c \uad6c\ud558\uc2dc\uc624. \n### \ub2e8 Events\uceec\ub7fc\uc774 '1'\uc778\uacbd\uc6b0 80%\uc758 Salse\uac12\ub9cc \ubc18\uc601\ud568 \n### (\ucd5c\uc885\uac12\uc740 \uc18c\uc218\uc810 \ubc18\uc62c\ub9bc \ud6c4 \uc815\uc218 \ucd9c\ub825)\n- \ub370\uc774\ud130\uc14b : basic2.csv\n- \uc624\ub978\ucabd \uc0c1\ub2e8 copy&edit \ud074\ub9ad -> \uc608\uc0c1\ubb38\uc81c \ud480\uc774 \uc2dc\uc791"}}