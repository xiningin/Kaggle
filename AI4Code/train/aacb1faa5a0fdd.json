{"cell_type":{"c4423f02":"code","645de39d":"code","31727bf6":"code","37b55f47":"code","5bf697ed":"code","db9fe188":"code","5555dad9":"code","db854d01":"code","a056c5e2":"code","7d40e033":"code","67a8aaa8":"code","db88efba":"code","144b83b8":"code","00fbd13c":"code","733f56ee":"code","4c9f8720":"markdown","e10ad13c":"markdown","3f4d4c26":"markdown","2bf461cb":"markdown","eefcff0c":"markdown","cb32e833":"markdown","6c24c08c":"markdown","b9ee1cd8":"markdown","3b398d71":"markdown","bb68d908":"markdown","861d7bf3":"markdown","01540f3f":"markdown","33d0cb72":"markdown","8f2c1cfc":"markdown","fa86c92b":"markdown"},"source":{"c4423f02":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom scipy import stats\nfrom sklearn.ensemble import RandomForestRegressor","645de39d":"train = pd.read_csv('..\/input\/tabular-playground-series-jul-2021\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-jul-2021\/test.csv')\nsample_submission = pd.read_csv('..\/input\/tabular-playground-series-jul-2021\/sample_submission.csv')","31727bf6":"train.head()","37b55f47":"train.info()","5bf697ed":"train.describe()","db9fe188":"carbon_monoxide = train['target_carbon_monoxide']\nbenzene = train['target_benzene']\nnitrogen_oxides = train['target_nitrogen_oxides']","5555dad9":"f = plt.figure(figsize=(15,8))\n\nax = f.add_subplot(131)\nstats.probplot(carbon_monoxide, plot=ax)\nax.set_title('Carbon monoxide probability distribution')\n\nax1 = f.add_subplot(132)\nstats.probplot(benzene, plot=ax1)\nax1.set_title('Benzene probability distribution')\n\nax2 = f.add_subplot(133)\nstats.probplot(nitrogen_oxides, plot=ax2)\nax2.set_title('Nitrogen_oxides probability distribution')\n\nplt.show()","db854d01":"targets = train[['target_carbon_monoxide', 'target_benzene', 'target_nitrogen_oxides']].copy()","a056c5e2":"pd.plotting.scatter_matrix(targets, alpha=0.5,figsize=(15, 8))\nplt.show()","7d40e033":"train['date_time'] = train['date_time'].astype('datetime64[ns]').astype(np.int64)\/10**9\ntest['date_time'] = test['date_time'].astype('datetime64[ns]').astype(np.int64)\/10**9","67a8aaa8":"train.head()","db88efba":"carbon_monoxide = carbon_monoxide.values.reshape(-1, 1)\nbenzene = benzene.values.reshape(-1,1)\nnitrogen_oxides = nitrogen_oxides.values.reshape(-1,1)","144b83b8":"X_train = train.drop(['target_carbon_monoxide', 'target_benzene', 'target_nitrogen_oxides'], axis=1).copy()","00fbd13c":"rf_model = RandomForestRegressor(max_depth=100, max_features='sqrt', min_samples_leaf=3,\n                           min_samples_split=12, n_estimators=600,bootstrap=True,random_state=1)\nrf_model.fit(X_train, carbon_monoxide)\nsample_submission['target_carbon_monoxide'] = rf_model.predict(test)\n\nrf_model = RandomForestRegressor(max_depth=8, max_features='auto', min_samples_leaf=1,\n                           min_samples_split=6, n_estimators=1600,bootstrap=True,random_state=1)\nrf_model.fit(X_train, benzene)\nsample_submission['target_benzene'] = rf_model.predict(test)\n\nrf_model = RandomForestRegressor(max_depth=40, max_features='sqrt', min_samples_leaf=5,\n                           min_samples_split=10, n_estimators=800,bootstrap=True,random_state=1)\nrf_model.fit(X_train, nitrogen_oxides)\nsample_submission['target_nitrogen_oxides'] = rf_model.predict(test)","733f56ee":"sample_submission.to_csv('submission.csv', index=False)","4c9f8720":"***","e10ad13c":"#### looking at the statistics","3f4d4c26":"#### Scatter matrix","2bf461cb":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 10px;\n              color:white;\n          text-align:center;\">\nModel\n             \n<\/p>\n<\/div>","eefcff0c":"#### **NOTES**\n\n- There no missing values\n- There are NO negative observations\n- Feature scaling may be required","cb32e833":"we need to convert date_time column to int","6c24c08c":"##### Preprocessing","b9ee1cd8":"#### **NOTES**\n\n- All the distributions are tail heavy(Right skewed).\n- There is a STRONG CORRELATION among target variables\n- We can see the OFFSET line in the 'benzene' feature, which we have seen in probability plot. we need to UNDER SAMPLE this data points\/remove those to minimize the effect.","3b398d71":"#### Loading dataset","bb68d908":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 10px;\n              color:white;\n          text-align:center;\">\nEDA\n             \n<\/p>\n<\/div>","861d7bf3":"Hello kagglers,\n\nThis is the first TPS with time series data. I will be updating this notebook as competition progresses.","01540f3f":"Let's visualize the dataset to better understand it.","33d0cb72":"#### **NOTES**\n\n- The target values are NOT Gaussian distributed as the red line does't overlap with the blue points.\n- There are EXTREME target observations(Outliers) in the data set.\n- There is an OFFSET at 0 for 'benzene' plot.","8f2c1cfc":"# **TPS July 2021** \u2668","fa86c92b":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 10px;\n              color:white;\n          text-align:center;\">\nLoading requirements\n             \n<\/p>\n<\/div>"}}