{"cell_type":{"3e5018a1":"code","8caefad3":"code","e4890336":"code","072a22d5":"code","e36e6f10":"code","f29e67c0":"code","ccb962a0":"code","717ed3b3":"code","72bd22e0":"code","19f8ac1a":"code","b5df583a":"code","b588a6a4":"code","5669aa44":"code","03cbd35a":"code","62ab8ebe":"code","790dac3f":"code","4302d5a6":"code","a65bc522":"code","1123aa68":"code","6e3a1d51":"code","9d75aa58":"code","fd562040":"code","a3a7f48e":"code","8b2d5eb8":"code","602ebc42":"code","ea870948":"code","ee58d602":"code","d3b80518":"code","11886316":"code","041bb8ef":"code","23a05746":"code","ae92b5ec":"code","c6a9263a":"code","f2fe6129":"code","e82d1abf":"code","60e23d22":"code","20ce2c71":"code","b0c005a7":"code","84f2ddb6":"code","959f8932":"code","8153748d":"code","5ffc9d8b":"code","ea53c2e2":"code","479bb4ed":"code","71f12993":"code","c951cee5":"code","1270aab9":"code","8536924a":"code","7ba7bd68":"code","d7afce6e":"code","0537fb1e":"code","077ebba5":"code","fa9fd5a7":"markdown","17b63c2f":"markdown","e68a9ccf":"markdown","f924553f":"markdown","7e68299c":"markdown","898cdc8a":"markdown","8c31f692":"markdown","da6d506e":"markdown","dad1bad2":"markdown","02c3711e":"markdown","cec7ab17":"markdown"},"source":{"3e5018a1":"from google.cloud import bigquery\nfrom google.cloud.bigquery import magics\nfrom kaggle.gcp import KaggleKernelCredentials\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport math\n%matplotlib inline\n\nfrom bokeh.plotting import figure, show, output_notebook\nfrom bokeh.tile_providers import get_provider, Vendors\nfrom bokeh.models import ColumnDataSource, HoverTool, CDSView, GroupFilter\nfrom bokeh.models.annotations import Title\nfrom bokeh.models.widgets import Tabs, Panel\n\n#For inline plotting of bokeh plots\noutput_notebook()","8caefad3":"PROJECT_ID = 'bigquery-geotab-competition'\nclient = bigquery.Client(project=PROJECT_ID, location=\"US\")\ndataset = client.create_dataset('bqml_example', exists_ok=True)\n\nmagics.context.credentials = KaggleKernelCredentials()\nmagics.context.project = PROJECT_ID\n\n# create a reference to our table\ntable = client.get_table(\"kaggle-competition-datasets.geotab_intersection_congestion.train\")\n\n# look at five rows from our dataset\nclient.list_rows(table, max_results=5).to_dataframe()","e4890336":"table.schema","072a22d5":"%load_ext google.cloud.bigquery","e36e6f10":"%%bigquery int_counts\nSELECT\n    City,\n    count(IntersectionId) as Intersections\nFROM (\n    SELECT DISTINCT\n        City,\n        IntersectionId\n    FROM `kaggle-competition-datasets.geotab_intersection_congestion.train`\n    )\nGROUP BY City\nORDER BY Intersections","f29e67c0":"sns.barplot(x='City', y='Intersections', data=int_counts)\nplt.show()","ccb962a0":"%%bigquery intersections_map\nSELECT\n    City,\n    IntersectionId,\n    Latitude,\n    Longitude,\n    avg(TotalTimeStopped_p80) as AverageTimeSpent\nFROM `kaggle-competition-datasets.geotab_intersection_congestion.train`\nGROUP BY City, IntersectionId, Latitude, Longitude\nORDER BY City ASC","717ed3b3":"%%bigquery intersection_details\nSELECT\n    City,\n    IntersectionId,\n    EntryStreetName,\n    ExitStreetName,\n    EntryHeading,\n    ExitHeading,\n    Path\nFROM `kaggle-competition-datasets.geotab_intersection_congestion.train`\nORDER BY CITY ASC","72bd22e0":"#Converting the co-ordinates to something that bokeh likes\ndef merc(Coords):\n    lat = Coords[0]\n    lon = Coords[1]\n    \n    r_major = 6378137.000\n    x = r_major * math.radians(lon)\n    scale = x\/lon\n    y = 180.0\/math.pi * math.log(math.tan(math.pi\/4.0 + \n        lat * (math.pi\/180.0)\/2.0)) * scale\n    return (x, y)","19f8ac1a":"intersections_map['Location'] = tuple(zip(intersections_map['Latitude'], intersections_map['Longitude']))\nintersections_map['coords_x'] = intersections_map['Location'].apply(lambda x: merc(x)[0])\nintersections_map['coords_y'] = intersections_map['Location'].apply(lambda x: merc(x)[1])\nintersections_map.head()","b5df583a":"merged_df = pd.merge(intersections_map,intersection_details, how='inner', on=['City', 'IntersectionId'])\nmerged_df.head()","b588a6a4":"merged_df.drop_duplicates(subset=['City','IntersectionId'], keep='first', inplace=True)","5669aa44":"def build_city_int_map(city, colour):\n    title_provider = get_provider(Vendors.CARTODBPOSITRON)\n\n    data_map = merged_df[merged_df['City']== city]\n\n    source = ColumnDataSource(data=dict(\n                            x=list(data_map['coords_x']), \n                            y=list(data_map['coords_y']),\n                            AvgWaitTime=list(data_map['AverageTimeSpent']),\n                            sizes=list(data_map['AverageTimeSpent']\/5),                                               \n                            intersection=list(data_map['Path'])))\n\n    hover = HoverTool(tooltips=[\n        (\"Wait Time\",\"@AvgWaitTime\"),\n        (\"Intersection\",\"@intersection\")\n    ])\n\n    p = figure(x_axis_type=\"mercator\", y_axis_type=\"mercator\",\n           tools=[hover, 'wheel_zoom','save','pan','box_zoom','reset'])\n\n    p.add_tile(title_provider)\n\n    p.circle(x = 'x',\n             y = 'y',\n             source=source,\n             size = 'sizes',\n             line_color=colour, \n             fill_color=colour,\n             fill_alpha=0.15)\n    t = Title()\n    t.text = city + ' Intersections with Average wait times'\n    p.title = t\n    return(p)","03cbd35a":"#Retrieve the plots for all the cities\nat_map = build_city_int_map('Atlanta','green')\nbo_map = build_city_int_map('Boston', 'orange')\nch_map = build_city_int_map('Chicago', 'red')\nph_map = build_city_int_map('Philadelphia', 'blue')\n\n#Set the plot width\nat_map.plot_width = bo_map.plot_width = ch_map.plot_width = ph_map.plot_width = 800\n\n#Create 4 panels, one for each city\nat_panel = Panel(child=at_map, title='Atlanta')\nbo_panel = Panel(child=bo_map, title='Boston')\nch_panel = Panel(child=ch_map, title='Chicago')\nph_panel = Panel(child=ph_map, title='Philadelphia')\n\n# Assign the panels to Tabs\ntabs = Tabs(tabs=[at_panel, bo_panel, ch_panel, ph_panel])\n\nshow(tabs)","62ab8ebe":"#Top most conjusted intersections for each city\ncities = ['Atlanta', 'Boston', 'Chicago', 'Philadelphia']\nlat_long_df = pd.DataFrame(columns=['Latitude','Longitude'])\nfor city in cities:\n    lat_long_df =  lat_long_df.append(intersections_map[intersections_map['City']==city]\\\n                            .nlargest(1, 'AverageTimeSpent', keep='first')\\\n                            .loc[:,['Latitude','Longitude']], ignore_index=True, sort=False)\nLatitudes = tuple(lat_long_df['Latitude'])\nLongitudes = tuple(lat_long_df['Longitude'])","790dac3f":"%%bigquery top_ints\nSELECT * FROM `kaggle-competition-datasets.geotab_intersection_congestion.train`\n    WHERE Latitude IN (33.77384, 42.27153, 41.91044, 39.9773) \n    AND Longitude IN (-84.34896, -71.17265, -87.67753, -75.22695)","4302d5a6":"#Get Monthly Distribution of measures for the most conjusted intersections\ntop_monthly = top_ints.groupby(['City','Month','Path','EntryStreetName','ExitStreetName','EntryHeading','ExitHeading'])\\\n                .mean()\\\n                .loc[:,'TotalTimeStopped_p20':'DistanceToFirstStop_p80']\\\n                .sort_values(['City','Month'])\\\n                .reset_index()","a65bc522":"#Get the Hourly Distribution of measures for the most conjusted intersections\ntop_hourly = top_ints.groupby(['City','Hour','Weekend','Path','EntryStreetName','ExitStreetName','EntryHeading','ExitHeading'])\\\n                .mean()\\\n                .loc[:,'TotalTimeStopped_p20':'DistanceToFirstStop_p80']\\\n                .sort_values(['City','Hour','Weekend'])\\\n                .reset_index()","1123aa68":"def create_feature_dist(source_df, feature, percentile, monthly):\n    #CDS Source\n    source = ColumnDataSource(source_df)\n    #Group Filters\n    at_filters = [GroupFilter(column_name='City', group='Atlanta')]\n    bo_filters = [GroupFilter(column_name='City', group='Boston')]\n    ch_filters = [GroupFilter(column_name='City', group='Chicago')]\n    ph_filters = [GroupFilter(column_name='City', group='Philadelphia')]\n    #CDS Views\n    at_view = CDSView(source=source, filters=at_filters)\n    bo_view = CDSView(source=source, filters=bo_filters)\n    ch_view = CDSView(source=source, filters=ch_filters)\n    ph_view = CDSView(source=source, filters=ph_filters)\n\n    hover = HoverTool(tooltips=[\n            (\"Entry Heading\",\"@EntryHeading\"),\n            (\"Exit Heading\",\"@ExitHeading\"),\n            (\"Entry Street\",\"@EntryStreetName\"),\n            (\"Exit Street\", \"@ExitStreetName\"),\n            (\"Value\", \"@\"+feature+'_p'+str(percentile))\n    ])\n\n    select_tools=[hover,'box_select', 'lasso_select', 'poly_select', 'tap', 'reset']\n    \n    if monthly:\n        x_axis_label = 'Months'\n        x = 'Month'\n        plot_title = 'Monthly Distribution of '+feature+'_p'+str(percentile)\n    else:\n        x_axis_label = 'Hours'\n        x = 'Hour'\n        plot_title = 'Hourly Distribution of '+feature+'_p'+str(percentile)\n\n    common_fig_kwargs = {\n        'x_axis_label': x_axis_label,\n        'y_axis_label': feature+'_p'+str(percentile),\n        #'toolbar_location': 'below',\n        'tools': select_tools\n    }\n\n    common_marker_kwargs = {\n        'x': x,\n        'y': feature+'_p'+str(percentile),\n        'source': source,\n        'size': 10,\n        'nonselection_color': 'lightgray',\n        'nonselection_alpha': 0.3,\n        'fill_alpha': 0.15\n    }\n\n    common_at_kwargs = {\n        'view': at_view,\n        'color': 'blue',\n        'legend': 'Atlanta'\n    }\n\n    common_bo_kwargs = {\n        'view': bo_view,\n        'color': 'orange',\n        'legend': 'Boston'\n    }\n\n    common_ch_kwargs = {\n        'view': ch_view,\n        'color': 'red',\n        'legend': 'Chicago'\n    }\n\n    common_ph_kwargs = {\n        'view': ph_view,\n        'color': 'green',\n        'legend': 'Philadelphia'\n    }\n\n    fig = figure(**common_fig_kwargs, title=plot_title)\n    fig.square(**common_marker_kwargs, **common_at_kwargs, muted_alpha=0.1)\n    fig.circle(**common_marker_kwargs, **common_bo_kwargs, muted_alpha=0.1)\n    fig.triangle(**common_marker_kwargs, **common_ch_kwargs, muted_alpha=0.1)\n    fig.diamond(**common_marker_kwargs, **common_ph_kwargs, muted_alpha=0.1)\n    fig.legend.click_policy = 'mute'\n    fig.legend.location = 'top_left'\n    return fig","6e3a1d51":"def create_feature_grid(feature, percs, monthly=True):\n    tbs=[]\n    if monthly:\n        source_df=top_monthly\n    else:\n        source_df=top_hourly\n    for perc in percs:\n        tbs.append(Panel(child=create_feature_dist(source_df, feature, perc, monthly), title='p'+str(perc)))\n    return Tabs(tabs=tbs)","9d75aa58":"show(create_feature_grid('TotalTimeStopped',(20,40,50,60,80)))","fd562040":"show(create_feature_grid('TimeFromFirstStop',(20,40,50,60,80)))","a3a7f48e":"show(create_feature_grid('DistanceToFirstStop',(20,40,50,60,80)))","8b2d5eb8":"show(create_feature_grid('TotalTimeStopped',(20,40,50,60,80),monthly=False))","602ebc42":"show(create_feature_grid('TimeFromFirstStop',(20,40,50,60,80),monthly=False))","ea870948":"show(create_feature_grid('DistanceToFirstStop',(20,40,50,60,80),monthly=False))","ee58d602":"%%bigquery\nCREATE OR REPLACE MODEL `bqml_example.model_tts20`\nOPTIONS(MODEL_TYPE='LINEAR_REG',\n    LS_INIT_LEARN_RATE=.3,\n    L1_REG=1,\n    MAX_ITERATIONS=10) AS\nSELECT\n    TotalTimeStopped_p20 AS label,\n    EntryStreetName,\n    ExitStreetName,\n    EntryHeading,\n    ExitHeading,\n    Hour, \n    Weekend,\n    Month,\n    City\nFROM `kaggle-competition-datasets.geotab_intersection_congestion.train`\nWHERE RowId < 2600000","d3b80518":"%%bigquery\nCREATE OR REPLACE MODEL `bqml_example.model_tts50`\nOPTIONS(MODEL_TYPE='LINEAR_REG',\n    LS_INIT_LEARN_RATE=.3,\n    L1_REG=1,\n    MAX_ITERATIONS=10) AS\nSELECT\n    TotalTimeStopped_p50 AS label,\n    EntryStreetName,\n    ExitStreetName,\n    EntryHeading,\n    ExitHeading,\n    Hour,\n    Weekend,\n    Month,\n    City\nFROM `kaggle-competition-datasets.geotab_intersection_congestion.train`\nWHERE RowId < 2600000","11886316":"%%bigquery\nCREATE OR REPLACE MODEL `bqml_example.model_tts80`\nOPTIONS(MODEL_TYPE='LINEAR_REG',\n    LS_INIT_LEARN_RATE=.3,\n    L1_REG=1,\n    MAX_ITERATIONS=10) AS\nSELECT\n    TotalTimeStopped_p80 AS label,\n    EntryStreetName,\n    ExitStreetName,\n    EntryHeading,\n    ExitHeading,\n    Hour,\n    Weekend,\n    Month,\n    City\nFROM `kaggle-competition-datasets.geotab_intersection_congestion.train`\nWHERE RowId < 2600000","041bb8ef":"%%bigquery\nCREATE OR REPLACE MODEL `bqml_example.model_dtfs20`\nOPTIONS(MODEL_TYPE='LINEAR_REG',\n    LS_INIT_LEARN_RATE=.3,\n    L1_REG=1,\n    MAX_ITERATIONS=10) AS\nSELECT\n    DistanceToFirstStop_p20 AS label,\n    EntryStreetName,\n    ExitStreetName,\n    EntryHeading,\n    ExitHeading,\n    Hour,\n    Weekend,\n    Month,\n    City\nFROM `kaggle-competition-datasets.geotab_intersection_congestion.train`\nWHERE RowId < 2600000","23a05746":"%%bigquery\nCREATE OR REPLACE MODEL `bqml_example.model_dtfs50`\nOPTIONS(MODEL_TYPE='LINEAR_REG',\n    LS_INIT_LEARN_RATE=.3,\n    L1_REG=1,\n    MAX_ITERATIONS=10) AS\nSELECT\n    DistanceToFirstStop_p50 AS label,\n    EntryStreetName,\n    ExitStreetName,\n    EntryHeading,\n    ExitHeading,\n    Hour,\n    Weekend,\n    Month,\n    City\nFROM `kaggle-competition-datasets.geotab_intersection_congestion.train`\nWHERE RowId < 2600000","ae92b5ec":"%%bigquery\nCREATE OR REPLACE MODEL `bqml_example.model_dtfs80`\nOPTIONS(MODEL_TYPE='LINEAR_REG',\n    LS_INIT_LEARN_RATE=.3,\n    L1_REG=1,\n    MAX_ITERATIONS=10) AS\nSELECT\n    DistanceToFirstStop_p80 AS label,\n    EntryStreetName,\n    ExitStreetName,\n    EntryHeading,\n    ExitHeading,\n    Hour,\n    Weekend,\n    Month,\n    City\nFROM `kaggle-competition-datasets.geotab_intersection_congestion.train`\nWHERE RowId < 2600000","c6a9263a":"%%bigquery\nSELECT * FROM ML.TRAINING_INFO(MODEL `bigquery-geotab-competition.bqml_example.model_tts20`)","f2fe6129":"%%bigquery\nSELECT * FROM ML.TRAINING_INFO(MODEL `bigquery-geotab-competition.bqml_example.model_tts50`)","e82d1abf":"%%bigquery\nSELECT * FROM ML.TRAINING_INFO(MODEL `bigquery-geotab-competition.bqml_example.model_tts80`)","60e23d22":"%%bigquery\nSELECT * FROM ML.TRAINING_INFO(MODEL `bigquery-geotab-competition.bqml_example.model_dtfs20`)","20ce2c71":"%%bigquery\nSELECT * FROM ML.TRAINING_INFO(MODEL `bigquery-geotab-competition.bqml_example.model_dtfs50`)","b0c005a7":"%%bigquery\nSELECT * FROM ML.TRAINING_INFO(MODEL `bigquery-geotab-competition.bqml_example.model_dtfs80`)","84f2ddb6":"%%bigquery\nSELECT * FROM ML.EVALUATE(MODEL `bqml_example.model_tts20`, (\n  SELECT\n    TotalTimeStopped_p20 AS label,\n    EntryStreetName,\n    ExitStreetName,\n    EntryHeading,\n    ExitHeading,\n    Hour, \n    Weekend,\n    Month,\n    City\n  FROM\n    `kaggle-competition-datasets.geotab_intersection_congestion.train`\n  WHERE RowId > 2600000))","959f8932":"%%bigquery\nSELECT * FROM ML.EVALUATE(MODEL `bqml_example.model_tts50`, (\n  SELECT\n    TotalTimeStopped_p50 AS label,\n    EntryStreetName,\n    ExitStreetName,\n    EntryHeading,\n    ExitHeading,\n    Hour, \n    Weekend,\n    Month,\n    City\n  FROM\n    `kaggle-competition-datasets.geotab_intersection_congestion.train`\n  WHERE RowId > 2600000))","8153748d":"%%bigquery\nSELECT * FROM ML.EVALUATE(MODEL `bqml_example.model_tts80`, (\n  SELECT\n    TotalTimeStopped_p80 AS label,\n    EntryStreetName,\n    ExitStreetName,\n    EntryHeading,\n    ExitHeading,\n    Hour, \n    Weekend,\n    Month,\n    City\n  FROM\n    `kaggle-competition-datasets.geotab_intersection_congestion.train`\n  WHERE RowId > 2600000))","5ffc9d8b":"%%bigquery\nSELECT * FROM ML.EVALUATE(MODEL `bqml_example.model_dtfs20`, (\n  SELECT\n    DistanceToFirstStop_p20 AS label,\n    EntryStreetName,\n    ExitStreetName,\n    EntryHeading,\n    ExitHeading,\n    Hour, \n    Weekend,\n    Month,\n    City\n  FROM\n    `kaggle-competition-datasets.geotab_intersection_congestion.train`\n  WHERE RowId > 2600000))","ea53c2e2":"%%bigquery\nSELECT * FROM ML.EVALUATE(MODEL `bqml_example.model_dtfs50`, (\n  SELECT\n    DistanceToFirstStop_p50 AS label,\n    EntryStreetName,\n    ExitStreetName,\n    EntryHeading,\n    ExitHeading,\n    Hour, \n    Weekend,\n    Month,\n    City\n  FROM\n    `kaggle-competition-datasets.geotab_intersection_congestion.train`\n  WHERE RowId > 2600000))","479bb4ed":"%%bigquery\nSELECT * FROM ML.EVALUATE(MODEL `bqml_example.model_dtfs80`, (\n  SELECT\n    DistanceToFirstStop_p80 AS label,\n    EntryStreetName,\n    ExitStreetName,\n    EntryHeading,\n    ExitHeading,\n    Hour, \n    Weekend,\n    Month,\n    City\n  FROM\n    `kaggle-competition-datasets.geotab_intersection_congestion.train`\n  WHERE RowId > 2600000))","71f12993":"%%bigquery df1\nSELECT\n  RowId,\n  predicted_label as TotalTimeStopped_p20\nFROM\n  ML.PREDICT(MODEL `bqml_example.model_tts20`,\n    (\n    SELECT\n        RowId,\n        EntryStreetName,\n        ExitStreetName,\n        EntryHeading,\n        ExitHeading,\n        Hour, \n        Weekend,\n        Month,\n        City\n    FROM\n      `kaggle-competition-datasets.geotab_intersection_congestion.test`))\n    ORDER BY RowId ASC","c951cee5":"%%bigquery df2\nSELECT\n  RowId,\n  predicted_label as TotalTimeStopped_p50\nFROM\n  ML.PREDICT(MODEL `bqml_example.model_tts50`,\n    (\n    SELECT\n        RowId,\n        EntryStreetName,\n        ExitStreetName,\n        EntryHeading,\n        ExitHeading,\n        Hour, \n        Weekend,\n        Month,\n        City\n    FROM\n      `kaggle-competition-datasets.geotab_intersection_congestion.test`))\n    ORDER BY RowId ASC","1270aab9":"%%bigquery df3\nSELECT\n  RowId,\n  predicted_label as TotalTimeStopped_p80\nFROM\n  ML.PREDICT(MODEL `bqml_example.model_tts80`,\n    (\n    SELECT\n        RowId,\n        EntryStreetName,\n        ExitStreetName,\n        EntryHeading,\n        ExitHeading,\n        Hour, \n        Weekend,\n        Month,\n        City\n    FROM\n      `kaggle-competition-datasets.geotab_intersection_congestion.test`))\n    ORDER BY RowId ASC","8536924a":"%%bigquery df4\nSELECT\n  RowId,\n  predicted_label as DistanceToFirstStop_p20\nFROM\n  ML.PREDICT(MODEL `bqml_example.model_dtfs20`,\n    (\n    SELECT\n        RowId,\n        EntryStreetName,\n        ExitStreetName,\n        EntryHeading,\n        ExitHeading,\n        Hour, \n        Weekend,\n        Month,\n        City\n    FROM\n      `kaggle-competition-datasets.geotab_intersection_congestion.test`))\n    ORDER BY RowId ASC","7ba7bd68":"%%bigquery df5\nSELECT\n  RowId,\n  predicted_label as DistanceToFirstStop_p50\nFROM\n  ML.PREDICT(MODEL `bqml_example.model_dtfs50`,\n    (\n    SELECT\n        RowId,\n        EntryStreetName,\n        ExitStreetName,\n        EntryHeading,\n        ExitHeading,\n        Hour, \n        Weekend,\n        Month,\n        City\n    FROM\n      `kaggle-competition-datasets.geotab_intersection_congestion.test`))\n    ORDER BY RowId ASC","d7afce6e":"%%bigquery df6\nSELECT\n  RowId,\n  predicted_label as DistanceToFirstStop_p80\nFROM\n  ML.PREDICT(MODEL `bqml_example.model_dtfs80`,\n    (\n    SELECT\n        RowId,\n        EntryStreetName,\n        ExitStreetName,\n        EntryHeading,\n        ExitHeading,\n        Hour, \n        Weekend,\n        Month,\n        City\n    FROM\n      `kaggle-competition-datasets.geotab_intersection_congestion.test`))\n    ORDER BY RowId ASC","0537fb1e":"#Change RowId in accordance with submission file\ndf1['RowId'] = df1['RowId'].apply(str) + '_0'\ndf2['RowId'] = df2['RowId'].apply(str) + '_1'\ndf3['RowId'] = df3['RowId'].apply(str) + '_2'\ndf4['RowId'] = df4['RowId'].apply(str) + '_3'\ndf5['RowId'] = df5['RowId'].apply(str) + '_4'\ndf6['RowId'] = df6['RowId'].apply(str) + '_5'\n\n#Renaming the columns\ndf1.rename(columns={'RowId': 'TargetId', 'TotalTimeStopped_p20': 'Target'}, inplace=True)\ndf2.rename(columns={'RowId': 'TargetId', 'TotalTimeStopped_p50': 'Target'}, inplace=True)\ndf3.rename(columns={'RowId': 'TargetId', 'TotalTimeStopped_p80': 'Target'}, inplace=True)\ndf4.rename(columns={'RowId': 'TargetId', 'DistanceToFirstStop_p20': 'Target'}, inplace=True)\ndf5.rename(columns={'RowId': 'TargetId', 'DistanceToFirstStop_p50': 'Target'}, inplace=True)\ndf6.rename(columns={'RowId': 'TargetId', 'DistanceToFirstStop_p80': 'Target'}, inplace=True)\n\n#Concatenate all the dataframes into one\ndf = pd.concat([df1, df2, df3, df4, df5, df6], axis=0)","077ebba5":"df.to_csv(r'submission.csv', index=False)","fa9fd5a7":"# Output as csv","17b63c2f":"# Exploratory Data Analysis","e68a9ccf":"## Mapping the intersections","f924553f":"# Model Evaluation","7e68299c":"# BigQuery ML Intersection Data Analysis\n![Intersection](https:\/\/c.wallhere.com\/photos\/d6\/0e\/city_architecture_cityscape_New_York_City_USA_building_car_street-81238.jpg!d)","898cdc8a":"# Predict Outcomes","8c31f692":"# Training Statistics","da6d506e":"The BigQuery client library provides a cell magic, %%bigquery, which runs a SQL query and returns the results as a Pandas DataFrame","dad1bad2":"# Training Model Creation","02c3711e":"## Dataset Columns\nThe training dataset has 28 columns with the following names","cec7ab17":"The BigQuery Python client library provides a magic command that allows you to run queries with minimal code."}}