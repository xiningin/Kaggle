{"cell_type":{"819bf694":"code","c41eea68":"code","96502649":"code","d99a0061":"code","af4b57f8":"code","e579f688":"code","965085bc":"code","cc8259fb":"code","5904da6f":"code","7912057e":"code","940b5b26":"code","58757351":"code","8c79e658":"code","90727fb5":"code","76f2cb35":"code","746d755d":"code","e746e1f1":"code","09b183dc":"code","0cde2fdd":"code","5b1714de":"code","06de5967":"code","ea740814":"code","51a7ea2a":"code","0ba597ba":"code","e6887e69":"code","d336453e":"code","7ff80010":"code","ecee0acc":"code","ef0b80eb":"code","e9cc11e5":"code","b3c2f4aa":"code","21174acb":"code","12ff2703":"code","02bc54c5":"code","bd97c807":"code","91897ea6":"code","76d8ad0e":"markdown","dd524335":"markdown","79fddbf6":"markdown","e1152fd6":"markdown","b5c85c8e":"markdown","e0d67242":"markdown","5a78f6f9":"markdown"},"source":{"819bf694":"# System\nimport os\nimport sys\n\n# Numerical\nimport numpy as np\nfrom numpy import median\nimport pandas as pd\n\n\n# NLP\nimport re\nfrom string import ascii_letters\n\n\n# Tools\nimport itertools\n\n# Machine Learning - Preprocessing\nfrom sklearn import preprocessing\nfrom sklearn.preprocessing import StandardScaler\n\n\n# Machine Learning - Model Selection\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import StratifiedKFold\nfrom sklearn.model_selection import StratifiedShuffleSplit\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import GridSearchCV\n\n\n# Machine Learning - Models\nfrom sklearn import svm\nfrom sklearn.svm import SVC\nfrom sklearn.svm import LinearSVC, NuSVC\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.linear_model import LogisticRegression, SGDClassifier\nfrom sklearn.ensemble import AdaBoostClassifier, ExtraTreesClassifier, GradientBoostingClassifier, RandomTreesEmbedding, RandomForestClassifier, VotingClassifier\nfrom sklearn.naive_bayes import BernoulliNB, GaussianNB, MultinomialNB \nfrom sklearn.neighbors import KDTree, KNeighborsClassifier, NearestNeighbors\nfrom sklearn.neural_network import BernoulliRBM, MLPClassifier\nfrom sklearn.discriminant_analysis import QuadraticDiscriminantAnalysis\nfrom sklearn.gaussian_process import GaussianProcessClassifier\nfrom sklearn.gaussian_process.kernels import RBF\nfrom sklearn.mixture import GaussianMixture\n\n\n# Machine Learning - Evaluation\nfrom sklearn import metrics \nfrom sklearn.metrics import f1_score\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.utils import class_weight\n\n\n# Plot\nimport matplotlib.pyplot as plt\nfrom matplotlib.pyplot import figure\nimport seaborn as sns\n\nprint(os.listdir(\"..\/input\"))\n","c41eea68":"# import train 7 test data\ntrain = pd.read_csv(\"..\/input\/train.csv\")\ntest = pd.read_csv(\"..\/input\/test.csv\")\nsubmission = pd.read_csv(\"..\/input\/gender_submission.csv\")","96502649":"train.head()","d99a0061":"train.describe()","af4b57f8":"train.info()","e579f688":"df = train\ncolumns = df.columns","965085bc":"target = \"Survived\"\ny_label = \"Count\"\n\n\nnrows = 6\nncols = 22\n\nlabelsize = ncols*0.8\nfontsize = labelsize*1.6\ntitlesize = labelsize*2.2\n\nsns.set(style=\"whitegrid\")\nsns.set_context(\"notebook\")\n\nax = sns.countplot(x=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(target + \" Count\", fontsize=titlesize)\nax.set_xlabel(target, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)","cc8259fb":"col = \"Sex\"\ntarget = \"Survived\"\ny_label = \"Count\"\n\n\nnrows = 6\nncols = 22\n\nlabelsize = ncols*0.8\nfontsize = labelsize*1.6\ntitlesize = labelsize*2.2\n\nsns.set(style=\"whitegrid\")\nsns.set_context(\"notebook\")\n\nax = sns.countplot(x=col, hue=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" vs. \"+target +\" Count\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)","5904da6f":"col = \"Age\"\ntarget = \"Survived\"\ny_label = \"Count\"\n\nnrows = 8\nncols = 22\n\nlabelsize = ncols*.7\nfontsize = labelsize*1.6\ntitlesize = labelsize*2.2\n\nsns.reset_defaults()\nsns.set(style=\"whitegrid\")\nsns.set_context(\"notebook\")\n\nax = sns.countplot(x=col, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" Count\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize, rotation=90)\nplt.show()\n\nax = sns.countplot(x=col, hue=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" vs. \"+ target+\" Count\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize, rotation=90)\nplt.show()","7912057e":"col = \"Pclass\"\ntarget = \"Survived\"\ny_label = \"Count\"\n\nnrows = 6\nncols = 22\n\nlabelsize = ncols*.7\nfontsize = labelsize*1.6\ntitlesize = labelsize*2.2\n\nsns.reset_defaults()\nsns.set(style=\"whitegrid\")\nsns.set_context(\"notebook\")\n\nplt.subplot(121)\nax = sns.countplot(x=col, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" Count\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\n\nplt.subplot(122)\nax = sns.countplot(x=col, hue=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" vs. \"+ target+\" Count\", fontsize=titlesize)\nax.set_xlabel(target, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\nplt.show()\n\nax = sns.lineplot(x=col, y=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" vs. \"+ target+\" Line Plot\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\nplt.show()","940b5b26":"col = \"SibSp\"\ntarget = \"Survived\"\ny_label = \"Count\"\n\n\nnrows = 6\nncols = 22\n\nlabelsize = ncols*.7\nfontsize = labelsize*1.6\ntitlesize = labelsize*2.2\n\nsns.reset_defaults()\nsns.set(style=\"whitegrid\")\nsns.set_context(\"notebook\")\n\nplt.subplot(121)\nax = sns.countplot(x=col, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" Count\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\n\nplt.subplot(122)\nax = sns.countplot(x=col, hue=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" vs. \"+ target+\" Count\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\nplt.show()\n\n\nax = sns.lineplot(x=col, y=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" vs. \"+ target+\" Line Plot\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\nplt.show()","58757351":"col = \"Parch\"\ntarget = \"Survived\"\ny_label = \"Count\"\n\nnrows = 6\nncols = 22\n\nlabelsize = ncols*.7\nfontsize = labelsize*1.6\ntitlesize = labelsize*2.2\n\nsns.reset_defaults()\nsns.set(style=\"whitegrid\")\nsns.set_context(\"notebook\")\n\nplt.subplot(121)\nax = sns.countplot(x=col, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" Count\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\n\nplt.subplot(122)\nax = sns.countplot(x=col, hue=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" vs. \"+ target+\" Count\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\nplt.show()\n\nax = sns.lineplot(x=col, y=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" vs. \"+ target+\" Line Plot\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\nplt.show()","8c79e658":"col = \"Embarked\"\ntarget = \"Survived\"\ny_label = \"Count\"\n\n\n\nnrows = 6\nncols = 22\n\nlabelsize = ncols*.7\nfontsize = labelsize*1.6\ntitlesize = labelsize*2.2\n\nsns.reset_defaults()\nsns.set(style=\"whitegrid\")\nsns.set_context(\"notebook\")\n\nplt.subplot(121)\nax = sns.countplot(x=col, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(target, fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\n\nplt.subplot(122)\nax = sns.countplot(x=col, hue=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" vs. \"+ target, fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\nplt.show()\n\nax = sns.lineplot(x=col, y=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" vs. \"+ target+\" Line Plot\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\nplt.show()","90727fb5":"col1 = \"Age\"\ncol2 = \"Fare\"\ncol3 = \"Name\"\n\ntarget = \"Survived\"\n\n\nnrows = 12\nncols = 22\n\nlabelsize = ncols*.5\nfontsize = labelsize*1.5\ntitlesize = labelsize*2\n\nsns.reset_defaults()\nsns.set(style=\"whitegrid\")\nsns.set_context(\"notebook\")\n\nplt.subplots_adjust(hspace = 0.4)\n\ndf[col1] = df[col1].fillna(df[col1].median())\nplt.subplot(221)\nax = sns.distplot(df[col1])\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col1+\" Distribution\", fontsize=titlesize)\nax.set_xlabel(col1, fontsize=fontsize)\nax.set_ylabel(\"\", fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\n\nplt.subplot(222)\nax = sns.distplot(df[col2])\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col2+\" Distribution\", fontsize=titlesize)\nax.set_xlabel(col2, fontsize=fontsize)\nax.set_ylabel(\"\", fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\n\nplt.subplot(223)\nax = sns.distplot(df[col3].apply(lambda x:len(x)))\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col3+\" Length\"+\" Distribution\", fontsize=titlesize)\nax.set_xlabel(col3, fontsize=fontsize)\nax.set_ylabel(\"\", fontsize=fontsize)\nax.tick_params(labelsize=labelsize)","76f2cb35":"col1 = \"Name\"\ncol2 = \"Title\"\ntarget = \"Survived\"\ny_label = \"Count\"\n\n\nnrows = 6\nncols = 22\n\nlabelsize = ncols*.7\nfontsize = labelsize*1.6\ntitlesize = labelsize*2.2\n\nsns.reset_defaults()\nsns.set(style=\"whitegrid\")\nsns.set_context(\"notebook\")\n\ndf[col2] = df[col1].apply(lambda x:x.split(\" \")[1])\nax = sns.countplot(x=col2, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col2+\" Count\", fontsize=titlesize)\nax.set_xlabel(col1, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize, rotation=90)\nplt.show()\n\nax = sns.countplot(x=col2, hue=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col2+\" vs. \"+ target+\" Count\", fontsize=titlesize)\nax.set_xlabel(col2, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize, rotation=90)\nplt.show()","746d755d":"col1 = \"Name\"\ncol2 = \"Name Length\"\ntarget = \"Survived\"\ny_label = \"Count\"\n\n\nnrows = 6\nncols = 22\n\nlabelsize = ncols*.7\nfontsize = labelsize*1.6\ntitlesize = labelsize*2.2\n\nsns.reset_defaults()\nsns.set(style=\"whitegrid\")\nsns.set_context(\"notebook\")\n\ndf[col2] = df[col1].apply(lambda x:len(x))\nax = sns.countplot(x=col2, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col2+\" Count\", fontsize=titlesize)\nax.set_xlabel(col2, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\nplt.show()\n\nax = sns.countplot(x=col2, hue=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col2+\" vs. \"+ target+\" Count\", fontsize=titlesize)\nax.set_xlabel(col2, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\nplt.show()\n\n\nax = sns.lineplot(x=col2, y=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col2+\" vs. \"+ target+\" Line Plot\", fontsize=titlesize)\nax.set_xlabel(col2, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\nplt.show()\n\nax = sns.regplot(x=col2, y=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col2+\" vs. \"+ target+\" Line Plot\", fontsize=titlesize)\nax.set_xlabel(col2, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\nplt.show()\n","e746e1f1":"col = \"Fare\"\ntarget = \"Survived\"\ny_label = \"Count\"\n\n\nnrows = 6\nncols = 22\n\nlabelsize = ncols*.7\nfontsize = labelsize*1.6\ntitlesize = labelsize*2.2\n\nsns.reset_defaults()\nsns.set(style=\"whitegrid\")\nsns.set_context(\"notebook\")\n\nax = sns.distplot(df[col])\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" Count\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize, rotation=90)\nplt.show()\n\n\nax = sns.lineplot(x=col2, y=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col2+\" vs. \"+ target+\" Line Plot\", fontsize=titlesize)\nax.set_xlabel(col2, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)\nplt.show()\n\nax = sns.regplot(x=col, y=target, data=df)\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(col+\" vs. \"+ target+\" Count\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize, rotation=90)\nplt.show()","09b183dc":"def transform(x):\n    if x==0: return 0\n    else: return 1\n    \ndef prep(train, title=None, ticket=None):\n    m_embarked = {\"S\": 0, \"Q\": 1, \"C\": 2}\n\n    train[\"NameLen\"] = train[\"Name\"].apply(lambda x: len(x))\n    train[\"NameCount\"] = train[\"Name\"].apply(lambda x:len(x.split(\" \")))\n    train[\"Title\"] = train[\"Name\"].apply(lambda x:x.split(\" \")[1])\n    \n    if not title:\n        title = {}\n    for item, value in enumerate(set(train[\"Title\"])):\n        title[value] = item\n\n    train[\"Title\"] = train[\"Title\"].map(title)\n\n\n    train['FamilySize'] = train ['SibSp'] + train['Parch'] + 1\n\n    train['IsAlone'] = 1 \n    train['IsAlone'].loc[train['FamilySize'] > 1] = 0 \n\n    \n    train[\"Sex\"] = train[\"Sex\"].apply(lambda x: 0 if x==\"male\" else 1)\n    \n    train['Age'].fillna(train['Age'].median(), inplace = True)\n    train['Age'] = train['Age'].apply(lambda x: int(x\/5))\n    \n#     train['AgeBin'] = pd.cut(train['Age'].astype(int), 5)\n    \n#     if age_bin==None:\n#         age_bin = {}\n#         for item, value in enumerate(set(train['AgeBin'])):\n#             age_bin[value] = item\n    \n       \n#     train['AgeBin'] = train['AgeBin'].map(age_bin)\n    \n    train['SibSp'] = train['SibSp'].apply(lambda x: transform(x))\n    train['Parch'] = train['Parch'].apply(lambda x: transform(x))\n    \n    train['Fare'].fillna(train['Fare'].median(), inplace = True)\n#     train['FareBin'] = pd.qcut(train['Fare'], 4)\n    \n#     if not fare_bin:\n#         fare_bin = {}\n#         for item, value in enumerate(set(train['FareBin']), 1):\n#             fare_bin[value] = item\n#     train['FareBin'] = train['FareBin'].map(fare_bin)\n    \n    emb = train['Embarked'].mode()[0]\n    train['Embarked'] = train['Embarked'].apply(lambda x: x if x in m_embarked else emb)\n    train['Embarked'] = train['Embarked'].map(m_embarked)\n    \n    \n    train[\"TicketType\"] = train[\"Ticket\"].apply(lambda x: x.split(\" \")[0])\n    train[\"TicketType\"] = train[\"TicketType\"].apply(lambda x: 0 if x.isdigit() else re.sub(r\"[^a-zA-Z]\", \"\", x.split(\"\/\")[0]))\n    \n    if not ticket:\n        ticket = {}\n    for item, value in enumerate(set(train[\"TicketType\"])):\n        ticket[value] = item\n    train[\"TicketType\"] = train[\"TicketType\"].map(ticket)\n    \n    \n    if title and ticket:\n        return train, title, ticket\n    else:\n        return train\n","0cde2fdd":"train, title, ticket = prep(train)\ntest, title, ticket = prep(test, title=title, ticket=ticket)","5b1714de":"all_columns = ['Survived', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare', 'Cabin', 'Embarked','FamilySize', 'IsAlone']\ncolumns = ['Pclass', 'Sex', 'Age', 'SibSp', 'Parch', 'Fare', 'Embarked', 'NameLen', 'NameCount', 'Title', 'FamilySize', 'IsAlone', 'TicketType']\ndrop_cols = [\"PassengerId\", \"Survived\", \"Name\", \"Ticket\", \"Cabin\"]\ntarget_col = 'Survived'\n\n# categorical_data = train.select_dtypes(\"object_\")\n# numerical_data = train.select_dtypes(\"number\")\n","06de5967":"cols = [columns+[target_col]][0]\nd = train[cols]\nsns.pairplot(d, kind='reg', diag_kind='kde', dropna=True)","ea740814":"# g = sns.PairGrid(\n#     d, \n#     diag_sharey=True, \n#     height=2.5, \n#     aspect=1, \n#     despine=True, \n#     dropna=False)\n# g = g.map(plt.scatter)\n# g.map_diag(plt.hist)\n# g.map_offdiag(plt.scatter);","51a7ea2a":"sns.reset_defaults()\nsns.set(style=\"whitegrid\")\nsns.set_context(\"notebook\")\n\nnrows = 22\nncols = 22\n\ncmap = sns.diverging_palette(h_neg=220, h_pos=10, s=75, l=50, sep=10, n=len(columns), center='light', as_cmap=True)\n\nsns.clustermap(d.corr(),  \n               figsize=(ncols, nrows), \n               center=0,\n               cmap=cmap,\n               linewidths=.75)\n\nplt.show()","0ba597ba":"nrows = 22\nncols = 22\n\nlabelsize = ncols*.7\nfontsize = labelsize*1.5\ntitlesize = labelsize*2.5\n\nsns.reset_defaults()\nsns.set(style=\"whitegrid\")\nsns.set_context(\"notebook\")\n\nd =train[all_columns]\n\n# Compute the correlation matrix\ncorr = d.corr()\n\n# Generate a mask for the upper triangle\nmask = np.zeros_like(corr, dtype=np.bool)\nmask[np.triu_indices_from(mask)] = True\n\n# Set up the matplotlib figure\nfig, ax = plt.subplots(figsize=(ncols, nrows))\n\n# Generate a custom diverging colormap\ncmap = sns.diverging_palette(h_neg=220, h_pos=10, s=75, l=50, sep=10, n=len(columns), center='light', as_cmap=True)\n\nax = sns.heatmap(\n    corr,\n    cmap=cmap,\n    center=0,\n    robust=True,\n    annot=True,\n    linewidths=0.5,\n    linecolor='white',\n    cbar=True,\n    cbar_kws={\"shrink\": .5},\n    square=True,\n    mask=mask)\n\nax.figure.set_size_inches(ncols, nrows)\nax.axes.set_title(\"Feature Correleation\", fontsize=titlesize)\nax.set_xlabel(col, fontsize=fontsize)\nax.set_ylabel(y_label, fontsize=fontsize)\nax.tick_params(labelsize=labelsize)","e6887e69":"def print_performance(model, X_test, y_test, class_names):\n    preds = model.predict(X_test)\n\n    # accuracy_score = metrics.accuracy_score(y_test, preds)\n    # auc = metrics.auc(y_test, preds)\n    # average_precision_score = metrics.average_precision_score(y_test, preds)\n    classification_report = metrics.classification_report(y_test, preds)\n    # cohen_kappa_score = metrics.cohen_kappa_score(y_test, preds)\n    confusion_matrix = metrics.confusion_matrix(y_test, preds)\n    f1_score_ = metrics.f1_score(y_test, preds, average=\"weighted\")\n    # precision_recall_curve = metrics.precision_recall_curve(y_test, preds)\n    # precision_score = metrics.precision_score(y_test, preds, average=\"weighted\")\n    # recall_score = metrics.recall_score(y_test, preds, average=\"weighted\")\n    # roc_auc_score = metrics.roc_auc_score(y_test, preds, average=\"weighted\")\n    # roc_curve = metrics.roc_curve(y_test, preds)\n    \n    print(\"-\"*55)\n    print(\"Performance\")\n    print(\"-\"*55)\n    print(\"{} : {:.4f} \".format(\"Accuracy Score                  \", accuracy_score))\n    # print(\"{} : {:.4f} \".format(\"AUC                             \", auc))\n    # print(\"{} : {:.4f} \".format(\"Average Precision Score         \", average_precision_score))\n#     print(\"{} : {:.4f} \".format(\"Classification Report           \", classification_report))\n#     print(\"{} : {:.4f} \".format(\"Confusion Matrix                \", confusion_matrix))\n    print(\"{} : {:.4f} \".format(\"F1 Score                        \", f1_score_))\n    # print(\"{} : {:.4f} \".format(\"Precision Recall Curve          \", precision_recall_curve))\n    print(\"{} : {:.4f} \".format(\"Precision Score                 \", precision_score))\n    print(\"{} : {:.4f} \".format(\"Recall Score                    \", recall_score))\n    # print(\"{} : {:.4f} \".format(\"Roc Auc Score                   \", roc_auc_score))\n    # print(\"{} : {:.4f} \".format(\"Roc Curve                       \", roc_curve))\n    print(classification_report)\n    \n    print(\"-\"*55)\n    print(\"\\n\\n\")\n    \n\n    np.set_printoptions(precision=2)\n\n    # Plot non-normalized confusion matrix\n    plt.subplot(121)\n    plot_confusion_matrix(confusion_matrix, classes=class_names, title='Confusion matrix, without normalization')\n\n    # Plot normalized confusion matrix\n    plt.subplot(122)\n    plot_confusion_matrix(confusion_matrix, classes=class_names, normalize=True, title='Normalized confusion matrix')\n\n    plt.show()\n    \ndef plot_confusion_matrix(cm, classes,\n                          normalize=False,\n                          title='Confusion matrix',\n                          cmap=plt.cm.Blues):\n    \"\"\"\n    This function prints and plots the confusion matrix.\n    Normalization can be applied by setting `normalize=True`.\n    \"\"\"\n    if normalize:\n        cm = cm.astype('float') \/ cm.sum(axis=1)[:, np.newaxis]\n        print(\"Normalized confusion matrix\")\n    else:\n        print('Confusion matrix, without normalization')\n\n    print(cm)\n\n    plt.imshow(cm, interpolation='nearest', cmap=cmap)\n    plt.title(title)\n    plt.colorbar()\n    tick_marks = np.arange(len(classes))\n    plt.xticks(tick_marks, classes, rotation=45)\n    plt.yticks(tick_marks, classes)\n\n    fmt = '.2f' if normalize else 'd'\n    thresh = cm.max() \/ 2.\n    for i, j in itertools.product(range(cm.shape[0]), range(cm.shape[1])):\n        plt.text(j, i, format(cm[i, j], fmt),\n                 horizontalalignment=\"center\",\n                 color=\"white\" if cm[i, j] > thresh else \"black\")\n\n    plt.ylabel('True label')\n    plt.xlabel('Predicted label')\n    plt.tight_layout()\n    \n    \ndef print_performance_grid(clf):\n    # print(\"*\"*100)\n    # print(\"{}{}{}\".format(\"*\"*40,\"Performance\", \"*\"*40))\n    print(\"{}\".format(\"Performance\"))\n    print(\"*\"*100)\n    print(\"Score            : {}\".format(clf.score(X, y)))\n    print(\"Best Estimator   : {}\".format(clf.best_estimator_))\n    print(\"Best Score       : {}\".format(clf.best_score_))\n    print(\"Best Params      : {}\".format(clf.best_params_))\n    print(\"Best Index       : {}\".format(clf.best_index_))\n    print(\"Scorer           : {}\".format(clf.scorer_))\n    print(\"Refit Time       : {}\".format(clf.refit_time_))\n    # print(\"CV Results       : {}\".format(clf.cv_results_))\n\n    params = clf.get_params()\n    best_estimator = clf.best_estimator_\n    cv_results = clf.cv_results_\n    \n    return params, best_estimator, cv_results","d336453e":"train_features = train[columns]\ntest_features = test[columns]\n\n\ntarget = train[target_col]","7ff80010":"train_features.head()","ecee0acc":"train_features = train_features.values\ntest_features = test_features.values\n\ntarget = target.values","ef0b80eb":"# train_features = train_features.fillna(0)\n\n# test_features = test_features.fillna(0)\n\nscaler = StandardScaler()\n\ntrain_features = scaler.fit_transform(train_features)\ntest_features = scaler.transform(test_features)","e9cc11e5":"train_features[0], test_features[0]","b3c2f4aa":"X = train_features\ny = target","21174acb":"# # SVC\n# estimator = svm.SVC(class_weight='balanced')\n\n# kernel = ('linear', 'poly', 'rbf', 'sigmoid', 'precomputed')\n# degree = np.arange(1, 10, 1)\n# C = np.array([np.arange(0.01, 0.1, 0.01), np.arange(0.1, 1, 0.1), np.arange(1, 10, 1)]).flatten()\n# gamma = np.array([np.arange(0.01, 0.1, 0.01), np.arange(0.1, 1, 0.1), np.arange(1, 10, 1)]).flatten()\n\n\n# param_grid = {\n#     'kernel': ['linear'], \n#     'C': C,\n#     'gamma': gamma\n# }\n\n# # RandomForestClassifier\n# # estimator = RandomForestClassifier(n_estimators=100, class_weight=\"balanced\")\n\n# # param_grid = {\"n_estimators\": np.arange(1, 100, 1)}\n\n\n# cv = 3\n# verbose = 1\n\n# grid_clf = GridSearchCV(estimator=estimator,param_grid=param_grid, n_jobs=-1, cv=cv, verbose=verbose)\n\n# grid_clf.fit(X, y)","12ff2703":"# params, best_estimator, cv_results = print_performance_grid(grid_clf)","02bc54c5":"clf = RandomForestClassifier(n_estimators=1000, class_weight=\"balanced\")\n# clf = SVC(C=0.04, gamma=0.01, kernel='linear', class_weight=\"balanced\")\n\ncv = 3\nverbose = 1\nscores = cross_val_score(clf, X, y, cv=cv, verbose=verbose)\n\nprint(scores)","bd97c807":"clf = RandomForestClassifier(n_estimators=100, class_weight=\"balanced\")\nclf = clf.fit(X, y)\npreds = clf.predict(test_features)","91897ea6":"submission_csv = \"submission.csv\"\n\ndf_test = pd.DataFrame({'PassengerId':submission['PassengerId'], 'Survived':preds})\n\ndf_test.to_csv(submission_csv, index=False)\ndf_test.head()","76d8ad0e":"# 2. Read Data","dd524335":"# 1. Import","79fddbf6":"# 6. Inference\/ Prediction","e1152fd6":"# 3. Visualization","b5c85c8e":"# 4. Preprocessing","e0d67242":"![](https:\/\/upload.wikimedia.org\/wikipedia\/en\/6\/65\/Titanic_Colourised%2C_photographed_in_Southampton.png)","5a78f6f9":"# 5. Training and Evaluation"}}