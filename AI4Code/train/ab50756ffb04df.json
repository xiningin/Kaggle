{"cell_type":{"3394a7d9":"code","54c98ee7":"code","c9beb756":"code","a17be1ea":"code","5a02eff8":"code","f6aaa53e":"code","ab4890a4":"code","276b45b4":"code","40929d58":"code","61e2f24a":"code","e39786c5":"code","c59a09af":"code","48d8dd74":"code","b5b5f5d5":"code","ba8796f4":"code","7546eb61":"code","48ced8c4":"code","f89de4ee":"code","42a85cea":"markdown","3a9c4cd5":"markdown","d02cb02e":"markdown","774a7c2e":"markdown","a8fb47a0":"markdown","43174d58":"markdown","36e720e1":"markdown","cbae2ce3":"markdown"},"source":{"3394a7d9":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","54c98ee7":"df1 = pd.read_csv('..\/input\/lianjia\/new.csv', encoding = \"ISO-8859-1\")\npd.set_option('display.max_columns', None)\ndf1.head()","c9beb756":"df1.dtypes","a17be1ea":"df2 = df1.copy()\n\ndf2 = df2.drop(columns=['id','url','Cid','price'])","5a02eff8":"df3 = df2.copy()\n\nupper_limit = df3['totalPrice'].mean() + 3*df3['totalPrice'].std()\nlower_limit = df3['totalPrice'].mean() - 3*df3['totalPrice'].std()\n\ndf3 = df3[df3['totalPrice'] <= upper_limit]\ndf3 = df3[df3['totalPrice'] >= lower_limit]\n\nprint(df2.shape)\nprint(df3.shape)","f6aaa53e":"df4 = df3.copy()\n\ndef tradeTimeMod(x):\n    return x[0:4]\n\ndf4['tradeTime'] = df4['tradeTime'].apply(tradeTimeMod)\n\ndf4.head()","ab4890a4":"df5 = df4.copy()\n \ndf5['tradeTime'] = pd.to_numeric(df5['tradeTime'])\ndf5['livingRoom'] = df5['livingRoom'].apply(pd.to_numeric, errors='coerce')\ndf5['drawingRoom'] = df5['drawingRoom'].apply(pd.to_numeric, errors='coerce')\ndf5['bathRoom'] = df5['bathRoom'].apply(pd.to_numeric, errors='coerce')\ndf5['constructionTime'] = df5['constructionTime'].apply(pd.to_numeric, errors='coerce')","276b45b4":"df6  = df5.copy()\n\ndef floorType(x):\n    return x.split(' ')[0]\ndef floorHeight(x):\n    try:\n        return int(x.split(' ')[1])\n    except:\n        return np.nan\n    \ndf6['floorType'] = df6['floor'].apply(floorType)\ndf6['floorHeight'] = df6['floor'].apply(floorHeight)\n\ndf6 = df6.drop(columns=['floor'])","40929d58":"df7 = df6.copy()\n\ndf7 = df7[df7['buildingType']>=1]\n\ncols_to_get_dummies = ['buildingType','renovationCondition','buildingStructure','elevator','district','floorType']\ndf7 = pd.get_dummies(data=df7, columns=cols_to_get_dummies)","61e2f24a":"df8 = df7.copy()\n\ndf8 = df8.dropna()\n\nprint(df8.shape)\nprint(df1.shape)","e39786c5":"X = df8.drop(columns=['totalPrice'])\ny = df8['totalPrice']","c59a09af":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.2,random_state=69)","48d8dd74":"cols_to_norm = ['Lng','Lat','DOM','followers','square','livingRoom','drawingRoom','kitchen','bathRoom',\n                'ladderRatio','fiveYearsProperty','subway','communityAverage','floorHeight']\n\nfrom sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\n\nX_train[cols_to_norm] = scaler.fit_transform(X_train[cols_to_norm])\nX_test[cols_to_norm] = scaler.transform(X_test[cols_to_norm])\n\nX_train.head()","b5b5f5d5":"from sklearn.linear_model import LinearRegression\n\nlr_model = LinearRegression()\nlr_model.fit(X_train, y_train)\n\nprint(lr_model.score(X_train, y_train))\nprint(lr_model.score(X_test, y_test))","ba8796f4":"from sklearn.linear_model import Ridge\n\nridge_model = Ridge()\nridge_model.fit(X_train, y_train)\n\nprint(ridge_model.score(X_train, y_train))\nprint(ridge_model.score(X_test, y_test))","7546eb61":"from sklearn.linear_model import Lasso\n\nlasso_model = Lasso()\nlasso_model.fit(X_train, y_train)\n\nprint(lasso_model.score(X_train, y_train))\nprint(lasso_model.score(X_test, y_test))","48ced8c4":"from sklearn.tree import DecisionTreeRegressor\n\ndtr_model = DecisionTreeRegressor()\ndtr_model.fit(X_train, y_train)\n\nprint(dtr_model.score(X_train, y_train))\nprint(dtr_model.score(X_test, y_test))","f89de4ee":"from sklearn.ensemble import RandomForestRegressor\n\nrfg_model = RandomForestRegressor()\nrfg_model.fit(X_train, y_train)\n\nprint(rfg_model.score(X_train, y_train))\nprint(rfg_model.score(X_test, y_test))","42a85cea":"Only get the trade year from tradeTime column","3a9c4cd5":"We explore the data type of each feature to see which one needs to be modified. \nBased on our common sense, for example, number of rooms shouldn't be object.","d02cb02e":"Convert some columns to the right data type","774a7c2e":"Drop irrelavent columns for house price prediction\n\nAs for the price column, we drop it because price is just totalPrice\/square, which are the features already in the dataset","a8fb47a0":"Remove outliers for better accuracy and fornormalization later on","43174d58":"One hot encoding for features we consider nominal data","36e720e1":"Split the floor column into floorType and floorHeight","cbae2ce3":"Normalize columns for features we consider continuos data"}}