{"cell_type":{"47f21ed6":"code","fb75823e":"code","a844b1af":"code","435efa78":"code","f2d41159":"code","fcfc2eca":"code","6e3ba56d":"code","324e18b5":"code","6d36ace8":"code","dbb544d0":"code","e1783236":"code","d7283853":"code","2e83d2f0":"code","8cd500b5":"code","8f921844":"code","6d00c636":"code","3b4745f2":"code","4e4891ee":"code","9b81d866":"code","4f0af306":"code","8a1ff9a1":"code","add01505":"code","451826ca":"code","a6f021e9":"code","66d33e3c":"code","0c4e21bb":"code","59e4dd89":"code","f186934e":"code","3641c8d6":"code","eda7b055":"code","47d4c9dc":"code","56763ab2":"code","eb854d30":"code","e5a1f4e7":"code","2531728f":"code","bf98f668":"code","9c9bc7c4":"code","bb1b121c":"code","e556a29e":"code","0dbd4cd8":"code","dc188922":"code","f8a118dd":"code","400ed0e9":"code","c3c7ce50":"code","b901a5b5":"code","47894474":"code","67e2f739":"code","69268cb9":"code","2894ff69":"code","af16b42b":"code","7f27b8f8":"code","dc8249c6":"code","b485df3e":"code","3134d61d":"code","cbd3e526":"code","98645d6b":"code","90fc7ae1":"code","d0666b04":"code","76599def":"code","4251fa30":"code","152c5208":"code","edb3f322":"code","1cc236fb":"code","5193c56d":"code","f034ff63":"code","379da7ca":"code","18b48ede":"code","ecbdf01a":"code","7cf3420f":"code","a9938134":"code","f53f3fda":"markdown","6984934b":"markdown","9e79a53d":"markdown","afdbdaa8":"markdown","d9094aef":"markdown","c8c0b6d0":"markdown","b3a43f27":"markdown","88fd4db0":"markdown","f6df0242":"markdown","1134da45":"markdown","41285611":"markdown","a2df7e06":"markdown","9af7bafe":"markdown","4d22e1a8":"markdown","fe5a6e12":"markdown","bcc7d8da":"markdown","a0c43178":"markdown","da1d547e":"markdown","4deb83e3":"markdown","395e8e4a":"markdown","aaab54f4":"markdown","305ea1f9":"markdown","ae06e515":"markdown"},"source":{"47f21ed6":"import datetime\nprint(\"Notebook was last executed on:\", datetime.date.today())","fb75823e":"import numpy as np\nimport pandas as pd\npd.set_option('display.max_columns', 50)\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score,f1_score,roc_auc_score,confusion_matrix,roc_curve,auc\nfrom sklearn.preprocessing import StandardScaler,PolynomialFeatures\nfrom sklearn.decomposition import PCA\nfrom sklearn.neural_network import MLPClassifier","a844b1af":"bigg_boss = pd.read_csv('\/kaggle\/input\/bigg-boss-india-hindi-telugu-tamil-kannada\/Bigg_Boss_India.csv', encoding = \"ISO-8859-1\")\n! ls -l \/kaggle\/input\/bigg-boss-india-hindi-telugu-tamil-kannada\/Bigg_Boss_India.csv\n\nnRow, nCol = bigg_boss.shape\nprint(f'\\nThere are {nRow} rows and {nCol} columns in the dataset')","435efa78":"bigg_boss.head(5)","f2d41159":"bigg_boss.tail(10).T","fcfc2eca":"bigg_boss.sample(10)","6e3ba56d":"bigg_boss.info()","324e18b5":"bigg_boss.describe()","6d36ace8":"bigg_boss['Season Start Date'] = pd.to_datetime(bigg_boss['Season Start Date'])\nbigg_boss['Season End Date'] = pd.to_datetime(bigg_boss['Season End Date'])\nbigg_boss['Entry Date'] = pd.to_datetime(bigg_boss['Entry Date'])\nbigg_boss['Elimination Date'] = pd.to_datetime(bigg_boss['Elimination Date'])","dbb544d0":"bigg_boss['Finalist'] = bigg_boss['Finalist'].astype(pd.Int32Dtype())\nbigg_boss['Elimination Week Number'] = bigg_boss['Elimination Week Number'].astype(pd.Int32Dtype())\nbigg_boss['Number of Evictions Faced'] = bigg_boss['Number of Evictions Faced'].astype(pd.Int32Dtype())\nbigg_boss['Number of re-entries'] = bigg_boss['Number of re-entries'].astype(pd.Int32Dtype())\nbigg_boss['Number of times elected as Captain'] = bigg_boss['Number of times elected as Captain'].astype(pd.Int32Dtype())\nbigg_boss['Social Media Popularity'] = bigg_boss['Social Media Popularity'].astype(pd.Int32Dtype())\n\nbigg_boss['Prize Money (INR)'] = bigg_boss['Prize Money (INR)'].str.replace(',','')\nbigg_boss['Prize Money (INR)'] = pd.to_numeric(bigg_boss['Prize Money (INR)'])\n\nbigg_boss.info()","e1783236":"# Unique values in each column\nfor col in bigg_boss.columns:\n    print(\"Number of unique values in\", col,\"-\", bigg_boss[col].nunique())","d7283853":"# Number of seasons in all Indian languages\nprint(bigg_boss.groupby('Language')['Season Number'].nunique().sum())\n\n# 37 seasons happened (including current seasons)","2e83d2f0":"# Number of seasons in each Indian language\nprint(bigg_boss.groupby('Language')['Season Number'].nunique().nlargest(10))","8cd500b5":"# Total number of Bigg Boss housemates\nfig = plt.figure(figsize=(10,4))\nax = sns.countplot(x='Language', data=bigg_boss)\nax.set_title('Bigg Boss Series - Indian Language')\nfor t in ax.patches:\n    if (np.isnan(float(t.get_height()))):\n        ax.annotate(0, (t.get_x(), 0))\n    else:\n        ax.annotate(str(format(int(t.get_height()), ',d')), (t.get_x(), t.get_height()*1.01))","8f921844":"# Number of normal entries and wild card entries\nprint(bigg_boss['Wild Card'].value_counts(), \"\\n\")\nprint(round(bigg_boss['Wild Card'].value_counts(normalize=True)*100))\nsns.countplot(x='Wild Card', data=bigg_boss)","6d00c636":"# Common people has many professions, so clubbing them into one category\nbigg_boss['Profession'] = bigg_boss['Profession'].fillna('UNKNOWN')\nbigg_boss.loc[bigg_boss['Profession'].str.contains('Commoner'),'Profession']='Commoner'","3b4745f2":"# Participant's Profession\nprint(bigg_boss['Profession'].value_counts())\nfig = plt.figure(figsize=(25,8))\nsns.countplot(x='Profession', data=bigg_boss)\nplt.xticks(rotation=90)","4e4891ee":"# Broadcastor\nfig = plt.figure(figsize=(20,5))\nax = sns.countplot(x='Broadcasted By', data=bigg_boss, palette='RdBu')\nax.set_title('Bigg Boss Series - Indian Broadcastor & Total Number of Housemates')\nfor t in ax.patches:\n    if (np.isnan(float(t.get_height()))):\n        ax.annotate(0, (t.get_x(), 0))\n    else:\n        ax.annotate(str(format(int(t.get_height()), ',d')), (t.get_x(), t.get_height()*1.01))","9b81d866":"fig = plt.figure(figsize=(15,5))\nax = sns.countplot(bigg_boss['Broadcasted By'].str.split().str.get(0), data=bigg_boss, palette='Set3')\nax.set_title('Bigg Boss Series - Media house')\nfor t in ax.patches:\n    if (np.isnan(float(t.get_height()))):\n        ax.annotate(0, (t.get_x(), 0))\n    else:\n        ax.annotate(str(format(int(t.get_height()), ',d')), (t.get_x(), t.get_height()*1.01))","4f0af306":"# Bigg Boss main hosts and number of seasons they hosted\nbigg_boss.groupby('Host Name')['Season Number'].nunique().nlargest(25)","8a1ff9a1":"# Temporary or Guest host who hosted the week-end episodes\nbigg_boss.groupby('Guest Host Name')['Season Number'].nunique().nlargest(10)","add01505":"# Housemate's Gender\nprint(bigg_boss['Gender'].value_counts(), \"\\n\")\n\n# In percentage\nprint(round(bigg_boss['Gender'].value_counts(normalize=True)*100).astype(int), \"\\n\")","451826ca":"# Maximum TRP of Bigg Boss India seasons\nprint(\"Maximum TRP\",bigg_boss['Average TRP'].max(), \"\\n\")\nprint(bigg_boss.loc[bigg_boss['Average TRP']==bigg_boss['Average TRP'].max()][[\"Language\",\"Season Number\"]].head(1).to_string(index=False))","a6f021e9":"# Longest season of India Bigg Boss seasons\nprint(\"Longest season\",bigg_boss['Season Length'].max(), \"days \\n\")\nprint(bigg_boss.loc[bigg_boss['Season Length']==bigg_boss['Season Length'].max()][[\"Language\",\"Season Number\"]].head(1).to_string(index=False))","66d33e3c":"# Many contestants entered via wild card, but few managed to go to Finale\nbigg_boss.loc[(bigg_boss['Wild Card']=='Yes') & (bigg_boss['Finalist']==1), :]","0c4e21bb":"# All BB Winners\nbigg_boss.loc[bigg_boss.Winner==1]","59e4dd89":"# Sum of prize money won by all BB Season winners\/participants, in India\n\nfrom babel.numbers import format_currency\nprint(format_currency(bigg_boss['Prize Money (INR)'].sum(), 'INR', locale='en_IN'))\n\n# 18 crores and 96 lakh rupees","f186934e":"# Profession of BB Season Winners\nbigg_boss.loc[bigg_boss.Winner==1,'Profession'].value_counts()","3641c8d6":"# Gender of Season title Winners\nprint(bigg_boss.loc[bigg_boss.Winner==1,'Gender'].value_counts(),'\\n')\n\n# In percentage\nprint(round(bigg_boss.loc[bigg_boss.Winner==1,'Gender'].value_counts(normalize=True)*100).astype(int))","eda7b055":"# Entry type of the Season Winners\nbigg_boss.loc[bigg_boss.Winner==1,'Wild Card'].value_counts()","47d4c9dc":"# No re-entered contestant won Bigg Boss title\nbigg_boss.loc[bigg_boss.Winner==1,'Number of re-entries'].value_counts()","56763ab2":"# Number of eliminations or evictions faced by the Bigg Boss competition winners\nbigg_boss.loc[bigg_boss.Winner==1,'Number of Evictions Faced'].value_counts().sort_index()\n\n# Number of eliminations faced - Number of Winners","eb854d30":"# Bigg Boss winners Number of times elected as Captain\nbigg_boss.loc[bigg_boss.Winner==1,'Number of times elected as Captain'].value_counts().sort_index()\n\n# Number of times elected as Captain   - Number of winners","e5a1f4e7":"lang='Kannada'\n\n# All Bigg Boss Kannada Participants\nbigg_boss.loc[(bigg_boss['Language']==lang)]","2531728f":"# Bigg Boss Kannada Winners\nbigg_boss.loc[(bigg_boss['Language']==lang) & (bigg_boss['Winner']==1), :]","bf98f668":"# Bigg Boss Kannada current season participants\nbigg_boss.loc[(bigg_boss['Language']==lang) & (bigg_boss['Season Number']==8), :]","9c9bc7c4":"# Handling NULL values\nbigg_boss.isnull().sum()","bb1b121c":"# Removing records where Name field is empty\nbigg_boss = bigg_boss.loc[bigg_boss.Name.notnull()]\nbigg_boss.reset_index(drop=True,inplace=True)","e556a29e":"# Contestant might have faced at least one eviction, so filling NaN with 'Number of Evictions Faced' with 1\nbigg_boss['Number of Evictions Faced'] = bigg_boss['Number of Evictions Faced'].fillna(1)\n\n# Number of re-entries are very less, so filling NULLs in 'Number of re-entries' with 0\nbigg_boss['Number of re-entries'] = bigg_boss['Number of re-entries'].fillna(0)\n\n# Filling blank values in 'Average TRP' column with average\nbigg_boss['Average TRP'] = bigg_boss['Average TRP'].fillna(bigg_boss['Average TRP'].mean())\n\n# Filling NULLs in 'Number of times elected as Captain' with 0\nbigg_boss['Number of times elected as Captain'] = bigg_boss['Number of times elected as Captain'].fillna(0)","0dbd4cd8":"bigg_boss['Season Starting Year'] = bigg_boss['Season Start Date'].dt.year.astype(pd.Int32Dtype())\nbigg_boss['Season Ending Year'] = bigg_boss['Season End Date'].dt.year.astype(pd.Int32Dtype())\nbigg_boss['Season Starting Quarter'] = bigg_boss['Season Start Date'].dt.quarter.astype(pd.Int32Dtype())\nbigg_boss['Season Ending Quarter'] = bigg_boss['Season End Date'].dt.quarter.astype(pd.Int32Dtype())\nbigg_boss.info()","dc188922":"bigg_boss.head()","f8a118dd":"bigg_boss.tail()","400ed0e9":"# Updating last week-end elimination\/entries manually\n# bigg_boss.iloc[391,23] = 0","c3c7ce50":"train = bigg_boss.loc[(bigg_boss['Winner'].notnull()), :]\ntrain.sample(10)","b901a5b5":"test = bigg_boss.loc[(bigg_boss['Language']==lang) & (bigg_boss['Winner'].isnull()), :]\ntest\n\n# Participants who are still in current Bigg Boss Kannada season","47894474":"BB_Kannada_participants = test[['Name']]\nBB_Kannada_participants.reset_index(drop=True, inplace=True)\nBB_Kannada_participants","67e2f739":"train.drop([\"Name\",\"Entry Date\",\"Elimination Date\",\"Season Start Date\",\"Season End Date\"], axis=1, inplace=True)\ntest.drop([\"Name\",\"Entry Date\",\"Elimination Date\",\"Season Start Date\",\"Season End Date\",\"Winner\"], axis=1, inplace=True)","69268cb9":"train.head()","2894ff69":"test.head(17)","af16b42b":"# Spread of target variable\nprint(train['Winner'].value_counts(normalize=True)*100)","7f27b8f8":"# One Hot Encoding\n\ntarget = train.pop('Winner')\ndata = pd.concat([train, test])\ndummies = pd.get_dummies(data, columns=data.columns, drop_first=True, sparse=True)\ntrain2 = dummies.iloc[:train.shape[0], :]\ntest = dummies.iloc[train.shape[0]:, :]","dc8249c6":"print(train2.shape)\nprint(test.shape)","b485df3e":"train2.isnull().sum().sort_values(ascending=False)","3134d61d":"train2.drop([\"Number of Evictions Faced_15\"], axis=1, inplace=True)\ntest.drop([\"Number of Evictions Faced_15\"], axis=1, inplace=True)","cbd3e526":"train2.head()","98645d6b":"target.values","90fc7ae1":"x_train, x_val, y_train, y_val = train_test_split(train2, target, test_size=0.3, random_state=2021)\nprint(x_train.shape, x_val.shape)","d0666b04":"x_train.isnull().sum().sort_values(ascending=False)","76599def":"def plot_confusion_matrix():\n    cm = confusion_matrix(y_val, y_predicted_val).T\n    cm = cm.astype('float')\/cm.sum(axis=0)\n    ax = sns.heatmap(cm, annot=True, cmap='Blues');\n    ax.set_xlabel('True Label',size=12)\n    ax.set_ylabel('Predicted Label',size=12)","4251fa30":"# Logistic Regression\nfor c in [0.01, 1, 10, 100, 1000]:\n    lr = LogisticRegression(random_state=2021, C=c).fit(x_train, y_train)\n    print (\"F1 score for C=%s: %s\" % (c, f1_score(y_val, lr.predict(x_val), average='weighted')*100))","152c5208":"logi = LogisticRegression(random_state=2021,C=100).fit(x_train, y_train)\nlogi","edb3f322":"predicted_val_logi = logi.predict_proba(x_val)[:, 1]\ny_predicted_val = (predicted_val_logi > 0.3).astype(\"int\").ravel()\nprint('F1 Score -',f1_score(y_val, y_predicted_val, average='weighted')*100)\nprint('Accuracy Score -',accuracy_score(y_val, y_predicted_val)*100)","1cc236fb":"# Confusion Matrix\nplot_confusion_matrix()\n\n# TP 1 TN 0.9","5193c56d":"predicted_val_logi = logi.predict_proba(test)[:, 1]\nwinner_lg = pd.concat([BB_Kannada_participants, pd.DataFrame(predicted_val_logi, columns=['Predicted_Winner'])],axis=1)\nwinner_lg.sort_values('Predicted_Winner',ascending=False)","f034ff63":"# Predicted Winner for Bigg Boss Kannada Season 8, as per LogisticRegression\nwinner_lg.iloc[np.argwhere(winner_lg.Predicted_Winner == np.amax(winner_lg.Predicted_Winner)).flatten().tolist()]","379da7ca":"# RandomForest\nrf = RandomForestClassifier(n_estimators=2000, random_state=2021).fit(x_train, y_train)\nrf","18b48ede":"predicted_val_rf = rf.predict_proba(x_val)[:, 1]\ny_predicted_val = (predicted_val_rf > 0.3).astype(\"int\").ravel()\nprint('F1 Score -',f1_score(y_val, y_predicted_val, average='weighted')*100)\nprint('Accuracy Score -',accuracy_score(y_val, y_predicted_val)*100)","ecbdf01a":"# Confusion Matrix\nplot_confusion_matrix()\n\n# TP 1 TN 0.9","7cf3420f":"predicted_val_rf = rf.predict_proba(test)[:,1]\nwinner_rf = pd.concat([BB_Kannada_participants, pd.DataFrame(predicted_val_rf, columns=['Predicted_Winner'])],axis=1)\nwinner_rf.sort_values('Predicted_Winner',ascending=False)","a9938134":"# Predicted Winner for Bigg Boss Kannada Season 8, as per RandomForest\nwinner_rf.iloc[np.argwhere(winner_rf.Predicted_Winner == np.amax(winner_rf.Predicted_Winner)).flatten().tolist()]","f53f3fda":"## Predicted Winner for Bigg Boss Kannada Season 8, as per Random Forest","6984934b":"## Number of film actress entered into the Bigg Boss houses, are more when compared to other professions ","9e79a53d":"## Malayalam Bigg Boss Season3\n## https:\/\/www.kaggle.com\/thirumani\/predicting-bigg-boss-malayalam-season-3-winner","afdbdaa8":"## Bigg Boss Hindi has many seasons compared to other Indian languages. So, the number of housemates are more in Hindi.","d9094aef":"### Importing Required Python Libraries","c8c0b6d0":"## Predicted Winner for Bigg Boss Kannada Season 8, as per Logistic Regression","b3a43f27":"## Hindi Bigg Boss Season14\n## https:\/\/www.kaggle.com\/thirumani\/predicting-bigg-boss-hindi-season-14-winner","88fd4db0":"### Only 4 Transgenders (LGBT) participated in all Indian languages","f6df0242":"## No wild card entry housemate won the Bigg Boss competition.","1134da45":"### Check and import dataset","41285611":"## Machine Learning Models to predict Indian Bigg Boss season Winners","a2df7e06":"## Exploratory Data Analysis (EDA)","9af7bafe":"## Salman Khan hosted most number of seasons (in Bigg Boss Hindi), Sudeep is next on the list","4d22e1a8":"## Machine Learning Modelling","fe5a6e12":"## In Bigg Boss India seasons, most of the housemates entered in first day\/week","bcc7d8da":"## Tamil Bigg Boss Season4\n## https:\/\/www.kaggle.com\/thirumani\/predicting-bigg-boss-tamil-season-4-winner","a0c43178":"## Predicting Bigg Boss Kannada (\u0cac\u0cbf\u0c97\u0ccd \u0cac\u0cbe\u0cb8\u0ccd \u0c95\u0ca8\u0ccd\u0ca8\u0ca1) Season 8 Winner\n\n\n\n","da1d547e":"## BB Kannada Seasons","4deb83e3":"### About Winners only","395e8e4a":"## Dataset https:\/\/www.kaggle.com\/thirumani\/bigg-boss-india-hindi-telugu-tamil-kannada","aaab54f4":"## In all Bigg Boss languages, and in all seasons, Female contestants are more","305ea1f9":"## Telugu Bigg Boss Season4\n## https:\/\/www.kaggle.com\/thirumani\/predicting-bigg-boss-telugu-season-4-winner","ae06e515":"## Preparing Data for ML modelling"}}