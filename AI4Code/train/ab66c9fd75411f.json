{"cell_type":{"b8b0ae5c":"code","30fb4a78":"code","2d1a1980":"code","b027d3d0":"code","cf00252b":"code","2150d3d5":"code","fe786565":"code","179e4269":"code","d57a3fef":"code","34fa49a0":"code","a277a719":"code","ec8d9260":"code","9a11d862":"code","e7c92b88":"code","f9afb28a":"code","b8c35536":"code","1f2b1af3":"code","cce4d239":"code","2c38f444":"code","ab1e1d33":"code","3ff679a0":"code","75916455":"code","8ab95f82":"code","e502c5a3":"code","a0a17fd5":"code","74696a97":"code","1f616d5d":"code","43d7b3ba":"code","22c47f19":"code","ac15658b":"code","0c49446e":"code","40c1e3e2":"code","92637af5":"code","c4397dfe":"code","88a47621":"code","f9f9e5c8":"code","1dcc800a":"code","15aa5bbe":"code","1de0cf7a":"code","15047bf3":"code","4c05de98":"code","ab654cfd":"code","449e1cfb":"code","c2fd3ae0":"code","e0b59881":"code","0ae8ba71":"code","aa63f06f":"code","7757a9e1":"code","f533ed5f":"code","9c9d61a2":"code","52fe1e19":"code","e10b96d2":"code","0ebad3a7":"code","be7fd36f":"code","3028d690":"code","0818391e":"code","0ee1c7ac":"code","f975887b":"code","62f76e69":"code","c2979c4b":"markdown","4ee0ac37":"markdown"},"source":{"b8b0ae5c":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport statsmodels.api as sm\nimport seaborn as sns\nsns.set()\nfrom sklearn.linear_model import LinearRegression","30fb4a78":"df = pd.read_csv(\"..\/input\/multiple-linear-regressions\/1.02.Multiplelinearregression.csv\")","2d1a1980":"pd.options.display.max_rows = None\ndf","b027d3d0":"df.describe()","cf00252b":"y = df['GPA']\nx1 = df['SAT']","2150d3d5":"x = sm.add_constant(x1)\nresults = sm.OLS(y,x).fit()\nresults.summary()","fe786565":"plt.scatter(x1,y)\nyhat = 0.0017*x1+0.296\nfig = plt.plot(x1,yhat,lw = 4,c = 'yellow',label ='multiple linear regression')\nplt.xlabel('SAT',fontsize =20)\nplt.xlabel('GPA',fontsize =20)\nplt.show()","179e4269":"dum = pd.read_csv(\"..\/input\/dummies-data\/1.03.Dummies.csv\")","d57a3fef":"pd.options.display.max_rows = None\ndum","34fa49a0":"da = dum.copy()","a277a719":"da['Attendance'] = da['Attendance'].map({'Yes' : 1,'No' : 0}) ","ec8d9260":"da","9a11d862":"y = ['GPA']\nx1 = ['SAT'] ","e7c92b88":"gp_data = pd.read_csv(\"..\/input\/multiple-linear-regressions\/1.02.Multiplelinearregression.csv\")","f9afb28a":"gp_data","b8c35536":"gp_data.describe()","1f2b1af3":"x = gp_data[[\"SAT\",\"Rand 1,2,3\"]]\ny = gp_data[\"GPA\"]","cce4d239":"reg = LinearRegression()","2c38f444":"reg.fit(x,y)","ab1e1d33":"reg.coef_","3ff679a0":"reg.intercept_","75916455":"#R squared \n# R^2 adj = 1 - (1 - R^2) * n - 1 \/ n - p - 1\nreg.score(x,y)","8ab95f82":"# n 84 total count\n# p 2 number of predictions\n\nx.shape","e502c5a3":"r2 = reg.score(x,y)\nn = x.shape[0]\np = x.shape[1]\n\nadj_r2 = 1-(1-r2)*(n-1)\/(n-p-1)\nadj_r2","a0a17fd5":"from sklearn.feature_selection import f_regression","74696a97":"f_regression(x,y)","1f616d5d":"p_values = f_regression(x,y)[1]\np_values","43d7b3ba":"p_values.round(3)","22c47f19":"#creating summary\nreg_summary = pd.DataFrame(data = x.columns.values,columns = [\"Features\"])\nreg_summary","ac15658b":"reg_summary[\"Coefficient\"] = reg.coef_\nreg_summary[\"p_values\"] = p_values.round(3)","0c49446e":"reg_summary","40c1e3e2":"from sklearn.preprocessing import StandardScaler","92637af5":"scaler = StandardScaler()","c4397dfe":"scaler.fit(x)","88a47621":"x_scaled = scaler.transform(x)","f9f9e5c8":"x_scaled","1dcc800a":"reg = LinearRegression()\nreg.fit(x_scaled,y)","15aa5bbe":"reg.coef_","1de0cf7a":"reg.intercept_","15047bf3":"reg_summary = pd.DataFrame([[\"BIAS\"],[\"SAT\"],[\"Rand 1,2,3\"]],columns = [\"Features\"])\nreg_summary[\"Weights\"] = reg.intercept_ ,reg.coef_[0],reg.coef_[1]","4c05de98":"reg_summary","ab654cfd":"new_data = pd.DataFrame(data = [[1700,2],[1800,1]],columns = [\"SAT\",\"Rand 1,2,3\"])","449e1cfb":"new_data","c2fd3ae0":"reg.predict(new_data)","e0b59881":"new_scaled  =scaler.transform(new_data)","0ae8ba71":"new_scaled","aa63f06f":"reg.predict(new_scaled)","7757a9e1":"from sklearn.model_selection import train_test_split","f533ed5f":"a = np.arange(1,101)\nb = np.arange(501,601)","9c9d61a2":"a","52fe1e19":"b","e10b96d2":"train_test_split(a)","0ebad3a7":"a_train,a_test , b_train,b_test = train_test_split(a,b,test_size = 0.2,random_state = 42)","be7fd36f":"a_train.shape, a_test.shape","3028d690":"a_train","0818391e":"a_test","0ee1c7ac":"b_test","f975887b":"b_train","62f76e69":"b_train.shape, b_test.shape","c2979c4b":"TRAIN TEST SPLIT","4ee0ac37":"AUTO LINEAR REGRESSION"}}