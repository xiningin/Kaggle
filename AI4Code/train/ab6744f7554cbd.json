{"cell_type":{"7bc95b94":"code","260e4409":"code","fb16e2bf":"code","f712e8ab":"code","bd985f36":"code","5d964c08":"code","51f9ee4c":"code","3cae5596":"code","2a69146e":"code","598cc0bd":"code","7e917eaa":"code","737986ee":"code","9b9fc232":"code","6946d918":"code","7d6ecfc6":"code","e9d04b51":"code","5a86b54c":"code","d55ca753":"code","4e397a2b":"code","f823f899":"code","91c777d8":"code","5856c05d":"code","d3a2334a":"code","d574270f":"code","799a4eb1":"code","7feace4c":"code","eb7b1a39":"code","80a2d466":"code","5b03f1bf":"code","2f893399":"code","b9d24a94":"code","5cc87f12":"code","7c979a94":"code","298387db":"code","c33dd47e":"code","a2ad6fab":"code","ffc21545":"code","d50a778a":"code","06b2a9f7":"code","665c90d2":"code","5349a255":"code","d1d57af5":"code","79785bb7":"code","bfc5dd85":"code","15a4d721":"code","d0e6902e":"code","c9f15d45":"code","8696499e":"code","f01e6278":"code","e146d766":"code","de087d45":"code","96a9b263":"code","5c9937c1":"code","b646a45a":"code","c6f47652":"code","4944219c":"code","0c0e4e98":"code","c0a9c06f":"code","9526b8d5":"code","b3326f3d":"code","d8a3462a":"code","d8a2e442":"code","ef2e9c12":"code","6d50aaea":"code","8cb7cf55":"code","2834cbbf":"code","3b573fba":"code","d216438f":"code","17d8f66a":"code","b1ed6796":"code","f6d6150a":"code","f5e78007":"code","f0cd01c4":"code","8610001b":"code","a428c334":"code","5f1cb097":"code","297f5d1e":"code","3b38b5bf":"code","9a3a4f14":"code","db154aa4":"code","89fa3d3d":"code","79e67bd1":"code","7e77e84e":"code","229753fc":"code","4a5ad60a":"code","a060a423":"code","ba13bc66":"code","b9b8e379":"code","23fb5e20":"code","08fbafdb":"code","cec115f8":"code","2a04a48e":"code","1e7f6cd4":"code","e2237907":"code","13a4a822":"code","f707c665":"code","ab85f824":"code","7765f2d6":"code","9990cca3":"code","f0c2b0b1":"code","45fa909a":"code","c3965ecc":"code","229a28dc":"code","a81b696a":"code","482157ff":"code","de1e4a6f":"code","b2608dcc":"code","e30c81a9":"code","5c0d5cac":"code","e674c2b3":"code","b99df82d":"code","245ef421":"code","b2c5f783":"code","8a63219f":"code","05c27f59":"code","8051b28c":"code","56eecb6a":"code","d9e8585b":"code","0542a3ac":"code","253df57c":"code","e4f21146":"code","9147aa05":"code","8a1551ff":"code","858010cd":"code","a03a78c2":"code","fa4be588":"code","bf8f1a3f":"code","b5c04638":"code","731eb4c6":"code","6d29fa33":"code","0f1590a6":"code","5f50ab8b":"code","3a80ed2a":"code","5bb4daa5":"code","dab552b9":"code","57793fe7":"code","79cc24bc":"code","e154fda4":"code","8ae9067c":"code","3cacd3f2":"code","44f54c86":"code","1deb6842":"code","64a18f73":"code","2ba3d9dd":"code","925494d7":"code","3c176f81":"code","39cff19f":"code","a5630ff3":"code","752c83ae":"code","06128bc6":"code","b14b4609":"code","3ec9a86d":"code","9ddecf3e":"code","eb1f2f9b":"code","b5f068f5":"markdown","1a77a928":"markdown","0733e7d7":"markdown","6b16652b":"markdown","b5041a73":"markdown","c651c898":"markdown","c84967c8":"markdown","23a2091a":"markdown","e28296f8":"markdown","b3659f97":"markdown","2ac61be6":"markdown","2a48f5e4":"markdown","23fdef75":"markdown","cdb22ae7":"markdown","7e5b2f4e":"markdown","fafc08cf":"markdown","c71234ad":"markdown","e6bdd05a":"markdown","f3be4724":"markdown","037b594b":"markdown","76854c44":"markdown","35f93387":"markdown","c4a90e35":"markdown","9c658b3f":"markdown","6ac7ee02":"markdown","dfd9cf30":"markdown","3f135b02":"markdown","923faf50":"markdown","fdd68ad1":"markdown","0127baf4":"markdown","1b32a530":"markdown","0f4e9e82":"markdown","01f0af64":"markdown","e64cc41c":"markdown","168c1c91":"markdown","9f9ed15a":"markdown","0278cf2d":"markdown","b26d8420":"markdown","7ddbd873":"markdown","81f46570":"markdown","5dc5a154":"markdown","a0d8adb4":"markdown","759105bb":"markdown","b592024e":"markdown","c8ed3fad":"markdown","0107736e":"markdown","1ca5f545":"markdown","6060abe4":"markdown","54d63789":"markdown","ca25de9c":"markdown","d9155c98":"markdown","1d3e0229":"markdown","e5681b62":"markdown","3dde1a2a":"markdown","3901b4ac":"markdown","8a4e1192":"markdown","2681b771":"markdown","6ba60a6a":"markdown","dce52e79":"markdown","903da11d":"markdown","12a175fd":"markdown","9e3e001f":"markdown","7defcccf":"markdown","4268324b":"markdown","b66f1a38":"markdown","caef8e6c":"markdown","14c3346f":"markdown","565cddb8":"markdown","d88f4e9a":"markdown","1f11017b":"markdown","4eab1620":"markdown","f634a012":"markdown","018b21f1":"markdown","95a2315e":"markdown","8790e55a":"markdown","872e126e":"markdown","18476a17":"markdown","0dfa1492":"markdown","c64cd9ca":"markdown","017f46da":"markdown","afd8eedb":"markdown","875cbb79":"markdown","96ca61d2":"markdown","6966745c":"markdown","ad1af17d":"markdown","ef198d49":"markdown"},"source":{"7bc95b94":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n#Visualization\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib.gridspec as gridspec\n# Plotly for interactive graphics \nimport plotly.graph_objs as go\nfrom plotly.offline import init_notebook_mode, iplot\nimport plotly.express as px\n\nfrom collections import Counter\n\n\n#Accuracy Score,MSE,ROC_Curve,Confusion Matrix\nfrom sklearn.metrics import accuracy_score,mean_squared_error,roc_curve,roc_auc_score,classification_report,r2_score,confusion_matrix\n#train test split, Grid Search CV\nfrom sklearn.model_selection import train_test_split,cross_val_score,ShuffleSplit,GridSearchCV\n\n#Disabling the warnings\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","260e4409":"churn = pd.read_csv(\"\/kaggle\/input\/churn-modelling\/Churn_Modelling.csv\")\nchurn.head()","fb16e2bf":"df = churn.copy()\ndf.info() # As we can see there is not any NaN values, this sounds perfect but there can be other problems with columns.","f712e8ab":"columns =[\"RowNumber\",\"CustomerId\",\"Surname\"]\ndf = df.drop(columns,axis = 1)\ndf.head()","bd985f36":"len(df.columns)","5d964c08":"#To change the gender column to 1 and 0:\ndf.Gender = [1 if each == 'Male' else 0 for each in df.Gender]\ndf.head()","51f9ee4c":"#To change the Geography column to numerical:\nGeography = [None] * len(df['Geography'])\nfor i in range(len(df['Geography'])):\n    if df['Geography'][i] == 'Germany':\n        Geography[i] = 0\n    elif df['Geography'][i] == 'France':\n        Geography[i] = 1\n    else:\n        Geography[i] = 2\n        \ndf['New_Geography'] = Geography\ndf.sample(10)","3cae5596":"df.describe().T","2a69146e":"# Looking at the empty \/ non values in the columns so that it makes easier  decide and to interpret  which columns can we use\ndf.isna() ","598cc0bd":"# Examining amount of non-values \n\ndf.isna().sum()","7e917eaa":"df[[\"Gender\",\"Exited\"]].groupby([\"Gender\"],as_index = False).mean().sort_values(by=\"Exited\",ascending = False)\n# Examining Exit rates of Gender Exit rates of females are higher than males","737986ee":"df[[\"New_Geography\",\"Exited\"]].groupby([\"New_Geography\"],as_index = False).mean().sort_values(by=\"Exited\",ascending = False)\n# Examining Exit amounts according to countries Germany with the highest exited amount among countries","9b9fc232":"df[[\"CreditScore\",\"Exited\"]].groupby([\"CreditScore\"],as_index = False).mean().sort_values(by=\"Exited\",ascending = False)\n# Examining Exit according to Credit rates","6946d918":"df[[\"Age\",\"Exited\"]].groupby([\"Age\"],as_index = False).mean().sort_values(by=\"Exited\",ascending = False)\n#Yas gruplarina gore en fazla cikislar orta yaslarda oluyor ve gencler ile yaslilarda cikis orani pek yuksek degil.","7d6ecfc6":"df[[\"Tenure\",\"Exited\"]].groupby([\"Tenure\"],as_index = False).mean().sort_values(by=\"Exited\",ascending = False)\n# Tenure does not give clear information","e9d04b51":"df[[\"Balance\",\"Exited\"]].groupby([\"Balance\"],as_index = False).mean().sort_values(by=\"Exited\",ascending = False)\n# Examining relation of balance and exited","5a86b54c":"df[[\"NumOfProducts\",\"Exited\"]].groupby([\"NumOfProducts\"],as_index = False).mean().sort_values(by=\"Exited\",ascending = False)\n# Although there is no linear proportion, the exited increases in general as the number of products increases.","d55ca753":"df[[\"HasCrCard\",\"Exited\"]].groupby([\"HasCrCard\"],as_index = False).sum().sort_values(by=\"Exited\",ascending = False)\n# Values of the exited column does not change according to whether or not a person has card","4e397a2b":"df[[\"IsActiveMember\",\"Exited\"]].groupby([\"IsActiveMember\"],as_index = False).sum().sort_values(by=\"Exited\",ascending = False)\n#aktif uye olanlar bir tik cikisa daha meyilli","f823f899":"df[[\"EstimatedSalary\",\"Exited\"]].groupby([\"EstimatedSalary\"],as_index = False).mean().sort_values(by=\"Exited\",ascending = False)\n#maas ile cikis egilimi oranli degil.","91c777d8":"def detect_outliers(df,features):\n    outlier_indices = []\n    \n    for c in features:\n        # 1st quartile\n        Q1 = np.percentile(df[c],25)\n        # 3rd quartile\n        Q3 = np.percentile(df[c],75)\n        # IQR\n        IQR = Q3 - Q1\n        # Outlier step\n        outlier_step = IQR * 1.5\n        # detect outlier and their indeces\n        outlier_list_col = df[(df[c] < Q1 - outlier_step) | (df[c] > Q3 + outlier_step)].index\n        # store indeces\n        outlier_indices.extend(outlier_list_col)\n    \n    outlier_indices = Counter(outlier_indices)\n    multiple_outliers = list(i for i, v in outlier_indices.items() if v > 2)\n    \n    return multiple_outliers","5856c05d":"df.loc[detect_outliers(df,[\"Age\",\"Gender\",\"CreditScore\",\"Exited\"])]","d3a2334a":"# If we have some drop outliers, we could drop them\ndf = df.drop(detect_outliers(df,[\"Age\",\"Gender\",\"CreditScore\",\"Exited\"]),axis = 0).reset_index(drop = True)","d574270f":"plt.style.use(\"ggplot\")\nf,ax=plt.subplots(figsize = (8,8))\n# corr() is actually pearson correlation\nsns.heatmap(df.corr(),annot= True,linewidths=0.5,fmt = \".1f\",ax=ax)\nplt.xticks(rotation=90)\nplt.yticks(rotation=0)\nplt.title('Correlation Map')\nplt.show()","799a4eb1":"# Tum kolonlara gore uyguladik ve Exited' hangi kolonlar arasi yogun iliski oldugunu gozlemlemeyi amacladik.\nranked_data = df.rank()\nspearman_corr = ranked_data.loc[:,:].corr(method= \"pearson\")\nprint(\"Spearman's correlation: \")\nprint(spearman_corr)","7feace4c":"plt.figure(figsize = (12,6)) \nsns.countplot(x=\"HasCrCard\",hue = \"New_Geography\", data=df, palette=\"husl\");\nprint(df.groupby('Geography')[\"HasCrCard\"].sum())","eb7b1a39":"#df.groupby('Geography')['EstimatedSalary'].mean()\navarage_salaries = df.groupby(\"New_Geography\").mean()[\"EstimatedSalary\"]\nprint(\"Avarage Salaries according to Countries:\\n\", avarage_salaries)","80a2d466":"plt.figure(figsize = (14,8));\nsns.catplot(x='Geography',\n            y = \"EstimatedSalary\",\n            hue=\"Exited\",\n            col=\"Gender\",\n            aspect=1.2,height=5,\n            kind=\"swarm\", data=df);","5b03f1bf":"# Another visualization about salary effect\nfig = px.box(df, x=\"New_Geography\", y = \"EstimatedSalary\",color = 'Exited');\nfig.update_layout(title_text=\"The country with the mean salary-With Outliers(Exited-Not Exited groups)\")\nfig.show();","2f893399":"plt.figure(figsize = (14,8)) \nplt.xticks(rotation=90)\nplt.title('Credit Card Usage for Ages',color = 'blue',fontsize=15)\nsns.countplot(x=df[\"Age\"],hue = 'HasCrCard',data=df);\nplt.xlabel('Ages')\nplt.ylabel('Number of Credit Card Users');","b9d24a94":"fig = px.box(df, x=\"HasCrCard\", y = \"Age\",color = 'Exited');\nfig.update_layout(title_text=\"Credit Card Usage & Age - With Outliers(Exited-Not Exited groups)\")\nfig.show();","5cc87f12":"fig = px.parallel_categories(df, dimensions=['Gender', 'Geography', 'Exited'],\n                color=\"Exited\", color_continuous_scale=px.colors.sequential.Inferno,\n                labels={'Gender':'Gender(Female,Male)', 'Exited':'Exited(0:No,1:Yes)'})\nfig.update_layout(title_text=\"Gender-Geography-Exited-Not Exited Schema\")\nfig.show();","7c979a94":"fig = px.parallel_categories(df, dimensions=['Gender','HasCrCard',\"IsActiveMember\", 'Exited'],\n                color=\"Exited\", color_continuous_scale=px.colors.sequential.Inferno,\n                labels={'HasCrCard':'Has Credit Card', 'Gender':'Gender(Female,Male)', 'Exited':'Exited(0:No,1:Yes)'})\nfig.update_layout(title_text=\"Credit Card-Gender-Exited-Not Exited Schema\")\nfig.show(); ","298387db":"df.groupby(\"New_Geography\")[\"CreditScore\"].mean()\nfig = px.box(df, x=\"New_Geography\", y = \"CreditScore\",color = 'Exited');\nfig.update_layout(title_text=\"The country with the highest credit score(mean)-With Outliers(Exited-Not Exited groups)\")\nfig.show();","c33dd47e":"plt.figure(figsize = (14,8));\nsns.catplot(x='New_Geography',\n            y = \"CreditScore\",\n            hue=\"Exited\",\n            col=\"IsActiveMember\",\n            aspect=1.2,height=5,\n            kind=\"swarm\", data=df);","a2ad6fab":"plt.figure(figsize = (14,8));\nsns.catplot(x='New_Geography',\n            y = \"CreditScore\",\n            hue=\"Exited\",\n            col=\"Gender\",\n            aspect=1.2,height=5,\n            kind=\"swarm\", data=df);","ffc21545":"plt.figure(figsize = (16,6)) \nplt.xticks(rotation=45)\nsns.scatterplot(x=df['Age'],y = df[\"CreditScore\"],hue = \"Gender\",data=df);","d50a778a":"plt.figure(figsize = (16,6)) \nplt.xticks(rotation=45)\nsns.scatterplot(x=df['Age'],y = df[\"CreditScore\"],hue = \"Exited\",data=df);","06b2a9f7":"df[df[\"CreditScore\"]<405]['Exited'].value_counts()","665c90d2":"plt.figure(figsize = (16,6)) \nplt.xticks(rotation=45)\nsns.countplot(x=df[\"Age\"],hue = 'Exited',data=df, palette=\"husl\");\nplt.xlabel('Age')\nplt.ylabel('Number of customers (Exited or not)');","5349a255":"below_30 = df[df[\"Age\"]<30]\nbetween_30_40 = df[(df[\"Age\"]>=30) & (df[\"Age\"]<40)]\nbetween_40_50 = df[(df[\"Age\"]>=40) & (df[\"Age\"]<50)]\nbetween_50_60 = df[(df[\"Age\"]>=50) & (df[\"Age\"]<60)]\nbetween_60_70 = df[(df[\"Age\"]>=60) & (df[\"Age\"]<70)]\nabove_70 = df[(df[\"Age\"]>=70)]\n\n\n\nk = below_30[\"Exited\"].sum()\nl = between_30_40[\"Exited\"].sum()\nm = between_40_50[\"Exited\"].sum()\nn = between_50_60[\"Exited\"].sum()\no = between_60_70[\"Exited\"].sum()\np = above_70[\"Exited\"].sum()","d1d57af5":"f,ax = plt.subplots(figsize=(15, 15))\nplt.subplot(6,1,1)\nsns.countplot(x=below_30[\"Age\"],hue = 'Exited',data=df, palette=\"husl\");\nplt.xlabel('Age')\nplt.ylabel('Customers (Exited)');\nplt.xticks(rotation= 30)\n\nplt.subplot(6,1,2)\nsns.countplot(x=between_30_40[\"Age\"],hue = 'Exited',data=df, palette=\"husl\");\nplt.xlabel('Age')\nplt.ylabel('Customers (Exited)');\nplt.xticks(rotation= 30)\n\n\nplt.subplot(6,1,3)\nsns.countplot(x=between_40_50[\"Age\"],hue = 'Exited',data=df, palette=\"husl\");\nplt.xlabel('Age')\nplt.ylabel('Customers (Exited)');\nplt.xticks(rotation= 30);\n\nplt.subplot(6,1,4)\nsns.countplot(x=between_50_60[\"Age\"],hue = 'Exited',data=df, palette=\"husl\");\nplt.xlabel('Age')\nplt.ylabel('Customers (Exited)');\nplt.xticks(rotation= 30);\n\nplt.subplot(6,1,5)\nsns.countplot(x=between_60_70[\"Age\"],hue = 'Exited',data=df, palette=\"husl\");\nplt.xlabel('Age')\nplt.ylabel('Customers (Exited)');\nplt.xticks(rotation= 30);\n\nplt.subplot(6,1,6)\nsns.countplot(x=above_70[\"Age\"],hue = 'Exited',data=df, palette=\"husl\");\nplt.xlabel('Age')\nplt.ylabel('Customers (Exited)');\nplt.xticks(rotation= 30);","79785bb7":"age_list = [('Total Stayed=',below_30['Exited'].value_counts()[:1],\"Ages below 30==>\",k,\"Exited\"),\n            ('Total stayed=',between_30_40['Exited'].value_counts()[:1],'Ages between 30-40==>',l,\"Exited\"),\n            ('Total stayed=',between_40_50['Exited'].value_counts()[:1],\"Ages between 40-50==>\",m,\"Exited\"),\n            ('Total stayed=',between_50_60['Exited'].value_counts()[:1],\"Ages between 50-60==>\",n,\"Exited\"),\n            ('Total stayed=',between_60_70['Exited'].value_counts()[:1],\"Ages between 60-70==>\",o,\"Exited\"),\n            ('Total stayed=',above_70['Exited'].value_counts()[:1],\"Ages above 70==>\",p,\"Exited\")]","bfc5dd85":"##### Plotly Pie Graph for Visualizing Percentage of Age Groups with Working A Bank \n\npie_list=[k,l,m,n,o,p]\nlabels=age_list\nfig={\n    \"data\":[\n        {\n            \"values\":pie_list,\n            \"labels\":labels,\n            \"domain\": {\"x\": [.2, 1]},\n            \"name\": \"Age Groups-Exit Rate\",\n            \"hoverinfo\":\"label+percent+name\",\n            \"hole\": .4,\n            \"type\": \"pie\"\n        },],\n    \"layout\":{\n        \"title\":\"Percentage of Age Groups for Longer Work With Bank\",\n        \"annotations\":[\n            {\n                \"font\":{\"size\":20},\n                \"showarrow\": False,\n                \"text\": \"Age Group-Exited\",\n                \"x\": 0.60,\n                \"y\": 0.50\n            },\n        ]\n    }  \n}\niplot(fig)\n","15a4d721":"plt.figure(figsize = (16,6)) \nplt.xticks(rotation=45)\nsns.barplot(x=df['New_Geography'],y = df[\"Exited\"],hue = \"Gender\",data=df, palette=\"husl\");\nplt.ylabel('Percetage of people (Exited %)');","d0e6902e":"plt.figure(figsize = (16,6)) \nplt.xticks(rotation=45)\nsns.countplot(x=df[\"New_Geography\"],hue = 'Exited',data=df, palette=\"husl\");\nplt.xlabel('Geo')\nplt.ylabel('Number of customers (Exited or not)');","c9f15d45":"print(\"Total Number of People By Geography\\n\",df[\"Geography\"].value_counts())\nprint(\"Number of People Exited By Geography\\n\",df[df['Exited']==1][\"Geography\"].value_counts(),'\\n')\nprint(\"Number of People Exited By Gender in Germany \\n\",df[(df['Exited']==1)&(df['Geography']=='Germany')][\"Gender\"].value_counts())\nprint(\"Number of People Exited By Gender in France \\n\",df[(df['Exited']==1)&(df['Geography']=='France')][\"Gender\"].value_counts())\nprint(\"Number of People Exited By Gender in Spain \\n\",df[(df['Exited']==1)&(df['Geography']=='Spain')][\"Gender\"].value_counts())","8696499e":"plt.figure(figsize = (16,6)) \nplt.xticks(rotation=45)\nsns.scatterplot(x='Age',y = \"EstimatedSalary\",hue = \"Exited\",data=df);","f01e6278":"df = churn.copy()","e146d766":"age_group_data = [None] * len(df['Age'])\nfor i in range(len(df['Age'])):\n    if df['Age'][i] < 30:\n        age_group_data[i] = 'Young'\n    elif df['Age'][i] >=30 and df['Age'][i] < 40:\n        age_group_data[i] = 'Young-Adults'\n    elif df['Age'][i] >=40 and df['Age'][i] < 50:\n        age_group_data[i] = 'Adults'\n    elif df['Age'][i] >=50 and df['Age'][i] < 60:\n        age_group_data[i] = 'Elderly-Adults'\n    elif df['Age'][i] >=60 and df['Age'][i] < 74:\n        age_group_data[i] = 'Old'\n    else:\n        age_group_data[i] = 'Very-Old'\n\ndf['age_group'] = age_group_data","de087d45":"Credit = [None] * len(df['CreditScore'])\nfor i in range(len(df['CreditScore'])):\n    if df['CreditScore'][i] < 405:\n        Credit[i] = 0\n    else:\n        Credit[i] = 1\n        \ndf['new_credit'] = Credit","96a9b263":"df['new_credit'].value_counts()","5c9937c1":"g = sns.factorplot(x = \"new_credit\", y = \"Exited\", data = df, kind = \"bar\")\nplt.xticks(rotation=45)\ng.set_ylabels(\"Exited\")\nplt.show()","b646a45a":"age74 = df[(df[\"Age\"]>=74)]\nage74[\"Exited\"].value_counts()\n# We dropped the 2 lines that is outlier of the above 71 ages.\ndf.drop([3110,3531],axis =0,inplace = True)","c6f47652":"g = sns.factorplot(x = \"age_group\", y = \"Exited\", data = df, kind = \"bar\")\nplt.xticks(rotation=45)\ng.set_ylabels(\"Exited\")\nplt.show()","4944219c":"gender_dummies = df.replace(to_replace={'Gender': {'Female': 0,'Male':1}})\na = pd.get_dummies(df['Geography'], prefix = \"Geo_dummy\")\nc = pd.get_dummies(df['age_group'], prefix = \"Age_dummy\")","0c0e4e98":"frames = [gender_dummies,a,c]  \ndf = pd.concat(frames, axis = 1)\ndf = df.drop([\"RowNumber\",\"Geography\",\"Surname\",\"CustomerId\",'Age','age_group','Geography',\"CreditScore\"],axis = 1)","c0a9c06f":"x = df.drop([\"Exited\"],axis = 1) #Independent value\ny = df[\"Exited\"] #Depended value ","9526b8d5":"# data normalization with sklearn\nfrom sklearn.preprocessing import MinMaxScaler\n\n# fit scaler on training data\nnorm = MinMaxScaler().fit(x)\n\n# transform independent data\nx_norm = norm.transform(x)\n\n####Generally code yourself ===>>>        x = (x-np.min(x))\/(np.max(x)-np.min(x)).values","b3326f3d":"x_train,x_test,y_train,y_test = train_test_split(x_norm,y,test_size = 0.3, random_state = 42)","d8a3462a":"from sklearn.linear_model import LogisticRegression","d8a2e442":"log_reg = LogisticRegression().fit(x_train,y_train)\ny_pred = log_reg.predict(x_test)\nlog_model = (accuracy_score(y_test,y_pred)*100)\nlog_model","ef2e9c12":"y_probs = log_reg.predict_proba(x_test)[:,1]\ny_pred = [1 if i >0.53 else 0 for i in y_probs]\nlog_proba_score = (accuracy_score(y_test,y_pred)*100)\nprint (\"log score=\",log_proba_score)","6d50aaea":"confusion_matrix(y_test,y_pred)","8cb7cf55":"log_params = {\"C\":np.logspace(-3,3,7),\n              \"penalty\": [\"l1\",\"l2\"],\n              \"max_iter\":[10,50,500,1000]} #\"solver\":['lbfgs', 'liblinear', 'sag', 'saga'],\nlog =LogisticRegression()\nlog_cv = GridSearchCV(log,log_params,cv = 10)\n\nlog_tuned = log_cv.fit(x_train,y_train)\nlog_tuned.best_params_","2834cbbf":"log_reg_tuned = LogisticRegression(C=100,max_iter=50,penalty='l2',solver='liblinear').fit(x_train,y_train)\ny_probs = log_reg.predict_proba(x_test)[:,1]\ny_pred = [1 if i >0.53 else 0 for i in y_probs]","3b573fba":"log_tuned_score = (accuracy_score(y_test,y_pred)*100)\nprint (\"log tuned score=\",log_tuned_score)","d216438f":"lr_cm = confusion_matrix(y_test,y_pred)\nlr_cm","17d8f66a":"from sklearn.naive_bayes import GaussianNB","b1ed6796":"nb = GaussianNB()\ngnb_model = nb.fit(x_train,y_train)\ngnb_model","f6d6150a":"y_pred = gnb_model.predict(x_test)\nnb_score = (accuracy_score(y_test,y_pred)*100)\nnb_score","f5e78007":"nb_params = {'var_smoothing': np.logspace(0,-9, num=100)}","f0cd01c4":"nb =GaussianNB()\nnb_cv = GridSearchCV(nb,nb_params,cv = 10)\n\nnb_cv = nb_cv.fit(x_train,y_train)\nnb_cv.best_params_","8610001b":"nb_tuned =GaussianNB(var_smoothing=0.43287612810830584).fit(x_train,y_train)\ny_pred = nb_tuned.predict(x_test)\nnb_tuned = (accuracy_score(y_test,y_pred)*100)\nnb_tuned","a428c334":"nb_cm = confusion_matrix(y_test,y_pred)","5f1cb097":"from sklearn.neighbors import KNeighborsClassifier","297f5d1e":"knn =KNeighborsClassifier()\nknn_model = knn.fit(x_train,y_train)\nknn_model","3b38b5bf":"y_pred = knn_model.predict(x_test)\nknn_score = (accuracy_score(y_test,y_pred)*100)\nknn_score","9a3a4f14":"knn_params = {\"n_neighbors\":np.arange(1,50),\n              \"weights\": [\"uniform\",\"distance\"],\n              \"metric\":[\"euclidean\",\"manhattan\"]}","db154aa4":"knn =KNeighborsClassifier()\nknn_cv = GridSearchCV(knn,knn_params,cv = 10)\nknn_cv = knn_cv.fit(x_train,y_train)","89fa3d3d":"print(\"Best Parameters:\"+str(knn_cv.best_params_))","79e67bd1":"knn_final =KNeighborsClassifier(n_neighbors =15,metric='manhattan',weights='distance')\nknn_final = knn_final.fit(x_train,y_train)\ny_pred = knn_final.predict(x_test)\nknn_tuned = (accuracy_score(y_test,y_pred)*100)\nknn_tuned","7e77e84e":"knn_cm = confusion_matrix(y_test,y_pred)\nknn_cm","229753fc":"from sklearn.svm import SVC","4a5ad60a":"svm_model_linear = SVC(kernel='linear').fit(x_train,y_train)\nsvm_model_poly = SVC(kernel='poly').fit(x_train,y_train)\nsvm_model_rbf = SVC(kernel='rbf').fit(x_train,y_train)","a060a423":"y_pred_linear = svm_model_linear.predict(x_test)\ny_pred_poly = svm_model_poly.predict(x_test)\ny_pred_rbf = svm_model_rbf.predict(x_test)","ba13bc66":"print(accuracy_score(y_test,y_pred_linear))\nprint(accuracy_score(y_test,y_pred_poly))\nprint(accuracy_score(y_test,y_pred_rbf))","b9b8e379":"svc_params = {\"C\": [1,5,10,50,100,200],\n              'kernel':['poly','rbf'],\n              \"gamma\": [0.001, 0.01, 0.1,0.5],}\n                 \nsvc = SVC()\nsvc_cv_model = GridSearchCV(svc,svc_params,\n                            cv = 5,\n                           n_jobs = -1,\n                           verbose = 2)\nsvc_cv_model.fit(x_train,y_train)\nprint(\"Best Parameters:\"+str(svc_cv_model.best_params_))","23fb5e20":"svc_tuned = SVC(kernel = \"poly\",C=100,gamma=0.5).fit(x_train,y_train)","08fbafdb":"y_pred = svc_tuned.predict(x_test)\nsvc_tuned_score = (accuracy_score(y_test,y_pred)*100)\nsvc_tuned_score","cec115f8":"confusion_matrix(y_test,y_pred)","2a04a48e":"svc_rbf_tuned = SVC(kernel = \"rbf\",C=100,gamma=0.1).fit(x_train,y_train)\ny_pred = svc_rbf_tuned.predict(x_test)","1e7f6cd4":"svc_rbf_score = (accuracy_score(y_test,y_pred)*100)\nsvc_rbf_score","e2237907":"svm_cm = confusion_matrix(y_test,y_pred)\nsvm_cm","13a4a822":"from sklearn.ensemble import RandomForestClassifier","f707c665":"r_for = RandomForestClassifier().fit(x_train,y_train)\nr_for","ab85f824":"y_pred = r_for.predict(x_test)\nrf_score = accuracy_score(y_test,y_pred)\nrf_score","7765f2d6":"rf_params  = {'max_depth':list(range(1,10)),\n             \"max_features\":[\"log2\",\"auto\",\"sqrt\"],\n             \"n_estimators\":[2,10,20,50,150,300],\n             'criterion' : ['gini','entropy'],\n             'min_samples_leaf' : [1,3,5,10]}","9990cca3":"rf_model = RandomForestClassifier()","f0c2b0b1":"rf_cv_model = GridSearchCV(rf_model,\n                           rf_params,\n                           cv = 5,\n                           n_jobs = -1)","45fa909a":"rf_cv_model.fit(x_train,y_train)\nrf_cv_model.best_params_","c3965ecc":"rf_tuned = RandomForestClassifier(max_depth = 10,\n                                  criterion = 'gini',\n                                  max_features = 'log2',\n                                  min_samples_leaf = 1,\n                                  n_estimators = 150,random_state=42)\nrf_tuned = rf_tuned.fit(x_train,y_train)\ny_pred  = rf_tuned.predict(x_test)\nrf_tuned_score = (accuracy_score(y_test,y_pred)*100)\nrf_tuned_score","229a28dc":"rf_cm = confusion_matrix(y_test,y_pred)\nrf_cm","a81b696a":"from sklearn.ensemble import GradientBoostingClassifier","482157ff":"gbm = GradientBoostingClassifier()\ngbm_model = gbm.fit(x_train,y_train) \ngbm_model","de1e4a6f":"y_pred = gbm_model.predict(x_test)\ngbm_score = accuracy_score(y_test,y_pred)*100\ngbm_score","b2608dcc":"gbm_params = {\"learning_rate\" : [0.001, 0.01, 0.1, 0.2],\n             \"n_estimators\": [100,200,300,500,1000],\n             \"max_depth\": [1,3,5,10],\n             \"min_samples_split\": [1,2,5,10]}\ngbm = GradientBoostingClassifier()\nclf = GridSearchCV(gbm,gbm_params,verbose=0,n_jobs=-1,cv=3)\ngb = clf.fit(x_train,y_train)\ngb.best_params_ ","e30c81a9":"gbm = GradientBoostingClassifier(n_estimators=100,min_samples_split=5,max_depth=3,learning_rate=0.2,random_state=42)\ngbm.fit(x_train,y_train)\ny_pred = gbm.predict(x_test)\ngbm_tuned_score = accuracy_score(y_test,y_pred)*100\ngbm_tuned_score","5c0d5cac":"gbm_cm = confusion_matrix(y_test,y_pred)\ngbm_cm","e674c2b3":"#!pip install xgboost\nfrom xgboost import XGBClassifier","b99df82d":"xgb = XGBClassifier(n_estimators=100)\nxgb_model = xgb.fit(x_train,y_train) \nxgb_model","245ef421":"y_pred = xgb_model.predict(x_test)\nxgb_score = accuracy_score(y_test,y_pred)*100\nxgb_score","b2c5f783":"xgb_params ={\n        'n_estimators': [50, 100, 200],\n        'subsample': [ 0.6, 0.8, 1.0],\n        'max_depth': [1,2,3,4],\n        'learning_rate': [0.1,0.2, 0.3, 0.4, 0.5],\n        \"min_samples_split\": [1,2,4,6]}","8a63219f":"xgb = XGBClassifier()\nxgb = GridSearchCV(xgb,xgb_params,verbose=0,n_jobs=-1,cv=3)\nxgb = xgb.fit(x_train,y_train)\nxgb.best_params_","05c27f59":"xgbm_cv = XGBClassifier(learning_rate=0.3,\n                       max_depth=2,\n                       min_samples_split=1,\n                       n_estimators=100,\n                       subsample=1.0,random_state=42).fit(x_train,y_train)","8051b28c":"y_pred = xgbm_cv.predict(x_test)\nxgbm_score = (accuracy_score(y_test,y_pred)*100)\nxgbm_score","56eecb6a":"xgbm_cm = confusion_matrix(y_test,y_pred)\nxgbm_cm","d9e8585b":"from lightgbm import LGBMClassifier","0542a3ac":"lgbm = LGBMClassifier().fit(x_train,y_train)\ny_pred = lgbm.predict(x_test)","253df57c":"lgbm_score = (accuracy_score(y_test,y_pred)*100)\nlgbm_score","e4f21146":"lgbm_params = {\"learning_rate\" : [0.001,0.01, 0.1],\n             \"n_estimators\": [100,200,300,500,1000],\n             \"max_depth\": [2,3,5,7],\n             \"min_child_samples\": [1,3,5,7]}\nlgbm = LGBMClassifier()\nlgbm_cv = GridSearchCV(lgbm,lgbm_params,verbose=0,n_jobs=-1,cv=5)\nlgbm_cv_model = lgbm_cv.fit(x_train,y_train)\nlgbm_cv_model.best_params_","9147aa05":"lgbm = LGBMClassifier(learning_rate=0.01,max_depth=5,min_child_samples=5,n_estimators=400)\nlgbm_tuned = lgbm.fit(x_train,y_train)\ny_pred = lgbm_tuned.predict(x_test)\nlgbm_tuned_acc = (accuracy_score(y_test,y_pred)*100)\nlgbm_tuned_acc","8a1551ff":"lgbm_cm = confusion_matrix(y_test,y_pred)\nlgbm_cm","858010cd":"from catboost import CatBoostClassifier","a03a78c2":"cat_model = CatBoostClassifier().fit(x_train,y_train)\ny_pred = cat_model.predict(x_test)","fa4be588":"cat_score = accuracy_score(y_test,y_pred)\ncat_score","bf8f1a3f":"cat_params = {\"iterations\":[100,200,500,700],\n              'loss_function': ['Logloss', 'CrossEntropy'],\n              \"learning_rate\":[0.01,0.02,0.1],\n              \"depth\":[1,3,5,8]}","b5c04638":"catb =  CatBoostClassifier()\ncatb_cv_model = GridSearchCV(catb,cat_params,cv = 5,n_jobs = -1,verbose = 2)\ncatb_cv_model.fit(x_train,y_train)\ncatb_cv_model.best_params_","731eb4c6":"catb_final = CatBoostClassifier(depth=5,iterations=500,learning_rate=0.02,loss_function= 'Logloss')\ncatb_final = catb_final.fit(x_train,y_train)","6d29fa33":"y_pred = catb_final.predict(x_test)\ncatb_final_score =(accuracy_score(y_test,y_pred)*100)\ncatb_final_score ","0f1590a6":"catb_cm = confusion_matrix(y_test,y_pred)\ncatb_cm","5f50ab8b":"## We will use also scaler for improving the score of ML algorithms\nfrom sklearn.preprocessing import StandardScaler\nscaler = StandardScaler().fit(x)\nx_scaled = scaler.transform(x)","3a80ed2a":"x_train,x_test,y_train,y_test = train_test_split(x_scaled,y,\n                                                test_size = 0.30,\n                                                random_state = 42)","5bb4daa5":"knn_params = {\"n_neighbors\":np.arange(1,50),\n              \"weights\": [\"uniform\",\"distance\"],\n              \"metric\":[\"euclidean\",\"manhattan\"]}\n\nknn =KNeighborsClassifier()\nknn_cv = GridSearchCV(knn,knn_params,cv = 5)\nknn_cv = knn_cv.fit(x_train,y_train)\nprint(\"Best Parameters:\"+str(knn_cv.best_params_))","dab552b9":"knn_scaled =KNeighborsClassifier(n_neighbors =29,metric='manhattan',weights='distance')\nknn_scaled = knn_scaled.fit(x_train,y_train)\ny_pred = knn_scaled.predict(x_test)\nknn_sscore = (accuracy_score(y_test,y_pred)*100)\nknn_sscore","57793fe7":"knn_scaled_conf = confusion_matrix(y_test,y_pred)\nknn_scaled_conf","79cc24bc":"svm_scaled_linear = SVC(kernel='linear').fit(x_train,y_train)\nsvm_scaled_poly = SVC(kernel='poly').fit(x_train,y_train)\nsvm_scaled_rbf = SVC(kernel='rbf').fit(x_train,y_train)","e154fda4":"y_pred_slinear = svm_scaled_linear.predict(x_test)\ny_pred_spoly = svm_scaled_poly.predict(x_test)\ny_pred_srbf = svm_scaled_rbf.predict(x_test)\n\nprint(accuracy_score(y_test,y_pred_slinear))\nprint(accuracy_score(y_test,y_pred_spoly))\nprint(accuracy_score(y_test,y_pred_srbf))","8ae9067c":"svc_params = {\"C\": [10,50,100,500,700],\n              'kernel':['poly','rbf'],\n              \"gamma\": [0.001, 0.01, 0.1]} \n                 \nsvc = SVC()\nsvc_cv_model = GridSearchCV(svc,svc_params,\n                            cv = 5,\n                           n_jobs = -1,\n                           verbose = 2)\nsvc_cv_model.fit(x_train,y_train)\nprint(\"Best Parameters:\"+str(svc_cv_model.best_params_))","3cacd3f2":"svc_scaled = SVC(kernel = 'rbf',C = 500, gamma = 0.01)\nscaled = svc_scaled.fit(x_train,y_train)\ny_pred = scaled.predict(x_test)","44f54c86":"svm_scaled_score = (accuracy_score(y_test,y_pred)*100)\nsvm_scaled_score","1deb6842":"svc_scaled_conf = confusion_matrix(y_test,y_pred)\nsvc_scaled_conf","64a18f73":"rf_params  = {'max_depth':list(range(1,11)),\n             \"max_features\":[\"log2\",\"auto\",\"sqrt\"],\n             \"n_estimators\":[2,10,20,50,150,300],\n             'criterion' : ['gini','entropy'],\n             'min_samples_leaf' : [1,3,5,10]}","2ba3d9dd":"rf_model = RandomForestClassifier(random_state = 42)\nrf_cv_model = GridSearchCV(rf_model,\n                           rf_params,\n                           cv = 5,\n                           n_jobs = -1)\nrf_cv_model.fit(x_train,y_train)\nrf_cv_model.best_params_","925494d7":"rf_tuned = RandomForestClassifier(max_depth = 10,\n                                  criterion = 'gini',\n                                  max_features = 'log2',\n                                  min_samples_leaf = 1,\n                                  n_estimators = 150,random_state = 42)\nrf_tuned = rf_tuned.fit(x_train,y_train)\ny_pred  = rf_tuned.predict(x_test)\nrf_scaled_score = (accuracy_score(y_test,y_pred)*100)\nrf_scaled_score","3c176f81":"rf_scaled_conf = confusion_matrix(y_test,y_pred)\nrf_scaled_conf","39cff19f":"lgbm_params = {\"learning_rate\" : [0.01, 0.02,0.1],\n             \"n_estimators\": [100,200,300,500,1000],\n             \"max_depth\": [2,3,5,7],\n             \"min_child_samples\": [1,2,5,10]}\nlgbm = LGBMClassifier()\nlgbm_cv = GridSearchCV(lgbm,lgbm_params,verbose=0,n_jobs=-1,cv=5)\nlgbm_cv_model = lgbm_cv.fit(x_train,y_train)\nlgbm_cv_model.best_params_","a5630ff3":"lgbm = LGBMClassifier(learning_rate=0.02,max_depth=5,min_child_samples=5,n_estimators=500,random_state = 42)\nlgbm_tuned = lgbm.fit(x_train,y_train)\ny_pred = lgbm_tuned.predict(x_test)\nlgbm_scaled_acc = (accuracy_score(y_test,y_pred)*100)\nlgbm_scaled_acc","752c83ae":"lgbm_scaled_conf = confusion_matrix(y_test,y_pred)\nlgbm_scaled_conf","06128bc6":"logit_roc_auc = roc_auc_score(y_test,log_reg_tuned.predict(x_test))\n\nfpr, tpr, tresholds = roc_curve(y_test,log_reg_tuned.predict_proba(x_test)[:,1])\nplt.figure(figsize=(6,6))\nplt.plot(fpr,tpr,label = \"AUC (area = %0.2f)\"%logit_roc_auc)\nplt.plot([0,1],[0,1],\"r--\")\nplt.xlim([0.0,1.0])\nplt.ylim([0.0,1.0])\nplt.xlabel(\"False Positive Ratio\")\nplt.ylabel(\"True Positive Ratio\")\nplt.title('ROC Curve');","b14b4609":"from sklearn.metrics import roc_auc_score\nroc_auc_score(y_test,y_probs)","3ec9a86d":"fig = plt.figure(figsize=(15,15))\n\nax1 = fig.add_subplot(4, 4, 1) # row, column, position\nax1.set_title('Logistic Regression Classification')\n\nax2 = fig.add_subplot(4, 4, 2) # row, column, position\nax2.set_title('KNN Classification')\n\nax3 = fig.add_subplot(4, 4, 3)\nax3.set_title('SVM Classification')\n\nax4 = fig.add_subplot(4, 4, 4)\nax4.set_title('Naive Bayes Classification')\n\nax5 = fig.add_subplot(4, 4, 5)\nax5.set_title('Random Forest Classification')\n\nax6 = fig.add_subplot(4, 4, 6)\nax6.set_title('GBM Classification')\n\nax7 = fig.add_subplot(4, 4, 7)\nax7.set_title('LightGBM Classification')\n\nax8 = fig.add_subplot(4, 4, 8)\nax8.set_title('XGBoost Classification')\nax9 = fig.add_subplot(4, 4, 9)\nax9.set_title('CatBoost Classification')\n\nax10 = fig.add_subplot(4, 4, 10)\nax10.set_title('KNN Scaled Classification')\n\nax11 = fig.add_subplot(4,4, 11)\nax11.set_title('SVC Scaled Classification')\n\nax12 = fig.add_subplot(4,4, 12)\nax12.set_title('Random Forest Scaled Classification')\n\nax13 = fig.add_subplot(4, 4, 13)\nax13.set_title('LightGBM Scaled Classification')\n\n\nsns.heatmap(data=lr_cm, annot=True, linewidth=0.7, linecolor='cyan', fmt='.0f', ax=ax1, cmap='magma')\nsns.heatmap(data=knn_cm, annot=True, linewidth=0.7, linecolor='cyan', fmt='.0f', ax=ax2, cmap='magma') \nsns.heatmap(data=svm_cm, annot=True, linewidth=0.7, linecolor='cyan', fmt='.0f', ax=ax3, cmap='magma')\nsns.heatmap(data=nb_cm, annot=True, linewidth=0.7, linecolor='cyan', fmt='.0f', ax=ax4, cmap='magma')\nsns.heatmap(data=rf_cm, annot=True, linewidth=0.7, linecolor='cyan', fmt='.0f', ax=ax5, cmap='magma')\nsns.heatmap(data=gbm_cm, annot=True, linewidth=0.7, linecolor='cyan', fmt='.0f', ax=ax6, cmap='magma')\nsns.heatmap(data=lgbm_cm, annot=True, linewidth=0.7, linecolor='cyan', fmt='.0f', ax=ax7, cmap='magma')\nsns.heatmap(data=xgbm_cm, annot=True, linewidth=0.7, linecolor='cyan', fmt='.0f', ax=ax8, cmap='magma')\nsns.heatmap(data=catb_cm, annot=True, linewidth=0.7, linecolor='cyan', fmt='.0f', ax=ax9, cmap='magma')\nsns.heatmap(data=knn_scaled_conf, annot=True, linewidth=0.7, linecolor='cyan', fmt='.0f', ax=ax10, cmap='magma')\nsns.heatmap(data=svc_scaled_conf, annot=True, linewidth=0.7, linecolor='cyan', fmt='.0f', ax=ax11, cmap='magma')\nsns.heatmap(data=rf_scaled_conf, annot=True, linewidth=0.7, linecolor='cyan', fmt='.0f', ax=ax12, cmap='magma')\nsns.heatmap(data=lgbm_scaled_conf, annot=True, linewidth=0.7, linecolor='cyan', fmt='.0f', ax=ax13, cmap='magma')\nplt.show()","9ddecf3e":"indexx = [\"Log\",\"RF\",\"KNN\",\"SVM\",\"NB\",\"GBM\",\"LightGBM\",\"XGBoost\",'CatBoost',\"KNN Scaled\",\"SVM Scaled\", 'RF Scaled',\"LightGBM Scaled\"]\nregressions = [log_tuned_score,rf_tuned_score,knn_tuned,svc_rbf_score,nb_tuned,gbm_tuned_score,\n               lgbm_tuned_acc,xgbm_score,catb_final_score,knn_sscore,svm_scaled_score,rf_scaled_score,lgbm_scaled_acc]\n\nplt.figure(figsize=(12,8))\nsns.barplot(x=indexx,y=regressions)\nplt.xticks(rotation=45)\nplt.title('Model Comparision',color = 'green',fontsize=20);","eb1f2f9b":"pie_list=regressions\nlabels=list(zip(indexx,regressions))\nfig={\n    \"data\":[\n        {\n            \"values\":pie_list,\n            \"labels\":labels,\n            \"domain\": {\"x\": [.2, 1]},\n            \"name\": \"Models-Accuracy Score\",\n            \"hoverinfo\":\"label+percent+name\",\n            \"hole\": .4,\n            \"type\": \"pie\"\n        },],\n    \"layout\":{\n        \"title\":\"Accuracy Scores\",\n        \"annotations\":[\n            {\n                \"font\":{\"size\":20},\n                \"showarrow\": False,\n                \"text\": \"Age Group-Exited\",\n                \"x\": 0.60,\n                \"y\": 0.50\n            },\n        ]\n    }  \n}\niplot(fig)","b5f068f5":"* Confusion Matrix","1a77a928":"### Confusion Matrix","0733e7d7":"### Tuning","6b16652b":"<a id = \"16\"><\/a><br>\n### The gender with the highest credit score","b5041a73":"### Confusion Matrix","c651c898":"## Churn Modelling\n\n### Introduction\n#### This data set contains details of a bank's customers and the target variable is a binary variable reflecting the fact whether the #### customer left the bank (closed his account) or he continues to be a customer.\n","c84967c8":"<a id = \"6\"><\/a><br>\n## Basic Data Analysis\n* Gender & Exited\n* Geography & Exited\n* CreditScore & Exited\n* Age & Exited\n* Tenure & Exited\n* Balance & Exited\n* NumOfProducts & Exited\n* HasCrCard & Exited\n* IsActiveMember & Exited\n* EstimatedSalary & Exited","23a2091a":"### Support Vector Machines","e28296f8":"<a id = \"50\"><\/a><br>\n# CONCLUSION\u00b6\n* Cat Boost model has the higest accuracy rate (87.33333333333333)\n* Cat Boost model is really successfull at catchin true positives conf matrix =>>>(2356,73)(307,264)\n* GBM model is succesfull at catching false positives conf matrix ==> (2339, 90) (297, 274)\n* Nearly all models made improvement for model tuning.\n* In some models we can see the difference between normalized models and standart scaler models.\n* The best model is depends which part of target you have(true-positive\/false-positive)","b3659f97":"<a id = \"14\"><\/a><br>\n### Rates of credit card\u2019s usage according to gender","2ac61be6":"### Confusion Matrix","2a48f5e4":"<a id = \"19\"><\/a><br>\n### Customers leaving the bank\n    * Female \u2013 Male rates\n    * Age distribution\n    * Salary distribution\n","23fdef75":"### Model Tuning","cdb22ae7":"* Logistic Regression ROC Curve","7e5b2f4e":"### Random Forest","fafc08cf":"#### Polinomal kernel(poly)","c71234ad":"* Around %20 of people exited.\n* Females exited proportionally and numerically more (1139 Feamle\/898 Male)\n* Germans proportionally and numerically exited most(448 Female - 366 Male)\n* French female numerically exited more (460)\n* Frenchs continued with a bank numerically and proportionally most(5014 - 810 => 4196)","e6bdd05a":"<a id = \"18\"><\/a><br>\n### Customers in which age range work longer with their banks","f3be4724":"### Tuning","037b594b":"## 4. SVM (Support Vector Machines)","76854c44":"### Confusion Matrix Comparison","35f93387":"<a id = \"22\"><\/a><br>\n### Feature Engineering","c4a90e35":"<a id = \"12\"><\/a><br>\n### The country with the highest salary","9c658b3f":"As we can see our Roc curve is not much close to left top corner. This means our prediction score is a bit lover than expected.","6ac7ee02":"## 5. Random Forest","dfd9cf30":"## KNN","3f135b02":"### Tuning","923faf50":"### Model Tuning","fdd68ad1":"## Standart Scaler Effect","0127baf4":"* float64(2): Balance and EstimatedSalary\n* int64(5): RowNumber, CustomerId, CreditScore, Age, Tenure, NumOfProducts, HasCrCard, IsActiveMember  and **Exited** \n* object(5): Geography,Surname and Gender","1b32a530":"### Content: \n\n1. [Load and Check Data](#1)\n1. [Variable Description](#2)\n    * [Univariate Variable Analysis](#3)\n        * [Categorical Variable](#4)\n        * [Numerical Variable](#5)\n1. [Basic Data Analysis](#6)\n1. [Outlier Detection](#7)\n1. [Visualization](#8)\n    * [Pearson Korelasyon for all the columns](#9)\n    * [Spearman](#10)\n    * [Countries with the less and the most common use of credit cards](#11)\n    * [The country with the highest salary](#12)\n    * [Visualization of credit card\u2019s usage according to ages](#13)\n    * [Rates of credit card\u2019s usage according to gender](#14)\n    * [The country with the highest credit score](#15)\n    * [The gender with the highest credit score](#16)\n    * [The range of age with the highest credit score](#17)\n    * [Customers in which age range work longer with their banks](#18)\n    * [Customers leaving the bank](#19)\n        * [Female \u2013 Male rates](#20)\n        * [Age distribution](#21)\n        * [Salary distribution](#22)       \n1. [Modeling](#29)\n    * [Train - Test Split](#30)\n    * [Simple Logistic Regression](#31)\n    * [Hyperparameter Tuning -- Grid Search -- Cross Validation](#32) \n    * [Ensemble Modeling](#33)\n    * [Prediction and Submission](#34)\n1. [Conclusion](#50)\n  \n<!-- 1. [Feature Engineering](#21)\n    * [Name -- Title](#22)\n    * [Family Size](#23)\n    * [Embarked](#24)\n    * [Ticket](#25)\n    * [Pclass](#26)\n    * [Sex](#27)\n    * [Drop Passenger ID and Cabin](#28) -->\n","0f4e9e82":"### Tuning","01f0af64":"<a id = \"3\"><\/a><br>\n## Univariate Variable Analysis\n\n* Categorical Variable: HasCrCard, IsActiveMember, Geography and Gender\n* Numerical Variable: RowNumber, Balance, CustomerId, CreditScore, Age, Tenure, NumOfProducts, EstimatedSalary and Exited","e64cc41c":"* Confusion Matrix","168c1c91":"## 7. XGBoost","9f9ed15a":"## 3) Building ML Models\n### Interpretation of variables\n### Preparing variables for model building\n    * Building dependent and undependent variables\n    * Determining Train and Test sets\n### Building a model\n    * Trying all models of the learning algorithms\n    * Setting the parameters\n    * Determining best parameters\n    * Doing Cross validation\n    * Finding Acury score\n    * The most effective variables will be determined in each model\n### Comparing the models\n    * Visualization of all models\u2019 acury score\n    * The model that gives the best results will be determined\n    * Research will be done on the mathematical algorithm that creates the best model.","0278cf2d":"* Salary does not any effect on exit rates.","b26d8420":"## 1. Logistic Regression","7ddbd873":"## 6. Gradient Boosting Machines (GBM)","81f46570":"* As we can see the customers without credit card exited 39-52 most(median=45)\n* Credit card owners also same beahivor, exited ages 38-51 most(median=45)\n* As a result for age variable credit card usage does not effect the exit decison directly. This can may be the occur fot that reason in most cases banks give credit card to customers automaticly.","5dc5a154":"* Salary has no effect on exit decision","a0d8adb4":"* Credit card users and non credit card users accumulated between 25-45 ages. The amount of people credit card owners and others stable in all ages.","759105bb":"### Confusion Matrix","b592024e":"<a id = \"8\"><\/a><br>\n## Visualization\n* Pearson Korelasyon for all the columns\n* Spearman\n* Countries with the less and the most common use of credit cards\n* The country with the highest salary\n* Visualization of credit card\u2019s usage according to ages\n* Rates of credit card\u2019s usage according to gender\n* The country with the highest credit score\n* The gender with the highest credit score\n* The range of age with the highest credit score\n* Customers in which age range work longer with their banks\n* Customers leaving the bank\n* Female \u2013 Male rates\n* Age distribution\n* Salary distribution","c8ed3fad":"### Confusion Matrix","0107736e":"* Proba values - probability of the target\/Creating optimum decision boundary(Exited-or-Not)","1ca5f545":"* Age has great effect on exit decision than other variables. that is obvious ages between 45 and 65 are exited most.","6060abe4":"<a id = \"15\"><\/a><br>\n### The country with the highest credit score","54d63789":"### Gaussian NB","ca25de9c":"### Model Score Comparison","d9155c98":"## 3. KNN","1d3e0229":"* Logistic Regression (Same as the normalized method)\n* Navie Bayes (Worse than normalized method)","e5681b62":"### Tuning","3dde1a2a":"<a id = \"11\"><\/a><br>\n### Countries with the less and the most common use of credit cards\n* As we can see the table below; the number of people using credit card for countries nearly same.(because France population is doubled others.)","3901b4ac":"#### Confusion Matrix","8a4e1192":"## LightGBM","2681b771":"* The credit score is same for genders in all countries.","6ba60a6a":"## Creating Variables-Normalization","dce52e79":"<a id = \"21\"><\/a><br>\n#### Salary Distribution (Leaving Bank)","903da11d":"### Confusion Matrix","12a175fd":"<a id = \"13\"><\/a><br>\n### Visualization of credit card\u2019s usage according to ages","9e3e001f":"### 9. Cat-Boost","7defcccf":"<a id = \"20\"><\/a><br>\n   #### Female-Male Rates(leaving bank)","4268324b":"* Gradient Boosting Machines (GBM) (Same as normalized model)\n* XGBoost (Same as normalized model)\n* CatBoost (Same as normalized model)","b66f1a38":"### Confusion Matrix","caef8e6c":"* As we can see there is outliers below 400 credit scores in different countries. On contrast Credit score does not any direct effect on exit rates.\n* Unactive members exited more.\n* Germans Exited more.","14c3346f":"### Goal:\n\n    * Explore and clean the data\n    * Make lots of visualization for deep understanding of the data\n    * Use Machine Learning Algorithms for make predictions about if a customer left the bank or not.","565cddb8":"<a id = \"9\"><\/a><br>\n### Pearson Correlation for all the columns","d88f4e9a":"## 8. Light GBM","1f11017b":"### Confusion Matrix","4eab1620":"<a id = \"2\"><\/a><br>\n## Variable Description\n\n1. Surname : The surname of the customer\n2. CreditScore : The credit score of the customer\n3. Geography : The country of the customer(Germany\/France\/Spain)\n4. Gender : The gender of the customer (Female\/Male)\n5. Age : The age of the customer\n6. Tenure : The customer's number of years in the in the bank\n7. Balance : The customer's account balance\n8. NumOfProducts : The number of bank products that the customer uses\n9. HasCrCard : Does the customer has a card? (0=No,1=Yes)\n10. IsActiveMember : Does the customer has an active mebership (0=No,1=Yes)\n11. EstimatedSalary : The estimated salary of the customer\n12. Exited : Churned or not? (0=No,1=Yes)","f634a012":"* Gender is scattered all age groups homojenous.\n* The most important thing is that ==>All 21 people who has Credit score under 405 are exited.\n* The max credit score (850) is seen nearly all age groups. The credit score also more homojenous for all age groups.\n* In the mid- ages the credit score is around 650. The credit score does not direct effect the exit decision. On the other hand between 45-56 ages exit rates and credit rates are getting more volatile.","018b21f1":"<a id = \"1\"><\/a><br>\n## Load and Check Data","95a2315e":"* Credit Score\nWe will create a boundary line for credit score. Because the credit score has no effect on exit rates that boundary(405) is create two groups and we predict if a person below this boundary then it will precisely exit.","8790e55a":"## 2. Naive Bayes","872e126e":" <a id = \"7\"><\/a><br>\n ## Outlier Detection","18476a17":"## Final Chapter - Models Comparison","0dfa1492":"### Model Tuning","c64cd9ca":"#### Radial basis function kernel(rbf)","017f46da":"<a id = \"17\"><\/a><br>\n### The range of age with the highest credit score","afd8eedb":"<a id = \"10\"><\/a><br>\n### Spearman","875cbb79":"* As we can see the table above how the categories effect exiting decision:\n* Females and unactive members more prone to exit.\n* Credit card users are also a bit more prone to exit than non credit card users.","96ca61d2":"* Age group 45-65 cikma orani en yuksek grup. bu grupta ayni zamanlarda kadin erkek sayisinin da yakin\/estit degerde oldugu gozlemliyoruz.\n* Bu nendenle gruplarimizi uc ayri grup olarak ayiracagiz. 45 den asagisi, 45-65 arasi, 65den yukarsi (hatta 74 ten yukarisi da ayri bir grup olabilir)","6966745c":"Age\n* We will create new age groups for improve our perdiction score.","ad1af17d":"### Tuning","ef198d49":"## Creating Dummy Variables"}}