{"cell_type":{"4297b195":"code","233d46e6":"code","3c192d46":"code","f591f8c1":"code","43ed7e86":"code","505669f3":"code","bea684e8":"code","4c8b4954":"markdown"},"source":{"4297b195":"# \u5bfc\u5165\u5404\u7c7b\u5305\nimport pandas as pd #\u6570\u636e\u8bfb\u5165\nfrom sklearn.linear_model import LogisticRegression # LR\u7b97\u6cd5\nfrom sklearn.feature_extraction.text import CountVectorizer # \u6570\u636e\u9884\u5904\u7406","233d46e6":"!ls ..\/input\/new_data\/new_data","3c192d46":"# \u5bfc\u5165\u6570\u636e\ndf_train = pd.read_csv('..\/input\/new_data\/new_data\/train_set.csv')\ndf_test = pd.read_csv('..\/input\/new_data\/new_data\/test_set.csv')\ndf_train.drop(columns=['article','id'],inplace=True)\ndf_test.drop(columns=['article'],inplace=True)","f591f8c1":"# \u6570\u636e\u5904\u7406\nvectorizer = CountVectorizer(ngram_range=(1,2),min_df=3,max_df=0.9,max_features=100000)\nvectorizer.fit(df_train['word_seg'])\nx_train = vectorizer.transform(df_train['word_seg'])\nx_test = vectorizer.transform(df_test['word_seg'])\ny_train = df_train['class']-1","43ed7e86":"# \u4f7f\u7528LR\u7b97\u6cd5\n# \u5176\u4ed6\u53ef\u4ee5\u5c1d\u8bd5\u7684\u7b97\u6cd5\uff1a\u6734\u7d20\u8d1d\u53f6\u65af\u3001xgb\u3001svm\u7b49\u7b49\uff0c\u6ca1\u5c1d\u8bd5\uff0c\u4f46\u4f30\u8ba1\u8fd0\u7b97\u65f6\u95f4\u4f1a\u7206\u70b8\nlg = LogisticRegression(C=4,dual=True)\nlg.fit(x_train,y_train)","505669f3":"# \u9884\u6d4b\ny_test = lg.predict(x_test)","bea684e8":"# \u8f93\u51fa\u7ed3\u679c\ndf_test['class'] = y_test.tolist()\ndf_test['class'] = df_test['class'] + 1\ndf_result = df_test.loc[:,['id','class']]\ndf_result.to_csv('.\/result.csv',index=False)","4c8b4954":"# \u897f\u74dc\u4e66\u8bad\u7ec3\u8425 \u7b2c\u4e8c\u5929\u8bfe\u7a0b \u4ee3\u7801\n\u91c7\u7528\u8fbe\u89c2\u676f\u6587\u672c\u667a\u80fd\u5904\u7406\u6311\u6218\u8d5b\u6570\u636e\n\n\u7531\u4e8e\u5176\u4ed6\u540c\u5b66\u6765\u8bf4\u767e\u5ea6\u4e91\u4e0b\u8f7d\u592a\u6162\uff0c\u4e14\u4e2a\u4eba\u7535\u8111\u8ba1\u7b97\u6709\u9650\n\n\u6545\u642c\u8fd0\u5230kaggle\u4e14\u9644\u5e26\u539f\u7248\u8001\u5e08\u7ed9\u51fa\u7684\u4ee3\u7801\n\n\n\u6574\u7406\u4eba\uff1a\u5b66\u751f-M\u5c0f\u767d\n\n\u4e2a\u4eba\u7f51\u7ad9 www.mwhitelab.com"}}