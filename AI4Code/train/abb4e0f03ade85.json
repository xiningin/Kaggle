{"cell_type":{"c72c22ba":"code","f31ed568":"code","aa64a6f4":"code","0bebce4b":"code","7532a460":"code","30b230b2":"code","d98b120a":"code","a5effb0c":"code","f0636d81":"code","b59a38b3":"code","16e702a7":"code","3de33c95":"code","2a2e434b":"code","911de5db":"code","387fe674":"code","37bde76a":"code","bf49100a":"code","46185682":"code","f968024f":"code","73702208":"code","67b7f29d":"code","87842dfc":"code","3aafe86a":"code","69be29e1":"code","36330da7":"code","f908c299":"code","e010babe":"code","03ff4779":"code","1dd18e79":"code","008f5fde":"code","a31a4eab":"code","0550b235":"code","d2b285cf":"code","3639fe53":"code","0d363a46":"code","8fa3f6ff":"code","5cc75d8d":"code","1111c569":"code","536f9bc3":"code","e06699b6":"code","a919bd98":"code","7264b2b6":"code","e60f2357":"code","106a4634":"code","34549bca":"code","dd13058e":"code","e23e20aa":"code","b0d4cf0e":"code","3cf8c2a0":"code","0973d7f7":"code","77cd5efd":"code","cb900bbc":"code","28d0e1e6":"code","50853d6f":"code","e120b658":"code","a32a3f3d":"code","363a3354":"code","70f469c2":"markdown","b0bdd8a2":"markdown","94534c6f":"markdown","d38e8a0c":"markdown","fad4117b":"markdown","69398c28":"markdown","c86792b3":"markdown","fbce873f":"markdown","c2b05770":"markdown","77c7b143":"markdown","a4bf4e81":"markdown","90d998ad":"markdown","d899d43b":"markdown","3f1b1e78":"markdown","80f5d745":"markdown","b2f63438":"markdown","d8ab3cdb":"markdown","c7085cb1":"markdown","6312a216":"markdown","adfedaf8":"markdown","a90ff87d":"markdown","03b21684":"markdown","14f2661a":"markdown","99718ea3":"markdown","460103b8":"markdown","bb68a953":"markdown","86440ca0":"markdown","fc734702":"markdown","82bfe635":"markdown","c6efb656":"markdown","40a8fac4":"markdown","f977080c":"markdown","8f84cc66":"markdown","a93094fd":"markdown","817a4e7a":"markdown","d075a972":"markdown","15518dd1":"markdown","25776c6e":"markdown","48dd4bc6":"markdown","daff0460":"markdown"},"source":{"c72c22ba":"import pandas as pd  # To read the dataset as dataframe\nimport seaborn as sns # For Data Visualization \nimport matplotlib.pyplot as plt # Necessary module for plotting purpose\n%matplotlib inline \nsns.set(color_codes=True) # In order to have uniformity in output plots\nfrom scipy.stats import * # import all the methods of scipy.stats module\nfrom statsmodels.stats.proportion import proportions_ztest # for proportion test","f31ed568":"df = pd.read_csv(\"..\/input\/insurance\/insurance.csv\")","aa64a6f4":"df.shape","0bebce4b":"df.dtypes","7532a460":"df.info()","30b230b2":"df.isnull().sum()","d98b120a":"import numpy as np\ndf.select_dtypes('number')[~df.select_dtypes('number').applymap(np.isreal).all(1)]\n\n# One can see that all the mumeric data is valid and we are good to go..!","a5effb0c":"df[df.select_dtypes('number').columns].describe()[-5:]","f0636d81":"sns.boxplot(data = df['age'])\nplt.title(\"Graphical 5 pioint summary for age attribute\");","b59a38b3":"sns.boxplot(data = df['bmi'])\nplt.title(\"Graphical 5 pioint summary for bmi attribute\");","16e702a7":"sns.boxplot(data = df['children'])\nplt.title(\"Graphical 5 pioint summary for children attribute\");","3de33c95":"sns.boxplot(data = df['charges'])\nplt.title(\"Graphical 5 pioint summary for charges attribute\");","2a2e434b":"# plotting univariate distribution for bmi attribute\nsns.distplot(df['bmi'],rug=True)\nplt.title('distribution for bmi attribute');\n\n# The distribution for bmi attribute follows a normal distribution","911de5db":"# plotting univariate distribution for age attribute\nsns.distplot(df['age'])\nplt.title('distribution for age attribute');\n\n# One can oberve that the distribution for age attribute in this case seems to follow uniform-like distribution","387fe674":"# plotting univariate distribution for charges attribute\nsns.distplot(df['charges'])\nplt.title('distribution for charges attribute');\n\n# Distribution for charges atrribute is right-skewed normal-like distribution","37bde76a":"df[['bmi','age','charges']].skew()","bf49100a":"# Let us check whether the distribution types using formulaes\n\nx = df[df.select_dtypes('number').columns].describe()[-5:].transpose()\n","46185682":"# since x is a dataframe let us calculate values for below quantities\n# m1 = Median \u2013 Xsmallest \n# m2 = Xlargest \u2013 Median\n# m3 = Q1 \u2013 Xsmallest\n# m4 = Xlargest \u2013 Q3\n# m5 = Median \u2013 Q1\n# m6 = Q3 \u2013 Median\n\nm1 = x['50%']-x['min']\nm2 = x['max']-x['50%']\nm3 = x['25%'] - x['min']\nm4 = x['max'] - x['75%']\nm5 = x['50%'] - x['25%']\nm6 = x['75%'] - x['50%']","f968024f":"d = {'m1':m1,'m2':m2,'m3':m3,'m4':m4,'m5':m5,'m6':m6}\nxd = pd.DataFrame(data=d)\nxd.head()","73702208":"from scipy.stats import zscore\n\n\ndf_bac = df[['bmi','age','charges']]\n\ndf_bacz = df_bac.apply(zscore)\n\ndf_bacz.head()","67b7f29d":"sns.boxplot(data=df_bacz);\n\n# We can see that age column do not show any outliers, whereas bmi and charges columns show outliers over third\n# quartile i.e., Q3.","87842dfc":"# Let us plot the boxplot for bmi attribute\nsns.boxplot(data = df['bmi'])\nplt.title(\"Boxplot for bmi attribute\");\n\n# One can see from the box plot, there are outliers present in this plot. Any value greater than Q3+ 1.5 * IQR \n# is considered as an outlier","3aafe86a":"# Let us plot the boxplot for age attribute\nsns.boxplot(data = df['age'])\nplt.title(\"Boxplot for age attribute\");\n\n# One can see from the box plot, there are no outliers present in this plot. AAny value greater than Q3+ 1.5 * IQR \n# is considered as an outlier","69be29e1":"# Let us plot the boxplot for charges attribute\nsns.boxplot(data = df['charges'])\nplt.title(\"Boxplot for charges attribute\");\n\n# One can see from the box plot, there are outliers present in this plot. Any value greater than Q3+ 1.5 * IQR \n# is considered as an outlier","36330da7":"# let us calculate number of outliers present in these columns and print them\n\ndf_bac = df[['bmi','age','charges']].describe()[-5:].transpose()","f908c299":"df_bac.head()","e010babe":"# Calculate the IQR as Q3-Q1\nIQR = df_bac['75%']-df_bac['25%']\nprint(IQR)\n\n# Let us find the cutoff values above which they will be considered as an outlier..\nprint(\"Any column entry above following values will be an outlier..\")\nprint(df_bac['75%']+ 1.5*IQR)","03ff4779":"# From boxplot we know that outliers are present in bmi and charges columns that to the right of Q3, \n# we only calculate number of outliers on the right hand side i.e, those greater than Q3+ 1.5 * IQR\n\nno_bmi = df['bmi'][df['bmi']>df_bac['75%']['bmi']+1.5*IQR.bmi].count()\nprint(\"Number of outliers in bmi coumn are: \",no_bmi, \"and the values are: \")\nprint(df['bmi'][df['bmi']>df_bac['75%']['bmi']+1.5*IQR.bmi])","1dd18e79":"# Similarly, number of outliers in age column are: (should be zero as per the box plot)\nno_age = df['age'][df['age']>df_bac['75%']['age']+1.5*IQR.age].count()\nprint(\"Number of outliers in age coumn are: \",no_age)","008f5fde":"# Similarly, number of outliers in charges column are: (should be a large number as per the box plot)\nno_charges = df['charges'][df['charges']>df_bac['75%']['charges']+1.5*IQR.charges].count()\nprint(\"Number of outliers in charges coumn are: \",no_charges, \"and the values are: \")\nprint(df['charges'][df['charges']>df_bac['75%']['charges']+1.5*IQR.charges])","a31a4eab":"# Create a copy of df dataframe\ndf_copy = df.copy()\n# We will modify the charges column entries in this to see new distribution\n# Let us caluclate the median of charges column\ncharges_med = df_copy['charges'].median()\ndf_copy['charges'].replace(to_replace=df['charges'][df['charges']>df_bac['75%']['charges']+1.5*IQR.charges], value = df['charges'].median(), inplace = True)\n\n# Check whether values are correctly replaced or not?\n# 14      39611.75770 index 14 has this value in df dataframe, this should become median value\nprint(df['charges'][14])\nprint(df_copy['charges'][14])\n# Perfectly fine\n# The question is whether median is a good choice for replacing the outlier values in this case?","0550b235":"# Let us plot the the distributions of charges of df(with outliers) and df_copy (without outliers)\nfig, ax =plt.subplots(1,2)\nsns.distplot(df['charges'],ax=ax[0])\nax[0].set_title(\"With Outlier\"); \nsns.distplot(df_copy['charges'],ax=ax[1])\nax[1].set_title(\"Without Outlier\");\n\n# One can observe that right-tail in with outlier plot is now reduced in without outlier plot.","d2b285cf":"# Let us analyze categorical variables \"smoker\" and \"sex\" (as hue) with respect to \"charges\" as continuous variable\nsns.catplot(x=\"smoker\", y=\"charges\", hue=\"sex\", kind=\"box\", data=df);\n# One can observe that one belonging to smoker category is charged more than the non smoker irrespective of gender","3639fe53":"# Let us analyze categorical variables \"region\" and \"smoker\" (as hue) with respect to \"charges\" as continuous variable\nsns.catplot(x=\"region\", y=\"charges\", hue=\"smoker\", kind=\"box\", data=df);\n# One can observe that southeast charges relatively higher than other regions to smokers","0d363a46":"# Let us analyze categorical variables \"region\" and \"sex\" (as hue) with respect to charges as continuous variable\nsns.catplot(x=\"region\", y=\"charges\", hue=\"sex\", kind=\"box\", data=df);\n# One can observe that southeast has wider range of charges than other regions","8fa3f6ff":"# Let us analyze scatterplot between age and charges with smoker as a hue","5cc75d8d":"sns.catplot(x=\"age\", y=\"charges\", hue=\"smoker\", kind=\"swarm\", data=df);\n# One can see that over increasing age charges incurred are more and smokers are charged relatively higher \n# than non-smoker","1111c569":"# Let us analyze scatterplot between bmi and charges with smoker as a hue\nsns.catplot(x=\"bmi\", y=\"charges\", hue=\"smoker\", kind=\"swarm\", data=df);\n# One can see that smokers with increasing bmi tend to pay more charges than non-smokers..!","536f9bc3":"# Plotting swarmplot between charges and categorical variable smoker\nsns.swarmplot(df['smoker'], df['charges']);","e06699b6":"# Plotting swarmplot between charges and categorical variable sex\nsns.swarmplot(df['sex'], df['charges']);","a919bd98":"# Plotting swarmplot between charges and categorical variable region\nsns.swarmplot(df['region'], df['charges']);\n\n# region doesn't seem to play any major role in charges","7264b2b6":"# Let's plot barplot between charges and smoker\nsns.barplot(df['smoker'],df['charges']);\n\n# One can see that smoker's tend to pay higher charges than non-smokers","e60f2357":"# Let's plot barplot between charges and sex\nsns.barplot(df['sex'],df['charges']);\n\n# One can see that males have wider range of charges than females","106a4634":"# Let's plot barplot between charges and region\nsns.barplot(df['region'],df['charges']);\n\n# Region doesn't seem to be a good choice to predict charges","34549bca":"sns.pairplot(data=df);\n# One can oberve that age and charges seem to have large correlation than other numeric attributes ","dd13058e":"# Pairplot with smoker as hue\nsns.pairplot(data=df, hue='smoker');\n# One can oberve that smokers with increasing bmi's tend to pay more charges than non-smokers","e23e20aa":"# Pairplot with sex as hue\nsns.pairplot(data=df, hue='sex');\n# One can oberve that smokers with increasing bmi's tend to pay more charges than non-smokers","b0d4cf0e":"# Pairplot with region as hue\nsns.pairplot(data=df, hue='region');\n# One can oberve that the distributions of age,bmi,children and charges columns over region as a hue do not \n# provide any new information since they are fairly similar plots","3cf8c2a0":"corr = df.corr()\nsns.heatmap(corr, xticklabels=corr.columns.values, yticklabels=corr.columns.values);","0973d7f7":"# Another way toprint correlation matrix\ncorr.style.background_gradient(cmap='coolwarm').set_precision(2)\n\n# One can see that correlation coefficient for charges<----->age and charges<----->bmi is positive and high\n# showing strong correlation among these quantities. bmi<--->age are also correlated. ","77cd5efd":"# group1 : smoker\ngroup1 = df[df['smoker']=='yes'].charges\n# group2 : Non-smoker\ngroup2 = df[df['smoker']=='no'].charges","cb900bbc":"t_statistic, p_value = ttest_ind(group1, group2)\nprint(t_statistic, p_value)\n\n# if p_value < 0.05, we reject the null hypothesis else we fail to reject the null hypothesis","28d0e1e6":"df['sex'].value_counts()","50853d6f":"# group1_b:  bmi values for males only\ngroup1_b = df[df['sex']=='male'].bmi\n\n# group2_b:  bmi values for females only\ngroup2_b = df[df['sex']=='female'].bmi\n\nt_statistic, p_value = ttest_ind(group1_b, group2_b)\nprint(t_statistic, p_value)\n\n# if p_value < 0.05, we reject the null hypothesis else we fail to reject the null hypothesis","e120b658":"# In order to find the proportions, let us first calculate number of males and females\nn_males = df[df['sex']=='male'].sex.count() # 676\nn_females = df[df['sex']=='female'].sex.count()  # 662\n\n# Let us calculate number of male smokers\nms_all = df[df['sex']=='male'].smoker\nmale_smokers = ms_all[ms_all=='yes']\n# so number of males who smoke are \nn_male_smokers = male_smokers.count()\nprint(\"Number of male smokers are :\",n_male_smokers,\"and total number of males are :\",n_males)\n\n# Let us calculate number of female smokers\nfs_all = df[df['sex']=='female'].smoker\nfemale_smokers = fs_all[fs_all=='yes']\n# so number of females who smoke are \nn_female_smokers = female_smokers.count()\nprint(\"Number of female smokers are :\",n_female_smokers,\"and total number of females are :\",n_females)\n\n# Calculate the proportions of male and female smokers..\nmale_smoker_prop = n_male_smokers\/n_males\nfemale_smoker_prop = n_female_smokers\/n_females\n\nprint(\"Proportion of males who smoke is: {:.2}\".format(float(male_smoker_prop)))\nprint(\"Proportion of females who smoke is: {:.2}\".format(float(female_smoker_prop)))\n\n# One can see that proportions are not equal however are they significantly different, statistically\n\n# Let us carry out the z-proportions test\n\n'''We formulate our null and alternate hypothesis for this problem as follows:\n\nH0: smoker proportions are equal in different genders\n\nH1: smoker proportions are not equal in different genders\n\nWe assume the level of significance in this case as alpha = 0.05\n'''\n\n\nstat, pval = proportions_ztest([n_male_smokers, n_female_smokers] , [n_males, n_females])\nprint(\"The value of p is \",pval)","a32a3f3d":"# Boxplots for group1: women with no children\n# Boxplots for group2: women with 1 children\n# Boxplots for group3: women with 2 children\n\ngrp1 = df[(df['sex']=='female') & (df['children']==0)]['bmi']\ngrp2 = df[(df['sex']=='female') & (df['children']==1)]['bmi']\ngrp3 = df[(df['sex']=='female') & (df['children']==2)]['bmi']\n\nfig, ax =plt.subplots(3,1);\nax[0].set_title(\"Women with no children\");\nsns.boxplot(grp1,ax=ax[0]);\nax[1].set_title(\"Women with 1 children\");\nsns.boxplot(grp2,ax=ax[1]);\nax[2].set_title(\"Women with 2 children\");\nsns.boxplot(grp3,ax=ax[2]);\n\n# From plots one can see the boxplots for females with no, one and two children are almost similar\n# Let us check the same fact from the hypothesis testing..","363a3354":"f_stat, p_value_anova = stats.f_oneway(grp1,grp2,grp3)\nprint(p_value_anova)","70f469c2":"### Dataset Information:\n\n**Name: insurance.csv**\n\n**Domain: Healthcare**\n\n**Aim: Applying the concepts and techniques of applied statistics to gain some valuable insights.**","b0bdd8a2":"#### We can also use formulae to calculate the skewness. The formulae are:\n* The distribiution is left skewed if \n    * (Median \u2013 Xsmallest > Xlargest  \u2013 Median)\n    * (Q1 \u2013 Xsmallest > Xlargest  \u2013 Q3)\n    * (Median \u2013 Q1 > Q3 \u2013 Median)\n* The distribiution is symmetric if \n    * (Median \u2013 Xsmallest >= Xlargest  \u2013 Median)\n    * (Q1 \u2013 Xsmallest = Xlargest  \u2013 Q3)\n    * (Median \u2013 Q1 = Q3 \u2013 Median)\n* The distribiution is right skewed if \n    * (Median \u2013 Xsmallest < Xlargest  \u2013 Median)\n    * (Q1 \u2013 Xsmallest < Xlargest  \u2013 Q3)\n    * (Median \u2013 Q1 < Q3 \u2013 Median)","94534c6f":"### 4) Answer the following questions with statistical evidence","d38e8a0c":"#### h) Distribution of categorical columns (including children) using box plot, Scatter plot & Bar plots","fad4117b":"#### b) Data type of each attribute","69398c28":"##### d2) Using graphical approach","c86792b3":"#### Plotting correlation matrix using Seaborn's heatmap() function","fbce873f":"#### For understanding purpose let us plot the boxplots for  age,bmi and charges individually also to determine outliers","c2b05770":"**Thus, we can conclude that, with 95% (even 99%) confidence that charges of people who smoke differ significantly from the people who don't.**","77c7b143":"Since we want to compare the distributions of two or more groups concerning bmi values, we will use one-way ANOVA test. \n\nBut before that, let us plot the boxplots for the desired groups i.e., women with no, one and two children and take clue from the same.\n\n","a4bf4e81":"##### d1) Using describe() method","90d998ad":"**Since the p_value << 0.05, we reject the null hypotheis or in other words we support the alternate hypothesis.**","d899d43b":"#### a) Do charges of people who smoke differ significantly from the people who don't?\n\nWe formulate our null and alternate hypothesis for this problem as follows:\n\n**H0: Charges of people who smoke are same as people who don't**\n\n**HA: Charges of people who smoke differ from those who don't**\n\nWe assume the level of significance in this case as $\\alpha = 0.05$\n\nSince standard deviation of the poulation is not known we go for the 2-sample t-test (independent) ","3f1b1e78":"#### d) Is the distribution of bmi across women with no children, one child and two children, the same?","80f5d745":"#### b) Does bmi of males differ significantly from that of females?\n\nWe formulate our null and alternate hypothesis for this problem as follows:\n\n**H0: bmi values for males and females are equal for the given population**\n\n**H1: bmi values for males and females are not equal and differ significantly**\n\nWe assume the level of significance in this case as $\\alpha = 0.05$\n\nSince standard deviation of the poulation is not known we go for the 2-sample t-test (independent)","b2f63438":"**Since the p_value > 0.05, we fail to reject the null hypotheis or in other words the claim made in null hypothesis stands valid for the given data.**\n\n**Thus we can conclude with 95% confidence, that bmi values for males and females are equal for the given population**","d8ab3cdb":"#### Let us replace the outliers in charges column and see whether the how the new distribution looks like..\n","c7085cb1":"##### c1) Using info() method\n\ndf.info() method can be helpful to see check the presence of non-null values by comparing each columns non-null entries with total entries for example, in this dataset case we can see that there are no null values present since total entries are 1338 and each column also has 1338 non null entries","6312a216":"#### e) Distribution of \u2018bmi\u2019, \u2018age\u2019 and \u2018charges\u2019 columns","adfedaf8":"#### Treatment for outliers\n\nSince the outliers can possibly reduce the prediction accuracy of the model if used without proper treatment. Hence, one can replace the possible outlier values in coulmn attributess of the dataframe by\n* dropping the entire observation (row in a dataframe) in which there is an outlier \n* Replacing outlier value with median of that column (usually a common approach)\n* Replacing outlier value with twice of the standard deviation value (2*std) for that column attribute\n* Using software packages such as MICE (Multivariate Imputation by Chained Equations) available in R language","a90ff87d":"#### c) Checking the presence of missing values","03b21684":"#### f) Measure of skewness of \u2018bmi\u2019, \u2018age\u2019 and \u2018charges\u2019 columns\n\nskewness shows asymmetry of distributions. One way to find skewness can be to use the *skew()* function which returns a skew value. The skew value can be interpreted as:\n* if skew_value = 0, the distribution is symmetric\n* if skew_value < 0, indicates distribution tail is larger towards the left hand side of the distribution and thus  is left skewed\n* if skew_value > 0, indicates the distribution tail is larger towards the right hand side of the distribution and  thus is right skewed","14f2661a":"#### Since the $p$ value is greater than the $\\alpha$, we fail to reject the null hypothesis or in other words null hypothesis stands .\n\n#### so with 95% confidence, we can say that the distribution of bmi across women with no children, one child and two children are same or in other words number of children has no effect on bmi values of females","99718ea3":"#### In the above cell output, one can see that since $(m1<m2)$, $(m3<m4)$ and $(m5<m6)$ for age, bmi as well as charges and hence one can conclude that their distributions will be right-skewed. Measures given by skew() function also verfiy the right-skewness of the mentioned column distributions ","460103b8":"Step1: Seperating the data into 2 groups in this case smoker and non-smoker","bb68a953":" ### 3) Perform basic EDA","86440ca0":"#### d) 5 point summary of numerical attributes \n\nBefore, finding the 5 point summary of numnerical attributes, let us check whether all the numberical values are valid numbers\n","fc734702":"## Learning Outcomes:\n\n* Exploratory Data Analysis\n* Practicing statistics using Python\n* Hypothesis testing","82bfe635":"**Since the $p$ value < 0.05, we reject the null hypotheis or in other words alternative hypothesis is supported for the given data.**\n\n**Thus we can conclude with 95% (even 99% also) confidence, that proportions of smokers are different in differnt genders**","c6efb656":"#### c) Is the proportion of smokers significantly different in different genders? ","40a8fac4":"#### Treating the missing values\n\nSince the data at hand doesn't show any missing values in any of the column attribute, there is no need for missing value treatment for this data. However, in case one finds the missing value in the data we can find them and treat them appropriately as per the need by choosing one the few possible ways:\n* Filling missing values using fillna(), replace() and interpolate() functions\n* Replacing the missing values with median of that particular column attribute","f977080c":"Before plotting the boxplots for these columns, let us normalize them to find potential outliers","8f84cc66":"##### c2) Using isnull() method\n\ndf.isnull() method is also useful to check the presence of non-null entries. You can get the exact count of how many null entries are present for each column by using sum() method along with df.isnull() as follows","a93094fd":"From the above output, one can observe that all the mentioned column distributions are right-skewed with various degrees of variations. It is highest in case of 'charges' column, slight in case of 'bmi' where as nigligible in case of 'age' column","817a4e7a":"#### i) Pair plot that includes all the columns of the data frame","d075a972":"### 2) Read the dataset as Dataframe","15518dd1":"We formulate our null and alternate hypothesis for this problem as follows:\n\n**H0: distribution of bmi across women with no children, one child and two children are same**\n\n**H1: distribution of bmi between at least two groups (out of women with one, two and children) are different**\n\nWe assume the level of significance in this case as $\\alpha = 0.05$","25776c6e":"#### g) Checking the presence of outliers in \u2018bmi\u2019, \u2018age\u2019 and \u2018charges columns","48dd4bc6":"### 1) Import the necessary libraries","daff0460":"#### a) Print shape of the data"}}