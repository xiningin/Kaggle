{"cell_type":{"adf7364a":"code","01440373":"code","c3337c03":"code","b325e5f3":"code","96a1c3af":"code","c849d67a":"code","ec03f797":"code","7b43e753":"code","f400bea2":"code","5aae3705":"code","a607fa42":"code","6b9ed357":"code","cbb268cb":"code","65f4c78d":"code","60e52a00":"code","eb69243f":"code","18af9ceb":"code","f1be463b":"code","de4bc133":"code","77dc7063":"code","bc5733c5":"code","31912c50":"code","8b05f1ed":"code","168a8565":"code","2de15af8":"code","6751ca6c":"code","ef7b5707":"code","2d20c2f9":"code","ca0cb653":"code","4696c204":"code","cf36c994":"code","bcd67937":"code","170386ad":"code","5d218d51":"code","0b474817":"code","b05696d3":"markdown","600e3ca9":"markdown","7cd36171":"markdown","60dae0db":"markdown"},"source":{"adf7364a":"from sklearn.datasets import load_iris\nfrom sklearn.tree import DecisionTreeClassifier, DecisionTreeRegressor\nfrom sklearn.tree import export_graphviz\nimport os\nfrom IPython.display import Image\nfrom sklearn.model_selection import train_test_split, cross_val_predict, cross_val_score\nimport numpy as np\nimport matplotlib.pyplot as plt\nplt.style.use('seaborn')","01440373":"iris = load_iris()\nX = iris.data[:, 2:] # petal length and width\ny = iris.target\nprint(iris.DESCR)","c3337c03":"plt.scatter(X[:,0], X[:,1], c=y, cmap='jet')","b325e5f3":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","96a1c3af":"np.mean(cross_val_score(tree_clf, X, y, cv=5))","c849d67a":"error = cross_val_predict(tree_clf, X, y, cv=5)==y","ec03f797":"np.unique(error,return_counts=True)","7b43e753":"tree_clf = DecisionTreeClassifier(max_depth=2)\ntree_clf.fit(X_train, y_train)","f400bea2":"export_graphviz(tree_clf,out_file=\"iris_tree.dot\",feature_names=iris.feature_names[2:],class_names=iris.target_names,\n                rounded=True,filled=True)","5aae3705":"!dot -Tpng iris_tree.dot -o iris_tree.png","a607fa42":"Image(filename=\".\/iris_tree.png\")","6b9ed357":"tree_clf.score(X_test,y_test)","cbb268cb":"tree_clf.predict_proba([[5, 1.5]])","65f4c78d":"np.argmax(tree_clf.predict_proba([[5, 1.5]])) ","60e52a00":"iris.target_names","eb69243f":"tree_clf.predict([[5, 1.5]])","18af9ceb":"noise = np.random.randn(100,1)\nX = np.random.randn(100,1)\ny = X**2 + 2*X + 1 + noise","f1be463b":"plt.scatter(X, y)\na = np.linspace(-3,3,200)\nb = a**2 + 2*a + 1\nplt.plot(a, b, c='r')","de4bc133":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","77dc7063":"tree_reg = DecisionTreeRegressor(max_depth=2)","bc5733c5":"cross_val_score(tree_reg, X_train, y_train, cv=5)","31912c50":"tree_reg.fit(X, y)","8b05f1ed":"export_graphviz(tree_reg,out_file=\"reg.dot\",feature_names=['X'],\n                rounded=True,filled=True)","168a8565":"!dot -Tpng reg.dot -o reg.png","2de15af8":"Image('.\/reg.png', height=50000, width=10000)","6751ca6c":"tree_reg.score(X_test, y_test)","ef7b5707":"tree_reg.predict(X_test[30].reshape(1,-1)), y_test[30]","2d20c2f9":"tree_reg = DecisionTreeRegressor(min_samples_leaf=10)","ca0cb653":"cross_val_score(tree_reg, X_train, y_train, cv=5)","4696c204":"tree_reg.fit(X, y)","cf36c994":"export_graphviz(tree_reg,out_file=\"reg1.dot\",feature_names=['X'],\n                rounded=True,filled=True)","bcd67937":"!dot -Tpng reg1.dot -o reg1.png","170386ad":"Image('.\/reg1.png', height=50000, width=10000)","5d218d51":"tree_reg.score(X_test, y_test)","0b474817":"tree_reg.predict(X_test[30].reshape(1,-1)), y_test[30]","b05696d3":"# Let's modify hyperparameter to see improvement.","600e3ca9":"So made 10 errors in 150 instances which ia about 7%.","7cd36171":"So index 1 label (i.e 'versicolor')  will be predicted, as we will se in next cell.","60dae0db":"# Regression"}}