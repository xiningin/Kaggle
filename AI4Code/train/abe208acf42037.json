{"cell_type":{"a8ea3b36":"code","0f482223":"code","2725e581":"code","ea34da92":"code","878f61ee":"code","0d94289b":"code","60e12b45":"code","db3af07b":"code","f5e58434":"code","77eca35e":"code","d0c44a41":"code","e1ae45b1":"code","b5fe35e6":"code","2f8dc54a":"code","bec93cf8":"code","acea8693":"code","bab1c5d6":"code","7f3fe0a0":"code","f5206b2f":"code","4376d9a6":"code","e84add71":"code","22d259e4":"code","3eec0748":"code","47dd0199":"code","929de598":"code","063ec770":"code","19fe301c":"code","3d79cbde":"code","74e338e9":"code","e143b7cc":"code","5e82c831":"code","abbfb85d":"code","cd5d7d05":"code","496d5adb":"code","29c76a33":"code","44725ace":"code","217d7756":"code","5a77aa0a":"code","b8ed1695":"code","39ceb9dd":"code","6374e48e":"code","f9a449b6":"code","0834d4e5":"code","7923c02b":"markdown","c748ccfe":"markdown","5106a8ec":"markdown","830a2e00":"markdown","b5cd793b":"markdown","f0569b2d":"markdown","7fa41bb4":"markdown","ce8d364e":"markdown","4a041417":"markdown","d00fed04":"markdown","efb2adf7":"markdown","f0be3f79":"markdown","bb6e4b4b":"markdown","b05f08ba":"markdown","d3e245b3":"markdown","815eec11":"markdown","36498941":"markdown","5829bd29":"markdown","2d4ec8f0":"markdown","a4466826":"markdown","1b926b7e":"markdown","3a6e4d62":"markdown","5fb415ba":"markdown","4762382f":"markdown","af549ef5":"markdown","176c1f0e":"markdown","7d051940":"markdown","3be16176":"markdown","f1698ac6":"markdown","dd45870e":"markdown","6ad499ff":"markdown","f8ace84c":"markdown","3a2adc09":"markdown","9ea94017":"markdown","159a7427":"markdown","9f86bc9a":"markdown","c3e4ccc4":"markdown","014b78f5":"markdown","046692b5":"markdown","1d069004":"markdown"},"source":{"a8ea3b36":"import numpy as np\nimport pandas as pd\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nfrom plotly.offline import init_notebook_mode, iplot\nimport cufflinks as cf\n%matplotlib inline\npd.get_option('display.width')\npd.set_option('display.width', 120)\nsns.set(rc={'figure.figsize':(12.7,8.27)})\npd.options.mode.chained_assignment = None","0f482223":"data = pd.read_csv('..\/input\/Admission_Predict_Ver1.1.csv')","2725e581":"data.drop('Serial No.', inplace=True, axis=1)\ndata.rename({'Chance of Admit ': 'Chance of Admit', 'LOR ':'LOR'}, axis=1, inplace=True)","ea34da92":"## Head of the data\ndata.head()","878f61ee":"## General statistics of the data\ndata.describe()","0d94289b":"## Correlation coeffecients \ndata.corr()","60e12b45":"## Correlation coeffecients heatmap\nsns.heatmap(data.corr(), annot=True).set_title('Correlation Factors Heat Map', color='black', size='30')\n","db3af07b":"# Isolating GRE Score data\nGRE = pd.DataFrame(data['GRE Score'])\nGRE.describe()","f5e58434":"# # Probability Distribution\nsns.distplot(GRE).set_title('Probability Distribution for GRE Test Scores', size='30')\nplt.show()","77eca35e":"# Correlation Coeffecients for GRE Score Test\nGRE_CORR = pd.DataFrame(data.corr()['GRE Score'])\nGRE_CORR.drop('GRE Score', axis=0, inplace=True)\nGRE_CORR.rename({'GRE Score': 'GRE Correlation Coeff'}, axis=1, inplace=True)\nGRE_CORR","d0c44a41":"# Isolating and describing TOEFL Score\nTOEFL = pd.DataFrame(data['TOEFL Score'], columns=['TOEFL Score'])\nTOEFL.describe()","e1ae45b1":"# Probability distribution for TOEFL Scores\nsns.distplot(TOEFL).set_title('Probability Distribution for TOEFL Scores', size='30')\nplt.show()","b5fe35e6":"# Isolating and describing the CGPA\nCGPA = pd.DataFrame(data['CGPA'], columns=['CGPA'])\nCGPA.describe()","2f8dc54a":"sns.distplot(CGPA).set_title('Probability Distribution Plot for CGPA', size='30')\nplt.show()","bec93cf8":"RES_Count = data.groupby(['Research']).count()\nRES_Count = RES_Count['GRE Score']\nRES_Count = pd.DataFrame(RES_Count)\nRES_Count.rename({'GRE Score': 'Count'}, axis=1, inplace=True)\nRES_Count.rename({0: 'No Research', 1:'Research'}, axis=0, inplace=True)\nplt.pie(x=RES_Count['Count'], labels=RES_Count.index, autopct='%1.1f%%')\nplt.title('Research', pad=5, size=30)\nplt.show()","acea8693":"# Isolating and describing \nUniversity_Rating = data.groupby(['University Rating']).count()\nUniversity_Rating = University_Rating['GRE Score']\nUniversity_Rating = pd.DataFrame(University_Rating)\nUniversity_Rating.rename({'GRE Score': 'Count'}, inplace=True, axis=1)\nUniversity_Rating","bab1c5d6":"# Barplot for the distribution of the University Rating\nsns.barplot(University_Rating.index, University_Rating['Count']).set_title('University Rating', size='30')\nplt.show()","7f3fe0a0":"#Isolating and describing\nSOP = pd.DataFrame(data.groupby(['SOP']).count()['GRE Score'])\nSOP.rename({'GRE Score':'Count'}, axis=1, inplace=True)\nSOP","f5206b2f":"# Barplot for SOP \nsns.barplot(SOP.index, SOP['Count']).set_title('Statement of Purpose', size='30')\nplt.show()","4376d9a6":"LOR = pd.DataFrame(data.groupby(['LOR']).count()['GRE Score'])\nLOR.rename({'GRE Score':'Count'}, axis=1, inplace=True)\nLOR","e84add71":"# Distribution of the LOR\nsns.barplot(LOR.index, LOR['Count']).set_title('Letter of Recommendation', size='30')\nplt.show()","22d259e4":"data['Chance of Admit']\nsns.distplot(data['Chance of Admit']).set_title('Probability Distribution of Chance of Admit', size='30')\nplt.show()","3eec0748":"data.describe()['Chance of Admit']","47dd0199":"COA_corr = pd.DataFrame(data.corr()['Chance of Admit'])\nCOA_corr.rename({'Chance of Admit': 'Correlation Coeffecient'}, axis=1, inplace=True)\nCOA_corr.drop('Chance of Admit', inplace=True)\nCOA_corr.sort_values(['Correlation Coeffecient'], ascending=False, inplace=True)\nCOA_corr_x = COA_corr.index\nCOA_corr_y = COA_corr['Correlation Coeffecient']\nsns.barplot(y=COA_corr_x,x=COA_corr_y).set_title('Chance of Admit Correlation Coeffecients', size='30')\nplt.show()","929de598":"COA_corr","063ec770":"X = data.drop(['Chance of Admit'], axis=1)\ny = data['Chance of Admit']","19fe301c":"#Standardization\nfrom sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nX[['CGPA','GRE Score', 'TOEFL Score']] = scaler.fit_transform(X[['CGPA','GRE Score', 'TOEFL Score']])","3d79cbde":"#Splitting\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, random_state=101)","74e338e9":"from sklearn.linear_model import LinearRegression\nlr = LinearRegression()","e143b7cc":"lr.fit(X_train, y_train)\nlr_predictions = lr.predict(X_test)","5e82c831":"from sklearn.metrics import r2_score, mean_squared_error\nlr_r2 = r2_score(y_test, lr_predictions)\nlr_mse = mean_squared_error(y_test, lr_predictions)\nlr_rmse = np.sqrt(lr_mse)\nprint('Linear Regression R2 Score: {0} \\nLinear Regression MSE: {1}, \\nLinear Regression RMSE:{2}'.format(lr_r2, lr_mse, lr_rmse))","abbfb85d":"sns.set(rc={'figure.figsize':(12.7,8.27)})\nsns.distplot((y_test - lr_predictions))\nplt.title('Linear Regression (All Features) Residuals', fontdict={'fontsize':20}, pad=20)\nplt.show()","cd5d7d05":"sns.set(rc={'figure.figsize':(12.7,8.27)})\n# sns.(y_test, lr_predictions)\nsns.scatterplot(y_test, lr_predictions)\nplt.show()","496d5adb":"X_selected = X[['CGPA', 'GRE Score', 'TOEFL Score']]\nX_sel_train, X_sel_test, y_train, y_test = train_test_split(X_selected, y, random_state=101)","29c76a33":"lr_sel = LinearRegression()\nlr_sel.fit(X_sel_train, y_train)\nlr_sel_predictions = lr_sel.predict(X_sel_test)","44725ace":"lr_sel_r2 = r2_score(y_test, lr_sel_predictions)\nlr_sel_mse = mean_squared_error(y_test, lr_sel_predictions)\nlr_sel_rmse = np.sqrt(lr_sel_mse)\nprint('Linear Regression R2 Score: {0} \\nLinear Regression MSE: {1}, \\nLinear Regression RMSE:{2}'.format(lr_sel_r2, lr_sel_mse, lr_sel_rmse))","217d7756":"from sklearn.linear_model import SGDRegressor\nfrom sklearn.model_selection import GridSearchCV","5a77aa0a":"paramGrid = {'eta0':[0.01, 0.005, 0.1, 0.0005], 'n_iter':[500, 1000, 5000]}\nsgd = SGDRegressor()\nsearch = GridSearchCV(estimator=sgd, param_grid=paramGrid, n_jobs=-1)\nsearch.fit(X_train, y_train)","b8ed1695":"search.best_estimator_","39ceb9dd":"search.best_score_","6374e48e":"sgd_predictions = search.predict(X_test)\nnp.sqrt(mean_squared_error(y_test, sgd_predictions))","f9a449b6":"def ensemble(x):\n    pred_lr = lr.predict(x)\n#     x_sel = x[['CGPA', 'GRE Score','TOEFL Score']]\n#     pred_lr_sel = lr_sel.predict(x_sel)\n    pred_sgd = search.predict(x)\n    return (pred_lr + pred_sgd) \/ 2    ","0834d4e5":"ensemble_predictions = ensemble(X_test)\nr2_score(y_test, ensemble_predictions)\nnp.sqrt(mean_squared_error(y_test, ensemble_predictions))","7923c02b":"## Introducing the Dataset","c748ccfe":"## Linear Regression (All Features)","5106a8ec":"### University Rating","830a2e00":"## Preparing the data","b5cd793b":"And since one of our goals is to predict the chance of admission, let's take a look on how the different variables correlate with it.","f0569b2d":"The Graduate Record Examinations (GRE) is a the most popular test for graduate schools' admission, it consists of three sections : Analytical Writing, Verbal and Quantitative.\n\nThe test's maximum score is 340 and minimum is 260, and according to an official GRE score document, the mean test score for all individuals from July 1,2014 to June 30,2017 (almost 1,700,000 test taker) is 306.35 which rounds to 306 with an average standard deviation of 7.19\n\nsource: https:\/\/www.ets.org\/s\/gre\/pdf\/gre_interpreting_scores.pdf","7fa41bb4":"Cumulative Grade Points Average (CGPA) is a measure of a student's marks thus his performance in his undergraduate degree.","ce8d364e":"## Ensemble","4a041417":"Statement of Purpose (SOP) is a letter written by the student himself to state his purpose and motivation for completing a graduate degree in addition to his goals while and after he completes his study. Many universities find this letter significant because it better describe the student from a personal perspective.","d00fed04":"The rating of the university the student completed his undergraduate degree from.","efb2adf7":"As the distribution plot shows, the GRE test scores are somehow normally distributed.","f0be3f79":"## Exploring the Data","bb6e4b4b":"# First Steps","b05f08ba":"How good the university is a value between 1 and 5 in integer increment , and since it has positive correlation factors with other variables it's clear that 5 is the highest rating and 1 is the lowest.","d3e245b3":"### Research","815eec11":"## Objectives","36498941":"### Are students in this sample too good?","5829bd29":"    1.To have an overview look at the sample and analyze the students that apply to graduate degree programs.\n\n    2.To create a prediction model that estimates chance of admission for new prospect students.","2d4ec8f0":"This dataset includes data for graduate degrees admission (Masters), originally found on \"Kaggle\" (https:\/\/www.kaggle.com\/mohansacharya\/graduate-admissions)\n\nThe set includes the following Columns : Serial No., GRE Score, TOEFL Score, University Rating, SOP, LOR, CGPA, Research, Chance of Admit\n\nFirst read of the datasets' columns we can conclude some few basic facts and assumptions: \n    \n    1.Serial No. is just for providing a unique index and is thus ignored in any analysis, as it's improbable that it indicates an order of admission in terms of time or priority.\n    \n    2.Almost all data are assumed to be collerated to the chance of admission.\n\nIn a following section while \"Exploring the Data\", we will go through each variable individually.\n       \n","a4466826":"### In General ","1b926b7e":"Test of English as a Foreign Language (TOEFL) is a very popular test for English language amongst universities worldwide, it is marked based on three sections: Reading, Listening, Speaking, and Writing, each one of them is out of 30, yielding a maximum score of 120 and a minimum of 0.\n\nETS (the institute that offers the test) recorded a mean score of 82.6 with a standard deviation of 19.5 (https:\/\/www.ets.org\/s\/toefl\/pdf\/94227_unlweb.pdf).\n\nAlthough this is the mean for a wide range of students from all around the world that took the test for different purposes, as students applying for an engineering graduate degree might have a higher average than high school students.\n\n\n\n\n\n","3a6e4d62":"# Prediction Models","5fb415ba":"The sample's GRE score mean is 316 which is a little bit higher than the mean mentioned previously (306)","4762382f":"Let's first take a review on the chances of admission.","af549ef5":"## Linear Regression (Selected Features)","176c1f0e":"## Linear Regression with Stochastic Gradient Descent","7d051940":"It is evident that the most contribution factors to the chance of admission are CGPA, GRE Score and TOEFL Score.","3be16176":"# Introduction","f1698ac6":"### CGPA","dd45870e":"Exploring this variable, it's ordered from 1 to 5 with 0.5 increments, although the criteria for assessment isn't specified, which will make it harder to deal with new entries.","6ad499ff":"Letter of Recommendation (LOR) is a letter written by a person that knows the student and recommends that the university accept his admission, this person can be a professor in his undergraduate degree or a professional whom the student have worked with.","f8ace84c":"### LOR","3a2adc09":"### GRE Scores","9ea94017":"### TOEFL Score\n","159a7427":"### SOP","9f86bc9a":"THE LOR is ordered same as the SOP","c3e4ccc4":"It's evident that the sample over performs in the TOEFL.","014b78f5":"## Chance of Admission","046692b5":"## Importing Modules and Reading the .csv File","1d069004":"First looking at the students LOR, SOP and University Ratings, most students score (4-5) on the scales, not many scored (1-2.5).\n\nNonetheless, comparing means for their GRE and TOEFL scores, which are of a universal criteria, they clearly perform better than the average student as the ETS states.\n\nTo conclude, it seems only wise to consider the sample to be somehow above average.\n"}}