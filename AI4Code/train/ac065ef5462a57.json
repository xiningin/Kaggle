{"cell_type":{"d81ed6f4":"code","9db8f7c0":"code","acffb2ef":"code","df682e7d":"code","8f0428c0":"code","605bebf7":"code","f5ff6383":"code","c0225cca":"code","4699c936":"code","7cd7feb5":"code","a140e3ab":"code","506db422":"code","d34d1b51":"code","b1d92c91":"code","3d738842":"code","5da13fbb":"code","88bfc833":"code","0c17af3b":"code","9ea6b3e6":"code","f4ed1413":"code","2e34c887":"code","1472d096":"code","5772ac5e":"code","8f4753e9":"code","187a083a":"code","b9ba89c1":"code","046c95ef":"code","bf54f3df":"code","bfa7934b":"code","6ae48a50":"code","02b4a1a2":"code","a65ba2a3":"code","c3632a82":"code","cefdbd45":"code","f4fc876f":"code","2f7861ed":"code","30039081":"code","eded1e07":"code","def98647":"markdown","47703841":"markdown","c9b8ca35":"markdown","b312f867":"markdown","981751ac":"markdown","62cce5f3":"markdown","a12b2cf9":"markdown","89dd00e2":"markdown","5f50b816":"markdown","bfd7d578":"markdown","450d590d":"markdown","cc570a42":"markdown","d7975b49":"markdown","3f901844":"markdown","baa840aa":"markdown","baadaf64":"markdown","04a256ff":"markdown","380c2685":"markdown","c5f0c32e":"markdown","9f52fa9d":"markdown","85a993d6":"markdown","608b90c1":"markdown","e006a939":"markdown","553b4459":"markdown","d282f3d0":"markdown","ca82757c":"markdown","d9fd77c1":"markdown","2eb87e30":"markdown","437cb889":"markdown","5e60d5a2":"markdown"},"source":{"d81ed6f4":"#import the required libraries\nimport numpy as np \nimport pandas as pd \nimport seaborn as sns \nimport matplotlib.ticker as mtick  \nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n\n","9db8f7c0":"telco_base_data = pd.read_csv('..\/input\/churn-prediction\/Churn.csv')","acffb2ef":"telco_base_data.head()","df682e7d":"telco_base_data.shape","8f0428c0":"telco_base_data.columns.values","605bebf7":"# Checking the data types of all the columns\ntelco_base_data.dtypes","f5ff6383":"# Check the descriptive statistics of numeric variables\ntelco_base_data.describe()","c0225cca":"telco_base_data['Churn'].value_counts().plot(kind='barh', figsize=(8, 6))\nplt.xlabel(\"Count\", labelpad=14)\nplt.ylabel(\"Target Variable\", labelpad=14)\nplt.title(\"Count of TARGET Variable per category\", y=1.02);","4699c936":"100*telco_base_data['Churn'].value_counts()\/len(telco_base_data['Churn'])","7cd7feb5":"telco_base_data['Churn'].value_counts()","a140e3ab":"# Concise Summary of the dataframe, as we have too many columns, we are using the verbose = True mode\ntelco_base_data.info(verbose = True) ","506db422":"missing = pd.DataFrame((telco_base_data.isnull().sum())*100\/telco_base_data.shape[0]).reset_index()\nplt.figure(figsize=(16,5))\nax = sns.pointplot('index',0,data=missing)\nplt.xticks(rotation =90,fontsize =7)\nplt.title(\"Percentage of Missing values\")\nplt.ylabel(\"PERCENTAGE\")\nplt.show()","d34d1b51":"telco_data = telco_base_data.copy()","b1d92c91":"telco_data.TotalCharges = pd.to_numeric(telco_data.TotalCharges, errors='coerce')\ntelco_data.isnull().sum()","3d738842":"telco_data.loc[telco_data ['TotalCharges'].isnull() == True]","5da13fbb":"#Removing missing values \ntelco_data.dropna(how = 'any', inplace = True)\n\n#telco_data.fillna(0)","88bfc833":"# Get the max tenure\nprint(telco_data['tenure'].max()) #72","0c17af3b":"# Group the tenure in bins of 12 months\nlabels = [\"{0} - {1}\".format(i, i + 11) for i in range(1, 72, 12)]\n\ntelco_data['tenure_group'] = pd.cut(telco_data.tenure, range(1, 80, 12), right=False, labels=labels)","9ea6b3e6":"telco_data['tenure_group'].value_counts()","f4ed1413":"#drop column customerID and tenure\ntelco_data.drop(columns= ['customerID','tenure'], axis=1, inplace=True)\ntelco_data.head()","2e34c887":"for i, predictor in enumerate(telco_data.drop(columns=['Churn', 'TotalCharges', 'MonthlyCharges'])):\n    plt.figure(i)\n    sns.countplot(data=telco_data, x=predictor, hue='Churn')","1472d096":"telco_data['Churn'] = np.where(telco_data.Churn == 'Yes',1,0)","5772ac5e":"telco_data.head()","8f4753e9":"telco_data_dummies = pd.get_dummies(telco_data)\ntelco_data_dummies.head()","187a083a":"sns.lmplot(data=telco_data_dummies, x='MonthlyCharges', y='TotalCharges', fit_reg=False)","b9ba89c1":"Mth = sns.kdeplot(telco_data_dummies.MonthlyCharges[(telco_data_dummies[\"Churn\"] == 0) ],\n                color=\"Red\", shade = True)\nMth = sns.kdeplot(telco_data_dummies.MonthlyCharges[(telco_data_dummies[\"Churn\"] == 1) ],\n                ax =Mth, color=\"Blue\", shade= True)\nMth.legend([\"No Churn\",\"Churn\"],loc='upper right')\nMth.set_ylabel('Density')\nMth.set_xlabel('Monthly Charges')\nMth.set_title('Monthly charges by churn')","046c95ef":"Tot = sns.kdeplot(telco_data_dummies.TotalCharges[(telco_data_dummies[\"Churn\"] == 0) ],\n                color=\"Red\", shade = True)\nTot = sns.kdeplot(telco_data_dummies.TotalCharges[(telco_data_dummies[\"Churn\"] == 1) ],\n                ax =Tot, color=\"Blue\", shade= True)\nTot.legend([\"No Churn\",\"Churn\"],loc='upper right')\nTot.set_ylabel('Density')\nTot.set_xlabel('Total Charges')\nTot.set_title('Total charges by churn')","bf54f3df":"plt.figure(figsize=(20,8))\ntelco_data_dummies.corr()['Churn'].sort_values(ascending = False).plot(kind='bar')","bfa7934b":"plt.figure(figsize=(12,12))\nsns.heatmap(telco_data_dummies.corr(), cmap=\"Paired\")","6ae48a50":"new_df1_target0=telco_data.loc[telco_data[\"Churn\"]==0]\nnew_df1_target1=telco_data.loc[telco_data[\"Churn\"]==1]","02b4a1a2":"def uniplot(df,col,title,hue =None):\n    \n    sns.set_style('whitegrid')\n    sns.set_context('talk')\n    plt.rcParams[\"axes.labelsize\"] = 20\n    plt.rcParams['axes.titlesize'] = 22\n    plt.rcParams['axes.titlepad'] = 30\n    \n    \n    temp = pd.Series(data = hue)\n    fig, ax = plt.subplots()\n    width = len(df[col].unique()) + 7 + 4*len(temp.unique())\n    fig.set_size_inches(width , 8)\n    plt.xticks(rotation=45)\n    plt.yscale('log')\n    plt.title(title)\n    ax = sns.countplot(data = df, x= col, order=df[col].value_counts().index,hue = hue,palette='bright') \n        \n    plt.show()","a65ba2a3":"uniplot(new_df1_target1,col='Partner',title='Distribution of Gender for Churned Customers',hue='gender')","c3632a82":"uniplot(new_df1_target0,col='Partner',title='Distribution of Gender for Non Churned Customers',hue='gender')","cefdbd45":"uniplot(new_df1_target1,col='PaymentMethod',title='Distribution of PaymentMethod for Churned Customers',hue='gender')","f4fc876f":"uniplot(new_df1_target1,col='Contract',title='Distribution of Contract for Churned Customers',hue='gender')","2f7861ed":"uniplot(new_df1_target1,col='TechSupport',title='Distribution of TechSupport for Churned Customers',hue='gender')","30039081":"uniplot(new_df1_target1,col='SeniorCitizen',title='Distribution of SeniorCitizen for Churned Customers',hue='gender')","eded1e07":"telco_data_dummies.to_csv('tel_churn.csv')","def98647":"**5.** Divide customers into bins based on tenure e.g. for tenure < 12 months: assign a tenure group if 1-12, for tenure between 1 to 2 Yrs, tenure group of 13-24; so on...","47703841":"**2.** Convert the target variable 'Churn'  in a binary numeric variable i.e. Yes=1 ; No = 0","c9b8ca35":"**3.** Convert all the categorical variables into dummy variables","b312f867":"SeniorCitizen is actually a categorical hence the 25%-50%-75% distribution is not propoer\n\n75% customers have tenure less than 55 months\n\nAverage Monthly charges are USD 64.76 whereas 25% customers pay more than USD 89.85 per month","981751ac":"**Derived Insight: **\n\n**HIGH** Churn seen in case of  **Month to month contracts**, **No online security**, **No Tech support**, **First year of subscription** and **Fibre Optics Internet**\n\n**LOW** Churn is seens in case of **Long term contracts**, **Subscriptions without internet service** and **The customers engaged for 5+ years**\n\nFactors like **Gender**, **Availability of PhoneService** and **# of multiple lines** have alomost **NO** impact on Churn\n\nThis is also evident from the **Heatmap** below","62cce5f3":"**2.** Total Charges should be numeric amount. Let's convert it to numerical data type","a12b2cf9":"**3.** As we can see there are 11 missing values in TotalCharges column. Let's check these records ","89dd00e2":"## Data Cleaning\n","5f50b816":"**Insight:** Churn is high when Monthly Charges ar high","bfd7d578":"# CONCLUSION","450d590d":"Check the various attributes of data like shape (rows and cols), Columns, datatypes","cc570a42":"### Univariate Analysis","d7975b49":"# Telco Churn Analysis","3f901844":"These are some of the quick insights from this exercise:\n\n1. Electronic check medium are the highest churners\n2. Contract Type - Monthly customers are more likely to churn because of no contract terms, as they are free to go customers.\n3. No Online security, No Tech Support category are high churners\n4. Non senior Citizens are high churners\n\nNote: There could be many more such insights, so take this as an assignment and try to get more insights :)","baa840aa":"### Bivariate Analysis","baadaf64":"### Missing Data - Initial Intuition\n\n* Here, we don't have any missing data.\n\nGeneral Thumb Rules:\n\n* For features with less missing values- can use regression to predict the missing values or fill with the mean of the values present, depending on the feature.\n* For features with very high number of missing values- it is better to drop those columns as they give very less insight on analysis.\n* As there's no thumb rule on what criteria do we delete the columns with high number of missing values, but generally you can delete the columns, if you have more than 30-40% of missing values. But again there's a catch here, for example, Is_Car & Car_Type, People having no cars, will obviously have Car_Type as NaN (null), but that doesn't make this column useless, so decisions has to be taken wisely.","04a256ff":"**6.** Remove columns not required for processing","380c2685":"Since the % of these records compared to total dataset is very low ie 0.15%, it is safe to ignore them from further processing.","c5f0c32e":"**Dataset Info:**\nSample Data Set containing Telco customer data and showing customers left last month","9f52fa9d":"**1.** Create a copy of base data for manupulation & processing","85a993d6":"**9. ** Relationship between Monthly Charges and Total Charges","608b90c1":"Look at the top 5 records of data","e006a939":"**Surprising insight ** as higher Churn at lower Total Charges\n\nHowever if we combine the insights of 3 parameters i.e. Tenure, Monthly Charges & Total Charges then the picture is bit clear :- Higher Monthly Charge at lower tenure results into lower Total Charge. Hence, all these 3 factors viz **Higher Monthly Charge**,  **Lower tenure** and **Lower Total Charge** are linkd to **High Churn**.","553b4459":"**11. Build a corelation of all predictors with 'Churn' **","d282f3d0":"* Data is highly imbalanced, ratio = 73:27<br>\n* So we analyse the data with other features while taking the target values separately to get some insights.","ca82757c":"Total Charges increase as Monthly Charges increase - as expected.","d9fd77c1":"**Load the data file **","2eb87e30":"**4. Missing Value Treatement**","437cb889":"**10. ** Churn by Monthly Charges and Total Charges","5e60d5a2":"## Data Exploration\n**1. ** Plot distibution of individual predictors by churn"}}