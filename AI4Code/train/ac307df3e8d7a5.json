{"cell_type":{"1c34ead7":"code","321fedad":"code","8657ecc6":"code","d517ab2e":"code","2906d652":"code","8ea6c574":"code","c4e1a473":"code","e3b70882":"code","f4e867bb":"code","c985f894":"code","9f14f727":"code","4f44963f":"code","822f056a":"code","a8a723b0":"code","53f7e7ed":"code","c8684187":"code","23866dd1":"code","927183fe":"code","e35e07bf":"code","612667c5":"code","f4de0752":"code","f1640e68":"code","42527c67":"code","c8719536":"code","3a8becad":"code","8a29a3ee":"code","e46c6d73":"code","6ae1f269":"code","7996014b":"code","96ed1eb2":"code","2821b8b0":"code","c80d4b43":"code","19c8e271":"markdown","341c1cce":"markdown","bffdbd63":"markdown","a8e24846":"markdown","b710e970":"markdown","52839892":"markdown","1589efa0":"markdown","199ad826":"markdown","71bdef2e":"markdown","32209921":"markdown","ce11eb6d":"markdown","2461602b":"markdown"},"source":{"1c34ead7":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns; sns.set()\nimport numpy as np\nfrom sklearn.cluster import KMeans\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n%matplotlib inline","321fedad":"df= pd.read_csv('..\/input\/ccdata\/CC GENERAL.csv')\ndf.head()","8657ecc6":"df.info()","d517ab2e":"df=df.drop(['CUST_ID'], axis=1)","2906d652":"df.isnull().sum().sort_values(ascending=False)","8ea6c574":"from sklearn.impute import SimpleImputer\nimputer = SimpleImputer(missing_values=np.nan, strategy='median')\n\nX = df['MINIMUM_PAYMENTS'].values.reshape(-1,1)\nX = imputer.fit_transform(X) \n\ndf['MINIMUM_PAYMENTS_NEW'] = X","c4e1a473":"X2 = df['CREDIT_LIMIT'].values.reshape(-1,1)\nX2 = imputer.fit_transform(X2) \n\ndf['CREDIT_LIMIT_NEW'] = X2","e3b70882":"df = df.drop(['CREDIT_LIMIT','MINIMUM_PAYMENTS'],axis = 1)","f4e867bb":"df.isnull().sum().sum()","c985f894":"sns.set(style='white',font_scale=1.3, rc={'figure.figsize':(20,15)})\nax=df.hist(bins=20,color='red' )","9f14f727":"sns.pairplot(df)\nplt.show()","4f44963f":"plt.figure(figsize=(20,12))\ncorr_df = df.corr()\nsns.heatmap(corr_df,annot=True)\nplt.show()","822f056a":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\ndf=sc.fit_transform(df)","a8a723b0":"from tqdm import tqdm\nimport sklearn.cluster as cluster\nfrom sklearn.metrics import silhouette_score\nsilhouette = {}\nfor i in tqdm(range(2,19)):\n    kmeans =cluster.KMeans(n_clusters=i,\n               init='k-means++',\n               n_init=15,\n               max_iter=500,\n               random_state=17)\n    kmeans.fit(df)\n    silhouette[i] = silhouette_score(df, kmeans.labels_, metric='euclidean')","53f7e7ed":"plt.bar(range(len(silhouette)), list(silhouette.values()), align='center',color= 'red',width=0.5)\nplt.grid()\nplt.title('Silhouette Score',fontweight='bold')\nplt.xlabel('Number of Clusters')\nplt.show()","c8684187":"from sklearn.decomposition import PCA\npca_2 = PCA(2)\npca_2_result = pca_2.fit_transform(df)\n\nprint ('Cumulative variance explained by 2 principal components: {:.2%}'.format(np.sum(pca_2.explained_variance_ratio_)))","23866dd1":"sns.set(style='white', rc={'figure.figsize':(9,6)},font_scale=1.1)\n\nplt.scatter(x=pca_2_result[:, 0], y=pca_2_result[:, 1], color='red',lw=0.1)\nplt.xlabel('Principal Component 1')\nplt.ylabel('Principal Component 2')\nplt.title('Data represented by the 2 strongest principal components',fontweight='bold')\nplt.show()","927183fe":"pca=PCA(whiten=True).fit(df)\nplt.plot(np.cumsum(pca.explained_variance_ratio_),marker='o',linestyle='--')\nplt.xlabel('number of components')\nplt.ylabel('cumulative explained variance')\nplt.show()","e35e07bf":"pca_10 = PCA(10)\npca_10_result = pca_10.fit_transform(df)\n\nprint ('Cumulative variance explained by 10 principal components: {:.2%}'.format(np.sum(pca_10.explained_variance_ratio_)))","612667c5":"pca10=PCA(n_components=10)","f4de0752":"scores_pca=pca10.fit_transform(df)","f1640e68":"scores_pca","42527c67":"wcss = []\nfor i in range(1, 20):\n    kmeans = KMeans(n_clusters = i, init = 'k-means++', random_state = 42)\n    kmeans.fit(scores_pca)\n    wcss.append(kmeans.inertia_)\n    \nplt.plot(range(1,20), wcss,marker='o',linestyle='--')\nplt.title('ELBOW METHOD with PCA')\nplt.xlabel('Number of Clusters')\nplt.ylabel('WCSS')\nplt.show()","c8719536":"kmeans_pca = cluster.KMeans(n_clusters=5,random_state=17,init='k-means++')\ny_kmeans = kmeans_pca.fit(scores_pca)\n","3a8becad":"y_kmeans","8a29a3ee":"kmeans_labels = kmeans_pca.fit_predict(scores_pca)\npd.Series(kmeans_labels).value_counts()","e46c6d73":"df=pd.DataFrame(df)","6ae1f269":"df_segm_pca_kmeans=pd.concat([df.reset_index(drop=True),pd.DataFrame(scores_pca)],axis=1)\ndf_segm_pca_kmeans.columns.values[-10: ]=['100','101','102','103','104','105','106','107','108','109']","7996014b":"df_segm_pca_kmeans['cluster K-Means PCA']=kmeans_pca.labels_","96ed1eb2":"df_segm_pca_kmeans.head(10)","2821b8b0":"df_segm_pca_kmeans['cluster']=df_segm_pca_kmeans['cluster K-Means PCA'].map({0:'first',\n                                                                             1:'second',\n                                                                             2:'third',\n                                                                             3:'fourth',\n                                                                             4:'fifth'})","c80d4b43":"x_axis=df_segm_pca_kmeans[100]\ny_axis=df_segm_pca_kmeans[101]\nplt.figure(figsize=(10, 8))\nsns.scatterplot(x_axis, y_axis, hue=df_segm_pca_kmeans['cluster'], palette=['g','r','c','m','b'])\ncenters_pca= kmeans_pca.cluster_centers_\nplt.scatter(centers_pca[:, 0], centers_pca[:, 1],\n            marker='x', s=80, linewidths=4,\n            color='black', zorder=10,lw=3)\nplt.title('Clusters by PCA Components')\nplt.show()","19c8e271":"* Data Preprocessing","341c1cce":"* Import Data ","bffdbd63":"* Elbow Method with PCA","a8e24846":"* Data Visualization","b710e970":"As we can see, in K=5 all the metrics indicates that it is the best clusters number. So, we'll be using it","52839892":"****CLASSIFICATION of CREDIT CARD CUSTOMERS with the K-MEANS CLUSTERING****","1589efa0":"Data represented by the 2 strongest principal components\n","199ad826":"Finally, we must write the relevant code to keep only 10 components.","71bdef2e":"* K-Means Clustering","32209921":"* PCA","ce11eb6d":"* Silhouette Method whitout PCA","2461602b":"* K-Means Clustering with PCA Result"}}