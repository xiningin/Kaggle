{"cell_type":{"eed9bc7d":"code","bb3d7270":"code","2e1df3d3":"code","c8073296":"code","59acb12f":"code","0bc96cb5":"code","e4482059":"code","2ca429e8":"code","df4ed22c":"code","42be94b4":"code","07bb9501":"code","a260737f":"code","33e6fed7":"code","3cf7b52b":"code","eb98642e":"code","183d4e1a":"code","f98d6fa5":"code","e7a671d0":"code","80f128b4":"code","412b4308":"code","b85670d4":"code","1babda46":"code","cad84a14":"code","dea0551e":"code","47cc2468":"code","809a1f6f":"code","8500185d":"code","35d1e256":"code","1a6e95d4":"code","ccbf7e6a":"code","93028c9f":"code","86a55684":"code","e71183d4":"code","f47fda47":"code","7740c828":"code","b869ebc1":"code","aa38f1c0":"code","57e81c43":"code","13b055a4":"code","a5942a5d":"code","9c0c260b":"code","c291d023":"code","89697408":"code","f1b86698":"code","6b018791":"code","8cc3b467":"code","d6ff5103":"code","90dcbfec":"code","87d9889b":"code","17177b77":"code","8947158c":"code","2613eb48":"code","76d35fb7":"code","43bde282":"code","aa8b3ea0":"code","9dd2b3d1":"code","d12e2a2b":"code","f87f3621":"code","913c6970":"code","b01d4150":"code","8e7d2a61":"code","c9a6e780":"code","1b214696":"code","bc4838f5":"code","916f58d5":"code","ad739ece":"code","65279c1a":"code","138313dc":"code","dd923ab7":"code","46bd6a97":"code","95166d2f":"code","21612e28":"code","5283925c":"code","73beb386":"code","60f2ad95":"code","e9358d43":"code","a4a49cd8":"code","d003bcf9":"markdown","4fbdae58":"markdown","c1be6a6a":"markdown","356abcec":"markdown","df7b16da":"markdown","db3dfd6a":"markdown","3b3bc9b3":"markdown","bc3059b1":"markdown","063918a3":"markdown","d207bfc4":"markdown","79dd678e":"markdown","92bb17ef":"markdown","af7d64ad":"markdown","591be96b":"markdown","dbc95d14":"markdown","86c56836":"markdown","45b8825e":"markdown","e569f6f8":"markdown","5d7c24c2":"markdown","ae2ee08e":"markdown","77164389":"markdown","b615b73c":"markdown","cf695f82":"markdown","0241d849":"markdown","a9f9b004":"markdown"},"source":{"eed9bc7d":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.cluster import KMeans,AgglomerativeClustering\nfrom scipy.cluster.hierarchy import dendrogram,linkage,cophenet\nfrom scipy.spatial.distance import pdist\nfrom sklearn.decomposition import PCA","bb3d7270":"%%time\ndf=pd.read_csv('..\/input\/heart-disease-uci\/heart.csv')\ndf.head()","2e1df3d3":"df.info()","c8073296":"df.describe()","59acb12f":"df.isna().sum()\/len(df)*100","0bc96cb5":"## Therefore there are no null values present in the dataset:","e4482059":"heat=np.abs(df.corr().loc['target']).sort_values(ascending=False)","2ca429e8":"plt.figure(figsize=(8,8))\nsns.heatmap(heat.to_frame(),annot=True,cmap='Reds_r')\nplt.show()","df4ed22c":"for i in df.columns[:-1]:\n    sns.boxplot(df[i],palette='Reds')\n    plt.show()","42be94b4":"a=sns.FacetGrid(df,col='target')\na.map(sns.boxplot,'age',color='red',order=['0','1'])\n\nb=sns.FacetGrid(df,col='target')\nb.map(sns.boxplot,'cp',color='orange',order=['0','1'])\n\nc=sns.FacetGrid(df,col='target')\nc.map(sns.boxplot,'thalach',color='magenta',order=['0','1'])\n\nd=sns.FacetGrid(df,col='target')\nd.map(sns.boxplot,'exang',color='pink',order=['0','1'])\n\ne=sns.FacetGrid(df,col='target')\ne.map(sns.boxplot,'oldpeak',color='blue',order=['0','1'])\n\nf=sns.FacetGrid(df,col='target')\nf.map(sns.boxplot,'slope',color='green',order=['0','1'])\n\nplt.show()","07bb9501":"from scipy.stats import ttest_ind,mannwhitneyu","a260737f":"df0=df[df['target']==0]\ndf1=df[df['target']==1]","33e6fed7":"for i in df.columns[:-1]:\n    tstats,pvalue=ttest_ind(df0[i],df1[i])\n    if pvalue<0.01:\n        print(i,pvalue)","3cf7b52b":"sns.pairplot(df,vars=['age','sex','cp','thalach','exang','oldpeak','slope','ca','thal'],hue='target',palette='husl',diag_kws={'bw': 0.2})\nplt.show()","eb98642e":"X=df[['age','sex','cp','thalach','exang','oldpeak','slope','ca','thal']]","183d4e1a":"Y=df['target']","f98d6fa5":"from sklearn.preprocessing import StandardScaler","e7a671d0":"sc=StandardScaler()\nnum_sc=sc.fit_transform(X)\nnum_sc=pd.DataFrame(num_sc,columns=X.columns)\nnum_sc","80f128b4":"range(1,11)","412b4308":"np.arange(1,11)","b85670d4":"inertia=[]\nfor n in range(1,11):\n    km=KMeans(n_clusters=n)\n    km.fit(X)\n    inertia.append(km.inertia_)\nplt.plot(np.arange(1,11),inertia,color='magenta')\nplt.xlabel('potential_clusters')\nplt.ylabel('Inertia')\nplt.show()","1babda46":"KM=KMeans(n_clusters=3,n_init=15,random_state=48)\nKM.fit(num_sc)","cad84a14":"KM.inertia_","dea0551e":"KM.labels_","47cc2468":"KM.cluster_centers_","809a1f6f":"centroids=KM.cluster_centers_\ncentroid_df=pd.DataFrame(centroids,columns=num_sc.columns)\ncentroid_df","8500185d":"plt.scatter(num_sc.iloc[:,0],num_sc.iloc[:,1],c=KM.labels_,cmap=plt.cm.Accent)\nplt.xlabel('age')\nplt.ylabel('sex')\nplt.show()","35d1e256":"plt.scatter(num_sc.iloc[:,1],num_sc.iloc[:,2],c=KM.labels_,cmap=plt.cm.Accent)\nplt.xlabel('sex')\nplt.ylabel('cp')\nplt.show()","1a6e95d4":"plt.scatter(num_sc.iloc[:,2],num_sc.iloc[:,3],c=KM.labels_,cmap=plt.cm.Dark2_r)\nplt.xlabel('cp')\nplt.ylabel('thalach')\nplt.show()","ccbf7e6a":"plt.scatter(num_sc.iloc[:,3],num_sc.iloc[:,4],c=KM.labels_,cmap=plt.cm.Accent)\nplt.xlabel('thalach')\nplt.ylabel('exang')\nplt.show()","93028c9f":"plt.scatter(num_sc.iloc[:,4],num_sc.iloc[:,5],c=KM.labels_,cmap=plt.cm.magma)\nplt.xlabel('exang')\nplt.ylabel('oldpeak')\nplt.show()","86a55684":"plt.scatter(num_sc.iloc[:,5],num_sc.iloc[:,6],c=KM.labels_,cmap=plt.cm.magma)\nplt.xlabel('OLDPEAK')\nplt.ylabel('SLOPE')\nplt.show()","e71183d4":"z=linkage(num_sc,'single')\nc,coph_dists=cophenet(z,pdist(num_sc))","f47fda47":"c","7740c828":"z=linkage(num_sc,'average')\nc,coph_dists=cophenet(z,pdist(num_sc))","b869ebc1":"c","aa38f1c0":"z=linkage(num_sc,'complete')\nc,coph_dists=cophenet(z,pdist(num_sc))","57e81c43":"c","13b055a4":"z=linkage(num_sc,'ward')\nc,coph_dists=cophenet(z,pdist(num_sc))","a5942a5d":"c","9c0c260b":"agc=AgglomerativeClustering(n_clusters=3,affinity='euclidean',linkage='ward')\nagc.fit(num_sc)","c291d023":"agc.labels_","89697408":"plt.scatter(num_sc.iloc[:,0],num_sc.iloc[:,1],c=agc.labels_,cmap=plt.cm.Set1_r)\nplt.xlabel('age')\nplt.ylabel('sex')\nplt.show()","f1b86698":"from mpl_toolkits.mplot3d import Axes3D","6b018791":"fig=plt.figure(1,figsize=(10,10))\nax=Axes3D(fig,elev=-150,azim=150)\nax.scatter(num_sc.iloc[:,0],num_sc.iloc[:,1],num_sc.iloc[:,2],c=agc.labels_,cmap=plt.cm.Set1,edgecolor='k',s=40)\nax.set_title('agc clusters with faeture space')\nax.set_xlabel('age')\nax.set_ylabel('sex')\nax.set_zlabel('cp')\nplt.show()","8cc3b467":"X_std_df_labeled = num_sc.copy(deep=True)\nX_std_df_labeled['class'] = agc.labels_","d6ff5103":"X_std_df_labeled","90dcbfec":"Agc_clusters=X_std_df_labeled.groupby(['class'])","87d9889b":"df0=Agc_clusters.get_group(0)\ndf1=Agc_clusters.get_group(1)\ndf2=Agc_clusters.get_group(2)","17177b77":"c0=np.array(df0.mean())\nc1=np.array(df1.mean())\nc2=np.array(df2.mean())","8947158c":"c0=c0[:-1]","2613eb48":"c1=c1[:-1]","76d35fb7":"c2=c2[:-1]","43bde282":"agc_i0=0\nagc_i1=0\nagc_i2=0\nfor i in np.arange(df0.shape[0]):\n    agc_i0=agc_i0+np.sum((df0.iloc[i,:-1]-c0)**2)\nfor i in np.arange(df1.shape[0]):\n    agc_i1=agc_i1+np.sum((df1.iloc[i,:-1]-c1)**2)\nfor i in np.arange(df2.shape[0]):\n    agc_i2=agc_i2+np.sum((df2.iloc[i,:-1]-c2)**2)","aa8b3ea0":"agc_i0+agc_i1+agc_i2","9dd2b3d1":"plt.figure(figsize=(10,10))\nplt.title('AGC Dendrogram')\nplt.xlabel('sample index')\nplt.ylabel('Distance')\nZ=linkage(num_sc,'ward')\ndendrogram(Z,leaf_rotation=90,leaf_font_size=10,truncate_mode='level',p=3,color_threshold=20)\nplt.tight_layout()","d12e2a2b":"from sklearn import metrics","f87f3621":"metrics.silhouette_score(num_sc,KM.labels_)","913c6970":"metrics.silhouette_score(num_sc,agc.labels_)","b01d4150":"cov_matrix=np.cov(num_sc.T)\ncov_matrix.shape","8e7d2a61":"eig_values,eig_vec=np.linalg.eig(cov_matrix)","c9a6e780":"eig_values","1b214696":"eig_vec","bc4838f5":"tot=sum(eig_values)\nvar_exp=[(i\/tot)*100 for i in sorted(eig_values,reverse=True)]\nvar_exp","916f58d5":"cumsum=np.cumsum(var_exp)\ncumsum","ad739ece":"eig_pairs=[(np.abs(eig_values[i]),eig_vec[:,i]) for i in range(len(eig_values))]","65279c1a":"eig_pairs","138313dc":"eig_pairs_sorted=sorted(eig_pairs,reverse=True)\neig_pairs_sorted","dd923ab7":"eig_values_sorted=[eig_pairs_sorted[index][0] for index in range(len(eig_values))]\neig_vec_sorted=[eig_pairs_sorted[index][1] for index in range(len(eig_values))]","46bd6a97":"eig_values_sorted","95166d2f":"eig_vec_sorted","21612e28":"P_reduce=np.array(eig_vec_sorted[:2]).transpose()\nP_reduce","5283925c":"X_pca=np.dot(num_sc,P_reduce)\nX_pca.shape","73beb386":"pca=KMeans(n_clusters=3,n_init=15,random_state=48).fit(X_pca)","60f2ad95":"pca.inertia_","e9358d43":"metrics.silhouette_score(X_pca,pca.labels_)","a4a49cd8":"plt.scatter(X_pca[:,0],X_pca[:,1],c=pca.labels_,cmap=plt.cm.Set1)\nplt.show()","d003bcf9":"## PCA:Principal component Analysis ","4fbdae58":"## Dendrogram:","c1be6a6a":"***Agglomerative Clustering\/KMeans Clustering is having a cluster quality score of 14 which implies that clusters within and between are not following Homogeneous and Heterogeneous pattern lets apply PCA for more better results***","356abcec":"### Conclusion: Final cluster is showing homoegenoeus and heterogeneous pattern and a cluster quality score i.e silhoutte score of 41 which is acceptable.","df7b16da":"***From above we can see that exang,cp,oldpeak,thalach are strongle correlated with the target variable***","db3dfd6a":"## Checking the null values:","3b3bc9b3":"## Seeing the Summary","bc3059b1":"## Plotting ScatterPlot:","063918a3":"**Since Variance explained by each is of some extent therefore there is no multicollinearity in data**","d207bfc4":"# Importing Necessary Libraries","79dd678e":"## Loading the Data","92bb17ef":"## Splitting X and Y:","af7d64ad":"## Checking the info","591be96b":"![Heart-diseases.jpg](attachment:Heart-diseases.jpg)","dbc95d14":"***Therefore there could be a potential of 3 clusters in the dataset i.e Person with heart disease,Person without Heart disease and person with onset of Disease***","86c56836":"## Plotting for Inertia vs n_clusters:","45b8825e":"## Scaling:","e569f6f8":"## Checking the correlation matrix:","5d7c24c2":"## AGC","ae2ee08e":"## Facet Grid","77164389":"***These are the features we would be using***","b615b73c":"## Performing Statistical tests","cf695f82":"## Checking for Outliers:","0241d849":"**Average linkage is giving the best results**","a9f9b004":"## Silhouette Score"}}