{"cell_type":{"e6fbba24":"code","04f917cc":"code","ab88396d":"code","2c03a01a":"code","24c5ceb0":"code","ba080f88":"code","1e760f35":"code","d8ed5b51":"code","8ba916c4":"code","1be3ad8d":"code","f98cb2c3":"code","251a6916":"code","35a3234d":"code","27be255d":"code","cc53ab09":"code","10736a13":"code","17f45b75":"code","751bb55c":"code","62f67eed":"code","adef5de3":"code","502da09e":"code","ac9a6c89":"code","ab6c9384":"code","64673cb5":"code","77ba548a":"code","2feca9d0":"markdown","1a35ba6c":"markdown","3fa705ba":"markdown","a80b04fe":"markdown","4659917c":"markdown","1420c54c":"markdown","ca4ee260":"markdown","db6dc635":"markdown","6bea8c43":"markdown","a78d923e":"markdown"},"source":{"e6fbba24":"# Arquivo de dados\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","04f917cc":"import pandas as pd\nimport numpy as np\n# Carregar os dados\ndf = pd.read_csv(\"\/kaggle\/input\/hmeq.csv\")","ab88396d":"# Verificar os dados\ndf.shape","2c03a01a":"# Informa\u00e7\u00f5es dos dados\ndf.info()","24c5ceb0":"# Olhando os dados\ndf.head()","ba080f88":"# Olhando quantas vari\u00e1veis tem por coluna\ndf.nunique()\n# A vari\u00e1vel BAD tem 2 ","1e760f35":"# Soma dos valores faltantes \ndf.isnull().sum().values.sum()","d8ed5b51":"# Os dados faltantes por coluna\ndf.isnull().sum()","8ba916c4":"# Preencher os valores NaN com a classe que mais aparece na coluna REASON\n# \u00c9 uma variavel do tipo object\ndf.REASON.fillna('DebtCon', inplace=True)","1be3ad8d":"# Preencher os valores NaN com a classe que mais aparece na coluna JOB\n# \u00c9 uma variavel do tipo object\ndf.JOB.fillna('Other', inplace=True)","f98cb2c3":"# Os NaN ser\u00e3o substituidos pela m\u00e9dia cada classe\ndf.fillna(0,inplace=True)","251a6916":"# Verificando como est\u00e1 os dados depois da substitui\u00e7\u00e3o\ndf.head()","35a3234d":"# Converter de object para int\nfor col in df.columns:\n    if df[col].dtype == 'object':\n        df[col] = df[col].astype('category').cat.codes","27be255d":"df.info()","cc53ab09":"# Separar os dados em treino e valida\u00e7\u00e3o\nfrom sklearn.model_selection import train_test_split\n\ntrain, valid = train_test_split(df, test_size=0.2, random_state=42)\n\ntrain.shape, valid.shape","10736a13":"# Definindo as feats\nfeats = [c for c in df.columns if c not in ['BAD']]","17f45b75":"# Importar o modelo\nfrom sklearn.ensemble import RandomForestClassifier\n\nrf = RandomForestClassifier(n_estimators=100, random_state=42, min_samples_leaf=3)","751bb55c":"# Treinar o modelo\nrf.fit(train[feats], train['BAD'])","62f67eed":"pd.Series(rf.feature_importances_ , index=feats).sort_values().plot.barh()","adef5de3":"# Previs\u00e3o na base de valida\u00e7\u00e3o\npreds_val = rf.predict(valid[feats])\npreds_val","502da09e":"# Importar a m\u00e9trica de acur\u00e1cia\nfrom sklearn.metrics import accuracy_score\naccuracy_score(valid['BAD'], preds_val)","ac9a6c89":"# Previs\u00e3o na base de treino\npreds_train = rf.predict(train[feats])\npreds_train","ab6c9384":"accuracy_score(train['BAD'], preds_train)","64673cb5":"# Importar a bibilioteca que permite plotar gr\u00e1ficos com base nos modelos do scikit learn\nimport scikitplot as skplt","77ba548a":"# Plotando a matriz de confus\u00e3o para os dados de valida\u00e7\u00e3o\nskplt.metrics.plot_confusion_matrix(valid['BAD'], preds_val)","2feca9d0":"**B\u00f4nus 3:**\n    \nExplique o que \u00e9 `recall` na matriz de confus\u00e3o acima e d\u00ea 1 exemplo onde isso pode ser \u00fatil.","1a35ba6c":"# IESB\n# Gradua\u00e7\u00e3o em Ci\u00eancia de Dados\n## Disciplina - Minera\u00e7\u00e3o de Dados e Intelig\u00eancia Computacional\n## Avalia\u00e7\u00e3o - 04\/05\/2020\n\n### Descri\u00e7\u00e3o\nA base de dados \"Home Equity\" possui dados pessoas e informa\u00e7\u00f5es de empr\u00e9stimo de 5.960 empr\u00e9stimos recentes. Para cada empr\u00e9stimo existem 12 vari\u00e1veis registradas.\nA vari\u00e1vel alvo (`BAD`) indica quando o cliente n\u00e3o pagou o empr\u00e9stimo (valor 1), e quando ele honrou o compromisso (valor 0).\n\n### Objetivo\nCriar um modelo de ML usando RandomForest para prever se determinado cliente ir\u00e1 ou n\u00e3o honrar o empr\u00e9stimo contra\u00eddo.\n\nO desempenho do modelo deve ser medido pela m\u00e9trica de acur\u00e1cia (`accuracy_score`).","3fa705ba":"A* precis\u00e3o* \u00e9 a propor\u00e7\u00e3o de positivos classificados corretamente, ou seja, dos classificasdos como positivos\nquantos realmente s\u00e3o positivos. No caso acima os positivos s\u00e3o o zeros, porque ele indica que a pesssoa realmente\npagou o empr\u00e9stimo. Isso \u00e9 bom pois n\u00e3o precisaria se preocupar com pessoa que realmente vai pagar,e sim com\naquelas pessoas que o modelo previu que iria pagar e acabou n\u00e3o pagando e com as pessoas que ele previu que n\u00e3o\niria pagar mas acabou pagando. Nesse \u00faltimo seria ruim para quem precisa do empr\u00e9stimo porque essa pessoa ficaria\nsempre ligada naqueles em que ela acha que n\u00e3o vai pagar, por\u00e9m essa insistencia pode atrapalhar o pagamento.","a80b04fe":"**B\u00f4nus 2:**\n    \nExplique o que \u00e9 `precis\u00e3o` na matriz de confus\u00e3o acima e d\u00ea 1 exemplo onde isso pode ser \u00fatil.","4659917c":"**Itens avaliados:**\n\n1. Carregamento dos dados\n2. Verifica\u00e7\u00e3o para saber se os dados foram importados corretamente\n3. Pr\u00e9-processamento dos dados (preenchimento de valores em branco, transforma\u00e7\u00e3o de texto em n\u00famero)\n4. Separar dados em treino e valida\u00e7\u00e3o\n5. Instanciar e treinar uma `RandomForest`\n6. Avalia\u00e7\u00e3o da performance do modelo pela m\u00e9trica de acur\u00e1cia (`accuracy_score`).\n7. Buscar a melhoria da acur\u00e1cia mudando os par\u00e2metros do modelo RandomForest.","1420c54c":"A acur\u00e1cia nos dados de treino foi maior que nos dados de valida\u00e7\u00e3o. Acur\u00e1cia diz de um modo geral como o modelo perfomou.","ca4ee260":"Eu poderia ter apenas completado as vari\u00e1veis num\u00e9ricas que estavam com valores faltando e ter deixado as duas vari\u00e1veis do tipo *object* de lado na hora de definir as *feats*.","db6dc635":"# B\u00f4nus\n\nAp\u00f3s terminar o exerc\u00edcio e verificar que est\u00e1 cumprindo todos os itens a serem avaliados, voc\u00ea pode fazer os itens a seguir para ganhar pontos extra na prova:","6bea8c43":"**B\u00f4nus 1:**\n    \nPlote uma matriz de confus\u00e3o nas previs\u00f5es dos dados de valida\u00e7\u00e3o.","a78d923e":"O *recall* nos diz o qu\u00e3o bom meu modelo \u00e9 para prever os positivos.Na matriz acima o recall \u00e9 visto no quadrado onde o True label e Predicted label s\u00e3o iguais a 1, onde est\u00e1 o n\u00fameor 190. O *recall* pode ser \u00fatil em casos que deve saber se um paciente est\u00e1 ou n\u00e3o doente."}}