{"cell_type":{"4fc28450":"code","2aa8f7a6":"code","16eff4a4":"code","0d7072c7":"code","835f5f9d":"code","4f26c360":"code","eac37163":"code","fe6466a1":"code","5cc5568c":"code","58435a4c":"code","1bf57a08":"code","8096c3b6":"code","0db421a3":"code","d418b88c":"code","0742d9ad":"code","6fcadb16":"code","f66b22e1":"code","0c21142f":"code","02e406c3":"code","e228aa31":"code","a1a79da3":"code","db7171e8":"markdown","8b1f0c04":"markdown","6ba4c2de":"markdown","6739bce6":"markdown","29a2d796":"markdown","b9bfb156":"markdown","8128f957":"markdown","44253b3e":"markdown","dd553d5b":"markdown","2cfb3680":"markdown","898ed2a1":"markdown","2a5cb63a":"markdown","228c6ddb":"markdown","dfa6fd95":"markdown","1a947238":"markdown","0c20dd78":"markdown"},"source":{"4fc28450":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport matplotlib\n%matplotlib inline\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report,confusion_matrix\nfrom sklearn import linear_model\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC, LinearSVC\nfrom sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier, BaggingClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn import svm\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","2aa8f7a6":"data=pd.read_csv('..\/input\/indian_liver_patient.csv')","16eff4a4":"data.head()","0d7072c7":"data.isnull().sum()","835f5f9d":"data['Albumin_and_Globulin_Ratio'].fillna(data['Albumin_and_Globulin_Ratio'].mean(),inplace=True)","4f26c360":"data.describe(include='all')","eac37163":"data.columns","fe6466a1":"sns.countplot(label='count',x='Dataset',data=data);","5cc5568c":"sns.catplot(data=data,y='Age',x='Gender',hue='Dataset',jitter=0.4);","58435a4c":"sns.jointplot(\"Total_Bilirubin\", \"Direct_Bilirubin\", data=data, kind=\"reg\")","1bf57a08":"sns.jointplot(\"Aspartate_Aminotransferase\", \"Alamine_Aminotransferase\", data=data, kind=\"reg\")","8096c3b6":"sns.jointplot(\"Total_Protiens\", \"Albumin\", data=data, kind=\"reg\")","0db421a3":"data.corr()","d418b88c":"data = pd.concat([data,pd.get_dummies(data['Gender'], prefix = 'Gender')], axis=1)","0742d9ad":"X = data.drop(['Gender','Dataset','Direct_Bilirubin','Aspartate_Aminotransferase'], axis=1)\ny = data['Dataset']","6fcadb16":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=101)","f66b22e1":"logistic=LogisticRegression()\nlogistic.fit(X_train,y_train)\nlogispredicted=logistic.predict(X_test)\nprint('Training Score:',logistic.score(X_train, y_train))\nprint('Testing Score:',logistic.score(X_test, y_test))\nprint('Accuracy:',accuracy_score(y_test,logispredicted))\nprint('Confusion Matrix: \\n', confusion_matrix(y_test,logispredicted))","0c21142f":"svmclf = svm.SVC(gamma='scale')\nsvmclf.fit(X_train,y_train)\nsvmpredicted=logistic.predict(X_test)\nprint('Training Score:',svmclf.score(X_train, y_train))\nprint('Testing Score:',svmclf.score(X_test, y_test))\nprint('Accuracy:',accuracy_score(y_test,svmpredicted))\nprint('Confusion Matrix: \\n', confusion_matrix(y_test,svmpredicted))","02e406c3":"# Random Forest\n\nrandomforest = RandomForestClassifier(n_estimators=100)\nrandomforest.fit(X_train, y_train)\n#Predict Output\npredicted = randomforest.predict(X_test)\n\nprint('Training Score:',randomforest.score(X_train, y_train))\nprint('Testing Score:',randomforest.score(X_test, y_test))\nprint('Accuracy:',accuracy_score(y_test,predicted))\nprint('Confusion Matrix: \\n', confusion_matrix(y_test,predicted))","e228aa31":"linear = linear_model.LinearRegression()\nlinear.fit(X_train, y_train)\n#Predict Output\nlpredicted = linear.predict(X_test)\n\nprint('Training Score:',linear.score(X_train, y_train))\nprint('Testing Score:',linear.score(X_test, y_test))\n","a1a79da3":"models = pd.DataFrame({\n    'Model': [ 'Logistic Regression', 'SVM','Random Forest','Linear Regression'],\n    'Score': [ logistic.score(X_train, y_train), svmclf.score(X_train, y_train), randomforest.score(X_train, y_train),linear.score(X_train, y_train)],\n    'Test Score': [ logistic.score(X_test, y_test), svmclf.score(X_test, y_test), randomforest.score(X_test, y_test),linear.score(X_test, y_test)]})\nmodels.sort_values(by='Test Score', ascending=False)","db7171e8":"# SVM\n","8b1f0c04":"# Reading the data","6ba4c2de":"Since gender is categorical we need to convert it to numeric data.","6739bce6":"# Random Forest","29a2d796":"Since *Albumin_and_Globulin_Ratio* contains 4 null values,they either could be discarded or filled with suitable values. We are going to fill our values with mean of the column.","b9bfb156":"# Feature Selection\nI am discarding Direct_Bilirubin,Aspartate_Aminotransferase.\nFeatures Kept:\nTotal_Bilirubin\nAlamine_Aminotransferase\nTotal_Protiens\nAlbumin_and_Globulin_Ratio\nAlbumin","8128f957":"# Data Visualization\nWe will try to draw folowing insights from the dataset:\n    1. How gender and age impacts the disease?\n    2. Is there any direct relation between 'Total_Bilirubin' ,'Direct_Bilirubin',\n       'Alkaline_Phosphotase' , 'Alamine_Aminotransferase',\n       'Aspartate_Aminotransferase', 'Total_Protiens', 'Albumin',\n       'Albumin_and_Globulin_Ratio'*\n    ","44253b3e":"# Checking for the null or missing values in data","dd553d5b":"# Results of Analysis:\n1. Age and Gender affect the occurence of  disease.\n2. Some features are directly correlated like Total_Bilirubin and Direct_Bilirubin, Aspartate_Aminotransferase and Alamine_Aminotransferase, Total_Protiens and Albumin.\n3. Male has more the no of liver disease than female.","2cfb3680":"# Aim of the Exercise:\n1. Cleaning data-Check for missing values in dataset\n2. Data Visualization\n3. To analyze data and study correlation and trends between different features of the dataset.\n4. Discarding or incorporating new features in dataset\n5. Finding best algorithm for predictive modelling","898ed2a1":"# Logistic Regression","2a5cb63a":"# Linear regression","228c6ddb":"# Statistical Parameters of the dataset","dfa6fd95":"Since there seems a direct relationship between them ,so during features selection we can keep one feature from each of them.","1a947238":"# Model Predicting:\nI plan to train my model on different algorithms and check for best from them on basis of confusion matrix , accuracy etc.\n1. Logistic Regression\n2. SVM\n3. Random Forests\n4. Linear Regression","0c20dd78":"To me some features seem linearly correlated like Total_Bilirubin and Direct_Bilirubin, Aspartate_Aminotransferase and Alamine_Aminotransferase, Total_Protiens and Albumin.Going to perform jointplot for each of them."}}