{"cell_type":{"22dfdeb6":"code","734b98bc":"code","8f1e01d6":"code","16b80033":"code","0cf9a07e":"code","6193c5cc":"code","911aadc6":"code","660eaa62":"code","52fa84e4":"code","a99df6fa":"code","5ea8ff86":"code","256fd423":"code","6eaea2ee":"code","c2dfaffb":"code","09547ec1":"code","15dd3a77":"code","aa2a74a0":"code","fd4c8bff":"code","2316b211":"code","508ad85d":"code","843672a1":"code","fc1dc913":"code","7d7723a6":"code","dd10c42c":"code","6a22d6d3":"code","e21bdb96":"code","c81ef3f0":"code","47f11ca8":"code","4bd6d3a7":"code","6b041e24":"code","386c6663":"code","5a07b907":"code","b1a7402c":"markdown","26047a1c":"markdown","1eaf564b":"markdown","3723f51b":"markdown","383e06c5":"markdown","e2582743":"markdown","619e6759":"markdown","d617335d":"markdown","bd23e313":"markdown","0531326b":"markdown","421e26b1":"markdown"},"source":{"22dfdeb6":"#libraries\nimport numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style('darkgrid')\n\nfrom tensorflow import keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense,Dropout\nfrom keras.optimizers import Adam\n\nfrom sklearn.metrics import classification_report,confusion_matrix","734b98bc":"df = pd.read_csv(\"\/kaggle\/input\/creditcardfraud\/creditcard.csv\")\ndf.head()","8f1e01d6":"df.isnull().sum().sum()","16b80033":"df.shape","0cf9a07e":"df.describe().transpose()","6193c5cc":"df.info()","911aadc6":"df.Time.nunique()","660eaa62":"plt.figure(figsize=(10,8))\nsns.heatmap(df.corr(),cmap='BuPu');","52fa84e4":"class_un = df.Class.value_counts()\nclass_un","a99df6fa":"target = df['Class']\ndata = df.drop(columns=['Class','Time'])","5ea8ff86":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\n\ndata = sc.fit_transform(data)","256fd423":"data.shape","6eaea2ee":"from sklearn.decomposition import PCA\npca = PCA(n_components=10)\ndata_pca = pca.fit_transform(data)","c2dfaffb":"data_pca.shape","09547ec1":"from sklearn.model_selection import train_test_split\nx_train,x_test ,y_train,y_test = train_test_split(data_pca,target,test_size=0.35,random_state = 42)","15dd3a77":"print(x_train.shape,y_test.shape)","aa2a74a0":"print(y_test.value_counts())","fd4c8bff":"model = Sequential([\n    Dense(32,input_shape=(10,),activation='relu'),\n    \n    Dense(256,activation='relu'),\n    \n    \n    Dense(2,activation='softmax')\n])","2316b211":"model.summary()","508ad85d":"model.compile(optimizer=Adam(learning_rate=1e-4),loss='sparse_categorical_crossentropy',metrics=['accuracy'])","843672a1":"keras.utils.plot_model(model,\n                      show_shapes=True,\n                      show_dtype=True,\n                      show_layer_names=True)","fc1dc913":"#callbacks\nmy_calls = [keras.callbacks.EarlyStopping(monitor='val_loss',patience=3),\n            keras.callbacks.ModelCheckpoint(\"Model.h5\",verbose=1,save_best_only=True)]","7d7723a6":"#train\nhist = model.fit(x_train,y_train,epochs=30,validation_split=0.2,callbacks=my_calls)","dd10c42c":"model = keras.models.load_model('.\/Model.h5')","6a22d6d3":"#test\nmodel.evaluate(x_test,y_test)","e21bdb96":"plt.figure(figsize=(15,6))\n\nplt.subplot(1,2,1)\nplt.plot(hist.epoch,hist.history['accuracy'],label = 'Training')\nplt.plot(hist.epoch,hist.history['val_accuracy'],label = 'validation')\n\nplt.title(\"Accuracy\")\nplt.legend()\n\nplt.subplot(1,2,2)\nplt.plot(hist.epoch,hist.history['loss'],label = 'Training')\nplt.plot(hist.epoch,hist.history['val_loss'],label = 'validation')\n\nplt.title(\"Loss\")\nplt.legend()\nplt.show()","c81ef3f0":"pred = model.predict(x_test,verbose=1)","47f11ca8":"pred = [np.argmax(i) for i in pred]\npred[:10]","4bd6d3a7":"len(y_test)","6b041e24":"pd.DataFrame(pred).value_counts()","386c6663":"print(classification_report(y_test,pred))","5a07b907":"sns.heatmap(confusion_matrix(y_test,pred),annot=True,fmt='d');","b1a7402c":"**Class Distribution**","26047a1c":"**Defining Target and Data attributes**","1eaf564b":"**Scaling the Data**","3723f51b":"**Checkin for null values**","383e06c5":"**Predictions**","e2582743":"**Splitting into Train Test**","619e6759":"A lot less Fraudulent data points","d617335d":"**Dimensionality Reduction**","bd23e313":"**Model**","0531326b":"**Data Info**","421e26b1":"**Loss and accuracy Graphs**"}}