{"cell_type":{"5f758022":"code","507094df":"code","433298f5":"code","08a6b3a8":"code","75e56709":"code","b303b2d1":"code","5f86194c":"code","2dfcb0bd":"code","604744a9":"code","dc6d5458":"code","46e4da99":"code","49f593ad":"code","ee4cf17c":"code","9297791d":"code","ab680fdf":"code","9a5087c2":"code","b9ef5875":"markdown","6f5605e5":"markdown","97f1484c":"markdown","c4eee6ac":"markdown","e4627d70":"markdown","04e20f55":"markdown","a9fad59f":"markdown","da08ece5":"markdown","aa91f079":"markdown","3d3d2b3f":"markdown","0b4fe1db":"markdown"},"source":{"5f758022":"import numpy as np\nimport pandas as pd\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","507094df":"df = pd.read_csv('..\/input\/homework-1-data\/data.csv')\ndf.head()","433298f5":"np.__version__","08a6b3a8":"pd.__version__","75e56709":"print(\"average price of BMW cars in the dataset: \",round(np.mean(df[df['Make'] == 'BMW']['MSRP']), 2))","b303b2d1":"display(df[df['Year'] >= 2015].isnull().sum().to_frame().reset_index().rename({'index': 'Variables', 0: 'Missing Values'}, axis = 1).sort_values(by = 'Missing Values',ascending = False).head(2).style.background_gradient(cmap = 'Blues_r'))\nprint(\"Missing Values in Variable Engine HP: \", df[df['Year'] >= 2015]['Engine HP'].isnull().sum())","5f86194c":"\"\"\"\nCalculate the average \"Engine HP\" in the dataset.\nUse the fillna method and to fill the missing values in \"Engine HP\" with the mean value from the previous step.\n\"\"\"\nmean_hp_before =  df['Engine HP'].mean()\nprint(\"Mean of Engine HP BEFORE Imputing Missing Values\", round(mean_hp_before,2))\ndf['Engine HP'].fillna(mean_hp_before, inplace=True)","2dfcb0bd":"\"\"\"\nNow, calcualte the average of \"Engine HP\" again.\nHas it changed?\nRound both means before answering this questions. You can use the round function for that.\n\"\"\"\nmean_hp_after = df['Engine HP'].mean()\nprint(\"Mean of Engine HP BEFORE Imputing Missing Values\", round(mean_hp_before,2))\nprint(\"Mean of Engine HP AFTER Imputing Missing Values\", round(mean_hp_after,2))","604744a9":"\"\"\"\nSelect all the \"Rolls-Royce\" cars from the dataset.\nSelect only columns \"Engine HP\", \"Engine Cylinders\", \"highway MPG\".\nNow drop all duplicated rows using drop_duplicates method (you should get a dataframe with 7 rows).\n\"\"\"\ndf[df['Make'] == 'Rolls-Royce'][[\"Engine HP\",\"Engine Cylinders\", \"highway MPG\"]].drop_duplicates()","dc6d5458":"\"\"\"\nGet the underlying NumPy array. Let's call it X.\n\"\"\"\nX = np.array(df[df['Make'] == 'Rolls-Royce'][[\"Engine HP\",\"Engine Cylinders\", \"highway MPG\"]].drop_duplicates())\nX","46e4da99":"\"\"\"\nCompute matrix-matrix multiplication between the transpose of X and X. To get the transpose, use X.T. Let's call the result XTX.\n\"\"\"\nXTX=(X.T).dot(X)\nXTX","49f593ad":"\"\"\"\nInvert XTX.\n\"\"\"\nXTX_inv = np.linalg.inv(XTX)\nXTX_inv","ee4cf17c":"\"\"\"\nWhat's the sum of all the elements of the result?\n\"\"\"\nprint(\"sum of all the elements of the result: \",XTX_inv.sum())","9297791d":"\"\"\"\nCreate an array y with values [1000, 1100, 900, 1200, 1000, 850, 1300]\n\"\"\"\ny = np.array([1000, 1100, 900, 1200, 1000, 850, 1300])","ab680fdf":"\"\"\"\nMultiply the inverse of XTX with the transpose of X, and then multiply the result by y. Call the result w.\n\"\"\"\nw = ((np.linalg.inv(XTX)).dot(X.T)).dot(y)","9a5087c2":"\"\"\"\nWhat's the value of the first element of w?\n\"\"\"\nprint(\"Value of the first element of w: \", w[0])","b9ef5875":"<li style=\"font-family:'Goudy Old Style';font-weight: bold;font-size:30px;color:  #c1531f   \">Question 4<\/li>\n<ul style=\"font-family:cursive;font-size:15px;color:  #2025bd\">\n<li>Select a subset of cars after year 2015 (inclusive, i.e. 2015 and after). How many of them have missing values for Engine HP?<\/li>\n    <\/ul>","6f5605e5":"<li style=\"font-family:'Goudy Old Style';font-weight: bold;font-size:35px;color:  #c1531f   \">Importing Required Libraries<\/li>","97f1484c":"<p style=\"font-family:'Goudy Old Style';font-weight: bold;font-size:30px;color:  #c1531f   \"> <u>Question 6: <\/u><\/p>\n<ul style=\"font-family:cursive;font-size:15px;color:  #2025bd\">\n<li>Select all the \"Rolls-Royce\" cars from the dataset.<\/li>\n<li>Select only columns \"Engine HP\", \"Engine Cylinders\", \"highway MPG\".<\/li>\n<li>Now drop all duplicated rows using drop_duplicates method (you should get a dataframe with 7 rows).<\/li>\n<li>Get the underlying NumPy array. Let's call it X.<\/li>\n<li>Compute matrix-matrix multiplication between the transpose of X and X. To get the transpose, use X.T. Let's call the result XTX.<\/li>\n<li>Invert XTX.<\/li>\n<li>What's the sum of all the elements of the result?<\/li>\n    <u>Hint: if the result is negative, re-read the task one more time<\/u>\n<\/ul>","c4eee6ac":"<li style=\"font-family:'Goudy Old Style';font-weight: bold;font-size:30px;color:  #c1531f   \">Question 3<\/li>\n<ul style=\"font-family:cursive;font-size:15px;color:  #2025bd\">\n<li>What's the average price of BMW cars in the dataset?<\/li>\n    <\/ul>","e4627d70":"<li style=\"font-family:'Goudy Old Style';font-weight: bold;font-size:35px;color:  #c1531f   \">ML Zoomcamp Session 1 Homework Questions<\/li>\n\n<div class=\"alert alert-info\" role=\"alert\" style=\"font-family:cursive;font-size:15px;color:  #2025bd\">\n\n<p style=\"font-family:cursive;font-size:15px;color:  #2025bd\"><u>Question 1:<\/u><\/p>\n<ul>\n<li>What's the version of NumPy that you installed?<\/li>\n<\/ul>\n    \n<p style=\"font-family:cursive;font-size:15px;color:  #2025bd\"><u>Question 2:<\/u><\/p>\n<ul>\n<li>What's the version of Pandas?<\/li>\n<\/ul>    \n    \n<p style=\"font-family:cursive;font-size:15px;color:  #2025bd\"><u>Question 3:<\/u><\/p>\n<ul>\n<li>What's the average price of BMW cars in the dataset?<\/li>\n<\/ul>  \n    \n<p style=\"font-family:cursive;font-size:15px;color:  #2025bd\"><u>Question 4:<\/u><\/p>\n<ul>\n<li>Select a subset of cars after year 2015 (inclusive, i.e. 2015 and after). How many of them have missing values for Engine HP?<\/li>\n<\/ul> \n\n<p style=\"font-family:cursive;font-size:15px;color:  #2025bd\"> <u>Question 5: <\/u><\/p>\n<ul>\n<li>Calculate the average \"Engine HP\" in the dataset.<\/li>\n<li>Use the fillna method and to fill the missing values in \"Engine HP\" with the mean value from the previous step.<\/li>\n<li> Now, calcualte the average of \"Engine HP\" again.<\/li>\n<li> Has it changed?<\/li>\n<li> Round both means before answering this questions. You can use the round function for that:<\/li>\n<code style=\"font-family:cursive;font-size:15px;color:  #2025bd\">print(round(mean_hp_before))<\/code>\n<code style=\"font-family:cursive;font-size:15px;color:  #2025bd\">print(round(mean_hp_after))<\/code><\/ul>\n    \n<p style=\"font-family:cursive;font-size:15px;color:  #2025bd\"><u>Question 6:<\/u><\/p> \n<ul>\n<li>Select all the \"Rolls-Royce\" cars from the dataset.<\/li>\n<li>Select only columns \"Engine HP\", \"Engine Cylinders\", \"highway MPG\".<\/li>\n<li>Now drop all duplicated rows using drop_duplicates method (you should get a dataframe with 7 rows).<\/li>\n<li>Get the underlying NumPy array. Let's call it X.<\/li>\n<li>Compute matrix-matrix multiplication between the transpose of X and X. To get the transpose, use X.T. Let's call the result XTX.<\/li>\n<li>Invert XTX.<\/li>\n<li>What's the sum of all the elements of the result?<\/li>\n    <u>Hint: if the result is negative, re-read the task one more time<\/u>\n<\/ul>\n    \n<p style=\"font-family:cursive;font-size:15px;color:  #2025bd\"><u>Questions 7<\/u><\/p>\n<ul>\n<li>Create an array y with values [1000, 1100, 900, 1200, 1000, 850, 1300].<\/li>\n<li>Multiply the inverse of XTX with the transpose of X, and then multiply the result by y. Call the result w.<\/li>\n<li>What's the value of the first element of w?.<\/li>\n    <u>Note: You just implemented linear regression. We'll talk about it in the next lesson.<\/u>\n    <\/ul>\n            \n\n\n<\/div>","04e20f55":"<p style=\"font-family:'Goudy Old Style';font-weight: bold;font-size:30px;color:  #c1531f   \"> <u>Question 7: <\/u><\/p>\n<ul style=\"font-family:cursive;font-size:15px;color:  #2025bd\">\n<li>Create an array y with values [1000, 1100, 900, 1200, 1000, 850, 1300].<\/li>\n<li>Multiply the inverse of XTX with the transpose of X, and then multiply the result by y. Call the result w.<\/li>\n<li>What's the value of the first element of w?.<\/li>\n    <u>Note: You just implemented linear regression. We'll talk about it in the next lesson.<\/u>\n    <\/ul>","a9fad59f":"<li style=\"font-family:'Goudy Old Style';font-weight: bold;font-size:30px;color:  #c1531f   \">Question 1<\/li>\n<ul style=\"font-family:cursive;font-size:15px;color:  #2025bd\">\n<li>1. What's the version of NumPy that you installed?<\/li>\n    <\/ul>\n","da08ece5":"<li style=\"font-family:'Goudy Old Style';font-weight: bold;font-size:30px;color:  #c1531f   \">Question 2<\/li>\n<ul style=\"font-family:cursive;font-size:15px;color:  #2025bd\">\n<li>What's the version of Pandas?<\/li>\n    <\/ul>","aa91f079":"<p style=\"font-family:'Goudy Old Style';font-weight: bold;font-size:30px;color:  #c1531f   \"> <u>Question 5: <\/u><\/p>\n<ul style=\"font-family:cursive;font-size:15px;color:  #2025bd\">\n<li>Calculate the average \"Engine HP\" in the dataset.<\/li>\n<li>Use the fillna method and to fill the missing values in \"Engine HP\" with the mean value from the previous step.<\/li>\n<li> Now, calcualte the average of \"Engine HP\" again.<\/li>\n<li> Has it changed?<\/li>\n<li> Round both means before answering this questions. You can use the round function for that:<\/li>\n<code style=\"font-family:cursive;font-size:15px;color:  #2025bd\">print(round(mean_hp_before))<\/code>\n<code style=\"font-family:cursive;font-size:15px;color:  #2025bd\">print(round(mean_hp_after))<\/code><\/ul>\n    ","3d3d2b3f":"<li style=\"font-family:'Goudy Old Style';font-weight: bold;font-size:35px;color:  #c1531f   \">Data Set for this Homework<\/li>\n\n<div class=\"alert alert-info\" role=\"alert\"  style=\"font-family:cursive;font-size:15px;color:  #2025bd\">\n    <a style=\"color:  black\" href=\"https:\/\/raw.githubusercontent.com\/alexeygrigorev\/mlbookcamp-code\/master\/chapter-02-car-price\/data.csv\" target=\"_blank\"> <u>Dataset for Homework<\/u><\/a>\n<\/div>","0b4fe1db":"<li style=\"font-family:'Goudy Old Style';font-weight: bold;font-size:35px;color:  #c1531f   \">Loading Data<\/li>"}}