{"cell_type":{"783cfe67":"code","508b2cfc":"code","c614ce3f":"code","bedf9603":"code","c5e0a245":"code","ebe00e30":"code","5b47ac16":"code","5d7d5345":"code","2f7d840a":"code","3fc706a6":"markdown","68b6c9b7":"markdown","cf3f7662":"markdown","4e8a45f2":"markdown","db4c91dd":"markdown","568fb3ce":"markdown","3702ab73":"markdown"},"source":{"783cfe67":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nfrom subprocess import check_output\nprint(check_output([\"ls\", \"..\/input\"]).decode(\"utf8\"))\n\n# Any results you write to the current directory are saved as output.","508b2cfc":"#Import stuff\n\nimport numpy as np\nimport random\nimport itertools\nimport librosa\nimport IPython.display as ipd\nimport matplotlib.pyplot as plt\n\n%matplotlib inline","c614ce3f":"def load_audio_file(file_path):\n    input_length = 44100*5\n    data = librosa.core.load(file_path,sr=44100)[0] #, sr=16000\n    if len(data)>input_length:\n        data = data[:input_length]\n    else:\n        data = np.pad(data, (0, max(0, input_length - len(data))), \"constant\")\n    return data\ndef plot_time_series(data):\n    fig = plt.figure(figsize=(14, 8))\n    plt.title('Raw wave ')\n    plt.ylabel('Amplitude')\n    plt.plot(np.linspace(0, 5, len(data)), data)\n    plt.show()","bedf9603":"data = load_audio_file(\"..\/input\/as712\/comp\/train\/cat\/1-34094-A-5.wav\")\nplot_time_series(data)","c5e0a245":"#Hear it ! \nipd.Audio(data, rate=44100)","ebe00e30":"# Adding white noise \nwn = np.random.randn(len(data))\ndata_wn = data + 0.005*wn\nplot_time_series(data_wn)\n# We limited the amplitude of the noise so we can still hear the word even with the noise, \n#which is the objective\nipd.Audio(data_wn, rate=44100)","5b47ac16":"# Shifting the sound\ndata_roll = np.roll(data, 5000)\nplot_time_series(data_roll)\nipd.Audio(data_roll, rate=44100)","5d7d5345":"# stretching the sound\ndef stretch(data, rate=1):\n    input_length = 44100*5\n    data = librosa.effects.time_stretch(data, rate)\n    if len(data)>input_length:\n        data = data[:input_length]\n    else:\n        data = np.pad(data, (0, max(0, input_length - len(data))), \"constant\")\n\n    return data\n\n\ndata_stretch =stretch(data, 0.5)\nprint(\"This makes the sound deeper but we can still hear 'cat' sound \")\nplot_time_series(data_stretch)\nipd.Audio(data_stretch, rate=44100)","2f7d840a":"data_stretch =stretch(data, 2.0)\nprint(\"Higher frequencies  \")\nplot_time_series(data_stretch)\nipd.Audio(data_stretch, rate=44100)","3fc706a6":"# You can now plug all those transformations in your keras data generator and see your LB rank go up :D","68b6c9b7":"# Data Augmentation\uc774\ub780 \n\n## Image Data Augmentation \n\nImage Data augmentation\uc5d0 \ub300\ud55c \uc124\uba85\uc744 \ub2e8 \ub4a4 \uc774\ub97c \uc624\ub514\uc624\uc5d0 \uc801\uc6a9\ud558\ub294 \ub300\ub7b5\uc801\uc778 \uc124\uba85\uc744 \ub2ec\uaca0\uc2b5\ub2c8\ub2e4.\n\n\uc544\ub798\uc758 \ub0b4\uc6a9\uc740[  http:\/\/nmhkahn.github.io\/CNN-Practice](http:\/\/http:\/\/nmhkahn.github.io\/CNN-Practice) \uc5d0\uc11c \uac00\uc838\uc654\uc2b5\ub2c8\ub2e4. \n\n>Data augmentation\uc740 CNN\uc758 \uc131\ub2a5\uc744 \ub192\uc774\uae30 \uc704\ud574 \uc0ac\uc6a9\ud558\ub294 \ubc29\ubc95\uc774\ub2e4. \uc704 \uadf8\ub9bc\uacfc \uac19\uc774 \ud559\uc2b5(\ud639\uc740 \ud14c\uc2a4\ud2b8) \uc774\ubbf8\uc9c0\ub97c \ub514\uc2a4\ud06c\uc5d0\uc11c \uc77d\uc740 \ud6c4, \uc774\ubbf8\uc9c0\ub97c \uc5ec\ub7ec \ubc29\ubc95\uc744 \ud1b5\ud574 \ubcc0\ud615(transform) \ud55c \ub4a4\uc5d0 \ub124\ud2b8\uc6cc\ud06c\uc758 \uc785\ub825 \uc774\ubbf8\uc9c0\ub85c \uc0ac\uc6a9\ud558\ub294 \ubc29\uc2dd\uc774\ub2e4. \ub9cc\uc57d \uace0\uc591\uc774 \uc774\ubbf8\uc9c0\uc5d0\uc11c \ubaa8\ub4e0 \ud53d\uc140\uc744 \uc624\ub978\ucabd\uc73c\ub85c 1\uce78 \uc774\ub3d9\ud558\uc5ec\ub3c4 \uc0ac\ub78c\uc758 \ub208\uc5d0\ub294 \uac19\uc740 \uc774\ubbf8\uc9c0\ub85c \ubcf4\uc778\ub2e4. \ud558\uc9c0\ub9cc \ucef4\ud4e8\ud130\ub294 \uc774\ubbf8\uc9c0\ub97c \ud53d\uc140 \ubca1\ud130\uc758 \ud615\ud0dc\ub85c \ud45c\ud604\ud558\uace0 \uc778\uc2dd\ud558\uae30 \ub54c\ubb38\uc5d0 1\ud53d\uc140\uc529 \uc774\ub3d9\ud55c \uace0\uc591\uc774 \uc774\ubbf8\uc9c0\ub294 \uc6d0\ubcf8 \uc774\ubbf8\uc9c0\uc640 \ub2e4\ub978 \uac83\uc73c\ub85c \uc778\uc2dd\ud558\uac8c \ub41c\ub2e4. \uc774\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud574 data augmentation\uc744 \uc0ac\uc6a9\ud558\ub294 \uac83\uc774\ub2e4.\n>\n>\ub2e4\uc2dc \uc815\ub9ac\ud558\uc790\uba74 data augmentation\uc740 \uc774\ubbf8\uc9c0\uc758 \ub808\uc774\ube14\uc744 \ubcc0\uacbd\ud558\uc9c0 \uc54a\uace0 \ud53d\uc140\uc744 \ubcc0\ud654 \uc2dc\ud0a4\ub294 \ubc29\ubc95\uc774\uba70, \ubcc0\ud615\ub41c \ub370\uc774\ud130\ub97c \uc774\uc6a9\ud558\uc5ec \ud559\uc2b5\uc744 \uc9c4\ud589\ud55c\ub2e4. \ub610\ud55c AlexNet\ubd80\ud130 \uc9c0\uae08\uae4c\uc9c0 \uac70\uc758 \ubaa8\ub4e0 \ub124\ud2b8\uc6cc\ud06c\ub4e4\uc774 data augmentation\uc744 \uc0ac\uc6a9\ud558\ub294 \ub4f1, \ub9e4\uc6b0 \ubcf4\ud3b8\uc801\uc73c\ub85c \uc0ac\uc6a9\ub418\ub294 \ubc29\ubc95\uc774\ub2e4. \uadf8\ub7fc data augmentation\uc740 \uc5b4\ub5a4 \ubc29\ubc95\uc744 \uc0ac\uc6a9\ud558\uc5ec \uc774\ubbf8\uc9c0\ub97c \ubcc0\ud615\ud558\ub294\uc9c0 \uc54c\uc544\ubcf4\uc790.\n![](http:\/\/nmhkahn.github.io\/assets\/CNN-Practice\/flip.png)\n\n\uc704\uc758 \uadf8\ub9bc\ucc98\ub7fc flip\uc744 \ud558\ub354\ub77c\ub3c4 \ub611\uac19\uc740 \uace0\uc591\uc774\uc5d0 \ub300\ud55c \ub370\uc774\ud130\uc774\ubbc0\ub85c \ud559\uc2b5\uc5d0 \uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 data\ub294 \ub298\uc5b4\ub098\uac8c \ub429\ub2c8\ub2e4. \n\n\n## Audio Data Augmentation\n\nAudio Data augmentation\uc5d0 \ub300\ud55c \uc544\ub798\uc758 \ucee4\ub110\uc740 [https:\/\/www.kaggle.com\/CVxTz\/audio-data-augmentation](http:\/\/https:\/\/www.kaggle.com\/CVxTz\/audio-data-augmentation) \uc758 \ucee4\ub110\uc744 \uadf8\ub300\ub85c \uc0ac\uc6a9\ud558\uc600\uc73c\uba70 \ucd94\uac00\uc801\uc778 \uc124\uba85\uc744 \ub2ec\uc558\uc2b5\ub2c8\ub2e4. \n\naudio\uc5d0 \ub300\ud574\uc11c\ub294 \ub2e4\uc74c\uacfc \uac19\uc740 \ubc29\ubc95\ub4e4\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \n\n- shift : audio data\ub97c \uc57d\uac04 \ubc00\uc5b4\uc90d\ub2c8\ub2e4. \uc8fc\uc5b4\uc9c4 data set\uc740 \ubaa8\ub450 5\ucd08\uc778\ub370 audio event\uac00 \uc2dc\uc791\ub418\ub294 \ubd80\ubd84\uc774 \uc870\uae08 \ubc14\ub010\ub2e4\uace0 \ud574\ub3c4 \uac19\uc740 event\ub780 \uc0ac\uc2e4\uc740 \ubc14\ub00c\uc9c0 \uc54a\uc73c\ubbc0\ub85c \uc774 \ubc29\ubc95\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \n- adding noise  : noise\ub97c \ucd94\uac00\ud558\uc5ec \uc90d\ub2c8\ub2e4.  white noise\ub97c \uc57d\uac04 \ucd94\uac00\ud558\uc5ec \uc7a1\uc74c\uc5d0 \ub300\ud574\uc11c \uac15\uc778\ud55c \ubaa8\ub378\uc744 \ud559\uc2b5\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \n- stretching : audio data\uc758 \ube60\ub974\uae30\ub97c \uc870\uc815\ud558\uc5ec augmentation\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ub2e4\ub9cc \ube60\ub974\uae30\ub97c \ub108\ubb34 \uc870\uc808 \ud560 \uacbd\uc6b0\uc5d0\ub294 \uc88b\uc740 \uacb0\uacfc\ub97c \uc5bb\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \n\n\uc544\ub798\uc758 \ucf54\ub4dc\ub4e4\uc740 `Tensorflow speech recognitinon challenge`\uc5d0\uc11c \uc0ac\uc6a9\ub41c dataset\uc5d0 \uc9c4\ud589\ub41c \ucf54\ub4dc\uc785\ub2c8\ub2e4. \uacbd\ub85c\ub294 dataset\uc5d0 \ub9de\uac8c \ubc14\uafd4\ub1a8\uc73c\ub098 \uc218\uc815\uc774 \ud544\uc694\ud569\ub2c8\ub2e4. ","cf3f7662":"# Streching \nstretch \ud568\uc218\uc758 rate\uac00 1\ubcf4\ub2e4 \uc791\uc73c\uba74 \ub290\ub824\uc9c0\uace0, 1\ubcf4\ub2e4 \ud06c\uba74 \ube68\ub77c\uc9d1\ub2c8\ub2e4. \n\n\uc6d0\ub798 \ucf54\ub4dc\ub294 0.8\uacfc 1.2\ub85c \ub418\uc5b4\uc788\ub294\ub370 \ub4e3\uae30\uc5d0\ub294 \ubcc4\ucc28\uc774\uac00 \uc5c6\uc5b4\uc11c \uc870\uae08 \uc218\uce58\ub97c \uc870\uc815\ud588\uc2b5\ub2c8\ub2e4. \n\n\ud559\uc2b5\uc2dc\uc5d0\ub294 \uc77c\uc815 \ubc94\uc704\ub0b4\uc5d0\uc11c \ub4e3\uae30\uc5d0 \uc815\uc0c1\uc77c \uc815\ub3c4\ub85c \ubc14\uafd4\uc8fc\uc138\uc694.","4e8a45f2":"# Shifting\nnp.roll \ud568\uc218\ub294 matrix\ub97c rotate\uc2dc\ud0a4\ub294 \uae30\ub2a5\uc744 \uac16\uc2b5\ub2c8\ub2e4.\n5000\uc73c\ub85c \ucf54\ub4dc\ub97c \uc791\uc131\ud574\ub450\uc5c8\ub294\ub370 5000\ud504\ub808\uc784\ub4e4\uc744 \ubc00\uc5b4\uc900\ub2e4\uace0 \uc0dd\uac01\ud558\uc2dc\uba74 \ub429\ub2c8\ub2e4. ","db4c91dd":"#\uc774","568fb3ce":" ## Data augmentation definition :\n* Data augmentation is the process by which we create new synthetic training samples by adding small perturbations on our initial training set.\n* The objective is to make our model invariant to those perturbations and enhace its ability to generalize.\n* In order to this to work adding the perturbations must conserve the same label as the original training sample.\n* In images data augmention can be performed by shifting the image, zooming, rotating ... \n* In our case we will add noise, stretch and roll, pitch shift ... ","3702ab73":"## White Noise \ucd94\uac00\n\uc544\ub798\uc758 \ucf54\ub4dc\ub97c \ud1b5\ud574\uc11c \ucd94\uac00\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\n\uc5ec\ub7ec\ubd84\uc774 \uc2e4\uc2b5\uc2dc\uac04\uc5d0 \ubc30\uc6b4 librosa library\ub85c \uad6c\ud604 \uac00\ub2a5\ud569\ub2c8\ub2e4."}}