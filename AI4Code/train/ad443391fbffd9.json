{"cell_type":{"1f0fc16d":"code","6f154ef9":"code","35df5aa4":"code","f813938a":"code","ff845553":"code","a21ece4f":"code","fcfac325":"code","264f726a":"code","b93b7463":"code","5342e26e":"code","5ba1f92b":"code","f035d80a":"code","d823e28d":"code","176646b7":"code","2c2d1241":"code","61967c2f":"code","9cc0a311":"code","ce99c844":"code","2a444117":"code","57d86f50":"code","92126b99":"code","51fa5d4e":"code","1cce09f8":"code","ec79c084":"code","23613227":"code","2be3eaca":"code","4e8a9713":"code","1e1e49b3":"code","aca1442b":"code","47fc2140":"code","1039e37e":"code","3d9c8bb3":"code","4176d48f":"code","3a444a8c":"code","cbbd65ba":"code","6697a692":"code","21f1b4b9":"code","5b4ed3c7":"code","70e7c571":"code","17d53a9c":"code","4ae19ecf":"code","5a052e05":"code","bae5054f":"code","d7480a78":"code","a8b5de86":"code","166b82b0":"code","7a1037ed":"code","4bb849db":"code","27fd412a":"code","1b240913":"code","e46beadb":"code","c45796e2":"code","234fe558":"code","fd834831":"code","b1fc992a":"code","20a1b29d":"code","bd607768":"code","34c0c54f":"code","95cbec2a":"code","8f58cb4a":"code","aeb15654":"code","22a82a84":"code","7dd5998f":"code","b597eed3":"code","45fe1c76":"code","3016cc0f":"code","7d40c5c7":"code","c154ab18":"code","8873e747":"code","cfb448e9":"code","289f46bf":"code","b14c7835":"code","c831e31e":"code","1df9d663":"code","fa3f76ed":"code","910995ff":"code","c959e258":"code","232f5a0e":"code","ee3af7c2":"code","8c593410":"code","2831dcca":"code","82816058":"code","1a937291":"code","61b60d04":"code","37549c82":"code","eb1c11d6":"code","d9619010":"code","cd269267":"code","1c20a440":"code","386daefd":"code","5cebcfaf":"code","5214c69c":"code","4387ef40":"code","c86ba9d8":"code","212f8583":"code","7e83ce7c":"code","f46b1ae5":"code","674c059a":"code","9ac76ba7":"code","a1f4bc8b":"code","9b7069cd":"markdown","f37237e6":"markdown","04217e30":"markdown","2df9830e":"markdown","3cd6f536":"markdown","d018eae8":"markdown","c495cde4":"markdown","b723b3a1":"markdown","fe77bd64":"markdown","2f3f334a":"markdown","91bb338c":"markdown","4732d391":"markdown"},"source":{"1f0fc16d":"import os\nimport gc\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session\n\n# \u53ef\u89c6\u5316\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\n# \u6570\u636e\u5904\u7406\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# \u5efa\u6a21\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import recall_score, accuracy_score","6f154ef9":"train = pd.read_csv(\"\/kaggle\/input\/boolart-user-behavior-prediction\/Behavior.csv\/Behavior.csv\")\ntest = pd.read_csv(\"\/kaggle\/input\/boolart-user-behavior-prediction\/Test.csv\")\ncategory = pd.read_csv(\"\/kaggle\/input\/boolart-user-behavior-prediction\/Category.csv\")","35df5aa4":"train.head()","f813938a":"test.head()","ff845553":"category.head()","a21ece4f":"type(train)","fcfac325":"train.head()","264f726a":"train.shape","b93b7463":"train.UserID.nunique()","5342e26e":"train.ItemID.nunique()","5ba1f92b":"train.CategoryID.nunique()","f035d80a":"train.BehaviorType.unique()","d823e28d":"category.head()","176646b7":"category.shape","2c2d1241":"category.ItemID.nunique()","61967c2f":"category.CategoryID.nunique()","9cc0a311":"test.head()","ce99c844":"test.shape","2a444117":"test.UserID.nunique()","57d86f50":"test.ItemID.nunique()","92126b99":"train.info()","51fa5d4e":"test[\"UserID\"].unique()","1cce09f8":"test_UserID = set(test[\"UserID\"].unique().tolist())\ntest_ItemID = set(test[\"ItemID\"].unique().tolist())","ec79c084":"type(test_UserID)","23613227":"len(test_UserID)","2be3eaca":"test.UserID.nunique()","4e8a9713":"train.UserID[:5]","1e1e49b3":"train.UserID[:5].isin(test_UserID)","aca1442b":"use_rows = train.UserID.isin(test_UserID) | train.ItemID.isin(test_ItemID)","47fc2140":"use_rows.head()","1039e37e":"use_rows.astype(float).sum()","3d9c8bb3":"use_rows.astype(float).mean()","4176d48f":"train = train.loc[use_rows]","3a444a8c":"train.head()","cbbd65ba":"train = train.reset_index(drop=True)","6697a692":"train.head()","21f1b4b9":"train[\"Timestamp\"] = pd.to_datetime(train.Timestamp, unit=\"s\")","5b4ed3c7":"train.head()","70e7c571":"train.dtypes","17d53a9c":"del test_UserID\ndel test_ItemID;\ngc.collect()","4ae19ecf":"train.Timestamp.max()","5a052e05":"train.Timestamp.min()","bae5054f":"train.Timestamp.dt.hour","d7480a78":"train.Timestamp.dt.weekday","a8b5de86":"train.Timestamp.dt.hour.value_counts(normalize=True).sort_index()","166b82b0":"train.Timestamp.dt.hour.value_counts(normalize=True).sort_index().plot(kind=\"bar\")","7a1037ed":"for beh in train.BehaviorType.unique():\n    plt.figure()\n    plt.title(beh)\n    train[train.BehaviorType == beh].Timestamp.dt.hour.value_counts(normalize=True).sort_index().plot()","4bb849db":"train.BehaviorType.value_counts(normalize=True)","27fd412a":"train.BehaviorType.value_counts(normalize=True)[\"cart\"] \/ train.BehaviorType.value_counts(normalize=True)[\"pv\"]","1b240913":"train.BehaviorType.value_counts(normalize=True)[\"buy\"] \/ train.BehaviorType.value_counts(normalize=True)[\"cart\"]","e46beadb":"100 * 0.068 * 0.43","c45796e2":"train.UserID.nunique()","234fe558":"user_interact_cnt = train.UserID.value_counts()","fd834831":"user_interact_cnt","b1fc992a":"user_interact_cnt.describe()","20a1b29d":"user_interact_cnt.sort_values(ascending=False)","bd607768":"user_interact_cnt.sort_values(ascending=False).reset_index(drop=True).plot()","34c0c54f":"user_interact_cnt.sort_values(ascending=False)[:100].sum()","95cbec2a":"user_interact_cnt.sum()","8f58cb4a":"user_interact_cnt.sort_values(ascending=False)[:100].sum() \/ user_interact_cnt.sum()","aeb15654":"train.loc[train.BehaviorType == \"buy\"].head()","22a82a84":"train[train.BehaviorType == \"buy\"].UserID.value_counts().sort_values(ascending=False).head(10)","7dd5998f":"user_behavior_cnt = train.groupby([\"UserID\", \"BehaviorType\"])[\"BehaviorType\"].count().rename(\"count\").reset_index()","b597eed3":"user_behavior_cnt","45fe1c76":"user_behavior_cnt = user_behavior_cnt.pivot_table(index=\"UserID\", values=\"count\", columns=\"BehaviorType\")","3016cc0f":"user_behavior_cnt.head()","7d40c5c7":"user_behavior_cnt = user_behavior_cnt.fillna(0.)","c154ab18":"user_behavior_cnt.head()","8873e747":"user_behavior_cnt[\"buy_pv_rate\"] = user_behavior_cnt[\"buy\"] \/ user_behavior_cnt[\"pv\"]","cfb448e9":"user_behavior_cnt.loc[user_behavior_cnt.buy_pv_rate > 1, \"buy_pv_rate\"] = 0.","289f46bf":"user_behavior_cnt.buy_pv_rate = user_behavior_cnt.buy_pv_rate.fillna(0.)","b14c7835":"user_behavior_cnt.buy_pv_rate.describe()","c831e31e":"sns.displot(user_behavior_cnt.buy_pv_rate.values)","1df9d663":"train.CategoryID.value_counts(normalize=True).sort_values(ascending=False).reset_index(drop=True).plot()","fa3f76ed":"train.CategoryID.value_counts(normalize=True).sort_values(ascending=False).head(10)","910995ff":"train[train.BehaviorType == \"buy\"].CategoryID.value_counts(normalize=True).sort_values(ascending=False).head(10)","c959e258":"train.ItemID.value_counts(normalize=True).sort_values(ascending=False).reset_index(drop=True).plot()","232f5a0e":"train.groupby(\"CategoryID\").apply(lambda group: group[group.BehaviorType==\"buy\"].ItemID.value_counts().rank())","ee3af7c2":"sub_users = train.UserID.unique()[:1000]","8c593410":"train = train[train.UserID.isin(sub_users)]","2831dcca":"user = pd.DataFrame(index=sub_users)","82816058":"train[\"hour\"] = train[\"Timestamp\"].dt.hour","1a937291":"train.head()","61b60d04":"user = user.merge((train.groupby(\"UserID\")[\"hour\"].apply(lambda g: g.value_counts().sort_values().index[-1])).rename(\"active_hour\"), left_index=True, right_index=True)","37549c82":"user.head()","eb1c11d6":"user.active_hour.value_counts()","d9619010":"# 7\u5929\u6d88\u8d39\u6b21\u6570\nuser = user.merge((train[train.BehaviorType == \"buy\"].UserID.value_counts()).rename(\"buy_count\"), \n                  left_index=True, right_index=True, how=\"left\")","cd269267":"# 7\u5929pv\u6b21\u6570\nuser = user.merge((train[train.BehaviorType == \"pv\"].UserID.value_counts()).rename(\"pv_count\"), \n                  left_index=True, right_index=True, how=\"left\")","1c20a440":"# \u8d2d\u4e70\u8f6c\u5316\u7387\n\nuser.buy_count.fillna(0, inplace=True)\nuser[\"buy_per_pv\"] = user.buy_count \/ user.pv_count","386daefd":"user.head()","5cebcfaf":"buy = train[train.BehaviorType == \"buy\"].drop_duplicates()[[\"UserID\", \"ItemID\", \"Timestamp\"]].rename(columns={\"Timestamp\": \"buy_time\"})","5214c69c":"buy.head()","4387ef40":"pv = train[train.BehaviorType == \"pv\"].groupby([\"UserID\", \"ItemID\"])[\"Timestamp\"].apply(lambda g: g.sort_values().iloc[0]).rename(\"pv_time\").reset_index()","c86ba9d8":"pv","212f8583":"buy_pv = buy.merge(pv, on=[\"UserID\", \"ItemID\"], how=\"left\")","7e83ce7c":"buy_pv[\"decision_cost\"] = (buy_pv[\"buy_time\"] - buy_pv[\"pv_time\"]).dt.total_seconds() \/ 60 \/ 60","f46b1ae5":"buy_pv.loc[buy_pv.decision_cost <= 0, \"decision_cost\"] = np.nan","674c059a":"buy_pv","9ac76ba7":"user = user.merge(buy_pv[[\"UserID\", \"decision_cost\"]], right_on=\"UserID\", left_index=True, how=\"left\")","a1f4bc8b":"user","9b7069cd":"## \u6570\u636e\u5904\u7406\ud83d\udcbb","f37237e6":"# \u6570\u636e\u5206\u6790\ud83d\udc7b\n- \u65f6\u95f4\n- \u884c\u4e3a\n- \u7528\u6237\n- \u5546\u54c1\n- \u54c1\u7c7b\n\n","04217e30":"***\u957f\u5c3e\u6548\u5e94***","2df9830e":"## \u5546\u54c1 & \u54c1\u7c7b","3cd6f536":"## \u65f6\u95f4","d018eae8":"# \u6570\u636e\u79d1\u5b66\u9886\u57df\u5c31\u4e1a\ud83d\udcca\n\n## \u5c97\u4f4d\u5212\u5206\u4e0e\u6280\u672f\u6808\n\n- \u6570\u636e\u5206\u6790\uff08Bussiness Analysis BA\/ Data Analysis DA\uff09\n  - PyThon\n  - SQL\n  - Excel\n  - \u7edf\u8ba1\u5206\u6790\n- \u6570\u636e\u6316\u6398\uff08Data Scientist DS\/ Data Mining DM) \n  - \u805a\u7c7b\u7b97\u6cd5\n  - \u76d1\u7763\u5b66\u4e60\n  - \u56fe\u6316\u6398\n  - \u5927\u89c4\u6a21\u6570\u636e\u5904\u7406\uff08Hive\/Spark\uff09\n- \u7b97\u6cd5\u5de5\u7a0b\u5e08\n  - \u6df1\u5ea6\u5b66\u4e60\n  - \u63a8\u8350\u7b97\u6cd5\n  - \u6a21\u578b\u90e8\u7f72\u4e0e\u4f18\u5316\n\n## \u516c\u53f8 & \u5730\u533a\n\n  - \u4e00\u7ebf\uff1a\u5b57\u8282\u3001\u963f\u91cc\u3001\u817e\u8baf\n  - \u4e8c\u7ebf\uff1a\u7f8e\u56e2\u3001\u767e\u5ea6\u3001\u6ef4\u6ef4\u3001\u5feb\u624b\u3001\u4eac\u4e1c\u3001\u62fc\u591a\u591a\u3001\u5c0f\u7c73\u3001\u77e5\u4e4e\u7b49\n  - \u4e09\u7ebf\uff1a58\u3001\u643a\u7a0b\u3001\u540c\u7a0b\u3001Oppo\u7b49\n  - \u5176\u4ed6\n\n\u6210\u90fd\u5730\u533a\uff1a\u7f8e\u56e2\u3001\u4eac\u4e1c\u3001Oppo\u3001\u77e5\u4e4e\u7b49\n\n## \u8fdb\u9636\u8def\u7ebf\u4e0e\u804c\u4e1a\u89c4\u5212","c495cde4":"# \u7528\u6237\u753b\u50cf\n\n- \u751f\u6d3b\u4e60\u60ef\n- \u8d2d\u4e70\u8f6c\u5316\n- \u51b3\u7b56\u5468\u671f\n- \u54c1\u7c7b\/\u5546\u54c1\u504f\u597d","b723b3a1":"## \u884c\u4e3a","fe77bd64":"## \u7528\u6237","2f3f334a":"# \ud83d\udc76\u7528\u6237\u8d2d\u4e70\u9884\u6d4b\n\n* \u6570\u636e\u79d1\u5b66\u9886\u57df\u5c31\u4e1a\n* \u80cc\u666f\u8bf4\u660e\n* \u6570\u636e\u6982\u89c8\n* \u6570\u636e\u5904\u7406\n* \u6570\u636e\u5206\u6790\n* \u7528\u6237\u753b\u50cf\n* \u6570\u636e\u5efa\u6a21","91bb338c":"## \u6570\u636e\u6982\u89c8\ud83d\udc40","4732d391":"# \u80cc\u666f\u8bf4\u660e \ud83d\udcf1\n\n\u5929\u732b2017\u5e74\u67d0\u54c1\u7c7b\u7528\u6237\u884c\u4e3a\u6570\u636e\uff0c\u76ee\u6807\u662f\u5206\u6790\u7528\u6237\u884c\u4e3a\u6570\u636e\uff0c\u6316\u6398\u5f71\u54cd\u8d2d\u4e70\u51b3\u7b56\u7684\u5173\u952e\u56e0\u7d20\u548c\u73af\u8282\uff0c\u9884\u6d4b\u7528\u6237\u672a\u6765\u4e00\u5929\u662f\u5426\u4f1a\u8d2d\u4e70\u4ea7\u54c1\u3002\n\n- train\uff0c\u7528\u6237\u5386\u53f2\u884c\u4e3a\u6570\u636e\n- test\uff0c\u7528\u6237-\u5546\u54c1\u5bf9\uff0c\u9700\u8981\u6211\u4eec\u8fdb\u884c\u9884\u6d4b\u7528\u6237\u662f\u5426\u4f1a\u8d2d\u4e70\u8be5\u5546\u54c1\n- category\uff0c\u5546\u54c1-\u54c1\u7c7b\u6620\u5c04\u8868"}}