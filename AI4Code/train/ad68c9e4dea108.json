{"cell_type":{"494d8af3":"code","05ea5890":"code","b7efa78c":"code","9ba28fd1":"code","5971f1c6":"code","ff5c7eee":"code","8dff7f54":"code","565a4c43":"code","8946cc90":"code","8d2865c4":"code","b8a1deb3":"code","a6e39166":"code","a2c2879b":"code","15a4f960":"code","3166d0f3":"code","cdd08f48":"code","70106352":"code","2643bf95":"code","67b40d02":"code","79f191dd":"code","9ee4906d":"markdown","c1a023cd":"markdown","8da6df44":"markdown","48c053c5":"markdown","32a33838":"markdown","6628abea":"markdown","d35bd89b":"markdown","ac2e437a":"markdown","d3b7316b":"markdown","ef261800":"markdown","e263a2c4":"markdown","2217c77b":"markdown","6570598f":"markdown","f62c3d47":"markdown"},"source":{"494d8af3":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n!pip install visualkeras\nimport visualkeras\nimport keras\nfrom glob import glob\nfrom tqdm import tqdm\nimport cv2\nfrom keras.models import Sequential\nfrom keras.layers import Dense,Conv2D,MaxPool2D,BatchNormalization,Input,Flatten,Dropout,GlobalMaxPooling2D\nfrom keras.callbacks import EarlyStopping,ReduceLROnPlateau,LearningRateScheduler\nfrom sklearn.metrics import classification_report\nimport warnings\nwarnings.filterwarnings('ignore')","05ea5890":"df=pd.DataFrame()\nlabel=0\n# image_data=[]\n# labels=[]\nfor category in glob('..\/input\/garbage-collective-data-for-nature-conservation\/Garbage_Collective_Data\/*'):\n    for files in tqdm(glob(category+'\/*')):\n        image=cv2.imread(files)\n        image=cv2.resize(image,(224,224))    #As images are of different shape so resizing all to (224,224,3)\n        data=pd.DataFrame({'image':[image],'label':[label]})\n        df=df.append(data)\n    label+=1","b7efa78c":"\ncelltext=[]\ntransform_classes={}\nlabel=0\nfor name in glob('..\/input\/garbage-collective-data-for-nature-conservation\/Garbage_Collective_Data\/*'):\n    names=[]\n    names.append(name.split('\/')[-1].upper().replace('_',' '))\n    names.append(label)\n    celltext.append(names)\n    transform_classes[label]=name.split('\/')[-1]\n    label+=1","9ba28fd1":"plt.axis('off')\nplt.axis('tight')\ncolumn_names=['Categories','Label']\nrow_names=[x for x in range(1,13)]\nplot=plt.table(cellText=celltext,cellLoc='center',cellColours=[['#b3ff1a','#00ffff']]*12,\n               rowLabels=row_names,rowColours=['#ff2021']*12,colWidths=[1.2]*10,colLabels=column_names,loc='center')\nplot.set_fontsize(24)\nplot.scale(1, 4)","5971f1c6":"df=df.sample(frac=1).reset_index(drop=True)","ff5c7eee":"df.head()","8dff7f54":"df.info()","565a4c43":"df.image.iloc[1].shape","8946cc90":"from sklearn.model_selection import train_test_split\ntrain_image,test_image,train_label,test_label=train_test_split(df.image,df.label,test_size=0.1,random_state=42)","8d2865c4":"del df\ndel data","b8a1deb3":"plt.figure(figsize=(20,15))\nfor i in range(22):\n    plt.subplot(5,4,(i%20)+1)\n    rand_idx=np.random.randint(1000)\n    plt.title('{0} waste'.format(transform_classes[train_label.iloc[rand_idx]]),fontdict={'size':20})\n    plt.axis('off')\n    plt.imshow(train_image.iloc[rand_idx])\n#     plt.tight_layout()\nplt.show()","a6e39166":"def change_to_input_dimension(data):\n    data=np.reshape(data.to_list(),(len(data),224,224,3))\n    return data\ntrain_image=change_to_input_dimension(train_image)\ntest_image=change_to_input_dimension(test_image)","a2c2879b":"early_stop=EarlyStopping(monitor='val_loss',patience=4)\nreduceLR=ReduceLROnPlateau(patience=3)","15a4f960":"\nmodel=Sequential()\nmodel.add(Input(shape=(224,224,3)))\nmodel.add(Conv2D(256,(3,3)))\nmodel.add(MaxPool2D(2,2))\nmodel.add(BatchNormalization())\nmodel.add(Conv2D(128,(3,3)))\nmodel.add(MaxPool2D(2,2))\nmodel.add(BatchNormalization())\nmodel.add(Conv2D(64,(3,3)))\nmodel.add(MaxPool2D(2,2))\nmodel.add(BatchNormalization())\nmodel.add(GlobalMaxPooling2D())\nmodel.add(Dense(128))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(12,activation='softmax'))\nmodel.compile(optimizer='adam',loss='sparse_categorical_crossentropy',metrics=['accuracy'])","3166d0f3":"r=model.fit(train_image,train_label,validation_data=(test_image,test_label),epochs=30,callbacks=[early_stop,reduceLR])","cdd08f48":"visualkeras.layered_view(model, legend=True)","70106352":"plt.figure(figsize=(10,8))\nplt.plot(r.history['accuracy'])\nplt.plot(r.history['val_accuracy'])\nplt.legend(['accuracy','val_accuracy'])\nplt.title('ACCURACY',fontdict={'size':22})\nplt.show()","2643bf95":"plt.figure(figsize=(10,8))\nplt.plot(r.history['loss'])\nplt.plot(r.history['val_loss'])\nplt.legend(['loss','val_loss'])\nplt.title('LOSSES',fontdict={'size':22})\nplt.show()","67b40d02":"print(classification_report(test_label,model.predict_classes(test_image)))","79f191dd":"print(classification_report(train_label,model.predict_classes(train_image)))","9ee4906d":"## TRAIN CLASSIFICATION REPORT","c1a023cd":"## IMAGE SHAPE","8da6df44":"<h5 style=\"background-color: #00ffff;font-family:newtimeroman;font-size:550%;text-align:center;border-radius: 15px 10px;padding: 5px\"><b>VISUALIZE DATASET<\/b><\/h5>","48c053c5":"<h5 style=\"background-color: #00ffff;font-family:newtimeroman;font-size:550%;text-align:center;border-radius: 15px 10px;padding: 5px\"><b>Categories And Corresponding Labels<\/b><\/h5>","32a33838":"<h1 style=\"background-color: #aabbbb;font-family:newtimeroman;font-size:550%;text-align:center;border-radius: 15px 10px;padding: 5px\"><b><U>GARBAGE TYPE DETECTION<\/U><\/b><\/h1>","6628abea":"<h5 style=\"background-color: #00ffff;font-family:newtimeroman;font-size:550%;text-align:center;border-radius: 15px 10px;padding: 5px\"><b>BUILDING MODEL<\/b><\/h5>","d35bd89b":"<center><img src=\"https:\/\/previews.123rf.com\/images\/inegvin\/inegvin1901\/inegvin190100006\/126476534-rubbish-bins-for-recycling-different-types-of-waste-garbage-containers-for-trash-sorted-by-plastic-o.jpg\",height='300',width='600'><\/center>","ac2e437a":"## TEST CLASSIFICATION REPORT","d3b7316b":"<h5 style=\"background-color: #00ffff;font-family:newtimeroman;font-size:550%;text-align:center;border-radius: 15px 10px;padding: 5px\"><b>Importing Libraries<\/b><\/h5>","ef261800":"## <U>CALLBACKS FUNCTION<\/U>","e263a2c4":"## <center>END NOTE<\/center>\n\n### <center><font style=\"color:red\">Hope you find this notebook useful. If you liked it do upvote it.<\/font><\/center>","2217c77b":"<h5 style=\"background-color: #00ffff;font-family:newtimeroman;font-size:550%;text-align:center;border-radius: 15px 10px;padding: 5px\"><b>VISUALIZE KERAS MODEL<\/b><\/h5>","6570598f":"## SHUFFLING DATASET","f62c3d47":"## DELETING THE DATAFRAMES WHICH ARE NOT IN USE TO FREE RAM"}}