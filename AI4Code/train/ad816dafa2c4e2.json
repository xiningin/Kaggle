{"cell_type":{"00661b43":"code","90207cf1":"code","a3e50a2a":"code","7ff3c0d6":"code","a74f9925":"code","17832707":"code","b5a1d0c8":"code","fba0119b":"code","7e8daf51":"code","14bb9473":"code","83eaaf0c":"code","7b7bf4b4":"code","53610252":"code","7265d4f0":"code","eb93d4b7":"code","6b33da56":"code","cad54933":"code","82f59e43":"code","fff9f149":"code","45b8ffb9":"code","bbe3a426":"code","86338ede":"code","0d44acda":"code","2d6ca83f":"code","06f2c409":"code","ee2c0a45":"code","87aedd8b":"code","be87a120":"code","f240f19c":"code","d93fe828":"code","b034b104":"code","cd6f23b5":"code","98c0e704":"code","41e6527f":"code","a8ea1467":"code","1d6500f1":"code","5675fd53":"code","9a411972":"code","6aead6a8":"code","ab8b5a3d":"code","607bbd05":"code","b0beab4c":"code","3de9ccee":"code","647e40b3":"code","4f49e334":"code","74adcea9":"code","cc7e5d89":"code","ebcc0c0f":"code","179f9f54":"code","e6addb11":"code","d11ff3fc":"code","5b1c8b6e":"markdown","2322d3d8":"markdown","4dda19a3":"markdown","a2a01ced":"markdown","63a1b73e":"markdown","c14c73f9":"markdown","09ac9a78":"markdown","6c79f859":"markdown","6db54246":"markdown","ee162976":"markdown","530ccf30":"markdown","ff2eb45e":"markdown","cf3367a8":"markdown","65341eeb":"markdown","6bde0b59":"markdown","c76139c4":"markdown","8477fa92":"markdown","c72e75d8":"markdown","360020e8":"markdown","692ce4ab":"markdown","b3239c68":"markdown"},"source":{"00661b43":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sns\npd.set_option('display.max_columns', None)","90207cf1":"health =pd.read_csv('\/kaggle\/input\/fetal-health-classification\/fetal_health.csv')\nhealth.head()","a3e50a2a":"health.info()","7ff3c0d6":"health.describe()","a74f9925":"healthd=health.copy()\nhealthd.drop_duplicates(inplace=True)\nhealthd.shape","17832707":"health.shape","b5a1d0c8":"health=healthd\ndel healthd\nhealth.head()","fba0119b":"health.shape","7e8daf51":"import pandas_profiling as pp \nprofile = pp.ProfileReport(health) \nprofile.to_file(\"EDA.html\")","14bb9473":"X=health.drop('fetal_health',axis=1)\ny=health['fetal_health']","83eaaf0c":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X,y, train_size = 0.70,stratify=y,shuffle=True, random_state = 42)","7b7bf4b4":"X_train.info()","53610252":"from catboost import CatBoostClassifier\nmodel=CatBoostClassifier()","7265d4f0":"obj=list(np.where(X_train.dtypes == np.object)[0])\nobj","eb93d4b7":"model.fit(X_train,y_train,cat_features=obj)","6b33da56":"import sklearn.metrics\nscore_cbc=model.score(X_test,y_test)\nprint('Score :',score_cbc)","cad54933":"sklearn.metrics.confusion_matrix(y_test,model.predict(X_test))","82f59e43":"roc_auc_score_cbc=sklearn.metrics.roc_auc_score(y_test,model.predict_proba(X_test),multi_class='ovr')\nprint('Compute Area Under the Receiver Operating Characteristic Curve',roc_auc_score_cbc)","fff9f149":"cohen_kappa_score_cbc=sklearn.metrics.cohen_kappa_score(model.predict(X_test),y_test)\nprint('Cohen\u2019s kappa :',cohen_kappa_score_cbc)","45b8ffb9":"sklearn.metrics.f1_score(y_test,model.predict(X_test),average='macro')","bbe3a426":"sklearn.metrics.f1_score(y_test,model.predict(X_test),average='micro')","86338ede":"sklearn.metrics.f1_score(y_test,model.predict(X_test),average='weighted')","0d44acda":"sklearn.metrics.f1_score(y_test,model.predict(X_test),average=None)","2d6ca83f":"sklearn.metrics.fbeta_score(y_test,model.predict(X_test),average='macro',beta=0.5)","06f2c409":"sklearn.metrics.fbeta_score(y_test,model.predict(X_test),average='micro',beta=0.5)","ee2c0a45":"sklearn.metrics.fbeta_score(y_test,model.predict(X_test),average='weighted',beta=0.5)","87aedd8b":"sklearn.metrics.fbeta_score(y_test,model.predict(X_test),average=None,beta=0.5)","be87a120":"sklearn.metrics.hamming_loss(y_test,model.predict(X_test))","f240f19c":"sklearn.metrics.hinge_loss(y_test,model.predict_proba(X_test))","d93fe828":"sklearn.metrics.jaccard_score(y_test,model.predict(X_test),average='macro')","b034b104":"sklearn.metrics.jaccard_score(y_test,model.predict(X_test),average='micro')","cd6f23b5":"sklearn.metrics.jaccard_score(y_test,model.predict(X_test),average='weighted')","98c0e704":"sklearn.metrics.jaccard_score(y_test,model.predict(X_test),average=None)","41e6527f":"sklearn.metrics.log_loss(y_test,model.predict_proba(X_test))","a8ea1467":"sklearn.metrics.multilabel_confusion_matrix(y_test,model.predict(X_test))","1d6500f1":"sklearn.metrics.matthews_corrcoef(y_test,model.predict(X_test))","5675fd53":"sklearn.metrics.precision_recall_fscore_support(y_test,model.predict(X_test))","9a411972":"sklearn.metrics.precision_score(y_test,model.predict(X_test),average='macro')","6aead6a8":"sklearn.metrics.precision_score(y_test,model.predict(X_test),average='micro')","ab8b5a3d":"sklearn.metrics.precision_score(y_test,model.predict(X_test),average='weighted')","607bbd05":"sklearn.metrics.precision_score(y_test,model.predict(X_test),average=None)","b0beab4c":"sklearn.metrics.recall_score(y_test,model.predict(X_test),average='macro')","3de9ccee":"sklearn.metrics.recall_score(y_test,model.predict(X_test),average='micro')","647e40b3":"sklearn.metrics.recall_score(y_test,model.predict(X_test),average='weighted')","4f49e334":"sklearn.metrics.recall_score(y_test,model.predict(X_test),average=None)","74adcea9":"sklearn.metrics.zero_one_loss(y_test,model.predict(X_test))","cc7e5d89":"print(sklearn.metrics.classification_report(y_test,model.predict(X_test)))","ebcc0c0f":"# predict result\nX_test['Predicted fetal_health']= model.predict(X_test)\nX_test.head()\n","179f9f54":"plt.figure(figsize = (10,5))\nax= sns.countplot(X_test['Predicted fetal_health'])\nfor p in ax.patches:\n    ax.annotate(str(p.get_height()), (p.get_x() * 1.01 , p.get_height() * 1.01))\nplt.xticks(rotation = 45)\nax.set_yscale('log')\nplt.show()","e6addb11":"plt.figure(figsize = (10,5))\nax= sns.countplot(y_test)\nfor p in ax.patches:\n    ax.annotate(str(p.get_height()), (p.get_x() * 1.01 , p.get_height() * 1.01))\nplt.xticks(rotation = 45)\nax.set_yscale('log')\nplt.show()","d11ff3fc":"X_test['Predicted fetal_health'].value_counts(),y_test.value_counts()","5b1c8b6e":"# Duplicate Check","2322d3d8":"# Log Loss","4dda19a3":"# Zero-One Loss","a2a01ced":"# Precision Score","63a1b73e":"# Score","c14c73f9":"# Jaccard Score","09ac9a78":"# Matthews Corrcoef","6c79f859":"# Multi-Label Confusion Matrix","6db54246":"# Classification Report","ee162976":"# Recall Score","530ccf30":"# Cohen Kappa Score","ff2eb45e":"# Hinge Loss","cf3367a8":"# Precision, Recall, FScore & Support","65341eeb":"Duplicate Found!!","6bde0b59":"# F Score Beta","c76139c4":"# EDA ","8477fa92":"# Visualize the results ","c72e75d8":"# Hamming Loss","360020e8":"# Confusion Matrix","692ce4ab":"# F1 Score","b3239c68":"# ROC AUC Score"}}