{"cell_type":{"26034b58":"code","99bfb68f":"code","887c6ac2":"code","55df0475":"code","fa666a6e":"code","c4ab56fa":"code","8a2b1535":"code","d21d2ca6":"code","e0d2922c":"markdown","b8b1389f":"markdown","fbd74e4a":"markdown","b6b1a2fe":"markdown","b5889aaa":"markdown","eee72877":"markdown","219b89a5":"markdown"},"source":{"26034b58":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nPATH = \"..\/input\/wec_24\/\" # unfortunately the creators of this competition have made a sub folder inside input\n\nimport os\nprint(os.listdir(PATH))\n\nimport pandas as pd\n# Any results you write to the current directory are saved as output.","99bfb68f":"import h2o\nh2o.init()\nfrom h2o.automl import H2OAutoML","887c6ac2":"train = pd.read_csv(PATH + 'train.csv')\ntest = pd.read_csv(PATH + 'test.csv')\nss = pd.read_csv(PATH + 'SampleSubmission.csv')","55df0475":"hT = h2o.H2OFrame(train.drop('Id', axis = 1)) # we don't want to train or predict using 'Id'\nhTest = h2o.H2OFrame(test.drop('Id', axis = 1))\n\ncat_columns = ['Label', 'land', 'logged_in', 'is_host_login', 'is_guest_login']\nfor col in cat_columns:\n    hT[col] = hT[col].asfactor() # categorical \n    if col != 'Label': hTest[col] = hTest[col].asfactor() # categorical, but label is not available in test\n\nx = hT.columns\ny ='Label'\nx.remove(y)\n","fa666a6e":"aml = H2OAutoML(nfolds=0, max_runtime_secs = 60*60, sort_metric = 'logloss', seed=79)\naml.train(x = x, y = y, training_frame=hT)","c4ab56fa":"aml.leaderboard","8a2b1535":"preds = aml.leader.predict(hTest) #\npreds = preds.as_data_frame()","d21d2ca6":"ss.iloc[:, 1:] = preds.iloc[:, 1:]\nss.to_csv('sub.csv', index = False)","e0d2922c":"We will be using H2O's AutoML feature. It will automatically train a model for us. So let's import that too.","b8b1389f":"## Step 2: Convert the DataFrame to H2OFrame","fbd74e4a":"## Step 3: Train; Let H2O do the work you should","b6b1a2fe":"## Step 5: Save Submission and hope for the best","b5889aaa":"## Step 4: Predict","eee72877":"# The Lazy Man's ML in 5 Easy Steps\n\nThis Kernel will show you have to create a simple baseline without effort","219b89a5":"## Step 1: Load the files"}}