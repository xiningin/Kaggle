{"cell_type":{"13fca4f4":"code","64daa018":"code","e59a2da5":"code","d83ac7ae":"code","290a89f6":"code","981a46cb":"code","feaa2626":"code","125b97ab":"code","f2368c32":"code","781acbc5":"code","27c0d482":"code","a2ecc81b":"code","e64afddb":"code","909b49c3":"code","a78823ec":"code","cf04663b":"code","28eb662e":"code","d00d9085":"code","62cece72":"code","8da30778":"code","b932f911":"code","4990900e":"code","5434205c":"code","4ad318f4":"code","3c4c711f":"code","a6429e76":"code","e6851684":"code","5c9de8e0":"code","5077cc76":"code","eaad2906":"code","48c50287":"code","75e08caa":"code","62ca68d4":"code","4fc7ac08":"code","0de1cfe7":"code","53733be1":"code","5c957895":"code","067c9cf3":"code","51fab957":"code","818a8c1f":"code","352234f4":"code","69b7448b":"code","39dc52e4":"code","2c7c8a41":"code","82aeaac0":"code","3aa71c91":"code","11957778":"code","2d141611":"code","775e2749":"code","9af3d681":"code","6d6cc331":"code","79dad06c":"code","47b65232":"code","6fb80361":"code","3b0ba566":"code","ad24667e":"code","76ec0336":"code","ab8491dc":"code","cc76254c":"code","052d07ca":"code","33e0da39":"markdown","c3275a56":"markdown","7f915cc7":"markdown","a2383c5c":"markdown","634e4feb":"markdown","43a8feac":"markdown","53b09fed":"markdown","81861822":"markdown","7c071f95":"markdown","da930b38":"markdown","e6effae5":"markdown","1235c639":"markdown","70f0fd3a":"markdown","b77d9bd2":"markdown","25bb8be6":"markdown","fb053e3b":"markdown","1727d224":"markdown","196bb40f":"markdown","56eb1418":"markdown","871afc40":"markdown","a199d55d":"markdown","689e708f":"markdown","de980188":"markdown","25954e5b":"markdown","db4ec160":"markdown","848411b3":"markdown","59da4b65":"markdown","25c83e73":"markdown","7a8c37a9":"markdown","1a978b5a":"markdown"},"source":{"13fca4f4":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nsns.set()\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","64daa018":"df=pd.read_csv(\"\/kaggle\/input\/adult-income-dataset\/adult.csv\")","e59a2da5":"df.head()","d83ac7ae":"df['income']=df['income'].map({'<=50K': 0, '>50K': 1})\ndf.head()","290a89f6":"df.describe(include=\"all\")","981a46cb":"from numpy import nan\ndf=df.replace(\"?\",nan)","feaa2626":"null_values=df.isnull().sum()\nnull_values=pd.DataFrame(null_values,columns=['null'])\nj=1\nsum_tot=len(df)\nnull_values['percent']=null_values['null']\/sum_tot\nround(null_values*100,3).sort_values('percent',ascending=False)","125b97ab":"df[\"occupation\"].unique()","f2368c32":"df[\"workclass\"].unique()","781acbc5":"df[\"native-country\"].unique()","27c0d482":"df['native-country'].fillna(df['native-country'].mode()[0], inplace=True)","a2ecc81b":"df['occupation'].fillna(df['occupation'].mode()[0], inplace=True)","e64afddb":"df['workclass'].fillna(df['workclass'].mode()[0], inplace=True)","909b49c3":"null_values=df.isnull().sum()\nnull_values=pd.DataFrame(null_values,columns=['null'])\nj=1\nsum_tot=len(df)\nnull_values['percent']=null_values['null']\/sum_tot\nround(null_values*100,3).sort_values('percent',ascending=False)","a78823ec":"sns.pairplot(df)","cf04663b":"df.info()","28eb662e":"c=df.columns\nfor i in c:\n    print(df[i].value_counts())","d00d9085":"fig = plt.figure(figsize=(10,10)) \nsns.boxplot(x=\"income\", y=\"age\", data=df)\nplt.show()","62cece72":"fig = plt.figure(figsize=(12,12)) \nax = sns.countplot(x=\"workclass\", hue=\"income\", data=df).set_title(\"workclass vs count\")","8da30778":"plt.figure(figsize=(10,7))\nsns.boxplot(x=\"income\", y=\"fnlwgt\", data=df)\nplt.show()","b932f911":"sns.catplot(y=\"education\", hue=\"income\", kind=\"count\",\n            palette=\"pastel\", edgecolor=\".6\",\n            data=df);","4990900e":"g = sns.catplot(y=\"marital-status\", hue=\"gender\", col=\"income\",\n\n                data=df, kind=\"count\",\n\n                height=4, aspect=.7);","5434205c":"sns.countplot(y=\"occupation\", hue=\"income\",\n            data=df);","4ad318f4":"plt.figure(figsize=(10,7))\nsns.countplot(x=\"relationship\", hue=\"income\",\n            data=df);","3c4c711f":"plt.figure(figsize=(20,7))\nsns.catplot(y=\"race\", hue=\"income\", kind=\"count\",col=\"gender\", data=df);","a6429e76":"df[\"capital-gain\"].hist(figsize=(8,8))\nplt.show()","e6851684":"df[\"capital-loss\"].hist(figsize=(8,8))\nplt.show()","5c9de8e0":"df['hours-per-week'].hist(figsize=(8,8))\nplt.show()","5077cc76":"plt.figure(figsize=(10,20))\nsns.countplot(y=\"native-country\", hue=\"income\",\n            data=df);","eaad2906":"sns.heatmap(df.corr())","48c50287":"df.describe()","75e08caa":"#educational-num seems to be not so important\ndf=df.drop([\"educational-num\"],axis=1)","62ca68d4":"#also fnlwgt is not so important\ndf=df.drop([\"fnlwgt\"],axis=1)","4fc7ac08":"df=df[(df[\"hours-per-week\"] < 80)]","0de1cfe7":"df=df[(df[\"hours-per-week\"] > 20)]","53733be1":"print(df[\"hours-per-week\"].min(),\ndf[\"hours-per-week\"].max(),\ndf[\"hours-per-week\"].mean())","5c957895":"df=df[(df[\"age\"] < 60)]","067c9cf3":"df=df[(df[\"age\"] > 20)]","51fab957":"print(df[\"age\"].min(),\ndf[\"age\"].max(),\ndf[\"age\"].mean())","818a8c1f":"from sklearn import preprocessing\nimport pandas as pd\nle = preprocessing.LabelEncoder()","352234f4":"df.columns","69b7448b":"df[['age', 'workclass', 'education', 'marital-status', 'occupation',\n       'relationship', 'race', 'gender', 'capital-gain', 'capital-loss',\n       'hours-per-week', 'native-country']]=df[['age', 'workclass', 'education', 'marital-status', 'occupation',\n       'relationship', 'race', 'gender', 'capital-gain', 'capital-loss',\n       'hours-per-week', 'native-country']].apply(le.fit_transform)","39dc52e4":"X=df.drop([\"income\"],axis=1)\ny=df[\"income\"]","2c7c8a41":"df[\"income\"].value_counts()","82aeaac0":"from imblearn.combine import SMOTETomek\nfrom imblearn.under_sampling import NearMiss","3aa71c91":"# Implementing Oversampling for Handling Imbalanced \nsmk = SMOTETomek(random_state=42)\nX_res,y_res=smk.fit_sample(X,y)","11957778":"X_res.shape,y_res.shape","2d141611":"df.head()","775e2749":"from sklearn.model_selection import train_test_split","9af3d681":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)","6d6cc331":"from sklearn.neighbors import KNeighborsClassifier","79dad06c":"knn = KNeighborsClassifier(n_neighbors=1)","47b65232":"knn.fit(X_train,y_train)","6fb80361":"pred = knn.predict(X_test)","3b0ba566":"from sklearn.metrics import classification_report,confusion_matrix\nfrom sklearn.model_selection import cross_val_score","ad24667e":"print(confusion_matrix(y_test,pred))","76ec0336":"print(classification_report(y_test,pred))","ab8491dc":"accuracy_rate = []\n\n# Will take some time\nfor i in range(1,40):\n    \n    knn = KNeighborsClassifier(n_neighbors=i)\n    score=cross_val_score(knn,X,df['income'],cv=10)\n    accuracy_rate.append(score.mean())","cc76254c":"\n\nplt.figure(figsize=(10,6))\nplt.plot(range(1,40),accuracy_rate,color='blue', linestyle='dashed', marker='o',\n         markerfacecolor='red', markersize=10)\nplt.title('accuracy_rate vs. K Value')\nplt.xlabel('K')\nplt.ylabel('accuracy_rate')\n\n","052d07ca":"# NOW WITH K=18\nknn = KNeighborsClassifier(n_neighbors=18)\n\nknn.fit(X_train,y_train)\npred = knn.predict(X_test)\n\nprint('WITH K=18')\nprint('\\n')\nprint(confusion_matrix(y_test,pred))\nprint('\\n')\nprint(classification_report(y_test,pred))","33e0da39":"The data seems to mainly consist private employees.\n\nIn All the workclasses number of people earning less then 50k are more then those earning 50k.","c3275a56":"The people with marital status as Married-civ-spouce has highest people with income more then 50k.","7f915cc7":"# Predictions and Evaluations","a2383c5c":"# Data processing","634e4feb":"\n\nThis data was extracted from the 1994 Census bureau database by Ronny Kohavi and Barry Becker (Data Mining and Visualization, Silicon Graphics). The prediction task is to determine whether a person makes over $50K a year.","43a8feac":"Most of the people who have income more then 50k either have prof-speciality or exec-managerial as occupation","53b09fed":"Great work...","81861822":"Mostly a person with relation as husband in a family has most count of people with more then 50k income","7c071f95":"# Label Encoder","da930b38":"# Description","e6effae5":"The box plot gives the age group where the concentration of  population is there when the income \n\nis >50k the age group is 35-52 years.\n\nis <=50k the age group is 25-45 years.","1235c639":"The mean of target column was around 0.23 so lets see if the data is imbalanced","70f0fd3a":"# Using KNN ","b77d9bd2":"# Split Train and Test data\u00b6","25bb8be6":"# Exploratory Data Analysis","fb053e3b":"There are also few people who works 80-100 hours per week and some less than 20 which is unusual.\nthey are like outliers.","1727d224":"\nPossibilities for capital gain and capital loss\n\nBoth capital gain and capital loss can be zero\n\nIf capital.gain is zero there is possibility of capital loss being high or above zero.\n\nIf capital loss is zero there is possibility of capital.gain being high or above zero.\n\n","196bb40f":"# Data cleaning","56eb1418":"Most people work 30-40 hours per week.\n\nThere are also few people who works 80-100 hours per week and some less than 20 which is unusual.\n","871afc40":"The 25% and 75% values indicate presence of good number of outliers in age. lets take the range as 20 to 60.","a199d55d":"Yes it is imbalanced.","689e708f":"The accuracy of our KNN model is 81%.","de980188":"Reading the dataset","25954e5b":"Highest accuracy  is at 18 so we take k values as 18.","db4ec160":"This data mostly consist of people who has education as hs-grad","848411b3":"# Choosing a K Value","59da4b65":"fnlwgt: final weight","25c83e73":"It is clear people with Gender male and race as white has the most people with income more then 50k.","7a8c37a9":"The data mainly sees to consist of people from us.","1a978b5a":"We can conclude that there is no difference in Mean of income group >50k and income group <=50k.\nIt means that final weight doesnt seem to be of much use."}}