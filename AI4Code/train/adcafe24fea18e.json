{"cell_type":{"3d5b33b0":"code","abb07455":"code","f001623e":"code","5864792d":"code","4634fb96":"code","c1bd6214":"code","e97b6d26":"code","2eeeb80e":"code","acf923e7":"code","d7e1ab1a":"code","a07b04a1":"code","85534057":"code","9be80992":"code","55cf6a7d":"code","3862ff3b":"code","ac4a5dfc":"code","f41ceb3d":"code","3381d808":"code","53623fbc":"markdown"},"source":{"3d5b33b0":"\nimport numpy as np \nimport pandas as pd \nimport os\nfrom tensorflow.keras.optimizers import Adam","abb07455":"\ndf = pd.read_csv('\/kaggle\/input\/agriculture-crop-images\/Crop_details.csv')\n","f001623e":"df","5864792d":"\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\n","4634fb96":"get_data = ImageDataGenerator(rescale=1\/255,shear_range=0.2,horizontal_flip=True,\n    vertical_flip=True)","c1bd6214":"\ntrain1 = get_data.flow_from_directory('..\/input\/agriculture-crop-images\/kag2',\n                                     target_size=(224,224)\n                                     ,batch_size=1)\n\ntrain2 = get_data.flow_from_directory('..\/input\/agriculture-crop-images\/crop_images',\n                                      \n                                     target_size=(224,224)\n                                      \n                                     ,batch_size=1)\n\n\n#using 'some more images' as a test data\n\ntest = get_data.flow_from_directory('..\/input\/agriculture-crop-images\/some_more_images\/some_more_images',\n                                     target_size=(224,224),batch_size=1)\n\n\n\n\n\n","e97b6d26":"from tensorflow.keras.applications.resnet50 import ResNet50","2eeeb80e":"resnet_model =ResNet50(include_top=False,input_shape=(224,224,3))","acf923e7":"for layers in resnet_model.layers:\n    layers.trainable=False\n    ","d7e1ab1a":"#resnet_model.summary()","a07b04a1":"from tensorflow.keras.layers import Dense,Flatten\nfrom tensorflow.keras.models import Model","85534057":"resnet_flat = Flatten()(resnet_model.output)\nlast_layer =  Dense(5,activation='softmax')(resnet_flat)\nlast_layer","9be80992":"my_resnet_model = Model(inputs=resnet_model.input , outputs=last_layer,)\n#my_resnet_model.summary()","55cf6a7d":"\nmy_resnet_model.compile(loss='categorical_crossentropy',\n    metrics=['accuracy'],optimizer=Adam(0.0001))","3862ff3b":"my_resnet_model.fit_generator(train1,epochs=50)\n","ac4a5dfc":"my_resnet_model.evaluate(train1)\n","f41ceb3d":"my_resnet_model.evaluate_generator(train2)","3381d808":"my_resnet_model.evaluate(test)","53623fbc":"******Model Accuracy on Known Data"}}