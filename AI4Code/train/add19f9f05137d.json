{"cell_type":{"71a6c9a6":"code","833517cd":"code","89d7ad8d":"code","10195858":"code","f670bfb6":"code","69051a26":"code","423d35a0":"code","60112c38":"code","2118ce2c":"code","3f92c995":"code","6ff9c390":"code","bec1f981":"code","1ba0475a":"code","f676b03b":"code","c4c19208":"markdown","e2e37793":"markdown","f1559718":"markdown","1356045f":"markdown","2ab4fdbd":"markdown","b6ad8e7a":"markdown","ebaac75c":"markdown","3fb0896e":"markdown","461deedb":"markdown","b8c8daec":"markdown","430c0c15":"markdown","57c0b8f0":"markdown","a69b2379":"markdown"},"source":{"71a6c9a6":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","833517cd":"import pandas as pd","89d7ad8d":"data_df = pd.read_csv(\"\/kaggle\/input\/access-to-education-of-disabled-people-in-europe\/hlth_de040.tsv\", sep='\\t')","10195858":"print(list(data_df.columns))","f670bfb6":"data_df.head()","69051a26":"data_df.tail()","423d35a0":"pivot_data_col = data_df.columns[0]\ngeo_columns = data_df.columns[1:]","60112c38":"data_df['unit'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[0])\ndata_df['isced97'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[1])\ndata_df['hlth_pb'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[2])\ndata_df['age'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[3])\ndata_df['sex']     = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[4])\ndata_df['time'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[5])","2118ce2c":"selected_columns = list(['unit', 'isced97', 'hlth_pb', 'sex', 'age', 'time']) +  list(geo_columns)\ndata_df = data_df[selected_columns]","3f92c995":"data_tr_df = data_df.melt(id_vars=['unit', 'isced97', 'hlth_pb', 'sex', 'age', 'time'], \n        var_name=\"geo\", \n        value_name=\"value\")\ndata_tr_df['geo'] = data_tr_df['geo'].apply(lambda x: str(x))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"bp\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"b\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"u\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"c\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"d\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\": \", \"NAN\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: float(x))","6ff9c390":"print(f\"Transformed data shape: {data_tr_df.shape} (rows\/columns)\")\ndata_tr_df.head()","bec1f981":"data_tr_df.tail()","1ba0475a":"import pandas_profiling\npandas_profiling.ProfileReport(data_tr_df)","f676b03b":"data_tr_df.to_csv(\"education_disbled_eu.csv\", index=False)","c4c19208":"We select now only the new columns resulted from splitting the `pivot_data_col` and the time columns.","e2e37793":"Then, we split from `pivot_data_col` the 6 separate fields:\n* unit;\n* isced97 - ISCED-97 education attainment level classification;   \n* hlth_pb - Health problem;\n* age - this is age group actually;  \n* sex (F, M or T);\n* time - this is unique year 2011;  ","f1559718":"Let's also take a look to few of the rows.","1356045f":"Next, we pivot the time columns using `melt` operation in pandas.  \nWe also make sure we transform `date` to be an integer (here is a year data).  \nWe set `value` to be a float, after we replace \": \" (for N\/A) with `NAN`.","2ab4fdbd":"The first column is a composed one, containing 5 different information (unit, isced-97 education indicator,health problems, age, sex, time in years). The next columns are the countries values.","b6ad8e7a":"## Load the data\n\nThe datafiles are in TSV format. We will read the files using pandas, just include in the function call the `sep` (tab separator data).\nWe demonstrate first how to read and process the Annual data.","ebaac75c":"Let's glimpse the data columns.","3fb0896e":"# Data pre-processing\n\nWe start by defining two working lists.","461deedb":"# Export data in csv format","b8c8daec":"Let's inspect the result.","430c0c15":"# Introduction\n\nWe show in this Kernel how we can process the data to prepare it for easier processing. Let's check the data files.","57c0b8f0":"# Analysis preparation\n\n## Load packages","a69b2379":"# A very preliminary exploratory data analysis\n\nThis would be a very short exploratory data analysis. The role of this Kernel is just to show how we can prepare the annual data for analysis and we already did this."}}