{"cell_type":{"d384b15c":"code","45d52714":"code","0d13ff52":"code","270c1b46":"code","10240a53":"code","696b5a95":"code","8d549245":"code","812409ae":"code","f7e53561":"code","dc50da0a":"code","171706ea":"code","7470d7ff":"code","b91e6b3e":"code","98f510dd":"code","5ebc4e9a":"code","0c272bba":"code","6802f959":"code","9d7e6061":"code","35e37031":"code","9d06ce89":"code","4d147885":"code","11f2402b":"code","e73edee8":"code","aed6b5f7":"code","e1b9e2be":"code","3ad15e29":"code","6fe5891a":"code","343d547a":"code","7091c568":"code","73698138":"code","fcb85284":"code","ae8962c0":"markdown","9315deb5":"markdown","cd48f648":"markdown","84de1ece":"markdown","8e6df065":"markdown","c37a6850":"markdown","aa284842":"markdown","7481df55":"markdown","e83261bb":"markdown","f249bf76":"markdown"},"source":{"d384b15c":"import pandas as pd\nimport numpy as np\nimport os\nimport matplotlib.pyplot as plt\nimport seaborn as sns","45d52714":"orig_data = pd.read_csv(r'..\/input\/salary_data.csv', \n                        na_values=' ?')\ndata = pd.DataFrame(orig_data)\ndata.head()","0d13ff52":"data.shape","270c1b46":"#checking for null values\ndata.isnull().sum()","10240a53":"data.dropna(inplace=True)\ndata.head()","696b5a95":"data.shape","8d549245":"data.head()","812409ae":"#age\nax=sns.violinplot(data['salary'], data['age'])\nax.set(xlabel='salary',ylabel='age')\n\n'''\n<=50k are aged around 25 years\n>50k are aged around 40 to 50 years\n\n'''","f7e53561":"#fnlwgt\nax=sns.violinplot(data['salary'], data['fnlwgt'])\nax.set(xlabel='salary',ylabel='fnlwgt')\n\n'''\nthere is no difference in the salary\nso fnlwgt in not affecting it\n'''","dc50da0a":"ax=sns.violinplot(data['salary'], data['hours-per-week'])\nax.set(xlabel='salary',ylabel='hours per week')\n\n'''\nhere we cannot really say how much a person earns\nbased on his hours per week\nbecause both categories have quite similar distribution\n\nso we dont include it\n'''\n","171706ea":"#marital status\ndata.groupby(['marital-status'])['salary'].value_counts(normalize=True)","7470d7ff":"#education\ndata.groupby(['education'])['salary'].value_counts(normalize=True)","b91e6b3e":"#workclass\ndata.groupby(['workclass'])['salary'].value_counts(normalize=True)","98f510dd":"#sex\ndata.groupby(['sex'])['salary'].value_counts(normalize=True)","5ebc4e9a":"X = data.loc[:,['age','sex']]\n\n# '''education', \n#                  'marital-status',\n#                  'race',\n#                  'sex',\n#                  'workclass'''","0c272bba":"X.head()","6802f959":"y = data.iloc[:,-1]\ny.size\ny.head()","9d7e6061":"#encoding male and female\nX['sex'].replace(to_replace=[' Male',' Female'], value=[0,1],inplace=True)","35e37031":"X.head()","9d06ce89":"# '''education', \n#                  'marital-status',\n#                  'race',\n#                  'sex',\n#                  'workclass'''\nX = pd.concat([X,pd.get_dummies(data['education'])], axis=1)","4d147885":"X = pd.concat([X,pd.get_dummies(data['marital-status'])], axis=1)\nX = pd.concat([X,pd.get_dummies(data['workclass'])], axis=1)","11f2402b":"pd.set_option('display.max_columns', None)\nX.head()","e73edee8":"from sklearn.preprocessing import StandardScaler\nsc_X = StandardScaler()\nX = sc_X.fit_transform(X)","aed6b5f7":"X","e1b9e2be":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=4)\nprint ('Train set:', X_train.shape,  y_train.shape)\nprint ('Test set:', X_test.shape,  y_test.shape)","3ad15e29":"y_train.head()","6fe5891a":"# Modeling\nfrom sklearn.neighbors import KNeighborsClassifier\n# Best k\nKs=15\nmean_acc=np.zeros((Ks-1))\nstd_acc=np.zeros((Ks-1))\nConfustionMx=[];\nfor n in range(1,Ks):\n    \n    #Train Model and Predict  \n    kNN_model = KNeighborsClassifier(n_neighbors=n).fit(X_train,y_train)\n    yhat = kNN_model.predict(X_test)\n    \n    \n    mean_acc[n-1]=np.mean(yhat==y_test);\n    \n    std_acc[n-1]=np.std(yhat==y_test)\/np.sqrt(yhat.shape[0])\n","343d547a":"k = mean_acc.argmax()+1\nk","7091c568":"kNN_model = KNeighborsClassifier(n_neighbors=k).fit(X_train,y_train)\nkNN_model","73698138":"#generating the predicted y\nknn_yhat = kNN_model.predict(X_test)","fcb85284":"from sklearn.metrics import jaccard_similarity_score\nfrom sklearn.metrics import f1_score\nfrom sklearn.metrics import log_loss\nprint(\"KNN Jaccard index: %.2f\" % jaccard_similarity_score(y_test, knn_yhat))\nprint(\"KNN F1-score: %.2f\" % f1_score(y_test, knn_yhat, average='weighted') )","ae8962c0":"In this data, null values are represented by '?'","9315deb5":"<b>\nHere, for example, 89% of divorced people earn <=50k.\n\nWe can infer that, divorced people have a high probability of earning less.\n\nSo marital status can be a good estimator of the salary.\n\nSimilarly, analysing other features.\n<\/b>","cd48f648":"# missing values are removed till here","84de1ece":"## scaling the data","8e6df065":"## Problem Statement:\nWe have a dataset consisting of details of US citizens.\nour goal is to classify whether a person's salary is greater or less than $50k.","c37a6850":"## Now we check which factors influence the result.","aa284842":"## Train test split","7481df55":"# End of visualisation","e83261bb":"# encoding the categorical values","f249bf76":"We find out that there is a lot of salary difference in both sex"}}