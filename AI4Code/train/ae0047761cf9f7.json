{"cell_type":{"ea1b58b8":"code","a212a170":"code","a8a0f3b2":"code","3fce7b2e":"code","b20e9b36":"code","66ff8146":"code","42d75339":"code","347a83ff":"code","8c80704c":"code","bcf712db":"code","d37c4e40":"code","d334c62b":"code","08ade36e":"code","39815453":"code","d0151e98":"code","3f798d2e":"code","c7b7d6c9":"code","94cb4a2a":"code","e0d7c257":"code","fa828256":"code","dfdefaed":"code","932cad77":"code","7c25c0ff":"code","6bf12a3b":"code","c36528a4":"code","7367ebd5":"code","8c8aa8e5":"code","b683bb7f":"code","7e541019":"code","0f0c44d1":"code","ee78a5f3":"code","a4a0a9da":"code","6a661eb2":"code","277934a5":"code","bcb8d672":"code","68f6bef4":"code","7d611b96":"code","b1726465":"code","9eed04c2":"code","b98ae280":"code","2205a383":"code","40e64ed2":"code","0c02e1ad":"code","06d82b1c":"markdown","41458527":"markdown","ff3fb39c":"markdown","a4b2ee18":"markdown","b8860a4c":"markdown","47609f9e":"markdown","39439e42":"markdown","280951e3":"markdown","fcca947d":"markdown","ee51581b":"markdown","c492e17a":"markdown","f1eb1986":"markdown","aad3813d":"markdown","29491f17":"markdown","6929487b":"markdown","f6316a53":"markdown","cbe0bf0a":"markdown","7b6eb9ed":"markdown","62e4b91a":"markdown","8c742866":"markdown","187182ad":"markdown","e4c3ba6f":"markdown","cf8c7989":"markdown","ac93b8b1":"markdown","4561a949":"markdown","a1bd70e3":"markdown","9084c0b8":"markdown","768d924a":"markdown","233e6b09":"markdown","4d7df3af":"markdown","619ca929":"markdown","a0be8070":"markdown","52f342cf":"markdown","5fcc9805":"markdown","0f23fb58":"markdown","24819514":"markdown","2dcb1594":"markdown"},"source":{"ea1b58b8":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","a212a170":"df = pd.read_csv('..\/input\/telecom_churn.csv')\ndf.head()","a8a0f3b2":"print(df.shape)","3fce7b2e":"print(df.columns)","b20e9b36":"df.info()","66ff8146":"### Let us change the 'Churn' feature to 'int64'\ndf['churn'] = df['churn'].astype('int64')\ndf.head()","42d75339":"df.describe()","347a83ff":"df.describe(include=['object','bool'])","8c80704c":"df['churn'].value_counts()","bcf712db":"df['churn'].value_counts(normalize = 'True')","d37c4e40":"df.sort_values(by='total day charge', ascending=False).head()","d334c62b":"df.sort_values(by=['churn','total day charge'], ascending=[True, False]).head()","08ade36e":"df['churn'].mean()","39815453":"df[df['churn'] == 1].mean()","d0151e98":"df[df['churn'] == 1]['total day minutes'].mean()","3f798d2e":"df[(df['churn'] == 0) & (df['international plan'] == 'no')]['total intl minutes'].max()","c7b7d6c9":"df.loc[0:5, 'state':'area code']","94cb4a2a":"df.iloc[0:5, 0:3]","e0d7c257":"df[:1]","fa828256":"df[-1:]","dfdefaed":"df.apply(np.max)","932cad77":"df[df['state'].apply(lambda x : x[0] == 'W')].head()","7c25c0ff":"d = {'yes' : True, 'no' : False}\ndf['international plan'] = df['international plan'].map(d)\ndf.head()","6bf12a3b":"df = df.replace({'voice mail plan' : d})\ndf.head()","c36528a4":"columns_to_show = ['total day minutes', 'total eve minutes', 'total night minutes']\ndf.groupby(['churn'])[columns_to_show].describe(percentiles=[])","7367ebd5":"df.head()","8c8aa8e5":"pd.crosstab(df['churn'], df['international plan'])","b683bb7f":"pd.crosstab(df['churn'], df['international plan'], normalize = True)","7e541019":"pd.crosstab(df['churn'],df['voice mail plan'], normalize = True)","0f0c44d1":"df.pivot_table(['total day calls', 'total eve calls', 'total night calls'],\n              ['area code'],\n              aggfunc = 'mean')","ee78a5f3":"total_calls = df['total day calls'] + df['total eve calls'] + \\\n                df['total night calls'] + df['total intl calls']\ndf.insert(loc=len(df.columns), column = 'total calls', value = total_calls)\ndf.head()","a4a0a9da":"df['total charge'] = df['total day charge'] + df['total eve charge'] + \\\n                     df['total night charge'] + df['total intl charge']\ndf.head()","6a661eb2":"df.drop(['total charge', 'total calls'], axis=1, inplace=True)\ndf.head()","277934a5":"df.drop([1,2]).head()","bcb8d672":"pd.crosstab(df['churn'], df['international plan'], margins = True, normalize = True)","68f6bef4":"sns.countplot(x='international plan', hue='churn', data=df);","7d611b96":"pd.crosstab(df['churn'], df['customer service calls'], margins = True)","b1726465":"sns.countplot(x = df['customer service calls'], hue = 'churn', data = df);","9eed04c2":"df['many service calls'] = (df['customer service calls'] > 3).astype('int')\ndf.head()","b98ae280":"pd.crosstab(df['many service calls'], df['churn'], margins = True)","2205a383":"sns.countplot(x = df['many service calls'], hue = df['churn'], data = df);","40e64ed2":"pd.crosstab(df['many service calls'] & df['international plan'], df['churn'])","0c02e1ad":"pd.crosstab(df['many service calls'] & df['international plan'], df['churn'], normalize = True)","06d82b1c":"#### Let us drop the some rows","41458527":"#### How to replace values in a column ? \n#### This can be done by using map method ( by passing a dictionary of the form {old_value : new_value} as its argument","ff3fb39c":"#### we can add a column without creating an intermediate series instance:","a4b2ee18":"#### How much time(on average) do churned users spend on phone during daytime ?","b8860a4c":"### sorting","47609f9e":"### Indexing and retrieving data","39439e42":"### Summary Tables\n#### By using the 'crosstab' method we can build a contingency table\n#### For example : we will see how the observations in our sample are distributed in the contex of two variables ( 'churn' & 'international plan')","280951e3":"#### Delete those two features we created earlier ","fcca947d":"#### Let us see the relation between 'churn' & 'voice mail plan'","ee51581b":"## Telecom churn - Exploratory data analysis","c492e17a":"#### loc method is used for indexing by name","f1eb1986":"#### find the maximum of each column","aad3813d":"# Let us predict the churn","29491f17":"#### we can also use the 'replace' method. \n#### replace the 'yes' & 'no' of 'voice mail plan' to 'true' & 'false'","6929487b":"#### Let us first line of the data frame","f6316a53":"##### proportion of churned users in our data","cbe0bf0a":"#### drop method is used to delete the rows or columns\n#### we need to pass the required indexes and the axis parameter ( 1 to delete columns, and nothing or 0 to delete rows )\n#### The inplace argument tells whether to change the original DataFrame.\n#### with inplace = False, the drop method doesn't change the existing DataFrame and returns a new one with dropped rows or columns\n#### with inplace = True, it alteres the DataFrame","7b6eb9ed":"#### It's time to see the relation between the international plan and 'many intenational calls'","62e4b91a":"#### Let us replace 'yes' & 'no' status of 'international plan' with 'True' & 'False'","8c742866":"#### From the above plot, we can notice that churn rate is much higher with the international plan. This indicates that customers with international plan are not happy with this telecom operator","187182ad":"#### printing the last line of data frame ","e4c3ba6f":"### DataFrame Transformations","cf8c7989":"#### Boolean Indexing","ac93b8b1":"#### The apply method can be used to apply a function to each row. To do this, specify axis=1. Lambda functions are very convenient in such scenarios.","4561a949":"#### What is the maximum length of international calls among loyal users who do not have an international plan ?","a1bd70e3":"### Applying Functions to cells, columns and rows","9084c0b8":"#### What is the relation between the churn and international plan ?","768d924a":"#### Select all states starting with W ( use a lambda function )","233e6b09":"### Let us check relation between the customer service calls and churn ","4d7df3af":"#### From the above  table & plot it is clear that churn rate increased a lot if the customer calls are more than 4.\n#### now we will add a new binary feature ( customer service calls > 3 ) and then we will check the churn","619ca929":"## Conclusion\n#### we found a relation i.e\n### \"international plan = True & customer service calls > 3 => churn = 1, else churn = 0\"\n#### The accuracy with above relation is 85.80% ( i.e 85.23 + 00.57) and error is 14.19% ( 13.92+0.27)\n#### this is a good starting point for further studies","a0be8070":"#### iloc() is used for indexing by number","52f342cf":"### Grouping\n#### Syntax : df.groupby(by=grouping_columns)[columns_to_show].function()\n#### 1. First, the groupby method divides the grouping_columns by their values. They become a new index in the resulting dataframe.\n#### 2. Then, columns of interest are selected (columns_to_show). If columns_to_show is not included, all non groupby clauses will be included.\n#### 3 Finally, one or several functions are applied to the obtained groups per selected columns.\n#### Example : we group the data according to the values of the 'churn' variable and display statistics of three columns in each group:","5fcc9805":"#### From above two tables, we can notice that most of the users are loyal and do not use additional services like 'international plan' or 'voice mail'","0f23fb58":"### Pivot Tables\n#### pivot_table method takes the following parameters:\n##### values : a list of variables to calculate statistics for,\n##### index : a list of variables to group data by,\n##### aggfunc : what statisitcs we need to calculate for groups, ex. sum, mean, maximum, minimum or something else\n#### Find the averages for total day calls, total eve calls, total night calls for each area (area code)  ","24819514":"#### Let us find the average values of numerical features for churned users","2dcb1594":"#### Create a new feature 'total calls' and insert as a last column"}}