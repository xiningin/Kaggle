{"cell_type":{"95abfb40":"code","ddecbcf4":"code","d134bce7":"code","85f510a8":"code","8422da18":"code","ec11279b":"code","8e74b873":"code","62e883ce":"code","8084caa8":"code","843f7cbc":"code","08c17a44":"code","18bd2c1f":"code","710dbf03":"code","d356c2e4":"code","ddb69368":"code","58d1614b":"code","6581ac05":"code","e8e176a4":"code","201ff3a8":"code","e5c6552d":"code","48c0f541":"code","2a98e278":"code","d1c2f687":"code","31f3aa4f":"code","e27f9fd8":"code","26b257f6":"code","2dfd7dc4":"code","a2578caa":"markdown","8f3cd936":"markdown","a9897aa0":"markdown","ec3417d6":"markdown","436812a6":"markdown","ce67e66a":"markdown","35e52fca":"markdown","acc5c742":"markdown","02c2932e":"markdown","58939746":"markdown","3f13ab26":"markdown","9929a0e4":"markdown","fdc0f464":"markdown","d17be1a1":"markdown","556acf25":"markdown","3d195dda":"markdown","e84600be":"markdown","4c482662":"markdown","39dea883":"markdown","a8c5b104":"markdown","15b0d2d2":"markdown","3b06a35d":"markdown","1302774e":"markdown","5d30c38e":"markdown","81fb6d01":"markdown"},"source":{"95abfb40":"!pip install lucifer-ml","ddecbcf4":"import pandas as pd \nimport numpy as np \nimport seaborn as sns\nimport matplotlib.pyplot as plt \nfrom collections import Counter\nfrom sklearn.model_selection import train_test_split\nimport plotly.graph_objects as go\nimport plotly.express as px\nimport pandas_profiling as pp\n\nfrom luciferml.supervised import classification as cls ## Importing LuciferML","d134bce7":"df = pd.read_csv(\"\/kaggle\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv\")","85f510a8":"# Printing top 5 rows of data\ndf.head()","8422da18":"# getting data types\ndf.info()","ec11279b":"# checking null values\ndf.isnull().sum()","8e74b873":"# getting the shape of data\ndf.shape","62e883ce":"# Summarizing the data\ndf.describe().T.style.bar(\n    subset=['mean'],\n    color='Reds').background_gradient(\n    subset=['std'], cmap='ocean').background_gradient(subset=['50%'], cmap='PuBu')","8084caa8":"churn_count = df['Churn'].value_counts()\nprint(churn_count)\nchurn_count.plot.pie();","843f7cbc":"plt.figure(figsize=(6,5))\nsns.countplot(x=\"Churn\", data=df, palette='magma');","08c17a44":"df.columns\n","18bd2c1f":"def boxhistplot(columns,data):\n    fig = px.histogram(df, x = df[column], color = 'Churn')\n    fig.show()\n    fig2 = px.box(df, x = df[column], color = 'Churn')\n    fig2.show()","710dbf03":"col = ['customerID', 'gender', 'SeniorCitizen', 'Partner', 'Dependents',\n       'tenure', 'PhoneService', 'MultipleLines', 'InternetService',\n       'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport',\n       'StreamingTV', 'StreamingMovies', 'Contract', 'PaperlessBilling',\n       'PaymentMethod', 'MonthlyCharges', 'TotalCharges']\nfor column in col:\n    boxhistplot(column,df)","d356c2e4":"sns.heatmap(df.corr(), annot=True, cmap=\"flag\");","ddb69368":"sns.pairplot(df, hue=\"Churn\", palette=\"magma\");","58d1614b":"# Getting Features\nfeatures = [ 'gender', 'SeniorCitizen', 'Partner', 'Dependents',\n       'tenure', 'PhoneService', 'MultipleLines', 'InternetService',\n       'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport',\n       'StreamingTV', 'StreamingMovies', 'Contract', 'PaperlessBilling', 'MonthlyCharges', 'TotalCharges']\nX = df[features]\n\n# Getting Predicting Value\ny = df['Churn']","6581ac05":"accuracy_scores = {}","e8e176a4":"classifier_name,accuracy = cls.Classification(predictor = 'lr', params={'max_iter':5000}).predict(X, y)\naccuracy_scores[classifier_name] = accuracy","201ff3a8":"classifier_name,accuracy = cls.Classification(predictor = 'svm').predict(X, y)\naccuracy_scores[classifier_name] = accuracy","e5c6552d":"classifier_name,accuracy = cls.Classification(predictor = 'knn').predict(X, y)\naccuracy_scores[classifier_name] = accuracy","48c0f541":"classifier_name,accuracy = cls.Classification(predictor = 'dt').predict(X, y)\naccuracy_scores[classifier_name] = accuracy","2a98e278":"classifier_name,accuracy = cls.Classification(predictor = 'nb').predict(X, y)\naccuracy_scores[classifier_name] = accuracy","d1c2f687":"classifier_name,accuracy = cls.Classification(predictor = 'rfc').predict(X, y)\naccuracy_scores[classifier_name] = accuracy","31f3aa4f":"classifier_name,accuracy = cls.Classification(predictor = 'xgb').predict(X, y)\naccuracy_scores[classifier_name] = accuracy","e27f9fd8":"classifier_name,accuracy = cls.Classification(predictor = 'ann').predict(X, y)\naccuracy_scores[classifier_name] = accuracy","26b257f6":"maxKey = max(accuracy_scores, key=lambda x: accuracy_scores[x])\nprint('The model with highest K-Fold Validation Accuracy score is  {0} with an accuracy of  {1:.2f}'.format(\n    maxKey, accuracy_scores[maxKey]))","2dfd7dc4":"plt.figure(figsize=(12, 6))\nmodel_accuracies = list(accuracy_scores.values())\nmodel_names = list(accuracy_scores.keys())\nsns.barplot(x=model_accuracies, y=model_names, palette='mako');","a2578caa":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:powderblue;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Importing Liberaries<\/h2>\n<\/div>","8f3cd936":"**ClassificationPredictor**","a9897aa0":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:powderblue;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Data Visualization<\/h2>\n<\/div>","ec3417d6":"**Creating Pair Plot**","436812a6":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:powderblue;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Model Selection<\/h2>\n<\/div>","ce67e66a":"## Training Decision Trees","35e52fca":"#### [Image Source](https:\/\/www.productplan.com\/glossary\/churn\/)","acc5c742":"## Training Naive Bayes","02c2932e":"**Churn Count**","58939746":"## Training SVM","3f13ab26":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:powderblue;\n           color:Black;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;\">Churn Prediction<\/h1>\n<\/div>\n<div>\n    <center><img src = \"https:\/\/vanessamiranda.github.io\/images\/Customerchurn\/customerchurn.jpg\">\n<\/div>","9929a0e4":"**Box & Hist**","fdc0f464":"## Training XGBoost Classifier","d17be1a1":"> We can see from the above there is no null value in data as all columns are showing 0","556acf25":"# Reference:\n\n- ## https:\/\/www.productplan.com\/glossary\/churn\/\n\n\n- ## [LuciferML](https:\/\/github.com\/d4rk-lucif3r\/LuciferML)","3d195dda":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:powderblue;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Exploratory Data Analysis<\/h2>\n<\/div>","e84600be":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:powderblue;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Summary<\/h2>\n    <h3 style=\"text-align:center;\"> The best model here is <b>SVC<\/b> with the accuracy of <b>90.90%<\/b>\n<\/h3><\/div>","4c482662":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:powderblue;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:left;\">What is Churn? <\/h2>\n<p style=\"text-align:left;\">\n Churn is a measurement of the percentage of accounts that cancel or choose not to renew their subscriptions. A high churn rate can negatively impact Monthly Recurring Revenue (MRR) and can also indicate dissatisfaction with a product or service.\n\nChurn is the measure of how many customers stop using a product. This can be measured based on actual usage or failure to renew (when the product is sold using a subscription model). Often evaluated for a specific period of time, there can be a monthly, quarterly, or annual churn rate.\n<\/p>\n<br>\n<h2 style=\"text-align:left;\">How is Churn Calculated? <\/h2>\n<p style = \"text-align:left;\">\nIn its most simplistic form, the churn rate is the percentage of total customers that stop using\/paying over a period of time. So, if there were 10,000 total customers in March and 1,000 of them stopped being customers, the monthly churn rate would be 10%.\n<\/p>\n<img src = \"https:\/\/www.productplan.com\/uploads\/Churn-Rate-1024x536.png\">\n\n<h2 style=\"text-align:left;\">Why do Customer Churn? <\/h2>\n<p style=\"text-align:left;\">\nlthough there is no magic answer to this question, there are a few likely causes for churn:\n\nCustomer no longer values the product\u2014Whatever first attracted the customer to the product and inspired initial usage is no longer present. This could be a change in customer priorities or a change in the product itself.\nMotivating factors to use the product no longer exists\u2014Customers purchase and use a product because it solves a problem or addresses a need, but not all problems and needs are permanent.\nCustomer frustrated with product user experience\u2014Dissatisfaction with usability, lack of features, or persistent bugs and performance issues can drive a customer away.\nThe product lacks a mandatory capability required by the user\u2014A customer needs the product to do something, but the product does not offer that functionality (or the customer lacks awareness or training of how to access and utilize that capability).\nValue to the customer does not justify the expense\u2014The ROI for the customer is no longer there.\nThe customer has found\/switched to an alternative solution\u2014This may be a direct competitor or an indirect alternative that is free or already available (i.e. instead of a reminder app the customer will just write down their notes on paper).\nDamage to product reputation\u2014This could be a cybersecurity issue, noteworthy performance problems, terrible customer service or bad acts by the company or company employees.\n<\/p>\n\n<h2 style=\"text-align:left;\">What does Churn Mean for Project Managers? <\/h2>\n<p style=\"text-align:left;\">\nChurn could quite possibly be the most important metric for SaaS product managers since it is a very telling measure of the perceived value the product delivers. While marketing and sales are primarily responsible for bringing in new customers, the product experience itself will determine how many stick around and for how long.\n\n\u201cIn SaaS, but especially in times like these, existing customers are your life blood. The more that you can retain existing customers, the more predictable your revenue stream will be in the future.\u201d\n\n\u2013 Kristina Shen and Kimberly Tan, Andreesen Horowitz\n<\/p>\n\n<h2 style=\"text-align:left;\">How can we Reduce Churn? <\/h2>\n<p style=\"text-align:left;\">\nChurn is reduced by increasing the perceived value proposition of the product to current users. This can be achieved in a number of ways since the value is determined based on several factors.\n\nMake sure customers get the most out of the product\u2014It doesn\u2019t matter how much a product can do if end users aren\u2019t aware of those capabilities, can\u2019t figure out how to use them and aren\u2019t positioned for success. Invest in onboarding, training, tutorials, contextual help, and proactive customer support to increase the chances that customers will understand how to actually use the product to its fullest.\nRecruit the right kind of customers\u2014Not all products are right for everyone, so work with sales and marketing to target prospects matching the product\u2019s ideal buyer personas. Ensure messaging is accurate and highlights actual product capabilities and benefits.\nPrice based on value\u2014Customers don\u2019t care about vendor profit margins, growth rates, and revenue targets; they want to pay what they think a product is actually worth to them. Use customer-focused pricing strategies for your product that present a clear ROI to users.\nContinually add value without breaking what already works\u2014Current customers don\u2019t mind and may appreciate new features, but this should never come at the expense of diminishing existing capabilities or disrupting the user experience.\nDon\u2019t take customers for granted\u2014No renewal should be considered a given and any customer may cancel at a moment\u2019s notice, so continually engage customers to understand their likes and dislikes as well as what could improve their experience.\n<\/P>\n\n<h2 style=\"text-align:left;\">DATA DESCRIPTION <\/h2>\n<p style=\"text-align:left;\">\nEach row represents a customer, each column contains customer\u2019s attributes described on the column Metadata.\n\nThe data set includes information about:\n\nCustomers who left within the last month \u2013 the column is called Churn\nServices that each customer has signed up for \u2013 phone, multiple lines, internet, online security, online backup, device protection, tech support, and streaming TV and movies\nCustomer account information \u2013 how long they\u2019ve been a customer, contract, payment method, paperless billing, monthly charges, and total charges\nDemographic info about customers \u2013 gender, age range, and if they have partners and dependents\n<\/p>\n\n<\/div>","39dea883":"## Training ANN","a8c5b104":"## Training KNN","15b0d2d2":"## Training Random Forest","3b06a35d":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:powderblue;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Data Preprocessing and Modelling<\/h2>\n<\/div>","1302774e":">As we can see from above\n\n>People who will churn are 1869\n\n>People who will not churn are 5174","5d30c38e":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:powderblue;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Loading Data<\/h2>\n<\/div>","81fb6d01":"**Correlation Matrix**"}}