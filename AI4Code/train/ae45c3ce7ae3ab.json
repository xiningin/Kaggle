{"cell_type":{"ae282604":"code","f359bb3f":"code","7ba22d79":"code","3f9f54cd":"code","60e12f01":"code","9613357b":"code","88a1c76d":"code","525db113":"code","4d7784fe":"code","73d4aae3":"code","c38aaedd":"markdown","2f7f6aea":"markdown","0de15354":"markdown"},"source":{"ae282604":"from google.cloud import bigquery\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n# Adding project ID from Google Cloud Platform\nPROJECT_ID = 'tdsbigquery'\nclient = bigquery.Client(project=PROJECT_ID, location=\"US\")\ndataset = client.create_dataset('tds_tutorial', exists_ok=True)","f359bb3f":"# Creating a reference of our table\ntable = client.get_table(\"bigquery-public-data.openaq.global_air_quality\")\n\n# Looking at the first five rows from our dataset\nclient.list_rows(table, max_results=5).to_dataframe()","7ba22d79":"# Checking the number of measure station in each country\nquery = \"\"\"SELECT country, COUNT(location) AS number_of_locations\n                FROM `bigquery-public-data.openaq.global_air_quality`\n                GROUP BY country\n                ORDER by number_of_locations DESC\"\"\"\n\nquery_job = client.query(query)\nquery_job.to_dataframe().head(10)","3f9f54cd":"# Statistics Summary\nquery = \"\"\"SELECT value,averaged_over_in_hours\n            FROM `bigquery-public-data.openaq.global_air_quality`\n            WHERE unit = '\u00b5g\/m\u00b3'\n            \"\"\"\nquery_job = client.query(query)\nquery_job.to_dataframe().describe()","60e12f01":"# Calculating the average value of of Ozone Gas in each different country\nquery = \"\"\"\n    SELECT\n        country, \n        avg(value) as avg_value\n    FROM\n      `bigquery-public-data.openaq.global_air_quality`\n    WHERE\n      pollutant = 'o3'\n      AND country != 'NL'\n      AND country != 'DK'\n      AND country != 'LT'\n      AND country != 'LU'\n      AND unit = '\u00b5g\/m\u00b3'\n    GROUP BY country\n    ORDER BY avg_value ASC\n        \"\"\"\n\nquery_job = client.query(query)\nquery_df = query_job.to_dataframe()\nquery_df.head()","9613357b":"plt.subplots(figsize=(12,7))\ny_pos = np.arange(len(query_df.country))\nplt.bar(y_pos, query_df.avg_value, align='center', alpha=0.7)\nplt.xticks(y_pos, query_df.country.values)\n\nplt.ylabel('NO2 values in \u00b5g\/m\u00b3', fontsize=16)\nplt.xticks(rotation= 60,fontsize=16)\nplt.xlabel('Country', fontsize=16)\nplt.title('Ozone gas Average in different countries', fontsize=20)\nplt.show()","88a1c76d":"from google.cloud.bigquery import magics\nfrom kaggle.gcp import KaggleKernelCredentials\nmagics.context.credentials = KaggleKernelCredentials()\nmagics.context.project = PROJECT_ID\n%load_ext google.cloud.bigquery","525db113":"%%bigquery\nCREATE MODEL IF NOT EXISTS `tds_tutorial.Model`\nOPTIONS(model_type='logistic_reg') AS\nSELECT\n  country AS label, latitude, longitude, value \nFROM\n  `bigquery-public-data.openaq.global_air_quality`\nLIMIT 800;","4d7784fe":"%%bigquery\nSELECT\n  *\nFROM\n  ML.TRAINING_INFO(MODEL `tds_tutorial.Model`)\nORDER BY iteration ","73d4aae3":"%%bigquery\nSELECT\n  *\nFROM ML.EVALUATE(MODEL `tds_tutorial.Model`, (\nSELECT\n  country AS label, latitude, longitude, value \nFROM\n  `bigquery-public-data.openaq.global_air_quality`\nLIMIT 800))","c38aaedd":"## BigQuery Preprocessing","2f7f6aea":"# BigQuery Tutorial","0de15354":"## BigQuery ML"}}