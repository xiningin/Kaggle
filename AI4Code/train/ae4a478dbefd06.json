{"cell_type":{"050661ef":"code","c2efcdff":"code","3e71eaf8":"code","a1627dc3":"code","8aa4a46e":"code","67d21edb":"code","0001c239":"code","33c4901d":"code","102c3548":"markdown","99a53000":"markdown","75a9cee0":"markdown","4a49f68a":"markdown","166666ed":"markdown","7376ff00":"markdown","a8798545":"markdown","b64f4fe0":"markdown","4ddb2e3d":"markdown"},"source":{"050661ef":"from IPython.display import clear_output\n\nimport numpy as np\nimport pandas as pd\n\nimport h2o\nfrom h2o.automl import H2OAutoML","c2efcdff":"from h2o.automl import H2OAutoML\nh2o.init()","3e71eaf8":"train = pd.read_csv(\"..\/input\/tabular-playground-series-dec-2021\/train.csv\")\ntest = pd.read_csv(\"..\/input\/tabular-playground-series-dec-2021\/test.csv\")\nsubs = pd.read_csv(\"..\/input\/tabular-playground-series-dec-2021\/sample_submission.csv\")\n\ntrain = h2o.H2OFrame(train)\ntest = h2o.H2OFrame(test)","a1627dc3":"train.describe()","8aa4a46e":"RANDOM_STATE = 12\nRUNTIME = 3600*5 #5 hours\nN_FOLDS = 5\nSTOPPING_METRIC = \"auto\"\n\nx = train.columns\ny = \"Cover_Type\"\nx.remove(y)\nx.remove('Id')\n\ntrain[y] = train[y].asfactor()","67d21edb":"aml = H2OAutoML(stopping_metric=STOPPING_METRIC , nfolds=N_FOLDS, seed=RANDOM_STATE, max_runtime_secs=RUNTIME)\naml.train(x=x, y=y, training_frame=train)","0001c239":"lb = aml.leaderboard\nlb.head(10)","33c4901d":"preds = aml.leader.predict(test)\nclear_output()\nsub = preds[0].as_data_frame()  ## Converting to dataframe\nsubs['Cover_Type'] = sub\nsubs.to_csv('h20-subs.csv',index = False)\nsubs.head()","102c3548":"# Imports","99a53000":"**Created by Sanskar Hasija**\n\n**[TPS -Dec]\ud83e\udd16 H20 AutoML \ud83e\udd16**\n\n**1 DECEMBER 2021**\n","75a9cee0":"# Submission","4a49f68a":"# Data Loading and Preprocessing","166666ed":"# <center> [TPS -DEC]\ud83e\udd16 H20 AUTOML \ud83e\udd16<\/center>\n## <center>If you find this notebook useful, support with an upvote\ud83d\udc4d<\/center>","7376ff00":"# AutoML","a8798545":"### Top 10 models","b64f4fe0":"# Results Leaderboard","4ddb2e3d":"# Initializing H20 Cluster"}}