{"cell_type":{"2a1d46a6":"code","bf9a1735":"code","11da87b6":"code","ca55d9ed":"code","bc20c382":"code","bc47a20d":"code","5940cd75":"code","7ab2ce1b":"code","27e2d225":"code","0699409f":"code","d3dae1b7":"code","dc2d6a21":"code","1878ab28":"code","1bb980db":"code","743abd84":"code","4ed2168c":"code","80c29580":"code","f24daa36":"code","796ab3a3":"code","b99e27e1":"code","8211dd2d":"code","95791c7f":"code","087dc8ef":"code","c810fda4":"code","a217653a":"code","188290a8":"code","f72f0936":"code","05541b69":"code","d7f3a3c4":"code","6d06595c":"code","225bce82":"code","0d720706":"code","03b1eee0":"code","0dd54d6c":"code","0dcc3f01":"markdown","02121e63":"markdown","3fc92d89":"markdown","64da0a6c":"markdown","5bcdcddc":"markdown","144ef02b":"markdown","1f59db35":"markdown","cef83e38":"markdown","0158469e":"markdown","e4ffd560":"markdown","fab3d703":"markdown","cca3417c":"markdown","1c8cff80":"markdown","bfab3e17":"markdown","c8264cf2":"markdown","ffe31437":"markdown","fe61daba":"markdown","789af411":"markdown","40b68a58":"markdown","6f976e0e":"markdown"},"source":{"2a1d46a6":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly as py\nimport plotly.express as px\nimport plotly.graph_objs as go\nfrom plotly.subplots import make_subplots\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot\ninit_notebook_mode(connected=True) \n\nimport warnings\nwarnings.filterwarnings('ignore')","bf9a1735":"df_train = pd.read_csv('..\/input\/nfl-big-data-bowl-2020\/train.csv', low_memory=False)","11da87b6":"print(\"Total Row Number: {0} \\nTotal Col Number: {1}\".format(df_train.shape[0], df_train.shape[1]))","ca55d9ed":"df_train.head()","bc20c382":"df_train.info()","bc47a20d":"df_train.columns","5940cd75":"nullvalues = df_train.loc[:, df_train.isnull().any()].isnull().sum().sort_values(ascending=False)\n\nprint(nullvalues)","7ab2ce1b":"#i'll ignore to ids.\nf,ax = plt.subplots(figsize=(12,10))\nsns.heatmap(df_train.iloc[:,2:].corr(),annot=True, linewidths=.1, fmt='.1f', ax=ax)\n\nplt.show()","27e2d225":"unique_plays = df_train.groupby('Season').agg({'PlayId': 'nunique', 'GameId': 'nunique', 'NflId':'nunique'})\nunique_plays.columns = [\"PlayCount\",\"GameCount\", \"PlayerCount\"]\n\nprint(unique_plays)","0699409f":"f,ax=plt.subplots(1,3,figsize=(11,4))\nunique_plays[\"PlayCount\"].plot(ax=ax[0],color='crimson', kind='bar')\n\nax[0].set_title('Count of Plays')\nunique_plays[\"GameCount\"].plot(ax=ax[1],color='darkmagenta', kind='bar')\n\nax[1].set_title('Count of Games')\nunique_plays[\"PlayerCount\"].plot(ax=ax[2],color='slateblue', kind='bar')\n\nax[2].set_title('Count of Player')\n\nplt.show()","d3dae1b7":"df_team = df_train.loc[:,['PlayId', 'Team']].drop_duplicates()\nteamcount = df_team[\"Team\"].value_counts()\ndf_teamcount = pd.DataFrame({'Team': teamcount.index, 'Count': teamcount.values})\n\nfig = px.bar(df_teamcount, x='Team', y='Count')\nfig.update_layout(\n    title_text=\"Team (Away or Home)\", height=300, width=300)\n\nfig.show()","dc2d6a21":"df_player = df_train.loc[:,['NflId', 'DisplayName', 'PlayerBirthDate', 'PlayerWeight', 'PlayerHeight', 'PlayerCollegeName']].drop_duplicates()\n\ndf_player[\"HeightFt\"] = df_player[\"PlayerHeight\"].str.split('-', expand=True)[0].astype(int)\ndf_player[\"HeightIn\"] = df_player[\"PlayerHeight\"].str.split('-', expand=True)[1].astype(int)\ndf_player[\"HeightCm\"] = df_player[\"HeightFt\"]*30.48 + df_player[\"HeightIn\"]*2.54\n\ndf_player[\"WeightKg\"] = df_player[\"PlayerWeight\"]*0.45359237\n\ndf_height = df_player.groupby(['PlayerHeight','HeightFt','HeightIn']).size().reset_index().sort_values([\"HeightFt\", \"HeightIn\"])\n\ndf_height.columns = [\"PlayerHeight\",\"HeightFt\",\"HeightIn\",\"Count\"]","1878ab28":"f,ax=plt.subplots(1,2,figsize=(13,5))\ndf_height.loc[:,[\"PlayerHeight\",\"Count\"]].set_index(\"PlayerHeight\").plot(ax=ax[0],color='slateblue', kind='bar')\n\nax[0].set_xlabel(\"Height\") \nax[0].set_ylabel(\"Count\") \nax[0].get_legend().remove()\nax[0].set_title('Player Height (ft-in)')\n\ndf_player.PlayerWeight.plot.hist(ax=ax[1],bins=30,edgecolor='black',color='steelblue')\n\nax[1].set_xlabel(\"Weight\") \nax[1].set_title('Player Weight (lbs)')\n\nplt.show()","1bb980db":"fig = go.Figure(data=go.Scattergl\n(\n    x = df_player[\"HeightCm\"], \n    y = df_player[\"WeightKg\"],\n    mode='markers',\n    text = df_player['DisplayName'],\n    marker=dict(line_width=0.4),\n    marker_color='rgb(0,145,119)'))\n\nfig.update_layout(title='Weight Height Correlation', height=600, width=800)\nfig.update_xaxes(title_text=\"Height (Cm)\")\nfig.update_yaxes(title_text=\"Weight (Kg)\")\n\nfig.show()","743abd84":"Collage = df_player[\"PlayerCollegeName\"].value_counts()\ndf_CollageCount = pd.DataFrame({'College Name':Collage.index, 'Count':Collage.values}).sort_values(\"Count\", ascending = False).head(50)\n\nfig = px.bar(df_CollageCount, x='College Name', y='Count', title=\"The 50 Top Colleges With The Most Players\", height=700, width=800)\n\nfig.update_traces(marker_color='rgb(239, 117, 100)', marker_line_color='rgb(8,48,107)',\n                  marker_line_width=2, opacity=0.7)\n\nfig.show()","4ed2168c":"df_player['BirthDate'] = df_player['PlayerBirthDate'].astype('datetime64[ns]')\n\n#df_train[\"TimeSnap\"].astype('datetime64[ns]').sort_values(ascending=False)\n#max date in TimeSnap cloumn is 2018-12-31, so i'm not using today function\n\ndf_player['MaxDate'] = pd.to_datetime('2018-12-31')\n\ndf_player['Age'] = round((df_player['MaxDate'] - df_player['BirthDate'])\/np.timedelta64(1,'D')\/365.25,1)","80c29580":"plt.figure(figsize=(6,6))\n\nplt.hist(df_player[\"Age\"], bins=20 ,edgecolor='black', color='crimson')\nplt.title(\"Age of Players in 2018 Season\")\n\nplt.show()","f24daa36":"df_stadium = df_train.loc[:,[\"PlayId\",\"Stadium\", \"StadiumType\"]].drop_duplicates()\nstadium = df_stadium[\"Stadium\"].value_counts()\ndf_stadiumCount = pd.DataFrame({'Stadium':stadium.index, 'Count':stadium.values}).sort_values(\"Stadium\")\n\nfig = px.bar(df_stadiumCount, x='Stadium', y='Count', title=\"Games by Stadium\", height=700, width=800)\n\nfig.update_traces(marker_color='darkorange', marker_line_color='rgb(8,48,107)',\n                  marker_line_width=2, opacity=0.7)\n\nfig.show()","796ab3a3":"StadiumType = df_stadium[\"StadiumType\"].value_counts()\n\ndf_StadiumType = pd.DataFrame({'StadiumType':StadiumType.index, 'Count':StadiumType.values}).sort_values(\"StadiumType\")\n\nfig = px.bar(df_StadiumType, x='StadiumType', y='Count', title=\"Games by Stadium Type\", height=600, width=800)\n\nfig.update_traces(marker_color='rgb(158,202,225)', marker_line_color='rgb(8,48,107)',\n                  marker_line_width=1.5, opacity=0.6)\n\nfig.show()","b99e27e1":"stadium_loc = df_train.loc[:,['GameId', 'Location']].drop_duplicates()\nstadium_loc = stadium_loc['Location'].value_counts()\n\ndf_stadium_loc = pd.DataFrame({'Location':stadium_loc.index, 'Count':stadium_loc.values})\n\ndf_stadium_loc[\"State\"] = df_stadium_loc[\"Location\"].str.split(', ', expand=True)[0]\ndf_stadium_loc[\"StateAbb\"] = df_stadium_loc[\"Location\"].str.split(', ', expand=True)[1]\n\n\nfig = go.Figure(data=go.Choropleth(\n    locations=df_stadium_loc[\"StateAbb\"], \n    z = df_stadium_loc['Count'], \n    locationmode = 'USA-states', \n    text = df_stadium_loc['State'],\n    colorscale=\n            [[0.0, \"rgb(251, 237, 235)\"],\n            [0.09, \"rgb(245, 211, 206)\"],\n            [0.12, \"rgb(239, 179, 171)\"],\n            [0.15, \"rgb(236, 148, 136)\"],\n            [0.22, \"rgb(239, 117, 100)\"],\n            [0.35, \"rgb(235, 90, 70)\"],\n            [0.45, \"rgb(207, 81, 61)\"],\n            [0.65, \"rgb(176, 70, 50)\"],\n            [0.85, \"rgb(147, 59, 39)\"],\n            [1.00, \"rgb(110, 47, 26)\"]],\n    autocolorscale = False))\n\nfig.update_layout(\n    geo_scope='usa',\n    title_text = 'Total Number of Games by States in 2017 and 2018', height=500, width=700)\n\nfig.show()","8211dd2d":"df_Def = df_train.loc[:,[\"PlayId\",\"DefensePersonnel\"]].drop_duplicates()\nDefenseCount = df_Def[\"DefensePersonnel\"].value_counts()\n\ndic_Defense = {'DL': [0],'LB': [0],'DB': [0],'OL': [0]}\ndf_Defense = pd.DataFrame.from_dict(dic_Defense, orient='index')\ndf_Defense.columns = [\"Count\"]\n\nfor i in DefenseCount.index:\n    for j in i.split(\", \"):\n        df_Defense.loc[ j.split(\" \")[1] : j.split(\" \")[1],:] += int(j.split(\" \")[0]) * DefenseCount[i]","95791c7f":"colors = ['gold', 'mediumturquoise', 'darkorange', 'lightgreen']\n\nfig = go.Figure(data=[go.Pie(labels=df_Defense.index.values.tolist(), \n                             values=df_Defense[\"Count\"].tolist())])\nfig.update_traces(hoverinfo='label+percent', textinfo='value', textfont_size=18,\n                  marker=dict(colors=colors, line=dict(color='#000000', width=2)))\n\nfig.update_layout(\n    title_text=\"Defensive Players Ratio in All Plays\", height=500, width=700\n)\n\nfig.show()","087dc8ef":"df_Off = df_train.loc[:,[\"PlayId\",\"OffensePersonnel\"]].drop_duplicates()\ndf_Off[\"OffensePersonnel\"] = df_Off[\"OffensePersonnel\"].str.replace(\",1\", \", 1\")\ndf_Off[\"OffensePersonnel\"] = df_Off[\"OffensePersonnel\"].str.replace(\",2\", \", 2\")\nOffenseCount = df_Off[\"OffensePersonnel\"].value_counts()\n\ndic_Offense = {'DL': [0],'LB': [0],'DB': [0],'OL': [0],'RB': [0],'TE': [0],'WR': [0],'QB': [0]}\ndf_Offense = pd.DataFrame.from_dict(dic_Offense, orient='index')\ndf_Offense.columns = [\"Count\"]\n\nfor i in OffenseCount.index:\n    for j in i.split(\", \"):\n        df_Offense.loc[ j.split(\" \")[1] : j.split(\" \")[1],:] += int(j.split(\" \")[0]) * OffenseCount[i]","c810fda4":"colors = ['g', 'b', 'p', 'plum', 'gold', 'mediumturquoise', 'darkorange', 'lightgreen']\n\nfig = go.Figure(data=[go.Pie(labels=df_Offense.index.values.tolist(), \n                             values=df_Offense[\"Count\"].tolist() , hole=.3)])\n\nfig.update_traces(hoverinfo='label+percent', textinfo='value', textfont_size=18,\n                  marker=dict(colors=colors, line=dict(color='#000000', width=2)))\n\nfig.update_layout(\n    title_text=\"Offensive Players Ratio in All Plays\", height=500, width=700)\n\nfig.show()","a217653a":"df_speed = df_train.loc[:,['DisplayName', 'S']].groupby('DisplayName').mean()\ndf_speed.columns = [\"Average Speed\"]\ndf_speed = df_speed.sort_values(\"Average Speed\", ascending = False)","188290a8":"fig = px.histogram(df_speed, x=\"Average Speed\",\n                   title='Average Speed Distribution of Players',\n                   opacity=0.8,\n                   color_discrete_sequence=['indianred']\n                   )\n\nfig.update_layout(\n    yaxis_title_text='Count',\n    height=500, width=800)\n\nfig.update_traces(marker_line_color='rgb(8,48,107)',\n                  marker_line_width=1.5, opacity=0.8\n                 )\n\nfig.show()","f72f0936":"df_speed_yards = df_train[df_train[\"NflIdRusher\"] == df_train[\"NflId\"]].loc[:,['GameId', 'DisplayName', 'S', 'Yards']]\n\n\nfig = go.Figure(data=go.Scattergl\n(\n    x = df_speed_yards[\"Yards\"], \n    y = df_speed_yards[\"S\"],\n    text = df_speed_yards['DisplayName'],\n    mode='markers',\n    marker=dict(line_width=0.4),\n    marker_color='darkorange'))\n\nfig.update_layout(title='Speed to Yards', height=700, width=800)\n\nfig.update_xaxes(title_text=\"Yards\")\nfig.update_yaxes(title_text=\"Speed (yards\/second)\")\n\nfig.show()","05541b69":"df_MaxSpeed = df_train.loc[:,['DisplayName', 'PlayerBirthDate', 'TimeSnap', 'S', 'Orientation']].groupby(['DisplayName', 'PlayerBirthDate'], as_index=False).max()\n\ndf_MaxSpeed[\"Age\"] = round((df_MaxSpeed['TimeSnap'].astype('datetime64[ns]') - df_MaxSpeed['PlayerBirthDate'].astype('datetime64[ns]'))\/np.timedelta64(1,'D')\/365.25,1)","d7f3a3c4":"fig = go.Figure(data=go.Scattergl\n(\n    x = df_MaxSpeed[\"S\"], \n    y = df_MaxSpeed[\"Age\"],\n    text = df_MaxSpeed['DisplayName'],\n    mode='markers',\n    marker=dict(line_width=0.4),\n    marker_color='mediumorchid'\n)\n               ) \n\nfig.update_layout(title='Age of The Players When They Make Their Maximum Speed', height=700, width=800)\nfig.update_traces(marker_line_color='rgb(8,48,107)', opacity=0.7)\n\nfig.update_xaxes(title_text=\"Speed of Player (yards\/second)\")\nfig.update_yaxes(title_text=\"Age\")\n\nfig.show()","6d06595c":"fig = go.Figure()\n\nfig.add_trace(go.Scatter(x=df_MaxSpeed[\"S\"], y=df_MaxSpeed[\"Orientation\"],\n                    mode='markers',\n                    text = df_MaxSpeed['DisplayName'],     \n                    name='Speed',\n                    marker=dict(line_width=0.4)\n                    )\n             )\n\nfig.add_trace(go.Scatter(x=df_MaxSpeed[\"Age\"], y=df_MaxSpeed[\"Orientation\"],\n                    mode='markers',\n                    text = df_MaxSpeed['DisplayName'],     \n                    name='Age',\n                    marker=dict(line_width=0.4)\n                    )\n             )\n\nfig.update_layout(title='Orientation & Speed +  Orientation & Age Correlation', height=500, width=800)\n\nfig.update_traces(marker_line_color='rgb(8,48,107)', opacity=0.8)\nfig.update_yaxes(title_text=\"Orientation\")\n\nfig.show()","225bce82":"df_defenders = df_train.loc[:,['DefendersInTheBox', 'Yards']]\n\nd1 = df_defenders[df_defenders.DefendersInTheBox==1]['Yards']\nd2 = df_defenders[df_defenders.DefendersInTheBox==2]['Yards']\nd3 = df_defenders[df_defenders.DefendersInTheBox==3]['Yards']\nd4 = df_defenders[df_defenders.DefendersInTheBox==4]['Yards']\nd5 = df_defenders[df_defenders.DefendersInTheBox==5]['Yards']\nd6 = df_defenders[df_defenders.DefendersInTheBox==6]['Yards']\nd7 = df_defenders[df_defenders.DefendersInTheBox==7]['Yards']\nd8 = df_defenders[df_defenders.DefendersInTheBox==8]['Yards']\nd9 = df_defenders[df_defenders.DefendersInTheBox==9]['Yards']\nd10 = df_defenders[df_defenders.DefendersInTheBox==10]['Yards']\nd11 = df_defenders[df_defenders.DefendersInTheBox==11]['Yards']","0d720706":"fig = go.Figure()\nyards = [d1, d2, d3, d4, d5, d6, d7, d8, d9, d10, d11]\ntags = [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\"]\n\nfor index, category in enumerate(yards):\n    fig.add_trace(go.Box(y=category, name=tags[index]))\n    \nfig.update_layout(autosize=False, width=800,height=500,showlegend=False,\n                  title=\"Yards and Number of Defenders in the Box Correlation\", \n                  yaxis=dict(title=\"Yards\"), \n                  xaxis=dict(title=\"Number of Players\"),\n                  paper_bgcolor='rgb(243, 243, 243)', \n                  plot_bgcolor='rgb(243, 243, 243)', \n                  margin=dict(l=40,r=30,b=80,t=100,)\n                 )\n\nfig.show()","03b1eee0":"df_OffenseForm = df_train.loc[:,['PlayId', 'OffenseFormation', 'Season']].drop_duplicates()\nOffenseForm2017 = df_OffenseForm[df_train[\"Season\"] == 2017][\"OffenseFormation\"].value_counts()\nOffenseForm2018 = df_OffenseForm[df_train[\"Season\"] == 2018][\"OffenseFormation\"].value_counts()\n\nfig = make_subplots(rows=1, cols=2, specs=[[{'type':'domain'}, {'type':'domain'}]])\n\nfig.add_trace(\n    go.Pie(labels=OffenseForm2017.index, values=OffenseForm2017.values, name=\"2017\"),\n              1, 1)\n\nfig.add_trace(\n    go.Pie(labels=OffenseForm2018.index, values=OffenseForm2018.values, name=\"2018\"),\n              1, 2)\n\nfig.update_traces(hole=.4, hoverinfo=\"label+value\")\n\nfig.update_layout(\n    title_text=\"Favorite Offense Formation in 2017 and 2018\",\n    height=500, width=800,\n    annotations=[dict(text='2017', x=0.18, y=0.5, font_size=20, showarrow=False),\n                 dict(text='2018', x=0.82, y=0.5, font_size=20, showarrow=False)]\n)\n\nfig.show()","0dd54d6c":"df_xy = df_train[(df_train[\"NflIdRusher\"] == df_train[\"NflId\"])].loc[:,[\"Yards\", \"DefendersInTheBox\", \"X\", \"Y\" ]].sort_values(\"X\" )\n\n\nfig = go.Figure(data=go.Scattergl\n(\n    x = df_xy[\"X\"], \n    y = df_xy[\"Y\"],\n    mode='markers',\n    marker=dict(line_width=0.8),\n    marker_color='tan'))\n\nfig.update_layout(title='X and Y Positions of Players', height=700, width=800)\nfig.update_traces(marker_line_color='rgb(8,48,107)', opacity=0.7)\n\nfig.update_xaxes(title_text=\"X\")\nfig.update_yaxes(title_text=\"Y\")\n\nfig.show()","0dcc3f01":"<a id=\"3\"><\/a> <br>\n# Data Visualization","02121e63":"**Content**\n1. [Importing Libraries and Loading Dataset](#1)\n1. [Understanding Dataset](#2)\n1. [Data Visualization](#3)\n1. [Ending](#4)","3fc92d89":"It's reasonable, \"home\" and \"away\" are equal to each other","64da0a6c":"<a id=\"2\"><\/a> <br>\n# Understanding Dataset","5bcdcddc":"If we zoom in on the chart, a regular distribution appears as follows.","144ef02b":"<img src=\"https:\/\/i.ibb.co\/WfCg2Ny\/kaggle-NFL.png\" width=\"800\"> ","1f59db35":"There are a lot of version of stadium types. It must be cleaned up.","cef83e38":"## NFL Big Data Bowl","0158469e":"We can see vital points as two lines. We can also see field guidelines and outliers.","e4ffd560":"<a id=\"1\"><\/a> <br>\n# Importing Libraries and Loading Dataset","fab3d703":"It seems to, most players have 2 - 2.3 yards\/second speed.","cca3417c":"<img src=\"https:\/\/i.ibb.co\/prCZrWf\/Dv-C9-Btp-Ws-AACt-AP.jpg\" width=\"800\"> ","1c8cff80":"#### To be continued... If you like the kernel, Please upvote.","bfab3e17":"The graph above shows the speed of players on their way to target.","c8264cf2":"There are a close relationship between S and Dis. There are also a relationship between JerseyNumber and PlayerWeight. ","ffe31437":"I have calcalculated real time age with game played time.","fe61daba":"OLs are the minority group among the defensive players with 15 total. So they aren't visible on the chart.  ","789af411":"<a id=\"4\"><\/a> <br>\n# Ending","40b68a58":"There are 49 columns and 11 columns have null values. Total null values of these are below:","6f976e0e":"NFL Big Data Bowl dataset includes location, speed, acceleration, and velocity for all players on the field along with many other features such as weather conditions, stadium etc.\n\nLet's begin."}}