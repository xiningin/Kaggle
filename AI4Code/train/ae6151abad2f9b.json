{"cell_type":{"d0995ace":"code","9b8ad6ed":"code","759f2c97":"code","57b502d4":"code","200d0f70":"code","68e6587b":"code","5f25dc32":"code","bae2fcb0":"code","d19e832d":"code","d80aa335":"code","74e44040":"code","6358a040":"code","0442e15b":"code","b88e2bb5":"code","bc74aa57":"code","f3b5bb13":"code","7427a660":"code","28f15d48":"code","828556ee":"code","8c0bac9b":"code","fab0ee38":"code","f56dcc9b":"code","126cbc8b":"code","4f07c6bb":"markdown","b97f038a":"markdown","11cabbb0":"markdown","68eb6926":"markdown","2be4f4ee":"markdown","68cd0871":"markdown","be97a064":"markdown","402a13dc":"markdown","2450898d":"markdown","9e019cdd":"markdown","1af757b2":"markdown","d889e429":"markdown","a27717ce":"markdown","dcebd327":"markdown","7fbe5b3e":"markdown","65ee0208":"markdown","4ae1f81b":"markdown","4a2b72f3":"markdown","29d20c5f":"markdown","701712ed":"markdown","38f00484":"markdown","b615eeb3":"markdown","855a065b":"markdown","51432ffe":"markdown","109d2a61":"markdown","2d86241b":"markdown","f2df6288":"markdown","e925e75d":"markdown","d9ae30f7":"markdown","3aff4b77":"markdown","afca4e30":"markdown","5ec825d8":"markdown","15567561":"markdown","928e5912":"markdown","c9a15897":"markdown","f6344cd1":"markdown","d1281b2f":"markdown","28793ce8":"markdown","edd30dde":"markdown","00f77362":"markdown","66128e43":"markdown","d674f6fd":"markdown","4c95d0d3":"markdown","f179b6b5":"markdown","45acf656":"markdown","ea2fd722":"markdown","5ac87e23":"markdown"},"source":{"d0995ace":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","9b8ad6ed":"df = pd.DataFrame({'bmi':[4.0,5.5,6.8,7.2,7.8,9.8,9.7,8.8,11.0,13.0],'glu':[60,135,90,175,240,220,300,370,360,365]})","759f2c97":"df","57b502d4":"plt.scatter(x = 'bmi',y = 'glu',data = df)\nplt.xlabel('BMI')\nplt.ylabel('glucose')","200d0f70":"\u00df1 = np.cov(df['bmi'],df['glu'],ddof = 1)\/np.var(df['bmi'],ddof = 1)\n\u00df1","68e6587b":"beta1 = np.sum((df['bmi']-np.mean(df['bmi']))*(df['glu']-np.mean(df['glu'])))\/np.sum((df['bmi']-np.mean(df['bmi']))**2)\nbeta1","5f25dc32":"\u00df0 = (np.mean(df['glu'])) - (beta1 * np.mean(df['bmi']))\n\u00df0","bae2fcb0":"glu_pred = \u00df0 + beta1 * df['bmi']","d19e832d":"glu_pred","d80aa335":"plt.scatter(x = 'bmi',y = 'glu',data = df)\nplt.plot(df['bmi'],glu_pred,color = 'red')\nplt.xlabel('BMI')\nplt.ylabel('glucose')","74e44040":"mse = np.sum((df['glu'] - glu_pred)**2)\/10\nmse","6358a040":"sse = np.sum((df['glu'] - glu_pred)**2)\nsse","0442e15b":"rmse = np.sqrt(mse)\nrmse","b88e2bb5":"average = np.mean(df['glu'])\nmse_of_base_line_model = np.sum((df['glu'] - average)**2)\/10 \nrmse_of_base_line_model = np.sqrt(mse_of_base_line_model)\nprint(average)\nprint(mse_of_base_line_model)\nprint(rmse_of_base_line_model)","bc74aa57":"from sklearn.linear_model import LinearRegression","f3b5bb13":"x = df[['bmi']] #bmi is a series. Model expects a dataframe. So it is passed inside two brackets.\ny = df['glu'] #dependent variable\nmodel = LinearRegression()\nmodel.fit(x,y)","7427a660":"model.coef_","28f15d48":"model.intercept_","828556ee":"Glu_pred = model.predict(x)\nGlu_pred","8c0bac9b":"R=np.corrcoef(df['glu'],glu_pred)\nR","fab0ee38":"R2 =  0.86584815**2\nprint(R2)","f56dcc9b":"from sklearn.metrics import r2_score","126cbc8b":"r2_score(df['glu'],Glu_pred)","4f07c6bb":"![1_a-VgcdKJ7Ix2EjVpnPKNZQ.png](attachment:1_a-VgcdKJ7Ix2EjVpnPKNZQ.png)","b97f038a":"#### I have created a small toy dataset for easy interpretation.","11cabbb0":"![MSE.png](attachment:MSE.png)","68eb6926":"### **SCATTER PLOT BETWEEN THE DEPENDENT AND INDEPENDENT VARIABLE** ","2be4f4ee":"![SSE.png](attachment:SSE.png)","68cd0871":"![Covariance.jpg](attachment:Covariance.jpg)","be97a064":"###### Hello everyone! In this notebook, we'll learn about the manual calculation behind Linear Regression. Then we are going to verify it with the sklearn package. Happy learning!","402a13dc":"###### The prediction of the base line model is the mean of the dependent variable. This is the worst model. The model we build should always be better than this model.","2450898d":"### **VERIFYING WITH SKLEARN**","9e019cdd":"### **GLUCOSE PREDICTION**","1af757b2":"###### RMSE is the square root of MSE. RMSE is the average of the errors. This is one of the most popular metrics for model evaluation.","d889e429":"###### or","a27717ce":"###### SSE is the sum of the difference between the actual and predicted value.","dcebd327":"### **\u00df0 CALCULATION :**","7fbe5b3e":"This is how sklearn calculates the co-efficient of BMI.","65ee0208":"### **\u00df0 USING SKLEARN**","4ae1f81b":"#### **As we can see, the values from our manual calculation match with the one obtained by SKLEARN.**","4a2b72f3":"### **\u00df1 USING SKLEARN**","29d20c5f":"#### From the above plot, we can infer that there is a linear relationship(positive correlation) between the variables. So, linear regression works well with this dataset.","701712ed":"### **REGRESSION PLOT**","38f00484":"#### In the above formula, the denominator is represented by n-1 because this is a sample representation of the population and not the population itself.","b615eeb3":"### **ROOT MEAN SQUARED ERROR(RMSE)**","855a065b":"###### Reducing the Mean Sqaured Error(MSE) is the objective of the cost function. Smaller the MSE, better the model.","51432ffe":"### IMPORTING LIBRARIES","109d2a61":"###### **COST FUNCTION**","2d86241b":"###### So folks, this is it for this notebook. Please leave an UPVOTE if you found this notebook informative. Your feedbacks are always welcome! ","f2df6288":"### **EQUATION FOR LINEAR REGRESSION**","e925e75d":"### **R SQUARED**","d9ae30f7":"###### We have fitted a straight line to the model. This is the best fit line for this model. ","3aff4b77":"### **\u00df1 CALCULATION:**","afca4e30":"Here, Yi is the actual value and yhat is the predicted value.","5ec825d8":"###### R2, in simple terms is the amount of variation of the dependent variable covered by our model.","15567561":"### **R SQUARED USING CORRCOFF**","928e5912":"### **MEAN SQUARED ERROR**","c9a15897":"### BASE LINE MODEL","f6344cd1":"### **SUM OF SQUARED ERROR**","d1281b2f":"As we can see, our model is significantly better than the base line model.","28793ce8":"$ \u00df0 = \\bar{y} - \u00df1* \\bar{x} $ ","edd30dde":"###### What is Linear Regression?\n######     Linear Regression is the approach of finding the relationship between the dependent and independent variables by fitting a line to the data. In simple terms, linear regression tries to capture the linear relationship between the variables in the data. It is one of the most simplistic approaches to machine learning.","00f77362":"#### where \u00df0 is the intercept and \u00df1 is the slope of the equation.","66128e43":"### **GLUCOSE PREDICTION**","d674f6fd":"![](http:\/\/)","4c95d0d3":"###### \u00df1 = covariance(x,y)\/variance(x)","f179b6b5":"###### These are the predicted glucose levels. ","45acf656":"### glucose = \u00df0 + \u00df1*(BMI)","ea2fd722":"### **R2 USING SKLEARN **","5ac87e23":"###### We are going to predict the glucose level from BMI. So, glucose is the dependent variable and BMI is the independent variable."}}