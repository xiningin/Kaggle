{"cell_type":{"7a0fd29e":"code","b0f6117e":"code","193613ff":"code","2bd5f83a":"code","6fe9e14f":"code","9624c35d":"code","b03e72b3":"code","88976f06":"code","582e8fc6":"code","c36329a3":"code","c3ec809c":"code","67b06643":"code","17d754a7":"code","4cd92918":"code","d766ff78":"code","b4c0d4cd":"code","2702a4a7":"code","d8f82bf0":"code","10ef50d7":"code","8294d86c":"markdown","b855f65d":"markdown","49d30ed8":"markdown","18ef24e8":"markdown","d529c129":"markdown"},"source":{"7a0fd29e":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","b0f6117e":"# suppress scientific notation\npd.set_option('display.float_format', lambda x: '%.3f' % x)\nnp.set_printoptions(suppress=True)","193613ff":"data_df = pd.read_csv('..\/input\/credit_card_clients_split.csv')\ndata_df.sample(n=3)","2bd5f83a":"data_df.describe()","6fe9e14f":"data_df.avg_monthly_turnover.describe()","9624c35d":"print('Data shape: %s' % (data_df.shape,))","b03e72b3":"education_title_to_numeric = {\n    'US': 0, # unfinished general\n    'SS': 1, # special general\n    'S':  2, # general\n    'UH': 3, # unfinished higher\n    'H':  4, # higher\n    'HH': 5, # several higher\n    'A':  6  # PhD\n}","88976f06":"data_df['education_numeric'] = data_df.education.apply(lambda e: education_title_to_numeric[e])","582e8fc6":"train_df = data_df[data_df.avg_monthly_turnover.notnull()]\ntest_df = data_df[data_df.avg_monthly_turnover.isnull()]\nprint('train size: %d, test size: %d' % (train_df.shape[0], test_df.shape[0]))","c36329a3":"percentages = [0, 25, 50, 75, 85, 98, 100]\npercentiles = np.percentile(train_df.avg_monthly_turnover.dropna(), percentages)\npercentile_list = pd.DataFrame(\n    {'percentages': percentages,\n     'avg_monthly_turnover value': percentiles})\npercentile_list","c3ec809c":"from pylab import rcParams\nrcParams['figure.figsize'] = 8, 8\nplt.style.use('fivethirtyeight')","67b06643":"plt.plot(percentages, percentiles)\nplt.xlabel('Percentage')\nplt.ylabel('Avg Monthly Turnover')\nplt.title('Percentile to Avg Monthly Turnover');","17d754a7":"outliers_threshold_percentage = .98\namt = train_df.avg_monthly_turnover\namt_qcut = train_df[train_df.avg_monthly_turnover < amt.quantile(outliers_threshold_percentage)]['avg_monthly_turnover']\nplt.hist(amt_qcut, 100, facecolor='blue', alpha=0.5)\nplt.xlabel('avg monthly turnover')\nplt.title('%s%% avg monthly turnover histogram' % outliers_threshold_percentage);","4cd92918":"import seaborn as sns\nsns.countplot(data_df.education).set_title(\"Education\");","d766ff78":"partial_train_df = train_df[train_df.avg_monthly_turnover < amt.quantile(.95)]\n\n(sns.FacetGrid(partial_train_df[(partial_train_df['education']\\\n                        .isin(partial_train_df['education']\\\n                              .value_counts()[:4].index.values))],\n               hue='education', aspect=2)\n  .map(sns.kdeplot, 'avg_monthly_turnover', shade=True)\n .add_legend()\n)\nplt.title('Distribuition of Avg Monthly Turnover by Education')\nplt.show()","b4c0d4cd":"sns.kdeplot(train_df.age, label='Age train')\nsns.kdeplot(test_df.age, label='Age test')\n\nplt.xlabel('Age (years)'); plt.ylabel('Density'); plt.title('Distribution of Ages Across Train and Test');","2702a4a7":"meaningful_features =  ['income', 'age', 'education_numeric']\nmeaningful_columns = meaningful_features + ['avg_monthly_turnover']","d8f82bf0":"correlations = train_df[meaningful_columns].corr()\ncorrelations_to_target = correlations['avg_monthly_turnover'].sort_values()","10ef50d7":"sns.heatmap(correlations, cmap = plt.cm.RdYlBu_r, vmin = -0.25, annot = True, vmax = 0.6)\nplt.title('Correlation Heatmap');","8294d86c":"# Examine Features","b855f65d":"# Train Test Split","49d30ed8":"# Check Correlations","18ef24e8":"# Examine the Target Column","d529c129":"# Data Preprocessing"}}