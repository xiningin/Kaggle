{"cell_type":{"9274bf9b":"code","5f5a4141":"code","e1188095":"markdown"},"source":{"9274bf9b":"import numpy as np\nimport cv2\nimport matplotlib.pyplot as plt\noriginal_image = cv2.imread(\"..\/input\/image0\/ccc.jpg\")\nimg=cv2.cvtColor(original_image,cv2.COLOR_BGR2RGB)\nvectorized = img.reshape((-1,3))\nvectorized = np.float32(vectorized)\ncriteria = (cv2.TERM_CRITERIA_EPS + cv2.TERM_CRITERIA_MAX_ITER, 10, 1.0)\nK = 2\nattempts=10\nret,label,center=cv2.kmeans(vectorized,K,None,criteria,attempts,cv2.KMEANS_PP_CENTERS)\ncenter = np.uint8(center)\nres = center[label.flatten()]\nresult_image = res.reshape((img.shape))\n\nfigure_size = 15\nplt.figure(figsize=(figure_size,figure_size))\nplt.subplot(1,2,1),plt.imshow(img)\nplt.title('Original Image'), plt.xticks([]), plt.yticks([])\nplt.subplot(1,2,2),plt.imshow(result_image)\nplt.title('Segmented Image when K = %i' % K), plt.xticks([]), plt.yticks([])\nplt.show()\n\n#great tutorial for kmeans segmentation\n#https:\/\/github.com\/Yuvrajchopra25\/Project-8-Image-Segmentation-using-Sklearn-and-K-Means\/blob\/master\/Image%20Segmentation%20using%20K-Means.ipynb","5f5a4141":"import matplotlib.pyplot as plt\nimport numpy as np\nfrom skimage import io\nfrom sklearn.cluster import KMeans\n\nim =  io.imread('..\/input\/image0\/ccc.jpg') # Reads an image into BGR Format\n\n#im = cv2.cvtColor(im,cv2.COLOR_BGR2RGB)\noriginal_shape = im.shape\nall_pixels  = im.reshape((-1,3))\ndominant_colors = 3\nkm = KMeans(n_clusters=dominant_colors)\nkm.fit(all_pixels)\ncenters = km.cluster_centers_\ncenters = np.array(centers,dtype='uint8')\ni = 1\n\nplt.figure(0,figsize=(8,2))\n\n# Storing info in color array\nprint(\"Segmented colors\")\ncolors = []\n\nfor each_col in centers:\n    plt.subplot(1,4,i)\n    plt.axis(\"off\")\n    i+=1\n    \n    colors.append(each_col)\n    \n    # Color Swatch\n    a = np.zeros((100,100,3),dtype='uint8')\n    a[:,:,:] = each_col\n    plt.imshow(a)\n    \nplt.show()\n\nnew_img = np.zeros((714*816,3),dtype='uint8')\n\n# Iterate over the image\nfor ix in range(new_img.shape[0]):\n    new_img[ix] = colors[km.labels_[ix]]\n    \nnew_img = new_img.reshape((original_shape))\n\n\nfigure_size = 15\nplt.figure(figsize=(figure_size,figure_size))\nplt.subplot(1,2,1),plt.imshow(img)\nplt.title('Original Image'), plt.xticks([]), plt.yticks([])\nplt.subplot(1,2,2),plt.imshow(new_img)\nplt.title('Segmented Image when K = %i' % dominant_colors), plt.xticks([]), plt.yticks([])\nplt.show()","e1188095":"Par sklearn"}}