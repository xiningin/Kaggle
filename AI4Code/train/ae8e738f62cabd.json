{"cell_type":{"80a6efd9":"code","e3b72731":"code","f10f8fd1":"code","28de15ec":"code","0fed2802":"code","9406db39":"code","b4e03b90":"code","1c3efec0":"code","e8547cfa":"code","e26ca65a":"code","83e30fb3":"code","6643dfca":"code","c087da18":"code","7b30f62c":"code","a0ac84b6":"code","2107cef9":"code","e92b0355":"code","5deb39b4":"code","33c78228":"code","431d08b6":"code","28c8afe8":"code","9387d9c9":"code","89fe7430":"code","60d609ee":"markdown"},"source":{"80a6efd9":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","e3b72731":"df=pd.read_csv('https:\/\/raw.githubusercontent.com\/krishnaik06\/K-Nearest-Neighour\/master\/Classified%20Data',index_col=0)","f10f8fd1":"df","28de15ec":"from sklearn.preprocessing import StandardScaler","0fed2802":"scaler=StandardScaler()","9406db39":"x=scaler.fit(df.drop('TARGET CLASS',axis=1))","b4e03b90":"scaled_features=scaler.transform(df.drop('TARGET CLASS',axis=1))","1c3efec0":"df_feat=pd.DataFrame(scaled_features,columns=df.columns[:-1])","e8547cfa":"df_feat.head()","e26ca65a":"import seaborn as sns\nsns.pairplot(df,hue='TARGET CLASS')","83e30fb3":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test=train_test_split(scaled_features, df['TARGET CLASS'],test_size=0.30)","6643dfca":"from sklearn.neighbors import KNeighborsClassifier","c087da18":"knn=KNeighborsClassifier(n_neighbors=1)","7b30f62c":"knn.fit(x_train,y_train)","a0ac84b6":"pred=knn.predict(x_test)","2107cef9":"from sklearn.metrics import classification_report,confusion_matrix\nfrom sklearn.model_selection import cross_val_score","e92b0355":"print(confusion_matrix(pred,y_test))","5deb39b4":"print(classification_report(pred,y_test))","33c78228":"accuracy_rate = []\nfor i in range(1,40):\n    knn=KNeighborsClassifier(n_neighbors=i)\n    scores=cross_val_score(knn,df_feat,df['TARGET CLASS'],cv=10)\n    accuracy_rate.append(scores.mean())\n    ","431d08b6":"error_rate = []\nfor i in range(1,40):\n    knn=KNeighborsClassifier(n_neighbors=i)\n    scores=cross_val_scores(knn,df_feat,df['TARGET CLASS'],cv=10)\n    error_rate.append(1-scores.mean())","28c8afe8":"plt.figure(figsize=(10,6))\nplt.plot(range(1,40),accuracy_rate,color='blue',linestyle='dashed',marker='o')\n","9387d9c9":"knn=KNeighborsClassifier(n_neighbors=32)\nknn.fit(x_train,y_train)\npred=knn.predict(x_test)\nprint(confusion_matrix(pred,y_test))","89fe7430":"print(classification_report(pred,y_test))","60d609ee":"# i use the knearest neighbors because it take less time here then the regreesion or decisson tree because the feature are overlaped above\n"}}