{"cell_type":{"d0d3dd27":"code","810d9de4":"code","e55b277f":"code","bb167e6c":"code","69329b9e":"code","13b1103b":"code","a7973387":"code","d0ad3959":"code","d8756f9c":"code","d246a2a0":"code","1f5cd13c":"code","4b1188f1":"code","f3acf9d5":"code","7388cd0d":"code","45bfefdd":"code","1d0877cc":"code","a1ae4e2b":"code","3ab57de1":"code","965fb32f":"code","178a1167":"code","0082f80e":"code","78fbde52":"code","18968b64":"code","00c6e549":"code","b44ab847":"code","184f5f0f":"code","9246dfec":"code","f698270b":"code","72583d38":"code","2e158092":"code","949f6f16":"code","6f64312a":"code","e5251729":"markdown","2048b04a":"markdown","532d7af6":"markdown","b52f5d31":"markdown","c9f3d3eb":"markdown","eee68403":"markdown","3aa41a66":"markdown","8464a516":"markdown","c4d1ada8":"markdown","ae45857c":"markdown","4629dbcf":"markdown","a4a701d4":"markdown","f5cc11b8":"markdown","544ef64f":"markdown"},"source":{"d0d3dd27":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","810d9de4":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sb","e55b277f":"#Importing data and displaying the first 10 samples\n\ndata = pd.read_csv(\"\/kaggle\/input\/openintro-possum\/possum.csv\")\ndata.head(10)","bb167e6c":"data.isna().sum()","69329b9e":"# Filling missingvalues with average\n\ndata = data.fillna(data.mean())","13b1103b":"data.isna().sum()","a7973387":"data.shape","d0ad3959":"data.min()\n","d8756f9c":"data.max()","d246a2a0":"data.dtypes","1f5cd13c":"#Getting range of all numeric columns\n\nnum_data = data.select_dtypes(include = np.number)\nnum_data.max() - num_data.min()","4b1188f1":"#First quartile\nnum_data.quantile(0.25)","f3acf9d5":"#Second Quartile \/ Median\nnum_data.quantile(0.5)","7388cd0d":"#Third Quartile\nnum_data.quantile(0.75)","45bfefdd":"# Interquartile range\nnum_data.quantile(0.75) - num_data.quantile(0.25)","1d0877cc":"# Getting the 60th percentile for each column\n\npd.Series(np.percentile(num_data, 60, axis = 0), index = num_data.columns)","a1ae4e2b":"#Scatterplot showing how total length of possums vary with their head lengths\nsb.scatterplot(data = data, x = \"hdlngth\", y = \"totlngth\")","3ab57de1":"mean = data.loc[data[\"hdlngth\"] < 100].mean()\ndata[\"hdlngth\"] = data[\"hdlngth\"].mask(data[\"hdlngth\"] > 100, mean)\n\nmean = data.loc[data[\"hdlngth\"] > 85].mean()\ndata[\"hdlngth\"] = data[\"hdlngth\"].mask(data[\"hdlngth\"] < 85, mean)\n\nsb.scatterplot(data = data, x = \"hdlngth\", y = \"totlngth\")","965fb32f":"sb.boxplot(x=\"site\", y=\"age\", data=data ,palette=\"Set3\"); \nplt.title(\"Boxplot showing the distribution of the age of possums from different sites.\");","178a1167":"sb.boxplot(x = \"age\", y = \"Pop\", data = data, palette = \"Set3\");\nplt.title(\"Boxplot showing the distribution of the age of possums from different Pops.\");","0082f80e":"sb.boxplot(x = \"age\", y = \"sex\", data = data, palette = \"Set3\");\nplt.title(\"Boxplot showing the distribution of the age of possums from different Pops.\");","78fbde52":"data['site'] = data['site'].apply(lambda x:str(x))\ndata.info() #change site into string","18968b64":"sb.histplot(data = data, x = \"hdlngth\", kde = True);\n\n# We can see that majority of possums have their head lengths in range 90-96","00c6e549":"sb.histplot(data = data, x = \"totlngth\", hue = \"Pop\", kde = True)\n# Hence, the median total length of Victorian possums is more.","b44ab847":"fig,ax = plt.subplots(figsize=(15,15))\nsb.heatmap(data.corr(),annot=True)\nplt.show()","184f5f0f":"# Lets separate our numerical and categorical columns\n\ncat_cols = ['site', 'Pop', 'sex']\nnum_cols = list(set(data.columns).difference(set(cat_cols)))\nnum_cols.pop()\nnum_cols","9246dfec":"data.dropna(axis=0,inplace=True)\ndata.info()","f698270b":"X = data\nX = X.drop('case', axis = 1)\nX = X.drop('age', axis = 1)\ny = data['age']\nX.columns","72583d38":"#One-Hot encoding to make use of the categorical data possible\nX = pd.get_dummies(X)\nX","2e158092":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, \n                                                    test_size=0.3, random_state=42)","949f6f16":"model = LinearRegression()\nmodel.fit(X_train, y_train)\npredictions = model.predict(X_test)","6f64312a":"print(f'RMSE:{np.sqrt(mean_squared_error(y_test, predictions))}')\nprint(f'Standard Deviation of Age:{data.age.std()}')","e5251729":"#### From the plot above, possums with head length outside the range (85,100) can be considered as outliers. Replacing outliers with mean values:","2048b04a":"# Correlation between numerical features and age\n\nTo get an idea about the correlation between numerical features and age, we'll be using a heatmap","532d7af6":"## Categorical Findings \n\n<ul>\n    <li>Median age of male possums is lesser than that of females.<\/li>\n    <li>Vic has much more variation in age.<\/li>\n","b52f5d31":"## Outlier Analysis\nPlotting graphs to identify outliers","c9f3d3eb":"## Null Values","eee68403":"# Linear Regression Model\n\nObjective: To create a model that predicts the age of a possum given a set of features.","3aa41a66":"## Quartiles and Percentile","8464a516":"Since the site feature contains categorical data, we need not find the correlation between site and age of the possums. Hence, below we will convert all entries in the site column to string datatype.","c4d1ada8":"### Importing Libraries","ae45857c":"# The Dataset and the Objective\n\nOur dataset is imported from its directory and the first five entries in the dataset are displayed to get an understanding of our dataset. Our objective will be to create a model that can predict the age of a possum, given a set of features describing it.","4629dbcf":"From the heat map, it is evident that the age of the possum has the highest correlation with the belly size while its has th lowest correlation with earconch (we ignore the \"case\" column as it is used as a primary key).\n\nMoreover, since none of the features have significantly low correlation with age, we cannot discard any of them.\n","a4a701d4":"# Handling missing data\n\nSince there is missing data in only three entries (rows), we can simply drop them as the effect on our predicitions will be really low.\n","f5cc11b8":"## Categorical Data\n\nIn our data, the features \"Pop\", \"site\" and \"sex\" represent categorical data. Since our model is going to predict the age of a possum, we will have a look at the distribution of age over different categories.","544ef64f":"# Numerical Data\n## Minimum, Maximum and Range"}}