{"cell_type":{"490a678d":"code","e5105085":"code","ca9e41b5":"code","270c7049":"code","90354b05":"code","6c653e95":"code","5feb5fad":"code","5c24a42a":"code","aa55227a":"code","9a73c35d":"code","c27eb0ab":"code","e7abd656":"code","537c74cc":"code","ec3a50fc":"code","dad0c8c4":"code","e7b59e46":"code","2c81af42":"code","6167df39":"code","438dc5bb":"code","13641ec4":"code","ee71749c":"code","d1d27fa5":"code","9a07da86":"code","d9c97da0":"code","e8eb7a04":"code","32d2bec2":"code","2ace7636":"code","396c08cc":"code","ead97141":"code","9305eb6e":"code","8a18c8e5":"code","5269e0e6":"code","662e78aa":"code","75c3f55a":"code","0330251f":"code","343bb3b0":"markdown","bb26f4d1":"markdown","15bf4a2b":"markdown","53055ec5":"markdown","9b44bde4":"markdown","623f6f30":"markdown"},"source":{"490a678d":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","e5105085":"import numpy as np\nimport pandas as pd \nimport tensorflow as tf\nfrom tensorflow import keras\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\n%matplotlib inline","ca9e41b5":"train = pd.read_csv('..\/input\/digit-recognizer\/train.csv')\ntrain.head()","270c7049":"test = pd.read_csv('..\/input\/digit-recognizer\/test.csv')\ntest.head()","90354b05":"train.shape\ntest.shape","6c653e95":"x = train.drop(['label'],axis=1)\nX = np.array(x).reshape(len(train),28*28) \/ 255\nX.shape","5feb5fad":"y = train['label']\ny.shape","5c24a42a":"x_test = np.array(test).reshape(len(test),28*28) \/ 255\nx_test.shape","aa55227a":"X_train, X_val, y_train, y_val = train_test_split(X,y,test_size=0.15,random_state=42)","9a73c35d":"X_train.shape, y_train.shape","c27eb0ab":"X_val.shape, y_val.shape","e7abd656":"plt.imshow(X[2].reshape(28,28))","537c74cc":"ann =keras.Sequential([\n     keras.layers.Dense(10, input_shape=(784,),activation='sigmoid')\n])\nann.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann.fit(X_train,y_train,epochs=25)","ec3a50fc":"ann.evaluate(X_val,y_val)","dad0c8c4":"y_predict = ann.predict(X_val)\ny_predict","e7b59e46":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[0]","2c81af42":"cn = tf.math.confusion_matrix(y_val,y_predicted_labels)\nplt.figure(figsize=(8,6))\nsns.heatmap(cn,annot=True,fmt='d')\nplt.xlabel('Predicted')\nplt.ylabel('Truth')","6167df39":"ann_hidden =keras.Sequential([\n    keras.layers.Dense(100, input_shape=(784,), activation='relu'),\n    keras.layers.Dense(10,activation='sigmoid')\n])\nann_hidden.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann_hidden.fit(X_train,y_train,epochs=25)","438dc5bb":"ann_hidden.evaluate(X_val,y_val)","13641ec4":"y_predict = ann_hidden.predict(X_val)\ny_predict","ee71749c":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[2]","d1d27fa5":"cn = tf.math.confusion_matrix(y_val,y_predicted_labels)\nplt.figure(figsize=(8,6))\nsns.heatmap(cn, annot=True, fmt='d')\nplt.xlabel('Predicted')\nplt.ylabel('Truth')","9a07da86":"ann_flat = keras.Sequential([\n           keras.layers.Flatten(input_shape=(28,28)),\n           keras.layers.Dense(100, activation='relu'),\n           keras.layers.Dense(10, activation='sigmoid')\n])\nann_flat.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann_flat.fit(X_train,y_train,epochs=25)","d9c97da0":"ann_flat.evaluate(X_val,y_val)","e8eb7a04":"y_predict = ann_hidden.predict(x_test)\ny_predict","32d2bec2":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[2]","2ace7636":"cnn = keras.Sequential([\n    keras.layers.Conv2D(30, (3,3), activation='relu', input_shape=(28, 28, 1)),\n    keras.layers.MaxPooling2D((2,2)),\n \n    keras.layers.Flatten(),\n    keras.layers.Dense(100, activation='relu'),\n    keras.layers.Dense(10, activation='sigmoid')\n])","396c08cc":"cnn.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])","ead97141":"X_train = X_train.reshape(-1,28,28,1)\nX_train.shape","9305eb6e":"x_test = x_test.reshape(-1,28,28,1)\nx_test.shape","8a18c8e5":"cnn.fit(X_train, y_train, epochs=25)","5269e0e6":"y_predict_final = cnn.predict(x_test)","662e78aa":"y_predicted_labels_final =[np.argmax(i) for i in y_predict_final]","75c3f55a":"image_id = range(1, y_predict_final.shape[0] + 1)\nsubmission_file = pd.DataFrame({'ImageId':image_id, 'Label':y_predicted_labels_final})\nsubmission_file.to_csv('digit_recognizer_submission_final_cnn_ann.csv',index=False)","0330251f":"submission_file.head()","343bb3b0":"# **Submit Prediction**","bb26f4d1":"# **Import Libary**","15bf4a2b":"# **Applying Ann Model**","53055ec5":"# **Analysis Data**","9b44bde4":"# **Pre-Process Data**","623f6f30":"# **Applying CNN Model**"}}