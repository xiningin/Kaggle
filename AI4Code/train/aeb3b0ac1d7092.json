{"cell_type":{"36a49945":"code","73cf4b38":"code","97f12e13":"code","53e64ca6":"code","719161f2":"code","6b0ad361":"code","f3a785ee":"code","714bef27":"code","ff915a76":"code","6b427733":"code","ae51d403":"code","491819b2":"code","997cc58a":"code","4deec724":"code","ee1b2479":"code","d43cc06e":"code","aa54851f":"code","1ac1a26c":"code","4b66aa0d":"code","f6ea067a":"code","d3bb0099":"code","634d1328":"code","1ee10901":"code","e2037c92":"code","519591ec":"code","b9f592d6":"code","e0e0397b":"code","f2f21596":"code","fee41ab8":"code","9858d533":"code","5e0e3fe6":"code","7299cfec":"code","15bc8ade":"code","061f2069":"code","0e6df400":"code","21cd24bf":"code","7dc113ab":"code","f9e1cab2":"code","e88071d8":"code","1008860f":"code","6d6bb6c0":"markdown","57d3f657":"markdown","a87c9427":"markdown","18824539":"markdown","78846252":"markdown","3516bc55":"markdown","3ea62be9":"markdown","39b4f43b":"markdown","38b823bc":"markdown","3991640d":"markdown","1cb205a4":"markdown","219e79e7":"markdown","a5adce1e":"markdown","7434cf5a":"markdown","014d7726":"markdown","ed4c5468":"markdown","9863a47f":"markdown","9917d623":"markdown","c2069e35":"markdown","4466a67f":"markdown","dc8b6df9":"markdown","265ada0f":"markdown","dfc5351c":"markdown","8836447d":"markdown","b3c7145d":"markdown","d3f49f80":"markdown","6e69e346":"markdown","64458db5":"markdown","879034d2":"markdown","8a686546":"markdown","9a65bc77":"markdown"},"source":{"36a49945":"import os\nimport math\nimport random\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport cv2\nimport albumentations as A","73cf4b38":"def set_seed(seed):\n    random.seed(seed)\n    os.environ[\"PYTHONHASHSEED\"] = str(seed)\n    np.random.seed(seed)\n    \n    \nSEED = 42\nset_seed(SEED)","97f12e13":"BASE_PATH = \"..\/input\/gan-getting-started\/\"\nMONET_PATH = os.path.join(BASE_PATH, \"monet_jpg\")\nPHOTO_PATH = os.path.join(BASE_PATH, \"photo_jpg\")","53e64ca6":"def print_folder_statistics(path):\n    d_image_sizes = {}\n    for image_name in os.listdir(path):\n        image = cv2.imread(os.path.join(path, image_name))\n        d_image_sizes[image.shape] = d_image_sizes.get(image.shape, 0) + 1\n        \n    for size, count in d_image_sizes.items():\n        print(f\"shape: {size}\\tcount: {count}\")\n\n\nprint(f\"Monet images:\")\nprint_folder_statistics(MONET_PATH)\nprint(\"-\" * 10)\nprint(f\"Photo images:\")\nprint_folder_statistics(PHOTO_PATH)\nprint(\"-\" * 10)","719161f2":"def batch_visualization(path, n_images, is_random=True, figsize=(16, 16)):\n    plt.figure(figsize=figsize)\n    \n    w = int(n_images ** .5)\n    h = math.ceil(n_images \/ w)\n    \n    all_names = os.listdir(path)\n    \n    image_names = all_names[:n_images]\n    if is_random:\n        image_names = random.sample(all_names, n_images)\n    \n    for ind, image_name in enumerate(image_names):\n        img = cv2.imread(os.path.join(path, image_name))\n        img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) \n        plt.subplot(h, w, ind + 1)\n        plt.imshow(img)\n        plt.axis(\"off\")\n    \n    plt.show()","6b0ad361":"batch_visualization(MONET_PATH, 1, is_random=True, figsize=(5, 5))","f3a785ee":"batch_visualization(MONET_PATH, 4, is_random=True, figsize=(10, 10))","714bef27":"batch_visualization(MONET_PATH, 9, is_random=True)","ff915a76":"batch_visualization(MONET_PATH, 16, is_random=True)","6b427733":"batch_visualization(MONET_PATH, 300, is_random=False)","ae51d403":"batch_visualization(PHOTO_PATH, 16, is_random=True)","491819b2":"def color_hist_visualization(image_path, figsize=(16, 4)):\n    plt.figure(figsize=figsize)\n    \n    img = cv2.imread(image_path)\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) \n    plt.subplot(1, 4, 1)\n    plt.imshow(img)\n    plt.axis(\"off\")\n    \n    colors = [\"red\", \"green\", \"blue\"]\n    for i in range(len(colors)):\n        plt.subplot(1, 4, i + 2)\n        plt.hist(\n            img[:, :, i].reshape(-1),\n            bins=25,\n            alpha=0.5,\n            color=colors[i],\n            density=True\n        )\n        plt.xlim(0, 255)\n        plt.xticks([])\n        plt.yticks([])\n    \n    \n    plt.show()","997cc58a":"img_path = '..\/input\/gan-getting-started\/monet_jpg\/000c1e3bff.jpg'\ncolor_hist_visualization(img_path)\n\nimg_path = '..\/input\/gan-getting-started\/monet_jpg\/05144e306f.jpg'\ncolor_hist_visualization(img_path)\n\nimg_path = '..\/input\/gan-getting-started\/monet_jpg\/16dabe418c.jpg'\ncolor_hist_visualization(img_path)","4deec724":"def channels_visualization(image_path, figsize=(16, 4)):\n    plt.figure(figsize=figsize)\n    \n    img = cv2.imread(image_path)\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) \n    plt.subplot(1, 4, 1)\n    plt.imshow(np.mean(img, axis=2), cmap=\"gray\")\n    plt.axis('off')\n    \n    for i in range(3):\n        plt.subplot(1, 4, i + 2)\n        tmp_img = np.full_like(img, 0)\n        tmp_img[:, :, i] = img[:, :, i]\n        plt.imshow(tmp_img)\n        plt.xlim(0, 255)\n        plt.xticks([])\n        plt.yticks([])\n    \n    \n    plt.show()","ee1b2479":"img_path = '..\/input\/gan-getting-started\/monet_jpg\/51db3fc011.jpg'\ncolor_hist_visualization(img_path)\nchannels_visualization(img_path)\n\nimg_path = '..\/input\/gan-getting-started\/monet_jpg\/1814cc6632.jpg'\ncolor_hist_visualization(img_path)\nchannels_visualization(img_path)\n\nimg_path = '..\/input\/gan-getting-started\/monet_jpg\/4995c04b1a.jpg'\ncolor_hist_visualization(img_path)\nchannels_visualization(img_path)","d43cc06e":"def grayscale_visualization(image_path, figsize=(8, 4)):\n    plt.figure(figsize=figsize)\n    \n    img = cv2.imread(image_path)\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) \n    plt.subplot(1, 2, 1)\n    plt.imshow(img)\n    plt.axis('off')\n    \n    plt.subplot(1, 2, 2)\n    tmp_img = np.full_like(img, 0)\n    for i in range(3):\n        tmp_img[:, :, i] = img.mean(axis=-1)\n    plt.imshow(tmp_img)\n    plt.axis('off')\n    \n    \n    plt.show()","aa54851f":"img_path = '..\/input\/gan-getting-started\/monet_jpg\/5c79cfe0b3.jpg'\ngrayscale_visualization(img_path)\n\nimg_path = '..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg'\ngrayscale_visualization(img_path)\n\nimg_path = '..\/input\/gan-getting-started\/monet_jpg\/fd63a333f1.jpg'\ngrayscale_visualization(img_path)","1ac1a26c":"def plot_simple_augmentation(image_path, transform):\n    img = cv2.imread(image_path)\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) \n    \n    plt.figure(figsize=(10, 5))\n    \n    plt.subplot(1, 2, 1)\n    plt.imshow(img)\n    plt.axis(\"off\")\n    \n    plt.subplot(1, 2, 2)\n    x = transform(image=img)[\"image\"]\n    plt.imshow(x)\n    plt.axis(\"off\")\n\n    plt.show()\n    \ndef plot_multiple_augmentation(image_path, transform):\n    img = cv2.imread(image_path)\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) \n    \n    plt.figure(figsize=(10, 10))\n    \n    plt.subplot(2, 2, 1)\n    plt.imshow(img)\n    plt.axis(\"off\")\n    \n    plt.subplot(2, 2, 2)\n    x = transform(image=img)[\"image\"]\n    plt.imshow(x)\n    plt.axis(\"off\")\n    \n    plt.subplot(2, 2, 3)\n    x = transform(image=img)[\"image\"]\n    plt.imshow(x)\n    plt.axis(\"off\")\n    \n    plt.subplot(2, 2, 4)\n    x = transform(image=img)[\"image\"]\n    plt.imshow(x)\n    plt.axis(\"off\")\n\n    plt.show()","4b66aa0d":"transform = A.Compose(\n    [\n        A.Blur(p=1.0, blur_limit=(5, 5)),\n    ]\n)\n\nplot_simple_augmentation(\"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\", transform)","f6ea067a":"transform = A.CLAHE(p=1.0, clip_limit=(10, 10), tile_grid_size=(3, 3))\n\nplot_simple_augmentation(\"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\", transform)","d3bb0099":"transform = A.CenterCrop(p=1.0, height=100, width=150)\n\nplot_simple_augmentation(\"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\", transform)","634d1328":"transform = A.ChannelDropout(p=1.0, channel_drop_range=(1, 2), fill_value=0)\n\nplot_multiple_augmentation(\"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\", transform)","1ee10901":"transform = A.ChannelShuffle(p=1.0)\n\nplot_multiple_augmentation(\"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\", transform)","e2037c92":"transform = A.Crop(p=1.0, x_min=0, y_min=0, x_max=150, y_max=150)\n\nplot_simple_augmentation(\"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\", transform)","519591ec":"transform = A.RandomCrop(p=1.0, height=100, width=100)\n\nplot_multiple_augmentation(\"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\", transform)","b9f592d6":"transform = A.Cutout(p=1.0, num_holes=8, max_h_size=15, max_w_size=15)\n\nplot_multiple_augmentation(\"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\", transform)","e0e0397b":"transform = A.Downscale(\n    p=1.0, scale_min=0.01, scale_max=0.20, interpolation=0,\n)\n\nplot_multiple_augmentation(\n    \"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\",\n    transform,\n)","f2f21596":"transform = A.Equalize(\n    p=1.0, mode='cv', by_channels=True,\n)\n\nplot_simple_augmentation(\n    \"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\",\n    transform,\n)","fee41ab8":"transform = A.HorizontalFlip(\n    p=1.0,\n)\n\nplot_simple_augmentation(\n    \"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\",\n    transform,\n)","9858d533":"transform = A.VerticalFlip(\n    p=1.0,\n)\n\nplot_simple_augmentation(\n    \"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\",\n    transform,\n)","5e0e3fe6":"transform = A.Flip(\n    p=1.0,\n)\n\nplot_multiple_augmentation(\n    \"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\",\n    transform,\n)","7299cfec":"transform = A.GaussNoise(\n    p=1.0, var_limit=(500.0, 500.0),\n)\n\nplot_simple_augmentation(\n    \"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\",\n    transform,\n)","15bc8ade":"transform = A.GridDistortion(\n    p=1.0, num_steps=15, distort_limit=(-2., 2.), \n    interpolation=0, border_mode=0, value=(0, 0, 0), mask_value=None,\n)\n\nplot_multiple_augmentation(\n    \"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\",\n    transform,\n)","061f2069":"transform = A.HueSaturationValue(\n    p=1.0, \n    hue_shift_limit=(-100, 100), \n    sat_shift_limit=(-100, 100), \n    val_shift_limit=(-100, 100),\n)\n\nplot_multiple_augmentation(\n    \"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\",\n    transform,\n)","0e6df400":"transform = A.ISONoise(\n    p=1.0, intensity=(0.0, 2.0), color_shift=(0.0, 1.0)\n)\n\nplot_multiple_augmentation(\n    \"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\",\n    transform,\n)","21cd24bf":"transform = A.ImageCompression(\n    p=1.0, quality_lower=0, quality_upper=10, compression_type=0,\n)\n\nplot_multiple_augmentation(\n    \"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\",\n    transform,\n)","7dc113ab":"transform = A.InvertImg(\n    p=1.0,\n)\n\nplot_simple_augmentation(\n    \"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\",\n    transform,\n)","f9e1cab2":"transform = A.JpegCompression(\n    p=1.0, quality_lower=0, quality_upper=10,\n)\n\nplot_multiple_augmentation(\n    \"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\",\n    transform,\n)","e88071d8":"transform = A.MotionBlur(\n    p=1.0, blur_limit=(3, 50),\n)\n\nplot_multiple_augmentation(\n    \"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\",\n    transform,\n)\n","1008860f":"transform = A.MultiplicativeNoise(\n    p=1.0, multiplier=(0.1, 5.0), per_channel=True, elementwise=False,\n)\n\nplot_multiple_augmentation(\n    \"..\/input\/gan-getting-started\/monet_jpg\/990ed28f62.jpg\",\n    transform,\n)\n","6d6bb6c0":"<a id=\"1\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Data Preparations<center><h2>","57d3f657":"![](https:\/\/storage.googleapis.com\/kaggle-competitions\/kaggle\/21755\/logos\/header.png)","a87c9427":"<a id=\"116\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - ISONoise<center><h2>","18824539":"<a id=\"121\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - MultiplicativeNoise<center><h2>","78846252":"<a id=\"104\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - ChannelShuffle<center><h2>","3516bc55":"<a id=\"top\"><\/a>\n\n<div class=\"list-group\" id=\"list-tab\" role=\"tablist\">\n<h3 class=\"list-group-item list-group-item-action active\" data-toggle=\"list\" style='background:purple; border:0' role=\"tab\" aria-controls=\"home\"><center>Quick Navigation<\/center><\/h3>\n\n* [1. Data Preparations](#1)\n* [2. Show Batches - Monet Paintings](#2)\n* [3. Show Batches - Photos](#3)\n* [4. Color Channel Histograms](#4)\n* [5. Individual Channels Visualization](#5)\n* [6. Grayscale Visualization](#6)\n    \n\n* [Augmentation - Blur](#100)\n* [Augmentation - CLAHE](#101)\n* [Augmentation - CenterCrop](#102)\n* [Augmentation - ChannelDropout](#103)\n* [Augmentation - ChannelShuffle](#104)\n* [Augmentation - Crop](#105)\n* [Augmentation - RandomCrop](#106)\n* [Augmentation - CutOut](#107)\n* [Augmentation - Downscale](#108)\n* [Augmentation - Equalize](#109)\n* [Augmentation - HorizontalFlip](#110)\n* [Augmentation - VerticalFlip](#111)\n* [Augmentation - Flip](#112)\n* [Augmentation - GaussNoise](#113)\n* [Augmentation - GridDistortion](#114)    \n* [Augmentation - HueSaturationValue](#115) \n* [Augmentation - ISONoise](#116)\n* [Augmentation - ImageCompression](#117)\n* [Augmentation - InvertImg](#118)\n* [Augmentation - JpegCompression](#119)\n* [Augmentation - MotionBlur](#120)\n* [Augmentation - MultiplicativeNoise](#121)","3ea62be9":"<a id=\"108\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - Downscale<center><h2>","39b4f43b":"<a id=\"102\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - CenterCrop<center><h2>","38b823bc":"<a id=\"106\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - RandomCrop<center><h2>","3991640d":"<a id=\"119\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - JpegCompression<center><h2>\n\n","1cb205a4":"<a id=\"107\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - CutOut<center><h2>","219e79e7":"<a id=\"6\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Grayscale Visualization<center><h2>\n","a5adce1e":"<a id=\"103\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - ChannelDropout<center><h2>","7434cf5a":"<a id=\"101\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - CLAHE<center><h2>","014d7726":"# I\u2019m Something of a Painter Myself - Visualization and Augmentation\n\nThis notebook demonstrates different approaches to exploratory data analysis for the image data.   \nIn this solution, you will also see how you can visualize images using matplotlib and what graphs you can build for these images","ed4c5468":"<a id=\"114\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - GridDistortion<center><h2>","9863a47f":"<a id=\"110\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - HorizontalFlip<center><h2>","9917d623":"<a id=\"109\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - Equalize<center><h2>","c2069e35":"<a id=\"113\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - GaussNoise<center><h2>","4466a67f":"<a id=\"117\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - ImageCompression<center><h2>\n","dc8b6df9":"<a id=\"115\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - HueSaturationValue<center><h2>","265ada0f":"<a id=\"3\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Show Batches - Photos<center><h2>","dfc5351c":"<a id=\"4\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Color Channel Histograms<center><h2>\n","8836447d":"<a id=\"118\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - InvertImg<center><h2>\n","b3c7145d":"<a id=\"112\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - Flip<center><h2>","d3f49f80":"<a id=\"111\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - VerticalFlip<center><h2>","6e69e346":"<a id=\"100\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - Blur<center><h2>","64458db5":"<a id=\"105\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - Crop<center><h2>","879034d2":"<a id=\"5\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Individual Channels Visualization<center><h2>\n","8a686546":"<a id=\"120\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Augmentation - MotionBlur<center><h2>","9a65bc77":"<a id=\"2\"><\/a>\n<h2 style='background:purple; border:0; color:white'><center>Show Batches - Monet Paintings<center><h2>"}}