{"cell_type":{"0c54e387":"code","78b43abd":"code","7ceb459a":"code","ba833e0f":"code","b84b0d9e":"code","b499e4c0":"code","024b1d2a":"code","21636b6d":"code","9a03349f":"code","f8e18698":"code","f02a7db7":"code","8992c014":"code","147d9ef6":"code","8255fbfe":"code","89ea0775":"code","b0ac5c0d":"code","2f3b6c1b":"code","a806ea82":"code","6a94f1f5":"code","f23f31ac":"code","6178a68b":"code","656853e3":"code","5696e0c2":"code","b29d89e2":"code","718850fb":"code","80809d95":"code","35a68621":"code","2a01b64b":"code","597b2d39":"code","122d0c4b":"code","190de63b":"code","a17893b9":"code","bf48d87a":"code","311b3203":"code","242958cf":"code","6be7afd9":"code","b93e5d75":"code","db124150":"code","ae1ac922":"code","e0badaec":"code","f593ac65":"code","0f40cc1b":"code","243d7ee3":"code","d9adb95a":"code","dce18adb":"code","834cb697":"code","3f39a39c":"code","cf25fd85":"code","57f49054":"code","8442fc17":"code","0e7679ec":"code","b16ba242":"code","84656dd9":"code","1ec50809":"code","323f296e":"code","c5bba927":"code","f582383a":"code","8b82e087":"code","8ebea1ba":"code","99e35c58":"code","16f4a640":"code","b7d0bbb0":"code","578b3235":"code","014fd756":"code","6b5ab22f":"code","0f47758e":"code","94ef3745":"code","288bf953":"code","9f46550a":"code","624977d2":"code","7a0606fd":"markdown","19fe0f2f":"markdown","7d4380ee":"markdown","10267d1b":"markdown","c8edee72":"markdown","19211d36":"markdown","56247da3":"markdown","79a46fd2":"markdown","95879895":"markdown","dfec0ada":"markdown","cc51caf4":"markdown"},"source":{"0c54e387":"from __future__ import print_function\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","78b43abd":"data=pd.read_csv(\"..\/input\/ml-lab-exam\/traindata_SJC.csv\")","7ceb459a":"data.head()","ba833e0f":"data.shape","b84b0d9e":"data.info()","b499e4c0":"data.columns","024b1d2a":"data.isnull().sum()","21636b6d":"data['MaritalStatus'].value_counts()","9a03349f":"data['MaritalStatus']=data['MaritalStatus'].fillna(\"others\")   ","f8e18698":"data['MaritalStatus'].value_counts()","f02a7db7":"data=data.fillna(data.mode())\ndata.isnull().sum()","8992c014":"data.info()","147d9ef6":"data['WeeklyWages']=np.log1p(data['WeeklyWages'])","8255fbfe":"data['HoursWorkedPerWeek']=np.log1p(data['HoursWorkedPerWeek'])","89ea0775":"data=data[data.UltimateIncurredClaimCost<np.quantile(data['UltimateIncurredClaimCost'],0.80)]","b0ac5c0d":"data.plot.box(figsize=(16,8))\nplt.xticks(rotation=90)","2f3b6c1b":"sns.boxplot(data=data,x='Age')","a806ea82":"sns.boxplot(data=data,x='DependentChildren')","6a94f1f5":"sns.boxplot(data=data,x='DependentsOther')","f23f31ac":"sns.boxplot(data=data,x='WeeklyWages')","6178a68b":"sns.boxplot(data=data,x='HoursWorkedPerWeek')","656853e3":"sns.boxplot(data=data,x='DaysWorkedPerWeek')","5696e0c2":"sns.boxplot(data=data,x='InitialIncurredCalimsCost')","b29d89e2":"sns.countplot(data['DependentChildren'])\nplt.title(\"DependentChildren\")\nplt.show() ","718850fb":"sns.countplot(data['Age'])\nplt.title(\"Age\")\nplt.show()","80809d95":"sns.countplot(data['MaritalStatus'])\nplt.title(\"MaritalStatus\")\nplt.show()","35a68621":"sns.countplot(data['Gender'])\nplt.title(\"Gender\")\nplt.show()","2a01b64b":"sns.countplot(data['PartTimeFullTime'])\nplt.title(\"PartTimeFullTime\")\nplt.show()","597b2d39":"plt.figure(figsize=(15,5))\nsns.countplot(data['DaysWorkedPerWeek'])                      \nplt.title(\"DaysWorkedPerWeek\")\nplt.show()","122d0c4b":"sns.pairplot(data[['DependentChildren', 'DependentsOther', 'WeeklyWages',\n    'HoursWorkedPerWeek', 'DaysWorkedPerWeek',\n        'InitialIncurredCalimsCost']])","190de63b":"sns.boxplot(x=data[\"UltimateIncurredClaimCost\"],y=data[\"Age\"])","a17893b9":"sns.boxplot(x=data[\"UltimateIncurredClaimCost\"],y=data[\"Gender\"])","bf48d87a":"import sklearn.preprocessing as pre\nimport sklearn.model_selection as ms","311b3203":"le=pre.LabelEncoder()","242958cf":"data.select_dtypes(include='object').columns.tolist()","6be7afd9":"le=pre.LabelEncoder()","b93e5d75":"list_df=['ClaimNumber','DateTimeOfAccident','DateReported','Age','WeeklyWages','Gender','MaritalStatus','PartTimeFullTime','HoursWorkedPerWeek',\n        'ClaimDescription']","db124150":"for x in list_df:\n  data[x]=le.fit_transform(data[x].astype(str))","ae1ac922":"data.info()","e0badaec":"columns = ['Age', 'Gender','MaritalStatus','DependentChildren', 'DependentsOther', 'WeeklyWages',\n       'PartTimeFullTime', 'HoursWorkedPerWeek', 'DaysWorkedPerWeek',\n       'ClaimDescription', 'InitialIncurredCalimsCost']\nX = data[columns]\ny = data['UltimateIncurredClaimCost']","f593ac65":"from sklearn.metrics import mean_squared_error","0f40cc1b":"from sklearn.model_selection import train_test_split","243d7ee3":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 1\/3, random_state = 400)","d9adb95a":"X_train.shape,X_test.shape,y_train.shape,y_test.shape","dce18adb":"import sklearn.linear_model as lm","834cb697":"glm=lm.LinearRegression()","3f39a39c":"glm.fit(X_train,y_train)","cf25fd85":"glm.score(X_test,y_test)","57f49054":"glm.score(X_train,y_train)","8442fc17":"y_pred = glm.predict(X_test)","0e7679ec":"y_pred","b16ba242":"data_test=pd.read_csv(\"..\/input\/ml-lab-exam\/testdata_SJC.csv\")","84656dd9":"data_test.head()","1ec50809":"data_test.shape","323f296e":"data_test.info()","c5bba927":"data_test.isnull().sum()","f582383a":"data_test['MaritalStatus'].value_counts()","8b82e087":"data_test['MaritalStatus']=data['MaritalStatus'].fillna(\"others\")  ","8ebea1ba":"data_test=data_test.fillna(data.mean())\ndata_test.isnull().sum()","99e35c58":"import sklearn.preprocessing as pre\nimport sklearn.model_selection as ms","16f4a640":"le=pre.LabelEncoder()","b7d0bbb0":"data_test.select_dtypes(include='object').columns.tolist()","578b3235":"le=pre.LabelEncoder()","014fd756":"list_df1=['ClaimNumber','DateTimeOfAccident','DateReported','Age','WeeklyWages','Gender','MaritalStatus','PartTimeFullTime','HoursWorkedPerWeek',\n        'ClaimDescription']","6b5ab22f":"for x in list_df1:\n  data_test[x]=le.fit_transform(data_test[x].astype(str))","0f47758e":"data_test.info()","94ef3745":"columns = ['Age', 'Gender','MaritalStatus','DependentChildren', 'DependentsOther', 'WeeklyWages',\n       'PartTimeFullTime', 'HoursWorkedPerWeek', 'DaysWorkedPerWeek',\n       'ClaimDescription', 'InitialIncurredCalimsCost']\nXtest = data_test[columns]","288bf953":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 1\/3, random_state = 400)","9f46550a":"glm.predict(Xtest)","624977d2":"sub=pd.read_csv('..\/input\/ml-lab-exam\/sample_submission_csv.csv')\nsub['UltimateIncurredClaimCost'] = glm.predict(Xtest)\nsub.to_csv('submission_linear661.csv', index = False)\nsub.head(5)\nprint(np.mean(sub['UltimateIncurredClaimCost']))","7a0606fd":"**Null Value Treatment**","19fe0f2f":"# Linear Regression","7d4380ee":"# Test Data","10267d1b":"# Misiing Value Imputation","c8edee72":"# EDA","19211d36":"# Outlier Analysis","56247da3":"# Workers Compensation claims","79a46fd2":"# Label Encoding","95879895":"**Loading the Data**","dfec0ada":"# Loading the Dataset","cc51caf4":"# Importing the libraries"}}