{"cell_type":{"842cc859":"code","04176570":"code","63e1fdeb":"code","0baab0c7":"code","1c57c38c":"markdown","d2def2d3":"markdown","8879d5c6":"markdown","8856c716":"markdown"},"source":{"842cc859":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom sklearn.metrics import cohen_kappa_score, accuracy_score\nimport random\nrandom.seed(42)\nnp.random.seed(42)\n","04176570":"gt = np.random.choice([0,1,2,3], 1000, p=(0.24, 0.14, 0.12, 0.50))\npred = gt.copy()\nnoise = np.random.choice([-2, -1, 0, 1, 2], 1000, p=(0.1, 0.2, 0.4, 0.2, 0.1))\npred_noisy = pred + noise\npred_noisy[pred_noisy > 3]  -=3\npred_noisy[pred_noisy < 0] += 3","63e1fdeb":"cohen_kappa_score(gt, pred_noisy, weights='quadratic'), accuracy_score(gt, pred_noisy)","0baab0c7":"for i in range(10):\n    errs = np.where(pred_noisy != gt)[0]\n    pred_noisy[errs[:10]] = gt[errs[:10]]\n    print(\"kappa: {}, acc: {}\".format(cohen_kappa_score(gt, pred_noisy, weights='quadratic'), accuracy_score(gt, pred_noisy)))\n    ","1c57c38c":"correct 10 errors at each step and see how result improves","d2def2d3":"Prepare ground truth and a bad submission","8879d5c6":"How much more correct predictions do you need to get to improve on public LB in DS Bowl 2019?\nLets see!","8856c716":"initial score:"}}