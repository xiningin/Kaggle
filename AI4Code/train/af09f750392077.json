{"cell_type":{"f9469b5a":"code","c0dc6bd1":"code","2f1e1373":"code","0dee0373":"code","9002777a":"code","9fdd47f6":"code","f9fad110":"code","8171dc73":"code","377c572d":"code","511edb87":"code","7fd8696c":"code","915dbe3f":"code","553f8ed1":"code","ce91250e":"code","d632a9bb":"code","cddbe4c3":"code","2ae88ff9":"code","13736474":"code","b8fe2dc9":"code","5f7deefc":"code","663f4028":"code","eabc20ef":"code","07f28a82":"code","22d5c81a":"code","08ab9576":"code","eca84dda":"code","e75d48f1":"code","8fd2fe70":"code","1af504bf":"code","8c51e91f":"code","7e8708ac":"code","186b8b7d":"code","41975cef":"code","ce214c29":"code","3d21a4c1":"code","9eda2426":"code","805f0e3d":"code","a875dce0":"code","692dc88d":"code","b1b797a8":"code","2aa365da":"code","5053f903":"code","f4e06254":"code","f5aea2ce":"code","ad5df2fe":"code","329844ce":"code","3b258446":"code","cecb4c8e":"markdown","18229474":"markdown","f5484856":"markdown","3e7c3b37":"markdown","ab4b5397":"markdown","24b7bd37":"markdown","73644bb9":"markdown","67322d3b":"markdown","3a07acdd":"markdown","0422a243":"markdown","78ce99b7":"markdown","c489cb70":"markdown","13874902":"markdown","21512862":"markdown","39ebedb5":"markdown","923bfb1b":"markdown","d5b08ed0":"markdown"},"source":{"f9469b5a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","c0dc6bd1":"import matplotlib.pyplot as plt\nimport seaborn as sb\npd.set_option(\"display.max_columns\",None)","2f1e1373":"df=pd.read_csv(\"\/kaggle\/input\/drug-addiction-in-bangladesh-reasons-smote\/DrugAddictioninBangladesh_Smoted.csv\")\ndf.head()","0dee0373":"df.tail()","9002777a":"df.shape","9fdd47f6":"df.info()","f9fad110":"col=df.columns\nfor i in col:\n    df[i]=(df[i].values).astype(int)","8171dc73":"for i in col:\n    print(i,df[i].unique())","377c572d":"\ndf.groupby(df[\"Class\"]).size()","511edb87":"df.describe()","7fd8696c":"df.isnull().sum()","915dbe3f":"def lowerupper(col):\n    q1=np.quantile(col,.25)\n    q3=np.quantile(col,.75)\n    inter=q3-q1\n    lowerbound=q1-(inter*1.5)\n    upperbound=q3+(inter*1.5)\n    outlier=[]\n    for x in col:\n        if((x>upperbound)or(x<lowerbound)):\n            outlier.append(x)\n    return outlier\n            ","553f8ed1":"col=df.columns\nprint(col)","ce91250e":"for i in col:\n    outlier=lowerupper(df[i].values)\n    print(len(outlier),\"outliers are present in\",i)","d632a9bb":"\"\"\"\ndef lowerupper(col):\n    q1=np.quantile(col,.25)\n    q3=np.quantile(col,.75)\n    inter=q3-q1\n    lowerbound=q1-(inter*1.5)\n    upperbound=q3+(inter*1.5)\n    return lowerbound,upperbound\n\"\"\"            ","cddbe4c3":"\"\"\"\nlb,ub=lowerupper(df[\"Age\"])\ndf[\"Age\"]=np.where(df[\"Age\"]<lb,lb,df[\"Age\"])\ndf[\"Age\"]=np.where(df[\"Age\"]>ub,ub,df[\"Age\"])\n\n#lb,ub=lowerupper(df[\"Gender\"])\n#df[\"Gender\"]=np.where(df[\"Gender\"]<lb,lb,df[\"Gender\"])\n#df[\"Gender\"]=np.where(df[\"Gender\"]>ub,ub,df[\"Gender\"])\n\nlb,ub=lowerupper(df[\"Education\"])\ndf[\"Education\"]=np.where(df[\"Education\"]<lb,lb,df[\"Education\"])\ndf[\"Education\"]=np.where(df[\"Education\"]>ub,ub,df[\"Education\"])\n\nlb,ub=lowerupper(df[\"Spend most time\"])\ndf[\"Spend most time\"]=np.where(df[\"Spend most time\"]<lb,lb,df[\"Spend most time\"])\ndf[\"Spend most time\"]=np.where(df[\"Spend most time\"]>ub,ub,df[\"Spend most time\"])\n\nlb,ub=lowerupper(df[\"Addicted person in family\"])\ndf[\"Addicted person in family\"]=np.where(df[\"Addicted person in family\"]<lb,lb,df[\"Addicted person in family\"])\ndf[\"Addicted person in family\"]=np.where(df[\"Addicted person in family\"]>ub,ub,df[\"Addicted person in family\"])\n\nlb,ub=lowerupper(df[\"Case in court\"])\ndf[\"Case in court\"]=np.where(df[\"Case in court\"]<lb,lb,df[\"Case in court\"])\ndf[\"Case in court\"]=np.where(df[\"Case in court\"]>ub,ub,df[\"Case in court\"])\n\"\"\"","2ae88ff9":"\"\"\"\nplt.subplot(1,3,1)\nplt.subplots_adjust(left=0,right=2,bottom=1,top=2,wspace=0.2,hspace=0.4)\nplt.title(\"Age\")\nplt.boxplot(df[\"Age\"])\n\nplt.subplot(1,3,2)\nplt.title(\"Education\")\nplt.boxplot(df[\"Education\"])\n\nplt.subplot(1,3,3)\nplt.title(\"Spend most time\")\nplt.boxplot(df[\"Spend most time\"])\n\"\"\"","13736474":"\"\"\"\nplt.subplot(1,2,1)\nplt.subplots_adjust(left=0,right=2,bottom=1,top=2,wspace=0.2,hspace=0.4)\nplt.title(\"Addicted person in family\")\nplt.boxplot(df[\"Addicted person in family\"])\n\nplt.subplot(1,2,2)\nplt.title(\"Case in court\")\nplt.boxplot(df[\"Case in court\"])\n\"\"\"","b8fe2dc9":"plt.subplot(1,4,1)\nplt.subplots_adjust(left=0,right=2,bottom=1,top=2,wspace=0.2,hspace=0.4)\nlabel_age=[2,1 ,3 ,4]\nplt.title(\"Age\")\nplt.pie(df.groupby(df[\"Age\"]).size(),labels=label_age)\n\nplt.subplot(1,4,2)\nlabel_gen=[1 ,2]\nplt.title(\"Gender\")\nplt.pie(df.groupby(df[\"Gender\"]).size(),labels=label_gen)\n\nplt.subplot(1,4,3)\nlabel_ed=[4 ,3 ,5 ,1 ,2]\nplt.title(\"Education\")\nplt.pie(df.groupby(df[\"Education\"]).size(),labels=label_ed)\n\nplt.subplot(1,4,4)\nlabel_lw=[2 ,1]\nplt.title(\"Live with\")\nplt.pie(df.groupby(df[\"Live with\"]).size(),labels=label_lw)\n","5f7deefc":"plt.subplot(1,4,1)\nplt.subplots_adjust(left=0,right=2,bottom=1,top=2,wspace=0.2,hspace=0.4)\nlabel_md=[1, 3, 2]\nplt.title(\"Motive about drug\")\nplt.pie(df.groupby(df[\"Motive about drug\"]).size(),labels=label_md)\n\nplt.subplot(1,4,2)\nlabel_st=[3, 2, 1]\nplt.title(\"Spend most time\")\nplt.pie(df.groupby(df[\"Spend most time\"]).size(),labels=label_st)\n\nplt.subplot(1,4,3)\nlabel_fl=[1 ,2]\nplt.title(\"Failure in life\")\nplt.pie(df.groupby(df[\"Failure in life\"]).size(),labels=label_fl)\n\nplt.subplot(1,4,4)\nlabel_mp=[1, 2, 3, 5, 4]\nplt.title(\"Mental\/emotional problem\")\nplt.pie(df.groupby(df[\"Mental\/emotional problem\"]).size(),labels=label_mp)\n","663f4028":"plt.subplot(1,4,1)\nplt.subplots_adjust(left=0,right=2,bottom=1,top=2,wspace=0.2,hspace=0.4)\nlabel_st=[1 ,2]\nplt.title(\"Suicidal thoughts\")\nplt.pie(df.groupby(df[\"Suicidal thoughts\"]).size(),labels=label_st)\n\nplt.subplot(1,4,2)\nlabel_fr=[1, 2, 3]\nplt.title(\"Family relationship\")\nplt.pie(df.groupby(df[\"Family relationship\"]).size(),labels=label_fr)\n\nplt.subplot(1,4,3)\nlabel_ff=[3, 2 ,4 ,1]\nplt.title(\"Financials of family\")\nplt.pie(df.groupby(df[\"Financials of family\"]).size(),labels=label_ff)\n\nplt.subplot(1,4,4)\nlabel_af=[2, 3, 1]\nplt.title(\"Addicted person in family\")\nplt.pie(df.groupby(df[\"Addicted person in family\"]).size(),labels=label_af)\n","eabc20ef":"plt.subplot(1,4,1)\nplt.subplots_adjust(left=0,right=2,bottom=1,top=2,wspace=0.2,hspace=0.4)\nlabel_ws=[2, 1]\nplt.title(\"Withdrawal symptoms\")\nplt.pie(df.groupby(df[\"Withdrawal symptoms\"]).size(),labels=label_ws)\n\nplt.subplot(1,4,2)\nlabel_sw=[2, 1]\nplt.title(\"Satisfied with workplace\")\nplt.pie(df.groupby(df[\"Satisfied with workplace\"]).size(),labels=label_sw)\n\nplt.subplot(1,4,3)\nlabel_cc=[2 ,1]\nplt.title(\"Case in court\")\nplt.pie(df.groupby(df[\"Case in court\"]).size(),labels=label_cc)\n\nplt.subplot(1,4,4)\nlabel_lu=[1, 2, 3]\nplt.title(\"Living with drug user\")\nplt.pie(df.groupby(df[\"Living with drug user\"]).size(),labels=label_lu)\n","07f28a82":"plt.subplot(1,4,1)\nplt.subplots_adjust(left=0,right=2,bottom=1,top=2,wspace=0.2,hspace=0.4)\nlabel_s=[1, 2, 3]\nplt.title(\"Smoking\")\nplt.pie(df.groupby(df[\"Smoking\"]).size(),labels=label_s)\n\nplt.subplot(1,4,2)\nlabel_etd=[1, 2]\nplt.title(\"Ever taken drug\")\nplt.pie(df.groupby(df[\"Ever taken drug\"]).size(),labels=label_etd)\n\nplt.subplot(1,4,3)\nlabel_fi=[1, 2]\nplt.title(\"Friends influence\")\nplt.pie(df.groupby(df[\"Friends influence\"]).size(),labels=label_fi)\n\nplt.subplot(1,4,4)\nlabel_id=[1, 3, 2]\nplt.title(\"If chance given to taste drugs\")\nplt.pie(df.groupby(df[\"If chance given to taste drugs\"]).size(),labels=label_id)\n","22d5c81a":"plt.figure()\nlabel_c=[2, 3, 4, 1]\nplt.title(\"Class\")\nplt.pie(df.groupby(df[\"Class\"]).size(),labels=label_c)\nplt.show()","08ab9576":"plt.subplot(1,3,1)\nplt.subplots_adjust(left=0,right=2,bottom=1,top=2,wspace=0.2,hspace=0.4)\nplt.title(\"Age\")\nsb.barplot(data=df,x=\"Class\",y=\"Age\")\n\nplt.subplot(1,3,2)\nplt.title(\"Gender\")\nsb.barplot(data=df,x=\"Class\",y=\"Gender\")\n\nplt.subplot(1,3,3)\nplt.title(\"Education\")\nsb.barplot(data=df,x=\"Class\",y=\"Education\")\n","eca84dda":"plt.subplot(1,3,1)\nplt.subplots_adjust(left=0,right=2,bottom=1,top=2,wspace=0.2,hspace=0.4)\nplt.title(\"Live with\")\nsb.barplot(data=df,x=\"Class\",y=\"Live with\")\n\nplt.subplot(1,3,2)\nplt.title(\"Motive about drug\")\nsb.barplot(data=df,x=\"Class\",y=\"Motive about drug\")\n\nplt.subplot(1,3,3)\nplt.title(\"Spend most time\")\nsb.barplot(data=df,x=\"Class\",y=\"Spend most time\")\n","e75d48f1":"plt.subplot(1,3,1)\nplt.subplots_adjust(left=0,right=2,bottom=1,top=2,wspace=0.2,hspace=0.4)\nplt.title(\"Failure in life\")\nsb.barplot(data=df,x=\"Class\",y=\"Failure in life\")\n\nplt.subplot(1,3,2)\nplt.title(\"Mental\/emotional problem\")\nsb.barplot(data=df,x=\"Class\",y=\"Mental\/emotional problem\")\n\nplt.subplot(1,3,3)\nplt.title(\"Suicidal thoughts\")\nsb.barplot(data=df,x=\"Class\",y=\"Suicidal thoughts\")\n","8fd2fe70":"plt.subplot(1,3,1)\nplt.subplots_adjust(left=0,right=2,bottom=1,top=2,wspace=0.2,hspace=0.4)\nplt.title(\"Family relationship\")\nsb.barplot(data=df,x=\"Class\",y=\"Family relationship\")\n\nplt.subplot(1,3,2)\nplt.title(\"Financials of family\")\nsb.barplot(data=df,x=\"Class\",y=\"Financials of family\")\n\nplt.subplot(1,3,3)\nplt.title(\"Addicted person in family\")\nsb.barplot(data=df,x=\"Class\",y=\"Addicted person in family\")\n","1af504bf":"plt.subplot(1,3,1)\nplt.subplots_adjust(left=0,right=2,bottom=1,top=2,wspace=0.2,hspace=0.4)\nplt.title(\"Withdrawal symptoms\")\nsb.barplot(data=df,x=\"Class\",y=\"Withdrawal symptoms\")\n\nplt.subplot(1,3,2)\nplt.title(\"Satisfied with workplace\")\nsb.barplot(data=df,x=\"Class\",y=\"Satisfied with workplace\")\n\nplt.subplot(1,3,3)\nplt.title(\"Case in court\")\nsb.barplot(data=df,x=\"Class\",y=\"Case in court\")\n","8c51e91f":"plt.subplot(1,3,1)\nplt.subplots_adjust(left=0,right=2,bottom=1,top=2,wspace=0.2,hspace=0.4)\nplt.title(\"Living with drug user\")\nsb.barplot(data=df,x=\"Class\",y=\"Living with drug user\")\n\nplt.subplot(1,3,2)\nplt.title(\"Smoking\")\nsb.barplot(data=df,x=\"Class\",y=\"Smoking\")\n\nplt.subplot(1,3,3)\nplt.title(\"Ever taken drug\")\nsb.barplot(data=df,x=\"Class\",y=\"Ever taken drug\")\n","7e8708ac":"plt.subplot(1,3,1)\nplt.subplots_adjust(left=0,right=2,bottom=1,top=2,wspace=0.2,hspace=0.4)\nplt.title(\"Friends influence\")\nsb.barplot(data=df,x=\"Class\",y=\"Friends influence\")\n\nplt.subplot(1,3,2)\nplt.title(\"If chance given to taste drugs\")\nsb.barplot(data=df,x=\"Class\",y=\"If chance given to taste drugs\")\n\nplt.subplot(1,3,3)\nplt.title(\"Easy to control use of drug\")\nsb.barplot(data=df,x=\"Class\",y=\"Easy to control use of drug\")\n","186b8b7d":"df.columns","41975cef":"X=df[['Age', 'Gender', 'Education', 'Live with', 'Motive about drug',\n       'Spend most time', 'Failure in life', 'Mental\/emotional problem',\n       'Suicidal thoughts', 'Family relationship', 'Financials of family',\n       'Addicted person in family', 'Withdrawal symptoms',\n       'Satisfied with workplace', 'Case in court', 'Living with drug user',\n       'Smoking', 'Ever taken drug', 'Friends influence',\n       'If chance given to taste drugs', 'Easy to control use of drug']]\ny=df['Class']","ce214c29":"from sklearn.ensemble import ExtraTreesClassifier\nfrom sklearn.feature_selection import SelectKBest, chi2, f_classif","3d21a4c1":"model_etc=ExtraTreesClassifier(n_estimators=100).fit(X,y)\nmodel_skb_chi=SelectKBest(chi2,k=20).fit(X,y)\nmodel_skb_fc=SelectKBest(f_classif,k=20).fit(X,y)\nscores=pd.DataFrame({\"col\": X, \"ETC\":model_etc.feature_importances_,\"SKB_Chi\":model_skb_chi.scores_,\"SKB_Fc\":model_skb_fc.scores_})\nscores=scores.sort_values(by=[\"ETC\",\"SKB_Chi\",\"SKB_Fc\"], axis=0, ascending=False, kind=\"quicksort\", na_position=\"last\")","9eda2426":"scores","805f0e3d":"from sklearn.model_selection import train_test_split","a875dce0":"X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.30,random_state=100)\nprint(X_train.shape,y_train.shape)\nprint(X_test.shape,y_test.shape)","692dc88d":"from sklearn.ensemble import RandomForestClassifier","b1b797a8":"model_rc=RandomForestClassifier().fit(X_train,y_train)\nmodel_rc=model_rc.predict(X_test)","2aa365da":"model_rc","5053f903":"from sklearn.metrics import accuracy_score","f4e06254":"accuracy_score(y_test,model_rc)","f5aea2ce":"from sklearn.metrics import confusion_matrix","ad5df2fe":"confusion_matrix(y_test,model_rc)","329844ce":"from sklearn.metrics import classification_report","3b258446":"print(classification_report(y_test,model_rc))","cecb4c8e":"## Barplot","18229474":"## Count of target variables\n- multi class","f5484856":"## Checking Outliers","3e7c3b37":"## Info about data","ab4b5397":"## Confusion Matrix","24b7bd37":"## Unique values","73644bb9":"## Conversion\n- Converting all columns to int.","67322d3b":"## Splitting Data","3a07acdd":"## Accuracy Score","0422a243":"## Reading Data","78ce99b7":"## Handling outliers\n- Handling outliers by replacing them through upper limit and lower limit of that particular column. \n- Not handling outliers of column gender because it is an binary value.","c489cb70":"## Checking Null values\n-  no null values present","13874902":"## Classification report","21512862":"## Descriptive Values","39ebedb5":"## Prediction Model\n- RandomForestClassifier","923bfb1b":"## Pie chart","d5b08ed0":"## Size of data"}}