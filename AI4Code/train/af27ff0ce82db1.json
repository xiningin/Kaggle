{"cell_type":{"5c25d5ed":"code","696486b0":"code","da586ed5":"code","c717b126":"code","0023d7a0":"code","bc34d9a4":"code","f5e6ace3":"code","e03fd16a":"code","b5e97e3d":"code","9973d017":"code","bead8d28":"code","4b26b87f":"code","4d959a75":"code","b0b0aef0":"code","bf46acc5":"code","c15a27e8":"code","1772a870":"code","e1ae760a":"code","815006d2":"code","bcef226d":"code","4c9b3df8":"code","017100c2":"code","b76c3362":"code","e5ece166":"code","c2ac7a42":"code","27bef00f":"code","3da76205":"code","cc6e4302":"code","3fd6fb74":"code","c4d1690e":"code","3f3a7307":"code","8ac0e12f":"code","1fdf4cff":"code","abab5c40":"code","d732fb9e":"code","015e6bb8":"code","8b3e5e84":"code","00725810":"code","d4dca1ef":"code","4ce79620":"markdown","57008625":"markdown","093fc3cc":"markdown","cde51982":"markdown","2efda40a":"markdown","085b7192":"markdown","c85e9645":"markdown","a2a5cf37":"markdown","ef26c458":"markdown","b3c78189":"markdown","d913d0cf":"markdown","41cf1a28":"markdown","c5a6bf20":"markdown","8990653b":"markdown"},"source":{"5c25d5ed":"import pandas as pd\ndf = pd.read_csv('..\/input\/mushroom-classification\/mushrooms.csv')","696486b0":"df.head()","da586ed5":"df.duplicated().sum()","c717b126":"df.isnull().sum()","0023d7a0":"df.info()","bc34d9a4":"df.describe().T","f5e6ace3":"import matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore')\nimport numpy as np\nimport seaborn as sns","e03fd16a":"plt.figure(figsize=(6, 6))\nmushrooms = ['poisonous','edible']\ncount = [len(df[df['class'] == 'p']),len(df[df['class'] == 'e'])]\ncolors = sns.color_palette(\"hls\", 8)[6:8]\nplt.pie(count, labels = mushrooms,colors=colors,autopct='%1.2f%%')\nplt.show()","b5e97e3d":"fig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=df,x='cap-shape')","9973d017":"fig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=df,x='cap-shape',hue='class',palette='rocket_r')","bead8d28":"df.groupby('cap-shape')['class'].value_counts()","4b26b87f":"fig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=df,x='cap-surface',palette='rocket')","4d959a75":"fig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=df,x='cap-surface',hue='class',palette='viridis')","b0b0aef0":"df.groupby('cap-surface')['class'].value_counts()","bf46acc5":"fig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=df,x='cap-color',hue='class',palette='viridis')","c15a27e8":"df.groupby('cap-color')['class'].value_counts()","1772a870":"fig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=df,x='bruises',hue='class',palette='flare')","e1ae760a":"fig, ax = plt.subplots(figsize=(10,7))\nclassx = ['poisonous','edible']\ndf2 = df[df['bruises'] == 'f']\ncount = [len(df2[df2['class'] == 'p']),len(df2[df2['class'] == 'e'])]\ncolors = sns.color_palette(\"hls\", 8)[6:8]\nplt.title('MUSHROOMS WITH NO BRUISES')\nplt.pie(count, labels = mushrooms,colors=colors,autopct='%1.2f%%')\nplt.show()","815006d2":"fig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=df,x='odor',hue='class',palette='magma')\nplt.show()","bcef226d":"fig, ax = plt.subplots(figsize=(10,7))\nclasx = ['poisonous','edible']\ndf2 = df[df['odor'] != 'n']\nplt.title('MUSHROOMS THAT SMELL')\ncount = [len(df2[df2['class'] == 'p']),len(df2[df2['class'] == 'e'])]\ncolors = sns.color_palette(\"hls\", 8)[6:8]\nplt.pie(count, labels = mushrooms,colors=colors,autopct='%1.2f%%')\nplt.show()","4c9b3df8":"fig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=df,x='gill-attachment',hue='class',palette='magma')\nplt.show()","017100c2":"fig, ax = plt.subplots(figsize=(10,7))\nclasx = ['poisonous','edible']\ndf2 = df[df['gill-attachment'] != 'f']\ncount = [len(df2[df2['class'] == 'p']),len(df2[df2['class'] == 'e'])]\ncolors = sns.color_palette(\"hls\", 8)[6:8]\nplt.title('MUSHROOMS WITH ATTACHED GILL ATTACHMENT')\nplt.pie(count, labels = mushrooms,colors=colors,autopct='%1.2f%%')\nplt.show()","b76c3362":"\nfig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=df,x='gill-spacing',hue='class',palette='magma')\nplt.show()","e5ece166":"fig, ax = plt.subplots(figsize=(10,7))\nclasx = ['poisonous','edible']\ndf2 = df[df['gill-spacing'] != 'c']\ncount = [len(df2[df2['class'] == 'p']),len(df2[df2['class'] == 'e'])]\ncolors = sns.color_palette(\"hls\", 8)[6:8]\nplt.title('MUSHROOMS WITH CROWDED GILL SPACING')\nplt.pie(count, labels = mushrooms,colors=colors,autopct='%1.2f%%')\nplt.show()","c2ac7a42":"\nfig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=df,x='gill-size',hue='class',palette='magma')\nplt.show()","27bef00f":"fig, ax = plt.subplots(figsize=(10,7))\nclasx = ['poisonous','edible']\ndf2 = df[df['gill-size'] != 'b']\ncount = [len(df2[df2['class'] == 'p']),len(df2[df2['class'] == 'e'])]\ncolors = sns.color_palette(\"hls\", 8)[6:8]\nplt.title('MUSHROOMS WITH NARROW GILL SIZE')\nplt.pie(count, labels = mushrooms,colors=colors,autopct='%1.2f%%')\nplt.show()","3da76205":"fig, ax = plt.subplots(figsize=(10,7))\nclasx = ['poisonous','edible']\ndf2 = df[df['gill-size'] != 'n']\ncount = [len(df2[df2['class'] == 'p']),len(df2[df2['class'] == 'e'])]\ncolors = sns.color_palette(\"hls\", 8)[6:8]\nplt.title('MUSHROOMS WITH BROAD GILL SIZE')\nplt.pie(count, labels = mushrooms,colors=colors,autopct='%1.2f%%')\nplt.show()","cc6e4302":"\nfig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=df,x='gill-color',hue='class',palette='magma')\nplt.show()","3fd6fb74":"fig, ax = plt.subplots(figsize=(10,7))\nclasx = ['poisonous','edible']\ndf2 = df[df['gill-color'] == 'b']\ncount = [len(df2[df2['class'] == 'p']),len(df2[df2['class'] == 'e'])]\ncolors = sns.color_palette(\"hls\", 8)[6:8]\nplt.title('MUSHROOMS WITH BROAD GILL SIZE')\nplt.pie(count, labels = mushrooms,colors=colors,autopct='%1.2f%%')\nplt.show()","c4d1690e":"\nfig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=df,x='stalk-shape',hue='class',palette='magma')\nplt.show()","3f3a7307":"fig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=df,x='stalk-root',hue='class',palette='magma')\nplt.show()","8ac0e12f":"fig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=df,x='habitat',hue='class',palette='magma')\nplt.show()","1fdf4cff":"df.head()","abab5c40":"y = df['class']\nX = df.drop('class',axis=1)","d732fb9e":"from sklearn.preprocessing import OrdinalEncoder\nenc = OrdinalEncoder()\nX = enc.fit_transform(X)","015e6bb8":"from sklearn.model_selection import cross_val_score","8b3e5e84":"from sklearn.ensemble import RandomForestClassifier\nrfc = RandomForestClassifier()\nscores = cross_val_score(rfc, X, y, cv=5, scoring='accuracy')\nprint(\"Random Forest Score : \"+str(np.mean(scores)))","00725810":"from sklearn.ensemble import ExtraTreesClassifier\netc = ExtraTreesClassifier()\nscores = cross_val_score(etc, X, y, cv=5, scoring='accuracy')\nprint(\"Extra Tree Score : \"+str(np.mean(scores)))","d4dca1ef":"from sklearn.neighbors import KNeighborsClassifier\nknn = KNeighborsClassifier(n_neighbors = 5)\nscores = cross_val_score(knn, X, y, cv=5, scoring='accuracy')\nprint(f\"KNN : {np.mean(scores)}\")","4ce79620":"* All mushrooms with grooves are poisonous","57008625":"*ALL COLUMNS ARE CATEGORICAL","093fc3cc":"# BASIC EDA","cde51982":"# **MODELLING**","2efda40a":"* **Mushrooms that smell are very likely to be poisonous**","085b7192":"* Mushrooms with gill color buff,green are poisonous\n* red,orange are edible","c85e9645":"* all conical mushrooms are poisonous\n* all sunken mushrooms edible","a2a5cf37":"# **PREPROCESSING**","ef26c458":"* Data is almost balanced","b3c78189":"* Most mushrooms with attached gill are edible","d913d0cf":"* mushrooms with no bruises are more likely to be poisonous","41cf1a28":"* green and purple mushrooms are edible","c5a6bf20":"* pungent,foul,creosote,fishy,spicy,musty smelling mushrooms are poisnous\n* anise,almond smelling mushrooms are edible","8990653b":"!['mushroom'](https:\/\/images.unsplash.com\/photo-1505820013142-f86a3439c5b2?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=871&q=80)"}}