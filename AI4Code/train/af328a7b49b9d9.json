{"cell_type":{"e855665b":"code","860c1399":"code","82d6ec80":"code","226d785d":"code","838c0519":"code","88f736a8":"code","7e12c378":"code","729aa756":"code","4170b90b":"code","f0996a07":"markdown"},"source":{"e855665b":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nfrom glob import glob\nimport shutil","860c1399":"# load yolo submission\nyolo = pd.read_csv('..\/input\/yolo169\/submission_2.csv')\neffnetb6 = pd.read_csv('..\/input\/vinbigdata-2class-prediction\/2-cls test pred.csv') # AUC:0.98","82d6ec80":"yolo.head()","226d785d":"effnetb6.head()","838c0519":"pred = pd.merge(yolo, effnetb6, on = 'image_id', how = 'left')\npred.head()","88f736a8":"low_thr  = 0.08\nhigh_thr = 0.95","7e12c378":"def filter_2cls(row, low_thr=low_thr, high_thr=high_thr):\n    prob = row['target']\n    if prob<low_thr:\n        ## Less chance of having any disease\n        row['PredictionString'] = '14 1 0 0 1 1'\n    elif low_thr<=prob<high_thr:\n        ## More change of having any diesease\n        row['PredictionString']+=f' 14 {prob} 0 0 1 1'\n    elif high_thr<=prob:\n        ## Good chance of having any disease so believe in object detection model\n        row['PredictionString'] = row['PredictionString']\n    else:\n        raise ValueError('Prediction must be from [0-1]')\n    return row","729aa756":"sub = pred.apply(filter_2cls, axis=1)\nsub.head()","4170b90b":"sub[['image_id', 'PredictionString']].to_csv('submission.csv',index = False)","f0996a07":"Training notebook:\nhttps:\/\/www.kaggle.com\/mostafaibrahim17\/yolov5-vinbigdata\n\nCredits:\nhttps:\/\/www.kaggle.com\/awsaf49\/vinbigdata-2-class-filter\n\nhttps:\/\/www.kaggle.com\/awsaf49\/vinbigdata-cxr-ad-yolov5-14-class-infer\n\nhttps:\/\/www.kaggle.com\/awsaf49\/vinbigdata-cxr-ad-yolov5-14-class-train"}}