{"cell_type":{"63f0ea85":"code","61850a09":"code","f86c72ce":"code","933492aa":"code","7d03bfb2":"code","e95f794c":"code","c2d448b2":"code","84fdf742":"code","ee78ed2b":"code","350026a3":"code","80584a74":"code","927fe75e":"code","5c6e48e2":"code","e477de14":"code","d4e974fe":"code","9f8303c1":"code","4028143b":"markdown","b7d7b1e6":"markdown","f3a5f754":"markdown","c5d2548f":"markdown","99d5f53b":"markdown","ec0b5838":"markdown"},"source":{"63f0ea85":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import train_test_split,GridSearchCV \nfrom sklearn.preprocessing import StandardScaler","61850a09":"train_df=pd.read_csv('\/kaggle\/input\/titanic\/train.csv')\ntest_df=pd.read_csv('\/kaggle\/input\/titanic\/test.csv')","f86c72ce":"plt.figure(figsize=(5,5))\nsns.set_style('darkgrid')\nsns.countplot(x='Survived',hue='Embarked',data=train_df)\n","933492aa":"sns.countplot(x='Survived',hue='Pclass',data=train_df)\nprint(train_df.columns)","7d03bfb2":"train_df.drop(['PassengerId','Name','Ticket','Cabin'],axis=1,inplace=True)\ntest_df.drop(['Name','Ticket','Cabin'],axis=1,inplace=True)\n","e95f794c":"train_df['Total_mem']=train_df['SibSp']+train_df['Parch']\ntest_df['Total_mem']=test_df['SibSp']+test_df['Parch']\n\ntest_df.isna().sum()","c2d448b2":"train_df.drop(['SibSp','Parch'],axis=1,inplace=True)\ntest_df.drop(['SibSp','Parch'],axis=1,inplace=True)\n\n\ntrain_df[['Embarked']]=train_df[['Embarked']].fillna(train_df.mode()['Embarked'][0])\ntrain_df[['Age']]=train_df[['Age']].fillna(train_df['Age'].mean())\n\n\ntest_df[['Fare']]=test_df[['Fare']].fillna(test_df.mode()['Fare'][0])\ntest_df[['Age']]=test_df[['Age']].fillna(test_df['Age'].mean())\n","84fdf742":"sex=pd.get_dummies(train_df['Sex'])\nembarked=pd.get_dummies(train_df['Embarked'])\npclass=pd.get_dummies(train_df['Pclass'])\ntrain_df=pd.concat([train_df,sex,embarked,pclass],axis=1)\n\nsex=pd.get_dummies(test_df['Sex'])\nembarked=pd.get_dummies(test_df['Embarked'])\npclass=pd.get_dummies(test_df['Pclass'])\ntest_df=pd.concat([test_df,sex,embarked,pclass],axis=1)","ee78ed2b":"train_df.drop(['Sex','Embarked','Pclass'],axis=1,inplace=True)\ntest_df.drop(['Sex','Embarked','Pclass'],axis=1,inplace=True)","350026a3":"sns.heatmap(train_df.corr())","80584a74":"train_df.columns = train_df.columns.astype(str)\ntest_df.columns = test_df.columns.astype(str)\ntrain_df.drop(['male','C','1'],axis=1,inplace=True)\ntest_df.drop(['male','C','1'],axis=1,inplace=True)","927fe75e":"X=np.array(train_df.drop(['Survived'],axis=1))\ny=np.array(train_df['Survived'])\nX=StandardScaler().fit_transform(X)\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=.2)\n\ndf=test_df['PassengerId']\ntest_df.drop(['PassengerId'],axis=1,inplace=True)\npred=np.array(test_df)\npred=StandardScaler().fit_transform(pred)","5c6e48e2":"train_df","e477de14":"test_df","d4e974fe":"model=RandomForestClassifier()\n\nparam={'n_estimators':[100,200,300],\n        'max_depth':[1,3,5,7],\n        'criterion':[\"gini\"],\n        'max_features': [1,3,5],\n        \"min_samples_split\": [2,3,5]\n        }\n\nclf=GridSearchCV(estimator=model,\n                 param_grid=param,\n                 scoring=\"accuracy\",\n                 verbose=1,\n                 n_jobs=-1,\n                 cv=5)\n\nclf.fit(X,y)\nclf.best_estimator_\nclf.best_score_\n","9f8303c1":"prediction=clf.predict(pred)\nfinal={'PassengerId':df,\n        'Survived':prediction}\n\nsubmission=pd.DataFrame(data=final)\nsubmission.to_csv('final_prediction.csv',index=False)","4028143b":"# Using GridSearchCV for hyperparameters tuning.","b7d7b1e6":"# Merging and Label Encoding.","f3a5f754":"# Traning the Model.","c5d2548f":"# Draft-2\n\n1. Feature Selection\n2. Label Encoding\n3. Featue scaling\n4. Hyperparamter tuning.","99d5f53b":"# Dropping unwanted features.\n\nOthers have taken them but i don't feel names,ticket no. etc make any difference practically.","ec0b5838":"# Dropping features seeing the correlation matrix."}}