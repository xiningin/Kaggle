{"cell_type":{"88e30d32":"code","5a820b00":"code","6567e4cf":"code","aae3627e":"code","7f98a390":"code","55f8fd00":"code","da96e6e9":"code","2648e920":"code","39598bc1":"code","61267c68":"code","9d39083d":"code","f94bed9f":"code","b4c8ecbe":"code","6feb40c1":"code","b03134dc":"code","67337811":"code","1702fa05":"code","198f613d":"markdown","d126144b":"markdown","51ce0581":"markdown","d6160dac":"markdown","abf1bb6a":"markdown","e4ddea25":"markdown","608d1639":"markdown","8ba0c9ef":"markdown","013917da":"markdown"},"source":{"88e30d32":"import numpy as np\nimport pandas as pd\nimport tensorflow as tf\nfrom keras.preprocessing import image\nfrom keras.preprocessing.image import ImageDataGenerator\nfrom keras.layers import Dense\nfrom keras.models import Model\nimport os\nimport cv2","5a820b00":"df_train = pd.read_csv('..\/input\/hackereath-holiday-season-deep-learning-contest\/dataset\/train.csv')\ndf_train.head()","6567e4cf":"df_train['Class'].value_counts()","aae3627e":"train_datagen = ImageDataGenerator(rescale=1.\/255,\n         shear_range=0.2,\n         zoom_range=0.2,\n         horizontal_flip=True,\n         width_shift_range=0.2,\n         height_shift_range=0.2)\n\ntrain_generator=train_datagen.flow_from_dataframe(dataframe=df_train,\n                                            directory=\"..\/input\/hackereath-holiday-season-deep-learning-contest\/dataset\/train\",\n                                            x_col=\"Image\",\n                                            y_col=\"Class\",\n                                            batch_size=128,\n                                            seed=42,\n                                            shuffle=True,\n                                            class_mode=\"categorical\",\n                                            target_size=(299,299))","7f98a390":"model = tf.keras.applications.InceptionResNetV2(include_top=True,weights=\"imagenet\")","55f8fd00":"x = model.layers[-2].output\nfc = Dense(1024,activation='relu')(x)\nfc = Dense(512,activation='relu')(fc)\nfc = Dense(256,activation='relu')(fc)\nfc = Dense(6,activation='softmax')(fc)","da96e6e9":"model1 = Model(inputs=model.input,outputs=fc)\n#model1.summary()","2648e920":"from tensorflow.keras.utils import plot_model\nplot_model(model1, to_file='model.png', rankdir='LR')","39598bc1":"plot_model(model1, to_file='model.png')","61267c68":"#freezing all the layers\nfor layer in model1.layers[:-16]:\n    #print(l)\n    layer.trainable = False","9d39083d":"model1.compile(optimizer='adam',loss =\"categorical_crossentropy\",metrics=[\"accuracy\"])","f94bed9f":"history = model1.fit_generator(train_generator, epochs=4)","b4c8ecbe":"classes = train_generator.class_indices","6feb40c1":"classes = dict((v,k) for k,v in classes.items())\nclasses = [classes[k] for k in classes]","b03134dc":"Image = []\nprediction = []\n\n\nfor i, file in enumerate(os.listdir('..\/input\/hackereath-holiday-season-deep-learning-contest\/dataset\/test\/')):\n    Image.append(file)\n    file = '..\/input\/hackereath-holiday-season-deep-learning-contest\/dataset\/test\/' + file\n\n    img = image.load_img(file, target_size=(299,299,3)) \n    img = image.img_to_array(img)\n    img = img\/255\n    pred = model1.predict(img.reshape(1,299,299,3))\n\n    prediction.append(classes[np.argmax(pred[0])])","67337811":"data=pd.DataFrame((zip(Image, prediction)),columns=['Image','Class'])\ndata.head()","1702fa05":"data.to_csv('submission.csv',index=False)","198f613d":"# Loading necessary libraries","d126144b":"# Compiling model","51ce0581":"\n# HackerEarth Deep Learning Challenge: 'Tis STILL the season to be jolly","d6160dac":"# Submission file creation","abf1bb6a":"# Training model","e4ddea25":"You work for a social media platform. Your task is to create a solution using deep learning to discern whether a post is holiday-related in an effort to better monetize the platform.\n\nTask-\nYou are given the following six categories. You are required to classify the images in the dataset based on these categories.\n\n    Miscellaneous\n    Christmas_Tree\n    Jacket\n    Candle\n    Airplane\n    Snowman\n","608d1639":"# Number of training classes","8ba0c9ef":"# Loading pre-trained models","013917da":"# Training data augmentation"}}