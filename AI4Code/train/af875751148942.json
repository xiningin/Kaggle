{"cell_type":{"f1ef604b":"code","2f806cc9":"code","9183256f":"code","e90b1cfa":"code","76fe1f32":"code","d52dd28e":"code","9e7baaac":"code","ed786445":"code","2309035f":"code","f461f237":"code","fb9c130c":"markdown","f692a10e":"markdown","4553c80c":"markdown","a4ee1f8b":"markdown","dd4637db":"markdown","f15180b5":"markdown","3ca41bfe":"markdown","fcd65507":"markdown","5795e945":"markdown"},"source":{"f1ef604b":"!pip install apyori","2f806cc9":"import numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd","9183256f":"dataset = pd.read_csv('..\/input\/market-basket-optimisation\/Market_Basket_Optimisation.csv',header=None)\ntransactions = []\nfor i in range(0,dataset.shape[0]):\n    transactions.append([str(dataset.values[i,j])for j in range(0,dataset.shape[1])])","e90b1cfa":"print(transactions)","76fe1f32":"from apyori import apriori\nrules = apriori(transactions= transactions,  min_support = .003, min_confidence = 0.2, min_lift = 3, min_length = 2, max_length = 2 )","d52dd28e":"results = list(rules)","9e7baaac":"results","ed786445":"def inspect(results):\n    lhs         = [tuple(result[2][0][0])[0] for result in results]\n    rhs         = [tuple(result[2][0][1])[0] for result in results]\n    supports    = [result[1] for result in results]\n    confidences = [result[2][0][2] for result in results]\n    lifts       = [result[2][0][3] for result in results]\n    return list(zip(lhs, rhs, supports, confidences, lifts))\nresultsinDataFrame = pd.DataFrame(inspect(results), columns = ['Left Hand Side', 'Right Hand Side', 'Support', 'Confidence', 'Lift'])","2309035f":"resultsinDataFrame","f461f237":"resultsinDataFrame.nlargest(n = 10, columns = 'Lift')","fb9c130c":"## Visualising the results","f692a10e":"## Training the Apriori model on the dataset","4553c80c":"## Importing the libraries","a4ee1f8b":"# Apriori","dd4637db":"### Displaying the results sorted by descending lifts","f15180b5":"### Putting the results well organised into a Pandas DataFrame","3ca41bfe":"### Displaying the results non sorted","fcd65507":"## Data Preprocessing","5795e945":"### Displaying the first results coming directly from the output of the apriori function"}}