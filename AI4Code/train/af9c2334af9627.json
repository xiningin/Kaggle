{"cell_type":{"0e7a319f":"code","38dc5bd7":"code","437820f5":"code","f53f2ef7":"code","0c842b86":"code","b9ac5aaf":"code","18c1ccb2":"code","4caf3d7b":"code","2d2513b7":"code","5c4bbb07":"code","d73832e3":"code","cab0bbcc":"code","ef1c813d":"markdown","8167cafb":"markdown","046aee62":"markdown"},"source":{"0e7a319f":"import numpy as np\nimport pandas as pd\nimport os\n\nfrom torch.utils.data import DataLoader\nfrom torchvision.datasets import ImageFolder\nimport torchvision.transforms as T\n\nimport torch\nfrom torchvision.utils import make_grid\nimport matplotlib.pyplot as plt\n","38dc5bd7":"IMAGE_FOLDER = '..\/input\/abstract-art-gallery'\nIMAGE_SIZE = 64\nBATCH_SIZE = 128\nSTATS = (0.5, 0.5, 0.5), (0.5, 0.5, 0.5)\nNUM_WORKERS = 3\n\nNROWS = 5\nNCOLS = 4","437820f5":"imageFolder = ImageFolder(IMAGE_FOLDER, \n                       transform=T.Compose(\n                           [\n                               T.Resize(IMAGE_SIZE),\n                               T.CenterCrop(IMAGE_SIZE),\n                               T.ToTensor(),\n                               T.Normalize(*STATS)\n                           ]\n                       )\n                      )\n\nimageFolder","f53f2ef7":"imageDataLoader = DataLoader(\n    imageFolder, \n    BATCH_SIZE, \n    shuffle=True, \n    num_workers=NUM_WORKERS, \n    pin_memory=True\n)\n","0c842b86":"ds_images = imageDataLoader.dataset\nds_images","b9ac5aaf":"ds_images.imgs[:5]","18c1ccb2":"len(ds_images)","4caf3d7b":"ds_images.classes","2d2513b7":"ds_images.targets[:5]","5c4bbb07":"ds_images.root","d73832e3":"def denorm(img_tensors):\n    return img_tensors * STATS[1][0] + STATS[0][0]\n\ndef show_images(dataLoader, nmax=NROWS*NCOLS):\n    for images, label in dataLoader:\n        fig, ax = plt.subplots(figsize=(NROWS,NCOLS))\n        ax.set_xticks([])\n        ax.set_xticks([])\n        \n        denormedData = denorm(images.detach()[:nmax])\n        girdData = make_grid(denormedData, nrow=NROWS).permute(1,2,0)\n        ax.imshow(girdData) \n        break","cab0bbcc":"show_images(imageDataLoader)","ef1c813d":"# make Images","8167cafb":"# make ImageFolder","046aee62":"# make DataLoader"}}