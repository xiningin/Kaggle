{"cell_type":{"70dfdfef":"code","83b6c1c1":"code","1f88d66e":"code","d924e721":"code","d3467ed1":"code","408b1e3b":"code","23056f1a":"code","fdc4176e":"code","983d2b76":"code","4a34672e":"code","247036e0":"code","7536328c":"code","87c68c2a":"code","c52c3207":"code","31b4cb22":"code","9f86a319":"code","5db842b7":"code","bafdaa9c":"code","cbe9f79f":"code","9f090def":"code","53372c68":"code","3bf0445c":"code","ddc3d869":"code","8ec1cd1f":"code","6bd95aa2":"code","9c0b164a":"markdown","9dd73f26":"markdown","74ba7537":"markdown","be685624":"markdown","c54ee264":"markdown","8c713a58":"markdown","c3289a61":"markdown","f18d953d":"markdown","97022c96":"markdown","6d6bf686":"markdown","c7a21a60":"markdown","2703b367":"markdown","7df20182":"markdown","41b65d16":"markdown","9386a359":"markdown","c2c4fb19":"markdown","61b86a2c":"markdown"},"source":{"70dfdfef":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","83b6c1c1":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","1f88d66e":"%matplotlib inline","d924e721":"customer = pd.read_csv(\"..\/input\/Ecommerce Customers.csv\")","d3467ed1":"customer.head()","408b1e3b":"customer.info()","23056f1a":"sns.heatmap(customer.corr(), linewidth=0.5, annot=True)","fdc4176e":"sns.jointplot(data = customer, x = \"Time on Website\", y = \"Yearly Amount Spent\")","983d2b76":"sns.jointplot(data = customer, x = \"Time on App\", y = \"Yearly Amount Spent\")","4a34672e":"sns.jointplot(data = customer, x = \"Time on App\", y = \"Length of Membership\", kind = \"hex\")","247036e0":"sns.pairplot(customer)","7536328c":"sns.lmplot(data = customer, x= \"Length of Membership\", y =\"Yearly Amount Spent\")","87c68c2a":"x=customer[['Avg. Session Length', 'Time on App','Time on Website', 'Length of Membership']]\ny=customer['Yearly Amount Spent']","c52c3207":"from sklearn.model_selection import train_test_split","31b4cb22":"x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3, random_state=42)","9f86a319":"from sklearn.linear_model import LinearRegression","5db842b7":"lm = LinearRegression()","bafdaa9c":"lm.fit(x_train, y_train)","cbe9f79f":"lm.coef_","9f090def":"result = lm.predict(x_test)","53372c68":"plt.scatter(y_test, result)\nplt.xlabel(\"Actual values\")\nplt.ylabel(\"Predicted values\")","3bf0445c":"from sklearn import metrics","ddc3d869":"print('MAE ', metrics.mean_absolute_error(y_test,result))\nprint('MSE ', metrics.mean_squared_error(y_test,result))\nprint('RMSE ', np.sqrt(metrics.mean_squared_error(y_test,result)))","8ec1cd1f":"metrics.explained_variance_score(y_test,result)","6bd95aa2":"plt.hist((y_test-result))","9c0b164a":"Now we will check how well the model explains varience. ","9dd73f26":"Now we try to see in there is any correlation between the time spent on the website to the yearly amount spent.","74ba7537":"The plot looks normally distributed. This means that our modelling was a success!!","be685624":"The above plot shows that the longer a customer remains a member, the higher the yearly amount spent is going to be. \nNow we start the model building provcess. We devide the data into 2 parts (x and y). X would be the parameters that we would use to predict the y value and the y value in our case is Yearly Amount Spent. ","c54ee264":"The above figure confirms that the model is well fit to the test dataset.Now we will check the residual. IF the histogram comes out to be normal then it means that everything is ok with the data.","8c713a58":"The above plot shows that the model is performing well although there are some divations from the line. Now we will evaluated the model using statistics. We would be calculating Mean Absolute Error, Mean Squared  Error and Root Mean Squared Error. ","c3289a61":"Now we develop a pairplot to see all the parameters and try to visually find any parameter that would be correlated. ","f18d953d":"Now we will train the model on the training dataset. ","97022c96":"Now we are going to check the object type, number of entries, columns etc.","6d6bf686":"Now to better visualise the model's performance we would build a scatterplot of the result vs the test values.","c7a21a60":"Now we are going to try to get fimiliar with the dataset. For this we take a look at the first 5 rows of the dataset.  ","2703b367":"First we are going to start by importing all the libraries that we would need to analyse this data. \nI have downloaded pandas, numpy, matplotlib and seaborn. ","7df20182":"From the above plot it is difficult to see if there is any correlation between the two variables taken. Now we would try to see if there is any correlation between Time on App with yearly amount spent.","41b65d16":"From the above plot we can see that Yearly Amount Spent is correlated to Length of Membership. Now we would try to plot this relation in a little more detail. To do this we build a linear model plot. ","9386a359":"Now we start with the initial data exploration. We firrst build a heatmap with all the parameters. ","c2c4fb19":"The above plot seems correlated. Increasing time on App seems to be related to higher Yearly Amount spent. \nNow we will develop a 2D hex bin plot comparing the Time on App and Length of membership. ","61b86a2c":"Now we will preddict using the test data. "}}