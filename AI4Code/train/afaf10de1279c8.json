{"cell_type":{"15976fb0":"code","ceae9573":"code","74f1e9dd":"code","5f4ecb84":"code","574b02a6":"code","2f663d81":"code","38c4d065":"code","07bea053":"code","f531cb54":"code","aa8e5ad1":"code","c7ae9b73":"code","798449e0":"code","84297ce1":"code","b6d9f357":"code","49f558a7":"code","96f2853f":"code","3d0b73da":"code","9f0479a5":"code","daaf0377":"code","ab3712ac":"code","e2862ad0":"code","8ac68f95":"code","73363eb8":"markdown","2a1915e7":"markdown","19c4a571":"markdown","f8aee0cb":"markdown"},"source":{"15976fb0":"!pip install --upgrade autogluon","ceae9573":"import pandas as pd\nimport numpy as np\n\nfrom autogluon.tabular import TabularPredictor\n\nimport os\nimport gc\ntrain_path = '..\/input\/tabular-playground-series-jun-2021\/train.csv'\ntest_path = '..\/input\/tabular-playground-series-jun-2021\/test.csv'\nRS = 69420\n# os.environ['NUMEXPR_MAX_THREADS'] = '16'","74f1e9dd":"df = pd.read_csv(train_path, index_col=0)\n\nfrom sklearn.preprocessing import LabelEncoder\n\nle = LabelEncoder()\ndf['target'] = le.fit_transform(df['target'])\n\ndf","5f4ecb84":"gc.collect()","574b02a6":"X = df.iloc[:, :-1].values\ny = df.iloc[:, -1].values","2f663d81":"from sklearn.ensemble import ExtraTreesClassifier\nclf = ExtraTreesClassifier(n_jobs=-1, bootstrap=True,verbose=1)","38c4d065":"%%time\nclf = clf.fit(X, y)","07bea053":"from sklearn.feature_selection import SelectFromModel\nmodel = SelectFromModel(clf, prefit=True)\nX = model.transform(X)\nX.shape","f531cb54":"df = pd.DataFrame(X)\ndf['target'] = y","aa8e5ad1":"df","c7ae9b73":"del X, y\ngc.collect()","798449e0":"label = 'target'\neval_metric='log_loss'\nsave_path = '.\/AutoGlon\/'\ntimeLimit = 3600 * 7.5\nnum_trials = 250\nsearch_strategy = 'auto' ","84297ce1":"hyperparameter_kwargs = {'num_trials': num_trials,\n                         'scheduler' : 'local',\n                         'searcher': search_strategy\n                        }","b6d9f357":"models={'NN': {},\n        'GBM': [{'device':'gpu', 'extra_trees': True, 'ag_args': {'name_suffix': 'XT'}},{'device':'gpu'},'GBMLarge',],\n        'CAT': {'task_type':'GPU'},\n        'XGB': {'tree_method':'gpu_hist'},\n        'FASTAI': {}}","49f558a7":"predictor = TabularPredictor(label=label,\n                             eval_metric=eval_metric,\n                             path=save_path,\n                             verbosity=1) # 0 = Silent, 4 = Print every damn thing","96f2853f":"%%time\npredictor.fit(df,\n              hyperparameters=models,\n              presets='best_quality',\n              keep_only_best=True,\n              refit_full=True,\n              save_space=True,\n              hyperparameter_tune_kwargs=hyperparameter_kwargs,\n              time_limit=timeLimit)\n\nresults = predictor.fit_summary()","3d0b73da":"submission = pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/sample_submission.csv', index_col=0)\nsubmission","9f0479a5":"test = pd.read_csv(test_path, index_col=0)\ntest","daaf0377":"test = model.transform(test)","ab3712ac":"y_preds = predictor.predict_proba(test)","e2862ad0":"preds = y_preds.values\n\nsubmission['Class_1']=preds[:,0]\nsubmission['Class_2']=preds[:,1]\nsubmission['Class_3']=preds[:,2]\nsubmission['Class_4']=preds[:,3]\nsubmission['Class_5']=preds[:,4]\nsubmission['Class_6']=preds[:,5]\nsubmission['Class_7']=preds[:,6]\nsubmission['Class_8']=preds[:,7]\nsubmission['Class_9']=preds[:,8]\nsubmission.head()","8ac68f95":"submission.to_csv('submission.csv')","73363eb8":"# Import Libraries","2a1915e7":"# AutoGluon Model","19c4a571":"# Preprocessing","f8aee0cb":"# Predict Model"}}