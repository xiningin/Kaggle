{"cell_type":{"9a3a0e8a":"code","dfb297b0":"code","be08e03f":"code","b979abd8":"code","dab38b62":"code","8ea6f9d8":"code","7f5496f5":"code","c98f0636":"code","9df90b34":"code","743dcf25":"code","a07b218f":"code","1b8b29d8":"code","baddc0bf":"code","a32a333c":"code","00b541bb":"code","948e405e":"markdown","7b34dc1e":"markdown","63d23eff":"markdown","c31477a5":"markdown","5db0586a":"markdown","2cdf4c2a":"markdown","d0b3e247":"markdown","abd1a4e3":"markdown","2c22af98":"markdown","d7c6d226":"markdown","c66b718d":"markdown","edde2bb5":"markdown","c5583ca8":"markdown","d6a3f5a1":"markdown","628103e3":"markdown","996d2727":"markdown"},"source":{"9a3a0e8a":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport cv2","dfb297b0":"train_meta = pd.read_csv('..\/input\/petfinder-pawpularity-score\/train.csv')\ntrain_meta.shape","be08e03f":"train_meta.head()","b979abd8":"sns.set_theme()\nplt.figure(figsize=(10,8))\ntrain_meta['Pawpularity'].hist(bins=20);","dab38b62":"train_meta['Pawpularity'].describe()","8ea6f9d8":"meta_labels = train_meta.columns.tolist()[1:-1]\n\nfig, axes = plt.subplots(4, 3, figsize=(30,30))\ncount = 0\nfor lab in meta_labels:\n    i, j = divmod(count, 3)\n    h = sns.histplot(data=train_meta, x=lab, stat='proportion', ax=axes[i,j])\n    h.set_xlabel(lab, fontsize=20)\n    h.set_ylabel(\"Proportion\", fontsize=20)\n    h.tick_params(labelsize=15)\n    count += 1","7f5496f5":"fig, axes = plt.subplots(4, 3, figsize=(50,50))\ncount = 0\nfor lab in meta_labels:\n    i, j = divmod(count, 3)\n    b = sns.boxplot(x=lab, y=\"Pawpularity\", data=train_meta, ax=axes[i,j])\n    b.set_xlabel(lab, fontsize=28)\n    b.set_ylabel(\"Pawpularity\", fontsize=28)\n    b.tick_params(labelsize=20)\n    count += 1","c98f0636":"plt.figure(figsize=(20,20))\nsns.set(font_scale=1.3)\nsns.heatmap(train_meta.drop('Id', axis=1).corr(), cmap='viridis', annot=True)\nplt.title('Correlation matrix');","9df90b34":"train_meta['collage_and_info'] = train_meta['Collage'] * train_meta['Info']\ntrain_meta['collage_or_info'] = train_meta['Collage'] + train_meta['Info']\ntrain_meta['occlusion_and_human'] = train_meta['Occlusion'] * train_meta['Human']\ntrain_meta['face_and_eyes'] = train_meta['Face'] * train_meta['Eyes']\ntrain_meta['not_blur_and_eyes'] = (1-train_meta['Blur']) * train_meta['Eyes']\ntrain_meta['not_blur_or_group_or_accessory'] = (1-train_meta['Blur']) + train_meta['Group'] + train_meta['Accessory']\ntrain_meta['not_collage_and_info_or_not_blur_or_group_or_accessory'] = (1-train_meta['Collage']*train_meta['Info']) + (1-train_meta['Blur']) + train_meta['Group'] + train_meta['Accessory']\nnew_feats = ['collage_and_info','collage_or_info','occlusion_and_human','face_and_eyes','not_blur_and_eyes',\n             'not_blur_or_group_or_accessory','not_collage_and_info_or_not_blur_or_group_or_accessory']\n\nplt.figure(figsize=(18,18))\nsns.set(font_scale=1.3)\nsns.heatmap(train_meta[new_feats+['Pawpularity']].corr(), cmap='viridis', annot=True)\nplt.title('Correlation matrix');","743dcf25":"def plot_images(df: pd.DataFrame, label: str):\n    plt.figure(figsize=(20, 50))\n    n_rows = min(50, df.shape[0])\n    \n    for i in range(n_rows):\n        row = df.iloc[i]\n        img_path = f\"..\/input\/petfinder-pawpularity-score\/train\/{row['Id']}.jpg\"\n        img = cv2.cvtColor(cv2.imread(img_path), cv2.COLOR_BGR2RGB)\n        plt.subplot(10, 5, i+1)\n        plt.title(f\"{label}: {row[label]}\")\n        plt.imshow(img)\n        plt.grid(False)\n        plt.axis('off')\n    plt.tight_layout()\n    plt.show()\n    plt.close()","a07b218f":"df = train_meta.loc[train_meta['Pawpularity'] < 5,:]\nplot_images(df, \"Pawpularity\")","1b8b29d8":"df = train_meta.loc[train_meta['Pawpularity'] > 95,:]\nplot_images(df, \"Pawpularity\")","baddc0bf":"df = train_meta.loc[train_meta['Accessory'] == 1,:]\nplot_images(df, \"Pawpularity\")","a32a333c":"df = train_meta.loc[train_meta['Face'] == 0,:]\nplot_images(df, \"Pawpularity\")","00b541bb":"df = train_meta.loc[train_meta['Collage'] == 1,:]\nplot_images(df, \"Pawpularity\")","948e405e":"## Correlation matrix","7b34dc1e":"**Takeaways**:\n* all the meta labels have a low correlation to Pawpularity\n* there are high correlations in the matrix that make sense\n    * `Occlusion` and `Human` have a relatively high correlation, which means that in many of the images, a human is blocking part of the pet\n    * `Collage` and `Info` have a relatively high correlation, which means that collage pictures often come with user-added texts\n    * `Face` and `Eyes`: decently clear face often comes with decently clear eyes in the picture","63d23eff":"## Pawpularity > 95","c31477a5":"# Meta labels\n\nAll of the meta labels are unbalanced.","5db0586a":"## Pawpularity vs meta labels","2cdf4c2a":"## New features","d0b3e247":"## Collage == 1","abd1a4e3":"* Focus - Pet stands out against uncluttered background, not too close \/ far.\n* Eyes - Both eyes are facing front or near-front, with at least 1 eye \/ pupil decently clear.\n* Face - Decently clear face, facing front or near-front.\n* Near - Single pet taking up significant portion of photo (roughly over 50% of photo width or height).\n* Action - Pet in the middle of an action (e.g., jumping).\n* Accessory - Accompanying physical or digital accessory \/ prop (i.e. toy, digital sticker), excluding collar and leash.\n* Group - More than 1 pet in the photo.\n* Collage - Digitally-retouched photo (i.e. with digital photo frame, combination of multiple photos).\n* Human - Human in the photo.\n* Occlusion - Specific undesirable objects blocking part of the pet (i.e. human, cage or fence). Note that not all blocking objects are considered occlusion.\n* Info - Custom-added text or labels (i.e. pet name, description).\n* Blur - Noticeably out of focus or noisy, especially for the pet\u2019s eyes and face. For Blur entries, \u201cEyes\u201d column is always set to 0.","2c22af98":"# Readin in the training data","d7c6d226":"# Pawpularity","c66b718d":"## Face == 0","edde2bb5":"**Takeaways**:\n* the distribution of Pawpularity is very similar in the two classes for the majority of the binary meta labels\n* Pawpularity of Blur==1 images seems to be lower than Blur==0 images","c5583ca8":"## Pawpularity < 5","d6a3f5a1":"# Images","628103e3":"## Distributions","996d2727":"## Accessory == 1"}}