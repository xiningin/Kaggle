{"cell_type":{"c9dfb65b":"code","5ae8f784":"code","3e1a90a5":"code","bba74aa3":"code","0456d0d8":"code","25d4b53d":"code","b32c7895":"code","8b9b20a5":"code","88c15ee7":"code","a84cc901":"code","5ef384c4":"code","c82c678a":"code","ac00656b":"code","054a3463":"code","0e222e84":"code","654585f9":"code","461d3594":"code","2fda5a95":"code","2598e182":"code","17a26a95":"code","e4944d9a":"code","2929bf40":"markdown","0aa1d0b8":"markdown","08b5d348":"markdown","8e4fd5d4":"markdown"},"source":{"c9dfb65b":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns","5ae8f784":"train = pd.read_csv('..\/input\/tabular-playground-series-jul-2021\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-jul-2021\/test.csv')\nsubmission = pd.read_csv('..\/input\/tabular-playground-series-jul-2021\/sample_submission.csv')","3e1a90a5":"train.info()","bba74aa3":"train.drop('date_time', axis=1, inplace=True)\ntest.drop('date_time', axis=1, inplace=True)","0456d0d8":"print(train.describe().T[['count', 'mean', 'std']])\nprint(train.describe().T[['min', '25%', '50%', '75%', 'max']])","25d4b53d":"corr = train.corr()\nmask = np.triu(np.ones_like(corr, dtype = bool))\n\nplt.figure(figsize=(10, 10))\nsns.heatmap(data=corr,\n            mask = mask,\n            annot=True,\n            cbar=False,\n            square=True,\n            cmap='coolwarm',\n            linewidths=1)\nplt.show()","b32c7895":"train.skew().sort_values(ascending=False)","8b9b20a5":"from sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import StandardScaler, PolynomialFeatures\nfrom sklearn.linear_model import Lasso\nfrom sklearn.model_selection import train_test_split, GridSearchCV, cross_val_score","88c15ee7":"targets = ['target_carbon_monoxide', 'target_benzene', 'target_nitrogen_oxides']","a84cc901":"y = train[targets]\nX = train.drop(targets, axis=1)","5ef384c4":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=1)","c82c678a":"pipe_input = [('scale', StandardScaler()),\n              ('model', Lasso())]\npipe = Pipeline(pipe_input)","ac00656b":"grid_params = [{}]","054a3463":"grid = GridSearchCV(estimator=pipe,\n                    param_grid=grid_params,\n                    scoring='neg_mean_absolute_error',\n                    n_jobs=-1,\n                    cv=5)","0e222e84":"grid.fit(X_train, y_train)","654585f9":"grid.best_params_","461d3594":"predictions = grid.predict(X_test)","2fda5a95":"cross_val_score(pipe, X, y, cv=5, scoring='neg_mean_absolute_error')","2598e182":"submission_preds = grid.predict(test)","17a26a95":"submission[targets[0]] = submission_preds[:, 0]\nsubmission[targets[1]] = submission_preds[:, 1]\nsubmission[targets[2]] = submission_preds[:, 2]","e4944d9a":"submission.to_csv(\"\/kaggle\/working\/submission.csv\", index=False)","2929bf40":"## Correlation Matrix","0aa1d0b8":"\u2705 There are no missing values.  \n\u2705 All variable types are correct.","08b5d348":"\ud83d\udccc There is some multicollinearity between the variables.","8e4fd5d4":"\ud83d\udccc Variables are in different ranges, especially the sensor data.  \n\ud83d\udccc Both 'target_carbon_monoxide' and 'target_benzene' have min values of 0.1."}}