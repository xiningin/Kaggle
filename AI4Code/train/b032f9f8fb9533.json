{"cell_type":{"29b10901":"code","f8b8e8be":"code","e441e497":"code","edceeeec":"code","14258176":"code","2f917e77":"code","16b3521c":"code","2ee031fc":"code","2357e38f":"code","fa3ab6c5":"code","4d29bc65":"code","c3e53e7d":"code","3565516e":"code","f1372acb":"code","d2f72e15":"code","1de924c4":"code","090c4056":"code","2c267778":"code","503dea5e":"code","9789c8ec":"code","63ce58af":"code","81d3cd35":"code","82f4afee":"code","645e0858":"code","a9166e83":"code","c5459ebe":"code","abb324cb":"code","db688e81":"code","30c31aa4":"code","1e8e901b":"code","232d36d3":"code","cc0bb597":"code","eea12a9f":"code","c84e6366":"code","f3ee62e3":"code","d0c90ab2":"code","bf405304":"code","c3333058":"code","46844344":"code","72453307":"code","97c93a8a":"code","8c0920c6":"markdown","ff4f6262":"markdown","48656ca5":"markdown","34460dc9":"markdown","4926f206":"markdown","bc6f403d":"markdown","6956b911":"markdown","a51e39dd":"markdown","7795f020":"markdown","effca122":"markdown","6ecf7a70":"markdown","a62caf6a":"markdown","d9e64567":"markdown","eefb3a63":"markdown","6b39d445":"markdown","6e2f7682":"markdown","949ee3b9":"markdown","a0d0071d":"markdown","02752adb":"markdown","65265e55":"markdown","da59f10d":"markdown","10f8a67a":"markdown","fa48a6b1":"markdown","c09d9fe8":"markdown","12052c0a":"markdown","f930f69d":"markdown"},"source":{"29b10901":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","f8b8e8be":"data = pd.read_csv(\"..\/input\/insurance\/insurance.csv\")","e441e497":"data.head()","edceeeec":"len(data)","14258176":"data.info()","2f917e77":"data.describe()","16b3521c":"plt.figure(figsize=(12,7))\nsns.pairplot(data)","2ee031fc":"data[\"sex\"].value_counts(normalize=True)*100","2357e38f":"data[\"sex\"] = data[\"sex\"].map({\"male\": 1, \"female\": 0})","fa3ab6c5":"data[\"sex\"].value_counts()","4d29bc65":"data.select_dtypes(object).columns","c3e53e7d":"data[\"smoker\"].value_counts()","3565516e":"data[\"smoker\"] = data[\"smoker\"].map({\"yes\": 1, \"no\": 0})","f1372acb":"data[\"smoker\"].value_counts(normalize=True)*100","d2f72e15":"plt.figure(figsize=(12,7))\nsns.set_context(\"paper\", font_scale=1.5)\nsns.countplot(x=\"sex\", color=\"pink\", data=data, hue=\"smoker\")\nplt.title(\"Number of Smokers in Gender\")\nplt.xlabel(\"Gender\")\nplt.ylabel(\"Number of People\")","1de924c4":"gender_gb = data.groupby(\"sex\")[\"smoker\"].value_counts(normalize=True)*100\ngender_gb ","090c4056":"data[\"region\"].value_counts()","2c267778":"region_dummy = pd.get_dummies(data[\"region\"], prefix=\"region_\", drop_first=True, dtype=int)\nregion_dummy","503dea5e":"data = pd.concat([data, region_dummy], axis=1)\ndata = data.drop(\"region\", axis=1)","9789c8ec":"data.head()","63ce58af":"data[\"charges\"].describe()","81d3cd35":"plt.figure(figsize=(12,7))\nsns.distplot(x=data[\"charges\"], bins=30, color=\"seagreen\")","82f4afee":"data.info()","645e0858":"from sklearn.preprocessing import MinMaxScaler","a9166e83":"scaler = MinMaxScaler()","c5459ebe":"X = data.drop(\"charges\", axis=1)\ny = data[\"charges\"]","abb324cb":"from sklearn.model_selection import train_test_split","db688e81":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)","30c31aa4":"scaled_data = scaler.fit_transform(X_train, y_train)\nscaled_test = scaler.transform(X_test)","1e8e901b":"from sklearn.linear_model import LinearRegression","232d36d3":"linear_model = LinearRegression()","cc0bb597":"linear_model.fit(X_train, y_train)","eea12a9f":"linear_predict = linear_model.predict(X_test)","c84e6366":"from sklearn import metrics","f3ee62e3":"print(\"Mean Absolute Error: \", metrics.mean_absolute_error(y_test, linear_predict))\nprint(\"Mean Squared Error: \", metrics.mean_squared_error(y_test, linear_predict))\nprint(\"Root Mean Squared Error: \", np.sqrt(metrics.mean_squared_error(y_test, linear_predict)))","d0c90ab2":"plt.figure(figsize=(12,7))\nsns.set_context(\"paper\", font_scale=1)\nsns.scatterplot(x=y_test, y=linear_predict)\nplt.xlabel(\"Charges\")\nplt.ylabel(\"Prediction\")","bf405304":"plt.figure(figsize=(15,8))\nsns.set_context(\"paper\", font_scale=1.5)\nsns.kdeplot(x=y_test, y=linear_predict, fill=True, color=\"red\")\nplt.xlabel(\"Charges\")\nplt.ylabel(\"Prediction\")","c3333058":"print(\"Metrics Variance Score:\", metrics.explained_variance_score(y_test, linear_predict))","46844344":"plt.figure(figsize=(12,5))\nsns.set_context(\"paper\", font_scale=1.5)\nsns.distplot(x=y_test-linear_predict, bins=10, color=\"red\")\nplt.title(\"Residual: Y_test - Prediction\")","72453307":"linear_model.coef_","97c93a8a":"linear_coef = pd.DataFrame(linear_model.coef_, X.columns, columns=[\"Coefficient\"])\nlinear_coef.sort_values(\"Coefficient\", ascending=False)","8c0920c6":"### This is a relatively small dataset with only ~1300 observations. Noted that we have a mixture of datatypes to work on.","ff4f6262":"### Creating variables for X and y. The data is ready for to be split for train and test set. ","48656ca5":"### About 23% are male smokers and 17% are female. ","34460dc9":"### After prediction is complete, it is time to evaluate the model. ","4926f206":"### Setting up the features' coefficients. ","bc6f403d":"### The gender feature is ~50%, which does not explain a whole lot. Noted that this feature is object data type. Will map this into a binary classification. ","6956b911":"### Importing the linear regression from the sklearn library. The scaled data will be fit to the model. ","a51e39dd":"### The test size will be set as 30% as usual. The random_state will be used and set at 42, which is arbitrary, so the random sample will be the same each time. ","7795f020":"### Features, such as smoker and region also are object data type. Similarly, it will be converted into binary classification. ","effca122":"### It is time to dive into the \"charges\" feature. Recalling the mean, std, and max values have large gaps. This is visualized using a simple distplot. ","6ecf7a70":"# Potential Impact\n### As a consumer, it is beneficial to understand which factor carries more weight and have more impact on the charges. This can help patients to make informed decision. As for insurance companies, it helps to have a deeper understand their target audience and improve strategy on policy\/coverage. Knowledge on specific population can help identify potential opportunities, such as population health, preventive health measures promotion, and so forth. This ultimately can have a positive impact on profitability. ","a62caf6a":"### Noted that regions have 4 variables. These will be converted into numeric classes using dummies technique. ","d9e64567":"### Importing libraries","eefb3a63":"# Process:\n### The project will start off with basic descriptive analysis, followed by detailed exploratory data analysis, data visualization on features, and data cleansing. The cleansed data will be scaled and fit to the model. Evaluation of the model included MAE, MSE, and RMSE. Last, a basic description of the coefficient as conclusion. ","6b39d445":"# Exploratory Data Analysis\n### A quick way to visualize the correlation between features. ","6e2f7682":"### Dropping the original \"region\" feature since feature-engineering completed. ","949ee3b9":"# Description:\n###  It is no surprise that healthcare insurance is expensive. It is the public perception that the rate\/charges is determined by many factors, such as age, gender, smoking status, occupation, and so forth. It is essential to understand what factors affect the rates\/charges to make informed decision. ","a0d0071d":"### Diving into features","02752adb":"### The data is scaled using the MinMaxScaler. Noted that fit_transform is not used on X_test to prevent leakage.","65265e55":"### Preparing to scale the data using MinMaxScaler from sklearn library","da59f10d":"### Given others are constant, the charges will increase by ~$23600 for every 1 unit inncrease in smoker. \n### The second most important factor is children, followed BMI and age. Apparently, gender does not affect much. \n### As expected, the model describes that smoker plays an important factor in determining the insurance charges. ","10f8a67a":"### Our model's performance is evaluated by MAE, MSE, and RMSE. Recall that the charges mean is ~13000 and std deviation ~12000. The scatterplot below shows our model's prediction against the actual charges. It shows a linear relationship with lots of noise, likely due to outliers and extreme values in charges. From the graph, it is reasonable to describe that the model does not do well in predicting outliers and extreme values. ","fa48a6b1":"### The following is basic yet important information on the dataset. Noted that the feature \"charges\" will be our y-variable. The min value is only ~1200 and max at ~63000 with std deviation ~12000. This data has extreme valuee that could affect the model later on. ","c09d9fe8":"### About 20% of the people are smokers. ","12052c0a":"# Linear Regression as Predictive Model for Healthcare Insurance","f930f69d":"# Project Objective:\n### This interesting project will use linear regression model in the sklearn library to predict the charges. Thus, the target feature or y-variable is \"charges\"."}}