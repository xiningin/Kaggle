{"cell_type":{"06e88d5f":"code","32b11368":"code","be753f9f":"code","ada7a5ce":"code","fb951e8b":"code","a2962756":"code","8f2604f2":"code","bc8d8a5a":"code","f6e7ecbf":"code","c2a85d65":"code","b2056fbe":"code","c9c1b269":"code","8f8dfef6":"code","eff8ed4d":"code","7e8bf2ca":"code","237344f1":"code","92e1ad96":"code","51f30861":"code","1b2c44e0":"code","60ac3e9c":"code","c5ef9d68":"code","5d73d10f":"code","ce996f5c":"code","5eaeee30":"code","c5d4ac7e":"code","0805a9cb":"code","29be70b4":"code","a7137ed9":"markdown","6e2b80bc":"markdown","29f13260":"markdown","b56b8e62":"markdown","e5270735":"markdown"},"source":{"06e88d5f":"import pandas as pd\nimport numpy as np\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport seaborn as sns\n\nfrom sklearn.metrics import accuracy_score, confusion_matrix\nfrom sklearn.ensemble import RandomForestClassifier, ExtraTreesClassifier #for feature selection","32b11368":"df = pd.read_csv('..\/input\/creditcardfraud\/creditcard.csv')","be753f9f":"df.head()","ada7a5ce":"df.shape","fb951e8b":"df.info()","a2962756":"df.describe()","8f2604f2":"df.columns","bc8d8a5a":"df.Class.value_counts()","f6e7ecbf":"plt.figure(figsize = (25,25))\nsns.heatmap(df.corr(), annot = True, cmap = 'Greens')","c2a85d65":"pip install imbalanced-learn ","b2056fbe":"from imblearn.over_sampling import SMOTE","c9c1b269":"x = df.drop('Class', axis = 'columns')\ny = df['Class']","8f8dfef6":"smote = SMOTE(sampling_strategy = 'minority')\nx_sm, y_sm = smote.fit_resample(x,y)\n\ny_sm.value_counts()","eff8ed4d":"model = ExtraTreesClassifier()\nmodel.fit(x_sm, y_sm)","7e8bf2ca":"model.feature_importances_","237344f1":"plt.figure(figsize = (10,10))\nfeat = pd.Series(model.feature_importances_, index = x_sm.columns)\nfeat.nlargest(18).plot(kind = 'barh')","92e1ad96":"plot = feat.nlargest(18)","51f30861":"plot.index","1b2c44e0":"cols = ['V14', 'V11', 'V12', 'V17', 'V4', 'V10', 'V3', 'V16', 'V18', 'V9', 'V1',\n       'V2', 'V7', 'V19', 'Time', 'V8', 'V21', 'V13']","60ac3e9c":"x_new = x_sm[cols]","c5ef9d68":"x_sm.shape","5d73d10f":"x_new.shape","ce996f5c":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(x_new, y_sm, test_size = 0.2, random_state = 42)","5eaeee30":"randomf = RandomForestClassifier()","c5d4ac7e":"randomf.fit(X_train, y_train)","0805a9cb":"y_pred = randomf.predict(X_test)","29be70b4":"accuracy_score(y_test, y_pred)","a7137ed9":"# Train Test Split","6e2b80bc":"# Feature Selection\/Feature Importance","29f13260":"# Credit Card Fraud Detection","b56b8e62":"Steps\n1. Import libraries\n2. Import the datase\n3. Perform data analysis (data cleaning, data  manipulation, data visualization, EDA)\n4. Data Preprocessing - feature engineering (encoders, scaling, feature selection, hyper-parameter tuning)\n5. Splitting the dataset \n6. Model selection\n7. Train the model\n8. Test the model\n9. Performance metric","e5270735":"# Handling imbalanced dataset"}}