{"cell_type":{"4d2f75eb":"code","66236eb9":"code","bef07dfe":"code","1519fa3f":"code","77404e4b":"code","7ee8f264":"code","79d1c209":"code","9bc73cf3":"code","333524a3":"code","bdda42db":"code","6282d0a7":"code","3648c414":"code","5139bf8e":"code","1371d687":"code","d0b29720":"code","38d6fc72":"code","f7081ca4":"code","6c8ec1ad":"code","f0421474":"code","1aa6a450":"code","0ed6827f":"code","c89da9ee":"code","81b29448":"code","9e0e69d0":"code","b99bace8":"code","17ab6163":"code","bc082642":"code","8ec8c5ec":"code","7c724344":"code","dcdddcbb":"code","30ed9df9":"code","f3c54a90":"code","8a4d5870":"code","6120e029":"code","5c2ff854":"code","367e0287":"code","375643be":"code","ae26d4f2":"code","b81d412a":"code","2ef59020":"code","50624a49":"code","55021873":"markdown","177e0e97":"markdown","7146e28e":"markdown"},"source":{"4d2f75eb":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","66236eb9":"import seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings(\"ignore\")\ntrain = pd.read_csv('..\/input\/work-hour-prediction-challenge\/train.csv')\ntest = pd.read_csv(\"\/kaggle\/input\/work-hour-prediction-challenge\/test.csv\")\ntrain.head()","bef07dfe":"train.info()","1519fa3f":"train.describe()","77404e4b":"train.nunique().sort_values(ascending=False)","7ee8f264":"cat = train.select_dtypes(include=['object'])\ncat.nunique().sort_values(ascending=False)","79d1c209":"num_data_train=train.select_dtypes(include=np.number)","9bc73cf3":"for i in num_data_train.columns:\n    sns.boxplot(num_data_train[i])\n    plt.show()","333524a3":"for i in num_data_train.columns:\n    q3=num_data_train[i].quantile(0.75)\n    q1=num_data_train[i].quantile(0.25)\n    iqr=q3-q1\n    ub=q3+1.5*iqr\n    lb=q1-1.5*iqr\n    uc=num_data_train[i].quantile(0.99)\n    lc=num_data_train[i].quantile(0.01)\n    for val in num_data_train[i].index:\n        if num_data_train.loc[val,i]>ub:\n            num_data_train.loc[val,i]=uc\n        if num_data_train.loc[val,i]<lb:\n            num_data_train.loc[val,i]=lc","bdda42db":"# After removing outliers\nfor i in num_data_train.columns:\n    sns.boxplot(num_data_train[i])\n    plt.show()","6282d0a7":"num_data_test=test.select_dtypes(include=np.number)","3648c414":"for i in num_data_test.columns:\n    q3=num_data_test[i].quantile(0.75)\n    q1=num_data_test[i].quantile(0.25)\n    iqr=q3-q1\n    ub=q3+1.5*iqr\n    lb=q1-1.5*iqr\n    uc=num_data_test[i].quantile(0.99)\n    lc=num_data_test[i].quantile(0.01)\n    for val in num_data_test[i].index:\n        if num_data_test.loc[val,i]>ub:\n            num_data_test.loc[val,i]=uc\n        if num_data_test.loc[val,i]<lb:\n            num_data_test.loc[val,i]=lc","5139bf8e":"cat_data_train=train.select_dtypes(include=np.object)\ncat_data_test=test.select_dtypes(include=np.object)","1371d687":"concat_data_train = pd.concat([num_data_train,cat_data_train],axis=1)\nconcat_data_test = pd.concat([num_data_test,cat_data_test],axis=1)","d0b29720":"concat_data_test.head()","38d6fc72":"from pandas_profiling import ProfileReport\nProfileReport(concat_data_train, title=\"EDA Report\")","f7081ca4":"train.columns","6c8ec1ad":"!pip install pycaret","f0421474":"concat_data_train = concat_data_train.replace({'income' : { ' <=50K' : 'less than or equal to 50K', ' >50K' :  'more than 50K' }})\nconcat_data_train.income.unique()","1aa6a450":"from pycaret.regression import *","0ed6827f":"concat_data_train.head(2)","c89da9ee":"concat_data_train.info()","81b29448":"exp = setup(data = concat_data_train, target = 'hours-per-week', normalize = True, transformation = True, log_experiment = True,\n            remove_multicollinearity = True, #drop one of the two features that are highly correlated with each other\n            transform_target = True,combine_rare_levels = True, \n            ignore_low_variance = True, normalize_method='robust',train_size = 0.8,\n            handle_unknown_categorical = True, \n            unknown_categorical_method = 'most_frequent',\n            ordinal_features = {'income' : ['less than or equal to 50K','more than 50K']},\n            categorical_features = ['workclass','education','marital-status','occupation','relationship',\n                       'race','sex','native-country','income'],\n           numeric_features=['age','fnlwgt','education-num','capital-gain','capital-loss'],\n           high_cardinality_features = ['native-country','occupation','education']\n          )","9e0e69d0":"compare_models(exclude=['ransac','knn'])","b99bace8":"gbr = create_model('gbr')","17ab6163":"concat_data_test.drop('hours-per-week',1,inplace=True)","bc082642":"prediction = predict_model(gbr, concat_data_test)","8ec8c5ec":"prediction.head()","7c724344":"sample = pd.read_csv(\"\/kaggle\/input\/work-hour-prediction-challenge\/submission.csv\")\nsample['hours-per-week'] = prediction['Label']","dcdddcbb":"sample.head()","30ed9df9":"sample.to_csv(\"gbr.csv\",index=False)","f3c54a90":"import h2o\nfrom h2o.automl import H2OAutoML\nh2o.init()","8a4d5870":"h2_train = h2o.import_file('..\/input\/work-hour-prediction-challenge\/train.csv')\nh2_test = h2o.import_file(\"\/kaggle\/input\/work-hour-prediction-challenge\/test.csv\")","6120e029":"h2_train.describe()","5c2ff854":"y= 'hours-per-week'","367e0287":"splits = h2_train.split_frame(ratios = [0.8], seed = 1)\ntrain = splits[0]\ntest = splits[1]","375643be":"aml = H2OAutoML(max_runtime_secs = 60, seed = 1, project_name = \"workhour\")\naml.train(y = y, training_frame = train, leaderboard_frame = test)","ae26d4f2":"aml2 = H2OAutoML(max_runtime_secs = 60, seed = 1, project_name = \"powerplant_full_data\")\naml2.train(y = y, training_frame = h2_train)","b81d412a":"aml.leaderboard.head()","2ef59020":"aml2.leaderboard.head()","50624a49":"sample['hours-per-week'] = pred['predict']","55021873":"**Conclusions from above Report:**\n* 'age', 'fnlwgt', 'education-num', 'capital-gain', 'capital-loss', and other features are highly correlated to other features of Data.\n* capital-gain has 4.6% of zeros.","177e0e97":"Using H2o AutoML","7146e28e":"**Import Libraries**"}}