{"cell_type":{"c7213a38":"code","c5f1f643":"code","703aaa4b":"code","838c3a6a":"code","9d80c4ff":"code","541918db":"code","d38931c0":"code","837336be":"code","40bb614c":"code","3880a527":"code","7483f097":"code","842331c3":"code","a9c488f3":"code","2006e23f":"code","b544d646":"code","43c76be9":"code","387b6dfe":"code","079ebfa7":"code","4fa161d4":"code","81f5bd5e":"code","6cf44ffa":"code","23a1d3ad":"code","06faf277":"markdown","0c55a403":"markdown","3ede015b":"markdown","a1c57967":"markdown","989b768e":"markdown","fe926027":"markdown","dd5695fb":"markdown","e9ef20a4":"markdown","84bf6aad":"markdown"},"source":{"c7213a38":"import sys\n!{sys.executable} -m pip install bar_chart_race","c5f1f643":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nimport seaborn as sns\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport datetime as datetime\nfrom datetime import timedelta\nfrom plotly.subplots import make_subplots\nimport bar_chart_race as bcr\nfrom IPython.display import HTML\nimport warnings\nwarnings.filterwarnings(\"ignore\")\nfrom IPython.display import Video\nfrom tqdm import tqdm","703aaa4b":"data = pd.read_csv('..\/input\/covid19-variants\/covid-variants.csv')\ndata","838c3a6a":"data.columns","9d80c4ff":"data2=data[['date','variant','location','perc_sequences']].copy()\ndata2","541918db":"print(data2.variant.unique())\nprint(data2.location.unique())","d38931c0":"data2[\"date\"]=data2[\"date\"].apply(pd.to_datetime, dayfirst=True)\ndata2=data2.fillna(0)","837336be":"data3=data2[data2['date']>data2['date'].max()-datetime.timedelta(days=15)][data2['variant']=='Omicron'].groupby('location',as_index=False).max().sort_values('perc_sequences',ascending=False)\ndata3[0:40]","40bb614c":"fig = px.bar(data3[0:40], x='location', y='perc_sequences',title=\"The latest ranknig of Omicron perc_sequences\")\nfig.show()","3880a527":"data4=data2[data2['variant']=='Omicron'][data2['date']>'2021-11-14'].sort_values('date',ascending=True)\ncountries=['Australia','Canada','France','Denmark','Russia','New Zealand']","7483f097":"fig=make_subplots(specs=[[{\"secondary_y\":False}]])\nfig.add_trace(go.Scatter(x=data4['date'][data4['location']==countries[0]],y=data4[data4['location']==countries[0]]['perc_sequences'],name=countries[0]),secondary_y=False,)\nfig.add_trace(go.Scatter(x=data4['date'][data4['location']==countries[1]],y=data4[data4['location']==countries[1]]['perc_sequences'],name=countries[1]),secondary_y=False,)\nfig.add_trace(go.Scatter(x=data4['date'][data4['location']==countries[2]],y=data4[data4['location']==countries[2]]['perc_sequences'],name=countries[2]),secondary_y=False,)\nfig.add_trace(go.Scatter(x=data4['date'][data4['location']==countries[3]],y=data4[data4['location']==countries[3]]['perc_sequences'],name=countries[3]),secondary_y=False,)\nfig.add_trace(go.Scatter(x=data4['date'][data4['location']==countries[4]],y=data4[data4['location']==countries[4]]['perc_sequences'],name=countries[4]),secondary_y=False,)\nfig.add_trace(go.Scatter(x=data4['date'][data4['location']==countries[5]],y=data4[data4['location']==countries[5]]['perc_sequences'],name=countries[5]),secondary_y=False,)\n\nfig.update_layout(autosize=False,width=700,height=500,title_text=\"Omicron perc_sequences by country\")\nfig.update_xaxes(title_text=\"Date\")\nfig.update_yaxes(title_text=\"perc_sequences\",secondary_y=False)\nfig.show()","842331c3":"data3au=data2[data2.location=='Australia']\ndata3ca=data2[data2.location=='Canada']\ndata3fr=data2[data2.location=='France']\ndata3dn=data2[data2.location=='Denmark']\ndata3ru=data2[data2.location=='Russia']\ndata3nz=data2[data2.location=='New Zealand']","a9c488f3":"# set double indexes and unstack!!!\ndata4au=data3au.set_index(['date','variant']).unstack()['perc_sequences']\ndata4ca=data3ca.set_index(['date','variant']).unstack()['perc_sequences']\ndata4fr=data3fr.set_index(['date','variant']).unstack()['perc_sequences']\ndata4dn=data3dn.set_index(['date','variant']).unstack()['perc_sequences']\ndata4ru=data3ru.set_index(['date','variant']).unstack()['perc_sequences']\ndata4nz=data3nz.set_index(['date','variant']).unstack()['perc_sequences']","2006e23f":"dataset=[data4au,data4ca,data4fr,data4dn,data4ru,data4nz]","b544d646":"def make_bcr(df,name):\n    bcr.bar_chart_race(\n        df=df,\n        filename='BCR_CovidVariants_'+name+'.mp4',\n        orientation='h',\n        sort='desc',\n        n_bars=5,\n        fixed_order=False,\n        fixed_max=False,\n        steps_per_period=10,\n        interpolate_period=False,\n        label_bars=True,\n        bar_size=.95,\n        period_label={'x': .99, 'y': .25, 'ha': 'right', 'va': 'center'},\n        #period_fmt='%B %d, %Y',\n        period_summary_func=lambda v, r: {'x': .99, 'y': .18,'s': '',\n                                          'ha': 'right', 'size': 8, 'family': 'Courier New'},\n        #perpendicular_bar_func='median',\n        period_length=1000,\n        figsize=(5,3),\n        dpi=500,\n        cmap='dark24',\n        title='Covid Variants in '+name,\n        title_size=10,\n        bar_label_size=7,\n        tick_label_size=5,\n        shared_fontdict={'color' : '.1'},\n        scale='linear',\n        writer=None,\n        fig=None,\n        bar_kwargs={'alpha': .7},\n        filter_column_colors=True)","43c76be9":"for i in tqdm(range(6)):\n    make_bcr(dataset[i],countries[i])","387b6dfe":"Video(\"\/kaggle\/working\/BCR_CovidVariants_\"+countries[0]+\".mp4\", width=600, height=400, embed=True)","079ebfa7":"Video(\"\/kaggle\/working\/BCR_CovidVariants_\"+countries[1]+\".mp4\", width=600, height=400, embed=True)","4fa161d4":"Video(\"\/kaggle\/working\/BCR_CovidVariants_\"+countries[2]+\".mp4\", width=600, height=400, embed=True)","81f5bd5e":"Video(\"\/kaggle\/working\/BCR_CovidVariants_\"+countries[3]+\".mp4\", width=600, height=400, embed=True)","6cf44ffa":"Video(\"\/kaggle\/working\/BCR_CovidVariants_\"+countries[4]+\".mp4\", width=600, height=400, embed=True)","23a1d3ad":"Video(\"\/kaggle\/working\/BCR_CovidVariants_\"+countries[5]+\".mp4\", width=600, height=400, embed=True)","06faf277":"# Dataframe for Bar Chart Race","0c55a403":"# Create Bar Chart Race\n","3ede015b":"# The latest ranknig of Omicron perc_sequences","a1c57967":"On 26 November 2021, WHO designated the variant B.1.1.529 a variant of concern, named Omicron, on the advice of WHO\u2019s Technical Advisory Group on Virus Evolution (TAG-VE).  This decision was based on the evidence presented to the TAG-VE that Omicron has several mutations that may have an impact on how it behaves, for example, on how easily it spreads or the severity of illness it causes. Here is a summary of what is currently known.  <br\/>\nhttps:\/\/www.who.int\/news\/item\/28-11-2021-update-on-omicron","989b768e":"# Variants of Concern synonyms\nhttps:\/\/covariants.org\/\n\n* omicron: B.1.1.529\n* alpha: B.1.1.7 \n* beta: B.1.351 \n* gammma: P.1 \n* delta: B.1.617.2 \n* kappa: B.1.617.1 \n* epsilon: B.1.427, B.1.429\n* eta: B.1.525 \n* iota: B.1.526\n* lambda: C.37\n* mu: B.1.621","fe926027":"# Data preparation","dd5695fb":"# Omicron perc_sequences change in 6 countries","e9ef20a4":"# Bar Chart Race of World Covid19 Variant \"Omicron\"\nhttps:\/\/www.kaggle.com\/stpeteishii\/bar-chart-race2-of-world-covid19-variant-omicron<br\/>\nThis notebook is a copy of the following noteboook.<br\/>\nhttps:\/\/www.kaggle.com\/stpeteishii\/bar-chart-race-of-world-covid19-variant-omicron\n<div align=\"left\">\n<img src=\"https:\/\/img.shields.io\/badge\/Upvote-If%20you%20like%20my%20work-07b3c8?style=for-the-badge&logo=kaggle\" alt=\"upvote\">\n<\/div>","84bf6aad":"# Omicron is spreading all over the world!"}}