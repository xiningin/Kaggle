{"cell_type":{"d7d57a21":"code","808726e4":"code","98a29e79":"code","1db13a81":"code","00c123a3":"code","bb22ac3a":"code","c29a0d80":"code","7c9c4be5":"code","c12ef48a":"code","1d906d32":"code","38892ff3":"code","21b8c464":"code","709723c7":"code","a7703c42":"code","6f6370d8":"code","ea5d7e59":"code","57fbd37d":"code","1e42fee4":"code","8cc8e5a6":"code","ca270900":"code","9bf1162e":"code","60a29f1c":"code","f0e72125":"code","3981dc05":"code","72a250a7":"code","f5b33a85":"code","bc43e156":"code","8de5c38f":"code","5a33b0f3":"code","3e214195":"code","5153f9ee":"code","50f5cfe7":"code","1c0ceb89":"code","c06d839e":"code","34b9353c":"code","fa9bc39b":"code","558b1a12":"code","a9d68aeb":"code","ffb424bf":"code","fd6e3df9":"code","0574189c":"code","6e541ecc":"code","d9575e77":"code","17e9ed91":"code","d09b503e":"code","4c3ec470":"code","e281e864":"code","bf1ca80d":"code","1d3efc8c":"code","bb7176b3":"code","c7e9583c":"code","90b453db":"code","1c79cef9":"code","26603065":"code","6747345a":"code","8fd3ce3f":"markdown","ad821678":"markdown","1c6d9fa4":"markdown","0f89fab0":"markdown","f38a2c4c":"markdown","88904484":"markdown","10b357fe":"markdown","19ceeb97":"markdown","3d2796ef":"markdown","79da0e25":"markdown","a52d6d76":"markdown","98283507":"markdown","5d685565":"markdown","e370783e":"markdown","c60806dd":"markdown","4a5fe707":"markdown","dbb5d5fd":"markdown","259f0b6f":"markdown","eac16906":"markdown","dd8739b5":"markdown","2cf3afc1":"markdown","d02a0f27":"markdown","04fbd020":"markdown","fc960043":"markdown"},"source":{"d7d57a21":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, \\\nroc_auc_score, classification_report, confusion_matrix, plot_roc_curve\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import RobustScaler,MinMaxScaler\nimport matplotlib.pyplot as plt","808726e4":"pd.set_option('display.max_columns', None)\npd.set_option('display.max_rows', 40)\npd.set_option('display.float_format', lambda x: '%.3f' % x)\npd.set_option('display.width', 170)","98a29e79":"df=pd.read_csv(\"..\/input\/diabetes-data-set\/diabetes.csv\")","1db13a81":"df.head()","00c123a3":"df.isnull().sum()","bb22ac3a":"df[[\"Glucose\",\"BloodPressure\",\"SkinThickness\",\"Insulin\",\"BMI\"]] = df[[\"Glucose\",\"BloodPressure\",\"SkinThickness\",\"Insulin\",\"BMI\"]].replace(0,np.NaN)","c29a0d80":"df.isnull().sum()","7c9c4be5":"df.shape","c12ef48a":"df.head()","1d906d32":"dft=df.iloc[:,:8]","38892ff3":"from sklearn.impute import KNNImputer\nscaler = RobustScaler()\ndff = pd.DataFrame(scaler.fit_transform(dft), columns=dft.columns)\ndff.head()","21b8c464":"imputer = KNNImputer(n_neighbors=3)\ndff = pd.DataFrame(imputer.fit_transform(dff), columns=dff.columns)\ndff.head()\ndff.isnull().sum()","709723c7":"df_y= pd.DataFrame(scaler.inverse_transform(dff), columns=dff.columns)","a7703c42":"df_y.head()","6f6370d8":"df_y[\"Outcome\"]=df[\"Outcome\"].values","ea5d7e59":"df_y","57fbd37d":"df=df_y.copy()","1e42fee4":"df.head()","8cc8e5a6":"def grab_col_names(dataframe, cat_th=10, car_th=20):\n    # cat_cols, cat_but_car\n    cat_cols = [col for col in dataframe.columns if dataframe[col].dtypes == \"O\"]\n    num_but_cat = [col for col in dataframe.columns if dataframe[col].nunique() < cat_th and\n                   dataframe[col].dtypes != \"O\"]\n    cat_but_car = [col for col in dataframe.columns if dataframe[col].nunique() > car_th and\n                   dataframe[col].dtypes == \"O\"]\n    cat_cols = cat_cols + num_but_cat\n    cat_cols = [col for col in cat_cols if col not in cat_but_car]\n\n    # num_cols\n    num_cols = [col for col in dataframe.columns if dataframe[col].dtypes != \"O\"]\n    num_cols = [col for col in num_cols if col not in num_but_cat]\n\n    print(f\"Observations: {dataframe.shape[0]}\")\n    print(f\"Variables: {dataframe.shape[1]}\")\n    print(f'cat_cols: {len(cat_cols)}')\n    print(f'num_cols: {len(num_cols)}')\n    print(f'cat_but_car: {len(cat_but_car)}')\n    print(f'num_but_cat: {len(num_but_cat)}')\n    return cat_cols, num_cols, cat_but_car","ca270900":"cat_cols, num_cols, cat_but_car = grab_col_names(df)","9bf1162e":"df.describe().T","60a29f1c":"df[\"Age\"].describe()","f0e72125":"df.loc[(df[\"Age\"]<30),\"new_Age\"]=\"young\"\ndf.loc[(df[\"Age\"]>=30) & (df[\"Age\"] <46),\"new_Age\"]=\"mature\"\ndf.loc[(df[\"Age\"]>=46),\"new_Age\"]=\"grownup+\"","3981dc05":"df[\"Gli_risk\"]=[1 if i>140 else 0 for i in df[\"Glucose\"]]","72a250a7":"df.loc[(df[\"Outcome\"] == 1),\"SkinThickness\"].sort_values(ascending=False).describe().T","f5b33a85":"df[\"DiabetesPedigreeFunction\"].describe()","bc43e156":"df.loc[df[\"DiabetesPedigreeFunction\"]<0.33,\"Genetics_risk\"]=\"low\"\ndf.loc[(df[\"DiabetesPedigreeFunction\"]>=0.33) & (df[\"DiabetesPedigreeFunction\"]<0.66),\"Genetics_risk\"]=\"high\"\ndf.loc[(df[\"DiabetesPedigreeFunction\"]>=0.66),\"Genetics_risk\"]=\"very high\"","8de5c38f":"df.loc[(df[\"BMI\"]<30),\"BMI_risk\"]=\"low\"\ndf.loc[(df[\"BMI\"]>=30) & (df[\"BMI\"]<35),\"BMI_risk\"]=\"high\"\ndf.loc[(df[\"BMI\"]>=35),\"BMI_risk\"]=\"very high\"","5a33b0f3":"df[\"Pregnancies\"].nunique()","3e214195":"df[\"Pregnancies\"].unique()","5153f9ee":"df[\"BloodPressure_risk\"]=[1 if i>90 else 0 for i in df[\"BloodPressure\"]]","50f5cfe7":"df[df[\"Insulin\"]>400][[\"Insulin\",\"Outcome\"]]","1c0ceb89":"df.loc[df[\"Insulin\"]>400,\"Ins_risk\"]=\"very high\"\ndf.loc[(df[\"Insulin\"]<=400) & (df[\"Insulin\"]>200),\"Ins_risk\"]=\"high\"\ndf.loc[(df[\"Insulin\"]<=200),\"Ins_risk\"]=\"usual\"","c06d839e":"cat_cols, num_cols, cat_but_car = grab_col_names(df)\nbinary_cols = [col for col in df.columns if df[col].dtype not in [int, float]\n               and df[col].nunique() == 2]","34b9353c":"for i in binary_cols:\n    df[i] = labelencoder.fit_transform(df[i])","fa9bc39b":"ohe_cols = [col for col in df.columns if 10 >= df[col].nunique() > 2]","558b1a12":"df=pd.get_dummies(df, columns=ohe_cols, drop_first=True)","a9d68aeb":"def rare_encoder(dataframe, rare_perc):\n    temp_df = dataframe.copy()\n\n    rare_columns = [col for col in temp_df.columns if temp_df[col].dtypes == 'O'\n                    and (temp_df[col].value_counts() \/ len(temp_df) < rare_perc).any(axis=None)]\n\n    for var in rare_columns:\n        tmp = temp_df[var].value_counts() \/ len(temp_df)\n        rare_labels = tmp[tmp < rare_perc].index\n        temp_df[var] = np.where(temp_df[var].isin(rare_labels), 'Rare', temp_df[var])\n\n    return temp_df","ffb424bf":"df=rare_encoder(df, 0.01)","fd6e3df9":"for col in num_cols:\n    transformer = RobustScaler().fit(df[[col]])\n    df[col] = transformer.transform(df[[col]])","0574189c":"y = df[\"Outcome\"]\nX = df.drop([\"Outcome\"], axis=1)\n\nX_train, X_test, y_train, y_test = train_test_split(X,\n                                                    y,\n                                                    test_size=0.20, random_state=1)\n\nlog_model = LogisticRegression().fit(X_train, y_train)","6e541ecc":"# tahmin'lerin olu\u015fturulmas\u0131 ve kaydedilmesi\ny_pred = log_model.predict(X_train)","d9575e77":"# s\u0131n\u0131f olas\u0131l\u0131klar\u0131\nlog_model.predict_proba(X_train)[0:10]","17e9ed91":"# 1. s\u0131n\u0131fa ait olma olas\u0131l\u0131klar\u0131:\ny_prob = log_model.predict_proba(X_train)[:, 1]","d09b503e":"y_pred = log_model.predict(X_train)\naccuracy_score(y_train, y_pred)","4c3ec470":"# Di\u011fer metrikler i\u00e7in y_pred\ny_pred = log_model.predict(X_test)","e281e864":"# AUC Score i\u00e7in y_prob\ny_prob = log_model.predict_proba(X_test)[:, 1]","bf1ca80d":"# CONFUSION MATRIX\ndef plot_confusion_matrix(y, y_pred):\n    acc = round(accuracy_score(y, y_pred), 2)\n    cm = confusion_matrix(y, y_pred)\n    sns.heatmap(cm, annot=True, fmt=\".0f\")\n    plt.xlabel('y_pred')\n    plt.ylabel('y')\n    plt.title('Accuracy Score: {0}'.format(acc), size=10)\n    plt.show()","1d3efc8c":"plot_confusion_matrix(y_test, y_pred)","bb7176b3":"#tahminlerin do\u011fru tahmin edilme oran\u0131\naccuracy_score(y_test, y_pred)","c7e9583c":"#Pozitif olarak tahmin edilenlerin do\u011fru tahmin edilme oranlar\u0131n\u0131 verir.\nprecision_score(y_test, y_pred)","90b453db":"#Ger\u00e7ekte pozitif olan durumlar\u0131n do\u011fru tahmin edilme oran\u0131n\u0131 verir.\nrecall_score(y_test, y_pred)","1c79cef9":"f1_score(y_test, y_pred)","26603065":"roc_auc_score(y_test, y_prob)","6747345a":"print(classification_report(y_test, y_pred))","8fd3ce3f":"Olu\u015fan bo\u015f de\u011ferler,bo\u015f de\u011ferlerin 3 kom\u015fusuna bak\u0131larak knn imputer ile doldurulur.","ad821678":"Veri seti k\u00fc\u00e7\u00fck oldu\u011fundan ayk\u0131r\u0131 de\u011ferlere herhangi bir i\u015flem yap\u0131lmad\u0131.","1c6d9fa4":"FEATURE ENGINEERING","0f89fab0":"**Veri Seti Hakk\u0131nda Bilgi:** ABD'deki Arizona Eyaleti'nin en b\u00fcy\u00fck 5. \u015fehri olan Phoenix \u015fehrinde ya\u015fayan 21\nya\u015f ve \u00fczerinde olan Pima Indian kad\u0131nlar\u0131 \u00fczerinde yap\u0131lan diyabet ara\u015ft\u0131rmas\u0131 i\u00e7in kullan\u0131lan verilerdir.\n768 g\u00f6zlem ve 8 say\u0131sal ba\u011f\u0131ms\u0131z de\u011fi\u015fkenden olu\u015fmaktad\u0131r. Hedef de\u011fi\u015fken \"outcome\" olarak belirtilmi\u015f olup;\n1 diyabet test sonucunun pozitif olu\u015funu,0 ise negatif olu\u015funu belirtmektedir.\n\n**De\u011fi\u015fkenler:**\nPregnancies \u2013 Hamilelik say\u0131s\u0131,Glucose \u2013 Glikoz de\u011feri,SkinThickness \u2013 Cilt Kal\u0131nl\u0131\u011f\u0131,Insulin \u2013 2 saatlik serum ins\u00fclini (mu U\/ml)\nBlood Pressure \u2013 Kan Bas\u0131nc\u0131 (K\u00fc\u00e7\u00fck tansiyon) (mm Hg),DiabetesPedigreeFunction\u2013 Aile \u00f6yk\u00fcs\u00fcne dayal\u0131 olarak diyabet olas\u0131l\u0131\u011f\u0131n\u0131 puanlayan bir fonksiyon\nAge \u2013 Ya\u015f (y\u0131l),Outcome\u2013 Hastal\u0131\u011fa sahip (1) ya da de\u011fil (0)\n\n**Ama\u00e7:** \u00d6zellikleri belirtildi\u011finde ki\u015filerin diyabet hastas\u0131 olup olmad\u0131klar\u0131n\u0131 tahmin edebilecek bir makine \u00f6\u011frenmesi\nmodeli geli\u015ftirmek.\n\n**Yararlan\u0131lan kaynak**: https:\/\/bootcamp.veribilimiokulu.com\/egitim\/veri-bilimci-yetistirme-programi\/","f38a2c4c":"Bo\u015f de\u011ferleri knn ile doldurmak i\u00e7in \u00f6ncelikle dataframe'in standartla\u015ft\u0131r\u0131lmas\u0131 gerekir. Standartla\u015ft\u0131r\u0131lan de\u011ferler bo\u015f de\u011ferler doldurulduktan sonra tekrar inverse.transform ile eski haline getirilir.\nGer\u00e7ek de\u011ferlere g\u00f6re feaature olu\u015fturmak mant\u0131kl\u0131 olaca\u011f\u0131ndan bu i\u015flem yap\u0131l\u0131r.","88904484":"Yeni columnlar olu\u015ftu\u011fundan tekrar kategorik-numerik ayr\u0131m\u0131 yap\u0131l\u0131r.","10b357fe":"![image.png](attachment:014d44d4-706d-490a-8020-48c1ec403f2e.png)","19ceeb97":"G\u00f6rsele bak\u0131ld\u0131\u011f\u0131nda ger\u00e7ekte 0 olan 99 veri varm\u0131\u015f bunun 88'i do\u011fru tahmin edilmi\u015f 11'i ise 1 olarak yanl\u0131\u015f tahmin edilmi\u015f.\nGer\u00e7ekte 1 olan 55 veri varken bunlar\u0131n 36's\u0131 do\u011fru tahmin edilmi\u015f 19'u ise 0 olarak yanl\u0131\u015f tahmin edilmi\u015f; buradan \u00e7\u0131kar\u0131lacak sonu\u00e7 model 0'lar\u0131 tahmin ederken g\u00f6sterdi\u011fi ba\u015far\u0131y\u0131 1'leri tahmin ederken g\u00f6steremiyor olur.","3d2796ef":"DiabetesPedigreeFunction: aile \u00f6yk\u00fcs\u00fcne dayal\u0131 olarak diyabet olas\u0131l\u0131\u011f\u0131n\u0131 puanlayan bir i\u015flev","79da0e25":"# DIABETES PREDICTION","a52d6d76":"G\u00f6rsel: https:\/\/jnyh.medium.com\/building-a-machine-learning-classifier-model-for-diabetes-4fca624daed0","98283507":"Bir ki\u015finin glikoz de\u011feri 140'tan y\u00fcksek ise risk grubundad\u0131r.","5d685565":"\u0130ns\u00fclin de\u011ferleri de risk durumuna g\u00f6re 3 kategoriye ayr\u0131l\u0131r.","e370783e":"Modele katmak i\u00e7in standartla\u015ft\u0131rma i\u015flemi yap\u0131L\u0131r veri seti k\u00fc\u00e7\u00fck oldu\u011fundan ve \u00e7ok u\u00e7 bir de\u011fer olmad\u0131\u011f\u0131ndan\nayk\u0131r\u0131 de\u011ferlere herhangi bir i\u015flem yap\u0131lmad\u0131 bu y\u00fczden robust scaler kullan\u0131ld\u0131.","c60806dd":"VER\u0130YE GENEL BAKI\u015e","4a5fe707":"Veri setinde baz\u0131 g\u00f6zlemlerde ins\u00fclin de\u011ferleri 0 olarak girilmi\u015f. Bir ki\u015finin ins\u00fclin de\u011ferinin 0 olmas\u0131 m\u00fcmk\u00fcn de\u011fildir,anla\u015f\u0131lan ins\u00fclin de\u011ferlerine bak\u0131lmayan ki\u015filerin ins\u00fclin de\u011ferleri, s\u0131f\u0131r olarak girilmi\u015f; bunlar nan olarak de\u011fi\u015ftirilir. Ayn\u0131 sorunun oldu\u011fu di\u011fer columnlarda da b\u00f6yle bir de\u011fi\u015fiklik yap\u0131l\u0131r.","dbb5d5fd":"Encoding i\u015flemleri yap\u0131l\u0131r.","259f0b6f":"V\u00fccut Kitle \u0130ndeksi (BMI)\nBMI de\u011feri 30'dan k\u00fc\u00e7\u00fckse \u015feker hastas\u0131 olma ihtimali d\u00fc\u015f\u00fck ama 30'u ge\u00e7erse y\u00fcksek.","eac16906":"EKS\u0130K DE\u011eERLER\u0130N DOLDURULMASI","dd8739b5":"\u015eeker hastalar\u0131n\u0131n cildi kal\u0131nla\u015f\u0131r.Say\u0131sal de\u011fer oldu\u011fundan ve belli bir metri\u011fe indirgenemedi\u011finden\nbu \u015fekilde b\u0131rak\u0131l\u0131r.","2cf3afc1":"Hamilelik say\u0131s\u0131n\u0131n artmas\u0131 da \u015feker hastas\u0131 olma ihtimalini art\u0131r\u0131yor","d02a0f27":"Zaten aralar\u0131nda bir s\u0131ralama oldu\u011fundan bu \u015fekilde b\u0131rak\u0131l\u0131r.","04fbd020":"Nadir olan durumlar 0.01 oran\u0131nda g\u00f6rmezden gelinir.","fc960043":"BloodPressure kan bas\u0131nc\u0131n\u0131n y\u00fcksek olmas\u0131 da etkiliyor"}}