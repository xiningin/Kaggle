{"cell_type":{"932024fe":"code","086298c7":"code","e9e63f32":"code","149163fd":"code","c9df64c7":"code","72ea0d6d":"code","de519145":"code","2c57408f":"code","f06aa13d":"code","89e34e76":"code","a7b10502":"code","a275ef7f":"markdown"},"source":{"932024fe":"import os\nimport pandas as pd\nimport numpy as np\nimport cv2\nimport PIL\nfrom tqdm import tqdm\nimport matplotlib.pyplot as plt\nfrom collections import Counter\nimport pickle","086298c7":"for folder in ['test','train','val']:\n    for dirname,_,filename in os.walk(f'..\/input\/chest-xray-pneumonia\/chest_xray\/{folder}'):\n        if dirname.split('\/')[-1]=='NORMAL':\n            print(f\"{folder} - NORMAL images count: {len(filename)}\")\n        elif dirname.split('\/')[-1]=='PNEUMONIA':\n            print(f\"{folder} - PNEUMONIA images count: {len(filename)}\")      ","e9e63f32":"normal_img_path = '..\/input\/chest-xray-pneumonia\/chest_xray\/train\/NORMAL'\npneumonia_img_path = '..\/input\/chest-xray-pneumonia\/chest_xray\/train\/PNEUMONIA'\n\nfor color,folder_path in zip(['g','r'],[normal_img_path,pneumonia_img_path]):\n    counter = Counter()\n    for img_path in tqdm(os.listdir(folder_path)[:1300],total=1300,desc=f\"{folder_path.split('\/')[-1]} images processed: \"):\n        image = np.array(cv2.resize(cv2.cvtColor(cv2.imread(folder_path+'\/'+img_path), cv2.COLOR_BGR2GRAY),(600,800)))\n        counter+=Counter(image.flatten())\n\n    freq_df = pd.DataFrame({'Intensity':list(counter.keys()),'Frequency':list(counter.values())})\n    freq_df.sort_values('Intensity',inplace=True)\n    freq_df = freq_df[freq_df.Intensity>0]  #discarding frequency count of 0 pixel intensity value\n    \n    ## Plotting\n    plt.figure(figsize=(16,7))\n    ax1 = plt.subplot(1,1,1,title=f\"Histogram of {folder_path.split('\/')[-1]} X-Ray Images (1300 images used)\")\n    ax1.bar(x=freq_df.Intensity,height=freq_df.Frequency,color=color)\n    plt.plot()\n    \n    ## Saving\n    try:\n        with open(f\"{folder_path.split('\/')[-1]}_hist.png\",'wb') as f:\n            plt.savefig(f)\n    except:\n        pass\n    \n    with open(f\"{folder_path.split('\/')[-1]}_hist_dict.pkl\",'wb') as f:\n        pickle.dump(counter,f)     \n    ","149163fd":"with open(f\"NORMAL_hist_dict.pkl\",'rb') as f:\n    counter_normal = pickle.load(f)\nwith open(f\"PNEUMONIA_hist_dict.pkl\",'rb') as f:\n    counter_pneumonia = pickle.load(f)","c9df64c7":"freq_normal = pd.DataFrame({'Intensity':list(counter_normal.keys()),'Count':list(counter_normal.values())})\nfreq_normal.sort_values('Intensity',inplace=True)\nfreq_pneumonia = pd.DataFrame({'Intensity':list(counter_pneumonia.keys()),'Count':list(counter_pneumonia.values())})\nfreq_pneumonia.sort_values('Intensity',inplace=True)","72ea0d6d":"freq_normal.head(10)","de519145":"freq_pneumonia.head(10)","2c57408f":"freq_normal['Intensity_bins'] = pd.cut(freq_normal.Intensity,bins=list(range(0,256,15)))\nfreq_bins_normal = freq_normal.groupby('Intensity_bins',as_index=False).sum()[['Intensity_bins','Count']]\n\nfreq_pneumonia['Intensity_bins'] = pd.cut(freq_pneumonia.Intensity,bins=list(range(0,256,15)))\nfreq_bins_pneumonia = freq_pneumonia.groupby('Intensity_bins',as_index=False).sum()[['Intensity_bins','Count']]","f06aa13d":"freq_bins_normal","89e34e76":"freq_bins_pneumonia","a7b10502":"freq_bins_pneumonia.to_csv('bincount_pneumonia.csv',index=False)\nfreq_bins_normal.to_csv('bincount_normal.csv',index=False)","a275ef7f":"### Taking 1300 Pneumonia and Normal images for histogram analysis"}}