{"cell_type":{"78dda832":"code","2de2b368":"code","24afd6ba":"code","d2646309":"code","2245aa46":"code","e2ae91af":"code","4bd9068d":"code","49ae9fbe":"code","5c121d69":"markdown","9b0f767f":"markdown","e3428ef6":"markdown","fa4ec18f":"markdown","fadf5a23":"markdown","49805518":"markdown","c7a608f0":"markdown","5f983e32":"markdown","ac8800d1":"markdown"},"source":{"78dda832":"pip install pandas dash","2de2b368":"import pandas as pd\nimport dash\nimport dash_html_components as html\nimport dash_core_components as dcc\nfrom dash.dependencies import Input, Output, State\nimport plotly.graph_objects as go\nimport plotly.express as px\nfrom dash import no_update","24afd6ba":"airline_data =  pd.read_csv(\"..\/input\/us-airline-data\/airline_data.csv\", \n                            encoding = \"ISO-8859-1\",\n                            dtype={'Div1Airport': str, 'Div1TailNum': str, \n                                   'Div2Airport': str, 'Div2TailNum': str})","d2646309":"airline_data.head()","2245aa46":"airline_data.describe(include='all')","e2ae91af":"app = dash.Dash(__name__)","4bd9068d":"# List of years \nyear_list = [i for i in range(2005, 2021, 1)]\n\n\"\"\"Compute graph data for creating yearly airline performance report \n\nFunction that takes airline data as input and create 5 dataframes based on the grouping condition to be used for plottling charts and grphs.\n\nArgument:\n     \n    df: Filtered dataframe\n    \nReturns:\n   Dataframes to create graph. \n\"\"\"\n\ndef compute_data_choice_1(df):\n    # Cancellation Category Count\n    bar_data = df.groupby(['Month','CancellationCode'])['Flights'].sum().reset_index()\n    # Average flight time by reporting airline\n    line_data = df.groupby(['Month','Reporting_Airline'])['AirTime'].mean().reset_index()\n    # Diverted Airport Landings\n    div_data = df[df['DivAirportLandings'] != 0.0]\n    # Source state count\n    map_data = df.groupby(['OriginState'])['Flights'].sum().reset_index()\n    # Destination state count\n    tree_data = df.groupby(['DestState', 'Reporting_Airline'])['Flights'].sum().reset_index()\n    return bar_data, line_data, div_data, map_data, tree_data\n\n\"\"\"Compute graph data for creating yearly airline delay report\n\nThis function takes in airline data and selected year as an input and performs computation for creating charts and plots.\n\nArguments:\n    df: Input airline data.\n    \nReturns:\n    Computed average dataframes for carrier delay, weather delay, NAS delay, security delay, and late aircraft delay.\n\"\"\"\n\ndef compute_data_choice_2(df):\n    # Compute delay averages\n    avg_car = df.groupby(['Month','Reporting_Airline'])['CarrierDelay'].mean().reset_index()\n    avg_weather = df.groupby(['Month','Reporting_Airline'])['WeatherDelay'].mean().reset_index()\n    avg_NAS = df.groupby(['Month','Reporting_Airline'])['NASDelay'].mean().reset_index()\n    avg_sec = df.groupby(['Month','Reporting_Airline'])['SecurityDelay'].mean().reset_index()\n    avg_late = df.groupby(['Month','Reporting_Airline'])['LateAircraftDelay'].mean().reset_index()\n    return avg_car, avg_weather, avg_NAS, avg_sec, avg_late\n\n# Application layout\n# This layout is created by dash\/dash_components_html\/dash_core_components and we don't need to understand html or xml to build layout\n# just try to visualize the layout in tree like structure and it will be easy for use to create any layout.\napp.layout = html.Div(children=[ \n                               html.H1('US Domestic Airline Flights Performance', style={'color':'#503D36','textAlign':'center','font-size':24}),\n                                # Dropdown creation\n                                # Create an outer division \n                                html.Div([\n                                    # Add an division\n                                    html.Div([\n                                        # Create an division for adding dropdown helper text for report type\n                                        html.Div(\n                                            [\n                                            html.H2('Report Type:', style={'margin-right': '2em'}),\n                                            ]\n                                        ),\n                                        # Add a dropdown\n                                        dcc.Dropdown(id='input-type',\n                                        options=[\n                                            {'label':'early Airline Performance Report','value':'OPT1'},\n                                            {'label':'Yearly Airline Delay Report', 'value':'OPT2'}\n                                        ],\n                                        placeholder='Select a report type',\n                                        style={'width':'80%','padding':'3px','font-size':'20px','text-align-last':'center'})\n                                    # Place them next to each other using the division style\n                                    ], style={'display':'flex'}),\n                                    \n                                   # Add next division \n                                   html.Div([\n                                       # Create an division for adding dropdown helper text for choosing year\n                                        html.Div(\n                                            [\n                                            html.H2('Choose Year:', style={'margin-right': '2em'})\n                                            ]\n                                        ),\n                                        dcc.Dropdown(id='input-year', \n                                                     # Update dropdown values using list comphrehension\n                                                     options=[{'label': i, 'value': i} for i in year_list],\n                                                     placeholder=\"Select a year\",\n                                                     style={'width':'80%', 'padding':'3px', 'font-size': '20px', 'text-align-last' : 'center'}),\n                                            # Place them next to each other using the division style\n                                            ], style={'display': 'flex'}),  \n                                          ]),\n                                \n                                # Add Computed graphs\n                                # Observe how we add an empty division and providing an id that will be updated during callback\n                                html.Div([ ], id='plot1'),\n    \n                                html.Div([\n                                        html.Div([ ], id='plot2'),\n                                        html.Div([ ], id='plot3')\n                                ], style={'display': 'flex'}),\n                                  html.Div([\n                                        html.Div([ ], id='plot4'),\n                                        html.Div([ ], id='plot5')\n                                ], style={'display': 'flex'})\n                                ])\n\n\n# Callback function definition\n@app.callback( [Output(component_id='plot1', component_property='children'),\n                Output(component_id='plot2', component_property='children'),\n                Output(component_id='plot3', component_property='children'),\n                Output(component_id='plot4', component_property='children'),\n                Output(component_id='plot5', component_property='children')],\n\n               [Input(component_id='input-type', component_property='value'),\n                Input(component_id='input-year', component_property='value')],\n               # Holding output state till user enters all the form information. In this case, it will be chart type and year\n               [State(\"plot1\", 'children'), State(\"plot2\", \"children\"),\n                State(\"plot3\", \"children\"), State(\"plot4\", \"children\"),\n                State(\"plot5\", \"children\")\n               ])\n\n# Add computation to callback function and return graph\ndef get_graph(chart, year, children1, children2, c3, c4, c5):\n      \n        # Select data\n        df =  airline_data[airline_data['Year']==int(year)]\n       \n        if chart == 'OPT1':\n            # Compute required information for creating graph from the data\n            bar_data, line_data, div_data, map_data, tree_data = compute_data_choice_1(df)\n            \n            # Number of flights under different cancellation categories\n            bar_fig = px.bar(bar_data, x='Month', y='Flights', color='CancellationCode', title='Monthly Flight Cancellation')\n            \n            line_fig = px.line(line_data,x='Month',y='AirTime',color='Reporting_Airline', title='Average monthly flight time (minutes) by airline')\n            \n            # Percentage of diverted airport landings per reporting airline\n            pie_fig = px.pie(div_data, values='Flights', names='Reporting_Airline', title='% of flights by reporting airline')\n            \n            # Number of flights flying from each state using choropleth\n            map_fig = px.choropleth(map_data,  # Input data\n                    locations='OriginState', \n                    color='Flights',  \n                    hover_data=['OriginState', 'Flights'], \n                    locationmode = 'USA-states', # Set to plot as US States\n                    color_continuous_scale='GnBu',\n                    range_color=[0, map_data['Flights'].max()]) \n            map_fig.update_layout(\n                    title_text = 'Number of flights from origin state', \n                    geo_scope='usa') # Plot only the USA instead of globe\n            \n            tree_fig = px.treemap(tree_data, path=['DestState', 'Reporting_Airline'], values='Flights', color='Flights', color_continuous_scale='RdBu', title='Flight count by airline to destination state')\n                 \n            # Return dcc.Graph component to the empty division\n            return [dcc.Graph(figure=tree_fig), \n                    dcc.Graph(figure=pie_fig),\n                    dcc.Graph(figure=map_fig),\n                    dcc.Graph(figure=bar_fig),\n                    dcc.Graph(figure=line_fig)\n                   ]\n        else:\n            # This covers chart type 2 and we have completed this exercise under Flight Delay Time Statistics Dashboard section\n            # Compute required information for creating graph from the data\n            avg_car, avg_weather, avg_NAS, avg_sec, avg_late = compute_data_choice_2(df)\n            \n            # Create graph\n            carrier_fig = px.line(avg_car, x='Month', y='CarrierDelay', color='Reporting_Airline', title='Average carrrier delay time (minutes) by airline')\n            weather_fig = px.line(avg_weather, x='Month', y='WeatherDelay', color='Reporting_Airline', title='Average weather delay time (minutes) by airline')\n            nas_fig = px.line(avg_NAS, x='Month', y='NASDelay', color='Reporting_Airline', title='Average NAS delay time (minutes) by airline')\n            sec_fig = px.line(avg_sec, x='Month', y='SecurityDelay', color='Reporting_Airline', title='Average security delay time (minutes) by airline')\n            late_fig = px.line(avg_late, x='Month', y='LateAircraftDelay', color='Reporting_Airline', title='Average late aircraft delay time (minutes) by airline')\n            \n            return[dcc.Graph(figure=carrier_fig), \n                   dcc.Graph(figure=weather_fig), \n                   dcc.Graph(figure=nas_fig), \n                   dcc.Graph(figure=sec_fig), \n                   dcc.Graph(figure=late_fig)]\n        \n","49ae9fbe":"# if __name__ == '__main__':\n#     app.run_server(host='0.0.0.0', port= 8050,debug = False)","5c121d69":"### Checking statistical overview of data ,with columns including descriptive data also, will be evaluated by [ include='all' ] parameter","9b0f767f":"# Creating an Instance of web application we are going to create.","e3428ef6":"# Running our application","fa4ec18f":"### Let's begin.  \n**I am going to code all the program in one cell, because if I tried to execute in seprate cell, it will throw an error saying function is incomplete**","fadf5a23":"### Reviewing Dataframe","49805518":"## All we have to do now  \n*Run the whole program and* **-->** *The last O\/P  probabily will be an IP adress* **-->** *go to that ip adress in browser* **-->** *Use interactive Dashboard*","c7a608f0":"# Bringing Data","5f983e32":"# *Important Note*  \n1. You can't run this file on kaggle or jupyter or any other online platform.\n1. To run this program you need to copy whole prorgam and run it on local IDE say VS-Code. \n1. You need to uncomment last cell of {Running  our application} and then run in local IDE. I have commented this beacuse if I didn't , it would not upload on kaggle","ac8800d1":"# Loading all the libraries"}}