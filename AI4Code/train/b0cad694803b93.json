{"cell_type":{"3a2c8148":"code","61ff0e7d":"code","775dfc2f":"code","37ed2d3d":"code","6bf811cc":"code","856ed13c":"code","deaf5d79":"code","ec355aa4":"code","6d3bbb8d":"code","3e222b1a":"code","6b850a88":"code","95681c94":"code","d488d947":"code","b3eec8d4":"code","c58d5ffd":"code","fc06aa2a":"code","9441855b":"markdown"},"source":{"3a2c8148":"from sklearn.datasets import fetch_california_housing\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nimport pandas as pd\nimport numpy as np\nimport tensorflow as tf\nimport matplotlib.pyplot as plt","61ff0e7d":"housing=fetch_california_housing()","775dfc2f":"print(housing.DESCR)","37ed2d3d":"df=pd.DataFrame(data=housing.data,columns=housing.feature_names)\ntarget=pd.DataFrame(data=housing.target,columns=['target'])\ndf=pd.concat([df,target],sort=True,axis=1)\ndf.head(10)","6bf811cc":"X_train_full,X_test, y_train_full,y_test=train_test_split(\n    housing.data, housing.target)\n\nX_train,X_valid, y_train,y_valid=train_test_split(\n    X_train_full,y_train_full)","856ed13c":"scaler1=StandardScaler()\nX_train=scaler1.fit_transform(X_train)\nX_valid=scaler1.transform(X_valid)\nx_test=scaler1.transform(X_test)","deaf5d79":"input_=tf.keras.layers.Input(shape=X_train.shape[1:])\nhidden1=tf.keras.layers.Dense(30,activation='relu')(input_)\nhidden2=tf.keras.layers.Dense(10,activation='relu')(hidden1)\nconcat=tf.keras.layers.concatenate(inputs=[input_ , hidden2])\noutput=tf.keras.layers.Dense(1)(concat)\nmodel = tf.keras.Model(inputs=[input_], outputs=[output])","ec355aa4":"checkpoint_cb1=tf.keras.callbacks.EarlyStopping(monitor='val_loss',patience=3)","6d3bbb8d":"pwd","3e222b1a":"model.compile(loss='mse',optimizer=tf.keras.optimizers.SGD(lr=1e-3))","6b850a88":"model.fit(X_train,y_train,epochs=40,validation_data=(X_valid,y_valid),callbacks=[checkpoint_cb1])","95681c94":"model.save('mlp_reg_model.h5')","d488d947":"model = tf.keras.models.load_model(\"mlp_reg_model.h5\")","b3eec8d4":"checkpoint_cb1=tf.keras.callbacks.EarlyStopping(monitor='val_loss',patience=3)\ncheckpoint_cb = tf.keras.callbacks.ModelCheckpoint(\"mlp_reg_model.h5\")","c58d5ffd":"model.fit(X_train,y_train,epochs=40,validation_data=(X_valid,y_valid),callbacks=[checkpoint_cb1,checkpoint_cb])","fc06aa2a":"model.save('mlp_reg_model.h5')","9441855b":"#### For a deep learning model at scale, callbacks are very important\n\n#### EarlyStopping for reducing the waste of time and resources & checkpoint for saving the model after every n epochs so we can have a model even if the processing unit crashed"}}