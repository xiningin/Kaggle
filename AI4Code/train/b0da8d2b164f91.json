{"cell_type":{"88d5a75e":"code","4e874f99":"code","04f79143":"code","c1387e43":"code","6fd84b95":"code","2574248c":"code","5f0bfbab":"code","0642c96b":"markdown","f95198a6":"markdown","8e9e0e5a":"markdown","595e173a":"markdown"},"source":{"88d5a75e":"from fastai.vision.all import *\n\n# all the categories\nfish_types = [\"Gilt-Head Bream\", \n              \"Red Sea Bream\", \n              \"Sea Bass\", \n              \"Red Mullet\", \n              \"Hourse Mackerel\", \n              \"Black Sea Sprat\", \n              \"Striped Red Mullet\", \n              \"Trout\", \n              \"Shrimp\"]\n\n# path to folder of each type\nfish_data_path = [\n    Path(f\"..\/input\/a-large-scale-fish-dataset\/Fish_Dataset\/Fish_Dataset\/{fish}\/{fish}\") for fish in fish_types\n]\n\n# path to all image files\nfish_files = []\nfor fish in fish_data_path:\n    fish_files += get_image_files(fish)\n\n# split train and test set\ntrain_idx, test_idx = RandomSplitter()(fish_files)","4e874f99":"dblocks = DataBlock(blocks=(ImageBlock, CategoryBlock),\n                    get_y=parent_label,\n                    splitter=RandomSplitter(),\n                    item_tfms=Resize(460),\n                    batch_tfms=[*aug_transforms(mult=2, size=227, min_scale=0.5),\n                                Normalize])\ndls = dblocks.dataloaders(fish_files[train_idx])","04f79143":"dls.show_batch()","c1387e43":"transfer_learn = cnn_learner(dls, alexnet, metrics=accuracy)\ntransfer_learn.lr_find()","6fd84b95":"transfer_learn.fit_one_cycle(5, 1e-2)","2574248c":"test_dl = dls.test_dl(fish_files[test_idx], with_labels=True)\ninterp_trans = ClassificationInterpretation.from_learner(transfer_learn,dl=test_dl)\naccuracy(interp_trans.preds, interp_trans.targs)","5f0bfbab":"interp_trans.plot_confusion_matrix(figsize=(10, 10), dpi=60)","0642c96b":"# Evaluation on test set","f95198a6":"# Fine-tuning a pretrained Alexnet","8e9e0e5a":"codes with explanations are [here](https:\/\/peiyihung.github.io\/mywebsite\/category\/project\/2021\/03\/15\/Classifying-Fish-Species-with-AlexNet.html)","595e173a":"# Import the data and proprocess"}}