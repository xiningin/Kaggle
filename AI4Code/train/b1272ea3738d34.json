{"cell_type":{"1b85dfb5":"code","0965dc49":"code","5344c308":"code","52a829cd":"code","5b2d91c1":"code","bd4b8aad":"code","127fee7f":"code","fb0dd4cb":"code","b7a37af5":"code","18ab4651":"code","60233ff4":"code","a103813b":"code","d4526927":"code","b7945d36":"code","65471a31":"code","36d5cf68":"code","6ceb8d96":"code","49a8482d":"code","c83517ab":"code","1f735b83":"code","acb1f2c9":"code","bdb294b6":"code","9782a3d0":"code","027c5c18":"code","2f3b7c2f":"code","77558660":"code","fa5997b5":"code","e6664062":"code","5bfab674":"code","127c14a1":"code","47a0e4d4":"code","ef7b0e3a":"code","4f25b618":"code","fbf5efab":"code","07561a30":"code","c45bac6e":"markdown","cd15b5b2":"markdown","3a55b3b6":"markdown","760e1218":"markdown","05babba3":"markdown","3e499d35":"markdown","fa774513":"markdown","96c3949c":"markdown","c1911497":"markdown","d9cca9cc":"markdown","d0dd7a36":"markdown","da2a2de6":"markdown","9026e615":"markdown"},"source":{"1b85dfb5":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","0965dc49":"import seaborn as sns","5344c308":"import matplotlib.pyplot as plt\n%matplotlib inline","52a829cd":"med_df=pd.read_csv('..\/input\/insurance.csv')","5b2d91c1":"med_df.head()","bd4b8aad":"med_df.info()","127fee7f":"med_df.describe()","fb0dd4cb":"sns.heatmap(med_df.isnull(),yticklabels=False,cbar=False,cmap='viridis')","b7a37af5":"Male=pd.get_dummies(med_df['sex'],drop_first=True)","18ab4651":"Smoker=pd.get_dummies(med_df['smoker'],drop_first=True)","60233ff4":"Area=pd.get_dummies(med_df['region'],drop_first=True)","a103813b":"med_df=pd.concat([med_df,Male,Smoker,Area],axis=1)","d4526927":"med_df.head()","b7945d36":"med_df.drop(['sex','smoker','region'],axis=1,inplace=True)","65471a31":"med_df.head()","36d5cf68":"sns.jointplot(data=med_df,x='age',y='charges')","6ceb8d96":"sns.jointplot(x='age',y='charges',data=med_df,kind='hex')","49a8482d":"\nsns.barplot(x='age',y='charges',hue='male',data=med_df)","c83517ab":"plt.figure(figsize=(20,5))\nsns.barplot(x='age',y='children', data=med_df, hue='male', palette='RdBu_d', ci=None)","1f735b83":"from sklearn.model_selection import train_test_split","acb1f2c9":"X=med_df.drop(['charges'],axis=1)\ny=med_df['charges']","bdb294b6":"X_train, X_test, y_train, y_test= train_test_split(X,y,test_size=0.3,random_state=101)","9782a3d0":"from sklearn.linear_model import LinearRegression","027c5c18":"lm=LinearRegression()","2f3b7c2f":"lm.fit(X_train,y_train)","77558660":"print(lm.coef_)","fa5997b5":"predictions=lm.predict(X_test)","e6664062":"sns.scatterplot(y_test,predictions)","5bfab674":"from sklearn import metrics\n\n\nprint('MAE= ', metrics.mean_absolute_error(y_test, predictions))\nprint('MSE= ', metrics.mean_squared_error(y_test, predictions))\nprint('RMS= ', np.sqrt(metrics.mean_squared_error(y_test, predictions)))\n\n","127c14a1":"sns.distplot(y_test-predictions,bins=30)","47a0e4d4":"coef_df= pd.DataFrame(lm.coef_,X.columns,columns=['coefficient'])\ncoef_df","ef7b0e3a":"from sklearn.metrics import r2_score","4f25b618":"print(r2_score(y_test,predictions))","fbf5efab":"from sklearn.metrics import explained_variance_score","07561a30":"print(explained_variance_score(y_test,predictions))","c45bac6e":"**Let's add dummy values for the columns: Sex, Smoker  and Region, so that it is easy to interpret for machine learning**","cd15b5b2":"The insurance costs increases by $52.13 per male contractor for buying insurance.\n\n","3a55b3b6":" 1 unit increase in number of 'children' causes $494.29 increase in insuarance costs.\n","760e1218":"**Let's do little exploratory analysis**","05babba3":"**Linear Regression:**","3e499d35":"1 unit increase in 'age' causes $241.27 increase in insurance cost. ","fa774513":"**Now, let's drop the sex, smoker, region columns since we created dummies for them**","96c3949c":"**PS: I later understood, that smoker column dummies werent properly dealt with. The column 'yes' represents smokers (yes:1, no:0)**","c1911497":"1 unit increase in 'bmi' causes $367.18 increase in insurance costs.\n","d9cca9cc":"For 'smoker's the insurance cost increases by $23463.56 smoker who seeks insurance.","d0dd7a36":"**The data is complete as per the number of rows and columns indicated**","da2a2de6":"**Let's plot a heatmap just to graphically display that there are no null values**","9026e615":"* **It can be infered that with increase in Age there is increase in Cost of Insurance **\n* **Also, there is varying Cost of Insurance at a particular Age itself**"}}