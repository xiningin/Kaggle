{"cell_type":{"b298a117":"code","0d9796b3":"code","419571ec":"code","1e7c10ca":"code","e8092afb":"code","429e1c67":"code","d2d666ca":"code","efecabc4":"code","63a2f673":"code","473e425e":"code","bf6d8111":"code","144daefd":"markdown","26f398b0":"markdown","e3482156":"markdown","8244c2c3":"markdown","08deac55":"markdown","58580648":"markdown","0119e77d":"markdown","91a8c3da":"markdown"},"source":{"b298a117":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport numpy as np\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nimport matplotlib.pyplot as plt\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","0d9796b3":"data=pd.read_csv('..\/input\/biomechanical-features-of-orthopedic-patients\/column_2C_weka.csv')\ndata.tail(10)","419571ec":"data.rename(columns={'pelvic_tilt numeric':'pelvic_tilt_numeric'}, inplace=True)\ndata.tail()","1e7c10ca":"N=data[data['class']==\"Normal\"]\nAN=data[data['class']==\"Abnormal\"]","e8092afb":"data['class']=[1 if each =='Normal' else 0 for each in data['class']]\ny=data['class'].values\nx_data=data.drop(['class'],axis=1)\ndataf=x_data.corr()\nplt.figure(figsize=(10,10))\nax=sns.heatmap(dataf,annot=True, linewidths=1, fmt= '.2f', annot_kws={\"size\": 14})\nplt.show()","429e1c67":"index_vals = data['class'].astype('category').cat.codes\nimport plotly.graph_objects as go\nfig = go.Figure(data=go.Splom(\n                dimensions=[dict(label='pelv i',\n                                 values=data['pelvic_incidence']),\n                            dict(label='pelv t n.',\n                                 values=data['pelvic_tilt_numeric']),\n                            dict(label='lumbar',\n                                 values=data['lumbar_lordosis_angle']),\n                            dict(label='sacral',\n                                 values=data['sacral_slope']),\n                           dict(label='pelvic rad',\n                                 values=data['pelvic_radius']),\n                           dict(label='degree',\n                                 values=data['degree_spondylolisthesis'])],\n                text=data['class'],\n                marker=dict(color=index_vals,\n                            showscale=True, # colors encode categorical variables\n                            line_color='white', line_width=0.75)\n                ))\n\nfig.update_layout(\n    title='Biomechanical Orthopoedic Data',\n    dragmode='select',\n    width=1050,\n    height=800,\n    hovermode='closest',\n)\n\nfig.show()","d2d666ca":"fig = plt.figure(figsize=(16,6))\nax1 = plt.subplot(121)\nax1.scatter(AN.pelvic_tilt_numeric,AN.lumbar_lordosis_angle,color=\"maroon\",label=\"Anormal\")\nax1.scatter(N.pelvic_tilt_numeric,N.lumbar_lordosis_angle,color=\"lime\",label=\"Normal\")\nax1.legend()\nax1.grid(True)\nax2 = plt.subplot(122)\nax2.scatter(AN.sacral_slope,AN.lumbar_lordosis_angle,color=\"navy\",label=\"Anormal\")\nax2.scatter(N.sacral_slope,N.lumbar_lordosis_angle,color=\"cyan\",label=\"Normal\")\nax2.legend()\nax2.grid(True)\nfig.show()","efecabc4":"#split test data\nx_train, x_test,y_train,y_test=train_test_split(x_data,y,test_size=0.3,random_state=42)","63a2f673":"from sklearn.neighbors import KNeighborsClassifier\nknn=KNeighborsClassifier(n_neighbors=3)\nknn.fit(x_train,y_train)\nprediction=knn.predict(x_test)\nprint(\"{} nn score: {}\".format(3,knn.score(x_test,y_test)))","473e425e":"score_list=[]\nfor each in range(1,20):\n    knn2=KNeighborsClassifier(n_neighbors=each)\n    knn2.fit(x_train,y_train)\n    score_list.append(knn2.score(x_test,y_test))\nplt.plot(range(1,20),score_list)\nplt.grid(True)\nplt.show()","bf6d8111":"from sklearn.neighbors import KNeighborsClassifier\nknn=KNeighborsClassifier(n_neighbors=12)\nknn.fit(x_train,y_train)\nprediction=knn.predict(x_test)\nprint(\"{} nn score: {}\".format(3,knn.score(x_test,y_test)))","144daefd":"k=12 gives a better value than k=3.","26f398b0":"I've chosen these features (1st pelvic-lumbar at left and 2nd sacral-lumbar at right) theyre very evident features.","e3482156":"Final score is ~85%.","8244c2c3":"Split dataset into two ","08deac55":"Score is 81%. Not bad but i think it can be better. Let's see how many neighbours we need.","58580648":"## K-NN Fit","0119e77d":"We are looking for **not related** values because we will separate Abnormal and Normal values.  \nDarker colors are more available for separation because they does not have correlation between them.  \n(For example Pelvic tilt numeric and Sacral slope)","91a8c3da":"It seems there are many data couples which they can be separated with a basic curve."}}