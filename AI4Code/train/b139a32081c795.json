{"cell_type":{"bafe2270":"code","5b3e23cb":"code","f728939d":"code","7de712d9":"code","5ba3ab91":"code","6d94f520":"code","260d69b8":"code","8f49ab1c":"code","4ae1991d":"code","18922d16":"code","42380266":"code","66b704a2":"code","4eae2346":"code","942a0620":"code","58d7de0f":"code","73155fe4":"code","4b46eb57":"code","bc500b22":"code","65a67cf7":"code","2f9e0bde":"code","1106a10a":"code","d5e4155f":"code","1dcb2643":"code","2ffd3e92":"code","f047fa91":"code","e316904d":"code","3e6a1179":"code","15a0a163":"code","b445801b":"code","8c4dc136":"markdown","b4039227":"markdown","f96ee83c":"markdown","35529868":"markdown","fcae27fb":"markdown","b031f119":"markdown","99430d78":"markdown","f28d7cc5":"markdown","bf14d3be":"markdown","9781bf8f":"markdown","aa77727b":"markdown","cac77706":"markdown","f0883a01":"markdown","142d8660":"markdown","3b16ecc5":"markdown","6d747fd9":"markdown","68a5c93d":"markdown","11b707de":"markdown","dc5777ac":"markdown","d1f27b0b":"markdown","504fcc2b":"markdown","b8a322c2":"markdown","2006c058":"markdown","7b57ac4a":"markdown","fdbdfacc":"markdown","780328cb":"markdown","6a113240":"markdown","9fde91a4":"markdown","f2213e0a":"markdown","a590dd7e":"markdown","94dd8e3b":"markdown","8226769e":"markdown","e225cee4":"markdown"},"source":{"bafe2270":"project_name = \"Exploratory Data Analysis on Peer to Peer Loans\" ","5b3e23cb":"import numpy as np\nimport pandas as pd\nimport matplotlib\nimport matplotlib.pyplot as plt\nimport seaborn as sns","f728939d":"loans_df = pd.read_csv('..\/input\/p2p-loans\/loans_data.csv')","7de712d9":"loans_df.describe()","5ba3ab91":"loans_final_df = loans_df.sample(n=1000)","6d94f520":"loans_final_df.dtypes","260d69b8":"loans_final_df.loc[loans_final_df['term']=='36 months','term']=36\nloans_final_df.loc[loans_final_df['term']=='60 months', 'term']=60 ","8f49ab1c":"loans_final_df['term']=pd.to_numeric(loans_final_df.term)","4ae1991d":"loans_final_df.dtypes","18922d16":"loans_final_df.emp_length.unique()","42380266":"loans_final_df.loc[loans_final_df['emp_length']=='10+ years','emp_length']=10\nloans_final_df.loc[loans_final_df['emp_length']=='3 years','emp_length']=3\nloans_final_df.loc[loans_final_df['emp_length']=='2 years','emp_length']=2\nloans_final_df.loc[loans_final_df['emp_length']=='< 1 year','emp_length']=0\nloans_final_df.loc[loans_final_df['emp_length']=='1 year','emp_length']=1\nloans_final_df.loc[loans_final_df['emp_length']=='4 years','emp_length']=4\nloans_final_df.loc[loans_final_df['emp_length']=='5 years','emp_length']=5\nloans_final_df.loc[loans_final_df['emp_length']=='6 years','emp_length']=6\nloans_final_df.loc[loans_final_df['emp_length']=='7 years','emp_length']=7\nloans_final_df.loc[loans_final_df['emp_length']=='9 years','emp_length']=9\nloans_final_df.loc[loans_final_df['emp_length']=='8 years','emp_length']=8\nloans_final_df.emp_length.unique()","66b704a2":"loans_final_df['emp_length']=pd.to_numeric(loans_final_df.emp_length)\nloans_final_df.emp_length.dtype","4eae2346":"loans_final_df.sample(10)","942a0620":"sns.set_style(\"darkgrid\")\nplt.title(\"Distribution of Amount of Loans\")\nsns.distplot(loans_final_df.loan_amnt);","58d7de0f":"plt.title(\"Distribution of Interest of Loans\")\nsns.distplot(loans_final_df.int_rate);","73155fe4":"interest_df = loans_final_df.groupby('grade')[['int_rate']].mean()","4b46eb57":"plt.title('Interest rate of loans against Grade of Borrowers (Barplot)')\nsns.set(rc={'figure.figsize':(8,5)})\nsns.barplot(interest_df.index,interest_df.int_rate,palette='winter');","bc500b22":"sns.set(rc={'figure.figsize':(15,10)})\nplt.title('The interest rate of loans against their amount and clusters of grade in scatterplot')\nsns.set(rc={'figure.figsize':(15,8)})\nsns.scatterplot(x=loans_final_df.loan_amnt,\n                y=loans_final_df.int_rate,\n                hue=loans_final_df.grade,\n                hue_order=['A','B','C','D','E','F','G'],\n                legend=\"full\",\n                s=50);","65a67cf7":"plt.figure(figsize=(12,6))\nplt.title('Distribution of Employment Period')\nsns.countplot(loans_final_df.emp_length , palette = 'magma');","2f9e0bde":"sns.set(rc={'figure.figsize':(5,6)})\ngrade_df = loans_final_df.groupby('grade')[['loan_amnt']].sum()\ngrade_df['grade'] = ['A','B','C','D','E','F','G']\nplt.title('Cummulative Loan Amount given to Borrowers of each grade')\nsns.barplot(grade_df.grade,grade_df.loan_amnt, palette ='rocket' )","1106a10a":"#Grouping the continuous values of annual income into categories so that meaningful conclusions\n#can be drawn based on the paygrade\nbins = np.array([5000,7500,10000,15000,25000,50000,75000,100000,500000])\nannual_income = np.digitize(loans_final_df.annual_inc,bins)","d5e4155f":"sns.set(rc={'figure.figsize':(15,8)})\nsns.scatterplot(x=loans_final_df.loan_amnt,\n                y=loans_final_df.installment,\n                hue=annual_income,\n                legend=\"full\",\n                s=50);","1dcb2643":"loans_final_df.groupby('purpose')['purpose'].count()","2ffd3e92":"sns.set(rc={'figure.figsize':(15,8)})\nplt.title('Purpose of loans')\nax = sns.countplot(loans_final_df.purpose)\nax.set_xticklabels(ax.get_xticklabels(), rotation=40, ha=\"right\")\nplt.tight_layout()\nplt.show();","f047fa91":"major_purposes=['debt_consolidation','credit_card','home_improvement','medical','vacation','major_purchase']\npurpose_major_df = loans_final_df[loans_final_df['purpose'].isin(major_purposes)] \npurpose_major = purpose_major_df[['purpose','int_rate']]\npurpose_major","e316904d":"sns.catplot(x=\"purpose\", y=\"int_rate\", jitter=False, data=purpose_major);","3e6a1179":"loan_status = loans_final_df.groupby('loan_status')['loan_status'].count()\nloan_status","15a0a163":"plt.figure(figsize=(12,6))\nplt.title('Status of Loans')\nplt.pie(loan_status, autopct='%1.1f%%',labels=loan_status.index ,startangle=180);","b445801b":"sns.set(rc={'figure.figsize':(5,6)})\nplt.title(\"Distribution of Duration of Loans\")\nsns.distplot(loans_final_df.term, kde = False, color='blue');","8c4dc136":"### Which grade of borrowers were the investors most intersted in investing into ?","b4039227":"<b>Darker dots represent the borrowers belonging to the high paygrade frame and the lighter dots represent the borrowers belonging to lower paygrade frame.<\/b>","f96ee83c":"## Limitations","35529868":"* Pandas user guide: https:\/\/pandas.pydata.org\/docs\/user_guide\/index.html\n* Matplotlib user guide: https:\/\/matplotlib.org\/3.3.1\/users\/index.html\n* Seaborn user guide & tutorial: https:\/\/seaborn.pydata.org\/tutorial.html\n* The Lending Club Dataset: https:\/\/www.lendingclub.com\/info\/download-data.action","fcae27fb":"### Well defined Grade clusters give a deeper insight","b031f119":"The datatype of values stored in under the column 'term' is now int.\n\nTo change the datatype of emp_length, we'll have to assign integer values to the strings first, then they can be changed into numeric datatype.","99430d78":"### What were the most common purposes for which the borrowers applied for loans? ","f28d7cc5":"Since the data does not contain any invalid entries or entries that are not realistically feasible , to get a smaller dataframe, we simply use random entries generated by the sample function","bf14d3be":"## Asking and Answering Questions","9781bf8f":"## Exploratory Analysis and Visualization\n","aa77727b":"A large portion of the loans were borrowed to consolidate previous debts and credit card dues.","cac77706":"<b>Grade A<\/b> did <b>not<\/b> receive the most loans, even though they had the <b>most promising financial profile and were the least likely to default.<\/b>\n\n<b>Grade G<\/b> did <b>not<\/b> receive the most loans either even though <b>grade G borrowers promised to pay the highest interest rates and give the maximum returns on the investment.<\/b>","f0883a01":"## References and Future Work","142d8660":"### What was the loan distribution pattern with respect to the paygrade of borrowers , the loan amount and the periodic installment ?","3b16ecc5":"It is quite obvious that the loan amount and installment follow a linear trend(for both 3\/5 years).\n\nDarker clusters are formed away from the origin which implies that borrowers with higher annual income were interested in getting larger loans with greater installment, and the lighter dots are clustered near origin which implies that people with lower annual income chose to get smaller loans having lesser installment.","6d747fd9":"# Exploratory Data Analysis on Peer to Peer Lending\n\nThe following Exploratory analysis has been done on a dataset provided by The Lending Club which was one of the first companies to have started Peer to Peer Lending. P2P lending websites provide a platform that directly connects borrowers to investors. For lenders, P2P lending is a way to generate income on their cash at a rate that exceeds those offered by conventional savings accounts.  The loan applicant posts a financial profile that is assigned a risk category that determines the interest rate the applicant will pay. Most P2P lending sites have a wide range of interest rates based on the creditworthiness of the applicant. The rates for applicants with good credit are often lower than comparable bank rates, while rates for applicants with sketchy credit records may go much higher. However, the default rates of P2P lending make it an interesting case to study and ponder whether the returns are worth the risk.","68a5c93d":"A large fraction of the loans belong to the current state and a very small percentage (less than 5% ) had been fully paid which implies that the other loans might go into bad debts\/delayed returns or the investments haven't matured yet.","11b707de":"Although the barplot clearly implies the increasing trend of interest rates as we go from grade A to G , the Scatterplot provides a deeper insight into the same, by highlighting that borrowers of each grade restricted themselves to getting a loan within certain bounds , since clusters with well defined bounds were observed.","dc5777ac":"### Is there a relation Between Purpose of Loan and the Interest Rate ?","d1f27b0b":"The dataset used for the above analysis consisted of data that was released by the Lending Club, so the factor of Selection Bias cannot be ignored. The data was more inclined towards loans that were paid off in time , and the default rate of the loans calculated by the above dataset was far lower than what other sources predict. Hence analyzing the factors that influence whether or not a loan would be defaulted, has been avoided, since it would give inaccurate inferences and insights. The bias is probably to make peer to peer lending seem more lucrative and rewarding , while eliminating the risk involved as compared to traditional investment options.","504fcc2b":"### Employment Period","b8a322c2":"## Inferences and Conclusion","2006c058":"### What is the status of loans that were approved during the observed period, and does it affect the duration for which investors were willing to lend money ?","7b57ac4a":"* A lot of borrowers applied for P2P loans to clear their existing debts and credit card dues, which would otherwise incur extraordinary due charges.\n* The investors opt to lend their money to borrowers who offer a combination of lesser risk and greater return (i.e borrowers belonging to Grade B and C)\n* Shorter Duration Loans are more popular among investors.\n* A lot of the borrowers who got loans, had been employed for a long time (>10 years).\n* The purpose of the loan also influences the rate of interest that the borrower would be willing to pay.\n* Most of the loans had an interest rate of around 10% (or greater),this can be because the borrowers having good financial profiles can get loans from banks at a lower interest rate and might not have to turn to P2P loans to raise money.","fdbdfacc":"* Choose a different set of columns to analyze other facets of the data\n* Prepare an analysis focusing on defaulted loans and determine which of the factors among loan amount , interest rate, annual income, installment or the grade of the borrower is the most important factor in loans being defaulted\n* Compare the results of this year's data with the other years and identify interesting trends\n* Compare the results of this data with the other investment opportunities for the same amount frame to compare opportunity cost.","780328cb":"## Grade of Borrower Determines Interest Rate of the Loan","6a113240":"### Distribution of Amount of Loan","9fde91a4":"A lot of interesting inferences have been drawn from the analysis, here's a summary of a few of them:","f2213e0a":"The peak of the graph can be seen at $ 10,000 , after which the curve falls gradually , which suggests that less number of investors chose to invest large amounts and the bulk of the loans given were small - midranged.","a590dd7e":"Most investors chose to give out loans for a period of 3 years instead of 5 years.\n\nThis observation is backed by the fact that resources invested in peer to peer lending are no longer liquid and cannot be withdrawn (without incurring losses) from the market before the specified period. Thus they choose to invest in short duration loans, so as to avoid getting stuck in the long maturity period as shown by the piechart.","94dd8e3b":"<b>We see that Grades B and Grade C borrowers were the favourites among investors since they offered an optimum balance between the risk and returns.<\/b>","8226769e":"The borrowers agreed to pay higher rates of interest when they needed cash for debt consolidation, improvement and to pay off credit card dues. However they were reluctant to pay higher rates when they needed the money for major purchases, medical reasons or for funding their vacations.","e225cee4":"## Data Preparation and Cleaning\n\nThe original dataset contained more than 60,000 rows and 60 columns. The data was read from a csv file,unnecessary and irrelevant columns were dropped , by storing the selected columns in a list and performing the\n\nnew_dataframe = original_dataframe[selected_columns].copy() operation\n\nThe rows were cleaned using \n\npandas.dataframe.dropna(axis = 0 , how = 'any') \n\nso that any row having a Nan value for any of the selected columns, gets dropped.This dataframe was then written into the loans_data.csv. The dataframe still has 2000 rows. To reduce the number of rows , we'll use dataframe.sample(n=1000) to get a random dataframe of 1000 entries and store it in the loans_final_df dataframe."}}