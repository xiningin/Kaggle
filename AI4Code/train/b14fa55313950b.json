{"cell_type":{"e5c2128e":"code","76108848":"code","cf9af839":"code","80f89ee4":"code","a5a30f28":"code","f07031bb":"code","56b849e1":"code","b9306af2":"code","3d7437cf":"code","7d2aeae8":"code","dd95d978":"code","83b00a9e":"code","ae30e8ef":"code","975e984d":"code","e24a8a7a":"code","1856d7dd":"code","4458c0fb":"code","6d1db03d":"code","ff9ccad8":"code","f15e89b4":"code","fbb627ee":"code","5bdaa138":"code","4b14a7ca":"code","6f31bfd0":"markdown","5e394203":"markdown","814d0034":"markdown","b692a69c":"markdown","ed0611e9":"markdown","712bf3b9":"markdown","f1bc78da":"markdown","bfedc60a":"markdown","f2949297":"markdown","e3750a2a":"markdown","8b0b9cc3":"markdown","24f48ba7":"markdown","9d5ae650":"markdown","e8029cab":"markdown","0fca22ad":"markdown","06261ef7":"markdown","0a5db4a1":"markdown"},"source":{"e5c2128e":"#!pip install openpyxl\nimport pandas as pd\nimport datetime as dt\nimport matplotlib.pyplot as plt\nimport seaborn as sns","76108848":"# Veri setinin okutulmas\u0131 \ndf_ = pd.read_csv(\"..\/input\/online-retail-ii-uci\/online_retail_II.csv\")\ndf = df_.copy()\ndf.head()","cf9af839":"df.shape","80f89ee4":"# Toplam sat\u0131n alma kazanc\u0131 i\u00e7in \"TotalPrice\" de\u011fi\u015fkeni olu\u015fturma\ndf[\"TotalPrice\"] = df[\"Quantity\"] * df[\"Price\"] ","a5a30f28":"#Eksik g\u00f6zlemlerin incelenmesi\ndf.isnull().sum()","f07031bb":"# Eksik g\u00f6zlemler veri setinden kal\u0131c\u0131 olarak \u00e7\u0131kar\u0131lmas\u0131\ndf.dropna(inplace = True) ","56b849e1":"df.shape\n","b9306af2":"# Toplam \u00fcr\u00fcn kodu\ndf[\"StockCode\"].nunique()","3d7437cf":"df.describe().T","7d2aeae8":"#Faturalarda iadeler oldu\u011fu i\u00e7in Quantity ve Price de\u011fi\u015fkenlerinde negatif de\u011ferler mevcuttur. \u0130adeler veri setinden \u00e7\u0131kar\u0131ld\u0131.\ndf = df[~df[\"Invoice\"].str.contains(\"C\", na=False)]\ndf.shape","dd95d978":"df[\"InvoiceDate\"].max()\n","83b00a9e":"# En son al\u0131\u015fveri\u015f yap\u0131lan tarihe 2 g\u00fcn eklenerek analiz tarihi belirlendi. \ntoday_date = dt.datetime(2011, 12, 11)\ntoday_date","ae30e8ef":"df[\"InvoiceDate\"] = pd.to_datetime(df[\"InvoiceDate\"])","975e984d":"\nrfm = df.groupby('Customer ID').agg({'InvoiceDate': lambda date: (today_date - date.max()).days,\n                                     'Invoice': lambda num: num.nunique(),\n                                     'TotalPrice': lambda TotalPrice: TotalPrice.sum()})","e24a8a7a":"rfm.columns = [\"Recency\", \"Frequency\", \"Monetary\"]\n","1856d7dd":"rfm.head()","4458c0fb":"plt.scatter(rfm['Recency'], rfm['Frequency'],\n            color = 'orchid',\n            marker = '*', alpha = 0.3)\n\nplt.title('Scatter Plot for Recency and Frequency')\nplt.xlabel('Recency')\nplt.ylabel('Frequency')\nplt.show()","6d1db03d":"plt.scatter(rfm['Monetary'], rfm['Frequency'],\n            color = 'orchid',\n            marker = '*', alpha = 0.3)\n\nplt.title('Scatter Plot for Monetary and Frequency')\nplt.xlabel('Monetary')\nplt.ylabel('Frequency')\nplt.show()","ff9ccad8":"#Recency skorunda en yak\u0131n tarih 5 , en uzak tarih 1 de\u011ferini al\u0131r.\nrfm[\"Recency_Score\"] = pd.qcut(rfm[\"Recency\"], 5, labels=[5,4,3,2,1]) \n\n#Frequency skorunda en az s\u0131kl\u0131k 1 , en fazla s\u0131kl\u0131k 5 de\u011ferini al\u0131r. \nrfm[\"Frequency_Score\"] = pd.qcut(rfm[\"Frequency\"].rank(method = \"first\"),5 ,labels=[1,2,3,4,5]) \n\n#Monetary skorunda en az para 1, en fazla para 5 de\u011ferini al\u0131r.\nrfm[\"Monetary_Score\"] = pd.qcut(rfm[\"Monetary\"], 5, labels=[1,2,3,4,5]) \n\nrfm.head()","f15e89b4":"#RFM \nrfm[\"RFM_Score\"] =  (rfm[\"Recency_Score\"].astype(str) + rfm[\"Frequency_Score\"].astype(str))","fbb627ee":"seg_map = {\n    r'[1-2][1-2]': 'hibernating',\n    r'[1-2][3-4]': 'at_Risk',\n    r'[1-2]5': 'cant_loose',\n    r'3[1-2]': 'about_to_sleep',\n    r'33': 'need_attention',\n    r'[3-4][4-5]': 'loyal_customers',\n    r'41': 'promising',\n    r'51': 'new_customers',\n    r'[4-5][2-3]': 'potential_loyalists',\n    r'5[4-5]': 'champions'\n}\n\n\nrfm[\"Segment\"] = rfm[\"RFM_Score\"].replace(seg_map,regex = True)\nrfm = rfm[[\"Recency\", \"Frequency\", \"Monetary\", \"RFM_Score\",\"Segment\"]]\nrfm.head()","5bdaa138":"segments_counts = rfm['Segment'].value_counts().sort_values(ascending=True)\n\nfig, ax = plt.subplots()\n\nbars = ax.barh(range(len(segments_counts)),\n              segments_counts,\n              color='orchid')\nax.set_frame_on(False)\nax.tick_params(left=False,\n               bottom=False,\n               labelbottom=False)\nax.set_yticks(range(len(segments_counts)))\nax.set_yticklabels(segments_counts.index)\n\nfor i, bar in enumerate(bars):\n        value = bar.get_width()\n        if segments_counts.index[i] in ['champions']:\n            bar.set_color('salmon')\n        ax.text(value,\n                bar.get_y() + bar.get_height()\/2,\n                '{:,} ({:}%)'.format(int(value),\n                                   int(value*100\/segments_counts.sum())),\n                va='center',\n                ha='left')\nplt.show()","4b14a7ca":"rfm[[\"Segment\", \"Recency\",\"Frequency\",\"Monetary\"]].groupby(\"Segment\").agg([\"mean\",\"count\",\"max\"]).round()","6f31bfd0":"### \u0130\u015f Problemi\n","5e394203":"![rfm skor.png](attachment:069a3368-3593-45a2-af71-366f0bcf88e8.png)","814d0034":"**Champions**\n* Bu segmentte 852 ki\u015fi bulunmaktad\u0131r.\n* Ortalama 9 g\u00fcn \u00f6nce al\u0131\u015fveri\u015f yap\u0131lm\u0131\u015ft\u0131r. \n* Al\u0131\u015fveri\u015f yap\u0131lma frekans\u0131 19, toplam al\u0131\u015fveri\u015f say\u0131s\u0131  398'dir.\n* Toplam 608.822 Sterlin harcama yap\u0131lm\u0131\u015ft\u0131r. \n\n**Aksiyon**\n\n Bu segmentteki m\u00fc\u015fterileri detayl\u0131 analiz ederek ki\u015fiselle\u015ftirilmi\u015f kampanyalar olu\u015fturulabilir. \n B\u00f6ylece kendilerini \u00f6zel hissedeceklerdir. \u00d6rne\u011fin \u00f6zel g\u00fcnlerde \u00fcr\u00fcn hediyeleri, kampanyalar yap\u0131labilir.Yeni \u00fcr\u00fcnleri hediye ederek markan\u0131z\u0131 tan\u0131tman\u0131za destek olabilirler\n\n**Need Attention**\n* Bu segmentte 270 ki\u015fi bulunmaktad\u0131r.\n* Ortalama 114 g\u00fcn \u00f6nce al\u0131\u015fveri\u015f yap\u0131lm\u0131\u015ft\u0131r. \n* Al\u0131\u015fveri\u015f yap\u0131lma frekans\u0131 3, toplam al\u0131\u015fveri\u015f say\u0131s\u0131  4'dir.\n* Toplam 39.916 Sterlin harcama yap\u0131lm\u0131\u015ft\u0131r. \n\n**Aksiyon**\n\nBu m\u00fc\u015fterilere markam\u0131z\u0131 hat\u0131rlatmak ve tekrar sat\u0131n alma yapmas\u0131n\u0131 sa\u011flamak i\u00e7in k\u0131sa s\u00fcreli indirimler yap\u0131labilir. \n\n\n**Can't Loose**\n* Bu segmentte 71 ki\u015fi bulunmaktad\u0131r.\n* Ortalama 332 g\u00fcn \u00f6nce al\u0131\u015fveri\u015f yap\u0131lm\u0131\u015ft\u0131r. \n* Al\u0131\u015fveri\u015f yap\u0131lma frekans\u0131 16, toplam al\u0131\u015fveri\u015f say\u0131s\u0131  155'dir.\n* Toplam 77.556 Sterlin harcama yap\u0131lm\u0131\u015ft\u0131r. \n\n**Aksiyon**\n\nEn son al\u0131\u015fveri\u015f 332 g\u00fcn yap\u0131lm\u0131\u015f olsa bile toplam al\u0131\u015fveri\u015f say\u0131s\u0131 y\u00fcksektir.  Uzun s\u00fcre gelmeyen ama geldi\u011finde de  fazla al\u0131\u015fveri\u015f yapan m\u00fc\u015fteri grubudur. Bu m\u00fc\u015fterilere anketler g\u00f6ndererek s\u00fcreci analiz edilebilir, e-mail ile ki\u015fiye \u00f6zel kampanyalar payla\u015farak geri kazan\u0131labiliriz. ","b692a69c":"* Recency(Yenilik)        : M\u00fc\u015fterinin son sat\u0131n almas\u0131ndan bug\u00fcne kadar ge\u00e7en s\u00fcre. \n\n* Frequency(S\u0131kl\u0131k)       : Toplam sat\u0131n alma say\u0131s\u0131.\n\n* Monetary(Parasal De\u011fer) : M\u00fc\u015fterinin yapt\u0131\u011f\u0131 toplam harcama.\n","ed0611e9":"### De\u011fi\u015fkenler","712bf3b9":"**Invoice**   : Fatura Numaras\u0131. E\u011fer bu kod C ile ba\u015fl\u0131yor ise i\u015flemin iptal edildi\u011fini g\u00f6sterir.\n\n**StockCode**   : \u00dcr\u00fcn Kodu. Her bir \u00fcr\u00fcn i\u00e7in e\u015fsiz numara.\n\n**Description** : \u00dcr\u00fcn ismi\n\n**Quantity**    : Sat\u0131lan \u00fcr\u00fcn adedi\n\n**InvoiceDate** : Fatura tarihi\n\n**Price**   : Fatura fiyat\u0131(Sterlin)\n\n**CustomerID**  : E\u015fsiz m\u00fc\u015fteri numaras\u0131\n\n**Country**     : \u00dclke ismi\n\n\n","f1bc78da":"#### Monetary Ve Frequency De\u011ferleri \u0130\u00e7in Sa\u00e7\u0131l\u0131m Grafi\u011fi","bfedc60a":"### Veri Haz\u0131rlama ve \u00d6n \u0130\u015fleme ","f2949297":"![image.png](attachment:ff3991f3-2e8a-49c7-bc82-19d9d6569198.png)\n\nhttps:\/\/ieltspracticeonline.com\/wp-content\/uploads\/2020\/08\/ielts-speaking-part-3-online-retail-bussinesses.png","e3750a2a":"#### Recency Ve Frequency De\u011ferleri \u0130\u00e7in Sa\u00e7\u0131l\u0131m Grafi\u011fi","8b0b9cc3":"### Veri Seti Hikayesi","24f48ba7":"### RFM Metriklerinin Hesaplanmas\u0131 ","9d5ae650":"Online Retail II isimli veri seti \u0130ngiltere merkezli online bir sat\u0131\u015f ma\u011fazas\u0131n\u0131n 01\/12\/2009 - 09\/12\/2011 tarihleri aras\u0131ndaki sat\u0131\u015flardan olu\u015fmaktad\u0131r. \u00dcr\u00fcn katalo\u011funda hediyelik e\u015fyalar yer almaktad\u0131r. \n\nhttps:\/\/archive.ics.uci.edu\/ml\/datasets\/Online+Retail+II","e8029cab":"#### **Segmentlerin betimsel istatistiklerinin yorumlanmas\u0131**\n","0fca22ad":"Bir e-ticaret firmas\u0131 m\u00fc\u015fretilerini segmentlere ay\u0131rarak pazarlama stratejileri belirlenmesi ve gelir art\u0131\u015f\u0131 hedeflenmektedir. Firma i\u00e7in \u00e7ok kazan\u00e7l\u0131 olan m\u00fc\u015fterileri elde tutmak i\u00e7in farkl\u0131 kampanyalar, yeni m\u00fc\u015fteriler i\u00e7in farkl\u0131 kampanyalar d\u00fczenlemek istemektedir. \n\n","06261ef7":"#### RFM Skorlar\u0131","0a5db4a1":"**Veri seti Customer ID de\u011fi\u015fkenine g\u00f6re gruplanm\u0131\u015f ve RFM metrikleri hesaplanm\u0131\u015ft\u0131r.**\n* Recency de\u011feri i\u00e7in analiz tarihi ve m\u00fc\u015fterinin en son al\u0131\u015fveri\u015f yapt\u0131\u011f\u0131 tarihin g\u00fcn olarak fark\u0131d\u0131r. Bu hesaplama i\u00e7in InvoiceDate de\u011fi\u015fkeni kullan\u0131ld\u0131.\n* Frequency de\u011feri i\u00e7in  m\u00fc\u015fterinin yapt\u0131\u011f\u0131 toplam al\u0131\u015fveri\u015f say\u0131s\u0131 al\u0131nd\u0131.Bu hesaplama i\u00e7in Invoice de\u011fi\u015fkeni kullan\u0131ld\u0131.\n* Monetary de\u011feri m\u00fc\u015fterinin toplam harcama tutar\u0131d\u0131r. Bu hesaplama i\u00e7in TotalPrice de\u011fi\u015fkeninin toplam\u0131 al\u0131nd\u0131."}}