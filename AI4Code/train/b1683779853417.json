{"cell_type":{"96648666":"code","faacfb5b":"code","7d92e87b":"code","2f6c5fbf":"code","aab9c4cb":"code","aecdb9bf":"markdown","8982963b":"markdown","bc98f6fb":"markdown","badb8d02":"markdown","d7903f2e":"markdown","28bd48a2":"markdown"},"source":{"96648666":"pip install openpyxl","faacfb5b":"from openpyxl import load_workbook, Workbook\nfrom openpyxl.chart import BarChart, Series, Reference\nimport pandas as pd","7d92e87b":"# define buat variable file\nfile1 = '..\/input\/scode2\/jumlah-penduduk-kota-bandung.csv'\nfile2 = '..\/input\/scode2\/luas-wilayah-menurut-kecamatan-di-kota-bandung-2017.csv'\nfile_akhir = 'kepadatan_penduduk.xlsx'","2f6c5fbf":"# define class buat proses\nclass kepadatan_penduduk:\n    # fungsi modul\n    def __init__(self, file1, file2, file3):\n        self.file1 = file1\n        self.file2 = file2\n        self.file_akhir = file3\n        \n    # fungsi proses\n    def proses_data(self):\n        # membaca data csv\n        df1 = pd.read_csv(self.file1)\n        df2 = pd.read_csv(self.file2)\n        # rename kolom kecamatan\n        df1.rename(columns={'Kecamatan  ': 'kecamatan'},inplace=True)\n        df2.rename(columns={'Nama Kecamatan': 'kecamatan'},inplace=True)\n        # menyamakan isi kolom \/ buat lowercase dan hapus spasi\n        df1['tags'] = df1['kecamatan'].apply(lambda x: x.lower().replace(\" \",\"\"))\n        df2['tags'] = df2['kecamatan'].apply(lambda x: x.lower().replace(\" \",\"\"))\n        # merge table\n        df = pd.merge(df1, df2, on='tags')\n        # mencari nilai kepadatan\n        list_hasil = []\n        for index in range(0, len(df.index)):\n            list_hasil.append(int(df.iloc[index,2])\/int(df.iloc[index,5])*100)\n            \n        df['kepadatan'] = list_hasil\n        df_akhir = df[['kecamatan_x', 'kepadatan']]\n        \n        # masukkan pada file excel\n        try:\n            df_akhir.to_excel(self.file_akhir, index=False)\n            print('berhasil')\n        except:\n            ('gagal')\n        \n        self.index = index\n        #print(df_akhir)\n    # fungsi visualisasi\n    def visualisasi(self):\n        wb = load_workbook(filename=self.file_akhir)\n        ws = wb.active\n        \n        chart = BarChart()\n        chart.type = \"col\"\n        chart.style = 5\n        chart.title = \"Kepadatan Penduduk Kota Bandung\"\n        chart.y_axis.title = 'Jumlah Pendidik per 100m2'\n        chart.x_axis.title = 'Kecamatan'\n        \n        data = Reference(ws, min_col=2, min_row=1, max_row=self.index, max_col=2)\n        cats = Reference(ws, min_col=1, min_row=2, max_row=self.index)\n        chart.height = 10\n        chart.weight = 30\n        chart.add_data(data, titles_from_data=True)\n        chart.set_categories(cats)\n        ws.add_chart(chart, \"D2\")\n        \n        wb.save(self.file_akhir)","aab9c4cb":"data = kepadatan_penduduk(file1, file2, file_akhir)\ndata.proses_data()\ndata.visualisasi()","aecdb9bf":"Pada proses ini saya akan melakukan visualisasi data namun hasil visualisasinya akan ditampilkan pada workbook di excel bukan pada output python.","8982963b":"# Import File","bc98f6fb":"# Seluruh proses disimpan dalam class kepadatan_penduduk","badb8d02":"# Bekerja dengan Python dan Excel","d7903f2e":"Proses pertama adalah melakukan instalasi library openpyxl yang merupakan libarary yang dapat memproses file excel baik membaca ataupun menulis (read\/write) dan import library yang dibutuhkan seperti pandas serta modul dari openpyxl","28bd48a2":"melakukan visualisasi dan print 'Berhasil' jika proses berjalan dan dapat menampilkan hasil yang sesuai"}}