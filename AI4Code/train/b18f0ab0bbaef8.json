{"cell_type":{"9b8d00bc":"code","53a3e5aa":"code","c71d5d12":"code","1a6d8086":"code","99e3fb20":"code","d2279c02":"code","89df1a74":"code","6348355a":"code","4607c5fa":"code","9854a39e":"code","7ee2c22b":"code","30b82670":"code","b54c565f":"code","485a147f":"code","78f9ad3b":"code","fb1535f6":"code","ca043b5a":"code","a5e0e485":"code","6be343af":"code","e9aaa217":"code","3bdf226e":"code","da73b450":"code","3ca744c9":"code","3eba6cbb":"markdown","081699ea":"markdown","5e442252":"markdown","efd0da91":"markdown","759be08a":"markdown","8163fe4e":"markdown","3b6dce1a":"markdown","0173b6b0":"markdown","56e514b9":"markdown","3db22764":"markdown","3e1d7d7f":"markdown","e8010764":"markdown","4267ed51":"markdown","32ce896c":"markdown","69e06765":"markdown","c194c226":"markdown","55c4ce61":"markdown","67185134":"markdown","ca5f373d":"markdown","409d5627":"markdown","6d84e7c2":"markdown","67b20f23":"markdown","f1bdab9a":"markdown"},"source":{"9b8d00bc":"%%HTML\n<div class='tableauPlaceholder' id='viz1643348137607' style='position: relative'><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/> <param name='embed_code_version' value='3' \/> <param name='site_root' value='' \/><param name='name' value='Covid19DataExploration_16433466359740&#47;Dashboard1' \/><param name='tabs' value='no' \/><param name='toolbar' value='yes' \/><param name='animate_transition' value='yes' \/><param name='display_static_image' value='yes' \/><param name='display_spinner' value='yes' \/><param name='display_overlay' value='yes' \/><param name='display_count' value='yes' \/><param name='language' value='en-GB' \/><\/object><\/div>                <script type='text\/javascript'>                    var divElement = document.getElementById('viz1643348137607');                    var vizElement = divElement.getElementsByTagName('object')[0];                    if ( divElement.offsetWidth > 800 ) { vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';} else { vizElement.style.width='100%';vizElement.style.height='1227px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>","53a3e5aa":"# Project Id with the required dataset\nPROJECT_ID = 'ninth-quarter-324704'\n\n# Importing the BQ API Client library\nfrom google.cloud import bigquery\nclient = bigquery.Client(project='ninth-quarter-324704', location='US')\n\n# Constructing a reference to the Covid_Data that is within the project\ndataset_ref = client.dataset('Covid_Data', project=PROJECT_ID)\n\n# Making an API request to fetch the dataset\ndataset = client.get_dataset(dataset_ref)\n\n# Setting up BQ Magics\n%pip install --upgrade google-cloud-bigquery[bqstorage,pandas]\n%load_ext google.cloud.bigquery\nimport google.cloud.bigquery.magics","c71d5d12":"#Getting table metadata\nquery1 = \"\"\"\n        SELECT table_schema, table_name, ddl\n        FROM `ninth-quarter-324704.Covid_Data`.INFORMATION_SCHEMA.TABLES\n        \"\"\"\n\nquery_job1 = client.query(query1)\ncoviddata = query_job1.to_dataframe()\nprint(coviddata)","1a6d8086":"#Covid Deaths Table\nquery2 = \"\"\"\nSELECT *\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths`\nLIMIT 100\n\"\"\"\nquery_job2 = client.query(query2)\ncoviddeaths = query_job2.to_dataframe()\nprint(coviddeaths)\n\n#Covid Vaccinations Table\nquery3 = \"\"\"\nSELECT *\nFROM `ninth-quarter-324704.Covid_Data.CovidVaccinations`\nLIMIT 100\n\"\"\"\nquery_job3 = client.query(query3)\ncovidvaccinations = query_job3.to_dataframe()\nprint(covidvaccinations)","99e3fb20":"query4 = \"\"\"\nSELECT location, date,\n total_cases, total_deaths, (total_deaths\/total_cases)*100 AS death_percent\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths`\nORDER BY location, date;\n\"\"\"\n\nquery_job4 = client.query(query4)\ndeathrate = query_job4.to_dataframe()\nprint(deathrate)","d2279c02":"query5 = \"\"\"\nSELECT location, date, total_cases,total_deaths, (total_deaths\/total_cases)*100 AS death_percent\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths`\nWHERE location = \"India\"\nORDER BY location, date;\n\"\"\"\nquery_job5 = client.query(query5)\ndeathrate_india = query_job5.to_dataframe()\nprint(deathrate_india)","89df1a74":"query6 = \"\"\"\nSELECT location, total_infected, total_died,(total_died\/total_infected * 100) AS percent_died\nFROM (SELECT location, MAX(total_cases) AS total_infected,\n MAX(total_deaths) AS total_died\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths`\nWHERE location = \"India\"\nGROUP BY location\n)\n\"\"\"\nquery_job6 = client.query(query6)\noverall_dr_india = query_job6.to_dataframe()\nprint(overall_dr_india)","6348355a":"query7 = \"\"\"\nSELECT location, total_pop, total_infected ,(total_infected\/total_pop * 100) AS percent_infected\nFROM (SELECT location, MAX(population) AS total_pop,\n MAX(total_cases) AS total_infected\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths`\nWHERE location = \"India\"\nGROUP BY location\n)\n\"\"\"\nquery_job7 = client.query(query7)\noverall_inf_india = query_job7.to_dataframe()\nprint(overall_inf_india)","4607c5fa":"query8 = \"\"\"\nSELECT location, population,\n MAX(total_cases) AS highest_infection_count,\n MAX((total_cases\/population)*100) AS highest_infection_percent\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths`\nGROUP BY location, population\nORDER BY highest_infection_percent DESC\nLIMIT 1\n\"\"\"\nquery_job8 = client.query(query8)\nhighest_inf = query_job8.to_dataframe()\nprint(highest_inf)","9854a39e":"query9 = \"\"\"\nSELECT location, MAX(total_deaths) AS total_death_count\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths`\nWHERE continent IS NOT NULL\nGROUP BY location\nORDER BY total_death_count DESC\nLIMIT 1\n\"\"\"\nquery_job9 = client.query(query9)\nhighest_dr = query_job9.to_dataframe()\nprint(highest_dr)","7ee2c22b":"query10 = \"\"\"\nSELECT location, Max(total_cases_per_million) as highest_cases_per_million\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths`\nGROUP BY location\nORDER BY highest_cases_per_million DESC\nLIMIT 1;\n\"\"\"\nquery_job10 = client.query(query10)\nhcases_perm = query_job10.to_dataframe()\nprint(hcases_perm)","30b82670":"query11 = \"\"\"\nSELECT location, Max(total_deaths_per_million) As highest_deaths_per_million\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths`\nGROUP BY location\nORDER BY highest_deaths_per_million DESC\nLIMIT 1;\n\"\"\"\nquery_job11 = client.query(query11)\nhdeaths_perm = query_job11.to_dataframe()\nprint(hdeaths_perm)","b54c565f":"query12 = \"\"\"\nSELECT location,\n AVG(total_cases_per_million) AS average_cases_per_million,\n AVG(total_deaths_per_million) AS average_deaths_per_million\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths`\nWHERE location = \"India\"\nGROUP BY location\n\"\"\"\nquery_job12 = client.query(query12)\ncases_deaths = query_job12.to_dataframe()\nprint(cases_deaths)","485a147f":"query13 = \"\"\"\nSELECT deaths.location, deaths.date,\n deaths.population, vacc.new_vaccinations\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths` AS deaths\nINNER JOIN `ninth-quarter-324704.Covid_Data.CovidVaccinations` AS vacc\nON deaths.location = vacc.location AND deaths.date = vacc.date\nWHERE deaths.continent IS NOT NULL\nORDER BY location, date;\n\"\"\"\nquery_job13 = client.query(query13)\nvaccination = query_job13.to_dataframe()\nprint(vaccination)","78f9ad3b":"#Creating a TEMP table\nquery14 = \"\"\"\nCREATE TABLE IF NOT EXISTS Covid_Data.PopvsVacc\nAS \nSELECT deaths.continent, deaths.location, deaths.date,\n deaths.population, vacc.new_vaccinations,\n  SUM(vacc.new_vaccinations)\n   OVER (PARTITION BY deaths.location\n   ORDER BY deaths.location, deaths.date)  AS rolling_people_vaccinated\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths` AS deaths\nINNER JOIN `ninth-quarter-324704.Covid_Data.CovidVaccinations` AS vacc\nON deaths.location = vacc.location AND deaths.date = vacc.date\nWHERE deaths.continent IS NOT NULL\nORDER BY location, date;\n\"\"\"\nquery_job14 = client.query(query14)\ntemp = query_job14.to_dataframe()\nprint(temp)\n\n#Calculating Percentage\nquery15 = \"\"\"\nSELECT *,(rolling_people_vaccinated\/population)*100 AS percent_population_vaccinated\nFROM `ninth-quarter-324704.Covid_Data.PopvsVacc`\nLIMIT 100\n\"\"\"\nquery_job15 = client.query(query15)\npercent_pop = query_job15.to_dataframe()\nprint(percent_pop)\n","fb1535f6":"query16 = \"\"\"\nSELECT location, (total_people_vaccinated\/population)*100 AS percent_people_vaccinated\nFROM (SELECT deaths.location, MAX(people_vaccinated) AS total_people_vaccinated, deaths.population\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths` AS deaths\nINNER JOIN `ninth-quarter-324704.Covid_Data.CovidVaccinations` AS vacc\nON deaths.location = vacc.location AND deaths.date = vacc.date\nWHERE deaths.location = \"India\"\nGROUP BY deaths.population, deaths.location\n)\n\"\"\"\nquery_job16 = client.query(query16)\npercent_indpop = query_job16.to_dataframe()\nprint(percent_indpop)","ca043b5a":"query17 = \"\"\"\nSELECT deaths.location, deaths.population, MAX(vacc.aged_65_older) AS percent_pop_over_65\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths` AS deaths\nINNER JOIN `ninth-quarter-324704.Covid_Data.CovidVaccinations` AS vacc\nON deaths.location = vacc.location AND deaths.date = vacc.date\nWHERE deaths.location = \"India\"\nGROUP BY deaths.population, deaths.location\n\"\"\"\nquery_job17 = client.query(query17)\npop_above65 = query_job17.to_dataframe()\nprint(pop_above65)","a5e0e485":"query18 = \"\"\"\nSELECT deaths.location, deaths.population, MAX(vacc.aged_70_older) AS percent_pop_over_70\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths` AS deaths\nINNER JOIN `ninth-quarter-324704.Covid_Data.CovidVaccinations` AS vacc\nON deaths.location = vacc.location AND deaths.date = vacc.date\nWHERE deaths.location = \"India\"\nGROUP BY deaths.population, deaths.location\n\"\"\"\nquery_job18 = client.query(query18)\npop_above70 = query_job18.to_dataframe()\nprint(pop_above70)","6be343af":"query19 = \"\"\"\nSELECT SUM(new_cases) AS total_cases,\n SUM(new_deaths) AS total_deaths,\n  SUM(new_deaths)\/SUM(new_cases)*100 AS DeathPercentage\nFROM `ninth-quarter-324704.Covid_Data.CovidDeaths`\nWHERE continent is not NULL;\n\"\"\"\nquery_job19 = client.query(query19)\nglobal_stat = query_job19.to_dataframe()\nprint(global_stat)","e9aaa217":"query20 = \"\"\"\nSELECT location, SUM(new_deaths) AS TotalDeathCount\nFrom `ninth-quarter-324704.Covid_Data.CovidDeaths`\nWHERE continent IS NULL\nAND location NOT IN ('World', 'European Union', 'International',\n 'Upper middle income', 'High income','Lower middle income', 'Low income' )\nGROUP BY location\nORDER BY TotalDeathCount DESC;\n\"\"\"\nquery_job20 = client.query(query20)\ncontinents = query_job20.to_dataframe()\nprint(continents)","3bdf226e":"query21 = \"\"\"\nSELECT location,(MAX(people_fully_vaccinated)\/MAX(total_vaccinations))*100 AS percent_fully_vaccinted\nFROM `ninth-quarter-324704.Covid_Data.CovidVaccinations`\nGROUP BY location\nORDER BY percent_fully_vaccinted DESC;\n\"\"\"\nquery_job21 = client.query(query21)\nboth_doses = query_job21.to_dataframe()\nprint(both_doses)","da73b450":"query22 = \"\"\"\nSELECT location,(MAX(total_boosters)\/MAX(people_fully_vaccinated))*100 AS percent_taken_boosters\nFROM `ninth-quarter-324704.Covid_Data.CovidVaccinations`\nGROUP BY location\nORDER BY percent_taken_boosters DESC;\n\"\"\"\nquery_job22 = client.query(query22)\nbooster = query_job22.to_dataframe()\nprint(booster)","3ca744c9":"query23 = \"\"\"\nSELECT location, AVG(positive_rate) AS average_positive_rate\nFROM `ninth-quarter-324704.Covid_Data.CovidVaccinations`\nGROUP BY location\nORDER BY average_positive_rate DESC;\n\"\"\"\nquery_job23 = client.query(query23)\npos_rates = query_job23.to_dataframe()\nprint(pos_rates)","3eba6cbb":"**`7. Which country has the highest death toll?`**","081699ea":"# <span style=\"color:#E55451;\"> Setup <\/span>\n***\nSetting up BigQuery:","5e442252":"**`18. What is the percentage of people who have taken both doses across countries?`**","efd0da91":"# <span style=\"color:#E55451;\"> Table Metadata <\/span>\n***\n\nThe original table conatined **67 columns** and **157,002 rows**. I've split the table into two parts viz.\n* CovidDeaths\n* CovidVaccinations,\n\nand kept only the columns relevant to our analysis. Afterwords, I have cleaned the data using **R**.","759be08a":"**`4. What is the overall death rate in India?`**","8163fe4e":"<p style=\"text-align:center;\"><span style=\"font-size:30px;font-family:brush script mt;color:#728FCE;\">\u201cIf the statistics are boring, you\u2019ve got the wrong numbers.\u201d\u2014 Edward Tufte <\/span><\/p>\n\n\n# <span style=\"color:#E55451;\"> About <\/span>\n***\nThe aim of this project is to perform a brief analysis on COVID19 data using BigQuery and to visulaize the key findings through Tableau. The data source is [Our World Data](https:\/\/ourworldindata.org\/covid-deaths). The nature of this analysis is narrow and selective as the global data available on COVID19 is enormous, and to analyze it all is beyond the scope of this project. I've taken three metrics viz. population infected, death toll and population vaccinated to gauge the effect of the panedemic globally across different countries. Some of the queries are focused on India, as I hail from there so they are relevant to me.\n\n\n# <span style=\"color:#E55451;\"> Data Viz<\/span>\n***\n\nYou can find this viualization here at [Tableau Public](http:\/\/public.tableau.com\/views\/Covid19DataExploration_16433466359740\/Dashboard1?:language=en-GB&publish=yes&:display_count=n&:origin=viz_share_link)\n\nNote: To expand the viz, hide *table of contents* sidebar.","3b6dce1a":"**`2. What are the death rates of COVID19 across different countries on different days?`**","0173b6b0":"**`9. Which coutry has the highest deaths per million?`**","56e514b9":"**` 3. What are the death rates of COVID19 in India on different days?`**","3db22764":"**`16. What are the total cases, total deaths and death percentage worldwide due to COVID?`**","3e1d7d7f":"**`6. Which country has the highest infection rate?`**\n","e8010764":"**`19. What is the percentage of people with both doses who have also taken booster doses across countries?`**","4267ed51":"**`20. What is the average positive rate across countries?`**","32ce896c":"**`10. What is India's average cases and deaths per million`?**","69e06765":"**`8. Which country has the highest total cases per million?`**","c194c226":"**`5. How much of the total Indian population was infected?`**","55c4ce61":"**`13. How much of the Indian population is vaccinated?`**","67185134":"# <span style=\"color:#E55451;\"> Data Exploration <\/span>\n***\n\n\n**`1. Previewing both Tables`**","ca5f373d":"**`17. What is the total death count by continents?`**","409d5627":"**`14. What percentage of the Indian population is 65 or above?`**","6d84e7c2":"**`11. How many people are getting vaccinated each day across different countries?`**","67b20f23":"**`12. What is the cumlative percentage of people getting vaccinated each day`?**","f1bdab9a":"**`15. What percentage of the Indian population is 70 or above?`**"}}