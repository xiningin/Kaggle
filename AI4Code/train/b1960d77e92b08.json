{"cell_type":{"065e1d46":"code","33f7122e":"code","5fe72b6f":"code","60130363":"code","9d6e13a0":"code","a0f4dd57":"code","3390d88d":"code","80e4d643":"code","c23842bd":"code","696c4f8b":"code","385a54a0":"code","6707722d":"code","bf89fc60":"code","f59f25f0":"markdown","123e8d60":"markdown","bce44093":"markdown","e0646398":"markdown","ee70a349":"markdown","486915d8":"markdown"},"source":{"065e1d46":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nfrom subprocess import check_output\nprint(check_output([\"ls\", \"..\/input\"]).decode(\"utf8\"))","33f7122e":"data = pd.read_csv(\"..\/input\/emails.csv\", encoding= \"latin-1\")","5fe72b6f":"data.spam.value_counts()","60130363":"from sklearn.model_selection import train_test_split\ntrain_X, test_X, train_y, test_y = train_test_split(data[\"text\"],data[\"spam\"], test_size=0.2, random_state=10)","9d6e13a0":"from sklearn.feature_extraction.text import CountVectorizer\nhelp(CountVectorizer)","a0f4dd57":"from sklearn.feature_extraction.text import CountVectorizer\nvect = CountVectorizer(stop_words=\"english\")\nvect.fit(train_X) # Find some word that cause most of spam email\nprint(vect.get_feature_names()[0:20])\nprint(vect.get_feature_names()[-20:])","3390d88d":"X_train_df = vect.transform(train_X)\nX_test_df = vect.transform(test_X)\ntype(X_test_df)","80e4d643":"from sklearn.naive_bayes import MultinomialNB\nfrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report\nmodel = MultinomialNB(alpha=1.8)\nmodel.fit(X_train_df,train_y)\npred = model.predict(X_test_df)\naccuracy_score(test_y, pred)","c23842bd":"print(classification_report(test_y, pred , target_names = [\"Not Spam\", \"Spam\"]))","696c4f8b":"confusion_matrix(test_y,pred)","385a54a0":"print(data[\"text\"][1472])\npred = model.predict(vect.transform(data[\"text\"]))\nprint(\"Pred : \",pred[1472])\nprint(\"Main : \",data[\"spam\"][1472])","6707722d":"print(data[\"text\"][10])\npred = model.predict(vect.transform(data[\"text\"]))\nprint(\"Pred : \",pred[10])\nprint(\"Main : \",data[\"spam\"][10])","bf89fc60":"dir(vect.transform)","f59f25f0":"# Read csv file using panda ","123e8d60":"# Select a Non Spam email ","bce44093":"Extract token counts out of raw text documents using the vocabulary\n    fitted with fit or the one provided to the constructor. [Details..](http:\/\/\nhttp:\/\/scikit-learn.org\/stable\/modules\/generated\/sklearn.feature_extraction.text.CountVectorizer.html#sklearn.feature_extraction.text.CountVectorizer.fit_transform)","e0646398":"[stop_words](http:\/\/https:\/\/github.com\/scikit-learn\/scikit-learn\/blob\/bac89c2\/sklearn\/feature_extraction\/text.py#L645) contains some frequent work in english language.","ee70a349":"# Select a spam Email","486915d8":"There are 2 column in csv dataset. One is Text data and other on is spam or not spam.  We want to see number of class in spam cloumn and number of element each one contain."}}