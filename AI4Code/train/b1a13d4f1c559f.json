{"cell_type":{"4d6daff5":"code","837dc04b":"code","ef5fb588":"code","91345921":"code","56a2bb5b":"code","8257c1ec":"code","aff31cfb":"code","39ac2f7b":"code","5562d5b6":"code","b66d827b":"code","19d57f57":"code","dd35177a":"code","98c704fc":"code","3cb1bbd5":"code","d2ec903a":"code","43736667":"code","415f2ad8":"code","39c699ed":"code","0a4787d2":"code","1ca8d7d7":"code","0911d906":"code","f0677e18":"code","96448e44":"code","3a6134d7":"code","f34bb120":"code","0c572093":"code","7b7f4027":"code","3fa4f55f":"code","05ed9069":"code","7bf27858":"code","4eb2e909":"code","7243ee1d":"code","eb76efe1":"code","e10cf115":"code","379098b5":"code","cd3ea989":"code","a94021da":"code","baf3bd65":"code","35d3708d":"markdown","5035ab0d":"markdown","cd29012d":"markdown","ef0e0478":"markdown","88f95ccb":"markdown","a05658d3":"markdown","4121389b":"markdown","312e8f29":"markdown"},"source":{"4d6daff5":"# Install Pytorch\n\n!pip install torch==1.4.0 torchvision==0.5.0","837dc04b":"# Install neural-style-pt\n\n!git clone https:\/\/github.com\/ProGamerGov\/neural-style-pt","ef5fb588":"# Install gdown\n\n!pip install gdown","91345921":"# Upload images directly from their URL\n\n%cd \/kaggle\/working\n!wget '<stlye-link>'\n!mv g*.jpg style.jpg\n!wget '<content-link>'\n!mv g*.jpg content.jpg","56a2bb5b":"# Create Folders\n\n!mkdir -p \/kaggle\/working\/models\n!mkdir -p \/kaggle\/working\/output","8257c1ec":"# Download Model files\n\n%cd \/kaggle\/working\/models\n!gdown 'https:\/\/drive.google.com\/uc?id=11P8ETst8LeHG1VLZzVNfJdQQmCN4K26n' # channel_pruning.pth\n!gdown 'https:\/\/drive.google.com\/uc?id=1-tSTn9gaZUtEXKEQ3Rm1EWYT2Rm_SVFO' # nin_imagenet_conv.pth\n!gdown 'https:\/\/drive.google.com\/uc?id=1gadRfSA4LCbJ9M-YlTrOjLn-73CF_EUK' # nyud_fcn32s-color-heavy.pth","aff31cfb":"%%writefile \/kaggle\/working\/pass1.sh\n# Create Pass 1 script\n\nSTYLE_IMAGE='\/kaggle\/working\/style.jpg'\nCONTENT_IMAGE='\/kaggle\/working\/content.jpg'\nMODEL_FILE='\/kaggle\/working\/models\/nyud-fcn32s-color-heavy.pth'\nOUTPUT_IMAGE='\/kaggle\/working\/output\/A1.png'\n\npython3 \/kaggle\/working\/neural-style-pt\/neural_style.py \\\n   -style_image $STYLE_IMAGE \\\n   -style_weight 1000 \\\n   -style_scale 1 \\\n   -content_image $CONTENT_IMAGE \\\n   -init random \\\n   -learning_rate 1 \\\n   -print_iter 50 \\\n   -save_iter 250 \\\n   -image_size 512 \\\n   -num_iterations 1000 \\\n   -model_file $MODEL_FILE \\\n   -content_layers relu1_1,relu2_1,relu3_1,relu4_1,relu5_1 \\\n   -style_layers relu1_1,relu2_1,relu3_1,relu4_1,relu5_1 \\\n   -optimizer lbfgs \\\n   -output_image $OUTPUT_IMAGE \\\n   -tv_weight 0.00001 \\\n   -original_colors 0 \\\n   -backend cudnn ","39ac2f7b":"# Run Pass 1\n\n%cd \/kaggle\/working\n!chmod +x pass1.sh\n!.\/pass1.sh","5562d5b6":"# Download Pass 1\n\nimport os\nos.chdir(r'\/kaggle\/working')","b66d827b":"from IPython.display import FileLink\nFileLink(r'output\/A1.png')","19d57f57":"%%writefile \/kaggle\/working\/pass2.sh\n# Create Pass 2 script\n\nSTYLE_IMAGE='\/kaggle\/working\/style.jpg'\nCONTENT_IMAGE='\/kaggle\/working\/content.jpg'\nINIT_IMAGE='\/kaggle\/working\/output\/A1.png'\nMODEL_FILE='\/kaggle\/working\/models\/nyud-fcn32s-color-heavy.pth'\nOUTPUT_IMAGE='\/kaggle\/working\/output\/A2.png'\n\npython3 \/kaggle\/working\/neural-style-pt\/neural_style.py \\\n   -style_image $STYLE_IMAGE \\\n   -style_weight 1000 \\\n   -style_scale 1 \\\n   -content_image $CONTENT_IMAGE \\\n   -content_weight 5 \\\n   -init image \\\n   -init_image $INIT_IMAGE \\\n   -print_iter 50 \\\n   -save_iter 250 \\\n   -image_size 768 \\\n   -num_iterations 600 \\\n   -model_file $MODEL_FILE \\\n   -content_layers relu1_1,relu2_1,relu3_1,relu4_1,relu5_1 \\\n   -style_layers relu1_1,relu2_1,relu3_1,relu4_1,relu5_1 \\\n   -optimizer lbfgs \\\n   -output_image $OUTPUT_IMAGE \\\n   -tv_weight 0 \\\n   -gpu 0 \\\n   -original_colors 0 \\\n   -backend cudnn ","dd35177a":"# Run Pass 2\n\n%cd \/kaggle\/working\n!chmod +x pass2.sh\n!.\/pass2.sh","98c704fc":"# Download Pass 2\n\nimport os\nos.chdir(r'\/kaggle\/working')","3cb1bbd5":"from IPython.display import FileLink\nFileLink(r'output\/A2.png')","d2ec903a":"%%writefile \/kaggle\/working\/pass3.sh\n# Create Pass 3 script\n\nSTYLE_IMAGE='\/kaggle\/working\/style.jpg'\nCONTENT_IMAGE='\/kaggle\/working\/content.jpg'\nINIT_IMAGE='\/kaggle\/working\/output\/A2.png'\nMODEL_FILE='\/kaggle\/working\/models\/nyud-fcn32s-color-heavy.pth'\nOUTPUT_IMAGE='\/kaggle\/working\/output\/A3.png'\n\npython3 \/kaggle\/working\/neural-style-pt\/neural_style.py \\\n  -style_image $STYLE_IMAGE \\\n  -style_weight 1000 \\\n  -style_scale 1 \\\n  -content_image $CONTENT_IMAGE \\\n  -content_weight 5 \\\n  -init image \\\n  -init_image $INIT_IMAGE \\\n  -print_iter 50 \\\n  -save_iter 250 \\\n  -image_size 1024 \\\n  -num_iterations 1000 \\\n  -model_file $MODEL_FILE \\\n  -content_layers relu1_1,relu2_1,relu3_1,relu4_1,relu5_1 \\\n  -style_layers relu1_1,relu2_1,relu3_1,relu4_1,relu5_1 \\\n  -optimizer lbfgs \\\n  -output_image $OUTPUT_IMAGE \\\n  -tv_weight 0.00001 \\\n  -gpu 0 \\\n  -original_colors 0 \\\n  -backend cudnn \\","43736667":"# Run Pass 3\n\n%cd \/kaggle\/working\n!chmod +x pass3.sh\n!.\/pass3.sh","415f2ad8":"# Download Pass 3\n\nimport os\nos.chdir(r'\/kaggle\/working')","39c699ed":"from IPython.display import FileLink\nFileLink(r'output\/A3.png')","0a4787d2":"%%writefile \/kaggle\/working\/pass4.sh\n# Create Pass 4 script\n\nSTYLE_IMAGE='\/kaggle\/working\/style.jpg'\nCONTENT_IMAGE='\/kaggle\/working\/content.jpg'\nINIT_IMAGE='\/kaggle\/working\/output\/A3.png'\nMODEL_FILE='\/kaggle\/working\/models\/nyud-fcn32s-color-heavy.pth'\nOUTPUT_IMAGE='\/kaggle\/working\/output\/A4.png'\n\npython3 \/kaggle\/working\/neural-style-pt\/neural_style.py \\\n   -style_image $STYLE_IMAGE \\\n   -style_weight 40000 \\\n   -style_scale 1 \\\n   -content_image $CONTENT_IMAGE \\\n   -content_weight 5 \\\n   -init image \\\n   -init_image $INIT_IMAGE \\\n   -print_iter 50 \\\n   -save_iter 250 \\\n   -image_size 1400 \\\n   -num_iterations 1000 \\\n   -model_file $MODEL_FILE \\\n   -content_layers relu1_1,relu2_1,relu3_1,relu4_1,relu5_1 \\\n   -style_layers relu1_1,relu2_1,relu3_1,relu4_1,relu5_1 \\\n   -optimizer lbfgs \\\n   -output_image $OUTPUT_IMAGE \\\n   -tv_weight 0 \\\n   -gpu 0 \\\n   -original_colors 0 \\\n   -backend cudnn \\","1ca8d7d7":"# Run Pass 4\n\n%cd \/kaggle\/working\n!chmod +x pass4.sh\n!.\/pass4.sh","0911d906":"# Download Pass 4\n\nimport os\nos.chdir(r'\/kaggle\/working')","f0677e18":"from IPython.display import FileLink\nFileLink(r'output\/A4.png')","96448e44":"%%writefile \/kaggle\/working\/pass5.sh\n# Create Pass 5 script\n\nSTYLE_IMAGE='\/kaggle\/working\/style.jpg'\nCONTENT_IMAGE='\/kaggle\/working\/content.jpg'\nINIT_IMAGE='\/kaggle\/working\/output\/A4.png'\nMODEL_FILE='\/kaggle\/working\/models\/nyud-fcn32s-color-heavy.pth'\nOUTPUT_IMAGE='\/kaggle\/working\/output\/A5.png'\n\npython3 \/kaggle\/working\/neural-style-pt\/neural_style.py \\\n   -style_image $STYLE_IMAGE \\\n   -style_weight 80000 \\\n   -style_scale 1 \\\n   -content_image $CONTENT_IMAGE \\\n   -content_weight 5 \\\n   -init image \\\n   -init_image $INIT_IMAGE \\\n   -print_iter 50 \\\n   -save_iter 250 \\\n   -image_size 1400 \\\n   -num_iterations 1000 \\\n   -model_file $MODEL_FILE \\\n   -content_layers relu1_1,relu1_2,relu2_1,relu2_2,relu3_1,relu3_2,relu3_3,relu3_4,relu4_1,relu4_2,relu4_3,relu4_4,relu5_1,relu5_2,relu5_3,relu5_4 \\\n   -style_layers relu1_1,relu1_2,relu2_1,relu2_2,relu3_1,relu3_2,relu3_3,relu3_4,relu4_1,relu4_2,relu4_3,relu4_4,relu5_1,relu5_2,relu5_3,relu5_4 \\\n   -optimizer lbfgs \\\n   -output_image $OUTPUT_IMAGE \\\n   -tv_weight 0 \\\n   -gpu 0 \\\n   -original_colors 0 \\\n   -backend cudnn \\","3a6134d7":"# Run Pass 5\n\n%cd \/kaggle\/working\n!chmod +x pass5.sh\n!.\/pass5.sh","f34bb120":"# Download Pass 5\n\nimport os\nos.chdir(r'\/kaggle\/working')","0c572093":"from IPython.display import FileLink\nFileLink(r'output\/A5.png')","7b7f4027":"%%writefile \/kaggle\/working\/pass6.sh\n# Create Pass 6 script\n\nSTYLE_IMAGE='\/kaggle\/working\/style.jpg'\nCONTENT_IMAGE='\/kaggle\/working\/content.jpg'\nINIT_IMAGE='\/kaggle\/working\/output\/A5.png'\nMODEL_FILE='\/kaggle\/working\/models\/nyud-fcn32s-color-heavy.pth'\nOUTPUT_IMAGE='\/kaggle\/working\/output\/A6.png'\n\npython3 \/kaggle\/working\/neural-style-pt\/neural_style.py \\\n   -style_image $STYLE_IMAGE \\\n   -style_weight 40000 \\\n   -style_scale 1 \\\n   -content_image $CONTENT_IMAGE \\\n   -content_weight 0 \\\n   -init image \\\n   -init_image $INIT_IMAGE \\\n   -print_iter 50 \\\n   -save_iter 100 \\\n   -image_size 1800 \\\n   -num_iterations 200 \\\n   -model_file $MODEL_FILE \\\n   -content_layers relu1_1,relu1_2 \\\n   -style_layers relu1_1,relu1_2 \\\n   -optimizer lbfgs \\\n   -output_image $OUTPUT_IMAGE \\\n   -tv_weight 0 \\\n   -gpu 0 \\\n   -original_colors 0 \\\n   -backend cudnn \\","3fa4f55f":"# Run Pass 6\n\n%cd \/kaggle\/working\n!chmod +x pass6.sh\n!.\/pass6.sh","05ed9069":"# Download Pass 6\n\nimport os\nos.chdir(r'\/kaggle\/working')","7bf27858":"from IPython.display import FileLink\nFileLink(r'output\/A6.png')","4eb2e909":"%%writefile \/kaggle\/working\/pass7.sh\n# Create Pass 7 script\n\nSTYLE_IMAGE='\/kaggle\/working\/style.jpg'\nCONTENT_IMAGE='\/kaggle\/working\/content.jpg'\nINIT_IMAGE='\/kaggle\/working\/output\/A6.png'\nMODEL_FILE='\/kaggle\/working\/models\/channel_pruning.pth'\nOUTPUT_IMAGE='\/kaggle\/working\/output\/A7.png'\n\npython3 \/kaggle\/working\/neural-style-pt\/neural_style.py \\\n   -style_image $STYLE_IMAGE \\\n   -style_weight 40000 \\\n   -style_scale 1 \\\n   -content_image $CONTENT_IMAGE \\\n   -content_weight 15 \\\n   -init image \\\n   -init_image $INIT_IMAGE \\\n   -learning_rate 1 \\\n   -print_iter 50 \\\n   -save_iter 100 \\\n   -image_size 3600 \\\n   -num_iterations 200 \\\n   -model_file $MODEL_FILE \\\n   -optimizer adam \\\n   -output_image $OUTPUT_IMAGE \\\n   -tv_weight 0 \\\n   -original_colors 0 \\\n   -backend cudnn \\","7243ee1d":"# Run Pass 7\n\n%cd \/kaggle\/working\n!chmod +x pass7.sh\n!.\/pass7.sh","eb76efe1":"# Download Pass 7\n\nimport os\nos.chdir(r'\/kaggle\/working')","e10cf115":"from IPython.display import FileLink\nFileLink(r'output\/A7.png')","379098b5":"%%writefile \/kaggle\/working\/pass8.sh\n# Create Pass 8 script\n\nSTYLE_IMAGE='\/kaggle\/working\/style.jpg'\nCONTENT_IMAGE='\/kaggle\/working\/content.jpg'\nINIT_IMAGE='\/kaggle\/working\/output\/A7.png'\nMODEL_FILE='\/kaggle\/working\/models\/nin_imagenet_conv.pth'\nOUTPUT_IMAGE='\/kaggle\/working\/output\/A8_final.png'\n\npython3 \/kaggle\/working\/neural-style-pt\/neural_style.py \\\n   -style_image $STYLE_IMAGE \\\n   -style_weight 1000 \\\n   -style_scale 0.5 \\\n   -content_image $CONTENT_IMAGE \\\n   -content_weight 0 \\\n   -init image \\\n   -init_image $INIT_IMAGE \\\n   -learning_rate 1 \\\n   -print_iter 50 \\\n   -save_iter 0 \\\n   -image_size 7200 \\\n   -num_iterations 10 \\\n   -model_file $MODEL_FILE \\\n   -content_layers relu0,relu1 \\\n   -style_layers relu0,relu1 \\\n   -optimizer adam \\\n   -output_image $OUTPUT_IMAGE \\\n   -tv_weight 0 \\\n   -original_colors 0 \\\n   -backend cudnn \\","cd3ea989":"# Run Pass 8\n\n%cd \/kaggle\/working\n!chmod +x pass8.sh\n!.\/pass8.sh","a94021da":"# Download Pass 8\n\nimport os\nos.chdir(r'\/kaggle\/working')","baf3bd65":"from IPython.display import FileLink\nFileLink(r'output\/A8_final.png')","35d3708d":"## `Pass 6`","5035ab0d":"## ` NIN Enlargement`","cd29012d":"## `Pass 1`","ef0e0478":"## `Pass 5`","88f95ccb":"## `Pass 2`","a05658d3":"## `Channel Pruning`","4121389b":"## `Pass 3`","312e8f29":"## `Pass 4`"}}