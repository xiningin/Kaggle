{"cell_type":{"a8c343c0":"code","c76f3579":"code","68a382a4":"code","bdd99944":"code","d45b88b6":"code","756a78d6":"code","23e15cb0":"code","89a318b6":"code","bca6dd7e":"code","43934c89":"code","9ed9a527":"code","cf3dbe41":"code","4c4e9216":"code","637d0e54":"code","ffd77f7c":"code","fab273fe":"code","7d716496":"code","d1e8a8a3":"code","a32c4ea2":"code","e937f913":"code","515844fd":"code","dbf3b64f":"code","e0b43ade":"code","711b49f3":"code","bd355ab2":"code","0bd9c786":"code","3c354b41":"code","51cd2c86":"code","31f30d9f":"code","7080a440":"markdown"},"source":{"a8c343c0":"from fastai import *\nfrom fastai.vision import *\nimport seaborn as sns\nfrom PIL import Image\nfrom matplotlib import pyplot as plt","c76f3579":"path = Path('..\/input\/aptos2019-blindness-detection\/')","68a382a4":"path.ls()","bdd99944":"df = pd.read_csv(path\/'train.csv')\ndf.head()","d45b88b6":"df_test = pd.read_csv(path\/'test.csv')\ndf_test.head()","756a78d6":"print(len(df))\nprint(len(df_test))","23e15cb0":"print(df.isna().sum()) \nprint('-' * 20)\nprint(df_test.isna().sum())","89a318b6":"df.diagnosis.value_counts()","bca6dd7e":"# plot the value counts as histogram\nb = sns.countplot(df['diagnosis'])\nb.axes.set_title('Distribution of diagnosis', fontsize = 30)\nb.set_xlabel('Diagnosis', fontsize = 20)\nb.set_ylabel('Count', fontsize = 20)\nplt.show()","43934c89":"im = Image.open(\"..\/input\/aptos2019-blindness-detection\/train_images\/08b6e3240858.png\")","9ed9a527":"print(im.format, im.size, im.mode)","cf3dbe41":"im = Image.open(\"..\/input\/aptos2019-blindness-detection\/train_images\/0ca0aee4d57e.png\")","4c4e9216":"print(im.format, im.size, im.mode)","637d0e54":"# plot the various sizes of images\ndef get_image_sizes(folder):\n    image_list = (path\/folder).ls()\n    heights = []\n    widths = []\n    ids = []\n\n    for image in image_list:\n        im = Image.open(image)\n        height, width = im.size\n        heights.append(height)\n        widths.append(width)\n        ids.append(str(image)[-16:-4])\n        \n    return pd.DataFrame({'id_code': ids,\n                         'height': heights,\n                         'width': widths})","ffd77f7c":"size_df = get_image_sizes('train_images')\nsize_df.head()","fab273fe":"size_df_test = get_image_sizes('test_images')\nsize_df_test.head()","7d716496":"plt.hist(size_df['height'])","d1e8a8a3":"plt.hist(size_df_test['height'])","a32c4ea2":"plt.hist(size_df['width'])","e937f913":"plt.hist(size_df_test['width'])","515844fd":"# plot the images from 0 and 4 to see the difference\ndf_0 = df[df['diagnosis'] == 0]\ndf_0.head()","dbf3b64f":"df_4 = df[df['diagnosis'] == 4]\ndf_4.head()","e0b43ade":"data = (ImageList.from_df(df_0,path,folder='train_images',suffix='.png')\n        .split_by_rand_pct(0.1, seed=42)\n        .label_from_df()\n        .transform(get_transforms(),size=128)\n        .databunch()).normalize(imagenet_stats)","711b49f3":"# add figsize argument\ndata.show_batch(rows=3)","bd355ab2":"data = (ImageList.from_df(df_4,path,folder='train_images',suffix='.png')\n        .split_by_rand_pct(0.1, seed=42)\n        .label_from_df()\n        .transform(get_transforms(),size=128)\n        .databunch()).normalize(imagenet_stats)","0bd9c786":"data.show_batch(rows=3)","3c354b41":"data = (ImageList.from_df(df_4,path,folder='train_images',suffix='.png')\n        .split_by_rand_pct(0.1, seed=42)\n        .label_from_df()\n        .transform([],size=128)\n        .databunch()).normalize(imagenet_stats)","51cd2c86":"data.show_batch(rows=3, )","31f30d9f":"# in the next notebook work with various augmentations","7080a440":"## Without augmentation"}}