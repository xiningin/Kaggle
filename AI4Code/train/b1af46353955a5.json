{"cell_type":{"23782fed":"code","73e3a8fb":"code","8f6d9a93":"code","34410239":"code","772d1333":"code","751ad3d7":"code","fd444fc3":"code","27a3f1ba":"code","9c52c9f1":"code","e9801131":"code","3f978174":"code","9cfb53f4":"code","1ad6ae7e":"code","aac4dc6c":"code","d7aa6607":"code","8cca615d":"code","1b6d3d18":"code","bd197e81":"code","90ff76e1":"code","0ce31059":"code","81a9503b":"code","ccd18617":"code","b6050b93":"code","4bbf9372":"code","91bc0ffe":"code","395faf2c":"code","cd42a90d":"code","ce849af7":"code","9dd5977e":"code","99d68de8":"code","78e49207":"code","0044d9c5":"code","2ef4e387":"code","c50d4ff5":"code","b434db4b":"code","b58c5625":"code","c483b645":"code","97b98510":"code","d876b6ad":"code","80612aea":"code","2c7e1863":"markdown"},"source":{"23782fed":"import numpy as np\nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nimport plotly.graph_objects as go\n\n%matplotlib inline\n\nimport re\nimport warnings\nwarnings.simplefilter(action='ignore', category=FutureWarning)\n","73e3a8fb":"data_full = pd.read_csv('..\/input\/bank-direct-marketing\/bank-full.csv')\ndata_full.head()","8f6d9a93":"col=str(data_full.columns[0])\ncolumns=col.split(';')\ncolumns","34410239":"columns=[re.sub('[^a-zA-Z0-9]+', '', column) for column in columns]\ncolumns","772d1333":"data_lst=[]\nfor val in range(0,len(data_full.values)):\n    ele = data_full.values[val][0]#.replace('-','0')\n\n    data_lst.append([re.sub('[^a-zA-Z0-9\/\/-]+', ',', ele)])\n    \n    \n","751ad3d7":"df_chk=pd.DataFrame(data_lst)\ndf_chk.columns=['unified']\ndf_chk.head()","fd444fc3":"df = df_chk.join(df_chk['unified'].str.split(',', expand=True).add_prefix('unified'))\ndf=df.drop(['unified','unified17'], axis=1)\ndf.columns=columns","27a3f1ba":"df.head(5)","9c52c9f1":"df.columns","e9801131":"df.month.unique()\ndf.housing.unique()","3f978174":"df.shape","9cfb53f4":"data_full2 = pd.read_csv('..\/input\/bank-direct-marketing\/bank-full.csv',sep=';')\ndata_full2.head()","1ad6ae7e":"data_full2.shape","aac4dc6c":"data_full2.columns","d7aa6607":"cat_columns = [column for column in data_full2.columns if data_full2[column].dtype=='O']\ncat_columns","8cca615d":"coumn_unique_value={}\nfor column in cat_columns:\n    coumn_unique_value[column]=data_full2[column].unique()","1b6d3d18":"coumn_unique_value","bd197e81":"sns.countplot(data_full2['y'])\nplt.show()\n","90ff76e1":"sns.heatmap(data_full2.isnull(),cbar='viridis')","0ce31059":"for columns in cat_columns:\n    sns.countplot(data_full2[columns])\n    plt.title(columns)\n    plt.xticks(rotation=90)\n    plt.show()","81a9503b":"data_full2['default']=data_full2['default'].replace({'yes':1,'no':0}).astype(int)\ndata_full2['housing']=data_full2['housing'].replace({'yes':1,'no':0}).astype(int)\ndata_full2['loan']=data_full2['loan'].replace({'yes':1,'no':0}).astype(int)\ndata_full2['y']=data_full2['y'].replace({'yes':1,'no':0}).astype(int)","ccd18617":"cat_columns1 = [column for column in data_full2.columns if data_full2[column].dtype=='O']\n","b6050b93":"data_full2.head()","4bbf9372":"data_full2.info()","91bc0ffe":"for column in cat_columns1:\n    col  = pd.get_dummies(data_full2[column], drop_first=True)\n    data_full2 = pd.concat([col,data_full2],axis=1)\n    data_full2=data_full2.drop(column, axis=1)","395faf2c":"data_full2.head()","cd42a90d":"y=data_full2['y']\nX=data_full2.drop('y',axis=1)","ce849af7":" from imblearn.over_sampling import SMOTE","9dd5977e":"smote=SMOTE(random_state=0)","99d68de8":"X_smot, Y_smot = smote.fit_resample(X.values,y)","78e49207":"X_smot_df=pd.DataFrame(X_smot,columns=X.columns)","0044d9c5":"Y_smot.head()","2ef4e387":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test = train_test_split(X_smot_df,Y_smot,random_state=0, test_size=0.2)","c50d4ff5":"X_train.shape,y_train.shape,X_test.shape,y_test.shape","b434db4b":"from sklearn.ensemble import RandomForestClassifier","b58c5625":"classifier = RandomForestClassifier()\nclassifier.fit(X_train,y_train)","c483b645":"y_pred = classifier.predict(X_test)","97b98510":"from sklearn.metrics import confusion_matrix,accuracy_score,precision_score,recall_score","d876b6ad":"confusion_matrix(y_test,y_pred)","80612aea":"accuracy_score(y_test,y_pred),precision_score(y_test,y_pred),recall_score(y_test,y_pred)","2c7e1863":"### Visualization"}}