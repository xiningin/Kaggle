{"cell_type":{"86f6bde1":"code","781bcc92":"code","e2493df8":"code","cff24bbd":"code","28529fc0":"code","acd5eb52":"markdown","3f6d589a":"markdown","65d73b44":"markdown","02021842":"markdown","75a2c6a6":"markdown","445392e2":"markdown"},"source":{"86f6bde1":"import numpy as np\nimport pandas as pd\nimport re\n\ndata = pd.read_csv('..\/input\/list-faskes-bpjs-indonesia\/Data Faskes BPJS 2019.csv', header=0)\n\ndef namaKota(row):\n    str = row.replace('Kode Faskes dan Alamat Rumah Sakit BPJS di ','')\n    return str\n\n\ndef remSpace(row):\n    str = \" \".join(row.split())\n    return str\n\ndef searchLatLong(row):\n    str = re.search('(-?([0-9]{1}|[0-9]0|[1-8]{1,2}).[0-9]{1,6},(-?(1[0-8]{1,2}|9[1-9]{1}).[1-9]{1,6}))', row)\n    if str:\n        return str.group()\n    return np.NaN\n        \ndef valid_latitude(row):\n    if float(row) in range(-90.0, 90.0):\n        return row\n    return np.NaN\n\n\ndef valid_longitude(row):\n    return row","781bcc92":"data['TelpFaskes'] = data['TelpFaskes'].apply(remSpace)\ndata['NamaFaskes'] = data['NamaFaskes'].apply(remSpace)\ndata['KotaKab'] = data['KotaKab'].apply(remSpace)","e2493df8":"data['KotaKab'] = data['KotaKab'].apply(namaKota)","cff24bbd":"data['LatLongFaskes'] = data['LatLongFaskes'].apply(searchLatLong)\n\nlat = []\nlon = []\n\nfor row in data['LatLongFaskes']:\n    try:\n        latitude = float(row.split(',')[0])\n        longitude = float(row.split(',')[1])\n        if (-90.0 <= latitude <= 90.0):\n            lat.append(latitude)\n        else:\n            lat.append(np.NaN)\n        \n        if (-180.0 <= longitude <= 180.0):\n            lon.append(longitude)\n        else:\n            lon.append(np.NaN)\n    except:\n        lat.append(np.NaN)\n        lon.append(np.NaN)\n\ndata['Latitude'] = lat\ndata['Longitude'] = lon\ndata = data.drop(\"LatLongFaskes\", axis=1)","28529fc0":"data = data.astype(str)\ndata = data.applymap(lambda x: re.sub(r'^-$', str(np.NaN), x))\ndata.to_csv('Data Faskes BPJS 2019-clean_data.csv')\n","acd5eb52":"#### Mengatasi format data yang tidak konsisten","3f6d589a":"### Masalah\n- Format data tidak konsisten untuk setiap row, seperti penulisan strip (-) untuk data yang kosong.\n- Nama kota perlu di bersihkan kembali\n- Koordinat latitude longitude sebaiknya dipisah untuk mempermudah pengolahan data lebih lanjut","65d73b44":"#### Memuat library dan membuat fungsi yang dibutuhkan","02021842":"#### Memisahkan latitude longitude dari url dan menambah kolom khusus","75a2c6a6":"####  Menghapus karakter \\t \\n atau spasi yang berlebih","445392e2":"#### Membersihkan nama Kota\/Kab"}}