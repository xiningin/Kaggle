{"cell_type":{"6277a001":"code","83bd24b3":"code","266dfafd":"code","dfa9a68c":"code","4fec222f":"code","c896e15d":"code","fb33485d":"code","95ff29e7":"code","19744329":"code","f25956cb":"code","89ae590a":"code","6e5fcc5d":"code","1a29e2fe":"code","0d0f21e2":"code","b0c4bfd8":"code","a247d9d8":"code","5bebb97b":"code","758f44fc":"code","6be0fea6":"code","69989963":"code","11adef8b":"code","7ecbb0c6":"code","c5f043a1":"code","f3e98248":"code","3b6c77f0":"code","18c57902":"code","1f898038":"code","908c3ac4":"code","30bb8b32":"code","82a0070b":"code","1a3e457d":"code","a157cf3f":"markdown","f8003abb":"markdown","80453b46":"markdown","5c99515c":"markdown","9e7043f2":"markdown","13e322d3":"markdown","58842189":"markdown","6b01fa9c":"markdown","891e710f":"markdown","1e257bf0":"markdown","33c6943a":"markdown","cec55176":"markdown","00210221":"markdown","d74f96c8":"markdown","c39b4202":"markdown","21bbdd4e":"markdown","aa54e886":"markdown","e9c222a6":"markdown","83ccbfc7":"markdown","d7103055":"markdown","4b3072be":"markdown","e9495a86":"markdown","18acb6d2":"markdown"},"source":{"6277a001":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nimport folium\n%matplotlib inline","83bd24b3":"df = pd.read_csv('..\/input\/us-police-shootings\/shootings.csv')","266dfafd":"df.head()","dfa9a68c":"df.info()","4fec222f":"def find_null(dataFrame):\n    total = len(dataFrame.columns)\n    n = 0\n    for col in dataFrame.columns:\n        null_sum = dataFrame[col].isna().sum()\n        if null_sum > 0:\n            n+=1\n            print(f'\"{col}\": {null_sum} null values')\n            \n    print('---------------------------------------')\n    print(f'\\n{n}\/{total} columns have null values')","c896e15d":"find_null(df)","fb33485d":"df['tmp_date'] = pd.to_datetime(df['date'])\ndf['year'] = df['tmp_date'].dt.year\ndf['month'] = df['tmp_date'].dt.month\ndf['day'] = df['tmp_date'].dt.day\ndf['day_of_week'] = df['tmp_date'].dt.day_name()","95ff29e7":"df.head()","19744329":"df['age_range'] = pd.cut(df['age'], bins=np.arange(0, 130, 10), right=False)","f25956cb":"df.head()","89ae590a":"tmp_df = df[['id','state']]\ntmp_df = tmp_df.groupby('state', as_index=False).count()\ntmp_df = tmp_df.rename(columns={'id':'case'})\n\nurl = 'https:\/\/raw.githubusercontent.com\/python-visualization\/folium\/master\/examples\/data'\nstate_geo = f'{url}\/us-states.json'\n\nm = folium.Map(location=[48, -102], zoom_start=3)\n\nfolium.Choropleth(\n    geo_data=state_geo,\n    name='choropleth',\n    data=tmp_df,\n    columns=['state', 'case'],\n    key_on='feature.id',\n    fill_color='OrRd',\n    fill_opacity=0.7,\n    line_opacity=0.2,\n    legend_name='Numer of cases'\n).add_to(m)\n\nfolium.LayerControl().add_to(m)\n\nm","6e5fcc5d":"def show_countplot(df, col, color, figsize=(10,5), rotation=0):\n    plt.subplots(figsize=figsize)\n    title = 'number of cases by ' + col\n    plt.title(title,fontsize=20)\n    plt.xlabel(col,fontsize=15)\n    plt.xticks(rotation=rotation)\n    plt.ylabel('count',fontsize=15)\n    df[col].value_counts().plot(kind=\"bar\",color=color)\n    plt.show()","1a29e2fe":"show_countplot(df, 'state', \"#ff6d69\")","0d0f21e2":"def plot_pie(df, col, color):\n    tmp_df = df[col]\n    tmp_df = tmp_df.reset_index()\n    tmp_df = tmp_df.groupby([col]).count()\n    tmp_df = tmp_df.sort_values('index',ascending=False)\n\n    label = tmp_df.index\n\n    plt.figure(figsize=(12,8))\n    title = col + ' ratio'\n    plt.title(title,fontsize=20)\n\n    plt.pie(tmp_df, labels=label,colors=color,counterclock=False, startangle=90,autopct=\"%1.1f%%\", pctdistance=0.7)\n    plt.show()","b0c4bfd8":"color1 = (\"#74b9ff\", \"#e84393\")\nplot_pie(df, 'gender', color1)","a247d9d8":"color2 = (\"#ffeaa7\",\"#e17055\")\nplot_pie(df, 'manner_of_death', color2)","5bebb97b":"color3 = (\"#55efc4\",\"#81ecec\",\"#74b9ff\",\"#a29bfe\",\"#dfe6e9\",\n          \"#ffeaa7\",\"#e17055\",\"#d63031\",\"#e84393\",\"#2d3436\",\n          \"#00b894\",\"#0984e3\",\"#ffeaa7\",\"#fab1a0\",\"#fd79a8\")\nplot_pie(df, 'race', color3)","758f44fc":"show_countplot(df, 'arms_category', \"#74b9ff\")","6be0fea6":"plt.subplots(figsize=(12,12))\nplt.subplot(3,1,1)\nsns.countplot(x='race', hue='signs_of_mental_illness', data=df)\nplt.title('race & signs_of_mental_illness', fontsize=15)\nplt.show()\n\nplt.subplots(figsize=(12,12))\nplt.subplot(3,1,2)\nsns.countplot(x='race', hue='flee', data=df)\nplt.title('race & flee', fontsize=15)\nplt.show()\n\nplt.subplots(figsize=(12,12))\nplt.subplot(3,1,3)\nsns.countplot(x='race', hue='body_camera', data=df)\nplt.title('race & body_camera', fontsize=15)\nplt.show()","69989963":"plt.subplots(figsize=(10,5))\nsns.countplot(x='year', data=df, order=sorted(df['year'].unique()),palette= [\"#7fcdbb\"])\nplt.title('number of cases by year', fontsize=15)\nplt.show()","11adef8b":"plt.subplots(figsize=(10,5))\ntmp_df = df[df['year']!=2020]\nsns.countplot(x='month', data=tmp_df, order=sorted(df['month'].unique()),palette= [\"#fd79a8\"])\nplt.title('number of cases by month (2015~2019)', fontsize=15)\nplt.show()","7ecbb0c6":"plt.subplots(figsize=(10,5))\norder=['Monday','Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']\nsns.countplot(x='day_of_week', data=df, order=order,palette= [\"#6c5ce7\"])\nplt.title('number of cases by day_of_week', fontsize=15)\nplt.show()","c5f043a1":"plt.subplots(figsize=(10,5))\ntmp_df = df[df['year']!=2020]\nsns.countplot(x='day', data=tmp_df, order=sorted(df['day'].unique()),palette= [\"#fdcb6e\"])\nplt.title('number of cases by day (2015~2019)', fontsize=15)\nplt.show()","f3e98248":"plt.subplots(figsize=(10,5))\nsns.countplot(x='age_range', data=df, order=sorted(df['age_range'].unique()),palette= [\"#013766\"])\nplt.title('number of cases by age_range', fontsize=15)\nplt.show()","3b6c77f0":"# Mapping (Number of cases by state)\ntmp_df = df[['id','state']]\ntmp_df = tmp_df.groupby('state', as_index=False).count()\ntmp_df = tmp_df.rename(columns={'id':'case'})\n\nurl = 'https:\/\/raw.githubusercontent.com\/python-visualization\/folium\/master\/examples\/data'\nstate_geo = f'{url}\/us-states.json'\n\nm = folium.Map(location=[48, -102], zoom_start=3)\n\nfolium.Choropleth(\n    geo_data=state_geo,\n    name='choropleth',\n    data=tmp_df,\n    columns=['state', 'case'],\n    key_on='feature.id',\n    fill_color='OrRd',\n    fill_opacity=0.7,\n    line_opacity=0.2,\n    legend_name='Numer of cases'\n).add_to(m)\n\nfolium.LayerControl().add_to(m)\n\nm","18c57902":"df_ca = df[df['state']=='CA']\ndf_other = df[df['state']!='CA']","1f898038":"df_ca.info()","908c3ac4":"color = [\"#55efc4\",\"#81ecec\",\"#74b9ff\",\"#a29bfe\",\"#dfe6e9\",\"#ffeaa7\"]\norder=['Hispanic','White', 'Black', 'Asian', 'Native', 'Other']\n\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15,6))\n\n\nsns.countplot(x='race', data=df_ca, order=order,palette=color, ax=ax1)\nax1.set_title('Number of cases in CA by race', fontsize=15)\n\n\nsns.countplot(x='race', data=df_other, order=order,palette=color, ax=ax2)\nax2.set_title('Number of cases in other states by race', fontsize=15)\n\nfig.show()","30bb8b32":"color = [\"#74b9ff\", \"#e84393\"]\n\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15,6))\n\n\nsns.countplot(x='gender', data=df_ca, palette=color, ax=ax1)\nax1.set_title('Number of cases in CA by gender', fontsize=15)\n\n\nsns.countplot(x='gender', data=df_other, palette=color, ax=ax2)\nax2.set_title('Number of cases in other states by gender', fontsize=15)\n\nfig.show()","82a0070b":"color = [\"#013766\"]\n\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15,6))\n\n\nsns.countplot(x='age_range', data=df_ca, palette=color, ax=ax1)\nax1.set_title('Number of cases in CA by gender', fontsize=15)\n\n\nsns.countplot(x='age_range', data=df_other, palette=color, ax=ax2)\nax2.set_title('Number of cases in other states by gender', fontsize=15)\n\nfig.show()","1a3e457d":"color = [\"#7fcdbb\"]\n\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15,6))\n\n\nsns.countplot(x='year', data=df_ca, palette=color, ax=ax1)\nax1.set_title('Number of cases in CA by year', fontsize=15)\n\n\nsns.countplot(x='year', data=df_other, palette=color, ax=ax2)\nax2.set_title('Number of cases in other states by year', fontsize=15)\n\nfig.show()","a157cf3f":"## Race ratio - California vs other states","f8003abb":"## Quick navigation\n\n* [1. Preprocessing](#1)\n* [2. Data visualization](#2)\n* [3. Focus on cases in California](#3)","80453b46":"## Color Palettes\n\nIn this notebook, I used color palettes from websites below\n* https:\/\/flatuicolors.com\/\n* https:\/\/colorpalettes.net\/","5c99515c":"# Focus on cases in California\n<a id=\"3\"><\/a>","9e7043f2":"## Gender ratio","13e322d3":"## Create \"age range\" columns","58842189":"## Number of cases by month (2015~2019)","6b01fa9c":"# Data visualization\n<a id=\"2\"><\/a>","891e710f":"## Race ratio","1e257bf0":"## Number of cases by day of week","33c6943a":"California has the largest number of deathes, so focus on California and compare other states","cec55176":"## Arms category count","00210221":"## Find columns which include null values","d74f96c8":"## Number of cases by day (2015~2019)","c39b4202":"## Combination of race and other attributes","21bbdd4e":"## Create \"year\", \"month\", \"day\" and \"day of week\" columns","aa54e886":"## Gender ratio - California vs other states","e9c222a6":"## Mapping (Number of cases by state)","83ccbfc7":"## Number of cases by year","d7103055":"## Manner of death ratio","4b3072be":"# Preprocessing\n<a id=\"1\"><\/a>","e9495a86":"## Number of cases by state","18acb6d2":"## Number of cases by age_range"}}