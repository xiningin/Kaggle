{"cell_type":{"0b3faf39":"code","ddd4fee0":"code","6a43e7fd":"code","e0fc91ca":"code","ce757abe":"code","54f0de33":"code","d8d43f71":"code","e5adc373":"code","ec248c6a":"code","07179e22":"code","a12c74c1":"code","2c1e247f":"code","04605d24":"code","e891d9a3":"code","6388bf38":"code","5549a798":"code","8ad6e291":"code","de245761":"code","f55205f7":"code","eb6ceab9":"code","0fa1bcb6":"code","c8b5c85c":"code","2227edf9":"code","1f5c9591":"code","1d75290b":"code","1fdc920b":"markdown","2f30f92e":"markdown","5fa28c3a":"markdown","3047f5d1":"markdown","9c653f5f":"markdown","4cb9356d":"markdown","084d5bac":"markdown","976ff402":"markdown","920e9ce5":"markdown","f3612892":"markdown","9ec79fbd":"markdown","77108255":"markdown","94018619":"markdown","2d79c682":"markdown"},"source":{"0b3faf39":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","ddd4fee0":"import fastai\nfastai.__version__ ","6a43e7fd":"from fastai import *\nfrom fastai.tabular.all import *\n\npd.options.display.max_rows = 20\npd.options.display.max_columns = None","e0fc91ca":"path = Path('\/kaggle\/input\/titanic-extended')","ce757abe":"path.ls()","54f0de33":"df = pd.read_csv(path\/'train.csv', low_memory=False)\ndf_test = pd.read_csv(path\/'test.csv', low_memory=False)","d8d43f71":"df","e5adc373":"df = df.drop(columns=['WikiId','Body'])","ec248c6a":"procs = [Categorify, FillMissing] # RF does not need `Normalize`","07179e22":"splits = RandomSplitter(valid_pct=0.2)(range_of(df))","a12c74c1":"dep_var='Survived'","2c1e247f":"cont,cat = cont_cat_split(df, 1, dep_var=dep_var)","04605d24":"cont","e891d9a3":"cat","6388bf38":"to = TabularPandas(df, procs, cat, cont, y_names=dep_var, splits=splits, y_block=CategoryBlock())","5549a798":"to.show(3)","8ad6e291":"X_train, y_train = to.train.xs,to.train.y\nX_valid, y_valid = to.valid.xs,to.valid.y","de245761":"from sklearn.ensemble import RandomForestClassifier\nm = RandomForestClassifier(n_estimators=100, n_jobs=-1)","f55205f7":"m.fit(X_train,y_train)","eb6ceab9":"from sklearn.metrics import accuracy_score","0fa1bcb6":"y_pred=m.predict(X_valid)","c8b5c85c":"accuracy_score(y_valid, y_pred)","2227edf9":"to_test = TabularPandas(df_test, procs, cat, cont)","1f5c9591":"predicted_result = m.predict(to_test.xs.drop('Fare_na', axis=1)) # remove reduntant columns (training did not use this col)","1d75290b":"output= pd.DataFrame({'PassengerId':df_test.PassengerId, 'Survived': predicted_result.astype(int)})\noutput.to_csv('submission_titanic.csv', index=False)\noutput.head()","1fdc920b":"### Check datasets","2f30f92e":"## Validate","5fa28c3a":"## Create Training Set and Validation Set","3047f5d1":"Delete the 'WikiId', 'Body' coloumns to avoid possible data leakage","9c653f5f":"# Preparation","4cb9356d":"## Import library","084d5bac":"# Datasets Handling","976ff402":"## Environment Check","920e9ce5":"# Random Forest Classifier Model","f3612892":"This notebook took https:\/\/www.kaggle.com\/hitesh1724\/titanic-1-fastai-beginner-tutorial\/ as reference.\n\nThe notebook uses TabularPandas in fastai2 to help manage the datasets, and use sklearn's RandomForestClassifier to create a classification model.\n\nIf you have any questions, ask away!","9ec79fbd":"To have a more accurate result, use titanic-extended dataset provided in https:\/\/www.kaggle.com\/pavlofesenko\/titanic-extended.","77108255":"# Test Dataset","94018619":"## Create TabularPandas","2d79c682":"### Check fastai version"}}