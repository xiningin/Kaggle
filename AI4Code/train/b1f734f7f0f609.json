{"cell_type":{"4482046a":"code","78289f05":"code","2119464b":"code","30cf0c78":"code","98e6225a":"code","a0d53859":"code","faf118e0":"code","6c8ddff4":"code","9f579009":"code","d2961562":"code","2c0d1108":"code","99a48b7f":"code","e38a8cea":"code","13cd9835":"markdown","9702a959":"markdown","3dbc7eca":"markdown","a61b6a18":"markdown","7371cc7f":"markdown","a64b7c6a":"markdown","719c97cf":"markdown","7f5cb4cd":"markdown","d55dad31":"markdown"},"source":{"4482046a":"from sklearn import tree\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.metrics import mean_squared_error, mean_squared_log_error\nfrom sklearn.ensemble import RandomForestClassifier\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\nfrom IPython.display import SVG\nfrom IPython.display import display\n\nfrom IPython.display import HTML\nstyle = \"<style>svg{width: 70% !important; height: 60% !important;} <\/style>\"\nHTML(style)","78289f05":"titanic_data = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ntitanic_data_test = pd.read_csv(\"..\/input\/titanic\/test.csv\")","2119464b":"titanic_data","30cf0c78":"titanic_data.isnull().sum()","98e6225a":"train_X = titanic_data.drop(['PassengerId', 'Survived', 'Name', 'Ticket', 'Cabin'], axis = 1)\ntest_X = titanic_data_test.drop(['PassengerId', 'Name', 'Ticket', 'Cabin'], axis = 1)\ntrain_y = titanic_data.Survived","a0d53859":"train_X = train_X.fillna({'Age': train_X.Age.median(), 'Fare': train_X.Fare.median()})\ntest_X = test_X.fillna({'Age': test_X.Age.median(), 'Fare': test_X.Fare.median()})","faf118e0":"train_X = pd.get_dummies(train_X)\ntest_X = pd.get_dummies(test_X)","6c8ddff4":"test_X.isnull().sum()","9f579009":"clf_rf = RandomForestClassifier(n_jobs=-1,\n                             criterion='entropy',\n                             min_samples_split=2,\n                             min_samples_leaf=1)\n# \u0421\u043b\u043e\u0432\u0430\u0440\u044c \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u0430, \u043a\u043e\u043c\u0431\u0438\u043d\u0430\u0446\u0438\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043c\u044b \u0431\u0443\u0434\u0435\u043c \u043f\u043e\u0434\u0431\u0438\u0440\u0430\u0442\u044c \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c \u043d\u0430 \u043a\u0440\u043e\u0441\u0441\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438:\nparameters = {'n_estimators': range(3,40), 'max_depth': range(1,10)}\n# \u0418 \u0443\u043a\u0430\u0436\u0435\u043c 5 \u0444\u043e\u043b\u0434\u043e\u0432 \u0434\u043b\u044f \u043a\u0440\u043e\u0441\u0441\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438:\ngrid_search_cv_clf = GridSearchCV(clf_rf, parameters, cv = 5)","d2961562":"grid_search_cv_clf.fit(train_X,train_y)","2c0d1108":"# \u041f\u043e\u043b\u0443\u0447\u0438\u043c \u043b\u0443\u0447\u0448\u0438\u0439 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440:\nbest_clf = grid_search_cv_clf.best_estimator_\ngrid_search_cv_clf.best_params_","99a48b7f":"best_clf.score(train_X, train_y)","e38a8cea":"test_y = best_clf.predict(test_X)\ntest_ID= titanic_data_test.PassengerId\n\nsubmission = pd.DataFrame({ \"PassengerId\": test_ID, \"Survived\": test_y})\nsubmission.to_csv('.\/gender_submission.csv', index=False)","13cd9835":"**\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043b\u0443\u0447\u0448\u0435\u0439 \u043c\u043e\u0434\u0435\u043b\u0438**","9702a959":"**\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u043c \u0432 \u0447\u0438\u0441\u043b\u043e\u0432\u044b\u0435**","3dbc7eca":"# **\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u043c \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043f\u0440\u043e\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439**","a61b6a18":"# \u041e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438\n**\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u0430 \u0431\u044b\u043b \u0432\u044b\u0431\u0440\u0430\u043d RandomForestTree \u0441 \u043a\u0440\u0438\u0442\u0435\u0440\u0438\u044f\u043c \u042d\u043d\u0442\u0440\u043e\u043f\u0438\u044f. \u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043c\u043e\u0434\u0435\u043b\u0438 \u043f\u0435\u0440\u0435\u0431\u0435\u0440\u0451\u043c \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e GridSearchCV.**","7371cc7f":"**\u0412 \u0441\u0442\u043e\u0431\u043b\u0446\u0430\u0445 *\u0412\u043e\u0437\u0440\u0430\u0441\u0442* \u0438 *\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0431\u0438\u043b\u0435\u0442\u0430* \u0437\u0430\u043c\u0435\u043d\u0438\u043c \u043f\u0440\u043e\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043d\u0430 \u043c\u0435\u0434\u0438\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0442\u043e\u043b\u0431\u0446\u043e\u0432**","a64b7c6a":"# **\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 \u0438 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435**","719c97cf":"**\u0418\u0441\u043a\u043b\u044e\u0447\u0438\u043c \u0438\u0437 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0442\u043e\u043b\u0431\u0446\u044b \u043d\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u0435 \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u0430 \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f**","7f5cb4cd":"**\u041c\u044b \u0438\u0437\u0431\u0430\u0432\u0438\u043b\u0438\u0441\u044c \u043e\u0442 \u0432\u0441\u0435\u0445 \u043f\u0440\u043e\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439**","d55dad31":"**\u041f\u043e \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u043e\u0439 \u043b\u0443\u0447\u0448\u0435\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u0431\u044b\u043b\u043e \u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u043e \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u0435 \u0438 \u0437\u0430\u043f\u0438\u0441\u0430\u043d\u043e \u0432 \u0444\u0430\u0439\u043b**"}}