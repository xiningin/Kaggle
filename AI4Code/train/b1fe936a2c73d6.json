{"cell_type":{"1434ea10":"code","4dcb8517":"code","e0e4106d":"code","4c3789bd":"code","5e5c5219":"code","aa8c2072":"code","b142779c":"markdown","c8e618d6":"markdown","46e4cbb7":"markdown","04600069":"markdown"},"source":{"1434ea10":"import torch\nimport torch.optim as optim\nimport numpy as np\nimport pandas as pd\n\n# train \ub370\uc774\ud130\ub97c \ubc1b\uc544\uc624\uae30\nxy_train = pd.read_csv('..\/input\/2020-ai-termproject-18011817\/train_seoul_grandpark.csv', header=None, skiprows=1)\nxy_train","4dcb8517":"# \ub370\uc774\ud130 \ud504\ub85c\uc138\uc2f1 (\ub0a0\uc9dc, \ubbf8\uc138\uba3c\uc9c0 \ub18d\ub3c4, \uc0c1\ub300\uc2b5\ub3c4\uc758 \uac12\uc774 \ud06c\ubbc0\ub85c \uc791\uac8c \uc2a4\ucf00\uc77c\ub9c1)\nxy_train.iloc[:,0] = xy_train.iloc[:, 0]  % 10000 \/ 100\nxy_train.iloc[:,1] = xy_train.iloc[:, 1]  \/ 10\nxy_train.iloc[:, 6] = xy_train.iloc[:, 6]  \/ 10\nxy_train","e0e4106d":"# \ub370\uc774\ud130 \ud30c\uc2f1\nx_data = xy_train.iloc[:,:-1]\ny_data = xy_train.iloc[:,-1]\n\n# numpy \ud615\uc73c\ub85c \ubcc0\ud658\nx_train = np.array(x_data)\ny_train = np.array(y_data)\n\n# tensor \ud615\uc73c\ub85c \ubcc0\ud658\nx_train = torch.FloatTensor(x_train)\ny_train = torch.FloatTensor(y_train).unsqueeze(1)","4c3789bd":"W = torch.zeros((7, 1), requires_grad=True)\nb = torch.zeros(1, requires_grad=True)\n\noptimizer = optim.SGD([W, b], lr = 1e-5, momentum=0.9)\n\nepochs =  7500\n\nfor epoch in range(epochs + 1):\n    \n  hypothesis = x_train.matmul(W) + b\n  cost = torch.mean((y_train - hypothesis)**2)\n\n  optimizer.zero_grad()\n  cost.backward()\n  optimizer.step()\n\n  if epoch % 500 == 0:\n    print(\"{} {:.3f}\".format(epoch, cost.item()))","5e5c5219":"# \ud14c\uc2a4\ud2b8 \ub370\uc774\ud130 \ubc1b\uc544\uc624\uae30\nxy_test = pd.read_csv('..\/input\/2020-ai-termproject-18011817\/test_seoul_grandpark.csv', header=None, skiprows=1)\n\n# \ub370\uc774\ud130 \ud504\ub85c\uc138\uc2f1 (train \ub370\uc774\ud130\uc640 \ub3d9\uc77c\ud558\uac8c \uc804\ucc98\ub9ac)\nxy_test.iloc[:, 0] = xy_test.iloc[:, 0]  % 10000 \/ 100\nxy_test.iloc[:, 1] = xy_test.iloc[:, 1]  \/ 10\nxy_test.iloc[:, 6] = xy_test.iloc[:, 6]  \/ 10\n\n# \ud14c\uc2a4\ud2b8 \ub370\uc774\ud130\ub97c tensor\ud615\uc73c\ub85c \ubcc0\ud658\nx_test = torch.FloatTensor(np.array(xy_test))\n\nprediction = x_test.matmul(W) + b","aa8c2072":"# \uc81c\ucd9c \ud615\uc2dd \ub370\uc774\ud130 \ubc1b\uc544\uc624\uae30\nsubmit = pd.read_csv('..\/input\/2020-ai-termproject-18011817\/submit_sample.csv')\n\nfor i in range(len(prediction)):\n  submit[\"Expected\"][i] = prediction[i].item()\n\nsubmit.to_csv('baseline.csv', mode='w', header=True, index = False)\nsubmit","b142779c":"# kaggle \uc81c\ucd9c","c8e618d6":"# \uacb0\uacfc \uc608\uce21","46e4cbb7":"# \ubaa8\ub378 \ud559\uc2b5","04600069":"# \ub370\uc774\ud130 \ub85c\ub354"}}