{"cell_type":{"8d599f02":"code","dc1a01cd":"code","60195554":"code","dec0e791":"code","9f638885":"code","bcaa6554":"code","0a23dad4":"code","9635b27e":"code","8986c292":"code","6e28e1dd":"code","11bfcb0c":"code","0a02dbe0":"markdown","3cc8c9ea":"markdown"},"source":{"8d599f02":"import pandas as pd\npd.set_option('display.float_format', lambda x: '%.2f' % x)","dc1a01cd":"! ls \/kaggle\/input\/housingquito\/","60195554":"dfAlquilerDepar = pd.read_csv('\/kaggle\/input\/housingquito\/departamentos_alquiler.csv')\ndfAlquilerDepar[['sector', 'ciudad']] = dfAlquilerDepar['sector'].str.split(', ', 1, expand=True)\ndfAlquilerDepar['precio'] = dfAlquilerDepar['precio'].str.replace('\\$','').replace('\\.','')\nfor item in ['precio', 'area', 'habitaciones', 'banos', 'parqueadero']:\n  dfAlquilerDepar = dfAlquilerDepar[ dfAlquilerDepar[item].apply(lambda x: str(x).isdigit()) ] \n  dfAlquilerDepar[item] = pd.to_numeric(dfAlquilerDepar[item]) \ndfAlquilerDepar.drop_duplicates(inplace=True, ignore_index=True)\ndfAlquilerDeparQuito = dfAlquilerDepar[ (dfAlquilerDepar['ciudad']=='Quito') & (dfAlquilerDepar.precio>50) ] \ndfAlquilerDeparQuito","dec0e791":"tmpDfPrecio = dfAlquilerDeparQuito.groupby('sector')['precio'].describe(percentiles=[]).reset_index()\ntmpDfArea = dfAlquilerDeparQuito.groupby('sector')[['area', 'habitaciones', 'banos', 'parqueadero']].mean().reset_index()\n\ndfAlquilerDeparQuitoSummary = pd.merge( tmpDfPrecio, tmpDfArea, on='sector')\ndfAlquilerDeparQuitoSummary.sort_values('mean', ascending=False)\n# dfQuitoSummary","9f638885":"dfVentaDepar = pd.read_csv('\/kaggle\/input\/housingquito\/departamentos_venta.csv')\ndfVentaDepar[['sector', 'ciudad']] = dfVentaDepar['sector'].str.split(', ', 1, expand=True)\ndfVentaDepar['precio'] = dfVentaDepar['precio'].str.replace('\\$','').replace('\\.','')\ndfVentaDepar.rename(columns={'area':'numDepar'}, inplace=True)\ndfVentaDepar['precio'] = dfVentaDepar['precio'].str.replace('\\.','')\ndfVentaDepar['precio'] = pd.to_numeric(dfVentaDepar['precio'])\ndfVentaDepar.drop_duplicates(inplace=True, ignore_index=True)\ndfVentaDepar = dfVentaDepar[ (dfVentaDepar['ciudad']=='Quito') & (dfVentaDepar.precio>50) ] \ndfVentaDepar = dfVentaDepar[ dfVentaDepar.nombre != 'NN']\ndfVentaDepar","bcaa6554":"dfVentaDepar.loc[dfVentaDepar.sector=='Cumbay\u00e1']","0a23dad4":"dfVentaDeparSummary = dfVentaDepar.groupby('sector')['precio'].describe(percentiles=[]).reset_index()\ndfVentaDeparSummary","9635b27e":"dfDepartamentos = pd.merge( dfAlquilerDeparQuitoSummary, dfVentaDeparSummary, on='sector', suffixes=( '_alquiler', '_venta' ) )\ndfDepartamentos.rename( columns={'area':'area_alquiler', 'habitaciones': 'habitaciones_alquier', 'banos':'banos_alquiler', 'parqueadero':'parqueadero_alquiler'}, inplace=True)\ndfDepartamentos.sort_values(['mean_alquiler','mean_venta'], ascending=False)","8986c292":"def extractDF( csvAlquiler, csvVenta ):\n\n    dfAlquiler = pd.read_csv(f'\/kaggle\/input\/housingquito\/{csvAlquiler}')\n    dfAlquiler[['sector', 'ciudad']] = dfAlquiler['sector'].str.split(', ', 1, expand=True)\n    dfAlquiler['precio'] = dfAlquiler['precio'].str.replace('\\$','').replace('\\.','')\n    for item in ['precio', 'area', 'habitaciones', 'banos', 'parqueadero']:\n        dfAlquiler = dfAlquiler[ dfAlquiler[item].apply(lambda x: str(x).isdigit()) ] \n        dfAlquiler[item] = pd.to_numeric(dfAlquiler[item]) \n    dfAlquiler.drop_duplicates(inplace=True, ignore_index=True)\n    dfAlquilerFilter = dfAlquiler[ (dfAlquiler['ciudad']=='Quito') & (dfAlquiler.precio>50) ] \n    tmpDfPrecio = dfAlquilerFilter.groupby('sector')['precio'].describe(percentiles=[]).reset_index()\n    tmpDfArea = dfAlquilerFilter.groupby('sector')[['area', 'habitaciones', 'banos', 'parqueadero']].mean().reset_index()\n    dfAlquilerSummary = pd.merge( tmpDfPrecio, tmpDfArea, on='sector')\n#     dfAlquilerSummary = dfAlquilerSummary.sort_values('mean', ascending=False)\n\n    dfVenta = pd.read_csv(f'\/kaggle\/input\/housingquito\/{csvVenta}')\n    dfVenta[['sector', 'ciudad']] = dfVenta['sector'].str.split(', ', 1, expand=True)\n    dfVenta['precio'] = dfVenta['precio'].str.replace('\\$','').replace('\\.','')\n    dfVenta.rename(columns={'area':'numDepar'}, inplace=True)\n    dfVenta['precio'] = dfVenta['precio'].str.replace('\\.','')\n    dfVenta['precio'] = pd.to_numeric(dfVenta['precio'])\n    dfVenta.drop_duplicates(inplace=True, ignore_index=True)\n    dfVentaFilter = dfVenta[ (dfVenta['ciudad']=='Quito') & (dfVenta.precio>50) ] \n#     dfVenta = dfVenta[ dfVenta.nombre != 'NN']\n    dfVentaSummary = dfVentaFilter.groupby('sector')['precio'].describe(percentiles=[]).reset_index()\n\n    df = pd.merge( dfAlquilerSummary, dfVentaSummary, on='sector', suffixes=( '_alquiler', '_venta' ) )\n    df.rename( columns={'area':'area_alquiler', 'habitaciones': 'habitaciones_alquier', 'banos':'banos_alquiler', 'parqueadero':'parqueadero_alquiler'}, inplace=True)\n    df.sort_values(['mean_alquiler','mean_venta'], ascending=False)\n    \n    return df","6e28e1dd":"dfDepar = extractDF( 'departamentos_alquiler.csv', 'departamentos_venta.csv' )\ndfCasas = extractDF( 'casas_alquiler.csv', 'casas_venta.csv' )\ndfCasas.columns.to_list()","11bfcb0c":"filterNames = ['sector', 'mean_alquiler', 'mean_venta']\ndfDeparFilter = dfDepar[ (dfDepar.count_alquiler>5) | (dfDepar.count_venta > 5) ][filterNames]\ndfCasasFilter = dfCasas[ (dfCasas.count_alquiler>5) | (dfCasas.count_venta > 5) ][filterNames]\nfinalDf = pd.merge( dfDeparFilter, dfCasasFilter, on='sector', suffixes=['_depar', '_casas'] )\nfinalDf.sort_values(['mean_alquiler_depar', 'mean_venta_depar', 'mean_alquiler_casas', 'mean_venta_casas'], ascending=False)","0a02dbe0":"## Departamentos","3cc8c9ea":"## Functions"}}