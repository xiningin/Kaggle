{"cell_type":{"f293fff6":"code","f7bb851a":"code","971e5354":"code","099b6dca":"code","0b8c234a":"code","65fd4f2d":"code","e6856252":"code","ff91c1bc":"code","b2691cc0":"code","a47e421a":"code","6c46976d":"markdown","044ec937":"markdown","ba113f71":"markdown","650c6b45":"markdown"},"source":{"f293fff6":"import os\nimport sys\nimport fastai\nimport numpy as np \n\n\nfrom fastai.imports import *\nfrom fastai.vision import *\nfrom fastai.vision.all import *\nfrom torchvision.models import vgg16_bn\nfrom tqdm import tqdm\nfrom sklearn import preprocessing","f7bb851a":"## Defining Directories\nwork_dir = Path('\/kaggle\/working\/')\npath = Path('..\/input\/hotel-id-2021-fgvc8')\n\nsample_sub = path \/ 'sample_submission.csv'\nlabels = path \/ 'train.csv'","971e5354":"## Reading csv\ntrain_data = pd.read_csv(labels)\ndf_sample = pd.read_csv(sample_sub)\n","099b6dca":"train_data.head(5)","0b8c234a":"train_data['image_path']= train_data['chain'].astype(str)  + '\/' + train_data['image'].astype(str)\ntrain_data[:3]","65fd4f2d":"len_data = len(train_data.value_counts())\n\nprint(\"data Length:\", len_data)\nprint(\"Hotel Chains:\",train_data['chain'].unique())\nchain_len = len(train_data['chain'].unique())-1\nchain_len","e6856252":"hotel_per_chain={}\nchains = train_data['chain'].unique()\nfor chain_id in chains:\n    hotel_per_chain[chain_id] = train_data[train_data['chain']==chain_id]['hotel_id'].nunique()\n\nbar = plt.bar(x=hotel_per_chain.keys(),height=hotel_per_chain.values())\nplt.xlabel(\"Chain ID\")\nplt.ylabel(\"Count\")\nplt.title(\"Hotels per Chain\")","ff91c1bc":"image_per_hotel=[]\nhotels_id = train_data['hotel_id'].unique()\nfor hotel_id in hotels_id:\n    image_per_hotel.append(train_data[train_data['hotel_id']==hotel_id]['image'].nunique())\n\n    \nhotel_image_df = pd.DataFrame({\"hotel_id\":map(str,hotels_id),\"image_count\":image_per_hotel})\nhotel_image_df.sort_values(by=\"image_count\",ascending=False,inplace=True)  \n\nplt.figure(figsize=[15,15])\n\nplt.bar(x=hotel_image_df[\"hotel_id\"],height=hotel_image_df[\"image_count\"])\nplt.xlabel(\"Hotel ID\")\n# \nplt.ylabel(\"Image Count\")\nplt.title(\"Hotels and their image count\")","b2691cc0":"train_dir = '..\/input\/hotel-id-2021-fgvc8\/train_images'\ndataset = ImageDataLoaders.from_df(df = train_data[['image_path', 'chain']],\n                                   path = train_dir,\n                                   folder = '.',\n                                   item_tfms=Resize(128, method='pad', pad_mode='reflection'),\n                                   valid_pct=0.2,\n                                   bs=32)","a47e421a":"dataset.show_batch()","6c46976d":"## Images per Hotel","044ec937":"## Dataset samples\n","ba113f71":"# hotel-id-2021-fgvc8","650c6b45":"## Hotels per Chain"}}