{"cell_type":{"c7fe7e3e":"code","a56e6961":"code","818cc2e1":"code","a3c8818c":"code","1af743d8":"code","bd77d3ff":"code","e91ab509":"code","18f061f0":"code","41e4bbd2":"code","a918d131":"code","6c816193":"code","9de344b7":"code","dad6199f":"code","a90ed802":"code","1e9e3ce0":"code","4984a1da":"code","c13419bf":"code","601e1845":"code","e169284f":"code","0375ec27":"code","52444524":"code","0af9dd7b":"code","f7a786fa":"code","b2a73a9a":"code","d9ac4889":"code","2f0302a1":"code","0f858705":"markdown","7862b880":"markdown","8e5c22ba":"markdown","c903c429":"markdown","308a9e0a":"markdown","888127e0":"markdown"},"source":{"c7fe7e3e":"import numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport scipy.stats as stats\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","a56e6961":"# read 2020 data\ndf2020 = pd.read_csv('..\/input\/world-happiness-report\/2020.csv')\ndf2020.head()","818cc2e1":"df2020.columns","a3c8818c":"n_countries = df2020.shape[0]\nprint(n_countries)","1af743d8":"# extract residual effect\ndf2020['Residual'] = df2020['Dystopia + residual'] - df2020['Ladder score in Dystopia']\ndf2020['Residual'].plot(kind='hist')\nplt.xlabel('Residual')\nplt.show()","bd77d3ff":"df2020['Residual'].describe()","e91ab509":"# score w\/o residual effect\ndf2020['Ladder score ex residual'] = df2020['Ladder score'] - df2020['Residual']","18f061f0":"# look at correlation between residual and \"remaining\" score\nplt.scatter(df2020['Ladder score ex residual'], df2020['Residual'])\nplt.title('Residual vs. Ladder score ex Residual')\nplt.xlabel('Ladder score ex Residual')\nplt.ylabel('Residual')\nplt.show()","41e4bbd2":"# calc Pearson correlation\nstats.pearsonr(df2020['Ladder score ex residual'], df2020['Residual'])","a918d131":"# plot score of top 20\nsns.barplot(x=df2020['Country name'][0:20], y=df2020['Ladder score'][0:20])\nplt.title('Ladder Score for Top 20 countries')\nplt.xticks(rotation=90)\nplt.show()","6c816193":"# ladded score is the sum of the following contributions\/explanations:\ncontribution_features = ['Explained by: Log GDP per capita',\n                         'Explained by: Social support',\n                         'Explained by: Healthy life expectancy',\n                         'Explained by: Freedom to make life choices',\n                         'Explained by: Generosity', 'Explained by: Perceptions of corruption',\n                         'Dystopia + residual']\n\ndf2020_contributions = df2020[contribution_features]","9de344b7":"# plot top 20 again showing contributions\/explanations\nsns.set()\ndf2020_contributions.set_index(df2020['Country name'])[0:20].plot(kind='bar',stacked=True)\nplt.legend(loc='center left', bbox_to_anchor=(1, 0.5))\nplt.title('Top 20 including contribution split')\nplt.show()","dad6199f":"# show error bars (here using 2*stdev)\nsns.set()\nplt.bar(x=df2020['Country name'][0:20], height=df2020['Ladder score'][0:20], \n        yerr=2*df2020['Standard error of ladder score'][0:20], color='lightblue', ecolor='black')\nplt.xticks(rotation=90)\nplt.title('Top 20 with error bars')\nplt.show()","a90ed802":"# plot top 20 - show only residual effect\nsns.barplot(x=df2020['Country name'][0:20], y=df2020['Residual'][0:20])\nplt.title('Top 20 - Showing residual effect only')\nplt.xticks(rotation=90)\nplt.show()","1e9e3ce0":"# residual effect - sorted\ndf2020res = df2020[['Country name','Residual']].sort_values(by=['Residual'], ascending=False)\ndf2020res.reset_index(inplace=True)\ndf2020res","4984a1da":"# plot top 20 residual effects\nsns.barplot(x=df2020res['Country name'][0:20], y=df2020res['Residual'][0:20])\nplt.title('Top 20 Residual effects')\nplt.xticks(rotation=90)\nplt.show()","c13419bf":"# plot bottom 20 residual effects\nsns.barplot(x=df2020res['Country name'][n_countries-20:n_countries], y=df2020res['Residual'][n_countries-20:n_countries])\nplt.title('Bottom 20 Residual effects')\nplt.xticks(rotation=90)\nplt.show()","601e1845":"# plot score of bottom 20\nsns.barplot(x=df2020['Country name'][n_countries-20:n_countries], y=df2020['Ladder score'][n_countries-20:n_countries])\nplt.title('Ladder Score for Bottom 20 countries')\nplt.xticks(rotation=90)\nplt.show()","e169284f":"# plot bottom 20 again showing contributions\/explanations\nsns.set()\ndf2020_contributions.set_index(df2020['Country name'])[n_countries-20:n_countries].plot(kind='bar',stacked=True)\nplt.legend(loc='center left', bbox_to_anchor=(1, 0.5))\nplt.title('Bottom 20 including contribution split')\nplt.show()","0375ec27":"# show error bars (here using 2*stdev)\nsns.set()\nplt.bar(x=df2020['Country name'][n_countries-20:n_countries], height=df2020['Ladder score'][n_countries-20:n_countries], \n        yerr=2*df2020['Standard error of ladder score'][0:20], color='lightblue', ecolor='black')\nplt.xticks(rotation=90)\nplt.title('Bottom 20 with error bars')\nplt.show()","52444524":"# plot bottom 20 - show only residual effect\nsns.barplot(x=df2020['Country name'][n_countries-20:n_countries], y=df2020['Residual'][n_countries-20:n_countries])\nplt.title('Bottom 20 - Residual effect only')\nplt.xticks(rotation=90)\nplt.show()","0af9dd7b":"df2020_by_region = df2020.groupby('Regional indicator').mean()\ndf2020_by_region","f7a786fa":"# plot score by region\nsns.barplot(x=df2020_by_region.index, y=df2020_by_region['Ladder score'])\nplt.title('Ladder score by region (same weight for all countries)')\nplt.xticks(rotation=90)\nplt.show()","b2a73a9a":"# plot residual effect by region\nsns.barplot(x=df2020_by_region.index, y=df2020_by_region['Residual'])\nplt.title('Residual effect by region (same weight for all countries)')\nplt.xticks(rotation=90)\nplt.show()","d9ac4889":"df2020_LACB = df2020[df2020['Regional indicator'] == 'Latin America and Caribbean']\ndf2020_LACB.reset_index(inplace=True)\ndf2020_LACB","2f0302a1":"# plot score of bottom 20\nsns.barplot(x=df2020_LACB['Country name'], y=df2020_LACB['Residual'])\nplt.title('Residuals - Latin America and Caribbean')\nplt.xticks(rotation=90)\nplt.show()","0f858705":"### Region \"Latin America and Caribbean\" has in average the highest residual impact. Let's have a closer look:","7862b880":"# Show 20 countries having lowest ladder score","8e5c22ba":"# Show 20 countries having highest ladder score","c903c429":"### Residual is not correlated with the sum of the other score components. ","308a9e0a":"# World happiness report - Visualize 2020 scores and contributions","888127e0":"# Averages by Region"}}