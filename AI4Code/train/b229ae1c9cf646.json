{"cell_type":{"154b0c71":"code","a4b1b3e7":"code","5e37547b":"code","484ac8ed":"code","2cfb5f16":"code","533fae1d":"code","0185c18a":"code","5271a569":"code","637c2ff8":"code","18378079":"code","8f1a089e":"code","de335b67":"code","a8407f93":"code","7444ecbd":"code","86e26ff9":"code","74805111":"code","1ef75e0b":"code","7622c52c":"code","e6d128c0":"code","a2e269c7":"code","db01bfba":"code","b8fb4c60":"code","02f6281e":"code","e54b2a0d":"code","aac93ae5":"code","266c6e46":"code","31b683d2":"code","99dfbc14":"code","82ba5611":"code","92ba2a45":"code","932cf20a":"code","6e06f085":"code","5af014c3":"code","9264fc9b":"code","36d756ba":"code","f592f283":"code","279ef9b8":"code","2220e50f":"code","5889912b":"code","748ac472":"code","a6bc1e8b":"code","f4a8dc9b":"code","59a91eb3":"code","52fb8365":"code","8c11e2b0":"code","f2645fc1":"code","68b9fd45":"code","32484044":"code","6d10b362":"code","1ccb982f":"code","fd6ff2c1":"code","af94ac84":"code","716daabf":"code","e7ee63d8":"code","ab5ef660":"code","80e6567c":"code","0ca1e122":"code","5c03294b":"code","3e76dcf2":"code","e4961dd0":"code","e71861ab":"code","c90d021a":"code","418aee69":"code","f22dbe2c":"code","da60ff95":"code","94637178":"code","e5eb7d0f":"markdown","55259dd4":"markdown","5052eab2":"markdown","afc5f252":"markdown","1656b706":"markdown","1c05c415":"markdown","c9a5c243":"markdown","29f1ed4a":"markdown","c6e77ed6":"markdown","9e10af36":"markdown","d1a0a2f6":"markdown"},"source":{"154b0c71":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a4b1b3e7":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nsns.set_style('whitegrid')\n\nfrom sklearn.preprocessing import StandardScaler,MinMaxScaler\nfrom sklearn.model_selection import train_test_split,GridSearchCV\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import roc_auc_score,roc_curve,confusion_matrix,accuracy_score","5e37547b":"df=pd.read_csv('\/kaggle\/input\/heart-disease-uci\/heart.csv')","484ac8ed":"df.head()","2cfb5f16":"df.describe()","533fae1d":"df.info()","0185c18a":"df.isnull().any()","5271a569":"plt.figure(figsize=(7,5))\nsns.countplot('target',data=df,palette='viridis')\ndf['target'].value_counts()","637c2ff8":"plt.figure(figsize=(14,6))\nsns.countplot('age',hue='target',data=df,palette='viridis')","18378079":"plt.figure(figsize=(14,6))\nsns.heatmap(df.corr(),annot=True,linecolor='black',linewidths=0.01)","8f1a089e":"fig, axis=plt.subplots(1,2,figsize=(14,6))\n_=sns.countplot('sex',hue='target',data=df,palette='viridis',ax=axis[0])\n_=df['sex'].value_counts().plot.pie(ax=axis[1],autopct='%.2f%%')","de335b67":"fig, axis=plt.subplots(1,2,figsize=(14,6))\n_=sns.countplot('cp',hue='target',data=df,palette='viridis',ax=axis[0])\n_=df['cp'].value_counts().plot.pie(ax=axis[1],autopct='%.2f%%')","a8407f93":"fig, axis=plt.subplots(1,2,figsize=(14,6))\n_=sns.countplot('fbs',hue='target',data=df,palette='viridis',ax=axis[0])\n_=df['fbs'].value_counts().plot.pie(ax=axis[1],autopct='%.2f%%')","7444ecbd":"explode=[0.03,0.03,0.03]\nfig, axis=plt.subplots(1,2,figsize=(14,7))\n_=sns.countplot('restecg',hue='target',data=df,palette='viridis',ax=axis[0])\n_=df['restecg'].value_counts().plot.pie(ax=axis[1],autopct='%.2f%%',explode=explode)","86e26ff9":"fig, axis=plt.subplots(1,2,figsize=(14,7))\n_=sns.countplot('exang',hue='target',data=df,palette='viridis',ax=axis[0])\n_=df['exang'].value_counts().plot.pie(ax=axis[1],autopct='%.2f%%')","74805111":"fig, axis=plt.subplots(1,2,figsize=(14,7))\n_=sns.countplot('slope',hue='target',data=df,palette='viridis',ax=axis[0])\n_=df['slope'].value_counts().plot.pie(ax=axis[1],autopct='%.2f%%',explode=explode)","1ef75e0b":"fig, axis=plt.subplots(1,2,figsize=(14,7))\n_=sns.countplot('ca',hue='target',data=df,palette='viridis',ax=axis[0])\n_=df['ca'].value_counts().plot.pie(ax=axis[1],autopct='%.2f%%')","7622c52c":"fig, axis=plt.subplots(1,2,figsize=(14,7))\n_=sns.countplot('thal',hue='target',data=df,palette='viridis',ax=axis[0])\n_=df['thal'].value_counts().plot.pie(ax=axis[1],autopct='%.2f%%')","e6d128c0":"plt.figure(figsize=(10,6))\nplt.scatter(df.age[df['target']==0],df.thalach[df['target']==0])\nplt.scatter(df.age[df['target']==1],df.thalach[df['target']==1])","a2e269c7":"plt.figure(figsize=(10,6))\nsns.scatterplot(x='chol',y='thalach',data=df,hue='target')","db01bfba":"plt.figure(figsize=(10,6))\nsns.scatterplot(x='trestbps',y='thalach',data=df,hue='target')","b8fb4c60":"data=pd.get_dummies(df, columns=['sex','cp','fbs','restecg','exang','slope','ca','thal'])","02f6281e":"scaler=MinMaxScaler()\ndata_scaled=scaler.fit_transform(data)\ndata_scaled=pd.DataFrame(data_scaled, columns=data.columns)","e54b2a0d":"X=data_scaled.drop('target',axis=1)\ny=data_scaled['target']","aac93ae5":"X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=42)","266c6e46":"knn=KNeighborsClassifier()\nparams={'n_neighbors':range(1,21),'weights':['uniform','distance'],'leaf_size':range(1,21),'p':[1,2,3,4,5,6,7,8,9,10]}","31b683d2":"gs_knn=GridSearchCV(knn,param_grid=params,n_jobs=-1)","99dfbc14":"gs_knn.fit(X_train,y_train)\ngs_knn.best_params_","82ba5611":"prediction=gs_knn.predict(X_test)","92ba2a45":"acc_knn=accuracy_score(y_test,prediction)\nprint(acc_knn)\ncm=confusion_matrix(y_test,prediction)","932cf20a":"class_names = [0,1]\nfig,ax = plt.subplots()\ntick_marks = np.arange(len(class_names))\nplt.xticks(tick_marks,class_names)\nplt.yticks(tick_marks,class_names)\n\nsns.heatmap(pd.DataFrame(cm),annot=True,cmap='GnBu',fmt='g')\nax.xaxis.set_label_position('top')\nplt.tight_layout()\nplt.title('Confusion matrix for K-Nearest Neighbors Model',y=1.1)","6e06f085":"probability=gs_knn.predict_proba(X_test)[:,1]","5af014c3":"fpr_knn,tpr_knn,thresh=roc_curve(y_test,probability)","9264fc9b":"plt.figure(figsize=(10,6))\nplt.title('Receiver Operating Characteristic Curve')\nplt.plot(fpr_knn,tpr_knn)\nplt.plot([0,1],ls='--')\nplt.plot([0,0],[1,0],c='0.5')\nplt.plot([1,1],c='0.5')","36d756ba":"roc_auc_score(y_test,probability)","f592f283":"lr=LogisticRegression()\nparams={'penalty':['l1','l2'],'C':[0.01,0.1,1,10,100],'class_weight':['balanced',None]}","279ef9b8":"gs_r=GridSearchCV(lr,param_grid=params,n_jobs=-1)","2220e50f":"gs_r.fit(X_train,y_train)\ngs_r.best_params_","5889912b":"prediction=gs_r.predict(X_test)","748ac472":"acc_lr=accuracy_score(y_test,prediction)\nprint(acc_lr)\ncm=confusion_matrix(y_test,prediction)","a6bc1e8b":"class_names = [0,1]\nfig,ax = plt.subplots()\ntick_marks = np.arange(len(class_names))\nplt.xticks(tick_marks,class_names)\nplt.yticks(tick_marks,class_names)\n\nsns.heatmap(pd.DataFrame(cm),annot=True,cmap='GnBu',fmt='g')\nax.xaxis.set_label_position('top')\nplt.tight_layout()\nplt.title('Confusion matrix for Logistic Regression',y=1.1)","f4a8dc9b":"probability=gs_r.predict_proba(X_test)[:,1]","59a91eb3":"fpr_lr,tpr_lr,thresh=roc_curve(y_test,probability)","52fb8365":"plt.figure(figsize=(10,6))\nplt.title('Receiver Operating Characteristic Curve')\nplt.plot(fpr_lr,tpr_lr)\nplt.plot([0,1],ls='--')\nplt.plot([0,0],[1,0],c='0.5')\nplt.plot([1,1],c='0.5')","8c11e2b0":"roc_auc_score(y_test,probability)","f2645fc1":"rfc=RandomForestClassifier()\nparams={'max_features':['auto','sqrt','log2'],'min_samples_split':[2,3,4,5,6,7,8,9,10],\n        'min_samples_leaf':[1,2,3,4,5,6,7,8,9,10]}","68b9fd45":"gs_rfc=GridSearchCV(rfc,param_grid=params,n_jobs=-1)","32484044":"gs_rfc.fit(X_train,y_train)\ngs_rfc.best_params_","6d10b362":"prediction=gs_rfc.predict(X_test)","1ccb982f":"acc_rfc=accuracy_score(y_test,prediction)\nprint(acc_knn)\ncm=confusion_matrix(y_test,prediction)","fd6ff2c1":"class_names = [0,1]\nfig,ax = plt.subplots()\ntick_marks = np.arange(len(class_names))\nplt.xticks(tick_marks,class_names)\nplt.yticks(tick_marks,class_names)\n\nsns.heatmap(pd.DataFrame(cm),annot=True,cmap='GnBu',fmt='g')\nax.xaxis.set_label_position('top')\nplt.tight_layout()\nplt.title('Confusion matrix for Random Forest Classifier',y=1.1)","af94ac84":"probability=gs_rfc.predict_proba(X_test)[:,1]","716daabf":"fpr_rfc,tpr_rfc,thresh=roc_curve(y_test,probability)","e7ee63d8":"plt.figure(figsize=(10,6))\nplt.title('Receiver Operating Characteristic Curve')\nplt.plot(fpr_rfc,tpr_rfc)\nplt.plot([0,1],ls='--')\nplt.plot([0,0],[1,0],c='0.5')\nplt.plot([1,1],c='0.5')","ab5ef660":"roc_auc_score(y_test,probability)","80e6567c":"tree=DecisionTreeClassifier()\nparams={'max_features':['auto','sqrt','log2'],'min_samples_split':[2,3,4,5,6,7,8,9,10],\n        'min_samples_leaf':[1,2,3,4,5,6,7,8,9,10]}","0ca1e122":"gs_tree=GridSearchCV(tree,param_grid=params,n_jobs=-1)","5c03294b":"gs_tree.fit(X_train,y_train)\ngs_tree.best_params_","3e76dcf2":"prediction=gs_tree.predict(X_test)","e4961dd0":"acc_tree=accuracy_score(y_test,prediction)\nprint(acc_tree)\ncm=confusion_matrix(y_test,prediction)","e71861ab":"class_names = [0,1]\nfig,ax = plt.subplots()\ntick_marks = np.arange(len(class_names))\nplt.xticks(tick_marks,class_names)\nplt.yticks(tick_marks,class_names)\n\nsns.heatmap(pd.DataFrame(cm),annot=True,cmap='GnBu',fmt='g')\nax.xaxis.set_label_position('top')\nplt.tight_layout()\nplt.title('Confusion matrix for Decision Tree Classifier',y=1.1)","c90d021a":"probability=gs_tree.predict_proba(X_test)[:,1]","418aee69":"fpr_tree,tpr_tree,thresh=roc_curve(y_test,probability)","f22dbe2c":"plt.figure(figsize=(10,6))\nplt.title('Receiver Operating Characteristic Curve')\nplt.plot(fpr_tree,tpr_tree)\nplt.plot([0,1],ls='--')\nplt.plot([0,0],[1,0],c='0.5')\nplt.plot([1,1],c='0.5')","da60ff95":"roc_auc_score(y_test,probability)","94637178":"result=pd.DataFrame({'Models':['K-Neighbors Classifiers','Logistic Regression','Random Forest Classifier','Decision Tree Classifier'],\n                    'Score':[acc_knn,acc_lr,acc_rfc,acc_tree]})\nresult.sort_values(by='Score',ascending=False)","e5eb7d0f":"**The dataset contains:**\n1. age(in years)\n2. sex: (1 = male; 0 = female)\n3. cp: chest pain type\n4. trestbps: resting blood pressure (in mm Hg on admission to the hospital)\n5. chol: serum cholestoral in mg\/dl\n6. fbs: (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)\n7. restecg: resting electrocardiographic results\n8. thalach: maximum heart rate achieved\n9. exang: exercise induced angina (1 = yes; 0 = no)\n10. oldpeak: ST depression induced by exercise relative to rest\n11. slope: the slope of the peak exercise ST segment\n12. ca: number of major vessels (0-3) colored by flourosopy\n13. thal: 3 = normal; 6 = fixed defect; 7 = reversable defect\n14. target: 1 or 0 ","55259dd4":"# Decision Tree CLassifier","5052eab2":"# Random Forest Classifier","afc5f252":"# K-Nearest Neighbors ","1656b706":"# Splitting the data","1c05c415":"# Logistic Regression","c9a5c243":"# **EDA**","29f1ed4a":"# Scaling the data","c6e77ed6":"I am new to Data Science. Please do leave your valueable feedbacks in the comment section. ","9e10af36":"# Creating Dummy variables","d1a0a2f6":"Applying GridSearch for hyperparameter tuning"}}