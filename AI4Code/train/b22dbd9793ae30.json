{"cell_type":{"01e9630f":"code","0da2ba06":"code","f0d99e2f":"code","d8f588eb":"code","13f24a92":"code","71f335eb":"code","1f2bf102":"code","6d3a253d":"code","8ccebf3e":"code","6f70bb1d":"code","eab78bc4":"code","faa0ff6c":"code","3b263b95":"code","bd352286":"code","b56cb802":"code","dc26b8fc":"code","a0968b7d":"code","41ec5282":"code","77e1c80d":"code","041978ce":"code","11d19655":"code","f8043e75":"code","54db9efa":"code","938680f2":"code","adcbccc2":"code","4a6a1b19":"code","657ef19f":"code","0bdcf788":"code","fbc94cda":"code","b3838567":"code","38295993":"code","22f2cc2b":"code","7898bd4f":"code","d1eb8e54":"code","8cb3c4d5":"code","e30b9c9b":"code","d650bbab":"code","0ff6cd55":"code","46060fe7":"code","4b81b5e5":"markdown","cd5921e2":"markdown","adea4c40":"markdown","35ba1a03":"markdown","255812ad":"markdown","07a0acf6":"markdown","de43130b":"markdown","75c24fc0":"markdown","1f12fc31":"markdown","568b9e05":"markdown","cfe0b901":"markdown","f85b45e9":"markdown","497a7055":"markdown","756ca9ee":"markdown","cf3c218a":"markdown","45d47661":"markdown","9280b0d4":"markdown","fae304c0":"markdown","30eafca0":"markdown","de220e39":"markdown","d66ee313":"markdown","fe9b2d38":"markdown","375b2db0":"markdown","32b221af":"markdown","e0f15350":"markdown","747f903f":"markdown","e6637faf":"markdown","a9128860":"markdown","5e86bb02":"markdown","1d9dcd55":"markdown","5d20e785":"markdown","4b65b924":"markdown","48d8ec78":"markdown","aa62bb15":"markdown","80390672":"markdown"},"source":{"01e9630f":"import pandas as pd\n%matplotlib inline\n\ndf = pd.read_csv(\"..\/input\/us-minimum-wage-by-state-from-1968-to-2017\/Minimum Wage Data.csv\", encoding=\"latin\")\ndf.head()","0da2ba06":"min_wage_df = pd.DataFrame()\n\nfor name, group in df.groupby('State'):\n    if min_wage_df.empty:\n        min_wage_df = group.set_index('Year')[['Low.2018']].rename(columns={'Low.2018': name})\n    else:\n        min_wage_df = min_wage_df.join(group.set_index('Year')[['Low.2018']].rename(columns={'Low.2018': name}))\n        \nmin_wage_df.head()","f0d99e2f":"min_wage_df.describe()","d8f588eb":"min_wage_df.corr().head()","13f24a92":"min_wage_df.corr()","71f335eb":"df[df['Low.2018']==0]['State'].unique()","1f2bf102":"import numpy as np\n\nmin_wage_corr = min_wage_df.replace(0, np.NaN).dropna(axis=1).corr()\nmin_wage_corr","6d3a253d":"import matplotlib.pyplot as plt\nplt.matshow(min_wage_corr)","8ccebf3e":"labels = [c[:2] for c in min_wage_corr.columns]\n\n# Figure is the base canvas in the plot\nfig = plt.figure(figsize=(12, 12))\n\n# Add one subplot with 2 dimensions\nax = fig.add_subplot(111)\n\n# Fill the data from correlation table and change the color map to be a good one\n# green = 1.0, red = 0.0\nax.matshow(min_wage_corr, cmap=plt.cm.RdYlGn)\n\n# Set labels to states\nax.set_yticklabels(labels)\nax.set_xticklabels(labels)\n\n# Ask to display all labels than what is the asthetics\nax.set_xticks(np.arange(len(labels)))\nax.set_yticks(np.arange(len(labels)))\n\n# Show\nplt.show()","6f70bb1d":"import requests\n\nweb = requests.get(\"https:\/\/www.infoplease.com\/state-abbreviations-and-state-postal-codes\")\ndfs = pd.read_html(web.text)","eab78bc4":"# Checking the data frames downloaded\nfor df in dfs:\n    print(df.head())","faa0ff6c":"postal_code_df = dfs[0].copy()\npostal_code_df.set_index('State\/District', inplace=True)\npostal_code_df.head()","3b263b95":"postal_code_dict = postal_code_df[[\"Postal Code\"]].to_dict()['Postal Code']\npostal_code_dict['Federal (FLSA)'] = \"FLSA\"\npostal_code_dict['Guam'] = 'GU'\npostal_code_dict['Puerto Rico'] = 'PR'\n\npostal_code_dict","bd352286":"labels = [postal_code_dict[state] for state in min_wage_corr.columns]","b56cb802":"# Figure is the base canvas in the plot\nfig = plt.figure(figsize=(12, 12))\n\n# Add one subplot with 2 dimensions\nax = fig.add_subplot(111)\n\n# Fill the data from correlation table and change the color map to be a good one, \n# green = 1.0, red = 0.0\nax.matshow(min_wage_corr, cmap=plt.cm.RdYlGn)\n\n# Set labels to states\nax.set_yticklabels(labels)\nax.set_xticklabels(labels)\n\n# Ask to display all labels than what is the asthetics\nax.set_xticks(np.arange(len(labels)))\nax.set_yticks(np.arange(len(labels)))\n\n# Show\nplt.show()","dc26b8fc":"unemp_county = pd.read_csv('..\/input\/unemployment-by-county-us\/output.csv')\nunemp_county.head()","a0968b7d":"min_wage_df = min_wage_df.replace(0, np.NaN).dropna(axis=1)\nmin_wage_df.head()","41ec5282":"def get_min_wage(year, state):\n    try:\n        return min_wage_df.loc[year, state]\n    except:\n        return np.NaN\n\n# Get the min wage for a state for an year, fail with a NaN if does not exist \nget_min_wage(2012, 'Colorado')","77e1c80d":"%%time\n\nunemp_county['min_wage'] = list(map(get_min_wage, unemp_county['Year'], unemp_county['State']))","041978ce":"unemp_county.head()","11d19655":"unemp_county[[\"Rate\", \"min_wage\"]].corr()","f8043e75":"unemp_county[[\"Rate\", \"min_wage\"]].cov()","54db9efa":"pres16 = pd.read_csv('..\/input\/2016uspresidentialvotebycounty\/pres16results.csv')\npres16.head()","938680f2":"len(unemp_county)","adcbccc2":"unemp_county_2015 = unemp_county.copy()[(unemp_county['Year'] == 2015) & (unemp_county['Month'] == 'February')]\nunemp_county_2015.head()","4a6a1b19":"pres16['st'].unique()","657ef19f":"unemp_county_2015['State'] = unemp_county_2015['State'].map(postal_code_dict)","0bdcf788":"unemp_county_2015.head()","fbc94cda":"print(len(unemp_county_2015))\nprint(len(pres16))","b3838567":"pres16.rename(columns={'county': 'County', 'st': 'State'}, inplace=True)","38295993":"pres16.head()","22f2cc2b":"for df in [unemp_county_2015, pres16]:\n    df.set_index(['County', 'State'], inplace=True)","7898bd4f":"pres16.head()","d1eb8e54":"pres16 = pres16.copy()[pres16['cand'] == 'Donald Trump'][[\"pct\"]]\npres16.dropna(inplace=True)\npres16.head()","8cb3c4d5":"all_together = unemp_county_2015.merge(pres16, on=['County', 'State'])\nall_together.dropna(inplace=True)","e30b9c9b":"all_together.head()","d650bbab":"all_together.drop(\"Year\", axis=1, inplace=True)\nall_together.drop(\"Month\", axis=1, inplace=True)\nall_together.head()","0ff6cd55":"all_together.corr()","46060fe7":"all_together.cov()","4b81b5e5":"Method 1 of doing this - raw and descriptive, is slow too","cd5921e2":"A quick run down of distribution of data in all the states using dataframe's describe()","adea4c40":"Dropping zeros from min wage dataframe on the column axis","35ba1a03":"Checking the correlation between minimum wage and unemployment rate","255812ad":"Now the `all_together` dataframe has all the interesting columns, computing the correlation and covariance for the dataframe!","07a0acf6":"Setting index of both the dataframes as a double index [State, County]","de43130b":"Using the familiar map() of python to produce an ordered list of values which correspond to each row in the unemployment rate by county dataframe, it takes time, because it is O(n\\*\\*2)","75c24fc0":"Seems there is not much correlation! There may be other factors which influence either or both of these, but they among themselves do not","1f12fc31":"Transforming the dataframe to have states as columns and \"Low.2018\" as the values in the column, indexed by the year. Using pandas' groupby feature, create a new dataframe with that structure","568b9e05":"Need to map `unemp_county_2015` state column to postal codes to later mash it up against election data","cfe0b901":"Quite a lot of states have all data missing, then possibly some states also have partial data! Checking the dataframe...","f85b45e9":"Cursory look at the election results data - what all states are included? Because, here, dealing with state level data","497a7055":"###  Following sentdex's video 3, 4 and 5 of [Data Analysis w\/ Python](https:\/\/www.youtube.com\/playlist?list=PLQVvvaa0QuDfSfqQuee6K8opKtZsh7sA9)","756ca9ee":"   Checking the size of `unemp_county_2015` and `pres16`","cf3c218a":"### DOUBLE BAM!","45d47661":"That is not so useful, I mean, what are those labels? when we have states in the correlation! Use the swiss-knife of matplotlib to some extent to tidy things up","9280b0d4":"#### Mashing!","fae304c0":"Moving On, we can get rid of that data that does not exist. And then see the correlation","30eafca0":"## BAM!","de220e39":"### Reading in the presidential dataset","d66ee313":"#### Now, we are interested in what is dependence between minimum wages, unemployement rate and vote percentage to Trump","fe9b2d38":"Plotting again with good labels","375b2db0":"Minimum wage is negatively correlated to percent of votes to Trump - lesser the minimum wage, higher the vote percent to Trump, which is kind of expected.\n\nUnemployement Rate does not seem to have had a great impact on vote share to Trump. Hmm! _Politics in complicated_\n\nBut on the other hand, these things seem to be not varying together.","32b221af":"Fixing the labels by using external data, because these labels here are sloppy!","e0f15350":"### VIDEO 5 - Combining new datasets with minimum wage dataset ","747f903f":"Look! There are NaN values for min_wage, maybe after brushing out all the zeros in min_wage dataframe it cannot map for certain combinations of year and state, hence the NaNs exist","e6637faf":"Dropping \"Year\" and \"Month\" columns","a9128860":"Unemployment county dataframe is huge, probably better off taking only data just running up until the elections ","5e86bb02":"They seem to vary together for sure","1d9dcd55":"Mashing `pres16` data into `unemp_county_2015` base as it is a smaller set\n\nJoin will be on state and county columns\n\nRenaming these columns on `pres16` dataframe to be consistent with `unemp_county_2015` ","5d20e785":"Graphing the correlation table!","4b65b924":"Seems like Alabama does not have any data and hence it is doing an NaN, let us check all other states","48d8ec78":"### Load the unemployment rate by county dataset to into a pandas dataframe","aa62bb15":"Next, seeing the correlation and covariance of the data between states","80390672":"Taking this minimum wage and adding it to the unemployment county dataset as a column, worth noting is the fact that the range of time on unemployement dataset is smaller compared to minimum wage dataset.\n\nAlso note that minimum wage data does not exist for counties, so for all counties in a state assume the same min wage rates "}}