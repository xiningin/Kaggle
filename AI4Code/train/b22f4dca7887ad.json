{"cell_type":{"2804b28a":"code","b03a3bbc":"code","aff15f9b":"code","e4ad55df":"code","94340a27":"code","de33e6b7":"code","91d282f8":"code","ca29c888":"code","7f210467":"code","56c1d856":"code","abb741ec":"code","f3daf361":"code","971fd30e":"code","347c2a6a":"code","ee6f0623":"code","50d281ce":"code","cca2187c":"code","2b1845fa":"code","b1988b25":"code","25710db4":"code","ee7f160b":"code","a01d84f6":"code","31e798ee":"code","72161ef8":"code","3b502881":"code","ead025d9":"code","1d3e5270":"code","f5f9df64":"code","99d5d71c":"code","43fae402":"code","a8d2504b":"code","d6e7f143":"code","0b090f78":"code","6ac6dda5":"code","82d2a2e1":"code","ecbb3431":"code","ba916338":"code","2c99efe6":"code","c296e1c9":"code","d9712460":"code","0325f299":"code","0f66c5e0":"code","7472abb7":"code","25a1fd93":"code","2283476d":"code","16869990":"code","9c28ae10":"code","3589fe0b":"code","6140cf1c":"code","03231423":"code","c2aa8a9b":"code","6b1e37a8":"code","d736e41a":"markdown","bdabf49b":"markdown","e5e6d0f2":"markdown","c4d68ced":"markdown","fcd62b77":"markdown","86985906":"markdown","31294bd0":"markdown","6ee535dd":"markdown","fd20956e":"markdown","43983f30":"markdown","936056ea":"markdown","fd9dca0e":"markdown","a6f0ef5b":"markdown"},"source":{"2804b28a":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')","b03a3bbc":"Heart =pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')\n","aff15f9b":"Heart= pd.DataFrame(Heart)\nHeart.head()","e4ad55df":"Heart.info","94340a27":"Heart.shape","de33e6b7":"Heart.info()","91d282f8":"Heart.dtypes","ca29c888":"Heart.columns.values","7f210467":"Heart.duplicated().sum()","56c1d856":"# We will drop the Duplicate value:\nHeart=Heart.drop_duplicates(keep=\"first\")","abb741ec":"outliers=[]\ndef outliers_z_score(Heart):\n    threshold = 3\n    mean_y = np.mean(Heart)\n    stdev_y = np.std(Heart)\n    for i in Heart:\n        z_score=(i-mean_y)\/stdev_y\n        if np.abs(z_score)>threshold:\n            outliers.append(i)\n    return outliers\n#thalachh feature\na=outliers_z_score(Heart.thalachh)\nfor i in a:     \n    Heart['thalachh'].iloc[Heart[Heart.thalachh==i].index]=np.nan\n#chol feature\nb=outliers_z_score(Heart.chol)\nfor i in b:     \n    Heart['chol'].iloc[Heart[Heart.chol==i].index]=np.nan\n#oldpeak feature\nc=outliers_z_score(Heart.oldpeak)\nfor i in c:\n    Heart['oldpeak'].iloc[Heart[Heart.oldpeak==i].index]=np.nan\n#imputing nan values\nHeart['new_thalachh']=Heart.thalachh.fillna(Heart.thalachh.mean())\nHeart['new_chol']=Heart.chol.fillna(Heart.chol.mean())\nHeart['new_oldpeak']=Heart.oldpeak.fillna(Heart.oldpeak.mean())","f3daf361":"Heart.head()","971fd30e":"comparision_cols=np.where(Heart['oldpeak']== Heart['new_oldpeak'],True,False)\ncomparision_cols\ncount=np.count_nonzero(comparision_cols)\ncount","347c2a6a":"Heart=Heart[~Heart['oldpeak'].isna()]","ee6f0623":"Heart=Heart[~Heart['thalachh'].isna()]","50d281ce":"Heart=Heart[~Heart['chol'].isna()]","cca2187c":"Heart.info()","2b1845fa":"sns.distplot(Heart['age'],kde = False)","b1988b25":"plt.figure(figsize=(10,5))\nsns.set_style('whitegrid')\nsns.countplot(x='age',data=Heart)","25710db4":"plt.figure(figsize=(10,5))\nsns.distplot(Heart['sex'].dropna(),kde=False,color='darkred',bins=40)\n","ee7f160b":"sns.countplot(x='sex',data=Heart)","a01d84f6":"Heart['cp'].hist(color='green',bins=40,figsize=(8,4))\nplt.title(\"Chest pain type\",fontsize=20)","31e798ee":"plt.figure(figsize=(10,10))\nsns.countplot(x = 'trtbps', data = Heart, palette = 'magma')\nplt.title('Resting blood pressure')\nplt.show()","72161ef8":"plt.figure(figsize=(10,10))\nplt.title(\" Cholestoral \",fontsize=20)\nsns.countplot(x='chol',data=Heart)","3b502881":"plt.figure(figsize=(10,5))\nplt.title(\"Fasting blood sugar\",fontsize=20)\nsns.distplot(Heart['fbs'])","ead025d9":"plt.figure(figsize=(10,5))\nplt.title(\"Resting electrocardiographic results\",fontsize=20)\nsns.distplot(Heart['restecg'].dropna(),bins=10)\nplt.show()","1d3e5270":"\nplt.figure(figsize=(15,10))\nplt.title(\"Maximum heart rate achieved\",fontsize=20)\nsns.countplot(x='thalachh',data=Heart)\nplt.show()","f5f9df64":"sns.relplot(data=Heart, x=\"age\", y=\"sex\",hue='sex',col=\"slp\", col_wrap=2)","99d5d71c":"sns.relplot(data=Heart, x=\"sex\", y=\"age\",kind=\"line\",ci=None)","43fae402":"sns.barplot(x = 'sex', y = 'age', data =Heart,\n            palette = 'PuRd')\nplt.show()","a8d2504b":"sns.pointplot(x=\"sex\", y=\"cp\", data=Heart)\nplt.show()","d6e7f143":"\nsns.regplot(x=\"age\", y=\"cp\", data=Heart)","0b090f78":"sns.jointplot(x='age', y='trtbps', data=Heart, kind='kde')","6ac6dda5":"plt.figure(figsize=(10,5))\nsns.boxplot(x=\"age\", y=\"fbs\", data=Heart)","82d2a2e1":"Heart.plot.scatter(x= \"age\" ,y =\"chol\")","ecbb3431":"plt.figure(figsize=(10,5))\nsns.lineplot(y=\"trtbps\",x=\"age\",data=Heart)","ba916338":"\nsns.barplot(x='restecg', y='age', data=Heart)","2c99efe6":" \nplt.figure(figsize=(17, 7))\nsns.boxplot(x='thalachh',y='age',data=Heart,palette='winter')","c296e1c9":"plt.figure(figsize=(10,6))\nsns.lineplot(x=\"age\",y=\"cp\",hue=\"output\",data=Heart)","d9712460":"plt.figure(figsize=(12,6))\nsns.heatmap(Heart.corr());\nplt.xticks(rotation=-45);\n","0325f299":"X=Heart.iloc[:,0:13]\ny=Heart.iloc[:,13]","0f66c5e0":"X","7472abb7":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state=0)","25a1fd93":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import f1_score\nfrom sklearn.metrics import accuracy_score\n\n","2283476d":"sc_X=StandardScaler()\nX_train=sc_X.fit_transform(X_train)\nX_test= sc_X.transform(X_test)","16869990":"import math\nmath.sqrt(len(y_test))","9c28ae10":"scores=[]\nfor i in range(1,50):\n    classifier =KNeighborsClassifier(n_neighbors=9,p=2,metric='euclidean')\n    classifier.fit(X_train,y_train)\n    scores.append(accuracy_score(y_test,classifier.predict(X_test)))\nscores","3589fe0b":"classifier.fit(X_train,y_train)","6140cf1c":"y_pred =classifier.predict(X_test)\ny_pred","03231423":"accuracy_score(y_test,y_pred)","c2aa8a9b":"cm=confusion_matrix(y_test,y_pred)\ncm","6b1e37a8":"f1_score(y_test,y_pred)","d736e41a":"\n## <span style='background :pink' > Heart attack prediction and analysis<\/span>\n","bdabf49b":"## Data Cleaning\n\n","e5e6d0f2":"## Understanding the data","c4d68ced":"##### Univariate","fcd62b77":"# Data visualization","86985906":"#### Bi variate","31294bd0":"#### Now our Data is Clean We can do Further Analysis.","6ee535dd":"![heart.jpg](attachment:heart.jpg)","fd20956e":"# Definitions\n\n### age - Age of the patient\n\n### sex - Sex of the patient\n\n### cp - Chest pain type ~ 0 = Typical Angina, 1 = Atypical Angina, 2 = Non-anginal Pain, 3 = Asymptomatic\n\n### trtbps - Resting blood pressure (in mm Hg)\n\n### chol - Cholestoral in mg\/dl fetched via BMI sensor\n\n### fbs - (fasting blood sugar > 120 mg\/dl) ~ 1 = True, 0 = False\n\n### restecg - Resting electrocardiographic results ~ 0 = Normal, 1 = ST-T wave normality, 2 = Left ventricular hypertrophy\n\n### thalachh - Maximum heart rate achieved\n\n### oldpeak - Previous peak\n\n### slp - Slope\n\n### caa - Number of major vessels","43983f30":"## Splitting the dataset into train and test","936056ea":"### Multivariate","fd9dca0e":"## outliers\n\n\n","a6f0ef5b":"\n<h1 style=\"text-align: center\">Importing <\/h1>\n"}}