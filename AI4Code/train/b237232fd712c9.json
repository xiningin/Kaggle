{"cell_type":{"20e90471":"code","e13de089":"code","958dec8f":"code","06e7eb85":"code","57d56d1f":"code","cfa61a03":"code","6483c657":"code","3b36422f":"code","e1420cba":"code","f371a7e1":"code","bfaee836":"code","db33ec73":"code","75fba599":"markdown","c219d612":"markdown"},"source":{"20e90471":"import os\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport tensorflow as tf\nfrom sklearn.preprocessing import MinMaxScaler","e13de089":"train_dataset = pd.read_csv('..\/input\/google_stock_train.csv')\ntest_dataset = pd.read_csv('..\/input\/google_stock_test.csv')\ntrain_data = train_dataset.iloc[:, 1:2].values","958dec8f":"min_max = MinMaxScaler(feature_range = (0, 1))\ntrain_data_scaled = min_max.fit_transform(train_data)","06e7eb85":"X_train = []\ny_train = []\n\nfor i in range(60, len(train_data_scaled)):\n  X_train.append(train_data_scaled[i-60:i, 0])\n  y_train.append(train_data_scaled[i, 0])\n  \nX_train, y_train = np.array(X_train), np.array(y_train)","57d56d1f":"X_train = np.reshape(X_train, (X_train.shape[0], X_train.shape[1], 1))","cfa61a03":"model = tf.keras.models.Sequential([\n    tf.keras.layers.LSTM(50, return_sequences = True, input_shape = (X_train.shape[1],1)),\n    tf.keras.layers.Dropout(0.2),\n    \n    tf.keras.layers.LSTM(50, return_sequences = True),\n    tf.keras.layers.Dropout(0.2),\n    \n    tf.keras.layers.LSTM(50, return_sequences = True),\n    tf.keras.layers.Dropout(0.2),\n    \n    tf.keras.layers.LSTM(50),\n    tf.keras.layers.Dropout(0.2),\n    \n    tf.keras.layers.Dense(1)\n])","6483c657":"model.compile(optimizer='adam', loss='mean_squared_error')","3b36422f":"model.fit(X_train, y_train, epochs = 100, batch_size = 32)","e1420cba":"real_data = test_dataset.iloc[:, 1:2].values","f371a7e1":"total_data = pd.concat((train_dataset['Open'], test_dataset['Open']), axis=0)\ninputs = total_data[len(total_data)-len(test_dataset)-60:].values\ninputs = inputs.reshape(-1,1)\ninputs = min_max.transform(inputs)","bfaee836":"X_test = []\nfor i in range(60,123):\n  X_test.append(inputs[i-60:i, 0])\n  \nX_test = np.array(X_test)\nX_test = np.reshape(X_test, (X_test.shape[0], X_test.shape[1], 1))\npredict_data = model.predict(X_test)\npredict_data = min_max.inverse_transform(predict_data)","db33ec73":"plt.plot(real_data, color=\"red\", label=\"Real Google Stock Price\")\nplt.plot(predict_data, color=\"blue\", label=\"Predicted Google Stock Price\")\nplt.title(\"Google Stock Prize Prediction\")\nplt.xlabel(\"Time\")\nplt.ylabel(\"Google Stock Prize\")\nplt.legend()\nplt.show()","75fba599":"**Stock market prediction** is the act of trying to determine the future value of a company stock or other financial instrument traded on an exchange. The successful prediction of a stock's future price could yield significant profit. The efficient-market hypothesis suggests that stock prices reflect all currently available information and any price changes that are not based on newly revealed information thus are inherently unpredictable. Others disagree and those with this viewpoint possess myriad methods and technologies which purportedly allow them to gain future price information.","c219d612":"# Stock Market Prediction (Google)"}}