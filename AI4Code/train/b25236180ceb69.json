{"cell_type":{"6ce6424c":"code","aff83570":"code","fb2bdbf2":"code","c2b80ac6":"code","9d10264e":"code","2e71bdd5":"code","7ae29e35":"code","21893300":"code","23cecbaa":"code","6ff2ed34":"code","7975ff26":"code","8391a076":"code","92d0ef51":"markdown","8944e431":"markdown","789ad2e7":"markdown"},"source":{"6ce6424c":"!pip install lightautoml","aff83570":"# Data Handling \nimport pandas as pd \nimport numpy as np \nimport datatable as dt\n\n# AutoML\nfrom sklearn.model_selection import train_test_split\nfrom lightautoml.automl.base import AutoML\nfrom lightautoml.ml_algo.boost_lgbm import BoostLGBM\nfrom lightautoml.ml_algo.tuning.optuna import OptunaTuner\nfrom lightautoml.pipelines.features.lgb_pipeline import LGBSimpleFeatures\nfrom lightautoml.pipelines.ml.base import MLPipeline\nfrom lightautoml.pipelines.selection.importance_based import ImportanceCutoffSelector, ModelBasedImportanceEstimator\nfrom lightautoml.reader.base import PandasToPandasReader\nfrom lightautoml.tasks import Task\nfrom lightautoml.automl.blend import WeightedBlender\nfrom lightautoml.dataset.roles import DatetimeRole\nfrom lightautoml.automl.presets.tabular_presets import TabularAutoML, TabularUtilizedAutoML\n\n# Evaluation\nfrom sklearn.metrics import roc_auc_score","fb2bdbf2":"# Import data\ndf_train = pd.read_csv(\"..\/input\/tabular-playground-series-sep-2021\/train.csv\")\ndf_train.head()","c2b80ac6":"# Train test split\ntrain, test = train_test_split(df_train, test_size=0.3, random_state=0)\ntrain.head()","9d10264e":"train.drop(columns=[\"id\"], inplace=True)\ntest.drop(columns=[\"id\"], inplace=True)","2e71bdd5":"task = Task(\"binary\")\nreader = PandasToPandasReader(task, cv=5, random_state=0)","7ae29e35":"autoML = TabularAutoML(task=task, \n                      general_params = {\"nested_cv\":False, \n                                     \"use_algos\":[[\"linear_l1\", \"lgb\", \"lgb_tuned\"]]}, \n                      reader_params = {\"cv\":5, \"random_state\":0}, \n                      tuning_params = {\"max_tuning_iter\":20, \"max_tuning_time\":30}, \n                      lgb_params = {\"default_params\":{\"num_threads\":8}})\noof_pred = autoML.fit_predict(train, roles = {\"target\":\"claim\", \"drop\":\"id\"})","21893300":"test_df = pd.read_csv(\"..\/input\/tabular-playground-series-sep-2021\/test.csv\")\ntest_df.head()","23cecbaa":"test_data = test_df.drop(columns=[\"id\"])","6ff2ed34":"test_predictions = autoML.predict(test_data)","7975ff26":"# Export results \noutput = pd.DataFrame({\"id\":test_df[\"id\"], \n                      \"claim\":test_predictions.data[:,0]})\noutput","8391a076":"output.to_csv(\"submission.csv\", index=False)","92d0ef51":"# Preprocessing","8944e431":"# Submission","789ad2e7":"# Model Development"}}