{"cell_type":{"2500334c":"code","3ed391ff":"code","0019d172":"code","59837f84":"code","65797808":"code","8cb96fb4":"code","d3af9dc0":"code","e649468b":"code","d26bd8ac":"code","60783196":"code","401ba511":"code","6799712e":"code","c59c3809":"code","b2cab5a1":"code","25984ace":"markdown","c3172f02":"markdown","80a386c5":"markdown","623f1dc2":"markdown"},"source":{"2500334c":"import numpy as np\nimport pandas as pd\npd.set_option(\"display.max_columns\", 100)\n\nimport matplotlib.pyplot as plt\nplt.style.use('ggplot')\n%matplotlib inline\n\nfrom category_encoders import CountEncoder\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.model_selection import KFold\n\nfrom tqdm.notebook import tqdm\nfrom xgboost import XGBRegressor\nimport lightgbm as lgb\nimport cv2\nimport itertools\nimport collections","3ed391ff":"df_train_yolo = pd.read_csv(\"..\/input\/dsa-2021-yolov3\/train_yolo.csv\")\ndf_test_yolo = pd.read_csv(\"..\/input\/dsa-2021-yolov3\/test_yolo.csv\")\ndf_train = pd.read_csv(\"..\/input\/data-science-autumn-2021\/train.csv\")\ndf_test = pd.read_csv(\"..\/input\/data-science-autumn-2021\/test.csv\")","0019d172":"df_train[[\"train_test\",\"name\"]] = df_train.homeImage.str.split(\"\/\", expand=True)\ndf_train[[\"pic_name\",\"del\"]] = df_train.name.str.split(\".\", expand=True)\ndf_test[[\"train_test\",\"name\"]] = df_test.homeImage.str.split(\"\/\", expand=True)\ndf_test[[\"pic_name\",\"del\"]] = df_test.name.str.split(\".\", expand=True)","59837f84":"c = df_train_yolo.iloc[:,1:-1].apply(collections.Counter,axis = 1)\nd1 = dict(c)","65797808":"d2={}\nfor k,v in d1.items():\n    d2[k] = pd.Series(v)\ndf_train_ = pd.DataFrame(d2).T\ndf_train_[\"pic_name\"] = df_train_yolo.pic_name\ndf_train_.head(3)","8cb96fb4":"c = df_test_yolo.iloc[:,1:-1].apply(collections.Counter,axis = 1)\nd1 = dict(c)\nd2={}\nfor k,v in d1.items():\n    d2[k] = pd.Series(v)\ndf_test_ = pd.DataFrame(d2).T\ndf_test_[\"pic_name\"] = df_test_yolo.pic_name\ndf_test_.head(3)","d3af9dc0":"df_train__ = pd.concat([df_train,df_train_],axis = 1)\ndf_test__ = pd.concat([df_test,df_test_],axis = 1)\ndf_train__.head(3)","e649468b":"df_train__.to_csv(\"train_yolo.csv\",index = False)\ndf_test__.to_csv(\"test_yolo.csv\",index = False)","d26bd8ac":"n=len(df_train__.bicycle.dropna())\nprint(n)\nplt.figure(figsize=[30,30])\nfor i, file in enumerate(df_train__.bicycle.dropna().index):\n    plt.subplot(n\/\/2,2,i+1)\n    img = cv2.imread(f'\/kaggle\/input\/data-science-autumn-2021\/train\/train\/{file}.jpg')\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n    plt.title(file)\n    plt.imshow(img)\nplt.show()","60783196":"n=len(df_train__.zebra.dropna())\nprint(n)\nplt.figure(figsize=[10,10])\nfor i, file in enumerate(df_train__.zebra.dropna().index):\n#     plt.subplot(n\/\/1,1,i+1)\n    img = cv2.imread(f'\/kaggle\/input\/data-science-autumn-2021\/train\/train\/{file}.jpg')\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n    plt.title(file)\n    plt.imshow(img)\nplt.show()","401ba511":"n=len(df_train__.toilet.dropna())\nprint(n)\nplt.figure(figsize=[30,30])\nfor i, file in enumerate(df_train__.toilet.dropna().index):\n    plt.subplot(n\/\/3,3,i+1)\n    img = cv2.imread(f'\/kaggle\/input\/data-science-autumn-2021\/train\/train\/{file}.jpg')\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n    plt.title(file)\n    plt.imshow(img)\nplt.show()","6799712e":"n=len(df_test__.bench.dropna()[:21])\nprint(n)\nplt.figure(figsize=[30,30])\nfor i, file in enumerate(df_test__.bench.dropna()[:21].index):\n    plt.subplot(n\/\/3,3,i+1)\n    img = cv2.imread(f'\/kaggle\/input\/data-science-autumn-2021\/test\/test\/{file}.jpg')\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n    plt.title(file)\n    plt.imshow(img)\nplt.show()","c59c3809":"n=len(df_train__.sofa.dropna()[:21])\nprint(n)\nplt.figure(figsize=[30,30])\nfor i, file in enumerate(df_train__.sofa.dropna()[:21].index):\n    plt.subplot(n\/\/3,3,i+1)\n    img = cv2.imread(f'\/kaggle\/input\/data-science-autumn-2021\/train\/train\/{file}.jpg')\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n    plt.title(file)\n    plt.imshow(img)\nplt.show()","b2cab5a1":"n=len(df_train__.sink.dropna()[:21])\nprint(n)\nplt.figure(figsize=[30,30])\nfor i, file in enumerate(df_train__.sink.dropna()[:21].index):\n    plt.subplot(n\/\/3,3,i+1)\n    img = cv2.imread(f'\/kaggle\/input\/data-science-autumn-2021\/train\/train\/{file}.jpg')\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n    plt.title(file)\n    plt.imshow(img)\nplt.show()","25984ace":"\u305f\u3057\u304b\u306b\u81ea\u8ee2\u8eca\u3042\u308a\u307e\u3059\u306d\uff0e\u3088\u304b\u305f","c3172f02":"\u30bd\u30d5\u30a1\u30fc\u306f\u304b\u306a\u308a\u9ad8\u7d1a\u611f\u3042\u308a\u307e\u3059\u306d\u301c","80a386c5":"\u30d9\u30f3\u30c1\u306f\u304b\u306a\u308a\u9ad8\u7d1a\u611f\u3042\u308a\u307e\u3059\u306d\u301c","623f1dc2":"\u8aa4\u691c\u51fa\u3082\u3042\u308b\u3088\u3046\u3067\u3059\uff0e\u95a2\u4fc2\u3042\u308a\u305d\u3046\u306a\u9805\u76ee\u3060\u3051\u898b\u305f\u65b9\u304c\u3088\u3044\u304b\u3082\u3067\u3059\uff0e\uff0ezebra\u3068\u304b\u306f\u78ba\u5b9f\u306b\u8aa4\u691c\u51fa\u3060\u3068\uff0c\uff08\u78ba\u4fe1\u5ea6\u3082\u3063\u3068\u3042\u3052\u308c\u3070\u3088\u304b\u3063\u305f\uff0e\uff0e\uff0c\uff09"}}