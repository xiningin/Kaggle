{"cell_type":{"639833e2":"code","3c1f36ab":"code","b017446f":"code","ad486dcc":"code","c5764f97":"code","25d5e84d":"code","f3ae459e":"code","ce63f3f7":"code","52f656c6":"code","8946aeb6":"code","2d012eaa":"code","f81e540a":"code","15039691":"markdown","15ed8208":"markdown","099f0c4f":"markdown","443b780c":"markdown","f220d0ca":"markdown","462a6394":"markdown","f069c649":"markdown"},"source":{"639833e2":"# Import packages from numpy, CatBoost, pandas, sklearn\n\nimport numpy as np\nfrom catboost import CatBoostRegressor, FeaturesData, Pool\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_absolute_error","3c1f36ab":"train_df = pd.read_csv(\"..\/input\/train.csv\", encoding = 'utf-8')\ntest_df = pd.read_csv(\"..\/input\/test.csv\", encoding = 'utf-8')\n\ny_train = train_df['SalePrice']\n\nX_train = train_df.drop(['SalePrice'], axis=1)\nX_test = test_df","b017446f":"train_df.head()","ad486dcc":"# Function to determine if column in dataframe is string.\ndef is_str(col):\n    for i in col:\n        if pd.isnull(i):\n            continue\n        elif isinstance(i, str):\n            return True\n        else:\n            return False","c5764f97":"# Splits the mixed dataframe into categorical and numerical features.\ndef split_features(df):\n    cfc = []\n    nfc = []\n    for column in df:\n        if is_str(df[column]):\n            cfc.append(column)\n        else:\n            nfc.append(column)\n    return df[cfc], df[nfc]","25d5e84d":"# Replace all the nan categorical features with the same string \"None\".\n# Replace all the nan numerical features with numpy nanmean.\n\ndef preprocess(cat_features, num_features):\n    cat_features = cat_features.fillna(\"None\")\n    for column in num_features:\n        num_features[column].fillna(np.nanmean(num_features[column]), inplace=True)\n    return cat_features, num_features","f3ae459e":"# Apply the \"split_features\" function on the data.\ncat_tmp_train, num_tmp_train = split_features(X_train)\ncat_tmp_test, num_tmp_test = split_features(X_test)","ce63f3f7":"# Now to apply the \"preprocess\" function.\n# Getting a \"SettingWithCopyWarning\" but I usually ignore it.\ncat_features_train, num_features_train = preprocess(cat_tmp_train, num_tmp_train)\ncat_features_test, num_features_test = preprocess(cat_tmp_test, num_tmp_test)","52f656c6":"train_pool = Pool(\n    data = FeaturesData(num_feature_data = np.array(num_features_train.values, dtype=np.float32), \n                    cat_feature_data = np.array(cat_features_train.values, dtype=object), \n                    num_feature_names = list(num_features_train.columns.values), \n                    cat_feature_names = list(cat_features_train.columns.values)),\n    label =  np.array(y_train, dtype=np.float32)\n)","8946aeb6":"test_pool = Pool(\n    data = FeaturesData(num_feature_data = np.array(num_features_test.values, dtype=np.float32), \n                    cat_feature_data = np.array(cat_features_test.values, dtype=object), \n                    num_feature_names = list(num_features_test.columns.values), \n                    cat_feature_names = list(cat_features_test.columns.values))\n)","2d012eaa":"model = CatBoostRegressor(iterations=2000, learning_rate=0.05, depth=5)\n# Fit model\nmodel.fit(train_pool)\n# Get predictions\npreds = model.predict(test_pool)","f81e540a":"indx = np.array([i for i in range(1461,2920)])\ndf = pd.DataFrame({'Id': indx, 'SalePrice': preds}, columns=['Id', 'SalePrice'])\ndf.to_csv(\"submission.csv\", index=False)","15039691":"CatBoost's \"FeaturesData\" constructor can handle both categorical and numerical features, however the input dtypes are specific (np.float32 for numerical and object for categorical). See the documentation for more data types.","15ed8208":"Since it is my first kernel, I would greatly appreciate any feedback. Especially on handling nans in mixed datasets.\nI haven't yet looked into any outliers as my main concern was to make sure CatBoost works for me.\nI may later see if I can improve on the result.\nThanks for taking the time to read my kernel.","099f0c4f":"# Preprocessing","443b780c":"# House Prices Regression Using CatBoost","f220d0ca":"First I decided to split the features dataset into cateorical and numericgal features.\nThen deal with the nans. \nThis is to avoid errors using catboost's *\"FeaturesData\"* and *\"Pool\"* constructors.","462a6394":"# Train & Predict\nNow all we have to do is train the model and predict using \"test_pool\".\nI found that the parameters: **\"iterations=2000, learning_rate=0.05, depth=5\"** give the best results so far.\n","f069c649":"# Submission"}}