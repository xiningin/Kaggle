{"cell_type":{"aeb772b6":"code","341fa79b":"code","37ebc2f7":"code","e593ea60":"code","b491308d":"code","bdc3eba3":"code","98b00587":"code","b6a51527":"code","1bf95809":"code","37c7a250":"code","93365d7d":"code","8a47105d":"code","0bc43aaf":"code","8a068edf":"code","68accdb3":"code","4d02510e":"code","0bbbab34":"code","0063815a":"code","4b55ee84":"code","b3cde9e2":"code","261e0241":"code","c111d541":"code","5404b63f":"code","8ce58dfc":"code","a2629c37":"code","75c844c2":"code","c80b4e63":"code","a89fb641":"code","43ba1513":"markdown","d8901329":"markdown","048d2497":"markdown","7cadb84b":"markdown","55c29f75":"markdown","b1d921fb":"markdown","5020b9a4":"markdown","3c9cb30c":"markdown","218f1ef8":"markdown","15b61029":"markdown","55f4bf4b":"markdown","5a392e30":"markdown","e91a372d":"markdown","104c96ec":"markdown","63ce0321":"markdown","48e0d6f2":"markdown","2a602a68":"markdown","7bd30b03":"markdown","972c7b44":"markdown","1f5692f3":"markdown","44188589":"markdown","2c835c21":"markdown","1840eb82":"markdown","76a942f8":"markdown"},"source":{"aeb772b6":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\n\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.discriminant_analysis import LinearDiscriminantAnalysis\nfrom sklearn.discriminant_analysis import QuadraticDiscriminantAnalysis\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import classification_report, accuracy_score\nfrom sklearn.metrics import confusion_matrix, roc_curve, auc\n%matplotlib inline","341fa79b":"data = pd.read_csv(\n    'https:\/\/raw.githubusercontent.com\/saidRaiss\/dataset\/master\/advertising.csv'\n)","37ebc2f7":"data.info()","e593ea60":"data.head()","b491308d":"classes = data['Clicked on Ad']\nax = sns.countplot(x=classes, data=data)","bdc3eba3":"# Click on Ad according to gender\nplt.figure(figsize=(7, 5))\nsns.countplot(x='Clicked on Ad', data=data, hue='Male', palette='coolwarm')","98b00587":"# Change datetime type from object to datetime64[ns]\ndata['Timestamp']=pd.to_datetime(data['Timestamp'])\n# Now, let's create Hour, DayOfWeek, Month and Date columns from Timestamp\ndata['Hour']=data['Timestamp'].apply(lambda time : time.hour)\ndata['DayofWeek'] = data['Timestamp'].apply(lambda time : time.dayofweek)\ndata['Month'] = data['Timestamp'].apply(lambda time : time.month)\ndata['Date'] = data['Timestamp'].apply(lambda t : t.date())\n# Ad clicked hourly distribution\nplt.figure(figsize=(15,6))\nsns.countplot(\n    x='Hour', data=data[data['Clicked on Ad']==1],\n    hue='Male', palette='rainbow',\n    )\nplt.title('Ad clicked hourly distribution')","b6a51527":"# Ad clicked daily distribution\nplt.figure(figsize=(12,5))\nsns.countplot(x='DayofWeek',data=data[data['Clicked on Ad']==1],hue='Male',palette='rainbow')\nplt.title('Ad clicked daily distribution')","1bf95809":"# Ad clicked monthly distribution\nplt.figure(figsize=(12,5))\nsns.countplot(x='Month',data=data[data['Clicked on Ad']==1],hue='Male',palette='rainbow')\nplt.title('Ad clicked monthly distribution')","37c7a250":"data[data['Clicked on Ad']==1]['Date'].value_counts().head(5)","93365d7d":"# Age wise distribution of Ad clicks\nplt.figure(figsize=(10,6))\nsns.swarmplot(x=data['Clicked on Ad'],y= data['Age'],data=data,palette='coolwarm')\nplt.title('Age wise distribution of Ad clicks')","8a47105d":"#Let's see Daily internet usage and daily time spent on site based on age\nfig, axes = plt.subplots(figsize=(10, 6))\nax = sns.kdeplot(\n    data['Daily Time Spent on Site'], data['Age'], cmap=\"Reds\",\n    shade=True, shade_lowest=False\n    )\nax = sns.kdeplot(\n    data['Daily Internet Usage'],data['Age'] ,cmap=\"Blues\",\n    shade=True, shade_lowest=False\n    )\nax.set_xlabel('Time')\nax.text(20, 20, \"Daily Time Spent on Site\", size=16, color='r')\nax.text(200, 60, \"Daily Internet Usage\", size=16, color='b')","0bc43aaf":"# Clicked on Ad distribution based on area distribution\nplt.figure(figsize=(10,6))\nsns.violinplot(x=data['Male'],y=data['Area Income'],data=data,palette='viridis',hue='Clicked on Ad')\nplt.title('Clicked on Ad distribution based on area distribution')","8a068edf":"# Convert a categorical variable to dummy variables\ncountry = pd.get_dummies(data['Country'])\n# Let's drop the columns not required for building the model\ndata.drop(\n    ['Ad Topic Line','City','Country','Timestamp','Date']\n    ,axis=1, inplace=True\n    )\n# Now let's join the dummy values\ndata = pd.concat([data,country],axis=1)\n# Display final result\ndata.head()","68accdb3":"y = data['Clicked on Ad'].values.reshape(-1, 1)\nX = data.drop(['Clicked on Ad'], axis=1)\nX_train, X_test, y_train, y_test = train_test_split(\n    X, y, test_size=0.2, random_state=42\n    )","4d02510e":"def plot_roc(roc_auc, false_positive_rate, true_positive_rate):\n  plt.figure(figsize=(6, 6))\n  plt.title('Receiver Operating Characteristics')\n  plt.plot(false_positive_rate, true_positive_rate, color='red', label='AUC = {:.2f}'.format( roc_auc))\n  plt.legend(loc = 'lower right')\n  plt.plot([0, 1], [0, 1], linestyle='--')\n  plt.axis('tight')\n  plt.ylabel('True Positive Rtae')\n  plt.xlabel('False Positive Rtae')","0bbbab34":"# Create a model\nlog_reg = LogisticRegression()\n# Training\nlog_reg.fit(X_train, y_train.ravel())\n# Prediction\ny_prob_log_reg = log_reg.predict_proba(X_test)[:, 1]\ny_pred_log_reg = np.where(y_prob_log_reg > 0.5, 1, 0)","0063815a":"# Confusion matrix\nconfusion_matrix_log_reg = confusion_matrix(y_test, y_pred_log_reg)\nconfusion_matrix_log_reg","4b55ee84":"false_positive_rate_reg, true_positive_rate_reg, thresholds = roc_curve(\n    y_test, y_prob_log_reg\n    )\nroc_auc_log_reg = auc(false_positive_rate_reg, true_positive_rate_reg)\nroc_auc_log_reg","b3cde9e2":"# Draw the ROC curve and get the area under the curve\nplot_roc(roc_auc_log_reg, false_positive_rate_reg, true_positive_rate_reg)","261e0241":"# Create a model\nlda = LinearDiscriminantAnalysis()\n# Training\nlda.fit(X_train, y_train.ravel())\n# Prediction\ny_prob_lda = lda.predict_proba(X_test)[:, 1]\ny_pred_lda = np.where(y_prob_lda > 0.5, 1, 0)","c111d541":"# Confusion matrix\nconfusion_matrix_lda = confusion_matrix(y_test, y_pred_lda)\nconfusion_matrix_lda","5404b63f":"false_positive_rate_lda, true_positive_rate_lda, thresholds = roc_curve(\n    y_test, y_prob_lda\n    )\nroc_auc_lda = auc(false_positive_rate_lda, true_positive_rate_lda)\nroc_auc_lda","8ce58dfc":"# Draw the ROC curve and get the area under the curve\nplot_roc(roc_auc_lda, false_positive_rate_lda, true_positive_rate_lda)","a2629c37":"# Create a model\nqda = QuadraticDiscriminantAnalysis()\n# Training\nqda.fit(X_train, y_train.ravel())\n# Prediction\ny_prob_qda = qda.predict_proba(X_test)[:, 1]\ny_pred_qda = np.where(y_prob_qda > 0.5, 1, 0)\n# Confusion matrix\nconfusion_matrix_qda = confusion_matrix(y_test, y_pred_qda)\nfalse_positive_rate_qda, true_positive_rate_qda, thresholds = roc_curve(\n    y_test, y_prob_qda\n    )\nroc_auc_qda = auc(false_positive_rate_qda, true_positive_rate_qda)","75c844c2":"roc_auc_qda","c80b4e63":"# Draw the ROC curve and get the area under the curve\nplot_roc(roc_auc_qda, false_positive_rate_qda, true_positive_rate_qda)","a89fb641":"plt.figure(figsize=(6, 6))\nplt.title('Receiver Operating Characteristics')\nplt.plot(false_positive_rate_reg, true_positive_rate_reg, color='blue', label=\"Log reg AUC = {:.2f}\".format(roc_auc_log_reg))\nplt.plot(false_positive_rate_lda, true_positive_rate_lda, color='green', label='LDA AUC = {:.2f}'.format(roc_auc_lda))\nplt.plot(false_positive_rate_qda, true_positive_rate_qda, color='red', label='QDA AUC = {:.2f}'.format(roc_auc_qda))\nplt.legend(loc = 'lower right')\nplt.plot([0, 1], [0, 1], linestyle='--')\nplt.axis('tight')\nplt.ylabel('True Positive Rtae')\nplt.xlabel('False Positive Rtae')","43ba1513":"### Dataset splitting Train\/Test","d8901329":"Valentine's Day (February 14) is the best-selling day for the company's announcement.","048d2497":"Men and women with regional income below 50,000 are the main customers of Ad. Almost all those with income over 60k are not interested in clicking on Ad.","7cadb84b":"Then the dataset contains 1000 samples and 9 predictores. **Clicked on Ad** attribute is the output that must be predicted.","55c29f75":"As noted, there is a large covariance between the variables. In particular after the conversion of the \u201ccountry\u201d variable into dummy variables, the QDA model gives poor results.","b1d921fb":"As can be seen, people around 30 spend a lot of time on the internet and on the site, but they don't click on the ads that are so frequent (the previous figure). Compared to them, the around 40-year-old population spends a little less time but clicks more on ads.","5020b9a4":"Women tend to click more on ads!","3c9cb30c":"### Conclusion\nMost of the time, women in their 40s in the income group of less than 50,000 in developing countries are the main consumers of ads, clicking unevenly throughout the day and mainly on Fridays and Sundays.","218f1ef8":"### useful functions","15b61029":"### Libraries we use","55f4bf4b":"### Linear discriminant analysis","5a392e30":"The population of around 40 is the largest contributor to ad clicks.\n\n","e91a372d":"### Dataset description\nDataset created by Jose Portilla and Pierian Data for his Udemy course (Python for Data Science and Machine Learning Bootcamp).\n**Let's explore the data to determine who is most likely to click on the ad!**","104c96ec":"### Explore dataset","63ce0321":"Most days, women click the ad more than men, except Wednesdays and Thursdays.","48e0d6f2":"Thus, for this problem, the linear discriminant analysis model gives better results than the logistic regression model and the quadratic discriminant analysis model. The quadratic discriminant analysis model to avoid.","2a602a68":"Throughout the year, women click the ad the most, except March.","7bd30b03":"### Conclusion & Comparaison","972c7b44":"### Quadratic discriminant analysis","1f5692f3":"### Dataset visualization","44188589":"As we can see women are the main contributor and overtake men by several hours.","2c835c21":"From the figure above, the dataset is equilibrated, which will make the study more trusted.","1840eb82":"### Logistic regression","76a942f8":"### Preparation of dataset"}}