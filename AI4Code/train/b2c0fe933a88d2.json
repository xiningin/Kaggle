{"cell_type":{"fce4ce48":"code","fa9dfabe":"code","362f7901":"code","30c432ac":"code","2e337807":"code","439b9b09":"code","5e749b7f":"code","187f4d89":"code","45bcf289":"code","51a42f9d":"code","f71ae86f":"code","48865033":"code","c3d0785d":"code","10370e21":"code","74aeb2e3":"code","55912a79":"code","b88b7591":"code","d0c49d7d":"code","d0c59e2e":"code","f021fc24":"code","6de0afae":"code","297bb456":"code","57e02e9e":"code","23662a2b":"code","a34f3ea0":"code","e9c4c7ac":"code","d8151176":"code","4d9e6f30":"code","aa928863":"code","67a3d78e":"code","a8f7b4a0":"code","ca1da4ab":"code","747e4c4d":"code","968de555":"code","3ea73ab2":"code","2f8e4cba":"code","e90c9b8c":"code","0c62ed9d":"code","5fb2e205":"code","ada9d797":"code","bbf6ff61":"code","fd7ad815":"code","199c7827":"code","151d9e0d":"code","4dcff704":"code","42139c67":"code","6f7f62ec":"code","dc9c3224":"code","6e3a1f66":"code","dcc45291":"code","5ce20e5e":"code","de2c25f8":"code","2e00c3d0":"code","ea847afe":"code","cde8f154":"code","d5291b2d":"code","2131f536":"code","49ce9516":"code","b428bdee":"code","e0e99304":"code","604461b2":"code","799235c1":"code","a749d2ce":"code","78ace61e":"code","188540b9":"code","beea9e39":"code","626bdc5a":"code","da6c5565":"code","948cef27":"code","47cee564":"code","23e4d7eb":"code","360f2a2a":"code","58d8857b":"code","b1a14e92":"code","61454f17":"code","a2a21dd3":"code","fe206fb9":"code","5e855d2d":"code","7574567e":"code","388d4855":"code","2feac634":"code","1b4c3564":"code","e7df11ab":"code","543199b0":"code","5cb6e795":"code","7c122c86":"code","5c38d3b7":"code","75502cfe":"code","31e12a3c":"markdown","92bdc59e":"markdown","74bac008":"markdown","2e26dc83":"markdown","c65cbc5a":"markdown","8412db34":"markdown","893fefc3":"markdown","0fdccda1":"markdown","5622d913":"markdown","36238f0c":"markdown","da09997d":"markdown","a13dd556":"markdown","5570ac97":"markdown","8ace9c14":"markdown","06c2a7f9":"markdown","1d50e17e":"markdown","c83ccb89":"markdown","012c71ba":"markdown","7aaa220f":"markdown","5d171dd8":"markdown","842cde3f":"markdown","6dd6dbc4":"markdown","896c24dd":"markdown","1730ab10":"markdown","13d7200d":"markdown","fe93d454":"markdown","66683f45":"markdown","d9aa71b9":"markdown","e155362b":"markdown","6d177cc2":"markdown","f28ddb16":"markdown","092d562a":"markdown","65bedfcb":"markdown","887dda8f":"markdown","94d6d825":"markdown","4adb9531":"markdown","9291d1ae":"markdown","38c76086":"markdown","b3330947":"markdown","5306693c":"markdown","d49ac3f2":"markdown","c3d0df76":"markdown","83df2f5c":"markdown","66997060":"markdown","60cd5c66":"markdown","cfefa48c":"markdown","d58851f0":"markdown","ab961e51":"markdown","3723be57":"markdown"},"source":{"fce4ce48":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","fa9dfabe":"import seaborn as sns; import matplotlib.pyplot as plt;\nsns.set();\n\nmy_palette = {0 : 'red' , 1 : 'black'}","362f7901":"from sklearn.preprocessing import StandardScaler","30c432ac":"data = pd.read_csv('..\/input\/heart-disease-uci\/heart.csv')\ndata.head()","2e337807":"data.shape","439b9b09":"from sklearn.model_selection import train_test_split","5e749b7f":"X_train, X_test, y_train, y_test = train_test_split(data.drop(['target'], axis = 1), data['target'], test_size = 0.2, random_state = 21)","187f4d89":"X_train.head()","45bcf289":"y_train.head()","51a42f9d":"X_train.shape","f71ae86f":"y_train.shape","48865033":"cat_cols = ['sex', 'cp', 'fbs', 'restecg', 'exang', 'slope', 'ca', 'thal']\n\ndis_cols = ['age', 'trestbps', 'chol', 'thalach', 'oldpeak']","c3d0785d":"data['sex'][data['sex'] == 1] = 'male'\ndata['sex'][data['sex'] == 0] = 'female'","10370e21":"data.columns","74aeb2e3":"data['cp'][data['cp'] == 0] = 'typical angina'\ndata['cp'][data['cp'] == 1] = 'atypical angina'\ndata['cp'][data['cp'] == 2] = 'non-anginal pain'\ndata['cp'][data['cp'] == 3] = 'asymptomatic'","55912a79":"data['fbs'][data['fbs'] == 1] = 'higher than 120mg\/ml'\ndata['fbs'][data['fbs'] == 0] = 'lower than 120mg\/ml'","b88b7591":"data['slope'][data['slope'] == 0] = 'upsloping'\ndata['slope'][data['slope'] == 1] = 'flat'\ndata['slope'][data['slope'] == 2] = 'downsloping'","d0c49d7d":"data.head()","d0c59e2e":"data['restecg'][data['restecg'] == 0] = 'normal'\ndata['restecg'][data['restecg'] == 1] = 'ST-T wave abnormality'\ndata['restecg'][data['restecg'] == 2] = 'left ventricular hypertrophy'","f021fc24":"data['exang'][data['exang'] == 0] = 'no'\ndata['exang'][data['exang'] == 1] = 'yes'","6de0afae":"data['thal'][data['thal'] == 0] = 'normal'\ndata['thal'][data['thal'] == 1] = 'normal'\ndata['thal'][data['thal'] == 2] = 'fixed defect'\ndata['thal'][data['thal'] == 3] = 'reversable defect'","297bb456":"X_train.columns","57e02e9e":"data.isna().sum()","23662a2b":"data['age']","a34f3ea0":"sns.distplot(data['age']); plt.show()","e9c4c7ac":"plt.figure(figsize = (10,10))\nsns.boxplot(x = data['sex'], y = data['age'], hue = data['target'], palette = my_palette); plt.show()","d8151176":"data['sex']","4d9e6f30":"data['sex'].value_counts()","aa928863":"sns.countplot(x = data['sex'], hue = data['target'], palette = my_palette); plt.show()","67a3d78e":"X_train['cp']","a8f7b4a0":"X_train['cp'].value_counts()","ca1da4ab":"# Does chest pain indicate possible heart disease?\n\nplt.figure(figsize = (10,10))\nsns.countplot(x = data['cp'], hue = data['target'], palette = my_palette);plt.show()","747e4c4d":"plt.figure(figsize = (10,10))\nsns.boxplot(x = data['cp'], y = data['age'], hue = data['target'], palette = my_palette); plt.show()","968de555":"data['trestbps']","3ea73ab2":"def trestbps_bin(row):\n    if row['trestbps'] <= 80:\n        value = 'Low'\n    elif row['trestbps'] > 120:\n        value = 'High'\n    else:\n        value = \"Normal\"\n    \n    return value","2f8e4cba":"data['trestbps'] = data.apply(trestbps_bin, axis = 1)","e90c9b8c":"data['trestbps'].value_counts","0c62ed9d":"pd.crosstab(data['trestbps'], data['target']).plot(kind = 'bar', color = ['r','k']);plt.show()","5fb2e205":"data['chol']","ada9d797":"sns.distplot(data['chol'], kde = True, rug = True); plt.show()","bbf6ff61":"sns.boxplot(data['target'], data['chol'], palette = my_palette); plt.show()","fd7ad815":"gender_palette = {'male' : 'black', 'female' : 'red'}","199c7827":"sns.violinplot(data['target'], data['chol'], hue = data['sex'], split = True)\nsns.swarmplot(data['target'], data['chol'], color = 'black',hue = data['sex']);plt.show()","151d9e0d":"data['thalach']","4dcff704":"sns.distplot(data['thalach'], rug = True); plt.show()","42139c67":"sns.boxplot(data['target'], data['thalach'], palette = my_palette); plt.show()","6f7f62ec":"# before getting into details by gender, let's begin with with better details of the distribution of the data points.\nsns.boxenplot(data['target'], data['thalach'], palette = my_palette); plt.show()","dc9c3224":"data['oldpeak']","6e3a1f66":"sns.barplot(x = 'target', y = 'oldpeak', data = data, palette = my_palette); plt.show()","dcc45291":"sns.boxplot(x = 'target', y = 'oldpeak', data = data, hue = 'sex', palette = gender_palette); plt.show()","5ce20e5e":"data['fbs']","de2c25f8":"data['fbs'].value_counts()","2e00c3d0":"sns.countplot(data['fbs'], hue = data['target'], palette = my_palette); plt.show()","ea847afe":"pd.crosstab(data['target'], data['fbs']).plot(kind = 'bar', color = ['r','k']); plt.show()","cde8f154":"data['restecg']","d5291b2d":"data['restecg'].value_counts()","2131f536":"plt.figure(figsize = (10,10))\nsns.countplot(data['restecg'], hue = data['target'], palette = my_palette); plt.show()","49ce9516":"sns.set_style('darkgrid')\npd.crosstab(data['target'], data['restecg']).plot(kind = 'bar', color = ['r','grey', 'k']); plt.show()","b428bdee":"data['exang']","e0e99304":"data['exang'].value_counts()","604461b2":"sns.countplot(data['exang'], hue = data['target'], palette = my_palette); plt.show()","799235c1":"pd.crosstab(data['target'], data['exang']).plot(kind = 'bar', color = ['r', 'k']); plt.show()","a749d2ce":"data['oldpeak']","78ace61e":"sns.countplot(data['exang'], hue = data['target'], palette = my_palette); plt.show()","188540b9":"data['slope']","beea9e39":"sns.countplot(data['slope'], hue = data['target'], palette = my_palette); plt.show()","626bdc5a":"pd.crosstab(data['target'], data['slope']).plot(kind = 'bar', color = ['r', 'grey', 'k']); plt.show()","da6c5565":"data['ca']","948cef27":"data['ca'].value_counts()","47cee564":"sns.countplot(data['ca'], hue = data['target'], palette = my_palette); plt.show()","23e4d7eb":"data['thal']","360f2a2a":"data['thal'].value_counts()","58d8857b":"sns.countplot(data['thal'], hue = data['target'], palette = my_palette); plt.show()","b1a14e92":"sc = StandardScaler()","61454f17":"X_train","a2a21dd3":"X_train = sc.fit_transform(X_train)","fe206fb9":"X_test = sc.transform(X_test)","5e855d2d":"X_train","7574567e":"X_test","388d4855":"from sklearn.linear_model import LogisticRegression","2feac634":"lr = LogisticRegression()","1b4c3564":"lr.fit(X_train, y_train)","e7df11ab":"lr.score(X_test, y_test)","543199b0":"from sklearn.ensemble import RandomForestClassifier","5cb6e795":"clf = RandomForestClassifier(600)","7c122c86":"clf.fit(X_train, y_train)","5c38d3b7":"clf.score(X_test, y_test)","75502cfe":"import xgboost as xgb\nfrom xgboost import XGBClassifier\nalg = XGBClassifier(learning_rate=0.01, n_estimators=2000, max_depth=8,\n                        min_child_weight=0, gamma=0, subsample=0.52, colsample_bytree=0.6,\n                        objective='binary:logistic', nthread=4, scale_pos_weight=1, \n                    seed=27, reg_alpha=5, reg_lambda=2, booster='gbtree',\n            n_jobs=-1, max_delta_step=0, colsample_bylevel=0.6, colsample_bynode=0.6)\nalg.fit(X_train, y_train)\n\nprint('test accuracy',alg.score(X_test,y_test))","31e12a3c":"Understanding the variables :- \n1. cp -> Chest Pain \n  Possible values : \n   0: asymptomatic\n   1: atypical angina\n   2: non-anginal pain\n   3: typical angina\n   \n2. restecg -> Resting electrocardiographic results\n\nPossible Values :-\n a) Value 1 -> Normal\n b) Value 0 & 2 -> showing probable or definitive left ventricular hypertrophy; having ST-T wave abnormality\n \n 3. target -> 0 = disease ; 1 = no disease\n \n 4. thal \n    Values :- \n    1. Fixed Defect\n    2. Normal\n    3. Reversable Effect\n    \n  5. slope -> the slope of the peak exercise ST segment\n  \n  value -> 0 : downsloping\n           1 : flat\n           2 : upsloping\n           \n  \n  \n  Other obvious features:\n  \n  Age, Sex, Resting Blood Pressure, Serum Choslestrol, Fasting Blood Sugar, Maximum Heart Rate Achieved, Exercise Induced Angina (1 = yes, 0 = no), OldPeak = ST Depression induced by exercise relative to rest; Number of Major Vessels -> 0-3 colored by flouroscopy; Thalasemia (3 = normal, 6 = fixed defect, 7 = reversable defect)\n ","92bdc59e":"Exang","74bac008":"Random Forest Classifier","2e26dc83":"OldPeak","c65cbc5a":"This indicates that cholestrol level is not the sole deciding factor for predicting whether the person gets heart disease or not. People with similar levels of cholestrol have got heart disease as well as are free from heart disease. Clearly, there is no direct correlation of heart disease with the chol level.","8412db34":"ca","893fefc3":"It is evident that the people having high \"trestbps\" have a larger count of having heart disease compared to the ones with lower count. To be put in a correct manner, high blood pressure is just an indication of increased chances of having heart disease but not a definitive indicator as equal number of patients are having high blood pressure but live disease free. Contrary to this, the ones with normal blood pressure show deviation from normalcy. Among the people with normal blood pressure, the ones with heart disease outnumbers the ones without heart disease.\nCONCLUSION -> High Blood pressure can increase chances of having heart disease but is not a definitive indicator of having heart disease. People with high blood pressure might live without heart disease and people without high blood pressure might live w\/ heart disease.","0fdccda1":"We are done with the Exploratory Data Analysis. We understood the individual feature influence on the target variable. Some features were clear indicator of their causation on the target variable. Some variables might be standing ineffective standing alone. However, they might have an effect when other factors are combined.","5622d913":"Thalach","36238f0c":"The results are interesting. Normal & reversible defect are less prone to heart disease compared to fixed defect.","da09997d":"There are no null or missing values in the dataset.","a13dd556":"The results are quite interesting. \nTo begin with, asymptomatic, the people with disease outnumbers the people without disease. This shows, even if there is no chest pain, chances are high that the person is having heart disease.\nSame is the case with non-anginal pain as well as atypical angina. \nHowever, if the pain is detected to be anginal pain, chances of having heart disease reduces drastically. Maybe, it is due to the precautionary medication\/treatment which is taken after detection of angina.","5570ac97":"Performing Feature Scaling","8ace9c14":"visualizing in encodings in difficult. Let's decode to text.","06c2a7f9":"## This notebook on Heart Disease UCI Dataset is where we'll learn to implement various methods & techniques in a gradual progressive manner, i.e., simple to complex beginning with comprehensive EDA.","1d50e17e":"We can observe the distribution of the datapoints being concentrated at 130 to 150 for people with no heart disease; and 155 to 175 for people with heart disease.","c83ccb89":"Improvisations & additions on this notebook will keep happening gradually. In this version, we covered the EDA + Few Modelling methods like Random Forest, XGBoost","012c71ba":"Simple Logistic Regression","7aaa220f":"Which Sex is prone to heart disease?","5d171dd8":"XGBoost Classifier","842cde3f":"## Data Exploration","6dd6dbc4":"Slope","896c24dd":"Trestbps","1730ab10":"Sex","13d7200d":"# Data Modelling","fe93d454":"Restecg","66683f45":"Thal","d9aa71b9":"This inference should be quite obvious. The lesser the number of major vessels, the higher the chances of heart disease","e155362b":"The majority of the cholestrol values of the observations lie between 150 to 350. The majority being between 200 to 300.","6d177cc2":"fbs","f28ddb16":"Age","092d562a":"## Imports","65bedfcb":"### Some Facts\n\n* Cardiovascular disease is the leading cause of death in women in Australia with 90% of women having one risk factor.\n* The causes including high blood pressure, high cholesterol, smoking, diabetes, weight and family history are discussed.\n* A woman's risk also goes up if she's had a miscarriage or had her ovaries or uterus removed.\n* Women's hearts are affected by stress and depression more than men's. Depression makes it difficult to maintain a healthy lifestyle.","887dda8f":"People with higher thalach levels are prone to heart disease. Let's explore the data by gender","94d6d825":"**Which age group sex-wise is more vulnerable to heart disease?**","4adb9531":"For both sexes, the age group of 45-60 seems the most vulnerablw to heart diseases.","9291d1ae":"Old Peak","38c76086":"The above plot confirms the inference made above. Let's explore the variable 'thalach'","b3330947":"Downsloping influences the most in case of heart disease.","5306693c":"**Which Age group is more vulnerable to heart disease?**","d49ac3f2":"It can be confirmed that people with heart disease are usually found to have 'oldpeak' value lying in the range of 0 to 1. And the ones without heart disease have values of 'oldpeak' above 1.","c3d0df76":"Let's take a deeper look into it.","83df2f5c":"As per the dataset, Men are prone to heart disease compared to women.\nHowever, within women, the number of women with heart disease exceeds the number of women w\/o heart disease.","66997060":"## If you liked the notebook, please appreciate my efforts by giving an UPVOTE! Thanks!","60cd5c66":"Chol","cfefa48c":"For men, it is 45-55. For women, it is 46-60 which is the most vulnerable.","d58851f0":"Any null or missing values","ab961e51":"The result is quite clear. We can't infer based on the exang value. However, we can comment that if there is heart disease detected, chances are high that exang value is False","3723be57":"CP"}}