{"cell_type":{"99c41570":"code","9a56dc02":"code","f9444ce6":"code","0deed0c0":"code","bb94b095":"code","fc0d7516":"code","74293c87":"code","e8bc444d":"code","62524bf9":"code","2ac92017":"markdown","3c2c40b2":"markdown","05562b2f":"markdown","760517bc":"markdown","f6bcb837":"markdown","beb4437a":"markdown","9502d12b":"markdown","26a4426a":"markdown","d04e5138":"markdown","4d007efd":"markdown","b1fa66ee":"markdown","f2806359":"markdown","fafabc53":"markdown","bae4f95b":"markdown","bf26d117":"markdown","5e9df24f":"markdown","db638b09":"markdown","a8bd528d":"markdown","e69f4797":"markdown"},"source":{"99c41570":"# Import Pandas Library, used for data manipulation\n# Import matplotlib, used to plot our data\n# Import numpy for linear algebra operations\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n","9a56dc02":"# Import our WeatherDataP.csv and store it in the variable weather_data_p\nweather_data_p = pd.read_csv(\"..\/input\/weather-data-p\/WeatherDataP.csv\")\n \n# Display the data in the notebook\nweather_data_p","f9444ce6":"# Set our input x to Pressure, use [[]] to convert to 2D array suitable for model input\nX = weather_data_p[[\"Pressure (millibars)\"]]\ny = weather_data_p.Humidity\n\n# Produce a scatter graph of Humidity against Pressure\nplt.scatter(X, y, c = \"black\")\nplt.xlabel(\"Pressure (millibars)\")\nplt.ylabel(\"Humidity\")","0deed0c0":"# Import the function \"PolynomialFeatures\" from sklearn, to preprocess our data\n# Import LinearRegression model from sklearn\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.linear_model import LinearRegression\n\n# Set PolynomialFeatures to degree 2 and store in the variable pre_process\n# Degree 2 preprocesses x to 1, x and x^2\n# Degree 3 preprocesses x to 1, x, x^2 and x^3\n# and so on..\n \npre_process = PolynomialFeatures(degree=2)\n# Transform our x input to 1, x and x^2\nX_poly = pre_process.fit_transform(X)\n# Show the transformation on the notebook\nX_poly","bb94b095":"pr_model = LinearRegression()\n\n# Fit our preprocessed data to the polynomial regression model\npr_model.fit(X_poly, y)\n\n# Store our predicted Humidity values in the variable y_new\ny_pred = pr_model.predict(X_poly)\n\n# Plot our model on our data\nplt.scatter(X, y, c = \"black\")\nplt.xlabel(\"Pressure (millibars)\")\nplt.ylabel(\"Humidity\")\nplt.plot(X, y_pred)","fc0d7516":"theta0 = pr_model.intercept_\n_, theta1, theta2 = pr_model.coef_\ntheta0, theta1, theta2","74293c87":"# Predict humidity for a pressure of 1007 millibars\n# Tranform 1007 to 1, 1007, 1007^2 suitable for input, using \n# pre_process.fit_transform\ny_new = pr_model.predict(pre_process.fit_transform([[1007]]))\ny_new","e8bc444d":"plt.scatter(X, y, c = \"Black\")\nplt.xlabel(\"Pressure (millibars)\")\nplt.ylabel(\"Humidity\")\nplt.plot(X, y_pred)\nplt.scatter(1007, y_new, c = \"red\")","62524bf9":"from sklearn.metrics import mean_squared_error\nmean_squared_error(y, y_pred)","2ac92017":"To evaluate our model we are going to be using mean squared error (MSE). Given by the following formula:\n\n\n![image.png](attachment:image.png)![](http:\/\/)\n\nThis shows the average distance our data points are away from our model's predictions.","3c2c40b2":"Here we expect a Humidity value of 0.7164631 for a pressure reading of 1007 millibars.","05562b2f":"# 2. Plot our Data","760517bc":"# 4. Implement our Polynomial Regression Model","f6bcb837":"# 1. Import our Data\n","beb4437a":"Giving our polynomial regression model roughly as:\n\n![image.png](attachment:image.png)\n","9502d12b":"Notice that there is a hidden column of 1's which can be thought of as the variable associated with \u03b8\u2080. Since \u03b8\u2080 \u00d7 1 = \u03b8\u2080 this is often left out.","26a4426a":"# 5. Use our Regression Model to make predictions","d04e5138":"Here are we are essentially making the following conversion:","4d007efd":"We can plot this point on our data plot using the following code:","b1fa66ee":"e+.. refers to the position of the decimal place.\u00a0\nE.g\n\n* 1.0e+00 = 1.0 [ keep the decimal point where it is ]\n* 1.0144e+03 = 1014.4 [ Move the decimal place 3 places to the right ] \/\/\n* 1.02900736e+06 = 1029007.36 [ Move the decimal place 6 to places to the right ] ","f2806359":"![image.png](attachment:image.png)\n","fafabc53":"Our predicted humidity value is shown in red.","bae4f95b":"# 6. Evaluate our\u00a0Model","bf26d117":"# 3. Preprocess our Data","5e9df24f":"The mean squared error for our regression model is given by: 0.003358..\n\n\nIf we want to change our model to include \ud835\udc65\u00b3 we can do so by simply changing PolynomialFeatures to degree 3.\n\nYou can change the degree used in PolynomialFeatures to anything you like and see for yourself what effect this has on our MSE.\u00a0\n\nIdeally we want to choose the model that:\n\n* Has the lowest MSE\n* Does not over-fit our data\n","db638b09":"We can extract \u03b8\u2080, \u03b8\u2081 and \u03b8\u2082 using the following code:","a8bd528d":"Article: https:\/\/medium.com\/ai-in-plain-english\/understanding-polynomial-regression-17233786fa74\n\nYoutube: https:\/\/www.youtube.com\/channel\/UCiFF3AvbzLWdRyRnQMEttqw?view_as=subscriber\n","e69f4797":"# Import our Libraries"}}