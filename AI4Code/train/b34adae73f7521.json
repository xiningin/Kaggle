{"cell_type":{"89d62edd":"code","346b90df":"code","bac6dccf":"code","8d638854":"code","2d3b875b":"code","7c2094a7":"code","234f5d01":"code","6d31b600":"code","abee7516":"code","653a1633":"code","978a133c":"code","57e4892b":"code","e0b5437c":"code","8789f9ac":"code","bd2dee00":"code","30704046":"markdown","46b94ce8":"markdown","2a047a3a":"markdown","e0e179cc":"markdown","aadac86c":"markdown","484f35d9":"markdown","9643eb43":"markdown"},"source":{"89d62edd":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt \n%matplotlib inline\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","346b90df":"df=pd.read_csv(\"..\/input\/who_suicide_statistics.csv\")","bac6dccf":"df['suicides_no_fillna']=df.groupby(['country','sex','age']).transform(lambda x: x.fillna(x.mean()))['suicides_no']\ndf['population_fillna']=df.groupby(['country','sex','age']).transform(lambda x: x.fillna(x.mean()))['population']","8d638854":"df['age']=df['age'].str.replace(' years','')\ndf.loc[(df['age']=='5-14'),'age']='05-14'","2d3b875b":"df.head()","7c2094a7":"df.info()","234f5d01":"print(\"Number of countries:\",len(df.country.unique()))\nprint(\"Year of oldest record:\",df.year.min())\nprint(\"Year of newest record:\",df.year.max())","6d31b600":"df_2015=df[df['year']==2015]\ndf_2015.head()","abee7516":"temp=df_2015.groupby('country').agg('sum').reset_index()\ntemp['rate_per_100k_people']=temp['suicides_no_fillna']\/(temp['population_fillna']\/100000)\ntemp=temp[temp['population_fillna']!=0].sort_values('rate_per_100k_people',ascending=False).head(10)\ntop10_rate=temp['country'].tolist()\n\nimport math\n\nfig,ax=plt.subplots(nrows=2,ncols=5,sharey=True)\nfig.set_figheight(10)\nfig.set_figwidth(2*len(top10_rate))\nfig.subplots_adjust(hspace=0.4, wspace=0.2)\n\npalette ={\"male\":\"#EE8C1E\",\"female\":\"#5499C7\"}\nfor i in range(0, (len(top10_rate))):\n    temp=df.loc[(df['country']==top10_rate[i]) & (df['year']==2015),['country','sex','age','suicides_no_fillna','population_fillna']]\n    temp['rate_per_100k_people']=temp['suicides_no_fillna']\/(temp['population_fillna']\/100000)\n    temp=temp.sort_values('age')\n    row=math.floor((i)\/5)\n    col=(i%5)\n    title=str(top10_rate[i]) \n    sns.barplot('age','rate_per_100k_people',hue='sex',data=temp,ax=ax[row][col],palette=palette)\n    ax[row][col].set_title(title,fontsize=20)","653a1633":"temp=df_2015.groupby('age').agg('sum').reset_index()\nsns.barplot('age','suicides_no_fillna',data=temp,color='#5499C7')\nplt.show()","978a133c":"temp=df[df['year']>=2000]\ntemp=temp.groupby(['country','year']).agg('sum').reset_index()\ntemp['rate_per_100k_people']=temp['suicides_no_fillna']\/(temp['population_fillna']\/100000)\ntemp=temp[temp.population_fillna!=0]\nplt.scatter(x='population',y='rate_per_100k_people',data=temp)\nplt.show()\n\nimport scipy\nprint(\"Pearson correlation between population size and suicide rate:\",scipy.stats.pearsonr(temp['population'],temp['rate_per_100k_people'])[0])","57e4892b":"from bokeh.plotting import figure, show\nfrom bokeh.models import HoverTool\nfrom bokeh.models import ColumnDataSource\nfrom bokeh.io import output_notebook\nfrom bokeh.models import DatetimeTickFormatter\n\noutput_notebook()\nsource_all=[]\n\ntemp=df.groupby(['country','year']).agg('sum').reset_index()\ntemp['rate_per_100k_people']=temp['suicides_no_fillna']\/(temp['population_fillna']\/100000)\nmax_count=temp[temp['country'].isin(top10_rate)].rate_per_100k_people.max()\n\nfor i in range(0,len(top10_rate)):\n    plot_data=temp[temp['country']==top10_rate[i]]\n    \nfor i in range(0,len(top10_rate)):\n    plot_data=temp[temp['country']==top10_rate[i]]\n    x_vals = plot_data['year'].tolist()\n    x = plot_data['year'].tolist()\n    y = plot_data['rate_per_100k_people'].tolist()\n    desc = plot_data['country'].tolist()\n\n    data = {'x': x,\n            'y': y,\n            'desc':desc,\n            'year':x_vals,\n            'count':y\n           }\n    source = ColumnDataSource(data)\n    source_all.append(source)\n\nplot = figure(plot_width=800, plot_height=400,y_range=(0,max_count+0.1*max_count))   \nfor i in range(0,len(source_all)):\n    plot.circle(x='x',y='y', source=source_all[i],fill_color=\"white\",alpha=0.1,name=\"circle\")\n    plot.line(x='x',y='y', source=source_all[i],line_width=2,alpha=0.1,hover_line_alpha=1,hover_line_color=\"#B22222\",name=\"line\")\n    \nhover = HoverTool(show_arrow=False,\n                  line_policy='nearest',\n                  names=[\"line\"],\n                  tooltips=[('desc','@desc'),\n                            ('year','@year'),\n                            ('suicide rate','@count')]\n                     )\nplot.add_tools(hover)\nshow(plot) \n","e0b5437c":"import pycountry\ntemp=df[df['year']>=2000].copy()\nreplace_country={'Czech Republic':'Czechia','Hong Kong SAR':'Hong Kong','Iran (Islamic Rep of)':'Iran, Islamic Republic of',\n                'Republic of Korea':'Korea, Republic of','Republic of Moldova':'Moldova, Republic of','Reunion':'R\u00e9union',\n                'Rodrigues':'Mauritius','Saint Vincent and Grenadines':'Saint Vincent and the Grenadines',\n                'TFYR Macedonia':'Macedonia, Republic of','United States of America':'United States',\n                'Venezuela (Bolivarian Republic of)':'Venezuela, Bolivarian Republic of',\n                'Virgin Islands (USA)':'Virgin Islands, U.S.'}\ntemp['country'].replace(replace_country,inplace=True)\n\ntemp=temp.groupby(['country','year']).agg('sum').reset_index()\ntemp['rate_per_100k_people']=temp['suicides_no_fillna']\/(temp['population_fillna']\/100000)\ntemp=temp[temp['population_fillna']!=0].groupby('country').agg('mean').reset_index()[['country','rate_per_100k_people']]\n\nd={'country':[x.name for x in list(pycountry.countries)],'code':[x.alpha_3 for x in list(pycountry.countries)]}\ntemp=pd.DataFrame(data=d).merge(temp,on='country',how='left')\ntemp=temp.fillna(0)","8789f9ac":"temp.head()","bd2dee00":"import plotly.plotly as py\nfrom plotly.offline import init_notebook_mode, plot, iplot\nimport plotly.graph_objs as go\n\ninit_notebook_mode(connected=True)\n\ndata = [ dict(\n        type = 'choropleth',\n        locations = temp['code'],\n        z = temp['rate_per_100k_people'],\n        text = temp['country'],\n        colorscale = [[0,\"rgb(5, 10, 172)\"],[0.35,\"rgb(40, 60, 190)\"],[0.5,\"rgb(70, 100, 245)\"],\\\n            [0.6,\"rgb(90, 120, 245)\"],[0.7,\"rgb(106, 137, 247)\"],[1,\"rgb(220, 220, 220)\"]],\n        autocolorscale = False,\n        reversescale = True,\n        marker = dict(\n            line = dict (\n                color = 'rgb(180,180,180)',\n                width = 0.5\n            ) ),\n        colorbar = dict(\n            title = 'Suicide Rate'),\n      ) ]\n\nlayout = dict(\n    title = 'Suicide Rate by Country in 21st Century',\n    width=1000,\n    height=800,\n    margin=go.layout.Margin(\n        l=0,\n        r=0,\n        b=0,\n        t=50,\n        pad=0\n    ),\n    geo = dict(\n        showframe = False,\n        showcoastlines = False,\n        projection = dict(\n            type = 'mercator'\n        )\n    )\n)\n\nfig = dict(data=data, layout=layout)\niplot(fig, filename='choropleth-map')","30704046":"### Number of Suicides by Age\nAge group '35-54' has the most cases of suicide","46b94ce8":"### Suicide rate over the years for top 10 countries with highest suicide rate in 2015","2a047a3a":"## Modify the column\nRemove 'years' from 'age' column and make it easier to sort by changing age '5-14' to '05-14'","e0e179cc":"## Missing Values\nFill NaN values with the mean of each group (by country, sex, and age)","aadac86c":"## Year 2015","484f35d9":"### Is there any correlation between population size and suicide rate?","9643eb43":"### Top 10 Countries with the Highest Suicide Rate"}}