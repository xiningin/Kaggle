{"cell_type":{"50a4ba4e":"code","7b6b183f":"code","1d3b59fe":"code","07204f17":"code","0a395c76":"code","229fb88b":"markdown","2cd8871e":"markdown","64ff2901":"markdown"},"source":{"50a4ba4e":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport tqdm\nimport gensim","7b6b183f":"with open('vk_music_lists.csv', 'w') as f:\n    for chunk in pd.read_csv('..\/input\/vk_dataset_anon.csv', \n                                       iterator=True, \n                                       chunksize=1000000,\n                                       header=None,\n                                       lineterminator='\\n',\n                                       error_bad_lines=False,\n                                       # remove this to use whole dataset\n                                       nrows=5000000,\n                                       ##################################\n                                      ):\n        chunk.columns = ['user', 'song', 'band']\n        chunk['band'] = chunk['band'].astype(str)\n        chunk = chunk.groupby('user')['band'].apply(','.join).reset_index()\n\n        for row in chunk.iterrows():\n            f.write(row[1]['band'] + '\\n')","1d3b59fe":"class TextToW2V(object):\n    def __init__(self, file_path):\n        self.file_path = file_path\n\n\n    def __iter__(self):\n        for line in open(self.file_path, 'r'):\n            yield line.lower().split(',')[::-1]  # reverse order (make old -> new)\n\nmusic_collections = TextToW2V('vk_music_lists.csv')","07204f17":"%%time\nestimator = gensim.models.Word2Vec(music_collections,\n                                   window=15,\n                                   min_count=30,\n                                   sg=1,\n                                   workers=4,\n                                   iter=10,\n                                   ns_exponent=0.8,\n                                  )","0a395c76":"user_music = ['led zeppelin', 'Nirvana', 'Pink Floyd']\nuser_music = [m.lower().strip() for m in user_music]\npredicted = estimator.predict_output_word(user_music)\n\n[a[0] for a in predicted if a[0] not in user_music]","229fb88b":"### Reformat dataset to train Word2Vec model","2cd8871e":"### Train basic model","64ff2901":"### Sanity check"}}