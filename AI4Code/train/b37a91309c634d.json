{"cell_type":{"2a021d26":"code","9978f00b":"code","bc3e8a77":"code","e3fa8c61":"code","71273d85":"code","485f7c94":"code","0ba6613f":"code","e5d8e345":"code","19345219":"code","ca39389b":"code","03689c62":"code","7b9bf0b6":"code","448a881e":"code","7d667f3f":"code","ab1fc441":"code","fe8f132c":"code","a9312a96":"markdown"},"source":{"2a021d26":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","9978f00b":"trainfile = '\/kaggle\/input\/nlp-starter-test\/socialmedia_relevant_cols.csv'\ntrain = pd.read_csv(trainfile).drop('class_label',axis=1)\nprint(train.shape)\ntrain.head()","bc3e8a77":"target = 'choose_one'","e3fa8c61":"train[target].value_counts()","71273d85":"## we will drop the 16 rows that have Can't decide as the value since it is too less\ntrain = train[train[target]!=\"Can't Decide\"]\ntrain.shape","485f7c94":"#!pip install deep_autoviml","0ba6613f":"from deep_autoviml import deep_autoviml as deepauto","e5d8e345":"nlp_column = \"text\"\ntrain[nlp_column].fillna(\"missing\")","19345219":"keras_options = {}\nmodel_options = {'max_trials':5}\nproject_name = \"deep_autoviml\"\nkeras_model_type = \"NLP\"","ca39389b":"model, cat_vocab_dict = deepauto.fit(train, target, keras_model_type=keras_model_type,\n\t\tproject_name=project_name, keras_options=keras_options,  \n\t\tmodel_options=model_options, save_model_flag=False, use_my_model='',\n\t\tmodel_use_case='', verbose=0)","03689c62":"testfile = '\/kaggle\/input\/nlp-starter-test\/socialmedia_relevant_cols.csv'\ntest = pd.read_csv(testfile)\ntest = test[test[target]!=\"Can't Decide\"]\ntest.head(1)","7b9bf0b6":"predictions = deepauto.predict(model, project_name, test_dataset=test,\n                                 keras_model_type=keras_model_type, \n                                 cat_vocab_dict=cat_vocab_dict)","448a881e":"from deep_autoviml import print_classification_model_stats, print_regression_model_stats","7d667f3f":"y_test = test[target].values\ny_test[:5]","ab1fc441":"y_preds = predictions[-1]\ny_preds[:5]","fe8f132c":"print_classification_model_stats(y_test, y_preds)","a9312a96":"# Install Deep Autoviml and Import it"}}