{"cell_type":{"19b98bad":"code","8f459d72":"code","49d510db":"code","c0fce56c":"code","42f10f74":"code","755e1130":"code","9ca66ed1":"code","0521621f":"code","c9207f35":"code","84ee4bf7":"code","5370a523":"code","9fbd5fe7":"markdown","26ca3597":"markdown","f77c4749":"markdown","eecbe686":"markdown","ca86d373":"markdown","663f77aa":"markdown","18adf1cc":"markdown"},"source":{"19b98bad":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.\n\nimport seaborn as sns # seaborn package\nimport matplotlib.pyplot as plt # matplotlib library\n","8f459d72":"# abre dataset com pre\u00e7os de combust\u00edveis\nos.chdir('\/kaggle\/input\/gas-prices-in-brazil\/')\ndf = pd.read_csv('2004-2019.tsv', sep='\\t',parse_dates=[1,2])\ndf.sample(5)\n","49d510db":"# verifica tipos de campo\ndf.info()","c0fce56c":"# Remo\u00e7\u00e3o de coluna indesejada\ndf2 = df.drop(\"Unnamed: 0\", axis=1)\n\n# Convers\u00e3o de colunas num\u00e9ricas que constam como object para os tipos adequados\ncol_numeros = ['UNIDADE DE MEDIDA', 'MARGEM M\u00c9DIA REVENDA', 'PRE\u00c7O M\u00c9DIO DISTRIBUI\u00c7\u00c3O', \n            'DESVIO PADR\u00c3O DISTRIBUI\u00c7\u00c3O', 'PRE\u00c7O M\u00cdNIMO DISTRIBUI\u00c7\u00c3O', 'PRE\u00c7O M\u00c1XIMO DISTRIBUI\u00c7\u00c3O',\n            'COEF DE VARIA\u00c7\u00c3O DISTRIBUI\u00c7\u00c3O']\nfor col in col_numeros:\n    df2[col] = pd.to_numeric(df2[col], errors='coerce')\ndf2.dtypes","42f10f74":"# Lista produtos\nprodutos = df2['PRODUTO'].unique()\nfor p in produtos: print(p)","755e1130":"# Identifica faixa de tempo\ndef ano_mes(data):  # formata para m\u00eas-ano\n    am = str(data%100) + \"-\"+ str(data\/\/100)\n    return am\n\nmeses = df2['M\u00caS'] + df2['ANO']*100 \nmeses = meses.unique()\nmeses.sort()\n\nprint(ano_mes(meses[0]) + ' at\u00e9 '+ ano_mes(meses[-1]))\n","9ca66ed1":"# Verifica valores Null\ndf2.info()","0521621f":"df2.sample(5)","c9207f35":"# Carrega dataset de pre\u00e7os de \u00f3leo bruto\ntea_oil = pd.read_csv('\/kaggle\/input\/tea-and-oil-price-data-gem-database\/export_dt.csv', index_col=0, parse_dates=True)\ntea_oil['ANO'] = tea_oil.index.year\ntea_oil['M\u00caS'] = tea_oil.index.month\ntea_oil.head()\n","84ee4bf7":"#cor = 'white' # eu uso um notebook com fundo escuro. Para fundo claro, remova o coment\u00e1rio abaixo\ncor = 'black'\n\ndef muda_cor(graf,titulo):  # muda cores e t\u00edtulo para um gr\u00e1fico\n    graf.xaxis.label.set_color(cor)\n    graf.xaxis.label.set_color(cor)\n    graf.tick_params(axis='x', colors=cor)\n    graf.tick_params(axis='y', colors=cor)\n    graf.set_title(titulo, color=cor)\n\n    graf.grid(True)\n    return \n\n# plot Regionwise Yearwise Average Price data\n#plt.figsize=(39,15)\nfig, axes  = plt.subplots(2, 2, sharey=True,figsize=(15,13))\n\ndf2.query('2012<=ANO<=2018 & PRODUTO in [\"\u00d3LEO DIESEL\"]').groupby(['ANO', 'REGI\u00c3O'])['PRE\u00c7O M\u00c9DIO REVENDA'].agg('mean').unstack().plot(ax=axes[0,0])\ndf2.query('2012<=ANO<=2018 & PRODUTO in [\"\u00d3LEO DIESEL S10\"]').groupby(['ANO', 'REGI\u00c3O'])['PRE\u00c7O M\u00c9DIO REVENDA'].agg('mean').unstack().plot(ax=axes[0,1])\ndf2.query('ANO!=2019 & PRODUTO in [\"\u00d3LEO DIESEL\"]').groupby(['ANO', 'REGI\u00c3O'])['PRE\u00c7O M\u00c9DIO REVENDA'].agg('mean').unstack().plot(ax=axes[1,0])\ndf2.query('ANO!=2019 & PRODUTO in [\"\u00d3LEO DIESEL S10\"]').groupby(['ANO'])['PRE\u00c7O M\u00c9DIO REVENDA'].agg('mean').plot(ax=axes[1,1])\ndf2.query('ANO!=2019 & PRODUTO in [\"\u00d3LEO DIESEL\"]').groupby(['ANO'])['PRE\u00c7O M\u00c9DIO REVENDA'].agg('mean').plot(ax=axes[1,1])\n\n#configura cada gr\u00e1fico\nmuda_cor(axes[0,0], '\u00d3LEO DIESEL 2012-2018')\nmuda_cor(axes[0,1], '\u00d3LEO DIESEL S10 2012-2018')\nmuda_cor(axes[1,0], '\u00d3LEO DIESEL 2004-2018')\nmuda_cor(axes[1,1], '\u00d3LEO DIESEL S10 x \u00d3LEO DIESEL 2004-2018')\n\n#plt.grid(True)\n#ax1.grid(True)\n#for axis in axes: axis.grid(True)\n#axes","5370a523":"fig, ax1  = plt.subplots(figsize=(15,7))\n\n\ndf2.query('2004<=ANO<=2018 & PRODUTO in [\"\u00d3LEO DIESEL\"]').groupby(['ANO'])['PRE\u00c7O M\u00c9DIO REVENDA'].agg('mean').plot(ax=ax1, color ='green')\nax2 = ax1.twinx()\ndf2.query('2004<=ANO<=2018 & PRODUTO in [\"\u00d3LEO DIESEL\"]').groupby(['ANO'])['PRE\u00c7O M\u00c9DIO DISTRIBUI\u00c7\u00c3O'].agg('mean').plot(ax=ax1, color ='blue')\nax2 = ax1.twinx()\ntea_oil.query('2004<=ANO<=2018').groupby(['ANO'])['OIL'].agg('mean').plot(ax=ax2, color ='red')\n\n\nmuda_cor(ax1, 'DIESEL x \u00d3LEO BRUTO')\nmuda_cor(ax2, '')","9fbd5fe7":"LIMPEZA DE DADOS\n----------------","26ca3597":"A adicionar:\n\n* mapas com regi\u00f5es\n* mapas com estados\n* posi\u00e7\u00e3o dos principais portos no mapa\n* compara\u00e7\u00e3o de pre\u00e7o do diesel com cesta b\u00e1sica\n* an\u00e1lise de combust\u00edveis renov\u00e1veis (etanol, biodiesel)","f77c4749":"Alguns pontos observados nos gr\u00e1ficos:\n\n- Temos um custo maior nas regi\u00f5es Norte e Centro-Oeste. Uma poss\u00edvel explica\u00e7\u00e3o seria o custo de log\u00edstica para transportar o combust\u00edvel para estas regi\u00f5es. Dependemos muito da importa\u00e7\u00e3o de diesel, que \u00e9 feita atrav\u00e9s de meio mar\u00edtimo. Os principais portos de entrada s\u00e3o os de Paranagu\u00e1, Santos e S\u00e3o Luiz;\n- A regi\u00e3o sul tem o menor valor. Provavelmente devido ao porto de Paranagu\u00e1;\n- O diesel S10 \u00e9 um pouco mais caro que o S500;\n- No per\u00edodo de 2006 a 2012 tivemos pre\u00e7o sem maiores oscila\u00e7\u00f5es. A partir de 2012, tivemos uma subida de pre\u00e7os\n\nRefer\u00eancias:\n* [FGV - artigo de 2016 sobre depend\u00eancia de importa\u00e7\u00e3o](https:\/\/fgvenergia.fgv.br\/noticias\/brasil-continua-dependente-do-diesel-de-fora)\n\n* [Artigo da FATEC sobre impacto da Lava Jato na importa\u00e7\u00e3o de Diesel](https:\/\/even3.blob.core.windows.net\/anais\/90151.pdf)","eecbe686":"MOTIVA\u00c7\u00c3O\n---------\n\nO \u00f3leo diesel \u00e9 muito importante no Brasil, pois \u00e9 A FONTE DE ENERGIA PARA um dos principais modais de transporte no Brasil, que \u00e9 o rodovi\u00e1rio. \u00c9 t\u00e3o importante que em 2018 uma alta dos pre\u00e7os resultou em uma greve de caminhoneiros, paralisando boa parte dos transportes e causando uma s\u00e9rie de transtornos n\u00e3o somente na ind\u00fastria e com\u00e9rcio, mas tamb\u00e9m no fornecimento de itens b\u00e1sicos para a popula\u00e7\u00e3o.\n\nO valor do combust\u00edvel tem rela\u00e7\u00e3o direta com o pre\u00e7o da maioria dos demais produtos devido ao frete. Sendo assim tem sido um fator importante para infla\u00e7\u00e3o no pa\u00eds.\n\nTemos 2 tipos de \u00f3leo diesel:\n- \u00d3leo diesel S10 cont\u00e9m menor teor de enxofre, sendo menos poluente e adequado para ve\u00edculos produzidos ap\u00f3s 2012.\n\n- \u00d3leo diesel comum, tamb\u00e9m conhecido como S500.\n\nEste Kernel analisa a varia\u00e7\u00e3o de pre\u00e7o do combust\u00edvel final (diesel) ao consumidor, comparando com a varia\u00e7\u00e3o do \u00f3leo bruto no mercado internacional e especulando poss\u00edveis raz\u00f5es para o resultado.\n\nRefer\u00eancias : \n[Petrobr\u00e1s](http:\/\/www.petrobras.com.br\/pt\/produtos-e-servicos\/produtos\/automotivos\/oleo-diesel\/)\n\nAutor : Mauro Vianna\n\nData  : 16\/08\/2019","ca86d373":"\nSugest\u00f5es de  melhorias nesta an\u00e1lise:\n* considerar varia\u00e7\u00e3o cambial\n* comparar pre\u00e7os de diesel no mercado internacional","663f77aa":"AN\u00c1LISE\n-------","18adf1cc":"No gr\u00e1fico acima comparamos os valores de pre\u00e7o do Diesel (pre\u00e7o final para o consumidor e pre\u00e7o de distribui\u00e7\u00e3o em reais) com o pre\u00e7o do \u00f3leo bruto em d\u00f3lares, conforme o World Bank's Global Economic Monitor (GEM). Estamos comparando  produtos diferentes e em moedas dierentes, logo fatores como c\u00e2mbio e infla\u00e7\u00e3o foram descartados. \nUm dos objetivos desta compara\u00e7\u00e3o \u00e9 avaliar o comportamento do pre\u00e7o do diesel no Brasil. \nEra de se esperar alguma correla\u00e7\u00e3o entre estes dois produtos (mat\u00e9ria-prima e produto final). Mas isso n\u00e3o acontece. No Brasil, este mercado \u00e9 fortemente influenciado pela Petrobr\u00e1s (e subsidi\u00e1rias), empresa estatal que praticamente det\u00e9m o monop\u00f3lio de extra\u00e7\u00e3o, refino e distribui\u00e7\u00e3o de derivados de petr\u00f3leo.\n\nPodemos observar as seguintes quest\u00f5es:\n\n* O pre\u00e7o final do diesel acompanha o pre\u00e7o de distribui\u00e7\u00e3o;\n* O pre\u00e7o do diesel n\u00e3o segue o pre\u00e7o do \u00f3leo bruto. \u00c9 poss\u00edvel notar que varia\u00e7\u00f5es bruscas no valor do \u00f3leo bruto, positivas ou negativas, implicam em aumento do diesel;\n* O pre\u00e7o do diesel n\u00e3o variou muito at\u00e9 2012, apesar de varia\u00e7\u00f5es expressivas do valor do \u00f3leo bruto;\n* Ap\u00f3s 2012 o pre\u00e7o do diesel dispara, apresentando grande crescimento anual mesmo ap\u00f3s queda vertiginosa do \u00f3leo bruto em 2015. \n\nEspecula\u00e7\u00f5es :\n* A estabiliza\u00e7\u00e3o do pre\u00e7o do diesel at\u00e9 2012 provavelmente foi devida a influ\u00eancia governamental na Petrobr\u00e1s. Tal fato \u00e9 inclusiverefor\u00e7ado  no site do partido do governo da \u00e9poca;\n* Devido ao fato de importarmos diesel e a Petrobr\u00e1s controlar tanto extra\u00e7\u00e3o quanto a distribui\u00e7\u00e3o, ela est\u00e1 sujeita a queda de receita com grandes varia\u00e7\u00f5es do \u00f3leo bruto, sejam elas positivas ou negativas;\n* Eventos como o Petrol\u00e3o (esc\u00e2ndalo de corrup\u00e7\u00e3o na Petrobr\u00e1s descoberto durante a opera\u00e7\u00e3o Lava-Jato) fragilizaram muito a Petrobr\u00e1s, o que tamb\u00e9m implicou na alta dos pre\u00e7o, devido a falta de capacidade de \"absorver\" os impactos das varia\u00e7\u00f5es internacionais;\n* Como em 2019 a Petrobr\u00e1s est\u00e1 vendendo a distribui\u00e7\u00e3o, \u00e9 poss\u00edvel que no futuro tenhamos aumento de concorr\u00eancia e pre\u00e7os mais corentes com os internacionais."}}