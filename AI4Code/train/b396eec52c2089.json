{"cell_type":{"c7111c7d":"code","f4c42929":"code","2e80483e":"code","6c00564d":"code","9d5e6b4a":"code","7e7e2405":"code","f5e6cf05":"code","9f58f68f":"code","496d358f":"code","0d99af40":"code","ec214714":"code","c03255eb":"code","799b6809":"code","412417ec":"code","2c635c99":"code","9ccc8766":"code","7c86971c":"code","0268d3be":"code","c60d7ee8":"code","c6b213e8":"code","02e5a078":"code","83628733":"code","76fddfec":"code","906565e9":"code","0a01d138":"code","f515e142":"code","e3fc7efc":"code","c5c3036a":"code","ba776aca":"code","08a7fbe5":"code","43fd2d71":"code","9ff024c2":"code","1079300e":"code","425b3e9c":"code","b65e6f00":"code","8fca6b7a":"code","ec8a5d43":"code","cf13a8c3":"code","c82298b0":"code","520b9151":"code","48c27a55":"markdown","36cdd0a6":"markdown","2b386486":"markdown","aaf709ff":"markdown","210538c2":"markdown","85ed3639":"markdown","4da50fa2":"markdown","6ab5fd63":"markdown","8f8a9fee":"markdown","ff54e511":"markdown","ccc2cf0b":"markdown","7b8962fa":"markdown","b6fb21cf":"markdown","b8bba9c3":"markdown"},"source":{"c7111c7d":"import numpy as np \nimport pandas as pd","f4c42929":"path ='..\/input\/cvdcvd-vd\/Social_Network_Ads.csv'\ndata = pd.read_csv(path)","2e80483e":"data.head()","6c00564d":"data = data.drop(['User ID'],axis=1)","9d5e6b4a":"data\n","7e7e2405":"data.isnull().sum()","f5e6cf05":"data.dtypes","9f58f68f":"import matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns","496d358f":"male_data =data.loc[(data.Gender=='Male')]","0d99af40":"male_data = male_data.drop(['Gender'],axis=1)\nmale_data","ec214714":"sns.pairplot(male_data)","c03255eb":"plt.figure(figsize=(10,10))\nsns.lmplot(x='Age',y='EstimatedSalary', hue= 'Purchased', data=male_data)","799b6809":"plt.figure(figsize=(20,20))\nsns.violinplot(x='Purchased',y='EstimatedSalary', data=male_data)\nsns.boxplot(x='Purchased',y='EstimatedSalary', hue='Age', data=male_data)","412417ec":"female_data =male_data =data.loc[(data.Gender=='Female')]","2c635c99":"female_data = female_data.drop(['Gender'],axis=1)","9ccc8766":"female_data","7c86971c":"sns.pairplot(female_data)","0268d3be":"plt.figure(figsize=(10,10))\nsns.lmplot(x='Age',y='EstimatedSalary', hue= 'Purchased', data=female_data)","c60d7ee8":"plt.figure(figsize=(20,20))\nsns.violinplot(x='Purchased',y='EstimatedSalary', data=male_data)\nsns.boxplot(x='Purchased',y='EstimatedSalary', hue='Age', data=male_data)","c6b213e8":"age_40_data=data.loc[(data.Age>=40)]","02e5a078":"age_40_data","83628733":"age_40_data = age_40_data.drop(['Age'],axis=1)","76fddfec":"age_40_data","906565e9":"plt.figure(figsize=(20,20))\nsns.lmplot(x='EstimatedSalary',y='Purchased', hue= 'Gender', data=age_40_data)","0a01d138":"from sklearn.model_selection import train_test_split","f515e142":"data['Gender'] =data['Gender'].replace({\"Male\":0,\"Female\":1})","e3fc7efc":"Y = data['Purchased']\nX = data.drop(['Purchased'], axis=1)","c5c3036a":"random_state = 2","ba776aca":"x_train, x_test, y_train, y_test = train_test_split(X, Y, test_size=0.1, random_state= random_state)","08a7fbe5":"from sklearn import tree","43fd2d71":"clf = tree.DecisionTreeClassifier(criterion='entropy', random_state=random_state, min_samples_leaf=30)","9ff024c2":"clf.fit(x_train, y_train)","1079300e":"from sklearn.metrics import accuracy_score","425b3e9c":"pred = clf.predict(x_test)\npred","b65e6f00":"acc = accuracy_score(y_test, pred)\nacc*100","8fca6b7a":"from sklearn.metrics import classification_report","ec8a5d43":"clf_rep = classification_report(y_test, pred)\nclf_rep","cf13a8c3":"plt.figure(figsize=(10,10))\ntree.plot_tree(clf) ","c82298b0":"import graphviz \ndot_data = tree.export_graphviz(clf, out_file=None) \ngraph = graphviz.Source(dot_data) \ngraph.render(\"diabetes\")","520b9151":"dot_data = tree.export_graphviz(clf, out_file=None, \n                     feature_names=X.columns,  \n                     class_names=[\"1\",\"0\"],  \n                     filled=True, rounded=True,  \n                     special_characters=True)  \ngraph = graphviz.Source(dot_data)  \nplt.figure(figsize=(8,10))\ngraph.render(\"diabetes2\")\n","48c27a55":"# EstimatedSalary didn't make a metter but male persones with medium salaty makes more puruchase","36cdd0a6":"# Age is not a big metter but between 45 and 60 makes more purchase","2b386486":"# EstimatedSalary makes a metter and female persones with hight salaty makes more puruchase","aaf709ff":"**Let's study female samples**","210538c2":"# Now let's prepare the data for trainin","85ed3639":"# here we see that female when getting older makes more purchase than the male ","4da50fa2":"# lets study samples which age>40 for both genders","6ab5fd63":"# Preparing the model","8f8a9fee":"# Evaluate the model","ff54e511":"**Lets study Male samples**","ccc2cf0b":"# One hot encoder for gender","7b8962fa":"# Visualiz the data","b6fb21cf":"# between 40 and 60 makes more purchase","b8bba9c3":"# Exploring the data"}}