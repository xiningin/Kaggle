{"cell_type":{"6869bc5c":"code","963f0759":"code","e6b7ef72":"code","5dc68ba0":"code","8710e23d":"code","9d11808d":"code","185bd525":"code","28e357b9":"code","e2fd5ea2":"code","7a09d8dc":"code","42f0c892":"code","f5d89764":"code","2b7eaa8b":"code","8c13d7a6":"code","a8cf371b":"code","649628c4":"code","bad5b7bc":"markdown","9b2cf7bb":"markdown","ddf0bb8b":"markdown"},"source":{"6869bc5c":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import MinMaxScaler,StandardScaler\nfrom sklearn.metrics import *\nfrom scipy.stats import skew\nfrom tqdm import tqdm\nfrom sklearn.model_selection import *\nfrom sklearn.decomposition import PCA\nfrom sklearn.ensemble import *\nfrom sklearn.ensemble import AdaBoostRegressor,GradientBoostingRegressor\nfrom lightgbm import LGBMRegressor\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.svm import SVR","963f0759":"train_df=pd.read_csv('\/kaggle\/input\/tabular-playground-series-jan-2021\/train.csv')\ntest_df=pd.read_csv('\/kaggle\/input\/tabular-playground-series-jan-2021\/test.csv')\nsample_sub=pd.read_csv('\/kaggle\/input\/tabular-playground-series-jan-2021\/sample_submission.csv')","e6b7ef72":"train_df.head(10)","5dc68ba0":"print('Dataframe shape: ',train_df.shape)","8710e23d":"train_df.describe()","9d11808d":"#Drop Unnecessary feature 'id'\ntrain_df.drop('id',axis=1,inplace=True)\n\n#Get column names\ncolumns=train_df.drop('target',axis=1).columns\nprint('Number of columns: ',len(columns))","185bd525":"row,cols=4,4\nfig=plt.figure(figsize=(18,18))\nfor i in range(1,row*cols+1):\n    if i>14:\n        break\n    fig.add_subplot(row,cols,i)\n    plt.hist(train_df[columns[i-1]],bins=55)\n    plt.title(columns[i-1])","28e357b9":"row,cols=4,4\nfig=plt.figure(figsize=(18,18))\nfor i in range(1,row*cols+1):\n    if i>14:\n        break\n    fig.add_subplot(row,cols,i)\n    plt.boxplot(train_df[columns[i-1]])\n    plt.title(columns[i-1])","e2fd5ea2":"sns.distplot(np.sqrt(train_df['target']))","7a09d8dc":"plt.figure(figsize=(11,11))\ncorrMat=train_df.corr()\nsns.heatmap(corrMat,linewidths=0.8,annot=True)\nplt.show()","42f0c892":"ss=StandardScaler()\n","f5d89764":"train_df,val_df=train_test_split(train_df,test_size=0.2)\nX_train,y_train=train_df.drop('target',axis=1),train_df['target'].values\nX_val,y_val=val_df.drop('target',axis=1),val_df['target'].values\nprint('Training Shape: ',train_df.shape)\nprint('Validation Shape: ',val_df.shape)","2b7eaa8b":"X_train=ss.fit_transform(X_train)\nX_val=ss.transform(X_val)","8c13d7a6":"#Linear Regression\nlgb=LGBMRegressor(learning_rate=0.1,num_leaves=250,max_depth=10,\n                  min_child_samples=500)\n                 \nlgb.fit(X_train,y_train)\nprint('Validation RMSE: ')\nnp.sqrt(mean_squared_error(y_val,lgb.predict(X_val)))","a8cf371b":"#Kfold on complete dataset\n\ntrain_df=pd.read_csv('\/kaggle\/input\/tabular-playground-series-jan-2021\/train.csv')\nX_train,y_train=train_df.drop(['id','target'],axis=1).values,train_df['target'].values\ny_train=y_train\n\nkf=KFold(n_splits=5)\nfold=0\nfor train_ix,test_ix in kf.split(X_train,y_train):\n    fold+=1\n    x_train_,y_train_=X_train[train_ix],y_train[train_ix]\n    x_val_,y_val_=X_train[test_ix],y_train[test_ix]  \n    \n    x_train_=ss.fit_transform(x_train_)\n    x_val_=ss.transform(x_val_)\n    \n    lgb.fit(x_train_,y_train_)\n    train_score=np.sqrt(mean_squared_error(y_train_,lgb.predict(x_train_)))\n    val_score=np.sqrt(mean_squared_error(y_val_,lgb.predict(x_val_)))\n    print('Fold {} Train Score: {:.3f} Val Score: {:.3f}'.format(fold,train_score,val_score))","649628c4":"#Test Data\ntest_data=ss.transform(test_df.drop('id',axis=1))\npredictions=lgb.predict(test_data)\n\nsample_sub['target']=predictions\nsample_sub.to_csv('submission.csv',index=False)","bad5b7bc":"**Plotting**\n>Distribution plot","9b2cf7bb":">Plot to check outliers\n\n","ddf0bb8b":">Correlation Matrix"}}