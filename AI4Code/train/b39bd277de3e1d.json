{"cell_type":{"819cbdf1":"code","b08e72f6":"code","e20ad41d":"code","405b64c9":"code","dc5eba08":"code","3a86b71d":"code","3f9fe655":"code","b9ec6b33":"code","058ade9d":"code","85169bf5":"code","23b5ad7d":"code","9f9bfb84":"code","a66a7974":"code","68212f55":"code","2ba7c01c":"code","0fb441ec":"code","f21d90bb":"code","7f035e70":"code","651bfd2b":"code","1b260ec1":"code","7061de8c":"code","140efe2b":"code","d479370e":"code","c1d8e84f":"code","14b4cc9e":"code","b0599977":"code","496bdb7b":"code","258eed44":"code","2c897590":"code","d5e932c9":"code","aaae5969":"code","41d7556e":"code","65caa824":"code","907e3324":"code","dca230c2":"code","6fdbe87f":"code","b5fc99f5":"code","7bf97f6d":"code","973f4a80":"code","fd41571f":"code","9593937a":"code","e0068fff":"code","186571fe":"code","9fbf37d2":"code","7590b082":"code","9009f51f":"code","c8569e9c":"code","f0240fcd":"code","19dc6c42":"code","1a3ddbf1":"code","a974cafe":"code","308f1215":"code","c87ce551":"code","90f33bab":"markdown","66db0bef":"markdown","914b6b5c":"markdown","fb450f18":"markdown","bf5b472e":"markdown","ce8a9208":"markdown","d8184795":"markdown","57cd7576":"markdown","ce600cb0":"markdown","a4722191":"markdown","6424f6a4":"markdown","d33819d9":"markdown","dc546a9c":"markdown","c684ae18":"markdown","26b47767":"markdown","364c5291":"markdown","608badef":"markdown"},"source":{"819cbdf1":"import pandas as pd","b08e72f6":"# import text data\nimport pandas as pd \n\n\ndf_browsingBehavior = pd.read_csv('..\/input\/purchaseprediction\/Problem2_Site_BrowingBehavior.txt', delimiter = \"\\t\",names=['Timestamp', 'Userid', 'Website_section_visited'])\n\n","e20ad41d":"df_browsingBehavior.shape","405b64c9":"df_browsingBehavior.info()","dc5eba08":"#adding column name to the respective columns\ndf_browsingBehavior['isGuestUser'] = df_browsingBehavior['Userid'].apply(lambda x: x<=0 )\n\ndf_browsingBehavior.head()","3a86b71d":"df_time = df_browsingBehavior.copy()","3f9fe655":"df_time['TimeOfDay'] = df_time['Timestamp'].apply(lambda x:str(x)[11:16])","b9ec6b33":"\ndf_timeAnalysis= df_time.groupby('TimeOfDay')['Timestamp'].count().reset_index().rename(columns={'Timestamp': 'userCount'})\n\ndf_timeAnalysis= df_timeAnalysis.sort_values(\"TimeOfDay\")\ndf_timeAnalysis.plot(x='TimeOfDay',y='userCount',figsize=(16,5))\n","058ade9d":"for k in df_time['Website_section_visited'].unique():\n    df_prodTimeAnalysis= df_time[df_time['Website_section_visited']==k].groupby('TimeOfDay')['Timestamp'].count().reset_index().rename(columns={'Timestamp': 'userCount'})\n    df_prodTimeAnalysis.plot(x='TimeOfDay',y='userCount',figsize=(16,5),title =k )\n\n","85169bf5":"#peak hour mein prodtuct analysis\n#peak product ka hours analysis\n# peak hrs analysis","23b5ad7d":"df_guestAnalysis= df_browsingBehavior.groupby('isGuestUser')['Timestamp'].count().reset_index().rename(columns={'Timestamp': 'userCount'})\n\ndf_guestAnalysis['percentile']= df_guestAnalysis['userCount'].apply(lambda x:x\/len(df_browsingBehavior)*100)\n\ndf_guestAnalysis.head()\n\n\n\n","9f9bfb84":"import matplotlib.pyplot as plt\n\n# check how many guest users are on which product\n\ndf_prodAnalysis= df_browsingBehavior[df_browsingBehavior['isGuestUser']==True].groupby('Website_section_visited')['Timestamp'].count().reset_index().rename(columns={'Timestamp': 'userCount'})\ndf_prodAnalysis['percentile']= df_prodAnalysis['userCount'].apply(lambda x:x\/len(df_browsingBehavior)*100)\n\ndf_prodAnalysis = df_prodAnalysis.sort_values(\"userCount\",ascending=False)\n# df_prodAnalysis.plot(ax=axes[0,0])\ndf_prodAnalysis.plot.bar(x=\"Website_section_visited\", y=\"userCount\", rot=90, title=\"Number of guest user visits- to websiteSection\",figsize=(16,5));\n\n\nprint(df_prodAnalysis)","a66a7974":"# check how many other users are on which product\ndf_prodAnalysis= df_browsingBehavior[df_browsingBehavior['isGuestUser']==False].groupby('Website_section_visited')['Timestamp'].count().reset_index().rename(columns={'Timestamp': 'userCount'})\ndf_prodAnalysis['percentile']= df_prodAnalysis['userCount'].apply(lambda x:x\/len(df_browsingBehavior)*100)\n\ndf_prodAnalysis = df_prodAnalysis.sort_values(\"userCount\",ascending=False)\n# df_prodAnalysis.plot(ax=axes[0,1])\ndf_prodAnalysis.plot.bar(x=\"Website_section_visited\", y=\"userCount\", rot=90, title=\"Number of other user visits- to websiteSection\",figsize=(16,5));\n\nprint(df_prodAnalysis)","68212f55":"# import text data\nimport pandas as pd \n\n\ndf_finalCOnversion = pd.read_csv('..\/input\/purchaseprediction\/Problem2_FInalConversions.txt', delimiter = \"\\t\")\n\n#adding column name to the respective columns\n# df_browsingBehavior.columns =['Timestamp', 'Userid', 'Website_section_visited']\n","2ba7c01c":"df_finalCOnversion.shape","0fb441ec":"#if dtype of column date Date is not datetime\n\n\ndef getuniqueDatesInDataset(df,columnName):\n    df['Date'] = pd.to_datetime(df[columnName])    \n    #print(df.Date.dt.strftime('%d-%m-%y').unique())\n    return df.Date.dt.date.unique()\n    \n","f21d90bb":"# Observation: data is only of july month of date 26th\n\ngetuniqueDatesInDataset(df_browsingBehavior,'Timestamp')","7f035e70":"\n# getuniqueDatesInDataset(df_finalCOnversion,'Timestamp')","651bfd2b":"df_browsingBehavior.groupby('Userid')['Website_section_visited'].value_counts()\n\n","1b260ec1":"    df_browsingBehavior[df_browsingBehavior['Userid']==9174973170462435039]","7061de8c":"df_finalCOnversion.tail(40)","140efe2b":"# cleanup code\n\ndf_browsingBehavior.isnull().sum()\n\ndf_finalCOnversion.isnull().sum()\n\n# no null data found\n","d479370e":"# # Buy Probability\n\n# df_final['Buy_probability']= df_final['Total_Product_Purchased']\/df_final['No_of_times_visited']\n# df_final.head()","c1d8e84f":"# # User Rank Score\n# df_final['User_Rank_Score']= (df_final['Buy_probability']*df_final['Total_cart_value'])\n# df_final.head()","14b4cc9e":"import pandas as pd\n\ndf_finalCOnversion = pd.read_csv('..\/input\/purchaseprediction\/Problem2_FInalConversions.txt', delimiter = \"\\t\",names=['Timestamp', 'Userid', 'ProductCode','CartValue'])\n\ndf_finalCOnversion.head()","b0599977":"\n#adding column name to the respective columns\ndf_finalCOnversion['isGuestUser'] = df_finalCOnversion['Userid'].apply(lambda x: x<=0 )\n\ndf_finalCOnversion.tail()\n","496bdb7b":"df_finalCOnversion.isnull().sum()","258eed44":"df_guestAnalysis= df_finalCOnversion.groupby('isGuestUser')['Timestamp'].count().reset_index().rename(columns={'Timestamp': 'userCount'})\n\ndf_guestAnalysis['percentile']= df_guestAnalysis['userCount'].apply(lambda x:x\/len(df_finalCOnversion)*100)\n\ndf_guestAnalysis.head()\n\ndf_guestAnalysis.plot.bar(x=\"isGuestUser\", y=\"percentile\", rot=90, title=\"Number of guest user purchased product\",figsize=(5,5));\n\n\ndf_guestAnalysis.head()","2c897590":"df_time = df_finalCOnversion.copy()\n\ndf_time['TimeOfDay'] = df_time['Timestamp'].apply(lambda x:str(x)[11:16])\n\ndf_time","d5e932c9":"df_prodAnalysis_final= df_finalCOnversion[df_finalCOnversion['isGuestUser']==True].groupby('ProductCode')['Timestamp'].count().reset_index().rename(columns={'Timestamp': 'userCount'})\ndf_prodAnalysis_final['percentile']= df_prodAnalysis_final['userCount'].apply(lambda x:x\/len(df_finalCOnversion)*100)\n\n","aaae5969":"df_prodAnalysis_final = df_prodAnalysis_final.sort_values(\"userCount\",ascending=False)\ndf_prodAnalysis_final","41d7556e":"df_prodAnalysis_final= df_finalCOnversion[df_finalCOnversion['isGuestUser']==False].groupby('ProductCode')['Timestamp'].count().reset_index().rename(columns={'Timestamp': 'userCount'})\ndf_prodAnalysis_final['percentile']= df_prodAnalysis_final['userCount'].apply(lambda x:x\/len(df_finalCOnversion)*100)\n\ndf_prodAnalysis_final = df_prodAnalysis_final.sort_values(\"userCount\",ascending=False)\ndf_prodAnalysis_final","65caa824":"# overall highest sold product\ndf_prodAnalysis_final= df_finalCOnversion.groupby('ProductCode')['Timestamp'].count().reset_index().rename(columns={'Timestamp': 'userCount'})\ndf_prodAnalysis_final['percentile']= df_prodAnalysis_final['userCount'].apply(lambda x:x\/len(df_finalCOnversion)*100)\n\ndf_prodAnalysis_final = df_prodAnalysis_final.sort_values(\"userCount\",ascending=False)\ndf_prodAnalysis_final","907e3324":"df_topProduct =df_prodAnalysis_final.iloc[:5]","dca230c2":"df_topProduct","6fdbe87f":"df_topProduct.plot.bar(x=\"ProductCode\", y=\"userCount\", rot=90, title=\"Top 5 products sale\",figsize=(16,5));\n\nprint(df_topProduct)","b5fc99f5":"df_BottomProduct =df_prodAnalysis_final.iloc[-5:]\n\ndf_BottomProduct.plot.bar(x=\"ProductCode\", y=\"userCount\", rot=90, title=\"Bottom 5 products sale\",figsize=(16,5));\n\nprint(df_BottomProduct)","7bf97f6d":"#df_merge= pd.merge(df_browsingBehaviour,df_conversion,on='Userid',how='inner')\n\n#print(\"shape after merge:\",df_merge.shape)","973f4a80":"print(df_browsingBehavior.shape)\nprint(df_browsingBehavior.head())\ndf_Model_Data = pd.get_dummies(df_browsingBehavior['Website_section_visited'])\n\ndf_Model_Data","fd41571f":"\ndf = pd.get_dummies(df_browsingBehavior, columns=['Website_section_visited'])\ndf\n                    ","9593937a":"df = df.groupby('Userid').sum().reset_index()\n","e0068fff":"df = df.drop(columns=['isGuestUser'])\n\n","186571fe":"df","9fbf37d2":"df_finalCOnversion= df_finalCOnversion.groupby('Userid').sum().reset_index()\n\ndf_finalCOnversion\n\ndf_finalCOnversion = df_finalCOnversion.drop(columns=['isGuestUser'])\n\n","7590b082":"\ndf_final= pd.merge(df_finalCOnversion, df,on='Userid',how='right')\n\ndf_final= df_final.fillna(0)\n\ndf_final['isPurchased'] = df_final['CartValue'].apply(lambda x : 1 if x>0 else 0)\n\ndf_final.shape\n\n","9009f51f":"df_browsingBehavior = df_browsingBehavior.drop(columns=['isGuestUser'])\n\nprint(df_finalCOnversion.head())\ndf_browsingBehavior.head()","c8569e9c":"# df_finalCOnversion = df_finalCOnversion.groupby('Userid').sum().reset_index()\n# df_browsingBehavior = df_browsingBehavior.groupby('Userid').sum().reset_index()\n\nprint(\"df_finalCOnversion shape\",df_finalCOnversion.shape)\n\nprint(\"df_browsingBehavior shape\",df_browsingBehavior.shape)\n\ndf_final_WithoutDummy= pd.merge(df_finalCOnversion,df_browsingBehavior,on='Userid',how='right')\n\n# df_final= pd.merge(df_finalCOnversion, df,on='Userid',how='right')","f0240fcd":" df_browsingBehavior = df_browsingBehavior.groupby('Userid').sum().reset_index()\nprint(\"df_browsingBehavior shape\",df_browsingBehavior.shape)","19dc6c42":"print(\"df_final_WithoutDummy \", df_final_WithoutDummy.shape)","1a3ddbf1":"\ndf_final_WithoutDummy.head()\n\n# df_final[(df_final['isPurchased']==1)]\n\n# for c in df_final.columns:\n        \n#          if c not in ['Userid','isPurchased']:\n#             df_final.loc[0,c]=int(df_final.loc[0,c])\/1407879\n        \n    \n    \n\n\n","a974cafe":"\n\ndf2= df_final[df_final['isPurchased']==True].groupby('Userid')['Timestamp'].count().reset_index().rename(columns={'Timestamp': 'userCount'})\n\nprint(df2.head())","308f1215":"print(df_merged.shape)\ndf_merged.head()\n      ","c87ce551":"df_merged.shape","90f33bab":"# let's check that how many users were on same time","66db0bef":"# How many users were active on which time","914b6b5c":"# Observation Overall- \n## Peak hours 1 to 2 AM when highest no of users has visited the website most.\n","fb450f18":"# Website section Visit Analysis by User","bf5b472e":"# Guest user Analysis","ce8a9208":"# Bottom 5 product sale","d8184795":"# Productwise time analysis\n##  Peak hour where many people stay on 'product section' is  1 to 2 ","57cd7576":"# Visit the probability of purchase based on no of time visited on section using binary classification algo","ce600cb0":"### No of Guest user Visited the website section in percentage ","a4722191":"# Analysis on Problem2_FInalConversions ","6424f6a4":"# Top 5 product sale","d33819d9":"# Obserservation- \n### Product section is mostly visited by users","dc546a9c":"# Analyze the Data according to User and Make Probabilities as Total Product Purchased by Number of times visited.\n","c684ae18":"### No of other than Guest user Visited the website section in percentage ","26b47767":"# Problem: \n## The client is an online ecommerce player. They have shared a user level log data for their browsing behavior (Timestamp, UserId and website section visited). You have been provided with the final conversion data too (Timestamp, UserID, Products Purchased in the transaction, Overall Cart Value).\n\n\n\n# Task: \n## Based on this data you are required to build features and model on these characteristics of users to calculate a score\/rank for conversion probability of that user. These scores will eventually decide the bidding logic used for each user. Your model will be evaluated on these criteria: - \n### a. Feature Engineering (Variable Imputation)\n### b. Model Selection Criteria (Basis of choosing the final Technique)\n### c. Measurement Criteria (Comparison of Various Models)\n### d. Scope for improvement\n\n# Expected Outputs:-\n### 1. The Final code (Python or R) along with proper comments\n## 2. A summary file (PDF format) stating :\n    ## a. Problem Statement\n    ## b. Approach Taken\n    ## c. Interpretation of Results\n            #d. Minimal but effective Storyboarding - Consider the final audience of this will be the Business team. You  need to bring the actionable insights in this section.\n    \n\n# How to Access the Data: \n### Please use the below drive link to download the zip file. After Extracting, Kindly\n### convert the file to Comma Separated File by renaming to (.csv) at the end.\n### https:\/\/drive.google.com\/file\/d\/1TIAgMkjbyDzi3siVCVixIXPVyeyAsWyZ\/view?usp=sharing\n# Hints:\n    1.) Import the data in your System using the parameter delimiter='\\t' in Pandas.\n    2.) Mention the Column Name after importing the data i.e.\n    ['Timestamp', 'UserID','Website_section_visited']\n    3.) Analyze the Data according to User and Make Probabilities as Total Product Purchased by\n    Number of times visited.\n    4.) Target Variable will be created by Product of Probabilities and Cart Value.\n    Evaluation: The project will be evaluated based on requirements and instructions provided above. ","364c5291":"# Most time spent on which product","608badef":"# Feature enginering \n\n### We have introduced guest user by analysisig userid"}}