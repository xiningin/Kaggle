{"cell_type":{"a5ce562a":"code","4e35c89c":"code","2fc2bcb9":"code","889b6649":"code","c8615866":"code","82840d21":"code","43195391":"code","2dcbc731":"code","79313e2b":"code","20bb84eb":"code","7c979854":"code","356ea6ad":"code","4718e119":"code","3c5fa5aa":"code","7f163a58":"code","b0057cd6":"code","8c592042":"code","b088298e":"code","7f9b8ec1":"code","86541442":"code","1ba9f043":"code","f0f682e6":"markdown","d6dba07d":"markdown","1c55a376":"markdown","a7324440":"markdown","7043be97":"markdown","8e1bdfcf":"markdown","64ad48a4":"markdown","c969fd9c":"markdown","2a84d034":"markdown","f2aca470":"markdown","3291c3d3":"markdown","89a98722":"markdown","540e4666":"markdown"},"source":{"a5ce562a":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\ndf = pd.read_csv(\"..\/input\/2018_03.csv\")\nfor i in range(4,10):\n    df = df.append(pd.read_csv(\"..\/input\/2018_0\"+str(i)+\".csv\"))\ndf.head()","4e35c89c":"df = df[df['type'] == 'NJ Transit']\ndf.head()","2fc2bcb9":"df.isnull().sum()","889b6649":"df[df.isnull().any(axis=1)].head()","c8615866":"df = df.dropna()\ndf.describe()","82840d21":"df.describe(exclude=[np.number])","43195391":"sns.distplot(df['delay_minutes'])","2dcbc731":"sns.countplot(df['status'])","79313e2b":"df[df['status'] == 'cancelled'].head()","20bb84eb":"df['long_delay'] = df['delay_minutes'] > 5\ndf.groupby('line')['long_delay'].mean().sort_values(ascending=False).plot(kind='bar')","7c979854":"x = df.groupby(['line', 'status']).size().unstack()\nx['cancelled']\/(x['departed']+x['estimated'])","356ea6ad":"x['cancelled']","4718e119":"ax = df.groupby('stop_sequence')[\"delay_minutes\"].mean().plot()\nax.set_ylabel(\"average delay_minutes\")","3c5fa5aa":"df.groupby('from')['delay_minutes'].mean().sort_values(ascending=False).head(10)","7f163a58":"df.groupby('to')['delay_minutes'].mean().sort_values(ascending=False).head(10)","b0057cd6":"df.date = pd.to_datetime(df.date)\nx = df.groupby('date')['delay_minutes'].mean()\nfig, ax = plt.subplots()\nfig.set_size_inches(20,8)\nfig.autofmt_xdate()\nax.plot(x)\nax.set_ylabel('average delay_minutes')\nplt.show()","8c592042":"df.scheduled_time = pd.to_datetime(df.scheduled_time)\ndf['time'] = df.scheduled_time.dt.time\n\nfig, ax = plt.subplots()\nfig.set_size_inches(20,8)\nx = df.groupby('time')['delay_minutes'].mean()\nax.plot(x)\nax.set_ylabel('average delay_minutes')\nplt.show()","b088298e":"x.sort_values(ascending=False).head(5)","7f9b8ec1":"x = df.groupby(['date', 'status']).size().unstack()\nx = (x['cancelled']\/(x['departed']+x['estimated']))\n\nfig, ax = plt.subplots()\nfig.set_size_inches(20,8)\nax.plot(x)\nax.set_ylabel('cancellation rate')\nplt.show()","86541442":"x.sort_values(ascending=False).head(5)","1ba9f043":"x = df.groupby(['time', 'status']).size().unstack()\nx = (x['cancelled']\/(x['departed']+x['estimated']))\n\nfig, ax = plt.subplots()\nfig.set_size_inches(20,8)\nax.plot(x)\nax.set_ylabel('cancellation rate')\nplt.show()","f0f682e6":"Peak delays seem to be at around ~3:00am. ","d6dba07d":"First we need to isolate only NJ Transit trips. (Amtrak schedules are not contained in the dataset).","1c55a376":"We'll drop these missing values.","a7324440":"## When are these delays and cancellations happening?\n\nNow, I'll compare date and time with delays and cancellations","7043be97":"Next, we will check for missing values.","8e1bdfcf":"## Where are these large delays and cancellations happening?\n\nLet's look at lines, stops, origins, and destinations to see if there is any relationship with delays or cancellations","64ad48a4":"In 7 of the 11 lines,  at least 20% of trips have long delays","c969fd9c":"Let's visualize the data","2a84d034":"[A powerful storm hit New Jersey Transit](https:\/\/www.njtransit.com\/sa\/sa_servlet.srv?hdnPageAction=CustomerNoticeTo&NoticeId=2525) on March 8th which explains the extremely high cancellation rate on that day.\n![](http:\/\/www.njtransit.com\/%20\/images-uploads\/march%207%20storm.jpg)","f2aca470":"The cancel rate seems to be low for all trips. The Princeton Shuttle, unsurprisngly, has no cancellations.","3291c3d3":"As shown in the summary and the chart there are some outliers with very large delays.","89a98722":"There seems to be a slight relationship with delays increasing the further along the stop sequence.","540e4666":"Lindenworld, Aberdeen-Matawan, Tuxedo, and Cherry Hill show up in both top 10 origins and destinations for longest delay so they may be worth investigating."}}