{"cell_type":{"7ace3f1f":"code","15eb100c":"code","22aae45f":"code","964844ac":"code","e15e609e":"code","59d588ed":"code","2e8f6a12":"code","2a8487d2":"code","5fb5970a":"code","65803d4e":"code","9813db01":"code","085bbe8a":"code","60706a35":"code","f7ac8b85":"code","65cd80ad":"code","078e7da8":"code","4e18dfcd":"code","1d6c17b4":"code","00c153bb":"code","fd8d40a6":"markdown","192339ba":"markdown","4f0759a8":"markdown","84f15611":"markdown","f667ba45":"markdown","5edd6fac":"markdown","419b418d":"markdown","7e41ebbf":"markdown","d6733f10":"markdown","4282ed88":"markdown","1048b554":"markdown","e2792e6e":"markdown","607453bb":"markdown","d77eb437":"markdown","9b0ac38d":"markdown","2f4c9b64":"markdown","0526ce83":"markdown","69f0cf7a":"markdown","63fd16c4":"markdown","fe69367d":"markdown","0771c95b":"markdown"},"source":{"7ace3f1f":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom matplotlib.ticker import StrMethodFormatter\nimport matplotlib.ticker as ticker","15eb100c":"police_deaths = pd.read_csv(\"..\/input\/police-violence-in-the-us\/police_deaths_538.csv\")\npolice_deaths.head()","22aae45f":"new = police_deaths['eow'].str.split(\" \", n = 4, expand = True) \npolice_deaths['weekday'] = new[1].str.replace(',', '')\ncolors =  [\"green\",'red', 'gold', 'orange', 'pink', 'lightcoral', 'lightskyblue']\ncats = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']\npolice_deaths_wk = (police_deaths.groupby(['weekday']).count())\npolice_deaths_wk = police_deaths_wk['person']\npolice_deaths_wk = police_deaths_wk.reset_index()\npolice_deaths_wk['weekday'] = pd.Categorical(police_deaths_wk['weekday'], categories=cats, ordered=True)\npolice_deaths_wk = police_deaths_wk.sort_values('weekday')\npolice_deaths_wk.set_index('weekday',inplace = True)\npolice_deaths_wk.rename(columns = {\"person\" : \"\"} , inplace=True)\npolice_deaths_wk.plot.pie(figsize=(8,7),\n                          shadow=False,\n                          colors=colors,\n                          explode=(0, 0, 0, 0, 0.05, 0.09, 0.05),\n                          startangle=90,\n                          subplots=True,\n                          legend=False,\n                          autopct='%1.2f%%')\nplt.title(\"% Day of the week on which Police Officers were killed 1796-2016\")\nplt.axis('equal')\nplt.tight_layout()\nplt.show()","964844ac":"ax = pd.pivot_table(police_deaths, index='cause_short', values=['cause'], aggfunc=\"count\").sort_values(\n    \"cause\", axis = 0, ascending = True).plot.barh(figsize=(12,14),color='lightskyblue', width=0.85, xlim=[0, 12500], legend=False)\nax.spines['right'].set_visible(False)\nax.spines['top'].set_visible(False)\nax.spines['left'].set_visible(False)\nax.spines['bottom'].set_visible(False)\nax.xaxis.set_major_locator(ticker.MultipleLocator(750))\n\nvals = ax.get_xticks()\nfor tick in vals:\n    ax.axvline( x =tick, linestyle='dotted', alpha=0.6, color='red', zorder=2)\n\n    \nax.set_xlabel(\"Number of deaths\", labelpad=25, size=16)\nax.set_ylabel(\"Cause\", labelpad=25, size=16)\nax.set_title(\"Causes of Police Officer Death 1791 - 2016 \", size=18)\nax.xaxis.set_major_formatter(StrMethodFormatter('{x:,g}'))\ntotals = []\ntotal = sum(totals)\n\n# set individual bar lables using above list\nfor i in ax.patches:\n    # get_width pulls left or right; get_y pushes up or down\n    ax.text(i.get_width()+.3, i.get_y()+.40, str(round((i.get_width()))),fontsize=10,\ncolor='dimgrey')","e15e609e":"police_deaths_by_state = pd.pivot_table(police_deaths,index='state', values=['cause'], columns = ['cause_short'], aggfunc=\"count\").fillna(value=0)\npolice_deaths_by_state.columns = police_deaths_by_state.columns.droplevel()\npolice_deaths_by_state.loc[:,'Total'] = police_deaths_by_state.sum(axis=1)\npolice_deaths_by_state.sort_values(\"Total\", axis = 0, ascending = True, inplace=True)\npolice_deaths_by_state\npolice_deaths_by_state.drop(['Total'], axis = 1).head()\n#the below it is to make the visualization a bit more clear, \nmin_number_per_cat = 100\npolice_deaths_by_state = police_deaths_by_state.loc[: ,police_deaths_by_state.sum(axis=0) >= min_number_per_cat]\npolice_deaths_by_state.head()\n\n\ncolors = plt.cm.tab20c(np.linspace(0, 1, 15))\nax1 = police_deaths_by_state.drop(['Total'], axis = 1).plot.barh(figsize=(12,16),stacked=True, width=0.80,color=colors )\n\nax1.spines['right'].set_visible(False)\nax1.spines['top'].set_visible(False)\n\nax1.set_xlabel(\"Number Police Officer Death \", labelpad=20, weight='bold',size=14)\nax1.set_ylabel(\"States\", labelpad=20, weight='bold', size=14)\nax1.set_title(\"Causes of Police Officer Death 1791 - 2016 \", size=18)\nax1.xaxis.set_major_formatter(StrMethodFormatter('{x:,g}'))\n\n","59d588ed":"ax = pd.pivot_table(police_deaths,index=['year'],values = ['cause_short'], aggfunc=\"count\").nlargest(15,'cause_short').reset_index()\nax.rename(columns = {\"cause_short\" : \"People Killed\"} , inplace=True)\nax.plot.bar(x='year', figsize=(8,6),rot=0, legend = False, color='Red')\nplt.xlabel(\"Year\", labelpad=20, weight='bold',size=14)\nplt.ylabel(\"People Killed\", labelpad=20, weight='bold',size=14)\nplt.title(\"Top 15 Year\")","2e8f6a12":"fatal_encounters= pd.read_csv(\"..\/input\/police-violence-in-the-us\/fatal_encounters_dot_org.csv\")\n#fatal_encounters_dot_org.info()\n#fatal_encounters.head()","2a8487d2":"fatal_encounters = fatal_encounters.iloc[:,[0,2,1,3,4,5,8,10,11,15,16,18,19,22,27]]\nfatal_encounters.head()","5fb5970a":"Death_Police_per_year =  pd.pivot_table(police_deaths.rename(columns = {\"year\" : \"Year\"}),index=['Year'],values = ['cause_short'], aggfunc=\"count\")\nDeath_Police_per_year.rename(columns = {\"cause_short\" : \"Police Officer killed\"} , inplace=True)\nDeath_People_per_Year = pd.pivot_table(fatal_encounters.rename(columns = {\"Date (Year)\" : \"Year\"} ),index=['Year'],values = ['Unique ID'],aggfunc=\"count\").fillna(value=0)\nDeath_People_per_Year = Death_People_per_Year.iloc[2:]\nDeath_People_per_Year.rename(columns = {\"Unique ID\" : \"People killed\"} , inplace=True)\nDeath_People_per_Year = Death_People_per_Year.reset_index()\nDeath_Police_per_year = Death_Police_per_year.reset_index()\nDeath_People_per_Year['Year'] = pd.to_numeric(Death_People_per_Year['Year'])\nKilled = Death_People_per_Year.merge(Death_Police_per_year, left_on='Year', right_on='Year')\nx = Killed['Year']\nKilled.plot(x='Year', figsize=(12,6) )\nplt.legend(loc='best')\nplt.title(\"People Deaths vs Police Officer Deaths 2000-2016\")\nplt.xlabel(\"Year\")\nplt.xticks(np.arange(min(x), max(x)+1, 1.0))\nplt.ylabel(\"Deaths\")\n","65803d4e":"#police_deaths_by_state = pd.pivot_table(police_deaths,index='state', values=['cause'], columns = ['cause_short'], aggfunc=\"count\").fillna(value=0)\nfatal_encounters_pv = pd.pivot_table(fatal_encounters,index=['Location of death (state)'],values = ['Unique ID'],columns = ['Cause of death'], aggfunc=\"count\").fillna(value=0)\nfatal_encounters_pv.columns = fatal_encounters_pv.columns.droplevel()\nfatal_encounters_pv.loc[:,'Total'] = fatal_encounters_pv.sum(axis=1)\nfatal_encounters_pv.sort_values(\"Total\", axis = 0, ascending = True, inplace=True)\ncolors2 = plt.cm.nipy_spectral(np.linspace(0, 1, 15))\nax2 = fatal_encounters_pv.drop(['Total'], axis = 1).plot.barh(figsize=(12,16),stacked=True, width=0.80,color=colors2 )\nax2.set_xlabel(\"Number People Killed\", labelpad=20, weight='bold',size=14)\nax2.set_ylabel(\"States\", labelpad=20, weight='bold', size=14)\nax2.set_title(\"Causes of People Death per State 2000-2016 \", size=20)\n#fatal_encounters_pv.head()","9813db01":"from wordcloud import WordCloud, STOPWORDS, ImageColorGenerator\nfatal_encounters.rename(columns = {\"Location of death (city)\" : \"Location\"} , inplace=True)\ntext_list = []\nfor i in range(len(fatal_encounters['Location'])):\n    text_list.append(str(fatal_encounters['Location'][i]))\n\nfrom collections import Counter\nword_could_dict=Counter(text_list)\n\nwordcloud = WordCloud(\n    width = 2000,\n    height = 1000,\n    background_color = 'black',max_words=20).generate_from_frequencies(word_could_dict)\nfig = plt.figure(\n    figsize = (30, 20),\n    facecolor = 'k',\n    edgecolor = 'k')\nplt.imshow(wordcloud, interpolation = 'bilinear')\nplt.axis('off')\nplt.tight_layout(pad=0)\nplt.show()","085bbe8a":"ax = fatal_encounters[\"Subject's age\"].value_counts().nlargest(15).plot(\n    kind='barh', title ='Top 10 most frequent ages of killed people', grid= False);\nax.invert_yaxis()\nax.set_xlabel(\"Number People Killed\", labelpad=10,size=14)\nax.set_ylabel(\"Age\", labelpad=20, size=14)\n\ntotals = []\n\n# find the values and append to list\nfor i in ax.patches:\n    totals.append(i.get_width())\n\n# set individual bar lables using above list\ntotal = sum(totals)\n\n# set individual bar lables using above list\nfor i in ax.patches:\n    # get_width pulls left or right; get_y pushes up or down\n    ax.text(i.get_width()+.3, i.get_y()+.40, str(round((i.get_width()))),fontsize=10,\ncolor='dimgrey')\n","60706a35":"fatal_encounters.rename(columns = {\"Subject's race\" : \"Race\"} , inplace=True)\nfatal_encounters[\"Race\"] = np.where(fatal_encounters[\"Race\"]=='HIspanic\/Latino', 'Hispanic\/Latino',fatal_encounters[\"Race\"])\nfatal_encounters[\"Race\"].loc[fatal_encounters[\"Race\"] == \"Asian\/Pacific Islander\"] = 'Asian'\nfatal_encounters[\"Race\"].loc[fatal_encounters[\"Race\"] == \"African-American\/Black\"] = 'African-American'\nfatal_encounters[\"Race\"].loc[fatal_encounters[\"Race\"] == \"European-American\/White\"] = 'European-American'\nfatal_encounters[\"Race\"].loc[fatal_encounters[\"Race\"] == \"Hispanic\/Latino\"] = 'Hispanic\/Latino'\nfatal_encounters[\"Race\"].loc[fatal_encounters[\"Race\"] == \"Native American\/Alaskan\"] = 'Native-American'\nfatal_encounters[\"Race\"].loc[fatal_encounters[\"Race\"] == \"Race unspecified\"] = 'Unspecified'\nrace = pd.pivot_table(fatal_encounters,index=[\"Race\"],columns = [\"Cause of death\"],values = [\"Subject's name\"] , aggfunc = \"count\").fillna(value=0)\nrace.columns = [f'{j}' for i, j in race.columns]\nrace.head()","f7ac8b85":"fig = race.plot(figsize=(14,11),kind='bar', stacked=True)\nplt.legend(loc = 'best', fontsize=9.5)\nplt.xticks(rotation=90, fontsize=20)\nfig.set_xticklabels(fig.get_xticklabels(),rotation=0, fontweight='light', fontsize=11)\nplt.xlabel(\"Race\", labelpad=10,size=14)\nplt.ylabel(\"Number of People Killed\", labelpad=20, size=14)\nplt.title(\"People Killed by Race and Causes\",weight = \"bold\", size=20)\nplt.show","65cd80ad":"shootings = pd.read_csv(\"..\/input\/police-violence-in-the-us\/shootings_wash_post.csv\")\nshootings.describe()\nd = {'W': 'White', 'B': 'Black','A': 'Asian','N': 'Native','H':'Hispanic', 'O': 'Other'}\ngend = {'M': 'Male', 'F': 'Female'}\nshootings[\"gender\"] = shootings[\"gender\"].map(gend)\nshootings[\"race\"] = shootings[\"race\"].map(d)\nshootings.isna().sum()\nshootings['armed'].fillna('No', inplace=True)\nshootings['age'].fillna(0, inplace=True)\nshootings['race'].fillna('Other', inplace=True)\nshootings['flee'].fillna('Not specified', inplace=True)\nshootings.rename(columns = {\"signs_of_mental_illness\" : \"Signs Mental illness\"} , inplace=True)\nshootings.isna().sum()\nshootings.head()","078e7da8":"text_list = []\nfor i in range(len(shootings[\"city\"])):\n    text_list.append(str(shootings[\"city\"][i]))\n\nfrom collections import Counter\nword_could_dict=Counter(text_list)\n\nwordcloud = WordCloud(\n    width = 2000,\n    height = 1000,\n    background_color = 'White',max_words=10).generate_from_frequencies(word_could_dict)\nfig = plt.figure(\n    figsize = (30, 20),\n    facecolor = 'k',\n    edgecolor = 'k')\nplt.imshow(wordcloud, interpolation = 'bilinear')\nplt.axis('off')\nplt.tight_layout(pad=0)\nplt.show()","4e18dfcd":"text_list = []\nfor i in range(len(shootings[\"armed\"])):\n    text_list.append(str(shootings[\"armed\"][i]))\n\nfrom collections import Counter\nword_could_dict=Counter(text_list)\n\nwordcloud = WordCloud(\n    width = 2000,\n    height = 1000,\n    background_color = 'white',max_words=30).generate_from_frequencies(word_could_dict)\nfig = plt.figure(\n    figsize = (30, 20),\n    facecolor = 'k',\n    edgecolor = 'k')\nplt.imshow(wordcloud, interpolation = 'bilinear')\nplt.axis('off')\nplt.tight_layout(pad=0)\nplt.show()","1d6c17b4":"from statsmodels.graphics.mosaicplot import mosaic\nfrom bokeh.transform import factor_cmap\nplt.rcParams['font.size'] = 14\nplt.rcParams[\"figure.figsize\"] = [12, 8]\nplt.rcParams[\"figure.edgecolor\"] = 'w'\nplt.rcParams['text.color'] = 'Black'\nmosaic(shootings, ['race','gender'],statistic=True,gap=0.02, axes_label = True, title='Split by Race and Gender',labelizer=lambda k: '')\nplt.show()","00c153bb":"import seaborn as sns\nshootings[\"age\"] = pd.to_numeric(shootings[\"age\"])\n#sns.catplot(x='flee', y='age', hue='gender',palette='Set1',\n#            data=shootings,jitter=0.15)\nsns.swarmplot(x='race', y='age',hue='Signs Mental illness',data=shootings, palette=[\"r\", \"b\"],split=True)\n#sns.swarmplot(x=\"day\",y=\"total_bill\",hue='sex',data=t,palette=\"Set1\", split=True)","fd8d40a6":"What are the main causes how police officers were killed?","192339ba":"Analyzing the graph for the top twenty, it seems clear that **Chicago** was the bloodiest followed by Houston and Los Angeles. Which age was the most frequent?","4f0759a8":"# What happened to the killing police officers from 1976 to 2016?","84f15611":"# What has happened in the past 5 years up to June 2020?","f667ba45":"In the top 10 of age most of the people killed were between 21 and 29. ","5edd6fac":"The people killed had a weapon as a gun mainly, but also knives or toy weapons. In many cases people were not armed or in any case no weapon was detected.","419b418d":"Texas is the state of the place where police officers were mostly killed, followed by California and New York. As can be seen from the graph, Gunfire is once again the main cause everywhere. In orange the second cause is the car accident.\nNote that part of the causes of the deaths in New York state was caused by the 9\/11 attacks.","7e41ebbf":"Making a distinction by state, it seems clear again that the main cause that led to the death of people is gunfire. This followed by killing by vehicles. At first glance it seems that the number of people killed by the use of the taser is also large.\nCalifornia, Texas and Florida appear to be the states with the most casualties. Ma quali sono state le citt\u00e0 con piu incontri fatali?","d6733f10":"The people killed were mainly males and white, followed by males and black.","4282ed88":"As you can see from the graph, not considering the people whose race has not been classified, the two main typologies of people killed are European-American and African-American. The killings resulting from the use of firearms are always the most common","1048b554":"As we have seen for the data until 2016, even in this data bounce up to 2020 Los Angeles and Houston were the bloodiest cities followed by Phoenix and Las Vegas.","e2792e6e":"From the graph it is clear that the bloodiest years for police officers were during the period from 1920 to 1934, in other words **prohibition**. Also noteworthy in 1929 was the **Great Depression** and the socio-economic effects it generated.\nIt would be interesting to know what happened in the period **'73 - '74**, but nothing comes to mind about it.","607453bb":"Analyzing the causes of the deaths of the police officers it seems that the main cause is **\"Gunshots\"**, followed by car and car accidents. Heart attack was also a major cause.\nFrom the graph, however, it seems clear that the firearm is certainly the main cause of the killings of the agents with a wide detachment from other causes.","d77eb437":"What were the 10 most dangerous cities?","9b0ac38d":"Below you can find the % of the day of the week on which police officers were killed most of the time. What are the most dangerous days in a week for a police officer?","2f4c9b64":"Comparing with the available data, it is noted that in the period from 2000 to 2016 there was an increase in the number of people killed by fatal encounters with the police. On the other hand, the number of agents killed was almost constant over time. So let's try to know a bit more about the causes.","0526ce83":"What are the main states where Police Officers were killed and which causes were most frequent?","69f0cf7a":"What was the year with the highest number of police officers killed?","63fd16c4":"# What about people killed since 2000?","fe69367d":"In many cases, people killed seem to be affected by mental illness regardless of race.","0771c95b":"From the graph there are no such big differences between the different days of the week. However, the **weekend** appears to be the most dangerous time for police officers."}}