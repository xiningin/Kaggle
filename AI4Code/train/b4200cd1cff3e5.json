{"cell_type":{"a434696b":"code","bc57d05c":"code","597cce59":"code","13614f53":"code","d8978f35":"code","c911c670":"code","4fb3e07f":"code","2841de85":"code","dba284fe":"code","3931cf6d":"code","4a4b05be":"code","fae445dd":"code","92b4e3d5":"code","c5f8a259":"code","39aa7ee8":"code","de3ee699":"code","e94d0219":"code","af109fe2":"code","3f70f137":"code","8505c0d2":"code","0fe16434":"code","4ec8ea92":"code","7d0b30a9":"code","b4cd22f2":"code","7dbbdcf2":"code","d3f551fe":"code","c0fc93ae":"code","e5aec28d":"code","20d28676":"code","1293bcf8":"code","70fe11f0":"code","3d194ff2":"code","e792edda":"code","21a37c3d":"code","6a6319cc":"code","fbe44724":"code","58a52571":"code","4b1a0a63":"code","c22c7995":"code","7dcbf918":"code","4bafd820":"markdown","90123975":"markdown","1513077a":"markdown","9f59908f":"markdown","ce980fdc":"markdown","fe8dc0dc":"markdown","42a37849":"markdown","451aaf50":"markdown","33822e87":"markdown","0daa6a7a":"markdown","c6bd2e2f":"markdown","7feb4693":"markdown","79e285a3":"markdown","9796d89c":"markdown","ea7725ba":"markdown","ab291359":"markdown","76d0ff97":"markdown","bb6027c3":"markdown","00f24d3f":"markdown","7f415d0a":"markdown","8469e61f":"markdown","eb6a9f6d":"markdown","496b74fd":"markdown","16d108c7":"markdown","f771db8d":"markdown"},"source":{"a434696b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","bc57d05c":"import seaborn as sns\nimport matplotlib.pyplot as plt\n\nimport warnings\nwarnings.filterwarnings('ignore')\nsns.set_style(\"whitegrid\")","597cce59":"train=pd.read_csv('\/kaggle\/input\/tabular-playground-series-dec-2021\/train.csv')\ntest=pd.read_csv('\/kaggle\/input\/tabular-playground-series-dec-2021\/test.csv')","13614f53":"train.drop('Id',axis=1,inplace=True)","d8978f35":"# Memory before reduction\ntrain.memory_usage().sum() \/ 1024**2","c911c670":"def reduce_mem_usage(df, verbose=True):\n    #numerics contains various dtypes related to numeric columns\n    numerics = ['int16', 'int32', 'int64', 'float16', 'float32', 'float64']\n    start_mem = df.memory_usage().sum() \/ 1024**2    \n    for col in df.columns:\n        col_type = df[col].dtypes # output for this will be something like > dtype('int64')\n        if col_type in numerics:\n            c_min = df[col].min() # stores minimum val of numeric col\n            c_max = df[col].max() # stores maximum val of numeric col\n            if str(col_type)[:3] == 'int': # str(col_type)=str(dtype('int64'))='int64' and str(dtype('int64'))[:3]='int'\n                # np.iinfo shows limits for various integer types.\n                if c_min > np.iinfo(np.int8).min and c_max < np.iinfo(np.int8).max: # np.iinfo(np.int8) returns an obj iinfo(min=-128, max=127, dtype=int8)\n                    df[col] = df[col].astype(np.int8)\n                elif c_min > np.iinfo(np.int16).min and c_max < np.iinfo(np.int16).max:\n                    df[col] = df[col].astype(np.int16)\n                elif c_min > np.iinfo(np.int32).min and c_max < np.iinfo(np.int32).max:\n                    df[col] = df[col].astype(np.int32)\n                elif c_min > np.iinfo(np.int64).min and c_max < np.iinfo(np.int64).max:\n                    df[col] = df[col].astype(np.int64)  \n            else:\n                #np.finfo shows limits for various float types.\n                if c_min > np.finfo(np.float32).min and c_max < np.finfo(np.float32).max:\n                    df[col] = df[col].astype(np.float32)\n                else:\n                    df[col] = df[col].astype(np.float64)    \n    end_mem = df.memory_usage().sum() \/ 1024**2\n    if verbose: print('Mem. usage decreased to {:5.2f} Mb ({:.1f}% reduction)'.format(end_mem, 100 * (start_mem - end_mem) \/ start_mem))\n    return df","4fb3e07f":"# Memory after reduction\ntrain=reduce_mem_usage(train)","2841de85":"plt.figure(figsize=(10,8))\nplt.title('TARGET ANALYSIS:Cover_Type')\ntrain['Cover_Type'].value_counts(normalize=True).plot.bar(color='green')\n\nplt.show()","dba284fe":"soil_types=[col for col in train.columns if col.startswith('Soil')]\nwilderness=[col for col in train.columns if col.startswith('Wilderness')]","3931cf6d":"for col in soil_types:\n    if train[col].value_counts()[0]\/len(train)*100>=90:\n        print(col,train[col].value_counts()[0]\/len(train)*100)","4a4b05be":"for col in wilderness:\n    if train[col].value_counts()[0]\/len(train)*100>=90:\n        print(col,train[col].value_counts()[0]\/len(train)*100)","fae445dd":"train['soil_type']=train[soil_types].sum(axis=1)\ntest['soil_type']=test[soil_types].sum(axis=1)","92b4e3d5":"train.groupby(['soil_type'])['Cover_Type'].agg(pd.Series.mode)","c5f8a259":"cols_drop=[]\ncols_drop=soil_types","39aa7ee8":"train['wildness']=train[wilderness].sum(axis=1)\ntest['wildness']=test[wilderness].sum(axis=1)","de3ee699":"cols_drop.extend(wilderness)","e94d0219":"plt.figure()\nfig, ax = plt.subplots(figsize=(10,8))\n\n\n\nplt.subplot(2,2,1)\nplt.title('Wildness_Train')\ntrain['wildness'].value_counts(normalize=True).plot.bar(color='red')\n\nplt.subplot(2,2,2)\nplt.title('Wildness_Test')\ntest['wildness'].value_counts(normalize=True).plot.bar()\n\nplt.show()","af109fe2":"plt.figure()\nfig, ax = plt.subplots(figsize=(10,8))\nplt.subplot(2,2,1)\nplt.title('Soil Type Train')\ntrain['soil_type'].value_counts(normalize=True).plot.bar(color='red')\n\nplt.subplot(2,2,2)\nplt.title('Soil Type Test')\ntest['soil_type'].value_counts(normalize=True).plot.bar()\n\nplt.show()","3f70f137":"train.Aspect.describe()","8505c0d2":"train[\"Aspect\"][train[\"Aspect\"] < 0] += 360\ntrain[\"Aspect\"][train[\"Aspect\"] > 359] -= 360\n\ntest[\"Aspect\"][test[\"Aspect\"] < 0] += 360\ntest[\"Aspect\"][test[\"Aspect\"] > 359] -= 360","0fe16434":"train[['Hillshade_Noon','Hillshade_9am','Hillshade_3pm']].describe()","4ec8ea92":"train.loc[train[\"Hillshade_9am\"] < 0, \"Hillshade_9am\"] = 0\ntrain.loc[train[\"Hillshade_Noon\"] < 0, \"Hillshade_Noon\"] = 0\ntrain.loc[train[\"Hillshade_3pm\"] < 0, \"Hillshade_3pm\"] = 0\ntrain.loc[train[\"Hillshade_9am\"] > 255, \"Hillshade_9am\"] = 255\ntrain.loc[train[\"Hillshade_Noon\"] > 255, \"Hillshade_Noon\"] = 255\ntrain.loc[train[\"Hillshade_3pm\"] > 255, \"Hillshade_3pm\"] = 255\n\n\ntest.loc[test[\"Hillshade_9am\"] < 0, \"Hillshade_9am\"] = 0\ntest.loc[test[\"Hillshade_Noon\"] < 0, \"Hillshade_Noon\"] = 0\ntest.loc[test[\"Hillshade_3pm\"] < 0, \"Hillshade_3pm\"] = 0\ntest.loc[test[\"Hillshade_9am\"] > 255, \"Hillshade_9am\"] = 255\ntest.loc[test[\"Hillshade_Noon\"] > 255, \"Hillshade_Noon\"] = 255\ntest.loc[test[\"Hillshade_3pm\"] > 255, \"Hillshade_3pm\"] = 255","7d0b30a9":"plt.figure()\n\nfig, ax = plt.subplots(figsize=(15,15))\nplt.subplot(3,3,1)\nsns.boxplot(x=train['Cover_Type'],y=train['Aspect'])\nplt.title(\"Aspect vs Cover Type\")\n\nplt.subplot(3,3,2)\nsns.boxplot(x=train['Cover_Type'],y=train['Elevation'])\nplt.title('Elevation vs Cover Type')\n\nplt.subplot(3,3,3)\nsns.boxplot(x=train['Cover_Type'],y=train['Slope'])\nplt.title('Slope vs Cover Type')\n\nplt.subplot(3,3,4)\nsns.boxplot(x=train['Cover_Type'],y=train['Horizontal_Distance_To_Hydrology'])\nplt.title('Horizontal_Distance_To_Hydrology vs Cover Type')\n\nplt.subplot(3,3,5)\nsns.boxplot(x=train['Cover_Type'],y=train['Vertical_Distance_To_Hydrology'])\nplt.title('Vertical_Distance_To_Hydrology vs Cover Type')\n\nplt.subplot(3,3,6)\nsns.boxplot(x=train['Cover_Type'],y=train['Horizontal_Distance_To_Roadways'])\nplt.title('Horizontal_Distance_To_Roadways vs Cover Type')\n\nplt.subplot(3,3,7)\nsns.boxplot(x=train['Cover_Type'],y=train['Hillshade_9am'])\nplt.title('Hillshade_9am vs Cover Type')\n\nplt.subplot(3,3,8)\nsns.boxplot(x=train['Cover_Type'],y=train['Hillshade_Noon'])\nplt.title('Hillshade_Noon vs Cover Type')\n\nplt.subplot(3,3,9)\nsns.boxplot(x=train['Cover_Type'],y=train['Hillshade_3pm'])\nplt.title('Hillshade_3pm vs Cover Type')\n\n\n\n\nplt.show()","b4cd22f2":"train[['Horizontal_Distance_To_Hydrology','Vertical_Distance_To_Hydrology', 'Horizontal_Distance_To_Roadways','Horizontal_Distance_To_Fire_Points']].describe()","7dbbdcf2":"train['Hydrological_Distance']=(train['Horizontal_Distance_To_Hydrology']**2+train['Vertical_Distance_To_Hydrology']**2)**0.5\ntest['Hydrological_Distance'] = (test['Horizontal_Distance_To_Hydrology']**2+test['Vertical_Distance_To_Hydrology']**2)**0.5","d3f551fe":"cols_drop.extend(['Horizontal_Distance_To_Hydrology','Vertical_Distance_To_Hydrology'])","c0fc93ae":"from xgboost import XGBClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score","e5aec28d":"X=train.drop('Cover_Type',axis=True)\nY=train['Cover_Type']","20d28676":"X_train,x_test,Y_train,y_test=train_test_split(X,Y,train_size=0.70)","1293bcf8":"# Training a model without removing drop cols\n\nxgb_without_fe=XGBClassifier(n_estimators=95,n_jobs=-1,booster='gbtree',predictor='gpu_predictor',tree_method='gpu_hist')\nxgb_without_fe.fit(X_train,Y_train)\npredicted_value=xgb_without_fe.predict(x_test)\nacc_score_without_fe=accuracy_score(y_test,predicted_value)\nacc_score_without_fe","70fe11f0":"# Training a model after removing drop cols\nX_train_drop_cols=X_train.drop(cols_drop,axis=1)\nx_test_drop_cols=x_test.drop(cols_drop,axis=1)\n\n\nxgb_with_fe=XGBClassifier(n_estimators=95,n_jobs=-1,booster='gbtree',predictor='gpu_predictor',tree_method='gpu_hist')\nxgb_with_fe.fit(X_train_drop_cols,Y_train)\npredicted_value=xgb_with_fe.predict(x_test_drop_cols)\nacc_score_with_fe=accuracy_score(y_test,predicted_value)\nacc_score_with_fe","3d194ff2":"compare=pd.DataFrame({'With_Fe':acc_score_with_fe,'Without_Fe':acc_score_without_fe},index=range(1))\ncompare","e792edda":"from xgboost import plot_importance\nfrom matplotlib import pyplot","21a37c3d":"plot_importance(xgb_without_fe, max_num_features=10) # top 10 most important features\nplt.show()","6a6319cc":"test_id=test['Id']\ntest.drop('Id',inplace=True,axis=1)","fbe44724":"test=test[X_train.columns]","58a52571":"predicted_value=xgb_without_fe.predict(test)\nsubmission=pd.DataFrame({'Id':test_id,'Cover_Type':predicted_value})","4b1a0a63":"submission.set_index('Id')","c22c7995":"submission.to_csv('submission.csv',index=False)","7dcbf918":"pd.read_csv('submission.csv')","4bafd820":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#42c556;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 10px;\n              color:white;\"> HOW FEATURES VARY WITH COVER TYPE\n<\/p>\n<\/div> ","90123975":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#42c556;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 10px;\n              color:white;\"> FEATURE IMPORTANCE\n<\/p>\n<\/div> ","1513077a":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#42c556;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 10px;\n              color:white;\">FOREST COVER TYPE PREDICTION\n<\/p>\n<\/div> ","9f59908f":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#42c556;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 10px;\n              color:white;\"> ACCURACY COMPARISON WITH AND WITHOUT FE\n<\/p>\n<\/div> ","ce980fdc":"[Click Here To Read More On aspect](https:\/\/desktop.arcgis.com\/en\/arcmap\/10.3\/tools\/spatial-analyst-toolbox\/how-aspect-works.htm)","fe8dc0dc":"<div class=\"alert alert-warning\" role=\"alert\">\ud83d\udcccThis notebook is begginner friendly and aims at explaining key concepts involved in Forest Cover Type Prediction.I have included feature engineering in this notebook...However my accuracy is better without FE.\ud83d\ude05(Things included in this notebook are memory reduction,feature engineering ,accuracy comparision with and without FE and feature importance)","42a37849":"<div class=\"alert alert-block alert-info\"> \ud83d\ude35 Train And Test Set Seem to be Different.<\/div>","451aaf50":"\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#42c556;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 10px;\n              color:white;\">MEMORY REDUCTION\n<\/p>\n<\/div> ","33822e87":"<div class=\"alert alert-block alert-info\"> \ud83d\udcccEven adding the soil types does not increase variability.Let us drop the 40 columns that relate to soil type\ud83d\ude36","0daa6a7a":"<div class=\"alert alert-block alert-info\"> \ud83d\udccc Getting hillshade values in the range.<\/div>","c6bd2e2f":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#42c556;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 10px;\n              color:white;\"> SUBMISSION\n<\/p>\n<\/div> ","7feb4693":"<div class=\"alert alert-block alert-info\"> \ud83d\udccc There is a high class imbalance ","79e285a3":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#42c556;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 10px;\n              color:white;\"> EXPLORATORY DATA ANALYSIS\n<\/p>\n<\/div> \n\n","9796d89c":"<div class=\"alert alert-block alert-info\">\ud83d\udccc Elevation seems to be a good predictor of Cover Type.<\/div>","ea7725ba":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#42c556;\n           font-size:90%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 10px;\n              color:white;\">TRAIN Vs TEST SET \n<\/p>\n<\/div> \n","ab291359":"<div class=\"alert alert-warning\" role=\"alert\">\ud83d\udcccHillshading is the process of adding light and dark areas or shading to a map to highlight the location of hills or mountains. Hillshading uses light and dark areas to highlight where sunlight would hit and where shadows would form in the presence of hills and mountains.(Range 0-255)","76d0ff97":"**> How Does Memory Reduction Help?**\ud83d\ude44\n* It helps to avoid memory loss error.That is Running out of RAM to execute your code.\n\n**> How can we reduce memory?**\ud83d\ude44\n* Changing Obj Data Type to Categorical.\n* To convert a number from one dtype to another ...Keep the following in mind.\n    * Number of digits to be stored \n    * Max and min values of the column\n    * Kind of precision required \n    \nfloat64 takes two times the memory as compared to float32.However float64\u2019s can represent numbers much more accurately than 32 bit floats.\n\nDifference in bits and resulting difference in precision\n\n* np.array([0.123456789121212,2,3], dtype=np.float16) =0.1235\n* np.array([0.123456789121212,2,3], dtype=np.float32)=0.1234567\n* np.array([0.123456789121212121212,2,3], dtype=np.float64) =0.12345678912121212\n\n\nThe following link contains the numpy data types and their range\nhttps:\/\/www.w3resource.com\/numpy\/data-types.php\n\n\nIn the below code for each numeric feature(int and float) we first check the min and max values and then see if downsizing the feature is possible\n","bb6027c3":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#42c556;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 10px;\n              color:white;\"> SIMPLE XGBOOST MODEL\n<\/p>\n<\/div> ","00f24d3f":"<div class=\"alert alert-block alert-info\">\ud83d\udccc Distance cannot be negative.What does horizontal and vertical distance remind you of?\ud83d\ude33....Pythagoras theorem?...Eureka!!!\ud83d\ude2e...Lets create a new feature Distance to Hyderology<\/div>\n\n","7f415d0a":"<div class=\"alert alert-block alert-info\"> \ud83d\udccc Adding all wilderness columns and dropping the rest.<\/div>","8469e61f":"![image.png](attachment:3aee1b94-4a5d-4cef-b3a7-c6376297f478.png)","eb6a9f6d":"-  Where AC is hyderological distance","496b74fd":"**What to do when aspect is negative?**\ud83d\ude44\nSimply add 360  [As per wikipedia link](www.google.com\/search?q=can+you+have+a+negative+azimuth+The+formula+in+radians+would+be+slightly+easier%3A.&sxsrf=AOaemvLT-9tmWJcc3X6p27oAv2VysQPXLQ%3A1639839527750&ei=J_e9YYuWLcKpoATYo6iYDA&ved=0ahUKEwjLxaikzu30AhXCFIgKHdgRCsMQ4dUDCA4&uact=5&oq=can+you+have+a+negative+azimuth+The+formula+in+radians+would+be+slightly+easier%3A.&gs_lcp=Cgdnd3Mtd2l6EAM6BwgjELADECc6BwgAEEcQsAM6BggAEBYQHkoECEEYAEoECEYYAFCZAVikCGDPDGgBcAJ4AIABeYgB4gGSAQMwLjKYAQCgAQGgAQLIAQnAAQE&sclient=gws-wiz)\n","16d108c7":"<div class=\"alert alert-warning\" role=\"alert\">\ud83d\udcccAspect(Azimuth) identifies the downslope direction of the maximum rate of change in value from each cell to its neighbors. It can be thought of as the slope direction. The values of each cell in the output raster indicate the compass direction that the surface faces at that location. It is measured clockwise in degrees from 0 (due north) to 360 (again due north), coming full circle.The azimuth angle value will be negative before solar noon, and positive after solar noon.","f771db8d":"<div class=\"alert alert-block alert-info\"> \ud83d\udccc All soil type columns and two of wilderness columns  are low variance columns\ud83e\udd28 which make them redundant.Let us create a column called **soil_type** which is the sum of all soil type columns  and see if we can increase variability."}}