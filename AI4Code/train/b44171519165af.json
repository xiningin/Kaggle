{"cell_type":{"d676d451":"code","5d239ae4":"code","c64abf9e":"code","49df09dc":"code","af3333af":"code","88575c1e":"code","71e16ccb":"code","b403ce7e":"code","05c7f58b":"code","74275c1e":"code","f6885d75":"code","950f715b":"code","67e4508d":"code","d5fc1200":"code","46b96fed":"code","4b8dc6e7":"code","ffc8665a":"code","3a346ded":"code","e570be22":"code","fe105e81":"code","d9112ce3":"code","72ab5815":"code","7373a62b":"code","e7e297e0":"code","4c77e056":"code","e180b4d8":"code","c94e1b3f":"code","a78f3fde":"code","07188e6b":"code","f9dd874d":"code","4326ab51":"code","c0975398":"code","c24b8824":"code","277a00be":"code","90a38e3b":"code","f76a6c2e":"code","e5a4481c":"code","5e03ffac":"code","a25b8588":"code","0c748fe9":"code","f065e162":"code","c6be1fcc":"code","36cd0623":"code","7ffee51f":"code","0988c637":"code","aa7ece28":"code","4b1e1442":"code","8af282a4":"code","33ba90f7":"code","346d365d":"code","109ca440":"code","18af9fc4":"code","07582feb":"markdown","c78502c2":"markdown","df252cf6":"markdown","6db9c9c3":"markdown","bb9f8fe5":"markdown","a2966fe5":"markdown","26432508":"markdown","544821a4":"markdown","a4798ba7":"markdown","7de91ebe":"markdown","fb5a63b8":"markdown","2372d67a":"markdown","39b5cd8e":"markdown","b3ce9958":"markdown","4777de8c":"markdown","83dc9328":"markdown","1422d27f":"markdown","efda0b76":"markdown","71663d85":"markdown","fef14a34":"markdown","68a861a1":"markdown","4f7327c6":"markdown","035ac1fd":"markdown","64c3146e":"markdown","e643ceb5":"markdown","ba2e8b10":"markdown","d4ccafcb":"markdown","cc2453ae":"markdown","7524175f":"markdown","baa8b927":"markdown","9518b176":"markdown","6edcfcf2":"markdown"},"source":{"d676d451":"# install calmap\n! pip install calmap","5d239ae4":"# essential libraries\nimport json\nimport random\nfrom urllib.request import urlopen\n\n# storing and anaysis\nimport numpy as np\nimport pandas as pd\n\n# visualization\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nimport plotly.graph_objs as go\nimport plotly.figure_factory as ff\nimport calmap\nimport folium\n\n# color pallette\ncnf = '#393e46' # confirmed - grey\ndth = '#ff2e63' # death - red\nrec = '#21bf73' # recovered - cyan\nact = '#fe9801' # active case - yellow\n\n# converter\nfrom pandas.plotting import register_matplotlib_converters\nregister_matplotlib_converters()   \n\n# hide warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# html embedding\nfrom IPython.display import Javascript\nfrom IPython.core.display import display\nfrom IPython.core.display import HTML","c64abf9e":"# list files\n !ls ..\/input\/corona-virus-report","49df09dc":"# importing datasets\nfull_table = pd.read_csv('..\/input\/corona-virus-report\/covid_19_clean_complete.csv', \n                         parse_dates=['Date'])\nfull_table.head()","af3333af":"full_table.shape","88575c1e":"# dataframe info\nfull_table.info()","71e16ccb":"# checking for missing value\n full_table.isna().sum()","b403ce7e":"import seaborn as sns\nfrom matplotlib import pyplot as plt\nprint('Country\/Region ')\nsns.countplot('Country\/Region', data=full_table)\nplt.title('Country\/Region size', fontsize=14)\nplt.show()","05c7f58b":"full_table","74275c1e":"#full_sum = full_table.groupby('Date').sum()\n#full_sum_drop = full_sum.drop(['Lat','Long'], axis =1)\nfull_sum =full_table.sort_values(['Confirmed','Deaths'],ascending=False).groupby('Date').head(3)","f6885d75":"full_sum","950f715b":"full_sum_latest = full_sum[full_sum['Date'] == '2020-03-13']","67e4508d":"full_sum_latest","d5fc1200":"full_table['Country\/Region'].nunique()","46b96fed":"full_table['Country\/Region'].value_counts().head(10)","4b8dc6e7":"# cases \ncases = ['Confirmed', 'Deaths', 'Recovered', 'Active']\n\n# Active Case = confirmed - deaths - recovered\nfull_table['Active'] = full_table['Confirmed'] - full_table['Deaths'] - full_table['Recovered']\n\n\n# filling missing values \nfull_table[['Province\/State']] = full_table[['Province\/State']].fillna('')\nfull_table[cases] = full_table[cases].fillna(0)","ffc8665a":"# cases in the ships\nship = full_table[full_table['Province\/State'].str.contains('Grand Princess')|full_table['Country\/Region'].str.contains('Cruise Ship')]\n\n# china and the row\nchina = full_table[full_table['Country\/Region']=='China']\nrow = full_table[full_table['Country\/Region']!='China']\nSweden = full_table[full_table['Country\/Region']=='Sweden']\nItaly = full_table[full_table['Country\/Region']=='Italy']\nIran = full_table[full_table['Country\/Region']=='Iran']\nSpain = full_table[full_table['Country\/Region']=='Spain']\nGermany = full_table[full_table['Country\/Region']=='Germany']\n\n\n# latest\nfull_latest = full_table[full_table['Date'] == max(full_table['Date'])].reset_index()\nchina_latest = full_latest[full_latest['Country\/Region']=='China']\nSweden_latest = full_latest[full_latest['Country\/Region']=='Sweden']\nItaly_latest = full_latest[full_latest['Country\/Region']=='Italy']\nIran_latest = full_latest[full_latest['Country\/Region']=='Iran']\nSpain_latest = full_latest[full_latest['Country\/Region']=='Spain']\nGermany_latest = full_latest[full_latest['Country\/Region']=='Germany']\nrow_latest = full_latest[full_latest['Country\/Region']!='China']\n\n# latest condensed\nfull_latest_grouped = full_latest.groupby('Country\/Region')['Confirmed', 'Deaths', 'Recovered', 'Active'].sum().reset_index()\nchina_latest_grouped = china_latest.groupby('Province\/State')['Confirmed', 'Deaths', 'Recovered', 'Active'].sum().reset_index()\nrow_latest_grouped = row_latest.groupby('Country\/Region')['Confirmed', 'Deaths', 'Recovered', 'Active'].sum().reset_index()","3a346ded":"Sweden","e570be22":"Sweden_latest","fe105e81":"china_latest","d9112ce3":"china_latest_grouped","72ab5815":"row_latest_grouped","7373a62b":"temp = full_table.groupby(['Country\/Region', 'Province\/State'])['Confirmed', 'Deaths', 'Recovered', 'Active'].max()\n# temp.style.background_gradient(cmap='Reds')","e7e297e0":"temp.head()","4c77e056":"temp = full_table.groupby('Date')['Confirmed', 'Deaths', 'Recovered', 'Active'].sum().reset_index()","e180b4d8":"temp.head()","c94e1b3f":"\ntemp = temp[temp['Date']==max(temp['Date'])].reset_index(drop=True)\ntemp.style.background_gradient(cmap='Pastel1')","a78f3fde":"full_latest_grouped","07188e6b":"temp_f = full_latest_grouped.sort_values(by='Confirmed', ascending=False)\ntemp_f = temp_f.reset_index(drop=True)\ntemp_f.style.background_gradient(cmap='Reds')","f9dd874d":"temp_flg = temp_f[temp_f['Deaths']>0][['Country\/Region', 'Deaths']]\ntemp_flg.sort_values('Deaths', ascending=False).reset_index(drop=True).style.background_gradient(cmap='Reds')","4326ab51":"temp = temp_f[temp_f['Recovered']==0][['Country\/Region', 'Confirmed', 'Deaths', 'Recovered']]\ntemp.reset_index(drop=True).style.background_gradient(cmap='Reds')","c0975398":"temp_f = china_latest_grouped[['Province\/State', 'Confirmed', 'Deaths', 'Recovered']]\ntemp_f = temp_f.sort_values(by='Confirmed', ascending=False)\ntemp_f = temp_f.reset_index(drop=True)\ntemp_f.style.background_gradient(cmap='Pastel1_r')","c24b8824":"# World wide\n\nm = folium.Map(location=[0, 0], tiles='cartodbpositron',\n               min_zoom=1, max_zoom=4, zoom_start=1)\n\nfor i in range(0, len(full_latest)):\n    folium.Circle(\n        location=[full_latest.iloc[i]['Lat'], full_latest.iloc[i]['Long']],\n        color='crimson', \n        tooltip =   '<li><bold>Country : '+str(full_latest.iloc[i]['Country\/Region'])+\n                    '<li><bold>Province : '+str(full_latest.iloc[i]['Province\/State'])+\n                    '<li><bold>Confirmed : '+str(full_latest.iloc[i]['Confirmed'])+\n                    '<li><bold>Deaths : '+str(full_latest.iloc[i]['Deaths'])+\n                    '<li><bold>Recovered : '+str(full_latest.iloc[i]['Recovered']),\n        radius=int(full_latest.iloc[i]['Confirmed'])**1.1).add_to(m)\nm","277a00be":"# Confirmed\n\nfig = px.choropleth(full_latest_grouped, locations=\"Country\/Region\", \n                    locationmode='country names', color=\"Confirmed\", \n                    hover_name=\"Country\/Region\", range_color=[1,7000], \n                    color_continuous_scale=\"aggrnyl\", \n                    title='Countries with Confirmed Cases')\nfig.update(layout_coloraxis_showscale=False)\nfig.show()","90a38e3b":"# Deaths\n\nfig = px.choropleth(full_latest_grouped[full_latest_grouped['Deaths']>0], \n                    locations=\"Country\/Region\", locationmode='country names',\n                    color=\"Deaths\", hover_name=\"Country\/Region\", \n                    range_color=[1,50], color_continuous_scale=\"agsunset\",\n                    title='Countries with Deaths Reported')\nfig.update(layout_coloraxis_showscale=False)\nfig.show()","f76a6c2e":"formated_gdf = full_table.groupby(['Date', 'Country\/Region'])['Confirmed', 'Deaths', 'Recovered'].max()\nformated_gdf = formated_gdf.reset_index()\nformated_gdf['Date'] = pd.to_datetime(formated_gdf['Date'])\nformated_gdf['Date'] = formated_gdf['Date'].dt.strftime('%m\/%d\/%Y')\nformated_gdf['size'] = formated_gdf['Confirmed'].pow(0.3)\n\nfig = px.scatter_geo(formated_gdf, locations=\"Country\/Region\", locationmode='country names', \n                     color=\"Confirmed\", size='size', hover_name=\"Country\/Region\", \n                     range_color= [0, max(formated_gdf['Confirmed'])+2], \n                     projection=\"natural earth\", animation_frame=\"Date\", \n                     title='Spread over time')\nfig.update(layout_coloraxis_showscale=False)\nfig.show()","e5a4481c":"temp = full_table.groupby('Date')['Recovered', 'Deaths', 'Active'].sum().reset_index()\ntemp = temp.melt(id_vars=\"Date\", value_vars=['Recovered', 'Deaths', 'Active'],\n                 var_name='Case', value_name='Count')\ntemp.head()\n\nfig = px.area(temp, x=\"Date\", y=\"Count\", color='Case',\n             title='Cases over time', color_discrete_sequence = [rec, dth, act])\nfig.show()","5e03ffac":"\nSweden = full_table[full_table['Country\/Region'] == 'Sweden']\n\ntemp = Sweden.groupby('Date')['Recovered', 'Deaths', 'Active'].sum().reset_index()\ntemp = temp.melt(id_vars=\"Date\", value_vars=['Recovered', 'Deaths', 'Active'],\n                 var_name='Case', value_name='Count')\ntemp.head()\n\nfig = px.area(temp, x=\"Date\", y=\"Count\", color='Case',\n             title='Sweden Cases over time', color_discrete_sequence = [rec, dth, act])\nfig.show()","a25b8588":"Italy = full_table[full_table['Country\/Region'] == 'Italy']\n\ntemp = Italy.groupby('Date')['Recovered', 'Deaths', 'Active'].sum().reset_index()\ntemp = temp.melt(id_vars=\"Date\", value_vars=['Recovered', 'Deaths', 'Active'],\n                 var_name='Case', value_name='Count')\ntemp.head()\n\nfig = px.area(temp, x=\"Date\", y=\"Count\", color='Case',\n             title='Italy Cases over time', color_discrete_sequence = [rec, dth, act])\nfig.show()","0c748fe9":"Spain = full_table[full_table['Country\/Region'] == 'Spain']\n\ntemp = Spain.groupby('Date')['Recovered', 'Deaths', 'Active'].sum().reset_index()\ntemp = temp.melt(id_vars=\"Date\", value_vars=['Recovered', 'Deaths', 'Active'],\n                 var_name='Case', value_name='Count')\ntemp.head()\n\nfig = px.area(temp, x=\"Date\", y=\"Count\", color='Case',\n             title='Spain Cases over time', color_discrete_sequence = [rec, dth, act])\nfig.show()","f065e162":"flg = full_latest_grouped\nflg.head()","c6be1fcc":"fig = px.bar(flg.sort_values('Confirmed', ascending=False).head(20).sort_values('Confirmed', ascending=True), \n             x=\"Confirmed\", y=\"Country\/Region\", title='Confirmed Cases', text='Confirmed', orientation='h', \n             width=700, height=700, range_x = [0, max(flg['Confirmed'])+10000])\nfig.update_traces(marker_color='#46cdcf', opacity=0.8, textposition='outside')\nfig.show()","36cd0623":"fig = px.bar(flg.sort_values('Deaths', ascending=False).head(20).sort_values('Deaths', ascending=True), \n             x=\"Deaths\", y=\"Country\/Region\", title='Deaths', text='Deaths', orientation='h', \n             width=700, height=700, range_x = [0, max(flg['Deaths'])+500])\nfig.update_traces(marker_color=dth, opacity=0.6, textposition='outside')\nfig.show()","7ffee51f":"fig = px.bar(flg.sort_values('Recovered', ascending=False).head(20).sort_values('Recovered', ascending=True), \n             x=\"Recovered\", y=\"Country\/Region\", title='Recovered', text='Recovered', orientation='h', \n             width=700, height=700, range_x = [0, max(flg['Recovered'])+10000])\nfig.update_traces(marker_color=rec, opacity=0.6, textposition='outside')\nfig.show()","0988c637":"fig = px.bar(flg.sort_values('Active', ascending=False).head(20).sort_values('Active', ascending=True), \n             x=\"Active\", y=\"Country\/Region\", title='Active', text='Active', orientation='h', \n             width=700, height=700, range_x = [0, max(flg['Active'])+3000])\nfig.update_traces(marker_color='#f0134d', opacity=0.6, textposition='outside')\nfig.show()","aa7ece28":"# (Only countries with more than 100 case are considered)\n\nflg['Mortality Rate'] = round((flg['Deaths']\/flg['Confirmed'])*100, 2)\ntemp = flg[flg['Confirmed']>100]\ntemp = temp.sort_values('Mortality Rate', ascending=False)\n\nfig = px.bar(temp.sort_values('Mortality Rate', ascending=False).head(15).sort_values('Mortality Rate', ascending=True), \n             x=\"Mortality Rate\", y=\"Country\/Region\", text='Mortality Rate', orientation='h', \n             width=700, height=600, range_x = [0, 10], title='No. of Deaths Per 100 Confirmed Case')\nfig.update_traces(marker_color='#00a8cc', opacity=0.6, textposition='outside')\nfig.show()","4b1e1442":"# load population dataset\npop_clean_data = pd.read_csv(\"..\/input\/world-population-19602018\/population_clean.csv\")\n\n# select only the latest data\npop = pop_clean_data.loc[:, ['Country Name', '2018']]\n\n# substitute for missing values\ncols = ['French Guiana', 'Martinique', 'Palestine' , 'Republic of Ireland', 'Saint Barthelemy', 'Taiwan', 'Vatican City']\npops = [290691, 376480, 4750000, 4920455, 7122, 23476640, 1000]\nfor c, p in zip(cols, pops):\n    temp.loc[temp['Country\/Region']== c, 'Population'] = p\n\n# replace country names \nname = {\n    'Egypt, Arab Rep.': 'Egypt',\n    'Hong Kong SAR, China': 'Hong Kong',\n    'Iran, Islamic Rep.': 'Iran (Islamic Republic of)',\n    'Macao SAR, China': 'Macau',\n    'Hong Kong SAR': 'Hong Kong',\n    'Russian Federation': 'Russia',\n    'Slovak Republic': 'Slovakia',\n    'Korea, Rep.': 'Republic of Korea',\n    'United Kingdom': 'UK',\n    'United States': 'US' }\npop.loc[:, 'Country Name'] = pop.loc[: 'Country Name'].replace(name)\n\n# merge dataframes\ntemp = pd.merge(full_latest_grouped, pop, how='left', right_on='Country Name', left_on='Country\/Region')\n# print(temp[temp['Country Name'].isna()])\n\ntemp = temp[['Country\/Region', 'Confirmed', 'Deaths', 'Recovered', 'Active', '2018']]\ntemp.columns = ['Country\/Region', 'Confirmed', 'Deaths', 'Recovered', 'Active', 'Population']\n    \n# calculate Confirmed\/Population\ntemp['Confirmed Per Million People'] = round(temp['Confirmed']\/temp['Population']*1000000, 2)\n\n# countries with population greater that 1 million only\ntemp = temp[temp['Population']>1000000].sort_values('Confirmed Per Million People', ascending=False).reset_index(drop=True)\n# temp.head()\n\nfig = px.bar(temp.head(20).sort_values('Confirmed Per Million People', ascending=True), \n             x='Confirmed Per Million People', y='Country\/Region', orientation='h', \n             width=700, height=700, text='Confirmed Per Million People', title='Confirmed cases Per Million People',\n             range_x = [0, max(temp['Confirmed Per Million People'])+40])\nfig.update_traces(textposition='outside', marker_color='#2a7886', opacity=0.7)\nfig.update_layout(uniformtext_minsize=8, uniformtext_mode='hide')\nfig.show()","8af282a4":"temp = full_table.groupby(['Date', 'Country\/Region'])['Confirmed'].sum().reset_index().sort_values('Confirmed', ascending=False)\n\npx.line(temp, x=\"Date\", y=\"Confirmed\", color='Country\/Region', title='Cases Spread', height=600)","33ba90f7":"temp_row = full_table[full_table['Country\/Region']!='China']\ntemp = temp_row.groupby(['Date', 'Country\/Region'])['Confirmed'].sum().reset_index().sort_values('Confirmed', ascending=False)\npx.line(temp, x=\"Date\", y=\"Confirmed\", color='Country\/Region', title='Cases Spread', height=600)\n","346d365d":"emp_sweden= full_table[full_table['Country\/Region']=='Sweden']\ntemp = emp_sweden.groupby(['Date', 'Country\/Region'])['Confirmed'].sum().reset_index().sort_values('Confirmed', ascending=False)\npx.line(temp, x=\"Date\", y=\"Confirmed\", color='Country\/Region', title='Cases Spread', height=600)","109ca440":"emp_Italy= full_table[full_table['Country\/Region']=='Italy'  ]\ntemp = emp_Italy.groupby(['Date', 'Country\/Region'])['Confirmed'].sum().reset_index().sort_values('Confirmed', ascending=False)\npx.line(temp, x=\"Date\", y=\"Confirmed\", color='Country\/Region', title='Cases Spread', height=600)","18af9fc4":"nordic_country = ['Sweden', 'Norway', 'Denmark', 'Finland']\nemp_Italy = full_table.loc[full_table['Country\/Region'].isin(nordic_country)]\ntemp = emp_Italy.groupby(['Date', 'Country\/Region'])['Confirmed'].sum().reset_index().sort_values('Confirmed', ascending=False)\npx.line(temp, x=\"Date\", y=\"Confirmed\", color='Country\/Region', title='Cases Spread', height=600)","07582feb":"### Latest Complete Data","c78502c2":"# What is coronavirus?\n\nCoronaviruses are a large family of viruses which may cause illness in animals or humans.  In humans, several coronaviruses are known to cause respiratory infections ranging from the common cold to more severe diseases such as Middle East Respiratory Syndrome (MERS) and Severe Acute Respiratory Syndrome (SARS). The most recently discovered coronavirus causes coronavirus disease COVID-19.\n\n\n# What is COVID-19?\n\nCOVID-19 is the infectious disease caused by the most recently discovered coronavirus. This new virus and disease were unknown before the outbreak began in Wuhan, China, in December 2019. \n\n# How does COVID-10 Spread?\nPeople can catch COVID-19 from others who have the virus. The disease can spread from person to person through small droplets from the nose or mouth which are spread when a person with COVID-19 coughs or exhales. These droplets land on objects and surfaces around the person. Other people then catch COVID-19 by touching these objects or surfaces, then touching their eyes, nose or mouth. People can also catch COVID-19 if they breathe in droplets from a person with COVID-19 who coughs out or exhales droplets. This is why it is important to stay more than 1 meter (3 feet) away from a person who is sick.\n\nWHO is assessing ongoing research on the ways COVID-19 is spread and will continue to share updated findings.","df252cf6":"### Install","6db9c9c3":"# Spain","bb9f8fe5":"# Cases over the time","a2966fe5":"# Dataset","26432508":"# If you have recently traveled to COVID-19 affected regions or have came into contact with such person kindly get yourself tested if possible, otherwise please self quarantine for 2 weeks. ","544821a4":"# Analysis on similar epidemics","a4798ba7":"### Derived Tables","7de91ebe":"# Maps","fb5a63b8":"# Sweden","2372d67a":"# Preprocessing","39b5cd8e":"# Exclude China","b3ce9958":"### Countries with no cases recovered","4777de8c":"# Italy","83dc9328":"# Country wise Data","1422d27f":"### Across the world","efda0b76":"### Latest Condensed Data","71663d85":"# Latest Data","fef14a34":"# Nordic country","68a861a1":"### Import","4f7327c6":"### Countries with deaths reported","035ac1fd":" thanks to https:\/\/www.kaggle.com\/imdevskp\/covid-19-analysis-viz-prediction-comparisons","64c3146e":"### In each country","e643ceb5":"https:\/\/app.flourish.studio\/visualisation\/1571387\/edit\n\n","ba2e8b10":"Note : In the graph, last day is shown as one day after the last time a new confirmed cases reported in the Country \/ Region","d4ccafcb":"# Sweden","cc2453ae":"https:\/\/www.kaggle.com\/imdevskp\/mers-outbreak-analysis  \nhttps:\/\/www.kaggle.com\/imdevskp\/sars-2003-outbreak-analysis  \nhttps:\/\/www.kaggle.com\/imdevskp\/western-africa-ebola-outbreak-analysis\n","7524175f":"![](https:\/\/socoemergency.org\/wp-content\/uploads\/2020\/03\/Coronavirus-700-1.jpg)","baa8b927":"### Cleaning Data","9518b176":"# Top 20 Countries","6edcfcf2":"# No. of places to which COVID-19 spread"}}