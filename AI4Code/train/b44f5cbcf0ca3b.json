{"cell_type":{"36d52334":"code","7e0e6a56":"code","17da0f8b":"code","1215636d":"code","1841a37c":"code","4355990a":"code","f7db8cbf":"code","987d0eed":"code","73be1947":"code","b4264720":"code","20c81ca1":"code","f442afcc":"code","1d5c7fb5":"code","f8981bd9":"code","a7692187":"code","694ec18f":"code","0e85967f":"code","20b0db7e":"code","3cf09b04":"code","537e5c7c":"code","2403019d":"code","a9d50b94":"code","28754645":"code","5bb9b82f":"code","5753633e":"code","9bee2924":"code","c525e273":"code","bafb270c":"code","bcfc33bb":"code","203e749c":"code","9c88929e":"code","22f00901":"code","6e3a6db5":"code","dabaaf6e":"code","6954ce6d":"code","834b0fb7":"code","4359bf9a":"code","256dcc40":"code","336e94b6":"code","192e81a8":"code","2bc4e9e4":"code","29e71d0a":"code","cea3f41e":"code","688870b2":"code","2ec179e3":"code","1a060dc8":"code","40bfb81c":"code","745166c9":"code","447dd456":"code","46631ab3":"code","2c5e908e":"code","46fc22c0":"code","95e4d5de":"code","379ec9b8":"code","90dd8390":"code","c29dc65c":"code","9d64b7f0":"code","c970443c":"code","a6b60004":"code","f9844d0e":"markdown","2c31d1fa":"markdown","f0b56b38":"markdown","9180051b":"markdown","ef5d81c3":"markdown","13682508":"markdown","07668776":"markdown","e9cf080b":"markdown","c8add31a":"markdown","515e2e76":"markdown","3848f9cd":"markdown","eee2068c":"markdown","e4627558":"markdown","5655154c":"markdown","b11352f8":"markdown","9530d3e5":"markdown","1ed6d827":"markdown","83b65317":"markdown","c2c0a9f5":"markdown","350b572d":"markdown","47f9b8d2":"markdown","2cf689ae":"markdown","454f5110":"markdown","16d1dab7":"markdown","59c38d2e":"markdown","e1bb2afa":"markdown","9dad5d20":"markdown","3c32c4f5":"markdown","9f74760b":"markdown","25783720":"markdown","504086df":"markdown","305713b3":"markdown","d2316b0b":"markdown","e9e069fc":"markdown","96942b7b":"markdown","032cc718":"markdown","538fd579":"markdown","98626f0a":"markdown","33f22f15":"markdown"},"source":{"36d52334":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","7e0e6a56":"import warnings  \nwarnings.filterwarnings('ignore')\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport seaborn as sns\nimport matplotlib.pyplot as plt","17da0f8b":"data = pd.read_csv('..\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')\ndata","1215636d":"data.isnull().sum()","1841a37c":"data.describe()","4355990a":"plt.figure(figsize=(16,10))\nsns.heatmap(data.corr(method='pearson'), annot=True)","f7db8cbf":"sns.distplot(x=data['age'])","987d0eed":"sns.kdeplot(\n   data=data, x=\"creatinine_phosphokinase\", hue=\"DEATH_EVENT\",\n   fill=True, common_norm=False, palette=\"crest\",\n   alpha=.5, linewidth=0,\n)","73be1947":"sns.kdeplot(\n   data=data, x=\"platelets\", hue=\"DEATH_EVENT\",\n   fill=True, common_norm=False, palette=\"crest\",\n   alpha=.5, linewidth=0,\n)","b4264720":"sns.kdeplot(\n   data=data, x=\"serum_creatinine\", hue=\"DEATH_EVENT\",\n   fill=True, common_norm=False, palette=\"crest\",\n   alpha=.5, linewidth=0,\n)","20c81ca1":"sns.kdeplot(\n   data=data, x=\"serum_sodium\", hue=\"DEATH_EVENT\",\n   fill=True, common_norm=False, palette=\"crest\",\n   alpha=.5, linewidth=0,\n)","f442afcc":"sns.kdeplot(\n   data=data, x=\"time\", hue=\"DEATH_EVENT\",\n   fill=True, common_norm=False, palette=\"crest\",\n   alpha=.5, linewidth=0,\n)","1d5c7fb5":"sns.countplot(data['anaemia'])","f8981bd9":"sns.countplot(data['diabetes'])","a7692187":"sns.countplot(data['high_blood_pressure'])","694ec18f":"sns.countplot(data['sex'])","0e85967f":"sns.countplot(data['smoking'])","20b0db7e":"from scipy.stats import skew\nprint(skew(data['age']))\nprint(skew(data['serum_sodium']))\nprint(skew(data['serum_creatinine']))\nprint(skew(data['platelets']))\nprint(skew(data['time'])) \nprint(skew(data['creatinine_phosphokinase'])) \nprint(skew(data['ejection_fraction'])) ","3cf09b04":"data[\"serum_creatinine\"] = np.log(data[\"serum_creatinine\"])\ndata['platelets'] = np.sqrt(data['platelets'])\ndata['creatinine_phosphokinase'] = np.log(data['creatinine_phosphokinase'])","537e5c7c":"print(skew(data['serum_creatinine']))\nprint(skew(data['platelets']))\nprint(skew(data['creatinine_phosphokinase'])) ","2403019d":"sns.countplot(data['DEATH_EVENT'])","a9d50b94":"sns.catplot(x='diabetes', y=\"age\", hue = 'DEATH_EVENT', kind=\"box\", data=data)","28754645":"sns.catplot(x='high_blood_pressure', y=\"serum_sodium\",hue = 'DEATH_EVENT', kind=\"box\", data=data)","5bb9b82f":"sns.catplot(x='diabetes', y=\"creatinine_phosphokinase\",hue = 'DEATH_EVENT', kind=\"box\", data=data)","5753633e":"sns.catplot(x='DEATH_EVENT', y=\"serum_creatinine\", kind=\"box\", data=data)","9bee2924":"sns.catplot(x='DEATH_EVENT', y=\"ejection_fraction\", kind=\"box\", data=data)","c525e273":"sns.catplot(x='high_blood_pressure', y=\"ejection_fraction\", hue=\"DEATH_EVENT\", kind=\"box\", data=data)","bafb270c":"sns.catplot(x='high_blood_pressure', y=\"serum_creatinine\",hue = 'DEATH_EVENT', kind=\"box\", data=data)","bcfc33bb":"sns.catplot(x='anaemia', y=\"age\",hue = 'DEATH_EVENT', kind=\"box\", data=data)","203e749c":"sns.catplot(x='anaemia', y=\"ejection_fraction\",hue = 'DEATH_EVENT', kind=\"box\", data=data)","9c88929e":"sns.catplot(x='smoking', y=\"ejection_fraction\",hue = 'DEATH_EVENT', kind=\"box\", data=data)","22f00901":"sns.lineplot(data= data, x='serum_creatinine',y='platelets', color='goldenrod')","6e3a6db5":"sns.lineplot(data= data, x='creatinine_phosphokinase',y='platelets', color='goldenrod')","dabaaf6e":"sns.lineplot(data= data, x='creatinine_phosphokinase',y='serum_creatinine', color='goldenrod')","6954ce6d":"data.columns","834b0fb7":"features = ['age', 'anaemia', 'creatinine_phosphokinase', 'diabetes',\n       'ejection_fraction', 'high_blood_pressure', 'platelets',\n       'serum_creatinine', 'serum_sodium', 'sex', 'smoking', 'time']\nlabel = ['DEATH_EVENT']\nX=data[features]\ny=data[label]","4359bf9a":"from sklearn.model_selection import train_test_split\nX_train,X_test, y_train,y_test=train_test_split(X,y,test_size=0.33, shuffle =True,random_state=42)","256dcc40":"features1 = ['age', 'creatinine_phosphokinase', \n       'ejection_fraction',  'platelets',\n        'serum_sodium', 'time']","336e94b6":"from sklearn.preprocessing import StandardScaler\nsc=StandardScaler()\n\nX_train = sc.fit_transform(X_train[features1])\nX_test = sc.transform(X_test[features1])","192e81a8":"from sklearn.linear_model import LogisticRegression\nlog_reg = LogisticRegression()\nlog_reg.fit(X_train,y_train)","2bc4e9e4":"y_pred_log_reg = log_reg.predict(X_test)\ny_pred_log_reg","29e71d0a":"from sklearn.metrics import f1_score, roc_auc_score,accuracy_score,confusion_matrix, precision_recall_curve, auc, roc_curve, recall_score, classification_report \nclassification_report = classification_report(y_test, y_pred_log_reg)\nprint(classification_report)","cea3f41e":"print(confusion_matrix(y_test, y_pred_log_reg))","688870b2":"auc = roc_auc_score(y_test, y_pred_log_reg)\nauc","2ec179e3":"from sklearn.ensemble import RandomForestClassifier\nrfc = RandomForestClassifier()\nrfc.fit(X_train, y_train)","1a060dc8":"rfc_predict = rfc.predict(X_test)\nroc_auc_score(y_test, rfc_predict)","40bfb81c":"cm = confusion_matrix(y_test, rfc_predict)\ncm","745166c9":"tn = cm[0,0]\nfp = cm[0,1]\ntp = cm[1,1]\nfn = cm[1,0]\naccuracy  = (tp + tn) \/ (tp + fp + tn + fn)\nprecision = tp \/ (tp + fp)\nrecall    = tp \/ (tp + fn)\nf1score  = 2 * precision * recall \/ (precision + recall)\nprint(f1score)\n","447dd456":"import xgboost as xgb\nmodel = xgb.XGBClassifier()\nmodel.fit(X_train,y_train)\ny_pred1 = model.predict(X_test)\nroc_auc_score(y_test, y_pred1)","46631ab3":"accuracy = accuracy_score(y_test, y_pred1)\nprint(accuracy)","2c5e908e":"cm = confusion_matrix(y_test, y_pred1)\ncm","46fc22c0":"tn = cm[0,0]\nfp = cm[0,1]\ntp = cm[1,1]\nfn = cm[1,0]\naccuracy  = (tp + tn) \/ (tp + fp + tn + fn)\nprecision = tp \/ (tp + fp)\nrecall    = tp \/ (tp + fn)\nf1score  = 2 * precision * recall \/ (precision + recall)\nprint(f1score)\nprint(precision)\nprint(recall)\n","95e4d5de":"from sklearn.neighbors import KNeighborsClassifier\nfrom catboost import CatBoostClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier\nimport lightgbm\nfrom sklearn.tree import DecisionTreeClassifier","379ec9b8":"dt_clf = DecisionTreeClassifier(max_leaf_nodes=3, random_state=0, criterion='entropy')\ndt_clf.fit(X_train, y_train)\ndt_pred = dt_clf.predict(X_test)\ndt_f1 = f1_score(y_test, dt_pred)\ndt_f1","90dd8390":"gradientboost_clf = GradientBoostingClassifier(max_depth=2, random_state=1)\ngradientboost_clf.fit(X_train,y_train)\ngradientboost_pred = gradientboost_clf.predict(X_test)\ngradientboost_f1 = f1_score(y_test, gradientboost_pred)\ngradientboost_f1","c29dc65c":"from sklearn.metrics import precision_score\nlgb_clf = lightgbm.LGBMClassifier(max_depth=2, random_state=4)\nlgb_clf.fit(X_train,y_train)\nlgb_pred = lgb_clf.predict(X_test)\nlgb_f1 = f1_score(y_test, lgb_pred)\nlgb_precision = precision_score(y_test, lgb_pred)\nlgb_f1","9d64b7f0":"model = lightgbm.LGBMClassifier(random_state=0)\nmodel.fit(X_train, y_train)\npreds = model.predict(X_test)\n\nprint('LightGBM f1-score', f1_score(y_test, preds))\nprint('LightGBM precision', precision_score(y_test, preds))\nprint('LightGBM recall', recall_score(y_test, preds))","c970443c":"model = xgb.XGBClassifier(random_state=666)\nmodel.fit(X_train, y_train)\npreds = model.predict(X_test)\n\nprint('XGBClassifier f1-score', f1_score(y_test, preds))\nprint('XGBClassifier precision', precision_score(y_test, preds))\nprint('XGBClassifier recall', recall_score(y_test, preds))","a6b60004":"cat_clf = CatBoostClassifier()\ncat_clf.fit(X_train,y_train)\ncat_pred = cat_clf.predict(X_test)\ncat_f1 = f1_score(y_test, cat_pred)\ncat_f1","f9844d0e":"**Creatine phosphokinase (CPK) is an enzyme in the body. It is found mainly in the heart, brain, and skeletal muscle.In diabetic patients attending our clinic, elevated CK levels occur in one-fifth of the cases. Thus it does not have much effect on target**","2c31d1fa":"**Presence of high Blood pressure affects other organs as well like kidney and increases creatinine**","f0b56b38":"So we see that skewness is removed..","9180051b":"# UNIVARIATE ANALYSIS OF CONTINUOUS VARIABLES","ef5d81c3":"**Normal ejection fraction is between 50% to 75%, so low ejection fraction leads to more death**","13682508":"**The target variable is imbalanced and we need to treat it before applying any algorithm**","07668776":"**In the provided dataset there are people with diabetes**","e9cf080b":"**From the above plots on continuous variables, we see that most of them are having binomial distribution but we need to check skewness as well because presence of skewness can affect model's performance**","c8add31a":"**There has been found strong relationship between high blood pressure and sodium level in blood in medical research. Normal range of values of serum sodium is 135 - 145(mEq\/L). Since the values provided in dataset is within the range, in the plot above we see more number of people not having high blood pressure and death event is also comparitively less.\nThus golden rule:- control Salt(Sodium) intake and protect your heart**","515e2e76":"**Let's check the target variable**","3848f9cd":"**IF A COLUMN IN THE DATASET IS SKEWED THEN IT AFFECTS THE MODEL'S PERFORMANCE AND WE MIGHT END UP WITH WRONG PREDICTIONS. SKEWNESS IS THE MEASURE OF ASSYMETRY OF PROBABILITY DISTRIBUTION OF RANDOM VARIABLE ABOUT IT'S MEAN. WE TAKE INTO ACCOUNT THE FOLLOWING POINTS:\n\nIf skewness is 0, the data are perfectly symmetrical\nIf skewness is less than -1 or greater than 1, the distribution is highly skewed.\nIf skewness is between -1 and -0.5 or between 0.5 and 1, the distribution is moderately skewed.\nIf skewness is between -0.5 and 0.5, the distribution is approximately symmetric.**","eee2068c":"**XGB CLASSIFIER**","e4627558":"**From all the models used, we see that Logistic Regression is performing the best!!**","5655154c":"# MODEL BUILDING","b11352f8":"**Both AUC score and f1 score is low as compared to Logistic regression**","9530d3e5":"**Random Forest Classifier**","1ed6d827":"**high BP though increases ejection fraction but long term effect of high BP increases chances of death as well**","83b65317":"From the above analysis following insights can be drawn:\n1. High Blood Pressure has not Much relation with increase in serum_sodium in the given dataset but research shows that high sodium level can increase BP.\n2. Smoking must be stopped as it affects ejection fraction \n3. High Levels of serum creatinine which arise due to high BP increase death**","c2c0a9f5":"# DATA LOADING AND BASIC UNDERSTANDING OF DATA","350b572d":"**There is no clear relationship between age and anaemia leading to death**","47f9b8d2":"# RELATIONSHIP BETWEEN VARIABLES","2cf689ae":"**As we can see that \"serum_creatinine\", \"platelets\" and creatinine_phosphokinase\" has values which indicate skewness, we need to treat them.**","454f5110":"**Correlation Heatmap**","16d1dab7":"As we can see that none of the features are highly correlated (not greater than 0.5) we cannot remove any columns.","59c38d2e":"**No Null values in any of the columns**","e1bb2afa":"**Smoking causes decrease in ejection fraction**","9dad5d20":"**creatinine phosphokinase increase does not alter creatinine value much as healthy kidney filters it out**","3c32c4f5":"**Anaemia can effect ejection fraction**","9f74760b":"**F1 scores show that the model is performing quite well. Moreover precision of class 1 that is prediction of positive class is high which is the most importatnt thing in this dataset. So it's good.**","25783720":"**LOGISTIC REGRESSION**","504086df":"# If you found this notebook helpful please do not forget to UPVOTE...","305713b3":"**increase in creatinine can lead to decrease in platelets**","d2316b0b":"# UNIVARIATE ANALYSIS OF CATEGORICAL VARIABLES","e9e069fc":"**APPLYING STANDARD SCALER TO VARIABLES WHICH REQURE**","96942b7b":"**Basic Statistical description of dataset:**","032cc718":"**Now let's check skewness of continuous variables:**","538fd579":"**AN AUC SCORE OF 0.786 WITH PRECISION OF AROUND 0.87 IS QUITE GOOD BUT CAN WE IMPROVE OUR MODEL? LET'S SEE**","98626f0a":"**AUC Score indicates that model is able to classify the classes well**","33f22f15":"**Elevated creatinine marks damage to kidney which in turn affects normal function of other organs. Thus Death event is more in the cases of elevated creatinine levels**"}}