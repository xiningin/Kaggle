{"cell_type":{"45e1b7c6":"code","105fb42b":"code","72276851":"code","538b1e3d":"code","056edb6a":"code","eacf5eb5":"code","64e5e7fd":"code","11ae3957":"code","ef36abaf":"code","c3bb32c0":"code","d7f2dcbe":"code","e1576e4b":"code","217a2d75":"code","cf05394c":"code","f1f5c43b":"code","24026966":"code","3a296e9f":"code","4a83060a":"code","0e29b85e":"code","aa6f6d4a":"code","c524956c":"code","d4d9e725":"code","f2e137c2":"code","926dd325":"code","a7ba03b3":"code","7f31734c":"code","f36141e0":"code","ff2afb14":"code","9326e5ae":"code","678fb27e":"code","5180be85":"code","72002acf":"code","79a4990d":"code","fdd98641":"code","aaf74626":"code","c32c923b":"code","36e56206":"code","ba4720ce":"code","e7962fa1":"code","7385e64b":"code","b0db45ca":"code","4f12ae27":"code","f3a02977":"code","6ff5e660":"code","fbe60622":"code","6926a02e":"code","fad853ec":"code","3dd8c916":"code","6d7af278":"code","e4fbd9d4":"code","249a9a50":"markdown","39b4eeeb":"markdown","e6ba8c0c":"markdown","0256a597":"markdown","182b3b10":"markdown","b98eb707":"markdown","b8b6da83":"markdown","faa3580d":"markdown","1663efc3":"markdown","58892036":"markdown","cc010fb5":"markdown","23d66759":"markdown","b2e5d39b":"markdown","3746f6f4":"markdown","d0de11b8":"markdown","d3890a14":"markdown","efe64598":"markdown","8b303b6e":"markdown","7fb22af9":"markdown","ed6e442b":"markdown","b3a85dda":"markdown"},"source":{"45e1b7c6":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sns\npd.set_option('display.max_columns', None)","105fb42b":"health =pd.read_csv('\/kaggle\/input\/fetal-health-classification\/fetal_health.csv')\nhealth.head()","72276851":"health.info()","538b1e3d":"health.describe()","056edb6a":"healthd=health.copy()\nhealthd.drop_duplicates(inplace=True)\nhealthd.shape","eacf5eb5":"health.shape","64e5e7fd":"health=healthd\ndel healthd\nhealth.head()","11ae3957":"health.shape","ef36abaf":"import pandas_profiling as pp \nprofile = pp.ProfileReport(health) \nprofile.to_file(\"EDA.html\")","c3bb32c0":"X=health.drop('fetal_health',axis=1)\ny=health['fetal_health']","d7f2dcbe":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X,y, train_size = 0.70,stratify=y,shuffle=True, random_state = 42)","e1576e4b":"X_train.info()","217a2d75":"from sklearn.ensemble import GradientBoostingClassifier\nmodel= GradientBoostingClassifier(learning_rate=0.01,random_state=42)","cf05394c":"model.fit(X_train,y_train)","f1f5c43b":"import sklearn.metrics\nscore_cbc=model.score(X_test,y_test)\nprint('Score :',score_cbc)","24026966":"sklearn.metrics.confusion_matrix(y_test,model.predict(X_test))","3a296e9f":"roc_auc_score_cbc=sklearn.metrics.roc_auc_score(y_test,model.predict_proba(X_test),multi_class='ovr')\nprint('Compute Area Under the Receiver Operating Characteristic Curve',roc_auc_score_cbc)","4a83060a":"cohen_kappa_score_cbc=sklearn.metrics.cohen_kappa_score(model.predict(X_test),y_test)\nprint('Cohen\u2019s kappa :',cohen_kappa_score_cbc)","0e29b85e":"sklearn.metrics.f1_score(y_test,model.predict(X_test),average='macro')","aa6f6d4a":"sklearn.metrics.f1_score(y_test,model.predict(X_test),average='micro')","c524956c":"sklearn.metrics.f1_score(y_test,model.predict(X_test),average='weighted')","d4d9e725":"sklearn.metrics.f1_score(y_test,model.predict(X_test),average=None)","f2e137c2":"sklearn.metrics.fbeta_score(y_test,model.predict(X_test),average='macro',beta=0.5)","926dd325":"sklearn.metrics.fbeta_score(y_test,model.predict(X_test),average='micro',beta=0.5)","a7ba03b3":"sklearn.metrics.fbeta_score(y_test,model.predict(X_test),average='weighted',beta=0.5)","7f31734c":"sklearn.metrics.fbeta_score(y_test,model.predict(X_test),average=None,beta=0.5)","f36141e0":"sklearn.metrics.hamming_loss(y_test,model.predict(X_test))","ff2afb14":"sklearn.metrics.hinge_loss(y_test,model.predict_proba(X_test))","9326e5ae":"sklearn.metrics.jaccard_score(y_test,model.predict(X_test),average='macro')","678fb27e":"sklearn.metrics.jaccard_score(y_test,model.predict(X_test),average='micro')","5180be85":"sklearn.metrics.jaccard_score(y_test,model.predict(X_test),average='weighted')","72002acf":"sklearn.metrics.jaccard_score(y_test,model.predict(X_test),average=None)","79a4990d":"sklearn.metrics.log_loss(y_test,model.predict_proba(X_test))","fdd98641":"sklearn.metrics.multilabel_confusion_matrix(y_test,model.predict(X_test))","aaf74626":"sklearn.metrics.matthews_corrcoef(y_test,model.predict(X_test))","c32c923b":"sklearn.metrics.precision_recall_fscore_support(y_test,model.predict(X_test))","36e56206":"sklearn.metrics.precision_score(y_test,model.predict(X_test),average='macro')","ba4720ce":"sklearn.metrics.precision_score(y_test,model.predict(X_test),average='micro')","e7962fa1":"sklearn.metrics.precision_score(y_test,model.predict(X_test),average='weighted')","7385e64b":"sklearn.metrics.precision_score(y_test,model.predict(X_test),average=None)","b0db45ca":"sklearn.metrics.recall_score(y_test,model.predict(X_test),average='macro')","4f12ae27":"sklearn.metrics.recall_score(y_test,model.predict(X_test),average='micro')","f3a02977":"sklearn.metrics.recall_score(y_test,model.predict(X_test),average='weighted')","6ff5e660":"sklearn.metrics.recall_score(y_test,model.predict(X_test),average=None)","fbe60622":"sklearn.metrics.zero_one_loss(y_test,model.predict(X_test))","6926a02e":"print(sklearn.metrics.classification_report(y_test,model.predict(X_test)))","fad853ec":"# predict result\nX_test['Predicted fetal_health']= model.predict(X_test)\nX_test.head()\n","3dd8c916":"plt.figure(figsize = (10,5))\nax= sns.countplot(X_test['Predicted fetal_health'])\nfor p in ax.patches:\n    ax.annotate(str(p.get_height()), (p.get_x() * 1.01 , p.get_height() * 1.01))\nplt.xticks(rotation = 45)\nax.set_yscale('log')\nplt.show()","6d7af278":"plt.figure(figsize = (10,5))\nax= sns.countplot(y_test)\nfor p in ax.patches:\n    ax.annotate(str(p.get_height()), (p.get_x() * 1.01 , p.get_height() * 1.01))\nplt.xticks(rotation = 45)\nax.set_yscale('log')\nplt.show()","e4fbd9d4":"X_test['Predicted fetal_health'].value_counts(),y_test.value_counts()","249a9a50":"# Cohen Kappa Score","39b4eeeb":"# EDA ","e6ba8c0c":"# Zero-One Loss","0256a597":"# Multi-Label Confusion Matrix","182b3b10":"# Hinge Loss","b98eb707":"# Duplicate Check","b8b6da83":"# Recall Score","faa3580d":"# Precision Score","1663efc3":"# Score","58892036":"Duplicate Found!!","cc010fb5":"# Matthews Corrcoef","23d66759":"# Visualize the results ","b2e5d39b":"# Log Loss","3746f6f4":"# Jaccard Score","d0de11b8":"# ROC AUC Score","d3890a14":"# Precision, Recall, FScore & Support","efe64598":"# Classification Report","8b303b6e":"# F1 Score","7fb22af9":"# Confusion Matrix","ed6e442b":"# F Score Beta","b3a85dda":"# Hamming Loss"}}