{"cell_type":{"2811687d":"code","90af1d76":"code","7a93f05f":"code","245b5802":"code","690999c0":"code","c163b236":"code","d0147454":"code","494263f1":"code","cfb4eb5f":"code","a72d3842":"code","73a13890":"code","dce10a0c":"code","0be64eea":"code","fa3482f4":"code","0654ee80":"code","7efd2d0e":"code","36ab8fd6":"code","7a5b31ae":"code","a0b46aba":"code","7bd3480c":"code","d67dec88":"code","4c231f79":"code","90850eb2":"code","48d97640":"code","059d5e7a":"code","bd481f2f":"code","4d330fc3":"code","358a5e99":"code","1fa2a8e3":"code","f11c6204":"code","918418ac":"code","baf374c0":"code","bdf10cdf":"code","7778ac70":"code","89fb1618":"code","de700ca4":"code","b654af09":"code","14249f42":"code","e54f4219":"markdown","103bdcb0":"markdown","929945fe":"markdown","1da8bd42":"markdown","99b7465e":"markdown"},"source":{"2811687d":"import numpy as np\nimport pandas as pd","90af1d76":"water = pd.read_csv(\n    '..\/input\/sanitation-and-water-global-indexes\/SanitationAndWaterGlobalIndexes\/RawData\/Basic and safely managed drinking water services.csv'\n)","7a93f05f":"water.head(2)","245b5802":"water.shape","690999c0":"water.columns","c163b236":"water.isnull().sum()","d0147454":"def parse_who_data(df):\n    df = df.loc[:, [\n        'GHO (DISPLAY)',\n        'YEAR (DISPLAY)',\n        'REGION (DISPLAY)',\n        'COUNTRY (CODE)',\n        'COUNTRY (DISPLAY)',\n        'RESIDENCEAREATYPE (DISPLAY)',\n        'Numeric'\n    ]]\n    \n    df['Index'] = df['GHO (DISPLAY)'] + ' - ' + df['RESIDENCEAREATYPE (DISPLAY)']\n    \n    df = df.drop(columns=[\n        'GHO (DISPLAY)',\n        'RESIDENCEAREATYPE (DISPLAY)'\n    ])\n\n    df = df.rename(columns={\n        'YEAR (DISPLAY)':'Year',\n        'REGION (DISPLAY)':'Region',\n        'COUNTRY (CODE)':'Country code',\n        'COUNTRY (DISPLAY)':'Country',\n        'Numeric':'Value'\n    })\n    \n    df = df.pivot_table(index = ['Year', 'Region', 'Country code', 'Country'], columns='Index', values='Value').reset_index()\n    df.columns = df.columns.rename('')\n    \n    return df","494263f1":"water = parse_who_data(water)","cfb4eb5f":"water.head()","a72d3842":"sanitation = pd.read_csv(\n    '..\/input\/sanitation-and-water-global-indexes\/SanitationAndWaterGlobalIndexes\/RawData\/Basic and safely managed sanitation services.csv'\n)","73a13890":"sanitation.shape","dce10a0c":"sanitation.head(2)","0be64eea":"sanitation.columns","fa3482f4":"sanitation.isnull().sum()","0654ee80":"sanitation = parse_who_data(sanitation)","7efd2d0e":"sanitation.head()","36ab8fd6":"hand = pd.read_csv(\n    '..\/input\/sanitation-and-water-global-indexes\/SanitationAndWaterGlobalIndexes\/RawData\/Handwashing with soap.csv'\n)","7a5b31ae":"hand.shape","a0b46aba":"hand.head(2)","7bd3480c":"hand.columns","d67dec88":"hand.isnull().sum()","4c231f79":"hand = parse_who_data(hand)","90850eb2":"hand.head()","48d97640":"defec = pd.read_csv(\n    '..\/input\/sanitation-and-water-global-indexes\/SanitationAndWaterGlobalIndexes\/RawData\/Open defecation.csv'\n)","059d5e7a":"defec.shape","bd481f2f":"defec.head(2)","4d330fc3":"defec.columns","358a5e99":"defec.isnull().sum()","1fa2a8e3":"defec = parse_who_data(defec)","f11c6204":"defec.head()","918418ac":"water.shape","baf374c0":"sanitation.shape","bdf10cdf":"hand.shape","7778ac70":"defec.shape","89fb1618":"join_columns = ['Year', 'Region', 'Country code', 'Country']\nmetrics = water.merge(sanitation, how='outer', left_on=join_columns, right_on=join_columns)\nmetrics = metrics.merge(hand, how='outer', left_on=join_columns, right_on=join_columns)\nmetrics = metrics.merge(defec, how='outer', left_on=join_columns, right_on=join_columns)","de700ca4":"metrics.shape","b654af09":"metrics.head()","14249f42":"metrics.to_csv('\/kaggle\/working\/indexes.csv', index=False)","e54f4219":"# Handwashing","103bdcb0":"# Sanitation","929945fe":"# Parsing Water data","1da8bd42":"# Joining tables","99b7465e":"# Open defecation"}}