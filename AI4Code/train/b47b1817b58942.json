{"cell_type":{"e441fa3c":"code","b7e1ad32":"code","3dda357d":"code","3349087b":"code","5c899d30":"code","adf417b0":"code","80fd5b4e":"code","9ea1ddd9":"code","8c32f0b8":"code","8c0ee5a7":"code","623d68f5":"code","908c5ef5":"code","d9ed9928":"code","f4bedcb9":"code","12d7fcbf":"code","b4f62c18":"code","01312ad5":"code","f0bcae2c":"code","e21045a8":"code","2cd4798a":"code","714a636c":"code","b7f52bf8":"code","c9e6a537":"code","375a12aa":"code","c90c533d":"code","f426a9f3":"code","73311776":"code","66953ffb":"code","97ad8114":"code","e329aac1":"markdown","17a72692":"markdown","6253a1d3":"markdown","1e3f321d":"markdown","6ef4964a":"markdown","aa772bde":"markdown"},"source":{"e441fa3c":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","b7e1ad32":"df=pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","3dda357d":"df.head()","3349087b":"df.info()","5c899d30":"df.describe()","adf417b0":"df.columns","80fd5b4e":"sns.countplot(x='Gender',data=df)\nprint(df['Gender'].value_counts())","9ea1ddd9":"df.groupby('Gender')['Age'].mean().plot(kind='bar')","8c32f0b8":"df.groupby('Gender')['Annual Income (k$)'].mean().plot(kind='bar')","8c0ee5a7":"df.groupby('Gender')['Spending Score (1-100)'].mean().plot(kind='bar')","623d68f5":"# creating a new dataframe(df01) to do modelling on it\n# our aim is to keep it original dataset untouched\ndf01=df[['Gender', 'Age', 'Annual Income (k$)','Spending Score (1-100)']]","908c5ef5":"df01.head()","d9ed9928":"from sklearn import preprocessing","f4bedcb9":"label_encoder=preprocessing.LabelEncoder()","12d7fcbf":"df01.Gender= label_encoder.fit_transform(df01.Gender)","b4f62c18":"df01.head()","01312ad5":"from sklearn.preprocessing import MinMaxScaler\nfrom sklearn.cluster import KMeans\nfrom sklearn.metrics import silhouette_score","f0bcae2c":"scaler=MinMaxScaler()","e21045a8":"df01.columns","2cd4798a":"var= ['Gender', 'Age', 'Annual Income (k$)', 'Spending Score (1-100)']","714a636c":"df01[var]=scaler.fit_transform(df01[var])","b7f52bf8":"df01.head()","c9e6a537":"#finding optimal no of clusters using silhouette score\nrange_n_clusters = [2, 3, 4, 5, 6, 7]\nfor num_clusters in range_n_clusters:\n    \n    # intialise kmeans\n    kmeans = KMeans(n_clusters=num_clusters, max_iter=50)\n    kmeans.fit(df01)\n    \n    cluster_labels = kmeans.labels_\n    \n    # silhouette score\n    silhouette_avg = silhouette_score(df01, cluster_labels)\n    print(\"For n_clusters={0}, the silhouette score is {1}\".format(num_clusters, silhouette_avg))","375a12aa":"# we will go with n_clusters=3\nkmeans=KMeans(n_clusters=3, max_iter=50)\nkmeans.fit(df01)","c90c533d":"df['cluster']= kmeans.labels_","f426a9f3":"df.head()","73311776":"sns.boxplot(x='cluster',y='Age', data=df)","66953ffb":"sns.boxplot(x='cluster',y='Annual Income (k$)', data=df)","97ad8114":"sns.boxplot(x='cluster',y='Spending Score (1-100)', data=df)","e329aac1":"##### More no of Females are coming to the Mall","17a72692":"##### Average Annual Income of Males are more than Females","6253a1d3":"## Model Building","1e3f321d":"### EDA on cluster","6ef4964a":"##### Average age of Males are slightly higher than Females","aa772bde":"##### Average Spending score of Females are more than Males"}}