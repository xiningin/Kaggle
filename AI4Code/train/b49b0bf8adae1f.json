{"cell_type":{"f6d82a4c":"code","1f4ccd56":"code","6a907e82":"code","dd4a5fa8":"code","21f319e3":"code","4739380c":"code","b95953e6":"code","c656a370":"code","24130738":"code","b76b1e0f":"code","823619b8":"code","32cf11d4":"code","a01cd93d":"code","a98e5db9":"markdown","02ad3192":"markdown","7ffb7982":"markdown","a2800e98":"markdown","f3a3f72f":"markdown","83530494":"markdown","76099f54":"markdown"},"source":{"f6d82a4c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","1f4ccd56":"train_df = pd.read_csv('\/kaggle\/input\/1056lab-airbnb-price-predction\/train.csv', index_col=0)\ntrain_df","6a907e82":"test_df = pd.read_csv('\/kaggle\/input\/1056lab-airbnb-price-predction\/test.csv', index_col=0)\ntest_df","dd4a5fa8":"df = pd.concat([train_df.drop('price', axis=1), test_df])\ndf","21f319e3":"df = pd.concat([df, pd.get_dummies(df['neighbourhood_group'])], axis=1)\ndf = df.drop('neighbourhood_group', axis=1)\ndf","4739380c":"df = pd.concat([df, pd.get_dummies(df['neighbourhood'])], axis=1)\ndf = df.drop('neighbourhood', axis=1)\ndf","b95953e6":"df = pd.concat([df, pd.get_dummies(df['room_type'])], axis=1)\ndf = df.drop('room_type', axis=1)\ndf","c656a370":"df = df.drop(['name', 'host_id', 'host_name', 'last_review', 'reviews_per_month'], axis=1)\ndf","24130738":"nrow, ncol = train_df.shape\nprice_df = train_df[['price']]\ntrain_df = df[:nrow]\ntrain_df = pd.concat([train_df, price_df], axis=1)\ntrain_df","b76b1e0f":"nrow, ncol = train_df.shape\ntest_df = df[nrow:]\ntest_df","823619b8":"from sklearn.linear_model import LinearRegression\n\nX = train_df.drop(['price'], axis=1).to_numpy()\ny = train_df['price'].to_numpy()\n\nmodel = LinearRegression()\nmodel.fit(X, y)","32cf11d4":"X = test_df.to_numpy()\n\np = model.predict(X)","a01cd93d":"submit_df = pd.read_csv('\/kaggle\/input\/1056lab-airbnb-price-predction\/sampleSubmission.csv')\nsubmit_df['price'] = p\nsubmit_df.to_csv('submission.csv', index=False)","a98e5db9":"# Learning a model and predicting","02ad3192":"# Preprocessing","7ffb7982":"# Reading the data","a2800e98":"Selecting features","f3a3f72f":"Splitting into training and test.","83530494":"Concatinating the traing data without `price` and the test data in order to preprocess.","76099f54":"Making dummy variables."}}