{"cell_type":{"e4e7a205":"code","47a16b86":"code","469f7311":"code","a6afd98c":"code","e396c07c":"code","bb2635de":"code","d3e36118":"code","54db8539":"code","715dc455":"code","0f48881f":"code","11cf4081":"code","4a084a91":"code","51f599bd":"code","5878ca8d":"code","c1083bab":"code","ef83fca1":"code","0c858443":"code","3ef1b31d":"code","031afdb4":"code","e5079b6e":"code","21ad787e":"code","c1b4d0e6":"code","ba0fc83b":"code","48ed392f":"code","8d5eeae9":"code","220fbe6d":"code","7890573a":"code","41419aea":"code","ecaebb44":"code","b98f4650":"code","3427aee8":"code","1f8c6b04":"code","18c1f91d":"code","ef1823a5":"code","56c4485c":"code","8d8a9d11":"code","6a3a7978":"code","6ee0b43e":"code","efa51e3c":"code","75db9506":"code","eda3854f":"code","f6d21f4c":"code","e3f1f43f":"code","bf320108":"code","721f5a5b":"code","a5413fc4":"code","45c221ad":"code","d0dbec74":"code","0fe30430":"markdown","cc1ddb54":"markdown"},"source":{"e4e7a205":"import numpy as np\nimport matplotlib.pyplot as plt\nimport keras\nfrom keras.layers import *\nfrom keras.models import * \nfrom keras.preprocessing import image","47a16b86":"TRAIN_PATH = \"..\/input\/chest-xray-pneumonia\/chest_xray\/train\"\nVAL_PATH = \"..\/input\/chest-xray-pneumonia\/chest_xray\/val\"","469f7311":"model = Sequential()\nmodel.add(Conv2D(32,kernel_size=(3,3), activation='relu', input_shape=(224,224,3)))\nmodel.add(Conv2D(64,kernel_size=(3,3), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2,2)))\nmodel.add(Dropout(0.25))\n\n\nmodel.add(Conv2D(64,kernel_size=(3,3), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2,2)))\nmodel.add(Dropout(0.25))\n\nmodel.add(Conv2D(128,kernel_size=(3,3), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2,2)))\nmodel.add(Dropout(0.25))\n\nmodel.add(Flatten())\nmodel.add(Dense(64,activation = 'relu'))\nmodel.add(Dropout(0.25))\nmodel.add(Dense(1, activation=\"sigmoid\"))\n\nmodel.compile(loss = keras.losses.binary_crossentropy, optimizer='adam', metrics=['accuracy'])","a6afd98c":"model.summary()","e396c07c":"train_datagen = image.ImageDataGenerator(\n    rescale = 1.\/255,\n    shear_range = 0.2,\n    zoom_range = 0.2,\n    horizontal_flip = True,\n)\n\ntest_dataset = image.ImageDataGenerator(rescale=1.\/255)","bb2635de":"train_gen = train_datagen.flow_from_directory(\n     \"..\/input\/covid-dataset\/CovidDataset\/Train\",\n    target_size = (224,224),\n    batch_size = 32,\n    class_mode = 'binary',\n)","d3e36118":"train_gen.class_indices","54db8539":"validation_gen = test_dataset.flow_from_directory(\n    '..\/input\/covid-dataset\/CovidDataset\/Val',\n    target_size = (224,224),\n    batch_size = 32,\n    class_mode = 'binary',\n)","715dc455":"validation_gen.class_indices","0f48881f":"hist = model.fit_generator(\n    train_gen,\n    steps_per_epoch = 8,\n    validation_data = validation_gen,\n    validation_steps = 2,\n    epochs = 10\n)","11cf4081":"model.save(\"model_adv.h5\")","4a084a91":"model.evaluate_generator(train_gen)","51f599bd":"model.evaluate_generator(validation_gen)","5878ca8d":"plt.plot(hist.history['accuracy'])\nplt.plot(hist.history['val_accuracy'])\nplt.title('model accuracy')\nplt.ylabel('accuracy')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'], loc='best')\nplt.show()","c1083bab":"model = load_model('model_adv.h5')","ef83fca1":"import os","0c858443":"train_gen.class_indices","3ef1b31d":"y_actual = []\ny_test = []","031afdb4":"for i in os.listdir('..\/input\/covid-dataset\/CovidDataset\/Val\/Normal'):\n  img = image.load_img('..\/input\/covid-dataset\/CovidDataset\/Val\/Normal\/'+i, target_size=(224,224))\n  img = image.img_to_array(img)\n  img = np.expand_dims(img, axis=0)\n  p = model.predict_classes(img)\n  y_test.append(p[0,0])\n  y_actual.append(1)","e5079b6e":"for i in os.listdir('..\/input\/covid-dataset\/CovidDataset\/Val\/Covid'):\n  img = image.load_img('..\/input\/covid-dataset\/CovidDataset\/Val\/Covid\/'+i, target_size=(224,224))\n  img = image.img_to_array(img)\n  img = np.expand_dims(img, axis=0)\n  p = model.predict_classes(img)\n  y_test.append(p[0,0])\n  y_actual.append(0)","21ad787e":"y_actual = np.array(y_actual)\ny_test = np.array(y_test)","c1b4d0e6":"y_actual, y_test","ba0fc83b":"from sklearn.metrics import confusion_matrix","48ed392f":"cm = confusion_matrix(y_actual, y_test)","8d5eeae9":"import seaborn as sns","220fbe6d":"sns.heatmap(cm, cmap=\"plasma\", annot=True)","7890573a":"train_datagen = image.ImageDataGenerator(\n    rescale = 1.\/255,\n    shear_range = 0.2,\n    zoom_range = 0.2,\n    horizontal_flip = True,\n)\n\ntest_dataset = image.ImageDataGenerator(rescale=1.\/255)","41419aea":"train_gen = train_datagen.flow_from_directory(\n    '..\/input\/covid-dataset\/CovidDataset\/Train',\n    target_size = (224,224),\n    batch_size = 32,\n    class_mode = 'binary',\n    subset='training'\n)","ecaebb44":"train_gen.class_indices","b98f4650":"ieee_gen = test_dataset.flow_from_directory(\n    '..\/input\/ieeeimagedataset\/datasetcovid19\/',\n    target_size = (224,224),\n    batch_size = 32,\n    class_mode = 'binary',\n)","3427aee8":"ieee_gen.class_indices","1f8c6b04":"hist = model.fit_generator(\n    train_gen,\n    steps_per_epoch = 6,\n    validation_data = ieee_gen,\n    validation_steps = 2,\n    epochs = 5,\n)","18c1f91d":"model.save(\"model_adv.h5\")","ef1823a5":"model.evaluate_generator(train_gen)","56c4485c":"model.evaluate_generator(ieee_gen)","8d8a9d11":"plt.plot(hist.history['accuracy'])\nplt.plot(hist.history['val_accuracy'])\nplt.title('model accuracy')\nplt.ylabel('accuracy')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'], loc='best')\nplt.show()","6a3a7978":"model = load_model('model_adv.h5')","6ee0b43e":"import os","efa51e3c":"train_gen.class_indices","75db9506":"y_actual = []\ny_test = []","eda3854f":"for i in os.listdir('..\/input\/ieeeimagedataset\/datasetcovid19\/Normal'):\n  img = image.load_img('..\/input\/ieeeimagedataset\/datasetcovid19\/Normal\/'+i, target_size=(224,224))\n  img = image.img_to_array(img)\n  img = np.expand_dims(img, axis=0)\n  p = model.predict_classes(img)\n  y_test.append(p[0,0])\n  y_actual.append(1)","f6d21f4c":"for i in os.listdir('..\/input\/ieeeimagedataset\/datasetcovid19\/Covid'):\n  img = image.load_img('..\/input\/ieeeimagedataset\/datasetcovid19\/Covid\/'+i, target_size=(224,224))\n  img = image.img_to_array(img)\n  img = np.expand_dims(img, axis=0)\n  p = model.predict_classes(img)\n  y_test.append(p[0,0])\n  y_actual.append(0)","e3f1f43f":"y_actual = np.array(y_actual)\ny_test = np.array(y_test)","bf320108":"y_actual, y_test","721f5a5b":"from sklearn.metrics import confusion_matrix","a5413fc4":"cm = confusion_matrix(y_actual, y_test)","45c221ad":"import seaborn as sns","d0dbec74":"sns.heatmap(cm, cmap=\"plasma\", annot=True)","0fe30430":"Comparing with IEEE Dataset from https:\/\/github.com\/ieee8023\/covid-chestxray-dataset repo","cc1ddb54":"# Main Comparison"}}