{"cell_type":{"a89cb092":"code","5671597a":"code","84649277":"code","c21cdd52":"code","ea439f0a":"code","029c78e2":"code","0c18bfd1":"code","d5c0ddf8":"code","7f92cdb2":"code","a5886a21":"code","add92b5c":"code","9b34f6e3":"code","589d9bd7":"code","e9a55f73":"code","fa34ac3e":"code","1c66371c":"markdown","6276c948":"markdown","6c9acffd":"markdown","88ebf3f9":"markdown","717fb56d":"markdown","24800f78":"markdown","cc93454a":"markdown","4a07c6cb":"markdown","24bb51c6":"markdown"},"source":{"a89cb092":"from fastai.vision import *\nfrom fastai.metrics import error_rate","5671597a":"cp -r \/kaggle\/input\/fruits-360_dataset\/ \/tmp","84649277":"path= '\/tmp\/fruits-360_dataset\/fruits-360\/'","c21cdd52":"test_folder='\/tmp\/fruits-360_dataset\/fruits-360\/Test'","ea439f0a":"src = (ImageList.from_folder(path)\n       .split_by_rand_pct(valid_pct=0.2)\n       .label_from_folder()\n       .transform(get_transforms(), size=256)\n       .add_test_folder(test_folder))","029c78e2":"data = (src.databunch(bs=32)\n        .normalize(imagenet_stats))\n\ndata.show_batch(rows=3,figsize=(8,8))","0c18bfd1":"learner34=cnn_learner(data,models.resnet34,metrics=accuracy)","d5c0ddf8":"learner34.fit_one_cycle(4)","7f92cdb2":"learner50=cnn_learner(data,models.resnet50,metrics=accuracy)","a5886a21":"learner50.lr_find()\nlearner50.recorder.plot()","add92b5c":"lr=1e-2","9b34f6e3":"learner50.fit_one_cycle(4,slice(lr))","589d9bd7":"interp=ClassificationInterpretation.from_learner(learner50)\ninterp.plot_top_losses(9,figsize=(12,12))","e9a55f73":"interp.most_confused(min_val=1)","fa34ac3e":"learner50.export(\"\/kaggle\/working\/fruitsmodel.pkl\")","1c66371c":"Hi, I tried out the fruits dataset with fastai.vision library. And the results are pretty good with 99.98% accuracy.","6276c948":"Thank you for sticking around.","6c9acffd":"We have choose a maximum learning rate where the curve is most steep. So I've chosen 0.01 for this. Our CNN uses discriminative learning rate, so our max learning rate will be 0.01.","88ebf3f9":"Results are quite good.\n\nNow let's see which cases we failed.","717fb56d":"Let's find our learning rate for resnet50 first. It's always a good idea to pass the learning rate while fitting.","24800f78":"99% Accuracy using resnet34 is great. We might be able to increase our accuracy even more with resent50.\nLet's try that!","cc93454a":"Now let's create our learner. I'm using resnet34 for now with accuracy as metric.\nResnet34 trains faster so let's go with that.","4a07c6cb":"Current dataset directory is read-only; we might need to modify some training set data.\nMoving to \/tmp gives us Write permission on the folder.","24bb51c6":"Creating our databunch object. Fortunately this dataset uses imagenet style, so our factory method will suffice. We can experiment using different size values, I have found 224 to be optimal.\n\nFastai vision models are pretrained models on Imagenet. We are essentially using transfer learning here. So we should normalize our dateset using imagenet statistics as well."}}