{"cell_type":{"c4aeb00e":"code","56c4d534":"code","4ebe1268":"code","2f84fbad":"code","ef4bd498":"code","7af53f67":"code","dd70a27a":"code","a5220179":"code","1808b945":"code","fc754a2d":"code","a9b488ab":"code","3115a7e0":"code","b83a4103":"code","73af8e6c":"code","887133e5":"markdown"},"source":{"c4aeb00e":"import os\nimport numpy as np\nimport pandas as pd\nimport fastai.vision as fa\nfrom fastai.metrics import error_rate\nimport matplotlib.pyplot as plt\nfrom matplotlib import animation,rc","56c4d534":"n=100","4ebe1268":"# \u521d\u59cb\u5316\nx=fa.torch.ones(n,2)\nx[:,0].uniform_(-1,1)\nx[:5]","2f84fbad":"a=fa.tensor(3.,2.)   # \u8fd9\u91cc\u7684tensor\u5fc5\u987b\u8981\u662ffloat\u578b\ny=x@a+fa.torch.rand(n)  # \u6211\u4eec\u4ea7\u751fy\u7684\u6570\u636e\uff0c\u5e76\u968f\u673a\u589e\u52a0\u4e00\u4e9b\u566a\u97f3","ef4bd498":"# \u753b\u56fe\nplt.scatter(x[:,0],y)","7af53f67":"# \u5b9a\u4e49loss function\ndef mse(y,y_hat):\n    return ((y_hat-y)**2).mean()","dd70a27a":"# \u968f\u673a\u521d\u59cb\u5316\u4e00\u4e2aa\na=fa.tensor(-1.,1.)\ny_hat=x@a","a5220179":"# \u8ba1\u7b97\u635f\u5931\nmse(y,y_hat)","1808b945":"# \u753b\u56fe\nplt.scatter(x[:,0],y)\nplt.scatter(x[:,0],y_hat)","fc754a2d":"# \u968f\u673a\u68af\u5ea6\u4e0b\u964d\na=fa.nn.Parameter(a)\na  # \u5c06a\u8d4b\u503c\u7ed9\u6a21\u578b\u53c2\u6570\uff0c\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u505aa\u7684\u68af\u5ea6\u8ba1\u7b97","a9b488ab":"def update():\n    y_hat=x@a\n    loss=mse(y,y_hat)\n    if t % 10==0: print(loss)\n    loss.backward()\n    with fa.torch.no_grad():\n        a.sub_(lr*a.grad)\n        a.grad.zero_()","3115a7e0":"# \u8fdb\u884c\u68af\u5ea6\u4e0b\u964d\nfrom tqdm import tqdm\nlr=1e-1\nfor t in tqdm(range(100)):\n    update()","b83a4103":"# \u753b\u56fe\nplt.scatter(x[:,0],y)\nplt.scatter(x[:,0],x@a)","73af8e6c":"# \u7ed8\u5236\u52a8\u56fe\na=fa.nn.Parameter(fa.tensor(-1.,1))\n\nfig=plt.figure()\nplt.scatter(x[:,0],y,c=\"orange\")\nline,=plt.plot(x[:,0],x@a)\nplt.close()\n\ndef animate(i):\n    update()\n    line.set_ydata(x@a)\n    return line,\nanimation.FuncAnimation(fig,animate,np.arange(0,100),interval=20)","887133e5":"# \u7ebf\u6027\u56de\u5f52\u95ee\u9898"}}