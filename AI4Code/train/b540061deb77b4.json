{"cell_type":{"ee0a2e9a":"code","4a56defa":"code","5f0435e2":"code","dcd1c0b6":"code","44ef7cf0":"code","7b6f3bef":"code","ccaf8152":"code","7dfce341":"code","ba38cb40":"code","e49192b1":"code","5e5eede8":"code","68b52abd":"code","48baf5a7":"code","509a7804":"code","4ccdcf37":"code","cb535270":"code","fd6d436a":"code","156c1cfd":"code","93585d8d":"code","306fb833":"code","fd62fa47":"code","8d3301a4":"code","e7c5e5b3":"code","010c8363":"code","35847af6":"code","d89b1477":"code","d68b8ce9":"code","487d0619":"code","50b9b356":"code","b770b81f":"code","cc9dc07f":"code","e3caaabd":"code","f765a760":"markdown","90f2eab9":"markdown","d0eaa71e":"markdown","77724cff":"markdown"},"source":{"ee0a2e9a":"import numpy  as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.graph_objects as go\nimport plotly.express as px\n\n\nplt.style.use(\"ggplot\")","4a56defa":"df = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","5f0435e2":"df.head()","dcd1c0b6":"df.info()","44ef7cf0":"df['CustomerID'] = df['CustomerID'].astype(str)","7b6f3bef":"count_gender = df['Gender'].value_counts()","ccaf8152":"dis_gender = go.Bar(\n    x = count_gender.index,\n    y = count_gender.values,\n)\nfig = go.Figure(dis_gender)\nfig.update_traces(marker_color='#8D2828', opacity=.6)\n\nfig.update_layout(title_text=\"A Figure Displaying Gender\")\nfig.show()","7dfce341":"count_age = df['Age'].value_counts()","ba38cb40":"dis_age = go.Bar(\n    x = count_age.index,\n    y = count_age.values\n)\n\nfig = go.Figure(dis_age)\nfig.update_traces(marker_color='#E1701A', opacity=.8)\nfig.update_layout(title_text='A Figure Displaying Age')\nfig.show()","e49192b1":"df.head()","5e5eede8":"sns.displot(x=df['Spending Score (1-100)'].values, palette=['#362222','#8D2828'], kind='kde', hue=df['Gender'],aspect=2)\n\nplt.title(\"Spending Score of Male vs Female\", fontsize=18)\nplt.show()","68b52abd":"plt.figure(figsize=(5,6))\nsns.displot(x=df['Annual Income (k$)'].values, palette=['#362222','#8D2828'], kind='kde', hue=df['Gender'],aspect=2)\n\nplt.title('Annual Income of Male vs Female', fontsize=18)\nplt.show()","48baf5a7":"dis_age = go.Box(\n    y = df['Spending Score (1-100)'],\n    name ='Spending Score'\n)\n\nfig = go.Figure(dis_age)\nfig.update_traces(marker_color='#171717', opacity=.8)\nfig.update_layout(title_text='A Figure Displaying Spending Score')\nfig.show()","509a7804":"dis_age = go.Box(\n    y = df['Annual Income (k$)'],\n    name='Annual Income'\n)\n\nfig = go.Figure(dis_age)\nfig.update_traces(marker_color='#171717', opacity=.8)\nfig.update_layout(title_text='A Figure Displaying Annual Income')\nfig.show()","4ccdcf37":"fig = px.scatter(x = df['Annual Income (k$)'],y = df['Spending Score (1-100)'], color=df['Gender'], title=\"Annual Income vs Spending Score\")\nfig.show()","cb535270":"fig = px.scatter_3d(x = df['Annual Income (k$)'],y = df['Spending Score (1-100)'], z=df['Age'], color=df['Gender'], title='Annual Income vs Spending Score with Age')\nfig.show()","fd6d436a":"from sklearn.model_selection import train_test_split\nfrom sklearn.cluster        import KMeans , MiniBatchKMeans","156c1cfd":"X = df.iloc[:,-2:].values","93585d8d":"X_train, X_test = train_test_split(X, random_state=42, test_size=.2)","306fb833":"elbow = []\nfor i in range(1,11):\n    k_means = KMeans(n_clusters=i)\n    k_means.fit(X_train)\n    elbow.append(k_means.inertia_)","fd62fa47":"plt.figure(figsize=(9,5))\n\nplt.plot(range(1,11), elbow)\n\nplt.title(\"Elbow\", fontsize=20)\n\nplt.xticks(fontsize=15)\nplt.yticks(fontsize=15)\nplt.show()","8d3301a4":"k_means = KMeans(n_clusters=6, random_state=42, init='k-means++',)","e7c5e5b3":"k_means.fit(X_train)","010c8363":"print(\"Inertia  :\", k_means.inertia_)","35847af6":"X_predict = k_means.predict(X_test)","d89b1477":"X_test[X_predict==0,0]","d68b8ce9":"plt.figure(figsize=(11,5))\n\nplt.scatter(X_test[X_predict==0,0], X_test[X_predict==0,1], color='red', linewidths=3)\nplt.scatter(X_test[X_predict==1,0], X_test[X_predict==1,1], color='b', linewidths=3)\nplt.scatter(X_test[X_predict==2,0], X_test[X_predict==2,1], color='y', linewidths=3)\nplt.scatter(X_test[X_predict==3,0], X_test[X_predict==3,1], color='black', linewidths=3)\nplt.scatter(X_test[X_predict==4,0], X_test[X_predict==4,1], color='green', linewidths=3)\nplt.scatter(X_test[X_predict==5,0], X_test[X_predict==5,1], color='orange', linewidths=3)\n\nplt.scatter(k_means.cluster_centers_[:,0] , k_means.cluster_centers_[:,1], color='#39A2DB', linewidths=10)\n\nplt.title(\"Clusters\", fontsize=20)\n\nplt.xticks(fontsize=15)\nplt.yticks(fontsize=15)\n\nplt.show()","487d0619":"elbow = []\nfor i in range(1,11):\n    k_means = MiniBatchKMeans(n_clusters=i)\n    k_means.fit(X_train)\n    elbow.append(k_means.inertia_)","50b9b356":"plt.figure(figsize=(9,5))\n\nplt.plot(range(1,11), elbow, color='green')\n\nplt.title(\"Elbow\", fontsize=20)\n\nplt.xticks(fontsize=15)\nplt.yticks(fontsize=15)\nplt.show()","b770b81f":"k_means = MiniBatchKMeans(n_clusters=6, random_state=42, init='k-means++',)","cc9dc07f":"k_means.fit(X_train)","e3caaabd":"print(\"Inertia  :\", k_means.inertia_)","f765a760":"___________\n\n# Build Model","90f2eab9":"<h3 style='color:purple'> if you liked it Please upvote it. thanks :) <\/h3>\n\n# EDA","d0eaa71e":"<div style=\"width:95%;margin:auto\">\n<h1 style=\"margin:auto\">\n    Mall Customer Segmentation\n<\/h1>\n\n<img src=\"https:\/\/master-engineers.com\/wp-content\/uploads\/2020\/12\/malls.jpg\" \/>\n    \n<\/div>","77724cff":"________\n\n# MiniBatchKMeans"}}