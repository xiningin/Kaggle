{"cell_type":{"c0e92f71":"code","458c0ae0":"code","d154b00b":"code","2612e590":"code","c537f411":"code","4d0e87a0":"code","c07a7a2f":"code","72a65438":"code","0843bf1a":"code","3df3d66c":"code","59503a8b":"code","ea4053bf":"code","9628a664":"code","b908262a":"code","eff17122":"code","59281e4a":"code","a9f9366d":"code","fe00c825":"code","07e39e7d":"code","1903550c":"code","c5b16419":"code","3d6ff289":"code","6b88d96a":"code","617bfea9":"code","ed4824b2":"code","4c76f8ee":"code","197fb2bb":"code","9d58028a":"code","d59ecbb1":"code","28e2a94d":"code","5e936e57":"code","4180fd08":"code","3f727d4c":"code","d2da7c16":"code","5b453518":"code","6e2c403a":"code","40f3547f":"code","aa4924a3":"code","10c77a6b":"code","488da36c":"code","10764154":"code","2cefd57d":"code","94238b98":"code","703e6cd7":"code","a8ebd0be":"code","ac599b2a":"code","e54b9c18":"code","468abfbe":"markdown","43eb0c36":"markdown","1cce07f8":"markdown","bc430690":"markdown","174e0641":"markdown","f46eefb3":"markdown","b9386989":"markdown"},"source":{"c0e92f71":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport pickle\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.ensemble import RandomForestRegressor","458c0ae0":"df = pd.read_csv('..\/input\/used-bikes-prices-in-india\/Used_Bikes.csv')","d154b00b":"df.head()","2612e590":"df.isnull().sum()","c537f411":"df.city.nunique()","4d0e87a0":"df.shape","c07a7a2f":"df.bike_name.nunique()","72a65438":"df.describe()","0843bf1a":"df.drop(['bike_name','city'],axis=1,inplace=True)","3df3d66c":"df.corr().loc['price']","59503a8b":"df.info()","ea4053bf":"df.owner.unique()","9628a664":"sns.distplot(df.kms_driven,kde=True,bins=10)","b908262a":"sns.distplot(df.age,kde=True,bins=10)","eff17122":"df_cleaned = df.copy()","59281e4a":"df_cleaned = df_cleaned[-(df_cleaned.age > df_cleaned.age.quantile(0.99))]","a9f9366d":"sns.distplot(df_cleaned.age,bins=12,kde=True)","fe00c825":"df_cleaned = df_cleaned[df_cleaned.kms_driven < df_cleaned.kms_driven.quantile(0.99)]","07e39e7d":"sns.distplot(df_cleaned.kms_driven,bins=12,kde=True)","1903550c":"df_cleaned.corr().loc['price']","c5b16419":"df_cleaned.shape","3d6ff289":"pd.concat([df_cleaned,pd.get_dummies(df_cleaned.owner).drop('Fourth Owner Or More',axis=1)],axis=1).corr().loc['price']","6b88d96a":"list(df_cleaned.brand.value_counts().tail(3).index)","617bfea9":"df_cleaned = df_cleaned[-((df_cleaned.brand == 'MV')|(df_cleaned.brand == 'Indian')|(df_cleaned.brand == 'LML'))]","ed4824b2":"df_cleaned_2 = pd.concat([df_cleaned,pd.get_dummies(df_cleaned.brand).drop('Jawa',axis=1)],axis=1)","4c76f8ee":"df_cleaned.head()","197fb2bb":"df_cleaned_2.head()","9d58028a":"df_cleaned.drop(['owner','brand'],axis=1,inplace=True)","d59ecbb1":"df_cleaned_2.drop(['owner','brand'],axis=1,inplace=True)","28e2a94d":"df_cleaned_2","5e936e57":"df_cleaned.head()","4180fd08":"X_1 = df_cleaned.drop('price',axis=1)\nY_1 = df_cleaned.price\nx_train_1,x_test_1,y_train_1,y_test_1 = train_test_split(X_1,Y_1,random_state=1)","3f727d4c":"model1 = LinearRegression()\nmodel2 = RandomForestRegressor()","d2da7c16":"model1.fit(x_train_1,y_train_1)\nmodel2.fit(x_train_1,y_train_1)","5b453518":"model1.score(x_test_1,y_test_1)","6e2c403a":"model2.score(x_test_1,y_test_1)","40f3547f":"df_cleaned_2.head()","aa4924a3":"X_2 = df_cleaned_2.drop(['price'],axis=1)\nY_2 = df_cleaned_2.price\nx_train_2,x_test_2,y_train_2,y_test_2 = train_test_split(X_2,Y_2,random_state=1)","10c77a6b":"model1 = LinearRegression()\nmodel2 = RandomForestRegressor()","488da36c":"model1.fit(x_train_2,y_train_2)\nmodel2.fit(x_train_2,y_train_2)","10764154":"model1.score(x_test_2,y_test_2)","2cefd57d":"model2.score(x_test_2,y_test_2)","94238b98":"RF_model_test = RandomForestRegressor(n_estimators=50,random_state=2,min_samples_split=3)","703e6cd7":"RF_model_test.fit(x_train_2,y_train_2)","a8ebd0be":"RF_model_test.score(x_test_2,y_test_2)","ac599b2a":"RF_model = RandomForestRegressor(n_estimators=50,random_state=2,min_samples_split=3)","e54b9c18":"RF_model.fit(X_2,Y_2)","468abfbe":"Performance of Both Model Improved but the Best Performer is Random Forest Algorithm is best With all Features (which is df_cleaned_2)","43eb0c36":"## Finalizing Model","1cce07f8":"correlation had improved after outliers Removal","bc430690":"Absolutely Random Forest Regressor Algorithm is performing Best","174e0641":"### Modeling First DataFrame","f46eefb3":"### Modeling Second DataFrame","b9386989":"### Used Bike Prediction Model"}}