{"cell_type":{"538dc582":"code","b679ee45":"code","38a6ea2c":"code","e1441e01":"code","cb7361ab":"code","ca2dc338":"code","35ca82f5":"code","acd7187a":"code","bf6f4a65":"code","676689e0":"code","48919ba6":"code","422f551f":"code","077f3743":"code","05a96c40":"code","e6fead42":"markdown","74f35727":"markdown"},"source":{"538dc582":"import math\nimport pandas_datareader as web\nimport numpy as np\nimport pandas as pd\nfrom sklearn.preprocessing import MinMaxScaler\nfrom keras.models import Sequential\nfrom keras.layers import Dense, LSTM\nimport matplotlib.pyplot as plt\nimport plotly.graph_objects as go\nplt.style.use ('fivethirtyeight')\nimport plotly.express as px","b679ee45":"df = pd.read_csv('..\/input\/reliance-nse-stock-data\/RILO - Copy.csv')\ndf = df.set_index('Date')\ndf","38a6ea2c":"print(\"Click on the bottom right menu to show or hide the legend lines\")\n\nfig = go.Figure()\nfig.add_trace(go.Scatter(x = df.index, y = df['High Price'],\n                    mode='lines',\n                    name='High',\n                    marker_color = '#2CA02C',\n                    visible = \"legendonly\"))\nfig.add_trace(go.Scatter(x = df.index, y = df['Low Price'],\n                    mode='lines',\n                    name='Low',\n                    marker_color = '#D62728',\n                    visible = \"legendonly\"))\nfig.add_trace(go.Scatter(x = df.index, y = df['Open Price'],\n                    mode='lines',\n                    name='Open',\n                    marker_color = '#FF7F0E',\n                    visible = \"legendonly\"))\nfig.add_trace(go.Scatter(x = df.index, y = df['Close Price'],\n                    mode='lines',\n                    name='Close',\n                    marker_color = '#1F77B4'))\n\nfig.update_layout(\n    title='Closing price history',\n    titlefont_size = 28,\n    \n    xaxis = dict(\n        title='Date',\n        titlefont_size=16,\n        tickfont_size=14),\n    \n    height = 800,\n    \n    yaxis=dict(\n        title='Price in INR (\u20b9)',\n        titlefont_size=16,\n        tickfont_size=14),\n    \n    legend=dict(\n        y=0,\n        x=1.0,\n        bgcolor='rgba(255, 255, 255, 0)',\n        bordercolor='rgba(255, 255, 255, 0)'))\n\nfig.show()","e1441e01":"data = df.filter(['Close Price'])\ndataset = data.values\ntraining_data_len = math.ceil(len(dataset) * .8)\ntraining_data_len","cb7361ab":"scaler = MinMaxScaler(feature_range=(0,1))\nscaled_data = scaler.fit_transform(dataset)\nscaled_data","ca2dc338":"train_data = scaled_data[0:training_data_len, :]\nx_train = []\ny_train = []\nfor i in range(60, len(train_data)):\n    x_train.append(train_data[i-60:i, 0])\n    y_train.append(train_data[i, 0])\n    if i <= 61:\n        print(x_train)\n        print(y_train)\n        print()","35ca82f5":"x_train, y_train = np.array(x_train), np.array(y_train)\nx_train = np.reshape(x_train, (x_train.shape[0], x_train.shape[1], 1))\nx_train.shape","acd7187a":"model = Sequential()\nmodel.add(LSTM(50, return_sequences = True, input_shape = (x_train.shape[1], 1)))\nmodel.add(LSTM(50, return_sequences = False))\nmodel.add(Dense(25))\nmodel.add(Dense(1))\nmodel.compile(optimizer = 'adam', loss = 'mean_squared_error')\nmodel.fit(x_train, y_train, batch_size = 1, epochs = 1)","bf6f4a65":"test_data = scaled_data[training_data_len - 60: , :]\nx_test = []\ny_test = dataset[training_data_len:, :]\n\nfor i in range (60, len(test_data)):\n    x_test.append(test_data[i - 60:i, 0])\n\nx_test = np.array(x_test)\nx_test = np.reshape(x_test, (x_test.shape[0], x_test.shape[1], 1))\n\npredictions = model.predict(x_test)\npredictions = scaler.inverse_transform(predictions)\n\nrsme = np.sqrt(np.mean(predictions - y_test) ** 2)\nrsme","676689e0":"print(\"Click and drag on the plot to zoom in, you can reset using the top right option\")\n\ntrain = data[:training_data_len]\nvalid = data[training_data_len:]\nvalid['Predictions'] = predictions\n\nfig = go.Figure()\nfig.add_trace(go.Scatter(x = train.index, y = train['Close Price'],\n                    mode='lines',\n                    name='Close',\n                    marker_color = '#1F77B4'))\nfig.add_trace(go.Scatter(x = valid.index, y = valid['Close Price'],\n                    mode='lines',\n                    name='Val',\n                    marker_color = '#FF7F0E'))\nfig.add_trace(go.Scatter(x = valid.index, y = valid.Predictions,\n                    mode='lines',\n                    name='Predictions',\n                    marker_color = '#2CA02C'))\n\nfig.update_layout(\n    title='Model',\n    titlefont_size = 28,\n    hovermode = 'x',\n    xaxis = dict(\n        title='Date',\n        titlefont_size=16,\n        tickfont_size=14),\n    \n    height = 800,\n    \n    yaxis=dict(\n        title='Close price in INR (\u20b9)',\n        titlefont_size=16,\n        tickfont_size=14),\n    legend=dict(\n        y=0,\n        x=1.0,\n        bgcolor='rgba(255, 255, 255, 0)',\n        bordercolor='rgba(255, 255, 255, 0)'))\n\nfig.show()","48919ba6":"print('Validated close price with predicted closing price based on model')\nprint()\nvalid","422f551f":"last_60_days = data[-60:].values\nlast_60_days_scaled = scaler.transform(last_60_days)\nX_test = []\nX_test.append(last_60_days_scaled)\nX_test = np.array(X_test)\nX_test = np.reshape(X_test, (X_test.shape[0],X_test.shape[1], 1))\npred_price = model.predict(X_test)\npred_price = scaler.inverse_transform(pred_price)\nprint ('Predicting the closing price for the next day')\nprint()\nprint(pred_price)","077f3743":"df_check = web.DataReader('RELIANCE.NS', data_source ='yahoo', start = '2021-05-07', end = '2021-05-07')\ndf_check","05a96c40":"a = 1995.4773\nb = 1931.75\ndiff = (a-b)\/((a+b)\/2)*100\ndiff","e6fead42":"# As we can see there was a 3.24% difference from the actual price and predicted price in this model.","74f35727":"# Let us check reliance closing price for 7th May 2021"}}