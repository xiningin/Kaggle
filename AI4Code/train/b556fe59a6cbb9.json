{"cell_type":{"681926fe":"code","31756daf":"code","68d4a23f":"code","6dc765fe":"code","3b653b37":"code","577f7df1":"code","1c49e4b0":"code","1faa454c":"code","9477d561":"code","145ce08c":"code","2d737045":"code","0d326e73":"code","1151d931":"code","59a34231":"code","6bd742aa":"code","e0d17e2b":"code","f0f90234":"code","410f9f67":"code","6b8e40bd":"code","c3127cd4":"code","0a57b0c7":"code","023fcd45":"code","98f43515":"code","a0b0b61d":"code","9471f94b":"code","861cdb7e":"code","f8915cde":"code","fc2db8ac":"code","e4603435":"code","8967b76a":"code","41cc01a4":"code","8116da70":"code","1a4984f7":"code","83578fb0":"code","dd39f05d":"code","a0fabd34":"code","af174dfd":"code","62f0e189":"code","2e6e17dd":"code","ea0a4f59":"code","b7c08b6f":"code","16e880a3":"code","11a7ffec":"code","f8b5cebf":"markdown"},"source":{"681926fe":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","31756daf":"train_data = pd.read_csv(\"..\/input\/big-mart-salescsv\/Train_UWu5bXk.csv\")\ntest_data = pd.read_csv(\"..\/input\/big-mart-salescsv\/Test_u94Q5KV.csv\")","68d4a23f":"train_data.head()","6dc765fe":"test_data.head()","3b653b37":"train_data.info()","577f7df1":"train_data.drop('Item_Identifier',axis=1,inplace=True)\ntest_data.drop('Item_Identifier',axis=1,inplace=True)","1c49e4b0":"train_data.info()","1faa454c":"sns.countplot(x='Item_Fat_Content',data=train_data);","9477d561":"def clean_col(col):\n    if(col==\"low fat\" or col==\"LF\"):\n        return \"Low Fat\"\n    elif(col==\"reg\"):\n        return \"Regular\"\n    else:\n        return col","145ce08c":"train_data['Item_Fat_Content']=train_data['Item_Fat_Content'].apply(clean_col)","2d737045":"sns.countplot(x='Item_Fat_Content',data=train_data)","0d326e73":"sns.countplot(x='Item_Fat_Content',data=test_data)","1151d931":"test_data['Item_Fat_Content']=test_data['Item_Fat_Content'].apply(clean_col)","59a34231":"sns.countplot(x='Item_Fat_Content',data=test_data)","6bd742aa":"plt.figure(figsize=(12,3))\nsns.countplot(x='Item_Type',data=train_data)","e0d17e2b":"sns.heatmap(train_data.isnull(),yticklabels=False,cbar=False,cmap='viridis')","f0f90234":"train_data.drop('Outlet_Identifier',axis=1,inplace=True)\ntest_data.drop('Outlet_Identifier',axis=1,inplace=True)","410f9f67":"sns.heatmap(train_data.isnull(),yticklabels=False,cbar=False,cmap='viridis')","6b8e40bd":"plt.figure(figsize=(15,3))\nsns.boxplot(x=\"Item_Type\", y=\"Item_Weight\", data=train_data,palette='rainbow')","c3127cd4":"train_data.groupby('Item_Type').mean()['Item_Weight']","0a57b0c7":"def fill_null(row):\n    if(pd.isnull(row['Item_Weight'])):\n        row['Item_Weight']=train_data.groupby('Item_Type').mean()['Item_Weight'][row['Item_Type']]\n        return row\n    else:\n        return row","023fcd45":"train_data = train_data.apply(fill_null,axis=1)","98f43515":"sns.heatmap(train_data.isnull(),yticklabels=False,cbar=False,cmap='viridis')","a0b0b61d":"sns.countplot(x='Outlet_Size',data=train_data,hue='Outlet_Type')","9471f94b":"def fill_size(row):\n    if(pd.isnull(row['Outlet_Size'])):\n        if(row['Outlet_Type']==\"Supermarket Type1\"):\n            row['Outlet_Size']=\"Small\"\n            return row\n        elif(row['Outlet_Type']==\"Supermarket Type2\"):\n            row['Outlet_Size']=\"Medium\"\n            return row\n        elif(row['Outlet_Type']==\"Supermarket Type3\"):\n            row['Outlet_Size']=\"Medium\"\n            return row\n        else:\n            row['Outlet_Size']=\"Small\"\n            return row\n    else:\n       return row","861cdb7e":"train_data = train_data.apply(fill_size,axis=1)","f8915cde":"sns.heatmap(train_data.isnull(),yticklabels=False,cbar=False,cmap='viridis')","fc2db8ac":"sns.heatmap(test_data.isnull(),yticklabels=False,cbar=False,cmap='viridis')","e4603435":"def fill_null2(row):\n    if(pd.isnull(row['Item_Weight'])):\n        row['Item_Weight']=test_data.groupby('Item_Type').mean()['Item_Weight'][row['Item_Type']]\n        return row\n    else:\n        return row","8967b76a":"test_data = test_data.apply(fill_null2,axis=1)","41cc01a4":"sns.heatmap(test_data.isnull(),yticklabels=False,cbar=False,cmap='viridis')","8116da70":"sns.countplot(x='Outlet_Size',data=test_data,hue='Outlet_Type')","1a4984f7":"def fill_size2(row):\n    if(pd.isnull(row['Outlet_Size'])):\n        if(row['Outlet_Type']==\"Supermarket Type1\"):\n            row['Outlet_Size']=\"Small\"\n            return row\n        elif(row['Outlet_Type']==\"Supermarket Type2\"):\n            row['Outlet_Size']=\"Medium\"\n            return row\n        elif(row['Outlet_Type']==\"Supermarket Type3\"):\n            row['Outlet_Size']=\"Medium\"\n            return row\n        else:\n            row['Outlet_Size']=\"Small\"\n            return row\n    else:\n       return row","83578fb0":"test_data = test_data.apply(fill_size2,axis=1)","dd39f05d":"sns.heatmap(test_data.isnull(),yticklabels=False,cbar=False,cmap='viridis')","a0fabd34":"data_types = train_data.dtypes\nfor cols in train_data.columns:\n    if data_types[cols]==data_types['Item_Type']:\n        temp = pd.get_dummies(train_data[cols],drop_first=True)\n        train_data.drop(cols,axis=1,inplace=True)\n        train_data = pd.concat([train_data,temp],axis=1)\n#data.head()","af174dfd":"train_data.head()","62f0e189":"data_types = test_data.dtypes\nfor cols in test_data.columns:\n    if data_types[cols]==data_types['Item_Type']:\n        temp = pd.get_dummies(test_data[cols],drop_first=True)\n        test_data.drop(cols,axis=1,inplace=True)\n        test_data = pd.concat([test_data,temp],axis=1)","2e6e17dd":"test_data.head()","ea0a4f59":"from sklearn.tree import DecisionTreeRegressor\nregr = DecisionTreeRegressor()\nregr.fit(train_data.drop('Item_Outlet_Sales',axis=1),train_data['Item_Outlet_Sales'])","b7c08b6f":"X_train = train_data.drop('Item_Outlet_Sales',axis=1)\ny_train = train_data['Item_Outlet_Sales']\nprint(\"Training Accuracy for Decision Tree regressor :\", regr.score(X_train, y_train))","16e880a3":"predictions = regr.predict(test_data)","11a7ffec":"pd.Series(predictions)","f8b5cebf":"# Conclusion\n\nAfter a whole lot of preprocessiong we were finally able to deveop a dataset which was good enough for our model to run. I didn't explain anything step wise but a lot of it is self explanatory. If you liked my notebook pls leave an upvote and if you have any suggestions mention them in the comments too. Cheers!"}}