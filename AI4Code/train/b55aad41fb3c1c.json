{"cell_type":{"b598526e":"code","ad16ae0d":"code","53a4f3d5":"code","d4ed7295":"code","8f3864d7":"code","44f71fe7":"code","68eaabc5":"code","ecfde010":"code","e2438065":"code","67095be8":"code","a8d8fe33":"code","027631c1":"code","38922daa":"code","3041d138":"code","7c7aa95b":"code","15f67095":"code","e6a2a6c6":"code","bcc81ef9":"code","752b4357":"code","dfd2988c":"code","88244adc":"code","9f70b35f":"markdown","8e80c90c":"markdown","7254ba39":"markdown","baf7564f":"markdown","eb127a30":"markdown","c477989e":"markdown","12ad6e64":"markdown","97b66ea8":"markdown","340c41aa":"markdown","cf733697":"markdown","ef618c06":"markdown","8ce5b26e":"markdown","091dab91":"markdown"},"source":{"b598526e":"import numpy as np\nimport pandas as pd\nfrom patsy import dmatrices\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.model_selection import train_test_split, cross_val_score, GridSearchCV\nfrom sklearn import metrics\nimport matplotlib.pyplot as plt","ad16ae0d":"data = pd.read_csv('..\/input\/train.csv')\ndata.head()","53a4f3d5":"columns = data.columns.tolist()[1:-1]","d4ed7295":"X = data[columns]","8f3864d7":"y = np.ravel(data['target'])","44f71fe7":"df = data.groupby(['target']).size() \/ data.shape[0] * 100.\ndf.plot(kind='bar')\nplt.show()","68eaabc5":"for i in range(9):\n    plt.subplot(3, 3, i+1)\n    data[data['target'] == 'Class_' + str(i+1)].feat_20.hist()\nplt.show()","ecfde010":"plt.scatter(data.feat_19, data.feat_20)\nplt.show()","e2438065":"fig = plt.figure()\nax = fig.add_subplot(1, 1, 1)\ncax = ax.matshow(X.corr())\nfig.colorbar(cax)\nplt.show()","67095be8":"num_fea = X.shape[1]\nnum_fea","a8d8fe33":"model = MLPClassifier(hidden_layer_sizes=(30, 10), alpha=1e-5, activation='relu', \\\n                      solver='lbfgs', verbose=3, random_state=0)","027631c1":"model.fit(X, y)","38922daa":"model.intercepts_","3041d138":"print(model.coefs_[0].shape)\nprint(model.coefs_[1].shape)\nprint(model.coefs_[2].shape)","7c7aa95b":"pred = model.predict(X)\npred","15f67095":"model.score(X, y)","e6a2a6c6":"sum(pred == y) \/ len(y)","bcc81ef9":"cross_val_score(model, X, y, cv=4)","752b4357":"test = pd.read_csv('..\/input\/test.csv')","dfd2988c":"preds_test = model.predict_proba(test.iloc[:,1:])\n\nresult = pd.DataFrame(preds_test, columns=['Class_'+str(i+1) for i in range(9)])\nresult['id'] = test['id']\n\n# reorder \ncols = result.columns.tolist()\ncols = cols[-1:] + cols[:-1]\nresult = result[cols]","88244adc":"result.to_csv('.\/otto_predictions.csv', index=False)","9f70b35f":"\u6570\u636e\u4e2d\u4ece\u7b2c\u4e00\u5217\u5230\u5012\u6570\u7b2c\u4e8c\u5217\u662ffeature","8e80c90c":"\u663e\u793afeature 20\u5728\u4e0d\u540c\u7c7b\u4e0b\u7684\u5206\u5e03\u56fe","7254ba39":"\u521d\u59cb\u5316\u795e\u7ecf\u7f51\u7edc\u6a21\u578b\uff0c\u4e24\u4e2a\u9690\u85cf\u5c42\uff0c\u6574\u4e2a\u7f51\u7edc\u4e3a93x30x10x9","baf7564f":"\u8f93\u51fa\u4e3a\u5bf9\u6bcf\u4e00\u4e2a\u5546\u54c1\u9884\u6d4b\u51fa\u7684\u5c5e\u4e8e\u6bcf\u4e00\u79cd\u7c7b\u522b\u7684\u6982\u7387\uff0c\u5e76\u52a0\u5165id\u5217\uff0c\u8f93\u51fa\u5230.\/otto_prediction.tsv\u91cc","eb127a30":"\u9884\u6d4b\u9700\u8981\u7ea61\u5206\u949f","c477989e":"\u663e\u793a\u6240\u6709feature\u7684\u76f8\u5173\u7cfb\u6570\u77e9\u9635","12ad6e64":"\u663e\u793afeature 19\u548cfeature 20\u7684\u6563\u70b9\u56fe","97b66ea8":"\u7528\u795e\u7ecf\u7f51\u7edc\u5bf9Otto\u5546\u54c1\u5206\u7c7b\u9884\u6d4b","340c41aa":"\u8f93\u51fa\u8bad\u7ec3\u6570\u636e\u4e0a\u7684\u51c6\u786e\u5ea6","cf733697":"\u89c2\u5bdf\u6a21\u578b\u7cfb\u6570\u548cbias","ef618c06":"\u89c2\u5bdf\u5546\u54c1\u79cd\u7c7b\u7684\u5206\u5e03","8ce5b26e":"\u4ece.\/input\/train.csv\u8bfb\u5165\u6570\u636e","091dab91":"\u5728\u6d4b\u8bd5\u6570\u636e..\/input\/test.csv\u4e0a\u8fdb\u884c\u9884\u6d4b"}}