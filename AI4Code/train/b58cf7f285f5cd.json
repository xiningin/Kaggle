{"cell_type":{"3302bbef":"code","f2e9b8b7":"code","b8016e91":"code","f6b2e2be":"code","7f327655":"code","f3cbbd9f":"code","54d970df":"code","3ff2aeed":"code","5144f552":"code","401970ae":"code","c046638a":"code","9f39cfdf":"code","5269cd6b":"code","67196386":"code","73840066":"code","94b11495":"code","1772fbb7":"code","9832826f":"code","651b1578":"code","18dbe259":"code","ba925956":"code","647b12d7":"code","e2d4df9e":"code","a389613a":"code","5389a58e":"code","5a12826d":"code","f24caf10":"code","c5ce88b5":"code","d625b74f":"code","20489490":"code","55ee74b7":"code","46205a5b":"code","ff174942":"code","1fecb73c":"code","6ae29d1c":"code","d29f9aa0":"code","47b78392":"code","25019dfa":"code","4625f9a2":"code","900cf491":"code","534fc76d":"code","ac8077cc":"code","f6a8dab7":"code","a9fe669e":"markdown","fe170a9e":"markdown","802f4f6a":"markdown","03373080":"markdown","7b5ad14a":"markdown","f82d3587":"markdown","44f3aae0":"markdown","09b4166b":"markdown","711c9412":"markdown","5fc8deb5":"markdown","e17dfa18":"markdown","bc71b396":"markdown","9b86e777":"markdown","cceba903":"markdown","e3a5f74e":"markdown","ab199715":"markdown","ca84170e":"markdown","644165c3":"markdown","d254533f":"markdown","05198595":"markdown","eff92157":"markdown","88fe012f":"markdown","7520491d":"markdown"},"source":{"3302bbef":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","f2e9b8b7":"df = pd.read_csv(\"\/kaggle\/input\/house-price-tehran-iran\/housePrice.csv\")","b8016e91":"df.head()","f6b2e2be":"df.info()","7f327655":"df = df.fillna(\"Unknown\")\nmissing_data = df.isnull().sum()\nprint(missing_data)","f3cbbd9f":"df['Address'].value_counts().nlargest(5)","54d970df":"# Price: Tomans\ndf.groupby('Address').mean()['Price'].nlargest(5).reset_index()","3ff2aeed":"addressLPIR = df.groupby('Address').mean()['Price'].nlargest(5).reset_index()\nsns.barplot(x=\"Address\",\n           y=\"Price\",\n           data=addressLPIR)","5144f552":"# Price: USD\ndf.groupby('Address').mean()['Price(USD)'].nlargest(5).reset_index()","401970ae":"addressLP = df.groupby('Address').mean()['Price(USD)'].nlargest(5).reset_index()\nsns.barplot(x=\"Address\",\n           y=\"Price(USD)\",\n           data=addressLP)","c046638a":"sns.countplot(x=\"Room\",data=df)","9f39cfdf":"sns.lineplot(data = df, x = 'Room', y ='Price' )","5269cd6b":"ax = sns.boxplot(x=\"Room\", y=\"Price\", data=df)","67196386":"sns.jointplot(x = \"Room\", y = \"Price\", kind = \"kde\", data = df)","73840066":"sns.jointplot(data=df,x='Room', y='Price', hue='Elevator')","94b11495":"sns.jointplot(data=df,x='Room', y='Price', hue='Parking')","1772fbb7":"df.Parking = df.Parking.astype(int)\ndf.Warehouse = df.Warehouse.astype(int)\ndf.Elevator = df.Elevator.astype(int)\ndf.Area = df.Area.str.replace(',' , '').astype(int)","9832826f":"df.nlargest(5,'Area')","651b1578":"df.drop( df[df['Area'] >= 2000000].index , inplace=True)","18dbe259":"df.info()","ba925956":"# **first: Groupby Address with mean of Price:**\nAddress_df = df.groupby('Address').mean()['Price(USD)'].reset_index()\n# **Then Sorting By Price:**\nAddress_df = Address_df.sort_values(by=['Price(USD)']).reset_index()\n## **Add \"codedAddress\" Column**\nAddress_df.insert(0, 'codedAddress', range(1, 194))\ndf1 = pd.Series(Address_df.codedAddress.values,index=Address_df.Address).to_dict()\ndf[\"Address_n\"] = df[\"Address\"].map(df1)","647b12d7":"df.info()","e2d4df9e":"df.head()","a389613a":"sns.pairplot(data = df)","5389a58e":"df.corr()","5a12826d":"sns.heatmap(df.corr(), annot=True,cmap='Greens')","f24caf10":"# Features:\nX = df.drop(['Price(USD)'  , 'Price', 'Address'] , axis = 1)\n# Label:\ny = df['Price(USD)']","c5ce88b5":"from sklearn.model_selection import train_test_split","d625b74f":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=101)","20489490":"X_train.shape , X_test.shape","55ee74b7":"from sklearn.linear_model import LinearRegression","46205a5b":"model = LinearRegression()","ff174942":"model.fit(X_train, y_train)","1fecb73c":"model.coef_","6ae29d1c":"pd.DataFrame(model.coef_ , X.columns, columns=['Coefficient'])","d29f9aa0":"y_pred = model.predict(X_test)","47b78392":"from sklearn import metrics\nMAE = metrics.mean_absolute_error(y_test, y_pred)\nMSE = metrics.mean_squared_error(y_test, y_pred)\nRMSE = np.sqrt(MSE)","25019dfa":"pd.DataFrame([MAE, MSE, RMSE], index=['MAE', 'MSE', 'RMSE'], columns=['Metrics'])","4625f9a2":"df['Price(USD)'].mean()","900cf491":"test_residuals = y_test - y_pred","534fc76d":"sns.displot(test_residuals, bins = 25 , kde = True)","ac8077cc":"sns.scatterplot(x = y_test, y= test_residuals)\nplt.axhline(y = 0, color = '#000' , ls = '--' )","f6a8dab7":"sns.scatterplot(x=y_test, y=y_pred)\nplt.xlabel('Price(USD)')\nplt.ylabel('Price(USD)')","a9fe669e":"Due to the large difference between items 5 and the first four, it can be seen that the first to fourth rows are Outlier.","fe170a9e":"USD price format:","802f4f6a":"**lets take a look box plot of it:**","03373080":"In this notebook, I want to work with a real [dataset](https:\/\/www.kaggle.com\/mokar2001\/house-price-tehran-iran) collected by [Mohamadreza Kariminejad](https:\/\/www.kaggle.com\/mokar2001) and includes the price of a house in Tehran(Capital of Iran).\n\nWe want to check the price of a house in Tehran by drawing some plot and also create a simple linear regression for it.","7b5ad14a":"#### Split dataset to train and test data","f82d3587":"**Five region of Tehran with the highest average house prices:**","44f3aae0":"**Drop outlier data from Area**\n\nAccording to the author of the dataset, we have Outlier in the Area column.([here](https:\/\/www.kaggle.com\/mokar2001\/house-price-tehran-iran\/discussion\/270637))\n\nlets drop those:","09b4166b":"### Train the model","711c9412":"#### Exploratory Data Analysis","5fc8deb5":"*Most houses that have rooms also have parking.*","e17dfa18":"first let me show you which row in Area are Outlier:","bc71b396":"#### Predicting test data","9b86e777":"**Convert \"Address\" Column to Ordinal Scale (from Nominal Scale to Ordinal Scale)**","cceba903":"***We don't have missing data now. Let's draw some plot :)***","e3a5f74e":"**According to info(), we see that several lines of addresses are null.**\n\n**The number of data missing is not too large, but it may belong to expensive house, so I decided to fill those with the word \"Unknown\" instead of droping.**","ab199715":"The result is interesting: you may find a house in Tehran with 5 rooms at a price equal to a house with three or two rooms.","ca84170e":"*Strange and interesting: According to the chart above, most houses with 5 rooms are without elevators. I do not know maybe they were built as a villa.*","644165c3":"### Evaluating The model","d254533f":"**Which is the most common house (Number of Bedrooms) ?**","05198595":"**The relation between the number of rooms and the price:**","eff92157":"#### Determine features and label:","88fe012f":"# Tehran House Price Visualization & LinearRegression","7520491d":"**The highest number of houses is in these five region of Tehran. (Note: This statistic may be inaccurate due to the limited data in this database)  :**"}}