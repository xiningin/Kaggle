{"cell_type":{"8aa05cb6":"code","6c872d7d":"code","740c7115":"code","6800ec3e":"code","dd1fb8a4":"code","62e3a63e":"code","bc8dda5a":"code","d5cc386f":"code","12048eab":"code","653761f0":"code","caff0335":"code","f18669fd":"code","42241f4f":"code","90d60808":"code","a44ce816":"code","ba09da87":"code","96e1198e":"code","c38f9aeb":"code","35e45baf":"code","ab6f680e":"code","b9b32847":"code","9cc76664":"code","166c6c45":"code","9e101601":"code","0aa93c67":"code","876a425a":"code","c07d443a":"code","e9beda53":"code","4f4762c2":"code","60e4e82f":"code","8615c2bd":"code","e9a917c3":"code","77799b34":"code","76cbb7a4":"code","93d43397":"code","3db265e2":"markdown","fe47a8e6":"markdown","cb188750":"markdown","582813b6":"markdown","54e00686":"markdown","92745e2b":"markdown","5928f715":"markdown","5e0f88b2":"markdown","71e6111b":"markdown","7803234e":"markdown","d446e8c9":"markdown","2ef2bba8":"markdown","64a68983":"markdown","4bdf305d":"markdown","a85153dc":"markdown","b54194cb":"markdown","c189e761":"markdown"},"source":{"8aa05cb6":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport statsmodels.api as sm\nimport pandas_profiling\n","6c872d7d":"pd.reset_option('max_rows')","740c7115":"# to reset rc parameters to default value\nplt.rcdefaults() ","6800ec3e":"df=pd.read_csv('..\/input\/hotel-booking-demand\/hotel_bookings.csv')\ndf.head()","dd1fb8a4":"df.isnull().sum().plot(kind='bar')\nplt.yticks(np.arange(min(df.isnull().sum()),max(df.isnull().sum()),step=5000))\nplt.show()","62e3a63e":"df=df.dropna(subset=['country','agent'])","bc8dda5a":"df=df.drop(columns=['company'])","d5cc386f":"df['children']=df['children'].replace(np.nan,0)\ndf['children'].isna().sum()","12048eab":"#extract importants variable\ndf=df[['hotel','is_canceled','arrival_date_year','arrival_date_month', 'arrival_date_week_number',\n       'arrival_date_day_of_month', 'adults', 'children', 'babies','is_repeated_guest', \n       'reserved_room_type','days_in_waiting_list','required_car_parking_spaces','reservation_status']]\ndf.head()","653761f0":"df.shape","caff0335":"df.info()","f18669fd":"#create html report of your dataset\n#df.profile_report()","42241f4f":"df.describe()","90d60808":"df.columns.values","a44ce816":"months = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \n          \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"]\nmonth_count_df=pd.DataFrame()\nmonth_count=df['arrival_date_month'].value_counts()\nmonth_count_df['month']=month_count.index\nmonth_count_df['count']=month_count.values\nmonth_count_df['month']=pd.Categorical(month_count_df['month'], categories=months, ordered=True)#to map the order so when call the order they know\nmonth_count_df.sort_values(by=['month'],ascending=True)","ba09da87":"\nfor i, row in month_count_df.sort_values(by=['month'],ascending=True).iterrows():\n   print( row['count'])","96e1198e":"#plt months \nmonth_count_df=month_count_df.sort_values(by=['month'],ascending=True)\nplt.figure(figsize=(10,5))\nbase_color=sns.color_palette()[0] # to set the color of the bars with the base color of pallete colors (10 colors from 0 to 9)\nsns.barplot(month_count_df['month'], month_count_df['count'], alpha=0.8,color=base_color)\nplt.title('plot month counts')\nplt.xlabel('months', fontsize=14)\nplt.ylabel('counts', fontsize=12)\nplt.xticks(rotation='vertical')\nplt.yticks(np.arange(0,15000,step=1000))#determine the steps(count by) \n#plt.ylim(0,13000,1000)\nlocs, labels = plt.xticks()\n#draw text(count percent) on each bar\ncounter=0;\nfor i, row in month_count_df.iterrows():\n    # get the text property for the label to get the correct count\n    count = row['count']\n    month = row['month']\n    #print(\"loc {}, month {} count {}\".format(row.iloc,month,count))\n    pct_string = '{:0.1f}%'.format(100*count\/len(df))\n    # print the annotation just below the top of the bar\n    plt.text(locs[counter], count - 1000, pct_string, ha = 'center', color = 'w',fontsize=12)\n    counter=counter+1;\nplt.show();","c38f9aeb":"df.arrival_date_year.unique()","35e45baf":"year_counts=df.arrival_date_year.value_counts()\nyear_counts","ab6f680e":"#another solution by using matplotlib\nfig, ax = plt.subplots(figsize=(10,5), subplot_kw=dict(aspect=\"equal\"))\nwedges, texts,autotexts = ax.pie(year_counts.values, labels=year_counts.index,autopct='%1.1f%%',textprops=dict(color=\"w\"),wedgeprops = {'width' : 0.5})\nax.legend(wedges, year_counts.index,\n          title=\"years\",\n          loc=\"center left\",\n          bbox_to_anchor=(1, 0, 0.5, 1))# anchor of legend(position)\nplt.setp(autotexts, size=7,weight=\"bold\")#data inside the circle\nax.set_title(\"The best year in bookings\",size=13,color='b')\n\nplt.show()","b9b32847":"def count_rows(rows):\n    return len(rows)","9cc76664":"#df.query('arrival_date_year==\"2016\"')['hotel'].value_counts()\nby_hotel_year=df.groupby(\"hotel arrival_date_year\".split()).apply(count_rows).unstack()\nby_hotel_year","166c6c45":"sns.heatmap(by_hotel_year)\nplt.xlabel(\"year\",fontsize=14)\nplt.title(\"year vs hotel\")","9e101601":"df.groupby('arrival_date_year')['hotel'].value_counts().plot(kind='bar')","0aa93c67":"hotel_cancelation_count=df.query('is_canceled==1').groupby('hotel')['is_canceled'].value_counts().unstack()\nsns.heatmap(hotel_cancelation_count)","876a425a":"hist(df.hotel)\n","c07d443a":"def func(tpl):\n    if (tpl[1]==1):#cancelation\n        label=\"Canceled {}\".format(tpl[0])\n        print(label)\n    return label","e9beda53":"labels = hotel_cancelation_count.index\nprint(labels)\nsizes = hotel_cancelation_count.values\nexplode = (0, 0.1)  # only \"explode\" the 2nd slice (i.e. 'Hogs')\nfig1, ax1 = plt.subplots()\nax1.pie(sizes, explode=explode, labels=labels.map(lambda x:func(x)), autopct='%1.1f%%',\n        shadow=True, startangle=90,textprops=dict(color=\"w\"))\nax1.axis('equal')  # Equal aspect ratio ensures that pie is drawn as a circle.\n","4f4762c2":"df['intercept']=1","60e4e82f":"plt.figure(figsize = [10, 5])\n\n# histogram on left: full data\nplt.subplot(1, 2, 1)# 1 row , 2 columns , and first plot\nbin_edges = np.arange(0, df['adults'].max()+2.5, 2.5)# x axis start with zero until df['skew_var'].max()+2.5 with 2.5 bin width\nplt.hist(data = df, x = 'adults', bins = bin_edges)\n\n# histogram on right: focus in on bulk of data < 5\nplt.subplot(1, 2, 2)\nbin_edges = np.arange(0, 5+1, 1)\nplt.hist(data = df, x = 'adults', bins = bin_edges)\nplt.xlim(0, 5) # could also be called as plt.xlim((0, 35))","8615c2bd":"df['arrival_date_week_number'].describe()","e9a917c3":"np.log10(df['arrival_date_week_number']).describe()","77799b34":"plt.figure(figsize = [10, 5])\n\n# left histogram: data plotted in natural units\nplt.subplot(1, 2, 1)\nbin_edges = np.arange(1, df['arrival_date_week_number'].max()+1, 1)\nplt.hist(data=df,x='arrival_date_week_number', bins = bin_edges)\nplt.xlabel('arrival_date_week_number')\n\n# right histogram: data plotted after direct log transformation\nplt.subplot(1, 2, 2)\nlog_data = np.log10(df['arrival_date_week_number']) # direct data transform\nlog_bin_edges = np.arange(0, log_data.max()+0.07, 0.07)\nplt.hist(log_data, bins = log_bin_edges)\nplt.xlabel('log(arrival_date_week_number)')","76cbb7a4":"#sns.scatterplot(df['adults'],df['babies'])\ndf.corr()","93d43397":"\nrm=sm.OLS(df['required_car_parking_spaces'],df[['intercept','adults','children']])\nresult=rm.fit()\nresult.summary()","3db265e2":"1. for each one addtion adult we predict .02 car parking space\n2. for each one addtion adult we predict .04 car parking space\n3. it seems that adult and children variables are statistically significant for the [required car parking spaces] variable because the p value is 0 (less than .05)","fe47a8e6":"## what is the relation between adults and childrens? or predict # of childrens according to adults.","cb188750":"## what is the best adults number?","582813b6":"**the max hotel in cancelation is City hotel**","54e00686":"# Assessing Data","92745e2b":"## what is the best hotel in all years?","5928f715":" **as the above chart the best hotel in each year in booking is city hotel, but the best year for city hotel was 2016.**","5e0f88b2":"**as we see in the heat map **<br>\n**1. the best hotel   hotel is the city hotel in 2016**<br>\n**2. the worst hotel in booking is the resort hotel in 2015**<br>","71e6111b":"## what is the best hotel in each year?","7803234e":"## What is the best arrival week?\n","d446e8c9":"# Data Preparation","2ef2bba8":"**the best month is August**","64a68983":"## What is the maximum hotel cancelation?","4bdf305d":"1. **The best year in booking is 2016 with about 47.7% of all bookings **","a85153dc":"### what is the best month in booking?","b54194cb":"### what is the best year in booking?","c189e761":"# Analyse Data"}}