{"cell_type":{"7f760861":"code","4e2e993b":"code","1723b0e3":"code","b67ba302":"code","1d288368":"code","9ec545de":"code","eb304f4c":"code","5584aa75":"code","7965b63f":"code","c0d171a0":"code","ef6ff121":"code","4b06da1c":"code","3822be2a":"code","d0777581":"code","ee5a8efd":"code","813a2843":"code","692b2753":"code","c15173fa":"code","bb0c7ab4":"code","87f07b3f":"code","f15c880c":"code","1e8bba55":"code","6498d376":"code","371d3e9a":"code","19e08d70":"code","1de265ba":"code","93786cef":"code","94e715e6":"code","e9f157b1":"code","cce29acd":"code","1fdadde0":"code","5ac5681e":"code","a3ba4390":"code","4a58234a":"code","d78828dd":"code","c8b9597a":"code","dc22c744":"code","ae1b8954":"code","2f25cd14":"code","0077d3dd":"code","5ea909ee":"code","626b4eb0":"markdown","50acad26":"markdown"},"source":{"7f760861":"path = \"..\/input\/scene_classification\/scene_classification\/train\/\"","4e2e993b":"from fastai import *\nfrom fastai.vision import *","1723b0e3":"bs = 256","b67ba302":"df = pd.read_csv('..\/input\/scene_classification\/scene_classification\/train.csv')\ndf.head()","1d288368":"tfms = get_transforms(flip_vert=False,max_zoom=1.0,max_warp=0)","9ec545de":"data_small = (ImageList.from_csv(path, csv_name = '..\/train.csv') \n        .split_by_rand_pct()              \n        .label_from_df()            \n        .add_test_folder(test_folder = '..\/test')              \n        .transform(tfms, size=128)\n        .databunch(num_workers=0))","eb304f4c":"data_large = (ImageList.from_csv(path, csv_name = '..\/train.csv') \n        .split_by_rand_pct()              \n        .label_from_df()            \n        .add_test_folder(test_folder = '..\/test')              \n        .transform(tfms, size=256)\n        .databunch(num_workers=0))","5584aa75":"data_small.show_batch(rows=3, figsize=(8,10))","7965b63f":"data_large.show_batch(rows=3, figsize=(8,10))","c0d171a0":"print(data_small.classes)\nprint(data_large.classes)","ef6ff121":"learn_34 = cnn_learner(data_small, models.resnet34, metrics=[error_rate, accuracy], model_dir=\"\/tmp\/model\/\")\nlearn_50 = cnn_learner(data_small, models.resnet50, metrics=[error_rate, accuracy], model_dir=\"\/tmp\/model\/\")\nlearn_101 = cnn_learner(data_small, models.resnet101, metrics=[error_rate, accuracy], model_dir=\"\/tmp\/model\/\")","4b06da1c":"learn_34.fit_one_cycle(4)","3822be2a":"interp = ClassificationInterpretation.from_learner(learn_34)\n\nlosses,idxs = interp.top_losses()\n\nlen(data_small.valid_ds)==len(losses)==len(idxs)","d0777581":"interp.plot_confusion_matrix(figsize=(7,7), dpi=60)","ee5a8efd":"learn_34.save('\/kaggle\/working\/resnet34-size128-stage1')","813a2843":"learn_34.data = data_large","692b2753":"learn_34.unfreeze()","c15173fa":"learn_34.lr_find()","bb0c7ab4":"learn_34.recorder.plot()","87f07b3f":"learn_34.fit_one_cycle(3, max_lr=slice(1e-6, 1e-4))","f15c880c":"learn_34.save('\/kaggle\/working\/resnet34-size256-stage1')","1e8bba55":"learn_50.fit_one_cycle(4)","6498d376":"interp = ClassificationInterpretation.from_learner(learn_50)\n\nlosses,idxs = interp.top_losses()\n\nlen(data_small.valid_ds)==len(losses)==len(idxs)","371d3e9a":"interp.plot_confusion_matrix(figsize=(7,7), dpi=60)","19e08d70":"learn_50.save('\/kaggle\/working\/resnet50-size128-stage1')","1de265ba":"learn_50.data = data_large","93786cef":"learn_50.unfreeze()","94e715e6":"learn_50.lr_find()","e9f157b1":"learn_50.recorder.plot()","cce29acd":"learn_50.fit_one_cycle(3, max_lr=slice(1e-6, 1e-4))","1fdadde0":"learn_50.save('\/kaggle\/working\/resnet50-size256-stage1')","5ac5681e":"learn_101.fit_one_cycle(4)","a3ba4390":"interp = ClassificationInterpretation.from_learner(learn_101)\n\nlosses,idxs = interp.top_losses()\n\nlen(data_small.valid_ds)==len(losses)==len(idxs)","4a58234a":"interp.plot_confusion_matrix(figsize=(7,7), dpi=60)","d78828dd":"learn_101.save('\/kaggle\/working\/resnet101-size128-stage1')","c8b9597a":"learn_101.data = data_large","dc22c744":"learn_101.unfreeze()","ae1b8954":"learn_101.lr_find()","2f25cd14":"learn_101.recorder.plot()","0077d3dd":"learn_101.fit_one_cycle(3, max_lr=slice(1e-6, 1e-4))","5ea909ee":"learn_101.save('\/kaggle\/working\/resnet101-size256-stage1')","626b4eb0":"**ResNet 101**","50acad26":"**ResNet 50**"}}