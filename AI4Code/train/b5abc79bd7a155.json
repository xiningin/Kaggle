{"cell_type":{"43271a55":"code","943f3e6a":"code","ce39f5ed":"code","c28d13f5":"code","65bd5c7d":"code","c28477db":"code","55989848":"code","22fad162":"code","2214146a":"code","e0c79f22":"code","dbc80318":"code","2e8ecf56":"code","1c93aa68":"code","8ef4d3db":"code","d2289371":"code","cec18546":"code","d2a80da1":"code","4240e4c4":"code","d1de0921":"code","bbe07b35":"markdown","69daa54a":"markdown","ab7ca350":"markdown"},"source":{"43271a55":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","943f3e6a":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","ce39f5ed":"df=pd.read_csv(\"\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")","c28d13f5":"df.shape","65bd5c7d":"df.isnull().sum()","c28477db":"df.head()","55989848":"df.rename(index=str, columns={'Annual Income (k$)': 'Income',\n                              'Spending Score (1-100)': 'Score'}, inplace=True)\ndf.head()","22fad162":"data=df.drop([\"CustomerID\"],axis=1)","2214146a":"sns.pairplot(data=data,hue=\"Gender\",aspect=1.5)\nplt.show()","e0c79f22":"data.drop(\"Gender\",axis=1,inplace=True)","dbc80318":"from sklearn.cluster import KMeans","2e8ecf56":"clusters=[]\nfor i in range (1,11):\n    km=KMeans(n_clusters=i,init=\"k-means++\",random_state=123)\n    km.fit(data)\n    clusters.append(km.inertia_)\n\nplt.plot(range(1,11),clusters)","1c93aa68":"# 3 cluster\nkm3 = KMeans(n_clusters=3).fit(data)\n\ndata['Labels'] = km3.labels_\nplt.figure(figsize=(12, 8))\nsns.scatterplot(data['Income'], data['Score'], hue=data['Labels'], \n                palette=sns.color_palette('hls', 3))\nplt.title('KMeans with 3 Clusters')\nplt.show()\n","8ef4d3db":"data.head()","d2289371":"#with 5 clusters\nkm5=KMeans(n_clusters=5).fit(data)\ndata['Labels'] = km5.labels_\nplt.figure(figsize=(12, 8))\nsns.scatterplot(data['Income'], data['Score'], hue=data['Labels'], \n                palette=sns.color_palette('hls', 5))\nplt.title('KMeans with 5 Clusters')\nplt.show()","cec18546":"fig = plt.figure(figsize=(20,8))\nax = fig.add_subplot(121)\nsns.swarmplot(x='Labels', y='Income', data=data, ax=ax)\nax.set_title('Labels According to Annual Income')\n\nax = fig.add_subplot(122)\nsns.swarmplot(x='Labels', y='Score', data=data, ax=ax)\nax.set_title('Labels According to Scoring History')\n\nplt.show()","d2a80da1":"from sklearn.cluster import AgglomerativeClustering \n\nagglom = AgglomerativeClustering(n_clusters=5, linkage='average').fit(data)\n\ndata['Labels'] = agglom.labels_\nplt.figure(figsize=(12, 8))\nsns.scatterplot(data['Income'], data['Score'], hue=data['Labels'], \n                palette=sns.color_palette('hls', 5))\nplt.title('Agglomerative with 5 Clusters')\nplt.show()\n","4240e4c4":"from scipy.cluster import hierarchy\nfrom scipy.spatial import distance_matrix \n\ndist = distance_matrix(data,data)\nprint(dist)\n","d1de0921":"Z = hierarchy.linkage(dist, 'complete')\nplt.figure(figsize=(18, 50))\ndendro = hierarchy.dendrogram(Z, leaf_rotation=0, leaf_font_size=12, orientation='right')","bbe07b35":"Elbow method tells us to select the cluster when there is a significant change in inertia. As we can see from the graph, we can say this may be either 3 or 5. Let's see both results in graph and decide.","69daa54a":"From the above plot we see that gender has no direct relation to segmenting customers. That's why we can drop it and move on","ab7ca350":"Hierarchial clustering"}}