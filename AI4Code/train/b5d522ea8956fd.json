{"cell_type":{"0c06e91a":"code","21b449f4":"code","feb89fd1":"code","ba0c64c1":"code","19ca2ef2":"code","97c18148":"code","03156548":"code","7e4d4a3d":"code","a9d170a6":"code","513918bf":"code","b373f84c":"code","d616623d":"code","472e8f10":"code","05363905":"code","2e500edb":"code","f5d0453d":"code","640c5eb9":"code","f56fa811":"code","d9e43202":"code","089b1705":"code","87c795dc":"code","6cdb5761":"code","64cca462":"code","b95c1ddf":"code","9a30e210":"code","30eb2ef0":"code","4e404e33":"code","428999d7":"code","77726677":"code","92723578":"code","6d217aad":"code","3fa4c437":"code","aeda56bd":"code","7dc6e46e":"code","229bd98f":"code","7dbb9c1f":"code","419b5870":"code","362072bd":"code","c5a57f29":"code","2ceb2971":"markdown","c07284af":"markdown","2fea9f86":"markdown","d2ed3854":"markdown","fade1b32":"markdown","46ec05e2":"markdown","6bab118d":"markdown","1fbda8e1":"markdown","bcbbb4ab":"markdown","b4ad8148":"markdown","e5ece521":"markdown","2db9e41e":"markdown","d7afd636":"markdown","4964f752":"markdown","cff5249c":"markdown","012ba29c":"markdown","dda5c46d":"markdown","dd13c196":"markdown","73842aac":"markdown","9922bac5":"markdown"},"source":{"0c06e91a":"import pandas as pd\nimport numpy as np \nfrom sklearn import preprocessing\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.metrics import mean_squared_error,roc_auc_score,explained_variance_score\nfrom sklearn.metrics import accuracy_score,confusion_matrix, mean_absolute_error\nimport matplotlib.pyplot as plt","21b449f4":"housing=pd.read_csv(r\"..\/input\/california-housing-prices\/housing.csv\")\nhousing.head()","feb89fd1":"housing.shape","ba0c64c1":"housing.size","19ca2ef2":"housing.describe()","97c18148":"housing.info()","03156548":"housing.isna().sum()","7e4d4a3d":"housing=housing.dropna()\nhousing.isna().sum()","a9d170a6":"housing.shape","513918bf":"housing.size","b373f84c":"housing.median_house_value.describe()","d616623d":"print(housing.ocean_proximity.unique())\nprint(len(housing.ocean_proximity.unique()))","472e8f10":"label_encoder=preprocessing.LabelEncoder()\nhousing.ocean_proximity= label_encoder.fit_transform(housing.ocean_proximity)\nhousing.ocean_proximity.unique()","05363905":"housing.info()","2e500edb":"names=housing.columns\nscaler=preprocessing.StandardScaler()\nscaled_housing=scaler.fit_transform(housing)\nscaled_housing=pd.DataFrame(scaled_housing,columns=names)\nscaled_housing.head()","f5d0453d":"X=scaled_housing.drop(columns=['median_house_value'])\nX.head()","640c5eb9":"Y=scaled_housing['median_house_value']\nY=pd.DataFrame(Y)\nY.head()","f56fa811":"train_X,test_X,train_Y,test_Y=train_test_split(X,Y,test_size=0.2,random_state=42)\nprint(train_X.shape)\nprint(train_Y.shape)\nprint(test_X.shape)\nprint(test_Y.shape)","d9e43202":"linereg=LinearRegression()\nmodel_linereg=linereg.fit(train_X,train_Y)\npredict_y=model_linereg.predict(test_X)","089b1705":"print( 'Mean Square Error:',mean_squared_error(predict_y,test_Y))","87c795dc":" print('Root Mean Square error:',np.sqrt(mean_squared_error(test_Y, predict_y)))","6cdb5761":" print('Mean absolute error:',mean_absolute_error(test_Y, predict_y))","64cca462":"# plot for residual error \n  \n## setting plot style \nplt.style.use('fivethirtyeight') \n  \n## plotting residual errors in training data \nplt.scatter(linereg.predict(train_X), linereg.predict(train_X) - train_Y, \n            color = \"green\", s = 10, label = 'Train data') \n  \n## plotting residual errors in test data \nplt.scatter(linereg.predict(test_X), linereg.predict(test_X) - test_Y, \n            color = \"blue\", s = 10, label = 'Test data') \n  \n## plotting line for zero residual error \nplt.hlines(y = 0, xmin = 0, xmax = 50, linewidth = 2) \n  \n## plotting legend \nplt.legend(loc = 'upper right') \n  \n## plot title \nplt.title(\"Residual errors\") \n  \n## function to show plot \nplt.show() ","b95c1ddf":"print ('Explaines Variance Score:',explained_variance_score(predict_y,test_Y))","9a30e210":"dtreg=DecisionTreeRegressor(random_state=10)\ndtreg_model=dtreg.fit(train_X,train_Y)\npredict_y=dtreg.predict(test_X)","30eb2ef0":"print('Mean Squared Error:',mean_squared_error(predict_y,test_Y))","4e404e33":" print('Root Mean Square error:',np.sqrt(mean_squared_error(test_Y, predict_y)))","428999d7":"print('Mean absolute error:',mean_absolute_error(test_Y, predict_y))","77726677":"print ('Explaines Variance Score:',explained_variance_score(predict_y,test_Y))","92723578":"X=scaled_housing['median_income']\nX=pd.DataFrame(X)\nX.head()","6d217aad":"train_X,test_X,train_Y,test_Y=train_test_split(X,Y,test_size=0.2,random_state=42)\nprint(train_X.shape)\nprint(train_Y.shape)\nprint(test_X.shape)\nprint(test_Y.shape)","3fa4c437":"linereg=LinearRegression()\nmodel_linereg=linereg.fit(train_X,train_Y)\npredict_y=model_linereg.predict(test_X)","aeda56bd":"# plot for residual error \n  \n## setting plot style \nplt.style.use('fivethirtyeight') \n  \n## plotting residual errors in training data \nplt.scatter(linereg.predict(train_X), linereg.predict(train_X) - train_Y, \n            color = \"green\", s = 10, label = 'Train data') \n  \n## plotting residual errors in test data \nplt.scatter(linereg.predict(test_X), linereg.predict(test_X) - test_Y, \n            color = \"blue\", s = 10, label = 'Test data') \n  \n## plotting line for zero residual error \nplt.hlines(y = 0, xmin = 0, xmax = 50, linewidth = 2) \n  \n## plotting legend \nplt.legend(loc = 'upper right') \n  \n## plot title \nplt.title(\"Residual errors\") \n  \n## function to show plot \nplt.show() ","7dc6e46e":"housing.plot(kind=\"scatter\", x=\"median_income\", y=\"median_house_value\", alpha=0.1)","229bd98f":"print( 'Mean Square Error:',mean_squared_error(predict_y,test_Y))","7dbb9c1f":"print('Root Mean Square error:',np.sqrt(mean_squared_error(test_Y, predict_y)))","419b5870":"print('Mean absolute error:',mean_absolute_error(test_Y, predict_y))","362072bd":"print ('Explaines Variance Score:',explained_variance_score(predict_y,test_Y))","c5a57f29":"#housing = strat_train_set.copy()\nhousing.plot(kind=\"scatter\", x=\"longitude\", y=\"latitude\", alpha=0.4, s=housing[\"population\"]\/100, \n             label=\"population\", c=\"median_house_value\", cmap=plt.get_cmap(\"jet\"), colorbar=True,\n            )\nplt.legend()\n","2ceb2971":"There is a column ocean_proximity(the type of landscape of the block) which is categorical variable. Lets convert it into numerical variable by label encoding. ","c07284af":"Now lets perform Simple linear regression using only independent variable or predictor. Here the predictor we are using is median_income ","2fea9f86":"From here, we can conform that all the columns were transformed into Numerical data.","d2ed3854":"> Exploratory Data Analysis","fade1b32":"There are 5 unique values in ocean_proximity.","46ec05e2":"There are 207 data points not available in total bedrooms. Where the total number of bedrooms are the total number of bedrooms in all houses in the block.Lets drop the rows having null values.","6bab118d":"80% training dataset and 20% test dataset ","1fbda8e1":"Extracting just the median_income column from the independent variables (from X_train and X_test)","bcbbb4ab":"Standardizing the Dataset","b4ad8148":"Ultimately, The error obtained using decision tree regressor are less than linear regression. But the change in error is negligible","e5ece521":"Here categorical column has changed to numerical column. The numbers were obtained based on alphabetical order.","2db9e41e":"> Splitting of Train and Test Data","d7afd636":"Now all the na values are dropped.","4964f752":"compared to linear regression mean square error , decision tree regression mean square error is some what less. But we can say the mean square errors are almost same","cff5249c":"> Building Models","012ba29c":"Now, Lets perform Decision Tree Regression ","dda5c46d":"Lets perform Multi Linear Regression ","dd13c196":"Predictor and response variables( independent and dependent variables) are divided. X represents Predictors and Y represents Response. We have to predict Y using X ","73842aac":"**Reading the Data**","9922bac5":"This figure shows where the median_house_value is high and low"}}