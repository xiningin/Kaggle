{"cell_type":{"28209469":"code","8b7d0e43":"code","ff781e63":"code","bdd6e4b6":"code","2fce0333":"code","3e8f4040":"code","8c8e3da4":"code","95a8a606":"code","d5357014":"code","c740ddf2":"code","63069c41":"code","ada9c837":"code","91ae9ab6":"code","ebcb910b":"code","75cdd2f1":"code","7f51d920":"code","5adeb72a":"markdown","51bda242":"markdown","149bf64d":"markdown","a0b4ab75":"markdown"},"source":{"28209469":"# Trying to segment unstructured data with K-Means clustering\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","8b7d0e43":"import matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\ndf=pd.read_csv('..\/input\/Mall_Customers.csv', index_col=0)","ff781e63":"df.head(5)","bdd6e4b6":"df.describe()","2fce0333":"#scatterplot of Annual Income Vs Spending Score against Gender as hue\nsns.set_style('whitegrid')\nsns.lmplot(\"Annual Income (k$)\", \"Spending Score (1-100)\", data=df, hue='Gender', palette='coolwarm',size=6, aspect=1, fit_reg=False)","3e8f4040":"#Distribution of Spendng Score by Gender in a histogram\nsns.set_style='darkgrid'\ndg=sns.FacetGrid(df,hue='Gender', palette='coolwarm', size=6, aspect=2)\ndg=dg.map(plt.hist, 'Spending Score (1-100)', bins=30, alpha=0.7)","8c8e3da4":"df[df['Age']>99]","95a8a606":"df[df['Spending Score (1-100)']>100]","d5357014":"from sklearn.cluster import KMeans","c740ddf2":"kmeans=KMeans(n_clusters=3) # Gender has 2 values only","63069c41":"kmeans.fit(df.drop('Gender', axis=1))","ada9c837":"kmeans.cluster_centers_","91ae9ab6":"def assign(cluster):\n    if cluster<20:\n        return 1\n    elif cluster>40:\n        return 3\n    else:\n        return 2","ebcb910b":"df['Cluster'] = df['Age'].apply(assign)","75cdd2f1":"df.tail()","7f51d920":"from sklearn.metrics import confusion_matrix, classification_report\nprint(confusion_matrix(df['Age'], kmeans.labels_))\nprint(classification_report(df['Age'], kmeans.labels_))","5adeb72a":"# K-Means Cluster creation","51bda242":"# Error Checks on Age and Score","149bf64d":"# Evaluate and assign Clusters","a0b4ab75":"##Exploratory Data Visualisations"}}