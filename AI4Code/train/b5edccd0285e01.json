{"cell_type":{"087810f8":"code","2817ccea":"code","d6e6a181":"code","b0b70eb5":"code","4b372147":"code","8aeffac3":"code","7cc0ee01":"code","21975ff3":"code","4e174230":"code","70569166":"code","db0db374":"code","a8563d34":"code","038dbc75":"code","5ac5359f":"code","57f2b9fb":"code","94f54ef2":"code","e91dc8a1":"code","a721d70e":"code","21b1ae99":"code","084fc6bc":"code","905eed1f":"code","7daf9c5c":"code","a35eba36":"code","395778f2":"code","931f0404":"code","193ba173":"code","7b945f3c":"code","5f384b23":"code","cc20e2ac":"code","35f22a4b":"code","9de4fbcc":"code","ee9a1d6f":"code","d20c2845":"code","15d393e5":"code","acc44c8c":"code","9f33a6e2":"code","f0fd9eb6":"code","7ba9e413":"code","28ccbc28":"code","017dfeb1":"code","7fe3a1cd":"code","b40e68a5":"code","4e73a024":"code","9b3b489b":"code","8f930506":"code","563b11e5":"code","cedc3e71":"code","e57eb77f":"code","7af1d447":"code","9979f840":"code","f1185fc6":"code","d1f45c28":"code","94ab6078":"code","48036eac":"code","2d24ec36":"code","ae6d3a87":"code","82657d88":"code","efdc569c":"code","d9763fdf":"code","ef5523be":"code","689e0695":"code","247ad703":"code","1bdb5b79":"code","f53f13ae":"code","effcb9e1":"code","20dc3a3a":"code","95a32b14":"code","f4773b3e":"code","b44465ca":"code","e86acf32":"code","a4271714":"code","29b71cbd":"code","62279ee2":"code","a90544b0":"code","d94988dd":"code","0796de5b":"code","7a200bad":"code","83a48823":"code","145bd1a5":"code","da45bef6":"code","8dee75af":"code","5376e062":"code","7bc30cf1":"code","7c89ef61":"code","dfdd8fb1":"code","533856ac":"code","3aae85b7":"code","893ebdc6":"markdown","e07cad1b":"markdown","78be5a9b":"markdown","a829038b":"markdown","7de8a619":"markdown","960ae246":"markdown","a1405905":"markdown","a92801dc":"markdown","5993b7db":"markdown","58332984":"markdown","5589fce1":"markdown","51d73114":"markdown","a2afc97f":"markdown","1261440d":"markdown","ca4e390d":"markdown","092ad755":"markdown","765b669a":"markdown","0928dafc":"markdown","1126bbc9":"markdown","607a7dd9":"markdown","4e4fa10c":"markdown","c87f1f7d":"markdown","ab7bfbf2":"markdown","708289a3":"markdown","13d938b0":"markdown","8683af3d":"markdown","cba00b1e":"markdown","b7ea7779":"markdown","477cffab":"markdown","197c2852":"markdown","c6410216":"markdown","4ebefc1a":"markdown","cf8a5c9a":"markdown","95280a30":"markdown","51a92a60":"markdown","05e3cdbe":"markdown","018927f1":"markdown","1f9799a9":"markdown","f282ed0e":"markdown","7433001e":"markdown","cfa0abfc":"markdown","99026a96":"markdown","4762579e":"markdown","2341ed82":"markdown","0bf83b3a":"markdown","365a026e":"markdown","17eab3da":"markdown","6d3938db":"markdown","bf24f3bd":"markdown","5285ffb7":"markdown","691dd880":"markdown","c791e814":"markdown","ddc9ec30":"markdown","dbf53746":"markdown","e3e04adf":"markdown","d1a85d08":"markdown","bc9a8aba":"markdown","eadc9469":"markdown","47291c1b":"markdown","6d8703d8":"markdown","928fffb8":"markdown","e7b84bae":"markdown","7a7f66e8":"markdown","74bc1507":"markdown","cce95745":"markdown","a6768ab6":"markdown","3aaa5d82":"markdown","1114b6fa":"markdown","5d154ff7":"markdown","c378b7c0":"markdown","d26f6f5d":"markdown","aa99e46e":"markdown","8ed5e642":"markdown","02d491e0":"markdown","2cfb471e":"markdown","a8bcd67d":"markdown","0c3d5486":"markdown","49320f9a":"markdown","441b1d8b":"markdown","069a127b":"markdown","1d6f9336":"markdown","6488237a":"markdown","0d1071e9":"markdown","509ca641":"markdown","f7480037":"markdown","aa95a7be":"markdown","24d0f9ce":"markdown","bde6ba7d":"markdown","3a27bf0e":"markdown","3e06ad43":"markdown","a3ae8783":"markdown","6de8d78f":"markdown","2ab9676e":"markdown","2392afad":"markdown","a27af798":"markdown","f48fac71":"markdown","6f08228c":"markdown","bd22604b":"markdown","89e1872e":"markdown","e5dbc2ac":"markdown","c78a3366":"markdown","dca35663":"markdown","f88602c5":"markdown","5a75b623":"markdown","83a0df16":"markdown","19b43026":"markdown","deb2c38f":"markdown","f4520b4e":"markdown","9760baf0":"markdown"},"source":{"087810f8":"%matplotlib inline","2817ccea":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom collections import Counter\n\nfrom sklearn.preprocessing import MinMaxScaler, LabelEncoder\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.tree import DecisionTreeClassifier, plot_tree\nfrom sklearn.multiclass import OneVsRestClassifier\nfrom sklearn.metrics import make_scorer, f1_score, accuracy_score, classification_report, confusion_matrix\nfrom sklearn.metrics import roc_curve, roc_auc_score\n\nfrom sklearn.cluster import KMeans","d6e6a181":"pip install scikit-plot","b0b70eb5":"import scikitplot as skplt","4b372147":"obesity_data = pd.read_csv(\"..\/input\/obesity-levels\/ObesityDataSet_raw_and_data_sinthetic.csv\")","8aeffac3":"obesity_data.head()","7cc0ee01":"obesity_data.shape","21975ff3":"obesity_data.info()","4e174230":"def count_values(dataset, cat_variable, order = None):\n    \"\"\"\n    Function: Counts values in each category and displays them on a plot.\n    \n    Parameters: Dataset, category feature, and order of appearance (order is optional).\n    \"\"\"\n    ax = sns.countplot(x = cat_variable, data = dataset, palette = \"Blues_r\", order = order)\n    for p in ax.patches:\n        ax.annotate(f\"\\n{p.get_height()}\", (p.get_x()+0.2, p.get_height()), \n                    ha = \"center\", va = \"top\", color = \"white\", size = 10)\n    \n    plt.title(f\"Number of items in each {cat_variable} category\")\n    plt.show()","70569166":"count_values(obesity_data, \"Gender\")","db0db374":"def plot_distribution(dataset, feature):\n    \"\"\"\n    Function: Computes and displays distribution of features with continuous values; plots their mean and median.\n    \n    Parameters: Dataset and feature with continuous values.\n    \"\"\"\n    plt.hist(dataset[feature], bins = \"fd\")\n    \n    plt.axvline(dataset[feature].mean(), color = \"red\", label = \"mean\")\n    plt.axvline(dataset[feature].median(), color = \"orange\", label = \"median\")\n    \n    plt.xlabel(f\"{feature}\")\n    plt.ylabel(\"Count\")\n    plt.legend()\n    plt.title(f\"Distribution of values in {feature}\")\n    plt.show()","a8563d34":"obesity_data[\"Age\"].describe()","038dbc75":"obesity_data[\"Age\"].median()","5ac5359f":"plot_distribution(obesity_data, \"Age\")","57f2b9fb":"plot_distribution(obesity_data, \"Height\")","94f54ef2":"plot_distribution(obesity_data, \"Weight\")","e91dc8a1":"plt.scatter(obesity_data[\"Height\"], obesity_data[\"Weight\"], alpha = 0.5)\nm, b = np.polyfit(obesity_data[\"Height\"], obesity_data[\"Weight\"], 1)\nplt.plot(obesity_data[\"Height\"], m * obesity_data[\"Height\"] + b, color = \"red\")\n\nplt.xlabel(\"Height [m]\")\nplt.ylabel(\"Weight [kg]\")\nplt.title(\"Correlation between 'Height' and 'Weight'\")\nplt.show()","a721d70e":"count_values(obesity_data, \"family_history_with_overweight\")","21b1ae99":"count_values(obesity_data, \"FAVC\")","084fc6bc":"plot_distribution(obesity_data, \"FCVC\")","905eed1f":"plot_distribution(obesity_data, \"NCP\")","7daf9c5c":"count_values(obesity_data, \"CAEC\", [\"no\", \"Sometimes\", \"Frequently\", \"Always\"])","a35eba36":"count_values(obesity_data, \"SMOKE\")","395778f2":"plot_distribution(obesity_data, \"CH2O\")","931f0404":"count_values(obesity_data, \"SCC\")","193ba173":"plot_distribution(obesity_data, \"FAF\")","7b945f3c":"plot_distribution(obesity_data, \"TUE\")","5f384b23":"count_values(obesity_data, \"CALC\")","cc20e2ac":"plt.figure(figsize = (7, 4))\ncount_values(obesity_data, \"MTRANS\")","35f22a4b":"plt.figure(figsize = (12, 5))\ncount_values(obesity_data, \"NObeyesdad\", [\"Insufficient_Weight\", \"Normal_Weight\", \"Overweight_Level_I\", \"Overweight_Level_II\", \"Obesity_Type_I\", \"Obesity_Type_II\", \"Obesity_Type_III\"]) ","9de4fbcc":"def cross_plot(dataset, lead_category, sup_category, order = None):\n    \"\"\"\n    Function: Plots interaction between two categorical variables.\n    \n    Parameters: Dataset, lead category, suplemental category, and order of appearance (order is optional).\n    \"\"\"\n    \n    sns.countplot(x = lead_category, hue = sup_category, data = dataset, order = order, palette = \"Blues_r\")\n    \n    plt.show()","ee9a1d6f":"plt.figure(figsize = (13, 5))\ncross_plot(obesity_data, \"NObeyesdad\", \"Gender\", [\"Insufficient_Weight\", \"Normal_Weight\", \"Overweight_Level_I\", \"Overweight_Level_II\", \"Obesity_Type_I\", \"Obesity_Type_II\", \"Obesity_Type_III\"])","d20c2845":"plt.figure(figsize = (13, 5))\ncross_plot(obesity_data, \"NObeyesdad\", \"family_history_with_overweight\", [\"Insufficient_Weight\", \"Normal_Weight\", \"Overweight_Level_I\", \"Overweight_Level_II\", \"Obesity_Type_I\", \"Obesity_Type_II\", \"Obesity_Type_III\"])","15d393e5":"plt.figure(figsize = (13, 5))\ncross_plot(obesity_data, \"NObeyesdad\", \"FAVC\", [\"Insufficient_Weight\", \"Normal_Weight\", \"Overweight_Level_I\", \"Overweight_Level_II\", \"Obesity_Type_I\", \"Obesity_Type_II\", \"Obesity_Type_III\"]) ","acc44c8c":"plt.figure(figsize = (18, 5))\ncross_plot(obesity_data, \"NObeyesdad\", \"CAEC\", [\"Insufficient_Weight\", \"Normal_Weight\", \"Overweight_Level_I\", \"Overweight_Level_II\", \"Obesity_Type_I\", \"Obesity_Type_II\", \"Obesity_Type_III\"]) ","9f33a6e2":"plt.figure(figsize = (13, 5))\ncross_plot(obesity_data, \"NObeyesdad\", \"SMOKE\", [\"Insufficient_Weight\", \"Normal_Weight\", \"Overweight_Level_I\", \"Overweight_Level_II\", \"Obesity_Type_I\", \"Obesity_Type_II\", \"Obesity_Type_III\"]) ","f0fd9eb6":"plt.figure(figsize = (13, 5))\ncross_plot(obesity_data, \"NObeyesdad\", \"SCC\", [\"Insufficient_Weight\", \"Normal_Weight\", \"Overweight_Level_I\", \"Overweight_Level_II\", \"Obesity_Type_I\", \"Obesity_Type_II\", \"Obesity_Type_III\"]) ","7ba9e413":"plt.figure(figsize = (18, 5))\ncross_plot(obesity_data, \"NObeyesdad\", \"CALC\", [\"Insufficient_Weight\", \"Normal_Weight\", \"Overweight_Level_I\", \"Overweight_Level_II\", \"Obesity_Type_I\", \"Obesity_Type_II\", \"Obesity_Type_III\"]) ","28ccbc28":"plt.figure(figsize = (18, 5))\ncross_plot(obesity_data, \"NObeyesdad\", \"MTRANS\", [\"Insufficient_Weight\", \"Normal_Weight\", \"Overweight_Level_I\", \"Overweight_Level_II\", \"Obesity_Type_I\", \"Obesity_Type_II\", \"Obesity_Type_III\"]) ","017dfeb1":"obesity_data.describe().T","7fe3a1cd":"obesity_numeric = obesity_data[[\"Age\", \"Height\", \"Weight\", \"FCVC\", \"NCP\", \"CH2O\", \"FAF\", \"TUE\"]]","b40e68a5":"fig, axs = plt.subplots(ncols = 4, nrows = 2, figsize = (20, 8))\n# fig.delaxes(axs[1][3])\nidx = 0\naxs = axs.flatten()\nfor k, v in obesity_numeric.items():\n    sns.boxplot(y = k, data = obesity_numeric, ax = axs[idx])\n    idx += 1\nplt.tight_layout(pad = 0.4, w_pad = 0.5, h_pad = 5.0)","4e73a024":"plt.figure(figsize = (12, 10))\nsns.heatmap(obesity_data.corr(),\n           annot = True,\n           cmap = \"Blues_r\",\n           linewidths = 2, \n           linecolor = \"white\")\nplt.title(\"Correlation matrix of obesity data\")\nplt.show()","9b3b489b":"obesity_dummies = pd.get_dummies(obesity_data[[\"Gender\", \"family_history_with_overweight\", \"FAVC\", \"CAEC\", \"SMOKE\", \"SCC\", \"CALC\", \"MTRANS\"]])","8f930506":"obesity_lab = obesity_data[[\"NObeyesdad\"]]","563b11e5":"obesity_concatenated = pd.concat([obesity_numeric, obesity_dummies, obesity_lab], axis = 1)","cedc3e71":"obesity_concatenated.head()","e57eb77f":"obesity_label = obesity_concatenated[\"NObeyesdad\"]\nobesity_features = obesity_concatenated.drop(\"NObeyesdad\", axis = 1)","7af1d447":"obesity_label","9979f840":"obesity_features.info()","f1185fc6":"obesity_features = obesity_features.astype(\"float\")","d1f45c28":"obesity_features.dtypes","94ab6078":"obesity_features_scaled = MinMaxScaler().fit_transform(obesity_features)","48036eac":"obesity_features_scaled.min(axis = 1), obesity_features_scaled.max(axis = 1)","2d24ec36":"encoder = LabelEncoder()","ae6d3a87":"encoder.fit(obesity_label)","82657d88":"list(encoder.classes_)","efdc569c":"obesity_labels_encoded = encoder.transform(obesity_label)","d9763fdf":"obesity_labels_encoded","ef5523be":"obesity_features_tr, obesity_features_ts, obesity_labels_tr, obesity_labels_ts = train_test_split(\n                obesity_features, obesity_labels_encoded, \n                test_size = 0.2, stratify = obesity_labels_encoded,\n                random_state = 42) # shuffle=True","689e0695":"obesity_features_tr.shape, obesity_labels_tr.shape, obesity_features_ts.shape, obesity_labels_ts.shape","247ad703":"Counter(obesity_labels_tr)","1bdb5b79":"Counter(obesity_labels_ts)","f53f13ae":"f1 = make_scorer(f1_score, average = \"weighted\")","effcb9e1":"params = {\n    \"max_depth\": [5, 7, 9, 11, 13, 15]\n}","20dc3a3a":"grid_search = GridSearchCV(DecisionTreeClassifier(), param_grid = params, cv = 5, scoring = f1)","95a32b14":"grid_search.fit(obesity_features_tr, obesity_labels_tr)","f4773b3e":"grid_search.cv_results_","b44465ca":"grid_search.best_params_","e86acf32":"model_tree = DecisionTreeClassifier(max_depth = 13, random_state = 42)","a4271714":"def train_predict_score(estimator, train_features, train_labels, test_features, test_labels):\n    \"\"\"\n    Function: Trains model, predict classes and computes accuracy and f1 score.\n    \n    Parameters: estimator, X_train, y_train, X_test, y_test.\n    \"\"\"\n    estimator.fit(train_features, train_labels)\n    \n    print(f\"Accuracy on Train data: {accuracy_score(train_labels, estimator.predict(train_features))}\")\n    print(f\"F1 score on Train data: {f1_score(train_labels, estimator.predict(train_features), average = 'weighted')}\")\n    print(f\"Accuracy on Test data: {accuracy_score(test_labels, estimator.predict(test_features))}\")\n    print(f\"F1 on Test data: {f1_score(test_labels, estimator.predict(test_features), average = 'weighted')}\")","29b71cbd":"train_predict_score(model_tree, obesity_features_tr, obesity_labels_tr, obesity_features_ts, obesity_labels_ts)","62279ee2":"plt.figure(figsize = (22, 6))\nplot_tree(model_tree, max_depth = 2)\nplt.show()","a90544b0":"print(classification_report(obesity_labels_ts, model_tree.predict(obesity_features_ts)))","d94988dd":"model_tree.classes_","0796de5b":"list(encoder.classes_)","7a200bad":"plt.figure(figsize = (8, 6))\nsns.heatmap(confusion_matrix(obesity_labels_ts, model_tree.predict(obesity_features_ts)),\n           annot = True,\n           fmt = \".0f\",\n           cmap = \"Blues_r\",\n           linewidths = 2, \n           linecolor = \"white\",\n           xticklabels = model_tree.classes_,\n           yticklabels = model_tree.classes_)\nplt.show()","83a48823":"obesity_score_probability = model_tree.predict_proba(obesity_features_ts)","145bd1a5":"obesity_score_probability","da45bef6":"roc_auc_score(obesity_labels_ts, obesity_score_probability, multi_class = \"ovr\")","8dee75af":"skplt.metrics.plot_roc(obesity_labels_ts, obesity_score_probability)\nplt.show()","5376e062":"kmeans = KMeans(n_clusters = 7, init = \"k-means++\")","7bc30cf1":"model_tree.feature_importances_","7c89ef61":"def plot_clusters(dataset, feature_one, feature_two, labels, title = None):\n    \"\"\"\n    Function: Computes and displays clusters.\n    \n    Parameters: dataset, 2 features, cluster indicator.\n    \"\"\"\n    sns.scatterplot(data = dataset, x = feature_one, y = feature_two, hue = labels, palette = \"Blues_r\")\n    if title is not None:\n        plt.title(title)\n    plt.show()","dfdd8fb1":"plot_clusters(obesity_features_ts, \"Height\", \"Weight\", obesity_labels_ts, \"Clusters in Test data\")","533856ac":"predicted_labels = kmeans.fit_predict(obesity_features_ts)","3aae85b7":"plot_clusters(obesity_features_ts, \"Height\", \"Weight\", predicted_labels, \"Predicted clusters\")","893ebdc6":"Transportation seems does not (significantly) affect a person's weight. Both slim, normal and overweight people use public transport; all groups rely on cars as well.","e07cad1b":"### III.3 Convert Numerical Values","78be5a9b":"Classes on both plots differ since the clustering algorithm does not know how to order them (i.e., which predicted values correspond to class 0, which - to class 1, etc.). Nonetheless, KMeans managed to group \"Height\" and \"Weight\" points in 7 categories which very much overlap the testing labels.","a829038b":"A person's height and weight are the most important factors determining his\/her obesity status. Other factors might also play a role, e.g., eating habits and physical activity. Dataset features could be used both for classification and clustering tasks but it should be borne in mind that most samples are synthetically generated, i.e., they do not reflect the real world. Thus, robust conclusions require much more data representative for larger groups.","7de8a619":"#### Physical INactivity","960ae246":"Both normal weight and overweight\/obese people consume high calories food. Perhaps food quantity makes the difference and affects body fats.","a1405905":"##### Overweight and high calories food","a92801dc":"## Conclusion","5993b7db":"There are almost an equal number of females and males in the dataset. Data is available for slightly more men than women but this does not make it imbalanced.","58332984":"The first sample has the highest probability of being 0-th class, the second - 1-st class, and so forth.","5589fce1":"##### Overweight and Gender","51d73114":"Features and labels are separated and stored in different variables.","a2afc97f":"This Notebook explores the *Dataset for estimation of obesity levels based on eating habits and physical condition in individuals from Colombia, Peru and Mexico*[1] published on the University of California Irvine Machine Learning Repository ([link to the dataset](https:\/\/archive.ics.uci.edu\/ml\/datasets\/Estimation+of+obesity+levels+based+on+eating+habits+and+physical+condition+)). \"ScienceDirect\" provides free access to the corresponding [paper](https:\/\/www.sciencedirect.com\/science\/article\/pii\/S2352340919306985?via%3Dihub).\n\nThe dataset has 2111 records and 17 features. The records are labeled with the class variable \"NObesity\" (Obesity Level) that allows classification in 7 groups: \"Insufficient Weight\", \"Normal Weight\", \"Overweight Level I\", \"Overweight Level II\", \"Obesity Type I\", \"Obesity Type II\" and \"Obesity Type III\". The dataset authors note that 23% of the records were collected directly from users through a web platform, and the remaining 77% were generated synthetically with Weka tool and SMOTE filter.\n\nEating habits, physical activity, and genes are factors which affect person's obesity predisposition. The task here is to explore the dataset, and to find a decent model that would be capable to tell if someone is overweight or obese, or his or her body fits into the normal (health) range. On the other hand, an attempt was made to cluster the data based on all features (predictors). Both - classification and clustering - tasks are described after data exploration.","1261440d":"Decision trees are easier to interpret. If plotted (see below), they show how decisions were taken (i.e., how classification happened). Each node \"asks\" a question; if the response is \"True\", the information is transmitted to the child node on the left; if it is \"False\", information goes to the child on the right. This process continues either until no more questions could be asked, or until reaching \"max_depth\" limit. Only the first 2 nodes are displayed below.","ca4e390d":"It seems smoking is not a predictor or does not affect body weight. There is a tiny number of smokers who could be both normal and overweight.","092ad755":"Survey respondents had to say if they eat high caloric food frequenty. There were only two possible answers: \"yes\" or \"no\". Most of them (ca. 88%) admitted they consume high caloric food.","765b669a":"### IV. 1 Build Model","0928dafc":"The code line below confirms the features hold only \"float64\" numbers now.","1126bbc9":"Most Machine Learning classification algorithms expect labels with numeric values (and not strings). For this reason, obesity class is encoded with `LabelEncoder()`. The latter replaces each class with an integer. \n\nFirst, the encoder is instantiated. Then, it \"overviews\" the data. `transform()` encodes the classes and assigns them the respective number.","607a7dd9":"ROC Curves are ploted below. They climb up and to the left, which indicates a good model performance. As found earlier, the model best predicts class 4 (light green line), class 6 (red line) and class 0 (black line). AUCs for all classes are displayed on the legend.","4e4fa10c":"# Exploring and modelling Obesity Dataset","c87f1f7d":"Respondents were asked to share their physical activity. They had to choose 1 out of 4 optional answers: \"I do not have\", \"1 or 2 days\", \"2 or 4 days\", and \"4 or 5 days\". Values in \"FAF\" column are continuous instead of categorical ones. These are plotted below but their distribution (as well as mean and median) are hard for interpretation.","ab7bfbf2":"Cross-validation shows that almost all combinations reach \"f1 score\" close to or above 90%. ","708289a3":"#### Normal, Overweight or Obese?","13d938b0":"#### Meals per day","8683af3d":"##### Overweight and smoking","cba00b1e":"There might exist a weak link between alcohol and obesity. The data suggest that people who \"sometimes\" drink alcohol could face weight propblems.","b7ea7779":"Weight of those who \"frequently\" or \"always\" get food between meals does not seem to be abnormal. Only people having snaks from time to time go into \"Overweight\" or \"Obesity\" categories.","477cffab":"The first modelling task is to classify data into obesity categories. \"Accuracy\" is a good performance metric but \"f1 score\" (geometric mean of \"precision\" and \"recall\") is a more appropriate one. To use it for grid search and cross validation, it is instantiated as a variable. \n\nIt could be assumed that many classifiers would return good scores. `DecisionTreeClassifier()` is chosen for its simplicity and interpretability. It has several hyper-parameters, which could be tuned but only tree's depth was used.\n\n`RandomSearchCV()` checks which combination returns best results. The grid space is limited between 5 and 15 tree nodes (questions). These are stored in a dictionary, which is passed to for searching. Models are trained and cross-validated on 5 folds.","197c2852":"##### Overweight and family history","c6410216":"Features and their projection should be visualized to show how clustering works. However, displaying more than 3 dimensions on a 2D surface is impossible. For this reason, only the most important features (i.e., those holding the most valuable information) are shown. `DecisionTreeClassifier()` found that the second (\"Height\") and the third (\"Weight\") columns are the most important ones. They bear 21.9% and 47.85%, respectively, of the information in the data. The output below also shows that values in some columns were not beneficial for revealing their relationship with obesity and could have been removed.","4ebefc1a":"#### Does overweight run in the family? ","cf8a5c9a":"For clarity, `fit`, `predict`, and `score` are placed in a function, which facilitates model training, evaluation and selection. In this particular case it will only print Decision Tree's preformance in terms of its \"accuracy\" and \"f1 score\" on both sets. ","95280a30":"`confusion_matrix` shows *actual* vs *predicted* labels. Rows represent actual classes, while columns represent predicted classes. For example, 47 samples were properly classified in the 0-th class but 7 were wrongly placed in 1-st class. Only one sample of class 4 was misclassified as a sample of class 3.","51a92a60":"## II. Exploratory Data Analysis","05e3cdbe":"Most people (around 3\/4) rely on public transportation. Much fewer respondents use their cars. The remainder either commute or use a bike or motorbike.","018927f1":"The boxplots below show quartiles and outliers. Distributions in the last 5 columns are not taken into account. \n\nThe first boxplot suggests that there are outliers in the \"Age\" column. However, 40, 50 or 60 years of age are normal values (they are not extreme or errors) and for this reason these are not removed. \"Height\" does not seem to have outliers, and \"Weight\" has only a couple ones. These are not treated either.","1f9799a9":"An experiment was made to use dataset's features clustering. Forming separate clusters would indicate that values for the given features are specific for particular overweight\/obesity type. The task is performed with \"KMeans\" - the simplest clustering algorithm. Instantiating requires setting the number of clusters to form, as well as the number of centroids to generate. Number of clusters is known: 7, for each weight type. \"K-means++\" is the chosen method for initialization - it selects initial cluster centers in a smart way to speed up convergence.","f282ed0e":"### III.5 Encode Labels","7433001e":"### III.6 Train - Test split","cfa0abfc":"### III.2 Separate Features and Labels","99026a96":"Values in all features should be in the same range. Otherwise, the algorithm might misinterpret and assign them wrong coefficients (weights). Obesity features are scaled with `MinMaxScaler()` which makes all values between 0 and 1. The second row confirms the scaling was successful.","4762579e":"#### Smoke","2341ed82":"Similarly, people were asked to state how much time they spend on using technological devices such as cell phone, videogames, television, computer, etc. They could say \"0-2 hours\", \"3-5 hours\", and \"More than 5 hours\". Responses are stored as continuous values. Their distribution, which could not be interepreted, is shown below.","0bf83b3a":"Both \"accuracy\" and \"f1 score\" on the training data are 100% but on the testing one is 91%-92%. The latter suggests the model is overfitting. Its performance could be improved either with regularization (e.g., shallower tree, setting minimum samples per leaf), or with feature selection (e.g., removing non-important columns), or with increasing the number of samples in both sets. Neither of these techniques is explored further since \"accuracy\" and \"f1 score\" over 90% is not so disappointing.","365a026e":"##### Overweight and alcohol","17eab3da":"It would be interesting to see if there is any relationship between \"Height\" and \"Weight\" since both metrics are used to compute `Body mass index`. Furthermore, these are the most important features (see Chapter V) for predicting if a person suffers from overweight\/obesity.\n\nThe code line below plots each person's weight and height. The red line shows that there is a positive correlation between them, which means an increase in one variable leads to an increase in the other. In other words, taller people are more likely to weight more.","6d3938db":"`classification_report` is a `scikit learn` function which shows classification success (metrics) for each class. For example, most of the samples in \"Obesity_Type_III\" (class 4) were properly classified. The model reached 100% \"precision\" and 99% \"f1 score\". On the other hand, features indicating \"Normal_Weight\" (class 1) were wrongly interpreted and got around 80% on \"precision\" and \"f1 score\". ","bf24f3bd":"All three sets - numeric features, one-hot encoded ones, and labels are concatenated in a new DataFrame. It has 32 columns now. Its head rows are displayed below. ","5285ffb7":"People had to say if and how offen they eat between meals. They could answer eigher \"No\" (if they do not get bites between regular time for eating), or \"Sometimes\", \"Frequently\", or \"Always\". The data suggests that most people \"sometimes\" get small snacks between meals.","691dd880":"`Counter` tells how many examples are placed in each class. The outputs below show that there are sufficient number of samples both in training and testing set. ","c791e814":"#### Gender","ddc9ec30":"Most people drink alcohol \"sometimes\", but almost a third claim they do not consume any alcoholic beverages.","dbf53746":"#### Food between meals","e3e04adf":"It is interesting to see how Overweight\/Obesity interact with different categorical variables. The function below computes and plots this interaction.","d1a85d08":"The best model is a tree with 13 nodes (questions). Therefore, this value is set as a hyper-parameter. ","bc9a8aba":"#### Drink alcohol","eadc9469":"A brief check confirms the dataset has 2111 rows and 17 columns.","47291c1b":"## V. Clustering ","6d8703d8":"Another popular classification metric is the ROC curve (Receiver Operating Characteristic curve). It is a graph showing the performance of a classification model at all classification thresholds. This curve plots two parameters: True Positive Rate and False Positive Rate. Area Under the Curve (AUC) represents the probability that a random positive example is positioned to the right of a random negative example. AUC ranges in value from 0 to 1. A model whose predictions are 100% wrong has an AUC of 0.0; one whose predictions are 100% correct has an AUC of 1.\n\nAUC and ROC curve require computing probability prediction scores. These show the probability a certain sample belongs to a particular class.","928fffb8":"A brief check shows that some columns hold \"float64\" numbers, and another - \"uint8\" values. Machine Learning algorithms work best with floating point numbers. For this reason, all values are converted into floats.","e7b84bae":"It seems people do not worry about the calories they get daily. On the other hand, they might not have been aware of the nutritional value and ingredients of each food if these were not listed on the packing.","7a7f66e8":"### IV. 2. Train and Evaluate Model","74bc1507":"Categorical variables are one-hot encoded with `get_dummies()`. Labels (i.e., the column holding information if a person is overweight\/obese or not) are stored in separate variable; it will be used later.","cce95745":"Weight does not offer interesting observations. Distribution is more or less bi-modal; the mean and the median are shifted to the left because of the larger number of people weighting 80 kg. ","a6768ab6":"#### Monitor intake of calories ","3aaa5d82":"#### Consumption of high caloric food","1114b6fa":"## IV. Train model to classify data into obesity categories","5d154ff7":"Five-number statistics does not reveal much information about features with numeric values. Data in most columns (except age, height and weight) are not interpretable. Nonetheless, these are displayed below.","c378b7c0":"##### Classification Report","d26f6f5d":"##### Confusion Matrix","aa99e46e":"The output below shows that there are not missing values in the DataFrame; half of the features hold numeric (float64) values, and the other half - categorical ones. All are further explored in this Chapter. In general, the dataset is tidy, hence data cleaning was not neccessary.","8ed5e642":"People who tend to monitor their calories intake are less likely to get excess weight.","02d491e0":"It seems obesity runs in the family. All those categorised as overweight or obese had family members suffering from weight problems.","2cfb471e":"#### Imports","a8bcd67d":"##### Overweight and food between meals","0c3d5486":"Clusters (formed by \"Height\" and \"Weight\" features) in the testing data according to their real labels are plotted below. ","49320f9a":"Obesity is determined by computing the `Body mass index`. It is a function of person's height and weight. The exact formula is $Body mass index = \\frac{Weight}{Height * Height}$. Thus, height is an important element for determining obesity. \n\nDistribution of height values is plotted below. Most people are 1.60 m - 1.85 m tall. Both mean and median values are around 1.70. Still, height values do not seem to be normally distributed.","441b1d8b":"#### Height","069a127b":"Most respondents do not smoke.","1d6f9336":"#### Age","6488237a":"#### Drink water","0d1071e9":"The original data are provided in a `csv` file. It is loaded and stored in `obesity_data`. The first five rows are displayed below.","509ca641":"Women are more likely to have \"Insufficient weight\" than men. On the other hand, there are more obese men than women, save in the last, extreme obesity category.","f7480037":"`KMeans` computes the distances between each point (described by feature values) and assigns it to a cluster. Thus, clustering could be considered an unsupervised learning classification tool (algorithm). However, its performance could not assessed since there are not evaluation metrics for unsuprevised training. ","aa95a7be":"Computing and visualizing distribution of continuous values is wrapped in a function, too. It displays not only data distribution but also its mean and median.","24d0f9ce":"#### Transportation","bde6ba7d":"The dataset is split into training and testing sets. A validation set was not withheld since the dataset is small and sufficient number of samples should be kept for training. Cross validation during Grid Search addresses this drawback. \n\nSplitting function (`train_test_split`) shuffles the data and reserves 20% for testing. Datasets' shape after splitting is checked below.","3a27bf0e":"Similarly, repondents had to point the number of main meals they have daily: \"Between 1 and 2\",  \"Three\", and \"More than three\". Instead of categorical, this feature also holds numerical values. Mean and median are not informative here either.","3e06ad43":"### III.4 Scale Features","a3ae8783":"#### Weight","6de8d78f":"##### Overweight and means of transport","2ab9676e":"As mentioned earlier, part of the data were collected thought an online survey. Respondents had several options to answer each question. Features hold information gathered for each particular question and the corresponding possible answers. These are described and explored below.\n\nCounting and visualizing categorical variables is wrapped in a function for avoiding repeated operations. The first plot shows the number of men and women in the dataset.","2392afad":"#### Physical activity","a27af798":"\"FCVC\" column denotes if people consume vegetables. Possible answers were \"Never\", \"Sometimes\", and \"Always\". It is not clear why values are numeric and not categorical (discrete) ones. It could be assumed that \"3\" means \"Always\", \"2\" - \"Sometimes\", and \"1\" - \"Never\", but it is not clear what the values inbetween mean.","f48fac71":"People were asked if family members suffered from overweight. Most of them replied affirmative.","6f08228c":"##### Overweight and monitoring calories","bd22604b":"### II. 1. Explore Features","89e1872e":"##### ROC Score and Curve","e5dbc2ac":"(Linear) correlation between numeric features is weak or nonexistent. Thus, all features remain in the table.","c78a3366":"## III. Data pre-processing\n### III.1. Encoding Features","dca35663":"### II. 2. Explore Statistics","f88602c5":"People, according to their `Body mass index (BMI)`, are categorised as:\n\n* Underweight if BMI < 18.5\n* Normal if BMI 18.5 - 24.9 \n* Overweight if BMI 25.0 - 29.9\n* Obesity I if BMI 30.0 - 34.9\n* Obesity II if BMI 35.0 to 39.9\n* Obesity III if BMI > 40\n\nNumber of people per category is displayed below (note: categories are ordered logically).\n\nThe plot shows the dataset is balanced; only \"Obese Type I\" class slightly outnumber the other categories.","5a75b623":"## I. Load data","83a0df16":"The youngest person in the dataset is 14 years old, and the oldest one - 61 years of age. Values in this column are not normally distributed; the historgram is positively skewed with mean (24.31) and median (22.78) closer to the lower bound.","19b43026":"## References:\n\n[1] Palechor, F. M., & de la Hoz Manotas, A. (2019). Dataset for estimation of obesity levels based on eating habits and physical condition in individuals from Colombia, Peru and Mexico. Data in Brief, 104344.","deb2c38f":"Drinking water habits should have been categorised in three groups: \"Less than a litter\", \"Between 1 and 2 L\", and \"More than 2 L\". Instead, the answeres are entered as continuous values. Their distribution (not very informative, too) is shown below.","f4520b4e":"#### Consumption of vegetables","9760baf0":"Aggregated AUC score for all classes (computed as \"One vs Rest\") is around 95%. This is not so bad performance."}}