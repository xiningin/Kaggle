{"cell_type":{"909e3c00":"code","145c9b27":"code","dea977fb":"code","a8b970b6":"code","fdb2b981":"code","00972ecb":"code","24016806":"code","a79fcce3":"code","3558cffb":"code","5760f3da":"code","2a1a23fc":"code","01ef6c88":"code","ea0b6ae8":"code","d63caaf6":"code","24f2cc1f":"code","fa69d078":"code","cb098e6e":"code","84a940dd":"code","c05b88bc":"code","a7a65551":"markdown","e4131f1e":"markdown"},"source":{"909e3c00":"import numpy as np, pandas as pd\nfrom glob import glob\nimport shutil, os\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import GroupKFold\nfrom tqdm.notebook import tqdm\nimport seaborn as sns\nimport cv2\nfrom os import listdir\nfrom os.path import isfile, join\nimport yaml\nimport torch\nfrom IPython.display import Image, clear_output\nimport subprocess\nfrom pathlib import Path","145c9b27":"!pip install wget","dea977fb":"!mkdir -p \/kaggle\/working\/sample\n!mkdir -p \/kaggle\/working\/sample2","a8b970b6":"!wget -P \/kaggle\/working\/sample 'https:\/\/samplelib.com\/lib\/preview\/mp4\/sample-5s.mp4' ","fdb2b981":"if '\/kaggle\/working\/yolov5' not in os.listdir('\/kaggle\/working\/'):\n    shutil.copytree('\/kaggle\/input\/yolov5-official-v31-dataset\/yolov5','\/kaggle\/working\/yolov5') \n    print('yolov5 copytree')\nos.chdir('\/kaggle\/working\/yolov5')\n\nclear_output()\nprint('Setup complete. Using torch %s %s' % (torch.__version__, torch.cuda.get_device_properties(0) if torch.cuda.is_available() else 'CPU'))","00972ecb":"!python detect.py --weights yolov5s.pt --img 640 --conf 0.25 --source ..\/sample","24016806":"from matplotlib import animation, rc\nrc('animation', html='jshtml')","a79fcce3":"def create_animation(ims):\n    fig=plt.figure(figsize=(14,14))\n    plt.axis('off')\n    im=plt.imshow(cv2.cvtColor(ims[0],cv2.COLOR_BGR2RGB))\n    \n    def animate_func(i):\n        im.set_array(cv2.cvtColor(ims[i],cv2.COLOR_BGR2RGB))\n        return [im]\n\n    return animation.FuncAnimation(fig, animate_func, frames=len(ims), interval=1000\/\/5)","3558cffb":"imgdir ='\/kaggle\/working\/yolov5\/runs\/detect\/exp\/' ","5760f3da":"print(os.listdir('\/kaggle\/working\/yolov5\/runs\/detect\/exp\/'))","2a1a23fc":"def video_2_frames(video_file='\/kaggle\/working\/yolov5\/runs\/detect\/exp\/sample-5s.mp4', image_dir='..\/sample2\/', image_file='img_%s.png'):\n    i = 0\n    cap = cv2.VideoCapture(video_file)\n    while(cap.isOpened()):\n        flag, frame = cap.read()\n        if flag == False:\n            break\n        cv2.imwrite(image_dir+image_file % str(i).zfill(6), frame) \n        i += 1\n    cap.release()","01ef6c88":"video_2_frames()","ea0b6ae8":"paths0=[]\nfor file in os.listdir('\/kaggle\/working\/sample2'):\n    paths0+=[os.path.join('\/kaggle\/working\/sample2',file)]\npaths0[0:5]","d63caaf6":"paths1=[]\nfor item in paths0:\n    if item[-4:]=='.png':\n        paths1+=[item]","24f2cc1f":"order=[]\nfor item in paths1:\n    order+=[int(item[:-4].split('_')[-1])]\npaths2=pd.DataFrame(paths1)\npaths2[1]=order\npaths2.columns=['path','int']\npaths2=paths2.sort_values('int')\npaths3=paths2['path'].tolist()\npaths3[0:5]","fa69d078":"images0=[]\nfor i in tqdm(range(0,len(paths3),1)):\n    images0+=[cv2.imread(paths3[i])]","cb098e6e":"def create_animation(ims):\n    fig=plt.figure(figsize=(14,14))\n    plt.axis('off')\n    im=plt.imshow(cv2.cvtColor(ims[0],cv2.COLOR_BGR2RGB))\n    \n    def animate_func(i):\n        im.set_array(cv2.cvtColor(ims[i],cv2.COLOR_BGR2RGB))\n        return [im]\n\n    return animation.FuncAnimation(fig, animate_func, frames=len(ims), interval=1000\/\/5)","84a940dd":"print(len(images0))","c05b88bc":"create_animation(np.array(images0))","a7a65551":"# sample.mp4 download","e4131f1e":"# YOLOv5"}}