{"cell_type":{"5a6cf542":"code","ed750606":"code","a980c583":"code","3646798e":"code","fd476b61":"code","057dc84c":"code","befacee1":"code","e9d85f31":"code","d5072541":"code","db3f37e7":"code","32e95d13":"code","e7945681":"code","064e4439":"code","af809639":"code","7329223c":"code","6e6aa56d":"code","3afe318d":"code","47773ac3":"code","3869f090":"code","f6704075":"code","3da12944":"code","f8073c15":"markdown","ea9fef30":"markdown"},"source":{"5a6cf542":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.metrics import mean_absolute_error\n\nfrom sklearn.model_selection import train_test_split","ed750606":"data = pd.read_csv(\"..\/input\/melb_data.csv\")\n\ndata.head()","a980c583":"data.columns","3646798e":"data.isnull().sum()\ndata = data.dropna(axis=0,how='any')\ndata.isnull().sum()","fd476b61":"data.describe()","057dc84c":"y = data['Price']     #Prediction Target","befacee1":"x = data[['Rooms','Bathroom','Landsize','Lattitude','Longtitude']]","e9d85f31":"x.describe()","d5072541":"x.head()","db3f37e7":"model = DecisionTreeRegressor()\n\nmodel.fit(x,y)","32e95d13":"print(\"Making predictions\")\nprint(x)\n\nprint(\"Predictions : \")\na = model.predict(x)\na","e7945681":"data.head()","064e4439":"mean_absolute_error(y,a)","af809639":"train_x,val_x,train_y,val_y = train_test_split(x,y,random_state=0)","7329223c":"model = DecisionTreeRegressor()\n\nmodel.fit(train_x,train_y)","6e6aa56d":"a = model.predict(val_x)\nprint(a)","3afe318d":"print(mean_absolute_error(val_y,a))","47773ac3":"def get_mae(leaf_nodes,train_x,val_x,train_y,val_y):\n    model = DecisionTreeRegressor(max_leaf_nodes=leaf_nodes,random_state=0)\n    model.fit(train_x,train_y)\n    a = model.predict(val_x)\n    mae = mean_absolute_error(val_y,a)\n    return(mae)","3869f090":"for leaf_nodes in np.arange(5,5000,500):\n    mae = get_mae(leaf_nodes,train_x,val_x,train_y,val_y)\n    print(leaf_nodes,\"  >>>>>>>>>>  \",mae)","f6704075":"data.head()","3da12944":"x = data[['Rooms','Bathroom','Landsize','Lattitude','Longtitude']]\n\ny=data['Price']\n\n\nfrom sklearn.ensemble import RandomForestRegressor\n\nmodel = RandomForestRegressor(random_state=1)\nmodel.fit(train_x,train_y)\na=model.predict(val_x)\nmean_absolute_error(val_y,a)","f8073c15":"**Decision Tree Regression**","ea9fef30":"**Random Forest**"}}