{"cell_type":{"1c15ce98":"code","16c74fc3":"code","cc5ff248":"code","d898a8f1":"code","ad607d30":"code","1078cb42":"code","e683adf7":"code","c50f4fac":"code","53a70ddd":"code","009eb53b":"code","1ff6b1b7":"code","7a0a3f04":"code","f7778ea1":"code","964c5f80":"code","7173bf55":"code","7809744e":"code","0021fc27":"code","e78bc1b8":"code","1e63475a":"code","1023ac8c":"code","426b061e":"code","c82b9456":"code","69860946":"code","4bf18bad":"code","10d9410f":"code","d7b4cb85":"code","1900ebec":"code","d05c742c":"code","d5ac5942":"code","9b62ffd1":"code","c8ea8eae":"markdown","210e8d27":"markdown"},"source":{"1c15ce98":"import pandas as pd\nwater=pd.read_csv('..\/input\/water-potability\/water_potability.csv')\nwater.head()","16c74fc3":"water.info()","cc5ff248":"water.describe()","d898a8f1":"Potability_0=water[water.Potability==0]\nPotability_0.head()","ad607d30":"round(Potability_0.isnull().sum()*100\/len(Potability_0),2).sort_values(ascending=False)","1078cb42":"Potability_0.describe()","e683adf7":"Potability_0.fillna(Potability_0.median(), inplace=True)\nPotability_0.describe()","c50f4fac":"Potability_1=water[water.Potability==1]\nPotability_1.head()","53a70ddd":"round(Potability_1.isnull().sum()*100\/len(Potability_1),2).sort_values(ascending=False)","009eb53b":"Potability_1.fillna(Potability_1.median(), inplace=True)\nPotability_1.describe()","1ff6b1b7":"import numpy as np\nwater=pd.concat([Potability_1, Potability_0], axis=0)\nwater = water.iloc[np.random.permutation(len(water))]\nwater=water.reset_index(drop=True)\nwater.head()","7a0a3f04":"water.nunique()","f7778ea1":"round(water.Potability.value_counts()*100\/len(water),2)","964c5f80":"data = water.sample(frac=0.8, random_state=42)\ndata_unseen = water.drop(data.index)\ndata.reset_index(inplace=True, drop=True)\ndata_unseen.reset_index(inplace=True, drop=True)\nprint('Data for Modeling: ' + str(data.shape))","7173bf55":"print('Unseen Data For Predictions: ' + str(data_unseen.shape))","7809744e":"round(data.Potability.value_counts()*100\/len(data),2)","0021fc27":"!pip install pycaret","e78bc1b8":"from pycaret.classification import *","1e63475a":"water_test= setup(data = data, target = 'Potability', session_id=42,\n                  normalize = True, \n                  transformation = True, \n                  log_experiment = True,\n                  handle_unknown_categorical = True, \n                  unknown_categorical_method = 'most_frequent',\n                  remove_multicollinearity = True, #rop one of the two features that are highly correlated with each other\n                  ignore_low_variance = True,#all categorical features with statistically insignificant variances are removed from the dataset.\n                  combine_rare_levels = True,\n                  fix_imbalance = True\n                 )","1023ac8c":"rf = create_model('rf')","426b061e":"print(rf)","c82b9456":"tuned_rf = tune_model(rf,optimize = 'MCC')","69860946":"plot_model(tuned_rf, plot = 'auc')","4bf18bad":"plot_model(tuned_rf, plot = 'pr')","10d9410f":"plot_model(tuned_rf, plot='feature')","d7b4cb85":"plot_model(tuned_rf, plot = 'confusion_matrix')","1900ebec":"evaluate_model(tuned_rf)","d05c742c":"predict_model(tuned_rf)","d5ac5942":"unseen_predictions = predict_model(tuned_rf, data=data_unseen)\nunseen_predictions.head()","9b62ffd1":"print(\"Confidence Score :   {}\".format(round(unseen_predictions.Score.mean(),2)))#Confidence Score","c8ea8eae":"#### Treating Missing value for Potability_1 records","210e8d27":"#### Treating Missing value for Potability_0 records"}}