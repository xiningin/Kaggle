{"cell_type":{"092a834d":"code","45493cc4":"code","411a3b04":"code","7c57f565":"code","d2b77901":"code","288c6e01":"code","ba7335d0":"code","2d76c49b":"code","0eaebbe8":"code","15536997":"code","8a09e49c":"code","d535c80a":"code","5c3bd473":"code","f94d621d":"code","3612a5e3":"code","9f05c24b":"code","fd899fc9":"code","a5858364":"code","8e99cadc":"code","3beacc5d":"code","79b3841e":"code","73a6f70d":"code","0f1f9807":"code","46e6a1cb":"code","b5a7cc7b":"code","9fabed65":"code","14253864":"code","4a1da079":"code","f7ee6baf":"code","809fb072":"code","4d882cb0":"markdown","a655c26e":"markdown"},"source":{"092a834d":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nsns.set_style('white')\nimport matplotlib.pyplot as plt\n%matplotlib inline","45493cc4":"import os\nprint(os.listdir(\"..\/input\/womens-ecommerce-clothing-reviews\"))","411a3b04":"df = pd.read_csv(\"..\/\/input\/\/womens-ecommerce-clothing-reviews\/\/Womens Clothing E-Commerce Reviews.csv\")\ndf.head()","7c57f565":"df.drop(df.columns[0], axis = 1,inplace=True)\ndf.head()","d2b77901":"df.info()","288c6e01":"df.describe()","ba7335d0":"#type(df['Review Text'])\ndf['Review Text']=df['Review Text'].astype(str)\ndf['Review Length']=df['Review Text'].apply(len)\ndf.head(10)","2d76c49b":"g = sns.FacetGrid(df,col='Rating')\ng.map(plt.hist,'Review Length')","0eaebbe8":"sns.boxplot(x='Rating',y='Review Length',data=df,palette='rainbow')","15536997":"sns.countplot(x='Rating',data=df,palette='rainbow')","8a09e49c":"ratings = df.groupby('Rating').mean()\nratings","d535c80a":"ratings.corr()","5c3bd473":"sns.heatmap(ratings.corr(),cmap='coolwarm',annot=True)","f94d621d":"df_part = df[(df.Rating==1) | (df.Rating==5)]","3612a5e3":"X = df_part['Review Text'].astype(str)\n\ny = df_part['Rating']","9f05c24b":"from sklearn.feature_extraction.text import CountVectorizer\ncv = CountVectorizer()","fd899fc9":"X = cv.fit_transform(X)","a5858364":"from sklearn.model_selection import train_test_split","8e99cadc":"X_train, X_test, y_train, y_test = train_test_split(X, y,test_size=0.3,random_state=101)","3beacc5d":"from sklearn.naive_bayes import MultinomialNB\nnb = MultinomialNB()","79b3841e":"nb.fit(X_train,y_train)","73a6f70d":"predictions = nb.predict(X_test)","0f1f9807":"from sklearn.metrics import confusion_matrix,classification_report","46e6a1cb":"print(confusion_matrix(y_test,predictions))\nprint('\\n')\nprint(classification_report(y_test,predictions))","b5a7cc7b":"from sklearn.feature_extraction.text import  TfidfTransformer\nfrom sklearn.pipeline import Pipeline","9fabed65":"pipeline = Pipeline([\n    ('bow', CountVectorizer()),  # strings to token integer counts\n    ('tfidf', TfidfTransformer()),  # integer counts to weighted TF-IDF scores\n    ('classifier', MultinomialNB()),  # train on TF-IDF vectors w\/ Naive Bayes classifier\n])","14253864":"X = df_part['Review Text']\ny = df_part['Rating']\nX_train, X_test, y_train, y_test = train_test_split(X, y,test_size=0.3,random_state=101)","4a1da079":"pipeline.fit(X_train,y_train)","f7ee6baf":"predictions = pipeline.predict(X_test)","809fb072":"print(confusion_matrix(y_test,predictions))\nprint(classification_report(y_test,predictions))","4d882cb0":"**Using TFIDF receive worse results.**","a655c26e":"Found good results using Naive Bayes NLP method"}}