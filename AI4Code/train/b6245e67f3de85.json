{"cell_type":{"06b7867f":"code","e040fddd":"code","54730e0c":"code","839d2ae8":"code","b1bb5276":"code","55a2baf8":"code","b91eb80d":"code","ec5328e5":"code","2066a1a4":"code","21d17f4b":"code","6f9b2cc7":"code","61fb7f64":"code","34d0ddda":"code","c7ac3a52":"code","7bf681f9":"code","23771215":"code","122b8da6":"code","bafbde27":"code","f569bbb4":"code","7627b914":"code","8ccb9522":"markdown","beac8410":"markdown","bda93ee7":"markdown","e989423a":"markdown","5c10456f":"markdown","8bba5b73":"markdown","d9fbc81b":"markdown","48975051":"markdown","67cd7e0a":"markdown","964739f2":"markdown","dc30ab7d":"markdown","9f856dd9":"markdown","3e3b5f08":"markdown","dd1f8264":"markdown","d24f202b":"markdown","2ac1789c":"markdown","56c8c759":"markdown","3d1af1bc":"markdown","72d52b62":"markdown"},"source":{"06b7867f":"#Importing the Libraries\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings(\"ignore\",category=DeprecationWarning)\n","e040fddd":"#Loading the dataset\ndata = pd.read_csv(\"..\/input\/insurance.csv\")\ndata.head()","54730e0c":"#Checking the summary of the dataset\ndata.describe()","839d2ae8":"#Checking for Null values in the dataset\ndata.isnull().sum()","b1bb5276":"# Making copy of the dataset\ndf = data.copy()","55a2baf8":"#Encoding the features\nfrom sklearn.preprocessing import LabelEncoder\n#smoker\nlabelencoder_smoker = LabelEncoder()\ndf.smoker = labelencoder_smoker.fit_transform(df.smoker)\n#sex\nlabelencoder_sex = LabelEncoder()\ndf.sex = labelencoder_sex.fit_transform(df.sex)\n#region\nlabelencoder_region = LabelEncoder()\ndf.region = labelencoder_region.fit_transform(df.region)\n","b91eb80d":"df.head()","ec5328e5":"df.corr()['charges'].sort_values()","2066a1a4":"%matplotlib inline\nplt.hist(df.charges,bins = 10,alpha=0.5,histtype='bar',ec='black')\nplt.title(\"Frequency Distribution of the charges\")\nplt.xlabel('Charges')\nplt.ylabel('Frequency')\nplt.show()","21d17f4b":"sns.boxplot(x=data.region,y=data.charges,data=data)\nplt.title(\"Medical charges per region\")\nplt.show()","6f9b2cc7":"sns.boxplot(x=data.smoker,y=data.charges,data=data)\nplt.title(\"Medical charges of Smokers and Non-Smokers\")\nplt.show()","61fb7f64":"f = plt.figure(figsize=(12,5))\nax = f.add_subplot(121)\nsns.distplot(df[df.smoker==1]['charges'],color='c',ax=ax)\nax.set_title('Medical charges for the smokers')\n\nax = f.add_subplot(122)\nsns.distplot(df[df.smoker==0]['charges'],color='b',ax=ax)\nax.set_title('Medical charges for non-smokers')\nplt.show()","34d0ddda":"sns.boxplot(x=data.sex,y=data.charges,data=data)\nplt.title(\"Charges by Gender\")\nplt.show()","c7ac3a52":"plt.subplot(1,2,1)\nsns.distplot(df[df.smoker==1]['age'],color='red')\nplt.title(\"Distribution of Smokers\")\n\nplt.subplot(1,2,2)\nsns.distplot(df[df.smoker==0]['age'],color='green')\nplt.title(\"Distribution of Non-Smokers\")\nplt.show()","7bf681f9":"sns.lmplot(x=\"bmi\",y='charges',hue='smoker',data=data)\n","23771215":"sns.lmplot(x='age',y='charges',hue='smoker',data=data,palette='inferno_r')","122b8da6":"from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\n\n#Considering all the features\n\nX = df.iloc[:,:6].values\nY = df.iloc[:,6].values\n\n#Splitting the dataset into train and test set\nX_train,X_test,Y_train,Y_test = train_test_split(X,Y,test_size=0.25)\n\n# Training\nregressor = LinearRegression()\nregressor.fit(X_train,Y_train)\n\nprint(regressor.score(X_test,Y_test))\n","bafbde27":"#Not considering region\nX1 = df.iloc[:,[0,1,2,3,4]].values\nY1 = df.iloc[:,6].values\n\nX_train,X_test,Y_train,Y_test = train_test_split(X1,Y1,test_size=0.25)\n\n#Training\nregressor = LinearRegression()\nregressor.fit(X_train,Y_train)\n\nprint(regressor.score(X_test,Y_test))","f569bbb4":"from sklearn.preprocessing import PolynomialFeatures\n\npoly_reg  = PolynomialFeatures(degree=2)\nX_poly = poly_reg.fit_transform(X)\n\nX_train,X_test,Y_train,Y_test = train_test_split(X_poly,Y,test_size=0.25)\n\nlin_reg = LinearRegression()\nlin_reg  = lin_reg.fit(X_train,Y_train)\n\nprint(lin_reg.score(X_test,Y_test))","7627b914":"pred_train = lin_reg.predict(X_train)\npred_test = lin_reg.predict(X_test)\n\nplt.scatter(pred_train,pred_train - Y_train,label='Train data',color='mediumseagreen')\nplt.scatter(pred_test,pred_test-Y_test,label=\"Test data\",color='darkslateblue')\nplt.legend(loc = 'upper right')\nplt.xlabel('Predicted values')\nplt.ylabel('Tailings')\nplt.show()","8ccb9522":"Medical charge increases in case of **smoker** with the increasing **bmi**. But in case of **non-smokers** the increase in **bmi** doesn't have large impact on the medical charges.","beac8410":"Our model is able to predict good results for the medical charges of the people.\n","bda93ee7":"The boxplot between the **medical charges** of **smokers** and **non-smokers** conveys that those who smoke spend around 4 times more on medicines or treatment as comparerd to those who don't smoke.","e989423a":"This is a good result as compared to the previous models.\n","5c10456f":"Finding the correlation between **charges** and  other features and arranging them in increasing order.","8bba5b73":"The above plot represents the ditribution of the medical charges which tells us\nhow many patients spend how much money on treatment on average.","d9fbc81b":"These plots represents the distribution of **medical charges** for the **smokers** and **non-smokers**.","48975051":"The above boxplot shows money spent by people on their** treatment** in different **regions**. From the plot we can say that the region doesn't have much impact on medical charges.","67cd7e0a":"**Thank you**","964739f2":"In the case of non-smokers, the cost of treatment increases with age, while in case of the  smokers, there is not do such dependence. We can also see that age has positive correlation and has larger affect after the smoker that leads to increase in the charges. And it is also a common phenomenon that with increasing age medical expenses will increase whether you are a smokeror not.","dc30ab7d":"There are 3 categorical features : **\"sex\",\"smoker\",\"region\"** in our dataset. So we will encode these categorical features.","9f856dd9":"These plots represents the distribution of **smokers** and **non-smokers** with in accordance with their **age**.","3e3b5f08":"After encoding our dataset looks like this.","dd1f8264":"The boxplot between **sex** and **charges** shows that there is no **gender biasing** with the medical charges . It doesn't matter whether you are a male or a female the charges remains same for all.","d24f202b":"Now we will predict the cost of treatment on the basis of the given features.\nWe will start with **regression** , in the beginning we are considering **all the features**.","2ac1789c":"Now, we will check the result using **Polynomial regression**.","56c8c759":"**Visualizing the regression model **","3d1af1bc":"We can see that there is no **Null value** in our dataset.","72d52b62":"In the second model we are using **regression** but not considering **region** due to its **negative correlation** with medical** charges**."}}