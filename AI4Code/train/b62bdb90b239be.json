{"cell_type":{"ca7c432f":"code","c85f24da":"code","31d257cf":"code","9ac593de":"code","0c55b75b":"code","88bc24b3":"code","c8f25253":"code","7b6d4937":"code","e6aba007":"code","53cd26c4":"code","9c739bda":"code","df62aa18":"code","2705d0a3":"code","a7682073":"code","328e16fc":"markdown","bcf20ea8":"markdown"},"source":{"ca7c432f":"# Import necessary libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy import stats","c85f24da":"# US Population data from World Bank\n# Source: https:\/\/data.worldbank.org\/indicator\/SP.POP.TOTL?locations=US\n# Dataset: https:\/\/api.worldbank.org\/v2\/en\/indicator\/SP.POP.TOTL?downloadformat=csv\npop = pd.read_csv('\/kaggle\/input\/independent-data-scientist\/API_SP.POP.TOTL_DS2_en_csv_v2_3469297.csv', skiprows=4, index_col='Country Code')","31d257cf":"# World CO2 emissions (metric tons per capita)\n# Source: https:\/\/data.worldbank.org\/indicator\/EN.ATM.CO2E.PC\n# Dataset: https:\/\/api.worldbank.org\/v2\/en\/indicator\/EN.ATM.CO2E.PC?downloadformat=csv\nco2 = pd.read_csv('\/kaggle\/input\/independent-data-scientist\/API_EN.ATM.CO2E.PC_DS2_en_csv_v2_3470453.csv', skiprows=4, index_col='Country Code')","9ac593de":"# Merge datasets and calculate Total CO2 emissions\ndf = pd.concat([pop.loc['USA'], co2.loc['USA']], axis=1).loc['1960':'2020']\ndf.columns = ['Population', 'CO2 Emission per Capita']\ndf = df.apply(pd.to_numeric)\ndf['Total CO2 Emission'] = df['Population'] * df['CO2 Emission per Capita'] \/ 10e9\ndf.index = df.index.astype('int64')\ndf['Year'] = df.index","0c55b75b":"# Plot a chart of CO2 emissions per capita and total CO2 emissions (for fun)\nfig, (ax0, ax1) = plt.subplots(ncols=2, figsize=(16, 8))\np = sns.regplot(data=df, x='Year', y='Total CO2 Emission', ax=ax1);\np2 = sns.regplot(data=df, x='Year', y='CO2 Emission per Capita', ax=ax0);\np.axes.set_xlabel(None)\np.axes.set_ylabel('Total CO2 Emission', size=14);\np2.axes.set_xlabel(None);\np2.axes.set_ylabel('CO2 Emission per Capita', size=14);\n# Add a title\nplt.suptitle('US Carbondioxide Emissions for the period 1960-2020', fontsize=18, y=0.93);\n\nfor spine in p.axes.spines.values():\n    spine.set_color('lightgrey')\n\nfor spine in p2.axes.spines.values():\n    spine.set_color('lightgrey')","88bc24b3":"# NOAA Climate Data\n# Source: https:\/\/www.ncdc.noaa.gov\/cdo-web\/datasets\/GSOM\/locations\/CITY:US260002\/detail\n# Due to data size restrictions, we need to pull data in four parts.\n\npart1 = pd.read_csv('\/kaggle\/input\/independent-data-scientist\/2830031.csv')\npart2 = pd.read_csv('\/kaggle\/input\/independent-data-scientist\/2830036.csv')\npart3 = pd.read_csv('\/kaggle\/input\/independent-data-scientist\/2830037.csv')\npart4 = pd.read_csv('\/kaggle\/input\/independent-data-scientist\/2830293.csv')\ncli = pd.concat([part1, part2, part3, part4], axis=0)","c8f25253":"# Necessary type conversions and addition of extra fields for futher calculations of daily, monthly, and yearly averages.\ncli['DATE'] = pd.to_datetime(cli['DATE'])\ncli['MONTH'] = cli['DATE'].dt.month\ncli['YEAR'] = cli['DATE'].dt.year","7b6d4937":"# Create a monthly average temperature map for the last 60 years (for fun)\ncli_pvt = pd.pivot_table(cli, index=['YEAR','MONTH'], values=['TAVG'], aggfunc=np.mean).reset_index()\nsns.relplot(\n    data=cli_pvt, x='MONTH', y='TAVG', hue='YEAR', alpha=0.05, height=5, aspect=1, palette='rocket_r', s=250\n);","e6aba007":"# Calculate monthly averages over all stations.\nmonthly_avg = pd.pivot_table(cli, index=['YEAR','MONTH'], values=['TAVG', 'PRCP', 'SNOW', 'AWND'], aggfunc=np.mean).reset_index()\n# And finally, calculate yearly averages\nyearly_avg = pd.pivot_table(monthly_avg, index=['YEAR'], values=['TAVG', 'PRCP', 'SNOW', 'AWND'], aggfunc=np.mean).reset_index()","53cd26c4":"# Plot yearly averages: Temperature, precipitation, snow, and wind speed (for fun)\nfig, ((ax0, ax1), (ax2, ax3)) = plt.subplots(ncols=2, nrows=2, figsize=(16, 12))\np = sns.regplot(data=yearly_avg, x='YEAR', y='TAVG', ax=ax0);\np1 = sns.regplot(data=yearly_avg, x='YEAR', y='PRCP', ax=ax1);\np2 = sns.regplot(data=yearly_avg, x='YEAR', y='SNOW', ax=ax2);\np3 = sns.regplot(data=yearly_avg, x='YEAR', y='AWND', ax=ax3);\n\np.axes.set_xlabel(None);\np.axes.set_ylabel('Average Temperature ($^\\circ$C)', size=14);\np1.axes.set_xlabel(None)\np1.axes.set_ylabel('Precipitation (mm)', size=14);\np2.axes.set_xlabel(None);\np2.axes.set_ylabel('Snow (mm)', size=14);\np3.axes.set_xlabel(None)\np3.axes.set_ylabel('Wind Speed (m\/s)', size=14);\n# Add a subtitle\nplt.suptitle('Ann Arbor Weather Between 1960-2020', fontsize=20, y=0.91);\n\nfor i in [p, p1, p2, p3]:\n    for spine in i.axes.spines.values():\n        spine.set_color('lightgrey')","9c739bda":"# Merge Ann Arbor climate and U.S. CO2 emmission data into a single data frame for the final output\nyearly_avg.set_index('YEAR', inplace=True)\ndf.index = df.index.astype('int64')\ndf = df.merge(yearly_avg, left_index=True, right_index=True)\ndf.head()","df62aa18":"# Plot the relation as a joint plot (for fun)\njgrid = sns.jointplot(data=df, x='Total CO2 Emission', y='TAVG', kind='reg');","2705d0a3":"# This is the final output for the assignment.\nfig, ((ax0, ax1), (ax2, ax3)) = plt.subplots(ncols=2, nrows=2, figsize=(16, 16))\np = sns.regplot(data=df, x='Year', y='CO2 Emission per Capita', ax=ax0);\np1 = sns.regplot(data=df, x='Year', y='Total CO2 Emission', ax=ax1);\np2 = sns.regplot(data=df, x='Year', y='TAVG', ax=ax2);\np3 = sns.regplot(data=df, x='Total CO2 Emission', y='TAVG', ax=ax3, scatter_kws = {\n      \"color\": \"#C93D3A\"\n   }, line_kws = {\n      \"color\": \"#C93D3A\"\n   });\np.axes.set_xlabel(None);\np.axes.set_ylabel('CO$_2$ Emission per Capita (mt)', size=14);\np1.axes.set_xlabel(None)\np1.axes.set_ylabel('Total CO$_2$ Emission (10$^9$ mt)', size=14);\np2.axes.set_xlabel(None);\np2.axes.set_ylabel('Average Temperature ($^\\circ$C)', size=14);\np3.axes.set_xlabel('Total CO$_2$ Emission (10$^9$ mt)', size=14)\np3.axes.set_ylabel('Average Temperature ($^\\circ$C)', size=14);\n# Add a title\nplt.suptitle('U.S. CO$_2$ Emissions and Ann Arbor Weather Between 1960-2020', fontsize=20, y=0.91);\n\nfor i in [p, p1, p2, p3]:\n    for spine in i.axes.spines.values():\n        spine.set_color('lightgrey')\n\nplt.savefig('myfig.png', facecolor='white', dpi=300)","a7682073":"# Check if the corelation is meaningful and descriptive. Statistically, that does not seem to be the case.\nmask = ~np.isnan(df['Total CO2 Emission']) & ~np.isnan(df['TAVG'])\n\nslope, intercept, r_value, p_value, std_err = stats.linregress(df['Total CO2 Emission'][mask],df['TAVG'][mask])\nr_value**2, p_value","328e16fc":"### Get and process climate data for Ann Arbor for the years 1960-2021","bcf20ea8":"### Get and process U.S. population and CO$_2$ emission data from World Bank"}}