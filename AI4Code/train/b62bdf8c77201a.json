{"cell_type":{"34672da0":"code","c812ef48":"code","3a2019f6":"code","331e7c78":"code","6337469a":"code","f06874f3":"code","63502ec1":"code","9d8346db":"code","7723ac53":"code","1e6ce326":"code","fe805058":"code","ccad98ad":"code","81097f5b":"code","fa91fd33":"markdown","c7c9eae2":"markdown","9e8a9821":"markdown","63710b9b":"markdown","619e5c4c":"markdown","5305b1c3":"markdown","ed0bc3fe":"markdown","6431962c":"markdown","b1e9f8cc":"markdown","e72e70f9":"markdown","7da875a2":"markdown","0713db0d":"markdown"},"source":{"34672da0":"import numpy as np # linear algebra\nimport pandas as pd # data processing\nfrom sklearn.ensemble import  GradientBoostingClassifier # classifier","c812ef48":"df = pd.read_csv(\"..\/input\/greyhound-racing-uk-predict-finish-position\/data_final.csv\")","3a2019f6":"df.head()","331e7c78":"df.info()","6337469a":"# Features\nfeatures = ['Trap', 'BSP', 'Time_380', 'Finish_Recent', 'Finish_All', 'Stay_380',\\\n            'Races_All','Odds_Recent','Odds_380', 'Distance_Places_All', 'Dist_By',\\\n            'Races_380', 'Odds','Last_Run','Early_Time_380', 'Early_Recent' ,\\\n            'Distance_All', 'Wins_380', 'Grade_380','Finish_380','Early_380',\\\n            'Distance_Recent', 'Public_Estimate','Wide_380', 'Favourite']\n# Target\ntarget = ['Finished']","f06874f3":"df[features].corr()","63502ec1":"df[['BSP','Odds','Public_Estimate','Finished']].corr()\nfeatures.remove('Odds')\nfeatures.remove('Public_Estimate')\nprint(features)\nprint(\"\\nThere are now\",len(features),\"features remaining.\")","9d8346db":"train=df.sample(frac=0.80,random_state=10) #random state is a seed value\ntest=df.drop(train.index)","7723ac53":"# train_X, train_y\ntrain_X = train[features]\ntrain_y = train[target]\n\n# test_X, test_y\ntest_X = test[features]\ntest_y = test[target]","1e6ce326":"# Create model\nmodel = GradientBoostingClassifier(n_estimators = 10, max_features = None, min_samples_split = 2)\nmodel.fit(train_X, train_y.values.ravel())","fe805058":"# evaluate the model on TRAINING DATA\naccuracy = model.score(train_X, train_y)\nprint('    Training Model Accuracy:    ' + str(round(accuracy*100,2)) + '%')","ccad98ad":"# evaluate the model on Test data\naccuracy = model.score(test_X, test_y)\nprint('    Test Model Accuracy:  ' + str(round(accuracy*100,2)) + '%')","81097f5b":"# evaluate the market on Test data\n# the feature 'Public_Estimate' gives the market prediction of finish position for each greyhound.\nmarket_data = list(zip(test['Public_Estimate'], test['Finished']))\ntotal = len(list(market_data))\ncount=0\nfor val in market_data:\n    if val[0] == val[1]:\n        count+=1\nprint('    Test Market Accuracy:      ' + str(round(count\/total,3)*100) + '%')  # - - test   ","fa91fd33":"# Predicting Greyhound Finishing Position, 1st to 6th.\n## 1. Description.\n### There are 2,000 races in the dataset. Crayford 380 metre races only. The dataset can be used to predict the race winner or the finishing position of each greyhound. This notebook will be used to create a classification model of greyhound finish postion.\n### Research Question:\n### Can the model outperform the market in predicting the finish position of greyhounds in competitive six-runner races, 1st to 6th?","c7c9eae2":"### 1.3.6 Calculate Market Predictions of Greyhound Finishing Position\n> Does the model beat the market in predicting finish positon?\n> Yes, sligthly.","9e8a9821":"### 1.3.5 Test the Model","63710b9b":"### 2. Conclusion","619e5c4c":"#### The model outperformed the market in predicting greyhound finishing position, slightly. \n#### Model Accuracy = 22.12%\n#### Market Accuracy = 20.9%","5305b1c3":"## 1.3.1 The features \/ predictor variables","ed0bc3fe":"### There are three odds related features, 'BSP','Odds' & 'Public_Estimate'.\n> These are highly correlated, see correlation matrix below.\n> Betfair Starting Price (BSP) is most highly correlated with the target 'Finished', this feature will be kept.\n> I will remove the other two odds features, 'Odds' and 'Public_Estimate' from the list of features to use in my prediction model.","6431962c":"## 1.1 Loading Packages and Data","b1e9f8cc":"## 1.3 Building the classification model, predicting finish position 1st to 6th.\n>  I will be creating a multiclass classifier, using sklearn's Gradient Boosting Classifier. The target variable is 'Finished', 1 to 6 (1st to 6th).  \n>  The variable 'Race_ID' (this is for Identification only) will not be used. 'Winner', which is the binary classification target variable, 1 to 0 (Win\/lose), will also be removed as this is clearly cheating.\n>  \n","e72e70f9":"### 1.3.2 Splitting the data, train & test.","7da875a2":"### 1.3.3 Train the model","0713db0d":"## 1.2 Exploring the dataset"}}