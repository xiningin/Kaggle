{"cell_type":{"8031586b":"code","a1bf4790":"code","0440cfb9":"code","c4e8ff6e":"code","658bc8e5":"code","1f37204b":"code","faac55cf":"code","49c80c6f":"code","45c662be":"code","5cb9f136":"code","22ab6d6e":"code","cc51afdb":"code","cc507533":"code","6f839926":"code","1c5631d9":"code","3fa8c124":"code","053d687f":"code","10f2cffb":"code","8cde0bfa":"code","82d0c223":"code","4fcea0ce":"code","83635543":"code","285e3b4d":"code","292f7125":"code","46c8560f":"code","e5f73c08":"code","fd25d24f":"code","673fa5c9":"code","a76d5225":"code","51753aaf":"code","ac969a32":"code","00ca2d20":"code","0e0f95d6":"code","2d321571":"code","3e791d9f":"code","b02ddc0f":"code","cfdd863e":"code","fbf8e432":"code","6e414e7d":"code","35ffe436":"code","2e60870d":"code","27d74121":"code","e0db1ab6":"code","b39ca274":"code","08f9b3ba":"code","24491950":"code","ec5bb312":"code","e961cffa":"markdown","a988575c":"markdown","7db1d62b":"markdown","55677163":"markdown","928e049c":"markdown","7842a233":"markdown","b5faf7b3":"markdown","43db1fc1":"markdown","7b289191":"markdown","9f2252ee":"markdown","98273f59":"markdown","9f8210e9":"markdown","c0cffe77":"markdown","c0be7bbd":"markdown","e99af4af":"markdown","7f996c3c":"markdown","131f04d4":"markdown","dbd87f95":"markdown","aa4fd73f":"markdown","bb2371f8":"markdown","fb931a98":"markdown","edeb5348":"markdown","9cf06232":"markdown","42fd98f8":"markdown","dd0411e6":"markdown","3e70a8ae":"markdown","12b2ec71":"markdown","6d95e9d8":"markdown","daf5cda9":"markdown"},"source":{"8031586b":"\n!pip install pycaret","a1bf4790":"from pycaret.regression import *\nimport pandas as pd","0440cfb9":"train = pd.read_csv('..\/input\/house-prices-advanced-regression-techniques\/train.csv')\ntest = pd.read_csv('..\/input\/house-prices-advanced-regression-techniques\/test.csv')\nprint(train.shape, test.shape)\ntest.head()","c4e8ff6e":"!pip install autoviml","658bc8e5":"from autoviml.Auto_ViML import Auto_ViML","1f37204b":"target = 'SalePrice'\nm, feats, trainm, testm = Auto_ViML(train, target, test,\n                            sample_submission='',\n                            scoring_parameter='', KMeans_Featurizer=False,\n                            hyper_param='RS',feature_reduction=True,\n                             Boosting_Flag='CatBoost', Binning_Flag=False,\n                            Add_Poly=2, Stacking_Flag=True,Imbalanced_Flag=False,\n                            verbose=1)","faac55cf":"import time\nstart_time = time.time()\nreg = setup(data = train,target = 'SalePrice', numeric_imputation = 'mean',normalize = True,\n             ignore_features = ['Alley','PoolQC','MiscFeature','Fence','FireplaceQu','Utilities'],pca=True,\n    pca_method='linear',pca_components=30,silent = True,session_id = 3650)\nprint('Time taken (in secs) = %0.0f' %(time.time()-start_time))","49c80c6f":"start_time = time.time()\ncompare_models(exclude = ['tr'] , turbo = True) \nprint('Time taken (in secs) = %0.0f' %(time.time()-start_time))","45c662be":"cb = create_model('catboost')","5cb9f136":"from autoviml.Auto_ViML import print_reg_metrics\ny_pred = testm[target+'_predictions'].values\ny_pred","22ab6d6e":"prediction = predict_model(cb, data = test)\nprediction.shape","cc51afdb":"output_reg = pd.DataFrame({'Id': test.Id, 'SalePrice': prediction.Label})\n#output_reg.to_csv('submission.csv', index=False)","cc507533":"output_reg.head()","6f839926":"import pandas as pd \nfrom pycaret.classification import *","1c5631d9":"train = pd.read_csv('..\/input\/titanic\/train.csv')\ntest = pd.read_csv('..\/input\/titanic\/test.csv')\ntest.head()","3fa8c124":"target = \"Survived\"\nm, feats, trainm, testm = Auto_ViML(train, target, test,\n                            sample_submission='',\n                            scoring_parameter='', KMeans_Featurizer=False,\n                            hyper_param='RS',feature_reduction=True,\n                             Boosting_Flag='CatBoost', Binning_Flag=False,\n                            Add_Poly=2, Stacking_Flag=True,Imbalanced_Flag=False,\n                            verbose=1)","053d687f":"start_time = time.time()\nclassification_setup = setup(data= train, target='Survived',remove_outliers=True,normalize=True,normalize_method='robust',\n                            ignore_features= ['Name'], silent = True,session_id = 6563)\nprint('Time taken (in secs) = %0.0f' %(time.time()-start_time))","10f2cffb":"start_time = time.time()\ncompare_models(exclude = ['lda'])\nprint('Time taken (in secs) = %0.0f' %(time.time()-start_time))","8cde0bfa":"rd = create_model('ridge');      \nlgm  = create_model('lightgbm');            \n\n#blending 3 models\nblend = blend_models(estimator_list=[lgm,rd])","82d0c223":"optimize_threshold(lgm, true_negative = 500, false_negative = -2000)","4fcea0ce":"plot_model(estimator = blend, plot = 'confusion_matrix')","83635543":"plot_model(estimator = blend, plot = 'class_report')","285e3b4d":"pred = predict_model(blend, data = test)","292f7125":"output = pd.DataFrame({'PassengerId': test.PassengerId, 'Survived': pred.Label})\noutput.to_csv('submission.csv', index=False)","46c8560f":"output.head()","e5f73c08":"import pandas as pd\nfrom pycaret.clustering import *\ndata = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\ndata.head()","fd25d24f":"exp_clu = setup(data)","673fa5c9":"kmeans = create_model('kmeans')\nprint(kmeans)\n","a76d5225":"plot_model(kmeans,plot = 'elbow')","51753aaf":"plot_model(kmeans,plot = 'tsne')","ac969a32":"plot_model(kmeans,plot = 'distribution')","00ca2d20":"kmeans_df = assign_model(kmeans)\nkmeans_df.head()","0e0f95d6":"hierarchical = create_model('hclust')","2d321571":"plot_model(hierarchical,plot='cluster',label = True )","3e791d9f":"hierarchical_df = assign_model(hierarchical)\nhierarchical_df.head()","b02ddc0f":"from pycaret.nlp import *\nimport pandas as pd","cfdd863e":"data = pd.read_csv('..\/input\/spam-text-message-classification\/SPAM text message 20170820 - Data.csv')\ndata = data.sample(frac=1.0, random_state=99)\nprint(data.shape)\ndata.head()","fbf8e432":"nums = int(0.9*(data.shape[0]))\ntrain = data[:nums]\ntest = data[nums:]\nprint(train.shape, test.shape)","6e414e7d":"from autoviml.Auto_NLP import Auto_NLP\nnlp_column = 'Message'\ntarget = 'Category'\ntrain_nlp, test_nlp, nlp_pipeline, predictions = Auto_NLP(\n                nlp_column, train, test, target, score_type='balanced_accuracy',\n                modeltype='Classification',top_num_features=200, verbose=0,\n                build_model=True)","35ffe436":"from sklearn.metrics import accuracy_score, balanced_accuracy_score\nprint(accuracy_score(test[target].values, test_nlp[target].values))","2e60870d":"nlp = setup(data = train, target = 'Message', session_id = 1)","27d74121":"lda = create_model('lda', multi_core = True)","e0db1ab6":"lda_data = assign_model(lda)\nlda_data.head()","b39ca274":"evaluate_model(lda)","08f9b3ba":"from pycaret.classification import *","24491950":"model = setup(data = lda_data, target = 'Category',ignore_features=['Message','Dominant_Topic','Perc_Dominant_Topic'])","ec5bb312":"compare_models()","e961cffa":"1. <div align='left'><font size=\"5\" color=\"#FF0000\">Compare Auto_ViML with PyCaret<\/font><\/div>\n<hr>","a988575c":"<div align='left'><font size=\"5\" color=\"#FF0000\">Compare Model<\/font><\/div>\n<hr>","7db1d62b":"<div align='left'><font size=\"6\" color=\"#FF0000\"><strong>5.Conclusion<\/strong><\/font><\/div>\n<hr>\n<div align='left'><font size=\"3\" color=\"#000000\">  PyCaret is simple and easy to use. It helps right from the start of data preparation to till the end of model analysis and deployment.It has over 70 ready-to-use open source algorithms,over 40 interactive visualizations to analyze machine learning models and over 25 pre-processing techniques that are fully orchestrated. Future releases will include Time Series Modeling, Recommender System and Deep Learning modules. I\u2019ve personally found PyCaret to be quite useful for generating quick results. Apart from regression, clustering,classification and natural language processing, pycaret contain module for <strong>Anomly Detection<\/strong> and <strong>Association Rule Mining<\/strong><\/font><\/div>\n<hr>\n\n<div align='left'><font size=\"6\" color=\"#FF0000\"><strong>References:<\/strong><\/font><\/div>\n<hr>\n<div align='left'><font size=\"3\"><a href=\"https:\/\/pycaret.org\" target=\"_blank\">1. PyCaret<\/a><\/div>\n<div align='left'><font size=\"3\"><a href=\"https:\/\/www.kdnuggets.com\/2020\/07\/5-things-pycaret.html\" target=\"_blank\">2. 5 Things You Don\u2019t Know About PyCaret<\/a><\/div>\n<div align='left'><font size=\"3\"><a href=\"https:\/\/towardsdatascience.com\/announcing-pycaret-an-open-source-low-code-machine-learning-library-in-python-4a1f1aad8d46\" target=\"_blank\">3. Announcing PyCaret 1.0.0<\/a><\/div>\n<div align='left'><font size=\"3\"><a href=\"https:\/\/www.analyticsvidhya.com\/blog\/2020\/05\/pycaret-machine-learning-model-seconds\" target=\"_blank\">4. Build your Machine Learning Model in Seconds<\/a><\/div>\n<hr>\n\n <div class=\"alert alert-info\" ><font size=\"4\"><strong>If you found this helpful, <strong>Please upvote!<\/strong> Happy Learning\ud83d\ude0a<\/strong> <\/div> ","55677163":"<div align='left'><font size=\"3\" color=\"#00000\">Website and documentation of this Package:<\/font><a href=\"https:\/\/pycaret.org\/regression\" target=\"_blank\"> https:\/\/pycaret.org\/regression<\/a><\/div>","928e049c":"<div align='left'><font size=\"5\" color=\"#FF0000\">Compare Model<\/font><\/div>\n<hr>","7842a233":"<div align='left'><font size=\"5\" color=\"#FF0000\">Assign model<\/font><\/div>\n<hr>","b5faf7b3":"<div align='left'><font size=\"5\" color=\"#FF0000\">Model Evaluation<\/font><\/div>\n<hr>","43db1fc1":"<div align='left'><font size=\"5\" color=\"#FF0000\">Compare model<\/font><\/div>\n<hr>","7b289191":"<div align='left'><font size=\"6\" color=\"#FF0000\">This Notebook is organized as follows:<\/font><\/div>\n\n* [<div align='left'><font size=\"4\" color=\"#1E90FF\">1. Regression<\/font><\/div>](#imports)\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">1.1 Setup the model<\/font><\/div>\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">1.2 Compare the model<\/font><\/div>\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">1.3 Create model<\/font><\/div>\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">1.4 Interpretation<\/font><\/div>\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">1.5 Ensembling<\/font><\/div> \n        <div align='left'><font size=\"3\" color=\"#1E90FF\">* 1.5.1 stacking<\/font><\/div>\n- [<div align='left'><font size=\"4\" color=\"#1E90FF\">2. Classification<\/font><\/div>](#imports)\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">2.1 Setup the model<\/font><\/div>\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">2.2 Compare the model<\/font><\/div>\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">2.3 Create model<\/font><\/div>\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">2.4 Interpretation<\/font><\/div>\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">2.5 Ensembling<\/font><\/div> \n        <div align='left'><font size=\"3\" color=\"#1E90FF\">* 2.5.1 blending<\/font><\/div>\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">2.6 Model Evaluation<\/font><\/div>            \n- [<div align='left'><font size=\"4\" color=\"#1E90FF\">3. Clustering<\/font><\/div>](#imports)\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">3.1 Setup the model<\/font><\/div>\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">3.2 Create model<\/font><\/div>\n        <div align='left'><font size=\"3\" color=\"#1E90FF\">* 3.2.1 K-mean Clustering<\/font><\/div>\n        <div align='left'><font size=\"3\" color=\"#1E90FF\">* 3.2.2 Hierarchical Clustering<\/font><\/div>   \n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">3.3 Plot model<\/font><\/div>\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">3.4 Assign model<\/font><\/div>\n- [<div align='left'><font size=\"4\" color=\"#1E90FF\">4.Natural Language Processing<\/font><\/div>](#imports)\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">4.1 Converting the text data<\/font><\/div>\n    * <div align='left'><font size=\"3.5\" color=\"#1E90FF\">4.2 Setup the model<\/font><\/div>\n        <div align='left'><font size=\"3\" color=\"#1E90FF\">4.3 Compare the model<\/font><\/div>\n- [<div align='left'><font size=\"4\" color=\"#1E90FF\">5. Conclusion<\/font><\/div>](#imports)","9f2252ee":"<div align='left'><font size=\"5\" color=\"#FF0000\">Create Model<\/font><\/div>\n<hr>","98273f59":"<div align='left'><font size=\"3\" color=\"#00000\">Website and documentation of this Package:<\/font><a href=\"https:\/\/pycaret.org\/classification\" target=\"_blank\"> https:\/\/pycaret.org\/classification<\/a><\/div>","9f8210e9":"<div align='left'><font size=\"6\" color=\"#FF0000\"><strong>1.Regression<\/strong><\/font><\/div>\n<hr>\n<div align='left'><font size=\"3\" color=\"#000000\">  Here we use house-prices-advanced-regression-techniques dataset to perform regression. <\/font><\/div>\n<hr>\n> <img style=\"float: centre;\" src=\"https:\/\/miro.medium.com\/max\/1024\/1*Juv1bpp5--0Fl8cA4EmTPw.jpeg\" width=\"450px\"\/>","c0cffe77":"<div align='left'><font size=\"5\" color=\"#FF0000\">Interpretation<\/font><\/div>\n<hr>","c0be7bbd":"<div align='left'><font size=\"5\" color=\"#FF0000\">Plot the model<\/font><\/div>\n<hr>","e99af4af":"<div align='left'><font size=\"3\" color=\"#00000\">Website and documentation of this Package:<\/font><a href=\"https:\/\/pycaret.org\/clustering\" target=\"_blank\"> https:\/\/pycaret.org\/clustering<\/a><\/div>","7f996c3c":"<div align='left'><font size=\"6\" color=\"#FF0000\"><strong>4.Natural Language Processing<\/strong><\/font><\/div>\n<hr>\n\n<div align='left'><font size=\"3\" color=\"#000000\"> Here we use text message classification.  <\/font><\/div>\n<hr>\n\n> <img style=\"float: centre;\" src=\"https:\/\/miro.medium.com\/max\/1840\/1*hsyCZOYoGrX6BJsj4Lgrhg.png\" width=\"450px\"\/>","131f04d4":"<div align='left'><font size=\"6\" color=\"#FF0000\"><strong>3.Clustering<\/strong><\/font><\/div>\n<hr>\n<div align='left'><font size=\"3\" color=\"#000000\">  Here we use mall customer dataset to perform Clustering.  <\/font><\/div>\n<hr>\n\n> <img style=\"float: centre;\" src=\"https:\/\/encrypted-tbn0.gstatic.com\/images?q=tbn%3AANd9GcRPwRj1l9eIPJlLHFTQmVxOFdV8A-iRJpzHHw&usqp=CAU\" width=\"450px\"\/>","dbd87f95":"<div align='left'><font size=\"5\" color=\"#FF0000\">Ensembling<\/font><\/div>\n<hr>","aa4fd73f":"<div align='left'><font size=\"5\" color=\"#FF0000\">Setup the model<\/font><\/div>\n<hr>","bb2371f8":"<div align='left'><font size=\"5\" color=\"#FF0000\">Assign model<\/font><\/div>\n<hr>","fb931a98":"<div align='left'><font size=\"6\" color=\"#FF0000\"><strong>2.Classification<\/strong><\/font><\/div>\n<hr>\n<div align='left'><font size=\"3\" color=\"#000000\">  Here we use Titanic dataset to perform classification. <\/font><\/div>\n<hr>\n> <img style=\"float: centre;\" src=\"https:\/\/humansofdata.atlan.com\/wp-content\/uploads\/2016\/07\/RMS_Titanic_3.jpg\" width=\"450px\"\/>","edeb5348":"<div align='left'><font size=\"5\" color=\"#FF0000\">Hierarchical Clustering<\/font><\/div>\n<hr>","9cf06232":"<div align='left'><font size=\"3\" color=\"#00000\">Website and documentation of this Package:<\/font><a href=\"https:\/\/pycaret.org\/nlp\" target=\"_blank\"> https:\/\/pycaret.org\/nlp<\/a><\/div>","42fd98f8":"<div align='left'><font size=\"5\" color=\"#FF0000\">Converting Text Data<\/font><\/div>\n<hr>","dd0411e6":"<div align='left'><font size=\"5\" color=\"#FF0000\">Plot the model<\/font><\/div>\n<hr>","3e70a8ae":"# This is a modified version of this great notebook by Naresh\nhttps:\/\/www.kaggle.com\/nareshbhat\/build-your-nlp-ml-models-within-seconds\n\n## His notebook was only using PyCaret but for fun I added Auto_ViML to compare the results against. ","12b2ec71":"<div align='left'><font size=\"5\" color=\"#FF0000\">Comparing Auto_ViML with PyCaret on Classification<\/font><\/div>\n<hr>","6d95e9d8":"<div align='left'><font size=\"5\" color=\"#FF0000\">Setup the model<\/font><\/div>\n<hr>","daf5cda9":"<div align='left'><font size=\"5\" color=\"#FF0000\">K-means Clustering<\/font><\/div>\n<hr>"}}