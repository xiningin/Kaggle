{"cell_type":{"679e5122":"code","e55eeeb0":"code","3b2796f1":"code","2ee4988e":"code","69e2431f":"code","e8c03ba0":"code","99cc1c63":"code","2667c219":"code","998e86f6":"code","091f8ff8":"code","bf7c5642":"markdown"},"source":{"679e5122":"import numpy as np \nimport pandas as pd\nimport os\n\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","e55eeeb0":"data = pd.read_csv('\/kaggle\/input\/amazing-marketing-data-set\/Dataset.csv')\ndata['Sales'] = pd.to_numeric(data.Sales, errors='coerce')\ndata['Year'] = pd.DatetimeIndex(data['Order Date']).year","3b2796f1":"from datetime import datetime\n\nknown_clients = []\n\ndates_new_clients = {}\ndates_old_clients = {}\n\ndates = sorted(data['Order Date'].unique(), key=lambda x: datetime.strptime(x, '%d-%m-%Y'))\ndates_clients = data[['Order Date', 'Customer ID', 'Profit']].groupby('Order Date')\n\nunique_clients_by_date = dates_clients['Customer ID'].apply(lambda x: list(np.unique(x)))\n\nfor date in dates:\n    date_clients = unique_clients_by_date[date]\n    \n    for client in date_clients:\n        if client not in known_clients:\n            if date not in dates_new_clients:\n                dates_new_clients[date] = []\n            dates_new_clients[date].append(client)\n            known_clients.append(client)\n        else:\n            if date not in dates_old_clients:\n                dates_old_clients[date] = []\n            dates_old_clients[date].append(client)\n\ndates_count_new_clients = {}\nmonth_new_clients = {}\n\nfor date_client in dates_new_clients.items():\n    dates_count_new_clients[date_client[0]] = len(date_client[1])\n    \nfor date, value in dates_count_new_clients.items():\n    if date[-7:] not in month_new_clients:\n        month_new_clients[date[-7:]] = 0\n    month_new_clients[date[-7:]] += value","2ee4988e":"import matplotlib.pyplot as plt\n\nx = list(month_new_clients.keys());\ny = list(month_new_clients.values());\n\nplt.figure(figsize=(20, 9))\nplt.bar(x, y)\nplt.xlabel('Date') \nplt.ylabel('New clients') \nplt.show()\nprint(month_new_clients.values())","69e2431f":"ds_new_clients = data.groupby(['Customer ID'], as_index=False).agg({\"Order Date\" : 'max'}).sort_values(\"Order Date\")\nds_new_clients['Year'] = pd.DatetimeIndex(ds_new_clients['Order Date']).year","e8c03ba0":"ds_new_clients.groupby(['Year']).agg({\"Customer ID\": lambda x: len(x)})","99cc1c63":"def cagr(start_value, end_value, num_periods):\n    return ((end_value \/ start_value) ** (1 \/ (num_periods - 1)) - 1)","2667c219":"countries = data['Country'].unique()\n\ncountries_profit_by_yrs = data.groupby(['Country', 'Year']).agg(\n    profit= pd.NamedAgg(column = 'Profit', aggfunc = 'sum')\n).groupby(['Country']).apply(lambda x: list(x.profit))\n\ncountries_cagr = {}\n\nfor country in countries:\n    periods = len(countries_profit_by_yrs[country]);\n    if periods > 3:\n        start = countries_profit_by_yrs[country][0]\n        end = countries_profit_by_yrs[country][-1]\n        countries_cagr[country] =  cagr(start, end, periods)\n\ndf = pd.DataFrame.from_dict({'country': list(countries_cagr.keys()), 'cagr': list(countries_cagr.values())}).sort_values(by= 'cagr', ascending=False)\n\ndf","998e86f6":"bottom10countries = list(df.sort_values(by= 'cagr', ascending=True).head(10)['country'])\nbottom10countries","091f8ff8":"new_ds = data[:-5129]\n\ncountries = new_ds['Country'].unique()\n\ncountries_profit_by_yrs = new_ds.groupby(['Country', 'Year']).agg(\n    profit= pd.NamedAgg(column = 'Profit', aggfunc = 'sum')\n).groupby(['Country']).apply(lambda x: list(x.profit))\n\ncountries_cagr = {}\n\n\nfor country in countries:\n    periods = len(countries_profit_by_yrs[country]);\n    if periods > 3:\n        start = countries_profit_by_yrs[country][0]\n        end = countries_profit_by_yrs[country][-1]\n        countries_cagr[country] =  cagr(start, end, periods)\n\ndf = pd.DataFrame.from_dict({'country': list(countries_cagr.keys()), 'cagr': list(countries_cagr.values())}).sort_values(by= 'cagr', ascending=False)\n\ndf","bf7c5642":"Columns\n\n['Category', 'City', 'Country', 'Customer ID', 'Customer Name', 'Market',\n       'Order Date', 'Order ID', 'Order Priority', 'Product ID',\n       'Product Name', 'Region', 'Row ID', 'Segment', 'Ship Date', 'Ship Mode',\n       'State', 'Sub-Category', 'Discount', 'Number of Records', 'Profit',\n       'Quantity', 'Sales', 'Shipping Cost']\n"}}