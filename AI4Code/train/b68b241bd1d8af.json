{"cell_type":{"ad2a4af6":"code","7ddfb28e":"code","0d6214da":"code","7fe34e74":"code","47005ef0":"code","ae1679a2":"code","8b61c285":"code","1f733fa7":"code","ac676a09":"code","cc8b17f9":"code","03eba216":"code","6d788df0":"code","5a9e9b0e":"code","843b1aa3":"code","0c5fb414":"code","6238a541":"code","7c122df8":"code","80c78fa0":"code","f6307643":"code","c07e77af":"code","d7218dec":"code","bc11e76c":"code","fc03abb5":"code","5a70dfe9":"code","c756989b":"code","34d9ca9f":"code","a1752a53":"code","3b03f335":"code","c960cb26":"code","0f29e2f3":"code","e5bed816":"code","eadc46b7":"code","9acab337":"markdown","b1490dc7":"markdown","70ad4f84":"markdown","33d420bf":"markdown","b1c850ea":"markdown","9b02265c":"markdown","994f56f0":"markdown","4d320ca1":"markdown","9de5ca0a":"markdown","3e33726f":"markdown","a467978f":"markdown","35fb0156":"markdown"},"source":{"ad2a4af6":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","7ddfb28e":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import r2_score\nfrom sklearn import metrics\n# Warnings\nimport warnings\nwarnings.filterwarnings('ignore')","0d6214da":"grad=pd.read_csv(\"\/kaggle\/input\/graduate-admissions\/Admission_Predict_Ver1.1.csv\")","7fe34e74":"grad.head(5)","47005ef0":"grad.shape","ae1679a2":"grad.info()","8b61c285":"grad['Research']=grad['Research'].astype(\"category\")","1f733fa7":"grad.drop(['Serial No.' ],axis=1,inplace=True)","ac676a09":"grad.describe()","cc8b17f9":"round(100*(grad.isnull().sum()\/len(grad)),2)","03eba216":"grad.drop_duplicates(inplace=True)","6d788df0":"plt.figure(figsize=(30,15))\nsns.pairplot(grad)\nplt.show()","5a9e9b0e":"sns.boxplot(x='Research',y='Chance of Admit ',data=grad)\nplt.show()","843b1aa3":"plt.figure(figsize=(20,15))\nsns.heatmap(grad.corr(),annot=True)\nplt.show()","0c5fb414":"from sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import MinMaxScaler","6238a541":"np.random.seed(0)\ndf_train,df_test=train_test_split(grad,test_size=0.2,random_state=80)","7c122df8":"df_train.shape","80c78fa0":"df_test.shape","f6307643":"scaler=MinMaxScaler()","c07e77af":"num_vars = ['GRE Score', 'TOEFL Score', 'University Rating', 'SOP', 'LOR ', 'CGPA',\n        'Chance of Admit ']\ndf_train[num_vars]=scaler.fit_transform(df_train[num_vars])","d7218dec":"df_test[num_vars]=scaler.transform(df_test[num_vars])","bc11e76c":"y_train=df_train.pop('Chance of Admit ')\nX_train=df_train\n\ny_test=df_test.pop('Chance of Admit ')\nX_test=df_test","fc03abb5":"from sklearn.linear_model import Ridge\nfrom sklearn.model_selection import GridSearchCV","5a70dfe9":"params={'alpha':[0.0001, 0.001, 0.01, 0.05, 0.1, \n 0.2, 0.3]}\n\nfolds=5\nridge=Ridge()\nmodel_search_cv=GridSearchCV(estimator=ridge,param_grid=params,cv=folds,scoring= 'neg_mean_absolute_error',\n                             return_train_score=True,verbose = 1)\nmodel_search_cv.fit(X_train,y_train)\n","c756989b":"print(model_search_cv.best_params_)\nprint(model_search_cv.best_score_)\nprint(model_search_cv.best_estimator_)\nprint(model_search_cv.best_index_)","34d9ca9f":"ridge_alpha=model_search_cv.best_params_['alpha']\nridge_alpha","a1752a53":"ridge=Ridge(alpha=ridge_alpha)\nmodel=ridge.fit(X_train,y_train)","3b03f335":"# train accuracy \ny_train_pred=model.predict(X_train)\ntrain_acc=r2_score(y_train,y_train_pred)\ntrain_mse=metrics.mean_squared_error(y_train,y_train_pred)","c960cb26":"print(\"Total train mean squared error is: {}\".format(train_mse))\nprint(\"The train accuracy of the model is: {}%\".format(round(train_acc*100)))","0f29e2f3":"# test accuracy \ny_test_pred=model.predict(X_test)\ntest_acc=r2_score(y_test,y_test_pred)\ntest_mse=metrics.mean_squared_error(y_test,y_test_pred)","e5bed816":"print(\"Total test mean squared error is: {}\".format(test_mse))\nprint(\"The test accuracy of the model is: {}%\".format(round(test_acc*100)))","eadc46b7":"# Lets find the coeffients for features selected by the model\nmodel_parameters = list(ridge.coef_)\nmodel_parameters.insert(0, ridge.intercept_)\nmodel_parameters = [round(x, 3) for x in model_parameters]\ncols = df_train.columns\ncols = cols.insert(0, \"constant\")\nsorted(list(zip(cols, model_parameters)),key=lambda x: abs(x[1]),reverse=True)","9acab337":"# Calculating R2 and RMSE values","b1490dc7":"# Train Test split and Sclaing for model bulding","70ad4f84":"# Data analysis and Prepration","33d420bf":"we can see that how the Chance of Admit is related with other diff columns. as CGPA, GRE Score Increases chance of admission also increases.","b1c850ea":"Aplha value 0.3 is best in this case ,hence bulding a model with 0.3","9b02265c":"we have 500 rows and 9 features","994f56f0":"There are no missing values and duplicate values.","4d320ca1":"# Observations\n- By above coefficient values we can conclude that most imp value is CGPA followed by gre score to get the admission.\n- We also noticed that in heat map the correlation value between GRE Score and Chance of admission is 0.81.\n- Therefore, based on our analysis we can say that students need to focus on GRE Score after the CGPA.","9de5ca0a":"Using Grid search to find out the best alpha value for Ridge Regression","3e33726f":"converting Reserach column to categorical column","a467978f":"# EDA","35fb0156":"# Model bulding using Ridge"}}