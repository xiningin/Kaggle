{"cell_type":{"d5d2177c":"code","f19d39fe":"code","2daada15":"code","e44f1e85":"code","b426f78b":"code","fb7eda03":"code","5246c3a5":"code","3d720db9":"code","b7ea5a32":"code","2f3e00ae":"code","266cf490":"markdown","1ec4e426":"markdown","100a3719":"markdown","f3f5722a":"markdown","61971912":"markdown","5d4af74c":"markdown","b7c9859b":"markdown","3920e767":"markdown","37e736c9":"markdown","7dfd491e":"markdown","3342007c":"markdown","281c02be":"markdown"},"source":{"d5d2177c":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\ndf = pd.read_csv(filepath_or_buffer = \"..\/input\/advertising-dataset\/advertising.csv\")\nprint('First 5 data entries:\\n',df.head())\nprint('Shape:',df.shape)\nprint('describe:\\n',df.describe())","f19d39fe":"_=plt.scatter(df['TV'],df['Sales'],marker='*')\n_=plt.xlabel('tv advertisment')\n_=plt.ylabel('sales')\nplt.show()","2daada15":"from sklearn import linear_model\nimport statsmodels.api as sm\nx=df['TV']\ny=df['Sales']","e44f1e85":"print(\"\\n model  with statsmodel: \\n\")\n\nx=sm.add_constant(x)\nmodel=sm.OLS(y,x).fit()\nprint('Intercept:',model.params[0])\nprint('Coefficient: ',model.params[1])\nprint('r square:',model.rsquared)","b426f78b":"model.summary()","fb7eda03":"print(\" model with sklearn: \\n\") \n\nregression=linear_model.LinearRegression()\nregression.fit(x,y)\nprint('Intercept:',regression.intercept_)\nprint('Coefficient:',regression.coef_)\nprint('r square:',regression.score(x,y))","5246c3a5":"print(\"Regression line:\\n\")\nimport seaborn as sns\n_=sns.regplot(x=df['TV'],y=df['Sales'],data=df)\n_=plt.xlabel('tv advertisment')\n_=plt.ylabel('sales')\nplt.show()\nprint(\"Residual plot:\\n\")\ny_pred=regression.predict(x)\nresidual=y_pred-y\n_=sns.distplot(residual)\nplt.show()","3d720db9":"from sklearn.model_selection import cross_val_score  #Function to compute cross validation score\nLRegCV = linear_model.LinearRegression()\n\nscores = cross_val_score(LRegCV, x, y, cv = 5) # Use 5-fold cross validation\nscores","b7ea5a32":"print('Average performance is %.4f.'% np.mean(scores))","2f3e00ae":"from sklearn.metrics import mean_squared_error\nfrom sklearn.metrics import make_scorer \nmse = make_scorer(mean_squared_error)\ncross_val_score(LRegCV, x, y, cv = 5, scoring = mse).mean()","266cf490":"From the residual plot we see that our error follows Normally with mean 0.","1ec4e426":"H0: beta0(intercept) is equal to zero. \nH1: beta0(intercept) is not equal to zero.\n\nFrom the summary output we see that the p value for intercept is 0.000 which is less than 0.05.that means we say that in our model beta0(intercept) is not zero which play significance role in our model.\n\n\nH0: beta1(slope) is equal to zero. \nH1: beta1(slope) is not equal to zero.\n\nFrom the summary output we see that the p value for beta1(slope) is 0.000 which is less than 0.05.that means we say that in our model beta1(slope) is not zero which play significance role in our model.\n\nH0: model is significant. \nH1: model is not significant. \n\nFrom the summary output we see that the p value for model is  which is 7.93e-74 less than 0.05.that means we say that our model is significant.","100a3719":"## Cross Validation\n","f3f5722a":"# **Graphical representation:**","61971912":"# **Mean Squared Error**","5d4af74c":"Thus, the trained estimator is capable of explaining 79.20% of the variation of the target.","b7c9859b":"**Conclusion: From the Scatter plot we observe that There is possitive relationship between Tv Advertisment and Sales.**","3920e767":"The average score is taken as the measure of estimator's performance. \n\nThe scores computed by `cross_val_score` is determined by the `score` method of the estimator. For LinearRegression estimator the `score` method computes $R^2$ statistic (Coefficient of determination).","37e736c9":"# **Simple linear regression:**","7dfd491e":"Use the advertising dataset given in ISLR and analyse the relationship between 'TV advertising' and 'sales' using a simple linear regression model.","3342007c":"# **Model for prediction:**\nsales = 6.97482 + 0.05546 * tv","281c02be":"Here, we are trying to fit simple linear regression model between tv advertisment and sales.we want to know how the tv advertisment affect on sales. the model is \n**sales=beta_0 + beta_1 . tv + error **\nwhere errors are normally distributed.\nbeta_0 is interscept\nbeta_1 is the slope"}}