{"cell_type":{"29c3aeae":"code","5ec3670a":"code","563824aa":"code","4f206745":"code","8d250314":"code","d722b89c":"code","ff7d2be0":"code","65dabcde":"code","c036872c":"code","48e6a05c":"code","5d2f35ee":"code","28d37925":"code","e5ec7801":"code","c4dfbeed":"code","2b3109a3":"markdown","3083572f":"markdown","805aaafe":"markdown","34d74727":"markdown","4f9827e8":"markdown","697e7e43":"markdown","3ab391ad":"markdown","74d64a84":"markdown","0caa6407":"markdown","d99a0b92":"markdown","531ee5ac":"markdown","fba6a18f":"markdown","e5c7b854":"markdown"},"source":{"29c3aeae":"from tensorflow.keras import datasets # boston_housing, cifar10, cifar100, fashion_mnist, imdb, mnist, reuters\n(x_train, y_train), (x_test, y_test) = datasets.mnist.load_data()","5ec3670a":"# show image of training data\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nplt.figure(figsize = (10, 10)) # set size of figure 10x10\nrand_indexes = np.random.randint(0, x_train.shape[0], 8) # select 8 digits(0~9) randomly \nprint(rand_indexes)\n\nfor index,im_index in enumerate(rand_indexes):\n    plt.subplot(4, 4, index+1)\n    plt.imshow(x_train[im_index], cmap = 'gray', interpolation = 'none')\n    plt.title('Class %d' % y_train[im_index])\nplt.tight_layout()","563824aa":"# data converted from integer to float\nx_train = x_train \/ 255.0\nx_test = x_test \/ 255.0\n\nprint(x_train.shape)\nprint(x_test.shape)","4f206745":"# reshape to add color channel into data\nx_train = x_train.reshape(-1,28,28,1)\nx_test = x_test.reshape(-1,28,28,1)\n\nprint(x_train.shape)\nprint(x_test.shape)","8d250314":"from tensorflow.keras import utils\ny_train = utils.to_categorical(y_train)\ny_test = utils.to_categorical(y_test)\n\nprint(y_train.shape)\nprint(y_test.shape)","d722b89c":"input_shape = (28,28,1) # img_rows, img_colums, color_channels\nnum_classes = y_train.shape[1] # digit = 0~9 ","ff7d2be0":"# Build Model\nfrom tensorflow.keras import models, layers\n\ninputs = layers.Input(shape=input_shape)\nx = layers.Conv2D(64, kernel_size = (3, 3), activation = 'relu', padding = 'same')(inputs)\nx = layers.MaxPool2D(pool_size = (2, 2))(x)\n# 2nd Conv layer        \nx = layers.Conv2D(64, kernel_size = (3, 3), activation = 'relu', padding = 'same')(x)\nx = layers.MaxPool2D(pool_size = (2, 2))(x)\n# Fully Connected layer        \nx = layers.Flatten()(x)\nx = layers.Dense(128)(x)\noutputs = layers.Dense(num_classes, activation=\"softmax\")(x)\n\nmodel = models.Model(inputs=inputs, outputs=outputs)\n\nmodel.summary()","65dabcde":"# Compile Model\nmodel.compile(loss = 'categorical_crossentropy', optimizer = 'adam' , metrics = ['accuracy'])","c036872c":"# Train Model\nhistory = model.fit(x_train, y_train, batch_size=128, epochs=20, validation_data=(x_test, y_test))","48e6a05c":"models.save_model(model, 'mnist_cnn.hdf5')\n# You can download this file to PC","5d2f35ee":"# If you are loading this file on PC, then be sure it is the same version of Tensrflow use on Kaggle.\nmodel = models.load_model('mnist_cnn.hdf5')","28d37925":"preds = model.predict(x_test[0].reshape(-1,28,28,1))\nprint(int(np.argmax(preds)))","e5ec7801":"# Evaluate Model\nscore = model.evaluate(x_test, y_test)\nprint('Test loss: ', score[0])\nprint('Test accuracy: ', score[1])","c4dfbeed":"# Show Train History\nkeys=history.history.keys()\nprint(keys)\n\ndef show_train_history(hisData,train,test): \n    plt.plot(hisData.history[train])\n    plt.plot(hisData.history[test])\n    plt.title('Training History')\n    plt.ylabel(train)\n    plt.xlabel('Epoch')\n    plt.legend(['train', 'test'], loc='upper left')\n    plt.show()\n\nshow_train_history(history, 'loss', 'val_loss')\nshow_train_history(history, 'accuracy', 'val_accuracy')","2b3109a3":"### encoding label data","3083572f":"## Save Model","805aaafe":"## Test Model","34d74727":"# Handwritten Digit Recognizer\n\n##  Dataset: MNIST (handwritten single digit 28x28)","4f9827e8":"## Architecture\n![image.png](attachment:image.png)","697e7e43":"## Train Model","3ab391ad":"## Build Model","74d64a84":"### show training history","0caa6407":"## Evaluate Model","d99a0b92":"## Load Model ","531ee5ac":"### normalized image data","fba6a18f":"## Load Dataset","e5c7b854":"### show image of training data"}}