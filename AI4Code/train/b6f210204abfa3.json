{"cell_type":{"4b618562":"code","3916c4f5":"code","b3a2f0ee":"code","42343446":"code","046e4803":"code","b65b6412":"code","71de9a04":"code","84ff5de5":"code","0eac6c03":"code","fcdc0e15":"code","4f66ccc4":"code","532a1324":"code","8f88594d":"code","8acc82e5":"code","b473695f":"code","1ed5f755":"code","52dd05d4":"code","b48ce02e":"code","0630e0c2":"code","fc436c2e":"code","73ae654b":"code","ecc5a8c3":"code","23513515":"code","90e035bf":"code","5890c3b5":"code","4905f557":"code","06e6e412":"markdown","48c15dd7":"markdown","9fc695ec":"markdown","e669879b":"markdown","6ecf14cb":"markdown","48202134":"markdown","b5be81af":"markdown","03c38f32":"markdown","8834e176":"markdown","5560b319":"markdown","0a551bb2":"markdown","f0aa3b24":"markdown","17a4479d":"markdown","f5eb2dc3":"markdown","2e8dbf00":"markdown","7af82047":"markdown","74b9b0e1":"markdown","d4554436":"markdown","3b4dcef8":"markdown","228eb4f1":"markdown"},"source":{"4b618562":"# Importing the libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.decomposition import PCA","3916c4f5":"# Reading the dataset \ndf = pd.read_csv('..\/input\/covid-aggregated-data\/Covid.csv')\ndf = df.iloc[:,:-2]","b3a2f0ee":"df.head()","42343446":"df.info()","046e4803":"plt.figure(figsize=(15,10))\nsns.heatmap(df.corr(),cmap='coolwarm',annot =True)\nplt.title('Heatmap of Correlation Matrix')","b65b6412":"plt.figure(figsize=(10,5))\nsns.lineplot(data = df[['TotalConfirmedCases','TotalDeaths','TotalClosedCases']],size=1000)\nplt.title('Trends in Confirmed, Deaths and Closed Cases')\nplt.xlabel('No of days after first case')\nplt.ylabel('Total Cases')","71de9a04":"plt.figure(figsize=(10,5))\nsns.lineplot(data = df[['TotalSamples']],style='event',size=1000,palette='CMRmap_r')\nplt.title('Total Samples recorded')\nplt.xlabel('No of days after first case')\nplt.ylabel('Total Cases')","84ff5de5":"dataset = pd.read_csv('..\/input\/covid-aggregated-data\/Covid.csv')\n#dataset = dataset.iloc[:,:-3]\ndataset.dropna(axis=0,inplace=True)\nX = dataset.iloc[:, 0:2].values\ny = dataset.iloc[:, 7:8].values\npoly_reg = PolynomialFeatures(degree =3,include_bias =False)\nX_poly = poly_reg.fit_transform(X)\nlin_reg_2 =LinearRegression(fit_intercept = False,normalize = True)\nlin_reg_2.fit(X_poly,y)","0eac6c03":"# Predicting the Missing value \ndataset = pd.read_csv('..\/input\/covid-aggregated-data\/Covid.csv')\n#dataset = dataset.iloc[:,:-3]\ny_pred1 = lin_reg_2.predict(poly_reg.fit_transform(np.array([range(45,49),range(14,18)]).transpose()) )\ny_pred2 = lin_reg_2.predict(poly_reg.fit_transform(np.array([range(59,61),range(28,30)]).transpose()))","fcdc0e15":"# Predicting the Total no of samples that should have been taken till 31st July 2020  \nSamples_31_July =  lin_reg_2.predict(poly_reg.fit_transform(np.array([[184,31]])))\nprint('no. of samples till 31st July - {} '.format(Samples_31_July[0][0]))","4f66ccc4":"# Replacing a missing values with predicted one's\nmissing = [0] * len(dataset)\nmissing[44:48] = [j for sub in y_pred1 for j in sub]\nmissing[58:60] = [j for sub in y_pred2 for j in sub]\nmissing = pd.DataFrame(np.array(missing))\nmissing = missing.rename(columns={0:'MissingSamplesValues'})\ndf = pd.concat([dataset,missing],axis=1)\ndf = df.fillna(0)\ndf['Samples'] = df['MissingSamplesValues'] + df['TotalSamples']\ndf.drop(['MissingSamplesValues','TotalSamples'],axis=1,inplace = True)","532a1324":"df.info()","8f88594d":"fig = plt.figure(figsize=(15,4));   \nax1 = fig.add_subplot(1,5,1);\nax2 = fig.add_subplot(1,5,2);\nax3 = fig.add_subplot(1,5,3);\n#ax4 = fig.add_subplot(1,5,4);\n#ax5 = fig.add_subplot(1,5,5);\n\nsns.lineplot(x=df['NoOfDays'],y=df['TotalConfirmedCases'],data=df,ax=ax1)\nsns.lineplot(x=df['TotalClosedCases'],y=df['TotalConfirmedCases'],data=df,ax=ax2)\n#sns.lineplot(x=df['DeathRate'],y=df['TotalConfirmedCases'],data=df,ax=ax3)\n#sns.lineplot(x=df['RecoveryRate'],y=df['TotalConfirmedCases'],data=df,ax=ax4)\nsns.lineplot(x=df['Samples'],y=df['TotalConfirmedCases'],data=df,ax=ax3)\nplt.tight_layout()\n\n# Relation of features with Total Coinfirmed cases ","8acc82e5":"X = df[['NoOfDays','Date','Month','TotalClosedCases','TotalPositiveCases']]\ny = df['TotalConfirmedCases']\n\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.decomposition import PCA\npoly = PolynomialFeatures(degree = 3)\nX_p = poly.fit_transform(X)\nregressor =PCA(7)\nregressor.fit(X_p,y)\n\nprint((regressor.explained_variance_ratio_)*100)","b473695f":"X = df.iloc[:,[0,2,-1]].values\ny = df['TotalConfirmedCases']\npoly2 = PolynomialFeatures(degree =2)\nX_poly = poly2.fit_transform(X)\nregressor2 =LinearRegression()\nregressor2.fit(X_poly,y)\n\n","1ed5f755":"#visualising the polonomial regressor\nplt.figure(figsize=(8,4))\nplt.scatter(X[:,0],y,color = 'red')\nplt.plot(X[:,0],regressor2.predict(poly2.fit_transform(X)),color='blue')\nplt.title('Polynomial Regressor')\nplt.xlabel('No of days after first case')\nplt.ylabel('Total Confirmed cases')\nplt.show()","52dd05d4":"Date = 31\nMonth =7\nDays = 184\nSamples = Samples_31_July[0,0]\nX1 = np.array([[Days,Month,Samples]])\nTotal_infections  = regressor2.predict(poly2.fit_transform(X1))","b48ce02e":"print('Total No of Infection o 31st July -> {}'.format(int(Total_infections[0])))","0630e0c2":"# Predicting No of closed cases\nX_closed = df.iloc[:,[0,1,2,3,-1]].values\ny = df['TotalClosedCases']\npoly3 = PolynomialFeatures(degree = 1)\nX_poly = poly3.fit_transform(X_closed)\nregressor3 =LinearRegression()\nregressor3.fit(X_poly,y)\n\nDate = 31\nMonth =7\nDays = 184\nSamples = Samples_31_July[0,0]\nInfections = Total_infections[0]\nX1 = np.array([[Days,Date,Month,Infections,Samples]])\nTotal_closed  = regressor3.predict(poly3.fit_transform(X1))","fc436c2e":"# predicting no of deaths \nX_death = df.iloc[:,[0,1,2,3,5,-1]].values\ny = df['TotalDeaths']\npoly4 = PolynomialFeatures(degree = 1)\nX_poly = poly4.fit_transform(X_death)\nregressor4 =LinearRegression()\nregressor4.fit(X_poly,y)\n\nplt.figure(figsize=(8,4))\nplt.scatter(X_death[:,0],y,color = 'red')\nplt.plot(X_death[:,0],regressor4.predict(poly4.fit_transform(X_death)),color='blue')\nplt.title('Polynomial Regressor')\nplt.xlabel('No of days after first case')\nplt.ylabel('Total Deaths')\nplt.show()\n\n","73ae654b":"Date = 31\nMonth =7\nDays = 184\nSamples = Samples_31_July[0,0]\nInfections = Total_infections[0]\nClosed = Total_closed[0]\nX1 = np.array([[Days,Date,Month,Infections,Closed,Samples]])\nTotal_deaths  = regressor4.predict(poly4.fit_transform(X1))","ecc5a8c3":"print('Total No of Deaths o 31st July -> {}'.format(int(Total_deaths[0])))","23513515":"Date = np.concatenate((np.arange(15,31),np.arange(1,32)),axis=0)\nMonth =([6]*16) + ([7]*31)\nDays = np.arange(138,185)\nSamples_ = lin_reg_2.predict(poly_reg.fit_transform(np.array([Days,Date]).transpose()))\nSamples_ = np.array([j for sub in Samples_ for j in sub])\nX1 = np.array([Days,Month,Samples_]).transpose()\nTotal_infections_Range  = regressor2.predict(poly2.fit_transform(X1))\nX2 = np.array([Days,Date,Month,Total_infections_Range,Samples_]).transpose()\nTotal_closed_Range  = regressor3.predict(poly3.fit_transform(X2))\nX3 = np.array([Days,Date,Month,Total_infections_Range,Total_closed_Range,Samples_]).transpose()\nTotal_deaths_Range  = regressor4.predict(poly4.fit_transform(X3))\n\nDeathRate = ((Total_deaths_Range)\/(Total_closed_Range)) * 100\nDeathRate = pd.Series(DeathRate)","90e035bf":"DeathRate\n# the values are in percenatge","5890c3b5":"# Now we have Total cases, we just have to Find total recovered cases: Closed - deaths\nTotal_recoverd_Range = Total_closed_Range -Total_deaths_Range\nRecoveryRate = ((Total_recoverd_Range)\/(Total_closed_Range)) * 100","4905f557":"RecoveryRate =pd.Series(RecoveryRate)\nRecoveryRate","06e6e412":"As expected, most of the features are inter-related","48c15dd7":"Now, analysing recovery rate","9fc695ec":"We can observ there are no missing values","e669879b":"# Total No of Infection o 31st July -> 811467","6ecf14cb":"To check which parameters explains the most variance, we'll train a polynomial regression model beacuse according to the plots and visualisations, the relation of mostly following polynomial trend","48202134":"# Total No of Deaths o 31st July -> 26652","b5be81af":"# Predicting Death and recovory rate","03c38f32":"# Preprocessing","8834e176":"Some of the values of total samples are missing","5560b319":"No particular trend, so just using previous information to train a model","0a551bb2":"# Prediction of Total no of Infections till 31st July","f0aa3b24":"Every feature tends to have an exponential increase","17a4479d":"# Predicting no of deaths on 31st july ","f5eb2dc3":"First we need information about the closed cases ","2e8dbf00":"# Explatory Data Analysis","7af82047":" we know that,\n - Death rate = (Death cases \/ Total closed cases) * 100\n - Recovery rate = (recovered cases \/ Total closed cases) *100","74b9b0e1":"# Recovery rate remains constant ~(93%) and so is the death rate ~(7%)","d4554436":"No of Days after first confirmed case explains 98% of the variance and date explain the other 2% \nRest of the features, for obvious, have a linear relation with TotalConfirmedCases, so they explain less variance\nMoreover, these features are inter - related with each other \nBetter option is to leave these features\n\nBut we know that recovery or death rate are important parameters beacuseuse they there values tend to change with time \n\nFor Predicting the values on 31st of July, we dont have the recovery and death rate\nBut we can have an idea of Samples tested using above trained model\n\nTo solve this particular problem\nwe can make a chain of Predictions\n\nBy using Number of Days, date and samples tested, we will predict the no of infections\nUsing that Data, we will predict the No of closed cases -> deaths (direct relation with closed cases)   \nAgain, using above data we will predict Recovery and death rate","3b4dcef8":"Firstly, we have to fill the missing values\n- For this purpose polynomial regressor is used because it performs well for the spread of pandemic. Moreover, it is self explanatory from Explotory Data Analysis","228eb4f1":"# Covid 19 Prediction"}}