{"cell_type":{"fea591e7":"code","24a80b09":"code","50a99b49":"code","77afffbb":"code","908cbc1c":"code","03358920":"code","59586149":"code","b1712a7d":"code","5d7986e1":"code","ccb9d7a4":"code","bfc06ab5":"code","2a6440b8":"code","e59a24fa":"code","469585a5":"code","604d7bfc":"code","3b0e8ac7":"code","71f68781":"code","0452babc":"code","4f6fb1b1":"code","352ab538":"code","9b68e15b":"code","400dbf00":"code","a0db83d2":"code","165eaf33":"code","4b305039":"code","d45dc247":"markdown","89d7ffa1":"markdown","ea0dbb63":"markdown","1042f98d":"markdown","8f0056cc":"markdown","e3a01e6a":"markdown","73359b84":"markdown","3ad474a9":"markdown","f8ccb57e":"markdown","b2c65f38":"markdown","eee3b3cc":"markdown","0f0982c3":"markdown","0a694486":"markdown","c365d495":"markdown","087644e7":"markdown","9e5fa978":"markdown","a97ff30a":"markdown","3778ddff":"markdown"},"source":{"fea591e7":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nsns.set()\n","24a80b09":"df_train = pd.read_csv('..\/input\/chaii-hindi-and-tamil-question-answering\/train.csv')\ndf_test = pd.read_csv('..\/input\/chaii-hindi-and-tamil-question-answering\/test.csv')\ndf_sub = pd.read_csv('..\/input\/chaii-hindi-and-tamil-question-answering\/sample_submission.csv')","50a99b49":"df_train.head(15)","77afffbb":"print(f\"Total samples in train set: {len(df_train)}\")\nprint(f\"Total samples in test set: {len(df_test)}\")\nprint(f\"Total samples for submission: {len(df_sub)}\")","908cbc1c":"df_train.info()","03358920":"# Train Language splits\nprint(\"LANGUAGE SPLIT FOR TRAIN SET\")\nprint(df_train['language'].value_counts())\nprint(\"\\n\")\n# Test Language Split\nprint(\"LANGUAGE SPLIT FOR TEST SET\")\nprint(df_test['language'].value_counts())\n","59586149":"# For Train Set\ndf_train['language'].value_counts().plot.bar()\nplt.title('Train Language Split')","b1712a7d":"# spliting the dataframe into language specific dataframes\ndf_train_hindi = df_train[df_train['language']=='hindi']\ndf_train_tamil = df_train[df_train['language']=='tamil']","5d7986e1":"# For Hindi\ndf_train_hindi['question'].apply(lambda x: len(x.split())).plot(kind='hist')\nplt.title('Question Word Count for Hindi')","ccb9d7a4":"# For Tamil\ndf_train_tamil['question'].apply(lambda x: len(x.split())).plot(kind='hist')\nplt.title('Question Word Count for Tamil')","bfc06ab5":"# For Hindi\ndf_train_hindi['question'].apply(lambda x: len(x)).plot(kind='hist')\nplt.title('Question Char Count for Hindi')","2a6440b8":"# For Tamil\ndf_train_tamil['question'].apply(lambda x: len(x)).plot(kind='hist')\nplt.title('Question Char Count for Tamil')","e59a24fa":"# For Hindi\ndf_train_hindi['context'].apply(lambda x: len(x.split())).plot(kind='hist')\nplt.title('Context Word Count for Hindi')","469585a5":"# For Tamil\ndf_train_tamil['context'].apply(lambda x: len(x.split())).plot(kind='hist')\nplt.title('Context Word Count for Tamil')","604d7bfc":"# For Hindi\ndf_train_hindi['context'].apply(lambda x: len(x)).plot(kind='hist')\nplt.xscale('log')\nplt.title('Context Char count for Hindi')\n","3b0e8ac7":"# For Tamil\ndf_train_tamil['context'].apply(lambda x: len(x)).plot(kind='hist')\nplt.xscale('log')\nplt.title('Context Char count for Tamil')\n","71f68781":"# For Full Train Set Question : Word Level\ndf_train['question'].apply(lambda x: len(x.split())).plot(kind='hist')\nplt.title('Question word count in words for Full Train Set')","0452babc":"# For Full Train Set Question : Char level\ndf_train['question'].apply(lambda x: len(x)).plot(kind='hist')\nplt.title('Question Char count for Full Train Set')","4f6fb1b1":"# For Full Set Train Context : Word Level\ndf_train['context'].apply(lambda x: len(x.split())).plot(kind='hist')\nplt.title('Context word count for Full Train Set')","352ab538":"# For Full Set Train Context : Char level\ndf_train['context'].apply(lambda x: len(x)).plot(kind='hist')\nplt.xscale('log')\nplt.title('Context char count for Full Train Set')","9b68e15b":"from transformers import pipeline","400dbf00":"model_name = \"..\/input\/xlm-roberta-squad2\/deepset\/xlm-roberta-large-squad2\"\nbatch_size = 16","a0db83d2":"pip1 = pipeline('question-answering', model=model_name, tokenizer=model_name, device=0)","165eaf33":"predictions = []\nfor que,cont in df_test[['question','context']].to_numpy():\n    ans = pip1(context=cont, question=que)\n    print(ans)\n    predictions.append(ans['answer'])","4b305039":"submission_df = pd.DataFrame(data={\"id\": df_test[\"id\"], \"PredictionString\": predictions})\n\nsubmission_df.to_csv(\"submission.csv\", index=False)\n\nsubmission_df","d45dc247":"## Full Train Set Level Stats for Words and Characters","89d7ffa1":"### Question Char Length","ea0dbb63":"### Words and Char Stats for Context","1042f98d":"## Let us get to the Exploration, Shall we?\n<img src=\"https:\/\/media.giphy.com\/media\/xT9C25UNTwfZuk85WP\/giphy.gif\" width=\"500\" class=\"center\">","8f0056cc":"### Word and Char stats for Questions","e3a01e6a":"Watch this space for more updates, lets see how it goes.\n\n**If you like it so far, consider upvoting \ud83d\ude04** \n\n<img src=\"https:\/\/media.giphy.com\/media\/eunrMjB8lBUKeL1fqD\/giphy-downsized.gif\">","73359b84":"### Question Word Length","3ad474a9":"### Context Word Length","f8ccb57e":"## Language metrics","b2c65f38":"So For the baseline using transformers pipeline, In the future iterations of the kernel we have the following targets:\n- Advanced EDA\n- Beating the above baseline\n\n<img src=\"https:\/\/media.giphy.com\/media\/u5BzptR1OTZ04\/giphy.gif\" width='500'>","eee3b3cc":"# Baseline Model","0f0982c3":"## Language-wise Word and Character plots","0a694486":"## It's Raining Imports here!!!","c365d495":"Since this is the very first version, we will keep it simple and evolve it as the competition proceeds.\n\nFor now Sticking to the pipeline from the transformers library and later will enhance the solution. This mean unfortunately no finetuning or training in this one lads.\n\n<img src=\"https:\/\/media.giphy.com\/media\/7CiWMPL8IZFwq0DLxy\/giphy-downsized.gif\">","087644e7":"## Loading The Data","9e5fa978":"**More EDA in upcoming versions, this seems to be okay for now**","a97ff30a":"# ChAII Starter Code: EDA + Baseline\nMy first proper competition with text and QnA. The plan you ask? ... well its simple \n<img src=\"https:\/\/media.giphy.com\/media\/l3V0x0469o9iWA2He\/giphy.gif\">\n- Learn along the way\n- Getting better at EDA\n- Explore different tricks in the Text\/NLP domain\n- Train some fancy models (well, why not :D)\n- Try to get a decent leaderboard finish (nothing fancy, haven't participated actively in any competition so far)","3778ddff":"### Context Char Length"}}