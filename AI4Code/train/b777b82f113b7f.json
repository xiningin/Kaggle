{"cell_type":{"00607349":"code","9f659966":"code","fe1732d6":"code","d1254b85":"code","f063adbe":"code","e10ac426":"code","3c41d9d2":"code","8ee36e49":"code","5c14bb11":"code","9d219ef6":"code","92b88484":"code","a98f22be":"code","b50f7bc2":"code","62631832":"code","ddded28c":"markdown","aa19f5cc":"markdown","f8d2d60b":"markdown"},"source":{"00607349":"import pandas as pd\nimport numpy as np\nfrom sklearn.preprocessing import LabelEncoder\nfrom nltk.corpus import stopwords\nimport re\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.model_selection import train_test_split\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nsw = stopwords.words('english')","9f659966":"dataset = pd.read_csv('..\/input\/winemag-data_first150k.csv')","fe1732d6":"dataset.head()","d1254b85":"dataset.info()","f063adbe":"dataset.dropna(axis=0)","e10ac426":"input_data = dataset['description']\noutput_data = dataset['variety']","3c41d9d2":"print ('There are %d varieties of wines in this dataset' % len(set(output_data)))","8ee36e49":"labelEncoder = LabelEncoder()\noutput_data = labelEncoder.fit_transform(output_data)\noutput_data","5c14bb11":"input_data = input_data.str.lower()","9d219ef6":"list_aux = []\nfor phase_word in input_data:\n    list_aux.append(' '.join([re.sub('[0-9\\W_]', '', word) for word in phase_word.split() if not word in sw]))\ninput_data = list_aux","92b88484":"countVectorizer = CountVectorizer()\ninput_data = countVectorizer.fit_transform(input_data)","a98f22be":"X_train, X_test, y_train, y_test = train_test_split(input_data, output_data, test_size=0.2) ","b50f7bc2":"model = Sequential()\nmodel.add(Dense(100, activation='relu', input_dim=len(countVectorizer.get_feature_names())))\nmodel.add(Dense(units=output_data.max()+1, activation='sigmoid'))\nmodel.compile(loss='sparse_categorical_crossentropy', optimizer='adam', metrics=['accuracy'])\nmodel.fit(X_train, y_train, epochs=2, verbose=1)\n","62631832":"scores = model.evaluate(X_test, y_test, verbose=1)\nprint ('The accuracy of the model is %s' % scores[1])","ddded28c":"How many varieties of wine do we have in this dataset?","aa19f5cc":"Now it is time to clean the description data","f8d2d60b":"Since we have 632 varieties of wines in the dataset, the enconder is going from 0 to 631 "}}