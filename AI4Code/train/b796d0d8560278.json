{"cell_type":{"47050775":"code","0563e491":"code","d23ab1e2":"code","a3e5788e":"code","0016ac32":"code","fd188a87":"code","8e97c98f":"code","e1a07c96":"code","ad24f9b4":"code","5b508f94":"code","69255c5d":"code","0631b75e":"code","0db35f52":"code","979038c2":"code","411e2f70":"code","f3def6e1":"code","069f586a":"code","1f7604ec":"code","d81b714c":"code","148419fe":"code","a1916192":"code","0b925e01":"code","01b31592":"code","a2d947d0":"code","a4b0a1fb":"code","cd3954a2":"code","65380741":"code","197822df":"code","fb0a1ad7":"code","f3d04ae6":"code","2626734d":"code","2e3af3f6":"code","773c0c23":"code","9b268497":"code","b887331b":"code","b2e848f9":"code","5ac30b83":"code","32e7864a":"code","dab83fc7":"code","10ea905e":"code","a5d8e241":"code","b4ed6940":"code","c8680224":"code","c7ae2a8b":"code","62989c25":"code","1aa5d54f":"code","7ead95ae":"code","701b1974":"code","3e386dd9":"code","45fc5c22":"code","75d4ef3c":"code","5e98eb07":"markdown","47ef08e5":"markdown","55f767e7":"markdown","886d5b88":"markdown","a682735d":"markdown","81ef548f":"markdown","7a7cd666":"markdown","aa3445e5":"markdown","e824901b":"markdown","220eb48d":"markdown","ef2edbd1":"markdown","435e37cd":"markdown","46471f76":"markdown","b195bdf5":"markdown"},"source":{"47050775":"import pandas as pd\nimport numpy as np\npd.options.display.max_columns=None\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom scipy.stats import zscore\nimport warnings\nwarnings.filterwarnings('ignore')","0563e491":"# Loading the dataset whcih having city and region columns\nhouse=pd.read_csv('\/kaggle\/input\/house-price\/innercityn.csv')\ny=house['price']","d23ab1e2":"# Shape and Size of the dataset\nprint(\"The shape of the dataset\",house.shape)\nprint(\"The size of the dataset\",house.size)","a3e5788e":"#Check the null values in the dataset\nhouse.isnull().sum()","0016ac32":"#Description of the dataset\nhouse.describe().transpose()","fd188a87":"#Checking the datatypes of the dataset\nhouse.info()","8e97c98f":"house.head()","e1a07c96":"#Extracting the year and Month from the dayhours feature\nhouse['dayhours']=house['dayhours'].apply(lambda x:x.rstrip('T0'))\nhouse['year']=house['dayhours'].apply(lambda x:x[0:4]) # The Year which house was sold\nhouse['month']=house['dayhours'].apply(lambda x:x[4:6])\nhouse.drop('dayhours',axis=1,inplace=True) #droping the dayhours feature","ad24f9b4":"#Dropping the Cid feature\nhouse.drop('cid',axis=1,inplace=True)\nhouse.drop('zipcode',axis=1,inplace=True) #Already we extracted region column from zipcode","5b508f94":"#Creating the Two columns\nhouse['year']=house['year'].astype('int64')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \nhouse['age']=house['year']-house['yr_built'] # Age of the house\nhouse['rage']=house['year']-house['yr_renovated'] # The Age of the house after renovation done\nhouse.drop(['yr_built','yr_renovated','year'],axis=1,inplace=True) # Removal of these columns","69255c5d":"#Some of the columns shows datatype as numerical but it should be categorical so,changed columns to object\nhouse[['room_bed','ceil','coast','sight','condition','quality','furnished','room_bath','age','rage']]=house[['room_bed','ceil','coast','sight','condition','quality','furnished','room_bath','age','rage']].astype('object')","0631b75e":"#Extracting num cols and we are not applying zscore for price feature\nnum_cols=house.select_dtypes(['int64','float64']).columns\nnum_cols1=num_cols[1:]\nnum_cols1","0db35f52":"#Exrtacting numerical features to house_num dataframe\nhouse_num=house[num_cols1]","979038c2":"#Applying zscore to numerical features\nhouse_num[num_cols1]=house_num[num_cols1].apply(zscore)\nhouse_num.head()","411e2f70":"# EXtracting the outliers and replacing with them null values\nfor i in range(len(num_cols1)):  # number of columns\n    for j in range(len(house_num)):  # number of rows\n        if abs(house_num[num_cols1[i]][j])>3:  # condition to extract outliers\n            house_num[num_cols1[i]].replace({house_num[num_cols1[i]][j]:np.nan},inplace=True)","f3def6e1":"#Chceking the null values in the after replacement of outliers with null\nhouse_num.isnull().sum()","069f586a":"#Dropping the numerical columns in the orginal house dataset\nhouse.drop(['living_measure', 'lot_measure', 'ceil_measure', 'basement', 'lat',\n       'long', 'living_measure15', 'lot_measure15', 'total_area'],axis=1,inplace=True)","1f7604ec":"#Concating house_num data to original house data\nhousef=pd.concat([house,house_num],axis=1)\nhousef.head()","d81b714c":"housef.drop(['City','price'],axis=1,inplace=True)","148419fe":"#Applying the label Encoder for some specific columns\nlabels=['age','room_bath','rage','ceil']\nfrom sklearn.preprocessing import LabelEncoder\nle=LabelEncoder()\nfor i in labels:\n    housef[i]=le.fit_transform(house[i])","a1916192":"#Get dummies for Region column\nhousef=pd.get_dummies(housef,columns=['Region'],drop_first=True)","0b925e01":"!pip install impyute","01b31592":"from impyute.imputation.cs import mice # Importing the MICE","a2d947d0":"allcols=housef.columns # Getting all columns","a4b0a1fb":"housef[allcols]=housef[allcols].astype('float64') # For MICE every feature should be in Numerical","cd3954a2":"#Applying MICE to the whole dataset\nhouse_mice=mice(housef)","65380741":"house_mice.columns=housef.columns","197822df":"# For MICE we have converted all features to numerical, so we are again converting to original datatype\ncat_cols=['room_bed', 'room_bath', 'ceil', 'coast', 'sight', 'condition',\n       'quality', 'furnished', 'month', 'age', 'rage',\n       'Region_North East', 'Region_North West', 'Region_South East',\n       'Region_South West']\nhouse_mice[cat_cols]=house_mice[cat_cols].astype('object')","fb0a1ad7":"house_mice.info()","f3d04ae6":"from sklearn.tree import DecisionTreeRegressor\nfrom sklearn.ensemble import RandomForestRegressor,AdaBoostRegressor,BaggingRegressor,GradientBoostingRegressor\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error","2626734d":"Xtrain,Xtest,Ytrain,Ytest=train_test_split(house_mice,y,test_size=0.2,random_state=10)","2e3af3f6":"Xtrain.shape","773c0c23":"lr=LinearRegression()\nlr.fit(Xtrain,Ytrain)\nytrain_lr=lr.predict(Xtrain)\nypred_lr=lr.predict(Xtest)\na=lr.score(Xtrain,Ytrain) # TRAINING ACCRACY\nb=lr.score(Xtest,Ytest)  # TEST ACCURACY\nprint(\"The Training Accuracy is\",a*100) \nprint(\"The Test Accuracy is \",b*100)\nrmse_lr=np.sqrt(mean_squared_error(Ytrain,ytrain_lr)) # TRAIN RMSE\nrmse_lr1=np.sqrt(mean_squared_error(Ytest,ypred_lr)) #TEST RMSE\nprint(\"The Train RMSE for Linear Regression is\",rmse_lr)\nprint(\"The Test RMSE for Linear Regression is\",rmse_lr1)","9b268497":"df=pd.DataFrame({'columns':Xtrain.columns})\n#lr.coef_\ndf['Coeffciants']=lr.coef_\ndf.head()","b887331b":"Xtrain.columns","b2e848f9":"rf=RandomForestRegressor()\nrf.fit(Xtrain,Ytrain)\nytrain_rf=rf.predict(Xtrain)\nypred_rf=rf.predict(Xtest)\nc=rf.score(Xtrain,Ytrain) # TRAIN ACCURAY\nd=rf.score(Xtest,Ytest) #TEST ACCURACY\nprint(\"The Training Accuracy is\",c*100) \nprint(\"The Test Accuracy is \",d*100) \nrmse_rf=np.sqrt(mean_squared_error(Ytrain,ytrain_rf)) # TRANING RMSE\nrmse_rf1=np.sqrt(mean_squared_error(Ytest,ypred_rf)) # TEST RMSE\nprint(\"The TRAIN RMSE for Random is\",rmse_rf)\nprint(\"The TEST RMSE for Random Forest Regression is\",rmse_rf1)","5ac30b83":"gb=GradientBoostingRegressor()\ngb.fit(Xtrain,Ytrain)\nypred_gb=gb.predict(Xtest)\nytrain_gb=gb.predict(Xtrain)\ne=gb.score(Xtrain,Ytrain) # TRAIN ACCURACY\nf=gb.score(Xtest,Ytest) #TEST ACCURACY\nprint(\"The Training Accuracy is\",e*100) \nprint(\"The Test Accuracy is \",f*100) \nrmse_gb=np.sqrt(mean_squared_error(Ytrain,ytrain_gb)) #TRAIN RMSE\nrmse_gb1=np.sqrt(mean_squared_error(Ytest,ypred_gb)) # TEST RMSE\nprint(\"The TRAIN RMSE for Gradient Regression is\",rmse_gb)\nprint(\"The TEST RMSE for Gradient Regression is\",rmse_gb1)","32e7864a":"gb=GradientBoostingRegressor(random_state=100)\nbg=BaggingRegressor(base_estimator=gb)\nbg.fit(Xtrain,Ytrain)\nypred_bg=bg.predict(Xtest)\nytrain_bg=bg.predict(Xtrain)\ng=bg.score(Xtrain,Ytrain)\nh=bg.score(Xtest,Ytest)\nprint(\"The Training Accuracy is\",g*100)  #RAIN ACCURACY\nprint(\"The Test Accuracy is \",h*100)  # TEST ACCURACY\nrmse_bg=np.sqrt(mean_squared_error(Ytrain,ytrain_bg)) #TRAIN RMSE\nrmse_bg1=np.sqrt(mean_squared_error(Ytest,ypred_bg)) #TEST RMSE\nprint(\"The TRAIN RMSE for Bagging Regression is\",rmse_bg)\nprint(\"The TEST RMSE for Bagging Regression is\",rmse_bg1)","dab83fc7":"models=[ypred_lr,ypred_rf,ypred_gb,ypred_bg]\nr2_score=[]\nadr2_score=[]\nfor i in models:\n    SS_Residual = sum((Ytest-i)**2)\n    SS_Total = sum((Ytest-np.mean(Ytest))**2)\n    r_squared = 1 - (float(SS_Residual))\/SS_Total\n    r2_score.append(r_squared*100)\n    adjusted_r_squared = 1 - (1-r_squared)*(len(Ytest)-1)\/(len(Ytest)-Xtrain.shape[1]-1)\n    adr2_score.append(adjusted_r_squared*100)","10ea905e":"bestmodel=pd.DataFrame({'Model':['LR','RF','GB','BG']})\nbestmodel['Train RMSE']=[round(rmse_lr),round(rmse_rf),round(rmse_gb),round(rmse_bg)]\nbestmodel['Test RMSE']=[round(rmse_lr1),round(rmse_rf1),round(rmse_gb1),round(rmse_bg1)]\nbestmodel['Train R2_Score %']=[round(a*100,2),round(c*100,2),round(e*100,2),round(g*100,2)]\nbestmodel['Test R2_Score %']=[round(b*100,2),round(d*100,2),round(f*100,2),round(h*100,2)]\nbestmodel['Adj_Score']=adr2_score","a5d8e241":"bestmodel","b4ed6940":"from sklearn.feature_selection import RFE\n\nlr=LinearRegression()\n# .fit(X_train,y_train)\nrfe = RFE(lr,14)\nrfe.fit(Xtrain,Ytrain)\nprint(rfe.support_)\nprint(rfe.ranking_)\nidc_rfe = pd.DataFrame({\"rfe_support\" :rfe.support_,\n                       \"columns\" :Xtrain.columns ,\n                       \"ranking\" : rfe.ranking_,\n                      })\ncols = idc_rfe[idc_rfe[\"rfe_support\"] == True][\"columns\"].tolist()","c8680224":"house_rfe=house_mice[cols]","c7ae2a8b":"Xtrain,Xtest,Ytrain,Ytest=train_test_split(house_rfe,y,test_size=0.3,random_state=10)","62989c25":"lr=LinearRegression()\nlr.fit(Xtrain,Ytrain)\nytrain_lr=lr.predict(Xtrain)\nypred_lr=lr.predict(Xtest)\na=lr.score(Xtrain,Ytrain) # TRAINING ACCRACY\nb=lr.score(Xtest,Ytest)  # TEST ACCURACY\nprint(\"The Training Accuracy is\",a*100) \nprint(\"The Test Accuracy is \",b*100)\nrmse_lr=np.sqrt(mean_squared_error(Ytrain,ytrain_lr)) # TRAIN RMSE\nrmse_lr1=np.sqrt(mean_squared_error(Ytest,ypred_lr)) #TEST RMSE\nprint(\"The Train RMSE for Linear Regression is\",rmse_lr)\nprint(\"The Test RMSE for Linear Regression is\",rmse_lr1)","1aa5d54f":"df1=pd.DataFrame({'columns':Xtrain.columns})\ndf1['Coef_']=lr.coef_\ndf1","7ead95ae":"rf=RandomForestRegressor()\nrf.fit(Xtrain,Ytrain)\nytrain_rf=rf.predict(Xtrain)\nypred_rf=rf.predict(Xtest)\nc=rf.score(Xtrain,Ytrain) # TRAIN ACCURAY\nd=rf.score(Xtest,Ytest) #TEST ACCURACY\nprint(\"The Training Accuracy is\",c*100) \nprint(\"The Test Accuracy is \",d*100) \nrmse_rf=np.sqrt(mean_squared_error(Ytrain,ytrain_rf)) # TRANING RMSE\nrmse_rf1=np.sqrt(mean_squared_error(Ytest,ypred_rf)) # TEST RMSE\nprint(\"The TRAIN RMSE for Random is\",rmse_rf)\nprint(\"The TEST RMSE for Random Forest Regression is\",rmse_rf1)","701b1974":"gb=GradientBoostingRegressor()\ngb.fit(Xtrain,Ytrain)\nypred_gb=gb.predict(Xtest)\nytrain_gb=gb.predict(Xtrain)\ne=gb.score(Xtrain,Ytrain) # TRAIN ACCURACY\nf=gb.score(Xtest,Ytest) #TEST ACCURACY\nprint(\"The Training Accuracy is\",e*100) \nprint(\"The Test Accuracy is \",f*100) \nrmse_gb=np.sqrt(mean_squared_error(Ytrain,ytrain_gb)) #TRAIN RMSE\nrmse_gb1=np.sqrt(mean_squared_error(Ytest,ypred_gb)) # TEST RMSE\nprint(\"The TRAIN RMSE for Gradient Regression is\",rmse_gb)\nprint(\"The TEST RMSE for Gradient Regression is\",rmse_gb1)","3e386dd9":"gb=GradientBoostingRegressor()\nbg=BaggingRegressor(base_estimator=gb)\nbg.fit(Xtrain,Ytrain)\nypred_bg=bg.predict(Xtest)\nytrain_bg=bg.predict(Xtrain)\ng=bg.score(Xtrain,Ytrain)\nh=bg.score(Xtest,Ytest)\nprint(\"The Training Accuracy is\",g*100)  #RAIN ACCURACY\nprint(\"The Test Accuracy is \",h*100)  # TEST ACCURACY\nrmse_bg=np.sqrt(mean_squared_error(Ytrain,ytrain_bg)) #TRAIN RMSE\nrmse_bg1=np.sqrt(mean_squared_error(Ytest,ypred_bg)) #TEST RMSE\nprint(\"The TRAIN RMSE for Bagging Regression is\",rmse_bg)\nprint(\"The TEST RMSE for Bagging Regression is\",rmse_bg1)","45fc5c22":"models=[ypred_lr,ypred_rf,ypred_gb,ypred_bg]\nr2_score=[]\nadr2_score=[]\nfor i in models:\n    SS_Residual = sum((Ytest-i)**2)\n    SS_Total = sum((Ytest-np.mean(Ytest))**2)\n    r_squared = 1 - (float(SS_Residual))\/SS_Total\n    r2_score.append(r_squared*100)\n    adjusted_r_squared = 1 - (1-r_squared)*(len(Ytest)-1)\/(len(Ytest)-Xtrain.shape[1]-1)\n    adr2_score.append(round(adjusted_r_squared*100,2))","75d4ef3c":"bestmodel=pd.DataFrame({'Model':['LR','RF','GB','BG']})\nbestmodel['Train RMSE']=[round(rmse_lr),round(rmse_rf),round(rmse_gb),round(rmse_bg)]\nbestmodel['Test RMSE']=[round(rmse_lr1),round(rmse_rf1),round(rmse_gb1),round(rmse_bg1)]\nbestmodel['Train R2_Score %']=[round(a*100,2),round(c*100,2),round(e*100,2),round(g*100,2)]\nbestmodel['Test R2_Score %']=[round(b*100,2),round(d*100,2),round(f*100,2),round(h*100,2)]\nbestmodel['Adj_Score']=adr2_score\nbestmodel","5e98eb07":"### Data Prepration","47ef08e5":"### Data Cleaning & Feature Engineering","55f767e7":"### BEST MODEL","886d5b88":" cid: a notation for a house\n1.\tdayhours: Date house was sold\n2.\tprice: Price is prediction target\n3.\troom_bed: Number of Bedrooms\/House\n4.\troom_bath: Number of bathrooms\/bedrooms\n5.\tliving_measure: square footage of the home\n6.\tlot_measure: square footage of the lot\n7.\tceil: Total floors (levels) in house\n8.\tcoast: House which has a view to a waterfront\n9.\tsight: Has been viewed\n10.\tcondition: How good the condition is (Overall)\n11.\tquality: grade given to the housing unit, based on grading system\n12.\tceil_measure: square footage of house apart from basement\n13.\tbasement_measure: square footage of the basement\n14.\tyr_built: Built Year\n15.\tyr_renovated: Year when house was renovated\n16.\tzipcode: zip\n17.\tlat: Latitude coordinate\n18.\tlong: Longitude coordinate\n19.\tliving_measure15: Living room area in 2015(implies-- some renovations) This might or might not have affected the lotsize area\n20.\tlot_measure15: lotSize area in 2015(implies-- some renovations)\n21.\tfurnished: Based on the quality of room 23: total_area: Measure of both living and lot\n","a682735d":"#### Outlier Treatment","81ef548f":"### Data Description","7a7cd666":"### Data Ingestion","aa3445e5":"### Calculating Adjusted R2_Score","e824901b":"### Extracting Numerical Columns and Applying Zscore","220eb48d":"### MICE","ef2edbd1":"### Model after RFE","435e37cd":"### Feature Selection","46471f76":"###  To build a prediction model to evaluate the price of a house with the given features.","b195bdf5":"### Model Buliding"}}