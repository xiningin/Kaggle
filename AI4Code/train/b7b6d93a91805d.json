{"cell_type":{"06074b2d":"code","fe49430b":"code","bc405ce8":"code","1508d6b5":"code","73a45a9c":"code","3cb3d1e9":"code","f4ee7f0c":"code","c00f92fc":"code","3a564ca6":"code","544d76df":"code","3143a529":"code","4499797f":"code","5208ec7d":"code","8949491f":"code","cb1e216e":"code","4f377d4f":"code","8afd4115":"code","5a943ec8":"code","a437e188":"code","68133dca":"code","52d3ee44":"code","02ea37b5":"code","2379de29":"code","2b3912d1":"code","dd5ffccb":"code","5fd957c0":"code","b7b7b203":"code","47f48586":"code","a56badf3":"code","6088b0b7":"code","c455f674":"code","8c3b8cf9":"code","614347db":"code","95e3f314":"code","09eb4005":"code","f5afca8b":"code","affde3ac":"code","ccde9193":"code","7f3ec551":"code","f081e288":"code","766a8f76":"markdown","7f36a468":"markdown","58d11a19":"markdown","f1e7a894":"markdown","78cab447":"markdown","994269d0":"markdown","5433cbe6":"markdown","07d47a37":"markdown","b9236811":"markdown","e9a777b4":"markdown","9aa3c7bd":"markdown","ace18c2d":"markdown","4fd03585":"markdown","a1bd1605":"markdown","8ee84dd3":"markdown","a7ef1a98":"markdown","72dde224":"markdown","1eae8b36":"markdown","ef091125":"markdown","7e01b188":"markdown","ff6b1b8a":"markdown","edc35e38":"markdown","bb292535":"markdown","99e0c520":"markdown","76b7ed6d":"markdown","0f331036":"markdown","2eca8967":"markdown","cc779fe8":"markdown","67197e0f":"markdown","fc37aa26":"markdown","1d745457":"markdown","9c890791":"markdown","0c63d9ed":"markdown","25d7f826":"markdown","a284bad5":"markdown","6f03d49b":"markdown","a6e47781":"markdown","c13e1e2a":"markdown","29f43851":"markdown","c4a8ea56":"markdown"},"source":{"06074b2d":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport missingno as msno\nsns.set(style='darkgrid',context='notebook')\n%matplotlib inline\nfrom pandas_profiling import ProfileReport\n\nfrom plotly.subplots import make_subplots\nimport plotly.graph_objects as go\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n        \nimport warnings\nwarnings.filterwarnings('ignore')","fe49430b":"city_day=pd.read_csv('\/kaggle\/input\/air-quality-data-in-india\/city_day.csv')\nprint(city_day.shape)\ncity_day.head()","bc405ce8":"city_day.info()","1508d6b5":"city_day.describe()","73a45a9c":"def missing_values_table(df):\n        # Total missing values\n        missing_val = df.isnull().sum()\n        \n        # Percentage of missing values\n        missing_val_percent = 100 * df.isnull().sum() \/ len(df)\n        \n        # Make a table with the results\n        missing_val_table = pd.concat([missing_val, missing_val_percent], axis=1)\n        \n        # Rename the columns\n        missing_val_table_ren_columns = missing_val_table.rename(\n        columns = {0 : 'Missing Values', 1 : '% of Total Values'})\n        \n        # Sort the table by percentage of missing values in descending order, \n        # ignoring the colums with no missing values.\n        missing_val_table_ren_columns = missing_val_table_ren_columns[\n            missing_val_table_ren_columns.iloc[:,1] != 0].sort_values(\n        '% of Total Values', ascending=False).round(2)\n        \n        # Print some summary information\n        print (\"The DataFrame has \" + str(df.shape[1]) + \" columns.\\n\"      \n            \"There are \" + str(missing_val_table_ren_columns.shape[0]) +\n              \" columns that have missing values.\")\n        plt.subplots(figsize=(12,8))\n        sns.barplot(y=missing_val_table_ren_columns['% of Total Values'],x=missing_val_table_ren_columns.index)\n        plt.show()\n        # Return the dataframe with missing information\n        return missing_val_table_ren_columns\n    \nmissing_values_table(city_day)","3cb3d1e9":"city_day1=city_day.copy()","f4ee7f0c":"city_day['BTX']=city_day['Benzene'] + city_day['Toluene'] + city_day['Xylene']\ncity_day.drop(['Benzene','Toluene','Xylene'],axis=1,inplace=True)\ncity_day[city_day['City']=='Gurugram'].tail(7)","c00f92fc":"city_day['Date'] = pd.to_datetime(city_day['Date'])\nprint('Data is available for the period {} to {} '.format(city_day['Date'].min(),city_day['Date'].max()))","3a564ca6":"cities_all=city_day['City'].value_counts()\nprint('We have data for the following cities:')\nprint(list(cities_all.index))","544d76df":"def city_wise_pollution(pollutant):\n    i=city_day[[pollutant,'City']].groupby('City').mean().sort_values(by=pollutant,ascending=False).reset_index()\n    return i[:10].style.background_gradient(cmap='PuBu')","3143a529":"from IPython.display import display_html\ndef display_side_by_side(*args):\n    html_str=''\n    for df in args:\n        html_str+=df.render()\n    display_html(html_str.replace('table','table style=\"display:inline\"'),raw=True)","4499797f":"pm25=city_wise_pollution('PM2.5')\npm10=city_wise_pollution('PM10')\nbtx=city_wise_pollution('BTX')\nso2=city_wise_pollution('SO2')\nno2=city_wise_pollution('NO2')\nco=city_wise_pollution('CO')\nnh3=city_wise_pollution('NH3')\nAQI=city_wise_pollution('AQI')\n\npollutants=['PM2.5','PM10','SO2','BTX','CO','NH3','NO2']\n\ndisplay_side_by_side(pm25,pm10,btx,so2,no2,co,nh3,AQI)","5208ec7d":"def barplot(df,pollutant):\n    bar=df[[pollutant,'City']].groupby(['City']).mean().sort_values(by=pollutant,ascending=False).reset_index()\n    ax,fig=plt.subplots(figsize=(16,6))\n    sns.barplot(x='City',y=pollutant,data=bar,palette='viridis')\n    plt.xlabel('City',fontsize=16)\n    plt.ylabel(pollutant,fontsize=16)\n    plt.xticks(rotation=45,horizontalalignment='center',fontsize=12)","8949491f":"barplot(city_day,'PM2.5')","cb1e216e":"barplot(city_day,'PM10')","4f377d4f":"barplot(city_day,'SO2')","8afd4115":"barplot(city_day,'NO2')","5a943ec8":"barplot(city_day,'CO')","a437e188":"barplot(city_day,'NH3')","68133dca":"barplot(city_day,'AQI')","52d3ee44":"city_day.set_index('Date',inplace=True)  # only run this line once, second time it will give out error\npollutants=['PM2.5','PM10','SO2','BTX','CO','NH3','NO2']\n\naxes=city_day[pollutants].plot(marker='.',figsize=(16,20),subplots=True,alpha=0.3)\nfor axes in axes:\n    axes.set_xlabel('Years',fontsize=16)\n    axes.set_ylabel('Concentration',fontsize=12)\nplt.show()","02ea37b5":"def seasonality(df,val):\n    df['year']=[d.year for d in df.Date]   \n    df['months']=[d.strftime('%m') for d in df.Date]\n    \n    fig,axes=plt.subplots(1,2,figsize=(16,8))\n    \n    sns.boxplot(x='year',y=val, data=df,ax=axes[0])\n    sns.lineplot(x='months',y=val,data=df.loc[~df.year.isin([2020]),:]) # not including 2020 as data is available\n    axes[0].set_title('Yearly Boxplot',fontsize=14)                     # onlt till May\n    axes[1].set_title('Monthly Lineplot',fontsize=14)\n    plt.show()","2379de29":"city_day2=city_day.copy()  # df with date as index\ncity_day.reset_index(inplace=True)  # only run this line once, second time it will give out error\nseasonality(city_day,'PM10')","2b3912d1":"seasonality(city_day,'PM2.5')","dd5ffccb":"seasonality(city_day,'SO2')","5fd957c0":"seasonality(city_day,'NO2')","b7b7b203":"seasonality(city_day,'BTX')","47f48586":"seasonality(city_day,'O3')","a56badf3":"seasonality(city_day,'AQI')","6088b0b7":"cities=['Ahmedabad','Bengaluru','Chennai','Delhi','Kolkata']\n\ncity_day_cities=city_day[city_day['Date'] >= '2019-01-01']\nAQI_table=city_day_cities[city_day_cities['City'].isin(cities)]\nAQI_table=AQI_table[['Date','City','AQI','AQI_Bucket']]\nAQI_table","c455f674":"AQI_table_pivot=AQI_table.pivot(index='Date',columns='City',values='AQI')\nAQI_table_pivot.head(7)","8c3b8cf9":"AQI_table_pivot.fillna(method='bfill',inplace=True)\nAQI_table_pivot.describe()","614347db":"fig=make_subplots(rows=5,cols=1,subplot_titles=('Ahmedabad','Bengaluru','Chennai','Delhi','Kolkata'))\n\nfig.add_trace(go.Bar(x=AQI_table_pivot.index,y=AQI_table_pivot['Ahmedabad']\n                     ,marker=dict(color=AQI_table_pivot['Ahmedabad']\n                                  ,coloraxis=\"coloraxis\")),1,1)\n\nfig.add_trace(go.Bar(x=AQI_table_pivot.index,y=AQI_table_pivot['Bengaluru']\n                     ,marker=dict(color=AQI_table_pivot['Bengaluru']\n                                  ,coloraxis=\"coloraxis\")),2,1)\n\nfig.add_trace(go.Bar(x=AQI_table_pivot.index,y=AQI_table_pivot['Chennai']\n                     ,marker=dict(color=AQI_table_pivot['Chennai']\n                                  ,coloraxis=\"coloraxis\")),3,1)\n\nfig.add_trace(go.Bar(x=AQI_table_pivot.index,y=AQI_table_pivot['Delhi']\n                     ,marker=dict(color=AQI_table_pivot['Delhi']\n                                  ,coloraxis=\"coloraxis\")),4,1)\n\nfig.add_trace(go.Bar(x=AQI_table_pivot.index,y=AQI_table_pivot['Kolkata']\n                     ,marker=dict(color=AQI_table_pivot['Kolkata']\n                                  ,coloraxis=\"coloraxis\")),5,1)\n\nfig.update_layout(coloraxis=dict(colorscale='Temps'),showlegend=False,title_text=\"AQI Levels\")\n\nfig.update_layout( width=1000,height=1200,shapes=[dict(type= 'line',yref= 'paper'\n                                                       ,y0= 0,y1= 1,xref= 'x',x0= '2020-03-25',x1= '2020-03-25')])\n\nfig.show()","95e3f314":"cities=['Ahmedabad','Bengaluru','Chennai','Delhi','Kolkata']\n\npollutants_2019=city_day[(city_day['Date'] >= '2019-01-01') & (city_day['Date'] <= '2019-05-01')]\npollutants_2019.fillna(method='bfill',inplace=True)\npollutants_2019.set_index('Date',inplace=True)\n\npollutants_2020=city_day[(city_day['Date'] >= '2020-01-01') & (city_day['Date'] <= '2020-05-01')]\npollutants_2020.fillna(method='bfill',inplace=True)\npollutants_2020.set_index('Date',inplace=True)\n\npollutants_2019=pollutants_2019[pollutants_2019['City'].isin(cities)][['City','SO2','CO','PM2.5','NO']]\npollutants_2020=pollutants_2020[pollutants_2020['City'].isin(cities)][['City','SO2','CO','PM2.5','NO']]\n","09eb4005":"def comparison(city):\n    # Figure for 2019\n    fig=go.Figure()\n    fig.add_trace(go.Scatter(x=pollutants_2019.index,y=pollutants_2019[pollutants_2019['City']==city]['SO2']\n                             ,line=dict(dash='dash',color='blue'),name='SO2'))\n    \n    fig.add_trace(go.Scatter(x=pollutants_2019.index,y=pollutants_2019[pollutants_2019['City']==city]['CO']\n                             ,line=dict(dash='solid',color='green'),name='CO'))\n                  \n    fig.add_trace(go.Scatter(x=pollutants_2019.index,y=pollutants_2019[pollutants_2019['City']==city]['PM2.5']\n                             ,line=dict(dash='solid',color='rosybrown'),name='PM2.5'))\n                  \n    fig.add_trace(go.Scatter(x=pollutants_2019.index,y=pollutants_2019[pollutants_2019['City']==city]['NO']\n                             ,line=dict(dash='dashdot',color='slategrey'),name='NO'))\n                  \n    fig.update_layout(title_text=city+' 2019 ',width=800,height=500)\n    fig.show()\n    \n    # Figure for 2020\n    \n    fig=go.Figure()\n    fig.add_trace(go.Scatter(x=pollutants_2020.index,y=pollutants_2020[pollutants_2020['City']==city]['SO2']\n                             ,line=dict(dash='dash',color='blue'),name='SO2'))\n    \n    fig.add_trace(go.Scatter(x=pollutants_2020.index,y=pollutants_2020[pollutants_2020['City']==city]['CO']\n                             ,line=dict(dash='solid',color='green'),name='CO'))\n                  \n    fig.add_trace(go.Scatter(x=pollutants_2020.index,y=pollutants_2020[pollutants_2020['City']==city]['PM2.5']\n                             ,line=dict(dash='solid',color='rosybrown'),name='PM2.5'))\n                  \n    fig.add_trace(go.Scatter(x=pollutants_2020.index,y=pollutants_2020[pollutants_2020['City']==city]['NO']\n                             ,line=dict(dash='dashdot',color='slategrey'),name='NO'))\n                  \n    fig.update_layout(title_text=city+' 2020 ',width=800,height=500)\n    fig.show()","f5afca8b":"comparison('Delhi')","affde3ac":"comparison('Ahmedabad')","ccde9193":"comparison('Chennai')","7f3ec551":"comparison('Kolkata')","f081e288":"comparison('Bengaluru')","766a8f76":"* Maximum level of pollutants are observed in Delhi, Patna, Gurugram and Ahmedabad.\n* Ahemdabad has an unsually high mean AQI level.\n","7f36a468":"# Importing necessary libraries","58d11a19":"# Visualising Data","f1e7a894":"# 2.PM2.5","78cab447":"# Comparison of Lockdown on individual pollutants","994269d0":"# 5. CO","5433cbe6":"#### There is a clear decrease in the concentrations of all pollutants after the Lockdown came into effect, especially in Ahmedabad, Delhi and Bengaluru.\n#### This decline can be due to the following reasons:\n* Reduced Commercial and Industrial activity\n* Drastic decrease in level of vehicular movement.\n* Suspension of all construction projects.","07d47a37":"* The general trend amongst all pollutants is that their levels drop in the summer and monsoon months between April and September, after which they experience a sharp rise during the winters.\n* From the boxplots we see that SO2 and NO2 levels increased 2018 onwards.\n* We can notice that the 3rd quantile values for all pollutants as well as AQI for 2019 are genreally lower than those of 2018, this can be due to the fact that 2019 was an extremely wet year for the Indian Subcontinent. The rainfall amounts during both the Southwest Monsoon (June to September) and Northeast Monsoon (October to December) remained **109 per cent** of the Long Period Average (LPA).","b9236811":"# Yearly and Monthly Distributions","e9a777b4":"# 7. AQI","9aa3c7bd":"# 2. PM10","ace18c2d":"* There are indications of seasonality towards the increase in PM2.5 and PM10 levels.\n* We should take a closer look to determine the exact nature of the trend.\n* We can also observe a clear increase in SO2, CO and BTX levels from 2018 onwards. ","4fd03585":"# Importing the Data","a1bd1605":"* The graph is seperated into 'Before Lockdown' and 'After Lockdown' by the vertical black line placed on the date 25-03-2020  \n* We can see a clear decrease in AQI levels in all cities after the lockdown came into effect.","8ee84dd3":"## Now we will check the pollution levels with repect to time","a7ef1a98":"# Objective\n#### In this project we will attempt to determine the effects of the lockdown on the pollution levels in various cities in India. We have been reading reports of clear skies from all across India and will attempt to see if this claim is supported by the data. We have access to a large database containing pollution data dating from 1st January 2015 to 1st May 2020. ","72dde224":"# Analysing missing values","1eae8b36":"# 6. NH3","ef091125":"### Explanation of some features of the dataset:\n1. PM2.5 - It refers to particles that have diameter less than 2.5 micrometres and remain suspended for longer. These particles are formed as a result of burning fuel and chemical reactions that take place in the atmosphere.\n2. PM10 - They are very small particles found in dust and smoke. They have a diameter of 10 micrometres (0.01 mm) or smaller. PM10 particles are a common air pollutant\n3. CO - Carbon monoxide is a temporary atmospheric pollutant in some urban areas, chiefly from the exhaust of internal combustion engines (including vehicles, portable and back-up generators, etc.), but also from incomplete combustion of various other fuels (including wood, coal, natural gas, and trash).\n4. NH3 - Ammonia is a chemical found in trace quantities in nature, being produced from nitrogenous animal and vegetable matter.\n5. SO2 - Sulfur dioxide is a noticeable component in the atmosphere, especially following volcanic eruptions. It is a major air pollutant and has significant impacts upon human health.\n6. NOx - In atmospheric chemistry, NOx is a generic term for the nitrogen oxides that are most relevant for air pollution, namely nitric oxide (NO) and nitrogen dioxide (NO2). These gases contribute to the formation of smog and acid rain, as well as affecting tropospheric ozone. NOx gases are usually produced from the reaction among nitrogen and oxygen during combustion of fuels, such as hydrocarbons in air.\n7. AQI - It stands for Air Quality Index. It is the most important metric in the measurement of air pollution and is considered as the overall pollution level at a location at any given point of time. It is calculated by transforming the weighted values of 8 individual air pollutantion related parameters (PM10, PM2.5, NO2, SO2, CO, O3, Pb and NH3) into a single number or set of numbers. \n**The index has 6 categories: Good (0-50), Satisfactory (51-100), Moderately polluted (101-200), Poor (201-300), Very poor (301-400) and Severe (> 401).**\n","7e01b188":"* As expected we can see maximum amounts of pollutants in metropolitan cities with large populations and significant commercial and maunfacturing activities.\n* The level of pollutants decrease as the size of the city decreases.","ff6b1b8a":"#### We group the data by cities and sort them by taking the mean of the levels of all the pollutants.","edc35e38":"# 3. SO2","bb292535":"* Now let's explore the seasonality of the pollution levels in depth.\n* We will be seeing the trends in each type of pollutant individually with the help of boxplots and lineplots","99e0c520":"# Exploring the data","76b7ed6d":"#### This code cell allows us to create multiple tables side by side in order for us to effectively compare the magnitude of different pollutants in different cities.","0f331036":"* NH3 and PM10 have missing values in more than 30% of the entries, whereas Xylene has missing values in a massive 64% of rows.\n* As a large percentage of values in Benzene, Xylene and Toulene columns are zero, we can combine them with each other to simplify the data and make visualization easier.","2eca8967":"# 7. AQI","cc779fe8":"# 1. PM10","67197e0f":"# 1. PM2.5","fc37aa26":"# 4. NO2","1d745457":"# 6.O3","9c890791":"# Analysis of effects of Lockdown due to COVID-19 on Pollution levels in India\n#### Lockdown in India began on 25th March 2020, when the Indian Goverment put all 1.3 billion of its citizens under mandatory lockdown, as a precautionary measure in order to slowdown the spread of COVID-19 in the country. Only essential services such as medical, water, electricity and grocery services remained active.\n","0c63d9ed":"# Converting Date column to datetime format","25d7f826":"# 5. BTX","a284bad5":"### The missing values can be present due to\n* Accidental Deletion of data\n* Faulty Equipment\n* Values not being recorded","6f03d49b":"* As we can see, many of the colums have a significant amount of null values present in them, especially PM10, NH3 and Xylene.\n* Date column exists as an object dtype and is not in datetime format, we will have to rectify that.","a6e47781":"# AQI Comparison between major cities\n#### We will be selecting major cities from various parts of the country for the comaprison, as that will give us a clear interpretation of the overall effect of the lockdown. ","c13e1e2a":"# 4. NO2","29f43851":"# 3. SO2","c4a8ea56":"# Let's visualize these values in the form of a bar plot to get a better understanding."}}