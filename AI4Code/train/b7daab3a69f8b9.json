{"cell_type":{"5a1c4129":"code","5800fac1":"code","4c405b35":"code","82f8b272":"code","fa6b93a1":"code","5c86afb5":"code","a9bdc40a":"code","f4abadc2":"code","81eaf6a0":"code","9be56373":"code","623d6336":"code","641af446":"code","bd732260":"code","866760d8":"code","33fda0fb":"code","9cd3709e":"code","987b57cc":"code","b72121cd":"code","84dbec96":"code","4af191b3":"code","8ecc7298":"code","2b5f5239":"code","1e6395d0":"code","9eb43b64":"code","dd24cfc2":"code","6ba79aa4":"code","1bfc9d02":"code","63b88102":"code","b6e3b071":"code","cdc22313":"code","1d8a259d":"code","0051b236":"code","a7bddf0d":"code","7d8e343b":"code","8c414103":"code","8a127669":"code","f96a07f8":"code","ecc11dff":"code","758c3cb8":"code","8fcae5ce":"code","68909408":"code","51ad8796":"code","444dc247":"code","0e9df9c4":"code","cc866367":"code","788a7e36":"code","bf9a4077":"code","2e0d877b":"code","514f73e2":"code","7450407e":"code","d4e1aebc":"code","01139621":"code","bc381352":"code","7f6c0489":"code","0064b001":"code","e9c265f8":"code","fc19b96b":"code","e57f3c91":"code","a4c66a98":"code","d42cd418":"code","204d7c5a":"code","3a3713af":"code","456f5a3e":"code","c7d3c2ed":"code","3e100520":"code","d143adf9":"code","8f1a48f6":"code","8dd249e9":"code","1550630b":"code","cdba6ba4":"code","1673d95a":"code","9583243d":"code","a70ac085":"code","84eb4957":"code","1dfc8ab7":"code","29b6b8a4":"code","d2187ede":"code","dafd5a0d":"code","5f25522e":"code","06c23174":"code","d180d950":"code","63538661":"code","1e3a4f22":"code","a7ddeaf4":"code","63be9b7f":"code","4055e6d6":"code","a46b525d":"code","ab7e6444":"code","2e25f208":"markdown","3f5652ef":"markdown","1d96517c":"markdown","c7941846":"markdown","3c698e51":"markdown","3879f5f5":"markdown","86883db5":"markdown","f10c6839":"markdown","4f87b366":"markdown","8b6e903b":"markdown","6123e345":"markdown","bd589170":"markdown","14a7f245":"markdown","3e9f71b7":"markdown","75e4fdaf":"markdown","0d24e1b7":"markdown","8e70f45d":"markdown","f2ad1cd3":"markdown","e4e3ef14":"markdown","65bc5e09":"markdown","d5d1862c":"markdown","8288e73a":"markdown","eea28e36":"markdown","5686d3f3":"markdown","9090dc7d":"markdown","f1e3ee88":"markdown","1fe4a274":"markdown","49be153f":"markdown","95cb140d":"markdown","ba217f51":"markdown","f0ea7a05":"markdown","85eb1786":"markdown","dafb8a3c":"markdown","57391bfb":"markdown","7e551bca":"markdown","8b67e3a9":"markdown","8d1a649c":"markdown","ad8a328a":"markdown","85ed195a":"markdown","12b61e7b":"markdown","43244653":"markdown","f54afa01":"markdown","6173a835":"markdown","9a5a1b97":"markdown","bfd1c7fe":"markdown"},"source":{"5a1c4129":"description = open('..\/input\/house-prices-advanced-regression-techniques\/data_description.txt')\ndata = description.readlines()\ndata = [i for i in data if \":\" in i]\n\nfor i in data: print(i)\ndescription.close()","5800fac1":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport warnings","4c405b35":"# set matplotlib defaults\nplt.style.use(\"seaborn-darkgrid\")\nplt.rc(\"figure\", autolayout = True)\nplt.rc(\"axes\", \n      labelweight = \"bold\",\n      labelsize = \"large\",\n      titleweight = \"bold\",\n      titlesize = 14, \n      titlepad = 10)\n\nwarnings.filterwarnings('ignore')","82f8b272":"train_data = pd.read_csv('..\/input\/house-prices-advanced-regression-techniques\/train.csv')\ntest_data = pd.read_csv('..\/input\/house-prices-advanced-regression-techniques\/test.csv')","fa6b93a1":"print(\"Train Data has \",len(train_data), \" rows\")","5c86afb5":"print(\"Test Data has \", len(test_data), \" rows\")","a9bdc40a":"train_data.head()","f4abadc2":"print(train_data.shape)","81eaf6a0":"train_data.info()","9be56373":"s1 = train_data.dtypes\n\ns1.groupby(s1).count()","623d6336":"train_data.shape","641af446":"train_data.isnull().sum().sort_values(ascending = False).head(20)","bd732260":"test_data.head()","866760d8":"print(test_data.shape)","33fda0fb":"test_data.info()","9cd3709e":"test_data.isnull().sum().sort_values(ascending = False)","987b57cc":"\"\"\"con_data = train_data.copy()\n\n\nfor col in cat_var:\n    con_data = con_data.drop(col, axis = 1)\n    \n    \ntraining_corr = con_data.corr(method = 'spearman')\n\n\nmask = np.zeros_like(training_corr)\n\"\"\"","b72121cd":"train_data.drop(['Id'], axis = 1, inplace = True)","84dbec96":"train_data.head()","4af191b3":"train_data.columns","8ecc7298":"train_data['Alley']","2b5f5239":"train_data['PoolQC']","1e6395d0":"train_data['MiscFeature']","9eb43b64":"train_data['Fence']","dd24cfc2":"train_data.drop(['Alley', 'PoolQC', 'MiscFeature', 'Fence'], axis = 1, inplace = True)","6ba79aa4":"train_data.head()","1bfc9d02":"test_data.drop(['Id', 'Alley', 'PoolQC', 'MiscFeature', 'Fence'], axis = 1, inplace = True)","63b88102":"test_data.head()","b6e3b071":"## Continuous Variables\n\ncon_var = train_data.dtypes[train_data.dtypes.values != 'object'].index\n\ncon_var","cdc22313":"# Categorical Variables\n\ncat_var = train_data.dtypes[train_data.dtypes.values == 'object'].index\n\ncat_var","1d8a259d":"con_data = train_data.copy()","0051b236":"con_data.drop(cat_var, axis = 1, inplace = True)","a7bddf0d":"mask = np.zeros_like(con_data.corr(method = 'spearman'))\nmask[np.triu_indices_from(mask)] = True\nplt.figure(figsize = (20,20))\nsns.heatmap(con_data.corr(method = \"spearman\"), cmap = \"YlGnBu\", linewidths = 0.5, mask = mask)","7d8e343b":"corrs = con_data.corr('spearman')['SalePrice'].sort_values(ascending = False)\n\ncorrs_abs = corrs.abs()\nprint(corrs_abs.head(11))","8c414103":"print(corrs_abs.tail(10))","8a127669":"# Overall Quality\n\ntrain_data['OverallQual']","f96a07f8":"sns.countplot(train_data['OverallQual'])","ecc11dff":"train_data['GrLivArea']","758c3cb8":"sns.distplot(train_data['GrLivArea'])","8fcae5ce":"train_data['GarageCars']","68909408":"sns.countplot(train_data['GarageCars'])","51ad8796":"train_data['YearBuilt']","444dc247":"sns.distplot(train_data['YearBuilt'])","0e9df9c4":"train_data['GarageArea']","cc866367":"sns.distplot(train_data['GarageArea'])","788a7e36":"train_data['FullBath']","bf9a4077":"sns.countplot(train_data['FullBath'])","2e0d877b":"train_data['TotalBsmtSF']","514f73e2":"sns.histplot(train_data['TotalBsmtSF'])","7450407e":"sns.distplot(train_data['TotalBsmtSF'])","d4e1aebc":"train_data['GarageYrBlt']","01139621":"sns.distplot(train_data['GarageYrBlt'])","bc381352":"sns.distplot(train_data['GarageYrBlt'], color = 'r');\nsns.distplot(train_data['YearBuilt'], color = 'k');\n","7f6c0489":"train_data['1stFlrSF']","0064b001":"sns.regplot(train_data['1stFlrSF'], train_data['SalePrice'])\n","e9c265f8":"train_data['YearRemodAdd']","fc19b96b":"sns.distplot(train_data['YearRemodAdd'])","e57f3c91":"train_data['EnclosedPorch']","a4c66a98":"sns.regplot(train_data['EnclosedPorch'], train_data['SalePrice'])","d42cd418":"train_data['KitchenAbvGr']","204d7c5a":"sns.boxplot(train_data['KitchenAbvGr'], train_data['SalePrice'])","3a3713af":"train_data['OverallCond']","456f5a3e":"sns.boxplot(train_data['OverallCond'], train_data['SalePrice'])","c7d3c2ed":"train_data['LowQualFinSF']","3e100520":"sns.scatterplot(train_data['LowQualFinSF'], train_data['SalePrice'])","d143adf9":"train_data['MiscVal']","8f1a48f6":"sns.regplot(train_data['MiscVal'], train_data['SalePrice'])","8dd249e9":"train_data['BsmtFinSF2']","1550630b":"sns.regplot(train_data['BsmtFinSF2'], train_data['SalePrice'])","cdba6ba4":"train_data['YrSold']","1673d95a":"sns.pointplot(train_data['YrSold'], train_data[\"SalePrice\"])","9583243d":"train_data['BsmtHalfBath']","a70ac085":"sns.countplot(train_data['BsmtHalfBath'])","84eb4957":"train_data['MSSubClass']","1dfc8ab7":"plt.figure(figsize = (20,20))\nsns.boxplot(train_data['MSSubClass'], train_data['SalePrice'])","29b6b8a4":"def load_data():\n    df = pd.concat([df_train, df_test])\n    # preprocessing\n    df = clean(df)\n    df = encode(df)\n    df = impute(df)\n    \n    # reform splits \n    df_train = df.loc[df_train.index, :]\n    df_test = df.loc[df_test.index, :]\n    return df_train, df_test","d2187ede":"def clean(df):\n    pass\n\n\ndef encode(df):\n    # nominal \n    for name in features_nom:\n        \n        \n\ndef impute(df):\n    for name in df.select_dtypes('category'):\n        df[name] = df[name].fillna('None')\n    \n    for name in df.select_dtypes('number'):\n        df[name] = df[name].fillna(0)\n    \n    return df\n        ","dafd5a0d":"def pre_process(train_data, test_data, fillna_dict = {}, drop_list = [], convert_list = [], log_list = [], regroup_dict = {}):\n    \n    \n    ","5f25522e":"fillna_dict = {\n    \"Alley\" : 'NA',\n    \"PoolQC\" : \"NA\",\n    \"LotFrontage\" : train_data['LotFrontage'].mean(),\n    \"MasVnrArea\" : 0.0,\n    \"GarageYrBlt\" : 0.0,\n    \"BsmtFinSF1\" : 0.0,\n    \"BsmtFinSF2\" : 0.0,\n    \"BsmtUnfSF\" : 0.0,\n    \"TotalBsmtSF\" : 0.0,\n    \"BsmtFullBath\" : 0.0,\n    \"BsmtHalfBath\" : 0.0,\n    \"GarageCars\" : 0.0,\n    \"GarageArea\" : 0.0,\n    \"MiscFeature\" : \"NA\",\n    \"Fence\" : \"NA\",\n    \"FireplaceQu\" : \"NA\",\n    'GarageFinish' : \"NA\",\n    \"GarageQual\" : \"NA\",\n    \"GarageCond\" : \"NA\",\n    \"GarageType\" : \"NA\",\n    \"BsmtCond\" : \"NA\",\n    \"BsmtQual\" : \"NA\",\n    \"BsmtExposure\" : \"NA\",\n    \"BsmtFinType1\" : \"NA\",\n    \"BsmtFinType2\" : \"NA\",\n    \"MasVnrType\" : \"None\",\n    \"MSZoning\" : train_data['MSZoning'].mode()[0]\n}","06c23174":"convert_to_str_list = ['MSSubClass']\n\n\nlog_list = ['BsmtUnfSF', 'LotFrontage', 'LotArea','1stFlrSF', 'GrLivArea', 'TotalBsmtSF', 'GarageArea']\n\n\n","d180d950":"seed= 21\n\nkfolds = KFold(n_splits = 10, shuffle = True, random_state = seed)\n\n\n\ndef tune(objective):\n    study = optuna.create_study(direction = 'maximize')\n    study.optimize(objective, n_trails = 100)\n    \n    params = study.best_params\n    best_score = study.best_value\n    print(f\"Best score : {best_score} \\nOptimized parameters: {params}\")\n    return params","63538661":"def ridge_objective(trial):\n    _alpha = trial.suggest_float()\n    \n    ridge = Ridge(alpha = _alpha, random_state = RANDOM_STATE)\n    \n    score = cross_val_score(ridge, X, y, cv = kfolds, scoring = 'neg_root_mean_squared_error').mean()\n    \n    return score\n    ","1e3a4f22":"ridge_params = {'alpha' : 7.4910616}","a7ddeaf4":"def randomforest_objective(trial):\n    _n_estimators = trial.suggest_int(\"n_estimators\", 50, 200)\n    _max_depth = trial.suggest_int(\"max_depth\", 5, 20)\n    _min_samp_split = trial.suggest_int('min_samples_split', 2, 10)\n    _min_samples_leaf = trial.suggest_int(\"min_samples_leaf\", 2, 10)\n    _max_features = trial.suggest_int(\"max_features\", 10, 50)\n    \n    \n    rf = RandomForestRegressor(\n        max_depth = max_depth, \n        min_samples_split = _min_samp_split, \n        min_samples_leaf = min_samples_leaf,\n        max_features= _max_features,\n        n_estimators = _n_estimators,\n        n_jobs = -1,\n        random_state = RANDOM_SEED\n    )\n    \n    \n    score = cross_val_score(rf, X, y, cv = kfolds, scoring = \"neg_root_mean_squared_error\").mean()\n    \n    return score\n\n\nrandomforest_params = tune(randomforest_objective)","63be9b7f":"corrs = \n","4055e6d6":"def cv_rmse(model):\n    rmse = -cross_val_score()","a46b525d":"def compare_models():\n    models = {\n        'Ridge' : ridge,\n        'Lasso' : lasso,\n        \"Elastic Net\" : elasticnet,\n        'Gradient Boosting' : gbr,\n        \"XGBoost\" : xgbr, \n        'LightGBM' : lgbr,\n        \"Stacking\" : stack\n    }\n    \n    \n    scores = pd.DataFrame(columns = ['score', 'model'])\n    \n    for name, model in models.items():\n        score = cv_rmse(model)\n        print(\"\")\n        \n    plt.figure(figsize = (20,10))\n    sns.boxplot(data = scores, x = 'model', y = 'score')\n    plt.show()\n    \ncompare_models()","ab7e6444":"print(\"Predict Submission --> \\n\")\n\nsubmission = pd.read_csv(\"..\/input\/house-prices-advanced-regression-techniques\/sample_submission.csv\")\n\n\nsubmission.iloc[:, 1] = np.expm1(stack.predict(X_test))\n\nsubmission.to_csv('my_submission.csv', index= False)","2e25f208":"# Exploratory Data Analysis + Feature Engineering","3f5652ef":"## Missing Values","1d96517c":"## Notebook in making","c7941846":"Inference: No significant between MiscVal and SalePrice","3c698e51":"Inference: Huge chunk of the values lie in the range of 1000 to 2000.","3879f5f5":"Data Type - Test Data","86883db5":"Inference: A major chunk of the houses have TotalBsmtSF value in the range of 750 to 1250","f10c6839":"Inference: The year sold in particular doesn't have any influence. However, the sudden drop after 2007 can be attributed to the Housing Price Crash after 2008.","4f87b366":"Correlation Heatmap plot","8b6e903b":"## Exploratory Data Analysis","6123e345":"Infernece: We have 2 major peaks and 2 minor peaks. 1st peak indicates 0 Garage Area meaning no garage. The Other major peak is around 500. Two minor peaks around 250 and 750 indicate a small number of houses have a good number of houses in this area range.","bd589170":"Inference: This one is interesting. There are 3 peaks. There was a surge in the year of mid 1925s. Then in the period of 1960s. Again, in the onset of 2000s.","14a7f245":"Model Performance Comparision","3e9f71b7":"## Housing Prices Advanced Regression","75e4fdaf":"Inference: 1stFlrSF is directly proportional to the SalePrice of the house","0d24e1b7":"Inference: We can observe a peak on the onset of early 2000s","8e70f45d":"I. Let's begin with the **highly correlated feature variables**","f2ad1cd3":"Inference: We can see, majority of values for BsmtHalfBath are 0. Obviously, there's no variation in the values of BsmtHalfBath. No impact on the Sale Price.","e4e3ef14":"#### Majority of the values are null. Hence, dropping all the above 4 variables.","65bc5e09":"In the given Dataset, we have \n* train.csv, \n* test.csv \nhaving about 1480 rows each. <br>\n* data_description.txt has the feature descriptions.","d5d1862c":"Confirmed our hypothesis was correct. This also means these are two redundant features. One of them can be dropped. We can drop \"GarageYrBuilt\" and keep \"YearBuilt\".","8288e73a":"## Imports","eea28e36":"Inference: Garages were built in linear proportion with time. However, there was a surge in the era of 1960s. Another such surge hapened in the early 2000s.\n\nThe graph follows the pattern of the House's year of construction. Let's confirm our hypothesis by plotting the same.","5686d3f3":"### Feature Description","9090dc7d":"Inference: No direct relation.","f1e3ee88":"Various regressor models :- \n* Ridge\n* Lasso\n* Elastic Net\n* SVR\n* Random Forest Regressor\n* Gradient Boosting Regressor\n* Stacking Regressor","1fe4a274":"Enclosed Porch, Kitchen AbvGr -> **Least correlated** with Sale Price <br>\nGarage Cars, OverallQual, GrLivArea, FullBath -> **Highly correlated** with Sale Price","49be153f":"Inference: Huge Class Imbalance with a large number of outliers. Mean values might remain same but the distribution of outliers is vivid.","95cb140d":"Top 10 Least Correlated Continuous Features","ba217f51":"Inference: It is quite evident that BsmtFinSF2 doesn't affect the SalePrice","f0ea7a05":"Inference: Majority of the houses are of the medium quality (5,6,7). Extremely few are of poor quality. A significant number of houses are of good quality (8,9,10).","85eb1786":"II. Coming to least correlated feature variables","dafb8a3c":"Inference: There's no direct relation between OverallCond & the SalePrice. Hence, proved","57391bfb":"Inference: The MSSubClass and SalePrice have no direct correlation among them. However, if MSSubClass value is 60, the SalePrice is on the higher end.","7e551bca":"Inference: Majority of the houses have 1 or 2 car capacity in the garage.","8b67e3a9":"## Notebook in making","8d1a649c":"Inference: We can confirm the correlation obtained. EnclosedPorch hardly affects the SalePrice","ad8a328a":"Seperating Variables","85ed195a":"### Preprocessing Steps -> \n\n<br>\n1. Loading <br>\n2. Cleaning <br>\n3. Encode <br>\n4. Impute <br>","12b61e7b":"A good Exploratory Data Analysis helps in smoother and faster conduct of preprocessing steps & better data modelling.","43244653":"## Modelling","f54afa01":"Top 10 Highly Correlated Continuous Features","6173a835":"Features PoolQC, MiscFeature, Alley, Fence have a significant portion of their data as missing values. <br>\nWe'll drop these features from the consideration","9a5a1b97":"Inference: Full Bathrrom are usualy 1 or 2. Few of the houses have 3 bathrooms.","bfd1c7fe":"### Submission"}}