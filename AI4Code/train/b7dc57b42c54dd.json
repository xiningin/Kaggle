{"cell_type":{"3b514a86":"code","3eb6512a":"code","221d97fc":"code","55b01f16":"code","b5ba7c94":"code","9f1d95ba":"code","9e322424":"code","8f120409":"code","60669899":"code","5f133cf2":"code","0d10152f":"code","6524d072":"code","7b483bab":"code","d5a530b4":"markdown","e1ff246b":"markdown","54100b9f":"markdown","ffd3bc36":"markdown","2efe1133":"markdown","c64ecb2a":"markdown","915991f1":"markdown","7e48e907":"markdown","1557c45c":"markdown","54bf2aad":"markdown","1de1e0b8":"markdown","a835ff9e":"markdown","3be32010":"markdown"},"source":{"3b514a86":"from fastai import *\nfrom fastai.vision import *\nfrom fastai.callbacks.hooks import *","3eb6512a":"path = Path('..\/input\/heroes\/heroes\/')\npath.ls()","221d97fc":"data = ImageDataBunch.from_folder(\n    path,\n    train = '.',\n    valid_pct = 0.1,\n    ds_tfms=get_transforms(max_warp=0,flip_vert=True,do_flip=True),\n    size = 128,\n    bs=16\n).normalize(imagenet_stats)\nprint(f'Classes: \\n {data.classes}')\ndata.show_batch(rows=8,figsize=(10,10))","55b01f16":"learn = create_cnn(data,models.resnet50,metrics=accuracy,model_dir='\/tmp\/model\/')\nlearn.lr_find()\nlearn.recorder.plot()","b5ba7c94":"learn.fit_one_cycle(5)","9f1d95ba":"learn.recorder.plot_losses()","9e322424":"learn.save('overwatch-stage-1')","8f120409":"learn.unfreeze()\nlearn.fit_one_cycle(2)","60669899":"learn.lr_find()\nlearn.recorder.plot()","5f133cf2":"learn.fit_one_cycle(10,max_lr=slice(1e-6,1e-4))","0d10152f":"learn.recorder.plot_losses()","6524d072":"inter = ClassificationInterpretation.from_learner(learn)\ninter.plot_top_losses(10,figsize=(20,20))","7b483bab":"inter.plot_confusion_matrix(figsize=(10,10))","d5a530b4":"# Unfreeze the model and train","e1ff246b":"# Save the first stage of the model","54100b9f":"# Plot confusion matrix","ffd3bc36":"# Plot the losses of the training and validation","2efe1133":"# Find the learning rate and plot it","c64ecb2a":"# Train the model","915991f1":"# Create a path to the dataset","7e48e907":"# Create a databunch to feed the data into the model","1557c45c":"# Create the learner","54bf2aad":"# Plot the top losses from the training ","1de1e0b8":"# Import Libraries","a835ff9e":"# Plot the first stage losses of the training and validation","3be32010":"# Train the model"}}