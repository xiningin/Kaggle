{"cell_type":{"a14137b2":"code","853879b1":"code","0ccee812":"code","6fb11331":"code","b0d0ea48":"code","e4919a6c":"code","6c692303":"code","2870898b":"code","10ae6ca2":"code","d209ca0f":"code","1d61bcd6":"code","6a4fd7a1":"code","667bb4f6":"markdown","caf3cbae":"markdown","370d3a1f":"markdown","5c17afcb":"markdown"},"source":{"a14137b2":"! pip install --no-dependencies ludwig[text]\n! pip install petastorm","853879b1":"import pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import metrics\nimport logging\nfrom ludwig.api import LudwigModel","0ccee812":"df = pd.read_csv('..\/input\/imdb-dataset-of-50k-movie-reviews\/IMDB Dataset.csv')","6fb11331":"df_train,df_test = train_test_split (df, test_size=0.15, stratify=df['sentiment'])","b0d0ea48":"df_train['sentiment'].value_counts()","e4919a6c":"df_test['sentiment'].value_counts()","6c692303":"model_definition={'input_features':\n\t[{'name':'review',\n   'type':'text',\n   'level':'word',\n   'encoder': 'distilbert', # encoder and pretrained_model must me compatible\n   'pretrained_model_name_or_path':'distilbert-base-multilingual-cased', # from https:\/\/huggingface.co\/models\n   'trainable': True # if True, perform fine-tuning; otherwise, the pretrained model is used as is\n        }],\n\n 'output_features':[{'name':'sentiment','type':'category'}],\n\n    'training': {\n        'batch_size': 16,\n        'decay': True,\n        'trainable': True,\n        'learning_rate': 0.00001,\n        'epochs': 2,\n        'validation_field': 'sentiment',\n        'validation_metric': 'accuracy'\n    }}","2870898b":"model = LudwigModel(model_definition,logging_level=logging.INFO)","10ae6ca2":"train_stats = model.train(df_train)","d209ca0f":"predicted = model.predict(df_test)","1d61bcd6":"print(metrics.classification_report(df_test.sentiment, predicted[0]['sentiment_predictions']))","6a4fd7a1":"model.save('model')","667bb4f6":"## Create and train Ludwig model","caf3cbae":"## Prepare dataset","370d3a1f":"## Check performance on test data and save model","5c17afcb":"## Install dependencies"}}