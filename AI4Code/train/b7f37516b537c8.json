{"cell_type":{"c7ab6846":"code","bb527adf":"code","b642056f":"code","2fe37407":"code","e2ba3e61":"code","96baeb56":"code","6a354c33":"code","bba8f314":"code","ecd632f3":"code","86f4e87b":"code","7c961cf0":"code","b8fa23b5":"code","51a2a15e":"code","13d3bfc8":"code","8fb65d5f":"code","90a53a23":"markdown","c091873e":"markdown","9b63c211":"markdown","6dae6c6e":"markdown","1fcc93b6":"markdown","a2ff6a72":"markdown","79ee77d6":"markdown","8f4cd1ca":"markdown","8f2c6dc5":"markdown","16e4b81f":"markdown","6a31b953":"markdown","594250ce":"markdown","5662946b":"markdown","e2fee0fe":"markdown","8c8bc327":"markdown","dc82e48d":"markdown","eaf657d5":"markdown","a6b5b863":"markdown","cba3b6e5":"markdown"},"source":{"c7ab6846":"from textblob import TextBlob\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib\nfrom collections import Counter\nsns.set()\n\nwith open('..\/input\/lotr.txt', 'r', errors='ignore') as file:\n    data = file.read().replace('\\n', '')\n\ntext= TextBlob(data)\nmy_list=text.tags","bb527adf":"Eriador = data.count(\"Eriador\")\nArnor = data.count(\"Arnor\")\nRohan = data.count(\"Rohan\")\nGondor = data.count(\"Gondor\")\nMordor = data.count(\"Mordor\")\nRhun = data.count(\"Rhun\")\nrealms_list = [['Gondor', Gondor], ['Mordor', Mordor], ['Rohan', Rohan], ['Arnor', Arnor], ['Eriador', Eriador]]\ndf_realms=pd.DataFrame(realms_list, columns=['Realm', 'Times mentioned'])\ncolors = [\"crimson\", \"forrest green\", \"true blue\", \"amber\", \"black\"]\nsns.set_style(\"darkgrid\")\nplt.figure(figsize=(10, 5))\nwith sns.xkcd_palette(colors):\n    sns.barplot(x=\"Realm\", y=\"Times mentioned\", saturation=0.9, data=df_realms).set_title(\"Lord of the Rings - number of times realms being mentioned\")","b642056f":"Orc = data.count(\"Orc\")+data.count(\"Orcs\")+data.count(\"orc\")+data.count(\"orcs\")+data.count(\"orcish\")\nHuman = data.count(\"Man\")+data.count(\"Mankind\")+data.count(\"Men\")+data.count(\"men\")+data.count(\"human\")\nElf = data.count(\"Elf\")+data.count(\"Elves\")+data.count(\"elf\")+data.count(\"elves\")+data.count(\"elven\")\nDwarf = data.count(\"Dwarf\")+data.count(\"Dwarves\")+data.count(\"dwarf\")+data.count(\"dwarves\")+data.count(\"dwarven\")\nHalfling = data.count(\"Halfling\")+data.count(\"Hobbit\")+data.count(\"Hobbits\")+data.count(\"Halflings\")+data.count(\"halfling\")+data.count(\"hobbit\")+data.count(\"hobbits\")+data.count(\"halflings\")\nEnt = data.count(\"Ents\")+data.count(\"Ent\")\nTroll = data.count(\"Troll\")+data.count(\"troll\")+data.count(\"Trolls\")+data.count(\"trolls\")\nDragon = data.count(\"dragon\")+data.count(\"dragons\")+data.count(\"Dragon\")+data.count(\"Dragons\")\nBalrog = data.count(\"Balrog\")+data.count(\"Balrogs\")+data.count(\"balrog\")+data.count(\"balrogs\")\nGoblin = data.count(\"Goblin\")+data.count(\"Goblins\")+data.count(\"goblin\")+data.count(\"goblins\")\nWarg = data.count(\"Warg\")+data.count(\"Wargs\")+data.count(\"warg\")+data.count(\"wargs\")\nHuorn = data.count(\"Huorn\")+data.count(\"Huorns\")+data.count(\"huorn\")+data.count(\"huorns\")\nBeorning = data.count(\"Beorning\")+data.count(\"Beornings\")+data.count(\"beorning\")+data.count(\"beornings\")+data.count(\"Skin-changers\")+data.count(\"Skin-changer\")+data.count(\"skin-changer\")+data.count(\"skin-changers\")\nraces_list = [['Men', Human], ['Hobbits\/Halflings', Halfling], ['Elves', Elf], ['Orcs', Orc], ['Dwarves', Dwarf],  ['Goblins', Goblin], ['Ents', Ent], [\"Dragons\", Dragon], ['Trolls', Troll], [\"Wargs\", Warg], ['Huorns', Huorn], [\"Balrogs\", Balrog], [\"Beornings\", Beorning]]\ndf_races=pd.DataFrame(races_list, columns=['Race', 'Times mentioned'])\ncolors = [\"amber\", \"brown\", \"dark sea green\", \"forrest green\", \"crimson\", \"black\",  \"brown\", \"true blue\", \"black\", \"forrest green\", \"brown\", \"crimson\", \"blue\"]\nsns.set_style(\"darkgrid\")\nplt.figure(figsize=(15, 7))\nwith sns.xkcd_palette(colors):\n    sns.barplot(x=\"Race\", y=\"Times mentioned\", saturation=0.9, data=df_races).set_title(\"Lord of the Rings - number of times races being mentioned\")","2fe37407":"full_t = pd.DataFrame(my_list)\nfull_t.columns = ['Words', \"Word type\"]\nxft=full_t.groupby('Word type').count().reset_index()\ntop20ft=xft.nlargest(20, 'Words')\n\nsns.set_style(\"darkgrid\")\nplt.figure(figsize=(10, 5))\nsns.barplot(x=\"Words\", y=\"Word type\", palette=\"rocket\", saturation=0.9, data=top20ft).set_title(\"Lord of the Rings - top 20 word types used\")","e2ba3e61":"def word_analysis(word_type):\n    filtered = [row for row in my_list if str(word_type) in row[1]]\n    print(\"filtered for \" + word_type)\n    df = pd.DataFrame(filtered)\n    df.columns = [\"Word\", \"Occurences\"]\n    x=df.groupby('Word').count().reset_index()\n    y=x.sort_values(by=['Occurences'], ascending=False)\n    top10=y.nlargest(10, 'Occurences')\n    plt.figure(figsize=(10, 5))\n    sns.barplot(x=\"Word\", y=\"Occurences\", palette=\"rocket\", saturation=0.9, data=top10).set_title(\"Lord of the rings - most frequently used \"+ word_type +\" type word\")","96baeb56":"word_type = 'NN'\nword_analysis(word_type)","6a354c33":"word_type = 'NNP'\nword_analysis(word_type)","bba8f314":"word_type = 'JJ'\nword_analysis(word_type)","ecd632f3":"word_type = 'VB'\nword_analysis(word_type)","86f4e87b":"sentiment=[]\nx=0\n\nfor sentence in text:\n    text.sentiment\n\nfor sentence in text.sentences:\n    sentiment.append(sentence.sentiment)\n    \nsentence_df = pd.DataFrame(sentiment)\nsentence_df.describe()","7c961cf0":"sentence_df['order'] = sentence_df.index\nsentence_df = pd.DataFrame(sentiment)\nsentence_df['order'] = sentence_df.index\npolarity = pd.Series(sentence_df[\"polarity\"])\nplt.figure(figsize=(10, 10))\nsns.jointplot(\"order\", \"polarity\", data=sentence_df, kind=\"kde\")","b8fa23b5":"plt.figure(figsize=(15, 5))\nsns.jointplot(\"order\", \"polarity\", data=sentence_df[sentence_df.polarity != 0], kind=\"kde\")","51a2a15e":"subjectivity = pd.Series(sentence_df[\"subjectivity\"])\nplt.figure(figsize=(10, 10))\nsns.jointplot(\"order\", \"subjectivity\", data=sentence_df, kind=\"kde\")","13d3bfc8":"sns.jointplot(\"order\", \"subjectivity\", data=sentence_df[sentence_df.subjectivity != 0], kind=\"kde\")","8fb65d5f":"plt.figure(figsize=(10, 10))\nsns.jointplot(\"polarity\", \"subjectivity\", data=sentence_df[(sentence_df.subjectivity != 0)], kind=\"kde\")","90a53a23":"Okay, lets start with heavylifting: sentiment analysis.","c091873e":"Lets take a look at the polarity\/subjectivity jointplot to analyse the corelation between polarity and subjectivity of the sentences:","9b63c211":"As we can see on the jointplot - the most of sentences has been classied as neutral. Jointplot shows small clusters at ranges of -0.25 to +0.5 troughtout the book. Lets remove the neutral values to perform deeper analysis of non-neutral sentences.","6dae6c6e":"Above we may see a brief stats of book done with use of Pandas pandas.DataFrame.describe() function. I will swiftly point out most important elements of it below.\n\nBook contains 41'167 sentences in total(in comparison, Harry Potter and Philosophers' stone contains 6396 sentences). All senteces has been marked with polarity score ranging from -1.0 to +1.0 and subjectivity score ranging from 0.0 to 1.0. Polarity score mean of +0.036 (to compare Harry Potter part 1. has a score +0.027) is considered a rather neutral. Subjectivity score mean of +0.285 is slightly subjective (close to Harry Potter p.1).","1fcc93b6":"As We may observe: throughout the book there is a sgnificant amount of 0.4 and 0.5 subjectivity sentences.","a2ff6a72":"I came up with an idea to compare how often each race has been mentioned:","79ee77d6":"As in Harry Potter's part.1 analysis we may observe that downwards facing triangle shape. It means that the more subjective the sentence is the more polarized it may be: we can deduct it from the shape of kde.","8f4cd1ca":"Below you may find top10 verbs:","8f2c6dc5":"Hey, if you are reading this please let me know what are your ideas to go further into the analysis and what is your feedback :)","16e4b81f":"As visible above Elves has been mentioned a lot more often than Dwarves. Hobbit's are on the high second position (let me know if I have missed any race)","6a31b953":"Lets find most commonly used nouns:","594250ce":"Firstly I need to mention that above jointplot shows a really small part of total sentences we should assume Tolkien's style is heavily based on neutral polarity sentences. I can see that sentences polarity very rarely goes down below -0.5. Worth mentioning is a significant amount of sligtly positive  sentences around sentences 3000-4000. ","5662946b":"As present on jointplot the subjectivity score of 0.0 is clearly dominating. Lets have a closer look to a jointplot without a 0.0 values:","e2fee0fe":"It's worth to see adjective analysis as well:","8c8bc327":"This brief part will take you through analysis of most often used words.Let's start with checking the top20 most word types and present them on a barplot:","dc82e48d":"Below I declare a function that will be used to create a top10 most used words of selected type:","eaf657d5":"Okay, lets check it for Proper nouns only (nouns starting with a capital letter):","a6b5b863":"This Kernel is an analysis of JJR Tolkien's 'Lord of the rings' (all 6 books) with use of Natural Language Processing library TextBlob.\nIt will answer how much every realm and race has been mentioned and what is the writing style of the author by analysis of most often used words and sentiment analysis of all sentences in a book.\nAs a source data I use .txt of the book.","cba3b6e5":"At the beggining let's compare how much each realm was mentioned:"}}