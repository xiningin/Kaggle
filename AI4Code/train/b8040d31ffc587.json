{"cell_type":{"56c9c839":"code","b38c7d35":"code","541ab37d":"code","cc7e125f":"code","f1e66a61":"code","86d6de20":"code","b6c3bed8":"code","f5730501":"code","10a77ae7":"code","f09674b6":"code","0a71c57f":"code","6166c17e":"code","95656fb4":"code","106c3506":"code","7ce6e324":"code","d40671bf":"code","5f558619":"code","fa92d034":"code","e8298ce4":"code","c8cab291":"code","a1cb50cf":"code","b1f448dc":"code","aa73ce84":"code","97062334":"code","e6f78614":"markdown","37cd8883":"markdown","de9f5d62":"markdown","a017913c":"markdown","49e25db0":"markdown","26db558c":"markdown","e169e9ba":"markdown","a220da78":"markdown","c637e48b":"markdown","3c1aae2a":"markdown","af597a0f":"markdown","48380203":"markdown","3193e02f":"markdown","8dfa35e9":"markdown"},"source":{"56c9c839":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport tensorflow as tf\nimport warnings\nwarnings.filterwarnings('ignore')\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report,confusion_matrix,accuracy_score,f1_score\nfrom sklearn.preprocessing import LabelEncoder,OneHotEncoder","b38c7d35":"df=pd.read_csv('..\/input\/west-australia-weather-1944-2016\/aus_weather.csv')","541ab37d":"df.head(10)","cc7e125f":"df.info()","f1e66a61":"df=df.drop('uv_MJ_m*m',axis=1)","86d6de20":"df=df.dropna()","b6c3bed8":"df.columns","f5730501":"df.Season.value_counts()","10a77ae7":"plt.figure(figsize=(8,6))\nsns.countplot(df.Season.values)\nplt.show()","f09674b6":"training_features=['Year', 'Month', 'Day', 'rainfall_mm', 'min_temp_C', 'max_temp_C',\n       'daily_avg', 'daily_range']\ntarget=['Season']","0a71c57f":"X_train, X_test, Y_train, Y_test= train_test_split(df[training_features],df[target],test_size=0.20,\n                                                  random_state=100)","6166c17e":"X_train.shape","95656fb4":"# Y_train\n\nlabel_encoder = LabelEncoder()\ninteger_encoded = label_encoder.fit_transform(Y_train)\n\nonehot_encoder = OneHotEncoder(sparse=False)\ninteger_encoded = integer_encoded.reshape(len(integer_encoded), 1)\nY_train = onehot_encoder.fit_transform(integer_encoded)\n\n#Y_test\nlabel_encoder = LabelEncoder()\ninteger_encoded = label_encoder.fit_transform(Y_test)\n\n\nonehot_encoder = OneHotEncoder(sparse=False)\ninteger_encoded = integer_encoded.reshape(len(integer_encoded), 1)\nY_test = onehot_encoder.fit_transform(integer_encoded)\n","106c3506":"Y_train.shape","7ce6e324":"model=tf.keras.Sequential()\nmodel.add(tf.keras.layers.Input((8,)))\nmodel.add(tf.keras.layers.Dense(256,activation='relu'))\nmodel.add(tf.keras.layers.Dense(256,activation='relu'))\nmodel.add(tf.keras.layers.Dense(4,activation='softmax'))","d40671bf":"model.summary()","5f558619":"model.compile(optimizer='adam',loss='categorical_crossentropy',metrics=['acc'])","fa92d034":"model.fit(X_train,Y_train, batch_size=64,epochs=60, validation_data=(X_test,Y_test))","e8298ce4":"model.evaluate(X_train,Y_train)","c8cab291":"model.evaluate(X_test,Y_test)","a1cb50cf":"Y_pred=model.predict(X_test)","b1f448dc":"Y_pred=np.argmax(Y_pred,axis=1)\nY_test=np.argmax(Y_test,axis=1)","aa73ce84":"plt.figure(figsize=(10,8))\nsns.heatmap(confusion_matrix(Y_test,Y_pred),annot=True,fmt='d',cmap='Blues')\nplt.show()","97062334":"print(classification_report(Y_test,Y_pred))\n","e6f78614":"# 1. Import libraries","37cd8883":"# 6. Predict on test set and metrics","de9f5d62":"## After this if we have some other null values this step will remove those rows from the table","a017913c":"# 4. Build ANN model","49e25db0":"## Splitting the data into train-test pairs(80:20)","26db558c":"## Visualizing target value(Season) count","e169e9ba":"# 3. Pre Processing","a220da78":"## Selecting features","c637e48b":"## We can see that classes are balanced almost equally","3c1aae2a":"## Since one column has too many null values, we will drop that column","af597a0f":"# Upvote if you found this useful.","48380203":"## Onehot Encode target variables\n","3193e02f":"# 2. Load csv file","8dfa35e9":"# 5. Train the model "}}