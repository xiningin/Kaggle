{"cell_type":{"9cfbcc74":"code","19571a89":"code","894655f9":"code","bd36a9b8":"code","5dc567a8":"code","03c8dd93":"code","2070d8d6":"markdown","ad5243d0":"markdown","fcb8e5f5":"markdown","128f1139":"markdown","b49cd9c4":"markdown","da29b385":"markdown"},"source":{"9cfbcc74":"# import modules\nimport numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(style='ticks', palette='muted')","19571a89":"# read data \ndf = pd.read_csv(\"..\/input\/IPCC_emissions.csv\", sep=\";\")\nkeys = pd.read_csv(\"..\/input\/IPCC_key_description.csv\", sep=\";\")\n\n# Weghalen van overbodige kolommen in key description \nkeys_clean = keys.drop(['Description', 'L1.1','L2.1', 'L3.1', 'L4.1'], axis=1)\n\n# Weghalen van spaties \nkeys_clean['Key'] = keys_clean['Key'].str.strip()\ndf['Bronnen'] = df['Bronnen'].str.strip()\n\n# Samenvoegen van de dataset en de metadata\ndf = df.rename(columns={'Bronnen': 'Key'})\ndf = df.merge(keys_clean, on='Key')\n\n# Hierachy niveau toevoegen\ndf['Hierarchy key'] = df['Hierarchy key'].apply(str)\ndf['Level'] = df['Hierarchy key'].apply(len)\ndf.tail()\n\n# Hernoemen uitstoot kolomnamen \ndf = df.rename(columns={'CO2_1': 'CO2', 'CH4_2': 'CH4', 'N2O_3': 'N2O'})\n\n# Toevoegen van CO2 equivalente uitstoot voor 20 jaar horizon en 100 jaar\nGPW = pd.DataFrame(data=[[1, 86, 268], [1, 36, 298]], \n                   columns=['CO2', 'CH4', 'N2O'], \n                   index=['20yr', '100yr'])\nfor index, row in GPW.iterrows():\n    df['Emissie_' + index] = df['CO2'] * row['CO2'] + df['CH4'] * row['CH4'] + df['N2O'] * row['N2O']\n    df['CH4_' + index] = df['CH4'] * row['CH4'] \n    df['N2O_' + index] = df['N2O'] * row['N2O']\n\n# Jaren weergeven als datetime format, voor makkelijker plotten\ndf['Jaar'] = df['Perioden'].str[:4]\ndf['Jaar'] = pd.to_datetime(df['Jaar'])\ndf.set_index('Jaar', inplace=True)\n\n# Voeg level 4 toe voor particulier huishouden\ndf.loc[df['L3'] == 'Particulier huishouden', 'L4'] = 'Particulier huishouden'\ndf.loc[df['L3'] == 'Particulier huishouden', 'Level'] = 4\n\n# Alles behalve L4 wegdoen, zodat uitstoot nergens dubbel staat\ndf = df.loc[df['Level'] == 4]\n\n# Namen opschonen\nold = df['L3'].unique()[3]\nnew = old[8:]\ndf = df.replace(old, new)\nold = df['L4'].unique()[[0,1,2,3,4,6,8]]\nnew = [old[0][3:], old[1][4:], old[2][3:], old[3][6:], old[4][3:], old[5][2:], old[6][3:]]\ndf = df.replace(old, new)\n\n# Alternatieve level 4 classificatie toevoegen, met 'overig' categorie \nemission_2017 = df.loc['2017'].sort_values(by='Emissie_20yr', ascending=False)[['L4', 'Emissie_20yr']]\ndf['L4_clean'] = df['L4'].replace(emission_2017['L4'][7:].values, 'Overig')\n\n# Wegdoen van kolommen die niet meer relevant zijn \ndf = df.drop(['Perioden', 'ID', 'Hierarchy key', 'Level'], axis=1)\n\n# Opgeschoonde dataset opslaan \ndf.to_csv('Emission_Netherlands_clean.csv', sep=';')","894655f9":"# Totale itstoot per broeikasgas 2016\ntot = df['2016'].sum()\nd = np.array([[tot['CO2'], tot['CO2']], \n              [tot['CH4_20yr'], tot['CH4_100yr']], \n              [tot['N2O_20yr'], tot['N2O_100yr']]])\nd = pd.DataFrame(data=d,\n                 index=['CO2', 'CH4', 'N2O'],\n                 columns=['20 jaar', '100 jaar'])\n\n# Relatieve uitstoot per broeikasgas 2016\n_ = d.div(d.sum()).T.plot(kind='bar', stacked=True)","bd36a9b8":"# Pivot tabellen maken\nL2 = pd.pivot_table(data=df, \n                    values='Emissie_20yr', \n                    index='Jaar', \n                    columns='L2', \n                    aggfunc='sum')\nL3 = pd.pivot_table(data=df, \n                    values='Emissie_20yr', \n                    index='Jaar', \n                    columns='L3', \n                    aggfunc='sum')\nL4 = pd.pivot_table(data=df, \n                    values='Emissie_20yr', \n                    index='Jaar', \n                    columns='L4', \n                    aggfunc='sum')\n\n# Plot\nfig, axs = plt.subplots(1,2, figsize=(20, 10))\n_ = L3.plot.area(ax=axs[0])\n_ = L4.plot.area(ax=axs[1])","5dc567a8":"# Plot uitstoot in 2016; per categorie, voor 20 jaar en 100 jaar GPW horizon\nfig_2016, axs = plt.subplots(2, 1, figsize=(5, 10))\nkwargs = dict(autopct='%.2f', fontsize=10, kind='pie')\n_ = df.loc['2016'].groupby(['L4_clean'])['Emissie_20yr'].sum().plot(ax=axs[0], **kwargs)\n_ = df.loc['2016'].groupby(['L4_clean'])['Emissie_100yr'].sum().plot(ax=axs[1], **kwargs)\n_ = axs[0].set_ylabel('')\n_ = axs[1].set_ylabel('')\n_ = axs[0].set_title('Emissie 2016\\n' \n                     + 'GPW 20 jaar (CO2: 1, CH4: 34, N2O: 298)')\n_ = axs[1].set_title('Emissie 2016\\n'\n                     + 'GPW 100 jaar (CO2: 1, CH4: 86, N2O: 268')\n\n","03c8dd93":"# Plot CO2 equivalente uitstoot; per categorie en cumulatief\nfig_overtime, axs = plt.subplots(2,2, figsize=(20, 20))\nkwargs = dict(fontsize=10)\nL4 = df.groupby(['Jaar','L4_clean']).agg({'Emissie_20yr':'sum', 'Emissie_100yr':'sum'}).unstack()\n_ = L4['Emissie_20yr'].plot(ax=axs[0, 0], legend=False, **kwargs)\n_ = L4['Emissie_100yr'].plot(ax=axs[0, 1], **kwargs)\n_ = L4['Emissie_20yr'].plot.area(ax=axs[1, 0], legend=False, **kwargs)\n_ = L4['Emissie_100yr'].plot.area(ax=axs[1, 1], **kwargs)\n\n# Zet limieten, titels, en weergave van de assen\nfor i in range(2):\n    _ = axs[0, i].set_ylim(top=1e5)\n    _ = axs[1, i].set_ylim(top=4e5) \n    _ = axs[i, 0].set_title('CO2-equivalente uitstoot [mln kg]\\n'\n                            + 'GPW 20 jaar (CO2: 1, CH4: 86, N2O: 268)')\n    _ = axs[i, 1].set_title('CO2-equivalente uitstoot [mln kg]\\n' \n                            + 'GPW 100 jaar (CO2: 1, CH4: 34, N2O: 298)')\n    for j in range(2):\n        axs[i, j].set_yticklabels(['{:,}'.format(int(x)) for x in axs[i, j].get_yticks().tolist()])","2070d8d6":"# Broeikasgasuitstoot in Nederland \n\n## Introductie\nIn mijn zoektocht naar meer langetermijn, en fact-based journalistiek betreffende het klimaatprobleem, heb ik de uitstoot van broeikasgassen in Nederland geanalyseerd. \n\n\n## Bronnen\nDit notebook bevat een analyse van de data van het Centraal Bureau voor Statistiek (CBS) betreffende uitstoot van broeikasgassen, gerapporteerd volgens IPCC richtlijne, per jaar, sinds 1990. \n\nDeze data heb ik wat bewerkt om makkelijker inzichten eruit te kunnen halen. Zo heb ik de relatieve kleine bijdragers aan het broeikaseffect samengevoegd tot een de categorie 'overig', en heb ik de data gestructureerd zodat uitstoot niet dubbel gerapporteerd wordt in de dataset. \n\n## Global warming potential\nDe data bevat de uitstoot van de drie belangrijkste broeikasgassen - CO2, CH4 en NO2. Voor het bepalen van de totale CO2-equivalente uitstoot heb ik global warming potential (GPW) waarden gebruikt volgens de laatste richtlijnen van het IPCC (zie wikipedia, GPW). Deze waarden zijn een maatstaf voor de relatieve bijdrage van een gas aan het broeikas effect - zo is methaan een potenter broeikasgas dan CO2. \n\n## Belangrijkste inzichten \nDe belangrijkste inzichten zijn onder andere de relatieve bijdrage van alle sectoren, en de trends hierin. Zo zien we bijvoorbeeld dat: \n\n- ...landbouw een vergelijkbare bijdrage levert als de opwekking van electrictiteit;\n- ...afvalverwerking en watervoorziening de belangrijkste bijdrage heeft geleverd aan de reductie over de afgelopen 30 jaar;\n- ...en dat de uitstoot van de meeste andere activiteiten gelijk is gebleven, of gestegen. \n\n## Taal en packages \nIk heb Python gebruikt voor deze analyse, en de volgende packages: \n\n- Pandas - een package voor efficiente verwerking van grote datasets. \n- Seaborn - een package voor het maken van mooiere plots\n- Numpy - een efficiente data structuur voor lineare algebra","ad5243d0":"## Data verwerking \nDe data is afkomstig van het CBS. Hieronder doe ik een aantal dingen om deze data leesbaarder te maken, en makkelijker te verwerken met pandas. ","fcb8e5f5":"## Uitstoot op classificatie niveau 3 en 4 \nDe data van het CBS kent labels toe aan uitstoot, op verschillende niveaus. De meest interessante zijn niveau 3 en 4. Een voorbeeld van een niveau 3 categorie is 'vervoer'. Een voorbeeld van een niveau 4 categorie, die onder de niveau 3 categorie ' vervoer' valt, is 'wegverkeer'. \n\nHieronder is de uitstoot van Nederland sinds 1990 geplot, uitgaande van een GPW horizon van 20 jaar, voor zowel niveau 3 als 4. We zien dat niveau 4 ons de meest relevantie inzichten geeft, al is het wel een goed idee om alle kleinere niveau 4 categorien samen te voegen tot overig (wat we boven al gedaan hebben). \n","128f1139":"## Uitstoot van de verschillende broeikasgassen \nIn de data wordt uitstoot van methaan (CO2), methaan (CH4) en distikstofoxide (N2O) gerapporteerd. Om te kijken wat de relatieve bijdrage hiervaan is aan het broeikaseffect, moeten we deze waarden corrigeren voor hun global warming potential (GPW). Hieronder staat in tabelvorm de relatieve bijdragen aan het broeikas effect van de verschillende gassen, voor de twee GPW horizons (20 jaar en 100 jaar). \n\nWe zien dat de bijdrage van methaan zeer significant is, met name voor de komende 20 jaar. ","b49cd9c4":"## Uitstoot 2016 voor niveau 4 categorieen en verschillende GPW horizon \nNu we weten dat niveau 4 de beste inzichten verschaft, is het  interessant om de uitstoot te bekijken in 2016, voor de verschillende categorieen, en de verschillende GPW horizonnen.\n\nWe zien dat de keuze van de horizon veel impact heeft op de relatieve bijdragen van landbouw en watervoorziening, wat aangeeft dat hier voorval veel methaan (CH4) en distikstofoxide (N2O) bij vrijkomt. \n\nOok is het interessant om te zien dat landbouw zo'n grote bijdrage levert, vergelijkbaar met elektriciteitsproductie. ","da29b385":"## Uitstoot over tijd \nEn volgende stap is om bovenstaande doorsnijdingen niet alleen voor 2016 te laten zien, maar over tijd, om ze de ontwikkelingen hiervan te kunnen zien, zowel cumulatief als voor elke sector afzonderlijk. \n\nEen van de meest opvallende inzichten hier is de sterke afname van uitstoot in afvalverwerking en watervoorziening. "}}