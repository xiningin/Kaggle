{"cell_type":{"ffa8ec68":"code","d87a933c":"code","2fee7aff":"code","97519dba":"code","d47fc25b":"code","94138a78":"code","0f47d955":"code","d889a806":"code","bf6ced68":"code","362bcfb3":"code","71589829":"code","45c7a9b7":"code","45aecb91":"code","14f49d1a":"code","0e6d6a8e":"code","7a3f2e13":"code","1d648b4c":"code","9ed867ac":"code","1e3d50f3":"code","74ee4bd0":"code","96975b91":"code","ab537f3b":"code","c1297983":"code","826f877c":"code","5e963ef2":"code","49feb734":"code","84ba01bb":"code","9f09ec50":"code","47b8401f":"code","635223ce":"code","8016f871":"code","3526003b":"code","75a042fd":"code","0dbd24ae":"code","25b14f68":"code","c63626f2":"code","9fe4681b":"code","5d681db3":"code","ecf37f23":"code","3e3e24d6":"code","f9ca1a5e":"markdown","b2f3c774":"markdown","e3b110f1":"markdown","7b62dd11":"markdown","aeebfbeb":"markdown","f6b1760f":"markdown","744cc9b9":"markdown","8a535108":"markdown","50849b3d":"markdown","5a0602df":"markdown","2e01c618":"markdown","28f63b0d":"markdown","d59de077":"markdown","1343f79b":"markdown","ebaf01e2":"markdown","b1bb2019":"markdown","4609d498":"markdown","87a5c83a":"markdown","8b788cb6":"markdown","8c157283":"markdown","f17c2c5d":"markdown","d7d71b0e":"markdown","a27f7787":"markdown","84882719":"markdown","302bdbe1":"markdown","bacccf7c":"markdown","40277482":"markdown","3ab46ae2":"markdown","11a6ce65":"markdown","5d4dc7ab":"markdown","3ee5d144":"markdown","14716ccb":"markdown","9cc2ce47":"markdown","1d21630c":"markdown","9a12c81f":"markdown","e5f65acc":"markdown","2457de16":"markdown","3d91af56":"markdown","78eb60ca":"markdown","ad0007e0":"markdown","2477f4f0":"markdown","65547e6e":"markdown","562a3606":"markdown","3295a61e":"markdown","2723a467":"markdown","f9c06728":"markdown","9f22fcf0":"markdown","c662899c":"markdown","30113244":"markdown","e46127b6":"markdown","4ad1708e":"markdown","5d4fc26f":"markdown","e8e91141":"markdown","39bb53cb":"markdown","6bb02cce":"markdown","afcd2bb1":"markdown"},"source":{"ffa8ec68":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nfrom pylab import rcParams\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import r2_score","d87a933c":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\ndf = pd.read_csv(\"..\/input\/fish-market\/Fish.csv\")\ndf.head()","2fee7aff":"df.shape","97519dba":"df['Species'].nunique()","d47fc25b":"df['Species'].value_counts()","94138a78":"df.info()","0f47d955":"df.isnull().sum()","d889a806":"df.describe()","bf6ced68":"rcParams['figure.figsize'] = 8,6\n\nsns.countplot(df['Species'])\nplt.xlabel('Species', size=14)\nplt.ylabel('Count', size=14)\nplt.xticks(rotation=30, size=12)\nplt.yticks(size=12)\n\nax = plt.gca()\nax.spines['top'].set_visible(False)\nax.spines['right'].set_visible(False)\n\nplt.show()","362bcfb3":"sns.boxplot(df['Length1'], df['Species'])\n\nplt.xticks(size=12)\nplt.yticks(size=12)\nplt.xlabel('Length1', size=14)\nplt.ylabel('Species', size=14)\n\nplt.show()","71589829":"sns.boxplot(df['Length1'])\nplt.xticks(size=12)\nplt.xlabel('Length1 - Vertical Length (cm)', size=14)\n\nplt.show()","45c7a9b7":"df_L1 = df['Length1']\n\n#quartiles\ndf_L1_q1 = df_L1.quantile(0.25)\ndf_L1_q2 = df_L1.quantile(0.5)\ndf_L1_q3 = df_L1.quantile(0.75)\n\n#inter quartile range\ndf_L1_iqr = df_L1_q3 - df_L1_q1\n\n#lower whisker point\ndf_L1_lower = df_L1_q1 - (1.5 * df_L1_iqr)\n\n#upper whisker point\ndf_L1_upper = df_L1_q3 + (1.5 * df_L1_iqr)\n\ndf_L1_outliers = df_L1[(df_L1 < df_L1_lower) | (df_L1 > df_L1_upper)]\ndf_L1_outliers","45aecb91":"sns.boxplot(df['Length2'])\nplt.xticks(size=12)\nplt.xlabel('Length2 - Diagonal Length (cm)', size=14)\n\nplt.show()","14f49d1a":"df_L2 = df['Length2']\n\n#quartiles\ndf_L2_q1 = df_L2.quantile(0.25)\ndf_L2_q2 = df_L2.quantile(0.5)\ndf_L2_q3 = df_L2.quantile(0.75)\n\n#inter quartile range\ndf_L2_iqr = df_L2_q3 - df_L2_q1\n\n#lower whisker point\ndf_L2_lower = df_L2_q1 - (1.5 * df_L2_iqr)\n\n#upper whisker point\ndf_L2_upper = df_L2_q3 + (1.5 * df_L2_iqr)\n\ndf_L2_outliers = df_L2[(df_L2 < df_L2_lower) | (df_L2 > df_L2_upper)]\ndf_L2_outliers","0e6d6a8e":"sns.boxplot(df['Length3'])\nplt.xticks(size=12)\nplt.xlabel('Length3 - Cross Length (cm)', size=14)\n\nplt.show()","7a3f2e13":"df_L3 = df['Length3']\n\n#quartiles\ndf_L3_q1 = df_L3.quantile(0.25)\ndf_L3_q2 = df_L3.quantile(0.5)\ndf_L3_q3 = df_L3.quantile(0.75)\n\n#inter quartile range\ndf_L3_iqr = df_L3_q3 - df_L3_q1\n\n#lower whisker point\ndf_L3_lower = df_L3_q1 - (1.5 * df_L3_iqr)\n\n#upper whisker point\ndf_L3_upper = df_L3_q3 + (1.5 * df_L3_iqr)\n\ndf_L3_outliers = df_L3[(df_L3 < df_L3_lower) | (df_L3 > df_L3_upper)]\ndf_L3_outliers","1d648b4c":"sns.boxplot(df['Width'])\nplt.xticks(size=12)\nplt.xlabel('Width (cm)', size=14)\n\nplt.show()","9ed867ac":"sns.boxplot(df['Height'])\nplt.xticks(size=12)\nplt.xlabel('Height (cm)', size=14)\n\nplt.show()","1e3d50f3":"sns.boxplot(df['Weight'])\nplt.xticks(size=12)\nplt.xlabel('Weight (g)', size=14)\n\nplt.show()","74ee4bd0":"df_W = df['Weight']\n\n#quartiles\ndf_W_q1 = df_W.quantile(0.25)\ndf_W_q2 = df_W.quantile(0.5)\ndf_W_q3 = df_W.quantile(0.75)\n\n#inter quartile range\ndf_W_iqr = df_W_q3 - df_W_q1\n\n#lower whisker point\ndf_W_lower = df_W_q1 - (1.5 * df_W_iqr)\n\n#upper whisker point\ndf_W_upper = df_W_q3 + (1.5 * df_W_iqr)\n\ndf_W_outliers = df_W[(df_W < df_W_lower) | (df_W > df_W_upper)]\ndf_W_outliers","96975b91":"df[142:145]","ab537f3b":"df.drop([142, 143, 144], inplace=True)","c1297983":"df.shape","826f877c":"df.corr()","5e963ef2":"sns.heatmap(df.corr(), annot=True)\n\nplt.show()","49feb734":"sns.pairplot(df, hue='Species')\nplt.show()","84ba01bb":"df.drop(['Length2', 'Length3'], axis=1, inplace=True)","9f09ec50":"df.head()","47b8401f":"df.shape","635223ce":"#all variables except Weight and Species\nX = df.iloc[:,2:]\n\n#Weight variable only\ny = df['Weight']","8016f871":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=101)","3526003b":"print(\"Shape of X_train: \", X_train.shape)\nprint(\"Shape of y_train: \", X_test.shape)\nprint(\"Shape of X_test: \", y_train.shape)\nprint(\"Shape of y_test: \", y_test.shape)","75a042fd":"lm = LinearRegression()\nlm.fit(X_train, y_train)","0dbd24ae":"print(\"Intercept of the model: \", lm.intercept_)\nprint(\"Coefficient of the model: \", lm.coef_)","25b14f68":"print(\"Y = \", lm.intercept_, \"+\", lm.coef_[0], \"*\", df.columns[2], \"+\", lm.coef_[1], \"*\", df.columns[3], \"+\", lm.coef_[2], \"*\", df.columns[4])\n","c63626f2":"y_pred = lm.predict(X_test)","9fe4681b":"df_y_test = pd.DataFrame(y_test)\ndf_y_test1 = df_y_test.reset_index(drop=True)\ndf_y_test1.head()","5d681db3":"df_y_pred = pd.DataFrame(y_pred, columns=[\"Predicted weight\"])\ndf_y_pred.head()","ecf37f23":"df_y = pd.concat([df_y_test1, df_y_pred], axis=1)\ndf_y.head()","3e3e24d6":"print(r2_score(y_test, y_pred))","f9ca1a5e":"### Pairplot","b2f3c774":"#### Analyzing outliers for Length2","e3b110f1":"The observations 142, 143 and 144 are outliers in case of Length1.","7b62dd11":"# Machine Learning model","aeebfbeb":"Heatmap is a great way to visually look at the relationship between variables. The colors indicate the magnitude of correlation between the two variables. \nWe can see that many variables indicate positive correlation with a few variables showing very strong positive correlation with values close of 0.9.\n\nThe variables Length1, Length2 and Length3 are highly correlated leading to multicolinearity. Thus, we can drop two of the length variables and just keep one in order to do our regression analysis. \nNote that we usually drop variables with correlation coefficient, r = +\/- 0.9 or above.","f6b1760f":"### Boxplot for Length1 and Species","744cc9b9":"# Exploratory Data Analysis","8a535108":"The observation 144 is an outlier in case of Length3.","50849b3d":"We can see that the Height attribute has no outliers.","5a0602df":"## Count plot for different species of fishes","2e01c618":"The observations 142, 143 and 144 are outliers in case of Length2.","28f63b0d":"## Boxplots for knowing data distribution and detecting outliers","d59de077":"# Understanding the dataset","1343f79b":"Pairplot allows us to see both the distribution of the variable and pairwise relationship between variables in the dataset.","ebaf01e2":"## Checking for null values","b1bb2019":"# Dropping variables to avoid multicollinearity","4609d498":"## Statistics","87a5c83a":"#### Analyzing outliers for Length3","8b788cb6":"# Importing the libraries","8c157283":"### Boxplot for Length2","f17c2c5d":"The perfect linear representation of graphs between Length1, Length2 and Length3 indicates that our idea of dropping two from these three is correct.","d7d71b0e":"We can see that the Width attribute has no outliers.","a27f7787":"### Boxplot for Height","84882719":"### Model equation","302bdbe1":"The dataset has information associated with 7 species of fish. ","bacccf7c":"The observations 142, 143 and 144 are outliers in case of weight.","40277482":"### Boxplot for Length1","3ab46ae2":"We can see that there are no null values in the dataset. ","11a6ce65":"### Model parameters","5d4dc7ab":"### Outliers dataframe","3ee5d144":"The Perch species has the most fishes while the Whitefish species has the least fishes in the given dataset.","14716ccb":"### Correlation Heatmap","9cc2ce47":"### Splitting the dataset into training and testing","1d21630c":"Boxplot is a standard way of displaying the distribution of data based on a five number summary - minimum, first quartile, second quartile (median), third quartile, maximum. It also tells about outliers and their values, the distribution of the data - whether the data is symmetrical or not, whether the data is skewed or not, if it is skewed then whether it is skewed to the right or to the left, how tightly the data is grouped.","9a12c81f":"We can see that two fishes in our dataset have Length1 way different from the others. So, these two values are outliers for Length1 in our dataset. ","e5f65acc":"The outliers have been successfully deleted and leaving us with 156 observations instead of 159.","2457de16":"The pairplot indicates that the explanatory variables have linear relationship with the dependent variable, so it is good to fit a linear regression model to this dataset.","3d91af56":"### Deoendent and independent variables","78eb60ca":"#### Analyzing outliers for Length1","ad0007e0":"From the dataset info, we can see that the data types of the features have been marked correctly.","2477f4f0":"# Loading the data","65547e6e":"### Fitting the linear regression algorithm","562a3606":"The dataset is imbalanced with fishes in different species ranging from 6 to 56. This indicates that predicting the species of the fish is a tough job here as we do not have enough training data. We would rather try to predict the weight of the fishes. \n\nHence, we dependent variable is Weight and our independent variables are Species, Length1, Length2, Length3, Height, Width.","3295a61e":"We can see that all these three outliers belong to species 'Pike' which has in total 17 fishes in our dataset.\nThere are two ways to deal with outliers - we can either remove them or can replace with a new value. Since we have just 3 outliers in our data set, we will remove them.","2723a467":"This is a relatively small dataset with data related to just 159 fishes and their 7 attributes.","f9c06728":"#### Analyzing outliers for weight","9f22fcf0":"### Boxplot for Weight","c662899c":"## Multiple Linear Regression model","30113244":"#### Removing the outliers","e46127b6":"We can see a few outliers in this multivariate boxplot plotted using one categorical variable (Species) and one continuous variable (Length1). However, things doesn't seem to be much indicative as the distribution of data for each species is different. Also, the boxplot is just for Length1 but we should check this for all the attributes.\nSo, we will analyze the univariate outliers using the boxplot for each of these attributes to get a general idea about outliers in each attribute.","4ad1708e":"The dataset has the following features:\n1. Species: Name of the fish species\n2. Weight: Weight of fish in gram\n3. Length1: Vertical length in cm\n4. Length2: Diagonal length in cm\n5. Length3: Cross length in cm\n6. Height: Height in cm\n7. Width: Diagonal width in cm\n\nSo, for each fish we have its species, weight, width, lengths and height.","5d4fc26f":"### Boxplot for Length3","e8e91141":"### Boxplot for Width","39bb53cb":"Correlation indicates pairwise correlation between continuous variables in the dataset. While calculating the correlation, categorical variables are ignored, so 'Species' has been automatically ignored from our dataset. Correlation also excludes the NULL values but we do not have any NULL values in our dataset.","6bb02cce":"### Prediction","afcd2bb1":"## Correlation between variables"}}