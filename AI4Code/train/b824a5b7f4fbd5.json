{"cell_type":{"2c520175":"code","26dedf54":"code","8ef6a50c":"code","543e9457":"code","250305d6":"markdown","bc29b2ab":"markdown","75b2e8fd":"markdown","b84e4eeb":"markdown"},"source":{"2c520175":"import cudf\nimport cuml","26dedf54":"# Read the CSV files\ndf = cudf.read_csv('..\/input\/tabular-playground-series-jan-2021\/train.csv')\ntest_df = cudf.read_csv('..\/input\/tabular-playground-series-jan-2021\/test.csv')\nsub_df = cudf.read_csv('..\/input\/tabular-playground-series-jan-2021\/sample_submission.csv')\n\n# Extract the inputs and the targets, as well as the test inputs\nX = df.loc[:, 'cont1': 'cont14'].astype('float32')\ny = df.target.astype('float32')\nX_test = test_df.loc[:, 'cont1':].astype('float32')","8ef6a50c":"%%time\nrf = cuml.ensemble.RandomForestRegressor(n_estimators=200)\nrf.fit(X, y)","543e9457":"sub_df['target'] = rf.predict(X_test)\nsub_df.to_csv('submission.csv', index=False)","250305d6":"RAPIDS is now pre-installed in Kaggle containers, so you can easily import the RAPIDS libraries:","bc29b2ab":"## Training a cuML model\n\nNow, we will train a random forest model using the `cuml` library. You can find various regression and classification models in [the docs](https:\/\/docs.rapids.ai\/api\/cuml\/stable\/api.html#regression-and-classification) with an API that's very similar to `scikit-learn`.","75b2e8fd":"As you can see, it only took a few seconds to train it! On CPU, it would take significantly more time to train.","b84e4eeb":"## Load and preprocess with cuDF\n\nWe will first load and preprocess the CSV files using `cudf`, which is a library based on pandas that runs dataframe on GPU using cuda. [Read the docs](https:\/\/docs.rapids.ai\/api\/cudf\/stable\/)."}}