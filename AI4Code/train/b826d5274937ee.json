{"cell_type":{"8c47b1db":"code","56efa952":"code","a2d2ca7f":"code","ebc1d1ea":"code","473d9cf1":"code","76bf0341":"code","0a2fcd70":"code","1f979edb":"code","57d5cbc6":"markdown","5c0f29cf":"markdown","a5f92179":"markdown","ba110ede":"markdown","4d8b37a4":"markdown","81e60d53":"markdown","6f240060":"markdown"},"source":{"8c47b1db":"from IPython.display import clear_output\n\nimport numpy as np\nimport pandas as pd\n\nimport h2o\nfrom h2o.automl import H2OAutoML","56efa952":"from h2o.automl import H2OAutoML\nh2o.init()","a2d2ca7f":"train = pd.read_csv(\"..\/input\/tabular-playground-series-dec-2021\/train.csv\")\ntest = pd.read_csv(\"..\/input\/tabular-playground-series-dec-2021\/test.csv\")\nsubs = pd.read_csv(\"..\/input\/tabular-playground-series-dec-2021\/sample_submission.csv\")\n\ntrain = h2o.H2OFrame(train)\ntest = h2o.H2OFrame(test)","ebc1d1ea":"train.describe()","473d9cf1":"RANDOM_STATE = 12\nRUNTIME = 360\nN_FOLDS = 5\nSTOPPING_METRIC = \"auto\"\n\nx = train.columns\ny = \"Cover_Type\"\nx.remove(y)\nx.remove('Id')\n\ntrain[y] = train[y].asfactor()","76bf0341":"aml = H2OAutoML(stopping_metric=STOPPING_METRIC , nfolds=N_FOLDS, seed=RANDOM_STATE, max_runtime_secs=RUNTIME)\naml.train(x=x, y=y, training_frame=train)","0a2fcd70":"lb = aml.leaderboard\nlb.head(10)","1f979edb":"preds = aml.leader.predict(test)\nclear_output()\nsub = preds[0].as_data_frame()  ## Converting to dataframe\nsubs['Cover_Type'] = sub\nsubs.to_csv('h20-subs.csv',index = False)\nsubs.head()","57d5cbc6":"# Results Leaderboard","5c0f29cf":"# Data Loading and Preprocessing","a5f92179":"# Imports","ba110ede":"# Submission","4d8b37a4":"# AutoML","81e60d53":"### Top 10 models","6f240060":"# Initializing H20 Cluster"}}