{"cell_type":{"fdd6ad3a":"code","913e4ca9":"code","1386e7a6":"code","5c3cc341":"code","4d35a268":"code","457dec64":"code","7a7fe29f":"code","22423254":"code","1fd4e416":"code","c0f7e41c":"code","df774342":"code","c1306ef1":"code","bc74556c":"code","699e0e21":"code","7f3db7fa":"code","82b0f5d4":"code","b11b86ed":"code","974f35df":"code","e868a495":"code","1a5bafde":"code","27c6a88e":"code","829e8ac3":"code","907af07b":"code","ea2e45f9":"code","e1cf1297":"code","84643401":"code","5e9ac177":"code","cf9701f6":"code","abbe3f1f":"code","ea223f73":"code","e9d95a2d":"code","9a9feb87":"code","76707931":"code","c79269a9":"code","d291f764":"code","4ac43ef2":"code","06e532b2":"code","bab138a2":"code","ac2452d7":"code","152d268c":"code","4bf35389":"code","0f8f8988":"code","f024c1b5":"code","6afc81fc":"markdown"},"source":{"fdd6ad3a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport dateutil\nfrom datetime import datetime\nimport matplotlib.pyplot as plt\nfrom sklearn.cluster import KMeans\nfrom pandasql import sqldf\n\nfrom pandasql import sqldf\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","913e4ca9":"data_path='\/kaggle\/input\/dwdm-petrol-prices\/Petrol Prices.csv' # Path to data file\ndata = pd.read_csv(data_path)\ndata","1386e7a6":"print(\"Displaying first 7 records in the Dataset\")\ndata.head(7)","5c3cc341":"print('Displaying Last 4 Records in  Dataset')\ndata.tail(4)\n","4d35a268":"data.shape #Shows a total number of rows and columns found in dataset","457dec64":"data.columns #displays the names of the columns","7a7fe29f":"#Change anamoly in data - ug to Aug\ndata.loc[data['Date'] == 'ug 18 2016']","22423254":"data.at[143,'Date']='Aug 18 2016'\ndata","1fd4e416":"#Change the date format of the DATE column that it becomes readable\ndata['Date'] = pd.to_datetime(data['Date'])\ndata","c0f7e41c":"#Check to ensure that change was done.\ndata.loc[data['Date'] == 'Aug 18 2016']","df774342":"#Count how many records exist for each month in the data se\nsorted_data= data.sort_values(by='Date')\noutput = sorted_data['Date'].groupby(sorted_data.Date.dt.month).agg(Total=pd.NamedAgg(column='', aggfunc='count'))\nprint(output)","c1306ef1":"data[\"months\"]=pd.DatetimeIndex(data['Date']).month\ndata","bc74556c":"dout=data.groupby('months').count()\ndout","699e0e21":"dout.plot(title=\"Line Graph\", kind='line',\n            figsize=(12,8))","7f3db7fa":"data","82b0f5d4":"data[\"Day\"]=pd.DatetimeIndex(data['Date']).day\ndata","b11b86ed":"data[\"Year\"]=pd.DatetimeIndex(data['Date']).year\ndata","974f35df":"data[\"Time\"]=pd.DatetimeIndex(data['Date']).time\ndata","e868a495":"data","1a5bafde":"print('#8. Interesting columns from dataset.')\nInterestCol= data[['Gasolene_87', 'Gasolene_90', 'Auto_Diesel', 'Kerosene', 'Propane', 'Butane', 'HFO', 'Asphalt', 'ULSD', 'Ex_Refinery'\n]]\nInterestCol","27c6a88e":"InterestCol2= data[['Gasolene_87', 'Gasolene_90', 'Auto_Diesel', 'Kerosene', 'Propane', 'Butane', 'HFO', 'Asphalt', 'ULSD', 'Ex_Refinery', 'Year'\n                   ]]\nInterestCol2","829e8ac3":"print('#9.Plot a line graph showing the gas prices over the particular period for all the interesting columns.')\n\nInterestCol2.plot(kind='line', figsize=(12,8),\n    use_index = True,\n    y= ['Gasolene_87','Gasolene_90','Auto_Diesel','Kerosene', ]\n      )\nplt.suptitle(\"Gas Prices Over Through Jan to Aug 2019\",size=20)\nplt.xlabel(\"Month\", color='c',size=15)\nplt.ylabel(\"Prices\", color='b',size=15)","907af07b":"InterestCol2.plot(kind='line',x='Year',y=['Gasolene_87', 'Gasolene_90' ,'Auto_Diesel' ,'Kerosene' ,'Propane', 'Butane' ,'HFO' ,'Asphalt', 'ULSD' ,'Ex_Refinery'] ,\n                  title=\"Line Graph Showing Gas Prices Over The Years\",\n                  figsize=(20,20))\n","ea2e45f9":"print('#10.a Percentage Change')\ninterestPerc = data[['Gasolene_87']]\nprint(interestPerc)","e1cf1297":"Int_Col= data['Gasolene_87'].pct_change(periods=4)\nInt_Col","84643401":"print('#10 b. Plot these values using a suitable Graph')\ninterestPerc.plot(title=\"Line Graph Showing Percentage Change in 87 Gas\", kind='line',\nfigsize=(12,8))","5e9ac177":"data","cf9701f6":"print('# 11 Dataset with 2 Interesting columns from task 6')\ndataset={'HFO':data.HFO, 'Asphalt':data.Asphalt,'Months':data.months,'Year':data.Year,'Day':data.Year,'Time':data.Time}\ndatanew=pd.DataFrame(dataset)\ndatanew","abbe3f1f":"#Replace NAT Values with null\ndata=data.fillna('0')\ndata","ea223f73":"#Replace NAT Values with null\ndatanew=datanew.fillna('0')\ndatanew","e9d95a2d":"data['Gasolene_87']=data['Gasolene_87'].astype(int)\ndata['Gasolene_90']=data['Gasolene_90'].astype(int)\ndata['Auto_Diesel']=data['Auto_Diesel'].astype(int)\ndata['Kerosene']=data['Kerosene'].astype(int)\ndata['Propane']=data['Propane'].astype(int)\ndata['Butane']=data['Butane'].astype(int)\ndata['HFO']=data['HFO'].astype(int)\ndata['Asphalt']=data['Asphalt'].astype(int)\ndata['ULSD']=data['ULSD'].astype(int)\ndata['87_Change']=data['87_Change'].astype(int)\ndata['Ex_Refinery']=data['Ex_Refinery'].astype(int)\ndata['Day']=data['Day'].astype(int)\ndata['Year']=data['Year'].astype(int)\n\n\ndata.dtypes","9a9feb87":"datanew","76707931":"print ('#12. Perform K-Means on the dataset using the two interesting columns')\nkmeans = KMeans(n_clusters = 3)\nkmeans\ny_predicted = kmeans.fit_predict(datanew[['HFO', 'Asphalt']])\ny_predicted","c79269a9":"datanew['cluster'] = y_predicted\ndatanew.tail(50)","d291f764":"#dataset['cluster']=kmeans.fit_predict(datanew)\n#dataset","4ac43ef2":"print('#14. Provide a suitable plot of each cluster.')\nfrom matplotlib.pyplot import figure\ndatanew1 = datanew[datanew.cluster==0]\ndatanew2 = datanew[datanew.cluster==1]\ndatanew3 = datanew[datanew.cluster==2]\n\nplt.figure(figsize=(8, 8), dpi=80)\nplt.scatter(datanew1.HFO,datanew1.Asphalt,color='green')\nplt.scatter(datanew2.HFO,datanew2.Asphalt,color='red')\nplt.scatter(datanew3.HFO,datanew3.Asphalt,color='black')\n\n#plotting the centroids\nplt.scatter(kmeans.cluster_centers_[:,0],kmeans.cluster_centers_[:,1],color='blue',marker='*',label='centroid', s=150)\n\n\nplt.xlabel('HFO')\nplt.ylabel('Asphalt')\nplt.legend()\n","06e532b2":"datanew.dtypes","bab138a2":"print('centroids of each cluster.')\nkmeans.cluster_centers_","ac2452d7":"data.plot(kind='scatter',x='HFO',y='Asphalt',c=kmeans.labels_, cmap='rainbow', figsize=(12,8))","152d268c":"Year = data[['Gasolene_87', 'Gasolene_90', 'Auto_Diesel', 'Kerosene', 'Propane', 'Butane', 'HFO', 'Asphalt', 'ULSD', 'Ex_Refinery','Year'\n]]\nYear","4bf35389":"data.groupby('Year')['HFO','Asphalt'].mean()","0f8f8988":"Group_year=Year.groupby('Year').sum()\nGroup_year","f024c1b5":"print('#15. a')\nGroup_mean=Group_year.groupby('Year').mean()\nGroup_mean","6afc81fc":"#15. \n\nb.\n\n\nc. K-Means was used to divide the group prices into clusters where the prices that falls in one cluster are similar to each other. It assisted in outlining differencesd and similarities.\n\n\nd. A moving average is a technique to get an overall idea of the trends in a data set; it is an average of any subset of numbers. The moving average is extremely useful for forecasting long-term trends. You can calculate it for any period of time. For example, if you have sales data for a twenty-year period, you can calculate a five-year moving average, a four-year moving average, a three-year moving average and so on. Stock market analysts will often use a 50 or 200 day moving average to help them see trends in the stock market and (hopefully) forecast where the stocks are headed.\n\nAn average represents the \u201cmiddling\u201d value of a set of numbers. The moving average is exactly the same, but the average is calculated several times for several subsets of data. For example, if you want a two-year moving average for a data set from 2000, 2001, 2002 and 2003 you would find averages for the subsets 2000\/2001, 2001\/2002 and 2002\/2003. Moving averages are usually plotted and are best visualized.\n\nhttps:\/\/www.statisticshowto.datasciencecentral.com\/moving-average\/\n"}}