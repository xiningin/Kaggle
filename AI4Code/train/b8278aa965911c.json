{"cell_type":{"58457112":"code","1c231af2":"code","f3170378":"code","19a97aa0":"code","518a48b6":"code","b90f3967":"code","d0bf35ec":"code","07a73329":"code","cc4a0452":"code","335f585e":"code","13fbb6cb":"code","ecc09a56":"code","fff39c3a":"code","9d39e43f":"code","27dd0d26":"code","9f082588":"code","9901f67f":"code","c3f85328":"code","72e183f7":"code","b67e60ce":"markdown","4e11edd4":"markdown","5b678d15":"markdown","95972cba":"markdown","9384b17f":"markdown","bff5ed8b":"markdown","06b8db0a":"markdown","8ed10869":"markdown","97d9b7d3":"markdown","9e0f801c":"markdown","043354bd":"markdown","cf4afa75":"markdown","88ca99cf":"markdown"},"source":{"58457112":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","1c231af2":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\n%matplotlib inline\nimport xgboost\nfrom sklearn.ensemble import RandomForestClassifier","f3170378":"file_path = '..\/input\/heart-failure-clinical-data'\nheart_data = pd.read_csv('\/kaggle\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')\nheart_data.head()","19a97aa0":"heart_data.describe()","518a48b6":"heart_data.isna().sum()","b90f3967":"#We plot the distribution of the age of people in the dataset:\nplt.figure(figsize=(10,6))\nsns.histplot(data= heart_data, x = \"age\", kde=True)\n","d0bf35ec":"# We plot the distribution of the gender of the people coming in:\nsns.kdeplot(data = heart_data,x= heart_data.age, hue='sex', shade=True)","07a73329":"#To find out the density of the population between male and female genders divided into whether they smoke or not\nplt.figure(figsize=(5,5))\nsns.kdeplot(data = heart_data, x = heart_data.sex,hue='smoking', shade=True)","cc4a0452":"# #Checking out the number of smokers between genders(Assuming 1 for male and 0 for female gender)\nmale = heart_data[heart_data[\"sex\"]==1]\nfemale = heart_data[heart_data[\"sex\"]==0]\n\nmale_smoker = male[heart_data[\"smoking\"]==1]\nfemale_smoker = female[heart_data[\"smoking\"]==1]\nsmokers = [len(male_smoker),len(female_smoker)]\nsns.barplot(y=smokers, x = ['Male smokers','Female Smokers'])","335f585e":"male_survi = male[heart_data[\"DEATH_EVENT\"]==0]\nmale_not = male[heart_data[\"DEATH_EVENT\"]==1]\nfemale_survi = female[heart_data[\"DEATH_EVENT\"]==0]\nfemale_not = female[heart_data[\"DEATH_EVENT\"]==1]\n\nlabels = ['Male - Survived','Male - Not Survived', \"Female -  Survived\", \"Female - Not Survived\"]\nvalues = [len(male_survi),len(male_not),\n         len(female_survi),len(female_not)]\nplt.figure(figsize=(7,7))\ndef make_autopct(values):\n    def my_autopct(pct):\n        total = sum(values)\n        val = int(round(pct*total\/100.0))\n        return '{p:.2f}%  ({v:d})'.format(p=pct,v=val)\n    return my_autopct\n\nplt.pie(values, labels= labels, autopct=make_autopct(values),  labeldistance=1)\n# plt.legend()\nplt.show() ","13fbb6cb":"# Checking among the survivers:\nmale_survi_smoker = male_survi[male_survi['smoking']==1]\nmale_survi_non_smoker = male_survi[male_survi.smoking==0]\n\nfemale_survi_smoker = female_survi[female_survi.smoking==1]\nfemale_survi_non_smoker = female_survi[female_survi.smoking==0]\n\nlabels = ['Male - Smokers','Male - Non-Smokers', 'Female -  Smokers', 'Female - Non smokers']\nvalues = [len(male_survi_smoker),len(male_survi_non_smoker),len(female_survi_smoker), len(female_survi_non_smoker)]\n\n\n# plt.subplot(3,4,1)\nplt.pie(values, labels= labels, autopct=make_autopct(values),  labeldistance=1 ,radius=2)\nplt.title(\"Distribution of survivers\")\n","ecc09a56":"male_not_survi_smoker = male_not[male_not['smoking']==1]\nmale_not_survi_non_smoker = male_not[male_not['smoking']==0]\nfemale_not_survi_smoker = female_not[female_not['smoking']==1]\nfemale_not_survi_non_smoker = female_not[female_not['smoking']==0]\nlabels_not = ['Male - Smokers','Male - Non-Smokers', 'Female -  Smokers', 'Female - Non smokers']\nvalues_not_survived = [len(male_not_survi_smoker),len(male_not_survi_non_smoker),len(female_not_survi_smoker), len(female_not_survi_non_smoker)]\nplt.pie(values_not_survived,labels= labels_not, autopct=make_autopct(values_not_survived),  labeldistance=1, radius=2)\nplt.title(\"Distribution among the people who did not survive\")\n","fff39c3a":"sns.swarmplot(data=heart_data, x = 'DEATH_EVENT', y = 'creatinine_phosphokinase',)","9d39e43f":"heart_data.head()","27dd0d26":"Features = ['time','ejection_fraction','serum_creatinine','platelets']\ny = heart_data['DEATH_EVENT']\nheart_data.drop(['DEATH_EVENT'], axis = 1)","9f082588":"from sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score, confusion_matrix,mean_absolute_error,mean_squared_error\n","9901f67f":"X_copy = heart_data[Features]\ny_copy = y.copy()","c3f85328":"X_train, X_test, y_train, y_test = train_test_split(X_copy, y_copy, train_size=0.7, random_state=0, shuffle = True)\nmodel = RandomForestClassifier(random_state=42)\nmodel.fit(X_train,y_train)\npreds = model.predict(X_test)\nac = accuracy_score(y_test, preds)\nmae = mean_absolute_error(preds,y_test)\nprint(\"Using Random Forrest Classifier:\")\nprint(f'Model accuracy is: {ac*100}%')\nprint(f'Mean absolute error is: {mae}')","72e183f7":"from xgboost import XGBRegressor\nmy_model = XGBRegressor(n_estimators=100, learning_rate=0.05, n_jobs=4)\nmy_model.fit(X_train, y_train, early_stopping_rounds=5, eval_set=[(X_test, y_test)], verbose=False)\npredictions = my_model.predict(X_test)\nxg_ac = my_model.score(X_test, y_test)\nprint('For XG BOOST model')\nprint(\"Mean Absolute Error: \" + str(mean_absolute_error(predictions, y_test)))\nprint(f'The model score for XG BOOST model is: {xg_ac}')\n","b67e60ce":"There is no particular relationship between the levels of creatinine_phosphokinase and Death Event.","4e11edd4":"> **AS you can see that XG BOOST did not perform better than Random Forrest Classifier. Therefore we go with the Random Forrest model.**","5b678d15":"***Checking for null values:***","95972cba":"# **2. We will now start with our Data Modelling:**\n# A. Random Forrest Regressor","9384b17f":"We can see that among the survivers there isnot much difference between the smokers and the no-smokers for the male population but almost all the female population survivers are non-smokers. ","bff5ed8b":"***We can see that there is no difference between the gender of the people diagnosed with heart disease.***","06b8db0a":"We are in luck as we do not have any missing values so we do not have to fill in the dummy values","8ed10869":"We would not drop any data now and look at how the model performs. Since we do not have any explanation about time we dropped that column.","97d9b7d3":"We would now drill down even more to differentiate between the smokers and non-smokers between genders and find out their survival.","9e0f801c":"As we can see that the male population has ","043354bd":"\n#  B. XG BOOST:","cf4afa75":"# ***Please let me know in the comments what do you think of my code. Thanks.***","88ca99cf":"# **1. EDA of the data**"}}