{"cell_type":{"28995c78":"code","1f33a3e7":"code","29d39115":"code","ba4e3709":"code","bd815b5e":"code","69c12214":"code","e531bc58":"code","5c60f6f7":"code","c4d6df0a":"code","dd5c3a1b":"code","4afa7de4":"code","e6a9e345":"code","f09f4912":"code","8a4fa67d":"code","e0e689c7":"code","dfdb8b49":"code","ef7fb28e":"code","d8b2a969":"code","88dca029":"code","0d652e6a":"code","dd39330c":"code","1e334e3d":"code","2a2f3fa4":"code","beb88ae2":"code","06f4ca46":"markdown","77aafe33":"markdown","b511b1ef":"markdown","ef5466b0":"markdown","8fa7c91c":"markdown","d90997ff":"markdown","7f842530":"markdown","322ff3f8":"markdown","e55a6992":"markdown","e413e1d6":"markdown","15cc2cad":"markdown","9744d4b3":"markdown","c89ec1e4":"markdown","43706e1b":"markdown","eeaecdf4":"markdown","2becf70e":"markdown","18312ab3":"markdown","2137e921":"markdown","8a500088":"markdown","86f736f6":"markdown","ee362b71":"markdown","6f8cc951":"markdown","017252f6":"markdown","cbb8c398":"markdown","694311a0":"markdown","40c90b23":"markdown","c79450d3":"markdown","54ff3350":"markdown","b02b1dcb":"markdown","61aeef8f":"markdown","84065492":"markdown","9da0b0a6":"markdown","4b027f39":"markdown"},"source":{"28995c78":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import plot_confusion_matrix, f1_score\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.ensemble import RandomForestClassifier\nsns.set_style(\"whitegrid\")\nsns.set_palette(\"Set3\")\nplt.rcParams.update({'font.size': 14})","1f33a3e7":"df = pd.read_csv(\"..\/input\/heart-failure-prediction\/heart.csv\")\ndf.head()","29d39115":"df.info()","ba4e3709":"df.drop_duplicates()\ndf.info()","bd815b5e":"df.describe()","69c12214":"df.describe(include=[object])","e531bc58":"bins = [20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85]\nplt.figure(figsize=(14, 6))\nsns.histplot(data=df, x=\"Age\", kde=True, hue=\"HeartDisease\", bins=bins);\nsns.despine(top=True, right=True)","5c60f6f7":"plt.figure(figsize=(12, 6))\nsns.countplot(data=df, x=\"Sex\", hue=\"HeartDisease\");\nsns.despine(top=True, right=True)","c4d6df0a":"plt.figure(figsize=(12, 6))\nsns.countplot(data=df, x=\"ChestPainType\", hue=\"HeartDisease\");\nsns.despine(top=True, right=True)","dd5c3a1b":"plt.figure(figsize=(20, 6))\nbins = [70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200]\nsns.histplot(data=df, x=\"RestingBP\", bins=bins, hue=\"HeartDisease\");\nsns.despine(top=True, right=True)","4afa7de4":"bins = [90, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300, 320, 340, 360, 380, 400, 420, 440, 460, 480, 500]\nplt.figure(figsize=(18, 6))\nsns.histplot(data=df, x=\"Cholesterol\", bins=bins, hue=\"HeartDisease\");\nsns.despine(top=True, right=True)","e6a9e345":"plt.figure(figsize=(16, 5))\nsns.countplot(data=df, x=\"FastingBS\", hue=\"HeartDisease\");\nsns.despine(top=True, right=True)","f09f4912":"plt.figure(figsize=(18, 5))\nsns.countplot(data=df, x=\"RestingECG\", hue=\"HeartDisease\");\nsns.despine(top=True, right=True)","8a4fa67d":"plt.figure(figsize=(18, 6))\nbins = [60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200]\nsns.histplot(data=df, x=\"MaxHR\", hue=\"HeartDisease\", bins=bins);\nsns.despine(top=True, right=True)","e0e689c7":"plt.figure(figsize=(18, 6))\nsns.set_context(font_scale=9)\nsns.countplot(data=df, x=\"ExerciseAngina\", hue=\"HeartDisease\");\nsns.despine(top=True, right=True)","dfdb8b49":"plt.figure(figsize=(16, 6))\nsns.countplot(data=df, x=\"ST_Slope\", hue=\"HeartDisease\");\nsns.despine(top=True, right=True)","ef7fb28e":"cor=df.corr()\nplt.figure(figsize=(14,9))\nmatrix = np.triu(cor)\nsns.heatmap(cor, annot=True, mask=matrix, cmap=\"Set3\");","d8b2a969":"df_dum = pd.get_dummies(df, drop_first=True)\ndf_dum","88dca029":"X = df_dum.drop(\"HeartDisease\", axis=1)\ny = df_dum[\"HeartDisease\"]","0d652e6a":"scaler = StandardScaler()\nX = scaler.fit_transform(X)\nX","dd39330c":"xtrain, xtest, ytrain, ytest = train_test_split(X, y, test_size=0.3, random_state=42)","1e334e3d":"xtrain.shape, ytrain.shape, xtest.shape, ytest.shape","2a2f3fa4":"lr_clf = LogisticRegression(solver=\"liblinear\", random_state=42).fit(xtrain, ytrain)\nypred = lr_clf.predict(xtest)\nprint(\"Confusion matrix for Logistic Regression classifier is: \")\nplot_confusion_matrix(lr_clf, xtest, ytest, cmap=\"Set3\")\nplt.grid(None)\nplt.show()\nprint(\"F1 score for Logistic Regression is: \",f1_score(ytest, ypred))","beb88ae2":"rf_clf = RandomForestClassifier(max_depth=9, random_state=42)\nrf_clf.fit(xtrain, ytrain)\nypred = rf_clf.predict(xtest)\nprint(\"Confusion matrix for Random forest classifier is: \")\nplot_confusion_matrix(lr_clf, xtest, ytest, cmap=\"Set3\")\nplt.grid(None)\nplt.show()\nprint(\"F1 score for Random forest is: \",f1_score(ytest, ypred))","06f4ca46":"#### Patients with all types of resting ECG have a higher number of patients with heart disease but the difference is significant in ST (having ST-T wave abnormility).","77aafe33":"<center><h1 style=\"border-radius: 25px; background: #6DE5B9; padding: 30px; width: 500px; height: 20px;\">Importing libraries<\/h1><\/center>","b511b1ef":"## <center>Is there any type of correlation between variables? <\/center>\n<hr style=\"height:5px;border-width:0;color:gray;background-color:#6DE5B9\">","ef5466b0":"## <center>What is the range of cholesterol for patients with heart disease? <\/center>\n<hr style=\"height:5px;border-width:0;color:gray;background-color:#6DE5B9\">","8fa7c91c":"#### Maximum number of patients with heart disease have a cholesterol in the range of 200-219, for normal patients this range is 220-239.","d90997ff":"#### There is almost no correlation between variables.","7f842530":"<center><h1 style=\"border-radius: 25px; background: #6DE5B9; padding: 30px; width: 500px; height: 20px;\">Model Selection<\/h1><\/center>","322ff3f8":"## <center>Which gender has more number of patients? <\/center>\n<hr style=\"height:5px;border-width:0;color:gray;background-color:#6DE5B9\">","e55a6992":"#### People with fasting blood sugar higher than 120 mg\/dl mostly have heart disease. ","e413e1d6":"#### Maximum people with flat ST_Slope have heart disease","15cc2cad":"## <center>What is the range of maximum heart rate for a pateint with heart disease? <\/center>\n<hr style=\"height:5px;border-width:0;color:gray;background-color:#6DE5B9\">","9744d4b3":"## <center>Which age group have maximum heart diseases? <\/center>\n<hr style=\"height:5px;border-width:0;color:gray;background-color:#6DE5B9\">","c89ec1e4":"#### Firstly, we can see that there is more data collected for male patients. In male patients the number of patients with heart disease is significantly higher than normal patients, which is the opposite of what we see in female patients. ","43706e1b":"#### Maximum number of patients with heart disease have a resting blood pressure in the range of 130-139, whereas for normal patients it is 120-129.","eeaecdf4":"## <center>What is the range of resting blood pressure for patients with heart disease? <\/center>\n<hr style=\"height:5px;border-width:0;color:gray;background-color:#6DE5B9\">","2becf70e":"<center><h1 style=\"border-radius: 25px; background: #6DE5B9; padding: 30px; width: 500px; height: 20px;\">Exploratory Data Analysis<\/h1><\/center>","18312ab3":"## <center>Which kind of resting ECG have higher number of heart disease? <\/center>\n<hr style=\"height:5px;border-width:0;color:gray;background-color:#6DE5B9\">","2137e921":"<center><h1 style=\"border-radius: 25px; background: #6DE5B9; padding: 30px; width: 500px; height: 20px;\">Introduction<\/h1><\/center>","8a500088":"## <center>Does having heart disease increase the risk of exercise induced angina? <\/center>\n<hr style=\"height:5px;border-width:0;color:gray;background-color:#6DE5B9\">","86f736f6":"## <center>Which type of chest pain has highest number of heart disease risk? <\/center>\n<hr style=\"height:5px;border-width:0;color:gray;background-color:#6DE5B9\">","ee362b71":"<center><h1 style=\"border-radius: 25px; background: #6DE5B9; padding: 30px; width: 500px; height: 20px;\">Data Exploration<\/h1><\/center>","6f8cc951":"<center><h1 style=\"border-radius: 25px; background: #6DE5B9; padding: 30px; width: 500px; height: 20px;\">Data Preprocessing<\/h1><\/center>","017252f6":"- There are no duplicate rows in the dataset.","cbb8c398":"<div style=\"font-size:18px;text-align:justify\">\n    Our data is a CSV file having 12 attributes. Below is in detail about each.<br>\n<\/div>\n\n| Attribute    | Description|\n|--------------|------------|\n| **Age** | age of the patient [years]|\n|  **Sex**  |Gender of the patient [M: Male, F: Female] |\n|**ChestPain**| chest pain type [TA: Typical Angina, ATA: Atypical Angina, NAP: Non-Anginal Pain, ASY: Asymptomatic]|\n|**RestingBP**| resting blood pressure [mm Hg]|\n|**Cholesterol**| serum cholesterol [mm\/dl]|\n|**FastingBS**| fasting blood sugar [1: if FastingBS > 120 mg\/dl, 0: otherwise]|\n|**RestingECG**| resting electrocardiogram results [Normal: Normal, ST: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV), LVH: showing probable or definite left ventricular hypertrophy by Estes' criteria]|\n|**MaxHR**| maximum heart rate achieved [Numeric value between 60 and 202]|\n|**ExerciseAngina**| exercise-induced angina [Y: Yes, N: No]|\n|**Oldpeak**| oldpeak = ST [Numeric value measured in depression]|\n|**ST_Slope**| the slope of the peak exercise ST segment [Up: upsloping, Flat: flat, Down: downsloping]|\n|**HeartDisease**| output class [1: heart disease, 0: Normal]|","694311a0":"#### - The highest number of heart failure rate is associated with ASY (Asymptomatic) type of chest pain, after that comes NAP (Non-anginal pain).\n#### - Most common type of chest pain in people with no heart disease is ATA (Atypical angina) and least common is TA (typical angina).","40c90b23":"<div style=\"font-size:18px;text-align:justify\"> The term <b>\u201cheart disease\u201d<\/b> refers to several types of heart conditions.\n<br>Heart disease describes a range of conditions that affect your heart. Heart diseases include:\n<ul>\n    <li>Blood vessel disease, such as coronary artery disease<\/li>\n    <li>Heart rhythm problems (arrhythmias)<\/li>\n    <li>Heart defects you're born with (congenital heart defects)<\/li>\n    <li>Heart valve disease<\/li>\n    <li>Disease of the heart muscle<\/li>\n    <li>Heart infection<\/li>\n<\/ul>\nMany forms of heart disease can be prevented or treated with healthy lifestyle choices.\nWe are going to analyze a data on Heart Disease Prediction Dataset to figure out causes and important features that affect heart disease chances considerably. Improving these indexes can actually help us in reducing prevalance in heart disease.\n<\/div>","c79450d3":"## <center>Which kind of ST_Slope have higher number of heart disease? <\/center>\n<hr style=\"height:5px;border-width:0;color:gray;background-color:#6DE5B9\">","54ff3350":"#### Patients with heart disease have more spread from 60 to 200 whereas for normal patients it is from 80 to 200. Normal patients seem to have a higher maximum heart rate on average than people with heart disease. \n#### Maximum patients with heart disease have a maximum heart  rate in range of 120-129.","b02b1dcb":"#### The age group of 55-60 have maximum heart failures.","61aeef8f":"#### For people having heart disease there is a higher chance of exercise induced angina compared to normal people.","84065492":"<center><h1 style=\"border-radius: 25px; background: #6DE5B9; padding: 30px; width: 500px; height: 20px;\">About the Data<\/h1><\/center>","9da0b0a6":"- There are total 11 columns out of which 5 have object datatype, one is of float datatype and the rest are integer datatype.\n- There is no missing data in the dataset.\n","4b027f39":"## <center>What does fasting blood sugar tell us about heart disease?<\/center>\n<hr style=\"height:5px;border-width:0;color:gray;background-color:#6DE5B9\">"}}