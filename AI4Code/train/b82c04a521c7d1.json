{"cell_type":{"5e3b9201":"code","ea53f149":"code","efc3c1e0":"code","5bcf9fd0":"code","a8306b2a":"code","55547b44":"code","2d24b1e9":"code","424398fb":"code","69e8f3ef":"code","d4283624":"code","0a00dc1a":"code","6148550f":"code","3a5d7f79":"code","d9af41d8":"code","dea1d342":"code","bb8e697c":"code","78a95921":"code","e285c86d":"code","14aa0862":"code","f08f1499":"markdown","c8c06cbc":"markdown","370b942a":"markdown","b22fb355":"markdown","8447e90e":"markdown","a0f8e1fd":"markdown","02ab265d":"markdown","9cfcd7ac":"markdown","f20fa1f6":"markdown","16bd6aea":"markdown","52f0832e":"markdown","40545dfb":"markdown","50d672ca":"markdown"},"source":{"5e3b9201":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nimport seaborn as sns\nfrom matplotlib import pyplot\nfrom matplotlib import rcParams\nimport seaborn as sns\nimport matplotlib.pyplot as pl","ea53f149":"df=pd.read_csv(\"..\/input\/restaurant-and-market-health-inspections.csv\")\ntotal = df.isnull().sum().sort_values(ascending=False)\npercent = (df.isnull().sum()*100\/df.isnull().count()).sort_values(ascending=False)\nmissing_data = pd.concat([total, percent], axis=1, keys=['Total', 'Percent'])\nmissing_data.head(20)","efc3c1e0":"df.columns.values","5bcf9fd0":"print('serial_number ',df.serial_number.unique().shape)\nprint('activity_date ',df.activity_date.unique().shape)\nprint('facility_name ',df.facility_name.unique().shape)#to remove\nprint('score ',df.score.unique().shape)\nprint('grade ',df.grade.unique().shape)\nprint('service_code ',df.service_code.unique().shape)\nprint('service_description ',df.service_description.unique().shape)\nprint('employee_id ',df.employee_id.unique().shape)\nprint('facility_address ',df.facility_address.unique().shape)#to remove\nprint('facility_id',df.facility_id.unique().shape)#to remove\nprint('facility_state',df.facility_state.unique().shape)#to remove\nprint('facility_zip',df.facility_zip.unique().shape)\nprint('owner_id ',df.owner_id.unique().shape)#to remove\nprint('owner_name',df.owner_name.unique().shape)#to remove\nprint('pe_description',df.pe_description.unique().shape)#VIP\nprint('program_element_pe',df.program_element_pe.unique().shape)#VIP\nprint('program_name',df.program_name.unique().shape)\nprint('program_status',df.program_status.unique().shape)\nprint('record_id',df.record_id.unique().shape)","a8306b2a":"df=df.sort_values(by=['facility_name'])\nfe_v=df.loc[:,'facility_name'].values\nprint(fe_v[0:20])","55547b44":"fd=df.sort_values(by=['owner_id'])\nfd.head(20)","2d24b1e9":"df_nd=df.drop_duplicates('owner_id',keep='first')\ndf_nd=df_nd.drop_duplicates('owner_name',keep='first')\ndf_nd.head()","424398fb":"print('serial_number ',df_nd.serial_number.unique().shape)\nprint('activity_date ',df_nd.activity_date.unique().shape)\nprint('facility_name ',df_nd.facility_name.unique().shape)#to remove\nprint('score ',df_nd.score.unique().shape)\nprint('grade ',df_nd.grade.unique().shape)\nprint('service_code ',df_nd.service_code.unique().shape)\nprint('service_description ',df_nd.service_description.unique().shape)\nprint('employee_id ',df_nd.employee_id.unique().shape)\nprint('facility_address ',df_nd.facility_address.unique().shape)#to remove\nprint('facility_id',df_nd.facility_id.unique().shape)#to remove\nprint('facility_state',df_nd.facility_state.unique().shape)#to remove\nprint('facility_zip',df_nd.facility_zip.unique().shape)\nprint('owner_id ',df_nd.owner_id.unique().shape)#to remove\nprint('owner_name',df_nd.owner_name.unique().shape)#to remove\nprint('pe_description',df_nd.pe_description.unique().shape)#VIP\nprint('program_element_pe',df_nd.program_element_pe.unique().shape)#VIP\nprint('program_name',df_nd.program_name.unique().shape)\nprint('program_status',df_nd.program_status.unique().shape)\nprint('record_id',df_nd.record_id.unique().shape)","69e8f3ef":"df2=df_nd[['score','grade','service_code','service_description','employee_id',\n        'pe_description','program_element_pe','program_status','facility_zip','owner_id','facility_address']].copy()","d4283624":"df2['facility_zip'] = df2['facility_zip'].str.extract('(\\d+)', expand=False)\ndf2['facility_zip']=pd.to_numeric(df2['facility_zip'])  \ndf2['owner_id'].astype(str) \ndf2['owner_id'] = df2['owner_id'].str.extract('(\\d+)', expand=False)\ndf2['owner_id']=pd.to_numeric(df2['owner_id'])  \ndf2['employee_id'].astype(str) \ndf2['employee_id'] = df2['employee_id'].str.extract('(\\d+)', expand=False)\ndf2['employee_id']=pd.to_numeric(df2['employee_id'])     ","0a00dc1a":"df2.head()","6148550f":"df_sc=df[df.service_code>1]\ndf_sc.loc[:,'service_code'].values.shape","3a5d7f79":"df2.info()","d9af41d8":"df2 = pd.get_dummies(df2, prefix='grade_', columns=['grade'])\ndf2 = pd.get_dummies(df2, prefix='pe_description_', columns=['pe_description'])\ndf2 = pd.get_dummies(df2, prefix='program_status_', columns=['program_status'])","dea1d342":"\n\nf, ax = pl.subplots(figsize=(10, 8))\ncorr = df2.corr()\nsns.heatmap(corr, mask=np.zeros_like(corr, dtype=np.bool), cmap=sns.diverging_palette(220, 10, as_cmap=True),\n            square=True, ax=ax)","bb8e697c":"df_1=df.sort_values(by=['owner_id'])\ndf_1['year']=df_1.activity_date.str[0:4]\ndf_1['year']=pd.to_numeric(df_1['year'])  \ndf_1['month']=df_1.activity_date.str[5:7]\ndf_1['month']=pd.to_numeric(df_1['month'])  \ndf_1['date']=df_1['year']+df_1['month']\/12","78a95921":"df_1.head()","e285c86d":"ax = sns.boxplot(x=\"year\", y=\"score\",data=df_1, palette=\"Set3\")","14aa0862":"ax1 = sns.boxplot(x=\"date\", y=\"score\",data=df_1, palette=\"Set3\")","f08f1499":" <h1>1 [Data preprocessing](#dp)<h1>\n <h1>2 [Correlation map](#mcm)<h1>","c8c06cbc":"<h3> It looks like facility_id, owner_ide and owner name it is the same value except some \"bad values\"<h3>\n<h3> Also program_name and facility_name are the same<h3>","370b942a":"**It is not clear if in service code there is only few values >1 and it is bad data or real data**","b22fb355":"<h3>We have to drop repeting values<h3>","8447e90e":"<h3>Importing libraries <h3>","a0f8e1fd":"\n<h3>There are 11681 unique restaurants which were noticed 4-7 times and while noting they changed parameters, like adress.<h3>\n","02ab265d":"1. Score is vell corelated with grade A and pe_description_low risk in three categories\n1. Grade A is not corelated with risk- it is not good parameter to distinguish risk\n1. Program_element_pe is much often korelate with hi risk","9cfcd7ac":"It looka like in 2018 both average score was slightly higher than before ","f20fa1f6":"<a id=\"mcm\"><h2>Making correlation martix<h2><\/a>","16bd6aea":"<a id=\"dp\"><h2>Data preprocessing<h2><\/a>","52f0832e":"\n\n<h3>Choosing column to  work with. If there are to many different values (more than 700) than it will be impossible to get dummy variables<h3>\n\n","40545dfb":"<h3>Reading and cleaning data<h3>","50d672ca":"Getting back to original df data- let us look how score is changing in time"}}