{"cell_type":{"8604093b":"code","923b47df":"code","b54a30f4":"code","def457c2":"code","670982c1":"code","3670fc50":"code","9b944c40":"markdown","30880d9a":"markdown","eb719188":"markdown"},"source":{"8604093b":"import numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd","923b47df":"dir = \"..\/input\/customer\/customers.csv\"\ndataset = pd.read_csv(dir) #reads the csv file in a pandas dataframe\n#dataset.head()\n","b54a30f4":"X = dataset.iloc[:, [3, 4]].values # using values of 3rd and 4th column, since those are the two neutral topics ","def457c2":"import scipy.cluster.hierarchy as sch\ndendrogrm = sch.dendrogram(sch.linkage(X, method = 'ward'))\nplt.title('Dendrogram')\nplt.xlabel('Customers')\nplt.ylabel('Euclidean distance')\nplt.show()\n\n","670982c1":"from sklearn.cluster import AgglomerativeClustering\nhc = AgglomerativeClustering(n_clusters = 5, affinity = 'euclidean', linkage = 'ward')\ny_hc = hc.fit_predict(X)\n# documentation: https:\/\/scikit-learn.org\/stable\/modules\/generated\/sklearn.cluster.AgglomerativeClustering.html","3670fc50":"# Visualising the clusters\nplt.figure(figsize=(10, 7))\nplt.scatter(X[y_hc == 0, 0], X[y_hc == 0, 1], s = 50, c = 'blue', label = 'Cautious')\nplt.scatter(X[y_hc == 1, 0], X[y_hc == 1, 1], s = 50, c = 'orange', label = 'Mediocre\/Standard')\nplt.scatter(X[y_hc == 2, 0], X[y_hc == 2, 1], s = 50, c = 'green', label = 'Imporant Targets')\nplt.scatter(X[y_hc == 3, 0], X[y_hc == 3, 1], s = 50, c = 'cyan', label = 'Not Important\/Careless')\nplt.scatter(X[y_hc == 4, 0], X[y_hc == 4, 1], s = 50, c = 'magenta', label = 'Diligent')\nplt.title('Clustering of customers')\nplt.xlabel('Annual Income (k)')\nplt.ylabel('Spending Score (1-100)')\nplt.legend()\nplt.show()","9b944c40":"# **Finding the number of clusters using Dendrogram**","30880d9a":"Here number of clusters are 5","eb719188":"To identify the number of clusters to be used, we find a line that extends farthest from the other lines and draw a horizontal line on the bottom of it. (down the graph where the merge starts)\nNow the vertical lines above the imaginary horizontal line are the number of clusters. "}}