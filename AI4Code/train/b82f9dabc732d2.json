{"cell_type":{"33609b57":"code","776fc9f4":"code","cf3d09ff":"code","edaa1154":"code","ab208007":"code","9cd7c14f":"code","566bfab8":"code","51500bb0":"code","ad39edfc":"code","a4ea3602":"code","9958db0f":"code","d66e2930":"code","20b31ca7":"code","25407915":"code","11e08186":"code","455a4dfd":"code","b33973da":"code","ef79d81c":"code","8446a33e":"code","58bc25b2":"code","dc157e07":"code","1a3fe290":"code","ebdf04c8":"code","7301485f":"code","f013a289":"code","dcb1cf1d":"code","509924ff":"code","e6677874":"code","508c493a":"code","c1b8962b":"code","4a368f9e":"code","5510d055":"code","93d89819":"markdown","715b328a":"markdown","1be320d3":"markdown","48e90239":"markdown","898e6ebc":"markdown","20816ff1":"markdown","57e9c152":"markdown","1cf48057":"markdown","d7b8b3ed":"markdown","2ed73289":"markdown","a0195c84":"markdown","83548898":"markdown","dd1367c6":"markdown","325518d5":"markdown","32ee1d5a":"markdown","93200273":"markdown","23fa804a":"markdown","b6f98122":"markdown","57a61b30":"markdown","56ceb2a3":"markdown","1489430e":"markdown","fa6728ac":"markdown","583cc6a7":"markdown","64548f3d":"markdown","5642baf4":"markdown","539808c3":"markdown","3d2ecdb4":"markdown","a4b28d78":"markdown","e7552643":"markdown","d2dbe44d":"markdown","26705d48":"markdown","bc23718a":"markdown","12d4f6e7":"markdown","98ae3966":"markdown","3b6dd9e4":"markdown","63165956":"markdown","901c24f4":"markdown","e83b0fda":"markdown","89d89c7a":"markdown"},"source":{"33609b57":"import numpy as np\nnp.warnings.filterwarnings('ignore')\n\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\n%config InlineBackend.figure_format='retina'\nimport seaborn as sns\n\nimport pandas as pd\nimport re","776fc9f4":"plt.rcParams['axes.titlesize'] = 14\nplt.rcParams['axes.labelsize'] = 12","cf3d09ff":"df = pd.read_csv('..\/input\/22000-scotch-whisky-reviews\/scotch_review.csv', index_col = 0)\ndf.index = df.index - 1   #remove 1 so that the index starts from 0\n\nprint('This dataset has {} rows and {} columns.'.format(df.shape[0], df.shape[1]))\ndf.head()","edaa1154":"df.rename(columns = {'review.point': 'points'}, inplace = True)\ndf.columns","ab208007":"df.info()","9cd7c14f":"symbol_idx = pd.to_numeric(df['price'], errors = 'coerce').isnull() # errors = 'coerce' results in NaNs for non-numeric values\ndf[symbol_idx][['name','price']].head()","566bfab8":"df.at[[19, 95, 410, 1000, 1215], 'price'] = 15000   # instances with '60,000\/set' which equals 15000 dollars\ndf['price'].replace('\/liter', '', inplace = True, regex = True) # this bottle was actually 1 lt, so we don't need the price per litre\ndf['price'].replace(',', '', inplace = True, regex = True)\n\ndf['price'] = df['price'].astype('float')","51500bb0":"df['currency'].value_counts()","ad39edfc":"df.drop('currency', axis = 1, inplace = True)","a4ea3602":"df['price_p_points'] = df['price']\/df['points']\ndf.head()","9958db0f":"df['age'] = df['name'].str.extract(r'(\\d+) year')[0].astype(float) # extract age and convert to float\n\ndf['name'] = df['name'].str.replace(' ABV ', '')\ndf['alcohol%'] = df['name'].str.extract(r\"([\\(\\,\\,\\'\\\"\\\u2019\\\u201d\\$] ? ?\\d+(\\.\\d+)?%)\")[0]\ndf['alcohol%'] = df['alcohol%'].str.replace(\"[^\\d\\.]\", \"\").astype(float) # keep only numerics and convert to float\n\ndf[['name', 'age', 'alcohol%']].sample(10, random_state = 42)","d66e2930":"df[['age', 'alcohol%']].isnull().sum()","20b31ca7":"df.describe()","25407915":"attributes = ['price', 'points', 'age', 'alcohol%']  # price_p_points not that important\n\ndf[attributes].hist(figsize = (15, 10), color = 'firebrick');","11e08186":"df['category'].value_counts()","455a4dfd":"colors = ['#BB342F', '#EDAFB8', '#666A86', '#95B8D1', '#D1D0A3']\ncategories_index = df['category'].value_counts().index\n\nfig = plt.figure(figsize = (7, 4))\nsns.countplot(y = 'category', data = df, palette = colors, order = df['category'].value_counts().index)\n\n# include the percentage of each category next to each bar\nfor index, value in enumerate(df['category'].value_counts()):\n    label =  '{}%'.format(round( (value\/df['category'].shape[0])*100, 2)) \n    plt.annotate(label, xy = (value + 11, index + 0.1), color = colors[index])\n\nplt.title('Number of bottles by category (with percentages)')\nplt.ylabel('Category')\nplt.xlabel('Count');","b33973da":"fig, (ax1, ax2) = plt.subplots(1, 2, figsize = (13, 5))\n\nax1.set_title('Mean price by category')\nsns.barplot(x = 'price', y = 'category', data = df, order = categories_index, palette = colors, ax = ax1)\n\nax2.set_title('Mean points by category')\nsns.barplot(x = 'points', y = 'category', data = df, order = categories_index, palette = colors, ax = ax2)\nax2.set(yticklabels = [])\nax2.set_ylabel('')\nax2.set_xlim(80, 89);","ef79d81c":"fig, (ax1, ax2) = plt.subplots(1, 2, figsize = (15, 6))\n\nsns.boxplot(x = 'price', y = 'category', data = df, order = categories_index, palette = colors, showfliers = False, ax = ax1)\nsns.boxplot(x = 'points', y = 'category', data = df, order = categories_index, palette = colors, ax = ax2)\nax2.set(yticklabels = [])\nax2.set_ylabel('')\n\nplt.tight_layout();","8446a33e":"fig, (ax1, ax2) = plt.subplots(1, 2, figsize = (13, 5))\n\nax1.set_title('Mean age by category')\nsns.barplot(x = 'age', y = 'category', data = df, order = categories_index, palette = colors, ax = ax1)\n\nax2.set_title('Mean alcohol% by category')\nsns.barplot(x = 'alcohol%', y = 'category', data = df, order = categories_index, palette = colors, ax = ax2)\nax2.set(yticklabels = [])\nax2.set_ylabel('')\nax2.set_xlim(30, 55);","58bc25b2":"from wordcloud import WordCloud, STOPWORDS\n\ndef create_word_cloud(df, bg_color, max_words, mask, stop_words, max_font_size, colormap):\n    \n    wc = WordCloud(background_color = bg_color, max_words = max_words, mask = mask, stopwords = stop_words, max_font_size = max_font_size)\n    wc.generate(' '.join(df))\n    \n    return wc.recolor(colormap = colormap, random_state = 42)","dc157e07":"sm_df = df[df['category'] == 'Single Malt Scotch']['description'].values\nbd_df = df[df['category'] == 'Blended Scotch Whisky']['description'].values","1a3fe290":"from PIL import Image\nimport requests # https:\/\/stackoverflow.com\/questions\/12020657\/how-do-i-open-an-image-from-the-internet-in-pil\/12020860\n\nmask_sm = np.array(Image.open(requests.get('https:\/\/imgur.com\/dAYKIVT.png', stream = True).raw))  # mask for single malts\nmask_bd = np.array(Image.open(requests.get('https:\/\/imgur.com\/upL1TBW.png', stream = True).raw))  # mask for blended whiskies","ebdf04c8":"stop_words = list(STOPWORDS)\n\nfig, ax = plt.subplots(2, 1, figsize = (7, 14))\n\nax[0].imshow(create_word_cloud(df = sm_df, bg_color = 'white', max_words = 50, mask = mask_sm, stop_words = stop_words,\n                             max_font_size = 50, colormap = 'winter'), alpha = 1, interpolation = 'bilinear')\nax[0].set_title('Single Malts - Initial', size = 16, y = 1.06)\nax[0].axis('off')\n\nax[1].imshow(create_word_cloud(df = bd_df, bg_color = 'white', max_words = 50, mask = mask_bd, stop_words = stop_words,\n                             max_font_size = 50, colormap = 'tab10'), alpha = 1, interpolation = 'bilinear')\nax[1].set_title('Blended Whiskies - Initial', size = 16, y = 1.04)\nax[1].axis('off');","7301485f":"stop_words = ['whisky', 'whiskies', 'blend', 'note', 'notes', 'year', 'years', 'old', 'nose', 'finish', 'bottle',\n              'bottles', 'bottled', 'along', 'release', 'flavor', 'cask', 'well', 'make', 'mouth', 'palate', 'hint',\n              'one', 'bottling', 'distillery', 'quite', 'time', 'date', 'show', 'first'] + list(STOPWORDS)","f013a289":"fig, ax = plt.subplots(2, 1, figsize = (7, 14))\n\nax[0].imshow(create_word_cloud(df = sm_df, bg_color = 'white', max_words = 50, mask = mask_sm, stop_words = stop_words,\n                             max_font_size = 50, colormap = 'winter'), alpha = 1, interpolation = 'bilinear')\nax[0].set_title('Single Malts - Improved', size = 16, y = 1.06)\nax[0].axis('off')\n\nax[1].imshow(create_word_cloud(df = bd_df, bg_color = 'white', max_words = 50, mask = mask_bd, stop_words = stop_words,\n                             max_font_size = 50, colormap = 'tab10'), alpha = 1, interpolation = 'bilinear')\nax[1].set_title('Blended Whiskies - Improved', size = 16, y = 1.04)\nax[1].axis('off');","dcb1cf1d":"df.sort_values(by = 'price', ascending = False).head()","509924ff":"df.sort_values(by = 'price', ascending = True).head()","e6677874":"df.sort_values(by = 'points', ascending = False).head()","508c493a":"df.sort_values(by = 'price_p_points', ascending = True).head()","c1b8962b":"df[(df['points'] > 85) & (df['price'] < 50)].sort_values(by = 'points', ascending = False).head()","4a368f9e":"df.sort_values(by = 'age', ascending = False).head()","5510d055":"df.sort_values(by = 'alcohol%', ascending = False).head()","93d89819":"Diamond Jubilee comes first with a price of 157,000 dollars. Interestingly, it is almost 100,000 dollars more expensive than the second whisky of this list, Dalmore 50 year old. Bowmore distillery has two bottles in the top5 list.\n\n<img src=\"https:\/\/imgur.com\/I1XgFOb.jpg\" width=\"500\">\n<center>Photo taken from www.couturing.com<\/center>","715b328a":"# Scotch Whisky Reviews - Basic Exploratory Data Analysis \ud83e\udd43\ud83e\udd43\n\n<img src = \"https:\/\/imgur.com\/DAbTcgV.jpg\" width=\"500\">\n\n<center>Original photo by Josh Applegate (Unsplash)<\/center>\n\n**Table of Contents**\n\n1. [Introduction](#Introduction)\n2. [Dataset](#Dataset)\n3. [Loading and Processing Data](#Loading-and-Processing-Data)\n4. [Exploratory Data Analysis](#Exploratory-Data-Analysis)\n5. [Trivia](#Trivia)\n6. [Conclusions](#Conclusions)","1be320d3":"The meaning of each column is the following:\n\n- **name**: Name of the bottle,\n- **category**: Its category,\n- **review.point**: Points marked by each reviewer,\n- **price**: Price of the bottle,\n- **currency**: Unit of price, and\n- **description**: Descriptions of reviews.\n\nWe can rename the 'review.point' attribute to just 'points':","48e90239":"---\n\n### Description Attribute\n\nWe can analyse the 'description' columns by using word clouds.\n\nFor this purpsose, we need a package called `word_cloud` which was developed by **Andreas Mueller** ([link](https:\/\/github.com\/amueller\/word_cloud\/)). For simplicity, we are going to analyse only the two most common categories, Single Matls and Blended Whiskies.","898e6ebc":"There are only five categories of whiskies in our dataset. Let's use a bar plot to visualise how many instances belong to each category:","20816ff1":"Carlyle 40% is a bargain since you can enjoy a total of 88 points for only 13 dollars.\n\n5) What's the best bottle for under 50 dollars?","57e9c152":"7) What's the most alcoholic bottle?","1cf48057":"Adelphi 7 year old contains more than 66% alcohol! Interestigly, the other bottles in the top five list don't have less than 64% alcohol.","d7b8b3ed":"Therefore, the most common tastes for Single Malts are \u2018vanilla\u2019, \u2018fruit\u2019, \u2018spice\u2019, \u2018ginger\u2019 etc, while for Blended whiskies they are \u2018spice\u2019, \u2018vanilla\u2019, \u2018toffee\u2019, \u2018fruit, \u2018honey\u2019, \u2018orange\u2019 etc.","2ed73289":"The Gordon & MacPhail Generations: Glenlivet is the oldest bottle with an age of 70, and exceeds the second oldest bottle by 10 years.","a0195c84":"<img src=\"https:\/\/imgur.com\/SlOK0IE.png\" width=\"400\">\n<center>Photo taken from www.thewhiskyworld.com<\/center>","83548898":"However, words such as whisky, palate, note etc. aren't really informative. So let's add them our stopwords and re-generate the cloud:","dd1367c6":"Our method is accurate. Some bottles do not have the number of years in their name, hence the NaN values. Let's check the number of missing values for our new attributes:","325518d5":"We will discuss the extremes (max, min) of each attribute later. Apart from that, the most important points to note are:\n\n- For the 'price' attribute, the mean is more than 550 dollars, while its median is only 110.\n- The age starts from 3 years, which is the minimum maturation time before a spirit can be called (Scotch) whisky ([Source](https:\/\/scotchwhisky.com\/magazine\/ask-the-professor\/8033\/whisky-and-maturity-why-three-years\/)),\n- Alcohol content starts from 40% which is minimum percentage for a (Scotch) whisky according to Scotish regulations ([Source](https:\/\/flaviar.com\/blog\/alcohol-content-in-whisky))\n\nThe last two points prove that we successfully extracted the age and alcohol content. \n\nWe can quickly visualise these information by plotting a histogram for each numerical value:","32ee1d5a":"## Trivia\n\nNow we can answer some interesting questions:\n\n1) What's the most expensive whisky bottle?","93200273":"Single Grain and Grain whiskies are the oldest and most alchoholic bottles of our dataset compared to the other three categories..","23fa804a":"---\n\n### Whisky Categories\n\n","b6f98122":"6) What's the oldest bottle?","57a61b30":"Thankfully there are no missing values in our dataset. \n\nThere five categorical attributes and one numeric. The 'price' column should be numeric, so we can change by using the `astype()` method. However, this will yield an error if we try it because because some features contain symbols such as commas, '\/set', etc. We can easily confirm this:","56ceb2a3":"### New Attributes\n\n#### Price per Points\n\nWe can calculate the price to points ratio:","1489430e":"Three whiskies almost touch perfection, scoring 97 point! The most affordable of the three is Johnnie Walker Blue Label.\n\n<img src=\"https:\/\/imgur.com\/W1KANyR.png\" width=\"300\">\n<center>Photo taken from www.thewhiskyexchange.com<\/center>\n\n4) Which whisky give the best value for money?","fa6728ac":"2) What's the least expensive whisky bottle?","583cc6a7":"I could write a function to automatically change these values, but since there aren't that many I have decided to change them manually:","64548f3d":"### Missing Values and Type Conversions\n\nThe `info()` method can give us valuable information such as the number of missing values and the type of each attribute:","5642baf4":"- The error bar for Blended whiskies is quite big, so we should probably not draw any conclusions using the mean (we could try the median of each category - see boxplot).\n- On average, Blended Malt whiskies score higher with Blended whiskies following closely.\n\nWe can use Seaborn's `boxplot()` to visualize the distribution of values for 'price' and 'points' (we have to remove outliers for 'price'):","539808c3":"## Dataset\n\nThe dataset includes information about more than 2200 whisky bottles from Scotland and was uploaded by [thatdataanalyst](https:\/\/www.kaggle.com\/koki25ando) on kaggle. The dataset was scraped from the website [Whisky Advocate](https:\/\/www.whiskyadvocate.com\/).","3d2ecdb4":"There is only one, therefore we can delete it since it doesn't give any extra information:","a4b28d78":"<img src=\"https:\/\/imgur.com\/bavhilf.png\" width=\"300\">\n<center>Photo taken from www.thewhiskyexchange.com<\/center>","e7552643":"#### Age and Alcohol Percentage\n\nFinally, the 'name' column sometimes contains useful information such as the age and the alcohol percentage of each bottle. We can extract those using regular expressions:","d2dbe44d":"- More than 80% of all whiskies in our dataset are Single Malts,\n- Blended whisky and Blended Malt whisky come second and third, corresponding to approximately 9% and 6% of the dataset, respectively, and\n- Single Grain and Grain whisky combined correspond to less than 4% of the dataset.\n\nNow, let's compare their (mean) price and points:","26705d48":"Monarch of the Glen is cheapest option with a price of only 12 dollars. \n\n<img src=\"https:\/\/imgur.com\/AZ1AxYI.png\" width=\"300\">\n<center>Photo taken from www.sortitapps.com<\/center>\n\n3) What's the best reviewed bottle? ","bc23718a":"## Introduction\n\nWhisky (or whiskey) is a type of distilled alcoholic beverage made from just three natural ingedients - barley, water and yeast. Whisky is distilled throughout the world, most popularly in Scotland, Ireland, the United States, and Japan. It comes in many styles and some countries have strict regulations regarding its production. For instance, a whisky can be classified as 'Scotch' if it is distilled and matured in Scotland for at least three years and bottled at a minimum alcoholic strength of 40% ABV ([Source](https:\/\/www.scotch-whisky.org.uk\/discover\/enjoying-scotch\/scotch-whisky-categories\/)).\n\nWhether it's Scotch, Irish, Japanese or bourbon, whisky is the most popular drink in the word and can be enjoyed on its own or be used in cocktails. You can read more [here](https:\/\/www.thespruceeats.com\/history-of-whisky-1807685).\n\n<br><br>\n\n**This notebooks** explores a dataset containing reviews of different bottles of Scotch whisky (simply whisky from now on). Specifically, we will:\n\n- gain insights on their price, age, alcohol percentage etc.,\n- compare different categories, \n- study the reviews given to each category, and\n- answer some interesting questions such as 'which is the most expensive bottle?' or 'which bottle is the best bargain?'.","12d4f6e7":"### Currency\n\nWe can check if there are more than one currencies in our dataset:","98ae3966":"We observe that:\n\n- Blended and Blended malt whiskies have a similar median price which is approximately 50 dollars lower than the rest of the categories,\n- The median points have a small range of values: from 86 (Single Grain) to 88 (Blended Malts),\n- The boxplot for 'price' has a positive skew (median is closer to the bottom of the box) for all categories, and\n- The distribution of 'points' resembles more a normal distribution.\n\nWe can perform a similar analysis for the 'age' and 'alcohol%':","3b6dd9e4":"<img src=\"https:\/\/imgur.com\/9PxAcg3.png\" width=\"300\">\n<center>Photo taken from www.whiskyauctioneer.com<\/center>","63165956":"## Conclusions\n\nIn this notebook, we used a dataset containing reviews for more than 2K whisky bottles, to discover useful and interesting facts related to the world of Scottish whisky. The most important things to remember are:\n- There are five categories of whisky: Single malts, Blended whiskies, Blended malts, Single Grain whiskies and Grain whiskies. The most common category in our dataset is Single malts,\n- Blended Malt whiskies receive a higher score on average,\n- Single Grain and Grain whiskies have on average a higher age and alcohol content,\n- World clouds can help us visualize (and summarise) the descriptions given for each whisky category, and\n- The `sort_values()` method allows us to look at the \u2018extremes\u2019, and answer questions such as \u2018what's the most expensive bottle?\u2019, \u2018what's the most alcoholic bottle\u2019 etc.\n","901c24f4":"<br>\n\n## Exploratory Data Analysis\n\nWe can use the `describe()` method to get a (statistical) overview of the numerical attributes:","e83b0fda":"The package also allows us to superimpose the cloud onto a mask of any shape. In our case, the masks are going to be the flag of Scotland and a whisky bottle.\n\nLet's import the two png images:","89d89c7a":"## Loading and Processing Data\n\nWe start by importing the data into a Pandas DataFrame and looking at the top five rows using the `head()` method:"}}