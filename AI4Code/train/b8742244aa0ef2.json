{"cell_type":{"7dcff622":"code","b7c478ac":"code","48b8473a":"code","75ee44d8":"code","ffdd102f":"code","bced5e76":"code","9ba1f1ad":"code","c60922ee":"code","4a470da7":"code","04adc3e0":"code","a573f27b":"code","8c78a406":"code","bd53a799":"code","d5196862":"code","92e74a14":"code","63faaf5b":"code","5687afbd":"code","0a1d1bdc":"code","4004b6a5":"code","79fd79ff":"code","0502502a":"code","dca4580e":"markdown","8c517ab2":"markdown","a370d1f0":"markdown","99cb73fd":"markdown","0084c05f":"markdown","33b0648c":"markdown","7e601dbe":"markdown","8b91caaf":"markdown","a1f9b0d0":"markdown","be11d8b2":"markdown","612dfe59":"markdown","c7b50bab":"markdown","73087811":"markdown","ddb55f21":"markdown","f31b86bc":"markdown","eed884c6":"markdown","af13a844":"markdown","18546fa9":"markdown","a948dc6d":"markdown","d21c0748":"markdown","e2b885a8":"markdown","c020d92c":"markdown","b2f47c2d":"markdown","18e28f47":"markdown","88c69271":"markdown","016b1e32":"markdown","e1bdc684":"markdown","fb882bb0":"markdown","abb75efb":"markdown","6391d494":"markdown","9a6e5d95":"markdown","86a3197b":"markdown","8ebacb1c":"markdown","8283933c":"markdown","0bf24e35":"markdown","45233be7":"markdown","94a4d761":"markdown","11473e29":"markdown"},"source":{"7dcff622":"import numpy as np\nimport pandas as pd\nimport pydicom\nimport cv2\nimport os\nimport matplotlib.pyplot as plt\nimport seaborn as sns","b7c478ac":"input_folder = '..\/input\/rsna-intracranial-hemorrhage-detection\/'","48b8473a":"path_train_img = input_folder + 'stage_1_train_images\/'\npath_test_img = input_folder + 'stage_1_test_images\/'","75ee44d8":"train_df = pd.read_csv(input_folder + 'stage_1_train.csv')\ntrain_df.head()","ffdd102f":"# extract subtype\ntrain_df['sub_type'] = train_df['ID'].apply(lambda x: x.split('_')[-1])\n# extract filename\ntrain_df['file_name'] = train_df['ID'].apply(lambda x: '_'.join(x.split('_')[:2]) + '.dcm')\ntrain_df.head()","bced5e76":"train_df.shape","9ba1f1ad":"print(\"Number of train images availabe:\", len(os.listdir(path_train_img)))","c60922ee":"train_df[train_df['sub_type'] == 'epidural']['Label'].value_counts()","4a470da7":"sns.countplot(x='Label', data=train_df[train_df['sub_type'] == 'epidural'])\nplt.show()","04adc3e0":"train_df[train_df['sub_type'] == 'intraparenchymal']['Label'].value_counts()","a573f27b":"sns.countplot(x='Label', data=train_df[train_df['sub_type'] == 'intraparenchymal'])\nplt.show()","8c78a406":"train_df[train_df['sub_type'] == 'intraventricular']['Label'].value_counts()","bd53a799":"sns.countplot(x='Label', data=train_df[train_df['sub_type'] == 'intraventricular'])\nplt.show()","d5196862":"train_df[train_df['sub_type'] == 'subarachnoid']['Label'].value_counts()","92e74a14":"sns.countplot(x='Label', data=train_df[train_df['sub_type'] == 'subarachnoid'])\nplt.show()","63faaf5b":"train_df[train_df['sub_type'] == 'subdural']['Label'].value_counts()","5687afbd":"sns.countplot(x='Label', data=train_df[train_df['sub_type'] == 'subdural'])\nplt.show()","0a1d1bdc":"train_df[train_df['sub_type'] == 'any']['Label'].value_counts()","4004b6a5":"sns.countplot(x='Label', data=train_df[train_df['sub_type'] == 'any'])\nplt.show()","79fd79ff":"train_final_df = pd.pivot_table(train_df.drop(columns='ID'), index=\"file_name\", \\\n                                columns=\"sub_type\", values=\"Label\")\ntrain_final_df.head()","0502502a":"plt.figure(figsize=(16, 6))\n\ngraph = sns.countplot(x=\"sub_type\", hue=\"Label\", data=(train_df))\ngraph.set_xticklabels(graph.get_xticklabels(),rotation=90)\nplt.show()","dca4580e":"Intraparenchymal hemorrhage (IPH) is one form of intracerebral bleeding in which there is bleeding within brain parenchyma. The other form is intraventricular hemorrhage (IVH). Intraparenchymal hemorrhage accounts for approx. 8-13% of all strokes and results from a wide spectrum of disorders.","8c517ab2":"A hematoma is a collection of blood, in a clot or ball, outside of a blood vessel. An epidural hematoma occurs when blood accumulates between your skull and the outermost covering of your brain.\n\nIt typically follows a head injury, and usually with a skull fracture. High-pressure bleeding is a prominent feature. If you have an epidural hematoma, you may briefly lose consciousness and then regain consciousness.\n\nSource: https:\/\/www.healthline.com\/health\/extradural-hemorrhage#type","a370d1f0":"### 1. Epidural","99cb73fd":"<img src=\"https:\/\/www.technology.org\/texorgwp\/wp-content\/uploads\/2019\/09\/Intracerebral_hemorrhage.jpg\"  style=\"height:30%;width:50%\"\/>","0084c05f":"<b>Competition Overview<\/b><br\/><br\/>\nIntracranial hemorrhage, bleeding that occurs inside the cranium, is a serious health problem requiring rapid and often intensive medical treatment. For example, intracranial hemorrhages account for approximately 10% of strokes in the U.S., where stroke is the fifth-leading cause of death. Identifying the location and type of any hemorrhage present is a critical step in treating the patient.\n\nDiagnosis requires an urgent procedure. When a patient shows acute neurological symptoms such as severe headache or loss of consciousness, highly trained specialists review medical images of the patient\u2019s cranium to look for the presence, location and type of hemorrhage. The process is complicated and often time consuming.","33b0648c":"### Any","7e601dbe":"<img src=\"https:\/\/www.nejm.org\/na101\/home\/literatum\/publisher\/mms\/journals\/content\/nejm\/2017\/nejm_2017.377.issue-3\/nejmcp1605827\/20180122\/images\/img_medium\/nejmcp1605827_f2.jpeg\" style=\"width:25%;height:25%\"\/>","8b91caaf":"# RSNA Intracranial Hemorrhage Detection ","a1f9b0d0":"<img src=\"https:\/\/cdn.britannica.com\/51\/193251-050-E254065D\/CT-scan-brain-hematoma.jpg\" style=\"width:25%;height:25%\"\/>","be11d8b2":"### Subdural","612dfe59":"### 4. Subarachnoid","c7b50bab":"**Comments**<br\/><br\/>\nFor intraparenchymal sub type we have 6,50,496 images labeled as 0 and 23,766 labelled as 1.","73087811":"Intraventricular hemorrhage (IVH), also known as intraventricular bleeding, is a bleeding into the brain's ventricular system, where the cerebrospinal fluid is produced and circulates through towards the subarachnoid space. It can result from physical trauma or from hemorrhaging in stroke.","ddb55f21":"A subdural hemorrhage (or hematoma) is a type of bleeding that often occurs outside the brain as a result of a severe head injury. It takes place when blood vessels burst between the brain and the leather-like membrane that wraps around the brain (the dura mater).","f31b86bc":"Subarachnoid hemorrhage (SAH) is a life-threatening type of stroke caused by bleeding into the space surrounding the brain. SAH can be caused by a ruptured aneurysm, AVM, or head injury. One-third of patients will survive with good recovery; one-third will survive with a disability; and one-third will die. Treatment focuses on stopping the bleeding, restoring normal blood flow, and preventing vasospasm.","eed884c6":"### Loading Data","af13a844":"<img src='https:\/\/prod-images.static.radiopaedia.org\/images\/12380293\/17abfd31d98cfe599e44fe3053db9e_thumb.jpg' \/>","18546fa9":"### 2. Intraparenchymal","a948dc6d":"### Intraparenchymal","d21c0748":"### Basic EDA","e2b885a8":"### 5. Subdural","c020d92c":"### Intraventricular","b2f47c2d":"### Final Dataset","18e28f47":"<b>What am i predicting?<\/b><br\/><br\/>\nIn this competition our goal is to predict intracranial hemorrhage and its subtypes. Given an image the we need to predict probablity of each subtype. This indicates its a multilabel classification problem.","88c69271":"### 3. Intraventricular","016b1e32":"<b>Types<\/b>\n<br\/>\n1. Epidural\n2. Intraparenchymal    \n3. Intraventricular\n4. Subarachnoid \n5. Subdural\n6. Any","e1bdc684":"<b>Note<\/b>\nA nice video explaining all the types can be found [here](https:\/\/www.youtube.com\/watch?v=Kb_wzb7-rvE). ","fb882bb0":"<img src=\"https:\/\/upload.wikimedia.org\/wikipedia\/commons\/thumb\/e\/ed\/Mri041a2.jpg\/220px-Mri041a2.jpg\" \/>","abb75efb":"**Comments**<br\/><br\/>\nFor subarachnoid sub type we have 6,42,140 images labeled as 0 and 32,122 labelled as 1.","6391d494":"**Comments**<br\/><br\/>\nFor intraparenchymal sub type we have 6,41,698 images labeled as 0 and 32,564 labelled as 1.","9a6e5d95":"### Epidural","86a3197b":"**Comments**<br\/><br\/>\nFor Subdural sub type we have 6,31,766 images labeled as 0 and 42,496 labelled as 1.","8ebacb1c":"**Comments**<br\/><br\/>\nFor epidural sub type we have 6,71,501 images labeled as 0 and 2,761 labelled as 1.","8283933c":"**Comments**<br\/><br\/>\nFor any sub type we have 5,77,159 images labeled as 0 and 97,103 labelled as 1.","0bf24e35":"### Subarachnoid","45233be7":"An intracranial hemorrhage is a type of bleeding that occurs inside the skull. Symptoms include sudden tingling, weakness, numbness, paralysis, severe headache, difficulty with swallowing or vision, loss of balance or coordination, difficulty understanding, speaking , reading, or writing, and a change in level of consciousness or alertness, marked by stupor, lethargy, sleepiness, or coma. Any type of bleeding inside the skull or brain is a medical emergency. It is important to get the person to a hospital emergency room immediately to determine the cause of the bleeding and begin medical treatment.","94a4d761":"<b>Intracranial Hemorrhage<\/b>","11473e29":"<img src=\"https:\/\/upload.wikimedia.org\/wikipedia\/commons\/f\/f9\/EpiduralHematoma.jpg\" style='width:20%;height:20%'\/>"}}