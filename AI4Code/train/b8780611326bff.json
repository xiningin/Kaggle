{"cell_type":{"072c77cf":"code","2c26732e":"code","6b183b3e":"code","43727421":"code","81613014":"code","a0c43221":"code","8c08dedf":"code","e4f7d2ed":"code","6fab920d":"code","1b4ce9eb":"code","ed0a86c7":"code","65272f5d":"code","383bce53":"code","fe2572f9":"code","de9350a7":"code","553abc98":"code","d978092c":"code","7b267e10":"code","6c47730a":"code","2fad6366":"code","adc3deb2":"code","9f21dde0":"code","c23f2cd3":"code","bd686897":"code","6cef1bcb":"markdown","2ab0d823":"markdown","0a116511":"markdown","7792e9c7":"markdown","27f0fc39":"markdown","bab2f2c1":"markdown","a3fe13c4":"markdown","ae178b8d":"markdown","35ee3053":"markdown"},"source":{"072c77cf":"import pandas as pd\nimport numpy as np\nfrom IPython.display import clear_output\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_absolute_error","2c26732e":"data=pd.read_csv('..\/input\/predict-volcanic-eruptions-ingv-oe\/train.csv')","6b183b3e":"data.head()","43727421":"l=len(data.segment_id)\nX=[]\ncount=0\nfor i in data.segment_id:\n    clear_output(wait=True)\n    df=pd.read_csv('..\/input\/predict-volcanic-eruptions-ingv-oe\/train\/'+str(i)+'.csv')\n    df=df.fillna(0)\n    X.append(df.mean().values)\n    count+=1\n    print('The current progress :',\"{:.2f}\".format(count*100\/l),' %')","81613014":"np.save('Volcanid_main_data.py',X)","a0c43221":"y=data['time_to_eruption'].values","8c08dedf":"X=np.array(X)","e4f7d2ed":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=4)","6fab920d":"model=LinearRegression()","1b4ce9eb":"model.fit(X_train,y_train)","ed0a86c7":"X_train.shape","65272f5d":"print('The error in the data is :',mean_absolute_error(model.predict(X_test),y_test))","383bce53":"from sklearn.cross_decomposition import PLSRegression","fe2572f9":"model2=PLSRegression(n_components=1,tol= 0.0005009294958980265)","de9350a7":"model2.fit(X_train,y_train)","553abc98":"print('The error of this model is :',mean_absolute_error(model2.predict(X_test),y_test))","d978092c":"import os","7b267e10":"count=0\nl=len(os.listdir('..\/input\/predict-volcanic-eruptions-ingv-oe\/test'))\ntest=[]\nfor i in os.listdir('..\/input\/predict-volcanic-eruptions-ingv-oe\/test'):\n    clear_output(wait=True)\n    df=pd.read_csv('..\/input\/predict-volcanic-eruptions-ingv-oe\/test\/'+i)\n    df=df.fillna(0)\n    test.append(df.mean().values)\n    count+=1\n    print('The current progress :',\"{:.2f}\".format(count*100\/l),' %')\n    ","6c47730a":"test=np.array(test)","2fad6366":"sample=pd.read_csv('..\/input\/predict-volcanic-eruptions-ingv-oe\/sample_submission.csv')","adc3deb2":"sample.head()","9f21dde0":"names=os.listdir('..\/input\/predict-volcanic-eruptions-ingv-oe\/test')\nfor i in range(len(names)):\n    names[i]=names[i].split('.')[0]","c23f2cd3":"predictions=model2.predict(test)\nsubmission=pd.DataFrame()\nsubmission['segment_id']=names\nsubmission['time_to_eruption']=predictions\nsubmission=submission.sort_values(by=['segment_id'])\nsubmission.to_csv('.\/AnswerPart1.csv')","bd686897":"submission.head()","6cef1bcb":"## Importing the data","2ab0d823":"# Importing The Packages ","0a116511":"Error of this model is lower than the error of the simple linear regression model as we can see","7792e9c7":"This data has the most of the features like mean , std , min ,max etc of all the sensors","27f0fc39":"## Getting the test data from the test folder","bab2f2c1":"### Having a look at the data","a3fe13c4":"## Predicting the estimate time to eruption and conv","ae178b8d":"### Code to get some standard data instead of all the data","35ee3053":"Also added the progress calculator"}}