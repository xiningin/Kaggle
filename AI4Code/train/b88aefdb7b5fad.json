{"cell_type":{"dd96214c":"code","4394ddf5":"code","af29f2a1":"code","44cb2634":"code","97f90892":"code","36d50c91":"code","8a9f157e":"code","4cbfdda3":"code","59d67b54":"code","c7e8afb6":"code","17669a13":"code","65bfda28":"code","b2f4722f":"code","43a7785c":"code","291010e0":"code","c20b0635":"code","37c7620b":"code","d073afb7":"code","2095dee8":"code","7302ed83":"code","b6c12372":"code","a584e632":"code","56f51862":"code","2fe4650b":"code","10ba2ca9":"markdown","4ed1e333":"markdown"},"source":{"dd96214c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns # for aesthetic visualization \nimport pandasql.sqldf as pdsql  # to execute SQL queries on DataFrame\nimport matplotlib.pyplot as plt # for basic visualization\n\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","4394ddf5":"pima_data = pd.read_csv('\/kaggle\/input\/pima-indians-diabetes-database\/diabetes.csv')","af29f2a1":"pima_data.head()","44cb2634":"pima_data.shape","97f90892":"#Checking the datatypes of the columns\n#So every column is numerical type\npima_data.dtypes","36d50c91":"#Checking if there are any null values\npima_data.isnull().sum()","8a9f157e":"#Lets check the number of healthy people and patients in the data set\n\n#Using Bar plot\nfig = plt.figure(figsize = (10,5))\nax1 = fig.add_subplot(121)\nsns.barplot(data = pima_data,x='Outcome',y=pima_data.index)\n\n#Using pie chart\nax2 = fig.add_subplot(122)\noutcome_count = pdsql('SELECT COUNT(Outcome) as count FROM pima_data GROUP BY Outcome')\nplt.pie(outcome_count['count'],\n        explode = (0,0),labels =['Healthy ','Diabetic'],\n        autopct='%1.1f%%',\n        shadow =True)","4cbfdda3":"#We will separate the details of a patient and healthy \npima_patient = pdsql('SELECT * FROM pima_data where Outcome =1')\npima_healthy = pdsql('SELECT * FROM pima_data where Outcome =0')","59d67b54":"# From the defination above we can that a diabetic patient will have blood sugar(In our cas Glucose) levels\n# and low Insulin level and the opposite for healthy patients.\n# Lets see if the data also derives the same or not.","c7e8afb6":"# Form the distribution of glucose levels we can see that diabetic patients have \n# higher range of glucose levels and healthy patients have lower range of glucose levels.\n# This shows that the data strongly satisfies with defination\n# we got earlier.\n#We can also see that Glucose levels are zero.These samples has to be\n#errornous samples.\n\nfig = plt.figure(figsize = (16,8))\nfig.suptitle('Distribution of glucose levels')\n\nax1 =fig.add_subplot(221) \nsns.distplot(pima_patient['Glucose'], label = 'Diabetic')\nsns.distplot(pima_healthy['Glucose'], label = 'Healthy')\nax1.set_xlabel('Glucose level')\n\n\nax2 = fig.add_subplot(222) \nsns.boxplot(data= pima_data, x='Glucose',y='Outcome',ax= ax2,orient = 'h')\nax2.set_xlabel('Glucose level')\n\nax3 = fig.add_subplot(223) \nsns.swarmplot(data =pima_data,x='Outcome',y='Glucose',ax=ax3)\n\nax4 = fig.add_subplot(224) \nglu_data= pdsql(\"SELECT Glucose, count(Glucose) as Count FROM pima_data GROUP BY Glucose limit 20\")\nsns.barplot(data = glu_data,x='Glucose',y= 'Count',ax=ax4)\n\nfig.tight_layout(pad=4.0)","17669a13":"#Through the plots we can see that Insulin levels are zero and in negative numbers.\n#These examples has to be errornous samples for sure.\nfig = plt.figure(figsize = (16,8))\nfig.suptitle('Distribution of Insulin levels')\n\nax1 =fig.add_subplot(221) \nsns.distplot(pima_patient['Insulin'], label = 'Diabetic')\nsns.distplot(pima_healthy['Insulin'], label = 'Healthy')\nax1.set_xlabel('Insulin level')\n\nax2 = fig.add_subplot(222) \nsns.boxplot(data= pima_data, x='Insulin',y='Outcome',ax= ax2,orient = 'h')\nax2.set_xlabel('Insulin level')\n\nax3 = fig.add_subplot(223) \nsns.swarmplot(data =pima_data,x='Outcome',y='Insulin',ax=ax3)\n\nax4 = fig.add_subplot(224) \ninsu_data= pdsql(\"SELECT Insulin, count(Insulin) as Count FROM pima_data GROUP BY Insulin limit 20\")\nsns.barplot(data = insu_data,x='Insulin',y= 'Count',ax=ax4)\n\nfig.tight_layout(pad=4.0)","65bfda28":"#Here through plot we can see that a max preganices by any patient\n#is 17.\nfig = plt.figure(figsize = (12,8))\nfig.suptitle('Distribution of Pregnancies')\n\nax1 =fig.add_subplot(221) \nsns.distplot(pima_patient['Pregnancies'], label = 'Diabetic')\nsns.distplot(pima_healthy['Pregnancies'], label = 'Healthy')\nax1.set_xlabel('Pregnancies')\n\n\nax2 = fig.add_subplot(222) \nsns.boxplot(data= pima_data, x='Pregnancies',y='Outcome',ax= ax2,orient = 'h')\nax2.set_xlabel('Pregnancies')\n\nax3 = fig.add_subplot(223) \nsns.swarmplot(data =pima_data,x='Outcome',y='Pregnancies',ax=ax3)\n\nax4 = fig.add_subplot(224) \npreg_data= pdsql(\"SELECT Pregnancies, count(Pregnancies) as Count FROM pima_data GROUP BY Pregnancies\")\nsns.barplot(data = preg_data,x='Pregnancies',y= 'Count',ax=ax4)\n\nfig.tight_layout(pad=4.0)","b2f4722f":"#Lets do further analyis of Preganacies\n#Through plot we can see that  for few sample at age \n#of twenty they are having 4,6 and 8 Preganacies\nsns.scatterplot(data = pima_data,x='Pregnancies',y='Age')","43a7785c":"# Blood pressure is the force of your blood pushing against the walls of your arteries .\n#In few Blood pressure is given as zero which cannot true.These samples can also said as errornous\n\nfig = plt.figure(figsize = (14,8))\nfig.suptitle('Distribution of BloodPressure levels')\n\nax1 =fig.add_subplot(221) \nsns.distplot(pima_patient['BloodPressure'], label = 'Diabetic')\nsns.distplot(pima_healthy['BloodPressure'], label = 'Healthy')\nax1.set_xlabel('BloodPressure')\n\n\nax2 = fig.add_subplot(222) \nsns.boxplot(data= pima_data, x='BloodPressure',y='Outcome',ax= ax2,orient = 'h')\nax2.set_xlabel('BloodPressure')\n\nax3 = fig.add_subplot(223) \nsns.swarmplot(data =pima_data,x='Outcome',y='BloodPressure',ax=ax3)\n\nax4 = fig.add_subplot(224) \nbp_data= pdsql(\"SELECT BloodPressure, count(BloodPressure) as Count FROM pima_data GROUP BY BloodPressure LIMIT 20\")\nsns.barplot(data = bp_data.sort_values(by= 'BloodPressure'),x='BloodPressure',y= 'Count',ax=ax4)\n\nfig.tight_layout(pad=4.0)","291010e0":"#Here SkinThickness is Triceps skin fold thickness (mm).In few samples\n#thickness is given as zero.These samples can also said as errornous\nfig = plt.figure(figsize = (14,8))\nfig.suptitle('Distribution of SkinThickness')\n\nax1 =fig.add_subplot(221) \nsns.distplot(pima_patient['SkinThickness'], label = 'Diabetic')\nsns.distplot(pima_healthy['SkinThickness'], label = 'Healthy')\nax1.set_xlabel('SkinThickness')\n\n\nax2 = fig.add_subplot(222) \nsns.boxplot(data= pima_data, x='SkinThickness',y='Outcome',ax= ax2,orient = 'h')\nax2.set_xlabel('SkinThickness')\n\nax3 = fig.add_subplot(223) \nsns.swarmplot(data =pima_data,x='Outcome',y='SkinThickness',ax=ax3)\n\n\nax4 = fig.add_subplot(224) \nst_data= pdsql(\"SELECT SkinThickness, count(SkinThickness) as Count FROM pima_data GROUP BY SkinThickness LIMIT 20\")\nsns.barplot(data = st_data.sort_values(by= 'SkinThickness'),x='SkinThickness',y= 'Count',ax=ax4)\n\n\nfig.tight_layout(pad=4.0)","c20b0635":"#From the above defination we can atleast be sure that BMI can cannot be zero.\n#As in the plots we can there few examples where BMI is zero and 60,70.We can say these erroneous\n#samples\nfig = plt.figure(figsize = (14,8))\nfig.suptitle('Distribution of BMI')\n\nax1 =fig.add_subplot(221) \nsns.distplot(pima_patient['BMI'], label = 'Diabetic')\nsns.distplot(pima_healthy['BMI'], label = 'Healthy')\nax1.set_xlabel('BMI')\n\n\nax2 = fig.add_subplot(222) \nsns.boxplot(data= pima_data, x='BMI',y='Outcome',ax= ax2,orient = 'h')\nax2.set_xlabel('BMI')\n\nax3 = fig.add_subplot(223) \nsns.swarmplot(data =pima_data,x='Outcome',y='BMI',ax=ax3)\n\nax4 = fig.add_subplot(224) \nbmi_data= pdsql(\"SELECT BMI, count(BMI) as Count FROM pima_data GROUP BY BMI LIMIT 20\")\nsns.barplot(data = bmi_data.sort_values(by= 'BMI'),x='BMI',y= 'Count',ax=ax4)\n\n\nfig.tight_layout(pad=4.0)","37c7620b":"#Subjects used in the dataset all are above Age 20\n#The plots also shows that most of the subject lie between Age band of 20-40\nfig = plt.figure(figsize = (14,8))\nfig.suptitle('Distribution of Age')\n\nax1 =fig.add_subplot(221) \nsns.distplot(pima_patient['Age'], label = 'Diabetic')\nsns.distplot(pima_healthy['Age'], label = 'Healthy')\nax1.set_xlabel('Age')\n\n\nax2 = fig.add_subplot(222) \nsns.boxplot(data= pima_data, x='Age',y='Outcome',ax= ax2,orient = 'h')\nax2.set_xlabel('Age')\n\nax3 = fig.add_subplot(223) \nsns.swarmplot(data =pima_data,x='Outcome',y='Age',ax=ax3)\n\n\nax4 = fig.add_subplot(224) \nage_data= pdsql(\"SELECT Age, count(Age) as Count FROM pima_data GROUP BY Age LIMIT 20\")\nsns.barplot(data = age_data.sort_values(by= 'Age'),x='Age',y= 'Count',ax=ax4)\n\nfig.tight_layout(pad=4.0)","d073afb7":"err_col=['Glucose','Insulin','BloodPressure','SkinThickness','BMI']\nfor col in err_col: \n    pima_patient[col] = pima_patient[col].replace({0:pima_patient[col].mean()})\n    pima_healthy[col] = pima_healthy[col].replace({0:pima_healthy[col].mean()})\ncorrect_pima_data = pd.concat([pima_patient,pima_healthy])","2095dee8":"#These plots throws some light on what are average values of 'Glucose','Insulin','BloodPressure','SkinThickness','BMI'\n#wrt to Diabetic and healthy\nfig = plt.figure(figsize= (12,12))\n\ni =320\nfor col in err_col:\n    if i<=324 :\n        ax = fig.add_subplot(i+1)\n        ax.set_title('Average value of '+col +' in Diabetic and Healthy')\n        d= pima_data.groupby(by= 'Outcome')[[col]].mean()\n        sns.barplot(data = d,x=d.index,y=col,ax=ax)\n        plt.xticks([0,1],['Diabetic','Healthy'])\n        i = i+1\nfig.tight_layout(pad=4.0)\n","7302ed83":"#Lets also check the correlation matrix.\n#Here all features are showing some kind of correlation with BloodPressure,PedigreeFunction having lowest\n#and Glucose having the highest correlation wrt to Outcome.\nfig.suptitle('Correlation Matrix')\nfig = plt.figure(figsize= (10,8))\nmask = np.triu(np.ones_like(correct_pima_data.corr(), dtype=bool))\nsns.heatmap(correct_pima_data.corr(),annot =True,linewidths=.8,cbar =False,mask = mask,cmap = 'YlOrBr')","b6c12372":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import LinearSVC\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import f1_score\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import precision_score \nfrom sklearn.metrics import recall_score ","a584e632":"#Features to be used for to train the model\nfeatures = ['Glucose','Insulin','SkinThickness','BMI']\n\n#Lets split the data into training data 60%,test size,validation set as 20%,20% \nX_train, X_test, y_train, y_test = train_test_split(correct_pima_data[features], correct_pima_data['Outcome'],\n                                                    test_size=0.40, random_state=42)\nX_val, X_test, y_val, y_test = train_test_split(X_test, y_test,\n                                                    test_size=0.50, random_state=42)","56f51862":"#Lets train a logistic regressin model \nmodel = LogisticRegression(max_iter = 200)\nmodel.fit(X_train,y_train)\ny_hat_val = model.predict(X_val)\nprint('F1_score : ',f1_score(y_val,y_hat_val))\nprint('Precision_score : ',precision_score(y_val,y_hat_val))\nprint('Recall_score : ',recall_score(y_val,y_hat_val))\nsns.heatmap(confusion_matrix(y_val,y_hat_val),annot = True,linewidths=2,cbar =False)","2fe4650b":"y_hat_test = model.predict(X_test)\nprint('F1_score : ',f1_score(y_test,y_hat_test))\nprint('Precision_score : ',precision_score(y_test,y_hat_test))\nprint('Recall_score : ',recall_score(y_test,y_hat_test))\nsns.heatmap(confusion_matrix(y_test,y_hat_test),annot = True,linewidths=2,cbar =False)","10ba2ca9":"# [What is Diabetes?](https:\/\/www.niddk.nih.gov\/health-information\/diabetes\/overview\/what-is-diabetes)\n**Diabetes is a disease that occurs when your blood glucose, also called blood sugar, *is too high*. Blood glucose is your main source of energy and comes from the food you eat. Insulin, a hormone made by the pancreas, helps glucose from food get into your cells to be used for energy. Sometimes your body *doesn\u2019t make enough\u2014or any\u2014insulin or doesn\u2019t use insulin well*. Glucose then stays in your blood and doesn\u2019t reach your cells.**\n\n","4ed1e333":"# What is BMI ?\n**Body mass index (BMI) is a measure of body fat based on height and weight that applies to adult men and women.And the lower threshold is 15 and higher threshold is 40**\n\n[BMI Wikipedia](https:\/\/en.wikipedia.org\/wiki\/Body_mass_index)"}}