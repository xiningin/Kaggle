{"cell_type":{"6f392825":"code","94b6b14c":"code","cb24a52d":"code","3a721f0d":"code","39944f94":"code","207c6ede":"code","b87b92ee":"code","657a88fb":"code","65e340b3":"code","5e39bd75":"code","54a0f60e":"markdown"},"source":{"6f392825":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy.cluster.hierarchy import linkage, dendrogram\nfrom sklearn.cluster import KMeans, AgglomerativeClustering, AffinityPropagation\nfrom sklearn.mixture import GaussianMixture \nimport os","94b6b14c":"data1 = pd.read_csv(\"..\/input\/random-numbers\/random_numbers_1000.csv\",sep=\",\")\ndata2=data1[['number']].copy()","cb24a52d":"def doAgglomerative(X, nclust=2):\n    model = AgglomerativeClustering(n_clusters=nclust, affinity = 'euclidean', linkage = 'ward')\n    clust_labels1 = model.fit_predict(X)\n    return (clust_labels1)","3a721f0d":"A=[]\nfor item in data2['number']:\n    a=str(item)\n    b=[0,0,0,0,0,0,0,0,0,0]\n    for i in range(2,8):\n        b[int(a[i])]+=1\n    A+=[b]","39944f94":"data3=pd.concat([data2,pd.DataFrame(A)],axis=1)\ndata3[0:3]","207c6ede":"data4=data3.drop(['number'],axis=1)","b87b92ee":"clust_labels1 = doAgglomerative(data4,8)\nagglomerative = pd.DataFrame(clust_labels1)\ndata4.insert((data4.shape[1]),'agglomerative',agglomerative)","657a88fb":"data5=data4.groupby('agglomerative').mean()\ndata5","65e340b3":"labels = ['0','1','2','3','4','5','6','7','8','9']\nx = np.arange(len(labels))\nx","5e39bd75":"agg0 = data5.iloc[0,:]\nagg1 = data5.iloc[1,:]\nagg2 = data5.iloc[2,:]\nagg3 = data5.iloc[3,:]\nagg4 = data5.iloc[4,:]\nagg5 = data5.iloc[5,:]\nagg6 = data5.iloc[6,:]\nagg7 = data5.iloc[7,:]\n\nwidth = 0.4\nfig, ax = plt.subplots(figsize=(13,6))\n\nrects0 = ax.bar(x+0.0, agg0, width\/5, label='agg0')\nrects1 = ax.bar(x+0.1, agg1, width\/5, label='agg1')\nrects2 = ax.bar(x+0.2, agg2, width\/5, label='agg2')\nrects3 = ax.bar(x+0.3, agg3, width\/5, label='agg3')\nrects4 = ax.bar(x+0.4, agg4, width\/5, label='agg4')\nrects5 = ax.bar(x+0.5, agg2, width\/5, label='agg5')\nrects6 = ax.bar(x+0.6, agg3, width\/5, label='agg6')\nrects7 = ax.bar(x+0.7, agg4, width\/5, label='agg7')\n\nax.set_title('Agglomerative Clustering by used number frequency')\nax.set_ylabel('mean value')\nax.set_xticks(x)\nax.set_xticklabels(labels)\nax.legend()\n\nfig.tight_layout()\nplt.show()","54a0f60e":"# Agglomerative Clustering by used number frequency"}}