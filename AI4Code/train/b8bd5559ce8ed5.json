{"cell_type":{"707d23d2":"code","b1507a5c":"code","9183f0a9":"code","bce7b70b":"code","2412f8f0":"code","26371d45":"code","f26e69f2":"code","471d4267":"code","7dc324b0":"code","739b2a2f":"code","c8dd93b8":"markdown","69521d99":"markdown","e75f82cd":"markdown","dc7f7c5b":"markdown","9919b78f":"markdown","86d9bf22":"markdown","2c79e086":"markdown","9ad5006f":"markdown","ac0240fd":"markdown"},"source":{"707d23d2":"from IPython.display import clear_output\n\nimport numpy as np\nimport pandas as pd\n\nimport h2o\nfrom h2o.automl import H2OAutoML","b1507a5c":"from h2o.automl import H2OAutoML\nh2o.init()","9183f0a9":"train = pd.read_csv(\"..\/input\/tabular-playground-series-feb-2022\/train.csv\")\ntest = pd.read_csv(\"..\/input\/tabular-playground-series-feb-2022\/test.csv\")\nsubs = pd.read_csv(\"..\/input\/tabular-playground-series-feb-2022\/sample_submission.csv\")\n\ntrain = h2o.H2OFrame(train)\ntest = h2o.H2OFrame(test)","bce7b70b":"train.describe()","2412f8f0":"RANDOM_STATE = 12\nRUNTIME = 3660*5 #5 hours\nN_FOLDS = 5\nSTOPPING_METRIC = \"auto\"\n\nx = train.columns\ny = \"target\"\nx.remove(y)\nx.remove('row_id')\n\ntrain[y] = train[y].asfactor()","26371d45":"aml = H2OAutoML(stopping_metric=STOPPING_METRIC , nfolds=N_FOLDS, seed=RANDOM_STATE, max_runtime_secs=RUNTIME)\naml.train(x=x, y=y, training_frame=train)","f26e69f2":"lb = aml.leaderboard\nlb.head(10)","471d4267":"aml.leader.predict(test).as_data_frame()","7dc324b0":"subs","739b2a2f":"preds = aml.leader.predict(test)\nclear_output()\nsub = preds[0].as_data_frame()  ## Converting to dataframe\nsubs['target'] = sub\nsubs.to_csv('h20-subs.csv',index = False)\nsubs.head()","c8dd93b8":"# <center> [TPS-FEB-22]\ud83e\udd16 H20 AUTOML \ud83e\udd16<\/center>\n## <center>If you find this notebook useful, support with an upvote\ud83d\udc4d<\/center>","69521d99":"### Top 10 models","e75f82cd":"# Imports","dc7f7c5b":"**Created by Sanskar Hasija**\n\n**[TPS -FEB-22]\ud83e\udd16 H20 AutoML \ud83e\udd16**\n\n**1 FEBRUARY 2022**\n","9919b78f":"# Submission","86d9bf22":"# Results Leaderboard","2c79e086":"# Data Loading and Preprocessing","9ad5006f":"# AutoML","ac0240fd":"# Initializing H20 Cluster"}}