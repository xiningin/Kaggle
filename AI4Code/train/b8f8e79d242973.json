{"cell_type":{"5f2e10e2":"code","e50bbba8":"code","27aea3e3":"code","149fb055":"code","cb427264":"code","394f2063":"code","59d8b81f":"code","77c505d3":"code","f39e9fee":"code","2e383286":"code","0010a36a":"code","fa2290df":"code","f64afbe2":"code","5d294cc3":"code","c18cb9c4":"code","059a5aa3":"code","4c891b1b":"code","e7357359":"code","11171392":"markdown"},"source":{"5f2e10e2":"# import library\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","e50bbba8":"# read csv and store in df variabel\ndf = pd.read_csv(\"\/kaggle\/input\/heart-disease-uci\/heart.csv\")\ndf.head()","27aea3e3":"# check df is missing value or not\ndf.isna().sum()","149fb055":"plt.figure(figsize=(12, 8))\nsns.countplot(df.dtypes.map(str))\nplt.show()","cb427264":"df_under_twenty = df.age < 20\ndf.groupby([df_under_twenty, 'sex'])['target'].sum().plot(kind='bar')","394f2063":"# check summarize the df\ndf.describe()","59d8b81f":"sns.set_theme();\nx = df.age\nax = sns.displot(x)","77c505d3":"plt.figure(figsize=(12, 8))\nsns.heatmap(data=df.corr(), annot=True)\nplt.show()","f39e9fee":"fig, ax = plt.subplots(1,3)\nsns.countplot(data=df, x='target', ax=ax[0])\nsns.countplot(data=df, x='sex', ax=ax[1])\nsns.countplot(data=df, x='fbs', ax=ax[2])\nfig.show()","2e383286":"from sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import precision_score, accuracy_score\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.compose import ColumnTransformer","0010a36a":"X = df.drop(columns='target')\ny = df.target\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, stratify=y, random_state=42)","fa2290df":"X_train.columns","f64afbe2":"numeric_pipeline = Pipeline([\n    ('scaling', StandardScaler())\n])\n\npreprocessor = ColumnTransformer([\n    ('numeric', numeric_pipeline, ['age', 'sex', 'cp', 'trestbps', 'chol', 'fbs', 'restecg', 'thalach', 'exang', 'oldpeak', 'slope', 'ca', 'thal'])\n])\n\npipeline = Pipeline([\n    ('pre', preprocessor),\n    ('algo', RandomForestClassifier(random_state=42))\n])","5d294cc3":"pipeline.fit(X_train, y_train)","c18cb9c4":"pipeline.get_params()","059a5aa3":"parameter = {\n    'algo__max_depth' : [20, 40, 60, 80],\n    'algo__n_estimators' : [50, 100, 150, 200],\n    'algo__max_features': ['auto', 'sqrt'],\n    'algo__min_samples_leaf': [1, 2, 4],\n    'algo__min_samples_split': [2, 5, 10],\n}","4c891b1b":"model = GridSearchCV(pipeline, parameter, cv=3, n_jobs=-1, verbose=1)\nmodel.fit(X_train, y_train)","e7357359":"print(model.score(X_train, y_train)), print(model.score(X_test, y_test))","11171392":"## EDA"}}