{"cell_type":{"ae9c64f4":"code","83762eaa":"code","bd008a7b":"code","20010193":"code","f15f8672":"code","bdb1a305":"code","b0affcb8":"code","b7aa031d":"code","262e5a60":"code","a8037a40":"code","53856284":"code","79cbf808":"code","904c636c":"code","525f6679":"code","d283069a":"code","e1058c16":"code","2ca1b973":"code","3ba929d8":"markdown","462d427b":"markdown","1bbd43f7":"markdown","aae5efb4":"markdown","a43a5028":"markdown","9d790fcb":"markdown","c0620570":"markdown","028eae5b":"markdown","9db2cf7f":"markdown","fba33d71":"markdown","1e5db91b":"markdown","ef907c71":"markdown","8dcd9892":"markdown","87dd4c8c":"markdown","01c920d0":"markdown","ac0610ad":"markdown","76fa4063":"markdown","a6dc0eb7":"markdown","8148eb80":"markdown","a240217d":"markdown"},"source":{"ae9c64f4":"!pip install greykite","83762eaa":"!pip install --force-reinstall pandas==1.2.4","bd008a7b":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\n# for dirname, _, filenames in os.walk('..\/input\/for-simple-exercises-time-series-forecasting'):\n#     for filename in filenames:\n#         print(os.path.join(dirname, filename))","20010193":"from collections import defaultdict\nimport warnings\n\nwarnings.filterwarnings(\"ignore\")\n\nimport pandas as pd\nimport plotly\nimport plotly.offline as pyo\nimport plotly.graph_objs as go\n\npyo.init_notebook_mode()\n\nfrom greykite.common.data_loader import DataLoader\nfrom greykite.framework.templates.autogen.forecast_config import ForecastConfig\nfrom greykite.framework.templates.autogen.forecast_config import MetadataParam\nfrom greykite.framework.templates.forecaster import Forecaster\nfrom greykite.framework.templates.model_templates import ModelTemplateEnum\nfrom greykite.framework.utils.result_summary import summarize_grid_search_results\n\n# Loads dataset into pandas DataFrame\n\ndf = pd.read_csv('..\/input\/nifty50-stock-market-data\/HDFCBANK.csv')\nimport matplotlib\n\nmetadata = MetadataParam(\n time_col=\"Date\",   # ----> name of the time column (\"date\" in example above)\n value_col=\"High\",  # ----> name of the value column (\"sessions\" in example above)\n freq=\"D\"           # ----> H\" for hourly, \"D\" for daily, \"W\" for weekly, etc.\n                    # ----> Any format accepted by `pandas.date_range`\n)","f15f8672":"df","bdb1a305":"forecaster = Forecaster()  # Creates forecasts and stores the result\nresult = forecaster.run_forecast_config(  # result is also stored as `forecaster.forecast_result`.\n df=df,\n config=ForecastConfig(\n     model_template=ModelTemplateEnum.SILVERKITE.name,\n     forecast_horizon=365,  # forecasts 365 steps ahead\n     coverage=0.95,         # 95% prediction intervals\n     metadata_param=metadata\n )\n)","b0affcb8":"ts = result.timeseries\nfig = ts.plot()\nplotly.io.show(fig)","b7aa031d":"grid_search = result.grid_search\ncv_results = summarize_grid_search_results(\n    grid_search=grid_search,\n    decimals=2,\n    # The below saves space in the printed output. Remove to show all available metrics and columns.\n    cv_report_metrics=None,\n    column_order=[\"rank\", \"mean_test\", \"split_test\", \"mean_train\", \"split_train\", \"mean_fit_time\", \"mean_score_time\", \"params\"])\n# Transposes to save space in the printed output\ncv_results[\"params\"] = cv_results[\"params\"].astype(str)\ncv_results.set_index(\"params\", drop=True, inplace=True)\ncv_results.transpose()","262e5a60":"backtest = result.backtest\nfig = backtest.plot()\nplotly.io.show(fig)","a8037a40":"backtest_eval = defaultdict(list)\nfor metric, value in backtest.train_evaluation.items():\n    backtest_eval[metric].append(value)\n    backtest_eval[metric].append(backtest.test_evaluation[metric])\nmetrics = pd.DataFrame(backtest_eval, index=[\"train\", \"test\"]).T\nmetrics","53856284":"forecast = result.forecast\nfig = forecast.plot()\nplotly.io.show(fig)","79cbf808":"forecast.df.head().round(2)","904c636c":"fig = forecast.plot_components()\nplotly.io.show(fig)","525f6679":"summary = result.model[-1].summary()  # -1 retrieves the estimator from the pipeline\nprint(summary)","d283069a":"model = result.model\nmodel","e1058c16":"future_df = result.timeseries.make_future_dataframe(\n    periods=4,\n    include_history=False)\nfuture_df","2ca1b973":"model.predict(future_df)","3ba929d8":"<a id='2'><\/a>\n<div style=\"margin: 0px; padding: 10px; background-color: #1e88e5;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white;text-align:center\">2. <b>Re-installing the pandas to avoid some runtime error...<\/b><\/h1>\n  <\/div>\n<\/div>","462d427b":"<div style=\"margin: 0px; padding: 10px; background-color: #ef9a9a ;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h2 style=\"color:white;text-align:center\">In the above cell, the metrics for both train and test data are listed.<\/h2>\n  <\/div>\n<\/div>","1bbd43f7":"<a id='6'><\/a>\n<div style=\"margin: 0px; padding: 10px; background-color: #1e88e5;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white;text-align:center\">6. <b>Performing Grid Search for hyper-parameter optimization<\/b><\/h1>\n  <\/div>\n<\/div>","aae5efb4":"<a id='4'><\/a>\n<div style=\"margin: 0px; padding: 10px; background-color: #1e88e5;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white;text-align:center\">4. <b>Forecaster<\/b><\/h1>\n  <\/div>\n  <div style=\"color:white;text-align:center\">The core module which performs the forecasting of the values for the given time series<\/div>\n<\/div>","a43a5028":"<a id='11'><\/a>\n<div style=\"margin: 0px; padding: 10px; background-color: #1e88e5;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white;text-align:center\"><b>11. Printing the summary<\/b><\/h1>\n  <\/div>\n<\/div>","9d790fcb":"<a id='0'><\/a>\n<div style=\"margin: 0px; padding: 10px; background-color: #1e88e5;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px;\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white; text-align:center\">0. References \ud83d\udcd3<\/h1>\n  <\/div>\n  \n  <div style=\"margin: 0px; padding: 10px; background-color: #ffffff;\n        box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n        border-radius:2px; text-align:left\">\n    <h5><a href=https:\/\/linkedin.github.io\/greykite\/docs\/0.1.0\/html\/index.html>1. Greykite Documentation <\/a><\/h5>\n  <\/div>\n<\/div>","c0620570":"<div style=\"margin: 0px; padding: 10px; background-color: #ef9a9a ;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h2 style=\"color:white;text-align:center\">All the performance metrics such as Mean Absolute Percentage Error(MAPE), Mean Fit Time, Mean Score Time can be listed.<\/h2>\n  <\/div>\n<\/div>","028eae5b":"<div style=\"margin: 0px; padding: 10px; background-color: #00897b;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px;\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white; text-align:center\">Table of Contents<\/h1>\n  <\/div>\n  \n  <div style=\"margin: 0px; padding: 10px; background-color: #ffffff;\n        box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n        border-radius:2px; text-align:left\">\n    <h5><a href=\"#0\">0. References<\/a><\/h5>\n    <h5><a href=\"#1\">1. Installing the Greykite package<\/a><\/h5>\n    <h5><a href=\"#2\">2. Re-installing the pandas<\/a><\/h5>\n    <h5><a href=\"#3\">3. Importing all the required libraries.<\/a><\/h5>\n    <h5><a href=\"#4\">4. Forecaster<\/a><\/h5>\n    <h5><a href=\"#5\">5. Plotting the results using the Plotly module<\/a><\/h5>\n    <h5><a href=\"#6\">6. Performing Grid Search for hyper-parameter optimization<\/a><\/h5>\n    <h5><a href=\"#7\">7. Plotting the Backtest<\/a><\/h5>\n    <h5><a href=\"#8\">8. Listing the different evaluation metrics<\/a><\/h5>\n    <h5><a href=\"#9\">9. Analyse the forecast Dataframe<\/a><\/h5>\n    <h5><a href=\"#10\">10. Plotting the different componenets<\/a><\/h5>\n    <h5><a href=\"#11\">11. Printing the summary<\/a><\/h5>\n    <h5><a href=\"#12\">12. Forecasting for the values for the future time periods<\/a><\/h5>\n    \n  <\/div>\n<\/div>","9db2cf7f":"<a id='5'><\/a>\n<div style=\"margin: 0px; padding: 10px; background-color: #1e88e5;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white;text-align:center\">5. <b>Plotting the results using the Plotly module  \ud83d\udcc8<\/b><\/h1>\n  <\/div>\n<\/div>","fba33d71":"<div style=\"margin: 0px; padding: 10px; background-color: #43a047;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px;\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white; text-align:center\"> Time Series Forecasting DEMO Using GREYKITE <\/h1>\n      \n<!--       <div style=\"color:white\">I am a square root.<\/div> -->\n<!--       <h1>$\\sqrt{4}$<\/h1> -->\n  <\/div>\n<\/div>","1e5db91b":"<a id='7'><\/a>\n<div style=\"margin: 0px; padding: 10px; background-color: #1e88e5;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white;text-align:center\">7. <b>Plotting the Backtest<\/b><\/h1>\n  <\/div>\n<\/div>","ef907c71":"<a id='9'><\/a>\n<div style=\"margin: 0px; padding: 10px; background-color: #1e88e5;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white;text-align:center\">9. <b>Analyse the forecast Dataframe<\/b><\/h1>\n  <\/div>\n<\/div>","8dcd9892":"<a id='1'><\/a>\n<div style=\"margin: 0px; padding: 10px; background-color: #1e88e5;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px;\n            text-align:center\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white\">1. Installing the Greykite package \ud83d\udcd7<\/h1>\n  <\/div>\n<\/div>","87dd4c8c":"<a id='8'><\/a>\n<div style=\"margin: 0px; padding: 10px; background-color: #1e88e5;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white;text-align:center\">8. <b>Listing the different evaluation metrics<\/b><\/h1>\n  <\/div>\n\n<\/div>","01c920d0":"<div style=\"margin: 0px; padding: 10px; background-color: #ef9a9a ;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h2 style=\"color:white;text-align:center\">Remarks: The model fails to recognise the sudden changes in the trend.<\/h2>\n  <\/div>\n<\/div>","ac0610ad":"<a id='10'><\/a>\n<div style=\"margin: 0px; padding: 10px; background-color: #1e88e5;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n    \n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white;text-align:center\"><b>10. Plotting the different components \ud83d\udcca<\/b><\/h1>\n  <\/div>\n<\/div>","76fa4063":"<a id='12'><\/a>\n<div style=\"margin: 0px; padding: 10px; background-color: #1de9b6  ;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white;text-align:center\"><b>12. Forecasting for the values for the future time periods \ud83d\udcc8<\/b><\/h1>\n  <\/div>\n<\/div>","a6dc0eb7":"<a id='2'><\/a>\n<div style=\"margin: 0px; padding: 10px; background-color: #1de9b6 ;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white;text-align:center\"><b>Hooray!!! That's it... \n          Kindly upvote \ud83d\udc4d the notebook if you liked the content. Thank you. \ud83d\ude4f<\/b><\/h1>\n  <\/div>\n<\/div>","8148eb80":"<a id='3'><\/a>\n<div style=\"margin: 0px; padding: 10px; background-color: #1e88e5;\n            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\n            border-radius:2px\">\n  <div style=\"margin: 0; padding: 0; width: 100%\">\n      <h1 style=\"color:white;text-align:center\">3. <b>Importing all the required libraries.<\/b> <\/h1>\n  <\/div>\n<\/div>","a240217d":"<center><img src=\"https:\/\/warehouse-camo.ingress.cmh1.psfhosted.org\/a500025c0abbda3915b6ec7c0723ce36f189eed8\/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f6c696e6b6564696e2f677265796b6974652f6d61737465722f4c4f474f2d43382e706e67\" alt=\"Greykite\" class=\"center\" style = \"\n  width: 60%;\n  height: 60%;\n  background-image: url('img_flowers.jpg');\n  align: center;\n  background-size: 100% 100%;\"><\/center>\n"}}