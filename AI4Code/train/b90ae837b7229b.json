{"cell_type":{"29064fce":"code","5cc4e713":"code","7f42c353":"code","4bb9dcae":"code","13aba71f":"code","50a63dd3":"code","4a77e923":"code","bee1b20d":"code","844592a2":"code","2e1db66f":"code","0adada13":"code","2b5c7ac1":"code","85ef52af":"code","97c1e9ef":"code","0149ef14":"code","812b75c2":"code","fc0c7a0f":"code","3b0cc4cd":"code","62442f62":"code","80c760e6":"code","ef6a68f0":"code","0d04a747":"code","4678eed8":"code","0ce9ca9d":"code","354631e2":"code","c060f129":"code","5883be6b":"code","260be08a":"code","29993477":"code","f70f4383":"code","38478e08":"markdown","2f6d29a3":"markdown","0424ea3e":"markdown","54fd9e13":"markdown","7cfc7cf7":"markdown","c21cfd24":"markdown","fca179ef":"markdown","e15de6c4":"markdown","d42b702e":"markdown","7b5f380a":"markdown"},"source":{"29064fce":"from numpy import array\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.preprocessing import LabelEncoder\nimport os\nprint(os.listdir(\"..\/input\"))\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import roc_auc_score","5cc4e713":"df_train=os.listdir(\"..\/input\")","7f42c353":"df_train=pd.read_csv('..\/input\/WA_Fn-UseC_-Telco-Customer-Churn.csv')","4bb9dcae":"df_train.shape","13aba71f":"df_train.head()","50a63dd3":"df_train.nunique()","4a77e923":"df_train.isnull().sum()","bee1b20d":"df_train.dtypes","844592a2":"df_train.drop(['customerID'],inplace=True,axis=1)","2e1db66f":"df_train.shape","0adada13":"df_train=df_train.astype('category')","2b5c7ac1":"df_train.dtypes","85ef52af":"def label_encoding_churn(df_train):\n    for i in range(len(df_train.columns)):\n        col=df_train.columns[i]\n        df_train[col]=LabelEncoder().fit_transform(df_train[col])\n   \n    return df_train","97c1e9ef":"df_train=label_encoding_churn(df_train)","0149ef14":"df_train.columns","812b75c2":"target=df_train['Churn']","fc0c7a0f":"df_train.drop(['Churn'],axis=1,inplace=True)","3b0cc4cd":"clf=RandomForestClassifier().fit(df_train,target)","62442f62":"pred=clf.predict(df_train)","80c760e6":"accuracy=accuracy_score(target,pred)\nprint(\"ACCURACY SCORE:\",accuracy)","ef6a68f0":"roc_auc_score(target,pred)","0d04a747":"features_value=pd.DataFrame(clf.feature_importances_,columns=['features'])","4678eed8":"len(df_train.columns)","0ce9ca9d":"features_value.shape","354631e2":"df_train.columns.shape","c060f129":"\nfeatures_value['feature_name']=array(df_train.columns)","5883be6b":"features_value","260be08a":"features_value['feature_code']=array(features_value.index)\n","29993477":"features_value","f70f4383":"features_value.plot.bar(x='feature_code', y='features', rot=0)","38478e08":"### **Label encoding **","2f6d29a3":"### **Feature_importance graph**","0424ea3e":"### **Accuracy calculation**","54fd9e13":"### **Categorical conversion**","7cfc7cf7":"### **roc_auc_score**","c21cfd24":"### ** Loading libraries**","fca179ef":"## **Modeling with Random forest classifier**","e15de6c4":"### **Droping unique columns**","d42b702e":"### **Prediction**","7b5f380a":"### ** Loading training dataset**"}}