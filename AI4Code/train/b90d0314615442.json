{"cell_type":{"e964ed81":"code","3525b145":"code","37566df0":"code","02db7647":"code","3a06c346":"code","f98c367e":"code","bec8266d":"code","35011765":"code","b43ca9b2":"code","fb0c42ec":"code","b8736277":"code","ef9bbdc1":"code","e96a2a01":"code","381619c5":"code","8c797fdc":"code","74bf2038":"code","360d66d8":"code","6c21aeac":"code","a7a1c768":"code","35d2d437":"code","01f2e6e0":"code","f0986f85":"code","8a5a2716":"code","82a2aaec":"code","87077cd3":"code","139f6415":"code","293b59a0":"code","23a2067a":"code","e2da8325":"code","ff9d3d19":"code","a13b2a67":"code","a965a663":"code","7d840fb7":"code","a4ae50a9":"code","4b35f513":"code","45348b42":"code","f264e4d5":"code","e99030e7":"code","2eb08586":"code","f2d4f746":"code","14c9cfdb":"code","909a44ed":"code","caecec9d":"code","9a085ff9":"code","e90f34c1":"code","fde09e08":"code","9b347108":"code","9b4a96b1":"code","652d418e":"code","19b20e16":"code","c4fbb90f":"code","e44b0809":"code","0d784b5e":"code","4c9a8ea3":"code","97bd8851":"code","ee59fd21":"code","80e34127":"code","55586c08":"code","9a59868d":"code","345c8fd8":"code","abc3f006":"code","85efd824":"code","f219763e":"code","9cd588b2":"code","fd32e760":"code","6f6f8032":"code","ab4b7308":"code","ac7857b0":"code","727d34f2":"code","f353e04a":"code","65e29ba4":"code","cabd0cb7":"code","cdf3f0c5":"code","320e9f81":"code","fb07628c":"markdown","6d91dc28":"markdown","1da7fa5e":"markdown","55516b47":"markdown","f0797b5a":"markdown","a03e6891":"markdown","98155eb0":"markdown","56cc39ca":"markdown","e05a4318":"markdown","44eb6799":"markdown"},"source":{"e964ed81":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","3525b145":"df = pd.read_csv(\"..\/input\/heart-attack-prediction\/data.csv\",na_values=['?'], low_memory = False)\ndf","37566df0":"df.shape","02db7647":"df.columns","3a06c346":"df['age'].unique()","f98c367e":"df['sex'].unique()","bec8266d":"df['fbs'].unique()","35011765":"df['chol'].unique()","b43ca9b2":"df['fbs'].unique()","fb0c42ec":"df['thalach'].unique()","b8736277":"df['cp'].unique()","ef9bbdc1":"df['restecg'].unique()","e96a2a01":"df['slope'].unique()","381619c5":"df['ca'].unique()","8c797fdc":"df['thal'].unique()","74bf2038":"df['exang'].unique()","360d66d8":"df.head()","6c21aeac":"df.tail()","a7a1c768":"df.info()","35d2d437":"df.shape","01f2e6e0":"df.drop(columns=['ca'],inplace=True)","f0986f85":"df.shape","8a5a2716":"df.isnull().sum()","82a2aaec":"df.skew()","87077cd3":"df['thalach'].fillna(df['thalach'].mean(),inplace=True)","139f6415":"df.fillna(df.median(),inplace=True)","293b59a0":"df.isnull().sum()","23a2067a":"df.duplicated().sum()","e2da8325":"df.drop_duplicates(inplace=True)","ff9d3d19":"df.shape","a13b2a67":"cor=df.corr()\nplt.figure(figsize=(20,12))\nsns.heatmap(cor,annot=True,cmap='coolwarm')\nplt.show()","a965a663":"df.columns","7d840fb7":"df=df.rename(columns={\"num       \":\"num\"})","a4ae50a9":"df.columns","4b35f513":"plt.figure(figsize=(12,5))\nplt.title(\"AGE VRS NUM\")\nsns.distplot(df.age[df.num==0],color=\"darkblue\")\nsns.distplot(df.age[df.num==1],color=\"cyan\")\nplt.legend(['0','1'])\nplt.show()","45348b42":"df.hist()\nplt.figure(figsize=(20,12))\nplt.show()","f264e4d5":"plt.figure(figsize=(12,5))\nplt.title(\"TRESTBPS VRS NUM\")\nsns.distplot(df.trestbps[df.num==0],color=\"darkblue\")\nsns.distplot(df.trestbps[df.num==1],color=\"cyan\")\nplt.legend(['0','1'])\nplt.show()","e99030e7":"plt.figure(figsize=(12,5))\nplt.title(\"CHO VRS NUM\")\nsns.distplot(df.chol[df.num==0],color=\"darkblue\")\nsns.distplot(df.chol[df.num==1],color=\"cyan\")\nplt.legend(['0','1'])\nplt.show()","2eb08586":"plt.figure(figsize=(12,5))\nplt.title(\"THALACH VRS NUM\")\nsns.distplot(df.thalach[df.num==0],color=\"darkblue\")\nsns.distplot(df.thalach[df.num==1],color=\"cyan\")\nplt.legend(['0','1'])\nplt.show()","f2d4f746":"plt.figure(figsize=(6,3))\nplt.title(\"SEX VRS NUM\")\nsns.countplot(df.sex)\nplt.show()\nsns.countplot(df.sex[df.num==1])\nplt.show()","14c9cfdb":"plt.figure(figsize=(6,3))\nplt.title(\"CP VRS NUM\")\nsns.countplot(df.cp)\nplt.show()\nsns.countplot(df.cp[df.num==1])\nplt.show()","909a44ed":"plt.figure(figsize=(6,3))\nplt.title(\"FBS VRS NUM\")\nsns.countplot(df.fbs)\nplt.show()\nsns.countplot(df.fbs[df.num==1])\nplt.show()","caecec9d":"plt.figure(figsize=(6,3))\nplt.title(\"RESTECG VRS NUM\")\nsns.countplot(df.restecg)\nplt.show()\nsns.countplot(df.restecg[df.num==1])\nplt.show()","9a085ff9":"plt.figure(figsize=(6,3))\nplt.title(\"EXANG VRS NUM\")\nsns.countplot(df.exang)\nplt.show()\nsns.countplot(df.exang[df.num==1])\nplt.show()","e90f34c1":"plt.figure(figsize=(6,3))\nplt.title(\"SLOPE VRS NUM\")\nsns.countplot(df.slope)\nplt.show()\nsns.countplot(df.slope[df.num==1])\nplt.show()","fde09e08":"plt.figure(figsize=(6,3))\nplt.title(\"THAL VRS NUM\")\nsns.countplot(df.thal)\nplt.show()\nsns.countplot(df.thal[df.num==1])\nplt.show()","9b347108":"plt.figure(figsize=(12,5))\nplt.title(\"SEX VRS AGE VRS NUM\")\nsns.pointplot(x = 'sex',y='age',hue='num',data=df)\nplt.show()","9b4a96b1":"plt.figure(figsize=(12,5))\nplt.title(\"CHOL VRS AGE VRS NUM\")\nsns.scatterplot(x='chol',y='age',hue='num',data=df)\nplt.show()","652d418e":"x=df[['age', 'sex', 'cp','trestbps', 'chol', 'fbs','restecg', 'thalach', 'exang', 'oldpeak', 'slope','thal']]\ny=df['num']\nprint(x)\nprint(y)","19b20e16":"# split data into train and test\nfrom sklearn.model_selection import train_test_split\nxtr,xts,ytr,yts = train_test_split(x,y,test_size=0.2)\n# we have to split the data into 80% as train and 20% as test so we have specified test_size as 0.2\nprint(x.shape)\nprint(xtr.shape)\nprint(xts.shape)\nprint(y.shape)\nprint(ytr.shape)\nprint(yts.shape)","c4fbb90f":"from sklearn.decomposition import PCA\npca = PCA(n_components = 1)\nxtr = pca.fit_transform(xtr)\nxts = pca.transform(xts)\nexplained_variance = pca.explained_variance_ratio_","e44b0809":"from sklearn.svm import SVC","0d784b5e":"from sklearn.metrics import classification_report,confusion_matrix","4c9a8ea3":"svc_model=SVC()","97bd8851":"svc_model.fit(xtr,ytr)","ee59fd21":"y_pred=svc_model.predict(xts)","80e34127":"cm=confusion_matrix(yts,y_pred)","55586c08":"sns.heatmap(cm,annot=True)","9a59868d":"min_train = xtr.min()\nmin_train","345c8fd8":"range_train = (xtr - min_train).max()\nrange_train","abc3f006":"X_train_scaled = (xtr - min_train)\/range_train\nX_train_scaled","85efd824":"min_test = xts.min()\nrange_test = (xts - min_test).max()\nX_test_scaled = (xts - min_test)\/range_test","f219763e":"from sklearn.svm import SVC \nfrom sklearn.metrics import classification_report, confusion_matrix\n\nsvc_model = SVC()\nsvc_model.fit(X_train_scaled, ytr)","9cd588b2":"y_predict = svc_model.predict(X_test_scaled)\ncm = confusion_matrix(yts, y_predict)\n\nsns.heatmap(cm,annot=True,fmt=\"d\")","fd32e760":"print(classification_report(yts,y_predict))","6f6f8032":"param_grid = {'C': [0.1, 1, 10, 100], 'gamma': [1, 0.1, 0.01, 0.001], 'kernel': ['rbf']} ","ab4b7308":"from sklearn.model_selection import GridSearchCV\ngrid = GridSearchCV(SVC(),param_grid,refit=True,verbose=4)\ngrid.fit(X_train_scaled,ytr)","ac7857b0":"grid.best_params_","727d34f2":"grid.best_estimator_","f353e04a":"grid_predictions = grid.predict(X_test_scaled)\ncm = confusion_matrix(yts, grid_predictions)\nsns.heatmap(cm, annot=True)","65e29ba4":"print(classification_report(yts,grid_predictions))","cabd0cb7":"from sklearn.svm import SVC\nclassifier = SVC(kernel = 'rbf', random_state = 0)","cdf3f0c5":"from sklearn.model_selection import cross_val_score\naccuracies = cross_val_score(estimator = classifier, X = xtr, y = ytr, cv = 10)\naccuracies","320e9f81":"print(accuracies.mean())\nprint(accuracies.std())","fb07628c":"## 3. Data Cleaning:-","6d91dc28":"# SVM","1da7fa5e":"## Normalisation(1):-","55516b47":"age,sex,cp,old peak,num dont contain any null value .","f0797b5a":"## Normalisation(2):","a03e6891":"# Heart Attack Prediction","98155eb0":"## 4.Feature Selection:-","56cc39ca":"## Split the data into train and test set:-","e05a4318":"## 1. Data collection :-","44eb6799":"## 2.Data Exploration:-"}}