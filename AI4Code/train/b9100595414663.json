{"cell_type":{"56d10296":"code","fe43bb3d":"code","9b3351f2":"code","3f10bf0b":"code","1519ebb9":"code","2add4579":"code","9f409cdb":"code","1aecab6a":"code","325992e6":"code","22874667":"code","a81a70a3":"code","194dda45":"code","0c238dfb":"code","aacb46f7":"code","7712631a":"markdown","4fe74e10":"markdown","a82d8741":"markdown","0f79a2f9":"markdown","a5782392":"markdown","91ba6f9c":"markdown","29917ff8":"markdown","7a922e8d":"markdown"},"source":{"56d10296":"!pip install fastai -q --upgrade","fe43bb3d":"import fastai\nprint(fastai.__version__)\nfrom fastai.vision.all import *\nfrom pathlib import Path","9b3351f2":"path = Path('..\/input\/rockpaperscissors')\n#path.ls()","3f10bf0b":"def get_dls(bs, size):\n    dblock = DataBlock(blocks = (ImageBlock, CategoryBlock),\n                       get_items = get_image_files,\n                       get_y = parent_label,\n                       splitter = RandomSplitter(),\n                       item_tfms = Resize(size)\n                      )\n    return dblock.dataloaders(path, bs = bs)\n\n","1519ebb9":"dls = get_dls(16, 128)","2add4579":"learn = cnn_learner(dls, resnet34, metrics=accuracy)","9f409cdb":"learn.lr_find()","1aecab6a":"learn = cnn_learner(dls, resnet34, metrics=accuracy)\nlearn.fit_one_cycle(10, 1e-3)","325992e6":"learn.dls = get_dls(16, 224)\nlearn.fine_tune(5, 1e-3)","22874667":"learn.show_results()","a81a70a3":"interp = Interpretation.from_learner(learn)\ninterp.plot_top_losses(k=1)","194dda45":"learn.predict('..\/input\/rockpaperscissors\/paper\/1fKclJk4eBWOQSR1.png')","0c238dfb":"learn.export(fname='model.pkl', pickle_module=pickle, pickle_protocol=2)","aacb46f7":"reload_model=load_learner('model.pkl', cpu=True, pickle_module=pickle)\nreload_model","7712631a":"## Save model","4fe74e10":"## Predict\nhttps:\/\/docs.fast.ai\/learner.html#Learner.predict","a82d8741":"## Interpretation\nhttps:\/\/docs.fast.ai\/tutorial.vision.html#Single-label-classification","0f79a2f9":"## Reload model","a5782392":"# RockPaperScissors Classify fastai\nThis notebook referred the following notebook.<br\/>\nhttps:\/\/www.kaggle.com\/mathurinache\/star-wars-characters-classification-with-fastai","91ba6f9c":"https:\/\/docs.fast.ai\/tutorial.datablock.html#Building-a-DataBlock-from-scratch","29917ff8":"## Show results\nhttps:\/\/docs.fast.ai\/learner.html#Learner.show_results","7a922e8d":"https:\/\/docs.fast.ai\/vision.learner.html#cnn_learner"}}