{"cell_type":{"ef1165a2":"code","ed30cf15":"code","32ffa50b":"code","657a07ef":"code","de04be7b":"code","22a7247b":"code","7a6411d7":"code","e6665290":"code","5636f211":"code","94559554":"code","881bf937":"code","9f8d55a6":"code","4b24bc74":"code","77465640":"code","f74a12d9":"code","8d038130":"code","82c73a32":"code","b4aebcf7":"code","26c5ccb7":"code","010e3781":"code","0d4a7ed6":"code","4af2a04f":"code","b9f89397":"code","f18bf663":"code","8593dbf8":"code","ac2a24ab":"code","2d2778b5":"code","f5c964c6":"code","126c76e9":"code","aa5973c8":"code","6fea767b":"code","0bb8f4b0":"code","98e3d089":"code","1e669f2a":"code","31747a77":"code","032e46fa":"code","d76aba26":"code","18dbbf36":"code","75f648e3":"code","f9e1e23e":"code","e2fec50f":"code","cc63d85f":"code","1fe1290a":"code","fe955ccb":"code","aad7d837":"code","f27d9f2b":"code","350a7493":"code","3b76bf86":"code","d79cd842":"code","827bbb0d":"code","1eef032e":"code","e060fafe":"code","466808cc":"code","9f41cabb":"code","304b8482":"code","e7a9f11b":"code","08505178":"code","9ab16fe2":"code","663f9ca5":"code","91f6f6bc":"code","8138a3af":"code","8c4ed2e0":"code","86547f93":"code","8d141299":"code","6e7bb13a":"code","fe162a69":"code","e1e94509":"code","2e1f3116":"code","4c5fd359":"code","23279690":"code","b72537ea":"code","36bb3fcd":"code","33666791":"code","3d322a5a":"code","ade95302":"code","efa8cafc":"code","3194e13b":"code","739f9e85":"code","19670e96":"code","a219b0a5":"markdown","5cc21db4":"markdown","9ce50d61":"markdown","f43dcf4a":"markdown","0591e0d2":"markdown","f39c33b8":"markdown","8c7b6d6b":"markdown","7e223bc3":"markdown","43bfeaed":"markdown","3c8b4271":"markdown","cb67caf6":"markdown","4dc4b94e":"markdown","7dd93e3e":"markdown","257c4310":"markdown","d2ef70ea":"markdown","ed46a933":"markdown","4da31b2d":"markdown","c1744d95":"markdown","422f6c1b":"markdown","379507f3":"markdown","b525beeb":"markdown","5c676edc":"markdown"},"source":{"ef1165a2":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings(\"ignore\")","ed30cf15":"file = r'..\/input\/insurance\/insurance.csv'\ndf = pd.read_csv(file)\ndf","32ffa50b":"df.isnull().sum()","657a07ef":"df.duplicated().sum()","de04be7b":"df.drop_duplicates(inplace=True)","22a7247b":"df.describe().round(2)","7a6411d7":"plt.figure(figsize=(15,10))\nsns.heatmap(df.corr(),annot=True)","e6665290":"sns.distplot(df.charges)","5636f211":"sns.boxplot(df.charges)","94559554":"IQR = df.charges.quantile(.75) - df.charges.quantile(.25)","881bf937":"lower_bound = df.charges.quantile(.25) - (IQR * 1.5)\nupper_bound = df.charges.quantile(.75) + (IQR * 1.5)\nprint(lower_bound) , print(upper_bound), print(df.charges.mean())","9f8d55a6":"df.loc[df['charges']>=34525,'charges']=34525","4b24bc74":"sns.distplot(df.charges)","77465640":"sns.boxplot(df.charges)","f74a12d9":"sns.distplot(df.bmi)","8d038130":"sns.boxplot(df.bmi)","82c73a32":"uppper_boundary=df['bmi'].mean() + 3* df['bmi'].std()\nlower_boundary=df['bmi'].mean() - 3* df['bmi'].std()\nprint(lower_boundary), print(uppper_boundary),print(df['bmi'].mean())","b4aebcf7":"df.loc[df['bmi']>=47,'bmi']=47","26c5ccb7":"sns.boxplot(df.bmi)","010e3781":"df.describe().round(2)","0d4a7ed6":"plt.figure(figsize=(10,8))\nsns.countplot(x='smoker', data=df)\nplt.title('smoker')","4af2a04f":"df.smoker.value_counts()","b9f89397":"plt.figure(figsize=(10,8))\nsns.countplot(x='smoker',hue='sex',data=df)\nplt.title('Compare between male & female who are smoker and not')","f18bf663":"plt.figure(figsize=(15,10))\nsns.barplot(x='region',y='charges',hue='smoker',data=df,palette='Reds_r')\nplt.title('Charges Per Region Based On Smoker and Non_smoker')","8593dbf8":"plt.figure(figsize=(15,10))\nsns.countplot(x='region',hue='smoker',data=df,palette='Reds_r')\nplt.title('Smoker Counts Per Region')","ac2a24ab":"plt.figure(figsize=(15,10))\nsns.countplot(x='children',data=df)\nplt.title('Count Of Childern ')","2d2778b5":"plt.figure(figsize=(15,10))\nsns.barplot(x='children',y='charges',hue='region',data=df)\nplt.title('Charge Of Each Region Based On Childerns Count')","f5c964c6":"plt.figure(figsize=(15,10))\nsns.barplot(x='region',y='age',hue='smoker',data=df)\nplt.title('Count Of Smoker In Each Region')","126c76e9":"df_smoker = df[df.smoker == 'yes']\ndf_smoker","aa5973c8":"df_smoker.groupby(['region','sex'],as_index=False)['smoker'].agg('count')","6fea767b":"print('Percentage Of Female In Smoker Dataset',((df_smoker.sex =='female').sum() \/ len(df_smoker)).round(2))","0bb8f4b0":"print('Precentage Of Male In Smoker Dataset',((df_smoker.sex =='male').sum() \/ len(df_smoker)).round(2))","98e3d089":"df_smoker.groupby(['region','sex'],as_index=False)['charges'].mean().round()","1e669f2a":"df_smoker.groupby(['region','sex'],as_index=False)['children'].agg('sum')","31747a77":"df_smoker.groupby(['region','sex'],as_index=False)['children'].agg('max')","032e46fa":"df_smoker.groupby(['region','sex'],as_index=False)['age'].mean().round()","d76aba26":"df_smoker.groupby(['sex','region'],as_index=False)['bmi'].mean().round(2)","18dbbf36":"df_non_smoker = df[df.smoker == 'no']\ndf_non_smoker","75f648e3":"df_non_smoker.groupby(['region','sex'],as_index=False)['smoker'].agg('count')","f9e1e23e":"print('Percentage Of Female In Non_Smoker Dataset',((df_non_smoker.sex =='female').sum() \/ len(df_non_smoker)).round(2))","e2fec50f":"print('Percentage Of Male In Non_Smoker Dataset',((df_non_smoker.sex =='male').sum() \/ len(df_non_smoker)).round(2))","cc63d85f":"df_non_smoker.groupby(['region','sex'],as_index=False)['charges'].mean().round()","1fe1290a":"df_smoker.groupby(['sex','age'],as_index=False)['charges'].mean().round(2)","fe955ccb":"df_non_smoker.groupby(['region','sex'],as_index=False)['children','charges'].agg('max').round()","aad7d837":"df_non_smoker.groupby(['region','sex'],as_index=False)['children','charges'].agg('min').round()","f27d9f2b":"df_non_smoker.groupby(['region','sex'],as_index=False)['age'].mean().round()","350a7493":"df_non_smoker.groupby(['sex','region'],as_index=False)['bmi'].mean().round(2)","3b76bf86":"df.info()","d79cd842":"df.sex.replace({'male':0,'female':1},inplace=True)","827bbb0d":"df.smoker.replace({'yes':1,'no':0},inplace=True)","1eef032e":"df.region.value_counts()","e060fafe":"df.region.replace({'southeast':0,'southwest':1,'northeast':2,'northwest':3},inplace=True)","466808cc":"df","9f41cabb":"X = df.drop(['charges'],axis=1)\ny = df['charges']","304b8482":"from sklearn.model_selection import RandomizedSearchCV, train_test_split\nfrom sklearn.metrics import mean_absolute_error, r2_score\nX_train, X_test, y_train, y_test = train_test_split(X,y, test_size=.2,random_state=42)","e7a9f11b":"from sklearn.linear_model import LinearRegression\nreg = LinearRegression()\nreg.fit(X_train,y_train)\nprint('Train Score ',reg.score(X_train,y_train).round(2))","08505178":"print('Test Score ',reg.score(X_test,y_test).round(2))","9ab16fe2":"y_pred = reg.predict(X_test)","663f9ca5":"mae = mean_absolute_error(y_test,y_pred).round(2)\nr2 = r2_score(y_test,y_pred).round(2)\n\nprint('MAE = ',mae)\nprint('R2 = ',r2)","91f6f6bc":"from sklearn.linear_model import Ridge\nRidge = Ridge(alpha=0.5)\nRidge.fit(X_train, y_train)\nprint('Train Score ',Ridge.score(X_train,y_train).round(2))","8138a3af":"print('Test Score ',Ridge.score(X_test, y_test).round(2))","8c4ed2e0":"y_pred = Ridge.predict(X_test)","86547f93":"mae = mean_absolute_error(y_test,y_pred).round(2)\nr2 = r2_score(y_test,y_pred).round(2)\nprint('MAE = ',mae)\nprint('R2 = ',r2)","8d141299":"from sklearn.linear_model import Lasso\nLasso = Lasso(alpha=1.5, fit_intercept=True, normalize=False, precompute=False, max_iter=10,\n              tol=0.001, selection='cyclic')\nLasso.fit(X_train, y_train)\nprint('Train Score ',Lasso.score(X_train, y_train).round(2))","6e7bb13a":"print('Test Score ',Lasso.score(X_test, y_test).round(2))","fe162a69":"y_pred = Lasso.predict(X_test)","e1e94509":"mae = mean_absolute_error(y_test,y_pred).round(2)\nr2 = r2_score(y_test,y_pred).round(2)\nprint('MAE = ',mae)\nprint('R2 = ',r2)","2e1f3116":"from sklearn.ensemble import RandomForestRegressor\nrnd_fr = RandomForestRegressor()","4c5fd359":"n_estimators = [int(x) for x in np.linspace(100,2000,20)]\ncriterion = ['mse','mae']\nmax_depth = [int(x) for x in np.linspace(5,60,12)]\nmin_samples_split = [2,5,7,10]\nmin_samples_leaf = [2,5,7]\nmax_features = ['auto','sqrt']","23279690":"random_grid = {'n_estimators':n_estimators,\n              'criterion': criterion,\n              'max_depth': max_depth,\n              'min_samples_split': min_samples_split,\n              'min_samples_leaf': min_samples_leaf,\n              'max_features': max_features}","b72537ea":"rand_cv = RandomizedSearchCV(rnd_fr,random_grid,cv =5,n_iter=10,n_jobs=-1,random_state=42)\nrand_cv.fit(X_train,y_train)","36bb3fcd":"rand_cv.best_params_","33666791":"rand_cv.score(X_train,y_train).round(2)","3d322a5a":"rand_cv.score(X_test,y_test).round(2)","ade95302":"y_pred=rand_cv.predict(X_test)","efa8cafc":"sns.distplot(y_test-y_pred)","3194e13b":"plt.scatter(y_test,y_pred)","739f9e85":"mae = mean_absolute_error(y_test,y_pred).round(2)\nr2 = r2_score(y_test,y_pred).round(2)\nprint('MAE = ',mae)\nprint('R2 = ',r2)","19670e96":"input_df = (19,0,20.1,1,2,0)\n# changing input_data to a numpy array\ninput_df = np.asarray(input_df)\n# reshape the array\ninput_df = input_df.reshape(1,-1)\nprediction = rand_cv.predict(input_df).round(2)\n\nprint('The insurance cost is USD ', prediction[0])","a219b0a5":"**The Highest Regions And Sex Have Max Number Of Children**","5cc21db4":"**Count Of Non_Smoker Based on Region And Sex and we Found Male Less Than Female In All Region**","9ce50d61":"**Mean Of Charges Based On Age &Sex**","f43dcf4a":"**Charges For Non_smoker With Min Number Of Children**","0591e0d2":"**below 18.5 \u2013 you're in the underweight range**\n\n**between 18.5 and 24.9 \u2013 you're in the healthy weight range**\n\n**between 25 and 29.9 \u2013 you're in the overweight range**\n\n**between 30 and 39.9 \u2013 you're in the obese range**\n\n**so we found all smokers have bmi isuues they are overweight\u00b6**","f39c33b8":"**Mean Of Charges Based on Region And Sex and we Found Male Always Baid More Than Female**","8c7b6d6b":"**Mean Of Charges Based on Region And Sex and we Found Male Always Baid More Than Female And They Was Baid More Than Female If They Smoker**","7e223bc3":"**Mean Of Age Of Sex Each Region**","43bfeaed":"**we have a right skewed in charges**","3c8b4271":"**EDA**","cb67caf6":"**Here we found count of smoker for each sex and percentage let us know the Female have a less percentage than Female**","4dc4b94e":"**Count Of Children For Eqach Sex And Region**","7dd93e3e":"**Data Preprocessing**","257c4310":"**Charges For Non_smoker With Max Number Of Children**","d2ef70ea":"**Now charges is cleare from outliers**","ed46a933":"**make Prediction Using Random Forest** ","4da31b2d":"**Assuming BMI follows A Gaussian Distribution we will calculate the boundaries which differentiates the outliers**","c1744d95":"Many outliers here in charges we need to handel it\n\n****If we have a skewed data we should using IQR technique to handle it****","422f6c1b":"**Count Of Smoker In Each Region Based On Sex**","379507f3":"**Build Modeling**","b525beeb":"**The Best Algorithm Is Random Forest Have A great Accuracy**","5c676edc":"**Now bmi is cleare from outliers**"}}