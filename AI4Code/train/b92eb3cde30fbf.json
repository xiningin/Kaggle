{"cell_type":{"b0fd2d39":"code","f2be4988":"code","3c9c490e":"code","65e50b10":"code","33583375":"code","9b211bb5":"code","7d4f48e5":"code","ae8efa51":"code","90fc1c0a":"code","fd50e017":"code","c02c642e":"code","cdd334a3":"code","ff6c25e6":"code","75973eac":"code","cb7a7d21":"code","03d335eb":"code","e628391e":"code","12934bc4":"code","b291a1ff":"code","3bfdc263":"code","406427ce":"code","69b207af":"code","639f5617":"code","472d9e14":"code","5e8b6fcc":"code","1c88c267":"code","0761aa8b":"code","f2bace12":"code","1a507ec6":"code","c80d9b8f":"code","4f49aa29":"code","8e1e9841":"code","aeb755a3":"code","ea634857":"code","5c188441":"code","55dd7774":"code","0ece80fc":"code","72882052":"code","69f89edc":"code","9b9af60f":"code","6458e28b":"code","3e9fc49a":"code","99928d72":"code","46b39de9":"code","c6d66a82":"code","4d1d8fdd":"code","b60449a1":"code","e2ff10bf":"markdown","f950e4bb":"markdown","cf886443":"markdown","abd2b02d":"markdown","f52ed8e6":"markdown","b20d5759":"markdown","e3290898":"markdown","cfab64c4":"markdown","23cd07b1":"markdown","34f1a98f":"markdown","db0c454d":"markdown","e362089b":"markdown","6f609b5d":"markdown","f5be5d3b":"markdown","326803d3":"markdown","ef59a62c":"markdown","66720225":"markdown","6b7d00db":"markdown","c53e811b":"markdown","6a149a6b":"markdown"},"source":{"b0fd2d39":"import pandas as pd\nfrom catboost import CatBoostClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import classification_report\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom wordcloud import WordCloud\nfrom tqdm import tqdm\nimport nltk\nfrom nltk.stem import WordNetLemmatizer\nfrom nltk.corpus import stopwords\nimport re\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.svm import SVC,LinearSVC\nfrom sklearn.ensemble import RandomForestClassifier,GradientBoostingClassifier\nfrom xgboost import XGBClassifier\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.experimental import enable_hist_gradient_boosting\nfrom sklearn.ensemble import HistGradientBoostingClassifier\nfrom imblearn.over_sampling import SMOTE\nimport plotly.express as px\nimport warnings\nwarnings.filterwarnings('ignore')\ndata=pd.read_csv('..\/input\/mbti-type\/mbti_1.csv')\ndata.head()","f2be4988":"data.describe(include='O')","3c9c490e":"data['type'].value_counts()","65e50b10":"data.info()","33583375":"data.posts[0]","9b211bb5":"# Stratify split to ensure equal distribution of data\n\ntrain_data,test_data=train_test_split(data,test_size=0.2,random_state=42,stratify=data.type)","7d4f48e5":"def clear_text(data):\n    data_length=[]\n    lemmatizer=WordNetLemmatizer()\n    cleaned_text=[]\n    for sentence in tqdm(data.posts):\n        sentence=sentence.lower()\n        \n#         removing links from text data\n        sentence=re.sub('https?:\/\/[^\\s<>\"]+|www\\.[^\\s<>\"]+',' ',sentence)\n    \n#         removing other symbols\n        sentence=re.sub('[^0-9a-z]',' ',sentence)\n    \n        \n        data_length.append(len(sentence.split()))\n        cleaned_text.append(sentence)\n    return cleaned_text,data_length","ae8efa51":"train_data.posts,train_length=clear_text(train_data)","90fc1c0a":"test_data.posts,test_length=clear_text(test_data)","fd50e017":"plt.figure(figsize=(15,10))\nsns.distplot(train_length,label='train data word length')\nsns.distplot(test_length,label='test data word length')\nplt.title('Number of words in text',fontdict={'size':20,'style':'italic'})\nplt.show()","c02c642e":"\npx.pie(train_data,names='type',title='Personality type',hole=0.3)\n","cdd334a3":"class Lemmatizer(object):\n    def __init__(self):\n        self.lemmatizer = WordNetLemmatizer()\n    def __call__(self, sentence):\n        return [self.lemmatizer.lemmatize(word) for word in sentence.split() if len(word)>2]","ff6c25e6":"vectorizer=TfidfVectorizer( max_features=5000,stop_words='english',tokenizer=Lemmatizer())\nvectorizer.fit(train_data.posts)","75973eac":"feature_names=vectorizer.get_feature_names()\nwc=WordCloud(max_words=400)\nwc.generate(' '.join(word for word in feature_names[500:3500] ))\nplt.figure(figsize=(20,15))\nplt.axis('off')\nplt.imshow(wc)","cb7a7d21":"train_post=vectorizer.transform(train_data.posts).toarray()\ntest_post=vectorizer.transform(test_data.posts).toarray()","03d335eb":"train_post.shape","e628391e":"target_encoder=LabelEncoder()\ntrain_target=target_encoder.fit_transform(train_data.type)\ntest_target=target_encoder.fit_transform(test_data.type)","12934bc4":"models_accuracy={}","b291a1ff":"model_log=LogisticRegression(max_iter=3000,C=0.5,n_jobs=-1)\nmodel_log.fit(train_post,train_target)","3bfdc263":"print('train classification report \\n ',classification_report(train_target,model_log.predict(train_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))","406427ce":"print('test classification report \\n',classification_report(test_target,model_log.predict(test_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))","69b207af":"models_accuracy['logistic regression']=accuracy_score(test_target,model_log.predict(test_post))","639f5617":"model_linear_svc=LinearSVC(C=0.1)\nmodel_linear_svc.fit(train_post,train_target)","472d9e14":"print('train classification report \\n ',classification_report(train_target,model_linear_svc.predict(train_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))\nprint('test classification report \\n',classification_report(test_target,model_linear_svc.predict(test_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))","5e8b6fcc":"models_accuracy['Linear Support Vector classifier']=accuracy_score(test_target,model_linear_svc.predict(test_post))","1c88c267":"model_svc=SVC()\nmodel_svc.fit(train_post,train_target)","0761aa8b":"\nprint('train classification report \\n ',classification_report(train_target,model_svc.predict(train_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))\nprint('test classification report \\n ',classification_report(test_target,model_svc.predict(test_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))","f2bace12":"models_accuracy['Support Vector classifier']=accuracy_score(test_target,model_svc.predict(test_post))","1a507ec6":"model_multinomial_nb=MultinomialNB()\nmodel_multinomial_nb.fit(train_post,train_target)","c80d9b8f":"\nprint('train classification report \\n ',classification_report(train_target,model_multinomial_nb.predict(train_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))\nprint('test classification report \\n ',classification_report(test_target,model_multinomial_nb.predict(test_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))","4f49aa29":"models_accuracy['Multinomial Naive Bayes']=accuracy_score(test_target,model_multinomial_nb.predict(test_post))","8e1e9841":"model_tree=DecisionTreeClassifier(max_depth=14)\nmodel_tree.fit(train_post,train_target)","aeb755a3":"\nprint('train classification report \\n ',classification_report(train_target,model_tree.predict(train_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))\nprint('test classification report \\n ',classification_report(test_target,model_tree.predict(test_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))","ea634857":"models_accuracy['Decision Tree classifier']=accuracy_score(test_target,model_tree.predict(test_post))","5c188441":"model_forest=RandomForestClassifier(max_depth=10)\nmodel_forest.fit(train_post,train_target)","55dd7774":"\nprint('train classification report \\n ',classification_report(train_target,model_forest.predict(train_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))\nprint('test classification report \\n ',classification_report(test_target,model_forest.predict(test_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))","0ece80fc":"models_accuracy['Random Forest Classifier']=accuracy_score(test_target,model_forest.predict(test_post))","72882052":"model_xgb=XGBClassifier(gpu_id=0,tree_method='gpu_hist',max_depth=5,n_estimators=50,learning_rate=0.1)\nmodel_xgb.fit(train_post,train_target)","69f89edc":"\nprint('train classification report \\n ',classification_report(train_target,model_xgb.predict(train_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))\nprint('test classification report \\n ',classification_report(test_target,model_xgb.predict(test_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))","9b9af60f":"models_accuracy['XGBoost Classifier']=accuracy_score(test_target,model_xgb.predict(test_post))","6458e28b":"model_cat=CatBoostClassifier(loss_function='MultiClass',eval_metric='MultiClass',task_type='GPU',verbose=False)\nmodel_cat.fit(train_post,train_target)","3e9fc49a":"\nprint('train classification report \\n ',classification_report(train_target,model_cat.predict(train_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))\nprint('test classification report \\n ',classification_report(test_target,model_cat.predict(test_post),target_names=target_encoder.inverse_transform([i for i in range(16)])))","99928d72":"models_accuracy['CatBoost Classifier']=accuracy_score(test_target,model_cat.predict(test_post))","46b39de9":"models_accuracy","c6d66a82":"models_accuracy.keys()","4d1d8fdd":"accuarcy=pd.DataFrame(models_accuracy.items(),columns=['Models','Test accuracy'])","b60449a1":"accuarcy.sort_values(by='Test accuracy',ascending=False,ignore_index=True).style.background_gradient(cmap='Blues')","e2ff10bf":"<h1 style=\"background-color:#99b3ff;font-family:newtimeroman;font-size:550%;text-align:center;border-radius: 15px 50px;padding: 5px\">Tokenizing words<\/h1>","f950e4bb":"<h1 style=\"background-color:#99b3ff;font-family:newtimeroman;font-size:550%;text-align:center;border-radius: 15px 50px;padding: 5px\">Libraries used<\/h1>\n","cf886443":"### Function to clean the text data.","abd2b02d":"So for example, someone who prefers introversion, intuition, thinking and perceiving would be labelled an INTP in the MBTI system, and there are lots of personality based components that would model or describe this person\u2019s preferences or behaviour based on the label.\n\nIt is one of, if not the, the most popular personality test in the world. It is used in businesses, online, for fun, for research and lots more. A simple google search reveals all of the different ways the test has been used over time. It\u2019s safe to say that this test is still very relevant in the world in terms of its use.","f52ed8e6":"<h4 style=\"background-color:#cc99ff;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;padding: 5px \">Random Forest Classifier<\/h4>","b20d5759":"<h1 style=\"background-color:#99b3ff;font-family:newtimeroman;font-size:550%;text-align:center;border-radius: 15px 50px;padding: 5px\">Model selection<\/h1>","e3290898":"<center><img src=\"https:\/\/i.pinimg.com\/originals\/37\/20\/f7\/3720f720e221931c806e31bb0439b725.png\",height='500',width='600'><\/center>","cfab64c4":"<h4 style=\"background-color:#cc99ff;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;padding: 5px \">XGBoost Classifier<\/h4>","23cd07b1":"<h4 style=\"background-color:#cc99ff;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;padding: 5px \">Logistic Regression<\/h4>","34f1a98f":"<font style=\"color: red;font-size:200%;text-align:center;border-radius: 15px 50px;padding: 5px \"><center>Hope you liked this notebook. If you did please upvote it!! If having any query or suggestion, feel free to ask in comment section.<\/center><\/font>","db0c454d":"<h4 style=\"background-color:#cc99ff;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;padding: 5px \">CatBoost Classifier<\/h4>","e362089b":"### Catboost model seems to perform well in predicting values.","6f609b5d":"<h1 style=\"background-color:#1aff1a;font-family:newtimeroman;font-size:550%;text-align:center;border-radius: 15px 50px;padding: 5px\">What's your personality ?<\/h1>\n","f5be5d3b":"<h4 style=\"background-color:#cc99ff;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;padding: 5px \">Decision Tree Classifier<\/h4>","326803d3":"<h4 style=\"background-color:#cc99ff;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;padding: 5px \">Multinomial Naive Bayes<\/h4>","ef59a62c":"### From above it is quite evident that there are many links in the text data. That needed to be removed.","66720225":"<h4 style=\"background-color:#cc99ff;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;padding: 5px \">Support Vector classifier<\/h4>","6b7d00db":"<h1 style=\"background-color:#bbf223;font-family:newtimeroman;font-size:350%;text-align:center;border-radius: 15px 50px;padding: 5px\">overview of dataset<\/h1>\n","c53e811b":"<h4 style=\"background-color:#cc99ff;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;padding: 5px \">Linear Support Vector classifier<\/h4>","6a149a6b":"The Myers Briggs Type Indicator (or MBTI for short) is a personality type system that divides everyone into 16 distinct personality types across 4 axis:\n\n    Introversion (I) \u2013 Extroversion (E)\n    Intuition (N) \u2013 Sensing (S)\n    Thinking (T) \u2013 Feeling (F)\n    Judging (J) \u2013 Perceiving (P)"}}