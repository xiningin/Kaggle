{"cell_type":{"e01c2a1f":"code","fd12a095":"code","40b89a09":"code","d9d27cae":"code","e1dff2fd":"code","359b1f9b":"code","32ffea98":"code","49ad0d55":"code","0c8f844e":"code","193b1724":"code","5fe08058":"code","e135d9e5":"code","62f6d225":"code","3331af0c":"code","43206ff1":"markdown","9144fe4c":"markdown","033c476d":"markdown","ac9ba9b2":"markdown","7040f448":"markdown","4781ca0d":"markdown","ead6c6bb":"markdown","33ef839f":"markdown","d28a21bb":"markdown","4db4ad50":"markdown","8bf3e61b":"markdown","6393cbb8":"markdown","bb8b74f8":"markdown","303d47f7":"markdown","221174e5":"markdown","ee365080":"markdown"},"source":{"e01c2a1f":"import pandas as pd\nimport numpy as np\nfrom catboost import CatBoostClassifier, Pool\n\nfrom sklearn.model_selection import train_test_split","fd12a095":"SEED = 1981\nindex_col = 'match_id_hash'\nPATH_TO_DATA = '..\/input\/mlcourse-dota2-win-prediction\/'","40b89a09":"df_train = pd.read_csv(PATH_TO_DATA + 'train_features.csv', index_col=index_col)\ndf_targets = pd.read_csv(PATH_TO_DATA + 'train_targets.csv', index_col=index_col)","d9d27cae":"X_train, X_valid, y_train, y_valid = train_test_split(df_train, df_targets['radiant_win'].astype('int'), test_size=0.2, random_state=SEED)","e1dff2fd":"cat_features = []\nparams_cb = {\n    'loss_function': 'Logloss',\n    'eval_metric': 'AUC',\n    'verbose': 100,\n    'random_seed': SEED,\n    'thread_count': -1,\n    'iterations':1000,\n}\n\nmodel_cb = CatBoostClassifier(**params_cb)","359b1f9b":"model_cb.fit(\n    X_train,\n    y_train,\n    cat_features=cat_features,\n    eval_set=(X_valid, y_valid),\n    logging_level='Verbose',\n    plot=True)","32ffea98":"df_targets_upsample = df_targets.reset_index()\ndf_targets_upsample['match_id_hash'] = df_targets_upsample['match_id_hash'] + '_up'\ndf_targets_upsample.set_index('match_id_hash', inplace=True)\ndf_targets_upsample['radiant_win'] = df_targets_upsample['radiant_win'].map({False: True, True: False})\n\ndf_targets = df_targets.append(df_targets_upsample, sort=False)","49ad0d55":"df_train_upsample = df_train.reset_index()\ndf_train_upsample['match_id_hash'] = df_train_upsample['match_id_hash'] + '_up'\ndf_train_upsample.set_index('match_id_hash', inplace=True)","0c8f844e":"columns_names = df_train_upsample.columns\ncol_dict = {}\nfor col in columns_names:\n    new_col = col\n    if col[0] == 'd':\n        new_col = col.replace('d', 'r', 1)\n\n    elif col[0] == 'r':\n        new_col = col.replace('r', 'd', 1)\n    col_dict[col] = new_col","193b1724":"for i in range(1, 6):\n    df_train_upsample[f'd{i}_y'] = 186 - df_train_upsample[f'd{i}_y'] + 70\n    df_train_upsample[f'r{i}_y'] = 186 - df_train_upsample[f'r{i}_y'] + 70\n    \n    df_train_upsample[f'd{i}_x'] = 186 - df_train_upsample[f'd{i}_x'] + 66\n    df_train_upsample[f'r{i}_x'] = 186 - df_train_upsample[f'r{i}_x'] + 66    ","5fe08058":"df_train_upsample.rename(columns=col_dict, inplace=True)","e135d9e5":"df_train = df_train.append(df_train_upsample, sort=False)","62f6d225":"X_train, X_valid, y_train, y_valid = train_test_split(df_train, df_targets['radiant_win'].astype('int'), test_size=0.2, random_state=SEED)","3331af0c":"model_cb.fit(\n    X_train,\n    y_train,\n    cat_features=cat_features,\n    eval_set=(X_valid, y_valid),\n    logging_level='Verbose',\n    plot=True)","43206ff1":"# Data loading","9144fe4c":"# What do we have?","033c476d":"# Time to check what we got","ac9ba9b2":"**Let's make dataset two times bigger by swap dire and radiants with changing target to opposite of course.**","7040f448":"# What do we have?","4781ca0d":"## Upvote this kernel then","ead6c6bb":"# Some Imports","33ef839f":"We used CatBoost and unmodified dataset to get some baseline score. We got 0.8010972357 like this.\nI hope no one will keep this features in real models.\n\nI wanna show how to get better score with features what you have.","d28a21bb":"**Let's rename columns. Dire will become radiants and Radiants will become Dire**","4db4ad50":"* We got + 0.01 score\n* More good features you have more you can get from it","8bf3e61b":"# Train Upsample","6393cbb8":"# Found it interesting? Wanna More Secrets?","bb8b74f8":"# Target Upsample","303d47f7":"Main topic of this kernel is how to improve your score with features and settigs what you already have.\n\nLet's look down...","221174e5":"# CatBoost Baseline","ee365080":"** Let's mirror coordinates**"}}