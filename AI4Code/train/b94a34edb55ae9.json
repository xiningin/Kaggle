{"cell_type":{"b01bd840":"code","7385c029":"code","5f2d4af1":"code","3e7d285d":"code","e5493b85":"code","a462a68c":"code","e1aa609f":"code","33d43ea6":"code","9221dfc7":"code","0cbc5aa7":"code","d20fcaa0":"code","7fd140a9":"code","2c080995":"code","4aad485b":"code","f3b69654":"code","9c1f4b4d":"code","2991bf24":"code","5a0ca8a4":"code","f8e6c874":"code","220d6598":"code","17cac134":"code","9ce36a0a":"code","177b78cf":"code","5d3ebb0f":"code","9c9c5184":"code","6d761f7c":"code","cd36e74a":"code","1c37c185":"markdown","27d7cfcc":"markdown","8b1ae8ab":"markdown","7196a90d":"markdown","2f8b56ee":"markdown","a6333f31":"markdown","77cc4ee0":"markdown","e8d6a37b":"markdown","f2778631":"markdown","80a2895d":"markdown","506ececc":"markdown","bce31ddc":"markdown","ef4ad3f6":"markdown","ff3e455e":"markdown","16416c89":"markdown","dbbfbc7e":"markdown","43903f76":"markdown","5de5b9c8":"markdown","3c2076b5":"markdown","9cc40309":"markdown"},"source":{"b01bd840":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","7385c029":"dataset = pd.read_csv(\"..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv\")","5f2d4af1":"dataset.head()","3e7d285d":"print(f\"The shape of given data is {dataset.shape}\")\nprint(f'The different column label:  {list(dataset.columns)}')\nprint(f\"The Sample Data coinsist of people of age between {dataset['age'].min()} to {dataset['age'].max()}\")","e5493b85":"dataset.describe()","a462a68c":"print(\"The categorial cols are : \", ['sex','exng','caa','cp','fbs','restecg','slp','thall', 'output'])\nprint(\"The non categorial cols are : \", [\"age\",\"trtbps\",\"chol\",\"thalachh\",\"oldpeak\"])","e1aa609f":"dataset.isna().sum()","33d43ea6":"dataset.dtypes","9221dfc7":"from plotly.subplots import make_subplots\nimport plotly.graph_objects as go\n\nfig = make_subplots(\n    rows=2, cols=4,\n    subplot_titles=(\"Blood sugar\", \"Included engina\",\"Sex\", \"Electrocardiographic results\", \"Slope\", \"Target\", \"Chest pain type\", \"Number of major vessels\"),\n    specs=[[{\"type\": \"domain\"}, {\"type\": \"domain\"}, {\"type\": \"domain\"}, {\"type\": \"domain\"}],\n           [{\"type\": \"domain\"}, {\"type\": \"domain\"}, {\"type\": \"domain\"}, {\"type\": \"domain\"}]]\n)\nfig.add_trace(\n    go.Pie(labels=['True', 'False'], values=[(dataset['fbs'] == 1).sum(), (dataset['fbs'] == 0).sum()]),\n    row=1, col=1\n)\nfig.add_trace(\n    go.Pie(labels=['Yes', 'No'], values=[(dataset['exng'] == 1).sum(), (dataset['exng'] == 0).sum()]),\n    row=1, col=2\n)\nfig.add_trace(\n    go.Pie(labels=['T-T wave normality', 'Normal', 'Left ventricular hypertrophy'], values=[(dataset['restecg'] == 1).sum(), (dataset['restecg'] == 0).sum(), (dataset['restecg'] == 2).sum()]),\n    row=1, col=4\n)\nfig.add_trace(\n    go.Pie(labels=['Male', 'Female'], values=[(dataset['sex'] == 1).sum(), (dataset['sex'] == 0).sum()]),\n    row=1, col=3\n)\nfig.add_trace(\n    go.Pie(labels=['Atypical Angina', 'Typical Angina', 'Non-anginal Pain', 'Asymptomatic'], values=[(dataset['cp'] == 1).sum(), (dataset['cp'] == 0).sum(), (dataset['cp'] == 2).sum(), (dataset['cp'] == 3).sum()]),\n    row=2, col=3\n)\nfig.add_trace(\n    go.Pie(labels=['Yes', 'No'], values=[(dataset['slp'] == 1).sum(), (dataset['slp'] == 0).sum()]),\n    row=2, col=1\n)\nfig.add_trace(\n    go.Pie(labels=['Have diseases', 'Does not have diseases'], values=[(dataset['output'] == 1).sum(), (dataset['output'] == 0).sum()]),\n    row=2, col=2\n)\nfig.add_trace(\n    go.Pie(labels=['1', '0', '2', '3', '4'], values=[(dataset['caa'] == 1).sum(), (dataset['output'] == 0).sum(), (dataset['caa'] == 2).sum(), (dataset['caa'] == 3).sum(), (dataset['caa'] == 4).sum()]),\n    row=2, col=4\n)\n\nfig.update_layout(height=800, width=1100, title_text=\"Distribuation of Categorial Values\", showlegend=False)\nfig.show()","0cbc5aa7":"fig = make_subplots(\n    rows=2, cols=2,\n)\nfig.add_trace(go.Histogram(x=dataset.age, name='Age of the patient'),\n              row=1, col=1)\nfig.add_trace(go.Histogram(x=dataset.trtbps, name='Resting blood pressure'),\n              row=1, col=2)\nfig.add_trace(go.Histogram(x=dataset.chol, name=' Cholestoral'),\n              row=2, col=1)\nfig.add_trace(go.Histogram(x=dataset.thalachh, name='Maximum heart rate'),\n              row=2, col=2)\n\nfig.update_xaxes(title_text=\"age\", row=1, col=1)\nfig.update_xaxes(title_text=\"trtbps\", row=1, col=2)\nfig.update_xaxes(title_text=\"chol\", row=2, col=1)\nfig.update_xaxes(title_text=\"thalachh\", row=2, col=2)\n\nfig.update_yaxes(title_text=\"count\", row=1, col=1)\nfig.update_yaxes(title_text=\"count\", row=1, col=2)\nfig.update_yaxes(title_text=\"count\", row=2, col=1)\nfig.update_yaxes(title_text=\"count\", row=2, col=2)\n\nfig.update_layout(title_text=\"Distribution of Continuous features\", showlegend=False)\n\nfig.show()","d20fcaa0":"import matplotlib.pyplot as plt\nfrom seaborn.matrix import heatmap\nplt.figure(figsize=(17,9))\nheatmap(dataset.corr(), cmap='Blues', annot=True)\nplt.title('Correlation Matrix');","7fd140a9":"fig = make_subplots(\n    rows=2, cols=4,\n)\nfig.add_trace(go.Bar(x=dataset.cp,y=dataset.output, name='Chest pain'),\n              row=1, col=1)\nfig.add_trace(go.Bar(x=dataset.sex,y=dataset.output, name='Sex of the patient'),\n              row=1, col=2)\nfig.add_trace(go.Bar(x=dataset.exng,y=dataset.output, name='Exercise induced angina'),\n              row=1, col=3)\nfig.add_trace(go.Bar(x=dataset.fbs,y=dataset.output, name='fasting blood sugar'),\n              row=1, col=4)\nfig.add_trace(go.Bar(x=dataset.caa,y=dataset.output, name='Number of major vessels'),\n              row=2, col=1)\nfig.add_trace(go.Bar(x=dataset.slp,y=dataset.output, name='Slope'),\n              row=2, col=2)\nfig.add_trace(go.Bar(x=dataset.restecg,y=dataset.output, name='Resting electrocardiographic'),\n              row=2, col=3)\nfig.add_trace(go.Bar(x=dataset.thall,y=dataset.output, name='Thalium Stress Test result'),\n              row=2, col=4)\nfig.update_layout(height=800, width=1100, title_text=\"Distribution of categorical features according to target variable\", showlegend=False)\n\nfig.update_xaxes(title_text=\"cp\", row=1, col=1)\nfig.update_xaxes(title_text=\"sex\", row=1, col=2)\nfig.update_xaxes(title_text=\"exng\", row=1, col=3)\nfig.update_xaxes(title_text=\"fbs\", row=1, col=4)\nfig.update_xaxes(title_text=\"caa\", row=2, col=1)\nfig.update_xaxes(title_text=\"slp\", row=2, col=2)\nfig.update_xaxes(title_text=\"restecg\", row=2, col=3)\nfig.update_xaxes(title_text=\"thall\", row=2, col=4)\n\nfig.update_yaxes(title_text=\"Number of Target patient\", row=1, col=1)\nfig.update_yaxes(title_text=\"Number of Target patient\", row=2, col=1)\n\n\nfig.show()","2c080995":"import seaborn as sns\nsns.pairplot(dataset,hue='output')\nplt.show()","4aad485b":"#Encoding\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.compose import ColumnTransformer\n\n## Models\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.naive_bayes import GaussianNB\n\n## Model evaluators\nfrom sklearn.model_selection import train_test_split, cross_val_score\nfrom sklearn.model_selection import RandomizedSearchCV, GridSearchCV\nfrom sklearn.metrics import confusion_matrix, classification_report\nfrom sklearn.metrics import precision_score, recall_score, f1_score, accuracy_score\nfrom sklearn.metrics import plot_roc_curve","f3b69654":"X = dataset.drop('output', axis=1)\ny = dataset.output","9c1f4b4d":"#Encoding\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.compose import ColumnTransformer\n\ncat_feature = ['sex','exng','caa','cp','fbs','restecg','slp','thall']\n\none_hot = OneHotEncoder()\n\ntransformer = ColumnTransformer([('one_hot', one_hot, cat_feature)],\n                                remainder='passthrough')\ntransformed_X = transformer.fit_transform(X)\npd.DataFrame(transformed_X)","2991bf24":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(transformed_X, y, test_size = 0.3)","5a0ca8a4":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)","f8e6c874":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.naive_bayes import GaussianNB","220d6598":"model = {'LogisticRegression' : LogisticRegression(),\n         'KNeighborsClassifier': KNeighborsClassifier(),\n         \n         'DecisionTreeClassifier': DecisionTreeClassifier(),\n         'RandomForestClassifier' : RandomForestClassifier(),\n         'Native_Bayes': GaussianNB()}\n\ndef model_fit_score(model, X_train, X_test, y_train, y_test):\n  model_score = {}\n  for name, model in model.items():\n    model.fit(X_train, y_train) \n    y_pred_proba = model.predict_proba(X_test)\n    y_pred = np.argmax(y_pred_proba,axis=1)\n    model_score[name] = model.score(X_test, y_test)\n  return model_score  ","17cac134":"model_fit_score(model, X_train, X_test, y_train, y_test)","9ce36a0a":"from sklearn.model_selection import RandomizedSearchCV\nfrom sklearn.model_selection import train_test_split\ngrid = {\"n_estimators\": [10, 100, 200, 500, 1000, 1200],\n         \"max_depth\": [None, 5, 10, 20, 30],\n         \"max_features\": [\"auto\", \"sqrt\"],\n         \"min_samples_split\": [2,4,6],\n         \"min_samples_leaf\": [1, 2, 4]}\nnp.random.seed(42)\nclf = RandomForestClassifier(n_jobs=-1)\nrs_clf = RandomizedSearchCV(estimator=clf,\n                            param_distributions = grid,\n                            n_iter=30,\n                            cv = 5,\n                            verbose = 2)\nrs_clf.fit(X_train, y_train);","177b78cf":"rs_clf.best_params_","5d3ebb0f":"def evaluate_preds(y_true, y_preds):\n  accuracy = accuracy_score(y_true, y_preds)\n  precision = precision_score(y_true, y_preds)\n  recall = recall_score(y_true, y_preds)\n  f1 = f1_score(y_true, y_preds)\n  print(f\"Acc : {round(accuracy, 2) * 100:.2f}%\")\n  print(f\"Precision : {round(precision, 2):.2f}\")\n  print(f\"recall : {round(recall, 2):.2f}\")\n  print(f\"F1 score {round(f1, 2):.2f}\")\n\n   ","9c9c5184":"evaluate_preds(y_test, rs_clf.predict(X_test))","6d761f7c":"from sklearn.metrics import  roc_curve\n\n# Make prediction with probability \ny_probs = rs_clf.predict_proba(X_test)\n\ny_probs_positive = y_probs[:, 1] #axis = 1\n\nfpr, tpr, threshold = roc_curve(y_test, y_probs_positive)\n\nfpr","cd36e74a":"import matplotlib.pyplot as plt\nfig, ax = plt.subplots()\nax.plot(fpr, tpr)\nax.plot([0,1], [0,1])\nax.set(title=\"ROC Curve\",\n        xlabel=\"fpr\",\n        ylabel=\"tpr\",)\nplt.show()","1c37c185":"## 2.3 Undestanding Dataset","27d7cfcc":"## 1.2 Prerequisite\n* For virtuilisation I have used plotly library.\n\n* For modeling I have used scikit-learn library.\n\n* Short form are used in dataset column so assist dictionary for its full form\n\n* Feel free to leave any ideas or links to other datasets and notebooks that you feel would benefit this notebook.\n\n* If you like this project then please upvote this is my frist ever project on kaggle\n","8b1ae8ab":"## 2.1 Importing library","7196a90d":"# 3 Exploratory data analysis","2f8b56ee":"## 3.2 Data visual of non categorical data ","a6333f31":"# 4 Observation and Conclusion from data exploring and EDA\n\n","77cc4ee0":"# 2 Data exploration","e8d6a37b":"## 3.5 Pairplot","f2778631":"## From 2.3 Data understanding\n1. There are no missing values in the data therefore we can fit model directly without any imputation to missing data.\n\n2. There are no alphabetical data and model will fit directly scikit learn classification model required only numerical data.\n\n3. There are some categorical data column therefore we will use Encoder to preprocess the data, its very important (we will use data with and without encoding to see the result)\n","80a2895d":"# 1. Introduction\n","506ececc":"## From EDA\n1. There is no linear correlation between continuous variable according to the heatmap.\n\n2. The scatterplot heatmap matrix suggests that there might be some correlation between output and cp, output and thalachh, output and slp\n\n3. According to the 3.4 distribution plot.\n\n  * People with Non-Anginal chest pain, that is with cp = 2 have higher number of heart attack case.\n\n  * People with sex = 1 have higher number of heart attack case.\n\n  * People with no exercise induced angina, that is with exng = 0 have higher number of heart attack case.\n\n  * People with 0 major vessels, that is with caa = 0 have number of heart attack case.\n\n  * People with thall = 2 have much higher number of heart attack case.\n","bce31ddc":"## 1.3 Objective\n* Exploratory data analysis (EDA) of dataset \n\n* Analyse the possibilities of heart attack\n\n* Save the model with using pikel library","ef4ad3f6":"## 2.2 Importing Dataset","ff3e455e":"# 5 Modeling","16416c89":"## 3.3 Correlation matrix\n","dbbfbc7e":"## 3.4 Count of target variable according to continuous features","43903f76":"## 1.1 Acknowledgement\nI would like to express my special thanks of gratitude to @Rashik Rahman for providing this dataset and this work would not have been possible without the dataset","5de5b9c8":"## 1.4 Heart Disease Data Dictionary\n* age - Age of the patient\n\n* sex - Sex of the patient\n\n* slp - Slope \n\n* trtbps - Resting blood pressure (in mm Hg)\n\n* thall - Thalium Stress Test result from 0 to 3 \n\n* fbs - If fasting blood sugar > 120 mg\/dl then true else false (1 = True, 0 = False)\n\n* caa - Number of major vessels \n\n* thalachh - Maximum heart rate achieved\n\n* exng - Exercise induced angina (1 = Yes, 0 = No) \n\n* cp - Chest pain type (0 = Typical Angina, 1 = Atypical Angina, 2 = Non-anginal Pain, 3 = Asymptomatic)\n\n* restecg - Resting electrocardiographic results (0 = Normal, 1 = ST-T wave normality, 2 = Left ventricular hypertrophy)\n\n* chol - Cholestoral in mg\/dl fetched via BMI sensor\n\n* oldpeak - Previous peak\n\n* output - Target ","3c2076b5":"## 5.1 Importing Packages\n","9cc40309":"## 3.1 Data visual of categorical data"}}