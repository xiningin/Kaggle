{"cell_type":{"3af3b998":"code","c644cf86":"code","559eb245":"code","db26b467":"code","0ff37889":"code","0ec99405":"code","49e39392":"code","fb5062a9":"code","36dd5ce6":"code","d3bf35b3":"code","b36312ca":"code","3e0a4385":"code","05d11721":"code","f84d66e1":"code","ccccdfcf":"code","dd7604a6":"code","a71ce15a":"markdown","d53ce328":"markdown","c6e9b845":"markdown","c7bd3129":"markdown","062bb42f":"markdown","ae433065":"markdown","27bc1bb7":"markdown","a612c424":"markdown","dfb677ea":"markdown","12090af5":"markdown","77aab177":"markdown"},"source":{"3af3b998":"from fastai.vision.all import *\nfrom fastai.vision.widgets import *\nfrom fastai.metrics import accuracy, Precision, Recall\nfrom sklearn.metrics import classification_report\nimport numpy as np\nfrom sklearn.metrics import confusion_matrix\nfrom fastai.data.transforms import GrandparentSplitter","c644cf86":"#path to data to train and evaluate our deep learning model\n#DATASET_PATH = Path('\/kaggle\/input\/malaria-species\/malaria_species_identification\/train')\nDATASET_PATH = Path('\/kaggle\/input\/malaria-species\/malaria_species_identification')","559eb245":"# Transformations are applied only on training dataset\nmask_datablock = DataBlock(\n    blocks=(ImageBlock, CategoryBlock), \n    get_items=get_image_files, \n    splitter=GrandparentSplitter(train_name='train', valid_name='test'),\n    #splitter=RandomSplitter(valid_pct=0.2, seed=100),\n    get_y=parent_label,\n    item_tfms=RandomResizedCrop(224, min_scale=0.3),\n    batch_tfms=aug_transforms(mult=2)\n)","db26b467":"dls = mask_datablock.dataloaders(DATASET_PATH)","0ff37889":"data = mask_datablock.dataloaders(DATASET_PATH, bs=64)\ndata.show_batch()","0ec99405":"#data.show_batch(nrows=4)","49e39392":"learn = cnn_learner(dls, resnet34, metrics=[error_rate, accuracy, Precision(average='macro'),\n               Recall(average='macro')])","fb5062a9":"learn.fine_tune(16)","36dd5ce6":"interp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_confusion_matrix()","d3bf35b3":"learn.show_results()","b36312ca":"#most common specie\ndata.show_batch(nrows=4)","3e0a4385":"interp.plot_top_losses(4, nrows=4)","05d11721":"preds, y_true=learn.get_preds()\ny_true.shape, preds.shape","f84d66e1":"y_true=y_true.numpy() \npreds=np.argmax(preds.numpy(), axis=-1)\ny_true.shape, preds.shape","ccccdfcf":"classes = list(data.vocab)\nreport = classification_report(y_true, preds, target_names=classes)\nprint(report)","dd7604a6":"learn.export()","a71ce15a":"**Malaria Parasite Species Classification**","d53ce328":"The code below will create a datablock which will format our data to create train and validation set which will be used evaluate our model.\n\nData transformation will be applied to our train data to help increase accuracy of model\/algorithm","c6e9b845":"**Program Flow**:\n\n1. Import necessary packages\n2. Specify path to our data\n3. Define Datablock which will create train(80% of data) and validation set(20% of data). Our model will run on the train data and evaluate on the validation set to know how well it performs. Data transformation is also applied to help increase accuracy.\n4. Show samples of our data\n5. Train our model and evaluate on validation\/test set, also output evaluation score of model.","c7bd3129":"Falciparum is the most common specie from our analysis.","062bb42f":"Our model accuracy shows that approximately 1 of every 10 labels is incorrect, and 9 is correct.\n\nprecision shows that approximately 1 of every 10 labels by our program is false, and 9 is true.\n\nrecall\/sensitivity shows that approximately 1 of every 10 true label in reality are missed by our program and 9 labeled as true","ae433065":"The diagram above is called a 'confusion matrix'. This matrix shows us that our model correctly predicted Falciparum and Vivax classes.","27bc1bb7":"The diagram above shows us classes our model correctly predicted and those it missed.","a612c424":"The code below will use a pretrained deep learning model called 'resnet34' which is already trained on other image data. This process is called 'transfer learning' and will also assist to build more accurate model. The code will also calculate the error_rate, accuracy, precision, recall of the model after training and evaluating on the validation set.","dfb677ea":"The code below will show sample images of data in our train set. Our data include 4 classes of malaria parasite species which include: Ovale, Falciparum, Vivax, Malariae","12090af5":"This program will train our algorithm or model using our train data and evaluate on validation set to know how our model performs.","77aab177":"import necessary package which is necessary to build our model. This task uses fastai to build and evaluate the deep learning model"}}