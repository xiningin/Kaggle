{"cell_type":{"4b5ba28c":"code","6bf74017":"code","c9e331eb":"code","21bb73ef":"code","dab3bab8":"code","349fe285":"code","2d4ecc42":"code","072bde4a":"code","587bfa2e":"code","ea84e510":"code","1b2a5f78":"code","1687d135":"code","530b2201":"code","9697c712":"code","d2251aa5":"code","7e155c15":"code","ba71ea99":"code","ad130b42":"code","05d839d9":"code","fc479bfd":"code","fbf0da07":"code","3fad3533":"code","9992901b":"code","9611cb0f":"code","77f4dec8":"code","f53e2a25":"code","ec5e8479":"code","e7f0e4fb":"code","3ffd8d57":"code","53d4d282":"code","2ec8efc6":"code","6fef12fe":"code","719e813d":"code","004acced":"code","b8e3f97d":"code","3b377182":"markdown","e42a82e3":"markdown","bb7517f2":"markdown","a60ddb4b":"markdown","edd1adb2":"markdown","d6022f54":"markdown","c50aa97c":"markdown","c63020cb":"markdown","dce692e3":"markdown","35bae581":"markdown","417145ec":"markdown","bb623c40":"markdown","c9bd129b":"markdown","d6225547":"markdown","69240245":"markdown","c8faf44e":"markdown","1a0eaf87":"markdown","42ab6304":"markdown","5e798e32":"markdown","60afe4f2":"markdown","c293108d":"markdown"},"source":{"4b5ba28c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport geopandas as gp\n\nimport seaborn as sns\nimport matplotlib as mpl\nimport matplotlib.pylab as plt\nplt.style.use('ggplot')\n\nimport folium\nfrom folium import plugins\nfrom io import StringIO\n\nfrom plotly.offline import init_notebook_mode, iplot\nimport plotly.graph_objs as go\nimport plotly.plotly as py\nfrom plotly import tools\nimport plotly.figure_factory as ff\nimport plotly.tools as tls\n\nimport numpy\n\ninit_notebook_mode(connected=True)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\nprint(os.listdir(\"..\/input\/cpe-data\"))\n\n\n# Any results you write to the current directory are saved as output.","6bf74017":"print(os.listdir(\"..\/input\/cpe-data\/Dept_11-00091\"))\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_23-00089\"))\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_35-00103\"))\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_37-00049\"))\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_37-00027\"))\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_49-00009\"))","c9e331eb":"print(\"Get the list of files in department Dept_11-00091\")\nprint(\"--------------------------------------------------------------\")\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\"))\nprint(\"--------------------------------------------------------------\")\nprint(\"\")\nprint(\"--------------------------------------------------------------\")\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_education-attainment-over-25\"))\nprint(\"--------------------------------------------------------------\")\nprint(\"\")\nprint(\"--------------------------------------------------------------\")\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_poverty\"))\nprint(\"--------------------------------------------------------------\")\nprint(\"\")\nprint(\"--------------------------------------------------------------\")\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_education-attainment\"))\nprint(\"--------------------------------------------------------------\")\n\ndf_shape_d11 = gp.read_file(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_Shapefiles\")\nprint(\"Rows & columns of ACS_variable_descriptions \", df_shape_d11.shape)","21bb73ef":"print(\"\")\nprint(\"--------------------------------------------------------------\")\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_owner-occupied-housing\"))\nprint(\"--------------------------------------------------------------\")\nprint(\"\")\nprint(\"\")\ndf_edu_o25 = pd.read_csv(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_education-attainment-over-25\/ACS_16_5YR_B15003_with_ann.csv\")\nprint(\"Rows & columns of ACS_variable_descriptions \", df_edu_o25.shape)","dab3bab8":"df_edu_o25.head(3)","349fe285":"print(\"\")\nprint(\"--------------------------------------------------------------\")\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_owner-occupied-housing\"))\nprint(\"--------------------------------------------------------------\")\nprint(\"\")\ndf_own = pd.read_csv(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_owner-occupied-housing\/ACS_16_5YR_S2502_with_ann.csv\")\nprint(\"Rows & columns of ACS_variable_descriptions \", df_own.shape)","2d4ecc42":"df_own.head(3)","072bde4a":"print(\"\")\nprint(\"--------------------------------------------------------------\")\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_race-sex-age\"))\nprint(\"--------------------------------------------------------------\")\nprint(\"\")\ndf_race = pd.read_csv(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_race-sex-age\/ACS_15_5YR_DP05_with_ann.csv\")\nprint(\"Rows & columns of ACS_variable_descriptions \", df_race.shape)","587bfa2e":"df_race.head(3)","ea84e510":"print(\"\")\nprint(\"--------------------------------------------------------------\")\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_poverty\"))\nprint(\"--------------------------------------------------------------\")\nprint(\"\")\ndf_pov = pd.read_csv(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_poverty\/ACS_16_5YR_S1701_with_ann.csv\")\nprint(\"Rows & columns of ACS_variable_descriptions \", df_pov.shape)","1b2a5f78":"df_pov.head(3)","1687d135":"print(\"\")\nprint(\"--------------------------------------------------------------\")\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_education-attainment\"))\nprint(\"--------------------------------------------------------------\")\nprint(\"\")\ndf_edu = pd.read_csv(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_education-attainment\/ACS_16_5YR_S1501_with_ann.csv\")\nprint(\"Rows & columns of ACS_variable_descriptions \", df_edu.shape)","530b2201":"df_edu.head(3)","9697c712":"print(os.listdir(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_race-sex-age\/\"))","d2251aa5":"basepath = \"..\/input\/cpe-data\/Dept_11-00091\/11-00091_ACS_data\/11-00091_ACS_race-sex-age\/\"\ndf_11 = pd.read_csv(basepath + \"ACS_15_5YR_DP05_with_ann.csv\")\ndf_11.head(3)\na_df = pd.read_csv(basepath + \"ACS_15_5YR_DP05_metadata.csv\")\na_df.head()","7e155c15":"single_age_df = df_11[[\"HC01_VC26\", \"HC01_VC27\", \"HC01_VC28\", \"HC01_VC29\"]][1:]\nops = [1, 0.85, 0.75, 0.65, 0.55, 0.45]\ntraces = []\nfor i, col in enumerate(single_age_df.columns):\n    nm = a_df[a_df[\"GEO.id\"] == col][\"Id\"].iloc(0)[0].replace(\"Estimate; SEX AND AGE - \", \"\")\n    trace = go.Bar(x=df_11[\"GEO.display-label\"][1:], y=single_age_df[col], name=nm, marker=dict(opacity=0.6))\n    traces.append(trace)\nlayout = dict(barmode=\"stack\", title=\"Breakdown by age \", margin=dict(b=100), height=600, legend=dict(x=-0.1, y=1, orientation=\"h\"))\nfig = go.Figure(data=traces, layout=layout)\niplot(fig)","ba71ea99":"single_race_df = df_11[[\"HC01_VC49\", \"HC01_VC50\", \"HC01_VC51\", \"HC01_VC56\", \"HC01_VC64\", \"HC01_VC69\"]][1:]\nops = [1, 0.85, 0.75, 0.65, 0.55, 0.45]\ntraces = []\nfor i, col in enumerate(single_race_df.columns):\n    nm = a_df[a_df[\"GEO.id\"] == col][\"Id\"].iloc(0)[0].replace(\"Estimate; RACE - One race - \", \"\")\n    trace = go.Bar(x=df_11[\"GEO.display-label\"][1:], y=single_race_df[col], name=nm, marker=dict(opacity=0.6))\n    traces.append(trace)\nlayout = dict(barmode=\"stack\", title=\"Breakdown by Population of Race \", margin=dict(b=100), height=600, legend=dict(x=-0.1, y=1, orientation=\"h\"))\nfig = go.Figure(data=traces, layout=layout)\niplot(fig)","ad130b42":"df_samp = pd.read_csv(\"..\/input\/cpe-data\/ACS_variable_descriptions.csv\")\nprint(\"Rows & columns of ACS_variable_descriptions \", df_samp.shape)\ndf_samp.head(10).drop(0)","05d839d9":"distBos = \"..\/input\/cpe-data\/Dept_11-00091\/11-00091_Shapefiles\/boston_police_districts_f55.shp\"\nOne = gp.read_file(distBos)\nOne.head()","fc479bfd":"print(os.listdir(\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_Shapefiles\"))\ndist_dept11=\"\"\"..\/input\/cpe-data\/Dept_11-00091\/11-00091_Shapefiles\/boston_police_districts_f55.shp\"\"\"\nconvertOne = gp.read_file(dist_dept11)\nmapAll = folium.Map([42.3, -71],zoom_start=10, height=400, tiles='OpenStreetMap',API_key='wrobstory.map-12345678')\nfolium.GeoJson(convertOne).add_to(mapAll)\nmapAll","fbf0da07":"print(os.listdir(\"..\/input\/cpe-data\/Dept_23-00089\"))\nprint(\"================================================================\")\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_23-00089\/23-00089_ACS_data\"))\nprint(\"================================================================\")\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_23-00089\/23-00089_Shapefiles\"))","3fad3533":"print(os.listdir(\"..\/input\/cpe-data\/Dept_23-00089\/23-00089_Shapefiles\"))\ndist_dept23_shp=\"\"\"..\/input\/cpe-data\/Dept_23-00089\/23-00089_Shapefiles\/Indianapolis_Police_Zones.shp\"\"\"\nconvert23Shp = gp.read_file(dist_dept23_shp)\nmap23 = folium.Map([39.8, -86.1],zoom_start=10, height=400, tiles='OpenStreetMap',API_key='wrobstory.map-12345678')\nfolium.GeoJson(convert23Shp).add_to(map23)\nmap23","9992901b":"distBos = \"..\/input\/cpe-data\/Dept_23-00089\/23-00089_Shapefiles\/Indianapolis_Police_Zones.shp\"\nOne = gp.read_file(distBos)\nOne.head()\n\nf, ax = plt.subplots(1, figsize=(20, 15))\nOne.plot(column=\"POLICEZONE\", ax=ax, cmap='Accent',legend=True);\nplt.title(\"Police zone - Indianapolis\")\nplt.show()","9611cb0f":"print(os.listdir(\"..\/input\/cpe-data\/Dept_35-00103\"))\nprint(\"================================================================\")\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_35-00103\/35-00103_ACS_data\"))\nprint(\"================================================================\")\nprint(os.listdir(\"..\/input\/cpe-data\/Dept_35-00103\/35-00103_Shapefiles\"))","77f4dec8":"df_prepped_d35 = pd.read_csv(\"..\/input\/cpe-data\/Dept_35-00103\/35-00103_UOF-OIS-P_prepped.csv\")\nprint(\"Rows & columns of ACS_variable_descriptions \", df_prepped_d35.shape)\ndf_prepped_d35.head(4)","f53e2a25":"map35 = folium.Map([35.22, -80.89], height=400, zoom_start=10, tiles='OpenStreetMap')\nfor j, rown in df_prepped_d35[1:].iterrows():\n    if str(rown[\"LOCATION_LONGITUDE\"]) != \"nan\":\n        lon = float(rown[\"LOCATION_LATITUDE\"])\n        lat = float(rown[\"LOCATION_LONGITUDE\"])\n        folium.Circle([lon, lat], radius=250, color='crimson', fill=True).add_to(map35)\nmap35","ec5e8479":"map35 = folium.Map([35.22, -80.89], height=400, zoom_start=10, tiles='OpenStreetMap')\nfor j, rown in df_prepped_d35[1:].iterrows():\n    if str(rown[\"LOCATION_LONGITUDE\"]) != \"nan\":\n        lon = float(rown[\"LOCATION_LATITUDE\"])\n        lat = float(rown[\"LOCATION_LONGITUDE\"])\n        \n        if rown[\"SUBJECT_INJURY_TYPE\"] == \"Non-Fatal Injury\":\n            col = \"blue\"\n        elif rown[\"SUBJECT_INJURY_TYPE\"]== \"Fatal Injury\":\n            col = \"red\"\n        else:\n            col = \"green\"\n            \n        folium.Circle([lon, lat], radius=400, color=col, fill=True).add_to(map35)\nmap35","e7f0e4fb":"map35 = folium.Map([35.22, -80.89], height=400, zoom_start=10, tiles='OpenStreetMap')\nfor j, rown in df_prepped_d35[1:].iterrows():\n    if str(rown[\"LOCATION_LONGITUDE\"]) != \"nan\":\n        lon = float(rown[\"LOCATION_LATITUDE\"])\n        lat = float(rown[\"LOCATION_LONGITUDE\"])\n        \n        if rown[\"SUBJECT_GENDER\"] == \"Male\":\n            col = \"blue\"\n        else:\n            col = \"green\"\n            \n        folium.Circle([lon, lat], radius=400, color=col, fill=True).add_to(map35)\nmap35","3ffd8d57":"from branca.element import Template, MacroElement\n\ntemplate = \"\"\"\n{% macro html(this, kwargs) %}\n\n<!doctype html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n  <title>jQuery UI Draggable - Default functionality<\/title>\n  <link rel=\"stylesheet\" href=\"\/\/code.jquery.com\/ui\/1.12.1\/themes\/base\/jquery-ui.css\">\n\n  <script src=\"https:\/\/code.jquery.com\/jquery-1.12.4.js\"><\/script>\n  <script src=\"https:\/\/code.jquery.com\/ui\/1.12.1\/jquery-ui.js\"><\/script>\n  \n  <script>\n  $( function() {\n    $( \"#maplegend\" ).draggable({\n                    start: function (event, ui) {\n                        $(this).css({\n                            right: \"auto\",\n                            top: \"auto\",\n                            bottom: \"auto\"\n                        });\n                    }\n                });\n});\n\n  <\/script>\n<\/head>\n<body>\n\n \n<div id='maplegend' class='maplegend' \n    style='position: absolute; z-index:9999; border:2px solid grey; background-color:rgba(255, 255, 255, 0.8);\n     border-radius:6px; padding: 10px; font-size:14px; right: 20px; bottom: 20px;'>\n     \n<div class='legend-title'>Legend<\/div>\n<div class='legend-scale'>\n  <ul class='legend-labels'>\n    <li><span style='background:black;opacity:0.7;'><\/span>Black<\/li>\n    <li><span style='background:blue;opacity:0.7;'><\/span>White<\/li>\n    <li><span style='background:yellow;opacity:0.7;'><\/span>Hispanic<\/li>\n    <li><span style='background:red;opacity:0.7;'><\/span>Others<\/li>\n\n  <\/ul>\n<\/div>\n<\/div>\n \n<\/body>\n<\/html>\n\n<style type='text\/css'>\n  .maplegend .legend-title {\n    text-align: left;\n    margin-bottom: 5px;\n    font-weight: bold;\n    font-size: 90%;\n    }\n  .maplegend .legend-scale ul {\n    margin: 0;\n    margin-bottom: 5px;\n    padding: 0;\n    float: left;\n    list-style: none;\n    }\n  .maplegend .legend-scale ul li {\n    font-size: 80%;\n    list-style: none;\n    margin-left: 0;\n    line-height: 18px;\n    margin-bottom: 2px;\n    }\n  .maplegend ul.legend-labels li span {\n    display: block;\n    float: left;\n    height: 16px;\n    width: 30px;\n    margin-right: 5px;\n    margin-left: 0;\n    border: 1px solid #999;\n    }\n  .maplegend .legend-source {\n    font-size: 80%;\n    color: #777;\n    clear: both;\n    }\n  .maplegend a {\n    color: #777;\n    }\n<\/style>\n{% endmacro %}\"\"\"\n\nmacro = MacroElement()\nmacro._template = Template(template)\n\n\nmap35 = folium.Map([35.22, -80.89], height=600, zoom_start=10, tiles='OpenStreetMap')\nfor j, rown in df_prepped_d35[1:].iterrows():\n    if str(rown[\"LOCATION_LONGITUDE\"]) != \"nan\":\n        lon = float(rown[\"LOCATION_LATITUDE\"])\n        lat = float(rown[\"LOCATION_LONGITUDE\"])\n        \n        if rown[\"SUBJECT_RACE\"] == \"Black\":\n            col = \"black\"\n        elif rown[\"SUBJECT_RACE\"]== \"White\":\n            col = \"blue\"\n        elif rown[\"SUBJECT_RACE\"]== \"Hispanic\":\n            col = \"yellow\"\n        else:\n            col = \"red\"\n            \n        folium.Circle([lon, lat], radius=250, color=col, fill=True).add_to(map35)\nmap35.get_root().add_child(macro)\nmap35","53d4d282":"map35 = folium.Map([35.22, -80.89], height=400, zoom_start=10, tiles='OpenStreetMap')\nfor j, rown in df_prepped_d35[1:].iterrows():\n    if str(rown[\"LOCATION_LONGITUDE\"]) != \"nan\":\n        lon = float(rown[\"LOCATION_LATITUDE\"])\n        lat = float(rown[\"LOCATION_LONGITUDE\"])\n        \n        if str(rown[\"SUBJECT_AGE_IN_YEARS\"]) >= \"60\":\n            col = \"green\"\n        elif str(rown[\"SUBJECT_AGE_IN_YEARS\"]) >= \"40\" and str(rown[\"SUBJECT_AGE_IN_YEARS\"]) < \"60\":\n            col = \"blue\"\n        elif str(rown[\"SUBJECT_AGE_IN_YEARS\"]) >= \"20\" and str(rown[\"SUBJECT_AGE_IN_YEARS\"]) < \"40\":\n            col = \"red\"\n        else:\n            col = \"black\"\n            \n        folium.Circle([lon, lat], radius=250, color=col, fill=True).add_to(map35)\nmap35","2ec8efc6":"dept35= \"..\/input\/cpe-data\/Dept_35-00103\/35-00103_UOF-OIS-P_prepped.csv\"\ndatap5= pd.read_csv(dept35)[1:]\ndatap5[\"INCIDENT_DATE\"] = pd.to_datetime(datap5[\"INCIDENT_DATE\"]).astype(str)\ndatap5[\"MonthDate\"] = datap5[\"INCIDENT_DATE\"].apply(lambda x : x.split(\"-\")[0] +'-'+ x.split(\"-\")[1] + \"-01\")\ntmp = datap5.groupby(\"MonthDate\").agg({\"SUBJECT_INJURY_TYPE\" : \"count\"}).reset_index()\n\ntmp\n\ntrace1 = go.Scatter(x=tmp[\"MonthDate\"], y=tmp.SUBJECT_INJURY_TYPE, name=\"Month wise Incidents\")\n\ndata = [trace1]\nlayout = go.Layout(height=400, title=\"Incidents in CMPD\")\nfig = go.Figure(data, layout)\niplot(fig)","6fef12fe":"print(os.listdir(\"..\/input\/cpe-data\/Dept_35-00103\/35-00103_Shapefiles\"))\ndist_dept35_shp=\"\"\"..\/input\/cpe-data\/Dept_35-00103\/35-00103_Shapefiles\/CMPD_Police_Division_Offices.shp\"\"\"\nconvert35Shp = gp.read_file(dist_dept35_shp)\nmap35 = folium.Map([35.15637558, -80.75600938],zoom_start=10, height=400, tiles='OpenStreetMap',API_key='wrobstory.map-12345678')\nfolium.GeoJson(convert35Shp).add_to(map35)\nmap35","719e813d":"print(os.listdir(\"..\/input\/cpe-data\/Dept_37-00049\/37-00049_Shapefiles\"))","004acced":"dist_dept35 = \"\"\"..\/input\/cpe-data\/Dept_37-00049\/37-00049_Shapefiles\/EPIC.shp\"\"\"\nconvert35_1Shp = gp.read_file(dist_dept35)\nmap351 = folium.Map([32.7, -96.7],zoom_start=10, height=400, tiles='OpenStreetMap',API_key='wrobstory.map-12345678')\nfolium.GeoJson(convert35_1Shp).add_to(map351)\nmap351","b8e3f97d":"distBos = \"..\/input\/cpe-data\/Dept_37-00049\/37-00049_Shapefiles\/EPIC.shp\"\nOne = gp.read_file(distBos)\nOne.head()\n\nf, ax = plt.subplots(1, figsize=(20, 15))\nOne.plot(column=\"Name\", ax=ax, cmap='Accent',legend=True);\nplt.title(\"Name\")\nplt.show()","3b377182":"Incidents by gender","e42a82e3":"Get the list of files in all departments","bb7517f2":"Incidents by age group","a60ddb4b":"Welcome to my kernel. Below commands to get the list of files in the folder  cpe-data","edd1adb2":"Police - Boston District","d6022f54":"CMPD Police division","c50aa97c":"Content of  **11-00091_ACS_education-attainment-over-25**","c63020cb":"**In Progress...**","dce692e3":"Incidents by race","35bae581":"Contents of **11-00091_ACS_poverty**","417145ec":"Incidents by injury types","bb623c40":"Contents of **11-00091_ACS_education-attainment**","c9bd129b":"Let's see the files of the dept ** Dept_11-00091**","d6225547":"Dept - Dept_23-00089","69240245":"Contents of **11-00091_ACS_race-sex-age**","c8faf44e":"Incidents by timeline","1a0eaf87":"Incidents location","42ab6304":"Police - Dallas dist","5e798e32":"Indianapolis","60afe4f2":"Dept - Dept_35-00103","c293108d":"Contents of **11-00091_ACS_owner-occupied-housing**"}}