{"cell_type":{"007713ee":"code","f178b725":"code","4e00fb02":"code","99f09b69":"code","31afdec4":"code","22ea3c34":"code","fa42cc3d":"code","ae710d5b":"code","cbf59d35":"code","08aa3be8":"code","1d5916a7":"code","55d62d32":"code","ec0e49c2":"code","d64d2385":"code","870a4b04":"code","3ca7e8a8":"code","8ba813bb":"code","06fa84eb":"code","2b6d349e":"code","8deabd47":"code","1f234ae3":"code","e9e713d8":"code","028142b4":"code","d929baa3":"code","538d8806":"code","a7e51bd8":"code","27af7d98":"code","468f373e":"code","9551ef0b":"code","e9af3cb0":"code","16a25728":"code","fc76cde0":"code","057fb27b":"code","f91436b8":"code","0aff67ce":"code","7f746830":"code","ba924d47":"code","4314d0d5":"code","dd409733":"code","b31ea86c":"code","782350d1":"code","9808f4e1":"code","9768bd38":"code","c020f171":"code","382ede0c":"code","1ccb52e1":"code","d2b03ec1":"code","dd51b486":"code","ffb581fa":"code","4eaf5f48":"code","84b17ba3":"code","f7cb8c61":"code","31115804":"code","328d7d15":"code","dd2dd868":"code","b87a387f":"code","6f33645d":"code","261024a9":"code","84cec9ec":"code","96e870fb":"code","1df4902f":"code","7f784c6a":"markdown","d262d0a2":"markdown","334205ad":"markdown"},"source":{"007713ee":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","f178b725":"file_name = '\/kaggle\/input\/kpmg-virtual-internship\/KPMG_VI_New_raw_data_update_final.xlsx'\nprint(pd.ExcelFile(file_name).sheet_names)","4e00fb02":"cust_demo_df = pd.read_excel(file_name, header=1, sheet_name='CustomerDemographic')\ncust_demo_df.head()","99f09b69":"cust_demo_df.shape","31afdec4":"cust_demo_df[cust_demo_df.duplicated()].sum()","22ea3c34":"print('customer_id blanks:', pd.isna(cust_demo_df['customer_id']).sum())","fa42cc3d":"pd.notna(cust_demo_df['customer_id'].unique()).sum()","ae710d5b":"print('first_name blanks:', pd.isna(cust_demo_df['first_name']).sum())","cbf59d35":"print('gender:', cust_demo_df['gender'].unique())\nprint('blanks:', pd.isna(cust_demo_df['gender']).sum())\nplt.hist(cust_demo_df['gender'][pd.notna(cust_demo_df['gender'])])","08aa3be8":"cust_demo_df['past_3_years_bike_related_purchases'].describe()","1d5916a7":"print('past_3_years_bike_related_purchases blanks:', pd.isna(cust_demo_df['past_3_years_bike_related_purchases']).sum())","55d62d32":"cust_demo_df['DOB'].describe(datetime_is_numeric=True)","ec0e49c2":"print('DOB blanks:', pd.isna(cust_demo_df['DOB']).sum())","d64d2385":"plt.scatter([d.year for d in cust_demo_df['DOB']], [d.month for d in cust_demo_df['DOB']])","870a4b04":"from datetime import datetime\ncust_demo_df['age'] = (datetime.now() - cust_demo_df['DOB']) \/\/ 365","3ca7e8a8":"cust_demo_df['age'].describe()","8ba813bb":"plt.scatter([d.year for d in cust_demo_df['DOB']], cust_demo_df['age'].dt.days)","06fa84eb":"print('job_title:', cust_demo_df['job_title'].unique())\nprint('blanks:', pd.isna(cust_demo_df['job_title']).sum())","2b6d349e":"print('job_industry_category:', cust_demo_df['job_industry_category'].unique())\nprint('blanks:', pd.isna(cust_demo_df['job_industry_category']).sum())","8deabd47":"print('wealth_segment:', cust_demo_df['wealth_segment'].unique())\nprint('blanks:', pd.isna(cust_demo_df['wealth_segment']).sum())\nplt.hist(cust_demo_df['wealth_segment'][pd.notna(cust_demo_df['wealth_segment'])])","1f234ae3":"print('deceased_indicator:', cust_demo_df['deceased_indicator'].unique())\nprint('blanks:', pd.isna(cust_demo_df['deceased_indicator']).sum())\nplt.hist(cust_demo_df['deceased_indicator'][pd.notna(cust_demo_df['deceased_indicator'])])","e9e713d8":"cust_demo_df['deceased_indicator'][cust_demo_df['deceased_indicator'] == 'Y'].count()","028142b4":"print('owns_car:', cust_demo_df['owns_car'].unique())\nprint('blanks:', pd.isna(cust_demo_df['owns_car']).sum())\nplt.hist(cust_demo_df['owns_car'][pd.notna(cust_demo_df['owns_car'])])","d929baa3":"cust_demo_df['tenure'].describe()","538d8806":"print('tenure blanks:', pd.isna(cust_demo_df['tenure']).sum())","a7e51bd8":"cust_addr_df = pd.read_excel(file_name, header=1, sheet_name='CustomerAddress')\ncust_addr_df.head()","27af7d98":"cust_addr_df.shape","468f373e":"cust_addr_df[cust_addr_df.duplicated()].sum()","9551ef0b":"print('customer_id blanks:', pd.isna(cust_addr_df['customer_id']).sum())","e9af3cb0":"pd.notna(cust_addr_df['customer_id'].unique()).sum()","16a25728":"print('customer_ids not in demographics dataset:', sum([(1 if (i not in cust_demo_df['customer_id']) else 0) for i in cust_addr_df['customer_id']]))","fc76cde0":"print('address blanks:', pd.isna(cust_addr_df['address']).sum())","057fb27b":"print('postcode blanks:', pd.isna(cust_addr_df['postcode']).sum())","f91436b8":"print('state:', cust_addr_df['state'].unique())\nprint('blanks:', pd.isna(cust_addr_df['state']).sum())\nplt.hist(cust_addr_df['state'][pd.notna(cust_addr_df['state'])])","0aff67ce":"print('country:', cust_addr_df['country'].unique())\nprint('blanks:', pd.isna(cust_addr_df['country']).sum())","7f746830":"cust_addr_df['property_valuation'].describe()","ba924d47":"print('property_valuation blanks:', pd.isna(cust_addr_df['property_valuation']).sum())\nplt.hist(cust_addr_df['property_valuation'], bins=10)","4314d0d5":"txns_df = pd.read_excel(file_name, header=1, sheet_name='Transactions')\ntxns_df.head()","dd409733":"txns_df.shape","b31ea86c":"txns_df[txns_df.duplicated()].sum()","782350d1":"txns_df['list_price'].describe()","9808f4e1":"print('list_price blanks:', pd.isna(txns_df['list_price']).sum())","9768bd38":"txns_df['standard_cost'].describe()","c020f171":"print('standard_cost blanks:', pd.isna(txns_df['standard_cost']).sum())","382ede0c":"txns_df['profit'] = txns_df['list_price'] - txns_df['standard_cost']\ntxns_df['profit'].describe()","1ccb52e1":"print('transaction_id blanks:', pd.isna(txns_df['transaction_id']).sum())","d2b03ec1":"print('product_id blanks:', pd.isna(txns_df['product_id']).sum())","dd51b486":"print('customer_id blanks:', pd.isna(txns_df['customer_id']).sum())","ffb581fa":"pd.notna(txns_df['customer_id'].unique()).sum()","4eaf5f48":"print('customer_ids not in demographics dataset:', sum([(1 if (i not in cust_demo_df['customer_id']) else 0) for i in cust_addr_df['customer_id']]))\nprint('customer_ids not in addresses dataset:', sum([(1 if (i not in cust_demo_df['customer_id']) else 0) for i in txns_df['customer_id']]))","84b17ba3":"txns_df['transaction_date'].describe(datetime_is_numeric=True)","f7cb8c61":"print('transaction_date blanks:', pd.isna(txns_df['transaction_date']).sum())","31115804":"print('online_order:', txns_df['online_order'].unique())\nprint('blanks:', pd.isna(txns_df['online_order']).sum())\nplt.hist(txns_df['online_order'][pd.notna(txns_df['online_order'])])","328d7d15":"print('order_status:', txns_df['order_status'].unique())\nprint('blanks:', pd.isna(txns_df['order_status']).sum())\nplt.hist(txns_df['order_status'][pd.notna(txns_df['order_status'])])","dd2dd868":"txns_df['order_status'][txns_df['order_status'] == 'Cancelled'].count()","b87a387f":"print('brand:', txns_df['brand'].unique())\nprint('blanks:', pd.isna(txns_df['brand']).sum())\nplt.hist(txns_df['brand'][pd.notna(txns_df['brand'])])","6f33645d":"print('product_line:', txns_df['product_line'].unique())\nprint('blanks:', pd.isna(txns_df['product_line']).sum())\nplt.hist(txns_df['product_line'][pd.notna(txns_df['product_line'])])","261024a9":"print('product_class:', txns_df['product_class'].unique())\nprint('blanks:', pd.isna(txns_df['product_class']).sum())\nplt.hist(txns_df['product_class'][pd.notna(txns_df['product_class'])])","84cec9ec":"print('product_size:', txns_df['product_size'].unique())\nprint('blanks:', pd.isna(txns_df['product_size']).sum())\nplt.hist(txns_df['product_size'][pd.notna(txns_df['product_size'])])","96e870fb":"print('product_first_sold_date blanks:', pd.isna(txns_df['product_first_sold_date']).sum())","1df4902f":"plt.scatter(txns_df['brand'][pd.notna(txns_df['brand'])], txns_df['profit'][pd.notna(txns_df['brand'])])","7f784c6a":"## CustomerDemographic","d262d0a2":"## Transactions","334205ad":"## CustomerAddress"}}