{"cell_type":{"8c76f395":"code","a4803cb4":"code","2464cca7":"code","c6342651":"code","a81697dc":"code","ec7ef25a":"code","26953913":"code","adca7ed4":"code","e3fd9217":"code","e3a39b20":"code","02178b40":"code","3681233f":"code","39cebbf3":"code","027e2d82":"code","25933591":"code","d787f29a":"markdown","355a7119":"markdown","bf670bae":"markdown","fbf63b27":"markdown","b30573b4":"markdown","b59bb1aa":"markdown","3f650d69":"markdown","74a88e14":"markdown","0edaead6":"markdown","a845eade":"markdown","be5a7b0a":"markdown"},"source":{"8c76f395":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom scipy.optimize import curve_fit\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","a4803cb4":"owgr = pd.read_csv('..\/input\/ogwr_historical.csv')\nowgr['index'] = owgr.index \/\/ 1000\nprint(owgr.isna().sum())","2464cca7":"#Utility functions\ndef exponential_fit(x, A, B, C):\n    return A*np.exp(-B*x)+C\n\n#Function to check if a list decreases monotonically\ndef check_monotonicity(L):\n    return all(x>=y for x, y in zip(L, L[1:]))\n\ndef get_bad_values(L, idx):\n    bools = [x>=y for x,y in zip(L,L[1:])]\n    shift = idx * 1000\n    bad_vals = []\n    for i in range(len(bools)):\n        if not bools[i]:\n            bad_vals.append(shift+i)\n    return bad_vals","c6342651":"plt.plot(owgr['rank'], owgr['avg_points'], 'o', label='data')\nplt.xlabel('Ranking')\nplt.ylabel('Average OWGR Points')","a81697dc":"plt.plot(owgr['rank'], owgr['avg_points'], 'o', label='data')\nplt.axis([50, 300, 0, 4])\nplt.xlabel('Ranking')\nplt.ylabel('Average OWGR Points')","ec7ef25a":"date_hyp = owgr[owgr['date'] == '05-06-05'] #Get data from the week of 05-06-05\ntest_hyp = []\nfor i in range(1, 999):\n    ave = (date_hyp['avg_points'].iloc[i-1] + date_hyp['avg_points'].iloc[i+1]) \/ 2\n    test_hyp.append(ave - date_hyp['avg_points'].iloc[i])\n    #print(i, ave - date_tmp['avg_points'].iloc[i])\n#plt.axis([0,100,-0.5,0.8])\nplt.plot(test_hyp)\nplt.arrow(x=150, y=-1.0, dx=-60, dy=0.5,\n          width=0.05, head_width=0.2, head_length=10, shape='full', color='r')\nplt.arrow(x=725, y=0.8, dx=0, dy=-0.5,\n          width=0.05, head_width=0.2, head_length=0.1, shape='full', color='r')","26953913":"# Find all the bad average point values based on if rankings are numerically ordered\nbad_vals = []\nfor i in range(len(owgr.date.unique())):\n    date_tmp = owgr[owgr['index'] == i]\n    mono = check_monotonicity(date_tmp['avg_points'])\n    if not mono:\n        bad_vals_slice = get_bad_values(date_tmp['avg_points'], i)\n        [bad_vals.append(i) for i in bad_vals_slice]\nprint(len(bad_vals))","adca7ed4":"owgr_clean = owgr.drop(owgr.index[bad_vals])","e3fd9217":"# Compare clean and original data\nplt.plot(owgr['rank'], owgr['avg_points'], 'bo', label='original')\nplt.plot(owgr_clean['rank'], owgr_clean['avg_points'], 'g.', label='clean')\nplt.axis([50, 400, 0, 4])\nplt.xlabel('Ranking')\nplt.ylabel('Average OWGR Points')\nplt.legend()","e3a39b20":"# Violin plot for distribtuion of OWGR points for each fo top ten players (w\/ Tiger)\ntop_ten = owgr_clean[owgr_clean['rank'] <= 10]\nsns.violinplot(x='rank', y='avg_points', data=top_ten, inner=None)","02178b40":"# Violin plot for distribution of OWGR points for each of top ten players (w\/o Tiger)\ntop_ten = owgr_clean[owgr_clean['rank'] <= 10]\ntop_ten = top_ten[top_ten['name'] != 'TigerWoods']\nsns.violinplot(x='rank', y='avg_points', data=top_ten, inner=None)","3681233f":"#Build dataframe with info about players who reached the number 1 ranking\ntop_players = owgr_clean[owgr_clean['rank'] == 1]['name'].unique()\n\ntop_players_dict = {}\nfor i in top_players:\n    player_data = []\n    player_data.append(i)\n    player_df = owgr_clean[owgr_clean['name'] == i]\n    player_data.append(player_df['avg_points'].mean()) #Average points for career\n    player_data.append(player_df['rank'].mean())\n    player_data.append(player_df.count()['rank']) #Total weeks\n    player_data.append(player_df[player_df['rank'] == 1].count()['rank']) #Total weeks at 1\n    top_players_dict[i] = player_data\ntop_players_df = pd.DataFrame.from_dict(top_players_dict, orient='index',\n                                        columns=['player', 'ave_points_career', 'ave_rank', 'total_weeks', 'total_weeks_at_1'])\ntop_players_df['per_weeks_at_1'] = 100 * (top_players_df['total_weeks_at_1'] \/ top_players_df['total_weeks'])\nprint(top_players_df.head())","39cebbf3":"fig, ax = plt.subplots()\nax.scatter(top_players_df['player'], top_players_df['per_weeks_at_1'], \n           color='k', s=30)\nax.set_ylabel('Percent at #1 (%)', color='k')\nax.tick_params(axis='y', labelcolor='k')\nplt.xticks(rotation=60)\nax2 =ax.twinx()\nax2.set_ylabel('Average World Ranking', color='b')\nax2.tick_params(axis='y', labelcolor='b')\nax2.scatter(top_players_df['player'], top_players_df['ave_rank'],\n            color='b', s=30)","027e2d82":"tw = owgr[(owgr['rank'] == 1) & (owgr['name'] == 'TigerWoods')]\nnotw = owgr[(owgr['rank'] == 1) & (owgr['name'] != 'TigerWoods')]\nsns.kdeplot(tw['avg_points'], shade=True, label='Tiger')\nsns.kdeplot(notw['avg_points'], shade=True, label='Everyone Else')\nplt.xlabel('OWGR Points')\nplt.ylabel('Frequency')\nplt.title('Average World Ranking Points of #1 Player')","25933591":"# Tiger vs. Phil vs. Rory over time\ntw = owgr_clean[owgr_clean['name'] == 'TigerWoods']\npm = owgr_clean[owgr_clean['name'] == 'PhilMickelson']\nrm = owgr_clean[owgr_clean['name'] == 'RoryMcIlroy']\n\nax = tw.plot(x='index', y='avg_points', color='Red', label='Tiger')\npm.plot(x='index', y='avg_points', color='Green', label='Phil', ax=ax)\nrm.plot(x='index', y='avg_points', color='Blue', label='Rory', ax=ax)\nplt.ylabel('OWGR Points')\nplt.xlabel('Week')","d787f29a":"There is a funny looking blip around x=60, y=1, lets zoom in.","355a7119":"How dominant was Tiger? \n\nBelow we build a new dataframe with career statistics of each player who reached the number 1 ranked player in the world","bf670bae":"Start exploring data by plotting ranking vs. average number of ranking points","fbf63b27":"This data set contains weekly data on the top 1000 players in the official world golf rankings from September 2000 to April 2015. It has 3 columns, the ranking, name, and average points of the player. We can use the data to answer some interesting quesitons about the careers of individual players as well as about the statistical profile required to be ranked in a given position.\n\nIn this kernel I will address the anomalies in the data, a method clean these anomalies, and I will compare the careers of a number of top players during the time frame. ","b30573b4":"This bottom feature is strange likely comes from an error in the data.\nHypothesis: Despite the data not having any missing values, there are detectable anomalies in the values\nThe most straight forward thing to check is if the rankings are in numerical order, since a point-based ranking system should decrease monotonically with increasing position.\nFirst, we do a quick check on a single week of data to see if any values are far from thier expectation. We average the points before and after the point of interest, and calculate how far that point is from this average. A spike in the plot indicates a value may not be correct.","b59bb1aa":"Finally, lets compare the career trajectories of multiple players. Below shows the week-by-week average world ranking points for tiger, phil, and rory. X-axis is the week enumerated from 1 to 758.","3f650d69":"Now with clean data, lets look at the point distribtuions for the top ten players in the world.","74a88e14":"Many other insights can be taken from this relatively simple data set. A couple examples include, quantifying the level of parity in the game or identifying a given players prime\/peak years.","0edaead6":"Tiger was the number 1 player in the world for over 70% of the time between September 2000 and April 2015. In the top_players_df I have compiled some other stats that can be used to tell a similar story, modify plotting to explore thos values.\n\nThe below plots show distibutions of the average number of points for the #1 player in the world. Tiger and everyone else are separated. Not only was Tiger #1 the majority of the time, he acculated more average world ranking points than the other number 1 players, reaching values more than double what anyone else has ever reached.","a845eade":"The large peaks at low x-values are from larger variation in average points from player to player. The peaks mark with red arrows are anomalies in the data, where a value is far from its expected value.\n\nBelow we will find all values where the average points are not in numerical order and drop them from our data","be5a7b0a":"There is huge variance in the number 1 spot (largely due to Tiger Woods, analysis below). Removing tiger from dataset provides the following distibtutions. The top players still have largest variance, but it decreases with rank."}}