{"cell_type":{"fc6f773b":"code","2ba08f8c":"code","44e42eba":"code","19d3629e":"code","774560ec":"code","cda8a5d3":"code","ce5e1ac6":"code","08730049":"code","e3a27e07":"code","84c9b877":"code","987e0695":"code","cf771085":"code","2ebc0276":"code","479685ed":"code","b1bf6d52":"code","18e628db":"markdown","9d13b617":"markdown","4b3c2b7c":"markdown","f56cef82":"markdown","e385eff9":"markdown","be5f9689":"markdown","769b4d1a":"markdown"},"source":{"fc6f773b":"from fastai.tabular.all import *","2ba08f8c":"path = Path('..\/input\/tabular-playground-series-jan-2021')","44e42eba":"train_df = pd.read_csv(path\/'train.csv')\ntrain_df","19d3629e":"train_df.describe()","774560ec":"test_df = pd.read_csv(path\/'test.csv')\ntest_df","cda8a5d3":"test_df.describe()","ce5e1ac6":"# get continuous data column\ncont_nn = list(train_df.iloc[:,1:-1])","08730049":"# split last 20% for validation\nsplits = (list(range(240000)),list(range(240000,300000)))","e3a27e07":"procs_nn = [Categorify, FillMissing, Normalize]\nto_nn = TabularPandas(train_df, procs_nn, cont_names=cont_nn, \n                      splits=splits, y_names='target')","84c9b877":"# create dataloaders\ndls = to_nn.dataloaders(1024)","987e0695":"# create a learner using tabular_learner\nlearn = tabular_learner(dls, y_range=(0,11), layers=[500,250],\n                        n_out=1, loss_func=F.mse_loss)","cf771085":"# to find a good lr\nlearn.lr_find()","2ebc0276":"learn.fit_one_cycle(20, 3e-4)","479685ed":"tst_dl = learn.dls.test_dl(test_df)\npred, _ = learn.get_preds(dl = tst_dl)","b1bf6d52":"submission_df = pd.read_csv(path\/'sample_submission.csv')\nsubmission_df['target'] = pred.squeeze()\nsubmission_df.to_csv('submission.csv', index=False)\nsubmission_df","18e628db":"# Get prediction","9d13b617":"# Import Train Data","4b3c2b7c":"If you find it useful feel free to upvote :D","f56cef82":"# Create Dataloaders","e385eff9":"# Setup Environment","be5f9689":"# Create learner","769b4d1a":"# Make Submission File"}}