{"cell_type":{"f94f5b60":"code","4ab1ea43":"code","fc6a9d31":"code","a4f96451":"code","3c1d33de":"code","24cbf86f":"code","4cb431c4":"code","e554f6ca":"code","b59a6144":"code","b26dc3dc":"code","d5dac4d0":"code","82de2843":"code","6208fb6b":"code","d7fb4ffd":"code","1c358d1b":"code","b8b969f7":"code","94885cc5":"code","d7b8f6f3":"markdown","0ba7e4e2":"markdown","722869e8":"markdown","0df3711b":"markdown","4816ab18":"markdown","db1bcc0e":"markdown","b61594c4":"markdown","51b8d4e6":"markdown","914a0a33":"markdown","2c17152e":"markdown","4f22b76e":"markdown","cfea75e5":"markdown","935e763c":"markdown","b399f0b7":"markdown","b01d4525":"markdown","f7013859":"markdown","a1f5cc4d":"markdown","d3ca20b4":"markdown"},"source":{"f94f5b60":"import numpy as np \nimport pandas as pd","4ab1ea43":"import tensorflow as tf\nfrom keras.preprocessing.image import ImageDataGenerator\nimport cv2\nimport matplotlib.pyplot as plt","fc6a9d31":"plt.imshow(cv2.imread(\"\/kaggle\/input\/pothole-detection-dataset\/potholes\/12.jpg\"))","a4f96451":"plt.imshow(cv2.imread(\"\/kaggle\/input\/pothole-detection-dataset\/normal\/83.jpg\"))","3c1d33de":"train_datagen = ImageDataGenerator(rescale = 1.\/255,\n                                   shear_range = 0.2, zoom_range = 0.2, horizontal_flip = True, validation_split=0.2)\n\ntraining_set = train_datagen.flow_from_directory('\/kaggle\/input\/pothole-detection-dataset', target_size = (64, 64),\n                                                 batch_size = 32, class_mode = 'binary', subset=\"training\")","24cbf86f":"validation_generator = train_datagen.flow_from_directory(\n    \"\/kaggle\/input\/pothole-detection-dataset\", # same directory as training data\n    target_size=(64, 64),\n    batch_size=32,\n    class_mode='binary',\n    subset='validation')","4cb431c4":"cnn = tf.keras.models.Sequential()","e554f6ca":"cnn.add(tf.keras.layers.Conv2D(filters=32, kernel_size=3, activation='relu', input_shape=[64, 64, 3]))","b59a6144":"cnn.add(tf.keras.layers.MaxPool2D(pool_size=2, strides=2))","b26dc3dc":"cnn.add(tf.keras.layers.Conv2D(filters=32, kernel_size=3, activation='relu'))\ncnn.add(tf.keras.layers.MaxPool2D(pool_size=2, strides=2))","d5dac4d0":"cnn.add(tf.keras.layers.Flatten())","82de2843":"cnn.add(tf.keras.layers.Dense(units=128, activation='relu'))","6208fb6b":"cnn.add(tf.keras.layers.Dense(units=1, activation='sigmoid'))","d7fb4ffd":"cnn.compile(optimizer = 'adam', loss = 'binary_crossentropy', metrics = ['accuracy'])","1c358d1b":"cnn.fit(x = training_set, validation_data = validation_generator, epochs = 25)","b8b969f7":"import numpy as np\nfrom keras.preprocessing import image\ntest_image = image.load_img('..\/input\/pothole-detection-dataset\/normal\/4.jpg', target_size = (64, 64))\nplt.imshow(cv2.imread(\"..\/input\/pothole-detection-dataset\/normal\/4.jpg\"))\ntest_image = image.img_to_array(test_image)\ntest_image = np.expand_dims(test_image, axis = 0)\nresult = cnn.predict(test_image)\ntraining_set.class_indices\nif result[0][0] == 1:\n  prediction = 'pothole'\nelse:\n  prediction = 'normal'\n\n\nprint(prediction)","94885cc5":"plt.imshow(cv2.imread(\"\/kaggle\/input\/pothole-detection-dataset\/potholes\/123.jpg\"))\nprint(prediction)","d7b8f6f3":"**Part 3 - Training the CNN**","0ba7e4e2":"****Splitting dataset into training and validation and preprocessing the training set****","722869e8":"**Part 2 - Building the CNN**","0df3711b":"**IMPORTING LIBRARIES**","4816ab18":"## Thank You","db1bcc0e":"**CHECKING IMAGES FOR CONFIRMATION**","b61594c4":"**Adding a second convolutional layer**","51b8d4e6":"**Step 1 - Convolution**","914a0a33":"**Training the CNN on the Training set and evaluating it on the Validation set**","2c17152e":"**Step 2 - Pooling**","4f22b76e":"**Initialising the CNN**","cfea75e5":"**Compiling the CNN**","935e763c":"**Step 3 - Flattening**","b399f0b7":"**Step 4 - Full Connection**","b01d4525":"**Step 5 - Output Layer**","f7013859":"**Preprocessing the validation set**","a1f5cc4d":"**Part 4 - Making a single prediction**","d3ca20b4":"**Part 1 - Data Preprocessing**"}}