{"cell_type":{"a6f4e56e":"code","336cd158":"code","3edf0ec4":"code","f399215f":"code","086f8514":"code","a5b04b35":"code","084815aa":"code","277181e3":"code","d90cbf1d":"code","aca92c36":"code","241a18a8":"code","d73cd619":"code","8442983d":"code","2bee4a6a":"code","dfe53dfc":"code","4caa410c":"code","f1740c3e":"code","ab6b4921":"code","575c7c71":"markdown","b0974703":"markdown","63c78d28":"markdown","51ae7c71":"markdown","f0e76f8f":"markdown","5011c2e9":"markdown","4413cb69":"markdown","68fa4938":"markdown","9f484675":"markdown","82d54442":"markdown","5521dc24":"markdown","ad895701":"markdown","35ef4b67":"markdown","e3db9dfa":"markdown","158bb3cc":"markdown","9988da5a":"markdown","eb27d2ed":"markdown","b01b0280":"markdown"},"source":{"a6f4e56e":"import folium\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sn\nfrom folium import plugins\nfrom IPython.display import display\nfrom scipy import stats\n\nhousing = pd.read_csv(\"..\/input\/usa-housing-listings\/housing.csv\")\nhousing.dtypes","336cd158":"pd.set_option('display.max_columns', None)\ndisplay(housing.head(n=5))","3edf0ec4":"heatMap = folium.Map([41, -96], zoom_start = 4)\nheatMapCleanLoc = housing[np.isfinite(housing['lat'])].sample(n=50000)\n\nheatArr = heatMapCleanLoc[[\"lat\", \"long\"]].as_matrix()\nheatMap.add_child(plugins.HeatMap(heatArr, radius = 15))","f399215f":"corrMatrix = housing.corr()\nfig, ax = plt.subplots(figsize=(12,10))\nsn.heatmap(corrMatrix)","086f8514":"housing.price.describe().apply(lambda x: format(x, 'f'))","a5b04b35":"housing.sqfeet.describe().apply(lambda x: format(x, 'f'))","084815aa":"housing.beds.describe().apply(lambda x: format(x, 'f'))","277181e3":"housing.baths.describe().apply(lambda x: format(x, 'f'))","d90cbf1d":"housingReduced = housing[housing.price <= 5000]\nhousingReduced = housingReduced[housingReduced.sqfeet <= 4000]\nhousingReduced = housingReduced[np.abs(housingReduced.beds-housing.beds.mean()) <= (3 * housingReduced.beds.std())]\nhousingReduced = housingReduced[np.abs(housingReduced.baths-housing.baths.mean()) <= (3 * housingReduced.baths.std())]\n\nprint(f\"{housing.shape[0] - housingReduced.shape[0]} rows removed\")","aca92c36":"fig = plt.gcf()\nfig.set_size_inches(18.5, 10.5)\nn, bins, patches = plt.hist(housingReduced.price, bins=90, facecolor='#2ab0ff', edgecolor='#e0e0e0', linewidth=0.5, alpha=0.7)\nn = n.astype('int') # it MUST be integer\nfor i in range(len(patches)):\n    patches[i].set_facecolor(plt.cm.viridis(n[i]\/max(n)))\nplt.title('Price Distribution', fontsize=20)\nplt.xlabel('Price per month', fontsize=14)\nplt.ylabel('Count', fontsize=14)\nplt.show()","241a18a8":"fig = plt.gcf()\nfig.set_size_inches(18.5, 10.5)\nn, bins, patches = plt.hist(housingReduced.sqfeet, bins=90, facecolor='#2ab0ff', edgecolor='#e0e0e0', linewidth=0.5, alpha=0.7)\nn = n.astype('int') # it MUST be integer\nfor i in range(len(patches)):\n    patches[i].set_facecolor(plt.cm.viridis(n[i]\/max(n)))\nplt.title('Square Foootage Distribution', fontsize=20)\nplt.xlabel('Square Footage', fontsize=14)\nplt.ylabel('Count', fontsize=14)\nplt.show()","d73cd619":"fig = plt.gcf()\nfig.set_size_inches(8, 10)\nn, bins, patches = plt.hist(housingReduced.beds, bins=90, facecolor='#2ab0ff', edgecolor='#e0e0e0', linewidth=0.5, alpha=0.7)\nn = n.astype('int') # it MUST be integer\nfor i in range(len(patches)):\n    patches[i].set_facecolor(plt.cm.viridis(n[i]\/max(n)))\nplt.title('Bedrooms Distribution', fontsize=20)\nplt.xlabel('Number of Bedrooms', fontsize=14)\nplt.ylabel('Count', fontsize=14)\nplt.show()","8442983d":"fig = plt.gcf()\nfig.set_size_inches(8, 10)\nn, bins, patches = plt.hist(housingReduced.baths, bins=90, facecolor='#2ab0ff', edgecolor='#e0e0e0', linewidth=0.5, alpha=0.7)\nn = n.astype('int') # it MUST be integer\nfor i in range(len(patches)):\n    patches[i].set_facecolor(plt.cm.viridis(n[i]\/max(n)))\nplt.title('Baths Distribution', fontsize=20)\nplt.xlabel('Number of Baths', fontsize=14)\nplt.ylabel('Count', fontsize=14)\nplt.show()","2bee4a6a":"fig, ax = plt.subplots(figsize = (16, 16))\ngrouped = housingReduced.groupby(\"sqfeet\")[\"price\"].mean()\nrollingGrouped = grouped.rolling(25).mean()\nsqfeetData = rollingGrouped.index.values\npriceData = rollingGrouped.values\nax.set_xlabel(\"square footage\", fontsize = 14)\nax.set_ylabel(\"price\", fontsize = 14)\nax.plot(sqfeetData, priceData)","dfe53dfc":"canSmoke = dict(housing.smoking_allowed.value_counts())\nprint(f\"{canSmoke[1]} listings allow smoking ({round((canSmoke[1] \/ housingReduced.shape[0]) * 100, 2)}%) while {canSmoke[0]} listings do not ({round((canSmoke[0] \/ housingReduced.shape[0]) * 100, 2)}%)\")\n\nhaveCats = dict(housing.cats_allowed.value_counts())\nprint(f\"{haveCats[1]} listings allow cats ({round((haveCats[1] \/ housingReduced.shape[0]) * 100, 2)}%) while {haveCats[0]} listings do not ({round((haveCats[0] \/ housingReduced.shape[0]) * 100, 2)}%)\")\n\nhaveDogs = dict(housing.dogs_allowed.value_counts())\nprint(f\"{haveDogs[1]} listings allow dogs ({round((haveDogs[1] \/ housingReduced.shape[0]) * 100, 2)}%) while {haveDogs[0]} listings do not ({round((haveDogs[0] \/ housingReduced.shape[0]) * 100, 2)}%)\")\n\nevCharge = dict(housing.electric_vehicle_charge.value_counts())\nprint(f\"{evCharge[1]} listings have electric vehicle charging ({round((evCharge[1] \/ housingReduced.shape[0]) * 100, 2)}%) while {evCharge[0]} listings do not ({round((evCharge[0] \/ housingReduced.shape[0]) * 100, 2)}%)\")\n\nfurnished = dict(housing.comes_furnished.value_counts())\nprint(f\"{furnished[1]} listings come furnished ({round((furnished[1] \/ housingReduced.shape[0]) * 100, 2)}%) while {furnished[0]} listings do not ({round((furnished[0] \/ housingReduced.shape[0]) * 100, 2)}%)\")\n\nwheelchair = dict(housing.wheelchair_access.value_counts())\nprint(f\"{wheelchair[1]} listings have wheelchair access ({round((wheelchair[1] \/ housingReduced.shape[0]) * 100, 2)}%) while {wheelchair[0]} listings do not ({round((wheelchair[0] \/ housingReduced.shape[0]) * 100, 2)}%)\")\n\n","4caa410c":"fig = plt.gcf()\nfig.set_size_inches(12, 12)\nbaseColors = [\"red\", \"orange\", \"gold\", \"yellow\", \"greenyellow\", \"mediumseagreen\", \"turquoise\", \"blue\", \"darkblue\", \"mediumpurple\", \"purple\", \"crimson\"]\ntypes = dict(housingReduced.type.value_counts())\nlabels = []\nsizes = []\ncolors = []\ncount = 0\nfor k, v in types.items():\n    labels.append(f\"{k} - {round(((v \/ housingReduced.shape[0]) * 100), 2)}%\")\n    sizes.append(v)\n    colors.append(baseColors[count])\n    count += 1\n\npatches, texts = plt.pie(sizes, colors=colors, shadow=True, startangle=120)\nplt.legend(patches, labels, loc=\"best\")\nplt.axis('equal')\nplt.title(\"Distribution of housing types\", fontsize = 16)\nplt.show()","f1740c3e":"fig = plt.gcf()\nfig.set_size_inches(12, 12)\nbaseColors = [\"red\", \"yellow\", \"mediumseagreen\", \"blue\", \"purple\"]\nlaundry = dict(housingReduced.laundry_options.value_counts())\nlabels = []\nsizes = []\ncolors = []\ncount = 0\nfor k, v in laundry.items():\n    labels.append(f\"{k} - {round(((v \/ housingReduced.shape[0]) * 100), 2)}%\")\n    sizes.append(v)\n    colors.append(baseColors[count])\n    count += 1\n\npatches, texts = plt.pie(sizes, colors=colors, shadow=True, startangle=120)\nplt.legend(patches, labels, loc=\"best\")\nplt.axis('equal')\nplt.title(\"Distribution of laundry options\", fontsize = 16)\nplt.show()","ab6b4921":"fig = plt.gcf()\nfig.set_size_inches(12, 12)\nbaseColors = [\"red\", \"orange\", \"yellow\", \"mediumseagreen\", \"blue\", \"purple\"]\nparking = dict(housingReduced.parking_options.value_counts())\nlabels = []\nsizes = []\ncolors = []\ncount = 0\nfor k, v in parking.items():\n    labels.append(f\"{k} - {round(((v \/ housingReduced.shape[0]) * 100), 2)}%\")\n    sizes.append(v)\n    colors.append(baseColors[len(baseColors) - 1 - count])\n    count += 1\n\npatches, texts = plt.pie(sizes, colors=colors, shadow=True, startangle=120)\nplt.legend(patches, labels, loc=\"best\")\nplt.axis('equal')\nplt.title(\"Distribution of parking options\", fontsize = 16)\nplt.show()","575c7c71":"## Pie charts for housing type and laundry\/parking options\nLets wrap it up with pie charts depicting the makeup of housing types and laundry\/parking options. Percentages in the legends reflect the overall percentage out of all rows in the dataset, they don't always add up to 100% as some entries are null.","b0974703":"## Describe a few critical columns\n","63c78d28":"## Count boolean values\nLets check how many housing rentals allow smoking, cats, dogs, have EV chargers, come furnished, and have wheelchair access","51ae7c71":"## Correlation Matrix\nLets build a simple correlation matrix to check for relationships between variables","f0e76f8f":"## Remove outliers\nThere are clearly some major outliers unless somebody listed a magic house with 1,100 bedrooms and 75 baths. The following code removes any rows with outliers with a price lying beyond $5000, square footage beyond 4000 feet, and beyond 3 standard deviations of the mean for beds and baths.","5011c2e9":"## Draw heatmap\nLets take a random sample of roughly 10% of the data to visualize where listings are located","4413cb69":"## Basic data layout","68fa4938":"We see a (predictable) increase in price as square footage increases","9f484675":"There doesn't appear to be any usefull correlations, with baths and beds having an (obvious) positive correlation, along with cats_allowed and dogs_allowed having a very strong positive correlation which isn't insightful in the slightest.","82d54442":"Most listings have 2 bedrooms, followed by 1 and 3 respectively. Very few have more than 4","5521dc24":"1 Bath is the most common amount, followed by 2","ad895701":"We see that most homes are listed for between \\$700 and \\$1300","35ef4b67":"Most housing options offer off-street parking, followed by attached garage and carport.","e3db9dfa":"## Histograms\nLets visualize the makeup of price, sqfeet, beds, and baths","158bb3cc":"## Comparing price and square footage\nLets build a simple line graph to see how the monthly rent of a listing correlates with its price","9988da5a":"Laundry options are pretty evenly distributed, with the exception of no laundry on site representing 1% of listings.","eb27d2ed":"Apartment is by far the most common housing type, with house and townhouse also making an appearance.","b01b0280":"Square footage has a very similar distribution to price, with most listings being between 700 and 1500 square feet"}}