{"cell_type":{"3575bde0":"code","49f50f24":"code","2be1926a":"code","caa01f0d":"code","22cd8661":"code","73e57c88":"code","16b9243b":"code","719069fd":"code","71cefc2f":"code","81f55b5d":"code","ec9b8a78":"code","6cb8ea60":"code","8a97bf6f":"code","2bb0caa6":"code","b4f918a0":"code","4aa973ad":"code","e9cc1df9":"code","7f5d9650":"code","7cac5c3e":"code","90cbf61f":"code","3556c04c":"code","4fb7852d":"code","3855cd57":"code","cbcae8e2":"code","82e4a228":"code","1b3c24d2":"code","d7419091":"code","f78c1daa":"code","9bf2c5ad":"code","53354ba3":"code","460748e0":"code","1c514f7a":"code","736f6ce2":"code","4ab51d21":"markdown","fd338388":"markdown","756bbc10":"markdown","cbd9b541":"markdown","e9378e7a":"markdown","7ea8110d":"markdown","0bd83d44":"markdown","b2d7c232":"markdown","48b34412":"markdown","ec8b25b3":"markdown","7930dc86":"markdown","20207543":"markdown","10174410":"markdown","979b8dd2":"markdown","06eb621d":"markdown"},"source":{"3575bde0":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.cluster import KMeans\nfrom sklearn.preprocessing import MinMaxScaler","49f50f24":"filepath=\"..\/input\/mall-customers\/Mall_Customers.csv\"\ndf=pd.read_csv(filepath)\ndf.head()","2be1926a":"df.rename(columns={\"Genre\":\"Gender\"}, inplace = True)\ndf","caa01f0d":"df.describe()","22cd8661":"df_gen = df[\"Gender\"]\ndf_gen.value_counts().plot(kind=\"bar\", legend =1)","73e57c88":"df_gen.value_counts().plot(kind=\"pie\",legend =1)","16b9243b":"df_age = df[\"Age\"]\ndf_age.describe()","719069fd":"df_age.hist(grid = 0)","71cefc2f":"df.head()","81f55b5d":"df.rename(columns={\"Annual Income (k$)\":\"Salary\"}, inplace=1)\ndf.rename(columns={\"Spending Score (1-100)\":\"Score\"}, inplace=1)\ndf.head()","ec9b8a78":"df[\"Salary\"].describe()","6cb8ea60":"h0=df[\"Salary\"].hist(grid=0)\nh0.set_title(\"Histogram of Annual Income of Customers\")\nh0.set_xlabel(\"Dollars(in Thousands)\")\nh0.set_ylabel(\"Frequency\")","8a97bf6f":"sns.distplot(df['Salary'])","2bb0caa6":"df.head()","b4f918a0":"sps=sns.boxplot(df[\"Score\"], color=\"grey\")\nsps.set_title(\"Distribution of Spending Scores\")","4aa973ad":"h1=df['Score'].hist(grid = 0, color= \"grey\")\nh1.set_title(\"Histogram of Spending Scores\")\nh1.set_xlabel(\"Spending Scores\")","e9cc1df9":"df.head()\n#df.drop(index=\"CustomerID\")","7f5d9650":"plt.scatter(df[\"Salary\"],df[\"Score\"])","7cac5c3e":"k_range=[1,2,3,4,5,6,7,8,9,10]\nsse=[]\nfor k in k_range:\n    km=KMeans(n_clusters=k)\n    km.fit(df[[\"Age\",\"Salary\",\"Score\"]])\n    sse.append(km.inertia_)","90cbf61f":"sse","3556c04c":"plt.xlabel('k')\nplt.ylabel('sum of squared error')\nplt.plot(k_range,sse)","4fb7852d":"km= KMeans(n_clusters=4)\nkm","3855cd57":"y_pred=km.fit_predict(df[[\"Salary\",\"Score\"]])\ny_pred","cbcae8e2":"df['cluster']=y_pred\ndf.tail()","82e4a228":"df0=df[df.cluster==0]\ndf1=df[df.cluster==1]\ndf2=df[df.cluster==2]\ndf3=df[df.cluster==3]\n\nplt.scatter( df0.Salary, df0.Score,color=\"grey\")\nplt.scatter( df1.Salary, df1.Score,color=\"red\")\nplt.scatter( df2.Salary, df2.Score,color=\"green\")\nplt.scatter( df3.Salary, df3.Score,color=\"blue\")\n\nplt.legend()","1b3c24d2":"km1=KMeans(n_clusters=5)\ny_pred1=km.fit_predict(df[[\"Salary\",\"Score\"]])\ny_pred1","d7419091":"df0=df[df.cluster==0]\ndf1=df[df.cluster==1]\ndf2=df[df.cluster==2]\ndf3=df[df.cluster==3]\ndf4=df[df.cluster==4]\n\nplt.scatter( df0.Salary, df0.Score,color=\"grey\")\nplt.scatter( df1.Salary, df1.Score,color=\"red\")\nplt.scatter( df2.Salary, df2.Score,color=\"green\")\nplt.scatter( df3.Salary, df3.Score,color=\"blue\")\nplt.scatter( df4.Salary, df4.Score,color=\"black\")","f78c1daa":"scaler= MinMaxScaler()\nscaler.fit(df[['Salary']])\ndf[\"Salary\"]= scaler.transform(df[[\"Salary\"]])\ndf","9bf2c5ad":"scaler= MinMaxScaler()\nscaler.fit(df[['Score']])\ndf[\"Score\"]= scaler.transform(df[[\"Score\"]])\ndf","53354ba3":"km = KMeans(n_clusters=5)\ny_pred=km.fit_predict(df[[\"Salary\", \"Score\"]])\ny_pred","460748e0":"df.head()","1c514f7a":"df['cluster']=y_pred\ndf.head()","736f6ce2":"df0=df[df.cluster==0]\ndf1=df[df.cluster==1]\ndf2=df[df.cluster==2]\ndf3=df[df.cluster==3]\ndf4=df[df.cluster==4]\n\nplt.scatter( df0.Salary, df0.Score,color=\"grey\")\nplt.scatter( df1.Salary, df1.Score,color=\"red\")\nplt.scatter( df2.Salary, df2.Score,color=\"green\")\nplt.scatter( df3.Salary, df3.Score,color=\"blue\")\nplt.scatter( df4.Salary, df4.Score,color=\"black\")\nplt.legend()","4ab51d21":"### With the above graphs, we can see that most of the people have annual income between 50,000 and 75,000 Dollars.","fd338388":"## It worked! Now, lets scale the graph for more accuracy","756bbc10":"# Customer gender visualization\n***","cbd9b541":"### The elbow point can be found at k=4 or 5. In other words, there are 4 or 5 clusters in this dataset.","e9378e7a":"# Analyzing Spending score \n***","7ea8110d":"### From the histrogram, we can conclude that people of age between 18 and 35 are frequently visiting the mall.","0bd83d44":"### With these charts, we can conclude that majority of the mall customers are female.","b2d7c232":"### There seems to be 5 clusters...","48b34412":"# K-Means Clustering","ec8b25b3":"# Annual Income Analysis","7930dc86":"### We can see that most of the people have scores between 35 to 75.","20207543":"### Finding the number of clusters with the \"elbow \" method","10174410":"## Age Distribution\n***","979b8dd2":"# Introduction\n***\nThe Mall customers dataset contains information about people visiting the mall. The dataset has gender, customer id, age, annual income, and spending score. It collects insights from the data and group customers based on their behaviors.\n\nDataset: https:\/\/www.kaggle.com\/shwetabh123\/mall-customers\n\n## Problem\n***\nSegment the customers based on the age, gender, interest. Customer segmentation is an important practise of dividing customers base into individual groups that are similar. It is useful in customised marketing.","06eb621d":"### With this scatter plot, we can deduce that customers can be segmented into 5 groups with varying characteristics. The businesses in the mall can be better serve their customer base by further studying their interests, which invlove what they buy, when they buy. how much they buy."}}