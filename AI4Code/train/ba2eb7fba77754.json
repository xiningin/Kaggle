{"cell_type":{"ef217c44":"code","d6f112d0":"code","db27b6cb":"code","083671b7":"code","0cb63067":"code","39865d60":"code","36138e2d":"code","3d10360a":"code","7e4c636f":"code","d5d9dfc8":"markdown","4dcdb30c":"markdown","33dced60":"markdown"},"source":{"ef217c44":"import numpy as np\nimport pandas as pd","d6f112d0":"df = pd.read_csv('..\/input\/train.csv')\ndf.head()","db27b6cb":"df['target'].value_counts()","083671b7":"count_target_0, count_target_1 = df['target'].value_counts()\n\ndf_target_0 = df[df['target'] == 0]\ndf_target_1 = df[df['target'] == 1]\n\ndf_target_0_under = df_target_0.sample(count_target_1)\ndf_under = pd.concat([df_target_0_under, df_target_1], axis=0)\n\ndf_under['target'].value_counts().plot(kind='bar', title='Count (target)')","0cb63067":"from sklearn.model_selection import train_test_split\nfrom sklearn.feature_extraction.text import TfidfVectorizer\n\n\nX_train, X_test, y_train, y_test = train_test_split(df_under['question_text'],\n                                                    df_under['target'],\n                                                    test_size=0.2)\ntf_vectorizer = TfidfVectorizer().fit(df_under['question_text'])\nX_train = tf_vectorizer.transform(X_train)\nX_test = tf_vectorizer.transform(X_test)\nX_train.shape","39865d60":"from sklearn.naive_bayes import MultinomialNB\n\n\nclf = MultinomialNB().fit(X_train, y_train)\npredicted = clf.predict(X_test)\nnp.mean(predicted == y_test)","36138e2d":"from sklearn.metrics import f1_score\n\n\nf1_score(y_test, predicted,average=None)","3d10360a":"df_test = pd.read_csv('..\/input\/test.csv')\nX_submission = tf_vectorizer.transform(df_test['question_text'])\npredicted_test = clf.predict(X_submission)\n\ndf_test['prediction'] = predicted_test\nsubmission = df_test.drop(columns=['question_text'])\nsubmission.head()","7e4c636f":"submission.to_csv('submission.csv', index=False)","d5d9dfc8":"### Submission dataset","4dcdb30c":"### Applying","33dced60":"### Resampling imbalanced dataset\n\nTrying undersampling strategy:"}}