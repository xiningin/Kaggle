{"cell_type":{"7d7787f7":"code","2d7e3d85":"code","5cd819d6":"code","40f4dc61":"code","609e1647":"code","2ac06b1a":"markdown"},"source":{"7d7787f7":"import numpy as np\nimport pandas as pd\nfrom sklearn.preprocessing import LabelEncoder\nfrom lightgbm import LGBMRegressor\nfrom sklearn.model_selection import KFold\nfrom tqdm import tqdm\nfrom sklearn.metrics import mean_squared_error\nimport warnings\nwarnings.filterwarnings('ignore')","2d7e3d85":"X = pd.read_csv('..\/input\/tabular-playground-series-feb-2021\/train.csv',encoding='utf-8',index_col=0)\ntest = pd.read_csv('..\/input\/tabular-playground-series-feb-2021\/test.csv',encoding='utf-8',index_col=0)\n\ny = X['target']\nX = X.drop(['target'], axis= 1)","5cd819d6":"label = LabelEncoder()\ncategorical_feature = np.where(X.dtypes != 'float64')[0].tolist()\ncategorical_feature_columns = X.select_dtypes(exclude=['float64']).columns\n\nfor column in categorical_feature_columns:\n        label.fit(X[column])\n        X[column] = label.transform(X[column])\n        test[column] = label.transform(test[column])","40f4dc61":"lgbm_parameters = {\n    'metric': 'rmse', \n    'n_jobs': -1,\n    'n_estimators': 50000,\n    'reg_alpha': 10.924491968127692,\n    'reg_lambda': 17.396730654687218,\n    'colsample_bytree': 0.21497646795452627,\n    'subsample': 0.7582562557431147,\n    'learning_rate': 0.009985133666265425,\n    'max_depth': 18,\n    'num_leaves': 63,\n    'min_child_samples': 27,\n    'max_bin': 523,\n    'cat_l2': 0.025083670064082797\n}","609e1647":"lgbm_val_pred = np.zeros(len(y))\nlgbm_test_pred = np.zeros(len(test))\nmse = []\nkf = KFold(n_splits=10, shuffle=True)\n\nfor trn_idx, val_idx in tqdm(kf.split(X,y)):\n    x_train_idx = X.iloc[trn_idx]\n    y_train_idx = y.iloc[trn_idx]\n    x_valid_idx = X.iloc[val_idx]\n    y_valid_idx = y.iloc[val_idx]\n\n    lgbm_model = LGBMRegressor(**lgbm_parameters)\n    lgbm_model.fit(x_train_idx, y_train_idx, eval_set = ((x_valid_idx,y_valid_idx)),verbose = -1, early_stopping_rounds = 400,categorical_feature=categorical_feature)  \n    lgbm_test_pred += lgbm_model.predict(test)\/10\n    mse.append(mean_squared_error(y_valid_idx, lgbm_model.predict(x_valid_idx)))\n    \nnp.mean(mse)\npd.DataFrame({'id':test.index,'target':lgbm_test_pred}).to_csv('submission.csv', index=False)","2ac06b1a":"Slightly tuned the LGBM parameters from this kernel https:\/\/www.kaggle.com\/awwalmalhi\/extreme-fine-tuning-lgbm-using-7-step-training"}}