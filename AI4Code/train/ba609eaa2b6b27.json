{"cell_type":{"5f6255f1":"code","7144bc63":"code","008c03cf":"code","1cc0c019":"code","e9db884d":"code","b3755a30":"code","a44d86e2":"code","dc0ab8fe":"code","bba35f7a":"code","edb843fc":"markdown","e4218fa6":"markdown","7fa805d6":"markdown","67bf7d57":"markdown","c32a44f6":"markdown","bb5246d3":"markdown","0359f589":"markdown","201f7d85":"markdown","1135e7e5":"markdown","ae49ba00":"markdown","71d92a53":"markdown"},"source":{"5f6255f1":"import numpy as np\nimport math\nimport pandas as pd\nimport glob\nimport os\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom PIL import Image","7144bc63":"PATH = \"..\/input\/landmark-recognition-2020\"\ntrain = pd.read_csv(PATH + \"\/train.csv\")\nsample_submission = pd.read_csv(PATH + \"\/sample_submission.csv\")","008c03cf":"\nimgs = train[train.landmark_id==123]['id'].values\nprint(f\"landmark_id: {123}\")\n_, axs = plt.subplots(2, 5, figsize=(20, 8))\naxs = axs.flatten()\nfor f_name,ax in zip(imgs[:10],axs):\n    img = Image.open(f\"{PATH}\/train\/{f_name[0]}\/{f_name[1]}\/{f_name[2]}\/{f_name}.jpg\")\n    ax.imshow(img)\n    ax.axis('off')\nplt.show()\n\n\nimgs = train[train.landmark_id==138982]['id'].values\nprint(f\"landmark_id: {138982}\")\n_, axs = plt.subplots(2, 5, figsize=(20, 8))\naxs = axs.flatten()\nfor f_name,ax in zip(imgs[:10],axs):\n    img = Image.open(f\"{PATH}\/train\/{f_name[0]}\/{f_name[1]}\/{f_name[2]}\/{f_name}.jpg\")\n    ax.imshow(img)\n    ax.axis('off')    \nplt.show()","1cc0c019":"print(f'Total numbers of images in training set is {train.shape[0]}')\nprint(f'Total numbers of images in test set is {sample_submission.shape[0]}')","e9db884d":"landmarks = train.groupby('landmark_id',as_index=False)['id'].count()\\\n    .sort_values('id',ascending=False).reset_index(drop=True)\nlandmarks.rename(columns={'id':'count'},inplace=True)","b3755a30":"def add_text(ax,fontsize=12):\n    for p in ax.patches:\n        x=p.get_bbox().get_points()[:,0]\n        y=p.get_bbox().get_points()[1,1]\n        ax.annotate('{}'.format(int(y)), (x.mean(), y), ha='center', va='bottom',size=fontsize)\nfig, (ax1,ax2) = plt.subplots(2,1,figsize=(16,8))\nsns.barplot(data=landmarks[:10],x='landmark_id',y='count',ax=ax1,color='#30a2da',\n           order=landmarks[:10]['landmark_id'])\nadd_text(ax1,fontsize=8)\nax1.set_title('Top 50 Landmarks')\nax1.set_ylabel('Number of Images')\nax1.set_xticklabels(ax1.get_xticklabels(), rotation=40, ha=\"right\",size=8)\nsns.barplot(data=landmarks[-10:],x='landmark_id',y='count',ax=ax2,color='#fc4f30')\nax2.set_title('Bottom 50 Landmarks')\nax2.set_ylabel('Number of Images')\nax2.set_xticklabels(ax2.get_xticklabels(), rotation=40, ha=\"right\",size=8)\nplt.tight_layout()\nprint(f\"Number of Landmarks with less than 10 images are {len(landmarks[landmarks['count']<10])}\")\nprint(f\"Number of Landmarks with less than 20 images are {len(landmarks[landmarks['count']<20])}\")\nplt.show()","a44d86e2":"dataset = train.landmark_id.value_counts()\ndataset = pd.DataFrame({\"landmark_id\": dataset.index, \"num_of_images\": dataset.values})\nmax_img = dataset.num_of_images.max()\nmin_img = dataset.num_of_images.min()\nprint(f'Total number of classes is: {len(dataset)}')\nprint(f'maximum image for a landmark class is:{max_img}, minimum image for landmark class is:{min_img}')\n","dc0ab8fe":"# Plot\nplt.scatter(dataset.index, dataset.num_of_images, alpha=0.5)\nplt.title('No. of images Vs. Class')\nplt.xlabel('Classes')\nplt.ylabel('No. of images')\nplt.show()","bba35f7a":"num_img =50\nper = len(dataset[dataset.num_of_images<num_img])\/len(dataset)*100\nprint(f'There are {int(per)}% classes having less than {num_img} images')","edb843fc":"####  If you like it. Feel free to upvote it !!!","e4218fa6":"There is huge class imbalance in dataset. landmark (138982) having highest images which is equal to 6272. Some of clasees having 2 images also.","7fa805d6":"### Visualizing some images","67bf7d57":"# **Model Coming Soon !!!**","c32a44f6":"### Data Exploration","bb5246d3":"# Introduction\nIn this competition, you are asked to take test images and recognize which landmarks (if any) are depicted in them. The training set is available in the train\/ folder, with corresponding landmark labels in train.csv. The test set images are listed in the test\/ folder. Each image has a unique id. Since there are a large number of images, each image is placed within three subfolders according to the first three characters of the image id (i.e. image abcdef.jpg is placed in a\/b\/c\/abcdef.jpg).\n","0359f589":"# Exploratory Data Analysis","201f7d85":"### Visualizing Data Imbalance ","1135e7e5":"### Inferences\n* Training set contains 1580470 images\n* Test set contains 10345 images\n* Total number of classes is: 81313\n* maximum image for a class is: 6272, \n* minimum image for a class is: 2\n* There are 92% classes having less than 50 images","ae49ba00":"  # Read Dataset","71d92a53":"Top 10 and Bottom 10 Landmarks \n[Source](https:\/\/www.kaggle.com\/anshuls235\/google-landmark-recognition-eda)"}}