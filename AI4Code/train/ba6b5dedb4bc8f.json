{"cell_type":{"55ae3fcf":"code","cd899811":"code","5bacb15f":"code","f72e252c":"code","7445e5c6":"code","a1be6e81":"code","9ebb842e":"code","e72d7d4a":"code","8ddc90a5":"code","df3315b8":"code","b6e10a31":"code","9648c2b8":"code","aecf77a2":"code","f0ab9035":"code","da41350d":"code","ddbbfa8c":"code","272e57b7":"code","b180f78c":"code","1f9dfa07":"code","8e07f10f":"code","4a5a8838":"code","7623658b":"code","b43b4d94":"code","58bd66c7":"code","fa2b0481":"code","f2303ac4":"code","fd459d67":"code","1e296aa5":"code","a9384e50":"code","b25970c2":"code","65baa178":"code","c947649e":"code","c6a8d192":"code","f5d57200":"code","bca1e831":"code","8a08b676":"code","b7b8cccc":"code","0824ba3b":"code","c8626a40":"code","8e918cd3":"code","8b60e6ed":"code","3ab13fbd":"code","31a830a7":"code","133a694a":"code","1ad49418":"code","50334ea9":"code","f90c9de7":"code","76d3c248":"code","80e45168":"code","a2ad2e94":"code","21586fa0":"markdown","e1532299":"markdown","6ede1422":"markdown","053fffe0":"markdown","cb7fae79":"markdown","172230ce":"markdown","85adca3c":"markdown","d10c227a":"markdown","e4459ace":"markdown","48002822":"markdown","9b6a88c4":"markdown","6cc49153":"markdown","611d6bf3":"markdown","b7464a76":"markdown","611ce9cb":"markdown","007a41c6":"markdown","1da310e0":"markdown","ebbb6e24":"markdown","8ce4b195":"markdown","389b386b":"markdown","d28ba866":"markdown","639a2929":"markdown","b0d6ca46":"markdown","fa6ada9c":"markdown","ee6ab81c":"markdown","b0a9971e":"markdown","340459fa":"markdown","17359392":"markdown","c6663f66":"markdown","175f4e37":"markdown","3399a2fd":"markdown","6d664a07":"markdown","d318b544":"markdown","e16966c5":"markdown","551673eb":"markdown","eafb1896":"markdown"},"source":{"55ae3fcf":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom scipy import stats\nfrom sklearn.cluster import KMeans\n\nplt.rcParams['figure.figsize'] = [12,6]\n\nimport warnings\nwarnings.filterwarnings('ignore')","cd899811":"df = pd.read_csv(\"..\/input\/online-shoppers-intention\/online_shoppers_intention.csv\")\ndf.head()","5bacb15f":"df.shape","f72e252c":"df.isna().sum().sum()","7445e5c6":"df.info()","a1be6e81":"df.describe().T","9ebb842e":"def plot_data_count(df, col, return_pct_share=True, hue=None, figsize=(12,6)):\n    \n    plt.figure(figsize=figsize)\n    g = sns.countplot(data=df, x=col, hue=hue)\n    for rect in g.patches:\n        h = rect.get_height()\n        w = rect.get_width()\n        x = rect.get_x()\n        y = rect.get_y()\n        g.annotate(f\"{h}\", (x+w\/2, h), ha='center', va='bottom', fontsize=12)\n    g.spines['top'].set_visible(False)\n    g.spines['right'].set_visible(False)\n    g.spines['left'].set_visible(False)\n    \n    plt.show()\n    \n    if return_pct_share:\n        print(\"\\n\")\n        print(\"Percent share for each category:\")\n        print(df[col].value_counts(normalize=True)*100)","e72d7d4a":"plot_data_count(df, 'Revenue')","8ddc90a5":"plot_data_count(df, 'VisitorType')","df3315b8":"plot_data_count(df, 'TrafficType')","b6e10a31":"plot_data_count(df, 'Weekend')","9648c2b8":"plot_data_count(df, 'Region')","aecf77a2":"plot_data_count(df, 'Browser')","f0ab9035":"plot_data_count(df, 'OperatingSystems')","da41350d":"plot_data_count(df, 'Administrative')","ddbbfa8c":"plot_data_count(df, 'Informational')","272e57b7":"plot_data_count(df, 'SpecialDay')","b180f78c":"continuous_features = ['Administrative_Duration', \n                       'Informational_Duration', \n                       'ProductRelated_Duration', \n                       'BounceRates', \n                       'ExitRates', \n                       'PageValues']\n\nfig, axs = plt.subplots(nrows=3, ncols=2, figsize=(15,20))\naxs = np.ravel(axs)\nfor i, col in enumerate(continuous_features):\n    plt.sca(axs[i])\n    sns.histplot(data=df, x=col, kde=True, line_kws={'lw':2, 'ls':'--'}, color='orange')\n\nplt.suptitle(\"Distribution Plot of Continuous Features\", fontsize=18, color='#05445E', va='bottom')\nplt.tight_layout()\nplt.show()","1f9dfa07":"df[continuous_features].describe()","8e07f10f":"def chi_squared_test_result(col):\n    \n    x = df.groupby(['Revenue', col])[col].count().unstack(1).fillna(0).astype('int')\n    test_results = stats.chi2_contingency(x.values)\n    pval = test_results[1]\n    if pval<0.05:\n        print(f\"P-value: {pval:.4f} - \\n\\nIt means we can **reject the null hypothesis (at 95% CI)** and conclude that **Revenue is dependent on {col}.**\")\n    else:\n        print(f\"P-value: {pval:.4f} - \\n\\nFailed to reject null hypothesis. Both **Revenue is independent on {col}.**\")","4a5a8838":"## Visitor type\nplot_data_count(df, col='VisitorType', return_pct_share=False, hue='Revenue')","7623658b":"chi_squared_test_result('VisitorType')","b43b4d94":"## Revenue and Traffic Type\n\nplot_data_count(df, col='TrafficType', return_pct_share=False, hue='Revenue', figsize=(15,7))\n\n# chi-squared test\nchi_squared_test_result('TrafficType')","58bd66c7":"## Revenue and Region\n\nplot_data_count(df, col='Region', return_pct_share=False, hue='Revenue', figsize=(15,7))\n\n# chi-squared test\nchi_squared_test_result('Region')","fa2b0481":"## Revenue and Browser\n\nplot_data_count(df, col='Browser', return_pct_share=False, hue='Revenue', figsize=(15,7))\n\n# chi-squared test\nchi_squared_test_result('Browser')","f2303ac4":"## Revenue and OperatingSystems\n\nplot_data_count(df, col='OperatingSystems', return_pct_share=False, hue='Revenue', figsize=(15,7))\n\n# chi-squared test\nchi_squared_test_result('OperatingSystems')","fd459d67":"## Revenue and Month\n\nplot_data_count(df, col='Month', return_pct_share=False, hue='Revenue', figsize=(15,7))\n\n# chi-squared test\nchi_squared_test_result('Month')","1e296aa5":"discrete_features = ['Administrative', 'Informational', \n                     'ProductRelated', 'Month', \n                     'OperatingSystems', 'Browser', \n                     'Region', 'TrafficType', \n                     'VisitorType', 'Weekend']\n\nchi_squared_df = pd.DataFrame(columns=['feature', 'pval', 'dependent'])\n\nfor i, col in enumerate(discrete_features):\n    x = df.groupby(['Revenue', col])[col].count().unstack(1).fillna(0).astype('int')\n    res = stats.chi2_contingency(x.values)\n    pval = res[1]\n    \n    if pval < 0.05:\n        dependent = 'Yes'\n    else:\n        dependent = 'No'\n        \n    chi_squared_df.loc[i] = [col, round(pval,3), dependent]\n    \nchi_squared_df","a9384e50":"continuous_features\n\nfig, axs = plt.subplots(nrows=3, ncols=2, figsize=(15,20))\naxs = np.ravel(axs)\n\nfor i, col in enumerate(continuous_features):\n    plt.sca(axs[i])\n    sns.violinplot(data=df, x='Revenue', y=col)\n\nplt.tight_layout()\nplt.show()","b25970c2":"test_df = pd.DataFrame(columns=['col', 'mean_revenue_true', 'mean_revenue_false', 'ttest_pval', 'ks_test_pval'])\n\nfor i, col in enumerate(continuous_features):\n    revenue_true = df[col][df.Revenue==True]\n    revenue_false = df[col][df.Revenue==False]\n    \n    ttest_res = stats.ttest_ind(revenue_true, revenue_false)\n    ks_test = stats.ks_2samp(revenue_true, revenue_false)\n    \n    test_df.loc[i] = [col, revenue_true.mean(), revenue_false.mean(), round(ttest_res[1], 3), round(ks_test[1], 3)]\n    \n    \ntest_df","65baa178":"google_analytics_features = ['BounceRates', 'ExitRates', 'PageValues']","c947649e":"# Bounce Rate vs Exit Rate\n\nsns.lmplot(x=\"BounceRates\", y=\"ExitRates\", data=df, \n           scatter_kws={'alpha':0.3}, \n           line_kws={'color':'red', 'ls':'--'})\nplt.show()","c6a8d192":"# Page Value versus Bounce Rate\n\nsns.lmplot(x=\"PageValues\", y=\"BounceRates\" , \n           data=df, scatter_kws={'alpha':0.2},\n          line_kws={'color':'red', 'ls':'--'})\nplt.show()","f5d57200":"# Page Value versus Exit Rate\n\nsns.lmplot(x=\"PageValues\", y=\"ExitRates\" , \n           data=df, scatter_kws={'alpha':0.2}, \n           line_kws={'color':'red', 'ls':'--'})\nplt.show()","bca1e831":"corr_mat = df[google_analytics_features].corr()\nsns.heatmap(corr_mat, annot=True,annot_kws={'fontsize':16}, fmt='.3g', linewidths=2, cmap='Pastel1')\nplt.show()","8a08b676":"type_of_pages = ['Administrative', 'Informational', 'ProductRelated']","b7b8cccc":"# Impact of Administrative Page Views and Administrative Pageview Duration on Revenue\n\nsns.lmplot(x=\"Administrative\", y=\"Administrative_Duration\", \n           hue='Revenue', data=df, scatter_kws={'alpha':0.5})\nplt.show()","0824ba3b":"# Impact of Information Page Views and Information Pageview Duration on Revenue\n\nsns.lmplot(x=\"Informational\", y=\"Informational_Duration\", \n           hue='Revenue', data=df, scatter_kws={'alpha':0.5})\nplt.show()","c8626a40":"# Impact of ProductRelated Page Views and ProductRelated Pageview Duration on Revenue\n\nsns.lmplot(x=\"ProductRelated\", y=\"ProductRelated_Duration\", \n           hue='Revenue', data=df, scatter_kws={'alpha':0.5})\nplt.show()","8e918cd3":"corr_mat = df[type_of_pages].corr(method='spearman')\nsns.heatmap(corr_mat, annot=True,annot_kws={'fontsize':16}, fmt='.3g', linewidths=2, cmap='Pastel1')\nplt.show()","8b60e6ed":"def find_clusters(data, start=1, end=11):\n    \"\"\"\n    data: array like\n    \"\"\"\n    inertias = []\n\n    for i in range(start,end):\n        kmeans = KMeans(n_clusters=i)\n        kmeans.fit(X)\n        inertias.append(kmeans.inertia_)\n\n\n    plt.plot(np.arange(start,end), np.array(inertias), color='orange', marker='o')\n    plt.xlabel('No. of clusters')\n    plt.ylabel('Inertia')\n    plt.title(\"Elbow Curve\", fontsize=16)\n    plt.show()","3ab13fbd":"def draw_optimal_clusters(data, n_clusters=2, xlabel=None, ylabel=None, title=None):\n    \n    kmeans = KMeans(n_clusters=n_clusters)\n    kmeans.fit(data)\n    \n    y_means = kmeans.predict(X)\n    centers = kmeans.cluster_centers_\n\n    plt.scatter(X[y_means==0, 0], X[y_means==0, 1], color='lightblue', label='Uninterested Customers')\n    plt.scatter(X[y_means==1, 0], X[y_means==1, 1], color='orange', label='Interested Customers')\n    plt.scatter(centers[:,0], centers[:,1], s=100, label='Centers')\n\n    plt.legend()\n\n    plt.title(title, fontsize = 20)\n    plt.xlabel(xlabel)\n    plt.ylabel(ylabel)\n    plt.show()","31a830a7":"# Performing K-means Clustering for Informational Duration versus Bounce Rate\n\nX = df.iloc[:, [3, 6]].values\n\nfind_clusters(X)","133a694a":"draw_optimal_clusters(X,n_clusters=2, xlabel=\"Informational Duration\", \n                      ylabel=\"Bounce Rates\", \n                      title=\"Informational Duration vs Bounce Rates\")","1ad49418":"# K-means Clustering for Informational Duration versus Exit Rate\n\nX = df.iloc[:, [4, 7]].values\n\nfind_clusters(X)","50334ea9":"draw_optimal_clusters(X, n_clusters=2, xlabel='Exit Rates', \n                      ylabel='Informational Duration', \n                      title='Informational Duration vs Exit Rates')","f90c9de7":"# K-means Clustering for Administrative Duration versus Bounce Rate\n\nX = df.iloc[:, [1, 6]].values\n\nfind_clusters(X)","76d3c248":"draw_optimal_clusters(X, n_clusters=2, xlabel=\"Administrative Duration\", \n                      ylabel=\"Bounce Rates\", \n                      title=\"Administrative Duration vs Bounce Rates\")","80e45168":"X = df.iloc[:, [1, 7]].values\n\nfind_clusters(X)","a2ad2e94":"draw_optimal_clusters(X, n_clusters=2, xlabel=\"Administrative Duration\", \n                      ylabel=\"Exit Rate\", \n                      title=\"Administrative Duration Vs Exit Rate\")","21586fa0":"### Administrative Duration versus Bounce Rate","e1532299":"### Informational Duration versus Exit Rate","6ede1422":"## Clustering","053fffe0":"- Most of our visitors are coming from traffic type 2 - around 32%\n- total 83% of visitors coming from 5 major traffic type 1,2,3,4, and 13","cb7fae79":"- Only 15.47% percent of customers ended up making purchase a or more.\n- So, the conversion rate is 15.47%","172230ce":"## Univariate Analysis","85adca3c":"- Region 1 accounts for most sales, and region 3 the second most. With this information, we can plan our marketing and supply chain activities in a better way. For example, we might propose building a warehouse specifically catering to the needs of region 1 to increase delivery rates and ensure that products in the highest demand are always well stocked.","d10c227a":"- More visitors visit our site during weekdays than weekends","e4459ace":"- we can see that Information page 0 has the highest number of visitors.","48002822":"- We can see that more revenue conversion happens for web traffic generated from source 2. Even though source 13 generated a considerable amount of web traffic, conversion is very low compared to others.","9b6a88c4":"- more revenue-generating transactions happened with OS 2 than the other types.","6cc49153":"# Exploratory Data Analysis","611d6bf3":"## Data Loading and Preprocessing","b7464a76":"### Countplots","611ce9cb":"- users tend to visit page 0 the most often.","007a41c6":"### Type of Pages","1da310e0":"## Final Conclusion\n\n- The conversion rates of new visitors are high compared to those of returning customers.\n- It's a good sign that 85% of visitors are returning to site. 15% of visitors are new. We can give offers to lure more new visitors.\n- While the number of returning customers to the website is high, the conversion rate is low compared to that of new customers.\n- 65% of visitors come from browser only 1 and more than 85% of visitors come from browser 1 and 2. We can make website to more appealing, interactive and responsive to these browsers.\n- Approx 95% of visitors uses operating system 1, 2, or 3.\n- Region 1 accounts for more sales followed by region 3.\n- Month `May and November` have the highest visitors but only `November month` has more conversion rate.\n- Average spends on administrative, informational, and products related pages is more for those who bought something than those who nothing.\n- Average Bounce Rate and Exit Rate is lower when a product sales.\n- Pages with a high page value have a lower bounce rate. We should be talking with our tech team to find ways to improve the page value of the web pages.","ebbb6e24":"### Informational Duration versus Bounce Rate","8ce4b195":"## Sources\n\n- Dua, D. and Graff, C. (2019). [UCI Machine Learning Repository](http:\/\/archive.ics.uci.edu\/ml). Irvine, CA: University of California, School of Information and Computer Science.\n- [Dataset](https:\/\/archive.ics.uci.edu\/ml\/datasets\/Online+Shoppers+Purchasing+Intention+Dataset)\n- Sakar, C.O., Polat, S.O., Katircioglu, M. et al. Neural Comput & Applic (2018). [Web Link](https:\/\/link.springer.com\/article\/10.1007%2Fs00521-018-3523-0)","389b386b":"### Google Analytics Features","d28ba866":"- k=2 is the optimal number of clusters","639a2929":"- Around 39% of visitors come from region one followed by 19.5% from region 3","b0d6ca46":"### Violin Plots","fa6ada9c":"<h1>Table of Contents<span class=\"tocSkip\"><\/span><\/h1>\n<div class=\"toc\"><ul class=\"toc-item\"><li><ul class=\"toc-item\"><li><span><a href=\"#Data-Loading-and-Preprocessing\" data-toc-modified-id=\"Data-Loading-and-Preprocessing-0.1\"><span class=\"toc-item-num\">0.1&nbsp;&nbsp;<\/span>Data Loading and Preprocessing<\/a><\/span><\/li><\/ul><\/li><li><span><a href=\"#Exploratory-Data-Analysis\" data-toc-modified-id=\"Exploratory-Data-Analysis-1\"><span class=\"toc-item-num\">1&nbsp;&nbsp;<\/span>Exploratory Data Analysis<\/a><\/span><ul class=\"toc-item\"><li><span><a href=\"#Univariate-Analysis\" data-toc-modified-id=\"Univariate-Analysis-1.1\"><span class=\"toc-item-num\">1.1&nbsp;&nbsp;<\/span>Univariate Analysis<\/a><\/span><ul class=\"toc-item\"><li><span><a href=\"#Countplots\" data-toc-modified-id=\"Countplots-1.1.1\"><span class=\"toc-item-num\">1.1.1&nbsp;&nbsp;<\/span>Countplots<\/a><\/span><\/li><li><span><a href=\"#Distribution-Plots\" data-toc-modified-id=\"Distribution-Plots-1.1.2\"><span class=\"toc-item-num\">1.1.2&nbsp;&nbsp;<\/span>Distribution Plots<\/a><\/span><\/li><\/ul><\/li><li><span><a href=\"#Bivariate-Analysis\" data-toc-modified-id=\"Bivariate-Analysis-1.2\"><span class=\"toc-item-num\">1.2&nbsp;&nbsp;<\/span>Bivariate Analysis<\/a><\/span><ul class=\"toc-item\"><li><span><a href=\"#Violin-Plots\" data-toc-modified-id=\"Violin-Plots-1.2.1\"><span class=\"toc-item-num\">1.2.1&nbsp;&nbsp;<\/span>Violin Plots<\/a><\/span><\/li><li><span><a href=\"#Google-Analytics-Features\" data-toc-modified-id=\"Google-Analytics-Features-1.2.2\"><span class=\"toc-item-num\">1.2.2&nbsp;&nbsp;<\/span>Google Analytics Features<\/a><\/span><\/li><li><span><a href=\"#Type-of-Pages\" data-toc-modified-id=\"Type-of-Pages-1.2.3\"><span class=\"toc-item-num\">1.2.3&nbsp;&nbsp;<\/span>Type of Pages<\/a><\/span><\/li><\/ul><\/li><li><span><a href=\"#Clustering\" data-toc-modified-id=\"Clustering-1.3\"><span class=\"toc-item-num\">1.3&nbsp;&nbsp;<\/span>Clustering<\/a><\/span><ul class=\"toc-item\"><li><span><a href=\"#Informational-Duration-versus-Bounce-Rate\" data-toc-modified-id=\"Informational-Duration-versus-Bounce-Rate-1.3.1\"><span class=\"toc-item-num\">1.3.1&nbsp;&nbsp;<\/span>Informational Duration versus Bounce Rate<\/a><\/span><\/li><li><span><a href=\"#Informational-Duration-versus-Exit-Rate\" data-toc-modified-id=\"Informational-Duration-versus-Exit-Rate-1.3.2\"><span class=\"toc-item-num\">1.3.2&nbsp;&nbsp;<\/span>Informational Duration versus Exit Rate<\/a><\/span><\/li><li><span><a href=\"#Administrative-Duration-versus-Bounce-Rate\" data-toc-modified-id=\"Administrative-Duration-versus-Bounce-Rate-1.3.3\"><span class=\"toc-item-num\">1.3.3&nbsp;&nbsp;<\/span>Administrative Duration versus Bounce Rate<\/a><\/span><\/li><li><span><a href=\"#Administrative-Duration-versus-Exit-Rate\" data-toc-modified-id=\"Administrative-Duration-versus-Exit-Rate-1.3.4\"><span class=\"toc-item-num\">1.3.4&nbsp;&nbsp;<\/span>Administrative Duration versus Exit Rate<\/a><\/span><\/li><\/ul><\/li><li><span><a href=\"#Final-Conclusion\" data-toc-modified-id=\"Final-Conclusion-1.4\"><span class=\"toc-item-num\">1.4&nbsp;&nbsp;<\/span>Final Conclusion<\/a><\/span><\/li><li><span><a href=\"#Sources\" data-toc-modified-id=\"Sources-1.5\"><span class=\"toc-item-num\">1.5&nbsp;&nbsp;<\/span>Sources<\/a><\/span><\/li><\/ul><\/li><\/ul><\/div>","ee6ab81c":"## Bivariate Analysis","b0a9971e":"- *From chi-squared test we got that except `Region` all other discrete features are dependent on `Revenue` feature.*","340459fa":"### Distribution Plots","17359392":"- more revenue-generating transactions have been performed from Browser 2. Even though Browser 1 creates a considerable number of sessions, the conversion rate is low. This is something we need to investigate further.","c6663f66":"- more revenue conversion happens for returning customers than new customers.\n- we need to give incentives to new customers to make purchase with us.\n- First let's check whether Revenue is independent or dependent on visitor type by chi-squared test","175f4e37":"- Website visitors may be high in May, but we can observe from the preceding bar plot that a greater number of purchases were made in the month of November.","3399a2fd":"- More than 50% of visitors are using operating system 2.\n- Around 95% of visitors are coming from major three operating systems - os 2 (53.5%), os 1 (21%), os 3 (21%)","6d664a07":"- 85% of customers returns back to site, which is a good indication. Meaning that our customers are satisfifying with what they are getting.\n- 13.74% of customers are new customers.","d318b544":"- we can see that special days have no impact on the number of visitors to our website.","e16966c5":"- 64.5% percent of visitors are coming from browser 2 followed by 20% from browser 1.","551673eb":"### Administrative Duration versus Exit Rate","eafb1896":"- All type of pages and their duration are positively correlated. With an increase in the number of page-views, the page-view duration also increases.\n- Customers who have made online purchases visited fewer numbers of pages. \n- This implies that page-views don't have much effect on revenue generation."}}