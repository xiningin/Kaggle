{"cell_type":{"819ad7b6":"code","d4fed706":"code","7569b75a":"code","c65f671e":"code","f66dca3e":"code","a1dec793":"code","872fdd3c":"code","a4348fa6":"code","ba59d25b":"code","c7a3855e":"code","a78bd52c":"code","b763e250":"code","aeb78afe":"code","6e2116e5":"code","b3b948c2":"code","6f9b3beb":"code","8ad8c922":"code","bbbc2958":"code","b9bbd7c5":"code","fcceaddf":"code","9da989d8":"code","1a33ee73":"code","9706dfdd":"code","1860f0ad":"code","91c297c8":"code","b2669491":"code","9e568604":"code","81dd0065":"code","3dfb730b":"code","aa8a2766":"markdown","b4a5932a":"markdown","1f324d98":"markdown","1ffa66bf":"markdown","878ff375":"markdown","30988900":"markdown","45ebe4bd":"markdown","e062f932":"markdown"},"source":{"819ad7b6":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","d4fed706":"# Import necessary libraries\nimport matplotlib.pyplot as plt\nimport warnings\nimport seaborn as sns\nfrom colorama import Fore, Back, Style \nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix, accuracy_score\nfrom mlxtend.plotting import plot_confusion_matrix\nfrom plotly.offline import plot, iplot, init_notebook_mode\nimport plotly.graph_objs as go\nfrom plotly.subplots import make_subplots\nimport plotly.express as px\nfrom statsmodels.formula.api import ols\nimport plotly.graph_objs as gobj\n\ninit_notebook_mode(connected=True)\nwarnings.filterwarnings(\"ignore\")\nimport plotly.figure_factory as ff\n\n%matplotlib inline\n\nimport xgboost\nimport lightgbm\nfrom sklearn import preprocessing\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom catboost import CatBoostClassifier","7569b75a":"#get data\nheart_df=pd.read_csv('\/kaggle\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')\nheart_df.head()","c65f671e":"print(heart_df.info())\nheart_df.describe(include='all')","f66dca3e":"# DoubleCheck NULL and NaN\nprint('null value\\n',heart_df.isnull().sum(axis=0),'\\n')\nprint('NaN value\\n',heart_df.isna().sum(axis=0),'\\n')","a1dec793":"#Let's quickly create a plot in oreder to understand correlation between age and death\n\nfig=make_subplots(\n    rows=1, cols=2,\n    column_widths=[2,1],\n    row_heights=[1])\n\nfig.add_trace(\n    go.Box(x=heart_df['DEATH_EVENT'], y=heart_df['age'],        \n           boxpoints='all'),\nrow=1, col=1)\n\n#correlation table\nZ=heart_df[['age','DEATH_EVENT']].corr()\nX=list(Z.index)\nY=list(Z.columns)\n\n\nfig.add_trace(\n    go.Heatmap(x=X, y=Y, z=Z,\n              zmax=1, zmid=0),\nrow=1, col=2)\n\nfig.update_xaxes(title_text='Deth Event', col=1)\nfig.update_yaxes(title_text='Age', col=1)\nfig.update_layout(title_text='Death Event wise Age & Correlation')\n\nfig.show()","872fdd3c":"#Let's eplore next factor\n#anaemia\n\nfig=make_subplots(\n    rows=1, cols=2,\n    column_widths=[2,1],\n    row_heights=[1])\n\nanaemia=heart_df[['anaemia','DEATH_EVENT']]\nanaemia['anaemia'].replace(to_replace=[0,1], value=['No','Yes'], inplace=True)\nanaemia_y=anaemia[anaemia['DEATH_EVENT']==1]\nanaemia_n=anaemia[anaemia['DEATH_EVENT']==0]\n\n\nfig.add_trace(go.Histogram(histfunc=\"count\", y=anaemia_n['DEATH_EVENT'], x=anaemia_n['anaemia'], name=\"DEATH EVENT - NO\"),\n             row=1, col=1)\nfig.add_trace(go.Histogram(histfunc=\"count\", y=anaemia_y['DEATH_EVENT'], x=anaemia_y['anaemia'], name=\"DEATH EVENT - YES\"),\n             row=1, col=1)\n\n#correlation table\nZ=heart_df[['anaemia','DEATH_EVENT']].corr()\nX=list(Z.index)\nY=list(Z.columns)\n\n\nfig.add_trace(\n    go.Heatmap(x=X, y=Y, z=Z,\n              zmax=1, zmid=0, zmin=-1),\nrow=1, col=2)\n\nfig.update_xaxes(title_text='Anaemia', col=1)\nfig.update_yaxes(title_text='Death Event', col=1)\nfig.update_layout(title_text='Death Event wise Anaemia & Correlation')\n\nfig.update_layout(legend=dict(\n    yanchor=\"top\",\n    y=0.99,\n    xanchor=\"left\",\n    x=0.01\n))\n\nfig.show()","a4348fa6":"#Next One\n#creatinine_phosphokinase\n\ni='creatinine_phosphokinase'\n\nfig=make_subplots(\n    rows=1, cols=2,\n    column_widths=[2,1],\n    row_heights=[1])\n\nfig.add_trace(\n    go.Box(x=heart_df['DEATH_EVENT'], y=heart_df[i],        \n           boxpoints='all'),\nrow=1, col=1)\n\n#correlation table\nZ=heart_df[[i,'DEATH_EVENT']].corr()\nX=list(Z.index)\nY=list(Z.columns)\n\n\nfig.add_trace(\n    go.Heatmap(x=X, y=Y, z=Z,\n              zmax=1, zmid=0, zmin=-1),\nrow=1, col=2)\n\nfig.update_xaxes(title_text='Death Event', col=1)\nfig.update_yaxes(title_text='Creatinine Phosphokinase', col=1)\nfig.update_layout(title_text='Death Event wise Creatinine Phosphokinase & Correlation')\n\nfig.show()","ba59d25b":"#Next One\n#diabetes\n\ni='diabetes'\n\nfig=make_subplots(\n    rows=1, cols=2,\n    column_widths=[2,1],\n    row_heights=[1])\n\nanaemia=heart_df[[i,'DEATH_EVENT']]\nanaemia[i].replace(to_replace=[0,1], value=['No','Yes'], inplace=True)\nanaemia_y=anaemia[anaemia['DEATH_EVENT']==1]\nanaemia_n=anaemia[anaemia['DEATH_EVENT']==0]\n\n\nfig.add_trace(go.Histogram(histfunc=\"count\", y=anaemia_n['DEATH_EVENT'], x=anaemia_n[i], name=\"DEATH EVENT - NO\"),\n             row=1, col=1)\nfig.add_trace(go.Histogram(histfunc=\"count\", y=anaemia_y['DEATH_EVENT'], x=anaemia_y[i], name=\"DEATH EVENT - YES\"),\n             row=1, col=1)\n\n#correlation table\nZ=heart_df[[i,'DEATH_EVENT']].corr()\nX=list(Z.index)\nY=list(Z.columns)\n\n\nfig.add_trace(\n    go.Heatmap(x=X, y=Y, z=Z,\n              zmax=1, zmid=0, zmin=-1),\nrow=1, col=2)\n\nfig.update_xaxes(title_text='Diabetes', col=1)\nfig.update_yaxes(title_text='Death Event', col=1)\nfig.update_layout(title_text='Death Event wise Diabetes & Correlation')\n\nfig.update_layout(legend=dict(\n    yanchor=\"top\",\n    y=0.99,\n    xanchor=\"left\",\n    x=0.01\n))\n\nfig.show()","c7a3855e":"#Next One\n#creatinine_phosphokinase\n\ni='ejection_fraction'\n\nfig=make_subplots(\n    rows=1, cols=2,\n    column_widths=[2,1],\n    row_heights=[1])\n\nfig.add_trace(\n    go.Box(x=heart_df['DEATH_EVENT'], y=heart_df[i],        \n           boxpoints='all'),\nrow=1, col=1)\n\n#correlation table\nZ=heart_df[[i,'DEATH_EVENT']].corr()\nX=list(Z.index)\nY=list(Z.columns)\n\n\nfig.add_trace(\n    go.Heatmap(x=X, y=Y, z=Z,\n              zmax=1, zmid=0, zmin=-1),\nrow=1, col=2)\n\nfig.update_xaxes(title_text='Death Event', col=1)\nfig.update_yaxes(title_text='Ejection Fraction', col=1)\nfig.update_layout(title_text='Death Event wise Ejection Fraction & Correlation')\n\nfig.show()","a78bd52c":"#Next One\n#high_blood_pressure\n\ni='high_blood_pressure'\n\nfig=make_subplots(\n    rows=1, cols=2,\n    column_widths=[2,1],\n    row_heights=[1])\n\nanaemia=heart_df[[i,'DEATH_EVENT']]\nanaemia[i].replace(to_replace=[0,1], value=['No','Yes'], inplace=True)\nanaemia_y=anaemia[anaemia['DEATH_EVENT']==1]\nanaemia_n=anaemia[anaemia['DEATH_EVENT']==0]\n\n\nfig.add_trace(go.Histogram(histfunc=\"count\", y=anaemia_n['DEATH_EVENT'], x=anaemia_n[i], name=\"DEATH EVENT - NO\"),\n             row=1, col=1)\nfig.add_trace(go.Histogram(histfunc=\"count\", y=anaemia_y['DEATH_EVENT'], x=anaemia_y[i], name=\"DEATH EVENT - YES\"),\n             row=1, col=1)\n\n#correlation table\nZ=heart_df[[i,'DEATH_EVENT']].corr()\nX=list(Z.index)\nY=list(Z.columns)\n\n\nfig.add_trace(\n    go.Heatmap(x=X, y=Y, z=Z,\n              zmax=1, zmid=0, zmin=-1),\nrow=1, col=2)\n\nfig.update_xaxes(title_text='High Blood Pressure', col=1)\nfig.update_yaxes(title_text='Death Event', col=1)\nfig.update_layout(title_text='Death Event wise High Blood Pressure & Correlation')\n\nfig.update_layout(legend=dict(\n    yanchor=\"top\",\n    y=0.99,\n    xanchor=\"left\",\n    x=0.01\n))\n\nfig.show()","b763e250":"#Next One\n#platelets\n\ni='platelets'\n\nfig=make_subplots(\n    rows=1, cols=2,\n    column_widths=[2,1],\n    row_heights=[1])\n\nfig.add_trace(\n    go.Box(x=heart_df['DEATH_EVENT'], y=heart_df[i],        \n           boxpoints='all'),\nrow=1, col=1)\n\n#correlation table\nZ=heart_df[[i,'DEATH_EVENT']].corr()\nX=list(Z.index)\nY=list(Z.columns)\n\n\nfig.add_trace(\n    go.Heatmap(x=X, y=Y, z=Z,\n              zmax=1, zmid=0, zmin=-1),\nrow=1, col=2)\n\nfig.update_xaxes(title_text='Death Event', col=1)\nfig.update_yaxes(title_text='Platelets', col=1)\nfig.update_layout(title_text='Death Event wise Platelets & Correlation')\n\nfig.show()","aeb78afe":"#Next One\n#serum_creatinine\n\ni='serum_creatinine'\n\nfig=make_subplots(\n    rows=1, cols=2,\n    column_widths=[2,1],\n    row_heights=[1])\n\nfig.add_trace(\n    go.Box(x=heart_df['DEATH_EVENT'], y=heart_df[i],        \n           boxpoints='all'),\nrow=1, col=1)\n\n#correlation table\nZ=heart_df[[i,'DEATH_EVENT']].corr()\nX=list(Z.index)\nY=list(Z.columns)\n\n\nfig.add_trace(\n    go.Heatmap(x=X, y=Y, z=Z,\n              zmax=1, zmid=0, zmin=-1),\nrow=1, col=2)\n\nfig.update_xaxes(title_text='Death Event', col=1)\nfig.update_yaxes(title_text='Serum Creatinine', col=1)\nfig.update_layout(title_text='Death Event wise Serum Creatinine & Correlation')\n\nfig.show()","6e2116e5":"#Next One\n#serum_sodium\n\ni='serum_sodium'\n\nfig=make_subplots(\n    rows=1, cols=2,\n    column_widths=[2,1],\n    row_heights=[1])\n\nfig.add_trace(\n    go.Box(x=heart_df['DEATH_EVENT'], y=heart_df[i],        \n           boxpoints='all'),\nrow=1, col=1)\n\n#correlation table\nZ=heart_df[[i,'DEATH_EVENT']].corr()\nX=list(Z.index)\nY=list(Z.columns)\n\n\nfig.add_trace(\n    go.Heatmap(x=X, y=Y, z=Z,\n              zmax=1, zmid=0, zmin=-1),\nrow=1, col=2)\n\nfig.update_xaxes(title_text='Death Event', col=1)\nfig.update_yaxes(title_text='Serum Sodium', col=1)\nfig.update_layout(title_text='Death Event wise Serum Sodium & Correlation')\n\nfig.show()","b3b948c2":"#Next One\n#sex\n\ni='sex'\n\nfig=make_subplots(\n    rows=1, cols=2,\n    column_widths=[2,1],\n    row_heights=[1])\n\nanaemia=heart_df[[i,'DEATH_EVENT']]\nanaemia[i].replace(to_replace=[0,1], value=['No','Yes'], inplace=True)\nanaemia_y=anaemia[anaemia['DEATH_EVENT']==1]\nanaemia_n=anaemia[anaemia['DEATH_EVENT']==0]\n\n\nfig.add_trace(go.Histogram(histfunc=\"count\", y=anaemia_n['DEATH_EVENT'], x=anaemia_n[i], name=\"DEATH EVENT - NO\"),\n             row=1, col=1)\nfig.add_trace(go.Histogram(histfunc=\"count\", y=anaemia_y['DEATH_EVENT'], x=anaemia_y[i], name=\"DEATH EVENT - YES\"),\n             row=1, col=1)\n\n#correlation table\nZ=heart_df[[i,'DEATH_EVENT']].corr()\nX=list(Z.index)\nY=list(Z.columns)\n\n\nfig.add_trace(\n    go.Heatmap(x=X, y=Y, z=Z,\n              zmax=1, zmid=0, zmin=-1),\nrow=1, col=2)\n\nfig.update_xaxes(title_text='Sex', col=1)\nfig.update_yaxes(title_text='Death Event', col=1)\nfig.update_layout(title_text='Death Event wise Sex & Correlation')\n\nfig.update_layout(legend=dict(\n    yanchor=\"top\",\n    y=0.99,\n    xanchor=\"left\",\n    x=0.01\n))\n\nfig.show()","6f9b3beb":"#Next One\n#smiking\n\ni='smoking'\n\nfig=make_subplots(\n    rows=1, cols=2,\n    column_widths=[2,1],\n    row_heights=[1])\n\nanaemia=heart_df[[i,'DEATH_EVENT']]\nanaemia[i].replace(to_replace=[0,1], value=['No','Yes'], inplace=True)\nanaemia_y=anaemia[anaemia['DEATH_EVENT']==1]\nanaemia_n=anaemia[anaemia['DEATH_EVENT']==0]\n\n\nfig.add_trace(go.Histogram(histfunc=\"count\", y=anaemia_n['DEATH_EVENT'], x=anaemia_n[i], name=\"DEATH EVENT - NO\"),\n             row=1, col=1)\nfig.add_trace(go.Histogram(histfunc=\"count\", y=anaemia_y['DEATH_EVENT'], x=anaemia_y[i], name=\"DEATH EVENT - YES\"),\n             row=1, col=1)\n\n#correlation table\nZ=heart_df[[i,'DEATH_EVENT']].corr()\nX=list(Z.index)\nY=list(Z.columns)\n\n\nfig.add_trace(\n    go.Heatmap(x=X, y=Y, z=Z,\n              zmax=1, zmid=0, zmin=-1),\nrow=1, col=2)\n\nfig.update_xaxes(title_text='Smoking', col=1)\nfig.update_yaxes(title_text='Death Event', col=1)\nfig.update_layout(title_text='Death Event wise Smoking & Correlation')\n\nfig.update_layout(legend=dict(\n    yanchor=\"top\",\n    y=0.99,\n    xanchor=\"left\",\n    x=0.01\n))\n\nfig.show()","8ad8c922":"#Next One\n#time\n\ni='time'\n\nfig=make_subplots(\n    rows=1, cols=2,\n    column_widths=[2,1],\n    row_heights=[1])\n\nfig.add_trace(\n    go.Box(x=heart_df['DEATH_EVENT'], y=heart_df[i],        \n           boxpoints='all'),\nrow=1, col=1)\n\n#correlation table\nZ=heart_df[[i,'DEATH_EVENT']].corr()\nX=list(Z.index)\nY=list(Z.columns)\n\n\nfig.add_trace(\n    go.Heatmap(x=X, y=Y, z=Z,\n              zmax=1, zmid=0, zmin=-1),\nrow=1, col=2)\n\nfig.update_xaxes(title_text='Death Event', col=1)\nfig.update_yaxes(title_text='Time', col=1)\nfig.update_layout(title_text='Death Event wise Time & Correlation')\n\nfig.show()","bbbc2958":"# Let's create correlation matrix for all figures\ncorr_df=heart_df.corr()\nmask = np.triu(np.ones_like(corr_df, dtype=np.bool))\n\n#corr_df\nplt.figure(figsize=(20,8))\nsns.heatmap(corr_df,\n            vmin=-1, vmax=1,\n            annot=True,\n            cmap='PiYG',\n            mask=mask,\n            linewidths=.5)\nplt.show()","b9bbd7c5":"# Creat Ranking correlation table\ncorr_death=corr_df[['DEATH_EVENT']][0:-1]\ncorr_death['ABS_DEATH_EVENT']=abs(corr_death.values)\ncorr_death['Rank']=corr_death['ABS_DEATH_EVENT'].rank()\ncorr_death=corr_death.sort_values(by='Rank', ascending=False)\ncorr_death","fcceaddf":"#Creat correlation ranking charts\nplt.figure(figsize=(16,8))\n\nplt.subplot(1,2,1)\nsns.heatmap(corr_death[['Rank']],\n           vmin=corr_death[['Rank']].min(), vmax=corr_death[['Rank']].max(),\n            cmap='Blues',\n            linewidths=.5)\nplt.subplot(1,2,2)\ncorr_death.sort_values(by='Rank', ascending=True)['DEATH_EVENT'].plot(kind='barh', color='LightBlue', width=1, edgecolor='black')\nfor i, value in enumerate(corr_death.sort_values(by='Rank', ascending=True)['DEATH_EVENT']):\n    text=\"{:.2f}\".format(value)\n    plt.annotate(text=text, xy=(value\/2, i-0.1), fontsize=15)\n        \nplt.axis('off')\n\nplt.show()","9da989d8":"#Let's try create LR and define accurasy with difference factors\n#Start with top 2\ncolumns=list(corr_death.index)\nn_columns=len(columns)\n\ntransform = preprocessing.StandardScaler()\n\nlr=LogisticRegression()\n\nacc_table=pd.DataFrame(columns=['Columns','Accuracy'])\n\nfor i in range(2,n_columns+1):\n    end=i\n    features=columns[0:end]\n    print(features)\n    x=heart_df[features]\n    y=heart_df['DEATH_EVENT']\n    x=transform.fit_transform(x)\n    #print(x[0:5], '\\n')\n    #print(y[0:5], '\\n')\n    x_train, x_test, y_train, y_test=train_test_split(x, y, test_size=0.2, random_state=2)\n    #print('X train set:', x_train.shape)\n    #print('Y train set:', y_train.shape)\n    lr.fit(x_train, y_train)\n    y_hat=lr.predict(x_test)\n    acc=accuracy_score(y_test, y_hat)*100\n    \n    print('Accuracy: ','{:.2f}%'.format(acc), '\\n')\n    row=pd.DataFrame([[i, acc.tolist()]], columns=['Columns','Accuracy'])\n    acc_table=acc_table.append(row)\n    \nacc_table\n\nbest=acc_table.sort_values(by='Accuracy', ascending=False)['Columns'].iloc[0]\nprint(\"Best number of columns: \", best)\nbest_acc=acc_table.sort_values(by='Accuracy', ascending=False)['Accuracy'].iloc[0]\nymin=acc_table.sort_values(by='Accuracy', ascending=False)['Accuracy'].iloc[-1]\n\nacc_table.set_index('Columns').plot(kind='line',\n                                   figsize=(25,8),\n                                   marker='o', \n                                   legend=False)\nplt.annotate(text='Best Accuracy: '+'{:.2f}%'.format(best_acc)+' '+str(columns[0:best+1]),\n             xy=(best-0.6, best_acc+0.05),\n             fontsize=12,\n             color='red')\n\nplt.title('Accuracy of Logistic Regression with difference factors \\n', fontsize=20)\nplt.xlabel('Columns', fontsize=16)\nplt.ylabel('Accuracy', fontsize=16)\nplt.ylim(ymin-0.2, best_acc+0.5)\n\n\nplt.show()","1a33ee73":"best_features=columns[0:best]\nprint(columns)\nprint(best_features)\nbest_x=heart_df[best_features]\ny=heart_df['DEATH_EVENT']\nbest_x=transform.fit_transform(best_x)\nx_train, x_test, y_train, y_test=train_test_split(best_x, y, test_size=0.2, random_state=2)\nlr.fit(x_train, y_train)\nbest_y_hat=lr.predict(x_test)\n\ncm = confusion_matrix(y_test, best_y_hat)\nplt.figure()\nplot_confusion_matrix(cm, figsize=(12,8), hide_ticks=True, cmap=plt.cm.Blues)\nplt.title(\"Logistic Regression Model - Confusion Matrix\")\nplt.xticks(range(2), [\"Heart Not Failed\",\"Heart Fail\"], fontsize=16)\nplt.yticks(range(2), [\"Heart Not Failed\",\"Heart Fail\"], fontsize=16)\nplt.show()\n\nlr_best_acc=accuracy_score(y_test, best_y_hat)*100\n    \nprint('Accuracy: ','{:.2f}%'.format(lr_best_acc), '\\n')","9706dfdd":"#Let's try create SVM and define accurasy with difference factors\n#Start with top 2\ncolumns=list(corr_death.index)\nn_columns=len(columns)\n\ntransform = preprocessing.StandardScaler()\n\nsvm=SVC()\n\nacc_table=pd.DataFrame(columns=['Columns','Accuracy'])\n\nfor i in range(2,n_columns+1):\n    end=i\n    features=columns[0:end]\n    print(features)\n    x=heart_df[features]\n    y=heart_df['DEATH_EVENT']\n    x=transform.fit_transform(x)\n    #print(x[0:5], '\\n')\n    #print(y[0:5], '\\n')\n    x_train, x_test, y_train, y_test=train_test_split(x, y, test_size=0.2, random_state=2)\n    #print('X train set:', x_train.shape)\n    #print('Y train set:', y_train.shape)\n    svm.fit(x_train, y_train)\n    y_hat=svm.predict(x_test)\n    acc=accuracy_score(y_test, y_hat)*100\n    \n    print('Accuracy: ','{:.2f}%'.format(acc), '\\n')\n    row=pd.DataFrame([[i, acc.tolist()]], columns=['Columns','Accuracy'])\n    acc_table=acc_table.append(row)\n    \nacc_table\n\nbest=acc_table.sort_values(by='Accuracy', ascending=False)['Columns'].iloc[0]\nprint(\"Best number of columns: \", best)\nbest_acc=acc_table.sort_values(by='Accuracy', ascending=False)['Accuracy'].iloc[0]\nymin=acc_table.sort_values(by='Accuracy', ascending=False)['Accuracy'].iloc[-1]\n\nacc_table.set_index('Columns').plot(kind='line',\n                                   figsize=(25,8),\n                                   marker='o', \n                                   legend=False)\nplt.annotate(text='Best Accuracy: '+'{:.2f}%'.format(best_acc)+' '+str(columns[0:best+1]),\n             xy=(best-0.6, best_acc+0.05),\n             fontsize=12,\n             color='red')\n\nplt.title('Accuracy of Logistic Regression with difference factors \\n', fontsize=20)\nplt.xlabel('Columns', fontsize=16)\nplt.ylabel('Accuracy', fontsize=16)\nplt.ylim(ymin-0.5, best_acc+0.5)\n\n\nplt.show()","1860f0ad":"best_features=columns[0:best]\nprint(columns)\nprint(best_features)\nbest_x=heart_df[best_features]\ny=heart_df['DEATH_EVENT']\nbest_x=transform.fit_transform(best_x)\nx_train, x_test, y_train, y_test=train_test_split(best_x, y, test_size=0.2, random_state=2)\nsvm.fit(x_train, y_train)\nbest_y_hat=svm.predict(x_test)\n\ncm = confusion_matrix(y_test, best_y_hat)\nplt.figure()\nplot_confusion_matrix(cm, figsize=(12,8), hide_ticks=True, cmap=plt.cm.Blues)\nplt.title(\"Logistic Regression Model - Confusion Matrix\")\nplt.xticks(range(2), [\"Heart Not Failed\",\"Heart Fail\"], fontsize=16)\nplt.yticks(range(2), [\"Heart Not Failed\",\"Heart Fail\"], fontsize=16)\nplt.show()\n\nsvm_best_acc=accuracy_score(y_test, best_y_hat)*100\n    \nprint('Accuracy: ','{:.2f}%'.format(svm_best_acc), '\\n')","91c297c8":"#Let's try create KNN and define accurasy with difference factors\n#Start with top 2\ncolumns=list(corr_death.index)\nn_columns=len(columns)\n\ntransform = preprocessing.StandardScaler()\n\n#knn=KNeighborsClassifier(n_neighbors=6)\n\nkacc_table=pd.DataFrame(columns=['Columns','K','Accuracy'])\n\nfor i in range(2,n_columns+1):\n    end=i\n    features=columns[0:end]\n    print(features)\n    for k in range(1,15):\n        knn=KNeighborsClassifier(n_neighbors=k)\n        x=heart_df[features]\n        y=heart_df['DEATH_EVENT']\n        x=transform.fit_transform(x)\n        #print(x[0:5], '\\n')\n        #print(y[0:5], '\\n')\n        x_train, x_test, y_train, y_test=train_test_split(x, y, test_size=0.2, random_state=2)\n        #print('X train set:', x_train.shape)\n        #print('Y train set:', y_train.shape)\n        knn.fit(x_train, y_train)\n        y_hat=knn.predict(x_test)\n        acc=accuracy_score(y_test, y_hat)*100\n    \n        #print('Accuracy with K=',k,': ','{:.2f}%'.format(acc), '\\n')\n        row=pd.DataFrame([[i, k, acc.tolist()]], columns=['Columns', 'K', 'Accuracy'])\n        kacc_table=kacc_table.append(row)\n    \nkacc_table.sort_values(by='Accuracy', ascending=False).head()\n\nc_best=kacc_table.sort_values(by='Accuracy', ascending=False)['Columns'].iloc[0]\nk_best=kacc_table.sort_values(by='Accuracy', ascending=False)['K'].iloc[0]\n\nprint('\\nBest K: ',k_best)\nprint('\\nBest Columns: ',c_best)","b2669491":"print(columns)\nprint(best_features)\nprint(k_best)\n\nbest_features=columns[0:c_best]\nknn=KNeighborsClassifier(n_neighbors=k_best)\n\nbest_x=heart_df[best_features]\ny=heart_df['DEATH_EVENT']\nbest_x=transform.fit_transform(best_x)\nx_train, x_test, y_train, y_test=train_test_split(best_x, y, test_size=0.2, random_state=2)\nknn.fit(x_train, y_train)\nbest_y_hat=knn.predict(x_test)\n\ncm = confusion_matrix(y_test, best_y_hat)\nplt.figure()\nplot_confusion_matrix(cm, figsize=(12,8), hide_ticks=True, cmap=plt.cm.Blues)\nplt.title(\"Logistic Regression Model - Confusion Matrix\")\nplt.xticks(range(2), [\"Heart Not Failed\",\"Heart Fail\"], fontsize=16)\nplt.yticks(range(2), [\"Heart Not Failed\",\"Heart Fail\"], fontsize=16)\nplt.show()\n\nknn_best_acc=accuracy_score(y_test, best_y_hat)*100\n    \nprint('Accuracy: ','{:.2f}%'.format(knn_best_acc), '\\n')","9e568604":"#Let's try create KNN and define accurasy with difference factors\n#Start with top 2\ncolumns=list(corr_death.index)\nn_columns=len(columns)\n\ntransform = preprocessing.StandardScaler()\n\ntree=DecisionTreeClassifier()\n\nacc_table=pd.DataFrame(columns=['Columns','Accuracy'])\n\nfor i in range(2,n_columns+1):\n    end=i\n    features=columns[0:end]\n    print(features)\n    x=heart_df[features]\n    y=heart_df['DEATH_EVENT']\n    x=transform.fit_transform(x)\n    #print(x[0:5], '\\n')\n    #print(y[0:5], '\\n')\n    x_train, x_test, y_train, y_test=train_test_split(x, y, test_size=0.2, random_state=2)\n    #print('X train set:', x_train.shape)\n    #print('Y train set:', y_train.shape)\n    tree.fit(x_train, y_train)\n    y_hat=tree.predict(x_test)\n    acc=accuracy_score(y_test, y_hat)*100\n    \n    print('Accuracy: ','{:.2f}%'.format(acc), '\\n')\n    row=pd.DataFrame([[i, acc.tolist()]], columns=['Columns','Accuracy'])\n    acc_table=acc_table.append(row)\n    \nacc_table\n\nbest=acc_table.sort_values(by='Accuracy', ascending=False)['Columns'].iloc[0]\nprint(\"Best number of columns: \", best)\nbest_acc=acc_table.sort_values(by='Accuracy', ascending=False)['Accuracy'].iloc[0]\nymin=acc_table.sort_values(by='Accuracy', ascending=False)['Accuracy'].iloc[-1]\n\nacc_table.set_index('Columns').plot(kind='line',\n                                   figsize=(25,8),\n                                   marker='o', \n                                   legend=False)\nplt.annotate(text='Best Accuracy: '+'{:.2f}%'.format(best_acc)+' '+str(columns[0:best+1]),\n             xy=(best-0.6, best_acc+0.05),\n             fontsize=12,\n             color='red')\n\nplt.title('Accuracy of Logistic Regression with difference factors \\n', fontsize=20)\nplt.xlabel('Columns', fontsize=16)\nplt.ylabel('Accuracy', fontsize=16)\nplt.ylim(ymin-0.5, best_acc+0.5)\n\n\nplt.show()","81dd0065":"best_features=columns[0:best]\nprint(columns)\nprint(best_features)\nbest_x=heart_df[best_features]\ny=heart_df['DEATH_EVENT']\nbest_x=transform.fit_transform(best_x)\nx_train, x_test, y_train, y_test=train_test_split(best_x, y, test_size=0.2, random_state=2)\ntree.fit(x_train, y_train)\nbest_y_hat=tree.predict(x_test)\n\ncm = confusion_matrix(y_test, best_y_hat)\nplt.figure()\nplot_confusion_matrix(cm, figsize=(12,8), hide_ticks=True, cmap=plt.cm.Blues)\nplt.title(\"Logistic Regression Model - Confusion Matrix\")\nplt.xticks(range(2), [\"Heart Not Failed\",\"Heart Fail\"], fontsize=16)\nplt.yticks(range(2), [\"Heart Not Failed\",\"Heart Fail\"], fontsize=16)\nplt.show()\n\ntree_best_acc=accuracy_score(y_test, best_y_hat)*100\n    \nprint('Accuracy: ','{:.2f}%'.format(tree_best_acc), '\\n')","3dfb730b":"acc_list=[lr_best_acc, svm_best_acc, knn_best_acc, tree_best_acc]\nacc_df=pd.DataFrame([acc_list], columns=('lr','svm','knn','tree'))\nbar_df=acc_df.transpose()\nacc_max=bar_df.max()\nbar_df['color']=np.where(bar_df==acc_max, 'green', 'grey')\nbar_df.rename(columns={0:'value'}, inplace=True)\nbar_df\n\nplt.figure(figsize=(20,8))\nplt.bar(x=bar_df.index, height=bar_df['value'],\n       color=bar_df['color'])\n        \nfor i, value in enumerate(acc_list):\n    text='{:.2f}%'.format(value)\n    plt.annotate(text=text, xy=(i-0.05, value\/2), fontsize=12)\n    \nplt.title('Accuracy of the Models\\n', fontsize=20)\nplt.xlabel('Model\\n', fontsize=12)\nplt.ylabel('Accuracy\\n', fontsize=12)\nplt.xticks(rotation=0, fontsize=12)\n\nplt.show() ","aa8a2766":"## Suport Vector","b4a5932a":"## Tree","1f324d98":"# Summary","1ffa66bf":"## Logistic Regresion","878ff375":"## KNN","30988900":"# Data Exploritaion","45ebe4bd":"# Data Preparation","e062f932":"# Modeling"}}