{"cell_type":{"56bbc075":"code","e2152218":"code","fb18a416":"code","f21660b2":"code","7a686eee":"code","6b60d734":"code","75095d4e":"code","b62fcf19":"code","ae07b299":"code","118ef67c":"code","4ec1157a":"code","514c0353":"code","3daa470d":"code","91085228":"code","7455f2ec":"code","c7897459":"code","735c9555":"code","0c523758":"code","7109eddf":"markdown","1a2469eb":"markdown","d896a031":"markdown","d7392a5e":"markdown","88e219d3":"markdown","15527875":"markdown","6d917571":"markdown","5283411a":"markdown"},"source":{"56bbc075":"from sklearn.datasets import load_breast_cancer\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV,cross_val_score\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n","e2152218":"data = load_breast_cancer()","fb18a416":"data.data.shape\n#569\u6a23\u672c\uff0c30\u500b\u7279\u5fb5","f21660b2":"data.target","7a686eee":"rfc = RandomForestClassifier(n_estimators=100,random_state=90) #\u5be6\u4f8b\u5316\nscore_pre = cross_val_score(rfc,data.data,data.target,cv = 10).mean()\nscore_pre","6b60d734":"#\u756bn_estimators\u7684\u5b78\u7fd2\u66f2\u7dda\u5148\u5f9e\u53d6\u6bcf\u5341\u4e2a\u6570\u4f5c\u4e3a\u4e00\u4e2a\u9636\u6bb5\nscorel = []\nfor i in range(0,200,10): #\u6703\u4ee51\u300111\u300121...\u4e00\u8def\u5230200\n    rfc = RandomForestClassifier(n_estimators=i+1, n_jobs=-1,random_state=90)#n_estimators\u4e0d\u70ba\u96f6\n    score = cross_val_score(rfc,data.data,data.target,cv=10).mean()\n    scorel.append(score) \nprint(max(scorel),(scorel.index(max(scorel))*10)+1) #\u8fd4\u56descorel\u4e2d\u6700\u5927\u503c\u7684\u7d22\u5f15\uff0a10\uff0b1(\u56e0\u70ba\u9593\u8ddd\u662f10\uff0cn_estimators\u6709+1)\nplt.figure(figsize=[20,5]) \nplt.plot(range(1,201,10),scorel)\nplt.show()\n\n#\u8fd4\u56de\u51fa\uff1a\u5f97\u51fa\u4f86scorel\u7684\u6700\u5927\u503c\u662f\uff0cn_estimators\u662f","75095d4e":"#\u7e2e\u77ed\u7bc4\u570d\uff08\u4e00\u6a23\u7684\u6b65\u9a5f\uff09\nscorel = []\nfor i in range(65,75): \n    rfc = RandomForestClassifier(n_estimators=i, n_jobs=-1,random_state=90)\n    score = cross_val_score(rfc,data.data,data.target,cv=10).mean()\n    scorel.append(score) \nprint(max(scorel)\n      ,([*range(65,75)][scorel.index(max(scorel))]))  #\u8fd4\u56descorel\u4e2d\u6700\u5927\u503c\u7684\u7d22\u5f15 \nplt.figure(figsize=[20,5]) \nplt.plot(range(65,75),scorel)\nplt.show()","b62fcf19":"#\u7db2\u683c\u641c\u7d22\n#\u8c03\u6574max_depth\nparam_grid = {'max_depth':np.arange(1, 20, 1)}#\u5e0c\u671b\u641c\u7d22\u7684\u53c3\u6578\nrfc = RandomForestClassifier(n_estimators=73  #\u6839\u64da\u4e0a\u9762\u7684\u8abfn_estimators\u7684\u7d50\u679c\n                             ,random_state=90\n                            )\nGS = GridSearchCV(rfc,param_grid,cv=10).fit(data.data,data.target)      \nGS.best_params_ #\u986f\u793a\u6700\u4f73\u8abf\u6574\u51fa\u4f86\u7684\u53c3\u6578","ae07b299":"GS.best_score_#\u8fd4\u56de\u6700\u5927\u53c3\u6578\u7684\u6e96\u78ba\u7387","118ef67c":"#\u8c03\u6574max_features\nparam_grid = {'max_features':np.arange(5,30,1)} \n#max_features\u7684\u9ed8\u8a8d\u7684\u6700\u5c0f\u503c\u662f\u7279\u5fb5\u6578\u7684\u958b\u6839\u865f\uff0c\u4e00\u76f4\u8abf\u5230\u7279\u5fb5\u6578\u80fd\u5230\u7684\u6700\u5927\u503c\nrfc = RandomForestClassifier(n_estimators=73\n                             ,random_state=90)\nGS = GridSearchCV(rfc,param_grid,cv=10).fit(data.data,data.target) \nGS.best_params_","4ec1157a":"GS.best_score_\n#\u9084\u662f\u964d\u4f4e\u60f9","514c0353":"#\u8c03\u6574min_samples_leaf(\u9ed8\u8a8d\u662f1)\nparam_grid = {'min_samples_leaf':np.arange(1,1+10,1)} \n#max_features\u7684\u9ed8\u8a8d\u7684\u6700\u5c0f\u503c\u662f\u7279\u5fb5\u6578\u7684\u958b\u6839\u865f\uff0c\u4e00\u76f4\u8abf\u5230\u7279\u5fb5\u6578\u80fd\u5230\u7684\u6700\u5927\u503c\nrfc = RandomForestClassifier(n_estimators=73\n                             ,random_state=90)\nGS = GridSearchCV(rfc,param_grid,cv=10).fit(data.data,data.target)\nGS.best_params_ #\u5982\u679c=\u9ed8\u8a8d\u503c\u6709\u8abf\u6839\u6c92\u8abf\u4e00\u6a23","3daa470d":"GS.best_score_","91085228":"#\u8c03\u6574min_samples_split(\u9ed8\u8a8d\u503c\u662f2)\nparam_grid = {'min_samples_split':np.arange(2,2+20,1)} \n\nrfc = RandomForestClassifier(n_estimators=73\n                             ,random_state=90)\nGS = GridSearchCV(rfc,param_grid,cv=10).fit(data.data,data.target) \nGS.best_params_ #\u5982\u679c\u7b49\u65bc\u9ed8\u8a8d\u503c\u6709\u8abf\u6839\u6c92\u8abf\u4e00\u6a23","7455f2ec":"GS.best_score_","c7897459":"param_grid = {'criterion':['gini', 'entropy']}\nrfc = RandomForestClassifier(n_estimators=73\n                             ,random_state=90\n                            )\nGS = GridSearchCV(rfc,param_grid,cv=10)\nGS.fit(data.data,data.target)\nGS.best_params_ ","735c9555":"GS.best_score_","0c523758":"rfc = RandomForestClassifier(n_estimators=73,random_state=90) \nscore = cross_val_score(rfc,data.data,data.target,cv=10).mean() \nscore\nscore - score_pre","7109eddf":"\u5148\u5efa\u7acb\u4e00\u822c\u7684RandomForestClassifier\u6a21\u578b","1a2469eb":"\u8c03\u6574min_samples_leaf(\u9ed8\u8a8d\u662f1)","d896a031":"    \u8abfmax_depth","d7392a5e":"\u767c\u73fe\u9664\u8abf\u6574n_estimators\u6709\u63d0\u9ad8\u4e9b\u8a31\u6e96\u78ba\u503c\u5916\uff0c\u5176\u9918\u7686\u6bd4\u6c92\u8abf\u53c3\u4f4e\uff0c\u65bc\u662f\u6211\u5011\u767c\u73fe\u53ea\u9700\u8abfn_estimators\u5373\u53ef\u3002","88e219d3":"\u8abfn_estimators\uff08\u5728\u96a8\u6a5f\u68ee\u6797\u4e2d\u9019\u662f\u6700\u91cd\u8981\u7684\uff01\uff01\uff01\uff09","15527875":"\u8c03\u6574max_features","6d917571":"\u8c03\u6574min_samples_split(\u9ed8\u8a8d\u503c\u662f2)****","5283411a":"\u8abf\u6574 criterion"}}