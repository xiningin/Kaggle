{"cell_type":{"48f7acef":"code","f07ef5a8":"code","a23a7cc3":"code","35e8b726":"code","a54ccddd":"code","ecf5e92a":"code","03c49fc2":"code","834e08fc":"code","a06a5774":"code","061373b1":"code","d16828e4":"code","8ee0689b":"code","622e3085":"code","e2bffef3":"code","99d4a260":"code","2b412f55":"code","dae7765b":"code","1fe73d2a":"code","0aae2947":"code","a54c006f":"markdown","6a70eab1":"markdown","c0fd72f5":"markdown","e6e640e2":"markdown","a76b28a6":"markdown","317dacc0":"markdown","88228be3":"markdown","cd47251e":"markdown","dac3c6e0":"markdown","5a0810d1":"markdown","739006a7":"markdown","83d17e50":"markdown","7063e47a":"markdown","f4d32dc0":"markdown","2493782b":"markdown"},"source":{"48f7acef":"from pandas import Series, DataFrame\nimport pandas as pd\nimport numpy as np\nimport os\nimport matplotlib.pylab as plt\nfrom sklearn.model_selection  import train_test_split\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import log_loss\nimport sklearn.metrics","f07ef5a8":"prospect_data = pd.read_csv(\"..\/input\/browsingcsv\/browsing.csv\")\nprospect_data.dtypes","a23a7cc3":"# Look at the top records to understand how the data looks like.\nprospect_data.head()","35e8b726":"#Do summary statistics analysis of the data\nprospect_data.describe()","a54ccddd":"prospect_data.corr()['BUY']","ecf5e92a":"import seaborn as sns\nsns.countplot(data = prospect_data, x = 'BUY')","03c49fc2":"sns.countplot(x= \"BUY\",hue=\"REVIEWS\", data=prospect_data)","834e08fc":"sns.countplot(x= \"BUY\",hue=\"FAQ\", data=prospect_data)","a06a5774":"sns.countplot(x= \"BUY\",hue=\"COMPARE_SIMILAR\", data=prospect_data)","061373b1":"pd.crosstab(prospect_data['BUY'], prospect_data['REVIEWS']).plot(kind='bar', stacked=True)","d16828e4":"pd.crosstab(prospect_data['BUY'], prospect_data['COMPARE_SIMILAR']).plot(kind='bar', stacked=True)","8ee0689b":"#Drop columns with low correlation\npredictors = prospect_data[['REVIEWS','BOUGHT_TOGETHER','COMPARE_SIMILAR','WARRANTY','SPONSORED_LINKS']]\ntargets = prospect_data.BUY\npredictors.head()","622e3085":"pred_train, pred_test, tar_train, tar_test  =   train_test_split(predictors, targets, test_size=.3)\n\nprint( \"Predictor - Training : \", pred_train.shape, \"Predictor - Testing : \", pred_test.shape )","e2bffef3":"from sklearn.naive_bayes import GaussianNB\n\nclassifier=GaussianNB()\nclassifier=classifier.fit(pred_train,tar_train)\n\npredictions=classifier.predict(pred_test)\n\n#Analyze accuracy of predictions\nsklearn.metrics.confusion_matrix(tar_test,predictions)\n","99d4a260":"sklearn.metrics.accuracy_score(tar_test, predictions)","2b412f55":"pred_prob=classifier.predict_proba(pred_test)\npred_prob[0,1]","dae7765b":"browsing_data = np.array([0,0,0,0,0]).reshape(1, -1)\nprint(\"New visitor: propensity :\",classifier.predict_proba(browsing_data)[:,1] )\n","1fe73d2a":"browsing_data = np.array([0,0,1,0,0]).reshape(1, -1)\nprint(\"After checking similar products: propensity :\",classifier.predict_proba(browsing_data)[:,1] )\n","0aae2947":"browsing_data = np.array([1,0,1,0,0]).reshape(1, -1)\nprint(\"After checking reviews: propensity :\",classifier.predict_proba(browsing_data)[:,1] )\n","a54c006f":"Looking at the correlations above we can see that some features like REVIEWS, BRO_TOGETHER, COMPARE_SIMILAR, WARRANTY and SPONSORED_LINKS have medium correlation to the target variable. We will reduce our feature set to that list of variables.","6a70eab1":"The data contains information about the various links on the website that are clicked by the user during his browsing. This is past data that will be used to build the model.\n\n- Session ID : A unique identifier for the web browsing session\n- Buy : Whether the prospect ended up buying the product\n- Other columns : a 0 or 1 indicator to show whether the prospect visited that particular page or did the activity mentioned.\n","c0fd72f5":"In this notebook, I will show you how to predict propensity of prospects. We will use web clicks data about the links clicked by the user while he is browsing to predict his propensity to buy the product. Using that propensity, we will decide whether we want to offer chat to the customer with an agent.","e6e640e2":"## Loading and Viewing Data\nWe will load the data file for this example and checkout summary statistics and columns for that file.","a76b28a6":"The probability above can be read as 31% chance that the prospect will buy the product.","317dacc0":"##  Training and Testing Split\n\nWe now split the model into training and testing data in the ratio of 70:30","88228be3":"So the initial probability is 4%. Now, suppose the customer does a comparison of similar products. The array changes to include a 1 for that function. The new probability will be","cd47251e":"### Perform some Exploratory Data Analysis","dac3c6e0":"It goes up. Next, he checks out reviews.","5a0810d1":"Instead of doing a Yes\/No prediction, we can instead do a probability computation to show the probability for the prospect to buy the product","739006a7":"## Real time predictions\n\nNow that the model has been built, let us use it for real time predictions. So when the customer starts visiting the pages one by one, we collect that list and then use it to compute the probability. We do that for every new click that comes in.\n\nSo let us start. The prospect just came to your website. There are no significant clicks. Let us compute the probability. The array of values passed has the values for REVIEWS, BOUGHT_TOGETHER, COMPARE_SIMILAR, WARRANTY and SPONSORED_LINKS. So the array is all zeros to begin with","83d17e50":"It shoots up to 50+%. You can have a threshold for when you want to offer chat. You can keep checking this probability against that threshold to see if you want to popup a chat window.\n\nThis example shows you how you can use predictive analytics in real time to decide whether a prospect has high propensity to convert and offer him a chat with a sales rep\/agent.","7063e47a":"## Build Model and Check Accuracy","f4d32dc0":" #  <p style=\"text-align: center;\">Predicting Prospect Propensity (EDA and MODEL)<\/p> ","2493782b":"### Perform Correlation Analysis"}}