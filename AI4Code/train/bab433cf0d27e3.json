{"cell_type":{"39fb9b6a":"code","736ac120":"code","78eea835":"code","5df8b716":"code","11b44e05":"code","7a8edc18":"code","bdfb65a2":"code","a7a118b1":"code","e1785ff5":"code","fd0c82e2":"code","3eaf7c38":"code","7e8517c1":"code","d689af40":"code","bf4ea12b":"code","62b25277":"code","54d496b1":"code","155b2364":"code","058eb2f3":"code","dff084ff":"code","485ff553":"code","fb4be29b":"code","083601d8":"code","0932f821":"code","81662178":"code","7c9289d6":"code","431ab342":"code","22daf061":"code","b5955abf":"code","2ebb48bb":"code","91fa3cf1":"code","130e0169":"code","c7bf30a7":"code","ce689e87":"code","7526d5e4":"code","b60fd435":"code","d8721f9c":"code","e9f23c7f":"code","955ff404":"code","cc4322ea":"code","13d219dd":"code","bcb14dad":"code","5475a9c9":"code","ca3c1545":"code","c2627778":"code","6bab5874":"code","aa24f998":"code","736b3fa7":"code","171ee159":"code","ee2e9deb":"code","bb7b4964":"code","5ddddf38":"code","f06e9e42":"code","b289123d":"code","ad52da2b":"code","f4d833de":"code","13c1e54d":"code","e55775c2":"code","faf4f7e1":"code","fed8fc4c":"code","18fcac42":"code","912386b7":"code","9dcf7923":"markdown","7522bfcd":"markdown","5710afd4":"markdown","a277c09c":"markdown","3ac52c5f":"markdown","f6940d32":"markdown","cf74efa0":"markdown","0b81f0bd":"markdown","328b8632":"markdown","14aace88":"markdown","c190e2d6":"markdown","0fca8fbb":"markdown","13cc912b":"markdown","9f93dddf":"markdown","a826d75a":"markdown"},"source":{"39fb9b6a":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","736ac120":"Train= pd.read_csv('..\/input\/titanic\/train.csv')\nTest= pd.read_csv('..\/input\/titanic\/test.csv')","78eea835":"Train.head()","5df8b716":"Train.info()","11b44e05":"Train.shape","7a8edc18":"Train.describe()","bdfb65a2":"sns.pairplot(Train, hue='Survived')","a7a118b1":"sns.heatmap(Train.corr(), annot=True, cmap=\"PiYG\")","e1785ff5":"Train.head()","fd0c82e2":"Train= Train.drop('Name', axis=1)","3eaf7c38":"(Train.isnull().sum()\/len (Train))*100","7e8517c1":"def missing_percent (Train):\n    nan_percent= (Train.isnull().sum()\/len (Train))*100\n    nan_percent= nan_percent[nan_percent>0].sort_values()\n    return nan_percent","d689af40":"nan_percent= missing_percent(Train)","bf4ea12b":"nan_percent","62b25277":"plt.figure(figsize=(12, 6))\nsns.barplot(x= nan_percent.index, y= nan_percent)\nplt.xticks(rotation=90)","54d496b1":"plt.figure(figsize=(12, 6))\nsns.barplot(x= nan_percent.index, y= nan_percent)\nplt.xticks(rotation=90)\nplt.ylim(0, 1)","155b2364":"Train[Train['Embarked'].isnull()]","058eb2f3":"Train= Train.dropna(subset=['Embarked'], axis=0)","dff084ff":"nan_percent= missing_percent(Train)\n\nplt.figure(figsize=(12, 6))\nsns.barplot(x= nan_percent.index, y= nan_percent)\nplt.xticks(rotation=90)\nplt.ylim(0, 1)","485ff553":"Train.drop(\"Cabin\", axis = 1, inplace = True)","fb4be29b":"Train[\"Age\"].fillna(Train[\"Age\"].mean(), inplace = True)","083601d8":"Train['Sex']=Train['Sex'].replace({'male':0,'female':1})","0932f821":"Train.drop(['PassengerId', 'Fare', 'Ticket','Embarked'], axis = 1, inplace = True)","81662178":"Train.isnull().sum()","7c9289d6":"X= Train.drop('Survived', axis=1)\ny= Train['Survived']","431ab342":"from sklearn.model_selection import train_test_split","22daf061":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=101)","b5955abf":"from sklearn.preprocessing import StandardScaler","2ebb48bb":"scaler= StandardScaler()","91fa3cf1":"scaler.fit(X_train)","130e0169":"scaled_X_train= scaler.transform(X_train)\nscaled_X_test= scaler.transform(X_test)","c7bf30a7":"from sklearn.neighbors import KNeighborsClassifier","ce689e87":"Knn_model= KNeighborsClassifier(n_neighbors=1)","7526d5e4":"Knn_model.fit(scaled_X_train, y_train)","b60fd435":"y_pred_test= Knn_model.predict(scaled_X_test)","d8721f9c":"pd.DataFrame({'Y_Test': y_test, 'Y_Pred': y_pred})","e9f23c7f":"from sklearn.metrics import confusion_matrix, accuracy_score, classification_report","955ff404":"accuracy_score(y_test, y_pred)","cc4322ea":"confusion_matrix(y_test, y_pred)","13d219dd":"print(classification_report(y_test, y_pred))","bcb14dad":"test_error_rate=[]\n\nfor K in range (1, 30):\n    Knn_model= KNeighborsClassifier(n_neighbors=1)\n    Knn_model.fit(scaled_X_train, y_train)\n    \n    y_pred_test= Knn_model.predict(scaled_X_test)\n    \n    test_error= 1-accuracy_score(y_test, y_pred_test)\n    test_error_rate.append(test_error)","5475a9c9":"test_error_rate","ca3c1545":"plt.figure(figsize=(10, 6))\nplt.plot(range(1, 30), test_error_rate, label='Test_Error')\nplt.legend()\nplt.xlabel('K Value')\nplt.ylabel('Error Rate')","c2627778":"scaler= StandardScaler()","6bab5874":"knn= KNeighborsClassifier()","aa24f998":"operations=[('scaler', scaler), ('knn', knn)]","736b3fa7":"from sklearn.pipeline import Pipeline","171ee159":"pipe= Pipeline(operations)","ee2e9deb":"from sklearn.model_selection import GridSearchCV","bb7b4964":"k_values= list(range(1, 20))","5ddddf38":"param_grid={'knn__n_neighbors': k_values}","f06e9e42":"full_cv_classifier= GridSearchCV(pipe, param_grid, cv=5, scoring='accuracy')","b289123d":"full_cv_classifier.fit(X_train, y_train)","ad52da2b":"full_cv_classifier.best_estimator_.get_params()","f4d833de":"scaler= StandardScaler()","13c1e54d":"knn14= KNeighborsClassifier(n_neighbors=14)","e55775c2":"operations= (('scaler', scaler), ('knn14', knn14))","faf4f7e1":"pipe= Pipeline(operations)","fed8fc4c":"pipe.fit(X_train, y_train)","18fcac42":"pipe_pred= pipe.predict(X_test)","912386b7":"print(classification_report(y_test, pipe_pred))","9dcf7923":"# **Scalling the Features**","7522bfcd":"# **FEATURE & LABEL**","5710afd4":"# **EVALUATING THE MODEL**","a277c09c":"# **FINAL MODEL**","3ac52c5f":"# **DATA PREPARATION**","f6940d32":"# **EDA**","cf74efa0":"# **DATA OVERVIEW**","0b81f0bd":"# **PREDICTING TEST DATA**","328b8632":"# **OPTIMUM K**","14aace88":"# **MODELING**","c190e2d6":"# **IMPORT LIBRARIES**","0fca8fbb":"# **TRAIN & TEST**","13cc912b":"# **#1 Elbow Method**","9f93dddf":"# **#2 Cross Validation & Grid Search & Pipeline**","a826d75a":"# **IMPORT DATASET**"}}