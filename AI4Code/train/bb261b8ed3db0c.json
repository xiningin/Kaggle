{"cell_type":{"18878024":"code","94704b25":"code","72df694a":"code","f7afcb22":"code","2ac469b8":"code","73e38999":"code","95233439":"code","7399ee49":"code","846df099":"markdown","68c45a1c":"markdown","feabdac8":"markdown","2388354c":"markdown","745d6ef8":"markdown","918316c9":"markdown","39018442":"markdown","da47b401":"markdown","6a0b1293":"markdown"},"source":{"18878024":"import numpy as np\nimport pandas as pd\nimport h2o\nfrom h2o.automl import H2OAutoML","94704b25":"from h2o.automl import H2OAutoML\nh2o.init()","72df694a":"train = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ntest = pd.read_csv('..\/input\/titanic\/test.csv')\nsubs = pd.read_csv('..\/input\/titanic\/gender_submission.csv')\n\ndrop_elements = ['PassengerId', 'Name', 'Ticket', 'Cabin', 'SibSp','Parch']\ntrain = train.drop(drop_elements, axis = 1)\ntest = test.drop(drop_elements, axis = 1)\n\ndef checkNull_fillData(df):\n    for col in df.columns:\n        if len(df.loc[df[col].isnull() == True]) != 0:\n            if df[col].dtype == \"float64\" or df[col].dtype == \"int64\":\n                df.loc[df[col].isnull() == True,col] = df[col].mean()\n            else:\n                df.loc[df[col].isnull() == True,col] = df[col].mode()[0]\n                \ncheckNull_fillData(train)\ncheckNull_fillData(test)\n\nstr_list = [] \nnum_list = []\nfor colname, colvalue in train.iteritems():\n    if type(colvalue[1]) == str:\n        str_list.append(colname)\n    else:\n        num_list.append(colname)\n        \ntrain = pd.get_dummies(train, columns=str_list)\ntest = pd.get_dummies(test, columns=str_list)\n\ntrain = h2o.H2OFrame(train)\ntest = h2o.H2OFrame(test)","f7afcb22":"train.describe()","2ac469b8":"MAX_RUNTIME = 1800 #30 mins\nRANDOM_SEED = 12 \n\ny = \"Survived\"\ntrain[y] = train[y].asfactor()\nx = train.columns\nx.remove(y)","73e38999":"aml = H2OAutoML(seed = RANDOM_SEED , max_runtime_secs=MAX_RUNTIME)\naml.train(x = x, y = y, training_frame = train)","95233439":"lb = aml.leaderboard\nlb.head(10)","7399ee49":"preds = aml.leader.predict(test)\nsub = preds[0].as_data_frame()  ## Converting to dataframe\nsubs['Survived'] = sub\nsubs.to_csv('h20.ai-automl.csv',index = False)","846df099":"# Data Loading and Preprocessing","68c45a1c":"# Imports","feabdac8":"# Initializing H20 Cluster","2388354c":"### Top 10 models","745d6ef8":"# <center> \ud83e\udd16H2O.AI AUTOML CLASSIFICATION - TITANIC<\/center>\n## <center>If you find this notebook useful, support with an upvote\ud83d\udc4d<\/center>","918316c9":"# AutoML","39018442":"**Created by Sanskar Hasija**\n\n**\ud83e\udd16H2O.ai AutoML Classification - Titanic**\n\n**15 NOVEMBER 2021**\n","da47b401":"# Results Leaderboard","6a0b1293":"### Submission"}}