{"cell_type":{"1f0de05a":"code","f1e5802c":"code","ec03fc6d":"code","7d82f750":"code","1b8ff553":"code","881fc740":"code","9ebb624a":"code","6909e8ea":"code","ce892588":"code","cfa0a68e":"code","f053e47c":"code","ffb3451f":"code","fd895add":"code","4609cd99":"code","0cd1d9f8":"code","9b66ed0f":"code","8bf4ead7":"code","d2c0e602":"code","31eb9159":"code","a1d0a313":"code","419bef30":"code","67f49f3e":"code","605fae10":"code","e303c035":"markdown","f9c1a470":"markdown","18ef1a0d":"markdown","6b94898d":"markdown","43a1c704":"markdown","5e2d4c06":"markdown","0d44a73e":"markdown","7a333ff3":"markdown","f3386bba":"markdown","6d64842f":"markdown","35e5496b":"markdown","1628c7db":"markdown","54014f8d":"markdown","6cfe42b3":"markdown","789536d0":"markdown"},"source":{"1f0de05a":"import pandas as pd\ndf_tmdb = pd.read_csv('..\/input\/tmdb-movies.csv')#\u52a0\u8f7d\u6570\u636e\u96c6\ndf_tmdb.head()#\u67e5\u770b\u6570\u636e\u524d\u4e94\u884c","f1e5802c":"# \u5bf9\u8ba1\u5212\u4f7f\u7528\u7684\u6240\u6709\u6570\u636e\u5305\u8fdb\u884c\u8bbe\u7f6e\n#   \u5bfc\u5165\u8bed\u53e5\u3002\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style('whitegrid')\n% matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')","ec03fc6d":"# \u52a0\u8f7d\u6570\u636e\u5e76\u68c0\u67e5\u6570\u636e\u7c7b\u578b\uff0c\u67e5\u770b\u662f\u5426\u6709\u7f3a\u5931\u6570\u636e\u6216\u9519\u8bef\u6570\u636e\u7684\u60c5\u51b5\u3002\ndf_tmdb = pd.read_csv('..\/input\/tmdb-movies.csv')\ndf_tmdb.info()","7d82f750":"#\u67e5\u770b\u6bcf\u5217\u7684\u7d22\u5f15\u53f7\u548c\u6807\u7b7e\nfor i,v in enumerate(df_tmdb.columns):\n    print(i,v)","1b8ff553":"#\u4f7f\u7528.iloc\u6765\u9009\u62e9\u90e8\u5206\u5217\nmovies_df = df_tmdb.iloc[:,np.r_[3:6,13,15:19]]\nmovies_df.head(2)","881fc740":"#\u67e5\u770b\u91cd\u590d\u9879\nsum(movies_df.duplicated())","9ebb624a":"#\u5220\u9664\u91cd\u590d\u9879\nmovies_df.drop_duplicates(inplace = True)","6909e8ea":"rows,col = movies_df.shape\nprint('\u8be5\u6570\u636e\u96c6\u4e2d\u5171\u6709{}\u90e8\u7535\u5f71\uff0c\u5171\u6709{}\u4e2a\u7279\u5f81\u5217\u3002'.format(rows - 1,col))","ce892588":"# \u5224\u65ad\u54ea\u4e9b\u5217\u6709\u7f3a\u5931\u503c,\u6709\u7f3a\u5931\u503c\u7684\u5217\u5c06\u8fd4\u56deTrue\nmovies_df.isnull().any()","cfa0a68e":"#\u76f4\u63a5\u5220\u9664\u6709\u7a7a\u503c\u7684\u884c\nmovies_df.dropna(subset = ['genres'],inplace = True)","f053e47c":"rows,col = movies_df.shape\nprint('\u7ecf\u8fc7\u6e05\u7406\u540e\uff0c\u603b\u5171\u4fdd\u7559\u4e86{}\u90e8\u7535\u5f71\u3002'.format(rows - 1))","ffb3451f":"movies_df.dtypes","fd895add":"#\u5c06'release_date'\u5217\u8f6c\u6362\u4e3adate\u683c\u5f0f\nmovies_df.release_date = pd.to_datetime(movies_df['release_date'])","4609cd99":"movie_high = movies_df.query('vote_average >= 7.5 and vote_count >= 1000')#\u7b5b\u9009\u51fa\u8bc4\u4ef77.5\u5206\u53ca\u4ee5\u4e0a\uff0c\u8bc4\u4ef7\u4eba\u6570\u8d85\u8fc71000\u4eba\u7684\u7535\u5f71\nmovie_high.head()","0cd1d9f8":"genre_name = set() #\u521b\u5efa\u4e00\u4e2a\u53bb\u91cd\u6846\n#\u904d\u5386\u51fa\u7535\u5f71\u7684\u7c7b\u522b\u96c6\u5408\nfor x in movie_high['genres']:\n    genre_name.update(x.split('|'))\ngenre_name","9b66ed0f":"genres_df = pd.DataFrame()#\u521b\u5efa\u65b0\u6570\u636e\u6846\n#\u5bf9\u5404\u7535\u5f71\u7c7b\u578b\u8fdb\u884cone_hot\u7f16\u7801\uff0c\u5305\u542b\u5219\u7f16\u7801\u4e3a1\uff0c\u4e0d\u5305\u542b\u5219\u4e3a0\n#\u53c2\u8003https:\/\/blog.csdn.net\/tengyuan93\/article\/details\/78930285\nfor gen in genre_name:\n    genres_df[gen] = movie_high['genres'].str.contains(gen).map(lambda x:1 if x else 0)\ngenres_df.head()","8bf4ead7":"genresum = genres_df.sum().sort_values(ascending = False)#\u52a0\u5408\u6240\u6709\u7684\u7535\u5f71\u7c7b\u522b\u5e76\u6309\u5012\u5e8f\u6392\u5217\n#\u7ed8\u5236\u67f1\u5f62\u56fe\ngenresum.plot(kind = 'bar');\nplt.title('Genres of High Score Film',fontsize = 15)\nplt.xlabel('genres',fontsize = 12)\nplt.ylabel('count',fontsize  = 12);","d2c0e602":"movies_df.head(2)","31eb9159":"#\u63d0\u53d6\u6708\u4efd\u5e76\u521b\u5efa\u4e00\u4e2a\u65b0\u5217\nmovies_df['month'] = movies_df['release_date'].dt.month\nmovies_df.head(2)","a1d0a313":"month_release = movies_df.groupby(['month']).count()#\u6309\u6708\u4efd\u8fdb\u884c\u5206\u7ec4\u8ba1\u7b97\u6bcf\u6708\u4e0a\u6620\u7535\u5f71\u603b\u6570","419bef30":"month_release['count'] = month_release['budget']\n#\u7ed8\u5236\u6bcf\u6708\u4e0a\u6620\u7535\u5f71\u6570\u91cf\u67f1\u5f62\u56fe\nmonth_name = ['Jan','Feb','Mar','Apr','May','June','July','Aug','Sept','Oct','Nav','Dec']\nplt.plot(month_name,month_release['count'].values,marker = 'o');\nplt.title('Numbers of Film Released in each Month',fontsize = 15)\nplt.xlabel('Month',fontsize = 12)\nplt.ylabel('count',fontsize = 12);","67f49f3e":"month_revenue = movies_df.groupby(['month'])['revenue'].sum()#\u6309\u6708\u4efd\u8fdb\u884c\u5206\u7ec4\u5bf9\u7968\u623f\u6536\u5165\u8fdb\u884c\u52a0\u548c","605fae10":"fig = plt.figure()\nax1 = fig.add_subplot(111)\nax1.plot(month_name,month_release['count'].values,marker = 'o',color = 'red');\nax1.set_ylabel('count',fontsize = 12)\nax1.set_xlabel('month',fontsize = 12)\nplt.legend('count')\nax2 = ax1.twinx()#\u5c06\u4e0a\u6620\u7535\u5f71\u6570\u56fe\u4e0e\u7968\u623f\u6536\u5165\u56fe\u5408\u5e76\u5448\u73b0\nplt.bar(month_name,month_revenue.values,alpha = 0.4);\nax2.set_ylabel('revenue',fontsize = 12)\nplt.title('Quanlity and Revenue in Each Month',fontsize = 15);\nsns.set_style('dark')","e303c035":"<a id='conclusions'><\/a>\n## \u7ed3\u8bba\n\n#### \u7ed3\u8bba1\uff1a\u4ece\u8be5\u6570\u636e\u96c6\u6765\u770b\uff0c\u9ad8\u5206\u7535\u5f71\uff08\u8bc4\u52067.5\u5206\u53ca\u4ee5\u4e0a\uff09\u5e38\u5e38\u6765\u81ea\u5267\u60c5(Drama)\u3001\u60ca\u609a(Thriller)\u3001\u52a8\u4f5c(Action)\u7b49\u7c7b\u578b\u7684\u7535\u5f71\uff1b\n\n#### \u7ed3\u8bba2\uff1a\u4ece\u8be5\u6570\u636e\u96c6\u6765\u770b\uff0c9\u300110\u6708\u4efd\u4e0a\u6620\u7684\u7535\u5f71\u662f\u6700\u591a\u7684\uff0c\u4f46\u7968\u623f\u6536\u5165\u8868\u73b0\u5e73\u5eb8\uff1b\u7968\u623f\u6536\u5165\u9ad8\u7684\u51e0\u4e2a\u6708\u4efd\u57285\u30016\u30017\u6708\u53ca11\u300112\u6708\uff0c\u7535\u5f71\u5546\u53ef\u66f4\u591a\u8003\u8651\u5728\u8fd9\u51e0\u4e2a\u6708\u4efd\u6392\u7247\u4e0a\u6620\uff0c\u5982\u679c\u60f3\u8981\u907f\u5f00\u8282\u65e5\u6863\u649e\u8f66\uff0c\u90a3\u4e48\u57285\u30016\u30017\u6708\u4e0a\u6620\u7535\u5f71\u662f\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\u3002","f9c1a470":"\u4ece\u4e0a\u56fe\u53ef\u4ee5\u770b\u5230\uff0c\u867d\u71369\u300110\u6708\u4efd\u4e0a\u6620\u7684\u7535\u5f71\u6570\u6700\u591a\uff0c\u4f46\u7968\u623f\u6536\u5165\u8868\u73b0\u5e73\u5eb8\uff1b5\u30016\u30017\u6708\u4e0a\u6620\u7684\u7535\u5f71\u867d\u4e0d\u7b97\u591a\uff0c\u5374\u975e\u5e38\u5356\u5ea7\uff1b\u800c\u4ece11\u6708\u523012\u6708\u4efd\u671f\u95f4\uff0c\u4f3c\u4e4e\u53d7\u8282\u65e5\u6c14\u6c1b\uff0811\u6708\u611f\u6069\u8282\u300112\u6708\u5723\u8bde\u6708\uff09\u5f71\u54cd\uff0c\u7535\u5f71\u4e0a\u6620\u6570\u53ca\u7968\u623f\u540c\u65f6\u62ac\u5347\u3002","18ef1a0d":"\u2460\u7279\u5f81\u9009\u62e9\u3002\u57fa\u4e8e\u6211\u4eec\u8981\u8ba8\u8bba\u7684\u95ee\u9898\uff0c\u9009\u62e9\u6240\u9700\u7279\u5f81\u5217\u3002","6b94898d":"\u4ece\u4e0a\u56fe\u53ef\u4ee5\u770b\u5230\u7535\u5f71\u5546\u96c6\u4e2d\u6392\u7247\u4e0a\u6620\u57288\u30019\u300110\u6708\u4efd\uff0c9\u6708\u4efd\u8fbe\u5230\u5cf0\u503c\uff0c\u4e0a\u6620\u7684\u7535\u5f71\u6700\u591a\uff0c\u5176\u6b21\u662f10\u6708\uff1b2\u6708\u4efd\u4e0a\u6620\u7684\u7535\u5f71\u6570\u6700\u5c11\u3002","43a1c704":"> \u73b0\u5728\u8ba9\u6211\u4eec\u6765\u5f00\u59cb\u7814\u7a76\u7b2c\u4e8c\u4e2a\u95ee\u9898\u3002\n\n### Q2\uff1a\u54ea\u4e2a\u6708\u4e0a\u6620\u7684\u7535\u5f71\u6700\u591a\uff1f\u54ea\u4e2a\u6708\u7535\u5f71\u603b\u7968\u623f\u6700\u9ad8\uff1f","5e2d4c06":"> \u73b0\u5728\u8ba9\u6211\u4eec\u6765\u5f00\u59cb\u7814\u7a76\u7b2c\u4e00\u4e2a\u95ee\u9898\u3002\n\n### Q1\uff1a\u9ad8\u5206\u7535\u5f71\uff08\u8bc4\u4ef77.5\u5206\u53ca\u4ee5\u4e0a\uff0c\u8bc4\u4ef7\u4eba\u6570\u8d85\u8fc71000\uff09\u7684\u4e3b\u8981\u7c7b\u522b\u6709\u54ea\u4e9b\uff1f","0d44a73e":"\u2462\u6570\u636e\u7c7b\u578b\u8f6c\u6362","7a333ff3":"\n### \u6570\u636e\u6e05\u7406","f3386bba":"\u4ece\u4e0a\u56fe\u53ef\u4ee5\u770b\u5230\uff0cDrama\uff08\u5267\u60c5\uff09\u7c7b\u522b\u7684\u7535\u5f71\u5728\u9ad8\u5206\u7535\u5f71\u4e2d\u51fa\u73b0\u6b21\u6570\u6700\u591a\uff0c\u5176\u6b21\u662fAction\uff08\u52a8\u4f5c\uff09\u548cThriller\uff08\u60ca\u609a\uff09\u7c7b\u522b\u7684\u7535\u5f71\u3002","6d64842f":"<a id='eda'><\/a>\n## \u63a2\u7d22\u6027\u6570\u636e\u5206\u6790","35e5496b":"\n\n# TMDB\u7535\u5f71\u6570\u636e\u5206\u6790\n\n## \u76ee\u5f55\n<ul>\n<li><a href=\"#intro\">\u7b80\u4ecb<\/a><\/li>\n<li><a href=\"#wrangling\">\u6570\u636e\u6574\u7406<\/a><\/li>\n<li><a href=\"#eda\">\u63a2\u7d22\u6027\u6570\u636e\u5206\u6790<\/a><\/li>\n<li><a href=\"#conclusions\">\u7ed3\u8bba<\/a><\/li>\n<\/ul>\n\n<a id='intro'><\/a>\n## \u7b80\u4ecb\n\n> \u672c\u6570\u636e\u96c6\u4e2d\u5305\u542b 1 \u4e07\u6761\u7535\u5f71\u4fe1\u606f\uff0c\u4fe1\u606f\u6765\u6e90\u4e3a\u201c\u7535\u5f71\u6570\u636e\u5e93\u201d\uff08TMDb\uff0cThe Movie Database\uff09\uff0c\u5305\u62ec\u4e0a\u6620\u65f6\u95f4(release date)\u3001\u7535\u5f71\u7c7b\u522b(genres)\u3001\u7528\u6237\u8bc4\u5206(vote average)\u3001\u7968\u623f(revenue)\u7b49\u3002\n\n> \u6211\u4eec\u6765\u7b80\u5355\u770b\u4e00\u4e0b\u8fd9\u4e2a\u6570\u636e\u96c6...","1628c7db":"> \u4e0b\u9762\u6211\u4eec\u5c31\u4ee5\u4e0b\u51e0\u4e2a\u95ee\u9898\u5bf9\u8be5\u6570\u636e\u96c6\u8fdb\u884c\u63a2\u7d22\uff1a\n\n#### 1\u3001\u9ad8\u5206\u7535\u5f71\uff08\u8bc4\u4ef77.5\u5206\u53ca\u4ee5\u4e0a\uff0c\u8bc4\u4ef7\u4eba\u6570\u8d85\u8fc71000\uff09\u7684\u4e3b\u8981\u7c7b\u522b\u6709\u54ea\u4e9b\uff1f\n\n\n#### 2\u3001\u54ea\u4e2a\u6708\u4e0a\u6620\u7684\u7535\u5f71\u6700\u591a\uff1f\u54ea\u4e2a\u6708\u7968\u623f\u6536\u5165\u6700\u9ad8\uff1f","54014f8d":"<a id='wrangling'><\/a>\n## \u6570\u636e\u6574\u7406\n\n> \u5728\u62a5\u544a\u7684\u8fd9\u4e00\u90e8\u5206\u4e2d\u8f7d\u5165\u6570\u636e\uff0c\u68c0\u67e5\u7b80\u6d01\u5ea6\uff0c\u7136\u540e\u6574\u7406\u548c\u6e05\u7406\u6570\u636e\u96c6\uff0c\u4ee5\u4fbf\u8fdb\u884c\u5206\u6790\u3002\n\n### \u5e38\u89c4\u5c5e\u6027","6cfe42b3":"\u2461\u67e5\u770b\u5e76\u5904\u7406\u91cd\u590d\u9879\u53ca\u5305\u542b\u7a7a\u503c\u7684\u884c\u3002","789536d0":"> \u6ce8\uff1a\u6570\u636e\u54c1\u8d28\u53ca\u6570\u636e\u6e05\u6d17\u5bf9\u5206\u6790\u7ed3\u679c\u53ef\u80fd\u4ea7\u751f\u5f71\u54cd\uff0c\u6570\u636e\u6837\u672c\u6765\u81eaTMDb\uff0c\u4ee3\u8868\u610f\u4e49\u6709\u5f85\u8003\u7a76\uff0c\u8be5\u7ed3\u8bba\u4ec5\u4e3a\u8bd5\u63a2\u6027\uff0c\u53ef\u80fd\u9700\u8981\u8fdb\u4e00\u6b65\u6539\u8fdb\u3002"}}