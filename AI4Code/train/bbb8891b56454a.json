{"cell_type":{"8f5ae57f":"code","6992199a":"code","f4548be9":"code","c27f4e5f":"code","db2531fb":"code","0a85278d":"code","3c93bd92":"code","baa18f87":"code","929e78c7":"code","d13329be":"code","569b3c36":"code","0f6c826d":"code","ea4ecee6":"code","3bc2fed4":"code","b0bb5519":"code","d801da4f":"markdown","85a14b95":"markdown","77f0755c":"markdown","6a2f2c2b":"markdown","916f98dd":"markdown","8559f9e1":"markdown"},"source":{"8f5ae57f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.metrics import r2_score\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","6992199a":"df = pd.read_csv('..\/input\/column_2C_weka.csv')","f4548be9":"#First 5 row\ndf.head()","c27f4e5f":"#Summary of data\ndf.info()","db2531fb":"distrubution = df['class'].value_counts()","0a85278d":"distrubution.plot(kind='pie',explode=(0, 0.1),autopct='%1.1f%%')\nplt.show()","3c93bd92":"sns.pairplot(df, hue='class', markers=[\"o\", \"s\"], diag_kind=\"kde\")\nsns.set_palette(sns.color_palette(\"Set1\"))\nsns.set(font_scale=1.3)\nplt.show()","baa18f87":"# Linear Regression Work\n# Feature : pelvic_incidence, Target: sacral_slope\n\ndata_abnormal = df[df['class'] == 'Abnormal']\nplt.scatter(data_abnormal.pelvic_incidence,data_abnormal.sacral_slope, color='m')\n\nplt.title('Sacral Slope Changes with Pelvic Incidence')\nplt.xlabel('Pelvic Incidence')\nplt.ylabel('Sacral Slope')\nplt.show()","929e78c7":"from sklearn import linear_model\n\n#linear regression model\nlinear_reg = linear_model.LinearRegression()\n\n#Seperate data to train and test\n#Assume first 100 data is train data and the other part is test data\n\nx_train = data_abnormal.pelvic_incidence[:100].values.reshape(-1,1)\ny_train = data_abnormal.sacral_slope[:100].values.reshape(-1,1)\n\nlinear_reg.fit(x_train, y_train)","d13329be":"#%% Prediction with last 100 data\ny_head = linear_reg.predict(data_abnormal.pelvic_incidence[100:].values.reshape(-1,1))\ny_test = data_abnormal.sacral_slope[100:].values.reshape(-1,1)\n\nprint('r2_score: ',r2_score(y_test, y_head))","569b3c36":"x_test = data_abnormal.pelvic_incidence[100:].values.reshape(-1,1)\n\nplt.plot(x_test, y_head, color='black', linewidth=3)\nplt.scatter(x_train,y_train)\nplt.xlabel('pelvic_incidence')\nplt.ylabel('sacral_slope')\nplt.show()","0f6c826d":"#linear regression model\nlinear_reg = linear_model.LinearRegression()\n\n#This time we use all data for training and testing\n\nx_train = data_abnormal.pelvic_incidence.values.reshape(-1,1)\ny_train = data_abnormal.sacral_slope.values.reshape(-1,1)\n\nlinear_reg.fit(x_train, y_train)","ea4ecee6":"#%% Prediction with all data\ny_head = linear_reg.predict(data_abnormal.pelvic_incidence.values.reshape(-1,1))","3bc2fed4":"y_test = data_abnormal.sacral_slope.values.reshape(-1,1)\nprint('r2_score: ',r2_score(y_test, y_head))","b0bb5519":"x_test = data_abnormal.pelvic_incidence.values.reshape(-1,1)\n\nplt.plot(x_test, y_head, color='black', linewidth=3)\nplt.scatter(x_train,y_train)\nplt.xlabel('pelvic_incidence')\nplt.ylabel('sacral_slope')\nplt.show()","d801da4f":"We will do linear regression with two scenario;\n\nFirst take the first 100 data for train and last 100 for test ans see the result\n\nThen we will use whole data for train and test","85a14b95":"Linear Regression","77f0755c":"We can see from the graph the error is so high for most of the point. ","6a2f2c2b":"r2_score is higher than the other model which means we have a better model.","916f98dd":"Graphs show us the distrubution of the symptoms in cases for Normal and Abnormal person.\n\nIn most cases it is hard to seperate \"Normal\" and \"Abnormal\" person data.","8559f9e1":"r2_score for this model is 0.300."}}