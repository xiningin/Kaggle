{"cell_type":{"b4c98d11":"code","e2efe291":"code","3ffda57e":"code","50daafbd":"code","e4c49cae":"code","80c47849":"code","1b680616":"code","ce93065d":"code","39e719e0":"code","ef9f7fb8":"code","d2ad1819":"code","85dc1905":"code","b1bf91fb":"code","14fb3bdb":"code","98372052":"code","bbf92aad":"code","842c5dbc":"markdown","e182816b":"markdown","57f129ff":"markdown","299ff82c":"markdown","29e05372":"markdown","2d226495":"markdown","a507c98d":"markdown","cd7c1b10":"markdown","16f4d922":"markdown","3f5bc197":"markdown","b905b4b4":"markdown","70895d1c":"markdown"},"source":{"b4c98d11":"import numpy as np\nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.graph_objs as go\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot\n\ninit_notebook_mode(connected=True) \n\nimport pandas_profiling as pp\nimport plotly.express as px","e2efe291":"df_train = pd.read_csv('\/kaggle\/input\/bigquery-geotab-intersection-congestion\/train.csv')\ndf_test =  pd.read_csv('\/kaggle\/input\/bigquery-geotab-intersection-congestion\/test.csv')","3ffda57e":"df_train.head()","50daafbd":"df_train.describe().T","e4c49cae":"print(\"Train dataset shape: \"+ str(df_train.shape))\nprint(\"Test dataset shape:  \"+ str(df_test.shape))","80c47849":"f,ax = plt.subplots(figsize=(10,8))\nsns.heatmap(df_train.iloc[:,12:].corr(),annot=True, linewidths=.5, fmt='.1f', ax=ax)\n\nplt.show()","1b680616":"train_cities = df_train.iloc[:,-1].value_counts()\ntest_cities = df_test.iloc[:,-1].value_counts()\n\nf,ax=plt.subplots(1,2,figsize=(13,6))\ntrain_cities.plot(ax=ax[0],color='crimson', kind='bar')\nax[0].set_title('Train Dataset City Counts')\n\ntest_cities.plot(ax=ax[1],color='darkmagenta', kind='bar')\nax[1].set_title('Test Dataset City Counts')\n\nplt.show()","ce93065d":"Philadelphia = df_train[df_train.loc[:,\"City\"]=='Philadelphia']\nHours = [x for x in range(0,24)]\n\nWeekend = []\nWeekday = []\n\nfor i in Hours:\n    Weekend.append(\n        sum(Philadelphia[(Philadelphia[\"Hour\"]==i) & (Philadelphia[\"Weekend\"]== 1)][\"TotalTimeStopped_p80\"])\/\n        sum(Philadelphia[(Philadelphia[\"Hour\"]==i)][\"TotalTimeStopped_p80\"])*100)\n    Weekday.append(\n        sum(Philadelphia[(Philadelphia[\"Hour\"]==i) & (Philadelphia[\"Weekend\"]== 0)][\"TotalTimeStopped_p80\"])\/\n        sum(Philadelphia[(Philadelphia[\"Hour\"]==i)][\"TotalTimeStopped_p80\"])*100)\n\nf,ax = plt.subplots(figsize=(12,5))\nsns.barplot(x=Hours, y=Weekend, label='Weekend', color='r', alpha = 0.7)\nsns.barplot(x=Hours, y=Weekday, label='Weekday', color='b', alpha = 0.4)\n\nax.set(xlabel='Hour', ylabel='Percentage', title='In Terms Of \"Total Time Stopped\" Weekend Weekday Percentage In Philadelphia')\nax.legend(loc='upper right',frameon= True)\n\nplt.show()","39e719e0":"train_hours = df_train[\"Hour\"].value_counts()\ntrain_hours = train_hours.iloc[np.lexsort([train_hours.index])]\ntest_hours = df_test[\"Hour\"].value_counts()\ntest_hours = test_hours.iloc[np.lexsort([test_hours.index])]\n\nf,ax=plt.subplots(1,2,figsize=(13,5))\n\ntrain_hours.plot(ax=ax[0],color='sandybrown', kind='bar')\nax[0].set_title('Train Dataset Hour Distribution')\n\ntest_hours.plot(ax=ax[1],color='sienna', kind='bar')\nax[1].set_title('Test Dataset Hour Distribution')\n\nplt.show()","ef9f7fb8":"df_train[\"Month\"].value_counts()\nMonths = [1, 5, 6, 7, 8, 9, 10, 11, 12]\n\nWeekend = []\nWeekday = []\n\nfor i in Months:\n    Weekend.append(\n        sum(Philadelphia[(Philadelphia[\"Month\"]==i) & (Philadelphia[\"Weekend\"]== 1)][\"DistanceToFirstStop_p80\"])\/\n        sum(Philadelphia[(Philadelphia[\"Month\"]==i)][\"DistanceToFirstStop_p80\"])*100)\n    Weekday.append(\n        sum(Philadelphia[(Philadelphia[\"Month\"]==i) & (Philadelphia[\"Weekend\"]== 0)][\"DistanceToFirstStop_p80\"])\/\n        sum(Philadelphia[(Philadelphia[\"Month\"]==i)][\"DistanceToFirstStop_p80\"])*100)\n\nf,ax = plt.subplots(figsize=(7,4))\nsns.barplot(x=Months, y=Weekend, label='Weekend', color='crimson', alpha = 0.7)\nsns.barplot(x=Months, y=Weekday, label='Weekday', color='darkmagenta', alpha = 0.4)\n\nax.set(xlabel='Month', ylabel='Percentage', title='Distance To First Stop Distribution In Philadelphia (Wend\/Wday)')\nax.legend(loc='upper right',frameon= True)\n\nplt.show()","d2ad1819":"train_months = df_train[\"Month\"].value_counts()\ntrain_months = train_months.iloc[np.lexsort([train_months.index])]\ntest_months = df_test[\"Month\"].value_counts()\ntest_months = test_months.iloc[np.lexsort([test_months.index])]\n\nf,ax=plt.subplots(1,2,figsize=(12,5))\n\ntrain_months.plot(ax=ax[0],color='slateblue', kind='bar')\nax[0].set_title('Train Dataset Month Distribution')\n\ntest_months.plot(ax=ax[1],color='steelblue', kind='bar')\nax[1].set_title('Test Dataset Month Distribution')\n\nplt.show()","85dc1905":"train_months_1_5 = df_train[df_train[\"Month\"].isin([1,5])][\"Weekend\"].value_counts()\ntest_months_1_5 = df_test[df_test[\"Month\"].isin([1,5])][\"Weekend\"].value_counts()\n\n\nf,ax=plt.subplots(1,2,figsize=(7,4))\n\ntrain_months_1_5.plot(ax=ax[0],color='rosybrown', kind='bar')\ntest_months_1_5.plot(ax=ax[1],color='chocolate', kind='bar')\nplt.suptitle('1. and 5. Months Weekend Distribution (Train and Test Datasets)')\n\nplt.show()","b1bf91fb":"trace1 = go.Box(\n    y=Philadelphia[Philadelphia[\"Weekend\"]== 0][\"TimeFromFirstStop_p80\"],\n    name = 'Weekday',\n    marker = dict(color = 'rgb(0,145,119)')\n)\ntrace2 = go.Box(\n    y=Philadelphia[Philadelphia[\"Weekend\"]== 1][\"TimeFromFirstStop_p80\"],\n    name = 'Weekend',\n    marker = dict(color = 'rgb(255,111,145)')\n)\n\ndata = [trace1, trace2]\nlayout = dict(autosize=False, width=500,height=400, \n              title='Time From First Stop at Weekday and Weekend', \n              paper_bgcolor='rgb(243, 243, 243)', \n              plot_bgcolor='rgb(243, 243, 243)', \n              margin=dict(l=40,r=30,b=80,t=100,)\n             )\n\nfig = dict(data=data, layout=layout)\n\niplot(fig)","14fb3bdb":"trace1 = go.Box(\n    y=df_train[df_train[\"City\"]== \"Atlanta\"][\"TotalTimeStopped_p80\"],\n    name = 'Atlanta',\n    marker = dict(color = 'rgb(255,111,145)')\n)\ntrace2 = go.Box(\n    y=df_train[df_train[\"City\"]== \"Boston\"][\"TotalTimeStopped_p80\"],\n    name = 'Boston',\n    marker = dict(color = 'rgb(214,93,177)')\n)\ntrace3 = go.Box(\n    y=df_train[df_train[\"City\"]== \"Chicago\"][\"TotalTimeStopped_p80\"],\n    name = 'Chicago',\n    marker = dict(color = 'rgb(132,94,194)')\n)\ntrace4 = go.Box(\n    y=df_train[df_train[\"City\"]== \"Philadelphia\"][\"TotalTimeStopped_p80\"],\n    name = 'Philadelphia',\n    marker = dict(color = 'rgb(0,138,219)')\n)\n\ndata = [trace1, trace2, trace3, trace4]\nlayout = dict(autosize=False, width=800,height=600, \n              title='Comparison of City Congestion (Total Time Stopped)', \n              paper_bgcolor='rgb(243, 243, 243)', \n              plot_bgcolor='rgb(243, 243, 243)', \n              margin=dict(l=40,r=30,b=80,t=100,))\nfig = dict(data=data, layout=layout)\n\niplot(fig)","98372052":"\nTotalTimeStopped=df_train.groupby(['City','Latitude','Longitude'])['TotalTimeStopped_p80'].mean().reset_index()\n\nfig = px.scatter_mapbox(TotalTimeStopped[TotalTimeStopped[\"City\"]=='Boston'], \n                        lat=\"Latitude\", lon=\"Longitude\",\n                        size=\"TotalTimeStopped_p80\",\n                        size_max=12,\n                        color=\"TotalTimeStopped_p80\", \n                        color_continuous_scale=px.colors.sequential.\n                        Inferno, zoom=11\n                       )\n\nfig.update_layout(mapbox_style=\"stamen-terrain\")\nfig.update_layout(margin={\"r\":0,\"t\":0,\"l\":0,\"b\":0})\n\nfig.show()","bbf92aad":"fig = px.scatter_mapbox(TotalTimeStopped[TotalTimeStopped[\"City\"]=='Philadelphia'], \n                        lat=\"Latitude\", lon=\"Longitude\",\n                        size=\"TotalTimeStopped_p80\",\n                        size_max=12,\n                        color=\"TotalTimeStopped_p80\", \n                        color_continuous_scale=px.colors.sequential.\n                        Inferno, zoom=11\n                       )\n\nfig.update_layout(mapbox_style=\"stamen-terrain\")\nfig.update_layout(margin={\"r\":0,\"t\":0,\"l\":0,\"b\":0})\n\nfig.show()","842c5dbc":"<a id=\"4\"><\/a> <br>\n### 4. Ending","e182816b":"There are less data in the first and fifth months compared to other months. No data are available for the second, third and fourth months.  ","57f129ff":"There aren't any weekend data for the first and fifth months.","299ff82c":"<a id=\"2\"><\/a> <br>\n### 2. Exploratory Data Analysis (EDA)","29e05372":"As shown in the visual above, only at 1,2 and 3 am the weekend stopping time is more than the weekday stopping time.\n\nDistribution of the 24 hours is shown in the following visual.","2d226495":"**Content**\n1. [Importing Libraries And Loading Datasets](#1)\n1. [Exploratory Data Analysis (EDA)](#2)\n1. [Data Visualization](#3)\n1. [Ending](#4)","a507c98d":"In this section i'll take a look train and test datasets distribution to comprehend data.\n\nAs shown in the next visual train and test datasets have same dispersion on cities.","cd7c1b10":"<a id=\"1\"><\/a> <br>\n### 1. Importing Libraries And Loading Datasets","16f4d922":"The dataset includes intersection wait times and stopping distances with hour, month and weekend\/weekday discrepancy in 4 major US cities Philadelphia, Boston, Atlanta and Chicago. ","3f5bc197":"Weekend and weekday percentage of \"distance to first stop\" at months is shown in the above visual. But something is wrong in the first and fifth months. So i'll show the dispersion of first and fifth months in the following charts.","b905b4b4":"<a id=\"3\"><\/a> <br>\n### 3. Data Visualization","70895d1c":"#### To be continued... If you like the kernel, Please upvote."}}