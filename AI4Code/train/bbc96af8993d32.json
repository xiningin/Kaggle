{"cell_type":{"a985918a":"code","098bae33":"code","7198755d":"code","5aa2dd61":"code","69c7621d":"code","f00ee7e3":"code","98d97f3e":"code","9301cd62":"code","7b79fdb9":"code","0883197a":"code","d5847354":"code","5cf3e7c0":"code","afdce4fc":"code","319150ef":"code","17cc168d":"code","9e9decd9":"code","afcfbeb2":"code","261c28f9":"code","a4a19533":"code","eed43358":"code","c21ba505":"code","ed99815c":"code","bd30d326":"code","153fa9ec":"code","b9f8c3b4":"code","7a71e3f6":"code","71a0e1ac":"code","dad77478":"code","0c7e40fa":"code","4c23579d":"code","9983a611":"code","7881bd53":"code","961b3c82":"code","6b7e6cf8":"code","a0e8cfd3":"code","9fc91363":"code","4eb9bb90":"code","4e22bf7c":"code","626c58ce":"code","14a00ddc":"code","2635f062":"code","d30dece7":"code","6e535417":"code","17824e0f":"code","0ca31048":"code","e1819996":"code","7dda8643":"code","28b72ed8":"code","4482e3fc":"code","5d0adbb3":"code","75c53b32":"code","857fcae8":"code","00d1cf52":"code","9616931e":"code","614b49be":"code","f6c86396":"code","1090c539":"code","4794a584":"code","a6068a6f":"code","c91eebf5":"code","1386e1d3":"code","6b106a45":"code","4a94b2e5":"code","f179eb3c":"code","50276b99":"code","cc139197":"markdown","74ffab2b":"markdown","bcf9a27d":"markdown","2376526c":"markdown","9a703446":"markdown","7267fd70":"markdown","9f27d2a7":"markdown","371c71db":"markdown","5423b88e":"markdown","14ad5fa4":"markdown","4aa6201a":"markdown","9e238280":"markdown","17053735":"markdown","684c3ac3":"markdown","cc9583c0":"markdown","b8466bac":"markdown","9217d252":"markdown","763eda3f":"markdown","cd8990ed":"markdown","31cd00e3":"markdown","1d831e0e":"markdown","c9ad72b1":"markdown","7f891cd3":"markdown","066ba50e":"markdown","533c54dd":"markdown","fe725757":"markdown","c1266973":"markdown","8b9b7294":"markdown","b7cf83cd":"markdown","25de801e":"markdown","b5f07d4e":"markdown","35c783a2":"markdown","0adc77ef":"markdown","451793a7":"markdown","f35c2107":"markdown","d892c793":"markdown","6fdb6547":"markdown","d3181ebe":"markdown","0d48a81a":"markdown","84681b15":"markdown","e9d51478":"markdown","15dc170f":"markdown","14837a2a":"markdown","65a4209e":"markdown","838bdb86":"markdown","eb9ee201":"markdown","cf596eea":"markdown","28537a75":"markdown","b31228ac":"markdown","2b6d07c0":"markdown","d9ed1722":"markdown","316c9aae":"markdown","d477ee2d":"markdown","06628df4":"markdown","585bfb43":"markdown","93b75ae0":"markdown","be6ad067":"markdown","48b14d43":"markdown","b99ffb5c":"markdown","bd0e89a8":"markdown","66d60f77":"markdown","88acd087":"markdown","3632119c":"markdown","9e902dc4":"markdown","9328900a":"markdown"},"source":{"a985918a":"pip install tweepy","098bae33":"import os \nimport pandas as pd \nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport numpy as np \nimport requests as rt \nimport tweepy\nimport json ","7198755d":"#reading_data \ntwitter_archive_enhanced = pd.read_csv(\"..\/input\/weratedogs-twitter-archive\/twitter-archive-enhanced.csv\")","5aa2dd61":"#making file path or check for it \nfolder_name = 'image_predictions_file'\nif not os.path.exists(folder_name):\n    os.makedirs(folder_name)\n    \nurl = \"https:\/\/d17h27t6h515a5.cloudfront.net\/topher\/2017\/August\/599fd2ad_image-predictions\/image-predictions.tsv\"\nresponse = rt.get(url)","69c7621d":"#opening the file \nwith open(os.path.join(folder_name,\n                      url.split('\/')[-1]) , mode='wb') as file:\n    file.write(response.content)","f00ee7e3":"#reading file \nimage_predictions = pd.read_csv('..\/input\/weratedogs-twitter-archive\/image_predictions.tsv' , sep = \"\\t\")","98d97f3e":"# This cell need to API information , so we don't use it here know (Don't run this cell )\n# we used data from this API as json file instead . \n\"\"\"\"\nimport tweepy\nfrom tweepy import OAuthHandler\nimport json\nfrom timeit import default_timer as timer\n\n# Query Twitter API for each tweet in the Twitter archive and save JSON in a text file\n# These are hidden to comply with Twitter's API terms and conditions\nconsumer_key = 'HIDDEN'\nconsumer_secret = 'HIDDEN'\naccess_token = 'HIDDEN'\naccess_secret = 'HIDDEN'\n\nauth = OAuthHandler(consumer_key, consumer_secret)\nauth.set_access_token(access_token, access_secret)\n\napi = tweepy.API(auth, wait_on_rate_limit=True)\n\n# NOTE TO STUDENT WITH MOBILE VERIFICATION ISSUES:\n# df_1 is a DataFrame with the twitter_archive_enhanced.csv file. You may have to\n# change line 17 to match the name of your DataFrame with twitter_archive_enhanced.csv\n# NOTE TO REVIEWER: this student had mobile verification issues so the following\n# Twitter API code was sent to this student from a Udacity instructor\n# Tweet IDs for which to gather additional data via Twitter's API\ntweet_ids = df_1.tweet_id.values\nlen(tweet_ids)\n\n# Query Twitter's API for JSON data for each tweet ID in the Twitter archive\ncount = 0\nfails_dict = {}\nstart = timer()\n# Save each tweet's returned JSON as a new line in a .txt file\nwith open('tweet_json.txt', 'w') as outfile:\n    # This loop will likely take 20-30 minutes to run because of Twitter's rate limit\n    for tweet_id in tweet_ids:\n        count += 1\n        print(str(count) + \": \" + str(tweet_id))\n        try:\n            tweet = api.get_status(tweet_id, tweet_mode='extended')\n            print(\"Success\")\n            json.dump(tweet._json, outfile)\n            outfile.write('\\n')\n        except tweepy.TweepError as e:\n            print(\"Fail\")\n            fails_dict[tweet_id] = e\n            pass\nend = timer()\nprint(end - start)\nprint(fails_dict)\n\"\"\"","9301cd62":"#opening json file \ndf_list = []\n\nwith open('..\/input\/weratedogs-twitter-archive\/tweet_json.txt') as file:\n    for line in file:\n        df_list.append(json.loads(line))","7b79fdb9":"#reading json file data\ntweet_data = pd.DataFrame(df_list , columns = ['id' , 'retweet_count' , 'favorite_count'])","0883197a":"twitter_archive_enhanced.head()","d5847354":"twitter_archive_enhanced.sample(10)","5cf3e7c0":"twitter_archive_enhanced.info()","afdce4fc":"twitter_archive_enhanced.name.value_counts()","319150ef":"twitter_archive_enhanced.text[1]","17cc168d":"twitter_archive_enhanced.expanded_urls.value_counts()","9e9decd9":"type(twitter_archive_enhanced.timestamp[0])","afcfbeb2":"twitter_archive_enhanced.duplicated().sum()","261c28f9":"twitter_archive_enhanced.rating_denominator.value_counts()","a4a19533":"twitter_archive_enhanced.rating_numerator.value_counts()","eed43358":"image_predictions.head()","c21ba505":"image_predictions.sample(10)","ed99815c":"image_predictions.info()","bd30d326":"type(image_predictions.jpg_url[0])","153fa9ec":"image_predictions.duplicated().sum()","b9f8c3b4":"tweet_data.head()","7a71e3f6":"tweet_data.sample(10)","71a0e1ac":"tweet_data.info()","dad77478":"tweet_data.duplicated().sum()","0c7e40fa":"clean_twitter_archive = twitter_archive_enhanced.copy()\nclean_image_predictions = image_predictions.copy()\nclean_tweet_data = tweet_data.copy()","4c23579d":"clean_tweet_data.rename(columns={'id': 'tweet_id'}, inplace=True)","9983a611":"clean_tweet_data.head()","7881bd53":"clean_twitter_archive = pd.merge(clean_twitter_archive , image_predictions , on= \"tweet_id\" , how=\"left\") \nclean_twitter_archive = pd.merge(clean_twitter_archive , clean_tweet_data , on= \"tweet_id\" , how=\"left\")","961b3c82":"clean_twitter_archive","6b7e6cf8":"clean_twitter_archive['tweet_id'] = clean_twitter_archive['tweet_id'].astype(str)","a0e8cfd3":"type(clean_twitter_archive['tweet_id'][0])","9fc91363":"clean_twitter_archive['Dog_stage'] = clean_twitter_archive['text'].str.extract('(doggo|floofer|pupper|puppo)')\nclean_twitter_archive = clean_twitter_archive.drop(columns=['doggo','floofer','pupper','puppo'])","4eb9bb90":"clean_twitter_archive['Dog_stage'].value_counts()","4e22bf7c":"clean_twitter_archive.rating_denominator = clean_twitter_archive.rating_denominator.replace( range(0,1000) , 10 )     ","626c58ce":"clean_twitter_archive.rating_denominator.value_counts()","14a00ddc":"clean_twitter_archive.rating_numerator[clean_twitter_archive['rating_numerator'] <= 10 ] = clean_twitter_archive.rating_numerator[clean_twitter_archive['rating_numerator'] <= 10 ].add(10)","2635f062":"clean_twitter_archive.rating_numerator.value_counts()","d30dece7":"clean_twitter_archive.query('rating_numerator <= 10 ').rating_numerator.sum()","6e535417":"clean_twitter_archive['timestamp']= pd.to_datetime(clean_twitter_archive['timestamp'])","17824e0f":"type(clean_twitter_archive['timestamp'][0])","0ca31048":"clean_twitter_archive = clean_twitter_archive.drop(columns=['retweeted_status_id' , 'retweeted_status_user_id' , 'retweeted_status_timestamp'])","e1819996":"clean_twitter_archive.info()","7dda8643":"clean_twitter_archive.name = twitter_archive_enhanced.name.replace(\"None\", value = np.nan )","28b72ed8":"clean_twitter_archive.name.isnull().sum()","4482e3fc":"clean_twitter_archive.p1 = clean_twitter_archive.p1.str.title()\nclean_twitter_archive.p2 = clean_twitter_archive.p2.str.title()\nclean_twitter_archive.p3 = clean_twitter_archive.p3.str.title()","5d0adbb3":"clean_twitter_archive.head()","75c53b32":"clean_twitter_archive.rename(columns={'p1_conf': 'p1_confident'}, inplace=True)\nclean_twitter_archive.rename(columns={'p2_conf': 'p2_confident'}, inplace=True)\nclean_twitter_archive.rename(columns={'p3_conf': 'p3_confident'}, inplace=True)","857fcae8":"clean_twitter_archive.head()","00d1cf52":"clean_twitter_archive.to_csv('C:\\\\Users\\\\BluRay\\\\Desktop\\\\DA-P2\\\\twitter_archive_master.csv', index=False)","9616931e":"clean_twitter_archive","614b49be":"plt.figure(figsize=(8,5))\nplt.title(\"Number of Customers\", fontsize=14)\nplt.bar(x=clean_twitter_archive['Dog_stage'].value_counts().index,\n        height=clean_twitter_archive.Dog_stage.value_counts().values)","f6c86396":"clean_twitter_archive['p1_dog'].value_counts()","1090c539":"tolall= (1532+543)\nsucsses_p1 = (1532\/tolall)*100\nsucsses_p1","4794a584":"plt.figure(figsize=(8,5))\nplt.title(\"Number of Customers\", fontsize=14)\nplt.bar(x=clean_twitter_archive['p1_dog'].value_counts().index,\n        height=clean_twitter_archive.p1_dog.value_counts().values)","a6068a6f":"clean_twitter_archive['p2_dog'].value_counts()","c91eebf5":"tolall= (1553+522)\nsucsses_p2 = (1553\/tolall)*100\nsucsses_p2","1386e1d3":"plt.figure(figsize=(8,5))\nplt.title(\"Number of Customers\", fontsize=14)\nplt.bar(x=clean_twitter_archive['p2_dog'].value_counts().index,\n        height=clean_twitter_archive.p2_dog.value_counts().values)","6b106a45":"clean_twitter_archive['p3_dog'].value_counts()","4a94b2e5":"tolall= (1499+576)\nsucsses_p3 = (1499\/tolall)*100\nsucsses_p3","f179eb3c":"plt.figure(figsize=(8,5))\nplt.title(\"Number of Customers\", fontsize=14)\nplt.bar(x=clean_twitter_archive['p3_dog'].value_counts().index,\n        height=clean_twitter_archive.p3_dog.value_counts().values)","50276b99":"plt.pie([sucsses_p1,sucsses_p2,sucsses_p3],labels=('p1','p2','p3'), explode = [0.1,0.2,0.1],autopct ='%1.1f%%')\nplt.show()","cc139197":"## making copy from all data sets ","74ffab2b":"#### .Test","bcf9a27d":"## insights \n- pupper is the Most Popular stage\n- floofer is the least popular stage ","2376526c":"#### .Test","9a703446":"# 3.0 Cleaning_Data","7267fd70":"#### .Define\n- adding 10 to correct this values ","9f27d2a7":"#### .Code ","371c71db":"#### .Code ","5423b88e":"## issue_9,10.11\n- Quality :\n  - retweeted_status_id  should be removed\n  - retweeted_status_user_id should be removed \n  - retweeted_status_timestamp should be removed ","14ad5fa4":"#### .Test","4aa6201a":"#### .Test","9e238280":"# Introduction\n- This dataset is the tweet archive of Twitter user @dog_rates, also known as WeRateDogs. WeRateDogs is a Twitter account that rates people's dogs with a humorous comment about the dog. These ratings almost always have a denominator of 10. The numerators, though? Almost always greater than 10. 11\/10, 12\/10, 13\/10, etc. Why? Because \"they're good dogs Brent.\" WeRateDogs has over 4 million followers and has received international media coverage.","17053735":"#### .Define\n- extract dog stage from text and put it in new column 'dog stage' then drop the real columns ","684c3ac3":"# Importing Libraries","cc9583c0":"### 2.2 Assess_image-predictions","b8466bac":"#### .Code ","9217d252":"#### .Code ","763eda3f":"#### .Define\n- replace the name column from \"id\" to \"tweet_id\"","cd8990ed":"#### .Test","31cd00e3":"#### .Define\n- convert the column type using to_datetime method","1d831e0e":"# 4.0 Analyzing, and Visualizing_Data","c9ad72b1":"#### .Code ","7f891cd3":"#### .Test\n","066ba50e":"### 1.2 Gather_from_the Internet","533c54dd":"#### .Test","fe725757":"#### .Define\n- make letters capital with title method ","c1266973":"#### .Define \n- converet column type with astype method ","8b9b7294":"#### .Define\n- edit the name of the column usinf rename method ","b7cf83cd":"## issue_2\n- tidiness : combining the three dataframes in one dataframe ","25de801e":"## insights \n- p2_algorithm is The most successful algorithm\n- p3_algorithm is The least successful algorithm","b5f07d4e":"#### .Code \n","35c783a2":"## issue_12\n- Quality : Nulls represented as (none) in name column  ","0adc77ef":"#### .Test","451793a7":"## issue_4\n- tidiness : doggo, floofer, pupper, and puppo should be in one column not 4 ","f35c2107":"### 1.3 Gather_from_json-file","d892c793":"#### .Define\n- merging tables with merge method ","6fdb6547":"## 2) tidiness\n\n#### A- twitter_archive_enhanced\n- doggo, floofer, pupper, and puppo should be in one column not 4 \n\n#### B- image-predictions\n- in columns \"confg\" should be configration\n\n#### C- tweet_data\n- no isssues \n\n#### For A , B and C \n- combining the three dataframes in one dataframe \n\n### Totall tidiness issues : 3 ","d3181ebe":"#### .Code ","0d48a81a":"#### .Code ","84681b15":"#### .Define\n- remove this columns using drop method","e9d51478":"## issue_8\n- Quality : timestamp should be \"data time\" not \"str\"","15dc170f":"# 3.0 Storing_Data","14837a2a":"#### .Test","65a4209e":"## 1) Quality\n \n#### A- twitter_archive_enhanced\n- tweet_id should be \"string\" not \"int\" \n- some values in rating_denominator column isn't \"10\" \n- some values in rating_numerator column less than \"10\" \n- some values in rating_numerator column = zero \n- timestamp should be \"data time\" not \"str\" \n- retweeted_status_id  should be removed because we interest in tweet \n- retweeted_status_user_id should be removed because we interest in tweet \n- retweeted_status_timestamp should be removed because we interest in tweet \n- Nulls represented as (none) in name column \n- some of expanded_urls rows has 2 url and we just need tweeter link \n- 59 missing value in expanded_urls column \n- some values in rating_numerator column over ratted\n- strange names like ('a' , 'an') in name column \n\n#### B- image-predictions\n- tweet_id should be \"string\" not \"int\" \n- names p columns have some upper letter and some lower letter \n- missing id's there are '2075' instead of  '2353' \n\n#### C- tweet_data\n- id column name should be \"tweet_id\" instead of \"id\" \n- tweet_id should be \"string\" not \"int\" \n- missing id 2075 i 2324 \n\n### Totall Quality issues : 19 ","838bdb86":"### 4.1 Dog_stage ratios","eb9ee201":"### 4.2 The success rate of the algorithms","cf596eea":"#### .Code ","28537a75":"## issue_13\n- Quality : names p columns have some upper letter and some lower letter  \n","b31228ac":"## issues_6,7\n- Quality : some values in rating_numerator column less than \"10\"\n- Quality : some values in rating_numerator column = zero ","2b6d07c0":"#### .Define\n- replace the values from any num less than 10 to 10 ","d9ed1722":"#### .Test","316c9aae":"#### .Test\n","d477ee2d":"### 1.1 Gather_from_csvfile ","06628df4":"# 1.0 Gathering Data ","585bfb43":"#### .Code ","93b75ae0":"### 2.3 Assess_tweet-data","be6ad067":"#### .Code ","48b14d43":"### 1.3 Gather_from_API","b99ffb5c":"## issue_1\n- Quality : tweet_id should be \"string\" not \"int\" ","bd0e89a8":"## issue_3\n- Quality :  tweet_id should be \"string\" not \"int\"","66d60f77":"## issue_14\n- in columns \"confg\" should be configration","88acd087":"#### .Define\n- replace this values with nulls using replace method and numpy nan method ","3632119c":"### 2.1 Assess_'twitter-archive-data'","9e902dc4":"# 2.0 Assessing_Data ","9328900a":"## issue_5\n- Quality : some values in rating_denominator column isn't \"10\""}}