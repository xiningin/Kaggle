{"cell_type":{"04feab87":"code","9711afb5":"code","d9d3987c":"code","01f071ed":"code","9aaa3aef":"code","417577f4":"code","0fc8ddaf":"code","fe107482":"code","4ebbfce3":"code","04c4e46d":"code","fd5c2b98":"code","599b134d":"code","ec54b950":"code","b9861e40":"code","cbfc57e3":"code","87089432":"code","f861dd09":"code","039f0984":"code","4ef5b300":"code","eeef646d":"code","fbf69161":"code","8f0e9031":"code","4fd76d14":"code","34022b88":"code","a2c713dc":"code","a0de7b40":"code","718c8c72":"code","fa6db7f1":"code","e561c590":"code","c169d0d0":"code","5f19a4d1":"code","ac4d729e":"code","56c9741d":"code","cc97e0f8":"code","1185bf69":"code","a914ea49":"code","ad72fda2":"code","17458561":"code","57638705":"code","690a867d":"code","57406644":"code","ca61831c":"code","3c78b8da":"code","98af3964":"markdown","86371bb4":"markdown","e21e4e21":"markdown"},"source":{"04feab87":"import numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\n%matplotlib inline","9711afb5":"data=pd.read_csv(\"..\/input\/creditcardfraud\/creditcard.csv\")","d9d3987c":"data.head()","01f071ed":"X=data.drop(\"Class\",axis=1)","9aaa3aef":"Y=data[\"Class\"]","417577f4":"X.head()","0fc8ddaf":"## Get the Fraud and the normal dataset \n\nfraud = data[data['Class']==1]\n\nnormal = data[data['Class']==0]","fe107482":"print(fraud.shape,normal.shape)","4ebbfce3":"from imblearn.under_sampling import NearMiss","04c4e46d":"nm = NearMiss(sampling_strategy='auto')","fd5c2b98":"X_res,Y_res=nm.fit_sample(X,Y)","599b134d":"X_res.shape,Y_res.shape","ec54b950":"from sklearn.linear_model import LogisticRegression","b9861e40":"LR_model=LogisticRegression()","cbfc57e3":"from sklearn.model_selection import train_test_split","87089432":"X_train,X_test,y_train,y_test=train_test_split(X_res,Y_res,random_state=1,test_size=0.2)","f861dd09":"LR_model.fit(X_train,y_train)","039f0984":"predict=LR_model.predict(X_test)","4ef5b300":"from sklearn.metrics import accuracy_score,recall_score","eeef646d":"accuracy=accuracy_score(y_test,predict)","fbf69161":"print(accuracy)","8f0e9031":"print(recall_score(y_test,predict))","4fd76d14":"print(fraud.shape,normal.shape)","34022b88":"from imblearn.combine import SMOTETomek","a2c713dc":"smk=SMOTETomek(random_state=42)","a0de7b40":"X_up,Y_up=smk.fit_sample(X,Y)","718c8c72":"X_up.shape,Y_up.shape","fa6db7f1":"Y_up.value_counts()","e561c590":"X1_train,X1_test,Y1_train,Y1_test=train_test_split(X_up,Y_up,random_state=42,test_size=0.2)","c169d0d0":"X1_train.shape","5f19a4d1":"LR_model","ac4d729e":"LR_model.fit(X1_train,Y1_train)","56c9741d":"predict1=LR_model.predict(X1_test)","cc97e0f8":"print(accuracy_score(predict1,Y1_test))","1185bf69":"print(recall_score(predict1,Y1_test))","a914ea49":"from sklearn.ensemble import RandomForestClassifier","ad72fda2":"rf=RandomForestClassifier()","17458561":"X2_train=X1_train.sample(frac=0.3,random_state=42)\nX2_test=X1_test.sample(frac=0.3,random_state=42)\nY2_train=Y1_train.sample(frac=0.3,random_state=42)\nY2_test=Y1_test.sample(frac=0.3,random_state=42)","57638705":"X2_train.shape","690a867d":"rf.fit(X2_train,Y2_train)","57406644":"predict2=rf.predict(X2_test)","ca61831c":"print(accuracy_score(Y2_test,predict2))","3c78b8da":"print(recall_score(Y2_test,predict2))","98af3964":"### UnderSampling","86371bb4":"### OverSampling","e21e4e21":"### The Random Forest model is showing high accuracy and recall results."}}