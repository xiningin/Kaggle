{"cell_type":{"3eee94fd":"code","e7dfe4a9":"code","d2b0efd5":"code","19dab78a":"code","11b6b2d3":"code","fa276dbc":"code","3ec90176":"code","2f963601":"code","1562a952":"code","84cba69e":"code","aca2779c":"markdown","179dc097":"markdown","ca3b4b9e":"markdown","8ff742f1":"markdown","5815a37f":"markdown","3fda7a6e":"markdown","76bbdf83":"markdown","c7e23177":"markdown","ad86ea55":"markdown","3dc97c5c":"markdown"},"source":{"3eee94fd":"# Importing libraies\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error\nfrom math import sqrt","e7dfe4a9":"# Importing Data\ndata = pd.read_csv('..\/input\/student-mat.csv')\ndata.head()","d2b0efd5":"data.drop(['school','age'], axis=1, inplace=True)\n\ndata['GAvg'] = (data['G1'] + data['G2'] + data['G3']) \/ 3\ndata.drop(['G1','G2','G3'], axis=1, inplace=True)","19dab78a":"d = {'yes':1, 'no':0}\ndata['schoolsup'] = data['schoolsup'].map(d)\ndata['famsup'] = data['famsup'].map(d)\ndata['paid'] = data['paid'].map(d)\ndata['activities'] = data['activities'].map(d)\ndata['nursery'] = data['nursery'].map(d)\ndata['higher'] = data['higher'].map(d)\ndata['internet'] = data['internet'].map(d)\ndata['romantic'] = data['romantic'].map(d)\n\nd = {'M':0, 'F':1}\ndata['sex'] = data['sex'].map(d)\n\nd = {'U': 1, 'R': 0}\ndata['address'] = data['address'].map(d)\n\n# map the famili size data\nd = {'LE3': 1, 'GT3': 0}\ndata['famsize'] = data['famsize'].map(d)\n\n# map the parent's status\nd = {'T': 1, 'A': 0}\ndata['Pstatus'] = data['Pstatus'].map(d)\n\n# map the parent's job\nd = {'teacher': 0, 'health': 1, 'services': 2,'at_home': 3,'other': 4}\ndata['Mjob'] = data['Mjob'].map(d)\ndata['Fjob'] = data['Fjob'].map(d)\n\n# map the reason data\nd = {'home': 0, 'reputation': 1, 'course': 2,'other': 3}\ndata['reason'] = data['reason'].map(d)\n\n# map the guardian data\nd = {'mother': 0, 'father': 1, 'other': 2}\ndata['guardian'] = data['guardian'].map(d)\n\ndata = pd.get_dummies(data, columns=['guardian','reason','Mjob','Fjob','Pstatus','famsize','address','sex'])","11b6b2d3":"# Creating I and D\nI = data.iloc[:, :47].values\nI = np.delete(I, 20, axis=1)\nD = data.iloc[:, 20].values","fa276dbc":"I_train, I_test, D_train, D_test = train_test_split(I, D, test_size = 0.2, random_state = 0)","3ec90176":"regressor = RandomForestRegressor(n_estimators=100, min_samples_split=16)\nregressor.fit(I_train,D_train)","2f963601":"D_pred = regressor.predict(I_test)","1562a952":"plt.scatter(np.arange(0,79),D_test, color='red')\nplt.scatter(np.arange(0,79),D_pred, color='blue')\nplt.title('Grade Predictions')\nplt.plot()","84cba69e":"regressor.score(I_test,D_test)","aca2779c":"Defining Independent and Dependent Variables","179dc097":"Ploting grade predictions and real grade","ca3b4b9e":"Importing dataset","8ff742f1":"Fitting Random Forest Regression model to training set","5815a37f":"Importing Required Libraies","3fda7a6e":"Spliting data into training and test sets","76bbdf83":"Droping unwanted variables and creating new column for average grade","c7e23177":"Encoding catergorical variables","ad86ea55":"Calculating regressor's score","3dc97c5c":"Predicting the Test set Dependent variable"}}