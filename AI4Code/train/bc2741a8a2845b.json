{"cell_type":{"7686d02b":"code","2a64bcff":"code","bfd85751":"code","6de34591":"code","aa1aa31e":"code","e9f8d4f7":"code","9e936307":"code","b221dbd7":"code","a979ce60":"code","ea16700d":"code","17f3db65":"code","cde8fa8e":"code","e4d6bf6d":"code","2ba85701":"code","3d12e6d6":"code","bf41ae53":"code","cdb1bcf4":"code","7e1de2af":"code","08a32ea6":"code","b2f6d8cd":"code","afff145e":"code","6f341aa3":"code","30986432":"code","002ebb0d":"markdown"},"source":{"7686d02b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","2a64bcff":"# Import required librarues\n\nimport numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.model_selection import train_test_split\n\nfrom sklearn.preprocessing import RobustScaler\nfrom sklearn.preprocessing import PowerTransformer\nfrom sklearn.preprocessing import QuantileTransformer\n\nfrom sklearn.ensemble import RandomForestClassifier\nfrom xgboost import XGBClassifier\nfrom sklearn.multiclass import OneVsRestClassifier\n\nfrom sklearn.ensemble import ExtraTreesClassifier\nfrom sklearn.tree import DecisionTreeClassifier\n\n\nfrom mlxtend.classifier import StackingCVClassifier\nfrom sklearn.model_selection import cross_val_score\n\nfrom sklearn.metrics import accuracy_score\n\nfrom mlxtend.feature_selection import SequentialFeatureSelector as SFS\nfrom mlxtend.plotting import plot_sequential_feature_selection as plot_sfs","bfd85751":"train = pd.read_csv(\"\/kaggle\/input\/learn-together\/train.csv\")\ntest = pd.read_csv(\"\/kaggle\/input\/learn-together\/test.csv\")","6de34591":"# Remove the Labels and make them y\ny = train['Cover_Type']\n\n# Remove label from Train set\nX = train.drop(['Cover_Type'],axis=1)\n\n# Rename test to text_X\ntest_X = test\n\n\n\n# split data into training and validation data\ntrain_X, val_X, train_y, val_y = train_test_split(X, y, test_size=0.2, random_state=42)\n\nX = X.drop(['Id'], axis = 1)\ntrain_X = train_X.drop(['Id'], axis = 1)\nval_X = val_X.drop(['Id'], axis = 1)\ntest_X = test_X.drop(['Id'], axis = 1)","aa1aa31e":"train_X.describe()","e9f8d4f7":"val_X.describe()","9e936307":"sns.distplot(train_X['Elevation'], label = 'train_X')\nsns.distplot(val_X['Elevation'], label = 'val_X')\nsns.distplot(test_X['Elevation'], label = 'test_X')\nplt.legend()\nplt.title('Elevation')\nplt.show()","b221dbd7":"sns.distplot(train_X['Aspect'], label = 'train_X')\nsns.distplot(val_X['Aspect'], label = 'val_X')\nsns.distplot(test_X['Aspect'], label = 'test_X')\nplt.title('Aspect')\nplt.legend()\nplt.show()","a979ce60":"sns.distplot(train_X['Horizontal_Distance_To_Hydrology'], label = 'train_X')\nsns.distplot(val_X['Horizontal_Distance_To_Hydrology'], label = 'val_X')\nsns.distplot(test_X['Horizontal_Distance_To_Hydrology'], label = 'test_X')\nplt.title('Horizontal_Distance_To_Hydrology')\nplt.legend()\nplt.show()","ea16700d":"sns.distplot(train_X['Vertical_Distance_To_Hydrology'], label = 'train_X')\nsns.distplot(val_X['Vertical_Distance_To_Hydrology'], label = 'val_X')\nsns.distplot(test_X['Vertical_Distance_To_Hydrology'], label = 'test_X')\nplt.title('Vertical_Distance_To_Hydrology')\nplt.legend()\nplt.show()","17f3db65":"sns.distplot(train_X['Horizontal_Distance_To_Roadways'], label = 'train_X')\nsns.distplot(val_X['Horizontal_Distance_To_Roadways'], label = 'val_X')\nsns.distplot(test_X['Horizontal_Distance_To_Roadways'], label = 'test_X')\nplt.title('Horizontal_Distance_To_Roadways')\nplt.legend()\nplt.show()","cde8fa8e":"sns.distplot(train_X['Hillshade_9am'], label = 'train_X')\nsns.distplot(val_X['Hillshade_9am'], label = 'val_X')\nsns.distplot(test_X['Hillshade_9am'], label = 'test_X')\nplt.title('Hillshade_9am')\nplt.legend()\nplt.show()","e4d6bf6d":"### define the classifiers\n\nclassifier_rf = RandomForestClassifier(random_state=42)\n#classifier_xgb = OneVsRestClassifier(XGBClassifier(random_state=42))\n#classifier_et = ExtraTreesClassifier(random_state=42)","2ba85701":"\n#sclf_sbs = StackingCVClassifier(classifiers=[classifier_rf,\n#                                         classifier_xgb,\n#                                         classifier_et],\n#                            use_probas=True,\n#                            meta_classifier=classifier_rf)","3d12e6d6":"### Running Sequential Backward Selection with Random Forest Only\nseqbacksel_rf = SFS(classifier_rf, k_features = (30, 50),\n                    forward = False, floating = False,\n                    scoring = 'accuracy', cv = 5, \n                    n_jobs = -1)\nseqbacksel_rf = seqbacksel_rf.fit(train_X, train_y.values.ravel())\n\n\nprint('best combination (ACC: %.3f): %s\\n' % (seqbacksel_rf.k_score_, seqbacksel_rf.k_feature_idx_))\nprint('all subsets:\\n', seqbacksel_rf.subsets_)\nplot_sfs(seqbacksel_rf.get_metric_dict(), kind='std_err');","bf41ae53":"train_X_sbs = seqbacksel_rf.transform(train_X)\nval_X_sbs = seqbacksel_rf.transform(val_X)","cdb1bcf4":"classifier_rf.fit(train_X_sbs, train_y.values.ravel())","7e1de2af":"\nvalsbs_pred = classifier_rf.predict(val_X_sbs)","08a32ea6":"acc = accuracy_score(val_y, valsbs_pred)\nprint(acc)","b2f6d8cd":"X_sbs = seqbacksel_rf.transform(X)\ntest_X_sbs = seqbacksel_rf.transform(test_X)","afff145e":"classifier_rffin = RandomForestClassifier(random_state=42)\n\nclassifier_rffin.fit(X_sbs, y.values.ravel())","6f341aa3":"test_ids = test[\"Id\"]\ntest_pred = classifier_rffin.predict(test_X_sbs)","30986432":"# Save test predictions to file\noutput = pd.DataFrame({'Id': test_ids,\n                       'Cover_Type': test_pred})\noutput.to_csv('submission.csv', index=False)","002ebb0d":"### Import the Raw Data"}}