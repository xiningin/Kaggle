{"cell_type":{"79efedcf":"code","98b8d920":"code","4b9b7a9c":"code","fed12882":"code","7f685c98":"code","e459b8f5":"code","35d7a9a1":"code","3ef02ac8":"code","bf7bccc1":"code","c2672aff":"code","52c19cdf":"code","f4ab5f71":"code","da28c12a":"code","399b89b3":"code","2dad1387":"code","aebac91b":"code","90914d62":"markdown","2527d81c":"markdown","7a0920b1":"markdown","8acefd29":"markdown"},"source":{"79efedcf":"import numpy as np\nimport pandas as pd\nfrom datetime import *","98b8d920":"df = pd.read_csv('..\/input\/forbes-top-billionaires-list-2018\/forbes_2018.csv')","4b9b7a9c":"df = df[52:]\ndf.reset_index(drop=True,inplace=True)\ndf.drop(['position','lastName','age','gender','wealthSource','industry','worthChange','realTimeWorth','realTimePosition','image'],axis=1,inplace=True)","fed12882":"df.head()","7f685c98":"top_ten = {}\nfor i in df.country.unique():\n    top_ten[i] = df.loc[df.country==i,'worth'][:10].sum()","e459b8f5":"dfx = pd.DataFrame.from_dict(top_ten,orient='index',columns=['Total_Net_worth'])\ndfx.index.rename('Country',inplace=True)","35d7a9a1":"dfx","3ef02ac8":"retail = pd.read_csv('..\/input\/retailtransactiondata\/Retail_Data_Transactions.csv')","bf7bccc1":"retail.drop('customer_id',axis=1,inplace=True)\nretail.index.rename('transaction_id',inplace=True)","c2672aff":"retail","52c19cdf":"retail.trans_date = pd.to_datetime(retail['trans_date'])","f4ab5f71":"dff = retail.groupby(retail['trans_date']).sum()","da28c12a":"dff['tran_date'] = dff.index\ndff.reset_index(drop=True,inplace=True)\ndff.index.rename('transaction_id',inplace=True)","399b89b3":"trans_diff = {}\ntrans_diff['2011-05-16'] = 5755\nfor i in dff.tran_date:\n    diff = dff.loc[dff.tran_date == i,'tran_amount'].sum() - dff.loc[dff.tran_date == i + timedelta(days=1),'tran_amount'].sum()\n    trans_diff[(i + timedelta(days=1)).date()] = diff","2dad1387":"result = pd.DataFrame.from_dict(trans_diff,orient='index',columns=['changed_by'])\nresult.index.rename('date',inplace=True)\nresult = result.head(-1)","aebac91b":"result","90914d62":"=====================================================================================================================================","2527d81c":"# Query for second question","7a0920b1":"=====================================================================================================================================","8acefd29":"======================================================================================================================================\n# Query for first question\n======================================================================================================================================"}}