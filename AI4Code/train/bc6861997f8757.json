{"cell_type":{"f3f036c8":"code","16c3858a":"code","2d1db3e4":"code","d8360718":"code","1dfc45e7":"code","4d3e0e04":"code","92108f44":"code","dcb72abb":"code","57cbec65":"code","828cce7e":"code","5822bc7b":"code","bc0b7213":"code","49b925e5":"code","8c0a07fb":"markdown","db3488c6":"markdown","d86246ea":"markdown"},"source":{"f3f036c8":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","16c3858a":"train_path = \"..\/input\/tabular-playground-series-aug-2021\/train.csv\"\ntrain = pd.read_csv(train_path, index_col=\"id\")","2d1db3e4":"train.info()","d8360718":"X = train.drop(\"loss\", axis=1)\ny = train.loss\nfeature_names = X.columns.to_list()","1dfc45e7":"from sklearn.preprocessing import StandardScaler\n\nstandizer = StandardScaler()\nX = standizer.fit_transform(X)","4d3e0e04":"train.select_dtypes(\"int\").nunique()","92108f44":"import statsmodels.api as sm\n\nexog = sm.add_constant(X)\npoission_model = sm.GLM(y, exog, family=sm.families.Poisson())\nresult = poission_model.fit()","dcb72abb":"result.summary()","57cbec65":"test_path = \"..\/input\/tabular-playground-series-aug-2021\/test.csv\"\ntest = pd.read_csv(test_path, index_col=\"id\")\ntest.head()","828cce7e":"test.shape","5822bc7b":"from sklearn.model_selection import KFold\n\nX_test = sm.add_constant(standizer.transform(test))\nprediction_test = []\n\nkfold = KFold(shuffle=True, random_state=42)\nfor train_idx, valid_idx in kfold.split(X, y):\n    \n    features = sm.add_constant(X[train_idx])\n    \n    model = sm.GLM(\n        y[train_idx], \n        features, \n        family=sm.families.Poisson()\n    )\n    result = model.fit()\n    \n    prediction_test.append(result.predict(X_test))","bc0b7213":"preds = np.column_stack(prediction_test).mean(axis=1)","49b925e5":"sub = pd.read_csv(\"..\/input\/tabular-playground-series-aug-2021\/sample_submission.csv\")\nsub[\"loss\"] = preds\nsub.to_csv(\"submission.csv\", index=False)","8c0a07fb":"# Prepare our data","db3488c6":"# Make prediction on the test set","d86246ea":"# Fit a Poisson Regression model to the data"}}