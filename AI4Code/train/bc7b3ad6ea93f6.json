{"cell_type":{"433707ab":"code","abaf5b96":"code","f318f615":"code","b16f58bc":"code","7fa6d92a":"code","25264649":"code","9016a3dd":"code","4da06cc5":"code","e4c4f2de":"code","f68683b3":"code","7ad820d8":"code","43f80609":"code","67e30fb4":"markdown","5187e8e5":"markdown","510ab4fa":"markdown","88c1f84c":"markdown","df35524c":"markdown","590b9d6b":"markdown","286e45ae":"markdown"},"source":{"433707ab":"import numpy as np\nimport pandas as pd\n\nfrom sklearn.model_selection import train_test_split\n\nimport optuna\n\nfrom catboost import CatBoostClassifier\n\nimport sklearn.datasets\nimport sklearn.metrics\n\nimport os\nimport random\nDEFAULT_RANDOM_SEED = 2021\ndef seedBasic(seed=DEFAULT_RANDOM_SEED):\n    random.seed(seed)\n    os.environ['PYTHONHASHSEED'] = str(seed)\n    np.random.seed(seed)\n    \nseedBasic()","abaf5b96":"TRAIN_PATH = \"..\/input\/iris\/Iris.csv\"\n\nID = \"Id\"\nTARGET = \"Species\"\n\nN_TRIALS = 1000\nDIRECTIONS = \"maximize\"\nTEST_SIZE = 0.25","f318f615":"train = pd.read_csv(TRAIN_PATH)","b16f58bc":"y = train[TARGET]\nX = train.drop([TARGET],axis=1)","7fa6d92a":"X_train, X_val, y_train, y_val = train_test_split(X, y, test_size=TEST_SIZE,stratify=y)","25264649":"def objective(trial):\n   \n    # 1.train\n    param = {\n        \"iterations\":trial.suggest_int(\"iterations\", 5, 10),\n        \"max_depth\": trial.suggest_int(\"max_depth\", 2, 5),\n    }\n\n    optunaModel = CatBoostClassifier(**param)\n    optunaModel.fit(X_train,y_train,eval_set=[(X_val,y_val)],early_stopping_rounds=20,verbose=False)\n    \n    # 2.predict\n    pred_labels = optunaModel.predict(X_val)\n    \n    # 3.evaluate\n#     pred_labels = np.argmax(preds)\n    accuracy = sklearn.metrics.accuracy_score(y_val, pred_labels)\n    \n    return accuracy\n\nstudy = optuna.create_study(direction=DIRECTIONS)\nstudy.optimize(objective, n_trials=N_TRIALS)","9016a3dd":"optuna.visualization.plot_contour(study)","4da06cc5":"optuna.visualization.plot_optimization_history(study)","e4c4f2de":"optuna.visualization.plot_slice(study)","f68683b3":"study.best_trial","7ad820d8":"study.best_trial.value","43f80609":"study.best_trial.params","67e30fb4":"# best params","5187e8e5":"# load data ","510ab4fa":"# split data (input data and target data)","88c1f84c":"# make study and search best parameters","df35524c":"# global variabels","590b9d6b":"# study result ","286e45ae":"# split data (train data and validataion data)"}}