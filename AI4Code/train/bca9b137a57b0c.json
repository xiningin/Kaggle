{"cell_type":{"b490d9b1":"code","d9aa1fbe":"code","76157720":"code","f3f80942":"code","38482807":"code","f6e4be7e":"code","4a5c71bf":"code","0dab8f82":"code","7d412bf4":"code","0ae524a5":"code","590c11c3":"code","31e93223":"code","edd1d923":"code","398ec59d":"markdown","b15a7e86":"markdown","150b48f3":"markdown","4dab3c30":"markdown","3621eb63":"markdown","35bd24ab":"markdown","09a1d081":"markdown","d98c05fc":"markdown","0c35c335":"markdown","daa84e76":"markdown","197130d0":"markdown","6992c90b":"markdown","bd984e75":"markdown","56cbbdff":"markdown"},"source":{"b490d9b1":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n#\u8bbe\u5b9a\u6570\u503c\u5b8c\u6574\u6253\u5370\npd.set_option('display.max_columns', None) \npd.set_option('display.max_rows', None) \npd.set_option('max_colwidth',100)\n\ncustomers=pd.read_csv('..\/input\/olist_customers_dataset.csv')\ngeolocation=pd.read_csv('..\/input\/olist_geolocation_dataset.csv')\norder_items=pd.read_csv('..\/input\/olist_order_items_dataset.csv')\norder_payments=pd.read_csv('..\/input\/olist_order_payments_dataset.csv')\norder_reviews=pd.read_csv('..\/input\/olist_order_reviews_dataset.csv')\norders=pd.read_csv('..\/input\/olist_orders_dataset.csv')\nproducts=pd.read_csv('..\/input\/olist_products_dataset.csv')\nsellers=pd.read_csv('..\/input\/olist_sellers_dataset.csv')\ntranslation=pd.read_csv('..\/input\/product_category_name_translation.csv')\n#\u8fde\u63a5\u8868\u683c,Concatenating DataFrames\norder_merge_list=[order_items,order_payments,order_reviews]\n\nfor item in order_merge_list:\n\torders=pd.merge(orders,item,on='order_id',how='left')\n\norders=pd.merge(orders,products,on='product_id',how='left')\n\n#\u5b8c\u6210\u8fde\u63a5\u4ea4\u6613\u4fe1\u606f\u8868\u683c\uff0c\u6b64\u5904\u52a0\u4e0a\u4e86\u5df4\u897f\u8bed\u8a00\u5bf9\u5e94\u7684\u82f1\u6587\u7ffb\u8bd1\norders_full=pd.merge(orders,translation,on='product_category_name',how='left')\n\n#\u5b8c\u6210\u8fde\u63a5\u5356\u5bb6\u5730\u7406\u4f4d\u7f6e\u8868\u683c\nsellers_geo=pd.merge(sellers,geolocation,left_on='seller_zip_code_prefix',right_on='geolocation_zip_code_prefix')\n\n#\u5b8c\u6210\u8fde\u63a5\u4e70\u5bb6\u5730\u7406\u4f4d\u7f6e\u8868\u683c\ncustomers_geo=pd.merge(customers,geolocation,left_on='customer_zip_code_prefix',right_on='geolocation_zip_code_prefix')\n\n\n","d9aa1fbe":"orders_full.head()","76157720":"#\u5b9a\u4e49\u65f6\u95f4\u5e8f\u5217\ndate_cols=['order_purchase_timestamp','order_approved_at','order_delivered_carrier_date','order_delivered_customer_date' ,'order_estimated_delivery_date','shipping_limit_date','review_creation_date','review_answer_timestamp']\nfor item in date_cols:\n    orders_full[item]=pd.to_datetime(orders_full[item])\norders_full.info()    \n","f3f80942":"#\u7edf\u8ba1\u4e0d\u540c\u5546\u54c1\u7684\u9500\u91cf\nplt.subplots()\nproduct_counts=orders_full.groupby(['product_category_name_english']).size().sort_values()\nproduct_counts.plot(kind='barh',figsize=(10,40),title='Product Category')\nplt.style.use('ggplot')","38482807":"#\u652f\u4ed8\u624b\u6bb5\u7edf\u8ba1\u5206\u6790\nplt.subplots()\npayment_counts=orders_full[\"payment_type\"][orders_full[\"payment_type\"]!='not_defined'].value_counts()\nexplode = [0, 0.1, 0, 0]\npayment_counts.plot(kind=\"pie\",autopct='%1.1f%%', pctdistance=0.6, shadow=True,figsize=(8,8),explode=explode, startangle = 90,labels=None,legend=True)\n\n \nplt.title(\"Paymement methods\", fontweight='bold', size=16)\n\n\n\n","f6e4be7e":"plt.subplots()\n#\u5206\u671f\u4ed8\u6b3e\u5206\u5e03\u60c5\u51b5\nsns.distplot(orders_full['payment_installments'].dropna(),bins=25)\n\n\n","4a5c71bf":"Daily_sells=orders_full['order_purchase_timestamp'].value_counts().resample('D').sum()\nDaily_sells.plot(figsize=(15,10),title='Daily sells')","0dab8f82":"amount=orders_full.loc[:,['order_purchase_timestamp','payment_value']].set_index('order_purchase_timestamp').sort_index()\n\nMonths_amount=amount.resample('M').sum()\nprint(Months_amount.max())\n\nMonths_amount.plot(kind='bar',figsize=(15,10),title='Months_amount')\n\n","7d412bf4":"seller_review=orders_full.loc[:,['seller_id','review_score']]\nscore=seller_review.groupby(['seller_id']).mean()\nowns=seller_review['seller_id'].value_counts()\n#\u8bbe\u5b9a\u6761\u4ef6\u4e3a\u8bc4\u4ef7\u6570\u5927\u4e8e300\u6761\nscores=score[owns>300]\nscores_sorted=scores.loc[:,'review_score'].sort_values()\n#\u67e5\u770b\u524d5\u540d\nprint(scores_sorted.tail())\n\nplt.subplots()\nscores_sorted.plot(kind='barh',figsize=(10,40),title='Review Score Ranklist(seller reviews>300)')\n\n","0ae524a5":"Tuhao=orders_full.loc[:,['customer_id','payment_value']].groupby(['customer_id']).sum().sort_values(by='payment_value')\nTuhao_buy_counts=orders_full['customer_id'].value_counts().sort_values()\n","590c11c3":"print(Tuhao.tail(10))\nTuhao.tail(10).plot(kind='barh',title='Top 10 Customers')\nprint('\\nCustomer 1617b1357756262bfa56ab541c47bc16 ordered '+str(Tuhao_buy_counts['1617b1357756262bfa56ab541c47bc16'])+' times')","31e93223":"#\u5206\u7ec4\nseller_cites=sellers_geo.groupby(['seller_id','seller_city']).size().sort_values()\nseller_cites_counts=seller_cites.groupby(['seller_city']).size().sort_values()\n#\u53ef\u89c6\u5316\u6392\u540d\u524d20\u7684\u57ce\u5e02\nseller_cites_counts.tail(20).plot(kind='barh',figsize=(10,10),title='Seller cites ')\n\n\n\n\n\n","edd1d923":"#\u5206\u7ec4\ncustomer_cites=customers_geo.groupby(['customer_unique_id','customer_city']).size().sort_values()\ncustomer_cites_counts=customer_cites.groupby(['customer_city']).size().sort_values()\n#\u53ef\u89c6\u5316\u6392\u540d\u524d20\u7684\u57ce\u5e02\ncustomer_cites_counts.tail(20).plot(kind='barh',figsize=(10,10),title='Customer cites ')\n\n\n\n","398ec59d":"## **4. \u672a\u5b8c\u5f85\u7eed**\nTo be countinue","b15a7e86":"## **3. \u5356\u5bb6\u548c\u4e70\u5bb6\u5730\u7406\u4f4d\u7f6e\u5206\u6790**\n\n","150b48f3":"### **\u8ba2\u5355\u91cf\u65f6\u95f4\u5e8f\u5217\u5206\u6790\uff08\u5929\uff09**\n\u8ba2\u5355\u91cf\u65f6\u95f4\u5e8f\u5217\u5206\u6790\uff0c\u53ef\u4ee5\u770b\u5230\u572812\u6708\u4efd\u8ba2\u5355\u6fc0\u589e\uff0c\u56e0\u4e3a\u8fd9\u65f6\u6b63\u5904\u4e8e\u5723\u8bde\u8282\u3002","4dab3c30":"  \u6253\u5370orders_full\u8868\u683c\u7684\u524d5\u884c\uff0c\u53d1\u73b0order_purchase_timestamp\uff0corder_approved_at\uff0corder_delivered_carrier_date\uff0corder_delivered_customer_date \uff0corder_estimated_delivery_date\uff0cshipping_limit_date\uff0creview_creation_date\uff0creview_answer_timestamp \u5217\u7684\u6570\u503c\u4e3a\u65f6\u95f4\u65e5\u671f\uff0c\u968f\u540e\u5c06\u5b83\u4eec\u8f6c\u6362\u4e3a**\u65f6\u95f4\u5e8f\u5217**\u3002","3621eb63":"### **\u652f\u4ed8\u624b\u6bb5\u5206\u6790**\n\u652f\u4ed8\u624b\u6bb5\u7edf\u8ba1\u5206\u6790,\u53ef\u4ee5\u53d1\u73b0\u4fe1\u7528\u5361\u652f\u4ed8\u65b9\u5f0f\u5360\u6bd4\u6700\u5927,\u5176\u5360\u6bd4\u9ad8\u8fbe**73.7%**","35bd24ab":" ### **\u8ba9\u6211\u4eec\u770b\u770b\u6d88\u8d39\u989d\u6700\u591a\u7684\u4e70\u5bb6\uff08\u571f\u8c6a\uff09\u6392\u884c**\n \u53ef\u89c6\u5316\u6d88\u8d39\u91d1\u989d\u524d10\u7684\u7528\u6237\uff0c\u53ef\u4ee5\u770b\u5230\u6d88\u8d39\u91d1\u989d\u6700\u591a\u7684\u7528\u6237\u4e3a1617b1357756262bfa56ab541c47bc16\uff1a109312.64\u5df4\u897f\u96f7\u4e9a\u5c14\uff0c\u6298\u5408\u4eba\u540d\u5e01189963.5058\u5143\uff0c\u800c\u5176\u6d88\u8d39\u6b21\u6570\u4ec5\u4e3a8\u6b21\u3002\u3002\u3002\u4e5f\u5c31\u662f\u6bcf\u6b21\u5e73\u5747\u6d88\u8d3923745.438225\u5143\n\n \n ","09a1d081":"## **2. \u8ba2\u5355\u4ea4\u6613\u4fe1\u606f\u5206\u6790 Orders analysis**\n### **\u5546\u54c1\u9500\u91cf\u5206\u6790**\n  \u9996\u5148\u770b\u4e00\u4e0b\u6700\u7545\u9500\u7684\u4ea7\u54c1,\u9500\u91cf\u6392\u884c\u524d5\u5546\u54c1\u7c7b\u578b\u5206\u522b\u662f\uff1a**bed_bath_table,\nhealth_beauty,\nsport_leisure,\nfurniture_decor,\ncomputers_accessories**\n","d98c05fc":"# **\u5df4\u897f\u7535\u5546\u5e73\u53f0Olist\u6570\u636e\u5206\u6790\uff08Brazilian E-commerce Exploratory data analysis\uff09**\n## **\u524d\u8a00 Introduction**\n  Olist\u662f\u5df4\u897f\u7535\u5b50\u5546\u52a1\u5e73\u53f0\uff0c\u7c7b\u4f3c\u4e2d\u56fd\u7684\u6dd8\u5b9d\uff0c\u5b83\u7684\u4e70\u5bb6\u548c\u5356\u5bb6\u4e3b\u8981\u5206\u5e03\u5728\u5df4\u897f\u5730\u533a\uff0c\u8be5\u6570\u636e\u96c6\u5305\u542b\u5927\u7ea611\u4e07\u6761\u8ba2\u5355\u6570\u636e\u3002\u6570\u636e\u96c6\u5982\u4e0b\uff1a\n1. olist_customers_dataset.csv\uff1a\u4e70\u5bb6\u4e2a\u4eba\u4fe1\u606f\u8868\u683c\u3002\n1. olist_order_items_dataset.csv\uff1a\u8ba2\u5355\u5546\u54c1\u4fe1\u606f\u3002\n1. olist_order_payments_dataset.csv\uff1a\u8ba2\u5355\u652f\u4ed8\u4fe1\u606f\u3002\n1. olist_order_reviews_dataset.csv\uff1a\u8ba2\u5355\u8bc4\u8bba\u3002\n1.  olist_orders_dataset.csv\uff1a\u8ba2\u5355\u7269\u6d41\u4fe1\u606f\u3002\n1.  olist_products_dataset.csv\uff1a\u5546\u54c1\u4fe1\u606f\u3002\n1.  olist_geolocation_dataset.csv\uff1a\u5404\u4e2a\u90ae\u7f16\u4ee3\u7801\u6240\u6307\u5730\u533a\u7684\u7ecf\u7eac\u5ea6\u3002\n1.  olist_sellers_dataset.csv\uff1a\u5356\u5bb6\u4fe1\u606f\u3002\n1.  product_category_name_translation.csv\uff1a\u5546\u54c1\u8461\u8404\u7259\u8bed\u7ffb\u8bd1\u82f1\u8bed\u5bf9\u5e94\u683c\u3002\n\n  ","0c35c335":"### **\u627e\u51fa\u54ea\u4e2a\u5356\u5bb6\u6536\u5230\u7684\u8bc4\u8bba\u4e2d\u5e73\u5747\u5206\u6700\u9ad8 Finding the most recommended seller**\n\u8ba9\u6211\u4eec\u770b\u770b\u5728**\u8bc4\u4ef7\u6570\u5927\u4e8e300**\u7684\u5356\u5bb6\u4e2d\uff0c\u54ea\u4e2a\u5356\u5bb6\u6709\u6700\u9ad8\u7684\u5e73\u5747\u8bc4\u5206\u3002\n\n\u62e5\u6709\u6700\u9ad8\u5e73\u5747\u5206\u7684\u662f\uff1ac3cfdc648177fdbbbb35635a37472c53 \u5206\u6570\u4e3a4.464615\n\nCongratulations ! Seller c3cfdc648177fdbbbb35635a37472c53,You are Seller of the Year !","daa84e76":"### **\u8ba2\u5355\u989d\u65f6\u95f4\u5e8f\u5217\u5206\u6790\uff08\u6708\uff09**\n\u53ef\u4ee5\u770b\u5230\u6700\u5927\u6210\u4ea4\u989d\u57282017\u5e7411\u6708\uff0c\u4e3a1610581.21\u5df4\u897f\u96f7\u4e9a\u5c14\uff0c\u6298\u5408\u4eba\u6c11\u5e012798545.9105\u5143\u3002\n  ","197130d0":"## **1. \u8fde\u63a5\u8868\u683c\u4ee5\u53ca\u5b9a\u4e49\u65f6\u95f4\u5e8f\u5217 Concatenating Data**\n  \u9996\u5148\u6839\u636e\u6570\u636e\u96c6\u63d0\u4f9b\u7684\u6570\u636e\u903b\u8f91\u56fe\u8fde\u63a5\u5404\u4e2a\u8868\u683c\n![](http:\/\/i.imgur.com\/HRhd2Y0.png)\n  \u7531\u8be5\u56fe\u5c06\u6574\u4e2a\u6570\u636e\u96c6\u6574\u7406\u4e3a\u4e09\u4e2a\u8868\u683c\uff1a**orders_full(\u4ea4\u6613\u4fe1\u606f)**,**sellers_geo\uff08\u5356\u5bb6\u5730\u7406\u4f4d\u7f6e\u4fe1\u606f\uff09**,**customers_geo\uff08\u4e70\u5bb6\u5730\u7406\u4f4d\u7f6e\u4fe1\u606f\uff09**","6992c90b":"### **\u5356\u5bb6\u57ce\u5e02\u7edf\u8ba1**\n\u770b\u770b\u5356\u5bb6\u4eec\u4e3b\u8981\u6765\u81ea\u54ea\u4e9b\u57ce\u5e02\uff0c\u53ef\u89c6\u5316\u6392\u540d\u524d20\u7684\u57ce\u5e02\u3002\u53d1\u73b0\u5356\u5bb6\u5927\u90e8\u5206\u6765\u81easao paulo,\u5723\u4fdd\u7f57\u3002\u5b83\u662f\u5df4\u897f\u6700\u5927\u7684\u57ce\u5e02\uff0c\u4e5f\u662f\u5357\u7f8e\u6d32\u6700\u5927\u6700\u7e41\u534e\u6700\u5bcc\u88d5\u7684\u57ce\u5e02\uff0c\u6240\u4ee5\u4e5f\u4e0d\u5947\u602a\u5356\u5bb6\u4e3b\u8981\u6765\u81easao paulo\u3002\n![](https:\/\/timgsa.baidu.com\/timg?image&quality=80&size=b9999_10000&sec=1552130401740&di=c5144e82738aa8128d43e58090f84c57&imgtype=0&src=http%3A%2F%2Fs13.sinaimg.cn%2Fmiddle%2F7deaa79fxb1cf9ade997c%26690)\n","bd984e75":"### **\u67e5\u770b\u5206\u671f\u4ed8\u6b3e\u5728\u603b\u4ed8\u6b3e\u6570\u4e2d\u7684\u60c5\u51b5**\n\u53ef\u4ee5\u770b\u51fa\u6709\u5927\u4e8e50%\u7684\u4e70\u5bb6\u9009\u62e9\u8d85\u8fc7\u4e00\u671f\u7684\u5206\u671f\u4ed8\u6b3e\u9009\u9879\u3002\n","56cbbdff":"### **\u4e70\u5bb6\u57ce\u5e02\u7edf\u8ba1**\n\u4e70\u5bb6\u6765\u6e90\u57ce\u5e02\u7b2c\u4e00\u4ecd\u7136\u662f\u5723\u4fdd\u7f57\uff0c\u800c\u7b2c\u4e8c\u662f\u5df4\u897f\u7b2c\u4e8c\u5927\u57ce\u5e02\u91cc\u7ea6\u70ed\u5185\u5362\u3002"}}