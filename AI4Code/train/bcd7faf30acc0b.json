{"cell_type":{"a1935c44":"code","bcb2ccf5":"code","291eb334":"code","c0e85a31":"code","369140ca":"markdown","d9f143eb":"markdown","7a518081":"markdown","d5f0a3f7":"markdown"},"source":{"a1935c44":"# Import packages\nfrom google.cloud import bigquery\nimport plotly.graph_objs as go\nfrom plotly.offline import iplot, init_notebook_mode\ninit_notebook_mode(connected=True)\nfrom sklearn.preprocessing import LabelEncoder","bcb2ccf5":"# Retrieve data for Chicago crimes\nclient = bigquery.Client()\ndataset_ref = client.dataset(\"chicago_crime\", project=\"bigquery-public-data\")\ntable_ref = dataset_ref.table('crime')\ntable = client.get_table(table_ref)","291eb334":"# Create a dataframe (with only 500 rows for speed and simplicity)\ncrimes_df = client.list_rows(table, max_results=500).to_dataframe()\ncrimes_df['primary_type_encoded'] = LabelEncoder().fit_transform(crimes_df['primary_type'])","c0e85a31":"# Plot a quick and simple map\ndata = [ go.Scattergeo(\n        locationmode = 'USA-states',\n        lon = crimes_df['longitude'],\n        lat = crimes_df['latitude'],\n        text = crimes_df['primary_type'],\n        marker = dict(\n                color = crimes_df['primary_type_encoded']\n                )\n        ) ]\n\nlayout = dict(\n        title = 'A few Chicago crimes', \n        geo = dict(\n            scope='usa',\n            showland = True,\n            landcolor = \"rgb(250, 250, 250)\",\n            countrywidth = 0.5,\n            subunitwidth = 0.5 \n            )\n        )\n\nfig = go.Figure(data=data, layout=layout)\niplot(fig)","369140ca":"### 3) Create a crime map\n\nIf you wanted to create a map with a dot at the location of each crime, what are the names of the two fields you likely need to pull out of the `crime` table to plot the crimes on a map?","d9f143eb":"---\n**[SQL Micro-Course Home Page](https:\/\/www.kaggle.com\/learn\/intro-to-sql)**\n\n","7a518081":"# Keep going\n\nYou've looked at the schema, but you haven't yet done anything exciting with the data itself. Things get more interesting when you get to the data, so keep going to **[write your first SQL query](https:\/\/www.kaggle.com\/dansbecker\/select-from-where).**","d5f0a3f7":"**[SQL Micro-Course Home Page](https:\/\/www.kaggle.com\/learn\/intro-to-sql)**\n\n---\n"}}