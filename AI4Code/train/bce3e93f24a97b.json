{"cell_type":{"98a40cbc":"code","5251b57a":"code","39586940":"code","cb9e7f65":"code","3813ab41":"code","96914866":"code","6b9eaa1c":"code","1ea6c731":"code","6c9cbec2":"code","6460d417":"code","d93a2512":"code","6d4afa38":"code","62028051":"code","b8ebdf13":"code","74e770f4":"code","afda779f":"code","8edd5f4c":"code","17ceb886":"code","a8bba956":"markdown","938d07fa":"markdown","1f25dbaf":"markdown","8f9789bd":"markdown","3402e298":"markdown"},"source":{"98a40cbc":"import numpy as np\nimport pandas as pd \nimport matplotlib.pyplot as plt\nfrom tqdm import tqdm\nimport cv2\n\nimport warnings\nwarnings.filterwarnings('ignore')\nimport os\nfor dirname, _, _ in os.walk('\/kaggle\/input'):\n        print(dirname)","5251b57a":"train_path = \"\/kaggle\/input\/waste-classification-data\/DATASET\/TRAIN\/\"\ntest_path = \"\/kaggle\/input\/waste-classification-data\/DATASET\/TEST\/\"","39586940":"from keras.models import Sequential \nfrom keras.layers import Conv2D, MaxPooling2D, Activation, Dropout, Flatten, Dense, BatchNormalization\nfrom keras.preprocessing.image import ImageDataGenerator, img_to_array, load_img\nfrom keras.utils.vis_utils import plot_model\nfrom glob import glob","cb9e7f65":"x_data = [] \ny_data = [] \n\nfor category in glob(train_path+'\/*'):\n    for file in tqdm(glob(category+'\/*')):\n        img_array=cv2.imread(file)\n        img_array = cv2.cvtColor(img_array, cv2.COLOR_BGR2RGB)\n        x_data.append(img_array) \n        y_data.append(category.split(\"\/\")[-1])\n        \ndata=pd.DataFrame({'image': x_data,'label': y_data})","3813ab41":"data.shape","96914866":"from collections import Counter\nCounter(y_data)","6b9eaa1c":"colors = ['#a0d157','#c48bb8']\nplt.pie(data.label.value_counts(),startangle=90,explode=[0.05,0.05],autopct='%0.2f%%',\n        labels=['Organic', 'Recyclable'], colors= colors,radius=2)\nplt.show()","1ea6c731":"plt.figure(figsize=(20,15))\nfor i in range(9):\n    plt.subplot(4,3,(i%12)+1)\n    index=np.random.randint(15000)\n    plt.title('This image is of {0}'.format(data.label[index]),fontdict={'size':20,'weight':'bold'})\n    plt.imshow(data.image[index])\n    plt.tight_layout()","6c9cbec2":"className = glob(train_path + '\/*' )\nnumberOfClass = len(className)\nprint(\"Number Of Class: \",numberOfClass)","6460d417":"model = Sequential()\nmodel.add(Conv2D(32,(3,3),input_shape = (224,224,3)))\nmodel.add(Activation(\"relu\"))\nmodel.add(MaxPooling2D())\n\nmodel.add(Conv2D(64,(3,3)))  \nmodel.add(Activation(\"relu\"))\nmodel.add(MaxPooling2D())\n\nmodel.add(Conv2D(128,(3,3)))\nmodel.add(Activation(\"relu\"))\nmodel.add(MaxPooling2D())\n\nmodel.add(Flatten())\nmodel.add(Dense(256))\nmodel.add(Activation(\"relu\"))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(64))\nmodel.add(Activation(\"relu\"))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(numberOfClass)) # output\nmodel.add(Activation(\"sigmoid\"))\n\nmodel.compile(loss = \"binary_crossentropy\",\n              optimizer = \"adam\",\n              metrics = [\"accuracy\"])\n\nbatch_size = 256","d93a2512":"plot_model(model)","6d4afa38":"train_datagen = ImageDataGenerator(rescale= 1.\/255)","62028051":"test_datagen = ImageDataGenerator(rescale= 1.\/255)","b8ebdf13":"train_generator = train_datagen.flow_from_directory(\n        train_path, \n        target_size= (224,224),\n        batch_size = batch_size,\n        color_mode= \"rgb\",\n        class_mode= \"categorical\")\n\ntest_generator = test_datagen.flow_from_directory(\n        test_path, \n        target_size= (224,224),\n        batch_size = batch_size,\n        color_mode= \"rgb\",\n        class_mode= \"categorical\")","74e770f4":"hist = model.fit_generator(\n        generator = train_generator,\n        epochs=10,\n        validation_data = test_generator)","afda779f":"plt.plot(hist.history[\"accuracy\"], label = \"Train acc\")\nplt.plot(hist.history[\"val_accuracy\"], label = \"Validation acc\")\nplt.legend()\nplt.show()","8edd5f4c":"plt.plot(hist.history['loss'], label = \"Train loss\")\nplt.plot(hist.history['val_loss'], label = \"Validation loss\")\nplt.legend()\nplt.show()","17ceb886":"test_x, test_y = test_generator.__getitem__(1)\n\nlabels = (test_generator.class_indices)\nlabels = dict((v,k) for k,v in labels.items())\n\npreds = model.predict(test_x)\n\nplt.figure(figsize=(16, 16))\nfor i in range(16):\n    plt.subplot(4, 4, i+1)\n    plt.title('pred:%s \/ truth:%s' % (labels[np.argmax(preds[i])], labels[np.argmax(test_y[i])]))\n    plt.imshow(test_x[i])","a8bba956":"## Import Libraries","938d07fa":"# Convolutional Neural Network - CNN","1f25dbaf":"## Visualization","8f9789bd":"* O -> Organic\n* R -> Recyclable","3402e298":"# \ud83d\udccc Introduction\n\n![image.png](attachment:ecafcddb-f01b-47ac-b38e-1cd964b2b971.png)\n\nWaste is a significant global issue. Increasing volumes of waste are being generated as the global population and living standards rise. People are increasingly concerned about the production of waste and its effect, and are seeking ways to deal with the problem.\n\nRecycling is the process of converting waste materials into new materials and objects. The recovery of energy from waste materials is often included in this concept. The recyclability of a material depends on its ability to reacquire the properties it had in its original state. It is an alternative to \"conventional\" waste disposal that can save material and help lower greenhouse gas emissions. Recycling can prevent the waste of potentially useful materials and reduce the consumption of fresh raw materials, thereby reducing: energy usage, air pollution (from incineration), and water pollution (from landfilling).\n\n **\ud83d\udfe2 In this notebook, we will classify waste as organic or recyclable using Convolutional Neural Network (CNN).**"}}