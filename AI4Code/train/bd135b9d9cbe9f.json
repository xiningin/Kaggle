{"cell_type":{"4847b795":"code","d37e1815":"code","63ecb877":"code","597e9101":"code","ca4c3451":"code","63543ae0":"code","386a5f04":"code","7f78ae88":"code","d92d3910":"code","b0095cd3":"code","4774a9fa":"code","9373bd15":"code","f333cb54":"code","e71a0cbc":"code","20f7fb57":"code","01b2796f":"code","8e3b4ac3":"code","15b8b288":"code","c076281f":"code","5caef3d1":"code","24ae199b":"code","c6e0e8c4":"code","6450e985":"code","3d9ba821":"code","f02f20c8":"code","30a2c981":"code","b00593f6":"code","28ad7ac5":"code","c925092b":"code","2afe4c6e":"code","ad4fa95f":"code","67ca6d12":"code","c8e42ce8":"code","6f1ae71b":"code","8dc4f4d5":"code","23091d74":"code","77835d1b":"code","edd70929":"code","acee3094":"code","b3e3f84c":"code","1d89b479":"code","f1042dfe":"code","bf5bada4":"code","9e4b6a3c":"code","0139d510":"code","f00fdff2":"code","18e8d247":"code","e8c28b77":"code","f63bb596":"code","d1844f4e":"code","b5c2a721":"code","bb2397c2":"code","97c587b5":"markdown","7534403c":"markdown","2566339f":"markdown","8bf10527":"markdown","de05b08c":"markdown","5af754c0":"markdown","3a70edf9":"markdown","ab801434":"markdown","99545d1f":"markdown","a01cc31c":"markdown","aedcfd45":"markdown","9dacb6f3":"markdown","03a94c90":"markdown","34268b2b":"markdown","04484df3":"markdown","7d0ec7c7":"markdown","4a4b7497":"markdown","44d9c61c":"markdown","fce6b23f":"markdown","0522197d":"markdown","d689b0d2":"markdown","d5bab8f6":"markdown","2d999a99":"markdown","5b2381c9":"markdown","36db5953":"markdown","dae62a2e":"markdown","9480346e":"markdown","4868f049":"markdown","1e573c92":"markdown","0289092c":"markdown","a0c1c2df":"markdown","702a9884":"markdown","74940c12":"markdown","e1facfda":"markdown","d268f4d9":"markdown","8b191ca5":"markdown","96d82b4e":"markdown","2c4f0a6c":"markdown","90e95026":"markdown","880831cc":"markdown","c85ed5db":"markdown","4b34d116":"markdown","74dccf20":"markdown","58cf81df":"markdown"},"source":{"4847b795":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport torch\nimport torchaudio\nimport matplotlib.pyplot as plt\n\nimport IPython.display as ipd\n\n\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\nfrom os import path\n\n\n\n%matplotlib inline","d37e1815":"!pip install tinytag","63ecb877":"DATA_PATH = '..\/input\/birdsong-recognition\/'\nAUDIO_PATH = \"..\/input\/birdsong-recognition\/train_audio\"","597e9101":"display(ipd.Audio('..\/input\/birdsong-recognition\/train_audio\/aldfly\/XC134874.mp3'))","ca4c3451":"display(ipd.Audio('..\/input\/birdsong-recognition\/train_audio\/ameavo\/XC133080.mp3'))","63543ae0":"display(ipd.Audio('..\/input\/birdsong-recognition\/train_audio\/amebit\/XC127371.mp3'))","386a5f04":"df_train = pd.read_csv(DATA_PATH + 'train.csv')","7f78ae88":"df_train.head()","d92d3910":"species_count = df_train['ebird_code'].value_counts(sort=True)\nspecies_count = species_count[250:]\nplt.figure(figsize=(15,7))\nsns.barplot(species_count.index,species_count.values,palette=(\"Blues_d\"), alpha=0.85)\nplt.title('Birds species distribution', fontsize=18)\nplt.ylabel('Number of Occurrences', fontsize=12)\nplt.xlabel('Birds code', fontsize=12)\nplt.show()","b0095cd3":"print('Minimum samples per category = ', min(df_train.ebird_code.value_counts()))\nprint('Maximum samples per category = ', max(df_train.ebird_code.value_counts()))","4774a9fa":"print(\"Total number of labels: \",len(df_train['ebird_code'].value_counts()))\nprint(\"Labels: \", df_train['ebird_code'].unique())","9373bd15":"from wordcloud import WordCloud\nwordcloud = WordCloud(background_color=\"white\", max_font_size=50, width=800, height=500, collocations=False, max_words=200).generate(' '.join(df_train['ebird_code']))\nplt.figure(figsize=(18,10))\nplt.imshow(wordcloud, cmap=plt.cm.gray)\nplt.title(\"Wordcloud for Labels in Train Curated\", fontsize=25)\nplt.axis(\"off\")\nplt.show()","f333cb54":"playback_used_count  = df_train['playback_used'].value_counts(sort=True)\nplayback_used_count = playback_used_count[:10]\nplt.figure(figsize=(15,7))\nsns.barplot(playback_used_count.index,playback_used_count.values,palette=(\"Blues_d\"), alpha=0.85)\nplt.title('Playback_used distribution', fontsize=18)\nplt.ylabel('Number of Occurrences', fontsize=12)\nplt.xlabel('Playback_used', fontsize=12)\nplt.show()","e71a0cbc":"print('Minimum samples per category = ', min(df_train.playback_used.value_counts()))\nprint('Maximum samples per category = ', max(df_train.playback_used.value_counts()))","20f7fb57":"channels_count  = df_train['channels'].value_counts(sort=True)\nchannels_count = channels_count[:10]\nplt.figure(figsize=(15,7))\nsns.barplot(channels_count.index,channels_count.values,palette=(\"Blues_d\"), alpha=0.85)\nplt.title('Channels distribution', fontsize=18)\nplt.ylabel('Number of Occurrences', fontsize=12)\nplt.xlabel('Channels', fontsize=12)\nplt.show()","01b2796f":"print('Minimum samples per category = ', min(df_train.channels.value_counts()))\nprint('Maximum samples per category = ', max(df_train.channels.value_counts()))","8e3b4ac3":"date_count  = df_train['date'].value_counts(sort=True)\ndate_count = date_count[:10]\nplt.figure(figsize=(15,7))\nsns.barplot(date_count.index,date_count.values,palette=(\"Blues_d\"), alpha=0.85)\nplt.title('Date distribution', fontsize=18)\nplt.ylabel('Number of Occurrences', fontsize=12)\nplt.xlabel('Date', fontsize=12)\nplt.show()","15b8b288":"print('Minimum samples per category = ', min(df_train.date.value_counts()))\nprint('Maximum samples per category = ', max(df_train.date.value_counts()))","c076281f":"pitch_count  = df_train['pitch'].value_counts(sort=True)\npitch_count = pitch_count[:10]\nplt.figure(figsize=(15,7))\nsns.barplot(pitch_count.index,pitch_count.values,palette=(\"Blues_d\"), alpha=0.85)\nplt.title('Pitch distribution', fontsize=18)\nplt.ylabel('Number of Occurrences', fontsize=12)\nplt.xlabel('Pitch', fontsize=12)\nplt.show()","5caef3d1":"print('Minimum samples per category = ', min(df_train.pitch.value_counts()))\nprint('Maximum samples per category = ', max(df_train.pitch.value_counts()))","24ae199b":"duration_count  = df_train['duration'].value_counts(sort=True)\nduration_count = duration_count[:30]\nplt.figure(figsize=(15,7))\nsns.barplot(duration_count.index,duration_count.values,palette=(\"Blues_d\"), alpha=0.85)\nplt.title('Duration distribution', fontsize=18)\nplt.ylabel('Number of Occurrences', fontsize=12)\nplt.xlabel('Duration', fontsize=12)\nplt.show()","c6e0e8c4":"print('Minimum samples per category = ', min(df_train.duration.value_counts()))\nprint('Maximum samples per category = ', max(df_train.duration.value_counts()))","6450e985":"speed_count  = df_train['speed'].value_counts(sort=True)\nspeed_count = speed_count[:10]\nplt.figure(figsize=(15,7))\nsns.barplot(speed_count.index,speed_count.values,palette=(\"Blues_d\"), alpha=0.85)\nplt.title('Speed distribution', fontsize=18)\nplt.ylabel('Number of Occurrences', fontsize=12)\nplt.xlabel('Speed', fontsize=12)\nplt.show()","3d9ba821":"print('Minimum samples per category = ', min(df_train.speed.value_counts()))\nprint('Maximum samples per category = ', max(df_train.speed.value_counts()))","f02f20c8":"type_count  = df_train['type'].value_counts(sort=True)\ntype_count = type_count[:10]\nplt.figure(figsize=(15,7))\nsns.barplot(type_count.index,type_count.values,palette=(\"Blues_d\"), alpha=0.85)\nplt.title('Type distribution', fontsize=18)\nplt.ylabel('Number of Occurrences', fontsize=12)\nplt.xlabel('Type', fontsize=12)\nplt.show()","30a2c981":"print('Minimum samples per category = ', min(df_train.type.value_counts()))\nprint('Maximum samples per category = ', max(df_train.type.value_counts()))","b00593f6":"sampling_rate_count  = df_train['sampling_rate'].value_counts(sort=True)\nplt.figure(figsize=(15,7))\nsns.barplot(sampling_rate_count.index,sampling_rate_count.values,palette=(\"Blues_d\"), alpha=0.85)\nplt.title('Sampling rate distribution', fontsize=18)\nplt.ylabel('Number of Occurrences', fontsize=12)\nplt.xlabel('Rate (Hz)', fontsize=12)\nplt.show()","28ad7ac5":"print('Minimum samples per category = ', min(df_train.sampling_rate.value_counts()))\nprint('Maximum samples per category = ', max(df_train.sampling_rate.value_counts()))","c925092b":"elevation_count  = df_train['elevation'].value_counts(sort=True)\nelevation_count = elevation_count[:10]\nplt.figure(figsize=(15,7))\nsns.barplot(elevation_count.index,elevation_count.values,palette=(\"Blues_d\"), alpha=0.85)\nplt.title('Elevation distribution', fontsize=18)\nplt.ylabel('Number of Occurrences', fontsize=12)\nplt.xlabel('Elevation', fontsize=12)\nplt.show()","2afe4c6e":"print('Minimum samples per category = ', min(df_train.elevation.value_counts()))\nprint('Maximum samples per category = ', max(df_train.elevation.value_counts()))","ad4fa95f":"bitrate_of_mp3_count  = df_train['bitrate_of_mp3'].value_counts(sort=True)\nbitrate_of_mp3_count = bitrate_of_mp3_count[:10]\nplt.figure(figsize=(15,7))\nsns.barplot(bitrate_of_mp3_count.index,bitrate_of_mp3_count.values,palette=(\"Blues_d\"), alpha=0.85)\nplt.title('Bitrate_of_mp3 distribution', fontsize=18)\nplt.ylabel('Number of Occurrences', fontsize=12)\nplt.xlabel('Bitrate_of_mp3', fontsize=12)\nplt.show()","67ca6d12":"print('Minimum samples per category = ', min(df_train.bitrate_of_mp3.value_counts()))\nprint('Maximum samples per category = ', max(df_train.bitrate_of_mp3.value_counts()))","c8e42ce8":"country_count  = df_train['country'].value_counts(sort=True)\ncountry_count = country_count[:10]\nplt.figure(figsize=(15,7))\nsns.barplot(country_count.index,country_count.values,palette=(\"Blues_d\"), alpha=0.85)\nplt.title('Countries distribution', fontsize=18)\nplt.ylabel('Number of Occurrences', fontsize=12)\nplt.xlabel('Country', fontsize=12)\nplt.show()","6f1ae71b":"print('Minimum samples per category = ', min(df_train.country.value_counts()))\nprint('Maximum samples per category = ', max(df_train.country.value_counts()))","8dc4f4d5":"recordist_count  = df_train['recordist'].value_counts(sort=True)\nrecordist_count = recordist_count[:10]\nplt.figure(figsize=(15,7))\nsns.barplot(recordist_count.index,recordist_count.values,palette=(\"Blues_d\"), alpha=0.85)\nplt.title('Recordists distribution', fontsize=18)\nplt.ylabel('Number of Occurrences', fontsize=12)\nplt.xlabel('Recordists', fontsize=12)\nplt.show()","23091d74":"print('Minimum samples per category = ', min(df_train.recordist.value_counts()))\nprint('Maximum samples per category = ', max(df_train.recordist.value_counts()))","77835d1b":"df_test = pd.read_csv(DATA_PATH + 'test.csv')","edd70929":"df_test.head()","acee3094":"ex_test_summary = pd.read_csv(DATA_PATH + 'example_test_audio_summary.csv')","b3e3f84c":"ex_test_summary.head()","1d89b479":"ex_test_meta = pd.read_csv(DATA_PATH + 'example_test_audio_metadata.csv')","f1042dfe":"ex_test_meta.head()","bf5bada4":"files = folders = 0\nFolderList = []\nfor _, dirnames, filenames in os.walk(AUDIO_PATH):\n    files += len(filenames)\n    folders += len(dirnames)\n    FolderList.append(dirnames)\n        \nprint(\"There are {:,} files, and {:,} folders\".format(files, folders))","9e4b6a3c":"from tinytag import TinyTag","0139d510":"tag = TinyTag.get(AUDIO_PATH + \"\/aldfly\/XC134874.mp3\", image=True)","f00fdff2":"print('album:',tag.album)\nprint('album artist:',tag.albumartist) # album artist\nprint('artist name:',tag.artist)       # artist name\nprint('number of bytes before audio data begins:',tag.audio_offset)  # number of bytes before audio data begins\nprint('bitrate in kBits\/s:',tag.bitrate) # bitrate in kBits\/s\nprint('file comment', tag.comment)     # file comment\nprint('composer', tag.composer)        # composer\nprint('disc number', tag.disc)         # disc number\nprint('total number of discs',tag.disc_total)    # total number of discs\nprint('duration of the song in seconds', tag.duration)      # duration of the song in seconds\nprint('file size in bytes', tag.filesize)      # file size in bytes\nprint('genre', tag.genre)              # genre\nprint('samples per second', tag.samplerate)    # samples per second\nprint('title of the song', tag.title)  # title of the song\nprint('track number', tag.track)       # track number\nprint('total number of tracks', tag.track_total)     # total number of tracks\nprint('year or data', tag.year)        # year or data","18e8d247":"from IPython.display import Audio\nfrom matplotlib import pyplot as plt\nimport torchaudio\nimport torch\n\nimport librosa\nimport librosa.display","e8c28b77":"%%time\nfilename = \"..\/input\/birdsong-recognition\/train_audio\/aldfly\/XC134874.mp3\"\n\nwaveform, sample_rate = torchaudio.load(filename)\n\nplt.plot(waveform.t().numpy())","f63bb596":"%%time\nx,sr = librosa.load('..\/input\/birdsong-recognition\/train_audio\/aldfly\/XC134874.mp3')\nlibrosa.display.waveplot(x, sr=sr)","d1844f4e":"librosa.feature.melspectrogram(x, sr=sample_rate, n_mels=128)","b5c2a721":"%%time\nfig, ax = plt.subplots(1, 2, figsize=(16, 12))\n\nax[0].imshow(torchaudio.transforms.Spectrogram(n_fft=2000)(waveform).log2()[0,:,:].numpy(), cmap='ocean');\nax[0].set_title('Spectrogram');\nax[1].imshow(torchaudio.transforms.MelSpectrogram(n_fft=16000)(waveform).log2()[0].numpy(), cmap='inferno');\nax[1].set_title('MelSpectrogram');","bb2397c2":"%%time\nX = librosa.stft(x)\nXdb = librosa.amplitude_to_db(abs(X))\nplt.figure(figsize=(14, 5))\nlibrosa.display.specshow(Xdb, sr=sr, x_axis='time', y_axis='hz')\nplt.colorbar()","97c587b5":"<h1>Explore train data<\/h1>","7534403c":"<h3>Visualization of \"date\"<\/h3>","2566339f":"<div style=\"display:flex\">\n    <div>\n        <a href=\"https:\/\/ebird.org\/species\/aldfly\"><img src=\"https:\/\/i.ibb.co\/9VJTLsC\/160820341.jpg\" alt=\"160820341\" border=\"0\" width=400px><\/a>\n    <\/div>\n    <div style=\"margin-left:20px\">\n        <h1>Aldfly<\/h1>\n        <h2>Description<\/h2>\n        <p style=\"width:500px; font-size:14px\">Small flycatcher, extremely similar to several other species. Prefers clearings and boggy areas, often with patches of alders. Grayish-olive above and pale below with thin white eyering. Wings dark with bold white wingbars. Nearly identical to Willow Flycatcher; once considered the same species. Also compare with Least Flycatcher, which is very similar but has slightly shorter wingtips and a bolder eyering. Best identified by voice: song is a rolling, rough \"freeBEER;\" call is a clear \"pip.\" Silent birds, especially in migration, often best left unidentified.<\/p>\n    <\/div>\n<\/div>\n","8bf10527":"<hr>","de05b08c":"<h3>Torchaudio wavelpot<\/h3>","5af754c0":"<h3>Librosa wavelpot<\/h3>","3a70edf9":"<h3>Compare time of plotting with librosa and torchaudio<\/h3>","ab801434":"<h3>Torchaudio Spectogram and MelSpectogram<\/h3>","99545d1f":"<h3>Visualization of \"elevation\"<\/h3>","a01cc31c":"<hr>","aedcfd45":"<h1 style=\"text-align:center;font-size:46px\">Cornell Birdcall Identification EDA<\/h1>\n\n<a href=\"https:\/\/imgbb.com\/\"><img src=\"https:\/\/i.ibb.co\/5Y96jpx\/What-the-BIRD.png\" alt=\"What-the-BIRD\"><\/a>","9dacb6f3":"**Just have to have a look what is inside \"example_test_audio_metadata.csv\"**","03a94c90":"<h3>Word cloud viz for ebird_code<\/h3>","34268b2b":"<hr>","04484df3":"<h3>Visualization of \"recordist\"<\/h3>","7d0ec7c7":"<h3>Visualization of \"channels\"<\/h3>","4a4b7497":"<hr>","44d9c61c":"<h3>Visualization of \"speed\"<\/h3>","fce6b23f":"<h3>Visualization of \"pitch\"<\/h3>","0522197d":"<hr>","d689b0d2":"**Let's check what is in 'test.csv'**","d5bab8f6":"<h3>Extracting metadata straight from the file<\/h3>","2d999a99":"<h3>Visualization of \"playback_used\"<\/h3>","5b2381c9":"<h1>Plotting spectrograms<\/h1> ","36db5953":"<div style=\"display:flex\">\n    <div>\n       <a href=\"https:\/\/ebird.org\/species\/Amebit\"><img src=\"https:\/\/i.ibb.co\/m86C9nq\/37758621.jpg\" alt=\"37758621\" border=\"0\" width=400px><\/a> \n    <\/div>\n    <div style=\"margin-left:20px\">\n        <h1>Amebit<\/h1>\n        <h2>Description<\/h2>\n        <p style=\"width:500px; font-size:14px\">Stocky, brown heron found in marshes and bogs; secretive but occasionally found in the open. Most similar to juvenile night-herons. Note striped neck, plain unspotted wings, and behavior: American Bittern does not typically perch on branches. Varied diet includes fish, frogs, insects, and small mammals. Most active around dawn and dusk flying low over extensive marshes. Listen for its incredible vocalization: a resonant, booming noise produced by air sacs on the neck, \"oonk-GA-loonk.<\/p>\n    <\/div>\n<\/div>","dae62a2e":"<hr>","9480346e":"<div style=\"display:flex\">\n    <div>\n         <a href=\"https:\/\/ebird.org\/species\/Ameavo\"><img src=\"https:\/\/i.ibb.co\/HzgXmcK\/64807071.jpg\" alt=\"64807071\" border=\"0\" width=400px><\/a>\n    <\/div>\n    <div style=\"margin-left:20px\">\n        <h1>Ameavo<\/h1>\n        <h2>Description<\/h2>\n        <p style=\"width:500px; font-size:14px\">Distinctive large shorebird with a long, thin upturned bill and lean neck. Bold black-and-white wings prominent year-round. Adults in summer have buffy-orange wash on head. Frequents wetlands where it swings its head back-and-forth in shallow water to catch small invertebrates.<\/p>\n    <\/div>\n<\/div>","4868f049":"<h3>Visualization of \"bitrate_of_mp3\"<\/h3>","1e573c92":"<h3>Visualization of \"country\"<\/h3>","0289092c":"<h2>Visualization of \"ebird_code\"<\/h2>","a0c1c2df":"**Let's count check folders and files structure**\n","702a9884":"<h1>Checking other files<\/h1>","74940c12":"<hr>","e1facfda":"File from \"aldfly\/XC134874.mp3\" as an example","d268f4d9":"<h3>Visualization of \"sampling_rate\"<\/h3>","8b191ca5":"<h3>Visualization of \"type\"<\/h3>","96d82b4e":"<hr>","2c4f0a6c":"<hr>","90e95026":"<hr>","880831cc":"**Just have to have a look what is inside \"example_test_audio_summary.csv\"**","c85ed5db":"<hr>","4b34d116":"<hr>\n","74dccf20":"<h3>Visualization of \"duration\"<\/h3>","58cf81df":"<hr>"}}