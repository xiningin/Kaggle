{"cell_type":{"1fa99f72":"code","3311abd9":"code","d6fe7d6e":"code","51225c91":"code","fd54d28e":"code","11d20d7d":"code","75eace54":"code","06cd9387":"code","e9267d97":"code","3e671a29":"code","c3dd046a":"code","d2cd29e8":"code","3cafd8f6":"code","c2898a47":"code","b12e755e":"code","d6826be4":"code","6576eb2c":"code","c219be80":"code","81832302":"code","562d5f9f":"code","98ac7ddd":"code","9a5b6191":"markdown","3e447edb":"markdown","1059996a":"markdown","41f7d84a":"markdown","858d8225":"markdown","3f5a350c":"markdown","e4f0c22f":"markdown","9d8e1104":"markdown","96a4acbd":"markdown","ffeb92c7":"markdown","e2a5fc9e":"markdown"},"source":{"1fa99f72":"import os\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport datetime as dt\nimport matplotlib.pyplot as plt\n%matplotlib inline\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import mean_squared_error","3311abd9":"train = '..\/input\/train.csv'\ntest = '..\/input\/test.csv'\ndfTrain = pd.read_csv(train)\ndfTest = pd.read_csv(test)","d6fe7d6e":"dfTrain.head()","51225c91":"dfTest.head()","fd54d28e":"dfTrain.isna().sum()","11d20d7d":"dfTest.isna().sum()","75eace54":"plt.subplots(figsize=(18,7))\nplt.title(\"Outliers de train.csv\")\ndfTrain.boxplot();","06cd9387":"print(dfTrain.loc[dfTrain['trip_duration'] > 350000])","e9267d97":"print(f\"{dfTrain.shape}\")\ndfTrain = dfTrain.loc[dfTrain['trip_duration']< 350000]\nprint(f\"{dfTrain.shape}\")","3e671a29":"sns.heatmap(dfTrain.corr())","c3dd046a":"dfTrain = dfTrain[dfTrain['passenger_count']>= 1]","d2cd29e8":"dfTrain['pickup_datetime'] = pd.to_datetime(dfTrain['pickup_datetime'])\ndfTest['pickup_datetime'] = pd.to_datetime(dfTest['pickup_datetime'])\n\ndfTrain['month'] = dfTrain['pickup_datetime'].dt.month\ndfTrain['day'] = dfTrain['pickup_datetime'].dt.day\ndfTrain['weekday'] = dfTrain['pickup_datetime'].dt.weekday\ndfTrain['hour'] = dfTrain['pickup_datetime'].dt.hour\ndfTrain['minute'] = dfTrain['pickup_datetime'].dt.minute\n\ndfTest['month'] = dfTest['pickup_datetime'].dt.month\ndfTest['day'] = dfTest['pickup_datetime'].dt.day\ndfTest['weekday'] = dfTest['pickup_datetime'].dt.weekday\ndfTest['hour'] = dfTest['pickup_datetime'].dt.hour\ndfTest['minute'] = dfTest['pickup_datetime'].dt.minute\n\ndfTrain['trip_duration'] = np.log1p(dfTrain['trip_duration'].values)\n\ndfTrain.head()","3cafd8f6":"dfTrain.columns","c2898a47":"selection_train = [\"passenger_count\", \"pickup_longitude\", \"pickup_latitude\", \"dropoff_longitude\",\"dropoff_latitude\",\"month\", \"day\", \"weekday\", \"hour\", \"minute\"]\nselection_test = [\"passenger_count\", \"pickup_longitude\", \"pickup_latitude\", \"dropoff_longitude\",\"dropoff_latitude\", \"month\", \"day\", \"weekday\", \"hour\", \"minute\"]\ny_train = dfTrain[\"trip_duration\"]\nX_train = dfTrain[selection_train] \nX_test = dfTest[selection_test]","b12e755e":"y_train.head()","d6826be4":"print(\"Training ...\")\nm = RandomForestRegressor()\nm.fit(X_train, y_train)\n#m1.fit(XdfTrain, YdfTrain)\n#m2.fit(XdfTrain, YdfTrain)\n%timeit\nprint('Done!!!')","6576eb2c":"pred = m.predict(X_test)\nprint('Done!!!')","c219be80":"pred = np.expm1(pred)","81832302":"my_submission = pd.DataFrame({'id':dfTest.id, 'trip_duration':pred})","562d5f9f":"my_submission.head(10)","98ac7ddd":"my_submission.to_csv(\"my_submission.csv\", index=False)\nprint(\"Done!!!\")","9a5b6191":"### Correlation check ","3e447edb":"## Training","1059996a":"#### Aucune correlation apparente","41f7d84a":"### Predictions","858d8225":"# 1 - Data Loading","3f5a350c":"# Import Libraires ","e4f0c22f":"### Submission","9d8e1104":"# 2 - Data Exploration","96a4acbd":"#### On a 4 outliers dans trip_duration, on peut se permettre de les effac\u00e9s des (1458644) donn\u00e9es du dataset","ffeb92c7":"## Machine Learning","e2a5fc9e":"## Outlier's distribution"}}