{"cell_type":{"feb3cc61":"code","2a500bbd":"code","e1b95b53":"code","40b91121":"code","d614533b":"code","53f18dad":"code","090f94dc":"code","afed223c":"code","900831c6":"code","0abdb6a4":"code","05dc4fac":"code","fcf96de4":"code","a7b1f297":"code","6847fa84":"code","b914f4a9":"code","a6a60b0c":"code","cd30ad52":"code","2f40ecb3":"code","74e56af4":"code","acbb20a4":"code","262d549d":"code","97e6f2b6":"code","64c4b5b4":"code","fce7ad5c":"code","c3baa13a":"code","320a1e97":"markdown","38ffebac":"markdown","be31d10b":"markdown","66c7e2e3":"markdown","88f00536":"markdown","33cd123e":"markdown","34533420":"markdown","3590b238":"markdown","2d029a06":"markdown"},"source":{"feb3cc61":"import numpy as np\nimport pandas as pd\nimport networkx as nx\nimport matplotlib.pyplot as plt","2a500bbd":"pd.read_csv('\/kaggle\/input\/bible\/bible_databases-master\/bible_databases-master\/csv\/t_kjv.csv').head()","e1b95b53":"book_keys = pd.read_csv('\/kaggle\/input\/bible\/bible_databases-master\/bible_databases-master\/csv\/key_english.csv')\nbook_keys","40b91121":"pd.read_csv('\/kaggle\/input\/bible\/bible_databases-master\/bible_databases-master\/csv\/key_genre_english.csv')","d614533b":"with open('\/kaggle\/input\/bible\/bible_databases-master\/bible_databases-master\/cross_references.txt') as myfile:\n    head = [next(myfile) for x in range(10)]\nprint(head)","53f18dad":"cross_references = pd.read_csv('\/kaggle\/input\/bible\/bible_databases-master\/bible_databases-master\/cross_references.txt', sep='\\t', lineterminator='\\n', comment='#')\ncross_references.head()","090f94dc":"cross_references = cross_references.iloc[:,:-1] # drop last column\ncross_references['from_book'] = cross_references['From Verse'].apply(lambda x: x.split('.')[0])\ncross_references['to_book'] = cross_references['To Verse'].apply(lambda x: x.split('.')[0])\ncross_references.head()","afed223c":"abbreviations = pd.read_csv('\/kaggle\/input\/bible\/bible_databases-master\/key_abbreviations_english.csv')\nabbreviations","900831c6":"cross_references.hist(\"Votes\", bins=100)","0abdb6a4":"cross_references.groupby([\"from_book\", \"to_book\"]).sum().reset_index()","05dc4fac":"G=nx.from_pandas_edgelist(cross_references.groupby([\"from_book\", \"to_book\"]).sum().reset_index(), 'from_book', 'to_book', edge_attr='Votes', create_using=nx.DiGraph())\nnodes = list(G.nodes(data=True))\nedges = list(G.edges(data=True))","fcf96de4":"def sorter(value):\n    if value == \"Eccl\":\n        return 21\n    if value == \"Jonah\":\n        return 32\n    if value == \"Mark\":\n        return 41\n    if value == \"Phlm\":\n        return 57\n    if value == \"Luke\":\n        return 42\n    if value == \"Ruth\":\n        return 8\n    selection = abbreviations[abbreviations[\"field.1\"]==value]\n    if len(selection) > 0:\n        return selection[\"field.2\"].iloc[0]\n    else:\n        return 999","a7b1f297":"nodes = sorted(nodes, key=lambda x: sorter(x[0]))\nG=nx.Graph()\nG.add_nodes_from(nodes)\nG.add_edges_from(edges)\nedge_votes = [i['Votes']\/1000 for i in dict(G.edges).values()]","6847fa84":"book_keys[book_keys[\"field\"]==sorter(\"Gen\")]","b914f4a9":"color_map = []\nfor node in G:\n    selection = book_keys[book_keys[\"field\"]==sorter(node)]\n    if len(selection) > 0:\n        if selection[\"field.2\"].iloc[0] == \"OT\":\n            color_map.append('orange')\n        else:\n            color_map.append('green')\n    else: \n        color_map.append('green')","a6a60b0c":"plt.figure(figsize=(15, 15))\noptions = {\n    \"node_color\": \"orange\",\n    \"node_color\": color_map,\n    \"node_size\": 1100,\n    \"edge_color\": \"gray\",\n    \"linewidths\": 0,\n    \"width\": edge_votes,\n    \"with_labels\": True,\n    \"alpha\": 0.9,\n    \"pos\": nx.circular_layout(G)\n}\nnx.draw(G, **options)","cd30ad52":"plt.figure(figsize=(15, 15))\noptions = {\n    \"node_color\": \"orange\",\n    \"node_color\": color_map,\n    \"node_size\": 1100,\n    \"edge_color\": \"gray\",\n    \"linewidths\": 0,\n    \"width\": edge_votes,\n    \"with_labels\": True,\n    \"alpha\": 0.9,\n    \"pos\": nx.kamada_kawai_layout(G)\n}\nnx.draw(G, **options)","2f40ecb3":"plt.figure(figsize=(15, 15))\noptions = {\n    \"node_color\": \"orange\",\n    \"node_color\": color_map,\n    \"node_size\": 1100,\n    \"edge_color\": \"gray\",\n    \"linewidths\": 0,\n    \"width\": edge_votes,\n    \"with_labels\": True,\n    \"alpha\": 0.9,\n    \"pos\": nx.spring_layout(G)\n}\nnx.draw(G, **options)","74e56af4":"p_dict = nx.pagerank(G, weight=\"Votes\")\npd.DataFrame.from_dict({k: v for k, v in sorted(p_dict.items(), key=lambda item: -item[1])}, orient='index').head(n=20)","acbb20a4":"grouped = cross_references.groupby([\"To Verse\"])[\"Votes\"].sum().reset_index()\ngrouped.sort_values(\"Votes\", ascending=False).head(n=10)","262d549d":"grouped = cross_references.groupby([\"To Verse\"])[\"From Verse\"].count().reset_index()\ngrouped.sort_values(\"From Verse\", ascending=False).head(n=10)","97e6f2b6":"grouped = cross_references.groupby([\"From Verse\"])[\"Votes\"].sum().reset_index()\ngrouped.sort_values(\"Votes\", ascending=False).head(n=10)","64c4b5b4":"grouped = cross_references.groupby([\"From Verse\"])[\"To Verse\"].count().reset_index()\ngrouped.sort_values(\"To Verse\", ascending=False).head(n=10)","fce7ad5c":"g=nx.from_pandas_edgelist(cross_references, \"From Verse\", \"To Verse\", edge_attr='Votes')\np_dict = nx.pagerank(g, weight=\"Votes\")","c3baa13a":"pd.DataFrame.from_dict({k: v for k, v in sorted(p_dict.items(), key=lambda item: -item[1])}, orient='index').head(n=20)","320a1e97":"## Top 10 Most Referencing Verses by Votes Sum","38ffebac":"## PageRank Analysis of Books","be31d10b":"## Top 10 Most Referencing Verses by Count","66c7e2e3":"# 1. Basic Data Discovery","88f00536":"# 3. Analysis of References Between Verses","33cd123e":"## Top 10 Most Referenced Verses by Count","34533420":"# 2. Analysis of References Between Books","3590b238":"## PageRank Analysis of Verses","2d029a06":"## Top 10 Most Referenced Verses by Votes Sum"}}