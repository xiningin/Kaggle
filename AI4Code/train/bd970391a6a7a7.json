{"cell_type":{"02dbd920":"code","596fd952":"code","c712550a":"code","a0d84b24":"code","d03df1e9":"code","df95c77d":"code","bd1dc144":"code","6ead2fea":"code","80eea5a9":"code","01208dac":"code","008b1883":"markdown","0d9c236e":"markdown"},"source":{"02dbd920":"# Import the required modules\nimport numpy as np\nimport pandas as pd\nimport tensorflow as tf\nimport keras_preprocessing\nfrom keras_preprocessing import image\nfrom keras_preprocessing.image import ImageDataGenerator\nimport matplotlib.pyplot as plt","596fd952":"# COVID and Normal dataset directory\nBASIS_DIR = '\/kaggle\/input\/covid19-radiography-database\/COVID-19_Radiography_Dataset'\nCLASSES = [\"COVID\",  \"Normal\"]","c712550a":"#Image augmentation process:\ntrain_datagen = ImageDataGenerator(\n    rescale=1.\/255,\n    rotation_range=20,\n    horizontal_flip=True,\n    shear_range = 0.2,\n    zoom_range = 0.2,\n    width_shift_range=0.2,\n    height_shift_range=0.2,\n    fill_mode = 'nearest',\n    \n    #split dataset to training(80%) and validation(20%):\n    validation_split=0.2\n)","a0d84b24":"# Training dataset and Validation dataset:\ntrain_data = train_datagen.flow_from_directory(\n    directory=BASIS_DIR,\n    target_size=(299, 299),\n    batch_size=32,\n    shuffle=True,\n    class_mode='binary',\n    subset='training',\n    classes=CLASSES\n    )\nval_data = train_datagen.flow_from_directory(\n    directory=BASIS_DIR,\n    target_size=(299, 299),\n    batch_size=32,\n    shuffle=True,\n    class_mode='binary',\n    subset='validation',\n    classes=CLASSES\n    )","d03df1e9":"#Using sequential model:\nmodel = tf.keras.models.Sequential([\n    tf.keras.layers.Conv2D(32, (3,3), activation='relu', input_shape=(299, 299, 3)),\n    tf.keras.layers.MaxPooling2D(2, 2),\n\n    tf.keras.layers.Conv2D(32, (3,3), activation='relu'),\n    tf.keras.layers.MaxPooling2D(2,2),\n\n    tf.keras.layers.Conv2D(64, (3,3), activation='relu'),\n    tf.keras.layers.MaxPooling2D(2,2),\n    \n    tf.keras.layers.Conv2D(128, (3,3), activation='relu'),\n    tf.keras.layers.MaxPooling2D(2,2),\n\n    tf.keras.layers.Flatten(),\n    tf.keras.layers.Dense(128, activation='relu'),\n    tf.keras.layers.Dense(1, activation='sigmoid')\n])\n\nmodel.summary()","df95c77d":"# Compiling model with 'adam' optimizer loss function 'binary_crossentropy'\nmodel.compile(loss='binary_crossentropy',\n              optimizer=tf.optimizers.Adam(),\n              metrics=['accuracy']\n             )","bd1dc144":"# Training process:\nnumber_epochs = 3\n# You can change number_epochs above. But the bigger the value, the more time it takes for training\nhistory = model.fit(train_data, epochs=number_epochs, \n                    validation_data=val_data, verbose=2)","6ead2fea":"# Plotting training accuracy and validation accuracy\nplt.plot(history.history['accuracy'], 'r', label='Accuracy Training')\nplt.plot(history.history['val_accuracy'], 'b', label='Accuracy Validation')\nplt.title('Accuracy Training and Validation')\nplt.ylabel('Accuracy')\nplt.xlabel('Epoch')\nplt.legend(loc=0)\nplt.show()","80eea5a9":"# Plotting training loss and validation loss\nplt.plot(history.history['loss'], 'r', label='Loss Training')\nplt.plot(history.history['val_loss'], 'b', label='Loss Validation')\nplt.title('Loss Training and Validation')\nplt.ylabel('Loss')\nplt.xlabel('Epoch')\nplt.legend(loc=0)\nplt.show()","01208dac":"# Let's predict the image of the chest x-ray whether it's covid or normal\npath = \"..\/input\/covid19-radiography-database\/COVID-19_Radiography_Dataset\/Normal\/Normal-1.png\"\nimg = image.load_img(path, target_size=(299,299,3))\n\nimg = image.img_to_array(img)\/255\nimg = np.array([img])\nimg.shape\n\nresult = model.predict_classes(img)\nif result==[0]:\n    print(\"COVID\")\nelse:\n    print(\"NORMAL\")","008b1883":"Source dataset:\n\n-M.E.H. Chowdhury, T. Rahman, A. Khandakar, R. Mazhar, M.A. Kadir, Z.B. Mahbub, K.R. Islam, M.S. Khan, A. Iqbal, N. Al-Emadi, M.B.I. Reaz, M. T. Islam, \u201cCan AI help in screening Viral and COVID-19 pneumonia?\u201d IEEE Access, Vol. 8, 2020, pp. 132665 - 132676.\n-Rahman, T., Khandakar, A., Qiblawey, Y., Tahir, A., Kiranyaz, S., Kashem, S.B.A., Islam, M.T., Maadeed, S.A., Zughaier, S.M., Khan, M.S. and Chowdhury, M.E., 2020. Exploring the Effect of Image Enhancement Techniques on COVID-19 Detection using Chest X-ray Images.","0d9c236e":"It can be seen that the accuracy increases and the loss corresponds to the increase in epoch. You can change the number_epochs according to your needs."}}