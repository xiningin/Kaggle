{"cell_type":{"b546bea4":"code","ffd682a1":"code","09077ef1":"code","f1659bf8":"code","634c5800":"code","ca980447":"code","95b3c980":"markdown","d259cc0f":"markdown","8b73d73c":"markdown","bae852eb":"markdown","f197c11b":"markdown","0a4209f5":"markdown","4eb71090":"markdown"},"source":{"b546bea4":"import pandas as pd\n\ndata = pd.read_csv('..\/input\/titanic\/train.csv')\ntest = pd.read_csv('..\/input\/titanic\/test.csv')\ntest_ids = test[\"PassengerId\"]","ffd682a1":"def clean(data):\n    data = data.drop([\"Ticket\", \"PassengerId\", \"Name\", \"Cabin\"], axis=1)\n    \n    cols = [\"SibSp\", \"Parch\", \"Fare\", \"Age\"]\n    for col in cols:\n        data[col].fillna(data[col].median(), inplace=True)\n        \n    data.Embarked.fillna(\"U\", inplace=True)\n    return data\n\ndata = clean(data)\ntest = clean(test)","09077ef1":"from sklearn import preprocessing\nle = preprocessing.LabelEncoder()\ncolumns = [\"Sex\", \"Embarked\"]\n\nfor col in columns:\n    data[col] = le.fit_transform(data[col])\n    test[col] = le.transform(test[col])","f1659bf8":"from sklearn.linear_model import SGDClassifier\nfrom sklearn.model_selection import train_test_split\n\ny = data[\"Survived\"]\nX = data.drop(\"Survived\", axis=1)\n\nX_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.2, random_state=42)\n\nclf = SGDClassifier(loss=\"perceptron\", eta0=1, learning_rate=\"constant\", penalty=None).fit(X_train, y_train)","634c5800":"predictions = clf.predict(X_val)\nfrom sklearn.metrics import accuracy_score\naccuracy_score(y_val, predictions)","ca980447":"submission_preds = clf.predict(test)\n\ndf = pd.DataFrame({\"PassengerId\": test_ids.values,\n                   \"Survived\": submission_preds,\n                  })\ndf.to_csv(\"submission.csv\", index=False)","95b3c980":"**creating a submission file**","d259cc0f":"**evaluating the model**","8b73d73c":"# **Titanic**","bae852eb":"**building the model**","f197c11b":"**generating submission data**","0a4209f5":"**exploratory data analysis**","4eb71090":"**loading data**"}}