{"cell_type":{"88e6f6c3":"code","97919e4f":"code","a362b71f":"code","1f7c8345":"code","0ae18ba4":"code","9d357b34":"code","888fd78f":"code","1c15398a":"code","587e8519":"code","77a79105":"code","49ee610a":"code","b2faa025":"code","8345b2f8":"code","fbc1530b":"code","30003c65":"code","114cd7ac":"code","48baeca5":"code","cf38fc63":"markdown","0b347b12":"markdown","96536139":"markdown","db41cd6c":"markdown"},"source":{"88e6f6c3":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n#data visualization\nimport matplotlib.pyplot as plt\nimport seaborn as sns \n\n#clustering model library\nfrom sklearn.cluster import KMeans\nfrom scipy.cluster.hierarchy import linkage, dendrogram\nfrom sklearn.cluster import AgglomerativeClustering\n\nimport os\nprint(os.listdir(\"..\/input\"))","97919e4f":"#read data\ndata = pd.read_csv('..\/input\/Mall_Customers.csv')","a362b71f":"data.head()","1f7c8345":"data.info()","0ae18ba4":"print(pd.isnull(data).sum())","9d357b34":"data.describe()","888fd78f":"data.corr()","1c15398a":"plt.figure(figsize=(7,7))\nsns.heatmap(data.corr(), annot=True)\nplt.show()","587e8519":"labels = ['Male','Female']\nsizes = [data.query('Gender == \"Male\"').Gender.count(),data.query('Gender == \"Female\"').Gender.count()]\n#colors\ncolors = ['#ffdaB9','#66b3ff']\n#explsion\nexplode = (0.05,0.05)\nplt.figure(figsize=(8,8)) \nmy_circle=plt.Circle( (0,0), 0.7, color='white')\nplt.pie(sizes, colors = colors, labels=labels, autopct='%1.1f%%', startangle=90, pctdistance=0.85,explode=explode)\np=plt.gcf()\nplt.axis('equal')\np.gca().add_artist(my_circle)\nplt.show()","77a79105":"plt.figure(figsize=(20,10))\nsns.countplot(data.Age)\nplt.xlabel(\"Age\")\nplt.ylabel(\"Person Count\")\nplt.show()","49ee610a":"plt.figure(figsize=(20,7))\ngender = ['Male', 'Female']\nfor i in gender:\n    plt.scatter(x='Age',y='Annual Income (k$)', data=data[data['Gender']==i],s = 200 , alpha = 0.5 , label = i)\nplt.legend()\nplt.xlabel(\"Age\")\nplt.ylabel(\"Annual Income (k$)\")\nplt.title(\"Annual Income according to Age\")\nplt.show()","b2faa025":"plt.figure(figsize=(20,7))\ngender = ['Male', 'Female']\nfor i in gender:\n    plt.scatter(x='Age',y='Spending Score (1-100)', data=data[data['Gender']==i],s = 200 , alpha = 0.5 , label = i)\nplt.legend()\nplt.xlabel(\"Age\")\nplt.ylabel(\"Spending Score (1-100)\")\nplt.title(\"Spending Score according to Age\")\nplt.show()","8345b2f8":"plt.figure(figsize=(20,7))\ngender = ['Male', 'Female']\nfor i in gender:\n    plt.scatter(x='Annual Income (k$)',y='Spending Score (1-100)', data=data[data['Gender']==i],s = 200 , alpha = 0.5 , label = i)\nplt.legend()\nplt.xlabel(\"Annual Income (k$)\")\nplt.ylabel(\"Spending Score (1-100)\")\nplt.title(\"Spending Score according to Annual Income\")\nplt.show()","fbc1530b":"#define k value\nwcss = []\ndata_model = data.drop(['Gender','CustomerID'],axis=1)\nfor k in range(1,15):\n    kmeans = KMeans(n_clusters=k)\n    kmeans.fit(data_model)\n    wcss.append(kmeans.inertia_)\n\n# the best value is elbow value. It's 5.\nplt.figure(figsize=(15,5))\nplt.plot(range(1,15),wcss)\nplt.xlabel(\"number of k (cluster) value\")\nplt.ylabel(\"wcss\")\nplt.show()","30003c65":"#create model\nkmeans = KMeans(n_clusters=5)\ndata_predict = kmeans.fit_predict(data_model)\n\nplt.figure(figsize=(15,10))\nplt.scatter( x = 'Annual Income (k$)' ,y = 'Spending Score (1-100)' , data = data_model , c = data_predict , s = 200 )\nplt.xlabel(\"Annual Income (k$)\")\nplt.ylabel(\"Spending Score (1-100)\")\nplt.show()","114cd7ac":"#create demogram and find the best clustering value\nmerg = linkage(data_model,method=\"ward\")\nplt.figure(figsize=(25,10))\ndendrogram(merg,leaf_rotation = 90)\nplt.xlabel(\"data points\")\nplt.ylabel(\"euclidean distance\")\nplt.show()","48baeca5":"#create model\nhiyerartical_cluster = AgglomerativeClustering(n_clusters = 5,affinity= \"euclidean\",linkage = \"ward\")\ndata_predict = hiyerartical_cluster.fit_predict(data_model)\nplt.figure(figsize=(15,10))\nplt.scatter( x = 'Annual Income (k$)' ,y = 'Spending Score (1-100)' , data = data_model , c = data_predict , s = 200 )\nplt.show()","cf38fc63":"<a id=\"1\"><\/a>\n### Read and Explore Data","0b347b12":"# Market Segmentation with Clustering\n\nIt is important to define the customer profile. It allows customers to prepare campaigns and deliver them to the right customer. I tried to determine the correct customer profile by using clustering algorithms. I'm new to this. If you have a missing place, don't hesitate to comment. If you have a contribution please upvote!\n\n<img src=\"https:\/\/www.marketing91.com\/wp-content\/uploads\/2015\/02\/Increasing-hispanic-market-share-1024x588.jpg\" width=\"500px\" height=\"300px\"\/>\n\n\n#### CONTENT\n[1. Read and Explore Data](#1) <br\/>\n[2. Implement Clustering Algorithms](#2)","96536139":"<a id=\"2\"><\/a>\n### Implement Clustering Algorithms\n\n#### K-Means Clustering Algorithm","db41cd6c":"#### Hierarchical Clustering Algorithm"}}