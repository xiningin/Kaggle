{"cell_type":{"d42fa914":"code","dcab647d":"code","ff2460f2":"code","f7f3ffe1":"code","0ee21ea6":"code","9c0fbe3e":"code","1da77d29":"code","7b73edd2":"code","ffd9fd15":"code","dec180de":"code","06a01da8":"code","99b365cd":"code","73e15a73":"code","2b02ad7b":"markdown","a29c2e99":"markdown"},"source":{"d42fa914":"import pandas as pd\nimport numpy as np\nimport re","dcab647d":"df = pd.read_csv('..\/input\/best-books-of-the-21st-century-dataset\/Best_Book_21st.csv')","ff2460f2":"df.sample(5)","f7f3ffe1":"df.info()","0ee21ea6":"df.isnull().sum()","9c0fbe3e":"def rem_clean(row):\n    # remove [\\n,()] from text\n    try:\n        a = re.sub(\"\\n\",'', row)\n        a = re.sub(\",\",'', a)\n        a = re.sub(\"[()]\",'', a)\n        a = a.strip()\n        return a\n    except:\n        return None\n    \ndef award_count(row):\n    # Split award with ',' and count the length\n    try:\n        count = len(row.split(','))\n        return count\n    except:\n        return 0\n\ndef get_series_name(row):\n    try:\n        return (row.split('#')[0]).strip()\n    except:\n        return None\n\ndef get_series_num(row):\n    try:\n        return (row.split('#')[1]).strip()\n    except:\n        return None\n\ndef get_year(row):\n    try:\n        return re.findall('[0-9]{4}$', row)[0]\n    except:\n        return 'Unknown'\n\ndef rating(row):\n    try:\n        return re.sub(',','',row)\n    except:\n        return 0","1da77d29":"df['publisher'] = df['publisher'].apply(rem_clean)\ndf['series'] = df['series'].apply(rem_clean)\ndf['clean_title'] = df['title'].apply(lambda x: (re.sub(r'\\([^()]*\\)', '', x)).strip())\ndf['series_name'] = df['series'].apply(get_series_name)\ndf['series_num'] = df['series'].apply(get_series_num)\ndf['year_published'] = df['date_published'].apply(get_year)\ndf['total_award'] = df['award'].apply(award_count)\ndf['review_count'] = df['review_count'].apply(rating).astype('int64')\ndf['rating_count'] = df['rating_count'].apply(rating).astype('int64')\ndf['author'] = df['author'].fillna('Unknown')\ndf['rate'] = df['rate'].fillna(0)","7b73edd2":"new_df = df[['clean_title','series_name','series_num','author','genre','date_published',\n             'year_published','publisher','num_of_page','lang','review_count','rating_count',\n             'rate','award','total_award']]","ffd9fd15":"new_df.sample(5)","dec180de":"# Drop duplicate book\nnew_df.drop_duplicates(subset=['clean_title','series_name','series_num','author','publisher'],inplace=True)","06a01da8":"new_df.to_csv('BestBookOf21Century.csv',index=False)","99b365cd":"from IPython.core.display import display, HTML\ndisplay(HTML(\"<div class='tableauPlaceholder' id='viz1638350585321' style='position: relative'><noscript><a href='#'><img alt='Best Book Of 21st Century Analysis ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Be&#47;BestBookOf21stCenturyAnalysis&#47;Story1&#47;1_rss.png' style='border: none' \/><\/a><\/noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/> <param name='embed_code_version' value='3' \/> <param name='site_root' value='' \/><param name='name' value='BestBookOf21stCenturyAnalysis&#47;Story1' \/><param name='tabs' value='no' \/><param name='toolbar' value='yes' \/><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Be&#47;BestBookOf21stCenturyAnalysis&#47;Story1&#47;1.png' \/> <param name='animate_transition' value='yes' \/><param name='display_static_image' value='yes' \/><param name='display_spinner' value='yes' \/><param name='display_overlay' value='yes' \/><param name='display_count' value='yes' \/><param name='language' value='en-US' \/><param name='filter' value='publish=yes' \/><\/object><\/div>                <script type='text\/javascript'>                    var divElement = document.getElementById('viz1638350585321');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>\"))","73e15a73":"print('You can see the visualization here')\ndisplay(HTML(\"<a href='https:\/\/public.tableau.com\/views\/BestBookOf21stCenturyAnalysis\/Story1?:language=en-US&publish=yes&:display_count=n&:origin=viz_share_link'>Click Here<\/a>\"))\n","2b02ad7b":"# Cleaning & Feature Engineering","a29c2e99":"# Visualization"}}