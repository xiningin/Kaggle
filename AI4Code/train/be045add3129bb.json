{"cell_type":{"c2b79478":"code","1902672e":"code","bf73aede":"code","91ceb84e":"code","daaebf80":"code","6204d233":"code","12a500cb":"code","1e1b6af9":"code","53c3d621":"code","a7cc1850":"code","a46c48f1":"code","dd5b8d23":"markdown","5e71a092":"markdown","6829ab5b":"markdown","badcebd6":"markdown","4d8761eb":"markdown","26b33215":"markdown","46baf88f":"markdown","12b5f707":"markdown","4c1b6d9b":"markdown","e82fb09f":"markdown"},"source":{"c2b79478":"import xgboost as xgb\nimport pandas as pd\nimport numpy as np\nimport statsmodels.api as sm\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import GridSearchCV\nimport warnings as ws\nws.simplefilter(\"ignore\")","1902672e":"#Loading required packages for analysis\nimport numpy as np\nimport pandas as pd\n\n#Reading the training data\nvp_train = pd.read_csv(\"..\/input\/train.csv\", header='infer')\nvp_test = pd.read_csv(\"..\/input\/test.csv\", header='infer')","bf73aede":"from scipy.stats import skew\nvp_train_log_x = np.log1p(vp_train.iloc[:,2:])\nvp_test_log_x = np.log1p(vp_test.iloc[:,1:])\nvp_train_y = vp_train.iloc[:,1]","91ceb84e":"model = xgb.XGBRegressor(colsample_bytree=0.4,\n                 gamma=0,                 \n                 learning_rate=0.07,\n                 max_depth=3,\n                 min_child_weight=1.5,\n                 n_estimators=1000,                                                                    \n                 reg_alpha=0.75,\n                 reg_lambda=0.45,\n                 subsample=0.6,\n                 seed=42)","daaebf80":"from collections import OrderedDict\nmodel.fit(vp_train_log_x, vp_train_y)\nxgb_fea_imp=pd.DataFrame(list(model.get_booster().get_fscore().items()),columns=['feature','importance']).sort_values('importance', ascending=False)","6204d233":"#Selecting features with importance greater than 10\nfeature_g10 = xgb_fea_imp[xgb_fea_imp.importance >=10]","12a500cb":"#Relevent Feature list\nfeature_list = list(feature_g10.feature)","1e1b6af9":"gbm_param_grid = {\n     'colsample_bytree': np.linspace(0.5, 0.9, 5),\n     'n_estimators':[100, 200],\n     'max_depth': [10, 15, 20, 25]\n}\n\ngbm = xgb.XGBRegressor()\n\ngrid_mse = GridSearchCV(estimator = gbm, param_grid = gbm_param_grid, scoring = 'neg_mean_squared_error', cv = 5, verbose = 1)","53c3d621":"grid_mse.fit(vp_train_log_x[feature_list], vp_train_y)","a7cc1850":"pred = grid_mse.predict(vp_test_log_x[feature_list])","a46c48f1":"#Saving the final results\ny_pred_final = pd.DataFrame({'target1':pred})\nx_id = vp_test.loc[:,['ID']]\nresult = pd.concat([x_id, y_pred_final], axis = 1, ignore_index=True)\n\nresult.columns = ['ID', 'target1']\nresult['target'] = result['target1'].abs()\nresult = result.drop(['target1'], axis = 1)\nresult.to_csv('Submission_7_Aug_2018_2.csv', sep=',', index=False)","dd5b8d23":"**6. Saving the final result**","5e71a092":"**4. Fitting the Model**","6829ab5b":"**3. Relevent Features**","badcebd6":"**2. Taking Log transform as features are skwed**","4d8761eb":"**5. Predicting on Test data**","26b33215":"**4. Parameters for grid search**","46baf88f":"**1. Reading the Training and Testing Datasets**","12b5f707":"**0. Libraries that are required for analysis**","4c1b6d9b":"**Overview**\n\nAccording to Epsilon research, 80% of customers are more likely to do business with you if you provide personalized service. Banking is no exception.\n\nThe digitalization of everyday lives means that customers expect services to be delivered in a personalized and timely manner\u2026 and often before they\u00b4ve even realized they need the service. In their 3rd Kaggle competition, Santander Group aims to go a step beyond recognizing that there is a need to provide a customer a financial service and intends to determine the amount or value of the customer's transaction. This means anticipating customer needs in a more concrete, but also simple and personal way. With so many choices for financial services, this need is greater now than ever before.\n\nIn this competition, Santander Group is asking Kagglers to help them identify the value of transactions for each potential customer. This is a first step that Santander needs to nail in order to personalize their services at scale.","e82fb09f":"**Note**\n\nBeing my first Kaggle competition i didn't fine tune much just went with some default parameter values for the problem using XGBoost regressor."}}