{"cell_type":{"ec924f9a":"code","d1a7ec41":"code","d828c16d":"code","18864aed":"code","f9cab416":"code","5be55170":"code","119a5a9f":"code","60fa4a9e":"code","34a1cd5b":"code","d7428c0f":"code","12c04559":"code","e32fe7d1":"code","a5187515":"code","7132fb59":"code","e4f8d4a1":"code","0ad8b807":"code","933c1e9e":"code","592ee3c3":"code","84e529ba":"code","6d2423f7":"code","acd9cc3e":"code","7c6f39d5":"code","22cf0004":"code","7716b5cd":"code","19c28956":"code","03c9c5ca":"code","5c3db347":"code","ad32ce6e":"code","12438e3b":"code","0bf5d77f":"code","26b7343e":"code","15f7c10e":"code","9b57c779":"code","5c3473f4":"code","a4d641c2":"code","d610ae37":"code","0291ce91":"code","86a63dc0":"code","2739a8ce":"code","ba693f2e":"code","f1e64f5c":"code","07ce49a2":"code","2f2be474":"code","a2b3970f":"code","37b39dc8":"code","9afb5b78":"code","86e49103":"code","acea6144":"code","48bb8790":"code","ff589384":"code","5de0b58a":"code","1114f0fe":"code","420343de":"code","6171856e":"code","22afbfa8":"markdown","63b0234a":"markdown","0e1489a7":"markdown","f9b068a3":"markdown","3ba98be9":"markdown","4bacbea6":"markdown","2dd98639":"markdown","2e590eda":"markdown","a3674dfd":"markdown","ebfdeab0":"markdown","7dcd4200":"markdown","9060a765":"markdown","9b3377ff":"markdown","ef910a13":"markdown","a7e2e66a":"markdown","a650434d":"markdown","bf68a880":"markdown","6217f7bd":"markdown","8bbf0746":"markdown","d7881573":"markdown","def071fe":"markdown","275ad503":"markdown","5bb08869":"markdown","70cade68":"markdown","200cc4ff":"markdown","6cd0abaf":"markdown","df69eec3":"markdown"},"source":{"ec924f9a":"import numpy as np \nimport pandas as pd \n\n# Data Visualization\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nsns.set(style='whitegrid')\n\n# Modeling\nfrom sklearn.model_selection import train_test_split\n\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier, GradientBoostingClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.discriminant_analysis import LinearDiscriminantAnalysis, QuadraticDiscriminantAnalysis\nfrom sklearn.linear_model import LogisticRegression\n\nfrom sklearn.metrics import roc_auc_score\n\nfrom sklearn.model_selection import RandomizedSearchCV","d1a7ec41":"df = pd.read_csv(\"\/kaggle\/input\/heart-disease-uci\/heart.csv\")","d828c16d":"df","18864aed":"df['target'].value_counts()","f9cab416":"b = sns.countplot(x='target', data=df)\nb.set_title(\"Target Distribution\");","5be55170":"df['age'].describe()","119a5a9f":"b = sns.distplot(df['age'])\nb.set_title(\"Age Distribution\");","60fa4a9e":"b = sns.boxplot(y = 'age', data = df)\nb.set_title(\"Age Distribution\");","34a1cd5b":"b = sns.boxplot(y='age', x='target', data=df)\nb.set_title(\"Age Distribution for Target\")\nplt.xlabel(\"0 = No Heart Disease, 1 = Heart Disease\");","d7428c0f":"df['sex'].value_counts()","12c04559":"b = sns.countplot(x='sex', data=df)\nb.set_title(\"Target Distribution\");","e32fe7d1":"pd.crosstab(df['target'], df['sex']).plot(kind=\"bar\", figsize=(10,6))\n\nplt.title(\"Target distribution for Sex\")\nplt.xlabel(\"0 = No Heart Disease, 1 = Heart Disease\")\nplt.ylabel(\"Count\")\nplt.legend([\"female\", \"male\"])\nplt.xticks(rotation=0);","a5187515":"df['cp'].value_counts()","7132fb59":"b = sns.countplot(x='cp', data=df)\nb.set_title(\"cp Distribution\");","e4f8d4a1":"pd.crosstab(df['target'], df['cp']).plot(kind=\"bar\", figsize=(10,6))\n\nplt.title(\"Target distribution for cp\")\nplt.xlabel(\"0 = No Heart Disease, 1 = Heart Disease\")\nplt.ylabel(\"Count\")\nplt.legend([\"0\", \"1\", \"2\", \"3\"])\nplt.xticks(rotation=0);","0ad8b807":"df['trestbps'].describe()","933c1e9e":"b = sns.distplot(df['trestbps'])\nb.set_title(\"trestbps Distribution\");","592ee3c3":"b = sns.boxplot(y = 'trestbps', data = df)\nb.set_title(\"trestbps Distribution\");","84e529ba":"b = sns.boxplot(y='trestbps', x='target', data=df)\nb.set_title(\"trestbps Distribution for Target\")\nplt.xlabel(\"0 = No Heart Disease, 1 = Heart Disease\");","6d2423f7":"df['chol'].describe()","acd9cc3e":"b = sns.distplot(df['chol'])\nb.set_title(\"trestbps Distribution\");","7c6f39d5":"b = sns.boxplot(y = 'chol', data = df)\nb.set_title(\"trestbps Distribution\");","22cf0004":"b = sns.boxplot(y='chol', x='target', data=df)\nb.set_title(\"chol Distribution for Target\")\nplt.xlabel(\"0 = No Heart Disease, 1 = Heart Disease\");","7716b5cd":"df['fbs'].value_counts()","19c28956":"b = sns.countplot(x='fbs', data=df)\nb.set_title(\"fbs Distribution\");","03c9c5ca":"pd.crosstab(df['target'], df['fbs']).plot(kind=\"bar\", figsize=(10,6))\n\nplt.title(\"Target distribution for fbs\")\nplt.xlabel(\"0 = No Heart Disease, 1 = Heart Disease\")\nplt.ylabel(\"Count\")\nplt.legend([\"0\", \"1\"])\nplt.xticks(rotation=0);","5c3db347":"df['restecg'].value_counts()","ad32ce6e":"b = sns.countplot(x='restecg', data=df)\nb.set_title(\"restecg Distribution\");","12438e3b":"pd.crosstab(df['target'], df['restecg']).plot(kind=\"bar\", figsize=(10,6))\n\nplt.title(\"Target distribution for restecg\")\nplt.xlabel(\"0 = No Heart Disease, 1 = Heart Disease\")\nplt.ylabel(\"Count\")\nplt.legend([\"0\", \"1\", \"2\"])\nplt.xticks(rotation=0);","0bf5d77f":"df['thalach'].describe()","26b7343e":"b = sns.distplot(df['thalach'])\nb.set_title(\"trestbps Distribution\");","15f7c10e":"b = sns.boxplot(y = 'thalach', data = df)\nb.set_title(\"thalach Distribution\");","9b57c779":"b = sns.boxplot(y='thalach', x='target', data=df)\nb.set_title(\"thalach Distribution for Target\")\nplt.xlabel(\"0 = No Heart Disease, 1 = Heart Disease\");","5c3473f4":"df['exang'].value_counts()","a4d641c2":"b = sns.countplot(x='exang', data=df)\nb.set_title(\"exang Distribution\");","d610ae37":"pd.crosstab(df['target'], df['exang']).plot(kind=\"bar\", figsize=(10,6))\n\nplt.title(\"Target distribution for exang\")\nplt.xlabel(\"0 = No Heart Disease, 1 = Heart Disease\")\nplt.ylabel(\"Count\")\nplt.legend([\"0\", \"1\"])\nplt.xticks(rotation=0);","0291ce91":"df['oldpeak'].describe()","86a63dc0":"b = sns.distplot(df['oldpeak'])\nb.set_title(\"oldpeak Distribution\");","2739a8ce":"b = sns.boxplot(y = 'oldpeak', data = df)\nb.set_title(\"oldpeak Distribution\");","ba693f2e":"b = sns.boxplot(y='oldpeak', x='target', data=df)\nb.set_title(\"oldpeak Distribution for Target\")\nplt.xlabel(\"0 = No Heart Disease, 1 = Heart Disease\");","f1e64f5c":"df['slope'].value_counts()","07ce49a2":"b = sns.countplot(x='slope', data=df)\nb.set_title(\"slope Distribution\");","2f2be474":"pd.crosstab(df['target'], df['slope']).plot(kind=\"bar\", figsize=(10,6))\n\nplt.title(\"Target distribution for slope\")\nplt.xlabel(\"0 = No Heart Disease, 1 = Heart Disease\")\nplt.ylabel(\"Count\")\nplt.legend([\"0\", \"1\", \"2\"])\nplt.xticks(rotation=0);","a2b3970f":"df['ca'].value_counts()","37b39dc8":"b = sns.countplot(x='ca', data=df)\nb.set_title(\"ca Distribution\");","9afb5b78":"pd.crosstab(df['target'], df['ca']).plot(kind=\"bar\", figsize=(10,6))\n\nplt.title(\"Target distribution for ca\")\nplt.xlabel(\"0 = No Heart Disease, 1 = Heart Disease\")\nplt.ylabel(\"Count\")\nplt.legend([\"0\", \"1\", \"2\", \"3\", \"4\"])\nplt.xticks(rotation=0);","86e49103":"df['thal'].value_counts()","acea6144":"b = sns.countplot(x='thal', data=df)\nb.set_title(\"thal Distribution\");","48bb8790":"pd.crosstab(df['target'], df['thal']).plot(kind=\"bar\", figsize=(10,6))\n\nplt.title(\"Target distribution for thal\")\nplt.xlabel(\"0 = No Heart Disease, 1 = Heart Disease\")\nplt.ylabel(\"Count\")\nplt.legend([\"0\", \"1\", \"2\", \"3\"])\nplt.xticks(rotation=0);","ff589384":"df.isna().sum()","5de0b58a":"# Everything except target variable\nX = df.drop(\"target\", axis=1)\n\n# Target variable\ny = df['target'].values","1114f0fe":"# Random seed for reproducibility\nnp.random.seed(42)\n\n# Split into train & test set\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2)","420343de":"# Put models in a dictionary\nmodels = {\"KNN\": KNeighborsClassifier(),\n          \"Logistic Regression\": LogisticRegression(max_iter=10000), \n          \"Random Forest\": RandomForestClassifier(),\n          \"SVC\" : SVC(probability=True),\n          \"DecisionTreeClassifier\" : DecisionTreeClassifier(),\n          \"AdaBoostClassifier\" : AdaBoostClassifier(),\n          \"GradientBoostingClassifier\" : GradientBoostingClassifier(),\n          \"GaussianNB\" : GaussianNB(),\n          \"LinearDiscriminantAnalysis\" : LinearDiscriminantAnalysis(),\n          \"QuadraticDiscriminantAnalysis\" : QuadraticDiscriminantAnalysis()}\n\n# Create function to fit and score models\ndef fit_and_score(models, X_train, X_test, y_train, y_test):\n    \"\"\"\n    Fits and evaluates given machine learning models.\n    models : a dict of different Scikit-Learn machine learning models\n    X_train : training data\n    X_test : testing data\n    y_train : labels assosciated with training data\n    y_test : labels assosciated with test data\n    \"\"\"\n    # Random seed for reproducible results\n    np.random.seed(42)\n    # Make a list to keep model scores\n    model_scores = {}\n    # Loop through models\n    for name, model in models.items():\n        # Fit the model to the data\n        model.fit(X_train, y_train)\n        # Predicting target values\n        y_pred = model.predict(X_test)\n        # Evaluate the model and append its score to model_scores\n        #model_scores[name] = model.score(X_test, y_test)\n        model_scores[name] = roc_auc_score(y_test, y_pred)\n    return model_scores","6171856e":"model_scores = fit_and_score(models=models,\n                             X_train=X_train,\n                             X_test=X_test,\n                             y_train=y_train,\n                             y_test=y_test)\nmodel_scores\n","22afbfa8":"### Target Value: target","63b0234a":"## Missing values\n\nLet's check for missing values:","0e1489a7":"<div style=\"text-align:center;\"><img src=\"https:\/\/images.unsplash.com\/photo-1571172964276-91faaa704e1f?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80\" \/><\/div>","f9b068a3":"## age","3ba98be9":"## sex","4bacbea6":"We are pretty much free of outliers. That's great!","2dd98639":"## oldpeak","2e590eda":"## exang","a3674dfd":"## slope","ebfdeab0":"## fbs","7dcd4200":"# Imports","9060a765":"We have a few outliers here.","9b3377ff":"## thalach","ef910a13":"## chol","a7e2e66a":"**Context:** \n> This database contains 76 attributes, but all published experiments refer to using a subset of 14 of them. In particular, the Cleveland database is the only one that has been used by ML researchers to\nthis date. The \"goal\" field refers to the presence of heart disease in the patient. It is integer valued from 0 (no presence) to 4.\n\n**About the Data:**\n* age - age in years\n* sex - (1 = male; 0 = female)\n* chest pain type (4 values)\n* resting blood pressure\n* serum cholestoral in mg\/dl\n* fasting blood sugar > 120 mg\/dl\n* resting electrocardiographic results (values 0,1,2)\n* maximum heart rate achieved\n* exercise induced angina\n* oldpeak = ST depression induced by exercise relative to rest\n* the slope of the peak exercise ST segment\n* number of major vessels (0-3) colored by flourosopy\n* thal: 3 = normal; 6 = fixed defect; 7 = reversable defect","a650434d":"# Modeling","bf68a880":"## cp","6217f7bd":"# Exploratory Data Analysis","8bbf0746":"We do not have any. Thats great!","d7881573":"## restecg","def071fe":"Our data consists of roughly 2\/3 `male` and 1\/3 `female` patients.","275ad503":"## ca","5bb08869":"`Logistic Regression` and `LinearDiscriminantAnalysis` have the best scores with `0.8685344827586206`.","70cade68":"## thal","200cc4ff":"## trestbps","6cd0abaf":"We have slightly more rows with a `target` of `1`.","df69eec3":"<h1 style=\"text-align:center\">My Heart Diseas Classification Approach<\/h1>"}}