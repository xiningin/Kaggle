{"cell_type":{"578fa3cd":"code","f78a4208":"code","8c79b87b":"code","1f0fcb3a":"code","fefacca0":"code","84902a11":"code","2b8037b4":"code","7fd47548":"code","a0179d2a":"code","77386be2":"code","ed0b2db6":"code","de3b47b8":"code","3fd8dfa0":"code","e2a8b50a":"code","eb8ed7b4":"code","ef279c4d":"code","eedef89b":"code","bb807154":"code","1aba5803":"code","2ba05ab3":"code","05268942":"markdown","e17ebb3c":"markdown","17a53f55":"markdown","7aaa80fd":"markdown","be7f916c":"markdown","4e4a2d8f":"markdown","55f5fef3":"markdown","27153d12":"markdown","98d3cf55":"markdown","f7dc9639":"markdown","aac58586":"markdown","980dc796":"markdown","3d2582d7":"markdown","bb3f7403":"markdown","ea2180ce":"markdown","6c801311":"markdown","0cc090ab":"markdown","f1ff5cdf":"markdown","4ab26e9f":"markdown","28cb9178":"markdown","debf85fe":"markdown","7f05ea13":"markdown","b0ac2aac":"markdown","d6e6c246":"markdown"},"source":{"578fa3cd":"import numpy as np \nimport pandas as pd \n\n# Libraries for visualisation\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nplt.style.use('fivethirtyeight')\n\n# Libraries for Preprocessing\nfrom sklearn.preprocessing import StandardScaler, OneHotEncoder, OrdinalEncoder\nfrom sklearn.model_selection import train_test_split, cross_val_score\nfrom sklearn.compose import ColumnTransformer\n\n# Machine Learning Algorithms\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.svm import SVC\n\n# Libraries for Metrics\nfrom sklearn.metrics import accuracy_score, confusion_matrix\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","f78a4208":"# Reading the data set\ndata = pd.read_csv('\/kaggle\/input\/heart-failure-prediction\/heart.csv')\nprint(\"Number of rows in the dataset: {}\".format(data.shape[0]))\nprint(\"Number of cols in the dataset: {}\".format(data.shape[1]))\n","8c79b87b":"data.head()","1f0fcb3a":"data.isnull().sum()","fefacca0":"data.describe().T.style.background_gradient(cmap='Blues')","84902a11":"color = plt.cm.copper(np.linspace(0, 1, 10))\nplt.figure(figsize=(14,5))\ndata.nunique().plot(kind='bar', width=.8, color=color)\nplt.title('No of unique values in the dataset', size=16)\nplt.show()\nprint(data.nunique())","2b8037b4":"discrette_feature = [i for i in data.columns if data[i].nunique() < 10]\ncontinuous_feature = [i for i in data.columns if data[i].nunique() > 10]\nprint(f'discrette feature: {discrette_feature}')\nprint(f'continuous feature: {continuous_feature}')","7fd47548":"plt.style.use(plt.style.available[19])\ni = 1\nplt.figure(figsize=(18,20)) \nfor feature in discrette_feature[:-1]:\n    plt.subplot(4, 2, i)\n    sns.countplot(x=data[feature], hue=data.HeartDisease)\n    i += 1\n    \nplt.show()","a0179d2a":"plt.style.use('fivethirtyeight')\ni = 1\nplt.figure(figsize=(18,16)) \nfor feature in continuous_feature:\n    plt.subplot(3, 2, i)\n    sns.histplot(x=data[feature],kde=True,bins=50, hue=data.HeartDisease)\n    plt.xlabel(feature,size=12)\n    plt.ylabel(\"Density\",size=12)\n    i += 1\n    \nplt.show()","77386be2":"i = 1\nn = 1\nplt.figure(figsize=(18,24)) \nfor feature in continuous_feature:\n    for i_ in continuous_feature[n:]:\n        plt.subplot(5, 2, i)\n        sns.scatterplot(x=data[feature],y=data[i_], s=80, hue=data.HeartDisease)\n        plt.xlabel(feature,size=12)\n        plt.ylabel(i_,size=12)\n        i += 1\n    n+=1\nplt.show()        ","ed0b2db6":"plt.style.use('fivethirtyeight')\ni = 1\nplt.figure(figsize=(18,16)) \nfor feature in continuous_feature:\n    plt.subplot(3, 2, i)\n    sns.boxplot(data=data, x=feature, hue='HeartDisease', color='darkcyan')\n    plt.xlabel(feature,size=12)\n#     plt.ylabel(\"Density\",size=12)\n    i += 1\n    \nplt.show()","de3b47b8":"plt.figure(figsize=(14,8))\nsns.heatmap(data.corr(), mask=np.triu(data.corr()), annot=True, cmap='YlGnBu',linewidth=2)\nplt.show()","3fd8dfa0":"data.head()","e2a8b50a":"X = data.drop(columns=['HeartDisease'])\ny = data['HeartDisease']","eb8ed7b4":"x_train, x_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=25)\nprint(f'x_train shape: {x_train.shape}')\nprint(f'y_train shape: {y_train.shape}')\nprint(f'x_test shape : {x_test.shape}')\nprint(f'y_test shape : {y_test.shape}')","ef279c4d":"transformer = ColumnTransformer(transformers = [('onehot', OneHotEncoder(sparse=False, drop='first'), [1,2,6,8,10]),\n                                                ('scaler', StandardScaler(), [0,3,4,5,7,9])],\n                                      remainder = 'passthrough')\nx_train = transformer.fit_transform(x_train)\nx_test = transformer.transform(x_test)","eedef89b":"def do_prediction(classifier):\n    \n    # training the classifier on the dataset\n    classifier.fit(x_train, y_train)\n    \n    #Do prediction and evaluting the prediction\n    prediction = classifier.predict(x_test)\n    cross_validation_score = cross_val(x_train,y_train, classifier)\n    accuracy = accuracy_score(y_test, prediction)\n    con_metrix = confusion_matrix(y_test, prediction)\n    \n    return accuracy,con_metrix, cross_validation_score\n\ndef cross_val(x_train, y_train, classifier):\n    \n    # Applying k-Fold Cross Validation\n    accuracies = cross_val_score(estimator = classifier, X = x_train, y = y_train, cv = 5)\n    return accuracies.mean()\n","bb807154":"\nlogistic_reg = LogisticRegression()\naccuracy,con_metrix, cross_validation_score = do_prediction(logistic_reg)\n\nplt.figure(figsize=(9,6))\nsns.heatmap(con_metrix, annot=True, cmap='PuBuGn')\nplt.title('Confusion Matrix for logistic regression',size=14)\nplt.show()\nprint('Logistic Regression Performace on the training data have an accuracy score of {}'.format((cross_validation_score *100).round()) )\nprint('Logistic Regression Performace on the testing data have an accuracy score of {}'.format((accuracy *100).round()) )","1aba5803":"gaussian = GaussianNB()\naccuracy,con_metrix, cross_validation_score = do_prediction(gaussian)\n\nplt.figure(figsize=(9,6))\nsns.heatmap(con_metrix, annot=True, cmap='PuBuGn')\nplt.title('Confusion Matrix for Naive Bayes',size=14)\nplt.show()\nprint('Naive Bayes Performace on the training data have an accuracy score of {}'.format((cross_validation_score *100).round()) )\nprint('Naive Bayes Performace on the testing data have an accuracy score of {}'.format((accuracy *100).round()) )","2ba05ab3":"svm = SVC()\naccuracy,con_metrix, cross_validation_score = do_prediction(svm)\n\nplt.figure(figsize=(9,6))\nsns.heatmap(con_metrix, annot=True, cmap='PuBuGn')\nplt.title('Confusion Matrix for SVM',size=14)\nplt.show()\nprint('Support Vector Machine Performace on the training data have an accuracy score of {}'.format((cross_validation_score *100).round()) )\nprint('Support Vector Machine Performace on the testing data have an accuracy score of {}'.format((accuracy *100).round()) )","05268942":"<div class=\"alert alert-block alert-info\" style=\"text-align:center\"> \ud83d\udccc<b>Insights:<\/b> We can cearly see that there is no NaN values (missing values) in the dataset.<\/div>","e17ebb3c":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 25px; color:white; text-align:center\"><b>\ud83d\udd0d   Exploratory Data Analysis<\/b><\/p>\n<\/div>","17a53f55":"**<span style=\"font-family:cursive;\">Machine Learning is used across many spheres around the world. The healthcare industry is no exception. Machine Learning can play an essential role in predicting presence\/absence of Locomotor disorders, Heart diseases and more. Such information, if predicted well in advance, can provide important insights to doctors who can then adapt their diagnosis and treatment per patient basis.<\/span>**","7aaa80fd":"**Logistic Regression**","be7f916c":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 25px; color:white; text-align:center\"><b> Model Building<\/b><\/p>\n<\/div>","4e4a2d8f":"**splitting the data for training and testing**","55f5fef3":"**\ud83d\udccc Attribute Information:**\n* **Age:** age of the patient [years]\n* **Sex:** sex of the patient [M: Male, F: Female]\n* **ChestPainType:** chest pain type [TA: Typical Angina, ATA: Atypical Angina, NAP: Non-Anginal Pain, ASY: Asymptomatic]\n* **RestingBP:** resting blood pressure [mm Hg]\n* **Cholesterol:** serum cholesterol [mm\/dl]\n* **FastingBS:** fasting blood sugar [1: if FastingBS > 120 mg\/dl, 0: otherwise]\n* **RestingECG:** resting electrocardiogram results [Normal: Normal, ST: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV), LVH: showing probable or definite left ventricular hypertrophy by Estes' criteria]\n* **MaxHR:** maximum heart rate achieved [Numeric value between 60 and 202]\n* **ExerciseAngina:** exercise-induced angina [Y: Yes, N: No]\n* **Oldpeak:** oldpeak = ST [Numeric value measured in depression]\n* **ST_Slope:** the slope of the peak exercise ST segment [Up: upsloping, Flat: flat, Down: downsloping]\n* **HeartDisease:** output class [1: heart disease, 0: Normal]","27153d12":"<div class=\"alert alert-block alert-info\" style=\"text-align:center\"> \ud83d\udccc<b>Insights :<\/b> people who are aged more than 50 and having MaxHR (maximum Heart Rate) less than 140 and also have more Oldpeak is more likely to have heart disease.<\/div>","98d3cf55":"**Seperating the data into discrette features and continuous feat**","f7dc9639":"**seperating input features and output features**","aac58586":"**Naive Bayes**","980dc796":"**Applying One Hot Encoding and standardization using column transformer**","3d2582d7":"**Cardinality of the data**","bb3f7403":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 25px; color:white; text-align:center\"><b>Data Preprocessing<\/b><\/p>\n<\/div>","ea2180ce":"**visualising continuous features with each other using scatter plot**","6c801311":"**Visualising discrette feature with output variable count plot**","0cc090ab":"# <span style=\"font-family:cursive;\">Predicting Heart Disease using Machine Learning \u2764<\/span>","f1ff5cdf":"<div class=\"alert alert-block alert-info\" style=\"text-align:center\"> \ud83d\udccc<b>Insights :<\/b> Oldpeak and Heart Disease have strong positive correlation, whereas maxHR (maximum Heart Rate) and Age have negative correlation (younger people have more heart rate compared to older people)<\/div>","4ab26e9f":"**Support Vector Machine**","28cb9178":"![](https:\/\/www.mydr.com.au\/wp-content\/uploads\/2019\/04\/heart_failure_750.jpeg)","debf85fe":"<div class=\"alert alert-block alert-info\" style=\"text-align:center\"> \ud83d\udccc<b>Insights: <\/b>Here we have different types of data, such as categorical, numerical (discrette and continuous)<br>categorical features: Sex, Chest Pain Type, Resting ECG, Exercise Angina, ST_Slope<br>Numerical features:\n    Age, RestingBP, cholesterol, FastingBS, MaxHR, Oldpeak, Heart Disease(Target)<br>Discrette Features: Sex, ChestPainType, FastingBS, RestingECG, ExerciseAngina, ST_Slope<br> Continuous features: Age, RestingBP, Cholesterol, MaxHR, Oldpeak\n<\/div>","7f05ea13":"**visualising continuous features with output variable using histogram and kde**","b0ac2aac":"<div class=\"alert alert-block alert-info\" style=\"text-align:center\"> \ud83d\udccc<b>Insights: <\/b>Sex: Male is having more heart disease compared to female<br>Chest pain type ASY: Asymptomatic having more heart disease compared to others<br>exercise-induced angina: yes and ST_Slope: Flat is having more compared to others<br>And peoples with ST_Slope: up, ExerciseAngina: No and chest pain type: ATA (ATypical angina) mostly don't have heart disease<\/div>","d6e6c246":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<p style=\"padding: 25px; color:white; text-align:center\"><b>Importing Libraries<\/b><\/p>\n<\/div>"}}