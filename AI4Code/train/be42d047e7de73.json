{"cell_type":{"ae4143c8":"code","44a8ec92":"code","df06ccda":"code","a5226a6d":"code","928ded01":"code","d9c060a8":"code","fa2ba992":"code","70f68331":"code","77f641d0":"code","b0a28536":"code","9c760771":"code","0252c260":"code","0aadac27":"code","ba097fbf":"code","793356e2":"code","5766668d":"code","5fd9a6f8":"code","d70a9180":"code","fcd813b7":"code","cfb5252c":"code","d3c3daba":"code","13a6d6c0":"code","56b3048f":"code","77459051":"code","6d0db92c":"code","36eb93e8":"code","3ca809a4":"code","830206bc":"markdown"},"source":{"ae4143c8":"from keras.preprocessing.image import ImageDataGenerator\nfrom keras.layers import Dense,Flatten,Conv2D,MaxPool2D,Dropout\nfrom keras.models import Sequential","44a8ec92":"train_data_path=\"..\/input\/intel-image-classification\/seg_train\/seg_train\"\ntest_data_path=\"..\/input\/intel-image-classification\/seg_test\/seg_test\"","df06ccda":"train_datagen=ImageDataGenerator(rotation_range=40,shear_range=0.2,zoom_range=0.2,horizontal_flip=True,vertical_flip=True,rescale=1.\/255)","a5226a6d":"test_datagen=ImageDataGenerator(rescale=1.\/255)","928ded01":"train_data=train_datagen.flow_from_directory(train_data_path,target_size=(150,150),class_mode=\"categorical\",batch_size=70)","d9c060a8":"test_data=test_datagen.flow_from_directory(test_data_path,target_size=(150,150),class_mode=\"categorical\",batch_size=30)","fa2ba992":"model=Sequential()","70f68331":"model.add(Conv2D(190, (3, 3),input_shape=(150,150,3),activation='relu'))\nmodel.add(MaxPool2D(strides=(2,2)))\nmodel.add(Conv2D(180,(3,3),activation=\"relu\"))\nmodel.add(MaxPool2D((2,2)))\nmodel.add(Conv2D(165,(3,3),activation=\"relu\"))\nmodel.add(MaxPool2D((2,2)))\nmodel.add(Conv2D(100,(3,3),activation=\"relu\"))\nmodel.add(MaxPool2D((2,2)))\nmodel.add(Conv2D(70,(3,3),activation=\"relu\"))\nmodel.add(MaxPool2D((2,2)))\n\nmodel.add(Flatten())","77f641d0":"model.add(Dense(16,activation=\"relu\"))\nmodel.add(Dense(128,activation=\"relu\"))\nmodel.add(Dense(64,activation=\"relu\"))\nmodel.add(Dense(32,activation=\"relu\"))\nmodel.add(Dense(6,activation=\"softmax\"))","b0a28536":"model.summary()","9c760771":"model.compile(optimizer=\"adam\",loss=\"categorical_crossentropy\",metrics=[\"acc\"])","0252c260":"history=model.fit_generator(train_data,epochs=50,steps_per_epoch=100,validation_data=test_data,validation_steps=50)\n","0aadac27":"import matplotlib.pyplot as plt\ntrain_acc=history.history['acc']\nvalidation_acc=history.history['val_acc']\ntrain_loss=history.history['loss']\nvalidation_loss=history.history['val_loss']","ba097fbf":"plt.plot(train_loss)\nplt.plot(validation_loss)\nplt.title(\"Train Loss Vs. Validation Loss\")\nplt.xlabel(\"Epochs\")\nplt.ylabel(\"Loss\")\nplt.show()","793356e2":"plt.plot(train_acc)\nplt.plot(validation_acc)\nplt.title(\"Train acc Vs. Validation acc\")\nplt.xlabel(\"Epochs\")\nplt.ylabel(\"Accuarcy\")\nplt.show()","5766668d":"from keras.preprocessing import image","5fd9a6f8":"img=image.load_img(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10059.jpg\",target_size=(150,150))","d70a9180":"img","fcd813b7":"img_tensor=image.img_to_array(img)","cfb5252c":"import numpy as np\nimg_tensor=np.expand_dims(img_tensor,axis=0)","d3c3daba":"img_tensor.shape","13a6d6c0":"img_tensor=img_tensor\/255.0","56b3048f":"import matplotlib.pyplot as plt\n","77459051":"plt.imshow(img_tensor[0])","6d0db92c":"classes=model.predict(img_tensor)","36eb93e8":"import pandas as pd\ndef pred_class(classes):\n  classes=list(classes)\n  mx_class_val=0\n  mx_class=0\n  for i in range(0,len(classes)):\n    if(classes[i]>mx_class_val):\n      mx_class=i\n      mx_class_val=classes[i]\n  return mx_class+1\n\n    \n","3ca809a4":"if(pred_class(classes[0])==1):\n  print(\"Building\")\n\nif(pred_class(classes[0])==2):\n  print(\"Forest\")\n\nif(pred_class(classes[0])==3):\n  print(\"Glacier\")\nif(pred_class(classes[0])==4):\n  print(\"Mountain\")\nif(pred_class(classes[0])==5):\n  print(\"Sea\")\nif(pred_class(classes[0])==6):\n  print(\"Street\")","830206bc":"**Checking the Model on new data**"}}