{"cell_type":{"93ad3b35":"code","d8034bec":"code","0242d950":"code","15035af7":"code","1a9e8c80":"code","55f5ca20":"code","d4db40f6":"code","96d0ce4a":"code","5c59d9d6":"code","93a475a5":"code","6e116809":"code","4fac9ad4":"code","2d35060e":"code","223f225c":"code","b75d3408":"code","3a8553ee":"code","71ad26f6":"code","42de2ca8":"code","e2b96937":"code","ba800e2e":"code","f399ce6e":"code","55cbdca8":"code","c13da54f":"code","6ebaebdb":"code","2f7ab77d":"code","be6da920":"code","bdd09d22":"code","fb5c6a60":"code","2c2bb450":"code","d561d59b":"code","3a3f37e9":"code","8fba739f":"code","8eed4b9e":"code","ee79f358":"code","29693f9c":"code","dbb58664":"code","ec5ab112":"code","30ada73c":"code","79cc43ec":"code","81d6c98d":"code","bb0f4367":"code","6a6bc9b6":"code","170aa565":"code","55f0f8ca":"code","ad779f2d":"code","8e00a230":"code","d34eeaf9":"code","fde23ca2":"code","83961f11":"code","98439837":"code","e50ae27b":"code","594ef85e":"code","f0f0d984":"code","43eeb708":"code","60b11433":"code","dfa5bcbb":"code","2d188a5c":"code","35e74ce5":"code","2e9b328c":"code","1e7b85b6":"code","5efe7eeb":"code","d84d48e5":"code","9de12eab":"code","3bfddcfd":"code","ae33cdcf":"code","3aa56ed9":"code","008fa91c":"code","7c4464b1":"code","d4b14126":"code","728e96b2":"markdown","c36b1f1b":"markdown","3e654342":"markdown","612dda6e":"markdown","06382447":"markdown","308d6d52":"markdown","80e51464":"markdown","72a435bb":"markdown","2b21df92":"markdown","94baa26f":"markdown","cbb3b015":"markdown","fd6c3c4c":"markdown","2235cd91":"markdown","d6fc35ed":"markdown","3a6a2245":"markdown","2bc8ad03":"markdown","ea9a111b":"markdown","89ab1bd6":"markdown","1aad15be":"markdown","4833b658":"markdown","ed02c3c4":"markdown","90fd8063":"markdown","c280ee76":"markdown","25df2e00":"markdown","03032943":"markdown","94554dbe":"markdown","16be6272":"markdown","c14cecd9":"markdown","30add303":"markdown","03a74db8":"markdown","835d1b54":"markdown","7c5d99e8":"markdown","fbc9e7ef":"markdown","8cadf1c9":"markdown","0d85a0d4":"markdown","1be5dfa7":"markdown","50cfb78e":"markdown","04ab606c":"markdown","c9b70f7e":"markdown","b6ca8ee9":"markdown","1eb049bf":"markdown"},"source":{"93ad3b35":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n","d8034bec":"data=pd.read_csv('..\/input\/cervical-cancer-risk-classification\/kag_risk_factors_cervical_cancer.csv')","0242d950":"data.head()","15035af7":"data.tail()","1a9e8c80":"data.shape","55f5ca20":"data.info()","d4db40f6":"data.describe()","96d0ce4a":"data.isnull().sum()","5c59d9d6":"for feature in data.columns:\n    data[feature].replace('?',np.nan,inplace=True )\n    data[feature].fillna(value=0,inplace=True)","93a475a5":"for feature in data.columns:\n    data[feature].replace(0,data[feature].median(),inplace=True)","6e116809":"data.head()","4fac9ad4":"sns.distplot(data['Age'])","2d35060e":"df=pd.DataFrame(data[['Hinselmann','Schiller','Citology','Biopsy']])\ndf.head(10)","223f225c":"for features in df.columns:\n    s=df.copy()\n    sns.countplot(x=s[features])\n    plt.xlabel(features)\n    plt.title(features)\n    plt.show()","b75d3408":"for features in df.columns:\n    s=df.copy()\n    sns.barplot(x=s[features],y=data['Age'])\n    plt.xlabel(features)\n    plt.ylabel(\"Age\")\n    plt.title(features)\n    plt.show()\n    ","3a8553ee":"sns.heatmap(df.corr(),annot=True)","71ad26f6":"sns.heatmap(data.corr())","42de2ca8":"df['count']=df['Hinselmann']+df['Schiller']+df['Citology']+df['Biopsy']","e2b96937":"df['count'].value_counts()","ba800e2e":"df['result']=np.where(df['count']>0,1,df['count'])","f399ce6e":"df['result'].value_counts()","55cbdca8":"X=data.drop(columns=['Hinselmann','Schiller','Citology','Biopsy'],axis=1)\ny=df['result']","c13da54f":"from sklearn.preprocessing import StandardScaler","6ebaebdb":"scaler=StandardScaler()","2f7ab77d":"scaled_feature=scaler.fit_transform(X)","be6da920":"X_scaled=scaled_feature\ny=df['result']","bdd09d22":"from sklearn.model_selection import train_test_split","fb5c6a60":"X_train,X_test,y_train,y_test=train_test_split(X_scaled,y,test_size=0.3,random_state=42)","2c2bb450":"X_train.shape,y_train.shape","d561d59b":"X_test.shape,y_test.shape","3a3f37e9":"from sklearn.linear_model import LogisticRegression","8fba739f":"l_r=LogisticRegression()","8eed4b9e":"model=l_r.fit(X_train,y_train)","ee79f358":"pred=model.predict(X_test)","29693f9c":"from sklearn.metrics import classification_report,confusion_matrix","dbb58664":"print('Confusion Matrix:\\n ', confusion_matrix(y_test,pred))\nprint('Classification Report:\\n ',classification_report(y_test,pred))","ec5ab112":"from sklearn.model_selection import KFold,cross_val_score","30ada73c":"kfold=KFold(n_splits=10,shuffle=True,random_state=21)","79cc43ec":"model=LogisticRegression()","81d6c98d":"scores=cross_val_score(model,X,y,scoring='accuracy',cv=kfold,n_jobs=-1)\n","bb0f4367":"print('Accuracy: %.3f (%.3f)' % (np.mean(scores), np.std(scores)))","6a6bc9b6":"from sklearn.neighbors import KNeighborsClassifier","170aa565":"knn=KNeighborsClassifier(n_jobs=-1)","55f0f8ca":"knn_neighbors={'n_neighbors':[1,2,3,4,5,6,7,8,9,10]}","ad779f2d":"from sklearn.model_selection import GridSearchCV","8e00a230":"classifier=GridSearchCV(knn,param_grid=knn_neighbors,cv=kfold,verbose=0).fit(X_train,y_train)","d34eeaf9":"classifier.best_params_","fde23ca2":"best_grid=classifier.best_estimator_","83961f11":"best_grid","98439837":"predict=best_grid.predict(X_test)","e50ae27b":"print('Confusion Matrix:\\n ',confusion_matrix(y_test,predict))\nprint('Classification Report:\\n ',classification_report(y_test,predict))","594ef85e":"from sklearn.tree import DecisionTreeClassifier","f0f0d984":"df_tree=DecisionTreeClassifier(random_state=0)","43eeb708":"df_model=df_tree.fit(X_train,y_train)","60b11433":"df_pred=df_model.predict(X_test)","dfa5bcbb":"print('Confusion Matrix:\\n ',confusion_matrix(y_test,df_pred))\nprint('Classification Report:\\n ',classification_report(y_test,df_pred))","2d188a5c":"score=cross_val_score(df_model,X,y,scoring='accuracy',cv=kfold,n_jobs=-1)","35e74ce5":"print('Accuracy: %.3f (%.3f)' % (np.mean(score), np.std(score)))","2e9b328c":"from sklearn.ensemble import RandomForestClassifier","1e7b85b6":"rf=RandomForestClassifier()","5efe7eeb":"rf_model = rf.fit(X_train,y_train)","d84d48e5":"rf_pred=rf_model.predict(X_test)\n","9de12eab":"print('Confusion Matrix:\\n ',confusion_matrix(y_test,rf_pred))\nprint('Classification Report:\\n ',classification_report(y_test,rf_pred))","3bfddcfd":"s=cross_val_score(rf_model,X,y,scoring='accuracy',cv=kfold,n_jobs=-1)","ae33cdcf":"print('Accuracy: %.3f (%.3f)' % (np.mean(s), np.std(s)))","3aa56ed9":"import xgboost as xgb","008fa91c":"xg_boost=xgb.XGBClassifier()\nxg_model=xg_boost.fit(X_train,y_train)","7c4464b1":"xg_pred=xg_model.predict(X_test)","d4b14126":"print('Confusion Matrix:\\n ',confusion_matrix(y_test,xg_pred))\nprint('Classification Report:\\n ',classification_report(y_test,xg_pred))","728e96b2":"Let us first import all the necessary libraries.","c36b1f1b":"Now we can see that all our '?' are replaced with its median value.","3e654342":"**Load the Data**","612dda6e":"**Using Random Forest**","06382447":"Let us find the count of cancer affected person with respect to four kind of tests.","308d6d52":"Split the data into train\/test.","80e51464":"In this notebook we are going to predict whether the patient has cancer or not using various machine learning algorithms.","72a435bb":"Let us split our data into independent and depentent feature.","2b21df92":"Let us find the correlation of the whole data.","94baa26f":"Let us check whether our dataset has any nan values.\n\n","cbb3b015":"We could see that our target value has four columns. In order to make it to one we are going add the outcomes of all the four tests and store it in a seperate column called 'count'.","fd6c3c4c":"From this graph we could see that people with age group 20-40 has affected mostly with cervical cancer.","2235cd91":"From all the regression techniques we have tried we got 90% accuracy but when we keenly observe we could see that our precision,recall ,f1 score all of its percentage has been increased.","d6fc35ed":"We could see that our model has predicted with 87% accuracy.","3a6a2245":"We could get 87% accuracy.","2bc8ad03":"Let us find the  age count of cancer affected person with respect to four kind of tests.","ea9a111b":"Using kfold Cross validation with descision tree model.","89ab1bd6":"Now let us visualize the correlation of the df dataframe which contains the target values.","1aad15be":"**Using Descision Tree with Kfold CV**","4833b658":"So we could see that our model has predicted with 90% accuracy.","ed02c3c4":"<a href=\"https:\/\/colab.research.google.com\/github\/Suchitra-V31\/Machine-learning-projects\/blob\/main\/Cervical_Cancer_Risk_Classification.ipynb\" target=\"_parent\"><img src=\"https:\/\/colab.research.google.com\/assets\/colab-badge.svg\" alt=\"Open In Colab\"\/><\/a>","90fd8063":"We could find that our dataset has some '?' . So let us replace all the '?' with 0 and then replace that 0 with the median.","c280ee76":"For making better predictions we are going replace 1,2,3,4 with 1 which means the patient has cancer and 0 means the patient does'nt have cancer.","25df2e00":"In this we are going to use K Nearest Neighbor and find the best K value using Grid Search CV and also using Kfold cross validation.","03032943":"Let us create a dataframe df which contains all the four tests","94554dbe":"Let us visualize and try to understand the impact of features on dependent variable.","16be6272":"Stanadardize our features using StandardScaler.","c14cecd9":"We have got 90% accuracy.","30add303":"**KNN with CV**\n","03a74db8":"We could see that our model has aquired 86% accuracy","835d1b54":"We could see that our dataset does'nt have any nan values.","7c5d99e8":"**Logistic Regression Using Kfold Cross validation**","fbc9e7ef":"In this we are going to predict using same model but with kfold Cross validation and obtain the accurcay.","8cadf1c9":"**Using XGBoost**","0d85a0d4":"**Cervical Cancer Risk Classification**\n\n","1be5dfa7":"Using Kfold CV in random forest model","50cfb78e":" Cervical cancer is a type of cancer that occurs in the cells of the cervix \u2014 the lower part of the uterus that connects to the vagina.\n\n","04ab606c":"We could see that our model has predicted with 80% accuracy.","c9b70f7e":"**Using Logistic Regression**","b6ca8ee9":"**Exploratory Data analysis**","1eb049bf":"We could see that our model has predicted wit 90% accuracy."}}