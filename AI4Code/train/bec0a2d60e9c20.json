{"cell_type":{"c8cc5944":"code","bdde4756":"code","22f69979":"code","03314b28":"code","db4f2f34":"code","0383d605":"code","81f2a07c":"code","0627ff70":"code","93328675":"code","ec4ccaa6":"code","a8f95abf":"code","d1465d1f":"code","2ef45346":"code","717425f5":"code","84672663":"code","9f63092f":"code","2710e3d0":"code","63a72643":"code","fb79d6b7":"code","d7ae68da":"code","36f09f73":"code","d4f10063":"code","60abede9":"code","c16284e9":"code","1ec7e76e":"code","b1cd9b82":"code","b9db82b1":"code","c4b71b87":"code","0b0f574e":"code","fa317ae1":"code","9755ffd1":"code","46be3a46":"code","f51de030":"code","5f21efc0":"code","8928518e":"code","b9dc993c":"code","68d65a59":"code","84186218":"code","3eb46ed2":"code","234ea594":"code","5cd0cbfe":"code","201056e3":"code","4e36b2b8":"code","04663191":"code","d75fd02d":"code","7ce4c155":"code","0f4ff8aa":"code","2d3d520a":"code","6687062d":"code","6a599f96":"code","35fcf658":"code","f7ffb6da":"code","1a4184e1":"code","402b08c4":"code","f7d8973d":"code","c622e323":"code","db58dc8b":"code","7be3964f":"code","baacc67f":"code","b972b9d7":"code","21b04adf":"code","2a493022":"code","9fafe26e":"code","53769147":"code","2e90b63b":"code","b7545da1":"code","7034ee7b":"code","16ea594b":"code","978e2d54":"code","7ab1052a":"code","f576f5fd":"code","48a8cdca":"code","45906ef9":"code","8b427dcb":"code","dffdd1ca":"code","595eacc6":"code","2269a8be":"code","563cbbc0":"code","f4da99f1":"code","2af17436":"code","e72c71c7":"code","62f28c9d":"code","724253b6":"code","bda4e90d":"code","af151c1f":"code","f9dcf550":"code","c97b5b59":"code","3b6697b1":"code","78c225d1":"code","2cf65c10":"code","c877fbd7":"code","02fafd40":"code","1f2f009e":"code","a1c0857e":"code","a84b4616":"code","9fcf7e7c":"code","243cc3b3":"code","799608b2":"code","5c9be1a5":"code","bf86bdd7":"code","fa3bed8b":"code","1c3b23b8":"code","4a15149b":"code","826fd0e4":"code","b6299cb8":"code","30106338":"code","8d1ae84a":"code","385d93e3":"code","8fa45681":"code","fde7d303":"code","901f8c95":"code","4fdce20d":"code","9cdcda91":"code","a6464702":"markdown","ec2ce16f":"markdown","b8640161":"markdown","c60754f4":"markdown","80b6c97a":"markdown","982382d7":"markdown","4211b08f":"markdown","71a49034":"markdown","cd619118":"markdown","ab544772":"markdown","4ec58c54":"markdown","faf8c365":"markdown","70334951":"markdown","a3445225":"markdown","60a92a37":"markdown","5996fbff":"markdown","85392904":"markdown","268d4415":"markdown","ccb19ca1":"markdown","7d7fadb5":"markdown","c7b32db0":"markdown","9bb9d6cc":"markdown","782b6ea7":"markdown","4274a707":"markdown","0efd6221":"markdown","be9741a8":"markdown","0f686efd":"markdown","c9493a20":"markdown","59a23bcd":"markdown","8bf9ff36":"markdown","b10b539d":"markdown","cd98c66e":"markdown","cc13c723":"markdown","b9d58c86":"markdown","56f3142a":"markdown","f5b9d644":"markdown","05563767":"markdown","67889ac4":"markdown","22290870":"markdown","92201e0f":"markdown","ec62d4b0":"markdown","f66de07a":"markdown","38204817":"markdown","f35a7ce7":"markdown","c3d00530":"markdown","829e67b2":"markdown","45594148":"markdown","9ef1070c":"markdown","0c4ff43c":"markdown","0e413e8a":"markdown","04de43c6":"markdown","0ffff251":"markdown","d304787a":"markdown","61beb60a":"markdown","1338d918":"markdown","90a186dd":"markdown","99e886b1":"markdown","256d957f":"markdown","bf8f72a0":"markdown","f407e31a":"markdown","b0b60851":"markdown","98a8c113":"markdown","d97e96b1":"markdown","e59499fa":"markdown","b029c3df":"markdown","f302d94c":"markdown","e39a4229":"markdown","5240ae08":"markdown","43021b0c":"markdown","b5511bc5":"markdown","bfdaf68b":"markdown","d413149b":"markdown","41afbd7e":"markdown","bfd9c7c0":"markdown"},"source":{"c8cc5944":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib as plt","bdde4756":"dataset = pd.read_csv(\"..\/input\/hr-analytics-job-change-of-data-scientists\/aug_train.csv\")","22f69979":"df = dataset.copy()","03314b28":"df_test = pd.read_csv(\"..\/input\/hr-analytics-job-change-of-data-scientists\/aug_test.csv\")","db4f2f34":"df.head()","0383d605":"df.index = df[\"enrollee_id\"]","81f2a07c":"df.drop(\"enrollee_id\",axis = 1,inplace=True)","0627ff70":"df.drop(\"city\", axis=1, inplace=True)","93328675":"df_test.index = df_test[\"enrollee_id\"]","ec4ccaa6":"df_test.drop(\"enrollee_id\",axis = 1,inplace=True)","a8f95abf":"df_test.drop(\"city\", axis=1, inplace=True)","d1465d1f":"df.info()","2ef45346":"df[\"training_hours\"] = df[\"training_hours\"].astype(float)","717425f5":"df_test[\"training_hours\"] = df_test[\"training_hours\"].astype(float)","84672663":"df[\"gender\"].unique()","9f63092f":"sns.barplot(data = df, x = \"gender\", y = \"target\")","2710e3d0":"df[\"relevent_experience\"].unique()","63a72643":"sns.barplot(data = df, x = \"relevent_experience\", y = \"target\")","fb79d6b7":"df[\"enrolled_university\"].unique()","d7ae68da":"sns.barplot(data = df, x = \"enrolled_university\", y = \"target\")","36f09f73":"df[\"education_level\"].unique()","d4f10063":"sns.barplot(data = df, x = \"education_level\", y = \"target\")","60abede9":"df[\"major_discipline\"].unique()","c16284e9":"sns.barplot(data = df, x = \"major_discipline\", y = \"target\")","1ec7e76e":"df[\"experience\"].unique()","b1cd9b82":"sns.barplot(data = df, x = \"experience\", y = \"target\",order=[\"1\",\"2\",\">20\"])","b9db82b1":"df[\"company_size\"].unique()","c4b71b87":"sns.barplot(data = df, x = \"company_size\", y = \"target\")","0b0f574e":"df[\"company_type\"].unique()","fa317ae1":"sns.barplot(data = df, x = \"company_size\", y = \"target\")","9755ffd1":"df[\"last_new_job\"].unique()","46be3a46":"sns.barplot(data = df, x = \"last_new_job\", y = \"target\")","f51de030":"df.describe().T","5f21efc0":"df.corr()","8928518e":"df.isnull().sum()","b9dc993c":"import missingno as msno","68d65a59":"msno.bar(df);","84186218":"msno.matrix(df[df.isnull().any(axis=1)]);","3eb46ed2":"msno.matrix(df[df[\"education_level\"].isnull()]);","234ea594":"df[df[\"major_discipline\"].notnull()][\"education_level\"].unique()","5cd0cbfe":"df[df[\"education_level\"].isnull()][\"major_discipline\"].unique()","201056e3":"sns.countplot(df[df[\"major_discipline\"].isnull()][\"education_level\"]);","4e36b2b8":"df.dropna(subset=[\"education_level\",\"enrolled_university\",\"experience\",\"last_new_job\"],inplace = True)","04663191":"df[\"gender\"].fillna(\"Other\",inplace = True)","d75fd02d":"df[\"gender\"].unique()","7ce4c155":"indices = df[\"education_level\"] == \"High School\"\ndf.loc[indices,\"major_discipline\"] = df.loc[indices,\"major_discipline\"].fillna(\"No Major\")","0f4ff8aa":"indices = df[\"education_level\"] == \"Primary School\"\ndf.loc[indices,\"major_discipline\"] = df.loc[indices,\"major_discipline\"].fillna(\"No Major\")","2d3d520a":"df[\"major_discipline\"].unique()","6687062d":"df.dropna(subset=[\"major_discipline\"],inplace = True)","6a599f96":"df.isnull().sum()","35fcf658":"df.info()","f7ffb6da":"msno.matrix(df[df[\"company_type\"].isnull()]);","1a4184e1":"msno.matrix(df[df[\"company_size\"].isnull()]);","402b08c4":"sns.countplot(df[\"company_size\"])\nsns.set(rc={'figure.figsize':(15.7,8.27)})","f7d8973d":"sns.countplot(df[\"company_type\"])\nsns.set(rc={'figure.figsize':(15.7,8.27)})","c622e323":"sns.countplot(df[\"experience\"])","db58dc8b":"indices = df[df[\"company_size\"].isnull()][\"company_type\"] == \"Pvt Ltd\"\nsns.countplot(df[df[\"company_type\"] == \"Pvt Ltd\"][\"company_size\"])","7be3964f":"indices = df[\"experience\"] == \"<1\"\ndf.loc[indices,\"company_type\"] = df.loc[indices,\"company_type\"].fillna(\"No Company\")","baacc67f":"indices = df[\"company_type\"] == \"No Company\"\ndf.loc[indices,\"company_size\"] = df.loc[indices,\"company_size\"].fillna(\"No Company\")","b972b9d7":"df[\"company_type\"].fillna(df[\"company_type\"].mode()[0],inplace=True)","21b04adf":"df[\"company_size\"].fillna(df[\"company_size\"].mode()[0],inplace=True)","2a493022":"df.isnull().sum()","9fafe26e":"from pandas.api.types import CategoricalDtype","53769147":"df.education_level = df.education_level.astype(\n    CategoricalDtype(categories = ['Primary School','High School','Graduate', 'Masters','Phd'],\n                     ordered = True))\ndf.company_size = df.company_size.astype(\n    CategoricalDtype(categories = ['<10','10\/49','50-99','100-500','500-999','1000-4999','10000+', \n        'No Company'],\n                     ordered = True))","2e90b63b":"df_test.education_level = df_test.education_level.astype(\n    CategoricalDtype(categories = ['Primary School','High School','Graduate', 'Masters','Phd'],\n                     ordered = True))\ndf_test.company_size = df_test.company_size.astype(\n    CategoricalDtype(categories = ['<10','10\/49','50-99','100-500','500-999','1000-4999','10000+', \n        'No Company'],\n                     ordered = True))","b7545da1":"df.info()","7034ee7b":"df[\"experience\"].unique()","16ea594b":"df[\"experience\"].replace(\">20\",\"21\",inplace=True)","978e2d54":"df[\"experience\"].replace(\"<1\",\"0\",inplace=True)","7ab1052a":"df[\"experience\"] = df[\"experience\"].astype(int)","f576f5fd":"df_test[\"experience\"].replace(\">20\",\"21\",inplace=True)","48a8cdca":"df_test[\"experience\"].replace(\"<1\",\"0\",inplace=True)","45906ef9":"df_test[\"experience\"] = df[\"experience\"].astype(int)","8b427dcb":"df[\"last_new_job\"].unique()","dffdd1ca":"df[\"last_new_job\"].replace(\"never\",\"0\",inplace=True)\ndf[\"last_new_job\"].replace(\">4\",\"5\",inplace=True)\ndf[\"last_new_job\"] = df[\"last_new_job\"].astype(int)","595eacc6":"df_test[\"last_new_job\"].replace(\"never\",\"0\",inplace=True)\ndf_test[\"last_new_job\"].replace(\">4\",\"5\",inplace=True)\ndf_test[\"last_new_job\"] = df[\"last_new_job\"].astype(int)","2269a8be":"df.info()","563cbbc0":"df = pd.get_dummies(df, columns = [\"gender\"], prefix = [\"gender\"])\ndf = pd.get_dummies(df, columns = [\"relevent_experience\"], prefix = [\"relevent_experience\"])\ndf = pd.get_dummies(df, columns = [\"enrolled_university\"], prefix = [\"enrolled_university\"])\ndf = pd.get_dummies(df, columns = [\"education_level\"], prefix = [\"education_level\"])\ndf = pd.get_dummies(df, columns = [\"major_discipline\"], prefix = [\"major_discipline\"])\ndf = pd.get_dummies(df, columns = [\"company_size\"], prefix = [\"company_size\"])\ndf = pd.get_dummies(df, columns = [\"company_type\"], prefix = [\"company_type\"])","f4da99f1":"df_test = pd.get_dummies(df_test, columns = [\"gender\"], prefix = [\"gender\"])\ndf_test = pd.get_dummies(df_test, columns = [\"relevent_experience\"], prefix = [\"relevent_experience\"])\ndf_test = pd.get_dummies(df_test, columns = [\"enrolled_university\"], prefix = [\"enrolled_university\"])\ndf_test = pd.get_dummies(df_test, columns = [\"education_level\"], prefix = [\"education_level\"])\ndf_test = pd.get_dummies(df_test, columns = [\"major_discipline\"], prefix = [\"major_discipline\"])\ndf_test = pd.get_dummies(df_test, columns = [\"company_size\"], prefix = [\"company_size\"])\ndf_test = pd.get_dummies(df_test, columns = [\"company_type\"], prefix = [\"company_type\"])","2af17436":"df.head()","e72c71c7":"df.info()","62f28c9d":"df_test[\"company_type_No Company\"] = np.zeros(len(df_test))","724253b6":"df_test.info()","bda4e90d":"df.columns","af151c1f":"X = df.drop([\"target\", \"experience\",\"last_new_job\"],axis=1)\ny = df[\"target\"]","f9dcf550":"from sklearn.model_selection import train_test_split, GridSearchCV, cross_val_score\nfrom sklearn.metrics import accuracy_score","c97b5b59":"X_train, X_test, y_train, y_test = train_test_split(X, y, \n                                                    test_size = 0.30, \n                                                    random_state = 42)\n","3b6697b1":"from sklearn.linear_model import LogisticRegression\nloj = LogisticRegression(solver = \"liblinear\")\nloj_model = loj.fit(X_train,y_train)\nloj_model","78c225d1":"accuracy_score(y_test, loj_model.predict(X_test))","2cf65c10":"cross_val_score(loj_model, X_test, y_test, cv = 10).mean()","c877fbd7":"loj_model.predict_proba(X_train)[0:10][:,0:2]","02fafd40":"X_sampletest = df_test","1f2f009e":"X_sampletest = X_sampletest.drop([\"experience\"], axis=1)","a1c0857e":"X_sampletest = X_sampletest.drop([\"last_new_job\"], axis=1)","a84b4616":"submission = pd.DataFrame(index = X_sampletest.index)\nsubmission[\"target\"] = loj_model.predict_proba(X_sampletest)[:,0]","9fcf7e7c":"submission","243cc3b3":"submission[\"target\"].mean()","799608b2":"sns.countplot(loj_model.predict(X_sampletest))","5c9be1a5":"from sklearn.neighbors import KNeighborsClassifier\nknn = KNeighborsClassifier()\nknn_model = knn.fit(X_train, y_train)\nknn_model","bf86bdd7":"y_pred = knn_model.predict(X_test)","fa3bed8b":"accuracy_score(y_test, y_pred)","1c3b23b8":"knn_params = {\"n_neighbors\": np.arange(1,50)}","4a15149b":"knn = KNeighborsClassifier()\nknn_cv = GridSearchCV(knn, knn_params, cv=10)\nknn_cv.fit(X_train, y_train)","826fd0e4":"print(\"Best Score:\" + str(knn_cv.best_score_))\nprint(\"Best Parameters: \" + str(knn_cv.best_params_))","b6299cb8":"knn = KNeighborsClassifier(33)\nknn_tuned = knn.fit(X_train, y_train)","30106338":"knn_tuned.score(X_test, y_test)","8d1ae84a":"y_pred = knn_tuned.predict(X_test)","385d93e3":"submission = pd.DataFrame(index = X_sampletest.index)\nsubmission[\"target\"] = knn_tuned.predict_proba(X_sampletest)[:,0]","8fa45681":"submission","fde7d303":"submission[\"target\"].mean()","901f8c95":"sns.countplot(knn_tuned.predict(X_sampletest))","4fdce20d":"loj_model.coef_.sort()\nloj_pd = pd.DataFrame(loj_model.coef_)\nloj_pd.columns = X_sampletest.columns","9cdcda91":"coef = sns.barplot(x=loj_pd.columns, y = loj_pd.T[0])\nfor item in coef.get_xticklabels():\n    item.set_rotation(90)","a6464702":"It is better to build another model to validate the results. We will use KNN to do that.","ec2ce16f":"We get 72.5% accuracy from KNN. It is better to tune parameters, so we may build a better KNN Model.","b8640161":"Reading train and test data","c60754f4":"We should analyze the missing data. \nWe should carefully analyze them, because we want to keep as many data as we can to increase success ratio of our model.","80b6c97a":"Now it is time to deal with former experience.","982382d7":"Each variable should be analyzed individually.","4211b08f":"# BONUS: Weights of Variables","71a49034":"Hard part is over. Now we implent logistic regression and KNN for classification.","cd619118":"Now we have our tuned model with 75% accuracy, which is ver close to the accuracy of Logistic Regression, which was 77%.","ab544772":"We begin with assigning ordinal categories.","4ec58c54":"## Tuning df Table","faf8c365":"# Modifying Variables","70334951":"It gives the probabilities. So we prepare the final test data to get results.","a3445225":"After dealing with the missing values, it is time to prepare the variables.","60a92a37":"## Variable Analysis","5996fbff":"As seen in the above table, simply dropping the rows containing missing values may cause losses of thousands of data rows.","85392904":"We will use GridSearch Cross validation to test the parameters.","268d4415":"## Dummy Varibles for Categories","ccb19ca1":"Since these variable are biased, we fill the remaining missings with the mode values.","7d7fadb5":"We can fill some missing values by matching education related variables. So let's visualize that.","c7b32db0":"There are so many missing values in gender, but also other. We can assume that missing values can be interpreted as other. ","9bb9d6cc":"Importing essentials","782b6ea7":"There is a mismatch between the test and train data in terms of variables now. To eliminate that we add the missing variable to the test data.","4274a707":"## Logistic Regression","0efd6221":"We can argue that someone having major discipline should also have college degree.","be9741a8":"### Defining Ordinal Categories","0f686efd":"## Load Dataset","c9493a20":"We implement similar procedure for last_new_job.","59a23bcd":"We drop some variables which has no values.","8bf9ff36":"### Changing Categories into Integers","b10b539d":"There it is. This submission dataframe is created with logistic regression model. Let's check some metrics.","cd98c66e":"Since there is city development index, we drop city to keep the data simple.","cc13c723":"## Missing Values","b9d58c86":"As seen, nearly 2000 of the given candidates will get 0 as target value.","56f3142a":"# Validity of Education Related Values","f5b9d644":"We assign dependent and independent variables for our model.","05563767":"As seen when either of company_size or company_type the other one is missing. It is understandable. It is probably the candidates do not want to share that information or have no former experience.","67889ac4":"Also, when there is no company, there is also \"No Company\" size.","22290870":"## Model Tuning","92201e0f":"We can make one more assumption. If the candidates with less than one year experience, has no previous company. So we label them as \"No Company\".","ec62d4b0":"We replicate for the test data.","f66de07a":"For future references, it is important to understand the weights of the variables on the target values. So let's examine that by visualizing.","38204817":"The remaining categories are represented with dummy variables so the algorithms can recognize them.","f35a7ce7":"## KNN ","c3d00530":"The visualization of the candidates whose major is missing shows that these persons are mostly have no colloge degree. Therefore, we can drop them.","829e67b2":"There it is again with the KNN Model. Let's check the metrics for these results.","45594148":"We can start dropping the rows for the following variables because they are very few.","9ef1070c":"First, we assign enrollee id as index","0c4ff43c":"For example, experience is stated in terms of years. But before making them numeric, non-numeric values should be defined in terms of numeric values. So \">20\" and \"<1\" are changed as \"21\" and \"0\", respectively. Since these values are taken as it is, we assume that changing \">20\" as \"21\" will not be problematic.","0e413e8a":"Categories can not be recognized by the algorithms, so it is better to change them into numeric values as long as it is possible.","04de43c6":"Based on the result, we can conclude that we can get 75% accuracy by using 33 neigbors. Let's try that by building a tuned model.","0ffff251":"Now we have only company related missing values. Also, there are still nearly 18.000 row. So far so good.","d304787a":"We split the data to check the model accuracy.","61beb60a":"There are many missing data in major, but consider that these people have mostly no college degree. So dropping all of them will make our data biased. Instead it is better to add a category \"No Major\" for no college degrees. If there is a college degree there has to be a major (at least as other). So it is better to drop them.","1338d918":"Now we analyze the variables individually to check the validity of the data.","90a186dd":"## Filling NaN in gender with Other","99e886b1":"### Dropping NaN for \"education_level\",\"enrolled_university\",\"experience\",\"last_new_job\"","256d957f":"# MODEL","bf8f72a0":"I hope you have enjoyed it. I will follow your recommendations for improvement.","f407e31a":"We have created our Logistic Regression Model. It gave 77% accuracy score. Now it is time to use the model to predict our values.","b0b60851":"Final Results:\n- - -\nLogistic Regression\n\nMean:0.78, Number of 0s: Nearly 2000\n- - -\nKNN\n\nMean:0.77, Number of 0s: Just over 2000","98a8c113":"We go deeper with the missing values. To gain better insight, we visualize them.","d97e96b1":"The above figures show that company_type and company_size data are biased. Clearly, most of the candidates states Pvt Ltd. Let's further examine this variable with company_size.","e59499fa":"Finally, we have no remaining missing values.","b029c3df":"Type of Training hours can be float. It will be better for the modelling.","f302d94c":"### Who has major discipline but no College Degree?","e39a4229":"Also, we check the numeric data.","5240ae08":"The best parameter to be tuned for KNN is number of neigbors. So we give numbers from 1 to 50 to find the best value.","43021b0c":"It is hard to tell from the above table. So we begin to use our logic by analyzing dependecy of variables.","b5511bc5":"### Changing Major Discipline from \"NaN\" to \"No Major\" for candidates having no college degree","bfdaf68b":"We can say size of the most of Pvt Ltd is 50-99.","d413149b":"### Validating Experience Variables","41afbd7e":"We conclude that when education_level value is missing, so the major_discipline is missing. We should ask ourself some basic questions.","bfd9c7c0":"This query states that the data is valid in this context. We can also run the following query."}}