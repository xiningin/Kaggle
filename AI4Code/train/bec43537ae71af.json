{"cell_type":{"985b6754":"code","d572492e":"code","20318536":"code","6ce790b0":"code","bee3b9dc":"code","8d591cfd":"code","7ad81fa8":"code","b7069b3d":"code","25ad8dee":"code","5e4c52d4":"code","38537e0a":"code","8a923f3a":"code","1cfa5d9b":"code","64e22f4d":"code","3a14a71b":"code","3446e144":"code","ec7c7ea8":"code","28ea5254":"code","f7e26962":"code","ed017f84":"code","464beb6d":"code","00df7c3c":"code","d9a1b9a5":"code","8d8f8957":"code","dd5b250a":"markdown","3bf1f69d":"markdown","d8e5de8e":"markdown","37ee2102":"markdown","f8fefbc2":"markdown","cbbc4d04":"markdown","9ae90609":"markdown","82d385de":"markdown","8fe39022":"markdown","3e99b468":"markdown","78d8cb74":"markdown","03ecf6eb":"markdown","df7b5eae":"markdown","4e3b9edf":"markdown","a0493f4b":"markdown","f9efc391":"markdown","a8f51c51":"markdown","fb129196":"markdown","bb52ce89":"markdown","d8669e4c":"markdown","b7fafad8":"markdown","02b385eb":"markdown","c7de1b70":"markdown","582e5534":"markdown","2e5dd9a9":"markdown","1ae9a94f":"markdown","84676b50":"markdown"},"source":{"985b6754":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","d572492e":"data = pd.read_csv('..\/input\/column_2C_weka.csv')","20318536":"data.head()","6ce790b0":"data.info()","bee3b9dc":"data['class'].value_counts()","8d591cfd":"d_stat = data.describe()\nd_stat","7ad81fa8":"data.corr()","b7069b3d":"x_names = list(d_stat.columns) # Using the columns for the each orthopedic status'names.\ny_values = list(d_stat.mean()) # Using the mean values for the each feature.\nplt.figure(figsize=(10,5))\nsns.barplot(x=x_names, y=y_values)\nplt.xticks(rotation=45)\nplt.ylabel('Mean values of 310 the patients')\nplt.show()","25ad8dee":"# Filtering only abnormal patients:\nd_new = data[data['class'] == 'Abnormal']\n\n# Our graphics x will be pelvic incidence and y will be sacral slope values:\nx = np.array(d_new.loc[:,'pelvic_incidence']).reshape(-1,1)\ny = np.array(d_new.loc[:, 'sacral_slope']).reshape(-1,1)","5e4c52d4":"# Now visualize the values:\nplt.figure(figsize=(9,9))\nplt.scatter(x=x, y=y, color='purple', alpha=0.3)\nplt.xlabel('Pelvic Incidence Values')\nplt.ylabel('Sacral Slope Values')\nplt.show()","38537e0a":"from sklearn.linear_model import LinearRegression\n\nlr = LinearRegression()\nlr.fit(x,y)","8a923f3a":"# Predicting new y values from our data's x values:\ny_head = lr.predict(x)\n\nplt.figure(figsize=(9,9))\nplt.scatter(x,y, color='purple', alpha=0.3, label='patients')\nplt.plot(x, y_head, color='blue', label='linear')\nplt.xlabel('Pelvic Incidence Values')\nplt.ylabel('Sacral Slope Values')\nplt.legend()\nplt.show()","1cfa5d9b":"print('Sacral Slope Value of the Patient with 100 Pelvic Incidence Value: ', lr.predict([[110]]))","64e22f4d":"from sklearn.metrics import r2_score\nprint('Our models r square score is: ', r2_score(y, y_head))","3a14a71b":"from sklearn.preprocessing import PolynomialFeatures\npoly = PolynomialFeatures(degree=2)\n\nx_poly = poly.fit_transform(x)\n\nlr2 = LinearRegression()\nlr2.fit(x_poly, y)\ny_head2 = lr2.predict(x_poly)","3446e144":"plt.figure(figsize=(9,9))\nplt.scatter(x,y, color='purple', alpha=0.3, label='patients')\nplt.plot(x, y_head, color='blue', alpha=0.6, label='linear')\nplt.plot(x, y_head2, color='green', alpha=0.6, label='poly')\nplt.xlabel('Pelvic Incidence Values')\nplt.ylabel('Sacral Slope Values')\nplt.legend()\nplt.show()","ec7c7ea8":"# Polynomial Linear Regression Prediction:\nprint('Sacral Slope Value of the Patient with 100 Pelvic Incidence Value: ', lr2.predict([[1,110,12100]]))\n\n# Linear Regression Prediction:\nprint('Sacral Slope Value of the Patient with 100 Pelvic Incidence Value: ', lr.predict([[110]]))","28ea5254":"from sklearn.metrics import r2_score\nprint('Our linear models r square score is: ', r2_score(y, y_head))\nprint('Our polynomial models r square score is: ', r2_score(y, y_head2))","f7e26962":"from sklearn.tree import DecisionTreeRegressor\ntree = DecisionTreeRegressor()\n\ntree.fit(x,y)\n\nx_tree = np.arange(min(x), max(x),0.1).reshape(-1,1)\ny_tree = tree.predict(x_tree)","ed017f84":"plt.figure(figsize=(9,9))\nplt.scatter(x,y, color='purple', alpha=0.4, label='patients')\nplt.plot(x, y_head, color='blue', alpha=0.6, label='linear') # Linear regression model fitted line\nplt.plot(x, y_head2, color='green', alpha=0.6, label='poly') # Polynomial linear regression model fitted line\nplt.plot(x_tree, y_tree, color='orange', alpha=0.5, label='decision tree') # Decision tree regression model fitted line\nplt.xlabel('Pelvic Incidence Values')\nplt.ylabel('Sacral Slope Values')\nplt.legend()\nplt.show()","464beb6d":"# Linear Regression Prediction:\nprint('Sacral Slope Value of the Patient with 100 Pelvic Incidence Value: ', lr.predict([[110]]))\n\n# Polynomial Linear Regression Prediction:\nprint('Sacral Slope Value of the Patient with 100 Pelvic Incidence Value: ', lr2.predict([[1,110,12100]]))\n\n# Decision Tree Linear Regression Prediction:\nprint('Sacral Slope Value of the Patient with 100 Pelvic Incidence Value: ', tree.predict([[110]]))","00df7c3c":"from sklearn.ensemble import RandomForestRegressor\n\nforest = RandomForestRegressor(n_estimators=100, random_state=42)\n\nforest.fit(x,y)\n\nx_for = np.arange(min(x), max(x),0.1).reshape(-1,1)\ny_for = forest.predict(x_for)","d9a1b9a5":"plt.figure(figsize=(15,15))\nplt.subplot(2,2,1)\nplt.scatter(x,y, color='purple', alpha=0.3, label='patients')\nplt.plot(x, y_head, color='blue', alpha=0.6, label='linear')\nplt.xlabel('Pelvic Incidence Values')\nplt.ylabel('Sacral Slope Values')\nplt.legend()\n\nplt.subplot(2,2,2)\nplt.scatter(x,y, color='purple', alpha=0.3, label='patients')\nplt.plot(x, y_head2, color='green', alpha=0.6, label='poly')\nplt.xlabel('Pelvic Incidence Values')\nplt.ylabel('Sacral Slope Values')\nplt.legend()\n\nplt.subplot(2,2,3)\nplt.scatter(x,y, color='purple', alpha=0.3, label='patients')\nplt.plot(x_tree, y_tree, color='orange', alpha=0.6, label='decision tree')\nplt.xlabel('Pelvic Incidence Values')\nplt.ylabel('Sacral Slope Values')\nplt.legend()\n\nplt.subplot(2,2,4)\nplt.scatter(x,y, color='purple', alpha=0.3, label='patients')\nplt.plot(x_for, y_for, color='red', alpha=0.6, label='random forest')\nplt.xlabel('Pelvic Incidence Values')\nplt.ylabel('Sacral Slope Values')\nplt.legend()\nplt.show()","8d8f8957":"# Linear Regression Prediction:\nprint('Sacral Slope Value of the Patient with 100 Pelvic Incidence Value: ', lr.predict([[110]]))\n\n# Polynomial Linear Regression Prediction:\nprint('Sacral Slope Value of the Patient with 100 Pelvic Incidence Value: ', lr2.predict([[1,110,12100]]))\n\n# Decision Tree Linear Regression Prediction:\nprint('Sacral Slope Value of the Patient with 100 Pelvic Incidence Value: ', tree.predict([[110]]))\n\n# Random Forest Regression Prediction:\nprint('Sacral Slope Value of the Patient with 100 Pelvic Incidence Value: ', forest.predict([[110]]))","dd5b250a":"Let's import sklearn linear regression library and then create our linear regression model based on x and y features which are pelvic incidence and sacral slope values.","3bf1f69d":"And now compare the same results for the three models:","d8e5de8e":"From the graph above one can see if pelvic incidence value is high, sacral slope value of the patient is high as well. \nNow lets make a linear regression model for our data.","37ee2102":"I will be using only two features 'sacral slope' and 'pelvic incidence' which are higly correlated. And filter only abnormal patients.","f8fefbc2":"**RANDOM FOREST REGRESSION**","cbbc4d04":"As you can see from the graph above, we don't have a patient with a 110 pelvic incidence status. \nFrom our model we want the computer to guess the result.","9ae90609":"First of all let's look at our dataset:","82d385de":"**DECISION TREE LINEAR REGRESSION**","8fe39022":"Now let's ask the same question to the computer. And compare the results by linear and polynomial models.","3e99b468":"**COMPARISON OF REGRESSION MODELS FROM BIOMECHANICAL FEATURES OF ORTHOPEDIC PATIENTS DATASET**","78d8cb74":"In this kernel I compare linear regression, polynomial regression, decision tree regression and random forest regression models from orthopedic patients'data. ","03ecf6eb":"Features closer to 1 are more correlated with the other. \nFrom the correlation analysis one can say pelvic incidence and sacral slope are related, because of high correlation value (0.81).","df7b5eae":"Lets see the statistics of the each feature:","4e3b9edf":"**REGRESSION ANALYSIS**","a0493f4b":"Polynomial linear regression r\u02c62 score is slightly greater (closer to 1) which is better.","f9efc391":"Finally compare the results from the four models:","a8f51c51":"**ANALYSING THE DATA**","fb129196":"**POLYNOMIAL LINEAR REGRESSION**","bb52ce89":"**Question:** What is the sacral slope value of a patient with a pelvic incidence value of 110?","d8669e4c":"Now lets create our decision tree linear regression using the dataset. \nThen we can create a fitted graph.\nAnd finally we can predict the same value and compare the result with our previous models.","b7fafad8":"Now lets visualize our 310 patients' mean orthopedic status:","02b385eb":"We can see 310 patients'orthopedic values are used in this dataset. And their overall status is classified as normal or abnormal.","c7de1b70":"If we compare our linear regression and polynomial regression model r\u02c62 score values:","582e5534":"Model is working better as the r square score value reaches to 1.\nOur model's r square score value is 0.64 which is not that great.\nNow we can try another model like polynomial linear regression.","2e5dd9a9":"So we created a linear regression model and we can predict sacral slope values from given pelvic incidence values. \nBut how can we know that our model is good enough? \nIn order to see our models correction, we have to evaluate r square score value of our model.","1ae9a94f":"In order to see the correlation between the features we can use: ","84676b50":"**LINEAR REGRESSION**"}}