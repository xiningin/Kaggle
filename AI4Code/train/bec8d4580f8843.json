{"cell_type":{"54a087d3":"code","9bde9b34":"code","b8da768a":"code","6f447ad6":"code","f5240425":"code","0f957e8b":"code","1697decb":"code","05503b5f":"code","135e3d89":"code","b3d0ff04":"code","3244729b":"code","b1ffd4d1":"code","19265bd5":"code","e70856ce":"code","e44f1ad3":"code","24d6a867":"code","24a6d313":"code","dfb00ad9":"code","f277bf5a":"code","bcc33c7b":"code","8da94e44":"code","007d7a97":"code","fbdb5747":"code","3a3a9ae9":"code","4ba0f923":"code","f98208ec":"code","e600eb94":"code","18450473":"code","597ebc5f":"code","61530bd1":"code","d7ec18e5":"code","9dea405d":"code","595aacf9":"code","c55881f3":"code","880f722e":"code","caf0cb8a":"code","07d5a76f":"markdown","10b5cb92":"markdown","cd32b915":"markdown","15864daf":"markdown","3c83cd4e":"markdown","3f29aa73":"markdown","5b4cbc67":"markdown","06b9988a":"markdown","c9a25d65":"markdown","26330ac6":"markdown","eca85c22":"markdown","2957a98c":"markdown","f0cb0c8f":"markdown","b212e4fb":"markdown","5025a2c1":"markdown","5a1d726a":"markdown","ba40fefc":"markdown","fc9396bc":"markdown","4ffe140f":"markdown","f186aa08":"markdown","615477cc":"markdown","d485b127":"markdown","e45c0ed0":"markdown","3d453f11":"markdown","899b5c38":"markdown","b82a5c39":"markdown"},"source":{"54a087d3":"# import libraries\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nfrom sklearn import metrics\nfrom sklearn import preprocessing\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split","9bde9b34":"%matplotlib inline\nsns.set(style = 'darkgrid')\nsns.set_palette('deep')","b8da768a":"# read the data\ndata = pd.read_csv('\/kaggle\/input\/goodreadsbooks\/books.csv', error_bad_lines = False)","6f447ad6":"# show the first few rows\ndata.head(5)","f5240425":"# check basic features and data types\ndata.info()","0f957e8b":"# check no. of records\nlen(data)","1697decb":"# check for doublications\ndata.duplicated().any()","05503b5f":"sns.heatmap(data.isnull(), cmap='viridis')","135e3d89":"# ratings distribution\nsns.kdeplot(data['average_rating'], shade = True)\nplt.title('Rating Distribution\\n')\nplt.xlabel('Rating')\nplt.ylabel('Frequency')","b3d0ff04":"# top 5 languages\ndata['language_code'].value_counts().head(5).plot(kind = 'pie', autopct='%1.1f%%', figsize=(8, 8)).legend()","3244729b":"# number of books per rating\nsns.barplot(data['average_rating'].value_counts().head(15).index, data['average_rating'].value_counts().head(15))\nplt.title('Number of Books Each Rating Received\\n')\nplt.xlabel('Ratings')\nplt.ylabel('Counts')\nplt.xticks(rotation=45)","b1ffd4d1":"# highest rated books\npopular_books = data.nlargest(10, ['ratings_count']).set_index('title')['ratings_count']\nsns.barplot(popular_books, popular_books.index)","19265bd5":"# highest reviewed books\nhighest_reviews = data.nlargest(10, ['text_reviews_count'])\nsns.barplot(highest_reviews['text_reviews_count'], highest_reviews['title'])","e70856ce":"# top 10 books under 200 pages for busy book lovers\nunder200 = data[data['# num_pages'] <= 200]\ntop10under200 = under200.nlargest(10, ['ratings_count'])\nsns.barplot(top10under200['ratings_count'], top10under200['title'], hue=top10under200['average_rating'])\nplt.xticks(rotation=15)","e44f1ad3":"# top 10 longest books\nlongest_books = data.nlargest(10, ['# num_pages']).set_index('title')\nsns.barplot(longest_books['# num_pages'], longest_books.index)","24d6a867":"# top languages\ndata['language_code'].value_counts().plot(kind='bar')\nplt.title('Most Popular Language')\nplt.ylabel('Counts')\nplt.xticks(rotation = 90)","24a6d313":"# top published books\nsns.barplot(data['title'].value_counts()[:15], data['title'].value_counts().index[:15])\nplt.title('Top Published Books')\nplt.xlabel('Number of Publications')","dfb00ad9":"# authors with highest rated books\nplt.figure(figsize=(10, 5))\nauthors = data.nlargest(5, ['ratings_count']).set_index('authors')\nsns.barplot(authors['ratings_count'], authors.index, ci = None, hue = authors['title'])\nplt.xlabel('Total Ratings')","f277bf5a":"# authors with highest publications\ntop_authors = data['authors'].value_counts().head(9)\nsns.barplot(top_authors, top_authors.index)\nplt.title('Authors with Highest Publication Count')\nplt.xlabel('No. of Publications')","bcc33c7b":"# visualise a bivariate distribution between ratings & no. of pages\nsns.jointplot(x = 'average_rating', y = '# num_pages', data = data)","8da94e44":"# visualise a bivariate distribution between ratings & no. of reviews\nsns.jointplot(x = 'average_rating', y = 'text_reviews_count', data = data)","007d7a97":"# find no. of pages outliers\nsns.boxplot(x=data['# num_pages'])","fbdb5747":"# remove outliers from no. of pages \ndata = data.drop(data.index[data['# num_pages'] >= 1000])","3a3a9ae9":"# find ratings count outliers\nsns.boxplot(x=data['ratings_count'])","4ba0f923":"# remove outliers from ratings_count\ndata = data.drop(data.index[data['ratings_count'] >= 1000000])","f98208ec":"# remove outliers from text_reviews_count\ndata = data.drop(data.index[data['text_reviews_count'] >= 20000])","e600eb94":"# encode title column\nle = preprocessing.LabelEncoder()\ndata['title'] = le.fit_transform(data['title'])","18450473":"# encode authors column\ndata['authors'] = le.fit_transform(data['authors'])","597ebc5f":"# encode language column\nenc_lang = pd.get_dummies(data['language_code'])\ndata = pd.concat([data, enc_lang], axis = 1)","61530bd1":"# divide the data into attributes and labels\nX = data.drop(['average_rating', 'language_code', 'isbn'], axis = 1)\ny = data['average_rating']","d7ec18e5":"# split 80% of the data to the training set and 20% of the data to test set \nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.25, random_state = 10)","9dea405d":"lr = LinearRegression()\nlr.fit(X_train, y_train)","595aacf9":"predictions = lr.predict(X_test)","c55881f3":"pred = pd.DataFrame({'Actual': y_test.tolist(), 'Predicted': predictions.tolist()}).head(25)\npred.head(10)","880f722e":"# visualise the above comparison result\npred.plot(kind='bar', figsize=(13, 7))","caf0cb8a":"# evaluate the performance of the algorithm\nprint('MAE:', metrics.mean_absolute_error(y_test, predictions))\nprint('MSE:', metrics.mean_squared_error(y_test, predictions))\nprint('RMSE:', np.sqrt(metrics.mean_squared_error(y_test, predictions)))","07d5a76f":"# Data Cleaning","10b5cb92":"### 2) Feature Engineering","cd32b915":"### 1) Anomaly Detection","15864daf":"Data preprocessing is the conversion of data into machine-readable form can be interpreted, analysed and used by machine learning algorithms. In this analysis we will apply anomaly detection and feature engineering techniques.","3c83cd4e":"The main goal of this section is to remove extreme outliers (abnormal distance from other values) from features, this will have a positive impact on the accuracy of the model.","3f29aa73":"Next step is to use the test data to check accurately our algorithm predicts the percentage score.","5b4cbc67":"Above plot shows points between 20,000 to 80,000 are outliers","06b9988a":"The aim of this section is to come up with a model for predicting the book ratings. We'll use linear regression to build a model that predicts book ratings. Linear regression algorithm is a basic predictive analytics technique. There are two kinds of variables in a linear regression model:\n1. The __input__ or __predictor variable__ is the variable(s) that help predict the value of the output variable. It is commonly referred to as __X__.\n2. The __output variable__ is the variable that we want to predict. It is commonly referred to as __Y__.","c9a25d65":"# Data Exploration","26330ac6":"The dataset contains both numerical and categorical data types.","eca85c22":"# Machine Learning Model","2957a98c":"Above plot shows points between 1,000 to 6,000, these are outliers as there are not included in the box of other observation i.e no where near the quartiles.","f0cb0c8f":"# Data Exploration","b212e4fb":"Though the model is not very precise, the predicted percentages are close to the actual ones.","5025a2c1":"Attributes are the independent variables whilst labels are dependent variables whose values are to be predicted.","5a1d726a":"# Data Visualisation","ba40fefc":"Over 95% of books are in English, which means this variable is nearly constant!","fc9396bc":"The goal of this analysis is to predict book rating and to understand what are the important factors that make a book more popular than others. The sections of this analysis include:\n1. Data Exploration\n2. Data Cleaning\n3. Data Visualisation\n4. Data Preprocessing\n5. Machine Learning Model","4ffe140f":"Let's use heatmap to visualise above result!","f186aa08":"# Goodreads Rating Prediction Using Linear Regressio","615477cc":"No duplicated or missing values, that makes things a little easier.","d485b127":"Feature engineering is the process of selecting and transforming variables when creating a predictive model. Many machine learning algorithms require that their input is numerical and therefore categorical features such as title, authors and language code must be transformed into numerical features before we can use any of these algorithms.","e45c0ed0":"Now compare the actual output values for X_test with the predicted values.","3d453f11":"test_size variable is where we actually specify the proportion of the test set. Now to train our algorithm, we need to import LinearRegression class instantiate it, and call the fit() method along with the training data.","899b5c38":"Above plot shows points between 1,000,000 to 5,000,000 are outliers.","b82a5c39":"# Data Preprocessing"}}