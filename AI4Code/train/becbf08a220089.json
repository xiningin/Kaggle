{"cell_type":{"bd8c6c76":"code","4e815565":"code","c534617b":"code","0a73289a":"code","8bf5137d":"code","64b31151":"code","982f8cba":"code","9f64e7f7":"code","e5e18cb0":"code","7433f218":"code","dc837991":"code","a5bcf0fd":"code","f8ca1b50":"code","c50710fa":"code","2a5e8f90":"code","4fbb5995":"code","4102f02a":"code","2a272a22":"code","dee3c0b4":"code","9dec4198":"code","5cad3a69":"code","dcf29808":"code","17ac7e56":"code","6ede4caf":"code","7265b338":"code","266762d3":"code","33115801":"code","427f8cea":"code","3babf2d7":"code","e9926d1d":"code","295e579e":"code","9041c4c3":"code","7b1170be":"code","48a462f7":"code","ad8c01ab":"markdown","2c4aa5b0":"markdown","a0ffec6c":"markdown"},"source":{"bd8c6c76":"import pandas as pd\n","4e815565":"df=pd.read_csv('..\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')\ndf.head(10)","c534617b":"df.shape\n\n","0a73289a":"df.describe()","8bf5137d":"df['DEATH_EVENT'].value_counts()","64b31151":"#checking for missing values\ndf.isnull().sum()","982f8cba":"import matplotlib.pyplot as plt\nimport seaborn as sns\n","9f64e7f7":"#checking correlation\ndf.corr()","e5e18cb0":"#heatmap for corr\nsns.heatmap(df.corr(),cmap=\"YlGnBu\")","7433f218":"#handling Outliers using percentile method\n\ndf.columns\nmini=df['creatinine_phosphokinase'].quantile(0.02)\ndf[df['creatinine_phosphokinase']<mini]\nmaxi=df['creatinine_phosphokinase'].quantile(.978)\ndf[df['creatinine_phosphokinase']>maxi]\n\ndf2=df[(df['creatinine_phosphokinase']>=mini) & (df['creatinine_phosphokinase']<maxi)]\ndf2.sample(10)","dc837991":"df2.describe()","a5bcf0fd":"#handling outliers using Z score or standard ditribution\nsns.distplot(df2['platelets'])","f8ca1b50":"mean=df2['platelets'].mean()\nsd=df2['platelets'].std()\ndf2['zscore']=(df2.platelets-mean)\/sd\ndf2.shape\ndf2 =df2[(df2['zscore']<3) & (df2['zscore']>-3)]\nsns.distplot(df2['platelets'])\ndf2.shape\n","c50710fa":"plt.hist(df['serum_sodium'])","2a5e8f90":"sns.boxplot(y='serum_sodium',data=df2)","4fbb5995":"plt.boxplot(df['serum_sodium'])","4102f02a":"Q1=df2['serum_sodium'].quantile(0.25)\nQ3=df2['serum_sodium'].quantile(0.75)\niqr=Q3-Q1\nlowerlimit=Q1-1.5*iqr\nupperlimit=Q3+1.5*iqr\n","2a272a22":"df2=df2[(df2['serum_sodium']>lowerlimit) & (df2['serum_sodium']<upperlimit)]\ndf2\n","dee3c0b4":"X=df.iloc[:,:12]\ny=df['DEATH_EVENT']","9dec4198":"from sklearn.ensemble import ExtraTreesClassifier\nmodel=ExtraTreesClassifier()\nmodel.fit(X,y)","5cad3a69":"imp=pd.Series(data=model.feature_importances_,index=X.columns)\nimp.nlargest(5).plot(kind ='bar')","dcf29808":"sns.jointplot('time','ejection_fraction',data=df2,kind ='reg')\nsns.pairplot(df2,hue='DEATH_EVENT')","17ac7e56":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test= train_test_split(X,y,random_state=0)\ny_train","6ede4caf":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import RandomizedSearchCV\nimport numpy as np\n#Randomized search CV\n\n\nn_estimators=[int(i) for i in np.linspace(100,1200,12)]\nmax_features=['auto','sqrt','log2']\nmax_depth=[int(i) for i in np.linspace(5,30,6)]\nmin_samples_leaf=[1,2,5,10]","7265b338":"#create random_grid\nrandom_grid={'n_estimators':n_estimators,\n            'max_features':max_features,\n            'max_depth':max_depth,\n            'min_samples_leaf':min_samples_leaf}\nrandom_grid","266762d3":"rf=RandomForestClassifier()\nrandom=RandomizedSearchCV(estimator=rf,param_distributions=random_grid,n_iter=10,cv=5,verbose=2,scoring='roc_auc',random_state=42,return_train_score=True,n_jobs=1)\nrandom.fit(X_train,y_train)\n","33115801":"random.best_params_","427f8cea":"random.best_score_","3babf2d7":"random.score(X_test,y_test)","e9926d1d":"plt.figure()\nplt.plot(df2[df2['DEATH_EVENT']==1]['time'],df2[df2['DEATH_EVENT']==1]['platelets'],'ro',label='yes')\nplt.plot(df2[df2['DEATH_EVENT']==0]['time'],df2[df2['DEATH_EVENT']==0]['platelets'],'bo',label='no')\nplt.legend()","295e579e":"y_pred=random.predict(X_test)\ny_pred","9041c4c3":"sns.distplot(y_pred-y_test,bins=5)\n\n#we get a very narrow normal distribution whuch shows are model is performimg very well","7b1170be":"plt.scatter(y_pred,y_test)","48a462f7":"import pickle\n\nwith open('random_forest_classifier.pkl','wb') as file:\n    pickle.dump(random,file) #dumps the model as pickle file","ad8c01ab":"# handling outliers using Z score or standard ditribution","2c4aa5b0":"# IQR method to remove outliers","a0ffec6c":"## handling Outliers using percentile method"}}