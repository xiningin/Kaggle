{"cell_type":{"c457451f":"code","a11c3e16":"code","b434010b":"code","c8c29127":"code","0890d8f2":"code","fa38eef9":"code","04256097":"code","60357748":"code","30ee9ee6":"code","843b34a1":"code","95adcc66":"code","6740672c":"code","290445be":"code","b1f23e2f":"code","37cae50b":"code","e67511fc":"code","2b6c1543":"code","33376d42":"code","6b84d8ff":"code","c7135c9b":"code","6e82f38b":"code","d306a79b":"code","8ccea029":"code","2dc95a48":"code","f965d479":"code","0c1e67c0":"code","34054e2b":"code","f548c993":"code","932b2453":"code","fad21c20":"code","68ff27e4":"code","0a3c4a33":"code","1b8cf7ec":"code","6d589441":"code","0e5d7179":"code","406d2198":"code","7cd4b280":"code","2415476e":"code","5a0f2a5d":"code","2766087f":"code","dffdd66b":"markdown","0cbdd84c":"markdown","a3b8dbea":"markdown","d9fe1995":"markdown","85cd5687":"markdown","ba49e9aa":"markdown","d708caff":"markdown","15a4220c":"markdown","ef98a08c":"markdown","c4750536":"markdown","91b04c8c":"markdown","f31a2d5f":"markdown","45bd7148":"markdown","db2c4757":"markdown"},"source":{"c457451f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nfrom matplotlib import pyplot as plt\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a11c3e16":"data = pd.read_csv('\/kaggle\/input\/students-performance-in-exams\/StudentsPerformance.csv')","b434010b":"data.head()","c8c29127":"plt.figure(figsize=(10,6))\nsns.countplot(data.gender)","0890d8f2":"# Almost 50-50","fa38eef9":"plt.figure(figsize=(10,6))\nsns.countplot(data['race\/ethnicity'])","04256097":"plt.figure(figsize=(15,6))\nsns.countplot(data['parental level of education'])","60357748":"plt.figure(figsize=(10,6))\nsns.countplot(data.lunch)","30ee9ee6":"plt.figure(figsize=(10,6))\nsns.countplot(data['test preparation course'])","843b34a1":"plt.figure(figsize=(12,8))\nsns.kdeplot(data['math score'])\nsns.kdeplot(data['reading score'])\nsns.kdeplot(data['writing score'])","95adcc66":"# Math a bit more difficult","6740672c":"data['mean_score'] = (data['math score'] + data['reading score'] + data['writing score']) \/ 3","290445be":"plt.figure(figsize=(12,8))\nsns.kdeplot(data[data.gender == 'female']['mean_score'])\nsns.kdeplot(data[data.gender == 'male']['mean_score'])\nplt.legend(labels=['Female', 'Male'])","b1f23e2f":"data.groupby('gender')['mean_score'].mean()","37cae50b":"# Better scores for females","e67511fc":"data.head()","2b6c1543":"# Grades\n\n# Above 80 = A Grade\n# 70 to 80 = B Grade\n# 60 to 70 = C Grade\n# 50 to 60 = D Grade\n# 40 to 50 = E Grade\n# Below 40 = F Grade (Fail) ","33376d42":"# Change scores mean to grade\nfor i, row in data.iterrows():\n    if row['mean_score'] >= 80 :\n        data.loc[i, 'mean_score'] = 'A'\n    if (row['mean_score'] >= 70) & (row['mean_score'] < 80):\n        data.loc[i, 'mean_score'] = 'B'\n    if (row['mean_score'] >= 60) & (row['mean_score'] < 70):\n        data.loc[i, 'mean_score'] = 'C'\n    if (row['mean_score'] >= 50) & (row['mean_score'] < 60):\n        data.loc[i, 'mean_score'] = 'D'\n    if (row['mean_score'] >= 40) & (row['mean_score'] < 50):\n        data.loc[i, 'mean_score'] = 'E'\n    if (row['mean_score'] < 40):\n        data.loc[i, 'mean_score'] = 'F'","6b84d8ff":"grades = data[['mean_score']]","c7135c9b":"grades['mean_score cat'] = grades['mean_score'].astype('category').cat.codes","6e82f38b":"# regroup some high shcool with high school\ndata['parental level of education'] = data['parental level of education'].str.replace('some high school', 'high school')","d306a79b":"data['gender'] = data.gender.astype('category').cat.codes\ndata['race\/ethnicity'] = data['race\/ethnicity'].astype('category').cat.codes\ndata['lunch'] = data.lunch.astype('category').cat.codes\ndata['test preparation course'] = data['test preparation course'].astype('category').cat.codes\ndata['mean_score'] = data['mean_score'].astype('category').cat.codes","8ccea029":"# parental education with map for level of education\ndata['parental level of education'] = data['parental level of education'].map({'some college': 0, 'high school': 1, \n                                                                               'associate\\'s degree': 2, 'bachelor\\'s degree': 3,\n                                                                              'master\\'s degree':4})","2dc95a48":"data.head()","f965d479":"from sklearn.cluster import KMeans\nfrom sklearn.metrics import silhouette_score","0c1e67c0":"data = data.drop(['math score', 'reading score', 'writing score'], axis=1)","34054e2b":"# Calculate sum of squared distances\nssd = []\nK = range(1,10)\nfor k in K:\n    km = KMeans(n_clusters=k)\n    km = km.fit(data)\n    ssd.append(km.inertia_)","f548c993":"# Plot sum of squared distances \/ elbow method\nplt.figure(figsize=(10,6))\nplt.plot(K, ssd, 'bx-')\nplt.xlabel('k')\nplt.ylabel('ssd')\nplt.title('Elbow Method For Optimal k')\nplt.show()","932b2453":"# The best number of clusters is 3","fad21c20":"# Create and fit model\nkmeans = KMeans(n_clusters=3)\nmodel = kmeans.fit(data)","68ff27e4":"pred = model.labels_\ndata['cluster'] = pred","0a3c4a33":"# Create PCA for data visualization \/ Dimensionality reduction to 2D graph\nfrom sklearn.decomposition import PCA\n\npca = PCA(n_components=2)\npca_model = pca.fit_transform(data)\ndata_transform = pd.DataFrame(data = pca_model, columns = ['PCA1', 'PCA2'])\ndata_transform['Cluster'] = pred","1b8cf7ec":"data_transform.head()","6d589441":"plt.figure(figsize=(10,10))\ng = sns.scatterplot(data=data_transform, x='PCA1', y='PCA2', palette=sns.color_palette()[:3], hue='Cluster')\ntitle = plt.title('Students Clusters with PCA')","0e5d7179":"groups = data.groupby('cluster').mean().reset_index()","406d2198":"df = pd.read_csv('\/kaggle\/input\/students-performance-in-exams\/StudentsPerformance.csv')\ndf = df[['parental level of education']]\ndf['parental level of education'] = df['parental level of education'].str.replace('some high school', 'high school')\ndf['parental level of education cat'] = df['parental level of education'].map({'some college': 0, 'high school': 1, \n                                                                               'associate\\'s degree': 2, 'bachelor\\'s degree': 3,\n                                                                              'master\\'s degree':4})","7cd4b280":"df.drop_duplicates()","2415476e":"grades.drop_duplicates()","5a0f2a5d":"plt.figure(figsize=(20,10))\n\nplt.plot(groups.iloc[0,1:])\nplt.plot(groups.iloc[1,1:])\nplt.plot(groups.iloc[2,1:])\n\nl = plt.legend(groups.cluster)\nt = plt.xticks(rotation=45)","2766087f":"groups","dffdd66b":"### Parental level of education","0cbdd84c":"# Conclusions","a3b8dbea":"Cluster 0 : More females, Ethnicity Group B to D, parental level of school : college to high school, more standard lunch, some completed test course and have good grades (B)\n\nCluster 1 : More males, Ethnicity Group A or B, parental level of school : high school or bachelor's degree, more free lunch, completed test course and have the worst grades (D)\n\nCluster 2 : More females, Ethnicity Group B to D, parental level of school : associate to master's degree, more standard lunch, some completed test course and have the best grades (B+)","d9fe1995":"### Test preparation course","85cd5687":"# Data Exploration","ba49e9aa":"### Lunch","d708caff":"### PCA Graph","15a4220c":"- The test course doesn't seem to be effective (Cluster 1 completed the test course but got the worst grades)\n- The parental level of education is not very influent on the grade (Cluster 0 and 2)\n- The gender seems to be important as the female have better grades than males\n- The race \/ ethnicity is influent on the grades (lunch indicates that this group is less rich than the 2 others)","ef98a08c":"# Creating model and make predictions","c4750536":"### Scores","91b04c8c":"### Race \/ Ethnicity","f31a2d5f":"# Clusters informations","45bd7148":"### Gender x Scores","db2c4757":"### Gender"}}