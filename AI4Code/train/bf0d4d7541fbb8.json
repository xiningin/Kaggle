{"cell_type":{"42b20a75":"code","cd532ec0":"code","2220735a":"code","53c2e2b9":"code","5f14ca2b":"code","44297e90":"code","0dfe48c6":"code","69505b09":"code","f5015dc4":"code","dac55bbc":"code","4caffbca":"code","e89431b0":"code","a66a3d1c":"code","262a04f1":"code","c77447af":"code","293142c9":"code","a4f38752":"code","c293f875":"code","6187e2a7":"code","484c147f":"code","f3301cfd":"code","c43b383c":"code","97e88af6":"code","385620a1":"code","1931d6a3":"code","f95e1172":"code","e1acaa3c":"code","fdb4ef78":"code","21b1e3bb":"code","05584310":"code","88a34cef":"code","dfd4cb67":"code","412d6389":"code","7a22f4c1":"code","d7a12104":"code","055caec4":"code","d2c70f18":"code","62a717b1":"code","6281b31e":"code","b386ac87":"code","c365f3be":"code","3ef21258":"code","d06741b6":"code","81df8574":"code","a5ff7ab8":"code","164e9850":"code","89742319":"code","f0826e53":"code","015af65b":"code","ddb69470":"code","a68b64a4":"code","95cbae80":"code","70301189":"code","1468d81b":"code","786006dd":"code","4cdb0b41":"code","84c38add":"code","79440cf0":"code","7e26e663":"code","5be5bebd":"code","68f23558":"code","58d2ed37":"code","d2f3e1c0":"code","76fc96e8":"markdown","4b8220b1":"markdown","a6001fd8":"markdown","96eb187e":"markdown","96a98b47":"markdown","b8c3416d":"markdown","98bcc838":"markdown","79aabcd4":"markdown","ce93e166":"markdown","386e395c":"markdown","bd40ccd6":"markdown","301a470c":"markdown","657cdd67":"markdown","587ff099":"markdown","59bc9cd8":"markdown","4400801b":"markdown","735677a1":"markdown","59dd37c6":"markdown","2cdf7bcb":"markdown","7791ef02":"markdown","7731dab4":"markdown","05539b8d":"markdown","a9acadb6":"markdown","bc12e6a2":"markdown","8c931787":"markdown","4fb657bb":"markdown","09e087b2":"markdown","671937fc":"markdown","ab4abdb1":"markdown","84e9a226":"markdown","3d991658":"markdown","0efbc169":"markdown","b2b9b0ca":"markdown","b06f1408":"markdown","23635553":"markdown","c866f8bc":"markdown","7a201d83":"markdown"},"source":{"42b20a75":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sb\nsb.set_style('darkgrid')\nsb.set_palette('dark')\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","cd532ec0":"data = pd.read_csv(\"\/kaggle\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv\")","2220735a":"data","53c2e2b9":"data.isnull().sum()","5f14ca2b":"data.dtypes","44297e90":"data.drop('time',1,inplace=True)","0dfe48c6":"data.describe()","69505b09":"sb.pairplot(data,hue='DEATH_EVENT',aspect=0.8)","f5015dc4":"plt.figure(figsize=(25,8))\nsb.heatmap(data.corr(),annot=True)","dac55bbc":"fig,ax = plt.subplots(1,2,figsize=(20,9))\nax[0].hist(data['age'],color = 'darkorange',label = 'patients',edgecolor='black')\nax[0].set_xlabel('Age')\nax[0].set_ylabel('Number of Patients')\nax[0].set_yticks([5,10,15,20,25,30,35,40,45,50,55,60])\nax[0].legend()\nax[0].set_title('Age Distribution')\nax[1].hist(x = [data[data['DEATH_EVENT']==1]['age'],data[data['DEATH_EVENT']==0]['age']],color = ['blue','darkorange'],stacked=True,edgecolor='black',label=['Dead','Survived'])\nax[1].set_xlabel('Age')\nax[1].set_ylabel('Number of patients')\nax[1].set_yticks([5,10,15,20,25,30,35,40,45,50,55,60])\nax[1].set_title('Dead and Survived patients by age')\nax[1].legend()","4caffbca":"plt.figure(figsize = (20,8))\nsb.regplot(data['DEATH_EVENT'],data['age'],color='darkorange')","e89431b0":"fig,ax = plt.subplots(1,2,figsize=(20,9))\nax[0].hist(data['anaemia'],color='white',label = 'patients',edgecolor='black')\nax[0].set_xticks([0,1])\nax[0].set_yticks([10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170])\nax[0].set_xticklabels(['Absent','Present'])\nax[0].set_xlabel('Anaemia')\nax[0].set_ylabel('Number of Patients')\nax[0].legend()\nax[0].set_title('anaemia presence in patients')\nax[1].hist(x = [data[data['DEATH_EVENT']==1]['anaemia'],data[data['DEATH_EVENT']==0]['anaemia']],stacked=True,color = ['blue','white'],edgecolor='black',label=['Dead','Survived'])\nax[1].set_xticks([0,1])\nax[1].set_xticklabels(['Absent','Present'])\nax[1].set_yticks([10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170])\nax[1].set_xlabel('Anaemia')\nax[1].set_ylabel('Number of patients')\nax[1].set_title('dead and alive patients by presence of anaemia')\nax[1].legend()\nplt.tight_layout()","a66a3d1c":"plt.figure(figsize = (20,6))\nsb.regplot(data['DEATH_EVENT'],data['anaemia'],color='red')\nplt.title('DEATH due to anaemia')","262a04f1":"fig,ax = plt.subplots(1,2,figsize=(20,9))\nax[0].hist(data['creatinine_phosphokinase'],color='red',label = 'patients',edgecolor='black')\nax[0].set_yticks([10,30,50,70,90,110,130,150,170,190,210,230,250])\nax[0].set_xticks([500,1000,1500,2000,2500,3000,3500,4000,4500,5000,5500,6000,6500,7000,7500,8000,8500])\nax[0].set_xlabel('creatinine phosphokinase')\nax[0].set_ylabel('Number of Patients')\nax[0].legend()\nax[0].set_title('creatinine phosphokinase levels')\nax[1].hist(x = [data[data['DEATH_EVENT']==1]['creatinine_phosphokinase'],data[data['DEATH_EVENT']==0]['creatinine_phosphokinase']],stacked=True,color = ['pink','red'],edgecolor='black',label=['Dead','Survived'])\nax[1].set_yticks([10,30,50,70,90,110,130,150,170,190,210,230,250])\nax[1].set_xticks([500,1000,1500,2000,2500,3000,3500,4000,4500,5000,5500,6000,6500,7000,7500,8000,8500])\nax[1].set_xlabel('creatinine phosphokinase')\nax[1].set_ylabel('Number of patients')\nax[1].set_title('creatinine phosphokinase levels and death event')\nax[1].legend()","c77447af":"plt.figure(figsize=(15,6))\nsb.regplot(data['creatinine_phosphokinase'],data['DEATH_EVENT'],color='magenta')\nplt.title('creatinine_phosphokinase levels and chance of death')","293142c9":"plt.figure(figsize=(15,6))\nsb.regplot(data['creatinine_phosphokinase'],data['age'],color='magenta')\nplt.title('creatinine_phosphokinase levels and age')","a4f38752":"plt.figure(figsize=(15,6))\nsb.regplot(data['creatinine_phosphokinase'],data['anaemia'],color='magenta')\nplt.title('creatinine_phosphokinase levels and anaemia')","c293f875":"fig,ax = plt.subplots(1,2,figsize=(20,9))\nax[0].hist(data['diabetes'],color = 'grey',label = 'patients',edgecolor='black')\nax[0].set_xlabel('Diabetes')\nax[0].set_ylabel('Number of Patients')\nax[0].set_yticks([20,40,60,80,100,120,140,160,180,200])\nax[0].set_xticks([0,1])\nax[0].set_xticklabels(['Absent','Present'])\nax[0].legend()\nax[0].set_title('Diabetic Patients')\nax[1].hist(x = [data[data['DEATH_EVENT']==1]['diabetes'],data[data['DEATH_EVENT']==0]['diabetes']],color = ['green','grey'],stacked=True,edgecolor='black',label=['Dead','Survived'])\nax[1].set_xlabel('Diabetes')\nax[1].set_ylabel('Number of patients')\nax[1].set_yticks([20,40,60,60,80,100,120,140,160,180,200])\nax[1].set_xticks([0,1])\nax[1].set_xticklabels(['Absent','Present'])\nax[1].set_title('Dead and Survived patients by diabetic patients')\nax[1].legend()","6187e2a7":"plt.figure(figsize = (15,7))\nsb.regplot(data['DEATH_EVENT'],data['diabetes'],color='green')","484c147f":"fig,ax = plt.subplots(1,2,figsize=(20,9))\nax[0].hist(data['ejection_fraction'],color = 'tomato',label = 'patients',edgecolor='black')\nax[0].set_xlabel('Ejection Fraction')\nax[0].set_ylabel('Number of patients')\nax[0].set_yticks([20,40,60,80,100,120,125])\nax[0].legend()\nax[0].set_title('Ejection Fraction')\nax[1].hist(x = [data[data['DEATH_EVENT']==1]['ejection_fraction'],data[data['DEATH_EVENT']==0]['ejection_fraction']],color = ['pink','tomato'],stacked=True,edgecolor='black',label=['Dead','Survived'])\nax[1].set_xlabel('Ejection Fraction')\nax[1].set_ylabel('Number of patients')\nax[1].set_yticks([20,40,60,80,100,120,125])\nax[1].set_title('Dead and Survived patients by Ejection Fraction')\nax[1].legend()","f3301cfd":"plt.figure(figsize = (20,7))\nsb.regplot(data['DEATH_EVENT'],data['ejection_fraction'],color='tomato')\nplt.title('Ejection Fraction vs Death event')","c43b383c":"fig,ax = plt.subplots(1,2,figsize=(20,9))\nax[0].hist(data['high_blood_pressure'],color = 'yellow',label = 'patients',edgecolor='black')\nax[0].set_xlabel('High BP')\nax[0].set_ylabel('Number of Patients')\nax[0].set_yticks([20,40,60,80,100,120,140,160,180,200])\nax[0].set_xticks([0,1])\nax[0].set_xticklabels(['Absent','Present'])\nax[0].legend()\nax[0].set_title('High BP Patients')\nax[1].hist(x = [data[data['DEATH_EVENT']==1]['high_blood_pressure'],data[data['DEATH_EVENT']==0]['high_blood_pressure']],color = ['green','yellow'],stacked=True,edgecolor='black',label=['Dead','Survived'])\nax[1].set_xlabel('High BP')\nax[1].set_ylabel('Number of patients')\nax[1].set_yticks([20,40,60,60,80,100,120,140,160,180,200])\nax[1].set_xticks([0,1])\nax[1].set_xticklabels(['Absent','Present'])\nax[1].set_title('Dead and Survived patients By High BP')\nax[1].legend()\n","97e88af6":"plt.figure(figsize = (20,7))\nsb.regplot(data['high_blood_pressure'],data['DEATH_EVENT'],color='yellow')","385620a1":"fig,ax = plt.subplots(1,2,figsize=(25,9))\nax[0].hist(data['platelets'],color = 'red',edgecolor='black')\nax[0].set_xlabel('Platelet Count')\nax[0].set_ylabel('Number of patients')\nax[0].set_xticks([100000,200000,300000,400000,500000,600000,700000,800000])\nax[0].set_yticks([20,40,60,80,100,120,140])\nax[0].legend()\nax[0].set_title('Platelet Count')\nax[1].hist(x = [data[data['DEATH_EVENT']==1]['platelets'],data[data['DEATH_EVENT']==0]['platelets']],color = ['white','red'],stacked=True,edgecolor='black',label=['Dead','Survived'])\nax[1].set_xlabel('Platelet Count')\nax[1].set_ylabel('Number of patients')\nax[1].set_yticks([20,40,60,80,100,120,140])\nax[1].set_xticks([100000,200000,300000,400000,500000,600000,700000,800000])\nax[1].set_title('Dead and Survived patients and platelet count')\nax[1].legend()","1931d6a3":"plt.figure(figsize = (20,7))\nsb.regplot(data['platelets'],data['DEATH_EVENT'],color='red')","f95e1172":"plt.figure(figsize = (20,7))\nsb.regplot(data['platelets'],data['age'],color='red')","e1acaa3c":"fig,ax = plt.subplots(1,2,figsize=(25,9))\nax[0].hist(data['serum_creatinine'],color = 'darkgreen',edgecolor='black')\nax[0].set_xlabel('serum creatinine level')\nax[0].set_ylabel('Number of patients')\nax[0].set_yticks([5,10,20,30,40,50,60,70,80,90,100,120,140,160,180,200,220])\nax[0].set_xticks([1,2,3,4,5,6,7,8,9])\nax[0].legend()\nax[0].set_title('Serum Creatinine level')\nax[1].hist(x = [data[data['DEATH_EVENT']==1]['serum_creatinine'],data[data['DEATH_EVENT']==0]['serum_creatinine']],color = ['white','darkgreen'],stacked=True,edgecolor='black',label=['Dead','Survived'])\nax[1].set_xlabel('Serum Creatinine level')\nax[1].set_ylabel('Number of patients')\nax[1].set_yticks([5,10,20,30,40,50,60,70,80,90,100,120,140,160,180,200,220])\nax[1].set_xticks([1,2,3,4,5,6,7,8,9])\nax[1].set_title('Dead and Survived patients and Serum Creatinine level')\nax[1].legend()","fdb4ef78":"plt.figure(figsize = (20,7))\nsb.regplot(data['serum_creatinine'],data['DEATH_EVENT'],color='red')","21b1e3bb":"fig,ax = plt.subplots(1,2,figsize=(25,9))\nax[0].hist(data['serum_sodium'],color = 'pink',edgecolor='black')\nax[0].set_xlabel('sodium level')\nax[0].set_ylabel('Number of patients')\nax[0].set_yticks([5,10,20,30,40,50,60,70,80,90,100,120,140,160,180,200,220])\n\nax[0].legend()\nax[0].set_title('Sodium level')\nax[1].hist(x = [data[data['DEATH_EVENT']==1]['serum_sodium'],data[data['DEATH_EVENT']==0]['serum_sodium']],color = ['magenta','pink'],stacked=True,edgecolor='black',label=['Dead','Survived'])\nax[1].set_xlabel('Sodium level')\nax[1].set_ylabel('Number of patients')\nax[1].set_yticks([5,10,20,30,40,50,60,70,80,90,100,120,140,160,180,200,220])\n\nax[1].set_title('Dead and Survived patients and Sodim level')\nax[1].legend()\n","05584310":"plt.figure(figsize = (20,7))\nsb.regplot(data['serum_sodium'],data['DEATH_EVENT'],color='red')\nplt.title(\"Sodium Level vs Death event\")","88a34cef":"plt.figure(figsize = (20,7))\nsb.regplot(data['serum_sodium'],data['ejection_fraction'],color='red')\nplt.title(\"Sodium Level vs ejection Fraction\")","dfd4cb67":"plt.figure(figsize = (20,7))\nsb.regplot(data['serum_sodium'],data['serum_creatinine'],color='red')\nplt.title(\"Sodium vs creatinine\")","412d6389":"fig,ax = plt.subplots(1,2,figsize=(20,9))\nax[0].hist(data['sex'],color = 'blue',label = 'patients',edgecolor='black')\nax[0].set_xlabel('Gender')\nax[0].set_ylabel('Number of Patients')\nax[0].set_yticks([20,40,60,80,100,120,140,160,180,200,220])\nax[0].set_xticks([0,1])\nax[0].set_xticklabels(['Female','Male'])\nax[0].legend()\nax[0].set_title('Gender Distribution')\nax[1].hist(x = [data[data['DEATH_EVENT']==1]['sex'],data[data['DEATH_EVENT']==0]['sex']],color = ['blue','black'],stacked=True,edgecolor='white',label=['Dead','Survived'])\nax[1].set_xlabel('Gender')\nax[1].set_ylabel('Number of patients')\nax[1].set_yticks([20,40,60,60,80,100,120,140,160,180,200,220])\nax[1].set_xticks([0,1])\nax[1].set_xticklabels(['Female','Male'])\nax[1].set_title('Dead and Survived patients By Gender')\nax[1].legend()\n","7a22f4c1":"plt.figure(figsize = (20,7))\nsb.regplot(data['sex'],data['DEATH_EVENT'],color='red')\nplt.title(\"Gender vs Death event\")","d7a12104":"fig,ax = plt.subplots(1,2,figsize=(20,9))\nax[0].hist(data['smoking'],color = 'limegreen',label = 'patients',edgecolor='green')\nax[0].set_xlabel('Smoking')\nax[0].set_ylabel('Number of Patients')\nax[0].set_yticks([20,40,60,80,100,120,140,160,180,200,220])\nax[0].set_xticks([0,1])\nax[0].set_xticklabels(['No','Yes'])\nax[0].legend()\nax[0].set_title('Smoking Distribution')\nax[1].hist(x = [data[data['DEATH_EVENT']==1]['smoking'],data[data['DEATH_EVENT']==0]['smoking']],color = ['red','green'],stacked=True,edgecolor='black',label=['Dead','Survived'])\nax[1].set_xlabel('Smoking')\nax[1].set_ylabel('Number of patients')\nax[1].set_yticks([20,40,60,60,80,100,120,140,160,180,200,220])\nax[1].set_xticks([0,1])\nax[1].set_xticklabels(['No','Yes'])\nax[1].set_title('Dead and Survived patients By whether they smoke')\nax[1].legend()\n","055caec4":"plt.figure(figsize = (20,7))\nsb.regplot(data['smoking'],data['DEATH_EVENT'],color='red')\nplt.title(\"Smoking vs Death event\")","d2c70f18":"from sklearn.model_selection import train_test_split,GridSearchCV,cross_val_score,cross_val_predict\nfrom sklearn.linear_model import LogisticRegression,SGDClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier,BaggingClassifier,AdaBoostClassifier\nfrom sklearn.metrics import confusion_matrix,precision_score,recall_score,f1_score,accuracy_score","62a717b1":"y = data['DEATH_EVENT']\ndata.drop('DEATH_EVENT',1,inplace=True)\nX = data\n\n","6281b31e":"X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.25)","b386ac87":"clf1 = LogisticRegression(C=.1)\nclf1.fit(X_train,y_train)","c365f3be":"y_train_pred = cross_val_predict(clf1,X_train,y_train,cv=4)\nprint(\"Confusion Matrix: \\n\",confusion_matrix(y_train,y_train_pred))\nprint('Precision Score:',precision_score(y_train,y_train_pred))\nprint(\"Recall Score:\",recall_score(y_train,y_train_pred))\nprint(\"Accuracy Score:\",accuracy_score(y_train,y_train_pred))\nprint(\"Cross Val Score Insample\",cross_val_score(clf1,X_train,y_train,cv=4,scoring='accuracy').mean())\nprint(\"Cross Val Score Outsample\",cross_val_score(clf1,X_test,y_test,cv=4,scoring='accuracy').mean())","3ef21258":"clf2 = SGDClassifier()\nclf2.fit(X_train,y_train)","d06741b6":"y_train_pred = cross_val_predict(clf2,X_train,y_train,cv=4)\nprint(\"Confusion Matrix: \\n\",confusion_matrix(y_train,y_train_pred))\nprint('Precision Score:',precision_score(y_train,y_train_pred))\nprint(\"Recall Score:\",recall_score(y_train,y_train_pred))\nprint(\"Accuracy Score:\",accuracy_score(y_train,y_train_pred))\nprint(\"Cross Val Score Insample\",cross_val_score(clf2,X_train,y_train,cv=4,scoring='accuracy').mean())\nprint(\"Cross Val Score Outsample\",cross_val_score(clf2,X_test,y_test,cv=4,scoring='accuracy').mean())","81df8574":"param_grid = {'n_neighbors':np.arange(1,6)}\ngrid_knn = GridSearchCV(KNeighborsClassifier(),param_grid,cv=5)\ngrid_knn.fit(X,y)","a5ff7ab8":"grid_knn.best_params_","164e9850":"clf3 = grid_knn.best_estimator_\nclf3.fit(X_train,y_train)","89742319":"y_train_pred = cross_val_predict(clf3,X_train,y_train,cv=4)\nprint(\"Confusion Matrix: \\n\",confusion_matrix(y_train,y_train_pred))\nprint('Precision Score:',precision_score(y_train,y_train_pred))\nprint(\"Recall Score:\",recall_score(y_train,y_train_pred))\nprint(\"Accuracy Score:\",accuracy_score(y_train,y_train_pred))\nprint(\"Cross Val Score Insample\",cross_val_score(clf3,X_train,y_train,cv=4,scoring='accuracy').mean())\nprint(\"Cross Val Score Outsample\",cross_val_score(clf3,X_test,y_test,cv=4,scoring='accuracy').mean())","f0826e53":"param_grid = {'max_depth':np.arange(1,5),'min_samples_leaf':np.arange(1,4)}\ngrid_tree = GridSearchCV(DecisionTreeClassifier(),param_grid,cv=5)\ngrid_tree.fit(X,y)","015af65b":"grid_tree.best_params_","ddb69470":"clf4 = grid_tree.best_estimator_\nclf4.fit(X_train,y_train)","a68b64a4":"y_train_pred = cross_val_predict(clf4,X_train,y_train,cv=4)\nprint(\"Confusion Matrix: \\n\",confusion_matrix(y_train,y_train_pred))\nprint('Precision Score:',precision_score(y_train,y_train_pred))\nprint(\"Recall Score:\",recall_score(y_train,y_train_pred))\nprint(\"Accuracy Score:\",accuracy_score(y_train,y_train_pred))\nprint(\"Cross Val Score Insample\",cross_val_score(clf4,X_train,y_train,cv=4,scoring='accuracy').mean())\nprint(\"Cross Val Score Outsample\",cross_val_score(clf4,X_test,y_test,cv=4,scoring='accuracy').mean())","95cbae80":"clf5 = RandomForestClassifier(bootstrap=True, ccp_alpha=0.0, class_weight=None,\n                       criterion='gini', max_depth=3, max_features='auto',\n                       max_leaf_nodes=2, max_samples=None,\n                       min_impurity_decrease=0.0, min_impurity_split=None,\n                       min_samples_leaf=2, min_samples_split=15,\n                       min_weight_fraction_leaf=0.0, n_estimators=10,\n                       n_jobs=-1, random_state=1, verbose=0,\n                       warm_start=False)\nclf5.fit(X_train,y_train)","70301189":"y_train_pred = cross_val_predict(clf5,X_train,y_train,cv=3)\nprint(\"Confusion Matrix: \\n\",confusion_matrix(y_train,y_train_pred))\nprint('Precision Score:',precision_score(y_train,y_train_pred))\nprint(\"Recall Score:\",recall_score(y_train,y_train_pred))\nprint(\"Accuracy Score:\",accuracy_score(y_train,y_train_pred))\nprint(\"Cross Val Score Insample\",cross_val_score(clf5,X_train,y_train,cv=4,scoring='accuracy').mean())\nprint(\"Cross Val Score Outsample\",cross_val_score(clf5,X_test,y_test,cv=4,scoring='accuracy').mean())","1468d81b":"clf6 = AdaBoostClassifier(DecisionTreeClassifier(max_depth = 3,min_samples_leaf=3),n_estimators = 1500)\nclf6.fit(X_train,y_train)","786006dd":"y_train_pred = cross_val_predict(clf6,X_train,y_train,cv=3)\nprint(\"Confusion Matrix: \\n\",confusion_matrix(y_train,y_train_pred))\nprint('Precision Score:',precision_score(y_train,y_train_pred))\nprint(\"Recall Score:\",recall_score(y_train,y_train_pred))\nprint(\"Accuracy Score:\",accuracy_score(y_train,y_train_pred))\nprint(\"Cross Val Score Insample\",cross_val_score(clf6,X_train,y_train,cv=4,scoring='accuracy').mean())\nprint(\"Cross Val Score Outsample\",cross_val_score(clf6,X_test,y_test,cv=4,scoring='accuracy').mean())","4cdb0b41":"classifier = DecisionTreeClassifier(max_depth=3,min_samples_leaf=3)\nclassifier.fit(X,y)","84c38add":"#Patient = [[age,anaemia ,creatinine_phosphokinase ,diabetes ,ejection_fraction ,high_blood_pressure ,platelets ,serum_creatinine ,serum_sodium ,sex,smoking]]\npatient  = [[ 76,1,653,0,40,1,26500,1.6,128,1,0]]\ndeath_chance = classifier.predict(patient)\nif death_chance == 1:\n    print(\"There are chances of death due to heart-failure\")\nelse:\n    print(\"Less Chance of Death due to heart-failure\")","79440cf0":"from tensorflow import keras\nfrom keras.models import Model\nfrom keras.layers import Dense,Dropout,Input\nfrom keras.utils import to_categorical,plot_model\nfrom sklearn.preprocessing import StandardScaler","7e26e663":"sc = StandardScaler()\nnum_labels = len(np.unique(y_train))\nX_train = sc.fit_transform(X_train)\nX_test = sc.fit_transform(X_test)\ny_train = to_categorical(y_train)\ny_test = to_categorical(y_test)","5be5bebd":"input_shape = X_train.shape[1]\ninputs = Input(shape = input_shape)\nx = inputs\nx = Dense(64,activation = 'relu')(x)\nx = Dropout(0.6)(x)\nx = Dense(128,activation = 'relu')(x)\nx = Dropout(0.6)(x)\nx = Dense(256,activation = 'relu')(x)\nx = Dropout(0.6)(x)\nx = Dense(512,activation = 'relu')(x)\nx = Dropout(0.6)(x)\nx = Dense(512,activation = 'relu')(x)\nx = Dropout(0.6)(x)\nx = Dense(10,activation = 'relu')(x)\nx = Dense(8,activation = 'relu')(x)\n\noutputs = Dense(2,activation = 'softmax')(x)\nmodel = Model(inputs,outputs)\nmodel.summary()\nplot_model(model)","68f23558":"model.compile(optimizer = 'rmsprop',loss = 'binary_crossentropy',metrics = ['accuracy'])","58d2ed37":"model.fit(X_train,y_train,epochs = 100,batch_size = 10)","d2f3e1c0":"loss,acc = model.evaluate(X_test,y_test,batch_size = 10)","76fc96e8":"# Data-PreProcessing","4b8220b1":"**Does level of creatinine_phosphokinase cause death due to heart failure?**\n\n\n*creatinine_phosphokinase is a enzyme responsible for muscular function*","a6001fd8":"ADABOOST Classifier","96eb187e":"**Ejection fraction (EF) is a measurement, expressed as a percentage, of how much blood the left ventricle pumps out with each contraction**","96a98b47":"**Does having anaemia cause death due to heart failure?**\n\n\n\n*Anemia is a condition in which you lack enough healthy red blood cells to carry adequate oxygen to your body's tissues.* ","b8c3416d":"# Data analysis and visualization","98bcc838":"* Approx 30% of patients not having high blood pressure died due to heart-failure\n* Approx 38% of patients having high blood pressure died due to heart-failure\n\n**With High Blood Pressure the chance of death due to heart-failure increases**","79aabcd4":"# **Exploring how good is MultiLayer Perceptrons compared to a Machine Learning Model**","ce93e166":"**Does sodium level cause death due to heart-failure?**","386e395c":"**How does platelet count affect death due to heart failure**","bd40ccd6":"**Does death due to heart-failure occur at some age-interval?**","301a470c":"Out of 299 patients\n* 173 do not have diabetes\n* 126 have diabetes\n\n* 32% patients who did not have diabetes died due to heart-failure\n* 32% patients who had diabetes died due to heart-failure\n\n**Thus presence or absence of diabetes doesnt result to death due to heart-failure. the patient having and the patient not having diabetes have equal chances of death due to diabetes. Thus no corelation exists which is also proved from the regression plot**","657cdd67":"* 73% patients have creatinine levels at Level 1\n* 16% patients have creatinine levels at Level 2\n* 4% patients have creatinine levels at Level 3\n* 2.5% patients have creatinine levels at Level 4\n* 1.5% patients have creatinine levels at Level 5\n* 0.5% patients have creatinine levels at Level 6\n* 1% patients have creatinine levels at Level 7\n* 0% patients have creatinine levels at Level 8\n* 1.5% patients have creatinine levels at Level 9\n\n\n\n* 18% at Level 1 died due to heart failure\n* 54% at Level 2 died due to heart falure\n* 83% at Level 3 died due to heart failure\n* 66% at Level 4 died due to heart failure\n* 100% at Level 5 died due to heart failure\n* 50% at Level 6 died due to heart failure\n* 100%  at Level 7 died due to heart failure\n* 100%  at Level 9 died due to hear failure\n\n\n\n**As serum creatinine level increases chances of death due to heart-failure increases**","587ff099":"* 56% patients in given dataset do not possess anaemia\n* 43% patients in the given dataset possess anaemia\n\n* 29.4% of patients not suffering from anaemia die due to heart failure\n* 36% of patients suffering from anaemia die due to heart failure\n\n**Thus patients having anaemia have a higher chance of death than patients not suffering from anaemia.** \n","59bc9cd8":"**Does having diabeties cause death due to heart failure?**","4400801b":"KNeighbors Classifier","735677a1":"SGD Classifier","59dd37c6":"**LogisticReggression**","2cdf7bcb":"# Looking for Null Values","7791ef02":"# **Model Selection**","7731dab4":"**Smoking doesnt Really affect death chance due to heart-failure but it does cause cancer and you can die of it.**","05539b8d":"**Does Smoking have an effect?**","a9acadb6":"**As sodium concentration increases chance of death due to heart-failure decreases. Also with increase in sodium concentration ejection fraction increases and as ejection fraction increases and creatine concentration decreases thus inturn death due to hearfailure also decreases**  ","bc12e6a2":"There is atleast 10% chance at the age of 40 to have a heart failure and it increases with age but in a small proportion.In the given sample of data we have:\n* less than 40 people of age 40\n* less than 40 people of age 50\n* less than 40 people of age between 50 and 59\n* less than 60 people of age 60\n* 45 people of age between 61 and 69\n* 40 people of age 70\n* 19 people of age between 71 and 79\n* 12 people of age 80\n* less than 10 of age between 81 and 89\n* more tahn 5 of age 90 and above\n\nGiven that they have suffered from heart-failure\n* 25% chance of death due to heart failure between age 40 and 50\n* 15% chance of death due to heart failure between age 51 and 60\n* 33% chance of death due to heart failure between age 61 and 70\n* 42% chance of death due to heart failure between age 71 and 80\n* 65% chance of death due to heart failure between age 81 and 90\n* 83% chance of death due to heart failure after age 90\n\n**Thus with increase in age chances of death due to heart-failure also increases**\n\n\n","8c931787":"**As ejection fraction increases death rate decreases**","4fb657bb":"* anamea:1=present,0=absent\n* diabetes: 1=present,0=absent\n* high_blood_pressure: 1=present,0=absent\n* sex: 1=male,0=female\n* smoking: 1=yes,0=no\n","09e087b2":"**Platelet count decreases as age increases**","671937fc":"RandomForestClassifier","ab4abdb1":"No Null Values","84e9a226":"**Does having high blood pressure cause death due to heart-failure?**","3d991658":"**Almost 84% people have creatinine phosphokinase levels in range of 500 units.from the regression plot it is clear that with increase in creatinine phosphokinase levels chance of death increases.\nAnother interesting observation in that creatinine phosphokinase levels decrease with increase of age. Thus at higher ages creatinine phosphokinase levels are less and are more in youger ages**","0efbc169":"**Does Gender have a role to play in death due to heart-failure?**","b2b9b0ca":"**Both Genders are equally likely to die due to heart-failure and it is proved from a straight line in regression plot**","b06f1408":"**DecisionTreeClassifier**","23635553":"# **Model Development**","c866f8bc":"**Does serum creatinine levels have a role in death due to heart-failure?**\n\n*Creatinine is a waste product that comes from the normal wear and tear on muscles of the body.*","7a201d83":"* The Platelet count in blood varies from 100,000 to 500,000\n* As platelet count increases the chance of death due to heart-failure decreases"}}