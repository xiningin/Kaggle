{"cell_type":{"297f8d39":"code","89e9bbb7":"code","d7908457":"code","3ac88f50":"code","f9c8e7a4":"code","eec292c9":"code","54728f1f":"code","1b4c810d":"code","accf3fa1":"code","2cf1bed6":"code","87e17368":"code","02146634":"markdown","03dcc9a5":"markdown","ff23bb40":"markdown","5778d509":"markdown","82b0f0c9":"markdown","c5bb8fa7":"markdown","79e51ede":"markdown","91306066":"markdown","53113eab":"markdown","34a28331":"markdown","1c02a89b":"markdown","b5635be9":"markdown"},"source":{"297f8d39":"# Setup our environment\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport numpy as np\nimport warnings\nwarnings.filterwarnings('ignore')\nshoe = pd.read_csv(r'..\/input\/shopify-shoe-shop\/shoe_shop.csv')\n\n# Make the calculation\nprint(\"The actual value of AOV is\", shoe[\"order_amount\"].sum() \/ shoe[\"total_items\"].sum())","89e9bbb7":"print(\"Given AOV is\", shoe[\"order_amount\"].mean())","d7908457":"shoe[\"order_amount\"].describe()\nshoe[\"total_items\"].describe()\n\nplt.title(\"Order Amount\")\nplt.boxplot(shoe[\"order_amount\"])\nplt.show()\nplt.title(\"Total Items For Each Order\")\nplt.boxplot(shoe[\"total_items\"])\nplt.show()","3ac88f50":"# A function to plot histograms on log scale\ndef plot_log_hist(x, bins):\n    hist, bins = np.histogram(x, bins=bins)\n    logbins = np.logspace(np.log10(bins[0]),np.log10(bins[-1]),len(bins))\n    plt.hist(x, bins=logbins)\n    plt.xscale('log')\n    plt.show()\n \nplt.title(\"Order Amount (Log)\")\nplot_log_hist(shoe[\"order_amount\"], 50)\nplt.title(\"Total Items (Log)\")\nplot_log_hist(shoe[\"total_items\"], 50)","f9c8e7a4":"shoe['order_amount'].value_counts().sort_index(ascending = False).head(12)\nshoe['total_items'].value_counts().sort_index(ascending = False)","eec292c9":"shoe.sort_values(by='order_amount', ascending=False).head(21)","54728f1f":"q1 = shoe[\"total_items\"].quantile(q=0.25)\nq2 = shoe[\"total_items\"].quantile(q=0.5)\nq3 = shoe[\"total_items\"].quantile(q=0.75)\nIQR = q3 - q1\n\nshoe_cleaned = shoe[(shoe[\"total_items\"] < (q2 + IQR * 1.5)) & (shoe[\"total_items\"] > (q2 - IQR * 1.5))]\n\nplt.title(\"Total Items For Each Order After Removing Outliers\")\nplt.boxplot(shoe_cleaned [\"total_items\"])\nplt.show()","1b4c810d":"print(\"The modified AOV is\", shoe_cleaned[\"order_amount\"].sum() \/ shoe_cleaned[\"total_items\"].sum())","accf3fa1":"SELECT COUNT(*), Orders.ShipperID, Shippers.ShipperName\nFROM Orders\nINNER JOIN Shippers\n    ON Orders.ShipperID = Shippers.ShipperID\nGROUP BY Orders.ShipperID\nORDER BY Orders.ShipperID;","2cf1bed6":"SELECT COUNT(*) AS TotalOrders, LastName\nFROM Orders\nINNER JOIN Employees\n    ON Orders.EmployeeID = Employees.EmployeeID\nGROUP BY Employees.EmployeeID\nORDER BY TotalOrders DESC\nLimit 1;","87e17368":"SELECT p.ProductName, SUM(Quantity) AS TotalOrders \nFROM Orders AS o\nINNER JOIN OrderDetails AS od \n    ON od.OrderID = o.OrderID\nINNER JOIN Products AS p\n    ON p.ProductID = od.ProductID\nINNER JOIN Customers AS c\n    ON c.CustomerID = o.CustomerID\nWHERE Country = \"Germany\" \nGROUP BY od.ProductId\nORDER BY TotalOrders DESC\nLIMIT 1;","02146634":"Let's now take a look at how we could evaluate this data better.","03dcc9a5":"As we could see, we have a lot of orders of large amounts of sneakers. They are most likely factory customers that want to resell these sneakers later. We also have orders of really expensive shoes, those we won't need to worry about for our analysis because they are still relevant to AOV.\n\nLet's quickly confirm our hypothesis.\n","ff23bb40":"#### b) What metric would you report for this dataset? \n\nFor this dataset, we only have information of orders of sneakers in 1 month. Hence, AOV is actually the most suited metric because we may able to compare the AOV for future months once we've collected more data.\n\nHence, the metric I chose is the modified AOV after removing outliers (or median order value of the original dataset).\n#### c) What is its value?\nThe modified AOV after removing outliers is 372.71.","5778d509":"Indeed! We have the same customer ordering 2000 shoes from the same shoe store repeatedly. This is likely a someone that wants to resell these shoes later. This messes up our data. \n\nTo minimize the influence of these outliers, we could either take the median order value instead of the average order value **or** remove\/change the value of outliers. In this case, we should remove the outliers instead of taking the median because the outliers form relationship in data that the AOV doesn't actually measure.\n\nMethods such as Z-score, windsorized estimators, robust statistics or bootstrapping are all useful for dealing with outliers. Here though, we'll just remove the outliers that lies outside of 1.5 times the interquatile range of our total_items ordered.\n","82b0f0c9":"Both order amount and total items has a really large standard deviation. Indeed, the max of order amount is more than 200 times the 75% percentile! Similarly, if we take a look at total items, someone ordered more than 2000  sneakers where most people only ordered less than 3 pairs. The data completely threw our boxplot off because the data is really skewed to customers that ordered expensive items and customers that ordered many shoes!\n\nLet's try to plot our data on log scale for a clearer visualization.","c5bb8fa7":"#### c) What product was ordered the most by customers in Germany?\n#### Answer: Boston Crab Meat","79e51ede":"## Question 2\nFor this question you\u2019ll need to use SQL. Follow this link to access the data set required for the challenge. Please use queries to answer the following questions. Paste your queries along with your final numerical answers below.\n\n#### a) How many orders were shipped by Speedy Express in total?\n#### Answer: 54\n\n","91306066":"Now it's much better! Let's take a count of the values to see what's up with the really large orders.","53113eab":"Here it goes!\ud83c\udf89 The calculation is wrong, our actual AOV is around $357.92. Our sneakers are a little expensive, but that's about the price for sneakers!\n\nPossibly, the given AOV $3145.13 is calculated by averaging the order amount of the 100 sneaker shops. So on average, our revenue is around \\\\$3145.13 per store. This could be an useful piece of information, but it is not how the AOV is calculated.","34a28331":"#### b) What is the last name of the employee with the most orders?\n#### Answer: Peacock\n","1c02a89b":"# Fall 2021 Data Science Intern Challenge \n## Question 1\n\nOn Shopify, we have exactly 100 sneaker shops, and each of these shops sells only one model of shoe. We want to do some analysis of the average order value (AOV). When we look at orders data over a 30 day window, we naively calculate an AOV of \\\\$3145.13. Given that we know these shops are selling sneakers, a relatively affordable item, something seems wrong with our analysis. \n\n### a) Think about what could be going wrong with our calculation. Think about a better way to evaluate this data.\n### TL;DR: AOV \\\\$3145.13 is calculated wrong. Correct value is \\$357.92. Better way to evaluate this data is either to use median order value or remove the outliers.\n\nThere are many things could go wrong while analysing data. The analyst may forgot to take the division, subseted the wrong column, or used the wrong formula. Or perhaps even the data was too skewed to get a meaningful result.\n\nFirst, let's make sure our calculation of average order value (AOV) is correct. AOV is the average amount of money spent on each order. To calculate AOV, we divide total revenue by the number of orders over a 30 day window.","b5635be9":"Here we go! Our boxplot is much better! We now have a dataframe that has fewer anamolies. Evaluating the data after removing anamolies is much more effective."}}