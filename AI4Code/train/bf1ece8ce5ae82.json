{"cell_type":{"b3b831ec":"code","bd123a7d":"code","608fc408":"code","0464efc5":"code","8b63443b":"code","f47bd988":"code","50ce31e0":"code","6b05feb2":"code","a51c4834":"code","282d0761":"code","afb1efa3":"markdown","f352d8eb":"markdown","3d91a944":"markdown","218a34e1":"markdown","2d01aa59":"markdown","b7d1e5ac":"markdown","8189dce6":"markdown"},"source":{"b3b831ec":"import numpy as np\nimport pandas as pd\nimport cv2\nimport tensorflow as tf\nfrom skimage.transform import resize","bd123a7d":"train=pd.read_csv('..\/input\/petfinder-pawpularity-score\/train.csv')\ntrain.head()","608fc408":"all_image=[]\ncount=0\nfor index in range(train.shape[0]):\n    id=train.loc[index,'Id']\n    path='..\/input\/petfinder-pawpularity-score\/train\/'+str(id)+'.jpg'\n    im_array=cv2.imread(path)\n    im_array=resize(im_array,(128,128),anti_aliasing=True)\n    all_image.append(im_array)\n    \n    count+=1\n    progress=(count\/len(train['Id']))*100\n    print('progress =',round(progress,2), '%',end='\\r')","0464efc5":"X=np.array(all_image)\nX=X.reshape(-1,128,128,3)\n\ndel all_image\nX.shape","8b63443b":"y=train['Pawpularity']\ny.shape","f47bd988":"model=tf.keras.Sequential()\nmodel.add(tf.keras.layers.Conv2D(64,(3,3),activation='relu',input_shape=(128,128,3),padding='same'))\nmodel.add(tf.keras.layers.MaxPool2D((2,2)))\nmodel.add(tf.keras.layers.Flatten())\nmodel.add(tf.keras.layers.Dense(512,activation='relu'))\nmodel.add(tf.keras.layers.Dropout(0.1))\nmodel.add(tf.keras.layers.Dense(256,activation='relu'))\nmodel.add(tf.keras.layers.Dense(128,activation='relu'))\nmodel.add(tf.keras.layers.Dense(1,activation='linear'))\nmodel.compile(loss='mean_squared_error',optimizer='adam')\nmodel.summary()","50ce31e0":"model.fit(X,y,epochs=50)","6b05feb2":"test=pd.read_csv('..\/input\/petfinder-pawpularity-score\/test.csv')\ntest.head()","a51c4834":"all_image=[]\nfor index in range(test.shape[0]):\n    id=test.loc[index,'Id']\n    path='..\/input\/petfinder-pawpularity-score\/test\/'+str(id)+'.jpg'\n    im_array=cv2.imread(path)\n    im_array=resize(im_array,(128,128),anti_aliasing=True)\n    all_image.append(im_array)\n\nX_test=np.array(all_image).reshape(-1,128,128,3)\ndel all_image\n\ny_predict=model.predict(X_test)\ny_predict=y_predict.reshape(-1,)\n\nsubmission_df=pd.DataFrame({'Id':test['Id'],'Pawpularity':y_predict})\nsubmission_df","282d0761":"submission_df.to_csv(\"submission.csv\", index=False)","afb1efa3":"# Prepare Data","f352d8eb":"from train datafram, we might use Id in for loop to extract image","3d91a944":"I decided to resize all image into 128 x 128 pixel","218a34e1":"# Neural Network","2d01aa59":"I adapt neural network structure from this [notebook](https:\/\/www.kaggle.com\/guidosalimbeni\/regression-with-convolutional-neural-network-keras#Build-and-train-the-CNN-model)","b7d1e5ac":"# Predict pet pawpularity","8189dce6":"## Extract and resize image"}}