{"cell_type":{"6eaf535c":"code","bcbf72d0":"code","8f27942d":"code","0895d6d4":"code","d8780a87":"code","baa7854b":"code","ce86e9d4":"code","ddf947cc":"code","1a216389":"code","babede00":"code","fbc18820":"code","00ae1186":"code","a52a8ceb":"code","aa24d178":"code","745faf9e":"code","48809d87":"code","2ea38167":"code","2ebf700c":"code","04e16d88":"code","d5a2593c":"code","8f0bcfd6":"code","40340d6e":"code","8ac2132a":"code","b703978e":"code","049cf931":"code","2d89efb8":"code","904f2aba":"code","8a474fc6":"code","b504c057":"code","f7a31164":"code","3f4fe364":"code","8761281a":"markdown","71158d07":"markdown","cd01bc8f":"markdown","86ba0467":"markdown","be04dfa3":"markdown","38237df4":"markdown"},"source":{"6eaf535c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns","bcbf72d0":"train = pd.read_csv('..\/input\/osic-pulmonary-fibrosis-progression\/train.csv')","8f27942d":"test = pd.read_csv('..\/input\/osic-pulmonary-fibrosis-progression\/test.csv')","0895d6d4":"train.head()","d8780a87":"train.info()","baa7854b":"print(train.isnull().sum())\nprint(test.isnull().sum())","ce86e9d4":"train.describe()","ddf947cc":"train.groupby('SmokingStatus').count()","1a216389":"train.groupby('Sex').count()","babede00":"train['Sex'] = train['Sex'].map({'Male':0,'Female':1})","fbc18820":"test['Sex'] = test['Sex'].map({'Male':0,'Female':1})","00ae1186":"train.head()","a52a8ceb":"train = pd.get_dummies(train,columns=['SmokingStatus'],drop_first=True)","aa24d178":"test = pd.get_dummies(test,columns=['SmokingStatus'],drop_first=True)","745faf9e":"train.head()","48809d87":"sns.pairplot(train)","2ea38167":"sns.heatmap(train.corr(),cmap = 'RdYlBu_r')","2ebf700c":"cat_cols =[col for col in train.columns if train[col].dtype==object]","04e16d88":"cat_cols","d5a2593c":"from sklearn.preprocessing import LabelEncoder\ncat_encs = []\nfor col in cat_cols:\n    le = LabelEncoder()\n    train[col] = le.fit_transform(train[col])\n    cat_encs.append([col,le])","8f0bcfd6":"cat_encs","40340d6e":"cat_test = []\nfor col in cat_cols:\n    le = LabelEncoder()\n    test[col] = le.fit_transform(test[col])\n    cat_test.append([col,le])","8ac2132a":"cat_test","b703978e":"X =train.drop('Patient',axis=1)\ny= train['Patient']","049cf931":"X.shape","2d89efb8":"y.shape","904f2aba":"from sklearn import tree\nmodel = tree.DecisionTreeClassifier()\nmodel.fit(X,y)\ny_predict=model.predict(X)\nfrom sklearn.metrics import accuracy_score\naccuracy_score(y,y_predict)\n","8a474fc6":"from sklearn import svm, tree, linear_model, neighbors, naive_bayes, ensemble, discriminant_analysis, gaussian_process\nclf_rf = ensemble.RandomForestClassifier(random_state=1)\nparameters = { \n    'n_estimators': [100, 400],\n    'criterion' : ['gini', 'entropy'],\n    'max_depth' : [2, 4, 6]    \n}\n\nfrom sklearn.model_selection import GridSearchCV, cross_val_score\n\ncv_rf = GridSearchCV(estimator = clf_rf, param_grid = parameters, cv=5, n_jobs=-1)","b504c057":"X_test = test\n\nclf = cv_rf.fit(X, y)\n\npredictions = clf.predict(X_test)","f7a31164":"X_test.shape","3f4fe364":"output = pd.DataFrame({'Patient': test.Patient, 'FVC': predictions})\noutput.to_csv('submission.csv', index=False)","8761281a":"**Data Cleaning**","71158d07":"*Loading Dataset*","cd01bc8f":"**Visualisation**","86ba0467":"        **Decision Tree Classifier**","be04dfa3":"Data has a correlation with Sex vs SmokingStatus  and Percentage vs FVC","38237df4":"Never smoked 429\nEx-smoker    1038 \n"}}