{"cell_type":{"b833b2a0":"code","357b5791":"code","079756a8":"code","242ff124":"code","28ae7c59":"code","be5ac245":"code","f8df5594":"code","522c606d":"code","240741c2":"code","77676f0d":"code","255ca7d9":"markdown","11a2ca3d":"markdown","d7b1562e":"markdown","59e9f8f2":"markdown"},"source":{"b833b2a0":"!pip install lightautoml","357b5791":"# Data handling \nimport pandas as pd \nimport numpy as np\n\n# AutoML\nfrom lightautoml.reader.base import PandasToPandasReader\nfrom lightautoml.tasks import Task\nfrom lightautoml.automl.presets.tabular_presets import TabularAutoML","079756a8":"# Import data\ndf_train = pd.read_csv(\"..\/input\/house-prices-advanced-regression-techniques\/train.csv\")\ndf_train.head()","242ff124":"task = Task(\"reg\", metric=\"rmsle\")\nroles = {\n    \"target\":\"SalePrice\", \n    \"drop\":\"Id\"\n}","28ae7c59":"autoML = TabularAutoML(task=task, \n                      general_params = {\"nested_cv\":False, \"use_algos\":[[\"linear_l1\", \"lgb\", \"lgb_tuned\"]]}, \n                      reader_params = {\"cv\":5, \"random_state\":1}, \n                      tuning_params = {\"max_tuning_iter\":20, \"max_tuning_time\":30}, \n                      lgb_params = {\"default_params\":{\"num_threads\":4}})","be5ac245":"oof_pred = autoML.fit_predict(df_train, roles=roles)","f8df5594":"# Import test data\ntest_df = pd.read_csv(\"..\/input\/house-prices-advanced-regression-techniques\/test.csv\")\ntest_df.head()","522c606d":"# Predictions\ntest_predictions = autoML.predict(test_df)","240741c2":"# Export results\noutput = pd.DataFrame({\"Id\":test_df[\"Id\"], \n                      \"SalePrice\":test_predictions.data[:,0]})\noutput","77676f0d":"output.to_csv(\"submission.csv\", index=False)","255ca7d9":"# Packages","11a2ca3d":"# Processing","d7b1562e":"# Submission","59e9f8f2":"# Model Development "}}