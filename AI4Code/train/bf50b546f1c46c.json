{"cell_type":{"325a6a2a":"code","e7332e91":"code","e9f0ee46":"code","17c8ee9d":"code","219cf78e":"code","485c71a4":"code","f2d7f934":"code","076b7a94":"code","3447fc0e":"code","ddb6d4ca":"code","c9a8fc0a":"code","dd0459ca":"code","d3dd7e07":"code","9fcb0bc6":"code","7f1d3e39":"code","5dda8c6f":"code","95555a9f":"code","0b6d95d7":"code","cb321aea":"code","fb733c82":"code","0ac71470":"code","293cb8f3":"code","4ae0d995":"code","ef57a5c7":"code","50c43e46":"code","27c45132":"code","1782479a":"code","4951a305":"code","fa0a440e":"code","371a2fc1":"code","030928af":"code","a3823272":"code","2f7f00c7":"code","66294df7":"code","924425c6":"code","dd60282e":"code","ca390481":"code","d0ec0afe":"code","b0a5ecd5":"markdown","69056e3a":"markdown","510f303c":"markdown","43033f54":"markdown","50fa0c45":"markdown","ecf23160":"markdown","c0ecd59b":"markdown","2c0dcc4f":"markdown","bb32ff0b":"markdown","572f4085":"markdown","bb64a452":"markdown","ba600c2a":"markdown","1d18b1f6":"markdown","288e616d":"markdown","2d530222":"markdown","42dce1ab":"markdown","68b3e955":"markdown","a62d7639":"markdown","d523cde8":"markdown","5bac8233":"markdown","a217c276":"markdown","7248b850":"markdown"},"source":{"325a6a2a":"import pandas as pd\nimport numpy as np\n%matplotlib inline\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.decomposition import PCA\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import classification_report\nfrom sklearn.model_selection import KFold, cross_val_score","e7332e91":"tracks = pd.read_csv('..\/input\/songsdata\/fma-rock-vs-hiphop.csv')\nmusic_features = pd.read_json('..\/input\/songsdata\/echonest-metrics.json',precise_float=True)","e9f0ee46":"tracks.head()","17c8ee9d":"music_features.head()","219cf78e":"audio_data=music_features.merge(tracks[['genre_top', 'track_id']], on='track_id')","485c71a4":"audio_data.head()","f2d7f934":"audio_data.info()","076b7a94":"correlations = audio_data.corr()\ncorrelations.style.background_gradient()","3447fc0e":"features = audio_data.drop(['genre_top','track_id'],axis=1)\nlabels = audio_data['genre_top']","ddb6d4ca":"scaler = StandardScaler()\nscaled_features = scaler.fit_transform(features)","c9a8fc0a":"pca = PCA()\npca.fit(scaled_features)\nexp_variance = pca.explained_variance_ratio_\nnum_components = pca.n_components_","dd0459ca":"# plot the explained variance using a barplot\nfig, ax = plt.subplots()\nax.bar(range(num_components), exp_variance)\nax.set_xlabel('Principal Component #')","d3dd7e07":"cum_exp_variance = np.cumsum(exp_variance) #calculate the cumulative explained variance\n\nfig, ax = plt.subplots()\nax.plot(cum_exp_variance)\nax.axhline(y=0.85, linestyle='--') #for considering features needed to explain 85% of the variance","9fcb0bc6":"n_components = 6","7f1d3e39":"#finally perform PCA with the chosen number of components\npca = PCA(n_components, random_state=10)\npca.fit(scaled_features)\npca_projection = pca.transform(scaled_features)","5dda8c6f":"pca_projection.shape","95555a9f":"#split data into test and train data\nX_train, X_test, y_train, y_test = train_test_split(pca_projection,labels,random_state=10)","0b6d95d7":"model_dt = DecisionTreeClassifier(random_state=10)\nmodel_dt.fit(X_train,y_train)","cb321aea":"predictions_dt = model_dt.predict(X_test)\nprint(\"Decision Tree Classifier:\", model_dt.score(X_test,y_test))","fb733c82":"model_lg = LogisticRegression(random_state=10)\nmodel_lg.fit(X_train,y_train)","0ac71470":"predictions_lg = model_lg.predict(X_test)\nprint(\"Logistic Regression:\", model_lg.score(X_test,y_test))","293cb8f3":"report_dt = classification_report(y_test,predictions_dt)\nreport_lg = classification_report(y_test,predictions_lg)\n\nprint(\"Decision Tree Classifier: \\n\", report_dt)\nprint(\"Logistic Regression: \\n\", report_lg)","4ae0d995":"sns.countplot(audio_data['genre_top'], label = \"Count\") ","ef57a5c7":"# Subset only the hip-hop tracks, and then only the rock tracks\nhip_hop = audio_data.loc[audio_data['genre_top'] == 'Hip-Hop']\nrock = audio_data.loc[audio_data['genre_top'] == 'Rock']","50c43e46":"hip_hop.shape","27c45132":"rock.shape","1782479a":"rock = rock.sample(hip_hop.shape[0], random_state=10)","4951a305":"#concatenate to create the balanced dataset\nbalanced_data = pd.concat([rock, hip_hop])","fa0a440e":"balanced_data.head()","371a2fc1":"#features and labels for the new balanced data\nfeatures = balanced_data.drop(['genre_top', 'track_id'], axis=1) \nlabels = balanced_data['genre_top']","030928af":"pca_projection = pca.fit_transform(scaler.fit_transform(features))\npca_projection.shape","a3823272":"#split this balanced data into test and train\nX_train, X_test, y_train, y_test = train_test_split(pca_projection, labels, random_state=10)","2f7f00c7":"#train decision tree on the balanced data\nmodel_dt = DecisionTreeClassifier(random_state=10)\nmodel_dt.fit(X_train,y_train)\npredictions_dt = model_dt.predict(X_test)","66294df7":"#train logistic regression on the balanced data\nmodel_lr = LogisticRegression(random_state=10)\nmodel_lr.fit(X_train,y_train)\npredictions_lr = model_lr.predict(X_test)","924425c6":"# compare the models\nprint(\"Decision Tree: \\n\", classification_report(y_test, predictions_dt))\nprint(\"Logistic Regression: \\n\", classification_report(y_test, predictions_lr))","dd60282e":"cv = KFold(n_splits=10, random_state=1, shuffle=True)","ca390481":"scores = cross_val_score(model_dt, X_test,y_test, scoring='accuracy', cv=cv, n_jobs=-1)\nprint(\"Decision Tree Classifier Accuracy:\", np.mean((scores)))","d0ec0afe":"scores = cross_val_score(model_lg, X_test,y_test, scoring='accuracy', cv=cv, n_jobs=-1)\nprint(\"Logistic Regression Accuracy:\", np.mean((scores)))","b0a5ecd5":"## Feature Reduction","69056e3a":"There does not appear to be a clear elbow in this scree plot, which means it is not straightforward to find the number of intrinsic dimensions using this method.","510f303c":"### Both the models- Decision Tree and Logitic Regressor perform almost the same with about 84-87% accuracy. But, one important thing you can notice in the classification reports is that both these models predict Rock songs pretty well with an accuracy of 90%. However the prediction rate for Hip-Hop is much lower. In an ideal world this is not how our classifier should be like. I will aim to get both the accuracies to the same level, which then would mean our classifier is doing a good job. ","43033f54":"The shape confirms that we now have 6 features in total.","50fa0c45":"### The goal of this Notebook is to be able to classify songs as Rock or Hip-Hop without actually hearing them. I aim to do this with the help of the audio data available. \n\n### In doing so, I do the following: \n- clean the data\n- exploratory data visualization of the data\n- feature reduction (Correlation and Principal Component Analysis)\n- use ML algorithms like decision trees and logistic regression","ecf23160":"#### Merge these two datasets, only include relevant columns from both","c0ecd59b":"#### As you can now see, the classification rates for both rock and hip-hop are now almost the same. This mean that balancing our data has removed bias towards the more prevalent class. ","2c0dcc4f":"I use scree-plots and cumulative explained ratio plots to find the number of components to use in further analyses.","bb32ff0b":"## Model Training","572f4085":"Audio data of almost 5000 different songs are used.\nData needed is contained in two files, one CSV file which contains basic information about the track along with the genre and a JSON file containing muscial features like danceability and acousticness. \nThis data was complied by The Echo Nest (a research group).","bb64a452":"### Train a Logistic Regression Model","ba600c2a":"### 3892 rock songs compared to only 910 hip hop songs. Remove this imbalance by sampling the rock songs to have the same number as hip hop","1d18b1f6":"Viewing the data- there is a class imbalance data. More Rock songs present in our dataset than Hip-Hop","288e616d":"No pair of features have a strong enough correlation that we can eliminate a feature. Hence, lets now use the PCA approach.\n\nTo avoid bais that may be introduced by higher values of certain features, first normalize the data.","2d530222":"This is important as with many features, we run the risk of overfitting our model. At the same time, a reducded number of features will decrease the computation time of the model making it predict results much quicker. \n\nFirst lets look at correlations and then try Principal Component Analysis (PCA).","42dce1ab":"### 1. Checking relationships between variables\/features\nThis is done to check for variables that have strong correlations with each other, this will help to avoid feature redundancy.  ","68b3e955":"## Read data","a62d7639":"### Train a Decision Tree Classifier Model","d523cde8":"# Classify Song Genres from Audio Data","5bac8233":"From the figure, I can say about 6 features are needed to explain 85% of the variance, hence this is the number of features I will use to carry out the model training with.","a217c276":"To find the final actual performance accuracy of our models, I will use the K-Fold Cross Validation procedure. This step allows us to compare models in a more rigorous fashion.","7248b850":"## Successully able to classify songs as Rock or Hip-Hop using the audio data features with an accuracy of 81.5% using Logistic Regressor."}}