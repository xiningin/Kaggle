{"cell_type":{"e48eb3f5":"code","d1b49564":"code","1b9ef95d":"code","1dfb7a31":"code","07070e63":"code","d68b3f65":"code","9cb35008":"code","651088d6":"code","409b18fd":"code","5d13b2cc":"markdown","7ced8c1c":"markdown","89da1de9":"markdown","67ac59bf":"markdown","426f0daa":"markdown","bf9d28c7":"markdown","5069c89f":"markdown","a1e6b847":"markdown","a2b51962":"markdown","a8e54ec6":"markdown"},"source":{"e48eb3f5":"import datatable as dt  # pip install datatable\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","d1b49564":"%%time\ntrain_dt = dt.fread(\"..\/input\/tabular-playground-series-oct-2021\/train.csv\").to_pandas()","1b9ef95d":"%%time\ntest_dt = dt.fread(\"..\/input\/tabular-playground-series-oct-2021\/test.csv\").to_pandas()","1dfb7a31":"%%time\ntrain_pd = pd.read_csv(\"..\/input\/tabular-playground-series-oct-2021\/train.csv\")","07070e63":"%%time\ntest_pd = pd.read_csv(\"..\/input\/tabular-playground-series-oct-2021\/test.csv\")","d68b3f65":"memory_usage_train = train_pd.memory_usage(deep=True) \/ 1024 ** 2\nmemory_usage_test = test_pd.memory_usage(deep=True) \/ 1024 ** 2\n\nmemory_usage_train.head(7)","9cb35008":"memory_usage_train.sum()","651088d6":"def reduce_memory_usage(df, verbose=True):\n    numerics = [\"int8\", \"int16\", \"int32\", \"int64\", \"float16\", \"float32\", \"float64\"]\n    start_mem = df.memory_usage().sum() \/ 1024 ** 2\n    for col in df.columns:\n        col_type = df[col].dtypes\n        if col_type in numerics:\n            c_min = df[col].min()\n            c_max = df[col].max()\n            if str(col_type)[:3] == \"int\":\n                if c_min > np.iinfo(np.int8).min and c_max < np.iinfo(np.int8).max:\n                    df[col] = df[col].astype(np.int8)\n                elif c_min > np.iinfo(np.int16).min and c_max < np.iinfo(np.int16).max:\n                    df[col] = df[col].astype(np.int16)\n                elif c_min > np.iinfo(np.int32).min and c_max < np.iinfo(np.int32).max:\n                    df[col] = df[col].astype(np.int32)\n                elif c_min > np.iinfo(np.int64).min and c_max < np.iinfo(np.int64).max:\n                    df[col] = df[col].astype(np.int64)\n            else:\n                if (\n                    c_min > np.finfo(np.float16).min\n                    and c_max < np.finfo(np.float16).max\n                ):\n                    df[col] = df[col].astype(np.float16)\n                elif (\n                    c_min > np.finfo(np.float32).min\n                    and c_max < np.finfo(np.float32).max\n                ):\n                    df[col] = df[col].astype(np.float32)\n                else:\n                    df[col] = df[col].astype(np.float64)\n    end_mem = df.memory_usage().sum() \/ 1024 ** 2\n    if verbose:\n        print(\n            \"Mem. usage decreased to {:.2f} Mb ({:.1f}% reduction)\".format(\n                end_mem, 100 * (start_mem - end_mem) \/ start_mem\n            )\n        )\n    return df","409b18fd":"reduced_train_pd = reduce_memory_usage(train_pd, verbose=True)\nreduced_test_pd = reduce_memory_usage(test_pd, verbose=True)","5d13b2cc":"### Memory usage of train and test data","7ced8c1c":"### Import Libraries","89da1de9":"# Reduce the Dataset size by 76.9%\n\n\nThe first of your worries start when loading the data\u200a-\u200athe time it takes to read the dataset into your working environment can be as long as you train a model. At this stage, don't use pandas\u200a-\u200athere are much faster alternatives available.Its one of the datatable package which can read data up to 10 times faster.\n\nAs an example, we will load 1000000 rows Kaggle TPS OCT 2021 dataset with both datatable and pandas and compare the speeds:","67ac59bf":"### Loading data using pandas","426f0daa":"### Reduce the memory of train and test data which is loaded using pandas","bf9d28c7":"|            | Datatable  | Pandas   |\n|------------| -----------| ---------|\n| Train data | 19.1s      | 49.6s    |\n| Test data  | 8.91s      | 23.4s    |\n","5069c89f":"### Loading data using datatable","a1e6b847":" <center><img src=\"http:\/\/ift.tt\/2lRnGIX\" alt=\"centered image\"> <\/center>\n <h1 style=' border:0; color:#FFA500 '><center> If you find this notebook usefull support me with giving \u2b06\ufe0f!<\/left><\/h1> ","a2b51962":"### Load time comparision","a8e54ec6":"Reference : https:\/\/www.kaggle.com\/bextuychiev\/how-to-work-w-million-row-datasets-like-a-pro"}}