{"cell_type":{"45d762e2":"code","0eb4c3ce":"code","342cfd10":"code","af35854b":"code","cdd1f18b":"code","c008de95":"code","c20ca667":"code","f1c53eb7":"code","f6672d7e":"code","65ef6622":"code","c0d2e87b":"markdown","ecea7a33":"markdown","81ea9bc1":"markdown","42cd8fda":"markdown"},"source":{"45d762e2":"offset = 0\nlimit = 3000\nperiod = 'max' # valid periods: 1d,5d,1mo,3mo,6mo,1y,2y,5y,10y,ytd,max","0eb4c3ce":"import pandas as pd\n\ndata = pd.read_csv(\"http:\/\/www.nasdaqtrader.com\/dynamic\/SymDir\/nasdaqtraded.txt\", sep='|')\ndata_clean = data[data['Test Issue'] == 'N']\nsymbols = data_clean['NASDAQ Symbol'].tolist()\nprint('total number of symbols traded = {}'.format(len(symbols)))","342cfd10":"! pip install yfinance > \/dev\/null 2>&1\n! mkdir hist","af35854b":"import yfinance as yf\nimport os, contextlib","cdd1f18b":"%%time\n\nlimit = limit if limit else len(symbols)\nend = min(offset + limit, len(symbols))\nis_valid = [False] * len(symbols)\n# force silencing of verbose API\nwith open(os.devnull, 'w') as devnull:\n    with contextlib.redirect_stdout(devnull):\n        for i in range(offset, end):\n            s = symbols[i]\n            data = yf.download(s, period=period)\n            if len(data.index) == 0:\n                continue\n        \n            is_valid[i] = True\n            data.to_csv('hist\/{}.csv'.format(s))\n\nprint('Total number of valid symbols downloaded = {}'.format(sum(is_valid)))","c008de95":"valid_data = data_clean[is_valid]\nvalid_data.to_csv('symbols_valid_meta.csv', index=False)","c20ca667":"!mkdir stocks\n!mkdir etfs","f1c53eb7":"etfs = valid_data[valid_data['ETF'] == 'Y']['NASDAQ Symbol'].tolist()\nstocks = valid_data[valid_data['ETF'] == 'N']['NASDAQ Symbol'].tolist()","f6672d7e":"import shutil\nfrom os.path import isfile, join\n\ndef move_symbols(symbols, dest):\n    for s in symbols:\n        filename = '{}.csv'.format(s)\n        shutil.move(join('hist', filename), join(dest, filename))\n        \nmove_symbols(etfs, \"etfs\")\nmove_symbols(stocks, \"stocks\")","65ef6622":"! rmdir hist","c0d2e87b":"## Configs","ecea7a33":"## Separating ETFs and Stocks","81ea9bc1":"## Download Historic data","42cd8fda":"## Download all NASDAQ traded symbols"}}