{"cell_type":{"3ea4629c":"code","a3fdf6a7":"code","1280f175":"code","3175cd06":"code","5036d403":"code","91c4cad9":"code","e313f57b":"code","d8bbd256":"code","345126a3":"code","6e4453b6":"code","704e855a":"code","a8296226":"code","e82755ef":"code","7c3e794c":"code","edc14a25":"code","e4740adb":"code","ec73d639":"code","4762604c":"markdown","9a83b04b":"markdown","b3a237b3":"markdown","f0704dba":"markdown","ef272923":"markdown","5e77079c":"markdown"},"source":{"3ea4629c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.metrics import accuracy_score\nimport nltk\nimport nltk.corpus\n","a3fdf6a7":"tweet_data=pd.read_csv(\"..\/input\/nlp-getting-started\/train.csv\")\ntweet_data=tweet_data.drop([\"keyword\",\"location\"],axis=1)\ntweet_data.head()","1280f175":"test_data=pd.read_csv(\"..\/input\/nlp-getting-started\/test.csv\")\ntest_data=test_data.drop([\"keyword\",\"location\"],axis=1)\ntest_data.head()","3175cd06":"data1=pd.DataFrame(tweet_data.text,columns=[\"text\"])\ndata2=pd.DataFrame(test_data.text,columns=[\"text\"])\ndata=pd.concat([data1,data2],axis=0,ignore_index=True)","5036d403":"import re\nimport string\n\ndef remove_URL(text):\n    url = re.compile(r'https?:\/\/\\S+|www\\.\\S+')\n    return url.sub(r'', text)\n\ndef remove_html(text):\n    html = re.compile(r'<.*?>|&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-f]{1,6});')\n    return re.sub(html, '', text)\n\n# Applying helper functions\ndata['text'] = data['text'].apply(lambda x: remove_URL(x))\ndata['text'] = data['text'].apply(lambda x: remove_html(x))","91c4cad9":"for i in range(len(data)):\n    data[\"text\"][i].lower()\n","e313f57b":"from nltk.corpus import stopwords\nstop_words=set(stopwords.words(\"english\"))\nprint(stopwords.words(\"english\"))\nstop_wrds=np.array(stop_words)","d8bbd256":"import gensim\ndata[\"tokenized_text\"]=data[\"text\"].apply(gensim.utils.simple_preprocess)\ndata.head()","345126a3":"def remove_stp (txt_tokenized):\n    txt_clean=[word for word in txt_tokenized if word not in stop_words]\n    return txt_clean\ndata['clean_tokenized_text'] = data['tokenized_text'].apply(lambda x: remove_stp(x))\ndata.head()","6e4453b6":"def conc (txt_tokenized): \n    s=\" \"\n    tmp=s.join(txt_tokenized)\n    return tmp\ndata[\"clean_text\"] = data['clean_tokenized_text'].apply(lambda x: conc(x))\ndata.head()","704e855a":"data.clean_text","a8296226":"from sklearn.feature_extraction.text import CountVectorizer\ncv=CountVectorizer(ngram_range = (1,2))\nvector=cv.fit_transform(data[\"clean_text\"])\n","e82755ef":"X=vector[:len(tweet_data)]\ny=tweet_data.target\nX_train,X_test,y_train,y_test=train_test_split(X,y,train_size=0.90)","7c3e794c":"model=MultinomialNB()\n#model=RandomForestClassifier(n_estimators=130)\nmodel.fit(X_train,y_train)\npred=model.predict(X_test)","edc14a25":"accuracy_score(pred,y_test)","e4740adb":"test_vector=vector[len(tweet_data):]","ec73d639":"pre=model.predict(test_vector)\ndatframe=pd.DataFrame(pre,columns=[\"target\"])\ndf_submission = pd.read_csv(\"..\/input\/nlp-getting-started\/sample_submission.csv\")\ndf_submission['target']= datframe\ndf_submission.to_csv('my_submission.csv',index=False)","4762604c":"\u0420\u0430\u0437\u0434\u0435\u043b\u0438\u043c \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435","9a83b04b":"# \u041e\u0431\u0443\u0447\u0438\u043c \u043c\u043e\u0434\u0435\u043b\u044c\n\u0421\u043e\u0437\u0434\u0430\u0434\u0438\u043c \u0432\u0435\u043a\u0442\u043e\u0440\u043d\u043e\u0435 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e","b3a237b3":"### \u0423\u0434\u0430\u043b\u0438\u043c \u043d\u0435\u043d\u0443\u0436\u043d\u044b\u0435 \u0441\u0441\u044b\u043b\u043a\u0438, \u0441\u043c\u0430\u0439\u043b\u0438\u043a\u0438 \u0438 \u043f\u0440\u0438\u0432\u0435\u0434\u0435\u043c \u043a \u043d\u0438\u0436\u043d\u0435\u043c\u0443 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0443, \u0430 \u0442\u0430\u043a\u0436\u0435 \u0443\u0434\u0430\u043b\u0438\u043c \u0441\u0442\u043e\u043f \u0441\u043b\u043e\u0432\u0430","f0704dba":"### \u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u043c \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435","ef272923":"## \u041f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430","5e77079c":"\u0412\u044b\u0431\u0435\u0440\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c \u0438 \u043e\u0431\u0443\u0447\u0438\u043c"}}