{"cell_type":{"d7ec82cf":"code","321d638f":"code","922b25a7":"code","6a878568":"code","a7805d02":"code","2bb2a4b6":"code","9ceebfac":"code","d79b6206":"code","2edca780":"code","39822073":"code","b10fc368":"code","245be5d9":"code","96bb65f5":"code","99e8c843":"code","a85cadce":"code","b0da0672":"code","d53974a8":"code","db419494":"code","9d4928da":"code","19ee1862":"code","a1cb178f":"code","1ecc722f":"code","e084ba42":"code","1fcbefd4":"code","b20cc63c":"code","f2377925":"code","fe50e23d":"code","34566dad":"code","70c7a985":"code","2c423473":"code","3acbe966":"code","0474f9d6":"markdown","658e2931":"markdown","b2df7f13":"markdown","cdbfb4b9":"markdown","1855f062":"markdown","d7827e73":"markdown","dc2681e1":"markdown","2edc8b50":"markdown","4c50b1e0":"markdown"},"source":{"d7ec82cf":"import numpy as np\nimport pandas as pd\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","321d638f":"df=pd.read_csv(\"\/kaggle\/input\/clicks-conversion-tracking\/KAG_conversion_data.csv\")","922b25a7":"df.head()","6a878568":"df.info()","a7805d02":"df.describe()","2bb2a4b6":"import matplotlib.pyplot as plt\nimport seaborn as sns","9ceebfac":"from pandas_profiling import ProfileReport\nplt.ion()\nprofile = ProfileReport(df, title=\"Pandas Profiling Report\")\nprofile","d79b6206":"#Correlation Matrix\ng=sns.heatmap(df[[\"Impressions\",\"Clicks\",\"Spent\",\"Total_Conversion\",\"Approved_Conversion\",\"interest\"]].corr(),annot=True ,fmt=\".2f\", cmap=\"coolwarm\")","2edca780":"df[\"xyz_campaign_id\"].replace({916:\"Campaign_1\",936:\"Campaign_2\",1178:\"Campaign_3\"}, inplace=True)\ndf.head()","39822073":"# count plot on single categorical variable \nsns.countplot(x ='xyz_campaign_id', data = df) \nplt.show() ","b10fc368":"plt.bar(df[\"xyz_campaign_id\"], df[\"Approved_Conversion\"])\nplt.ylabel(\"Approved_Conversion\")\nplt.title(\"company vs Approved_Conversion\")\nplt.show()","245be5d9":"sns.countplot(x ='age', data = df) \nplt.show() ","96bb65f5":"sns.barplot(x=df[\"xyz_campaign_id\"], y=df[\"Approved_Conversion\"], hue=df[\"age\"], data=df)","99e8c843":"sns.countplot(x ='gender', data = df) \n# Show the plot \nplt.show() ","a85cadce":"sns.barplot(x=df[\"xyz_campaign_id\"], y=df[\"Approved_Conversion\"], hue=df[\"gender\"], data=df)\n","b0da0672":"fig, ax = plt.subplots(figsize=(15,6))\nsns.countplot(x ='interest', data = df) \n# Show the plot \nplt.show() ","d53974a8":"plt.scatter(df[\"interest\"], df[\"Approved_Conversion\"])\nplt.title(\"interest vs. Approved_Conversion\")\nplt.xlabel(\"interest\")\nplt.ylabel(\"Approved_Conversion\")\nplt.show()","db419494":"g = sns.FacetGrid(df, col=\"gender\",hue = 'age')\ng.map(plt.scatter, \"interest\", \"Approved_Conversion\", alpha=.4)\ng.add_legend();","9d4928da":"g = sns.FacetGrid(df, col=\"age\",hue = 'gender')\ng.map(plt.scatter, \"interest\", \"Approved_Conversion\", alpha=.4)\ng.add_legend();","19ee1862":"g = sns.FacetGrid(df,col = 'gender',hue = 'age')\ng.map(plt.scatter,'Impressions', 'Clicks', alpha=0.6)\ng.add_legend()","a1cb178f":"g = sns.FacetGrid(df,col = 'age',hue = 'gender')\ng.map(plt.scatter,'Impressions', 'Clicks', alpha=0.4)\ng.add_legend()","1ecc722f":"g = sns.FacetGrid(df, col=\"age\",hue = 'gender')\ng.map(plt.scatter, \"Spent\", \"Approved_Conversion\", alpha=.4)\ng.add_legend();","e084ba42":"g = sns.FacetGrid(df, col=\"gender\",hue= 'age')\ng.map(plt.scatter, \"Impressions\", \"Approved_Conversion\", alpha=.4)\ng.add_legend();","1fcbefd4":"from sklearn.preprocessing import LabelEncoder\ndf[\"xyz_campaign_id\"].replace({\"Campaign_1\":916 ,\"Campaign_2\":936 ,\"Campaign_3\":1178}, inplace=True)\nencoder=LabelEncoder()\nencoder.fit(df[\"gender\"])\ndf[\"gender\"]=encoder.transform(df[\"gender\"])\nencoder.fit(df[\"age\"])\ndf[\"age\"]=encoder.transform(df[\"age\"])","b20cc63c":"x=np.array(df.drop(labels=[\"Approved_Conversion\",\"Total_Conversion\"], axis=1))\ny=np.array(df[\"Total_Conversion\"])","f2377925":"from sklearn.model_selection import train_test_split\nx_train, x_val, y_train, y_val = train_test_split(x,y,test_size=0.2, random_state=42)","fe50e23d":"import optuna\nimport xgboost as xgb\nfrom optuna.samplers import TPESampler\nfrom sklearn.preprocessing import RobustScaler, QuantileTransformer, StandardScaler,MinMaxScaler\nfrom sklearn.model_selection import train_test_split, cross_val_score, StratifiedKFold, KFold\nfrom sklearn.metrics import mean_squared_error\ndtrain = xgb.DMatrix(x_train,y_train)\ndtest  = xgb.DMatrix(x_val,y_val)\n","34566dad":"def objective(trial):\n    params = {\n        \"subsample\": trial.suggest_discrete_uniform(\"subsample\", 0.6,1,0.1),\n        \"colsample_bytree\": trial.suggest_discrete_uniform(\"colsample_bytree\", 0.6,1,0.1),\n        \"eta\": trial.suggest_loguniform(\"eta\",1e-2,0.1),\n        \"gamma\": trial.suggest_loguniform(\"gamma\",0.05,1),\n        \"max_depth\": trial.suggest_categorical(\"max_depth\",[5,7,9,11,13]),\n        \"min_child_weight\": trial.suggest_int(\"min_child_weight\",5,11),\n        \"random_state\": 2021\n    }\n    return(return_rmse(params)) ","70c7a985":"import re\ndef return_rmse(params):\n    model = xgb.train(params , dtrain, num_boost_round = 20, evals = [(dtest, 'eval')],\n          early_stopping_rounds=20,verbose_eval = 0)\n    result = model.eval(dtest)\n    result = np.float(re.search(r'[\\d.]+$',result).group(0))\n    print(result)\n    return(result)","2c423473":"study1 = optuna.create_study(direction='minimize',sampler=TPESampler())\nstudy1.optimize(objective, n_trials= 300,show_progress_bar = True)","3acbe966":"from sklearn.metrics import mean_absolute_error\nxgb_model = xgb.XGBRegressor(**(study1.best_params))\n\n%time xgb_model.fit(x_train, y_train, early_stopping_rounds=7, eval_set=[(x_val, y_val)], verbose=False)\n\ny_pred_xgb = xgb_model.predict(x_val)\nmae_xgb = mean_absolute_error(y_val, y_pred_xgb)\nprint(\"MAE: \", mae_xgb)\n","0474f9d6":"Here, we see that the columns are quite interrelated with each other.","658e2931":"**Data:**\n\nThe data used in this project is from an anonymous organisation\u2019s social media ad campaign.\n\n1.) ad_id: an unique ID for each ad.\n\n2.) xyzcampaignid: an ID associated with each ad campaign of XYZ company.\n\n3.) fbcampaignid: an ID associated with how Facebook tracks each campaign.\n\n4.) age: age of the person to whom the ad is shown.\n\n5.) gender: gender of the person to whim the add is shown\n\n6.) interest: a code specifying the category to which the person\u2019s interest belongs (interests are as mentioned in the person\u2019s Facebook public profile).\n\n7.) Impressions: the number of times the ad was shown.\n\n8.) Clicks: number of clicks on for that ad.\n\n9.) Spent: Amount paid by company xyz to Facebook, to show that ad.\n\n10.) Total conversion: Total number of people who enquired about the product after seeing the ad.\n\n11.) Approved conversion: Total number of people who bought the product after seeing the ad.","b2df7f13":"# SUMMARY\n**Correlations:**\n* All the columns are fairly correlated with each other.\n\n**Campaign_3:**\n1. Campaign_3 has most number of ads.\n2. Campaign_3 has best Approved_conversion count.\n\n**Age_group:** In Campaign_3 and Campaign_2, the age group of 30-34 shows more interest whereas in Campaign_1 the age group of 40-44 shows more interest.\n\n**gender:**Both the genders shows similar interests in all three campaigns.\n\n**interest:**Although the count of interest after 100 is less,there is a rise of users after 100 who actually bought the product. Rest of the distribution is according to what was expected.\n\n**Product bought after clicking the ad:**\n8. It seems men tend to click more than women but women buy more products than men after clicking the add.\n9. People in age group 30-34 has more tendency to buy product after clicking the add.","cdbfb4b9":"# If you liked it please upvote it!","1855f062":"The Interesting Fact is that although the count of interest after 100 is less,there is a rise of users after 100 who actually bought the product","d7827e73":"The Age Group of 30-34 had seen the most amount of ad's","dc2681e1":"Campaign_3 had a great Approved Conversion while Campaign_1 showed good Approved Conversion given that it had very less number of ad's","2edc8b50":"Both the genders i.e. Male and Female had nearly equal contribution","4c50b1e0":"Campaign_3 showed the most ad's"}}