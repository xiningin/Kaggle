{"cell_type":{"b2ac91d7":"code","2ee2b93b":"code","48817f3c":"code","954516fe":"code","ced5d0f4":"code","782fd7f3":"code","c5d8eb38":"code","8d88085c":"code","671604b6":"code","15d56c46":"code","cd7cb9b4":"code","eb65ecdc":"code","c61ac239":"code","ecc3b6b0":"code","975dcc8e":"code","fc690d27":"code","c1eb5c8c":"code","b81ffd04":"code","70024cb0":"code","5d8ca385":"markdown","e3abd021":"markdown","0cc63c4c":"markdown"},"source":{"b2ac91d7":"import numpy as np\nimport os\n\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\nmpl.rc('axes', labelsize=14)\nmpl.rc('xtick', labelsize=12)\nmpl.rc('ytick', labelsize=12)\n\nfrom sklearn.datasets import fetch_openml\nfrom sklearn.model_selection import train_test_split\n\nfrom sklearn.decomposition import PCA\n\nnp.random.seed(42)","2ee2b93b":"mnist = fetch_openml('mnist_784', version=1, as_frame=False)\nmnist.target = mnist.target.astype(np.uint8)","48817f3c":"mnist.details","954516fe":"mnist.feature_names[:5]","ced5d0f4":"len(mnist.feature_names)","782fd7f3":"X = mnist[\"data\"]\ny = mnist[\"target\"]\n\nX_train, X_test, y_train, y_test = train_test_split(X, y)","c5d8eb38":"pca = PCA()\npca.fit(X_train)","8d88085c":"pca.get_params()","671604b6":"pca.components_[:5]","15d56c46":"len(pca.components_)","cd7cb9b4":"pca.explained_variance_[:5]","eb65ecdc":"len(pca.explained_variance_)","c61ac239":"pca.explained_variance_ratio_[:5]","ecc3b6b0":"len(pca.explained_variance_ratio_)","975dcc8e":"cumsumExplained = np.cumsum(pca.explained_variance_ratio_)\nd = np.argmax(cumsumExplained >= 0.95) + 1\nd","fc690d27":"plt.figure(figsize=(6,4))\nplt.plot(cumsumExplained, linewidth=3)\nplt.axis([0, 400, 0, 1])\nplt.xlabel(\"Dimensions\")\nplt.ylabel(\"Explained Variance\")\nplt.plot([d, d], [0, 0.95], \"k:\")\nplt.plot([0, d], [0.95, 0.95], \"k:\")\nplt.plot(d, 0.95, \"ko\")\nplt.annotate(\"Elbow\", xy=(65, 0.85), xytext=(70, 0.7),\n             arrowprops=dict(arrowstyle=\"->\"), fontsize=16)\nplt.grid(True)\nplt.show()","c1eb5c8c":"pca = PCA(n_components=0.95)\nX_reduced = pca.fit_transform(X_train)","b81ffd04":"pca.n_components_","70024cb0":"np.sum(pca.explained_variance_ratio_)","5d8ca385":"# 154 columns => 95 variance ratio ","e3abd021":"# using n_components ","0cc63c4c":"(n_components=0.95)  ==  (n_components=154)"}}