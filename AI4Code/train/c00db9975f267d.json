{"cell_type":{"8bec06ed":"code","3a1e80f5":"code","9579d43c":"code","45ba6257":"code","30711e24":"code","9358c55b":"code","dec74ceb":"code","0582c7b1":"code","de11cab3":"code","1ca77fdb":"code","3947d2a8":"code","62a3c5db":"code","e49756d3":"code","22467f2e":"code","759cbf32":"code","dd6c59a1":"code","09d38983":"code","64f98b32":"code","7dfaa6aa":"code","2a7e2c77":"code","8abf4d1f":"markdown","05be8757":"markdown","63ca3489":"markdown","66f1c8ca":"markdown","b454cc41":"markdown"},"source":{"8bec06ed":"!pip install -qU \"monai[ignite, nibabel, torchvision, tqdm]==0.6.0\"","3a1e80f5":"!nvidia-smi","9579d43c":"import os\nimport cv2\nimport random\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport tempfile\nimport nibabel as nib\nfrom typing import Optional, Any, Mapping, Hashable\n\nimport monai\nfrom monai.config import print_config\nfrom monai.utils import first\nfrom monai.config import KeysCollection\nfrom monai.data import Dataset, ArrayDataset, create_test_image_3d, DataLoader\nfrom monai.transforms import *\n\n#print_config()","45ba6257":"data_dir='..\/input\/rsna-miccai-png\/train\/00000\/T2w'\nfn_keys = (\"img\", \"seg\")        # filename keys for image and seg files\nnames0=os.listdir(data_dir)\nnames=sorted(names0)\nfilenames=[]\nimagedata=[]\nfor im in os.listdir(data_dir):\n    im_filename=os.path.join(data_dir,im)\n    image=cv2.imread(im_filename)\n    seg_filename=im\n    filenames.append({\"img\": im_filename, \"seg\": seg_filename})\n    imagedata.append(image)","30711e24":"print(filenames[0]['img'])\nprint(np.array(imagedata[0]).shape)","9358c55b":"img0=cv2.imread(filenames[0][\"img\"])\nprint(img0.shape)\nplt.imshow(img0)","dec74ceb":"trans0 = Compose([LoadImage(image_only=True)])\nimg0=trans0(filenames[0][\"img\"])\nprint(img0.shape)\nplt.imshow(img0)\n# LoadImage deprives of channel data","0582c7b1":"trans0 = Compose([LoadImage(image_only=True),Resize((-1,1))])\nimg0=trans0(filenames[0][\"img\"])\nprint(img0.shape)\nplt.imshow(img0)","de11cab3":"trans0 = Compose([LoadImage(image_only=True),Resize((-1,3))])\nimg0=trans0(filenames[0][\"img\"])\nprint(img0.shape)\nplt.imshow(img0)","1ca77fdb":"trans0 = Compose([LoadImage(image_only=True),Resize((-1,4))])\nimg0=trans0(filenames[0][\"img\"])\nprint(img0.shape)\nplt.imshow(img0)","3947d2a8":"class SumDimension(Transform):\n    def __init__(self, dim=1):\n        self.dim = dim\n    def __call__(self, inputs):\n        return inputs.sum(self.dim)","62a3c5db":"trans0 = Compose([LoadImage(image_only=True),Resize((-1,4)),SumDimension(2)])\nimg0=trans0(filenames[0][\"img\"])\nprint(img0.shape)\nplt.imshow(img0)","e49756d3":"trans = Compose([LoadImage(image_only=True), AddChannel(), ToTensor()])\nimg0 = trans(filenames[0][\"img\"])\nprint(img0.shape)\nplt.imshow(img0[0])","22467f2e":"trans = Compose([LoadImage(image_only=True), Resize((32,32,3))])\nimg0 = trans(filenames[0][\"img\"])\nprint(img0.shape)\nprint(img0[0,:,:,:].shape)\nplt.imshow(img0[0,:,:,:])","759cbf32":"root_dir = tempfile.mkdtemp()\nprint(root_dir)\nfilenames = []\nfor i in range(5):\n    im, _ = create_test_image_3d(64,64,64)\n    filename = f\"{root_dir}\/im{i}.nii.gz\"\n    filenames.append(filename)\n    n = nib.Nifti1Image(im,np.eye(4))\n    nib.save(n, filename)","dd6c59a1":"filenames","09d38983":"filenames[0]","64f98b32":"trans = Compose([LoadImage(image_only=True)])\nimg = trans(filenames[0])\nprint(img.shape)\nN=list(range(32))\nrandom.seed(2021)\nrandom.shuffle(N)\n\nfig, axs = plt.subplots(3,3,figsize=(10,10))\nfor i in range(9):\n    r=i\/\/3\n    c=i%3\n    ax=axs[r][c].imshow(img[N[i]])\nplt.show()","7dfaa6aa":"class SumDimension(Transform):\n    def __init__(self, dim=1):\n        self.dim = dim\n    def __call__(self, inputs):\n        return inputs.sum(self.dim)","2a7e2c77":"trans = Compose([LoadImage(image_only=True), AddChannel(), SumDimension(2)])\nimg = trans(filenames[0])\nprint(img.shape)\nplt.imshow(img[0])","8abf4d1f":"# Transform Single Image","05be8757":"https:\/\/github.com\/Project-MONAI\/MONAI<br\/>","63ca3489":"![Upvote!](https:\/\/img.shields.io\/badge\/Upvote-If%20you%20like%20my%20work-07b3c8?style=for-the-badge&logo=kaggle)","66f1c8ca":"# from monai.data import create_test_image_3d","b454cc41":"<img src=\"https:\/\/raw.githubusercontent.com\/Project-MONAI\/MONAI\/dev\/docs\/images\/MONAI-logo-color.png\" style=\"width: 300px\"\/><br\/>\nThis notebook refferred to the Colab Notebook, \"Getting Started with MONAI\".<br\/>\nhttps:\/\/colab.research.google.com\/github\/Project-MONAI\/MONAIBootcamp2021\/blob\/master\/day1\/1.%20Getting%20Started%20with%20MONAI.ipynb"}}