{"cell_type":{"14cddf47":"code","fc1c84b7":"code","8f4038b4":"code","90405a41":"code","58ee6b0f":"code","75b397a1":"code","20e317e8":"code","8ea4f2b0":"code","5b0df5f6":"code","7368a57e":"code","24b3a0b6":"code","bb456d91":"code","d492f918":"code","484e1056":"markdown","282e56db":"markdown","f1589cdb":"markdown","3214565b":"markdown","49a4c98e":"markdown","653742ad":"markdown","1bb78398":"markdown","47a4633e":"markdown","d133f2f2":"markdown"},"source":{"14cddf47":"import pandas as pd\n\ndf=pd.read_csv(\"\/kaggle\/input\/telecom-users-dataset\/telecom_users.csv\")\ndf","fc1c84b7":"df.select_dtypes(exclude=\"object\")","8f4038b4":"df.drop(columns=[\"Unnamed: 0\", \"customerID\"], inplace=True)","90405a41":"from matplotlib import pyplot as plt\nimport seaborn as sns\n\nsns.set_style(\"whitegrid\")\nsns.set_palette(\"pastel\")\n\nfig, ax=plt.subplots(nrows=7, ncols=2, figsize=(20, 35))\nfig.tight_layout(h_pad=10, w_pad=13)\n\nplt.sca(ax[0, 0])\nplt.pie(x=df.gender.value_counts(), labels=df.gender.value_counts().index, autopct=\"%1.0f%%\")\nax[0, 0].set_title(\"Distribution of Genders\", fontsize=20, pad=25)\n\nplt.sca(ax[0, 1])\nsns.countplot(x=df.SeniorCitizen, hue=df.gender)\nax[0, 1].set_title(\"Retired Clients\", fontsize=20, pad=25)\nplt.xlabel(\"\")\nplt.ylabel(\"\")\nplt.xticks(ticks=[0, 1], labels=[\"No\", \"Yes\"])\nplt.legend(title=\"Gender\")\n\nplt.sca(ax[1, 0])\nsns.countplot(x=df.Partner, hue=df.gender)\nax[1, 0].set_title(\"Civil Status of Clients\", fontsize=20, pad=25)\nplt.xlabel(\"\")\nplt.ylabel(\"\")\nax[1, 0].set_xticklabels([\"Married\", \"Single\"])\nplt.legend(title=\"Gender\")\n\nplt.sca(ax[1, 1])\nsns.histplot(x=df.tenure, hue=df.gender, multiple=\"stack\")\nax[1, 1].set_title(\"Months of People Who Have Been Clients of The Company\", fontsize=20, pad=25)\nplt.xlabel(\"Months\")\nplt.ylabel(\"\")\n\nservices=[\"Phone Service\", \"Multiple Lines\", \"Internet Service\", \"Online Security\", \"Online Backup\",\n          \"Device Protection\", \"Tech Support\", \"Streaming TV\", \"Streaming Movies\"]\nfor x in range(len(services)):\n    plt.sca(ax[2+(x\/\/2), 0+(x%2)])\n    ax[2+(x\/\/2), 0+(x%2)].set_title(services[x], fontsize=20, pad=25)\n    sns.countplot(x=df[services[x].replace(\" \",\"\")], hue=df.Partner)\n    plt.legend(title=\"Civil Status of Clients\", labels=[\"Married\", \"Single\"])\n    plt.xlabel(\"\")\n    plt.ylabel(\"\")\n    \nax[6, 1].set_visible(False)\nplt.show()","58ee6b0f":"lostCustomers=df[df.SeniorCitizen==1].drop(columns=[\"SeniorCitizen\"]).copy()\nlostCustomers=lostCustomers.drop(columns=[\"Dependents\"]).rename(columns={\"tenure\":\"months\", \"Partner\": \"married\"})\nlostCustomers","75b397a1":"fig, ax=plt.subplots(ncols=2, nrows=3, figsize=(20, 20))\nfig.tight_layout(w_pad=17, h_pad=10)\n\n\nplt.sca(ax[0, 0])\nsns.scatterplot(x=lostCustomers.months, y=lostCustomers.MonthlyCharges, hue=lostCustomers.Contract)\nax[0, 0].set_title(\"Monthly Charges For Months of People Who Have Been Clients of The Company\", fontsize=15, pad=25)\nplt.xlabel(\"Months\")\nplt.ylabel(\"\")\n\n\nplt.sca(ax[0, 1])\nsns.histplot(x=lostCustomers.MonthlyCharges, kde=True)\nax[0, 1].set_title(\"Monthly Charges Histogram\", fontsize=15, pad=25)\nplt.xlabel(\"Monthly Charges\")\nplt.ylabel(\"\")\n\n\nplt.sca(ax[1, 0])\nsns.kdeplot(x=lostCustomers.months, hue=lostCustomers.PhoneService.replace({\"Yes\":\"Phone Service\", \"No\":\"No Phone Service\"})\n             +\" - \"+lostCustomers.InternetService.replace({\"No\":\"No Internet Service\"}), multiple=\"stack\", fill=False, palette=[\"red\", \"green\", \"blue\", \"orange\"])\nax[1, 0].set_title(\"Kernel Density Estimation of Types of Clients\", fontsize=15, pad=25)\nplt.xlabel(\"Months Being Client\")\n\n\nplt.sca(ax[1, 1])\nsns.countplot(x=lostCustomers[lostCustomers.PhoneService==\"Yes\"].MultipleLines, hue=lostCustomers.married)\nplt.legend(title=\"Civil Status\", labels=[\"Married\", \"Single\"])\nax[1, 1].set_xticklabels([\"Connected\", \"Not Connected\"])\nax[1, 1].set_title(\"Multiple Phone Lines Connected Status of Phone Service Users\", fontsize=15, pad=25)\nplt.ylabel(\"\")\nplt.xlabel(\"\")\n\n\nplt.sca(ax[2, 0])\n\ninternetService=lostCustomers[lostCustomers.InternetService!=\"No\"]\ninternetService=internetService[[\"OnlineSecurity\", \"OnlineBackup\", \"DeviceProtection\", \"TechSupport\", \"StreamingTV\", \"StreamingMovies\"]]\ninternetService.reset_index(drop=True, inplace=True)\nadittionalPacks={x:0 for x in range(7)}\n\nfor x in range(internetService.shape[0]):\n    key=internetService.iloc[x].tolist().count(\"Yes\")\n    adittionalPacks[key]=adittionalPacks.get(key, 0)+1    \n    \nsns.lineplot(x=adittionalPacks.keys(), y=adittionalPacks.values())\nax[2, 0].set_title(\"Numbers of Clients Using Additional Internet Packages\", fontsize=15, pad=25)\nplt.xlabel(\"Additional Internet Packages Count\")\nplt.ylabel(\"Clients Count\")\n\n\nplt.sca(ax[2, 1])\nax[2, 1].set_title(\"\")\nsns.countplot(x=lostCustomers.Contract)\nax[2, 1].set_title(\"Clients Count by Contrat Types\", fontsize=15, pad=25)\nplt.xlabel(\"Contrat Type\")\nplt.ylabel(\"\")\n\nplt.suptitle(\"Retired Clients Data Visualization\", fontsize=35, y=1.077)\nplt.show()","20e317e8":"mix_df=df[[\"Partner\", \"tenure\", \"PhoneService\", \"InternetService\", \"MonthlyCharges\", \"Contract\", \"Churn\"]].rename(columns={\"tenure\":\"months\", \"Partner\": \"married\"}).copy()\n\nfig, ax=plt.subplots(nrows=1, ncols=2, figsize=(25, 9))\nfig.tight_layout(pad=9)\nplt.suptitle(\"All Historical Clients\", fontsize=25,)\n\n\nplt.sca(ax[0])\nsns.scatterplot(x=mix_df.months, y=mix_df.MonthlyCharges, hue=mix_df.Contract)\nplt.ylabel(\"\")\nplt.xlabel(\"Months\")\n\nplt.sca(ax[1])\nsns.scatterplot(x=mix_df.months, y=mix_df.MonthlyCharges, hue=\n                mix_df.PhoneService.replace({\"Yes\":\"Phone Service\", \"No\":\"No Phone Service\"})\n                +\" - \"+mix_df.InternetService.replace({\"No\":\"No Internet Service\"}))\nplt.ylabel(\"\")\nplt.xlabel(\"Months\")\nplt.legend(title=\"Phone and Internet Services\")\n\nplt.show()","8ea4f2b0":"profilesByServices={\"Phone Service - No Internet Service\":mix_df[(mix_df.PhoneService==\"Yes\") & (mix_df.InternetService==\"No\")],\n                   \"Phone Service - Fiber Optic Internet Service\":mix_df[(mix_df.PhoneService==\"Yes\") & (mix_df.InternetService==\"Fiber optic\")],\n                   \"Phone Service - DSL Internet Service\":mix_df[(mix_df.PhoneService==\"Yes\") & (mix_df.InternetService==\"DSL\")],\n                   \"No Phone Service - DSL Internet Service\":mix_df[(mix_df.PhoneService==\"No\") & (mix_df.InternetService==\"DSL\")]}\n\nfor profile_name in profilesByServices.keys():\n    fig, ax=plt.subplots(nrows=2, ncols=3, figsize=(30, 9))\n    plt.suptitle(profile_name+\" User Profile\", fontsize=24)\n    \n    plt.sca(ax[0, 0])\n    ax[0, 0].set_title(\"Civil Status\", fontsize=18)\n    sns.countplot(x=profilesByServices.get(profile_name, 0).married.replace({\"Yes\":\"Married\", \"No\":\"Single\"}))\n    plt.ylabel(\"\") \n    plt.xlabel(\"\")\n    \n    plt.sca(ax[0, 1])\n    ax[0, 1].set_title(\"Distribution of Months That Have Been Clients\", fontsize=18)\n    sns.histplot(x=profilesByServices.get(profile_name, 0).months, kde=True)\n    plt.ylabel(\"\") \n    plt.xlabel(\"\")\n    \n    plt.sca(ax[0, 2])\n    ax[0, 2].set_title(\"Monthly Spending Distribution\", fontsize=18)\n    sns.histplot(x=profilesByServices.get(profile_name, 0).MonthlyCharges, kde=True)\n    plt.ylabel(\"\") \n    plt.xlabel(\"\")\n    \n    plt.sca(ax[1, 0])\n    ax[1, 0].set_title(\"Type of Contract\", fontsize=18)\n    sns.countplot(x=profilesByServices.get(profile_name, 0).Contract)\n    plt.ylabel(\"\") \n    plt.xlabel(\"\")\n    \n    plt.sca(ax[1, 1])\n    ax[1, 1].set_title(\"Churn\", fontsize=18)\n    sns.countplot(x=profilesByServices.get(profile_name, 0).Churn)\n    plt.ylabel(\"\") \n    plt.xlabel(\"\")\n    \n    plt.sca(ax[1, 2])\n    ax[1, 2].set_title(\"Churn by Type of Contract\", fontsize=18)\n    sns.countplot(x=profilesByServices.get(profile_name, 0)[profilesByServices.get(profile_name, 0).Churn==\"Yes\"].Contract)\n    plt.ylabel(\"\") \n    plt.xlabel(\"\")\n    \n    plt.show()\n","5b0df5f6":"fig, ax=plt.subplots(nrows=2, ncols=1, figsize=(20,14))\nfig.tight_layout(h_pad=12)\n\n\n\nplt.sca(ax[0])\nax[0].set_title(\"Customer Cancellation Rate\", fontsize=20)\nsns.histplot(x=mix_df.MonthlyCharges, hue=mix_df.Churn, multiple=\"stack\")\nplt.ylabel(\"Count of Clients\")\nplt.xlabel(\"Monthly Charges\")\n\n\n\nplt.sca(ax[1])\nax[1].set_title(\"Churn Percentages\", fontsize=20)\n\ncategorical_df=df.copy()\ncategorical_df.MonthlyCharges=pd.cut(x=categorical_df.MonthlyCharges, bins=[x for x in range(15, 121, 5)])\n\ncategorical_churn=pd.DataFrame(categorical_df.groupby(\"MonthlyCharges\")[\"Churn\"].value_counts(normalize=True))\ncategorical_churn.iloc[:: 2]\ncategorical_churn.iloc[1:: 2]\n\nindices=[\"(\"+str(x)+\", \"+str(5+x)+\"]\" for x in range(15, 120, 5)]\n\nsns.lineplot(y=categorical_churn.iloc[:: 2].Churn, x=indices, color=\"blue\")\nsns.lineplot(y=categorical_churn.iloc[1:: 2].Churn, x=indices, color=\"red\")\nplt.ylabel(\"Percentage of Count of Clients\")\nplt.xlabel(\"Monthly Charges Range\")\n\nplt.show()","7368a57e":"fig, ax=plt.subplots(ncols=2, nrows=1, figsize=(25, 7))\n\nrange_df=df[(df.MonthlyCharges>=70)&(df.MonthlyCharges<=105)&(df.Churn==\"Yes\")].copy()\n_2ServiceUsers=range_df[(range_df.PhoneService==\"Yes\")&(range_df.InternetService!=\"No\")].shape[0]\n\nplt.sca(ax[0])\nsns.barplot(x=[\"1 Service Users\", \"2 Services Users\"], y=[range_df.shape[0]-_2ServiceUsers, _2ServiceUsers])\nax[0].set_title(\"Internet or Phone Service Users Count\")\n\nplt.sca(ax[1])\nsns.kdeplot(x=range_df.tenure, hue=range_df.PhoneService.replace({\"Yes\":\"Phone Service\", \"No\":\"No Phone Service\"})\n             +\" - \"+range_df.InternetService.replace({\"No\":\"No Internet Service\"}), multiple=\"stack\", fill=False)\nplt.xlabel(\"Months Being Client\")\n\nplt.show()","24b3a0b6":"from sklearn.cluster import KMeans\n\nsegmentationDf=df.copy()\ninertia_list=[]\n\nfig, ax=plt.subplots(figsize=(30, 13), ncols=5, nrows=2)\n\nfor k in range(2, 11):\n    plt.sca(ax[(k-2)\/\/5, (k-2)%5])\n    \n    kmeans = KMeans(n_clusters=k)\n    kmeans.fit(segmentationDf[[\"tenure\", \"MonthlyCharges\"]])\n    inertia_list.append(kmeans.inertia_)\n    \n    segmentationDf[\"cluster\"]=kmeans.fit_predict(segmentationDf[[\"tenure\", \"MonthlyCharges\"]])\n    sns.scatterplot(x=segmentationDf.tenure, y=segmentationDf.MonthlyCharges, hue=segmentationDf.cluster)\n    \n    ax[(k-2)\/\/5, (k-2)%5].set_title(str(k)+\" Clusters\")\n\nplt.sca(ax[1, 4])\nsns.lineplot(x=[z for z in range(1, 1+len(inertia_list))], y=inertia_list, marker=\"o\", color=\"red\")\nax[1, 4].set_title(\"Elbow\")\n\nplt.show()","bb456d91":"kmeans = KMeans(n_clusters=3)\nsegmentationDf[\"cluster\"]=kmeans.fit_predict(segmentationDf[[\"tenure\", \"MonthlyCharges\"]])\n\nplt.figure(figsize=(20, 7))\nsns.scatterplot(y=segmentationDf.MonthlyCharges, x=segmentationDf.tenure, hue=segmentationDf.cluster, palette=[\"red\", \"orange\", \"yellow\"])\nplt.show()","d492f918":"additionalInternetServices=['OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies']\n\nsegmentationDf[\"additionalInternetServices\"]=segmentationDf[additionalInternetServices].eq(\"Yes\").sum(axis=1)\n\nfor z in range(3):\n    fig, ax=plt.subplots(nrows=2, ncols=2, figsize=(25, 12))\n    fig.tight_layout(h_pad=10, w_pad=5)\n    plt.suptitle(\"Cluster Type \"+str(z), y=1.076,fontsize=30)\n    \n    plt.sca(ax[0, 0])\n    ax[0, 0].set_title(\"Kernel Density Estimation Per Service Users\", fontsize=18)\n    sns.kdeplot(segmentationDf[segmentationDf.cluster==z].tenure, \n                hue=segmentationDf[segmentationDf.cluster==z].PhoneService.replace({\"Yes\":\"Phone User\", \"No\":\"No Phone User\"})+\n                \" - \"+segmentationDf[segmentationDf.cluster==z].InternetService+\" Internet User\")\n    plt.xlabel(\"Months Being Client\")\n    \n    plt.sca(ax[0, 1])\n    ax[0, 1].set_title(\"Churn\", fontsize=18)\n    sns.countplot(x=segmentationDf[segmentationDf.cluster==z].Churn)\n    plt.ylabel(\"\")\n    \n    plt.sca(ax[1, 0])\n    ax[1, 0].set_title(\"Number of Clients Using Additional Internet Packages\\n(Being Users Using Internet Service)\", fontsize=18)\n    sns.countplot(x=segmentationDf[(segmentationDf.cluster==z)&(segmentationDf.InternetService!=\"No\")].additionalInternetServices)\n    plt.ylabel(\"\")\n    plt.xlabel(\"Additional Internet Packages\")\n    \n    plt.sca(ax[1, 1])\n    ax[1, 1].set_title(\"Number of Clients Using Multiple Lines Phone Service\\n(Being Users Using Phone Service)\", fontsize=18)\n    sns.countplot(x=segmentationDf[(segmentationDf.cluster==z)&(segmentationDf.PhoneService==\"Yes\")].MultipleLines)\n    plt.ylabel(\"\")\n    plt.xlabel(\"Multiple Lines\")\n    \n    plt.show()","484e1056":"As we have seen before in the distribution of customers who left the Telecom service, we see here again that the customers who have had fiber optic and telephone services have been the ones who have left the Telecom services the most. Let's dive deeper into customer cancellation rate.","282e56db":"Curiously, this group uses 2 services, apart again we see that there is a big problem with users who use fiber optic and telephone services.","f1589cdb":"Wow! There has been no one who has only used fiber optic without phone service! How about we take a look at people for combinations of internet and phone services?","3214565b":"With this visualization we can draw several conclusions, but the most important is that married people obtain more services than singles, but instead of focusing on that point, let's visualize the data of retired clients.","49a4c98e":"We can see that retired customers if they had many additional packages, could consider price reductions. Having made these visualizations about the retired clients we have not been able to obtain profiles, what if we use the data of the retired and not retired, categorizing them by the money they spend monthly first? (So we dont have to individually look at additional packages)","653742ad":"# Customer Segmentation\n\nWhat if we forget everything from before and try to get to know customers by judging them by the months they get Telecom services and the money they spend monthly?\n\nSegmenting we could see if there are patterns and thus be able to generate new suggestions for the Telecom company!","1bb78398":"# Visualizing Distributions\n\nAll distributions will be shown except those related to payment methods, monthly payments, etc...","47a4633e":"Something is happening in the range 70-105! Let's see the characteristics of only those who left Telecom in that range.","d133f2f2":"# Information\n\n| Column Name| Description |\n| --- | --- |\n| customerID | customer id |\n| gender | client gender (male \/ female) |\n| SeniorCitizen | is the client retired (1, 0) |\n| Partner | is the client married (Yes, No) |\n| tenure | how many months a person has been a client of the company |\n| PhoneService | is the telephone service connected (Yes, No) |\n| MultipleLines | are multiple phone lines connected (Yes, No, No phone service) |\n| InternetService | client's Internet service provider (DSL, Fiber optic, No) |\n| OnlineSecurity | is the online security service connected (Yes, No, No internet service) |\n| OnlineBackup | is the online backup service activated (Yes, No, No internet service) |\n| DeviceProtection | does the client have equipment insurance (Yes, No, No internet service) |\n| TechSupport | is the technical support service connected (Yes, No, No internet service) |\n| StreamingTV | is the streaming TV service connected (Yes, No, No internet service) |\n| StreamingMovies | is the streaming cinema service activated (Yes, No, No internet service) |\n| Contract | type of customer contract (Month-to-month, One year, Two year) |\n| PaperlessBilling | whether the client uses paperless billing (Yes, No) |\n| PaymentMethod | payment method (Electronic check, Mailed check, Bank transfer (automatic), Credit card (automatic)) |\n| MonthlyCharges | current monthly payment |\n| TotalCharges | the total amount that the client paid for the services for the entire time |\n| Churn | whether there was a churn (Yes or No) |\n\nChurn is the measure of how many customers stop using a product. This can be measured based on actual usage or failure to renew (when the product is sold using a subscription model)."}}