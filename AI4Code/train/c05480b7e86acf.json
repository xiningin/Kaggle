{"cell_type":{"002a3694":"code","2e3aa559":"code","211b1821":"code","655de7fd":"code","66764aec":"code","bfd5c085":"code","82877cc1":"code","1de7f4be":"code","88118cac":"code","6b833485":"code","cb2e413c":"code","1219b624":"code","4744400e":"code","9599e612":"code","39fe7365":"code","8a5009df":"code","062f4ad7":"code","eb70d89f":"code","0dd17fc0":"code","d3f7a825":"code","f8209728":"markdown","577f4f33":"markdown","c29aa186":"markdown","e6d704c1":"markdown","1e14745b":"markdown","28656697":"markdown","42f9d920":"markdown","0fe1bd03":"markdown","b9d5f0f9":"markdown","4897a70b":"markdown","bf3a3df7":"markdown","f5107d5a":"markdown","45533432":"markdown","57219d6d":"markdown","832c17c5":"markdown","2d6b0286":"markdown","47e1da11":"markdown","933f9e59":"markdown","d9d1e0d7":"markdown","56156712":"markdown","f2db6d73":"markdown","64bfa655":"markdown","350ad200":"markdown","ede18980":"markdown","85cb4e32":"markdown","e4a31aeb":"markdown"},"source":{"002a3694":"import matplotlib.pyplot as plt\nimport math\nimport os\nimport random\nimport cv2\n\n# code for visualization borrowed from Mar\u00edlia Prata: https:\/\/www.kaggle.com\/mpwolke\/cherry-oops-i-didn-t-it-again\ndef visualize_images(path, n_images, is_random=True, figsize=(16, 16)):\n    plt.figure(figsize=figsize)\n    w = int(n_images ** .5)\n    h = math.ceil(n_images \/ w)\n    \n    all_names = os.listdir(path)\n    image_names = all_names[:n_images]   \n    if is_random:\n        random.seed(0)\n        image_names = random.sample(all_names, n_images)\n            \n    for ind, image_name in enumerate(image_names):\n        img = cv2.imread(os.path.join(path, image_name))\n        img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) \n        plt.subplot(h, w, ind + 1)\n        plt.imshow(img)\n        plt.xticks([])\n        plt.yticks([])\n    \n    plt.show()\nvisualize_images('..\/input\/ice-cream-dataset\/combined\/images', 9)","2e3aa559":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nfrom collections import Counter\nimport matplotlib.dates as mdates","211b1821":"prod = pd.read_csv(\"..\/input\/ice-cream-dataset\/bj\/products.csv\")\nrev = pd.read_csv(\"..\/input\/ice-cream-dataset\/bj\/reviews.csv\")","655de7fd":"prod.head()","66764aec":"prod.shape","bfd5c085":"sns.distplot(prod[\"rating\"], bins=25)\nplt.xlim([1,5])\nplt.show()","82877cc1":"prod[\"rating\"].describe()","1de7f4be":"prod[[\"name\",\"rating\",\"rating_count\"]].sort_values(\"rating\", ascending=False).head(10)","88118cac":"prod[[\"name\",\"rating\",\"rating_count\"]].sort_values(\"rating\").head(10)","6b833485":"prod[[\"name\",\"rating\",\"rating_count\"]].sort_values(\"rating_count\", ascending=False).head(10)","cb2e413c":"big_ingred_list = []\nfor ingred_list in prod[\"ingredients\"]:\n    # we can't quite do:  big_ingred_list.extend(ingred_list.split(\", \"))\n    # because there are commas within ingredients i.e.  \"LIQUID SUGAR (SUGAR, WATER)\" is 1 ingredient\n    start = 0\n    inside = False\n    for i,char in enumerate(ingred_list):\n        if char == \"(\":\n            inside = True\n        if char == \")\":\n            inside = False\n        if not inside and char == \",\":\n            big_ingred_list.append(ingred_list[start:i].lstrip())\n            start = i+1\n\nct = Counter(big_ingred_list)\nmost_common = ct.most_common(30)\nmost_common","1219b624":"ct.most_common()[-20:]","4744400e":"# Number of unique ingredients\nlen(ct)","9599e612":"top_flavor_ingreds = prod.sort_values(\"rating\", ascending=False)[\"ingredients\"].head(10)\nbig_ingred_list2 = []\nfor ingred_list in top_flavor_ingreds:\n    start = 0\n    inside = False\n    for i,char in enumerate(ingred_list):\n        if char == \"(\":\n            inside = True\n        if char == \")\":\n            inside = False\n        if not inside and char == \",\":\n            big_ingred_list2.append(ingred_list[start:i].lstrip())\n            start = i+1\n\nct2 = Counter(big_ingred_list2)\n[(ingred,count) for ingred,count in ct2.most_common() if ingred not in [i for i,x in most_common]]","39fe7365":"rev.head()","8a5009df":"rev.shape","062f4ad7":"rev[\"date\"] = pd.to_datetime(rev[\"date\"], format=\"%Y-%m-%d\")\nmpl_data = mdates.date2num(rev[\"date\"])\nplt.hist(mpl_data, bins=\"auto\")\nplt.gca().xaxis.set_major_locator(mdates.YearLocator())\nplt.gca().xaxis.set_major_formatter(mdates.DateFormatter('%m\/%Y'))\nplt.show()","eb70d89f":"# group by flavor and compute standard deviation of star ratings\nstd_rev = rev.groupby(\"key\")[\"stars\"].std().sort_values(ascending=False).head(5)\nstd_rev.name = \"stdev_stars\"\n\n# check to see how many ratings they have, and the mean rating\npd.concat([std_rev,prod[[\"key\",\"rating\",\"rating_count\"]].set_index(\"key\")], axis=1).head(5)","0dd17fc0":"sum_votes = rev[[\"helpful_yes\",\"helpful_no\"]].sum(axis=1) # sum yes & no votes for each review\nhas_votes = sum_votes > 0 # reviews with votes\nrev[\"vote_ratio\"] = rev.loc[has_votes,\"helpful_yes\"].div(sum_votes)\nsns.distplot(rev[\"vote_ratio\"], bins=15)\nplt.xlim([0,1])\nplt.show()","d3f7a825":"print(\"\\n\\n\".join(rev.sort_values(\"vote_ratio\")[\"text\"].head(5).values))","f8209728":"Common ingredients","577f4f33":"## Review dates","c29aa186":"The reviews are generally very positive (median 4.6) with a skew left.","e6d704c1":"Worst reviews","1e14745b":"Best reviews","28656697":"## Best and worst products by average rating","42f9d920":"We see peanuts and chocolate liquor appear in three of the top 10 flavors. Cocoa and lemon juice also appear in two.","0fe1bd03":"Below are some \"unhelpful reviews.\" They generally have negative sentiment.","b9d5f0f9":"# More to come...","4897a70b":"Chocolate chip cooking dough core is the most disliked flavor by far. Also, \"core\" flavors tend to be disliked more often. Interestingly, disliked flavors have more reviews.","bf3a3df7":"There is a bimodal distribution. Some reviews are marked as very helpful, some are considered very unhelpful.","f5107d5a":"**We will only look at Ben & Jerry's data to begin with.**","45533432":"## Distribution of average rating","57219d6d":"## Controversial products","832c17c5":"## Most reviewed products","2d6b0286":"## Helpfulness of reviews","47e1da11":"Ice Cream Sammie and Chocolate Peanut Butter Split are the highest rated flavors (although they also have fewer reviews). Of the flavors with 70+ reviews we see Sweet Like Sugar Cookie Dough Core, Chocolate Therapy\u00ae, and Phish Food\u00ae.","933f9e59":"Reviews date back to 2017 and have been consistent since. Notably, there has been a spike in reviews in the last few months!","d9d1e0d7":"The controversial products tend to have a low average rating, meaning there are a few positive outliers rating them as 5-star.","56156712":"# Ice cream!: A preliminary analysis ","f2db6d73":"## Common and uncommon ingredients","64bfa655":"Uncommon ingredients","350ad200":"Several flavors have > 200 reviews. The top four most reviewed flavors have generally good ratings (4.6-4.7).","ede18980":"# Reviews data","85cb4e32":"# Product data","e4a31aeb":"## Unique ingredients in the top flavors\nThe code below gets the ingredients used in the top 10 highest rated recipes and \"subtracts\" any ingredients which are commonly used across all flavors (defined above)."}}