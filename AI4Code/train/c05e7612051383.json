{"cell_type":{"ed84e881":"code","927f67b1":"code","72593912":"code","7f4da7f3":"code","f204c380":"code","60e3fdb1":"code","92e43c24":"code","ecf997b0":"code","976a1336":"code","12e4bc14":"code","dbde017c":"code","11f77603":"code","e0e1234d":"code","2910c06c":"code","343949d4":"code","3aec53b7":"code","ebd08bbe":"code","4d8add63":"code","1a998752":"code","8beb6428":"code","ce5a5c9a":"code","70731830":"code","19dff0a2":"code","52e4036b":"code","a1523b10":"code","f9e1c9ae":"code","4258a0d4":"code","9e42cfbb":"code","b5075433":"markdown"},"source":{"ed84e881":"import os\nos.listdir('..\/input\/chest-xray-pneumonia\/chest_xray\/train\/PNEUMONIA')","927f67b1":"loc1 = '..\/input\/chest-xray-pneumonia\/chest_xray\/train\/PNEUMONIA'\nloc2 = '..\/input\/chest-xray-pneumonia\/chest_xray\/train\/NORMAL'","72593912":"from tqdm import tqdm\nimport cv2\n\n#Extract Features\n\nfeatures = []\n\nfor i in tqdm(os.listdir(loc1)):\n    f = cv2.imread(os.path.join(loc1,i),0)\n    fr = cv2.resize(f,(50,50))\n    features.append(fr)\n    \nfor i in tqdm(os.listdir(loc2)):\n    f = cv2.imread(os.path.join(loc2,i),0)\n    fr = cv2.resize(f,(50,50))\n    features.append(fr)","7f4da7f3":"#Extract Labels\n\nlabels = []\n\nfor i in tqdm(os.listdir(loc1)):\n    labels.append(0)\n    \nfor i in tqdm(os.listdir(loc2)):\n    labels.append(1)","f204c380":"import numpy as np\nX = np.array(features)\nX.shape","60e3fdb1":"import numpy as np\nY = np.array(labels)\nY.shape","92e43c24":"Xt = X.reshape(5216,2500)\/X.max()\nYt = Y.reshape(5216,1)","ecf997b0":"from keras.utils import np_utils\nYt = np_utils.to_categorical(Yt)","976a1336":"from sklearn.model_selection import train_test_split\nxtrain,xtest,ytrain,ytest = train_test_split(Xt,Yt)","12e4bc14":"from keras import models\nfrom keras import layers","dbde017c":"model = models.Sequential()\nmodel.add(layers.Dense(256 , activation='relu' , input_dim=xtrain.shape[1]))\nmodel.add(layers.Dropout(0.3))\nmodel.add(layers.Dense(128 , activation='relu'))\nmodel.add(layers.Dropout(0.2))\nmodel.add(layers.Dense(256 , activation='relu'))\nmodel.add(layers.Dropout(0.2))\nmodel.add(layers.Dense(128 , activation='relu'))\nmodel.add(layers.Dropout(0.2))\nmodel.add(layers.Dense(2 , activation='softmax'))","11f77603":"model.summary()","e0e1234d":"from keras import optimizers\nfrom keras import metrics","2910c06c":"model.compile(optimizer='sgd',\n              loss = 'categorical_crossentropy',\n              metrics=['accuracy'])","343949d4":"model.fit(xtrain,ytrain,epochs=100,validation_data = (xtest,ytest))","3aec53b7":"print(model.evaluate(xtrain,ytrain))\nprint(model.evaluate(xtest,ytest))","ebd08bbe":"lv1 = '..\/input\/chest-xray-pneumonia\/chest_xray\/val\/PNEUMONIA'\nlv2 = '..\/input\/chest-xray-pneumonia\/chest_xray\/val\/NORMAL'\n\nval_feature = []\nfor i in tqdm(os.listdir(lv1)):\n    f = cv2.imread(os.path.join(lv1,i),0)\n    fr = cv2.resize(f,(50,50))\n    val_feature.append(fr)\n    \nfor i in tqdm(os.listdir(lv2)):\n    f = cv2.imread(os.path.join(lv2,i),0)\n    fr = cv2.resize(f,(50,50))\n    val_feature.append(fr)","4d8add63":"Xv = np.array(val_feature)\nXv.shape","1a998752":"Xv = Xv.reshape(16,2500)\/Xv.max()","8beb6428":"val_labels = []\n\nfor i in tqdm(os.listdir(lv1)):\n    val_labels.append(0)\n    \nfor i in tqdm(os.listdir(lv2)):\n    val_labels.append(1)","ce5a5c9a":"Yv = np.array(val_labels).reshape(-1,1)\nYv = np_utils.to_categorical(Yv)","70731830":"model.evaluate(Xv,Yv)","19dff0a2":"chest_xray = '..\/input\/chest-xray-pneumonia\/chest_xray\/val\/PNEUMONIA\/person1946_bacteria_4874.jpeg'\n\nimport cv2\nim = cv2.imread(chest_xray,0)\nim = cv2.resize(im,(50,50))","52e4036b":"im.shape","a1523b10":"model.predict([im.reshape(1,2500)])","f9e1c9ae":"Prections = np.array(['Pnemonia','Normal'])\n\nprint(np.argmax(model.predict([im.reshape(1,2500)])))\nprint(Prections[np.argmax(model.predict([im.reshape(1,2500)]))])","4258a0d4":"import matplotlib.pyplot as plt\nplt.imshow(im)\nplt.show()","9e42cfbb":"model.save('xray_model.h5')","b5075433":"**Validation**"}}