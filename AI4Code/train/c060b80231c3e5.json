{"cell_type":{"4d6bee69":"code","f42cbce8":"code","fdbeffbf":"code","f78a107d":"code","8724c778":"code","1642becd":"code","ac1ab2d2":"code","aa64fcef":"code","bb1fce92":"code","1daa990f":"code","d0352460":"code","8c160b40":"code","610b7f43":"code","83b0df4e":"code","8ee846da":"code","fecaee40":"markdown","d026f6f1":"markdown","e4d4149d":"markdown","ec7a8048":"markdown","1a4ed444":"markdown","be89f32d":"markdown","11381904":"markdown","f4416765":"markdown","9560f4e1":"markdown","d632663b":"markdown","57c9da44":"markdown","4fca8aa8":"markdown","3a3ec5fa":"markdown","750659da":"markdown","f8794d52":"markdown","e4be3fff":"markdown","620604fe":"markdown"},"source":{"4d6bee69":"import numpy as np \nimport pandas as pd\n\nimport os\n\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        os.path.join(dirname, filename)\n","f42cbce8":"import matplotlib.pyplot as plt\nimport seaborn as sns\nfrom PIL import Image\nimport keras\nfrom keras.models import Sequential\nfrom keras.layers import Convolution2D\nfrom keras.layers import MaxPooling2D\nfrom keras.layers import Flatten\nfrom keras.layers import Dense\nfrom keras.layers import BatchNormalization\nfrom keras.layers import Dropout\nfrom keras.layers import Flatten\nfrom keras.preprocessing import image\nfrom keras.preprocessing.image import ImageDataGenerator\n\nprint(os.listdir(\"..\/input\"))","fdbeffbf":"train= '..\/input\/chest-xray-pneumonia\/chest_xray\/train\/'\ntest = '..\/input\/chest-xray-pneumonia\/chest_xray\/test\/'\nval = '..\/input\/chest-xray-pneumonia\/chest_xray\/val\/'","f78a107d":"train_normal = train+'NORMAL\/'\ntrain_pneumonia = train+'PNEUMONIA\/'","8724c778":"rand1 = np.random.randint(0,len(os.listdir(train_normal)))\nimg1 = train_normal+os.listdir(train_normal)[rand1]\nprint('Normal picture is : ',img1)\n\nrand2 = np.random.randint(0,len(os.listdir(train_pneumonia)))\nimg2 = train_pneumonia+os.listdir(train_pneumonia)[rand2]\nprint('Normal picture is : ',img2)\n\nfig = plt.figure(1, figsize = (15,7))\n\nf1 = fig.add_subplot(1,2,1)\nplt.imshow(Image.open(img1),cmap = 'gray')\nf1.set_title('Normal')\n\nf2 = fig.add_subplot(1,2,2)\nplt.imshow(Image.open(img2),cmap = 'gray')\nf2.set_title('Pneumonia')","1642becd":"li = []\nfor i in range(0,len(os.listdir(train_normal))):\n    li.append('Normal')\nfor i in range(0,len(os.listdir(train_pneumonia))):\n    li.append('Pneumonia')\nsns.countplot(li)","ac1ab2d2":"# Initialising the CNN\nclassifier = Sequential()\n\n# First CNN layer\nclassifier.add(Convolution2D(32,(3,3), input_shape = (128,128,3),\n                            activation = 'relu'))\n#classifier.add(BatchNormalization())\nclassifier.add(MaxPooling2D(pool_size = (2,2)))\n\n# Second CNN layer\nclassifier.add(Convolution2D(32,(3,3),activation = 'relu'))\nclassifier.add(Dropout(0.1))\n#classifier.add(BatchNormalization())\nclassifier.add(MaxPooling2D(pool_size = (2,2)))\n\n# Third CNN layer\nclassifier.add(Convolution2D(32,(3,3),activation = 'relu'))\nclassifier.add(Dropout(0.2))\n#classifier.add(BatchNormalization())\nclassifier.add(MaxPooling2D(pool_size = (2,2)))\n\n# Flattening\nclassifier.add(Flatten())\n\n# Full Connection\nclassifier.add(Dense(units = 128, activation = 'relu'))\nclassifier.add(Dense(units = 1, activation = 'sigmoid'))\n\nclassifier.compile(optimizer = 'adam',\n                   loss = 'binary_crossentropy',\n                  metrics = ['accuracy'])\nclassifier.summary()","aa64fcef":"train_datagen = ImageDataGenerator(rescale = 1.\/255,\n                                   shear_range = 0.2,\n                                   zoom_range = 0.2,\n                                   horizontal_flip = True)\n\ntest_datagen = ImageDataGenerator(rescale = 1.\/255)\n\n","bb1fce92":"# for training set\ntraining_set = train_datagen.flow_from_directory(train,\n                                                 target_size = (128,128),\n                                                 batch_size = 16,\n                                                 class_mode = 'binary')\n\n","1daa990f":"# for test set\ntest_set = test_datagen.flow_from_directory(test,\n                                            target_size = (128,128),\n                                            batch_size = 16,\n                                            class_mode = 'binary')","d0352460":"# for validation set\nvalidation_set = test_datagen.flow_from_directory(val,\n                                            target_size = (128,128),\n                                            batch_size = 16,\n                                            class_mode = 'binary')","8c160b40":"history = classifier.fit_generator(training_set,\n                         steps_per_epoch = (5217\/\/16),\n                         epochs = 25,\n                         validation_data = test_set,\n                         validation_steps = (625\/\/16))","610b7f43":"classifier.evaluate_generator(test_set)","83b0df4e":"fig1,ax1 = plt.subplots(1,2,figsize = (20,5))\n    \nfor i,j in enumerate(['accuracy','loss']):\n    ax1[i].plot(history.history[j],'o-',color = 'green')\n    ax1[i].plot(history.history['val_'+j],'o-',color = '#D66520')\n    ax1[i].set_title('Model '+str(j))\n    ax1[i].set_xlabel('epochs')\n    ax1[i].set_ylabel(j)\n    ax1[i].legend(['train','val'])","8ee846da":"scores = classifier.evaluate_generator(test_set)\nprint('Accuracy of the Model is '+str(scores[1] *100))\nprint('Loss of the Model is '+str(scores[0]))","fecaee40":"# Fitting the Model","d026f6f1":"#### Pneumonia is an infection of the lungs that may be caused by bacteria, viruses, or fungi. The infection causes the lungs' air sacs (alveoli) to become inflamed and fill up with fluid or pus. That can make it hard for the oxygen you breathe in to get into your bloodstream. The symptoms of pneumonia can range from mild to severe, and include cough, fever, chills, and trouble breathing.\n\n#### Many factors affect how serious a case of pneumonia is, such as the type of germ causing the lung infection, the person\u2019s age, and their overall health. The people most at risk are infants and young children, adults 65 or older, and people who have other health problems.\n\n#### Pneumonia is a leading cause of hospitalization in both children and adults. Most cases can be treated successfully, although it can take weeks to fully recover. Tens of thousands of people in the India die from pneumonia every year, most of them adults over the age of 65.\n![](http:\/\/www.mayoclinic.org\/-\/media\/kcms\/gbs\/patient-consumer\/images\/2016\/05\/18\/13\/02\/ww5r032t-8col-jpg.jpg)\n\n","e4d4149d":"The dataset is organized into 3 folders (train, test, val) and contains subfolders for each image category (Pneumonia\/Normal). There are 5,863 X-Ray images (JPEG) and 2 categories (Pneumonia\/Normal).\n\nChest X-ray images (anterior-posterior) were selected from retrospective cohorts of pediatric patients of one to five years old from Guangzhou Women and Children\u2019s Medical Center, Guangzhou. All chest X-ray imaging was performed as part of patients\u2019 routine clinical care.\n\nFor the analysis of chest x-ray images, all chest radiographs were initially screened for quality control by removing all low quality or unreadable scans. The diagnoses for the images were then graded by two expert physicians before being cleared for training the AI system. In order to account for any grading errors, the evaluation set was also checked by a third expert.","ec7a8048":"#### A convolutional neural network, or CNN, is a deep learning neural network designed for processing structured arrays of data such as images. Convolutional neural networks are widely used in computer vision and have become the state of the art for many visual applications such as image classification, and have also found success in natural language processing for text classification.\n\n#### Convolutional neural networks are very good at picking up on patterns in the input image, such as lines, gradients, circles, or even eyes and faces. It is this property that makes convolutional neural networks so powerful for computer vision. Unlike earlier computer vision algorithms, convolutional neural networks can operate directly on a raw image and do not need any preprocessing.\n\n#### A convolutional neural network is a feed-forward neural network, often with up to 20 or 30 layers. The power of a convolutional neural network comes from a special kind of layer called the convolutional layer.\n\n#### Convolutional neural networks contain many convolutional layers stacked on top of each other, each one capable of recognizing more sophisticated shapes. With three or four convolutional layers it is possible to recognize handwritten digits and with 25 layers it is possible to distinguish human faces.\n\n#### The usage of convolutional layers in a convolutional neural network mirrors the structure of the human visual cortex, where a series of layers process an incoming image and identify progressively more complex features.\n\n![](http:\/\/www.jeremyjordan.me\/content\/images\/2017\/07\/Screen-Shot-2017-07-26-at-1.44.58-PM.png)","1a4ed444":"# Plotting Model accuracy and Model Loss","be89f32d":"## Now we will visualize some random chest X-ray of a person having Pneumonia and normal X-ray","11381904":"# Description of Dataset","f4416765":"# Image Augmentation Part","9560f4e1":"### Objective of the exercise is to detect whether a person is infected by Pneumonia or not.\n\n### In this exercise we will built a Convolutional Neural Nertwork (CNN) to know that the particular chest X-ray is infected by pneumonia or not and try to get better accuracy. The dataset in this exercise are the images of chest X-ray  some of them are infected by Pneumonia and some are not.\n\n![](https:\/\/www.kdnuggets.com\/wp-content\/uploads\/sagar-pneumonia-0.jpeg)\n\n## Steps involved in the entire Process:\n1. Importing the Dataset\n2. Importing the required Libraries\n3. Analysing the Dataset\n4. Building a Convolutional Neural Network (CNN)\n5. Image Augmentation \n6. Fitting the Model\n7. Plotting Model accuracy and Model Loss\n\n\n\n## Result:\n### At the end of the Excercise we will get an Accuracy of 90.064% and loss of 0.379\n","d632663b":"# What Is Pneumonia?","57c9da44":"# Pneumonia Detection using CNN","4fca8aa8":"### Deep networks need large amount of training data to achieve good performance. To build a powerful image classifier using very little training data, image augmentation is usually required to boost the performance of deep networks. Image augmentation artificially creates training images through different ways of processing or combination of multiple processing, such as random rotation, shifts, shear and flips, etc.","3a3ec5fa":"# Building a Convolutional Neural Network","750659da":"# Convolutional Neural Network","f8794d52":"# Importing Required Libraries","e4be3fff":"![](https:\/\/miro.medium.com\/max\/1000\/1*MH-w1Q3TN8EpgDYtcCXYcg.jpeg)","620604fe":"### Here we will use various libraries like Keras for building the Neural Network, matplotlib and seaborn to visualize the data which we have and PIL for the images.****"}}