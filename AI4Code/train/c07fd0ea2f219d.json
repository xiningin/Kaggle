{"cell_type":{"a8589dca":"code","20e42bd0":"code","62b79450":"code","fa860b89":"code","18dcccef":"code","5d1b95c7":"code","582b68ff":"code","635ce80f":"code","940ac686":"code","c0c42b98":"code","631e0b7b":"code","68885c35":"code","ede787de":"code","52ca74e8":"code","cbfe9fc4":"code","f994b08e":"code","44231e7b":"code","04a55799":"code","e7d9abf3":"code","ce3245a5":"code","7f135ed8":"code","2abc821d":"code","48270a09":"code","0ed693d6":"code","e04f853f":"code","ae8d5836":"code","8ae1f550":"code","e1811942":"code","09a9e946":"code","a31f4bec":"code","ba90a55e":"code","486fe0d8":"code","96e13f82":"code","f701414b":"code","e0f19c11":"code","786bfb9b":"code","14e25c5f":"code","4fa7f238":"code","118fd9e5":"code","d5d4b406":"code","f23fd475":"code","230d124c":"code","ab4e3bc1":"code","d3943819":"code","aac0f885":"code","73dc33d3":"code","978a0f5f":"code","97887512":"code","8bd0f3c4":"code","7afdc0d9":"code","18e45d6d":"code","3ebbb257":"code","242e5715":"code","f1f722e6":"code","f46135bb":"code","2ba325b4":"code","15b16c0d":"code","3104d9dd":"code","5d92e2be":"code","0d91784e":"code","bb744158":"code","2a6ec23e":"code","73ceb151":"code","bd81eb12":"code","22085846":"code","5ebf8f06":"code","0b4399ff":"code","44c1ec9f":"code","064e59fc":"code","4f948988":"code","8b232708":"code","24650be8":"code","818580d6":"code","2e6f850f":"code","89e89998":"code","7e752dd9":"code","eb1c375d":"code","d22d2f75":"code","01d9fcc2":"code","45113cae":"code","c3a3abec":"code","a9496f08":"code","ea218508":"code","819850fb":"code","5cd4b34d":"code","4e7e16a1":"code","b373ff29":"code","4d1034a0":"code","9bb67b61":"code","dfd1dd43":"code","2ea9102b":"code","a01a9642":"code","9efd8cf9":"code","eef855b8":"code","9f8630c9":"code","0715d253":"code","762fad23":"code","f668dbbb":"code","e1368680":"code","7c3c9a73":"code","0a1bb4e4":"code","5427c4c3":"markdown","a70e9f06":"markdown","af5a01b1":"markdown","f0a8cfe5":"markdown","85be65ba":"markdown","247f656d":"markdown","416ed131":"markdown","fa7192a0":"markdown","0b89a445":"markdown","6c52e181":"markdown","d8455d5b":"markdown","02079d6f":"markdown","2df38b9c":"markdown","e4bccdde":"markdown","92723d7d":"markdown","649b76a8":"markdown","9a28735e":"markdown","9b64d7e2":"markdown","c408423e":"markdown","c57c4f7b":"markdown","56804ed1":"markdown","54712545":"markdown","d1dfc004":"markdown","d7b75ae8":"markdown","a776d398":"markdown","1cc74bbe":"markdown","321d2116":"markdown","872f3d0c":"markdown","a1f3d7b4":"markdown","2e89d2b7":"markdown","159b35db":"markdown","9429e112":"markdown","736c5320":"markdown","dabf07e7":"markdown","7f158d15":"markdown","bf6cb27b":"markdown","631cc27b":"markdown","594c9f4b":"markdown","983bea7a":"markdown"},"source":{"a8589dca":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","20e42bd0":"!pwd","62b79450":"!pip install -q  missingno","fa860b89":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport missingno as ms\n%matplotlib inline","18dcccef":"!ls -l","5d1b95c7":"!wget -q https:\/\/www.dropbox.com\/s\/8grgwn4b6y25frw\/titanic.csv","582b68ff":"!ls -l","635ce80f":"data = pd.read_csv(\"..\/input\/train.csv\")","940ac686":"data.head(3)","c0c42b98":"#to get the last 5 entries of the data\ndata.tail(5)","631e0b7b":"type(data)","68885c35":"data.shape","ede787de":"data.info()","52ca74e8":"data.isnull().sum()","cbfe9fc4":"data.info()","f994b08e":"data.describe()","44231e7b":"ms.matrix(data)","04a55799":"data.info()","e7d9abf3":"sns.set_style('whitegrid')\nsns.countplot(x='Survived',data=data,palette='RdBu_r')","ce3245a5":"sns.set_style('whitegrid')\nsns.countplot(x='Survived',hue='Sex',data=data,palette='RdBu_r')","7f135ed8":"sns.set_style('whitegrid')\nsns.countplot(x='Survived',hue='Pclass',data = data,palette='rainbow')","2abc821d":"sns.distplot(data['Fare'])\n#KDE?","48270a09":"data['Fare'].hist(color = 'green', bins = 40, figsize = (8,3))","0ed693d6":"data.corr()","e04f853f":"sns.heatmap(data.corr(),cmap='coolwarm')\nplt.title('data.corr()')","ae8d5836":"sns.swarmplot\nsns.swarmplot(x='Pclass',y='Age',data=data,palette='Set1')","8ae1f550":"data['Age'].hist(bins = 40, color = 'darkred', alpha = 0.8)","e1811942":"data.info()","09a9e946":"plt.figure(figsize=(12, 7))\nsns.boxplot(x='Pclass',y='Age',data=data,palette='winter')","a31f4bec":"data['Age'].fillna(28, inplace=True)","ba90a55e":"data['Age'].median()","486fe0d8":"ms.matrix(data)","96e13f82":"data['Cabin'].value_counts()","f701414b":"data.info()","e0f19c11":"data.drop('Cabin',axis=1, inplace=True)","786bfb9b":"data.head()","14e25c5f":"data['Embarked'].value_counts()","4fa7f238":"data.dropna(inplace = True) # dropping missing embarked.","118fd9e5":"ms.matrix(data)","d5d4b406":"data.info()","f23fd475":"data['Sex'].value_counts()","230d124c":"sex = pd.get_dummies(data['Sex'],drop_first=True)\nsex.head()","ab4e3bc1":"data['Embarked'].value_counts()","d3943819":"embark = pd.get_dummies(data['Embarked'],drop_first=True)\nembark.head(10)","aac0f885":"sex.head()","73dc33d3":"old_data = data.copy()\ndata.drop(['Sex','Embarked','Name','Ticket'],axis=1,inplace=True)\ndata.head()\n","978a0f5f":"data = pd.concat([data,sex,embark],axis=1)","97887512":"data.dropna(inplace = True) # dropping missing embarked.data.info()\ndata.info()","8bd0f3c4":"data.describe()","7afdc0d9":"X = data.drop('Survived',axis=1)\ny = data['Survived']","18e45d6d":"y.shape","3ebbb257":"from sklearn.model_selection import train_test_split","242e5715":"X_train, X_test, y_train, y_test = train_test_split(X,y \n                                                    , test_size=0.20, \n                                                    random_state=42)","f1f722e6":"X_test.shape","f46135bb":"len(y_test)","2ba325b4":"178\/889","15b16c0d":"X.describe()","3104d9dd":"X_train.describe()","5d92e2be":"y_train.describe()","0d91784e":"from sklearn.linear_model import LogisticRegression\n\n# Build the Model.\nlogmodel = LogisticRegression()\nlogmodel.fit(X_train,y_train) # this is where training happens","bb744158":"logmodel.coef_","2a6ec23e":"logmodel.intercept_","73ceb151":"predict =  logmodel.predict(X_test)\npredict[:5]","bd81eb12":"y_test[:5]","22085846":"from sklearn.metrics import confusion_matrix, classification_report","5ebf8f06":"from sklearn.metrics import accuracy_score\nprint(accuracy_score(y_test,predict))","0b4399ff":"print(confusion_matrix(y_test, predict))","44c1ec9f":"from sklearn.metrics import precision_score","064e59fc":"print(precision_score(y_test,predict))","4f948988":"from sklearn.metrics import recall_score","8b232708":"print(recall_score(y_test,predict))","24650be8":"from sklearn.metrics import f1_score","818580d6":"print(f1_score(y_test,predict))","2e6f850f":"from sklearn.metrics import classification_report","89e89998":"print(classification_report(y_test,predict))","7e752dd9":"prod_data=pd.read_csv('..\/input\/test.csv')","eb1c375d":"prod_data.info()","d22d2f75":"ms.matrix(prod_data)","01d9fcc2":"prod_data['Age'].fillna(28, inplace=True)","45113cae":"ms.matrix(prod_data)","c3a3abec":"prod_data.drop('Cabin', axis = 1, inplace= True)","a9496f08":"ms.matrix(prod_data)","ea218508":"prod_data.fillna(prod_data['Fare'].mean(),inplace=True)","819850fb":"prod_data.info()","5cd4b34d":"ms.matrix(prod_data)","4e7e16a1":"sex = pd.get_dummies(prod_data['Sex'], drop_first=False)\nembark = pd.get_dummies(prod_data['Embarked'], drop_first=False)","b373ff29":"sex = pd.get_dummies(prod_data['Sex'], drop_first=False)\nembark = pd.get_dummies(prod_data['Embarked'], drop_first=False)\n\n\n\n","4d1034a0":"prod_data.drop(['Sex','Embarked','Name','Ticket'],axis=1,inplace=True)","9bb67b61":"prod_data = pd.concat([prod_data,sex,embark],axis=1)","dfd1dd43":"prod_data.head()","2ea9102b":"prod_data.drop([\"female\", 'C'], axis = 1, inplace = True)","a01a9642":"prod_data.head()","9efd8cf9":"prod_data.info()","eef855b8":"prod_data['Fare'].fillna(prod_data['Fare'].median(), inplace = True)","9f8630c9":"prod_data.info()","0715d253":"predict1=logmodel.predict(prod_data)\npredict1","762fad23":"df1=pd.DataFrame(predict1,columns=['Survived'])","f668dbbb":"df2=pd.DataFrame(prod_data['PassengerId'],columns=['PassengerId'])","e1368680":"df2.head()","7c3c9a73":"result = pd.concat([df2,df1],axis=1)\nresult.head()","0a1bb4e4":"result.to_csv('result.csv',index=False)","5427c4c3":"### Data Cleaning","a70e9f06":"### Prediction on Test Data From Kaggle","af5a01b1":"The graph shows the number of dead passengers are higher than the survivals by more than 1\/3.","f0a8cfe5":"Applying the function.","85be65ba":"The above graph also illustrates that female passangers survived by more than 50% of their counterpart male passangers. Thus very few females are dead as compared to males (about 20% of the males who succumbed during the accident) ","247f656d":"## Step - 5:Model Selection","416ed131":"The recall is the ratio tp \/ (tp + fn) where tp is the number of true positives and fn the number of false negatives. The recall is intuitively the ability of the classifier to find all the positive samples.\n\nThe best value is 1 and the worst value is 0.","fa7192a0":"## Step - 7 : Predict on New Cases","0b89a445":"## Step - 6 : Evaluation","6c52e181":"### Building a Logistic Regression model","d8455d5b":"## Step - 2: Obtain the Data","02079d6f":"#### Recall score","2df38b9c":"The balched feature at the middle shows us more people are concentrated within the rangeof that age","e4bccdde":"## Step - 4: Feature Engineering\n\nWe want to fill the missing values of the age in the dataset with the average age value for each of the classes. This is called data imputation.","92723d7d":"The graph is highly skewed to the left. Most of the passengers pay cheaper tickets and a very few people bought expensive tickets.  ","649b76a8":"The F1 score can be interpreted as a weighted average of the precision and recall, where an F1 score reaches its best value at 1 and worst score at 0. The relative contribution of precision and recall to the F1 score are equal. The formula for the F1 score is: F1 = 2 * (precision * recall) \/ (precision + recall)","9a28735e":"#### Precision Score","9b64d7e2":"Passangers who are onboarded in the lower class had lower chance of survivial and thus around 375 people died from third class while only less than 175 people are dead from both second and third class. This is presumably correct as passangers with higher status are likely to be rescued or are given first priority of safety.  ","c408423e":"The statistics shows the variable Age has 177 missing values\n","c57c4f7b":"#### Visualization of data with Seaborn","56804ed1":"### Import Libraries","54712545":"Pandas provides two important data types with in built functions to be able to provide extensive capability to handle the data.The datatypes include Series and DataFrames.","d1dfc004":"### Evaluation\nWe can check precision, recall, f1 - score using classification report!","d7b75ae8":"To get all the above metrics at one go, use the following function:","a776d398":"## Step - 3: Analyse the Data","1cc74bbe":"The target variable is the Survived column such that if survival = 1, the passenger is alive, otherwise dead.\n","321d2116":"#### Confusion Matrix","872f3d0c":"we have 891 rows and 12 columns","a1f3d7b4":"## Converting Catagorical Features\n\nWe'll need to convert categorical features to dummy variables using pandas! Otherwise our machine learning algorithm won't be able to directly take in those features as inputs.","2e89d2b7":"We can observe that there are missing values in 'Age', 'Cabin' and 'Embarked'. Lets continue","159b35db":"## Step - 1: Frame The Problem \n\nThe sinking of the RMS Titanic is one of the most infamous shipwrecks in history. On April 15, 1912, during her maiden voyage, the Titanic sank after colliding with an iceberg, killing 1502 out of 2224 passengers and crew. This sensational tragedy shocked the international community and led to better safety regulations for ships.\n\nOne of the reasons that the shipwreck led to such loss of life was that there were not enough lifeboats for the passengers and crew. Although there was some element of luck involved in surviving the sinking, some groups of people were more likely to survive than others, such as women, children, and the upper-class.\n\nIn this challenge, we ask you to complete the analysis of what sorts of people were likely to survive. In particular, we ask you to apply the tools of machine learning to predict which passengers survived the tragedy.","9429e112":"Pandas provides ways to read or get the data from various sources like read_csv,read_excel,read_html etc.The data is read and stored in the form of DataFrames.","736c5320":"#### f_score","dabf07e7":"# Kaggle Titanic \n### Logistic Regression with Python","7f158d15":"The precision is the ratio tp \/ (tp + fp) where tp is the number of true positives and fp the number of false positives. The precision is intuitively the ability of the classifier not to label as positive a sample that is negative.\n\nThe best value is 1 and the worst value is 0.","bf6cb27b":"Let's move on to evaluate our model.","631cc27b":"Here the histogram shows bimodal distribution of age, though age of the passangers seems to concentrate between 15 and 35 years of age. ","594c9f4b":"There are inconsistencies in test data.We can use the same graph functions that are used to visualize the train data for test data as well.We use the same data cleaning techniques like removing the cabin column and applying impute_age function on age column on test data.\nBut we cannot remove any rows because kaggle wants same number of rows in submission csv also. So we fill the missing values in fare with mean.","983bea7a":"#### Confusion \n\nTrue positive | False positive,\n____|____\n|\nFalse negative | True negative"}}