{"cell_type":{"22b786c0":"code","353bc237":"code","a9a7332f":"code","fa6457bf":"code","944bd964":"code","3c38c959":"code","bab04d12":"code","aa0f774f":"code","b9573772":"code","ff526e55":"code","c83516a0":"code","a76d82ef":"code","c4b5b40c":"markdown","e9c3161e":"markdown","b214854b":"markdown","61475aa5":"markdown"},"source":{"22b786c0":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport bq_helper\nimport matplotlib.pyplot as plt\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","353bc237":"london=bq_helper.BigQueryHelper(active_project='bigquery-public-data',dataset_name='london_crime')","a9a7332f":"london.list_tables()","fa6457bf":"london.head('crime_by_lsoa')","944bd964":"borough_count=\"\"\"select distinct borough from `bigquery-public-data.london_crime.crime_by_lsoa`;\"\"\"\nboroughs=london.query_to_pandas_safe(borough_count)\nboroughs","3c38c959":"lsoa_per_borough=\"\"\"select borough,count(distinct lsoa_code) from `bigquery-public-data.london_crime.crime_by_lsoa` \ngroup by borough order by count(distinct lsoa_code) desc\"\"\"\ncount_per_borough=london.query_to_pandas_safe(lsoa_per_borough)\ncount_per_borough","bab04d12":"value_per_borough=\"\"\"select borough,sum(value) from `bigquery-public-data.london_crime.crime_by_lsoa` \ngroup by borough order by sum(value) desc\"\"\"\nval_per_borough=london.query_to_pandas_safe(value_per_borough)\nval_per_borough","aa0f774f":"box=\"\"\"select sum(case when major_category='Burglary' then value else 0 end) as Burglary,\nsum(case when major_category='Criminal Damage' then value else 0 end) as Criminal_damage,\nsum(case when major_category='Drugs' then value else 0 end)as Drugs,\nsum(case when major_category='Other Notifiable Offences' then value else 0 end) as Offences,\nsum(case when major_category='Robbery' then value else 0 end) as Robbery,\nsum(case when major_category='Theft and Handling' then value else 0 end) as Theft,\nsum(case when major_category='Sexual Offences' then value else 0 end) as Sexual_offences,\nsum(case when major_category='Fraud or Forgery' then value else 0 end) as fraud \nfrom `bigquery-public-data.london_crime.crime_by_lsoa` group by borough\"\"\"\nbox1=london.query_to_pandas_safe(box)\nbox1.columns\nbox1.boxplot(column=['Burglary', 'Criminal_damage', 'Drugs', 'Offences', 'Robbery', 'Theft', 'Sexual_offences', 'fraud'],rot=90,grid=False,)\n","b9573772":" pivot=\"\"\"select borough,sum(case when year=2008 then value else 0 end)as Yr_2008,\n sum(case when year=2009 then value else 0 end)as Yr_2009,\n sum(case when year=2010 then value else 0 end)as Yr_2010,\n sum(case when year=2011 then value else 0 end)as Yr_2011,\n sum(case when year=2012 then value else 0 end)as Yr_2012,\n sum(case when year=2013 then value else 0 end)as Yr_2013,\n sum(case when year=2014 then value else 0 end)as Yr_2014,\n sum(case when year=2015 then value else 0 end)as Yr_2015,\n sum(case when year=2016 then value else 0 end)as Yr_2016\n from `bigquery-public-data.london_crime.crime_by_lsoa`\n group by borough order by borough\"\"\"\npv=london.query_to_pandas_safe(pivot)\npv","ff526e55":" pivot1=\"\"\"select major_category,sum(case when year=2008 then value else 0 end)as Yr_2008,\n sum(case when year=2009 then value else 0 end)as Yr_2009,\n sum(case when year=2010 then value else 0 end)as Yr_2010,\n sum(case when year=2011 then value else 0 end)as Yr_2011,\n sum(case when year=2012 then value else 0 end)as Yr_2012,\n sum(case when year=2013 then value else 0 end)as Yr_2013,\n sum(case when year=2014 then value else 0 end)as Yr_2014,\n sum(case when year=2015 then value else 0 end)as Yr_2015,\n sum(case when year=2016 then value else 0 end)as Yr_2016\n from `bigquery-public-data.london_crime.crime_by_lsoa`\n where borough='City of London'\n group by major_category order by major_category \"\"\"\npv1=london.query_to_pandas_safe(pivot1)\npv1","c83516a0":"rq=\"\"\"select * from (select bc,mj_c,dense_rank() over(partition by bc order by val desc) as rk from (select borough as bc,major_category as mj_c,sum(value) as val\nfrom `bigquery-public-data.london_crime.crime_by_lsoa` group by borough,major_category)) where rk=1\"\"\"\nrq1=london.query_to_pandas_safe(rq)\nrq1","a76d82ef":"import seaborn as sns; sns.set()\ntim=\"\"\"select borough,month,sum(value) as val,row_number() over(partition by borough order by sum(value) desc)  \nfrom `bigquery-public-data.london_crime.crime_by_lsoa` \nwhere borough in \n(select bor_name from (select borough as bor_name,dense_rank() over(order by sum(value)) as rk \nfrom `bigquery-public-data.london_crime.crime_by_lsoa` group by borough) where rk<6) and major_category='Theft and Handling'\ngroup by borough,month\"\"\"\ntim1=london.query_to_pandas_safe(tim)\ntim1\nax = sns.lineplot(x=\"month\", y=\"val\", hue=\"borough\",data=tim1)","c4b5b40c":"Here I am able to tell which crime is predominant and what severity does each crime take in respective boroughs.","e9c3161e":"1. The above query was written to assess the severity of the crime per borough and with this we will be able to analyze which borough contributes to the overall crime in london.\nNext up it will be appropriate to check the categories that contribute to the crime in the city of london.","b214854b":"Westminster seem to have highest crime value and City of London has the minimum crime, but the crime is increasing since year 2008 to 2016. It seems intuitive to check which crime is happening in London which is increasing and can be curbed.","61475aa5":"Violence against the person seems to be increasing in City of London year-wise. Theft and Handling consistently is on a high and contributes to the maximum crime in this borough."}}