{"cell_type":{"c58be089":"code","e5e47d48":"code","8ad751b4":"code","882baa52":"code","919d88a6":"code","2e5b8bb1":"code","790ad576":"code","aee1f352":"code","0100152e":"code","ceb40f20":"code","bc9cc104":"code","8422fd02":"code","fad6becb":"code","ba875dc8":"code","d53e53ad":"code","4c3b37dc":"code","eb81ec7a":"code","f7f8ef9e":"code","a126a10f":"code","2f86190a":"code","50ceb6da":"code","c5024afe":"code","cb2ef7e2":"code","189ae3d8":"code","a676e7a2":"code","30f251be":"code","59ca50fa":"code","ba895e1d":"code","5a77517a":"code","d758968a":"code","5276aae5":"code","99de9933":"code","40bf1770":"code","07966356":"code","401a331d":"code","3cb3eaac":"code","9563e87b":"code","f23dc09a":"code","065836c8":"code","f32ca4c8":"code","5ce0f789":"code","96fa5136":"code","52aed9b0":"code","b31091bc":"code","0e6ff03e":"code","f5208ae8":"code","0b271a7c":"code","da5e65f6":"code","63d95356":"code","d29f38c7":"code","ab573c76":"code","b986932a":"code","2eafc931":"code","b2d67170":"code","438f8580":"code","24b71dcc":"code","e95e7b13":"code","79cdbaed":"code","59b8c344":"code","cfa46dd4":"code","9343ac79":"code","22c6b098":"code","6be4f510":"code","1d01c0e7":"code","7470fc43":"code","1e1c2c40":"code","80cb2a02":"code","0bea5089":"code","6215f699":"code","4b166e39":"code","bb0312b5":"markdown","0d347195":"markdown","e7c0a62d":"markdown","7331dde3":"markdown","d7e97271":"markdown","47bb2fcf":"markdown","87393cfb":"markdown","5505e9ce":"markdown","e08970f3":"markdown","456b906c":"markdown","08999ad3":"markdown","45ceecc0":"markdown","dfb0a96f":"markdown","8623dcb1":"markdown","7764fca7":"markdown","e18efe38":"markdown","f2e2d044":"markdown","1f5963db":"markdown","0b2a2fdd":"markdown","3b1d29cd":"markdown","f2c59caa":"markdown","858d929f":"markdown","3e8bf374":"markdown","df42dffe":"markdown","d28b4f26":"markdown","f20f0d44":"markdown","2629a4d4":"markdown","92974595":"markdown","d99923a4":"markdown","ce90f768":"markdown","d0450c68":"markdown","5b77b720":"markdown","8a8ab989":"markdown","a1bf8408":"markdown","7d121720":"markdown","57a20c83":"markdown","dfc567c4":"markdown","f6cecb38":"markdown","43c383fc":"markdown","00223ba8":"markdown","1d6a1731":"markdown","20f9bf54":"markdown","c7f1038f":"markdown","c0e519f5":"markdown","101c7095":"markdown","fb4e8bb3":"markdown","0b5b2346":"markdown","4c5e05bc":"markdown","9ac9150c":"markdown","6632574a":"markdown","d6637aed":"markdown","17255ec0":"markdown","a51be192":"markdown","06c8926a":"markdown","e831a0c7":"markdown","d282f0b1":"markdown","424dfafc":"markdown","f81bd220":"markdown","3c04b288":"markdown","869d97d9":"markdown","c58af06e":"markdown","606a15f8":"markdown"},"source":{"c58be089":"import warnings\nwarnings.filterwarnings('always')\nwarnings.filterwarnings('ignore')","e5e47d48":"import matplotlib.pyplot as plt\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\n\nsns.set()\n%matplotlib inline","8ad751b4":"from sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection  import cross_val_score\nfrom sklearn import metrics\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.ensemble import RandomForestRegressor","882baa52":"train = pd.read_csv(\"..\/input\/bigmart-sales-data\/Train.csv\")\ntest = pd.read_csv(\"..\/input\/bigmart-sales-data\/Test.csv\")","919d88a6":"train.shape,test.shape","2e5b8bb1":"test.apply(lambda x: sum(x.isnull()))","790ad576":"test.isnull().sum()\/test.shape[0] *100","aee1f352":"train.apply(lambda x: sum(x.isnull()))","0100152e":"train.isnull().sum()\/train.shape[0] *100","ceb40f20":"train.info()","bc9cc104":"categorical = train.select_dtypes(include =[np.object])\nprint(\"Categorical Features in Train Set:\",categorical.shape[1])\n\nnumerical= train.select_dtypes(include =[np.float64,np.int64])\nprint(\"Numerical Features in Train Set:\",numerical.shape[1])","8422fd02":"categorical = test.select_dtypes(include =[np.object])\nprint(\"Categorical Features in Test Set:\",categorical.shape[1])\n\nnumerical= test.select_dtypes(include =[np.float64,np.int64])\nprint(\"Numerical Features in Test Set:\",numerical.shape[1])","fad6becb":"train.describe()","ba875dc8":"test.describe()","d53e53ad":"train.columns","4c3b37dc":"train['Item_Weight'].isnull().sum(),test['Item_Weight'].isnull().sum()","eb81ec7a":"plt.figure(figsize=(8,5))\nsns.boxplot('Item_Weight',data=train)","f7f8ef9e":"plt.figure(figsize=(8,5))\nsns.boxplot('Item_Weight',data=test)","a126a10f":"train['Item_Weight']= train['Item_Weight'].fillna(train['Item_Weight'].mean())\ntest['Item_Weight']= test['Item_Weight'].fillna(test['Item_Weight'].mean())","2f86190a":"train['Item_Weight'].isnull().sum(),test['Item_Weight'].isnull().sum()","50ceb6da":"train['Outlet_Size'].isnull().sum(),test['Outlet_Size'].isnull().sum()","c5024afe":"print(train['Outlet_Size'].value_counts())\nprint('******************************************')\nprint(test['Outlet_Size'].value_counts())","cb2ef7e2":"train['Outlet_Size']= train['Outlet_Size'].fillna(train['Outlet_Size'].mode()[0])\ntest['Outlet_Size']= test['Outlet_Size'].fillna(test['Outlet_Size'].mode()[0])","189ae3d8":"train['Outlet_Size'].isnull().sum(),test['Outlet_Size'].isnull().sum()","a676e7a2":"train.columns","30f251be":"train.head()","59ca50fa":"train['Item_Fat_Content'].value_counts()","ba895e1d":"train['Item_Fat_Content'].replace(['low fat','LF','reg'],['Low Fat','Low Fat','Regular'],inplace = True)\ntest['Item_Fat_Content'].replace(['low fat','LF','reg'],['Low Fat','Low Fat','Regular'],inplace = True)","5a77517a":"train['Item_Fat_Content']= train['Item_Fat_Content'].astype(str)","d758968a":"train['Years_Established'] = train['Outlet_Establishment_Year'].apply(lambda x: 2020 - x) \ntest['Years_Established'] = test['Outlet_Establishment_Year'].apply(lambda x: 2020 - x)","5276aae5":"train.head()","99de9933":"plt.figure(figsize=(8,5))\nsns.countplot('Item_Fat_Content',data=train,palette='ocean')","40bf1770":"plt.figure(figsize=(25,7))\nsns.countplot('Item_Type',data=train,palette='spring')","07966356":"plt.figure(figsize=(8,5))\nsns.countplot('Outlet_Size',data=train,palette='summer')","401a331d":"plt.figure(figsize=(8,5))\nsns.countplot('Outlet_Location_Type',data=train,palette='autumn')","3cb3eaac":"plt.figure(figsize=(8,5))\nsns.countplot('Outlet_Type',data=train,palette='twilight')","9563e87b":"plt.figure(figsize=(8,5))\nsns.countplot('Years_Established',data=train,palette='mako')","f23dc09a":"train.columns","065836c8":"plt.figure(figsize=(8,5))\nsns.barplot('Item_Fat_Content','Item_Outlet_Sales',data=train,palette='mako')","f32ca4c8":"plt.figure(figsize=(8,5))\nplt.scatter('Item_Visibility','Item_Outlet_Sales',data=train)","5ce0f789":"train['Item_Visibility']=train['Item_Visibility'].replace(0,train['Item_Visibility'].mean())\ntest['Item_Visibility']=test['Item_Visibility'].replace(0,test['Item_Visibility'].mean())","96fa5136":"plt.figure(figsize=(8,5))\nplt.scatter(y='Item_Visibility',x='Item_Outlet_Sales',data=train)\nplt.xlabel('Item Outlet Sales')\nplt.ylabel('Item Visibility')","52aed9b0":"plt.figure(figsize=(10,8))\nsns.barplot(y='Item_Type',x='Item_Outlet_Sales',data=train,palette='flag')","b31091bc":"plt.figure(figsize=(8,5))\nplt.scatter(y='Item_Outlet_Sales',x='Item_MRP',data=train)\nplt.xlabel('Item MRP')\nplt.ylabel('Item Outlet Sales')","0e6ff03e":"plt.figure(figsize=(8,5))\nsns.barplot(x='Outlet_Size',y='Item_Outlet_Sales',data=train,palette='winter')","f5208ae8":"plt.figure(figsize=(8,5))\nsns.barplot(x='Outlet_Location_Type',y='Item_Outlet_Sales',data=train,palette='plasma')","0b271a7c":"plt.figure(figsize=(8,5))\nsns.barplot(x='Years_Established',y='Item_Outlet_Sales',data=train,palette='viridis')","da5e65f6":"plt.figure(figsize=(25,5))\nsns.barplot('Item_Type','Item_Outlet_Sales',hue='Item_Fat_Content',data=train,palette='mako')\nplt.legend()","63d95356":"plt.figure(figsize=(10,5))\nsns.barplot('Outlet_Location_Type','Item_Outlet_Sales',hue='Outlet_Type',data=train,palette='magma')\nplt.legend()","d29f38c7":"train.head()","ab573c76":"le = LabelEncoder()\nvar_mod = ['Item_Fat_Content','Outlet_Location_Type','Outlet_Size','Outlet_Type','Item_Type']\n\nfor i in var_mod:\n    train[i] = le.fit_transform(train[i])\n    \nfor i in var_mod:\n    test[i] = le.fit_transform(test[i])","b986932a":"train.head()","2eafc931":"train = train.drop(['Item_Identifier','Outlet_Identifier','Outlet_Establishment_Year'],axis=1)\ntest= test.drop(['Item_Identifier','Outlet_Identifier','Outlet_Establishment_Year'],axis=1)","b2d67170":"train.columns","438f8580":"X= train[['Item_Weight','Item_Fat_Content','Item_Visibility','Item_Type','Item_MRP','Outlet_Size','Outlet_Location_Type','Outlet_Type','Years_Established']]\ny= train['Item_Outlet_Sales']","24b71dcc":"X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state=22)","e95e7b13":"features= ['Item_Weight','Item_Fat_Content','Item_Visibility','Item_Type','Item_MRP','Outlet_Size','Outlet_Location_Type','Outlet_Type','Years_Established']","79cdbaed":"LR = LinearRegression(normalize=True)\nLR.fit(X_train,y_train)\ny_pred = LR.predict(X_test)\ncoef2 = pd.Series(LR.coef_,features).sort_values()","59b8c344":"coef2","cfa46dd4":"plt.figure(figsize=(8,5))\nsns.barplot(LR.coef_,features)","9343ac79":"from sklearn.metrics import r2_score\nR2 = r2_score(y_test,y_pred)\nR2","22c6b098":"MAE= metrics.mean_absolute_error(y_test,y_pred)\nMSE= metrics.mean_squared_error(y_test,y_pred)","6be4f510":"print(\"mean absolute error:\",MAE)\nprint(\"mean squared error:\",MSE)","1d01c0e7":"from math import sqrt\nrmse = sqrt(MSE)\nprint(\"Root Mean Squared Error:\",rmse)","7470fc43":"RF= RandomForestRegressor(n_estimators=200,max_depth=5, min_samples_leaf=100,n_jobs=4,random_state=22)\n\n# Fitting the model on our trained dataset.\nRF.fit(X_train,y_train)\n\n# Making Predictions\ny_pred = RF.predict(X_test)","1e1c2c40":"coef3 = pd.Series(RF.feature_importances_, features).sort_values(ascending=False)\ncoef3","80cb2a02":"plt.figure(figsize=(8,5))\nsns.barplot(RF.feature_importances_,features)","0bea5089":"def cross_val(model_name,model,X,y,cv):\n    \n    scores = cross_val_score(model, X, y, cv=cv)\n    print(f'{model_name} Scores:')\n    for i in scores:\n        print(round(i,2))\n    print(f'Average {model_name} score: {round(scores.mean(),2)}')","6215f699":"cross_val(LR,LinearRegression(),X,y,5)","4b166e39":"cross_val(RF,RandomForestRegressor(),X,y,5)","bb0312b5":"### 1) Item Fat Content","0d347195":"### 3) Outlet Size","e7c0a62d":"## Random forest Model clearly did best!","7331dde3":"### We have succesfully imputed the missing values from the column Outlet_Size.","d7e97271":"### There are some columns that needs to be dropped as they don't seem helping our analysis.","47bb2fcf":"### We have succesfully imputed the missing values from the column Item_Weight.","87393cfb":"### 2) Random Forest Regressor","5505e9ce":"<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>Step 8. Evaluation Metrics<h2>","e08970f3":"<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>CONTENTS<h2>\n\n1. Import Relevant Libraries\n2. Data Inspection\n3. Data Cleaning\n4. Exploratory Data Analysis","456b906c":"![3405164-shopping-cart-with-a-thank-you-card.jpg](attachment:3405164-shopping-cart-with-a-thank-you-card.jpg)","08999ad3":"## Observations:\n\n* The Outlet Sales is maximum for Medium and High sized Outlets.\n* The Outlets we have is Medium and may be with High size Outlets can improve the Outlet Sales.","45ceecc0":"## **Observations**:\n    \n* Fruits and Vegetables are largely sold as people tend to use them on daily purpose.\n* Snack Foods too have good sales.","dfb0a96f":"## Observations:\n\n* The Outlets are more of Medium Size","8623dcb1":"### Why missing values treatment is required?\nMissing data in the training data set can reduce the power \/ fit of a model or can lead to a biased model because we have not analysed the behavior and relationship with other variables correctly. It can lead to wrong prediction.","7764fca7":"<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>Step 3. Data Cleaning <h2>","e18efe38":"## Observations:\n\n* It is quiet evident that Outlets established 35 years before is having good Sales margin.\n* We also have a outlet which was established before 22 years has the lowest sales margin, so established years wouldn't improve the Sales unless the products are sold according to customer's interest.","f2e2d044":"## Observations:\n    \n* The Outlets are more of Supermarket Type1.","1f5963db":"### 3) Item Type","0b2a2fdd":"### As said above we have 8523 rows and 12 columns in Train set whereas Test set has 5681 rows and 11 columns.","3b1d29cd":"### We have same missing values percentage of Item Size and Outlet Size columns as that of in Test set.","f2c59caa":"<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>DATA<h2>\n","858d929f":"<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>Step 4.C Multivariate Analysis<h2>","3e8bf374":"### We can see that now visibility is not exactly zero and it has some value indicating that Item is rarely purchased by the customers.","df42dffe":"## Observations:\n\n* The Items bought are more of Low Fat.","d28b4f26":"\n* Item_Identifier : Unique product ID\n\n* Item_Weight : Weight of product\n\n* Item_Fat_Content : Whether the product is low fat or not\n\n* Item_Visibility : The % of total display area of all products in a store allocated to the particular product\n\n* Item_Type : The category to which the product belongs\n\n* Item_MRP : Maximum Retail Price (list price) of the product\n\n* Outlet_Identifier : Unique store ID\n\n* Outlet_Establishment_Year : The year in which store was established\n\n* Outlet_Size : The size of the store in terms of ground area covered\n\n* Outlet_Location_Type : The type of city in which the store is located\n\n* Outlet_Type : Whether the outlet is just a grocery store or some sort of supermarket\n\n* Item_Outlet_Sales : Sales of the product in the particular store.\n","f20f0d44":"<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>Step 6. Feature Scaling <\/h2","2629a4d4":"\n<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>Step 4. Exploratory Data Analysis <h2>","92974595":"## **Observations**:\n\n* The Tier-3 location type has all types of Outlet type and has high sales margin.","d99923a4":"### Since the outlet_size is a categorical column, we can impute the missing values by \"Mode\"(Most Repeated Value) from the column.","ce90f768":"### a) R-Squared: \nR-squared is a statistical measure that represents the proportion of the variance for a dependent variable that's explained by an independent variable or variables in a regression model.\n\n* If the R2 of a model is 0.50, then approximately half of the observed variation can be explained by the model's inputs.","d0450c68":"The data scientists at BigMart have collected 2013 sales data for 1559 products across 10 stores in different cities. Also, certain attributes of each product and store have been defined. The aim is to build a predictive model and find out the sales of each product at a particular store. Using this model, BigMart will try to understand the properties of products and stores which play a key role in increasing sales.","5b77b720":"## **Observations**:\n\n* Items MRP ranging from 200-250 dollars is having high Sales.","8a8ab989":"<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>Step 4.B Bivariate Analysis <h2>","a1bf8408":"### We have 17% and 28% of missing values in Item weight and Outlet_Size columns respectively.","7d121720":"## Observations:\n\n* The Item Outles sales are high for both Low Fat and Regular Item types.","57a20c83":"### 2) Item Type","dfc567c4":"<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>PROBLEM STATEMENT<h2>","f6cecb38":"<CENTER><IMG SRC=\"https:\/\/datahack-prod.s3.ap-south-1.amazonaws.com\/__sized__\/contest_cover\/final-grocery--cover-thumbnail-1200x1200.png\"><\/CENTER>","43c383fc":"### Lets consider it like missing information and impute it with mean visibility of that product.","00223ba8":"### 1) Linear regression","1d6a1731":"## **Observations**:\n\n* The Outlets are maximum in number in Tier 3 Cities.","20f9bf54":"### 2) Item Visibility","c7f1038f":"### The Box Plots above clearly show no \"Outliers\" and hence we can impute the missing values with \"Mean\"","c0e519f5":"### c) RMSE:\n\nRMSE is a measure of how spread out these residuals are. In other words, it tells you how concentrated the data is around the line of best fit.","101c7095":"<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>Conclusions <h2>\n\n* Item_MRP clearly maximises the Outlet sales.\n* Outlet Type being SuperMarket or Grocery Store also depicts the Outlet Sales.\n* Years Established will also tend to have loyal customers and that's how the sales margin can be acheived.","fb4e8bb3":"## **Observations**:\n\n* The Outlets are more of established and running from 35 years.","0b5b2346":"## Observations:\n\n* The Outlet Sales tend to be high for Tier3 and Tier 2 location types but we have only Tier3 locations maximum Outlets. ","4c5e05bc":"<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>Step 1: Importing the Relevant Libraries <h2>","9ac9150c":"### 1) Item Size","6632574a":"### 1) Item Fat Content","d6637aed":"## 2) Outlet Size","17255ec0":"### We see there are some irregularities in the column and it is needed to fix them!","a51be192":"### b) MAE and MSE:\n\n* **MAE** : The mean absolute error (MAE) is a measure of errors between paired observations expressing the same phenomenon.\n* **MSE** : The mean squared error tells you how close a regression line is to a set of points. It does this by taking the distances from the points to the regression line (these distances are the \u201cerrors\u201d) and squaring them.","06c8926a":"### 4) Outlet Location Type","e831a0c7":"<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>Step 7. Building Model<h2>","d282f0b1":"<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>Step 5. Feature Engineering<h2>","424dfafc":"### 5) Outlet Type","f81bd220":"<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>Step 4.A. Univariate Analysis <h2>","3c04b288":"<h2 style='text-align:center;font-size:40px;background-color:CRIMSON;border:20px;color:white'>BIG MART SALES DATA PREDICTION<h2>\n","869d97d9":"## Observations:\n\n* The products available were Fruits-Veggies and Snack Foods but the sales of Seafood and Starchy Foods seems higher and hence the sales can be improved with having stock of products that are most bought by customers.","c58af06e":"## Observations:\n\n* Item_Visibility has a minimum value of zero. This makes no practical sense because when a product is being sold in a store, the visibility cannot be 0.","606a15f8":"<h2 style='text-align:center;font-size:30px;background-color:CRIMSON;border:20px;color:white'>Step 2. Data Inspection<h2>"}}