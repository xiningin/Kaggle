{"cell_type":{"ce4d1f52":"code","337f3859":"code","f8bca563":"code","1e12705f":"code","b9189977":"code","0fcad4e7":"code","9a7014d9":"code","e9763c7a":"code","0446c508":"code","587d3f69":"code","a76f71ce":"markdown","eabf766a":"markdown","ddb5a202":"markdown","a96e1d47":"markdown","f1dae5e3":"markdown","8efdfe43":"markdown","a976ac24":"markdown","9d35ffc3":"markdown"},"source":{"ce4d1f52":"import pandas as pd\nimport numpy as np \nimport tensorflow as tf\nfrom sklearn.model_selection import train_test_split","337f3859":"train = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ntest = pd.read_csv(\"..\/input\/titanic\/test.csv\")\ntrain.head()","f8bca563":"X = pd.get_dummies(train[[\"Sex\", \"Embarked\"]]).join(train[[\"Pclass\",\"SibSp\",\"Parch\",\"Age\"]].replace(np.nan, 50))\ny = train[\"Survived\"].to_numpy()\nX_train, X_test, y_train, y_test = train_test_split(X, y)\nX_train.head()","1e12705f":"model = tf.keras.models.Sequential([\n    tf.keras.layers.Dense(50),\n    tf.keras.layers.Dense(50, activation=\"relu\"),\n    tf.keras.layers.Dense(1, activation=\"sigmoid\")\n])","b9189977":"model.compile(\n    optimizer='nadam', \n    metrics=[tf.keras.metrics.BinaryAccuracy()], \n    loss=tf.keras.losses.BinaryCrossentropy()\n             )","0fcad4e7":"early_stopping_cb = tf.keras.callbacks.EarlyStopping(patience=20)\nmodel_checkpoint_cb = tf.keras.callbacks.ModelCheckpoint(\"Titanic_model.h5\", save_best_only=True)\nmodel.fit(X_train, y_train, epochs=100, validation_split=0.2, callbacks=[early_stopping_cb, model_checkpoint_cb])","9a7014d9":"model = tf.keras.models.load_model(\"Titanic_model.h5\")\nmodel.evaluate(X_test, y_test)","e9763c7a":"X_final_test = pd.get_dummies(test[[\"Sex\", \"Embarked\"]]).join(test[[\"Pclass\",\"SibSp\",\"Parch\", \"Age\"]].replace(np.nan, 25)).to_numpy()","0446c508":"y_final_test = np.round(model.predict(X_final_test))","587d3f69":"return_ = pd.DataFrame(test[\"PassengerId\"]).join(pd.DataFrame(data=y_final_test, columns=[\"Survived\"], dtype=np.int8)).to_csv(\"out.csv\", index=False)","a76f71ce":"### Preparation for the outing and make the predict","eabf766a":"# Titanic notebook","ddb5a202":"### Evaluate the model","a96e1d47":"### Create the model","f1dae5e3":"### Load data and create train and test data","8efdfe43":"### Imports","a976ac24":"### Train the model","9d35ffc3":"### Compile the model"}}