{"cell_type":{"c33d370d":"code","6ce95ae8":"code","431ce96a":"code","6a2dd10d":"code","5acbd6bf":"code","ad73e76e":"code","2bf1adef":"code","4a2ff15b":"code","4f35757d":"code","551ec0c5":"code","b03c01db":"code","8e900a5c":"code","86bf096b":"code","53c68044":"code","cccfacab":"code","b4b45a22":"code","cd0277a0":"code","5c8a3e37":"code","38d1751a":"code","c74a5eb1":"code","435d8b25":"code","fbcb1a31":"code","b0b388eb":"code","d78be749":"markdown","2ee60a01":"markdown","93abb59e":"markdown"},"source":{"c33d370d":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","6ce95ae8":"from fastai import *\nfrom fastai.vision import *\n\nfrom fastai.metrics import error_rate","431ce96a":"os.listdir('..\/input\/intel-image-classification')","6a2dd10d":"x = \"..\/input\/intel-image-classification\/seg_train\/seg_train\"\npath = Path(x)\npath.ls()","5acbd6bf":"np.random.seed(40)\ndata = ImageDataBunch.from_folder(path, train=\".\", valid_pct=0.2,ds_tfms=get_transforms(), size=224, \n                                  num_workers=4).normalize(imagenet_stats)","ad73e76e":"data.classes","2bf1adef":"data.show_batch(rows=3, figsize=(7,6))","4a2ff15b":"learn = cnn_learner(data, models.resnet34, metrics=[error_rate,accuracy],model_dir='\/kaggle\/working')","4f35757d":"learn.model","551ec0c5":"#training the model\nlearn.fit_one_cycle(3)","b03c01db":"cd ..\/kaggle\/working","8e900a5c":"#saving the model\nlearn.save('stage-1')","86bf096b":"interp = ClassificationInterpretation.from_learner(learn)","53c68044":"#visualizing the wrong prediction \ninterp.plot_top_losses(9, figsize=(15,11))","cccfacab":"#confusion matrix\ninterp.plot_confusion_matrix(figsize=(12,12), dpi=60)","b4b45a22":"interp.most_confused(min_val=2)","cd0277a0":"learn.unfreeze()","5c8a3e37":"learn.fit_one_cycle(1)","38d1751a":"learn.load('stage-1')","c74a5eb1":"#finding the optimum learning rate\nlearn.lr_find()","435d8b25":"learn.recorder.plot()","fbcb1a31":"learn.unfreeze()\nlearn.fit_one_cycle(2,max_lr=slice(1e-6,1e-4))","b0b388eb":"learn.unfreeze()\nlearn.fit_one_cycle(2,max_lr=slice(1e-5,1e-3))","d78be749":"**Model Initialization** ","2ee60a01":"Load all the liberaries","93abb59e":"**Data loader\/ Image generator**"}}