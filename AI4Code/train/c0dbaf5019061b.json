{"cell_type":{"c0a5dbae":"code","e21f3a29":"code","93970593":"code","5579d95e":"code","edf7c1fc":"code","8b44c179":"code","fdda8aff":"code","17325888":"code","0c9c0e0f":"code","02a1c0b5":"code","8029598b":"code","7c96d638":"code","3dd316be":"code","21e6a474":"code","99c952b4":"code","ef346a9d":"code","3117a115":"code","b12cc687":"code","76ebfdad":"code","2e5b617e":"code","d58e15d8":"code","62abe462":"code","08d68d81":"code","9bde8d98":"code","6e54d63f":"code","17dc6322":"code","1e3c8882":"code","34a42496":"code","de8a12ab":"code","811c3012":"code","74e397d5":"code","311710e1":"code","3b98db5c":"code","c62f0d99":"code","bc0c98c1":"code","9c6ccf45":"code","d9c1455b":"code","1c20a99a":"code","32927797":"code","ce8e95b1":"code","9f243bdf":"code","c238e24e":"code","fbc0bba1":"code","69d95cab":"code","1cdc57f1":"code","26bc68f5":"code","74ba9bf3":"code","ff82ff95":"code","6f947e88":"code","5d5d18b5":"code","d282bf0c":"code","989bc989":"code","0dce2a84":"code","62cfc3f7":"code","8260d1db":"code","e08b8b8d":"code","4c073600":"code","8b704cea":"code","3726efc4":"code","8de6b8df":"code","f4e5f0fd":"code","1f38e7cb":"code","61cabc28":"code","3753ed66":"code","ce49ead6":"code","6c2ba7e6":"code","fe53c282":"code","b0442c20":"code","7e6b56f8":"code","9f77842c":"code","8e70d013":"code","fccb04d0":"code","ea0adfea":"code","66dfa45c":"code","20c5ba78":"code","6ec96386":"code","57905958":"code","10345d12":"code","8c53d1a8":"code","c4d174a6":"code","2e8c6d6a":"code","3b78c593":"code","e8b100a4":"code","5512e70f":"code","ce02588a":"code","0437f559":"code","d7cdc81b":"code","a7ac4d34":"code","2ebaa64a":"code","62546e66":"code","d5ce606b":"code","4c8e3d61":"code","c454fed9":"code","3c10aa57":"markdown","06b1d707":"markdown","6af7df20":"markdown","b323fe4d":"markdown","2021c27b":"markdown","fc026421":"markdown","83d2af5b":"markdown","b435656a":"markdown","6a2ddee2":"markdown","3ac7c6b9":"markdown","af9d112a":"markdown","4579b28e":"markdown","cfaef52b":"markdown","797c705b":"markdown","a2af226b":"markdown","ffa9624e":"markdown","44d721cf":"markdown","e5d39470":"markdown","96c33a38":"markdown","61d34cc6":"markdown","b3da4e41":"markdown","999479ce":"markdown","8d633bdc":"markdown","9bce6eb3":"markdown","276f74c8":"markdown","c7b8b179":"markdown","171eaf49":"markdown","d9b20b82":"markdown","531280a9":"markdown","c1c50321":"markdown","fa2db1c0":"markdown","5a6d9088":"markdown","4fcef26e":"markdown","782b5214":"markdown","ee4ea755":"markdown","41978867":"markdown","bb9e1bf8":"markdown","457daa1e":"markdown","02006f22":"markdown","dc95aa3f":"markdown","402eb27d":"markdown","b28cf12f":"markdown","2e50a9a7":"markdown","5a4c1832":"markdown","60b67db8":"markdown","f2363aad":"markdown","6ddded1a":"markdown","1598552b":"markdown","2a582399":"markdown","92a7b900":"markdown","0fd71605":"markdown","6fb63c6f":"markdown","ae3fce70":"markdown","086f17ea":"markdown","27a8d2a5":"markdown","1c446234":"markdown","de8c9d36":"markdown","1bdea08c":"markdown","91bf6a45":"markdown","a130e8d9":"markdown"},"source":{"c0a5dbae":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nplt.style.use(\"fivethirtyeight\")","e21f3a29":"data = pd.read_csv(\"\/kaggle\/input\/stanford-open-policing-project\/police_project.csv\")","93970593":"data.head(5)","5579d95e":"# What do these numbers mean?\n\ndata.shape","edf7c1fc":"# What do these type means?\n\ndata.dtypes","8b44c179":"# What are these count?\n\ndata.isna().sum()","fdda8aff":"data.drop('county_name', axis = 1, inplace = True)","17325888":"# checking the new shape\n\ndata.shape","0c9c0e0f":"# Checking columns\n\ndata.columns","02a1c0b5":"# Alternative way to drop column that only contains missing values:\n\n# data.dropna(axis = 'columns', how = 'all', inplace = True)","8029598b":"data[data.violation == 'Speeding'].driver_gender.value_counts()","7c96d638":"# Alternative way to do the same:\n\ndata.loc[data.violation == 'Speeding', 'driver_gender'].value_counts()","3dd316be":"data.groupby('driver_gender').violation.count()","21e6a474":"# When a man is pulled over, how often is it for speeding?\n\ndata[data.driver_gender == 'M'].violation.value_counts()","99c952b4":"# Repeat for a women\n\ndata[data.driver_gender == 'F'].violation.value_counts()","ef346a9d":"# Combines the two lines above\n\ndata.groupby('driver_gender').violation.value_counts()","3117a115":"# My answer:\n\ndata.groupby('driver_gender').search_conducted.value_counts()","b12cc687":"# Ignore gender for the moment\n\ndata.search_conducted.value_counts(normalize = True)","76ebfdad":"# How does this work?\n\ndata.search_conducted.mean()","2e5b617e":"data.groupby('driver_gender').search_conducted.mean()","d58e15d8":"# Include a second factor\n\ndata.groupby(['violation', 'driver_gender']).search_conducted.mean()","62abe462":"data.isna().sum()","08d68d81":"# Maybe search_type is missing when search_counducted is False?\n\ndata.search_conducted.value_counts()","9bde8d98":"# Test that theory, why is the series empty?\n\ndata[data.search_conducted == False].search_type.value_counts()","6e54d63f":"# Value_counts ignores missing values by default\n\ndata[data.search_conducted == False].search_type.value_counts(dropna = False)","17dc6322":"# When search_conducted is True search_type is never missing.\n\ndata[data.search_conducted == True].search_type.value_counts()","1e3c8882":"# Alternative\n\ndata[data.search_conducted == True].search_type.isnull().sum()","34a42496":"# Multiple types are seperated by comas\n\ndata.search_type.value_counts(dropna = False)","de8a12ab":"data['frisk'] = data.search_type == 'Protective Frisk'","811c3012":"data.head()","74e397d5":"data.frisk.dtype","311710e1":"# Include exact matched only\n\ndata.frisk.sum()","3b98db5c":"# Is this the answer?\n\ndata.frisk.mean()","c62f0d99":"# Uses the wrong denominator (includes stops that didn't involve a search)\n\ndata.frisk.value_counts(dropna = False)","bc0c98c1":"161 \/ (91580 + 161)","9c6ccf45":"# Inclued partial matches\n\ndata['frisk'] = data.search_type.str.contains('Protective Frisk')","d9c1455b":"data.head()","1c20a99a":"# Seems about right\n\ndata.frisk.sum()","32927797":"data.frisk.mean()","ce8e95b1":"# str.contains preserved missing values from search_type\n\ndata.frisk.value_counts(dropna = False)","9f243bdf":"# excludes stops that didn't involve a search\n274 \/ (2922 + 274)","c238e24e":"data.head()","fbc0bba1":"data['stop_date'].isna().sum()","69d95cab":"data['stop_year'] = data['stop_date'].str.split('-', expand = True)[0]","1cdc57f1":"data['stop_year'].unique()","26bc68f5":"data.stop_year.value_counts()","74ba9bf3":"# This works, but there is a better way\n\ndata.stop_date.str.slice(0, 4).value_counts()","ff82ff95":"#\u00a0make sure you create this column\n\ncombined = data.stop_date.str.cat(data.stop_time, sep = ' ')\n# Concanate two string type columns with 'cat' method: stop_date, and stop_time\n\ndata['stop_datetime'] = pd.to_datetime(combined)\n# Converted string type dates into a data time","6f947e88":"data.dtypes","5d5d18b5":"data.stop_datetime.dt.year.value_counts()","d282bf0c":"data.drugs_related_stop.dtypes","989bc989":"# Baseline rate\n\ndata.drugs_related_stop.mean()","0dce2a84":"# Cannot groupby 'hour' unless you create it as a column\n\ndata.groupby(data.stop_datetime.dt.hour).drugs_related_stop.mean()","62cfc3f7":"# Line plot by default (by series)\n\ndata.groupby(data.stop_datetime.dt.hour).drugs_related_stop.mean().plot()","8260d1db":"# Alternative: count drug-related stops by hour\n\ndata.groupby(data.stop_datetime.dt.hour).drugs_related_stop.sum().plot()","e08b8b8d":"data.stop_datetime.dt.hour.value_counts()","4c073600":"data.stop_datetime.dt.hour.value_counts().plot();","8b704cea":"data.stop_datetime.dt.hour.value_counts().sort_index().plot();","3726efc4":"# Alternative method\n\ndata.groupby(data.stop_datetime.dt.hour).stop_date.count().plot();","8de6b8df":"# Mark bad data as missing\n\ndata.stop_duration.value_counts(dropna = False)","f4e5f0fd":"# What four things are wrong with this code?\n\n# data[(data.stop_duration == 1) | (data.stop_duration == 2)].stop_duration = 'NaN'","1f38e7cb":"# What two things are still wrong with this code?\n\ndata[(data.stop_duration == '1') | (data.stop_duration == '2')].stop_duration = 'NaN'","61cabc28":"# Assignment statement did not work\n\ndata.stop_duration.value_counts()","3753ed66":"data.loc[(data.stop_duration == '1') | (data.stop_duration == '2'), 'stop_duration'] = 'NaN'","ce49ead6":"# Confusing!\n\ndata.stop_duration.value_counts(dropna = False)","6c2ba7e6":"# Replace 'NaN' string with actual NaN value\n\nimport numpy as np\n\ndata.loc[data.stop_duration == 'NaN', 'stop_duration'] = np.nan","fe53c282":"data.stop_duration.value_counts(dropna = False)","b0442c20":"# Alternative method\n\n# data.stop_duration.replace(['1', '2'], value = np.nan, inplace = True)","7e6b56f8":"# Make sure you create this column\n\nmapping = {'0-15 Min': 8, '16-30 Min': 23, '30+ Min': 45}\n\ndata['stop_minutes'] = data.stop_duration.map(mapping)","9f77842c":"# Matches value_counts for stop_duration\n\ndata.stop_minutes.value_counts()","8e70d013":"data.groupby('violation_raw').stop_minutes.mean()","fccb04d0":"data.groupby('violation_raw').stop_minutes.agg(['count', 'mean'])","ea0adfea":"# What's wrong with this?\n\ndata.groupby('violation_raw').stop_minutes.mean().plot()\nplt.xticks(rotation = 90);","66dfa45c":"# How could this be made better?\n\ndata.groupby('violation_raw').stop_minutes.mean().plot(kind='bar');","20c5ba78":"data.groupby('violation_raw').stop_minutes.mean().sort_values().plot(kind='barh')","6ec96386":"data.groupby('violation').driver_age.describe()","57905958":"# Histograms are excellent for displaying distributions\n\ndata.driver_age.plot(kind='hist');","10345d12":"# Similar to a histogram\n\ndata.driver_age.value_counts().sort_index().plot();","8c53d1a8":"# Can't use the plot method\n\ndata.hist('driver_age', by = 'violation');","c4d174a6":"# What changed? how is this better or worse?\n\ndata.hist('driver_age', by='violation', sharex=True);","2e8c6d6a":"# What changed? how is this better or worse?\n\ndata.hist('driver_age', by='violation', sharex=True, sharey=True);","3b78c593":"data.head()","e8b100a4":"# Appears to be year of stop_date minus driver_age_raw\n\ndata.tail()","5512e70f":"data['new_age'] = data.stop_datetime.dt.year - data.driver_age_raw","ce02588a":"# Compare the distributions\n\ndata[['driver_age', 'new_age']].hist();","0437f559":"# Compare the summary statistics (focus on min and max)\n\ndata[['driver_age', 'new_age']].describe()","d7cdc81b":"# Calculate how many ages are outside that range\n\ndata[(data.new_age < 15) | (data.new_age > 99)].shape","a7ac4d34":"#\u00a0Raw data given to the researches\n\ndata.driver_age_raw.isnull().sum()","2ebaa64a":"# Age computed by the researches (has more missing values)\n\ndata.driver_age.isnull().sum()","62546e66":"# What does this tell us? Researchers set driver_age as missing if less than 15 or more than 99?\n\n5621-5327","d5ce606b":"# driver_age_raw not missing, driver_age missing\n\ndata[(data.driver_age_raw.notnull()) & (data.driver_age.isnull())].head()","4c8e3d61":"# Set the ages outside that range as missing\n\ndata.loc[(data.new_age < 15) | (data.new_age > 99), 'new_age'] = np.nan","c454fed9":"data.new_age.equals(data.driver_age)","3c10aa57":"Let's create a new column named 'stop_year', and w\/ str.split function, tell it to split our data where there is '-'. ","06b1d707":"### LESSON :\n* There is more than one way to understand a question.","6af7df20":"### LESSONS:\n* Use string methods to find partial matches.\n* Use the correct denominator when calculating rates.\n* Pandas calculations ignore missing values.\n* Apply the \"smell test\" to your results.","b323fe4d":"### Pandas\n\nIt offers powerful, expressive and flexible data structures that make data manipulation and analysis easy.\n\n> pandas aims to be the fundamental high-level building block for doing practical, real world data analysis in Python. Additionally, it has the broader goal of becoming the most powerful and flexible open source data analysis \/ manipulation tool available in any language.","2021c27b":"### Lessons:\n\n* Don't assume that the head and tail are representative of the data.\n* Columns with missing values may still have bad data (driver_age_raw).\n* Data cleaning sometimes involves guessing (driver_age).\n* Use histograms for a sanity check.","fc026421":"***shape*** : Return a tuple representing the dimensionality of the DataFrame.","83d2af5b":"***isnull is the same with isna.***","b435656a":"### LESSONS:\n* Convert strings to numbers for analysis.\n* Approximate when necessary.\n* Use count with mean to looking for meaningless mean.","6a2ddee2":"***read_csv*** : Read a comma-separated values (csv) file into DataFrame. Also supports optionally iterating or breaking of the file into chunks.","3ac7c6b9":"### Year 2005 had the least number of stops!","af9d112a":"### My Answer :","4579b28e":"# TASK 9: Find the bad data in the stop_duration column and fix it","cfaef52b":"* Men are more stopped by the police due to speeding than women.","797c705b":"The entries we want in the 'drugs_related_stop' column.","a2af226b":"# TASK 11: Plot the results of the first groupby from the previous exercise","ffa9624e":"### LESSONS:\n* Causation is difficult to conclude, so focus on relationship.\n* Include all relevnat factors when studying a relationship.","44d721cf":"### LESSONS : \n* Pay attention to default arguments.\n* Check your work.\n* There is more than one way to do everything in Pandas.","e5d39470":"# ABOUT DATA\n### Context\nOn a typical day in the United States, police officers make more than 50,000 traffic stops. Our team is gathering, analyzing, and releasing records from millions of traffic stops by law enforcement agencies across the country. Our goal is to help researchers, journalists, and policymakers investigate and improve interactions between police and the public.\n\n### Content\nThis dataset includes 9 Mb of stop data from Rhode Island, covering all of 2013 onwards. Please see the data readme for the full details of the available fields.\n\n### Acknowledgements\nThis dataset was kindly made available by the Stanford Open Policing Project. If you use it for a research publication, please cite their working paper: E. Pierson, C. Simoiu, J. Overgoor, S. Corbett-Davies, V. Ramachandran, C. Phillips, S. Goel. (2017) \u201cA large-scale analysis of racial disparities in police stops across the United States\u201d.\n\n### Inspiration\n* Do men or women speed more often?\n* Does gender affect who gets searched during a stop?\n* During a search, how often is the driver frisked?\n* Which year had the least number of stops?\n* How does drug activity change by time of day?\n* Do most stops occur at night?","96c33a38":"***sum*** : Return the sum of the values for the requested axis.","61d34cc6":"# OPEN POLICING DATASET EDA FOLLOWING KEV\u0130N MARKHAM'S PYCON PRESENTATION","b3da4e41":"### LESSONS:\n* Consider removing chunks of data that may be biased.\n* Use the datetime data type for dates, and times.","999479ce":"# TASK 4: Why is search_type missing often?","8d633bdc":"***cat*** : Concatenate strings in the Series\/Index with given separator.\n\n***to_datetime*** : Convert argument to datetime.","9bce6eb3":"Reading data:","276f74c8":"***With the code below, Here, we limit our data to data with vialotion entries equals to speeding and count them according to their gender.***","c7b8b179":"***mean*** : Return the mean of the values for the requested axis.","171eaf49":"# TASK 10: What is the mean stop_duration for each violation_raw?","d9b20b82":"***isna*** : Return a boolean same-sized object indicating if the values are NA. NA values, such as None or numpy.NaN, gets mapped to True values. Everything else gets mapped to False values. Characters such as empty strings '' or numpy.inf are not considered NA values (unless you set pandas.options.mode.use_inf_as_na = True).","531280a9":"# TASK 6: Which year had the least number of stops?","c1c50321":"***drop*** : Remove rows or columns by specifying label names and corresponding axis, or by specifying directly index or column names. *axis=1 means, ***columns*** should drop.* With setting inplace=True, we make this change permanent.","fa2db1c0":"***dtypes*** : This returns a Series with the data type of each column. The result\u2019s index is the original DataFrame\u2019s columns. Columns with mixed types are stored with the object dtype.","5a6d9088":"### LESSONS:\n* Be conscious of sorting when plotting.\n* Use plots to help you understand trends.\n* Create exploratory plot using Pandas one-liners.","4fcef26e":"***groupby*** : A groupby operation involves some combination of splitting the object, applying a function, and combining the results. This can be used to group large amounts of data and compute operations on these groups.","782b5214":"    GitHub repository: https:\/\/github.com\/justmarkham\/pycon-2018-tutorial\n    Instructor: Kevin Markham\n    GitHub: https:\/\/github.com\/justmarkham\n    Twitter: https:\/\/twitter.com\/justmarkham\n    YouTube: https:\/\/www.youtube.com\/dataschool\n    Website: http:\/\/www.dataschool.io","ee4ea755":"### Matplotlib\n\n> Matplotlib is a comprehensive library for creating static, animated, and interactive visualizations in Python.","41978867":"**Data contains 91741 rows, and county_name has 91741 null values.**","bb9e1bf8":"***head*** : Return the first n rows. (By default return first 5 rows.)","457daa1e":"### LESSONS:\n* Verify your assumptions about your data.\n* Pandas functions ignores missing values by default.","02006f22":"* What does NaN mean?\n#### In computing, NaN, standing for Not a Number, is a member of a numeric data type that can be interpreted as a value that is undefined or unrepresentable, especially in floating-point arithmetic. (Wikipedia)\n\n* Why might a values missing?\n#### In statistics, missing data, or missing values, occur when no data value is stored for the variable in an observation. Missing data are a common occurrence and can have a significant effect on the conclusions that can be drawn from the data. (Wikipedia)\n\n* Why mark it as NaN? Why not mark it as a 0 or an empty string or a string saying \"Unknown\"?\n#### We should be able to distinguish the missing value than real data. If missing value marked as 'Unknown', string type, and our column has values including 'Unknown', how would be distinguish the data? That's why we marked missing values as NaN.","dc95aa3f":"***slice(start, stop)*** : Slice substrings from each element in the Series or Index.","402eb27d":"**This notebook includes my, and the real answers for Kevin Markham's Pycon presentation. It also includes my own additions related to the data set. It is intended to be purely instructive.**","b28cf12f":"# STEP 7: How does drug activity change by time of day?","2e50a9a7":"# TASK 2 : Do men or women speed more often?","5a4c1832":"### LESSONS:\n* Ambiguous data should be marked as missing.\n* Don't ignore the SettingWithCopyWarning.\n* NaN is not a string.","60b67db8":"Importing necessary libraries:","f2363aad":"### Lessons:\n\n* Use histograms to show distributions.\n* Be conscious of axes when using grouped plots.","6ddded1a":"# TASK 3 : Does a gender affect who gets searched during a stop?","1598552b":"###\u00a0Answer from Pycon:","2a582399":"### LESSONS:\n* Don't use line plot to compare categories.\n* Be conscious of sorting, and orientation when plotting.","92a7b900":"***str*** : Vectorized string functions for Series and Index.\n\n***split*** : Split strings around given separator\/delimiter.\n\n***contains*** : Test if pattern or regex is contained within a string of a Series or Index.","0fd71605":"* Men are more often stopped by the police than women.","6fb63c6f":"### Seaborn\n\n> Seaborn is a Python data visualization library based on matplotlib. It provides a high-level interface for drawing attractive and informative statistical graphics.","ae3fce70":"# Task 1: Remove the column that only contains missing values","086f17ea":"* Does this prove causation?\n#### Yes, looks like we can say that.","27a8d2a5":"What does each row represent?","1c446234":"# TASK 5: During a search, how often driver frisked?","de8c9d36":"### LESSONS:\n* Be conscious of sorting when plotting.","1bdea08c":"# TASK 12: Compare the age distribution for each violation","91bf6a45":"# TASK 13: Pretend you don't have the driver_age column, and create it from driver_age_raw (and call it new_age)","a130e8d9":"# TASK 8: Do most stops occur at night?"}}