{"cell_type":{"d667d294":"code","9c795ef5":"code","85c2e0b8":"code","f3068bdf":"code","75ae135a":"code","1f80b9ed":"code","9d624b55":"code","ede99730":"code","547300ab":"code","8a28fd1e":"code","5df11386":"code","ada16376":"code","e509b8e9":"code","cd5a6ec5":"code","b4869259":"code","2117ae28":"code","35227c13":"code","30130292":"code","5f5caf8d":"code","483ff15e":"code","08843055":"code","73fa8ae9":"code","8ec250c4":"code","eddbb768":"code","7a2e702b":"code","f15e2127":"code","b0f93253":"code","0d32e432":"code","2cc9bd0d":"code","904ab257":"code","7d8a5084":"code","fe52b46f":"code","fb01e30e":"code","06f41b45":"code","e85ae8b8":"code","11818141":"code","bb47340e":"code","11ca550d":"code","8ffd2ba0":"code","f422e1f9":"code","859bf86a":"code","b3bdf1bc":"code","a8709b23":"code","c1d496f3":"code","f49577e3":"code","741cf5f5":"code","108e2ce3":"code","b4597127":"code","c15e2342":"code","c3789dc7":"code","66ea09ba":"code","500d106c":"code","2e14ba28":"code","f2da759b":"code","e128e179":"code","fa657da1":"code","d85e29e0":"code","366b18e2":"code","5b77cf1c":"code","2a7a77a1":"code","95060582":"code","3c09999f":"code","2f20a008":"code","498f0463":"code","ac64e26a":"code","d93a979b":"code","416c591c":"code","3b236e47":"code","c6f18c17":"code","8fc78992":"code","9d8d8de9":"code","23968013":"code","75e7e3cc":"code","bef5789c":"code","ec5123e3":"code","6a670550":"code","9b9cc0da":"code","7307814a":"code","7e60fd93":"code","f488ecee":"code","77199c56":"code","5c0c9677":"code","9fc47238":"code","f8e7ad9a":"code","9bf082cd":"code","f696ca63":"markdown","e99a39e6":"markdown","9ed06973":"markdown","57c40ec4":"markdown","cb71ac54":"markdown","de11f307":"markdown","7346ebef":"markdown","db7685e3":"markdown","acecd195":"markdown","a6bb2731":"markdown","534cad9c":"markdown","5f0d5774":"markdown","48f31acb":"markdown","d68abfb3":"markdown","25debd43":"markdown","40c34896":"markdown","93a8e91b":"markdown","fe07f2fa":"markdown","85529d67":"markdown","b6dbee73":"markdown","a0a7eeb9":"markdown","b974c957":"markdown","ebfe3361":"markdown","bbfde604":"markdown","fb12ea87":"markdown","999e7b9f":"markdown","e9356334":"markdown","3b093343":"markdown","33445862":"markdown","6ae9218f":"markdown","31bcb843":"markdown","c518a6a2":"markdown","c019676e":"markdown","747e1876":"markdown","2307c997":"markdown"},"source":{"d667d294":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","9c795ef5":"os.listdir()","85c2e0b8":"import os\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom wordcloud import WordCloud, STOPWORDS, ImageColorGenerator\nimport cv2\nimport imagehash\nfrom fuzzywuzzy import fuzz","f3068bdf":"def make_wordcloud(df):\n    lst=list(df['title'])\n    wordcloud_text=[]\n    for ele in lst:\n        wordcloud_text.extend(ele.split())\n    wordcloud_text=' '.join(wordcloud_text)\n    wordcloud = WordCloud().generate(wordcloud_text)\n\n    # Display the generated image:\n    plt.imshow(wordcloud, interpolation='bilinear')\n    plt.axis(\"off\")\n    plt.show()\n    \n    \n\ndef hamming_distance(val1,val2):\n    res=0\n    for v1,v2 in zip(val1,val2):\n        if v1!=v2:\n            res=res+1\n    return res\n\n        \ndef image_matrix(hash_values):\n \n    phashs = hash_values.apply(lambda x: imagehash.hex_to_hash(x))\n    \n    hash_matrix = pd.DataFrame()\n\n    for idx, i in enumerate(hash_values):\n      \n        hash_matrix = pd.concat([hash_matrix, phashs - imagehash.hex_to_hash(i)], \n                                 axis = 1)\n        \n\n    hash_matrix.columns = range(len(hash_values))\n    return hash_matrix\n\n\ndef fuzz_calculation(idx,df):\n    val=[]\n    for i,ele in enumerate(df['title']):\n        temp=fuzz.ratio(str.lower(df['title'][idx]),str.lower(ele))\n        val.append((temp,i))\n    return val\n\ndef fuzz_calculation_with_sep(idx,df):\n    val=[]\n    '''As some of out titles have multiple titles separated by \/ we will split the title on this \n    value if \/ is present and calculate fuzz_ratio for each of them'''\n    \n    vals=df['title'][idx].split('\/')\n    \n    for i,ele in enumerate(df['title']):\n        temp1=ele.split('\/')\n        max_val=0\n        \n        for sent1 in vals:\n            for sent2 in temp1:\n                temp=fuzz.ratio(str.lower(sent1),str.lower(sent2))\n                if temp>max_val:\n                    max_val=temp\n            \n        val.append((max_val,i))\n\n    return val","75ae135a":"train_df=pd.read_csv(r'\/kaggle\/input\/shopee-product-matching\/train.csv')","1f80b9ed":"train_df.shape","9d624b55":"train_df.head()","ede99730":"train_df.info()","547300ab":"test_df=pd.read_csv(r'\/kaggle\/input\/shopee-product-matching\/test.csv')","8a28fd1e":"test_df.shape","5df11386":"test_df.head()","ada16376":"test_df.info()","e509b8e9":"label_group_df=train_df[['posting_id','label_group']].groupby(['label_group']).count().reset_index()\nlabel_group_df.columns=['label_group','count']\nlabel_group_df=label_group_df.sort_values(by=['count'],ascending=False)\nlabel_group_df","cd5a6ec5":"#analyzing duplicate label_group\nvar=train_df[train_df[\"label_group\"].duplicated() == True].shape[0]\nprint('Number of duplicated label_groups: ',var)\n","b4869259":"var=train_df[train_df[\"posting_id\"].duplicated() == True].shape[0]\nprint('Number of duplicated posting_id: ',var)","2117ae28":"print('Number of unique label groups: ',label_group_df.shape[0])","35227c13":"sns.barplot(x=label_group_df['label_group'][:50],y=label_group_df['count'][:50])\nplt.title('Number of pictures in same label for first 50 label_groups')","30130292":"sns.barplot(x=label_group_df['label_group'][-50:],y=label_group_df['count'][-50:])\nplt.title('Number of pictures in same label for last 50 label_groups')","5f5caf8d":"train_df['title_length']=[len(train_df['title'][i].split()) for i in range(train_df.shape[0])]\n","483ff15e":"train_df.sort_values(by='title_length',ascending=False).head()","08843055":"train_df.sort_values(by='title_length',ascending=False).tail()","73fa8ae9":"#selecting a label_group at random and seeing the titles for that group\nsample_df=train_df[train_df['label_group']==1163569239]","8ec250c4":"sample_df.head()","eddbb768":"print('Wordcloud for images from group_label: 1163569239')\nprint('Total number of images for this group_label are: ',\n      label_group_df[label_group_df['label_group']==1163569239]['count'])\nmake_wordcloud(sample_df)","7a2e702b":"sns.barplot(x=sample_df['posting_id'],y=sample_df['title_length'])","f15e2127":"\nsample_df.value_counts(['image_phash']).plot(kind='bar')","b0f93253":"#selecting a label_group at random and seeing the titles for that group\nsample_df2=train_df[train_df['label_group']==2126962532]\nprint('Wordcloud for images from group_label: 2126962532')\nprint('Total number of images for this group_label are: ',label_group_df[label_group_df['label_group']==2126962532]['count'])\nmake_wordcloud(sample_df2)","0d32e432":"sns.barplot(x=sample_df2['posting_id'],y=sample_df2['title_length'])","2cc9bd0d":"sample_df2.value_counts(['image_phash']).plot(kind='bar')","904ab257":"#selecting a label_group at random and seeing the titles for that group\nsample_df3=train_df[train_df['label_group']==2357508171]\nprint('Wordcloud for images from group_label: 2357508171')\nprint('Total number of images for this group_label are: ',\n      label_group_df[label_group_df['label_group']==2357508171]['count'])\nmake_wordcloud(sample_df3)","7d8a5084":"sns.barplot(x=sample_df3['posting_id'],y=sample_df3['title_length'])","fe52b46f":"sample_df3.value_counts(['image_phash']).plot(kind='bar')","fb01e30e":"#selecting a label_group at random and seeing the titles for that group\nsample_df4=train_df[train_df['label_group']==3627744656]\nprint('Wordcloud for images from group_label: 3627744656')\nprint('Total number of images for this group_label are: ',label_group_df[label_group_df['label_group']==3627744656]['count'])\nmake_wordcloud(sample_df4)","06f41b45":"sns.barplot(x=sample_df4['posting_id'],y=sample_df4['title_length'])","e85ae8b8":"sample_df4.value_counts(['image_phash']).plot(kind='bar')","11818141":"train_df.head()","bb47340e":"hash_df=train_df[['image_phash','posting_id']].groupby(['image_phash']).count().reset_index()\nhash_df.columns=['image_phash','count']\nhash_df.sort_values(by='count',ascending=False)","11ca550d":"hash_df.sort_values(by='count',ascending=False)[10:20]","8ffd2ba0":"hash_df_sample=train_df[train_df['image_phash']=='fad28daa2ad05595'].groupby(['label_group']).count()\nhash_df_sample","f422e1f9":"hash_df_sample=train_df[train_df['image_phash']=='d0c0ea37bd9acce0'].groupby(['label_group']).count()\nhash_df_sample","859bf86a":"hash_df_sample=train_df[train_df['image_phash']=='f6d98134b904b56b'].groupby(['label_group']).count()\nhash_df_sample","b3bdf1bc":"hash_df_sample=train_df[train_df['image_phash']=='be12e12f9ec1e198'].groupby(['label_group']).count()\nhash_df_sample","a8709b23":"hash_df_sample=train_df[train_df['image_phash']=='ada4c4781f93686e'].groupby(['label_group']).count()\nhash_df_sample","c1d496f3":"hash_df_sample=train_df[train_df['image_phash']=='ad29e81e92b295b5'].groupby(['label_group']).count()\nhash_df_sample","f49577e3":"#plt.figure(figsize=(30,30))\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+train_df['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","741cf5f5":"#plt.figure(figsize=(30,30))\nsample_df=sample_df.reset_index()\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+sample_df['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","108e2ce3":"#plt.figure(figsize=(30,30))\nsample_df2=sample_df2.reset_index()\nfor i in range(8):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+sample_df2['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","b4597127":"#plt.figure(figsize=(30,30))\nsample_df3=sample_df3.reset_index()\nfor i in range(2):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+sample_df3['image'][i])\n    plt.subplot(1,2,i+1)\n    plt.imshow(img)","c15e2342":"hash_df_sample1=train_df[train_df['image_phash']=='ada4c4781f93686e'].reset_index()\n#plt.figure(figsize=(30,30))\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+hash_df_sample1['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","c3789dc7":"hash_df_sample2=train_df[train_df['image_phash']=='f6d98134b904b56b'].reset_index()\n#plt.figure(figsize=(30,30))\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+hash_df_sample2['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","66ea09ba":"hash_matrix_1_1000 = image_matrix(train_df['image_phash'][:1000])\nhash_matrix_1_1000.head()","500d106c":"simialrity_dic={}\nfor i in range(len(hash_matrix_1_1000)):\n    var=[(hash_matrix_1_1000[i][j],j) for j in range(len(hash_matrix_1_1000[i]))]\n    var=sorted(var)\n    simialrity_dic[i]=[var[k][1] for k in range(50)]","2e14ba28":"similar_pdts_0=train_df['image'][simialrity_dic[0][:12]].reset_index()\nplt.figure(figsize=(10,10))\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+similar_pdts_0['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","f2da759b":"similar_pdts_1=train_df['image'][simialrity_dic[1][:12]].reset_index()\nplt.figure(figsize=(10,10))\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+similar_pdts_1['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","e128e179":"similar_pdts_11=train_df['image'][simialrity_dic[11][:12]].reset_index()\nplt.figure(figsize=(10,10))\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+similar_pdts_11['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","fa657da1":"hash_dic = {}\nvar=[]\nval=imagehash.hex_to_hash(train_df['image_phash'][0])\nfor idx,ele in enumerate(train_df['image_phash']):\n    temp=imagehash.hex_to_hash(ele)\n    var.append((val-temp,idx))\nhash_dic[0]=var","d85e29e0":"val=sorted(hash_dic[0])\nval=[val[i][1] for i in range(len(val))]\n\nsimilar_pdts_0_all=train_df['image'][val[:12]].reset_index()\nplt.figure(figsize=(10,10))\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+similar_pdts_0_all['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","366b18e2":"print('Label_group of image_0 is: ',train_df['label_group'][0])\nfor ele in val[:50]:\n    print(ele,train_df['label_group'][ele],train_df['label_group'][ele]==train_df['label_group'][0])","5b77cf1c":"hash_dic = {}\nvar=[]\nval=imagehash.hex_to_hash(train_df['image_phash'][2937])\nfor idx,ele in enumerate(train_df['image_phash']):\n    temp=imagehash.hex_to_hash(ele)\n    var.append((val-temp,idx))\nhash_dic[2937]=var","2a7a77a1":"val=sorted(hash_dic[2937])\nval=[val[i][1] for i in range(len(val))]\n\nsimilar_pdts_2937_all=train_df['image'][val[:12]].reset_index()\nplt.figure(figsize=(10,10))\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+similar_pdts_2937_all['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","95060582":"print('Label_group of image_0 is: ',train_df['label_group'][2937])\nfor ele in val[:50]:\n    print(ele,train_df['label_group'][ele],train_df['label_group'][ele]==train_df['label_group'][2937])","3c09999f":"labelgroup_sample_0=train_df[train_df['label_group']==train_df['label_group'][0]].reset_index()\nlabelgroup_sample_0","2f20a008":"hamming_dic = {}\nvar=[]\nfor idx,ele in enumerate(train_df['image_phash']):\n    var.append((hamming_distance(train_df['image_phash'][0],ele),idx))\nhamming_dic[0]=var","498f0463":"temp=sorted(hamming_dic[0])\nprint(temp[:200])","ac64e26a":"val=sorted(hamming_dic[0])\nval=[val[i][1] for i in range(len(val))]\n\nsimilar_pdts_0_all=train_df['image'][val[:12]].reset_index()\nplt.figure(figsize=(10,10))\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+similar_pdts_0_all['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","d93a979b":"print('Label_group of image_0 is: ',train_df['label_group'][0])\nfor ele in val[:50]:\n    print(ele,train_df['label_group'][ele],train_df['label_group'][ele]==train_df['label_group'][0])","416c591c":"var=[]\nfor idx,ele in enumerate(train_df['image_phash']):\n    var.append((hamming_distance(train_df['image_phash'][2937],ele),idx))\nhamming_dic[2937]=var","3b236e47":"val=sorted(hamming_dic[2937])\nval=[val[i][1] for i in range(len(val))]\n\nsimilar_pdts_2937_all=train_df['image'][val[:12]].reset_index()\nplt.figure(figsize=(10,10))\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+similar_pdts_2937_all['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","c6f18c17":"plt.figure(figsize=(10,10))\nfor i in range(2):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+labelgroup_sample_0['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","8fc78992":"fuzz.ratio(str.lower(train_df['title'][0]),str.lower(train_df['title'][33161]))","9d8d8de9":"fuzz_dic={}\nfuzz_dic[0]=fuzz_calculation(0,train_df)\nfuzz_dic[10]=fuzz_calculation(10,train_df)\nfuzz_dic[30]=fuzz_calculation(30,train_df)\nfuzz_dic[2937]=fuzz_calculation(2937,train_df)","23968013":"val_0=sorted(fuzz_dic[0],reverse=True)\nval_0=[val_0[i][1] for i in range(len(val_0))]\n\nsimilar_pdts_0_all=train_df['image'][val_0[:12]].reset_index()\nplt.figure(figsize=(10,10))\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+\n                   similar_pdts_0_all['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","75e7e3cc":"print('Label_group of image_0 is: ',train_df['label_group'][0])\nfor ele in val_0[:12]:\n    print(ele,train_df['label_group'][ele],train_df['label_group'][ele]==train_df['label_group'][0])","bef5789c":"val_10=sorted(fuzz_dic[10],reverse=True)\nval_10=[val_10[i][1] for i in range(len(val_10))]\n\nsimilar_pdts_10_all=train_df['image'][val_10[:12]].reset_index()\nplt.figure(figsize=(10,10))\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+\n                   similar_pdts_10_all['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","ec5123e3":"print('Label_group of image_0 is: ',train_df['label_group'][10])\nfor ele in val_10[:12]:\n    print(ele,train_df['label_group'][ele],train_df['label_group'][ele]==train_df['label_group'][10])","6a670550":"train_df[train_df['label_group']==train_df['label_group'][10]]","9b9cc0da":"val_30=sorted(fuzz_dic[30],reverse=True)\nval_30=[val_30[i][1] for i in range(len(val_30))]\n\nsimilar_pdts_30_all=train_df['image'][val_30[:12]].reset_index()\nplt.figure(figsize=(10,10))\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+\n                   similar_pdts_30_all['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","7307814a":"print('Label_group of image_30 is: ',train_df['label_group'][30])\nfor ele in val_30[:12]:\n    print(ele,train_df['label_group'][ele],train_df['label_group'][ele]==train_df['label_group'][30])","7e60fd93":"train_df[train_df['label_group']==train_df['label_group'][30]]","f488ecee":"fuzz_dic[30]=fuzz_calculation_with_sep(30,train_df)","77199c56":"val_30=sorted(fuzz_dic[30],reverse=True)\nval_30=[val_30[i][1] for i in range(len(val_30))]\n\nsimilar_pdts_30_all=train_df['image'][val_30[:12]].reset_index()\nplt.figure(figsize=(10,10))\nfor i in range(12):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+\n                   similar_pdts_30_all['image'][i])\n    plt.subplot(3,4,i+1)\n    plt.imshow(img)","5c0c9677":"print('Label_group of image_30 is: ',train_df['label_group'][30])\nfor ele in val_30[:12]:\n    print(ele,train_df['label_group'][ele],train_df['label_group'][ele]==train_df['label_group'][30])","9fc47238":"val_2937=sorted(fuzz_dic[2937],reverse=True)\nval_2937=[val_2937[i][1] for i in range(len(val_2937))]\n\nsimilar_pdts_2937_all=train_df['image'][val_2937[:20]].reset_index()\nplt.figure(figsize=(10,10))\nfor i in range(20):\n    img=cv2.imread(r'\/kaggle\/input\/shopee-product-matching\/train_images\/'+similar_pdts_2937_all['image'][i])\n    plt.subplot(4,5,i+1)\n    plt.imshow(img)","f8e7ad9a":"print('Label_group of image_2937 is: ',train_df['label_group'][2937])\nfor ele in val_2937[:20]:\n    print(ele,train_df['label_group'][ele],train_df['label_group'][ele]==train_df['label_group'][2937])","9bf082cd":"train_df[train_df['label_group']==train_df['label_group'][2937]]","f696ca63":"# Exploring Title\nNow, we have given the titles of each image as well. We will explore this area and find out how similar these tiles are for similar products\/images.","e99a39e6":"# Importing Necessary libraries","9ed06973":"# Analyzing Test Data","57c40ec4":"**Let us try making wordcloud for more group_labels**","cb71ac54":"# Observation:\n1. From the above information we can see that for any label_group the maximum number of products belonging to the similar label_group are 51\n2. There are 23236 duplicate label groups in our train dataset as many products share the same label_group.\n","de11f307":"For better observation let us try plotting images that belong to the same label_group","7346ebef":"# Observation:\n1. Title is an important feature. We should not ignore words in the title. The higher the fuzz ratio the more similar the images are turning out to be.","db7685e3":"# For Index 10:","acecd195":"# For Index 2937","a6bb2731":"***We now see the length of every title***","534cad9c":"# Plotting Similar Products Based on Above Observation","5f0d5774":"# Analyzing How Good Hamming Distance is Performing\n","48f31acb":"# Hash_Value Check:\nWe have checked that images belonging to the same label_group might have different hash_values. Let us check if the images with same hash_value has differet label_groups or not.","d68abfb3":"# Observation:\n1. We get good results but only in the case when there are images with same hash_value. Hence, one could rely on this technique till some extent. This also clearly shows that hash_value is an important parameter to consider here.\n2. We see that for none of the top 50 similar images based on hash_difference is bringing the image of the same label. We will repeat these steps with Hamming distance and see if we find something","25debd43":"# Exploring Train DataFrame\n\nSimilar images belong to the same label_group. Hence, let us first begin analyzing this column","40c34896":"# Observations:\n1. Products belonging to different label_groups have quite different words. Hence, it can be concluded that title plays a major role in this problem.\n2. Also, for products belonging to same label_group there are few words appearing more frequently this once again supports the above statement.\n3. There is no relation between number of words in title for images that belong to the same label_group.\n4. The hash_value is widely scattered for images in the same label_group.","93a8e91b":"# Helper Functions","fe07f2fa":"# Plotting Some Images:\n","85529d67":"# Exploring Train Data","b6dbee73":"# Phash Analysis\nBased on the phash_value we will first calculate the has","a0a7eeb9":"# Observation:\nWe have 34,250 train images. In our dataframe we have the image title as text feature.We also have image_phash and label_group as other features. Similar posting_id is what we need to predict for each image. ","b974c957":"# Observation:\n1. There are cases in which the same hash_value images belong to different groups. But it can be said that the majority belong to the same label_group only.\n\n2. We are given perceptual hashing value, hence for calculating the similarity between two images we will consider hamming distance.","ebfe3361":"# For Index 2937 ","bbfde604":"# For Index 30:","fb12ea87":"# For Index 0:","999e7b9f":"# Observation:\n1. The  most similar image for the image at index_0 has same group label for the image with index_33161. But the hamming distance between these two is 14. This is quite a big value and because of which image at index_33161 do not come even in the top 200 similar images with image at index_0 based on hamming distance value. Hence, this further gives us the idea that we just cannot rely on the hamming distance value only.","e9356334":"# Further Steps:\n1. We are looking for similar product images. So, here to begin with what we can do is for every product take the 50 most similar product based on the value calculated here.","3b093343":"# Let us now check for these 50 images, how many of them have same label_group","33445862":"# Observation:\n1. Hash_value of each image is an important feature for any given image and it helps in grouping similar images together.\n2. For perceptual hashing hamming distance is the main measure of calculating the similarity between two given images.\n3. The shorter (smaller value) the value of hamming distance the more similar are the images.","6ae9218f":"# Observation:\nBased on these the results are not very promising. This might also be because we are only taking a sample of images. Let us try with first 10 images taking their matching hash_value with all the images in the dataset.","31bcb843":"# Images with Similar Hash Value\nNow we will see few image plots where the image had the same hash_value","c518a6a2":"**For a clearer idea let us draw a wordcloud on the titles for this label group and see if we find something**","c019676e":"# Analyzing Similarity Based on Titles:\nWe have considered the hamming distance and hash difference. Let us now see how good it performs for titles.","747e1876":"# For Index 2937\n","2307c997":"# Observaion:\nWe see that maximum number of words in any title is 61(not a very large number) and minimum is 1."}}