{"cell_type":{"3bffee07":"code","b0c1aafa":"code","433a1322":"code","2ac89f7e":"code","ab504eb9":"code","2a3b3b5e":"code","d9134491":"markdown","fdca6322":"markdown"},"source":{"3bffee07":"import pandas as pd\nimport numpy as np","b0c1aafa":"train = pd.read_csv('..\/input\/30-days-of-ml\/train.csv')\nsubmission = pd.read_csv('..\/input\/30-days-of-ml\/sample_submission.csv')","433a1322":"validation = pd.read_csv('..\/input\/a-way-of-finding-optimum-blending-weight\/validation.csv')\nprediction = pd.read_csv('..\/input\/a-way-of-finding-optimum-blending-weight\/prediction.csv')","2ac89f7e":"train = pd.concat([train, validation], axis=1)\ntest = prediction","ab504eb9":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import KFold\nfrom sklearn.metrics import mean_squared_error\nimport math\n\nN_FOLDS = 5\n\nval_pred = train['target'].copy()\nval_pred.iloc[:] = 0\n\npred = submission['target'].copy()\npred.iloc[:] = 0\n\nFEATS = ['cb','xgb','lgbm']\n\nfor fold, (train_idx, valid_idx) in enumerate(KFold(n_splits=N_FOLDS, random_state=42, shuffle=True).split(train)):\n    X_train = train.loc[train_idx, FEATS]\n    X_valid = train.loc[valid_idx, FEATS]\n    y_train = train.loc[train_idx, ['target']]\n    y_valid = train.loc[valid_idx, ['target']]\n\n    lr = LinearRegression()\n    lr.fit(X_train, y_train)\n    val_pred.loc[valid_idx] += lr.predict(X_valid)[:,0]\n\n    pred += lr.predict(test.loc[:,FEATS])[:,0]\n    \npred \/= N_FOLDS\n    \nrmse = math.sqrt(mean_squared_error(train['target'], val_pred))\nprint(rmse)","2a3b3b5e":"submission['target'] = pred\nsubmission.to_csv('submission.csv', index=False)","d9134491":"## What is Stacking?\n\nStacking is another way to perform ensemble.\n\nStacking is a method of building another model using the prediction results of multiple models that have already been built as training data.\n\nIt's not that complicated if you take a look at the code below.","fdca6322":"## Stacking\n\nWe can choose any models for building a stacking model. \n\nIn this notebook, I chose [LinearRegression](https:\/\/scikit-learn.org\/stable\/modules\/generated\/sklearn.linear_model.LinearRegression.html) for the stacking model. \n\nLinearRegression is one of the simplest model that we can try. "}}