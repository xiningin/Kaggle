{"cell_type":{"caeee9d7":"code","7ad56fe1":"code","46a71966":"code","a029bd70":"code","a47de0b1":"code","4d863c04":"code","c6db0025":"code","9cf8b1cc":"code","116b07aa":"code","f5114d82":"code","e2e2ae44":"code","31782867":"code","f5379742":"code","2c46fdbc":"code","7b5ca0ec":"code","7c4bf324":"code","ff003286":"code","a9bd590a":"code","88f37baf":"code","079d6753":"code","f18c9183":"code","79415c26":"code","750a5c46":"code","9a285242":"code","0dd56687":"code","4506c99f":"code","c1969e92":"code","7c22d728":"code","23b0c2a0":"code","500e09fb":"markdown","57ad9167":"markdown","f3431d1c":"markdown","e05932d1":"markdown","e55a009e":"markdown","98b42eba":"markdown","28648f0a":"markdown","e841b31d":"markdown","694faa96":"markdown","50f17e0c":"markdown","c337b8d3":"markdown","9e0ef2cb":"markdown","3a31725b":"markdown","ac1d93c6":"markdown","5d3cad4a":"markdown","f9add638":"markdown","9a521785":"markdown","ece31fbe":"markdown","e4f70487":"markdown","d2022407":"markdown","468c336b":"markdown","dd894893":"markdown","1857136e":"markdown","7f14f4b0":"markdown","c608e631":"markdown"},"source":{"caeee9d7":"# processamento de dados, algebra linear\nimport numpy as np \nimport pandas as pd\n\n# visualiza\u00e7\u00e3o de dados\nimport seaborn as sns\nimport matplotlib.pyplot as plt","7ad56fe1":"# impime os arquivos\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","46a71966":"df = pd.read_csv('\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\ndf.sample(3)","a029bd70":"df.info()","a47de0b1":"df.describe()","4d863c04":"sns.scatterplot(data=df, x=\"Annual Income (k$)\", y=\"Spending Score (1-100)\")\nplt.show()","c6db0025":"sns.scatterplot(data=df, x=\"Annual Income (k$)\", y=\"Spending Score (1-100)\", hue=\"Gender\", style=\"Gender\")\nplt.show()","9cf8b1cc":"sns.scatterplot(data=df, x=\"Annual Income (k$)\", y=\"Spending Score (1-100)\", hue=\"Age\", palette='crest')\nplt.show()","116b07aa":"# removendo as colunas id, g\u00eanero e idade\nX = df.drop(['CustomerID', 'Gender', 'Age'], axis = 1)\nX.sample(3)","f5114d82":"# normalizando os valores por coluna\nfrom sklearn import preprocessing\n\nmin_max_scaler = preprocessing.MinMaxScaler()\nX = min_max_scaler.fit_transform(X)","e2e2ae44":"# aprendizado de m\u00e1quina\nfrom sklearn.cluster import KMeans","31782867":"model = KMeans(n_clusters = 5)\nmodel.fit(X)\ndf['Group'] = model.predict(X)\ndf.sample(3)","f5379742":"sns.scatterplot(data=df, x=\"Annual Income (k$)\", y=\"Spending Score (1-100)\", hue='Group', style='Group', palette='tab10')\nplt.show()","2c46fdbc":"val = df.drop(['CustomerID', 'Gender', 'Age'], axis = 1).groupby('Group').describe()","7b5ca0ec":"# removendo alguns atributos\nannual_income  = val['Annual Income (k$)'].drop(['std','min','25%','50%','75%','max'], axis = 1)\nspending_score = val['Spending Score (1-100)'].drop(['count','std','25%','50%','75%'], axis = 1)\nval = annual_income.merge(spending_score, left_on='Group', right_on='Group')\nval.columns = ['Count', 'Income Mean', 'Score Mean', 'Score Min', 'Score Max']","7c4bf324":"val","ff003286":"# importa a m\u00e9trica\nfrom sklearn.metrics import silhouette_score","a9bd590a":"silhouette_score(X, df['Group'])","88f37baf":"from sklearn.cluster import DBSCAN","079d6753":"df['Group'] = DBSCAN(eps=0.1, min_samples=3).fit(X).labels_\ndf.sample(3)","f18c9183":"sns.scatterplot(data=df, x=\"Annual Income (k$)\", y=\"Spending Score (1-100)\", hue='Group', style='Group', palette='tab10')\nplt.show()","79415c26":"df['Group'] = DBSCAN(eps=0.09, min_samples=3).fit(X).labels_\ndf.sample(3)","750a5c46":"sns.scatterplot(data=df, x=\"Annual Income (k$)\", y=\"Spending Score (1-100)\", hue='Group', style='Group', palette='tab10')\nplt.show()","9a285242":"silhouette_score(X, df['Group'])","0dd56687":"# produzir dados sint\u00e9ticos\nfrom sklearn.datasets import make_blobs","4506c99f":"X, Y = make_blobs(n_samples=1500, random_state=170)\ntransformation = [[0.60834549, -0.43667341], [-0.40887718, 0.85253229]]\nX_aniso = np.dot(X, transformation)\nX, Y = X_aniso[:, 0], X_aniso[:, 1]","c1969e92":"plt.scatter(X, Y)\nplt.title(\"Dados Sint\u00e9ticos\")\nplt.show()","7c22d728":"pred = DBSCAN(eps=0.4, min_samples=3).fit(X_aniso).labels_\nplt.scatter(X, Y, c=pred)\nplt.title(\"Dados Sint\u00e9ticos - DBSCAN\")\nplt.show()","23b0c2a0":"pred = KMeans(n_clusters = 3).fit(X_aniso).predict(X_aniso)\nplt.scatter(X, Y, c=pred)\nplt.title(\"Dados Sint\u00e9ticos - k-Means\")\nplt.show()","500e09fb":"### Ser\u00e1 que o comportamento muda com o sexo?\n\nVamos pintar as bolinhas de acordo com o sexo do cliente.","57ad9167":"### Caracter\u00edsticas dos Grupos","f3431d1c":"<a id=\"dbscan\"><\/a>\n\n## DBSCAN\n\nDBSCAN (Density-Based Spatial Clustering of Applications with Noise). Encontra amostras de n\u00facleo de alta densidade e expande os clusters a partir delas. Bom para dados que cont\u00eam clusters de densidade semelhante. Existem dois par\u00e2metros para o algoritmo, `min_samples` (n\u00famero min\u00edmo de elementos para formar um grupo) e `eps` (raio de dist\u00e2ncia dos elementos), que definem o que queremos dizer quando dizemos denso.   \n\n> Neste algoritmo, ele identificar\u00e1 o n\u00famero ideal de grupos. Contudo, devemos informar outros par\u00e2metros que tamb\u00e9m s\u00e3o dif\u00edceis de serem definidos.\n> Logo, a escolha do algoritmos de Aprendizado de M\u00e1quina, depende do seu dom\u00ednio sobre os dados e defini\u00e7\u00e3o do problema.   ","e05932d1":"### Avalia\u00e7\u00e3o - Silhouette","e55a009e":"### k-Means\n\nVamos ver o desenpenho do k-Means sobre o conjunto de dados sint\u00e9tico?","98b42eba":"## Estat\u00edstica Descritiva\n\nNesta se\u00e7\u00e3o vemos dois m\u00e9todos do `pandas.DataFrame` para visualizar caracter\u00edsticas dos dados, tais como: (1) `.info()`, presen\u00e7a de valores nulos e os tipos dos dados; e (2) `.describe()`, amplitude, m\u00e9dia, desvio padr\u00e3o e quartiles.","28648f0a":"### Ser\u00e1 que o comportamento muda com a idade?\n\nVamos pintar as bolinhas de acordo com a idade do cliente.","e841b31d":"### DBSCAN","694faa96":"Mudando um pouquinho o valor do $eps$ os resultados s\u00e3o totalmente diferentes.   \nPar\u00e2metros, $eps=0.09$ e $min\\_samples=3$","50f17e0c":"-----\n\n**Conclus\u00e3o**   \n\nConhecer o comportamento dos dados \u00e9 essencial, afim de escolher o melhor algoritmo de agrupamento.   \n\n> 1. Nos dados dos consumidores do Shopping, o algoritmo k-Means apresentou bons resultados.   \n> 2. Contudo nos dados sint\u00e9ticos, o algoritmo DBSCAN se destacou pela habilidade de agrupar regi\u00f5es densas.   \n\n[Voltar para o Topo](#top)","c337b8d3":"<a id=\"kmeans\"><\/a>\n\n## k-Means\n\nO algoritmo `KMeans` agrupa os dados tentando separar amostras em $k$ grupos de vari\u00e2ncia igual, minimizando a dist\u00e2ncia intercluster e maximizando a dist\u00e2ncia intracluster. Este algoritmo necessita saber o n\u00famero de grupos, _i.e.,_ valor de $k$.    \n\nNeste estudo, buscamos identificar 5 grupos de clientes do shopping, ou seja, utilizaremos o $k = 5$ para particionar os dados.","9e0ef2cb":"## Sele\u00e7\u00e3o dos Dados","3a31725b":"### Avalia\u00e7\u00e3o - Silhouette\n\n[Silhouette](https:\/\/en.wikipedia.org\/wiki\/Silhouette_(clustering)) \u00e9 uma m\u00e9trica de interpreta\u00e7\u00e3o e valida\u00e7\u00e3o de algoritmos de agrupamento de dados, avaliando a consist\u00eancia dentro dos grupos. Esta t\u00e9cnica avalia a dist\u00e2ncia intracluster (*i.e.,* a dist\u00e2ncia entre os elementos dentro do mesmo grupo) em rela\u00e7\u00e3o a dist\u00e2ncia intercluster (*i.e.,* a dist\u00e2ncia entre elementos de grupos distintos). Neste caso, quanto maior (mais pr\u00f3ximo de 1) a silhouette melhor a divis\u00e3o dos grupos, e o contr\u00e1rio (mais pr\u00f3ximo de 1) pior a divis\u00e3o dos elementos nos grupos - baseando-se nas dist\u00e2ncias (premissa da m\u00e9trica).","ac1d93c6":"# Agrupamento - Segmenta\u00e7\u00e3o de Clientes\n\nEste notebook realiza uma an\u00e1lise de Agrupamento de Dados sobre o dataset [Mall Customer Segmentation Data](https:\/\/www.kaggle.com\/vjchoudhary7\/customer-segmentation-tutorial-in-python). Um conjunto de dados que re\u00fane caracter\u00edsticas de 200 clientes que frequentam um shopping mall. Neste estudo veremos algumas visualiza\u00e7\u00f5es de dados sobre os clientes, bem como o uso de agrupamento de dados para segmenta\u00e7\u00e3o dos clientes, explorando os algoritmos k-Means e DBSCAN - e comparando seus resultados.   \n\n> Conte\u00fado voltado para iniciantes na \u00e1rea de Aprendizado de M\u00e1quina e Ci\u00eancia de Dados!\n\n<a id=\"top\"><\/a>\n\n## Conte\u00fado\n\n> **Nota**. Alguns c\u00f3digos foram ocultados a fim de facilitar a leitura e dar destaque para os conte\u00fados mais importantes.\n\nO notebook est\u00e1 organizado como segue:\n\n- [Dados](#loading) - Carregamento dos dados.\n- [Visualiza\u00e7\u00e3o](#visual) - An\u00e1lise explorat\u00f3ria dos dados.\n- [Agrupamento](#clustering) - Aplica\u00e7\u00e3o de algoritmos de Aprendizado de M\u00e1quina.\n    - [k-Means](#kmeans) - Segmenta\u00e7\u00e3o com k-Means.\n    - [DBSCAN](#dbscan) - Segmenta\u00e7\u00e3o com DBSCAN.\n    - [Dados Sint\u00e9ticos](#new_data) - Explora\u00e7\u00e3o sobre Dados Sint\u00e9ticos.","5d3cad4a":"**Discuss\u00e3o DBSCAN**   \n\nNeste dados a densidade aparenta ser mais dif\u00edcil de se trabalhar do que a parti\u00e7\u00e3o do k-Means.   \nNota-se que a definis\u00e3o do `eps` dificultou a parti\u00e7\u00e3o dos dados.   \n\nMas quando que o DBSCAN se destaca ao k-Means? depende dos dados...   \nNa pr\u00f3xima se\u00e7\u00e3o, veremos um conjunto de dados sint\u00e9tico e o resultado de ambos os modelos.\n\n-----","f9add638":"Abaixo tem _(ocultado)_ um c\u00f3digo para normalizar os valores por coluna.\n\n> O k-Means utiliza uma fun\u00e7\u00e3o de similaridade para computar a dist\u00e2ncia entre os pontos.   \n> As fun\u00e7\u00f5es de similaridade se benificiam de dados normalizados.   \n\n> Para este estudo de caso, este procedimento n\u00e3o muda o resultado final.   ","9a521785":"### Visualizando os Grupos","ece31fbe":"<a id=\"loading\"><\/a>\n\n---\n\n# Dados\n\n- Carregamento dos dados.\n\n[Voltar para o Topo](#top)","e4f70487":"<a id=\"new_data\"><\/a>\n\n## Dados Sint\u00e9ticos\n\nVamos simular uma nova distribui\u00e7\u00e3o de dados, apenas para visualizar a vantagem do DBSCAN sobre o k-Means.","d2022407":"## Visualiza\u00e7\u00f5es\n\nVamos visualizar a rela\u00e7\u00e3o dos atributos \"receita anual\" x \"score de gasto\".","468c336b":"**Discuss\u00e3o k-Means**   \n\nk-Means conseguiu particionar os dados em 5 grupos bem visiveis.   \nNota-se que suas caracter\u00edsticas podem ser descritas como segue:\n\n> **Nota**. Os n\u00fameros dos grupos s\u00e3o aleat\u00f3rios a cada vez que roda o algoritmo.   \n> Por isso, abaixo s\u00e3o informado os grupos como letras e n\u00e3o n\u00fameros.\n\n- Grupo A - Recebe pouco dinheiro, e tem score baixo.\n- Grupo B - Recebe muito dinheiro, e tem score alto. _(interessante)_\n- Grupo C - Recebe muito dinheiro, e tem score baixo.\n- Grupo D - Recebe pouco dinheiro, e tem score alto.\n- Grupo E - Recebe m\u00e9dio dinheiro, e tem score m\u00e9dio.\n\n-----","dd894893":"Par\u00e2metros, $eps=0.1$ e $min\\_samples=3$","1857136e":"Realiza a gera\u00e7\u00e3o de um dataset sint\u00e9tico _(c\u00f3digo ocultado)._","7f14f4b0":"<a id=\"visual\"><\/a>\n\n---\n\n# Visualiza\u00e7\u00e3o dos Dados\n\n- Carregamento dos dados.\n\n[Voltar para o Topo](#top)","c608e631":"<a id=\"clustering\"><\/a>\n\n---\n\n# Agrupamento de Dados\n\nNesta se\u00e7\u00e3o exploramos:\n\n- Sele\u00e7\u00e3o dos dados de interesse.\n- k-Means\n- DBSCAN\n- Dados Sint\u00e9ticos _(extra)_\n\n[Voltar para o Topo](#top)"}}