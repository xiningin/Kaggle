{"cell_type":{"1c8fdf03":"code","a381b99f":"code","0625fb0a":"code","a3ee1020":"code","d293b73e":"code","eb9b8132":"code","2ca7cfb8":"code","6750c88c":"code","06e16673":"code","358bffeb":"code","567883f0":"code","566b8490":"code","472a7123":"code","73943584":"code","ae6997a8":"markdown","48642ba5":"markdown","ad332b6c":"markdown","9e2b712b":"markdown","5f5385a3":"markdown","fb295530":"markdown"},"source":{"1c8fdf03":"!pip install fastai -q --upgrade","a381b99f":"import fastai\nprint(fastai.__version__)\nfrom fastai.vision.all import *\nfrom pathlib import Path","0625fb0a":"path = Path('..\/input\/fruits\/fruits-360_dataset\/fruits-360\/Training')\n#path.ls()","a3ee1020":"def get_dls(bs, size):\n    dblock = DataBlock(blocks = (ImageBlock, CategoryBlock),\n                       get_items = get_image_files,\n                       get_y = parent_label,\n                       splitter = RandomSplitter(),\n                       item_tfms = Resize(size)\n                      )\n    return dblock.dataloaders(path, bs = bs)","d293b73e":"dls = get_dls(16, 32)","eb9b8132":"learn = cnn_learner(dls, resnet34, metrics=accuracy)","2ca7cfb8":"learn.lr_find()","6750c88c":"learn = cnn_learner(dls, resnet34, metrics=accuracy)\nlearn.fit_one_cycle(10,1e-3)","06e16673":"learn.dls = get_dls(16,32)\nlearn.fine_tune(5, 1e-3)","358bffeb":"learn.show_results()","567883f0":"interp = Interpretation.from_learner(learn)\n#interp.plot_top_losses(k=3,figsize=(12,12))\ninterp.plot_top_losses(k=1)","566b8490":"learn.predict('..\/input\/fruits\/fruits-360_dataset\/fruits-360\/Training\/Apple Braeburn\/0_100.jpg')","472a7123":"learn.export(fname='model.pkl', pickle_module=pickle, pickle_protocol=2)","73943584":"reload_model=load_learner('model.pkl', cpu=True, pickle_module=pickle)\nreload_model","ae6997a8":"# Fruits Classify fastai\nThis notebook referred the following notebook.<br\/>\nhttps:\/\/www.kaggle.com\/mathurinache\/star-wars-characters-classification-with-fastai","48642ba5":"## Reload model","ad332b6c":"## Interpretation","9e2b712b":"## Predict","5f5385a3":"## Show results","fb295530":"## Save model"}}