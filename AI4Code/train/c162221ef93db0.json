{"cell_type":{"9e3fb1ee":"code","28471e86":"code","e20da3d4":"code","2c3db2f6":"code","04a8d6b1":"code","9b5a2261":"code","a2fa8abc":"code","bbd78cb0":"code","7ca90708":"code","a3c574e3":"code","fe248e23":"code","b1ec59ec":"code","be08d68e":"code","b3942720":"code","ce8b01f2":"code","f4675859":"code","f1ace652":"code","47eedc68":"code","addc59c8":"code","ef4ca138":"code","7c7ad236":"code","e99577b9":"code","741113c8":"code","373a500e":"code","1542a762":"code","7bb7bd6c":"code","a2ba1a72":"code","1fe73faf":"code","bf30ac51":"code","6ae5b358":"code","28df5831":"code","a8c648ef":"code","c68e23fc":"code","dda49479":"code","60cac847":"code","f91390d0":"code","103bc63b":"code","dc071b71":"code","521dbc4d":"code","f1e78fd8":"code","0acaa680":"code","ccd19354":"code","e7bfb4ce":"code","3b32cbbc":"code","15a81453":"code","5d11da6e":"code","ec8034b8":"code","2e6b272d":"code","cfe249b2":"markdown","f78c76d0":"markdown","509d713b":"markdown","3a6d8ac3":"markdown","08492140":"markdown","12a08cce":"markdown","b7049579":"markdown","aa13701f":"markdown","f9d77f11":"markdown","51a84d89":"markdown","2040d088":"markdown","70c59cac":"markdown","3f2cc34d":"markdown","9e827e94":"markdown","466301df":"markdown","63b77bf4":"markdown","a7bc59fe":"markdown","d06ec699":"markdown","11dfadc0":"markdown","7713d0bc":"markdown","79037492":"markdown","3b6d7615":"markdown","73cbe4d4":"markdown","64d3c561":"markdown","ead14ef1":"markdown","d06e3694":"markdown","705057ec":"markdown","e0db8eb2":"markdown","e5e48bfe":"markdown","0eede4c7":"markdown","3dd04fc5":"markdown","ffeccb39":"markdown","6d7915e0":"markdown","d75fa7d9":"markdown","698c4b52":"markdown","d31645fc":"markdown","7225f4c6":"markdown","f6ed5633":"markdown","024d5977":"markdown","1e89f8aa":"markdown","006b5f81":"markdown","c10ffff8":"markdown","96af5448":"markdown","6cb0040c":"markdown","b3da3415":"markdown","b1d84a06":"markdown","933242c4":"markdown","35a78dae":"markdown","2d3006fe":"markdown","597292e6":"markdown","3ae60d3b":"markdown","6e8db371":"markdown","957c7591":"markdown","4fc58f25":"markdown","048d7365":"markdown"},"source":{"9e3fb1ee":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport plotly.express as px\nimport matplotlib.pyplot as plt\nimport math\n%matplotlib inline","28471e86":"df2014 = pd.read_csv('..\/input\/premier-league-matches-20142020\/prem2014.csv')\ndf2015 = pd.read_csv('..\/input\/premier-league-matches-20142020\/prem2015.csv')\ndf2016 = pd.read_csv('..\/input\/premier-league-matches-20142020\/prem2016.csv')\ndf2017 = pd.read_csv('..\/input\/premier-league-matches-20142020\/prem2017.csv')\ndf2018 = pd.read_csv('..\/input\/premier-league-matches-20142020\/prem2018.csv')\ndf2019 = pd.read_csv('..\/input\/premier-league-matches-20142020\/prem2019.csv')\ndf2020 = pd.read_csv('..\/input\/premier-league-matches-20142020\/prem2020.csv')","e20da3d4":"def feature(df):\n    h_sc=[]\n    a_sc = []\n    h_co = []\n    a_co = []\n    for i in range(0, len(df), 1):\n        score = df['Score'][i]\n        score = score.split('-')\n        h_sc.append(score[0])\n        a_co.append(score[0])\n        a_sc.append(score[1])\n        h_co.append(score[1])\n    df['Home Team Goals Scored'] = h_sc\n    df['Away Team Goals Scored'] = a_sc\n    df['Home Team Goals Conceeded'] = h_co\n    df['Away Team Goals Conceeded'] = a_co\n    return df","2c3db2f6":"df2014 = feature(df2014)\ndf2014['year'] = 2014\ndf2015 = feature(df2015)\ndf2015['year'] = 2015\ndf2016 = feature(df2016)\ndf2016['year'] = 2016\ndf2017 = feature(df2017)\ndf2017['year'] = 2017\ndf2018 = feature(df2018)\ndf2018['year'] = 2018\ndf2019 = feature(df2019)\ndf2019['year'] = 2019\ndf2020 = feature(df2020)\ndf2020['year'] = 2020","04a8d6b1":"final_data = pd.concat([df2014,df2015,df2016,df2017, df2018, df2019, df2020])\nfinal_data.reset_index(inplace=True)\nfinal_data.drop('index', axis=1, inplace=True)\ndf1 = final_data","9b5a2261":"final_data.info()","a2fa8abc":"final_data.describe()","bbd78cb0":"final_data.head()","7ca90708":"final_data.columns","a3c574e3":"X = final_data[['Home Team Possession %', 'Home Team Total Shots', 'Home Team On Target Shots','Home Team Corners',\n        'Home Team Pass Success %', 'Away Team Possession %', 'Match Excitement', 'Away Team Total Shots', 'Away Team Pass Success %',\n               'Home Team Rating', 'Away Team Rating', 'year']]\ny = final_data['Home Team Goals Scored']","fe248e23":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=101)","b1ec59ec":"from sklearn.ensemble import RandomForestRegressor\nmodel = RandomForestRegressor()\nmodel.fit(X_train, y_train)","be08d68e":"predictions = model.predict(X_test)\n# for i in range(len(predictions)):\n#     predictions","b3942720":"from sklearn.metrics import mean_squared_error\nerrors = mean_squared_error(y_test, predictions, squared=False)\nprint(errors)","ce8b01f2":"from sklearn.metrics import mean_absolute_error\nerrors = mean_absolute_error(y_test, predictions)\nprint(errors)","f4675859":"from sklearn.metrics import r2_score\nprint(r2_score(predictions,y_test))","f1ace652":"accuracy = round(model.score(X_test,y_test)*100, 2)\nprint(str(accuracy)+'%')","47eedc68":"import xgboost as xg\nmodel = xg.XGBRegressor(objective ='reg:linear',\n                  n_estimators = 10, seed = 123)","addc59c8":"model.fit(X_train, y_train)","ef4ca138":"predictions = model.predict(X_test)","7c7ad236":"from sklearn.metrics import mean_squared_error\nerrors = mean_squared_error(y_test, predictions, squared=False)\nprint(errors)","e99577b9":"from sklearn.metrics import mean_absolute_error\nerrors = mean_absolute_error(y_test, predictions)\nprint(errors)","741113c8":"from sklearn.metrics import r2_score\nprint(r2_score(predictions,y_test))","373a500e":"accuracy = round(model.score(X_test,y_test)*100, 2)\nprint(str(accuracy)+'%')","1542a762":"from sklearn.linear_model import Lasso\nfrom sklearn.metrics import r2_score\nbestr2 = -2\nbestaplha = 0\n# for i in range(1,10000,1):\n#     best_alpha = i*0.0001\n#     regr = Lasso(alpha=best_alpha, max_iter=50000)\n#     regr.fit(X_train, y_train)\n#     predictions = regr.predict(X_test)\n#     r2score = r2_score(predictions,y_test)\n#     if(r2score>= bestr2):\n#         bestr2 = r2score\n#         bestaplha = best_alpha\nbest_alpha = 0.0001\nregr = Lasso(alpha=best_alpha, max_iter=50000)\nregr.fit(X_train, y_train)\npredictions = regr.predict(X_test)","7bb7bd6c":"from sklearn.metrics import mean_squared_error\nerrors = mean_squared_error(y_test, predictions, squared=False)\nprint(errors)","a2ba1a72":"from sklearn.metrics import mean_absolute_error\nerrors = mean_absolute_error(y_test, predictions)\nprint(errors)","1fe73faf":"from sklearn.metrics import r2_score\nprint(r2_score(predictions,y_test))","bf30ac51":"accuracy = round(regr.score(X_test,y_test)*100, 2)\nprint(str(accuracy)+'%')","6ae5b358":"X = final_data[['Away Team Possession %', 'Away Team Total Shots', 'Away Team On Target Shots','Away Team Corners',\n        'Away Team Pass Success %', 'Home Team Possession %', 'Match Excitement', 'Home Team Total Shots', 'Home Team Pass Success %',\n               'Away Team Rating', 'Home Team Rating', 'year']]\ny = final_data['Away Team Goals Scored']","28df5831":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=101)","a8c648ef":"from sklearn.ensemble import RandomForestRegressor\nmodel = RandomForestRegressor()\nmodel.fit(X_train, y_train)\nRandomForestRegressor()\npredictions = model.predict(X_test)","c68e23fc":"from sklearn.metrics import mean_squared_error\nerrors = mean_squared_error(y_test, predictions, squared=False)\nprint(errors)","dda49479":"from sklearn.metrics import mean_absolute_error\nerrors = mean_absolute_error(y_test, predictions)\nprint(errors)","60cac847":"from sklearn.metrics import r2_score\nprint(r2_score(predictions,y_test))","f91390d0":"accuracy = round(model.score(X_test,y_test)*100, 2)\nprint(str(accuracy)+'%')","103bc63b":"import xgboost as xg\nmodel = xg.XGBRegressor(objective ='reg:linear',\n                  n_estimators = 10, seed = 123)","dc071b71":"model.fit(X_train, y_train)\npredictions = model.predict(X_test)","521dbc4d":"from sklearn.metrics import mean_squared_error\nerrors = mean_squared_error(y_test, predictions, squared=False)\nprint(errors)","f1e78fd8":"from sklearn.metrics import mean_absolute_error\nerrors = mean_absolute_error(y_test, predictions)\nprint(errors)","0acaa680":"from sklearn.metrics import r2_score\nprint(r2_score(predictions,y_test))","ccd19354":"accuracy = round(model.score(X_test,y_test)*100, 2)\nprint(str(accuracy)+'%')","e7bfb4ce":"from sklearn.linear_model import Ridge\nmodel = Ridge(alpha=0.01)\nmodel.fit(X_train, y_train)","3b32cbbc":"predictions = model.predict(X_test)","15a81453":"from sklearn.metrics import mean_squared_error\nerrors = mean_squared_error(y_test, predictions, squared=False)\nprint(errors)","5d11da6e":"from sklearn.metrics import mean_absolute_error\nerrors = mean_absolute_error(y_test, predictions)\nprint(errors)","ec8034b8":"from sklearn.metrics import r2_score\nprint(r2_score(predictions,y_test))","2e6b272d":"accuracy = round(model.score(X_test,y_test)*100, 2)\nprint(str(accuracy)+'%')","cfe249b2":"# Home Team Goals Scored","f78c76d0":"### R2 Score","509d713b":"![2.jpg](attachment:2.jpg)","3a6d8ac3":"# Import Statements","08492140":"# Prediction Metrics","12a08cce":"### RMSE","b7049579":"### MSE","aa13701f":" The following cells will claculate the goals scored by the home team in the match","f9d77f11":"### Accuracy","51a84d89":"![1.jpg](attachment:1.jpg)","2040d088":"### MSE","70c59cac":"### RMSE","3f2cc34d":"# Prediction Metrics","9e827e94":"# Random Forest Regressor","466301df":"### RMSE","63b77bf4":"### R2 Score","a7bc59fe":"# Data Exploration","d06ec699":"### MSE","11dfadc0":"### MSE","7713d0bc":"### Accuracy","79037492":"### RMSE","3b6d7615":"# Train Test Split ","73cbe4d4":"# Pediction Metrics","64d3c561":"# Ridge Regressor","ead14ef1":"# XGBoost Regressor","d06e3694":"### R2 Score","705057ec":"### Accuracy","e0db8eb2":"# Feature Selection","e5e48bfe":"Goals scored by away team and home team can be predicted by their respective stats such as shots on target, possession %, pass success %. Their differnce lies in the fact that one team is playing in the home stadium and other is playing in the away stadium. The crowds and ton more factors come in play, because of lack of data we cannot calculate the exact prediction, but with this data we can score a pretty good guess.<br><br>\n\nAnother important factor i noticed it that predicting with half time scores can increase the accuracy significantly higher, but it is highly correlated hence we should try to omit it from our features list.","0eede4c7":"# Away Team Goals Scored","3dd04fc5":"### RMSE","ffeccb39":"### Accuracy","6d7915e0":"# Feature Engineering","d75fa7d9":"# Random Forest Regressor","698c4b52":"### MSE","d31645fc":"### Accuracy","7225f4c6":"### MSE","f6ed5633":" The following cells will claculate the goals scored by the home team in the match","024d5977":"# Loading CSV Files","1e89f8aa":"# XG Boost Regressor","006b5f81":"# Lasso Regression","c10ffff8":"# Prediction Metrics","96af5448":"# Statistics In Sports","6cb0040c":"A goal is scored when the whole of the ball passes over the goal line, between the goalposts and under the crossbar, provided that no offence has been committed by the team scoring the goal. If the goalkeeper throws the ball directly into the opponents' goal, a goal kick is awarded.\n\nTHE TIME OF SEASON\/MOTIVATION: While a club battling for a league title is going to be hungry for a win, as is a side that is fighting to stay up, a club that has already won the title or has already been relegated is unlikely to work as hard, and often rest players as well.\nTHE REFEREE: Of course, when referee's send players off it make a massive impact on a match, but even if he is just awarding a yellow card then it can affect the outcome of the game as the player booked is less likely to go in as hard for the rest of the match.\n\nSUBSTITUTES: The whole point of substitutes is for them to be able to come on and impact a match. Subs not only bring on a fresh pair of legs that are less tired than starters and more likely to track back and push forward, but can also play crucial roles in the formation of a team.\n\nMIND GAMES\/MANAGERS: Playing mind games has almost become a regular routine for top level managers, and rightly so. Just a simple mind game can do so much to impact a match, a good example coming from Sir Alex Ferguson.\n\nPer his autobiography, when Manchester United were losing late on in a match at a certain point he would tap his watch and make sure to let the opposition know he is signalling this to his players. United's opposition already know that United have a tendency to come back from behind, and upon seeing this gesture they will think that United are going to come back. And because scientific studies prove that living creatures are more likely to accept things that have happened before than not - horses are more likely to lose to a horse they have already lost to in a race even if they are on an even playing field - they often succumb to a loss.\n\nFORM\/INJURIES\/FIXTURES: A team on better form is more likely to win a match than if they have been on a poor run of form, while a team in the middle of a condensed run of fixtures is less likely to win than a well rested team.\nThese are just some of the things that affect matches - if you have any other just mention them in the comment section below and I'll try to add them in!","b3da3415":"# Train Test Split","b1d84a06":"# Conclusion","933242c4":"### R2 Score","35a78dae":"### Accuracy","2d3006fe":"# Pediction Metrics","597292e6":"Statistics also plays a key role in ensuring the integrity of sports ranging from baseball and basketball to cycling and sumo wrestling.\n\nThe Premier League is by far one of the world\u2019s most entertaining leagues. They have some of the best managers, players and fans! But, what makes it truly entertaining is the sheer unpredictability. There are 6 equally amazing teams with a different team lifting the trophy every season. Not only that, the league has also witnessed victories from teams outside of the top 6. So, let us analyze some of these instances.\n\nSo far, the implementation of statistics into soccer has been positive. Teams can easily gather information about their opponents and their tactics. This convenience allows managers to create well-thought out game plans that suit their team, maximize opponents' weaknesses, and increase their chances of winning.","3ae60d3b":"### R2 Score","6e8db371":"# Feature Selection","957c7591":"# What Are Goals In Football","4fc58f25":"### RMSE","048d7365":"### R2 Score"}}