{"cell_type":{"030732dc":"code","c867d94c":"code","9965c99d":"code","d7263ccb":"code","7034bcee":"code","b0d0a48e":"code","761f0988":"code","49981587":"code","3002e84f":"code","93f2b56e":"code","d4aaa311":"code","006e2c67":"code","7b63277c":"code","89db04a5":"code","d3e1cf42":"code","523c4c6f":"code","552576d3":"code","e2c91a35":"code","a90b04de":"code","32ec791c":"code","a874cf1f":"code","78207789":"code","2c9191e8":"code","ec87889c":"code","5c1fd3b2":"code","ca8d0f73":"code","9af9a2c2":"code","dc7079c4":"code","4bc1667c":"code","a2686c49":"code","bdec78cc":"code","9138bfb2":"code","f3d47518":"code","3d5714d1":"code","b610e4fe":"code","369788fd":"code","26877b93":"code","a03071a5":"code","52beeb27":"code","677ece99":"code","2e68c1f0":"code","670c76ea":"code","58208316":"code","a2db94d5":"code","e9711cbf":"code","f04c4e7d":"code","396ec363":"code","c559a781":"code","c124ceb4":"code","80613555":"code","bf17fada":"code","72b2b8a0":"code","01080b23":"code","b064e044":"code","a83bcdb1":"code","ca018f10":"code","c661c2d7":"code","9dcf390c":"code","7fe5810e":"code","71791aef":"code","30c7daaa":"code","c1a3a6fc":"code","f4b8d222":"code","59ec78ff":"code","c66bf869":"code","e52efd7b":"code","169218db":"code","b8dc0bfa":"code","8c9f92ad":"code","df5bd604":"code","cc014a72":"code","238a5bab":"code","16d98d83":"code","c5b555ce":"code","38872a52":"code","46b7cd2d":"code","82682f29":"code","df97a9d6":"code","c24d9e44":"code","27d3b4ae":"code","ad71fa51":"code","60c28a53":"code","3a62d263":"code","ecc748da":"code","8e16bc7f":"code","0a218110":"code","0cd8c69f":"code","a39fde7e":"code","fa702db6":"code","4cb1ec97":"code","6d7332ae":"code","81913d12":"code","3dd44832":"code","a34a681f":"code","ee40173f":"code","54476925":"code","4619debc":"code","75049d41":"code","1b755749":"code","722789e9":"code","89c329dc":"code","0de548d2":"code","08aba033":"code","8146fe45":"code","91ff5987":"code","8defc5de":"code","66e1308f":"code","da19f2cc":"code","4d02116a":"code","2da81cc8":"code","6734bbb3":"code","77d00046":"markdown","00bbc55e":"markdown","072232d7":"markdown","42d623fc":"markdown","0c57117d":"markdown","fef0d7bc":"markdown","9ddca0d4":"markdown","df2d864f":"markdown","f5359687":"markdown","d38b827a":"markdown","c98545d0":"markdown","eabd7ef9":"markdown","bda48b6e":"markdown","00f8d335":"markdown","d425592a":"markdown","8b14da2b":"markdown","6f04be44":"markdown","2061fb50":"markdown","c5d5ef56":"markdown","d7b3ebf7":"markdown","864688d4":"markdown","2d2b27f2":"markdown","be5a2317":"markdown","20fc1911":"markdown","8f347f53":"markdown","3dd5601f":"markdown","96f302e2":"markdown","8e5677ec":"markdown","a3232e69":"markdown","6c961daf":"markdown","d462a85a":"markdown","b8d7d8f0":"markdown","06baa532":"markdown","fd8aac47":"markdown","5595bd19":"markdown","1a47e173":"markdown"},"source":{"030732dc":"#importing libraries for data preprocessing\nimport pandas as pd","c867d94c":"#loading datasets\n\ndf1=pd.read_csv(\"\/kaggle\/input\/world-happiness\/2015.csv\")\ndf2=pd.read_csv(\"\/kaggle\/input\/world-happiness\/2016.csv\")\ndf3=pd.read_csv(\"\/kaggle\/input\/world-happiness\/2017.csv\")\ndf4=pd.read_csv(\"\/kaggle\/input\/world-happiness\/2018.csv\")\ndf5=pd.read_csv(\"\/kaggle\/input\/world-happiness\/2019.csv\")","9965c99d":"#chechking for columns\nprint(df1.columns,'\\n',df2.columns,'\\n',df3.columns,'\\n',df4.columns,'\\n',df5.columns)","d7263ccb":"df1.head(5)","7034bcee":"df2.head(5)","b0d0a48e":"# checking if the confidence interval is indeed mean +- st.error\n\n(7526-7460)\/1.96==(7592-7526)\/1.96","761f0988":"#it is so we can actually get the st.error from these 2 columns if needed\n\ndf3.head(5)","49981587":"df4.head(5)","3002e84f":"df5.head()","93f2b56e":"df4['residual']=df4['Score'] - df4['GDP per capita']-df4['Social support'] - df4['Healthy life expectancy']- df4['Freedom to make life choices'] - df4['Generosity']-df4['Perceptions of corruption']","d4aaa311":"df5['residual']=df5['Score'] - df5['GDP per capita']-df5['Social support'] - df5['Healthy life expectancy']- df5['Freedom to make life choices'] - df5['Generosity']-df5['Perceptions of corruption']","006e2c67":"df4.head()","7b63277c":"df5.head()","89db04a5":"print('' ,df1['Dystopia Residual'].mean(),'\\n',df2['Dystopia Residual'].mean(),'\\n',df3['Dystopia.Residual'].mean(),\n      '\\n', df4['residual'].mean(), '\\n',df5['residual'].mean())","d3e1cf42":"columns=['Country', 'Region','Happiness Score','Economy (GDP per Capita)', 'Family',\n       'Health (Life Expectancy)', 'Freedom', 'Trust (Government Corruption)','Generosity','Dystopia Residual']","523c4c6f":"new_columns_15=['country','region','happiness score','GDP_15','family\/social_support_15','life_expectancy_15','freedom_to_make_choices_15','perception_of_corruption_15','generosity_15','residual_15']","552576d3":"df1_new=df1.drop(['Happiness Rank','Standard Error'],axis=1)","e2c91a35":"df1_new.rename(columns=dict(zip(columns,new_columns_15)),inplace=True)","a90b04de":"df1_new","32ec791c":"columns_2=['Country','Region', 'Happiness Score','Economy (GDP per Capita)', 'Family', 'Health (Life Expectancy)',\n       'Freedom', 'Trust (Government Corruption)', 'Generosity',\n       'Dystopia Residual']\ndf2_new=df2.drop(['Happiness Rank','Lower Confidence Interval', 'Upper Confidence Interval'],axis=1)","a874cf1f":"new_columns_16=['country','region','happiness score','GDP_16','family\/social_support_16','life_expectancy_16','freedom_to_make_choices_16','perception_of_corruption_16','generosity_16','residual_16']","78207789":"df2_new.rename(columns=dict(zip(columns_2,new_columns_16)),inplace=True)","2c9191e8":"df2_new.head(2)","ec87889c":"columns_3=['Country', 'Happiness.Score', 'Economy..GDP.per.Capita.', 'Family',\n       'Health..Life.Expectancy.', 'Freedom','Trust..Government.Corruption.',\n            'Generosity','Dystopia.Residual']\ndf3_new=df3.drop([  'Happiness.Rank','Whisker.high','Whisker.low', ],axis=1)\nnew_columns_17=['country','happiness score','GDP_17','family\/social_support_17','life_expectancy_17','freedom_to_make_choices_17','perception_of_corruption_17','generosity_17','residual_17']\ndf3_new.rename(columns=dict(zip(columns_3,new_columns_17)),inplace=True)","5c1fd3b2":"df3_new.head()","ca8d0f73":"#makin order of columns the same\n#df3_new=df3_new[new_columns_17]","9af9a2c2":"#df3_new.head(2)","dc7079c4":"#I will rename and drop columns for df4 and df5\ncolumns_4=['Country or region', 'Score', 'GDP per capita',\n       'Social support', 'Healthy life expectancy',\n       'Freedom to make life choices', 'Generosity',\n       'Perceptions of corruption','residual']\ndf4_new=df4.drop(['Overall rank'],axis=1)\nnew_columns_18=['country','happiness score','GDP_18','family\/social_support_18','life_expectancy_18','freedom_to_make_choices_18','perception_of_corruption_18','generosity_18','residual_18']\ndf4_new.rename(columns=dict(zip(columns_4,new_columns_18)),inplace=True)","4bc1667c":"df4_new.head()","a2686c49":"columns_5=['Country or region', 'Score', 'GDP per capita',\n       'Social support', 'Healthy life expectancy',\n       'Freedom to make life choices', 'Generosity',\n       'Perceptions of corruption','residual']\ndf5_new=df5.drop([  'Overall rank' ],axis=1)\nnew_columns_19=['country','happiness score','GDP_19','family\/social_support_19','life_expectancy_19','freedom_to_make_choices_19','perception_of_corruption_19','generosity_19','residual_19']\ndf5_new.rename(columns=dict(zip(columns_5,new_columns_19)),inplace=True)\n\n","bdec78cc":"df5_new.head(2)","9138bfb2":"print(df1_new.info(),'\\n',df2_new.info(),'\\\\n',df3_new.info(),\n      '\\\\n',df4_new.info(),'\\\\n',df5_new.info())","f3d47518":"n=0\nfor country in df1_new['country'].unique() :\n    if country not in df3_new['country'].unique():\n        n+=1\n        print( country,False)\nprint(f'\\n{n} countries are not in df3_new')","3d5714d1":"#now the wice versa\nn=0\nfor country in df3_new['country'].unique() :\n    if country not in df1_new['country'].unique():\n        n+=1\n        print( country,False)\nprint(f'\\n{n} countries are not in df1_new')","b610e4fe":"#dropping countries that are in df3_new but not in the df1_new\nto_drop=['Oman','Suriname','Laos','Swaziland','Djibouti','Comoros','Somaliland region']\nfor name in to_drop:\n    df1_new.drop( df1_new[ df1_new['country'] == name ].index , inplace=True)","369788fd":"len(df1_new)","26877b93":"#dropping countries that are in df1_new but not in the df3_new\nto_drop1=['Belize','Namibia','South Sudan','Somalia']\nfor name in to_drop1:\n    df3_new.drop( df3_new[ df3_new['country'] == name ].index , inplace=True)","a03071a5":"len(df3_new)","52beeb27":"df3_new=df3_new.replace(['Taiwan Province of China','Hong Kong S.A.R., China'],['Taiwan','Hong Kong'])","677ece99":"n=0\nfor country in df1_new['country'].unique() :\n    if country not in df2_new['country'].unique():\n        n+=1\n        print( country,False)\nprint(f'\\n{n} countries are not in df2_new')","2e68c1f0":"n=0\nfor country in df2_new['country'].unique() :\n    if country not in df1_new['country'].unique():\n        n+=1\n        print( country,False)\nprint(f'\\n{n} countries are not in df1_new')","670c76ea":"#dropping countries that are in df2_new but not in the df1_new (and therefore not in df3_new)\nto_drop2=['Mozambique','Lesotho','Central African Republic' ]\nfor name in to_drop2:\n    df1_new.drop( df1_new[ df1_new['country'] == name ].index , inplace=True)\n    df3_new.drop( df3_new[ df3_new['country'] == name ].index , inplace=True)","58208316":"#dropping countries that are in df1_new but not in the df2_new \nto_drop3=['Puerto Rico', 'Suriname', 'Belize','Somalia', 'Laos','Namibia', 'Comoros', 'South Sudan','Somaliland Region']\nfor name in to_drop3:\n    df2_new.drop( df2_new[ df2_new['country'] == name ].index , inplace=True)","a2db94d5":"print(len(df1_new),len(df2_new),len(df3_new))","e9711cbf":"n=0\nfor country in df1_new['country'].unique() :\n    if country not in df4_new['country'].unique():\n        n+=1\n        print( country,False)\nprint(f'\\n{n} countries are not in df4_new')","f04c4e7d":"n=0\nfor country in df4_new['country'].unique() :\n    if country not in df1_new['country'].unique():\n        n+=1\n        print( country,False)\nprint(f'\\n{n} countries are not in df1_new')","396ec363":"#renaming\ndf4_new=df4_new.replace(['Trinidad & Tobago','Northern Cyprus'],\n                  ['Trinidad and Tobago','North Cyprus'])","c559a781":"#dropping countries that are in df4_new but not in the df1_new\nto_drop4=['Belize','Somalia','Laos', 'Namibia', 'South Sudan','Central African Republic',\n          'Mozambique','Lesotho']\nfor name in to_drop4:\n    df4_new.drop( df4_new[ df4_new['country'] == name ].index , inplace=True)","c124ceb4":"len(df4_new)","80613555":"n=0\nfor country in df1_new['country'].unique() :\n    if country not in df5_new['country'].unique():\n        n+=1\n        print( country,False)\nprint(f'\\n{n} countries are not in df5_new')","bf17fada":"n=0\nfor country in df5_new['country'].unique() :\n    if country not in df1_new['country'].unique():\n        n+=1\n        print( country,False)\nprint(f'\\n{n} countries are not in df1_new')","72b2b8a0":"#renaming countries\ndf5_new=df5_new.replace(['Trinidad & Tobago','Northern Cyprus','North Macedonia'],\n                  ['Trinidad and Tobago','North Cyprus','Macedonia'])","01080b23":"#dropping countries that are in df1_new but not in the df5_new\nto_drop5=['Laos','Somalia','Namibia','Gambia','Swaziland','Comoros', 'Central African Republic','South Sudan','Mozambique','Lesotho']\nfor name in to_drop5:\n    df5_new.drop( df5_new[ df5_new['country'] == name ].index , inplace=True)","b064e044":"#droppiing countries that are in df5_nwe but not in the other datasets\nto_drop6=['Sudan','Angola']\ndata_frames=[df1_new,df2_new,df3_new,df4_new]\nfor name in to_drop6:\n    for frame in data_frames:\n        frame.drop( frame[ frame['country'] == name ].index , inplace=True)\n","a83bcdb1":"print(len(df1_new),len(df2_new),len(df3_new),len(df4_new),len(df5_new))","ca018f10":"df1_new=df1_new.sort_values('country')\ndf2_new=df2_new.sort_values('country')\ndf3_new=df3_new.sort_values('country')\ndf4_new=df4_new.sort_values('country')\ndf5_new=df5_new.sort_values('country')","c661c2d7":"df1_new['country'].unique()==df2_new['country'].unique()","9dcf390c":"df1_new['country'].unique()==df3_new['country'].unique()","7fe5810e":"df1_new['country'].unique()==df4_new['country'].unique()","71791aef":"df1_new['country'].unique()==df5_new['country'].unique()","30c7daaa":"frames=[df1_new,df2_new,df3_new,df4_new,df5_new]\nfor frame in frames:\n    frame=frame.reset_index(drop=True,inplace=True)\n    ","c1a3a6fc":"df1_new.head(3)","f4b8d222":"df3_new['region']=df1_new['region']\nnew_col=['country','region','happiness score','GDP_17','family\/social_support_17','life_expectancy_17','freedom_to_make_choices_17','perception_of_corruption_17','generosity_17','residual_17']\ndf3_new=df3_new[new_col]","59ec78ff":"df3_new.head(2)","c66bf869":"df4_new['region']=df1_new['region']\nnew_col=['country','region','happiness score','GDP_18','family\/social_support_18','life_expectancy_18','freedom_to_make_choices_18','perception_of_corruption_18','generosity_18','residual_18']\ndf4_new=df4_new[new_col]","e52efd7b":"df5_new['region']=df1_new['region']\nnew_col=['country','region','happiness score','GDP_19','family\/social_support_19','life_expectancy_19','freedom_to_make_choices_19','perception_of_corruption_19','generosity_19','residual_19']\ndf5_new=df5_new[new_col]","169218db":"import pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline","b8dc0bfa":"#loading datasets\n\n%store -r df1_new\n%store -r df2_new\n%store -r df3_new\n%store -r df4_new\n%store -r df5_new","8c9f92ad":"from plotly.offline import download_plotlyjs,init_notebook_mode,plot,iplot\ninit_notebook_mode(connected=True)\nimport plotly.graph_objs as go","df5bd604":"#creating geoplots for years 2015-2019 on the world level.\ndata15=dict(type='choropleth',\n          locations=df1_new['country'],\n          locationmode='country names',\n          colorscale=\"reds\",\n          text=df1_new['country'],\n          z=df1_new['happiness score'],\n          colorbar={'title':'Happiness score'})\n\nlayout15=dict(title='2015 World Happiness Score',geo=dict(showframe=True,projection={'type':'natural earth'}))\nchoromap=go.Figure(data=[data15],layout=layout15)\niplot(choromap)","cc014a72":"data16=dict(type='choropleth',\n          locations=df2_new['country'],\n          locationmode='country names',\n          colorscale=\"reds\",\n          text=df2_new['country'],\n          z=df2_new['happiness score'],\n          colorbar={'title':'Happiness score'})\n\nlayout16=dict(title='2016 World Happiness Score',geo=dict(showframe=True,projection={'type':'natural earth'}))\nchoromap=go.Figure(data=[data16],layout=layout16)\niplot(choromap)","238a5bab":"data17=dict(type='choropleth',\n          locations=df3_new['country'],\n          locationmode='country names',\n          colorscale=\"reds\",\n          text=df3_new['country'],\n          z=df3_new['happiness score'],\n          colorbar={'title':'Happiness score'})\n\nlayout17=dict(title='2017 World Happiness Score',geo=dict(showframe=True,projection={'type':'natural earth'}))\nchoromap=go.Figure(data=[data17],layout=layout17)\niplot(choromap)","16d98d83":"data18=dict(type='choropleth',\n          locations=df4_new['country'],\n          locationmode='country names',\n          colorscale=\"reds\",\n          text=df4_new['country'],\n          z=df4_new['happiness score'],\n          colorbar={'title':'Happiness score'})\n\nlayout18=dict(title='2018 World Happiness Score',geo=dict(showframe=True,projection={'type':'natural earth'}))\nchoromap=go.Figure(data=[data18],layout=layout18)\niplot(choromap)","c5b555ce":"data19=dict(type='choropleth',\n          locations=df5_new['country'],\n          locationmode='country names',\n          colorscale=\"reds\",\n          text=df5_new['country'],\n          z=df5_new['happiness score'],\n          colorbar={'title':'Happiness score'})\n\nlayout19=dict(title='2019 World Happiness Score',geo=dict(showframe=True,projection={'type':'natural earth'}))\nchoromap=go.Figure(data=[data19],layout=layout19)\niplot(choromap)","38872a52":"#histogram function that can be used for any dataframe\n\ndef hist_plot(frame):\n    fig,((ax1,ax2,ax3,ax4,ax5),(ax6,ax7,ax8,ax9,ax10))=plt.subplots(2,5,sharex=False,sharey=True,figsize=(15,8))\n\n    axs=[ax1,ax2,ax3,ax4,ax5,ax6,ax7,ax8,ax9,ax10]\n    scores=[frame[frame['region']=='Western Europe']['happiness score'],frame[frame['region']=='Central and Eastern Europe']['happiness score'],\n            frame[frame['region']=='Middle East and Northern Africa']['happiness score'],\n            frame[frame['region']=='Sub-Saharan Africa']['happiness score'],\n            frame[frame['region']=='Southern Asia']['happiness score'],\n            frame[frame['region']=='Southeastern Asia']['happiness score'],\n            frame[frame['region']=='Eastern Asia']['happiness score'],\n            frame[frame['region']=='Australia and New Zealand']['happiness score'],\n            frame[frame['region']=='North America']['happiness score'],\n            frame[frame['region']=='Latin America and Caribbean']['happiness score']]\n\n    #I will choose different number of bins for sifferent region as their number of countries differs a lot\n    for n in (0,1,2,3,9):\n        axs[n].hist(scores[n],color='orange',bins=15,edgecolor=\"white\")\n    for n in (4,5,6,7,8):\n        axs[n].hist(scores[n],color='orange',bins=5,edgecolor=\"white\")\n\n\n    plt.suptitle('Happines score distribution in 2015 accross regions',size=15)   \n\n    ax1.set_title('Western Europe',size=10)\n    ax2.set_title('Central and Eatsern Europe',size=10)\n    ax3.set_title('Middle East and Northern Africa',size=10)\n    ax4.set_title(\"Sub-Saharan Africa\",size=10)\n    ax5.set_title('Southern Asia',size=10)\n    ax6.set_title('Southeastern Asia',size=10)\n    ax7.set_title('Easter Asia',size=10)\n    ax8.set_title('Australia and New Zealand',size=10)\n    ax9.set_title('North America',size=10)\n    ax10.set_title('Latin America and Caribbean',size=10)\n\n\n    for ax in axs:\n        ax.spines['bottom'].set_color('lightgrey')\n        ax.spines['top'].set_color('white')\n        ax.spines['left'].set_color('lightgrey')\n        ax.spines['right'].set_color('white')\n\n\n    plt.show()","46b7cd2d":"hist_plot(df1_new)","82682f29":"#qq-Plot function\ndef qq_plot(frame):\n    import warnings\n    warnings.filterwarnings('ignore')\n\n    import statsmodels.api as sm\n    fig,axes=plt.subplots(2,5,sharex=False,sharey=True,figsize=(15,8))\n    plt.subplots_adjust(top = 0.99, bottom=0.01, hspace=0.5, wspace=0.4)\n    scores=[frame[frame['region']=='Western Europe']['happiness score'],frame[frame['region']=='Central and Eastern Europe']['happiness score'],\n            frame[frame['region']=='Middle East and Northern Africa']['happiness score'],\n            frame[frame['region']=='Sub-Saharan Africa']['happiness score'],\n            frame[frame['region']=='Southern Asia']['happiness score'],\n            frame[frame['region']=='Southeastern Asia']['happiness score'],\n            frame[frame['region']=='Eastern Asia']['happiness score'],\n            frame[frame['region']=='Australia and New Zealand']['happiness score'],\n            frame[frame['region']=='North America']['happiness score'],\n            frame[frame['region']=='Latin America and Caribbean']['happiness score']]\n\n    axs=axes.flatten()\n\n    for n in range(0,10):\n        sm.qqplot(scores[n],line='s',ax=axs[n])\n\n    axs[0].set_title('Western Europe',size=10)\n    axs[1].set_title('Central and Eatsern Europe',size=10)\n    axs[2].set_title('Middle East and Northern Africa',size=10)\n    axs[3].set_title(\"Sub-Saharan Africa\",size=10)\n    axs[4].set_title('Southern Asia',size=10)\n    axs[5].set_title('Southeastern Asia',size=10)\n    axs[6].set_title('Easter Asia',size=10)\n    axs[7].set_title('Australia and New Zealand',size=10)\n    axs[8].set_title('North America',size=10)\n    axs[9].set_title('Latin America and Caribbean',size=10)\n\n\n    for ax in axs:\n        ax.spines['bottom'].set_color('lightgrey')\n        ax.spines['top'].set_color('white')\n        ax.spines['left'].set_color('lightgrey')\n        ax.spines['right'].set_color('white')\n\n    plt.show()\n\n","df97a9d6":"qq_plot(df1_new)","c24d9e44":"import seaborn as sns","27d3b4ae":"#boxplot function\ndef box_plot(frame):\n    plt.figure(figsize=(10,10))\n    sns.boxplot(data=frame,x='region',y='happiness score')\n    plt.xticks(rotation='vertical')\n\n    ax=plt.gca()\n    ax.spines[['top','right']].set_color('white')\n    ax.spines[['bottom','left']].set_color('lightgrey')\n\n    plt.show()","ad71fa51":"box_plot(df4_new)","60c28a53":"#check two outliers\n\ndf1_new[df1_new['region']=='Latin America and Caribbean'][['country','happiness score']].min()","3a62d263":"df1_new[df1_new['region']=='Sub-Saharan Africa'][['country','happiness score']].max()","ecc748da":"#adding the yaer column\nimport numpy as np\n\ndf1_new['year']=np.array('2015')\ndf2_new['year']=np.array('2016')\ndf3_new['year']=np.array('2017')\ndf4_new['year']=np.array('2018')\ndf5_new['year']=np.array('2019')","8e16bc7f":"data=[df1_new[['country','region','happiness score','year']],df2_new[['country','region','happiness score','year']],\n      df3_new[['country','region','happiness score','year']],df4_new[['country','region','happiness score','year']],\n      df5_new[['country','region','happiness score','year']]]","0a218110":"score_reg=pd.concat(data,axis=0)","0cd8c69f":"score_reg.head()","a39fde7e":"score_reg.info()","fa702db6":"plt.figure(figsize=(12,8))\nsns.barplot(x='region',y='happiness score',hue='year',data=score_reg,errwidth=0)\nax=plt.gca()\nax.spines[['top','right']].set_color('white')\nax.spines[['left','bottom']].set_color('lightgrey')\nplt.title('Average happiness score per region and over years')\nplt.xticks(rotation='vertical')\nplt.show()","4cb1ec97":"['Western Europe','Central and Eatsern Europe','Middle East and Northern Africa',\n\"Sub-Saharan Africa\",'Southern Asia','Southeastern Asia','Easter Asia','Australia and New Zealand',\n'North America','Latin America and Caribbean']","6d7332ae":"round(score_reg.groupby('region')['happiness score'].mean(),2)","81913d12":"def display_figures(ax):\n    l=[4.58,5.43, 5.32, 6.01,7.29, 6.74,4.19,5.39,7.17,5.65]\n    i=0\n    for p in ax.patches:\n        h=p.get_height()\n        if (h>0):\n            value=l[i]\n            ax.text(p.get_x()+p.get_width()\/2,h+0.08, value, ha='center')\n            i=i+1\n            \nplt.figure(figsize=(12,8))\nplt.title('Average happiness score per region 2015-2019')\nax=sns.barplot(x='region',y='happiness score',data=score_reg,errwidth=0)\nax=plt.gca()\nax.spines[['top','right']].set_color('white')\nax.spines[['left','bottom']].set_color('lightgrey')\nplt.xticks(rotation='vertical')\ndisplay_figures(ax)","3dd44832":"plt.figure(figsize=(12,8))\nsns.boxplot( hue='year', y='happiness score', x='region',data=score_reg)\nax=plt.gca()\nax.spines[['top','right']].set_color('white')\nax.spines[['left','bottom']].set_color('lightgrey')\nplt.xticks(rotation='vertical')\nplt.legend(bbox_to_anchor=(1.15,0.9))\nplt.show()","a34a681f":"import plotly.express as px\n\ndef tree(frame):\n    plt.figure(figsize=(14,14))\n    fig = px.treemap(frame, \n                     path=['region','country'], \n                     values='happiness score',\n                     color='happiness score'\n                    )\n    fig.show()","ee40173f":"tree(df1_new)","54476925":"tree(df2_new)","4619debc":" #creating the new data frame named df_growth\ndf_growth=pd.DataFrame(data=np.array([df1_new.country,df1_new.region,df1_new['happiness score'],df2_new['happiness score'],\n                                  df3_new['happiness score'],df4_new['happiness score'],df5_new['happiness score']]).transpose(),index=df1_new.index,\n                            columns=['country','region','score_15','score_16','score_17','score_18','score_19'])","75049d41":"df_growth.head()","1b755749":"#creating column growth percentage\ndf_growth['growth_percentage']=((df_growth['score_19']-df_growth['score_15'])\/df_growth['score_15']*100)","722789e9":"df_growth['growth_percentage']=df_growth['growth_percentage'].astype(float).round(2)","89c329dc":"df_growth.head()","0de548d2":"#separating positive and negative growth into the  spearate data frames\ndf_growth_pos=df_growth[df_growth['growth_percentage']>=0][['country','region','growth_percentage']].sort_values(by='growth_percentage',\n                                                                               axis=0,ascending=False)","08aba033":"df_growth_neg=df_growth[df_growth['growth_percentage']<0][['country','region','growth_percentage']].sort_values(by='growth_percentage',\n                                                                               axis=0,ascending=True)","8146fe45":"#I will not make a bar chart for these two to see which countries had the highest growth\ndf_growth_pos.plot(x='country',y='growth_percentage',kind='bar',figsize=(20,10),color='red',alpha=0.5)\nplt.show()","91ff5987":"print(f\"Percentage of countries whose Happiness score has increased for more than 20% is:{len(df_growth_pos[df_growth_pos['growth_percentage']>20])\/len(df_growth_pos)*100}\")","8defc5de":"df_growth_pos.head(11)","66e1308f":"#I will not make a bar chart for these two to see which countries had the highest drop\ndf_growth_neg.plot(x='country',y='growth_percentage',kind='bar',figsize=(20,10),color='blue',alpha=0.5)\nplt.show()","da19f2cc":"df_growth_neg.head(20)","4d02116a":"print(f\"Percentage of countries whose Happiness score has decreased for more than 20% is:{len(df_growth_neg[df_growth_neg['growth_percentage']<-20])\/len(df_growth_neg)*100}\")","2da81cc8":"#countries in SA with positive growth\ndf_growth_pos[df_growth_pos['region']=='Latin America and Caribbean']","6734bbb3":"#countries in SA with negative growth\ndf_growth_neg[df_growth_neg['region']=='Latin America and Caribbean']","77d00046":"Only by looking at the above plots, I could notice few things.\n\n- When we look at regions (and remember our regions are 'Southern Asia', 'Central and Eastern Europe','Middle East and Northern Africa', 'Latin America and Caribbean','Australia and New Zealand', 'Western Europe', 'Sub-Saharan Africa', 'Southeastern Asia', 'North America','Eastern Asia') it seems that Australia and New Zeland has the highest happiness score, followed closely by North America. \n- Africa has the lowest hapiness score but we can see the difference between Middle East and Northern Africa(higer scores) and Sub-Saharan Africa(lower scores). \n- Similarly Western Europe has higher scores than Central and Eastern Europe. \n- There seem to be at least few countries whose happines score is dropping continuously (Venezuela, Russia, Kazakhstan, Thailand, Algeria..) In some countries (Honduras, Mogolia) the score is increasing. \n\nFrom all this I can think of two ways in approaching analysis and visualization. I can investigate regions and countries.\n\nI will present the distribution of happiness score in 2015 accross regions and using histograms. I will also use Q-Q plots to test normality and box-and-whisker plots for outliers. These all will hopefully help me to see the distribution of data better and to decide whether the mean would be good measure of central tendency. ","00bbc55e":"12 countries have been lost in data cleaning. It is important to mention that those countries are still in the original dataframes and they will be displayed on geomaps. But for the sake of comparison between years it is appropriate to have same countries.  \nNow I will sort data by country to check once more if all dataframes have the same countries ","072232d7":"df3 doesn't have confidence interval but rather IQR , so  td.error can be dropped from further analysis","42d623fc":"So, after all we could say that Oceania is the happies region, followed by North America, Western Europe, and\/or latin America and Caribbean? For the clear decision on what is the happiest continet I will also have to check the change in happines score over years. My plots in part 1 have indicated a downward trend in some regions. ","0c57117d":"Another cool way to visualize and compare scores is through treemaps. For that I need to make a new column","fef0d7bc":"From this barplot we can see how mean values can be deceiving. While Australia is no doubt in lead (it is obvious from both charts) North and Latin America have the second and the fourth overall score. If we look at the previous chart we can see that in those regions Happiness index is consistently decreasing and therefor this average happiness index has to be taken with \"a grain of salt\" in the future. \n\nFor other continents this barchart shows pretty much the same as the previous one.\n\n\nLet's look at the median and spread. I will use boxplots.","9ddca0d4":"Now I have table with all years and all scores. We can use it to present the data on barchart to cehck for avearges and boxplot to check the spread. ","df2d864f":"Values do indeed seem reasonable. ","f5359687":"df4 and df5 are missing distopia residual. when I check through sample calculation it seems that we can find it by subtracting all other values from the Happiness score like in the example below fro Finland in df5 :\n\n7.769-1.340-1.587-0.986-0.596-0.153-0.393= 2.714\n\nThis seems to be a reasonable value when Icompare it with the residuals from the first 3 data frames. I will therefor make a residual columns for df4 and df5.","d38b827a":"# Data preprocessing\n\nI will work with 5 dataframes (2015-2019). \n\nIn order to be able to perform comparative analysis between different years I need to preprocess my data first. \n\nI will be checkign for the null values and making sure that I have same columns across dataframes. \n\nFor the purpose of comparative analyis I will keep only those  countries that are in common for all 5 dataframes. I assume that there will not be many of those that are different as I do not want to drop too many data.I will adjust my dataframes and saved them under new names. In these new dataframes I will also add the region.\n\n","c98545d0":"I will repeat the same for df4_new and df5_new.","eabd7ef9":"Now we have same columns. Let's check for null data and data types.","bda48b6e":"I will import my original data and usefor them for the initial geoplots. They will give me an overal picture.","00f8d335":"# Conclusion \n\nIn this project we were able to see how the happines score have changed over years and accross continents. We also have seen how the mean value can be deceiving. While Africa has the lowest happiness score, it's happines score has inceasing trend over years and it is to expect that it will grow (the general feelings or living conditions are changing towards better). On the other hand it looks that North and Latin America are experincing the negative trend and unless soemthing is done it will proobably stay negative. \n\nOne thing to consider is the population affected by the happiness score.For example Honduras contributes evenly to the mean score of Latin America and it has relatively large percentage growth but smaller population. On the other hand Argentina has around 25 times larger population and it has negative happiness score. So,Honduras score is driving the mean up while actually the smaller number of people are affected by this positive score and much larger numer of people have been afected by the negative score. ","d425592a":"I would like to see the score accross continets and over years.In order to do that I will add the year column to each data frame and concatenate them. I will use only country,region,score, and year column for my new data set.  ","8b14da2b":"From here I can see that some countries have similar names. I will drop only those countries that are actusally different countries and I will rename ones that have simlar names.","6f04be44":"From here we can see that the Oceania has the smallest spread and the higest values.\n\nWestern Europe has the third overall score but relatively large range which worns us of high variability in thew happiness scores accros countries in this region.That is especially visible in the lowest 25% of the scores. \n\nThe range of score (max-min) has been increasing over time in Southern Asia and Central and Eastern Europe. That tells us that the variability of happiness index has been increasing over years which is not a good indicator. \n\nLatin America has realtively small range but a lot of outliers(extreme values). In 2019 the range is smallest but the happiness index is also the smallest. that just tells us that the scores are becoming more similar accross the region and they're dropping.\n\nThe most variability we can see in the Middle east and Northern Africa region.","2061fb50":"# Context\n\nThe World Happiness Report is a landmark survey of the state of global happiness. The first report was published in 2012, the second in 2013, the third in 2015, and the fourth in the 2016 Update. The World Happiness 2017, which ranks 155 countries by their happiness levels, was released at the United Nations at an event celebrating International Day of Happiness on March 20th. The report continues to gain global recognition as governments, organizations and civil society increasingly use happiness indicators to inform their policy-making decisions. Leading experts across fields \u2013 economics, psychology, survey analysis, national statistics, health, public policy and more \u2013 describe how measurements of well-being can be used effectively to assess the progress of nations. The reports review the state of happiness in the world today and show how the new science of happiness explains personal and national variations in happiness.\n\nContent\n\nThe happiness scores and rankings use data from the Gallup World Poll. The scores are based on answers to the main life evaluation question asked in the poll. This question, known as the Cantril ladder, asks respondents to think of a ladder with the best possible life for them being a 10 and the worst possible life being a 0 and to rate their own current lives on that scale. The scores are from nationally representative samples for the years 2013-2016 and use the Gallup weights to make the estimates representative. The columns following the happiness score estimate the extent to which each of six factors \u2013 economic production, social support, life expectancy, freedom, absence of corruption, and generosity \u2013 contribute to making life evaluations higher in each country than they are in Dystopia, a hypothetical country that has values equal to the world\u2019s lowest national averages for each of the six factors. They have no impact on the total score reported for each country, but they do explain why some countries rank higher than others.\n\nInspiration\n\nWhat countries or regions rank the highest in overall happiness and each of the six factors contributing to happiness? How did country ranks or scores change between the 2015 and 2016 as well as the 2016 and 2017 reports? Did any country experience a significant increase or decrease in happiness?\n\nWhat is Dystopia?\n\nDystopia is an imaginary country that has the world\u2019s least-happy people. The purpose in establishing Dystopia is to have a benchmark against which all countries can be favorably compared (no country performs more poorly than Dystopia) in terms of each of the six key variables, thus allowing each sub-bar to be of positive width. The lowest scores observed for the six key variables, therefore, characterize Dystopia. Since life would be very unpleasant in a country with the world\u2019s lowest incomes, lowest life expectancy, lowest generosity, most corruption, least freedom and least social support, it is referred to as \u201cDystopia,\u201d in contrast to Utopia.\n\nWhat are the residuals?\n\nThe residuals, or unexplained components, differ for each country, reflecting the extent to which the six variables either over- or under-explain average 2014-2016 life evaluations. These residuals have an average value of approximately zero over the whole set of countries. Figure 2.2 shows the average residual for each country when the equation in Table 2.1 is applied to average 2014- 2016 data for the six variables in that country. We combine these residuals with the estimate for life evaluations in Dystopia so that the combined bar will always have positive values. As can be seen in Figure 2.2, although some life evaluation residuals are quite large, occasionally exceeding one point on the scale from 0 to 10, they are always much smaller than the calculated value in Dystopia, where the average life is rated at 1.85 on the 0 to 10 scale.\n\nWhat do the columns succeeding the Happiness Score(like Family, Generosity, etc.) describe?\n\nThe following columns: GDP per Capita, Family, Life Expectancy, Freedom, Generosity, Trust Government Corruption describe the extent to which these factors contribute in evaluating the happiness in each country. \nThe Dystopia Residual metric actually is the Dystopia Happiness Score(1.85) + the Residual value or the unexplained value for each country as stated in the previous answer.\n\nIf you add all these factors up, you get the happiness score so it might be un-reliable to model them to predict Happiness Scores.\n\n","c5d5ef56":"I will cpompare the average residual for df4 and df5 with residuals from previous years to check if the values seems reasonable.","d7b3ebf7":"I will rename columns and drop columns that are not in common (except from region). I will save those dataframes as df1_new,df2_new... ","864688d4":"I will now add region column to df3,df4 and df5. As the order of countries is the same I can simply assign the new column using the df1_new['region]. I will also change the order of columns.","2d2b27f2":"# Investigating countries","be5a2317":"I will now compare df1_comp with the rest of df and I hope that I will not have to delete many more  coumns from df1_comp","20fc1911":"So from here I see that the statement from before that South America is witnessing the steady drop in happines score is True. Less countries had an increase in happines score over the last 5 years and the positive growth is smaller than the negative growth.","8f347f53":"We can also see that the leading country is Benin with 46% increase in happines score. Out of 11 top countries that have witnessed the prercentage growth, 9 of them is in Sub-Saharan Africa. This actually confirms the fact that there wasa steady growth in the happoness index from 2015-2019 in that region . ","3dd5601f":"There are no null data and all numbers are floats. \n\nBut the df3_new has 155 countires and the df1_new has\n158 countries. The next step is to reduce the number of countries \nto the highest common number of countries for all datasets. I will start by comparing df3_new( because it has the smallest number of data )with the  df1_new( largest number of data.)","96f302e2":"We can notice that the column family has been replaced with the Social support but the values are very similar. I believe that it is safe to assume that those columns represent the same thing as sometimes people consider very close friend the family and probably think of them as of family. So I will treat these 2 columns as they're representing the same thing.\n\nThere are 8  common columns amongst these 5 dataframes:\n-country or region,score,GDP,Family\/social support,life expectancy,freedom to make choices,generosity and perception of corruption.There is no region column in the last 3 dataframes and I think that it is an important coulumn my future analysis. I will add the region column after I clean my datasets. ","8e5677ec":"Treemaps are a nice visual way pof presenting quantities. In this case are and color are indicating the happiness score. However,it is not easy from here to say which countries have increased their happiness score and vice versa. For that,I will create the growth index. Growth index will be a sum of all differences in score of successive years, which is equivalent to score 2019-2015.  If the sum is negative there has been more drop in the score than rise for that country and vise versa. \n\nThere is no need to this for regions as we can see from bar charts above that the only region that had extreme up and downs is North America.","a3232e69":"I will use red color scale, with dark red being the highest score and light red lowest. Having one color will help me to see easier what are the differences in the score across the globe. ","6c961daf":"The percentage of countries that have drop of 20% or more in happiness score is less than the number of countries with the increase in the score. Venezuela had the highest drop of 30%. Some other Latin American countries are on the list of countries with negative growth percentage(Haiti, Brazil, Argentina). Let's look more into the Latin America and Caribbean","d462a85a":"So, we can now merge those dataframes if needed. But first let me reset the index","b8d7d8f0":"# Investigating regions\n\nThis part of the investigation will focus on visualizing data and data distribution. I will use geoplots, histograms, Q-Q plots for testing data normality and box and whisker plots to get better insight on data\n\n","06baa532":"From above I can see that Iwill need to delete 3 more countries from df1_comp and df3_comp and 9 countries from df2_comp","fd8aac47":"So we need to rename 2 countries in df4_comp as Trinidad and Tobago and NOrth Cyprus have been used in df1, df2 and df3 . We also need to delete 8 countries from df4_comp","5595bd19":"- From histograms and q-q plots above we can see that the distribution is somewhat normal acrross regions. \n- North America and Australia and NZ are an exception as they have only 2 countries each. Scores for those countries for each region are very close to another so it will be appropriate to use mean as a measure of central tendency for thise 2 regions.\n\n- The smallest scores are obviously present in Sub-Saharan Africa, followed by Southern Asia. From box-and-whisker plots we can see that Sub-Saharan Africa has an outlier. I will check that. \n- the highest scores are in North America and Australia and NZ, folowed by Western Europe and Latin America and Caribbean\n\n- as for the shape of distributions we can see that the W.Europe and Latin Am.and Caribbean are negatively skewed, meaning that they have larger number of countries with the high score over the smaller interval. That can be also seen on Q-Q plots( points on the left are more off the line) and through box plots (lower tail is longer than the upper one, meaning that the lowest 25% of scores are spread over a bigger interval )\n- Southeastern and Eastern Asia are slightly positively skewewd menaing that the top 50% of values are spread along the bigger interval\n\n- Middle east and Northern Africa has the largest range and the largest IQR which indicated that data are more spread than in other regions . Therefore more uneven. Similar situatuion is in Central and easter Europe and Sub-Saharan Africa. \n\nUsing plotting function it is easy to see that the situation accross regions is similar for other years. ","1a47e173":"From the plot above we can see that Sub-Saharan Africa, Western and  Central and Eastern Europe have witnessed highest overall and constant increase in average Happiness index over years.All have witnessed their highest score in 2019 but at the same time Sub-SaharanAfrica had the lowest happiness score in the world.\n\nOn the other hand the avearage happiness index in North and Latin America has been in constant decrease over the years. North America ahs the second highest score in the world though. \n\nOceania has the most stable index and by far the highest average happiness index in the world.\n\nSouthern Asia, Southeatsern Asia and Middle East and Northern Africa have varying happiness score that has been dropping over the past 3 years. \n\nSouthern Asia also has the second lowest score in the world.\n\n\nIt would be interesting to compare averages for all years. "}}