{"cell_type":{"21db420a":"code","0836aa52":"code","dc51b7d2":"code","3aee7f68":"code","77d2d982":"code","7b79baf9":"code","57721cd4":"code","c348d511":"code","980f45ba":"code","10f34113":"code","af678b05":"code","ed9c6910":"code","e0a27462":"code","13b2889f":"code","46bd5fe7":"code","bed62972":"code","c59efd17":"code","49cd059f":"code","14bb97e6":"code","ab0fc7c9":"code","824111e0":"code","0bef6481":"code","67597036":"code","2eb2037c":"code","22aee323":"code","7667093c":"markdown","0a03d901":"markdown","ad9995d9":"markdown","41798a37":"markdown","d4b12f1c":"markdown","29c368de":"markdown","854e9ff2":"markdown","34ac4126":"markdown"},"source":{"21db420a":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression, Lasso\nfrom sklearn import metrics","0836aa52":"df = pd.read_csv(\"..\/input\/vehicle-dataset-from-cardekho\/car data.csv\")","dc51b7d2":"df.head()","3aee7f68":"df.shape","77d2d982":"df.isnull().sum()","7b79baf9":"# DIstribution of Features.\ndf['Fuel_Type'].value_counts()","57721cd4":"df['Seller_Type'].value_counts()","c348d511":"df['Transmission'].value_counts()","980f45ba":"# Encoding \"Fuel_Type\"\ndf.replace({'Fuel_Type' : {'Petrol' : 0, 'Diesel' : 1, 'CNG': 2}}, inplace = True)","10f34113":"df.head()","af678b05":"# Encoding \"Seller_Type\"\ndf.replace({'Seller_Type' : {'Dealer' : 0, 'Individual' : 1}}, inplace = True)","ed9c6910":"# Encoding \"Transmission\"\ndf.replace({'Transmission' : {'Manual' : 0, 'Automatic' : 1}}, inplace = True)","e0a27462":"df.head()","13b2889f":"# Split into X and y\nX = df.drop(['Car_Name', 'Selling_Price'], axis = 1) # axis = 1 is equivalent to axis = 'column'\ny = df['Selling_Price']","46bd5fe7":"X_train, X_valid, y_train, y_valid = train_test_split(X, y, test_size = 0.3, random_state = 99)","bed62972":"model_lr = LinearRegression()","c59efd17":"model_lr.fit(X_train, y_train)","49cd059f":"pred_lr = model_lr.predict(X_valid)","14bb97e6":"# R Squared Error\nerror_score_valid = metrics.r2_score(y_valid, model_lr.predict(X_valid))\nerror_score_train = metrics.r2_score(y_train, model_lr.predict(X_train))\n\nerror_score_train, error_score_valid","ab0fc7c9":"plt.scatter(y_valid, pred_lr)\nplt.xlabel(\"Actual Price\")\nplt.ylabel(\"Predicted Price\")\nplt.title(\"Actual Vs Predicted Car Price\")\nplt.show()","824111e0":"plt.scatter(y_valid, pred_lr, label = 'Valid')\nplt.scatter(y_train, model_lr.predict(X_train), label = 'Train')\nplt.xlabel(\"Actual Price\")\nplt.ylabel(\"Predicted Price\")\nplt.title(\"Actual Vs Predicted Car Price\")\nplt.show()","0bef6481":"model_lasso = Lasso()","67597036":"model_lasso.fit(X_train, y_train)","2eb2037c":"# R Squared Error\nprint(metrics.r2_score(y_valid, model_lasso.predict(X_valid)))\nprint(metrics.r2_score(y_train, model_lasso.predict(X_train)))","22aee323":"plt.scatter(y_valid, model_lasso.predict(X_valid))\nplt.xlabel(\"Actual Price\")\nplt.ylabel(\"Predicted Price\")\nplt.title(\"Actual Vs Predicted Car Price\")\nplt.show()","7667093c":"\nThis dataset contains information about used cars.\nThis data can be used for a lot of purposes such as price prediction to exemplify the use of linear regression in Machine Learning.\nThe columns in the given dataset are as follows:\n\n* name\n* year\n* selling_price\n* km_driven\n* fuel\n* seller_type\n* transmission\n* Owner","0a03d901":"# Visualize actual price and predicted price","ad9995d9":"# Convert Categorical to Numeric (Encoding)","41798a37":"# Load Data","d4b12f1c":"# Model\n## 1. Linear Regresion","29c368de":"# Model Evaluation","854e9ff2":"# Data PreProcessing","34ac4126":"## LASSO Regression"}}