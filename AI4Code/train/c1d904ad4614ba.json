{"cell_type":{"70f80ff1":"code","6e072911":"code","3cceb769":"code","e3b4baeb":"code","ced046fe":"code","8e3cc439":"code","d80f12a0":"code","725b4468":"code","4643a51c":"code","30f9c6fe":"code","acb29848":"code","6e6da0cd":"code","297903c9":"code","e6c07593":"code","af3f5f09":"code","c5ed6931":"code","4c7be07a":"code","179ab342":"code","cfe6ac33":"code","1ae42212":"code","8ef938db":"code","707694c0":"code","8b8f8304":"code","d940a8b6":"code","a74af460":"code","69818743":"code","711a743a":"code","7bd44db8":"code","e012a86a":"code","517730e1":"code","d181d0b5":"code","447b4562":"code","e3742b9b":"code","5dca819f":"code","47d5ea58":"code","2125f143":"code","1bd27242":"code","2c5d34de":"code","8cc68106":"code","5d210375":"code","9127fab6":"code","49312334":"code","8b984fc4":"code","935af053":"code","036f9c95":"markdown","af3242d8":"markdown","a7ab877e":"markdown","4e0c3f21":"markdown","e3157f97":"markdown","9399a0b1":"markdown","418d8d7e":"markdown","cb127de2":"markdown","80a8d0e1":"markdown"},"source":{"70f80ff1":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","6e072911":"import pandas as pd\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nimport numpy as np\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.svm import SVC\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import confusion_matrix, classification_report\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\n%matplotlib inline","3cceb769":"df = pd.read_csv('..\/input\/clothessizeprediction\/final_test.csv')\ndf.shape","e3b4baeb":"df.isna().sum()","ced046fe":"df.dropna(how='any', inplace=True)\ndf.shape","8e3cc439":"df.isna().sum()","d80f12a0":"sns.pairplot(data=df, hue='size', height=7)\nplt.show()\n","725b4468":"plt.style.use('seaborn')\nsns.countplot(x=df['size'])\nplt.show()","4643a51c":"df.head()","30f9c6fe":"df['size'].value_counts()","acb29848":"dfs = []\nsizes = []\nfor size_type in df['size'].unique():\n    print('size type:',size_type)\n    sizes.append(size_type)\n    ndf = df[['age','height','weight']][df['size'] == size_type]\n    zscore = ((ndf - ndf.mean())\/ndf.std())\n    dfs.append(zscore)","6e6da0cd":"for i in range(len(dfs)):\n    print(sizes[i])\n    dfs[i]['age'] = dfs[i]['age'][(dfs[i]['age']>-3) & (dfs[i]['age']<3)]\n    dfs[i]['height'] = dfs[i]['height'][(dfs[i]['height']>-3) & (dfs[i]['height']<3)]\n    dfs[i]['weight'] = dfs[i]['weight'][(dfs[i]['weight']>-3) & (dfs[i]['weight']<3)]","297903c9":"for i in range(len(sizes)):\n    dfs[i]['size'] = sizes[i]","e6c07593":"new_df = pd.concat(dfs)","af3f5f09":"new_df.head()","c5ed6931":"new_df['age'][new_df['age']<-3]","4c7be07a":"new_df['height'][new_df['height']<-3]","179ab342":"new_df['weight'][new_df['weight']<-3]","cfe6ac33":"plt.style.use('seaborn')\nsns.countplot(x=new_df['size'])\nplt.show()","1ae42212":"sns.pairplot(data=new_df, hue='size', height=7)\nplt.show()","8ef938db":"new_df['size'].value_counts()","707694c0":"new_df2 = new_df[new_df['size'] != 'XXL'].copy()","8b8f8304":"new_df2.dropna(how='any', inplace=True)","d940a8b6":"plt.style.use('seaborn')\nsns.countplot(x=new_df2['size'])\nplt.show()","a74af460":"sns.pairplot(data=new_df2, hue='size', height=7)\nplt.show()","69818743":"new_df2['size'].unique()","711a743a":"size_code = {\n    'XL':0,\n    'L':1,\n    'M':2,\n    'S':3,\n    'XXS':4,\n    'XXXL':5\n}\nnew_df2['size'].replace(size_code, inplace=True)","7bd44db8":"new_df2['size'].value_counts()","e012a86a":"x, y = new_df2.drop('size', axis=1), new_df2['size']","517730e1":"x.shape,y.shape","d181d0b5":"x_train, x_test, y_train,y_test = train_test_split(x, y, test_size=0.25)","447b4562":"x_train.shape, x_test.shape","e3742b9b":"y_train.shape, y_test.shape","5dca819f":"sns.countplot(x=y_train)\nplt.show()","47d5ea58":"sns.countplot(x=y_test)\nplt.show()","2125f143":"KNN_model2 = KNeighborsClassifier(n_neighbors=7, metric='manhattan', weights='distance')\nKNN_model2.fit(x_train, y_train)","1bd27242":"KNN_model2.score(x_test, y_test)","2c5d34de":"KNN_model2.score(x_train, y_train)","8cc68106":"y_pred = KNN_model2.predict(x_test)","5d210375":"print(classification_report(y_test, y_pred))","9127fab6":"y_pred_train = KNN_model2.predict(x_train)","49312334":"print(classification_report(y_train, y_pred_train))","8b984fc4":"from joblib import dump\ndump(KNN_model2, 'Cloth-size-predictor')","935af053":"!ls","036f9c95":"# **KNN Model**","af3242d8":"# **Splitting and training**","a7ab877e":"# **Oulier Removal Z-score**","4e0c3f21":"# **Removing Outliers**","e3157f97":"# **No Outliers**","9399a0b1":"# **Saving model as file.**","418d8d7e":"# **94% accuracy**","cb127de2":"# **Removing XXL size because of less count**","80a8d0e1":"# **Dropping NaN values**"}}