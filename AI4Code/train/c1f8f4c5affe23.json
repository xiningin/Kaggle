{"cell_type":{"b480e7d2":"code","0d960840":"code","339bb47a":"code","73a6a89c":"code","ee56532f":"code","a9a73b50":"code","480d8004":"code","5a6daf6f":"code","b96fad4d":"code","72b19784":"code","dbb67d33":"code","a974be50":"code","e91a9c5b":"code","ffd12f41":"code","a355ab6c":"code","982e26b3":"code","b7ce7aad":"code","7a132127":"code","1ac722a0":"code","886c4966":"code","f5f7a784":"code","b9335de9":"code","20b6f779":"code","ffd22cfe":"code","01629f74":"markdown"},"source":{"b480e7d2":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","0d960840":"df = pd.read_csv('\/kaggle\/input\/creditcardfraud\/creditcard.csv')","339bb47a":"df.info()","73a6a89c":"df.head()","ee56532f":"df.tail()","a9a73b50":"pd.set_option('display.float_format', lambda x: '%.3f' % x)\ndf.describe()","480d8004":"!pip install pycaret","5a6daf6f":"df['Class'].value_counts()","b96fad4d":"df_sample_0 = df.loc[df.loc[:, 'Class'] == 0].sample(frac=0.01, random_state=25)\ndf_sample_0.shape","72b19784":"df_1 = df.loc[df.loc[:, 'Class'] == 1]\ndf_sample = df_sample_0.append(df_1)\ndf_sample = df_sample.sample(frac=1)\ndf_sample['Class'].value_counts()","dbb67d33":"from pycaret.classification import *","a974be50":"clf1 = setup(data = df_sample, \n            target = 'Class',\n            silent=True,\n            sampling=False)","e91a9c5b":"compare_models(fold=10)","ffd12f41":"model  = create_model('catboost')","a355ab6c":"tunedModel = tune_model('catboost', fold=5, optimize=\"F1\")","982e26b3":"plot_model(estimator = tunedModel, plot = 'class_report')","b7ce7aad":"plot_model(estimator = tunedModel, plot = 'auc')","7a132127":"plot_model(estimator = tunedModel, plot = 'confusion_matrix')","1ac722a0":"plot_model(estimator = tunedModel, plot = 'feature')","886c4966":"plot_model(estimator = tunedModel, plot = 'parameter')","f5f7a784":"calibratedModel = calibrate_model(tunedModel)\n# Taking 30min of time; can change params","b9335de9":"#predictions = predict_model(tuned_model, data=test)\n#predictions.head()","20b6f779":"finalModel = finalize_model(tunedModel)","ffd22cfe":"rfC  = create_model('rf');\netC  = create_model('et');\nxgbC = create_model('xgboost');\n\n#blending 3 models\nblendedModels = blend_models(estimator_list=[rfC, etC, xgbC])","01629f74":"From the above, it's very clear that the data is highly imbalanced towards to non-fraud class."}}