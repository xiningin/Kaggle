{"cell_type":{"ebebd1ed":"code","d364bfa2":"code","ab88d80c":"code","82fa2dff":"code","5d63b6d1":"code","62f23296":"code","87f9c4d4":"code","4c323630":"code","ec1a1516":"code","ebeab672":"code","1717347a":"code","89f2ee53":"code","5ff923a6":"code","e0640e9e":"code","0bfe0d73":"code","490adaf4":"code","e67598b2":"code","74bf0891":"code","22037bed":"markdown","9135f7bd":"markdown","3d85b798":"markdown","7593cacf":"markdown"},"source":{"ebebd1ed":"import numpy as np\nimport pandas as pd\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\nfrom pathlib import Path\nfrom fastai import *\nfrom fastai.vision import *","d364bfa2":"data_folder = Path(\"..\/input\/\")","ab88d80c":"data_folder.ls()","82fa2dff":"train_df = pd.read_csv(data_folder\/'train.csv')\ntest_df = pd.read_csv(data_folder\/'sample_submission.csv')","5d63b6d1":"test_data = ImageList.from_df(test_df, path=data_folder, folder='test_images', suffix='.png')","62f23296":"data = (ImageList.from_df(train_df, path=data_folder, folder='train_images', suffix = '.png')\n                 .split_by_rand_pct(0.1)  \n                 .label_from_df()\n                 .add_test(test_data)              \n                 .transform(get_transforms(flip_vert=True), size=128)\n                 .databunch(path='.', bs=32)\n                 .normalize(imagenet_stats)\n       )","87f9c4d4":"data.show_batch(3)","4c323630":"learner = cnn_learner(data, models.resnet18, pretrained=False, metrics=[accuracy])","ec1a1516":"learner.lr_find()\nlearner.recorder.plot()","ebeab672":"learner.fit_one_cycle(5, 1e-3)","1717347a":"learner.recorder.plot_losses()\nlearner.recorder.plot_metrics()","89f2ee53":"learner.unfreeze()","5ff923a6":"learner.lr_find()\nlearner.recorder.plot()","e0640e9e":"learner.fit_one_cycle(10, 1e-3)","0bfe0d73":"learner.recorder.plot_losses()\nlearner.recorder.plot_metrics()","490adaf4":"preds,_ = learner.get_preds(ds_type=DatasetType.Test)","e67598b2":"test_df.diagnosis = preds.argmax(1)\ntest_df.head()","74bf0891":"test_df.to_csv('submission.csv', index=False)","22037bed":"## Create the Learner and train","9135f7bd":"# Import the libraries","3d85b798":"## Predict and submit","7593cacf":"## Get the data"}}