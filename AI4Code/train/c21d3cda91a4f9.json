{"cell_type":{"1e7c600b":"code","18d10221":"code","57e12cea":"code","420504b5":"code","39e7b479":"code","557fb0cf":"code","af6a1cdb":"code","d869082a":"code","8334e54c":"code","15d0879d":"code","118f8bb3":"code","9e27fe1b":"code","2dc654ba":"code","154ba761":"code","9d14fae2":"code","5e7f7726":"code","e41a4313":"code","fc897f61":"code","bfb79189":"code","3633d85f":"code","a8d6cb81":"code","1451bb36":"code","2941ac20":"markdown","b7c2cf58":"markdown","9b1af798":"markdown","894fea72":"markdown","0c2fc5c4":"markdown","62f513db":"markdown","fd0abf21":"markdown","e73b25d9":"markdown","b941f115":"markdown","aa7e1a9e":"markdown","5d05986a":"markdown","348ed00a":"markdown","12964fa8":"markdown","289a4ca3":"markdown","40ce0d7b":"markdown","e6060c56":"markdown","ad49de25":"markdown"},"source":{"1e7c600b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","18d10221":"# importing important libraries\nimport re\nimport pandas as pd\n\n# Making a sample example with all the variations of the date.\ndateStr = \"23-10-2002\\n23\/10\/2002\\n23\/10\/02\\n10\/23\/2002\\n23 Oct 2002\\n23 October 2002\\nOct 23, 2002\\nOctober 23, 2002\\n\"\nprint(dateStr)","57e12cea":"re.findall(r'\\d{2}[\/-]\\d{2}[\/-]\\d{4}', dateStr) # This will return a list of all the dates with '\/' or '-' in between.","420504b5":"re.findall(r'\\d{2}[\/-]\\d{2}[\/-]\\d{2,4}', dateStr)","39e7b479":" re.findall(r'\\d{2} (?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\d{4}', dateStr)","557fb0cf":"re.findall(r'\\d{2} (?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]* \\d{4}', dateStr)","af6a1cdb":"doc = []\nwith open('..\/input\/textdata\/dates.txt') as file:\n    for line in file:\n        doc.append(line)\n\ndf = pd.Series(doc)\ndf.head()","d869082a":"# Extracting the dates and storing it as a dataframe\ndates_extracted = df.str.extractall(r'(?P<origin>(?P<month>\\d?\\d)[\/|-](?P<day>\\d?\\d)[\/|-](?P<year>\\d{4}))')\n\n# Marking the index that are used so that it does not get used again when extracting with some other format.\nindex_left = ~df.index.isin([x[0] for x in dates_extracted.index]) \ndates_extracted.head()","8334e54c":"# Extracting the dates and storing it as a dataframe, notice here we are using the index_left to check only those which are left.\ndates_extracted_temp = df[index_left].str.extractall(r'(?P<origin>(?P<month>\\d?\\d)[\/|-](?P<day>([0-2]?[0-9])|([3][01]))[\/|-](?P<year>\\d{2}))')\n\n# Marking the index that are used so that it does not get used again when extracting with some other format.\nindex_left = ~df.index.isin([x[0] for x in dates_extracted.index])\n\n# Deleting the extra unnecessary columns.\ndel dates_extracted_temp[3]\ndel dates_extracted_temp[4]\n\ndates_extracted_temp.head()","15d0879d":"# Appending the values in the main data frame - dates_extracted\ndates_extracted = dates_extracted.append(dates_extracted_temp)","118f8bb3":"dates_extracted = dates_extracted.append(df[index_left].str.extractall(r'(?P<origin>(?P<day>\\d?\\d) ?(?P<month>[a-zA-Z]{3,})\\.?,? (?P<year>\\d{4}))'))\nindex_left = ~df.index.isin([x[0] for x in dates_extracted.index])","9e27fe1b":"dates_extracted = dates_extracted.append(df[index_left].str.extractall(r'(?P<origin>(?P<month>[a-zA-Z]{3,})\\.?-? ?(?P<day>\\d\\d?)(th|nd|st)?,?-? ?(?P<year>\\d{4}))'))\ndel dates_extracted[3]\nindex_left = ~df.index.isin([x[0] for x in dates_extracted.index])","2dc654ba":"dates_extracted.shape","154ba761":"# Without day\ndates_without_day = df[index_left].str.extractall('(?P<origin>(?P<month>[A-Z][a-z]{2,}),?\\.? (?P<year>\\d{4}))')\ndates_without_day = dates_without_day.append(df[index_left].str.extractall(r'(?P<origin>(?P<month>\\d\\d?)\/(?P<year>\\d{4}))'))\n\n# Replacing the missing value with '1'\ndates_without_day['day'] = 1\n\n# Appending in the main dataframe\ndates_extracted = dates_extracted.append(dates_without_day)\nindex_left = ~df.index.isin([x[0] for x in dates_extracted.index])","9d14fae2":"# Only year\ndates_only_year = df[index_left].str.extractall(r'(?P<origin>(?P<year>\\d{4}))')\ndates_only_year['day'] = 1\ndates_only_year['month'] = 1\ndates_extracted = dates_extracted.append(dates_only_year)\nindex_left = ~df.index.isin([x[0] for x in dates_extracted.index])","5e7f7726":"dates_extracted.shape","e41a4313":"# Year\ndates_extracted['year'] = dates_extracted['year'].apply(lambda x: '19' + x if len(x) == 2 else x)\ndates_extracted['year'] = dates_extracted['year'].apply(lambda x: str(x))","fc897f61":"# Month\ndates_extracted['month'] = dates_extracted['month'].apply(lambda x: x[1:] if type(x) is str and x.startswith('0') else x)\nmonth_dict = dict({'September': 9, 'Mar': 3, 'November': 11, 'Jul': 7, 'January': 1, 'December': 12,\n                   'Feb': 2, 'May': 5, 'Aug': 8, 'Jun': 6, 'Sep': 9, 'Oct': 10, 'June': 6, 'March': 3,\n                   'February': 2, 'Dec': 12, 'Apr': 4, 'Jan': 1, 'Janaury': 1,'August': 8, 'October': 10,\n                   'July': 7, 'Since': 1, 'Nov': 11, 'April': 4, 'Decemeber': 12, 'Age': 8})\ndates_extracted.replace({\"month\": month_dict}, inplace=True)\ndates_extracted['month'] = dates_extracted['month'].apply(lambda x: str(x))","bfb79189":"# Day\ndates_extracted['day'] = dates_extracted['day'].apply(lambda x: str(x))","3633d85f":"# Cleaned date\ndates_extracted['date'] = dates_extracted['month'] + '\/' + dates_extracted['day'] + '\/' + dates_extracted['year']\ndates_extracted['date'] = pd.to_datetime(dates_extracted['date'])","a8d6cb81":"dates_extracted.head()","1451bb36":"# Sorting the dates and storing them index wise in a new dataframe object.\ndates_extracted.sort_values(by='date', inplace=True)\ndates_from_text = dates_extracted.loc[dates_extracted.index, 'date']\ndates_from_text","2941ac20":"We are add an additional [a-z]* at the end of month column to check if additional characters are present after the specified match. \n\nExample - October, We matched Oct and then took all that was present after it.","b7c2cf58":"# Diving into real mess\nNow, let's dive into the real dataset and find all the dates in here. Here we will learn about the function ```extractall``` which will be used to create dataframes of the 3 values - month, day and year.","9b1af798":"After this we will look for only years.","894fea72":"This shows that we have 230 complete values in the dataset, we will not extract the dates with missing values starting with without days.","0c2fc5c4":"Now, we are trying to find the format:\n- mm\/dd\/yy\n- mm-dd-yy","62f513db":"# Starting off slow\nWe will first look at how regex can extract information and make Dataframes in sample examples. Let's consider all the dates formats that may exist in any dataset.\n\n## Date variations for 23rd October 2002\n* 23-10-2002\n* 23\/10\/2002\n* 23\/10\/02\n* 10\/23\/2002\n* 23 Oct 2002\n* 23 October 2002\n* Oct 23, 2002\n* October 23, 2002","fd0abf21":"First we are looking at the format:\n- mm\/dd\/yyyy\n- mm-dd-yyyy\n","e73b25d9":"Now, we are considering the text data.","b941f115":"# Cleaning the data\nAs we can see, we have extracted all the dates from the dataset, but the problem arises that we don't have uniform values in the colums. We have numbers and text files both in months column, years are present in both format - yy and yyyy. Now we will deal with this and convert the whole dataset to have uniform values.","aa7e1a9e":"Here we are looking for the characters after the digits in day, ex - October 23rd 2020","5d05986a":"#### I really hope you liked the notebook. Please provide some feedbacks. Thank you.","348ed00a":"# Extracting dates from a real-life dataset\nIn this notebook, we will be working with the messy data and using regex to extract relevant information from the data.\nEach line of the file - dates.txt file corresponds to a medical note. Each note has a date that can be extracted, but each date is encoded in one of the many formats. \n\nWe will look into all the types of dates that can be there and extract them. \nThe goal of this notebook is to correctly identify all of the different date variants encoded in the dataset and to properly normalize them.\n\nHere is the list of some of the variants we might encounter in this dataset:\n- 04\/20\/2009; 04\/20\/09; 4\/20\/09; 4\/3\/09\n- Mar-20-2009; Mar 20, 2009; March 20, 2009; Mar. 20, 2009; Mar 20 2009;\n- 20 Mar 2009; 20 March 2009; 20 Mar. 2009; 20 March, 2009\n- Feb 2009; Sep 2009; Oct 2010\n- 6\/2008; 12\/2009\n- 2009; 2010","12964fa8":"Now we will make a new column named 'date' with our cleaned data.","289a4ca3":"- '\\d'  is used to search for digits [0-9]\n- '{n}' is used to specify the number of matches that have to be there\n\n```findall``` function can be used to get all the data that matches.","40ce0d7b":"We'll look at the format:\n- mm\/dd\/yyyy\n- mm-dd-yyyy \n\nbut, in text form.  Example - 23 Oct 2020","e6060c56":"Notice the difference in both the commands, we have {4} in first command and {2, 4} in second. This facitilates the number of matches that needs to be done. In the first command we strictly want 4 matches of digits but in second command we will take number of matches between 2 and 4.","ad49de25":"In the months column, we are converting all the text into their corresponding numbers. Jan -> 1, Oct -> 10.\nAlso, we are adding some additional words which can be considered as a typo in a real-life dataset. Age -> Aug"}}