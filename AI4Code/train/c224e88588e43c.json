{"cell_type":{"3ab2ab84":"code","efd8e6fd":"code","f0f67787":"code","76cb3267":"code","adef5983":"code","3815c817":"code","1874d18e":"code","c4962e11":"code","36e21ebb":"code","fe505ebb":"code","4b9c033f":"code","bd8c4232":"code","1cadf8fb":"code","63b2cc8d":"code","9cd0a79e":"code","55fe6b84":"code","ae40ee94":"code","f9c3e2dd":"code","3e918d89":"code","c9d13515":"code","4d578e67":"code","0e42a6ae":"markdown","aebcf778":"markdown","417bc41f":"markdown","14faa61d":"markdown","34ca374d":"markdown","e8c53da8":"markdown","2dc0c9bf":"markdown","1a6acb5e":"markdown","6df24ddb":"markdown","876711d6":"markdown","f322c4cc":"markdown"},"source":{"3ab2ab84":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom mlxtend.frequent_patterns import apriori\nfrom mlxtend.frequent_patterns import association_rules","efd8e6fd":"PATH_INPUT = \"\/kaggle\/input\/\"\nPATH_WORKING = \"\/kaggle\/working\/\"\nPATH_TMP = \"\/tmp\/\"","f0f67787":"df_raw = pd.read_csv(f'{PATH_INPUT}data.csv', encoding='iso-8859-1')","76cb3267":"df_raw.shape","adef5983":"!ls -lh {PATH_INPUT}","3815c817":"df_raw.describe(include='all')","1874d18e":"df = df_raw.copy()","c4962e11":"df.query('Quantity < -80000')","36e21ebb":"df.query('Quantity > 80000')","fe505ebb":"basket = df.groupby(['InvoiceNo','Description'])['Quantity'].sum().unstack()\nbasket.shape","4b9c033f":"basket = basket.applymap(lambda x: 1 if x>0 else 0)","bd8c4232":"basket.head(1)","1cadf8fb":"basket.iloc[0].value_counts()","63b2cc8d":"%%time\nitemsets = apriori(basket, min_support=0.005, use_colnames=True)","9cd0a79e":"itemsets.shape","55fe6b84":"itemsets.sort_values('support',ascending=False).head()","ae40ee94":"rules = association_rules(itemsets, metric=\"lift\", min_threshold=1)","f9c3e2dd":"rules.shape","3e918d89":"sns.scatterplot(x='support', y='confidence', hue='lift', data=rules)\nplt.show()","c9d13515":"sns.scatterplot(x='support', y='confidence', hue='leverage', data=rules)\nplt.show()","4d578e67":"rules.sort_values('lift', ascending=False).head(10)","0e42a6ae":"# Modeling","aebcf778":"## Data transformation","417bc41f":"# Preparation","14faa61d":"## Data cleaning","34ca374d":"## Reading data","e8c53da8":"*Ideas: merge the cancelling order back to the original order (not implemented)*","2dc0c9bf":"Success","1a6acb5e":"# Pre-processing ","6df24ddb":"Shape is alright","876711d6":"Replace with 0 and 1","f322c4cc":"We have\n* 25900 invoices\n* 4070 stock codes\n* 4223 description"}}