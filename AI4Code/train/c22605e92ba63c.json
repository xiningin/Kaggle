{"cell_type":{"d86e362a":"code","a9b9fa5b":"code","6ac5cd95":"code","dcfd05f6":"code","7ff8ee8d":"code","0cdcf7e5":"code","aa1a3829":"code","4e106372":"code","ac6a8d34":"code","f51cc9d7":"code","048cc5ce":"code","5c25b177":"code","7652ba87":"code","12ada4bb":"code","dcb4aa22":"code","a4c3fb6e":"code","c0e0caa3":"code","47c012bb":"code","5dc0c0b5":"code","ab10300e":"code","cd07f179":"code","9aa453b7":"code","2a1001f5":"code","77f90d6b":"code","157bf957":"code","8cf714ba":"code","1a9c7562":"code","d5b71945":"code","c060b231":"code","bf922124":"code","2675fde5":"code","220c5848":"code","4800e270":"code","0e953957":"code","c34854ec":"code","c295b242":"code","666fcf36":"code","7019f95e":"code","3fdcf68b":"code","ba978454":"code","8f6868f9":"code","01526f46":"code","02b9e45d":"code","7e2db55f":"code","ca50fc78":"code","f9bad696":"code","9a841d0b":"code","28f65542":"code","a4ceb1c4":"code","c81a7b50":"code","2c2bc0cb":"code","9481e5d0":"code","932bec6f":"code","824c5caa":"code","965170b7":"code","22047b82":"code","d7c073c1":"code","abe5be67":"code","38a0fec8":"code","eda60099":"code","9cc50b2d":"code","9d9d61cc":"code","eaa6c8d4":"code","c5168c32":"code","1eb39944":"code","37c52fdd":"code","3f09a74a":"code","ef9e6f95":"code","c8294407":"code","5d560d57":"code","2fc28249":"code","786acf7e":"code","f4037cd1":"code","7eea3028":"code","7a1d4136":"code","dfa675a2":"markdown","c60188cd":"markdown","f5c8c609":"markdown","e9c3ab78":"markdown","975ed372":"markdown","75094d77":"markdown","f4edc2f1":"markdown","4629e7ee":"markdown","e7a383c0":"markdown","11ca195d":"markdown","468a0dc3":"markdown","bbded161":"markdown","d863a0dc":"markdown","cf567064":"markdown","fb9413e0":"markdown","eb54f4e2":"markdown","73695902":"markdown","de492607":"markdown","1a4cfe44":"markdown","c788bbf0":"markdown","03007e57":"markdown","02d134e8":"markdown","fdd5a6b6":"markdown","78a9f75b":"markdown","9e4b84fa":"markdown","343363bf":"markdown","d38e069f":"markdown","f3aa72d2":"markdown","d53b2fdd":"markdown","608ffc52":"markdown","84dc86a0":"markdown","9f142434":"markdown","6eed4045":"markdown","18344970":"markdown","45db3344":"markdown","786bda8e":"markdown","34e5c56b":"markdown","145b47c3":"markdown","fd2e18ca":"markdown","72386477":"markdown","a5886cf1":"markdown","4a116e4a":"markdown","0fc3ed54":"markdown","b369d188":"markdown","3540992b":"markdown","4d973ca9":"markdown","17d41286":"markdown","a51f7571":"markdown","9217b0d6":"markdown","a58f7476":"markdown","9fcaa114":"markdown","39b56fa5":"markdown","2071b846":"markdown","28b8328f":"markdown","a31e781b":"markdown","5fab158c":"markdown","8131402d":"markdown","31d8ffc3":"markdown","507de58e":"markdown","f860a149":"markdown","34e009f5":"markdown"},"source":{"d86e362a":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","a9b9fa5b":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nplt.style.use('ggplot')\nsns.set_style(\"whitegrid\")\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import GridSearchCV, RandomizedSearchCV\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\n\nfrom sklearn.linear_model import Ridge, Lasso\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.svm import SVR\nfrom xgboost import XGBRegressor\n\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.metrics import r2_score\n","6ac5cd95":"df = pd.read_csv('\/kaggle\/input\/pizza-price-prediction\/pizza_v2.csv')\ndf.head()","dcfd05f6":"df.info()","7ff8ee8d":"df['price_rupiah'] = df['price_rupiah'].replace(',','')","0cdcf7e5":"df.head()","aa1a3829":"#create a new column that will include the price \ndf['price'] = df['price_rupiah'].replace(',', '').apply(lambda x: x[2:])","4e106372":"df = df.drop('price_rupiah', axis=1)","ac6a8d34":"df['price'] = df['price'].apply(lambda x: x.replace(',',''))","f51cc9d7":"df['price'] = df['price'].astype('int64')","048cc5ce":"#remove 'inch' from the diameter column\ndf['diameter'] = df['diameter'].apply(lambda x: x.replace('inch',''))","5c25b177":"df['diameter'] = df['diameter'].astype('float')","7652ba87":"df.head()","12ada4bb":"df.describe()","dcb4aa22":"sns.displot(x='diameter', data=df, kde=False)\nplt.title('Diameter distribution')\nplt.show()","a4c3fb6e":"sns.displot(x='price', data=df)\nplt.title('Price distribution')\nplt.show()","c0e0caa3":"df['topping']","47c012bb":"df['topping'] = df['topping'].replace('papperoni','pepperoni')\ndf['topping'] = df['topping'].replace('black_papper','black_pepper')","5dc0c0b5":"plt.figure(figsize=(5,5))\nax=sns.countplot(y='topping', data=df, palette='viridis');\nplt.title('Toppings')\nplt.show()","ab10300e":"plt.figure(figsize=(7,6))\nsns.boxplot(y='topping', x='price', data=df, palette='viridis')\nplt.title('Price by topping')\nplt.show()","cd07f179":"df[df['topping']=='onion']","9aa453b7":"df[df['price'] > 240000]","2a1001f5":"df['size']","77f90d6b":"df['size'] = df['size'].replace('reguler','regular')","157bf957":"plt.figure(figsize=(5,4))\nsns.boxplot(x='size', y='price', data=df)\nplt.title('Price by size')\nplt.show()","8cf714ba":"df.variant.value_counts()","1a9c7562":"plt.figure(figsize=(7,7))\nsns.boxplot(y='variant', x='price', data=df, palette='mako')\nplt.title('Price by variant')\nplt.show()","d5b71945":"df.info()","c060b231":"sns.countplot(x='extra_sauce', data=df)\nplt.title('Extra sauce?')\nplt.show()","bf922124":"sns.countplot(x='extra_cheese', data=df)\nplt.title('Extra cheese?')\nplt.show()","2675fde5":"sns.countplot(x='extra_mushrooms', data=df)\nplt.title('Extra mushrooms?')\nplt.show()","220c5848":"df.replace(('yes', 'no'), (1, 0), inplace=True)","4800e270":"sns.heatmap(df.corr(), annot=True, cmap='RdBu', vmin=-1, vmax=1);\nplt.title('Correlation Matrix');","0e953957":"sns.stripplot(x='size', y='diameter', data=df)\nplt.title('Diameter vs size')\nplt.show()","c34854ec":"df_jumbo = df[df['size'] == 'jumbo']\ndf_jumbo.head()","c295b242":"df_jumbo.company.value_counts()","666fcf36":"df.company.value_counts()","7019f95e":"sns.displot(x='price', data=df_jumbo)\nplt.title('Price for jumbo pizzas')\nplt.show()","3fdcf68b":"sns.countplot(x='diameter', data=df_jumbo)\nplt.title('Diameter for jumbo pizzas')\nplt.show()","ba978454":"df_jumbo[df_jumbo['diameter']==16]","8f6868f9":"df = df.loc[~((df['size'] == 'jumbo') & (df['diameter'] == 16)),:]","01526f46":"sns.stripplot(x='size', y='diameter', data=df)\nplt.title('Diameter vs size')\nplt.show()","02b9e45d":"df_regular = df[df['size'] == 'regular']\ndf_regular.head()","7e2db55f":"df_regular.info()","ca50fc78":"df_regular.company.value_counts()","f9bad696":"sns.countplot(x='price', data=df_regular)\nplt.title('Regular Pizza price')\nplt.show()","9a841d0b":"sns.countplot(x='diameter', data=df_regular)\nplt.title('Regular Pizza diameter')\nplt.show()","28f65542":"df_regular.variant.value_counts()","a4ceb1c4":"df = df.loc[~(df['size'] == 'regular'),:]","c81a7b50":"df.head()","2c2bc0cb":"df.info()","9481e5d0":"encoded_df = df.copy()","932bec6f":"encoded_df['size'].value_counts()","824c5caa":"encoded_df['size'] = encoded_df['size'].map({'small':'0','medium':'1','large':'2','XL':'3','jumbo':'4'})","965170b7":"categorical_cols = ['topping', 'variant','company']\nencoder = LabelEncoder()\nfor col in categorical_cols:\n    encoded_df[col] = encoder.fit_transform(encoded_df[col])","22047b82":"encoded_df.head()","d7c073c1":"X=encoded_df.drop('price', axis = 1).values","abe5be67":"y=encoded_df['price'].values","38a0fec8":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.25, random_state = 42)","eda60099":"lm_lasso=Lasso(alpha = 1, max_iter = 1000, tol = 1e-3)\nlm_lasso.fit(X_train,y_train)\ny_pred_lm_lasso = lm_lasso.predict(X_test)\nmse_lm_lasso = mean_squared_error(y_test, y_pred_lm_lasso)\nprint(\"RMSE using LASSO: \", np.sqrt(mse_lm_lasso))","9cc50b2d":"rf = RandomForestRegressor()","9d9d61cc":"rf.fit(X_train, y_train)","eaa6c8d4":"y_pred_rf = rf.predict(X_test)","c5168c32":"mse_rf = mean_squared_error(y_test, y_pred_rf)\nprint(\"RMSE using RF: \", np.sqrt(mse_rf))","1eb39944":"print(\"RF R2 score :\", r2_score(y_test,y_pred_rf))","37c52fdd":"xgb = XGBRegressor() ","3f09a74a":"xgb.fit(X_train, y_train) ","ef9e6f95":"y_pred_xgb = xgb.predict(X_test) ","c8294407":"mse_xgb = mean_squared_error(y_pred_xgb, y_test)\nprint(\"RMSE:\" , np.sqrt(mse_xgb))","5d560d57":"print(\"XGBoost R2 score :\", r2_score(y_test,y_pred_xgb))","2fc28249":"plt.figure(figsize = (5,5))\nplt.scatter(y_test, y_pred_lm_lasso, label='LASSO, R2 {:.2f} %'.format(r2_score(y_test, y_pred_lm_lasso)*100))\nplt.scatter(y_test, y_pred_rf, label='RF, R2 {:.2f} %'.format(r2_score(y_test, y_pred_rf)*100))\nplt.scatter(y_test, y_pred_xgb, label='XGBoost, R2 {:.2f} %'.format(r2_score(y_test, y_pred_xgb)*100))\nplt.plot([0, 250000], [0, 250000], linestyle='--')\nplt.axis([0, 250000, 0, 250000])\nplt.xlabel('Y Test')\nplt.ylabel('Predicted Y')\nplt.title('Price Regression by ML models')\nplt.legend(loc='upper left');\nplt.show()","786acf7e":"print(\"RMSE using LASSO: {:.2f} rupiah\".format(np.sqrt(mse_lm_lasso)))\nprint(\"RMSE using RF: {:.2f} rupiah\".format(np.sqrt(mse_rf)))\nprint(\"RMSE using XGBoost: {:.2f} rupiah\".format(np.sqrt(mse_xgb)))","f4037cd1":"print(\"R2 using LASSO: {:.2f} %\".format(r2_score(y_test, y_pred_lm_lasso)*100))\nprint(\"R2 using Random Forest: {:.2f} %\".format(r2_score(y_test, y_pred_rf)*100))\nprint(\"R2 using XGBoost: {:.2f} %\".format(r2_score(y_test, y_pred_xgb)*100))","7eea3028":"encoded_df.drop('price', axis = 1).columns","7a1d4136":"fig, ax = plt.subplots(1,2,figsize=(8,3))\nax[0].barh(xgb.feature_names,xgb.feature_importances_, label='XGBoost', color='blue')\nax[1].barh(rf.feature_names,rf.feature_importances_, label='RF', color='red')\nplt.suptitle('Feature Importance to predict price by XGBoost and Random Forest')\nax[0].set_title('XGBoost')\nax[1].set_title('Random Forest')\nax[0].set_xlabel('Feature Importance (%)')\nax[1].set_xlabel('Feature Importance (%)')\nplt.tight_layout()\nplt.show()","dfa675a2":"We can already see that some numerical features such as price and diameter are saved as strings. They will be changed to int values.<br>","c60188cd":"### Topping analysis","f5c8c609":"So, what makes a pizza jumbo or regular?","e9c3ab78":"There seems to be two mispelling error: 'papperoni' instead of 'pepperoni' and 'black_papper' instead of 'black_pepper'. They will be corrected.","975ed372":"# XGBoost","75094d77":"We dropped 20 regular pizzas and 4 jumbo pizzas (outliers)","f4edc2f1":"# Dataset loading and first analysis","4629e7ee":"There seems to be a mispelled word: 'reguler' instead of 'regular'. It will be corrected.","e7a383c0":"We get the best result in terms of RMSE and R2 by using XGBoost regressor.","11ca195d":"A new dataframe with the encoded features will be created.","468a0dc3":"![image.png](attachment:57848cea-09d9-4ec6-80c6-98ecf9536a96.png)","bbded161":"### Extra-toppings analysis","d863a0dc":"# Exploratory Data Analysis","cf567064":"The different pizza variants are:","fb9413e0":"Diameter:<br>\nThe mean diameter is around 13 inches<br>\nThe minimum diameter is 8 inches<br>\nThe maximum diameter is 22 inches<br>\n\nPrice:<br>\nThe mean price is 87,151 rupiah (around 5.20 euros)<br>\nThe cheapest pizza in the dataset is 23,500 rupiah (1.40 euro)<br>\nThe most expensive one is 248,000 rupiah (14.77 euro)<br>","eb54f4e2":"### Numerical features analysis","73695902":"Now it is possible to perform a regression on the price features of the pizzas.","de492607":"It is still not clear what makes a regular pizza a regular pizza. The size should be related only to the diameter. For this reason, pizza with a regular size will be dropped from the dataframe.","1a4cfe44":"The only pizza with onions is:","c788bbf0":"Like Jumbo pizzas, regular pizzas are only sold by company A and D","03007e57":"**From these plots we can see that on average, most pizzas have extra toppings (mushrooms, cheese and sauce)<br>\nIn particular, the most added toppings is extra cheese**","02d134e8":"**From this plot jumbo and regular pizzas seems to be more expensive. This sounds a bit weird for regular pizzas, since they should be cheaper than larger pizzas like Xl and large. This will be further analyzed later.**","fdd5a6b6":"### Variant analysis","78a9f75b":"Moreover, the size feature could be converted into a numerical feature and analyzed.","9e4b84fa":"# Pizza price prediction","343363bf":"It could be interesting to check if there is a correlation between the variance, toppings and size (categorical variables))","d38e069f":"The price distribition is right skewed as well.","f3aa72d2":"It looks like that diameter is highly correlated with price, while other features does not seem to be correlated.","d53b2fdd":"# Encoding","608ffc52":"# Random Forest model","84dc86a0":"### Is there a correlation between the extra toppings?","9f142434":"What about the variants?","6eed4045":"## Regular pizza analysis","18344970":"The most popular variants are meat_lovers and double_mix.","45db3344":"First, we need to encode the categorical variables.<br>\nTopping and variant would be better to be encoded by One hot encoding since there is no order\/hierarchy among them. However, this would mean to have 40 columns in total, which are too many compared to the number of rows, which are just 105. For this reason, we will encode these columns by LabelEncoder.<br>\nFinally, 'size' will be encoded by label encoder since there actually exists an hierachy\/order among sizes.","786bda8e":"## Data preparation","34e5c56b":"This projects analyzed data about pizza orders, each characterized by different features.<br>\nThe goal of this project is to get interesting insights from the data and develop a prediction model to predict the price of a pizza given some features.","145b47c3":"It looks like there are only 15 jumbo pizzas in the dataset. In particular among these 15, 11 are from the company A while the other 4 are from company D","fd2e18ca":"**Thank you for reading my notebook! Let me known if you have questions or if you want me to check out your works !! ;)**","72386477":"# **Main results summary Dashboard:**","a5886cf1":"To check the correlation between the extra toppings, yes and no will be first substitued by 1 and 0","4a116e4a":"Insights:\n- Small pizza have a diameter of 8 inches \n- Medium pizza have a diameter of 12 inches \n- Large pizza have a diameter of 14 inches \n- XL pizza have a diameter of 17 inches \n\nInterestingly, for 'regular' and 'jumbo' pizzas, the diameter is not fixed.<br>\nThis will be further analyzed.","0fc3ed54":"# Feature importance","b369d188":"# Lasso model","3540992b":"From this plot we can say that:<br>\nDouble signature and double mix pizzas are more expensive than the other pizzas.<br>\nIn particular, double signature pizza date has a large variance.<br>\nClassic and italian veggies are cheaper on average.<br>","4d973ca9":"Most regular pizza sems to have a price around 90000 rupiah, which is close to the overall average (87000)","17d41286":"**Most of regular pizza have a 12 inches diameter**","a51f7571":"Now it is possible to extract useful information of these numerical features:","9217b0d6":"Among jumbo pizzas, the diamater seems higher than 17 inches (XL size pizzas diameter).<br>\nWhat about those jumbo pizzas with a 16 inches diameter?","a58f7476":"It looks like all these pizzas are from the company A, is that so?","9fcaa114":"For what concerns the original dataset, it seems to be banalced among different companies (from A to E)","39b56fa5":"These 4 pizzas have a small diameter despite being a jumbo pizza. They will be considered as outliers and dropped.","2071b846":"The diameter distribution is skewed right","28b8328f":"### Jumbo sized pizza analysis","a31e781b":"From this plot we can say:\n- Pepperoni pizza on average are more expensive than other pizzas.\n- There are some outliers for mozzarella, mushrooms and chicken pizzas.\n- It looks like there is just one onion pizza \n","5fab158c":"We can see that for XGBoost, the most important feature to predict price is 'diameter', while for RF is 'size'. Moreover, we can also see how XgBoost largely use diameter (70%) and extra sauce (20%) to predict the price, while RF spreads more the importance among different features, such as size, diameter and variant.","8131402d":"The most popular toppings among the pizzas are chicken, mushrooms, smoked_beef and mozzarella","31d8ffc3":"The minimum price is 125000 rupiah, which is higher than the average price of all pizzas ( around 87000 rupiah)","507de58e":"# Pizza dataset analysis and price prediction","f860a149":"While the most expensive pizza is:","34e009f5":"### Size analysis"}}