{"cell_type":{"c580cc21":"code","30ff6fd1":"code","491b47f0":"code","eb4f4cd6":"code","9bf657f0":"code","0899ceec":"code","e7a8d3ff":"code","2d8a4918":"code","6c752c8f":"code","238b9402":"code","41dd2490":"code","85ebc83a":"code","c2657ac3":"code","dad969f2":"code","96af3681":"code","db815923":"markdown","110addc4":"markdown","47af1dfa":"markdown","98e041a6":"markdown","67173275":"markdown","c0d2a5ae":"markdown","4570068b":"markdown","b21a75ea":"markdown","6cc69937":"markdown","1eb15b62":"markdown","118cc5ab":"markdown","d10e098c":"markdown"},"source":{"c580cc21":"import pandas as pd","30ff6fd1":"import sqlite3","491b47f0":"address = '..\/input\/soccer\/database.sqlite'\ncon = sqlite3.connect(address)","eb4f4cd6":"df = pd.read_sql('''select * from sqlite_master where type='table'; ''',con)","9bf657f0":"df","0899ceec":"countries = pd.read_sql('''select * from country''', con)\ncountries","e7a8d3ff":"leagues = pd.read_sql('''select * from league''',con)\nleagues","2d8a4918":"leagues = pd.read_sql('''select * from league join country on league.country_id = country.id''',con)\nleagues","6c752c8f":"teams = pd.read_sql('''select * from team''', con)\nteams","238b9402":"teams = pd.read_sql('''select * from team order by team_long_name''', con)\nteams","41dd2490":"teams = pd.read_sql('''select * from team order by team_long_name limit 10''', con)\nteams","85ebc83a":"match = pd.read_sql('''select * from match''', con)\nmatch","c2657ac3":"detailed_matches = pd.read_sql(\"\"\"SELECT Match.id, \n                                        Country.name AS country_name, \n                                        League.name AS league_name, \n                                        season, \n                                        stage, \n                                        date,\n                                        HT.team_long_name AS  home_team,\n                                        AT.team_long_name AS away_team,\n                                        home_team_goal, \n                                        away_team_goal                                        \n                                FROM Match\n                                JOIN Country on Country.id = Match.country_id\n                                JOIN League on League.id = Match.league_id\n                                LEFT JOIN Team AS HT on HT.team_api_id = Match.home_team_api_id\n                                LEFT JOIN Team AS AT on AT.team_api_id = Match.away_team_api_id\n                                WHERE country_name = 'Spain'\n                                ORDER by date\n                                LIMIT 10;\"\"\", con)","dad969f2":"detailed_matches","96af3681":"leages_by_season = pd.read_sql(\"\"\"SELECT Country.name AS country_name, \n                                        League.name AS league_name, \n                                        season,\n                                        count(distinct stage) AS number_of_stages,\n                                        count(distinct HT.team_long_name) AS number_of_teams,\n                                        avg(home_team_goal) AS avg_home_team_scors, \n                                        avg(away_team_goal) AS avg_away_team_goals, \n                                        avg(home_team_goal-away_team_goal) AS avg_goal_dif, \n                                        avg(home_team_goal+away_team_goal) AS avg_goals, \n                                        sum(home_team_goal+away_team_goal) AS total_goals                                       \n                                FROM Match\n                                JOIN Country on Country.id = Match.country_id\n                                JOIN League on League.id = Match.league_id\n                                LEFT JOIN Team AS HT on HT.team_api_id = Match.home_team_api_id\n                                LEFT JOIN Team AS AT on AT.team_api_id = Match.away_team_api_id\n                                WHERE country_name in ('Spain', 'Germany', 'France', 'Italy', 'England')\n                                GROUP BY Country.name, League.name, season\n                                HAVING count(distinct stage) > 10\n                                ORDER BY Country.name, League.name, season DESC\n                                ;\"\"\", con)\nleages_by_season","db815923":"### Table of country","110addc4":"**All tables**","47af1dfa":"![image.png](attachment:image.png)","98e041a6":"> ### Table of match","67173275":"### Some analytics","c0d2a5ae":"#### Sort the teams table based on \"team_long_name\"","4570068b":"### Table of leagues ","b21a75ea":"![image.png](attachment:image.png)","6cc69937":"### show first 10 rows of sorting based on team_long_team","1eb15b62":"### Table of teams","118cc5ab":"### Join with country","d10e098c":"![image.png](attachment:image.png)"}}