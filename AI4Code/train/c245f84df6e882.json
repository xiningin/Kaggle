{"cell_type":{"cbec6c34":"code","5ef79491":"code","2b95f66b":"code","f55f7d2a":"code","7ef72d9f":"code","5a07404e":"code","28f760df":"code","0be9c8d3":"code","78ef4a50":"code","8fe5fda3":"code","d69e0ec6":"code","f31409e8":"code","77e7a463":"code","40accdde":"code","1d6eb022":"code","93f118bd":"code","eefb9fd5":"code","a2595d42":"code","1355a9d1":"code","af0d9a8c":"code","db41f204":"code","3aa189ec":"code","74bfc93a":"code","4513bdae":"code","f1bbb776":"code","ec7649f5":"code","566681d0":"code","62477e3c":"code","a5144d96":"code","fb2f0695":"markdown","f7a396fe":"markdown","11a7bd9c":"markdown","97a02730":"markdown","84f84d3f":"markdown","5658f9e4":"markdown","c15a63e7":"markdown","7921999b":"markdown","0755d47a":"markdown","f6b4f79a":"markdown","e4857ba5":"markdown","715a4555":"markdown","332f79f7":"markdown","2c638034":"markdown","ff22492b":"markdown","791a9511":"markdown","ea1c1012":"markdown","603dcc8c":"markdown","5b6bbb3c":"markdown","2119ea6f":"markdown"},"source":{"cbec6c34":"#Import required libraries\nimport numpy as np \nimport pandas as pd\nimport seaborn as sns\nimport lightgbm as lgb\nimport scikitplot as skplot\nimport matplotlib.pyplot as plt\nfrom imblearn.over_sampling import SMOTE\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix,classification_report\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\nimport warnings\nwarnings.filterwarnings('ignore')\n","5ef79491":"df_train=pd.read_csv(\"..\/input\/aps-failure-at-scania-trucks-data-set\/aps_failure_training_set_processed_8bit.csv\")\ndf_test=pd.read_csv(\"..\/input\/aps-failure-at-scania-trucks-data-set\/aps_failure_test_set_processed_8bit.csv\")\nprint(\"Shape of the datasets...\")\nprint(\"Shape of train dataset:\",df_train.shape)\nprint(\"Shape of the test dataset:\",df_test.shape)","2b95f66b":"df_train.head()","f55f7d2a":"df_test.head()","7ef72d9f":"#Concanate train & test dataset\ndataset=pd.concat(objs=[df_train.drop(columns=[\"class\"]),df_test.drop(columns=[\"class\"])],axis=0)\ndataset.shape","5a07404e":"dataset.head()","28f760df":"dataset.info()","0be9c8d3":"dataset.describe()","78ef4a50":"total_miss_values=dataset.isna().sum().sort_values(ascending=False)\ntotal_miss_values","8fe5fda3":"#Encode labels to 0 & 1\nle=LabelEncoder()\ndf_train[\"class\"]=le.fit_transform(df_train[\"class\"])\ndf_test[\"class\"]=le.transform(df_test[\"class\"])\nprint(\"Target labels are :\",le.classes_);","d69e0ec6":"#Correlation matrix\ndf_train.corr()","f31409e8":"#plot correlation matrix\nf=plt.figure(figsize=(15,15))\nax=f.add_subplot(111)\ncax=ax.matshow(df_train.corr(),interpolation='nearest')\nf.colorbar(cax)\nplt.title('Correlation matrix',fontsize=15)\nplt.show();","77e7a463":"#Train dataset target labels distribution\nplt.figure(figsize=(15,8))\nsns.distplot(df_train[\"class\"]);","40accdde":"# Train dataset\nX_train=df_train.drop(columns=[\"class\"])\ny_train=df_train[\"class\"]\n\n#Test dataset\nX_test=df_test.drop(columns=[\"class\"])\ny_test=df_test[\"class\"]","1d6eb022":"sm=SMOTE(random_state=42)\n#Resample the train dataset\nX_train,y_train=sm.fit_sample(X_train,y_train)\nprint(\"Resampled train dataset shape :\",X_train.shape,y_train.shape);","93f118bd":"# distribution of classes in train dataset\nplt.figure(figsize=(15,8))\nsns.distplot(y_train);","eefb9fd5":"# distribution of classes in test dataset\nplt.figure(figsize=(15,8))\nsns.distplot(y_test);","a2595d42":"df_train.hist(figsize=(16,35),bins=10,xlabelsize=8,ylabelsize=8);","1355a9d1":"lr=LogisticRegression()\nlr.fit(X_train,y_train);","af0d9a8c":"#predict on test data\ny_pred_lr=lr.predict(X_test)","db41f204":"#confusion matrix\ncm=confusion_matrix(y_test,y_pred_lr,labels=[0,1])\ncm","3aa189ec":"#Plot confusion matrix\nskplot.metrics.plot_confusion_matrix(y_test,y_pred_lr,figsize=(15,8),title='Confusion matrix for Logistic Regression model')","74bfc93a":"#load datasets in lgb formate\ntrain_data=lgb.Dataset(X_train,label=y_train)","4513bdae":"#Create the validation dataset\nX_train,X_val,y_train,y_val=train_test_split(X_train,y_train,test_size=0.1,random_state=42)\nprint(\"The shape of X_train is : {} & the shape of y_train is : {}\".format(X_train.shape,y_train.shape))\nprint(\"The shape of X_val is : {} & the shape of y_val is : {}\".format(X_val.shape,y_val.shape))\nvalidation_data=lgb.Dataset(X_val,label=y_val)","f1bbb776":"#set parameters for training\nparams={ 'num_leaves':145,\n        'object':'binary',\n        'metric':['auc','binary_logloss']\n       }","ec7649f5":"#Train the model\nnum_round=20\nlgb_model=lgb.train(params,train_data,num_round,valid_sets=validation_data,early_stopping_rounds=5)\n","566681d0":"#Prediction on unseen dataset\ny_pred=lgb_model.predict(X_test,num_iteration=lgb_model.best_iteration)>0.5","62477e3c":"#Confusion matrix\ncm=confusion_matrix(y_test,y_pred,labels=[0,1])\ncm","a5144d96":"#Plot confusion matrix\nskplot.metrics.plot_confusion_matrix(y_test,y_pred,figsize=(15,8),title='Confusion matrix for LGBM model')\nplt.show()","fb2f0695":"In above plots, there are 24 attributes share a similar distribution to the 'class' distribution.","f7a396fe":"> Split the datasets","11a7bd9c":"This clearly shows that the target labels in train dataset are imbalanced i.e., negative samples are more than the positve samples. This dataset needs to be balanced to get accurate prediction results.","97a02730":"> Data visulization with Correlation matrix","84f84d3f":"Visualzing the distributon of the resampled dataset","5658f9e4":"Target labels, 0- Negative class &  1-positve class\n                   ","c15a63e7":"> Build a LghtGBM model","7921999b":"The above plot clearly shows that, in 171 attributes, the atributes numbered from 70 to 80 are negatively correlated with other attributes.","0755d47a":"Detecting missing  values","f6b4f79a":"> Build Logistic Regresson model","e4857ba5":"> SMOTE (Synthetic minority over sampling technique) Algorithm        \n  - Used to balance the classes in the datasets","715a4555":"Visualzing the distribution of a dataset","332f79f7":"> Visualizing the distribution of attributes\/features","2c638034":">     Predicting Air pressure system failures in Scania trucks\nThe dataset consists of data collected from heavy Scania trucks in everyday usage. The system in focus is the Air Pressure system (APS) which generates pressurized air that is utilized in various functions in a truck, such as braking and gear changes. The datasets' positive class consists of component failures for a specific component of the APS system. The negative class consists of trucks with failures for components not related to the APS.\nThe training set contains 60000 examples in total in which 59000 belong to the negative class and 1000 positive class. The test set contains 16000 examples. There are 171 attributes per record.","ff22492b":"The LGBM model performed well on test dataset than logistic regression model. The performance of LGBM model improved further by optimizing the hyper parameters.","791a9511":"After the resampling, the classes in train dataset are balanced.","ea1c1012":"Load the datasets","603dcc8c":"Out of 16000 test instances, 97.08% of instances are classified correctly & remaining 2.91% instances are misclassified.","5b6bbb3c":"It seems no missing values are present in the dataset.","2119ea6f":"Out of 16000 test instances, 98.56% of instances are classified correctly & remaining 1.43% instances are misclassified."}}