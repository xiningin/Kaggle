{"cell_type":{"2cf89ff6":"code","7f14954f":"code","36cb2a8b":"code","efca7935":"code","5cac5643":"code","eb56b414":"code","5d478f01":"code","0ca81180":"code","e498851c":"code","3d28e735":"code","c64b11b7":"code","2df734d7":"code","aebd3c81":"code","1a03a52a":"code","33a6eac2":"code","e5cd36fe":"code","c58c70c2":"code","245a3b29":"code","3329bead":"code","e695a2f2":"code","b6f14af1":"code","6caa60c2":"code","98a18aed":"code","dec37218":"code","178cb03e":"code","f40f7a4b":"code","619543ac":"code","e82ef855":"code","b05c4664":"code","6664e6eb":"code","93f3b761":"code","fd6fed66":"code","99c95e93":"code","2807d49f":"code","3df28304":"code","61159d42":"code","7bdd2bd6":"code","978c6857":"code","c80d5da3":"code","57dc6279":"code","08990e53":"code","ebfb0409":"code","58d07e5d":"code","69b45b32":"code","0faa2f63":"code","9759de3d":"code","b7a6fd28":"code","c6e9de4f":"code","4a8b7248":"code","a386d1b4":"code","93d8d748":"code","b42d5b99":"code","264bbebe":"code","1341ecbe":"code","4c75c0a3":"code","e850e1dd":"code","d028d631":"code","462a9963":"code","e3855149":"code","138024e9":"code","859c9f62":"code","e541a365":"code","daf82c52":"code","a8c74aa3":"code","e2e84e96":"code","3f5fa3da":"code","1b201e99":"code","88f3cdd3":"code","f87019cd":"code","cd2f25c8":"markdown","ad4166e0":"markdown","c759a3f4":"markdown","1d6efc63":"markdown","865a6932":"markdown","31df6849":"markdown","66b2e6f1":"markdown","45f4f996":"markdown","8198bf7a":"markdown","e24997a8":"markdown"},"source":{"2cf89ff6":"import pandas as pd\nimport numpy as np\n","7f14954f":"data=pd.read_csv('..\/input\/bengaluru-house-price-data\/Bengaluru_House_Data.csv')","36cb2a8b":"data.head()","efca7935":"data.shape\n","5cac5643":"data.info()","eb56b414":"for column in data.columns:\n  print(data[column].value_counts())","5d478f01":"data.isnull().sum()\n","0ca81180":"df1=data.drop(['area_type', 'availability','society'], axis = 1)","e498851c":"df1.head()","3d28e735":"df1.isnull().sum()\n\n","c64b11b7":"df2=df1.dropna()","2df734d7":"df2.isnull().sum()","aebd3c81":"df2.shape","1a03a52a":"df2.head()","33a6eac2":"df2['size'].unique()","e5cd36fe":"df2['bhk'] = df2['size'].apply(lambda x: x.split(' ')[0])","c58c70c2":"df2.head()","245a3b29":"df2=df2.drop(['size'],axis=1)","3329bead":"df2.total_sqft.unique()","e695a2f2":"def conv(x):\n    arr = x.split('-')\n    if len(arr) == 2:\n        avg = (float(arr[0]) + float(arr[1]))\/2\n        return avg\n    try:\n        return float(x)\n    except:\n        return None","b6f14af1":"df2['total_sqft'] = df2['total_sqft'].apply(lambda x: conv(x))","6caa60c2":"df2.head(10)","98a18aed":"df2['location'].value_counts()\n","dec37218":"df2['location'] = df2['location'].apply(lambda x: x.strip())\n","178cb03e":"location_count=df2.location.value_counts()","f40f7a4b":"location_count","619543ac":"location_count_10 = location_count[location_count < 10]","e82ef855":"location_count_10","b05c4664":"df3 = df2.copy()","6664e6eb":"df3['location'] = df3['location'].apply(lambda x: 'other' if x in location_count_10 else x)","93f3b761":"df3","fd6fed66":"df3['bhk'] = df3['bhk'].astype('float')","99c95e93":"df3 = df3[~(df3.total_sqft\/df3.bhk < 300)]","2807d49f":"df3","3df28304":"df3['price'].unique()","61159d42":"df3['per_sq_feet_price'] = (df3['price']*100000)\/df3['total_sqft']","7bdd2bd6":"df3['per_sq_feet_price'].describe()","978c6857":"\ndef rmv_outlierBy_std(x):\n    out_df = pd.DataFrame()\n    for key, subdf in x.groupby('location'):\n        mean = np.mean(subdf.per_sq_feet_price)\n        std = np.std(subdf.per_sq_feet_price)\n        reduced_df = subdf[(subdf.per_sq_feet_price > (mean - std)) & (subdf.per_sq_feet_price < (mean + std))]\n        out_df = pd.concat([out_df, reduced_df], ignore_index = True)\n    return out_df\n\ndf4 = rmv_outlierBy_std(df3)","c80d5da3":"df4","57dc6279":"def remove_bhk_outliers(df):\n    exclude_indices = np.array([])\n    for location, location_df in df.groupby('location'):\n        bhk_stats = {}\n        for bhk, bhk_df in location_df.groupby('bhk'):\n            bhk_stats[bhk] = {\n                'mean': np.mean(bhk_df.per_sq_feet_price),\n                'std': np.std(bhk_df.per_sq_feet_price),\n                'count': bhk_df.shape[0]\n            }\n        for bhk, bhk_df in location_df.groupby('bhk'):\n            stats = bhk_stats.get(bhk-1)\n            if stats and stats['count']>5:\n                exclude_indices = np.append(exclude_indices, bhk_df[bhk_df.per_sq_feet_price<(stats['mean'])].index.values)\n    return df.drop(exclude_indices,axis='index')\ndf5 = remove_bhk_outliers(df4)","08990e53":"df5.shape","ebfb0409":"df5[df5.bath>10]","58d07e5d":"import matplotlib.pyplot as plt\nplt.hist(df5.bath,rwidth=0.8)\nplt.xlabel(\"Number of bathrooms\")\nplt.ylabel(\"Count\")","69b45b32":"df6 = df5[df5.bath < df5.bhk + 2]","0faa2f63":"df6.shape","9759de3d":"df6.head()","b7a6fd28":"final_DF = df6.drop(['per_sq_feet_price'], axis = 1)","c6e9de4f":"final_DF.head()","4a8b7248":"dummies = pd.get_dummies(final_DF.location)","a386d1b4":"dummies","93d8d748":"final_DF['location'].value_counts()","b42d5b99":"final_DF = pd.concat([final_DF, dummies], axis = 1)","264bbebe":"final_DF","1341ecbe":"final_DF = final_DF.drop(['location'], axis = 1)","4c75c0a3":"final_DF","e850e1dd":"X = final_DF.drop(['price'], axis = 1)","d028d631":"Y = final_DF['price']","462a9963":"from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression","e3855149":"x_train, x_test, y_train, y_test = train_test_split(X,Y, test_size = 0.3, random_state = 1)","138024e9":"x_train.shape, x_test.shape, y_train.shape, y_test.shape","859c9f62":"model = LinearRegression()\nmodel.fit(x_train, y_train)\nmodel.score(x_test, y_test)","e541a365":"pred = model.predict(x_test)\npred","daf82c52":"y_test","a8c74aa3":"X.columns","e2e84e96":"np.where(X.columns == '2nd Stage Nagarbhavi')[0][0]","3f5fa3da":"def model_predict_function(location, total_sqft, bath,balcony,bhk):\n    index = np.where(X.columns == location)[0][0]\n    \n    x = np.zeros(len(X.columns))\n    x[0] = total_sqft\n    x[1] = bath\n    x[2] = balcony\n    x[3] = bhk\n    if index >= 0:\n        x[index] = 1\n    \n    return model.predict([x])","1b201e99":"model_predict_function('other', 1630, 3, 2,2)","88f3cdd3":"model_predict_function('1st Block Koramangala',1400, 2, 2,3)","f87019cd":"model_predict_function('1st Phase JP Nagar',1000, 2, 3,1)","cd2f25c8":"**Now we can remove those 2 BHK apartments whose per_sq_feet_price is less than mean per_sq_feet_price of 1 BHK apartment**","ad4166e0":"**Remove outliers from the bhk features,all bhk removed from where bhk less than 300 sqfeet.**","c759a3f4":"**Load Dataset**","1d6efc63":"**Build a Model**","865a6932":"**One hot encoding to convert a categorical location feature into numeric feature. And store into a \u201cdummies\u201d data set.**","31df6849":"**Standard Deviation technique to remove the outliers from the per_sq_feet_price.**","66b2e6f1":"**locations which are less than 10.**","45f4f996":"**Function to test the model on a custom data set which takes the location, sqft, bath,balcony & bhk.**","8198bf7a":"**Return \u2018other\u2019 if the count of location is less than 10.**","e24997a8":"\n**Regression Project : Home Price Prediction in Banglore**\n\n\n**Dataset is downloaded from here:** https:\/\/www.kaggle.com\/amitabhajoy\/bengaluru-house-price-data"}}