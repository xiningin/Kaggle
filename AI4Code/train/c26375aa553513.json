{"cell_type":{"e4ded8a1":"code","c6a63244":"code","4be08712":"code","cbe22845":"code","04ca374e":"code","bc6f8d02":"code","4c897733":"code","96dbf9d7":"code","483478bd":"code","658176bb":"code","6d3387a7":"code","f4c3fca5":"code","c050f703":"code","8ebfb6d2":"code","8c1545c8":"code","7c573197":"code","6b920a1c":"code","a3ed48d6":"markdown","b3e30071":"markdown","480c0521":"markdown","66dedc22":"markdown","e4263c62":"markdown"},"source":{"e4ded8a1":"!pip install ipython-sql\nimport os","c6a63244":"\n%%capture\n%load_ext sql\n%sql sqlite:\/\/\/\/kaggle\/input\/cia-factbook-data\/factbook-data\/factbook.db","4be08712":"%%sql\n\nSELECT * \nFROM   sqlite_master \nWHERE  type = 'table'; ","cbe22845":"%%sql\n\nSELECT * \nFROM   facts \nLIMIT  5 \n","04ca374e":"%%sql\n\nSELECT Min(population), \n       Max(population), \n       Min(population_growth), \n       Max(population_growth) \nFROM   facts ","bc6f8d02":"%%sql\n\n-- Country with no population at all (min population in the table)\n\nSELECT name, \n       population \nFROM   facts \nWHERE  population = (SELECT Min(population) \n                     FROM   facts) ","4c897733":"%%sql\n\n-- Country with max population\n\nSELECT name, \n       population \nFROM   facts \nWHERE  population = (SELECT Max(population) \n                     FROM   facts) ","96dbf9d7":"%%sql\n\n-- Min-Max values excluding World\n\nSELECT Min(population)        AS Min_population, \n       Max(population)        AS Max_population, \n       Min(population_growth) AS Min_population_growth, \n       Max(population_growth) AS Max_population_growth \nFROM   facts \nWHERE  population != (SELECT Max(population) \n                      FROM   facts) ","483478bd":"%%sql\n\n-- Average population and area\n\nSELECT Cast(Avg(population) AS INT) AS 'Average population', \n       Cast(Avg(area) AS INT)       AS 'Average area' \nFROM   facts \nWHERE  population != (SELECT Max(population) \n                      FROM   facts) ","658176bb":"%%sql\n\n-- Population is more than average AND area is less than average\n\nSELECT name, \n       population, \n       area \nFROM   facts \nWHERE  population > (SELECT Avg(population) \n                     FROM   facts \n                     WHERE  population != (SELECT Max(population) \n                                           FROM   facts)) \n       AND area < (SELECT Avg(area) \n                   FROM   facts \n                   WHERE  population != (SELECT Max(population) \n                                         FROM   facts)) \nLIMIT  5","6d3387a7":"%%sql\n\n-- What country has the most people? \n\nSELECT name, \n       population \nFROM   facts \nWHERE  population = (SELECT Max(population) \n                     FROM   facts \n                     WHERE  population != (SELECT Max(population) \n                                           FROM   facts)) \n","f4c3fca5":"%%sql\n\n-- What country has the highest growth rate? \n\nSELECT name, \n       population_growth \nFROM   facts \nWHERE  population_growth = (SELECT Max(population_growth) \n                            FROM   facts \n                            WHERE  population != (SELECT Max(population) \n                                                  FROM   facts)) ","c050f703":"%%sql\n\n-- Which countries have the highest ratios of water to land? \n\nSELECT   name, \n         area_water, \n         area_land, \n         round(cast(area_water AS float)\/area_land,3) AS 'water_land_ratio' \nFROM     facts \nORDER BY water_land_ratio DESC \nLIMIT    5\n","8ebfb6d2":"%%sql\n\n-- Which countries have more water than land?\n\nSELECT name, \n       area_water, \n       area_land, \n       area_water - area_land AS 'water_land_difference' \nFROM   facts \nWHERE  water_land_difference > 0 \nORDER  BY water_land_difference DESC \n","8c1545c8":"%%sql\n\n-- Which countries will add the most people to their population next year?\n\nSELECT   name, \n         cast(population\/100 * population_growth AS int) AS absolute_growth \nFROM     facts \nWHERE    name <> 'World' \nORDER BY absolute_growth DESC \nLIMIT    5","7c573197":"%%sql\n\n-- Which countries have a higher death rate than birth rate?\n\n\nSELECT name, \n       Round(death_rate - birth_rate, 2) AS death_birth_difference \nFROM   facts \nWHERE  name <> 'World' \n       AND death_birth_difference > 0 \nORDER  BY death_birth_difference DESC \nLIMIT  5\n","6b920a1c":"%%sql\n\n-- What countries have the highest population\/area ratio?\n\nSELECT NAME, \n       Round(Cast(population AS FLOAT) \/ area, 2) AS population_area_ratio \nFROM   facts \nWHERE  NAME <> 'World' \nORDER  BY population_area_ratio DESC \nLIMIT  5\n\n\n\n","a3ed48d6":"* name - The name of the country.\n* area - The country's total area (both land and water).\n* area_land - The country's land area in square kilometers.\n* area_water - The country's waterarea in square kilometers.\n* population - The country's population.\n* population_growth- The country's population growth as a percentage.\n* birth_rate - The country's birth rate, or the number of births a year per 1,000 people.\n* death_rate - The country's death rate, or the number of death a year per 1,000 people.","b3e30071":"# Data anomalies","480c0521":"# Imports","66dedc22":"# DB connection","e4263c62":"# DB preview"}}