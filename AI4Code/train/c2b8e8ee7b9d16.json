{"cell_type":{"a77872a7":"code","bb0b38aa":"code","513b5877":"code","029cdb39":"code","48e72bbd":"code","3714f35d":"code","87bd8bb1":"code","13817079":"code","9f800fbc":"code","c7f1536e":"code","382e3118":"code","53a58b16":"code","0628c398":"code","c61656c1":"code","c318b49b":"code","d333fa17":"code","e32120ad":"markdown"},"source":{"a77872a7":"!pip install --upgrade git+https:\/\/github.com\/tusharsarkar3\/XBNet.git","bb0b38aa":"import torch\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nfrom XBNet.training_utils import training,predict\nfrom XBNet.models import XBNETClassifier\nfrom XBNet.run import run_XBNET ","513b5877":"import pandas as pd \ndata = pd.read_csv('..\/input\/chinese-mnist-digit-recognizer\/chineseMNIST.csv')\ndata.head()","029cdb39":"data=data.sample(len(data))\ndata=data.reset_index(drop = True)\ndata.head()","48e72bbd":"data.label.value_counts()","3714f35d":"data.label.unique()","87bd8bb1":"data.label=data.label.replace([100,1000,10000,100000000],[11,12,13,14])\ndata.label.value_counts()","13817079":"y=data[['label']].to_numpy()\ny","9f800fbc":"x=data.loc[:,:'pixel_4095'].to_numpy()\nx","c7f1536e":"x_train,x_test,y_train,y_test = train_test_split(x,y,test_size= 0.2, random_state= True,stratify=y) \nx_train.shape,x_test.shape,y_train.shape,y_test.shape","382e3118":"y_train=y_train.reshape((-1))\ny_train.shape","53a58b16":"y_test=y_test.reshape((-1))\ny_test.shape","0628c398":"model = XBNETClassifier(x_train,y_train,num_layers=5)","c61656c1":"criterion = torch.nn.CrossEntropyLoss()\noptimizer = torch.optim.Adam(model.parameters(), lr=0.1) ","c318b49b":"m,acc, lo, val_ac, val_lo = run_XBNET(x_train,x_test,y_train,y_test,model,criterion,optimizer,epochs=32,batch_size=1024)","d333fa17":"import matplotlib.pyplot as plt\nplt.figure(figsize=(20,5))\nplt.subplot(1,2,1)\nplt.plot(acc,label='training accuracy')\nplt.plot(val_ac,label = 'validation accuracy')\nplt.xlabel('epochs')\nplt.ylabel('accuracy')\nplt.legend()\nplt.grid()\nplt.subplot(1,2,2)\nplt.plot(lo,label='training loss')\nplt.plot(val_lo,label = 'validation loss')\nplt.xlabel('epochs')\nplt.ylabel('loss')\nplt.legend() \nplt.grid()","e32120ad":"This is based on paper named \"**XBNet : An Extremely Boosted Neural Network**\"\n\nLink : https:\/\/arxiv.org\/abs\/2106.05239"}}