{"cell_type":{"40dd298d":"code","49d9e837":"code","b648df8c":"code","0a81207d":"code","0d70dfb9":"code","98c5ac7e":"code","492dfaea":"code","3652bdbd":"code","7a1dfe6a":"code","9ac012ea":"code","4ae2f5fd":"code","21c683c2":"code","14dfeabe":"code","d54722c8":"code","362c7d05":"code","667201d0":"code","e5225da4":"code","9eab8672":"code","f25934f7":"code","91734fd2":"code","01448068":"code","81d5eb41":"code","4ae2a14e":"code","78b2f1c2":"code","e4848232":"code","02a30429":"code","a89f6b63":"code","ba792ceb":"code","ca9278ff":"code","8dbfd721":"code","672dd934":"code","545a00fd":"markdown","5468fc8b":"markdown","e2abcb16":"markdown","98fe578e":"markdown","16d04ce1":"markdown","b42b419b":"markdown","3d0f1841":"markdown","7e06df78":"markdown","99b164a5":"markdown","c2a2fb11":"markdown","bb4e9ef6":"markdown","9da84743":"markdown","07de35d9":"markdown","52da779b":"markdown","a7589c6b":"markdown","ac00e3c4":"markdown"},"source":{"40dd298d":"\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport plotly\nimport plotly.express as px\nimport plotly.offline as pyo\nimport cufflinks as cf\nfrom plotly.offline import init_notebook_mode,plot,iplot\n\npyo.init_notebook_mode(connected=True)\ncf.go_offline()\n\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","49d9e837":"df = pd.read_csv(r'\/kaggle\/input\/mushroom-classification\/mushrooms.csv')\nprint(df.info())\nprint('-'*100)\nprint(df.describe())\nprint('-'*100)\nprint(\"The shape of the data is : \", df.shape)\nprint('-'*100)\ndf.head()","b648df8c":"df_new = df.copy()\ndf_new.head()","0a81207d":"mushroom_class = {\"p\": \"poisonous\", \"e\": \"edible\"}\nmushroom_cap_shape = {\"b\":\"bell\",\"c\":\"conical\",\"x\":\"convex\",\"f\":\"flat\", \"k\":\"knobbed\",\"s\":\"sunken\"}\nmushroom_cap_surface = {\"f\":\"fibrous\",\"g\":\"grooves\",\"y\":\"scaly\",\"s\":\"smooth\"}\nmushroom_cap_color = {\"n\":\"brown\",\"b\":\"buff\",\"c\":\"cinnamon\",\"g\":\"gray\",\"r\":\"green\",\"p\":\"pink\",\"u\":\"purple\",\"e\":\"red\",\"w\":\"white\",\"y\":\"yellow\"}\nmushroom_bruises = {\"t\":\"bruises\",\"f\":\"no\"}\nmushroom_odor = {\"a\":\"almond\",\"l\":\"anise\",\"c\":\"creosote\",\"y\":\"fishy\",\"f\":\"foul\",\"m\":\"musty\",\"n\":\"none\",\"p\":\"pungent\",\"s\":\"spicy\"}\nmushroom_gill_attachment = {\"a\":\"attached\",\"d\":\"descending\",\"f\":\"free\",\"n\":\"notched\"}\nmushroom_gill_spacing = {\"c\":\"close\",\"w\":\"crowded\",\"d\":\"distant\"}\nmushroom_gill_size = {\"b\":\"broad\",\"n\":\"narrow\"}\nmushroom_gill_color = {\"k\":\"black\",\"n\":\"brown\",\"b\":\"buff\",\"h\":\"chocolate\",\"g\":\"gray\", \"r\":\"green\",\"o\":\"orange\",\"p\":\"pink\",\"u\":\"purple\",\"e\":\"red\",\"w\":\"white\",\"y\":\"yellow\"}\nmushroom_stalk_shape =  {\"e\":\"enlarging\",\"t\":\"tapering\"}\nmushroom_stalk_root = {\"b\":\"bulbous\",\"c\":\"club\",\"u\":\"cup\",\"e\":\"equal\",\"z\":\"rhizomorphs\",\"r\":\"rooted\",\"?\":\"missing\"}\nmushroom_stalk_surface_above_ring = {\"f\":\"fibrous\",\"y\":\"scaly\",\"k\":\"silky\",\"s\":\"smooth\"}\nmushroom_stalk_surface_below_ring = {\"f\":\"fibrous\",\"y\":\"scaly\",\"k\":\"silky\",\"s\":\"smooth\"}\nmushroom_stalk_color_above_ring = {\"n\":\"brown\",\"b\":\"buff\",\"c\":\"cinnamon\",\"g\":\"gray\",\"o\":\"orange\",\"p\":\"pink\",\"e\":\"red\",\"w\":\"white\",\"y\":\"yellow\"}\nmushroom_stalk_color_below_ring = {\"n\":\"brown\",\"b\":\"buff\",\"c\":\"cinnamon\",\"g\":\"gray\",\"o\":\"orange\",\"p\":\"pink\",\"e\":\"red\",\"w\":\"white\",\"y\":\"yellow\"}\nmushroom_veil_type = {\"p\":\"partial\",\"u\":\"universal\"}\nmushroom_veil_color = {\"n\":\"brown\",\"o\":\"orange\",\"w\":\"white\",\"y\":\"yellow\"}\nmushroom_ring_number = {\"n\":\"none\",\"o\":\"one\",\"t\":\"two\"}\nmushroom_ring_type = {\"c\":\"cobwebby\",\"e\":\"evanescent\",\"f\":\"flaring\",\"l\":\"large\",\"n\":\"none\",\"p\":\"pendant\",\"s\":\"sheathing\",\"z\":\"zone\"}\nmushroom_spore_print_color = {\"k\":\"black\",\"n\":\"brown\",\"b\":\"buff\",\"h\":\"chocolate\",\"r\":\"green\",\"o\":\"orange\",\"u\":\"purple\",\"w\":\"white\",\"y\":\"yellow\"}\nmushroom_population = {\"a\":\"abundant\",\"c\":\"clustered\",\"n\":\"numerous\",\"s\":\"scattered\",\"v\":\"several\",\"y\":\"solitary\"}\nmushroom_habitat = {\"g\":\"grasses\",\"l\":\"leaves\",\"m\":\"meadows\",\"p\":\"paths\",\"u\":\"urban\",\"w\":\"waste\",\"d\":\"woods\"}\n\n\ndf_new['class'] = df_new['class'].map(mushroom_class)\ndf_new['cap-shape'] = df_new['cap-shape'].map(mushroom_cap_shape)\ndf_new['cap-surface'] = df_new['cap-surface'].map(mushroom_cap_surface)\ndf_new['cap-color'] = df_new['cap-color'].map(mushroom_cap_color)\ndf_new['bruises'] = df_new['bruises'].map(mushroom_bruises)\ndf_new['odor'] = df_new['odor'].map(mushroom_odor)\ndf_new['gill-attachment'] = df_new['gill-attachment'].map(mushroom_gill_attachment)\ndf_new['gill-spacing'] = df_new['gill-spacing'].map(mushroom_gill_spacing)\ndf_new['gill-size'] = df_new['gill-size'].map(mushroom_gill_size)\ndf_new['gill-color'] = df_new['gill-color'].map(mushroom_gill_color)\ndf_new['stalk-shape'] = df_new['stalk-shape'].map(mushroom_stalk_shape)\ndf_new['stalk-root'] = df_new['stalk-root'].map(mushroom_stalk_root)\ndf_new['stalk-surface-above-ring'] = df_new['stalk-surface-above-ring'].map(mushroom_stalk_surface_above_ring)\ndf_new['stalk-surface-below-ring'] = df_new['stalk-surface-below-ring'].map(mushroom_stalk_surface_below_ring)\ndf_new['stalk-color-above-ring'] = df_new['stalk-color-above-ring'].map(mushroom_stalk_color_above_ring)\ndf_new['stalk-color-below-ring'] = df_new['stalk-color-below-ring'].map(mushroom_stalk_color_below_ring)\ndf_new['veil-type'] = df_new['veil-type'].map(mushroom_veil_type)\ndf_new['veil-color'] = df_new['veil-color'].map(mushroom_veil_color)\ndf_new['ring-number'] = df_new['ring-number'].map(mushroom_ring_number)\ndf_new['ring-type'] = df_new['ring-type'].map(mushroom_ring_type)\ndf_new['spore-print-color'] = df_new['spore-print-color'].map(mushroom_spore_print_color)\ndf_new['population'] = df_new['population'].map(mushroom_population)\ndf_new['habitat'] = df_new['habitat'].map(mushroom_habitat)","0d70dfb9":"df_new.head()","98c5ac7e":"df_new[\"class\"].value_counts()","492dfaea":"mushroom_class_count = df_new['class'].value_counts().to_frame()\nmushroom_class_count.reset_index(inplace=True)\nmushroom_class_count.rename(columns={'index':'class', 'class':'count'}, inplace=True)\n\nmushroom_class_count.iplot(kind='pie', labels='class', values='count', title='Mushroom Type Count', theme='pearl')","3652bdbd":"plt.figure(figsize=(15,8))\nsns.countplot(df_new['cap-shape'], hue=df_new['class'])","7a1dfe6a":"plt.figure(figsize=(15,8))\nsns.countplot(df_new['cap-surface'], hue=df_new['class'], palette=\"husl\")","9ac012ea":"plt.figure(figsize=(15,8))\nsns.countplot(df_new['bruises'], hue=df_new['class'], palette=\"Set2\")","4ae2f5fd":" sns.catplot(x=\"odor\", hue=\"bruises\", col=\"class\",\n                data=df_new, kind=\"count\",\n                height=7, aspect=1)","21c683c2":"plt.figure(figsize=(15,8))\nsns.countplot(df_new['gill-size'], hue=df_new['class'])","14dfeabe":"plt.figure(figsize=(15,8))\nsns.countplot(df_new['ring-type'], hue=df_new['class'], palette=\"husl\")","d54722c8":" sns.catplot(x=\"ring-type\", hue=\"gill-size\", col=\"class\",\n                data=df_new, kind=\"count\",\n                height=7, aspect=1)","362c7d05":"plt.figure(figsize=(15,8))\nsns.countplot(df_new['gill-color'], hue=df_new['class'], palette=\"husl\")","667201d0":" sns.catplot(x=\"gill-color\", hue=\"gill-spacing\", col=\"class\",\n                data=df_new, kind=\"count\",\n                height=7, aspect=1, palette=\"husl\")","e5225da4":"df_2 = df.copy()\ndf_2.head()","9eab8672":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\nfor c in df_2.columns:\n    df_2[c] = le.fit_transform(df_2[c])","f25934f7":"df_2.head()","91734fd2":"X = df_2.drop(['class'], axis=1)\ny = df_2['class']\nprint(X.shape, y.shape)","01448068":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=32)\nprint(X_train.shape, y_train.shape, X_test.shape, y_test.shape)","81d5eb41":"from sklearn.ensemble import ExtraTreesClassifier\nmodel = ExtraTreesClassifier()\nmodel.fit(X,y)","4ae2a14e":"feat_importances = pd.Series(model.feature_importances_,index =X.columns)\nfeat_importances.nlargest(9).plot(kind=\"barh\")\nplt.show()","78b2f1c2":"from sklearn.model_selection import GridSearchCV\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC","e4848232":"model_params  = {\n    \"svm\" : {\n        \"model\":SVC(gamma=\"auto\"),\n        \"params\":{\n            'C' : [1,10,20],\n            'kernel':[\"rbf\"]\n        }\n    },\n    \n    \"decision_tree\":{\n        \"model\": DecisionTreeClassifier(),\n        \"params\":{\n            'criterion':[\"entropy\",\"gini\"],\n            \"max_depth\":[5,8,9]\n        }\n    },\n     \"random_forest\":{\n        \"model\": RandomForestClassifier(),\n        \"params\":{\n            \"n_estimators\":[1,5,10],\n            \"max_depth\":[5,8,9]\n        }\n    },\n    \"naive_bayes\":{\n        \"model\": GaussianNB(),\n        \"params\":{}\n    },\n    \n    'logistic_regression' : {\n        'model' : LogisticRegression(solver='liblinear',multi_class = 'auto'),\n        'params': {\n            \"C\" : [1,5,10]\n        }\n    }\n    \n}","02a30429":"score=[]\nfor model_name,mp in model_params.items():\n    clf = GridSearchCV(mp[\"model\"],mp[\"params\"],cv=8,return_train_score=False)\n    clf.fit(X,y)\n    score.append({\n        \"Model\" : model_name,\n        \"Best_Score\": clf.best_score_,\n        \"Best_Params\": clf.best_params_\n    })\ndf_scores = pd.DataFrame(score,columns=[\"Model\",\"Best_Score\",\"Best_Params\"])","a89f6b63":"df_scores.iplot(kind='pie', labels='Model', values='Best_Score', title='Model performance', theme='pearl')","ba792ceb":"from sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report, confusion_matrix, accuracy_score","ca9278ff":"rf = RandomForestClassifier(n_estimators=10, max_depth=8)\nrf.fit(X_train, y_train)","8dbfd721":"score = rf.score(X_train, y_train)\nscore2 = rf.score(X_test, y_test)\nscore, score2","672dd934":"print(classification_report(y_test, rf.predict(X_test)))","545a00fd":"# Data Preprocessing","5468fc8b":"Just changing all the abbreviations to their actual meanings, so that during visualization we dont have to change that much.","e2abcb16":"# Model making \/ Hyperparameter training","98fe578e":"Here the gill size is also a feature which tell that edible mushrooms have a broader gill-size","16d04ce1":"Here we can see if the msuhrooms gill - spacing is closed and gill - color is buff is will most likely to be a poisonous one","b42b419b":"These feature can also be used to classify the edible mushrooms, according to the plot edible msuhroom tend to have more number towards pendant ring type as one of its feature","3d0f1841":"This feature carries a huge percentage for buff gitll-color to be a poisonous mushroom which is not edible.","7e06df78":"Mushroom, the conspicuous umbrella-shaped fruiting body (sporophore) of certain fungi, typically of the order Agaricales in the phylum Basidiomycota but also of some other groups. Popularly, the term mushroom is used to identify the edible sporophores; the term toadstool is often reserved for inedible or poisonous sporophores.","99b164a5":"Here we can see the importance of all features that are necessary for classification which can also be dedeuced as per the Exploratory data visualization done earlier.","c2a2fb11":"# Data Insights and Visualizations","bb4e9ef6":"Feel free to give back any comments , suggestions, or any changes to be made.","9da84743":"![image.jpg](https:\/\/www.asianscientist.com\/wp-content\/uploads\/bfi_thumb\/mushroom-amber-33he3ff71v8138lwdjmm0w.jpg)","07de35d9":"Here we can clearly see that poisonous msuhrooms have a greater channce of carrying a foul odor, and where as edible mushroom contains a large percentage of no odor mushrooms. So, odour can be also remembered as one of the feature during classification of edible mushrooms","52da779b":"# Mushroom Classification whether-edible or Not?","a7589c6b":"Thank you !!","ac00e3c4":"As we can see the dataset is totally cleared with no null values and in class label e=edible p=poisonous"}}