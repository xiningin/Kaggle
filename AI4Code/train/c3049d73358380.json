{"cell_type":{"4a6d14a8":"code","b03ac4ad":"code","bf390c0a":"code","f8e90660":"code","42833668":"markdown"},"source":{"4a6d14a8":"import pandas as pd\nimport numpy as np\nfrom sklearn.model_selection import StratifiedKFold\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.svm import LinearSVC\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.metrics import roc_auc_score","b03ac4ad":"train_df = pd.read_csv('..\/input\/tabular-playground-series-nov-2021\/train.csv')\ntest_df = pd.read_csv('..\/input\/tabular-playground-series-nov-2021\/test.csv')\n","bf390c0a":"auc_list, pred_list = [], []\nkf = StratifiedKFold(n_splits=7, shuffle=True, random_state=1)\nfor fold, (train_idx, val_idx) in enumerate(kf.split(train_df, train_df.target)):\n    print(f\"Fold {fold}\")\n    X_tr = train_df.iloc[train_idx]#.iloc[:50000]\n    X_va = train_df.iloc[val_idx]\n    y_tr = X_tr.target\n    y_va = X_va.target\n    X_tr = X_tr.drop(columns=['id', 'target'])\n    X_va = X_va.drop(columns=['id', 'target'])\n\n    # Train\n    model = make_pipeline(StandardScaler(), LinearSVC(tol=1e-7, penalty='l2', dual=False, max_iter=2000))\n    model.fit(X_tr, y_tr)\n    \n    # Validate\n    y_pred = model.decision_function(X_va)\n    score = roc_auc_score(y_va, y_pred)\n    print(score)\n    auc_list.append(score)\n    \n    # Predict for the submission\n    pred_list.append(model.decision_function(test_df.drop(columns=['id'])))\n\navg_auc = sum(auc_list) \/ len(auc_list)\nprint(f\"Average AUC: {avg_auc:.5f}\")","f8e90660":"test_df['target'] = sum(pred_list)\ntest_df[['id', 'target']].to_csv('submission.csv', index=False)\ntest_df[['id', 'target']].head()","42833668":"# Support vector classification for TPS November 2021\n\nRelease notes:\n- V2: Bugfix"}}