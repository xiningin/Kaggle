{"cell_type":{"3608a738":"code","0c1dcb44":"code","2664b3c9":"code","9f459280":"code","3014d313":"code","d8970335":"markdown","defabba7":"markdown","2e6c19c6":"markdown","27bb5e7b":"markdown","ae44d0a5":"markdown","25f2daa8":"markdown"},"source":{"3608a738":"# 1. PACKAGES\n# -----------------------------------------------------------\n# Base\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Model\nfrom lightgbm import LGBMClassifier\n\n# Configuration\nimport warnings\nwarnings.filterwarnings('ignore')\npd.set_option('display.max_columns', None)\npd.options.display.float_format = '{:,.2f}'.format","0c1dcb44":"df = pd.read_feather(\"..\/input\/homecredit-default-risk-step-by-step-1st-notebook\/applications_traintest_feather\")\npos = pd.read_feather(\"..\/input\/homecredit-default-risk-step-by-step-1st-notebook\/poscashbalance_agg_feather\")\nbb = pd.read_feather(\"..\/input\/homecredit-default-risk-step-by-step-1st-notebook\/bureau_bureaubalance_agg_feather\")\ncc = pd.read_feather(\"..\/input\/homecredit-default-risk-step-by-step-1st-notebook\/cc_feather\")\nins = pd.read_feather(\"..\/input\/homecredit-default-risk-step-by-step-1st-notebook\/installments_payments_agg_feather\")\nprev = pd.read_feather(\"..\/input\/homecredit-default-risk-step-by-step-1st-notebook\/previous_applications_agg_feather\")\n\nprint(df.shape, pos.shape, bb.shape, cc.shape, ins.shape, prev.shape)\n\nfor i in [pos, bb, cc, ins, prev]:\n    df = pd.merge(df, i , how = \"left\", on = \"SK_ID_CURR\")\n    \nprint(df.shape)\n\ndel pos, bb, ins, cc, prev","2664b3c9":"# Train-Test Split\ndf.columns = list(map(lambda x: str(x).replace(\" \", \"_\").replace(\"-\", \"_\").replace(\"_\/_\", \"_\").upper(), df.columns))\nimport re\ndf = df.rename(columns = lambda x:re.sub('[^A-Za-z0-9_]+', '', x))\n\n\ntrain = df[df.TARGET.isnull() == False]\ntest = df[df.TARGET.isnull()]\n\nx_train = train.drop([\"TARGET\", \"SK_ID_CURR\"], axis = 1)\nx_test = test.drop([\"TARGET\", \"SK_ID_CURR\"], axis = 1)\ny_train = train.TARGET","9f459280":"# LightGBM parameters found by Bayesian optimization\nclf = LGBMClassifier(\n    nthread=4,\n    n_estimators=10000,\n    learning_rate=0.02,\n    num_leaves=34,\n    colsample_bytree=0.9497036,\n    subsample=0.8715623,\n    max_depth=8,\n    reg_alpha=0.041545473,\n    reg_lambda=0.0735294,\n    min_split_gain=0.0222415,\n    min_child_weight=39.3259775,\n    silent=-1,\n    verbose=-1, )\n\nclf.fit(x_train, y_train, eval_set=[(x_train, y_train)],\n        eval_metric='auc', verbose=200)\n","3014d313":"submission = pd.DataFrame({\n    \"SK_ID_CURR\": test.SK_ID_CURR,\n    \"TARGET\": clf.predict_proba(x_test)[:,1]\n})\nsubmission.to_csv(\"submission.csv\", index = None)","d8970335":"# 1. PACKAGES","defabba7":"# 3. TRAIN-TEST SPLIT","2e6c19c6":"<div><img src=\"https:\/\/storage.googleapis.com\/kaggle-competitions\/kaggle\/9120\/logos\/header.png?t=2018-04-02-23-51-59\"><\/img><\/div>\n\n<img src=\"https:\/\/storage.googleapis.com\/kaggle-competitions\/kaggle\/9120\/logos\/thumb76_76.png?t=2018-04-02-23-45-04\" align=\"left\" width = \"100px\"\/>\n\n<h1> Home Credit Default Risk Step by Step: 2nd Notebook<\/h1>\n\n<div style=\"clear:both\"><\/div>\n\n<br>\n\n[Home Credit Default Risk Step by Step: 1st Notebook](https:\/\/www.kaggle.com\/ekrembayar\/homecredit-default-risk-step-by-step-1st-notebook)\n","27bb5e7b":"# 4. MODEL","ae44d0a5":"# 2. DATA","25f2daa8":"# 5. Submission"}}