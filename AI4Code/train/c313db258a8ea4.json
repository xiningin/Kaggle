{"cell_type":{"7989c567":"code","4c8623da":"code","a0cdd4f6":"code","e23c1fe4":"code","189610c1":"code","e2198e64":"code","2a824911":"code","db340c46":"code","c9062132":"code","7dddeb13":"code","2afcf240":"code","04d35c3d":"code","991f2203":"code","797e1543":"code","53e511bd":"code","7b43e38d":"code","2850b416":"code","7c399992":"code","3819631f":"code","e6c66261":"code","2d0bea49":"code","45474251":"code","a26ad63d":"code","dc45eac5":"code","4844dd3c":"code","1220a4f2":"code","a90ae8d8":"code","79d840bd":"code","71c0033f":"code","cdf82eca":"code","a856d9cd":"code","ef59647d":"code","3d29d75a":"code","c6caa0ff":"code","a0ef543d":"code","76ba7884":"code","631ee9bb":"code","3a2a2280":"code","b30ad68a":"code","8ae6c1b0":"code","f99cb08f":"code","8739a182":"code","cade146f":"code","e55602f4":"code","ba973231":"code","927978a6":"code","022d4067":"code","75cd4631":"code","1eb3be20":"code","a1db66eb":"code","e047fc89":"code","c8d55bc7":"code","8d02b21c":"code","7ca0c139":"code","f8253e12":"code","e3e56a9f":"code","0ed5a166":"code","9f927a71":"code","80a92447":"code","0bcc5565":"code","07f6506e":"code","98de6782":"code","a5695e44":"code","ee6dcd10":"code","7d1ed906":"code","3e5d01e8":"code","263d1d6e":"code","71bcf2c1":"code","d4357743":"code","e0df7f95":"code","84216d9c":"code","c3292750":"code","1cc1d1aa":"code","4ae05c0a":"code","caa90d46":"code","f99d8621":"code","e0f07b53":"code","a806af3d":"code","6f265ce0":"code","5420a556":"code","b75c660e":"code","e2c22ceb":"code","5870556f":"code","d1bccfd9":"code","4054dddc":"code","80d48b91":"code","eeece74a":"code","770793b9":"code","04f26ddf":"code","5cf8c3ac":"code","f63dc1b5":"code","2ef8a0d0":"code","dfbc6a39":"code","1b7412e8":"code","cb5816c4":"code","77d891d8":"code","a322b018":"code","761fd20c":"code","f5de0b4e":"code","cefd4bdf":"code","1ce3d1ae":"markdown","dd1c051a":"markdown","f6fe5b9a":"markdown","12d91883":"markdown"},"source":{"7989c567":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","4c8623da":"df = pd.read_csv('..\/input\/train-sjc\/train_SJC.csv')","a0cdd4f6":"df.shape","e23c1fe4":"df.head()","189610c1":"df.columns.tolist()","e2198e64":"df.info()","2a824911":"missing=df.isnull().sum()\nprint(missing[missing>0])","db340c46":"df['WeeklyWages'].describe()","c9062132":"df['WeeklyWages']=df['WeeklyWages'].fillna(df['WeeklyWages'].mean())","7dddeb13":"df['HoursWorkedPerWeek'].describe()","2afcf240":"df['HoursWorkedPerWeek']=df['HoursWorkedPerWeek'].fillna(df['HoursWorkedPerWeek'].mean())","04d35c3d":"df['MaritalStatus'].value_counts()","991f2203":"df['MaritalStatus']=df['MaritalStatus'].fillna(df['MaritalStatus'].mode()[0])","797e1543":"df['DateTimeOfAccident']=pd.to_datetime(df['DateTimeOfAccident'])","53e511bd":"df['DateTimeOfAccident'].describe()","7b43e38d":"df['Date_of_accident']=df['DateTimeOfAccident'].dt.date","2850b416":"df['Month_of_accident']=df['DateTimeOfAccident'].dt.month","7c399992":"df['Month_of_accident'].head()","3819631f":"df['Time_of_accident']=df['DateTimeOfAccident'].dt.time","e6c66261":"df['Date_of_accident'].head()","2d0bea49":"df['DateReported']=pd.to_datetime(df['DateReported'])","45474251":"df['Date_of_reported']=df['DateReported'].dt.date\ndf['Time_of_reported']=df['DateReported'].dt.time\ndf['Month_of_reported']=df['DateReported'].dt.month","a26ad63d":"df['Month_of_reported'].describe()","dc45eac5":"df['Difference']=(df['Month_of_reported']-df['Month_of_accident'])","4844dd3c":"df['Difference']","1220a4f2":"df['Gender'].value_counts()","a90ae8d8":"un=df[df['Gender']=='U'].index\ndf.drop(un,inplace=True)","79d840bd":"sns.barplot(data=df,y='UltimateIncurredClaimCost',x='MaritalStatus')","71c0033f":"sns.countplot(data=df,x='Gender')","cdf82eca":"sns.countplot(data=df,x='MaritalStatus')","a856d9cd":"sns.barplot(data=df,x='Gender',y='Age')","ef59647d":"sns.barplot(data=df,x='MaritalStatus',y='Age')","3d29d75a":"df['Age'].plot.box(figsize=(16,5))","c6caa0ff":"sns.catplot(data=df,x='UltimateIncurredClaimCost',col='Gender',kind='violin')","a0ef543d":"sns.countplot(data=df,x='PartTimeFullTime')","76ba7884":"df['DependentChildren'].value_counts().plot.bar()","631ee9bb":"sns.barplot(data=df,x='DependentsOther',y='UltimateIncurredClaimCost')","3a2a2280":"import sklearn.preprocessing as pre\nimport sklearn.model_selection as ms","b30ad68a":"from sklearn import preprocessing\nle=preprocessing.LabelEncoder()","8ae6c1b0":"df['Gender'] = le.fit_transform(df['Gender'])","f99cb08f":"df['Gender'].head()","8739a182":"df['MaritalStatus']=le.fit_transform(df['MaritalStatus'])","cade146f":"df['PartTimeFullTime']=le.fit_transform(df['PartTimeFullTime']) ","e55602f4":"df.head()","ba973231":"df.info()","927978a6":"df.columns.tolist()","022d4067":"df['WeeklyWages']=df['WeeklyWages'].astype(int)","75cd4631":"for x in df.select_dtypes(include='object').columns.tolist():\n    df[x]=le.fit_transform(df[x])","1eb3be20":"df.info()","a1db66eb":"df=df.drop(columns=['ClaimDescription','ClaimNumber','DateTimeOfAccident','DateReported'],axis=1)","e047fc89":"X_scale=pre.minmax_scale(df.drop('UltimateIncurredClaimCost',axis=1))","c8d55bc7":"y=(df['UltimateIncurredClaimCost'])","8d02b21c":"x_train,x_test,y_train,y_test=ms.train_test_split(X_scale,y,test_size=0.3,random_state=1234456)","7ca0c139":"x_train.shape,x_test.shape,y_train.shape,y_test.shape","f8253e12":"import sklearn.linear_model as lm","e3e56a9f":"lg=lm.LinearRegression()","0ed5a166":"lg.fit(x_train,y_train)","9f927a71":"lg.score(x_train,y_train)","80a92447":"lg.score(x_test,y_test)","0bcc5565":"df.columns","07f6506e":"y_pred = lg.predict(x_test)\ny_pred","98de6782":"ypred=pd.DataFrame(y_pred)\nypred.head()","a5695e44":"from math import sqrt\nfrom sklearn.metrics import mean_squared_error\nrms=sqrt(mean_squared_error(y_pred=lg.predict(x_train),y_true=y_train))\nrms","ee6dcd10":"import sklearn.neighbors as NN","7d1ed906":"features=df.drop('UltimateIncurredClaimCost',axis=1)\noutcome=df['UltimateIncurredClaimCost']","3e5d01e8":"import sklearn.model_selection as ms","263d1d6e":"x_train,x_test,y_train,y_test=ms.train_test_split(features,outcome,test_size=0.3,random_state=1234561)","71bcf2c1":"KNN=NN.KNeighborsRegressor(n_neighbors=10,weights='distance',metric='minkowski')","d4357743":"KNN.fit(x_train,y_train)","e0df7f95":"KNN.score(x_test,y_test)","84216d9c":"KNN.score(x_train,y_train)","c3292750":"y_pred=KNN.predict(x_test)\ny_pred","1cc1d1aa":"ypred=pd.DataFrame(y_pred)\nypred.head()","4ae05c0a":"import sklearn.metrics as mt","caa90d46":"mt.mean_squared_error(y_pred=KNN.predict(x_test),y_true=y_test)","f99d8621":"mt.mean_squared_error(y_pred=KNN.predict(x_train),y_true=y_train)","e0f07b53":"rms=sqrt(mean_squared_error(y_pred=KNN.predict(x_train),y_true=y_train))\nrms","a806af3d":"from sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error","6f265ce0":"rf=RandomForestRegressor(n_estimators=40,max_depth=6,random_state=0)\nrf.fit(x_train,y_train)\nrf.fit(x_test,y_test)","5420a556":"rf.score(x_test,y_test)","b75c660e":"rf.score(x_train,y_train)","e2c22ceb":"y_pred = rf.predict(x_test)\ny_pred","5870556f":"ypred=pd.DataFrame(y_pred)\nypred.head()","d1bccfd9":"rms=sqrt(mean_squared_error(y_pred=rf.predict(x_train),y_true=y_train))\nrms","4054dddc":"best_model=rf.fit(x_train, y_train)\nbest_model.feature_importances_","80d48b91":"data=pd.read_csv('..\/input\/test-sjc\/Test_SJC.csv')","eeece74a":"data.isnull().sum()","770793b9":"data=data.dropna()","04f26ddf":"data['Gender'].value_counts()","5cf8c3ac":"index_names = data[ data['Gender'] == 'U' ].index\ndata.drop(index_names, inplace = True)","f63dc1b5":"data['DateTimeOfAccident']=pd.to_datetime(data['DateTimeOfAccident'])\ndata['Month_of_accident'] =data['DateTimeOfAccident'].dt.month","2ef8a0d0":"data['DateReported']=pd.to_datetime(data['DateReported'])\ndata['Month_of_accident'] =data['DateReported'].dt.month","dfbc6a39":"data['Difference']=(df['Month_of_reported']-df['Month_of_accident'])","1b7412e8":"from sklearn.preprocessing import LabelEncoder\n\nle = LabelEncoder()\n\n\ndata['Gender'] = le.fit_transform(data['Gender'])\n\n\ndata['MaritalStatus'] = le.fit_transform(data['MaritalStatus'])\n\n                                      \ndata['PartTimeFullTime']=le.fit_transform(data['PartTimeFullTime'])","cb5816c4":"x1=data['Age']\nx2=data['Gender']\nx3=data['MaritalStatus']\nx4=data['DependentChildren']\nx5=data['WeeklyWages']\nx6=data['PartTimeFullTime']\nx7=data['InitialIncurredCalimsCost']\nx8=data['Difference']","77d891d8":"UltimateIncurredClaimCost=0.033*x1+0.0175*x2+0.0041*x3+0.075*x4+0.24*x5+0.03*x6+0.33*x7+0.04*x8","a322b018":"df=pd.read_csv('..\/input\/sample-data\/sample_submission (4).csv')\n","761fd20c":"df['UltimateIncurredClaimCost']=UltimateIncurredClaimCost","f5de0b4e":"df.to_csv('submission.csv',index=False)","cefd4bdf":"df1=pd.read_csv('submission.csv')\ndf1.head()","1ce3d1ae":"# EDA","dd1c051a":"# Random Forest","f6fe5b9a":"# Linear Regression","12d91883":"# KNN"}}