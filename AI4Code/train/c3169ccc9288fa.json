{"cell_type":{"7bdefeb7":"code","d0e59d94":"code","f4ecce64":"code","a4fb6103":"code","39d7ba2e":"code","e365ed2f":"code","5d8e21fe":"code","5e8fbea7":"code","842b7bd4":"code","2e30152f":"code","b2e5ca57":"code","afebabfc":"code","663e7886":"code","2877dbe9":"code","904f01a2":"code","37a111e7":"code","2d5ab6a7":"code","feaba4ec":"code","cf438b18":"code","1f92dfd9":"code","3c82811c":"code","f93a5b16":"markdown","0c8aeada":"markdown","4be819e7":"markdown","7418d9a7":"markdown","aba4a76d":"markdown","44d295ee":"markdown","01af036f":"markdown","c9f63f4a":"markdown","8072adfc":"markdown","2756ecd6":"markdown","43b42ab1":"markdown","18217931":"markdown"},"source":{"7bdefeb7":"import pandas as pd\n\nreviews = pd.read_csv(\"..\/input\/wine-reviews\/winemag-data-130k-v2.csv\", index_col=0)\n#pd.set_option(\"display.max_rows\", 5)\n\nfrom learntools.core import binder; binder.bind(globals())\nfrom learntools.pandas.grouping_and_sorting import *\nprint(\"Setup complete.\")","d0e59d94":"reviews.head(3)","f4ecce64":"reviews_written = reviews.groupby('taster_twitter_handle').taster_twitter_handle.count()\nreviews_written","a4fb6103":"best_rating_per_price = reviews.groupby('price')['points'].max().sort_index()\nbest_rating_per_price","39d7ba2e":"price_extremes = reviews.groupby('variety').price.agg([min, max])\nprice_extremes","e365ed2f":"sorted_varieties = price_extremes.sort_values(by=['min', 'max'], ascending=False)\nsorted_varieties","5d8e21fe":"reviewer_mean_ratings = reviews.groupby('taster_name').points.mean()\nreviewer_mean_ratings","5e8fbea7":"country_variety_counts =  reviews.groupby(['country', 'variety']).size().sort_values(ascending=False)\ncountry_variety_counts","842b7bd4":"# Your code here\nreviews_written = reviews.groupby('taster_twitter_handle').taster_twitter_handle.count()\n\n# Check your answer\nq1.check()","2e30152f":"#q1.hint()\n#q1.solution()","b2e5ca57":"best_rating_per_price = reviews.groupby('price').points.max()\n\n# Check your answer\nq2.check()","afebabfc":"#q2.hint()\n#q2.solution()","663e7886":"price_extremes = reviews.groupby('variety').price.agg([min, max])\n\n# Check your answer\nq3.check()","2877dbe9":"#q3.hint()\n#q3.solution()","904f01a2":"sorted_varieties = price_extremes.sort_values(by=['min', 'max'], ascending=False)\n\n# Check your answer\nq4.check()","37a111e7":"#q4.hint()\n#q4.solution()","2d5ab6a7":"reviewer_mean_ratings = reviews.groupby('taster_name').points.mean()\n\n# Check your answer\nq5.check()","feaba4ec":"#q5.hint()\n#q5.solution()","cf438b18":"reviewer_mean_ratings.describe()","1f92dfd9":"country_variety_counts =  reviews.groupby(['country', 'variety']).size().sort_values(ascending=False)\n\n# Check your answer\nq6.check()","3c82811c":"#q6.hint()\nq6.solution()","f93a5b16":"## 2.\nWhat is the best wine I can buy for a given amount of money? Create a `Series` whose index is wine prices and whose values is the maximum number of points a wine costing that much was given in a review. Sort the values by price, ascending (so that `4.0` dollars is at the top and `3300.0` dollars is at the bottom).","0c8aeada":"## 4.\nWhat are the most expensive wine varieties? Create a variable `sorted_varieties` containing a copy of the dataframe from the previous question where varieties are sorted in descending order based on minimum price, then on maximum price (to break ties).","4be819e7":"## 5.\nCreate a `Series` whose index is reviewers and whose values is the average review score given out by that reviewer. Hint: you will need the `taster_name` and `points` columns.","7418d9a7":"# Introduction\n\nIn these exercises we'll apply groupwise analysis to our dataset.\n\nRun the code cell below to load the data before running the exercises.","aba4a76d":"Are there significant differences in the average scores assigned by the various reviewers? Run the cell below to use the `describe()` method to see a summary of the range of values.","44d295ee":"## 6.\nWhat combination of countries and varieties are most common? Create a `Series` whose index is a `MultiIndex`of `{country, variety}` pairs. For example, a pinot noir produced in the US should map to `{\"US\", \"Pinot Noir\"}`. Sort the values in the `Series` in descending order based on wine count.","01af036f":"# Keep going\n\nMove on to the [**data types and missing data**](https:\/\/www.kaggle.com\/residentmario\/data-types-and-missing-values).","c9f63f4a":"**[Pandas Home Page](https:\/\/www.kaggle.com\/learn\/pandas)**\n\n---\n","8072adfc":"## 3.\nWhat are the minimum and maximum prices for each `variety` of wine? Create a `DataFrame` whose index is the `variety` category from the dataset and whose values are the `min` and `max` values thereof.","2756ecd6":"---\n**[Pandas Home Page](https:\/\/www.kaggle.com\/learn\/pandas)**\n\n\n\n\n\n*Have questions or comments? Visit the [Learn Discussion forum](https:\/\/www.kaggle.com\/learn-forum\/161299) to chat with other Learners.*","43b42ab1":"## 1.\nWho are the most common wine reviewers in the dataset? Create a `Series` whose index is the `taster_twitter_handle` category from the dataset, and whose values count how many reviews each person wrote.","18217931":"# Exercises"}}