{"cell_type":{"3d3988c8":"code","de800e79":"code","2b72884b":"code","518be4b4":"code","3bf015f7":"code","8b08b788":"code","fd99d93e":"code","d1d2ac7f":"code","1bedefae":"code","c1e9db16":"code","5fc13e61":"code","4f24ba6f":"code","8d3b8e87":"code","145823ca":"code","8b2607b0":"code","d5ef3cb5":"code","513af7d5":"code","1581cdee":"code","c29aab58":"markdown"},"source":{"3d3988c8":"import tensorflow as tf\nfrom tensorflow import keras \nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom tensorflow.keras.preprocessing import image\n\nimport cv2\nimport os\n\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Dropout, Flatten, Conv2D, MaxPooling2D,Input","de800e79":"base_dir = \"..\/input\/alzheimers-dataset-4-class-of-images\/Alzheimer_s Dataset\/\"","2b72884b":"train = ImageDataGenerator(rescale=1.\/255)\ntest =  ImageDataGenerator(rescale=1.\/255)\nval =  ImageDataGenerator(rescale=1.\/255)","518be4b4":"train=base_dir+ 'train\/'\n\ntrain_data = tf.keras.preprocessing.image_dataset_from_directory(\n    train,\n    validation_split=0.2,\n    image_size=(224,224),\n    batch_size=32,\n    subset='training',\n    seed=1000 )","3bf015f7":"val=base_dir+ 'train\/'\n\nval_data = tf.keras.preprocessing.image_dataset_from_directory(\n    val,\n    validation_split=0.2,\n    image_size=(224,224),\n    batch_size=32,\n    subset='validation',\n    seed=1000\n    )","8b08b788":"test=base_dir +'test\/'\n\ntest_data=tf.keras.preprocessing.image_dataset_from_directory(\n    test,\n    image_size=(224,224),\n    batch_size=32,\n    seed=1000\n    )","fd99d93e":"class_names = ['MildDementia', 'ModerateDementia', 'NonDementia', 'VeryMildDementia']","d1d2ac7f":"train_data.class_names = class_names\nval_data.class_names = class_names","1bedefae":"print(val_data)","c1e9db16":"plt.figure(figsize=(10, 10))\nfor images, labels in train_data.take(1):\n    for i in range(6):\n        ax = plt.subplot(3, 3, i + 1)\n        plt.imshow(images[i].numpy().astype(\"uint8\"))\n        plt.title(train_data.class_names[labels[i]])\n        plt.axis(\"off\")\nplt.savefig(\"sample.png\")","5fc13e61":"model=Sequential()\n\nmodel.add(Conv2D(16,(3,3), activation='relu', input_shape=(224,224,3)))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Conv2D(32,(3,3), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Conv2D(64,(3,3), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Conv2D(128,(3,3), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Dropout(0.2))\nmodel.add(Conv2D(256,(3,3), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Flatten())\nmodel.add(Dense(512,activation='relu'))\nmodel.add(Dense(256,activation='relu'))\nmodel.add(Dropout(0.7))\nmodel.add(Dense(128,activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(64,activation='relu'))\nmodel.add(Dropout(0.3))\nmodel.add(Dense(32,activation='relu'))\nmodel.add(Dense(4,activation='softmax'))\n\n\nmodel.summary()","4f24ba6f":"model.compile(optimizer = tf.keras.optimizers.Adam(1e-4), loss=\"sparse_categorical_crossentropy\", metrics=[\"accuracy\"])","8d3b8e87":"history = model.fit(train_data, validation_data=val_data, epochs=50)","145823ca":"model.evaluate(test_data)","8b2607b0":"loss_train = history.history['loss']\nloss_val = history.history['val_loss']\nplt.plot(loss_train, 'g', label='Training loss')\nplt.plot(loss_val, 'b', label='validation loss')\nplt.title('Training and Validation loss')\nplt.xlabel('Epochs')\nplt.ylabel('Loss')\nplt.legend()\nplt.savefig(\"train_vs_val_loss.png\")\nplt.show()","d5ef3cb5":"accuracy_train = history.history['accuracy']\naccuracy_val = history.history['val_accuracy']\nplt.plot(accuracy_train, 'g', label='Training accuracy')\nplt.plot(accuracy_val, 'b', label='Validation accuracy')\nplt.title('Training and Validation accuracy')\nplt.xlabel('Epochs')\nplt.ylabel('Accuracy')\nplt.legend()\nplt.savefig(\"train_vs_val_acc.png\")\nplt.show()","513af7d5":"class_names={0:\"Mild Dementia\", 1:\"Moderate Dementia\", 2:\"Non Dementia\", 3:\"Very Mild Dementia\"}","1581cdee":"plt.figure(figsize=(18,8))\nfor images, labels in val_data.take(1):\n    for i in range(10):\n        plt.subplot(2,5,i+1)\n        plt.imshow(images[i]\/255)\n        frame1 = plt.gca()\n        frame1.axes.xaxis.set_ticklabels([])\n        frame1.axes.yaxis.set_ticklabels([])\n        x = image.img_to_array(images[i])\n        x = np.expand_dims(x, axis=0)\n        p=np.argmax(model.predict(x))    \n        plt.title(\"Predicted: {}\".format(class_names[p]))\n        plt.xlabel(\"True Class: {}\".format(val_data.class_names[labels[i]]))          ","c29aab58":"# About Alzheimer\n\nAlzheimer's is a type of dementia that affects memory, thinking and behavior. Symptoms eventually grow severe enough to interfere with daily tasks. Alzheimer's is the most common cause of dementia. Alzheimer's disease accounts for 60-80% of dementia cases.\n\nAlzheimer's is a progressive disease, where dementia symptoms gradually worsen over a number of years. In its early stages, memory loss is mild, but with late-stage Alzheimer's, individuals lose the ability to carry on a conversation and respond to their environment. Alzheimer's is the sixth-leading cause of death in the United States. On average, a person with Alzheimer's lives 4 to 8 years after diagnosis but can live as long as 20 years, depending on other factors.\n\nNo treatments stop or reverse its progression, though some may temporarily improve symptoms. Affected people increasingly rely on others for assistance, often placing a burden on the caregiver. The pressures can include social, psychological, physical, and economic elements. Exercise programs may be beneficial with respect to activities of daily living and can potentially improve outcomes. Behavioral problems or psychosis due to dementia are often treated with antipsychotics, but this is not usually recommended, as there is little benefit and an increased risk of early death.\n\nThere are 7 different stages of Alzheimer:\n\n* Stage 1: Normal Outward Behavior.\n* Stage 2: Very Mild Changes.\n* Stage 3: Mild Decline.\n* Stage 4: Moderate Decline.\n* Stage 5: Moderately Severe Decline.\n* Stage 6: Severe Decline.\n* Stage 7: Very Severe Decline."}}