{"cell_type":{"a44c5763":"code","6dfe361f":"code","da653a57":"code","f9469424":"code","ca5847f7":"code","036f11ea":"code","00ac030e":"code","9d2c6e55":"code","0cbe7070":"code","babfd2ca":"code","1b7e0bbd":"code","3b42b0d3":"code","af06af8d":"code","679b610c":"code","d4fd9321":"code","a4be4ae6":"code","f9197f71":"code","1b397e84":"code","e0a3b760":"code","ff30b9ac":"code","a01053a0":"code","e5350b9c":"code","0ff41eeb":"code","e24509f7":"code","c5e913a1":"code","beab31d7":"code","b619f61f":"code","0a6ee8c5":"code","be7e20e5":"code","3ba76939":"code","38766dc2":"code","ed8f4116":"code","1946d0fa":"code","f2dfec45":"code","6bda8ce2":"code","8b28a0e7":"code","5bf0a5c0":"code","aa276a3f":"code","ed9efe18":"code","5d4221e3":"code","916f7f1c":"code","3de913fb":"code","3bd08db5":"code","df33ca6f":"code","85e518fa":"code","72f67636":"code","1df9d352":"markdown","55e048dd":"markdown","ff309625":"markdown","e40048d7":"markdown","fb7f52ab":"markdown","a71c3192":"markdown","d98c3296":"markdown","340ff492":"markdown","886ffcf0":"markdown","270fa778":"markdown","5597cc30":"markdown","8392f614":"markdown","b615d736":"markdown","749c018b":"markdown","45663766":"markdown","fae1b686":"markdown","93b9653f":"markdown","68eb3ecf":"markdown","e7f6c519":"markdown","546c4969":"markdown","7afcd1f8":"markdown","e792fab7":"markdown"},"source":{"a44c5763":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","6dfe361f":"#loading the datasets\ntrain=pd.read_csv('\/kaggle\/input\/av-healthcare-analytics-ii\/healthcare\/train_data.csv')\ntest=pd.read_csv('\/kaggle\/input\/av-healthcare-analytics-ii\/healthcare\/test_data.csv')","da653a57":"train.head()","f9469424":"test.head()","ca5847f7":"#renaming some of the features in train\ntrain.rename(columns={'Available Extra Rooms in Hospital':'Extra_Rooms','Type of Admission':'Admission_Type',\n                     'Severity of Illness':'Illness_severity','Visitors with Patient':'Visitors'},inplace=True)","036f11ea":"#renaming some of the features in test\ntest.rename(columns={'Available Extra Rooms in Hospital':'Extra_Rooms','Type of Admission':'Admission_Type',\n                     'Severity of Illness':'Illness_severity','Visitors with Patient':'Visitors'},inplace=True)","00ac030e":"train.info()","9d2c6e55":"train.describe(include='all')","0cbe7070":"#converting object type columns into categorical type\ncolumns=['Hospital_type_code','Hospital_region_code','Department', 'Ward_Type',\n       'Ward_Facility_Code','Admission_Type', 'Illness_severity', 'Age',\n       'Stay']","babfd2ca":"for i in columns:\n    train[i]=train[i].astype('category')\n    if i!='Stay':\n        test[i]=train[i].astype('category')","1b7e0bbd":"train.info()","3b42b0d3":"#checking for missing values in test and train dataset\ntrain.isnull().sum()","af06af8d":"test.isnull().sum()","679b610c":"#filling the missing value in bed grade column in both train and test\ntrain['Bed Grade']=train['Bed Grade'].fillna(1.0)","d4fd9321":"test['Bed Grade']=test['Bed Grade'].fillna(1.0)","a4be4ae6":"train.drop(columns=['City_Code_Patient'],inplace=True)\ntest.drop(columns=['City_Code_Patient'],inplace=True)","f9197f71":"train.isnull().sum()","1b397e84":"test.isnull().sum()","e0a3b760":"#importing libraries for visualization\nimport plotly.express as px\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly\nplotly.offline.init_notebook_mode(connected = True)","ff30b9ac":"train.groupby('Department')['Extra_Rooms'].agg('count')","a01053a0":"train.groupby('Bed Grade')['Extra_Rooms'].agg('count')","e5350b9c":"train.groupby('Admission_Type')['Extra_Rooms'].agg('count')","0ff41eeb":"train.groupby('Illness_severity')['Extra_Rooms'].agg('count')","e24509f7":"train.groupby('Department')['Bed Grade'].agg('mean')","c5e913a1":"train.groupby('Admission_Type')['Bed Grade'].agg('mean')","beab31d7":"train.groupby('Illness_severity')['Bed Grade'].agg('mean')","b619f61f":"px.pie(train,values='Extra_Rooms',names='Department',title='Distribution of Extra Rooms in Departments')","0a6ee8c5":"px.pie(train,values='Extra_Rooms',names='Bed Grade',title='Distribution of Bed in extra rooms')","be7e20e5":"px.pie(train,values='patientid',names='Age',title='Distribution of Age in Patients')","3ba76939":"px.pie(train,values='patientid',names='Stay',title='Distribution of Stay Length of Patients')","38766dc2":"train.columns","ed8f4116":"#taking categorical variables to label encode\ncat_columns=['Age','Stay']","1946d0fa":"#storing the encoded values both in train and test sets\nfrom sklearn.preprocessing import LabelEncoder\nl=LabelEncoder()\nfor i in cat_columns:\n    train[i]=l.fit_transform(train[i])\n    if i!='Stay':\n        test[i]=l.transform(test[i])","f2dfec45":"#generating one hot features of remaining categorical features\ntrain=pd.get_dummies(train)\ntest=pd.get_dummies(test)","6bda8ce2":"from sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import MinMaxScaler,StandardScaler\nfrom sklearn.metrics import accuracy_score","8b28a0e7":"#dropping irrelevant columns \nX=train.drop(columns=['Stay'])\nY=train['Stay']","5bf0a5c0":"X.head()","aa276a3f":"#dividing data into train and test sets\nX_train,X_valid,y_train,y_valid=train_test_split(X,Y,test_size=0.2,random_state=0)","ed9efe18":"#scaling the features\nsc=StandardScaler()\nX_train=sc.fit_transform(X_train)\nX_valid=sc.transform(X_valid)","5d4221e3":"from catboost import Pool, CatBoostClassifier","916f7f1c":"eval_dataset = Pool(data=X_valid, label=y_valid)\n# initialising catboost classifier\n\nmodel = CatBoostClassifier(iterations=500,learning_rate=0.3,\n                           eval_metric='Accuracy')","3de913fb":"model.fit(X_train,y_train,eval_set=eval_dataset)","3bd08db5":"model.get_best_score()","df33ca6f":"test_dataset=Pool(test)","85e518fa":"y_pred=model.predict(test_dataset)","72f67636":"y_pred","1df9d352":"* 'Gynecology' Department has most number of extra rooms allotted.\n* 'Surgery' Department has the minimum number of extra rooms allotted.","55e048dd":"## MODEL BUILDING","ff309625":"This notebook will be updated shortly.","e40048d7":"## EXPLORATORY DATA ANALYSIS","fb7f52ab":"Training accuracy-47.17%\n\nValidation accuracy-42.27%","a71c3192":"The patient admitted to the hospital are mostly of middle age i.e. age 31-40 and 41-50.","d98c3296":"Most of the extra rooms have beds of grade 2 followed by grade 3.","340ff492":"Since City_Code_Patient has many missing values which are irrelevant so dropping the column from both train and test sets.","886ffcf0":"Most of the rooms are allotted for patients having moderate severity.","270fa778":"Those patients who have emergent situations get less grade beds than those who have trauma and urgent situations.","5597cc30":"Columns 'Bed Grade' has 35 missing values and 'City_Code_Patient' has 2157 missing values in the test dataset.","8392f614":"Most of the extra rooms contain bed grade of 2 followed by grade 3.","b615d736":"**If you like this notebook do upvote it.**\n\nFeedback and Suggestions are always appreciated.\n\nDo checkout my other notebooks at https:\/\/www.kaggle.com\/tmchls","749c018b":"* Continuous Columns 'case_id','Extra_Rooms','patientid','City_Code_Patient','Visitors','Admission_Deposit' have a large difference between 75th quartile and maximum values which depicts presence of outliers in the columns.\n* Object or discrete columns have many repeated values of unique labels which have to be numerically encoded. \n* Since the target variable has 11 unique values(classes) therefore this dataset is an classification dataset.","45663766":"Gynaecology department has most number of rooms whereas Surgery has least number of rooms.","fae1b686":"* 'Anaesthesia' Department has mostly beds above grade 3.\n* 'Surgery' Department has mostly beds around grade 2.","93b9653f":"Most of the patients stay in hospital for about 11-20 and 21-30 days.","68eb3ecf":"Columns 'Bed Grade' has 113 missing values and 'City_Code_Patient' has 4532 missing values in the train dataset","e7f6c519":"* Many columns in the dataset are of object type.\n* Target variable('Stay') is of object type\n* We have to convert object columns into numerical form for fitting of the model.\n","546c4969":"Those patients who have minor disease are allotted rooms having bed around grade 3.","7afcd1f8":"## VARIABLE ENCODING","e792fab7":"Most of the rooms are allotted for trauma situations."}}