{"cell_type":{"caf1e647":"code","408c126e":"code","06ee1023":"code","e559dbec":"code","a016e4a4":"markdown"},"source":{"caf1e647":"! pip install -q --no-index --find-links \/kaggle\/input\/pytorchtabnet\/pytorch_tabnet-2.0.0-py3-none-any.whl pytorch-tabnet","408c126e":"import pandas as pd\nimport numpy as np","06ee1023":"weight = [2.58401664e-01, 2.63939274e-01, 7.89299182e-17, 3.16070840e-01, 1.61588222e-01]","e559dbec":"test = pd.read_csv('..\/input\/lish-moa\/test_features.csv')\nif len(test) == 3982:\n    submission = pd.read_csv('..\/input\/lish-moa\/sample_submission.csv')\n    submission.to_csv('submission.csv', index=False)\nelse:\n    ! python ..\/input\/better-cv-pl-v1\/v1_inference.py\n    ! python ..\/input\/moa-sin-v2\/v2_inference.py\n    ! python ..\/input\/baseline-inference\/moa_lstm_inference.py\n    ! python ..\/input\/resnet-sin-v3\/v3_inference.py\n    ! python ..\/input\/inference-scripts\/moa-tabnet-correct-inference-freezepca.py\n    submission = pd.read_csv('..\/input\/lish-moa\/sample_submission.csv')\n    submission.iloc[:, 1:] = 0\n    subv1 = pd.read_csv('.\/submission_v1_sin.csv')\n    subv2 = pd.read_csv('.\/submission_v2_sin.csv')\n    subv3 = pd.read_csv('.\/submission_v3_sin.csv')\n    subv4 = pd.read_csv('.\/submission_v4_sin.csv')\n    subv5 = pd.read_csv('.\/submission_tabnet_correct.csv')\n    submission.iloc[:, 1:] = subv1.iloc[:, 1:] * weight[0] + subv2.iloc[:, 1:] * weight[1] + subv3.iloc[:, 1:] * weight[2] + subv4.iloc[:, 1:] * weight[3] + subv5.iloc[:, 1:] * weight[4]\n    submission.to_csv('submission.csv', index=False)","a016e4a4":"## Main Idea\n* write your inference as python scripts so that each time it should clear the cache and reset the state\n* submit sample submission to pass through initial commit\n* run all inference codes for whole test set\n"}}