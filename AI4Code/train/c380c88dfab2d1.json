{"cell_type":{"ad48f5f6":"code","fc06de29":"code","91e2ddb7":"code","69f1be97":"code","41bd64e3":"code","0dd186fe":"code","516654df":"code","3bd3b856":"markdown","4c3bcc6f":"markdown","b258864a":"markdown","7ec53aa8":"markdown","7b26e0f3":"markdown","469d8a2a":"markdown","8f1d1935":"markdown","88a70568":"markdown","4b2b7d92":"markdown","bd51a965":"markdown","80aba724":"markdown","44fff310":"markdown","89f1b1a6":"markdown","3d593d4b":"markdown","3eacbcb8":"markdown"},"source":{"ad48f5f6":"import time\nimport statsmodels.api as sm\nimport csv\nimport pandas as pd\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import roc_auc_score\nfrom sklearn.metrics import roc_curve\nimport matplotlib.pyplot as plt\nimport math\nfrom sklearn.preprocessing import OrdinalEncoder\nimport pandas as pd\nimport numpy as np\nfrom sklearn import preprocessing\nimport matplotlib.pyplot as plt \nplt.rc(\"font\", size=14)\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn import metrics\nfrom sklearn.metrics import classification_report, confusion_matrix, accuracy_score\nfrom sklearn import svm, datasets\nfrom sklearn.tree import DecisionTreeClassifier\nfrom tqdm.notebook import tqdm\nimport janestreet\n\n","fc06de29":"train = pd.read_csv('\/kaggle\/input\/jane-street-market-prediction\/train.csv',low_memory=False, nrows=10000)","91e2ddb7":"#encode the numeric value to 1 and 0\n\ntrain['action']=(train['resp'].values>0).astype(int)\nf_mean=train.mean()\ntrain=train.fillna(f_mean)\n\ntrain=train.drop(['resp_1','resp_2','resp_3','resp_4','resp','ts_id'], axis=1)\ntrain.shape","69f1be97":"# get the list of all x features to the list \ntrainx=train.drop(['action'], axis=1)\ncols=trainx.columns\nfeatures = cols.to_list()\n","41bd64e3":"X_train, X_val, Y_train, Y_val = train_test_split(trainx, train[['action']], test_size=0.5, random_state=0)","0dd186fe":"colnameout=['Classifier','roc_auc']\napproach=pd.DataFrame(columns=colnameout)\n\n\nclf = RandomForestClassifier(n_estimators=200, random_state=0)\nclf.fit(X_train, Y_train)\n\nname='RandomForest'\npred_y_0 = clf.predict(X_val)\nprob_y_valrf = clf.predict_proba(X_val)[:,1]\npred_y_0=pd.DataFrame(clf.predict(X_val))\npred_y_0.columns = ['Prob']\n\npred_y_0['ypred'] = np.where(pred_y_0['Prob']>=0.5,1,0)\npred_y_0=np.array(pred_y_0['ypred'] )\n\n\ny_probs = clf.predict(X_val)\n\nrocscore=roc_auc_score(Y_val, prob_y_valrf)\n\n\ndef plot_roc_auc(Y_val, prob_y_valrf, lbl):\n    plt.figure(figsize=(8,6))\n    roc_auc = roc_auc_score(Y_val, y_probs)\n    fpr, tpr, thresholds = roc_curve(Y_val, prob_y_valrf)\n    plt.plot(fpr, tpr, label='Random Forest ROC(area = %0.2f)' % roc_auc)\n    plt.plot([0, 1], [0, 1],'r--')\n    plt.xlim([0.0, 1.0])\n    plt.ylim([0.0, 1.05])\n    plt.xlabel('False Positive Rate',fontsize=18)\n    plt.ylabel('True Positive Rate',fontsize=18)\n    plt.title('Random Forest characteristic- Random Forest classifier',fontsize=20)\n    plt.legend(loc=\"lower right\")\n   \n    plt.show()\n   \nplot_roc_auc(Y_val, prob_y_valrf, 'Random Forest ')    ","516654df":"env = janestreet.make_env()\nenv_iter = env.iter_test()\n\nfor (test_df, prediction_df) in env_iter:\n    if test_df['weight'].item() == 0:\n        prediction = 0\n        prediction_df.action=prediction\n        env.predict(prediction_df)\n    else:\n        test=test_df.fillna(f_mean)\n        X_test = test.loc[:,features]\n        y_preds=clf.predict(X_test)\n        prediction_df.action=y_preds\n        env.predict(prediction_df)","3bd3b856":"# <font color='darkblue'>Jane street data prediction<\/font>\n\n#### This notebook includes a basic random forest classification model analysis. Each snippet of code shows explanation.Hopefully this will be helpful for someone who is trying kaggle competition for the first time.<br>\n\n### <span style='background :yellow'>Please feel free to upvote and comment if you have any questions<span>","4c3bcc6f":"### <center> <font color='darkblue'>                                 Create action variable<font>","b258864a":"<font color='darkblue'>===================================================================================================================================================================\n=================================================================================================================================================================<font>","7ec53aa8":"### <center> <font color='darkblue'>                                Split the dataset for validation<font>","7b26e0f3":"#### Please note that I've uploaded only 10K rows. Please exclude nrow's in order to import the entire train dataset.","469d8a2a":"### <center> <font color='darkblue'>                                Submission<font>","8f1d1935":"1. Split the dataset into train and validation data. \n2. I split the dataset to half. So, we have 5000 rows for train data and 5000 rows for validation. In other words, I will train the model on 5K rows on train data and test it on validation data to determine the accuracy.","88a70568":"### <center> <font color='darkblue'>                                Creating the model and determining the ROC score from it.<font>","4b2b7d92":"![](https:\/\/media1.tenor.com\/images\/e5d4fff0602734f5e0d23ec814dc31c5\/tenor.gif?itemid=19594862)","bd51a965":"1. Trainx is a dataset without y variable. Now, as we need this for creating the model. This dataset basically has all the independent variable columns.\n2. Features includes all the independent column names.","80aba724":"1. Here we need to create an action variable. This can be done by using 'resp' variable. All the Resp column rows greater than 0 will be coded 1 for action column. And the rows with value less than or equal to 0 are coded as 0. This basically makes the Jane street analysis a binary classification.<br>\n2. Independent variables 'resp_1','resp_2','resp_3','resp_4','resp','ts_id' are not showing up in test datasety. So, remove these from train dataset.\n","44fff310":"<h1><left>Lets get started!!<\/left><\/h1>\n\n![](https:\/\/media1.tenor.com\/images\/7cb11ffe975452b5db7ca97b34b9d662\/tenor.gif?itemid=19594590)","89f1b1a6":"### <center> <font color='darkblue'>                                 Get features list.<font>","3d593d4b":"### <center> <font color='darkblue'>                                 Import the train dataset<font>","3eacbcb8":"### <center> <font color='darkblue'>                                 Lets import all necessary Libraries!<font>\n### <center><font color='darkblue'>                            All packages that this notebook needs are below. :)<font>\n    \n"}}