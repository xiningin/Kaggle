{"cell_type":{"c787fa66":"code","ab939bac":"code","ecf8c197":"code","5e48cb9d":"code","13f9686e":"code","e3957507":"code","0ac73672":"code","e31bc6ad":"code","7855a737":"code","a0e8494a":"code","8e6bbd97":"code","67fe0bd0":"code","e6460b11":"code","65a548c1":"markdown","83cd7798":"markdown","0cfcd07c":"markdown","115c2b22":"markdown","2e2fce00":"markdown","843ffa4a":"markdown","46b3f404":"markdown","a3315e45":"markdown"},"source":{"c787fa66":"import numpy as np\nimport pandas as pd\n\nfrom kaggle.competitions import twosigmanews\n\n# Read data but just once\nif 'env' not in globals():\n    env = twosigmanews.make_env()\n    (market_train_df, news_train_df) = env.get_training_data()","ab939bac":"market_train_df.head().T","ecf8c197":"df = market_train_df[[\n    'assetCode',\n    'open', \n    'returnsOpenPrevRaw1', \n    'returnsOpenPrevMktres1', \n    'returnsOpenPrevRaw10', \n    'returnsOpenPrevMktres10', \n    'returnsOpenNextMktres10']].copy()","5e48cb9d":"df['prevopen'] = df.groupby(['assetCode'])['open'].shift(1)\ndf['returnsMyOpenPrevRaw1_prev'] = (df.open - df.prevopen) \/ df.prevopen\ndf['returnsMyOpenPrevRaw1_current'] = (df.open - df.prevopen) \/ df.open","13f9686e":"df[['returnsOpenPrevRaw1', 'returnsMyOpenPrevRaw1_prev', 'returnsMyOpenPrevRaw1_current']].corr()","e3957507":"df[['returnsOpenPrevRaw1', 'returnsMyOpenPrevRaw1_prev']].sample(10).T","0ac73672":"df[['returnsOpenPrevRaw1', 'returnsOpenPrevMktres1']].corr()","e31bc6ad":"df['prevopen10'] = df.groupby(['assetCode'])['open'].shift(10)\ndf['returnsMyOpenPrevRaw10'] = (df.open - df.prevopen10) \/ df.prevopen10\ndf[['returnsOpenPrevRaw10', 'returnsMyOpenPrevRaw10']].corr()","7855a737":"df[['returnsOpenPrevRaw10', 'returnsMyOpenPrevRaw10']].sample(10).T","a0e8494a":"df[['returnsOpenPrevRaw10', 'returnsOpenPrevMktres10']].corr()","8e6bbd97":"df['nextmktres10_10'] = df.groupby(['assetCode'])['returnsOpenNextMktres10'].shift(10)\ndf['nextmktres10_11'] = df.groupby(['assetCode'])['returnsOpenNextMktres10'].shift(11)\ndf['nextmktres10_12'] = df.groupby(['assetCode'])['returnsOpenNextMktres10'].shift(12)","67fe0bd0":"df[['returnsOpenPrevMktres10', 'nextmktres10_10', 'nextmktres10_11', 'nextmktres10_12']].corr()","e6460b11":"df[['returnsOpenPrevMktres10', 'nextmktres10_11']].sample(10).T","65a548c1":"So, **returnsOpenPrevMktres10** and **returnsOpenNextMktres10** are the same but with shift in 11 days","83cd7798":"Let us check correlation between Raw and Mktres","0cfcd07c":"# 1 Day analysis","115c2b22":"The purpose of this notebook is to find correlations between data (open, returns) in the market dataset.","2e2fce00":"# Mktres Prev\/Next Correlation","843ffa4a":"1. So, the right calculation for **returnsOpenPrevRaw1**:\n> **(open - prevopen) \/ prevopen**[](http:\/\/)\n> \n\nAnd values are mostly the same","46b3f404":"Preparing dataframe copy (snce we may read data onlyone and I don't want to waste time to re-run data reading)","a3315e45":"# 10 Days"}}