{"cell_type":{"d937c386":"code","d861730f":"code","19a56e0d":"code","ec027408":"code","e11c9394":"code","39decffb":"code","74ffaf21":"code","7cfa3f3d":"code","8589d50d":"code","8bf0c356":"code","945466ad":"code","0e920851":"code","2a63175c":"code","f6731f59":"code","d4d9a93a":"code","fbfcd675":"code","58c64be3":"code","0ba748d8":"code","52407e60":"code","9166e23a":"code","8a4a8ffd":"markdown","385b6ae0":"markdown","30c986f9":"markdown","87d2eb8e":"markdown","d6516ac6":"markdown","9999b8cc":"markdown","40bab9ae":"markdown","4b460f41":"markdown","a66c588e":"markdown","b1af86a1":"markdown","d1872fc0":"markdown","e150e434":"markdown","f6d0ad1e":"markdown","33ab2393":"markdown","0757192c":"markdown","618aa89e":"markdown","546c70c9":"markdown","8b6c126f":"markdown"},"source":{"d937c386":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport cv2\nfrom sklearn import preprocessing\nfrom tqdm import tqdm\nimport os","d861730f":"train_df = pd.read_csv('..\/input\/plant-pathology-2021-fgvc8\/train.csv')\ntrain_df","19a56e0d":"train_df.labels.value_counts().to_frame().style.background_gradient(cmap=\"plasma\")","ec027408":"plt.figure(figsize=(8, 4))\nsns.countplot(y=\"labels\", data=train_df)","e11c9394":"# label_encoder object knows how to understand word labels.\nlabel_encoder = preprocessing.LabelEncoder()\n  \n# Encode labels in column 'species'.\ntrain_df[\"labels_code\"]= label_encoder.fit_transform(train_df[[\"labels\"]])\ntrain_df","39decffb":"BASE_DIR = \"..\/input\/plant-pathology-2021-fgvc8\"\n\nimg_shapes = {}\nfor image_name in tqdm(os.listdir(os.path.join(BASE_DIR, \"train_images\"))[:300]):\n    image = cv2.imread(os.path.join(BASE_DIR, \"train_images\", image_name))\n    img_shapes[image.shape] = img_shapes.get(image.shape, 0) + 1\n\nprint(img_shapes)","74ffaf21":"def visualize_batch(image_ids, labels):\n    plt.figure(figsize=(16, 12))\n    \n    for ind, (image_id, label) in enumerate(zip(image_ids, labels)):\n        plt.subplot(3, 3, ind + 1)\n        image = cv2.imread(os.path.join(BASE_DIR, \"train_images\", image_id))\n        image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)\n\n        plt.imshow(image)\n        plt.title(f\"Class: {label}\", fontsize=12)\n        plt.axis(\"off\")\n    \n    plt.show()","7cfa3f3d":"tmp_df = train_df.sample(9)\nimage_ids = tmp_df[\"image\"].values\nlabels = tmp_df[\"labels\"].values\n\nvisualize_batch(image_ids, labels)","8589d50d":"tmp_df = train_df[train_df[\"labels_code\"] == 0]\nprint(f\"Total train images for class 0: {tmp_df.shape[0]}\")\n\ntmp_df = tmp_df.sample(9)\nimage_ids = tmp_df[\"image\"].values\nlabels = tmp_df[\"labels\"].values\n\nvisualize_batch(image_ids, labels)","8bf0c356":"tmp_df = train_df[train_df[\"labels_code\"] == 1]\nprint(f\"Total train images for class 1: {tmp_df.shape[0]}\")\n\ntmp_df = tmp_df.sample(9)\nimage_ids = tmp_df[\"image\"].values\nlabels = tmp_df[\"labels\"].values\n\nvisualize_batch(image_ids, labels)","945466ad":"tmp_df = train_df[train_df[\"labels_code\"] == 2]\nprint(f\"Total train images for class 1: {tmp_df.shape[0]}\")\n\ntmp_df = tmp_df.sample(9)\nimage_ids = tmp_df[\"image\"].values\nlabels = tmp_df[\"labels\"].values\n\nvisualize_batch(image_ids, labels)","0e920851":"tmp_df = train_df[train_df[\"labels_code\"] == 3]\nprint(f\"Total train images for class 1: {tmp_df.shape[0]}\")\n\ntmp_df = tmp_df.sample(9)\nimage_ids = tmp_df[\"image\"].values\nlabels = tmp_df[\"labels\"].values\n\nvisualize_batch(image_ids, labels)","2a63175c":"tmp_df = train_df[train_df[\"labels_code\"] == 4]\nprint(f\"Total train images for class 1: {tmp_df.shape[0]}\")\n\ntmp_df = tmp_df.sample(9)\nimage_ids = tmp_df[\"image\"].values\nlabels = tmp_df[\"labels\"].values\n\nvisualize_batch(image_ids, labels)","f6731f59":"tmp_df = train_df[train_df[\"labels_code\"] == 5]\nprint(f\"Total train images for class 1: {tmp_df.shape[0]}\")\n\ntmp_df = tmp_df.sample(9)\nimage_ids = tmp_df[\"image\"].values\nlabels = tmp_df[\"labels\"].values\n\nvisualize_batch(image_ids, labels)","d4d9a93a":"tmp_df = train_df[train_df[\"labels_code\"] == 6]\nprint(f\"Total train images for class 1: {tmp_df.shape[0]}\")\n\ntmp_df = tmp_df.sample(9)\nimage_ids = tmp_df[\"image\"].values\nlabels = tmp_df[\"labels\"].values\n\nvisualize_batch(image_ids, labels)","fbfcd675":"tmp_df = train_df[train_df[\"labels_code\"] == 7]\nprint(f\"Total train images for class 1: {tmp_df.shape[0]}\")\n\ntmp_df = tmp_df.sample(9)\nimage_ids = tmp_df[\"image\"].values\nlabels = tmp_df[\"labels\"].values\n\nvisualize_batch(image_ids, labels)","58c64be3":"tmp_df = train_df[train_df[\"labels_code\"] == 8]\nprint(f\"Total train images for class 1: {tmp_df.shape[0]}\")\n\ntmp_df = tmp_df.sample(9)\nimage_ids = tmp_df[\"image\"].values\nlabels = tmp_df[\"labels\"].values\n\nvisualize_batch(image_ids, labels)","0ba748d8":"tmp_df = train_df[train_df[\"labels_code\"] == 9]\nprint(f\"Total train images for class 1: {tmp_df.shape[0]}\")\n\ntmp_df = tmp_df.sample(9)\nimage_ids = tmp_df[\"image\"].values\nlabels = tmp_df[\"labels\"].values\n\nvisualize_batch(image_ids, labels)","52407e60":"tmp_df = train_df[train_df[\"labels_code\"] == 10]\nprint(f\"Total train images for class 1: {tmp_df.shape[0]}\")\n\ntmp_df = tmp_df.sample(9)\nimage_ids = tmp_df[\"image\"].values\nlabels = tmp_df[\"labels\"].values\n\nvisualize_batch(image_ids, labels)","9166e23a":"tmp_df = train_df[train_df[\"labels_code\"] == 11]\nprint(f\"Total train images for class 1: {tmp_df.shape[0]}\")\n\ntmp_df = tmp_df.sample(9)\nimage_ids = tmp_df[\"image\"].values\nlabels = tmp_df[\"labels\"].values\n\nvisualize_batch(image_ids, labels)","8a4a8ffd":"<a id=\"4\"><\/a>\n<h2 style='background:#5BEB9C; border:0; color:black'><center>0 - Complex<center><h2>","385b6ae0":"<a id=\"4\"><\/a>\n<h2 style='background:#5BEB9C; border:0; color:black'><center>1 - frog_eye_leaf_spot<center><h2>","30c986f9":"<a id=\"4\"><\/a>\n<h2 style='background:#5BEB9C; border:0; color:black'><center>10 - scab frog_eye_leaf_spot<center><h2>","87d2eb8e":"<a id=\"4\"><\/a>\n<h2 style='background:#5BEB9C; border:0; color:black'><center>9 - scab<center><h2>","d6516ac6":"As we can see, the dataset has a fairly large imbalance.","9999b8cc":"<a id=\"4\"><\/a>\n<h2 style='background:#5BEB9C; border:0; color:black'><center>8 - rust frog_eye_leaf_spot<center><h2>","40bab9ae":"Let's visualize a sample of images","4b460f41":"<a id=\"4\"><\/a>\n<h2 style='background:#5BEB9C; border:0; color:black'><center>2 - frog_eye_leaf_spot complex<center><h2>","a66c588e":"Let's take a look at the dimensions of the first 300 images \n\nAs you can see below, all images are of different sizes.","b1af86a1":"<a id=\"4\"><\/a>\n<h2 style='background:#5BEB9C; border:0; color:black'><center>3 - healthy<center><h2>","d1872fc0":"<a id=\"4\"><\/a>\n<h2 style='background:#5BEB9C; border:0; color:black'><center>7 - rust complex<center><h2>","e150e434":"<a id=\"4\"><\/a>\n<h2 style='background:#5BEB9C; border:0; color:black'><center>5 - powdery_mildew complex<center><h2>","f6d0ad1e":"<a id=\"4\"><\/a>\n<h2 style='background:#5BEB9C; border:0; color:black'><center>4 - powdery_mildew<center><h2>","33ab2393":"Next steps:\n1. Data augmentation using [albumentations](https:\/\/albumentations.ai\/) to address class imbalance problem.\n2. Study related literature to aquire domain knowledge.\n3. Implement a baseline model to get an idea.\n4. Create submission method.\n\nFeel free to fork and edit the notebook.\n\nspecial thanks to [Yaroslav Isaienkov](https:\/\/www.kaggle.com\/ihelon\/cassava-leaf-disease-exploratory-data-analysis)\n\nWork in progress","0757192c":"<a id=\"4\"><\/a>\n<h2 style='background:#5BEB9C; border:0; color:black'><center>11 - scab frog_eye_leaf_spot complex<center><h2>","618aa89e":"<a id=\"4\"><\/a>\n<h2 style='background:#5BEB9C; border:0; color:black'><center>Data Visualization<center><h2>","546c70c9":"Let's label encode the classes","8b6c126f":"<a id=\"4\"><\/a>\n<h2 style='background:#5BEB9C; border:0; color:black'><center>6 - rust<center><h2>"}}