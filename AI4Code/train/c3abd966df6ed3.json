{"cell_type":{"b9d77547":"code","7770dbce":"code","3995234f":"code","1e0fffba":"code","d8f75c50":"code","29148507":"code","ee377085":"code","d4d9943b":"code","61fd7d48":"code","7641fb66":"code","21f66a00":"code","a78f91a2":"code","44f8b54a":"code","6bba769a":"code","7f93c499":"code","aeb19e72":"code","6f50d2a0":"code","5bae9335":"code","41fd93e1":"code","e2741376":"code","0e1b652c":"code","0635b1d0":"code","af43d0d6":"code","ef309fd2":"code","775020c6":"code","a8294db4":"markdown","2eb05952":"markdown","e4cf501a":"markdown","b235c925":"markdown","5e4d9099":"markdown","eaf41eb5":"markdown","36ca7a59":"markdown","1821cbd1":"markdown","b6edd6ef":"markdown","18e79b0c":"markdown","f9bebc99":"markdown","88b254cd":"markdown","ecac0d40":"markdown","a65bbc73":"markdown"},"source":{"b9d77547":"import numpy as np\nfrom imblearn.over_sampling import RandomOverSampler\nfrom imblearn.pipeline import Pipeline\nfrom sklearn.model_selection import RepeatedStratifiedKFold, train_test_split, GridSearchCV \nfrom xgboost import XGBClassifier\nfrom sklearn.metrics import accuracy_score, plot_confusion_matrix, f1_score, precision_score, recall_score\nfrom collections import Counter\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.simplefilter(action='ignore', category=FutureWarning)\nwarnings.simplefilter(action='ignore', category=UserWarning)","7770dbce":"df = pd.read_csv(\"..\/input\/travel-insurance-prediction-data\/TravelInsurancePrediction.csv\")","3995234f":"df.head()","1e0fffba":"df.drop(columns=[\"Unnamed: 0\"], inplace=True)","d8f75c50":"df.isnull().sum()","29148507":"plt.figure(figsize=(40,10))\nsns.countplot('AnnualIncome',hue='TravelInsurance',data=df)\nplt.show()","ee377085":"sns.countplot('FrequentFlyer',hue='TravelInsurance',data=df)\nplt.show()","d4d9943b":"sns.countplot('ChronicDiseases',hue='TravelInsurance',data=df)\nplt.show()","61fd7d48":"sns.countplot('EverTravelledAbroad',hue='TravelInsurance',data=df)\nplt.show()","7641fb66":"sns.countplot('Age',hue='TravelInsurance',data=df)\nplt.show()","21f66a00":"sns.countplot('FamilyMembers',hue='TravelInsurance',data=df)\nplt.show()","a78f91a2":"sns.countplot('GraduateOrNot',hue='TravelInsurance',data=df)\nplt.show()","44f8b54a":"# Creating a numpy array of Age values \nx = df['Age'].values\n# List of new categories\ncat = [0, 1]\n# New column based on certain conditions\ndf['AgeCategory']=np.select([x<=32, x>32],cat)","6bba769a":"x = df['AnnualIncome'].values\ncat = [0, 1]\ndf['AnnualCategory']=np.select([x<=1300000, x>1300000],cat)","7f93c499":"df['Employment Type'].replace({'Private Sector\/Self Employed':0, 'Government Sector':1},inplace=True)\ndf['GraduateOrNot'].replace({'No':0, 'Yes':1},inplace=True)\ndf['FrequentFlyer'].replace({'No':0, 'Yes':1},inplace=True)\ndf['EverTravelledAbroad'].replace({'No':0, 'Yes':1},inplace=True)","aeb19e72":"df_use = df.drop(columns=[\"AnnualIncome\", \"Age\"])","6f50d2a0":"df_use.head()","5bae9335":"X = df_use.drop(columns=[\"TravelInsurance\"])\ny = df_use.TravelInsurance","41fd93e1":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)\nCounter(y_train)","e2741376":"oversample = RandomOverSampler()\nX_over, y_over = oversample.fit_resample(X_train, y_train)\nCounter(y_over)","0e1b652c":"clf = XGBClassifier()","0635b1d0":"cv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)","af43d0d6":"params = {'alpha': (0.1, 10), 'max_depth': (5, 10), 'learning_rate': (0.1, 1)}\nclf = GridSearchCV(clf, scoring='f1_micro', cv=cv, param_grid=params)\nclf.fit(X_train, y_train)","ef309fd2":"xgb = clf.best_estimator_\ny_pred = xgb.predict(X_test)\nprint('XGBoost model accuracy score: {0:0.4f}'. format(accuracy_score(y_test, y_pred)))\nprint('XGBoost model F1 score: {0:0.4f}'. format(f1_score(y_test, y_pred)))\nprint('XGBoost model precision score: {0:0.4f}'. format(precision_score(y_test, y_pred)))\nprint('XGBoost model recall score: {0:0.4f}'. format(recall_score(y_test, y_pred)))","775020c6":"plot_confusion_matrix(xgb, X_test, y_test)  \nplt.show()","a8294db4":"Let's take a first look on the data:","2eb05952":"# Feature engineering","e4cf501a":"# EDA","b235c925":"\"ChronicDiseases\" doesnt seem to have much inpact on the target.","5e4d9099":"We no more in need of those columns:","eaf41eb5":"Replace words with 0\/1 categories.","36ca7a59":"Ok, no missing values.","1821cbd1":"People who has travelled abroad are more likely to take travel insurance.","b6edd6ef":"Let's do oversampling in every fold of dataset separately.","18e79b0c":"We can see that people with annual income greater that 1350000 have a strong tendention to take a travel insurance. We will use this info later for feature engineering.","f9bebc99":"# Model learning","88b254cd":"People older that 33 usually take travel insurance. Take that for feature engineering.","ecac0d40":"Frequent flyers are more likely to take travel insurance.","a65bbc73":"We will use np.select to create categorical features."}}