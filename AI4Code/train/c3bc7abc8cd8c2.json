{"cell_type":{"ea7c6c2f":"code","edcd6197":"code","216cb636":"code","57830acd":"code","bea204a1":"code","6cbe89b9":"code","f5805643":"code","c3d85ae4":"code","91f483a8":"code","3dadfc6e":"code","01588619":"code","1492c793":"code","45822052":"code","8bacf5d4":"code","2c6bbd5a":"code","27e27273":"code","a3f86b02":"code","51a27117":"code","fe05a9ff":"code","12985596":"code","d2dc08ed":"code","c8f16acd":"code","e08ae36d":"code","9c4d17c2":"code","26314352":"code","4e5345a3":"code","fa2657f8":"code","66baccfd":"code","c70f70c5":"code","623834f8":"code","c503a870":"code","18c2e842":"code","4bd2e270":"code","dfe6bc92":"code","3db65981":"code","7287c812":"code","7ac8f4ba":"code","b0308bc0":"code","ba01c762":"code","1e2bc9c4":"code","2887ee91":"code","c319d623":"code","baa69bb4":"code","a4ad84d2":"code","d5a18a2b":"code","ae9e48d4":"code","1578ca36":"code","23db49e1":"code","065ad12b":"code","33209da4":"code","4f49ef7c":"code","a6632eaf":"code","5c9c99c0":"code","5b531978":"code","4e76d0b8":"code","d3d991de":"code","70cd714b":"code","c0cce768":"code","6a7dc73d":"code","33148b87":"code","65402596":"code","5592c0b5":"code","6095d725":"code","d4e592d2":"code","7b520d80":"code","96d60694":"code","e78b0d2c":"code","55687cf6":"markdown","9ab3f7c9":"markdown","730c0c5c":"markdown","dc85cd03":"markdown","e5338536":"markdown","d9e9c0ed":"markdown","be5dcfb7":"markdown","6d802bf2":"markdown","951d3bc8":"markdown","c420b114":"markdown","63bdfbfd":"markdown","e7afca88":"markdown","32e2c2cf":"markdown","bd7b3131":"markdown","e65a2243":"markdown","da0d104a":"markdown","34e6ecc6":"markdown","3613e6c6":"markdown","efd8e660":"markdown","c79bc635":"markdown","f903aa43":"markdown","c14155bf":"markdown","704f5eb3":"markdown","b7e95f8c":"markdown","4d4fd1b8":"markdown","4209165e":"markdown","db150d7a":"markdown","ab47911b":"markdown","c52be452":"markdown","75776c01":"markdown","29bb186e":"markdown","a9db2690":"markdown","465bbfe1":"markdown","310f3372":"markdown","aea50e63":"markdown","2c3587f6":"markdown","ec5e932d":"markdown","6a01b04c":"markdown","04adbd2f":"markdown","76873227":"markdown","ca93e02d":"markdown","694e31aa":"markdown","2aab7a97":"markdown","f9a94e23":"markdown","1307e6d0":"markdown","835f1efe":"markdown","36242c57":"markdown","ac17b126":"markdown","64eb1e6a":"markdown","201ffa6c":"markdown"},"source":{"ea7c6c2f":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport statsmodels\nimport matplotlib.pyplot as plt\nimport folium\nfrom folium.plugins import HeatMap, HeatMapWithTime, MarkerCluster\nfrom pandas_profiling import ProfileReport\nimport plotly.express as px\nimport pprint\nimport plotly.graph_objs as go\nimport matplotlib as mpl\nimport calendar","edcd6197":"sns.palplot(sns.color_palette(\"GnBu_d\",10))\nsns.set_palette(sns.color_palette(\"GnBu_d\",10))","216cb636":"pd.set_option('display.max_colwidth', -1)\npd.set_option('display.max_columns', None)\npd.set_option('display.max_rows', 20)","57830acd":"df = pd.read_csv(\"..\/input\/seattle-sdot-collisions-data\/Collisions.csv\", low_memory=False, parse_dates=[\"INCDATE\"])\ndf_original = df.copy()\ndf.head()","bea204a1":"df.shape","6cbe89b9":"corrMatrix = df.corr()\nfig, ax = plt.subplots(figsize=(10,10))\nsns.heatmap(corrMatrix, annot=True, ax=ax)\nplt.show()","f5805643":"df.drop([\"INCKEY\",\"COLDETKEY\"],axis=1,inplace=True)","c3d85ae4":"df[\"UNDERINFL\"].unique()","91f483a8":"def for_UNDERINFL(x):\n    if x in ['Y','1']:\n        return \"Y\"\n    elif x in ['N','0']:\n        return \"N\"\n    else:\n        return x\n    \ndf[\"UNDERINFL\"] = df[\"UNDERINFL\"].apply(for_UNDERINFL)","3dadfc6e":"temp = df[[\"SEVERITYCODE\",\"SEVERITYDESC\"]]\ntemp[~(temp.duplicated())].style.hide_index()","01588619":"df[\"SEVERITYCODE\"].fillna('0', inplace=True)","1492c793":"df[\"ADDRTYPE\"].fillna('Not Mentioned', inplace=True)","45822052":"df[\"MONTH\"] = df[\"INCDATE\"].dt.month\ndf[\"YEAR\"] = df[\"INCDATE\"].dt.year","8bacf5d4":"sns.countplot(df[\"SEVERITYCODE\"])","2c6bbd5a":"df[\"SEVERITYCODE\"].value_counts(normalize=True)*100","27e27273":"fig, ax = plt.subplots(figsize=(20,5))\nsns.countplot(df[\"INCDATE\"].dt.year,ax=ax)\nax.set_xlabel('Year', fontsize=18)\nax.tick_params(axis=\"x\", labelsize=15)\nax.tick_params(axis=\"y\", labelsize=15)\nax.set_ylabel('Collision Count', fontsize=18)\nplt.title(\"Collision count YoY\", fontsize=18)\n# plt.savefig('.\/blog\/1.png')","a3f86b02":"fig, ax = plt.subplots(figsize=(10,5))\nsns.countplot(df[\"INCDATE\"].dt.month,ax=ax)\nax.set_xlabel('Months', fontsize=18)\nax.tick_params(axis=\"x\", labelsize=15)\nax.tick_params(axis=\"y\", labelsize=15)\nax.set_ylabel('Collision Count', fontsize=18)\nplt.title(\"Collision count MoM\", fontsize=18)\n# plt.savefig('.\/blog\/2.png')","51a27117":"df[\"INCTIME\"] = pd.to_datetime(df[\"INCDTTM\"])\nfor idx, dt in enumerate(df[\"INCDTTM\"]):\n    if ':' not in dt:\n        df[\"INCTIME\"][idx] = np.nan\n\nb = [0,4,8,12,16,20,24]\nl = ['Late Night', 'Early Morning','Morning','Noon','Eve','Night']\ndf[\"TIMEOFDAY\"] = pd.cut(df[\"INCTIME\"].dt.hour, bins=b, labels=l, include_lowest=True)","fe05a9ff":"1 - (df[\"TIMEOFDAY\"].isnull().sum() \/ len(df))","12985596":"pd.DataFrame({'TIME' : ['00:00 to 04:00', '04:00 to 08:00', '08:00 to 12:00', '12:00 to 16:00', '16:00 to 20:00', '20:00 to 00:00']},\n             index=['Late Night', 'Early Morning','Morning','Noon','Eve','Night'])","d2dc08ed":"df_TOD = pd.DataFrame(df['OBJECTID'].groupby(df['TIMEOFDAY'].astype('object')).count())\ndf_TOD = df_TOD.sort_values(by='OBJECTID',ascending=False)\ndf_TOD[\"cumpercentage\"] = df_TOD[\"OBJECTID\"].cumsum()\/df_TOD[\"OBJECTID\"].sum()*100\n\n\nfig, ax = plt.subplots(figsize=(10,5))\nax2 = ax.twinx()\nax.bar(df_TOD.index, df_TOD[\"OBJECTID\"])\nax2.plot(df_TOD.index, df_TOD[\"cumpercentage\"], color=\"C9\", marker=\"D\", ms=7)\nax2.yaxis.set_major_formatter(mpl.ticker.PercentFormatter())\n\nax.tick_params(axis=\"y\", colors=\"C0\")\nax2.tick_params(axis=\"y\", colors=\"C1\")\n\nplt.title(\"Pareto Diagram: Vehicle collisions on Time\", fontsize=18)\n\n# plt.savefig('.\/blog\/4.png')\nplt.show()","c8f16acd":"pd.DataFrame(df['OBJECTID'].groupby(df['TIMEOFDAY']).count())","e08ae36d":"fig, ax = plt.subplots(figsize=(10,5))\nsns.countplot(df[\"TIMEOFDAY\"], hue=df['SEVERITYDESC'],ax=ax)","9c4d17c2":"pd.crosstab(df.TIMEOFDAY, df.SEVERITYCODE)","26314352":"fig, ax = plt.subplots(figsize=(30,20))\ndf_temp = df.copy()\ndf_temp = df_temp[df_temp[\"SEVERITYCODE\"]!='0']\n(pd.crosstab(df_temp.TIMEOFDAY, df_temp.SEVERITYDESC).apply(lambda r: r\/r.sum(), axis=1)*100).plot.pie(subplots=True, ax=ax, autopct='%1.0f%%', pctdistance=0.5,labeldistance=1.2, radius=1.2, legend=None)\n# plt.savefig('.\/blog\/5.png')","4e5345a3":"(pd.crosstab(df.TIMEOFDAY, df.SEVERITYDESC).apply(lambda r: r\/r.sum(), axis=1)*100)","fa2657f8":"sns.set_palette(sns.color_palette(\"tab10\",10))\nspeed = df[\"SPEEDING\"]\nspeed = speed.fillna(\"N\")\nspeed.value_counts(normalize=True).plot.pie(subplots=True, autopct='%1.0f%%')\n# plt.savefig('.\/blog\/6.png')","66baccfd":"((df[df[\"SPEEDING\"]==\"Y\"].groupby(\"SEVERITYDESC\")[\"OBJECTID\"].count().sort_values(ascending=False) \/ df[df[\"SPEEDING\"]==\"Y\"].groupby(\"SEVERITYCODE\")[\"OBJECTID\"].count().sum())*100).plot.pie(subplots=True,figsize=(8,8), autopct='%1.0f%%' , title=\"Distribution of Speeding Collisions by Severity\")\n# plt.savefig('.\/blog\/7.png')","c70f70c5":"(df[df[\"SPEEDING\"].isnull()][\"SEVERITYDESC\"].value_counts(normalize=True)*100).plot.pie(subplots=True,figsize=(8,8), autopct='%1.0f%%', title=\"Distribution of Non Speeding Collisions by Severity\")\n# plt.savefig('.\/blog\/8.png')","623834f8":"fig, ax = plt.subplots(figsize=(10,5))\nsns.countplot(df[\"TIMEOFDAY\"], hue=df['SPEEDING'],ax=ax)\nax.set_xlabel('Day Time', fontsize=18)\nax.tick_params(axis=\"x\", labelsize=12)\nax.tick_params(axis=\"y\", labelsize=12)\nax.set_ylabel('Collision Count', fontsize=18)\nplt.title(\"Collision count by Day Time\", fontsize=18)\nfor p in ax.patches:\n             ax.annotate(\"%.0f\" % p.get_height(), (p.get_x() + p.get_width() \/ 2., p.get_height()),\n                 ha='center', va='center', fontsize=11, color='gray', xytext=(0, 20),\n                 textcoords='offset points')\n# plt.savefig('.\/blog\/9.png')","c503a870":"sns.set_palette(sns.color_palette(\"Oranges_r\",10))\nfig, ax = plt.subplots(figsize=(10,5))\nsns.barplot(y=(df.groupby('TIMEOFDAY')['SPEEDING'].apply(lambda x: x[x == 'Y'].count()) \/df.groupby('TIMEOFDAY')['OBJECTID'].count())*100, x=list(df.groupby('TIMEOFDAY').groups.keys()),ax=ax)\nax.set_xlabel('Day Time', fontsize=18)\nax.tick_params(axis=\"x\", labelsize=12)\nax.tick_params(axis=\"y\", labelsize=12)\nax.set_ylabel('Collision Count %', fontsize=18)\nplt.title(\"Collision count by Day Time\", fontsize=18)\nfor p in ax.patches:\n             ax.annotate(\"%.2f\" % p.get_height(), (p.get_x() + p.get_width() \/ 2., p.get_height()),\n                 ha='center', va='center', fontsize=11, color='gray', xytext=(0, 20),\n                 textcoords='offset points')\n# plt.savefig('.\/blog\/10.png')","18c2e842":"fig, ax = plt.subplots(figsize=(10,5))\nsns.set_palette(sns.color_palette(\"tab10_r\",10))\ndf[(df[\"SPEEDING\"]==\"Y\")].groupby(\"SDOT_COLDESC\")[\"OBJECTID\"].count().sort_values(ascending=False).head(10).plot.barh(ax=ax)\nax.set_xlabel('Collision Count', fontsize=18)\nax.tick_params(axis=\"x\", labelsize=12)\nax.tick_params(axis=\"y\", labelsize=12)\nax.set_ylabel('Collision Type', fontsize=18)\nplt.title(\"Collision type by count of Speeding collisions\", fontsize=18)\n# plt.savefig('.\/blog\/11.png')","4bd2e270":"fig, ax = plt.subplots(figsize=(10,5))\nsns.set_palette(sns.color_palette(\"coolwarm_r\",10))\ndf[df[\"SPEEDING\"]==\"Y\"].groupby(\"LOCATION\")[\"OBJECTID\"].count().sort_values(ascending=False).head(5).plot.barh() \nax.set_xlabel('Collision Count', fontsize=18)\nax.tick_params(axis=\"x\", labelsize=12)\nax.tick_params(axis=\"y\", labelsize=12)\nax.set_ylabel('Location', fontsize=18)\nplt.title(\"Location by count of Speeding collisions\", fontsize=18)\n# plt.savefig('.\/blog\/12.png')","dfe6bc92":"m = folium.Map(location=[df[\"Y\"].mean(), df[\"X\"].mean()], zoom_start=12)\nfolium.Marker((47.69034175,-122.3290808),popup=\"MOST SPEEDING COLLISIONS: BATTERY ST TUNNEL\").add_to(m)    \nm","3db65981":"sns.set_palette(sns.color_palette(\"coolwarm\",10))\nfig, ax = plt.subplots(figsize=(10,5))\nsns.countplot(df[\"TIMEOFDAY\"], hue=df['INATTENTIONIND'],ax=ax)\nax.set_xlabel('Day Time', fontsize=18)\nax.tick_params(axis=\"x\", labelsize=12)\nax.tick_params(axis=\"y\", labelsize=12)\nax.set_ylabel('Collision Count', fontsize=18)\nplt.title(\"Collision count by Day time for Inattentive driving collisions\", fontsize=18)\n# plt.savefig('.\/blog\/14.png')","7287c812":"sns.set_palette(sns.color_palette(\"bone\",10))\nfig, ax = plt.subplots(figsize=(10,5))\nsns.barplot(y=((df.groupby('TIMEOFDAY')['INATTENTIONIND'].apply(lambda x: x[x == 'Y'].count()) \/df.groupby('TIMEOFDAY')['OBJECTID'].count())*100).sort_values(), x=list(df.groupby('TIMEOFDAY').groups.keys()),ax=ax)\nfor p in ax.patches:\n             ax.annotate(\"%.2f\" % p.get_height(), (p.get_x() + p.get_width() \/ 2., p.get_height()),\n                 ha='center', va='center', fontsize=11, color='gray', xytext=(0, 5),\n                 textcoords='offset points')\nax.set_xlabel('Day Time', fontsize=18)\nax.tick_params(axis=\"x\", labelsize=12)\nax.tick_params(axis=\"y\", labelsize=12)\nax.set_ylabel('Collision Count %', fontsize=18)\nplt.title(\"% of Collision count by Day time for Inattentive driving collisions\", fontsize=18)\n# plt.savefig('.\/blog\/15.png')","7ac8f4ba":"sns.set_palette(sns.color_palette(\"brg\",10))\nfig, ax = plt.subplots(figsize=(10,5))\n(df[df[\"INATTENTIONIND\"]==\"Y\"].groupby(\"COLLISIONTYPE\")[\"OBJECTID\"].count().sort_values()).plot.barh()\nax.set_xlabel('Collision Count', fontsize=18)\nax.tick_params(axis=\"x\", labelsize=12)\nax.tick_params(axis=\"y\", labelsize=12)\nax.set_ylabel('Collision type', fontsize=18)\nplt.title(\"Collision type by count for Inattentive driving collisions\", fontsize=18)\n# plt.savefig('.\/blog\/16.png')","b0308bc0":"(df[df[\"INATTENTIONIND\"]==\"Y\"].groupby(\"COLLISIONTYPE\")[\"OBJECTID\"].count().sort_values(ascending=False))[0]\/(df[df[\"INATTENTIONIND\"]==\"Y\"].groupby(\"COLLISIONTYPE\")[\"OBJECTID\"].count().sum()) * 100","ba01c762":"fig, ax = plt.subplots(figsize=(10,5))\nsns.set_palette(sns.color_palette(\"GnBu\",2))\nsns.countplot(df[\"TIMEOFDAY\"], hue=df['UNDERINFL'],ax=ax)\nax.set_xlabel('Day Time', fontsize=18)\nax.tick_params(axis=\"x\", labelsize=12)\nax.tick_params(axis=\"y\", labelsize=12)\nax.set_ylabel('Collision Count', fontsize=18)\nplt.title(\"Collision count by Day time for under influenced driving collisions\", fontsize=18)\n# plt.savefig('.\/blog\/17.png')","1e2bc9c4":"pd.crosstab(df.TIMEOFDAY, df.UNDERINFL).apply(lambda x: (x\/x.sum())*100, axis=0)","2887ee91":"fig, ax = plt.subplots(figsize=(10,5))\ndf[df[\"UNDERINFL\"]==\"Y\"].groupby(\"MONTH\")[\"OBJECTID\"].count().plot(ax=ax)\nax.set_xlabel('Month', fontsize=18)\nax.tick_params(axis=\"x\", labelsize=12)\nax.tick_params(axis=\"y\", labelsize=12)\nax.set_ylabel('Collision Count', fontsize=18)\nplt.title(\"Collision count by Month for under influenced driving collisions\", fontsize=18)\n# plt.savefig('.\/blog\/19.png')","c319d623":"fig, ax = plt.subplots(figsize=(10,4))\ndf[df[\"UNDERINFL\"]==\"Y\"].groupby(\"LOCATION\")[\"OBJECTID\"].count().sort_values(ascending=False).head(10).plot.barh(ax=ax)\nax.set_xlabel('Collision Count', fontsize=18)\nax.tick_params(axis=\"x\", labelsize=12)\nax.tick_params(axis=\"y\", labelsize=12)\nax.set_ylabel('Location', fontsize=18)\nplt.title(\"Location by Collision count for under influenced driving collisions\", fontsize=18)\n# plt.savefig('.\/blog\/20.png')","baa69bb4":"fig, ax = plt.subplots(nrows=2, ncols=5, figsize=(35,13))\nsns.set_palette(sns.color_palette(\"winter\"))\ncol_type = list(df['COLLISIONTYPE'].unique())\n(col_type).remove(np.nan)\n\nfor i in range(0,2):\n    for j in range(0,5):\n        sns.countplot(df[df['COLLISIONTYPE'] == col_type[0]]['TIMEOFDAY'], ax=ax[i,j])\n        ax[i,j].set_title(col_type[0])\n        col_type.pop(0)\n# plt.savefig('.\/blog\/21.png')","a4ad84d2":"pd.crosstab(df.COLLISIONTYPE, df.TIMEOFDAY).apply(lambda r: (r\/r.sum())*100, axis=0)","d5a18a2b":"sns.set_palette(sns.color_palette(\"hot\"))\ntempdf = df[(df[\"COLLISIONTYPE\"]==\"Left Turn\")|(df[\"COLLISIONTYPE\"]==\"Right Turn\")]\nfig, ax = plt.subplots(figsize=(7,7))\nax.pie(tempdf[\"COLLISIONTYPE\"].value_counts(), textprops={'color':\"white\", 'fontsize': 14}, autopct='%1.0f%%')\n\nax.legend(tempdf[\"COLLISIONTYPE\"],\n          title=\"Collision Type (Turns)\",\n          loc=\"upper center\",\n          bbox_to_anchor=(1, 0, 0.5, 1))\n# plt.savefig('.\/blog\/24.png')\nplt.show()\n","ae9e48d4":"((df[df[\"COLLISIONTYPE\"]==\"Left Turn\"][\"OBJECTID\"].count() - df[df[\"COLLISIONTYPE\"]==\"Right Turn\"][\"OBJECTID\"].count()) \/ df[(df[\"COLLISIONTYPE\"]==\"Right Turn\")|(df[\"COLLISIONTYPE\"]==\"Left Turn\")][\"OBJECTID\"].count()) * 100","1578ca36":"df[df[\"COLLISIONTYPE\"]==\"Left Turn\"].groupby(\"ADDRTYPE\")[\"OBJECTID\"].count()","23db49e1":"df[df[\"COLLISIONTYPE\"]==\"Right Turn\"].groupby(\"ADDRTYPE\")[\"OBJECTID\"].count()","065ad12b":"sns.set_palette(sns.color_palette(\"Paired\"))\nx = pd.DataFrame(df[(df[\"COLLISIONTYPE\"]=='Other')&(df[\"TIMEOFDAY\"]=='Late Night')].groupby('SDOT_COLDESC')['OBJECTID'].count()).sort_values(by='OBJECTID', ascending=False)","33209da4":"others_values = x[\"OBJECTID\"].tail(12).sum()\nx.drop(x.tail(12).index,inplace=True)\nx = x.append(pd.DataFrame(data={\"OBJECTID\":others_values}, index=[\"Others Remaining\"]))","4f49ef7c":"x.plot(kind='pie',subplots=True,figsize=(10,10), autopct='%1.0f%%',textprops={'color':\"grey\", 'fontsize': 14}, explode=(0.1,0.1,0,0,0,0))\nplt.axes().set_facecolor(\"white\")\nplt.axes().get_legend().remove()\nplt.title(\"Collision type distribution for 'Late Night'\")\n# plt.savefig('.\/blog\/25.png')\nplt.show()","a6632eaf":"fig, ax = plt.subplots(figsize=(10,10))\nsns.countplot(y=df['SDOT_COLDESC'],ax=ax,orient=\"h\")","5c9c99c0":"fig, ax = plt.subplots(figsize=(10,5))\ndf['SDOT_COLDESC'].value_counts(normalize=True).head(5).plot.barh(title=\"% of accidents by collision type\",ax=ax)\nax.set_xlabel('% of accidents', fontsize=18)\nax.tick_params(axis=\"x\", labelsize=12)\nax.tick_params(axis=\"y\", labelsize=12)\n# ax.set_ylabel('Collision Count', fontsize=18)\n# plt.title(\"Collision count by Month for under influenced driving collisions\", fontsize=18)\n# plt.savefig('.\/blog\/26.png')","5b531978":"df1 = df.copy()\n\ndf1[\"COLLISIONTYPE\"].fillna(\"Unknown\",inplace=True)\ndf1[\"SDOT_COLDESC\"].fillna(\"Unknown\",inplace=True)\nfig = px.sunburst(\n    data_frame=df1[~df1[\"TIMEOFDAY\"].isnull()],\n    path= [\"TIMEOFDAY\",'COLLISIONTYPE',\"SDOT_COLDESC\"], \n    color=\"TIMEOFDAY\",\n    color_discrete_sequence=px.colors.qualitative.Pastel,\n    maxdepth=-1,                        \n    branchvalues=\"total\", \n    title=\"Breakdown of collision type by time\",\n)\nfig.update_traces(textinfo='label+percent entry') # percent parent\nfig.update_layout(margin=dict(t=30, b=10, r=10, l=10),\n                  width=1000, height=1000)\nfig.show()","4e76d0b8":"pd.crosstab(df.COLLISIONTYPE, df.TIMEOFDAY).apply(lambda r: ((r\/r.sum())*100).round(2), axis=1)","d3d991de":"f_df = df.groupby('ADDRTYPE')[['FATALITIES']].sum()\nf_df['INJURIES'] = df.groupby('ADDRTYPE')[['INJURIES']].sum()\nf_df['SERIOUSINJURIES'] = df.groupby('ADDRTYPE')[['SERIOUSINJURIES']].sum()\nf_df['ACDNTCOUNT'] = df.groupby('ADDRTYPE')[['OBJECTID']].count()\nf_df = f_df.reset_index()\nf_df","70cd714b":"sns.set_palette('twilight_shifted_r')\na = df.groupby('ADDRTYPE')[['FATALITIES']].sum()\nf_df1 = a.apply(lambda x : 100 * x\/float(x.sum()))\na['P_INJURIES'] = df.groupby('ADDRTYPE')[['INJURIES']].sum()\nf_df1 = a.apply(lambda x : 100 * x\/float(x.sum()))\na['P_SERIOUSINJURIES'] = df.groupby('ADDRTYPE')[['SERIOUSINJURIES']].sum()\nf_df1 = a.apply(lambda x : 100 * x\/float(x.sum()))\na['P_ACDNTCOUNT'] = df.groupby('ADDRTYPE')[['OBJECTID']].sum()\nf_df1 = a.apply(lambda x : 100 * x\/float(x.sum()))\n#f_df1 = f_df1.drop(columns=['FATALITIES', 'INJURIES'])\nf_df1.reset_index(inplace=True)\nf_df1.rename(columns={'FATALITIES':'P_FATALITIES'}, inplace=True)\nf_df1\n\nfig, ax = plt.subplots(figsize=(10,10))\ndf2=pd.melt(f_df1,id_vars=['ADDRTYPE'],var_name='DESC', value_name='PERCENTAGE OF TOTAL')\ndf2\nsns.barplot(x='ADDRTYPE', y='PERCENTAGE OF TOTAL', hue='DESC', data=df2, ax=ax)\nplt.xticks(rotation=90)\n# plt.savefig('.\/blog\/29.png')","c0cce768":"layout = go.Layout(\n    title=\"Location wise Type of Injuries\",\n    xaxis=dict(\n        title=\"ACCIDENT ADDRESS TYPE\",\n        linecolor='#A9A9A9',\n        showgrid=True),\n    yaxis=dict(\n        title=\"NUMBER OF ACCIDENTS\",\n        showgrid=False),\n    barmode='group'\n)\n\nfig = go.Figure(data=[\n    go.Bar(name='TOTAL #OF ACCIDENT', x=f_df['ADDRTYPE'], y=f_df['ACDNTCOUNT']),\n    go.Bar(name='INJURIES', x=f_df['ADDRTYPE'], y=f_df['INJURIES']),\n    go.Bar(name='SERIOUSINJURIES', x=f_df['ADDRTYPE'], y=f_df['SERIOUSINJURIES']),\n    go.Bar(name='FATALITIES', x=f_df['ADDRTYPE'], y=f_df['FATALITIES'])\n    \n], layout= layout)\nfig.show()","6a7dc73d":"pd.crosstab(df[\"COLLISIONTYPE\"],df[\"ADDRTYPE\"])","33148b87":"df1 = df[df['INCDATE'].dt.year > 2016]\na= df1.groupby(['INTKEY','LOCATION'])['OBJECTID'].count() #,\na = a.to_frame()\na.reset_index(inplace=True)\na.rename(columns={'OBJECTID':'# OF ACCIDENTS'}, inplace=True)\nbins = [0, 10, 20, 30, 40,50,120]\nlabels = ['Below 10', 'Between 10 and 20','Between 20 and 30','Between 30 and 40','Between 40 and 50',\n         'Above 50']\na['BINNED'] = pd.cut(a['# OF ACCIDENTS'], bins, labels=labels)\na = a.sort_values(by=['# OF ACCIDENTS'],ascending=False)\nb = a.head(20)\nfig = px.bar(b, x=\"# OF ACCIDENTS\", y=\"LOCATION\", color=\"# OF ACCIDENTS\")\nfig.show()","65402596":"fig,ax = plt.subplots(nrows=2,ncols=1,figsize=(10,8))\nsns.countplot(y=df['ROADCOND'], ax=ax[0],orient=\"h\")\nsns.countplot(y=df['LIGHTCOND'], ax=ax[1],orient=\"h\")\n# plt.savefig('.\/blog\/33.png')","5592c0b5":"df[\"LIGHTCOND\"].unique()","6095d725":"df[(df[\"SEVERITYCODE\"]==\"1\")][\"LIGHTCOND\"].value_counts()","d4e592d2":"fig, ax = plt.subplots(nrows=2,ncols=4,figsize=(20,10))\nax[0,0].pie(df[(df[\"SEVERITYCODE\"]==\"1\")][\"ROADCOND\"].value_counts(), textprops={'color':\"white\", 'fontsize': 14})\nax[0,1].pie(df[(df[\"SEVERITYCODE\"]==\"2\")][\"ROADCOND\"].value_counts(), textprops={'color':\"white\", 'fontsize': 14})\nax[0,2].pie(df[(df[\"SEVERITYCODE\"]==\"2b\")][\"ROADCOND\"].value_counts(), textprops={'color':\"white\", 'fontsize': 14})\nax[0,3].pie(df[(df[\"SEVERITYCODE\"]==\"3\")][\"ROADCOND\"].value_counts(), textprops={'color':\"white\", 'fontsize': 14})\n\nax[0,0].set_title(\"Property Damage Only Collision\",color=\"grey\")\nax[0,1].set_title(\"Injury Collision\",color=\"grey\")\nax[0,2].set_title(\"Serious Injury Collision\",color=\"grey\")\nax[0,3].set_title(\"Fatal Collision\",color=\"grey\")\n\n\nax[1,0].pie(df[(df[\"SEVERITYCODE\"]==\"1\")][\"LIGHTCOND\"].value_counts(), textprops={'color':\"white\", 'fontsize': 14})\nax[1,1].pie(df[(df[\"SEVERITYCODE\"]==\"2\")][\"LIGHTCOND\"].value_counts(), textprops={'color':\"white\", 'fontsize': 14})\nax[1,2].pie(df[(df[\"SEVERITYCODE\"]==\"2b\")][\"LIGHTCOND\"].value_counts(), textprops={'color':\"white\", 'fontsize': 14})\nax[1,3].pie(df[(df[\"SEVERITYCODE\"]==\"3\")][\"LIGHTCOND\"].value_counts(), textprops={'color':\"white\", 'fontsize': 14})\n\n\nax[0,3].legend([\"Dry\",\"Wet\",\"Unknown\",\"Ice\",\"Snow\/Slush\",\"Other\",\"Standing Water\",\"Sand\/Mud\/Dirt\",\"Oil\"],\n          title=\"Road Condition\",\n          loc=\"center left\",\n          bbox_to_anchor=(1, 0, 0.5, 1))\nax[1,3].legend([\"Daylight\",\"Dark-Street Light On\",\"Unknown\",\"Dawn\",\"Dark-No Street Lights\",\"Dark-Street Light Off\",\"Other\",\"Dark-Unknown Lighting\"],\n          title=\"Light Condition\",\n          loc=\"center left\",\n          bbox_to_anchor=(1, 0, 0.5, 1))\n# plt.savefig('.\/blog\/34.png')\nplt.show()","7b520d80":"a = df[df['YEAR']!=2020].groupby(['MONTH'])['OBJECTID'].count()\/df[df['YEAR']!=2020].groupby(['MONTH']).size().nunique()\na = a.to_frame()\na.reset_index(inplace=True)\na.rename(columns = {'OBJECTID':'2013-2019'}, inplace=True)\nb= df[df['YEAR']==2020].groupby(['MONTH'])['OBJECTID'].count()\nb = b.to_frame()\nb.reset_index(inplace=True)\nb.rename(columns = {'OBJECTID':'2020'}, inplace=True)\n# merging dataframes\ndf_compare = pd.merge(a, b, on='MONTH', how='left')","96d60694":"fig = go.Figure()\nfig.add_trace(go.Scatter(x=df_compare['MONTH'], y=df_compare['2013-2019'],mode='lines+markers', \n                         name='Before 2020'))\nfig.add_trace(go.Scatter(x=df_compare['MONTH'], y=df_compare['2020'],mode='lines+markers',\n                        name='2020'))\nfig.update_layout(title=\"Impact of COVID-19 on Road Accidents\",\n                  xaxis_title='Month',\n                  yaxis_title='Average Number of Accidents'\n                 )\n# plt.savefig('.\/blog\/35.png')\nfig.show()","e78b0d2c":"sf_map = folium.Map(location=[df[\"Y\"].mean(), df[\"X\"].mean()],  zoom_start=12, control_scale=True, min_zoom=11)\n\ndf_filtered = df[(df[\"YEAR\"]>= 2014)]\nHeatMap(data=df_filtered[[\"X\",\"Y\",\"VEHCOUNT\"]].groupby(['Y', 'X']).sum().reset_index().values.tolist(), radius=8, max_zoom=13).add_to(sf_map)\n\nsf_map","55687cf6":"We can see that there is a sudden drop in accident cases in 2020, due to COVID-19 pandemic","9ab3f7c9":"We noticed that 35% of collisions happening because of inattention are rear ended collisions.","730c0c5c":"# Importing Libraries","dc85cd03":"For the column ```UNDERINFL``` there are 4 unique values. Intuitively, it seems that 'Y' and '1' denotes the same thing which is the person was under influence of alcohol. Same is with 'N' and '0'. Hence, let's save the column values in systematic format","e5338536":"Accidents are seems to be in declining yearly, but we need some more data to state this precisely. ","d9e9c0ed":"From the pareto diagram, we can see that about 50% of accidents tend to happen during the day time i.e. between 12:00 P.M. to 8:00 P.M.","be5dcfb7":"People are morelikely to hit Parked car during Night. We can also see there are alot of \"Other\" collision type of cases in late night.","6d802bf2":"# Examining collision type","951d3bc8":"\"ALASKAN VI SB BETWEEN COLUMBIA ST ON RP AND ALASKAN WY VI SB EFR OFF RP\" has greatest number of cases of underinfluence collisions","c420b114":"### <i> Check out the complete analysis here <a href=\"https:\/\/medium.com\/intellyticssolutions\/data-analysis-beyond-plotting-of-colourful-visualisations-35886facad21\">@ Medium<\/a><\/i>  ","63bdfbfd":"There is no clear trend in number of collisions and month of the year","e7afca88":"# Under influence of alcohol or drugs","32e2c2cf":"# Collisions due to inattention","bd7b3131":"We can see that 62% of accidents belong to Category 1 which is \"Property Damage Only Collision\" <br>\n26% belong to Category 2, \"Injury Collision\"","e65a2243":"<img src=\"https:\/\/bridgehunter.com\/photos\/19\/72\/197274-M.jpg\"> <\/img>","da0d104a":"According to the annual United States road crash statistics by ASIRT, more than 38,000 people die every year in crashes on U.S. roadways. The U.S. traffic fatality rate is 12.4 deaths per 100,000 inhabitants. It is evident that with the increasing number of vehicles on urban and suburban roads, the cases of vehicle accidents are also increasing. This project aims to analyse vehicle collision data available in public domain provided by Seattle Geo Data (SDOT) and derive some useful insights. <br>\nData provided by the Seattle Department of Transportation (SDOT) on vehicle collisions along with its severity might be useful to derive insights and may show some pattern with the environmental factors like weather, road conditions etc. <br>\nThe dataset consists of 40 columns having different kinds of data like, collision severity, road conditions, number of people involved, location of collision, weather etc. Meta-data of the dataset can be viewed https:\/\/www.seattle.gov\/Documents\/Departments\/SDOT\/GIS\/Collisions_OD.pdf","34e6ecc6":"# Reading the Data","3613e6c6":"We can see percentage of <br>\nInjury Collision <b>increases<\/b> from 26.52% to 36.3% <br>\nSerious Injury Collision <b>increases<\/b> from 1.39% to 3.92%  and<br>\nFatality Collision <b>increases<\/b> from 0.15% to 0.89%  <br>\nbecause of speeding. While the percentage of Property Damage Only Collision <b>decreases<\/b> from 62.14% to 58.87%","efd8e660":"Battery Tunnel, Seattle. (img source: https:\/\/bridgehunter.com\/photos\/19\/72\/197274-M.jpg)","c79bc635":"The dataset consists of 40 distinct columns and 220937 rows","f903aa43":"Severe accidents are relatively less in daylight","c14155bf":"\nWe can see ~40% of collisions are of motor vehicle striking another motor vehicle\u2019s front end at an angle.\n","704f5eb3":"# Collisions on Map","b7e95f8c":"There is ~65% more chance to encounter a collision while taking a Left turn than taking a Right turn","4d4fd1b8":"There are 5 categories of severity. It is safe to assume that the missing ```SEVERITYCODE``` must belong to unknown category i.e. Category 0.","4209165e":"# Month wise collision rate","db150d7a":"We can see there are relatively more cases of alcoholic and drug influenced collision during December (Probably because of holiday season)","ab47911b":"<img src=\"https:\/\/images.unsplash.com\/photo-1575987446487-56eba08666cf?ixlib=rb-1.2.1&auto=format&fit=crop&w=750&q=80\">","c52be452":"~18% of collisions happening in morning and early morning are due to inattention of drivers","75776c01":"# Location wise analysis","29bb186e":"# Conclusion\nAfter the thorough analysis, we have a better understanding of the causes and reasons for major road accidents. We see that although only 26% of accidents involve any injury, the number is still too high. The majority of the cases happen between the afternoon and evening, thus people driving during these hours should be more careful. The visuals convey to us that severity of the accident is higher during the day than late night, something we thought wasn't likely. We also see that speeding causes more accidents late at night. Additionally, in night-time accidents primarily happen because of less visibility. Thus, drivers should avoid speeding and be more careful during the night to avoid accidents. The data tells us that severe accidents more likely happen at blocks or intersections, as expected.\n\nMoreover, we see that there is a spike I drunken driving cases during December (holiday season), the law enforcement should particularly take care during this time for such incidents. Here we see that utilizing analysis on top of the visuals entails one to bring out insights that may lead to a breakthrough, like the chances of being in an accident while turning left are more than while turning right. This information forms the core of the data analysis process. An effective, well-designed, and beautiful visualization is great but you shouldn't lose the context hidden in data art and must focus upon data-driven decisions that may engage your stakeholders. It is crucial to be a good visual storyteller rather than a visual artist, bringing out stories from data is what companies seek and require.","a9db2690":"# Vehicle Collision Dataset Analysis: Seattle Department of Transportation (SDOT)","465bbfe1":"1. 62% of accidents belong to category \"Property Damage Only Collision\" while 26% belong to category \"Injury Collision\" <br>\n2. 50% of accidents tend to happen between 12:00 P.M. to 8:00 P.M.<br>\n3. Between 00:00 to 04:00, cases of severity 1 (\"Property damage only collision\") incidents are higher than rest of the day percentage wise<br>\n4. 11% of all cases in late night are due to speeding <br>\n5. ~18% of collisions happening in morning and early morning are due to inattention of drivers <br>\n6. Motor Vehicles tend to hit fixed objects more during late night time <br>\n7. Severe accidents majorly happens at a block or an intersection <br>\n8. Location \"6th AVE AND JAMES ST\" has abnormally high number of collisions since 2016 <br>\n9. There is a sudden drop in accident cases in 2020, due to COVID-19 pandemic<br>\n10. There are over 250 cases of collisions at \"BATTERY ST TUNNEL\"<br>\n11. There are relatively more cases of alcoholic and drug influenced collision during December (Probably because of holiday season)","310f3372":"```OBJECTID``` is just a unique value for each row. \n```INCKEY``` and ```COLDETKEY``` are unique identifier for a given incident","aea50e63":"Of total alcoholic and drug cases, ~64% cases happen during Night and Late Night","2c3587f6":"# Accidents declining YoY? Not so sure","ec5e932d":"11% of all cases in late night are due to speeding","6a01b04c":"# Road and Lighting Conditions","04adbd2f":"# Effect of COVID-19 pandemic on vehicle collisions","76873227":"In 2020, whole world faced a pandemic of the COVID-19 outbreak. Its effect on travel behaviour have also been sudden and wide ranging. ","ca93e02d":"Motor Vehicles tend to hit fixed objects more during late night time","694e31aa":"# Speeding","2aab7a97":"We can see density of accident is greater in Central Seattle, around University Road and First Hill","f9a94e23":"We have time of accident for ~76% of data. In order to analyse timewise, splitting the data into 6 categories viz.  'Late Night', 'Early Morning', 'Morning', 'Noon', 'Eve', 'Night'","1307e6d0":"# Important Insights","835f1efe":"Location \"6th AVE AND JAMES ST\" has abnormally high number of collisions since 2016","36242c57":"# Data Cleaning","ac17b126":"There are over 250 cases of collisions at \"BATTERY ST TUNNEL\"","64eb1e6a":"There is no clear relation between severity of accidents and time of the day. During Late Night, cases of severity 1 (\"Property damage only collision\") incidents are higher than rest of the day percentage wise.<br>\n3 of 4 accidents happening during late night are just doing property damage","201ffa6c":"# Collision Type"}}