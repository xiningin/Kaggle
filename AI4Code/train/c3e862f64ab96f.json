{"cell_type":{"acc5ef1a":"code","d4852802":"code","a348ed86":"code","60da4fc0":"code","53718987":"code","41684f54":"code","b4e827e1":"code","50ecc664":"code","e6f5ff0e":"code","c2634947":"code","7af03eb2":"code","db234b26":"code","b9bb0c88":"code","93a8a06d":"code","85177b89":"code","34ab29ca":"code","ef7a46a9":"code","0fb94fa0":"code","957598fe":"code","4de379b5":"code","b9b733fd":"code","03de5b7a":"code","334fc5fd":"code","dd4866bb":"code","5038c908":"code","1944eab8":"code","309cd646":"code","8c4e2a3b":"code","a4b376d4":"code","f9df0a72":"code","5eb3978f":"code","ea4c704b":"code","445fd419":"code","d6fd698a":"code","fd320dfb":"code","68945b24":"code","3a5db9bb":"code","ea759806":"code","b9df9b1b":"code","f88b93b1":"code","1a414aeb":"markdown","79bdb8ce":"markdown","2d534005":"markdown","d5ea8674":"markdown","6f5f2636":"markdown","90de10b2":"markdown","df4aa78d":"markdown","c091182c":"markdown","0a657d6b":"markdown","cbd6e929":"markdown","e2474229":"markdown","3a13c0a5":"markdown","1ec152bb":"markdown","3b82706e":"markdown","d7216eea":"markdown","3ca3fc6a":"markdown","d0880360":"markdown","c4c4da29":"markdown","bde80a6e":"markdown","8d2cefe6":"markdown","4384e535":"markdown"},"source":{"acc5ef1a":"import matplotlib.pyplot as plt \nimport pandas as pd \nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.ensemble import RandomForestClassifier\nimport numpy as np \nimport seaborn as sns \nplt.style.use(\"seaborn-white\")\nimport os\nimport random\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.feature_selection import SelectKBest\nfrom sklearn.feature_selection import chi2\nfrom sklearn.metrics import mean_squared_error\nimport matplotlib\nfrom sklearn.metrics import accuracy_score","d4852802":"colors = [['#0D47A1','#1565C0','#1976D2','#1E88E5','#2196F3'],\n          ['#311B92','#512DA8','#673AB7','#9575CD','#B39DDB'],\n          ['#1B5E20','#388E3C','#4CAF50','#81C784','#66BB6A'],\n          ['#E65100','#EF6C00','#F57C00','#FB8C00','#FF9800'],\n          ['#3E2723','#4E342E','#5D4037','#6D4C41','#795548'],\n          ['#BF360C','#D84315','#E64A19','#F4511E','#FF5722'],\n          ['#880E4F','#AD1457','#C2185B','#D81B60','#E91E63']\n         ]","a348ed86":"train = '..\/input\/train.csv'\ntest = '..\/input\/test.csv'\n\ndf_train = pd.read_csv(train)\ndf_test = pd.read_csv(test)","60da4fc0":"df_train.head()","53718987":"df_test.head()","41684f54":"#Dimens\u00e3o datasets\nprint(\"Dimens\u00e3o  dataset de treino\")\nprint(\"Colunas:\", df_train.shape[1],\"\\nlinhas:\", df_train.shape[0])\nprint(\"-\")\nprint(\"Dimens\u00e3o  dataset de teste\")\nprint(\"Colunas:\", df_test.shape[1],\"\\nlinhas:\", df_train.shape[0])","b4e827e1":"df_train.dtypes","50ecc664":"\ndf_test.dtypes","e6f5ff0e":"df_train.isnull().sum().sort_values(ascending=False)","c2634947":"#Preenchendo valores nulos\ndf_train.fillna(1, inplace=True)\ndf_test.fillna(1, inplace=True)","7af03eb2":"#Verificando os valores nulos no dataset de teste\ndf_test.isnull().sum().sort_values(ascending=False).head(10)","db234b26":"sp = df_train[df_train['estado'] == 'SP']\nsp.groupby('municipio')['nota_mat'].mean().sort_values(ascending=False).head(10).plot(kind='barh',rot=0, figsize=(12,5),color=random.choice(colors), title=\"Top 10 - Maior nota m\u00e9dia de matem\u00e1tica por munic\u00edpio - SP\")\nplt.xlabel(\"Nota\")\nplt.ylabel(\"Munic\u00edpio\")\nplt.show()","b9bb0c88":"df_train.groupby(('municipio','estado', 'regiao'))['nota_mat'].mean().sort_values(ascending=True).head(10).plot(kind=\"barh\",figsize=(12,5),color=random.choice(colors), title=\"Top 10 Menor nota m\u00e9dia em matem\u00e1tica por munic\u00edpio\")\nplt.xlabel(\"Nota\")\nplt.show()","93a8a06d":"#Listando novamente as colunas para validar a remo\u00e7\u00e3o\ndf_train.columns","85177b89":"#Agrupando Municipios e suas respectivas notas m\u00e9dias\ndf_train.groupby('municipio')['nota_mat'].mean()","34ab29ca":"#Calculando a simetria dos dados\n#Um valor zero indica uma distribui\u00e7\u00e3o sim\u00e9trica, um valor maior que zero ou menor indica uma distribui\u00e7\u00e3o assim\u00e9trica.\ndf_train.skew()","ef7a46a9":"explode = (0.2, 0, 0, 0,0)\ndf_train.groupby('regiao')['populacao'].mean().plot(kind='pie',labeldistance=1.1, explode=explode,autopct='%1.0f%%', title=\"Percentual da popula\u00e7\u00e3o por regi\u00e3o\", shadow=True, startangle=90)\nplt.ylabel(\" \")\nplt.show()","0fb94fa0":"df_train.groupby('estado')['idhm'].mean().sort_values().plot(kind='barh', figsize=(15,8), title=\"IDH por estado\", grid=True)\nplt.xlabel(\"IDH-M\")\nplt.ylabel(\"ESTADO\")\nplt.show()","957598fe":"\ndf_train.groupby(('municipio','estado', 'regiao'))['nota_mat'].mean().sort_values(ascending=False).head(20)","4de379b5":"df_train.groupby('estado')['nota_mat'].describe()\n","b9b733fd":"df_train['nota_mat'].describe()","03de5b7a":"sns.distplot(df_train['nota_mat'].dropna(),kde=False,color='blue',bins = 20)\nplt.show()","334fc5fd":"media_mt_estado = df_train.groupby('estado')['nota_mat'].max().sort_values()\nmedia_mt_estado.plot(title = 'Maiores notas de matem\u00e1tica por estado', grid = False, kind='barh',color='red', figsize=(15,8))\nplt.xlabel('Nota')\nplt.ylabel('Estado')\nplt.show()","dd4866bb":"df_train['nota_mat'] = np.log(df_train['nota_mat'])","5038c908":"df_train = df_train.append(df_test, sort=False)","1944eab8":"df_train.shape","309cd646":"for c in df_train.columns:\n    if (df_train[c].dtype == 'object') & (c != 'codigo_mun'):\n        df_train[c] = df_train[c].astype('category').cat.codes","8c4e2a3b":"#Retirando a string ID_ID_ da Coluna\ndf_train['codigo_mun'] = df_train['codigo_mun'].str.replace('ID_ID_','')","a4b376d4":"df_train['nota_mat'].fillna(-2, inplace=True)","f9df0a72":"df_train.fillna(0, inplace=True)","5eb3978f":"df_train, df_test = df_train[df_train['nota_mat']!=-2], df_train[df_train['nota_mat']==-2]","ea4c704b":"df_train, valid = train_test_split(df_train, random_state=42)","445fd419":"rf = RandomForestRegressor(random_state=42, n_estimators=100)","d6fd698a":"feats = [c for c in df_train.columns if c not in ['nota_mat']]","fd320dfb":"df_train, df_test = df_train[df_train['nota_mat']!=-2], df_train[df_train['nota_mat']==-2]","68945b24":"rf.fit(df_train[feats], df_train['nota_mat'])","3a5db9bb":"valid_preds = rf.predict(valid[feats])","ea759806":"mean_squared_error(valid['nota_mat'], valid_preds)**(1\/2)","b9df9b1b":"df_test[['codigo_mun','nota_mat']].to_csv('rf1.csv', index=False)","f88b93b1":"rf","1a414aeb":"# Estados com melhores notas","79bdb8ce":"# Importando bibiliotecas\n","2d534005":"# Explorando as vari\u00e1veis","d5ea8674":"### Preencher Valores em Branco","6f5f2636":"### Criar os conjuntos de treino e valida\u00e7\u00e3o\n","90de10b2":"### Checando o tipo dos dados treino\n","df4aa78d":"# Importando CORES","c091182c":"### Juntar os 2 DataFrames em uma \u00fanica vari\u00e1vel","0a657d6b":"# An\u00e1lise Explorat\u00f3ria","cbd6e929":"# Tratando valores nulos\n","e2474229":"# An\u00e1lises Descritivas","3a13c0a5":"# M\u00e9dia IDH","1ec152bb":"### Enviar pro Kaggle","3b82706e":"### Treinar o modelo\n","d7216eea":" ### Transformar texto em n\u00famero exceto codigo_num\n","3ca3fc6a":"### Verificando valores nulos no dataset de treino\n","d0880360":"### Fazer previs\u00f5es\n","c4c4da29":"### Separar as bases de volta em test e df\n","bde80a6e":"### Checando o tipo dos dados teste\n","8d2cefe6":"# Distribui\u00e7\u00e3o da popula\u00e7\u00e3o por regi\u00e3o ( Gr\u00e1fico de Pizza)","4384e535":"# Importando os datasets\n"}}