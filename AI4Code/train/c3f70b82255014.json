{"cell_type":{"e3255c6d":"code","9a6fd2f8":"code","1d0976c7":"code","4e4c07e0":"code","95c2c24c":"code","48460ddf":"code","3f342e00":"code","f08eb78e":"code","4e872e05":"code","2fa2ad4e":"code","9de655c0":"code","4a8e82d7":"code","f8681b86":"code","ba4eb0a1":"code","8cfddee1":"code","87038dc5":"code","89cde24b":"code","fc1821df":"code","662584ec":"code","a9c2beaa":"markdown","02b5e29c":"markdown","19f34f43":"markdown","26e01ea8":"markdown","07c28e67":"markdown","70cf3745":"markdown","ca2533f1":"markdown","cd520858":"markdown","0a54fd85":"markdown","2ecdf454":"markdown","636315e4":"markdown","5e6b4f1b":"markdown","0f565363":"markdown","05a2e155":"markdown","c7e758f0":"markdown","6b34cfdd":"markdown"},"source":{"e3255c6d":"import numpy as np\nimport pandas as pd\n\nimport warnings\nwarnings.filterwarnings('ignore')","9a6fd2f8":"train = pd.read_csv('..\/input\/titanic\/train.csv')\ntest = pd.read_csv('..\/input\/titanic\/test.csv')\ngender_submission = pd.read_csv('..\/input\/titanic\/gender_submission.csv')","1d0976c7":"data = pd.concat([train,test],axis = 0)","4e4c07e0":"import seaborn as sns\nsns.set(style=\"darkgrid\")\n\ndata['FamilySize'] = data['Parch'] + data['SibSp'] + 1\ntrain['FamilySize'] = data['FamilySize'][:len(train)]\ntest['FamilySize'] = data['FamilySize'][len(train):]\nsns.countplot(x='FamilySize', data=train, hue='Survived')","95c2c24c":"data['Family1'] = (data['FamilySize'] == 1)*1","48460ddf":"train.info()\nprint('_'*40)\ntest.info()","3f342e00":"train.describe(include=['O'])","f08eb78e":"train.describe()","4e872e05":"data['Age'].fillna(data['Age'].median(), inplace=True)","2fa2ad4e":"data = pd.concat([data,pd.get_dummies(data['Sex'],drop_first=True)],axis=1)\ndata = data.drop('Sex',axis=1)","9de655c0":"train = data.iloc[:len(train),:]\ntest = data.iloc[len(train):,:]","4a8e82d7":"feature_name = ['male','Age','Family1']","f8681b86":"X_train = train.loc[:,feature_name]\ny_train = train.loc[:,'Survived']\n\nX_test = test.loc[:,feature_name]","ba4eb0a1":"X_train.head(2)","8cfddee1":"from sklearn.linear_model import LogisticRegression\n\nclf = LogisticRegression(penalty='l2', solver='sag', random_state=0)\nclf.fit(X_train, y_train)","87038dc5":"y_pred = clf.predict(X_test)","89cde24b":"from sklearn.model_selection import KFold\n\ny_preds = []\nmodels = []\noof_train = np.zeros((len(X_train),))\ncv = KFold(n_splits=5, shuffle=True, random_state=0)\n\nfor fold_id, (train_index, valid_index) in enumerate(cv.split(X_train)):\n    \n    X_tr = X_train.loc[train_index, :]\n    X_val = X_train.loc[valid_index, :]\n    y_tr = y_train[train_index]\n    y_val = y_train[valid_index]\n    \n    clf = LogisticRegression(penalty='l2', solver='sag', random_state=0)\n    clf.fit(X_tr, y_tr)\n    \n    oof_train[valid_index] = clf.predict(X_val)\n    y_pred = clf.predict(X_test)\n\n    y_preds.append(y_pred)\n    models.append(clf)","fc1821df":"from sklearn.metrics import accuracy_score\n\naccuracy_score(y_train,oof_train)","662584ec":"sub = pd.DataFrame(pd.read_csv('..\/input\/titanic\/test.csv')['PassengerId'])\nsub['Survived'] = list(map(int, y_pred))\nsub.to_csv('submission.csv', index=False)","a9c2beaa":"plot sample  \nhistgram of FamilySize*[](http:\/\/)*","02b5e29c":"data \u88dc\u5b8c","19f34f43":"\u2460\u7279\u5fb4\u91cf\u30a8\u30f3\u30b8\u30cb\u30a2\u30ea\u30f3\u30b0","26e01ea8":"\u2461\u30e2\u30c7\u30eb\u306e\u4f5c\u6210  \nlogistic regression","07c28e67":"\u3053\u3061\u3089\u306e\u30b5\u30a4\u30c8\u3092\u4e00\u90e8\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002  \nhttps:\/\/qiita.com\/upura\/items\/3c10ff6fed4e7c3d70f0","70cf3745":"categorical \u5909\u6570\u306e\u751f\u6210","ca2533f1":"data\u306etrain\u3068test\u3078\u306e\u5206\u5272","cd520858":"FamilySize==1\u3092\u5909\u6570\u3068\u3057\u3066\u4f5c\u6210","0a54fd85":"\u2464\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u4e88\u6e2c\u30fb\u63d0\u51fa  \n\u4e88\u6e2c\u5024\u306e\u7b97\u51fa(sample submission\u306e\u5f62\u5f0f\u306b\u5408\u308f\u305b\u308b)","2ecdf454":"cv result","636315e4":"\u5e74\u9f62\u306e\u6b20\u640d\u3092\u4e2d\u592e\u5024\u3067\u88dc\u5b8c","5e6b4f1b":"data import","0f565363":"\u5206\u6790\u5bfe\u8c61\u306e\u5909\u6570\u306e\u5b9a\u7fa9","05a2e155":"package install","c7e758f0":"\u2462\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306e\u4ed5\u7d44\u307f\u4f5c\u6210  \n\u2463\u5b66\u7fd2\u7528\u30c7\u30fc\u30bf\u5b66\u7fd2\u30fb\u8a55\u4fa1  \n\u4ea4\u5dee\u691c\u8a3c\u306e\u30b5\u30f3\u30d7\u30eb","6b34cfdd":"**Logistic regression\u306b\u3088\u308b\u30b7\u30f3\u30d7\u30eb\u306a\u30b5\u30f3\u30d7\u30eb**"}}