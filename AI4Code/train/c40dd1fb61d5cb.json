{"cell_type":{"105bcdee":"code","ccfc949b":"code","7d7da6b5":"code","ddcf2413":"code","280e8a93":"code","b21a2967":"code","8c674576":"code","992c7c48":"code","0b3c893b":"code","0ec89f4f":"code","a92afab0":"code","e4ecca3f":"code","1f1317ff":"code","9775ca87":"code","5195b26e":"code","f62150fc":"code","62ace193":"code","4173cae3":"code","54114318":"code","2226a827":"code","3b36a555":"markdown","bfc11b73":"markdown","6faa7148":"markdown","61f268f6":"markdown","14237a86":"markdown","1f75bd8a":"markdown","6ee5788a":"markdown","5d5c7b4a":"markdown","d3c154fc":"markdown","d12d0014":"markdown","d8c0fa94":"markdown","2f812d97":"markdown","133fddfe":"markdown","ade35a97":"markdown","e17f9614":"markdown","23ab75ef":"markdown","0abfb07d":"markdown","49788d69":"markdown"},"source":{"105bcdee":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nfrom scipy import stats\n\n%matplotlib inline\nimport matplotlib.pyplot as plt\n\nimport plotly.offline as py\nimport plotly.graph_objs as go\n\npy.init_notebook_mode(connected=True)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\ninpdir = \"..\/input\"\nimport os\nprint(os.listdir(inpdir))\n\n# Any results you write to the current directory are saved as output.","ccfc949b":"df = pd.read_csv(inpdir + '\/multipleChoiceResponses.csv', low_memory=False)\ndf.drop(index=0, inplace=True)\ndf[\"Time from Start to Finish (seconds)\"] = df[\"Time from Start to Finish (seconds)\"].astype('int')\n\ndf.head()","7d7da6b5":"pnts_qa = {\n    'Q1': ('Prefer not to say', 'Gender'),\n    'Q3': ('I do not wish to disclose my location', 'Location'),\n    'Q4': ('I prefer not to answer', 'Education'),\n    'Q9': ('I do not wish to disclose my approximate yearly compensation', 'Compensation'), \n}\n\ndef get_pnts_index(question):\n    return df.loc[df[question] == pnts_qa[question][0]].index\n\nprint('Prefer-not-to-say Answers ')\nprint('Question\\tCount\\tProportion')\nfor question in pnts_qa:    \n    ans, desc = pnts_qa[question]\n    df1 = df.loc[get_pnts_index(question), question]\n    print('{0}:{3}\\t{1}\\t{2}'.format(question, df1.count(), df1.count()\/df[question].count(), desc))","ddcf2413":"prefer_not_to_say = pd.DataFrame(index=df.index)\n\nprefer_not_to_say['Q1'] = (df['Q1'] == 'Prefer not to say').astype(int)\nprefer_not_to_say['Q3'] = (df['Q3'] == 'I do not wish to disclose my location').astype(int)\nprefer_not_to_say['Q4'] = (df['Q4'] == 'I prefer not to answer').astype(int)\n#prefer_not_to_say['Q9'] = (df['Q9'] == 'I do not wish to disclose my approximate yearly compensation').astype(int)\n\nA = prefer_not_to_say.values\npd.DataFrame(A.T.dot(A), index=['Q1', 'Q3', 'Q4'], columns=['Q1', 'Q3', 'Q4'])","280e8a93":"prefer_not_to_say.sum(axis=1).value_counts().reset_index().rename(columns={\n    'index': \"Number of unanswered questions\", 0:\"Number of respondents\"})","b21a2967":"df['Q2'] = pd.Categorical(df['Q2'], categories=[\n    '18-21', '22-24', '25-29', '30-34', '35-39', '40-44','45-49', '50-54', '55-59', \n    '60-69', '70-79', '80+'], ordered=True)","8c674576":"def plot_compare_plotly(idx1, idx2, col, idx1_label, idx2_label, title,\n                        sort_by='index', figsize=(10, 5)):\n    d1 = df.loc[idx1, col]\n    d2 = df.loc[idx2, col]\n    \n    total_respondents = (d1.count(), d2.count())\n\n    d1 = d1.value_counts()\n    d2 = d2.value_counts()\n    \n    if sort_by=='index':\n        d1 = d1.sort_index()\n        d2 = d2.sort_index()\n    else:\n        d1 = d1.sort_values()\n        d2 = d2.sort_values()        \n        \n    trace1 = go.Bar(\n        y=d1.index,\n        x=(d1.values \/ total_respondents[0]),\n        text=d1.apply(lambda x: str(x) + ' respondents').values,\n        name=idx1_label,\n        orientation='h'\n    )\n    trace2 = go.Bar(\n        y=d2.index,\n        x=(d2.values \/ total_respondents[1]),\n        text=d2.apply(lambda x: str(x) + ' respondents').values,\n        name=idx2_label,\n        orientation='h'\n    )\n\n    data = [trace1, trace2] if sort_by != 'second' else [trace2, trace1] \n\n    layout = go.Layout(\n        barmode='group',\n        title= title,\n        xaxis= dict(title= 'Proportion',),\n        yaxis=dict(tickmode='linear', showticklabels=True,),\n        legend=dict(orientation=\"h\", x=-0.1, y=-0.2),\n        width=figsize[0] * 80, \n        height=figsize[1] * 80,\n    )\n\n    fig = go.Figure(data=data, layout=layout)\n    py.iplot(fig) \n    \ndef plot_compare_other_plotly(idx, col, idx_label, title, sort_by='index', figsize=(10, 5)):\n    plot_compare_plotly(idx1=idx, idx2=df.drop(index=idx).index, col=col, \n                 idx1_label=idx_label, idx2_label='Other Kagglers', title=title,\n                 sort_by=sort_by, figsize=figsize)","992c7c48":"plot_compare_other_plotly(idx = get_pnts_index('Q1'), col = 'Q2', \n                   idx_label='Kagglers not willing to disclose their gender',\n                          title='Age Distribution')","0b3c893b":"plot_compare_other_plotly(idx = get_pnts_index('Q3'), col = 'Q2', \n             idx_label='Kagglers not willing to disclose their location', title='Age Distribution')","0ec89f4f":"plot_compare_other_plotly(idx = get_pnts_index('Q4'), col = 'Q2', \n             idx_label='Kagglers not willing to disclose their level of formal education', title='Age Distribution')","a92afab0":"plot_compare_other_plotly(idx = (get_pnts_index('Q1') | get_pnts_index('Q3') | get_pnts_index('Q4')),\n                   col = 'Q2', \n             idx_label='Kagglers not willing to disclose either their gender, or location, or educarton level', title='Age Distribution')","e4ecca3f":"def plot_proportions(question, by_col, title, figsize=(10, 5)):\n    df1 = pd.DataFrame(index=df.index)\n    df1[by_col] = df[by_col]\n    df1['NoQ'] = 0\n    df1.loc[get_pnts_index(question), 'NoQ'] = 1\n\n    gbc = df1.groupby(by=by_col).mean().sort_values(by='NoQ')\n\n    fig, ax = plt.subplots(figsize=figsize)\n    ax.barh(y=gbc.index, width=gbc.values.reshape(-1), color='blue', alpha=0.4)\n\n    ax.set_title(title)\n    ax.set_xlabel('Proportion')\n    ax.grid(axis='x')\n","1f1317ff":"plot_proportions('Q9', 'Q3', \n                'Proportion of respondents not willing to disclose their yearly compensation by Country', figsize=(15, 10))","9775ca87":"df1 = pd.DataFrame(index=df.index)\ndf1['Q3'] = df['Q3']\ndf1['NoQ'] = 0\ndf1.loc[get_pnts_index('Q9'), 'NoQ'] = 1\n\ngbc = df1.groupby(by='Q3').mean().sort_values(by='NoQ')\n\ngbc.iloc[[0, -2, -1]]","5195b26e":"plot_compare_other_plotly(idx=get_pnts_index('Q9'), col='Q3', \n                   idx_label='Kagglers not willing to disclose their yearly compensation',\n                  title='Country', sort_by='second', figsize=(12, 10))","f62150fc":"plot_compare_other_plotly(idx=get_pnts_index('Q9'), col='Q7', \n                   idx_label='Kagglers not willing to disclose their yearly compensation',\n                  title='Industry', sort_by='second')","62ace193":"plot_compare_other_plotly(idx=get_pnts_index('Q9'), col='Q6', \n                   idx_label='Kagglers not willing to disclose their yearly compensation',\n                  title='Role at Work', sort_by='second')","4173cae3":"df1 = pd.DataFrame(index=df.index)\ndf1['Q3'] = df['Q3']\ndf1['NoQ9'] = 0\ndf1.loc[get_pnts_index('Q9'), 'NoQ9'] = 1\ndf1['IsStudent'] = (df['Q6'] == 'Student').astype(int)\n\ngbc = df1.groupby(by='Q3').mean()\ngbc['Q9_respondents'] = df[['Q3','Q9']].groupby(by='Q3').count()\n\nprint(\"Top-5 countries & territories by proportion of students\")\nprint(gbc['IsStudent'].sort_values(ascending=False)[0:5].rename(\"Students' proportion\"))","54114318":"trace = go.Scatter(\n    x=gbc['NoQ9'], \n    y=gbc['IsStudent'],\n    mode='markers',\n    marker=dict(size= np.log(gbc['Q9_respondents']) * 2),\n    text=gbc.index.str.cat(gbc['Q9_respondents'].apply(lambda x: str(x) + ' Q9 respondents'), sep=': ') \n)    \n\nlayout = go.Layout(\n    title='Proportion of respondents not willing to disclose their yearly compensation <br>vs Proportion of students <br>by Location',\n    xaxis=dict(title='Proportion of respondents not willing to disclose their yearly compensation',),\n    yaxis=dict(title='Proportion of students',),\n)\n\nfig = go.Figure(data=[trace], layout=layout)\npy.iplot(fig)","2226a827":"stats.spearmanr(gbc['NoQ9'], gbc['IsStudent'])","3b36a555":"... And check Spearman's correlation coefficient for these ratios","bfc11b73":"The plot above shows proportions of age groups for respondents who didn't want to disclose their gender and those who provided an answer. The former distribution has a suspicious peak at '80+' category, it seems that some people who didn't want to tell their gender, didn't also want to tell their age.  In absolute values it is more than half respondents in '80+' group.\n\nAge distributions for those who don't want to tell their location or education as well as those who don't want to answer any of the 3 said questions all have this '80+' peak, though not so large. The plots are given in hidden outputs below ","6faa7148":"So we can see that \n* More than 35% of respondents who didn't want to disclose their yearly compensation were students. Perhaps they selected this answer because they didn't work, and this answer seemed to describe best their situation.\n\n* To study further what factors can unwillingness to talk about salary depend on, one should filter this group out","61f268f6":"Can we say that unwillingness to talk about salary depends on country? Let's plot distributions of Kagglers who don't want to disclose their salary by industry and by their role at work","14237a86":"## Yearly compensation\n\nLet us turn to far more numerous group of respondents who didn't want to disclose their approximate yearly compensation. There are 4756 such people, that is 23.6% of respondents.\n\nUnwillingness to talk about salary can depend on culture, industry, position, or something else. Let's check.\n\nFirstly we plot proportion of respondents not willing to disclose their yearly compensation by country","1f75bd8a":"*  **SurveySchema.csv** shows what questions were shown to different respondents according to their answers and how many people answered each question\n\n* **multipleChoiceResponses.csv** The 2018 Kaggle Machine Learning & Data Science Survey data. Includes respondents' answers that were selected from options given by survey designers\n\n* **freeFormResponses.csv** - When survey respondents selected the \"Other\" category, an option was given for a text response. These responses are collected here.\n\nLet's have a glance at survey data. After some cleaning we have\n","6ee5788a":"The highest proportion of respondents who didn't want to tell their salary was naturally among people who didn't want to disclose their location. Top-5 countries & territories are Hong Kong, China, Pakistan, Bangladesh and India. Percentage varies from 11% (Argentina) to 34% (Hong Kong) \n\nIf we consider distributions of respondents who didn't tell their salary and those who did by country we can see the difference with respect to number of respondents from each country. Here we can see that relatively more people who don't want to disclose their compensation are from India and China and relatively less of them are from the USA","5d5c7b4a":"## Counts & Proportions\n\nFirst of all let's see how many people expressed their unwilingness to answer each question. In the table below column *Proportion* contains ratio of number of prefer-not-to-say answers to the total number of answers for each question. Due to survey procedure total number of answers was different for each question.  ","d3c154fc":"Let's visualize the difference between respondents not willing to answer about their gender, location or education and other respondents with respect to different questions.","d12d0014":"When answering about their gender, country of residence or education level only 1.4 - 1.7% of people didn't want to say. But there are as many as 23.6% of people who didn't want to disclose their yearly compensation. It seems that we should consider Q9 separately. ","d8c0fa94":"Only 12 people didn't answer all 3 questions, 91 people didn't answer 2 questions, 861 people didn't answer only one question. It seems that in most cases unwillingness to answer has nothing to do with privacy concerns.\n","2f812d97":"## Gender, Location & Education\nLet us see if respondent's not answering a question on gender, location or education implies not answering another one. In the table below each cell contains how many people didn't want to answer both question in corresponding row index and question in column index.","133fddfe":"# Explicit Unwillingness to Answer\n\nAfter studying questions and answer variants proposed by designers one can see that 4 questions had an option to explicitly express respondent's unwillingness to answer. They are:\n\n* Q1: *\"What is your gender?\"* with an answer option *\"Prefer not to say\"*\n\n* Q3: *\"In which country do you currently reside?\"* with an option *\"I do not wish to disclose my location\"*\n\n* Q4: *\"What is the highest level of formal education that you have attained or plan to attain within the next 2 years?\"* with an option *\"I prefer not to answer\"*\n\n* Q9: *\"What is your current yearly compensation (approximate USD)?\"* with an option *\"I do not wish to disclose my approximate yearly compensation\"*\n\nWho are those people who preferred to hide some information about their personality? Are they somehow different from those who didn't? Is there any reason for them not to tell? Let's see  ","ade35a97":"Let's visualize dependence between number of students and number of people who didn't want to tell their salary by country...","e17f9614":"Surprisingly, respondent's not answering a question doesn't imply that that they will not also answer another question. Only about 16% of those who didn't answer Q1 didn't also answer Q3, and for other pairs of question this ratio is still less. \n\nLet's count how many people didn't answer different number of questions","23ab75ef":"To conclude with this section, \n* When studying age distributions one should keep in mind that '80+' age group (and maybe other 'senior' groups too) might have been selected sometimes because of respondent's unwillingness to answer the question","0abfb07d":"# Overview\n\nKaggle's second annual Machine Learning and Data Science Survey was live from October 22nd to October 29th, 2018. The results include raw numbers about who is working with data, what\u2019s happening with machine learning in different industries, and the best ways for new data scientists to break into the field.\n\nThis survey received 23,859 usable respondents from 147 countries and territories.\n\nThe files  containing survey results are:","49788d69":"These two plots indicate that there is a group of respondents who tend not to disclose their salary more frequently than others: students. High ratio of students among Chinese and Indian Kagglers must be the reason why respondents from these countries don't disclose their salary more often."}}