{"cell_type":{"8bbcc38c":"code","70bb0443":"code","3fceeccb":"code","b6de026e":"code","b40ff5f3":"code","fc262e6e":"code","1b81a595":"code","d4f5ef08":"code","e77bfacf":"code","8e46a0db":"code","e1a3ec87":"code","70476e77":"code","ac4572d2":"code","cc7f3958":"code","c9a7eba7":"code","0a394c8f":"code","95307a33":"code","bfa54277":"code","d40251f1":"code","e02c7495":"code","c1b732c7":"code","3cbc5bf1":"code","e7057398":"code","f85d23fe":"code","a3fc234b":"code","88e16e69":"code","7eb31fff":"code","1f73a875":"code","add57a78":"code","78433116":"code","64b0dca2":"code","db8d3be9":"code","1b455bd5":"code","e6d35604":"code","cb9c6ea7":"code","0fd38485":"code","2bd87e46":"code","0f94992b":"code","7afa11b4":"code","92be9e17":"code","0334bfe5":"code","73d558e5":"code","640f1365":"code","b3a47a84":"code","30b22d4f":"code","b5a1f282":"code","9681d369":"code","f6ea3200":"code","9546d94f":"code","4cf62c82":"markdown","7a89f4e1":"markdown","2ed3e8ae":"markdown","1529de89":"markdown","601b5e3c":"markdown","f4403916":"markdown","fb902c58":"markdown","f7dda0ab":"markdown","bdf08a89":"markdown","2ae49387":"markdown","d093f702":"markdown","70aacfc1":"markdown","324315bd":"markdown","37f6fbaa":"markdown","6fbff09e":"markdown","de8be487":"markdown","499019ad":"markdown","c9f937e9":"markdown","29954b80":"markdown"},"source":{"8bbcc38c":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt","70bb0443":"df=pd.read_csv(\"..\/input\/heart-disease-uci\/heart.csv\")","3fceeccb":"plt.figure(figsize=(20,10))\nsns.heatmap(df.corr(),annot=True)","b6de026e":"print(df['sex'].value_counts())\nsns.swarmplot(df['target'],df['age'],hue=df['sex'])","b40ff5f3":"# For Heart Disease\ndf_1=df[(df['target']==1)]\nprint(df_1['sex'].value_counts())\nsns.countplot(df_1['sex'])","fc262e6e":"# For No Heart Disease\ndf_0=df[(df['target']==0)]\nprint(df_0['sex'].value_counts())\nsns.countplot(df_0['sex'])","1b81a595":"plt.figure(figsize=(10,5))\nsns.countplot(df['age'],hue=df['target'])","d4f5ef08":"df_54=df[(df['age']<54)]\nsns.countplot(df_54['target'])","e77bfacf":"df_55=df[(df['age']>55)]\nsns.countplot(df_55['target'])","8e46a0db":"df['chol_cat']='NO'\n# split the data using Q1,Q2,Q3,Q4\n# Less than equal to 211-(1)\n# greater than  equal to 212 and less than  equal to 240-(2)\n# greater than  equal to 241 and less than  equal to 274-(3)\n# greater than  equal to 275-(4)\ndf.loc[(df['chol']<=211),'chol_cat']='1'\ndf.loc[(df['chol']>=212) & (df['chol']<=240),'chol_cat']='2'\ndf.loc[(df['chol']>=241) & (df['chol']<=274),'chol_cat']='3'\ndf.loc[(df['chol']>=275),'chol_cat']='4'","e1a3ec87":"sns.countplot(df['chol_cat'],hue=df['target'])\nprint(df['chol_cat'].value_counts())\n# plt.xticks('0-211','212-240','241-274','275 and greater')","70476e77":"df['cp'].value_counts()","ac4572d2":"sns.countplot(df['cp'],hue=df['target'])","cc7f3958":"df['thalach'].describe()","c9a7eba7":"df['heart_cat']='NO'\n# split the data using Q1,Q2,Q3,Q4\n# Less than 133.5-(1)\n# greater than 133.5 and less than equal to 153-(2)\n# greater than 153 and less than  equal to 166-(3)\n# greater than 16675-(4)\ndf.loc[(df['thalach']<=133.5),'heart_cat']='1'\ndf.loc[(df['thalach']>133.5) & (df['thalach']<=153),'heart_cat']='2'\ndf.loc[(df['thalach']>153) & (df['thalach']<=166),'heart_cat']='3'\ndf.loc[(df['thalach']>166),'heart_cat']='4'","0a394c8f":"print(df['heart_cat'].value_counts())\nsns.countplot(df['heart_cat'],hue=df['target'])","95307a33":"df['exang'].value_counts()","bfa54277":"sns.countplot(df['exang'],hue=df['target'])","d40251f1":"df.drop(['thalach','chol'],axis=1,inplace=True)\ndf['chol_cat']=df['chol_cat'].astype(int)\ndf['heart_cat']=df['heart_cat'].astype(int)","e02c7495":"X=df.drop('target',axis=1)\ny=df['target']","c1b732c7":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=3)\nprint(X_train.shape,X_test.shape)\nprint(y_train.shape,y_test.shape)","3cbc5bf1":"import statsmodels.api as sm\nX_constant=sm.add_constant(X_train)\nfrom statsmodels.stats.outliers_influence import variance_inflation_factor \nfor i in zip(X_constant.columns,[variance_inflation_factor(X_constant.values,j) for j in range (0,X_constant.shape[1])]):\n    print(i)","e7057398":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import confusion_matrix,accuracy_score,roc_auc_score,roc_curve\nlr=LogisticRegression(solver='liblinear')\nlr.fit(X_train,y_train)","f85d23fe":"y_train_pred=lr.predict(X_train)\ny_train_prob=lr.predict_proba(X_train)\ny_train_prob=y_train_prob[:,1]","a3fc234b":"print(\"Accuracy score\",accuracy_score(y_train,y_train_pred))\nprint('Confusion matrix-Train','\\n',confusion_matrix(y_train,y_train_pred))\nprint('AUC - Train',roc_auc_score(y_train,y_train_prob))","88e16e69":"y_test_predict=lr.predict(X_test)\ny_test_prob=lr.predict_proba(X_test)[:,1]\nprint(\"Accuracy score\",accuracy_score(y_test,y_test_predict))\nprint('Confusion matrix-Test','\\n',confusion_matrix(y_test,y_test_predict))\nprint('AUC - Test',roc_auc_score(y_test,y_test_prob))","7eb31fff":"fpr,tpr,threashold=roc_curve(y_test,y_test_prob)\n","1f73a875":"plt.plot(fpr,tpr)\nplt.plot(fpr,fpr)\nplt.xlabel('FPR')\nplt.ylabel('TPR')","add57a78":"# Here we are telling the model to create 100 decision tress and make random forest and calculated the score etc\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import confusion_matrix,accuracy_score,roc_auc_score,roc_curve\nfrom sklearn.model_selection import RandomizedSearchCV\nfrom scipy.stats import randint as sp_randint\nrfc=RandomForestClassifier(n_estimators=100,random_state=3)\nparams={'n_estimators':sp_randint(50,200),\n        'max_features':sp_randint(1,24),\n        'max_depth':sp_randint(2,10),\n        'min_samples_split':sp_randint(2,20),\n        'min_samples_leaf':sp_randint(1,20),\n        'criterion':['gini','entropy']\n}\nrsearch_rfc=RandomizedSearchCV(rfc,param_distributions=params,cv=3,scoring='roc_auc',random_state=3,return_train_score=True)\nrsearch_rfc.fit(X,y)","78433116":"rsearch_rfc.best_estimator_","64b0dca2":"rsearch_rfc.best_params_","db8d3be9":"rfc=RandomForestClassifier(**rsearch_rfc.best_params_)\nrfc.fit(X_train,y_train)","1b455bd5":"y_train_predict=rfc.predict(X_train)\ny_train_prob=rfc.predict_proba(X_train)[:,1]\nprint(\"Accuracy score\",accuracy_score(y_train,y_train_predict))\nprint(\"Confusion Matrix\",confusion_matrix(y_train,y_train_predict))\nprint(\"Roc AUC score\",roc_auc_score(y_train,y_train_prob))\n","e6d35604":"y_test_predict=rfc.predict(X_test)\ny_test_prob=rfc.predict_proba(X_test)[:,1]\nprint(\"Accuracy score\",accuracy_score(y_test,y_test_predict))\nprint(\"Confusion Matrix\",confusion_matrix(y_test,y_test_predict))\nprint(\"Roc AUC score\",roc_auc_score(y_test,y_test_prob))","cb9c6ea7":"fpr,tpr,thresholds=roc_curve(y_test,y_test_prob)\nplt.plot(fpr,tpr)\nplt.plot(fpr,fpr)\nplt.xlabel('FPR')\nplt.ylabel('TPR')","0fd38485":"# important features\nimp=pd.DataFrame(rfc.feature_importances_,index=X_train.columns,columns=['imp'])\nimp=imp.sort_values(by='imp',ascending=False)\nimp","2bd87e46":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import RandomizedSearchCV,GridSearchCV\nfrom scipy.stats import randint as sp_randint\nknc=KNeighborsClassifier()\nparams={\n    'n_neighbors':sp_randint(2,6),\n    'leaf_size':sp_randint(5,30),\n    'p':sp_randint(1,5)\n}\nrs_knn=RandomizedSearchCV(knc,param_distributions=params,n_iter=15,scoring='roc_auc',return_train_score=True,cv=3)\nrs_knn.fit(X,y)","0f94992b":"rs_knn.best_params_","7afa11b4":"knc=KNeighborsClassifier(**rs_knn.best_params_)\nknc.fit(X_train,y_train)\n","92be9e17":"y_train_predict=knc.predict(X_train)\ny_train_prob=knc.predict_proba(X_train)[:,1]\nprint(\"Accuracy score\",accuracy_score(y_train,y_train_predict))\nprint(\"Confusion Matrix\",confusion_matrix(y_train,y_train_predict))\nprint(\"Roc AUC score\",roc_auc_score(y_train,y_train_prob))\n","0334bfe5":"y_test_predict=knc.predict(X_test)\ny_test_prob=knc.predict_proba(X_test)[:,1]\nprint(\"Accuracy score\",accuracy_score(y_test,y_test_predict))\nprint(\"Confusion Matrix\",confusion_matrix(y_test,y_test_predict))\nprint(\"Roc AUC score\",roc_auc_score(y_test,y_test_prob))","73d558e5":"fpr,tpr,thresholds=roc_curve(y_test,y_test_prob)\nplt.plot(fpr,tpr)\nplt.plot(fpr,fpr)\nplt.xlabel('FPR')\nplt.ylabel('TPR')","640f1365":"from sklearn.ensemble import AdaBoostClassifier\nada=AdaBoostClassifier()\nparams={\n    'n_estimators':sp_randint(5,40)\n}\nrs_ada=RandomizedSearchCV(ada,param_distributions=params,cv=3,scoring='accuracy')\nrs_ada.fit(X,y)","b3a47a84":"rs_ada.best_params_","30b22d4f":"ada=AdaBoostClassifier(**rs_ada.best_params_)\nada.fit(X_train,y_train)","b5a1f282":"y_train_predict=ada.predict(X_train)\ny_train_prob=ada.predict_proba(X_train)[:,-1]\ny_train_predict\nprint('Overall Accuracy -Train',accuracy_score(y_train,y_train_predict))\nprint('Confusion matrix-Train','\\n',confusion_matrix(y_train,y_train_predict))\nprint('AUC - Train',roc_auc_score(y_train,y_train_prob))\nprint(\"-------------------------------------------------------------------------\")\n\ny_test_pred=ada.predict(X_test)\ny_test_prob=ada.predict_proba(X_test)[:,-1]\nprint('Overall Accuracy -Test',accuracy_score(y_test,y_test_pred))\nprint('Confusion matrix-Test','\\n',confusion_matrix(y_test,y_test_pred))\nprint('AUC - Test',roc_auc_score(y_test,y_test_prob))\nprint(\"-------------------------------------------------------------------------\")\nprint()\n\nfpr,tpr,thresholds=roc_curve(y_test,y_test_prob)\nplt.plot(fpr,tpr)\nplt.plot(fpr,fpr)\nplt.xlabel('FPR')\nplt.ylabel('TPR')","9681d369":"from sklearn.ensemble import VotingClassifier\nlr=LogisticRegression(solver='liblinear')\nknc=KNeighborsClassifier(**rs_knn.best_params_)\nrfc=RandomForestClassifier(**rsearch_rfc.best_params_)\nada=AdaBoostClassifier(**rs_ada.best_params_)\nclf=VotingClassifier(estimators=[('lr',lr),('knn',knc),('rfc',rfc),['ada',ada]],voting='hard')\nclf.fit(X_train,y_train)\ny_train_pred=clf.predict(X_train)\ny_test_predt=clf.predict(X_test)\n\nprint('Accuracy score-Train',accuracy_score(y_train,y_train_pred))\nprint('Accuracy score-Test',accuracy_score(y_test,y_test_pred))\n\n\nfpr,tpr,thresholds=roc_curve(y_test,y_test_prob)\nplt.plot(fpr,tpr)\nplt.plot(fpr,fpr)\nplt.xlabel('FPR')\nplt.ylabel('TPR')","f6ea3200":"clf=VotingClassifier(estimators=[('lr',lr),('knn',knc),('rfc',rfc),['ada',ada]],voting='soft')\nclf.fit(X_train,y_train)","9546d94f":"y_train_pred=clf.predict(X_train)\ny_test_predt=clf.predict(X_test)\ny_train_prob=clf.predict_proba(X_train)[:,1]\ny_test_prob=clf.predict_proba(X_test)[:,1]\n\nprint('Accuracy score-Train',accuracy_score(y_train,y_train_pred))\nprint('Accuracy score-Test',accuracy_score(y_test,y_test_pred))\n\nprint('Roc AuC Score-Train',roc_auc_score(y_train,y_train_prob))\nprint('Roc AuC Score-Test',roc_auc_score(y_test,y_test_prob))\n\n\nfpr,tpr,thresholds=roc_curve(y_test,y_test_prob)\nplt.plot(fpr,tpr)\nplt.plot(fpr,fpr)\nplt.xlabel('FPR')\nplt.ylabel('TPR')","4cf62c82":"# Exercise induced angina (1 = yes; 0 = no)","7a89f4e1":"There are high chances of heart disease when exercise induced angina is true","2ed3e8ae":"# Age ","1529de89":"people with higher maximum heart rate have higher chances of heart disease.","601b5e3c":"# maximum heart rate ","f4403916":"# chest pain type","fb902c58":"# KNN Algorithm","f7dda0ab":"From the above data we can see there are 207 Male and 96 Female that is there are more number of male compared to female\n\nOut of total 96 female, we have 72 female that have heart diseases and remaining 24 dont have \n\nOut of total 207 male, we have 93 that have heart diseases and remaining 114 dont have","bdf08a89":"# Serum cholestoral in mg\/dl","2ae49387":"# Splitting the Data into Train Test Data","d093f702":"Before age 54 we can see more number of people are prone to heart disease where as\n\nafter age 55 we have people prone to heart diseases but the count of no heart diseases is more","70aacfc1":"# LogisticRegression","324315bd":"# 1)ADABOOOST","37f6fbaa":"# Random FOrest","6fbff09e":"LogisticRegression\n    Train-0.91\n    Test-0.91\n\n\nRandom FOrest\n     Train-0.97\n     Test-0.94\n\nKNN\n    Train-0.94\n    Test-0.75\n\nADA Boost\n    Train-0.94\n    Test-0.93\n\n    \nStacking\n    1)Hard Voting:\n        Train Accuracy score-0.89\n        Test Accuracy score-0.85\n    2)Soft Voting:\n        Train-0.97\n        Test 0.90","de8be487":"WE can see that those who are having less serum cholestoral have higher chances of heart disease.","499019ad":"# Gender and target","c9f937e9":"# Boosting algorithms","29954b80":"People having chest pain type 1 or 2 have changes of having heart disease"}}