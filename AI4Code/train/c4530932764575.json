{"cell_type":{"a151b55a":"code","5ea3e8e4":"code","cc8f5d5c":"code","e52512a2":"code","8fbf5dcb":"code","0f834864":"code","45313186":"code","399ce7ce":"code","baff9e09":"code","2866b29b":"code","773d3c5d":"code","2554a7eb":"code","6dbc2816":"code","c8011409":"markdown","27da8784":"markdown","588c72df":"markdown","aae35cdb":"markdown","6fb51229":"markdown"},"source":{"a151b55a":"import tensorflow as tf\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom tensorflow import keras\nfrom sklearn.model_selection import train_test_split\nimport nltk","5ea3e8e4":"class Config:\n    vocab_size = 5000\n    embed_size = 100\n    filters = 256\n    num_words = 3\n    batch_size = 64\n    epochs = 20\n    maxlen = 100\n    \nconfig = Config() ","cc8f5d5c":"train = pd.read_csv(\"\/kaggle\/input\/umich-si650-nlp\/train.csv\")\ntest = pd.read_csv(\"\/kaggle\/input\/umich-si650-nlp\/test.csv\")\nsample_submission = pd.read_csv(\"\/kaggle\/input\/umich-si650-nlp\/sample_submission.csv\")","e52512a2":"train.head()","8fbf5dcb":"test.head()","0f834864":"train[\"sentence_preprocessed\"] = train[\"sentence\"].apply(lambda sentence: \" \". join(nltk.word_tokenize(sentence.lower())))\ntest[\"sentence_preprocessed\"] = test[\"sentence\"].apply(lambda sentence: \" \". join(nltk.word_tokenize(sentence.lower())))","45313186":"test.head()","399ce7ce":"vectorizor = keras.layers.TextVectorization(max_tokens=config.vocab_size)\nvectorizor.adapt(list(train[\"sentence_preprocessed\"]) + list(test[\"sentence_preprocessed\"]))","baff9e09":"x_train, x_val, y_train, y_val = train_test_split(train[\"sentence_preprocessed\"], train[\"label\"], test_size=0.2, random_state=42)\nx_train.shape, x_val.shape, y_train.shape, y_val.shape","2866b29b":"keras.backend.clear_session()\nmodel = keras.Sequential([\n    keras.Input(shape=(None, ), dtype=\"string\"),\n    vectorizor,\n    keras.layers.Embedding(config.vocab_size, config.embed_size, input_length=config.maxlen),\n    keras.layers.SpatialDropout1D(0.2),\n    keras.layers.Conv1D(filters=config.filters, kernel_size=config.num_words, activation=\"relu\"),\n    keras.layers.GlobalMaxPooling1D(),\n    keras.layers.Dense(1, activation=\"sigmoid\")\n])","773d3c5d":"keras.utils.plot_model(model, show_shapes=True)","2554a7eb":"model.summary()","6dbc2816":"model.compile(loss=\"binary_crossentropy\", optimizer=\"adam\", metrics=[\"accuracy\"])\nhistry = model.fit(\n    x_train, y_train, \n    batch_size=config.batch_size, \n    epochs=config.epochs,\n    validation_data=(x_val, y_val)\n)","c8011409":"## UMICH Sentiment Classification: [99.56% accuracy]","27da8784":"## Train Validation Split","588c72df":"## Modeling","aae35cdb":"## Text Vectorization","6fb51229":"## Preprocessing"}}