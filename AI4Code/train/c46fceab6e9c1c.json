{"cell_type":{"4a3202bb":"code","0c21ea09":"code","bb0bc394":"code","c67b27c0":"code","48ad4658":"code","9d224145":"code","e7764f23":"code","d9b8873a":"code","0343940a":"code","bc2d0664":"code","4122e5d0":"code","16c8246d":"code","9f31182d":"code","ef4622f8":"code","2a21f4ff":"code","3d096a02":"code","5a8a2a77":"code","d30cd6da":"code","b82e123d":"code","1e68e261":"code","4669f473":"code","981fe305":"code","30d4ec1e":"code","a8935c8d":"code","3ca1550f":"code","d3820742":"markdown","55840a75":"markdown","a54cd884":"markdown","0c0d8633":"markdown","75ec6ccf":"markdown","72fe3a9e":"markdown","aa9ba2ba":"markdown","cddcfdf4":"markdown","aad99873":"markdown","5fc8e8c4":"markdown","1adba064":"markdown","5f07e585":"markdown","66ea25e0":"markdown","fa57b111":"markdown","c95639fd":"markdown","c7705246":"markdown","b92571c1":"markdown","118d8f60":"markdown","206d6e14":"markdown"},"source":{"4a3202bb":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sb # statistical data visualization\nimport matplotlib.pyplot as plt\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session\n\n# Changing configuration to display all columns of the data frames.\npd.set_option('display.max_columns', None)\npd.set_option('display.max_rows', None)\npd.set_option('display.width', None)\npd.set_option('display.max_colwidth', 100)","0c21ea09":"df_calendar = pd.read_csv(\"\/kaggle\/input\/eda-atenas-airbnb\/calendar.csv\")\ndf_listings = pd.read_csv(\"\/kaggle\/input\/eda-atenas-airbnb\/listings.csv\")\ndf_reviews = pd.read_csv(\"\/kaggle\/input\/eda-atenas-airbnb\/reviews.csv\")","bb0bc394":"print(\"calendar shape: \", df_calendar.shape)\nprint(\"listings shape: \", df_listings.shape)\nprint(\"reviews shape: \", df_reviews.shape)","c67b27c0":"df_calendar.head(5)","48ad4658":"df_calendar.info()","9d224145":"df_reviews.head(5)","e7764f23":"df_reviews.info()","d9b8873a":"df_listings.head(5)","0343940a":"# Printa informa\u00e7\u00f5es sobre o dataframe\ndf_listings.info()","bc2d0664":"# Removes colunas in\u00fateis\ndf_listings = df_listings.drop(columns=['listing_url', 'scrape_id', 'last_scraped', 'picture_url','host_url', 'host_picture_url', 'host_thumbnail_url','listing_url', 'neighbourhood_group_cleansed', 'bathrooms', 'calendar_updated'])","4122e5d0":"# Remove o cifr\u00e3o ao in\u00edcio da string\ndf_listings.price = df_listings.price.str.replace('$','')\n# Remove a v\u00edrgula como separador de milhar e retorna o tipo como um float\ndf_listings.price = df_listings.price.str.replace(',','',regex='false').astype(float)\n\ndf_listings.price.dtypes","16c8246d":"df_listings.describe()","9f31182d":"# Pega o percentil 99\nprice_99_percentile = df_listings.price.quantile(.99)\nprint(price_99_percentile)\n\n# Plota um histograma do 1% mais caro\ndf_listings[df_listings.price >= price_99_percentile].price.hist()","ef4622f8":"# Plota a posi\u00e7\u00e3o geogr\u00e1fica das acomoda\u00e7\u00f5es\n\n# Mapa de Atenas exportado por openstreetmap.org\nathens_m = plt.imread('..\/input\/eda-atenas-airbnb\/athens_map_corrected.png')\n\n# Define a \u00e1rea de plotagem com base em coordenadas de latitude e longitude\nBBox=(23.68,23.79,37.96,38.04)\n\nplt.subplots(figsize=(20,15))\nplt.scatter(df_listings[df_listings.price>=5000].longitude,df_listings[df_listings.price>=5000].latitude, s=30, c='red')\nplt.scatter(df_listings[(df_listings.price<5000)&(df_listings.price>=3000)].longitude,df_listings[(df_listings.price<5000)&(df_listings.price>=3000)].latitude, s=30, c='blue')\nplt.scatter(df_listings[(df_listings.price<3000)&(df_listings.price>=450)].longitude,df_listings[(df_listings.price<3000)&(df_listings.price>=450)].latitude, s=30, c='green')\nplt.scatter(df_listings[df_listings.price<450].longitude,df_listings[df_listings.price<450].latitude, s=10, c='gray', alpha=0.35)\nplt.title(\"Acomoda\u00e7\u00f5es AirBNB em Atenas. Vermelho = acima de 5k euros\/noite, Azul = entre 3k e 5k, Verde = entre 450 e 3k, Cinza = restante\")\nplt.legend()\nplt.imshow(athens_m,zorder=0,extent=BBox)","2a21f4ff":"# Plota a posi\u00e7\u00e3o geogr\u00e1fica das acomoda\u00e7\u00f5es desconsiderando o 1% mais caro.\n\n# Mapa de Atenas exportado por openstreetmap.org\nathens_m = plt.imread('..\/input\/eda-atenas-airbnb\/athens_map_corrected.png')\n\n# Define a \u00e1rea de plotagem com base em coordenadas de latitude e longitude\nBBox=(23.68,23.79,37.96,38.04)\n\nplt.subplots(figsize=(20,15))\nplt.scatter(df_listings[(df_listings.price<450)&(df_listings.price>=185)].longitude,df_listings[(df_listings.price<450)&(df_listings.price>=185)].latitude, s=8, c='red', alpha=0.5)\nplt.scatter(df_listings[(df_listings.price<185)&(df_listings.price>=80)].longitude,df_listings[(df_listings.price<185)&(df_listings.price>=80)].latitude, s=8, c='blue', alpha=0.5)\nplt.scatter(df_listings[(df_listings.price<80)&(df_listings.price>=50)].longitude,df_listings[(df_listings.price<80)&(df_listings.price>=50)].latitude, s=8, c='green', alpha=0.5)\nplt.scatter(df_listings[df_listings.price<50].longitude,df_listings[df_listings.price<50].latitude, s=8, c='gray', alpha=0.5)\nplt.title(\"Acomoda\u00e7\u00f5es AirBNB em Atenas. Vermelho = acima entre 185 e 450 euros\/noite, Azul = entre 80 e 185, Verde = entre 50 e 80, Cinza = restante\")\nplt.legend()\nplt.imshow(athens_m,zorder=0,extent=BBox)","3d096a02":"area = plt.gcf()\narea.set_size_inches( 10, 15)\n\n\nsb.boxplot(y = 'neighbourhood_cleansed', x='price', data=df_listings[df_listings.price<450], orient='h', \n            showfliers = False, width=1);","5a8a2a77":"# H\u00e1 uma acomoda\u00e7\u00e3o com 30 quartos e outras 2 com mais de 40 camas, o que dificulta a visualiza\u00e7\u00e3o, de modo que foram retiradas. Tamb\u00e9m foram mantidas apenas acomoda\u00e7\u00f5es abaixo do percentil 99\n\ndf_listings_filtered = df_listings[(df_listings.price<450)&(df_listings.bedrooms<30)&(df_listings.beds<40)]\n\nfig,a = plt.subplots(2,3,figsize=(20,15))\na[0,0].scatter(df_listings_filtered.bedrooms,df_listings_filtered.price,s=4)\na[0,0].set_title(\"Pre\u00e7o x N\u00famero de quartos\")\na[0,1].scatter(df_listings_filtered.beds,df_listings_filtered.price,s=4)\na[0,1].set_title(\"Pre\u00e7o x N\u00famero de camas\")\na[0,2].scatter(df_listings_filtered.accommodates,df_listings_filtered.price,s=4)\na[0,2].set_title(\"Pre\u00e7o x N\u00famero de ocupantes\")\na[1,0].scatter(df_listings_filtered.review_scores_rating,df_listings_filtered.price,s=4)\na[1,0].set_title(\"Pre\u00e7o x Review Scores Rating\")\na[1,1].scatter(df_listings_filtered.review_scores_location,df_listings_filtered.price,s=4)\na[1,1].set_title(\"Pre\u00e7o x Score de Avalia\u00e7\u00e3o da Localiza\u00e7\u00e3o\")\na[1,2].scatter(df_listings_filtered.review_scores_value,df_listings_filtered.price,s=4)\na[1,2].set_title(\"Pre\u00e7o x Score de Avalia\u00e7\u00e3o do Valor\")","d30cd6da":"!pip install wordcloud","b82e123d":"from PIL import Image\nfrom wordcloud import WordCloud, STOPWORDS, ImageColorGenerator","1e68e261":"# Faz um inner join dos dataframes listings e reviews\n\ndf_listings_reviews = pd.merge(\n    df_listings,\n    df_reviews,\n    how=\"inner\",\n    on=None,\n    left_on=\"id\",\n    right_on=\"listing_id\",\n)","4669f473":"df_listings.review_scores_rating.describe()","981fe305":"# Concatena todos os textos das reviews de acomoda\u00e7\u00f5es com rating > 4.88 (mediana), para uso com o wordcloud\nhigh_review_text = \" \".join(str(review) for review in df_listings_reviews.comments[df_listings_reviews.review_scores_rating>4.88])\n\nprint(\"N\u00famero de coment\u00e1rios em acomoda\u00e7\u00f5es com rating maior que 4.88: \", len(df_listings_reviews.comments[df_listings_reviews.review_scores_rating>4.88]))","30d4ec1e":"# Cria uma imagem com wordcloud usando o texto concatenado acima\n\nstopwords = set(STOPWORDS)\n\n# Retirando algumas palavras que se repetem muito e dominam a nuvem, deixando a visualiza\u00e7\u00e3o das outras palavras prejudicada\nstopwords.update(['apartment','\u03ba\u03b1\u03b9', 'Athen', 'Athens', 'br'])\n\nwordcloud = WordCloud(stopwords=stopwords, background_color='white',width=800,height=400).generate(high_review_text)\n\nplt.figure(figsize=(15,10))\nplt.imshow(wordcloud, interpolation='bilinear')\nplt.axis(\"off\")\nplt.show()","a8935c8d":"# Concatena todos os textos das reviews de acomoda\u00e7\u00f5es com rating <= 3.50, para uso com o wordcloud\nlow_review_text = \" \".join(str(review) for review in df_listings_reviews.comments[df_listings_reviews.review_scores_rating<=3.50])\n\nprint(\"N\u00famero de coment\u00e1rios em acomoda\u00e7\u00f5es com rating menor que 3.50: \", len(df_listings_reviews.comments[df_listings_reviews.review_scores_rating<=3.50]))","3ca1550f":"# Cria uma imagem com wordcloud usando o texto concatenado acima\n\nstopwords = set(STOPWORDS)\n\n# Retirando algumas palavras que se repetem muito e dominam a nuvem, deixando a visualiza\u00e7\u00e3o das outras palavras prejudicada\nstopwords.update(['apartment','\u03ba\u03b1\u03b9', 'Athen', 'Athens', 'br', '\u03bd\u03b1', '\u03c4\u03bf'])\n\nwordcloud = WordCloud(stopwords=stopwords, background_color='white',width=800,height=400).generate(low_review_text)\n\nplt.figure(figsize=(15,10))\nplt.imshow(wordcloud, interpolation='bilinear')\nplt.axis(\"off\")\nplt.show()","d3820742":"* calendar tem 3518603 linhas and 7 colunas\n* listings tem 9640 linhas and 74 colunas\n* reviews tem 366678 linhas and 6 colunas","55840a75":"<h2>Analisando os textos dos coment\u00e1rios<\/h2>","a54cd884":"<h3>Investigando se a distribui\u00e7\u00e3o geogr\u00e1fica influencia no pre\u00e7o<\/h3>","0c0d8633":"Desconsiderando as acomoda\u00e7\u00f5es 1% mais caras e subdividindo as mais baratas, pode-se ver que a maior parte dos pontos azuis (entre 80 e 185 euros\/noite) e vermelhos (entre 185 e 450 euros\/noite) est\u00e3o pr\u00f3ximos \u00e0 Acr\u00f3pole. Mais longe desta regi\u00e3o, as acomoda\u00e7\u00f5es mais baratas (pontos cinzas) passam a ser majorit\u00e1rias.\nO bairro de Kolonaki (\u039a\u039f\u039b\u03a9\u039d\u0391\u039a\u0399, nordeste da regi\u00e3o da Acr\u00f3pole) parece ser a regi\u00e3o n\u00e3o adjacente \u00e0 Acr\u00f3pole que possui a maior quantidade de acomoda\u00e7\u00f5es mais caras (mais pontos azuis e vermelhos em rela\u00e7\u00e3o a pontos verdes e cinzas). Este \u00e9 um bairro mais conhecido por suas lojas de grife e com\u00e9rcio mais luxuoso, o que pode justificar essa predomin\u00e2ncia maior.","75ec6ccf":"A tabela calendar contem informa\u00e7\u00e3o sobre a disponibilidade de cada propriedade durante um certo per\u00edodo de tempo. Ela tamb\u00e9m cont\u00e9m pre\u00e7o em moeda local e m\u00ednimo\/m\u00e1ximo de noites que podem ser alugadas.","72fe3a9e":"A tabela reviews cont\u00e9m dados sobre avalia\u00e7\u00f5es que os clientes d\u00e3o a cada propriedade.","aa9ba2ba":"<h1><strong>Configura\u00e7\u00e3o Inicial<\/strong><\/h1>","cddcfdf4":"Podem-se ver diversas palavras positivas: \"perfect\", \"clean\", \"comfortable\", \"highly recommend\", \"enjoyed\", \"amazing\", \"great\", \"friendly\", entre outras.\n\nAlgumas palavras neutras indicam o que pode ser considerada uma boa caracter\u00edstica: \"close\" (pr\u00f3ximo a), \"Acropoli\", \"metro\", \"metro station\", \"airport\", \"walking distance\" etc.\n\nAs palavras mais frequentes foram \"stay\" e \"place\", possivelmente por serem comumente utilizadas em ingl\u00eas em express\u00f5es como \"nice stay\" ou \"great place\".","aad99873":"<h1><strong>Analisando o dataset<\/strong><\/h1>","5fc8e8c4":"* O desvio padr\u00e3o dos pre\u00e7os est\u00e1 bastante alto (387 euros, para uma m\u00e9dia de 90 euros)\n* O percentil 75 dos pre\u00e7os \u00e9 80 euros, enquanto o m\u00e1ximo pre\u00e7o \u00e9 8 mil euros.","1adba064":"<h2>Investiga\u00e7\u00e3o da distribui\u00e7\u00e3o de pre\u00e7os<\/h2>","5f07e585":"Primeiro, ser\u00e3o analisados os coment\u00e1rios das acomoda\u00e7\u00f5es com os maiores ratings. Ser\u00e1 usado o valor de 4.88 (mediana).","66ea25e0":"* H\u00e1 uma concentra\u00e7\u00e3o maior de acomoda\u00e7\u00f5es mais caras perto do centro da cidade. Isso faz sentido, pois essa \u00e9 uma regi\u00e3o tur\u00edstica, pr\u00f3xima da Acr\u00f3pole e de outras regi\u00f5es antigas, como o Templo de Zeus.\n* No entanto, pode-se notar que o n\u00famero de acomoda\u00e7\u00f5es mais baratas tamb\u00e9m \u00e9 grande nessas mesmas regi\u00f5es. O bairro de Rouf (\u03a1\u03bf\u03c5\u03c6, a oeste da Acr\u00f3pole) parece ser a \u00fanica exce\u00e7\u00e3o, com menos pontos cinzas em rela\u00e7\u00e3o aos pontos verdes.\n* Estes fatos sugerem que o aumento de pre\u00e7o das acomoda\u00e7\u00f5es 1% mais caras <strong>n\u00e3o \u00e9 influenciado apenas pela localiza\u00e7\u00e3o.<\/strong>","fa57b111":"Em seguida, s\u00e3o avaliados os coment\u00e1rios de acomoda\u00e7\u00f5es com ratings menores. Utilizado o valor de 3.50 como refer\u00eancia.","c95639fd":"Os dados da coluna \"price\" s\u00e3o string (datatype do pandas \u00e9 object), ent\u00e3o isso ser\u00e1 corrigido.","c7705246":"<h3>Investigando a rela\u00e7\u00e3o de outras vari\u00e1veis com o pre\u00e7o<\/h3>","b92571c1":"As acomoda\u00e7\u00f5es maiores (que possuem mais quartos, camas e comportam mais ocupantes) tendem a apresentar menos op\u00e7\u00f5es baratas do que as acomoda\u00e7\u00f5es menores.\n\nA maior parte das avalia\u00e7\u00f5es gerais (Review Scores Rating), avalia\u00e7\u00f5es de localiza\u00e7\u00e3o e avalia\u00e7\u00f5es de valor encontraram-se na faixa entre 4.0 e 5.0.\nAs acomoda\u00e7\u00f5es mais caras apresentam avalia\u00e7\u00f5es mais altas nos tr\u00eas crit\u00e9rios, o que \u00e9 evidenciado pela escassez de pontos na regi\u00e3o superior dos gr\u00e1ficos para as notas entre 1.0 e 3.5, a menos do gr\u00e1fico de avalia\u00e7\u00e3o de localiza\u00e7\u00e3o, que apresenta alguns valores entre 3.0 e 4.0 para acomoda\u00e7\u00f5es acima de 200 euros\/noite.\nHouve apenas 1 nota menor do que 3.0 para acomoda\u00e7\u00f5es acima de 200 euros\/noite.","118d8f60":"Notam-se palavras de cunho positivo: \"clean\", \"recommend\", \"great\", \"well\", \"good\", \"nice\".\n\nPor outro lado, notam-se tamb\u00e9m palavras de cunho negativo: \"host canceled\", \"worst\", \"bad\", \"dirty\", \"problem\".\n\nAlgumas palavras neutras podem dar ideia do que \u00e9 considerado um ponto negativo: \"arrival\", \"automated posting\", \"reservation days\", \"host\", \"experience\", \"hot water\", \"refund\", \"wifi\", \"money\".\n\nPodem-se ver mais palavras em grego neste caso. Algumas delas: \"\u03c0\u03bf\u03bb\u03c5\" (muito), \"\u03c3\u03c0\u03b9\u03c4\u03b9\" (lar), \"\u03ba\u03b1\u03bc\u03b9\u03b1\" (tudo), \"\u03b4\u03b5\u03bd\" (n\u00e3o), \"\u03c4\u03bf\u03c0\u03bf\u03b8\u03b5\u03c3\u03b9\u03b1\" (localiza\u00e7\u00e3o), \"\u03b4\u03b9\u03b1\u03bc\u03b5\u03c1\u03b9\u03c3\u03bc\u03b1\" (apartamento), \"\u03ba\u03b1\u03b8\u03b1\u03c1\u03bf\" (limpo)","206d6e14":"A tabela listings cont\u00e9m dados detalhados a respeito das propriedades em si.\n\nAlgumas colunas possuem informa\u00e7\u00f5es irrelevantes para esta an\u00e1lise, de modo que ser\u00e3o removidas.\n\nAs colunas \"bathrooms\", \"calendar_updated\" e \"neighbourhood_group_cleansed\" parecem estar vazias (somente valores NaN). Isso ser\u00e1 verificado abaixo. Se for verdade, essas colunas tamb\u00e9m ser\u00e3o removidas."}}