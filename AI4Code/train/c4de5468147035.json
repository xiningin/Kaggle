{"cell_type":{"cdbecba7":"code","067d1012":"code","b5266959":"code","32a7aef4":"code","50ad7120":"code","2dc12d26":"code","b2c39910":"code","81279cc1":"code","f7689fab":"code","1d16b566":"code","7bea5cca":"code","f3025b17":"markdown","33295b1b":"markdown","7e6257b2":"markdown","2e797e0b":"markdown","bd89a33e":"markdown","768038f4":"markdown","ac2310cc":"markdown","30514b6b":"markdown"},"source":{"cdbecba7":"import pandas as pd\nfrom collections import defaultdict\nfrom statistics import mean\nimport numpy as np\nfrom sklearn.compose import make_column_transformer\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_absolute_error, mean_squared_error\nfrom sklearn.model_selection import train_test_split, cross_val_score, cross_validate, cross_val_predict\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import OneHotEncoder","067d1012":"train_data = pd.read_csv(\"\/kaggle\/input\/machine-learning-lab-cas-data-science-hs-20\/train-data.csv\", index_col=0)","b5266959":"goal_variable = ['G3']\nnumeric_features = ['studytime', 'age']\n# categorical_features = [ 'school', 'sex', 'address', 'Pstatus', 'Medu', 'Fedu', 'Mjob', 'Fjob', 'guardian','failures', 'schoolsup', 'paid', 'activities', 'nursery', 'higher', 'internet', 'romantic' ]\ncategorical_features = ['failures']\n","32a7aef4":"train_data = train_data.drop(columns=['reason', 'absences', 'famsize', 'famsup', 'famrel'])","50ad7120":"train_data = train_data[goal_variable + numeric_features + categorical_features]","2dc12d26":"X_train_data = train_data[numeric_features + categorical_features].dropna()\ny_train_data = train_data[goal_variable].to_numpy()\n\n\nX_train, X_dev, y_train, y_dev = train_test_split(X_train_data, y_train_data, test_size=0.1)","b2c39910":"\npipeline = Pipeline([\n    ('pre', make_column_transformer((OneHotEncoder(handle_unknown='ignore'), categorical_features), remainder='passthrough')),\n    ('clf', LinearRegression())\n])\n\npipeline.fit(X_train, y_train)","81279cc1":"y_train_pred = pipeline.predict(X_train)\nprint(\"MAE auf dem Training Datensatz\\t\\t\", mean_absolute_error(y_train, y_train_pred))\n\ny_dev_pred = pipeline.predict(X_dev)\nprint(\"MAE auf dem Validation Datensatz\\t\", mean_absolute_error(y_dev, y_dev_pred))","f7689fab":"X_test = pd.read_csv(\"\/kaggle\/input\/machine-learning-lab-cas-data-science-hs-20\/test-data.csv\", index_col=0)\nX_test = X_test[numeric_features + categorical_features]","1d16b566":"y_test_pred = pipeline.predict(X_test)","7bea5cca":"X_test_submission = pd.DataFrame(index=X_test.index)\nX_test_submission['G3'] = y_test_pred\nX_test_submission.to_csv('linear_submission.csv', header=True, index_label='id')","f3025b17":"Welche Features selektieren wir?","33295b1b":"Auswerten auf dem Test & Validation Datensatz","7e6257b2":"Predict f\u00fcr den Test Datensatz.","2e797e0b":"Erstellen eines Validation Datensatzes","bd89a33e":"Fehlende Werte behandeln. Hier werden die Zeilen mit fehlenden Features entfernt.","768038f4":"Erstellen eines .csv files f\u00fcr die Submission auf Kaggle.","ac2310cc":"Erstellen und fitten (trainieren) der Pipeline.","30514b6b":"Laden der Trainings Daten"}}