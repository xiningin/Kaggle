{"cell_type":{"f7d6b648":"code","ff828d9a":"code","477449c4":"code","51bb9320":"code","da63ed96":"code","32c942c2":"code","7d36f6da":"code","b5dff92b":"code","d2f4e83f":"code","3c783124":"code","2ca48e50":"code","bd56df1a":"code","6e95c6b7":"code","230e8497":"code","1c7c3ca9":"code","2006cb24":"code","5b01beec":"markdown","01f83a34":"markdown","93695355":"markdown","3bcddbfa":"markdown","efcc8d91":"markdown","027f6a90":"markdown","97bd3020":"markdown","3595564d":"markdown","aa5f0d5c":"markdown","78e74dae":"markdown","6df4267f":"markdown"},"source":{"f7d6b648":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings(\"ignore\")","ff828d9a":"ndf = pd.read_csv('..\/input\/netflix-shows\/netflix_titles.csv', index_col='show_id')\nndf.head(3)","477449c4":"# checking missing data\n\nfor i in ndf.columns:\n  null = ndf[i].isnull().sum()\n  if null == 0:\n    continue\n  print('{} null rate: {:.2f}%'.format(i, null\/len(ndf)*100))","51bb9320":"#@title Default title text\n# replace missing values\n\nndf.country.fillna(ndf.country.mode()[0], inplace=True)\n\nndf.cast.fillna('Unknown', inplace=True)\nndf.director.fillna('Unknown', inplace=True)\n\n# drop missing values\n\nndf.dropna(inplace=True)\n\n# drop duplicates\n\nndf.drop_duplicates(inplace=True)","da63ed96":"ndf.info()","32c942c2":"ndf.date_added = pd.to_datetime(ndf.date_added)\n\nndf['month_added'] = ndf.date_added.dt.month_name()\nndf['year_added'] = ndf.date_added.dt.year\n\nndf.head(3)","7d36f6da":"fig = plt.figure(figsize=(10,10))\nwedges, texts, autotexts = plt.pie(ndf['type'].value_counts().sort_values(),\n        labels=ndf['type'].value_counts().sort_values().index,\n        explode=[0.05,0],\n        autopct='%1.2f%%',\n        textprops=dict(family='sans-serif', size=20),\n        colors=['#221f1f', '#b20710'])\n\nplt.setp(texts, color='#221f1f')\nplt.setp(autotexts, color='#f5f5f1', weight='bold')\n\nfig.text(1, .45, '''\nIn the last 13 years, almost 70% of the content\non Netflix is movies and the rest is TV shows\n'''\n    , fontsize=15, fontweight='light')\n\nplt.show()","b5dff92b":"# some content has more than one country listed. \n# we'll parse each country from the data with that nested list. \n\nfrom collections import Counter\n\ncountry_data = ndf['country']\ncountry_count = Counter(','.join(country_data).replace(' ,',',').replace(', ',',').split(','))\ncountry_count = pd.Series(dict(country_count)).sort_values(ascending=False)\n\n# top 10 countries\n\ntop10Country = country_count.head(10)\n\n# abbreviate the names of several countries\n\ntop10Country.rename({'United States':'US', 'United Kingdom':'UK', 'South Korea':'S. Korea'}, inplace=True)","d2f4e83f":"# Plot\n\ncolor_map = ['#f5f5f1' for _ in range(10)]\ncolor_map[0] = color_map[1] = color_map[2] =  '#e50914' # color highlight\n\nfig, ax = plt.subplots(1,1, figsize=(12, 8))\nax.bar(top10Country.index, top10Country, width=0.5, \n       edgecolor='darkgray',\n       linewidth=0.6,color=color_map)\n\n# annotations\n\nfor i in top10Country.index:\n    ax.annotate(\"{}\".format(top10Country[i]),\n                xy=(i, top10Country[i] + 150),\n                va = 'center', ha='center',fontweight='light', fontsize=12)\n\n# remove border from barplot\n\n[ax.spines[i].set_visible(False) for i in ['top', 'left', 'right']]\n\nplt.xticks(range(10), top10Country.index, fontsize=13)\n\nax.grid(axis='y', linestyle='-', linewidth = 1.3, alpha=0.9)   \ngrid_y_ticks = np.arange(0, 4500, 500)\nplt.yticks(grid_y_ticks, fontsize=13)\n\nax.set_axisbelow(True)\n\n# add title and sub-title\n\nfig.text(0.09, 1, 'Top 10 countries on Netflix', fontsize=22, fontweight='light')\nfig.text(0.09, 0.95, 'The three most frequent countries have been highlighted.', fontsize=13, fontweight='light')\n\n# add insight text\n\nfig.text(1, .63, 'Insight', fontsize=20, fontweight='light')\nfig.text(1, .37, '''\nCountry with the most prolific content \nproduction on Netflix is US followed by \nIndia and UK with a significant \nnumber of content gap.\n\nWith Netflix itself being a company from US, \nit is not surprising that US as the country \nwith the most content on Netflix.\n'''\n         , fontsize=13, fontweight='light')\n\nplt.show()","3c783124":"# select the data\n\ncolumns = ndf['type'].value_counts().index\nindex = ndf['year_added'].value_counts().index\n\ndata_ya = pd.DataFrame(index=index).sort_index()\nfor col in columns:\n  data_ya[col] = ndf.loc[ndf['type']==col, 'year_added'].value_counts()\ndata_ya.fillna(0, inplace=True)\n\n# plot\n\nfig, ax = plt.subplots(1, 1, figsize=(12,6))\ncolor_map = [\"#b20710\", \"#e50914\", \"#221f1f\"]\n\nax.fill_between(data_ya.index, 0, data_ya.sum(axis=1),\n                color=color_map[2],\n                label=data_ya.sum(axis=1))\nfor i, col in enumerate(columns):\n  ax.fill_between(data_ya[col].index, 0, data_ya[col], \n                  color=color_map[i], \n                  label=data_ya[col])\n\n\nax.set_xlim(2008, 2020)\nplt.xticks(np.arange(2008, 2021, 1), fontsize=13)\n\nax.yaxis.tick_right()\nax.grid(axis='y', linestyle='-', linewidth = 1.3, alpha=0.5)\nplt.yticks(np.arange(0, 2400, 300), fontsize=13)\nax.set_axisbelow(True)\n\nfor s in ['top', 'right','bottom','left']:\n    ax.spines[s].set_visible(False)\n\nax.axhline(y = 0, color = 'black', linewidth = 1.3, alpha = .7)\n\nfig.text(0.12,0.2,\"TV Show\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color=color_map[1])\nfig.text(0.21,0.2,\"|\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color='black')\nfig.text(0.22,0.2,\"Movie\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color=color_map[0])\nfig.text(0.28,0.2,\"|\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color='black')\nfig.text(0.29,0.2,\"Total Contents\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color=color_map[2])\n\nfig.text(0.12,0.5, '''\n* Although Netflix has been around since 2008, the amount of \n  new Netflix content has only grown substantially since 2014.\n\n* In 2020, it was highlighted that the amount of content \n  added was much less than last year. This is not surprising \n  because 2020 is the beginning of the Covid-19 pandemic \n  which has a negative impact on film production.\n''', fontweight=\"light\", fontsize=15)\n\nplt.show()","2ca48e50":"# select the data\n\ncolumns = ndf['type'].value_counts().index\nindex = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']\n\ndata_ma = pd.DataFrame(index=index)\nfor col in columns:\n  data_ma[col] = ndf.loc[ndf['type']==col, 'month_added'].value_counts()\ndata_ma.fillna(0, inplace=True)\n\n# abbreviate the month name\n\nfor idx in index:\n  data_ma.rename({idx:idx[:3]}, inplace=True)\n\n\n# plot\n\nfig, ax = plt.subplots(1, 1, figsize=(12,6))\ncolor_map = [\"#b20710\", \"#e50914\", \"#221f1f\"]\n\nax.fill_between(data_ma.index, 0, data_ma.sum(axis=1),\n                color=color_map[2],\n                label=data_ma.sum(axis=1))\nfor i, col in enumerate(columns):\n  ax.fill_between(data_ma[col].index, 0, data_ma[col], \n                  color=color_map[i], \n                  label=data_ma[col])\n\nax.set_xticklabels(data_ma.index, fontsize=13)\n\nax.yaxis.tick_right()\nax.set_yticklabels(np.arange(0, 900, 100), fontsize=13)\nax.grid(axis='y', linestyle='-', linewidth = 1.3, alpha=0.5)\nax.axhline(y = 0, color = 'black', linewidth = 1.3, alpha = .7)\n\nax.set_axisbelow(True)\nax.margins(x=0)\nfor s in ['top', 'right','bottom','left']:\n    ax.spines[s].set_visible(False)\n\nfig.text(0.12,0.84,\"TV Show\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color=color_map[1])\nfig.text(0.21,0.84,\"|\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color='black')\nfig.text(0.22,0.84,\"Movie\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color=color_map[0])\nfig.text(0.28,0.84,\"|\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color='black')\nfig.text(0.29,0.84,\"Total Contents\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color=color_map[2])\n\nplt.show()","bd56df1a":"# import x axis into theta\n\nangles=np.linspace(0, 2*np.pi, len(data_ma.index), endpoint=False)\n# angles=np.concatenate((angles,[angles[0]]))\n\n# plot\n\ncolor_map = [\"#b20710\", \"#e50914\", \"#221f1f\"]\n\nfig, ax = plt.subplots(1, 1, figsize=(10,10))\nax = plt.subplot(111, polar=True)\n\nax.bar(angles, data_ma.sum(axis=1), width=.53, color=color_map[2])\nfor i, col in enumerate(data_ma.columns):\n  ax.bar(angles, data_ma[col], width=.53, color=color_map[i])\n  # ax.fill(angles, movie, color='#ff0000',alpha=0.25)\n\nax.set_theta_offset(angles[2]) # set the plot data to start at 60 degrees\nax.set_theta_direction(-1) # set the clockwise direction\nax.set_thetagrids((angles * 180\/np.pi)[0:len(data_ma.index)], data_ma.index, fontsize = 13)\n\nax.set_rlabel_position(angles[-1]*180\/np.pi)\nax.set_rgrids(np.arange(0, 900, 100), fontsize=13, color='darkgrey')\n\nax.grid(b=True, axis='both', linestyle='-', linewidth = 2, color='darkgrey', alpha=0.25)\n\nax.spines['polar'].set_visible(False)\n\n# ax.set_axisbelow(True)\n\nfig.text(0.12,.93,\"TV Show\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color=color_map[1])\nfig.text(0.23,.93,\"|\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color='black')\nfig.text(0.25,.93,\"Movie\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color=color_map[0])\nfig.text(0.33,.93,\"|\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color='black')\nfig.text(0.35,.93,\"Total Contents\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color=color_map[2])\n\nfig.text(.12,-0.1, '''\n* by month, October to January are the months \n  with the highest amount of content added.\n  \n* for the month with the least amount of \n  content added is February.\n''', fontweight=\"light\", fontsize=15)\n\nplt.show()","6e95c6b7":"# select rating data group by movie and tv show\n\ncolumns = ndf['type'].value_counts().index\nindex = ndf['rating'].value_counts().index\n\nrate = pd.DataFrame(index=index)\nfor col in columns:\n  rate[col] = ndf.loc[ndf['type']==col, 'rating'].value_counts()\nrate.fillna(0, inplace=True)\nrate_ratio = rate.divide(rate.sum(axis=1), axis=0)\n\n# set the canvas\n\nfig = plt.figure(figsize=(15,5))\nfig.tight_layout()\n\nax = [None for i in range(2)]\n\nax[0] = plt.subplot2grid((1,15), (0,0), colspan=9)\nax[1] = plt.subplot2grid((1,15), (0,10), colspan=5)\n\n# plot\n\nax[0].barh(rate_ratio.index, rate_ratio.sum(axis=1), height = 0.9, color=color_map[2])\nax[0].barh(rate_ratio.index, rate_ratio['Movie'], height = 0.9, color=color_map[0])\n\n# annotations\n\nfor idx in rate_ratio.index:\n  ax[0].annotate('{:.2f}%'.format(rate_ratio['Movie'][idx]*100),\n              xy=(rate_ratio['Movie'][idx]\/2, idx),\n              va = 'center', ha='center',fontsize=13, \n              fontweight='light', color='#f5f5f1')\n\nfor idx in rate_ratio.index:\n  if rate_ratio['TV Show'][idx] <= 0.16:\n    continue\n  ax[0].annotate('{:.2f}%'.format(rate_ratio['TV Show'][idx]*100),\n              xy=(rate_ratio['Movie'][idx]+(rate_ratio['TV Show'][idx]\/2), idx),\n              va = 'center', ha='center',fontsize=13, \n              fontweight='light', color='#f5f5f1')\n\nax[0].set_xticks([])\n\nax[0].set_yticklabels(rate_ratio.index, fontsize=13)\n\nax[0].margins(x=0, y=0)\nfor s in ['top', 'left', 'right', 'bottom']:\n    ax[0].spines[s].set_visible(False)\n\n# plot number of contents each rating\nax[1].barh(rate.index, rate.sum(axis=1), height = 0.9, \n           color=color_map[1])\n\nax[1].set_xticks(np.arange(0, 3300, 600))\nax[1].set_xticklabels(np.arange(0, 3300, 600), fontsize=13)\n\nax[1].set_yticklabels(rate_ratio.index, fontsize=13)\n\nax[1].set_title('Total content for each rating', fontsize=15, fontweight='light', color=color_map[2])\nax[1].margins(x=0, y=0)\nfor s in ['top', 'left', 'right', 'bottom']:\n    ax[1].spines[s].set_visible(False)\n\n# highlight the top 3 rating with the most content\n\nfig.text(0.46,.9,\"Movie\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color=color_map[0])\nfig.text(0.51,.9,\"|\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color='black')\nfig.text(0.52,.9,\"TV Show\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color=color_map[2])\n\nplt.show()","230e8497":"gc_mv = Counter(','.join(ndf.loc[ndf['type']=='Movie', 'listed_in']).replace(' ,',',').replace(', ',',').split(','))\ngc_mv = pd.Series(dict(gc_mv)).sort_values(ascending=False)\ngc_mv_percent = gc_mv\/ndf['type'].value_counts()['Movie']\n\ngc_tv = Counter(','.join(ndf.loc[ndf['type']=='TV Show', 'listed_in']).replace(' ,',',').replace(', ',',').split(','))\ngc_tv = pd.Series(dict(gc_tv)).sort_values(ascending=False)\ngc_tv_percent = gc_tv\/ndf['type'].value_counts()['TV Show']","1c7c3ca9":"# plot\n\ncolor_map = ['#e50914' for _ in range(10)]\ncolor_map[0] = color_map[1] = color_map[2] =  \"#221f1f\" # color highlight\n\nfig, ax = plt.subplots(1, 1, figsize=(10,5))\nax.barh(gc_mv.head(10).index, gc_mv_percent.head(10)*100,\n       height=0.5, edgecolor='darkgrey', linewidth=0.6, color=color_map)\n\n# annotation\n\nfor idx in gc_mv.head(10).index:\n  val = gc_mv_percent[idx]*100\n  ax.annotate('{:.2f}%'.format(val),\n              xy=(val\/2, idx),\n              va = 'center', ha='center',fontsize=13, \n              fontweight='light', color='#f5f5f1')\n\nplt.yticks(range(10), gc_mv.head(10).index, fontsize=13)\nax.grid(axis='y', linestyle='-', linewidth = 2, alpha=0.25)\n\nplt.xticks(np.arange(0,50,10), fontsize=13)\n\nfor s in ['top', 'right']:\n    ax.spines[s].set_visible(False)\n\nfig.text(.05, 1, 'Top 10 Movie Genre Distribution', fontweight=\"light\", fontsize=22)\nfig.text(.05, .93, 'Top 3 movie genre have been highlighted', fontweight=\"light\", fontsize=15)\n\nfig.text(1, .45, '''\n* 45% of the movies on Netflix are international films.\n\n* Drama and comedy are the other top three genres that \n  have a far greater percentage than the genres below them.\n''', fontweight=\"light\", fontsize=15)\n\n\n    \nplt.show()","2006cb24":"fig, ax = plt.subplots(1, 1, figsize=(10,5))\nax.barh(gc_tv.head(10).index, gc_tv_percent.head(10)*100,\n        height=0.5, edgecolor='darkgrey', linewidth=0.6, color=color_map)\n\n# annotation\n\nfor idx in gc_tv.head(10).index:\n  val = gc_tv_percent[idx]*100\n  ax.annotate('{:.2f}%'.format(val),\n              xy=(val\/2, idx),\n              va = 'center', ha='center',fontsize=13, \n              fontweight='light', color='#f5f5f1')\n\nplt.yticks(range(10), gc_tv.head(10).index, fontsize=13)\nax.grid(axis='y', linestyle='-', linewidth = 2, alpha=0.25)\n\nplt.xticks(np.arange(0,55,10), fontsize=13)\n\nfor s in ['top', 'right']:\n    ax.spines[s].set_visible(False)\n\nfig.text(.05, 1, 'Top 10 TV Show Genre Distribution', fontweight=\"light\", fontsize=22)\nfig.text(.05, .93, 'Top 3 tv show genre have been highlighted', fontweight=\"light\", fontsize=15)\n\nfig.text(1, .45, '''\n* Nearly 50% of the tv shows on Netflix are \n  international tv show.\n\n* Just like movies, Drama and comedy are the \n  other top three genres.\n''', fontweight=\"light\", fontsize=15)    \n    \nplt.show()","5b01beec":"![](https:\/\/assets.brand.microsites.netflix.io\/assets\/f8b5b940-81a4-11e9-bf79-066b49664af6.gif?v=2)","01f83a34":"# Analysis of Movies & TV Shows distribution","93695355":"# Handling data with missing values\n*   replace missing values in country data with the most common country values\n*   keep director and cast columns\n*   drop any missing values from other columns\n\n","3bcddbfa":"## Content added by months","efcc8d91":"# Displays how content was added","027f6a90":"# Convert date columns to datetime format","97bd3020":"## Content added over times","3595564d":"# Top 10 countries with the most amount of content on Netflix","aa5f0d5c":"# Take a look at the rating distribution by Movie & TV Show","78e74dae":"# <center><span style='color:Red;font-size:50px;line-height:20px'> Netflix<\/span><\/center>\n# <center><span style='color:Red'> Data Analysis and Visualization <\/span><\/center>","6df4267f":"# Top10 Genre in Movies and TV Shows"}}