{"cell_type":{"bf45d3da":"code","8f8113a0":"code","30910e64":"code","bfd59e19":"code","926fc12b":"code","78083683":"code","51c0d887":"code","fa19f8d6":"code","2aa4a347":"code","b16ebcef":"code","1b839ad8":"code","b873bb94":"code","f5f7c4a1":"code","e59df2c1":"code","e85eb8dc":"code","d5942d74":"code","e15956ad":"code","1e3775d2":"code","1e8fed21":"code","3366c259":"code","607de416":"code","b766ac87":"code","3dd9906e":"code","c4881eb4":"code","b8183857":"code","048007d7":"code","0943f22e":"code","1bdd3086":"code","8f0b5a80":"code","5352a28a":"code","04b3f025":"code","7be8e6a2":"markdown","9fbf735a":"markdown","0a565348":"markdown","97132307":"markdown","ae06b528":"markdown","d332c9e1":"markdown","b7051ab6":"markdown","6c5f7a9e":"markdown","67c6685a":"markdown","ab11b778":"markdown","4278e5c2":"markdown","92d6c304":"markdown","cf289105":"markdown","372cfced":"markdown","fa1edebc":"markdown","bf6d1d4d":"markdown","9722e02e":"markdown","4e3a8113":"markdown","5b7ca4de":"markdown","bae282db":"markdown","422d6cc5":"markdown","ae2371cc":"markdown","742894c9":"markdown","96205a69":"markdown","36087528":"markdown","5e206594":"markdown","360d26b6":"markdown","386cb995":"markdown"},"source":{"bf45d3da":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","8f8113a0":"%%time\nimport pandas as pd\nimport numpy as np\nfrom pandas.tseries.offsets import BDay\nimport missingno as msno\n# Graphic Libraries:\nimport seaborn as sns\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg\nfrom tabulate import tabulate                                                                                                                                                                                       \nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\n!pip install --upgrade plotly==4.14.3\nimport plotly.express as px\nimport plotly.graph_objects as go\n!pip install folium pandas\nimport folium\n\n# Set Color Palettes for the notebook\ncustom_colors = ['#74a09e','#86c1b2','#98e2c6','#f3c969','#f2a553', '#d96548', '#c14953']\nsns.palplot(sns.color_palette(custom_colors))\n\n# Set Style\nsns.set_style(\"whitegrid\",{\"grid.linestyle\":\"--\"})\nsns.despine(left=True, bottom=True)\nmpl.rcParams['figure.dpi'] = 250\nmpl.rc('axes', labelsize=10)\nplt.rc('xtick',labelsize=10)\nplt.rc('ytick',labelsize=10)\n\n%matplotlib inline\n%config InlineBackend.figure_format = 'svg'","30910e64":"def gini_coefficient(x):\n    \"\"\"Compute Gini coefficient of array of values\"\"\"\n    diffsum = 0\n    for i, xi in enumerate(x[:-1], 1):\n        diffsum += np.sum(np.abs(xi - x[i:]))\n    return diffsum \/ (len(x)**2 * np.mean(x))\n\ndef G(v):\n    bins = np.linspace(0., 100., 11)\n    total = float(np.sum(v))\n    yvals = []\n    for b in bins:\n        bin_vals = v[v <= np.percentile(v, b)]\n        bin_fraction = (np.sum(bin_vals) \/ total) * 100.0\n        yvals.append(bin_fraction)\n    # perfect equality area\n    pe_area = np.trapz(bins, x=bins)\n    # lorenz area\n    lorenz_area = np.trapz(yvals, x=bins)\n    gini_val = (pe_area - lorenz_area) \/ float(pe_area)\n    return bins, yvals, gini_val\n\ndef Age(age):\n    if age >= 90 : return '90 years old'\n    if age >= 80 : return '80 years old'\n    if age >= 70 : return '70 years old'\n    if age >= 60 : return '60 years old'\n    if age >= 50 : return '50 years old'\n    if age >= 40 : return '40 years old'\n    if age >= 30 : return '30 years old'\n    if age >= 20 : return '20 years old'\n    else: return 'Teenager'","bfd59e19":"data =  pd.read_csv('\/kaggle\/input\/forbes-billionaires-2021-30\/forbes_billionaires_geo.csv')\ndata.head(6)","926fc12b":"fig, ax = plt.subplots(2,2,figsize=(12,7))\naxs = np.ravel(ax)\nmsno.matrix(data,  fontsize=9, color=(0.25,0,0.5),ax=axs[0]);\nmsno.bar(data, fontsize=8, color=(0.25,0,0.5), ax=axs[1]);\nmsno.heatmap(data,fontsize=8,ax=axs[2]);\nmsno.dendrogram(data,fontsize=8,ax=axs[3], orientation='top')\n\nfig.suptitle('Missing Values Analysis', y=1.01, fontsize=15);\n#plt.tight_layout()","78083683":"data.head(6)","51c0d887":"data =  pd.read_csv('\/kaggle\/input\/forbes-billionaires-modified\/forbes_billionaires_geo_3.csv')\ndata.head(6)","fa19f8d6":"data['Longitude'] = data['geometry'].apply(lambda x: float(x.split()[2].replace(')',''))+np.random.normal()\/20)\ndata['Latitude'] = data['geometry'].apply(lambda x: float(x.split()[1].replace('(',''))+np.random.normal()\/20)\ndata['Weight'] = data['NetWorth']\/data['NetWorth'].max()","2aa4a347":"data_children = data.groupby(['Children']).agg({'Name':'count'}).reset_index()\n\nfig, ax = plt.subplots(figsize=(12,6))\n\nax = sns.barplot(x=\"Children\", y=\"Name\", data=data_children,palette = 'viridis')\nax.set_title('Number of Children: Distribution', fontsize=15);\nax.axvline(x=data.Children.median()-1, ymin=0, ymax=550, color='red', linestyle='--', label='Median')\n\nax.legend(fontsize=15);","b16ebcef":"data[data['Children']==23]","1b839ad8":"data[data['Age']==data['Age'].min()]","b873bb94":"data_children_na = data[data['Children'].isna()==True]\ndata_children_na.groupby('Country')['Name'].agg('count').sort_values(ascending=False)[:10]","f5f7c4a1":"data.fillna(value=np.nan, inplace=True)\ndata[['Age','Children']] = data[['Age','Children']].astype('Int64')\n\n## group data by country on total net worth and count of billionaire\ncountry_grp=data.groupby(by='Country').agg({'Name':'count','NetWorth':'sum'}).reset_index()\n\n## group data by country on total net worth and count of billionaire\ncountry_grp_median=data.groupby(by='Country').agg({'Name':'count','NetWorth':'median'}).reset_index()\ncountry_grp_median.rename({'Name':'Tot Billionares','NetWorth':'Median Net Worth'},axis=1,inplace=True)\ncountry_grp_median.sort_values(by='Median Net Worth',ascending=False,inplace=True)\n\ncountry_grp.rename({'Name':'Tot Billionares','NetWorth':'Aggregate Net Worth'},axis=1,inplace=True)\ncountry_grp['% Total Billionares']=round(country_grp['Tot Billionares']\/sum(country_grp['Tot Billionares'])*100,2)\ncountry_grp['% Total Wealth'] =round(country_grp['Aggregate Net Worth']\/sum(country_grp['Aggregate Net Worth'])*100,2)\ncountry_grp_tot_bil = country_grp.sort_values(by='Tot Billionares',ascending=False,inplace=False)\ncountry_grp.sort_values(by='Aggregate Net Worth',ascending=False,inplace=True)\ncountry_grp.reset_index(drop=True,inplace=True)\ncountry_grp['Aggregate Net Worth']=round(country_grp['Aggregate Net Worth'],2)\n\ncountry_grp.head(10)","e59df2c1":"colors = ['lightslategray',] * 20\ncolors[0] = 'royalblue'\ncolors[1] = 'crimson'\n\nfig, ax = plt.subplots(2,2,figsize=(10,9))\n\naxs=np.ravel(ax)\n\naxs[0].bar(x=country_grp_tot_bil['Country'][:20],height=country_grp_tot_bil['Tot Billionares'][:20],color=colors);\naxs[0].tick_params(axis='x', labelrotation=90)\naxs[0].set_title('Tot. Billionares', fontsize=9)\naxs[1].bar(x=country_grp['Country'][:20],height=country_grp['% Total Wealth'][:20],color=colors);\naxs[1].tick_params(axis='x', labelrotation=90)\naxs[1].set_title('% of Billionares Tot. Wealth', fontsize=9)\naxs[2].scatter(x=country_grp['% Total Billionares'][:20],y=country_grp['% Total Wealth'][:20],color=colors,s=country_grp['Aggregate Net Worth'][:20]\/2, alpha=0.7);\naxs[2].plot([0,35],[0,35], color='salmon', linestyle='--')\naxs[2].set_xlabel(\"% of Billionares\")\naxs[2].set_ylabel(\"% of Wealth\")\naxs[2].set_title('% of Billionares vs. % of Wealth', fontsize=9)\naxs[3].bar(x=country_grp_median['Country'][:20],height=country_grp_median['Median Net Worth'][:20],color='lightslategray');\naxs[3].tick_params(axis='x', labelrotation=90)\naxs[3].set_title('Median Wealth',  fontsize=9)\n\nfig.suptitle('Billionares: Where and How many', y=1.02, fontsize=12)\nplt.tight_layout()","e85eb8dc":"# Groupby by city:\ncity_df = data.groupby(by='Residence').agg({'Name':'count','NetWorth':'sum'}).reset_index()\ncity_df['City'] =city_df['Residence'].apply(lambda x: x.split(', ')[0])\ncity_df.drop('Residence', inplace=True, axis=1)\n\n# Create color series\ncustom_colors_1 = ['#ed2132','#3844f2','#d4d5d9','salmon','#ed2132','#ed2132','#d4d5d9','#d4d5d9','#ed2132','#3844f2','#d4d5d9','#ed2132','#d4d5d9','#d4d5d9','#d4d5d9']\nsns.palplot(sns.color_palette(custom_colors_1));\n\ncustom_colors_2 = ['#3844f2','#ed2132','#d4d5d9','#ed2132','salmon','#d4d5d9','#d4d5d9','#ed2132','#d4d5d9','#ed2132','#3844f2','#3844f2','#3844f2','#3844f2','#d4d5d9']\nsns.palplot(sns.color_palette(custom_colors_2));\n\nfig, axs = plt.subplots(1,2,figsize=(12,6))\ncity_df.sort_values(by='Name',ascending=False,inplace=True)\nsns.barplot(x='City',y='Name',data = city_df.iloc[:15,:], palette =custom_colors_1, ax=axs[0]);\naxs[0].tick_params(axis='x', labelrotation=90, labelsize=7)\naxs[0].tick_params(axis='y', labelsize=7)\naxs[0].set_title('Number of Billionares', fontsize=10)\n\ncity_df.sort_values(by='NetWorth',ascending=False,inplace=True)\nsns.barplot(x='City',y='NetWorth',data = city_df.iloc[:15,:],palette=custom_colors_2, ax=axs[1]);\naxs[1].tick_params(axis='x', labelsize=7, labelrotation=90)\naxs[1].tick_params(axis='y', labelsize=7)\naxs[1].set_title('Total Whealt',fontsize=10)\nplt.suptitle('Billioners and Wealth by Cities', fontsize=12, y=1.05)\n\nplt.tight_layout()","d5942d74":"# Prepare the relevant data:\nlist_coord = data[['Longitude','Latitude']].values\nlist_coord_weight = data[['Longitude','Latitude','Weight']].values\n\nimport plotly.express as px\nfig = px.density_mapbox(data, lat='Longitude', lon='Latitude',radius=10,\n                        center=dict(lat=20, lon=7), zoom=1.5,  hover_name='Name',\n                        mapbox_style=\"carto-positron\",color_continuous_scale='sunset', width=1550, height=1000, ) #, z='NetWorth'\n\nfig.show()","e15956ad":"# Extract the Chinese Billionaires Data:\ntarget = 'China'\nChina_bill_df = data.query('Country == @target')\nlist_coord_China = China_bill_df[['Name','NetWorth','Longitude','Latitude']].values\n\n# Plot with Plotly:\nimport plotly.express as px\n\nfig = px.scatter_mapbox(China_bill_df, lat=\"Longitude\", lon=\"Latitude\", color=\"NetWorth\", size=\"NetWorth\",\n                  color_continuous_scale=px.colors.sequential.Sunsetdark_r, size_max=25, zoom=3.7, hover_name='Name',\n                  mapbox_style=\"open-street-map\", width=1500,height=800, opacity=0.7, range_color=[1,180], center={'lat':34.56462451406082, 'lon':105.70152050931392})\nfig.show()","1e3775d2":"China_bill_df.head(5)","1e8fed21":"# Extract the US Billionaires Data:\ntarget = 'United States'\nUS_bill_df = data.query('Country == @target')\nlist_coord_US = US_bill_df[['Name','NetWorth','Longitude','Latitude']].values\n\n# Plot with plotly\nfig = px.scatter_mapbox(US_bill_df, lat=\"Longitude\", lon=\"Latitude\", color=\"NetWorth\", size=\"NetWorth\",\n                  color_continuous_scale=px.colors.sequential.Sunsetdark_r, size_max=50, zoom=3.2, hover_name='Name',\n                  mapbox_style=\"open-street-map\", width=1500,height=800, opacity=0.7, range_color=[1,180], center={'lon':-115.0,'lat':35.0})\nfig.show()","3366c259":"US_bill_df.head(5)","607de416":"import pandas_datareader as pdr\ngdp_china = pdr.get_data_fred('MKTGDPCNA646NWDB', freq='q',start = '01\/01\/2010', end='31\/03\/2021')\/1_000_000_000\ngdp_us = pdr.get_data_fred('GDP', freq='q',start = '01\/01\/2010', end='31\/03\/2021')\n\nnew_df = data.groupby(['Country']).agg({'NetWorth':'sum'})\n\nnew_df.sort_values(by='NetWorth',ascending=False,inplace=True)\nnew_df = new_df.iloc[:2,:]\n# Create tow new columns to accomodate the values\nnew_df['Share of GDP'] = np.nan\nnew_df['Gini'] = np.nan\n# Create the total whealth to GDP and Gini valueas \nnew_df.loc['United States','Share of GDP'] = new_df.loc['United States','NetWorth']\/gdp_us['GDP'][-1]\nnew_df.loc['China','Share of GDP'] = new_df.loc['United States','NetWorth']\/gdp_china['MKTGDPCNA646NWDB'][-1]\n\ntarget='China'\nchina_bills = data.query('Country==@target')['NetWorth'].values\ntarget='United States'\nus_bills = data.query('Country==@target')['NetWorth'].values","b766ac87":"bins, result, us_gini_val = G(us_bills)\nplt.figure(figsize=(12,6))\nplt.subplot(2, 1, 1)\nplt.plot(bins, result, label=\"observed\")\nplt.plot(bins, bins, '--', label=\"perfect eq.\")\nplt.xlabel(\"fraction of population\")\nplt.ylabel(\"fraction of wealth\")\nplt.title(\"US Billionaires GINI: %.4f\" %(us_gini_val), fontsize=18)\nplt.legend()\nplt.subplot(2, 1, 2)\nplt.hist(us_bills, bins=20)\nplt.xlabel(\"Total Wealth\")\nplt.ylabel(\"Number of Billionaires\")\nplt.tight_layout()\n\nplt.savefig('US_Gini.png', bbox_inches='tight')","3dd9906e":"bins, result, china_gini_val = G(china_bills)\nplt.figure(figsize=(12,6))\nplt.subplot(2, 1, 1)\nplt.plot(bins, result, label=\"observed\")\nplt.plot(bins, bins, '--', label=\"perfect eq.\")\nplt.xlabel(\"fraction of population\")\nplt.ylabel(\"fraction of wealth\")\nplt.title(\"China Billionaires GINI: %.4f\" %(china_gini_val), fontsize=18)\nplt.legend()\nplt.subplot(2, 1, 2)\nplt.hist(china_bills, bins=20)\nplt.xlabel(\"Total Wealth\")\nplt.ylabel(\"Number of Billionaires\")\nplt.tight_layout()\n\nplt.savefig('CH_Gini.png', bbox_inches='tight')","c4881eb4":"new_df.loc['United States','Gini'] = us_gini_val.round(3)\nnew_df.loc['China','Gini'] = china_gini_val.round(3)\n\nnew_df.round(3)","b8183857":"df_CONT = px.data.gapminder().query(\"year == 2007\")\ndict_cont = dict(df_CONT[['country','continent']].values)\ncountry_grp_median['Continent'] = country_grp_median['Country'].map(dict_cont)\n\n# Verify for missing values and replace:\nlist_missing_cont = list(country_grp_median[country_grp_median['Continent'].isna()==True]['Country'])\nnew_map = ['Europe','Africa','Europe','Asia','Europe','Asia','Asia','Europe','Asia','Europe','Europe','Europe','Asia','Europe','Asia','Europe','Europe']\nnew_dict_cont = dict(zip(list_missing_cont,new_map))\n\n# Create and aggregate dictionary\nz = {**dict_cont, **new_dict_cont}\n\ncountry_grp_median['Continent'] = country_grp_median['Country'].map(z)","048007d7":"data_age_clean = data.dropna(subset=['Age'])\n\ndata_age_clean['age_group'] = data_age_clean.apply(lambda x: Age(x[\"Age\"]), axis = 1)\n\n## Map the Continent\ndata_age_clean['Continent'] = data_age_clean['Country'].map(z)\n\n# Group dataset:\ndata_age_clean_grouped_sum=data_age_clean.groupby(by=['Country','Continent','age_group']).agg({'Name':'count','NetWorth':'sum'}).reset_index()\ndata_age_clean_grouped_sum.rename({'Name':'Tot Billionares','NetWorth':'Total Net Worth'},axis=1,inplace=True)\n\n#Tree map representing most number of Billionaires\nax= px.treemap(data_age_clean_grouped_sum,path=[\"Continent\",'Country','age_group'],width=1550, height=1100,values='Total Net Worth',color='Total Net Worth',title='Billionares: Wealth and Age',color_continuous_scale='RdBu',)\nax.show()","0943f22e":"df_age = data.dropna(subset=['Age'])\n# Define Age Group feature\ndf_age['age_group'] = df_age['Age'].apply(lambda x: Age(x))\n# Create a sub-dataframe with US Data\ntarget = 'United States'\ndf_age_US = df_age.query('Citizenship==@target')\n# Create a sub-dataframe with Chinese Data\ntarget = 'China'\ndf_age_CH = df_age.query('Citizenship==@target')\n# Show the shape of the two datasets:\nprint('US data lenght: {}'.format(df_age_US.shape[0]))\nprint('China data lenght: {}'.format(df_age_CH.shape[0]))","1bdd3086":"bins = list(range(15,110,5))\n\nfig = plt.figure(constrained_layout=False, figsize=(20,10))\n\ngs1 = fig.add_gridspec(nrows=4, ncols=4, left=0.05, right=0.48, wspace=0.5, hspace=0.5)\n\nf8_ax1 = fig.add_subplot(gs1[:2, :])\nsns.histplot(data=df_age, x='Age',stat= 'count',hue ='Self_made',bins=bins, palette=['indianred','steelblue'],multiple='stack', element='bars', ax=f8_ax1);\nf8_ax1.set_title('Worldwide Billionaires Distribution by Age: Self-Made vs Not Self-Made', fontsize=15)\nf8_ax1.tick_params(axis='x', labelsize=10)\nf8_ax1.tick_params(axis='y', labelsize=10)\n\nf8_ax2 = fig.add_subplot(gs1[2:, :2])\nsns.histplot(data=df_age_US, x='Age',stat= 'count',hue ='Self_made',bins=bins, palette=['indianred','steelblue'],multiple='stack', element='bars', ax=f8_ax2);\nf8_ax2.set_title('United States', fontsize=12)\nf8_ax2.tick_params(axis='x', labelsize=10)\nf8_ax2.tick_params(axis='y', labelsize=10)\n\nf8_ax3 = fig.add_subplot(gs1[2:, 2:])\nsns.histplot(data=df_age_CH, x='Age',stat= 'count',hue ='Self_made',bins=bins, palette=['indianred','steelblue'],multiple='stack', element='bars', ax=f8_ax3);\nf8_ax3.set_title('China', fontsize=12)\nf8_ax3.tick_params(axis='x', labelsize=10)\nf8_ax3.tick_params(axis='y', labelsize=10)\n\nplt.tight_layout()","8f0b5a80":"data_age_clean_ch = data_age_clean.query('Country==\"China\"&Self_made==True') \n\ndata_age_clean_ch_grouped_sum=data_age_clean_ch.groupby(by=['age_group','Source']).agg({'Name':'count','NetWorth':'sum'}).reset_index()\ndata_age_clean_ch_grouped_sum.rename({'Name':'Tot Billionares','NetWorth':'Total Net Worth'},axis=1,inplace=True)\n\n#Tree map representing most number of Billionaires\nax= px.treemap(data_age_clean_ch_grouped_sum,path=[\"age_group\",'Source'],width=1500, height=1100,values='Tot Billionares',color='Total Net Worth',title='First Generation Billionaires in China: Treemap Representation by Age and Source',color_continuous_scale='RdBu')\nax.show()","5352a28a":"df_age_US_agg=df_age_US.query('Self_made==True').groupby(['age_group','Source'])['Name','NetWorth'].agg(Count_Names=('Name','count'),Total_whealth=('NetWorth','sum')).sort_values(by='Count_Names',ascending=False).reset_index()\ndf_age_US_agg.sample(5)","04b3f025":"#Tree map representing most number of Billionaires\nax= px.treemap(df_age_US_agg,path=[\"age_group\",'Source'],width=1500, height=1100,values='Count_Names',color='Total_whealth',title='First Generation Billionaires in the USA: Treemap Representation by Age and Source',color_continuous_scale='RdBu',)\nax.show()","7be8e6a2":"As for the names behind the dots, the 5 richest persons of the country (and the world) are reported in the next table. All these names and their businesses are very popular. Therefore I will provide them with no comments.","9fbf735a":"The billionaires' median number of children is three, with the average only slightly lower, 2.98. The most frequent number of children is two, opted in 533 out of 1'552 cases, followed by 3, 440 cases, and 4, 227 cases. It is interesting to note that none of the billionaires for which the data are available reports zero children.  This consideration suggests that the frequent \"N\/A\" record for this feature is a mixed bag of genuinely missing values and zeros. For instance, for the youngest billionaire, Kevin David Lehmann, 18yo, the dataset reports\"NA\" under the number of children, but realistically it is a zero. At the other end of the range, a billionaire has 23 children. After filtering the dataset, it turns out that this large family belongs to Roman Avdeev, a 53 yo Russian billionaire. According to the Wikipedia webpage dedicated to him ([link](https:\/\/medium.com\/r\/?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FRoman_Avdeev)), he is an active philanthropist supporting orphans, and 19 of his 23 children are adopted.","0a565348":"Although the two maps presented show that from a geographic standpoint, wealth is more uniformly distributed in the United States than in the PRC, they also seem to suggest that the opposite applies in terms of the concentration of wealth itself. In the USA, the presence of some huge dots among many tiny little ones indicates that few people have a bigger share of the total wealth than in China. Here the small dots are as common as in the United States, but no dot stands immediately out for its size. This intuition is confirmed by the Gini Coefficient calculated on the wealth distribution in China (0.50) and the United States (0.56). The next two graphs provided a representation of the wealth distribution among the billionaires' population.","97132307":"Moving down from the top, there are more familiar names related to the internet and e-commerce, such as Ma Huateng (Tencent), Colin Zheng Huang (Pinduoduo), and Jack Ma (Alibaba). Finally, at the fifth place, there is Wang Wei, owner of the delivery service and logistics company \"SF Express\".\n\n\nMoving to the other side of the Pacific Ocean, in the United States, two things strike the observer at first sight. First, the dots are significantly bigger and brighter (meaning richer billionaires), and they are more evenly distributed across the country. Although some areas are whiter than others, it is hard to identify some billionaire-free regions. Second, there are probably six main clusters in the country: the north and south (or California) Pacific clusters, the central cluster, one around the Great Lakes area, another in the North-East and eventually one located in Florida.","ae06b528":"Key libraries are imported or installed:","d332c9e1":"### 3. **Billionaires: Where to find\u00a0them**\nThis article and the analysis aim to provide an in-depth representation of how billionaires and their wealth are distributed across countries and how their economic power is distributed among themselves and according to geography, age, and source. Particular attention is dedicated to comparing these metrics between the two world economic powerhouses: the United States of America and China.\n3.1 Where are they? How much they have?\nWhen measured by the sheer number of total billionaires, the United States and China dwarf the rest of the world. Alone they totalize about 49% of the people in the dataset and more than 50% of the total wealth. The United States still have a hedge in comparison to the runner-up. There are 724 billionaires in the USA against the 626 from China.","b7051ab6":"For instance, Bill Gates' source of wealth is recorded as \"Microsoft\", while for Larry Ellison (founder of Oracle), the dataset mentions a generic \"software\". Jeff Bezos's source is Amazon, but e-commerce is the provenience of Jack Ma's wealth. This approach creates series of difficulties when aggregating the data. When billionaires are grouped by the \"Source\" as it appears in the original dataset, billionaires like Jeff Bezos or Jack Ma would be classified in two different buckets. However, they both operate in the e-commerce business.\u00a0\n\nTherefore, the dataset was reviewed to standardize the \"Source\" entries. As a result, taking the first six wealthiest people in the world as an example, Amazon becomes e-commerce, Tesla is replaced by \"electric vehicles\", LVMH by \"luxury good\", Microsoft by \"software\", Facebook by \"social media\" and Berkshire Hathaway by \"finance\".\n\nThis operation has been implemented in \"Forbes-Billionaires-modified\" dataset, [Link](https:\/\/www.kaggle.com\/fabrizio78\/forbes-billionaires-modified)\n\nThe new dataset is now uploaded:","6c5f7a9e":"Moving to the USA, the first feature catching the observer's attention is the number of billionaires that own their fortune to activities related to the financial sector. The Forbes dataset differentiates the financial sector in many sub-categories such as investment, private equity,  hedge funds, money management, venture capital, finance, and several more. Together, these sectors have churned out the greatest number of billionaires in each age group, save among those in their 90s. However, in this case, I suspect that the difference is mostly due to a survival bias. On the contrary to what happened in China, the real estate sector played only a marginal role in creating new billionaires, save the cohort of the 80yo. In the USA, the shockwaves of the emerging new economy in the billionaires' composition starts to propagate only in the age groups younger than 80yo. The software sector, for instance, is an important creator of new billionaires among the 70s and in all the age groups until the 40yo group. It generated the highest accumulation of wealth among the billionaires in their 60s and 70s. As we move down the age groups, new sectors appear, such as e-commerce, cybersecurity,  social networks, online services and so forth. As in China, when the younger group are analyzed, new sources of wealth appear, and they are connected with the most recent economic development. Cryptocurrencies are an important billionaires incubator in the 40yo and 30yo age groups. Billionaires that created smartphone applications are specific to the age groups going from the 30s to the 20s. Forbes dataset is not particularly helpful to identify this group since it classifies phone apps in details, differentiating among application for dating, sport, trading, food delivery and so forth. On the contrary to the Chinese case, the USA manage to have a small group of billionaires in the 20yo group, with food delivery applications and sensor technologies as the source for their wealth. Despite the higher growth rate recorded in China, the USA still appears like the place where it is possible to get rich faster, as proved by the higher number of billionaires in their 30s and 20s.\n\n### **Conclusions**\n\nIn this article, we took a deep dive into the Forbes dataset of the richest men on the hearth. First, a general overview of the dataset with its features and shortcoming has been provided. After a quick foray into the relationship between the number of children and wealth, billionaires' geographic distribution has been analyzed according to different dimension and clusters identified. Then China and the USA, the two main clusters, have been studied in greater details.  Again the geographic distribution within these countries as well as the wealth distribution among billionaires. After restricting the focus on the self-made billionaires, the relationship between Age and Origin of Wealth has been studied in details in both countries. Critical features within each of these two countries have been highlighted and studied along with their evolution in time according to the source of wealth.","67c6685a":"### 1.2 Source of Wealth: Inconsistent Records\nThe feature \"Source\" aims at capturing the main origin of the billionaires' accumulated wealth. However, Forbes had adopted an inconsistent approach in collecting these data. When the source of wealth is connected with a popular or well-known company, then the Company name is reported (i.e. Amazon, Microsoft, Google and so forth). In other instances, the economic sector where the billionaire business operates is reported (i.e., software, machinery, food and beverage, and so forth).","ab11b778":"The gap is wider when the total wealth of these individuals is considered. In the United States, the billionaires piled up an aggregate wealth of $4'398.4billions against the $2'532bilions in China. Thus, the average billionaire in the United States is richer than his counterpart in China. This is highlighted by the left graph on the right, which compares the share (in percentage) of billionaires of each country against the share of the total wealth of this group. However, neither the United States nor China appears in the top 20 positions in terms of billionaires' median wealth. Here the ranking is dominated by European, African and Central Asian countries (see the bottom-right graph above ).\n\nA similar analysis can be performed, replacing the countries with the city where the billionaires live.","4278e5c2":"Name, NetWorth, Country, Source, Rank, and Geometry show no missing values in their series, while Age, Residence, Citizenship, and Self-Made are almost complete. The remaining three series, Education, Children and Status, have significant gaps in their records. In general, the missing values have a low correlation among themselves, save four exceptions. For example, the missing values in Self-Made are almost coincident with those in Citizenship. At the same time, there is a mild positive correlation between the missing values in Residence vs Self-Made, Residence vs Citizenship, and Status vs Children.\u00a0\n\nThe significant amounts of missing values in Status, Children, and Education make these features poor candidates for obtaining an accurate understanding of the money-elites.","92d6c304":"When analyzing the Chinese billionaires three map representation, two main elements emerge. The first is the unbalanced dominance of the age group of billionaires in their 50s. In China, this group alone represents about 50% of all the wealth accumulated by billionaires, and it is the richest age group worldwide by far. The second feature emerging is related to the dramatic shift in the sectors from which the billionaires derived their fortunes between the age groups in their 40s and 30s and those above. Economic activities related to real estate and pharmaceutical generated the greatest number of billionaires and concentration of wealth in all the age cohorts above the 40yo. In general, in these groups, the economic sector landscape is related to the old economy and manufacturing activities such as food&beverages, chemicals, automobile, apparel and so forth. However, as we enter into the 40yo cohort, the picture changes. This age group is made up of persons who were in their 20s at the turn of the century when the Internet took off and spread worldwide. This economic revolution is fully represented here. True, real estate and pharmaceutical are still on the list. However, they definitely moved to a secondary role. Internet-related services took the lead as billionaires churning out sectors. E-commerce billionaires in their 40s show the greatest concentration of wealth among all the age\/sectors combinations. Other relevant sectors are Online Games, Software and Internet Media. The economic revolution is then definitely confirmed by the sector compositions of the next age cohort, the billionaires in their 30s. Here all the traditional economic sectors have disappeared. Moreover, new emerging forces shaping the economy can be identified. They are connected to the spreading application of Artificial Intelligence (AI) and new forms of mobility.  As a result, along with sectors as video streaming, e-commerce and social networks, new fortunes are now created in electric vehicles and health IT businesses. For instance, in a ranking dominated by man, the latter is represented by Gong Yingying, Founder and Chairwoman of Yidu Tech, a leading medical big data and AI company in China and worldwide.","cf289105":"## **BILLIONAIRES, WHO, WHERE, WHEN, and MORE**\n#### **What the Forbes Billionaire Dataset can tell us about them.**\n\nArticle on Medium.com based on this Notebook: [Link](https:\/\/fabrbasso.medium.com\/billionaires-who-where-when-and-more-ab29e414d040)\n\nEvery year Forbes releases a ranking of the wealthiest people on the planet. Besides the long list of rich people beyond imagination, the dataset includes a wide variety of relevant information, such as net wealth, residence, citizenship, age, source of wealth, marital status and education. This article aims to extrapolate some relevant insights from the mass of data and analyse how billionaires are distributed according to different metrics. Particular attention is dedicated to the comparison between the super-rich in the United States and China.","372cfced":"An additional metric to better appreciate the wealth accumulated by the ultra-rich persons is to measure it against the annual GDP produced in these two countries. Just to be clear: this comparison is intrinsically wrong since it compares a flow (GDP) against a stock (wealth). However, it is interesting to analyze how long these entire communities have to work to reproduce the total wealth owned by this little bunch of individual. By using the GDP data at the end of Q1\u20132021, the ratios are reported in the table below:","fa1edebc":"However, this analysis overlooks one important difference between the two countries. China liberalized its economy only in 1978 when it started its breakneck development. Therefore, also the process of private wealth accumulation has started only from that time on. Even those in their 40s at that point in time, nowadays they should still be alive. This consideration is important to read the next graphs from a proper perspective.","bf6d1d4d":"To avoid the precise overlapping of all the billionaires living in the same city, their locations are artificially scattered around by adding a small noise to the original coordinates. At the end of the process, the dataset comprises 14 features (the original \"geometry\" is dropped as redundant).","9722e02e":"### 1.1 The Dataset: Missing\u00a0Values\n\nThe first important step is to assess the extension of the missing values in the Dataset. The four graphs presented here provide a clear insight into the existing gaps in the data and the pattern among them.","4e3a8113":"---\n### Before we\u00a0Start\n\nHow much is a billion US Dollars? To have an idea, if tomorrow you start spending 10'000Usd a day (every given day), it will take 274 years before you consume the entire capital. This stands correct, assuming that the cash is not invested or earning any interest. If a 1% interest is factored in, the consuming binge can go on forever. Forever.\n\n---\n\n### **1. Import the Dataset**:\n\nFirst, the original dataset is imported:","5b7ca4de":"From the map, three main clusters can be identified:\n* The **US Cluster**, running from the east coast to the Hawaiian archipelago (the bright dot in the middle of the Pacific Ocean). It also encompasses the southern tip of Canada, thanks to the contributions of Ottawa and Toronto.\u00a0\n* The **European Cluster**, covering an area that goes from the south of Spain to Stockholm and from the North of Italy to the British Islands.\n* The third main cluster is concentrated in the **Far East**, hinging around the eastern part of China and including other countries such as South Korea and Japan.\n\nIn addition to these three key clusters, several secondary clusters can be identified, such as the Indian or the South America cluster (coastal area between the south of Brazil and north of Argentina).\n\n### 4. **The Clash of Titans: the USA vs\u00a0China**\n### 4.1 Geography\nAs already highlighted, the United States and China together represent the lion share in the total number of billionaires. Therefore, it is natural to make a direct comparison between the two heavyweights in their category. As a first step, the billionaires of the two countries are plotted on a map. The dots represent their locations, and the dots' sizes their wealth. As noted above, Chinese billionaires are slightly poorer if compared to their US counterparts. This aspect is confirmed by the visually smaller sizes of the dots on the Chinese map. Moreover, the rolling-in-money persons are mostly concentrated in the east part of the country, close to the coast in the area, in an arch stretching from Beijing in the North to Hong Kong in the South. The dots then become more and more sporadic as we move west or north.","bae282db":"Before moving to the next paragraph, I want to investigate the significant amount of missing values in the \"children\". When grouped by countries, it turns out that the bulk of the gaps in the records belongs to billionaires with Chinese citizenship, 545 cases out of 1'223 missing values.","422d6cc5":"In terms of cities and the number of billionaires living within, Chinese ultra-rich people cluster together in a number of few cities. Beijing took over the role of the city with the highest number of billionaires, and China accounts for 5 (6 if Hong Kong is included) out of the 15 cities with the highest concentration of nabobs. The United States are in this ranking with only two names, New York and San Francisco. The picture is more even when the total wealth held by billionaires is considered. Reflecting the fact that US billionaires are on average richer, New York is still the city with the highest concentration of wealth while Beijing is now the runner-up. Within the first 15 positions, 5 cities are located in the USA and 4 (5 with HK) in China. \u00a0\n\nBefore looking into the details of the two biggest economies, the worldwide distribution of billionaires is analyzed. This is rendered by a heatmap on the top of a world map in the following graph:","ae2371cc":"### 1.3 Geometry: Latitude and Longitude unpacking\nTwo variables describe Billionaires current location: Residence and Geometry. The \"Residence\" comes with 40 missing values, while \"Geometry\" seems to have no gaps. However, this interpretation is misleading since when an exact location is not available, \"geometry\" reports the mid-point of the Country. Despite that, the \"Geometry\" series is the easiest to use for data analysis.\u00a0\nThe information is stored in the format \"POINT(Latitude Longitude)\", with the two numbers separated by a space.  Therefore, two additional features, Longitude and Latitude, are created by unpacking this information out from \"Geometry\" using the following lines of code:","742894c9":"The Forbes' Dataset comprises 2750 people whose net wealth equals to or exceeds one billion US Dollars. In addition, when available, a set of additional information is provided, including:\u00a0\n\n* Net Wealth: expressed in USD;\n* Country of Origin;\u00a0\n* Source: main source from which the wealth is originated;\n* Rank: Position in terms of wealth;\n* Age,\n* Residence;\n* Citizenship;\u00a0\n* Marital Status;\n* Children: Number of Children;\n* Education: Attended University and major;\n* Self-Made (True\/False) origin of wealth;\n* Geometry: Coordinate of current residence.\n\n","96205a69":"Additionally, within the high concentration area, three main clusters are located around Beijing, Shanghai, and the Pearl River Delta Area. The map can be navigated by zooming in and out, and by clicking on the dots, the details of the corresponding billionaire pop out.\u00a0\n\nLooking at the five richest persons in China, at the top, there is Zhong Shanshan (Usd68.9B). His name might not be very familiar outside China. Still, if you ever visited the country, you should also have noticed the white-red labelled bottle of water sold anywhere, which are the backbone of his beverage industry empire (and the water is actually good).","36087528":"### 2. **First Analysis: Some\u00a0Gossip**\nBefore analyzing more serious topics, I tackle the billionaires' dataset from a more frivolous perspective: how many children. This feature is not particularly relevant, considering that it covers approximately only 56% of the dataset. Nevertheless, since I know first-hand how hard it is to reconcile parenting and work, I am quite interested in the topic. A simple histogram provides immediate visualization of the distribution in the number of children:","5e206594":"In the histograms above, the billionaires belonging to each of the age's cohorts are also identified as Self Made or not. In the United States, there is always a significant portion of persons who have inherited their fortune in each age group. In the age bins from 55yo to 95yo, wealthy people by inheritance represents about 30% of each group. In China, on the contrary, for the reason explained above, almost all the billionaires belong to the first generation\/self-made group. To prevent the analysis from being affected by this difference in the two subsets, only self-made billionaires in both countries are considered. Unfortunately, a comparison between \"second-generation\" billionaires is impossible since this group is too small in China.\u00a0\n\nBased on these considerations, the following graphs analyse the distribution of wealth according to age and source, first in China and then in the USA. In the graphs, each square represents an economic sector, with the colour depending on the amount of wealth accumulated, while the size is determined by the total number of Billionaires.","360d26b6":"Although relatively poorer, the ratios tell that Chinese billionaires command a higher share (31%) of wealth compared to the annual total incomes produced by their country, about 50% higher than in the United States (20%).\n\n### **4.2 Age and Origin of Wealth**\n\nThe next aspect studied in this comparison between the two economic superpowers is the distribution of wealth in terms of age and its relationship with the main source from which it was originated. This analysis can provide some important insight into how the economies have evolved over time and the forces shaping their developments. History shows us that the waves of rising and declining sectors and industries have witnessed the creation of new fortunes and rising stars in the constellation of the wealthy elites. Moreover, money is a source of power since the dawn of times. By understanding where this power is concentrated from the age and economic standpoints, we can better comprehend how this power is wielded.\n\nThe first graph proposed aggregates the wealth within each country according to the age cohort. A first important piece of information emerges: the Chinese billionaires in their fifties are the richest group worldwide. Alone they represent about 50% of the total billionaires' wealth of their country, or 1.15 trillion of USD, and outstrip the runner-up group, US billionaires in the 70yo cohort, by a whooping 100billion, or 10% more. And this happens even though the US group came from a larger economy and the billionaire's pool of wealth is 80% bigger.","386cb995":"Considering that Chinese billionaires in the dataset are 626, it means that 87% of the data are missing for this specific group. Therefore, the statistics presented so far on the number of children are not representative of this subset. Forbes provides no clear reason for this concentration of missing values in a single country. As a general consideration, since the one-child policy lasted for about 4 decades, the number of children can be a sensitive topic even for billionaires in China."}}