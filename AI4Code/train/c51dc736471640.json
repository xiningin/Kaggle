{"cell_type":{"91c15334":"code","bf408421":"code","05f86f9d":"code","4526d525":"code","a3d0dd88":"code","8f955fe0":"code","313f3342":"code","77ee757b":"code","dfa91f5d":"code","9bba0ed2":"code","e535ab82":"code","4e1a271c":"code","9b08bc65":"code","277f173a":"code","d32ea4f1":"code","a37965f4":"code","ea63b6f7":"code","4a90048d":"code","6877cade":"code","3128369b":"code","2f0d5ea4":"code","20c153fe":"code","47cdd08c":"code","8a43274a":"code","4fef7eab":"code","efa739b7":"code","d1cdcdaf":"code","9159686d":"code","0247af2e":"code","7c92c0cf":"code","2b195745":"code","2a6e5fff":"code","3977a59e":"code","5414ecda":"code","a10bce49":"code","7dd66bec":"code","2bdb8370":"code","63e0d788":"code","d0461b63":"code","a26d14ca":"code","ba045c86":"code","2a5eb7a8":"code","77e770e9":"code","72556b51":"code","7e89d23c":"code","4bccd8f8":"code","ad261f0d":"code","e937f5c9":"code","ffef92c1":"code","12c3c0b0":"code","bd879580":"code","a3848a73":"code","cad55313":"code","1240f70d":"code","e4a686df":"code","428bb33c":"code","b2234b24":"markdown","b1d9d576":"markdown","08032d59":"markdown","723b2a3e":"markdown","5368d2ff":"markdown","f95d56c8":"markdown","f5f37df5":"markdown","1e6bba00":"markdown","52a96ed4":"markdown","7ea4c3c2":"markdown","d4481b02":"markdown","f2607e8f":"markdown","c31ce071":"markdown","575f7c5f":"markdown","3928dbdc":"markdown"},"source":{"91c15334":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\nimport warnings\n\nwarnings.filterwarnings('ignore')\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n%matplotlib inline","bf408421":"df = pd.read_csv('..\/input\/Consumo_cerveja.csv')\ndf.columns = df.columns.str.replace(' ','_')\ndf.columns = df.columns.str.replace('[)(]' ,'')","05f86f9d":"df.head(10)","4526d525":"df.shape","a3d0dd88":"df.isnull().sum()","8f955fe0":"# remo\u00e7\u00e3o de dados faltantes\ndf.dropna(subset=['Data','Final_de_Semana','Consumo_de_cerveja_litros'],how='all', inplace=True)","313f3342":"df['Temperatura_Media_C'] = df['Temperatura_Media_C'].str.replace(',' ,'.').astype(float)\ndf['Temperatura_Minima_C'] = df['Temperatura_Minima_C'].str.replace(',' ,'.').astype(float)\ndf['Temperatura_Maxima_C'] = df['Temperatura_Maxima_C'].str.replace(',' ,'.').astype(float)\ndf['Precipitacao_mm'] = df['Precipitacao_mm'].str.replace(',' ,'.').astype(float)\ndf['Final_de_Semana'] = df['Final_de_Semana'].astype(int)","77ee757b":"df['Data'] = pd.to_datetime(df['Data'])\ndf['mes'] = pd.to_datetime(df['Data']).dt.month\ndf['dia_semana'] = pd.to_datetime(df['Data']).dt.dayofweek\ndf['dia'] = pd.to_datetime(df['Data']).dt.day","dfa91f5d":"df.head()","9bba0ed2":"df[['Consumo_de_cerveja_litros']].describe()","e535ab82":"print(df.corr()['Consumo_de_cerveja_litros'].sort_values())","4e1a271c":"plt.figure(figsize=(10,10));\nsns.heatmap(df.corr(), square=True ,annot=True, linewidths=1, linecolor='k');","9b08bc65":"plt.figure(figsize=(12,6))\nsns.distplot(df['Consumo_de_cerveja_litros'],kde=False, bins=20);\nplt.xlabel('Consumo de cerveja litros')\nplt.title('\\nDistribui\u00e7\u00e3o de frequ\u00eancia\\n'.upper())\nplt.grid(ls='-.', lw=.5)","277f173a":"plt.figure(figsize=(12,3))\nsns.boxplot(df['Consumo_de_cerveja_litros']);\nplt.xlabel('Consumo de cerveja litros')\nplt.xlim(10,40)\nplt.grid(ls='-.', lw=.5);","d32ea4f1":"g = sns.FacetGrid(df, col='Final_de_Semana', hue='Final_de_Semana',\n                  height=5, aspect=1.5)\n\ng.map(sns.distplot,'Consumo_de_cerveja_litros', kde=False, bins=20);\n\ng.set_xlabels('Consumo de cerveja litros');","a37965f4":"dcc = df.groupby(['Final_de_Semana']).agg({'Consumo_de_cerveja_litros':['count','sum',\n                                                                  'mean','std',\n                                                                  'min','median',\n                                                                  'max']}).round(3)\n\ndcc","ea63b6f7":"f, ax = plt.subplots(1,2,figsize=(16, 6))\n\na = sns.boxplot(x = 'Final_de_Semana', y= 'Consumo_de_cerveja_litros', data=df, ax=ax[0]);\na.set_xlabel('Final de semana')\na.set_ylabel('Consumo de cerveja litros')\na.set_title('\\nConsumo de litros de cerveja\\n')\na.grid(ls='-.', lw=.5)\n\nb = sns.countplot(df['Final_de_Semana'], ax=ax[1]);\nb.set_xlabel('Final de semana')\nb.set_ylabel('quantidade')\nb.set_title('\\nQuantidade de dias\\n')\nb.set_ylim(0,300)\nb.grid(ls='-.', lw=.5)","4a90048d":"plt.figure(figsize=(6, 6))\n\nplt.pie(dcc['Consumo_de_cerveja_litros']['sum'],\n        labels=['Semama','Final de semana'],\n        autopct='%.2f%%',\n        explode=[0,0.05]);","6877cade":"plt.figure(figsize=(12, 6))\nsns.boxplot(x='mes', y='Consumo_de_cerveja_litros', data=df);\nplt.xlabel('M\u00eas')\nplt.ylabel('Consumo de cerveja litros')\nplt.title('Consumo de cerveja por m\u00eas')\nplt.grid(ls='-.', lw=0.2, c='k');","3128369b":"df.groupby(['mes','Final_de_Semana']).agg({'Consumo_de_cerveja_litros':['count','sum',\n                                                                  'mean','std',\n                                                                  'min','median',\n                                                                  'max']}).round(3)","2f0d5ea4":"sns.lmplot(x='Temperatura_Media_C', y='Consumo_de_cerveja_litros', hue='Final_de_Semana',\n           data=df, aspect=1.5, height=6);\n\nplt.xlabel('Temperatura Media \u00b0C')\nplt.ylabel('Consumo de cerveja litros')\nplt.grid(ls='-.', lw=.5);","20c153fe":"f, ax = plt.subplots(1,2,figsize=(16, 6))\n\na = sns.boxplot(x= 'mes', y='Consumo_de_cerveja_litros', hue='Final_de_Semana', data=df, ax=ax[0])\na.set_ylabel('Consumo de cerveja litros')\na.set_xlabel('M\u00eas')\na.set_title('\\nConsumo de cerveja litros por m\u00eas\\n')\na.grid(ls='-.', lw=.5)\n\nb = sns.boxplot(x= 'mes', y='Temperatura_Media_C', data=df,hue='Final_de_Semana',ax=ax[1],);\nb.set_ylabel('Temperatura Media \u00b0C')\nb.set_xlabel('M\u00eas')\nb.set_title('\\nTemperatura Media \u00b0C por m\u00eas\\n')\nb.grid(ls='-.', lw=.5);\n","47cdd08c":"sns.lmplot(x='Precipitacao_mm', y='Consumo_de_cerveja_litros', hue='Final_de_Semana',\n           data=df, aspect=1.5, height=6);\n\nplt.xlabel('Precipitacao mm')\nplt.ylabel('Consumo de cerveja litros')\nplt.xlim(-5,100)\nplt.grid(ls='-.', lw=.5);","8a43274a":"plt.figure(figsize=(16,6))\n\nsns.lineplot(x='Data',y='Consumo_de_cerveja_litros', data=df,alpha=.5);\nsns.lineplot(x='Data',y=df['Consumo_de_cerveja_litros'].rolling(15).mean(), data=df,alpha=.5);\n\nplt.ylabel('Consumo de cerveja litros')\n\nplt.grid(ls='-.', lw=.5);","4fef7eab":"df.columns","efa739b7":"plt.figure(figsize=(16, 6))\nsns.heatmap(df.pivot_table(values='Consumo_de_cerveja_litros', index='mes', columns='dia_semana'),\n            annot=True, fmt='.3f');\n\nplt.yticks(rotation=0);","d1cdcdaf":"plt.figure(figsize=(16, 6))\nsns.boxplot(x='dia', y='Consumo_de_cerveja_litros', data=df , hue='Final_de_Semana');\nplt.xlabel('Dia')\nplt.ylabel('Consumo de cerveja litros')\nplt.title('Consumo de cerveja por dia')\nplt.grid(ls='-.', lw=0.2, c='k');","9159686d":"plt.figure(figsize=(16, 6))\nsns.heatmap(df.pivot_table(values='Consumo_de_cerveja_litros', index='mes', columns='dia'),\n            annot=False, fmt='.3f');\n\nplt.yticks(rotation=0);","0247af2e":"g = sns.FacetGrid(df, col='mes', col_wrap=2,\n                  aspect=1.5, height=5,hue='mes',\n                  sharex=False)\n\ng.map(sns.barplot,'dia','Consumo_de_cerveja_litros');","7c92c0cf":"from sklearn.preprocessing import OneHotEncoder, StandardScaler\nfrom sklearn.metrics  import mean_squared_error,r2_score","2b195745":"X = df.drop(['Data','Temperatura_Media_C','Consumo_de_cerveja_litros'],axis=1)\ny = df['Consumo_de_cerveja_litros'].values","2a6e5fff":"X.head()","3977a59e":"oneH = OneHotEncoder(categorical_features=[3,4,5,6])\nsSC = StandardScaler()","5414ecda":"X = oneH.fit_transform(X).toarray()\nX = sSC.fit_transform(X)","a10bce49":"from sklearn.model_selection import train_test_split","7dd66bec":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42,shuffle=True )","2bdb8370":"def info(yTest_, pred_,sg = 'X'):\n    ''' Return resultados '''\n    \n    print(f'''\n{sg}    \n    \n{'-' * 65}\n          \nMean squared error | {mean_squared_error(yTest_,pred_)}\nr2 Score           | {r2_score(yTest_, pred_)}        \n          \n{'.' * 65}\ny-test max         | {y_test.max()}\ny-test min         | {y_test.min()}\ny-test mean        | {y_test.mean()} \ny-test var         | {y_test.var()}\n{'.' * 65}\n                \nPrediction {sg} max  | {pred_.max()}\nPrediction {sg} min  | {pred_.min()}\nPrediction {sg} Mean | {pred_.mean()}\nPrediction {sg} Var  | {pred_.var()}\n\n          \n{'-' * 65}\n''')","63e0d788":"def graficos(y, pred):\n    \n    # scatter\n    plt.figure(figsize=(12, 6))\n\n    plt.plot(y,y)\n    plt.scatter(pred,y, c='r', marker='o')\n    plt.legend(['Real','Previs\u00e3o'])\n    plt.grid(ls='-.', lw=0.2, c='k');\n    \n    # distplot\n    plt.figure(figsize=(12, 6))    \n    sns.distplot(y)\n    sns.distplot(pred)\n    plt.legend(['Real','Previs\u00e3o'])\n    plt.grid(ls='-.', lw=0.2, c='k')","d0461b63":"from sklearn.linear_model import LinearRegression","a26d14ca":"lR = LinearRegression()","ba045c86":"%time lR.fit(X_train,y_train)","2a5eb7a8":"%time pred_lR = lR.predict(X_test)","77e770e9":"info(y_test, pred_lR, 'LinearRegression') ","72556b51":"graficos(y_test, pred_lR)","7e89d23c":"from sklearn.neighbors import KNeighborsRegressor","4bccd8f8":"kNR = KNeighborsRegressor(n_neighbors=5)","ad261f0d":"%time kNR.fit(X_train,y_train)","e937f5c9":"%time pred_kNR = kNR.predict(X_test)","ffef92c1":"info(y_test, pred_kNR, 'KNeighborsRegressor') ","12c3c0b0":"graficos(y_test, pred_kNR)","bd879580":"from sklearn.neural_network import MLPRegressor","a3848a73":"mLPR = MLPRegressor(hidden_layer_sizes=(100,100,100,),tol=0.000000001,\n                         max_iter=1000,\n                         verbose=2)","cad55313":"%time mLPR.fit(X_train,y_train)","1240f70d":"%time pred_mLPR =mLPR.predict(X_test)","e4a686df":"info(y_test, pred_mLPR, 'MLPRegressor')","428bb33c":"graficos(y_test, pred_mLPR)","b2234b24":" - 0 - Dia de semana\n - 1 - Final de semana","b1d9d576":"#### Resultados","08032d59":"### Consumo de litros de cerveja por m\u00eas","723b2a3e":"#### Resuldado ","5368d2ff":"### Consumo de litros de cerveja aos  fins de semana versos dia de semana ","f95d56c8":"# Beer Consumption - Sao Paulo","f5f37df5":"#### Resuldado ","1e6bba00":"# Regress\u00e3o Linear","52a96ed4":"### KNeighborsRegressor","7ea4c3c2":"* Os dias de semana **\"0\"** possuem o consumo m\u00e9dio menor de \u00e1lcool por\u00e9m s\u00e3o respons\u00e1veis por 67.56% do volume de cerveja vendido no ano ","d4481b02":"### MLPRegressor","f2607e8f":"### Influ\u00eancia da Temperatura","c31ce071":"* O consumo de cerveja aos fins de semana **\"1\"** \u00e9 relativamente maior do que o consumo durante a semana. Por\u00e9m os fins-de-semana correspondem a 104 dias do total de 365 dias do ano. ","575f7c5f":"### LinearRegression","3928dbdc":"- O gr\u00e1fico apresenta uma correla\u00e7\u00e3o  linear positiva entre o consumo de cerveja e a temperatura m\u00e9dia. \n<br>   **Nota:** O volume de litros de cerveja vendida em rela\u00e7\u00e3o a temperatura \u00e9 ainda maior nos fins de semana"}}