{"cell_type":{"26af5174":"code","be633172":"code","5d93e63b":"code","60bca89e":"code","36ad1e4c":"code","fc3e3947":"code","8c92a987":"code","15cb3583":"code","cdaebcb9":"code","a0aefc99":"code","e3118378":"code","efd8fb8e":"code","0bfd5d4c":"code","dfe37610":"code","ca963483":"markdown"},"source":{"26af5174":"!pip install astropy\n!pip install specutils","be633172":"#GENERAL\n\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport matplotlib.cm as mtpltcm\nfrom mpl_toolkits.mplot3d import Axes3D\nimport random\nimport time\n\n#PATH PROCESS\n\nimport os\nimport os.path\nfrom pathlib import Path\nimport glob\nfrom scipy.io import loadmat\nimport nibabel as nib\nimport csv\nfrom astropy.visualization import astropy_mpl_style\nfrom astropy.utils.data import get_pkg_data_filename\nfrom astropy.io import fits\nimport astropy\nfrom astropy import units as u \nimport astropy.wcs as fitswcs\nfrom specutils import Spectrum1D, SpectralRegion\nfrom astropy.cosmology import WMAP9 as Cosmology\n\n#IMAGE PROCESS\n\nfrom PIL import Image\nfrom tensorflow.keras.preprocessing import image\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nimport cv2\nfrom tensorflow.keras.applications.vgg16 import preprocess_input, decode_predictions\nfrom tensorflow.keras.preprocessing import image\nfrom skimage.feature import hessian_matrix, hessian_matrix_eigvals\nfrom scipy.ndimage.filters import convolve\nfrom skimage import data, io, filters\nimport skimage.morphology as morph\nimport skimage.exposure as skie\nimport skimage\nfrom skimage.morphology import convex_hull_image, erosion\nfrom IPython import display\nfrom scipy.ndimage import gaussian_filter\nfrom mpl_toolkits.mplot3d.art3d import Poly3DCollection\nimport matplotlib.patches as patches\n\n#SCALER & TRANSFORMATION\n\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import train_test_split\nfrom tensorflow.keras import regularizers\nfrom sklearn.preprocessing import LabelEncoder\nimport sklearn\n\nimport pydub\nfrom scipy.io.wavfile import read, write\nimport librosa\nimport librosa.display\nimport IPython\nfrom IPython.display import Audio\nimport scipy\nfrom scipy import signal\nfrom scipy.fft import fftshift\n\n#IGNORING WARNINGS\n\nfrom warnings import filterwarnings\n\nfilterwarnings(\"ignore\",category=DeprecationWarning)\nfilterwarnings(\"ignore\", category=FutureWarning) \nfilterwarnings(\"ignore\", category=UserWarning)\nfilterwarnings(\"ignore\", category=RuntimeWarning)","5d93e63b":"DIVER_SPECTRUM_LIST = [\"PiYG\",\"PRGn\",\"seismic\"]","60bca89e":"Path_4 = \"..\/input\/iras085723915-active-galaxy-nucleus-fits-nasa\/IRAS08572+3915\/HST\/idsy07010\/idsy07010_drc.fits\"\nOPEN_4 = fits.open(Path_4)\nIMG_DATA_4_SCI = OPEN_4[1].data\nWIDE_AREA_IMG_4 = IMG_DATA_4_SCI[1000:1450,1910:2300]\nTARGET_CLOSE_NUCLEUS_NORMAL = WIDE_AREA_IMG_4[180:290,140:240]\nTARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL = WIDE_AREA_IMG_4[50:290,90:270]\nFOCUS_NUCLEUS = TARGET_CLOSE_NUCLEUS_NORMAL[45:80,35:58]","36ad1e4c":"TARGET_CLOSE_NUCLEUS_NORMAL_3D = astropy.visualization.make_lupton_rgb(image_r=TARGET_CLOSE_NUCLEUS_NORMAL.astype('float32'),\n                                      image_g=TARGET_CLOSE_NUCLEUS_NORMAL.astype('float32'),\n                                      image_b=TARGET_CLOSE_NUCLEUS_NORMAL.astype('float32'))\n\n\nTARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL_3D = astropy.visualization.make_lupton_rgb(image_r=TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL.astype('float32'),\n                                      image_g=TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL.astype('float32'),\n                                      image_b=TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL.astype('float32'))\n\nFOCUS_NUCLEUS_3D = astropy.visualization.make_lupton_rgb(image_r=FOCUS_NUCLEUS.astype('float32'),\n                                      image_g=FOCUS_NUCLEUS.astype('float32'),\n                                      image_b=FOCUS_NUCLEUS.astype('float32'))","fc3e3947":"figure,axis = plt.subplots(1,3,figsize=(13,13))\n\naxis[0].set_title(\"3D - NUCLEUS\")\naxis[0].set_xlabel(TARGET_CLOSE_NUCLEUS_NORMAL_3D.shape)\naxis[0].imshow(TARGET_CLOSE_NUCLEUS_NORMAL_3D)\n\naxis[1].set_title(\"3D - MASS ABSORPTION\")\naxis[1].set_xlabel(TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL_3D.shape)\naxis[1].imshow(TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL_3D)\n\naxis[2].set_title(\"3D - FOCUS NUCLEUS\")\naxis[2].set_xlabel(FOCUS_NUCLEUS_3D.shape)\naxis[2].imshow(FOCUS_NUCLEUS_3D)\n\nplt.tight_layout()\nplt.show()","8c92a987":"_,BINARY_TARGET_CLOSE_NUCLEUS_NORMAL = cv2.threshold(TARGET_CLOSE_NUCLEUS_NORMAL_3D,12,255,cv2.THRESH_BINARY)\n_,BINARY_TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL = cv2.threshold(TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL_3D,18,255,cv2.THRESH_BINARY)\n_,BINARY_FOCUS_NUCLEUS_3D = cv2.threshold(FOCUS_NUCLEUS_3D,15,255,cv2.THRESH_BINARY)","15cb3583":"figure,axis = plt.subplots(1,3,figsize=(13,13))\n\naxis[0].set_title(\"3D - NUCLEUS\")\naxis[0].set_xlabel(BINARY_TARGET_CLOSE_NUCLEUS_NORMAL.shape)\naxis[0].imshow(BINARY_TARGET_CLOSE_NUCLEUS_NORMAL)\n\naxis[1].set_title(\"3D - MASS ABSORPTION\")\naxis[1].set_xlabel(BINARY_TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL.shape)\naxis[1].imshow(BINARY_TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL)\n\naxis[2].set_title(\"3D - FOCUS NUCLEUS\")\naxis[2].set_xlabel(BINARY_FOCUS_NUCLEUS_3D.shape)\naxis[2].imshow(BINARY_FOCUS_NUCLEUS_3D)\n\nplt.tight_layout()\nplt.show()","cdaebcb9":"TARGET_KERNEL = np.ones((4,4),np.uint8)","a0aefc99":"COPY_FOCUS_NUCLEUS_3D = FOCUS_NUCLEUS_3D.copy()\nCOPY_FOCUS_NUCLEUS_3D[BINARY_FOCUS_NUCLEUS_3D[:,:,0] == 255] = [255,0,0]\n\nfigure,axis = plt.subplots(1,3,figsize=(20,20))\n\naxis[0].imshow(FOCUS_NUCLEUS_3D,cmap=\"gray\")\naxis[1].imshow(BINARY_FOCUS_NUCLEUS_3D,cmap=\"gray\")\naxis[2].imshow(COPY_FOCUS_NUCLEUS_3D,cmap=\"gray\")\n\n\naxis[0].axis(\"off\")\naxis[1].axis(\"off\")\naxis[2].axis(\"off\")\n\n\naxis[0].set_title(\"ORIGINAL\")\naxis[1].set_title(\"BINARY\")\naxis[2].set_title(\"MASKING\")\n\n\nplt.tight_layout()\nplt.show()","e3118378":"COPY_TARGET_CLOSE_NUCLEUS_NORMAL_3D = TARGET_CLOSE_NUCLEUS_NORMAL_3D.copy()\nCOPY_TARGET_CLOSE_NUCLEUS_NORMAL_3D[BINARY_TARGET_CLOSE_NUCLEUS_NORMAL[:,:,0] == 255] = [255,0,0]\n\nfigure,axis = plt.subplots(1,3,figsize=(20,20))\n\naxis[0].imshow(TARGET_CLOSE_NUCLEUS_NORMAL_3D,cmap=\"gray\")\naxis[1].imshow(BINARY_TARGET_CLOSE_NUCLEUS_NORMAL,cmap=\"gray\")\naxis[2].imshow(COPY_TARGET_CLOSE_NUCLEUS_NORMAL_3D,cmap=\"gray\")\n\n\naxis[0].axis(\"off\")\naxis[1].axis(\"off\")\naxis[2].axis(\"off\")\n\n\naxis[0].set_title(\"ORIGINAL\")\naxis[1].set_title(\"BINARY\")\naxis[2].set_title(\"MASKING\")\n\n\nplt.tight_layout()\nplt.show()","efd8fb8e":"COPY_TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL_3D = TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL_3D.copy()\nCOPY_TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL_3D[BINARY_TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL[:,:,0] == 255] = [255,0,0]\n\nfigure,axis = plt.subplots(1,3,figsize=(20,20))\n\naxis[0].imshow(TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL_3D,cmap=\"gray\")\naxis[1].imshow(BINARY_TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL,cmap=\"gray\")\naxis[2].imshow(COPY_TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL_3D,cmap=\"gray\")\n\n\naxis[0].axis(\"off\")\naxis[1].axis(\"off\")\naxis[2].axis(\"off\")\n\n\naxis[0].set_title(\"ORIGINAL\")\naxis[1].set_title(\"BINARY\")\naxis[2].set_title(\"MASKING\")\n\n\nplt.tight_layout()\nplt.show()","0bfd5d4c":"CONTOURS,_ = cv2.findContours(BINARY_TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL[:,:,0].astype(np.uint8),cv2.RETR_TREE,cv2.CHAIN_APPROX_SIMPLE)\nCOPY_TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL = TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL.copy()\n\nfor (i,c) in enumerate(CONTOURS):\n    \n    (x,y,w,h) = cv2.boundingRect(c)\n    \n    ((cX,cY),radius) = cv2.minEnclosingCircle(c)\n    \n    cv2.circle(COPY_TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL,(int(cX),int(cY)),int(radius),(255,0,0),1)\n    \n    cv2.putText(COPY_TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL, str(i + 1), (x, y),\n\t\tcv2.FONT_HERSHEY_SIMPLEX, 0.51, (255, 0, 0), 1)\n\nfigure,axis = plt.subplots(1,2,figsize=(20,20))\n\naxis[0].imshow(COPY_TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL,cmap=\"jet\")\naxis[1].imshow(BINARY_TARGET_CLOSE_NUCLEUS_AND_MASS_ABSORPTION_NORMAL,cmap=\"gray\")\n\n\n\naxis[0].axis(\"off\")\naxis[1].axis(\"off\")\n\n\naxis[0].set_title(\"LIGHT CIRCLES\")\naxis[1].set_title(\"BINARY\")\n\n\nplt.tight_layout()\nplt.show()","dfe37610":"CONTOURS,_ = cv2.findContours(BINARY_TARGET_CLOSE_NUCLEUS_NORMAL[:,:,0].astype(np.uint8),cv2.RETR_TREE,cv2.CHAIN_APPROX_SIMPLE)\nCOPY_TARGET_CLOSE_NUCLEUS_NORMAL_3D = TARGET_CLOSE_NUCLEUS_NORMAL_3D.copy()\nRADIUS_LIST = []\nfor (i,c) in enumerate(CONTOURS):\n    \n    (x,y,w,h) = cv2.boundingRect(c)\n    \n    ((cX,cY),radius) = cv2.minEnclosingCircle(c)\n    RADIUS_LIST.append(radius)\n    cv2.circle(COPY_TARGET_CLOSE_NUCLEUS_NORMAL_3D,(int(cX),int(cY)),int(radius),(255,0,0),1)\n    \n    \n    cv2.putText(COPY_TARGET_CLOSE_NUCLEUS_NORMAL_3D, str(i + 1), (x, y),\n\t\tcv2.FONT_HERSHEY_SIMPLEX, 0.51, (255, 0, 0), 1)\n\nfigure,axis = plt.subplots(1,2,figsize=(20,20))\n\naxis[0].imshow(COPY_TARGET_CLOSE_NUCLEUS_NORMAL_3D,cmap=\"jet\")\naxis[1].imshow(BINARY_TARGET_CLOSE_NUCLEUS_NORMAL,cmap=\"gray\")\n\n\n\naxis[0].axis(\"off\")\naxis[1].axis(\"off\")\n\n\naxis[0].set_title(\"LIGHT CIRCLES  \" + \"ONE:  \" + str(RADIUS_LIST[0]) + \"  \" + \"TWO:  \" +  str(RADIUS_LIST[1]))\naxis[1].set_title(\"BINARY\")\n\n\nplt.tight_layout()\nplt.show()","ca963483":"# IRAS08572+3915 Active Galaxy Nucleus\n\n* ICRS coord. (ep=J2000) 09 00 25.364 +39 03 54.23 (Infrared)\n\n* FK4 coord. (ep=B1950 eq=1950) 08 57 12.948 +39 15 39.12\n\n* Gal coord. (ep=J2000) 183.402722 +40.999969\n\n* RA \/ DEC 135.1056833 +39.0650639\n\n* An active galactic nucleus (AGN) is a compact region at the center of a galaxy that has a much-higher-than-normal luminosity over at least some portion of the electromagnetic spectrum with characteristics indicating that the luminosity is not produced by stars. Such excess non-stellar emission has been observed in the radio, microwave, infrared, optical, ultra-violet, X-ray and gamma ray wavebands. A galaxy hosting an AGN is called an \"active galaxy\". The non-stellar radiation from an AGN is theorized to result from the accretion of matter by a supermassive black hole at the center of its host galaxy.\n\n* Active galactic nuclei are the most luminous persistent sources of electromagnetic radiation in the universe, and as such can be used as a means of discovering distant objects; their evolution as a function of cosmic time also puts constraints on models of the cosmos.\n\n* The observed characteristics of an AGN depend on several properties such as the mass of the central black hole, the rate of gas accretion onto the black hole, the orientation of the accretion disk, the degree of obscuration of the nucleus by dust, and presence or absence of jets.\n\n* Numerous subclasses of AGN have been defined based on their observed characteristics; the most powerful AGN are classified as quasars. A blazar is an AGN with a jet pointed toward the Earth, in which radiation from the jet is enhanced by relativistic beaming.\n\n* Carl Seyfert discovered the first class of AGN, that are now named after him. The nuclei of Seyfert galaxies display emission lines. Type 1 Seyfert galaxies have both narrow and broadened optical spectral emission lines. The broad lines imply gas velocities of 1000 \u2013 5000 km\/s very close to the nucleus. Seyfert type 2 galaxies have narrow emission lines only (but still wider than emission lines in normal galaxies) implying gas velocities of ~ 500-1000 km\/s. These narrow lines are due to low density gas clouds at larger distances (than the broad line clouds) from the nucleus."}}