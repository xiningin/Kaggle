{"cell_type":{"9c9e286a":"code","585a9a0e":"code","630537b0":"code","eb5f35e6":"code","7753072d":"code","b0f85e39":"code","1f243aeb":"code","b8b73b54":"code","ee2025fe":"code","107cc4d8":"code","630ef94a":"code","0423b50f":"code","53dbde29":"code","64e85017":"code","c79b9fa3":"code","f38ccabf":"code","de36bc82":"code","c1b209a0":"code","cb0bfddd":"code","9a0c4577":"code","c60b984a":"code","188b8f98":"code","d9f8b2a9":"code","0c01262a":"code","6fd38e06":"code","956eb227":"code","937165d3":"code","bb29c50e":"code","53e21f5b":"code","c12ed148":"code","6e66eb07":"code","d7b1cfac":"code","ddbc3000":"code","c2d6930b":"code","78f7f21b":"code","640acb3a":"code","5bbb49e9":"code","f3e2486e":"code","3e34242e":"code","97289ec6":"code","5a9e934a":"markdown","c7bb5e65":"markdown","c358d037":"markdown","9ae602f1":"markdown","11a4526f":"markdown","b0f4ebaa":"markdown","667e88e4":"markdown","aa673fca":"markdown","7217b0a1":"markdown","f392c988":"markdown","ca1c68e3":"markdown","3fd60e65":"markdown","790bac9d":"markdown","8cb2d1db":"markdown","81067a16":"markdown","ec2887a0":"markdown","cd179b0c":"markdown","2d81c943":"markdown","5465f32b":"markdown","89fbd409":"markdown","130a512f":"markdown","9ac48c4f":"markdown","1d1f5e41":"markdown"},"source":{"9c9e286a":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","585a9a0e":"import warnings\nwarnings.filterwarnings('ignore')","630537b0":"df=pd.read_csv(\"\/kaggle\/input\/credit-card-customers\/BankChurners.csv\")","eb5f35e6":"df.head()","7753072d":"df.drop([\"CLIENTNUM\",\"Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_2\",\n        \"Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_1\"],\n       axis=1,inplace=True)","b0f85e39":"sns.countplot(df[\"Attrition_Flag\"])","1f243aeb":"sns.distplot(df[\"Customer_Age\"])","b8b73b54":"print(\"Mean value of age is:\",df[\"Customer_Age\"].mean())\nprint(\"Variance of age is:\",df[\"Customer_Age\"].var())","ee2025fe":"sns.countplot(df[\"Gender\"])","107cc4d8":"sns.countplot(df[\"Gender\"],hue=df[\"Attrition_Flag\"])","630ef94a":"sns.countplot(df[\"Card_Category\"],hue=df[\"Attrition_Flag\"])","0423b50f":"sns.countplot(df[\"Education_Level\"])\nplt.xticks(rotation=90)","53dbde29":"sns.countplot(df[\"Marital_Status\"])","64e85017":"sns.countplot(df[\"Income_Category\"])\nplt.xticks(rotation=90)","c79b9fa3":"df[\"Attrition_Flag\"].replace(\"Attrited Customer\",1,inplace=True)\ndf[\"Attrition_Flag\"].replace(\"Existing Customer\",0,inplace=True)","f38ccabf":"df.rename(columns={\"Attrition_Flag\":\"Churn\"},inplace=True)","de36bc82":"df[\"Gender\"].replace(\"M\",1,inplace=True)\ndf[\"Gender\"].replace(\"F\",0,inplace=True)","c1b209a0":"df[\"Marital_Status\"].replace('Single',1,inplace=True)\ndf[\"Marital_Status\"].replace('Married',2,inplace=True)\ndf[\"Marital_Status\"].replace('Divorced',3,inplace=True)\ndf[\"Marital_Status\"].replace('Unknown',4,inplace=True)","cb0bfddd":"df[\"Card_Category\"].replace('Blue',1,inplace=True)\ndf[\"Card_Category\"].replace('Silver',2,inplace=True)\ndf[\"Card_Category\"].replace('Gold',3,inplace=True)\ndf[\"Card_Category\"].replace('Platinum',4,inplace=True)","9a0c4577":"df[\"Education_Level\"].replace('Uneducated',1,inplace=True)\ndf[\"Education_Level\"].replace('High School',2,inplace=True)\ndf[\"Education_Level\"].replace('College',3,inplace=True)\ndf[\"Education_Level\"].replace('Graduate',4,inplace=True)\ndf[\"Education_Level\"].replace('Post-Graduate',5,inplace=True)\ndf[\"Education_Level\"].replace('Doctorate',6,inplace=True)\ndf[\"Education_Level\"].replace('Unknown',7,inplace=True)","c60b984a":"df[\"Income_Category\"].unique()","188b8f98":"df[\"Income_Category\"].replace(\"$60K - $80K\",3,inplace=True)\ndf[\"Income_Category\"].replace(\"Less than $40K\",1,inplace=True)\ndf[\"Income_Category\"].replace(\"$80K - $120K\",4,inplace=True)\ndf[\"Income_Category\"].replace(\"$40K - $60K\",2,inplace=True)\ndf[\"Income_Category\"].replace(\"$120K +\",5,inplace=True)\ndf[\"Income_Category\"].replace(\"Unknown\",np.nan,inplace=True)","d9f8b2a9":"df.dropna(axis=0,inplace=True)","0c01262a":"df=df.astype(float)","6fd38e06":"df.head()","956eb227":"plt.figure(figsize=(20,8))\nsns.heatmap(df.corr(),annot=True,cmap=\"summer\")","937165d3":"#dropping the columns\ndf.drop(['Gender','Customer_Age','Dependent_count','Education_Level','Marital_Status',\n         'Income_Category','Card_Category','Months_on_book','Credit_Limit'],axis=1,inplace=True)","bb29c50e":"df.head()","53e21f5b":"X=df.drop([\"Churn\"],axis=1)\ny=df[\"Churn\"]","c12ed148":"from sklearn.ensemble import ExtraTreesClassifier\nimport matplotlib.pyplot as plt\nmodel=ExtraTreesClassifier()\nmodel.fit(X,y)","6e66eb07":"ranked_features=pd.Series(model.feature_importances_,index=X.columns)\nranked_features.plot(kind='barh')","d7b1cfac":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=0)","ddbc3000":"from sklearn.ensemble import RandomForestClassifier\nmodel=RandomForestClassifier()\nmodel.fit(X_train,y_train)","c2d6930b":"y_pred=model.predict(X_test)\n\nfrom sklearn.metrics import confusion_matrix,classification_report,accuracy_score\nprint(confusion_matrix(y_test,y_pred))\nprint(classification_report(y_test,y_pred))\nprint(\"Model accuracy score is:\",accuracy_score(y_test,y_pred))","78f7f21b":"from sklearn.model_selection import GridSearchCV\n\n#number of trees\nn_estimators=[200,400,600,800,1000]\n\n#max number of levels in tree\nmax_depth=[int(x) for x in np.linspace(5,20,num=3)]\n\n#min number of samples reqd at each leaf node\nmin_samples_leaf=[1,2,5,10]\n\n#create the param grid\nparam_grid={'n_estimators':n_estimators,\n           'max_depth':max_depth,\n           'min_samples_leaf':min_samples_leaf\n           }\n\n#grid serach cv\nmodel2=GridSearchCV(estimator=model,param_grid=param_grid,cv=8,n_jobs=-1)","640acb3a":"model2.fit(X_train,y_train)","5bbb49e9":"model2.best_estimator_","f3e2486e":"model3=RandomForestClassifier(max_depth=20, min_samples_leaf=2, n_estimators=200)","3e34242e":"model3.fit(X_train,y_train)","97289ec6":"y_pred=model3.predict(X_test)\n\nfrom sklearn.metrics import confusion_matrix,classification_report,accuracy_score\nprint(confusion_matrix(y_test,y_pred))\nprint(classification_report(y_test,y_pred))\nprint(\"Model accuracy score is:\",accuracy_score(y_test,y_pred))","5a9e934a":"IN THE NOTEBOOK WE WILL PERFORM FOLLOWING ACTIVITES:\n\n1.DATA CLEANING\n\n2.DATA VISUALIZATION\n\n3.MODEL CREATION\n\n4.TASKS GIVEN IN THE CONTEXT OF THE PROBLEM","c7bb5e65":"### *KINDLY UPVOTE IF YOU GOT HELPED :)*\n","c358d037":"NO. OF FEMALE IS MORE THAN THAT OF MALE.","9ae602f1":"***UPDATES COMING SOON..","11a4526f":"STRANGELY OUR ACCURACY GOT DECREASED AFTER HYPERPARAMETER TUNING.","b0f4ebaa":"MOST CUSTOMERS ARE GRADUATE & LEAST NO. OF CUSTOMERS ARE DOCTORATE.","667e88e4":"WE WILL DROP THE COLUMNS WHICH HAVE LOW CORRELATION WITH OUR TARGATE COLUMN (CHURN)","aa673fca":"ATTRITION COMPARISION OF MALE & FEMALE CUSTOMERS.","7217b0a1":"## MODEL PRE-PROCESSING","f392c988":"TASK:RELATION WITH THE I\/P FEATURES TO OUR TARGET FEATURE","ca1c68e3":"HYPERPARAMETER TUNING","3fd60e65":"ATTRITION_FLAG IS OUR TARGET VARIABLE. FROM THE ABOVE PLOT WE CAN SEE OUR DATA IS HIGHLY IMBALANCED. SO, WE HAVE TO TUNE OUR DATA PROPERLY.","790bac9d":"*WE WILL CONVERT THE STRING VALUES TO INT\/FLOAT VALUE, SO THAT WE CAN FEED OUR\nDATA TO THE ML MODEL*","8cb2d1db":"CUSTOMERS WITH PREMIUM PLANS HAVE LOWER RATE OF ATTRITION. THIS SIGNIFIES PREMIUM CUSTOMERS ARE LOYAL CUSTOMERS","81067a16":"## DATA CLEANING","ec2887a0":"FROM THE ABOVE PLOT WE CAN SEE THAT OUR DATA IS NORMALLY DISTRIBUTED.","cd179b0c":"<img src =\"https:\/\/miro.medium.com\/max\/800\/0*dzmm3qresODlScte\">","2d81c943":"## MODEL BUILDING","5465f32b":"## DATA VISUALIZATION","89fbd409":"IN OUR DATA SET MOST PEOPLE BELONGS TO MARRIED CLASS.","130a512f":"MOST PEOPLE EARNS LESS THAN 40K","9ac48c4f":"ABOVE PLOT SHOWS THE IMPORTANCE OF I\/P FEATURES TO OUR TARGET FEATURE(CHURN).","1d1f5e41":"# **CUSTOMER CHURN ANALYSIS**"}}