{"cell_type":{"d8e0758c":"code","4d35ae56":"code","d1f110a4":"code","b16f898c":"code","f76c41cb":"code","b0cc3077":"code","767beeae":"code","e0f48c7a":"code","ce8b7f9e":"code","f2aede93":"code","adb12c04":"code","ef84cb08":"code","0c3435f6":"code","8e4b7b3d":"code","91403f46":"code","813ccb15":"code","e99c1705":"code","2b2f707b":"code","b849243f":"code","474b4ff7":"code","b7a5e3e9":"code","f16923c5":"code","cbba4aa7":"code","b22ebcc5":"code","339cbda9":"code","b055dd14":"code","f1614c7f":"markdown","5b290cdc":"markdown","451c914a":"markdown","e2fc7f5f":"markdown","48a44817":"markdown","d443b02a":"markdown","66087653":"markdown","a24be8c5":"markdown"},"source":{"d8e0758c":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","4d35ae56":"df = pd.read_csv('..\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv')\ndf","d1f110a4":"df.describe()","b16f898c":"df_missing = df.isna().sum()\nprint(df_missing[df_missing > 0])","f76c41cb":"df['smoking_status'] = df['smoking_status'].replace(['Unknown'],'NaN')","b0cc3077":"df.info()","767beeae":"sns.countplot(df.dtypes.map(str))","e0f48c7a":"categoric_cols = [categoric for categoric in df.columns if df[categoric].dtype == 'object' ]\ncategoric_cols","ce8b7f9e":"fig, axes = plt.subplots(1, 5, figsize=(20, 5), sharey=True)\nsns.countplot(ax=axes[0], x=df.gender)\n\nsns.countplot(ax=axes[1], x=df.ever_married)\n\nsns.countplot(ax=axes[2], x=df.work_type)\n\nsns.countplot(ax=axes[3], x=df.Residence_type)\n\nsns.countplot(ax=axes[4], x=df.smoking_status)","f2aede93":"df.drop(df.index[df['gender'] == 'Other'], inplace = True)","adb12c04":"feature = ['age', 'hypertension', 'heart_disease', 'avg_glucose_level', 'bmi', 'stroke']\n\ndf[feature].hist(figsize=(12, 8))\nplt.show()","ef84cb08":"plt.figure(figsize=(12, 8))\nsns.heatmap(data=df.corr(), annot=True)\nplt.show()","0c3435f6":"scat = sns.PairGrid(df, x_vars=df.columns, y_vars=['stroke'] )\nscat.map(sns.scatterplot)","8e4b7b3d":"df","91403f46":"df.groupby(['gender', 'ever_married'])['stroke'].sum().plot(kind='bar')","813ccb15":"# preprocessing\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.preprocessing import StandardScaler, MinMaxScaler, OneHotEncoder\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.impute import SimpleImputer","e99c1705":"# model library\nfrom sklearn.svm import SVC\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import RandomForestClassifier","2b2f707b":"X = df.drop(columns=['id', 'stroke'])\ny = df['stroke']\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, stratify=y, test_size=0.2, random_state=42)","b849243f":"numerical_pipeline = Pipeline([\n    ('scaling', StandardScaler()),\n    ('impute', SimpleImputer(strategy='mean'))\n])\n\ncategorical_pipeline = Pipeline([\n    ('onehot', OneHotEncoder()),\n    ('impute', SimpleImputer(strategy='most_frequent'))\n])\n\npreprocessing = ColumnTransformer([\n    ('numeric', numerical_pipeline, ['age', 'hypertension', 'heart_disease', 'avg_glucose_level', 'bmi']),\n    ('categoric', categorical_pipeline, ['gender', 'ever_married', 'work_type', 'Residence_type',\n       'smoking_status'])\n])\n\npipeline = Pipeline([\n    ('pre', preprocessing),\n    ('algo', RandomForestClassifier(random_state=42))\n])","474b4ff7":"pipeline.fit(X_train, y_train)","b7a5e3e9":"pipeline.get_params()","f16923c5":"parameter = {\n    'algo__n_estimators':[100,200, 350, 500], \n    'algo__min_samples_leaf':[2, 10, 30]\n}","cbba4aa7":"model = GridSearchCV(pipeline, parameter, cv=3, n_jobs=-1, verbose=1)\nmodel.fit(X_train, y_train)","b22ebcc5":"print(model.score(X_train, y_train)), print(model.score(X_test, y_test))","339cbda9":"from sklearn.metrics import accuracy_score\nfrom sklearn.metrics import f1_score","b055dd14":"y_pred = model.predict(X_test)\naccuracy = accuracy_score(y_test, y_pred)\nf_acc = f1_score(y_test, y_pred)\n\nprint(accuracy)\nprint(f_acc)","f1614c7f":"This dataset has 5 objects in data type, we have to convert to int or float so that machine learning can learn it well","5b290cdc":"## **Modeling**","451c914a":"### **Check Data Type**","e2fc7f5f":"### **Univariant Analysis**","48a44817":"## **Exploration Data Analysis** ","d443b02a":"### **Bivariant Analysis**","66087653":"### Check By Age","a24be8c5":"### **Check Missing Value**"}}