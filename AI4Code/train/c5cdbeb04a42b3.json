{"cell_type":{"49303413":"code","cca7246c":"code","852c84fc":"code","11f2e845":"code","4f356c54":"code","9530cb8b":"code","2d53c9d8":"code","dc17dc5d":"code","e37ad47c":"code","a67beb5f":"code","d372efef":"code","35bf037f":"code","9c38f029":"code","f0016e98":"code","45063499":"code","630a795d":"code","3fc89617":"code","716c1916":"code","663ad089":"code","b7260caf":"code","200800dc":"code","b1ea599e":"code","8f07c57e":"code","53e1a89a":"code","f098b43e":"code","310f535d":"markdown","a580bcf5":"markdown","550a0c0f":"markdown","2e3a956a":"markdown","79077567":"markdown","faf4ce72":"markdown"},"source":{"49303413":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\n\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.compose import make_column_transformer\nfrom sklearn.metrics import accuracy_score\n\nimport warnings\nwarnings.filterwarnings('ignore')","cca7246c":"df = pd.read_csv(\"..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv\")\ndf.head()","852c84fc":"df.isna().sum()","11f2e845":"df.info()","4f356c54":"df.describe().T","9530cb8b":"df.shape","2d53c9d8":"df.columns","dc17dc5d":"sns.histplot(x=\"age\",data=df);","e37ad47c":"sns.countplot(x=\"sex\",data=df);\nplt.xticks(ticks=[0,1],labels=[\"female\",\"male\"])\nplt.show()","a67beb5f":"df2=df[df[\"output\"]==1]\nsns.histplot(df2[\"thalachh\"],bins=10);\nplt.xlabel(\"MAXIMUM HEART RATE REACHED WHEN OUTPUT 1\")\nplt.show()","d372efef":"df3=df[df[\"output\"]==0]\nsns.histplot(df3[\"thalachh\"],bins=10);\nplt.xlabel(\"MAXIMUM HEART RATE REACHED WHEN OUTPUT 0\")\nplt.show()","35bf037f":"s=df[\"sex\"].value_counts().reset_index()\npx.pie(s,names=\"index\",values=\"sex\",title=\"%AGE OF MALE AND FEMALE PATIENTS:\")","9c38f029":"sns.stripplot(x=\"cp\",y=\"trtbps\",hue=\"output\",data=df);","f0016e98":"sns.catplot(x=\"fbs\", y=\"oldpeak\", hue=\"output\", kind=\"strip\", data=df);","45063499":"plt.figure(figsize=(10,6))\nsns.lineplot(x=\"age\",y=\"thalachh\",hue=\"output\",data=df)\nplt.title(\"EFFECT OF HEART ATTACK WITH INCREASE IN AGE AND MAXIMUM HEART RATE\")\nplt.show()","630a795d":"plt.figure(figsize=(10,6))\nsns.lineplot(x=\"age\",y=\"chol\",hue=\"output\",data=df)\nplt.title(\"EFFECT OF HEART ATTACK WITH INCREASE IN AGE AND CHOLESTROL\")\nplt.show()","3fc89617":"sns.set_style('darkgrid')\nfigure = plt.figure(figsize=(20,8))\nsns.countplot(x= 'trtbps',data=df)\n","716c1916":"sns.set_style('darkgrid')\nfigure = plt.figure(figsize=(15,6))\nsns.barplot(x= 'age', y ='thall',data=df,palette='rainbow')","663ad089":"figure = plt.figure(figsize=(12,6))\n\nsns.heatmap(df.corr(),data = df,annot= True,cmap = 'Greys')","b7260caf":"X=df.drop(\"output\",axis=1).values\ny=df[\"output\"].values\nX_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.75)\n","200800dc":"from sklearn.tree import DecisionTreeClassifier\ndt= DecisionTreeClassifier(max_depth=3,random_state=1)\ndt.fit(X_train,y_train)\ny_pred=dt.predict(X_test)\naccuracy_score(y_test,y_pred)","b1ea599e":"from sklearn.ensemble import RandomForestClassifier\nrfc = RandomForestClassifier(n_estimators=400,min_samples_leaf=0.12)\nrfc.fit(X_train,y_train)\ny_pred=rfc.predict(X_test)\naccuracy_score(y_test,y_pred)","8f07c57e":"from xgboost import XGBClassifier\nfrom sklearn.metrics import r2_score\n\nxgb = XGBClassifier(colsample_bylevel= 0.9,\n                    colsample_bytree = 0.8, \n                    gamma=0.99,\n                    max_depth= 5,\n                    min_child_weight= 1,\n                    n_estimators= 8,\n                    nthread= 5,\n                    random_state= 0,\n                    )\nxgb.fit(X_train,y_train)","53e1a89a":"print('Accuracy of XGBoost classifier on training set: {:.2f}'\n     .format(xgb.score(X_train, y_train)))\nprint('Accuracy of XGBoost classifier on test set: {:.2f}'\n     .format(xgb.score(X_test, y_test)))","f098b43e":"y_pred=xgb.predict(X_test)\nprint(\"Accuracy of XG Boost model is:\",\naccuracy_score(y_test, y_pred)*100)","310f535d":"## Import","a580bcf5":"#### Decision tree Classifier","550a0c0f":"## Model Building","2e3a956a":"## EDA","79077567":"#### RandomForest","faf4ce72":"#### XGBOOST\n"}}