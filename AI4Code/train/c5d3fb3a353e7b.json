{"cell_type":{"0a6180dc":"code","a125a680":"code","87b1a352":"code","35274827":"code","f882fc49":"code","c827f6e6":"code","fac3c5dd":"code","9cefe032":"code","362c65da":"markdown","11bddec5":"markdown"},"source":{"0a6180dc":"# General Imports\nimport numpy as np \nimport pandas as pd \nimport os        \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport math\nimport datetime","a125a680":"# Scrape COVID Deaths Data Excel from Swedish Government Site\n\nimport urllib\n\nSWEDEN_DATA_LINK = \"https:\/\/fohm.maps.arcgis.com\/sharing\/rest\/content\/items\/b5e7488e117749c19881cce45db13f7e\/data\"\n\nurllib.request.urlretrieve(SWEDEN_DATA_LINK, \"Sweden_raw_data.xls\")","87b1a352":"# Pull data tabs from excel doc and convert to CSV files\n\n# Total COVID deaths in Sweden per day\nSWEDEN_DEATHS_XLS = pd.read_excel('.\/Sweden_raw_data.xls', 'Antal avlidna per dag', index_col=None)\nSWEDEN_DEATHS_XLS.to_csv('National_Daily_Deaths.csv', encoding='utf-8')\n\n# Total ICU Admissions in Sweden per day\nSWEDEN_ICU_XLS = pd.read_excel('.\/Sweden_raw_data.xls', 'Antal intensivv\u00e5rdade per dag', index_col=None)\nSWEDEN_ICU_XLS.to_csv('National_Daily_ICU_Admissions.csv', encoding='utf-8')\n\n# Total confirmed Cases in Sweden per day per region\nSWEDEN_DAILY_CASES_XLS = pd.read_excel('.\/Sweden_raw_data.xls', 'Antal per dag region', index_col=None)\nSWEDEN_DAILY_CASES_XLS.to_csv('Regional_Daily_Cases.csv', encoding='utf-8')\n\n# Total Cases, ICU Admissions and Deaths in Sweden per age group\nSWEDEN_AGES_XLS = pd.read_excel('.\/Sweden_raw_data.xls', 'Totalt antal per \u00e5ldersgrupp', index_col=None)\nSWEDEN_AGES_XLS.to_csv('National_Total_Deaths_by_Age_Group.csv', encoding='utf-8')\n\n# Total Numbers per Region\nSWEDEN_TOTAL_CASES_XLS = pd.read_excel('.\/Sweden_raw_data.xls', 'Totalt antal per region', index_col=None)\nSWEDEN_TOTAL_CASES_XLS.to_csv('Regional_Totals_Data.csv', encoding='utf-8')\n\n# Gender Data\nSWEDEN_GENDER_DATA_XLS = pd.read_excel('.\/Sweden_raw_data.xls', 'Totalt antal per k\u00f6n', index_col=None)\nSWEDEN_GENDER_DATA_XLS.to_csv('Gender_Data.csv', encoding='utf-8')\n\n# Municipal District Weekly Data\nSWEDEN_MUNICIPALITY_DATA_XLS = pd.read_excel('.\/Sweden_raw_data.xls', 'Veckodata Kommun_stadsdel', index_col=0)\nSWEDEN_MUNICIPALITY_DATA_XLS.to_csv('Municipality_Weekly_Data.csv', encoding='utf-8')","35274827":"# Read CSV Files and assign to variables\n\nSWEDEN_DEATH_DATA = pd.read_csv('.\/National_Daily_Deaths.csv',index_col='Datum_avliden').iloc[:-1].drop(['Unnamed: 0'], axis=1)\nSWEDEN_ICU_DATA = pd.read_csv('.\/National_Daily_ICU_Admissions.csv',index_col='Datum_v\u00e5rdstart').drop(['Unnamed: 0'], axis=1)\nSWEDEN_DAILY_CASES_DATA = pd.read_csv('.\/Regional_Daily_Cases.csv',index_col='Statistikdatum').drop(['Unnamed: 0'], axis=1)\nSWEDEN_AGES_DATA = pd.read_csv('.\/National_Total_Deaths_by_Age_Group.csv',index_col='\u00c5ldersgrupp').iloc[:-1].drop(['Unnamed: 0'], axis=1)\nSWEDEN_REGIONAL_TOTALS_DATA = pd.read_csv('.\/Regional_Totals_Data.csv',index_col='Region').drop(['Unnamed: 0'], axis=1)\nSWEDEN_GENDER_DATA = pd.read_csv('.\/Gender_Data.csv',index_col='K\u00f6n').iloc[:-1].drop(['Unnamed: 0'], axis=1)\nSWEDEN_MUNICIPALITY_DATA = pd.read_csv('.\/Municipality_Weekly_Data.csv',index_col='veckonummer')","f882fc49":"#Convert date based indices to datetimeIndex\n\nSWEDEN_DEATH_DATA.index = pd.to_datetime(SWEDEN_DEATH_DATA.index, format=\"%Y-%m-%d\").rename('Date')\nSWEDEN_ICU_DATA.index = pd.to_datetime(SWEDEN_ICU_DATA.index, format=\"%Y-%m-%d\").rename('Date')\nSWEDEN_DAILY_CASES_DATA.index = pd.to_datetime(SWEDEN_DAILY_CASES_DATA.index, format=\"%Y-%m-%d\").rename('Date')","c827f6e6":"#Translate Swedish to English (excluding regional place names)\n\n# Total Daily Death Data\nSWEDEN_DEATH_DATA.columns = ['National_Daily_Deaths']\n\n# Total Daily ICU Data\nSWEDEN_ICU_DATA.columns = ['National_Daily_ICU_Admissions']\n\n# Total Daily Regional Cases Data\nSWEDEN_DAILY_CASES_DATA = SWEDEN_DAILY_CASES_DATA.rename(columns={SWEDEN_DAILY_CASES_DATA.columns[0]:'Sweden_Total_Daily_Cases'})\n\n# Age Group Data\nSWEDEN_AGES_DATA.index = SWEDEN_AGES_DATA.index.rename('Age_Group')\nSWEDEN_AGES_DATA.columns = ['Total_Cases', 'Total_ICU_Admissions', 'Total_Deaths']\nSWEDEN_AGES_DATA.index = SWEDEN_AGES_DATA.index.map(lambda c : c.strip('\u00c5lder').replace('_','',1).replace('_','-',1).replace('-plus','+'))\n\n# Total Regional Data\nSWEDEN_REGIONAL_TOTALS_DATA.columns = ['Total_Cases', 'Cases_per_100k_Pop', 'Total_ICU_Admissions', 'Total_Deaths']\n\n# Gender Data\nSWEDEN_GENDER_DATA.index = SWEDEN_GENDER_DATA.index.rename('Gender')\nSWEDEN_GENDER_DATA.index = SWEDEN_GENDER_DATA.index.map(lambda c : c.replace('Kvinna','Female').replace('Man','Male'))\nSWEDEN_GENDER_DATA.columns = ['Total_Cases', 'Total_ICU_Admissions', 'Total_Deaths']\n\n# Municipality Weekly Data\nSWEDEN_MUNICIPALITY_DATA = SWEDEN_MUNICIPALITY_DATA.drop(columns=['KnNamn', 'Stadsdel'])\nSWEDEN_MUNICIPALITY_DATA.index = SWEDEN_MUNICIPALITY_DATA.index.rename('Week_Number')\nSWEDEN_MUNICIPALITY_DATA.columns = ['Year','Area_Code', 'Municipality', 'Cumulative_Cases_per_100k_Pop',\n                                    'Weekly_Cases_per_100k_Pop', 'Cumulative_Total_Cases', 'Weekly_Cases']","fac3c5dd":"# Overwrite CSV files with modified indexes & headings\nSWEDEN_DEATH_DATA.to_csv('.\/National_Daily_Deaths.csv')\nSWEDEN_ICU_DATA.to_csv('.\/National_Daily_ICU_Admissions.csv')\nSWEDEN_DAILY_CASES_DATA.to_csv('.\/Regional_Daily_Cases.csv')\nSWEDEN_AGES_DATA.to_csv('.\/National_Total_Deaths_by_Age_Group.csv')\nSWEDEN_REGIONAL_TOTALS_DATA.to_csv('.\/Regional_Totals_Data.csv')\nSWEDEN_GENDER_DATA.to_csv('.\/Gender_Data.csv')\nSWEDEN_MUNICIPALITY_DATA.to_csv('.\/Municipality_Weekly_Data.csv')","9cefe032":"SWEDEN_MUNICIPALITY_DATA","362c65da":"# [Sweden COVID-19 National Statistics](https:\/\/experience.arcgis.com\/experience\/09f821667ce64bf7be6f9f87457ed9aa\/page\/page_0\/) Data Scrape","11bddec5":"7th November 2020\n\nWith European governments struggling with a 'second-wave' of rising cases, hospitalisations and deaths resulting from the [SARS-CoV-2](https:\/\/www.bmj.com\/content\/371\/bmj.m3862) virus (COVID-19), I wanted to make a comparative analysis between the data coming out of major European nations since the start of the pandemic.\n\nIt has been well publicised that Sweden has taken a different approach to most Western European nations when it comes to public policy regarding COVID-19. This has drawn significant attention from across the world and so, allied to the fact that Sweden publishes it's data in a clear and understandable way that is easy to access, it seemed like a good place to start. \n\nThis is a fairly simple notebook that accesses the Excel doc that is linked on the website, does a little English translation and outputs some .csv files. \n\nIn time, I hope to construct other European national datasets for direct comparison - probably starting with my own country, the United Kingdom.\n\nI also should say I am not an Epidemiologist, Sociologist or even a Data Scientist. I am actually a Mechanical Engineer! The objective here is to improve my data science skills and maybe provide some useful data to the wider community.\n\nAny questions, comments or suggestions are most welcome! I am open to requests and collaborations! Stay Safe!\n\n[Official Swedish COVID-19 National Statistics](https:\/\/experience.arcgis.com\/experience\/09f821667ce64bf7be6f9f87457ed9aa\/page\/page_0\/) website (excellent visualisations!)"}}