{"cell_type":{"f64d9f74":"code","c21b8df6":"code","c3c182fd":"code","331fd80c":"code","ea3398b2":"code","4208f099":"code","61e41b4f":"code","497fa25b":"code","2288c8b0":"code","0aaa4cc7":"code","7002354e":"code","258a4dbe":"code","d9b3ae4d":"code","7b7588cf":"code","0d120e3e":"code","1c11d59d":"code","ce649661":"code","ddce2021":"code","7e550d90":"code","f32fac23":"code","5bfc580e":"code","aa0738ad":"code","f208421a":"code","22b776f0":"code","616e67f8":"code","cdfc60e1":"code","4c3e91ed":"code","be98c622":"code","5a1c86f2":"code","ae13d478":"code","623f624e":"code","a24825c4":"code","6aff8aa0":"code","65d5c1f1":"code","b573e5bd":"code","2aa75327":"code","d3c7e832":"code","32b9c61b":"code","884c03c4":"code","050ab581":"code","71468e4a":"code","3efab8b6":"code","6e8f7b85":"code","7b186f2d":"code","2c193e50":"code","7c735817":"code","86363dcb":"code","2eff6b41":"code","76fc7ae6":"code","72abfb2f":"code","66a6fdda":"code","a993eab0":"code","ea6d8106":"markdown","116c80fe":"markdown","c5407580":"markdown","75b529fc":"markdown","54690da5":"markdown","db945268":"markdown","77b8b5f9":"markdown","feb34c42":"markdown","06039b2b":"markdown","a70980b9":"markdown","fba2b47b":"markdown","b45b75dc":"markdown","b82b5644":"markdown","9e337a2f":"markdown","4c6f67eb":"markdown","d3b26c54":"markdown","1c470b7b":"markdown","fcd02b5d":"markdown","f0dc175b":"markdown","2412ca8e":"markdown","0979f98d":"markdown","1c740b63":"markdown"},"source":{"f64d9f74":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","c21b8df6":"#read file\ndf = pd.read_csv('\/kaggle\/input\/montcoalert\/911.csv')","c3c182fd":"df.head()","331fd80c":"print(f'Columns : {df.shape[1]}')\nprint(f'Rows : {df.shape[0]}')","ea3398b2":"#dtypes of features\nfor col in df.columns:\n    print(f'{col} : {df[col].dtype}')","4208f099":"#print percentage of missing values\ndf_miss = pd.DataFrame(columns=['count', 'percetage'])\nfor col in df.columns:\n    df_miss.loc[col] = [df[col].isnull().sum(),(df[col].isnull().sum()\/663522)*100]\ndf_miss    ","61e41b4f":"#visualize missing values\nfig,ax = plt.subplots(figsize=(18,6))\nax = sns.heatmap(df.isnull(),yticklabels=False,cbar=False,cmap='inferno')\nfor label in ax.get_xticklabels():\n    label.set_fontsize(12)","497fa25b":"#convert 'timeStamp' column to DateTime column\ndf['timeStamp'] = pd.to_datetime(df['timeStamp'],format='%Y-%m-%d %H:%M:%S', errors='ignore')","2288c8b0":"print('Zip codes in dataset:')\nprint(df['zip'].nunique())","0aaa4cc7":"df['zip'].value_counts().head(5)","7002354e":"zip_df = pd.DataFrame(df['zip'].value_counts())\nzip_df['index']= zip_df.index.astype('object')\nzip_df.sort_values(by='zip',ascending=False,inplace=True)\n#visualization\nsns.set_style('darkgrid')\nfig,ax = plt.subplots(figsize=(15,9))\nax = sns.barplot(x ='index',y = 'zip',data=zip_df.head(5))\n\n#labels\nax.set_xlabel('Zip Code', fontsize=18,)\nax.set_ylabel('Total Calls',fontsize=18)\n","258a4dbe":"df['twp'].value_counts().head()","d9b3ae4d":"twn_df = pd.DataFrame(df['twp'].value_counts())\ntwn_df['town'] = twn_df.index\nmy_range=list(range(len(twn_df.head(9).index)+1))\n#visualization\nsns.set_style('darkgrid')\nfig,ax = plt.subplots(figsize=(15,9))\nax = sns.countplot(y='twp',data=df,order=df['twp'].value_counts().head(12).index,palette='rocket')\n\n#labels\nax.set_ylabel('', fontsize=15,)\nax.set_xlabel('Total Calls',fontsize=15)\n\n#annotations    \nfor p in ax.patches:\n    ax.annotate(int(p.get_width()),((p.get_x() + p.get_width()), p.get_y()),\n                xytext=(9,-15),fontsize=9,color='#000000',textcoords='offset points', ha='left',va='center',size=12)","7b7588cf":"#create a new dataframe 'reason'\ndf['reason'] = df['title'].apply(lambda title: title.split(':')[0])\n\n#create a new dataframe 'title_category'\ndf['title_category'] = df['title'].apply(lambda title: title.split(':')[1])","0d120e3e":"fig,ax = plt.subplots(figsize=(15,9))\nax = sns.countplot(y='twp',data=df,order=df['twp'].value_counts().head(9).index,hue='reason')","1c11d59d":"print(\"Unique emergency codes: \")\nprint(df['title'].nunique())","ce649661":"reason_df = df.groupby('reason').count()\nreason_df['label'] = reason_df.index\nreason_df = reason_df.sort_values(by='title_category',ascending = False)","ddce2021":"sns.set_style('white')\nfig,ax = plt.subplots(ncols=2,figsize=(18,6))\n\nxrange = np.arange(1,len(reason_df.sum())+1)\n\n#donut chart\ntheme = plt.get_cmap('Blues_r')\nax[0].set_prop_cycle(\"color\", [theme(1. * i \/ len(reason_df))for i in range(len(reason_df))])    \nwedges, texts,_ = ax[0].pie(reason_df['title_category'], wedgeprops=dict(width=0.45), startangle=-90,labels=reason_df.index,\n                  autopct=\"%.1f%%\",textprops={'fontsize': 18,\n                                             'color':'#000000'})\n\n \n\n\nax[1] = sns.barplot(x = 'title_category',y ='label',data =reason_df,palette = 'Blues_r')\nmy_range=list(range(len(reason_df.index)+1))\n\n#labels\nax[1].set_ylabel('', fontsize=15)\nax[1].set_xlabel('Total Calls',fontsize=15)\n\nfor tick in ax[1].get_yticklabels():\n    tick.set_fontsize(15)\nfor tick in ax[1].get_xticklabels():\n    tick.set_fontsize(12)\nsns.despine(right=True, left=True, bottom=True)    \n\n#annotations    \nfor x,y in zip(my_range,reason_df[\"title_category\"]):\n    label = \"{:}\".format(y)\n    plt.annotate(label, # this is the text\n                 (y,x), # this is the point to label\n                  textcoords=\"offset points\",# how to position the text\n                 xytext=(9,0), # distance from text to points (x,y)\n                 ha='left',va=\"center\",size=15) \nplt.tight_layout()   ","7e550d90":"fig,ax = plt.subplots(figsize=(15,9))\nax = sns.countplot(y='title',data=df,order=df['title'].value_counts().head(12).index,palette='inferno')\n#labels\nax.set_ylabel('')\nax.set_xlabel('Total Calls',fontsize=18)\n#despine\nsns.despine(right=True, left=True, bottom=True)   \n#annotations    \nfor p in ax.patches:\n    ax.annotate(int(p.get_width()),((p.get_x() + p.get_width()), p.get_y()),\n                xytext=(9,-15),fontsize=9,color='#000000',textcoords='offset points', ha='left',va='center',size=12)","f32fac23":"def plot_category(cat):\n    filt_ems = df['reason'] == cat\n    fig,ax = plt.subplots(figsize=(15,9))\n    ax = sns.countplot(y='title_category',data=df.loc[filt_ems],\n                       order=df.loc[filt_ems]['title_category'].value_counts().head(12).index,palette='Reds_r')\n    #labels\n    ax.set_ylabel('')\n    ax.set_xlabel('Total Calls',fontsize=18)\n    ax.set_title(f'{cat}',fontsize=18)\n    #despine\n    sns.despine(right=True, left=True, bottom=True)   \n    #annotations    \n    for p in ax.patches:\n        ax.annotate(int(p.get_width()),((p.get_x() + p.get_width()), p.get_y()),\n                    xytext=(9,-15),fontsize=9,color='#000000',textcoords='offset points', ha='left',va='center',size=12)","5bfc580e":"plot_category('EMS')","aa0738ad":"plot_category('Fire')","f208421a":"plot_category('Traffic')","22b776f0":"import calendar \nimport datetime as dt","616e67f8":"#create 'month','dayofweek' and 'hour' columns\ndf['month'] = df['timeStamp'].apply(lambda x: x.month)\ndf['dayofweek'] = df['timeStamp'].apply(lambda x: x.weekday())\ndf['hour'] = df['timeStamp'].apply(lambda x: x.hour)\ndf['date'] = df['timeStamp'].apply(lambda x: x.date())\ndf['year'] = df['timeStamp'].apply(lambda x: x.year)\n#create another column 'Day'\ndf['day'] = df['dayofweek'].apply(lambda x: calendar.day_name[x])\n#create another column 'Month'\ndf['month_name'] = df['month'].apply(lambda x: calendar.month_name[x])","cdfc60e1":"fig,ax = plt.subplots(figsize=(18,9))\nax = sns.countplot(x='month_name',data=df.sort_values(by='month'),palette='inferno')\n#despine\nsns.despine(right=True, left=True, bottom=True)   \n#annotations    \nfor p in ax.patches:\n    ax.annotate(format(p.get_height(), '.2f'), \n                   (p.get_x() + p.get_width() \/ 2., p.get_height()), \n                   ha = 'center', va = 'center', \n                   xytext = (0, 9), \n                   textcoords = 'offset points',size=12)\nfor tick in ax.get_yticklabels():\n    tick.set_fontsize(12)\nfor tick in ax.get_xticklabels():\n    tick.set_fontsize(15) \n#labels\nax.set_xlabel('')\nax.set_ylabel('Total Calls',fontsize=18)","4c3e91ed":"#groupby 'month' and 'reason' \nreason_month_grp = df.groupby(['reason','month']).count()\nreason_month_grp =reason_month_grp.reset_index()","be98c622":"#split each reason \nems_month = reason_month_grp[reason_month_grp['reason'] == 'EMS']\nfire_month = reason_month_grp[reason_month_grp['reason'] == 'Fire']\ntraffic_month = reason_month_grp[reason_month_grp['reason'] == 'Traffic']","5a1c86f2":"fig,ax = plt.subplots(figsize=(18,9))\nplt.style.use('fivethirtyeight')\nax = sns.lineplot(x='month',y='lat',data = ems_month,label='EMS')\nax = sns.lineplot(x='month',y='lat',data = fire_month,label='Fire')\nax = sns.lineplot(x='month',y='lat',data = traffic_month,label='Traffic')\nsns.despine(right=True, left=True, bottom=True) \nax.set_ylabel('')\nax.set_title('Time-Series plot Monthy calls')","ae13d478":"sns.set_style('white')\n\nfig,ax = plt.subplots(figsize=(18,9))\nax = sns.countplot(x='day',data=df.sort_values(by='dayofweek'),palette='viridis')\n#despine\nsns.despine(right=True, left=True, bottom=True)   \n#annotations    \nfor p in ax.patches:\n    ax.annotate(format(p.get_height(), '.2f'), \n                   (p.get_x() + p.get_width() \/ 2., p.get_height()), \n                   ha = 'center', va = 'center', \n                   xytext = (0, 9), \n                   textcoords = 'offset points',size=15)\nfor tick in ax.get_yticklabels():\n    tick.set_fontsize(12)\nfor tick in ax.get_xticklabels():\n    tick.set_fontsize(15) \n#labels\nax.set_xlabel('')\nax.set_ylabel('Total Calls',fontsize=18)","623f624e":"#groupby 'dayofweek' and 'reason' \nreason_day_grp = df.groupby(['reason','dayofweek']).count()\nreason_day_grp =reason_day_grp.reset_index()","a24825c4":"#split each reason \nems_day = reason_day_grp[reason_day_grp['reason'] == 'EMS']\nfire_day = reason_day_grp[reason_day_grp['reason'] == 'Fire']\ntraffic_day = reason_day_grp[reason_day_grp['reason'] == 'Traffic']","6aff8aa0":"sns.set_style('white')\nfig,ax = plt.subplots(figsize=(18,9))\nplt.style.use('fivethirtyeight')\nax = sns.lineplot(x='dayofweek',y='lat',data = ems_day,label='EMS')\nax = sns.lineplot(x='dayofweek',y='lat',data = fire_day,label='Fire')\nax = sns.lineplot(x='dayofweek',y='lat',data = traffic_day,label='Traffic')\nsns.despine(right=True, left=True, bottom=True) \nax.set_ylabel('')\nax.set_title('Time-Series plot Daily calls')","65d5c1f1":"sns.set_style('white')\n\nfig,ax = plt.subplots(figsize=(18,9))\nax = sns.countplot(x='hour',data=df.sort_values(by='hour'),palette='twilight_r')\n#despine\nsns.despine(right=True, left=True, bottom=True)   \n#annotations    \nfor p in ax.patches:\n    ax.annotate(format(p.get_height(), '.2f'), \n                   (p.get_x() + p.get_width() \/ 2., p.get_height()), \n                   ha = 'center', va = 'center', \n                   xytext = (0, 9), \n                   textcoords = 'offset points',size=12)\nfor tick in ax.get_yticklabels():\n    tick.set_fontsize(12)\nfor tick in ax.get_xticklabels():\n    tick.set_fontsize(15) \n#labels\nax.set_xlabel('Hour',fontsize=18)\nax.set_ylabel('Total Calls')\n","b573e5bd":"#groupby 'hour' and 'reason' \nreason_hour_grp = df.groupby(['reason','hour']).count()\nreason_hour_grp =reason_hour_grp.reset_index()","2aa75327":"#split each reason \nems_hour = reason_hour_grp[reason_hour_grp['reason'] == 'EMS']\nfire_hour = reason_hour_grp[reason_hour_grp['reason'] == 'Fire']\ntraffic_hour = reason_hour_grp[reason_hour_grp['reason'] == 'Traffic']","d3c7e832":"sns.set_style('white')\nfig,ax = plt.subplots(figsize=(18,9))\nplt.style.use('fivethirtyeight')\nax = sns.lineplot(x='hour',y='lat',data = ems_hour,label='EMS')\nax = sns.lineplot(x='hour',y='lat',data = fire_hour,label='Fire')\nax = sns.lineplot(x='hour',y='lat',data = traffic_hour,label='Traffic')\nsns.despine(right=True, left=True, bottom=True) \nax.set_ylabel('')\nax.set_title('Time-Series plot Hourly calls')","32b9c61b":"#create date dataframe\ndf_date = df.groupby(['date','reason']).count()\ndf_date = df_date.reset_index()","884c03c4":"df_date_ems = df_date[df_date['reason']=='EMS']\ndf_date_fire = df_date[df_date['reason']=='Fire']\ndf_date_traffic = df_date[df_date['reason']=='Traffic']","050ab581":"sns.set_style('darkgrid')\nfig,ax = plt.subplots(figsize=(18,9))\nplt.style.use('seaborn')\nax = sns.lineplot(x='date',y='lat',data = df_date_ems,label='EMS')\nsns.despine(right=True, left=True, bottom=True) \nax.set_ylabel('')\nax.set_xlabel('')\nax.set_title('Time-Series plot of EMS calls',size=15)\nfor tick in ax.get_yticklabels():\n    tick.set_fontsize(12)\nfor tick in ax.get_xticklabels():\n    tick.set_fontsize(15) ","71468e4a":"sns.set_style('darkgrid')\nfig,ax = plt.subplots(figsize=(18,9))\nplt.style.use('seaborn')\nax = sns.lineplot(x='date',y='lat',data = df_date_fire,label='Fire',color=\"#e37d00\")\nsns.despine(right=True, left=True, bottom=True) \nax.set_ylabel('')\nax.set_xlabel('')\nax.set_title('Time-Series plot of Fire calls',size=15)\nfor tick in ax.get_yticklabels():\n    tick.set_fontsize(12)\nfor tick in ax.get_xticklabels():\n    tick.set_fontsize(15) ","3efab8b6":"sns.set_style('darkgrid')\nfig,ax = plt.subplots(figsize=(18,9))\nplt.style.use('seaborn')\nax = sns.lineplot(x='date',y='lat',data = df_date_traffic,label='Traffic',color=\"#b30000\")\nsns.despine(right=True, left=True, bottom=True) \nax.set_ylabel('')\nax.set_xlabel('')\nax.set_title('Time-Series plot of Traffic calls',size=15)\nfor tick in ax.get_yticklabels():\n    tick.set_fontsize(12)\nfor tick in ax.get_xticklabels():\n    tick.set_fontsize(15) ","6e8f7b85":"#create 'day' X 'hour' matrix\ndf_day_hour = df.groupby(['dayofweek','hour']).count()['lat'].unstack()","7b186f2d":"dict_weekday={\n    0:'Monday',\n    1:'Tuesday',\n    2:'Wednesday',\n    3:'Thursday',\n    4:'Friday',\n    5:'Saturday',\n    6:'Sunday'\n}","2c193e50":"#rename index\ndf_day_hour = df_day_hour.rename(index=dict_weekday)","7c735817":"#plot heatmap\nfig,ax = plt.subplots(figsize=(18,9))\nax = sns.heatmap(df_day_hour,annot=False,cmap=\"OrRd\",)\nfor item in ax.get_yticklabels():\n    item.set_rotation(0)\nax.set_xlabel('')\nax.set_ylabel('')\n\n#ticksize\nfor tick in ax.get_xticklabels():\n    tick.set_fontsize(15)\nfor tick in ax.get_yticklabels():\n    tick.set_fontsize(15)  ","86363dcb":"#create 'day' X 'hour' matrix\ndf_month_day = df.groupby(['dayofweek','month']).count()['lat'].unstack()","2eff6b41":"dict_month = {\n    1:'January',\n    2:'February',\n    3:'March',\n    4:'April',\n    5:'May',\n    6:'June',\n    7:'July',\n    8:'August',\n    9:'September',\n    10:'October',\n    11:'November',\n    12:'December',\n}","76fc7ae6":"#rename index\ndf_month_day = df_month_day.rename(index=dict_weekday)\ndf_month_day = df_month_day.rename(columns=dict_month)","72abfb2f":"#plot heatmap\nfig,ax = plt.subplots(figsize=(18,9))\nax = sns.heatmap(df_month_day.transpose(),annot=False,cmap=\"OrRd\",)\nfor item in ax.get_yticklabels():\n    item.set_rotation(0)\nax.set_xlabel('')\nax.set_ylabel('')\n#ticksize\nfor tick in ax.get_xticklabels():\n    tick.set_fontsize(15)\nfor tick in ax.get_yticklabels():\n    tick.set_fontsize(15) ","66a6fdda":"#create 'year' X 'month' matrix\ndf_year_month = df.groupby(['year','month']).count()['lat'].unstack()\n#rename\ndf_year_month.rename(columns=dict_month,inplace=True)","a993eab0":"#plot heatmap\nfig,ax = plt.subplots(figsize=(18,9))\nax = sns.heatmap(df_year_month,annot=False,cmap=\"OrRd\",)\nfor item in ax.get_yticklabels():\n    item.set_rotation(0)\nax.set_xlabel('')\nax.set_ylabel('')\n#ticksize\nfor tick in ax.get_xticklabels():\n    tick.set_fontsize(15)\nfor tick in ax.get_yticklabels():\n    tick.set_fontsize(15)    ","ea6d8106":"#### Which features contain blank, null or empty values?","116c80fe":"## **Heatmap**","c5407580":"#### Time series plot of EMS calls","75b529fc":"### Time Series analysis","54690da5":"#### Top reasons for 911 emergency calls","db945268":"#### What is the most common Reason for a 911 call based off of this new column?","77b8b5f9":"#### Time series plot of Traffic calls","feb34c42":"#### Which features are numerical?\n<ul>\n    <li>lat \n    <li>lng         \n    <li>zip\n    <li>timeStamp   \n","06039b2b":"#### Total phone calls by day","a70980b9":"#### Time series plot of Fire calls","fba2b47b":"#### Total phone calls by hour","b45b75dc":"#### How many unique title of emergency codes are there?","b82b5644":"#### What are the top 5 zip codes for 911 calls?","9e337a2f":"#### How many rows and columns does the dataset have?","4c6f67eb":"#### Day\/Hour heatmap","d3b26c54":"#### Which features are categorical?\n<ul>\n    <li>desc\n    <li>title\n    <li>tmp\n    <li>addr\n    <li>e   ","1c470b7b":"#### Month\/Day heatmap","fcd02b5d":"#### How many zip codes does the dataset have?","f0dc175b":"#### What are the top 5 townships (twp) for 911 calls?","2412ca8e":"#### Year\/Month heatmap","0979f98d":"#### Total phone calls by month","1c740b63":"#### Top reasons for emergency calls in each category"}}