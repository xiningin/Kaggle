{"cell_type":{"1d30fcc8":"code","933e21a1":"code","3eed0bf8":"code","f7c701db":"code","49d4fd03":"code","cce2327e":"code","46e824d9":"code","5432bedd":"code","fc9537d8":"code","75ced84d":"code","3de7da41":"code","6c6f77bc":"code","0613f720":"code","0fd9995c":"code","0d5c2284":"code","238b2301":"code","90757466":"code","a5bb7d9d":"code","8e0633b8":"code","f6736842":"code","474a2b39":"code","81bd60fe":"code","d0fdebff":"code","e481b8a2":"code","44862d02":"code","4dde22c5":"code","7a763bb2":"code","4cf89cdd":"code","6953e581":"code","98421363":"code","d8fb5155":"code","2c20d07a":"code","d134e977":"code","d78386e5":"code","fa61af0f":"code","eb55af9d":"code","df7520d9":"code","8bd3424f":"code","c4b1ff6b":"code","26d4ef1d":"code","fbd87a69":"code","c92294cf":"code","53b07c18":"code","8ad1e4a7":"code","6086fe5a":"code","d7fd48bc":"code","d29fe839":"code","c97a29bb":"code","70139593":"code","c591f814":"code","1c408841":"code","5f3456e1":"code","acf05a35":"code","8363de0a":"code","e46ea807":"code","214f68da":"code","e7d1ec79":"code","1dac8b00":"code","0dbafcd8":"code","1d781432":"code","622041b7":"code","a487e8c1":"code","b224269e":"code","d33fcea4":"code","8d2a3e4a":"code","3260608a":"code","09767f8c":"code","3da6a87f":"code","c6a3dd1e":"code","d2f86353":"code","90d616b8":"markdown","a5a25193":"markdown","46c79c02":"markdown","43a0db8e":"markdown","35947719":"markdown","88089aea":"markdown","982e4070":"markdown","ea0bd4ae":"markdown","0e905f3f":"markdown","9c1702b1":"markdown","7682fdfd":"markdown","915d6b0f":"markdown","aa60b013":"markdown","bb02c23a":"markdown","f9460b93":"markdown","22168fac":"markdown","6a31bc9e":"markdown","c4e9cf81":"markdown","d7f287c1":"markdown","66d6c281":"markdown","37004366":"markdown","762bc19a":"markdown","8641be09":"markdown","cf7c65db":"markdown","75971c13":"markdown","46ee57da":"markdown","66d4d1c7":"markdown","eb883ede":"markdown","72829f75":"markdown","f9823c20":"markdown","a0443bb9":"markdown"},"source":{"1d30fcc8":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","933e21a1":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport cufflinks as cf\nfrom plotly.offline import download_plotlyjs,init_notebook_mode,plot,iplot\ninit_notebook_mode(connected=True)\ncf.go_offline()\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LogisticRegressionCV\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import confusion_matrix,classification_report,plot_confusion_matrix\nfrom sklearn.metrics import plot_precision_recall_curve,plot_roc_curve\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.svm import SVC","3eed0bf8":"def resizeplot(l,a,d):\n    plt.figure(figsize=(l,a),dpi=d)","f7c701db":"df = pd.read_csv('\/kaggle\/input\/heart-attack-prediction\/data.csv')","49d4fd03":"df.head()","cce2327e":"df.isnull().sum()","46e824d9":"df.info()","5432bedd":"df = df.replace({'?':np.nan})","fc9537d8":"df = df.rename(columns={'num       ':'num'})","75ced84d":"df.head()","3de7da41":"df.drop('ca',inplace=True,axis=1)","6c6f77bc":"from sklearn.impute import KNNImputer","0613f720":"inputer_int = KNNImputer(missing_values=np.nan)","0fd9995c":"df.iloc[:,3:9] = inputer_int.fit_transform(df.iloc[:,3:9])","0d5c2284":"df.iloc[:,10:12] = inputer_int.fit_transform(df.iloc[:,10:12])","238b2301":"df.iloc[:,10:12] = round(df.iloc[:,10:12])","90757466":"df.head()","a5bb7d9d":"resizeplot(10,6,100)\nsns.histplot(df['age'],kde=True,bins=50)","8e0633b8":"resizeplot(10,6,80)\nsns.boxplot(x='sex',y='age',data=df)","f6736842":"correl = df.corr()","474a2b39":"resizeplot(12,6,80)\nsns.heatmap(correl, annot=True)","81bd60fe":"df[['age','trestbps','thalach']].iplot()","d0fdebff":"resizeplot(17,6,80)\nsns.barplot(y='age',x='trestbps',data=df)","e481b8a2":"df[['chol','thalach']].iplot(kind='spread')\nimport numpy as np","44862d02":"sns.pairplot(df[['age','trestbps','chol','thalach','num']],hue='num')","4dde22c5":"resizeplot(10,6,60)\nsns.boxplot(x='sex',y='chol',data=df)","7a763bb2":"resizeplot(10,6,60)\nsns.barplot(x='sex',y='fbs',data=df)","4cf89cdd":"resizeplot(10,6,60)\nsns.barplot(x='exang',y='chol',data=df)","6953e581":"df.groupby('exang').mean().iplot(kind='bar')","98421363":"df.groupby('cp').mean().iplot(kind='bar')","d8fb5155":"from sklearn.model_selection import train_test_split","2c20d07a":"X = df.drop('num',axis=1)\ny = df['num']\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=100)","d134e977":"scaler = StandardScaler()","d78386e5":"scaled_X_train = scaler.fit_transform(X_train)","fa61af0f":"scaled_X_test = scaler.transform(X_test)","eb55af9d":"model_log = LogisticRegressionCV()","df7520d9":"model_log.fit(scaled_X_train,y_train)","8bd3424f":"model_log.C_","c4b1ff6b":"model_log.coef_","26d4ef1d":"coefi = pd.Series(index=X.columns,data=model_log.coef_[0])","fbd87a69":"coefi","c92294cf":"resizeplot(10,6,60)\ncoefi = coefi.sort_values()\nsns.barplot(x=coefi.index,y=coefi.values)","53b07c18":"y_pred = model_log.predict(scaled_X_test)","8ad1e4a7":"confusion_matrix(y_test,y_pred)","6086fe5a":"plot_confusion_matrix(model_log,scaled_X_test,y_test)","d7fd48bc":"print(classification_report(y_test,y_pred))","d29fe839":"plot_precision_recall_curve(model_log,scaled_X_test,y_test)","c97a29bb":"plot_roc_curve(model_log,scaled_X_test,y_test)","70139593":"patient = [[55.,1.,0.,122.,286.,0.,0.,115.,1.,3.2,1.,2.]]","c591f814":"model_log.predict(patient)","1c408841":"model_log.predict_proba(patient)","5f3456e1":"knn = KNeighborsClassifier()","acf05a35":"operators = [('scaler',scaler),('knn',knn)]","8363de0a":"pipe = Pipeline(operators)","e46ea807":"k_values = list(range(1,30))\nparam_grid = {'knn__n_neighbors':k_values}\nfull_cv_classifier = GridSearchCV(pipe,param_grid,cv=5,scoring='accuracy')","214f68da":"full_cv_classifier.fit(X_train,y_train)","e7d1ec79":"y_pred_knn = full_cv_classifier.predict(X_test)","1dac8b00":"print(classification_report(y_test,y_pred_knn))","0dbafcd8":"model_dt = DecisionTreeClassifier()","1d781432":"model_dt.fit(X_train,y_train)","622041b7":"pred_dt = model_dt.predict(X_test)","a487e8c1":"print(classification_report(y_test,pred_dt))","b224269e":"plot_confusion_matrix(model_dt,X_test,y_test)","d33fcea4":"svc = SVC(C=0.1,class_weight='balanced')","8d2a3e4a":"param_grid_svc = {'C':[0.001,0.01,0.1,0.5,1]}\ngrid_svc = GridSearchCV(svc,param_grid_svc)","3260608a":"grid_svc.fit(scaled_X_train,y_train)","09767f8c":"grid_svc.best_params_","3da6a87f":"grid_pred_svc = grid_svc.predict(scaled_X_test)","c6a3dd1e":"print(classification_report(y_test,grid_pred_svc))","d2f86353":"plot_confusion_matrix(grid_svc,scaled_X_test,y_test)","90d616b8":"**Right, first we remove the \"ca\" feature because its technically irrelevant to our data, **\n**And then fill the missing data with knn inputer predictions**","a5a25193":"# **Logistic Regression Model**","46c79c02":"**A comparison between the sex of individuals with regard to fasting blood sugar. We also observed a high standard deviation compared to that of men with a very high standard deviation among women.**","43a0db8e":"**What we did above was to transform the character \"?\" and turn it into Nan, and in the column 'one' that is extremely important for our future analysis we remove unnecessary spaces.**","35947719":"[![naom_5e298a0ba9c59.jpg](attachment:naom_5e298a0ba9c59.jpg)]","88089aea":"**Below, people with exercise-induced angina according to cholesterol levels. The slight majority had effects of angina.**","982e4070":"**First, let's import our main libraries.**","ea0bd4ae":"**As much as people have high levels of high cholesterol, heart rate does not vary as much as we previously considered.**","0e905f3f":"**Ok, let's start to analisys seen some graphs**","9c1702b1":"# Decision Tree Classifier","7682fdfd":"**Lets create the recall curves precisions.**","915d6b0f":"**Another interesting plot, regardless of the individual's gender, cholesterol levels are very approximate.**","aa60b013":"**A visualization grouped by induced angina shows a high comparison with high cholesterol and other features and a high risk of heart attack.**\n\n**Select one of the features to interact with the chart.**","bb02c23a":"**We will fill these missing data with the knn algorithm.**","f9460b93":"# SVC","22168fac":"**Apparently we don't have missing data but we have \"?\", Let's deal with them.**","6a31bc9e":"**Below, we can observe the relationship between resting blood pressure, maximum heart rate, age, cholesterol and the risk of heart disease.**","c4e9cf81":"**Here is a plot that always brings us good observations, a positive and considerable correlation between individuals who had induced angina (exang) and ST depression (oldpeak) which makes sense since ST depression is basically a stress test where observes in its recovery phase.**","d7f287c1":"**Cardiovascular diseases are a set of problems that affect the heart and blood vessels, and that arise with age, usually related to unhealthy lifestyle habits, such as high-fat diet and lack of physical activity, for example. However, cardiovascular diseases can also be diagnosed at birth, as is the case with congenital heart diseases.**\n**It is important that cardiovascular diseases are properly treated because, in addition to causing uncomfortable symptoms, such as shortness of breath, chest pain or swelling in the body, they are also the main cause of death in the world.**\n\n**Let's check it out.**","66d6c281":"**In this boxplot, we observed a greater number of male people, however with an average age of approximately.\nThis may not seem like it, but it is fundamental information for our future observations.**","37004366":"**As we can see, Logistic Regression was our winning algorithm, followed by SVC and Decision Tree and the worst result was with KNN. This classifying score pointed out the risk of having a heart attack based on the information passed and observed by the graphs. Our Knn inputer algorithm was decisive in filling in the missing data since it is not very safe to always fill in this data with the averages of the information.**\n\n***Well guys, that's it. I hope you enjoyed this notebook, study, be well and if you liked it please give an UPVOTE.***\n\n**See you!**","762bc19a":"**Here we have a relationship between age and resting blood pressure. Note that regardless of age, blood pressures vary widely.**","8641be09":"**Wide variation of ages but with a dense number of people over 45 in this data.**","cf7c65db":"**Here we have a function that will help us to control the dimensions of our graphics. **","75971c13":"**Load the dataset.**","46ee57da":"**Hummm, let's keep digging.**","66d4d1c7":"# **Kneighbors Classifier**","eb883ede":"**Lets check if our model is predicting the right(or possibles) values from a random patient.**","72829f75":"**Let's go to the models, however, what I could do to improve the predictions would be to separate them into groups according to the graph above because we would analyze the situations on a case by case basis, but as this dataset is small, this would compromise the result of our models, so we will do with the entire dataset.**","f9823c20":"**Before looking at the graph below, let's clarify a few points: blood pressure is a measure of the strength of the blood flowing against the walls of the arteries, the heart rate, also called the pulse, is the number of times the heart beats every minute . Low blood pressure and low heart rate do not always indicate problems to the individual; Between these two, high blood pressure is the main factor of stroke and heart attack.\nConsidering the blue peaks, these, from a superficial analysis, should pay attention to your health.**","a0443bb9":"**Let's look at this data from another angle. Perhaps this is the most decisive. - why didn't I start the analysis with him?\nHere we have grouped on a scale of 1 to 4 for angina (1 = typical angina; 2 = atypical angina; 3 = non-anginal pain; 4 = asymptomatic) people related to number 4 did not show signs of angina, however, high cholesterol, high blood pressure at rest, relatively normal heart rate compared to others, and increased risk of heart attack. What does all this tell us?\nAtherosclerosis, for example, is a progressive disease and can affect all arteries in the body.\nHowever, their symptoms are often \u201cignored\u201d the reason for this is the lack of knowledge and dissemination.\nMany people have no complaints at first, however, after being examined and a change in the arteries of the leg and \/ or arm is found, they confirm that they had symptoms.**"}}