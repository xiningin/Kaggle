{"cell_type":{"a88bd336":"code","94f15188":"code","322b447f":"code","87f80f2f":"code","55850bb7":"code","0dacead0":"code","d1f3a11e":"code","3c096664":"code","0c2530f7":"code","7bc682a7":"code","f78b92b0":"code","a928d54d":"code","2b220c79":"code","f180d96a":"code","8cd63200":"code","0ba935bd":"code","128fdfe5":"markdown","494c687e":"markdown","0b1b370d":"markdown","bbed13d3":"markdown","32ccb2dc":"markdown","e82effca":"markdown"},"source":{"a88bd336":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport warnings\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\nwarnings.filterwarnings(\"ignore\")\nimport os\nprint(os.listdir(\"..\/input\"))\n\n\n\n# Any results you write to the current directory are saved as output.","94f15188":"data = pd.read_csv(\"..\/input\/Mall_Customers.csv\")\n\npd.set_option('display.max_columns', 10)\n\nprint(\"Data Sample\\n{}\\n\".format(data.head()))\nprint(\"Data description\\n{}\\n\".format(data.describe()))\nprint(\"Data types\\n{}\\n\". format(data.dtypes))","322b447f":"# getting the list of columns\n\ncolumns = data.columns\n\nprint(columns)","87f80f2f":"import matplotlib.pyplot as plt\nimport seaborn as sns\n\nn=0\n\nplt.figure(1, figsize = (25,6))\n\nfor i in ['Age', 'Annual Income (k$)','Spending Score (1-100)']:\n    n = n+1\n    plt.subplot(1,3,n)\n    plt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n    sns.distplot(data[i], bins=20)\n    plt.title(\"Distplot of {}\".format(i))\nplt.show()","55850bb7":"# plot of Male count Vs Female count\nplt.figure(1, figsize = (10,5))\nsns.countplot(y = 'Gender', data = data)\nplt.show()","0dacead0":"# plotting [Age, income, spending score] with one another\n\nplt.figure(1, figsize = (25,25))\nn = 0\n\nfor x in ['Age', 'Annual Income (k$)', 'Spending Score (1-100)']:\n    for y in ['Age', 'Annual Income (k$)', 'Spending Score (1-100)']:\n        if( x != y ):\n            n = n + 1\n            plt.subplot(3, 3, n)\n            plt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n            sns.regplot(x = x, y = y, data = data)\n            plt.title(\"Plot of {} vs {}\".format(x,y))\n\nplt.show()","d1f3a11e":"# plotting Age vs Annual income wrt Gender\n\nplt.figure(1, figsize = (25,25) )\nn = 0\n\nfor x in ['Age', 'Annual Income (k$)', 'Spending Score (1-100)']:\n    for y in ['Age', 'Annual Income (k$)', 'Spending Score (1-100)']:\n        if( x != y ):\n            n = n + 1\n            plt.subplot(3, 3, n)\n            plt.subplots_adjust(hspace = 0.5, wspace = 0.5)\n            for gender in ['Male', 'Female']:\n                sns.regplot(x = x, y = y, data = data[ data['Gender'] == gender ], label = gender)\n                plt.title(\"{} vs {} wrt Gender\".format(x,y))\nplt.legend()\nplt.show()","3c096664":"# applying Elbow method to calculate the optimum K\nfrom sklearn.cluster import KMeans\nfrom scipy.spatial.distance import cdist\n\nattr = ['Annual Income (k$)', 'Spending Score (1-100)']\n\nK = range(1,10)\ndistorts = []\nfor k in K:\n    kmeans = KMeans(k)\n    kmeans.fit(data[attr])\n    distorts.append(sum(np.min(cdist(data[attr], kmeans.cluster_centers_, 'euclidean'), axis=1)) \/ data.shape[0])\n\nplt.plot(K, distorts)\nplt.xlabel('K')\nplt.ylabel('Distortions')\nplt.title(\"Plot for K vs Distortions\")","0c2530f7":"# Applying K means clustering on Annual Income and Spending score\n\nattr = ['Annual Income (k$)', 'Spending Score (1-100)']\n\n# From the result of the elbow algorithm, the elbow occurs at K = 5\n\nN = 5\n\nkmeans = KMeans(n_clusters = 5 ,init='k-means++', n_init = 10 ,max_iter=300,\n                tol=0.0001,  random_state= 111  , algorithm='elkan')\n\nkmeans.fit(data[attr])\n\ncentroids = kmeans.cluster_centers_\n\nprint(\"The centroids are:{}\".format(centroids))\n\ncluster = kmeans.fit_predict(data[attr])\n\ndata['cluster'] = cluster","7bc682a7":"# visualising the clusters and the centroids.\n\n\nfor c in range(0,5):\n    plt.scatter(x = data[data['cluster'] == c]['Annual Income (k$)'], \n               y = data[data['cluster'] == c]['Spending Score (1-100)'], label = 'Cluster{}'.format(c))\n\nfor c in range(0,5):\n    plt.scatter(x = centroids[c][0], \n               y = centroids[c][1],s = 300, label = 'Centroid{}'.format(c))\n    \nplt.title(\"Cluster plot of Annual income vs Spending Score\")\nplt.xlabel('Annual Income (k$)')\nplt.ylabel('Spending Score (1-100)')\nplt.legend()\nplt.show()","f78b92b0":"# count plot of all the clusters\n\nplt.figure(1, figsize = (10,6))\nsns.countplot(y = 'cluster', data = data)\nplt.title('Count plot of cusomters wrt clusters')\nplt.show()","a928d54d":"# Analysis of the customers belonging to \"High spending score and low income\" cluster, aka cluster1\n\ndata_c0 = data[data['cluster'] == 0]\ndata_c0.head(10)","2b220c79":"\ndata_c1 = data[data['cluster'] == 1]\ndata_c1.head(10)","f180d96a":"# analysing the age distribution of cluster 0 data wrt gender\n\nplt.figure(1, figsize = (10,6))\nfor gender in ['Male', 'Female']:\n    sns.distplot(data_c0[data_c0['Gender'] == gender]['Age'], hist=False, rug = True, label=gender)\nplt.title('Age distribution for Cluster 0 cusomters wrt Gender')\nplt.legend()\nplt.show()","8cd63200":"# Visualizing Spending score distribution of cluster 0 customers wrt gender\n\nplt.figure(1, figsize = (10,6))\nfor gender in ['Male', 'Female']:\n    sns.distplot(data_c0[data_c0['Gender'] == gender]['Spending Score (1-100)'], hist=False, rug = True, label=gender)\nplt.title('Spending Score distribution for Cluster 0 cusomters wrt Gender')\nplt.legend()\nplt.show()","0ba935bd":"# analysing the age distribution of cluster 1 data wrt gender\n\nplt.figure(1, figsize = (10,6))\nfor gender in ['Male', 'Female']:\n    sns.distplot(data_c1[data_c1['Gender'] == gender]['Age'], hist=False, rug = True, label=gender)\nplt.title('Age distribution for Cluster 0 cusomters wrt Gender')\nplt.legend()\nplt.show()","128fdfe5":"**Problem statement:** Analyse the data and draw inferences from the shopping behavior of a group of customers. Also, to write an prediction module to predict what kind of shopping habits would a given customer have.","494c687e":"We can hence cluster a set of customers into 5 groups based on their income and shopping behavior.\n\nThe above plot visualisation produces the following information\n\n1. The data is clustered into 5 types of customer:\n    1. High spending score & low income\n    2. High spending score & high income\n    3. Medium spending score & medium income\n    4. low spending score & low income\n    5. low spending score & high income\n2. The customers within the \"High income\" group should be targetted for serious advertising.\n3. The customers within the \"high spending score and low income\" should be analysed wrt Gender and Age, to understand the expenditure trends of the \"low income\" group of customers.","0b1b370d":"From the above visualisations, the following inferences can be drawn.\n\n1. The cusotmers can be clustered on the basis of Annual income and spending score, wrt gender.\n2. Gender probably doesn't have much effect on clustering customers based on Annual Income and spending score\n3. Spending score drops significantly more with increasing Age in FEMALES than in MALES\n4. Trends in Spending score vs Annual income vs Age wrt gender can be studied.","bbed13d3":"**Loading and Describing the data**\nWe should first load the data, and describe the data statistically. This will help us understand the data and the data types.","32ccb2dc":"**Conclusion**\n\nWe draw the following set of conclusions from the notebook:\n1. The customers within cluster 0 has more FEMALE spenders than MALE spenders within the range of 18-25.\n2. However the spending score of both the gender groups are more or less similar for cluster 0 and cluster 1.\n3. The most valuable customers are those with \"high income and high spending score\"\n4. Also, the customers belonging to \"medium income medium spending score\" are significantly high in number, meaning that the revenue generated from them would be significatly high\n\nHence, we can conclude, that the most valuable customers for the mall are those with \"medium income medium spending\" and \"high income high spending\".","e82effca":"**Data Visualisation**\n\nNow that we have looked at the data, it's time we visualize the data, to view the correlation of the attributes with other attributes. This way we can analyse the data."}}