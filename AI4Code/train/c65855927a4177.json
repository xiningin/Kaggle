{"cell_type":{"a85299c4":"code","7c1ac56b":"code","7c59316b":"code","ee95120e":"code","3319c2f5":"code","57a39ccf":"code","d19a36dd":"code","aaac998c":"code","f2954126":"code","f5248e07":"code","e39bb9e3":"code","ccf0b67e":"code","4e0265c9":"code","0a2cc6d6":"code","3ee6b6c8":"code","cd5d57b7":"code","528d0473":"code","e5ba4c06":"code","3cc6fa16":"markdown","f90a2f7c":"markdown"},"source":{"a85299c4":"import h2o\nfrom h2o.automl import H2OAutoML\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","7c1ac56b":"pd.set_option('display.max_columns', 100)","7c59316b":"train = pd.read_csv(\"..\/input\/tabular-playground-series-mar-2021\/train.csv\")\ntrain","ee95120e":"train.target.value_counts().to_frame()","3319c2f5":"h2o.init(max_mem_size='12G', nthreads=4)","57a39ccf":"train = h2o.import_file(\"..\/input\/tabular-playground-series-mar-2021\/train.csv\")\ntest = h2o.import_file(\"..\/input\/tabular-playground-series-mar-2021\/test.csv\")\n\nx = train.columns\ny = \"target\"\n#x = x.drop(\"target\").column\n#x.remove(y)\n\n# Identify predictors and response\nx.remove(y)\n\n# For binary classification, response should be a factor\ntrain[y] = train[y].asfactor()\n#test[y] = test[y].asfactor()\n\n\n#train = h2o.H2OFrame(train)","d19a36dd":"object_columns = x[:19]\nfor f in object_columns:\n    train[f] = train[f].asfactor()\n    test[f] = test[f].asfactor()","aaac998c":"train","f2954126":"test","f5248e07":"'''\n# create a fold column with 5 folds\n# randomly assign fold numbers 0 through 4 for each row in the column\nfold_numbers = train.kfold_column(n_folds = 5, seed = 1234)\n\n# rename the column \"fold_numbers\"\nfold_numbers.set_names([\"fold_numbers\"])\n\n\n# append the fold_numbers column to the cars dataset\ntrain = train.cbind(fold_numbers)# append the fold_numbers column to the cars dataset\ntrain = train.cbind(fold_numbers)\n'''\n# set the number of folds for you n-fold cross validation:\nfolds = 10\n# folds = 10","e39bb9e3":"# Run AutoML for 20 base models (limited to 1 hour max runtime by default)\naml = H2OAutoML(max_models=20, seed=1234, max_runtime_secs=10800, \n                 stopping_metric = \"auc\", nfolds = folds, \n                sort_metric = \"auc\", exclude_algos = [\"DeepLearning\"]) \naml.train(x=x, y=y, training_frame=train) # , fold_column=\"fold_numbers\"","ccf0b67e":"# View the AutoML Leaderboard\nlb = aml.leaderboard\nlb.head(rows=lb.nrows)  # Print all rows instead of default (10 rows)","4e0265c9":"board = aml.leader\nboard","0a2cc6d6":"preds = aml.predict(test).as_data_frame()\npreds.head()","3ee6b6c8":"sub_df = pd.read_csv(\"..\/input\/tabular-playground-series-mar-2021\/sample_submission.csv\")","cd5d57b7":"sub_df['target'] = preds['predict']\nsub_df.to_csv('submission_h2o.csv', index=False)\nsub_df.head()\n\nsub_automl = preds['predict']","528d0473":"sub = pd.read_csv(\"..\/input\/tabular-playground-series-mar-2021\/sample_submission.csv\")","e5ba4c06":"sub.target.value_counts().to_frame()","3cc6fa16":"# upvote if find this interesting\n","f90a2f7c":"References:\n\nhttps:\/\/www.kaggle.com\/asimzahid\/h2o-tps-feb-2021-automl"}}