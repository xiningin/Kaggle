{"cell_type":{"a8c54037":"code","d8634e87":"code","9acca5d6":"code","e823637b":"code","d55b52df":"code","02225951":"code","11fc647f":"code","a7b30b76":"code","004b5beb":"code","a17452d8":"code","7d68b328":"markdown","bf20195a":"markdown","d03d3e23":"markdown","278e0447":"markdown","d660c79e":"markdown"},"source":{"a8c54037":"import numpy as np\nimport pandas as pd\nimport os\nimport matplotlib.pyplot as plt\n\nengagement_dir = \"..\/input\/learnplatform-covid19-impact-on-digital-learning\/engagement_data\"\ndistricts_path = \"..\/input\/learnplatform-covid19-impact-on-digital-learning\/districts_info.csv\"\nproducts_path = \"..\/input\/learnplatform-covid19-impact-on-digital-learning\/products_info.csv\"","d8634e87":"def load_districts(path:str):\n    '''\n    loads the non-null district data. \n    These districts are 'valuable', \n    because analyzing them provides more valuable information for us.\n    '''\n    districts = pd.read_csv(path).dropna()\n    return districts, districts['district_id']","9acca5d6":"districts, valuable_districts = load_districts(path=districts_path)","e823637b":"def load_engagement(directory:str, districts):\n    '''\n    loads and concatenates the engagement data of all 'valuable' districts.\n    '''\n    engagement = pd.DataFrame(columns=['time', 'lp_id', 'pct_access', 'engagement_index', 'district'])\n    counter = 0\n    for csv in os.listdir(directory):\n        csv_path = directory + \"\/\" + csv\n        district = int(csv[0:-4])\n        if district in districts.values:\n            counter += 1\n            if counter % 8 == 0:\n                print(f'{counter}\/{len(districts)}')\n            temp = pd.read_csv(csv_path)\n            temp = temp.dropna()\n            temp['district'] = district\n            engagement = pd.concat([engagement, temp], ignore_index=True)\n    return engagement","d55b52df":"engagement_data = load_engagement(directory=engagement_dir, districts=valuable_districts)","02225951":"engagement_data = engagement_data.rename(columns={\"district\": \"district_id\"})\ndata = pd.merge(engagement_data, districts, on=[\"district_id\"])","11fc647f":"products = pd.read_csv(products_path)\nproducts = products.rename(columns={\"LP ID\": \"lp_id\"})\ndata[\"lp_id\"] = data[\"lp_id\"].astype(int)\ndata = pd.merge(data, products, on=[\"lp_id\"])","a7b30b76":"data","004b5beb":"# suppress scientific notation:\npd.options.display.float_format = '{:.2f}'.format\n\ndata.describe()","a17452d8":"data.to_csv('data.csv', index=False)","7d68b328":"# Merge with Product Data","bf20195a":"# Merge District Data with Engagement Data","d03d3e23":"# Assemble Engagement Data","278e0447":"## Get an Overview","d660c79e":"# Prepare Districts"}}