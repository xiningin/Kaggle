{"cell_type":{"85ce0830":"code","de6bdd08":"code","a0c698a9":"code","f540fb2e":"code","10cdc8a2":"code","b4c7ee2d":"code","42a266b2":"code","5235af68":"code","f8a27bfb":"code","225d3cb1":"code","c7a84709":"code","a30e72b4":"code","2284b0de":"code","8c411fbc":"code","fec01a4f":"code","3375c46d":"code","f5cfb53d":"code","587e8bae":"code","e443d9e3":"code","8358a0f5":"code","7cd05e67":"code","cb704aed":"code","f417471e":"markdown","a67fb5f5":"markdown","04ac1810":"markdown"},"source":{"85ce0830":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom datetime import datetime as dt\nimport geopandas as gpd\nimport matplotlib.ticker as ticker\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","de6bdd08":"data = pd.read_csv('..\/input\/corona-virus-brazil\/brazil_covid19.csv')\ndata.head()","a0c698a9":"data.isna().sum()","f540fb2e":"cases_day = pd.DataFrame(data.groupby(['date']).sum().reset_index())\ncases_day['date'] = cases_day['date'].apply(lambda x: '{:%m-%d}'.format(dt.strptime(x, '%Y-%m-%d')))\ncases_day","10cdc8a2":"plt.figure(figsize=(12,8))\nplt.title(\"Cases of Covid-19 in Brazil\")\nplt.xticks(rotation=45)\n\n\nsns.set_style(\"whitegrid\")\nsns.despine(left=True)\nfig = sns.lineplot(x=cases_day['date'], y=cases_day['cases'], color='orange')\nfig.set_xlabel('Date')\nfig.set_ylabel('Cases')\nfig.xaxis.set_major_locator(ticker.MaxNLocator(46))","b4c7ee2d":"plt.figure(figsize=(12,8))\nplt.title(\"Deaths caused by Covid-19 in Brazil\")\nplt.xticks(rotation=45)\n\nsns.set_style(\"whitegrid\")\nsns.despine(left=True)\nfig = sns.lineplot(x=cases_day['date'], y=cases_day['deaths'], color='red')\nfig.set_xlabel('Date')\nfig.set_ylabel('Deaths')\nfig.xaxis.set_major_locator(ticker.MaxNLocator(46))","42a266b2":"plt.figure(figsize=(12,8))\nplt.title(\"Progress of the Covid-19 in Brazil\")\nplt.xticks(rotation=45)\n\n\nsns.set_style(\"whitegrid\")\nsns.despine(left=True)\nfig = sns.lineplot(x=cases_day['date'], y=cases_day['cases'], label=\"Cases\", color='orange')\nfig = sns.lineplot(x=cases_day['date'], y=cases_day['deaths'], label=\"Deaths\", color='red')\nfig.set_xlabel('Date')\nfig.set_ylabel('')\nfig.xaxis.set_major_locator(ticker.MaxNLocator(60))","5235af68":"cases_day['new_cases'] = cases_day['cases'].diff()\ncases_day['new_deaths'] = cases_day['deaths'].diff()","f8a27bfb":"# Set the width and height of the figure\nplt.figure(figsize=(20,6))\n\nplt.title(\"New cases of Covid-19 in Brazil\")\n\nsns.barplot(x=cases_day['date'], y=cases_day['new_cases'], color='orange')\n\nplt.xticks(rotation='vertical')\n# Add label for vertical axis\nplt.xlabel(\"\")\nplt.ylabel(\"New cases\")","225d3cb1":"# Set the width and height of the figure\nplt.figure(figsize=(20,6))\n\nplt.title(\"New deaths caused by Covid-19 in Brazil\")\n\nsns.barplot(x=cases_day['date'], y=cases_day['new_deaths'], color='red')\n\nplt.xticks(rotation='vertical')\n# Add label for vertical axis\nplt.xlabel(\"\")\nplt.ylabel(\"New cases\")","c7a84709":"cases_region = pd.DataFrame(data.groupby(['state']).sum().reset_index())\ncases_region.head()","a30e72b4":"fp = '..\/input\/brazilianstatesshapefiles\/BRA_adm1.shp'\nmap_df = gpd.read_file(fp)\n# check data type so we can see that this is not a normal dataframe, but a GEOdataframe\nmap_df.drop(['ISO','NAME_0','ID_0','ID_1','HASC_1','CCN_1','CCA_1','TYPE_1','ENGTYPE_1','NL_NAME_1','VARNAME_1'], \n            axis = 1, inplace=True)\nmap_df.head()","2284b0de":"merged = map_df.set_index('NAME_1').join(cases_region.set_index('state'))\nmerged['coords'] = merged['geometry'].apply(lambda x: x.representative_point().coords[:])\nmerged['coords'] = [coords[0] for coords in merged['coords']]\nmerged.head()","8c411fbc":"merged.describe()","fec01a4f":"values = 'cases'\nvmin, vmax = 26, 36000\nfig, ax = plt.subplots(1, figsize=(25, 10))\nax.axis('off')\ntitle = 'Cases of Covid-19 in Brazil'\nax.set_title(title, fontdict={'fontsize': '18', 'fontweight' : '1'})\nsm = plt.cm.ScalarMappable(cmap='OrRd', norm=plt.Normalize(vmin=vmin, vmax=vmax))\ncbar = fig.colorbar(sm, shrink=0.5)\nfor idx, row in merged.iterrows():\n    plt.annotate(s=row.cases, xy=row['coords'],horizontalalignment='center')\n    \nmerged.plot(column=values, cmap='OrRd', linewidth=0.8, ax=ax, edgecolor='1',\n            norm=plt.Normalize(vmin=vmin, vmax=vmax))","3375c46d":"values = 'deaths'\nvmin, vmax = 0, 1500\nfig, ax = plt.subplots(1, figsize=(25, 10))\nax.axis('off')\ntitle = 'Deaths caused by Covid-19 in Brazil'\nax.set_title(title, fontdict={'fontsize': '18', 'fontweight' : '1'})\nsm = plt.cm.ScalarMappable(cmap='OrRd', norm=plt.Normalize(vmin=vmin, vmax=vmax))\ncbar = fig.colorbar(sm, shrink=0.5)\nfor idx, row in merged.iterrows():\n    plt.annotate(s=row.deaths, xy=row['coords'],horizontalalignment='center')\n    \nmerged.plot(column=values, cmap='OrRd', linewidth=0.8, ax=ax, edgecolor='1',\n            norm=plt.Normalize(vmin=vmin, vmax=vmax))","f5cfb53d":"cases_region.sort_values(['cases'], inplace=True, ascending=False)\n\nplt.figure(figsize=(20,6))\nplt.title(\"Number of cases by state\")\n\npal = sns.color_palette(\"OrRd_r\", len(cases_region))\nrank = cases_region['cases'].argsort().argsort()  \nsns.barplot(x=cases_region.state, y=cases_region.cases, palette=np.array(pal[::-1])[rank])\n\nplt.xticks(rotation='vertical')\nplt.xlabel(\"\")\nplt.ylabel(\"Cases\")","587e8bae":"cases_region.sort_values(['deaths'], inplace=True, ascending=False)\n\nplt.figure(figsize=(20,6))\nplt.title(\"Number of deaths by state\")\n\npal = sns.color_palette(\"OrRd_r\", len(cases_region))\nrank = cases_region['deaths'].argsort().argsort()  \nsns.barplot(x=cases_region.state, y=cases_region.deaths, palette=np.array(pal[::-1])[rank])\n\nplt.xticks(rotation='vertical')\nplt.xlabel(\"\")\nplt.ylabel(\"Cases\")","e443d9e3":"cases_region_2 = pd.DataFrame(data.groupby(['date','state']).sum().reset_index())\ncases_region_2.head()","8358a0f5":"fig, ax = plt.subplots(figsize=(15, 8))\ndef draw_barchart(date,case=\"cases\"):\n    dff= (cases_region_2[cases_region_2['date'].eq(date)].sort_values(by=case,ascending=False).head(10))[::-1]\n    ax.clear()\n    ax.barh(dff['state'], dff[case], color=[\"#980505\",\"#CD1212\",\"#D84E4E\",\"#CB6262\",\"#D39B5F\",\"#F7EC10\",\"#D0F710\",\"#9CF710\",\"#B4D67F\",\"#969C8E\"][::-1])\n    dx = dff[case].max() \/ 200\n    for i, (value, name) in enumerate(zip(dff[case], dff['state'])):\n        ax.text(value-dx, i,     name,           size=14, weight=600, ha='right', va='bottom')\n        ax.text(value-dx, i-.25, value, size=10, color='#17202A', ha='right', va='baseline')\n        ax.text(value+dx, i,     f'{value:,.0f}',  size=14, ha='left',  va='center')\n    # ... polished styles\n    ax.text(1, 0.4, date, transform=ax.transAxes, color='#777777', size=30, ha='right', weight=800)\n    ax.text(0, 1.06, 'Number of cases', transform=ax.transAxes, size=12, color='#777777')\n    ax.xaxis.set_major_formatter(ticker.StrMethodFormatter('{x:,.0f}'))\n    ax.xaxis.set_ticks_position('top')\n    ax.tick_params(axis='x', colors='#777777', labelsize=12)\n    ax.set_yticks([])\n    ax.margins(0, 0.01)\n    ax.grid(which='major', axis='x', linestyle='-')\n    ax.set_axisbelow(True)\n    ax.text(0, 1.12, 'Progression of the Covid-19 in Brazil up to April 30th, 2020',\n            transform=ax.transAxes, size=24, weight=600, ha='left')\n    ax.text(1, 0, 'by @Rodolfo Saldanha; credit to @Zubair @jburnmurdoch', transform=ax.transAxes, ha='right',\n            color='#777777', bbox=dict(facecolor='white', alpha=0.8, edgecolor='white'))\n    plt.box(False)","7cd05e67":"from matplotlib import animation as F\nfrom IPython.display import HTML\nfig,ax = plt.subplots(figsize=(16,10)) #Set figure for plot\nanimator = F.FuncAnimation(fig,draw_barchart,frames=cases_region_2.date.unique(),interval=500) #Building animation\nHTML(animator.to_jshtml())","cb704aed":" writergif = F.PillowWriter(fps=3) \nanimator.save('animation.gif',writer=writergif)","f417471e":"## By day","a67fb5f5":"Progression of the disease by state","04ac1810":"## By region"}}