{"cell_type":{"13dddc0a":"code","d7c4e8f3":"code","c8e4036c":"code","ef4b9c61":"code","8475def9":"code","e3ae5e08":"code","4b3991c2":"code","d6643827":"code","50dc0eab":"code","65f12dee":"code","a4672473":"code","05b9a25d":"code","b59f1e90":"code","7fbc9127":"code","ba255790":"code","a6bd060a":"code","8570e81e":"code","4e20603d":"code","71f8253d":"code","399da149":"code","8bca3a75":"code","57b91eb5":"code","aa8d563a":"code","1221d4b9":"code","62038aa9":"code","536e1db7":"code","1a76cbfc":"code","1a9f1aeb":"code","2e0a9534":"code","25049f9e":"code","3397c70a":"code","f2e133ef":"code","3efda8c4":"code","f9f6b852":"code","53ebfbf9":"code","bad96ead":"markdown","e05b2dbb":"markdown","e65e8cd0":"markdown","197cbefa":"markdown","f033f046":"markdown","10ce99b8":"markdown","3cd4e272":"markdown","96626265":"markdown","add669ff":"markdown","5e4f876e":"markdown","2ca0797f":"markdown","474f8695":"markdown","eda80fba":"markdown","43bfa4cb":"markdown","dba57a75":"markdown","805cfac0":"markdown","959187a9":"markdown","ae262dbc":"markdown","b40828fd":"markdown"},"source":{"13dddc0a":"pip install dnspython","d7c4e8f3":"import pandas as pd\nimport json\nimport pymongo\nfrom pymongo import MongoClient\n\nimport pprint\nimport urllib.parse\nimport timeit\nimport numpy as np\nimport matplotlib.pyplot as plt \nimport matplotlib.patches as mpatches","c8e4036c":"client = MongoClient(\"mongodb+srv:\/\/geuser:melq.5491@bdegi.3pkrh.gcp.mongodb.net\/gre_EMD?retryWrites=true&w=majority\")\ndb = client.test","ef4b9c61":"db = client['gre_EMD'] ","8475def9":"db.list_collection_names()","e3ae5e08":"\ndb = client['gre_EMD']\ncollection_depl = db['gre10_depl']\ncollection_traj=db['gre10_traj']\ncollection_mng=db['gre10_mng']\ncollection_pers=db['gre10_pers']\n\n","4b3991c2":"view_depl = collection_depl.find_one()\nview_traj = collection_traj.find_one()\nview_mng = collection_mng.find_one()\nview_pers = collection_pers.find_one()","d6643827":"view_depl\n","50dc0eab":"view_traj","65f12dee":"view_mng","a4672473":"view_pers","05b9a25d":"print(\"the number of documents for depl database is \",collection_depl.count_documents({}))\nprint(\"the number of documents for traj database is \",collection_traj.count_documents({}))\nprint(\"the number of documents for mng database is \",collection_mng.count_documents({}))\nprint(\"the number of documents for pers database is \",collection_pers.count_documents({}))","b59f1e90":"#convert the mongoDB dataset into a dataframe\ndataFrame_depl = pd.DataFrame(list(collection_depl.find()))\ndataFrame_traj = pd.DataFrame(list(collection_traj.find()))\ndataFrame_mng = pd.DataFrame(list(collection_mng.find()))\ndataFrame_pers = pd.DataFrame(list(collection_pers.find()))","7fbc9127":"dataFrame_depl.head()","ba255790":"dataFrame_traj.head()","a6bd060a":"dataFrame_pers.head()","8570e81e":"dataFrame_depl['duree'] = pd.to_numeric(dataFrame_depl['duree'], errors='coerce')    \ndataFrame_depl['duree'].describe()","4e20603d":"sum(dataFrame_depl['duree'].isnull())","71f8253d":"plt.boxplot(dataFrame_depl['duree'])","399da149":"dataFrame_mng['VP_DISPO'] = pd.to_numeric(dataFrame_mng['VP_DISPO'], errors='coerce')    \ndataFrame_mng['VP_DISPO'].describe()","8bca3a75":"sum(dataFrame_mng['VP_DISPO'].isnull())","57b91eb5":"plt.hist(dataFrame_mng['VP_DISPO'], density=True)\nplt.xlabel('Number of cars')\nplt.ylabel('Probability')\nplt.title('Cars per household')","aa8d563a":"dataFrame_mng['NB_velo'] = pd.to_numeric(dataFrame_mng['NB_velo'], errors='coerce')    \ndataFrame_mng['NB_velo'].describe()","1221d4b9":"sum(dataFrame_mng['NB_velo'].isnull())","62038aa9":"plt.hist(dataFrame_mng['NB_velo'],density=True, rwidth=0.5)\nplt.xticks([i for i in range(11)])\nplt.xlabel('Number of bicycle')\nplt.ylabel('Probability')\nplt.title('Bicycle per household')","536e1db7":"dataFrame_mng['NB_2Rm'] = pd.to_numeric(dataFrame_mng['NB_2Rm'], errors='coerce')    \ndataFrame_mng['NB_2Rm'].describe()","1a76cbfc":"sum(dataFrame_mng['NB_2Rm'].isnull())","1a9f1aeb":"plt.boxplot(dataFrame_mng['NB_2Rm'])","2e0a9534":"#csp : categorie socio professionnelle\ndataFrame_pers['csp'] = pd.to_numeric(dataFrame_pers['csp'], errors='coerce') \nlist_csp=dataFrame_pers['csp'].unique()\nlist_csp.sort()\n#list_csp\n\ndataFrame_pers['freqtcu']=pd.to_numeric(dataFrame_pers['freqtcu'],errors='coerce')\n\nplt.plot(dataFrame_pers['csp'],dataFrame_pers['freqtcu'], 'go')\nplt.title(\"Frequency of use Urban network tag according the Socio-professional category\")\nplt.xlabel(\"Socio-professional category\")\nplt.ylabel(\"Frequency of use Urban network tag\")\nplt.show()","25049f9e":"#csp : categorie socio professionnelle\ndataFrame_pers['csp'] = pd.to_numeric(dataFrame_pers['csp'], errors='coerce') \nlist_csp=dataFrame_pers['csp'].unique()\nlist_csp.sort()\n#list_csp\n\n\ndataFrame_pers['freqtcu'] = pd.to_numeric(dataFrame_pers['freqtcu'], errors='coerce') \nlist_freqtcu=[]\nfor i in list_csp:\n    list_freqtcu.append(dataFrame_pers[dataFrame_pers['csp']==i].freqtcu.mean())\n    \n\nplt.plot(list_csp,list_freqtcu)\nplt.title(\"mean of Frequency of use Urban network tag according the Socio-professional category\")\nplt.xlabel(\"Socio-professional category\")\nplt.ylabel(\"mean of Frequency of use Urban network tag\")\nplt.show()","3397c70a":"dataFrame_pers['age'] = pd.to_numeric(dataFrame_pers['age'], errors='coerce') \nlist_age=dataFrame_pers['age'].unique()\nlist_age.sort()\n\n\ndataFrame_pers['fqvelo']= pd.to_numeric(dataFrame_pers['fqvelo'], errors='coerce')\nlist_fqvelo=[]\nfor i in list_age:\n    list_fqvelo.append(dataFrame_pers[dataFrame_pers['age']==i].fqvelo.mean())\n    \n\n\nplt.plot(list_age,list_fqvelo)\nplt.title(\"Frequency of bicyle use depending age\")\nplt.xlabel(\"age\")\nplt.ylabel(\"mean of Frequency of bicycle use\")\nplt.show()","f2e133ef":"dataFrame_pers['fqvelo'] = pd.to_numeric(dataFrame_pers['fqvelo'], errors='coerce') \ndataFrame_pers['fqvpcond'] = pd.to_numeric(dataFrame_pers['fqvpcond'], errors='coerce') \ndataFrame_pers['fqvppass'] = pd.to_numeric(dataFrame_pers['fqvppass'], errors='coerce') \ndataFrame_pers['freqtcu'] = pd.to_numeric(dataFrame_pers['freqtcu'], errors='coerce') \n\nprint(\"the values taken by fqvelo are :\", sorted(dataFrame_pers['fqvelo'].unique()))\nprint(\"the values taken by fqvpcond are :\",sorted(dataFrame_pers['fqvpcond'].unique()))\nprint(\"the values taken by fqvppass are :\",sorted(dataFrame_pers['fqvppass'].unique()))\nprint(\"the values taken by freqtcu are :\",sorted(dataFrame_pers['freqtcu'].unique()))","3efda8c4":"#let have a look on freq transportion according the occupation\ndataFrame_pers['OCCU1'] = pd.to_numeric(dataFrame_pers['OCCU1'], errors='coerce') \nlist_OCCU1=dataFrame_pers['OCCU1'].unique()\nlist_OCCU1.sort()\nlist_OCCU1\n\ndataFrame_pers['fqvelo'] = pd.to_numeric(dataFrame_pers['fqvelo'], errors='coerce') \ndataFrame_pers['fqvpcond'] = pd.to_numeric(dataFrame_pers['fqvpcond'], errors='coerce') \ndataFrame_pers['fqvppass'] = pd.to_numeric(dataFrame_pers['fqvppass'], errors='coerce') \ndataFrame_pers['freqtcu'] = pd.to_numeric(dataFrame_pers['freqtcu'], errors='coerce') \n\nlist_fqvelo=[]\nlist_fqvpcondANDfqvppass=[]\nlist_freqtcu=[]\nfor i in list_OCCU1:\n    list_fqvelo.append(dataFrame_pers[dataFrame_pers['OCCU1']==i].fqvelo.mean())\n    m1=dataFrame_pers[dataFrame_pers['OCCU1']==i].fqvpcond.mean()\n    m2=dataFrame_pers[dataFrame_pers['OCCU1']==i].fqvppass.mean()\n    m=np.mean([m1,m2])\n    list_fqvpcondANDfqvppass.append(m)\n    list_freqtcu.append(dataFrame_pers[dataFrame_pers['OCCU1']==i].freqtcu.mean())\n\n\n#Plot part\nbarWidth = 0.25\n\nplt.bar(list_OCCU1-barWidth, list_fqvelo, color='red', width=barWidth, edgecolor='white', label='bicycle')\nplt.bar(list_OCCU1, list_fqvpcondANDfqvppass, color='blue', width=barWidth, edgecolor='white', label='car transportation (fqvpcond + fqvppass)')\nplt.bar(list_OCCU1+barWidth, list_freqtcu, color='green', width=barWidth, edgecolor='white', label='Frequency of use Urban network tag')\n\nplt.xticks([i for i in range(10)])\nplt.yticks([i for i in range(6)])\nplt.xlabel(\"Main occupation\")\nplt.ylabel(\"Frequency of transport usage\")\n\npatch1 = mpatches.Patch(color='red', label='bicycle')\npatch2 = mpatches.Patch(color='blue', label='car transportation (fqvpcond + fqvppass)')\npatch3 = mpatches.Patch(color='green', label='Frequency of use Urban network tag')\nplt.legend(handles=[patch1, patch2, patch3])\n\nplt.show()\n\n    \n","f9f6b852":"import matplotlib.patches as mpatches\n\ndataFrame_depl['zoneres'] = pd.to_numeric(dataFrame_depl['zoneres'], errors='coerce') \nlist_zoneres=dataFrame_depl['zoneres'].unique()\nlist_zoneres.sort()\nlist_zoneres\n\nlist_meanTime=[]\nfor i in list_zoneres:\n    list_meanTime.append(dataFrame_depl[dataFrame_depl['zoneres']==i].duree.mean())\n    \n    \nlist_medianTime=[]\nfor i in list_zoneres:\n    list_medianTime.append(dataFrame_depl[dataFrame_depl['zoneres']==i].duree.median())\n    \n\n\nplt.bar(list_zoneres, list_meanTime, color='red', edgecolor='white', label='tram')\nplt.bar(list_zoneres, list_medianTime, color='blue', edgecolor='white', label='velo')\n\npatch1 = mpatches.Patch(color='red', label='mean time')\npatch2 = mpatches.Patch(color='blue', label='median time')\n\nplt.title(\"transportation time according the area of residence\")\nplt.xlabel(\"area of residence\")\nplt.ylabel(\"transportation time\")\nplt.legend(handles=[patch1, patch2])\n\nplt.show()","53ebfbf9":"def skewness(x):\n    res=0\n    m=x.mean()\n    s=x.std()\n    for i in x:\n        res+=(i-m)*(i-m)*(i-m)\n    res\/=(len(x)*s*s*s)\n    return res\n\nprint(skewness)\n\nlist_skewness=[]\nfor i in list_zoneres:\n    list_skewness.append(skewness(dataFrame_depl[dataFrame_depl['zoneres']==i].duree))\n    \nplt.plot(list_zoneres,list_skewness, 'bo')\nplt.title(\"skewness for transportation time measurement according area of residence\")\nplt.xlabel(\"area of residence\")\nplt.ylabel(\"skewness\")\nplt.show()\n","bad96ead":"On this graph we plot the mean of measurments for bicycle, car transportation and public transport frequencies according the main occupation. These three measures look balanced for each main occuaption except for the 4 and the 5 occupations. For the 4th we can see that bicycle is the highest way of transport used and Urban network tag the smallest. And for the 5th car transportation is low compared to the both others.","e05b2dbb":"Leroy Amaury wrapup project","e65e8cd0":"Similar analysis than previously but regarding 2 motorized wheels. We can see that part of household owning a 2 motorized wheels is lower than 25%. The max value is really high, it is probably an outlier (or a collector with a big house). And we see that there are households with lots of 2 motorized wheels. We could wonder if some shops or collector are taken into account. The measure doesn't look reliable.","197cbefa":"We can observe that the attribute 'duree' is spread from 1 minute to 750 minutes (12h30). The last one looks really high, it could be an outlier because the standard deviation isn't so big. On average a journey lasts 18.7 minutes. But it's interesting to focus on quartiles. Indeed the 3th quartile indicates that 75% of the journey last less than 20 minutes. So long journey are unfrequent.","f033f046":"let have a look on the frequency of bicycle use according age","10ce99b8":"On this graph we can observe that frequency for low socio professional category doesn't take the number one and for high socio professional category it doesn't take the number 2. However this graph is difficulte to interprete so let use the mean of Frequency for each socio professional category.","3cd4e272":"On this graph, the frequency of bicycle use has high measures for old age and a measurment peak for people around 20. For old age people the frequency is high and it can be surprising but this measurment depends on the other means of transport","96626265":"We plot a graph with the skewness for each measures of area. It is consist with what we observe on the previous graph. Indeed, we have seen that for all the values the mean is higher than the median this is beceause the skewness is positive for each areas. So the distributions are asymetric and skew on the right probably because of outliers. These outliers can be interpreted as particular transports as it said previously.","add669ff":"Similar analysis than previously but regarding bicycle. The major part of household owns at least one bicycle.","5e4f876e":"This analysis give us interesting idea of transportation vehicule. We can see that more than 75% of household has a car. Observing the median, we can know that most of household owns only one car. Observing the histogram we can see that the major part of households has 1 or 2 cars. Figures look relevant according what are talking about. 0 or 5 cars are two possible values","2ca0797f":"# 2. Analysis of attributes","474f8695":"Let have a look on the frequency of public transports (Urban network tag) according the Socio professional category","eda80fba":"# 3. Analysis of interactions between attributes","43bfa4cb":"Let see if all frequency use the same numerical scale.","dba57a75":"On this graph we can see that there is a low measure of frequency for socio professional categories between 80 and 100. However we cannot conclude anything with this graph.","805cfac0":"# 1. Exploring Views","959187a9":"Let have a look on the transportation time according the area of living","ae262dbc":"Let start with some attributes analysis. We are looking on journey duration, and the means of transportation per household.","b40828fd":"Some areas have a bigger transportation time, probably there are not convinient place regarding transportation (lack of roads, public transport etc)\nFor this graph we use two measures : the mean and the median for each area. We can observe that the mean is all the time higher than the mean. How can we interpret this? This database regroups the displacement of people. And on the whole we have regular movings (for dailylife) and particular movings (for hollidays or special occasion). So, here the median is a good indicator for dailylife part and mean takes into account particular movings. Indeed mean is more influenced by outliers.\nLet have a look on the skewness to be more specific on the spread.\n"}}