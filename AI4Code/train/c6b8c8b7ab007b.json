{"cell_type":{"1ff9dcf2":"code","06c83083":"code","d53ddf14":"code","dd6733cc":"code","07469530":"code","1431aaf9":"code","77c4c769":"code","a204424f":"code","e1178215":"code","e7ff8912":"code","ff7f97ed":"code","5de3f5b7":"code","2be0a1cb":"code","dc9accf9":"code","11f5aba0":"code","b197842a":"code","67046b83":"code","581821df":"code","e5f6876c":"code","fa6bd9ce":"code","ec4d73b5":"code","22eed931":"code","2af7cec9":"code","fee995f3":"code","9875de45":"code","1ac0679e":"code","c35cb3db":"code","236e50dd":"code","4599913a":"code","6bf9af4b":"markdown","9bfbd84a":"markdown"},"source":{"1ff9dcf2":"import numpy as np\nimport pandas as pd\nfrom numpy import nan\nfrom numpy import isnan\nfrom scipy.stats import zscore\nimport matplotlib.pyplot as plt\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error\nimport warnings\nwarnings.filterwarnings('ignore')\n%matplotlib inline","06c83083":"lojas = pd.read_csv('..\/input\/lojasdata\/lojas.csv')\ndataset_treino = pd.read_csv('..\/input\/lojasdata\/dataset_treino.csv')\ndataset_teste = pd.read_csv('..\/input\/lojasdata\/dataset_teste.csv')","d53ddf14":"lojas","dd6733cc":"dataset_treino","07469530":"dataset_treino.drop(['Customers', 'Date', 'StateHoliday'], 1, inplace = True)\ndataset_treino.head()","1431aaf9":"dataset_teste","77c4c769":"dataset_teste.drop(['Date', 'StateHoliday', 'Id'], 1, inplace = True)\ndataset_teste.head()","a204424f":"lojas = pd.get_dummies(lojas)\nlojas.head()","e1178215":"dataset_LTr = pd.merge(lojas, dataset_treino, on='Store')\ndataset_LTr.head()","e7ff8912":"dataset_LTr.isnull().sum()","ff7f97ed":"imputer = SimpleImputer(missing_values=nan, strategy='most_frequent')\ntransformed_values = pd.DataFrame(imputer.fit_transform(dataset_LTr))\ntransformed_values.columns = dataset_LTr.columns\ntransformed_values.head()","5de3f5b7":"transformed_values.isnull().sum()","2be0a1cb":"y = transformed_values['Sales']","dc9accf9":"X = transformed_values.drop('Sales', 1)\nX","11f5aba0":"scaler = MinMaxScaler(feature_range=(0, 1), copy=False)\nnorm_dataset = pd.DataFrame(scaler.fit_transform(X))\nnorm_dataset.columns = X.columns\nnorm_dataset.head()","b197842a":" X_treino, X_teste, y_treino, y_teste = train_test_split(norm_dataset, y, test_size=0.33, random_state=44)","67046b83":"print('X treino', X_treino.shape)\nprint('X teste', X_teste.shape)\nprint('y treino', y_treino.shape)\nprint('y teste', y_teste.shape)","581821df":"regressorRF = RandomForestRegressor(max_depth=100, random_state=42, min_samples_split=2, min_samples_leaf=4, max_features='auto', \n                                    bootstrap=True, n_estimators=1200)\n\nregressorRF.fit(X_treino, y_treino)\ny_predRF = regressorRF.predict(X_teste)","e5f6876c":"print('Mean Squared Error:', mean_squared_error(y_teste, y_predRF, squared=True))\nprint('R2 Score (Coefficient of Determination):', r2_score(y_teste, y_predRF))\nprint('Mean Absolute Error:', mean_absolute_error(y_teste, y_predRF))","fa6bd9ce":"dataset_LTe = pd.merge(lojas, dataset_teste, on='Store')\ndataset_LTe.head()","ec4d73b5":"dataset_LTe.shape","22eed931":"dataset_LTe.isnull().sum()","2af7cec9":"transformed_values_Te = pd.DataFrame(imputer.fit_transform(dataset_LTe))\ntransformed_values_Te.columns = dataset_LTe.columns\ntransformed_values_Te.head()","fee995f3":"scaler = MinMaxScaler(feature_range=(0, 1), copy=False)\nnorm_dataset_Te = pd.DataFrame(scaler.fit_transform(transformed_values_Te))\nnorm_dataset_Te.columns = transformed_values_Te.columns\nnorm_dataset_Te.head()","9875de45":"y_predRFTe = regressorRF.predict(norm_dataset_Te)","1ac0679e":"predi\u00e7\u00e3o = pd.DataFrame(y_predRFTe)\npredi\u00e7\u00e3o","c35cb3db":"submission = pd.read_csv('..\/input\/lojasdata\/sample_submission.csv')\nsubmission","236e50dd":"submission['Sales'] = predi\u00e7\u00e3o\nsubmission","4599913a":"submission.to_csv(\".\/sample_submission.csv\", mode='a', header=False)","6bf9af4b":"# lojas e dataset_treino","9bfbd84a":"# lojas e dataset_teste"}}