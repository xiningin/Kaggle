{"cell_type":{"44ad86d7":"code","d986c059":"code","8f66469b":"code","08c18531":"code","b88e823a":"code","cb61c499":"code","6e41b0a2":"code","c94819e7":"code","7822db50":"code","bd9e1dc5":"code","1b81cef7":"code","c19c7086":"code","b9744420":"code","2ae3359d":"code","fa9d50e5":"code","18adfcf5":"code","bf96e5d8":"code","7a74a10a":"code","0d2826cb":"code","b53b368b":"code","7cfcdefe":"code","fc4ac6ce":"code","28290680":"code","9c876616":"code","0c7786e6":"code","869c8aae":"code","3be4677a":"markdown","20964afc":"markdown","a4e5f861":"markdown","0710bc3c":"markdown","415a10ff":"markdown","9b61b8c9":"markdown","31a7c68e":"markdown","a841f7cc":"markdown","4a14ab68":"markdown","fd45a2e5":"markdown","6976b476":"markdown","f5e33432":"markdown"},"source":{"44ad86d7":"import numpy as np\nimport pandas as pd\nimport os\nfrom sklearn.metrics import classification_report, log_loss, accuracy_score","d986c059":"from fastai import *\nfrom fastai.tabular import *\nfrom fastai.metrics import *\nfrom fastai.tabular.all import *","8f66469b":"data = pd.read_csv(\"\/kaggle\/input\/iris\/Iris.csv\")","08c18531":"Name0=data['Species'].unique().tolist()\nName=sorted(Name0)\nN=list(range(len(Name)))   \nnormal_mapping=dict(zip(Name,N)) \nreverse_mapping=dict(zip(N,Name)) ","b88e823a":"m=len(data)\nprint(m)\nM=list(range(m))\nrandom.seed(2021)\nrandom.shuffle(M)","cb61c499":"train=data.iloc[M[0:(m\/\/3)*2]]\ntest=data.iloc[M[(m\/\/3)*2:]]\nprint(len(train),len(test))","6e41b0a2":"train.head()","c94819e7":"train = train.sample(frac=1).reset_index(drop=True)","7822db50":"train.head()","bd9e1dc5":"train.columns","1b81cef7":"dep_var = \"Species\"\ncont_names = ['SepalLengthCm', 'SepalWidthCm', 'PetalLengthCm', 'PetalWidthCm']","c19c7086":"procs = [Normalize]","b9744420":"dls1 = TabularDataLoaders.from_df(train,'..\/input\/iris\/Iris.csv', \n                    cat_names= [],\n                    cont_names = ['SepalLengthCm', 'SepalWidthCm', 'PetalLengthCm', 'PetalWidthCm',],\n                    y_names='Species',\n                    procs = [Categorify, FillMissing, Normalize])\ndls1","2ae3359d":"learn = tabular_learner(dls1,layers=[200,100],metrics=accuracy)\nlearn","fa9d50e5":"learn.fit_one_cycle(10,1e-02)","18adfcf5":"preds, y_true=learn.get_preds()","bf96e5d8":"# targs = true value, preds = predicted value\npreds,targs = learn.get_preds()\nprint(preds[0:3])\nprint(targs)\nprint(len(targs))","7a74a10a":"targs=targs.numpy() \npreds=np.argmax(preds.numpy(), axis=-1)","0d2826cb":"# result of validation\nprint(classification_report(targs,preds))","b53b368b":"learn.recorder.plot_sched()","7cfcdefe":"interp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_confusion_matrix()","fc4ac6ce":"learn.show_results()","28290680":"ttargs=[]\ntpreds=[]\nfor i in range(len(test)):\n    row, clas, probs = learn.predict(test.iloc[i])\n    ttargs+=[clas.numpy()]\n    tpreds+=[probs.numpy()]","9c876616":"print(tpreds[0:3])\nprint(ttargs[0:3])","0c7786e6":"tpreds=np.argmax(tpreds, axis=-1)\nprint(tpreds[0:3])","869c8aae":"# result of test pediction\nprint(classification_report(ttargs,tpreds))","3be4677a":"https:\/\/docs.fast.ai\/learner.html#Learner.show_results","20964afc":"## TabularLearner\nhttps:\/\/docs.fast.ai\/tabular.learner.html","a4e5f861":"https:\/\/docs.fast.ai\/callback.schedule.html#Recorder.plot_sched","0710bc3c":"## TabularDataLoaders\nhttps:\/\/docs.fast.ai\/tabular.data.html#TabularDataLoaders.from_df","415a10ff":"https:\/\/docs.fast.ai\/learner.html#Learner.get_preds","9b61b8c9":"# Iris Fastai\nThis notebook referred to the followings.<br\/>\nhttps:\/\/www.kaggle.com\/masoodrehman\/iris-species-fastai-accuracy-95<br\/>\nhttps:\/\/docs.fast.ai\/","31a7c68e":"# Learn Predict\nhttps:\/\/docs.fast.ai\/learner.html#Learner.predict","a841f7cc":"### use tabularpandas, predict by fastai \nhttps:\/\/www.kaggle.com\/stpeteishii\/iris-fastai-with-tabularpandas\n### use tabularpandas, predict not by fastai\nhttps:\/\/www.kaggle.com\/stpeteishii\/iris-classify-with-fastai-tabularpandas\n### not use tabularpandas, predict by fastai (this notebook)\nhttps:\/\/www.kaggle.com\/stpeteishii\/iris-fastai","4a14ab68":"### What is Fastai?\n\nfast.ai is a non-profit research group focused on deep learning and artificial intelligence. It was founded in 2016 by [Jeremy Howard](https:\/\/www.kaggle.com\/jhoward) and Rachel Thomas with the goal of democratising deep learning. They do this by providing a massive open online course (MOOC) named \"Practical Deep Learning for Coders,\" which has no other prerequisites except for knowledge of the programming language Python. (Wikipedia)\n","fd45a2e5":"https:\/\/docs.fast.ai\/data.transforms.html#Normalize","6976b476":"# Import library","f5e33432":"# Data preparation"}}