{"cell_type":{"8b66f003":"code","ca6aa41b":"code","c4c61f75":"code","6408bca3":"code","7b834e73":"code","c9f6f5e1":"code","9a9a7243":"code","9ea6f022":"code","5ca7739a":"code","1ae49a77":"code","a337e352":"code","c40e8ef4":"code","10fe1e15":"code","98bd2cea":"code","1860b019":"code","58348b08":"code","fdfd67fc":"code","3541a8a7":"code","624650d5":"code","e78e3854":"code","72e1c184":"code","6a3c91b6":"code","c80b1f25":"code","58b52831":"code","2397a2eb":"code","2b671999":"code","550500ac":"code","2ffaed3c":"code","18693c3b":"code","cc8637b6":"code","b82b323c":"code","95c6f335":"code","532528a0":"code","720c1160":"code","27d21db2":"code","2ce5f467":"code","d5116b41":"code","a9f5a159":"code","7107895f":"code","01218a43":"code","0255f3ad":"code","99880ae4":"code","52242048":"markdown","4c17bb95":"markdown","5581dcf6":"markdown","427be081":"markdown","d85ee53c":"markdown","1a6d936b":"markdown","af856f59":"markdown","ab92a8c4":"markdown","020d3293":"markdown","bae6180f":"markdown","2c5eefba":"markdown","b8e4be23":"markdown","2f45290c":"markdown","f273476f":"markdown","16b48d56":"markdown","6bcb55a8":"markdown","ed3b8b9c":"markdown","2b1d2f8b":"markdown","306df80f":"markdown","65e28b54":"markdown","5939ca33":"markdown","6aacd1e7":"markdown","a1c9895e":"markdown","0ef1847b":"markdown","1ad468f9":"markdown","2451a4f8":"markdown","e234a955":"markdown"},"source":{"8b66f003":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","ca6aa41b":"import torch","c4c61f75":"def grad_example(x, i):\n    x.requires_grad_(True)\n    ex = torch.exp(x)\n    sm = ex[i] \/ ex.sum()\n    res = sm.log()\n    res.backward()\n    print(x.grad)\n    ","6408bca3":"grad_example(torch.tensor([1.,2.,3.]), 1)","7b834e73":"def foo():\n    x = torch.tensor([4., 17.], requires_grad=True) # \u041d\u0430\u0447\u0430\u043b\u044c\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f x\n    lr = 0.05 # \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043e\u043f\u0442\u0438\u043c\u0438\u0437\u0430\u0446\u0438\u0438\n    for iteration in range(100):\n        with torch.no_grad(): #pytorch \u0437\u0430\u043f\u0440\u0435\u0449\u0430\u0435\u0442 \u0438\u0437\u043c\u0435\u043d\u044f\u0442\u044c \u0442\u0435\u043d\u0437\u043e\u0440\u044b, \u0434\u043b\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043f\u043e\u0434\u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442, \n            # torch.no_grad() \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043a\u043e\u0434, \u043d\u0435 \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u044f \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442, \u0432 \u0442.\u0447. \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0432 \u0442\u0435\u043d\u0437\u043e\u0440\u0435\n            if x.grad is not None: # \u041d\u0430 \u043f\u0435\u0440\u0432\u043e\u0439 \u0438\u0442\u0435\u0440\u0430\u0446\u0438\u0438 x.grad == None\n                x.grad.zero_() # \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442 \u0432 \u043d\u0443\u043b\u044c (\u0432 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0433\u043e \u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442\u0430 \u043f\u0440\u0438\u0431\u0430\u0432\u0438\u0442\u0441\u044f \u043a \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u043c\u0443)\n                \n        f = torch.sum(x ** 2) # \u0412\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u043c \u043c\u0438\u043d\u0438\u043c\u0438\u0437\u0438\u0440\u0443\u0435\u043c\u0443\u044e \u0444\u0443\u043d\u043a\u0446\u0438\u044e\n        # \u0412\u044b\u0432\u043e\u0434\u0438\u043c (x.data - \u0442\u0435\u043d\u0437\u043e\u0440, \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u044e\u0449\u0438\u0439 \u043f\u0430\u043c\u044f\u0442\u044c \u0441 x, \u043d\u043e \u0431\u0435\u0437 \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u043d\u0438\u044f \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0435\u0433\u043e, \u0447\u0442\u043e\u0431\u044b \u0432\u044b\u0432\u043e\u0434\u0438\u043b\u0438\u0441\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u0430\u043d\u043d\u044b\u0435_\n        # \u0415\u0441\u043b\u0438 \u0432 \u0442\u0435\u043d\u0437\u043e\u0440\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0434\u0438\u043d \u044d\u043b\u0435\u043c\u0435\u043d\u0442, item \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0435\u0433\u043e \u043a\u0430\u043a \u0447\u0438\u0441\u043b\u043e\n        print(x.data, f.item()) \n        # \u0412\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u043c \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442\n        f.backward()\n        with torch.no_grad():\n            # \u0414\u0435\u043b\u0430\u0435\u043c \u0448\u0430\u0433 (\u0441\u0434\u0432\u0438\u0433\u0430\u0435\u043c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0432 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0438, \u043f\u0440\u043e\u0442\u0438\u0432\u043e\u043f\u043e\u043b\u043e\u0436\u043d\u043e\u043c \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442\u0443, \u043d\u0430 \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u0443, \u043f\u0440\u043e\u043f\u043e\u0440\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u0443\u044e \u0447\u0430\u0441\u0442\u043d\u044b\u043c \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u043d\u044b\u043c \u0438 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f)\n            x -= lr * x.grad\n    print(x.data, f.item())","c9f6f5e1":"foo()","9a9a7243":"def task_2():\n    X = torch.tensor([[-1 ,-1],[3, 5.1], [0, 4], [-1, 5], [3, -2], [4, 5]])\n    w = torch.tensor([0.1, -0.1])\n    b = torch.tensor(0.)\n    y = torch.tensor([0.436, 14.0182, 7.278, 6.003, 7.478, 15.833])\n    y_hat = torch.matmul(X,w) + b # \u0438\u043b\u0438 torch.sum(X*w,dim=1) + b\n    print(y_hat)","9ea6f022":"task_2()","5ca7739a":"P = torch.tensor([[0.1955, 0.0311, 0.7734],\n [0.5093, 0.174, 0.3167],\n [0.1309, 0.061, 0.8081],\n [0.3826, 0.5054, 0.112]])\n\nc = torch.tensor([2,0,1,0], dtype=torch.long) #\u0421 \u0443\u0447\u0435\u0442\u043e\u043c \u0438\u043d\u0434\u0435\u043a\u0441\u043e\u0432, \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0449\u0438\u0445\u0441\u044f \u0441 0\n# \u0412\u0435\u043a\u0442\u043e\u0440 \u043e\u0442 0 \u0434\u043e \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0447\u0438\u0441\u043b\u0430\nprint('torch.arange(4): ', torch.arange(4))\n# \u041c\u044b \u043c\u043e\u0436\u0435\u043c \u0438\u043d\u0434\u0435\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043d\u0437\u043e\u0440\u044b \u0441\u043f\u0438\u0441\u043a\u0430\u043c\u0438 \u0438\u043b\u0438 \u0442\u0435\u043d\u0437\u043e\u0440\u0430\u043c\u0438 \u0438\u0437 \u0446\u0435\u043b\u044b\u0445 \u0447\u0438\u0441\u0435\u043b. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 tensor([5,9,1,2])[[0,3,0]] == tensor([5,2,5])\n# \u0412 \u0441\u043b\u0443\u0447\u0430\u0435 \u0441 \u043c\u0430\u0442\u0440\u0438\u0446\u0430\u043c\u0438, \u043c\u044b \u043c\u043e\u0436\u0435\u043c \u0438\u043d\u0434\u0435\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u0445 \u0434\u0432\u0443\u043c\u044f \u0441\u043f\u0438\u0441\u043a\u0430\u043c\u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u043e\u0432 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u043e\u0433\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430\nprint('P[torch.arange(4), c]: ', P[torch.arange(4), c])\nL = -torch.mean(torch.log(P[torch.arange(4), c]))\nprint(L.item())","1ae49a77":"from sklearn.datasets import fetch_openml","a337e352":"covertype = fetch_openml(data_id=180)","c40e8ef4":"print(type(covertype), covertype)","10fe1e15":"cover_df = pd.DataFrame(data=covertype.data, columns=covertype.feature_names)","98bd2cea":"cover_df.sample(10)","1860b019":"print(covertype.target)","58348b08":"from sklearn.preprocessing import LabelEncoder\nlabel_encoder = LabelEncoder().fit(covertype.target)","fdfd67fc":"print(label_encoder.classes_) ","3541a8a7":"cover_target = label_encoder.transform(covertype.target)","624650d5":"print(cover_target)","e78e3854":"print(cover_df.shape)","72e1c184":"from sklearn.model_selection import train_test_split","6a3c91b6":"df_train, df_test, y_train, y_test = train_test_split(cover_df, cover_target, test_size=0.15, stratify=cover_target)","c80b1f25":"to_normalize = [(i, col) for i, col in enumerate(cover_df.columns)\n                        if not col.startswith('wilderness_area') and not col.startswith('soil_type')]\nidx_to_normalize = [i for i,col in to_normalize] #\u043d\u043e\u043c\u0435\u0440\u0430 \u0441\u0442\u043e\u043b\u0431\u0446\u043e\u0432\ncolumns_to_normalize = [col for i, col in to_normalize] #\u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f\n\nprint(columns_to_normalize)\nprint(idx_to_normalize)","58b52831":"cover_df[columns_to_normalize].sample(4)","2397a2eb":"from torch.utils.data import TensorDataset,DataLoader","2b671999":"tensor_train = torch.from_numpy(df_train.values).type(torch.FloatTensor)","550500ac":"print(tensor_train[:3]) #\u041f\u0435\u0440\u0432\u044b\u0435 \u0442\u0440\u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445","2ffaed3c":"tensor_test = torch.from_numpy(df_test.values).type(torch.FloatTensor)","18693c3b":"train_mean = torch.mean(tensor_train[:,idx_to_normalize], dim=0)\ntrain_std = torch.std(tensor_train[:,idx_to_normalize], dim=0)","cc8637b6":"print(train_mean, train_std)","b82b323c":"tensor_train[:,idx_to_normalize] -= train_mean\ntensor_train[:,idx_to_normalize] \/= train_std\ntensor_test[:,idx_to_normalize] -= train_mean\ntensor_test[:,idx_to_normalize] \/= train_std","95c6f335":"print(tensor_train[:3])","532528a0":"y_train_tensor = torch.from_numpy(y_train).type(torch.LongTensor)\ny_test_tensor = torch.from_numpy(y_test).type(torch.LongTensor)","720c1160":"train_ds = TensorDataset(tensor_train, y_train_tensor)\ntest_ds = TensorDataset(tensor_test, y_test_tensor)","27d21db2":"print(train_ds[400])","2ce5f467":"train_loader = DataLoader(train_ds,batch_size=256, shuffle=True)\ntest_loader = DataLoader(test_ds, batch_size=256)","d5116b41":"for xx, yy in train_loader:\n    print(xx)\n    print(yy)\n    break","a9f5a159":"import matplotlib.pyplot as plt\nimport matplotlib.colors","7107895f":"phi = np.linspace(0, 20, 300)\nr = 1 + phi\n\nx = r * np.cos(phi)\ny = r * np.sin(phi)\nclasses = np.zeros(300)\nclasses[:100] = 0\nclasses[100:200] = 1\nclasses[200:] = 2\npoints = np.column_stack((x + np.random.normal(scale=0.3,size = x.size), y + np.random.normal(scale=0.3,size=y.size)))\n","01218a43":"plt.plot(x,y)\nplt.scatter(points[:,0], points[:,1], c=classes, cmap=matplotlib.colors.ListedColormap(['r','g','b']))","0255f3ad":"points_train, points_test, classes_train, classes_test = train_test_split(points,classes, test_size=0.2)","99880ae4":"points_train, points_test = [torch.from_numpy(points_train).type(torch.FloatTensor), torch.from_numpy(points_test).type(torch.FloatTensor)]","52242048":"\u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u043c \u0432 \u0444\u043e\u0440\u043c\u0430\u0442 pytorch","4c17bb95":"\u041d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0443\u0435\u043c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f.\n\u041f\u043e\u0434\u0441\u0447\u0438\u0442\u0430\u0435\u043c \u0441\u0440\u0435\u0434\u043d\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0443\u0435\u043c\u044b\u0445 \u0441\u0442\u043e\u043b\u0431\u0446\u043e\u0432 \u0438 \u0438\u0445 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0435 \u043e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u044f","5581dcf6":"Torch \u043f\u0440\u0435\u0434\u043b\u0430\u0433\u0430\u0435\u0442 \u0434\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0438 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u0432\u0430 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 - Dataset \u0438 DataLoader.\nDataset - \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u0430\u044f \u043e\u0431\u0435\u0440\u0442\u043a\u0430 \u043d\u0430\u0434 \u0434\u0430\u043d\u043d\u044b\u043c\u0438, \u0441 \u0435\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u043c\u0438 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044f\u043c\u0438 - \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 \u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u043b\u0438\u043d\u044b \u0432\u0441\u0435\u0433\u043e \u043d\u0430\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445.\nTensorDataset - \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f Dataset \u0434\u043b\u044f \u0433\u043e\u0442\u043e\u0432\u044b\u0445 \u0442\u0435\u043d\u0437\u043e\u0440\u043e\u0432. \u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0442\u0435\u043d\u0437\u043e\u0440\u043e\u0432 \u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0435 \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 \u0432\u0435\u0440\u043d\u0435\u0442 \u043a\u043e\u0440\u0442\u0435\u0436 \u0438\u0437 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0438\u0437 \u044d\u0442\u0438\u0445 \u0442\u0435\u043d\u0437\u043e\u0440\u043e\u0432","427be081":"\u0417\u0430\u0433\u043e\u0442\u043e\u0432\u043a\u0430","d85ee53c":"### \u041f\u043e\u044f\u0441\u043d\u0435\u043d\u0438\u0435 \u043f\u043e \u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044e \u043a\u0440\u0438\u0442\u0435\u0440\u0438\u044f\n\u0414\u043b\u044f \u0432\u0441\u0435\u0433\u043e \u043d\u0430\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u0438\u043d\u0438\u043c\u0438\u0437\u0438\u0440\u0443\u0435\u043c\u044b\u0439 \u043a\u0440\u0438\u0442\u0435\u0440\u0438\u0439 \u0438\u043c\u0435\u0435\u0442 \u0432\u0438\u0434:\n$$-\\frac{1}{N}\\sum_{i=1}^N \\log p^{(i)}_{c^{(i)}}$$\n\u0413\u0434\u0435 $N$ - \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432 \u0434\u0430\u043d\u043d\u044b\u0445 (\u0440\u0430\u0437\u043c\u0435\u0440 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430), $\\vec{p}^{(i)}$ - \u0432\u044b\u0434\u0430\u0432\u0430\u0435\u043c\u043e\u0435 \u043c\u043e\u0434\u0435\u043b\u044c\u044e \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0435\u0439 \u043d\u0430\u0434 \u043a\u043b\u0430\u0441\u0441\u0430\u043c\u0438 \u0434\u043b\u044f $i$-\u0433\u043e \u044d\u043a\u0437\u0435\u043c\u043f\u044f\u0440\u0430, $c^{(i)}$ - \u043d\u043e\u043c\u0435\u0440 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0430 \u0434\u043b\u044f $i$-\u0433\u043e \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430, \u0442\u043e \u0435\u0441\u0442\u044c \u0438\u043d\u0434\u0435\u043a\u0441 \u0432 \u0432\u0435\u043a\u0442\u043e\u0440 $\\vec{p}^{(i)}$.\n\n\u041d\u0430 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0435, \u0432\u044b\u0447\u0438\u0441\u043b\u044f\u0442\u044c \u043f\u043e\u0442\u0435\u0440\u044e \u0438 \u0435\u0451 \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442 \u043f\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c \u043e\u0442 \u0432\u0441\u0435\u0433\u043e \u043d\u0430\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043a\u0440\u0430\u0439\u043d\u0435 \u043d\u0435\u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e. \u041f\u043e\u044d\u0442\u043e\u043c\u0443 \u0438\u0445 \u043c\u044b \u0432\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u043c \u043e\u0442 \u043f\u0430\u0447\u043a\u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, 200 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e \u043e\u0442\u043e\u0431\u0440\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0438\u043c\u0435\u0440\u043e\u0432), \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u043e, \u0447\u0442\u043e \u043f\u043e\u0442\u0435\u0440\u044f \u0434\u0435\u043a\u043e\u043c\u043f\u043e\u0437\u0438\u0440\u0443\u0435\u0442\u0441\u044f, \u043a\u0430\u043a \u0441\u0440\u0435\u0434\u043d\u0435\u0435 \u043e\u0442 \u0438\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u0442\u0435\u0440\u044c \u043d\u0430 \u043a\u0430\u0436\u0434\u043e\u043c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0435.\n\u0418\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u0430\u044f \u043f\u043e\u0442\u0435\u0440\u044f \u043d\u0430 \u043e\u0434\u043d\u043e\u043c \u044d\u043a\u0437\u0435\u043c\u043f\u044f\u0440\u0435:\n$$-\\log p_c$$\n\u0433\u0434\u0435 $\\vec{p}$ - \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0435 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0438 \u043d\u0430\u0434 \u043a\u043b\u0430\u0441\u0441\u0430\u043c\u0438, $c$ - \u043d\u043e\u043c\u0435\u0440 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0430 \u044d\u043a\u0437\u0435\u043c\u043f\u044f\u0440\u0430 (\u0438\u043d\u0434\u0435\u043a\u0441 \u0432 $\\vec{p}$). \u042d\u0442\u0430 \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u0430 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u0430, \u0435\u0441\u043b\u0438 $p_c = 1$. \u041f\u043e\u0442\u0435\u0440\u044f \u043d\u0430 \u043f\u0430\u0447\u043a\u0435 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432:\n$$-\\frac{1}{B}\\sum_{i=1}^B \\log p^{(i)}_{c^{(i)}}$$\n\u0433\u0434\u0435 $B$ - \u0440\u0430\u0437\u043c\u0435\u0440 \u043f\u0430\u0447\u043a\u0438 (\u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432 \u0432 \u043d\u0435\u0439).\n\u0412\u0435\u043a\u0442\u043e\u0440\u044b $\\vec{p}$ \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 \u0432 \u043f\u0430\u0447\u043a\u0435 \u043c\u043e\u0436\u043d\u043e \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u0432 \u043c\u0430\u0442\u0440\u0438\u0446\u0443 $P \\in \\mathbb{R}^{B \\times C}$, \u0433\u0434\u0435 $\\vec{p}^{(i)}$ - $i$-\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u043c\u0430\u0442\u0440\u0438\u0446\u044b $P$, \u0430 $C$ - \u043a\u043e\u043b-\u0432\u043e \u043a\u043b\u0430\u0441\u0441\u043e\u0432.\n\u0422\u043e\u0433\u0434\u0430 \u043a\u0440\u0438\u0442\u0435\u0440\u0438\u0439 \u043c\u043e\u0436\u043d\u043e \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c:\n$$-\\frac{1}{B}\\sum_{i=1}^B \\log P_{i,c^{(i)}}$$\n\n\u0420\u0430\u0441\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043f\u0440\u0438\u043c\u0435\u0440. \u041e\u0431\u043e\u0437\u043d\u0430\u0447\u0438\u043c \u0447\u0435\u0440\u0435\u0437 $\\vec{c}$ \u043d\u043e\u043c\u0435\u0440\u0430 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0445 \u043a\u043b\u0430\u0441\u0441\u043e\u0432 \u0434\u043b\u044f \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432. \u041f\u0443\u0441\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u043f\u0430\u0447\u043a\u0438 $B=4$, \u0430 \u0447\u0438\u0441\u043b\u043e \u043a\u043b\u0430\u0441\u0441\u043e\u0432 $C=3$:\n$$ P = \n\\begin{bmatrix}\n0.1955 & 0.0311 & \\color{red}{0.7734} \\\\\n\\color{red}{0.5093} & 0.174 & 0.3167 \\\\\n0.1309 & \\color{red}{0.061} & 0.8081 \\\\\n\\color{red}{0.3826} & 0.5054 & 0.112 \n\\end{bmatrix},~\n\\vec{c} = \n\\begin{bmatrix}\n3 \\\\\n1 \\\\\n2 \\\\\n1\n\\end{bmatrix}\n$$\n\u0422\u043e\u0433\u0434\u0430 \u043f\u043e\u0442\u0435\u0440\u044f $L$ \u043d\u0430 \u044d\u0442\u043e\u0439 \u043f\u0430\u0447\u043a\u0435 \u0440\u0430\u0432\u043d\u0430:\n$$L = -\\frac{1}{B}\\sum_{i=1}^B \\log P_{i,c^{(i)}} = -\\frac{1}{4}\\sum_{i=1}^4 \\log P_{i,c_i} = -\\frac{1}{4}(\\log P_{1,3} + \\log P_{2,1} + \\log P_{3,2} + \\log P_{4,1})$$\n$$L = -\\frac{1}{4}(\\log 0.7734 + \\log 0.5093 + \\log 0.061 + \\log 0.3826) \\approx 1.17233$$\n\n\u041f\u0440\u0438\u043c\u0435\u0440 \u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f:","1a6d936b":"## \u0417\u0430\u0434\u0430\u043d\u0438\u0435 3 \n1. \u0414\u0430\u043d \u0442\u0435\u043d\u0437\u043e\u0440 \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c $N \\times D$. \u0421 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c\u044e p \u043e\u0431\u043d\u0443\u043b\u0438\u0442\u044c \u043a\u0430\u0436\u0434\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442.\n2. \u0414\u0430\u043d \u0442\u0435\u043d\u0437\u043e\u0440 \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c $N \\times D$. \u0421 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c\u044e p \u043e\u0431\u043d\u0443\u043b\u0438\u0442\u044c \u043a\u0430\u0436\u0434\u044b\u0439 \u0441\u0442\u043e\u043b\u0431\u0435\u0446.\n3. \u0414\u0430\u043d \u0442\u0435\u043d\u0437\u043e\u0440 $K$ \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c $N \\times D$ \u0438 \u0432\u0435\u043a\u0442\u043e\u0440 $\\vec{q}$ \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c $D$. \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0432\u0435\u043a\u0442\u043e\u0440 $\\vec{a}$ \u043f\u043e \u0444\u043e\u0440\u043c\u0443\u043b\u0435:\n$$\\vec{a} = \\sum_{i=1}^{N} \\alpha_i \\vec{K}^{(i)}$$\n\u0433\u0434\u0435\n$$\\alpha_i = \\frac{e^{z_i}}{\\sum_{j=1}^{N}{e^{z_j}}}$$\n$$z_i = \\vec{q} \\cdot \\vec{K}^{(i)}$$\n","af856f59":"\u041c\u0435\u0442\u043a\u0438 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u044b \u0441\u0442\u0440\u043e\u043a\u0430\u043c\u0438, \u043d\u0430\u0437\u043d\u0430\u0447\u0438\u043c \u043a\u0430\u0436\u0434\u043e\u0439 \u0438\u0437 \u043d\u0438\u0445 \u043d\u043e\u043c\u0435\u0440 (\u043d\u043e\u043c\u0435\u0440 \u043a\u043b\u0430\u0441\u0441\u0430)","ab92a8c4":"### \u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445\n\u0421\u043a\u0430\u0447\u0430\u0435\u043c \u043d\u0430\u0431\u043e\u0440 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f sklearn (\u0432 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u0445 kernel \u043d\u0443\u0436\u043d\u043e \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0418\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0443)","020d3293":"\u0432\u0441\u0435\u0433\u043e 7 \u043a\u043b\u0430\u0441\u0441\u043e\u0432","bae6180f":"\u0412\u044b\u0432\u0435\u0434\u0435\u043c \u043f\u0435\u0440\u0432\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 train_loader","2c5eefba":"\u0420\u0430\u0437\u0431\u0438\u0435\u043d\u0438\u0435 \u043d\u0430 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u044b\u0435 \u0438 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435","b8e4be23":"## \u0417\u0430\u0434\u0430\u043d\u0438\u0435 2\n\n\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442\u043d\u044b\u0439 \u0441\u043f\u0443\u0441\u043a, \u043d\u0430\u0439\u0442\u0438 \u043c\u0438\u043d\u0438\u043c\u0443\u043c \u0444\u0443\u043d\u043a\u0446\u0438\u0438:\n$$ f(\\vec{w}, b;X,\\vec{y}) = \\sum_{i=1}^N [\\vec{w} \\cdot X^{(i)} + b - y_i]^2 = \\sum_{i=1}^N(\\hat{y}_i - y_i)^2;~~ \\hat{y} = X\\vec{w} + b$$\n\u0413\u0434\u0435 $X$:\n\\begin{bmatrix}\n-1 & -1 \\\\\n3 & 5.1 \\\\\n0 & 4 \\\\\n-1 & 5 \\\\\n3 & -2 \\\\\n4 & 5\n\\end{bmatrix}\n\u0438 $y$ =:\n\\begin{bmatrix}\n0.436 \\\\\n14.0182 \\\\\n7.278\\\\\n6.003 \\\\\n7.478 \\\\\n15.833 \n\\end{bmatrix}","2f45290c":"## \u0417\u0430\u0434\u0430\u043d\u0438\u0435 6\n\u041f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0438 \u043e\u0431\u0443\u0447\u0438\u0442\u044c \u043d\u0435\u0439\u0440\u043e\u043d\u043d\u0443\u044e \u0441\u0435\u0442\u044c \u0438\u0437 \u0437\u0430\u0434\u0430\u043d\u0438\u044f 4 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043c\u043e\u0434\u0443\u043b\u0438 torch.nn \u0438 torch.optim","f273476f":"from_numpy \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0442\u0435\u043d\u0437\u043e\u0440, \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u044e\u0449\u0438\u0439 \u043f\u0430\u043c\u044f\u0442\u044c \u0441 numpy \u043c\u0430\u0441\u0441\u0438\u0432\u043e\u043c, .type \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0442\u0435\u043d\u0437\u043e\u0440 \u043d\u043e\u0432\u043e\u0433\u043e \u0442\u0438\u043f\u0430 (\u0432 \u0434\u0430\u043d\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043c\u044b \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u043c \u0438\u0437 float64 \u0432 float32)","16b48d56":"### \u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u043f\u0430\u0447\u043a\u0430\u043c\u0438 (batching)\n\u041c\u0430\u0442\u0440\u0438\u0446\u044b $W$ \u0432 \u0444\u043e\u0440\u043c\u0443\u043b\u0430\u0445 \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u044b \u0438\u0437 \u0443\u0441\u043b\u043e\u0432\u0438\u044f, \u0447\u0442\u043e \u043a\u0430\u0436\u0434\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u043e\u0434\u043d\u043e\u043c\u0443 \u043d\u0435\u0439\u0440\u043e\u043d\u0443 \u0438 \u0443\u043c\u043d\u043e\u0436\u0430\u0435\u043c\u044b\u0439 \u043d\u0430 \u043d\u0435\u0451 \u0432\u0435\u043a\u0442\u043e\u0440 \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0441\u0442\u043e\u043b\u0431\u0446\u043e\u043c. \u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c $i$-\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f $W\\vec{x}$ \u0440\u0430\u0432\u0435\u043d $W^{(i)} \\cdot \\vec{x}$, \u0442.\u0435. \u0432\u0437\u0432\u0435\u0448\u0435\u043d\u043d\u043e\u0439 \u0441\u0443\u043c\u043c\u0435 \u0432\u0445\u043e\u0434\u043e\u0432 i-\u0433\u043e \u043d\u0435\u0439\u0440\u043e\u043d\u0430. \u041e\u0434\u043d\u0430\u043a\u043e \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044f, \u0447\u0442\u043e \u043d\u0443\u0436\u043d\u043e \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u043f\u0430\u0447\u043a\u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432 $X$ \u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u044b \u043f\u0440\u0438\u043d\u044f\u0442\u043e \u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0432 \u0441\u0442\u0440\u043e\u043a\u0430\u0445 \u043c\u0430\u0442\u0440\u0438\u0446\u044b (\u0442.\u0435. $X \\in \\mathbb{R}^{B \\times D_x}$, \u0433\u0434\u0435 $B$ - \u0440\u0430\u0437\u043c\u0435\u0440 \u043f\u0430\u0447\u043a\u0438), \u0443\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0435 \u0441\u043b\u043e\u044f (\u043f\u0435\u0440\u0435\u0434 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435\u043c \u0430\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u0438) \u043b\u0443\u0447\u0448\u0435 \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u0430\u0442\u044c:\n$$ H = XW^{T} + \\vec{b} $$, \u0433\u0434\u0435 $\\vec{b}$ \u043f\u0440\u0438\u0431\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043a \u043a\u0430\u0436\u0434\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0435(__!__) \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0438\u0440\u0443\u044e\u0449\u0435\u0439 \u043c\u0430\u0442\u0440\u0438\u0446\u044b. \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u043c \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043c\u0430\u0442\u0440\u0438\u0446\u0430 $H \\in \\mathbb{R}^{B \\times D_h}$, \u0442.\u0435. \u043a\u0430\u0436\u0434\u0430\u044f \u0435\u0451 \u0441\u0442\u0440\u043e\u043a\u0430 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0435 \u0438\u0437 $X$. \u0412\u043c\u0435\u0441\u0442\u043e \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f $W$ \u0438\u0445 \u0441\u0440\u0430\u0437\u0443 \u043c\u043e\u0436\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0437 \u0443\u0441\u043b\u043e\u0432\u0438\u044f, \u0447\u0442\u043e \u043d\u0435\u0439\u0440\u043e\u043d\u0430\u043c \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0441\u0442\u043e\u043b\u0431\u0446\u044b, \u0442.\u0435. $W^{(h)} \\in \\mathbb{R}^{D_x \\times D_h}$.","6bcb55a8":"\u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u043c \u0441\u0442\u0440\u043e\u043a\u0438 \u0432 \u043d\u043e\u043c\u0435\u0440\u0430","ed3b8b9c":"## \u0417\u0430\u0434\u0430\u043d\u0438\u0435 4\n\u041f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043d\u0435\u0439\u0440\u043e\u043d\u043d\u0443\u044e \u0441\u0435\u0442\u044c \u0434\u043b\u044f \u043c\u043d\u043e\u0433\u043e\u043a\u043b\u0430\u0441\u0441\u043e\u0432\u043e\u0439 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438, \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043c\u043e\u0434\u0443\u043b\u044c torch.nn.\n\u041e\u0431\u0443\u0447\u0438\u0442\u044c \u0435\u0451 \u0434\u043b\u044f \u043d\u0430\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 https:\/\/www.openml.org\/d\/180 (\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0442\u0438\u043f\u0430 \u043b\u0435\u0441\u0430 \u043f\u043e \u043a\u0430\u0440\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0430\u043c), \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0441\u0442\u043e\u0445\u0430\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442\u043d\u044b\u0439 \u0441\u043f\u0443\u0441\u043a (\u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442 \u0432\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0442 \u043f\u0430\u0447\u043a\u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432).\n\u0421\u0435\u0442\u044c \u0434\u043e\u043b\u0436\u043d\u0430 \u0438\u043c\u0435\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c 1 \u0441\u043a\u0440\u044b\u0442\u044b\u0439 \u0441\u043b\u043e\u0439.\n\n\u041f\u0440\u0435\u0434\u043f\u043e\u043b\u0430\u0433\u0430\u0435\u043c\u0430\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430\n$$ \\vec{h} = \\text{relu}(W^{(h)}\\vec{x} + \\vec{b^{(h)}})$$\n$$ \\vec{p} = \\text{softmax}(W^{(p)}\\vec{h} + \\vec{b^{(p)}})$$\n\n$$ \\vec{x} \\in \\mathbb{R}^{D_x}$$\n$$ \\vec{h}, \\vec{b_h}  \\in \\mathbb{R}^{D_h},~W^{(h)} \\in \\mathbb{R}^{D_h \\times D_x}$$\n$$ \\vec{p}, \\vec{b_p}  \\in \\mathbb{R}^{N_c} ,~W^{(p)} \\in \\mathbb{R}^{N_p \\times D_h}$$\n\u0413\u0434\u0435 $D_x$, $D_h$ - \u0440\u0430\u0437\u043c\u0435\u0440\u043d\u043e\u0441\u0442\u0438 \u0432\u0445\u043e\u0434\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u0441\u043a\u0440\u044b\u0442\u043e\u0433\u043e \u0441\u043b\u043e\u044f, $N_c$ - \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043a\u043b\u0430\u0441\u0441\u043e\u0432.\n\n$$ \\text{relu}(x) = \\text{max}(0,x) $$\n$$ \\text{softmax}(\\vec{x})_i = \\frac{e^{x_i}}{\\sum_j e^{x_j}} $$\n\n\u042d\u043b\u0435\u043c\u0435\u043d\u0442 $p_j$ \u0432\u0435\u043a\u0442\u043e\u0440\u0430 $\\vec{p}$ \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u043d\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c\u044e \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c \u043a\u043b\u0430\u0441\u0441\u0430 $j$ \u0434\u043b\u044f \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430. \u0417\u0430\u0434\u0430\u0447\u0435\u0439 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0438 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043c\u0430\u043a\u0441\u0438\u043c\u0438\u0437\u0430\u0446\u0438\u044f \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0438 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0445 \u043a\u043b\u0430\u0441\u0441\u043e\u0432 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430:\n$$ P_{\\text{model}}(C^{(1)} = c^{(1)} \\land C^{(2)} = c^{(2)} \\land~... ~\\land C^{(N)} = c^{(N)}) = \\prod_{i=1}^N p^{(i)}_{c^{(i)}}$$\n\u0433\u0434\u0435 $\\vec{p}^{(i)}$ - \u0432\u044b\u0434\u0430\u0432\u0430\u0435\u043c\u043e\u0435 \u043c\u043e\u0434\u0435\u043b\u044c\u044e \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0435\u0439 \u043d\u0430\u0434 \u043a\u043b\u0430\u0441\u0441\u0430\u043c\u0438 \u0434\u043b\u044f $i$-\u0433\u043e \u044d\u043a\u0437\u0435\u043c\u043f\u044f\u0440\u0430, $C^{(i)}$ - \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u0430, \u043e\u0431\u043e\u0437\u043d\u0430\u0447\u0430\u044e\u0449\u0430\u044f \u043a\u043b\u0430\u0441\u0441 $i$-\u0433\u043e \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430, \u0430 $c^{(i)}$ - \u043d\u043e\u043c\u0435\u0440 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0430 \u0434\u043b\u044f $i$-\u0433\u043e \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430.\n\u041a\u0440\u0438\u0442\u0435\u0440\u0438\u0439 \u043c\u043e\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u0430\u0442\u044c \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u043b\u043e\u0433\u0430\u0440\u0438\u0444\u043c\u0430 \u0438 \u0443\u0441\u0440\u0435\u0434\u043d\u0435\u043d\u0438\u044f (\u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u043e\u0441\u0442\u0430\u043d\u0443\u0442\u0441\u044f \u0442\u0435\u043c\u0438 \u0436\u0435), \u0430 \u0442\u0430\u043a \u0436\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0432 \u0437\u043d\u0430\u043a \u0434\u043b\u044f \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0432 \u0437\u0430\u0434\u0430\u0447\u0443 \u043c\u0438\u043d\u0438\u043c\u0438\u0437\u0430\u0446\u0438\u0438, \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043a\u0440\u0438\u0442\u0435\u0440\u0438\u0439 \u0431\u043e\u043b\u0435\u0435 \u0441\u0442\u0430\u0431\u0438\u043b\u0435\u043d \u0434\u043b\u044f \u0447\u0438\u0441\u043b\u0435\u043d\u043d\u043e\u0439 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0438 \u0437\u0430 \u0441\u0447\u0435\u0442 \u0443\u0441\u0440\u0435\u0434\u043d\u0435\u043d\u0438\u044f \u0431\u043e\u043b\u0435\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0432\u0435\u043d (\u043d\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u043d\u0430\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445). \u0418\u0442\u043e\u0433\u043e, \u0437\u0430\u0434\u0430\u0447\u0435\u0439 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0438 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f \u043c\u0438\u043d\u0438\u043c\u0438\u0437\u0430\u0446\u0438\u044f:\n$$\\underset{\\theta}{\\operatorname{argmin}}  -\\frac{1}{N}\\sum_{i=1}^N \\log p^{(i)}_{c^{(i)}}$$\n\u0433\u0434\u0435 $\\theta$ - \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u043e \u0432\u0441\u0435\u0445 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u043c\u043e\u0434\u0435\u043b\u0438 ($W$, $b$)","2b1d2f8b":"## \u0417\u0430\u0434\u0430\u043d\u0438\u0435 5 \n\n\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043d\u0435\u0439\u0440\u043e\u043d\u043d\u0443\u044e \u0441\u0435\u0442\u044c \u0438\u0437 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0433\u043e \u0448\u0430\u0433\u0430 \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0441\u0438\u043d\u0442\u0435\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043d\u0430\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 (\u043a\u043b\u0430\u0441\u0441 \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043d\u0430 \u0441\u043f\u0438\u0440\u0430\u043b\u0438). \u041f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0433\u0440\u0430\u043d\u0438\u0446\u0443 \u043f\u0440\u0438\u043d\u044f\u0442\u0438\u044f \u0440\u0435\u0448\u0435\u043d\u0438\u0439 (\u0447\u0435\u0440\u0435\u0437 \u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0435 \u043d\u0430 \u0441\u0435\u0442\u043a\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439).","306df80f":"\u041d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0443\u0435\u043c \u043a\u0430\u0436\u0434\u044b\u0439 \u043e\u0442\u043e\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u0441\u0442\u043e\u043b\u0431\u0435\u0446:\n$$X^{(i)}_j = \\frac{X^{(i)}_j - \\overline{X_j}}{\\sqrt{\\sigma_j^2}}$$\n$$\\overline{X_j} = \\frac{1}{N}\\sum_{i=1}^N X^{(i)}_j$$\n$${\\sigma_j^2} = \\frac{1}{N}\\sum_{i=1}^N  (X^{(i)}_j - \\overline{X_j})^2$$","65e28b54":"\u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u043c \u043c\u0435\u0442\u043a\u0438 \u0432 \u0442\u0435\u043d\u0437\u043e\u0440\u044b","5939ca33":"covertype \u0438\u043c\u0435\u0435\u0442 \u043a\u043b\u0430\u0441\u0441 Bunch - \u0441\u043b\u043e\u0432\u0430\u0440\u044c, \u043a \u043a\u043b\u044e\u0447\u0430\u043c \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u043c\u043e\u0436\u043d\u043e \u043e\u0431\u0440\u0430\u0449\u0430\u0442\u044c\u0441\u044f \u043a\u0430\u043a \u043a \u043f\u043e\u043b\u044f\u043c (b['key'] -> b.key)","6aacd1e7":"\u0422\u0435\u043f\u0435\u0440\u044c \u043a\u0430\u0436\u0434\u044b\u0439 \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0441\u0442\u043e\u043b\u0431\u0435\u0446 \u0438\u043c\u0435\u0435\u0442 \u0441\u0440\u0435\u0434\u043d\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 0 \u0438 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u043e\u0435 \u043e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u0435 1","a1c9895e":"## \u0417\u0430\u0434\u0430\u043d\u0438\u0435 1\n\u0412\u044b\u0447\u0438\u0441\u043b\u0438\u0442\u044c \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 (\u0434\u043b\u044f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432, \u043e\u0442\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 \u0447\u0435\u0440\u0435\u0437 ; \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442 \u043d\u0435 \u043d\u0443\u0436\u0435\u043d):\n0. $$f(\\vec{x}; i) = \\log \\frac{e^{x_i}}{\\sum_{j=1}^n{e^{x_j}}}$$\n1. $$f(x,\\vec{y},\\vec{z}) = 2x + (3 - sin(\\vec{y} \\cdot \\vec{z}))^x$$\n2. $$f(\\vec{w}; \\vec{x}) = \\frac{1}{1 + e^{- \\vec{w} \\cdot \\vec{x}}}$$\n3. $$f(\\vec{a}; \\alpha, \\vec{b}, \\vec{c}) = \\text{max}(0, \\alpha + ||\\vec{a} - \\vec{b}||_2 - ||\\vec{a} - \\vec{c}||_2); ~~||\\vec{a} - \\vec{b}||_2 = \\sum_{i}(a_i - b_i)^2$$\n4. $$f(\\vec{x}) = \\max_i(|x_i|)$$\n5. $$f(\\vec{u}; \\vec{x}) = \\sum_i \\alpha_i x_i; ~\\alpha_i = \\frac{e^{u_i}} {\\sum_{j=1}^n e^{u_j}}$$\n6. $$f(\\vec{x}, \\vec{y}) = \\cos(\\vec{x}, \\vec{y})$$\n7. $$f(\\vec{x}, \\vec{y}) = \\cos(\\vec{x} - \\overline{x}, \\vec{y} - \\overline{y});~ \\overline{x} = \\frac{1}{n}\\sum_{i=1}^n x_i$$\n8. $$f(\\vec{x}, \\vec{y}) = \\frac{  \\sum_{i=1}^n (x_i - \\overline{x})(y_i - \\overline{y}) }{\\sqrt{ \\sum_{i=1}^n (x_i - \\overline{x})^2} \\sqrt{ \\sum_{i=1}^n (y_i - \\overline{y})^2} } $$\n9. $$f(\\vec{u}) = -\\sum_{i=1}^n p_i \\log p_i ; ~ p_i = \\frac{e^{u_i}} {\\sum_{j=1}^n e^{u_j}}$$\n10. $$f(\\vec{w};  \\vec{x}) = \\begin{cases} \n\\vec{w} \\cdot \\vec{x} & \\mbox{if } \\vec{w} \\cdot \\vec{x} > 0 \\\\ \na(e^{\\vec{w} \\cdot \\vec{x}}-1) & \\mbox{otherwise}\n\\end{cases}$$\n11. $$f(x, \\vec{a},\\vec{b}) = \\max_{i}[(a_i - x)^2 + b_i^2]$$","0ef1847b":"\u0412\u044b\u0431\u0435\u0440\u0435\u043c \u0441\u0442\u043e\u043b\u0431\u0446\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0440\u0435\u0434\u043f\u043e\u0447\u0442\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c (\u0446\u0435\u043d\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0432\u043e\u043a\u0440\u0443\u0433 \u043d\u0443\u043b\u044f \u0438 \u043f\u0440\u0438\u0432\u0435\u0441\u0442\u0438 \u0432 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0439 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d) \u043f\u0435\u0440\u0435\u0434 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u043e\u0439 \u0432 \u0441\u0435\u0442\u044c. \u0412\u044b\u0431\u0435\u0440\u0435\u043c \u0432\u0441\u0435 \u043d\u0435\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438 (\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u0443\u0436\u0435 \u0437\u0430\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u044b)","1ad468f9":"\u041f\u0440\u0438\u043c\u0435\u0440:\n\u041d\u0430\u0439\u0442\u0438 \u043c\u0438\u043d\u0438\u043c\u0443\u043c \u0444\u0443\u043d\u043a\u0446\u0438\u0438: $$f(\\vec{x}) = \\sum_i x_i^2$$\n\u041e\u0447\u0435\u0432\u0438\u0434\u043d\u043e, \u0447\u0442\u043e \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043d\u0443\u043b\u0435\u0432\u043e\u0435, \u043e\u0434\u043d\u0430\u043a\u043e \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0435\u043c \u043f\u0440\u0438\u0439\u0442\u0438 \u043a \u043d\u0435\u043c\u0443 \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442\u043d\u044b\u043c \u0441\u043f\u0443\u0441\u043a\u043e\u043c","2451a4f8":"\u0414\u043b\u044f \u043d\u0430\u0433\u043b\u044f\u0434\u043d\u043e\u0441\u0442\u0438 \u043f\u043e\u0441\u0442\u0440\u043e\u0438\u043c \u0442\u0430\u0431\u043b\u0438\u0446\u0443 pandas","e234a955":"DataLoader \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 Dataset \u043f\u0430\u0447\u043a\u0430\u043c\u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432. Dataloader \u0438\u043c\u0435\u0435\u0442 \u043c\u043d\u043e\u0433\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a, \u043d\u043e \u0432 \u0434\u0430\u043d\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043c\u044b \u043f\u0440\u043e\u0441\u0442\u043e \u0431\u0443\u0434\u0435\u043c \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u0432\u044b\u0440\u0435\u0437\u043a\u0438 \u0442\u0435\u043d\u0437\u043e\u0440\u043e\u0432 (256 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 256 \u043c\u0435\u0442\u043e\u043a)"}}