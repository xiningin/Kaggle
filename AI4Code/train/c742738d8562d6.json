{"cell_type":{"169d609d":"code","35aa8c94":"code","e8329d64":"code","53b9123b":"code","b8433bef":"markdown","e34da55d":"markdown"},"source":{"169d609d":"import os\nprint(os.listdir(\"..\/input\/efficientnet\/efficientnet-master\/efficientnet-master\/efficientnet\"))\nimport sys\nsys.path.append(os.path.abspath('..\/input\/efficientnet\/efficientnet-master\/efficientnet-master\/'))\nfrom efficientnet import EfficientNetB5","35aa8c94":"import json\nimport math\nimport os\n\nimport cv2\nfrom PIL import Image\nimport numpy as np\nfrom keras import layers\nfrom keras.applications import DenseNet121\nfrom keras import applications\nfrom keras.layers import *\nfrom keras.models import *\nfrom keras.callbacks import Callback, ModelCheckpoint\nfrom keras.preprocessing.image import ImageDataGenerator\nfrom keras.models import Sequential\nfrom keras.optimizers import Adam\nimport matplotlib.pyplot as plt\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import cohen_kappa_score, accuracy_score\nimport scipy\nfrom tqdm import tqdm\n\n%matplotlib inline","e8329d64":"from efficientnet import EfficientNetB5\n\neffnet = EfficientNetB5(\n    weights= None, \n    include_top=False,\n    input_shape=(224,224,3)\n)\n\ndef build_model():\n    model = Sequential()\n    model.add(effnet)\n    model.add(layers.GlobalAveragePooling2D())\n    model.add(layers.Dropout(0.5))\n    model.add(layers.Dense(5, activation='sigmoid'))\n    effnet.load_weights('..\/input\/efficientnet-keras-weights-b0b5\/efficientnet-b5_imagenet_1000_notop.h5')\n    model.compile(\n        loss='categorical_crossentropy',\n        optimizer=Adam(lr=0.0005),\n        metrics=['accuracy']\n    )\n    \n    return model\nmodel = build_model()\n","53b9123b":"model.summary()","b8433bef":"# EfficientNet","e34da55d":"- In this kernel, I will show you how to use the keras efficientNet for APTOS 2019, you can customise the rest\n\n- orginal code:\n[https:\/\/github.com\/qubvel\/efficientnet](http:\/\/)\n\n- original weights: [https:\/\/www.kaggle.com\/kerneler\/starter-efficientnet-keras-weights-b0-55f27ab0-b](http:\/\/)"}}