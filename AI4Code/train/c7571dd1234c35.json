{"cell_type":{"63bac53c":"code","7a5d2acb":"code","43c3a108":"code","6ca0e66c":"code","3e847e15":"code","fb231d4a":"code","e4ed84d0":"code","ebaa5fb6":"code","c9d94b9a":"code","f15a8efa":"code","000a5e3e":"code","87816cef":"code","153014e3":"code","db475049":"code","b6100acd":"code","4dcd9349":"code","9c2f3c5f":"code","6c9c755a":"code","a2e717e7":"code","7bc70ebf":"code","01d1e1a4":"code","cf82d244":"code","d3bbd052":"markdown"},"source":{"63bac53c":"import numpy as np\nimport pandas as pd\nimport tensorflow as tf\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom keras.layers import Dense, Activation\nfrom keras.models import Sequential\n%matplotlib inline","7a5d2acb":"data = pd.read_csv(\"..\/input\/Skyserver_SQL2_27_2018 6_51_39 PM.csv\")","43c3a108":"data.head()","6ca0e66c":"data.drop(['objid','specobjid'], axis=1, inplace=True)","3e847e15":"data.head()","fb231d4a":"sns.countplot(x=data['class'])","e4ed84d0":"#CONVERT AS CLASSES PARA ONE HOT ENCODING\nlabels = pd.get_dummies(data['class'], prefix='class')\ndata = data.drop(columns='class', axis=1)\n\ndata.head()","ebaa5fb6":"data.drop(['run','rerun','camcol','field'],axis=1,inplace=True)","c9d94b9a":"data.head()","f15a8efa":"from sklearn import preprocessing\n\nscaler = preprocessing.MinMaxScaler()\n\nnormalizado = scaler.fit_transform(data)\n\ntrain = pd.DataFrame(normalizado)","000a5e3e":"train.head()","87816cef":"X_train, X_test, y_train, y_test = train_test_split(train, labels, test_size=0.2, random_state=128)","153014e3":"y_train.shape","db475049":"model = Sequential()\n\nmodel.add(Dense(30, input_dim=X_train.shape[1], activation='sigmoid'))\nmodel.add(Dense(10, activation='sigmoid'))\nmodel.add(Dense(3, activation='softmax'))\nmodel.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])","b6100acd":"history = model.fit(X_train, y_train, epochs=100, batch_size=12, validation_split=0.10)","4dcd9349":"y_pred = model.predict(X_test)","9c2f3c5f":"score = model.evaluate(X_test, y_test, verbose=0) ","6c9c755a":"score","a2e717e7":"import matplotlib.pyplot as plt\n\nprint(history.history.keys())\n# summarize history for accuracy\nplt.plot(history.history['acc'])\nplt.plot(history.history['val_acc'])\nplt.title('model accuracy')\nplt.ylabel('Acur\u00e1cia')\nplt.xlabel('\u00c9poca')\nplt.legend(['train', 'test'], loc='upper left')\nplt.show()\n# summarize history for loss\nplt.plot(history.history['loss'])\nplt.plot(history.history['val_loss'])\nplt.title('model loss')\nplt.ylabel('loss')\nplt.xlabel('\u00c9poca')\nplt.legend(['train', 'test'], loc='upper left')\nplt.show()","7bc70ebf":"model.summary()","01d1e1a4":"from keras.utils import plot_model\n\nplot_model(model, to_file='model_plot.png', show_shapes=True, show_layer_names=True)","cf82d244":"!ls","d3bbd052":"# Sloan Digital Sky Survey"}}