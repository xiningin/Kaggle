{"cell_type":{"f1604226":"code","b4eecca8":"code","d9268fa9":"code","2fe95e66":"code","b1c2772a":"code","393e0867":"code","1af85f32":"code","c062c2b0":"code","0a02fdbc":"code","b2029e00":"code","e05d1269":"code","4af64802":"code","29f73949":"code","4bee9214":"code","3a4087e3":"code","76fbcb6c":"code","9dec543c":"code","b22a8a78":"code","c2b93845":"code","b9f38ec8":"code","67e7ee5c":"code","87244dba":"code","91e07fb0":"code","83f1871e":"code","1457259d":"code","22e7cf90":"code","2d6b4346":"code","6c2ccafc":"code","e25e7683":"code","f9fc8020":"code","9f760baf":"code","640a9943":"code","57a2f560":"code","bed7a7aa":"code","d60c92f4":"code","23137d2c":"code","f71f1332":"code","401f9672":"code","97b16f9b":"code","942a9423":"code","b0b09c1c":"code","54b2f34a":"code","e8956145":"code","c660030b":"code","cff8e61d":"code","abaf4aaa":"code","7a222598":"code","98e8b03e":"code","178afef2":"code","d43324db":"code","ba6e6d87":"code","84911b79":"code","c48e01f1":"code","72104a41":"code","d402efcb":"code","e7adeb21":"code","76fa4cfc":"code","5b02ee33":"code","ce99d03c":"code","bc6d46b8":"code","36e9e125":"code","21bf55df":"code","d0f08b09":"markdown","494ea44c":"markdown","27dae3bf":"markdown","a99e1080":"markdown","f6db0778":"markdown","c5bbdb05":"markdown"},"source":{"f1604226":"import pandas as pd","b4eecca8":"data = pd.read_csv(\"..\/input\/pakistans-largest-ecommerce-dataset\/Pakistan Largest Ecommerce Dataset.csv\")\ndata.head()","d9268fa9":"data.shape","2fe95e66":"data.tail()","b1c2772a":"data.columns","393e0867":"# Dropping unncessary columns\ndata = data.drop(['Unnamed: 21', 'Unnamed: 22', 'Unnamed: 23',\n       'Unnamed: 24', 'Unnamed: 25'],axis=1)","1af85f32":"data.shape","c062c2b0":"#Dropping empty rows\ndata = data.dropna(how = 'all')","0a02fdbc":"data.shape","b2029e00":"data.head()","e05d1269":"data['status'].unique()","4af64802":"data['status'].value_counts()","29f73949":"data.isnull().sum()","4bee9214":"# Checking the most frequent value to fill NaN\ndata['category_name_1'].mode(),data['status'].mode()","3a4087e3":"# Filling NaN values\ndata['category_name_1'] = data['category_name_1'].fillna(\"Mobiles % Tablets\")\ndata['status'] = data['status'].fillna(\"complete\")","76fbcb6c":"data.isnull().sum()","9dec543c":"data['status']","b22a8a78":"data.dtypes","c2b93845":"# Correcting data types of columns\ndata['Customer ID'] = data['Customer ID'].astype(str)\ndata['item_id'] = data['item_id'].astype(str)\ndata['qty_ordered'] = data['qty_ordered'].astype(int)  \ndata[\"Month\"] = data[\"Month\"].astype(int)\ndata[\"Year\"] = data[\"Year\"].astype(int)","b9f38ec8":"data.dtypes","67e7ee5c":"# Order Frequcney\ndata['status'].value_counts().plot.bar(figsize=(12,8),title='Order Frequency Plot')","87244dba":"ord_2016 = data[data['Year']==2016]\nord_2016['status'].value_counts().plot.bar(figsize=(12,8),title='Orders in 2016')","91e07fb0":"ord_2017 = data[data['Year']==2017]\nord_2017['status'].value_counts().plot.bar(figsize=(12,8),title='Orders in 2017')","83f1871e":"ord_2018 = data[data['Year']==2018]\nord_2018['status'].value_counts().plot.bar(figsize=(12,8),title='Orders in 2018')","1457259d":"# best selling category\ndata['category_name_1'].value_counts().plot.bar(figsize=(12,8),title =\"Plotting the number of orders categories \")","22e7cf90":"# Best Payment Method\ndata['payment_method'].value_counts().plot.bar(figsize=(12,8),title='Order Frquency plot w.r.t Payment Method')","2d6b4346":"data_comp = data[data['status']=='complete'] \ndata_comp['payment_method'].value_counts().plot.bar(figsize=(12,8),title='Complete Order')","6c2ccafc":"data_rec = data[data['status']=='received'] \ndata_rec['payment_method'].value_counts().plot.bar(figsize=(12,8),title='Recieved Order')","e25e7683":"data_can = data[data['status']=='canceled'] \ndata_can['payment_method'].value_counts().plot.bar(figsize=(12,8),title='Cancelled Order')","f9fc8020":"data_ref = data[data['status']=='order_refunded'] \ndata_ref['payment_method'].value_counts().plot.bar(figsize=(12,8),title='Refunded Order')","9f760baf":"# encdoing categorical columns; payment method and status to numbers to compute corelation between two\ndata['payment_encoded'] = data['payment_method'].astype(\"category\").cat.codes\ndata['status_encoder']= data['status'].astype(\"category\").cat.codes","640a9943":"import seaborn as sns\nimport matplotlib.pyplot as plt\n\ncor = data.corr()\nplt.figure(figsize = (12,8))\nsns.heatmap(cor,annot=True)","57a2f560":"# encdoing categorical columns; payment method and status to numbers to compute corelation between two\ndata['category_corr'] = data['category_name_1'].astype(\"category\").cat.codes\ndata['order_date_corr'] = data['created_at'].astype(\"category\").cat.codes\ncor = data.corr()\nplt.figure(figsize = (12,8))\nsns.heatmap(cor,annot=True)","bed7a7aa":"# Installing Pre-requiste libraires to read an Excel file\n!pip install xlrd\n!pip install openpyxl","d60c92f4":"import pandas as pd\ndf = pd.read_excel(\"..\/input\/ecommerce-pakistan-for-cl\/New_data.xlsx\")\ndf.head()","23137d2c":"df['Status'].unique()","f71f1332":"df['payment_method'].unique()","401f9672":"df.shape","97b16f9b":"df[df['Status']=='\\\\0']","942a9423":"# Dropping disturing rows\ndf = df.drop(labels=[255520,255521,255624,255625],axis=0)","b0b09c1c":"df['category_name_1'].value_counts()","54b2f34a":"df","e8956145":"# Initilizing encoder to transform categorical columns into numbers\nfrom sklearn.preprocessing import LabelEncoder\nencoder= LabelEncoder()","c660030b":"df['category_name_1'] = encoder.fit_transform(df['category_name_1'])","cff8e61d":"df['payment_method'] = encoder.fit_transform(df['payment_method'])","abaf4aaa":"df","7a222598":"# Filling NaN status values\ndf['Status'] = df['Status'].fillna(1)","98e8b03e":"df['Status'].unique()","178afef2":"df['category_name_1'].unique()","d43324db":"df['payment_method'].unique()","ba6e6d87":"# Seperating data and labels\nX, y = df.loc[:, df.columns!=\"Status\"],df.Status","84911b79":"X.shape","c48e01f1":"y.shape","72104a41":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state=42)","d402efcb":"X_train.shape,X_test.shape","e7adeb21":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import RandomForestClassifier","76fa4cfc":"rf = RandomForestClassifier()\nrf.fit(X_train,y_train)\nprint(\"Random Forest Acc :\" ,rf.score(X_test,y_test))\n\nkn = KNeighborsClassifier()\nkn.fit(X_train,y_train)\nprint(\"KNN Acc :\",kn.score(X_test,y_test))\n\ncl = LogisticRegression()\ncl.fit(X_train,y_train)\nprint('Log Reg Acc :',cl.score(X_test,y_test))","5b02ee33":"print(\"Predictions of Log Reg \",y_test[0:10],cl.predict(X_test[0:10]))\nprint(\"Predictions of Ran For \",y_test[0:10],rf.predict(X_test[0:10]))\nprint(\"Predictions of KNN \",y_test[0:10],kn.predict(X_test[0:10]))","ce99d03c":"# Normalizing the price columns\nfrom sklearn.preprocessing import MinMaxScaler\nscale = MinMaxScaler([0,1])\nscale.fit(X_train[['price']])\nX_train['price'] = scale.transform(X_train[['price']])\nX_test['price'] = scale.transform(X_test[['price']])\nX_train","bc6d46b8":"print(\"Results after Normalizing the data\")\n\nrf = RandomForestClassifier()\nrf.fit(X_train,y_train)\nprint(\"Random Forest Acc :\" ,rf.score(X_test,y_test))\n\nkn = KNeighborsClassifier()\nkn.fit(X_train,y_train)\nprint(\"KNN Acc :\",kn.score(X_test,y_test))\n\ncl = LogisticRegression()\ncl.fit(X_train,y_train)\nprint('Log Reg Acc :',cl.score(X_test,y_test))","36e9e125":"from sklearn.inspection import permutation_importance\nmodel = cl.fit(X,y)\nresults = permutation_importance(model,X,y,n_repeats=10)\nfor i in results.importances_mean.argsort():\n    print(X.columns[i],results.importances_mean[i])","21bf55df":"import matplotlib.pyplot as plt\nfeatures = []\nim_mean = []\n\nfor i in results.importances_mean.argsort():\n    features.append(i)\n    im_mean.append(results.importances_mean[i])\n\nplt.xlabel('Features')\nplt.ylabel(\"Imporance mean\")\nplt.bar(range(len(im_mean)),im_mean)\nplt.xticks(range(len(features)),X.columns[features])","d0f08b09":"# # Finding a correlation between payment method and order status","494ea44c":"# # Preprocssing data","27dae3bf":"# # Visualizing payment method and order status frequency","a99e1080":"# # Investigating the data","f6db0778":"# Can we predict number of orders, or item category or number of customers\/amount in advance?","c5bbdb05":"# Finding a correlation between order date and item category"}}