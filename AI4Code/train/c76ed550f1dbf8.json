{"cell_type":{"c06f94ec":"code","366b9c56":"code","09fa8594":"code","18d35f70":"code","aa2b742d":"code","075cdd69":"code","af355033":"code","029a2c5b":"code","c63a2308":"code","ea9eb1d2":"code","acddc08c":"code","13662d19":"code","466a8e1e":"code","5c0f0207":"code","c51cad46":"code","e56f72a7":"code","7c5ea72e":"code","319d1ebb":"code","431013df":"code","b289c120":"code","16c6bc56":"code","35ed034a":"code","3b010e86":"code","8e15d21d":"code","9f4fa0e2":"code","e4dc7cd2":"code","2198a50c":"code","474a8c59":"code","da47cdd7":"code","ee1b50b5":"code","081f042d":"code","4b5b164f":"code","cfda721b":"code","9de275fc":"code","5d1aeed6":"code","8160015d":"code","082e172c":"code","28c85213":"code","6d826176":"code","bae2b66a":"code","8dde84dc":"code","eafc96d8":"code","3f44485e":"code","066919be":"code","569b0e81":"code","9931736f":"code","62117084":"code","aab6905e":"code","20d10200":"code","7d363a46":"code","311242f9":"code","13855f0f":"code","9e0ab111":"code","f664e852":"code","f4458081":"code","822719fb":"code","78eb9e67":"code","84085c64":"code","b4816753":"code","e573d24b":"code","863645fe":"code","604c7bdd":"code","931ca651":"code","cf50c455":"code","2aa1e410":"code","986dd7ab":"code","e34371fc":"code","c36d6292":"code","22f33b51":"code","600d99f2":"code","a707fd16":"code","de796946":"code","534be168":"code","d3dac082":"code","d48e5cef":"code","29dea469":"code","cfeeaeb5":"code","3827bdb3":"code","aa92bdca":"code","440fa94f":"code","8a687bf7":"code","d8cbf12d":"code","0c230206":"code","87743218":"code","25a564c2":"code","b8cef23f":"code","ebf30c63":"code","9d42461f":"code","e0b7cc2f":"code","cb3491ce":"code","b5974413":"code","5b25224a":"code","3b8ff88e":"code","b969f6c4":"code","5a3d5386":"code","bc73da81":"code","1832fbcd":"code","61ea0ed5":"code","e414f72d":"code","7eb3b365":"code","7d962a17":"code","c7392e6b":"code","3fdb502d":"code","0c0b8b66":"code","1d172e06":"code","ac8acedc":"markdown","c0f58fa3":"markdown","a3cbf25d":"markdown","db19c26d":"markdown","8a24d47e":"markdown","8aea74f7":"markdown","ea2a117e":"markdown","d784b078":"markdown","12ed778f":"markdown","49b4f01c":"markdown","46d8cdae":"markdown","951b3ee2":"markdown","ea9555a5":"markdown","f328bffa":"markdown","342d4f19":"markdown","bf38c765":"markdown","74e9acad":"markdown","499087c9":"markdown","a6307126":"markdown","8e8bfcbb":"markdown","be875b90":"markdown","a0728e96":"markdown","1a917096":"markdown","3cf0133c":"markdown","8f71c479":"markdown","5baa9a8b":"markdown","6b9af0e5":"markdown","8167fe57":"markdown","314d404f":"markdown","db1cce8b":"markdown","77ed38fb":"markdown","9f9cc54d":"markdown","748e7dd7":"markdown","c1d40796":"markdown","7e6cb00b":"markdown","bfc251c3":"markdown","bb894689":"markdown","40a57307":"markdown","a694ff1a":"markdown","93e58deb":"markdown","ba4adb95":"markdown","e425327a":"markdown","923e57c0":"markdown","4aacc7f0":"markdown","ed22c8d2":"markdown","9d0f1e5e":"markdown","478c3260":"markdown","26066872":"markdown","6ccacc93":"markdown","c749f606":"markdown"},"source":{"c06f94ec":"\n# Import our libraries\nimport pandas as pd\nimport numpy as np\n\n# Import sklearn libraries\nfrom sklearn.model_selection import train_test_split, GridSearchCV, StratifiedKFold, cross_val_score\nfrom sklearn.model_selection import cross_validate\nfrom sklearn.metrics import accuracy_score, precision_score, recall_score, roc_curve, precision_recall_curve, auc, make_scorer, confusion_matrix, f1_score, fbeta_score\n\n# Import the Naive Bayes, logistic regression, Bagging, RandomForest, AdaBoost, GradientBoost, Decision Trees and SVM Classifier\n\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.ensemble import BaggingClassifier, RandomForestClassifier, AdaBoostClassifier, GradientBoostingClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn import svm\nfrom xgboost import XGBClassifier\n\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n#from matplotlib import style\n#plt.style.use('bmh')\n#plt.style.use('ggplot')\nplt.style.use('seaborn-notebook')\n\nfrom matplotlib.ticker import StrMethodFormatter\n\nfrom sklearn.preprocessing import StandardScaler, MinMaxScaler, LabelBinarizer\n","366b9c56":"#titanic_features = pd.read_csv('train.csv')\ntest_df = pd.read_csv('\/kaggle\/input\/titanic\/test.csv')\ntrain_df = pd.read_csv('\/kaggle\/input\/titanic\/train.csv')","09fa8594":"train_df.info()","18d35f70":"train_df.shape","aa2b742d":"test_df.shape","075cdd69":"test_df.info()","af355033":"train_df.head()","029a2c5b":"train_df.describe()","c63a2308":"total = train_df.isnull().sum().sort_values(ascending=False)\npercent_1 = train_df.isnull().sum()\/train_df.isnull().count()*100\npercent_2 = (round(percent_1, 1)).sort_values(ascending=False)\nmissing_data = pd.concat([total, percent_2], axis=1, keys=['Total', '%'])\nmissing_data.head(5)","ea9eb1d2":"train_df.columns.values","acddc08c":"from IPython.display import HTML\nHTML('''<script>\ncode_show_err=false; \nfunction code_toggle_err() {\n if (code_show_err){\n $('div.output_stderr').hide();\n } else {\n $('div.output_stderr').show();\n }\n code_show_err = !code_show_err\n} \n$( document ).ready(code_toggle_err);\n<\/script>\nTo toggle on\/off output_stderr, click <a href=\"javascript:code_toggle_err()\">here<\/a>.''')","13662d19":"train_df['Embarked'].value_counts()\/len(train_df)","466a8e1e":"sns.set(style=\"darkgrid\")\nsns.countplot( x='Embarked', data=train_df, hue=\"Embarked\", palette=\"Set1\");","5c0f0207":"sns.set(style=\"darkgrid\")\nsns.countplot( x='Survived', data=train_df, hue=\"Embarked\", palette=\"Set1\");","c51cad46":"train_df.groupby('Embarked').mean()","e56f72a7":"train_df.groupby('Sex').mean()","7c5ea72e":"FacetGrid = sns.FacetGrid(train_df, row='Embarked', size=4.5, aspect=1.6)\nFacetGrid.map(sns.pointplot, 'Pclass', 'Survived', 'Sex', order=None, hue_order=None )\nFacetGrid.add_legend();","319d1ebb":"survived = 'survived'\nnot_survived = 'not survived'\nfig, axes = plt.subplots(nrows=1, ncols=2,figsize=(16, 8))\nwomen = train_df[train_df['Sex']=='female']\nmen = train_df[train_df['Sex']=='male']\nax = sns.distplot(women[women['Survived']==1].Age.dropna(), bins=18, label = survived, ax = axes[0], kde =False, color=\"green\")\nax = sns.distplot(women[women['Survived']==0].Age.dropna(), bins=40, label = not_survived, ax = axes[0], kde =False, color=\"red\")\nax.legend()\nax.set_title('Female')\nax = sns.distplot(men[men['Survived']==1].Age.dropna(), bins=18, label = survived, ax = axes[1], kde = False, color=\"green\")\nax = sns.distplot(men[men['Survived']==0].Age.dropna(), bins=40, label = not_survived, ax = axes[1], kde = False, color=\"red\")\nax.legend()\n_ = ax.set_title('Male');","431013df":"sns.barplot(x='Pclass', y='Survived', data=train_df);","b289c120":"grid = sns.FacetGrid(train_df, col='Survived', row='Pclass', size=3.2, aspect=1.6)\ngrid.map(plt.hist, 'Age', alpha=.5, bins=20)\ngrid.add_legend();","16c6bc56":"data = [train_df, test_df]\nfor dataset in data:\n    dataset['relatives'] = dataset['SibSp'] + dataset['Parch']\n    dataset.loc[dataset['relatives'] > 0, 'travelled_alone'] = 'No'\n    dataset.loc[dataset['relatives'] == 0, 'travelled_alone'] = 'Yes'\n    #dataset['travelled_alone'] = dataset['travelled_alone'].astype(int)\ntrain_df['travelled_alone'].value_counts()","35ed034a":"test_df['travelled_alone'].value_counts()","3b010e86":"train_df['relatives'].value_counts()","8e15d21d":"axes = sns.factorplot('relatives','Survived', \n                      data=train_df, aspect = 2.5, );","9f4fa0e2":"# Drop 'PassengerId' from the train set, because it does not contribute to a persons survival probability.\ntrain_df = train_df.drop(['PassengerId'], axis=1)","e4dc7cd2":"train_df['Cabin'].describe()","2198a50c":"import re\ndeck = {\"A\": \"A\", \"B\": \"B\", \"C\": \"C\", \"D\": \"D\", \"E\": \"E\", \"F\": \"F\", \"G\": \"G\", \"U\": \"U\"}\ndata = [train_df, test_df]\n\nfor dataset in data:\n    dataset['Cabin'] = dataset['Cabin'].fillna(\"U0\")\n    dataset['Deck'] = dataset['Cabin'].map(lambda x: re.compile(\"([a-zA-Z]+)\").search(x).group())\n    dataset['Deck'] = dataset['Deck'].map(deck)\n    dataset['Deck'] = dataset['Deck'].fillna(\"U\")\n    #dataset['Deck'] = dataset['Deck'].astype(int)\n# we can now drop the cabin feature\ntrain_df = train_df.drop(['Cabin'], axis=1)\ntest_df = test_df.drop(['Cabin'], axis=1)","474a8c59":"train_df['Deck'].value_counts()","da47cdd7":"train_df.groupby('Deck').mean()","ee1b50b5":"test_df['Deck'].value_counts()","081f042d":"data = [train_df, test_df]\n\nfor dataset in data:\n    mean = train_df[\"Age\"].mean()\n    std = test_df[\"Age\"].std()\n    is_null = dataset[\"Age\"].isnull().sum()\n    # compute random numbers between the mean, std and is_null\n    rand_age = np.random.randint(mean - std, mean + std, size = is_null)\n    # fill NaN values in Age column with random values generated\n    age_slice = dataset[\"Age\"].copy()\n    age_slice[np.isnan(age_slice)] = rand_age\n    dataset[\"Age\"] = age_slice\n    dataset[\"Age\"] = train_df[\"Age\"].astype(int)","4b5b164f":"train_df[\"Age\"].isnull().sum()","cfda721b":"test_df[\"Age\"].isnull().sum()","9de275fc":"train_df[\"Age\"].describe()","5d1aeed6":"#train_df.groupby('Age').mean()","8160015d":"train_df['Embarked'].describe()","082e172c":"train_df['Embarked'].mode()","28c85213":"#common_value = train_df['Embarked'].mode()\n#common_value","6d826176":"common_value = 'S'\ndata = [train_df, test_df]\n\nfor dataset in data:\n    dataset['Embarked'] = dataset['Embarked'].fillna(common_value)","bae2b66a":"test_df['Embarked'].describe()","8dde84dc":"data = [train_df, test_df]\n\nfor dataset in data:\n    dataset['Fare'] = dataset['Fare'].fillna(0)\n    dataset['Fare'] = dataset['Fare'].astype(int)","eafc96d8":"train_df['Fare'].describe()","3f44485e":"train_df['Fare'].isnull().sum()","066919be":"test_df['Fare'].describe()","569b0e81":"test_df['Fare'].isnull().sum()","9931736f":"train_df['Fare'] = train_df['Fare'].astype(int)","62117084":"test_df['Fare'] = test_df['Fare'].astype(int)","aab6905e":"train_titles = train_df.Name.str.extract(' ([A-Za-z]+)\\.', expand=False)\ntype(train_titles)","20d10200":"train_titles.value_counts()","7d363a46":"data = [train_df, test_df]\ntitles = {\"Mr\": 1, \"Miss\": 2, \"Mrs\": 3, \"Master\": 4, \"Rare\": 5}\n\nfor dataset in data:\n    # extract titles\n    dataset['Title'] = dataset.Name.str.extract(' ([A-Za-z]+)\\.', expand=False)\n    # replace titles with a more common title or as Rare\n    dataset['Title'] = dataset['Title'].replace(['Lady', 'Countess','Capt', 'Col','Don', 'Dr',\\\n                                            'Major', 'Rev', 'Sir', 'Jonkheer', 'Dona'], 'Rare')\n    dataset['Title'] = dataset['Title'].replace('Mlle', 'Miss')\n    dataset['Title'] = dataset['Title'].replace('Ms', 'Miss')\n    dataset['Title'] = dataset['Title'].replace('Mme', 'Mrs')\n    # convert titles into numbers\n    #dataset['Title'] = dataset['Title'].map(titles)\n    # filling NaN with 0, to get safe\n    dataset['Title'] = dataset['Title'].fillna(\"NA\")\ntrain_df = train_df.drop(['Name'], axis=1)\ntest_df = test_df.drop(['Name'], axis=1)","311242f9":"train_df.groupby(['Title']).mean()","13855f0f":"test_df.groupby(['Title']).mean()","9e0ab111":"train_df['Sex'].value_counts()","f664e852":"'''\ngenders = {\"male\": 0, \"female\": 1}\ndata = [train_df, test_df]\n\nfor dataset in data:\n    dataset['Sex'] = dataset['Sex'].map(genders)\n\n'''","f4458081":"train_df['Ticket'].describe()","822719fb":"test_df['Ticket'].describe()","78eb9e67":"train_df = train_df.drop(['Ticket'], axis=1)\ntest_df = test_df.drop(['Ticket'], axis=1)","84085c64":"'''\nports = {\"S\": 0, \"C\": 1, \"Q\": 2}\ndata = [train_df, test_df]\n\nfor dataset in data:\n    dataset['Embarked'] = dataset['Embarked'].map(ports)\n    \n'''    ","b4816753":"\ndata = [train_df, test_df]\nfor dataset in data:\n    dataset['Age_Class']= dataset['Age']* dataset['Pclass']\n    \n    ","e573d24b":"\nfor dataset in data:\n    dataset['Fare_Per_Person'] = dataset['Fare']\/(dataset['relatives']+1)\n    dataset['Fare_Per_Person'] = dataset['Fare_Per_Person'].astype(int)\n    ","863645fe":"data = [train_df, test_df]\nfor dataset in data:\n    dataset['Age'] = dataset['Age'].astype(int)\n    dataset.loc[ dataset['Age'] <= 11, 'Age'] = 0\n    dataset.loc[(dataset['Age'] > 11) & (dataset['Age'] <= 18), 'Age'] = 1\n    dataset.loc[(dataset['Age'] > 18) & (dataset['Age'] <= 22), 'Age'] = 2\n    dataset.loc[(dataset['Age'] > 22) & (dataset['Age'] <= 27), 'Age'] = 3\n    dataset.loc[(dataset['Age'] > 27) & (dataset['Age'] <= 33), 'Age'] = 4\n    dataset.loc[(dataset['Age'] > 33) & (dataset['Age'] <= 40), 'Age'] = 5\n    dataset.loc[(dataset['Age'] > 40) & (dataset['Age'] <= 66), 'Age'] = 6\n    dataset.loc[ dataset['Age'] > 66, 'Age'] = 7\n    \n    dataset['Age'] = dataset['Age'].astype(str)\n    dataset.loc[ dataset['Age'] == '0', 'Age'] = \"Children\"\n    dataset.loc[ dataset['Age'] == '1', 'Age'] = \"Teens\"\n    dataset.loc[ dataset['Age'] == '2', 'Age'] = \"Youngsters\"\n    dataset.loc[ dataset['Age'] == '3', 'Age'] = \"Young Adults\"\n    dataset.loc[ dataset['Age'] == '4', 'Age'] = \"Adults\"\n    dataset.loc[ dataset['Age'] == '5', 'Age'] = \"Middle Age\"\n    dataset.loc[ dataset['Age'] == '6', 'Age'] = \"Senior\"\n    dataset.loc[ dataset['Age'] == '7', 'Age'] = \"Retired\"\n\n# let's see how it's distributed \ntrain_df['Age'].value_counts()","604c7bdd":"test_df['Age'].value_counts()","931ca651":"train_df.info()","cf50c455":"data = [train_df, test_df]\n\nfor dataset in data:\n    dataset.loc[ dataset['Fare'] <= 7.91, 'Fare'] = 0\n    dataset.loc[(dataset['Fare'] > 7.91) & (dataset['Fare'] <= 14.454), 'Fare'] = 1\n    dataset.loc[(dataset['Fare'] > 14.454) & (dataset['Fare'] <= 31), 'Fare']   = 2\n    dataset.loc[(dataset['Fare'] > 31) & (dataset['Fare'] <= 99), 'Fare']   = 3\n    dataset.loc[(dataset['Fare'] > 99) & (dataset['Fare'] <= 250), 'Fare']   = 4\n    dataset.loc[ dataset['Fare'] > 250, 'Fare'] = 5\n    dataset['Fare'] = dataset['Fare'].astype(int)\n    \n    dataset['Fare'] = dataset['Fare'].astype(str)\n    dataset.loc[ dataset['Fare'] == '0', 'Fare'] = \"Extremely Low\"\n    dataset.loc[ dataset['Fare'] == '1', 'Fare'] = \"Very Low\"\n    dataset.loc[ dataset['Fare'] == '2', 'Fare'] = \"Low\"\n    dataset.loc[ dataset['Fare'] == '3', 'Fare'] = \"High\"\n    dataset.loc[ dataset['Fare'] == '4', 'Fare'] = \"Very High\"\n    dataset.loc[ dataset['Fare'] == '5', 'Fare'] = \"Extremely High\"\n    ","2aa1e410":"train_df['Fare'].value_counts()","986dd7ab":"test_df['Fare'].value_counts()","e34371fc":"train_df.info()","c36d6292":"test_df.info()","22f33b51":"# Let's take a last look at the training set\ntrain_df.head(10)","600d99f2":"train_df.info()","a707fd16":"test_df.info()","de796946":"train_df['Pclass'].value_counts()","534be168":"data = [train_df, test_df]\n\nfor dataset in data:\n    dataset['Pclass'] = dataset['Pclass'].astype(str)\n    dataset.loc[ dataset['Pclass'] == '1', 'Pclass'] = \"Class1\"\n    dataset.loc[ dataset['Pclass'] == '2', 'Pclass'] = \"Class2\"\n    dataset.loc[ dataset['Pclass'] == '3', 'Pclass'] = \"Class3\"\n    ","d3dac082":"train_df.info()","d48e5cef":"test_df.info()","29dea469":"train_df['Pclass'].value_counts()","cfeeaeb5":"# Capture all the numerical features so that we can scale them later\n#data = [train_df, test_df]\ntrain_numerical_features = list(train_df.select_dtypes(include=['int64', 'float64', 'int32']).columns)\ntrain_numerical_features","3827bdb3":"type(train_numerical_features)","aa92bdca":"del train_numerical_features[0]\ntrain_numerical_features","440fa94f":"# Feature scaling - Standard scaler\nss_scaler = StandardScaler()\ntrain_df_ss = pd.DataFrame(data = train_df)\ntrain_df_ss[train_numerical_features] = ss_scaler.fit_transform(train_df_ss[train_numerical_features])","8a687bf7":"train_df_ss.shape","d8cbf12d":"train_df_ss.head()","0c230206":"test_numerical_features = list(test_df.select_dtypes(include=['int64', 'float64', 'int32']).columns)\ntest_numerical_features","87743218":"del test_numerical_features[0]\ntest_numerical_features","25a564c2":"# Feature scaling - Standard scaler\ntest_ss_scaler = StandardScaler()\ntest_df_ss = pd.DataFrame(data = test_df)\ntest_df_ss[test_numerical_features] = test_ss_scaler.fit_transform(test_df_ss[test_numerical_features])","b8cef23f":"test_df.shape","ebf30c63":"test_df.head()","9d42461f":"# One-Hot encoding \/ Dummy variables\nencode_col_list = list(train_df.select_dtypes(include=['object']).columns)\nfor i in encode_col_list:\n    train_df_ss = pd.concat([train_df_ss,pd.get_dummies(train_df_ss[i], prefix=i)],axis=1)\n    train_df_ss.drop(i, axis = 1, inplace=True)","e0b7cc2f":"train_df_ss.shape","cb3491ce":"train_df_ss.head()","b5974413":"# One-Hot encoding \/ Dummy variables\ntest_encode_col_list = list(test_df.select_dtypes(include=['object']).columns)\nfor i in test_encode_col_list:\n    test_df_ss = pd.concat([test_df_ss,pd.get_dummies(test_df_ss[i], prefix=i)],axis=1)\n    test_df_ss.drop(i, axis = 1, inplace=True)","5b25224a":"test_df_ss.shape","3b8ff88e":"test_df_ss.head()","b969f6c4":"X_train = train_df_ss.drop(\"Survived\", axis=1)\nY_train = train_df_ss[\"Survived\"]\nX_test  = test_df_ss.drop(\"PassengerId\", axis=1).copy()","5a3d5386":"X_train.shape","bc73da81":"Y_train.shape","1832fbcd":"X_test.shape","61ea0ed5":"X_train.info()","e414f72d":"# Instantiate our model\nlogreg = LogisticRegression()\n\n# Fit our model to the training data\nlogreg.fit(X_train, Y_train)\n\n# Predict on the test data\nlogreg_predictions = logreg.predict(X_test)\n\nlog_submission = pd.DataFrame({\n    \"PassengerId\": test_df[\"PassengerId\"],\n    \"Survived\": logreg_predictions\n})\n\nlog_submission.to_csv('LogisticRegression_SS_OH_FE2.csv', index=False)","7eb3b365":"# Instantiate our model\nadaboost = AdaBoostClassifier()\n\n# Fit our model to the training data\nadaboost.fit(X_train, Y_train)\n\n# Predict on the test data\nadaboost_predictions = adaboost.predict(X_test)\n\nadaboost_submission = pd.DataFrame({\n    \"PassengerId\": test_df[\"PassengerId\"],\n    \"Survived\": adaboost_predictions\n})\n\nadaboost_submission.to_csv('AdaptiveBoosting_SS_OH_FE.csv', index=False)","7d962a17":"# Instantiate our model\nbag = BaggingClassifier()\n\n# Fit our model to the training data\nbag.fit(X_train, Y_train)\n\n# Predict on the test data\nbag_predictions = bag.predict(X_test)\n\nbag_submission = pd.DataFrame({\n    \"PassengerId\": test_df[\"PassengerId\"],\n    \"Survived\": bag_predictions\n})\n\nbag_submission.to_csv('Bagging.csv', index=False)","c7392e6b":"random_forest = RandomForestClassifier(n_estimators=100)\nrandom_forest.fit(X_train, Y_train)\n\nrandom_forest_predictions = random_forest.predict(X_test)\n\nrf_submission = pd.DataFrame({\n    \"PassengerId\": test_df[\"PassengerId\"],\n    \"Survived\": random_forest_predictions\n})\n\nrf_submission.to_csv('RandomForest_SS_OH.csv', index=False)","3fdb502d":"# Instantiate our model\ndt = DecisionTreeClassifier()\ndt.fit(X_train, Y_train)\n\ndt_predictions = dt.predict(X_test)\n\ndt_submission = pd.DataFrame({\n    \"PassengerId\": test_df[\"PassengerId\"],\n    \"Survived\": dt_predictions\n})\ndt_submission.to_csv('DecisionTrees.csv', index=False)","0c0b8b66":"# Instantiate our model\ngb = GradientBoostingClassifier()\ngb.fit(X_train, Y_train)\n\ngb_predictions = gb.predict(X_test)\n\ngb_submission = pd.DataFrame({\n    \"PassengerId\": test_df[\"PassengerId\"],\n    \"Survived\": gb_predictions\n})\ngb_submission.to_csv('GradientBoost_SS_OH_FE.csv', index=False)","1d172e06":"# Instantiate our model\nxg = XGBClassifier(learning_rate=0.02, n_estimators=750,\n                   max_depth= 3, min_child_weight= 1, \n                   colsample_bytree= 0.6, gamma= 0.0, \n                   reg_alpha= 0.001, subsample= 0.8\n                  )\nxg.fit(X_train, Y_train)\n\nxg_predictions = xg.predict(X_test)\n\nxg_submission = pd.DataFrame({\n    \"PassengerId\": test_df[\"PassengerId\"],\n    \"Survived\": xg_predictions\n})\nxg_submission.to_csv('XGBoost_SS_OH_FE.csv', index=False)","ac8acedc":"### Missing data ","c0f58fa3":"#### Pclass","a3cbf25d":"## Features:\n* `survival`: Survival \n* `PassengerId`: Unique Id of a passenger\n* `pclass`: Ticket class     \n* `sex`: Sex     \n* `Age`: Age in years     \n* `sibsp`: # of siblings \/ spouses aboard the Titanic     \n* `parch`: # of parents \/ children aboard the Titanic     \n* `ticket`: Ticket number     \n* `fare`: Passenger fare     \n* `cabin`: Cabin number     \n* `embarked`: Port of Embarkation","db19c26d":"* ##### Embarked seems to be correlated with survival, depending on the gender.\n\n* ##### Women on port Q and on port S have a higher chance of survival. The inverse is true, if they are at port C. Men have a high survival probability if they are on port C, but a low probability if they are on port Q or S.\n\n* ##### Pclass also seems to be correlated with survival. We will generate another plot of it below.","8a24d47e":"## Random Forest","8aea74f7":"#### Age:\n##### Fill null values with random numbers, which are computed based on the mean age value in regards to the standard deviation.","ea2a117e":"### Q3: Do the passengers have better chance at survival while travelling alone?","d784b078":"### Data Preprocessing","12ed778f":"### Converting Features","49b4f01c":"#### `SibSp` and `Parch`","46d8cdae":"#### Embarked:","951b3ee2":"#### Age: Convert from float to int and create a new feature \"AgeGroup\" using bins ","ea9555a5":"## XGBoost","f328bffa":"### Read the training and testing data","342d4f19":"### Import the necessary libraries","bf38c765":"#### Sex: Convert to numeric","74e9acad":"### Q1: How many people Embarked from different ports? Is there a correlation between port of embarkment and survival? ","499087c9":"# Titanic - Machine Learning from Disasters\n## Kaggle Competition","a6307126":"#### Fare per Person:","8e8bfcbb":"`Age` and `Embarked`","be875b90":"#### Fare:","a0728e96":"## ML Modelling","1a917096":"##### The plot above confirms our assumption about pclass 1, but we can also spot a high probability that a person in pclass 3 will not survive.","3cf0133c":"#### Missing Data","8f71c479":"## Bagging Classifier","5baa9a8b":"##### Here we can see that you had a high probabilty of survival with 1 to 3 realitves, but a lower one if you had less than 1 or more than 3 (except for some cases with 6 relatives).","6b9af0e5":"## Adaptive Boosting","8167fe57":"## Logistic Regression","314d404f":"##### Since the Ticket attribute has too many unique values, it will be a bit tricky to convert them into useful categories. So we will drop it from the dataset.","db1cce8b":"#### Cabin:\n##### Cabin number looks like \u2018C23\u2019 and the letter refers to the deck. We will extract these and create a new feature, to represent a persons deck. ","77ed38fb":"##### The `Embarked` feature has only 2 missing values, which can easily be filled. It will be much more tricky, to deal with the `Age` feature, which has 177 missing values. The `Cabin` feature needs further investigation, but it looks like that we might want to drop it from the dataset, since 77 % of it are missing.","9f9cc54d":"## One-hot encoding","748e7dd7":"##### Here we see clearly, that Pclass is contributing to a persons chance of survival, especially if this person is in class 1. We will create another pclass plot below.","c1d40796":"#### Suppress warnings from output","7e6cb00b":"### Exploratory Analysis","bfc251c3":"* ##### You can see that men have a high probability of survival when they are between 18 and 30 years old, which is also a little bit true for women but not fully. For women the survival chances are higher between 14 and 40.\n\n* ##### For men the probability of survival is very low between the age of 5 and 18, but that isn\u2019t true for women. Another thing to note is that infants also have a little bit higher probability of survival.\n\n* ##### Since there seem to be certain ages, which have increased odds of survival and because I want every feature to be roughly on the same scale, I will create age groups later on.","bb894689":"## Decision Trees","40a57307":"##### SibSp and Parch would make more sense as a combined feature, that shows the total number of relatives, a person has on the Titanic. I will create it below and also a feature that sows if someone is not alone.","a694ff1a":"#### Ticket:","93e58deb":"#### Name: Extract titles from name and build a new feature from that","ba4adb95":"#### Embarked: Convert to Numeric","e425327a":"### Create new features","923e57c0":"#### Fare: Convert from float to int","4aacc7f0":"#### RMS Titanic was a British passenger liner that sank in the North Atlantic Ocean in the early hours of 15 April 1912, after colliding with an iceberg during her maiden voyage from Southampton to New York City. There were an estimated 2,224 passengers and crew aboard, and more than 1,500 died, making it one of the deadliest commercial peacetime maritime disasters in modern history. RMS Titanic was the largest ship afloat at the time she entered service and was the second of three Olympic-class ocean liners operated by the White Star Line.\n\n### In this exercise, we will try to predict whether a passenger on the Titanic would have survived or not.","ed22c8d2":"## Scaling the numerical data","9d0f1e5e":"### Q2: Does survival depend upon gender?","478c3260":"#### Age times class","26066872":"#### From the table above, we can note a few things:\n* ##### We have a few categorical variabes that need to be either converted to numerical or one-hot encoded, so that the machine learning algorithms can process them. \n* ##### The features have widely different ranges, and we will need to convert into roughly the same scale. \n* ##### Some features contain missing values (NaN = not a number), that we need to deal with.","6ccacc93":"### Creating categories:","c749f606":"## Gradient Boost"}}