{"cell_type":{"b4fb555f":"code","3cc22da4":"code","343f3b87":"code","e8ceb994":"code","6eb21b91":"code","52a2cf53":"code","302b202c":"code","03cba73f":"code","fd38b2d0":"code","2b19295d":"code","2144d5ef":"code","ac0b0c8f":"code","c655a89c":"code","611fb20f":"code","0b7029b4":"code","c935a602":"code","607433fe":"code","9b6d211d":"code","7d0a93be":"code","aceebbd4":"code","4c53b8a6":"code","53c1da22":"code","3da36ab8":"code","8d80182f":"code","e40cdcf7":"code","8d99afd0":"code","4da73747":"code","5b339760":"code","eb6afd68":"code","6421bbca":"code","f50ef4bb":"code","9c692eb7":"code","ca5dbc2e":"code","de8c4822":"code","d57c54cb":"code","ab3714b6":"code","06f4daa7":"code","707b20ce":"code","bca6c99c":"code","59b9c507":"code","460f9224":"code","cef41fdd":"code","69adc6dd":"code","28c346e2":"code","16b09003":"code","152ff08b":"code","6dea34f6":"code","9bf0782e":"code","7cf7454a":"code","25dd2e87":"code","a3e767de":"code","d1458fa4":"code","c10652f1":"code","478f159d":"code","013cf561":"code","610c1157":"code","3515cf01":"code","9b9e08e2":"code","596ac040":"code","d22b0f0f":"code","7d4043cd":"code","e68b9b9a":"code","61f7ce0e":"code","648aa831":"code","97d575cc":"code","22836fc3":"code","29ddcc97":"code","70e2ba29":"code","5bec5780":"code","5bca17ad":"code","dae32e3a":"code","0ae2cd37":"code","1df85c19":"code","0852972a":"code","84424f5c":"code","bfdaa35c":"code","d0bc0930":"code","c9c54793":"code","016fc215":"code","f7b66f5b":"code","469ccc35":"code","980d12cf":"code","682215b2":"code","094364b3":"code","00b74775":"code","5ea27b98":"code","530bddd9":"code","d22f19cb":"code","6c91312f":"code","89d26e26":"code","799b12d1":"code","03e9e7d3":"code","15a9828f":"code","8bb1d6f4":"code","b6b6579f":"code","38cc9345":"code","43d9f541":"code","91ad2bc1":"code","5c28f203":"code","335e930a":"code","97c0bd75":"code","997528cf":"code","aab457b0":"code","ad8ffd92":"code","a2c43955":"code","6d6818d7":"code","b46036f6":"code","9f78913e":"code","ccb11edb":"code","70d37a45":"code","bf43562f":"code","06ba94c9":"code","1a6b5f10":"code","becadcba":"code","459cb9eb":"code","56baebc2":"code","14e3a6f1":"markdown","dff167a6":"markdown","a831ab1f":"markdown","eeca1f73":"markdown"},"source":{"b4fb555f":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\n","3cc22da4":"l_train=pd.read_csv('..\/input\/train_ctrUa4K.csv')\nl_train.head()","343f3b87":"l_train.isnull().sum()","e8ceb994":"l_train.dtypes","6eb21b91":"l_train.Dependents.unique()","52a2cf53":"sns.heatmap(l_train.isnull())\nplt.figure(figsize=(20,10))","302b202c":"l_train['Gender'].value_counts()","03cba73f":"l_train.Gender.unique()","fd38b2d0":"# l_train['Gender'].replace(np.nan,'Male',inplace=True)","2b19295d":"sns.barplot(hue='Gender',x='Self_Employed',y='CoapplicantIncome',data=l_train)","2144d5ef":"sns.barplot(hue='Gender',x='Education',y='CoapplicantIncome',data=l_train)","ac0b0c8f":"l_train['Gender'].replace(np.nan,'Male',inplace=True)","c655a89c":"l_train['Married'].value_counts()","611fb20f":"sns.barplot(x='Married',y='CoapplicantIncome',data=l_train)","0b7029b4":"l_train.loc[l_train['Married'].isnull()]","c935a602":"l_train.loc[104,'Married']='Yes'\nl_train['Married'].replace(np.nan,'No',inplace=True)","607433fe":"l_train.isnull().sum()","9b6d211d":"sns.barplot(x='Dependents',y='CoapplicantIncome',hue='Married',data=l_train)","7d0a93be":"l_train['Dependents'].value_counts()","aceebbd4":"l_train.loc[l_train['Dependents'].isnull()]","4c53b8a6":"l_train.loc[228,'Dependents']='3+'\nl_train.loc[293,'Dependents']='3+'\nl_train.loc[332,'Dependents']='3+'\nl_train.loc[355,'Dependents']='3+'\nl_train.loc[435,'Dependents']='3+'\n","53c1da22":"l_train['Dependents'].replace(np.nan,'0',inplace=True)","3da36ab8":"sns.heatmap(l_train.isnull())\nplt.figure(figsize=(20,10))","8d80182f":"l_train[l_train['Self_Employed'].isnull()]\nl_train['Self_Employed'].replace(np.nan,'DK',inplace=True)\n# df\n# df['Self_Employed']=['Yes' if i =='Graduate' else 'No' for i in df['Education']]\n# df.head()","e40cdcf7":"sns.barplot(x='Self_Employed',y='ApplicantIncome',hue= 'Education',data=l_train)","8d99afd0":"sns.barplot(hue='Self_Employed',x='Education',y='LoanAmount',data=l_train)","4da73747":"l_train.loc[(l_train.Self_Employed == \"DK\") & (l_train.Education == \"Not Graduate\")]\n\n# l_train.loc[(l_train.Self_Employed == \"DK\") & (l_train.Education == \"Not Graduate\")].replace('DK','No',inplace=True)","5b339760":"# l_train.loc[(l_train.Self_Employed == \"DK\") & (l_train.Education == \"Graduate\")]\n\n\n# l_train.loc[(l_train.Self_Employed == \"DK\") & (l_train.Education == \"Graduate\")].replace('DK','Yes',inplace=True)","eb6afd68":"# Self_Employed_=[]\n# for i in l_train.Self_Employed:\n#     for j in l_train.Education:\n#         if i == 'Dk' and j == 'Not Graduate':\n#             Self_Employed_.append(\"No\")\n#         elif i== 'DK' and j =='Graduate':\n#             Self_Employed_.append(\"Yes\")\n#         else:\n#             Self_Employed_.append(i)","6421bbca":"l_train.loc[107,'Self_Employed']='No'\nl_train.loc[170,'Self_Employed']='No'\nl_train.loc[463,'Self_Employed']='No'\nl_train.loc[468,'Self_Employed']='No'\nl_train.loc[535,'Self_Employed']='No'\nl_train.loc[601,'Self_Employed']='No'","f50ef4bb":"l_train['Self_Employed'].replace('DK','Yes',inplace=True)","9c692eb7":"l_train['Self_Employed'].value_counts()","ca5dbc2e":"sns.barplot(x='Self_Employed',y='ApplicantIncome',hue= 'Education',data=l_train)","de8c4822":"l_train['Self_Employed'].isnull().sum()","d57c54cb":"l_train.isnull().sum()","ab3714b6":"sns.heatmap(l_train.isnull())\nplt.figure(figsize=(20,10))","06f4daa7":"l_train['ApplicantIncome'].mean()","707b20ce":"l_train['LoanAmount'].replace(np.nan,l_train['LoanAmount'].median(),inplace=True)","bca6c99c":"l_train.isnull().sum()","59b9c507":"l_train['Loan_Amount_Term'].value_counts()","460f9224":"sns.barplot(hue='Self_Employed',y='Loan_Amount_Term',x='Married',data=l_train)","cef41fdd":"l_train['Loan_Amount_Term'].fillna(l_train['Loan_Amount_Term'].median(),inplace=True)","69adc6dd":"l_train.isnull().sum()","28c346e2":"# l_train['Credit_History']=l_train['Credit_History'].astype(str,inplace=True)","16b09003":"l_train.dtypes","152ff08b":"l_train['Credit_History'].isnull().sum()","6dea34f6":"sns.barplot(hue='Self_Employed',y='CoapplicantIncome',x='Credit_History',data=l_train)","9bf0782e":"l_train['Credit_History'].replace('nan',np.nan,inplace=True)","7cf7454a":"l_train.isnull().sum()","25dd2e87":"sns.heatmap(l_train.isnull())\nplt.figure(figsize=(100,100))","a3e767de":"l_train.loc[l_train['Credit_History'].isnull()]","d1458fa4":"l_train['Loan_Status'].replace('Y',1,inplace=True)\nl_train['Loan_Status'].replace('N',0,inplace=True)","c10652f1":"l_train['Credit_History'].fillna(l_train['Credit_History'].mode()[0],inplace=True)","478f159d":"sns.heatmap(l_train.isnull())\nplt.figure(figsize=(100,100))","013cf561":"l_train['Loan_Status']=l_train['Loan_Status'].astype(int,inplace=True)","610c1157":"l_train.dtypes","3515cf01":"# Gender=pd.get_dummies(l_train.Gender,prefix=\"Gender\").iloc[ : ,1:]\n# Married=pd.get_dummies(l_train.Married,prefix=\"married\").iloc[ : ,1:]\n# Dependents=pd.get_dummies(l_train.Dependents,prefix=\"Dependents\").iloc[ : ,1:]\n# Education=pd.get_dummies(l_train.Education,prefix=\"Education\").iloc[ : ,1:]\n# Self_Employed=pd.get_dummies(l_train.Self_Employed,prefix=\"Self_Employed\").iloc[ : ,1:]\n# Property_Area=pd.get_dummies(l_train.Property_Area,prefix=\"Property_Area\").iloc[ : ,1:]\n","9b9e08e2":"# l_train=pd.concat([l_train,Gender],axis=1)\n# l_train=pd.concat([l_train,Married],axis=1)\n# l_train=pd.concat([l_train,Dependents],axis=1)\n# l_train=pd.concat([l_train,Education],axis=1)\n# l_train=pd.concat([l_train,Self_Employed],axis=1)\n# l_train=pd.concat([l_train,Property_Area],axis=1)\n# l_train.head()","596ac040":"l_train=pd.get_dummies(l_train,columns=[\"Gender\",\"Married\",\"Dependents\",\"Education\",\"Self_Employed\",\"Property_Area\"],drop_first=True)\nl_train.head()","d22b0f0f":"l_train.corr()","7d4043cd":"pd.crosstab(l_train['Credit_History'],l_train['Loan_Status'],margins=True)","e68b9b9a":"x=l_train.drop(['Loan_Status','Loan_ID','ApplicantIncome','CoapplicantIncome','LoanAmount',\n               'Loan_Amount_Term','Dependents_1','Dependents_3+','Education_Not Graduate',\n               'Self_Employed_Yes','Property_Area_Urban'],axis=1)\ny=l_train['Loan_Status']","61f7ce0e":"from sklearn.model_selection import train_test_split\n\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, random_state = 21)","648aa831":"from sklearn.neighbors import KNeighborsClassifier\n\nclf = KNeighborsClassifier(n_neighbors= 7)","97d575cc":"clf.fit(x_train, y_train)","22836fc3":"y_pred = clf.predict(x_test)","29ddcc97":"from sklearn.metrics import accuracy_score, classification_report,confusion_matrix","70e2ba29":"print('Accuracy_score: ',accuracy_score(y_test, y_pred)*100)\nprint('\\n','Classification_report: ','\\n','\\n',classification_report(y_test, y_pred))","5bec5780":"cm = confusion_matrix(y_test, y_pred)\nprint(cm) ","5bca17ad":"l_test=pd.read_csv('..\/input\/test_lAUu6dG.csv')\nl_test.head()","dae32e3a":"l_test.isnull().sum()","0ae2cd37":"l_test.dtypes","1df85c19":"l_test['Gender'].unique()","0852972a":"l_test['Gender'].value_counts()","84424f5c":"sns.barplot(hue='Gender',x=\"Self_Employed\",y=\"ApplicantIncome\",data=l_test)","bfdaa35c":"l_test['Gender'].replace(np.nan,'Male',inplace=True)","d0bc0930":"l_test['Gender'].unique()","c9c54793":"l_test['Dependents'].unique()","016fc215":"sns.barplot(x='Dependents',y='ApplicantIncome',hue='Married',data=l_test)","f7b66f5b":"l_test.loc[l_test['Dependents'].isnull()]\n","469ccc35":"l_test.loc[46,'Dependents']='3+'\nl_test.loc[111,'Dependents']='3+'\nl_test.loc[202,'Dependents']='3+'\nl_test.loc[247,'Dependents']='3+'\nl_test.loc[251,'Dependents']='3+'","980d12cf":"l_test['Dependents'].replace(np.nan,'0',inplace=True)\n\nl_test.isnull().sum()","682215b2":"l_test['Self_Employed'].replace(np.nan,'dk',inplace=True)\nl_test.loc[l_test['Self_Employed']=='dk']","094364b3":"sns.barplot(x='Self_Employed',y='ApplicantIncome',hue='Education',data=l_test)","00b74775":"sns.barplot(x='Self_Employed',y='ApplicantIncome',hue='Married',data=l_test)","5ea27b98":"sns.barplot(x='Property_Area',y='ApplicantIncome',hue='Self_Employed',data=l_test)","530bddd9":"sns.barplot(x='Self_Employed',y='ApplicantIncome',hue='Gender',data=l_test)","d22f19cb":"l_test.loc[89,'Self_Employed']='No'\nl_test.loc[168,'Self_Employed']='No'\nl_test.loc[259,'Self_Employed']= 'No'\n\nl_test['Self_Employed'].replace('dk','Yes',inplace=True)","6c91312f":"l_test.isnull().sum()","89d26e26":"l_test['LoanAmount'].replace(np.nan,l_test['LoanAmount'].median(),inplace=True)","799b12d1":"l_test['Loan_Amount_Term'].replace(np.nan,l_test['Loan_Amount_Term'].median(),inplace=True)","03e9e7d3":"l_test.isnull().sum()","15a9828f":"l_test[l_test['Credit_History'].isnull()]","8bb1d6f4":"l_test['Credit_History'].value_counts()","b6b6579f":"l_test['Credit_History'].replace(np.nan,1.0,inplace=True)","38cc9345":"l_test.isnull().sum()","43d9f541":"l_test.head()","91ad2bc1":"l_test.dtypes","5c28f203":"l_test=pd.get_dummies(l_test,columns=[\"Gender\",\"Married\",\"Dependents\",\"Education\",\"Self_Employed\",\"Property_Area\"],drop_first=True)\nl_test.head()","335e930a":"df_test=pd.get_dummies(l_test,drop_first=True)\ndf_test=l_test.drop(['Loan_ID','ApplicantIncome','CoapplicantIncome','LoanAmount',\n               'Loan_Amount_Term','Dependents_1','Dependents_3+','Education_Not Graduate',\n               'Self_Employed_Yes','Property_Area_Urban'],axis=1)","97c0bd75":"df_test.head()","997528cf":"y_pred_test = clf.predict(df_test)","aab457b0":"from sklearn.metrics import accuracy_score, classification_report,confusion_matrix","ad8ffd92":"Y=pd.DataFrame(y_pred_test)","a2c43955":"Y.head(10)","6d6818d7":"sm=pd.read_csv(\"..\/input\/sample_submission_49d68Cx.csv\")","b46036f6":"sm.head()","9f78913e":"submit=pd.concat([sm.Loan_ID,Y],axis=1)","ccb11edb":"submit.head()","70d37a45":"submit.columns=[\"Loan_ID\",\"Loan_Status\"]","bf43562f":"submit.head()\n","06ba94c9":"submit['Loan_Status'].replace(0,'N',inplace=True)\n\nsubmit['Loan_Status'].replace(1,'Y',inplace=True)","1a6b5f10":"submit.head()","becadcba":"submit['Loan_Status'].value_counts()","459cb9eb":"submit.to_csv(\"Submission1.csv\",index=False)","56baebc2":"import pandas as pd\nsample_submission_49d68Cx = pd.read_csv(\"..\/input\/sample_submission_49d68Cx.csv\")\ntest_lAUu6dG = pd.read_csv(\"..\/input\/test_lAUu6dG.csv\")\ntrain_ctrUa4K = pd.read_csv(\"..\/input\/train_ctrUa4K.csv\")","14e3a6f1":"# ML Model","dff167a6":"# can't find any relation so replace with median","a831ab1f":"# Test data","eeca1f73":"# Dummies"}}