{"cell_type":{"01b77064":"code","b3c859f9":"code","3d9619e6":"code","3550ae28":"code","8c976c4a":"code","55b4f3d3":"code","74fb5ec4":"code","2bc3b30d":"code","25bd15ee":"code","7c5eb1cf":"code","c958b196":"code","2183b4c8":"code","1be19083":"code","cc20122f":"code","afcfc26d":"code","8ba34330":"code","965e1dc1":"code","8a2e4979":"code","b65a2d4f":"code","47c4f394":"code","30c6571e":"code","f50738d9":"code","b4d5a140":"code","14166ab6":"markdown","02155441":"markdown","13ce684c":"markdown","59d2a651":"markdown","3379605e":"markdown","cd175f2d":"markdown","1a04a2c7":"markdown","efdd680a":"markdown","80354a2b":"markdown","cd65de9f":"markdown","a76f9549":"markdown","19910a2a":"markdown","7cca8f6c":"markdown","2d68afda":"markdown","c354e7e0":"markdown","8cc49cdc":"markdown","32bfb666":"markdown","85e7a3bb":"markdown","add01d1d":"markdown","f9b8c2d5":"markdown","426f3fda":"markdown","8af31134":"markdown","8243c5c5":"markdown","f010e3de":"markdown"},"source":{"01b77064":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","b3c859f9":"customers = pd.read_csv('..\/input\/ecommerce-customers\/Ecommerce Customers.csv')","3d9619e6":"customers.head()","3550ae28":"customers.info()","8c976c4a":"customers.describe()","55b4f3d3":"sns.pairplot(customers)","74fb5ec4":"sns.lmplot(x = 'Length of Membership', y = 'Yearly Amount Spent', data = customers)","2bc3b30d":"sns.jointplot(x = 'Time on Website', y = 'Yearly Amount Spent', data=customers )","25bd15ee":"sns.jointplot(x = 'Time on Website', y = 'Yearly Amount Spent', kind='hex', data=customers )","7c5eb1cf":"sns.lmplot(x = 'Time on App', y = 'Yearly Amount Spent', data=customers)","c958b196":"from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression","2183b4c8":"x = customers[['Avg. Session Length', 'Time on App','Time on Website', 'Length of Membership']]\ny = customers['Yearly Amount Spent']","1be19083":"x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3, random_state=101)","cc20122f":"lm = LinearRegression()\nlm.fit(x_train, y_train)","afcfc26d":"lm.coef_","8ba34330":"lm.intercept_","965e1dc1":"prediction = lm.predict(x_test)","8a2e4979":"plt.scatter(y_test, prediction)\nplt.xlabel('Y Testing')\nplt.ylabel('Predicted Y')","b65a2d4f":"sns.distplot((y_test-prediction))","47c4f394":"coeff_df = pd.DataFrame(lm.coef_,x.columns,columns=['Coefficient'])\ncoeff_df","30c6571e":"print('intercept:',lm.intercept_)","f50738d9":"from sklearn import metrics","b4d5a140":"sse = np.sum((prediction - y_test)**2)\nsst = np.sum((y_test - y_test.mean())**2)\nR_square = 1 - (sse\/sst)\n\nprint('The Mean Square Error(MSE) is: ', metrics.mean_squared_error(y_test, prediction))\nprint('R square obtain for normal equation method is :',R_square)","14166ab6":"For our prdiction, we got an R2 of 0.99, which means that our Linear Regression model has been implemented successfully. ","02155441":"## Evaluating the Model: Mathematical Expression\n\n**We will discuss the math behind the linear expression.**","13ce684c":"**Create an Linear Regression model called lm**","59d2a651":"**Print out the model's coefficients and intercept**","3379605e":"Here is the step that I am following:\n\n* Retrieve the Data\n* Exploratory Data Analysis\n* Machine Learning \n    * Traning the Model\n    * Predict the Outcome \n    * Evaluating the Model: Mathematical Expression\n    * Evaluating the Model: Final Evaluation    ","cd175f2d":"**We will create a scatterplot to plot our prediction and y testing set in the graph**","1a04a2c7":"Mean Square Error(MSE) and R2 can evluate the outcome of prediction. MSE can be express as: $\\mathbf{ J(\\theta) = \\frac{1}{m} \\sum_{i=1}^{m}(\\hat{y}_i - y_i)^2}\n$","efdd680a":"In this project, I will demonstrate my understanding of Linear Regression model and apply my knowledge to make predictions. I will use the Ecommerce Customers dataset. First, I will do a exploratory data analysis and then I will apply the machine learning algoritm.  ","80354a2b":"We have our coefficient and intercept. We can start writing our Linear equation roughly as:","cd65de9f":"For multivariate Liner Regression model, we can express the linear equation as following: ","a76f9549":"**The scatterplot is fitted closely and the histogram is normally distributed mean that our model is implemented successfully.**","19910a2a":"$$\\mathbf{h_\\theta(x_{i}) = -1048 + 26 x_{1} + 39 x_{2} + \\frac{19}{100} x_{3} + 61 x_{4} }$$","7cca8f6c":"## Retrieve the Data","2d68afda":"R2 is statistical measure of how close data are to the fitted regression line. R2 is always between 0 to 1. 0 indicated that model explains none of the variability of the response data around it's mean. 1 indicated that model explains all the variablity of the response data around the mean. R2 can be express as: $\\mathbf{R^2 = 1 - \\frac{SSE}{SST}}\n$","c354e7e0":"$$\\mathbf{h_\\theta(x_{i}) = \\theta_0 + \\theta_1x_{i1} + \\theta_2 x_{i2} + ..... \\theta_j x_{ij} ...... \\theta_n  x_{mn} }$$","8cc49cdc":"How did we got our linear equation? We use Normal Equation as our algorithm to slove the cost funtion($\\mathbf{J(\\theta) =  \\frac{1}{m} \\sum_{i=1}^{m}(h_\\theta(x_i) - y_i)^2}\n$).\n","32bfb666":"## Evaluating the Model: Final Evaluation\n\n**Finally, We are going to evaluate our data with Mean Squared Error and R2.**","85e7a3bb":"To do that we have to make the partial derivative equal to 0. $\\mathbf{\\frac{\\partial J(\\theta_j)}{\\partial\\theta_j} =0}$\n\nWhich we can get our normal Equation of Linear Regression:\n\n$$\\mathbf{ \\theta = (X^TX)^{-1} X^Ty }\n$$","add01d1d":"## Machine Learning \n\n### Traning the Model\n\nAfter exploring our data, we are going to divide our datasets into training and testing sets, and model our data with training sets.","f9b8c2d5":"# Linear Regression Project","426f3fda":"we know the $\\theta_0$ represent model's intercept, and $\\theta_1, \\theta_2, ...... \\theta_n$ represent the coefficient of the model\n","8af31134":"**From the graph, we can quickly identify that the Length of Membership that has the strongest linear Relationship with the Yearly Amount Spent**\n\nHowever, We need more details of analysis.","8243c5c5":"## Exploratory Data Analysis\n\nAfter retrieving the data, now we have to discover linear relationships that associates with the Yearly Amount Spent","f010e3de":"## Predict the Outcome"}}