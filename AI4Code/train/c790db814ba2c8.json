{"cell_type":{"eeffdafb":"code","03122cdb":"code","8c85aade":"code","5e3b7ba2":"code","0486a057":"code","06142a30":"code","3306e39d":"code","c96e7a60":"code","1a189dec":"code","3101e192":"code","f2e62eaf":"code","1d4b88f8":"code","1e85eaad":"code","4cdb9a9c":"markdown","9a92afad":"markdown","5d444e0a":"markdown","d39a2b9c":"markdown","b5e41d73":"markdown"},"source":{"eeffdafb":"import os\nimport pandas as pd\nimport numpy as numpy\nimport matplotlib.pyplot as plt\nimport seaborn as sns","03122cdb":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\nda = pd.read_csv(\"..\/input\/data-analyst-jobs\/DataAnalyst.csv\")\nba = pd.read_csv(\"..\/input\/business-analyst-jobs\/BusinessAnalyst.csv\")\nds = pd.read_csv(\"..\/input\/data-scientist-jobs\/DataScientist.csv\")","8c85aade":"da[\"Job Type\"] = \"Data Analyst\"\nba[\"Job Type\"] = \"Business Analyst\"\nds[\"Job Type\"] = \"Data Scientist\"\n\n#Data Cleaning\nba.drop([\"index\"],axis=1,inplace=True)\nds.drop([\"index\"],axis=1,inplace=True)\n\n#Combine the datasets\ndf = pd.concat([da,ba,ds])\n\ndrop_columns = ['Unnamed: 0','Headquarters', 'Size', 'Founded', 'Revenue', 'Competitors', 'Easy Apply']\ndf.dropna()\ndf.drop(drop_columns, axis=1, inplace=True)","5e3b7ba2":"# Since all the salary data are estimated by glass doors and they are all in the same range\n# We can use average salary as indicator.\n# We have to use regular expression here:\nimport re\ndef get_avg_salary(salary):\n    salary_list = re.findall(r\"\\$(.+?)K\",salary)\n    salary_list = [int(i) for i in salary_list]\n    return sum(salary_list)\/2\n\ndf[\"Avg Salary\"] = df[\"Salary Estimate\"].apply(lambda x : get_avg_salary(x))\ndf.drop(df[df[\"Avg Salary\"]==0].index,axis=0,inplace=True)","0486a057":"import plotly.express as px\nfig = px.histogram(df, x=df[\"Avg Salary\"], color=df[\"Job Type\"])\nfig.show()\n#As we can see, data scientists are more likely to gain higher salary.","06142a30":"# How do we define a good job?\n# Good Job Indicator = Salary * 0.8 + Rating * 0.2\nfrom sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\ndf[[\"Rating Scaled\",\"Avg Salary Scaled\"]] = pd.DataFrame(scaler.fit_transform(df[[\"Rating\",\"Avg Salary\"]]))\n\ndf[\"Good Job Indicator\"] = df[\"Rating Scaled\"]*20 + df[\"Avg Salary Scaled\"]*80\ndf.sort_values(by=\"Good Job Indicator\", ascending=False, inplace=True)\ndf.head() # Best 5 jobs. This result make sense to me.\n# For jobs with lowest salary section, their indicator is 0, which does not make sense.\ndf.drop(df[df[\"Good Job Indicator\"].isnull()].index, axis=0, inplace=True)","3306e39d":"import plotly.express as px\nfig = px.histogram(df, x=\"Good Job Indicator\", color=\"Job Type\")\nfig.update_layout(\n    title=\"Job Score Distribution\",\n    xaxis_title=\"Job Score\",\n    yaxis_title=\"Num of Jobs\",\n)\nfig.show()","c96e7a60":"# Lets define jobs scoring more than 60 as great jobs \n# and check their company names, location, job description and industry.\ngood_job_df = df[df[\"Good Job Indicator\"]>=40]\n# print(good_job_df.shape) #1689 out of 9571 jobs.","1a189dec":"city_rank = good_job_df.groupby(by=\"Location\").count().reset_index()\\\n            .sort_values(\"Job Title\", ascending=False)[0:20][[\"Location\", \"Job Title\"]]\ncity_rank.rename(columns={\"Job Title\":\"Num of Jobs\"},inplace=True)\nfig = px.bar(city_rank, x='Location', y='Num of Jobs',color='Num of Jobs')\nfig.show()","3101e192":"city_rank = good_job_df.groupby(by=[\"Location\",\"Job Type\"]).count().reset_index()\\\n            .sort_values(\"Job Title\", ascending=False)[0:20][[\"Location\", \"Job Title\",\"Job Type\"]]\ncity_rank.rename(columns={\"Job Title\":\"Num of Jobs\"},inplace=True)\nfig = px.bar(city_rank, x=\"Location\", y=\"Num of Jobs\", color=\"Job Type\", title=\"Best Jobs Distribution among Cities\")\nfig.show()","f2e62eaf":"industry_rank = good_job_df.groupby(by=[\"Industry\",\"Job Type\"]).count()\\\n                .reset_index().sort_values(\"Job Title\", ascending=False)[0:20][[\"Industry\", \"Job Title\", \"Job Type\"]]\nindustry_rank.rename(columns={\"Job Title\":\"Num of Jobs\"},inplace=True)\n# fig = px.pie(industry_rank, values='Num of Jobs', names='Industry', title='Good Jobs Industry Distribution',width=900, height=600)\n# fig.show()\nindustry_rank.drop(industry_rank[industry_rank[\"Industry\"]==\"-1\"].index, axis=0, inplace=True)","1d4b88f8":"\nindustry_rank[industry_rank[\"Job Type\"]==\"Business Analyst\"]\nindustry_rank[industry_rank[\"Job Type\"]==\"Business Analyst\"]\nindustry_rank[industry_rank[\"Job Type\"]==\"Business Analyst\"]\n\n\nfig1 = px.pie(industry_rank, values='Num of Jobs', names='Industry', \\\n              title='Good Jobs Industry Distribution',\n              color_discrete_sequence=px.colors.sequential.RdBu,\n              width=900, height=600)\nfig1.show()","1e85eaad":"job_types = industry_rank[\"Job Type\"].unique().tolist()\nindustry_rank_chart = list()\nfig = list()\nfor i in range(0,3):\n    industry_rank_chart.append(industry_rank[industry_rank[\"Job Type\"]==job_types[i]])\nfor i in range(0,3):\n    fig.append(px.pie(industry_rank_chart[i], values='Num of Jobs', names='Industry', \\\n                  title=job_types[i]+' Industry Distribution',\n                  width=600, height=500))\ncolors = ['gold', 'mediumturquoise', 'darkorange', 'lightgreen']\nfor i in range(0,3):\n    fig[i].update_traces(textposition='inside', textinfo='label+percent',\\\n                         marker=dict(colors=colors, line=dict(color='#000232', width=2)))\n    fig[i].show()","4cdb9a9c":"### Data Cleaning","9a92afad":"### Visualization","5d444e0a":"### More Viz","d39a2b9c":"### Define a Good Job","b5e41d73":"### Clean the Salary Column"}}