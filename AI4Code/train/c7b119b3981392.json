{"cell_type":{"d5daafa0":"code","e877b7a8":"code","4ecebda1":"code","94605882":"code","d42ab2e7":"code","4aa5c065":"code","fdf00a90":"code","79733240":"code","87b11f3b":"code","34baedb3":"code","8824de05":"code","9e65b56e":"code","d48a5b09":"code","abbb5333":"code","8a5ef06e":"code","b2d06ba3":"code","f84e4143":"code","9a918511":"code","8b7f9064":"code","edb193b2":"code","a870f30b":"code","334b55fe":"code","ceb95940":"code","1b813124":"code","0a2991e1":"code","0aa7d319":"code","19bdf9ca":"code","b39b3643":"code","7dce4065":"code","8f1125ab":"code","f25b57ee":"code","3f8a11bc":"code","680ccd8d":"code","7b28548d":"code","86dd0f03":"code","6b96d5a5":"code","970a3b68":"code","853f0185":"code","5146774e":"code","dc75d22e":"code","d3b2d1d3":"code","affbe2cd":"code","c367d0d5":"code","72aa6e7e":"code","ba4c2247":"code","3aa1bf45":"code","ffd13555":"code","232c1ce1":"code","5d543958":"code","99e8fdb0":"code","0bd69b47":"code","db268842":"code","a1ac35dc":"code","15b7c3bc":"code","37a21216":"code","2019418a":"code","6df404a0":"code","8bb858cb":"code","5b1decef":"code","58fd256e":"code","d437e53a":"code","2934db48":"code","f576ff2f":"code","99c77216":"code","630fa39c":"code","36cbdc21":"code","240b6f71":"code","df6afc88":"code","be5f34ea":"code","f642a5d4":"code","c702467c":"code","d947975f":"code","0cec0d56":"code","025cb730":"code","d817371b":"code","bbee1689":"code","f244fb0a":"code","b3581b7e":"code","3cee17b2":"code","d9cea9dc":"code","7a3c7b4d":"code","415bd167":"code","fb75ac49":"code","84e80d72":"code","0f385435":"code","5158cb8a":"code","c0ded252":"code","3c0bc0dc":"code","058bcc9e":"code","af8e7f9d":"code","18e7e72f":"code","9dff3af6":"code","574d8cf8":"code","c5e32441":"code","4c5ecb14":"code","0e67a535":"markdown","99f9f10e":"markdown","0a2aac5b":"markdown","b4a1e61b":"markdown"},"source":{"d5daafa0":"pip install --user imblearn","e877b7a8":"import pandas as pd\nimport numpy as np","4ecebda1":"data=pd.read_csv(\"..\/input\/titanic\/train.csv\")","94605882":"data.head()","d42ab2e7":"data.shape","4aa5c065":"test_data=pd.read_csv(\"..\/input\/titanic\/test.csv\")","fdf00a90":"test_data.head()","79733240":"test_data.shape","87b11f3b":"data.isnull().sum()","34baedb3":"# Delete the \"Cabin\" column from the dataframe\ndata = data.drop(\"Name\", axis=1)\ndata.head()","8824de05":"#print(data.Survived.unique())\n#print(data.Pclass.unique())\n#print(data.Sex.unique())\n#print(data.Age.unique())\n\n#print(data.SibSp.unique())\n#print(data.Parch.unique())\n#print(data.Fare.unique())\nprint(data.Embarked.unique())","9e65b56e":"data[data[\"Embarked\"]==\"Q\"]","d48a5b09":"data.shape[0]","abbb5333":"data.isnull().sum()","8a5ef06e":"data.head()","b2d06ba3":"data[data[\"Sex\"]==\"female\"].mean()","f84e4143":"male_age_mean= 30.72\nfemale_age_mean= 27.91","9a918511":"index=data[data['Embarked'].isnull()].index.tolist()","8b7f9064":"index","edb193b2":"data=data.drop(index,axis=0)","a870f30b":"print(data[data[\"Sex\"]==\"male\"].boxplot(column=\"Age\"))","334b55fe":"data.corr(method=\"pearson\")","ceb95940":"data_temp=data.dropna()","1b813124":"from sklearn import linear_model","0a2991e1":"Lmodel=linear_model.LinearRegression()","0aa7d319":"Lmodel.fit(data_temp[[\"Pclass\",\"SibSp\",\"Parch\",\"Fare\"]],data_temp.Age)","19bdf9ca":"Lmodel.coef_","b39b3643":"Lmodel.intercept_","7dce4065":"Lmodel.predict([[3,0,0,8.4583]])","8f1125ab":"data_na=data[data['Age'].isnull()]","f25b57ee":"data_na=data_na.drop([\"Age\",\"Sex\",\"PassengerId\",\"Survived\",\"Cabin\",\"Embarked\",\"Ticket\"],axis=1)","3f8a11bc":"data_na.head()","680ccd8d":"data_na[\"Age\"]=Lmodel.predict(data_na)","7b28548d":"data_na.head()","86dd0f03":"data_na['Age'] = data_na['Age'].apply(np.ceil)","6b96d5a5":"data_na","970a3b68":"Age_na_index=data_na.index","853f0185":"data.loc[data_na.index,:].Age","5146774e":"#for i in Age_na_index:\ndata.loc[data_na.index,\"Age\"] = data_na.Age\n#data.loc[data_na.index,:].Age\ndata_na.Age","dc75d22e":"data.head()","d3b2d1d3":"data.isnull().sum()","affbe2cd":"data.shape[0]","c367d0d5":"index_m=data[(data[\"Age\"]<0) & (data[\"Sex\"]==\"male\")].index","72aa6e7e":"index_f=data[(data[\"Age\"]<0) & (data[\"Sex\"]==\"female\")].index","ba4c2247":"data.loc[index_m,\"Age\"]=29.0","3aa1bf45":"data.loc[index_f,\"Age\"]=22.0","ffd13555":"data[data[\"Fare\"]==66.6] ","232c1ce1":"data.isnull().sum()","5d543958":"data.Cabin.unique()","99e8fdb0":"data=data.drop([\"Cabin\"],axis=1)","0bd69b47":"data.head()","db268842":"from sklearn.preprocessing import LabelEncoder\nfrom sklearn.preprocessing import OneHotEncoder","a1ac35dc":"label_encoder = LabelEncoder()\nlabel_encoder1 = LabelEncoder()\ndata[\"Sex\"] = label_encoder.fit_transform(data[\"Sex\"])\ndata[\"Embarked\"] = label_encoder1.fit_transform(data[\"Embarked\"])","15b7c3bc":"data.tail()","37a21216":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import RandomForestClassifier\nimport numpy as np","2019418a":"data.corr(method=\"pearson\")","6df404a0":"y=data[\"Survived\"]","8bb858cb":"X=data[[\"Pclass\",\"Sex\",\"Age\",\"SibSp\",\"Parch\",\"Fare\",\"Embarked\"]]","5b1decef":"from sklearn.model_selection import train_test_split\nfrom imblearn.over_sampling import SMOTE","58fd256e":"X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2)","d437e53a":"sm = SMOTE(random_state = 2)\nX_train_res, y_train_res = sm.fit_sample(X_train, y_train.ravel())","2934db48":"y_train.shape","f576ff2f":"lr=LogisticRegression()\nsvm=SVC()\nrf=RandomForestClassifier(n_estimators=100)","99c77216":"lr.fit(X_train_res,y_train_res)","630fa39c":"svm.fit(X_train_res,y_train_res)","36cbdc21":"rf.fit(X_train_res,y_train_res)","240b6f71":"print(\"Liner Regression score\",lr.score(X_test,y_test))\nprint(\"SVM score\",svm.score(X_test,y_test))\nprint(\"Random Forest\",rf.score(X_test,y_test))","df6afc88":"lr.predict(X_test)","be5f34ea":"svm.predict(X_test)","f642a5d4":"rf.predict(X_test)","c702467c":"from sklearn.model_selection import cross_val_score","d947975f":"avg_LR=cross_val_score(LogisticRegression(),X,y)\navg_LR.mean()","0cec0d56":"avg_SVC=cross_val_score(SVC(),X,y)\navg_SVC.mean()","025cb730":"avg_RFC=cross_val_score(RandomForestClassifier(n_estimators=100),X,y)\navg_RFC.mean()","d817371b":"data.corr(method=\"pearson\")","bbee1689":"##Since there is minimum dependency on SibSp.Droping it from the dataset","f244fb0a":"#X=data[[\"Pclass\",\"Sex\",\"Age\",\"Parch\",\"Fare\",\"Embarked\"]]\nX=data[[\"Pclass\",\"Sex\",\"Parch\",\"Fare\",\"Embarked\"]]","b3581b7e":"y=data[\"Survived\"]","3cee17b2":"avg_LR=cross_val_score(LogisticRegression(),X,y)\navg_LR.mean()","d9cea9dc":"avg_SVC=cross_val_score(SVC(),X,y)\navg_SVC.mean()","7a3c7b4d":"avg_RFC=cross_val_score(RandomForestClassifier(n_estimators=50),X,y)\navg_RFC.mean()","415bd167":"rf=RandomForestClassifier(n_estimators=50)","fb75ac49":"rf.fit(X,y)","84e80d72":"data.Embarked.unique()","0f385435":"test=pd.read_csv(\"..\/input\/titanic\/test.csv\")","5158cb8a":"test.head()","c0ded252":"label_encoder2 = LabelEncoder()\nlabel_encoder3 = LabelEncoder()\ntest[\"Sex\"] = label_encoder2.fit_transform(test[\"Sex\"])\ntest[\"Embarked\"] = label_encoder3.fit_transform(test[\"Embarked\"])","3c0bc0dc":"test.head()","058bcc9e":"test.isnull().sum()","af8e7f9d":"test[test[\"Fare\"].isnull()==True]","18e7e72f":"test.loc[152,\"Fare\"]=8","9dff3af6":"#X_test=test[[\"Pclass\",\"Sex\",\"Age\",\"Parch\",\"Fare\",\"Embarked\"]]\nX_test=test[[\"Pclass\",\"Sex\",\"Parch\",\"Fare\",\"Embarked\"]]","574d8cf8":"Survived_temp=rf.predict(X_test)\nSurvived_temp","c5e32441":"test[\"Survived\"]=Survived_temp","4c5ecb14":"test[[\"PassengerId\",\"Survived\"]].to_csv(\"prediction.csv\",index=False,header=True)","0e67a535":"## Changing number of factors to increase accuracy","99f9f10e":"## Now we will apply the models on the data","0a2aac5b":"## Importing test data for predicting","b4a1e61b":"### Performing encoding for the categorical variables"}}