{"cell_type":{"413e29ef":"code","ed87263a":"code","34b540eb":"code","8980c133":"code","63645417":"code","4475f7d1":"code","498ca531":"code","02a7c264":"markdown","40f50c4f":"markdown","7c59df03":"markdown","64c828b8":"markdown","77828547":"markdown"},"source":{"413e29ef":"import pandas as pd\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error","ed87263a":"df_train = pd.read_csv(\"..\/input\/tabulardata-kfolds-created\/train_folds.csv\")\ndf_test = pd.read_csv(\"..\/input\/tabular-playground-series-aug-2021\/test.csv\")\nsample_submission = pd.read_csv(\"..\/input\/tabular-playground-series-aug-2021\/sample_submission.csv\")","34b540eb":"sample_submission.head()","8980c133":"useful_features = [c for c in df_train.columns if c not in ('id','loss','kfold')]\ndf_train[useful_features]","63645417":"from lightgbm import LGBMRegressor\nimport numpy as np\nfinal_preds=[]\nfor fold in range (5):\n    xtrain = df_train[df_train.kfold != fold]\n    xvalid = df_train[df_train.kfold == fold]\n    ytrain = xtrain['loss']\n    xtrain = xtrain[useful_features]\n    yvalid = xvalid['loss']\n    xvalid = xvalid[useful_features]\n    model = LGBMRegressor()\n    model.fit(xtrain,ytrain)\n    preds_valid = model.predict(xvalid)\n    test = df_test[useful_features]\n    test_preds = model.predict(test)\n    final_preds.append(test_preds)\n    print(mean_squared_error(yvalid,preds_valid,squared=False))","4475f7d1":"preds = np.mean(np.column_stack(final_preds),axis=1)","498ca531":"\nsample_submission['loss'] = preds\nsample_submission.to_csv('output.csv',index=False)\n","02a7c264":"import all the data required here I already created folds out of data in my previous notebook so just importing that data into df_train\n\nhttps:\/\/www.kaggle.com\/pavansaikondalarao\/creating-kfolds-tabular-playground-aug-2021","40f50c4f":"performing LGBM on all the 5 datasets we created using kfolds and storing the predicted values in a list called **final_preds**","7c59df03":"traning the model using LGBM along with cross validation","64c828b8":"we need to exclude certain columns before feeding our data into the model.","77828547":"we got the predictions from and we now average them to get our final predicted values for test set "}}