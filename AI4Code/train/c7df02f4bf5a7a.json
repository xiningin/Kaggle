{"cell_type":{"3dccec7f":"code","5ec430a5":"code","6184e34f":"code","f5d6107a":"code","53d8bc87":"markdown","492fdba6":"markdown","dc3e72ae":"markdown","d9d57efa":"markdown"},"source":{"3dccec7f":"import numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport math","5ec430a5":"dataset = pd.read_csv('..\/input\/ads-ctr-optimisation\/Ads_CTR_Optimisation.csv')","6184e34f":"N = 10000\nd = 10\nads_selected = []\nnumbers_of_selections = [0] * d\nsums_of_rewards = [0] * d\ntotal_reward = 0\nfor n in range(0, N):\n    ad = 0\n    max_upper_bound = 0\n    for i in range(0, d):\n        if (numbers_of_selections[i] > 0):\n            average_reward = sums_of_rewards[i] \/ numbers_of_selections[i]\n            delta_i = math.sqrt(3\/2 * math.log(n + 1) \/ numbers_of_selections[i])\n            upper_bound = average_reward + delta_i\n        else:\n            upper_bound = 1e400\n        if upper_bound > max_upper_bound:\n            max_upper_bound = upper_bound\n            ad = i\n    ads_selected.append(ad)\n    numbers_of_selections[ad] = numbers_of_selections[ad] + 1\n    reward = dataset.values[n, ad]\n    sums_of_rewards[ad] = sums_of_rewards[ad] + reward\n    total_reward = total_reward + reward","f5d6107a":"plt.hist(ads_selected)\nplt.title('Histogram of ads selections')\nplt.xlabel('Ads')\nplt.ylabel('Number of times each ad was selected')\nplt.show()","53d8bc87":"# **Implementing UCB**","492fdba6":"# **Importing the libraries**","dc3e72ae":"Reports:\nHistogram of ads selections","d9d57efa":"# **Visualising the results**"}}