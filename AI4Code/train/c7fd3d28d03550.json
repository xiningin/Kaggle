{"cell_type":{"355ab361":"code","2381ce61":"code","2da35a87":"code","c7868714":"code","9d4e2d67":"code","7d52e64e":"code","7228f6dd":"code","79220512":"code","b722499b":"code","d1809a3e":"code","d4947410":"code","7859b97c":"code","775ac867":"code","63c632ae":"code","16a1f852":"code","9984bfad":"markdown","649a4ceb":"markdown","23df8f81":"markdown"},"source":{"355ab361":"# Importing the libraries\nimport numpy as np\nimport pandas as pd\nimport itertools\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.linear_model import PassiveAggressiveClassifier\nfrom sklearn.metrics import accuracy_score, confusion_matrix","2381ce61":"#Importing the datasets\ndf = pd.read_csv('\/kaggle\/input\/news.csv')\n#Get shape and head\nprint(df.shape)\ndf.head()","2da35a87":"# Cheching for missing vaslues\ndf.isnull().sum()","c7868714":"df = df.drop(columns = ['Unnamed: 0'])\ndf","9d4e2d67":"df['label'] = df['label'].astype('category')\ndf['label'] = df['label'].cat.codes\ndf","7d52e64e":"df['title_length'] = df['title'].apply(len)\ndf","7228f6dd":"df['text_length'] = df['text'].apply(len)\ndf","79220512":"#DataFlair - Get the labels\nlabel=df.label\nlabel.head()","b722499b":"df.describe().astype(int)","d1809a3e":"df.hist(column='title_length', by='label')\n# x axis is the title length\n# y axis is the number of news","d4947410":"df.hist(column='text_length', by='label')\n# x axis is the text length\n# y axis is the number of news","7859b97c":"# DataFlair - Splitting the dataset\nx_train, x_test, y_train, y_test = train_test_split(df['text'], label, test_size=0.2, random_state=7)","775ac867":"#DataFlair - Initialize a TfidfVectorizer\ntfidf_vectorizer=TfidfVectorizer(stop_words='english', max_df=0.7)\n\n#DataFlair - Fit and transform train set, transform test set\ntfidf_train=tfidf_vectorizer.fit_transform(x_train) \ntfidf_test=tfidf_vectorizer.transform(x_test)","63c632ae":"#DataFlair - Initialize a PassiveAggressiveClassifier\npac=PassiveAggressiveClassifier(max_iter=50)\npac.fit(tfidf_train,y_train)\n\n#DataFlair - Predict on the test set and calculate accuracy\ny_pred=pac.predict(tfidf_test)\nscore=accuracy_score(y_test,y_pred)\nprint(f'Accuracy: {round(score*100,2)}%')","16a1f852":"#DataFlair - Build confusion matrix\nconfusion_matrix(y_test,y_pred, labels=[0,1])","9984bfad":"#### Importing the libraries","649a4ceb":"#### Data Preprocessing and visualization","23df8f81":"### Splitting the dataset and applying the TfidfVectorizer, and the PassiveAgressiveClassifier"}}