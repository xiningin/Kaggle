{"cell_type":{"8109258d":"code","bd67dcfa":"code","07247b00":"code","60fba62b":"code","63a543b1":"code","5bbab8f3":"code","89cc8801":"code","5286277f":"code","d9349c41":"code","1d64bb03":"code","8d9cf5d4":"code","16fe1af3":"code","4debe957":"code","0f54ed17":"code","6a2d8af4":"code","2ffca954":"code","5576758d":"code","36d25971":"code","39f3130e":"code","bceceeac":"code","c4195d1b":"code","f66728c0":"code","a8b47d1b":"code","2f751783":"code","414d72a6":"code","1a0fe9f7":"code","fd15070f":"code","f14dcd9d":"code","44e6f5a4":"code","5ebddc49":"code","8bb0448c":"code","2e41e21d":"code","17d7deee":"code","d27916ef":"markdown","5079adf3":"markdown","73ab8997":"markdown","7320ec8d":"markdown","8e4184b1":"markdown","a1ce0c88":"markdown","4ec93419":"markdown","4c6024f0":"markdown","ea5256d4":"markdown"},"source":{"8109258d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","bd67dcfa":"#Import the libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","07247b00":"#Import the datasets\nheart=pd.read_csv('\/kaggle\/input\/heart-failure\/data.csv')\nheart.head()","60fba62b":"#Descriptive Statistics\nprint(heart.shape)\nprint(heart.size)\nprint(heart.columns)\n","63a543b1":"print(heart.describe())","5bbab8f3":"#Checking for the missing values\nheart.isnull().sum()","89cc8801":"heart.info()","5286277f":"#Data type conversions\nheart['age']=heart['age'].astype('int')\nprint(heart['age'].dtype)\n\n#heart['DEATH_EVENT']=heart['DEATH_EVENT'].astype('int')\n#print(heart['DEATH_EVENT'].dtype)","d9349c41":"sns.pairplot(heart)","1d64bb03":"# class distribution\nprint(heart.groupby('DEATH_EVENT').size())\nalive=heart[heart['DEATH_EVENT']==0]\ndead=heart[heart['DEATH_EVENT']==1]\n\n\n# Count the survived and deceased \nprint(\"Total =\", len(heart))\n\nprint(\"Number of Survived =\", len(alive))\nprint(\"Did not Survive =\", len(dead))\n\nprint(\"Percentage Alive =\",len(alive)\/len(heart)*100.0, \"%\")\nprint(\"Percentage who did not survive = {}\".format(len(dead)\/len(heart)*100.0), \"%\")\n \n\n\nsns.countplot(x=heart['DEATH_EVENT'],data=heart)","8d9cf5d4":"heart.hist()\nplt.show()","16fe1af3":"print(heart['age'].describe())\n#Mean==Median, looks normal distribution.\n\n# Bar Chart to indicate the number of people survived based on their age\nplt.figure(figsize=(20,10))\nsns.countplot(x = 'age', hue = 'DEATH_EVENT', data=heart)","4debe957":"#Distplot of Age\nplt.figure(figsize=(10,5))\nsns.distplot(heart['age'])","0f54ed17":"# Age Histogram \nheart['age'].hist(bins = 40)","6a2d8af4":"heart_1=heart.copy()\nheart_1.shape","2ffca954":"heart.columns","5576758d":"sns.boxplot(heart['age']) #No outliers","36d25971":"#The CPK normal range for a male is between 39 \u2013 308 U\/L, while in females the CPK normal range is between 26 \u2013 192 U\/L\nsns.boxplot(heart['creatinine_phosphokinase'])\n\nheart_1['creatinine_phosphokinase'].describe()\nq1 = heart_1['creatinine_phosphokinase'].quantile(0.25)\nq3 = heart_1['creatinine_phosphokinase'].quantile(0.75)\nIQR = q3 - q1\nprint(q1,q3,IQR)\nlower_limit = q1 - 1.5 * IQR\nupper_limit = q3 + 1.5 * IQR\nprint(\"Lower Bound:\",lower_limit)\nprint(\"Upper Bound:\",upper_limit)\n\ncreatinine_phosphokinase_Outliers = heart_1[(heart_1['creatinine_phosphokinase']>upper_limit) | (heart_1['creatinine_phosphokinase']<lower_limit)]\nprint(len(creatinine_phosphokinase_Outliers))\n\nheart_1.loc[heart_1.creatinine_phosphokinase >upper_limit,'creatinine_phosphokinase']=upper_limit\nheart_1.loc[heart_1.creatinine_phosphokinase<lower_limit,'creatinine_phosphokinase']=lower_limit\nheart_1['creatinine_phosphokinase'].describe()","39f3130e":"#After removing the outliers\nsns.boxplot(heart_1['creatinine_phosphokinase'])","bceceeac":"#A normal heart's ejection fraction may be between 50 and 70 percent. \n#You can have a normal ejection fraction measurement and still have heart failure (called HFpEF or heart failure with preserved ejection fraction)\nsns.boxplot(heart['ejection_fraction'])","c4195d1b":"#A normal blood sodium level is between 135 and 145 milliequivalents per liter (mEq\/L). Hyponatremia occurs when the sodium in your blood falls below 135 mEq\/L. \n#Kidney Failure\nsns.boxplot(heart['serum_sodium'])","f66728c0":"print(heart['platelets'].describe())\n#A normal platelet count ranges from 150,000 to 450,000 platelets per microliter of blood. Having more than 450,000 platelets is a condition called thrombocytosis; having less than 150,000 is known as thrombocytopenia.\n#When a platelet count is below 50,000, bleeding is more serious if you're cut or bruised. If the platelet count falls below 10,000 to 20,000 per microliter, spontaneous bleeding may occur and is considered a life-threatening risk.\nsns.boxplot(heart['platelets'])","a8b47d1b":"#The kidneys are responsible for keeping the level of creatinine in the blood within a normal range. The typical reference range for serum creatinine is 60 to 110 micromoles per liter (\u03bcmol\/L) (0.7 to 1.2 milligrams per deciliter (mg\/dL)) for men and 45 to 90 \u03bcmol\/L (0.5 to 1.0 mg\/dL) for women\nprint(heart['serum_creatinine'].describe())\nsns.boxplot(heart['serum_creatinine'])\n#A person with only one kidney may have a normal level of about 1.8 or 1.9. Creatinine levels that reach 2.0 or more in babies and 5.0 or more in adults may indicate severe kidney impairment","2f751783":"heart=heart_1.copy()\nheart.shape","414d72a6":"fig, ax = plt.subplots(figsize=(10,10)) \nc=heart.corr()\nsns.heatmap(c,annot=True,ax=ax)","1a0fe9f7":"#Let's drop the target coloumn before we do train test split\nX = heart.drop('DEATH_EVENT',axis=1).values\ny = heart['DEATH_EVENT'].values\nfrom sklearn.model_selection import train_test_split\nseed=21\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=seed)","fd15070f":"print(X_train.shape)\nprint(X_test.shape)\nprint(y_train.shape)\nprint(y_test.shape)","f14dcd9d":"from sklearn.linear_model import LogisticRegression","44e6f5a4":"# Fitting Logistic Regression to the Training set\nfrom sklearn.linear_model import LogisticRegression\nclassifier = LogisticRegression(random_state = 0)\nclassifier.fit(X_train, y_train)\n\nprint(classifier.coef_)\nprint(classifier.intercept_)","5ebddc49":"y_predict_test = classifier.predict(X_test)\n#print(y_predict_test)\ny_predict_train=classifier.predict(X_train)","8bb0448c":"from sklearn import model_selection\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import accuracy_score\n","2e41e21d":"from sklearn.metrics import confusion_matrix\ncm = confusion_matrix(y_test, y_predict_test)\n#plt.figure(figsize=(5, 5))\nax=sns.heatmap(cm, annot=True, fmt=\"d\",center=True,annot_kws={'size':14},square=True)\nbottom, top = ax.get_ylim()\nax.set_ylim(bottom + 0.5, top - 0.5)\n#cm","17d7deee":"from sklearn.metrics import classification_report\nprint(classification_report(y_test, y_predict_test))","d27916ef":"**Note: The data is imbalanced.","5079adf3":"### Splitting the dataset","73ab8997":"**Note: \n1. There is a positive realtion between sex and smoking. \n2. Time & Death Event shows strong negative relation.\n3. Though Serum_Ceatinine is not that strong. But high chances of those with kidney disease or failure leads to death.\n","7320ec8d":"### Building Model","8e4184b1":"#### Handling the outliers","a1ce0c88":"#Visualisation","4ec93419":"**Note: \nLogistic Regression model gives 85% of accuracy in predicting.","4c6024f0":"**Note: At the age 60, there is the high probabilty of heart failure and leads to death.","ea5256d4":"**Note: No missing values."}}