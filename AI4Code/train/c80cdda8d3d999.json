{"cell_type":{"3655c3f9":"code","b63b9241":"code","2b26e630":"code","79363b40":"code","3be349df":"code","d1dba1b9":"code","67f1d137":"code","903cf068":"code","75d7b835":"code","739a2c01":"code","bf260bc5":"code","00e0821f":"code","79682c81":"code","3641017c":"code","bebc066d":"code","558823d9":"code","2fe58e23":"code","e881f20f":"code","6c662ef3":"code","c8966d57":"code","63d311d7":"markdown","39df4342":"markdown","5a41a80f":"markdown","e4c1e0da":"markdown","0cd4ef42":"markdown","7c6eb050":"markdown","77c44166":"markdown"},"source":{"3655c3f9":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore')","b63b9241":"import tensorflow as tf","2b26e630":"print(tf.__version__)","79363b40":"tf.random.set_seed(12)","3be349df":"!ls \/","d1dba1b9":"!mkdir \/tmp\/Xray_train_data","67f1d137":"!cp -R \"..\/input\/covid19-radiography-database\/COVID-19 Radiography Database\/COVID-19\" \"\/tmp\/Xray_train_data\"","903cf068":"!cp -R \"..\/input\/covid19-radiography-database\/COVID-19 Radiography Database\/NORMAL\" \"\/tmp\/Xray_train_data\"","75d7b835":"!ls \"\/tmp\/Xray_train_data\"","739a2c01":"!ls -1 \"\/tmp\/Xray_train_data\/COVID-19\"| wc -l ","bf260bc5":"!ls -1 \"\/tmp\/Xray_train_data\/NORMAL\"| wc -l ","00e0821f":"# Deleting extra image\n!find \"\/tmp\/Xray_train_data\/NORMAL\" -type f -print0 | sort -zR | tail -zn +220 | xargs -0 rm","79682c81":"!ls -1 \"\/tmp\/Xray_train_data\/NORMAL\"| wc -l ","3641017c":"train_data_dir= \"\/tmp\/Xray_train_data\"","bebc066d":"# Used Sequential\nmodel=tf.keras.Sequential()\nmodel.add(tf.keras.layers.Conv2D(8, (3,3), activation='relu', input_shape=(64, 64, 3)))\nmodel.add(tf.keras.layers.MaxPooling2D(pool_size=(2, 2), strides=None, padding=\"valid\"))\nmodel.add(tf.keras.layers.Conv2D(16, (3,3), activation='relu'))\nmodel.add(tf.keras.layers.MaxPooling2D(pool_size=(2, 2), strides=None, padding=\"valid\"))\nmodel.add(tf.keras.layers.Flatten())\nmodel.add(tf.keras.layers.Dense(32))\nmodel.add(tf.keras.layers.Dropout(.1, input_shape=(32,)))\nmodel.add(tf.keras.layers.Dense(1, activation='sigmoid'))","558823d9":"# Defining optimizer\nfrom tensorflow.keras.optimizers import Adam\n\nmodel.compile(optimizer=Adam(lr=0.0001),\n              loss='binary_crossentropy',\n              metrics = ['accuracy'])","2fe58e23":"# Directing Images to train folder\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nimg_height, img_width=64,64\nbatch_size=16\ntrain_datagen = ImageDataGenerator(validation_split=0.3) # set validation split\n\ntrain_generator = train_datagen.flow_from_directory(\n    train_data_dir,\n    target_size=(img_height, img_width),\n    batch_size=batch_size,\n    class_mode='binary',\n    subset='training') # set as training data\n# Splitting images for validation set\nvalidation_generator = train_datagen.flow_from_directory(\n    train_data_dir, # same directory as training data\n    target_size=(img_height, img_width),\n    batch_size=batch_size,\n    class_mode='binary',\n    subset='validation') # set as validation data\n","e881f20f":"# Training the model\ntrainer=model.fit(train_generator,validation_data=validation_generator,epochs=10,verbose=2)","6c662ef3":"# Plotting train_loss vs val_loss\nplt.figure(figsize=(10,5))\nplt.plot(trainer.history[\"loss\"],label=\"loss\")\nplt.plot(trainer.history[\"val_loss\"],label=\"val_loss\")\nplt.legend()","c8966d57":"# Plotting train_accuracy vs Val_accuracy\nplt.figure(figsize=(10,5))\nplt.plot(trainer.history[\"accuracy\"],label=\"accuracy\")\nplt.plot(trainer.history[\"val_accuracy\"],label=\"val_accuracy\")\nplt.legend(loc='upper left')","63d311d7":"# **Using Tensorflow for detecting Covid-19 Infected Lungs from Normal Lungs with Chest X-Ray**","39df4342":"## **Starting Actual work**","5a41a80f":"### To deal with imbalanced dataset, I just took a lazy way out.","e4c1e0da":" ## Importing kaggle Data Train_Val Set","0cd4ef42":"#### Version 3 doesnot have any significance update. Just updated some folder issue.\n#### Thanks to @sarques","7c6eb050":"### Use \/tmp to create temporary folder","77c44166":"## If helped, do give an upvote. It means a lot."}}