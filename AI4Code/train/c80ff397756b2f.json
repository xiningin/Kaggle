{"cell_type":{"1be4e172":"code","30c18cbf":"code","b16b797d":"code","84aa0d20":"code","083e39a4":"code","30504d4e":"code","8223511e":"code","0c5b3743":"code","7992abb0":"code","c97ee0d8":"code","41798c14":"code","b2467dc6":"code","f059c169":"code","fb5b0ef4":"code","5a799eaf":"code","691ca716":"code","c7656f30":"code","c194e624":"code","aad64140":"code","4930e965":"code","12271d9f":"code","28436a9c":"code","b5538701":"markdown","2ffa0be3":"markdown","f8104a04":"markdown","2713a73a":"markdown","294d13a6":"markdown","7362921d":"markdown","a33eec10":"markdown","49e047f0":"markdown","af2b31d6":"markdown","8aac3c36":"markdown","7d9973fa":"markdown","006eeaca":"markdown","1163d2af":"markdown","0406efb2":"markdown","b1ea9635":"markdown"},"source":{"1be4e172":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","30c18cbf":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n#sns.set_style('darkgrid')","b16b797d":"data  = pd.read_csv('\/kaggle\/input\/fetal-health-classification\/fetal_health.csv', sep = ',')\ndf = pd.DataFrame(data)\ndf.head()","84aa0d20":"df.describe().T","083e39a4":"df.info()","30504d4e":"df.isna().sum()","8223511e":"df.fetal_health.unique()","0c5b3743":"sns.countplot(x = 'fetal_health', data = df)\nplt.title('Count plot of Fetal Heath', fontsize = 12)","7992abb0":"plt.figure(figsize = (15,10))\ncorr = df.corr()\nsns.heatmap(corr, cmap = 'coolwarm', linewidth = 0.5)","c97ee0d8":"plt.figure(figsize=(25,25))\ni=1\nfor col in df.columns:\n    plt.subplot(6,4,i)\n    sns.boxplot(x = 'fetal_health', y = col, data = df)\n    i+=1","41798c14":"sns.set_style('whitegrid')\nplt.figure(figsize=(25,25))\ni=1\nfor col in df.columns:\n    plt.subplot(6,4,i)\n    sns.histplot(x = col, data = df, hue = 'fetal_health', palette ='dark')\n    i+=1","b2467dc6":"#sns.pairplot(df, hue = 'fetal_health')","f059c169":"X = df.drop(['fetal_health'], axis = 1)\ny = df.fetal_health\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import LabelEncoder, StandardScaler\nle = LabelEncoder()\nsc = StandardScaler()\nfrom imblearn.over_sampling import SMOTE\nfrom sklearn.model_selection import train_test_split\nsm = SMOTE(random_state=42,k_neighbors=7)\n","fb5b0ef4":"X_rus, y_rus = sm.fit_resample(X, y)\nX_train, X_test, y_train, y_test = train_test_split(X_rus, y_rus , random_state =43, test_size = 0.2)","5a799eaf":"#X_train = sc.fit(X_train)\n#X_test  = sc.transform(X_test)","691ca716":"from sklearn.tree import DecisionTreeClassifier, ExtraTreeClassifier\nfrom sklearn.ensemble import ExtraTreesClassifier, RandomForestClassifier\nfrom sklearn.neighbors import KNeighborsClassifier, RadiusNeighborsClassifier\nfrom sklearn.metrics import accuracy_score\ndt = DecisionTreeClassifier()\net = ExtraTreeClassifier()\nets = ExtraTreesClassifier()\nrf = RandomForestClassifier()\nknn = KNeighborsClassifier()\nrn = RadiusNeighborsClassifier()\n\n\n","c7656f30":"model = [dt, et, ets, rf, knn]\nfor model in model:\n    model.fit(X_train, y_train)\n    y_pred = model.predict(X_test)\n    accu = accuracy_score(y_test, y_pred)\n    print(model,'\\n', 'accuracy score:', accu, '\\n')\n","c194e624":"from sklearn.metrics import classification_report\nmodel = [dt, et, ets, rf, knn]\nfor model in model:\n    model.fit(X_train, y_train)\n    y_pred = model.predict(X_test)\n    report = classification_report(y_test, y_pred)\n    print(model,'\\n', 'Classification_Report:','\\n', report, '\\n')","aad64140":"from sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import plot_confusion_matrix\nmodel = [dt, et, ets, rf, knn]\nfor model in model:\n    model.fit(X_train, y_train)\n    y_pred = model.predict(X_test)\n    cm = confusion_matrix(y_test, y_pred)\n    print(model,'\\n', 'confusion_matrix:','\\n', cm, '\\n')\n    plot_confusion_matrix(model, X_test, y_test)\n    plt.show()\n    \n","4930e965":"df.columns","12271d9f":"index = ['baseline value', 'accelerations', 'fetal_movement',\n       'uterine_contractions', 'light_decelerations', 'severe_decelerations',\n       'prolongued_decelerations', 'abnormal_short_term_variability',\n       'mean_value_of_short_term_variability',\n       'percentage_of_time_with_abnormal_long_term_variability',\n       'mean_value_of_long_term_variability', 'histogram_width',\n       'histogram_min', 'histogram_max', 'histogram_number_of_peaks',\n       'histogram_number_of_zeroes', 'histogram_mode', 'histogram_mean',\n       'histogram_median', 'histogram_variance', 'histogram_tendency',\n       ]","28436a9c":"#print(ets.feature_importances_)\nfeature_names = [f'feature {i}' for i in range(X.shape[1])]\nimportances = ets.feature_importances_\nETS_importances = pd.Series(importances, index=index)\nstd = np.std([ets.feature_importances_ for ets in ets.estimators_], axis=0)\n\nfig, ax = plt.subplots()\nETS_importances.plot.bar(yerr=std, ax=ax)\nax.set_title(\"Feature importances using MDI\")\nax.set_ylabel(\"Mean decrease in impurity\")\n#fig.tight_layout()","b5538701":"# Checking the status of fetal health\n# Data is imblanced","2ffa0be3":"# Accuracy of the models","f8104a04":"# Fetal Health based on other factors of the dataset","2713a73a":"# Using different classification modles which are suitable for multiclass & multilabel applications","294d13a6":"# if you have come down so far please do up-vote, Thank you","7362921d":"# Confusion Matrix","a33eec10":"# Data Preprocessing","49e047f0":"# Using SMOTE as the data is imblanced","af2b31d6":"![![image.jpg](attachment:4182344d-5bd2-4a47-b944-874bc6a6fb73.jpg)](http:\/\/https:\/\/www.google.com\/url?sa=i&url=https%3A%2F%2Fwww.news-medical.net%2Fhealth%2FPregnancy-21-24-weeks.aspx&psig=AOvVaw2T7Mazil49a9Z30UF_1n7P&ust=1626015715445000&source=images&cd=vfe&ved=0CAoQjRxqFwoTCMCR4tri2PECFQAAAAAdAAAAABAD)","8aac3c36":"# Based on Classification Report i.e. F1 score the BEST Model for this case is \"RandomForestClassifier or ExtraTreesClassifier\"","7d9973fa":"# Clasification reports of the models","006eeaca":"# No Null values observed","1163d2af":"# Establishing corelation ","0406efb2":"# Reading the dataset","b1ea9635":"# Count plot with hue as fetal health"}}