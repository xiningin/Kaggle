{"cell_type":{"ef264190":"code","3f1dae36":"code","a13812d5":"code","43d42280":"code","8149f5f3":"code","ad132c83":"code","75e3ecbe":"code","777e2b5f":"code","48331e82":"code","dbda114a":"code","c4adf6ae":"code","807e8390":"code","bd80e64d":"code","0d3c668a":"code","955d8dbb":"code","c8b9765d":"code","55c17fb4":"code","7ab3971b":"code","7a67554c":"code","2fa2dd7a":"code","09bfa42f":"code","d60858a3":"code","9332390b":"code","bab05232":"code","dd2fe392":"code","e45c739e":"code","0029950c":"code","a9d178b9":"code","4fa48641":"code","5536dcc8":"code","b50800b8":"code","83541e01":"code","13f9c88f":"code","1d6a343d":"code","ed063f35":"markdown","79004ee5":"markdown","a2b6cf0a":"markdown","e0479c71":"markdown","473d5450":"markdown","9718facc":"markdown","bd577219":"markdown","bd82d011":"markdown","3230b033":"markdown","54cd81b5":"markdown","8108a89c":"markdown"},"source":{"ef264190":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n#Ignore warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","3f1dae36":"df = pd.read_csv('..\/input\/punta-cana-hotels-review-spanish\/punta_cana.csv', encoding='utf8')\npd.set_option('display.max_columns', None)\ndf.head()","a13812d5":"df.isnull().sum()","43d42280":"#Code by Siti K https:\/\/www.kaggle.com\/khotijahs1\/2020-indonesia-university-rank\/comments\n\n#The Best 20 Women Chess competitors by Standard Rating\ntop_hotels = df.sort_values(by='rating', ascending=False)[:20]\nfigure = plt.figure(figsize=(10,6))\nsns.barplot(y=top_hotels.hotel_name, x=top_hotels.rating)\nplt.xticks()\nplt.xlabel('Ratings')\nplt.ylabel('Hotel Name')\nplt.title('Top Hotels by Ratings')\nplt.show()","8149f5f3":"##Code by Taha07  https:\/\/www.kaggle.com\/taha07\/data-scientists-jobs-analysis-visualization\/notebook\n\nfrom wordcloud import WordCloud\nfrom wordcloud import STOPWORDS\nstopwords = set(STOPWORDS)\nwordcloud = WordCloud(background_color = 'red',\n                      colormap='YlOrRd',\n                      height =2000,\n                      width = 2000\n                     ).generate(str(df[\"title\"]))\nplt.rcParams['figure.figsize'] = (12,12)\nplt.axis(\"off\")\nplt.imshow(wordcloud)\nplt.title(\"Reviews Titles\")\nplt.show()","ad132c83":"from sklearn.preprocessing import LabelEncoder\n\n#fill in mean for floats\nfor c in df.columns:\n    if df[c].dtype=='float16' or  df[c].dtype=='float32' or  df[c].dtype=='float64':\n        df[c].fillna(df[c].mean())\n\n#fill in -999 for categoricals\ndf = df.fillna(-999)\n# Label Encoding\nfor f in df.columns:\n    if df[f].dtype=='object': \n        lbl = LabelEncoder()\n        lbl.fit(list(df[f].values))\n        df[f] = lbl.transform(list(df[f].values))\n        \nprint('Labelling done.')","75e3ecbe":"# Prepare the data\nX = df.drop('rating', axis=1)\ny = df['rating'].copy()\n\nX.head()","777e2b5f":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.7, random_state=42)\nX_train.shape, X_test.shape","48331e82":"from sklearn.tree import DecisionTreeClassifier\n\ndt = DecisionTreeClassifier(max_depth=3)\ndt.fit(X_train, y_train)","dbda114a":"#Code by SIDDHARTH KASHYAP  https:\/\/www.kaggle.com\/sid9300\/heart-cases-decision-tree\n\n# pip users\n!pip install pydotplus\n!pip install six\n\nfrom IPython.display import Image\nfrom six import StringIO\nfrom sklearn.tree import export_graphviz\nimport pydotplus, graphviz\n\ndot_data = StringIO()\n\nexport_graphviz(dt, out_file=dot_data, filled=True, rounded=True, feature_names=X.columns, \n                )\n\ngraph = pydotplus.graph_from_dot_data(dot_data.getvalue())\nImage(graph.create_png())","c4adf6ae":"#Code by SIDDHARTH KASHYAP  https:\/\/www.kaggle.com\/sid9300\/heart-cases-decision-tree\n\ny_train_pred = dt.predict(X_train)\ny_test_pred = dt.predict(X_test)\n\nfrom sklearn.metrics import confusion_matrix, accuracy_score\n\nprint(\"Train set performance\")\nprint(accuracy_score(y_train, y_train_pred))\nconfusion_matrix(y_train, y_train_pred)","807e8390":"#Code by SIDDHARTH KASHYAP  https:\/\/www.kaggle.com\/sid9300\/heart-cases-decision-tree\n\nprint(\"Test set performance\")\nprint(accuracy_score(y_test, y_test_pred))\nconfusion_matrix(y_test, y_test_pred)","bd80e64d":"#Code by SIDDHARTH KASHYAP  https:\/\/www.kaggle.com\/sid9300\/heart-cases-decision-tree\n\ndef get_dt_graph(dt_classifier):\n    dot_data = StringIO()\n\n    export_graphviz(dt_classifier, out_file=dot_data, filled=True, rounded=True, feature_names=X.columns, \n                )\n    \n    graph = pydotplus.graph_from_dot_data(dot_data.getvalue())\n    \n    return graph","0d3c668a":"#Code by SIDDHARTH KASHYAP  https:\/\/www.kaggle.com\/sid9300\/heart-cases-decision-tree\n\ndef evaluate_model(dt_classifier):\n    y_train_pred = dt_classifier.predict(X_train)\n    y_test_pred = dt_classifier.predict(X_test)\n    \n    print(\"Train set performance\")\n    print(accuracy_score(y_train, y_train_pred))\n    print(confusion_matrix(y_train, y_train_pred))\n    print(\"-\"*50)\n    print(\"Test set performance\")\n    print(accuracy_score(y_test, y_test_pred))\n    print(confusion_matrix(y_test, y_test_pred))","955d8dbb":"evaluate_model(dt)","c8b9765d":"#Code by SIDDHARTH KASHYAP  https:\/\/www.kaggle.com\/sid9300\/heart-cases-decision-tree\n\ngph = get_dt_graph(dt)\nImage(gph.create_png())","55c17fb4":"#Code by SIDDHARTH KASHYAP  https:\/\/www.kaggle.com\/sid9300\/heart-cases-decision-tree\n\ndt_default = DecisionTreeClassifier(random_state=42)\ndt_default.fit(X_train, y_train)","7ab3971b":"gph = get_dt_graph(dt_default)\nImage(gph.create_png())","7a67554c":"evaluate_model(dt_default)","2fa2dd7a":"dt_depth = DecisionTreeClassifier(max_depth=3, random_state=42)\ndt_depth.fit(X_train, y_train)","09bfa42f":"evaluate_model(dt_depth)","d60858a3":"#Code by SIDDHARTH KASHYAP  https:\/\/www.kaggle.com\/sid9300\/heart-cases-decision-tree\n\ndt_min_split = DecisionTreeClassifier(min_samples_split=20, random_state=42)\ndt_min_split.fit(X_train, y_train)\n\ngph = get_dt_graph(dt_min_split)\nImage(gph.create_png())","9332390b":"evaluate_model(dt_min_split)","bab05232":"#Code by SIDDHARTH KASHYAP  https:\/\/www.kaggle.com\/sid9300\/heart-cases-decision-tree\n\ndt_min_leaf_entropy = DecisionTreeClassifier(min_samples_leaf=20, random_state=42, criterion=\"entropy\")\ndt_min_leaf_entropy.fit(X_train, y_train)\n\ngph = get_dt_graph(dt_min_leaf_entropy)\nImage(gph.create_png())","dd2fe392":"evaluate_model(dt_min_leaf_entropy)","e45c739e":"#Code by SIDDHARTH KASHYAP  https:\/\/www.kaggle.com\/sid9300\/heart-cases-decision-tree\n\ndt = DecisionTreeClassifier(random_state=42)\n\nfrom sklearn.model_selection import GridSearchCV\n\nparams = {\n    \"max_depth\": [2, 3, 5, 10, 20],\n    \"min_samples_leaf\": [5, 10, 20, 50, 100],\n    \"criterion\": ['gini', 'entropy']\n}\n\ngrid_search = GridSearchCV(estimator=dt, param_grid=params, cv=2, n_jobs=-1, verbose=1, scoring=\"accuracy\")","0029950c":"%%time\ngrid_search.fit(X_train, y_train)","a9d178b9":"cv_df = pd.DataFrame(grid_search.cv_results_)\ncv_df.head()","4fa48641":"cv_df.shape","5536dcc8":"cv_df.nlargest(5, 'mean_test_score')","b50800b8":"grid_search.best_estimator_","83541e01":"grid_search.best_score_","13f9c88f":"#Code by SIDDHARTH KASHYAP  https:\/\/www.kaggle.com\/sid9300\/heart-cases-decision-tree\n\ndt_best = grid_search.best_estimator_\nevaluate_model(dt_best)","1d6a343d":"#Code by SIDDHARTH KASHYAP  https:\/\/www.kaggle.com\/sid9300\/heart-cases-decision-tree\n\ngph = get_dt_graph(dt_best)\nImage(gph.create_png())","ed063f35":"#Decision tree without any hyper-parameter setting","79004ee5":"#Using Entropy instead of Gini","a2b6cf0a":"#We can't even read anything above","e0479c71":"#Controlling the depth of the tree","473d5450":"#Again we can't read anything above","9718facc":"#Only two???","bd577219":"#Building the decision tree","bd82d011":"#Acknowledgement\n\nSIDDHARTH KASHYAP https:\/\/www.kaggle.com\/sid9300\/heart-cases-decision-tree","3230b033":"![](https:\/\/encrypted-tbn0.gstatic.com\/images?q=tbn:ANd9GcTCDCmx5eoE-kPMMDIMqSzd-cmKIIalMzLD5w&usqp=CAU)vacacionespuntacana.com","54cd81b5":"#Hyper-parameter tuning using Grid Search CV","8108a89c":"#Again we can't read anything "}}