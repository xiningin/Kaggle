{"cell_type":{"b1918022":"code","f2474ad8":"code","fb482d5f":"code","f3996c87":"code","673ca681":"code","c852f601":"code","043d1192":"code","2ebbc916":"code","b7453f80":"code","0cb34c57":"code","046de384":"code","efa8ad50":"code","37925e72":"code","89337692":"code","1be2b9a4":"code","22bd8399":"markdown","98eded6a":"markdown","c81b4d26":"markdown","cb821219":"markdown","376c3f19":"markdown","2be1b377":"markdown"},"source":{"b1918022":"import numpy as np \nimport pandas as pd\nfrom glob import glob\nimport matplotlib.pyplot as plt\nimport torch\nimport torchaudio\nimport librosa\nimport scipy","f2474ad8":"SR = 2048","fb482d5f":"def get_full_path(signal_file_name):\n    folder_id = signal_file_name[:3]\n    path = f\"\/kaggle\/input\/g2net-gravitational-wave-detection\/train\/{folder_id[0]}\/{folder_id[1]}\/{folder_id[2]}\/{signal_file_name}.npy\"\n    return path","f3996c87":"def get_signal(file_path):\n    with open(file_path, \"rb\") as file:\n        return np.load(file)    ","673ca681":"def plot_transformation(\n    negative_signal,\n    positive_signal,\n    transformation,\n    title=\"CQT\"\n):\n    fig, ax = plt.subplots(3, 2, figsize=(18, 10))\n    plt.suptitle(f\"{title}\\n\\n\", fontsize=18)\n    fig.tight_layout()\n    \n    for i  in range(3):\n        ax[i, 0].imshow(transformation(negative_signal[i, :]), aspect='auto')\n        ax[i, 1].imshow(transformation(positive_signal[i, :]), aspect='auto')\n\n    for i in range(ax.shape[0]):\n        for j in range(ax.shape[1]):    \n            ax[i, j].set(xlabel='time', ylabel='pseudo freq')\n\n    ax[0, 0].set_title('label=0', fontsize=16)\n    ax[0, 1].set_title('label=1', fontsize=16)\n    \n    plt.show()","c852f601":"def plot_raw_signal(\n    negative_signal,\n    positive_signal\n):\n    fig, ax = plt.subplots(1, 2, figsize=(14, 5))\n    plt.suptitle(f\"Raw signal\\n\\n\", fontsize=18)\n    \n    for i  in range(3):\n        ax[0].plot(negative_signal[i, :])\n        ax[1].plot(positive_signal[i, :])        \n\n    for i in range(2):\n        ax[i].set(xlabel='time', ylabel='amplitude')\n\n    ax[0].set_title('label=0', fontsize=16)\n    ax[1].set_title('label=1', fontsize=16)\n    fig.tight_layout()\n    \n    plt.show()","043d1192":"train = pd.read_csv(\"\/kaggle\/input\/g2net-gravitational-wave-detection\/training_labels.csv\")\n\nall_negatives = train[train.target == 0].id.apply(get_full_path)\nall_positives = train[train.target == 1].id.apply(get_full_path)","2ebbc916":"id0 = get_signal(all_negatives.iloc[0])\nid1 = get_signal(all_positives.iloc[0])","b7453f80":"plot_raw_signal(id0, id1)","0cb34c57":"def get_stft(signal):\n    return torch.stft(torch.Tensor(signal), n_fft=128, return_complex=True, normalized=True).abs().numpy()","046de384":"plot_transformation(id0, id1, get_stft, \"STFT\")","efa8ad50":"def get_cqt(signal):    \n    return np.abs(librosa.cqt(signal, sr=SR, hop_length=5*8, n_bins=40, bins_per_octave=12))    ","37925e72":"plot_transformation(id0, id1, get_cqt, \"CQT\")","89337692":"def get_cwt_morlet(signal):\n    return np.abs(scipy.signal.cwt(signal, scipy.signal.morlet, np.arange(1, 10)))","1be2b9a4":"plot_transformation(id0, id1, get_cwt_morlet, \"CWT Morlet\")","22bd8399":"### Raw signal","98eded6a":"### Load labels\/data path","c81b4d26":"### CQT\n\n[In mathematics and signal processing, the constant-Q transform, simply known as CQT transforms a data series to the frequency domain. It is related to the Fourier transform and very closely related to the complex Morlet wavelet transform](https:\/\/en.wikipedia.org\/wiki\/Constant-Q_transform)","cb821219":"### CWT Morlet\n\n[In mathematics, the continuous wavelet transform (CWT) is a formal (i.e., non-numerical) tool that provides an overcomplete representation of a signal by letting the translation and scale parameter of the wavelets vary continuously](https:\/\/en.wikipedia.org\/wiki\/Continuous_wavelet_transform)","376c3f19":"### STFT\n\n[The Short-time Fourier transform (STFT), is a Fourier-related transform used to determine the sinusoidal frequency and phase content of local sections of a signal as it changes over time](https:\/\/en.wikipedia.org\/wiki\/Short-time_Fourier_transform)","2be1b377":"### Utils"}}