{"cell_type":{"7f77872d":"code","986660d5":"code","cbf3150e":"code","2e8c91d2":"code","f6ec44af":"code","50227eee":"code","57938ffd":"code","c296747d":"code","702f0888":"code","6c17740e":"code","797d4d43":"code","16ec9b8f":"code","08bbabf7":"code","9f5e6125":"code","ff7896f9":"code","d2598374":"code","00b13b18":"code","316ecd8a":"code","eafea9ec":"code","ef146465":"code","df15443b":"markdown","f60ab0c8":"markdown","e041dd05":"markdown","c0841bf3":"markdown","e4c6ab4d":"markdown","fa0a010a":"markdown"},"source":{"7f77872d":"import numpy as np\nimport matplotlib.pyplot as plt\nimport cv2","986660d5":"def dog(img, size=(0,0), k=1.6, sigma=0.5, gamma=1):\n    img1 = cv2.GaussianBlur(img, size, sigma)\n    img2 = cv2.GaussianBlur(img, size, k*sigma)\n    return img1-gamma*img2\n\ndef xdog(img, k=1.6, sigma=0.5, gamma=1, epsilon=1, phi=1):\n    aux = dog(img, k=k, sigma=sigma, gamma=gamma) \/ 255.0\n    for i in range(0, aux.shape[0]):\n        for j in range(0, aux.shape[1]):\n            if aux[i,j] < epsilon:\n                aux[i,j] = 255\n            else:\n                aux[i,j] = 255 * (1+np.tanh(phi*aux[i,j]))\n    return aux\n\ndef edge_dog(img, sigma=0.5, k=200, gamma=0.98):\n    aux = dog(img, sigma=sigma, k=k, gamma=gamma)\n    for i in range(0,aux.shape[0]):\n        for j in range(0,aux.shape[1]):\n            if(aux[i,j] > 0):\n                aux[i,j] = 255\n            else:\n                aux[i,j] = 0\n    return aux","cbf3150e":"ims = [cv2.imread(\"..\/input\/celeba-dataset\/img_align_celeba\/img_align_celeba\/00000{}.jpg\".format(i)) for i in range(1,6)]\nims = [cv2.cvtColor(img, cv2.COLOR_BGR2RGB) for img in ims] \nfig, ax = plt.subplots(1,5, figsize=(13,5))\nfor i in range(5):\n    ax[i].imshow(ims[i])\n    ax[i].axis(\"off\")","2e8c91d2":"imgs = [cv2.imread(\"..\/input\/celeba-dataset\/img_align_celeba\/img_align_celeba\/00000{}.jpg\".format(i)) for i in range(1,6)]\nimgs = [cv2.cvtColor(img, cv2.COLOR_BGR2GRAY) for img in imgs] \nfig, ax = plt.subplots(1,5, figsize=(13,5))\nfor i in range(5):\n    ax[i].imshow(imgs[i])\n    ax[i].axis(\"off\")","f6ec44af":"def xdog_plot(imgs, eps=1, sigma=1, phi=1):\n    fig, ax = plt.subplots(1, len(imgs), figsize=(13,5))\n    for i in range(len(imgs)):\n        ax[i].imshow(xdog(imgs[i], epsilon=eps, sigma=sigma, phi=phi), cmap=\"Greys\")\n        ax[i].axis(\"off\")\n        \ndef edge_dog_plot(imgs, sigma=1, k=1, gamma=1):\n    fig, ax = plt.subplots(1, len(imgs), figsize=(13,5))\n    for i in range(len(imgs)):\n        ax[i].imshow(edge_dog(imgs[i], gamma=gamma, sigma=sigma, k=k), cmap=\"Greys\")\n        ax[i].axis(\"off\")","50227eee":"xdog_plot(imgs)","57938ffd":"xdog_plot(imgs, eps=0.1, sigma=0.5, phi=200)","c296747d":"xdog_plot(imgs, eps=0.1, sigma=1, phi=200)","702f0888":"xdog_plot(imgs, eps=0.1, sigma=2, phi=200)","6c17740e":"xdog_plot(imgs, eps=0.1, sigma=3, phi=200)","797d4d43":"xdog_plot(imgs, eps=0.01, sigma=1.5, phi=200)","16ec9b8f":"xdog_plot(imgs, eps=0.1, sigma=1.5, phi=200)","08bbabf7":"xdog_plot(imgs, eps=0.5, sigma=1.5, phi=200)","9f5e6125":"xdog_plot(imgs, eps=1, sigma=1.5, phi=200)","ff7896f9":"xdog_plot(imgs, eps=0.1, sigma=1.5, phi=2)","d2598374":"xdog_plot(imgs, eps=0.1, sigma=1.5, phi=20)","00b13b18":"xdog_plot(imgs, eps=0.1, sigma=1.5, phi=2000)","316ecd8a":"edge_dog_plot(imgs, sigma=0.5, k=200, gamma=0.98)","eafea9ec":"edge_dog_plot(imgs, sigma=0.5, k=2, gamma=0.98)","ef146465":"edge_dog_plot(imgs, sigma=1.5, k=2, gamma=0.98)","df15443b":"# EdgeDoG","f60ab0c8":"# Sigma","e041dd05":"# XDoG","c0841bf3":"# Epsilon","e4c6ab4d":"# CV2","fa0a010a":"# Phi"}}