{"cell_type":{"7f6155f5":"code","9bb6198a":"code","83c55b87":"code","a0496f18":"code","95a263ea":"code","5d2e0aba":"code","5c9ad004":"code","fc436d06":"code","40100b07":"code","e4a53104":"code","30770d2a":"code","123be32d":"code","07c456bd":"code","cde47e21":"code","1b42b236":"code","d91577a0":"code","80f46338":"code","7f98d9e1":"code","35b78e08":"code","98942d48":"code","8d9888dd":"code","49b644d0":"code","2d6d58a9":"code","bdd71786":"code","8e418c6b":"code","6c005280":"code","6b4a0ae6":"code","9b9aa97e":"code","1330600b":"code","c4383203":"code","04b9ffba":"markdown","2f83a659":"markdown","9ad9f2ed":"markdown","fadd05c8":"markdown","5a601581":"markdown","d2b1d470":"markdown","997ac6a2":"markdown","4898e2fa":"markdown","a3f4655d":"markdown","50215734":"markdown","2ef51eb6":"markdown","21e90377":"markdown","f14172be":"markdown","0b340c9b":"markdown","fef1757b":"markdown","ef6583be":"markdown","40cefea7":"markdown","ecf39c95":"markdown","26bb91fc":"markdown","82afed1b":"markdown","75b8b677":"markdown","246570a0":"markdown","136a3ea2":"markdown"},"source":{"7f6155f5":"!pip install bar_chart_race\n!pip install folium\n!pip install -U nlp_profiler","9bb6198a":"import os\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport bar_chart_race as bcr\nimport folium\n\nfrom nlp_profiler.core import apply_text_profiling","83c55b87":"home = '..\/input\/police-violence-in-the-us'\ndf_police = pd.read_csv(os.path.join(home, 'police_deaths_538.csv'))\n# df_people = pd.read_csv(os.path.join(home, 'police_killings.csv'))\n\nstate_geo = '..\/input\/usa-states-geojson\/us-states.json'\n\ndf_ml = pd.read_csv(\"..\/input\/tester\/sample.csv\", sep=\"\\t\")","a0496f18":"! java --version","95a263ea":"df_police.head().T","5d2e0aba":"cause_count = df_police.cause_short.value_counts()[:4]\ncause_count.plot(kind='pie', fontsize=15, autopct='%1.1f%%')\nplt.ylabel('')\nplt.title(\"Top 5 causes of why police people are martyered\")","5c9ad004":"state_count = df_police.state.value_counts()[:5]\nstate_count.plot(kind='pie', fontsize=15, autopct='%1.1f%%')\nplt.ylabel('')\nplt.title(\"Top 5 States where of most police fatalities\")","fc436d06":"canine = df_police.canine.value_counts() # no of dogs who died or not\ncanine.plot(kind='pie', fontsize=15, autopct='%1.1f%%')\nplt.ylabel(\" \")\nplt.title(\"No of humans killed vs No of dogs killed\")","40100b07":"most_tragic = df_police.date.value_counts()[:10]\nmost_tragic.plot(kind='bar')","e4a53104":"# thanks to jpmillers notebook\nkilled = df_police.loc[df_police.canine==False]\nkilled.groupby(\"year\")[\"person\"].size().plot.line()","30770d2a":"df_police['F_job_pos'] = df_police['person'].apply(lambda x: str(x).partition(' ')[0].strip())","123be32d":"df_police['Remain_job_position'] = df_police['person'].apply(lambda x: str(x).partition(' ')[2].strip())\n","07c456bd":"display(df_police['F_job_pos'].value_counts()[:14])","cde47e21":"# convert string to datetime64\ndf_police['date'] = pd.to_datetime(df_police['date'])\n\ndf_police.loc[:, \"year\"] = df_police[\"date\"].dt.year\ndf_police.loc[:, \"weekofyear\"] = df_police[\"date\"].dt.weekofyear\ndf_police.loc[:, \"month\"] = df_police[\"date\"].dt.month\ndf_police.loc[:, \"dayofweek\"] = df_police[\"date\"].dt.dayofweek\ndf_police.loc[:, \"day\"] = df_police[\"date\"].dt.day\ndf_police.loc[:, \"weekend\"] = (df_police.date.dt.weekday >=5).astype(int)","1b42b236":"print(f\"The available data is between range {df_police['date'].min()} and {df_police['date'].max()}\")","d91577a0":"df_police['count'] = 1","80f46338":"df_1950 = df_police[(df_police['year']>=1950) &(df_police['year']<=2016)]\ndfc = df_1950.copy()\ndfc['count'] = df_1950['count'].cumsum()\ndfc = pd.pivot_table(dfc, index='year', values='count')\n\nbcr.bar_chart_race(df = dfc, title = \"Cumulative police deaths from 1950-2010\", figsize=(5, 3),cmap = (([\"red\"] * 7)))","7f98d9e1":"state_count_policekillings = df_police[['state', 'person']].groupby([\"state\",]).count().reset_index()\nstate_count_policekillings.head()\nstate_count_policekillings.columns = ['State', 'Police_killed']\n","35b78e08":"state_count_policekillings.sort_values(by='Police_killed', ascending=False)[:20]","98942d48":"text_dataframe = pd.DataFrame(df_ml, columns=['sentence'])\ntext_dataframe.head()","8d9888dd":"%%time\nprofiled_text_dataframe = apply_text_profiling(df_ml, 'sentence')\nprofiled_text_dataframe.head()","49b644d0":"profiled_text_dataframe","2d6d58a9":"profiled_text_dataframe['sentiment_polarity'].hist(xlabelsize=15, ylabelsize=15)","bdd71786":"m = folium.Map(location=[48, -102], zoom_start=3)\n\nfolium.Choropleth(\n    geo_data=state_geo,\n    name='choropleth',\n    data=state_count_policekillings,\n    columns=['State', 'Police_killed'],\n    key_on='feature.id',\n    fill_color='YlGn',\n    fill_opacity=0.7,\n    line_opacity=0.2,\n    legend_name='Police forces killed per state'\n).add_to(m)\n\nfolium.LayerControl().add_to(m)\n\nm","8e418c6b":"print(state_count_policekillings.shape)","6c005280":"url = 'https:\/\/raw.githubusercontent.com\/python-visualization\/folium\/master\/examples\/data'\nstate_geo = f'{url}\/us-states.json'\nstate_unemployment = f'{url}\/US_Unemployment_Oct2012.csv'\nstate_data = pd.read_csv(state_unemployment)\n\nm = folium.Map(location=[48, -102], zoom_start=3)\n\nfolium.Choropleth(\n    geo_data=state_geo,\n    name='choropleth',\n    data=state_data,\n    columns=['State', 'Unemployment'],\n    key_on='feature.id',\n    fill_color='YlGn',\n    fill_opacity=0.7,\n    line_opacity=0.2,\n    legend_name='Unemployment Rate (%)'\n).add_to(m)\n\nfolium.LayerControl().add_to(m)\n\nm","6b4a0ae6":"state_count_policekillings.shape","9b9aa97e":"state_data.shape","1330600b":"state_count_policekillings.State = state_data.State\nstate_count_policekillings = state_count_policekillings.dropna()\nprint(state_count_policekillings.shape)\nstate_count_policekillings.head()","c4383203":"m = folium.Map(location=[48, -102], zoom_start=3)\n\nfolium.Choropleth(\n    geo_data=state_geo,\n    name='choropleth',\n    data=state_count_policekillings,\n    columns=['State', 'Police_killed'],\n    key_on='feature.id',\n    fill_color='YlGn',\n    fill_opacity=0.7,\n    line_opacity=0.2,\n    legend_name='Police forces killed per state'\n).add_to(m)\n\nfolium.LayerControl().add_to(m)\n\nm","04b9ffba":"The police_deaths dataset contains the follownig columns:\n\n- person: A string with position and name of Police officers who were killed on line of duty\n- dept: The department person belonged to\n- eow: It refers to the date of death of a police officer who was killed in the line of duty.\n- cause: It refers to the cause by which the police officer was killed on and mention which place it happend etc.\n- cause_short: Abrreviated cause of why a person was killed\n- date: date in YY-MM-DD format\n- canine: Whether a dog was killed or not?\n- dept_name: Which department the person who died belongs to?\n- state: state where person belongs to?","2f83a659":"# Quick look at data\n\n### Cause why police where martyered","9ad9f2ed":"- 9\/11 bomb attacks was one of the most disastorous days for US Police department. On a single day nearly 73 police officers died.\n- 2nd most disastorous event was in 27th April, 1870 when structure collapsed and almost 11 police men died","fadd05c8":"## Detailed look into causes with NLPProfiler Library\n\n- Don't run the entire dataset w\/ NLP Profiler library","5a601581":"### States where fatalities are more","d2b1d470":"## US State map where most police forces killed per state","997ac6a2":"### Tragic dates for police","4898e2fa":"## Feature Engineering date","a3f4655d":"<style type=\"text\/css\">\n\ndiv.h2 {\n    background-color: steelblue; \n    color: white; \n    padding: 8px; \n    padding-right: 300px; \n    font-size: 24px; \n    max-width: 1500px; \n    margin-top: 50px;\n    margin-bottom:4px;\n}\n    \nbody {\n  font-size: 12px;\n}    \n     \n                                    \n                                      \ndiv.h3 {\n    color: #159957; \n    font-size: 18px; \n    margin-top: 20px; \n    margin-bottom:4px;\n    text-decoration: underline;\n}\n   \n                                      \ndiv.h1 {\n    background-color: steelblue; \n    color: white;\n    padding: 8px; \n    padding-right: 300px; \n    font-size: 32px; \n    margin-top: 20px; \n    max-width: 1500px;\n    margin-bottom: 8px;\n}    \n<\/style>    \n ","50215734":"Great now we can see our US map representing the states where most amount of police where martyred! Finding this bug took me 2 days though :)","2ef51eb6":"## Feature Engineering","21e90377":"### Dogs killed","f14172be":"- It's evident from the data, most of the data points are having same positions and lack consistent spellings.\n- PatrolMan are killed the most","0b340c9b":"- More police deaths happend during 1920 to 1930s","fef1757b":"### Police deaths over the years","ef6583be":"<div class='h1'> Analysis for US Police<\/div>\n\nPolicing is a tiresome job and a job which requires much attention too. I will be trying to act like a analyst for Police chief and help uncover interesting mysteries about brave policemen who are martyred while they serve their duty. Let's see what I can uncover\n\n\n> I wished to upload a image, yet Kaggle is throwing me 1MB source errors","40cefea7":"## More work coming soon","ecf39c95":"**Oh things are terribly going wrong, There are only 50 states in United States of America while the data of police martyred consists of 60 states.**\n\nLet's go ahead and drop these states","26bb91fc":"- Everything in that snippet of code just works and follows things mentioned in [Folium docs](https:\/\/python-visualization.github.io\/folium\/quickstart.html#Choropleth-maps)\n\n> Then why are we getting a black map, which doesn't say anything?","82afed1b":"- 263 dogs have also been killed in the line of duty at police","75b8b677":"- Let me plug the example mentioned in the getting started guide of Folium","246570a0":"## States where most number of Police men are martyered","136a3ea2":"## Trends of deaths"}}