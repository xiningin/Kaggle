{"cell_type":{"194301c0":"code","8af6d2db":"code","4d33506f":"code","47238e3b":"code","f1cad2a8":"code","79b54659":"code","fabd7a4e":"code","45bc2f7c":"code","0d1855f0":"code","37cafc07":"code","7faa5ff5":"code","6ff1a0df":"code","280b50cb":"code","5b4b347b":"code","7d447a14":"code","f6a36f52":"code","8f0ca060":"code","2caa6218":"code","4656301d":"code","90c2a9ba":"code","c5ffc0c8":"code","44f3415c":"code","30578263":"code","63e270c2":"code","93ec336d":"code","8dd2166e":"code","01d87e31":"code","f0c2a9cf":"code","63da415d":"code","1a418805":"code","a067368d":"code","3fca797c":"code","6ac110c1":"code","640e35e8":"markdown","df92f77d":"markdown","e05355a5":"markdown","cfe80711":"markdown"},"source":{"194301c0":"import pandas as pd\nimport matplotlib.pyplot as pt\nimport warnings","8af6d2db":"from sklearn.model_selection import train_test_split , cross_val_score\nfrom sklearn.metrics import classification_report , confusion_matrix, mean_squared_error , r2_score \nfrom sklearn.neighbors import KNeighborsClassifier\nfrom math import sqrt","4d33506f":"from keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.wrappers.scikit_learn import KerasClassifier\nfrom keras.utils import np_utils","47238e3b":"from sklearn.model_selection import KFold\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.pipeline import Pipeline","f1cad2a8":"df = pd.read_csv(\"..\/input\/datacsv\/datasets_9066_12635_Indian automoble buying behavour study 1.0.csv\")","79b54659":"df.shape","fabd7a4e":"df.columns","45bc2f7c":"df.describe()","0d1855f0":"df.hist()","37cafc07":"df['Price'].max()","7faa5ff5":"df['Price'].min()","6ff1a0df":"df.isnull().sum()","280b50cb":"df['Make'].unique()","5b4b347b":"df['Make'].value_counts()","7d447a14":"df.head(3)","f6a36f52":"# Convert string into numeric\ndf['Profession'] = df['Profession'].replace ('Salaried',1)\ndf['Profession'] = df['Profession'].replace ('Business',2)","8f0ca060":"df['Marrital Status'] = df['Marrital Status'].replace ('Single',1)\ndf['Marrital Status'] = df['Marrital Status'].replace ('Married',2)","2caa6218":"df['Education'] = df['Education'].replace ('Graduate',1)\ndf['Education'] = df['Education'].replace ('Post Graduate',2)","4656301d":"df.replace('Yes', 2, inplace = True)\ndf.replace('No', 1, inplace = True)\ndf.replace('m', 0, inplace = True)","90c2a9ba":"df.columns","c5ffc0c8":"cars_model = df['Make'].unique()\ncars_model","44f3415c":"cars_model_mapping = [1,2,3,4,5,6,7,8,9]","30578263":"for car, maper in zip(cars_model, cars_model_mapping):\n    df['Make'] = df['Make'].replace(car, maper)","63e270c2":"df['Make'].unique()","93ec336d":"y = df['Make']\nX = df.drop(['Make'], axis= 1)","8dd2166e":"X_train, X_test , y_train, y_test = train_test_split(X, y, test_size = 0.3)","01d87e31":"model =  KNeighborsClassifier(n_neighbors=5)\nmodel.fit(X_train, y_train)","f0c2a9cf":"y_pred = model.predict(X_test)","63da415d":"print(confusion_matrix(y_test, y_pred))\n","1a418805":"print(classification_report(y_test, y_pred))","a067368d":"rms = sqrt(mean_squared_error (y_test , y_pred)) \nrms","3fca797c":"r2_score (y_test, y_pred)","6ac110c1":"# Classification report shows our model accuracy for each class , which is not good.\n# rms (difference between actual and predicted) should be less (in number 0.2 to 0.5 is good) for better results, it's too high.\n# R2 must be high (0.7 is a good number), we have negative r2score.","640e35e8":"# Predict Make of car for an individual to buy..","df92f77d":"# Model","e05355a5":"## knn","cfe80711":"### Train test data split"}}