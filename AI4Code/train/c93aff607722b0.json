{"cell_type":{"469d4e85":"code","d266b459":"code","4ed1d804":"code","43c23087":"code","35de06a6":"code","4715261a":"code","c679bf4c":"code","8e1cb841":"code","0b7b9533":"code","ab89df6f":"code","e987d8e4":"code","6b07c405":"code","35357f2e":"code","1a05df3f":"code","ebc41139":"code","4acf116f":"markdown","e88ebd51":"markdown","5fd36d02":"markdown","98dabedb":"markdown","605878eb":"markdown","9a2951e3":"markdown","3c41b296":"markdown","d41b45b6":"markdown","c8ee365d":"markdown","6ecae85f":"markdown","d1597793":"markdown","1a593f49":"markdown","a9c43caa":"markdown","7601ce02":"markdown","0676b18b":"markdown"},"source":{"469d4e85":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom google.cloud import bigquery\nimport sql_visualization_script as viz\nfrom sql_visualization_script import qplot\nimport warnings\nwarnings.simplefilter(action='ignore')","d266b459":"client= bigquery.Client()\ndataset_ref= client.dataset('new_york', project= 'bigquery-public-data')","4ed1d804":"import bq_helper\nfrom bq_helper import BigQueryHelper\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"new_york\")\nbq_assistant.list_tables()","43c23087":"query_= \"\"\"\nSELECT\n  *\nFROM\n  `bigquery-public-data.new_york.tlc_yellow_trips_2016`\nLIMIT\n  2\n  \"\"\"\nsafe_query_job= client.query(query_)\nsummary_df= safe_query_job.to_dataframe()\nsummary_df","35de06a6":"import sql_visualization_script as viz\nfrom sql_visualization_script import qplot","4715261a":"query2= \"\"\"\nSELECT * \nFROM `bigquery-public-data.new_york.tlc_yellow_trips_2016` \nWHERE trip_distance < 30\nAND fare_amount < 150\nLIMIT 180000\n\"\"\"\nqplot(query2, column1='fare_amount',data='new_york')","c679bf4c":"query3= \"\"\"\nSELECT tolls_amount \nFROM `bigquery-public-data.new_york.tlc_yellow_trips_2016` \nWHERE trip_distance < 30\nAND fare_amount < 1000\n\nLIMIT 18000\n\"\"\"\nqplot(query3, 'tolls_amount', data='new_york')","8e1cb841":"query4= \"\"\"\nSELECT tolls_amount , fare_amount\nFROM `bigquery-public-data.new_york.tlc_yellow_trips_2016`\nWHERE trip_distance < 30\nAND fare_amount < 450\nLIMIT 18000\n\"\"\"\nqplot(query4, 'fare_amount','tolls_amount', data='new_york')","0b7b9533":"query5= \"\"\"\nSELECT pickup_datetime as Rides_per_month\nFROM `bigquery-public-data.new_york.tlc_yellow_trips_2016` \nWHERE trip_distance < 30\nAND fare_amount < 1000\nLIMIT 180000\n\"\"\"\nqplot(query5, 'Rides_per_month',color='lightskyblue', data='new_york')","ab89df6f":"query6= \"\"\"\nSELECT *\nFROM `bigquery-public-data.new_york.tlc_yellow_trips_2016` \nWHERE trip_distance < 30\nAND fare_amount < 1000\nLIMIT 180000\n\"\"\"\nqplot(query6, 'trip_distance',color='gold', data='new_york')","e987d8e4":"query7= \"\"\"\nSELECT *\nFROM `bigquery-public-data.new_york.tlc_yellow_trips_2016` \nWHERE trip_distance < 30\nAND fare_amount BETWEEN 0 AND  1000\nLIMIT 180000\n\"\"\"\nqplot(query7, 'trip_distance','fare_amount',color='black', data='new_york')","6b07c405":"query7= \"\"\"\nSELECT passenger_count as passengers\nFROM `bigquery-public-data.new_york.tlc_yellow_trips_2016` \nWHERE trip_distance < 30\nAND fare_amount < 1000\nLIMIT 180000\n\"\"\"\nqplot(query7, 'passengers', color='crimson', data='new_york')","35357f2e":"query7= \"\"\"\nSELECT *\nFROM `bigquery-public-data.new_york.tlc_yellow_trips_2016`\nWHERE trip_distance < 30\nAND fare_amount < 1000\nLIMIT 180000\n\"\"\"\nqplot(query7, column2='trip_distance',column1='passenger_count',  color='deepskyblue', data='new_york')","1a05df3f":"query8= \"\"\"\nSELECT * \nFROM `bigquery-public-data.new_york.tlc_yellow_trips_2016` \nWHERE trip_distance BETWEEN 14 AND 30\nAND fare_amount < 1000\nAND tip_amount < 40\nLIMIT 180000\n\"\"\"\nqplot(query8, column1='tip_amount',column2='trip_distance',data='new_york')","ebc41139":"query9= \"\"\"\nSELECT health as NYC_Trees_health\nFROM `bigquery-public-data.new_york.tree_census_2015`\nLIMIT 180000\n\"\"\"\nqplot(query9, 'NYC_Trees_health', data='new_york')","4acf116f":"Insights:\n* Most of the trees are healthy.","e88ebd51":"Insights:\n* The tipping pattern is not clear.\n***\nNext, we move to another table: **Tree_census_2015** to explore information of the NYC trees.\n\n### How healthy are NYC trees?","5fd36d02":"> Insights:\n* Fare amount and trip distance are positively correlated.\n***\n### 7- The average passenger count per NYC cab ride?","98dabedb":"# New york dataset: SQL queries visualization\n***\nThis kernel is a tutorial of how to use the [SQL visualization script](https:\/\/www.kaggle.com\/amiiiney\/sql-visualization-script) to visualize SQL queries. The `qplot`function will help us explore NYC's yellow taxi records of 2016.\n\n<h6> Before starting <span class=\"label label-danger\">UPDATE<\/span><\/h6> \nI am still working on the `SQL visualization script`. Any recommendation, feedback or ideas are welcome to improve the `qplot` function and give it more functionalities.\n","605878eb":"> Inisghts:\n* June is the busiest month of the year for cab drivers.\n* August is the least busy month of the year.\n***\n### 5- What is the average trip distance of NYC cabs?\n\n","9a2951e3":"> Insights:\n* The average trip distance is around 5 and 20 miles.\n***\n### 6- Trip distance- Fare relationship?","3c41b296":"> Insights:\n* Most NYC cab rides are with just 1 passenger.\n***\n### 8- Passenger count and trip distance relationship?","d41b45b6":"# SQL queries Visualization: \n***\nSQL is a query language that enables us to query data and information in huge databases of hundred of GBs or TBs. There are many visualization tools to visualize SQL queries such as Tableau or Power BI. However, if you are familair with Python you can easily visualize your queries using pandas and matplotlib libraries.\n\nI made a script [SQL visualization script](https:\/\/www.kaggle.com\/amiiiney\/sql-visualization-script) that plots all kind of SQL queries with the `qplot`function:\n\n`qplot(query, column1, column2=None, w=15, h=5, color='deeppink', data=dataset)`\n\n ### *qplot* takes 7 input parameters:\n\n>1.     query: your SQL query\n>1.     column1: column to plot\n>1.     column2: 2nd column to plot with respect to column1 *(Optional)*\n>1.     w= width (default w=15)\n>1.     h= height (default h=5)\n>1.     colour= color (default colour='deeppink')\n>1.     data= dataset\n\n### How to use the [SQL visualization script](https:\/\/www.kaggle.com\/amiiiney\/sql-visualization-script) ?\n\n* File > Add utility script\n* Browse [SQL visualization script](https:\/\/www.kaggle.com\/amiiiney\/sql-visualization-script)\n* Import the library `sql_visualization_script`\n","c8ee365d":"> Insights:\n* Most long distance trips are just with 1 passenger.\n***\n\n### 9- Does the tip amount increase with the trip distance?","6ecae85f":"> Insights:\n* The tolls cost on average 0-15$\n\n### 3- Relationship between the fare and the toll amounts?","d1597793":"> **Insights:**\n* An average NYC cab ride costs on average around 20-30$\n***\n\n### 2- What is the toll amount paid by the NYC yellow taxi per ride?\n\n","1a593f49":"### Exploration of the tlc_yellow_trips_2016:\n***\nOver 1 billion Yellow and Green Taxi rides from 2009-present. Our data visualization will answer questions related to the NYC yellow taxis trips in 2016.\n\nBefore starting with visualization, we convert our first query to a pandas dataframe to have an idea of the different variables available in the `tlc_yellow_trips_2016` table. *(passenger_count, fare_amount, tip_amount, trip_distance...)*","a9c43caa":"### Connection to the database","7601ce02":"### Browsing the new york city tables in the database\n*Click on output to browse the new york tables*","0676b18b":"> Insights:\n* Toll amount tends to be positively correlated to the fare in the range of 0-100$\n***\n### 4- Which month of the year has the most cab rides?"}}