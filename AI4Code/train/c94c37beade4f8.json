{"cell_type":{"a33df274":"code","27e919b4":"code","4db9b7b6":"code","52557b16":"code","2cd349b3":"code","467942cf":"code","8859dd08":"code","338be6d1":"code","16e809c9":"code","1a315274":"code","13340075":"code","bfe8dfd7":"markdown","4e244c97":"markdown","ed5e35c8":"markdown","449f2a4e":"markdown","a3a11639":"markdown","1ffec885":"markdown","642fb59f":"markdown","cdff1e7a":"markdown","7a279b94":"markdown","b09f292d":"markdown","70f8ce88":"markdown","72f1950a":"markdown","f9383715":"markdown","c3ea9770":"markdown","88d0e452":"markdown","3c8c0238":"markdown","8aa024e5":"markdown","4e5f8032":"markdown","c8fe72b9":"markdown","b9e8d1ab":"markdown","e5df42e0":"markdown","02434fec":"markdown","35f2ff93":"markdown","4ab2c36b":"markdown","7f0b7238":"markdown","5924a80e":"markdown","2c91e9fd":"markdown","c5e543f5":"markdown","a00bdd19":"markdown","5ac2a3c9":"markdown","b4d5d47f":"markdown","2b1b8ea9":"markdown","b031e9d8":"markdown","68245f6c":"markdown"},"source":{"a33df274":"!pip install arch\n!pip install stargazer\n!pip install xlrd\n!pip install openpyxl","27e919b4":"#!pip install arch\n#!pip install stargazer\n#!pip install xlrd\n#!pip install openpyxl\n\n#import sys\n#sys.path.append('\/kaggle\/working\/mysitepackages\/')\n\n# source for this import: https:\/\/www.kaggle.com\/rtatman\/import-functions-from-kaggle-script\n# import module we'll need to import our custom module\nfrom shutil import copyfile\n# copy our file into the working directory (make sure it has .py suffix)\ncopyfile(src = \"..\/input\/urt-script\/unit_root_tests.py\", dst = \"..\/working\/unit_root_tests.py\")\n\n# filter warnings\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\n# import packages\nimport pandas as pd\nimport numpy as np\nimport arch\nimport statsmodels.tsa as smt\nfrom unit_root_tests import df_test, adf_test, pp_test, dfgls_test, kpss_test \n\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom stargazer.stargazer import Stargazer","4db9b7b6":"data = pd.read_excel(\"..\/input\/example-data\/example_data_tur.xlsx\")","52557b16":"data.head()","2cd349b3":"data['time'] = pd.to_datetime(data['time'], format=\"%Y\")\ndata.index = data['time']\ndata = data.drop(['time'], axis=1)\ndf = data[['unemp', 'inf', 'intrate', 'moneydem', 'lgdp']]\ndf.head()","467942cf":"fig, axs = plt.subplots(3, 2, figsize=(12, 15))\nfig.suptitle('macroeconomic varibales of Turkey')\n\naxs[0, 0].plot(df['unemp'])\naxs[0, 0].set_title(\"unemployment\")\n\naxs[1, 0].plot(df['inf'])\naxs[1, 0].set_title(\"inflation\")\n\naxs[0, 1].plot(df['intrate'])\naxs[0, 1].set_title(\"interest rate\")\n\naxs[1, 1].plot(df['moneydem'])\naxs[1, 1].set_title(\"money demand\")\n\naxs[2, 0].plot(df['lgdp'])\naxs[2, 0].set_title(\"log gdp\")\n\nfig.delaxes(axs[2,1])\n\nfig.tight_layout()","8859dd08":"results = df_test(df, trend='c')\nresults","338be6d1":"results = adf_test(df, trend='c', max_lags=4, method='AIC')\nresults","16e809c9":"results = pp_test(df)\nresults","1a315274":"results = dfgls_test(df)\nresults","13340075":"results = kpss_test(df)\nresults","bfe8dfd7":"## Effective Unit Root Tests","4e244c97":"The validity of the ADF test depends on the correct setup of the above test regression. In order for the model to be set up correctly, the lag length $k$ must be chosen correctly.\n\nIf $k$ is chosen smaller than it should be, the inference to be made depending on the ADF test will be deviated. On the other hand, if $k$ is chosen larger than it should be, the finite sampling characteristics of the ADF test will deteriorate.","ed5e35c8":"It should be noted that in Dickey-Fuller models the error term follows the iid white noise process. If the error term contains serial autocorrelation, the test statistic may reject the null hypothesis more than it should. In addition, the power of the test may be reduced. In eliminating the autocorrelation in the error term, Said and Dickey (1984) suggested adding the lags of the first difference of the $y_{t}$ series to the test regression:\n\n$$\\Delta y_{t}=\\boldsymbol{\\beta}^{\\top} \\boldsymbol{d}_{t}+\\alpha y_{t-1}+\\sum_{j=1}^{k} \\alpha_{j} \\Delta y_{t-j}+\\varepsilon_{t}$$\n\nThis version of the test is known in the literature as the **augmented Dickey-Fuller (ADF) test**. Calculation of test statistics, decision rule and asymptotic distribution of ADF are the same as DF test.","449f2a4e":"Kwiatkowsky et al. (1992) (KPSS) proposed a test where the null hypothesis is stationary around a trend of the series, and the difference is stationary for the alternative hypothesis. In the classical test approach, if there is strong evidence against non-stationarity (unit root), the null hypothesis is rejected. According to KPSS, one reason why the unit root hypothesis cannot be rejected, especially for parameter values very close to 1, is that economic time series do not contain enough information about whether or not they are unit roots. He proposed testing the KPSS (trend) -stationary null hypothesis as a way of increasing power for value alternatives close to the unit root. KPSS assumes that the series can be separated as follows:\n\n$$y_{t}=c_{t}+\\delta t+\\varepsilon_{t}, \\quad u_{t} \\sim \\operatorname{iid}\\left(0, \\sigma_{\\varepsilon}^{2}\\right)$$\n\nhere,\n\n$$c_{t}=c_{t-1}+u_{t}, \\quad u_{t} \\sim \\text { iid }\\left(0, \\sigma_{u}^{2}\\right)$$\n\nand $c_{0}$ is a fixed number. The series consists of a trend component, a random walk component and a stationary error component. Under the null hypothesis $\\sigma_{u}^{2} = 0, c_{t} = c_{0}$ and $y_{t}$ will be stable around a trend. Alternatively, if $\\delta = 0$, $y_{t}$ will be stationary around a constant.","a3a11639":"# Difference Stationary Process vs. Trend Stationary Process","1ffec885":"Although Perron's general framework is followed in Zivot and Andrews (1992) (ZA) endogen structural break test, the null hypothesis is the same for all three models. Under the null hypothesis, the model can be written as follows:\n\n$$y_{t}=\\mu+y_{t-1}+\\varepsilon_{t}$$\n\nTest regressions, Model A:\n\n$$y_{t}=\\mu^{A}+\\theta^{A} D U_{t}(\\lambda)+\\beta^{A} t+\\alpha^{A} y_{t-1}+\\sum_{j=1}^{k} \\delta_{j}^{A} \\Delta y_{t-j}+\\varepsilon_{t}$$\n\n$$\nD U_{t}(\\lambda)=\\left\\{\\begin{array}{ll}\n1, & t>T \\lambda \\text { ise } \\\\\n0, & \\text { de\u011filse }\n\\end{array}\\right.\n$$\n\nModel B:\n\n$$y_{t}=\\mu^{B}+\\beta^{B} t+\\gamma^{B} D T_{t}+\\alpha^{B} y_{t-1}+\\sum_{j=1}^{k} \\delta_{j}^{B} \\Delta y_{t-j}+\\varepsilon_{t}$$\n\n$$\nD T_{t}(\\lambda)=\\left\\{\\begin{array}{ll}\nt-T \\lambda, & t>T \\lambda \\text { ise } ; \\\\\n0, & \\text { de\u011filse. }\n\\end{array}\\right.\n$$\n\nModel C:\n\n$$y_{t}=\\mu^{C}+\\theta^{C} D U_{t}(\\lambda)+\\beta^{C} t+\\gamma^{C} D T_{t}(\\lambda)+\\alpha^{C} y_{t-1}+\\sum_{j=1}^{k} \\delta_{j}^{C} \\Delta y_{t-j}+\\varepsilon_{t}$$","642fb59f":"Phillips \\& Perron (1988) (PP) proposed a nonparametric test to correct possible autocorrelation in the inheritance in test regression. Consider the OLS estimation of the AR (1) process below:\n\n$$y_{t}=\\phi_{0}+\\phi_{1} y_{t-1}+u_{t}$$\n\nPP allows $u_{t} $ to be autocorrelated. PP test aims to eliminate the effect of this autocorrelation on DF $t$ statistic $\\mathrm{i}$. PP test statistic can be written as follows:\n\n$$\\tau_{P P}=t_{\\phi}\\left(\\frac{\\gamma_{0}}{\\lambda^{2}}\\right)^{1 \/ 2}-\\frac{1}{2}\\left(\\frac{\\left(\\lambda^{2}-\\gamma_{0}\\right) T \\sigma_{\\phi}}{\\lambda s}\\right)$$\n\nHere, $t_{\\phi}$,  $t$ statistic found from the OLS regression of the $H_{0}: \\phi_{1} = 1$ hypothesis. $\\gamma_{0}$ is the error variance, $\\lambda^{2}$ is the long-term variance of the error term. $\\sigma_{\\phi}$ is the standard error of $\\phi_{1}$ and the standard error of $s$ OLS test regression. These sizes can be estimated consistently with the help of standard formulas. If we call the errors from OLS regression as $\\hat{u}_{t}$:\n\n$$\\hat{\\gamma}_{0}=\\frac{1}{T} \\sum_{t=1}^{T} \\hat{u}_{t}^{2}$$\n\nand\n\n\n$$s^{2}=\\frac{1}{T-k} \\sum_{t=1}^{T} \\hat{u}_{t}^{2}$$\n\nWhere $k$ is the number of explanatory variables in the test regression.","cdff1e7a":"## TODO:\n\n* Add interpretations\n* Zivot-Andrews test implementation\n* Simplify code \n* Extend code","7a279b94":"Now suppose we have shifted the starting point from $t$ to $t + k$. If $Y$ is stable, the mean, variance and covariance of the $Y_{t}$ and $Y_{t + k}$ series must be the same.\n\nWhen $k = 0$, $\\operatorname{cov}\\left(Y_{t}, Y_{t+0}\\right)=\\operatorname{var}\\left(Y_{t}\\right)=\\sigma^{2}$","b09f292d":"In order for the standard asymptotic theory to be valid in regression analysis with time series, all variables must be $\\mathrm {I}(0),$ ie stationary.\n\nThe use of difference stationary time series in regression can lead to the problem of **spurious regression**.\n\nIn case all variables are I(1), it is checked whether there is a long-term cointegration relationship between the series.\n\nIf there is cointegration, the appropriate regression model also includes deviations from the long-term cointegration relationship. (Error correction model - Error Correction Model ECM). Otherwise, regression should be established by taking the first differences of the series.","70f8ce88":"# References","72f1950a":"## Dataset","f9383715":"## Dickey-Fuller Unit-Root Test","c3ea9770":"Elliott, Rothenberg, \\& Stock (1996) proposed two test statistics that do not require OLS estimation of coefficients of deterministic variables (such as trend and constant). The first test is based on the modification of the DF test. Based on the observation that OLS is not effective in predicting trend and constant term, ERS suggested taking the quasi-differences of the data.\n\nThe DF-GLS test statistic proposed by ERS is based on the following test regression without deterministic dental variables:\n\n$$\\Delta y_{t}=\\alpha_{0} y_{t-1}^{d}+\\alpha_{1} \\Delta y_{t-1}^{d}+\\cdots+\\alpha_{p} \\Delta y_{t-p}^{d}+\\text { error }$$","88d0e452":"$H_{0}: \\alpha_{0} = 0$ null hypothesis is tested with the statistic DF $t$. The distribution of the DF-GLS test statistic is fixed in the model and the same as the DF test statistic if there is no trend. In other cases, asymptotic distribution is different. ERS has tabulated the critical values by approximating the asymptotic distribution with Monte Carlo methods (see ERS, 1996; p. 825, Table 1, Panel C). If the calculated test statistic is less than the critical value, the unit root null hypothesis is rejected.\n\nThe second test proposed by ERS (1996) is known as the point-optimal test. This test statistic is based on the residues obtained from the OLS regression, which is established with the quasi-difference transformed data. Let's define the residues from this regression as follows:\n\n$$\\hat{\\zeta}=d\\left(y_{t} \\mid a\\right)-\\hat{\\delta}^{\\prime} d\\left(x_{t} \\mid a\\right)$$\n\nERS point-optimal test statistic:\n\n$$P_{T}=\\frac{S S R(\\bar{a})-\\bar{a} S S R(1)}{\\lambda_{0}}$$\n\nHere SSR is the sum of residual squares (e.g., $\\operatorname{SSR} (\\bar{a}) = \\hat{\\zeta} (\\bar{a})$) and $\\lambda_{0}$ long-term variance. Critical values were found by ERS through simulations (see ERS, p. 825, Table $1,$ Panel $\\mathrm{A}$ and $\\mathrm{B}$).","3c8c0238":"To calculate unit-root test statistic for DF(1979) test, three different equations are used:\n\n$$\n\\text{without constant and trend}: \\Delta y_{t}=\\alpha y_{t-1}+\\varepsilon_{t}\n$$\n\n$$\n\\text{with constant}: \\Delta y_{t}=\\beta_{0} + \\alpha y_{t-1}+\\varepsilon_{t}\n$$\n\n$$\n\\text{with constant and trend}: \\Delta y_{t}=\\beta_{0} + \\beta_{1} t + \\alpha y_{t-1}+\\varepsilon_{t}\n$$","8aa024e5":"In practice, it is extremely important to determine whether a time series is stationary (TSP or DSP).\n\nFor this purpose, various unit root and stationarity tests have been developed. The most commonly used of these tests are: ADF test, PP test, DF-GLS test, ERS Point-Optimal test, NP test, KPSS test.","4e5f8032":"Here, I used macroeconomic time series about Turkey as example. ","c8fe72b9":"## Augmented Dickey-Fuller Unit Root Test","b9e8d1ab":"## Philips-Perron Test","e5df42e0":"# Introduction","02434fec":"One of the basic processes in time series analysis is the \"stationary\" stochastic process. A **stationary process** is the process whose mean and variance do not change over time and the covariance between two periods depends on the distance between the periods, not the period under consideration.\n\nTo explain, let's define a $Y_{t}$ series as follows.\n\n$$\n\\begin{aligned}\nE\\left(Y_{t}\\right) &=\\mu \\\\\n\\operatorname{var}\\left(Y_{t}\\right) &=\\gamma_{0} \\\\\n\\operatorname{cov}\\left(Y_{t}, Y_{t+k}\\right) &=\\gamma_{k}\n\\end{aligned}\n$$","35f2ff93":"# Libraries","4ab2c36b":"# Statistical Tests to Detect Non-Stationarity: Unit-Root Tests","7f0b7238":"Dickey-Fuller unit root tests (DF) use the standard regression approach to test this null hypothesis (Dickey & Fuller (1979) and Dickey & Fuller (1981)). Suppose the following regression:\n\n$$\n\\Delta y_{t}=\\alpha y_{t-1}+\\varepsilon_{t}\n$$\n\nWhere $\\Delta y_{t} = y_{t}-y_{t-1}$ and $\\alpha = \\phi-1$. Null and alternative hypotheses:\n\n$$\n\\begin{array}{ll}\nH_{0}: \\alpha=0 & (\\phi=1) \\\\\nH_{1}: \\alpha<0 & (\\phi<1)\n\\end{array}\n$$\n\nThe alternative hypothesis is one-sided (left tail test). $H_{1}: \\alpha > 0, (\\rho > 1)$ is not very realistic for other alternative economic time series, so a right tail test is not performed. The DF test is equal to the standard t ratio, defined as the ratio of the OLS coefficient to the standard error:\n\n$$\n\\tau=\\frac{\\hat{\\alpha}}{\\text { s.e. }(\\hat{\\alpha})}\n$$\n\nThis statistic does not fit the standard t distribution under the null hypothesis. Dickey and Fuller (1979) calculated the critical values by describing the asymptotic distribution of this test statistic. There is no clear form of asymptotic distribution. Therefore, critical values must be calculated with simulations.","5924a80e":"Dickey, D. A. and Fuller, W. A. (1979), Distributions of the Estimators For Autoregressive Time Series with a Unit Root, Journal of the American Statistical Association, 75, 427--431.\n\nDickey, D. A. and Fuller, W. A. (1981), Likelihood Ratio Statistics for Autoregressive Time Series with a Unit Root, Econometrica, 49, 1057--1072. Hamilton (1994), Time Series Analysis, Princeton University Press.\n\nElliott, G., Rothenberg, T.J. and Stock, J.H. (1996), Efficient Tests for an Autoregressive Unit Root, Econometrica, Vol. 64, No. 4, 813--836.\n\nKwiatkowski, D., Phillips, P.C.B., Schmidt, P. and Shin, Y., (1992), Testing the Null Hypothesis of Stationarity Against the Alternative of a Unit Root: How Sure Are We That Economic Time Series Have a Unit Root?, Journal of Econometrics, 54, 159--178.\n\nMacKinnon, J.G. (1991), Critical Values for Cointegration Tests, Long-Run Economic Relationships, eds. R.F. Engle and C.W.J. Granger, London, Oxford, 267--276. Download possible at: http:\/\/cowles.econ.yale.edu\/, see rubric 'Discussion Papers (CFDPs)' and http:\/\/www.econ.ucsd.edu\/papers\/files\/90-4.pdf.\n\nPhillips, P. C. B. & P. Perron (1988). \u201cTesting for a Unit Root in Time Series Regression\u201d.\nIn: Biometrika 75, pp. 335\u201346.\n\nSaid, S. E.  and Dickey, D. A. (1984): Testing for Unit Roots in Autoregressive-Moving Average Models of Unknown Order. Biometrika 71, 599\u2013607.\n\nZivot, E. and Andrews, Donald W.K. (1992), Further Evidence on the Great Crash, the Oil-Price Shock, and the Unit-Root Hypothesis, Journal of Business \\& Economic Statistics, 10(3), 251--270.","2c91e9fd":"## Zivot-Andrews Test","c5e543f5":"# Regression Analysis with Non-Stationary Series","a00bdd19":"The mean of the series changes with $ t $. Therefore, the series is not stationary. However, when the trend is purged, it becomes stationary. In other words, a serial trend is stationary around:\n\n$$\nx_{t}-\\beta_{1} t=\\beta_{0}+\\epsilon_{t} \\sim I(0)\n$$","5ac2a3c9":"## KPSS Test","b4d5d47f":"Processes that can be made statioanry by taking their differences are called **difference-stationary processes(DSP)**. Series that are stationary when the first difference is taken are called first-order integrated series and denoted by $ I (1) $. Similarly, series that become stationary when the second difference is taken are called $ I (2) $ series. RW and RWD processes are $ I (1) $ processes. The first difference of these series is $ I (0) $, that is, it is stationary:\n\n$$\n\\Delta y_{t}=\\phi_{0}+\\epsilon_{t} \\sim I(0)\n$$\n\nwhere $\\epsilon_{t} \\sim w \\cdot n \\cdot\\left(0, \\sigma^{2}\\right)$.","2b1b8ea9":"A stationary time series according to our definition; It is a series whose mean, variance and covariance are independent of time. Such a series shows constant amplitude oscillations around its mean. This feature is also called \"return to mean\". Such stationary series can appear with different names in the literature:\n\n* weakly stationary,\n* covariance stationary,\n* second-order stationary.","b031e9d8":"The processes that fluctuate around a trend and tend to return to the trend over time are called **trend-stationary process (TSP)**. \n\nSuppose a deterministic trend model:\n\n$$\nx_{t}=\\beta_{0}+\\beta_{1} t+\\epsilon_{t}, \\quad \\epsilon_{t} \\sim w n\\left(0, \\sigma^{2}\\right)\n$$\n\nThe mean and variance functions of this process, respectively\n\n$$\n\\begin{array}{c}\n\\mu_{t}=\\mathrm{E}\\left(x_{t}\\right)=\\beta_{0}+\\beta_{1} t \\\\\n\\gamma_{0 t}=\\operatorname{Var}\\left(\\epsilon_{t}\\right)=\\sigma^{2}\n\\end{array}\n$$","68245f6c":"For ZA test values such as \\[0.1,0.9\\] or \\[0.15,0.85\\] $\\lambda = \\left[\\lambda_{1}, \\lambda_{2} \\right]$, estimating the appropriate one of these models and it is based on calculating the coefficient $y_{t-1}$ for each $\\lambda_{j}$ of $t$ test. This DF $t$ is used to infer the smallest statistics. Also, the min $t$ statistic will determine the breakpoint internally. In the ZA test, each $t$ is considered as a potential break point and separate test regression is estimated for each point. The critical values of the ZA min $t$ statistic depend on which of the above specifications is chosen and the $\\lambda$ value. It is larger in absolute value than the standard ADF critical values."}}