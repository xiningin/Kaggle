{"cell_type":{"2ebd5b9c":"code","228faf67":"code","2bee44e6":"code","6f407f5f":"code","cfb92e65":"code","3af79672":"code","998105fa":"code","ba1ef0ed":"code","cbe33d81":"code","7480a103":"code","f9b104f2":"code","254d6a6b":"code","cd2faeca":"code","445f644c":"code","9edbe22c":"code","f3412b93":"code","700f533c":"code","b35b5bb1":"code","96fdf672":"code","2aa7d92d":"code","8b3ad4cc":"code","ad310069":"code","70a07a11":"code","b1124c9d":"code","f1603c36":"code","caedec4f":"code","976f5538":"code","302f27f4":"code","07f59e44":"code","4dec710a":"code","99cf744a":"code","909cb12f":"code","04a9c4d1":"markdown","5a24e878":"markdown","4dd4157e":"markdown","62984fae":"markdown","14bbf21d":"markdown","7d31672e":"markdown","d3531831":"markdown","b8997945":"markdown","1b59f2a8":"markdown","569e5d49":"markdown","a56fb8d4":"markdown","d9b369f9":"markdown","415200fd":"markdown"},"source":{"2ebd5b9c":"import numpy as np \nimport pandas as pd \nimport pylab as plt\nimport seaborn as sns\nimport os\nimport cv2\nimport warnings\nwarnings.filterwarnings(\"ignore\")\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","228faf67":"train_df = pd.read_csv('..\/input\/train.csv')\nlabels_df = pd.read_csv('..\/input\/labels.csv')\nsubmission_df = pd.read_csv('..\/input\/sample_submission.csv')\nprint(\"Train data shape -  rows:\",train_df.shape[0],\" columns:\", train_df.shape[1])\nprint(\"Lables shape -      rows:\",labels_df.shape[0],\" columns:\", labels_df.shape[1])\nprint(\"submission csv shape -  rows:\",submission_df.shape[0],\" columns:\", submission_df.shape[1])","2bee44e6":"attribute_ids=train_df['attribute_ids'].values\nattribute_ids","6f407f5f":"attribute_ids=train_df['attribute_ids'].values\nattributes=[]\nfor attribute_items in [x.split(' ') for x in attribute_ids]:\n        for attribute in attribute_items:\n            attributes.append(int(attribute))\nattributes[0:10]","cfb92e65":"att_df=pd.DataFrame(attributes,columns=['attribute_id'])\natt_df=att_df.merge(labels_df)\natt_df.head(5)\n","3af79672":"frequent=att_df['attribute_name'].value_counts()[:30].to_frame()\nfrequent","998105fa":"plt.figure(figsize=(8,8))\nmost=sns.barplot(x=frequent.index,y=\"attribute_name\",data=frequent, palette=\"rocket\")\nmost.set_xlabel(\"Kind of label\",fontsize=14)\nmost.set_ylabel(\"Count\",fontsize=14)\nsns.despine()\nmost.set_xticklabels(most.get_xticklabels(), rotation=90,fontsize=14)\nplt.title(\"Most frequent attributes\",fontsize=18)\nplt.show()","ba1ef0ed":"infrequent=att_df['attribute_name'].value_counts(ascending=True)[:50].to_frame()\n\nplt.figure(figsize=(12,8))\ninmost=sns.barplot(x=infrequent.index,y=\"attribute_name\",data=infrequent, palette=\"rocket\")\ninmost.set_xlabel(\"Kind of label\",fontsize=14)\ninmost.set_ylabel(\"Count\",fontsize=14)\nsns.despine()\ninmost.set_xticklabels(most.get_xticklabels(), rotation=90,fontsize=14)\nplt.title(\"Most infrequent attributes\",fontsize=18)\nplt.show()","cbe33d81":"train_df['Number of Tags']=train_df['attribute_ids'].apply(lambda x: len(x.split(' ')))\ntrain_df.head(5)","7480a103":"f, ax = plt.subplots(figsize=(6, 6))\nax=sns.countplot(x=\"Number of Tags\",data=train_df,palette=\"GnBu_d\")\nax.set_xlabel(\"Number of Tags\",fontsize=14)\nax.set_ylabel(\"Count\",fontsize=14)\nsns.despine()\nplt.title(\"Number of Tags distribution\",fontsize=18)\nplt.show()\n","f9b104f2":"os.listdir(\"..\/input\/train\")[:300]","254d6a6b":"width = []\nheight = []\nfor img_name in os.listdir(\"..\/input\/train\/\")[-3000:]:\n    shape = cv2.imread(\"..\/input\/train\/%s\" % img_name).shape\n    height.append(shape[0])\n    width.append(shape[1])\nsize = pd.DataFrame({'height':height, 'width':width})\nsns.jointplot(\"height\", \"width\", size, kind='reg')  \nplt.show()","cd2faeca":"width=[]\nheight=[]\nfor img_name in os.listdir(\"..\/input\/train\")[:3000]:\n    img = cv2.imread(\"..\/input\/train\/%s\" % img_name)\n    width.append(img.shape[0])\n    height.append(img.shape[1])\nprint(width[:5])\nprint(height[:5])","445f644c":"size_df = pd.DataFrame({'width':width,'height':height})","9edbe22c":"size_df.head(5)","f3412b93":"print(size_df.count())","700f533c":"sns.lmplot('width','height',size_df, fit_reg=False) \nplt.show()","b35b5bb1":"print('The average width is '+str(np.mean(size_df.width)))\nprint('The median width is '+str(np.median(size_df.width)))\nprint('The average height is '+str(np.mean(size_df.height)))\nprint('The average height is '+str(np.mean(size_df.height)))","96fdf672":"most_fre=train_df[train_df['Number of Tags']>9]\nleast_fre=train_df[train_df['Number of Tags']<2]\nmost_fre\n","2aa7d92d":"count=1\nplt.figure(figsize=[30,20])\nfor img_name in most_fre['id'].values[:6]:\n    img = cv2.imread(\"..\/input\/train\/%s.png\" % img_name)\n    plt.subplot(2, 3, count)\n    plt.imshow(img)\n    count+=1\nplt.show()\n    ","8b3ad4cc":"count = 1\nplt.figure(figsize=[30,20])\nfor img_name in least_fre['id'].values[:6]:\n    img = cv2.imread(\"..\/input\/train\/%s.png\" % img_name)\n    plt.subplot(2, 3, count)\n    plt.imshow(img)\n    count += 1\nplt.show","ad310069":"train_df.head(3)\n","70a07a11":"labels_df.head(3)","b1124c9d":"submission_df.head(3)","f1603c36":"missing = train_df.isnull().sum()\nall_val = train_df.count()\nprint(missing)\nprint(all_val)\nmissing_train_df = pd.concat([missing, all_val], axis=1, keys=['Missing', 'All'])\nmissing_train_df","caedec4f":"image_names=sorted(os.listdir(\"..\/input\/train\"))\nprint(image_names[0])\nprint(image_names[1])\nprint(image_names[2])\nprint(image_names[3])","976f5538":"train_img=cv2.imread(\"..\/input\/train\/1000483014d91860.png\")\nplt.imshow(train_img)\nplt.axis('off')\ntrain_img.shape","302f27f4":"train_df","07f59e44":"train_dataset_info = []\nfor name, labels in zip(train_df['id'],train_df['attribute_ids'].str.split(' ')):\n    train_dataset_info.append({\n         'path':os.path.join('..\/input\/train', name),\n        'labels':np.array([int(label) for label in labels])})\ntrain_dataset_info = np.array(train_dataset_info)\ntrain_dataset_info","4dec710a":"\nlen(train_dataset_info)","99cf744a":"first=train_df['attribute_ids'].str.split(' ')\ntrain_df['first'] = first\ntrain_df.head(10)\n","909cb12f":"th10 = pd.DataFrame(train_df.attribute_ids.value_counts().head(10))\nth10.reset_index(level=0, inplace=True)\nth10.columns = ['attribute_ids','count']\nth10","04a9c4d1":"lables\u662f\u5c06attribute_id\u8fdb\u884c\u7f16\u53f7\u6765\u5bf9\u5e94name","5a24e878":"Analysis of picture size","4dd4157e":"\u5c06\u591a\u6807\u7b7e\u53d8\u4e3a\u5355\u6807\u7b7e\u5217\u8868","62984fae":"Pictures with least attributes","14bbf21d":"Pictures with most frequents","7d31672e":"**Number of samples**","d3531831":"\u8bad\u7ec3\u96c6\u5171\u6709109237\u5f20\u8bad\u7ec3\u56fe\u7247\uff0c\u6d4b\u8bd5\u96c6\u5171\u67097443\u5f20\u8bad\u7ec3\u56fe\u7247\uff0c\u5168\u90e8\u5171\u67091103\u79cd\u6807\u7b7e","b8997945":"\u5176\u4e2d\u7b2c\u4e00\u5f20\u56fe\u7247\u5927\u5c0f300*339 3\u4e2a\u989c\u8272\u901a\u9053,\u4e0b\u9762\u63d0\u53d6\u6570\u636e\u3002\n\u63d0\u56fe\u50cf\u8def\u5f84\u4e0e\u5176\u5bf9\u5e94\u7684\u6807\u7b7e\u4e00\u4e00\u5bf9\u5e94\u4e14\u5143\u7ec4\u5316\uff0c\u4f7f\u7528Numpy\u5bf9\u5176\u8fdb\u884c\u5e8f\u5217\u5316\u3002","1b59f2a8":"\u8bad\u7ec3\u6570\u636e\u4e2d\u65e0\u4efb\u4f55\u7f3a\u5931\u503c","569e5d49":"\u591a\u6807\u7b7e\u95ee\u9898\uff0c\u5176\u4e2d\u6807\u7b7e\u5e8f\u53f7\u5bf9\u5e94\u5b9e\u9645\u610f\u4e49\u5728lables.csv\u6587\u4ef6","a56fb8d4":"id\u4e0e\u6807\u7b7e\u5bf9\u5e94","d9b369f9":"\u8bb0\u5f55\u4e00\u4e0b\u5355\u6807\u7b7e\u7edf\u8ba1\u65b9\u6cd5","415200fd":"Most frequent attributes"}}