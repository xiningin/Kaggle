{"cell_type":{"83cc11c6":"code","20e825d5":"code","b6023dee":"code","70879773":"code","391df4be":"code","c3eede95":"code","05e4dbfd":"code","edd63deb":"code","0d2882bb":"code","848f2a5f":"code","eddf2d84":"code","a34dbf76":"code","e7038ac3":"code","226cd152":"code","8ece9dfc":"code","cacb0d1d":"code","6d7376b5":"code","cd0ca609":"code","81c7372c":"code","3760515a":"code","30572376":"code","e8b00c2d":"code","96ae477e":"code","a7808fed":"code","ffea9e3f":"code","37a2dbd9":"code","d3bbc6af":"code","807b5aa9":"code","814a987c":"code","7bcb6e09":"code","27ce49f2":"code","8b76fb1e":"code","2229ef31":"code","bc98bbd7":"code","42f3353b":"code","979f1266":"code","305da53a":"code","1c27fb5e":"code","c470cd45":"code","5ff1a3fa":"code","433a3fdd":"code","4eaff23e":"code","1e6fdf1c":"code","be4fd629":"code","6b58ce63":"code","9b510c20":"code","31dc9a17":"code","4fad0249":"markdown","237f8314":"markdown","471bda8e":"markdown","f2f5ff21":"markdown","76f7c636":"markdown","c07fa15d":"markdown","c4656b69":"markdown"},"source":{"83cc11c6":"import pandas as pd\nimport numpy as np\nimport os\nimport seaborn as sns\nimport matplotlib.pyplot as plt","20e825d5":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","b6023dee":"df=pd.read_csv('\/kaggle\/input\/titanic\/train.csv')","70879773":"df.info()","391df4be":"df.describe()","c3eede95":"sns.heatmap(df.isnull(),yticklabels=False,cbar=False,cmap='viridis')","05e4dbfd":"corrmat=df.corr()\nplt.figure(figsize=(20, 15))\nsns.heatmap(df[corrmat.index].corr(),annot=True,cmap=\"RdYlGn\")","edd63deb":"df.drop('Cabin',axis=1,inplace=True)","0d2882bb":"df['Ticket']","848f2a5f":"plt.figure(figsize=(12, 7))\nsns.boxplot(x='Pclass',y='Age',data=df,palette='winter')","eddf2d84":"def impute_age(cols):\n    Age = cols[0]\n    Pclass = cols[1]\n    \n    if pd.isnull(Age):\n\n        if Pclass == 1:\n            return 37\n\n        elif Pclass == 2:\n            return 29\n\n        else:\n            return 24\n\n    else:\n        return Age","a34dbf76":"df['Age'] = df[['Age','Pclass']].apply(impute_age,axis=1)","e7038ac3":"df.dropna(inplace=True)","226cd152":"sns.heatmap(df.isnull(),yticklabels=False,cbar=False,cmap='viridis')","8ece9dfc":"df.info()","cacb0d1d":"pd.get_dummies(df['Embarked'],drop_first=True).head()","6d7376b5":"sex = pd.get_dummies(df['Sex'],drop_first=True)\nembark = pd.get_dummies(df['Embarked'],drop_first=True)","cd0ca609":"df.drop(['Sex','Embarked','Name','Ticket'],axis=1,inplace=True)","81c7372c":"df.head()","3760515a":"df = pd.concat([df,sex,embark],axis=1)","30572376":"df.head()","e8b00c2d":"df.drop('Survived',axis=1).head()","96ae477e":"df['Survived'].head()","a7808fed":"from sklearn.model_selection import train_test_split","ffea9e3f":"X_train, X_test, y_train, y_test = train_test_split(df.drop('Survived',axis=1), \n                                                    df['Survived'], test_size=0.1, \n                                                    random_state=101)","37a2dbd9":"from sklearn.linear_model import LogisticRegression","d3bbc6af":"logmodel = LogisticRegression()\nlogmodel.fit(X_train,y_train)","807b5aa9":"logmodel.score(X_test,y_test)","814a987c":"predictions = logmodel.predict(X_test)","7bcb6e09":"from sklearn.metrics import confusion_matrix\naccuracy=confusion_matrix(y_test,predictions)\naccuracy","27ce49f2":"from sklearn.metrics import classification_report","8b76fb1e":"print(classification_report(y_test,predictions))","2229ef31":"test=pd.read_csv(\"\/kaggle\/input\/titanic\/test.csv\")","bc98bbd7":"test","42f3353b":"sns.heatmap(test.isnull(),yticklabels=False,cbar=False,cmap='viridis')","979f1266":"test.drop(\"Cabin\",axis=1,inplace=True)","305da53a":"test['Age'] = test[['Age','Pclass']].apply(impute_age,axis=1)","1c27fb5e":"sns.heatmap(test.isnull(),yticklabels=False,cbar=False,cmap='viridis')","c470cd45":"test['Fare'].fillna(test['Fare'].median(),inplace=True)","5ff1a3fa":"sns.heatmap(test.isnull(),yticklabels=False,cbar=False,cmap='viridis')","433a3fdd":"pd.get_dummies(test['Embarked'],drop_first=True).head()\nsex = pd.get_dummies(test['Sex'],drop_first=True)\nembark = pd.get_dummies(test['Embarked'],drop_first=True)","4eaff23e":"test.drop(['Sex','Embarked','Name','Ticket'],axis=1,inplace=True)\ntest = pd.concat([test,sex,embark],axis=1)\ntest.head()","1e6fdf1c":"pred = logmodel.predict(test)","be4fd629":"pred","6b58ce63":"submit=pd.read_csv(\"\/kaggle\/input\/titanic\/gender_submission.csv\")","9b510c20":"submit[\"Survived\"]=pred","31dc9a17":"# submit.to_csv(\"\/kaggle\/input\/titanic\/gender_submission.csv\",index=False)","4fad0249":"# For testing data","237f8314":"Great! Our data is ready for our model!\n\n# Building a Logistic Regression model\n\nLet's start by splitting our data into a training set and test set (there is another test.csv file that you can play around with in case you want to use all this data for training).\n\n## Train Test Split","471bda8e":"## Converting Categorical Features \n\nWell need to convert categorical features to dummy variables using pandas! Otherwise our machine learning algorithm wont be able to directly take in those features as inputs.","f2f5ff21":"Not so bad! We might want to explore other feature engineering techniques too","76f7c636":"We can see the wealthier passengers in the higher classes tend to be older, which makes sense. We'll use these average age values to impute based on Pclass for Age.","c07fa15d":"Now lets check the heatmap again","c4656b69":"Let's move on to evaluate our model!\n\n## Evaluation\n\nWe can check precision,recall,f1-score using classification report!"}}