{"cell_type":{"95c0dd14":"code","10672ffa":"code","2491abda":"code","0117a081":"code","fa1ee010":"code","a1bc480a":"code","d73b42d5":"code","423f7f2a":"code","957b0e1c":"code","375bd7f7":"code","18a6fbab":"code","7b24e59a":"code","2051c152":"code","1d2a2fb7":"code","80fb0fa4":"code","4355cd24":"code","8d90df13":"code","f078962c":"markdown","e132b202":"markdown","f39a281b":"markdown","909138a1":"markdown","bc89354d":"markdown","5e7f0812":"markdown","ce63f4fd":"markdown","ec8b4ea2":"markdown","25d40f31":"markdown","f5fb2a99":"markdown","016ecf9c":"markdown","35eefc01":"markdown","7a35e50b":"markdown"},"source":{"95c0dd14":"#@title Import our libraries (this may take a minute or two)\nimport pandas as pd   # Great for tables (google spreadsheets, microsoft excel, csv). \nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport string\nimport nltk\nimport spacy\nimport wordcloud\nimport os # Good for navigating your computer's files \nimport sys\n\nfrom nltk.corpus import stopwords\nfrom nltk.stem import WordNetLemmatizer\nfrom nltk.corpus import stopwords\nfrom nltk.tokenize import word_tokenize\nfrom spacy.lang.en.stop_words import STOP_WORDS\nnltk.download('wordnet')\nnltk.download('punkt')\n\nfrom wordcloud import WordCloud\nimport matplotlib.pyplot as plt\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import confusion_matrix, classification_report\n!python -m spacy download en_core_web_md\nimport en_core_web_md","10672ffa":"data_file  = '..\/input\/yelp-reviews-dataset\/yelp.csv'\n","2491abda":"# read our data in using 'pd.read_csv('file')'\nyelp = pd.read_csv(data_file)","0117a081":"yelp.head()","fa1ee010":"#Remove unnecessary columns\nyelp.drop(labels=['business_id','date','review_id','type','user_id'],inplace=True,axis=1)","a1bc480a":"num_stars = 1 #@param {type:\"integer\"}\n\nfor t in yelp[yelp['stars'] == num_stars]['text'].head(20).values:\n    print (t) ","d73b42d5":"rule_1 = \"Bad\" \nrule_2 = \"Good\" \nrule_3 = \"Fine\" ","423f7f2a":"#Word cloud for differently rated reviews\nnum_stars =  2 \nthis_star_text = ''\nfor t in yelp[yelp['stars'] == num_stars]['text'].values: # form field cell\n    this_star_text += t + ' '\n    \nwordcloud = WordCloud()    \nwordcloud.generate_from_text(this_star_text)\nplt.figure(figsize=(14,7))\nplt.imshow(wordcloud, interpolation='bilinear')","957b0e1c":"example_text = \"All the people I spoke to were super nice and very welcoming.\" #@param {type:\"string\"}\ntokens = word_tokenize(example_text)\ntokens","375bd7f7":"example_word = \"ok\"\nif example_word.lower() in STOP_WORDS:\n  print (example_word + \" is a stop word.\")\nelse:\n  print (example_word + \" is NOT a stop word.\")","18a6fbab":"nlp = en_core_web_md.load()\ndoc = nlp(u\"We are running out of time! Are we though?\")\ndoc","7b24e59a":"doc = nlp(u\"We are running out of time! Are we though?\")\ntoken = doc[0] # Get the first word in the text.\nassert token.text == u\"We\" # Check that the token text is 'We'.\nassert len(token) == 2 # Check that the length of the token is 2.","2051c152":"doc = nlp(u\"I like apples\")\napples = doc[2]\n\nprint(apples.vector.shape[0]) # Each word is being represented by 96 dimensional vector embedding","1d2a2fb7":"doc = nlp(u'dog and cat')\nword1 = doc[0]\nword2 = doc[2]\nword1.similarity(word2)","80fb0fa4":"yelp = yelp[yelp.stars != 4]","4355cd24":"def is_good_review(stars):\n    if stars == 5:  ### TODO: FILL IN THE IF STATEMENT HERE ###:\n        return True\n    else:\n        return False\n\n# Change the stars field to either be 'good' or 'bad'.\nyelp['is_good_review'] = yelp['stars'].apply(is_good_review)","8d90df13":"#@title Run this to see the one-hot encoding of 'great tacos at this restaurant'\nprint('{:^5}|{:^5}|{:^4}|{:^4}|{:^10}'.format('great', 'tacos', 'at','this','restaurant'))\nprint('--------------------------------------------')\nprint('{:^5}|{:^5}|{:^4}|{:^4}|{:^10}'.format('1', '0', '0','0','0'))\nprint('{:^5}|{:^5}|{:^4}|{:^4}|{:^10}'.format('0', '1', '0','0','0'))\nprint('{:^5}|{:^5}|{:^4}|{:^4}|{:^10}'.format('0', '0', '1','0','0'))\nprint('{:^5}|{:^5}|{:^4}|{:^4}|{:^10}'.format('0', '0', '0','1','0'))\nprint('{:^5}|{:^5}|{:^4}|{:^4}|{:^10}'.format('0', '0', '0','0','1'))","f078962c":"The text column is the one we are primarily focused with. Let's take a look at a few of these reviews to better understand our problem.","e132b202":"The word 'Apple' is represented by a 300 dimensional vector embedding\n","f39a281b":"#### Next Few Steps that can be tried:\n- Bag of words, Logistic Regression","909138a1":"## Text Preprocessing","bc89354d":"Run the cell below to get rid of 4 star reviews.","5e7f0812":"#### Stopwords\n\nWe can see that certain particular words might be associated with 4 or 5 star reviews, and some words would be associated with 1 or 2 star reviews. However, at the same time, there are some words that do not really possess any relevant information for our current problem. In the field of NLP there is a concept of words that are \"stopwords\" - words that exist to provide grammatical structure, but do not convey information about the particular subject. Edit the cell below to see if a given word is a stop word.","ce63f4fd":"## One-Hot Vectors\n","ec8b4ea2":"## Data Exploration","25d40f31":"#### World Cloud visualization is a good indication for the frequency with which words were used in each review for better analysis.","f5fb2a99":"#### Tokenization\n\nFirst of all, we would like to convert each review from a single string into a list of words (this is a process known as tokenizaton). All NLP algorithms require a list of words as arguments and not actual sentences. Enter some example text into the cell below to see the tokenized version.","016ecf9c":"First we read in the file containing the reviews and take a look at the data available to us.","35eefc01":"# Introduction to Yelp Review Sentiment Classification\n\nIn this project, we will build a classifier that can predict a user's rating of a given restaurant from their review. Nowadays, sentiment analysis is used widely by companies in order to better understand their user's preferences and tastes.\n\n\n","7a35e50b":"We can start to see that there are certain quantitative differences between highly rated reviews and poorly rated reviews. Certain words, for example, 'delightful', 'impressive', 'amazing', might be more associated with 4 or 5 star reviews. However one might be able to see that these words might also be present in a 2 star review. For example: \"The seating and ambience were impressive, but the food served to us was not\". \n"}}