{"cell_type":{"3c31baee":"code","1daa10b7":"code","a70e7775":"code","b9031330":"code","5651bf7c":"code","0f39e196":"code","e23172d0":"code","2ae4263c":"code","7c112d95":"code","01a38f9b":"code","ccedb2a1":"code","68f08928":"code","044c77ae":"code","64acf7e2":"markdown","b03fc5eb":"markdown","12b675ee":"markdown","3aa67ac2":"markdown","cd997bbe":"markdown"},"source":{"3c31baee":"from fastai.vision.all import *\nimport ast\nfrom PIL.ImageDraw import Draw","1daa10b7":"input_path = Path('\/kaggle\/input\/tensorflow-great-barrier-reef')\ninput_path.ls()","a70e7775":"train_df = pd.read_csv(input_path\/'train.csv')\ntrain_df.head()","b9031330":"train_df.video_id.unique()","5651bf7c":"train_df.annotations.map(len).value_counts()","0f39e196":"18582\/train_df.shape[0]","e23172d0":"train_df[train_df.annotations.map(len) > 100].iloc[0]","2ae4263c":"img = Image.open((input_path\/'train_images\/video_0\/57.jpg'))\nimg","7c112d95":"annotations = train_df[train_df.annotations.map(len) > 100].iloc[0].annotations\nannotations","01a38f9b":"def get_bboxes(annotations):\n    annots = ast.literal_eval(annotations)\n    bboxes = []\n    for annotation in annots:\n        x, y = annotation['x'], annotation['y']\n        w, h = annotation['width'], annotation['height']\n        bboxes.append([x,y, x+w, y+h])\n    return bboxes","ccedb2a1":"bboxes = get_bboxes(annotations)\nbboxes","68f08928":"def draw_bboxes(img, bboxes):\n    draw = Draw(img)\n    for bbox in bboxes:\n        draw.rectangle(bbox, outline='red')\n    return img","044c77ae":"draw_bboxes(img, bboxes)","64acf7e2":"What are Crown-of-thorns starfish? https:\/\/en.wikipedia.org\/wiki\/Crown-of-thorns_starfish","b03fc5eb":"80% of the images do not have a starfish!","12b675ee":"There are only three videos in our dataset -- each video has a certaain number of frames (images)","3aa67ac2":"There are two starfish in this frame, let's add the bounding boxes","cd997bbe":"Both starfish appropriately drawn in the image!"}}