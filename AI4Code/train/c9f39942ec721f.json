{"cell_type":{"28c0aff1":"code","d9a6189c":"code","a1bbef5f":"code","361796af":"code","51220a1c":"code","880e1c72":"code","c0d2d8ef":"code","639a894e":"code","a6a4c0b4":"code","9f02fca0":"code","3a14ae23":"code","0cf02f4c":"code","66978b8a":"code","0394dae5":"code","9b65a5fc":"code","c42bd839":"code","31649d4e":"code","65d2ed04":"code","76b28d9d":"code","54e83446":"code","4fe6ff71":"code","35098eb6":"code","4cb4dc5f":"code","17416cdd":"code","94536355":"markdown","d6fe2779":"markdown"},"source":{"28c0aff1":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","d9a6189c":"data=pd.read_csv(\"..\/input\/heart-failure-prediction\/heart.csv\")\ndata.head()","a1bbef5f":"data.isnull().sum()","361796af":"for i in data.columns:\n    print(i,\" :  \",data[i].unique())\n","51220a1c":"#So data is all clear\n#convert  categorical to numerical","880e1c72":"data.loc[data['Sex']==\"M\",'Sex']=0\ndata.loc[data['Sex']=='F','Sex']=1\n\ndata.loc[data['ChestPainType']=='TA','ChestPainType']=0\ndata.loc[data['ChestPainType']=='ATA','ChestPainType']=1\ndata.loc[data['ChestPainType']=='NAP','ChestPainType']=2\ndata.loc[data['ChestPainType']=='ASY','ChestPainType']=3\n\ndata.loc[data['RestingECG']=='ST','RestingECG']=0\ndata.loc[data['RestingECG']=='Normal','RestingECG']=1\ndata.loc[data['RestingECG']=='LVH','RestingECG']=2\n\ndata.loc[data['ExerciseAngina']=='N','ExerciseAngina']=0\ndata.loc[data['ExerciseAngina']=='Y','ExerciseAngina']=1\n\ndata.loc[data['ST_Slope']=='Down','ST_Slope']=1\ndata.loc[data['ST_Slope']=='Flat','ST_Slope']=2\ndata.loc[data['ST_Slope']=='Up','ST_Slope']=3","c0d2d8ef":"data.head()","639a894e":"data['Sex']=data['Sex'].astype(int)\ndata['RestingECG']=data['RestingECG'].astype(int)\ndata['ST_Slope']=data['ST_Slope'].astype(int)\ndata['ChestPainType']=data['ChestPainType'].astype(int)\ndata['ExerciseAngina']=data['ExerciseAngina'].astype(int)","a6a4c0b4":"data.dtypes","9f02fca0":"data.corr()['HeartDisease']","3a14ae23":"X=data.drop(['HeartDisease','RestingECG','RestingBP'],axis=1)\ny=data['HeartDisease']","0cf02f4c":"from sklearn.model_selection import train_test_split","66978b8a":"X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.20,random_state=40)","0394dae5":"X_train.shape","9b65a5fc":"y_test.shape","c42bd839":"from sklearn.ensemble import RandomForestClassifier","31649d4e":"rfc=RandomForestClassifier(max_depth=8,n_estimators=150)","65d2ed04":"rfc.fit(X_train,y_train)\npred2=rfc.predict(X_test)","76b28d9d":"from sklearn.metrics import accuracy_score","54e83446":"accuracy_score(pred2,y_test)","4fe6ff71":"import xgboost as xgb","35098eb6":"xg=xgb.XGBClassifier(colsample_bytree=0.43,learning_rate=0.0005,max_depth=8,n_estimators=250)","4cb4dc5f":"xg.fit(X_train,y_train)\npred1=xg.predict(X_test)","17416cdd":"accuracy_score(pred1,y_test)","94536355":"# heart failure prediction with 90%","d6fe2779":"Age: age of the patient [years] <br>\nSex: sex of the patient [M: Male, F: Female] <br>\nChestPainType: chest pain type [TA: Typical Angina, ATA: Atypical Angina, NAP: Non-Anginal Pain, ASY: Asymptomatic] <br>\nRestingBP: resting blood pressure [mm Hg]<br>\nCholesterol: serum cholesterol [mm\/dl]<br>\nFastingBS: fasting blood sugar [1: if FastingBS > 120 mg\/dl, 0: otherwise] <br>\nRestingECG: resting electrocardiogram results [Normal: Normal, ST: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV), LVH: showing probable or definite left ventricular hypertrophy by Estes' criteria] <br>\nMaxHR: maximum heart rate achieved [Numeric value between 60 and 202] <br>\nExerciseAngina: exercise-induced angina [Y: Yes, N: No] <br>\nOldpeak: oldpeak = ST [Numeric value measured in depression]<br>\nST_Slope: the slope of the peak exercise ST segment [Up: upsloping, Flat: flat, Down: downsloping] <br>\nHeartDisease: output class [1: heart disease, 0: Normal] <br>"}}