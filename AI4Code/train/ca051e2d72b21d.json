{"cell_type":{"65734edf":"code","8e2bff60":"code","2d600ab7":"code","d39abddc":"code","b980c743":"code","5d8ccc6f":"code","28b9ba39":"code","496ce741":"code","3a7234ba":"code","7312e2d9":"code","b7018e78":"code","9d137954":"code","135284fd":"code","75ad4fc7":"code","03fcfa87":"code","b149560f":"code","616ffabc":"markdown","d0e301e1":"markdown","adc050a6":"markdown","a1514854":"markdown","e4bbd223":"markdown","e788e120":"markdown","e0596b75":"markdown","6ccd5a2a":"markdown","86971e0f":"markdown","a9c7720d":"markdown","f938f02f":"markdown","363ed3a7":"markdown","5fde92e3":"markdown","9017d94e":"markdown","a946b577":"markdown","8471effb":"markdown","d6ad7b24":"markdown","afc237f1":"markdown","bbd3e4d2":"markdown","8141c40f":"markdown","7ad64187":"markdown","2c7bb205":"markdown","44604b7e":"markdown"},"source":{"65734edf":"%matplotlib inline\nimport matplotlib\nimport matplotlib.pyplot as plt\nimport pandas as pd\n\nfrom scipy import stats\nimport numpy as np  \nimport scipy as sp\n\n\ndf_train = pd.read_csv('..\/input\/lab3_train_no_nulls_no_outliers.csv')\ndf_train.head(2)","8e2bff60":"df_train.describe()","2d600ab7":"tarifa_homens = df_train[df_train['Sex']=='male']['Fare'].values\ntarifa_mulheres = df_train[df_train['Sex']=='female']['Fare'].values","d39abddc":"print('qtd. homens: ', tarifa_homens.shape[0])\nprint('qtd. mulheres: ', tarifa_mulheres.shape[0])\n\nprint('m\u00e9dia de tarifa homens: ', np.mean(tarifa_homens))\nprint('m\u00e9dia de tarifa mulhers: ', np.mean(tarifa_mulheres))\n\n##Visualizando as distribui\u00e7\u00f5es\nfig, (ax0, ax1) = plt.subplots(ncols=2, figsize=(10, 4))\n\nax0.hist(tarifa_homens)\nax0.set_title('Tarifas Homens')\n\nax1.hist(tarifa_mulheres)\nax1.set_title('Tarifas Mulheres')","b980c743":"plt.boxplot([tarifa_homens, tarifa_mulheres], showmeans=True)\nplt.show()","5d8ccc6f":"print(\"p-value da hip\u00f3tese das tarifas dos homens serem normalmente distribuidos \", stats.normaltest(tarifa_homens)[1])\nprint(\"p-value da hip\u00f3tese das tarifas das mulheres serem normalmente distribuidos \", stats.normaltest(tarifa_mulheres)[1])","28b9ba39":"def intervalo_conf(dados, significancia=0.95):\n    a = 1.0*np.array(dados)\n    n = len(a)\n    m, se = np.mean(a), stats.sem(a)\n    h = se * stats.t.ppf((1+significancia)\/2., n-1)\n    return m-h, m+h","496ce741":"print(\"Intervalo de confian\u00e7a com 95% da tarifa dos homens = \", intervalo_conf(tarifa_homens))\nprint(\"Intervalo de confian\u00e7a com 95% da tarifa das mulheres = \", intervalo_conf(tarifa_mulheres))","3a7234ba":"z_stat, p_val = stats.mannwhitneyu(tarifa_homens, tarifa_mulheres)  \nprint(\"O p-value do teste Mann-Whitney-Wilcoxon entre os Dados = \", p_val)","7312e2d9":"idade_homens = df_train[df_train['Sex']=='male']['Age'].values\nidade_mulheres = df_train[df_train['Sex']=='female']['Age'].values","b7018e78":"print('m\u00e9dia de idade homens: ', np.mean(idade_homens))\nprint('m\u00e9dia de idade mulhers: ', np.mean(idade_mulheres))\n\n##Visualizando as distribui\u00e7\u00f5es\nfig, (ax0, ax1) = plt.subplots(ncols=2, figsize=(10, 4))\n\nax0.hist(idade_homens)\nax0.set_title('Idades Homens')\n\nax1.hist(idade_mulheres)\nax1.set_title('Idades Mulheres')","9d137954":"print(\"p-value da hip\u00f3tese das idades dos homens serem normalmente distribuidos \", stats.normaltest(idade_homens)[1])\nprint(\"p-value da hip\u00f3tese das idades das mulheres serem normalmente distribuidos \", stats.normaltest(idade_mulheres)[1])","135284fd":"def intervalo_conf_z(dados, significancia=0.05):\n    a = 1.0*np.array(dados)\n    n = len(a)\n    m, sd = np.mean(a), np.std(a)\n    h = -stats.norm.ppf(q=significancia) * (sd\/((n-1)**0.5))\n    return m-h, m+h","75ad4fc7":"print(\"Intervalo de confian\u00e7a com 95% da tarifa dos homens = \", intervalo_conf(idade_homens))\nprint(\"Intervalo de confian\u00e7a com 95% da tarifa das mulheres = \", intervalo_conf_z(idade_mulheres))","03fcfa87":"z_stat, p_val = stats.mannwhitneyu(idade_homens, idade_mulheres)  \nprint(\"O p-value do teste Mann-Whitney-Wilcoxon entre os Dados = \", p_val )","b149560f":"idade_classe1 = df_train[df_train['Pclass']==1]['Age'].values\nidade_classe2 = df_train[df_train['Pclass']==2]['Age'].values\nidade_classe3 = df_train[df_train['Pclass']==3]['Age'].values","616ffabc":"**Qual seria o intervalo de confian\u00e7a se a tabela Z fosse usada?**  \n**A diferen\u00e7a \u00e9 significativa?**","d0e301e1":"[](http:\/\/)Pelos resultados, conclu\u00edmos que as idades dos homens n\u00e3o \u00e9 bem aproximada por uma normal. J\u00e1 n\u00e3o podemos afirmar o mesmo sobre as idades das mulheres.\n\nAbaixo reescrevemos a fun\u00e7\u00e3o que c[](http:\/\/)alcula o intervalo de confian\u00e7a para usar a tabela Z em vez da T.","adc050a6":"## 1 - Comparando dados","a1514854":"# Laborat\u00f3rio - Sobreviventes do Titanic - Introdu\u00e7\u00e3o \u00e0 Estat\u00edstica\n\nNesse laborat\u00f3rio aprenderemos a calcular as principais medidas de estat\u00edstica descritiva e alguns m\u00e9todos de estat\u00edstica inferencial como intervalos de confian\u00e7a, testes de normalidade, de hip\u00f3tese e testes n\u00e3o-param\u00e9tricos. Tudo isso usando como pano de fundo nosso estudo de caso dos sobreviventes do Titanic.","e4bbd223":"### 1.2 - Comparando a m\u00e9dia de idade\n\nNessa parte do laborat\u00f3rio, vamos seguir o mesmo racioc\u00ednio usado acima para verificar se a m\u00e9dia de idade de homens e mulheres \u00e9 diferente.","e788e120":"Algumas estat\u00edsticas b\u00e1sicas.","e0596b75":"O valor das m\u00e9dias sugere que as mulheres pagaram valores maiores, em m\u00e9dia, que os homens. Mas para confirmar isso, precisamos fazer alguns testes. Primeiro, vamos calcular o intervalo de confian\u00e7a. Para saber qual m\u00e9todo usar, primeiro precisamos saber se a distribui\u00e7\u00e3o normal \u00e9 um bom modelo para o dado coletado. Usaremos o m\u00e9todo <a href=\"http:\/\/docs.scipy.org\/doc\/scipy\/reference\/generated\/scipy.stats.normaltest.html\">scipy.stats.normaltest<\/a>.\n\nTrata-se de um *teste de hip\u00f3tese* onde a **hip\u00f3tese nula (H0)** \u00e9 de que as amostras v\u00eam de uma distribui\u00e7\u00e3o normal.  \nVamos estabelecer um **n\u00edvel de confian\u00e7a** de 95% para esse teste.","6ccd5a2a":"A fun\u00e7\u00e3o criada abaixo calcula os intervalos de confian\u00e7a usando a tabela T.","86971e0f":"Para exercitar os conceitos de estat\u00edstica apresentados no curso, usaremos o nosso estudo de caso de Sobreviventes do Titanic. Usualmente, o que queremos fazer, \u00e9 saber se alguma medida (m\u00e9dia, propor\u00e7\u00e3o, mediana, etc) de um conjunto de dados \u00e9 significativamente diferente do outro, pois s\u00f3 comparar as medidas n\u00e3o fornece evid\u00eancia suficiente. Para exemplificar, se queremos saber se a m\u00e9dia de altura das pessoas do EDIHB \u00e9 maior ou menor que a m\u00e9dia de altura das pessoas do EDISEN e medimos apenas 5 pessoas em cada pr\u00e9dio, provavelmente n\u00e3o teremos evid\u00eancia suficiente para afirmar que as pessoas de um pr\u00e9dio s\u00e3o maiores\/menores que no outro.\n\nPara termos evid\u00eancias de que uma medida \u00e9 diferente da outra, podemos calcular um <b>intervalo de confian\u00e7a<\/b> e para isso, \u00e9 interessante saber se a distribui\u00e7\u00e3o dos dados pode ser bem aproximada por uma distribui\u00e7\u00e3o normal (gaussiana), al\u00e9m da quantidade de amostras que temos. Quando temos menos de 30 amostras e nossos dados n\u00e3o s\u00e3o bem aproximados por uma normal, somos obrigados a fazer testes n\u00e3o param\u00e9tricos. \n\nVamos utilizar um **teste de hip\u00f3teses** para investigar se o dado coletado est\u00e1 adequado ao modelo normal.","a9c7720d":"Pelos resultados, podemos ver que os intervalos de confian\u00e7a n\u00e3o se sobrep\u00f5em. Logo, temos evid\u00eancias estat\u00edsticas de que as m\u00e9dias devem ser diferentes.\n\nPara buscar mais evid\u00eancias podemos considerar a realiza\u00e7\u00e3o de um novo teste de hip\u00f3teses, como:\n\n* <a href=\"http:\/\/docs.scipy.org\/doc\/scipy\/reference\/generated\/scipy.stats.f_oneway.html\">1-way ANOVA<\/a>, para dados normalmente distribu\u00eddos\n* Teste n\u00e3o param\u00e9tricos, como <a href=\"http:\/\/docs.scipy.org\/doc\/scipy\/reference\/generated\/scipy.stats.mannwhitneyu.html\">Mann-Whitney<\/a>, para outros dados.\n\nAmbos os testes tem como hip\u00f3tese nula algo similar \u00e0 ideia de que as m\u00e9dias das duas popula\u00e7\u00f5es s\u00e3o iguais.  \n\nPelo P-value, rejeitamos ou n\u00e3o essa hip\u00f3tese. Caso p-value < 5%, rejeitamos a hip\u00f3tese nula e refor\u00e7amos as evid\u00eancias de que as m\u00e9dias s\u00e3o diferentes. Caso contr\u00e1rio, quando p-value > 5%, n\u00e3o podemos rejeitar, com 95% de confian\u00e7a, a hip\u00f3tese nula e pode ser que as m\u00e9dias sejam iguais.\n\nNo primeiro teste, a hip\u00f3tese nula tamb\u00e9m espera que a distribui\u00e7\u00e3o das popula\u00e7\u00f5es seja normal. Portanto, n\u00e3o \u00e9 adequado para a situa\u00e7\u00e3o que estamos e usaremos o segundo.","f938f02f":"**Olhando a documenta\u00e7\u00e3o das [fun\u00e7\u00f5es de estat\u00edstica no scipy](https:\/\/docs.scipy.org\/doc\/scipy\/reference\/stats.html), voc\u00ea encontra outro teste estat\u00edstico que compare medidas de centralidade entre duas popula\u00e7\u00f5es? Qual seriam suas vantagens e desvantagens?**","363ed3a7":"Alguma estat\u00edstica b\u00e1sica","5fde92e3":"**Por que nem todas as colunas aparecem?**  \n**Olhando a documenta\u00e7\u00e3o do m\u00e9todo, existe alguma forma de considerar todas as colunas?**  \n**Alguma inconsist\u00eancia surge ao incluir outras colunas?**","9017d94e":"Pelos histogramas, os dados parecem com uma distribui\u00e7\u00e3o normal. Vamos verificar.","a946b577":"## 0 - Estat\u00edsticas Descritivas\n\nUma forma pr\u00e1tica de obter diversas estat\u00edsticas descritivas \u00e9 usando o m\u00e9todo describe() do DataFrame pandas.","8471effb":"## 2 - Sua vez\n\nAgora \u00e9 a sua vez de tirar conclus\u00f5es. Escolha dois conjuntos para comparar. Como sugest\u00e3o, compare a idade entre passageiros de diferentes classes:","d6ad7b24":"Novamente os intervalos n\u00e3o est\u00e3o sobrepostos, mas vamos realizar mais um teste.","afc237f1":"Como P-value < 0,05, n\u00f3s rejeitamos a hip\u00f3tese nula e finalmente conclu\u00edmos que as m\u00e9dias de valor de tarifa pagas por homens e mulheres s\u00e3o efetivamente diferentes com 95% de confian\u00e7a.","bbd3e4d2":"novamente podemos afirmar que as m\u00e9dias s\u00e3o diferentes com 95% de confian\u00e7a, pois o p-value < 0,05. Mas veja que nesse caso, o valor \u00e9 bem mais pr\u00f3ximo. Se desej\u00e1ssemos uma confian\u00e7a de 99%, j\u00e1 n\u00e3o poder\u00edamos afirmar que as m\u00e9dias s\u00e3o diferentes, pois o p-value n\u00e3o seria menor que 0,01","8141c40f":"O Valor de P (p-value) retornado pela fun\u00e7\u00e3o nos diz a pot\u00eancia do teste. [](http:\/\/)  \nO valor-p pode ser interpretado como a probabilidade de observar os dados coletados **se a hip\u00f3tese nula fosse verdadeira**.  \nComo P < 0.05, podemos **rejeitar a hip\u00f3tese nula**, j\u00e1 que seria bastante improv\u00e1vel que uma normal gerasse tais dados.\n> \nNo caso contr\u00e1rio, se P >= 0.05, n\u00e3o poder\u00edamos rejeitar a hip\u00f3tese nula. \n\nComo evidenciado nos pr\u00f3prios histogramas, ambas as distribui\u00e7\u00f5es n\u00e3o s\u00e3o normais e, com isso, teremos de usar a tabela T (distribui\u00e7\u00e3o t-Student) em vez da tabela Z (distribui\u00e7\u00e3o normal) para calcular os intervalos de confian\u00e7a.","7ad64187":"Box Plot das distribui\u00e7\u00f5es","2c7bb205":"Utilize as c\u00e9lulas abaixo e as fun\u00e7\u00f5es usadas anteriormente e fa\u00e7a compara\u00e7\u00f5es.","44604b7e":"### 1.1 - Comparando valor das tarifas\n\nNessa parte do laborat\u00f3rio, queremos descobrir se o valor da tarifa pago por homens e mulheres s\u00e3o diferentes. Primeiro, extraimos os dados"}}