{"cell_type":{"697edbcb":"code","6e03caea":"code","2a57670c":"code","b8a3c362":"code","6ef4c507":"code","03b815a2":"code","46fa7e27":"code","0b44754b":"code","b1978648":"code","e8e33bd4":"code","c64586d5":"code","896792fe":"code","6f40e30f":"code","d1b8c5e9":"code","45ef32c2":"code","9c1e2293":"code","0a3ef82e":"code","2c3e8f26":"code","0e36c11c":"code","bcfb0dfa":"code","3d587600":"code","fbc8a0fe":"code","9d071248":"code","457c0472":"code","b440a646":"code","192ce226":"code","69c7e619":"code","e2d62ceb":"code","39c8eee0":"code","c55af848":"code","c99bc2cb":"code","f59e6fb9":"code","53e6e08b":"code","a830ede0":"code","2ed6a879":"code","4a4aa414":"code","ea4b5ac9":"code","5073f941":"code","7e1f410b":"code","3f2acf18":"code","1fe8da96":"code","03d83ccc":"code","ea193ab2":"code","853faf62":"code","d3e74f1f":"code","754a16bb":"code","23817820":"code","eb42f81b":"code","57e3b49d":"code","4a8e070b":"code","68de5b44":"code","8f624591":"code","b830b5aa":"code","b7cd4059":"code","a7c46a08":"code","fffef736":"code","b94f6026":"code","5f1b85b3":"code","bb21a6fa":"code","6d90f470":"code","9799f1b1":"code","be1273e8":"code","6a92614b":"code","1d3b4311":"code","e1fe1192":"code","28219894":"code","63a05ea7":"code","701332f4":"code","e02fd658":"code","9250c69c":"code","0ca0b361":"code","ff90bd7d":"code","e6d9eb43":"code","9a24adaf":"markdown","e21c0a86":"markdown","175435aa":"markdown","fafb9feb":"markdown","755b2dbd":"markdown","9f77896a":"markdown","76dd14ca":"markdown","2783754a":"markdown","bc390120":"markdown","319ba188":"markdown","f2747c33":"markdown","a4429875":"markdown","b3eac53c":"markdown","05e27906":"markdown","b516ffc6":"markdown","efc4af76":"markdown","2f074ca2":"markdown","65a22e6a":"markdown","9407e0f8":"markdown","0632ce94":"markdown","e2cf39af":"markdown","32752135":"markdown","93922d98":"markdown","c90454a1":"markdown","3009ca62":"markdown","dbf2d566":"markdown","83b3eea2":"markdown","7c468648":"markdown","b58889e4":"markdown","5a2c4d0e":"markdown","641cca8f":"markdown","a5c309cd":"markdown","2b737cdc":"markdown","7b5a2930":"markdown"},"source":{"697edbcb":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')\nimport matplotlib.lines as lines\nfrom IPython.display import HTML\nimport dateutil.parser as dt_parse\nfrom scipy import stats\nfrom scipy.special import inv_boxcox\n\nfrom sklearn.linear_model import LinearRegression, Lasso, Ridge, ElasticNet\nfrom sklearn.model_selection import cross_val_score, train_test_split, GridSearchCV\nfrom xgboost import XGBRegressor","6e03caea":"#Visualization settings\nsns.set_style(style='white')\nsns.set(rc={\n    'figure.figsize': (12,7),\n    'axes.facecolor': 'white',\n    'axes.grid': True,\n    'grid.color': '.9',\n    'axes.linewidth': 1.0,\n    'grid.linestyle': u'-'},\n    font_scale=1.5)\ncustom_colors=[\"#3498db\", \"#95a5a6\",\"#34495e\", \"#2ecc71\", \"#e74c3c\"]\nsns.set_palette(custom_colors)\nbackground_color='#fbfbfb'","2a57670c":"# Load input data file\ndf_input = pd.read_csv('..\/input\/productivity-prediction-of-garment-employees\/garments_worker_productivity.csv')","b8a3c362":"print (f\"Shape of dataframe : {df_input.shape}\\n\")\nprint (f\"Sample data frame:\\n\")\ndisplay(df_input.head())\nprint (\"Dataset summary \\n\")\ndisplay (df_input.info())","6ef4c507":"# Missing values\nmissing_val= df_input.isnull().sum()\nmissing_val.sort_values(inplace=True, ascending=False)\nprint (\"Missing value counts:\\n\")\ndisplay (missing_val)","03b815a2":"#Discrete feature analysis\ndef analyze_discrete_feature(fld,display_graph=True):\n    print (\"Sample data:\\n\")\n    display(fld.head())\n    df=pd.DataFrame({\"Value\": fld.value_counts().index,\n                 \"Count\":fld.value_counts().values})\n    print (\"\\nNull value count : \", fld.isnull().sum())\n    unique_list=fld.unique().tolist()\n    print (\"\\nUnique values: \", unique_list)\n    print (\"\\n Unique values count: \", len(unique_list))\n    print (\"\\nValue counts:\\n\",    df)\n    if display_graph==True:\n        plt.subplots(figsize=(25,10),facecolor=background_color)\n        plt.subplot(2,2,1)\n        plt.pie(fld.value_counts(),labels=fld.value_counts().index,autopct=lambda x: f'{x: .2f}%');\n        plt.xticks(rotation=90)\n\n        plt.subplot(2,2,2)   \n        sns.barplot(data=df, x=\"Value\",y=\"Count\").set_facecolor(background_color);\n        plt.xticks(rotation=90);\n        plt.suptitle(fld.name + \" -distribution\");\n\n        plt.show()\n        plt.close()\n    display(HTML(\"<h4 style='background-color:#fbfbfb;font-family:serif;font-size:160%'>Discrete variable<\/h4>\"))\n","46fa7e27":"#Continuous feature analysis\ndef analyze_continuous_feature(fld):\n    print (\"Sample data:\\n\",fld.head())\n    print (\"\\nNull value count : \", fld.isnull().sum())\n    print (\"\\n\", fld.describe())\n    print (f\"\\n Skewness : {fld.skew()} \\n\")\n    plt.subplots(figsize=(25,10))\n    plt.subplot(2,2,1)\n    plt.hist(fld)\n    plt.subplot(2,2,2)\n    sns.boxplot(fld)\n    plt.suptitle(fld.name + \"-distribution\")\n    plt.show()\n    plt.close()\n    display(HTML(\"<h4 style='background-color:#fbfbfb;font-family:serif;font-size:160%'>Continuous variable<\/h4>\"))","0b44754b":"df_input.date","b1978648":"analyze_discrete_feature(df_input.day)","e8e33bd4":"analyze_discrete_feature(df_input.quarter)","c64586d5":"# Found that there are whitespaces in the department column.\n# Trimming the white spaces\ndf_input['department'] = df_input['department'].apply(str.strip)","896792fe":"analyze_discrete_feature(df_input.department)","6f40e30f":"analyze_discrete_feature(df_input.team)","d1b8c5e9":"analyze_continuous_feature(df_input.no_of_workers)","45ef32c2":"analyze_continuous_feature(df_input.no_of_style_change)","9c1e2293":"analyze_continuous_feature(df_input.targeted_productivity)","0a3ef82e":"analyze_continuous_feature(df_input.smv)","2c3e8f26":"analyze_continuous_feature(df_input.wip)","0e36c11c":"analyze_continuous_feature(df_input.over_time)","bcfb0dfa":"analyze_continuous_feature(df_input.incentive)","3d587600":"analyze_continuous_feature(df_input.idle_time)","fbc8a0fe":"analyze_continuous_feature(df_input.idle_men)","9d071248":"analyze_continuous_feature(df_input.actual_productivity)","457c0472":"#Change the string formatted date column to datetime object\ndf_input['date_dt'] = df_input['date'].apply(lambda x : dt_parse.parse(x))\n\ndf_input['date'] = df_input.date_dt.apply(lambda x : x.day)\ndf_input['month'] = df_input.date_dt.apply(lambda x : x.month)\ndf_input['year'] = df_input.date_dt.apply(lambda x : x.year)\n\n# Remove the existing date feature\ndf_input.drop('date_dt',axis=1, inplace=True)\n\nprint (f'years:{df_input.year.unique()}')\nprint (f'months:{df_input.month.unique()}')","b440a646":"df_input","192ce226":"summary=df_input.groupby('department').agg('sum')['actual_productivity']","69c7e619":"#print (summary)\n#summary.to_frame().plot.bar()","e2d62ceb":"summary = summary.to_frame()\ndisplay (summary)","39c8eee0":"sns.reset_defaults()\n\n#Visualization\nfig=plt.figure(figsize=(10,5));\n\nax0=fig.add_subplot(1,2,1)\nax1=fig.add_subplot(1,2,2)\nax1.grid(False)\nax1.set_xticklabels([])\nax1.set_yticklabels([])\n\nfig.patch.set_facecolor(background_color)\nax0.set_facecolor(background_color)\nax1.set_facecolor(background_color)\nax0.spines[\"bottom\"].set_visible(False)\nax0.spines[\"top\"].set_visible(False)\nax0.spines[\"right\"].set_visible(False)\nax0.spines[\"left\"].set_visible(False)\nax1.spines[\"bottom\"].set_visible(False)\nax1.spines[\"top\"].set_visible(False)\nax1.spines[\"right\"].set_visible(False)\nax1.spines[\"left\"].set_visible(False)\nax1.tick_params(left=False,bottom=False)\n\n#Plot the barplot\nsns.barplot(data=summary,x=summary.index,y=summary.actual_productivity,ax=ax0)\n\n#rotating the ticklabels in x axis\nfor tick in ax0.get_xticklabels():\n    tick.set_rotation(90)\n    \n#Draw line in the middle    \nl1= lines.Line2D([0.52,0.52],[0.1, 0.9],color='black',lw=0.2,transform=fig.transFigure)\nfig.lines.extend([l1])\n\n#heading content\nfig.text(x=0.5,\n        y=0.6,\n        fontweight='bold',\n        fontfamily='serif',\n        fontsize=17,\n        color='grey',\n        s='''\n        Total productivity per department\n        ''')\n#text content\nfig.text(x=0.5,\n        y=0.4,\n        fontweight='light',\n        fontfamily='serif',\n        fontsize=16,\n        color='grey',\n        s='''\n        Sweing department having more productivity\n        ''')\nplt.show()","c55af848":"sns.reset_defaults()\n\n#Visualization\nfig=plt.figure(figsize=(10,5));\n\nax0=fig.add_subplot(1,2,1)\nax1=fig.add_subplot(1,2,2)\nax1.grid(False)\nax1.set_xticklabels([])\nax1.set_yticklabels([])\n\nfig.patch.set_facecolor(background_color)\nax0.set_facecolor(background_color)\nax1.set_facecolor(background_color)\nax0.spines[\"bottom\"].set_visible(False)\nax0.spines[\"top\"].set_visible(False)\nax0.spines[\"right\"].set_visible(False)\nax0.spines[\"left\"].set_visible(False)\nax1.spines[\"bottom\"].set_visible(False)\nax1.spines[\"top\"].set_visible(False)\nax1.spines[\"right\"].set_visible(False)\nax1.spines[\"left\"].set_visible(False)\nax1.tick_params(left=False,bottom=False)\n\n#Plot the barplot\nsns.lineplot(data=df_input, x = 'incentive', y='actual_productivity',estimator=None,ax=ax0)\n\n#rotating the ticklabels in x axis\nfor tick in ax0.get_xticklabels():\n    tick.set_rotation(90)\n    \n#Draw line in the middle    \nl1= lines.Line2D([0.52,0.52],[0.1, 0.9],color='black',lw=0.2,transform=fig.transFigure)\nfig.lines.extend([l1])\n\n#heading content\nfig.text(x=0.5,\n        y=0.6,\n        fontweight='bold',\n        fontfamily='serif',\n        fontsize=17,\n        color='grey',\n        s='''\n        Actual productivity and Incentives\n        ''')\n#text content\nfig.text(x=0.5,\n        y=0.4,\n        fontweight='light',\n        fontfamily='serif',\n        fontsize=16,\n        color='grey',\n        s='''\n        There is not much relationship between Actual productivity \n        and amount of incentives workers got.\n        ''')\nplt.show()","c99bc2cb":"sns.reset_defaults()\n\n#Visualization\nfig=plt.figure(figsize=(10,5));\n\nax0=fig.add_subplot(1,2,1)\nax1=fig.add_subplot(1,2,2)\nax1.grid(False)\nax1.set_xticklabels([])\nax1.set_yticklabels([])\n\nfig.patch.set_facecolor(background_color)\nax0.set_facecolor(background_color)\nax1.set_facecolor(background_color)\nax0.spines[\"bottom\"].set_visible(False)\nax0.spines[\"top\"].set_visible(False)\nax0.spines[\"right\"].set_visible(False)\nax0.spines[\"left\"].set_visible(False)\nax1.spines[\"bottom\"].set_visible(False)\nax1.spines[\"top\"].set_visible(False)\nax1.spines[\"right\"].set_visible(False)\nax1.spines[\"left\"].set_visible(False)\nax1.tick_params(left=False,bottom=False)\n\n#Plot the barplot\nsns.lineplot(data=df_input,x = 'incentive', y='over_time',estimator=None,ax=ax0)\n\n#rotating the ticklabels in x axis\nfor tick in ax0.get_xticklabels():\n    tick.set_rotation(90)\n    \n#Draw line in the middle    \nl1= lines.Line2D([0.52,0.52],[0.1, 0.9],color='black',lw=0.2,transform=fig.transFigure)\nfig.lines.extend([l1])\n\n#heading content\nfig.text(x=0.5,\n        y=0.6,\n        fontweight='bold',\n        fontfamily='serif',\n        fontsize=17,\n        color='grey',\n        s='''\n        Overtime and Incentives\n        ''')\n#text content\nfig.text(x=0.5,\n        y=0.4,\n        fontweight='light',\n        fontfamily='serif',\n        fontsize=16,\n        color='grey',\n        s='''\n        Not able to find a relation between Overtime\n        and amount of incentives workers got.\n        ''')\nplt.show()","f59e6fb9":"df_input","53e6e08b":"df_input.month.unique()","a830ede0":"df = df_input.groupby('month').agg({'targeted_productivity':'mean','actual_productivity':'mean'})","2ed6a879":"df.reset_index(inplace=True)","4a4aa414":"df","ea4b5ac9":"sns.reset_defaults()\n\n#Visualization\nfig=plt.figure(figsize=(10,5));\n\nax0=fig.add_subplot(1,2,1)\nax1=fig.add_subplot(1,2,2)\nax1.grid(False)\nax1.set_xticklabels([])\nax1.set_yticklabels([])\n\nfig.patch.set_facecolor(background_color)\nax0.set_facecolor(background_color)\nax1.set_facecolor(background_color)\nax0.spines[\"bottom\"].set_visible(False)\nax0.spines[\"top\"].set_visible(False)\nax0.spines[\"right\"].set_visible(False)\nax0.spines[\"left\"].set_visible(False)\nax1.spines[\"bottom\"].set_visible(False)\nax1.spines[\"top\"].set_visible(False)\nax1.spines[\"right\"].set_visible(False)\nax1.spines[\"left\"].set_visible(False)\nax1.tick_params(left=False,bottom=False)\n\n#Plot \nsns.lineplot(data=df,x='month',y='targeted_productivity',ax=ax0,color='grey')\nsns.lineplot(data=df,x='month',y='actual_productivity',ax=ax0,color='green')\nax0.set_ylabel('Productivity')\n\n#rotating the ticklabels in x axis\nfor tick in ax0.get_xticklabels():\n    tick.set_rotation(90)\n    \n#Draw line in the middle    \nl1= lines.Line2D([0.52,0.52],[0.1, 0.9],color='black',lw=0.2,transform=fig.transFigure)\nfig.lines.extend([l1])\n\n#heading content\nfig.text(x=0.5,\n        y=0.6,\n        fontweight='bold',\n        fontfamily='serif',\n        fontsize=17,\n        color='grey',\n        s='''\n        Actual vs Targetted productivity\n        ''')\n#text content\nfig.text(x=0.5,\n        y=0.2,\n        fontweight='light',\n        fontfamily='serif',\n        fontsize=16,\n        color='grey',\n        s='''\n        grey - Targeterd productivity\n        green - actual productivty\n        \n        Actual and targetted productivity\n        meets same target on third month.\n        \n        ''')\nplt.show()","5073f941":"result=df_input.groupby(['month','team']).agg({'actual_productivity':'sum'})","7e1f410b":"type(result)","3f2acf18":"result.reset_index(inplace=True)","1fe8da96":"sns.reset_defaults()\n\n#Visualization\nfig=plt.figure(figsize=(10,5));\n\nax0=fig.add_subplot(1,2,1)\nax1=fig.add_subplot(1,2,2)\nax1.grid(False)\nax1.set_xticklabels([])\nax1.set_yticklabels([])\n\nfig.patch.set_facecolor(background_color)\nax0.set_facecolor(background_color)\nax1.set_facecolor(background_color)\nax0.spines[\"bottom\"].set_visible(False)\nax0.spines[\"top\"].set_visible(False)\nax0.spines[\"right\"].set_visible(False)\nax0.spines[\"left\"].set_visible(False)\nax1.spines[\"bottom\"].set_visible(False)\nax1.spines[\"top\"].set_visible(False)\nax1.spines[\"right\"].set_visible(False)\nax1.spines[\"left\"].set_visible(False)\nax1.tick_params(left=False,bottom=False)\n\n#Plot \nsns.barplot(data=result,x='month',y='actual_productivity',hue='team',ax=ax0)\nax0.set_ylabel('Productivity')\n\n#rotating the ticklabels in x axis\nfor tick in ax0.get_xticklabels():\n    tick.set_rotation(90)\n    \n#Draw line in the middle    \nl1= lines.Line2D([0.52,0.52],[0.1, 0.9],color='black',lw=0.2,transform=fig.transFigure)\nfig.lines.extend([l1])\n\n#heading content\nfig.text(x=0.5,\n        y=0.6,\n        fontweight='bold',\n        fontfamily='serif',\n        fontsize=17,\n        color='grey',\n        s='''\n        Actual productivity of the teams per month\n        ''')\n#text content\nfig.text(x=0.5,\n        y=0.2,\n        fontweight='light',\n        fontfamily='serif',\n        fontsize=16,\n        color='grey',\n        s='''\n                \n        ''')\nplt.show()","03d83ccc":"result=df_input.groupby('day').agg({'actual_productivity':'mean'})\nresult.reset_index(inplace=True)","ea193ab2":"sns.reset_defaults()\n\n#Visualization\nfig=plt.figure(figsize=(10,5));\n\nax0=fig.add_subplot(1,2,1)\nax1=fig.add_subplot(1,2,2)\nax1.grid(False)\nax1.set_xticklabels([])\nax1.set_yticklabels([])\n\nfig.patch.set_facecolor(background_color)\nax0.set_facecolor(background_color)\nax1.set_facecolor(background_color)\nax0.spines[\"bottom\"].set_visible(False)\nax0.spines[\"top\"].set_visible(False)\nax0.spines[\"right\"].set_visible(False)\nax0.spines[\"left\"].set_visible(False)\nax1.spines[\"bottom\"].set_visible(False)\nax1.spines[\"top\"].set_visible(False)\nax1.spines[\"right\"].set_visible(False)\nax1.spines[\"left\"].set_visible(False)\nax1.tick_params(left=False,bottom=False)\n\n#Plot \nsns.barplot(data=result,x='day',y='actual_productivity',ax=ax0)\nax0.set_ylabel('Productivity')\n\n#rotating the ticklabels in x axis\nfor tick in ax0.get_xticklabels():\n    tick.set_rotation(90)\n    \n#Draw line in the middle    \nl1= lines.Line2D([0.52,0.52],[0.1, 0.9],color='black',lw=0.2,transform=fig.transFigure)\nfig.lines.extend([l1])\n\n#heading content\nfig.text(x=0.5,\n        y=0.6,\n        fontweight='bold',\n        fontfamily='serif',\n        fontsize=17,\n        color='grey',\n        s='''\n        Actual productivity per day\n        ''')\n#text content\nfig.text(x=0.5,\n        y=0.5,\n        fontweight='light',\n        fontfamily='serif',\n        fontsize=16,\n        color='grey',\n        s='''\n        Productivity is not affected by the day  \n        ''')\nplt.show()","853faf62":"result=df_input.groupby('team').aggregate({'idle_men':'sum'})","d3e74f1f":"sns.reset_defaults()\n\n#Visualization\nfig=plt.figure(figsize=(10,5));\n\nax0=fig.add_subplot(1,2,1)\nax1=fig.add_subplot(1,2,2)\nax1.grid(False)\nax1.set_xticklabels([])\nax1.set_yticklabels([])\n\nfig.patch.set_facecolor(background_color)\nax0.set_facecolor(background_color)\nax1.set_facecolor(background_color)\nax0.spines[\"bottom\"].set_visible(False)\nax0.spines[\"top\"].set_visible(False)\nax0.spines[\"right\"].set_visible(False)\nax0.spines[\"left\"].set_visible(False)\nax1.spines[\"bottom\"].set_visible(False)\nax1.spines[\"top\"].set_visible(False)\nax1.spines[\"right\"].set_visible(False)\nax1.spines[\"left\"].set_visible(False)\nax1.tick_params(left=False,bottom=False)\n\n#Plot \nsns.barplot(data=result,x=result.index,y='idle_men',ax=ax0)\nax0.set_ylabel('Productivity')\n\n#rotating the ticklabels in x axis\nfor tick in ax0.get_xticklabels():\n    tick.set_rotation(90)\n    \n#Draw line in the middle    \nl1= lines.Line2D([0.52,0.52],[0.1, 0.9],color='black',lw=0.2,transform=fig.transFigure)\nfig.lines.extend([l1])\n\n#heading content\nfig.text(x=0.5,\n        y=0.6,\n        fontweight='bold',\n        fontfamily='serif',\n        fontsize=17,\n        color='grey',\n        s='''\n        Idlemen per team\n        ''')\n#text content\nfig.text(x=0.5,\n        y=0.5,\n        fontweight='light',\n        fontfamily='serif',\n        fontsize=16,\n        color='grey',\n        s='''\n        Looks like team 7 got more idle men\n        ''')\nplt.show()","754a16bb":"df = df_input.copy()","23817820":"df","eb42f81b":"df.quarter.unique()","57e3b49d":"# The year value 2015 is common across the dataset. Hence removing year.\ndf.drop('year',axis=1,inplace=True)","4a8e070b":"# Feature 'quarter' doesn't make any sense. This we can derive from date and month. Hence removing feature 'quarter'\ndf.drop('quarter',axis=1,inplace=True)","68de5b44":"# About 57.72% wip feature containing null values. Hence removing this feature.\ndf.drop('wip',axis=1,inplace=True)","8f624591":"# actual_productivity is the target variable, having skewness -0.807\n# Let's try to reduce this target feature skewness\nlog_target = np.log(df.actual_productivity)\nsqrt_target = np.sqrt(df.actual_productivity)\nboxcox_target = stats.boxcox(df_input.actual_productivity)\n\n# Store the BoxCox key for getting the actual value\nbox_cox_param = boxcox_target[1]\n\nboxcox_target = pd.Series(boxcox_target[0])\nprint (f\"Log skewness: {log_target.skew()}\\nSquare root target skewness : {sqrt_target.skew()}\\nBoxcox target skewness: {boxcox_target.skew()}\")\n","b830b5aa":"sns.reset_defaults()\n\n#Visualization\nfig=plt.figure(figsize=(10,12));\n\nax0=fig.add_subplot(2,2,1)\n# ax1=fig.add_subplot(2,2,2)\nax2=fig.add_subplot(2,2,3)\nax3=fig.add_subplot(2,2,4)\n\n#ax1.grid(False)\n#ax1.set_xticklabels([])\n#ax1.set_yticklabels([])\n\nfig.patch.set_facecolor(background_color)\n\nax0.set_facecolor(background_color)\n#ax1.set_facecolor(background_color)\nax2.set_facecolor(background_color)\nax3.set_facecolor(background_color)\n\nfor side in [\"bottom\",\"top\",\"right\",\"left\"]:\n    ax0.spines[side].set_visible(False)\n#    ax1.spines[side].set_visible(False)\n    ax2.spines[side].set_visible(False)\n    ax3.spines[side].set_visible(False)\n\n#Plot \nsns.distplot(log_target,ax=ax0)\nax0.set_title(\"Log of target\")\n\nsns.distplot(sqrt_target,ax=ax2)\nax2.set_title(\"Square root of target\")\n\nsns.distplot(boxcox_target,ax=ax3)\nax3.set_title(\"Boxcox target\")\n\n#rotating the ticklabels in x axis\nfor tick in ax0.get_xticklabels():\n    tick.set_rotation(90)\n    \n#Draw line in the middle    \nl1= lines.Line2D([0.5,0.5],[0.1, 0.9],color='black',lw=0.2,transform=fig.transFigure)\nfig.lines.extend([l1])\n\n#heading content\nfig.text(x=0.5,\n        y=0.75,\n        fontweight='bold',\n        fontfamily='serif',\n        fontsize=17,\n        color='grey',\n        s='''\n        Different models for actual_productivity\n        distribution\n        ''')\n#text content\nfig.text(x=0.5,\n        y=0.6,\n        fontweight='light',\n        fontfamily='serif',\n        fontsize=16,\n        color='grey',\n        s='''\n        Log skewness: -1.5736961147100366\n        Square root target skewness : -1.1734572168685393\n        Boxcox target skewness: -0.13866501140801019\n        \n        Looks like BoxCox model performs good \n        in normalizing distribution\n        ''')\nplt.show()","b7cd4059":"# Replacing taget feature with Boxcox transformed target\ndf['actual_productivity']=boxcox_target","a7c46a08":"# Since department is categorical feature, applying onehot encoding to 'department'\ndf=pd.concat([df,pd.get_dummies(df['department'])],axis=1)\ndf.drop('department',axis=1,inplace=True)","fffef736":"# Feature 'team' also categorical feature\ndf=pd.concat([df,pd.get_dummies(df['team'],prefix='team')],axis=1)\ndf.drop('team',axis=1,inplace=True)","b94f6026":"# Feature 'day' is categorical in nature\ndf=pd.concat([df,pd.get_dummies(df['day'])],axis=1)\ndf.drop('day',axis=1,inplace=True)","5f1b85b3":"# Dropping the feature 'date'\ndf.drop('date',axis=1,inplace=True)","bb21a6fa":"print (f\"Feature names after data wrangling :\\n\\n {df.columns}\")","6d90f470":"# Let's check the correlation of features with target feature.\ndf_corr = df.copy()\ncorrelation_matrix = df_corr.corr()\n# Interested only in the relation with target feature 'actual_productivity'\ncorrelation_matrix=correlation_matrix['actual_productivity']\ncorrelation_matrix=correlation_matrix.to_frame()\ncorrelation_matrix.sort_values(by='actual_productivity',ascending=False,inplace=True)\n# display(correlation_matrix)","9799f1b1":"sns.reset_defaults()\n\n#Visualization\nfig=plt.figure(figsize=(10,7));\n\nax0=fig.add_subplot(1,2,1)\nax1=fig.add_subplot(1,2,2)\nax1.grid(False)\nax1.set_xticklabels([])\nax1.set_yticklabels([])\n\nfig.patch.set_facecolor(background_color)\nax0.set_facecolor(background_color)\nax1.set_facecolor(background_color)\nax0.spines[\"bottom\"].set_visible(False)\nax0.spines[\"top\"].set_visible(False)\nax0.spines[\"right\"].set_visible(False)\nax0.spines[\"left\"].set_visible(False)\nax1.spines[\"bottom\"].set_visible(False)\nax1.spines[\"top\"].set_visible(False)\nax1.spines[\"right\"].set_visible(False)\nax1.spines[\"left\"].set_visible(False)\nax1.tick_params(left=False,bottom=False)\n\n#Plot \nsns.heatmap(correlation_matrix,cmap='inferno',annot=True,cbar=False,ax=ax0)\nax0.set_ylabel('Productivity')\n\n   \n#Draw line in the middle    \nl1= lines.Line2D([0.52,0.52],[0.1, 0.9],color='black',lw=0.2,transform=fig.transFigure)\nfig.lines.extend([l1])\n\n#heading content\nfig.text(x=0.5,\n        y=0.6,\n        fontweight='bold',\n        fontfamily='serif',\n        fontsize=17,\n        color='grey',\n        s='''\n        Relation between independent features\n        with target feature\n        ''')\n#text content\nfig.text(x=0.5,\n        y=0.5,\n        fontweight='light',\n        fontfamily='serif',\n        fontsize=16,\n        color='grey',\n        s='''\n        Almost all the features doesn't have \n        any strong relation with target feature.\n        ''')\nplt.show()","be1273e8":"# Function for providing generalized results for regression model\ndef evaluate_model(model,x_train,y_train,x_test,y_test):\n    '''\n    Inputs\n    1. regression model eg: LinearRegression(),LassoRegression() etc.\n    2. training x data\n    3. training y data\n    4. testing x data\n    5. testing y data\n    '''\n    model.fit(x_train,y_train)\n    model_name=model.__class__.__name__\n    \n    train_score=model.score(x_train,y_train)\n    test_score=model.score(x_test,y_test)\n    print (f\"Training score: {train_score}\\nTesting score: {test_score}\")\n    \n    y_pred=model.predict(x_test)\n    print(\"Prediction completed.\")\n    df=pd.DataFrame({\"Actual\": y_test,\n                     \"Predicted\":y_pred})\n    \n    #Apply inverse box cox to retrieve original target results\n    df=inv_boxcox(df,box_cox_param)\n    \n    #Finding the difference between original and predicted\n    df[\"difference\"]=df.Predicted-df.Actual\n    df.reset_index(inplace=True)\n    \n    #Plot actual vs predicted\n    plt.figure(figsize=(10,5));\n    sns.scatterplot(data=df,x=\"index\",y=\"Actual\",color='grey',label=[\"Actual\"]).set_facecolor(background_color);\n    sns.lineplot(data=df,x=\"index\",y=\"Predicted\",color='salmon',label=[\"Predicted\"]);\n    plt.legend(loc=\"right\",bbox_to_anchor=(1.1,1));\n    plt.title(model_name+\" -Actual vs Predicted\");\n    plt.show()\n    \n    print (\"Sample comparison file for actual and predicted target feature:\")\n    display(df.head())\n    \n    # Return the model for re-use if required.\n    return model","6a92614b":"#General data frame and function for storing and comparing model results.\ndf_model_results=pd.DataFrame(columns=[\"ModelName\",\"TrainScore\"])\n\ndef store_model_results(modl_name,train_score):\n    global df_model_results\n    row_loc=df_model_results.shape[0]+1\n    df_model_results.loc[row_loc,[\"ModelName\",\"TrainScore\"]]=[modl_name,train_score]","1d3b4311":"#Run each model and show the combined results.\ndef show_model_scores(x,y):\n    global df_model_results\n    df_model_results=df_model_results.iloc[0:0] #reset display dataframe\n    for model in  [LinearRegression(),\n                   Lasso(),\n                   Ridge(),\n                   ElasticNet(),\n                   XGBRegressor()]:\n        store_model_results(model.__class__.__name__, cross_val_score(model,x,y,cv=3).mean())\n    df_model_results.sort_values(\"TrainScore\",ascending=False,inplace=True)\n    display(df_model_results)\n    display(HTML('Selected model : <b>' + df_model_results.head(1)['ModelName'].values[0] + '<\/b>'))\n    ","e1fe1192":"# Setting dependent and independent variables\ny = df.actual_productivity\nx = df.drop('actual_productivity',axis=1)","28219894":"# Set training and testing dataset\nx_train,x_test,y_train,y_test=train_test_split(x,y)","63a05ea7":"#Lets run the \nshow_model_scores(x_train,y_train)","701332f4":"evaluate_model(XGBRegressor(),x_train,y_train,x_test,y_test)","e02fd658":"# Possible parameter values\nparam_tuning={\n    'learning_rate' : [0.01,0.1,.11,.2],\n    'max_depth' : [1,2,3,5],\n    'min_child_weight' : [3,5,7,9],\n    'subsample' : [0.5,0.7,0.9],\n    'colsample_bytree' : [0.3,0.5,0.7,0.9],\n    'n_estimators' : [25,50,100],\n    'objective' : ['reg:squarederror']\n}","9250c69c":"# Using the GridSearchCrossValidation, find the model with best parameter settings\ngsearch = GridSearchCV (estimator = XGBRegressor(),\n                       param_grid = param_tuning,\n                       cv = 2,\n                       n_jobs= -1,\n                       verbose = 1)","0ca0b361":"# Not that below step may be time consuming process.\n# gsearch.fit(x,y)\n# print (gsearch.best_params_)\n\n# Below is the best parameters for the model, obtained from gsearch.best_params\nbest_params = {'colsample_bytree': 0.7, 'learning_rate': 0.11, 'max_depth': 3, 'min_child_weight': 7, 'n_estimators': 50, 'objective': 'reg:squarederror', 'subsample': 0.7}","ff90bd7d":"# Save the model with best parameters\n# selected_model = gsearch.best_estimator_\n\nselected_model = XGBRegressor(colsample_bytree=0.7, learning_rate=0.11, max_depth=3,\n             min_child_weight=7, n_estimators=50, objective='reg:squarederror', subsample=0.7)","e6d9eb43":"# Find how the model is performing now.\nevaluate_model(selected_model,x_train,y_train,x_test,y_test)","9a24adaf":"### 14. idlemen\nThe number of workers who were idle due to production interruption","e21c0a86":"### 5. teamno \nAssociated team number with the instance ","175435aa":"### 9. smv\nStandard Minute Value, it is the allocated time for a task ","fafb9feb":"### 11. overtime \nRepresents the amount of overtime by each team in minutes","755b2dbd":"### 7. noofstylechange\nNumber of changes in the style of a particular product","9f77896a":"### 3. quarter \nA portion of the month. A month was divided into four quarters","76dd14ca":"## Model tunning","2783754a":"### 4. Is there a relation between Incentives and Overtime?","bc390120":"### 2. Which department having more productivity in whole dataset?","319ba188":"## Model training\nFind the best model for the data and train the model with available data.","f2747c33":"### 6. noofworkers \nNumber of workers in each team","a4429875":"### 2. Day\nDay of the week","b3eac53c":"<h4 style=\"background-color:#fbfbfb;font-family:serif;font-size:160%;\">\n    Float features   : 6 <br>\n    Integer features : 5 <br>\n    String features  : 4 <br>\n    <\/h4>","05e27906":"### 8. Which team having more idle men?","b516ffc6":"### 7. Normally which day having more(average) productivity?","efc4af76":"### 1. How many years of data do we have?","2f074ca2":"### 12. incentive \nRepresents the amount of financial incentive (in BDT) that enables or motivates a particular course of action.","65a22e6a":"This time, both training and testing models are almost same. That means model is no more overfitted.\nThis model is not much training data dependent, i.e. we can use for predicting similar data.","9407e0f8":"### 1. Date\nDate in MM-DD-YYYY","0632ce94":"<i>With weak relations with target feature, model training will be difficult. However we can try for find a good model that can fit this given data.<\/i>","e2cf39af":"### 3. Does the incentives improves productivity?","32752135":"### 4. department\nAssociated department with the instance","93922d98":"### 5. Targetted productivity vs Actual productivity per month","c90454a1":"<i>\n    Selected model here is XtremeGradientBoosting. Also score also not that much great.\n    Note that here training score is more than testing score, which means model is overfitted one.\n    <\/i>","3009ca62":"### 13. idletime \nThe amount of time when the production was interrupted due to several reasons ","dbf2d566":"## <center>Feature Relationships<\/center>","83b3eea2":"### 6. Overall productivity of team per month","7c468648":"### 10. wip \nWork in progress. Includes the number of unfinished items for products ","b58889e4":"### 8. targetedproductivity \nTargeted productivity set by the Authority for each team for each day. \n","5a2c4d0e":"### 15. actual_productivity \nThe actual % of productivity that was delivered by the workers. It ranges from 0-1.","641cca8f":"## Feature Analysis","a5c309cd":"<h4 style=\"background-color:#fbfbfb;font-family:serif;font-size:160%;\">\n    Dataset containing data for year 2015 and months of January, February and March.\n    <\/h4>","2b737cdc":"## Data Wrangling\nClean the data for better model training.","7b5a2930":"## <center> Productivity Prediction of Garment Employees<\/center>\n\nThis dataset includes important attributes of the garment manufacturing process and the productivity of the employees which had been collected manually and also been validated by the industry experts.\n\n<a href=\"https:\/\/www.kaggle.com\/ishadss\/productivity-prediction-of-garment-employees\"> Datasource here.<\/a>\n"}}