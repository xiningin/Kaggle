{"cell_type":{"a0c29bd3":"code","867990ae":"code","ca082fcb":"code","9c901663":"code","946f1567":"code","73875694":"code","aa6b66c8":"code","193d49d9":"code","c113fbb9":"code","64951306":"code","ed894344":"code","ea7c163b":"code","d3d76a8a":"code","98f441be":"code","88cebab2":"code","26951849":"code","ce1d562b":"code","01f19adc":"code","ad4095b9":"code","bc0e9610":"code","944d02d7":"code","4def3d7a":"markdown","c53f45c6":"markdown","ab2768f2":"markdown","7caea1f6":"markdown","d58ce7dc":"markdown","ca3d39da":"markdown"},"source":{"a0c29bd3":"import numpy as np\nimport pandas as pd\nimport cv2\nimport matplotlib.pyplot as plt\nplt.style.use(\"seaborn-white\")\nimport ast\n\nBASE_DIR = \"..\/input\/ranzcr-clip-catheter-line-classification\"\nTRAIN_DIR = \"..\/input\/ranzcr-clip-catheter-line-classification\/train\"\nTEST_DIR = \"..\/input\/ranzcr-clip-catheter-line-classification\/test\"\n\ndf = pd.read_csv(BASE_DIR + \"\/train.csv\")\nan = pd.read_csv(BASE_DIR + \"\/train_annotations.csv\")\nLABELS = [\n    'ETT - Abnormal', 'ETT - Borderline', 'ETT - Normal',\n    'NGT - Abnormal', 'NGT - Borderline', 'NGT - Incompletely Imaged', 'NGT - Normal', \n    'CVC - Abnormal', 'CVC - Borderline', 'CVC - Normal',\n    'Swan Ganz Catheter Present'\n]\n\ndef show_images(studyuid):\n    path = TRAIN_DIR + \"\/\" + studyuid + \".jpg\"\n    image = cv2.imread(path)\n    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)\n    annotations = an.loc[an[\"StudyInstanceUID\"] == studyuid]\n    _, ax = plt.subplots(1, 2, figsize = (16, 6))\n    ax[0].imshow(image)\n    ax[1].imshow(image)\n    for i in range(annotations.shape[0]):\n        points = np.array(ast.literal_eval(annotations[\"data\"].values[i]))\n        ax[1].scatter(points[:, 0], points[:, 1], label = annotations[\"label\"].values[i])\n    plt.legend(bbox_to_anchor = (1.5, 1))\n    plt.show()","867990ae":"an[\"StudyInstanceUID\"].value_counts()[:20]","ca082fcb":"studyuid = \"1.2.826.0.1.3680043.8.498.15159015355212130418020059688126994534\"\nshow_images(studyuid)","9c901663":"df.loc[df[\"StudyInstanceUID\"] == studyuid]","946f1567":"df.loc[df[\"PatientID\"] == \"ab02c52b6\"]","73875694":"df.loc[df[\"PatientID\"] == \"ab02c52b6\"].iloc[1:-1].sum(axis = 1).sort_values()","aa6b66c8":"dummy = []\nfor studyuid in df.loc[df[\"PatientID\"] == \"ab02c52b6\"][\"StudyInstanceUID\"].values:\n    num = an.loc[an[\"StudyInstanceUID\"] == studyuid].shape[0]\n    if num > 0:\n        dummy.append([studyuid, num])\nprint(len(dummy))","193d49d9":"dummy = pd.DataFrame(np.stack(dummy, axis = 0), columns = [\"studyuid\", \"num\"]).sort_values(by = \"num\")\ndummy","c113fbb9":"ids = dummy[\"studyuid\"].values\nfor i in range(len(ids)):\n    show_images(ids[i])","64951306":"studyuid = \"1.2.826.0.1.3680043.8.498.11693509889426445054876979814173446281\"\nshow_images(studyuid)","ed894344":"patientid = df.loc[df[\"StudyInstanceUID\"] == studyuid][\"PatientID\"].values[0]\ndf.loc[df[\"PatientID\"] == patientid]","ea7c163b":"dummy = []\nfor studyuid in df.loc[df[\"PatientID\"] == patientid][\"StudyInstanceUID\"].values:\n    num = an.loc[an[\"StudyInstanceUID\"] == studyuid].shape[0]\n    if num > 0:\n        dummy.append([studyuid, num])\nprint(len(dummy))\n\ndummy = pd.DataFrame(np.stack(dummy, axis = 0), columns = [\"studyuid\", \"num\"]).sort_values(by = \"num\")\ndummy","d3d76a8a":"ids = dummy[\"studyuid\"].values\nfor i in range(len(ids)):\n    show_images(ids[i])","98f441be":"studyuid = \"1.2.826.0.1.3680043.8.498.78564720383570055111382037149190611110\"\nshow_images(studyuid)","88cebab2":"patientid = df.loc[df[\"StudyInstanceUID\"] == studyuid][\"PatientID\"].values[0]\ndf.loc[df[\"PatientID\"] == patientid]","26951849":"dummy = []\nfor studyuid in df.loc[df[\"PatientID\"] == patientid][\"StudyInstanceUID\"].values:\n    num = an.loc[an[\"StudyInstanceUID\"] == studyuid].shape[0]\n    if num > 0:\n        dummy.append([studyuid, num])\nprint(len(dummy))\n\ndummy = pd.DataFrame(np.stack(dummy, axis = 0), columns = [\"studyuid\", \"num\"]).sort_values(by = \"num\")\ndummy","ce1d562b":"ids = dummy[\"studyuid\"].values\nfor i in range(len(ids)):\n    show_images(ids[i])","01f19adc":"studyuid = \"1.2.826.0.1.3680043.8.498.60592692416320105601197086649025304615\"\nshow_images(studyuid)","ad4095b9":"patientid = df.loc[df[\"StudyInstanceUID\"] == studyuid][\"PatientID\"].values[0]\ndf.loc[df[\"PatientID\"] == patientid]","bc0e9610":"dummy = []\nfor studyuid in df.loc[df[\"PatientID\"] == patientid][\"StudyInstanceUID\"].values:\n    num = an.loc[an[\"StudyInstanceUID\"] == studyuid].shape[0]\n    if num > 0:\n        dummy.append([studyuid, num])\nprint(len(dummy))\n\ndummy = pd.DataFrame(np.stack(dummy, axis = 0), columns = [\"studyuid\", \"num\"]).sort_values(by = \"num\")\ndummy","944d02d7":"ids = dummy[\"studyuid\"].values\nfor i in range(len(ids)):\n    show_images(ids[i])","4def3d7a":"# \u2460","c53f45c6":"at 5th image, the orange catheter became \"Abnormal\" because it makes a circle?","ab2768f2":"The same catheter which was blue in the first image \"CVC - Borderline\" changes its label.\n\nBorder >> Border >> Normal >> Border >> Border >> Border >> Normal >> Border >> Normal >> Abnormal >> Normal","7caea1f6":"# \u2463","d58ce7dc":"# \u2461","ca3d39da":"# \u2462"}}