{"cell_type":{"03b1dd74":"code","5183f706":"code","b4133b1c":"code","030d740d":"code","3b6b1f7c":"code","2c17414b":"code","acb00b9f":"code","854008ab":"code","cceef0b5":"code","84669165":"code","6c9d3053":"code","25a652eb":"code","e61c0f0a":"code","c8505d1d":"code","d2ff0c6d":"code","45c41ac1":"code","28dedb66":"code","72526502":"code","7cdde894":"code","567cff0e":"code","84217f7b":"code","53c7018d":"markdown","2a6e3cf0":"markdown","99a0d58e":"markdown","5f513063":"markdown","0859d0cc":"markdown","d7a46983":"markdown","b30f1479":"markdown","1e1d383f":"markdown","023c7f5b":"markdown","77d5bc8c":"markdown","18c687d7":"markdown","a5035669":"markdown","79a8eefa":"markdown","08bcac61":"markdown","4bad0a41":"markdown"},"source":{"03b1dd74":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt \n%matplotlib inline\nimport seaborn as sns ","5183f706":"!pip install openpyxl","b4133b1c":"Athletes = pd.read_excel(\"..\/input\/2021-olympics-in-tokyo\/Athletes.xlsx\")\nCoaches = pd.read_excel(\"..\/input\/2021-olympics-in-tokyo\/Coaches.xlsx\")\nEntriesGender = pd.read_excel(\"..\/input\/2021-olympics-in-tokyo\/EntriesGender.xlsx\")\nMedals = pd.read_excel(\"..\/input\/2021-olympics-in-tokyo\/Medals.xlsx\")\nTeams = pd.read_excel(\"..\/input\/2021-olympics-in-tokyo\/Teams.xlsx\")","030d740d":"def look_to_data(df):\n    \"\"\" this function returns a brief description about the data\n    Parameters:\n    argument1 (Pandas DataFrame)\n    \"\"\"\n    #show 5 row of data\n    display(df.head())\n    #print shape of data \n    print(\"shape : \",df.shape,\"\\n\")\n    #chek the data if have null values\n    print(\"\\nchek duplicated values :\\n\",df.duplicated().sum(),\"\\n\")\n    #print description of data\n    df.info()","3b6b1f7c":"look_to_data(Athletes)","2c17414b":"Athletes.drop_duplicates(inplace=True) \nAthletes.duplicated().sum()","acb00b9f":"look_to_data(Coaches)","854008ab":"Coaches.drop_duplicates(inplace=True) \nCoaches.duplicated().sum()","cceef0b5":"look_to_data(EntriesGender)","84669165":"look_to_data(Teams)","6c9d3053":"look_to_data(Medals)","25a652eb":"Discipline_Athletes = Athletes.groupby(\"Discipline\")[\"Name\"].count().sort_values(ascending=False)\nx = Discipline_Athletes\ny = Discipline_Athletes.index\nplt.figure(figsize = (20,7))\nsns.barplot(x=y,y=x).set(xlabel=\"Number of Athletes\",ylabel=\"Discipline\")\nplt.xticks(rotation = 80)\nfor i, v in enumerate(x):\n    plt.text(i, v, str(v))\nplt.show()","e61c0f0a":"Discipline_Athletes = Athletes.groupby(\"NOC\")[\"Name\"].count().sort_values(ascending=False)[:30]\nx = Discipline_Athletes\ny = Discipline_Athletes.index\nplt.figure(figsize = (20,7))\nplt.bar(y,x)\nplt.xticks(rotation = 70)\n#add Athletes number above each country\nfor i, v in enumerate(x):\n    plt.text(i, v, str(v))\nplt.xlabel(\"Countries\")\nplt.ylabel(\"Number of Athletes\")  \nplt.show()","c8505d1d":"plt.figure(figsize=(17,6))\nsns.set(rc = {'axes.grid': True})\nsns.lineplot(y= EntriesGender[\"Male\"],x= EntriesGender[\"Discipline\"],color='black',label='Male')\nsns.lineplot(y= EntriesGender[\"Female\"],x= EntriesGender[\"Discipline\"],color=\"r\",label='Female')\nplt.xticks(rotation = 80)\nplt.grid(color='Cyan', linewidth=1, axis='both', alpha=0.5)","d2ff0c6d":"male = EntriesGender.Male.sum()\nfemale = EntriesGender.Female.sum()\ndf=[male,female]\nplt.figure(figsize=(7,7))\nplt.pie(df,labels=[\"Male\",\"Female\"],autopct=lambda p: '{:.0f}%  ({:.0f})'.format(p,(p\/100)*(df[0]+df[1])))\nprint(\"\")","45c41ac1":"df=Coaches.groupby([\"NOC\"])[\"Name\"].count().sort_values()\nplt.figure(figsize=(18,7))\nsns.barplot(y=df,x=df.index,palette = sns.color_palette(\"rocket\",n_colors=30)).set( ylabel = \"number of coaches\",title=\"number of coaches in each Country\")\nplt.xticks(rotation = 80);","28dedb66":"df=Coaches.groupby([\"Discipline\"])[\"Name\"].count().sort_values()\nplt.figure(figsize=(10,10))\nplt.pie(x=df,labels=df.index,autopct=lambda p: '{:.0f}%  ({:.0f})'.format(p,(p\/100)*df.sum()))\ncircle = plt.Circle( (0,0), 0.4, color='white')\np = plt.gcf()\np.gca().add_artist(circle)\nplt.show()","72526502":"plt.figure(figsize=(16,7))\ndf=Teams.groupby(\"Name\").count().sort_values(\"NOC\",ascending=False)[:20]\nsns.barplot(y=df.index,x=\"NOC\",data=df).set(xlabel=\"number of teams\",ylabel=\"country\",title=\"Top 20 country with most teams\");","7cdde894":"plt.figure(figsize=(16,7))\ndf=Teams.groupby(\"Discipline\").count().sort_values(\"NOC\",ascending=False)\nsns.barplot(y=df.index,x=\"NOC\",data=df).set(xlabel=\"number of teams\",ylabel=\"Discipline\",title=\"Top Discipline with most teams\");","567cff0e":"plt.figure(figsize=(17,7))\ndf=Medals.iloc[:15,1:5]\ndf = pd.melt(df, id_vars=\"Team\/NOC\", var_name=\"Medal\", value_name=\"count\");\nsns.barplot(x=\"Team\/NOC\",y=\"count\",hue=\"Medal\",data=df).set(xlabel=\"country\",ylabel=\"count of medals\",title=\"Top 20 ranked country and its medals\");\nplt.xticks(rotation = 80);\nplt.grid(color='black', linewidth=1, axis='y', alpha=0.5)","84217f7b":"def autopct_format(values):\n    def my_format(pct):\n        total = sum(values)\n        val = int(round(pct*total\/100.0))\n        return '{v:d}'.format(v=val)\n    return my_format\n\n\ndf=Medals.set_index(\"Team\/NOC\")\nfig, axs = plt.subplots(2,2)\n\ntotal=df[\"Total\"].sort_values(ascending=False)[:10]\ngold=df[\"Gold\"].sort_values(ascending=False)[:10]\nsilver=df[\"Silver\"].sort_values(ascending=False)[:10]\nbronze=df[\"Bronze\"].sort_values(ascending=False)[:10]\n\ntotal.plot(kind=\"pie\",autopct=autopct_format(total),ax=axs[0,0],title=\"Total Medals\");\ngold.plot(kind=\"pie\",autopct=autopct_format(gold),ax=axs[0,1],title=\"Gold\");\nsilver.plot(kind=\"pie\",autopct=autopct_format(silver),ax=axs[1,0],title=\"Silver\");\nbronze.plot(figsize=(15,15),kind=\"pie\",autopct=autopct_format(bronze),ax=axs[1,1],title=\"Bronze\");\n","53c7018d":"# Thanks for your time ","2a6e3cf0":"### Number of Coaches in each Discipline","99a0d58e":"### The number of medals won by the top 10 countries in each medal","5f513063":"### Top Discipline with most teams","0859d0cc":"### The top 20 countries have Athletes participate in Olympics","d7a46983":"### Total male and female who participate in Olympic","b30f1479":"### Gender counts participate in each Discipline","1e1d383f":"# Import necessary library\n","023c7f5b":"# Load data files","77d5bc8c":"### Number of coaches participate in Olympic in each Country","18c687d7":"# Exploratory Data Analysis","a5035669":"# Data Wrangling","79a8eefa":"### Top 15 ranked country and its medals","08bcac61":"### the disciplines  which have the most Athletes participate in Olympic","4bad0a41":"### Top 20 country with most teams"}}