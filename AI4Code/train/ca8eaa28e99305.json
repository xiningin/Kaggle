{"cell_type":{"98dfda78":"code","5c7f70ee":"code","03103e7b":"code","29608dbe":"code","ea57a15f":"code","6acd018a":"code","31b4f862":"code","feb442e3":"code","1de31317":"code","7cf55ea2":"code","d5050482":"code","cb8c34e2":"code","606c5c3a":"code","b02c3856":"code","2fd47610":"code","d51677dd":"code","60d2c9e4":"code","07b80651":"code","f373c5b1":"markdown","67e4aff4":"markdown","b5f4268e":"markdown","238f6c12":"markdown","ff4ed50e":"markdown","3ad61c05":"markdown","3bd4662d":"markdown","1f4ecb29":"markdown","e3a710de":"markdown","ea0438b0":"markdown","24f0db4a":"markdown","4bbf4126":"markdown","cc05b737":"markdown","f3a1b0ab":"markdown","e6c9d371":"markdown","3c405af0":"markdown","2bfffb6d":"markdown","95b869ec":"markdown","4e604507":"markdown","ee5606d7":"markdown","1ae1d0e6":"markdown","8c90c389":"markdown","80eb765d":"markdown","e17f68fc":"markdown","58bcd853":"markdown","3bbe2d9e":"markdown","2952de21":"markdown","65b0a2cd":"markdown","acc20fb7":"markdown","ea20d601":"markdown","b8d66ab7":"markdown","7a6e6d96":"markdown","1db5be16":"markdown"},"source":{"98dfda78":"pip install evalml","5c7f70ee":"import evalml\nevalml.problem_types.problem_types.ProblemTypes.all_problem_types","03103e7b":"X,y = evalml.demos.load_breast_cancer()","29608dbe":"X_train, X_test, y_train, y_test = evalml.preprocessing.split_data(X, y, problem_type='binary')\n## here we are seeing top 10 columns of the dataset\nX_train.head(10)","ea57a15f":"from evalml.automl import AutoMLSearch\nautoml = AutoMLSearch(X_train=X_train, y_train=y_train, problem_type='binary')\nautoml.search()","6acd018a":"automl.rankings","31b4f862":"automl.best_pipeline","feb442e3":"best_pipeline=automl.best_pipeline","1de31317":"automl.describe_pipeline(automl.rankings.iloc[0][\"id\"])","7cf55ea2":"best_pipeline.score(X_test, y_test, objectives=[\"auc\",\"f1\",\"Precision\",\"Recall\"])","d5050482":"automl_auc = AutoMLSearch(X_train=X_train, y_train=y_train,\n                          problem_type='binary',\n                          objective='auc',\n                          additional_objectives=['f1', 'precision'],\n                          max_batches=1,\n                          optimize_thresholds=True)\n\nautoml_auc.search()","cb8c34e2":"automl_auc.rankings","606c5c3a":"automl_auc.describe_pipeline(automl_auc.rankings.iloc[0][\"id\"])","b02c3856":"best_pipeline_auc = automl_auc.best_pipeline","2fd47610":"best_pipeline_auc.score(X_test, y_test,  objectives=[\"auc\",\"f1\",\"Precision\",\"Recall\"])","d51677dd":"best_pipeline.save(\"model.pkl\")","60d2c9e4":"check_model=automl.load('model.pkl')","07b80651":"check_model.predict_proba(X_test).to_dataframe()","f373c5b1":"![image.png](attachment:b92c5656-9082-4b22-afc8-cbc4684f838f.png)","67e4aff4":"# EvalMl AutoML\u00a0Library","b5f4268e":"Automl internally split the dataset into an 80\u201320 ratio and it split the dataset for the dataTable. EvalML offers a different data structure DataTable to treat columns with the same physical data type differently. In the problem type parameter, you have to give your problem types like binary or multi-class.","238f6c12":"# And again see the score of f1, precision, and AUC nd Recall","ff4ed50e":"# Automated Machine\u00a0Learning","3ad61c05":"# So the best model pipeline obtained through EvalML is 98.61% accurate on the test data. Similarly, it has an F1-score of  0.95 on test data.","3bd4662d":"# We can also optimize for a problem specific objective","1f4ecb29":"# In this notebook,so far, we discussed AutoML (especially EvalML), its features, and its advantages. Further, we discovered how to find out a good model pipeline for a binary classification task using EvalML.","e3a710de":"# Loading the\u00a0dataset","ea0438b0":"# We can also hyper-tune our model based on the AUC score by giving AUC in objective. You can change your objective according to your need by giving anyone from these [f1, precision, and AUC].","24f0db4a":"# EvalML is an AutoML library that builds, optimizes, and evaluates machine learning pipelines using domain-specific objective functions.","4bbf4126":"# Loading the\u00a0Model","cc05b737":"# Check the detailed description of the top algorithm again","f3a1b0ab":"# The complete list of available problem types can be obtained using the following command.","e6c9d371":"# Key Functionality","3c405af0":"# Getting the best\u00a0pipeline\nIt will choose the best top model to create a pipeline for model building.\nIn order to check the best pipeline, what we have to run-","2bfffb6d":"# To see the top best model we have\u00a0got\n# Run below\u00a0command-","95b869ec":"It will show you the top best model with a score, validation score, parameters, and all\u2026","4e604507":"# For prediction\n# Give X_test dataset","ee5606d7":"The above code is iterating through various algorithms and tries to give us the result for every algorithm based on LogLoss.","1ae1d0e6":"# Evaluate on hold on\u00a0data","8c90c389":"# Installing Evalml","80eb765d":"AutoML automatically finds a reasonably good ML model pipeline for a given dataset with a little human intervention. In EvalML, we can train and optimize the model for a specific problem by optimizing domain-specific objectives functions or by defining our own custom objective function. Here we are implementing AUTOML search present inside evalml.automl\u00a0. AUTOML search is an automated pipeline search, it creates the pipeline using feature engineering, feature selection, and create a model with hyperparameter tuning. Inside this AUTOML search, you have to provide X_train, y_train, and problem type. Types of function it uses for different types of problem-\n\nLogLossBinary for binary classification problems.\n\nLogLossMulticlass for multiclass classification problems.\n\nR2 for regression problems.","e17f68fc":"You can take the dataset from the CSV file, excel sheet. We are taking a pre-defined dataset. This pre-defined dataset will be loaded in the form of the dataTable.","58bcd853":"# Let's check the detailed description of the first top algorithm\nYou will see pipeline steps like problem type, imputer, standardization, logistic regression classifier, cross-validation which are being used.","3bbe2d9e":"# Let's check the models ranking again after changing the objective","2952de21":"# Perform train test\u00a0split","65b0a2cd":"# Here, the best pipeline is obtained using the Extra Tree Classifier Select this as the best pipeline in our variable for prediction","acc20fb7":"![image.png](attachment:080d62bc-0547-438e-a846-a8f05bfde3b8.png)","ea20d601":"Automation\u200a-\u200aMakes machine learning easier. Avoid training and tuning models by hand. Includes data quality checks, cross-validation, and more.\n \n Data Checks\u200a-\u200aCatches and warns of problems with your data and problem setup before modeling.\n \nEnd-to-end\u200a-\u200aConstructs and optimizes pipelines that include state-of-the-art preprocessing, feature engineering, feature selection, and a variety of modeling techniques.\n \nModel Understanding\u200a-\u200aProvides tools to understand and introspect on models, to learn how they'll \nbehave in your problem domain.\n \nDomain-specific\u200a-\u200aIncludes repository of domain-specific objective functions and an interface to define your own.\n ","b8d66ab7":"# **You can see the scores of  Precision, Recall, f1, AUC.**","7a6e6d96":"# Previously, our top order algorithm was Logistic Regression Classifier and now after changing the objective of the model it is Extra Trees Classifier.","1db5be16":"# Save the\u00a0model"}}