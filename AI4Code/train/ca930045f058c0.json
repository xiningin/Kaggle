{"cell_type":{"61aacfe9":"code","26cce886":"code","d38625dc":"code","e9f8bfec":"code","6ce3d892":"code","526983c1":"code","3fd18a42":"markdown","93cc741e":"markdown","20dee6c7":"markdown","9ed64a75":"markdown","c67fa620":"markdown"},"source":{"61aacfe9":"import os\nimport pandas as pd\nimport numpy as np\nimport spacy\nimport time\n\nfrom spacy.lang.en.stop_words import STOP_WORDS\nfrom string import punctuation","26cce886":"classes = os.listdir('..\/input\/bbc-news-summary\/BBC News Summary\/News Articles')\narticles_d = '..\/input\/bbc-news-summary\/BBC News Summary\/News Articles\/'\nsummaries_d = '..\/input\/bbc-news-summary\/BBC News Summary\/Summaries\/'\n\narticles = []\nsummaries = []\nfile_arr = []\nfor cla in classes:\n    files = os.listdir(articles_d + cla)\n    for file in files:\n        article_file_path = articles_d + cla + '\/' + file\n        summary_file_path = summaries_d + cla + '\/' + file\n        try:\n            with open (article_file_path,'r') as f:\n                articles.append('.'.join([line.rstrip() for line in f.readlines()]))\n            with open (summary_file_path,'r') as f:\n                summaries.append('.'.join([line.rstrip() for line in f.readlines()]))\n            file_arr.append(cla + '\/' + file)\n        except:\n            pass\n            \ndf = pd.DataFrame({'File_path':file_arr,'Articles': articles,'Summaries':summaries})","d38625dc":"!pip install sumy\nimport sumy\nfrom sumy.parsers.html import HtmlParser\nfrom sumy.parsers.plaintext import PlaintextParser\nfrom sumy.nlp.tokenizers import Tokenizer\nfrom sumy.summarizers.lsa import LsaSummarizer \nfrom sumy.summarizers.lex_rank import LexRankSummarizer\nfrom sumy.nlp.stemmers import Stemmer\nfrom sumy.utils import get_stop_words\n\ndef summ(text):\n    SENTENCES_COUNT = 3\n    language = 'english'\n\n    summary_full = []\n    \n    parser = PlaintextParser.from_string(text, Tokenizer(language))\n    stemmer = Stemmer(language)\n    \n    summarizer = LexRankSummarizer(stemmer)\n    \n    summarizer.stop_words = get_stop_words(language)\n    \n    summary = []  \n    for sentence in summarizer(parser.document, SENTENCES_COUNT):\n        summary.append(str(sentence))\n\n    summary = ' '.join(summary)\n    summary_full.append(summary)\n        \n    return \" \".join(summary_full)","e9f8bfec":"!pip install rouge\nfrom rouge import Rouge","6ce3d892":"df[\"Sumy\"] = df[\"Articles\"].apply(summ)\n\nrouge = Rouge()\nscores = rouge.get_scores(df[\"Summaries\"], df[\"Sumy\"])\ndf_result = pd.DataFrame(scores)\ndf_result.head()","526983c1":"hyps, refs = map(list, [df[\"Summaries\"], df[\"Sumy\"]])\nrouge = Rouge()\n\nscores = rouge.get_scores(hyps, refs, avg=True)\nscores","3fd18a42":"Imports\n","93cc741e":"Resultados","20dee6c7":"Listas & Dataframe","9ed64a75":"Sumariza\u00e7\u00e3o","c67fa620":"Score"}}