{"cell_type":{"2524e009":"code","e707e96b":"code","49f72af7":"code","b1278919":"code","e3fba3da":"code","96d9737d":"code","6be5673d":"code","f24f5525":"code","1693a6d7":"code","980cb3b2":"code","7306bd1b":"code","20fd0f90":"code","56a434b3":"code","206ef1fc":"code","4d78408e":"code","fd30082d":"code","a18c35d6":"code","2fd9165b":"code","b32db6f0":"code","4f1a9e11":"code","4db8ed41":"code","260d05ec":"code","c7d69679":"code","59de5a7a":"code","06f76a9d":"code","b20121bd":"code","7bf039a5":"code","b5ca0b9b":"code","428d7b5c":"code","f453a97e":"code","a4a1bf39":"code","3c639561":"code","0bbae2bf":"code","6c2a0dff":"markdown","a5021eaa":"markdown","9b2f91e6":"markdown","df74b13c":"markdown","f2b0d07f":"markdown","b5f568ab":"markdown","a668b4c6":"markdown"},"source":{"2524e009":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","e707e96b":"from keras.datasets import cifar10\n\n(X_train, y_train), (X_test, y_test) = cifar10.load_data() #\u4f7f\u7528keras\u63d0\u4f9b\u7684api\u8bfb\u53d6\u6570\u636e\n\nnum_classes = 10\n#print(X_train.shape)\n#print(y_train.shape)\n#print(X_test.shape)\n#print(y_test.shape)","49f72af7":"X_train.shape","b1278919":"X_test.shape","e3fba3da":"y_train.shape","96d9737d":"y_test.shape","6be5673d":"i=1001\nplt.imshow(X_train[i])\nprint(y_train[i])\nplt.ioff()","f24f5525":"W_grid=15\nL_grid=15\nfig,axes = plt.subplots(L_grid,W_grid,figsize=(25,25))\naxes=axes.ravel()\nn_training=len(X_train)\nfor i in np.arange(0,L_grid * W_grid):\n    index=np.random.randint(0,n_training) #Pick a random number \n    axes[i].imshow(X_train[index])\n    axes[i].set_title(y_train[index]) #Prints labels on top of the picture\n    axes[i].axis('off')\nplt.subplots_adjust(hspace=0.4)","1693a6d7":"X_train=X_train.astype('float32')\nX_test=X_test.astype('float32')","980cb3b2":"number_cat=10","7306bd1b":"y_train","20fd0f90":"import keras\ny_train=keras.utils.to_categorical(y_train,number_cat)","56a434b3":"y_train","206ef1fc":"y_test=keras.utils.to_categorical(y_test,number_cat)","4d78408e":"y_test","fd30082d":"X_train=X_train\/255\nX_test=X_test\/255","a18c35d6":"X_train","2fd9165b":"X_train.shape","b32db6f0":"X_train","4f1a9e11":"X_train.shape","4db8ed41":"Input_shape = X_train.shape[1:]","260d05ec":"Input_shape","c7d69679":"from keras.models import Sequential \nfrom keras.layers import Conv2D,MaxPooling2D,AveragePooling2D,Dense,Flatten,Dropout\nfrom keras.optimizers import Adam\nfrom keras.callbacks import TensorBoard\n","59de5a7a":"cnn_model=Sequential()\ncnn_model.add(Conv2D(filters=64,kernel_size=(3,3),activation='relu',input_shape=Input_shape))\ncnn_model.add(Conv2D(filters=64,kernel_size=(3,3),activation='relu'))\ncnn_model.add(MaxPooling2D(2,2))\ncnn_model.add(Dropout(0.4))\n\ncnn_model.add(Conv2D(filters=128,kernel_size=(3,3),activation='relu'))\ncnn_model.add(Conv2D(filters=128,kernel_size=(3,3),activation='relu'))\ncnn_model.add(MaxPooling2D(2,2))\ncnn_model.add(Dropout(0.4))\n\ncnn_model.add(Flatten())\n\ncnn_model.add(Dense(units=1024,activation='relu'))\n\ncnn_model.add(Dense(units=1024,activation='relu'))\n\ncnn_model.add(Dense(units=10,activation='softmax'))","06f76a9d":"cnn_model.compile(loss='categorical_crossentropy',optimizer=keras.optimizers.rmsprop(lr=0.001),metrics=['accuracy'])","b20121bd":"history=cnn_model.fit(X_train,y_train,batch_size=32,epochs=2,shuffle=True)","7bf039a5":"evaluation=cnn_model.evaluate(X_test,y_test)\nprint('Test Accuracy: {}'.format(evaluation[1]))","b5ca0b9b":"predicted_classes=cnn_model.predict_classes(X_test)\npredicted_classes","428d7b5c":"y_test=y_test.argmax(1)","f453a97e":"y_test","a4a1bf39":"L=7\nW=7\nfig,axes=plt.subplots(L,W,figsize=(12,12))\naxes=axes.ravel()\n\nfor i in np.arange(0,L*W):\n    axes[i].imshow(X_test[i])\n    axes[i].set_title('Prediction= {}\\nTrue={}'.format(predicted_classes[i],y_test[i]))\n    axes[i].axis('off')\n    plt.subplots_adjust(wspace=1)","3c639561":"from sklearn.metrics import confusion_matrix\nimport seaborn as sns\ncm= confusion_matrix(y_test,predicted_classes)\ncm\nplt.figure(figsize=(10,10))\nsns.heatmap(cm,annot=True)\nplt.ioff()","0bbae2bf":"#import os \n#directory=os.path.join(os.getcwd(),'saved_models')\n\n#if not os.path.isdir(directory):\n#    os.makedirs(directory)\n#model_path=os.path.join(directory,'keras_cifar10_trained_model.h5')\n#cnn_model.save(model_path)","6c2a0dff":"**Data Vizualization**","a5021eaa":"**Train the model**","9b2f91e6":"CIFAR10 (Canadian institute for advanced research) is a very famous dataset which has 10 classes.We will make a program to classify the images.This kernel is a work in process.If you like my work please do vote \n0-Aeroplane,1-Car,2-Bird,3-Cat,4-Deer,5-Dog,6-Frog,7-Hoarse,8-Boat,9-Truck","df74b13c":"**Data Preparation**","f2b0d07f":"**Evaluate the model**","b5f568ab":"**Importing modules **","a668b4c6":"**Saving the model **"}}