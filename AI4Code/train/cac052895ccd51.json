{"cell_type":{"0d5f0047":"code","74a512e6":"code","43c2326c":"code","11d89952":"code","20c44a60":"code","cf6d81ab":"code","5b1f6e8b":"code","3e250407":"code","afa554ee":"code","a97d6252":"code","b46fe9d0":"code","a0e4f969":"code","f16ffad9":"code","daae4531":"code","6039f13f":"code","a53343dd":"code","a6f6512e":"code","ce8e64d9":"code","bc8ed27f":"code","8c3ef31f":"code","3405d64d":"code","4dd6ddf5":"code","e377a229":"code","91de3264":"code","ab71726e":"code","2a15e6c4":"code","af418887":"code","b5af3906":"code","fcd491f0":"code","1d2ad03f":"code","a89ab0f4":"code","66bbc045":"code","937082ea":"code","0471f6e2":"code","85a3ee9f":"code","6221e35e":"code","12ce052f":"code","8e0351f3":"code","42c69081":"code","bd45960e":"code","ba5e1304":"code","bf0ed120":"code","c0fbeee1":"code","a8df5708":"code","ca4b46cd":"code","1eae04f2":"code","1402e784":"code","d4012f29":"code","ac3e639f":"code","6ce64f4f":"code","c39e60f9":"code","1ecb62e0":"code","0b42163f":"code","a1a4ba6d":"code","c23ddade":"code","4ecfa3d9":"code","92ee762a":"code","3f116f4e":"code","c1b596db":"code","a224fc4d":"code","23426376":"code","9f884f92":"code","766f68fc":"code","07f36206":"code","8edf0c14":"code","274dbc65":"code","cf26d893":"code","81be170e":"code","ae63b849":"code","2a078d95":"code","0dcef71a":"code","35402d6c":"code","e80c79c4":"code","796008c7":"code","bab9b9bd":"code","3e61ad91":"code","a2e7b960":"code","c3eb024c":"code","d9ac2244":"code","eff3fff3":"code","a845337b":"code","5982893a":"code","cb6b406e":"code","cfb56f4f":"code","b6d1e0f0":"code","b0771207":"code","c9440e36":"code","2c088510":"code","fe26095e":"code","8c4f455f":"code","9a7db568":"code","0eb128e3":"code","7a0c4bd3":"code","294e5427":"code","2c8944fd":"code","5d424504":"code","470caf90":"code","484c4d3b":"code","3e642318":"code","754555be":"code","3de2bddc":"code","a2957970":"code","b6d6d8dc":"code","20dcc93a":"code","ec6c15a1":"code","2754b5af":"code","4137ac67":"code","eaadef79":"code","4691fbee":"code","c26a4021":"code","98534152":"code","e85d49e6":"code","3a804e0d":"code","c90a35e5":"code","4b2bf19e":"code","affd5d7e":"code","7d11ac11":"code","46073edb":"code","0b5b40ce":"code","e2bc56f5":"code","f88fea4e":"code","718ab896":"code","194793f3":"code","22d05068":"code","47f54b38":"code","ada9d828":"code","453a7bd2":"code","4e21979e":"code","d056de20":"code","d9da5edf":"code","0996ff7c":"code","30753055":"code","87c5ec97":"code","313578d3":"code","549efa05":"code","f8b30123":"code","9669a7a7":"code","e133f618":"code","990751d2":"code","7662c375":"code","bf03a3e5":"markdown","1cdd2119":"markdown","9738609a":"markdown","dc5c4dcd":"markdown","5dcc0cdc":"markdown","4f9bd23f":"markdown","e243c24b":"markdown","12d21518":"markdown","301b548b":"markdown"},"source":{"0d5f0047":"import numpy as np \nimport pandas as pd \nfrom IPython.display import Image\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.decomposition import PCA\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_squared_error, r2_score\nimport seaborn as sns\nimport scipy.stats as stats\nfrom sklearn.preprocessing import StandardScaler\nimport os\n","74a512e6":"Image(\"..\/input\/outputpng\/housesbanner.png\")","43c2326c":"datatrain = pd.read_csv('..\/input\/houses-prices\/train.csv')\ndatatest = pd.read_csv('..\/input\/houses-prices\/test.csv')","11d89952":"datatrain.head()\n","20c44a60":"datatest.head()","cf6d81ab":"prices=datatrain[\"SalePrice\"]","5b1f6e8b":"data=pd.concat([datatrain,datatest], sort=False)","3e250407":"data = data.drop(\"SalePrice\", 1)","afa554ee":"prices.describe()","a97d6252":"plt.hist(prices, bins=30)\nplt.title(\"Price distributions\")","b46fe9d0":"plt.figure(1); plt.title('Johnson SU')\nsns.distplot(datatrain['SalePrice'], kde=False, fit=stats.johnsonsu)\nplt.figure(2); plt.title('Normal')\nsns.distplot(datatrain['SalePrice'], kde=False, fit=stats.norm)\nplt.figure(3); plt.title('Log Normal')\nsns.distplot(datatrain['SalePrice'], kde=False, fit=stats.lognorm)","a0e4f969":"display(data.describe().transpose())","f16ffad9":"sns.set_style(\"whitegrid\")\nmissing = data.isnull().sum()\nmissing = missing[missing > 0]\nmissing.sort_values(inplace=True)\nmissing.plot.bar()","daae4531":"# I delete same variables that contain NA \ndata=data.drop(\"Id\", 1)\ndata=data.drop(\"Alley\", 1)\ndata=data.drop(\"Fence\", 1)\ndata=data.drop(\"MiscFeature\", 1)\ndata=data.drop(\"PoolQC\", 1)\n#data=data.drop(\"FireplaceQu\", 1)","6039f13f":"#FireplaceQu\ndata[['Fireplaces','FireplaceQu']].head(10)\n","a53343dd":"data['FireplaceQu'].isnull().sum()","a6f6512e":"data['Fireplaces'].value_counts()","ce8e64d9":"data['FireplaceQu']=data['FireplaceQu'].fillna('NO')\ndata['FireplaceQu'].unique()","bc8ed27f":"#LotFrontage\ndata[\"LotFrontage\"] = data[\"LotFrontage\"].fillna(value=data['LotFrontage'].mean())","8c3ef31f":"#Garage\ndata['GarageYrBlt'].isnull().sum()","3405d64d":"data['GarageType'].isnull().sum()","4dd6ddf5":"data['GarageFinish'].isnull().sum()","e377a229":"data['GarageQual'].isnull().sum()","91de3264":"data['GarageCond'].isnull().sum()","ab71726e":"data[\"GarageArea\"].value_counts()","2a15e6c4":"data['GarageType']=data['GarageType'].fillna('NO')\ndata['GarageCond']=data['GarageCond'].fillna('NO')\ndata['GarageFinish']=data['GarageFinish'].fillna('NO')\ndata['GarageYrBlt']=data['GarageYrBlt'].fillna('NO')\ndata['GarageQual']=data['GarageQual'].fillna('NO')","af418887":"#Bsmt\ndata.BsmtFinType2.isnull().sum()","b5af3906":"data.BsmtExposure.isnull().sum()","fcd491f0":"data.BsmtFinType1.isnull().sum()","1d2ad03f":"data.BsmtCond.isnull().sum() ","a89ab0f4":"data.BsmtQual.isnull().sum()","66bbc045":"data.TotalBsmtSF.value_counts().head()","937082ea":"data['BsmtFinType2']=data['BsmtFinType2'].fillna('NO')\ndata['BsmtExposure']=data['BsmtExposure'].fillna('NO')\ndata['BsmtFinType1']=data['BsmtFinType1'].fillna('NO')\ndata['BsmtCond']=data['BsmtCond'].fillna('NO')\ndata['BsmtQual']=data['BsmtQual'].fillna('NO')","0471f6e2":"#Masvmr\ndata['MasVnrArea'] = data['MasVnrArea'].fillna(data['MasVnrArea'].mean())","85a3ee9f":"data['MasVnrType'].unique()","6221e35e":"data['MasVnrType']=data['MasVnrType'].fillna('None')","12ce052f":"#Electrical\ndata['Electrical']=data['Electrical'].fillna('Mix')","8e0351f3":"datatrain=datatrain.drop(\"Id\", 1)\ndatatrain=datatrain.drop(\"Alley\", 1)\ndatatrain=datatrain.drop(\"Fence\", 1)\ndatatrain=datatrain.drop(\"MiscFeature\", 1)\ndatatrain=datatrain.drop(\"PoolQC\", 1)\n#data=data.drop(\"FireplaceQu\", 1)","42c69081":"quantitative = datatrain._get_numeric_data()","bd45960e":"quantitative = datatrain._get_numeric_data()","ba5e1304":"sns.boxplot([data.MSSubClass])","bf0ed120":"sns.boxplot([data.LotFrontage])","c0fbeee1":"data['LotFrontage']= data['LotFrontage'].clip(data['LotFrontage'].quantile(0.01),data['LotFrontage'].quantile(0.99))","a8df5708":"sns.boxplot(data.LotFrontage)","ca4b46cd":"sns.boxplot([data.LotArea])","1eae04f2":"data['LotArea']= data['LotArea'].clip_upper(data['LotArea'].quantile(0.99)) ","1402e784":"sns.boxplot([data.LotArea])","d4012f29":"sns.boxplot([data.MasVnrArea])","ac3e639f":"data['MasVnrArea']= data['MasVnrArea'].clip_upper(data['MasVnrArea'].quantile(0.99)) ","6ce64f4f":"sns.boxplot([data.MasVnrArea])","c39e60f9":"sns.boxplot([data.BsmtFinSF1])","1ecb62e0":"data['BsmtFinSF1']= data['BsmtFinSF1'].clip_upper(data['BsmtFinSF1'].quantile(0.99))","0b42163f":"sns.boxplot([data.BsmtFinSF1])","a1a4ba6d":"sns.boxplot([data.BsmtFinSF2])","c23ddade":"data['BsmtFinSF2']= data['BsmtFinSF2'].clip_upper(data['BsmtFinSF2'].quantile(0.99))","4ecfa3d9":"sns.boxplot([data.BsmtFinSF2])","92ee762a":"sns.boxplot([data.BsmtUnfSF])","3f116f4e":"data['BsmtUnfSF']= data['BsmtUnfSF'].clip_upper(data['BsmtUnfSF'].quantile(0.99))","c1b596db":"sns.boxplot([data.BsmtUnfSF])","a224fc4d":"sns.boxplot([data.TotalBsmtSF])","23426376":"data['TotalBsmtSF']= data['TotalBsmtSF'].clip_upper(data['TotalBsmtSF'].quantile(0.99))","9f884f92":"sns.boxplot([data.TotalBsmtSF])","766f68fc":"sns.boxplot(data[\"1stFlrSF\"])","07f36206":"data['1stFlrSF']= data['1stFlrSF'].clip_upper(data['1stFlrSF'].quantile(0.99))","8edf0c14":"sns.boxplot(data[\"1stFlrSF\"])","274dbc65":"sns.boxplot(data[\"2ndFlrSF\"])","cf26d893":"data['2ndFlrSF']= data['2ndFlrSF'].clip_upper(data['2ndFlrSF'].quantile(0.99))","81be170e":"sns.boxplot(data[\"2ndFlrSF\"])","ae63b849":"sns.boxplot(data.LowQualFinSF)","2a078d95":"sns.boxplot(data.GrLivArea)","0dcef71a":"data['GrLivArea']= data['GrLivArea'].clip_upper(data['GrLivArea'].quantile(0.99))","35402d6c":"sns.boxplot(data.GrLivArea)","e80c79c4":"sns.boxplot(data.BsmtFullBath)","796008c7":"sns.boxplot(data.BsmtHalfBath)","bab9b9bd":"sns.boxplot(data.BedroomAbvGr)","3e61ad91":"data['BedroomAbvGr']= data['BedroomAbvGr'].clip_upper(data['BedroomAbvGr'].quantile(0.99))","a2e7b960":"sns.boxplot(data.BedroomAbvGr)","c3eb024c":"sns.boxplot(data.KitchenAbvGr)","d9ac2244":"sns.boxplot(data.TotRmsAbvGrd)","eff3fff3":"sns.boxplot(data.Fireplaces)","a845337b":"sns.boxplot(data.GarageCars)","5982893a":"sns.boxplot(data.GarageArea)","cb6b406e":"data['GarageArea']= data['GarageArea'].clip_upper(data['GarageArea'].quantile(0.99))","cfb56f4f":"sns.boxplot(data.GarageArea)","b6d1e0f0":"sns.boxplot(data.WoodDeckSF)","b0771207":"data['WoodDeckSF']= data['WoodDeckSF'].clip_upper(data['WoodDeckSF'].quantile(0.99))","c9440e36":"sns.boxplot(data.WoodDeckSF)","2c088510":"sns.boxplot(data.OpenPorchSF)","fe26095e":"data['OpenPorchSF']= data['OpenPorchSF'].clip_upper(data['OpenPorchSF'].quantile(0.99))","8c4f455f":"sns.boxplot(data.OpenPorchSF)","9a7db568":"sns.boxplot(data.EnclosedPorch)","0eb128e3":"data['EnclosedPorch']= data['EnclosedPorch'].clip_upper(data['EnclosedPorch'].quantile(0.99))","7a0c4bd3":"sns.boxplot(data.EnclosedPorch)","294e5427":"sns.boxplot(data['3SsnPorch'])","2c8944fd":"data['3SsnPorch']= data['3SsnPorch'].clip_upper(data['3SsnPorch'].quantile(0.99))","5d424504":"sns.boxplot(data['3SsnPorch'])","470caf90":"sns.boxplot(data['ScreenPorch'])","484c4d3b":"data['ScreenPorch']= data['ScreenPorch'].clip_upper(data['ScreenPorch'].quantile(0.99))","3e642318":"sns.boxplot(data['ScreenPorch'])","754555be":"sns.boxplot(data['PoolArea'])","3de2bddc":"data['PoolArea']= data['PoolArea'].clip_upper(data['PoolArea'].quantile(0.99))","a2957970":"sns.boxplot(data['PoolArea'])","b6d6d8dc":"sns.boxplot(data['MiscVal'])","20dcc93a":"data['MiscVal']= data['MiscVal'].clip_upper(data['MiscVal'].quantile(0.99))","ec6c15a1":"sns.boxplot(data['MiscVal'])","2754b5af":"sns.boxplot(data['MoSold'])","4137ac67":"sns.boxplot(data['YrSold'])","eaadef79":"sns.boxplot(prices)","4691fbee":"prices=prices.clip(prices.quantile(0.01),prices.quantile(0.99))","c26a4021":"sns.boxplot(prices)","98534152":"num_corr=quantitative.corr()\nplt.subplots(figsize=(30,15))\nsns.heatmap(num_corr,annot = True,robust=True)\nplt.text(15,0, \"Heat Map\", fontsize = 70, color='Black', fontstyle='italic')","e85d49e6":"data = pd.get_dummies(data)\ndata.head()","3a804e0d":"data_ = np.log1p(data)# convert distributed data to log 1p \nprices = np.log1p(prices)# convert distributed data to log 1p","c90a35e5":"from sklearn.impute import SimpleImputer # cualitative missing values (cualitative and cuantitative)\nimp = SimpleImputer(missing_values = np.nan, strategy='most_frequent')\ndata = imp.fit_transform(data)","4b2bf19e":"scaler = StandardScaler()\nscaler.fit(data)                \np_data = scaler.transform(data)\np_data","affd5d7e":"pca = PCA(whiten=True)\npca.fit(p_data)","7d11ac11":"np.exp(pca.explained_variance_ratio_)","46073edb":"pca = PCA(n_components=45,whiten=True)\npca = pca.fit(p_data)\ndataPCA = pca.transform(p_data)\ndataPCA","0b5b40ce":"dataPCA.shape","e2bc56f5":"dataPCA1 = dataPCA[:1460,:]#row \ndataPCA1.shape\ndatatest1 = dataPCA[1460:,:]#row\ndatatest1.shape","f88fea4e":"linear = LinearRegression()\nlinear.fit(dataPCA1,prices)","718ab896":"X_train , X_test, Y_train, Y_test = train_test_split(dataPCA1,prices,test_size=0.20,random_state=2019)","194793f3":"y_pred = linear.predict(X_test)","22d05068":"r2_score(Y_test, y_pred)","47f54b38":"np.expm1(linear.intercept_)","ada9d828":"np.expm1(linear.coef_)","453a7bd2":"np.expm1(Y_test)\nnp.expm1(y_pred)","4e21979e":"rmse = np.sqrt(mean_squared_error(Y_test, y_pred))\nrmse","d056de20":"y_predtestint = linear.predict(datatest1)\nnp.exp(y_predtestint)","d9da5edf":"prices1=prices[:1459]\nprices1.shape","0996ff7c":"%matplotlib inline\nplt.plot(np.expm1(prices1),np.expm1(y_predtestint), \"ro\")\nplt.title(\"Valor Actual vs Predicci\u00f3n\")","30753055":"plt.hist( np.expm1(prices), bins=30)\nplt.title(\"Distribuci\u00f3n de precios\")","87c5ec97":"plt.hist( np.exp(y_predtestint), bins=50)\nplt.title(\"Distribuci\u00f3n de predici\u00f3n de precios\")","313578d3":"Pricespred= np.exp(y_predtestint)","549efa05":"output= {\"Id\": datatest.iloc[:,0], \"SalePrice\": Pricespred}\noutput","f8b30123":"submission = pd.DataFrame(output)\nsubmission","9669a7a7":"submission.set_index( \"Id\",inplace=True) # Delete index","e133f618":"pd.DataFrame.to_csv(submission,index=False,sep=\",\")","990751d2":"filename = \"submission.csv\"","7662c375":"submission.head()","bf03a3e5":"### Data Types","1cdd2119":"### Check for null and missing ","9738609a":"### Data test Prediction","dc5c4dcd":"### Outliers","5dcc0cdc":"### Model\n#### Linear Regression","4f9bd23f":"### PCA","e243c24b":"### Out file csv","12d21518":"### Data analysis\n","301b548b":"### Dummy variables and missing values"}}