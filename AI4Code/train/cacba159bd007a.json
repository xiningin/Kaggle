{"cell_type":{"94d16cfa":"code","049537a7":"code","8ab57fc7":"code","68572910":"code","05d2eff4":"code","a47cd98d":"code","0673c31f":"markdown"},"source":{"94d16cfa":"import numpy as np\nimport pandas as pd\nimport os\nfrom sklearn.model_selection import *\nimport warnings\nwarnings.filterwarnings('ignore')","049537a7":"train = pd.read_csv('..\/input\/petfinder-pawpularity-score\/train.csv')","8ab57fc7":"# Simple KFold - 5 folds\n\nkfold = KFold(n_splits=5, shuffle=True, random_state=42)\nprint('Train Mean | Train Std | Valid Mean | Valid Std')\nprint('-'*48)\nfor i, (t, v) in enumerate(kfold.split(train)):\n    print(f'{train.Pawpularity.iloc[t].mean():.7f} | {train.Pawpularity.iloc[t].std():.6f} | {train.Pawpularity.iloc[v].mean():.7f} | {train.Pawpularity.iloc[v].std():.7f}')","68572910":"# StratifiedKFold no bins - 5 folds\n\nkfold = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)\nprint('Train Mean | Train Std | Valid Mean | Valid Std')\nprint('-'*48)\nfor i, (t, v) in enumerate(kfold.split(train, train.Pawpularity)):\n    print(f'{train.Pawpularity.iloc[t].mean():.7f} | {train.Pawpularity.iloc[t].std():.6f} | {train.Pawpularity.iloc[v].mean():.7f} | {train.Pawpularity.iloc[v].std():.7f}')","05d2eff4":"# StratifiedKFold w\/ bins (Sturge's Rule) - 5 folds\n\nkfold = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)\nbins = pd.cut(train.Pawpularity, bins=int(1 + np.log2(len(train))), labels=False)\nprint('Train Mean | Train Std | Valid Mean | Valid Std')\nprint('-'*48)\nfor i, (t, v) in enumerate(kfold.split(train, bins)):\n    print(f'{train.Pawpularity.iloc[t].mean():.7f} | {train.Pawpularity.iloc[t].std():.6f} | {train.Pawpularity.iloc[v].mean():.7f} | {train.Pawpularity.iloc[v].std():.7f}')","a47cd98d":"# StratifiedKFold w\/ bins (quantiles) - 5 folds\n\nkfold = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)\nbins = pd.qcut(train.Pawpularity, q=50, labels=False, duplicates='drop')\nprint('Train Mean | Train Std | Valid Mean | Valid Std')\nprint('-'*48)\nfor i, (t, v) in enumerate(kfold.split(train, bins)):\n    print(f'{train.Pawpularity.iloc[t].mean():.7f} | {train.Pawpularity.iloc[t].std():.6f} | {train.Pawpularity.iloc[v].mean():.7f} | {train.Pawpularity.iloc[v].std():.7f}')","0673c31f":"Let me know which is best \/ worst and why!"}}