{"cell_type":{"c662baa4":"code","934a7339":"code","87c388ac":"code","317f3ee7":"code","88cde272":"code","b5722a05":"code","f80ddd2f":"code","f6a54efc":"code","a6c282a1":"code","97dbe412":"code","939eec2c":"markdown","72f7b969":"markdown","cc88d9d5":"markdown","717a700d":"markdown"},"source":{"c662baa4":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom torch.utils.data import Dataset, DataLoader\nimport cv2\nimport os\nimport cv2","934a7339":"# base bath for kaggle\npath = '\/kaggle\/input\/images-alike\/'","87c388ac":"# load the validate dataset\ndf = pd.read_csv(path + 'validate.csv', index_col=0)\ndf.head()","317f3ee7":"def draw_pair_similars(df, idx):\n    dim = (300, 300)\n    img_a = cv2.imread(path + 'images\/' + str(df.iloc[idx]['image_a']) + '.jpg')\n    img_a = cv2.resize(img_a, dim, interpolation = cv2.INTER_AREA)\n    \n    img_b = cv2.imread(path + 'images\/' + str(df.iloc[idx]['image_b']) + '.jpg')\n    img_b = cv2.resize(img_b, dim, interpolation = cv2.INTER_AREA)\n    \n    imgs = [img_a, img_b]\n    \n    f, ax = plt.subplots(1, 2, figsize=(12, 12))\n    for ix, img in enumerate(imgs):\n        ax[ix].imshow(img)\n        ax[ix].axis('off')\n        \n    plt.subplots_adjust(wspace=0, hspace=0)\n    plt.show()","88cde272":"draw_pair_similars(df, 84)","b5722a05":"class AlikeDataset(Dataset):\n\n    def __init__(self, path, transform=None):\n        self.path = path + 'images\/'\n        self.files = self.absolute_file_paths(self.path)\n        self.transform = transform\n        \n    def absolute_file_paths(self, directory):\n        path = os.path.abspath(directory)\n        return [entry.path for entry in os.scandir(path) if entry.is_file()]\n\n    def __len__(self):\n        return len(self.files)\n\n    def __getitem__(self, idx):\n\n        img_path = self.files[idx]\n        image = cv2.imread(img_path)\n\n        if self.transform:\n            image = self.transform(image)\n\n        return image","f80ddd2f":"alike_ds = AlikeDataset(path)","f6a54efc":"plt.figure(figsize = (10,10))\nplt.imshow(alike_ds[0])","a6c282a1":"# initialize a data loader to split data into batches\nalike_loader = DataLoader(alike_ds, batch_size=8, shuffle=True, num_workers=0)","97dbe412":"# test the loader\nimages = next(iter(alike_loader))\nprint(images.shape)","939eec2c":"<h1 align=center style='color:blue; border:1px dotted blue;'>Images Alike Startup Notebook<\/h1>","72f7b969":"# Images Loader","cc88d9d5":"# Load Data","717a700d":"# Dataset Model"}}