{"cell_type":{"1b9b7445":"code","5752d026":"code","a5b3619b":"code","b9ab4ae2":"code","bd0c40bb":"code","713ef06d":"code","b0d03293":"code","a1b2e3cd":"code","a96cf1c0":"code","209083d8":"code","2b85509a":"code","47f25a4c":"code","27ce99ad":"code","3a836fca":"code","a7e905da":"code","7328165c":"code","ff2307f0":"code","bf242387":"code","567e878f":"code","21daaba4":"code","25281f8d":"code","8be7c3bc":"code","27416e43":"code","218c4e8e":"code","3853c903":"code","4244698a":"code","51e2a21a":"code","e0b2d185":"markdown","eeb9f934":"markdown","d20572c6":"markdown","34685c64":"markdown","1986628b":"markdown","c0b98765":"markdown","ff0f2201":"markdown","fb041d5e":"markdown","2d986579":"markdown"},"source":{"1b9b7445":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n# Import plotting modules\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.ensemble import GradientBoostingRegressor, RandomForestRegressor, VotingRegressor\n\nfrom sklearn.neural_network import MLPRegressor\n\n\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.model_selection import train_test_split\nimport numpy as np\nfrom sklearn import metrics\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) \n# that gets preserved as output when you create a version using \"Save & Run All\"\n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","5752d026":"df = pd.read_csv('..\/input\/us-counties-covid-19-dataset\/us-counties.csv')\ndf['date'] = pd.to_datetime(df.date)\ndf['date1'] = df['date'].dt.strftime(\"%Y%m%d\").astype(int)\ndf2 = df\n\ndf2a = df2[df2['date'] == df['date'].max()]\ndf2a = df2a.groupby(['state','county'])[['deaths','cases']].sum()\ndf2ab = df2a.sort_values(['deaths','state'])\ndf2ac = df2a.sort_values(['cases','state'])\ndf2ab = df2ab.reset_index() ## 30 Most Death Counties\ndf2ac = df2ac.reset_index() ## 30 Most Cases Counties\ndf2ab = df2ab.tail(30)\ndf2ac = df2ac.tail(30)\n\n\ndf_a = df2.groupby(['state','county'])[['deaths','cases']].sum()\ndf_b = df_a.sort_values(['deaths','state'])\ndf_c = df_a.sort_values(['cases','state'])\n\ndf_b = df_b.tail(30) ## 30 Most Death Counties\ndf_c = df_c.tail(30) ## 30 Most Cases Counties\n\n\n\ndf_b = df_b.reset_index() ## 30 Most Death Counties\ndf_c = df_c.reset_index() ## 30 Most Cases Counties\n\n\ndf_aa = (df_b['state'].unique()) ## 30 Most Death Counties\ndf_ab = (df_c['state'].unique()) ## 30 Most Cases Counties\n\nd1 = {} ## 30 Most Death Counties\nd2 = {} ## 30 Most Cases Counties\nfor a in df_aa:\n    d1[a] = []\n    b = df_b.loc[(df_b['state'] == a),'county']\n    for aa in b:\n        d1[a].append(aa)\n\nfor a in df_ab:\n    d2[a] = []\n    b = df_c.loc[(df_c['state'] == a),'county']\n    for aa in b:\n        d2[a].append(aa)\n        ","a5b3619b":"df_all = df\ndf_all = df_all.groupby(['date'])[['deaths','cases']].sum()\ndf_alll = df_all\n\ndf_all = df_all.reset_index()\ndf_al = df_all[df_all['date'] == df_all['date'].max()]\ndf_al","b9ab4ae2":"df_all_1 = df_alll.diff(axis=0)\ndf_all_1 = df_all_1.reset_index()\ndf_all_1 = df_all_1.reset_index()\nprint(df_all_1.tail())\n","bd0c40bb":"titleaa = 'US' \ntitlea = 'Deaths vs Date'\ntitleb = 'Cases vs Date'\n# Set default Seaborn style\nfig, axes = plt.subplots(2,1 , figsize=(15, 5), sharex= True)\nfig.suptitle(titleaa)\nsns.regplot(ax=axes[0], x = 'index', y= 'deaths', data = df_all_1)\naxes[0].set_title(titlea)\nsns.regplot(ax=axes[1], x = 'index', y= 'cases', data = df_all_1)\naxes[1].set_title(titleb)\nplt.show()","713ef06d":"x = df_all_1.iloc[1:,0].values.reshape(-1,1)\ny = df_all_1.iloc[1:,2].values.reshape(-1,1)\ny2 = df_all_1.iloc[1:,3].values.reshape(-1,1)\n\nmax_x = x.max()\nx_future = max_x + 10\nx2 = np.arange(max_x,x_future).reshape(-1,1)\n\n# Create training and test sets\nX_train, X_test, y_train, y_test = train_test_split(x, y,test_size = 0.3, random_state=42)\n\n# Create training and test sets\nX_train2, X_test2, y_train2, y_test2 = train_test_split(x, y2,test_size = 0.3, random_state=42)","b0d03293":"reg1 = GradientBoostingRegressor(random_state=1, n_estimators=10)\nreg2 = RandomForestRegressor(random_state=1, n_estimators=10)\nreg3 = LinearRegression()\nereg = VotingRegressor(estimators=[('gb', reg1), ('rf', reg2), ('lr', reg3)])\n\nereg = ereg.fit(X_train, y_train)\ny_pred_death = ereg.predict(X_test)\nx_22 = ereg.predict(x2)\nx_22 = np.rint(x_22)\nprint('################# Deaths in next 10 Days #################')\nprint(x_22)\n\nprint('#########Deaths Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y_test, y_pred_death))\nprint('Mean Squared Error:', metrics.mean_squared_error(y_test, y_pred_death))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test, y_pred_death)))\nprint('R^2:', np.sqrt(metrics.r2_score(y_test, y_pred_death)))\n\nereg = ereg.fit(X_train2, y_train2)\ny_pred_cases = ereg.predict(X_test2)\nx_22 = ereg.predict(x2)\nx_22 = np.rint(x_22)\nprint('################# Cases in next 10 Days #################')\nprint(x_22)\nprint('#########Cases Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y_test2, y_pred_cases))\nprint('Mean Squared Error:', metrics.mean_squared_error(y_test2, y_pred_cases))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test2, y_pred_cases)))\nprint('R^2:', np.sqrt(metrics.r2_score(y_test2, y_pred_cases)))","a1b2e3cd":"l1 = LinearRegression()\nl1.fit(X_train,y_train)\ny_pred_death = l1.predict(X_test)\n\nprint('################# Deaths in next 10 Days #################')\nx_22 = l1.predict(x2)\nx_22 = np.rint(x_22)\nprint(x_22)\n\nl1.fit(X_train2,y_train2)\ny_pred_cases = l1.predict(X_test2)\nprint('################# Cases in next 10 Days #################')\nx_22 = l1.predict(x2)\nx_22 = np.rint(x_22)\nprint(x_22)\n\n\nplt.scatter(x,y)\nplt.plot(X_test,y_pred_death,color='red')\nplt.title('Linear Regression')\nplt.xlabel('Days')\nplt.ylabel('Deaths')\nplt.show()\nplt.scatter(x,y2)\nplt.plot(X_test2,y_pred_cases,color='red')\nplt.title('Linear Regression')\nplt.xlabel('Days')\nplt.ylabel('Cases')\nplt.show()\n\n\nprint('#########Deaths Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y_test, y_pred_death))\nprint('Mean Squared Error:', metrics.mean_squared_error(y_test, y_pred_death))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test, y_pred_death)))\nprint('R^2:', np.sqrt(metrics.r2_score(y_test, y_pred_death)))\n\nprint('#########Cases Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y_test2, y_pred_cases))\nprint('Mean Squared Error:', metrics.mean_squared_error(y_test2, y_pred_cases))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test2, y_pred_cases)))\nprint('R^2:', np.sqrt(metrics.r2_score(y_test2, y_pred_cases)))","a96cf1c0":"max_x = x.max()\nx_future = max_x + 10\nx2 = np.arange(max_x,x_future).reshape(-1,1)\n\npoly_reg = PolynomialFeatures(degree=4)\n\nx = df_all_1.iloc[1:,0].values.reshape(-1,1)\npoly_x = poly_reg.fit_transform(x)\n\ny = df_all_1.iloc[1:,2].values.reshape(-1,1)\ny2 = df_all_1.iloc[1:,3].values.reshape(-1,1)\n\nl1 = LinearRegression()\nl1.fit(poly_x,y)\ny_pred_death = l1.predict(poly_x)\n\nprint('################# Deaths in next 10 Days #################')\nx_22 = l1.predict(poly_reg.fit_transform(x2))\nx_22 = np.rint(x_22)\nprint(x_22)\n\nl1.fit(poly_x,y2)\ny_pred_cases = l1.predict(poly_x)\nprint('################# Cases in next 10 Days #################')\nx_22 = l1.predict(poly_reg.fit_transform(x2))\nx_22 = np.rint(x_22)\nprint(x_22)\n\n\nplt.scatter(x,y)\nplt.plot(x,y_pred_death,color='red')\nplt.title('4th Polynomial Regression')\nplt.xlabel('Days')\nplt.ylabel('Deaths')\nplt.show()\nplt.scatter(x,y2)\nplt.plot(x,y_pred_cases,color='red')\nplt.title('4th Polynomial Regression')\nplt.xlabel('Days')\nplt.ylabel('Cases')\nplt.show()\n\nprint('#########Deaths Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y, y_pred_death))\nprint('Mean Squared Error:', metrics.mean_squared_error(y, y_pred_death))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y, y_pred_death)))\nprint('R^2:', np.sqrt(metrics.r2_score(y, y_pred_death)))\n\nprint('#########Cases Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y2, y_pred_cases))\nprint('Mean Squared Error:', metrics.mean_squared_error(y2, y_pred_cases))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y2, y_pred_cases)))\nprint('R^2:', np.sqrt(metrics.r2_score(y2, y_pred_cases)))","209083d8":"max_x = x.max()\nx_future = max_x + 10\nx2 = np.arange(max_x,x_future).reshape(-1,1)\n\npoly_reg = PolynomialFeatures(degree=8)\n\nx = df_all_1.iloc[1:,0].values.reshape(-1,1)\npoly_x = poly_reg.fit_transform(x)\n\ny = df_all_1.iloc[1:,2].values.reshape(-1,1)\ny2 = df_all_1.iloc[1:,3].values.reshape(-1,1)\n\nl1 = LinearRegression()\nl1.fit(poly_x,y)\ny_pred_death = l1.predict(poly_x)\n\nprint('################# Deaths in next 10 Days #################')\nx_22 = l1.predict(poly_reg.fit_transform(x2))\nx_22 = np.rint(x_22)\nprint(x_22)\n\nl1.fit(poly_x,y2)\ny_pred_cases = l1.predict(poly_x)\nprint('################# Cases in next 10 Days #################')\nx_22 = l1.predict(poly_reg.fit_transform(x2))\nx_22 = np.rint(x_22)\nprint(x_22)\n\n\nplt.scatter(x,y)\nplt.plot(x,y_pred_death,color='red')\nplt.title('8th Polynomial Regression')\nplt.xlabel('Days')\nplt.ylabel('Deaths')\nplt.show()\nplt.scatter(x,y2)\nplt.plot(x,y_pred_cases,color='red')\nplt.title('8th Polynomial Regression')\nplt.xlabel('Days')\nplt.ylabel('Cases')\nplt.show()\n\nprint('#########Deaths Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y, y_pred_death))\nprint('Mean Squared Error:', metrics.mean_squared_error(y, y_pred_death))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y, y_pred_death)))\nprint('R^2:', np.sqrt(metrics.r2_score(y, y_pred_death)))\n\nprint('#########Cases Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y2, y_pred_cases))\nprint('Mean Squared Error:', metrics.mean_squared_error(y2, y_pred_cases))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y2, y_pred_cases)))\nprint('R^2:', np.sqrt(metrics.r2_score(y2, y_pred_cases)))","2b85509a":"x = df_all_1.iloc[1:,0].values.reshape(-1,1)\ny = df_all_1.iloc[1:,2].values.reshape(-1,1)\ny2 = df_all_1.iloc[1:,3].values.reshape(-1,1)\n\nmax_x = x.max()\nx_future = max_x + 10\nx2 = np.arange(max_x,x_future).reshape(-1,1)\n\n\nregr = MLPRegressor(random_state=1, hidden_layer_sizes=(100, 100,100,100, 100,100), max_iter=500).fit(x, y)\ny_pred_death = regr.predict(x)\n\nprint('################# Deaths in next 10 Days #################')\nx_22 = regr.predict(x2)\nx_22 = np.rint(x_22)\nprint(x_22)\n\n\nregr = MLPRegressor(random_state=1, hidden_layer_sizes=(100, 100,100,100, 100,100), max_iter=500).fit(x, y2)\ny_pred_cases = regr.predict(x)\nprint('################# Cases in next 10 Days #################')\nx_22 = regr.predict(x2)\nx_22 = np.rint(x_22)\nprint(x_22)\n\nplt.scatter(x,y)\nplt.plot(x,y_pred_death,color='red')\nplt.title('MLPRegressor')\nplt.xlabel('Days')\nplt.ylabel('Deaths')\nplt.show()\nplt.scatter(x,y2)\nplt.plot(x,y_pred_cases,color='red')\nplt.title('MLPRegressor')\nplt.xlabel('Days')\nplt.ylabel('Cases')\nplt.show()\n\nprint('#########Deaths Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y, y_pred_death))\nprint('Mean Squared Error:', metrics.mean_squared_error(y, y_pred_death))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y, y_pred_death)))\nprint('R^2:', np.sqrt(metrics.r2_score(y, y_pred_death)))\n\nprint('#########Cases Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y2, y_pred_cases))\nprint('Mean Squared Error:', metrics.mean_squared_error(y2, y_pred_cases))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y2, y_pred_cases)))\nprint('R^2:', np.sqrt(metrics.r2_score(y2, y_pred_cases)))","47f25a4c":"poly_reg = PolynomialFeatures(degree=3)\n\nx = df_all_1.iloc[1:,0].values.reshape(-1,1)\ny = df_all_1.iloc[1:,2].values.reshape(-1,1)\ny2 = df_all_1.iloc[1:,3].values.reshape(-1,1)\n\n\n\npoly_x = poly_reg.fit_transform(x)\n\nregr = MLPRegressor(random_state=1, hidden_layer_sizes=(25, 57,57,34), max_iter=500).fit(poly_x, y)\ny_pred_death = regr.predict(poly_x)\n\nprint('################# Deaths in next 10 Days #################')\nx_22 = regr.predict(poly_reg.fit_transform(x2))\nx_22 = np.rint(x_22)\nprint(x_22)\n\n\nregr = MLPRegressor(random_state=1, hidden_layer_sizes=(100, 100), max_iter=500).fit(poly_x, y2)\ny_pred_cases = regr.predict(poly_x)\nprint('################# Cases in next 10 Days #################')\nx_22 = regr.predict(poly_reg.fit_transform(x2))\nx_22 = np.rint(x_22)\nprint(x_22)\n\nplt.scatter(x,y)\nplt.plot(x,y_pred_death,color='red')\nplt.title('MLPRegressor 3rd degree')\nplt.xlabel('Days')\nplt.ylabel('Deaths')\nplt.show()\nplt.scatter(x,y2)\nplt.plot(x,y_pred_cases,color='red')\nplt.title('MLPRegressor 3rd degree')\nplt.xlabel('Days')\nplt.ylabel('Cases')\nplt.show()\n\nprint('#########Deaths Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y, y_pred_death))\nprint('Mean Squared Error:', metrics.mean_squared_error(y, y_pred_death))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y, y_pred_death)))\nprint('R^2:', np.sqrt(metrics.r2_score(y, y_pred_death)))\n\nprint('#########Cases Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y2, y_pred_cases))\nprint('Mean Squared Error:', metrics.mean_squared_error(y2, y_pred_cases))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y2, y_pred_cases)))\nprint('R^2:', np.sqrt(metrics.r2_score(y2, y_pred_cases)))","27ce99ad":"# Instantiate dt\ndt = DecisionTreeRegressor(max_depth=6,\n            min_samples_leaf=0.009,\n            random_state=3)\n\n# Fit dt to the training set\ndt.fit(X_train, y_train)\ny_pred_death = dt.predict(X_test)\ny_pred_1 = dt.predict(X_test)\nprint('################# Deaths in next 10 Days #################')\nx_22 = dt.predict(x2)\nx_22 = np.rint(x_22)\nprint(x_22)\n\ndt.fit(X_train2,y_train2)\ny_pred_cases = dt.predict(X_test2)\nprint('################# Cases in next 10 Days #################')\nx_22 = dt.predict(x2)\nx_22 = np.rint(x_22)\nprint(x_22)\n\nprint('#########Deaths Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y_test, y_pred_death))\nprint('Mean Squared Error:', metrics.mean_squared_error(y_test, y_pred_death))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test, y_pred_death)))\nprint('R^2:', np.sqrt(metrics.r2_score(y_test, y_pred_death)))\n\nprint('#########Cases Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y_test2, y_pred_cases))\nprint('Mean Squared Error:', metrics.mean_squared_error(y_test2, y_pred_cases))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test2, y_pred_cases)))\nprint('R^2:', np.sqrt(metrics.r2_score(y_test2, y_pred_cases)))","3a836fca":"df_all = df\ndf_all = df_all.groupby(['date'])[['deaths','cases']].sum()\ndf_alll = df_all\n\ndf_alll = df_alll.diff(axis=0)\n\ndf_alll1 = df_alll.reset_index()\n\nmean1 = df_alll1['deaths'].mean()\nmean2 = df_alll1['cases'].mean()\n\n\na = df_alll.idxmax()\n\n\ntitleaa = 'US' \ntitlea = 'Deaths vs Date'\ntitleb = 'Cases vs Date'\n# Set default Seaborn style\nfig, axes = plt.subplots(2,1 , figsize=(15, 5), sharex=True)\nfig.suptitle(titleaa)\nsns.lineplot(ax=axes[0], x = 'date', y= 'deaths', data = df_alll1)\naxes[0].set_title(titlea)\nsns.lineplot(ax=axes[1], x = 'date', y= 'cases', data = df_alll1)\naxes[1].set_title(titleb)\n\naxes[0].axhline(mean1, color='r', linestyle='--', label = 'Mean Deaths')\naxes[1].axhline(mean2, color='b', linestyle='--', label = 'Mean Cases')\n\naxes[0].axvline(a[0], color='B', linestyle='-', label = 'Date of max Deaths')\naxes[1].axvline(a[1], color='R', linestyle='-', label = 'Date of max Cases')\n\n# Customize the labels and limits\naxes[0].legend()\naxes[1].legend()\nplt.xticks(rotation=45)\n# Show TimeSeries\nplt.show()","a7e905da":"df_all_12 = df\ndf_all_12 = df_all_12[df_all_12['state'] == 'Illinois']\ndf_all_12 = df_all_12[df_all_12['county'] == 'Cook']\ndf_all_12 = df_all_12.groupby(['date'])[['deaths','cases']].sum()\ndf_all_123 = df_all_12\n\ndf_all_123 = df_all_123.diff(axis = 0)\ndf_all_123 = df_all_123.reset_index()\ndf_all_123 = df_all_123.reset_index()\ndate = df_all_123[df_all_123['date'] == df_all_123['date'].max()]\n\nprint(df_all_123.tail())\nprint(date)","7328165c":"x = df_all_123.iloc[1:,0].values.reshape(-1,1)\ny = df_all_123.iloc[1:,2].values.reshape(-1,1)\ny2 = df_all_123.iloc[1:,3].values.reshape(-1,1)\n\nmax_x = x.max()\nx_future = max_x + 10\nx2 = np.arange(max_x,x_future).reshape(-1,1)\n\nl1 = LinearRegression()\nl1.fit(x,y)\ny_pred_death = l1.predict(x)\n\nprint('################# Deaths in next 10 Days #################')\nx_22 = l1.predict(x2)\nx_22 = np.rint(x_22)\nprint(x_22)\n\nl1.fit(x,y2)\ny_pred_cases = l1.predict(x)\nprint('################# Cases in next 10 Days #################')\nx_22 = l1.predict(x2)\nx_22 = np.rint(x_22)\nprint(x_22)\n\n\nplt.scatter(x,y)\nplt.plot(x,y_pred_death,color='red')\nplt.title('Linear Regression')\nplt.xlabel('Days')\nplt.ylabel('Deaths')\nplt.show()\nplt.scatter(x,y2)\nplt.plot(x,y_pred_cases,color='red')\nplt.title('Linear Regression')\nplt.xlabel('Days')\nplt.ylabel('Cases')\nplt.show()\n\n\nprint('#########Deaths Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y, y_pred_death))\nprint('Mean Squared Error:', metrics.mean_squared_error(y, y_pred_death))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y, y_pred_death)))\nprint('R^2:', np.sqrt(metrics.r2_score(y, y_pred_death)))\n\nprint('#########Cases Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y2, y_pred_cases))\nprint('Mean Squared Error:', metrics.mean_squared_error(y2, y_pred_cases))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y2, y_pred_cases)))\nprint('R^2:', np.sqrt(metrics.r2_score(y2, y_pred_cases)))","ff2307f0":"max_x = x.max()\nx_future = max_x + 10\nx2 = np.arange(max_x,x_future).reshape(-1,1)\n\npoly_reg = PolynomialFeatures(degree=4)\n\nx = df_all_123.iloc[1:,0].values.reshape(-1,1)\npoly_x = poly_reg.fit_transform(x)\n\ny = df_all_123.iloc[1:,2].values.reshape(-1,1)\ny2 = df_all_123.iloc[1:,3].values.reshape(-1,1)\n\nl1 = LinearRegression()\nl1.fit(poly_x,y)\ny_pred_death = l1.predict(poly_x)\n\nprint('################# Deaths in next 10 Days #################')\nx_22 = l1.predict(poly_reg.fit_transform(x2))\nx_22 = np.rint(x_22)\nprint(x_22)\n\nl1.fit(poly_x,y2)\ny_pred_cases = l1.predict(poly_x)\nprint('################# Cases in next 10 Days #################')\nx_22 = l1.predict(poly_reg.fit_transform(x2))\nx_22 = np.rint(x_22)\nprint(x_22)\n\n\nplt.scatter(x,y)\nplt.plot(x,y_pred_death,color='red')\nplt.title('4th Polynomial Regression')\nplt.xlabel('Days')\nplt.ylabel('Deaths')\nplt.show()\nplt.scatter(x,y2)\nplt.plot(x,y_pred_cases,color='red')\nplt.title('4th Polynomial Regression')\nplt.xlabel('Days')\nplt.ylabel('Cases')\nplt.show()\n\nprint('#########Deaths Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y, y_pred_death))\nprint('Mean Squared Error:', metrics.mean_squared_error(y, y_pred_death))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y, y_pred_death)))\nprint('R^2:', np.sqrt(metrics.r2_score(y, y_pred_death)))\n\nprint('#########Cases Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y2, y_pred_cases))\nprint('Mean Squared Error:', metrics.mean_squared_error(y2, y_pred_cases))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y2, y_pred_cases)))\nprint('R^2:', np.sqrt(metrics.r2_score(y2, y_pred_cases)))","bf242387":"max_x = x.max()\nx_future = max_x + 10\nx2 = np.arange(max_x,x_future).reshape(-1,1)\n\npoly_reg = PolynomialFeatures(degree=8)\n\nx = df_all_123.iloc[1:,0].values.reshape(-1,1)\npoly_x = poly_reg.fit_transform(x)\n\ny = df_all_123.iloc[1:,2].values.reshape(-1,1)\ny2 = df_all_123.iloc[1:,3].values.reshape(-1,1)\n\nl1 = LinearRegression()\nl1.fit(poly_x,y)\ny_pred_death = l1.predict(poly_x)\n\nprint('################# Deaths in next 10 Days #################')\nx_22 = l1.predict(poly_reg.fit_transform(x2))\nx_22 = np.rint(x_22)\nprint(x_22)\n\nl1.fit(poly_x,y2)\ny_pred_cases = l1.predict(poly_x)\nprint('################# Cases in next 10 Days #################')\nx_22 = l1.predict(poly_reg.fit_transform(x2))\nx_22 = np.rint(x_22)\nprint(x_22)\n\n\nplt.scatter(x,y)\nplt.plot(x,y_pred_death,color='red')\nplt.title('8th Polynomial Regression')\nplt.xlabel('Days')\nplt.ylabel('Deaths')\nplt.show()\nplt.scatter(x,y2)\nplt.plot(x,y_pred_cases,color='red')\nplt.title('8th Polynomial Regression')\nplt.xlabel('Days')\nplt.ylabel('Cases')\nplt.show()\n\nprint('#########Deaths Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y, y_pred_death))\nprint('Mean Squared Error:', metrics.mean_squared_error(y, y_pred_death))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y, y_pred_death)))\nprint('R^2:', np.sqrt(metrics.r2_score(y, y_pred_death)))\n\nprint('#########Cases Model###################')\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y2, y_pred_cases))\nprint('Mean Squared Error:', metrics.mean_squared_error(y2, y_pred_cases))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y2, y_pred_cases)))\nprint('R^2:', np.sqrt(metrics.r2_score(y2, y_pred_cases)))","567e878f":"df2ac.sort_values('cases')","21daaba4":"for key, values in d2.items():\n    df22 = df2[df2['state'] == key]\n    for a in values:\n        df33 = df22[df22['county'] == a]\n                \n        df33 = df33.groupby(['state','county','date'])[['deaths','cases']].sum()\n        df33 = df33.diff(axis=0)\n        df333 = df33[df33['deaths'] >= 0]\n        df333 = df33[df33['cases'] >= 0]\n        \n        aa = df33.idxmax()\n        mean1 = df33['deaths'].mean()\n        mean2 = df33['cases'].mean()\n        dff333 = df333.reset_index()\n\n\n        titleaa = 'State - ' + key +' || County - ' + a \n        titlea = 'Deaths vs Date'\n        titleb = 'Case vs Date'\n        # Set default Seaborn style\n        fig, axes = plt.subplots(2,1 , figsize=(15, 5), sharex=True)\n        fig.suptitle(titleaa)\n        sns.lineplot(ax=axes[0], x = 'date', y= 'deaths', data = dff333)\n        axes[0].set_title(titlea)\n        sns.lineplot(ax=axes[1], x = 'date', y= 'cases', data = dff333)\n        axes[1].set_title(titleb)\n        \n        axes[0].axhline(mean1, color='r', linestyle='--', label = 'Mean Deaths')\n        axes[1].axhline(mean2, color='b', linestyle='--', label = 'Mean Cases')\n        \n        axes[0].axvline(aa[0][2], color='B', linestyle='-', label = 'Date of max Deaths')\n        axes[1].axvline(aa[1][2], color='R', linestyle='-', label = 'Date of max Cases')\n        \n        axes[0].legend()\n        axes[1].legend()\n        # Customize the labels and limits\n        plt.xticks(rotation=45)\n        # Show TimeSeries\n        plt.show()","25281f8d":"df2ab.sort_values('deaths')","8be7c3bc":"for key, values in d1.items():\n    df22 = df2[df2['state'] == key]\n    for a in values:\n        df33 = df22[df22['county'] == a]\n        df33 = df33.groupby(['state','county','date'])[['deaths','cases']].sum()\n        df33 = df33.diff(axis=0)\n        df333 = df33[df33['deaths'] >= 0]\n        df333 = df33[df33['cases'] >= 0]\n        dff333 = df333.reset_index()\n\n\n        titleaa = 'State - ' + key +' || County - ' + a \n        titlea = 'Deaths vs Date'\n        titleb = 'Case vs Date'\n        # Set default Seaborn style\n        fig, axes = plt.subplots(2,1 , figsize=(15, 5), sharex=True)\n        fig.suptitle(titleaa)\n        sns.lineplot(ax=axes[0], x = 'date', y= 'deaths', data = dff333)\n        axes[0].set_title(titlea)\n        sns.lineplot(ax=axes[1], x = 'date', y= 'cases', data = dff333)\n        axes[1].set_title(titleb)\n        # Customize the labels and limits\n        plt.xticks(rotation=45)\n        # Show TimeSeries\n        plt.show()","27416e43":"df222 = df\n\ndf222_a = df222.groupby(['state'])[['deaths','cases']].sum()\ndf222_ab = df222_a.sort_values('deaths')\ndf222_ac = df222_a.sort_values('cases')\ndf222_ab = df222_ab.reset_index()\ndf222_ac = df222_ac.reset_index()\n\ndf222_ab = df222_ab.tail(15)\ndf222_ac = df222_ac.tail(15)\n\ntitlea = 'Deaths vs Date'\ntitleb = 'Case vs Date'\n\n# Set default Seaborn style\nfig, axes = plt.subplots(2,1 , figsize=(15, 17), sharex = True)\nsns.regplot(ax=axes[0], x = 'cases', y= 'deaths', data = df222_ab, label = 'state')\naxes[0].legend()\n\nsns.regplot(ax=axes[1], x = 'cases', y= 'deaths', data = df222_ac, label = 'state')\naxes[1].legend()\n\ndef label_point(x, y, val, ax):\n    a = pd.concat({'x': x, 'y': y, 'val': val}, axis=1)\n    for i, point in a.iterrows():\n        ax.text(point['x']+.1, point['y'], str(point['val']))\n\n    \n\nlabel_point(df222_ab.cases, df222_ab.deaths, df222_ab.state, axes[0])\nlabel_point(df222_ac.cases, df222_ac.deaths, df222_ac.state, axes[1])\n\nfig.suptitle('Deaths vs Cases by State')\naxes[0].set_title('Top 15 States with most Deaths')\naxes[1].set_title('Top 15 States with most Cases')\nplt.show()","218c4e8e":"df_state = pd.read_csv('..\/input\/state-data1\/csvData (1).csv')\ndf222_a1 = df222_a.reset_index()\ndf222_a1 = df222_a1.rename(columns={\"state\": \"State\"})\nresult = pd.merge(df222_a1, df_state, how='inner', on='State')\n\nresult1 = result.sort_values('deaths')\nresult2 = result.sort_values('cases')\n\nresult1 = result1.tail(15)\nresult2 = result2.tail(15)\n\n# Set default Seaborn style\nfig, axes = plt.subplots(2,1 , figsize=(15, 15), sharex = True)\nsns.regplot(ax=axes[0], x = 'Pop', y= 'cases', data = result1, label = 'state')\naxes[0].legend()\n\nsns.regplot(ax=axes[1], x = 'Pop', y= 'deaths', data = result1, label = 'state')\naxes[1].legend()\n\ndef label_point(x, y, val, ax):\n    a = pd.concat({'x': x, 'y': y, 'val': val}, axis=1)\n    for i, point in a.iterrows():\n        ax.text(point['x']+.1, point['y'], str(point['val']))\n\n    \n\nlabel_point(result1.Pop, result1.cases, result1.State, axes[0])\nlabel_point(result1.Pop, result1.deaths, result1.State, axes[1])\n\nfig.suptitle('Population vs Deaths\/Cases by State')\naxes[0].set_title('Top 15 States with most Deaths')\naxes[1].set_title('Top 15 States with most Cases')\nplt.show()","3853c903":"result['Crude death rate'] = result.deaths \/ result.Pop * 100\nresult1['Crude death rate'] = result1.deaths \/ result1.Pop * 100\nresult2['Crude death rate'] = result2.deaths \/ result2.Pop * 100\n\nresult['Point prevalence'] = result.cases \/ result.Pop\nresult1['Point prevalence'] = result1.cases \/ result1.Pop\nresult2['Point prevalence'] = result2.cases \/ result2.Pop\n\nresult['case fatality proportion'] = result.deaths \/ result.cases\nresult1['case fatality proportion'] = result1.deaths \/ result1.cases\nresult2['case fatality proportion'] = result2.deaths \/ result2.cases\n\nresult1 = result1.sort_values('Crude death rate')\nresult2 = result2.sort_values('Crude death rate')\n\n\n# Set default Seaborn style\nfig, axes = plt.subplots(2,1 , figsize=(15, 15), sharex = True)\nsns.regplot(ax=axes[0], x = 'Point prevalence', y= 'Crude death rate', data = result1, label = 'state')\naxes[0].legend()\n\nsns.regplot(ax=axes[1], x = 'Point prevalence', y= 'Crude death rate', data = result2, label = 'state')\naxes[1].legend()\n\ndef label_point(x, y, val, ax):\n    a = pd.concat({'x': x, 'y': y, 'val': val}, axis=1)\n    for i, point in a.iterrows():\n        ax.text(point['x']+.05, point['y'], str(point['val']))\n\n    \n\nlabel_point(result1['Point prevalence'], result1['Crude death rate'], result1.State, axes[0])\nlabel_point(result2['Point prevalence'], result2['Crude death rate'], result2.State, axes[1])\n\nfig.suptitle('Epi Measures')\naxes[0].set_title('Top 15 States with most Deaths')\naxes[1].set_title('Top 15 States with most Cases')\nplt.show()","4244698a":"plt.figure(figsize=(16, 6))\nheatmap = sns.heatmap(result.corr(), vmin=-0.95, vmax=0.95, annot=True, cmap='BrBG')\nheatmap.set_title('Correlation Heatmap', fontdict={'fontsize':18}, pad=12);\nplt.show()","51e2a21a":"# Set default Seaborn style\nfig, axes = plt.subplots(2,1 , figsize=(15, 15), sharex = True)\nsns.regplot(ax=axes[0], x = 'Poverty', y= 'deaths', data = result, label = 'state')\naxes[0].legend()\n\nsns.regplot(ax=axes[1], x = 'Poverty', y= 'cases', data = result, label = 'state')\naxes[1].legend()\n\ndef label_point(x, y, val, ax):\n    a = pd.concat({'x': x, 'y': y, 'val': val}, axis=1)\n    for i, point in a.iterrows():\n        ax.text(point['x']+.05, point['y'], str(point['val']))\n\n    \n\nlabel_point(result['Poverty'], result['deaths'], result.State, axes[0])\nlabel_point(result['Poverty'], result['cases'], result.State, axes[1])\n\nfig.suptitle('Epi Measures')\naxes[0].set_title('Poverty vs Deaths')\naxes[1].set_title('Poverty vs Cases')\nplt.show()","e0b2d185":"**Multi Layer Perceptron**","eeb9f934":"## Regression Model on Cook County IL Deaths & Cases","d20572c6":"## Top 30 Counties with Most Deaths","34685c64":"\n## Top 30 Counties with Most Covid Cases","1986628b":"**Ensamble Model (LR, GBR, RFR)**","c0b98765":"## Regression Model on US Deaths & Cases","ff0f2201":"**Random Foreset**","fb041d5e":"## Latest US Deaths & Cases","2d986579":"**Linear Regression**"}}