{"cell_type":{"5fae3747":"code","cc2ebced":"code","24ef1fb4":"code","39cfd6d7":"code","88242914":"code","46e0ddbc":"code","383df1fe":"code","da3d440c":"code","0297afdb":"code","6abded14":"code","138b6a16":"code","0397dbfe":"code","5d7274b4":"code","558cc2f2":"code","a43593cd":"code","70bcb16d":"code","af302a73":"code","bf3b3cdf":"code","b87010fb":"code","bac8b8ef":"code","0d1886c0":"code","e27c73ec":"code","d24f302f":"code","18c90e05":"code","1c3b046e":"code","b4eb5b17":"code","19a8aa45":"code","79018200":"code","c1cff733":"code","53f3e00a":"markdown","55d09a0e":"markdown","3cc9f038":"markdown","18a69c0e":"markdown","9db3f74f":"markdown","b1c386ec":"markdown","f3688da8":"markdown","2f557f0e":"markdown","a6aeddd0":"markdown","09886f0a":"markdown","25c84b33":"markdown","16aea70a":"markdown","7fc66916":"markdown","45becaf9":"markdown","3ab5c739":"markdown","6f583cf3":"markdown","c89813df":"markdown","47d55f16":"markdown","67204794":"markdown","198c1708":"markdown","02955761":"markdown","9c936bf5":"markdown","ea2160e4":"markdown","ab295109":"markdown"},"source":{"5fae3747":"import pandas as pd\nfrom sklearn.model_selection import train_test_split\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","cc2ebced":"data = pd.read_csv('..\/input\/heart.csv')","24ef1fb4":"data.head(3)","39cfd6d7":"# Check for duplicities\ndata.duplicated().sum()","88242914":"data = data.drop_duplicates()","46e0ddbc":"data.shape","383df1fe":"data.dtypes","da3d440c":"df = data","0297afdb":"# Sex\ndf['sex'][df['sex']==0] = 'female'\ndf['sex'][df['sex']==1] = 'male'\n# cp: chest pain : name of cp from Reference a)\ndf['cp'][df['cp'] == 0] = 'typical angina'\ndf['cp'][df['cp'] == 1] = 'atypical angina'\ndf['cp'][df['cp'] == 2] = 'non-anginal pain'\ndf['cp'][df['cp'] == 3] = 'asymptomatic'\n# fbs : binary variable\ndf['fbs'][df['fbs'] == 0] = '<120mg\/dl'\ndf['fbs'][df['fbs'] == 1] = '>120mg\/dl' \n# restecg \ndf['restecg'][df['restecg'] == 0] = 'normal'\ndf['restecg'][df['restecg'] == 1] = 'ST-T wave abnormality'\ndf['restecg'][df['restecg'] == 2] = 'left ventricular hypertophy'\n# exang\ndf['exang'][df['exang'] == 0] = 'no'\ndf['exang'][df['exang'] == 1] = 'yes'\n# slope\ndf['slope'][df['slope'] == 0] = 'upsloping'\ndf['slope'][df['slope'] == 1] = 'flat'\ndf['slope'][df['slope'] == 2] = 'downsloping'\n# thal\ndf['thal'][df['thal'] == 0] = 'unknown'\ndf['thal'][df['thal'] == 1] = 'normal'\ndf['thal'][df['thal'] == 2] = 'fixed defect'\ndf['thal'][df['thal'] == 3] = 'reversible defect'\n# target\ndf['target'][df['target'] == 1 ] = 'yes'\ndf['target'][df['target'] == 0 ] = 'no'","6abded14":"df.dtypes","138b6a16":"predictors = df.columns[:-1]\nnum_vars = ['age','trestbps','chol', 'thalach', 'oldpeak', 'ca']\ncat_vars = []\nfor variable in predictors:\n    if variable not in num_vars:\n        cat_vars.append(variable)\ny = df[['target']]\nX = df[predictors]","0397dbfe":"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.25,random_state=111)\nX_train.shape # we have 226 training examples","5d7274b4":"training_data = pd.concat([X_train,y_train],axis=1)\nvalidation_data = pd.concat([X_test,y_test],axis=1)","558cc2f2":"# summary statistics for numeric variables\nX_train.describe()","a43593cd":"# response variable : target\ny_train['target'].value_counts()\nsns.countplot(x = \"target\", data = y_train, palette = \"hls\")","70bcb16d":"# Summary statistics for indepdendent variables \n# Numeric Varibles\n# a) Age\nplt.figure(figsize = (9,8))\nsns.distplot(X_train['age'], color = \"g\", bins = 10, hist_kws = {'alpha':0.4})","af302a73":"# b) trestbps\nplt.figure(figsize = (9,8))\nsns.distplot(X_train['trestbps'], color = \"g\", bins = 10, hist_kws = {'alpha':0.4})\n","bf3b3cdf":"# c) chol\nplt.figure(figsize = (9,8))\nsns.distplot(X_train['chol'], color = \"g\", bins = 16, hist_kws = {'alpha':0.4})","b87010fb":"# d) thalach\nplt.figure(figsize = (9,8))\nsns.distplot(X_train['thalach'], color = \"g\", bins = 10 ,hist_kws = {'alpha':0.4})","bac8b8ef":"# e) oldpeak\nplt.figure(figsize = (9,8))\nsns.distplot(X_train['oldpeak'], color = \"g\", bins = 10 ,hist_kws = {'alpha':0.4})","0d1886c0":"# f) ca\nplt.figure(figsize = (9,8))\nsns.distplot(X_train['ca'], color = \"g\", bins = 10 ,hist_kws = {'alpha':0.4})","e27c73ec":"# Categorical Variables \nfor i,var in enumerate(X_train[cat_vars]):\n#    print(\"{Variable}:{Counts}\".format(Variable = var, Counts = X_train.groupby([var]).size()))\n    plt.figure(i,figsize=(8,6))\n    sns.countplot(x=var, data=X_train)","d24f302f":"training_data.corr()","18c90e05":"plt.figure(figsize=(10,6))\nax = sns.kdeplot(training_data['age'][training_data.target == 'yes'],color = 'r',shade=True)\nsns.kdeplot(training_data['age'][training_data.target == 'no'],color = 'b',shade= True)\nplt.legend(['yes','no'])\nplt.title('Density Plot of Age of Patients - with heart disease (red) and without (blue)')\nax.set(xlabel = 'Age')\nplt.xlim(20,80)\nplt.show()","1c3b046e":"plt.figure(figsize=(10,6))\nax = sns.kdeplot(training_data['trestbps'][training_data.target == 'yes'],color = 'r',shade=True)\nsns.kdeplot(training_data['trestbps'][training_data.target == 'no'],color = 'b',shade= True)\nplt.legend(['yes','no'])\nplt.title('Density Plot of Resting B.P. of Patients - with heart disease (red) and without (blue)')\nax.set(xlabel = 'Resting blood pressure')\nplt.xlim(80,250)\nplt.show()","b4eb5b17":"plt.figure(figsize=(10,6))\nax = sns.kdeplot(training_data['chol'][training_data.target == 'yes'],color = 'r',shade=True)\nsns.kdeplot(training_data['chol'][training_data.target == 'no'],color = 'b',shade= True)\nplt.legend(['yes','no'])\nplt.title('Density Plot of Cholestrol of Patients - with heart disease (red) and without (blue)')\nax.set(xlabel = 'Cholestrol')\nplt.xlim(90,500)\nplt.show()","19a8aa45":"plt.figure(figsize=(10,6))\nax = sns.kdeplot(training_data['thalach'][training_data.target == 'yes'],color = 'r',shade=True)\nsns.kdeplot(training_data['thalach'][training_data.target == 'no'],color = 'b',shade= True)\nplt.legend(['yes','no'])\nplt.title('Density Plot of Max. heart rate achieved of Patients - with heart disease (red) and without (blue)')\nax.set(xlabel = 'Maximum heart rate achieved')\nplt.xlim(50,250)\nplt.show()","79018200":"plt.figure(figsize=(10,6))\nax = sns.kdeplot(training_data['oldpeak'][training_data.target == 'yes'],color = 'r',shade=True)\nsns.kdeplot(training_data['oldpeak'][training_data.target == 'no'],color = 'b',shade= True)\nplt.legend(['yes','no'])\nplt.title('Density Plot of S.T. depression induced in Patients - with heart disease (red) and without (blue)')\nax.set(xlabel = 'S.T. depression')\nplt.xlim(-2,10)\nplt.show()","c1cff733":"# The following will show distribution of target variable for different groups of indepdendent variable.\nfor var in cat_vars:\n     table=pd.crosstab(training_data[var],training_data['target'])   \n     table.div(table.sum(1).astype(float), axis=0).plot(kind='bar', stacked=True)\n","53f3e00a":"# Logistic Regression Model","55d09a0e":"Clearly, we need to change treatment of few variables. We will make a copy of data and make changes to it.","3cc9f038":"# Descriptive Statistics and Exploratory Analysis","18a69c0e":"Let us separate categorical and numeric variables. \n","9db3f74f":"The following code will give countplots of all categorical variables in a loop. ","b1c386ec":"Following were the references used to create this kernel: \n\nhttps:\/\/www.kaggle.com\/tentotheminus9\/what-causes-heart-disease-explaining-the-model","f3688da8":"Split the data frame for train-test","2f557f0e":"### oldpeak : ST depression induced by exercise \nThis variable shows a strong tendency to have high correlation to the response variable.","a6aeddd0":"### chol : cholestrol\nIt seems that cholestrol also doesn't have a strong correlation to 'heartDisease'.\nAlso, there was an outlier of value 417 for cholestrol but I have not shown it for studying the density plots better.","09886f0a":"### response variable w.r.t. numeric variables \nFor correlation of target with numeric variables, we can look at the density plots of numeric variables for both categories.","25c84b33":"Import the necessary libraries. ","16aea70a":"Having an understanding about the variables, we now check for data types.","7fc66916":"## Bi-variate Analysis","45becaf9":"### Age\nIt seems people with heart disease (red) have a different distribution than people who didn't have heart disease.","3ab5c739":"### response variable w.r.t. categorical variables \nFor correlation of target with categorical variables, we can look at the bar plots showing percentage of each group for different categories of indepdenent variable.","6f583cf3":"### thalach : maximum heart rate achieved\nWith this variable, I am unsure what to interpret looking at their density plots. Hopefully, numbers will provide more insight when we discuss it later on. ","c89813df":"## Univariate Analysis","47d55f16":"### Interpretation of Crosstab:\nFrom the plot it seems:\n* sex: Females are more likely to have heart disease than men, however keep in mind that women were a much smaller sample in our dataset. \n* cp: Except for last category which has very small proportion of patients with heart disease, all other categories have somewhat the same distribution. However, it also was the biggest group for this variable. ","67204794":"We see that following numeric variables are somewhat highly correlated (reference level is 0.3):\n* age and trestbps\n* age and thalach\n* oldpeak and thalach","198c1708":"Therefore, we are going to be working with 302 observations of 14 variables, one of which is the target variable.\n\n*target*: 0: 'no', 1: 'yes' ( whether someone has a heart disease or not)","02955761":"Remove the duplicated row, keeping the first occurence and dropping the last one. ","9c936bf5":"### trestbps: Resting blood pressure \nThe distribution is somewhat same, indicating that there might not be a strong relationship between 'heartDisease' and 'resting B.P.' although this claim has to be statistically evalualted later on. ","ea2160e4":"We first check for any duplcities in the dataset. To examine the duplicated row, we can use :\ndata.loc[data.duplicated(),:]","ab295109":"Brief Discussion about the variables: \n\n* age - numeric variable\n* sex - categorical variable\n* cp: chest pain type (4 values) - integer valued variable\n* trestbps: resting blood pressure - numeric variable\n* chol: serum cholestrol - numeric variable\n* fbs: fasting blood sugar > 120 mg\/dl - categorical varaible\n* restecg: resting electrocardiographic results - categorical variable \n* thalach: max hear rate achieved - numeric variable\n* exang: exercise induced angina - categorical variable\n* oldpeak: ST depression induced by exercise relative to rest - numeric variable \n* slope: slope of peak exercise ST segment - categorical variable\n* ca: no. of major vessels (0-3) colored by flouroscopy - integer valued variable\n* thal: 3= normal, 6= fixed defect, 7= reversable defect - categorical variable \n* target: 0 = no, 1 = yes - categorical variable\n"}}