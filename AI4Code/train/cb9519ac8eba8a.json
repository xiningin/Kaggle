{"cell_type":{"31249968":"code","f1a36587":"code","2d2a3e16":"markdown","708e1468":"markdown","8dba8137":"markdown","9ae01e83":"markdown","79c974fd":"markdown","9f6aafa6":"markdown","5b2c80ba":"markdown"},"source":{"31249968":"#Definition of the Necesarry Modules\nimport statistics\nimport pandas as pd\nfrom scipy.stats import shapiro\nimport scipy.stats as stats\nfrom scipy.stats import mannwhitneyu\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport warnings\nfrom sklearn.exceptions import ConvergenceWarning\nwarnings.simplefilter(action='ignore', category=FutureWarning)\nwarnings.simplefilter(\"ignore\", category=ConvergenceWarning)\nfrom termcolor import colored\n\n#Importing the Datasets: Two sets are stored in different sheets of excel\nDataGroupA = pd.read_excel(\"..\/input\/ab-testing-data\/ab_testing_data.xlsx\" , sheet_name= \"Control Group\")\nDataGroupB = pd.read_excel(\"..\/input\/ab-testing-data\/ab_testing_data.xlsx\" , sheet_name= \"Test Group\")\n\n#Feature Engineering: Conversion Rate\nDataGroupA[\"Conversion Rate\"] = DataGroupA[\"Purchase\"]\/DataGroupA[\"Click\"]*100\nDataGroupB[\"Conversion Rate\"] = DataGroupB[\"Purchase\"]\/DataGroupB[\"Click\"]*100\n\n#Feature Engineering: Earning per Purchase\nDataGroupA[\"Earning per Purchase\"] = DataGroupA[\"Earning\"]\/DataGroupA[\"Purchase\"]*100\nDataGroupB[\"Earning per Purchase\"] = DataGroupB[\"Earning\"]\/DataGroupB[\"Purchase\"]*100\n\n#Data Manipulation: Indication of Groups in A New Variable\nDataGroupA[\"Group\"] = \"GroupA\"\nDataGroupB[\"Group\"] = \"GroupB\"\n\n#Combining the Datasets\nData = pd.concat([DataGroupA, DataGroupB], ignore_index=True)","f1a36587":"variables = [\"Impression\",\"Click\",\"Purchase\",\"Earning\",\"Conversion Rate\",\"Earning per Purchase\"]\n\nfor x in variables:\n    print(colored(\" A\/B Testing for \",\"cyan\", attrs=[\"bold\",'reverse', 'blink'])+colored(x+\" \",\"cyan\", attrs=[\"bold\",'reverse', 'blink']),\"\\n\")\n    print(colored(\"Summary Statistics by Groups for \"+x,\"cyan\", attrs=[\"bold\"]),\"\\n\")\n    result3 = Data.groupby(\"Group\")[x].aggregate([\"count\",\"mean\",\"std\",\"median\",\"min\",max])\n    result4 = result3.transpose()\n    print(x)\n    print(result4,\"\\n\")\n    print(colored(\"Histogram by Groups for \"+x,\"cyan\", attrs=[\"bold\"]),\"\\n\")\n    #sns.displot(Data, x=x, hue=\"Group\", element=\"step\", kde=True)\n    #plt.show()\n    sns.distplot( DataGroupA[x] , color=\"skyblue\", label=\"GroupA\")\n    sns.distplot( DataGroupB[x] , color=\"red\", label=\"GroupB\")\n    plt.legend()\n    plt.show()\n\n    def normald():\n              \n        Data.boxplot(column=[x], by=\"Group\",return_type=None)\n        plt.suptitle(\"\")\n        print(colored(\"Box Plot by Groups for \"+x,\"cyan\", attrs=[\"bold\"]),\"\\n\")\n        plt.show()\n        \n        print(colored(\"1. Step: Testing the Normality Assumption for \"+x,\"cyan\", attrs=[\"bold\"]),\"\\n\")\n        GroupA_shaphiro_w, GroupA_shaphiro_p = shapiro(DataGroupA[x])\n        GroupB_shaphiro_w, GroupB_shaphiro_p = shapiro(DataGroupB[x])\n        print(\"GroupA_shaphiro_p = %.3f, GroupB_shaphiro_p = %.3f\" % (GroupA_shaphiro_p, GroupB_shaphiro_p),\"\\n\")\n    \n        if GroupA_shaphiro_p > 0.05 and GroupB_shaphiro_p > 0.05: \n            print(\"Shaphiro Wilk Test resulted as p > .05 for GroupA and GroupB which indicates that H0 can NOT be rejected. \" \n                  \"Accordingly distribution of \"+x+\" values in\"+\" GroupA and GroupB are likely to normal distribution.\",\"\\n\")\n            return 1\n        elif GroupA_shaphiro_p < 0.05 and GroupB_shaphiro_p < 0.05:\n            print(\"Shaphiro Wilk Test resulted as p < .05 for GroupA and GroupB which indicates that H0 is rejected. \" \n                  \"Accordingly distribution of \"+x+\" values in\"+\" GroupA and GroupB are not likely to normal distribution.\",\"\\n\")\n            return 2\n        elif GroupA_shaphiro_p > 0.05 and GroupB_shaphiro_p < 0.05:\n            print(\"Pay Attention!: Shaphiro Wilk Test resulted as p > .05 for GroupA while p < .05 for GroupB which indicates that H0 is rejected for GroupB. \" \n                  \"Accordingly you can check if the \"+x+\" values in\"+\" GroupB contain outlier or not\",\"\\n\")\n            return 3\n        else :\n            print(\"Pay Attention!: Shaphiro Wilk Test resulted as p > .05 for GroupB while p < .05 for GroupA which indicates that H0 is rejected for GroupA. \" \n                \"Accordingly you can check if the \"+x+\" values in\"+\" GroupA contain outlier or not\",\"\\n\")\n            return 4\n\n    result = normald()\n    if result == 1:\n        \n            print(colored(\"2. Step: Testing the Homogeneity Assumption for \"+x,\"cyan\", attrs=[\"bold\"]),\"\\n\")\n            levene_F, levene_p = stats.levene(DataGroupA[x], DataGroupB[x])\n            print(\"levene_F = %.3f, levene_p = %.3f\" % (levene_F, levene_p),\"\\n\")       \n            if levene_p > 0.05:\n                print(\"Levene's Test for Homogeneity resulted as p > .05 which indicates that H0 can NOT be rejected.\"\n                      \" Accordingly variances of GroupA and GroupB are equal.\",\"\\n\")\n                print(colored(\"3. Step: Alternative 1 -> Independent Samples t Test for \"+x,\"cyan\", attrs=[\"bold\"]),\"\\n\")\n                t_value, t_test_p = stats.ttest_ind(DataGroupA[x], DataGroupB[x], equal_var=True)\n                print(\"t_value = %.3f, t_test_p = %.3f\" % (t_value, t_test_p),\"\\n\")\n                if t_test_p > 0.05:\n                    print(\"Independent Samples t Test resulted as p > .05 which indicates that H0 can NOT be rejected.\"\n                          \" Accordingly there is no significant difference between GroupA and GroupB in \"+x+\" values.\",\"\\n\")\n                else: \n                    print(\"Independent Samples t Test resulted as p < .05 which indicates that H0 is rejected.\"\n                          \" Accordingly there is a significant difference between GroupA and GroupB in \"+x+\" values.\",\"\\n\")\n                    if statistics.mean(DataGroupA[\"Earning\"]) > statistics.mean(DataGroupB[\"Earning\"]):\n                        print(\"Mean of GroupA in \"+x+\" is greater than GroupB\",\"\\n\")\n                    else:\n                        print(\"Mean of GroupB in \"+x+\" is greater than GroupA\",\"\\n\")\n            else : \n                print(\"Levene's Test for Homogeneity resulted as p < .05 which indicates that H0 is rejected.\"\n                      \" Accordingly variances of GroupA and GroupB are not equal.\",\"\\n\")\n                print(colored(\"3. Step: Alternative 1 -> Independent Samples t Test for \"+x,\"cyan\", attrs=[\"bold\"]),\"\\n\")\n                t_value, t_test_p = stats.ttest_ind(DataGroupA[x], DataGroupB[x], equal_var=False)\n                print('t_value = %.3f, t_test_p = %.3f' % (t_value, t_test_p),\"\\n\")\n                if t_test_p > 0.05:\n                    print(\"Independent Samples t Test resulted as p > .05 which indicates that H0 can NOT be rejected.\"\n                          \" Accordingly there is no significant difference between GroupA and GroupB in \"+x+\" values.\",\"\\n\")\n                else: \n                    print(\"Independent Samples t Test resulted as p < .05 which indicates that H0 is rejected.\"\n                          \" Accordingly there is a significant difference between GroupA and GroupB in \"+x+\" values.\",\"\\n\")\n                    if statistics.mean(DataGroupA[x]) > statistics.mean(DataGroupB[x]):\n                        print(\"Mean of GroupA in \"+x+\" is greater than GroupB\",\"\\n\")\n                    else:\n                        print(\"Mean of GroupB in \"+x+\" is greater than GroupA\",\"\\n\")\n                    \n                    \n    elif result == 2 or result == 3 or result == 4:\n        \n            print(colored(\"3. Step: Alternative 2 -> Mann-Whitney U Test for \"+x,\"cyan\", attrs=[\"bold\"]),\"\\n\")\n            u_value, mannw_test_p = mannwhitneyu(DataGroupA[x], DataGroupB[x])\n            print('u_value=%.3f, mannw_test_p=%.3f' % (u_value, mannw_test_p),\"\\n\")\n            if mannw_test_p > 0.05:\n                print(\"Mann Whitney U Test resulted as p > .05 which indicates that H0 can NOT be rejected.\"\n                      \" Accordingly there is no significant difference between GroupA and GroupB in distributions of \"+x+\" values.\",\"\\n\")\n            else: \n                print(\"Mann Whitney U Test resulted as p < .05 which indicates that H0 is rejected.\"\n                      \" Accordingly there is a significant difference between GroupA and GroupB in distributions of \"+x+\" values.\",\"\\n\")\n                if statistics.median(DataGroupA[\"Earning\"]) > statistics.median(DataGroupB[\"Earning\"]):\n                    print(\"Median of GroupA in \"+x+\" is greater than GroupB\",\"\\n\")\n                else:\n                    print(\"Median of GroupB in \"+x+\" is greater than GroupA\",\"\\n\")\n    else :\n            print(\"Something is wrong. Check your data!\")","2d2a3e16":"#### <font color=\"darkcyan\">Aim<\/font> : In this study is it aimed to reveal whether there is a significant difference in the performance variables provided for two bidding types of <b><font color=\"blue\">facebook<\/font><\/b>.\n\n#### <font color=\"darkcyan\">Dataset<\/font> : Dataset contains 4 different metric variables observed during one month. Descriptions of the variables are reflected in the table below.\n\n<font color=\"darkmagenta\">No<\/font>|<font color=\"darkcyan\"> Variables <\/font>|<font color=\"darkmagenta\"> Variable Type <\/font>|<font color=\"darkcyan\"> Scale Types of Data <\/font>\n--|----------- |:-------------:|:-------------------:\n1 |Purchase | Quantitative | Ratio\n2 |Impression | Quantitative | Ratio\n3 |Earning | Quantitative | Ratio\n4 |Click | Quantitative | Ratio\n\n\n","708e1468":"## <font color=\"darkmagenta\">Conclusion of the Bidding Case Through A\/B Testing Example<\/font>\n\nFacebook recently introduced a new bidding type, \u201caverage bidding\u201d, as an alternative to its exisiting bidding type, called \u201cmaximum bidding\u201d. One of our clients, bombabomba.com, has decided to test this new feature and wants to conduct an A\/B test to understand if average bidding brings more conversions than maximum bidding.\nIn this A\/B test, bombabomba.com randomly splits its audience into two equally sized groups, e.g. the test and the control group. A Facebook ad campaign with \u201cmaximum bidding\u201d is served to \u201ccontrol group\u201d and another campaign with \u201caverage bidding\u201d is served to the \u201ctest group\u201d.\nThe A\/B test has run for 1 month and bombabomba.com now expects you to analyze and present the results of this A\/B test.\nPurchase is the target value.\n\n### <font color=\"darkmagenta\">1. How would you define the hypothesis of this A\/B test?<\/font>\n\nH0: There is NO statistically significant difference between A and B groups in Purchase values.\n\nHa: There is a statistically significant difference between A and B groups in Purchase values.\n\n### <font color=\"darkmagenta\">2. How can we conclude statistically significant results?<\/font>\n    \nVia AB tests\n\n### <font color=\"darkmagenta\">3. Which statistical test did you use, and why?<\/font>\n\nIndependent Samples of t Test cause the distribution is normal which is symetrical and we can use means of Purchase.\n\n### <font color=\"darkmagenta\">4. Based on your answer to Question 2, what would be your recommendation to client?<\/font>\n\nThere is no significant difference in  <font color=\"red\">Purchase<\/font>. If you want to decide according to one metric, both bidding system can be choosen but A data shows a lower std dev which can be more trustworty.\n\nHowever we have reported A\/B Testing results thank to the code loop, accordingly other performance metric could be evaluated.\n\nAccording to the results GroupB (Average Bidding) has greater mean\/median values in <font color=\"darkmagenta\">Earning, Conversion Rate, Earning per Purchase and Impression <\/font> compared to GroupA (Maximum Bidding) while smaller mean\/median values in <font color=\"magenta\">Click <\/font>. In this context based on the other variable's values ","8dba8137":"## <font color=\"darkcyan\">3. A\/B Testing in Practice <\/font>\n\n![](https:\/\/media.giphy.com\/media\/ibA1NuI1fiVYu1wr18\/giphy.gif)","9ae01e83":"# A\/B Testing","79c974fd":"## <font color=\"darkcyan\">1. Background<\/font>","9f6aafa6":"## <font color=\"darkcyan\">2. Data Manipulation and Feature Engineering <\/font>","5b2c80ba":"In this notebook i would like to introduce you a user developed function finalises the necesarry statistical steps of <b><font color=\"darkmagenta\">A\/B Testing<\/font><\/b> and interprets the result of the hypothesis tests that are used in <b><font color=\"darkmagenta\">A\/B Testing<\/font><\/b> process.\n\n<b><font color=\"darkmagenta\">A\/B Testing<\/font><\/b> method cover the statistical hypothesis tests are used to reveal significance of the difference in a metric variable values between two groups such a Group A and Group B. There are two statistical methods to test the significance as Independent Samples t Test and Mann-Whitney U Test. According to result of <b><font color=\"magenta\">1. Step: Testing the Normality Assumption<\/font><\/b>, it is decided between two alternative methods.\n\n\n\n\n\n<b><mark style=\"background-color: darkmagenta\"><font color=\"white\">*      A\/B Testing Steps         *<\/font><\/mark><\/b>\n\n\n<b><font color=\"magenta\">1. Step: Testing the Normality Assumption<\/font><\/b>\n\nIt is necesarry to decide which way of testing the significany of difference will be choosen. Shaphiro Wilks test is a way to test if the serie has normal distribution or not. Also a Box Plot might be helpfull to observe if the serie has outliers or not.\nAccording to result of the test it can be decided between Independent Samples t Test and Mann-Whitney U Test.\n\nIf p value of the test is greater than .05 A\/B Testing method will be Independent Samples t Test.\n\nIn addition Independent Samples t Test requires another assumption which is Homogeneity, so if the result is normal then you can follow <b><font color=\"magenta\">2. Step: Testing the Homogeneity Assumption<\/font><\/b>.\n\n\nIf p value of the test is less than .05 A\/B Testing method will be Mann-Whitney U Test.\n\nIn addition Mann-Whitney U Test does not require any other assumptions, so if the result is not normal then you can jump to <b><font color=\"magenta\">3. Step: Alternative 2 -> Mann-Whitney U Test<\/font><\/b>.\n\n\n<b><font color=\"magenta\">2. Step: Testing the Homogeneity Assumption<\/font><\/b>\n\nThis assumption is only relevant in the case of normal distribution. It is necesarry to decide which code setting will be choosen while executing the <b><font color=\"magenta\">3. Step: Alternative 1 -> Independent Samples t Test<\/font><\/b>. \n\nIf p value of the test is greater than .05 Independent Samples t Test will be done with \"equal_var=<b><font color=\"green\">True<\/font><\/b>\" extention.\n\nIf p value of the test is less than .05 Independent Samples t Test will be done with \"equal_var=<b><font color=\"green\">False<\/font><\/b>\" extention.\n\n\n<b><font color=\"magenta\">3. Step: Alternative 1 -> Independent Samples t Test<\/font><\/b>\n\n\nIt can be defined as an approach that tests to statistically reveal whether there is a significant difference between the means of two groups of data.\n\n\n<b><font color=\"magenta\">3. Step: Alternative 2 -> Mann-Whitney U Test<\/font><\/b>\n\nIt can be defined as an approach that tests to statistically reveal whether there is a significant difference between the distributions of two groups of data.\n\n\nCode loop below takes the actions shown in the cheat sheet.\n\n<b><mark style=\"background-color: darkmagenta\"><font color=\"white\">*      A\/B Testing Cheat Sheet         *<\/font><\/mark><\/b>\n\n![](http:\/\/miro.medium.com\/max\/791\/1*JlpbE7evTO4LD8R7c_M-sA.png)\n\n[Check out! A\/B Testing Story for more](https:\/\/ersoykubraa.medium.com\/a-b-testing-ef7e8dbb9859)"}}