{"cell_type":{"5044e1fa":"code","19c5f62a":"code","c7dc2e00":"code","dac2429a":"code","f04389c4":"code","26b08b7e":"code","63f2c3c4":"code","7baddcfe":"code","11eb5577":"code","4af25bc1":"code","f249b415":"code","ac3e9095":"code","c5c6c70c":"code","eae9e84c":"code","711b94ca":"code","e34c81cf":"code","0bd5db9b":"markdown"},"source":{"5044e1fa":"import pandas as pd\nimport numpy as np\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import r2_score","19c5f62a":"X_train = pd.read_csv('..\/input\/used-car-price-dataset-competition-format\/X_train.csv')\nX_test = pd.read_csv('..\/input\/used-car-price-dataset-competition-format\/X_test.csv')\ny_train = pd.read_csv('..\/input\/used-car-price-dataset-competition-format\/y_train.csv')\ny_test = pd.read_csv('..\/input\/used-car-price-dataset-competition-format\/test_label\/y_test.csv')","c7dc2e00":"y_train.sample(5)","dac2429a":"X_train.sample(5)","f04389c4":"X_train.isnull().sum()","26b08b7e":"X_test.isnull().sum()","63f2c3c4":"X_train.info()","7baddcfe":"cols = ['brand', 'model', 'transmission', 'fuelType']\nfor col in cols:\n    print(X_train[col].unique())\nfor col in cols:\n    print(X_test[col].unique())","11eb5577":"for col in cols:\n    le = LabelEncoder()\n    le.fit(X_train[col])\n    X_train[col] = le.transform(X_train[col])\n    X_test[col] = le.transform(X_test[col])\nX_train.sample(5)","4af25bc1":"X_train = X_train.drop('carID', axis=1)\nX_train.sample(5)\nX_test = X_test.drop('carID', axis=1)","f249b415":"model = RandomForestRegressor()\n\nparams = {'n_estimators': [10, 50, 100],\n         'max_depth': [6, 8, 10, 12],\n         'min_samples_leaf': [8, 12, 18],\n         'min_samples_split': [8, 16, 20]}\n\ngrid_cv = GridSearchCV(model, param_grid = params, cv = 3, n_jobs = -1)\ngrid_cv.fit(X_train, y_train['price'])\n\nprint('\ucd5c\uc801 \ud30c\ub77c\ubbf8\ud130:', grid_cv.best_params_)\nprint(f'\ucd5c\uace0 \uc810\uc218: {grid_cv.best_score_:.4f}')","ac3e9095":"model = RandomForestRegressor(n_estimators = 50,\n                             max_depth = 12,\n                             min_samples_leaf = 8,\n                             min_samples_split = 8)\n\nmodel.fit(X_train, y_train['price'])\nprint(model.score(X_train, y_train['price']))","c5c6c70c":"prediction = model.predict(X_test)\nround(r2_score(y_test['price'], prediction),4)","eae9e84c":"prediction","711b94ca":"pd.DataFrame({'carID': y_test.carID, 'price': prediction}).to_csv('3333333.csv', index=False)","e34c81cf":"df = pd.read_csv('.\/3333333.csv')\ndf.head()","0bd5db9b":"# \ub79c\ub364\ud3ec\ub808\uc2a4\ud2b8 \ubaa8\ub378\ub9c1"}}