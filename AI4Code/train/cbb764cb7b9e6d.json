{"cell_type":{"8847da75":"code","e7cde045":"code","2a808689":"code","80106512":"code","3a972136":"code","4a20a4b2":"code","200343c4":"code","adacc69e":"code","b7a2c565":"code","b004219e":"code","b53b8ff1":"code","bb826abd":"code","e081d4bc":"code","182059c6":"code","1e660633":"code","f422ec1e":"code","727d5db9":"code","2ce772c6":"code","3efdf418":"code","248238e3":"code","2024594b":"code","cb2518e6":"code","7438da5e":"code","dcce3f34":"markdown","2c709bc5":"markdown","ed74c428":"markdown","1f744e59":"markdown","0c3c86df":"markdown","0474ca99":"markdown","704e7bf2":"markdown","77fee4a6":"markdown","5b68af73":"markdown","22119970":"markdown"},"source":{"8847da75":"import numpy as np\nimport pandas as pd\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n        ","e7cde045":"data = pd.read_csv('\/kaggle\/input\/insurance\/insurance.csv')\ndata.head()","2a808689":"data.isnull().sum()","80106512":"from sklearn.preprocessing import LabelEncoder\n\n\n\n#sex\nle=LabelEncoder()\ndata.sex=le.fit_transform(data.sex)\n\n#smoker\ndata.smoker=le.fit_transform(data.smoker)\n\n#region\ndata_region=pd.get_dummies(data.region)\n\ndata=pd.concat([data,data_region],axis=1)\ndata=data.drop(['region'],axis=1)\n\n\ndata.head()","3a972136":"data.corr()['charges'].sort_values()","4a20a4b2":"import seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n\nf,ax=plt.subplots(figsize=(12,10))\ncorr=data.corr()\nsns.heatmap(corr, mask=np.zeros_like(corr, dtype=np.bool), cmap=sns.diverging_palette(240,10,as_cmap=True),\n            square=True, ax=ax)\n","200343c4":"fig, ax = plt.subplots(figsize =(10, 7))\nax.hist(data.charges)\nplt.style.use('ggplot')\n# Show plot\nplt.show()\n\n","adacc69e":"f= plt.figure(figsize=(12,5))\n\nax=f.add_subplot(121)\nsns.distplot(data[(data.smoker == 1)][\"charges\"],color='c',ax=ax)\nax.set_title('Distribution of charges for smokers')\n\nax=f.add_subplot(122)\nsns.distplot(data[(data.smoker == 0)]['charges'],color='b',ax=ax)\nax.set_title('Distribution of charges for non-smokers') \nplt.tight_layout()","b7a2c565":"sns.catplot(x=\"smoker\", kind=\"count\",hue = 'sex', palette=\"pink\", data=data)","b004219e":"sns.catplot(x=\"sex\", y=\"charges\", hue=\"smoker\",\n            kind=\"violin\", data=data, palette = 'magma')","b53b8ff1":"plt.figure(figsize=(12,5))\nplt.title(\"Box plot for charges of women\")\nsns.boxplot(y=\"smoker\", x=\"charges\", data =  data[(data.sex == 1)] , orient=\"h\", palette = 'magma')","bb826abd":"plt.figure(figsize=(12,5))\nplt.title(\"Box plot for charges of men\")\nsns.boxplot(y=\"smoker\", x=\"charges\", data =  data[(data.sex == 0)] , orient=\"h\", palette = 'rainbow')","e081d4bc":"plt.figure(figsize=(12,5))\nplt.title(\"Distribution of age\")\nax = sns.distplot(data[\"age\"], color = 'g')","182059c6":"sns.lmplot(x=\"age\", y=\"charges\", hue=\"smoker\", data=data, palette = 'inferno_r', size = 7)\nax.set_title('Smokers and non-smokers')","1e660633":"plt.figure(figsize=(12,5))\nplt.title(\"Distribution of bmi\")\nax = sns.distplot(data[\"bmi\"], color = 'm')","f422ec1e":"plt.figure(figsize=(10,6))\nax = sns.scatterplot(x='bmi',y='charges',data=data,palette='magma',hue='smoker')\nax.set_title('Scatter plot of charges and bmi')\n\nsns.lmplot(x=\"bmi\", y=\"charges\", hue=\"smoker\", data=data, palette = 'magma', size = 8)","727d5db9":"sns.catplot(x=\"children\", kind=\"count\", palette=\"ch:.25\", data=data, size = 6)","2ce772c6":"sns.catplot(x=\"smoker\", kind=\"count\", palette=\"rainbow\",hue = \"sex\",\n            data=data[(data.children > 0)], size = 6)\nax.set_title('Smokers and non-smokers who have childrens')","3efdf418":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.metrics import r2_score,mean_squared_error\nfrom sklearn.ensemble import RandomForestRegressor","248238e3":"x = data.drop(['charges'], axis = 1)\ny = data.charges\n\nx_train,x_test,y_train,y_test = train_test_split(x,y, random_state = 0)\nlr = LinearRegression().fit(x_train,y_train)\n\ny_train_pred = lr.predict(x_train)\ny_test_pred = lr.predict(x_test)\n\nprint(lr.score(x_test,y_test))","2024594b":"X = data.drop(['charges'], axis = 1)\nY = data.charges\n\n\n\nquad = PolynomialFeatures (degree = 2)\nx_quad = quad.fit_transform(X)\n\nX_train,X_test,Y_train,Y_test = train_test_split(x_quad,Y, random_state = 0)\n\nplr = LinearRegression().fit(X_train,Y_train)\n\nY_train_pred = plr.predict(X_train)\nY_test_pred = plr.predict(X_test)\n\nprint(plr.score(X_test,Y_test))","cb2518e6":"forest = RandomForestRegressor(n_estimators = 100,\n                              criterion = 'mse',\n                              random_state = 1,\n                              n_jobs = -1)\nforest.fit(x_train,y_train)\nforest_train_pred = forest.predict(x_train)\nforest_test_pred = forest.predict(x_test)\n\nprint('MSE train data: %.3f, MSE test data: %.3f' % (\nmean_squared_error(y_train,forest_train_pred),\nmean_squared_error(y_test,forest_test_pred)))\nprint('R2 train data: %.3f, R2 test data: %.3f' % (\nr2_score(y_train,forest_train_pred),\nr2_score(y_test,forest_test_pred)))","7438da5e":"plt.figure(figsize=(10,6))\n\nplt.scatter(forest_train_pred,forest_train_pred - y_train,\n          c = 'black', marker = 'o', s = 35, alpha = 0.5,\n          label = 'Train data')\nplt.scatter(forest_test_pred,forest_test_pred - y_test,\n          c = 'c', marker = 'o', s = 35, alpha = 0.7,\n          label = 'Test data')\nplt.xlabel('Predicted values')\nplt.ylabel('Tailings')\nplt.legend(loc = 'upper left')\nplt.hlines(y = 0, xmin = 0, xmax = 60000, lw = 2, color = 'red')\nplt.show()","dcce3f34":"<img src= \"https:\/\/alexanderprange.files.wordpress.com\/2018\/10\/asuma-smoking.gif?w=364\" style='width: 400px; margin-left:180px;' >","2c709bc5":"The dataset above is about the cost of treatment of patients.\nThe cost of treatment according to dataset may depend upon :\n\n    -> Age\n    -> Sex\n    -> BMI\n    -> Children\n    -> Smoking Habit\n    -> Region","ed74c428":"Now let's pay attention to the age of the patients. First, let's look at how age affects the cost of treatment, and also look at patients of what age more in our data set.","1f744e59":"Smoking patients spend more on treatment. But there is a feeling that the number of non-smoking patients is greater. Going to check it.","0c3c86df":"### Encoding Categorical Features","0474ca99":"Now we are going to predict the cost of treatment. Let's start with the usual linear regression.","704e7bf2":"A strong correlation is observed only with the fact of smoking the patient. To be honest, I expected a higher correlation with bmi. Well. We investigate smoking in more detail.","77fee4a6":"Good to see there are no \"NaN\" in the data.","5b68af73":"<img src= \"https:\/\/2rdnmg1qbg403gumla1v9i2h-wpengine.netdna-ssl.com\/wp-content\/uploads\/sites\/3\/2018\/05\/healthyVagina-1193121403-770x553-1-650x428.jpg\" style='width: 600px; margin-left:100px;' >","22119970":"Please note that women are coded with the symbol \" 1 \"and men - \"0\". Thus non-smoking people and the truth more."}}