{"cell_type":{"bb72e9b4":"code","921cd36f":"code","27851ac8":"code","85b9c3b2":"code","aa806144":"code","66d371a5":"code","6e03bb2c":"code","cad74ea9":"code","fd3d89cb":"code","81ba55ab":"code","818d4cfd":"code","85312722":"code","3629244a":"code","17f6faa8":"code","32bede07":"code","39befa01":"code","e6ba2ca1":"code","6e6c53d0":"code","0ff8f623":"code","b22084d8":"code","0746dbd3":"code","d95b7346":"code","3bc27b7a":"code","90f82ba8":"code","20446350":"code","09e2b285":"code","a888574c":"code","bafb5340":"code","b3b77ba2":"code","040b7919":"code","cdecf6c2":"code","cc005ce4":"code","4eee7ede":"code","35c151b4":"code","8d064109":"code","8bbabb29":"code","e4e4387e":"code","bcbd1c0e":"code","99d59153":"code","8b8074bc":"code","d11346ac":"code","a2ce0666":"code","23409227":"code","2613f6e6":"code","51bc1822":"code","b364c732":"code","b821ae0f":"code","699fdc90":"code","7bc6c0ee":"code","1e63a3fb":"code","de5bbcad":"code","988364bd":"code","7c070248":"code","fc5ea333":"code","8749b503":"code","4cac6bb8":"code","abc24513":"code","7e8b4c71":"code","69f9e712":"code","e01f6d1e":"code","95e03e9e":"code","0e5acd45":"code","6dd829e1":"code","1e61e4bb":"code","80799bff":"code","32eb6f6e":"markdown","dfa56b57":"markdown","da1fc45d":"markdown","c5e598be":"markdown","2bff894e":"markdown","2f7d2fa9":"markdown","5c72cb92":"markdown","aa8a793d":"markdown"},"source":{"bb72e9b4":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","921cd36f":"import pandas as pd\nfrom sklearn.feature_extraction.text import CountVectorizer, TfidfTransformer, TfidfVectorizer\nfrom sklearn.metrics import accuracy_score,classification_report, confusion_matrix\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.pipeline import Pipeline\n","27851ac8":"f1=pd.read_json('\/kaggle\/input\/news-headlines-dataset-for-sarcasm-detection\/Sarcasm_Headlines_Dataset.json',lines=True)\nf2=pd.read_json('\/kaggle\/input\/news-headlines-dataset-for-sarcasm-detection\/Sarcasm_Headlines_Dataset_v2.json',lines=True)","85b9c3b2":"df=pd.concat([f1,f2],axis=0)\ndf.head()","aa806144":"df.info()","66d371a5":"\nprint('0 : ',df[df['is_sarcastic']==0].count())\nprint('1 : ',df[df['is_sarcastic']==1].count())","6e03bb2c":"from sklearn.ensemble import RandomForestClassifier","cad74ea9":"X=TfidfVectorizer().fit_transform(df['headline'])\nX_train,X_test,y_train,y_test=train_test_split(X,df['is_sarcastic'],test_size=0.2,random_state=101)","fd3d89cb":"model=RandomForestClassifier()\nmodel.fit(X_train,y_train)\ny_pred=model.predict(X_test)\nprint(accuracy_score(y_test,y_pred))","81ba55ab":"X_train,X_test,y_train,y_test=train_test_split(df['headline'],df['is_sarcastic'],test_size=0.2,random_state=101)","818d4cfd":"pipe=Pipeline([('vect',CountVectorizer()),\n              ('tfidf',TfidfTransformer()),\n              ('model',RandomForestClassifier())])\npipe.fit(X_train,y_train)\ny_pred=pipe.predict(X_test)\nprint(accuracy_score(y_test,y_pred))","85312722":"from sklearn.linear_model import LogisticRegression","3629244a":"X=TfidfVectorizer().fit_transform(df['headline'])\nX_train,X_test,y_train,y_test=train_test_split(X,df['is_sarcastic'],test_size=0.2,random_state=101)","17f6faa8":"X_train,X_test,y_train,y_test=train_test_split(df['headline'],df['is_sarcastic'],test_size=0.2,random_state=101)","32bede07":"pipe=Pipeline([('vect',CountVectorizer()),\n              ('tfidf',TfidfTransformer()),\n              ('model',LogisticRegression())])\nmodel=pipe.fit(X_train,y_train)\ny_pred=model.predict(X_test)\nprint(accuracy_score(y_test,y_pred))","39befa01":"print(confusion_matrix(y_test,y_pred))\nprint(classification_report(y_test,y_pred))","e6ba2ca1":"from sklearn.svm import SVC,LinearSVC","6e6c53d0":"X=TfidfVectorizer().fit_transform(df['headline'])\nX_train,X_test,y_train,y_test=train_test_split(X,df['is_sarcastic'],test_size=0.2,random_state=101)","0ff8f623":"model=LinearSVC()\nmodel.fit(X_train,y_train)\ny_pred=model.predict(X_test)\nprint(accuracy_score(y_test,y_pred))","b22084d8":"X_train_,X_test_,y_train_,y_test_=train_test_split(df['headline'],df['is_sarcastic'],test_size=0.2,random_state=101)","0746dbd3":"pipe=Pipeline([('vect',CountVectorizer()),\n              ('tfidf',TfidfTransformer()),\n              ('model',LinearSVC())])\npipe.fit(X_train_,y_train_)\ny_pred=pipe.predict(X_test_)\nprint(accuracy_score(y_test_,y_pred))","d95b7346":"grid_param={'C':[0.1,1,10],\n           'gamma':[1,0.1,0.001]}","3bc27b7a":"grid=GridSearchCV(SVC(),param_grid=grid_param,refit=True,verbose=3)\ngrid.fit(X_train,y_train)","90f82ba8":"model=SVC(C=1,gamma=1)\nmodel.fit(X_train,y_train)\ny_pred=model.predict(X_test)\nprint(accuracy_score(y_test,y_pred))","20446350":"from sklearn.linear_model import SGDClassifier","09e2b285":"pipe=Pipeline([('vect',CountVectorizer()),\n              ('tfidf',TfidfTransformer()),\n              ('model',SGDClassifier())])","a888574c":"model=pipe.fit(X_train_,y_train_)\ny_pred_=model.predict(X_test_)","bafb5340":"print(accuracy_score(y_test_,y_pred_))","b3b77ba2":"from sklearn.naive_bayes import MultinomialNB","040b7919":"X=TfidfVectorizer().fit_transform(df['headline'])\nX_train,X_test,y_train,y_test=train_test_split(X,df['is_sarcastic'],test_size=0.2,random_state=101)","cdecf6c2":"model=MultinomialNB()\nmodel.fit(X_train,y_train)","cc005ce4":"y_pred=model.predict(X_test)\nprint(accuracy_score(y_test,y_pred))","4eee7ede":"X_train_,X_test_,y_train_,y_test_=train_test_split(df['headline'],df['is_sarcastic'],test_size=0.2,random_state=101)","35c151b4":"pipe=Pipeline([('vect',CountVectorizer()),\n              ('tfidf',TfidfTransformer()),\n              ('model',MultinomialNB())])\npipe.fit(X_train_,y_train_)","8d064109":"y_pred_=pipe.predict(X_test_)\nprint(accuracy_score(y_test_,y_pred_))","8bbabb29":"from sklearn.naive_bayes import BernoulliNB","e4e4387e":"pipe=Pipeline([('vect',CountVectorizer()),\n              ('tfidf',TfidfTransformer()),\n              ('model',BernoulliNB())])\npipe.fit(X_train_,y_train_)","bcbd1c0e":"y_pred_=pipe.predict(X_test_)\nprint(accuracy_score(y_test_,y_pred_))","99d59153":"para={'alpha':[1,0.5,0.1,0.01,0]}","8b8074bc":"model=GridSearchCV(estimator=BernoulliNB(),param_grid=para,n_jobs=-1,cv=3,verbose=3)","d11346ac":"model.fit(X_train,y_train)","a2ce0666":"y_pred=model.predict(X_test)\nprint(accuracy_score(y_test,y_pred))","23409227":"from sklearn.ensemble import GradientBoostingClassifier","2613f6e6":"X_train,X_test,y_train,y_test=train_test_split(TfidfVectorizer().fit_transform(df['headline']),\n                                              df['is_sarcastic'],\n                                              test_size=0.2,\n                                               random_state=101)\nX_train_,X_test_,y_train_,y_test_=train_test_split(df['headline'],\n                                                   df['is_sarcastic'],\n                                                   test_size=0.2,\n                                                   random_state=101)","51bc1822":"model=GradientBoostingClassifier()\nmodel.fit(X_train,y_train)\ny_pred=model.predict(X_test)\nprint(accuracy_score(y_test,y_pred))","b364c732":"pipe=Pipeline([('vect',CountVectorizer()),\n             ('tdidf',TfidfTransformer()),\n             ('model',GradientBoostingClassifier())])\npipe.fit(X_train_,y_train_)\ny_pred_=pipe.predict(X_test_)\nprint(accuracy_score(y_test_,y_pred_))","b821ae0f":"from xgboost import XGBClassifier","699fdc90":"pipe=Pipeline([('vect',CountVectorizer()),\n              ('tfidf',TfidfTransformer()),\n              ('model',XGBClassifier())])\npipe.fit(X_train_,y_train_)","7bc6c0ee":"y_pred_=pipe.predict(X_test_)\nprint(accuracy_score(y_test_,y_pred_))","1e63a3fb":"from sklearn.tree import DecisionTreeClassifier","de5bbcad":"X_train,X_test,y_train,y_test=train_test_split(TfidfVectorizer().fit_transform(df['headline']),\n                                              df['is_sarcastic'],\n                                              test_size=0.2,\n                                              random_state=101)\nX_train_,X_test_,y_train_,y_test_=train_test_split(df['headline'],df['is_sarcastic'],\n                                                  test_size=0.2,\n                                                  random_state=101)","988364bd":"model=DecisionTreeClassifier()\nmodel.fit(X_train,y_train)","7c070248":"y_pred=model.predict(X_test)\nprint(accuracy_score(y_test,y_pred))","fc5ea333":"params = {'max_leaf_nodes': list(range(2, 100,10)), 'min_samples_split': [2, 3, 4]}\ngrid_search_cv = GridSearchCV(DecisionTreeClassifier(random_state=42), params, verbose=1, cv=3)\ngrid_search_cv.fit(X_train, y_train)","8749b503":"grid_search_cv.best_params_","4cac6bb8":"model=grid_search_cv.best_estimator_","abc24513":"model.fit(X_train,y_train)\ny_pred=model.predict(X_test)\nprint(accuracy_score(y_test,y_pred))","7e8b4c71":"pipe=Pipeline([('vect',CountVectorizer()),\n              ('tfidf',TfidfTransformer()),\n              ('model',DecisionTreeClassifier())])\npipe.fit(X_train_,y_train_)","69f9e712":"y_pred_=pipe.predict(X_test_)\nprint(accuracy_score(y_test_,y_pred_))","e01f6d1e":"from sklearn.neighbors import KNeighborsClassifier","95e03e9e":"X_train,X_test,y_train,y_test=train_test_split(TfidfVectorizer().fit_transform(df['headline']),\n                                              df['is_sarcastic'],\n                                              test_size=0.2,\n                                              random_state=101)\nX_train_,X_test_,y_train_,y_test_=train_test_split(df['headline'],\n                                                  df['is_sarcastic'],\n                                                  test_size=0.2,random_state=101)","0e5acd45":"model=KNeighborsClassifier()\nmodel.fit(X_train,y_train)\ny_pred=model.predict(X_test)\nprint(accuracy_score(y_test,y_pred))","6dd829e1":"grid=GridSearchCV(estimator=KNeighborsClassifier(),param_grid={'n_neighbors':[1,2,10,20,50]},verbose=3,n_jobs=1)\ngrid.fit(X_train,y_train)","1e61e4bb":"model=grid.best_estimator_\nmodel.fit(X_train,y_train)\ny_pred=model.predict(X_test)\nprint(accuracy_score(y_test,y_pred))","80799bff":"pipe=Pipeline([('vect',CountVectorizer()),\n              ('tfidf',TfidfTransformer()),\n              ('model',KNeighborsClassifier())])\npipe.fit(X_train_,y_train_)\ny_pred_=pipe.predict(X_test_)\nprint(accuracy_score(y_test_,y_pred_))","32eb6f6e":"#### KNN Classifier","dfa56b57":"#### Random Forest Classifier","da1fc45d":"#### XGBoost Classifier","c5e598be":"#### Decision Tree","2bff894e":"#### Logistic Regression","2f7d2fa9":"#### Support Vector Classifier","5c72cb92":"#### Naive Bayes","aa8a793d":"#### Gradient Boost Classifier"}}