{"cell_type":{"332f031d":"code","0bc1530b":"code","6038436d":"code","c7b72f28":"code","bd1009a5":"code","671fc392":"code","566e9a69":"code","ae63bf81":"code","991eff32":"code","bd2e4300":"code","3109e423":"code","a4b6bdb9":"code","6974ade3":"code","b087fffc":"code","f8ccd01c":"code","cfb7fe2f":"code","9ef3df9b":"code","9f8d3a89":"code","50d43d12":"code","b784deb9":"code","6d0f2119":"code","ff9db78e":"code","58f4ab92":"code","ebc742eb":"code","137adb18":"code","49b247c9":"code","a1445319":"code","c634b8a1":"code","e4501025":"code","3abe0795":"code","dca04b1c":"code","c2b4dd41":"code","f9c4c4f0":"code","a77259fa":"code","e8d59c2d":"code","c8f5cb66":"code","c56995cd":"code","7594228e":"code","606c0093":"code","d8c77aa7":"code","61aa6c4a":"code","26e77aea":"code","71574800":"markdown","f5b96626":"markdown","d680444e":"markdown","76de4c42":"markdown","1524accc":"markdown","e1e8f50a":"markdown"},"source":{"332f031d":"import pandas as pd\nimport cv2\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport matplotlib.cm as mtpltcm\nfrom mpl_toolkits.mplot3d import Axes3D\nimport random\nimport folium\nfrom folium.plugins import HeatMap, HeatMapWithTime\nfrom folium import plugins\nfrom netCDF4 import Dataset\nimport cartopy.crs as ccrs\nimport pydub\nfrom scipy.io.wavfile import read, write\nimport librosa\nimport librosa.display\nimport IPython\nfrom IPython.display import Audio\nimport scipy\nimport skimage\nfrom IPython.display import HTML\nimport matplotlib.animation as animation\nimport PIL\nfrom scipy import signal\nfrom scipy.fft import fftshift\nfrom mpl_toolkits.mplot3d import art3d\nimport os\nimport os.path\nfrom pathlib import Path\nimport glob\n\n\nfrom warnings import filterwarnings\n\nfilterwarnings(\"ignore\",category=DeprecationWarning)\nfilterwarnings(\"ignore\", category=FutureWarning) \nfilterwarnings(\"ignore\", category=UserWarning)\nfilterwarnings(\"ignore\", category=RuntimeWarning)","0bc1530b":"ALL_CDF_PATH = \"..\/input\/monthly-mass-grids-global-mascons-nasa\/CSR_GRACE_GRACE-FO_RL06_Mascons_all-corrections_v02.nc\"\nREAD_CDF = Dataset(ALL_CDF_PATH)","6038436d":"READ_CDF","c7b72f28":"print(READ_CDF.variables.keys())","bd1009a5":"print(READ_CDF.variables[\"lwe_thickness\"].long_name)","671fc392":"print(READ_CDF.variables[\"lwe_thickness\"].dimensions)","566e9a69":"print(READ_CDF.variables[\"lwe_thickness\"].datatype)","ae63bf81":"print(READ_CDF.variables[\"lwe_thickness\"].shape)","991eff32":"print(READ_CDF.variables[\"lwe_thickness\"].coordinates)","bd2e4300":"print(READ_CDF.variables[\"lwe_thickness\"].name)","3109e423":"print(READ_CDF.variables[\"time_bounds\"])","a4b6bdb9":"print(READ_CDF.variables[\"time_bounds\"].datatype)","6974ade3":"print(READ_CDF.variables[\"time_bounds\"].name)","b087fffc":"print(READ_CDF.variables[\"time_bounds\"].ndim)","f8ccd01c":"print(READ_CDF.variables[\"time_bounds\"].shape)","cfb7fe2f":"print(READ_CDF.variables[\"lwe_thickness\"])","9ef3df9b":"LWE_THICKNESS_GENERAL = READ_CDF.variables[\"lwe_thickness\"][0,:,:]\nLAT_DATA = READ_CDF.variables[\"lat\"][:]\nLON_DATA = READ_CDF.variables[\"lon\"][:]\nTIME_DATA = READ_CDF.variables[\"time\"][:]","9f8d3a89":"LAT_TH = LWE_THICKNESS_GENERAL[:,0]\nLON_TH = LWE_THICKNESS_GENERAL[0,:]\n\nLAT_TH_SER = pd.Series(LAT_TH,name=\"LAT_THICKNESS\").astype(float)\nLON_TH_SER = pd.Series(LON_TH,name=\"LON_THICKNESS\").astype(float)\n\nTIME_SER = pd.Series(TIME_DATA,name=\"TIME\").astype(float)\nLAT_SER = pd.Series(LAT_DATA,name=\"LAT\").astype(float)\nLON_SER = pd.Series(LON_DATA,name=\"LON\").astype(float)\n\nMAIN_TARGET = pd.concat([TIME_SER,LAT_SER,LON_SER,LAT_TH_SER,LON_TH_SER],axis=1)\n\nMAIN_TARGET[\"TOTAL_THICKNESS\"] = MAIN_TARGET[\"LAT_THICKNESS\"] + MAIN_TARGET[\"LON_THICKNESS\"]","50d43d12":"MAIN_TARGET.dropna(axis=0,inplace=True)","b784deb9":"print(TIME_DATA)","6d0f2119":"print(TIME_DATA.shape)","ff9db78e":"print(TIME_DATA.size)","58f4ab92":"LWE_THICKNESS_TIME = READ_CDF.variables[\"lwe_thickness\"][:,0,0]","ebc742eb":"print(READ_CDF.variables[\"time_bounds\"][0,:])","137adb18":"print(READ_CDF.variables[\"time_bounds\"][:,0])","49b247c9":"print(READ_CDF.variables[\"time_bounds\"].dimensions)","a1445319":"print(len(READ_CDF.variables[\"lwe_thickness\"][:,0,0]))","c634b8a1":"def displaying_video(source):\n    \n    figure = plt.figure(figsize=(16,11))\n\n    Image_List = []\n    \n    for indexing in source:\n        \n        Read_IMG = plt.imshow(indexing, animated=True,cmap=\"hot\")\n        plt.axis('off')\n        Image_List.append([Read_IMG])\n\n    Animation_Func = animation.ArtistAnimation(figure, Image_List, interval=412, repeat_delay=10200)\n    \n    plt.close()\n    \n    return Animation_Func","e4501025":"i_count = 0\nTRANSFORMED_IMG = []\n\nwhile i_count <= len(READ_CDF.variables[\"lwe_thickness\"][:,0,0]):\n    \n\n    figure = plt.figure(figsize=(15,10))\n\n    axis_func = plt.axes(projection=ccrs.Robinson())\n    axis_func.set_global()\n    axis_func.coastlines(resolution=\"110m\",linewidth=1)\n    axis_func.gridlines(linestyle='--',color='black',linewidth=2)\n\n    plt.contourf(LON_DATA, LAT_DATA, READ_CDF.variables[\"lwe_thickness\"][i_count*5,:,:], transform=ccrs.PlateCarree(),cmap=\"RdGy\")\n    color_bar_func = plt.colorbar(ax=axis_func, orientation=\"horizontal\",aspect=16, shrink=0.8, extend=\"max\")\n    color_bar_func.ax.tick_params(labelsize=10)\n    \n    i_count = i_count + 1\n    plt.savefig(f\"IMG_RESULT_{i_count}.jpg\")\n    \n    \n    NEW_READING_IMG = cv2.cvtColor(cv2.imread(f\"IMG_RESULT_{i_count}.jpg\"),cv2.COLOR_BGR2RGB)\n    TRANSFORMED_IMG.append(NEW_READING_IMG)\n    \n    plt.tight_layout()\n    plt.show()","3abe0795":"print(len(TRANSFORMED_IMG))","dca04b1c":"HTML(displaying_video(TRANSFORMED_IMG).to_html5_video())","c2b4dd41":"MAIN_TARGET","f9c4c4f0":"plt.figure(figsize=(18,7))\nplt.title(READ_CDF.variables[\"lwe_thickness\"].long_name)\nplt.plot(MAIN_TARGET[\"TOTAL_THICKNESS\"],color=\"black\")\nplt.tight_layout()\nplt.show()","a77259fa":"plt.figure(figsize=(18,7))\nplt.title(READ_CDF.variables[\"lwe_thickness\"].long_name)\nplt.plot(MAIN_TARGET[\"TOTAL_THICKNESS\"],color=\"black\")\nplt.plot(MAIN_TARGET[\"LAT_THICKNESS\"],color=\"red\")\nplt.plot(MAIN_TARGET[\"LON_THICKNESS\"],color=\"blue\")\nplt.tight_layout()\nplt.show()","e8d59c2d":"print(MAIN_TARGET[MAIN_TARGET[\"TOTAL_THICKNESS\"] == MAIN_TARGET[\"TOTAL_THICKNESS\"].max()])","c8f5cb66":"print(MAIN_TARGET[MAIN_TARGET[\"TOTAL_THICKNESS\"] == MAIN_TARGET[\"TOTAL_THICKNESS\"].min()])","c56995cd":"MAP_FUNCTION = folium.Map(location=[1.9637,35.2433],\n                  tiles='Stamen Terrain',\n                  zoom_start=2.0)\n\nfolium.CircleMarker(\n    location=[-70.625,19.375],\n    radius=20,\n    popup=\"<b>MIN 1<b>\",\n    tooltip=\"Click me\",\n    color='#2F4F4F',\n    fill=True,\n    fill_color='red',\n).add_to(MAP_FUNCTION)\n\nfolium.CircleMarker(\n    location=[-70.375,19.625],\n    radius=20,\n    popup=\"<b>MIN 2<b>\",\n    tooltip=\"Click me\",\n    color='#2F4F4F',\n    fill=True,\n    fill_color='green',\n).add_to(MAP_FUNCTION)\n\nfolium.CircleMarker(\n    location=[-70.125,19.875],\n    radius=20,\n    popup=\"<b>MIN 3<b>\",\n    tooltip=\"Click me\",\n    color='#2F4F4F',\n    fill=True,\n    fill_color='blue',\n).add_to(MAP_FUNCTION)\n\nfolium.CircleMarker(\n    location=[-69.875,20.125],\n    radius=20,\n    popup=\"<b>MIN 4<b>\",\n    tooltip=\"Click me\",\n    color='#2F4F4F',\n    fill=True,\n    fill_color='black',\n).add_to(MAP_FUNCTION)\n\nMAP_FUNCTION","7594228e":"MAP_FUNCTION = folium.Map(location=[1.9637,35.2433],\n                  tiles='Stamen Terrain',\n                  zoom_start=2.0)\n\nfolium.CircleMarker(\n    location=[-72.625,17.375],\n    radius=20,\n    popup=\"<b>MAX 1<b>\",\n    tooltip=\"Click me\",\n    color='#2F4F4F',\n    fill=True,\n    fill_color='red',\n).add_to(MAP_FUNCTION)\n\nfolium.CircleMarker(\n    location=[-72.375,17.625],\n    radius=20,\n    popup=\"<b>MAX 2<b>\",\n    tooltip=\"Click me\",\n    color='#2F4F4F',\n    fill=True,\n    fill_color='green',\n).add_to(MAP_FUNCTION)\n\nfolium.CircleMarker(\n    location=[-72.125,17.875],\n    radius=20,\n    popup=\"<b>MAX 3<b>\",\n    tooltip=\"Click me\",\n    color='#2F4F4F',\n    fill=True,\n    fill_color='blue',\n).add_to(MAP_FUNCTION)\n\nfolium.CircleMarker(\n    location=[-71.875,18.125],\n    radius=20,\n    popup=\"<b>MAX 4<b>\",\n    tooltip=\"Click me\",\n    color='#2F4F4F',\n    fill=True,\n    fill_color='black',\n).add_to(MAP_FUNCTION)\n\nMAP_FUNCTION","606c0093":"PLOT_LIST = []\n\nfor i_count in range(len(READ_CDF.variables[\"lwe_thickness\"][:,0,0])):\n    \n    figure = plt.figure(figsize=(15,10))\n    plt.figure(figsize=(18,7))\n    plt.title(READ_CDF.variables[\"lwe_thickness\"].long_name)\n    plt.plot(READ_CDF.variables[\"lwe_thickness\"][i_count*2,:,0],color=\"black\")\n    plt.plot(READ_CDF.variables[\"lwe_thickness\"][i_count*2,0,:],color=\"red\")\n    plt.savefig(f\"PLOT_RESULT_{i_count}.jpg\")\n    \n    \n    NEW_READING_IMG = cv2.cvtColor(cv2.imread(f\"PLOT_RESULT_{i_count}.jpg\"),cv2.COLOR_BGR2RGB)\n    PLOT_LIST.append(NEW_READING_IMG)\n    plt.tight_layout()\n    plt.show()","d8c77aa7":"print(len(PLOT_LIST))","61aa6c4a":"def displaying_plot(source):\n    \n    figure = plt.figure(figsize=(16,11))\n\n    Image_List = []\n    plt.style.use(\"dark_background\")\n    for indexing in source:\n        \n        Read_IMG = plt.imshow(indexing, animated=True,cmap=\"hot\")\n        plt.axis('off')\n        Image_List.append([Read_IMG])\n\n    Animation_Func = animation.ArtistAnimation(figure, Image_List, interval=210, repeat_delay=10200)\n    \n    plt.close()\n    \n    return Animation_Func","26e77aea":"HTML(displaying_plot(PLOT_LIST).to_html5_video())","71574800":"# HISTORY\n\n* Launched 17 March 2002, Gravity Recovery and Climate Experiment (GRACE) twin satelliteshe Gravity Recovery and Climate Experiment (GRACE) twin satellites made detailed measurements of Earth's gravity field and improved investigations about Earth's water reservoirs, over land, ice and oceans. GRACE was a collaboration of the US and German space agencies (NASA and DLR). The key partners were the University of Texas Center for Space Research (CSR), the GeoForschungsZentrum (GFZ) Potsdam, and the Jet Propulsion Laboratory (JPL).\n\n* GRACE measured gravity by relating it to the distance between the twin satellites. When there was an increase in gravity ahead of the pair, the front satellite sped up and the distance between the pair increased. When there was an increase in gravity between the pair their distance decreased. The opposite occurred when there was decreased gravity ahead of, or between the satellite pair. The satellites were separated by 220 km and could detect changes smaller than a micrometer per second in relative velocity. These measurements, in conjunction with other data and models, provided observations of terrestrial water storage changes, ice-mass variations, ocean bottom pressure changes and sea-level variations.\n\n* GRACE ended its science mission in 12 October 2017.\n\n#### MASCONS\n\n* Mass Concentration blocks (mascons) are essentially another form of gravity field basis functions to which GRACE\u2019s inter-satellite ranging observations are fit. Using \u2018mascons\u2019 rather than the standard spherical harmonic approach, which has been the standard for the first decade of GRACE\/GRACE-FO observations, offers several key advantages. With mascons, we can implement geophysical constraints much easier. These a priori constraints help to filter out noise from the GRACE\/GRACE-FO observations at the Level-2 processing step, which is a much more rigorous approach than the empirical post-processing filtering applied to land and ocean grids derived from spherical harmonics.\n\n* The units of the data and error grids are centimeters of equivalent water thickness; gain factors are dimensionless. If each grid node is g(x,y,t) where x is longitude index, y is latitude index, t is time (month) index, and the scaling grid is s(x,y), then the gain-corrected time series is simply\n\n* g'(x,y,t) = g(x,y,t) * s(x,y)\n\n![](https:\/\/podaac.jpl.nasa.gov\/sites\/default\/files\/mission_themes\/featured_image\/Gravity-Recovery-Climate-Experiment-GRACE-Mission-opt.jpg)","f5b96626":"pip install mpl-toolkits.clifford","d680444e":"# DATA OVERVIEW AND NETCDF","76de4c42":"# PACKAGES AND LIBRARIES","1524accc":"# WHAT IS NETCDF\n\n* NetCDF is a set of software libraries and self-describing, machine-independent data formats that support the creation, access, and sharing of array-oriented scientific data. NetCDF was developed and is maintained at Unidata. Unidata provides data and software tools for use in geoscience education and research. Unidata is part of the University Corporation for Atmospheric Research (UCAR) Community Programs (UCP). Unidata is funded primarily by the National Science Foundation.Programming interfaces are also available for Python, IDL, MATLAB, R, Ruby, and Perl.\n\nSelf-Describing:\n\n* A netCDF file includes information about the data it contains.\n\nPortable:\n\n* A netCDF file can be accessed by computers with different ways of storing integers, characters, and floating-point numbers.\n\nScalable:\n\n* Small subsets of large datasets in various formats may be accessed efficiently through netCDF interfaces, even from remote servers.\n\nAppendable:\n\n* Data may be appended to a properly structured netCDF file without copying the dataset or redefining its structure.\n\nSharable:\n\n* One writer and multiple readers may simultaneously access the same netCDF file.\n\nArchivable:\n\n* Access to all earlier forms of netCDF data will be supported by current and future versions of the software.","e1e8f50a":"# What is Equivalent Water Thickness\n\n* The observed monthly changes in gravity are caused by monthly changes in mass. The mass changes can be thought of as concentrated in a very thin layer of water thickness changes near the Earth's surface (i.e., in a layer up to several kilometers thick). In reality, most of the monthly gravity changes are indeed caused by changes in water storage in hydrologic reservoirs, by moving ocean, atmospheric and land ice masses, and by mass exchanges between these Earth system compartments. Their vertical extent is measured in centimeters of equivalent water thickness, much smaller than the radius of the Earth or the horizontal scales of the changes, which are measured in kilometers. Some changes in gravity are caused by mass redistribution in the 'solid' Earth, such as those following a large earthquake, or those due to glacial isostatic adjustment; in those cases, the interpretation of the gravity changes in terms of 'equivalent water thickness' are not correct, even though it is still possible to compute this quantity (i.e., by removing the solid Earth effects to isolate the water-related mass changes)."}}