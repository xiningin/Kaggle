{"cell_type":{"dd1d8756":"code","b1fe2075":"code","cf3342dc":"code","a7be57e7":"code","3d096c19":"code","b134d3c4":"code","eca6c288":"code","39eb024e":"markdown","2a8dff82":"markdown"},"source":{"dd1d8756":"from fastai.vision import *\nfrom fastai.metrics import error_rate","b1fe2075":"PATH = \"..\/input\"\nSEED = 42\nsz = 224\nbs = 64\n\nsub_df = pd.read_csv(f\"{PATH}\/sample_submission.csv\")\ntest_df = pd.read_csv(f\"{PATH}\/sample_submission.csv\")","cf3342dc":"data = ImageDataBunch.from_folder(PATH, valid_pct=0.1, ds_tfms=get_transforms(), size=sz, bs=bs, seed=SEED)\ndata.add_test(ImageList.from_df(test_df, PATH, folder=\"test\/test\"))\n\nlearn = cnn_learner(data, models.resnet18, metrics=error_rate)","a7be57e7":"learn.fit_one_cycle(1)","3d096c19":"test_probs, _ = learn.get_preds(ds_type=DatasetType.Test)\ntest_preds = [data.classes[pred] for pred in np.argmax(test_probs.numpy(), axis=-1)]","b134d3c4":"sub_df.predicted_class = test_preds\nsub_df.to_csv(\"submission.csv\", index=False)","eca6c288":"sub_df.head()","39eb024e":"## Train Model","2a8dff82":"## Generate Predictions"}}