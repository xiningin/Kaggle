{"cell_type":{"5d3bd358":"code","99b45c0b":"code","960f7c51":"code","71567580":"code","890b14fa":"code","a7b5accf":"code","0e19d17b":"code","0a8fe52f":"code","0e77d96a":"code","a5932238":"code","00ee48f8":"code","65b3b26b":"code","99d672de":"code","4d032e9a":"code","8d198ecd":"code","ace0f755":"code","d1286b9f":"code","6a0c0f68":"code","af01bedc":"code","c2d459f1":"code","dec29e9e":"code","d0e057a4":"code","e1efcad7":"code","f653f0ef":"code","2d691920":"code","ae1bddbc":"code","4849f103":"code","c45381cf":"markdown","b40e3b66":"markdown","2aa18190":"markdown","a7752bef":"markdown","09f59a80":"markdown","72843a71":"markdown","14ad1501":"markdown","eed9759a":"markdown","ab4bb676":"markdown","f4e1d5eb":"markdown","58d448f2":"markdown"},"source":{"5d3bd358":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n# Importing the Keras libraries and packages\nimport keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nsns.set_style('darkgrid')","99b45c0b":"qcm3 = pd.read_csv('\/kaggle\/input\/qcm-sensor-alcohol-dataset\/QCM3.csv', sep = ';')\nqcm6 = pd.read_csv('\/kaggle\/input\/qcm-sensor-alcohol-dataset\/QCM6.csv', sep = ';')\nqcm7 = pd.read_csv('\/kaggle\/input\/qcm-sensor-alcohol-dataset\/QCM7.csv', sep = ';')\nqcm10 = pd.read_csv('\/kaggle\/input\/qcm-sensor-alcohol-dataset\/QCM10.csv', sep = ';')\nqcm12 = pd.read_csv('\/kaggle\/input\/qcm-sensor-alcohol-dataset\/QCM12.csv', sep = ';')","960f7c51":"print(\"Shape of qcm3: \", qcm3.shape)\nprint(\"Shape of qcm6: \", qcm6.shape)\nprint(\"Shape of qcm7: \", qcm7.shape)\nprint(\"Shape of qcm10: \", qcm10.shape)\nprint(\"Shape of qcm12: \", qcm12.shape)","71567580":"dataset = pd.concat([qcm3, qcm6, qcm7, qcm10, qcm12])\nprint(\"Shape of dataset: \", dataset.shape)","890b14fa":"dataset.head()","a7b5accf":"corr = dataset.corr()\n#Plot figsize\nfig, ax = plt.subplots(figsize=(10, 8))\n#Generate Heat Map, allow annotations and place floats in map\nsns.heatmap(corr, cmap='coolwarm', annot=True, fmt=\".2f\")\n#Apply xticks\nplt.xticks(range(len(corr.columns)), corr.columns);\n#Apply yticks\nplt.yticks(range(len(corr.columns)), corr.columns)\n#show plot\nplt.show()","0e19d17b":"dataset.loc[dataset[\"1-Octanol\"] == 1, 'alcohol'] = '1-Octanol'\ndataset.loc[dataset[\"1-Propanol\"] == 1, 'alcohol'] = '1-Propanol'\ndataset.loc[dataset[\"2-Butanol\"] == 1, 'alcohol'] = '2-Butanol'\ndataset.loc[dataset[\"2-propanol\"] == 1, 'alcohol'] = '2-propanol'\ndataset.loc[dataset[\"1-isobutanol\"] == 1, 'alcohol'] = '1-isobutanol'","0a8fe52f":"dataset['alcohol'].value_counts()","0e77d96a":"f, axes = plt.subplots(1,2,figsize=(14,4))\n\nsns.distplot(dataset['0.799_0.201'], ax = axes[0])\naxes[0].set_xlabel('0.799 - 0.201 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[0].set_ylabel('Count', fontsize=14)\naxes[0].yaxis.tick_left()\n\nsns.swarmplot(x = 'alcohol', y = '0.799_0.201', data = dataset, hue = 'alcohol',ax = axes[1])\naxes[1].set_xlabel('0.799 - 0.201 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[1].set_ylabel('Fixed Acidity', fontsize=14)\naxes[1].yaxis.set_label_position(\"right\")\naxes[1].yaxis.tick_right()\naxes[1].legend(bbox_to_anchor=(1.15, 1), loc=2, borderaxespad=0.)\n\nplt.show()","a5932238":"f, axes = plt.subplots(1,2,figsize=(14,4))\n\nsns.distplot(dataset['0.799_0.201.1'], ax = axes[0])\naxes[0].set_xlabel('0.799 - 0.201.1 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[0].set_ylabel('Count', fontsize=14)\naxes[0].yaxis.tick_left()\n\nsns.swarmplot(x = 'alcohol', y = '0.799_0.201.1', data = dataset, hue = 'alcohol',ax = axes[1])\naxes[1].set_xlabel('Quality', fontsize=14)\naxes[1].set_ylabel('0.799 - 0.201.1 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[1].yaxis.set_label_position(\"right\")\naxes[1].yaxis.tick_right()\naxes[1].legend(bbox_to_anchor=(1.15, 1), loc=2, borderaxespad=0.)\n\nplt.show()","00ee48f8":"f, axes = plt.subplots(1,2,figsize=(14,4))\n\nsns.distplot(dataset['0.700_0.300'], ax = axes[0])\naxes[0].set_xlabel('0.700 - 0.300 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[0].set_ylabel('Count', fontsize=14)\naxes[0].yaxis.tick_left()\n\nsns.swarmplot(x = 'alcohol', y = '0.700_0.300', data = dataset, hue = 'alcohol',ax = axes[1])\naxes[1].set_xlabel('Quality', fontsize=14)\naxes[1].set_ylabel('0.700 - 0.300 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[1].yaxis.set_label_position(\"right\")\naxes[1].yaxis.tick_right()\naxes[1].legend(bbox_to_anchor=(1.15, 1), loc=2, borderaxespad=0.)\n\nplt.show()","65b3b26b":"f, axes = plt.subplots(1,2,figsize=(14,4))\n\nsns.distplot(dataset['0.700_0.300.1'], ax = axes[0])\naxes[0].set_xlabel('0.700 - 0.300.1 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[0].set_ylabel('Count', fontsize=14)\naxes[0].yaxis.tick_left()\n\nsns.swarmplot(x = 'alcohol', y = '0.700_0.300.1', data = dataset, hue = 'alcohol',ax = axes[1])\naxes[1].set_xlabel('Quality', fontsize=14)\naxes[1].set_ylabel('0.700 - 0.300.1 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[1].yaxis.set_label_position(\"right\")\naxes[1].yaxis.tick_right()\naxes[1].legend(bbox_to_anchor=(1.15, 1), loc=2, borderaxespad=0.)\n\nplt.show()","99d672de":"f, axes = plt.subplots(1,2,figsize=(14,4))\n\nsns.distplot(dataset['0.600_0.400'], ax = axes[0])\naxes[0].set_xlabel('0.600 - 0.400 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[0].set_ylabel('Count', fontsize=14)\naxes[0].yaxis.tick_left()\n\nsns.swarmplot(x = 'alcohol', y = '0.600_0.400', data = dataset, hue = 'alcohol',ax = axes[1])\naxes[1].set_xlabel('Quality', fontsize=14)\naxes[1].set_ylabel('0.600 - 0.400 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[1].yaxis.set_label_position(\"right\")\naxes[1].yaxis.tick_right()\naxes[1].legend(bbox_to_anchor=(1.15, 1), loc=2, borderaxespad=0.)\n\nplt.show()","4d032e9a":"f, axes = plt.subplots(1,2,figsize=(14,4))\n\nsns.distplot(dataset['0.600_0.400.1'], ax = axes[0])\naxes[0].set_xlabel('0.600 - 0.400.1 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[0].set_ylabel('Count', fontsize=14)\naxes[0].yaxis.tick_left()\n\nsns.swarmplot(x = 'alcohol', y = '0.600_0.400.1', data = dataset, hue = 'alcohol',ax = axes[1])\naxes[1].set_xlabel('Quality', fontsize=14)\naxes[1].set_ylabel('0.600 - 0.400.1 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[1].yaxis.set_label_position(\"right\")\naxes[1].yaxis.tick_right()\naxes[1].legend(bbox_to_anchor=(1.15, 1), loc=2, borderaxespad=0.)\n\nplt.show()","8d198ecd":"f, axes = plt.subplots(1,2,figsize=(14,4))\n\nsns.distplot(dataset['0.501_0.499'], ax = axes[0])\naxes[0].set_xlabel('0.501 - 0.499 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[0].set_ylabel('Count', fontsize=14)\naxes[0].yaxis.tick_left()\n\nsns.swarmplot(x = 'alcohol', y = '0.501_0.499', data = dataset, hue = 'alcohol',ax = axes[1])\naxes[1].set_xlabel('Quality', fontsize=14)\naxes[1].set_ylabel('0.501 - 0.499 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[1].yaxis.set_label_position(\"right\")\naxes[1].yaxis.tick_right()\naxes[1].legend(bbox_to_anchor=(1.15, 1), loc=2, borderaxespad=0.)\n\nplt.show()","ace0f755":"f, axes = plt.subplots(1,2,figsize=(14,4))\n\nsns.distplot(dataset['0.501_0.499.1'], ax = axes[0])\naxes[0].set_xlabel('0.501 - 0.499.1 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[0].set_ylabel('Count', fontsize=14)\naxes[0].yaxis.tick_left()\n\nsns.swarmplot(x = 'alcohol', y = '0.501_0.499.1', data = dataset, hue = 'alcohol',ax = axes[1])\naxes[1].set_xlabel('Quality', fontsize=14)\naxes[1].set_ylabel('0.501 - 0.499.1 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[1].yaxis.set_label_position(\"right\")\naxes[1].yaxis.tick_right()\naxes[1].legend(bbox_to_anchor=(1.15, 1), loc=2, borderaxespad=0.)\n\nplt.show()","d1286b9f":"f, axes = plt.subplots(1,2,figsize=(14,4))\n\nsns.distplot(dataset['0.400_0.600'], ax = axes[0])\naxes[0].set_xlabel('0.400 - 0.600 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[0].set_ylabel('Count', fontsize=14)\naxes[0].yaxis.tick_left()\n\nsns.swarmplot(x = 'alcohol', y = '0.400_0.600', data = dataset, hue = 'alcohol',ax = axes[1])\naxes[1].set_xlabel('Quality', fontsize=14)\naxes[1].set_ylabel('0.400 - 0.600 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[1].yaxis.set_label_position(\"right\")\naxes[1].yaxis.tick_right()\naxes[1].legend(bbox_to_anchor=(1.15, 1), loc=2, borderaxespad=0.)\n\nplt.show()","6a0c0f68":"f, axes = plt.subplots(1,2,figsize=(14,4))\n\nsns.distplot(dataset['0.400_0.600.1'], ax = axes[0])\naxes[0].set_xlabel('0.400 - 0.600.1 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[0].set_ylabel('Count', fontsize=14)\naxes[0].yaxis.tick_left()\n\nsns.swarmplot(x = 'alcohol', y = '0.400_0.600.1', data = dataset, hue = 'alcohol',ax = axes[1])\naxes[1].set_xlabel('Quality', fontsize=14)\naxes[1].set_ylabel('0.400 - 0.600.1 (Air Ratio - Gas Ratio) ml', fontsize=14)\naxes[1].yaxis.set_label_position(\"right\")\naxes[1].yaxis.tick_right()\naxes[1].legend(bbox_to_anchor=(1.15, 1), loc=2, borderaxespad=0.)\n\nplt.show()","af01bedc":"dataset.drop('alcohol', axis = 1, inplace = True)","c2d459f1":"dataset.head()","dec29e9e":"X = dataset.iloc[:, 0:10].values\ny = dataset.iloc[:, [10,11,12,13,14]].values","d0e057a4":"# Splitting the dataset into the Training set and Test set\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)","e1efcad7":"# Feature Scaling\nfrom sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)","f653f0ef":"# Initialising the ANN\nclassifier = Sequential()\n\n# Adding the input layer and the first hidden layer\nclassifier.add(Dense(units = 10, kernel_initializer = 'uniform', activation = 'relu'))\n\n# Adding the second hidden layer\nclassifier.add(Dense(units = 8, kernel_initializer = 'uniform', activation = 'relu'))\n\n# Adding the output layer\nclassifier.add(Dense(units = 5, kernel_initializer = 'uniform', activation = 'softmax'))\n\n# Compiling the ANN\nclassifier.compile(optimizer = 'adam', loss = 'categorical_crossentropy', metrics = ['accuracy'])\n\n# Fitting the ANN to the Training set\nhistory = classifier.fit(X_train, y_train, validation_data=(X_test, y_test), batch_size = 100, epochs = 3000, verbose = 1)","2d691920":"f, axes = plt.subplots(1,2,figsize=(14,4))\n\naxes[0].plot(history.history['loss'])\naxes[0].plot(history.history['val_loss'])\naxes[0].set_xlabel('Loss', fontsize=14)\naxes[0].set_ylabel('Epuch', fontsize=14)\naxes[0].yaxis.tick_left()\naxes[0].legend(['Train', 'Test'], loc='upper left')\n\naxes[1].plot(history.history['acc'])\naxes[1].plot(history.history['val_acc'])\naxes[1].set_xlabel('Accuracy', fontsize=14)\naxes[1].set_ylabel('Epoch', fontsize=14)\naxes[1].yaxis.set_label_position(\"right\")\naxes[1].yaxis.tick_right()\naxes[1].legend(['Train', 'Test'], loc='upper left')\n\nplt.show()","ae1bddbc":"from sklearn.metrics import confusion_matrix\nfrom sklearn import metrics\ny_pred = classifier.predict_classes(X_test)\ncm = metrics.confusion_matrix(y_test.argmax(axis=1), y_pred)","4849f103":"sns.heatmap(cm, annot=True, cmap = 'viridis')\nplt.show()","c45381cf":"## <span id=\"6\"><\/span> ** 6. Conclusion **","b40e3b66":"The features seem strongly correlated but because of the number of samples aren't much, let's keep them.","2aa18190":"#### ** Dataset Information **\nIn the dataset there are 5 types of dataset: QCM3, QCM6, QCM7, QCM10, QCM12 <br>\nIn each of dataset, There is alcohol classification of five types,\n1-octanol, 1-propanol, 2-butanol, 2-propanol, 1-isobutanol <br>\nSource: http:\/\/archive.ics.uci.edu\/ml\/datasets\/Alcohol+QCM+Sensor+Dataset <br>\n\n#### ** Attribute Information **\nThe gas sample is passed through the sensor in five different concentrations. These concentrations are, <br>\nConcentration Air ratio (ml) Gas ratio (ml) <br>\n1 0.799 0.201 <br>\n2 0.700 0.300 <br>\n3 0.600 0.400 <br>\n4 0.501 0.499 <br>\n5 0.400 0.600 <br>\n\nThere are two channels in the sensor. One of these circles forms channel 1, and the other forms channel 2. MIP and MP ratios used in the QCM sensors are, <br>\n\nSensor name MIP ratio NP ratio <br>\nQCM3 1 1 <br>\nQCM6 1 0 <br> \nQCM7 1 0.5 <br> \nQCM10 1 2 <br> \nQCM12 0 1 <br>\n\n#### ** Relevant Paper **\nM. Fatih Adak, Peter Lieberzeit, Purim Jarujamrus, Nejat Yumusak, <a href=\"https:\/\/www.sciencedirect.com\/science\/article\/pii\/S2215098619303337?via%3Dihub\"> Classification of alcohols obtained by QCM sensors with different characteristics using ABC based neural network <\/a>, Engineering Science and Technology, an International Journal, 2019, , ISSN 2215-0986 ","a7752bef":"In this kernel, I have built an Artificial Neural Network using Keras on QCM Sensor Alcohol Dataset. Then measured and visualized the confusion matrix. Please make a comment and let me know how to improve model's performance, visualization or something in this kernel. This will also help me on my future works.\n\n<b><font color=\"red\">Don't forget to <\/font><\/b> <b><font color=\"green\">UPVOTE <\/font><\/b> if you liked this kernel, thank you. \ud83d\ude42\ud83d\udc4d","09f59a80":"## <span id=\"2\"><\/span> ** 2. Importing Libraries and Reading the Dataset **","72843a71":"<font size=5 color='#217638'> <b> QCM Sensor Alcohol Classification using Keras <\/b> <\/font> \n<hr\/>\n[**Tolgahan Cepel**](https:\/\/www.kaggle.com\/tolgahancepel)\n<hr\/>\n<font color=green>\n1. [Overview](#1)\n1. [Importing Libraries and Reading the Dataset](#2)\n1. [Data Visualization and Preprocessing](#3)\n1. [Building the ANN](#4) \n1. [Visualizing Model Performance](#5)\n1. [Conclusion](#6)\n<hr\/>","14ad1501":"Adding a column named \"alcohol\" for visualization purpose.","eed9759a":"## <span id=\"5\"><\/span> ** 5. Visualizing Model Performance **","ab4bb676":"## <span id=\"1\"><\/span> ** 1. Overview **","f4e1d5eb":"## <span id=\"3\"><\/span> ** 3. Data Visualization and Preprocessing **","58d448f2":"## <span id=\"4\"><\/span> ** 4. Building the ANN **"}}