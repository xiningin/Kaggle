{"cell_type":{"ebee5cb3":"code","1676099b":"code","6e272d86":"code","13c0e252":"code","76e78c4e":"code","fe62163d":"code","fd3a467b":"code","a0b9074e":"code","7c53183e":"code","ce1e576e":"code","7d5fb5b7":"code","93eadea9":"code","586c5dc0":"code","cab5816a":"code","cd6b4dd3":"code","27956c82":"code","604dab69":"code","5a87595b":"code","62dcd781":"code","c45667be":"code","ec9c52c2":"code","a467a87a":"code","c25417d6":"code","33da9b66":"code","7f5c36e7":"code","32b5a320":"code","ee208aa8":"code","a799c45c":"code","86217e6c":"code","b45ad636":"code","d094a79e":"code","f92767c8":"code","c0757d82":"code","4b571260":"code","20a7f193":"code","aec9bc46":"code","bdc722da":"code","b3972862":"code","731b71bf":"markdown","f1ea919a":"markdown","f440bd55":"markdown","366d5fc8":"markdown","5e1246a8":"markdown"},"source":{"ebee5cb3":"import numpy as np\nimport pandas as pd","1676099b":"events = pd.read_csv('..\/input\/store-sales-time-series-forecasting\/holidays_events.csv')\nevents.head()","6e272d86":"oil = pd.read_csv('..\/input\/store-sales-time-series-forecasting\/oil.csv')\noil","13c0e252":"stores = pd.read_csv('..\/input\/store-sales-time-series-forecasting\/stores.csv')\nstores.head()","76e78c4e":"trans = pd.read_csv('..\/input\/store-sales-time-series-forecasting\/transactions.csv')\ntrans.head()","fe62163d":"train = pd.read_csv('..\/input\/store-sales-time-series-forecasting\/train.csv')\ntrain.head()","fd3a467b":"test = pd.read_csv('..\/input\/store-sales-time-series-forecasting\/test.csv')\ntest.head()","a0b9074e":"print(train.shape)\n\ntrain_df = None\n\ntrain_df = train.merge(stores, how='left', left_on='store_nbr', right_on = 'store_nbr')\ntrain_df = train_df.merge(events, how='left', left_on='date', right_on = 'date')\ntrain_df = train_df.merge(trans, how='left', left_on=['date', 'store_nbr'], right_on = ['date', 'store_nbr'])\ntrain_df = train_df.merge(oil, how='left', left_on='date', right_on = 'date')\nprint(train_df.shape)","7c53183e":"print(test.shape)\ntest_df = None\n\ntest_df = test.merge(stores, how='left', left_on='store_nbr', right_on = 'store_nbr')\ntest_df = test_df.merge(events, how='left', left_on='date', right_on = 'date')\ntest_df = test_df.merge(trans, how='left', left_on=['date', 'store_nbr'], right_on = ['date', 'store_nbr'])\ntest_df = test_df.merge(oil, how='left', left_on='date', right_on = 'date')\nprint(test_df.shape)","ce1e576e":"train_df.isna().sum()","7d5fb5b7":"train_df['type_y'] = train_df['type_y'].fillna('Day')\ntrain_df['locale'] = train_df['locale'].fillna('National')\ntrain_df['locale_name'] = train_df['locale_name'].fillna('None')\ntrain_df['transferred'] = train_df['transferred'].fillna('False')\ntrain_df['transactions'] = train_df['transactions'].fillna(0)\ntrain_df['dcoilwtico'] = train_df['dcoilwtico'].fillna(0)\ntrain_df = train_df.drop(columns=['id', 'description', 'locale_name'], axis = 1)","93eadea9":"train_df.isna().sum()","586c5dc0":"test_df['type_y'] = test_df['type_y'].fillna('Day')\ntest_df['locale'] = test_df['locale'].fillna('National')\ntest_df['locale_name'] = test_df['locale_name'].fillna('None')\ntest_df['transferred'] = test_df['transferred'].fillna('False')\ntest_df['transactions'] = test_df['transactions'].fillna(0)\ntest_df['dcoilwtico'] = test_df['dcoilwtico'].fillna(0)\n\nsub=pd.DataFrame()\nsub['id'] = test_df['id']\ntest_df = test_df.drop(columns=['id', 'description', 'locale_name'], axis = 1)","cab5816a":"test_df.isna().sum()","cd6b4dd3":"train_df['holiday'] = train_df['locale'] + '_' + train_df['type_y']\ntrain_df['location'] = train_df['city'] +',' + train_df['state']","27956c82":"test_df['location'] = test_df['city'] +',' + test_df['state']\ntest_df['holiday'] = test_df['locale'] +',' + test_df['type_y']","604dab69":"train_df = train_df.drop(columns = ['city', 'state', 'locale', 'type_y'], axis = 1)\ntest_df = test_df.drop(columns = ['city', 'state', 'locale', 'type_y'], axis = 1)","5a87595b":"train_df['family'].unique()","62dcd781":"import matplotlib.pyplot as plt\nfig, ax = plt.subplots(figsize=(15,7))\ntrain_df.groupby(\"family\").sum()['sales'].plot(kind='bar')","c45667be":"# 15\n# Tools -Automotive + Hardware + Home Appliances  + Lawn and Garden +Players and Electronics\n# Clothing - Beauty + Lingerie + Ladies Wear\n# Lifestyle - Babycare + Books + Magazines + Celebration + School and Office Supplies\n# Other Foods - Grocery2 + Pet Foods + Sea Food\n# rest remains the same","ec9c52c2":"## Merged many categories from the family feature to observe change in the case.","a467a87a":"train_df['family'].replace(['AUTOMOTIVE', 'HARDWARE', 'LAWN AND GARDEN', 'PLAYERS AND ELECTRONICS'], 'Tools', inplace = True)\n\ntrain_df['family'].replace(['BEAUTY', 'LINGERIE', 'LADIESWEAR','PERSONAL CARE','CELEBRATION','MAGAZINES','BOOKS', 'BABY CARE'], 'LifeStyle', inplace = True)\n\ntrain_df['family'].replace(['HOME APPLIANCES','HOME AND KITCHEN I', 'HOME AND KITCHEN II','HOME CARE','SCHOOL AND OFFICE SUPPLIES'], 'Home', inplace=True)\n\ntrain_df['family'].replace([ 'GROCERY II', 'PET SUPPLIES','SEAFOOD','LIQUOR,WINE,BEER'], 'Food', inplace=True)\n\ntrain_df['family'].replace(['DELI', 'EGGS'], 'Daily', inplace=True)","c25417d6":"test_df['family'].replace(['AUTOMOTIVE', 'HARDWARE', 'LAWN AND GARDEN', 'PLAYERS AND ELECTRONICS'], 'Tools', inplace = True)\n\ntest_df['family'].replace(['BEAUTY', 'LINGERIE', 'LADIESWEAR','PERSONAL CARE','CELEBRATION','MAGAZINES','BOOKS', 'BABY CARE'], 'LifeStyle', inplace = True)\n\ntest_df['family'].replace(['HOME APPLIANCES','HOME AND KITCHEN I', 'HOME AND KITCHEN II','HOME CARE','SCHOOL AND OFFICE SUPPLIES'], 'Home', inplace=True)\n\ntest_df['family'].replace([ 'GROCERY II', 'PET SUPPLIES','SEAFOOD','LIQUOR,WINE,BEER'], 'Food', inplace=True)\n\ntest_df['family'].replace(['DELI', 'EGGS'], 'Daily', inplace=True)","33da9b66":"train_df['family'].unique()","7f5c36e7":"import matplotlib.pyplot as plt\nfig, ax = plt.subplots(figsize=(15,7))\ntrain_df.groupby(\"family\").sum()['sales'].plot(kind='bar')","32b5a320":"train_df.sort_values(by=['store_nbr', 'date', 'family'], inplace=True)\ntest_df.sort_values(by=['store_nbr', 'date', 'family'], inplace=True)","ee208aa8":"train_df[[\"year\", \"month\", \"day\"]] = train_df[\"date\"].str.split(\"-\", expand = True)\ntrain_df = train_df.drop(columns=['date'], axis = 1)\n\ntest_df[[\"year\", \"month\", \"day\"]] = test_df[\"date\"].str.split(\"-\", expand = True)\ntest_df = test_df.drop(columns=['date'], axis = 1)","a799c45c":"train_df['onpromo_lag1'] = train_df['onpromotion'].shift(periods=1)\ntest_df['onpromo_lag1'] = test_df['onpromotion'].shift(periods=1)","86217e6c":"train_df.shape","b45ad636":"test_df.shape","d094a79e":"from datetime import datetime\ntrain_df[\"day\"] = train_df[\"day\"].astype('category')\ntrain_df[\"day\"] = train_df[\"day\"].cat.codes\ntrain_df[\"month\"] = train_df[\"month\"].astype('category')\ntrain_df[\"month\"] = train_df[\"month\"].cat.codes\ntrain_df[\"year\"] = train_df[\"year\"].astype('category')\ntrain_df[\"year\"] = train_df[\"year\"].cat.codes\n\ntrain_df[\"type_x\"] = train_df[\"type_x\"].astype('category')\ntrain_df[\"type_x\"] = train_df[\"type_x\"].cat.codes\ntrain_df[\"holiday\"] = train_df[\"holiday\"].astype('category')\ntrain_df[\"holiday\"] = train_df[\"holiday\"].cat.codes\ntrain_df[\"family\"] = train_df[\"family\"].astype('category')\ntrain_df[\"family\"] = train_df[\"family\"].cat.codes\ntrain_df[\"location\"] = train_df[\"location\"].astype('category')\ntrain_df[\"location\"] = train_df[\"location\"].cat.codes\n\ntrain_df[\"transferred\"] = train_df[\"transferred\"].astype('category')\ntrain_df[\"transferred\"] = train_df[\"transferred\"].cat.codes","f92767c8":"#train_df['sale_lag1'] = train_df['sale_lag1'].fillna(0) \ntrain_df['onpromo_lag1'] = train_df['onpromo_lag1'].fillna(0) ","c0757d82":"from datetime import datetime\ntest_df[\"day\"] = test_df[\"day\"].astype('category')\ntest_df[\"day\"] = test_df[\"day\"].cat.codes\ntest_df[\"month\"] = test_df[\"month\"].astype('category')\ntest_df[\"month\"] = test_df[\"month\"].cat.codes\ntest_df[\"year\"] = test_df[\"year\"].astype('category')\ntest_df[\"year\"] = test_df[\"year\"].cat.codes\n\ntest_df[\"type_x\"] = test_df[\"type_x\"].astype('category')\ntest_df[\"type_x\"] = test_df[\"type_x\"].cat.codes\ntest_df[\"holiday\"] = test_df[\"holiday\"].astype('category')\ntest_df[\"holiday\"] = test_df[\"holiday\"].cat.codes\ntest_df[\"family\"] = test_df[\"family\"].astype('category')\ntest_df[\"family\"] = test_df[\"family\"].cat.codes\ntest_df[\"location\"] = test_df[\"location\"].astype('category')\ntest_df[\"location\"] = test_df[\"location\"].cat.codes\n\ntest_df[\"transferred\"] = test_df[\"transferred\"].astype('category')\ntest_df[\"transferred\"] = test_df[\"transferred\"].cat.codes","4b571260":"test_df['onpromo_lag1'] = test_df['onpromo_lag1'].fillna(0) ","20a7f193":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(train_df.loc[:, train_df.columns != 'sales'], train_df['sales'], test_size=0.33, random_state=42)","aec9bc46":"import xgboost as xgb\nmodel = xgb.XGBRegressor()\nmodel.fit(train_df.loc[:, train_df.columns != 'sales'], train_df['sales'])\n# score 3.8","bdc722da":"sub['sales'] = model.predict(test_df)","b3972862":"sub.to_csv('submission123.csv', index=False)","731b71bf":"FEATURE ENGINEERING","f1ea919a":"MERGING DATA","f440bd55":"MODEL","366d5fc8":"READING DATA","5e1246a8":"DATA CLEANING"}}