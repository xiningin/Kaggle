{"cell_type":{"cbf58e9f":"code","1a9f9fbd":"code","16ee6abe":"code","b1363fcc":"code","060ac448":"code","bcfb83aa":"code","cd11d76a":"code","5bc1dbb8":"code","79f79696":"code","569e18be":"markdown","414ad23b":"markdown","3ae7dbe4":"markdown","946bfdb3":"markdown","103182f9":"markdown","0e3451bc":"markdown","100d0bfc":"markdown","65df1caa":"markdown","61d6128f":"markdown","69a4d8ee":"markdown","a1d4637f":"markdown"},"source":{"cbf58e9f":"import pandas as pd\ndata=pd.read_csv('..\/input\/heart-disease-uci\/heart.csv')\ndata.head()","1a9f9fbd":"data.info()","16ee6abe":"X=data[data.columns[data.columns!='target']]\nX.head()","b1363fcc":"Y=data['target']\nY.head()","060ac448":"X.corrwith(Y)","bcfb83aa":"from sklearn.model_selection import train_test_split\ntrain_x, test_x, train_y,test_y=train_test_split(X,Y,random_state=0,test_size=0.2)\nprint(train_y.shape, test_y.shape)","cd11d76a":"from sklearn.ensemble import RandomForestClassifier\nbest_estimator=0\nbest_depth=0\nacc=0\nfor i in range(1,10):\n    for j in range(1,10):\n        classifier=RandomForestClassifier(n_estimators=i,max_depth=j,random_state=0,class_weight={0:sum(train_y==0),1:sum(train_y==1)})\n        classifier.fit(train_x,train_y)\n        if(classifier.score(test_x,test_y) > acc):\n            best_estimator=i\n            best_depth=j\n            acc=classifier.score(test_x,test_y)\nprint('Best Estimator: ',best_estimator,'\\nBest Estimator: ',best_depth,'\\nAccuracy: ',acc)\n","5bc1dbb8":"best_classifier=RandomForestClassifier(n_estimators=8,max_depth=5,random_state=0,class_weight={0:sum(train_y==0),1:sum(train_y==1)})\nbest_classifier.fit(train_x,train_y)\nprint('Train - Accuracy: ',round(best_classifier.score(train_x,train_y)*100,2),'%')\nprint('Test - Accuracy: ',round(best_classifier.score(test_x,test_y)*100,2),'%')","79f79696":"from sklearn.metrics import confusion_matrix\ncfmt=confusion_matrix(test_y,best_classifier.predict(test_x))\nprint(cfmt)","569e18be":"## **Splitting data into train and split (ratio: 80:20)**","414ad23b":"#### **Give upvote if you like my work, Thank you**","3ae7dbe4":"## **Seperating target column from data**","946bfdb3":"## **Confusion Matrix**","103182f9":"## **Correlation b\/w features and target**","0e3451bc":"### **Brief info about null and non-null for preprocessing**","100d0bfc":"## **Using best parameters**","65df1caa":"# **Importing Data**","61d6128f":"## **Using Random Forest with parameter tuning **(n_estimators,max_depth)****","69a4d8ee":"#### **Train and test acurracy are nearly same, so model is not overfitting or underfitting**","a1d4637f":"## **Seperating feature columns from data**"}}