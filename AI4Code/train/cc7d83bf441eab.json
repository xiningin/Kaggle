{"cell_type":{"67e7aeb5":"code","dcf0ce5a":"code","2138bd11":"code","11d5d810":"code","d6fe6d63":"code","16da152a":"code","234f6417":"code","19051085":"code","16985cf9":"code","885ccb0d":"markdown","9a608322":"markdown","e2f864b9":"markdown","277e04e9":"markdown","705ea504":"markdown","5aa91a5c":"markdown"},"source":{"67e7aeb5":"!pip install datasets","dcf0ce5a":"from datasets import load_dataset\n\ninter_dataset = load_dataset('json', data_files={\n    'train': '..\/input\/fewnerd\/inter\/train.json',\n    'validation': '..\/input\/fewnerd\/inter\/dev.json',\n    'test': '..\/input\/fewnerd\/inter\/train.json',\n})","2138bd11":"from datasets import load_dataset\n\nintra_dataset = load_dataset('json', data_files={\n    'train': '..\/input\/fewnerd\/intra\/train.json',\n    'validation': '..\/input\/fewnerd\/intra\/dev.json',\n    'test': '..\/input\/fewnerd\/intra\/train.json',\n})","11d5d810":"from datasets import load_dataset\n\nsupervised_dataset = load_dataset('json', data_files={\n    'train': '..\/input\/fewnerd\/supervised\/train.json',\n    'validation': '..\/input\/fewnerd\/supervised\/dev.json',\n    'test': '..\/input\/fewnerd\/supervised\/train.json',\n})","d6fe6d63":"import json\n\nwith open(\"..\/input\/fewnerd\/id2coarse_tags.json\", \"r\") as f:\n    id2coarse_tag = json.load(f)\n\nwith open(\"..\/input\/fewnerd\/id2fine_tags.json\", \"r\") as f:\n    id2fine_tag = json.load(f)\n\nfrom collections import Counter\n\nfew_nerd_datasets = {\n    \"inter\": inter_dataset,\n    \"intra\": intra_dataset,\n    \"supervised\": supervised_dataset\n}\nsplits = ['train', 'validation', 'test']\n\nfine_dataset_counters = {name:{} for name in few_nerd_datasets.keys()}\n\nfor name in fine_dataset_counters.keys():\n    fine_dataset_counters[name] = {split: Counter() for split in splits}\n\n\ndef count_entities(sample, fine_counter):\n    fine_counter.update([id2fine_tag[str(tag)] for tag in sample[\"fine_tags\"]])\n\nfor name, ds in few_nerd_datasets.items():\n    for split in splits:\n        _ = ds[split].map(count_entities, fn_kwargs=dict(fine_counter=fine_dataset_counters[name][split]))","16da152a":"import pprint\npp = pprint.PrettyPrinter(indent=4)\npp.pprint(fine_dataset_counters)","234f6417":"fine_tag2coarse_tag = {}\nfor fine_tag in id2fine_tag.values():\n    if fine_tag == 'O':\n        fine_tag2coarse_tag[fine_tag] = 'O'\n        continue\n    coarse, _ = fine_tag.split(\"-\")\n    fine_tag2coarse_tag[fine_tag] = coarse","19051085":"coarse_dataset_counters = {name:{} for name in few_nerd_datasets.keys()}\n\nfor name in coarse_dataset_counters.keys():\n    coarse_dataset_counters[name] = {split: Counter() for split in splits}\n    \n\nfor name, splits in fine_dataset_counters.items():\n    for split, counter in splits.items():\n        for fine_tag, count in counter.items():\n            coarse_dataset_counters[name][split].update({fine_tag2coarse_tag[fine_tag]: count})","16985cf9":"pp.pprint(coarse_dataset_counters)","885ccb0d":"# Count entities","9a608322":"# Show coarse_tag counts","e2f864b9":"# Load inter dataset","277e04e9":"# Load intra dataset","705ea504":"# Load supervised dataset","5aa91a5c":"# Show fine_tag counts"}}