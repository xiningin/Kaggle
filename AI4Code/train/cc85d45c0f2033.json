{"cell_type":{"1f6323ea":"code","674c7619":"code","6a304d78":"markdown"},"source":{"1f6323ea":"import tensorflow as tf\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\n\n# Load the data\ndf = pd.read_csv(\"..\/input\/train.csv\")\n# test = pd.read_csv(\"..\/input\/test.csv\")\n\ny = df[\"label\"]\nx = df.drop(labels = [\"label\"],axis = 1) \n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.33)\nx_train, x_test = x_train \/ 255.0, x_test \/ 255.0\n\nx_train = x_train.values.reshape(-1,28,28,1)\nx_test = x_test.values.reshape(-1,28,28,1)\n\nmodel = tf.keras.models.Sequential([\n  tf.keras.layers.Flatten(input_shape=(28, 28, 1)),\n  tf.keras.layers.Dense(512, activation=tf.nn.relu),\n  tf.keras.layers.Dropout(0.2),\n  tf.keras.layers.Dense(10, activation=tf.nn.softmax)\n])\nmodel.compile(optimizer='adam',\n              loss='sparse_categorical_crossentropy',\n              metrics=['accuracy'])\n\nmodel.fit(x_train, y_train, epochs=50)\nmodel.evaluate(x_test, y_test)","674c7619":"df_test = pd.read_csv(\"..\/input\/test.csv\")\nprediction = model.predict(df_test.values.reshape(-1,28,28,1)).argmax(1)\nmy_submission = pd.DataFrame({'ImageId': df_test.index + 1, 'Label': prediction})\nmy_submission.to_csv('submission.csv', index=False)","6a304d78":"make submition"}}