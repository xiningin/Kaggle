{"cell_type":{"4cdc7e21":"code","a3fe5c77":"code","9d68a5f2":"code","887bcf2d":"code","9280bbeb":"code","21114885":"code","b644bc94":"code","37f6ebff":"code","1d92fd4e":"code","532883a9":"code","aea98392":"code","042ed7f8":"code","f1065580":"code","1735cb22":"code","a0dac2b1":"code","6d50ab1c":"code","7561966c":"code","8464305b":"code","a7f6c770":"code","66f7692f":"code","c7ed4b76":"code","b9811fb4":"code","ca93f172":"code","0c8b4c2a":"code","930c99f5":"code","f6eba0c6":"code","107e1d5b":"code","6ffcbdea":"code","0d1aa66d":"code","9f0f6614":"code","8e4155df":"code","121df2d7":"code","ba246ca6":"code","1a550433":"code","226c3f98":"code","bad75d05":"code","3dc822e8":"code","95378142":"code","514dd078":"code","5dee8677":"code","82b08456":"code","62b73c12":"code","88633cb2":"code","dafa62f6":"code","d96c4a1e":"code","dc71eca3":"code","c5b75c02":"code","e4039ca2":"code","0cb85e55":"code","9021d71a":"code","f0233a98":"code","a18199da":"code","038c6a95":"code","d663caa1":"code","ad56fa25":"code","23763a12":"code","6ef54e4b":"code","11e9b089":"code","4dc09975":"code","27d93f14":"code","8f418a49":"code","f26eae0d":"code","0a920d43":"code","88967d58":"code","9aceec7f":"code","031f1e2c":"code","9818dc3e":"code","e0546c0b":"code","fd351f80":"code","2ab7c1ec":"code","97357f1a":"code","076a3cf0":"code","c43f93ce":"code","c7c0f3e5":"code","543c9b82":"code","c684c535":"code","41cedb10":"code","1198cb9b":"code","892e4647":"code","89aed910":"code","79969b41":"code","a1300956":"code","fefe418a":"code","004932e4":"code","80569758":"code","8be85cf5":"code","216769cd":"code","60eb00de":"code","dd6674ca":"code","adbef4f4":"markdown","8fedf117":"markdown","87ebce79":"markdown","37c506f2":"markdown","62486100":"markdown","aaca703e":"markdown","56409e83":"markdown","bf76dfd9":"markdown","7f690b51":"markdown","f753eeed":"markdown","d6bbff1e":"markdown","144697c0":"markdown","d982908d":"markdown","f21da343":"markdown","ff18d3d1":"markdown","e55ea5e6":"markdown","e74aca1d":"markdown","deab34ea":"markdown","c3db7796":"markdown","a3a3f6fd":"markdown","f11631f8":"markdown","72da85d5":"markdown","e71d61e4":"markdown","50c741b7":"markdown","a2ab5293":"markdown","7c4c1c60":"markdown","4ad66bea":"markdown","60838d09":"markdown","b83f9eb2":"markdown","f251f8d2":"markdown","6a636807":"markdown","e0bff12f":"markdown","b005adfd":"markdown","ae4871fc":"markdown","00d66651":"markdown","3e501558":"markdown","6298383c":"markdown","c9e7b6df":"markdown","83accb56":"markdown","d9d068e1":"markdown","6240b42e":"markdown","bb9aa36e":"markdown","d00dc702":"markdown","bb50cff5":"markdown","06c0018f":"markdown","17d77761":"markdown","45e0d12b":"markdown","f2068699":"markdown","56d92a35":"markdown","571d4df3":"markdown","85212980":"markdown","cbbc83fa":"markdown","0185abbc":"markdown","49ff4eca":"markdown","4c996d4c":"markdown","28ecb887":"markdown","08411bc4":"markdown","35e0e7c8":"markdown","87a23f0f":"markdown","954d63be":"markdown","7cf11a9b":"markdown","2c618369":"markdown","8492ad21":"markdown","fbf548da":"markdown","a992b990":"markdown","b2edb6ea":"markdown","eb1a4916":"markdown","63af97bd":"markdown","55725826":"markdown","ac6d67d2":"markdown"},"source":{"4cdc7e21":"import numpy as np \nimport pandas as pd \n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style(\"whitegrid\")","a3fe5c77":"df = pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")\ndf.head()","9d68a5f2":"# For the convinence, we can rename our column names.\n\ndf.rename(columns={'Annual Income (k$)':'Annual_Income','Spending Score (1-100)':'Spending_Score'},inplace=True)","887bcf2d":"df.head()","9280bbeb":"print(f\"Our dataset consists of {df.shape[0]} rows and {df.shape[1]} columns.\")","21114885":"df.info()","b644bc94":"def missing (df):\n    missing_number = df.isnull().sum().sort_values(ascending=False)\n    missing_percent = (df.isnull().sum()\/df.isnull().count()).sort_values(ascending=False)\n    missing_values = pd.concat([missing_number, missing_percent], axis=1, keys=['Missing_Number', 'Missing_Percent'])\n    return missing_values\n\nmissing(df)","37f6ebff":"df.duplicated().sum()","1d92fd4e":"df.describe()","532883a9":"df.drop(columns= \"CustomerID\", inplace=True)","aea98392":"df.head()","042ed7f8":"df.nunique()","f1065580":"plt.figure(figsize=(15,5))\nsns.countplot(x ='Age', data = df)\nplt.title('Age Distribution')\nplt.xlabel('Age')\nplt.show();","1735cb22":"plt.figure(figsize=(20,10))\nsns.countplot(x='Annual_Income', data=df)\nplt.title('Annual Income')\nplt.xlabel('Annual Income($)')\nplt.show();","a0dac2b1":"plt.figure(figsize=(20,8))\nsns.countplot(x='Spending_Score', data=df)\nplt.title('Spending Score Distribution')\nplt.xlabel('Spending Score')\nplt.ylabel('Count')\nplt.show();","6d50ab1c":"plt.figure(figsize=(15,5))\nplt.subplot(1,2,1)\nsns.histplot(x='Age', data=df, kde =True)\nplt.title('Age Distribution')\nplt.xlabel('Age')\nplt.ylabel('Count')\n\nplt.subplot(1,2,2)\nsns.histplot(x ='Annual_Income', data=df, color='red', kde = True)\nplt.title('Annual Income Distribution')\nplt.xlabel('Annual Income')\nplt.ylabel('Count')","7561966c":"plt.figure(figsize=(6,6))\n\nexplode = [0,0.1]\nplt.pie(df['Gender'].value_counts(), explode=explode,autopct='%1.1f%%', shadow=True,startangle=140)\nplt.legend(labels=['Female','Male'])\nplt.title('Male and Female Distribution')\nplt.axis('off')","8464305b":"plt.figure(figsize=(12,6))\nsns.heatmap(df.corr(),annot=True)\nplt.show()","a7f6c770":"plt.figure(figsize=(15,5))\nsns.stripplot(x='Gender', y='Spending_Score', data=df)\nplt.title('Gender and Spending Score')\nplt.show()\n\nplt.figure(figsize=(15,5))\nsns.boxplot(x='Gender', y='Spending_Score', data=df)\nplt.title('Gender and Spending Score')\nplt.show()\n\nplt.figure(figsize=(15,5))\nsns.violinplot(x='Gender', y='Spending_Score', data=df)\nplt.title('Gender based Spending Score')\nplt.show()","66f7692f":"plt.figure(figsize=(15,5))\nsns.violinplot(x='Gender',y='Annual_Income', data=df)\nplt.title('Gender based Annual Income Distribution')\nplt.show()\n\nplt.figure(figsize=(15,5))\nsns.boxplot(x='Gender',y='Annual_Income', data=df)\nplt.title('Gender based Annual Income Distribution')\nplt.show()","c7ed4b76":"sns.pairplot(df);","b9811fb4":"plt.figure(figsize=(16,8))\n\nsns.scatterplot(x ='Annual_Income', y='Spending_Score', data=df, hue = \"Gender\")\nplt.show()","ca93f172":"df_2 = df.drop(columns=\"Gender\")","0c8b4c2a":"pip install pyclustertend","930c99f5":"from pyclustertend import hopkins","f6eba0c6":"hopkins(df_2, df_2.shape[0])","107e1d5b":"x1 = df.loc[:,['Age','Spending_Score']]\nx1.head()","6ffcbdea":"hopkins(x1, x1.shape[0])","0d1aa66d":"from sklearn.cluster import KMeans\n\nssd =[]\nfor n in range(2,11):\n    kmeans=KMeans(n_clusters=n,random_state=42)\n    kmeans.fit(x1)\n    ssd.append(kmeans.inertia_)\nplt.figure(figsize=(10,6))\nplt.plot(range(2, 11), ssd, \"bo-\")\nplt.title('The Elbow Method')\nplt.xlabel('No. of Clusters')\nplt.ylabel('ssd')\nplt.show()","9f0f6614":"ssd","8e4155df":"pd.Series(ssd).diff()","121df2d7":"df_diff =pd.DataFrame(-pd.Series(ssd).diff()).rename(index = lambda x : x+1)\ndf_diff","ba246ca6":"plt.figure(figsize=(16, 8))\ndf_diff.plot(kind='bar');","1a550433":"from yellowbrick.cluster import KElbowVisualizer\n\nkmeans = KMeans(random_state=42)\nvisu = KElbowVisualizer(kmeans, k = (2,10))\nvisu.fit(x1)\nvisu.poof()","226c3f98":"from sklearn.metrics import silhouette_score\nrange_n_clusters = range(2,11)\nfor num_clusters in range_n_clusters:\n    # intialise kmeans\n    kmeans = KMeans(n_clusters=num_clusters, random_state=42)\n    kmeans.fit(x1)\n    cluster_labels = kmeans.labels_\n    # silhouette score\n    silhouette_avg = silhouette_score(x1, cluster_labels)\n    print(f\"For n_clusters={num_clusters}, the silhouette score is {silhouette_avg}\")","bad75d05":"from sklearn.cluster import KMeans\n\nfrom yellowbrick.cluster import SilhouetteVisualizer\n\nmodel3 = KMeans(n_clusters=4, random_state=42)\nvisualizer = SilhouetteVisualizer(model3)\n\nvisualizer.fit(x1)    # Fit the data to the visualizer\nvisualizer.poof();","3dc822e8":"kmeans = KMeans(n_clusters = 4, random_state=42)\nkmeans.fit_predict(x1)","95378142":"x1[\"cluster_Kmeans\"] = kmeans.fit_predict(x1)\nx1.head()","514dd078":"plt.figure(figsize=(15,8))\nsns.scatterplot(x='Age', y='Spending_Score', hue='cluster_Kmeans', data=x1, palette=\"bright\")\ncenters = kmeans.cluster_centers_\nplt.scatter(centers[:, 0], centers[:, 1], c='black', s=300, alpha=0.5);","5dee8677":"x2 = df.loc[:,['Annual_Income','Spending_Score']]\nx2.head()","82b08456":"hopkins(x2,x2.shape[0])","62b73c12":"ssd =[]\nfor n in range(2,11):\n    kmeans=KMeans(n_clusters=n, random_state=42)\n    kmeans.fit(x2)\n    ssd.append(kmeans.inertia_)\nplt.figure(figsize=(10,6))\nplt.plot(range(2, 11), ssd, \"bo-\")\nplt.title('The Elbow Method')\nplt.xlabel('Number of Clusters')\nplt.ylabel('ssd')\nplt.show()","88633cb2":"df_diff =pd.DataFrame(-pd.Series(ssd).diff()).rename(index = lambda x : x+1)\ndf_diff","dafa62f6":"df_diff.plot(kind='bar');","d96c4a1e":"from yellowbrick.cluster import KElbowVisualizer\n\nkmeans = KMeans(random_state=42)\nvisu = KElbowVisualizer(kmeans, k = (2,10))\nvisu.fit(x2)\nvisu.poof()","dc71eca3":"model4 = KMeans(n_clusters=5, random_state=42)\nvisualizer = SilhouetteVisualizer(model4)\n\nvisualizer.fit(x2)    # Fit the data to the visualizer\nvisualizer.poof();","c5b75c02":"from sklearn.metrics import silhouette_score\nrange_n_clusters = range(2,11)\nfor num_clusters in range_n_clusters:\n    # intialise kmeans\n    kmeans = KMeans(n_clusters=num_clusters, random_state=42)\n    kmeans.fit(x2)\n    cluster_labels = kmeans.labels_\n    # silhouette score\n    silhouette_avg = silhouette_score(x2, cluster_labels)\n    print(f\"For n_clusters={num_clusters}, the silhouette score is {silhouette_avg}\")","e4039ca2":"kmeans2 = KMeans(n_clusters=5, random_state=42)\nkmeans2.fit_predict(x2)","0cb85e55":"x2['cluster_Kmeans'] = kmeans2.fit_predict(x2)\nx2.head()","9021d71a":"plt.figure(figsize=(15,9))\nsns.scatterplot(x='Annual_Income', y='Spending_Score', hue='cluster_Kmeans', data=x2, palette=\"bright\")\ncenters = kmeans2.cluster_centers_\nplt.scatter(centers[:, 0], centers[:, 1], c='black', s=300, alpha=0.5);","f0233a98":"from scipy.cluster.hierarchy import linkage","a18199da":"hc_ward = linkage(y = x1, method = \"ward\")\nhc_complete = linkage(x1, \"complete\")\nhc_average = linkage(x1, \"average\")\nhc_single = linkage(x1, \"single\")","038c6a95":"from scipy.cluster.hierarchy import dendrogram","d663caa1":"plt.figure(figsize = (20,12))\n\nplt.subplot(221)\nplt.title(\"Ward\")\nplt.xlabel(\"Observations\")\nplt.ylabel(\"Distance\")\ndendrogram(hc_ward, truncate_mode = \"lastp\", p = 10, show_contracted = True, leaf_font_size = 10)\n\nplt.subplot(222)\nplt.title(\"Complete\")\nplt.xlabel(\"Observations\")\nplt.ylabel(\"Distance\")\ndendrogram(hc_complete, truncate_mode = \"lastp\", p = 10, show_contracted = True, leaf_font_size = 10)\n\nplt.subplot(223)\nplt.title(\"Average\")\nplt.xlabel(\"Observations\")\nplt.ylabel(\"Distance\")\ndendrogram(hc_average, truncate_mode = \"lastp\", p = 10, show_contracted = True, leaf_font_size = 10)\n\nplt.subplot(224)\nplt.title(\"Single\")\nplt.xlabel(\"Observations\")\nplt.ylabel(\"Distance\")\ndendrogram(hc_single, truncate_mode = \"lastp\", p = 10, show_contracted = True, leaf_font_size = 10);","ad56fa25":"plt.figure(figsize = (20,8))\nplt.title(\"Dendrogram\")\nplt.xlabel(\"Observations\")\nplt.ylabel(\"Distance\")\ndendrogram(hc_ward, truncate_mode = \"lastp\", p = 10, show_contracted = True, leaf_font_size = 10);","23763a12":"from sklearn.cluster import AgglomerativeClustering","6ef54e4b":"from sklearn.metrics import silhouette_score\nrange_n_clusters = range(2,11)\nfor num_clusters in range_n_clusters:\n    # intialise kmeans\n    Agg_model = AgglomerativeClustering(n_clusters=num_clusters)\n    Agg_model.fit(x1)\n    cluster_labels = Agg_model.labels_\n    # silhouette score\n    silhouette_avg = silhouette_score(x1, cluster_labels)\n    print(f\"For n_clusters={num_clusters}, the silhouette score is {silhouette_avg}\")","11e9b089":"hc_ward = linkage(y = x2, method = \"ward\")\nhc_complete = linkage(x2, \"complete\")\nhc_average = linkage(x2, \"average\")\nhc_single = linkage(x2, \"single\")","4dc09975":"plt.figure(figsize = (20,12))\n\nplt.subplot(221)\nplt.title(\"Ward\")\nplt.xlabel(\"Observations\")\nplt.ylabel(\"Distance\")\ndendrogram(hc_ward, truncate_mode = \"lastp\", p = 10, show_contracted = True, leaf_font_size = 10)\n\nplt.subplot(222)\nplt.title(\"Complete\")\nplt.xlabel(\"Observations\")\nplt.ylabel(\"Distance\")\ndendrogram(hc_complete, truncate_mode = \"lastp\", p = 10, show_contracted = True, leaf_font_size = 10)\n\nplt.subplot(223)\nplt.title(\"Average\")\nplt.xlabel(\"Observations\")\nplt.ylabel(\"Distance\")\ndendrogram(hc_average, truncate_mode = \"lastp\", p = 10, show_contracted = True, leaf_font_size = 10)\n\nplt.subplot(224)\nplt.title(\"Single\")\nplt.xlabel(\"Observations\")\nplt.ylabel(\"Distance\")\ndendrogram(hc_single, truncate_mode = \"lastp\", p = 10, show_contracted = True, leaf_font_size = 10);","27d93f14":"plt.figure(figsize = (20,8))\nplt.title(\"Dendrogram\")\nplt.xlabel(\"Observations\")\nplt.ylabel(\"Distance\")\ndendrogram(hc_ward, truncate_mode = \"lastp\", p = 10, show_contracted = True, leaf_font_size = 10);","8f418a49":"from sklearn.metrics import silhouette_score\nrange_n_clusters = range(2,11)\nfor num_clusters in range_n_clusters:\n    # intialise kmeans\n    Agg_model = AgglomerativeClustering(n_clusters=num_clusters)\n    Agg_model.fit(x2)\n    cluster_labels = Agg_model.labels_\n    # silhouette score\n    silhouette_avg = silhouette_score(x2, cluster_labels)\n    print(f\"For n_clusters={num_clusters}, the silhouette score is {silhouette_avg}\")","f26eae0d":"Agg1 = AgglomerativeClustering(n_clusters=4, affinity='euclidean', linkage='ward')\ny_agg= Agg1.fit_predict(x1)","0a920d43":"x1['cluster_Agg'] = y_agg\nx1.head()","88967d58":"Agg2 = AgglomerativeClustering(n_clusters=5, affinity='euclidean', linkage='ward')\ny_agg2 = Agg2.fit_predict(x2)","9aceec7f":"x2['cluster_Agg'] = y_agg2\nx2.head()","031f1e2c":"plt.figure(figsize=(15,9))\nsns.scatterplot(x='Age', y='Spending_Score', hue='cluster_Agg', data=x1, palette=\"bright\");","9818dc3e":"plt.figure(figsize = (20,10))\n\nplt.subplot(121)\nsns.scatterplot(x='Age', y='Spending_Score', hue='cluster_Kmeans', data=x1,palette=['green','orange','brown',\n                                                                             'dodgerblue'])\nplt.title(\"K_means\")\nplt.subplot(122)\nsns.scatterplot(x='Age', y='Spending_Score', hue='cluster_Agg', data=x1,palette=['dodgerblue','green',\n                                                                              'orange','brown'])\nplt.title(\"Agg\");","e0546c0b":"plt.figure(figsize=(15,9))\nsns.scatterplot(x='Annual_Income', y='Spending_Score', hue='cluster_Agg', data=x2 ,palette=\"bright\");","fd351f80":"plt.figure(figsize = (20,8))\n\nplt.subplot(121)\nsns.scatterplot(x='Annual_Income', y='Spending_Score', hue='cluster_Kmeans', data=x2, palette=['green', 'orange',\n                                                            'brown','dodgerblue','red'])\nplt.title(\"K_means\")\nplt.subplot(122)\nsns.scatterplot(x='Annual_Income', y='Spending_Score', hue='cluster_Agg', data=x2, palette=['orange', 'green',\n                                                            'red', 'dodgerblue', 'brown'])\nplt.title(\"Agg\");","2ab7c1ec":"x1.head()","97357f1a":"x1.cluster_Kmeans.value_counts()","076a3cf0":"plt.title(\"clusters with the number of customers\")\nplt.xlabel(\"clusters\")\nplt.ylabel(\"Count\")\nax = x1.cluster_Kmeans.value_counts().plot(kind='bar')\nfor p in ax.patches:\n    ax.annotate(str(p.get_height()), (p.get_x() +0.2, p.get_height() + 0.5))","c43f93ce":"df.head()","c7c0f3e5":"df[\"cluster_Age_Spending_Score\"] = x1.cluster_Kmeans\ndf.head()","543c9b82":"plt.title(\"Men VS Women ratio in each cluster\")\nplt.ylabel(\"Count\")\nax =sns.countplot(x=df.cluster_Age_Spending_Score, hue=df.Gender)\nfor p in ax.patches:\n    ax.annotate(str(p.get_height()), (p.get_x() +0.15, p.get_height() + 0.5))","c684c535":"df.groupby(\"cluster_Age_Spending_Score\").mean()","41cedb10":"plt.figure(figsize = (20,6))\n\nplt.subplot(131)\nsns.boxplot(y = \"Age\", x = \"cluster_Age_Spending_Score\", data = df)\n\nplt.subplot(132)\nsns.boxplot(y = \"Annual_Income\", x = \"cluster_Age_Spending_Score\",  data = df)\n\nplt.subplot(133)\nsns.boxplot(y = \"Spending_Score\", x = \"cluster_Age_Spending_Score\", data = df);","1198cb9b":"plt.figure(figsize = (20,6))\ndf.groupby(\"cluster_Age_Spending_Score\").mean().plot(kind='bar')\nplt.show();","892e4647":"x2.head()","89aed910":"x2.cluster_Kmeans.value_counts()","79969b41":"# lets see the number of poeple lie in each group\nplt.title(\"clusters with the number of customers\")\nplt.xlabel(\"clusters\")\nplt.ylabel(\"Count\")\nax = x2.cluster_Kmeans.value_counts().plot(kind='bar')\nfor p in ax.patches:\n    ax.annotate(str(p.get_height()), (p.get_x() +0.2, p.get_height() + 0.5));","a1300956":"df.head()","fefe418a":"df.drop(columns= \"cluster_Age_Spending_Score\", inplace=True)","004932e4":"df[\"cluster_Annual_Income_Spending_Score\"] = x2.cluster_Kmeans\ndf.head()","80569758":"plt.title(\"Men VS Women ratio in each cluster\")\nplt.ylabel(\"Count\")\nax =sns.countplot(x=df.cluster_Annual_Income_Spending_Score, hue=df.Gender)\nfor p in ax.patches:\n    ax.annotate(str(p.get_height()), (p.get_x() +0.15, p.get_height() + 0.5));","8be85cf5":"df.groupby([\"Gender\", \"cluster_Annual_Income_Spending_Score\"]).mean()","216769cd":"plt.figure(figsize = (20,6))\n\nplt.subplot(131)\nsns.boxplot(y = \"Age\", x = \"cluster_Annual_Income_Spending_Score\", hue= \"Gender\", data = df)\n\nplt.subplot(132)\nsns.boxplot(y = \"Annual_Income\", x = \"cluster_Annual_Income_Spending_Score\", hue= \"Gender\", data = df)\n\nplt.subplot(133)\nsns.boxplot(y = \"Spending_Score\", x = \"cluster_Annual_Income_Spending_Score\", hue= \"Gender\", data = df)","60eb00de":"df.groupby([\"Gender\", \"cluster_Annual_Income_Spending_Score\"]).mean().plot(kind=\"bar\", figsize=(20,6))\nplt.show();","dd6674ca":"df.groupby(\"cluster_Annual_Income_Spending_Score\").mean().plot(kind='bar')\nplt.show()","adbef4f4":"#### Load Dataset","8fedf117":"# 1. Import Libraries, Load Dataset, Exploring Data","87ebce79":"## Hierarchical Clustering","37c506f2":"Majority of customers' ages range fro 27 to 40.","62486100":"### iii. *Visualizing and Labeling All the Clusters* ","aaca703e":"# TASK","56409e83":"Since **CustomerID** column has nothing to do with our segmentation we have just dropped that column.","bf76dfd9":"A dataset with Hopkins score lower than 0.5 means that given dataset is suitable for clustering. And similarly, a dataset with a score over 0.5 is not suitable for clustering. Since our score is under the threshold, we can conclude that our dataset is suitable for clustering.","7f690b51":"#### *ii. Determine optimal number of clusters*","f753eeed":"silhouette_score = (b-a)\/max(a,b)\n\nb : the mean nearest-cluster distance \n\na : the mean intra-cluster distance \n\nfor red point, \n\nb = 1 \n\na = ((1+1)**0.5 + (1+1)**0.5)\/2  ==> 1.41\n\nsilhouette_score = (1-1.41)\/1.41 ==> -0.29","d6bbff1e":"### Clustering based on Age and Spending Score","144697c0":"#### Interpretation based on Annual Income and Spending Score - x2","d982908d":"#### Annual Income and Spending Score - x2","f21da343":"Average spending score is between 35 and 61.","ff18d3d1":"When we check our silhouette scores, n_clusters=4 has the highest score. We have the same case as we had for the given two features in K-Means.","e55ea5e6":"Female customers make up the majority.","e74aca1d":"#### *i. Create a new dataset with two variables of your choice*","deab34ea":"#### Explore Data","c3db7796":"We can see that there is inverse correlation between **Age** and **Spending_Score**.","a3a3f6fd":"# 2. Exploratory Data Analysis","f11631f8":"### Conclusion\n\n**cluster 0** : The average age is around 55, both annula_income and spending_scores are on average. \nIt should be researched what can be done to direct to more spending.\n\n**cluster 1**: The average age is around 45, the annula_income is high but the spending_scores are very low. \nThis group is our target audience and specific strategies should be developed to drive this group to spend.\n\n**cluster 2** :The average age is around 30. The annula_income is high and spending_scores are very high. \nThis group consists of our loyal customers. Our company derives the main profit from this group. Very \nspecial promotions can be made in order not to miss it.    \n    \n**cluster 3**: The average age is around 25.both annula_income and spending_scores are on average. \nIt should be researched what can be done to direct to more spending.","72da85d5":"After performing Cluster Analysis, we need to know the data well in order to label the observations correctly. We will analyze frequency distributions of features, relationships and correlations between the independent variables and the dependent variable. It is recommended to apply data visualization techniques. Observing breakpoints helps us to internalize the data.","e71d61e4":"#### Interpretation based on Age and Spending Score - x1","50c741b7":"Both **yellowbrick** and **elbow method** gives us number 4 as our optimal cluster number. ","a2ab5293":"# 3. Cluster Analysis\n\n## K_Means","7c4c1c60":"When we check our silhouette scores, **n_clusters=4** has the highest score.","4ad66bea":"So far so good. No zero variance and no extremely high variance.","60838d09":"![image.png](attachment:37c41d8d-1fdc-4dba-b325-fa1e63db7b5a.png)","b83f9eb2":"# Have fun reading.","f251f8d2":"We just added **Gender** into our analysis. ","6a636807":"##### *iii. Apply K Means*","e0bff12f":"Based on the distance ranges, we can see that **method = \"ward\"** is the best option for us. The bigger the difference, the better cluster we have.","b005adfd":"When we check our silhouette scores, n_clusters=5 has the highest score. We have the same case as we had for the given two features in K-Means.","ae4871fc":"#### *i. Create a new dataset with two variables of your choice*","00d66651":"#### Annual Income and Spending Score - x2","3e501558":"When we check our silhouette scores, n_clusters=5 has the highest score.","6298383c":"#### Import Libraries","c9e7b6df":"#### *ii. Determine optimal number of clusters*","83accb56":"We tried all linkage parameter values to see the differences among them.","d9d068e1":"# Hello All!\n\nIn this project, customers are required to be segmented according to the purchasing history obtained from the membership cards of a big mall.","6240b42e":"### Clustering based on Annual Income and Spending Score","bb9aa36e":"With **Annual_Income** and **Spending_Score**, we decided on 5 as number of cluster after our analysis.","d00dc702":"### ii. *Apply Agglomerative Clustering*","bb50cff5":"#### Age and Spending Score- x1","06c0018f":"We have neither missing value nor duplicated row. So far so good.","17d77761":"**cluster 0** : The average age is around 40, both annula_income and spending_scores are on average. \nIt should be researched what can be done to direct more spending.\n\n**cluster 1**: The average age is around 30, both annula_income and spending_scores are very high. \nThis group consists of our loyal customers. Our company derives the main profit from this group. Very \nspecial promotions can be made in order not to miss it.\n\n**cluster 2** :The average age is around 45. Both annula_income and spending_scores are low. It can be \ndirected to shopping with gift certificates.\n\n**cluster 3**: The average age is around 25. Low annual_incomes but very high spending scores. This \ngroup does a lot of shopping, but they do not bring much profit.\n\n**cluster 4**: The average age is around 40, their annual income is very high but their spending_score\nis very low. This group is our target audience and special strategies need to be developed for this \ngroup.","45e0d12b":"## Clustering based on Annual Income and Spending Score - x2","f2068699":"There is a big mall in a specific city that keeps information of its customers who subscribe to a membership card. In the membetrship card they provide following information : **gender**, **age** and **annula income**. The customers use this membership card to make all the purchases in the mall, so tha mall has the purchase history of all subscribed members and according to that they compute the spending score of all customers. We have to segment these customers based on the details given.","56d92a35":"We can see that **Age**, **Annual_Income**, and **Spending_Score** differs from one cluster to other. ","571d4df3":"#### *iv. Visualizing and Labeling All the Clusters*","85212980":"Our values seem to be within the close range. It is good to know for deciding on whether to sclae our dataset.","cbbc83fa":"Since **Gender** column bsically consists of 0 and 1, we dropped it due to fact that it is not suitbale for clustering. We will add it to our analysis later on.","0185abbc":"**Note: Why silhouette_score is negative?**","49ff4eca":"We created a new dataset from **Age** and **Spending_Score** columns.","4c996d4c":"### Clustering based on Age and Spending Score - x1","28ecb887":"### *i. Determine optimal number of clusters using Dendogram*","08411bc4":"Firstly, we will use the **K-Means algorithm** that expects us to determine the number of clusters (**n_clusters**). We can determine the optimal number of clusters for each cluster analysis in various ways. In this case, we are expected to use the [Elbow Method](https:\/\/en.wikipedia.org\/wiki\/Elbow_method_(clustering).","35e0e7c8":"With two features, our score is better. ","87a23f0f":"#### *iii. Apply K Means*","954d63be":"## Conclusion","7cf11a9b":"### Male\n\n**cluster 0** : The average age is around 45, both annula_income and spending_scores are on average. \nIt should be researched what can be done to direct more spending.\n\n**cluster 1**: The average age is around 40, the annula_income is very high but the spending_scores is very low.\nThis group is our target audience and special strategies need to be developed for this group.    \n\n**cluster 2** :The average age is around 50. Both annula_income and spending_scores are low. It can be \ndirected to shopping with gift certificates.\n\n**cluster 3**: The average age is around 25. Low annual_incomes but very high spending scores. This \ngroup does a lot of shopping, but they do not bring much profit.\n\n**cluster 4**: The average age is around 30, the annual income and the spending_score\nis very high. This group consists of our loyal customers. Our company derives the main profit from this group. \nVery special promotions can be made in order not to miss it.","2c618369":"### Female\n\n**cluster 0** : The average age is around 40, both annula_income and spending_scores are on average. \nIt should be researched what can be done to direct more spending.\n\n**cluster 1**: The average age is around 45, the annula_income is very high but the spending_scores is low.\nThis group is our target audience and special strategies need to be developed for this group.    \n\n**cluster 2** :The average age is around 45. Both annula_income and spending_scores are low. It can be \ndirected to shopping with gift certificates.\n\n**cluster 3**: The average age is around 25. Low annual_incomes but very high spending scores. This \ngroup does a lot of shopping, but they do not bring much profit.\n\n**cluster 4**: The average age is around 30, the annual income and the spending_score\nis very high. This group consists of our loyal customers. Our company derives the main profit from this group. \nVery special promotions can be made in order not to miss it.","8492ad21":"We just retrieved results of **K_Means** and **Hierarchical Clustering** to see the differences. There are slight differences between two models. ","fbf548da":" We checked the number of poeple lie in each group.","a992b990":"Average annual income of customers is between 48K and 73K. Therefore, we can conclude that middle-income customers consist of the majority.","b2edb6ea":"#### *iv. Visualizing and Labeling All the Clusters*","eb1a4916":"Based on our observation on **Annual_Income** vs. **Spending_Score**, we may have 5 custers for the given dataset.","63af97bd":"At the end of the project, we will have performed **Cluster Analysis** with an **Unsupervised Learning method**.","55725826":"#### Age and Spending Score - x1","ac6d67d2":"#### 1. Import Libraries, Load Dataset, Exploring Data\n- Import Libraries\n- Load Dataset\n- Explore Data\n\n#### 2. Exploratory Data Analysis (EDA)\n\n\n#### 3. Cluster Analysis\n\n- Clustering based on Age and Spending Score\n\n    *i. Create a new dataset with two variables of your choice*\n    \n    *ii. Determine optimal number of clusters*\n    \n    *iii. Apply K Means*\n    \n    *iv. Visualizing and Labeling All the Clusters*\n    \n    \n- Clustering based on Annual Income and Spending Score\n\n    *i. Create a new dataset with two variables of your choice*\n    \n    *ii. Determine optimal number of clusters*\n    \n    *iii. Apply K Means*\n    \n    *iv. Visualizing and Labeling All the Clusters*\n    \n    \n- Hierarchical Clustering\n\n    *i. Determine optimal number of clusters using Dendogram*\n\n    *ii. Apply Agglomerative Clustering*\n\n    *iii. Visualizing and Labeling All the Clusters* \n\n- Conclusion"}}