{"cell_type":{"e6d6c01f":"code","6e324de5":"code","b5d32fba":"code","4c2b0745":"code","1de7dc1b":"code","757da7a1":"code","74799c75":"code","b09621d3":"code","2a2db314":"code","013b649e":"code","12889a26":"code","328c73df":"code","80862734":"code","77040135":"code","53c1b2c3":"code","ffc6ab7b":"code","f4e7838d":"code","d072314f":"code","5783501c":"code","a432246e":"code","96e690a3":"code","f24d3e84":"code","ddbf281d":"code","c92c41a8":"code","f0d32aa5":"code","edbf805b":"code","e8376cf7":"code","92119d89":"code","59316322":"code","65977822":"code","52c5a54d":"code","5e1effae":"code","359ce71f":"code","d5d4cea4":"code","3d1d8a0d":"code","cd2467ad":"code","e57d1169":"code","2e3f0394":"code","56b58f3a":"code","92930bd7":"code","6d6f0df2":"code","763df286":"code","52f5dc01":"code","b1f862c6":"code","4bab7946":"markdown","47076c61":"markdown","6732f0b6":"markdown"},"source":{"e6d6c01f":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom matplotlib import style\nstyle.use(\"fivethirtyeight\")","6e324de5":"from sklearn.datasets import make_blobs","b5d32fba":"x, _ = make_blobs(n_samples=500, random_state=128)","4c2b0745":"plt.figure(figsize=(18,11))\nsns.scatterplot(x=x[:,0], y=x[:,1])\nplt.show()","1de7dc1b":"from sklearn.cluster import KMeans","757da7a1":"kmeans = KMeans(n_clusters=3)\nkmeans.fit(x)\ncluster_labels = kmeans.predict(x)","74799c75":"plt.figure(figsize=(18,11))\nsns.scatterplot(x=x[:,0], y=x[:,1], hue=cluster_labels, palette=\"Set2\")\nplt.show()","b09621d3":"noise = np.random.uniform(low=[-10,-13], high=[40, 4.5], size=(130,2))\nx = np.vstack([x, noise])","2a2db314":"noise.shape","013b649e":"plt.figure(figsize=(18,11))\nsns.scatterplot(x=x[:,0], y=x[:,1])\nplt.show()","12889a26":"kmeans = KMeans(n_clusters=3)\nkmeans.fit(x)\ncluster_labels = kmeans.predict(x)\nplt.figure(figsize=(18,11))\nsns.scatterplot(x=x[:,0], y=x[:,1], hue=cluster_labels, palette=\"tab10\")\nplt.show()","328c73df":"!pip install pyclustering","80862734":"import pyclustering","77040135":"from pyclustering.cluster.kmedians import kmedians","53c1b2c3":"med = [(-10,-10),\n       (-10, 5),\n       (5,-5)]\nkmd = kmedians(x, initial_medians = med)\nkmd.process()","ffc6ab7b":"clusters = kmd.get_clusters()","f4e7838d":"len(clusters)","d072314f":"cluster_labels=np.empty(shape=(x.shape[0],))\nfor clus_ind in range(3):\n    clus = clusters[clus_ind]\n    for j in range(len(clus)):\n        point = clus[j]\n        cluster_labels[point] = clus_ind","5783501c":"plt.figure(figsize=(18,11))\nsns.scatterplot(x=x[:,0], y=x[:,1], hue=cluster_labels, palette=\"tab10\")\nplt.show()","a432246e":"data = pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")","96e690a3":"data.head()","f24d3e84":"data.shape","ddbf281d":"data.isna().sum()","c92c41a8":"data.drop(\"CustomerID\", axis=1, inplace=True)","f0d32aa5":"data.describe()","edbf805b":"for col in data.columns:\n    if col!='Gender':\n        plt.figure(figsize=(20,8))\n        sns.histplot(x=col, data=data, color=\"crimson\")\n        plt.show()","e8376cf7":"sns.countplot(x=\"Gender\", data=data)\nplt.show()","92119d89":"data[\"Gender\"] = data[\"Gender\"].map({\"Male\":0, \"Female\":1})","59316322":"data.head(10)","65977822":"from sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\nx = scaler.fit_transform(data)","52c5a54d":"data = pd.DataFrame(x, columns=data.columns)\ndata.head()","5e1effae":"kmeans = KMeans(n_clusters=3)\nkmeans.fit(data)","359ce71f":"some_clients = data.iloc[4:8,:]","d5d4cea4":"some_clients","3d1d8a0d":"some_clients.shape","cd2467ad":"kmeans.predict(some_clients)","e57d1169":"for i in range(2,9):\n    print(i)","2e3f0394":"wcss = []\nnclus = range(2,9)\nfor k in nclus:\n    kmeans = KMeans(n_clusters=k)\n    kmeans.fit(data)\n    wcss.append(kmeans.inertia_)\nplt.figure(figsize=(20,8))\nplt.plot(nclus, wcss)\nplt.xlabel(\"n\u00b0 of Clusters\")\nplt.ylabel(\"WCSS\")\nplt.show()","56b58f3a":"wcss = []\nnclus = range(2,30)\nfor k in nclus:\n    kmeans = KMeans(n_clusters=k)\n    kmeans.fit(data)\n    wcss.append(kmeans.inertia_)","92930bd7":"wcss","6d6f0df2":"plt.figure(figsize=(20,8))\nplt.plot(nclus, wcss)\nplt.xlabel(\"n\u00b0 of Clusters\")\nplt.ylabel(\"WCSS\")\nplt.show()","763df286":"from sklearn.metrics import silhouette_score","52f5dc01":"sil = []\nnclus = range(2,30)\nfor k in nclus:\n    kmeans = KMeans(n_clusters=k)\n    kmeans.fit(data)\n    sil.append(silhouette_score(data, kmeans.labels_))","b1f862c6":"plt.figure(figsize=(20,8))\nplt.plot(nclus, sil)\nplt.xlabel(\"n\u00b0 of Clusters\")\nplt.ylabel(\"SILHOUETTE\")\nplt.show()","4bab7946":"# Clustering Mall Customers","47076c61":"## Evaluation\n![](https:\/\/www.analyticsindiamag.com\/wp-content\/uploads\/2019\/08\/4_wcss.png)","6732f0b6":"![](https:\/\/editor.analyticsvidhya.com\/uploads\/43191elbow_img%20(1).png)"}}