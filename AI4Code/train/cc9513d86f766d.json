{"cell_type":{"e030dde3":"code","21ac8580":"code","d4c85c75":"code","7b7f0013":"code","fe7f8027":"code","acb0ce48":"code","fdb72e80":"markdown"},"source":{"e030dde3":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.svm import SVC\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn.model_selection import train_test_split\nimport seaborn as sns\ntrain=pd.read_csv('..\/input\/petfinder-pawpularity-score\/train.csv')\ntrain.head()\ntrain.describe()\ntrain.isnull().sum()","21ac8580":"corr=train.corr()\ncorr.style.background_gradient(cmap='coolwarm') ","d4c85c75":"train['Pawpularity'].hist()","7b7f0013":"classifiers=[KNeighborsRegressor(5),\n            SVC(probability=True,kernel='linear'),\n            RandomForestRegressor(n_estimators=200,max_depth=5,random_state=612),\n            GradientBoostingRegressor(n_estimators=200,max_depth=5,random_state=612)]\nrmse_dict={}\nlog_cols=['Algoritm','RMSE']\nlog=pd.DataFrame(columns=log_cols)\ntest=pd.read_csv('..\/input\/petfinder-pawpularity-score\/test.csv')\nX_train, X_test, Y_train, Y_test = train_test_split(train.drop(['Id', 'Pawpularity'], axis=1), \n                                                    train['Pawpularity'], \n                                                    test_size=0.2, \n                                                    random_state=612)\nfor clf in classifiers:\n    name=clf.__class__.__name__\n    clf.fit(X_train,Y_train)\n    predictions=clf.predict(X_test)\n    rmse=mean_squared_error(Y_test,predictions,squared=False)\n    print(clf,rmse)\n    if name in rmse_dict:\n        rmse_dict[name]+=rmse\n    else:\n        rmse_dict[name]=rmse\nfor clf in rmse_dict:\n    log_entry=pd.DataFrame([[clf,rmse_dict[clf]]],columns=log_cols)\n    log=log.append(log_entry)\nplt.xlabel('RMSE') \nimport seaborn as sns\nsns.set_color_codes('muted')\nsns.barplot(x='RMSE',y='Algoritm',data=log.sort_values(by='RMSE'),color='b')","fe7f8027":"model=RandomForestRegressor(n_estimators=200,max_depth=5,random_state=612)\nmodel_fit=model.fit(X_train,Y_train)\npred=model_fit.predict(X_test)\nrmse=mean_squared_error(Y_test,pred,squared=False)\nprint(rmse)","acb0ce48":"sub = pd.read_csv(\"..\/input\/petfinder-pawpularity-score\/sample_submission.csv\")\nsub['Pawpularity'] = model_fit.predict(test.drop(['Id'], axis=1))\nsub.to_csv(\"submission.csv\", index=False)\nsub","fdb72e80":"the best model is RandomForestRegressor, rmse=20,716"}}