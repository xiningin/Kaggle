{"cell_type":{"f60eb17d":"code","7a1008fe":"code","06ed4676":"code","7dab8ea4":"code","06a80e7c":"code","c8c4e130":"code","d99a9033":"code","86f8090e":"code","d6e5e771":"markdown"},"source":{"f60eb17d":"import pandas as pd\nfrom math import floor","7a1008fe":"association = pd.read_csv('..\/input\/market-basket-id-ndsc-2020\/association_order.csv')\nrules = pd.read_csv('..\/input\/market-basket-id-ndsc-2020\/rules.csv')","06ed4676":"group_itemid = association.groupby('itemid')['orderid'].apply(set)","7dab8ea4":"group_itemid.head()","06a80e7c":"def confidence(data):\n    data = [i.split('&') for i in data.split('>')]\n    denominator = group_itemid[int(data[0][0])]\n    if len(data[0]) > 1:\n        denominator = denominator.intersection(group_itemid[int(data[0][1])])\n    numerator = set(denominator)\n    for i in data[1]:\n        numerator = numerator.intersection(group_itemid[int(i)])\n    return floor(len(numerator)\/len(denominator)*1000)","c8c4e130":"rules['confidence'] = rules['rule'].apply(confidence)","d99a9033":"rules","86f8090e":"rules.to_csv('submission.csv',index=False)","d6e5e771":"# Market Basket Accuracy 1.0"}}