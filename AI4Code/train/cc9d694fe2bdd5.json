{"cell_type":{"010a9d1d":"code","24bda5f2":"code","e61f896e":"code","61429800":"code","be87ea05":"code","06fbcf4e":"code","31beafa2":"code","15379575":"code","735bfd45":"code","b25db095":"code","b973cc4e":"code","8266db10":"code","0a8ef3f8":"code","3ea39a2a":"code","dafbedff":"code","f61259bf":"code","f8cb7101":"code","a89c041b":"markdown","32a5c0b8":"markdown","a55a62b3":"markdown","85fd0550":"markdown","691d1070":"markdown","70b1fe39":"markdown","e72a6dec":"markdown","11a91acd":"markdown","3d08d343":"markdown","615b9bd9":"markdown"},"source":{"010a9d1d":"import numpy as np\n\nimport matplotlib.pyplot as plt\n\nfrom tensorflow import keras\nfrom sklearn.model_selection import train_test_split","24bda5f2":"(train_input, train_target), (test_input, test_target) = \\\n    keras.datasets.fashion_mnist.load_data()\n\n","e61f896e":"train_scaled = train_input.reshape(-1, 28, 28, 1) \/ 255.0","61429800":"train_scaled, val_scaled, train_target, val_target = train_test_split(\n    train_scaled, train_target, test_size=0.2, random_state=42)","be87ea05":"model = keras.Sequential()\n\nmodel.add(keras.layers.Conv2D(32, kernel_size=3, activation='relu', \n                              padding='same', input_shape=(28,28,1)))\nmodel.add(keras.layers.MaxPooling2D(2))\n\nmodel.add(keras.layers.Conv2D(64, kernel_size=(3,3), activation='relu', \n                              padding='same'))\nmodel.add(keras.layers.MaxPooling2D(2))\n\nmodel.add(keras.layers.Flatten())\nmodel.add(keras.layers.Dense(100, activation='relu'))\nmodel.add(keras.layers.Dropout(0.4))\nmodel.add(keras.layers.Dense(10, activation='softmax'))\n\nmodel.summary()","06fbcf4e":"keras.utils.plot_model(model)","31beafa2":"keras.utils.plot_model(model, show_shapes=True, to_file='cnn-architecture.png', dpi=100)","15379575":"model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', \n              metrics='accuracy')","735bfd45":"checkpoint_cb = keras.callbacks.ModelCheckpoint('best-cnn-model.h5', \n                                                save_best_only=True)\nearly_stopping_cb = keras.callbacks.EarlyStopping(patience=2,\n                                                  restore_best_weights=True)\n\nhistory = model.fit(train_scaled, train_target, epochs=20,\n                    validation_data=(val_scaled, val_target),\n                    callbacks=[checkpoint_cb, early_stopping_cb])","b25db095":"plt.plot(history.history['loss'])\nplt.plot(history.history['val_loss'])\nplt.xlabel('epoch')\nplt.ylabel('loss')\nplt.legend(['train', 'val'])\nplt.show()","b973cc4e":"model.evaluate(val_scaled, val_target)","8266db10":"plt.imshow(val_scaled[0].reshape(28, 28), cmap='gray_r')\nplt.show()","0a8ef3f8":"preds = model.predict(val_scaled[0:1])\nprint(preds)","3ea39a2a":"plt.bar(range(1, 11), preds[0])\nplt.xlabel('class')\nplt.ylabel('prob.')\nplt.show()","dafbedff":"class_labels= ['T-shirt\/top','Trouser','Pullover','Dress','Coat',\n               'Sandal','Shirt','Sneakers','Bag','Ankle boot']\n\nprint(class_labels[np.argmax(preds)])","f61259bf":"test_scaled = test_input.reshape(-1, 28, 28, 1) \/ 255.0","f8cb7101":"model.evaluate(test_scaled, test_target)","a89c041b":"# define model(CNN)","32a5c0b8":"# evaluate model(with validation set)","a55a62b3":"# load data ","85fd0550":"# build model","691d1070":"# evaluate model(with test set)","70b1fe39":"# split data ","e72a6dec":"# preprocess data ","11a91acd":"# evaluate model with test data ","3d08d343":"# predict test data using model","615b9bd9":"# define model training setting"}}