{"cell_type":{"82a3ec8f":"code","cf98cdf5":"code","28bb580d":"code","1f637ffd":"code","2b2b83cd":"code","9d9939db":"code","d8dfca2d":"code","7e643214":"code","1eb0736b":"code","3eafa731":"code","43256f20":"code","991c392b":"code","d3e722f1":"code","1159b5fd":"code","bd5b947b":"code","4812946f":"code","ef7a14a9":"code","a07bb42a":"code","84ca97db":"code","2d21082f":"code","439fc7e3":"code","47b322ad":"code","2c21dbcc":"code","b1b9238b":"code","cbed83d3":"code","80e000c1":"code","16df6683":"code","95d5f683":"code","eb50ad1c":"code","aaa5bf5a":"code","b55ffcce":"code","9698672f":"code","0be309c9":"code","eeec0131":"code","b029eca9":"code","56f9ea39":"code","936e4ab0":"code","ac7ab0b9":"code","232a717b":"code","b95ba16d":"code","cbf8382a":"code","c751324b":"code","42dd4380":"code","76cabef3":"code","d49d4971":"markdown","f5c9db02":"markdown","bcc3fa89":"markdown"},"source":{"82a3ec8f":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","cf98cdf5":"data=pd.read_csv('..\/input\/adult-dataset\/adult.csv')","28bb580d":"data.head()","1f637ffd":"data.shape","2b2b83cd":"data.isnull().sum()","9d9939db":"#Desc of data\ndata.describe()","d8dfca2d":"data.info()","7e643214":"#Let's see some of the sample values\ndata.sample(5)","1eb0736b":"#age distribution\nsns.distplot(data['age'])","3eafa731":"#Bloxplt\nsns.boxplot(x=data['salary'],y=data['age'],hue=data['sex'])","43256f20":"data['workclass'].value_counts()","991c392b":"data['workclass'].value_counts","d3e722f1":"print(data['workclass'])","1159b5fd":"#unique\ndata['workclass'].unique()","bd5b947b":"#plot the count plot of workclass\nsns.countplot(data['workclass'])\nplt.xticks(rotation=90)\nplt.show()\n","4812946f":"#countplot based on salary\nsns.countplot(data['workclass'],hue=data['salary'])\nplt.xticks(rotation=90)\nplt.show()","ef7a14a9":"sns.scatterplot(data['workclass'],hue=data['salary'])\n","a07bb42a":"data.head(10)","84ca97db":"#type of edu values\ndata['education'].value_counts()","2d21082f":"#number of unique\ndata['education'].nunique()","439fc7e3":"data['education-num'].nunique()","47b322ad":"#data only for bachelors\ndata[data['education'] ==' Bachelors']","2c21dbcc":"#data only for hs grade\ndata[data['education']==' HS-grad']","b1b9238b":"#drop the columns which are not required'\ndata.drop(['education','capital-loss','capital-gain'],axis=1,inplace=True)","cbed83d3":"data.columns","80e000c1":"data['marital-status'].unique()","16df6683":"data['occupation'].unique()","95d5f683":"data.replace(' ?','Unknown',inplace=True)","eb50ad1c":"data['occupation'].unique()","aaa5bf5a":"data.info()","b55ffcce":"cat_cols = ['workclass', 'marital-status', 'occupation', 'relationship', 'race', 'sex', 'country']\n\ndf = pd.get_dummies(data[cat_cols], drop_first= True)","9698672f":"df","0be309c9":"data.head()","eeec0131":"data.drop(cat_cols, axis = 1, inplace = True)","b029eca9":"data['salary'] = data['salary'].map({\" <=50K\" : 0,\n                                    \" >50K\" : 1})","56f9ea39":"data['salary'].unique()","936e4ab0":"new_data = pd.concat([df, data], axis = 1)","ac7ab0b9":"new_data.head()","232a717b":"#Seperate x and y variables\n\nx = new_data.drop('salary', axis = 1)\n\ny = new_data['salary']","b95ba16d":"#Split dataset into training and testing\n\nfrom sklearn.model_selection import train_test_split\n\nx_train, x_test, y_train, y_test = train_test_split(x,y, test_size = 0.25, random_state = 0)","cbf8382a":"#Import random forest classifier from ensembles\n\nfrom sklearn.ensemble import RandomForestClassifier\nrf_model = RandomForestClassifier(n_estimators = 150)\nrf_model.fit(x_train, y_train)","c751324b":"\n#Training prediction \n\ntr_predict = rf_model.predict(x_train)","42dd4380":"#testing prediction\n\nts_predict = rf_model.predict(x_test)","76cabef3":"from sklearn.metrics import accuracy_score, plot_confusion_matrix, roc_auc_score\n\nprint(\"Training accuracy\", accuracy_score(y_train, tr_predict))\nprint(\"Test Accuracy\", accuracy_score(y_test, ts_predict))","d49d4971":"# Random forest Implementation","f5c9db02":"# **Adult data set**","bcc3fa89":"<a href=\"https:\/\/colab.research.google.com\/github\/Ravikumar10593-hub\/15daybootcamp\/blob\/main\/Day_9_ML.ipynb\" target=\"_parent\"><img src=\"https:\/\/colab.research.google.com\/assets\/colab-badge.svg\" alt=\"Open In Colab\"\/><\/a>"}}