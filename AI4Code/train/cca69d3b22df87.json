{"cell_type":{"5677dbe4":"code","415f663d":"code","8a8ff955":"code","4662aaea":"code","4fafbc0e":"code","1da2a35f":"code","dc529dcf":"code","c0851a2d":"code","f9a3d8fa":"code","08fe7fa9":"code","e1fedf44":"code","cc3ac53c":"code","8b6310cc":"code","47b02bab":"code","3d8284d7":"code","3fd31546":"markdown"},"source":{"5677dbe4":"import numpy as np\nimport pandas as pd\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import VotingRegressor\nfrom sklearn.svm import LinearSVR\nfrom xgboost import XGBRegressor\nfrom sklearn.neural_network import MLPRegressor\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import OrdinalEncoder\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.metrics import mean_squared_error","415f663d":"train_data = pd.read_csv('\/kaggle\/input\/30-days-of-ml\/train.csv', index_col='id')\ntest_data = pd.read_csv('\/kaggle\/input\/30-days-of-ml\/test.csv', index_col='id')","8a8ff955":"categorical_cols = [col for col in train_data.columns if 'cat' in col]\ncontinuous_cols = [col for col in train_data.columns if 'cont' in col]","4662aaea":"X = train_data.drop(['target'], axis=1)\ny = train_data['target']","4fafbc0e":"X_train, X_val, y_train, y_val = train_test_split(X, y, random_state=42)","1da2a35f":"preprocessor = ColumnTransformer(\n    transformers=[\n        ('continuous', MinMaxScaler(), continuous_cols),\n        ('categorical', OrdinalEncoder(), categorical_cols)\n    ])","dc529dcf":"estimators = [\n    ('SVM', LinearSVR()),\n    ('XGBoost', XGBRegressor()),\n    ('Neural Network', MLPRegressor()),\n    ('Random Forest', RandomForestRegressor()),\n    ('KNN', KNeighborsRegressor())\n]","c0851a2d":"model =VotingRegressor(\n    estimators=estimators,\n    verbose=True\n)","f9a3d8fa":"pipeline = Pipeline(\n    steps=[\n        ('preprocessor', preprocessor),\n        ('model', model)\n    ])","08fe7fa9":"pipeline.fit(X_train, y_train)","e1fedf44":"mean_squared_error(y_train, pipeline.predict(X_train), squared=False)","cc3ac53c":"mean_squared_error(y_val, pipeline.predict(X_val), squared=False)","8b6310cc":"preprocessor = ColumnTransformer(\n    transformers=[\n        ('continuous', MinMaxScaler(), continuous_cols),\n        ('categorical', OrdinalEncoder(), categorical_cols)\n    ])\n\nmodel =VotingRegressor(\n    estimators=estimators,\n    verbose=True\n)\n\npipeline = Pipeline(\n    steps=[\n        ('preprocessor', preprocessor),\n        ('model', model)\n    ])\n\npipeline.fit(X, y)","47b02bab":"final_predictions = pd.DataFrame(zip(test_data.index, pipeline.predict(test_data)), columns=['id', 'target'])","3d8284d7":"final_predictions.to_csv('submission.csv', index=False)","3fd31546":"# Training Final Model"}}