{"cell_type":{"7461a94c":"code","e2690c51":"code","6290cfdc":"code","cb27793a":"code","2b0ff29b":"code","3ceef839":"code","f81ddddf":"code","a6585525":"code","307a6da5":"code","77d1b42f":"code","ddf0d2dd":"code","508623fe":"code","57f9904a":"code","56076adc":"code","9dc675b7":"code","dc7ccd91":"code","1d2145e1":"code","54e2ffc4":"code","7e54f6de":"code","34e710ab":"code","a3430526":"code","52ee2977":"code","8ff92679":"code","ecd8bb6a":"code","527aaca5":"code","cd13279e":"code","fe049787":"code","2cc3d5a1":"code","82127a0a":"code","90f15d40":"markdown","89479706":"markdown","9d6adbdf":"markdown","62d31b17":"markdown","f3ab976e":"markdown","5bc180e3":"markdown","e48e7c3c":"markdown","58dc02e2":"markdown","37ec5450":"markdown","c6a8b905":"markdown","ce93e223":"markdown","47d8a08a":"markdown","adab30ca":"markdown","163e3b8f":"markdown","ecbd5f86":"markdown","aba604c9":"markdown","dcd9dd45":"markdown","9a441446":"markdown","1d35e0a4":"markdown","a2871bb6":"markdown","ce0a616e":"markdown","f8719804":"markdown","28d489af":"markdown","40dfb2c0":"markdown","982f437f":"markdown"},"source":{"7461a94c":"import numpy as np # linear algebra\n\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom matplotlib import pyplot as plt\nimport os\nimport seaborn as sns\n\nfrom fuzzywuzzy import process, fuzz\n\nimport warnings\nwarnings.simplefilter(action='ignore', category=FutureWarning)\npd.set_option('mode.chained_assignment',None)","e2690c51":"dataset = pd.read_csv('..\/input\/gufhtugu-publications-dataset-challenge\/GP Orders - 4.csv',encoding='utf-8')","6290cfdc":"dataset.head()","cb27793a":"dataset.shape","2b0ff29b":"dataset.columns = dataset.columns.str.replace(' ', '_')\ndataset['Book_Name'] = dataset['Book_Name'].str.replace('?','')\ndataset['Book_Name'] = dataset['Book_Name'].str.replace(' ','')","3ceef839":"city_wise_orders = dataset.groupby('City_(Billing)')['Order_Number'].nunique().sort_values(ascending=False).head(5)\nprint(city_wise_orders.index)\ncity_wise_orders_top_5 = dataset[dataset['City_(Billing)'].isin(city_wise_orders.index)]\ncity_wise_orders_top_5 = city_wise_orders_top_5[['Order_Number','City_(Billing)']]","f81ddddf":"orders_top_5 = dataset[dataset['City_(Billing)'].isin(city_wise_orders.index)]\nplt.figure(figsize=(10,7))\nsns.countplot(y=\"Order_Status\", data=orders_top_5,order = orders_top_5['Order_Status'].value_counts().index)","a6585525":"plt.figure(figsize=(10,7))\nsns.countplot(y=\"City_(Billing)\", data=city_wise_orders_top_5,order = city_wise_orders_top_5['City_(Billing)'].value_counts().index)","307a6da5":"process.extract('Lahore', dataset['City_(Billing)'].unique(), scorer=fuzz.token_sort_ratio)","77d1b42f":"karachi_orders = dataset[dataset['City_(Billing)'].isin(['Karachi'])]\nprint(karachi_orders.shape[0])","ddf0d2dd":"karachi_orders.head()","508623fe":"karachi_orders['Order_Date']= pd.to_datetime(karachi_orders['Order_Date'])\nprint(karachi_orders.dtypes)","57f9904a":"karachi_orders['Order_Date'].min(), karachi_orders['Order_Date'].max()","56076adc":"karachi_orders['year'] = pd.DatetimeIndex(karachi_orders['Order_Date']).year\nkarachi_orders['month'] = pd.DatetimeIndex(karachi_orders['Order_Date']).month\nkarachi_orders['day'] = pd.DatetimeIndex(karachi_orders['Order_Date']).dayofweek","9dc675b7":"plt.figure(figsize=(5,3))\nsns.countplot(y=\"year\", data=karachi_orders,order = karachi_orders['year'].value_counts().index)","dc7ccd91":"karachi_orders_2020 = karachi_orders[karachi_orders['year'].isin(['2020'])]\nplt.figure(figsize=(15,7))\nsns.countplot(y=\"month\", data=karachi_orders_2020,order = karachi_orders_2020['month'].value_counts().index)","1d2145e1":"plt.figure(figsize=(15,7))\ncity_wise_data_top_5 = dataset[dataset['City_(Billing)'].isin(city_wise_orders.index)]\ncity_wise_data_top_5['Order_Date']= pd.to_datetime(city_wise_data_top_5['Order_Date'])\ncity_wise_data_top_5['month'] = pd.DatetimeIndex(city_wise_data_top_5['Order_Date']).month\ncity_wise_data_top_5['year'] = pd.DatetimeIndex(city_wise_data_top_5['Order_Date']).year\ncity_wise_data_top_5 = city_wise_data_top_5[city_wise_data_top_5['year'].isin(['2020'])]\ncity_wise_data_top_5_agg = city_wise_data_top_5.groupby(['City_(Billing)','month'])['Order_Number'].count().reset_index().rename(columns={'Order_Number':'order_count'})\nsns.lineplot(data=city_wise_data_top_5_agg, x=\"month\", y=\"order_count\", hue=\"City_(Billing)\")","54e2ffc4":"plt.figure(figsize=(15,7))\nsns.countplot(y=\"day\", data=karachi_orders_2020,order = karachi_orders_2020['day'].value_counts().index)","7e54f6de":"# karachi_orders_2020['Book_Name'].value_counts()\nkarachi_orders_2020_top_books = karachi_orders_2020.groupby('Book_Name')['Order_Number'].nunique().sort_values(ascending=False).head(5)\nprint(karachi_orders_2020_top_books)","34e710ab":"print(karachi_orders_2020.shape[0])\nkarachi_orders_2020['Book_Name'] = karachi_orders_2020['Book_Name'].replace('', np.nan)\nkarachi_orders_2020.dropna(inplace=True)\nprint(karachi_orders_2020.shape[0])","a3430526":"karachi_orders_2020_top_books = karachi_orders_2020.groupby('Book_Name')['Order_Number'].nunique().sort_values(ascending=False).head(5)\nkarachi_orders_2020_top_books = dataset[dataset['Book_Name'].isin(karachi_orders_2020_top_books.index)]\nplt.figure(figsize=(15,7))\nsns.countplot(y=\"Book_Name\", data=karachi_orders_2020_top_books,order = karachi_orders_2020_top_books['Book_Name'].value_counts().index)","52ee2977":"from wordcloud import WordCloud, STOPWORDS\ncomment_words = [' ','?']\nstopwords = set(STOPWORDS) ","8ff92679":"dataset = pd.read_csv('..\/input\/gufhtugu-publications-dataset-challenge\/GP Orders - 2.csv',encoding='unicode_escape')\ndataset.columns = dataset.columns.str.replace(' ', '_')\nbook_words = []\nfor i in dataset.Book_Name: \n    i = str(i) \n    separate = i.split()\n    for j in range(len(separate)): \n        separate[j] = separate[j].lower() \n    book_words+=(separate)\nword_str = ' '.join([str(elem) for elem in book_words])","ecd8bb6a":"wordcloud = WordCloud(width = 1600, height = 800, background_color ='white', stopwords = stopwords, min_font_size = 10).generate(word_str)                      \nplt.figure(figsize = (15, 8), facecolor = None) \nplt.imshow(wordcloud) \nplt.axis(\"off\") \nplt.tight_layout(pad = 0) \nplt.show() ","527aaca5":"dataset = pd.read_csv('..\/input\/gufhtugu-publications-dataset-challenge\/GP Orders - 4.csv',encoding='utf-8')\ndataset.columns = dataset.columns.str.replace(' ', '_')\ndataset_returned = dataset[dataset['Order_Status'].isin(['Returned'])]\ndataset_returned_top_5 = dataset_returned[dataset_returned['City_(Billing)'].isin(city_wise_orders.index)]","cd13279e":"dataset_returned_top_5.head()","fe049787":"sns.countplot(x=\"City_(Billing)\", data=dataset_returned_top_5)","2cc3d5a1":"dataset_one_hot = pd.get_dummies(dataset, columns = ['Order_Status'])\ndataset_one_hot.head()\ndataset_one_hot['Order_Date']= pd.to_datetime(dataset_one_hot['Order_Date'])\ndataset_one_hot['year'] = pd.DatetimeIndex(dataset_one_hot['Order_Date']).year\ndataset_one_hot['month'] = pd.DatetimeIndex(dataset_one_hot['Order_Date']).month\ndataset_one_hot['day'] = pd.DatetimeIndex(dataset_one_hot['Order_Date']).dayofweek\ndataset_one_hot = dataset_one_hot[dataset_one_hot['year'].isin(['2020'])]\ncorr_cols = ['month','day','Order_Status_Canceled','Order_Status_Returned','Order_Status_Completed']\ncorr = dataset_one_hot[corr_cols].corr()\nsns.heatmap(corr,annot=True)","82127a0a":"dataset_t5 = dataset_one_hot[dataset_one_hot['City_(Billing)'].isin(city_wise_orders.index)]\ndataset_t5 = dataset_t5.groupby(['month','City_(Billing)']).sum()[[\"Order_Status_Returned\", \"Order_Status_Completed\",\"Order_Status_Canceled\"]].reset_index()\nsns.scatterplot(data=dataset_t5, x=\"month\", y=\"Order_Status_Returned\")","90f15d40":"So there are a lot of LAHOREs here :). I'll not be cleaning them but this can be achieved via `fuzzywuzzy`","89479706":"It makes sense, We've got only 2 months data for 2019, and bearly a Month's data for 2021.\n\nLets take only **2020's** data","9d6adbdf":"**Note**: The wordcloud is plotted on old CSV. I wasn't able to spend some time on setting it up for Urdu Characters as well.\nLeaving it for someone to take up :)","62d31b17":"### Lets see from which Area we've got most orders","f3ab976e":"### Trend of top Cities - Month Wise ","5bc180e3":"### Lets dive into Karachi and slice the data further;","e48e7c3c":"#### Picking the top 5 Cities","58dc02e2":"Product Managment, Python, AI and Blockchain seems prominent.\n\nIt would be interesting to see bigrams plotted not just individual words to get more context.","37ec5450":"Not sure why, but top cities seems to follow a pattern (Like the spikes in 5th and 8th Month). Probably its becuase of some campaign or discounts on Gufthagu. ","c6a8b905":"### Returned by City amoung top Cities","ce93e223":"I should have encoded these to Names but FYI; Monday is denoted by 0 and ends on Sunday which is denoted by 6\n\nSo major order are placed on **Saturdays**.","47d8a08a":"## Now lets check only the Books that were returned","adab30ca":"### Lets see which book was famous in Karachi","163e3b8f":"## Load & View Data Properties","ecbd5f86":"The `City_(Billing)` column is not clean, The top counts are not accurate becuase we've got a lot of typos and full adresses instead of Cities. Lets have a quick peek if that's true.","aba604c9":"Intersting, Seems the case where people are setting there New year's target :). Major orders are from **November** and **December**.","dcd9dd45":"# Things that I'll try to do;\n\n* Try Fuzzy match on Cities to get an accurate picture\n* Try to predict the orders for next month\n","9a441446":"## Cleaning up the Values for Further Analysis\n#### Not sure, if that '??' was actually in Urdu Script","1d35e0a4":"We've data from Oct 2019, till Jan 2021.\n\nLets create the Day, Month and Year Columns","a2871bb6":"### Lets see a day wise breakup now","ce0a616e":"#### Seems like Returns are likely to increase as we move ahead in a Year - Slight Correlation with Month-IDs. \n\n#### Don\u2019t mix it with Causation, it might be a trend that doesn\u2019t make any sense.","f8719804":"## Lets build a wordclould of all Ordered Booknames - English","28d489af":"Shout Out to Zeeshan ul Hassan on getting the top position for his Book in Karachi.\n\nI feel honored coding this notebook in Python :D - Because it was pretty hot in 2020\n\nNot to forget we've not Cleansed the Book names yet *(Not sure if there are any typos in Book Names)*. If so, the ranking will surely differ after we sort out the Nomenclature","40dfb2c0":"You can see that returns are in an increasing patterns as we move though the timeline (2020-Months)","982f437f":"Lets quickly vertify if thats happening"}}