{"cell_type":{"5c14efa2":"code","dcfe6aeb":"code","db1b6ac6":"code","e47056ac":"code","c532100d":"code","e041872c":"code","f6fa35a8":"code","4b49b2a8":"code","dee732f2":"code","ad118d04":"code","17fdea20":"code","d88733d6":"code","6ccebe5e":"code","972b2ebb":"code","840def9f":"code","83e55185":"code","5cb82016":"code","64c3a8fe":"code","b7761809":"code","cb844034":"code","ed57a951":"markdown","3c5c2c84":"markdown"},"source":{"5c14efa2":"!pip install --upgrade autokeras\n!pip install --upgrade keras_tuner","dcfe6aeb":"import pandas as pd\nimport numpy as np\n\nimport tensorflow as tf\nimport autokeras as ak\n\nimport gc\ntrain_path = '..\/input\/tabular-playground-series-jul-2021\/train.csv'\ntest_path = '..\/input\/tabular-playground-series-jul-2021\/test.csv'\nRS = 69420","db1b6ac6":"df = pd.read_csv(train_path, index_col=0, parse_dates=True)\ndf","e47056ac":"targets = ['target_carbon_monoxide', 'target_benzene', 'target_nitrogen_oxides']","c532100d":"X = df.drop(targets, axis=1).values\ny = df[targets].values\n\nX.shape, y.shape","e041872c":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, shuffle=False, random_state=RS)\n    \nX_train.shape, y_train.shape, y_test.shape, X_test.shape","f6fa35a8":"from sklearn.preprocessing import MinMaxScaler\nsc = MinMaxScaler()\n\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)","4b49b2a8":"RMSE = tf.keras.metrics.RootMeanSquaredError()\n\nak_clf = ak.StructuredDataRegressor(overwrite=False,\n                                    project_name='TPS_AK_July',\n                                    objective=\"val_loss\", \n                                    metrics=[RMSE],\n                                    seed=RS,\n                                    max_trials=2000)","dee732f2":"from tensorflow.keras.callbacks import EarlyStopping, ReduceLROnPlateau\nes = EarlyStopping(monitor='val_loss', patience=2, restore_best_weights=True, verbose=1)","ad118d04":"gc.collect()","17fdea20":"%%time\nak_clf.fit(X_train, y_train,\n           epochs=4,\n           batch_size=32,\n           validation_data=(X_test, y_test),\n           callbacks=[es],\n           verbose=0)","d88733d6":"model = ak_clf.export_model()\nmodel.summary()","6ccebe5e":"gc.collect()","972b2ebb":"test = pd.read_csv(test_path, index_col=0)","840def9f":"test = sc.transform(test)","83e55185":"submission = pd.read_csv('..\/input\/tabular-playground-series-jul-2021\/sample_submission.csv', index_col=0)","5cb82016":"predictions = model.predict(test)","64c3a8fe":"predictions","b7761809":"submission['target_carbon_monoxide'] = predictions[:, 0]\nsubmission['target_benzene'] = predictions[:, 1]\nsubmission['target_nitrogen_oxides'] = predictions[:, 2]\nsubmission.head()","cb844034":"submission.to_csv('submission.csv')","ed57a951":"# Modelling","3c5c2c84":"# Submission"}}