{"cell_type":{"cf129935":"code","83ea0121":"code","ecedb796":"code","fc157fd0":"code","3f12f3f5":"markdown","d0c35333":"markdown","3772e693":"markdown"},"source":{"cf129935":"import pandas as pd\ndata = pd.read_csv('\/kaggle\/input\/restaurant-revenue-prediction\/train.csv.zip')\nprint('raw data')\nprint(data)\nprint(data.info())","83ea0121":"from sklearn.preprocessing import LabelEncoder\nle1=LabelEncoder()\nle1.fit(data['City Group'])\ndata['Encoded_City Group']=le1.transform(data['City Group'])\nprint(data['Encoded_City Group'])\n\nle2=LabelEncoder()\nle2.fit(data['Type'])\ndata['Encoded_Type']=le2.transform(data['Type'])\nprint(data['Encoded_Type'])","ecedb796":"import matplotlib.pyplot as plt\nfrom sklearn.preprocessing import LabelEncoder\nimport seaborn as sn\nle1=LabelEncoder()\nle1.fit(data['City Group'])\ndata['Encoded_City Group']=le1.transform(data['City Group'])\n#print(data['Encoded_City Group'])\n\nle2=LabelEncoder()\nle2.fit(data['Type'])\ndata['Encoded_Type']=le2.transform(data['Type'])\n#print(data['Encoded_Type'])\n\n\ndf = pd.DataFrame(data[['Encoded_City Group','Encoded_Type','P1','P2','P3','P4','P5','P6','P7','P8','P9','P10','P11','P12'\n,'P13','P14','P15','P16','P17','P18','P19','P20','P21','P22','P23','P24','P25','P26','P27','P28','P29','P30','P31','P32'\n,'P33','P34','P35','P36','revenue']])\n\ncorrMatrix = df.corr()\nsn.heatmap(corrMatrix,0.1)\nplt.show()","fc157fd0":"from sklearn.model_selection import train_test_split\nfrom sklearn import tree\nfrom sklearn.metrics import explained_variance_score\nfrom sklearn.metrics import r2_score\nfrom sklearn.metrics import mean_squared_error\n\nx =(data[['Encoded_City Group','Encoded_Type','P1','P2','P6','P11','P17','P21','P22','P28']])\ny = data['revenue']\nx_train, x_test, y_train, y_test = train_test_split(x, y,test_size=30,random_state=10)\n\n\nclf = tree.DecisionTreeRegressor()\nclf = clf.fit(x, y)\n\n\nypred_clf = clf.predict(x_test)\n\n\n\nprint('explained_variance_clf = ',explained_variance_score(y_test,ypred_clf))\nprint('r2_score_clf = ',r2_score(y_test,ypred_clf))\nprint('mean_squared_error_knn = ',mean_squared_error(y_test,ypred_clf))","3f12f3f5":"Use correlation feature>0.05 to predict\nDetermine test size: train size = 70 : 30\nuse Decision Tree to predict        ","d0c35333":"transform Object to encoder","3772e693":"****Loading Datasets****"}}