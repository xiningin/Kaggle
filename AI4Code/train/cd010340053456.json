{"cell_type":{"6f00dc91":"code","baf0cf44":"code","0007cfe2":"code","77c4b7c7":"code","abcb44f3":"code","b2324f36":"code","a6b8a02f":"code","ae175269":"code","3739b340":"code","32fc70e3":"code","0a33eb9d":"code","74887549":"code","54f1e228":"code","cc4fbcd9":"markdown","e2cf278e":"markdown","e5d029db":"markdown","82feaacc":"markdown","9e82c294":"markdown","5826a681":"markdown","d4710e57":"markdown"},"source":{"6f00dc91":"# import libraries\nimport pandas as pd\nimport joblib","baf0cf44":"# Load the test data set\npd.set_option('max_columns', None)\ntest = pd.read_csv('..\/input\/titanic\/test.csv')\n# Print the shape of the test set \nprint(test.shape)","0007cfe2":"# view first few rows\ntest.head()","77c4b7c7":"# Calculate and print the number of number of missing values in each column\ntest.isna().sum(axis = 0).to_frame().T","abcb44f3":"# Add a new column named 'FamSize' to the DataFrame (sum of the 'SibSp' and 'Parch') \ntest['FamSize'] = test['SibSp'] + test['Parch']\n\n# We will use the function below to determine the deck letter for each passenger:\ndef set_deck(cabin):\n    if str(cabin) == 'nan':\n        return 'Missing'\n    return cabin[0]\n\n# Use the map() method of the train DataFrame to apply the function above \n# to the 'Cabin' column. Store the results in a new column named 'Deck'. \ntest['Deck'] = test['Cabin'].map(set_deck)","b2324f36":"test.head()","a6b8a02f":"# load pipeline\npreprocessor = joblib.load('..\/input\/ek-titanic-preprocessor-and-rf-model\/titanic_preprocessor_01.joblib')","ae175269":"# Create a list of numberical feature names: 'Age', 'FamSize', 'Fare'\nnum_features = ['Age', 'FamSize', 'Fare']\n# Create a list of categorical feature names: 'Sex', 'Pclass', 'Deck', 'Embarked'\ncat_features = ['Sex', 'Pclass', 'Deck', 'Embarked']\n# Combine the two previous lists into one list named 'features'\nfeatures = num_features + cat_features\n\n# Apply the preprocessor to the test data\nX_test = preprocessor.transform(test[features])\n\n# Print test shape, to ensure matches model\nprint('X_train shape:', X_test.shape)","3739b340":"# load model\nmodel = joblib.load('..\/input\/ek-titanic-preprocessor-and-rf-model\/titanic_model_01.joblib')","32fc70e3":"# make predictions using model\ny_pred = model.predict(X_test)","0a33eb9d":"# write to submission\nsubmission = pd.read_csv('..\/input\/titanic\/gender_submission.csv')\n# view first few rows\nsubmission.head()","74887549":"# add predictions to file\nsubmission['Survived'] = y_pred\n# view first few rows\nsubmission.head()","54f1e228":"# export to csv file\nsubmission.to_csv('submission.csv', index=False, header=True)","cc4fbcd9":"# Import Statements","e2cf278e":"# Titanic Dataset","e5d029db":"# Check for Missing Values","82feaacc":"# Model Predictions","9e82c294":"# Submission","5826a681":"# Preprocessing","d4710e57":"# Load Test Data"}}