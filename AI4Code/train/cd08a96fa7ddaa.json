{"cell_type":{"3fbf8ab6":"code","15be8c6c":"code","c330e202":"code","395247f8":"code","2b8c813e":"code","a1771457":"code","a3d6dda6":"code","37a8ede8":"code","95ab3db9":"code","b3e3dd01":"code","38503fad":"code","b5d72005":"code","cc833bde":"code","4e29e14e":"code","af15d39a":"code","2a79ee0a":"code","8ad40ac5":"code","10fed026":"code","7670f971":"code","9be86ab0":"code","5f5e890e":"code","054801b5":"code","8cd6515f":"code","68a6fe29":"code","6979a672":"code","e6ec0c90":"code","cbe871bd":"code","39529052":"code","b4766ff8":"code","fdde0836":"code","3a397770":"code","ddd2a28e":"code","928283b2":"code","9b31c907":"code","79511059":"code","be4140f8":"code","4966a2ad":"code","10a1c6e8":"code","d680d144":"code","c0b57318":"code","46e2f757":"code","838ee133":"code","3c83cf33":"code","15070b09":"code","94cfdc92":"code","c5311b8a":"code","cb61a980":"code","4dc26c05":"code","293b3f11":"code","87612006":"code","2a5607bb":"code","3429a329":"code","3d792651":"markdown","57e25421":"markdown","fb1d8017":"markdown","2a4a0e75":"markdown","39c0472c":"markdown","9612815a":"markdown","e40f5274":"markdown","96506540":"markdown","ae532149":"markdown","df8ae8ab":"markdown","0b0588d2":"markdown","5c9572ba":"markdown"},"source":{"3fbf8ab6":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","15be8c6c":"data=pd.read_csv('..\/input\/heart.csv',delimiter=',')","c330e202":"data.head()","395247f8":"data.describe()","2b8c813e":"data.isnull().sum()","a1771457":"data.info()","a3d6dda6":"plt.figure(figsize=(10,8))\nsns.heatmap(data.corr(),annot=True,fmt='.2g',vmax=0.4)\nplt.tight_layout()","37a8ede8":"sns.pairplot(data,hue='target')","95ab3db9":"sns.countplot(x='target',data=data)\nplt.xlabel('0:No heart disease,1:heart disease')","b3e3dd01":"plt.figure(figsize=(10,8))\nsns.countplot(x='age',hue='target',data=data)\nplt.legend(['No Heart Disease','Heart Disease '])","38503fad":"sns.countplot(x='sex',data=data)\nplt.xlabel('0:Female,1:Male')","b5d72005":"data['sex'].value_counts()","cc833bde":"fig,axes=plt.subplots(3,2,figsize=(10,8))\na=['cp','fbs','restecg','exang','slope','ca']\nfor i,ax in enumerate(axes.flat):\n    sns.countplot(x=data[a[i]],data=data,hue='target',ax=ax)\n    ax.legend(['Not Disease','Disease'])\n    plt.tight_layout()","4e29e14e":"sns.scatterplot(x='trestbps',y='thalach',data=data,hue='target')","af15d39a":"sns.scatterplot(x='chol',y='thalach',data=data,hue='target')","2a79ee0a":"plt.scatter(x=data.age[data.target==1],y=data.thalach[data.target==1],c='red')\nplt.scatter(x=data.age[data.target==0],y=data.thalach[data.target==0],c='green')\nplt.legend(['Disease','Not Disease'])\nplt.xlabel('Age')\nplt.ylabel('Maximum heart rate achieved')","8ad40ac5":"from sklearn.model_selection import train_test_split,cross_val_score,KFold,GridSearchCV\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.preprocessing import StandardScaler\n\nfrom sklearn.metrics import accuracy_score,classification_report,confusion_matrix\nfrom sklearn.metrics  import roc_curve,roc_auc_score","10fed026":"X=data.drop('target',axis=1)\ny=data['target']","7670f971":"s=StandardScaler()\nX=s.fit_transform(X)","9be86ab0":"X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=2)","5f5e890e":"X_train.shape","054801b5":"X_test.shape","8cd6515f":"y_train.shape","68a6fe29":"y_test.shape","6979a672":"lr=LogisticRegression()\nlr.fit(X_train,y_train)\ny_predl=lr.predict(X_test)\nprobs=lr.predict_proba(X_test)\nprob=probs[:,1]\nauc=roc_auc_score(y_test,prob)\nprint('AUC for Logistic Regression is',auc)\nfpr,tpr,thresholds=roc_curve(y_test,prob)\nplt.plot([0,1],[0,1],linestyle='--')\nplt.plot(fpr,tpr,marker='.')","e6ec0c90":"print('Accuracy of training set',lr.score(X_train,y_train)*100)","cbe871bd":"print('Accuracy of testing set',accuracy_score(y_test,y_predl)*100)","39529052":"cm=confusion_matrix(y_test,y_predl)\nsns.heatmap(cm,annot=True)","b4766ff8":"print('Classification Report',classification_report(y_test,y_predl))","fdde0836":"sv=SVC()\nsv.fit(X_train,y_train)\ny_preds=sv.predict(X_test)","3a397770":"print('Accuracy of training set',sv.score(X_train,y_train)*100)","ddd2a28e":"print('Accuracy of testing set',accuracy_score(y_test,y_preds)*100)","928283b2":"cm=confusion_matrix(y_test,y_preds)\nsns.heatmap(cm,annot=True)","9b31c907":"print('Classification Report',classification_report(y_test,y_preds))","79511059":"param=[{'C':[0.02,0.03,0.001,0.002,0.003,0.004,0.005,0.006,1],'kernel':['linear']}]\ngrid_search=GridSearchCV(sv,param_grid=param,scoring='accuracy',cv=10,n_jobs=-1)\ngrid_search.fit(X_train,y_train)\ny_preds1=grid_search.predict(X_test)\n\nprint('Best score',grid_search.best_score_)\nprint(grid_search.best_params_)\nprint('Accuracy of training set',grid_search.score(X_train,y_train)*100)\nprint('Accuracy of testing set',accuracy_score(y_test,y_preds1)*100)\n\nprint('Classification Report',classification_report(y_test,y_preds1))\n\n\n\n","be4140f8":"cm=confusion_matrix(y_test,y_preds1)\nsns.heatmap(cm,annot=True)\n#xlabel - Predicted value, ylabel-True value\nplt.title('Confusion Matrix')\nplt.xlabel('Predicted')\nplt.ylabel('Actual')","4966a2ad":"sv1=SVC(C=0.03,kernel='linear',random_state=2,probability=True)\nsv1.fit(X_train,y_train)\nprobs=sv1.predict_proba(X_test)\nprobs","10a1c6e8":"#keep only probabilities of positive outcomes\nprob=probs[:,1]\nauc=roc_auc_score(y_test,prob)\nprint('AUC Score is ',auc)","d680d144":"fpr,tpr,thresholds=roc_curve(y_test,prob)\nplt.plot([0,1],[0,1],linestyle='--')\nplt.plot(fpr,tpr,marker='.')","c0b57318":"rf=RandomForestClassifier()\nrf.fit(X_train,y_train)\ny_predr=rf.predict(X_test)","46e2f757":"print('Accuracy of training set',rf.score(X_train,y_train))","838ee133":"print('Accuracy of testing set',accuracy_score(y_test,y_predr)*100)","3c83cf33":"cm=confusion_matrix(y_test,y_predr)\nsns.heatmap(cm,annot=True)","15070b09":"print('Classification Report',classification_report(y_test,y_predr))","94cfdc92":"kn=KNeighborsClassifier()\nkn.fit(X_train,y_train)\ny_predk=kn.predict(X_test)\n\n","c5311b8a":"print('Accuracy of training set',kn.score(X_train,y_train))","cb61a980":"print('Accuracy of testing set',accuracy_score(y_test,y_predk)*100)","4dc26c05":"cm=confusion_matrix(y_test,y_predk)\nsns.heatmap(cm,annot=True)","293b3f11":"print('Classification Report',classification_report(y_test,y_predk))","87612006":"#Using Grid search\n\nparam={'n_neighbors':np.arange(1,10)}\ngrid=GridSearchCV(kn,param_grid=param,scoring='accuracy',cv=10,n_jobs=-1)\ngrid.fit(X_train,y_train)\ny_predk1=grid.predict(X_test)\n\nprint('Best score',grid.best_score_)\nprint('Best Parameter',grid.best_params_)\nprint('Accuracy of training set',grid.score(X_train,y_train)*100)\nprint('Accuracy of testing set',accuracy_score(y_test,y_predk1)*100)\n\nprint('Classification Report',classification_report(y_test,y_predk1))\nprint('Confusion Matrix',confusion_matrix(y_test,y_predk1))","2a5607bb":"kn1=KNeighborsClassifier(n_neighbors=4)\nkn1.fit(X_train,y_train)\nprobs=kn1.predict_proba(X_test)\n#Only probabilities of positive outcome\nprob=probs[:,1]\nauc=roc_auc_score(y_test,prob)\nprint('AUC Score for KNN is',auc)","3429a329":"fpr,tpr,thresholds=roc_curve(y_test,prob)\nplt.plot([0,1],[0,1],linestyle='--')\nplt.plot(fpr,tpr,marker='.')","3d792651":"Using Grid search method","57e25421":"# Machine Learning","fb1d8017":"ROC - AUC Curve","2a4a0e75":"##### Conclusion :","39c0472c":"## Random Forest\n","9612815a":"AUC - ROC Curve","e40f5274":"Visualization","96506540":"## SVM","ae532149":"AUC ranges in value from 0 to 1. A model whose predictions are 100% wrong has an AUC of 0.0; one whose predictions are 100% correct has an AUC of 1.0.","df8ae8ab":"## KNN","0b0588d2":"## Logistic Regression\n","5c9572ba":"Logistic Regression and Linear SVM with C=0.03 is the best model in this case."}}