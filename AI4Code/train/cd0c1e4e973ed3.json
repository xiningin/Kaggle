{"cell_type":{"2a0734c1":"code","4b493cca":"code","4777fc2e":"code","8915e4c1":"code","7464678d":"code","19c59dbc":"code","9033ed1d":"code","ac1ec814":"code","0a30a039":"code","7df93da8":"code","46d3823f":"code","ecad975b":"code","34d0a11b":"code","27e04895":"markdown","79e26021":"markdown","46b174b1":"markdown","ef5ceec5":"markdown","e9506e52":"markdown"},"source":{"2a0734c1":"filename_train = '..\/input\/tabular-playground-series-mar-2021\/train.csv'\nfilename_test = '..\/input\/tabular-playground-series-mar-2021\/test.csv'","4b493cca":"import pandas as pd\n\ndf_train = pd.read_csv(filename_train, index_col='id')\ndf_train","4777fc2e":"df_test = pd.read_csv(filename_test, index_col='id')\ndf_test","8915e4c1":"X_train = df_train.drop('target', axis=1)\nX_train","7464678d":"y_train = df_train['target']\ny_train","19c59dbc":"X_test = df_test.copy()\nX_test","9033ed1d":"def to_category(df):\n    for col, type in zip(df.columns, df.dtypes):\n        if type == object:\n            df[col] = df[col].astype('category')\n    \n    return df","ac1ec814":"X_train = to_category(X_train)\nX_test  = to_category(X_test)","0a30a039":"import numpy as np\nimport lightgbm as lgb\nfrom sklearn.metrics import accuracy_score\n\ndef acc_score(preds, data):\n    y_true = data.get_label()\n    y_pred = np.where(preds > 0.5, 1, 0)\n    acc = accuracy_score(y_true, y_pred)\n    return 'acc', acc, True\n\nlgb_train = lgb.Dataset(X_train, y_train)\n\nparams = {\n    'objective': 'binary', \n    'metric': 'auc',\n    'force_row_wise': True,\n}\n\ncv_rslt = lgb.cv(params, \n                 lgb_train, \n                 nfold=5, \n                 num_boost_round=10000, \n                 early_stopping_rounds=20,\n                 metrics='auc',\n                 return_cvbooster=True)","7df93da8":"cv_rslt['auc-mean'][-1]","46d3823f":"import scipy\n\ncvbooster = cv_rslt['cvbooster']\ny_pred = np.mean(cvbooster.predict(X_test, num_iteration=cvbooster.best_iteration), axis=0)\ny_pred","ecad975b":"answer = pd.concat([df_test.index.to_series().reset_index(drop=True), \n                    pd.Series(y_pred, name='target')], axis=1)\nanswer","34d0a11b":"filename_output = '.\/submission.csv'\nanswer.to_csv(filename_output, index=False)","27e04895":"# Change object-type to category-type","79e26021":"# Load data","46b174b1":"# Modeling","ef5ceec5":"# Prediction","e9506e52":"# Get explanatory and objective variables"}}