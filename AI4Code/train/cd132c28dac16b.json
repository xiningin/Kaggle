{"cell_type":{"7c18c312":"code","3a8ce566":"code","4a83dbfe":"code","4603818a":"code","72b55bdb":"code","2049baf7":"code","d5878251":"code","b7398f35":"code","02ccee5b":"code","04f983fe":"code","f3250e5a":"code","1d0c09fb":"code","5a6492a9":"code","fd0912b2":"code","3267dc9d":"code","21333a07":"code","1763720e":"code","7ac9979c":"code","c4fcc8e5":"markdown","d4d6a003":"markdown","4b2a4411":"markdown","a4201517":"markdown","6c70a724":"markdown","01e88ff8":"markdown","316d47ed":"markdown","7e9a8294":"markdown","42e879f6":"markdown","caa2e024":"markdown","5c88b1b1":"markdown","f92cbe63":"markdown","ff4fef1a":"markdown","7dcda5e4":"markdown","3230cf2d":"markdown","cc325661":"markdown","78453e4a":"markdown","9013e39d":"markdown"},"source":{"7c18c312":"#Import library\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline","3a8ce566":"diabetes = pd.read_csv('..\/input\/pima-indians-diabetes-database\/diabetes.csv')\nprint(diabetes.columns)","4a83dbfe":"diabetes.head()","4603818a":"print(\"dimension of diabetes data: {}\".format(diabetes.shape))\n#The diabetes dataset consists of 768 data points, with 9 features","72b55bdb":"print(diabetes.groupby('Outcome').size())","2049baf7":"import seaborn as sns\n\nsns.countplot(diabetes['Outcome'],label=\"Count\")\n#data has more No diabetic data as compared to diabetic data which would give a biased prediction towards no diabetic","d5878251":"diabetes.info()","b7398f35":"diabetes.describe().transpose()","02ccee5b":"# Few Insights\n# Min blood pressure of 0 is invalid, so impute it with appropriate values. Same with few other variables like BMI\n# Mean and Median values of Insuline is very different\n# Insuline has very high Standard deviation\n# We will ignore all these issues for now to concentrate more on Model","04f983fe":"colormap = plt.cm.viridis # Color range to be used in heatmap\nplt.figure(figsize=(15,15))\nplt.title('Pearson Correlation of attributes', y=1.05, size=19)\nsns.heatmap(diabetes.corr(),linewidths=0.1,vmax=1.0, \n            square=True, cmap=colormap, linecolor='white', annot=True)\n#There is no strong correlation between any two variables.\n#There is no strong correlation between any independent variable and class variable.","f3250e5a":"spd = pd.plotting.scatter_matrix(diabetes, figsize=(20,20), diagonal=\"kde\")","1d0c09fb":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(diabetes.loc[:, diabetes.columns != 'Outcome'], diabetes['Outcome'], stratify=diabetes['Outcome'], random_state=11)","5a6492a9":"X_train.shape","fd0912b2":"from sklearn.svm import SVC\n\nsvc = SVC()\nsvc.fit(X_train, y_train)\n\nprint(\"Accuracy on training set: {:.2f}\".format(svc.score(X_train, y_train)))\nprint(\"Accuracy on test set: {:.2f}\".format(svc.score(X_test, y_test)))","3267dc9d":"#The model overfits substantially with a perfect score on the training set and only 65% accuracy on the test set.\n\n#SVM requires all the features to be on a similar scale. We will need to rescale our data that all the features are approximately\n#on the same scale and than see the performance","21333a07":"from sklearn.preprocessing import MinMaxScaler\n\nscaler = MinMaxScaler()\nX_train_scaled = scaler.fit_transform(X_train)\nX_test_scaled = scaler.fit_transform(X_test)","1763720e":"svc = SVC()\nsvc.fit(X_train_scaled, y_train)\n\nprint(\"Accuracy on training set: {:.2f}\".format(svc.score(X_train_scaled, y_train)))\nprint(\"Accuracy on test set: {:.2f}\".format(svc.score(X_test_scaled, y_test)))","7ac9979c":"svc = SVC(C=1000)\nsvc.fit(X_train_scaled, y_train)\n\nprint(\"Accuracy on training set: {:.3f}\".format(\n    svc.score(X_train_scaled, y_train)))\nprint(\"Accuracy on test set: {:.3f}\".format(svc.score(X_test_scaled, y_test)))","c4fcc8e5":"# 11. Fit SVM Model on Scale data and give your observation","d4d6a003":"# 10. Scale the data points using MinMaxScaler","4b2a4411":"# 7. Plot a scatter Matrix","a4201517":"# Here, increasing C allows us to improve the model, resulting in 81.2% train set accuracy.","6c70a724":"Scaling the data made a huge difference.But now we are actually in an underfitting regime, where training and test set \nperformance are quite similar but less close to 100% accuracy.\nFrom here, we can try increasing either C or gamma to fit a more complex model.","01e88ff8":"# 12. Try improving the model accuracy using C=1000","316d47ed":"# Can you build a machine learning model to accurately predict whether or not the patients in the dataset have diabetes or not?","7e9a8294":"# 9. Train Support Vector Machine Model","42e879f6":"# Support Vector Machines - SVM","caa2e024":"# 6. Do correlation analysis and bivariate viualization with Insights","5c88b1b1":"# Context\nThis dataset is originally from the National Institute of Diabetes and Digestive and Kidney Diseases. The objective of the \ndataset is to diagnostically predict whether or not a patient has diabetes, based on certain diagnostic measurements included in \nthe dataset. Several constraints were placed on the selection of these instances from a larger database. In particular, all \npatients here are females at least 21 years old of Pima Indian heritage.","f92cbe63":"# 5. Check data distribution using summary statistics and provide your findings(Insights)","ff4fef1a":"# 8. Do train and test split with stratify sampling on Outcome variable to maintain the distribution of dependent variable","7dcda5e4":"# 3. Check distribution of dependent variable, Outcome and plot it","3230cf2d":"# Content\nThe datasets consists of several medical predictor variables and one target variable, Outcome. Predictor variables includes the \nnumber of pregnancies the patient has had, their BMI, insulin level, age, and so on.","cc325661":"# 1. Import Libraries and load the dataset","78453e4a":"# 2. Check dimension of dataset","9013e39d":"# 4. Out of 768 data points, 500 are labeled as 0 and 268 as 1.\nOutcome 0 means No diabetes, outcome 1 means diabetes, Give a countplot"}}