{"cell_type":{"feaa8cf2":"code","e36fe0e1":"code","d7a78ba0":"code","34087f2a":"code","9d6b29bf":"code","cb43160a":"code","9e291839":"code","6405c3aa":"code","77d8992c":"code","85fff00f":"code","ee625713":"code","a0359c70":"code","d19d158b":"code","8ff628b0":"code","6baeb74e":"code","eebd1006":"code","eb6aa0a2":"code","d59ea74f":"code","593d184e":"code","5a7bb4fb":"code","896993c0":"code","fda9bb1c":"code","bd88e4bf":"code","3c5cea12":"code","1fb6c9e4":"code","cd7a3e0a":"code","adccb99b":"code","d8e6a5a3":"code","93a77ea4":"code","006d342d":"code","589fc219":"code","06c555a8":"code","4306cfc5":"code","230c92ff":"code","e05b3c77":"code","7dfa9e68":"code","7305d6d3":"code","942d0c07":"code","e2478e52":"code","2242be76":"code","ac75104a":"code","d88764fc":"code","f0d4b374":"code","a02ef95d":"code","21805b6c":"code","1d295ef8":"code","61ff30db":"code","0c35130c":"code","283c2e04":"markdown","c53f1b3a":"markdown","68ed1eba":"markdown","47172230":"markdown","ee1aee0e":"markdown","9f71a8ef":"markdown","b326e9da":"markdown","32bae9f0":"markdown","b990331a":"markdown","fd0b6e5a":"markdown","16fbc529":"markdown","5aa247c1":"markdown","9f3b0484":"markdown","b5604225":"markdown","a75228c2":"markdown","2868bfa1":"markdown","1dddc878":"markdown","27fcdc83":"markdown","c85e9840":"markdown","af538b2d":"markdown","ea03d0fc":"markdown","335c682c":"markdown","e2978823":"markdown","950f4892":"markdown","77807c29":"markdown","52a7e5e4":"markdown","da3959e7":"markdown","b13972c3":"markdown","8fe3db20":"markdown","f86cb498":"markdown","fb174614":"markdown","77315b74":"markdown"},"source":{"feaa8cf2":"#important libraries\nimport numpy as np \nimport pandas as pd","e36fe0e1":"!wget --no-check-certificate \\\n    https:\/\/archive.ics.uci.edu\/ml\/machine-learning-databases\/wine-quality\/winequality-red.csv","d7a78ba0":"df1 = pd.read_csv('\/kaggle\/working\/winequality-red.csv', sep=\";\")","34087f2a":"df1.head()","9d6b29bf":"df1.describe()","cb43160a":"df1.info()","9e291839":"df1.quality.value_counts()","6405c3aa":"pip install pycaret==2.0","77d8992c":"from pycaret.classification import *","85fff00f":"session_1 = setup(df1, target = 'quality', session_id=123, log_experiment=False, experiment_name='wine_q1')","ee625713":"best_model = compare_models(blacklist=['catboost'])","a0359c70":"models()","d19d158b":"#creating random forest model\nrf = create_model('rf')","8ff628b0":"#creating Extra Trees Classifier\net = create_model('et')","6baeb74e":"#light GBM Model\nlgbm = create_model('lightgbm')","eebd1006":"#creating XGB model\nxgboost = create_model('xgboost')","eb6aa0a2":"#Hyper params tuning via tune_model\ntuned_rf = tune_model(rf)","d59ea74f":"tuned_rf","593d184e":"tuned_et = tune_model(et)","5a7bb4fb":"plot_model(rf)","896993c0":"plot_model(tuned_rf)","fda9bb1c":"plot_model(rf, plot = 'boundary')","bd88e4bf":"plot_model(tuned_rf, plot = 'boundary')","3c5cea12":"from imblearn.over_sampling import *\nadasyn1 = ADASYN(sampling_strategy='minority')","1fb6c9e4":"Session_2 = setup(df1, target = 'quality', session_id=177, log_experiment=False, \n                  experiment_name='wine_q2', normalize=True, normalize_method='zscore', \n                  transformation=True, transformation_method = 'quantile', fix_imbalance=True,\n                  fix_imbalance_method= adasyn1)","cd7a3e0a":"best_model1 = compare_models(blacklist=['catboost'], folds=4)","adccb99b":"xgboost_1 = create_model('xgboost')","d8e6a5a3":"et_1 = create_model('et')","93a77ea4":"lgbm_1 = create_model('lightgbm')","006d342d":"gbc_1 = create_model('gbc')","589fc219":"tuned_xgboost1 = tune_model(xgboost_1)","06c555a8":"tuned_lgbm1 = tune_model(lgbm_1)","4306cfc5":"tuned_et1 = tune_model(et_1)","230c92ff":"tuned_gbc1 = tune_model(gbc_1)","e05b3c77":"blend_soft = blend_models(estimator_list = [tuned_lgbm1, tuned_xgboost1, tuned_gbc1, tuned_et1], method = 'soft')","7dfa9e68":"plot_model(blend_soft)","7305d6d3":"stacked_lgbm = stack_models(estimator_list = [tuned_lgbm1, tuned_xgboost1, tuned_gbc1, tuned_et1],\n                           meta_model=lgbm_1)","942d0c07":"plot_model(lgbm_1, plot = 'confusion_matrix')","e2478e52":"plot_model(blend_soft, plot = 'confusion_matrix')","2242be76":"plot_model(blend_soft, plot = 'boundary')","ac75104a":"plot_model(lgbm_1, plot = 'boundary')","d88764fc":"plot_model(blend_soft, plot = 'pr')","f0d4b374":"plot_model(lgbm_1, plot = 'pr')","a02ef95d":"plot_model(blend_soft, plot = 'class_report')","21805b6c":"plot_model(lgbm_1, plot = 'class_report')","1d295ef8":"plot_model(blend_soft, plot = 'error')","61ff30db":"plot_model(lgbm_1, plot = 'error')","0c35130c":"plot_model(lgbm_1, plot = 'dimension')","283c2e04":"**installing the latest version of PyCaret**","c53f1b3a":"**You can witness how easy is to create model and CV it**\n\n**Similarly, you can tune your model with best hyper params with just single line of code, isn't it amazing**","68ed1eba":"**compare_model(): This function train all the models available in the model library and scores them.**\n\n**I blacklisted 'catboost' as it was taking much time in k-folds, you can test if it helps in accuracy and other metrics**","47172230":"**wget: helps to retrieves content from web servers**","ee1aee0e":"### **This function creates a Soft Voting(Majority Rule classifier) for the selected estimators in the model**","9f71a8ef":"**Since Problem is classification, you can read about other options here: [Modules](https:\/\/pycaret.org\/modules\/)**","b326e9da":"### **Since PyCaret 2.0 is recently launched, i plan to work with it and see if this is as amazing as it is hyped. To be honest i found it wonderful, they way it has reduced the work for data scientists and provide low code model to automate most of the repetition work is marvelous. Let start and see for yourself how it can save precious time for users.**","32bae9f0":"### Visuals in multpiple dimensions","b990331a":"### **Here i have worked and tweaked some of the functions of the pipeline and try to balance the imbalance classes**","fd0b6e5a":"## 1. Importing Dataset and PyCaret 2.0","16fbc529":"**models() provide list of models in library and their id that can be used in functions**","5aa247c1":"### **This is an interesting way of seeing how our model create boundry and how it fits the space of features, below you can see our model is overfit**","9f3b0484":"## 3. Oversampling to balance the classes","b5604225":"### **creating 4 best model from default setup output and tuning them to see improvements**","a75228c2":"### **Plotting ROC for initial\/basic model**","2868bfa1":"**You can several of the func are now shahed green because i will be envolving them in pipeline**","1dddc878":"**you can complete details about all functions here [1](https:\/\/pycaret.org\/classification\/)**","27fcdc83":"### **See, how we can play and tune our models within just few lines of code (given the knowlegde of models, math and paramters working) this will help automate most of the hectic work of data scientists.**","c85e9840":"**Check the ROC Curves w.r.t to default setup and check improvements**","af538b2d":"### **<span style=\"color:green\">If you like this notebook and able to understand something out of it. pls Upvote :)<\/span>**","ea03d0fc":"**The use case is simple you have to setup a preprocessing pipeline with 'setup' module, select the target and name your experiment.**\n\n**you can specify a session_id, if you didn't by default a random seed is generated and returned in the Information grid. The unique number is then distributed as a seed in all functions used during the experiment. This can be used for later reproducibility of the entire experiment.**","335c682c":"# <span style=\"color:blue\">Implementing PyCaret 2.0 on Wine Quality Dataset (Highly Imbalance Classes Problem)<\/span>","e2978823":"**Thanks for checking this notebook, you can contact me here for queries or at [LinkedIn](https:\/\/www.linkedin.com\/in\/muhammad-saad-31740060\/)**","950f4892":"Checking Presicion recall curves","77807c29":"## 2. Using Default Setup of PyCaret 2.0","52a7e5e4":"**And you can see the params of your best model as well**","da3959e7":"**you can see for yourself how imbalance the classes are, target quality for class 4,8,3 are negligible as compared to 5,6,7. This will surely impact the model performace on minority classes and introduce bias**","b13972c3":"### **I've selected Wine Quality dataset due to its highly imbalance classes which is a key problem in dataset for incuring bias.**","8fe3db20":"**importing wine quality data from UCI ML repo via wget**","f86cb498":"### **Now Comparing best tuned model with blended model**","fb174614":"### **Plotting ROC for hyper parameters tuned model**","77315b74":"### **Do you see the difference in boundries of models (normal and tuned)**"}}