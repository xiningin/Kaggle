{"cell_type":{"2ace6dbe":"code","c753afdb":"code","639ad7e6":"code","34c9deea":"code","1a421c62":"code","03651837":"code","ee5b5836":"code","32ef9d0c":"code","7eb88b8d":"code","05c9cc0c":"code","a2a53a80":"code","908b89ae":"code","40409cf7":"code","6e0e8424":"code","faf88dae":"markdown","0b072fc4":"markdown","a8420505":"markdown","3da7b7ce":"markdown","e76be0c7":"markdown","380732a7":"markdown"},"source":{"2ace6dbe":"\nimport numpy as np\nimport pandas as pd\nimport time","c753afdb":"#Create random variable X,y\nN=10000\nnp.random.seed(2020)\nX = np.random.normal(10,10,[N,3])\nX = np.c_[np.ones(N),X] # first column is ones\n#print(X)\ne = np.random.normal(0,10,N)\ny = 5*X[:,0] - 3*X[:,1] + 1*X[:,2] + 0.1*X[:,3]+ e","639ad7e6":"#OLS algorithm\nstart = time.time()\nbeta = np.linalg.inv(X.T@X) @ X.T @ y # @ means matrix multiplication\nprint(time.time()-start) # consuming time","34c9deea":"print(beta) #beta 0 to 3","1a421c62":"#yhat = X[:,0]*beta[0] + X[:,1]*beta[1] + X[:,2]*beta[2] + X[:,3]*beta[3]\nyhat = X @ beta","03651837":"SSR = sum((yhat-np.mean(y))**2)\nSSE = sum((y-yhat)**2)\nSST = sum((y-np.mean(y))**2)","ee5b5836":"#R-square\nSSR\/SST","32ef9d0c":"#F-value\nk=3 # the number of parameters is 3\n(SSR\/k)\/(SSE\/(N-k-1))","7eb88b8d":"sigma2 = ((y-yhat).T @ (y-yhat))\/N #sigma square","05c9cc0c":"for i in range(4):\n    print(beta[i]\/((sigma2*np.linalg.inv((X.T @ X))[i,i])**(1\/2)))","a2a53a80":"import statsmodels.api as sm","908b89ae":"lm = sm.OLS(y,X)","40409cf7":"start = time.time()\nlm = lm.fit()\nprint(time.time()-start)","6e0e8424":"lm.summary()","faf88dae":"Total spending time of two method is similar. And R-squared, t-value,..etc is almost same.(They are not absolutely same because of calculation error)","0b072fc4":"\n### Linear Regression by OLS\nFinding $\\beta$ and calculating F-value(about model), t-value(about parameter such as $\\beta_{1}$) by numpy","a8420505":"### About F,t-value\n[Linear_regression_pdf](http:\/\/mezeylab.cb.bscb.cornell.edu\/labmembers\/documents\/supplement%205%20-%20multiple%20regression.pdf)","3da7b7ce":"### OLS using python library","e76be0c7":"[What is SST,SSE,SSR?](https:\/\/stats.stackexchange.com\/questions\/207841\/why-is-sst-sse-ssr-one-variable-linear-regression)","380732a7":"$y = X\\beta + e$, minimizing sum of $e^2$ is equal to minimizing $(y^T-\\beta ^T X^T)(y-X\\beta)$. So $$\\hat\\beta = (XX^T)^{-1}Xy$$ by differential"}}