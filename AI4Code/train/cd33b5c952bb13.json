{"cell_type":{"b1c26875":"code","8db494da":"code","e340b02e":"code","546d00fe":"code","6723d279":"code","03e02d6a":"code","f43ca67e":"code","3caa8f71":"code","301b9dd2":"code","a8812ae9":"code","a59df865":"code","e3c21d13":"code","4462c3bf":"code","b3092d8f":"code","13a0a477":"code","df553973":"code","2e7b3feb":"code","c6dbc707":"code","287c71be":"code","a2a8dbe4":"code","ad372b4f":"code","24ac2acc":"markdown"},"source":{"b1c26875":"import warnings\nwarnings.filterwarnings(\"ignore\")\nimport pandas as pd\nimport numpy as np\nfrom sklearn.feature_selection import SelectFromModel\nfrom sklearn.svm import LinearSVC\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.feature_selection import RFE\nfrom warnings import simplefilter\nsimplefilter(action='ignore', category=FutureWarning)\nimport xgboost as xgb","8db494da":"df = pd.read_csv(\"..\/input\/1st-feature-selection-lasso-xgboost\/new_df.csv\")\ndf","e340b02e":"#new_df = df.drop(['sum_visitors'], axis=1)\n#new_df","546d00fe":"df_col = df.describe()\ndf_col = df_col.drop(['sum_visitors'], axis=1)\n#(include ='int64')\ndf_col.columns","6723d279":"varSel = pd.DataFrame({'Variable': df_col.columns})\nvarSel","03e02d6a":"nm = df_col.columns\nnm = nm.append(pd.Index(['sum_visitors']))\nnm","f43ca67e":"df = df[nm].copy()\ndf.head()","3caa8f71":"X = df.iloc[:,:-1]\nX.head()","301b9dd2":"y = df.iloc[:,-1:]\ny.head()","a8812ae9":"### Variable Selection using SVM classification","a59df865":"svmmod = LinearSVC(C=0.01, penalty=\"l1\",dual=False).fit(X, y.values.ravel())","e3c21d13":"model = SelectFromModel(svmmod, prefit=True)\nmodel.get_support()","4462c3bf":"varSel['SVM'] = model.get_support()\n#.astype('int64')\nvarSel","b3092d8f":"varSel['Sum'] = np.sum(varSel,axis=1)\nvarSel","13a0a477":"varSel.groupby('Sum')['Variable'].count()","df553973":"# We can now decide a threshold for selecting our variables!","2e7b3feb":"varSel[varSel['Sum']>=1]","c6dbc707":"variables = varSel[varSel['Sum']>=1].iloc[:, [0]]\nvariables","287c71be":"variables_to_columns = variables.transpose().iloc[:].head()\ndf_variables_to_columns = pd.DataFrame(variables_to_columns)\nsum_visitors = ['sum_visitors']\ndf_variables_to_columns['sum_visitors'] = sum_visitors\ndf_variables_to_columns.to_csv('second_variables_data.csv',index = False)\ndf_variables_to_columns","a2a8dbe4":"top_columns = pd.read_csv(\".\/second_variables_data.csv\",header = 1).columns\ntop_columns","ad372b4f":"df_After_Feature_Selection = pd.DataFrame(df[top_columns])\ndf_After_Feature_Selection.to_csv(\".\/second_Feature_Selection.csv\",index = False)\ndf_After_Feature_Selection","24ac2acc":"### Summarization and Selection of Variables \n"}}