{"cell_type":{"baca6903":"code","53d794db":"code","e6cda49e":"code","0ba6c1ce":"code","a15d9752":"code","040a134f":"code","e6031afd":"code","fce5291c":"code","484de5d7":"code","9fd06d4c":"code","6b3caeb0":"code","7c487e26":"markdown","e0603e04":"markdown","acce59cd":"markdown","13f32863":"markdown","6f1a0d6e":"markdown","c95f2ef2":"markdown","503aaf6c":"markdown","9ca8c6f7":"markdown"},"source":{"baca6903":"!pip install evalml","53d794db":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import MinMaxScaler\nimport warnings\nwarnings.filterwarnings(action='ignore')\n\n# import evalml\n# from evalml import AutoMLSearch","e6cda49e":"train = pd.read_csv('..\/input\/tabular-playground-series-may-2021\/train.csv')\nX = train.iloc[:, 1:-1]\ny = train.iloc[:, -1]","0ba6c1ce":"mc = MinMaxScaler()\nmc.fit(X)\nX = mc.transform(X)","a15d9752":"# X_train, X_test, y_train, y_test = evalml.preprocessing.split_data(X, y, problem_type='multiclass', test_size=.4)\n\nautoml = AutoMLSearch(X_train=X, y_train=y, problem_type=\"multiclass\", objective=\"log loss multiclass\", ensembling=True)\nautoml.search()\n\nbest_pipeline = automl.best_pipeline\n\n# best_pipeline.score(X_test, y_test, objectives = ['log loss multiclass'])","040a134f":"test = pd.read_csv('..\/input\/tabular-playground-series-may-2021\/test.csv')\ntest_set = test.iloc[:, 1:]\ntest_set = mc.transform(test_set)\npred = best_pipeline.predict_proba(test_set)","e6031afd":"pred = pred.df\npred.index = test.iloc[:,0]","fce5291c":"pred.to_csv('.\/submission.csv')","484de5d7":"import tpot","9fd06d4c":"pipeline_optimizer = tpot.TPOTClassifier(generations=5,population_size=20,cv=5)","6b3caeb0":"pipeline_optimizer.fit(X, y) #fit the pipeline optimizer - can take a long time\npipeline_optimizer.export('tpot_exported_pipeline.py') #export the pipeline - in Python code!","7c487e26":"### 1. Installation EvalML","e0603e04":"### 4.Prediction","acce59cd":"### 5. Etc (TPOT)","13f32863":"![image.png](attachment:78b6761d-9314-4098-852d-b1f44ae1ee01.png)","6f1a0d6e":"### 2.Read data and normalization","c95f2ef2":"### 3.AutoML (Used package : Evalml)","503aaf6c":"![image.png](attachment:edb41ce9-5df7-41f0-b64f-715152df0044.png)\n#### This notebook is TPS-May prediction notebook using Evalml package.\n#### Evalml is kind of AutoML package.","9ca8c6f7":"#### Best pipeline 'log loss multiclass' : 1.132344"}}