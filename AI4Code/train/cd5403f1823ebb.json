{"cell_type":{"d57f28ed":"code","81e12a31":"code","b5daa42d":"code","962e4a55":"code","aa55df93":"code","815b4002":"code","e8efc767":"code","93d3cf5d":"code","1ca08b6d":"code","e4be7119":"code","e88dca68":"code","557df6fb":"code","27048562":"code","f298215f":"code","1dd79f38":"code","423fb708":"code","22ee7838":"code","bf76b952":"code","4b475194":"code","071eecdf":"code","b5487a6a":"code","76b4b936":"code","0fcf31b6":"code","18f26e06":"code","eb5aca64":"code","9dce0516":"code","f976cbd3":"code","dd6d3676":"code","7b730608":"code","e8da3b7f":"markdown","be97843b":"markdown","166af3af":"markdown","a997da74":"markdown","58a9597e":"markdown","ff7fb88b":"markdown","1dc772a1":"markdown","1f1bdec1":"markdown","81512897":"markdown","5b7b9f83":"markdown","05104fdd":"markdown","8d97be07":"markdown","1c3f09d3":"markdown"},"source":{"d57f28ed":"import numpy as np \nimport pandas as pd \nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import OneHotEncoder, LabelEncoder","81e12a31":"df = pd.read_csv(\"\/kaggle\/input\/mushroom-classification\/mushrooms.csv\")\ndf.head()","b5daa42d":"df.describe().T","962e4a55":"df.isna().sum()","aa55df93":"for col in df.columns:\n    print(f\"Column {col} unique values: {df[col].unique()}\")","815b4002":"sns.countplot(x=df['class'])","e8efc767":"df[\"class\"] = df[\"class\"].apply(lambda x: 1 if x == \"e\" else 0)","93d3cf5d":"df.drop(\"class\", axis=1).columns","1ca08b6d":"fig = plt.figure(figsize=(16, 30))\nfor i, col in enumerate(df.columns):\n    plt.subplot(12,2,i+1)\n    sns.countplot(x=df[col])\n    plt.tight_layout()\nfig.show()","e4be7119":"plt.figure(figsize=(12, 4))\nsns.countplot(x=df[\"odor\"], hue=df['class']);","e88dca68":"X = df.drop(\"class\", axis=1)\ny = df[\"class\"].values","557df6fb":"from sklearn.model_selection import train_test_split\nXtrain, Xvalid, ytrain, yvalid = train_test_split(X, y, test_size=0.2, random_state=101)","27048562":"one_hot = OneHotEncoder()\nXtrain_onehot = one_hot.fit_transform(Xtrain)\nXvalid_onehot = one_hot.transform(Xvalid)","f298215f":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score, classification_report, plot_confusion_matrix","1dd79f38":"rfc_base = RandomForestClassifier()\nrfc_base.fit(Xtrain_onehot, ytrain)\nbase_preds = rfc_base.predict(Xvalid_onehot)\nacc = accuracy_score(yvalid, base_preds)\nprint(f\"Random Forest accuracy: {acc}\")","423fb708":"pd.DataFrame({\"predictions\":base_preds,\n              \"ytrue\": yvalid})","22ee7838":"print(classification_report(yvalid, base_preds))","bf76b952":"plot_confusion_matrix(rfc_base, Xvalid_onehot, yvalid)","4b475194":"pipe = Pipeline([\n    (\"onehot\", OneHotEncoder()),\n    (\"rfc_base\", RandomForestClassifier())\n])\n\npipe.fit(Xtrain, ytrain)\npipe_preds = pipe.predict(Xvalid)\nacc = accuracy_score(yvalid, pipe_preds)\nprint(f\"Random Forest acc={acc}\")","071eecdf":"for col in X.columns:\n    le = LabelEncoder()\n    Xtrain.loc[:, col] = le.fit_transform(Xtrain[col].values)\n    Xvalid.loc[:, col] = le.transform(Xvalid[col].values)","b5487a6a":"Xtrain","76b4b936":"rfc_le = RandomForestClassifier()\nrfc_le.fit(Xtrain, ytrain)\nle_preds = rfc_le.predict(Xvalid)\nacc = accuracy_score(yvalid, le_preds)\nprint(f\"Random Forest accuracy: {acc}\")","0fcf31b6":"print(classification_report(yvalid, le_preds))","18f26e06":"plot_confusion_matrix(rfc_le, Xvalid, yvalid)","eb5aca64":"feat_imp = pd.DataFrame(rfc_le.feature_importances_, index=Xtrain.columns, columns=[\"feat_imp\"])\nfeat_imp = feat_imp.sort_values(\"feat_imp\", ascending=False)\nfeat_imp.style.background_gradient(\"Blues\")","9dce0516":"X = df.drop(\"class\", axis=1)\ny = df[\"class\"].values\n\nXtrain, Xvalid, ytrain, yvalid = train_test_split(X, y, test_size=0.2, random_state=101)","f976cbd3":"dummy_Xtrain = pd.get_dummies(Xtrain, drop_first=True)\ndummy_Xvalid = pd.get_dummies(Xvalid, drop_first=True)","dd6d3676":"rfc_d = RandomForestClassifier()\nrfc_d.fit(dummy_Xtrain, ytrain)\nd_preds = rfc_d.predict(dummy_Xvalid)\nacc = accuracy_score(yvalid, d_preds)\nprint(f\"Random Forest accuracy: {acc}\")","7b730608":"feat_imp = pd.DataFrame(rfc_d.feature_importances_, index=dummy_Xtrain.columns, columns=[\"feat_imp\"])\nfeat_imp = feat_imp.sort_values(\"feat_imp\", ascending=False)[:20]\nfeat_imp.style.background_gradient(\"Blues\")","e8da3b7f":"Similar method to OneHotEncoding is creating dummy variables, but we don't lose informtion about which features importance in our model. Couple things we need to remember, first dummy trap(i.e multicollinearity) and second course of dimentionality( in huge datasets it is not that easy to use this method in my opinion).","be97843b":"It looks like most of poisnonous mushrooms have no odor. Fresh mushrooms should smell slightly sweet and earthy, but not foul. If they smell fishy or pungent, it's time to toss them.","166af3af":"Our prediction label is well balanced so we don't have to worry about it. For the classification problem we could leave our label as string type as some algorithms can cope with categorical label, but for binary clasification it is better to use boolean values(0, 1). I wiil map edible as 0, and poisonous as 1.","a997da74":"## Mushroom dataset","58a9597e":"### Dummy variables","ff7fb88b":"As we can see our base model achieved 100%, but in this case it is hard to find out which features we most important as onehot produce sparse matrix.","1dc772a1":"### One hot encoding","1f1bdec1":"![](http:\/\/www.woodlandtrust.org.uk\/media\/1997\/fly-agaric-mushroom-close-up-alamy-dhfcm9-ivan-kmit.jpg?center=0.49618320610687022,0.63948497854077258&mode=crop&width=1110&height=624&rnd=132078488660000000)","81512897":"### Seperate our label from features","5b7b9f83":"### Label Encoding","05104fdd":"In this notebook I would like to introduce 3 methods we can use to transform categorical columns into numerical form. This notebook is for people who have just started their journey. For those who code for some time it would be propably to simple.","8d97be07":"All columns are categorical and there are not ordered, so we treat them as nominal. Therefore, we can use one hot encoder, we can create dummy variables or use Label encoder. I will try all techniques and find out which gives us better performance.","1c3f09d3":"### Using pipeline to do the same task"}}