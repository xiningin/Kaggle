{"cell_type":{"04506b4f":"code","c424c8ad":"code","456a3d78":"code","92e25748":"code","f84982ba":"code","a096bba4":"code","8d881be2":"code","ee753f30":"code","e6dba8d2":"code","a211ca44":"code","c99539fb":"code","98eb10a7":"code","5991b30f":"code","008eabaf":"code","f53dc2c2":"code","5d84b5be":"code","083be2b0":"code","42db70ae":"code","d1d088c7":"code","a073bc8c":"code","e817e2b9":"code","8e2a3b56":"code","484d96ef":"code","3953f3ad":"code","1ea644e4":"code","b6cf95a3":"code","9dacc10a":"code","729909a7":"code","40f12f89":"code","31181956":"code","9d032ef9":"code","ee6d65d3":"code","e1ed8a74":"code","d3c284a6":"code","b45ac860":"code","48fe310c":"code","fcf8d93a":"code","0051d5e3":"code","fec67ca0":"code","6e308ba5":"code","0d94a30c":"code","3446e569":"code","682a58c0":"code","e1dd4bb8":"code","4dded810":"code","a7f27581":"code","e0dfffe2":"code","7461129b":"code","978f685e":"code","40a0934c":"code","b42e25bc":"code","e06fb7e2":"code","d8bf430a":"code","4773e9be":"code","029fb29f":"code","a25781a7":"code","aab1558b":"code","daf0ac6e":"code","c0ed197f":"code","0bb857ff":"code","ab5e40ba":"code","d585ba60":"code","dea2dd63":"code","e6ad0924":"code","dbc177c9":"code","2f51283f":"code","2e0cad30":"code","b3ed4b13":"markdown","690b95f3":"markdown","ff7bb836":"markdown","46bd232c":"markdown","7927c6b0":"markdown","dcc56a5a":"markdown","bdf00ff8":"markdown"},"source":{"04506b4f":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","c424c8ad":"Data=pd.read_csv('..\/input\/water-potability\/water_potability.csv')","456a3d78":"Data.head()","92e25748":"Data.info()","f84982ba":"Data.isna().sum()","a096bba4":"Data['ph_na']=Data['ph'].isna()\nData['sulfate_na']=Data['Sulfate'].isna()\nData['Trihalomethanes_na']=Data['Trihalomethanes'].isna()","8d881be2":"Data.head()","ee753f30":"Data['ph']=Data['ph'].fillna(Data['ph'].mean())","e6dba8d2":"Data.head()","a211ca44":"Data['Sulfate']=Data['Sulfate'].fillna(Data['Sulfate'].mean())","c99539fb":"Data.head()","98eb10a7":"Data['Trihalomethanes']=Data['Trihalomethanes'].fillna(Data['Trihalomethanes'].mean())","5991b30f":"Data.head()","008eabaf":"Data.isna().sum()","f53dc2c2":"Data.info()","5d84b5be":"Data.corr()","083be2b0":"x=Data.copy().drop(columns='Potability')","42db70ae":"x","d1d088c7":"y=Data.copy().pop('Potability')","a073bc8c":"y","e817e2b9":"from sklearn.preprocessing import LabelEncoder\n\nobje_le=LabelEncoder()\n\nx['ph_na']=obje_le.fit_transform(x['ph_na'])\nx['sulfate_na']=obje_le.transform(x['sulfate_na'])\nx['Trihalomethanes_na']=obje_le.transform(x['Trihalomethanes_na'])","8e2a3b56":"x.head()","484d96ef":"import statsmodels.api as sm\n\nr=sm.OLS(endog=y,exog=x).fit()\nprint(r.summary())","3953f3ad":"sns.countplot(y)\nplt.show()","1ea644e4":"x.describe()","b6cf95a3":"x.columns[:9]","9dacc10a":"fig,ax =plt.subplots(nrows=3,ncols=3,figsize=(14,12))\na=0\nb=0\nfor i in x.columns[:9]:\n  while a<3:\n    while b<3:\n      ax[a][b].scatter(x=Data[i],y=y)\n      ax[a][b].set_title(i)\n      ax[a][b].set_yticks([0,1])\n      ax[a][b].set_ylabel('Potability')\n      b+=1\n      if b==3:\n        b=0\n        a+=1\n      break\n    break\nplt.show()","729909a7":"x=x.values\ny=y.values","40f12f89":"type(x)","31181956":"type(y)","9d032ef9":"from sklearn.model_selection import train_test_split\n\nx_train,x_test,y_train,y_test=train_test_split(x,y,random_state=0,test_size=0.20)","ee6d65d3":"x_train.shape","e1ed8a74":"y_train.shape","d3c284a6":"x_test.shape","b45ac860":"y_test.shape","48fe310c":"x_train,x_val,y_train,y_val=train_test_split(x_train,y_train,random_state=0,test_size=0.10)","fcf8d93a":"x_train.shape","0051d5e3":"y_train.shape","fec67ca0":"x_val.shape","6e308ba5":"y_val.shape","0d94a30c":"from sklearn.preprocessing import StandardScaler\n\nobje_ss=StandardScaler()\n\nx_train_ss=obje_ss.fit_transform(x_train) \nx_val_ss=obje_ss.transform(x_val)\nx_test_ss=obje_ss.transform(x_test)","3446e569":"x_train_ss.shape","682a58c0":"x_train_ss","e1dd4bb8":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import confusion_matrix,accuracy_score,precision_score,recall_score,f1_score,classification_report\n\nmodel_logistic=LogisticRegression().fit(x_train_ss,y_train)\ny_pred_logistic_val=model_logistic.predict(x_val_ss)\n\nprint('Logisticregression classifcation train ba\u015far\u0131 oran\u0131 %',model_logistic.score(x_train_ss,y_train)*100)\nprint(confusion_matrix(y_val,y_pred_logistic_val))\nprint('Logisticregression classifcation validation ba\u015far\u0131 oran\u0131 %',accuracy_score(y_val,y_pred_logistic_val)*100)\nprint('Logisticregression classifcation validation precision_score %',precision_score(y_val,y_pred_logistic_val)*100)\nprint('Logisticregression classifcation validation recall_score %',recall_score(y_val,y_pred_logistic_val)*100)\nprint('Logisticregression classifcation validation f1_score %',f1_score(y_val,y_pred_logistic_val)*100)\nprint(classification_report(y_val,y_pred_logistic_val))","4dded810":"from sklearn.svm import SVC\n\nmodel_svc=SVC(kernel='poly',degree=4).fit(x_train_ss,y_train)\ny_pred_val_svc=model_svc.predict(x_val_ss)\nprint('svc classifcation train ba\u015far\u0131 oran\u0131 %',model_svc.score(x_train_ss,y_train)*100)\nprint(confusion_matrix(y_val,y_pred_val_svc)) \nprint('svc classifcation validation ba\u015far\u0131 oran\u0131 %',accuracy_score(y_val,y_pred_val_svc)*100)\nprint('SVC classifcation validation precision_score %',precision_score(y_val,y_pred_val_svc)*100)\nprint('SVC classifcation validation recall_score %',recall_score(y_val,y_pred_val_svc)*100)\nprint('SVC classifcation validation f1_score %',f1_score(y_val,y_pred_val_svc)*100)\nprint(classification_report(y_val,y_pred_val_svc))","a7f27581":"from sklearn.ensemble import RandomForestClassifier\n\nmodel_tree=RandomForestClassifier(n_estimators=50,max_depth=60,random_state=0).fit(x_train_ss,y_train)\ny_pred_val_tree=model_tree.predict(x_val_ss)\nprint('tree classifcation train ba\u015far\u0131 oran\u0131 %',model_tree.score(x_train_ss,y_train)*100)\nprint(confusion_matrix(y_val,y_pred_val_tree))\nprint('tree classifcation validation ba\u015far\u0131 oran\u0131 %',accuracy_score(y_val,y_pred_val_tree)*100)\nprint('tree classifcation validation precision_score %',precision_score(y_val,y_pred_val_tree)*100)\nprint('tree classifcation validation recall_score %',recall_score(y_val,y_pred_val_tree)*100)\nprint('tree classifcation validation f1_score %',f1_score(y_val,y_pred_val_tree)*100)\nprint(classification_report(y_val,y_pred_val_tree))","e0dfffe2":"from sklearn.neighbors import KNeighborsClassifier\n\nmodel_knn=KNeighborsClassifier(n_neighbors=5,metric='minkowski').fit(x_train_ss,y_train)\ny_pred_val_knn=model_knn.predict(x_val_ss)\nprint('KNN classifcation train ba\u015far\u0131 oran\u0131 %',model_knn.score(x_train_ss,y_train)*100)\nprint(confusion_matrix(y_val,y_pred_val_knn))\nprint('KNN classifcation validation ba\u015far\u0131 oran\u0131 %',accuracy_score(y_val,y_pred_val_knn)*100)\nprint('KNN classifcation validation precision_score %',precision_score(y_val,y_pred_val_knn)*100)\nprint('KNN classifcation validation recall_score %',recall_score(y_val,y_pred_val_knn)*100)\nprint('KNN classifcation validation f1_score %',f1_score(y_val,y_pred_val_knn)*100)\nprint(classification_report(y_val,y_pred_val_knn))","7461129b":"from sklearn.naive_bayes import BernoulliNB,MultinomialNB\n\nmodel_Bnb=BernoulliNB().fit(x_train_ss,y_train)\ny_pred_val_Bnb=model_Bnb.predict(x_val_ss)\nprint('BernoulliNB classifcation train ba\u015far\u0131 oran\u0131 %',model_Bnb.score(x_train_ss,y_train)*100)\nprint(confusion_matrix(y_val,y_pred_val_Bnb))\nprint('BernoulliNB classifcation validation ba\u015far\u0131 oran\u0131 %',accuracy_score(y_val,y_pred_val_Bnb)*100)\nprint('BernoulliNB classifcation validation precision_score %',precision_score(y_val,y_pred_val_Bnb)*100)\nprint('BernoulliNB classifcation validation recall_score %',recall_score(y_val,y_pred_val_Bnb)*100)\nprint('BernoulliNB classifcation validation f1_score %',f1_score(y_val,y_pred_val_Bnb)*100)\nprint(classification_report(y_val,y_pred_val_Bnb))","978f685e":"model_Mnb=MultinomialNB().fit(x_train,y_train)\ny_pred_val_Mnb=model_Mnb.predict(x_val)\nprint('MultinomialNB classifcation train ba\u015far\u0131 oran\u0131 %',model_Mnb.score(x_train,y_train)*100)\nprint(confusion_matrix(y_val,y_pred_val_Mnb))\nprint('MultinomialNB classifcation validation ba\u015far\u0131 oran\u0131 %',accuracy_score(y_val,y_pred_val_Mnb)*100)\nprint('MultinomialNB classifcation validation precision_score %',precision_score(y_val,y_pred_val_Mnb)*100)\nprint('MultinomialNB classifcation validation recall_score %',recall_score(y_val,y_pred_val_Mnb)*100)\nprint('MultinomialNB classifcation validation f1_score %',f1_score(y_val,y_pred_val_Mnb)*100)\nprint(classification_report(y_val,y_pred_val_Mnb))","40a0934c":"import xgboost as xgb\n\nmodel_xgb=xgb.XGBClassifier(objective='binary:hinge',max_depth=5,learning_rate=1).fit(x_train_ss,y_train)\ny_pred_val_xgb=model_xgb.predict(x_val_ss)\nprint('XGB classifcation train ba\u015far\u0131 oran\u0131 %',model_xgb.score(x_train_ss,y_train)*100)\nprint(confusion_matrix(y_val,y_pred_val_xgb))\nprint(classification_report(y_val,y_pred_val_xgb))","b42e25bc":"from sklearn.ensemble import AdaBoostClassifier\n\nmodel_adaboost=AdaBoostClassifier(n_estimators=100,learning_rate=1.8).fit(x_train_ss,y_train)\ny_pred_val_adaboost=model_adaboost.predict(x_val_ss)\nprint('Adaboost classifcation train ba\u015far\u0131 oran\u0131 %',model_adaboost.score(x_train_ss,y_train)*100)\nprint(confusion_matrix(y_val,y_pred_val_adaboost))\nprint(classification_report(y_val,y_pred_val_adaboost))","e06fb7e2":"from sklearn.ensemble import GradientBoostingClassifier\n\nmodel_gradientboost=GradientBoostingClassifier(learning_rate=1.5,n_estimators=8).fit(x_train_ss,y_train)\ny_pred_val_gradientboost=model_gradientboost.predict(x_val_ss)\nprint('Gradientboost classifcation train ba\u015far\u0131 oran\u0131 %',model_gradientboost.score(x_train_ss,y_train)*100)\nprint(confusion_matrix(y_val,y_pred_val_gradientboost))\nprint(classification_report(y_val,y_pred_val_gradientboost))","d8bf430a":"import tensorflow as tf\n\nmodel_c=tf.keras.Sequential()\nmodel_c.add(tf.keras.layers.Dense(12, input_dim=12, activation='relu'))\nmodel_c.add(tf.keras.layers.Dense(6, activation='relu'))\nmodel_c.add(tf.keras.layers.Dense(1, activation='sigmoid'))","4773e9be":"model_c.compile(optimizer='Adam',loss='binary_crossentropy',metrics=['accuracy'])","029fb29f":"model_c.fit(x_train_ss,y_train,epochs=200,verbose=0)","a25781a7":"model_c.summary()","aab1558b":"y_pred_nn=model_c.predict(x_val_ss)","daf0ac6e":"y_pred_nn[y_pred_nn<0.5]=0","c0ed197f":"y_pred_nn[y_pred_nn>0.5]=1","0bb857ff":"print(classification_report(y_val,y_pred_nn))","ab5e40ba":"y_pred_test_Log=model_logistic.predict(x_test_ss)\nprint(confusion_matrix(y_test,y_pred_test_Log))\nprint('LogisticRegression classifcation Test ba\u015far\u0131 oran\u0131 %',accuracy_score(y_test,y_pred_test_Log)*100)\nprint('LogisticRegression classifcation Test f1_score %',f1_score(y_test,y_pred_test_Log)*100) ","d585ba60":"y_pred_test_svc=model_svc.predict(x_test_ss)\nprint(confusion_matrix(y_test,y_pred_test_svc))\nprint('SVC classifcation Test ba\u015far\u0131 oran\u0131 %',accuracy_score(y_test,y_pred_test_svc)*100)\nprint('SVC classifcation Test f1_score %',f1_score(y_test,y_pred_test_svc)*100)\nprint(classification_report(y_test,y_pred_test_svc))","dea2dd63":"y_pred_test_tree=model_tree.predict(x_test_ss)\nprint(confusion_matrix(y_test,y_pred_test_tree))\nprint('Tree classifcation Test ba\u015far\u0131 oran\u0131 %',accuracy_score(y_test,y_pred_test_tree)*100)\nprint('Tree classifcation Test f1_score %',f1_score(y_test,y_pred_test_tree)*100)\nprint(classification_report(y_test,y_pred_test_tree))","e6ad0924":"y_pred_test_knn=model_knn.predict(x_test_ss)\nprint(confusion_matrix(y_test,y_pred_test_knn))\nprint('KNN classifcation Test ba\u015far\u0131 oran\u0131 %',accuracy_score(y_test,y_pred_test_knn)*100)\nprint('KNN classifcation Test f1_score %',f1_score(y_test,y_pred_test_knn)*100)\nprint(classification_report(y_test,y_pred_test_knn))","dbc177c9":"y_pred_test_xgb=model_xgb.predict(x_test_ss)\nprint(confusion_matrix(y_test,y_pred_test_xgb))\nprint('XGB classifcation Test ba\u015far\u0131 oran\u0131 %',accuracy_score(y_test,y_pred_test_xgb)*100)\nprint('XGB classifcation Test f1_score %',f1_score(y_test,y_pred_test_xgb)*100)\nprint(classification_report(y_test,y_pred_test_xgb))","2f51283f":"y_pred_test_gradiantboost=model_gradientboost.predict(x_test_ss)\nprint(confusion_matrix(y_test,y_pred_test_gradiantboost))\nprint('GradiantBoost classifcation Test ba\u015far\u0131 oran\u0131 %',accuracy_score(y_test,y_pred_test_gradiantboost)*100)\nprint('GradiantBoost classifcation Test f1_score %',f1_score(y_test,y_pred_test_gradiantboost)*100)\nprint(classification_report(y_test,y_pred_test_gradiantboost))","2e0cad30":"y_pred_test_nn=model_c.predict(x_test_ss)\ny_pred_test_nn[y_pred_test_nn<0.5]=0\ny_pred_test_nn[y_pred_test_nn>0.5]=1\nprint(confusion_matrix(y_test,y_pred_test_nn))\nprint('NeuralNetwork classifcation Test ba\u015far\u0131 oran\u0131 %',accuracy_score(y_test,y_pred_test_nn)*100)\nprint('NeuralNetwork classifcation Test f1_score %',f1_score(y_test,y_pred_test_nn)*100)\nprint(classification_report(y_test,y_pred_test_nn))","b3ed4b13":"## Data Preprocessing","690b95f3":"## Data Analiz","ff7bb836":"## Data Upload","46bd232c":"## Test","7927c6b0":"## Models","dcc56a5a":"## Standart Scaler","bdf00ff8":"## Train-Val-Test"}}