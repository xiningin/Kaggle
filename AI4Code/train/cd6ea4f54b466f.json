{"cell_type":{"894624f1":"code","85ea0422":"code","57d76660":"code","451924eb":"code","e19ab641":"code","52805931":"code","1ccef04a":"code","6a0ce8de":"code","2ae60276":"code","e8314e6a":"code","710b2401":"code","5db2f3af":"code","b8298891":"code","fe642542":"code","06adc6a5":"code","710e0a13":"code","e71e14dd":"code","6a493cbb":"code","b55e1434":"code","dddd0a02":"code","a9f3d1af":"code","3cf6caf1":"markdown","261959ce":"markdown","9c87bbc5":"markdown","48d59c10":"markdown","64ddc9cd":"markdown","bd532eb7":"markdown","d656ebd9":"markdown","1c4f7965":"markdown","de246987":"markdown","5091814f":"markdown"},"source":{"894624f1":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","85ea0422":"import matplotlib.pyplot as plt\nimport matplotlib.style as style\nimport seaborn as sns \nfrom pylab import rcParams\nfrom warnings import filterwarnings\nstyle.use('fivethirtyeight')\nrcParams['figure.figsize'] = (12,8)","57d76660":"def cp(n, b=220):\n    return sns.diverging_palette(20, b, n=n)","451924eb":"DATA_PATH = '\/kaggle\/input\/tabular-playground-series-mar-2021\/'\ntrain = pd.read_csv(DATA_PATH + 'train.csv', index_col='id')\ntrain.head()","e19ab641":"train.describe()","52805931":"train.dtypes","1ccef04a":"test = pd.read_csv(DATA_PATH + 'test.csv', index_col='id')\ntest.head()","6a0ce8de":"CAT = [col for col in train.columns if col.startswith('cat')]\nCONT = [col for col in train.columns if col.startswith('cont')]\nprint(f'Number of categorical features:\\t {len(CAT)}.')\nprint(f'Number of continuous features:\\t {len(CONT)}.')","2ae60276":"assert train.isna().sum().sum() == 0, 'No go!'\nassert test.isna().sum().sum() == 0, 'No go!'","e8314e6a":"sns.catplot(data = train, x='target', kind='count',palette=cp(2))\n_ = plt.title('Target Variable Count')","710b2401":"counts = train.target.value_counts()\nprint(f\"Percent of data with target label 0: {100 * counts[0]\/(counts[0] + counts[1]):.1f}%\")\nprint(f\"Percent of data with target label 1: {100 * counts[1]\/(counts[0] + counts[1]):.1f}%\")","5db2f3af":"mask = np.zeros_like(train[CONT].corr())\nmask[np.triu_indices_from(mask)] = True\n\nplt.title(\"Correlation heatmap of continuous features (Train)\")\n\n_ = sns.heatmap(\n    train[CONT].corr(),\n    cmap = cp(200),\n    annot=True,\n    mask=mask,\n    center = 0,\n)","b8298891":"mask = np.zeros_like(test[CONT].corr())\nmask[np.triu_indices_from(mask)] = True\n\nplt.title(\"Correlation heatmap of continuous features (Train)\")\n\n_ = sns.heatmap(\n    test[CONT].corr(),\n    cmap = cp(200),\n    annot=True,\n    mask=mask,\n    center = 0,\n)","fe642542":"fig, axs = plt.subplots(3, 4, figsize=(18, 14))\n\npalette = cp(2)\n\nfor i, row in enumerate(axs):\n    for j, ax in enumerate(row):\n        idx = 4 * i + j\n        if idx == 11:\n            ax.axis('off')\n            break\n        sns.kdeplot(data=train, x=CONT[idx], shade=True, ax=ax, color=palette[idx % 2])\n        ax.set(xlabel='',ylabel='', title=CONT[idx], xticks=[],)\n_ = fig.suptitle(\"KDE Plots (Train)\")","06adc6a5":"fig, axs = plt.subplots(3, 4, figsize=(18, 14))\n\npalette = cp(2)\n\nfor i, row in enumerate(axs):\n    for j, ax in enumerate(row):\n        idx = 4 * i + j\n        if idx == 11:\n            ax.axis('off')\n            break\n        sns.kdeplot(data=test, x=CONT[idx], shade=True, ax=ax, color=palette[idx % 2])\n        ax.set(xlabel='',ylabel='', title=CONT[idx], xticks=[])\n_ = fig.suptitle(\"KDE Plots (Test)\")","710e0a13":"for col in CAT:\n    if set(train[col].unique()) != set(test[col].unique()):\n        print(f\"Different categories found in column: {col}\")","e71e14dd":"train_cat10 = set(train['cat10'].unique())\ntest_cat10 = set(test['cat10'].unique())\n\nprint(f'Categories in the training set but not in the test set: {train_cat10.difference(test_cat10)}.')\nprint(f'Categories in the test set but not in the training set: {test_cat10.difference(train_cat10)}.')","6a493cbb":"nuniques = [train[col].nunique() for col in CAT]\nnuniques_test = [test[col].nunique() for col in CAT]\npd.DataFrame({\"Unique class count (train)\": nuniques, \"Unique class count (test)\": nuniques_test}, index=CAT)","b55e1434":"small_cat = [CAT[idx] for idx in np.argsort(nuniques)[:-4]]\nlarge_cat = [CAT[idx] for idx in np.argsort(nuniques)[-4:]]","dddd0a02":"fig, axs = plt.subplots(3,5,figsize=(18,14))\n\nfor i, row in enumerate(axs):\n    for j, ax in enumerate(row):\n        idx = 5 * i + j\n        counts = train[small_cat[idx]].value_counts()\n        sns.barplot(x = counts.index, y = counts.values, ax=ax, palette = cp(len(counts.index)))\n        ax.set(yticks=[], title = small_cat[idx])\nplt.suptitle('Small categories (Train)');","a9f3d1af":"fig, axs = plt.subplots(3,5,figsize=(18,14))\n\nfor i, row in enumerate(axs):\n    for j, ax in enumerate(row):\n        idx = 5 * i + j\n        counts = train[small_cat[idx]].value_counts()\n        sns.barplot(x = counts.index, y = counts.values, ax=ax, palette = cp(len(counts.index)))\n        ax.set(yticks=[], title = small_cat[idx])\nplt.suptitle('Small categories (Test)');","3cf6caf1":"I found this heatmap layout [here](https:\/\/www.kaggle.com\/arashnic\/cats-on-a-hot-tin-roof-cats-encoding-method).","261959ce":"## Categorical variables","9c87bbc5":"There are different classes in the cat10 column. Let's investigate this further.","48d59c10":"By looking at the train dataset it's clear that the target variable is a binary categorical variable. Plotting the distribution we get","64ddc9cd":"The labels are quite unbalanced with three quarters of the data with label 0.","bd532eb7":"The largest number of distinct categories is 299! We separate categories into small and large categories based on the number of classes.","d656ebd9":"# Tabular Playground (March)\n\nThis is a preliminary exploratory data analysis and will evolve over the next days\/weeks. Comments, suggestions and improvements are very welcome!!\n\n## EDA and Data Visualization","1c4f7965":"We start by checking both the test and train data for any missing values.","de246987":"Check if the categories in the train dataset match the categories in the test dataset.","5091814f":"# EDA"}}