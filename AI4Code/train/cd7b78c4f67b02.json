{"cell_type":{"8f5e8e2c":"code","6f3b928e":"code","47d1c1b1":"code","e01133e6":"code","2635d4c3":"markdown"},"source":{"8f5e8e2c":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nfrom sklearn import metrics","6f3b928e":"def metric(df, preds):\n    df[\"prediction\"] = preds\n    maes = []\n    for t in df.type.unique():\n        y_true = df[df.type==t].scalar_coupling_constant.values\n        y_pred = df[df.type==t].prediction.values\n        mae = np.log(metrics.mean_absolute_error(y_true, y_pred))\n        maes.append(mae)\n    return np.mean(maes)","47d1c1b1":"train = pd.read_csv(\"..\/input\/train.csv\")","e01133e6":"metric(train, np.zeros(len(train)))","2635d4c3":"### competition metric"}}