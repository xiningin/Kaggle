{"cell_type":{"d43006cb":"code","4a3b24d0":"code","60e965e9":"code","82be9f45":"code","82c7d54f":"code","16472dad":"code","51b01155":"code","7e549dd7":"code","04f1dbfb":"code","d4a86138":"code","f4b41bfb":"code","c5ffb8fd":"code","25ce0f03":"code","96fef517":"code","9f67d496":"code","da99a330":"code","20d2a3cf":"code","29f16095":"code","00765f15":"code","7a977b78":"code","8232d9fb":"code","f759ff30":"code","92ddc248":"code","0d251d96":"code","46016868":"code","976a9d2f":"code","f590b55f":"code","28028d41":"code","cb8c8b9e":"code","a443d833":"code","df680074":"code","7a5156e8":"code","c5323d8a":"code","fbcbcf0e":"markdown","03bdb815":"markdown","701aa761":"markdown","fba0fcf2":"markdown","8cda16bc":"markdown","700fda79":"markdown","7dcdb3d0":"markdown","8907e52e":"markdown","c95ad7a1":"markdown","51d5f29e":"markdown","c3108fd2":"markdown","7c7a8cca":"markdown","d4eaf636":"markdown","3520dfbf":"markdown","0d0f61eb":"markdown","8c1bd8cf":"markdown","73e3f90b":"markdown","8c188c41":"markdown","4416577b":"markdown","1c248427":"markdown","8141fe0c":"markdown","4f32179a":"markdown","94ccf216":"markdown","853575f2":"markdown"},"source":{"d43006cb":"#importing the initially required basic libraries\nimport pandas as pd\nimport numpy as np","4a3b24d0":"#importing dataset\ndf=pd.read_csv(\"..\/input\/used-automobile-dataset\/automobile.csv\")\n\n#having a quick view of how our dataset looks like\ndf.head(10)","60e965e9":"#verifying datatype of features\ndf.info()","82be9f45":"#checking if any missing values in 'price' feature\ndf['price'].isnull().sum()","82c7d54f":"df.dropna(subset=['price'],axis=0,inplace=True)","16472dad":"#checking missing values in symboling\ndf['symboling'].isnull().sum()","51b01155":"#checking missing values in normalized-losses\ndf['normalized-losses'].isnull().sum()","7e549dd7":"df['normalized-losses']=df['normalized-losses'].replace(np.nan,df[\"normalized-losses\"].mean())","04f1dbfb":"#checking missing values in wheel-base\ndf['wheel-base'].isnull().sum()","d4a86138":"#checking missing values in length\ndf['length'].isnull().sum()","f4b41bfb":"#checking missing values in width\ndf['width'].isnull().sum()","c5ffb8fd":"#checking missing values in height\ndf['height'].isnull().sum()","25ce0f03":"#checking missing values in curb-weight\ndf['curb-weight'].isnull().sum()","96fef517":"#checking missing values in engine-size\ndf['engine-size'].isnull().sum()","9f67d496":"#checking missing values in bore\ndf['bore'].isnull().sum()","da99a330":"df['bore']=df['bore'].replace(np.nan,df[\"bore\"].mean())","20d2a3cf":"#checking missing values in stroke\ndf['stroke'].isnull().sum()","29f16095":"df['stroke']=df['stroke'].replace(np.nan,df[\"stroke\"].mean())","00765f15":"#checking missing values in compression-ratio\ndf['compression-ratio'].isnull().sum()","7a977b78":"#checking missing values in horsepower\ndf['horsepower'].isnull().sum()","8232d9fb":"df['horsepower']=df['horsepower'].replace(np.nan,df[\"horsepower\"].mean())","f759ff30":"#checking missing values in peak-rpm\ndf['peak-rpm'].isnull().sum()","92ddc248":"df['peak-rpm']=df['peak-rpm'].replace(np.nan,df[\"peak-rpm\"].mean())","0d251d96":"#checking missing values in city-mpg\ndf['city-mpg'].isnull().sum()","46016868":"#checking missing values in highway-mpg\ndf['highway-mpg'].isnull().sum()","976a9d2f":"#importing LinearRegression for creating object\nfrom sklearn.linear_model import LinearRegression\n\n#creating LinearRegression object\nlm=LinearRegression()","f590b55f":"#predictor or independent variable\nx=df[['symboling','normalized-losses','wheel-base','length','width',\n    'height','curb-weight','engine-size','bore','stroke','compression-ratio','horsepower','peak-rpm',\n     'city-mpg','highway-mpg']]\n\n#target or dependent variable\ny=df['price']","28028d41":"#Importing the required libraries for splitting dataset\nfrom sklearn.model_selection import train_test_split\n\n#splitting dataset into ratio of 70% training and 30% testing\nx_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.3,random_state=0)","cb8c8b9e":"lm.fit(x_train,y_train)","a443d833":"#Model accuracy for training dataset\nlm.score(x_train,y_train)","df680074":"#Model accuracy for testing dataset\nlm.score(x_test,y_test)","7a5156e8":"yhat=lm.predict(x_test)","c5323d8a":"#importing required libraries of data visualization\nimport seaborn as sns\n\n#creating a distribution plot comparing actual values and predicted values of model\naxl=sns.distplot(df['price'],hist=False,color='r',label='Actual Value')\nsns.distplot(yhat,hist=False,color='b',label=\"Predicted Values\",ax=axl)","fbcbcf0e":"Now let's check the accuracy for testing dataset.","03bdb815":"Now as encountered missing values in 'bore' feature, fixing it with its mean value.","701aa761":"Replacing NaN values in 'horsepower'feature with its mean value.","fba0fcf2":"The data types looks perfect for now, but we can see that out dataset have some missing values.\nSo we will have to fix this one by one but firstly we will start with 'price' feature as it is our target feature.","8cda16bc":"Now as i have successfully fixed the target variable, will move forward fixing the others one by one using their mean values if they have any missing values in them.","700fda79":"Now let us try to have a visual representation of the difference between the accuracy of training and testing dataset. but first, lets predict all the values for testing dataset. ","7dcdb3d0":"Doing same as above with 'peak-rpm' feature","8907e52e":"To have a visual representation, we will first have to import all the required libraries.\nThen we will make a distribution plot having the comparision of actual target values  and predicted values by model.","c95ad7a1":"We can conclude that our Machine Learning model can predict the values with an above average prediction score for both testing and training dataset.","51d5f29e":"Also let us have a look at the datatypes of our features and see if they are accurate or not.","c3108fd2":"As we can the that the accuracy on testing dataset is approximately 78%.","7c7a8cca":"As we can see we have 37 missing values in 'normalized-losses' feature, we will try to fix them using its mean value.","d4eaf636":"So now lets import the required libraries and then splitting the dataset to the ratio mentioned above.","3520dfbf":"Now i will define the predictor or independent and target or dependent variable.","0d0f61eb":"Now i will red the required dataset for this task, i will use the custom data set available over the internet of used cars dataset 85' but downloading it and then uploading it to my dataset library.","8c1bd8cf":"Now i have to create a linear regression object to create a model. I will do it by importing the required libraries.","73e3f90b":"As we can see that it is approximately 0.8423, i.e. around 84%.\n","8c188c41":"Let's see the accuracy of our model when it uses the training dataset.","4416577b":"Fixing missing values in 'stroke' feature using its mean value.","1c248427":"As we have fixed all the missing values from the required features, we will move ahead. As we can see that i have left some of the features, this is due to the fact that i don't prefer making the model overfitted and not working upto the mark.","8141fe0c":"As we can see that the 'price' feature has some missing values. As it is our target variable, we don't usually prefer guessing its missing values. And also as the missing values are very few,so we can easily prefer dropping the samples having these missing values.","4f32179a":"Now i will spit our dataset into 2 parts-\n1) Training data\n2) Testing data\n\nThis is a major step as we can then train and test the model with same date.\nI will split the data into the ratio of 70% training data and 30% testing data, which according to me is an ideal partition.","94ccf216":"So, as we can see the plot shows the difference between the actual value and predicted values.","853575f2":"As we have not splitted the data into training and testing sets, we will fit the training dataset to train the model."}}