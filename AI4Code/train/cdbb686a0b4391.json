{"cell_type":{"c4ff5015":"code","ee1f83c8":"code","786ed852":"code","0b1319e2":"code","a54cad2c":"code","2256d645":"code","e9f773b8":"code","72fd97ee":"code","a243b33e":"code","6b227f66":"code","112711ce":"code","2b0a11d7":"code","3a39ddf5":"code","c6ed6a8d":"code","ff8ffa89":"code","89050654":"code","f0ef3119":"code","4e44c401":"code","3a7ff7e5":"code","77ac9ebb":"code","8f4aff20":"code","5eecfc0d":"code","673691e0":"code","39569b39":"code","042880cb":"code","6e3b7f75":"code","2eb5cc1a":"code","a0f01ef2":"code","40225986":"code","1b01260c":"code","57dd8f69":"code","f8cafb28":"code","e7cb2d34":"code","cd7d1177":"code","0e25f624":"code","ebdb8a37":"code","f15a4150":"code","e4ee915b":"code","dba4b7f3":"code","b4e6dc71":"code","4299e9cf":"code","2999e4ff":"code","795490c7":"code","ec9afd7e":"code","3de911c9":"code","8bc2911a":"markdown","a86776da":"markdown","b104e386":"markdown","322e6e91":"markdown","76723648":"markdown","0fa39382":"markdown","82507b15":"markdown","2bbaeffb":"markdown","3298a6bd":"markdown","34f58215":"markdown","ed77c29e":"markdown","d6a5728f":"markdown"},"source":{"c4ff5015":"import string\n\nimport gensim\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\nfrom nltk import FreqDist, Text, word_tokenize\nfrom nltk.corpus import stopwords\nfrom wordcloud import WordCloud","ee1f83c8":"df = pd.read_csv(\"..\/input\/brazilian-tax-news\/brtaxnews.csv\", sep=\";\", parse_dates=[\"data\"], dayfirst=True)","786ed852":"df.head()","0b1319e2":"df[\"data\"].isnull().sum()","a54cad2c":"df.fillna(\"\", inplace=True)","2256d645":"df.head()","e9f773b8":"ax = df[\"portal\"].value_counts().plot.bar(title=\"Quantidade de not\u00edcias em cada Portal\", rot=0, figsize=(8,6))\nfor p in ax.patches:\n    ax.annotate(str(p.get_height()), (p.get_x() * 1.005, p.get_height() * 1.005))","72fd97ee":"df_dias = df.groupby(df[\"data\"].dt.date).count()\ndf_dias[df_dias[\"portal\"] == df_dias[\"portal\"].max()]","a243b33e":"df[df[\"data\"] == \"2020-09-22\"]","6b227f66":"df_dias_mes = df.groupby(df[\"data\"].dt.day).count()[\"data\"]\nax = df_dias_mes.plot.bar(figsize=(16,8), rot=0, title=\"Quantidade de not\u00edcias tribut\u00e1rias publicadas em cada dia do m\u00eas\")\nax.axes.get_xaxis().get_label().set_visible(False);","112711ce":"df_dias_sem = df.groupby(df[\"data\"].dt.weekday).count()[\"data\"]\nax = df_dias_sem.plot.bar(figsize=(14,7), rot=0, title=\"Quantidade de not\u00edcias tribut\u00e1rias publicadas em cada dia da semana\");\nax.set_xticklabels([\"Segunda\", \"Ter\u00e7a\", \"Quarta\", \"Quinta\", \"Sexta\", \"S\u00e1bado\", \"Domingo\"])\nax.axes.get_xaxis().get_label().set_visible(False);","2b0a11d7":"df_jota = df[df[\"portal\"] == \"Jota\"]\ndf_valor = df[df[\"portal\"] == \"Valor Econ\u00f4mico\"]","3a39ddf5":"def df2list(df, columns):\n    return [row[column] for index, row in df.iterrows() for column in columns]","c6ed6a8d":"noticias = \". \".join(df2list(df, [\"titulo\", \"descricao\"]))\nnoticias[:300]","ff8ffa89":"noticias_jota = \". \".join(df2list(df_jota, [\"titulo\", \"descricao\"]))\nnoticias_jota[:300]","89050654":"noticias_valor = \". \".join(df2list(df_valor, [\"titulo\", \"descricao\"]))\nnoticias_valor[:300]","f0ef3119":"tokens = word_tokenize(noticias)\ntext = Text(tokens)\n\ntokens_jota = word_tokenize(noticias_jota)\ntext_jota = Text(tokens_jota)\n\ntokens_valor = word_tokenize(noticias_valor)\ntext_valor = Text(tokens_valor)","4e44c401":"text.collocations()","3a7ff7e5":"text.similar(\"tributo\")","77ac9ebb":"text.similar(\"economia\")","8f4aff20":"text.concordance(\"covid\")","5eecfc0d":"text_jota.collocations()","673691e0":"text_jota.similar(\"tributo\")","39569b39":"text_jota.similar(\"economia\")","042880cb":"text_jota.similar(\"pandemia\")","6e3b7f75":"text_jota.similar(\"bolsonaro\")","2eb5cc1a":"text_valor.collocations()","a0f01ef2":"text_valor.similar(\"tributo\")","40225986":"text_valor.similar(\"economia\")","1b01260c":"text_valor.similar(\"pandemia\")","57dd8f69":"text_valor.similar(\"icms\")","f8cafb28":"stop = stopwords.words('portuguese') + list(string.punctuation) + list(\"\u2019\u2018'r\") + [\"sobre\", \"diz\", \"ser\", \"pode\"]\nfd = FreqDist(w.lower() for w in text if w.lower() not in stop)","e7cb2d34":"fd","cd7d1177":"fd_jota = FreqDist(w.lower() for w in text_jota if w.lower() not in stop)\nfd_jota","0e25f624":"fd_valor = FreqDist(w.lower() for w in text_valor if w.lower() not in stop)\nfd_valor","ebdb8a37":"g_tokens = []\nfor index, row in df.iterrows():\n    g_tokens.append([w.lower() for w in word_tokenize(f\"{row['titulo']}. {row['descricao']}.\") if w.lower() not in stop])","f15a4150":"model = gensim.models.Word2Vec(g_tokens, min_count=5, size=200, workers=4, window=5)","e4ee915b":"model.wv.most_similar(\"tributo\")","dba4b7f3":"model.wv.most_similar(\"economia\")","b4e6dc71":"model.wv.most_similar(\"cofins\")","4299e9cf":"def gen_wordcloud(cloud_text):\n    return WordCloud(\n        width=1280,\n        height=720,\n        stopwords=stop,\n        background_color=\"white\",\n        max_words=30,\n        prefer_horizontal=1,\n        colormap=\"plasma\"\n    ).generate(cloud_text)","2999e4ff":"cloud = gen_wordcloud(noticias)\ncloud_jota = gen_wordcloud(noticias_jota)\ncloud_valor = gen_wordcloud(noticias_valor)","795490c7":"plt.figure(figsize=(16,8))\nplt.axis(\"off\")\nplt.imshow(cloud, interpolation=\"bilinear\")\nplt.show()","ec9afd7e":"plt.figure(figsize=(16,8))\nplt.axis(\"off\")\nplt.imshow(cloud_jota, interpolation=\"bilinear\")\nplt.show()","3de911c9":"plt.figure(figsize=(16,8))\nplt.axis(\"off\")\nplt.imshow(cloud_valor, interpolation=\"bilinear\")\nplt.show()","8bc2911a":"## Exploring texts using nltk","a86776da":"### Valor","b104e386":"### Jota","322e6e91":"### Valor","76723648":"## Wordclouds","0fa39382":"### Grouped","82507b15":"## word2vec\n\nUsing gensim as shown by Marlesson @ https:\/\/www.kaggle.com\/marlesson\/vocabulary-analysis-word2vec\nand Pierremegret @ https:\/\/www.kaggle.com\/pierremegret\/gensim-word2vec-tutorial","2bbaeffb":"## First visualizations","3298a6bd":"## Reading and treating data","34f58215":"### Grouped","ed77c29e":"### FreqDist","d6a5728f":"### Jota"}}