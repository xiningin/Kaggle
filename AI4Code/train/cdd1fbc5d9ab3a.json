{"cell_type":{"71f4f9f2":"code","8ce16629":"code","1ef14f7d":"code","aa6687a2":"code","203fc761":"code","f29e6c1b":"code","b6cc47a1":"code","a20364d7":"code","4a92594e":"code","3622468b":"code","389c7d3f":"code","a6711bee":"code","f7ece08f":"code","48e03a2c":"code","50189495":"code","88c8e408":"code","ca6dfc53":"code","a1be369c":"code","ad789a82":"code","95578cc0":"code","a939af70":"code","943644bc":"code","e84f8d90":"code","e0d265f3":"code","c93b6db1":"code","43741f0e":"code","11b6360a":"code","78eaac77":"code","eef6d898":"code","7a5fd535":"code","2ab7dde4":"code","03ce663c":"code","3ebc8390":"code","0331e406":"code","c35c416d":"code","8c6ab86e":"code","be16ef63":"code","6e500c1b":"code","ecc5a52e":"code","51f779e8":"code","9ddf3eca":"code","c5377fec":"code","d427e65e":"code","47530d58":"code","a5dda2a6":"code","d3c05fc4":"code","9650fa39":"code","1e17d3d4":"code","c1be1ddd":"code","4e9aa239":"code","43222e30":"code","8e74e0d6":"code","d263d81f":"code","ef33e5b1":"code","e33ae145":"code","a8724f7c":"code","51855f57":"code","59d0bd6e":"code","4425d38d":"code","73a41890":"code","db97d62a":"code","07ab3eb2":"code","bb3625f0":"code","16fee41a":"code","bb0401d9":"code","88545578":"code","efdbe179":"code","127bd8c5":"code","4a4a9391":"code","d493a4a5":"code","f3748d40":"code","1bb59dc0":"code","59be991c":"code","4a2f633d":"code","60714137":"code","619bcfc6":"code","f5554fee":"code","4e7a6647":"code","bbd8d753":"markdown","1aff5cbe":"markdown","294380df":"markdown"},"source":{"71f4f9f2":"import numpy as np\nimport pandas as pd","8ce16629":"dataset = {'isim' : ['Mert','Nilay','Dogancan','Omer','Merve','Onur'],\n           'soyad': ['Cobanov','Mertel','Mavideniz','Cengiz','Noyan','Sahil'],\n           'yas'  : [24,22,24,23,'bilinmiyor','23'],\n           'sehir': ['Bursa','Ankara','Istanbul',np.nan,'Izmir','Istanbul'],\n           'ulke' : ['Turkiye','Turkiye','Turkiye','Turkiye','Turkiye','Turkiye'],\n           'GANO' : [np.nan,np.nan,np.nan,np.nan,3.90,np.nan]}","1ef14f7d":"df = pd.DataFrame(dataset)","aa6687a2":"df_2 = df.drop(labels=['GANO', 'ulke'], axis=1)","203fc761":"df_2","f29e6c1b":"df_2['yas'].replace('bilinmiyor', np.nan, inplace=True)","b6cc47a1":"df_2 = df_2.astype({\"yas\": float})","a20364d7":"df_2.yas","4a92594e":"df_2.yas.fillna(value=df_2.yas.mean(), inplace=True)","3622468b":"df_2.yas","389c7d3f":"from sklearn.impute import SimpleImputer","a6711bee":"imp_freq=SimpleImputer(missing_values=np.nan, strategy='most_frequent')","f7ece08f":"df_2.yas=imp_freq.fit_transform(df_2[['yas']])","48e03a2c":"df_2","50189495":"s = pd.Series([0, 1, np.nan, 3])\nprint(s)","88c8e408":"from sklearn.impute import KNNImputer","ca6dfc53":"X = [[1, 2, np.nan], [3, 4, 3], [np.nan, 6, 5], [8, 8, 7]]\npd.DataFrame(X)","a1be369c":"imputer = KNNImputer(n_neighbors=2, weights='uniform')\nX = imputer.fit_transform(X)","ad789a82":"pd.DataFrame(X)","95578cc0":"df_2","a939af70":"df_2['sehir'] = df['sehir'].replace(np.nan, 'diger')","943644bc":"df_2","e84f8d90":"from sklearn.preprocessing import StandardScaler","e0d265f3":"df_ss = df_2.copy()","c93b6db1":"df_ss['yas_scaled'] = StandardScaler().fit_transform(df_ss[['yas']])","43741f0e":"df_ss","11b6360a":"print(df_ss['yas_scaled'].mean(axis=0))\nprint(df_ss['yas_scaled'].std(axis=0))","78eaac77":"from sklearn.preprocessing import MinMaxScaler","eef6d898":"df_mm = df_2.copy()","7a5fd535":"df_mm['yas_scaled'] = MinMaxScaler().fit_transform(df_mm[['yas']])","2ab7dde4":"df_mm","03ce663c":"from sklearn.preprocessing import LabelEncoder","3ebc8390":"le = LabelEncoder()","0331e406":"df_le = df_2.copy()","c35c416d":"le.fit(df_le['sehir'])","8c6ab86e":"list(le.classes_)","be16ef63":"df_le['sehir'] = le.transform(df_le['sehir'])","6e500c1b":"df_le","ecc5a52e":"le.inverse_transform([2,1,0,1])","51f779e8":"pd.get_dummies(df_2['sehir'])","9ddf3eca":"X = np.array([[-3., 5., 15],\n              [ 0., 6., 14],\n              [ 6., 3., 11]])","c5377fec":"from sklearn import preprocessing","d427e65e":"preprocessing.KBinsDiscretizer(n_bins=[3,2,2], encode='ordinal').fit_transform(X)","47530d58":"binarizer=preprocessing.Binarizer(threshold=5.1)","a5dda2a6":"binarizer.transform(X)","d3c05fc4":"from sklearn.preprocessing import LabelEncoder, StandardScaler\nfrom sklearn.model_selection import train_test_split","9650fa39":"import os\nimport io","1e17d3d4":"pwd","c1be1ddd":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","4e9aa239":"data = pd.read_csv(\"\/kaggle\/input\/mushroom-csv-file\/mushrooms.csv\")","43222e30":"data.head()","8e74e0d6":"url = 'https:\/\/raw.githubusercontent.com\/cobanov\/ML_Days\/master\/mushrooms.csv'\ndata2 = pd.read_csv(url, error_bad_lines=False)","d263d81f":"data2.head()","ef33e5b1":"X = data.drop(['class'], axis=1)\ny = data['class']","e33ae145":"X_encoded = pd.get_dummies(X, prefix_sep='_')","a8724f7c":"y_encoded = LabelEncoder().fit_transform(y)","51855f57":"X_scaled = StandardScaler().fit_transform(X_encoded)","59d0bd6e":"X_train, X_test, y_train, y_test = train_test_split(X_scaled, y_encoded, test_size=0.3, random_state=101)","4425d38d":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report, confusion_matrix\nimport time","73a41890":"start = time.process_time()\nmodel = RandomForestClassifier(n_estimators=700).fit(X_train,y_train)\nprint(time.process_time()-start)","db97d62a":"preds=model.predict(X_test)","07ab3eb2":"print(confusion_matrix(y_test,preds))","bb3625f0":"import matplotlib.pyplot as plt","16fee41a":"feature_imp = pd.Series(model.feature_importances_, index=X_encoded.columns)","bb0401d9":"feature_imp","88545578":"feature_imp.nlargest(10).plot(kind='barh')","efdbe179":"best_feat=feature_imp.nlargest(4).index.to_list()","127bd8c5":"X_reduced = X_encoded[best_feat]","4a4a9391":"X_reduced","d493a4a5":"Xr_scaled=StandardScaler().fit_transform(X_reduced)","f3748d40":"Xr_train, Xr_test, yr_train, yr_test = train_test_split(Xr_scaled, y, test_size=0.30, random_state=101)","1bb59dc0":"start=time.process_time()\nrmodel=RandomForestClassifier(n_estimators=700).fit(Xr_train, yr_train)\nprint(time.process_time()-start)\n#2.875 vs. 1.640 sec diff","59be991c":"rpred = rmodel.predict(Xr_test)\nprint(confusion_matrix(yr_test, rpred))\nprint(classification_report(yr_test,rpred))\n#gain in time vs. loss in accuracy","4a2f633d":"import seaborn as sns","60714137":"X = data.drop(['class'], axis=1)\ny = data['class']\nX_encoded = pd.get_dummies(X, prefix_sep='_')\ny_encoded = LabelEncoder().fit_transform(y)\nX_encoded['Class'] = y_encoded","619bcfc6":"sns.heatmap(X_encoded.iloc[:,-7:].corr(), annot=True)","f5554fee":"X_reduced_col_names = X_encoded.corr().abs()['Class'].nlargest(10).index","4e7a6647":"plt.figure(figsize=(9,9), dpi=100)\nsns.heatmap(X_encoded[X_reduced_col_names].corr().abs(), annot=True)","bbd8d753":"# MinMaxScaler\noutlayer olmad\u0131\u011f\u0131na dikkat et","1aff5cbe":"# Label Encoding","294380df":"# Enterpolasyon"}}