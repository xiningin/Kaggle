{"cell_type":{"5d841021":"code","1ba079e8":"code","5cf44ac9":"code","30383381":"code","043308a0":"code","79529baa":"code","7a549863":"code","7fc6f34b":"code","e1ea4708":"code","980ad8bc":"code","ed5c43f6":"code","51bfafdd":"code","a1a78df2":"code","9bd7b282":"code","d6f4ac0f":"code","b97c0bb2":"code","02796fb8":"code","803d9993":"code","266d6fe9":"code","abc6321b":"code","045256c1":"code","b61176b6":"code","039aaabf":"code","e5dbf5eb":"code","b49af472":"code","1e04a51a":"code","8ee571eb":"code","6d0c7402":"markdown","d0de8426":"markdown","cb15bc19":"markdown","7b0136b1":"markdown","d43de53b":"markdown","5f353850":"markdown"},"source":{"5d841021":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","1ba079e8":"import seaborn as sns\n","5cf44ac9":"data_df = pd.read_csv('\/kaggle\/input\/creditcardfraud\/creditcard.csv')","30383381":"data_df.info()","043308a0":"data_df.Class.hist()","79529baa":"counts = data_df.Class.value_counts()","7a549863":"data_true = data_df[data_df.Class == 1]","7fc6f34b":"data_false = data_df[data_df.Class == 0]","e1ea4708":"counts","980ad8bc":"data_false_resampled = data_false.sample(counts[1]*2)","ed5c43f6":"df_balanced = pd.concat([data_true, data_false_resampled], axis=0)\n","51bfafdd":"df_balanced.Class.hist()","a1a78df2":"from sklearn.utils import shuffle","9bd7b282":"df_balanced = shuffle(df_balanced)","d6f4ac0f":"df_balanced.Class.plot()","b97c0bb2":"from sklearn.model_selection import train_test_split","02796fb8":"X_train, X_test, y_train, y_test = train_test_split(df_balanced.drop('Class',axis=1), df_balanced.Class, test_size=0.33, random_state=42)","803d9993":"from sklearn.ensemble import ExtraTreesClassifier\nclf = ExtraTreesClassifier(n_estimators=19, random_state=42)\n","266d6fe9":"clf.fit(X_train, y_train)","abc6321b":"clf.score(X_train, y_train)","045256c1":"clf.score(X_test, y_test)","b61176b6":"from sklearn.model_selection import cross_val_score","039aaabf":"cross_val_score(clf,df_balanced.drop('Class',axis=1), df_balanced.Class, cv=5, scoring='recall')","e5dbf5eb":"from sklearn.metrics import confusion_matrix","b49af472":"y_pred = clf.predict(X_test)","1e04a51a":"conf = confusion_matrix(y_test,y_pred)","8ee571eb":"sns.heatmap(conf,annot=True,fmt='d')","6d0c7402":"# importing libraries","d0de8426":"## check dataset balancing","cb15bc19":"# Group 9\n# Amr Osama Abdelesalam\n# Gouda Ebrahem Gouda \n# Ahmed Elsaid Abdo\n# Mohamed Amin Atallah","7b0136b1":"## dataset is biased to false class\n### we will under sample data to twice the sample size of the true class ","d43de53b":"# read data","5f353850":"### divide classes"}}