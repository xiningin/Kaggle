{"cell_type":{"845c9033":"code","3a537dd6":"code","a0a12eb6":"code","edd07120":"code","7ea67056":"code","186d80eb":"code","68ee9377":"code","800d08bb":"code","f84b5039":"markdown","a8a0f268":"markdown","6acf0ce1":"markdown","6aec5345":"markdown","22abb3c3":"markdown","98afcf2f":"markdown","8693dced":"markdown","fe2b18ef":"markdown","49c91d3a":"markdown","f1ee6754":"markdown"},"source":{"845c9033":"import torch\nfrom torch import nn\nfrom torch.nn import functional as F\n\nx = torch.arange(4)\ntorch.save(x, 'x-file')","3a537dd6":"x2 = torch.load(\"x-file\")\nx2","a0a12eb6":"y = torch.zeros(4)\ntorch.save([x, y], 'x-files')\nx2, y2 = torch.load('x-files')\n(x2, y2)","edd07120":"mydict = {'x': x, 'y': y}\ntorch.save(mydict, 'mydict')\nmydict2 = torch.load('mydict')\nmydict2","7ea67056":"class MLP(nn.Module):\n    def __init__(self):\n        super().__init__()\n        self.hidden = nn.Linear(20, 256)\n        self.output = nn.Linear(256, 10)\n\n    def forward(self, x):\n        return self.output(F.relu(self.hidden(x)))\n\nnet = MLP()\nX = torch.randn(size=(2, 20))\nY = net(X)","186d80eb":"torch.save(net.state_dict(), 'mlp.params')","68ee9377":"clone = MLP()\nclone.load_state_dict(torch.load(\"mlp.params\"))\nclone.eval()","800d08bb":"Y_clone = clone(X)\nY_clone == Y","f84b5039":"\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u5199\u5165\u6216\u8bfb\u53d6\u4ece\u5b57\u7b26\u4e32\u6620\u5c04\u5230\u5f20\u91cf\u7684\u5b57\u5178\u3002\u5f53\u6211\u4eec\u8981\u8bfb\u53d6\u6216\u5199\u5165\u6a21\u578b\u4e2d\u7684\u6240\u6709\u6743\u91cd\u65f6\uff0c\u8fd9\u5f88\u65b9\u4fbf\u3002\n","a8a0f268":"\u6211\u4eec\u53ef\u4ee5\u5b58\u50a8\u4e00\u4e2a\u5f20\u91cf\u5217\u8868\uff0c\u7136\u540e\u628a\u5b83\u4eec\u8bfb\u56de\u5185\u5b58\u3002\n","6acf0ce1":"## \u52a0\u8f7d\u548c\u4fdd\u5b58\u6a21\u578b\u53c2\u6570\n\n\u4fdd\u5b58\u5355\u4e2a\u6743\u91cd\u5411\u91cf\uff08\u6216\u5176\u4ed6\u5f20\u91cf\uff09\u786e\u5b9e\u662f\u6709\u7528\u7684\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u60f3\u4fdd\u5b58\u6574\u4e2a\u6a21\u578b\uff0c\u5e76\u5728\u4ee5\u540e\u52a0\u8f7d\u5b83\u4eec\u3002\u5355\u72ec\u4fdd\u5b58\u6bcf\u4e2a\u5411\u91cf\u5219\u4f1a\u53d8\u5f97\u5f88\u9ebb\u70e6\u3002\u6bd5\u7adf\uff0c\u6211\u4eec\u53ef\u80fd\u6709\u6570\u767e\u4e2a\u53c2\u6570\u6563\u5e03\u5728\u5404\u5904\u3002\u56e0\u6b64\uff0c\u6df1\u5ea6\u5b66\u4e60\u6846\u67b6\u63d0\u4f9b\u4e86\u5185\u7f6e\u51fd\u6570\u6765\u4fdd\u5b58\u548c\u52a0\u8f7d\u6574\u4e2a\u7f51\u7edc\u3002\u9700\u8981\u6ce8\u610f\u7684\u4e00\u4e2a\u91cd\u8981\u7ec6\u8282\u662f\uff0c\u8fd9\u5c06\u4fdd\u5b58\u6a21\u578b\u7684\u53c2\u6570\u800c\u4e0d\u662f\u4fdd\u5b58\u6574\u4e2a\u6a21\u578b\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u6709\u4e00\u4e2a3\u5c42\u591a\u5c42\u611f\u77e5\u673a\uff0c\u6211\u4eec\u9700\u8981\u5355\u72ec\u6307\u5b9a\u7ed3\u6784\u3002\u56e0\u4e3a\u6a21\u578b\u672c\u8eab\u53ef\u4ee5\u5305\u542b\u4efb\u610f\u4ee3\u7801\uff0c\u6240\u4ee5\u6a21\u578b\u672c\u8eab\u96be\u4ee5\u5e8f\u5217\u5316\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u6062\u590d\u6a21\u578b\uff0c\u6211\u4eec\u9700\u8981\u7528\u4ee3\u7801\u751f\u6210\u7ed3\u6784\uff0c\u7136\u540e\u4ece\u78c1\u76d8\u52a0\u8f7d\u53c2\u6570\u3002\u8ba9\u6211\u4eec\u4ece\u719f\u6089\u7684\u591a\u5c42\u611f\u77e5\u673a\u5f00\u59cb\u5c1d\u8bd5\u4e00\u4e0b\u3002\n","6aec5345":"\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u6a21\u578b\u7684\u53c2\u6570\u5b58\u50a8\u4e3a\u4e00\u4e2a\u53eb\u505a\u201cmlp.params\u201d\u7684\u6587\u4ef6\u3002\n","22abb3c3":"\u4e3a\u4e86\u6062\u590d\u6a21\u578b\uff0c\u6211\u4eec\u5b9e\u4f8b\u5316\u4e86\u539f\u59cb\u591a\u5c42\u611f\u77e5\u673a\u6a21\u578b\u7684\u4e00\u4e2a\u5907\u4efd\u3002\u6211\u4eec\u6ca1\u6709\u968f\u673a\u521d\u59cb\u5316\u6a21\u578b\u53c2\u6570\uff0c\u800c\u662f\u76f4\u63a5\u8bfb\u53d6\u6587\u4ef6\u4e2d\u5b58\u50a8\u7684\u53c2\u6570\u3002\n","98afcf2f":"\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u5c06\u5b58\u50a8\u5728\u6587\u4ef6\u4e2d\u7684\u6570\u636e\u8bfb\u56de\u5185\u5b58\u3002\n","8693dced":"\u7531\u4e8e\u4e24\u4e2a\u5b9e\u4f8b\u5177\u6709\u76f8\u540c\u7684\u6a21\u578b\u53c2\u6570\uff0c\u5728\u8f93\u5165\u76f8\u540c\u7684`X`\u65f6\uff0c\u4e24\u4e2a\u5b9e\u4f8b\u7684\u8ba1\u7b97\u7ed3\u679c\u5e94\u8be5\u76f8\u540c\u3002\u8ba9\u6211\u4eec\u6765\u9a8c\u8bc1\u4e00\u4e0b\u3002\n","fe2b18ef":"[Discussions](https:\/\/discuss.d2l.ai\/t\/1839)\n","49c91d3a":"## \u5c0f\u7ed3\n\n* `save`\u548c`load`\u51fd\u6570\u53ef\u7528\u4e8e\u5f20\u91cf\u5bf9\u8c61\u7684\u6587\u4ef6\u8bfb\u5199\u3002\n* \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570\u5b57\u5178\u4fdd\u5b58\u548c\u52a0\u8f7d\u7f51\u7edc\u7684\u5168\u90e8\u53c2\u6570\u3002\n* \u4fdd\u5b58\u7ed3\u6784\u5fc5\u987b\u5728\u4ee3\u7801\u4e2d\u5b8c\u6210\uff0c\u800c\u4e0d\u662f\u5728\u53c2\u6570\u4e2d\u5b8c\u6210\u3002\n\n## \u7ec3\u4e60\n\n1. \u5373\u4f7f\u4e0d\u9700\u8981\u5c06\u7ecf\u8fc7\u8bad\u7ec3\u7684\u6a21\u578b\u90e8\u7f72\u5230\u4e0d\u540c\u7684\u8bbe\u5907\u4e0a\uff0c\u5b58\u50a8\u6a21\u578b\u53c2\u6570\u8fd8\u6709\u4ec0\u4e48\u5b9e\u9645\u7684\u597d\u5904\uff1f\n1. \u5047\u8bbe\u6211\u4eec\u53ea\u60f3\u590d\u7528\u7f51\u7edc\u7684\u4e00\u90e8\u5206\uff0c\u4ee5\u5c06\u5176\u5408\u5e76\u5230\u4e0d\u540c\u7684\u7f51\u7edc\u7ed3\u6784\u4e2d\u3002\u6bd4\u5982\u8bf4\uff0c\u5982\u679c\u4f60\u60f3\u5728\u4e00\u4e2a\u65b0\u7684\u7f51\u7edc\u4e2d\u4f7f\u7528\u4e4b\u524d\u7f51\u7edc\u7684\u524d\u4e24\u5c42\uff0c\u4f60\u8be5\u600e\u4e48\u505a\uff1f\n1. \u5982\u4f55\u540c\u65f6\u4fdd\u5b58\u7f51\u7edc\u7ed3\u6784\u548c\u53c2\u6570\uff1f\u4f60\u4f1a\u5bf9\u7ed3\u6784\u52a0\u4e0a\u4ec0\u4e48\u9650\u5236\uff1f\n","f1ee6754":"# \u8bfb\u5199\u6587\u4ef6\n\n\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u8ba8\u8bba\u4e86\u5982\u4f55\u5904\u7406\u6570\u636e\uff0c\u4ee5\u53ca\u5982\u4f55\u6784\u5efa\u3001\u8bad\u7ec3\u548c\u6d4b\u8bd5\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u3002\u7136\u800c\uff0c\u6709\u65f6\u6211\u4eec\u5bf9\u6240\u5b66\u7684\u6a21\u578b\u8db3\u591f\u6ee1\u610f\uff0c\u6211\u4eec\u5e0c\u671b\u4fdd\u5b58\u8bad\u7ec3\u7684\u6a21\u578b\u4ee5\u5907\u5c06\u6765\u5728\u5404\u79cd\u73af\u5883\u4e2d\u4f7f\u7528\uff08\u53ef\u80fd\u90e8\u7f72\u8fdb\u884c\u9884\u6d4b\uff09\u3002\u6b64\u5916\uff0c\u5f53\u8fd0\u884c\u4e00\u4e2a\u8017\u65f6\u8f83\u957f\u7684\u8bad\u7ec3\u8fc7\u7a0b\u65f6\uff0c\u6700\u4f73\u5b9e\u8df5\u662f\u5b9a\u671f\u4fdd\u5b58\u4e2d\u95f4\u7ed3\u679c\uff08\u68c0\u67e5\u70b9\uff09\uff0c\u4ee5\u786e\u4fdd\u5728\u670d\u52a1\u5668\u7535\u6e90\u88ab\u4e0d\u5c0f\u5fc3\u65ad\u6389\u65f6\u4e0d\u4f1a\u635f\u5931\u51e0\u5929\u7684\u8ba1\u7b97\u7ed3\u679c\u3002\u56e0\u6b64\uff0c\u73b0\u5728\u662f\u65f6\u5019\u5b66\u4e60\u5982\u4f55\u52a0\u8f7d\u548c\u5b58\u50a8\u6743\u91cd\u5411\u91cf\u548c\u6574\u4e2a\u6a21\u578b\u3002\u672c\u8282\u5c06\u8ba8\u8bba\u8fd9\u4e9b\u95ee\u9898\u3002\n\n## \u52a0\u8f7d\u548c\u4fdd\u5b58\u5f20\u91cf\n\n\u5bf9\u4e8e\u5355\u4e2a\u5f20\u91cf\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528`load`\u548c`save`\u51fd\u6570\u5206\u522b\u8bfb\u5199\u5b83\u4eec\u3002\u8fd9\u4e24\u4e2a\u51fd\u6570\u90fd\u8981\u6c42\u6211\u4eec\u63d0\u4f9b\u4e00\u4e2a\u540d\u79f0\uff0c`save`\u8981\u6c42\u5c06\u8981\u4fdd\u5b58\u7684\u53d8\u91cf\u4f5c\u4e3a\u8f93\u5165\u3002\n"}}