{"cell_type":{"320da23e":"code","b3c386ba":"code","425b1a4b":"code","534594bc":"code","dc1423c9":"code","2b067d15":"code","a1e9047e":"code","6402b868":"code","b60f6153":"code","4f7dca36":"code","8abfefe8":"markdown","10ae0746":"markdown","3d52ef16":"markdown","32d9b5f4":"markdown","1623928c":"markdown","3b4cd79f":"markdown","6128aa61":"markdown","d6c77f06":"markdown","0ec6b4f1":"markdown","74740a8c":"markdown","2745188a":"markdown","80abafe4":"markdown"},"source":{"320da23e":"%matplotlib inline\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom pandas.plotting import scatter_matrix\nfrom matplotlib import cm\nfrom sklearn.neighbors import KNeighborsClassifier","b3c386ba":"fruits = pd.read_table('..\/input\/fruits-with-colors-dataset\/fruit_data_with_colors.txt')\nprint(\"Head 10 from dataset:\")\nprint(fruits.head(10))\nprint(\"\\nDescribing dataset:\")\nprint(fruits.describe())\nprint(\"\\nDataset's shape:\")\nprint(fruits.shape)","425b1a4b":"# into X we put all features \nX = fruits[['mass','width','height','color_score']]\n# into y we put our target \ny = fruits['fruit_label']\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, random_state=0)\nprint(\"Dataset splitted.\\n\")\n\nprint(\"Shapes\")\nprint(\"\\nX_train:\")\nprint(X_train.shape)\nprint(\"\\tX_test:\")\nprint(\"\\t{}\".format(X_test.shape))\nprint(\"\\ny_train:\")\nprint(y_train.shape)\nprint(\"\\ty_test:\")\nprint(\"\\t{}\".format(y_test.shape))\n","534594bc":"cmap = cm.get_cmap('gnuplot')\nscatter = scatter_matrix(X_train, c= y_train, marker = 'o', s=40, hist_kwds={'bins':15},\n                            figsize=(12,12), cmap=cmap)","dc1423c9":"knn = KNeighborsClassifier(n_neighbors = 6)\n# n_neighbors is the number of neighbours that algorithm will consider to predict \nprint(\"KNN created.\")\n\n# using our knn to fir our train dataset\nknn.fit(X_train, y_train)\nprint(\"...\")\nprint(\"...\")\nprint(knn.fit(X_train, y_train))\nprint(\"OK.\")","2b067d15":"acc = knn.score(X_test, y_test)\n\nprint(\"The accuracy of our model is: %.2f\" % round(acc,2))","a1e9047e":"lookup_fruit_name = dict(zip(fruits.fruit_label.unique(), fruits.fruit_name.unique()))\nfruit_prediction = knn.predict([[20, 4.3, 5.5, 0.5]])\nlookup_fruit_name[fruit_prediction[0]]","6402b868":"fruit_prediction = knn.predict([[100, 6.3, 8.5, 0.7]])\nlookup_fruit_name[fruit_prediction[0]]","b60f6153":"# use this plot to help you to choice the number of neighbours\nk_range = range(1,20)\nscores = []\n\nfor k in k_range:\n  knn = KNeighborsClassifier(n_neighbors=k)\n  knn.fit(X_train, y_train)\n  scores.append(knn.score(X_test, y_test))\n\nplt.figure()\nplt.xlabel('k')\nplt.ylabel('accuracy')\nplt.scatter(k_range, scores)\nplt.xticks([0,5,10,15,20])","4f7dca36":"from mpl_toolkits.mplot3d import Axes3D\nfig = plt.figure()\nax = fig.gca(projection = '3d')\nax.scatter(X_train['width'], X_train['height'], X_train['color_score'], c = y_train, marker = 'o', s=100)\nax.set_xlabel('width')\nax.set_ylabel('height')\nax.set_zlabel('color_score')\nplt.show()","8abfefe8":"Looking at our graph, we can see that there is a clustered distribution so we know that it is possible to use KNN as a model.","10ae0746":"## How sensitive is the accuracy of the KNN classifier according to the choice of parameter K?","3d52ef16":"## Prologue\n\n**In this project we'll see how to make your first ML prediction using Key-Nearest Neighbours and the Fruit With Colors dataset from Prof. Dr. Iain Murray, University of Edinburgh.**\n\n<br\/>\nOur notebook is divided into the following topics:\n* Importing libaries\n* Importing dataset\n* Understanding dataset\n* Splitting dataset into train and test\n* Visualizing data \n* Classifying \n* Evaluating scores\n* Predicting\n* +BONUS: 3D viz ","32d9b5f4":"Fork this project and improve it to apply a Feature Engineering and make your accuracy better.\n\nIf you like please commend me.","1623928c":"## Using our model to predict new fruits","3b4cd79f":"## +BONUS 3D plot\n","6128aa61":"## Estimating the accuracy of our model","d6c77f06":"## Importing our dataset and understanding it","0ec6b4f1":"## Importing libraries<br\/>\nWe need *numpy* for linear algebra, *pandas* to access dataset, *matplotlib* for visualization, *sklearn* for machine learning model and split dataset.","74740a8c":"## Creating classifier\n<br\/>Using KNeighborsClassifier imported before\n","2745188a":"## Visualizing Data\n<br\/>Using scatter_matrix and cm imported before","80abafe4":"## Splitting dataset into train and test\n<br\/>\nUsing train_test_split imported before"}}