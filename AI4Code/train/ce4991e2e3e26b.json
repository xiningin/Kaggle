{"cell_type":{"314ff2ed":"code","9950cdb8":"code","b94b51a0":"code","69451688":"code","c862de0f":"code","d9441dd0":"code","861a994c":"markdown","949d8083":"markdown","8ef79a66":"markdown"},"source":{"314ff2ed":"import os\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt","9950cdb8":"targetName = 'num_sold'\ncompetitionDir = '\/kaggle\/input\/tabular-playground-series-jan-2022'\nsubmission = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/sample_submission.csv')","b94b51a0":"preds = []\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for count, filename in enumerate(filenames):\n        if (dirname != competitionDir) & ('.csv' in filename):\n            print(f\"File: {filename} of {dirname.split('\/')[-1]}\")\n            df = pd.read_csv(os.path.join(dirname, filename))\n            if len(df) == len(submission):\n                try:\n                    preds.append(df[targetName])\n                except Exception:\n                    pass","69451688":"# np.array(preds)[1] # 1 - 6.0 public lb (blend file)\n# np.array(preds)[1] # 1 - 5.00896 public lb\n# np.array(preds)[2] # 2 - 4.93924 public lb\n# np.array(preds)[3] # 3 - 4.92669 public lb\n\nw = [5, 15, 30, 50]\nwmean = ((np.array(preds)[0] * w[0]) + (np.array(preds)[1] * w[1]) + (np.array(preds)[2] * w[2]) + (np.array(preds)[3] * w[3])) \/ sum(w) #weighted avg\n\nwmean1 = ((np.array(preds)[1]) + (np.array(preds)[2]) + (np.array(preds)[3])) \/ 3 #simple mean\n\nwmean2 = ((np.array(preds)[0]) + (np.array(preds)[1]) + (np.array(preds)[2]) + (np.array(preds)[3])) \/ 4 #simple mean\n\nw = [10, 20, 30, 40]\nwmean3 = ((np.array(preds)[0] * w[0]) + (np.array(preds)[1] * w[1]) + (np.array(preds)[2] * w[2]) + (np.array(preds)[3] * w[3])) \/ sum(w)\n\nw = [10, 20, 30, 40]\nwmean4 = (((np.array(preds)[0] * w[0]) ** 2) + ((np.array(preds)[1] * w[1]) ** 2) + ((np.array(preds)[2] * w[2]) ** 2) + ((np.array(preds)[3] * w[3]) ** 2)) \/ sum(w)\n\nw = [10, 20, 30, 40]\nwmean5 = ((np.array(preds)[0] * w[0]) + (np.array(preds)[1] * w[1]) + (np.array(preds)[2] * w[2]) + (np.array(preds)[3] * w[3]) )\/ sum(w)\n\nw = [0, 0, 40, 60]\nwmean6 = ((np.array(preds)[0] * w[0]) + (np.array(preds)[1] * w[1]) + (np.array(preds)[2] * w[2]) + (np.array(preds)[3] * w[3]) )\/ sum(w)\n\n#formula for weighted-mean = (pred1 * weight1) + (pred2 * weight2) + (pred3 * weight3) + (predn * weightn) \/ (sumof weights)","c862de0f":"submission[targetName] = wmean\nsubmission.to_csv(\"wmean.csv\", index=False)\n\nsubmission[targetName] = wmean1\nsubmission.to_csv(\"wmean1.csv\", index=False)\n\nsubmission[targetName] = wmean2\nsubmission.to_csv(\"wmean2.csv\", index=False)\n\nsubmission[targetName] = wmean3\nsubmission.to_csv(\"wmean3.csv\", index=False)\n\nsubmission[targetName] = wmean4\nsubmission.to_csv(\"wmean4.csv\", index=False)\n\nsubmission[targetName] = wmean5\nsubmission.to_csv(\"wmean5.csv\", index=False)\n\nsubmission[targetName] = wmean6\nsubmission.to_csv(\"wmean6.csv\", index=False)\n\nsubmission[targetName] = wmean2 * 0.98\nsubmission.to_csv(\"scale1.csv\", index=False)\n\nsubmission[targetName] = np.array(preds)[3] * 0.98\nsubmission.to_csv(\"scale2.csv\", index=False)\n\nsubmission[targetName] = np.array(preds)[3] * 1.02\nsubmission.to_csv(\"scale3.csv\", index=False)","d9441dd0":"fig = plt.figure(figsize=(18,8), dpi=600)\nplot = sns.kdeplot(wmean2, color ='red', label='blend')\nsns.kdeplot(wmean2 * 0.98, color ='green',ax = plot, label='blend scaled')\nsns.kdeplot(np.array(preds)[3], color ='blue',ax = plot, label='best lb')\nsns.kdeplot(np.array(preds)[3] * 0.98, color ='pink',ax = plot, label='best lb scaled')\nsns.kdeplot(np.array(preds)[3] * 1.02, color ='yellow',ax = plot, label='best lb scaled')\nplt.legend()\nplt.xlim([0, 1500])\n\nplt.show()","861a994c":"# Save ensemble prediction to csv","949d8083":"# Import any number of public notebooks to automatically update the ensemble prediction\n\n* Forked from https:\/\/www.kaggle.com\/sytuannguyen\/tps-jan-2022-automated-ensembling\/notebook","8ef79a66":"![](https:\/\/pbs.twimg.com\/media\/FIJqLhUVkAIaxNx?format=jpg&name=900x900)"}}