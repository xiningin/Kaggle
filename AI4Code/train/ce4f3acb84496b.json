{"cell_type":{"507c602f":"code","0a025f04":"code","08b064ea":"code","d8c7b23e":"code","61327b61":"code","94987879":"code","49d27fa3":"code","f9cd9dd9":"code","affdea16":"code","2cf22721":"markdown"},"source":{"507c602f":"import pandas as pd \nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nimport warnings\nwarnings.filterwarnings('ignore')","0a025f04":"df = pd.read_csv(\"..\/input\/heart.csv\")\ndf.head()","08b064ea":"#Check for 0s\ndf.isna().sum()\nprint(len(df))","d8c7b23e":"#train-test split\ny = df['target']\nx = df.loc[:, :'thal']\nX_train, X_test, y_train, y_test = train_test_split(x, y, test_size=0.2, random_state=42)","61327b61":"from sklearn.ensemble import RandomForestClassifier, VotingClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC","94987879":"log_clf = LogisticRegression()\nrnd_clf = RandomForestClassifier(n_estimators = 1000, random_state = 1)\nsvm_clf = SVC(probability=True)","49d27fa3":"voting_clf = VotingClassifier(\n    estimators=[('lr', log_clf), ('rf', rnd_clf), ('svc', svm_clf)],\n    voting = 'soft')\nvoting_clf.fit(X_train, y_train)","f9cd9dd9":"from sklearn.metrics import accuracy_score \nfor clf in (log_clf, rnd_clf, svm_clf, voting_clf):\n    clf.fit(X_train, y_train)\n    y_pred = clf.predict(X_test)\n    print(clf.__class__.__name__, accuracy_score(y_test, y_pred))","affdea16":"from sklearn.metrics import confusion_matrix\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\ncm = confusion_matrix(y_test, y_pred)\nplt.figure(figsize=(24,12))\nplt.subplot(2,3,1)\nplt.title(\"Logistic Regression Confusion Matrix\")\nsns.heatmap(cm,annot=True,cmap=\"Blues\",fmt=\"d\",cbar=False)","2cf22721":"**Results**\n\nVoting classifier has the highest accuracy: **89%**"}}