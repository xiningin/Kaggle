{"cell_type":{"cfeddeae":"code","ac2b8799":"code","46947c88":"code","44aa3ae1":"code","6888e11d":"code","349cf128":"code","f9429238":"code","c788b1d0":"code","19d7ff4a":"code","a8394629":"code","863ef2ba":"code","2f4239f7":"code","e1cfc24e":"markdown"},"source":{"cfeddeae":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","ac2b8799":"import keras\nfrom keras.datasets import mnist\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Dropout, Flatten\nfrom keras.layers import Conv2D, MaxPooling2D\nfrom keras.optimizers import Adam\nfrom keras import backend as K\nimport matplotlib.pyplot as plt\nimport random","46947c88":"(x_train, y_train), (x_test, y_test) = mnist.load_data()\nprint(x_train.shape)","44aa3ae1":"x_train=x_train.reshape(x_train.shape[0], 28, 28, 1)\nx_test=x_test.reshape(x_test.shape[0], 28, 28, 1)\n\nprint(x_train.shape)\n\ninput_shape = (28, 28, 1)","6888e11d":"y_train = keras.utils.to_categorical(y_train, 10)\ny_test = keras.utils.to_categorical(y_test, 10)","349cf128":"x_train = x_train.astype('float32')\nx_test = x_test.astype('float32')\nx_train \/= 255\nx_test \/= 255\nprint('x_train shape:', x_train.shape)\nprint(x_train.shape[0], 'train samples')\nprint(x_test.shape[0], 'test samples')","f9429238":"model = Sequential()\nmodel.add(Conv2D(64, kernel_size=3, activation='swish', input_shape=input_shape))\nmodel.add(Conv2D(32, kernel_size=3, activation='swish'))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Flatten())\nmodel.add(Dense(10, activation='softmax'))\nmodel.compile(optimizer='adam',\n              loss='categorical_crossentropy',  # loss function\n              metrics=['accuracy'])","c788b1d0":"hist = model.fit(x_train, y_train, batch_size=200,\n                 epochs=3, validation_data=(x_test, y_test))\nprint(\"The model has successfully trained\")\n\nscore = model.evaluate(x_test, y_test, verbose=0)\nprint('Test loss:', score[0])\nprint('Test accuracy:', score[1])\n\nmodel.save('mnist.h5')\nprint(\"Saving the model as mnist.h5\")","19d7ff4a":"from keras.models import load_model\nfrom tkinter import *\nimport tkinter as tk\nimport win32gui\nfrom PIL import ImageGrab\nfrom PIL import Image\nimport numpy as np\n","a8394629":"model = load_model('mnist.h5')","863ef2ba":"def predict_digit(img):\n    #resize image to 28x28 pixels\n    img = img.resize((28,28))\n    #convert rgb to grayscale\n    img = img.convert('L')\n    img = np.array(img)\n    #reshaping to support our model input and normalizing\n    # img = img.reshape(1,28*28)\n    img = img.reshape(1,28,28,1)\n    img = img\/255.0\n    print(img)\n    #predicting the class\n    res = model.predict([img])[0]\n    # Number and Accuracy respectively\n    return np.argmax(res), max(res)","2f4239f7":"class App(tk.Tk):\n    def _init_(self):\n        tk.Tk._init_(self)\n\n        self.x = self.y = 0\n        \n        # Creating elements\n        self.canvas = tk.Canvas(self, width=300, height=300, bg = \"black\", cursor=\"cross\")\n        self.label = tk.Label(self, text=\"Draw..\", font=(\"Helvetica\", 48))\n        self.classify_btn = tk.Button(self, text = \"Recognise\", command = self.classify_handwriting)   \n        self.button_clear = tk.Button(self, text = \"Clear\", command = self.clear_all)\n       \n        # Grid structure\n        self.canvas.grid(row=0, column=0, pady=2, sticky=W, )\n        self.label.grid(row=0, column=1,pady=2, padx=2)\n        self.classify_btn.grid(row=1, column=1, pady=2, padx=2)\n        self.button_clear.grid(row=1, column=0, pady=2)\n        \n        #self.canvas.bind(\"<Motion>\", self.start_pos)\n        self.canvas.bind(\"<B1-Motion>\", self.draw_lines)\n\n    def clear_all(self):\n        self.canvas.delete(\"all\")\n        \n    def classify_handwriting(self):\n        HWND = self.canvas.winfo_id()  # get the handle of the canvas\n        rect = win32gui.GetWindowRect(HWND)  # get the coordinate of the canvas\n        a,b,c,d = rect  #(left, top, right, bottom) \n        rect=(a-4,b+4,c+4,d-4)\n        print(rect)\n        im = ImageGrab.grab(rect)\n\n        digit, acc = predict_digit(im)\n        self.label.configure(text= str(digit)+', '+ str(int(acc*100))+'%')\n\n    def draw_lines(self, event):\n        self.x = event.x\n        self.y = event.y\n        r=8\n        self.canvas.create_oval(self.x-r, self.y-r, self.x + r, self.y + r, outline = \"white\", fill='white', width = 6)\n       \napp = App()\nmainloop()","e1cfc24e":"GUI Code "}}