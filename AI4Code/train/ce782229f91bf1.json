{"cell_type":{"f43c8cb5":"code","804a3d1f":"code","7c4dc6c3":"code","2c0f1ef0":"code","00b99ea0":"code","ffb740c7":"code","10409a8a":"code","8706837c":"code","1b637ceb":"code","3827a923":"code","2405e052":"code","3e01e135":"code","cbb7c265":"code","8766c483":"code","81e4cf8e":"code","dd74d976":"code","f7f73598":"code","c5645980":"code","e8a50d7c":"code","9631ae07":"code","1fa4da13":"code","c4063168":"code","57d5994b":"code","2807bc36":"code","6dac51d2":"code","055b2da8":"code","e4c3b0e0":"code","5dbd98d2":"code","633d641e":"code","b2154d81":"code","8ab04043":"code","017f7320":"code","b4902209":"code","1ebba4ac":"code","a2961fde":"code","596ee076":"code","f9c7c348":"code","bad5c0be":"code","3eb0c83e":"code","ae199d43":"code","faaeaf29":"code","b2dfd81a":"code","6eb16439":"code","c1330b4a":"code","9ec8c746":"code","52dd94d6":"code","1eb51fee":"code","d91157b7":"code","b8b73de2":"code","74d116ec":"code","bb35c89e":"code","8553dee7":"code","4e6edcda":"code","1a5c08fc":"code","ad9794b8":"code","a193ab68":"code","9942592f":"code","4f41a8cc":"code","cf14e07e":"code","a1e17841":"code","80948876":"code","5190c76b":"code","928598ca":"code","a8246209":"code","8d6a11dd":"code","38c034fc":"code","ca48391d":"code","bcf07632":"code","d64ce949":"code","6b7067d3":"code","07487c9d":"code","d7934599":"markdown","39c4f234":"markdown","dcc46432":"markdown","075798c9":"markdown","3df12659":"markdown","fd46042b":"markdown","0784b2a1":"markdown","6958c659":"markdown","86d0ffab":"markdown","db8b4a34":"markdown","20e3bd94":"markdown","0ce71e54":"markdown","93adecf2":"markdown","c95b3b3d":"markdown","67a5a1db":"markdown","4718e5eb":"markdown","b88fc09e":"markdown","46e245e1":"markdown","47234aa2":"markdown","a445deee":"markdown","1c732886":"markdown","76d8a44a":"markdown","f8fd9a4c":"markdown","565b0c85":"markdown","92e3ff9d":"markdown","ba8c18e2":"markdown","e72ee3d8":"markdown","284402fb":"markdown","aaf2f1ea":"markdown","68fcd128":"markdown","fe7b06b7":"markdown","51701760":"markdown","3d461f01":"markdown","dbfe70c7":"markdown","6383d549":"markdown","8add13b8":"markdown","7af9c8a5":"markdown","b3258330":"markdown","6ca1639b":"markdown","f1045311":"markdown","31da3f9b":"markdown","d34cbf63":"markdown","922ed483":"markdown","cf48708d":"markdown","c38411ad":"markdown","7ca7658d":"markdown","41e52c64":"markdown","cc954886":"markdown","8e8a8a4b":"markdown","3822ea43":"markdown","2ca848db":"markdown","a0886986":"markdown","2bdf82bd":"markdown","31a62e1d":"markdown","1744bf62":"markdown","2df32474":"markdown","a09cedba":"markdown","219b6838":"markdown","f4325807":"markdown","2e71f7b9":"markdown","b8c53a71":"markdown"},"source":{"f43c8cb5":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","804a3d1f":"df =  pd.read_csv('..\/input\/predicting-churn-for-bank-customers\/Churn_Modelling.csv')","7c4dc6c3":"df.info()","2c0f1ef0":"df.head()","00b99ea0":"df.drop(['RowNumber', 'Surname'], axis=1, inplace=True)","ffb740c7":"df.to_csv('churn_cleaned.csv', index=None)","10409a8a":"df.head()","8706837c":"df = df.sort_values('CustomerId')","1b637ceb":"df.head()","3827a923":"df['CustomerId'].is_monotonic_increasing","2405e052":"custid = df['CustomerId']\ndf = df.drop('CustomerId', axis=1)","3e01e135":"df['Exited'].value_counts()","cbb7c265":"plt.figure(figsize=(6,6))\n(df['Gender'].value_counts() * 100 \/ df['Gender'].value_counts().sum()).plot(kind='bar')","8766c483":"plt.rcParams['figure.figsize'] = (6,6)","81e4cf8e":"(df.groupby('Gender')['Exited'].mean()*100).plot(kind='bar')\nplt.ylabel('Churn Percentage')","dd74d976":"sns.catplot(x = 'Exited', hue= 'Gender', data= df, kind='count')\nplt.xticks(range(2), ['NO', 'YES'])\nplt.ylabel('Number of Customers');","f7f73598":"df['Gender'].value_counts()","c5645980":"df.groupby('Exited')['CreditScore'].mean()","e8a50d7c":"plt.figure(figsize=(6,8))\nsns.boxplot(x='Exited', y='CreditScore', data=df)","9631ae07":"sns.displot(x='CreditScore', hue='Exited', data=df)","1fa4da13":"df['Score'] = pd.cut(df['CreditScore'],\n                    bins=[0,550,700,900],\n                    labels=['Poor', 'Average', 'Good'])","c4063168":"sns.countplot(x=df['Score'])","57d5994b":"sns.countplot(x='Exited', hue='Score', data=df)","2807bc36":"# let us first look at the overall distribution of Geography\n\nplt.figure(figsize = (6,6))\n(df['Geography'].value_counts()\/df['Geography'].value_counts().sum()*100).plot(kind='bar')\nplt.ylabel('Percentage out of total samples')\nplt.xlabel('Geography')\nplt.title('Geographical share within exited customers');","6dac51d2":"ct = pd.crosstab( df['Exited'], df['Geography'])\nct","055b2da8":"plt.figure(figsize=(6,6))\n(ct.loc[1] * 100.0 \/ ct.sum()).plot(x=ct.index, y=ct.values, kind='bar')\nplt.ylabel('Churn percentage within geographical group')\nplt.title('Churn by geography')","e4c3b0e0":"df.groupby('Exited')['EstimatedSalary'].mean()","5dbd98d2":"plt.figure(figsize=(6,8))\nsns.boxplot(x='Exited', y='EstimatedSalary', data=df)","633d641e":"plt.figure(figsize=(6,6))\nsns.boxplot(x='Exited', y='Age', data=df)","b2154d81":"df['Age'].min(), df['Age'].max()","8ab04043":"df['AgeCat'] = pd.cut(df['Age'],\n                     bins=[17,35,50,65,93],\n                     labels=['Young', 'Middle-aged', 'Senior', 'Very-old'])","017f7320":"sns.countplot(x='AgeCat', data=df)","b4902209":"pd.crosstab(df['AgeCat'], df['Exited']).plot(kind='bar', stacked=True, figsize=(6,6))","1ebba4ac":"df['HasCrCard'].value_counts()","a2961fde":"df.groupby('Exited')['HasCrCard'].mean()","596ee076":"df.groupby('HasCrCard')['Exited'].mean()","f9c7c348":"plt.figure(figsize=(6,6))\nsns.countplot(x='HasCrCard', hue='Exited', data=df)\nplt.title('CREDIT CARD HOLDER vs CHURN');","bad5c0be":"df.groupby('HasCrCard')['CreditScore'].mean()","3eb0c83e":"plt.figure(figsize=(6,6))\nsns.boxplot(y='CreditScore',x='HasCrCard', data=df)\nplt.title('CREDIT SCORE vs CREDIT CARD HOLDING')","ae199d43":"plt.figure(figsize=(10,6))\nsns.catplot(x='Exited', hue='HasCrCard', col='Geography', data=df, kind='count')","faaeaf29":"sns.catplot(x='Geography', hue='Exited', col='HasCrCard', data=df, kind='count')","b2dfd81a":"sns.displot(x='Balance', data=df)\nplt.title('Distribution of balance');","6eb16439":"df['Balance'].describe()","c1330b4a":"(df['Balance'] == 0).sum()","9ec8c746":"df.groupby('Exited')['Balance'].mean()","52dd94d6":"plt.figure(figsize=(6,7))\nsns.boxplot(x='Exited', y='Balance', data=df)\nplt.title('CHURN vs BALANCE')","1eb51fee":"bal_non_zero = df.loc[df['Balance']>0]","d91157b7":"(df['Balance'] < 0).sum()","b8b73de2":"sns.displot(x='Balance', hue='Exited', data=bal_non_zero)\nplt.title('Non-zero balances');","74d116ec":"bal_non_zero.groupby('Exited')['Balance'].mean()","bb35c89e":"plt.figure(figsize=(6,7))\nsns.boxplot(x='Exited', y='Balance', data=bal_non_zero)\nplt.title('NON-ZERO BALANCES vs CHURN')","8553dee7":"plt.figure(figsize=(6,6))\nsns.barplot(x='Exited', y='Balance', hue='HasCrCard', data=df)\nplt.legend(title = 'Has credit card', loc=0)","4e6edcda":"plt.figure(figsize=(7,6))\nsns.jointplot(x='Balance', y='CreditScore', data=df, hue='Exited')","1a5c08fc":"sns.jointplot(x='EstimatedSalary', y='Balance', data=bal_non_zero, hue='Exited')","ad9794b8":"sns.jointplot(x='CreditScore', y='EstimatedSalary', data=df, hue='Gender')","a193ab68":"plt.figure(figsize=(6,7))\nsns.boxplot(x='Geography', y='EstimatedSalary', data=df)","9942592f":"plt.figure(figsize=(6,6))\nsns.boxplot(x='Gender', y='EstimatedSalary', data=df)","4f41a8cc":"c = pd.crosstab(df['Gender'], df['HasCrCard'])\nc","cf14e07e":"(df.groupby('Gender')['HasCrCard'].mean() * 100).plot(kind='bar')","a1e17841":"sns.countplot(x=df['Tenure'])","80948876":"sns.countplot(x='Tenure', data=df, hue='Exited')","5190c76b":"c = pd.crosstab(df['Exited'], df['Tenure'])","928598ca":"c.loc['P_1'] =  c.loc[1] * 100 \/ c.sum()\nc.loc['P_0'] = c.loc[0] * 100 \/ c.sum()\nc","a8246209":"c.loc[[0,1]].T.plot(kind='bar', stacked=True, figsize=(7,5))","8d6a11dd":"df.columns","38c034fc":"sns.pairplot(df[['CreditScore', 'Age', 'Tenure', 'Balance',\n                 'NumOfProducts', 'EstimatedSalary']])","ca48391d":"c = pd.crosstab(df['IsActiveMember'], df['Exited'])\nc","bcf07632":"c.plot(kind='bar', stacked=True, figsize=(6,7))\nplt.title('CHURN vs IS_ACTIVE_MEMBER')\nplt.ylabel('Number of custmers')","d64ce949":"df['NumOfProducts'].value_counts()","6b7067d3":"df['NumOfProducts'] = df['NumOfProducts'].astype('category')","07487c9d":"plt.figure(figsize=(6,6))\nsns.countplot(x='NumOfProducts', hue='Exited', data=df)\nplt.title('CHURN vs NUMBER OF PRODUCTS TAKEN')","d7934599":"### 36% of the customers have zero balance. This may be due to inactive\/frozen accounts, abandoned accounts, etc.","39c4f234":"### Overall, females have a higher churn ratio compared to males.","dcc46432":"#### A balance between 100000 and 130000 seems to be most common.","075798c9":"- Spain has the lowest count of exited customers. The counts of France and Germany are practically equal.","3df12659":"###  Does length of the relationship with the bank play a role in churn ?","fd46042b":"### There seems to be huge variability in the distribution of Balance.","0784b2a1":"### There are no null values.","6958c659":"- About 50% of the customers are from France. \n- Germany and Spain have an almost equal share of 25%.","86d0ffab":"#### Let us bin 'Age' into 4 categories","db8b4a34":"####  The values are practically the same.","20e3bd94":"- Let us divide the credit score into 3 categories as follows:\n1. Poor = Upto score 550\n2. Average = 550 < Score <= 700\n3. Good = Score > 700","0ce71e54":"### Which geographies are more common in exited customers ?","93adecf2":"####  Again, no clear trend is visible. The distribution seems to be completely random.","c95b3b3d":"### Balance vs estimated salary ?","67a5a1db":"####  Customers who have taken less number of products have a lower churn ratio.","4718e5eb":"### Let us see the count of target variable (0 or 1).","b88fc09e":"### How does balance vary for credit card holders by retained and exited customers ?","46e245e1":"### Is there a difference in the estimated salaries of exited and retained customers ?","47234aa2":"### Does credit score determine churn?","a445deee":"##  How to explore the data ?","1c732886":"#### Exited customers clearly seem to have a greater balance on average, compared to retained customers. \n#### Let us see the distribution in customers having non-zero balance.","76d8a44a":"###  Salary vs credit score?","f8fd9a4c":"### What is the average balance for each category ?","565b0c85":"- Most customers in the dataset have an average score.","92e3ff9d":"### We will drop the customer ID column befolre EDA, as this column just represents a unique identifier for each customer in our dataset.","ba8c18e2":"### Do males and females have a different median salary ?","e72ee3d8":"- The same trend is maintained in churned as well as retained customers.","284402fb":"###  Does gender determine churn ratio ?","aaf2f1ea":"- No significant difference seems to exist in the estimated salaries of both groups.","68fcd128":"####  Overall, there is no clear trend in the relationship length of customers with the bank.","fe7b06b7":"### Let us drop RowNumber and Surname","51701760":"####  As we can see, the inactive members are leaving more. This is as expected in a real business scenario.","3d461f01":"### What is the average credit score of credit card holders, that of not having credit card ?","dbfe70c7":"#### About 70% of all customers in the dataset have credit cards.","6383d549":"- The median credit scores of churned and retained customers is almost the same. \n- Exited customers seem to have the lower minimum credit score.","8add13b8":"### What is the churn behavour by Geography and CreditCard adoption ?","7af9c8a5":"####  Males in the dataset seem to have a slightly lower salary compared to females. This difference does not seem to be significant.","b3258330":"###  How does estimated salary vary for different geographies ?","6ca1639b":"### Does holding a credit card play a role in churn ?","f1045311":"###  Do exited customers avail less number of products of the bank ?","31da3f9b":"#### No relationship seems to exist.","d34cbf63":"#### Both categories of customers have a very similar credit average score. \n#### Lets see the distribution.","922ed483":"#### In this case, the balances are similar.","cf48708d":"- Having a credit card does not seem to affect credit score.","c38411ad":"#### No significant relationship seems to be visible between balance and credit score.","7ca7658d":"###  Let us plot numerical columns together.","41e52c64":"###  Do balance and  credit score have a relationship ?","cc954886":"####  It seems middle-aged and senior customers have a higher tendency of leaving.","8e8a8a4b":"### Does geography determine credit card adoption ?","3822ea43":"### Customers of what age are more likely to leave ?","2ca848db":"## EDA of bank churn dataset","a0886986":"Questions to ask\n\n- What is the average credit score of exited customers and retained customers ?\n- Which geographies are more common in exited customers ?\n- DO exited customers have a higher or lower salary compared to retained customers ?\n- What is the ratio of credit card holder in each category ?\n- How is credit score distributed for the credit-card holders in each category ?\n- What is the average balance of each category ?\n- What is the average balance of credit-card holders and non-holders, overall ? How is it distributed across combination of credit card category and churn category ?\n- Customers of which geography are more likely to avail credit card ?\n- Do credit card holders have a higher or lower salary than non-holders ?\n- How is average salary distributed across geographies ?\n- How is the ratio of exited customers distribued by gender ?\n- Average salary distribution by gender ?\n- Is gender a factor in availing credit card ?\n- Distribution of gender-exited-salary?\n- age vs churn ? how is the variability in the age of exited vs retained ? (std())\n- distribution of 'Exited' by NumberOfProducts ?\n- 'Exited'vs IsActiveMember\n- Exited vs estimated_salary\n- salary vs gender?\n- Important -> Salary vs balance and Salary vs CreditScore","2bdf82bd":"###  Credit card adoption by gender ?","31a62e1d":"####  Males and females have equal credit card adoption ratio.","1744bf62":"#### About 55% customers in the dataset are male. We will check if this ratio is maintained across other features.","2df32474":"###  Do active members leave less often than inactive members ?","a09cedba":"### In retained customers, the number of males is more.","219b6838":"- The credit scores of both churned and retained customers follows a normal-like distribution. \n- As deduced in the previous plot, some of the lowest credit scores in the dataset are those of churned customers.","f4325807":"#### The overall ratio of credit card holders of 70% is maintained in churned as well as retained customers.","2e71f7b9":"####  Young people are more likely to avail multiple products from the bank compared to older people.\n#### Customers with multiple products generally have a higher credit score.","b8c53a71":"#### Among customers with non-zero balances, the low-balance customers are more widely present in retained customers."}}