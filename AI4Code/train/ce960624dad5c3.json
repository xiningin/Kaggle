{"cell_type":{"1bb0dbc3":"code","d66a1d3b":"code","904e0ec1":"code","f3104200":"code","c88028b7":"code","5b55e598":"code","a612979a":"code","f56a1c13":"code","927e0290":"code","37ac81fa":"code","dce23f75":"code","7b58c09d":"code","2d72f748":"code","6bc46d40":"code","4ca651c9":"code","d23ff8a2":"code","f3ce80a3":"code","5e5fc133":"code","445c6b07":"code","a23a2696":"code","79a845bd":"code","ad793cda":"code","6c304c78":"markdown"},"source":{"1bb0dbc3":"# Install the fastai v2 dataset\n\n!pip uninstall fastai -y\n!pip install \/kaggle\/input\/fast-v2-offline\/dataclasses-0.6-py3-none-any.whl\n!pip install \/kaggle\/input\/fast-v2-offline\/torch-1.6.0-cp37-cp37m-manylinux1_x86_64.whl\n!pip install \/kaggle\/input\/fast-v2-offline\/torchvision-0.7.0-cp37-cp37m-manylinux1_x86_64.whl\n!pip install \/kaggle\/input\/fast-v2-offline\/fastcore-1.0.1-py3-none-any.whl\n!pip install \/kaggle\/input\/fast-v2-offline\/fastai-2.0.8-py3-none-any.whl\n\nfrom fastai.tabular.all import *\n\nimport numpy as np\nimport pandas as pd","d66a1d3b":"train_x = pd.read_csv('\/kaggle\/input\/lish-moa\/train_features.csv')\ntest_x = pd.read_csv('\/kaggle\/input\/lish-moa\/test_features.csv')\ntrain_y = pd.read_csv('\/kaggle\/input\/lish-moa\/train_targets_scored.csv')","904e0ec1":"cat_names = ['cp_type', 'cp_time', 'cp_dose']\ncont_names = [c for c in train_x.columns if c not in cat_names and c != 'sig_id']\ny_names = [c for c in train_y.columns if c != 'sig_id']","f3104200":"train = pd.concat([train_x, train_y], axis=1)","c88028b7":"splits = RandomSplitter(valid_pct=0.2)(range_of(train))\nprocs = [Categorify, Normalize]\ntab_pan = TabularPandas(train, procs=procs, cat_names=cat_names, cont_names=cont_names, y_names=y_names, splits=splits)","5b55e598":"dls = tab_pan.dataloaders(bs=4096)","a612979a":"from sklearn.metrics import log_loss","f56a1c13":"# learn = tabular_learner(dls, y_range=(0,1), layers=[1024, 512, 256], loss_func=log_loss)","927e0290":"# metrics = [logloss]","37ac81fa":"learn = tabular_learner(dls, y_range=(0,1), layers=[1024, 512, 512, 256], loss_func=BCELossFlat())#, metrics = logloss)","dce23f75":"learn.lr_find()","7b58c09d":"lr = 9e-3\nlearn.fit_one_cycle(10, slice(lr\/(2.6**4),lr))#, moms=(0.8,0.7))","2d72f748":"learn.freeze_to(-2)\nlearn.fit_one_cycle(5, slice(lr\/(2.6**4),lr))\nlearn.unfreeze()","6bc46d40":"lr = 4e-2\nlearn.fit_one_cycle(10, slice(lr\/(2.6**4),lr))","4ca651c9":"\nlearn.fit_one_cycle(20, slice(1e-4, 8e-3))","d23ff8a2":"learn.fit_one_cycle(25, slice(8e-4, 8e-3))","f3ce80a3":"learn.fit_one_cycle(30, slice(5e-4, 5e-3))","5e5fc133":"test_dl = learn.dls.test_dl(test_x)\nsub = learn.get_preds(dl=test_dl)","445c6b07":"submission = pd.read_csv('\/kaggle\/input\/lish-moa\/sample_submission.csv')","a23a2696":"submission[[c for c in submission.columns if c != 'sig_id']] = sub[0]","79a845bd":"submission","ad793cda":"submission.to_csv('submission.csv', index=False)","6c304c78":"Forked from https:\/\/www.kaggle.com\/suresk\/fastai2-starter?scriptVersionId=42023177"}}