{"cell_type":{"cfcb3466":"code","6195820b":"code","bca7d8bf":"code","8602f2ea":"code","0318128e":"code","36fd39c8":"code","1c7bed0b":"code","099b3b43":"code","6cdb83df":"code","171faa8b":"code","8987192e":"code","ed3f5f7e":"code","a0b62d02":"code","669d49fe":"code","a9f0db27":"code","dc6cb7b5":"code","30ad6eb3":"code","231503af":"code","889c4002":"code","5832548d":"code","80f4bbd4":"code","e4556ef8":"code","6e2d5542":"markdown","6f79980e":"markdown","d11a4800":"markdown","16db7164":"markdown","7a0cdaa9":"markdown","1e64f5bd":"markdown","5e8a6039":"markdown","a9fcae10":"markdown","b89253a2":"markdown","26468e6d":"markdown","e9823371":"markdown","bf964450":"markdown","269afa1c":"markdown","0b7fcb66":"markdown","8bb3c112":"markdown","707ccd0c":"markdown","c7828ef8":"markdown","91346c5a":"markdown","3b85a931":"markdown","0a5417fc":"markdown","db193ee1":"markdown","cb652ee6":"markdown","d83f171d":"markdown"},"source":{"cfcb3466":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","6195820b":"data = pd.read_csv('..\/input\/weights_heights.csv', index_col='Index')","bca7d8bf":"data.plot(y='Height', kind='hist', \n           color='red',  title='Height (inch.) distribution');","8602f2ea":"data.head()","0318128e":"data.plot(y='Weight', kind = 'hist'\n         ,color = 'green', title = 'Weight (pound) distribution')","36fd39c8":"def make_bmi(height_inch, weight_pound):\n    METER_TO_INCH, KILO_TO_POUND = 39.37, 2.20462\n    return (weight_pound \/ KILO_TO_POUND) \/ \\\n           (height_inch \/ METER_TO_INCH) ** 2","1c7bed0b":"data['BMI'] = data.apply(lambda row: make_bmi(row['Height'], \n                                              row['Weight']), axis=1)","099b3b43":"sns.pairplot(data)","6cdb83df":"def weight_category(weight):\n    pass\n    if weight < 120: return 1\n    elif weight >= 150: return 3\n    else: return 2\n\ndata['weight_cat'] = data['Weight'].apply(weight_category)\nsns.boxplot(x = 'weight_cat', y = 'Height', data = data)","171faa8b":"#using Pandas plot\ndata.plot.scatter(x = 'Height', y = 'Weight', title = 'Height and Weight scatter plot')","8987192e":"sns.scatterplot(x='Height', y='Weight', data = data,).set_title('Height and Weight scatter plot')","ed3f5f7e":"# May be the error formula isn't right\ndef squared_error(w0,w1):\n    error = []\n    for i in list(data.index.values):\n            error.append((data['Height'][i] - (w0+w1*data['Weight'][i]))**2) \n    return (sum(error))","a0b62d02":"data.plot.scatter(x = 'Weight', y = 'Height', title = 'Height and Weight scatter plot')\nplt.hold(True)\nx =  np.linspace(data['Weight'].min(),data['Weight'].max())\nw0 = 60\nw1 = 0.05\ny = w0+x*w1\nplt.plot(x,y,c='red')\nw0 = 50\nw1 = 0.16\ny = w0+x*w1\nplt.plot(x,y,c = 'green')","669d49fe":"w1 = np.linspace(0,2)\nerror = squared_error(50,w1)\nplt.plot(w1,error,label='')\nplt.title('W1 and error dependency')\nplt.xlabel('w1')\nplt.ylabel('Error')\n\n","a9f0db27":"from scipy.optimize import minimize_scalar\n#used lambda as squared_error have more than input\nres = minimize_scalar(lambda w1: squared_error(w0,w1),bounds=(-5,5)) \n\nw1_opt_2=res.x","dc6cb7b5":"data.plot.scatter(x = 'Weight', y = 'Height', title = 'Height and Weight scatter plot')\nplt.hold(True)\nx =  np.linspace(data['Weight'].min(),data['Weight'].max())\nw0 = 50\nres = minimize_scalar(lambda w1: squared_error(w0,w1),bounds=(-5,5)) \nw1_opt =res.x\ny = w0+x*w1_opt\nplt.plot(x,y,c='red')","30ad6eb3":"from mpl_toolkits.mplot3d import Axes3D","231503af":"fig = plt.figure()\nax = fig.gca(projection='3d') # get current axis\n\n# Create NumPy arrays with data points on X and Y axes.\n# Use meshgrid method creating matrix of coordinates\n# By vectors of coordinates. Set needed function Z(x, y).\nX = np.arange(-5, 5, 0.25)\nY = np.arange(-5, 5, 0.25)\nX, Y = np.meshgrid(X, Y)\nZ = np.sin(np.sqrt(X**2 + Y**2))\n\n# Finally use *plot_surface* method of type object\n# Axes3DSubplot. Add titles to axes.\nsurf = ax.plot_surface(X, Y, Z)\nax.set_xlabel('X')\nax.set_ylabel('Y')\nax.set_zlabel('Z')\nplt.show()","889c4002":"fig = plt.figure()\nax = fig.gca(projection='3d') \n\nw0 = np.arange(0, 100, 1)\nw1 = np.arange(-5, 5, 0.25)\nw0, w1 = np.meshgrid(w0, w1)\nError= squared_error(w0,w1)\n\n#Add titles \"Intercept\" to the x axis, \"Slope\" to the y axis, \"Error\" to the z axis.\nsurf = ax.plot_surface(w0, w1, Error)\nax.set_xlabel('Intercept')\nax.set_ylabel('Slope')\nax.set_zlabel('Error')\nplt.show()\n","5832548d":"from scipy.optimize import minimize\n","80f4bbd4":"\n#minimize(lambda w1: squared_error,(0,0),bounds=(-5,5),method='L-BFGS-B')","e4556ef8":"# Your code here","6e2d5542":"First thing you should do after reading the data is to look at first records. It helps to find the data reading errors (for example, when we have 1 column instead of 10 and it has 9 dots with commas in column name). Also it allows to take a closer look at the data and features and their nature (numerical, categorical, etc.).\n\nThan we should plot histograms of feature distributions. Also it can help to understand features nature (power-series distribution or standard or something else). Histogram can help us find some values that aren't similar to each other - outliers.\nIt is convenient to plot histograms using *plot* method of Pandas DataFrame with option *kind='hist'*.\n\n**Example.** Let's plot the histogram of teenager's height distribution. We use method *plot* for DataFrame *data* with options *y='Height'* (the feature which distribution we want to plot).","6f79980e":"In this task we will use [SOCR](http:\/\/wiki.stat.ucla.edu\/socr\/index.php\/SOCR_Data_Dinov_020108_HeightsWeights) data containing information about height and weight of 25 thousands teenagers.","d11a4800":"Now we can find the slope of the straight line approximating dependency between height and weight when coefficient is fixed $w_0 = 50$ using optimization method.\n\n**[9]. Using *minimize_scalar* method from *scipy.optimize* find the minimum of the function[6] for parameter value $w_1$ in range [-5,5]. Draw on plot [5] Problem 1 the straight line corresponding to the values of parameters ($w_0$, $w_1$) = (50, $w_1\\_opt$) where $w_1\\_opt$ is optimal value of parameter $w_1$ that was found in [8].**","16db7164":"## Part 2. Squared Error Minimization","7a0cdaa9":"<center>\n<img src=\"https:\/\/habrastorage.org\/files\/fd4\/502\/43d\/fd450243dd604b81b9713213a247aa20.jpg\">\n## Open Machine Learning Course\n<center>Author: [Yury Kashnitsky](https:\/\/www.linkedin.com\/in\/festline\/), Data Scientist at Mail.ru Group <br>\nTranslated by [Anna Larionova](https:\/\/www.linkedin.com\/in\/anna-larionova-74434689\/), DS @ Picturer, Data4, BNTouch <br> All content is distributed under the [Creative Commons CC BY-NC-SA 4.0](https:\/\/creativecommons.org\/licenses\/by-nc-sa\/4.0\/) license.\nYou may use this material for any purpose (you can edit, correct and use it as example) exept commercial use with mandatory citation of author.","1e64f5bd":"**[1]. If you haven't installed yet Seaborn library you should execute *conda install seaborn* in the terminal. (Seaborn isn't part of Anaconda and it provides suitable high level functionality for data visualization).**","5e8a6039":"So we are solving the task how to draw a straight line through the points cloud corresponding to observations in our dataset in space of features \"Height\" and \"Weight\" to minimize function[6]. Let's start with drawings some lines and make sure they transfer dependencies from height to weight.\n\n**[7]. On plot from [5] Problem 1 draw two straight lines corresponding to values of parameters $w_0, w_1) = (60, 0.05)$ and ($w_0, w_1) = (50, 0.16)$. Use *plot* method from *matplotlib.pyplot* and *linspace* method from NumPy library. Add the titles to axes and plot.**","a9fcae10":"**[5]. Create scatter plot of dependencies between height and weight using *plot* method for Pandas DataFrame with option *kind='scatter'*. Add title to the figure.**","b89253a2":"Create objects of type matplotlib.figure.Figure (picture) and  matplotlib.axes._subplots.Axes3DSubplot (axes). ","26468e6d":"When you analyze multidimensional data, you often want to get intuitive understanding about data nature using visualization. It is impossible to plot the data when you have more than 3 features. It is better to choose 2 or 3 principal components from data and represent them in plane or volume.\n\nLet's have a look how Python can draw 3D figures on example of function $z(x,y) = sin(\\sqrt{x^2+y^2})$ for values of $x$ \u0438 $y$ from interval [-5,5] with step 0.25","e9823371":"**[4]. Create new feature *weight_category* in DataFrame *data* that will have 3 values: 1 if the weight is less than 120 pounds, 3 if the weight is greater or equal to 150 pounds, 2 in other cases. Create boxplot showing dependency between height and weight category. Use *boxplot* method of Seaborn library and *apply* method of Pandas DataFrame. Add titles \"Height\" to *y* axis and \"Weight category\" to *x* axis.**","bf964450":"**[10]. Create 3D-plot between error function calculated in [6] and parameters $w_0$ and $w_1$. Add titles \"Intercept\" to the $x$ axis, \"Slope\" to the $y$ axis, \"Error\" to the $z$ axis.**","269afa1c":"**[2]. Look at the first 5 rows using *head* method of Pandas DataFrame. Plot the histogram of weight distribution using method *plot* Pandas DataFrame. Make the color of histogram to be green and add title.**","0b7fcb66":"# <center> Assignment #4 (demo)\n## <center> Linear Regression as an optimization problem\n    \n(no solution shared, part of [this](https:\/\/ru.coursera.org\/specializations\/machine-learning-data-analysis) Coursera specialization)","8bb3c112":"Options:\n\n- *y='Height'* - the feature which distribution we want to plot\n- *kind='hist'* - means that plot type is histogram\n- *color='red'* - set color","707ccd0c":"### Part 1. Basic data analysis with Pandas","c7828ef8":"**[11]. Find the minimum of the function in [6] using *minimize* method from scipy.optimize for parameters values $w_0$ in range [-100,100] and $w_1$ in range [-5, 5]. Starting point is ($w_0$, $w_1$) = (0, 0). Use L-BFGS-B optimization method (option method in minimize). Draw on plot from [5] Problem 1 the straight line coresponding finded optimal values of parameters $w_0$ and $w_1$. Add titles to the axes and plot.**","91346c5a":"Squared error function minimization is very easy task because of the function's convex nature. There are many optimization methods for this problem. Let's look at dependency between error function and the first parameter (slope of the straight line) if the second parameter (absolute term) is fixed.\n\n**[8]. Plot dependency between error function calculated in [6] and $w_1$ parameter when $w_0$ = 50. Add the titles to axes and plot.**","3b85a931":"Read the data about height and weight into Pandas DataFrame:","0a5417fc":"During the basic analysis you often have to investigate dependencies of numerical from categorical features (for example, dependency between salary and employee sex). In this case we can use boxplots from Seaborn library. Box plot is a compact way to show real value statistics (mean and quartiles) by different values of categorical feature. It also helps to find outliers - observations that have very different values from others.","db193ee1":"One of the most effective methods of basic data analysis is mapping pairwise dependencies of features. We make $m \\times m$ plots (*m* is number of features) where we have histograms of feature distributions in diagonal and scatter plots of two feature dependencies outside. We can do this using $scatter\\_matrix$ method of Pandas Data Frame or *pairplot* of Seaborn library. \n\nTo illustrate this method we add third feature. Let's create *bodymass index* ([BMI](https:\/\/en.wikipedia.org\/wiki\/Body_mass_index)). To do this we use *apply* method of Pandas FataFrame and Python's lambda functions.","cb652ee6":"**[3]. Create the picture that contains pairwise dependencies of features 'Height', 'Weight' \u0438 'BMI'. You should use *pairplot* method of Seaborn library.**","d83f171d":"In basic case the task of real value prediction by other features (regression task) can be solved using squared error minimization.\n\n**[6]. Create function computing squared error of dependency approximation between height $y$ and weight $x$ using straight line $y = w_0 + w_1 * x$ by two parameters $w_0$ and $w_1$:**\n$$error(w_0, w_1) = \\sum_{i=1}^n {(y_i - (w_0 + w_1 * x_i))}^2 $$\nWhere $n$ is number of observations in dataset, $y_i$ and $x_i$ are height and weight of $i$th person in dataset. "}}