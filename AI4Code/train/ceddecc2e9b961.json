{"cell_type":{"7662c933":"code","d80521bd":"code","232e3a11":"code","37dae451":"code","c79a8094":"code","3bfaff8e":"code","2daa2471":"code","e46723f0":"code","f77f56c3":"markdown","f316de90":"markdown","a20cca1f":"markdown","1ab498d3":"markdown","63002355":"markdown","c82013a3":"markdown","a1c4e96e":"markdown","b5564b04":"markdown"},"source":{"7662c933":"import numpy as np\nimport pandas as pd\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.feature_extraction.text import TfidfTransformer\nfrom sklearn.pipeline import Pipeline\n\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.naive_bayes import MultinomialNB","d80521bd":"dataset = pd.read_csv('..\/input\/classifying-the-fake-news\/training.csv',index_col='Id')\ntest = pd.read_csv('..\/input\/classifying-the-fake-news\/test.csv',index_col='Id')\ndataset.head()","232e3a11":"X_train = dataset.loc[:, \"text\"]\ny_train = dataset.loc[:, \"label\"]","37dae451":"pipe = Pipeline([('vect', CountVectorizer()),\n                 ('tfidf', TfidfTransformer()),\n                 ('model', MultinomialNB())])","c79a8094":"model = pipe.fit(X_train, y_train)","3bfaff8e":"X_test = test['text']\npredictions = model.predict(X_test)","2daa2471":"submission = pd.DataFrame({\n        \"Id\": test.index,\n        \"Predicted\": predictions\n    })","e46723f0":"submission.to_csv('submission.csv',index=False)","f77f56c3":"Okay, let use text field for training our model and label is the feature that we have to predict. That is zero means not fake and 1 means fake news.","f316de90":"Finally, save the submission file. Download this file from the right side in **kaggle\/working** directory and then upload and make submission.","a20cca1f":"We shall now read the training and test dataset and define Id as an index column.","1ab498d3":"Let's create a simpel pipeline. First vectorize the text in every news article, then, we shall use tfidf weighting and, finally, we shall use naive bayes in our pipeline.","63002355":"Great! we are done with training. Let us now test the data. In the test data, we don't have labels. You will be submitting the labels against each Id as a submission file on this portal and it will show you the scores.","c82013a3":"It's time to create a dataframe appropriate for submission.","a1c4e96e":"> ## Term Project Challenge!\n\nIn this tutorial, we shall train a model for detection of fake news. We shall be using Naive Bayes algorithm as a starting point. If you have seen my lecture videos, you now understand how Naive bayes works. First of all we shall import all required libraries.","b5564b04":"So, our pipeline is ready now. Let's now train the model. It will take some time so be patient."}}