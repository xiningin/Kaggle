{"cell_type":{"084aa663":"code","28c3c8af":"code","403f2ffc":"code","afdb7396":"code","8f61d709":"code","f974d7e5":"code","5d454c6d":"code","b95e2001":"code","b3a1ddf4":"code","751f704d":"code","95b8714a":"code","f95c7da0":"code","1e1dd77f":"code","a55352a5":"code","72c7204c":"code","36a21748":"code","b0e7d03f":"code","d3a81e9b":"code","6d2cde5c":"code","c0e13cec":"code","f333dee7":"code","31b0480f":"code","5655e950":"code","0c66d578":"code","a804ae22":"code","d10682fd":"code","ce5304bc":"code","882d73de":"code","79c09821":"code","80a5a75a":"code","7f94d737":"markdown","8b99b143":"markdown","8f450fd3":"markdown","87745a87":"markdown","34ccb164":"markdown","e2138e4a":"markdown","30f11c04":"markdown","58387a89":"markdown","9de7f430":"markdown","1aef417b":"markdown","e224977c":"markdown","aef74cda":"markdown","667ad2c0":"markdown","5a1ce309":"markdown","4f933088":"markdown","a4402932":"markdown","5699a9a4":"markdown","2b8f6033":"markdown","a47a22fe":"markdown","2d51031a":"markdown","8904661d":"markdown","6141f3f3":"markdown","a46dc11c":"markdown","72a1a776":"markdown","0dabb1bf":"markdown"},"source":{"084aa663":"import pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nfrom sklearn import preprocessing\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.svm import SVC\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import confusion_matrix, classification_report, accuracy_score\nfrom sklearn.model_selection import train_test_split, GridSearchCV, cross_val_score\nimport matplotlib.pyplot as plt","28c3c8af":"df1 = pd.read_csv(\"..\/input\/mushroom-classification\/mushrooms.csv\")\ndf = df1.copy()\ndf.head()","403f2ffc":"df.shape","afdb7396":"df.columns","8f61d709":"df.info()","f974d7e5":"df.head(2)","5d454c6d":"df.describe()","b95e2001":"df.isnull().values.any()","b3a1ddf4":"df.isnull().sum()","751f704d":"df.dtypes","95b8714a":"cat_cols = [col for col in df.columns if df[col].dtypes == 'O']\nprint('Number of Categorical Variables : ', len(cat_cols))","f95c7da0":"cat_cols","1e1dd77f":"df[\"cap-shape\"].value_counts()","a55352a5":"df[\"cap-surface\"].value_counts()","72c7204c":"df[\"cap-color\"].value_counts()","36a21748":"df[\"veil-type\"].value_counts()","b0e7d03f":"df.drop([\"veil-type\"],axis=1,inplace=True)","d3a81e9b":"df[\"bruises\"].value_counts()","6d2cde5c":"df[\"gill-size\"].value_counts()","c0e13cec":"df[\"class\"].value_counts()","f333dee7":"fig1, ax1 = plt.subplots()\nax1.pie(df[\"class\"].value_counts(),  labels=['edible','poisonous'], autopct='%1.1f%%',\n        shadow=True, startangle=90)\nax1.axis('equal')\nplt.show()\n","31b0480f":"sns.countplot(\"class\",data=df); plt.show()\n","5655e950":"df[\"class\"].replace([\"p\",\"e\"],[1,0],inplace=True)","0c66d578":"df[\"class\"].value_counts()","a804ae22":"cat_cols = [col for col in df.columns if df[col].dtypes == 'O']\ncat_cols","d10682fd":"def one_hot_encoder(dataframe, categorical_cols, nan_as_category=True):\n    original_columns = list(dataframe.columns)\n    dataframe = pd.get_dummies(dataframe, columns=categorical_cols, dummy_na=nan_as_category, drop_first=True)\n    new_columns = [c for c in dataframe.columns if c not in original_columns]\n    return dataframe, new_columns\n\ndf, new_cols_ohe = one_hot_encoder(df, cat_cols)\n","ce5304bc":"df.head()","882d73de":"X = df.drop('class', axis=1)\ny = df[[\"class\"]]\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20,random_state=42)","79c09821":"vital = []\npoints = []\nmodels = {'Logistic Regression': LogisticRegression(), 'Decision Tree': DecisionTreeClassifier(),\n          'Random Forest': RandomForestClassifier(n_estimators=30),\n          'K-Nearest Neighbors':KNeighborsClassifier(n_neighbors=1),\n            'Linear SVM':SVC(kernel='rbf', gamma=.10, C=1.0)}\n\nfor a,b in models.items():\n    mod = b\n    mod.fit(X_train, y_train)\n    pred = mod.predict(X_test)\n    print('Results for: ' + str(a) + '\\n')\n    print(confusion_matrix(y_test, pred))\n    print(classification_report(y_test, pred))\n    acc = accuracy_score(y_test, pred)\n    print(acc)\n    vital.append(a)\n    points.append(acc)\n    table = pd.DataFrame({'model':vital, 'accuracy score':points})","80a5a75a":"print(table)","7f94d737":"* gill-size","8b99b143":"# 2. LOAD DATA","8f450fd3":"![](http:\/\/)![image.png](attachment:image.png)","87745a87":"The variable \"veil-type\" does not give information about class. It is better to drop it.","34ccb164":"These are all categorical features in the dataset.","e2138e4a":"# 3. EXPLORATORY DATA ANALYSIS ON CATEGORICAL DATA","30f11c04":"**#Checking missing values**","58387a89":"As seen from the values above, there is no imbalance between the classes of the dependent variable.","9de7f430":"* cap-color","1aef417b":"* cap-surface","e224977c":"# 4. ANALYSIS of DEPENDENT VARIABLE (TARGET ANALYSIS)","aef74cda":"* veil-type","667ad2c0":"* bruises","5a1ce309":"# 3. UNDERSTANDING THE DATA-SET","4f933088":"* Finding the number of values in the target column","a4402932":"# Objective\nThe primary aim of this study is to classify whether mushrooms are poisonous or not based on the dataset.\n","5699a9a4":"**Train Test Split**","2b8f6033":"**Introduction**\n* The technology and information revolution experienced in the 20th century has become the most important phenomenon in in diverse fields. A current trend that has emerged as a result of the  information technology is Machine Learning. Many individuals and institutions have been utilized to attain a wide variety of goals in many discipilnes.\n\n* Today, the Machine Learning and their practice were decisive factors throughout our century, driving change in all areas. Many techniques are used to train the data and get the result in machine learning. The power of the machine learning have been improved for a long time. There are three main types of Machine Learning: supervised learning, unsupervised learning, and reinforcement learning.  Supervised learning is used to construct predictive models for an unknown dependency from a dataset. It is also known as \u201clearning with a teacher\u201d. The algorithm learns from through the observation of a set of examples. This approach will generate the output based on the given data. The provided data in supervised Learning can be of two types: a) discrete data for classification and b) continuous data for regression. \nSome learning algorithms  are widely used in the type of Supervised Learning. They are as follows: \n* \u2022\tLogistical Regression\n* \u2022\tLinear regression\n* \u2022\tDecision Trees\n* \u2022\tSupport Vector Machines (SVM)\n* \u2022\tRandom Forest\n* \u2022\tNaive Bayes\n* \u2022\tNearest Neighbor\n\n* Given this context, among those type of machine Learning, decision tree is an supervised learning. Decision tree is one of the simplest, the powerful and popular machine learning algorithms. Decision tree is a non-parametric method that can work for classification and regression tasks. This approach deals with categorical output problem and continuous output problems. That is to say, a classification model for the dependent variable is discrete in nature, while the dependent variable for the regression model is continuous. \n","a47a22fe":"# **Data Summary**\nThis dataset includes descriptions of hypothetical samples corresponding to 23 species of gilled mushrooms in \nthe Agaricus and Lepiota Family Mushroom drawn from The Audubon Society Field Guide to North American Mushrooms (1981).\n Each species is identified as definitely edible, definitely poisonous, or of unknown edibility and not recommended.\nThis latter class was combined with the poisonous one. The Guide clearly states that there is no simple rule for \ndetermining the edibility of a mushroom; no rule like \"leaflets three, let it be'' for Poisonous Oak and Ivy.\n\n**The variables of the dataset are the following:**\n\n**#Dependent Variable**\n\nclasses: edible=e, poisonous=p\n\n**#Independent Variable**\n* cap-shape: bell=b,conical=c,convex=x,flat=f, knobbed=k,sunken=s\n* cap-surface: fibrous=f,grooves=g,scaly=y,smooth=s\n* cap-color: brown=n,buff=b,cinnamon=c,gray=g,green=r,pink=p,purple=u,red=e,white=w,yellow=y\n* bruises: bruises=t,no=f\n* odor: almond=a,anise=l,creosote=c,fishy=y,foul=f,musty=m,none=n,pungent=p,spicy=s\n* gill-attachment: attached=a,descending=d,free=f,notched=n\n* gill-spacing: close=c,crowded=w,distant=d\n* gill-size: broad=b,narrow=n\n* gill-color: black=k,brown=n,buff=b,chocolate=h,gray=g,green=r,orange=o,pink=p,purple=u,red=e,white=w,yellow=y\n* stalk-shape: enlarging=e,tapering=t\n* stalk-root: bulbous=b,club=c,cup=u,equal=e,rhizomorphs=z,rooted=r,missing=?\n* stalk-surface-above-ring: fibrous=f,scaly=y,silky=k,smooth=s\n* stalk-surface-below-ring: fibrous=f,scaly=y,silky=k,smooth=s\n* stalk-color-above-ring: brown=n,buff=b,cinnamon=c,gray=g,orange=o,pink=p,red=e,white=w,yellow=y\n* stalk-color-below-ring: brown=n,buff=b,cinnamon=c,gray=g,orange=o,pink=p,red=e,white=w,yellow=y\n* veil-type: partial=p,universal=u\n* veil-color: brown=n,orange=o,white=w,yellow=y\n* ring-number: none=n,one=o,two=t\n* ring-type: cobwebby=c,evanescent=e,flaring=f,large=l,none=n,pendant=p,sheathing=s,zone=z\n* spore-print-color: black=k,brown=n,buff=b,chocolate=h,green=r,orange=o,purple=u,white=w,yellow=y\n* population: abundant=a,clustered=c,numerous=n,scattered=s,several=v,solitary=y\n* habitat: grasses=g,leaves=l,meadows=m,paths=p,urban=u,waste=w,woods=d\n","2d51031a":"#  5. LABEL ENCODING & ONE-HOT ENCODING","8904661d":"# 6. MODELING","6141f3f3":"****All classification methods hit 100% accuracy with this dataset.","a46dc11c":"# 1. IMPORT SOME NECESSARY LIBRARIES","72a1a776":"In this section, first of all, categorical variables should be determined.\nWhich variables in the data set are categorical?","0dabb1bf":"* cap-shape"}}