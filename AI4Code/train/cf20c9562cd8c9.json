{"cell_type":{"917f5a50":"code","6f9cbd94":"code","818c884b":"code","5c5369d2":"code","56a535f6":"code","ff98262b":"code","c5458884":"code","848217db":"code","102e24f7":"code","00035bdc":"code","573f5fe8":"code","99d88959":"markdown","3640f2ff":"markdown","a44ec2f4":"markdown","fa5d2e9c":"markdown"},"source":{"917f5a50":"import sys\n!{sys.executable} -m pip install bar_chart_race","6f9cbd94":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport bar_chart_race as bcr\nfrom IPython.display import HTML\nimport warnings\nwarnings.filterwarnings(\"ignore\")\nfrom IPython.display import Video","818c884b":"import tensorflow as tf\ntry:\n    tpu = tf.distribute.cluster_resolver.TPUClusterResolver()\n    print('Device:', tpu.master())\n    tf.config.experimental_connect_to_cluster(tpu)\n    tf.tpu.experimental.initialize_tpu_system(tpu)\n    strategy = tf.distribute.experimental.TPUStrategy(tpu)\nexcept:\n    strategy = tf.distribute.get_strategy()\nprint('Number of replicas:', strategy.num_replicas_in_sync)","5c5369d2":"#data = pd.read_csv('https:\/\/www3.nhk.or.jp\/n-data\/opendata\/coronavirus\/nhk_news_covid19_prefectures_daily_data.csv')\ndata = pd.read_csv('..\/input\/country-regional-and-world-gdp\/gdp_csv.csv')\ndata[-1:]","56a535f6":"data.columns","ff98262b":"data['Year']=data['Year'].apply(lambda x: str(x))\ndata['Billion']=data['Value'].apply(lambda x: round(x\/(1.0e+8))\/10)\ndata","c5458884":"# set double indexes\ndata.set_index(['Year','Country Name'])","848217db":"# unstack!!!\ndata1a=data.set_index(['Year','Country Name']).unstack()['Billion']\ndata1a","102e24f7":"data1a2 = data1a.fillna(0)\ndata1a2","00035bdc":"df = data1a2\nbcr.bar_chart_race(\n    df=df,\n    filename='BCR_WorldGDP.mp4',\n    orientation='h',\n    sort='desc',\n    n_bars=20,\n    fixed_order=False,\n    fixed_max=False,\n    steps_per_period=10,\n    interpolate_period=False,\n    label_bars=True,\n    bar_size=.95,\n    period_label={'x': .99, 'y': .10, 'ha': 'right', 'va': 'center'},\n    #period_fmt='%B %d, %Y',\n    period_summary_func=lambda v, r: {'x': .99, 'y': .18,'s': '',\n                                      'ha': 'right', 'size': 8, 'family':'IPAGothic'},\n    perpendicular_bar_func='median',\n    period_length=1000,\n    figsize=(5,3),\n    dpi=500,\n    cmap='dark24',\n    title='World GDP (Billion US$) by Country',\n    title_size=10,\n    bar_label_size=7,\n    tick_label_size=5,\n    shared_fontdict={'family':'IPAGothic','color':'.1'},\n    scale='linear',\n    writer=None,\n    fig=None,\n    bar_kwargs={'alpha':.7},\n    filter_column_colors=True)","573f5fe8":"Video(\"\/kaggle\/working\/'BCR_WorldGDP.mp4\", width=800, height=600, embed=True)","99d88959":"# Dataframe for Bar Chart Race","3640f2ff":"# Data preparation","a44ec2f4":"# Create Bar Chart Race\n","fa5d2e9c":"# World GDP - Bar Chart Race by Prefecture\n* cf. https:\/\/www.dexplo.org\/bar_chart_race\/\n* cf. https:\/\/github.com\/dexplo\/bar_chart_race\/"}}