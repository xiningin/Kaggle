{"cell_type":{"36261fa5":"code","2b7a0ee5":"code","6a2e1189":"code","3fa57283":"code","89b61bfc":"code","ecdf87de":"code","f55b548b":"code","796d18cc":"code","68318c3e":"code","181606de":"code","582ed3f1":"code","fd0446b2":"code","8da7fdb1":"code","1ef9d7b7":"code","58c1a017":"code","fb670fc1":"code","03884b35":"code","e7832210":"code","06d2686b":"code","eacf6f14":"code","50755240":"code","54c25a47":"code","3b314c74":"code","082391f2":"code","be9e6c40":"code","103d7aaf":"code","9faf2537":"code","33be3b83":"code","f655b4f8":"code","f9b16c78":"markdown","79460c76":"markdown","8953b5c3":"markdown","c8db943d":"markdown"},"source":{"36261fa5":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')\n\nfrom tensorflow.keras.preprocessing.sequence import pad_sequences\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.preprocessing.text import one_hot\nfrom tensorflow.keras.layers import Embedding, LSTM, Dense, Dropout\n","2b7a0ee5":"fake = pd.read_csv(r'..\/input\/fake-and-real-news-dataset\/Fake.csv')\ntrue = pd.read_csv(r'..\/input\/fake-and-real-news-dataset\/True.csv')","6a2e1189":"pd.set_option('display.max_colwidth',300)","3fa57283":"fake.shape, true.shape","89b61bfc":"fake.head()","ecdf87de":"length_fake = fake['title'].str.len()\nlength_true = true['title'].str.len()\nplt.hist(length_fake,bins=20,label='fake_title')\nplt.hist(length_true,bins=20,label='true_title')\nplt.legend()\nplt.show()","f55b548b":"fake['label'] = 1\ntrue['label'] = 0\ndata = pd.concat([fake,true],ignore_index=True)","796d18cc":"data.head()","68318c3e":"data[data['label']==1].head()","181606de":"data[data['label']==0].head()","582ed3f1":"data.nunique()","fd0446b2":"# Removing subject and date columns:\ndata.drop('date',axis=1,inplace=True)","8da7fdb1":"data.head()","1ef9d7b7":"X = data.drop('label',axis=1)\ny = data['label']","58c1a017":"### Vocabulary size\nvoc_size=10000","fb670fc1":"messages=X.copy()\nmessages['title'][1]","03884b35":"messages.reset_index(inplace=True)","e7832210":"import nltk\nimport re\nfrom nltk.corpus import stopwords\n\n### Dataset Preprocessing\nfrom nltk.stem.porter import PorterStemmer\nps = PorterStemmer()\ncorpus = []\nfor i in range(0, len(messages)):\n    print(i)\n    review = re.sub('[^a-zA-Z]', ' ', messages['title'][i])\n    review = review.lower()\n    review = review.split()\n    \n    review = [ps.stem(word) for word in review if not word in stopwords.words('english')]\n    review = ' '.join(review)\n    corpus.append(review)","06d2686b":"onehot_repr=[one_hot(words,voc_size)for words in corpus]","eacf6f14":"sent_length=20\nembedded_docs=pad_sequences(onehot_repr,padding='pre',maxlen=sent_length)\nprint(embedded_docs)","50755240":"embedded_docs[0]","54c25a47":"## Creating model\nembedding_vector_features=40\nmodel=Sequential()\nmodel.add(Embedding(voc_size,embedding_vector_features,input_length=sent_length))\nmodel.add(Dropout(0.3))\nmodel.add(LSTM(100))\nmodel.add(Dropout(0.3))\nmodel.add(Dense(1,activation='sigmoid'))\nmodel.compile(loss='binary_crossentropy',optimizer='adam',metrics=['accuracy'])\nprint(model.summary())","3b314c74":"len(embedded_docs),y.shape","082391f2":"X_final=np.array(embedded_docs)\ny_final=np.array(y)","be9e6c40":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X_final, y_final, test_size=0.33, random_state=42)","103d7aaf":"### Finally Training\nhistory = model.fit(X_train,y_train,validation_data=(X_test,y_test),epochs=15,batch_size=128)","9faf2537":"y_pred=model.predict_classes(X_test)","33be3b83":"from sklearn.metrics import confusion_matrix\nprint(f'confusion_matrix: {confusion_matrix(y_test,y_pred)}')","f655b4f8":"from sklearn.metrics import accuracy_score\nprint(f'accuracy_score: {accuracy_score(y_test,y_pred)}')","f9b16c78":"#### **Onehot Representation**","79460c76":"#### **Embedding Representation**","8953b5c3":"#### **Performance Metrics And Accuracy**","c8db943d":"#### **Model Training**"}}