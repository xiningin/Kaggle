{"cell_type":{"172e6765":"code","db017c45":"code","0a0256a0":"code","dfb83648":"code","3aa68fe0":"code","1fe474a5":"code","1f2fdbaf":"code","aee67941":"code","508ab8a9":"code","6556c8a8":"code","5d3f714f":"code","767d7ca9":"code","511f0a3e":"code","f4db30cf":"code","7e513d4c":"code","cf49b9e5":"code","91655095":"code","6d960a4e":"code","d9a96fc2":"code","fd21c733":"code","d6a9b050":"code","56005e5a":"code","8730aeff":"code","7effed07":"code","40fe0975":"code","c4c81466":"code","f14861fe":"markdown","b4d2ad95":"markdown","b0e47298":"markdown","f35008ab":"markdown","81233912":"markdown","52aaecb1":"markdown","40932455":"markdown","551d5c08":"markdown","bca4c6c8":"markdown","c57b246c":"markdown","002aa98e":"markdown","1dbfa5bf":"markdown","022f8002":"markdown","8b71eff9":"markdown","0e5c17c6":"markdown"},"source":{"172e6765":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","db017c45":"data_pathway='..\/input\/wine-quality-from-chemical-properties\/winequality.csv'\ndata=pd.read_csv(data_pathway)","0a0256a0":"data.head()\n","dfb83648":"data.shape","3aa68fe0":"data.isna().sum()","1fe474a5":"import seaborn as sns\nimport matplotlib.pyplot as plt","1f2fdbaf":"sns.countplot(data.quality)","aee67941":"data_coff = data.corr()\nplt.figure(figsize=(10,10))\nsns.heatmap(data_coff, annot=True)","508ab8a9":"sns.boxplot(x=data.quality , y=data.alcohol)","6556c8a8":"sns.boxplot(x=data.quality, y=data.sulphates)","5d3f714f":"sns.boxplot(x=data.quality, y=data.volatile_acidity)","767d7ca9":"sns.lmplot(x='free_S_dioxide', y='total_S_dioxide', data=data)","511f0a3e":"data=data.drop((data.total_S_dioxide[(data.total_S_dioxide>250)]).index)","f4db30cf":"sns.lmplot(x='free_S_dioxide', y='total_S_dioxide', data=data)","7e513d4c":"X=data.drop(['quality'], axis=1)","cf49b9e5":"y=data.quality","91655095":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=42)\n","6d960a4e":"from sklearn.tree import DecisionTreeClassifier","d9a96fc2":"model=DecisionTreeClassifier()\nmodel.fit(X_train, y_train)","fd21c733":"predict=model.predict(X_test)","d6a9b050":"from sklearn.metrics import confusion_matrix","56005e5a":"confusion_matrix(y_test, predict)\n","8730aeff":"from sklearn.metrics import plot_confusion_matrix\nplot_confusion_matrix(model, X_test, y_test)","7effed07":"from sklearn.metrics import accuracy_score\na=accuracy_score(y_test, predict)\nprint(\"the model accuracy is: {}\".format(a.round(2)))","40fe0975":"from sklearn.ensemble import RandomForestClassifier\nn_estimator=[50, 100, 150, 200, 300]\nemp=[]\nfor items in n_estimator:\n    model=RandomForestClassifier(items)\n    model.fit(X_train, y_train)\n    predict = model.predict(X_test)\n    emp.append(accuracy_score(y_test, predict))\n    print (accuracy_score(y_test, predict))\nprint('the best accuracy is:{}'.format((max(emp)).round(2)))","c4c81466":"from sklearn.metrics import plot_confusion_matrix\nplot_confusion_matrix(model, X_test, y_test)","f14861fe":"As can be seen from the heatmap, three major positive affecting parameters for win quality are: alcohol, sulphates, and citric_acid\nvolatile_acidity, total_S_dioxide, and density have major negative effects on the win quality","b4d2ad95":"Great! no missed values :)","b0e47298":"First check if we  have a missed value or not","f35008ab":"Another important trend in the heatmap is the relation between 'free_S_dioxide' and 'total_S_dioxide'. Lets check it:","81233912":"Lets import the data:","52aaecb1":"Now we are going to see the ralation btw win quality and above mentioned features ","40932455":"Our target is \"quality\" column, hence lets discover what are the distribution of the win quality ","551d5c08":"Data Visulization","bca4c6c8":"Now check the accuracy of the model","c57b246c":"Most wines have 5 or 6 quality.","002aa98e":"Now, we are going to check which features are most effective:","1dbfa5bf":"Check the data:","022f8002":"We have two very high total_S_dioxide, which seems to be outliers. Hence, we are going to drop them","8b71eff9":"Now trying to build a model using dectiontreeclassification","0e5c17c6":"Now, create our train and test datasets:"}}