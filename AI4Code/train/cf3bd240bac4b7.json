{"cell_type":{"bb9bab68":"code","11042312":"code","c1de3c9a":"code","7ce72c5c":"code","b6c39d03":"code","5c2b304f":"code","09b1c8c1":"code","ff685b24":"code","44f945bb":"code","94047713":"code","b98f095b":"code","aa5cfcb9":"code","abb5996c":"code","08bc5fbd":"code","7c38c455":"code","263a7a7b":"code","d8e144e9":"code","77edd3d8":"code","d5983b23":"code","adf24325":"code","3e994dbf":"code","ca612948":"code","222ceff0":"code","1eb486fc":"code","323f12e0":"code","1f38ef65":"code","6a8c3838":"code","dea84b83":"code","cb80bb88":"code","8b0015a4":"code","c9fecc21":"code","e95ec4d4":"code","b7ad30e9":"code","7e12367f":"code","c652a205":"code","f4e6e3e7":"code","bae6818b":"code","e4afc09f":"code","19d6f618":"code","3cebcdde":"markdown","8238a722":"markdown","ae922d07":"markdown","4b4e4ade":"markdown","ac8ba9c1":"markdown","adcd9660":"markdown","ac9a1a6d":"markdown","59d840e6":"markdown","1302d7b2":"markdown","2cade3a2":"markdown","5d90b8ec":"markdown","91ee3007":"markdown","4f61d94e":"markdown","73e4696f":"markdown"},"source":{"bb9bab68":"# import necccessary libraries\nimport numpy as np\nimport pandas as pd\nfrom matplotlib import pyplot as plt\nimport numpy as np\n%matplotlib inline\n","11042312":"# Read the Data \ndf=pd.read_csv(\"..\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv\")","c1de3c9a":"# Show Starting 5 Rows\ndf.head()\n","7ce72c5c":"df.shape","b6c39d03":"# Remove customerID column because it is useless\ndf.drop(\"customerID\",axis=1,inplace=True)\ndf.dtypes","5c2b304f":"df.TotalCharges.values","09b1c8c1":"#pd.to_numeric(\"TotalCharges\")","ff685b24":"pd.to_numeric(df.TotalCharges,errors=\"coerce\").isnull()","44f945bb":"df[pd.to_numeric(df.TotalCharges,errors=\"coerce\").isnull()]","94047713":"df[\"TotalCharges\"][488]","b98f095b":"df1=df[df.TotalCharges!=' ']\ndf1.shape","aa5cfcb9":"df1.dtypes","abb5996c":"df1.TotalCharges=pd.to_numeric(df1.TotalCharges)","08bc5fbd":"df1.TotalCharges.dtypes","7c38c455":"MonthlyCharges_churn_no=df1[df1.Churn==\"No\"].MonthlyCharges\nMonthlyCharges_churn_yes=df1[df1.Churn==\"Yes\"].MonthlyCharges\nplt.xlabel(\"MonthlyCharges\")\nplt.ylabel(\"No of Customers\")\nplt.title(\"Customer Churn Prediction\")\nplt.hist([MonthlyCharges_churn_yes, MonthlyCharges_churn_no], rwidth=0.95, color=['green','red'],label=['Churn=Yes','Churn=No'])\nplt.legend()","263a7a7b":"tanure_churn_no=df1[df1.Churn==\"No\"].tenure\ntanure_churn_yes=df1[df1.Churn==\"Yes\"].tenure\nplt.xlabel(\"Tenure\")\nplt.ylabel(\"No of Customers\")\nplt.title(\"Customer Churn Prediction\")\nplt.hist([tanure_churn_yes, tanure_churn_no], rwidth=0.95, color=['green','red'],label=['Churn=Yes','Churn=No'])\nplt.legend()","d8e144e9":"for i in df1.columns:\n    if df1[i].dtypes==\"object\":\n        print(f'{i}: {df1[i].unique()}')","77edd3d8":"df1.replace('No internet service','No',inplace=True)\ndf1.replace('No phone service','No',inplace=True)","d5983b23":"# Replace Value of \" Yes\" and \" No\" to 1 and 0\nyes_no_columns = ['Partner','Dependents','PhoneService','MultipleLines','OnlineSecurity','OnlineBackup',\n                  'DeviceProtection','TechSupport','StreamingTV','StreamingMovies','PaperlessBilling','Churn']\nfor i in yes_no_columns:\n    df1[i].replace({\"Yes\":1,\"No\":0},inplace=True)","adf24325":"for i in df1.columns:\n    print(df1[i].unique())","3e994dbf":"df1['gender'].replace({'Female':1,'Male':0},inplace=True)\n","ca612948":"df1.gender.unique()","222ceff0":"df2 = pd.get_dummies(data=df1, columns=['InternetService','Contract','PaymentMethod'])\ndf2.columns","1eb486fc":"df2.head()","323f12e0":"df2.dtypes","1f38ef65":"cols_to_scale = ['tenure','MonthlyCharges','TotalCharges']\n\nfrom sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\ndf2[cols_to_scale] = scaler.fit_transform(df2[cols_to_scale])","6a8c3838":"df2.head(5)","dea84b83":"for col in df2.columns:\n    print(f'{col} : {df2[col].unique()}')","cb80bb88":"X = df2.drop('Churn',axis='columns')\ny = df2['Churn']\n\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.2,random_state=5)","8b0015a4":"X_train[:10]","c9fecc21":"import tensorflow as tf\nfrom tensorflow import keras\nmodel=keras.Sequential([\n    keras.layers.Dense(26,input_shape=(26,),activation=\"relu\"),\n    keras.layers.Dense(15,activation=\"relu\"),\n    keras.layers.Dense(1,activation=\"sigmoid\")\n])\n# opt = keras.optimizers.Adam(learning_rate=0.01)\nmodel.compile(optimizer=\"adam\",loss=\"binary_crossentropy\",metrics=[\"accuracy\"])\nmodel.fit(X_train,y_train,epochs=100)","e95ec4d4":"model.evaluate(X_test, y_test)","b7ad30e9":"# Let do it for test data\ny_predict = model.predict(X_test)\ny_predict[:5]","7e12367f":"y_p=[]\nfor i in y_predict:\n    if i >= 0.5:\n        y_p.append(1)\n    else:\n        y_p.append(0)","c652a205":"y_p[:10]","f4e6e3e7":"y_test[:10]","bae6818b":"from sklearn.metrics import confusion_matrix ,classification_report\nprint(classification_report(y_test,y_p))","e4afc09f":"import seaborn as sns\nconfusion_metrix=tf.math.confusion_matrix(labels=y_test,predictions=y_p)\nplt.figure(figsize = (10,7))\nsns.heatmap(confusion_metrix, annot=True, fmt='d')\nplt.xlabel('Predicted')\nplt.ylabel('Truth')","19d6f618":"# Accuracy\nround((873+210)\/(198+126+873+210),2)","3cebcdde":"\n<center><h1 style=\"font-size:140%; font-family:cursive; background:Skyblue; color:black; border-radius:10px 10px; padding:10px;\">Here you can see some values seems to be not numbers but blank string. Let's find out such rows<\/h1><\/center>\n\u200b","8238a722":"<center><h1 style=\"font-size:200%; font-family:cursive; background:pink; color:black; border-radius:10px 10px; padding:10px;\">Cycle of customer churn <\/h1><\/center>\n\n","ae922d07":"<center><h1 style=\"font-size:280%; font-family:cursive; background:yellow; color:black; border-radius:10px 10px; padding:10px;\">Predicting customer churn<\/h1><\/center>\n\n\n\n<p style=\"font-size:150%; font-family:cursive;\">Churn prediction means detecting which customers are likely to cancel a subscription to a service based on how they use the service. It is a critical prediction for many businesses because acquiring new clients often costs more than retaining existing ones. Once you can identify those customers that are at risk of cancelling, you should know exactly what marketing action to take for each individual customer to maximise the chances that the customer will remain.\nDifferent customers exhibit different behaviours and preferences, so they cancel their subscriptions for various reasons. It is critical, therefore, to proactively communicate with each of them in order to retain them in your customer list. You need to know which marketing action will be the most effective for each and every customer, and when it will be most effective.","4b4e4ade":"<center><h1 style=\"font-size:280%; font-family:cursive; background:yellow; color:black; border-radius:10px 10px; padding:10px;\">What are the main challenges?<\/h1><\/center>\n\n\n\n<p style=\"font-size:150%; font-family:cursive;\">Churn prediction modelling techniques attempt to understand the precise customer behaviours and attributes that signal the risk and timing of customers leaving. It\u2019s not a walk-in-the-park task so I mention just four points to consider.\n\n<li style=\"font-size:150%; font-family:cursive;\">To succeed at retaining customers who are ready to abandon your business, Marketers & Customer Success experts must be able to predict in advance which customers are going to churn and set up a plan of marketing actions that will have the greatest retention impact on each customer. The key here is to to be proactive and engage with these customers. While simple in theory, the realities involved with achieving this \u201cproactive retention\u201d goal are extremely challenging.<\/li>\n<li style=\"font-size:150%; font-family:cursive;\">The accuracy of the technique is critical to the success of any proactive retention efforts. If the Marketer is unaware of a customer about to churn, no action will be taken to retain that customer<\/li>\n<li style=\"font-size:150%; font-family:cursive;\">Special retention-focused offers or incentives may be provided to happy, active customers, resulting in reduced revenues for no good reason.<\/li>\n<li style=\"font-size:150%; font-family:cursive;\">Your churn prediction model should rely on (almost) real-time data to quantify the risk of churning, not on static data. Although you will be able to identify a certain percentage of at-risk customers with even static data, your predictions will be inaccurate.<\/li>","ac8ba9c1":"<center><h1 style=\"font-size:140%; font-family:cursive; background:Skyblue; color:black; border-radius:10px 10px; padding:10px;\"> Remove rows with space in TotalCharges\n<\/h1><\/center>","adcd9660":"<center><h1 style=\"font-size:280%; font-family:cursive; background:yellow; color:black; border-radius:10px 10px; padding:10px;\">Why is it so important?<\/h1><\/center>\n\n\n\n<p style=\"font-size:150%; font-family:cursive;\">Customer churn is a common problem across businesses in many sectors. If you want to grow as a company, you have to invest in acquiring new clients. Every time a client leaves, it represents a significant investment lost. Both time and effort need to be channelled into replacing them. Being able to predict when a client is likely to leave, and offer them incentives to stay, can offer huge savings to a business.\nAs a result, understanding what keeps customers engaged is extremely valuable knowledge, as it can help you to develop your retention strategies, and to roll out operational practices aimed at keeping customers from walking out the door.\nPredicting churn is a fact of life for any subscription business, and even slight fluctuations in churn can have a significant impact on your bottom line. We need to know: \u201cIs this customer going to leave us within X months?\u201d Yes or No? It is a binary classification task.","ac9a1a6d":"<center><h1 style=\"font-size:140%; font-family:cursive; background:Skyblue; color:black; border-radius:10px 10px; padding:10px;\">Quick glance at above makes me realize that TotalCharges should be float but it is an object. Let's check what's going on with this column<\/h1><\/center>\n\u200b","59d840e6":"<center><h1 style=\"font-size:140%; font-family:cursive; background:Skyblue; color:black; border-radius:10px 10px; padding:10px;\">  Let's Do it for Tenure<\/h1><\/center>","1302d7b2":"\n<center><h1 style=\"font-size:140%; font-family:cursive; background:Skyblue; color:black; border-radius:10px 10px; padding:10px;\">Lets convert it to numbers<\/h1><\/center>\n\u200b","2cade3a2":"\n\n<center><h1 style=\"font-size:140%; font-family:cursive; background:Skyblue; color:black; border-radius:10px 10px; padding:10px;\"> Train Test Split<\/h1><\/center>","5d90b8ec":"<center><img src=\"https:\/\/miro.medium.com\/max\/456\/1*Dvx1j18vyKyvLlIpxzVSmQ.png\"><\/center>","91ee3007":"<center><h1 style=\"font-size:180%; font-family:cursive; background:pink; color:black; border-radius:10px 10px; padding:10px;\">Data Visualization<\/h1><\/center>\n\u200b","4f61d94e":"\n<center><h1 style=\"font-size:140%; font-family:cursive; background:Skyblue; color:black; border-radius:10px 10px; padding:10px;\"> One hot encoding for categorical columns<\/h1><\/center>","73e4696f":"\n<center><h1 style=\"font-size:140%; font-family:cursive; background:Skyblue; color:black; border-radius:10px 10px; padding:10px;\"> Some of the columns have no internet service or no phone service, that can be replaced with a simple No<\/h1><\/center>"}}