{"cell_type":{"8c2c607f":"code","501924a8":"code","4de3ba2c":"code","408037ae":"markdown"},"source":{"8c2c607f":"import pandas as pd\nimport numpy as np","501924a8":"def logloss(true_label, predicted, eps=1e-15):\n    p = np.clip(predicted, eps, 1 - eps)\n    if true_label == 1:\n        return -np.log(p)\n    return -np.log(1 - p)","4de3ba2c":"tourney_result = pd.read_csv('..\/input\/google-cloud-ncaa-march-madness-2020-division-1-mens-tournament\/MDataFiles_Stage1\/MNCAATourneyCompactResults.csv')\nsubmission_result = pd.read_csv('..\/input\/submission\/submission.csv')\n\nlogloss_results = []\n\nfor column_name, item in submission_result.iterrows():\n    ids = item['ID'].split('_')\n\n    result = -1\n\n    record = tourney_result[\n        (tourney_result['Season'] == int(ids[0])) & \n        (tourney_result['WTeamID'] == int(ids[1])) & \n        (tourney_result['LTeamID'] == int(ids[2]))]\n    if record.shape[0] > 0:\n        result = 1\n\n    record = tourney_result[\n        (tourney_result['Season'] == int(ids[0])) & \n        (tourney_result['WTeamID'] == int(ids[2])) & \n        (tourney_result['LTeamID'] == int(ids[1]))]\n    if record.shape[0] > 0:\n        result = 0\n        \n\n    if result > -1:\n        logloss_results.append(round(logloss(result, item['Pred']), 6))\n        \n\nprint('score', sum(logloss_results)\/len(logloss_results))\n","408037ae":"#  Measure your score by logloss\n\n`..\/input\/submission\/submission.csv`  \nChange to your submission.csv\n\n**warning**  \nThe resulting score is not accurate to the third decimal place"}}