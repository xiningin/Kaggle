{"cell_type":{"87d9cd8c":"code","b1236f78":"code","c4dbbaee":"code","add77fa9":"markdown"},"source":{"87d9cd8c":"import numpy as np \nimport pandas as pd \nimport collections\n\nfrom plotly.offline import init_notebook_mode, iplot, plot\n\nimport plotly.express as px\ninit_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nimport plotly.graph_objs as go\nimport missingno as msno","b1236f78":"books_data = pd.read_csv('\/kaggle\/input\/amazon-top-50-bestselling-books-2009-2019\/bestsellers with categories.csv')\nbooks_data.head(5)\nmsno.bar(books_data)","c4dbbaee":"author_ratings_df = books_data.groupby('Year')['User Rating'].apply(list)\nauthor_ratings_df.to_frame()\nauthor_ratings_df = author_ratings_df.reset_index()\noccurrences = []\nfor i in range(author_ratings_df.shape[0]):\n    occurrences.append({'year':author_ratings_df['Year'].iloc[i],'count':dict(collections.Counter(author_ratings_df['User Rating'].iloc[i]))})\nyears_df = []\nfor ele in occurrences:\n    year_ratings_df = pd.DataFrame.from_dict(ele)\n    year_ratings_df.reset_index(level=0,inplace=True) \n    year_ratings_df.columns = ['rating','year','count']\n    years_df.append(year_ratings_df)\n    \nyear_ratings_df = pd.concat(years_df)\nyear_ratings_df.reset_index(inplace=True)\nyear_ratings_df['year'] = year_ratings_df['year'].map(str)\nyear_ratings_df['rating'] = year_ratings_df['rating'].map(str)\nyear_ratings_df = year_ratings_df.drop(['index'],axis=1)\n\nfig = px.bar(year_ratings_df, x=\"year\", y=\"count\", color=\"rating\", title=\"Ratings Distribution each Year\")\nfig.show()","add77fa9":"No null values in any columns so missing data handling required."}}