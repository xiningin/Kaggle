{"cell_type":{"e936ecde":"code","b701f452":"code","7bf302a7":"code","77ddd41e":"code","be812f1c":"code","ca4000d5":"code","b2b97cb8":"code","121fa32e":"code","96fe0a50":"code","11e7b463":"code","903cae61":"code","ebb9b635":"code","0f07ff03":"code","b12dcae0":"code","6002f3bf":"code","41adc267":"code","2549f9b9":"code","04063d65":"code","a2bc2e08":"code","7e974c42":"code","2ff1ef52":"code","2f93fb3a":"code","7efd4145":"code","a58632e3":"code","d4afb408":"code","08c1ca9e":"code","4e9316de":"code","bd69e6e6":"code","f39807f4":"code","af889419":"code","8db5ae4c":"code","c9894d7c":"code","bc2e0c5d":"code","8b90a677":"code","47413e1c":"code","cbe79224":"code","6d1bc6aa":"markdown","0b1af2ab":"markdown","7d6b4f8e":"markdown","fdcb7f11":"markdown","5c9f96c7":"markdown","5464c787":"markdown","c6df4cb4":"markdown"},"source":{"e936ecde":"#import libreries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline ","b701f452":"#import dataset\nsn= pd.read_csv(\"..\/input\/sonar-dataset-suitable-for-classification\/sonar.all-data.csv\")","7bf302a7":"#Data overview\nsn.head()","77ddd41e":"sn.info()","be812f1c":"sns.countplot(data=sn , x=\"Label\")","ca4000d5":"sn[\"Label\"].value_counts()","b2b97cb8":"#Determine the Features and Label\nX= sn.drop(\"Label\" , axis=1)\ny= sn[\"Label\"]","121fa32e":"# Split the Data to Train & Test\nfrom sklearn.model_selection import train_test_split","96fe0a50":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)","11e7b463":"# Scaling the Features\nfrom sklearn.preprocessing import StandardScaler","903cae61":"scaler = StandardScaler()","ebb9b635":"scaler.fit(X_train)","0f07ff03":"scaled_X_train= scaler.transform(X_train)\nscaled_X_test= scaler.transform(X_test)","b12dcae0":"#Train the Model\nfrom sklearn.neighbors import KNeighborsClassifier","6002f3bf":"knn_model= KNeighborsClassifier(n_neighbors=1)\nknn_model.fit(scaled_X_train , y_train)","41adc267":"#Predicting Test Data\ny_pred= knn_model.predict(scaled_X_test)","2549f9b9":"pd.DataFrame({\"y_test\" : y_test , \"y_pred\" : y_pred})","04063d65":"#Evaluating the Model\nfrom sklearn.metrics import classification_report, confusion_matrix, accuracy_score","a2bc2e08":"accuracy_score(y_test, y_pred)","7e974c42":"confusion_matrix(y_test, y_pred)","2ff1ef52":"print(classification_report(y_test, y_pred))","2f93fb3a":"#Elbow Method for Choosing Reasonable K Values\ntest_error_rate=[]\n\nfor k in range (1, 20):\n    knn_model = KNeighborsClassifier(n_neighbors=k)\n    knn_model.fit(scaled_X_train, y_train)\n    \n    y_pred_test = knn_model.predict(scaled_X_test)\n    \n    test_error=1- accuracy_score(y_test, y_pred_test)\n    test_error_rate.append(test_error)","7efd4145":"test_error_rate","a58632e3":"plt.figure(figsize=(10, 6))\nplt.plot(range(1, 20), test_error_rate, label='Test Error')\nplt.legend()\nplt.ylabel('Error Rate')\nplt.xlabel('K Value')","d4afb408":"# Creating a Pipeline to find K value\nscaler= StandardScaler()","08c1ca9e":"knn= KNeighborsClassifier()","4e9316de":"knn.get_params().keys()","bd69e6e6":"operations= [('scaler', scaler), ('knn', knn)]","f39807f4":"from sklearn.pipeline import Pipeline","af889419":"pipe= Pipeline(operations)","8db5ae4c":"from sklearn.model_selection import GridSearchCV","c9894d7c":"k_values= list(range(1, 20))","bc2e0c5d":"param_grid= {'knn__n_neighbors': k_values}","8b90a677":"full_cv_classifier= GridSearchCV(pipe, param_grid, cv=5, scoring='accuracy')","47413e1c":"full_cv_classifier.fit(X_train, y_train)","cbe79224":"full_cv_classifier.best_estimator_.get_params()","6d1bc6aa":"**The average of model accuracy is %93**","0b1af2ab":"**By elbow method and viewing the chart** **, we understand that Reasonable K Value is one.**","7d6b4f8e":"The Label value counts are balanced.","fdcb7f11":"**This method also shows the best k value is 1**","5c9f96c7":"**EDA**","5464c787":"**Data Set Information:**\n\u200b\nThe file \"sonar.mines\" contains 111 patterns obtained by bouncing sonar signals off a metal cylinder at various angles and under various conditions. The file \"sonar.rocks\" contains 97 patterns obtained from rocks under similar conditions. The transmitted sonar signal is a frequency-modulated chirp, rising in frequency. The data set contains signals obtained from a variety of different aspect angles, spanning 90 degrees for the cylinder and 180 degrees for the rock.\n\u200b\nEach pattern is a set of 60 numbers in the range 0.0 to 1.0. Each number represents the energy within a particular frequency band, integrated over a certain period of time. The integration aperture for higher frequencies occur later in time, since these frequencies are transmitted later during the chirp.\n\u200b\nThe label associated with each record contains the letter \"R\" if the object is a rock and \"M\" if it is a mine (metal cylinder). The numbers in the labels are in increasing order of aspect angle, but they do not encode the angle directly.\n\u200b","c6df4cb4":"From the comparisan between the prediction data and actual data,it seems the model works properly. "}}