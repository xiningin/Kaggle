{"cell_type":{"a2526fb1":"code","4d2434d5":"code","8c38a844":"code","5ec8c7af":"code","cce9864c":"code","150942dd":"code","335157fb":"code","bb282dad":"code","f8b76049":"markdown","2acd2edb":"markdown","b5ec7708":"markdown","7d2eed88":"markdown"},"source":{"a2526fb1":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport os, glob, pickle, time, gc, copy, sys\nimport warnings\nfrom tqdm import tqdm\nfrom sklearn import metrics\n\ntqdm.pandas()\nwarnings.filterwarnings('ignore')\npd.set_option('display.max_columns', 100)","4d2434d5":"df_train = pd.read_csv(\"..\/input\/rsna-miccai-brain-tumor-radiogenomic-classification\/train_labels.csv\")\nprint('len(df_train): {}'.format(len(df_train)))\nprint(\"df_train['MGMT_value'].mean(): {:.6f}\".format(df_train['MGMT_value'].mean()))\ndf_train.head()","8c38a844":"df_test = pd.read_csv(\"..\/input\/rsna-miccai-brain-tumor-radiogenomic-classification\/sample_submission.csv\")\nprint('len(df_test): {}'.format(len(df_test)))\ndf_test.head()","5ec8c7af":"# assume that positive rate of the test data is same with the train data.\nnum_positive = int(len(df_test)*df_train['MGMT_value'].mean())\nprint(\"num_positive: {}\".format(num_positive))","cce9864c":"# make true labels\ny_true = np.zeros(len(df_test))\ny_true[:num_positive] = 1\nprint(\"y_true.mean(): {:.6f}\".format(y_true.mean()))","150942dd":"# make random prediction\ny_pred = np.random.rand(len(df_test))\ny_pred","335157fb":"# calculate the score\nfrom sklearn import metrics\nscore = metrics.roc_auc_score(y_true, y_pred)\nprint(\"score: {:.6f}\".format(score))","bb282dad":"# try random prediction 1000 times.\nscores = []\nfor i in range(100):\n    np.random.seed(i)\n    y_pred = np.random.rand(len(df_test))\n    score = metrics.roc_auc_score(y_true, y_pred)\n    scores.append(score)\ndf_score = pd.DataFrame(scores, columns=['score'])\ndf_score = df_score.sort_values('score').reset_index(drop=True)\nplt.hist(df_score['score'], bins=10)\nplt.show()\ndf_score.tail()","f8b76049":"The public test data has only 87 samples. So that, the public LB score must be unstable. I check it below.","2acd2edb":"# Data loading","b5ec7708":"The simulations above shows that a score of about 0.65 is almost by chance. Don't believe the public LB score too much. ","7d2eed88":"# Public LB simulation"}}