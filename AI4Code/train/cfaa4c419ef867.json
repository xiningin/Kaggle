{"cell_type":{"040638fd":"code","0a6cf1f3":"code","12bec59d":"code","4270ea38":"code","ff1919c5":"code","99aa7eba":"code","c295d036":"code","de7b332a":"code","f6d2e51c":"code","f9f81d3d":"code","f01145bc":"code","15d62974":"code","57ffb08f":"code","b0f06e3f":"code","c1a3db8f":"code","4dfc1913":"code","ce490e97":"code","a83b5218":"code","8e7e0835":"code","09bde695":"code","bacb0cf7":"code","cb8da6b1":"markdown","998bf1e9":"markdown"},"source":{"040638fd":"import pandas as pd\nfrom pathlib import Path\n\ndata_dir = Path('..\/input\/tabular-playground-series-sep-2021\/')\n\ndf_train = pd.read_csv(\n    data_dir \/ \"train.csv\",\n    index_col='id',\n    nrows=25000,  # comment this row to use the full dataset\n)\n\nFEATURES = df_train.columns[:-1]\nTARGET = df_train.columns[-1]\n\ndf_train.head()","0a6cf1f3":"!pip install pycaret[full]","12bec59d":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom pycaret.classification import *","4270ea38":"train = pd.read_csv('..\/input\/tabular-playground-series-sep-2021\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-sep-2021\/test.csv')\n\ndata = pd.concat([train, test])","ff1919c5":"df_data = data.drop(columns = 'id')\n","99aa7eba":"plt.figure(figsize = (12, 6))\nmissing_values = df_data.isnull().sum()[:-1]\nsns.histplot(missing_values, color='violet');\nplt.show()","c295d036":"print('\\n')\nprint('-------- Distribution of Missing values --------')\nprint('Min:', missing_values.min())\nprint('Max:', missing_values.max())\nprint('Mean:', missing_values.mean())\nprint('------------------------------------------------')","de7b332a":"df_data.describe","f6d2e51c":"train2 = df_data[:len(train)]\ntest2 = df_data[len(train):]\ntest2.drop(columns = 'claim', inplace = True)","f9f81d3d":"from pycaret.classification import *\nclf = setup(data=train2, target = 'claim', session_id=42, log_experiment=True,numeric_imputation = 'mean',normalize = True,\n        normalize_method = 'robust',fold = 3,\n        silent= True,\n        use_gpu=True,)","f01145bc":"cat = create_model(estimator = 'catboost', fold = 5)\n    ","15d62974":"lgbm = create_model(estimator = 'lightgbm', fold = 5)\n","57ffb08f":"xgb = create_model(estimator = 'xgboost', fold = 5)\n","b0f06e3f":"boosted_lgbm = ensemble_model(lgbm, method = 'Boosting')\n","c1a3db8f":"blender = blend_models(estimator_list = [cat,lgbm,xgb], fold=5)\n","4dfc1913":"pred_holdout = predict_model(blender)","ce490e97":"final_model = finalize_model(blender)","a83b5218":"prep_pipe = get_config('prep_pipe')\nprep_pipe.steps.append(['trained_model', final_model])\npred = prep_pipe.predict_proba(test2)","8e7e0835":"sub = pd.read_csv('..\/input\/tabular-playground-series-sep-2021\/sample_solution.csv')\nsub","09bde695":"result=pred","bacb0cf7":"sub['claim'] = result[:, 1]\nsub.to_csv('sub.csv', index = 0)","cb8da6b1":"**Import libraries**","998bf1e9":"# Using Pycaret Tabular Playground Competition! #\n\n"}}