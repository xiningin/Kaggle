{"cell_type":{"0f9b6196":"code","8125bd44":"code","5a83f3d1":"code","033bd6e3":"code","1f86f8d0":"code","27a3517e":"code","62c54836":"code","fdbc2758":"code","cfa49d70":"code","1e1a9f10":"code","c98aa252":"code","ca7571c2":"code","1f45600e":"code","c4cf2f5b":"code","edbf37da":"code","d60bd718":"code","cce3079f":"code","5fb5a821":"code","da78a3f1":"code","c00a0076":"code","0130b52c":"code","e32db2ff":"code","0b7071eb":"code","79aca014":"code","3babc51b":"code","cc3d3fa1":"code","6aeceeeb":"markdown","be16d19c":"markdown","460431bf":"markdown","c18a8b7c":"markdown","66aed041":"markdown","4ff30761":"markdown"},"source":{"0f9b6196":"import os\nimport numpy as np\nimport pandas as pd\nfrom pandas.tools.plotting import lag_plot,autocorrelation_plot\n\nimport matplotlib as mpl\nfrom matplotlib import pyplot as plt\nimport seaborn as sns","8125bd44":"os.listdir(\"..\/input\")","5a83f3d1":"temp_dic = pd.read_excel('..\/input\/daily-minimum-temperatures-in-me.xlsx',sheet_name=['Temperature'],parse_dates=['Date'])","033bd6e3":"df = pd.DataFrame(temp_dic['Temperature'])\ndf.set_index(['Date'],inplace=True)\ndf.sample(5)","1f86f8d0":"df.info()","27a3517e":"df.plot(figsize=(15,5))","62c54836":"lag_plot(df)\n#Clearly show some correlation","fdbc2758":"df_corr = pd.concat([df.shift(1),df],axis=1)","cfa49d70":"df_corr.columns=['t-1','t+1']","1e1a9f10":"df_corr.corr(method=\"pearson\")","c98aa252":"sns.heatmap(df_corr.corr(method=\"pearson\"),cmap=\"Blues\",annot=True)\n#Shows strong positive Correlation","ca7571c2":"plt.figure(figsize=(10,10))\nautocorrelation_plot(df)","1f45600e":"from statsmodels.tsa.ar_model import AR\nfrom sklearn.metrics import mean_squared_error","c4cf2f5b":"X = df.values","edbf37da":"train,test = X[1:len(X)-7],X[len(X)-7:]","d60bd718":"print(train.shape)\nprint(test.shape)","cce3079f":"model = AR(train)\nmodel_fit= model.fit()","5fb5a821":"window = model_fit.k_ar #Variables\ncoeff = model_fit.params # Coefficients\n#Linear Regression - y= bX1 + bX2 ... + bXn","da78a3f1":"history = train[len(train) - window:]","c00a0076":"len(train) - 29","0130b52c":"history","e32db2ff":"history = [history[i] for i in range(len(history))]","0b7071eb":"history","79aca014":"predictions=[]\n\nfor t in test:\n    length = len(history)\n    lag = [history[i] for i in range(length-window,length)]\n    y = coeff[0]\n    for d in range(window):       \n        y += coeff[d + 1] * lag[window - d - 1]\n        #print(coeff[d + 1] * lag[window - d - 1])\n    predictions.append(y)\n    history.append(t)\n    print(f\"Predicted :{y} and expected value:{t}\")","3babc51b":"mean_squared_error(test,predictions)","cc3d3fa1":"plt.plot(test,label='actual')\nplt.plot(predictions,label='predicted')\nplt.legend()","6aeceeeb":"**Auto Correlation Plot**\n\nX Axis - Lag Number\n\nY Axis - Correlation Coefficient - -1 to +1\n\nDashed Lines- 95% Confidence\n\nSolid Lines- 99% Confident\n\nMore significant are the ones above the lines than those below","be16d19c":"Credits to Jason\nhttps:\/\/machinelearningmastery.com\/autoregression-models-time-series-forecasting-python\/    ","460431bf":"Regression Model uses the data from same input variable at previous time steps - **Auto Regression**\n\nInput variables taken as observations at previous time step - **Lag variables**\n\nRelationship between variables is **correlation**,  variables change in same direction - **Postivie correlation** and if goes in opposite direction -** Negative Correlation**\n\nCorrelation calculated between the variable and itself at previous time steps - **Auto Correlation** (Serial Correlation)\n\nBased on the correlation between the Lag variable and output variable the model will be built\n\nDataset - minimum daily temperatures over 10 years (1981-1990) in the city Melbourne, Australia.","c18a8b7c":"Visual check of correlation by plotting the scatter plot against the previous and next time step\nPandas built in plot - Lagplot - to do visual check","66aed041":"**Auto Regression Model**\nPredict the Weather of the Last 7 Days\n\nAR modeling from statsmodels\nNumber of Coefficients learned by the model used for manual prediction \nBy the count of the coefficients the history observations retrived to make prediction","4ff30761":"#### Correlation Coefficents"}}