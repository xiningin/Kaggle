{"cell_type":{"792edd0b":"code","7cbd81f2":"code","d8a77450":"code","97d1445c":"code","aed15066":"code","08a6f001":"code","d2b17659":"code","c5248ac2":"code","1f70bcbd":"code","18c6e3ab":"code","b589fdfe":"code","641e7547":"code","8cbafb57":"code","7b2acba1":"code","7e2e83f7":"code","8a4fb454":"code","87027084":"code","0886421b":"code","99245fc2":"code","fa5296bd":"code","80486a1b":"code","d9282274":"code","fdc3994d":"code","ae65f9a5":"code","13c04f15":"code","d5cc3123":"code","db8dac24":"code","f468dca1":"code","773eec26":"code","ba597cc9":"code","927dea35":"code","75d316e0":"code","3e3f65e2":"code","eafb16df":"code","ccb4e0d1":"code","9f0977dc":"code","52501246":"code","91fdcdab":"code","a0af07ca":"code","6d9924bc":"code","b14fc7d1":"code","3af0893b":"code","63d6f398":"code","2a3482ce":"code","acbf5718":"code","699de9a4":"code","3b5195b4":"code","25161fad":"code","0fcc64b4":"code","fd0b7c29":"code","7a7dea35":"code","23f05920":"code","05591208":"code","4798d126":"code","15fbdad4":"code","503cb6c0":"code","23d3d6da":"code","d4325a5b":"code","e3d1061f":"code","05511039":"code","f8509a2d":"code","8b77de5b":"code","0dfc01e4":"code","b0b2420a":"code","8c13692d":"code","bf99461f":"code","194e17bb":"code","d77245b6":"code","1607829c":"code","641ccc92":"code","63d5bfdc":"code","b7d2e02e":"code","48695d85":"markdown","ec0c68cf":"markdown","8a3754ca":"markdown","cdc774a3":"markdown","9d0f8cb4":"markdown","d9c18349":"markdown","15eab174":"markdown","b10017f4":"markdown","6ef2cf6a":"markdown","0265951c":"markdown","82e35e12":"markdown","4c0a3398":"markdown","058b8610":"markdown","d7816c2a":"markdown","195c55f6":"markdown","63c49180":"markdown","5377a9f4":"markdown","23e6b06b":"markdown","c3793e84":"markdown","9d946c31":"markdown"},"source":{"792edd0b":"import pandas as pd                                         #importing the libraries\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom sklearn import datasets\nimport sklearn\nfrom pandas import DataFrame\nfrom pandas.plotting import scatter_matrix\nfrom pandas_profiling import ProfileReport\nfrom scipy.cluster.hierarchy import linkage, dendrogram, cut_tree\nimport warnings\nwarnings.filterwarnings('ignore')","7cbd81f2":"stores=pd.read_csv(\"E:\\python\\Spark_foundations\\SampleSuperstore.csv\")        #importing the dataset","d8a77450":"stores.head()         #first 5 observations of dataset","97d1445c":"stores.tail()      #last 5 observation of dataset","aed15066":"stores.nunique()      #unique values in dataset store","08a6f001":"stores.columns            #nos. of column in dataset","d2b17659":"stores['Ship Mode'].unique()                 #values of Ship Mode","c5248ac2":"stores['Segment'].unique()                  #values of segment","1f70bcbd":"stores['Country'].unique()                   #Country","18c6e3ab":"stores['City'].unique()                  #Cities in country","b589fdfe":"stores['State'].unique()                     #States in country","641e7547":"stores['Postal Code'].unique()              #postal code of cities","8cbafb57":"stores['Region'].unique()                      #regions in country","7b2acba1":"stores['Sub-Category'].unique()                 #subcategory of products","7e2e83f7":"stores['Category'].unique()                       #category of products","8a4fb454":"stores['Sales'].unique()","87027084":"stores['Sales'].mean()                  #mean of sales","0886421b":"stores['Sales'].mode()               #mode of sales","99245fc2":"stores['Quantity'].unique()          #quantity","fa5296bd":"stores['Quantity'].mean()             #mean of quantity saled","80486a1b":"stores['Quantity'].mode()","d9282274":"stores['Profit'].unique()            ","fdc3994d":"stores['Profit'].mean()               #mean of profit","ae65f9a5":"stores['Discount'].unique()              ","13c04f15":"stores['Discount'].mean()                  #mean of discount","d5cc3123":"stores.value_counts()                     #valuecounts of dataset","db8dac24":"stores.isnull()            #checking missing values,if any","f468dca1":"stores.isnull().sum()                 #sum of missing values,if any","773eec26":"stores.info()           #info about dataset","ba597cc9":"stores.describe()        # summary statistics","927dea35":"stores.shape                   #shape of datset","75d316e0":"print(\"Columns: \", len(stores.columns))","3e3f65e2":"print(\"Rows: \", len(stores))","eafb16df":"stores.groupby('Profit').sum()['Sales']                    #profit vs sales","ccb4e0d1":"stores.groupby('Discount').sum()['Sales']                 #Discounts vs sales","9f0977dc":"stores.groupby('Quantity').sum()['Sales']                  #quantity vs sales","52501246":"stores.groupby('Ship Mode').sum()['Sales']                  #shipping mode used to sell the products","91fdcdab":"stores.groupby('Category').sum()['Sales']                     #Category of items suppied for sales","a0af07ca":"stores.groupby('Postal Code').sum()['Sales']","6d9924bc":"stores.groupby('Region').sum()['Sales']                    #regions vs sales","b14fc7d1":"stores.groupby('City').sum()['Sales']                         #city vs sales","3af0893b":"stores.groupby('State').sum()['Sales']","63d6f398":"stores.groupby('Region').sum()['Sales'].plot.bar()            \nplt.xticks(rotation = 0)\nplt.tight_layout()\nplt.show()","2a3482ce":"stores.groupby('State').sum()['Sales'].plot.bar()\nplt.xticks(rotation = 0)\nplt.tight_layout()\nplt.show()","acbf5718":"stores.groupby('Category').sum()['Sales'].plot.bar()\nplt.xticks(rotation = 0)\nplt.tight_layout()\nplt.show()","699de9a4":"stores.groupby('Segment').sum()['Sales'].plot.bar()\nplt.xticks(rotation = 0)\nplt.tight_layout()\nplt.show()","3b5195b4":"stores.groupby('City').sum()['Sales'].plot.bar()\nplt.xticks(rotation = 0)\nplt.tight_layout()\nplt.show()","25161fad":"stores.groupby('Sub-Category').sum()['Sales'].plot.bar()\nplt.xticks(rotation = 0)\nplt.tight_layout()\nplt.show()","0fcc64b4":"sns.distplot(stores[\"Sales\"],bins=30)                          #distribution plot of sales","fd0b7c29":"sns.distplot(stores[\"Discount\"],bins=30)             #distribution of Discount","7a7dea35":"sns.distplot(stores[\"Profit\"],bins=30)                       #distribution of profit","23f05920":"sns.distplot(stores[\"Quantity\"],bins=30)                 ","05591208":"stores.hist()                                #histplot\nplt.show()","4798d126":"scatter_matrix(stores)                         #scatter plot\nplt.figure(figsize=(8,10))\nplt.show()","15fbdad4":"stores.plot(kind = 'box', subplots='True', sharex= 'False', sharey='False')                #dendogram\nplt.show()","503cb6c0":"sns.pairplot(stores)                           #pairplot of variables","23d3d6da":"profile = ProfileReport(stores, title=\"Sale Superstore\", explorative=True)\nprofile","d4325a5b":"city = stores.groupby(\"City\").sum().sort_values(\"Sales\", ascending = False).head(15)\ncity = city[[\"Sales\"]].round(2)\ncity.reset_index(inplace = True)\ncity","e3d1061f":"plt.title(\"Top 15 Cities which generated Highest Sales\", fontsize=16)\nplt.bar(city[\"City\"], city[\"Sales\"],color= 'Orange',edgecolor='brown', linewidth = 2)\nplt.xlabel(\"Cities\",fontsize=10)  \nplt.ylabel(\"Sales\",fontsize=10)\nplt.xticks(fontsize=10, rotation=90)\nplt.yticks(fontsize=10)\nplt.figure(figsize = (10,6)) \nplt.show()","05511039":"segment = stores.groupby(\"Segment\").sum()\nsegment = segment[[\"Sales\"]]\nsegment.reset_index(inplace = True)\nsegment","f8509a2d":"total_revenue = segment[\"Sales\"].sum() \ntotal_revenue = str(int(total_revenue))\ntotal_revenue = \"$\" + total_revenue\ntotal_revenue # this is our total revenue","8b77de5b":"# The function which helps us to annotate the values in our donut or pie chart\ndef make_autopct(values):\n    def my_autopct(pct):\n        total = sum(values)\n        val = int(round(pct*total\/100.0))\n        return  \"${v:d}\".format(p=pct,v=val)\n    return my_autopct","0dfc01e4":"# Creating a donut chart.\ncenter = [5]\nplt.pie(segment['Sales'], labels = segment['Segment'],colors =['Pink','Blue','Green'], \n        radius = 1.5, explode = [0.05,0.05,0.05], autopct = make_autopct(segment[\"Sales\"]))\nplt.pie(center, radius = 1.25, colors = \"white\")\nlabel = plt.annotate('Total Revenue \\n' + total_revenue, color = 'red', xy=(0, 0)\n                     ,fontsize=12, ha=\"center\")\nplt.tight_layout()\nplt.title(\"The sales based on the Segment\", pad = 60, size = 25, color = \"green\")\nplt.show()","b0b2420a":"shipmode = stores.groupby(\"Ship Mode\").sum()\n\nshipmode = shipmode[[\"Sales\"]]\n\nshipmode.reset_index(inplace = True)\n\nshipmode","8c13692d":"#Donut Chart\ncenter = [6]\nplt.figure(figsize = (6,6))\nplt.pie(shipmode['Sales'], labels = shipmode['Ship Mode'],colors = ['Red','Blue','Pink',\"Green\"], \n        radius = 2, autopct= make_autopct(shipmode[\"Sales\"]))\nplt.pie(center, radius = 1.7, colors = \"white\")\nplt.title(\"The sales based on the Ship Mode\", pad = 80, size = 25, color = \"darkblue\")\nplt.tight_layout()\nplt.show()","bf99461f":"subcat = stores.groupby(\"Sub-Category\").sum().sort_values(\"Sales\" , ascending = False).head()\nsubcat = subcat[[\"Sales\"]].round(2)\nsubcat.reset_index(inplace = True)\nsubcat","194e17bb":"state = ['Alabama', 'Arizona' ,'Arkansas', 'California', 'Colorado', 'Connecticut', 'Delaware', 'Florida', \n         'Georgia', 'Hawaii', 'Idaho', 'Illinois', 'Indiana', 'Iowa', 'Kansas', 'Kentucky', 'Louisiana', 'Maine', 'Maryland',\n         'Massachusetts', 'Michigan', 'Minnesota', 'Mississippi', 'Missouri', 'Montana','Nebraska', 'Nevada', 'New Hampshire',\n         'New Jersey', 'New Mexico', 'New York', 'North Carolina', 'North Dakota', 'Ohio', 'Oklahoma', 'Oregon', 'Pennsylvania',\n         'Rhode Island', 'South Carolina', 'South Dakota', 'Tennessee', 'Texas', 'Utah', 'Vermont', 'Virginia', 'Washington',\n         'West Virginia', 'Wisconsin','Wyoming']\nstate_code = ['AL','AZ','AR','CA','CO','CT','DE','FL','GA','HI','ID','IL','IN','IA','KS','KY','LA','ME','MD','MA',\n              'MI','MN','MS','MO','MT','NE','NV','NH','NJ','NM','NY','NC','ND','OH','OK','OR','PA','RI','SC','SD','TN',\n              'TX','UT','VT','VA','WA','WV','WI','WY']","d77245b6":"state = pd.DataFrame(state, state_code) \nstate.reset_index(inplace=True)\nstate.columns = ['State Code','State']\nstate.head()","1607829c":"sales = stores.groupby([\"State\"]).sum().sort_values(\"Sales\", ascending=False)\nsales.reset_index(inplace=True) \nsales.drop('Postal Code',axis = 1, inplace = True)\nsales.head(5)","641ccc92":"sales= sales.sort_values('State', ascending=True)\nsales.reset_index(inplace = True)\nsales.head()","63d5bfdc":"corelation= stores.corr()","b7d2e02e":"fig, ax = plt.subplots(figsize=(10,5))\nsns.heatmap(corelation, xticklabels = corelation.columns, yticklabels = corelation.columns, annot = True)","48695d85":"Sales based on sub-category:","ec0c68cf":"By plotting a correlation matrix, we get a overview of how the features are related to one another","8a3754ca":"California under State generated the maximum profit: $76381,  \nwith given discount: $145.6","cdc774a3":"Phones under subcategory generated the higher sales value: $330007.05","9d0f8cb4":"data prepration and preprocessing ","d9c18349":"# Exploratory Data Analysis: Retail Superstore\n\nProblem:  As a business manager, try to find out the weak areas where you can work to make more profit. What all business problems you can derive by exploring the data?","15eab174":"Vizualization of variables\n","b10017f4":"Sales based on segment:","6ef2cf6a":"Profile Report using pandas profile feature: This gives us a detailed picture of EDA all together. ","0265951c":"Sales based on Stores:","82e35e12":"Top 15 Cities which generated Highest Sales:","4c0a3398":"Standard class generated: $1358216","058b8610":"Exploratory Data Analysis is a process of examining or understanding the data and extracting insights or main characteristics of the data. EDA is generally classified into two methods, i.e. graphical analysis and non-graphical analysis.\nEDA is very essential because it is a good practice to first understand the problem statement and the various relationships between the data features.","d7816c2a":"Total Revenue generated segments wise:","195c55f6":"Consumer segment generated the higher revenue: $1161401","63c49180":"Segnent vs sales:","5377a9f4":"Dataset: https:\/\/bit.ly\/3i4rbWl","23e6b06b":"The Total Revenue generated by all the shipping modes - $2297200","c3793e84":"Sales based on shipmode:","9d946c31":"Correlation matrix among the variables:"}}