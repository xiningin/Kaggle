{"cell_type":{"8ad4493f":"code","2bbde818":"code","b91a0101":"code","889e9189":"code","56bb76fe":"code","61570471":"code","26641dd6":"code","d8158c1e":"markdown","6a0d5ba2":"markdown","387f2847":"markdown","bdc3d816":"markdown","5617dd68":"markdown","02c3138f":"markdown","4628da00":"markdown"},"source":{"8ad4493f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","2bbde818":"data=pd.read_csv('..\/input\/pulsar_stars.csv')\ndata.sample(5)\n","b91a0101":"cols=data.columns\nfor col in cols:\n    print('Column:' + str(col))\n    print(np.corrcoef(data['target_class'],data[col]))","889e9189":"d=pd.get_dummies(data['target_class'])\ndata=pd.concat([data,d],axis=1)\ndata.drop('target_class',axis=1,inplace=True)\ndata.head()","56bb76fe":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test=train_test_split(data.drop([0,1],axis=1),data[[0,1]],test_size=0.2)","61570471":"!pip install keras-metrics","26641dd6":"from keras.models import Sequential\nfrom keras.layers import Dense, Activation, Dropout\nfrom keras.optimizers import adam\nimport keras_metrics as km\nmodel=Sequential()\nfor i in range(0,4):\n    model.add(Dense(100,input_shape=(8,),activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(64,input_shape=(8,),activation='relu'))\nmodel.add(Dense(64,input_shape=(8,),activation='relu'))\nmodel.add(Dense(64,input_shape=(8,),activation='relu'))\nmodel.add(Dense(64,input_shape=(8,),activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(32,input_shape=(8,),activation='relu'))\nmodel.add(Dense(32,input_shape=(8,),activation='relu'))\nmodel.add(Dense(32,input_shape=(8,),activation='relu'))\nmodel.add(Dense(32,input_shape=(8,),activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(2,activation='softmax'))\nprint('Model summary: ')\nmodel.summary()\nprint('')\nopt = adam(lr=0.001, decay=1e-6)\nmodel.compile(\n    loss='categorical_crossentropy',\n    optimizer=opt,\n    metrics=['accuracy',km.precision(),km.recall()])\nprint('Model fitting...')\nmodel.fit(x_train,y_train, epochs=20, batch_size=32)\nscore=model.evaluate(x_test,y_test)\nprint('Accuracy(on Test-data): ' + str(score[1]))\n","d8158c1e":"<center><font size=4px>Encoding the target class<\/font><\/center>","6a0d5ba2":"<center><font size=4px>A look at the data<\/font><\/center>","387f2847":"<center><font size=4px>Correlation of columns<\/font><\/center>","bdc3d816":"<center><font size=4px>Neural network construction<\/font><\/center>","5617dd68":"<b>A pulsar is a highly magnetized rotating neutron star or white dwarf that emits a beam of electromagnetic radiation. This radiation can be observed only when the beam of emission is pointing toward Earth (much like the way a lighthouse can be seen only when the light is pointed in the direction of an observer), and is responsible for the pulsed appearance of emission.<\/b>\n\n<img src='https:\/\/upload.wikimedia.org\/wikipedia\/commons\/thumb\/a\/a6\/PIA18848-PSRB1509-58-ChandraXRay-WiseIR-20141023.jpg\/223px-PIA18848-PSRB1509-58-ChandraXRay-WiseIR-20141023.jpg'><\/img>","02c3138f":"<center><font size=4px>Making test-set<\/font><\/center>","4628da00":"<center><font size=4px>We have also achieved high precision & recall values. Since the data was heavily skewed, we can use F1 score = (2*P*R)\/(P+R) for accurate measurement of our model's performance! <br>Suggestions & feedback always welcomed.<\/font><\/center>"}}