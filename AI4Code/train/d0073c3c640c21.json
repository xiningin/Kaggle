{"cell_type":{"d2ee11bc":"code","a9baa46c":"code","8765aefd":"code","3301385e":"code","67c04846":"code","652bbd9d":"code","e39116d6":"code","8cdb2f82":"code","1b53e1a8":"code","a10d0b61":"code","889112cb":"code","9479c799":"code","ea88a6cc":"code","53560791":"code","3eb9eda2":"markdown"},"source":{"d2ee11bc":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a9baa46c":"# import os\n# for dirname, _, filenames in os.walk('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/train\/NORMAL'):\n#     for filename in filenames:\n#         print(os.path.join(dirname, filename))\n\n# # \/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/train\/\n# \/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/train\/PNEUMONIA\/person1230_virus_2081.jpeg\n# \/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/train\/PNEUMONIA\/person1513_virus_2632.jpeg\n# \/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/train\/PNEUMONIA\/person124_virus_238.jpeg\n# \/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/train\/NORMAL\/NORMAL2-IM-1301-0001.jpeg\n# \/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/train\/NORMAL\/NORMAL2-IM-0428-0001.jpeg\n# \/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/train\/NORMAL\/NORMAL2-IM-1318-0001.jpeg","8765aefd":"# import IPython.display as display\n# from PIL import Image\n# image_path = '\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/train\/NORMAL\/NORMAL2-IM-1318-0001.jpeg'\n# display.display(Image.open(image_path))","3301385e":"from keras.preprocessing.image import ImageDataGenerator\n\ntrain_datagen = ImageDataGenerator(\n        rescale=1.\/255,\n        shear_range=0.2,\n        zoom_range=0.2,\n        horizontal_flip=True)\n\n\n\ntraining_set = train_datagen.flow_from_directory(\n                                                '\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/train\/',\n                                                target_size=(64, 64),\n                                                batch_size=32,\n                                                class_mode='sparse')","67c04846":"test_datagen = ImageDataGenerator(rescale=1.\/255)\ntesting_set = test_datagen.flow_from_directory(\n                                                '\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/test\/',\n                                                target_size=(64, 64),\n                                                batch_size=32,\n                                                class_mode='sparse')","652bbd9d":"from keras.models import Sequential\nfrom keras.layers import Convolution2D\nfrom keras.layers import MaxPooling2D\nfrom keras.layers import Flatten\nfrom keras.layers import Dense\n\n\nclassifier = Sequential()\n\nclassifier.add(Convolution2D(32,3,3,input_shape = (64,64,3), activation = 'relu'))\n\nclassifier.add(MaxPooling2D(pool_size = (2,2)))\n\nclassifier.add(Flatten())\n\nclassifier.add(Dense(128, activation='relu'))\n\nclassifier.add(Dense(1, activation='sigmoid'))\n\nclassifier.compile(optimizer = 'adam',loss= 'binary_crossentropy' , metrics = ['accuracy'])\n","e39116d6":"classifier.fit_generator(training_set,steps_per_epoch=50,epochs=10,\n                            validation_data=testing_set,\n                            validation_steps=1)","8cdb2f82":"training_set.class_indices","1b53e1a8":"val_datagen = ImageDataGenerator(rescale=1.\/255)\nval_set = val_datagen.flow_from_directory(\n                                                '\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/val\/',\n                                                target_size=(64, 64),\n                                                batch_size=32,\n                                                class_mode='sparse')\nval_set","a10d0b61":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/val\/PNEUMONIA'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","889112cb":"for dirname, _, filenames in os.walk('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/val\/NORMAL'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","9479c799":"import numpy as np\nfrom keras.preprocessing import image\none_img = image.load_img('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/val\/PNEUMONIA\/person1947_bacteria_4876.jpeg',target_size = (64,64))\n\nimg_array = np.asarray(one_img, dtype='int64')\nimg_array = np.expand_dims(one_img, axis = 0)\nimg_array = img_array \/ 255     \n\nimg_result = classifier.predict_classes(img_array)\nimg_result","ea88a6cc":"#epochs = 3 -- val_accuracy=~82\nclasses = classifier.predict_classes(val_set) \nclasses","53560791":"#epochs = 10 ---  val_accuracy=~93.75\npred = classifier.predict_classes(val_set) \npred","3eb9eda2":"**uncomment the below code to look at the file names**"}}