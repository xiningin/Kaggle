{"cell_type":{"a0bc32d1":"code","2833afa2":"code","c70131c6":"code","3e91d468":"code","ff52ff65":"code","099cae2b":"code","525f1fd0":"code","cace92fb":"code","6b098523":"code","d559c69b":"code","eb9aec14":"code","a37ce47e":"code","c6408125":"code","412b842c":"code","e4be1053":"code","330fa89e":"code","40fcca40":"code","3cc1dd8d":"code","270c461a":"code","7972d0d8":"code","241524bf":"code","4d9a515b":"code","e6b4c52b":"code","d9945fc4":"code","a4b196c6":"code","5f91e05f":"code","27f39f15":"code","9751495c":"code","d9010a8a":"markdown","122c8e07":"markdown","3c245af3":"markdown","07e7a473":"markdown","8cbe59dc":"markdown","2bc54414":"markdown","b3fe899f":"markdown","78eab55d":"markdown","6d333579":"markdown","5e55cff8":"markdown"},"source":{"a0bc32d1":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","2833afa2":"df = pd.read_csv(\"..\/input\/drug-classification\/drug200.csv\")\ndf.head()","c70131c6":"df.info()","3e91d468":"plt.style.use('ggplot')","ff52ff65":"plt.figure(figsize=(10,8))\nsns.scatterplot(data=df,x='Age',y='Drug')","099cae2b":"query = df.loc[ df['Drug'] == 'DrugY']\nprint(query.describe())\nprint('-'*100)\nprint(query.describe(include=['O']))","525f1fd0":"fig = plt.figure(figsize=(20,20))\nplt.subplot(511)\nplt.hist(query['Age'],bins=20)\nplt.title('Age')\nplt.subplot(512)\nplt.title('Sex')\nplt.hist(query['Sex'])\nplt.subplot(513)\nplt.title('Na to k ')\nplt.hist(query['Na_to_K'])\nplt.subplot(514)\nplt.title('BP')\nplt.hist(query['BP'])\nplt.subplot(515)\nplt.title('Cholesterol')\nplt.hist(query['Cholesterol'])","cace92fb":"query = df.loc[ df['Drug'] == 'drugC']\nprint(query.describe())\nprint('-'*100)\nprint(query.describe(include=['O']))","6b098523":"fig = plt.figure(figsize=(20,20))\nplt.subplot(511)\nplt.hist(query['Age'],bins=20)\nplt.title('Age')\nplt.subplot(512)\nplt.title('Sex')\nplt.hist(query['Sex'])\nplt.subplot(513)\nplt.title('Na to k ')\nplt.hist(query['Na_to_K'])\nplt.subplot(514)\nplt.title('BP')\nplt.hist(query['BP'])\nplt.subplot(515)\nplt.title('Cholesterol')\nplt.hist(query['Cholesterol'])","d559c69b":"query = df.loc[ df['Drug'] == 'drugX']\nprint(query.describe())\nprint('-'*100)\nprint(query.describe(include=['O']))","eb9aec14":"fig = plt.figure(figsize=(20,20))\nplt.subplot(511)\nplt.hist(query['Age'],bins=20)\nplt.title('Age')\nplt.subplot(512)\nplt.title('Sex')\nplt.hist(query['Sex'])\nplt.subplot(513)\nplt.title('Na to k ')\nplt.hist(query['Na_to_K'])\nplt.subplot(514)\nplt.title('BP')\nplt.hist(query['BP'])\nplt.subplot(515)\nplt.title('Cholesterol')\nplt.hist(query['Cholesterol'])","a37ce47e":"query = df.loc[ df['Drug'] == 'drugA']\nprint(query.describe())\nprint('-'*100)\nprint(query.describe(include=['O']))","c6408125":"fig = plt.figure(figsize=(20,20))\nplt.subplot(511)\nplt.hist(query['Age'],bins=20)\nplt.title('Age')\nplt.subplot(512)\nplt.title('Sex')\nplt.hist(query['Sex'])\nplt.subplot(513)\nplt.title('Na to k ')\nplt.hist(query['Na_to_K'])\nplt.subplot(514)\nplt.title('BP')\nplt.hist(query['BP'])\nplt.subplot(515)\nplt.title('Cholesterol')\nplt.hist(query['Cholesterol'])","412b842c":"query = df.loc[ df['Drug'] == 'drugB']\nprint(query.describe())\nprint('-'*100)\nprint(query.describe(include=['O']))","e4be1053":"fig = plt.figure(figsize=(20,20))\nplt.subplot(511)\nplt.hist(query['Age'],bins=20)\nplt.title('Age')\nplt.subplot(512)\nplt.title('Sex')\nplt.hist(query['Sex'])\nplt.subplot(513)\nplt.title('Na to k ')\nplt.hist(query['Na_to_K'])\nplt.subplot(514)\nplt.title('BP')\nplt.hist(query['BP'])\nplt.subplot(515)\nplt.title('Cholesterol')\nplt.hist(query['Cholesterol'])","330fa89e":"from sklearn.preprocessing import LabelEncoder , MinMaxScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report","40fcca40":"sex_encoder = LabelEncoder()\nsex_encoder.fit(df['Sex'])\ndf['Sex'] = sex_encoder.transform(df['Sex'])","3cc1dd8d":"BP_encoder = LabelEncoder()\nBP_encoder.fit(df['BP'])\ndf['BP'] = BP_encoder.transform(df['BP'])","270c461a":"Cholesterol_encoder = LabelEncoder()\nCholesterol_encoder.fit(df['Cholesterol'])\ndf['Cholesterol'] = Cholesterol_encoder.transform(df['Cholesterol'])","7972d0d8":"Drug_encoder = LabelEncoder()\nDrug_encoder.fit(df['Drug'])\ndf['Drug'] = Drug_encoder.transform(df['Drug'])","241524bf":"print(sex_encoder.classes_)\nprint('-'*10)\nprint(BP_encoder.classes_)\nprint('-'*10)\nprint(Cholesterol_encoder.classes_)\nprint('-'*10)\nprint(Drug_encoder.classes_)","4d9a515b":"features = ['Age' ,\t'Sex' , 'BP' ,\t'Cholesterol' , 'Na_to_K']\nfeatures = df[list(features)]\nlabel = df['Drug'].values","e6b4c52b":"x_train , x_test , y_train , y_test = train_test_split(features,label,test_size=.3)","d9945fc4":"print(\"X train shape: \", x_train.shape)\nprint(\"Y train shape: \", y_train.shape)\nprint(\"X test shape: \", x_test.shape)\nprint(\"Y test shape: \", y_test.shape)","a4b196c6":"model = LogisticRegression()\nmodel.fit(x_train,y_train)\nprint(\"Score is: \",model.score(x_test,y_test)*100)","5f91e05f":"model = MultinomialNB(fit_prior=False)\nmodel.fit(x_train,y_train)\nprint(\"Score is: \",model.score(x_test,y_test)*100)","27f39f15":"model = KNeighborsClassifier(n_neighbors=5)\nmodel.fit(x_train,y_train)\nprint(\"Score is: \",model.score(x_test,y_test)*100)","9751495c":"model = RandomForestClassifier()\nmodel.fit(x_train,y_train)\nprint(\"Score is: \",model.score(x_test,y_test)*100)","d9010a8a":"# Model training","122c8e07":"## drugA\n\nDrug A hasn't a clear age to spread in, but it seems that this drug used from who is between 45 and 50, also males prefers it more than females.\n\nWe will notice that everyone who takes this drug have high levels of blood pressure, some of them have high levels of cholesterol but that didn't mean is this drug have a lot of fat, maybe yes maybe no, it's a small sample to talk about, also we will notice that Na to K rate is very low that's because 99% of drugs have big quantities of K.\n\n","3c245af3":"# Exploratory Data Analysis (EDA)\n\n> this section to know how these drugs work and their effect on the patients.\n\n\n","07e7a473":"## DrugY\n\n\nWhen we look at the description, we will see that this type of drug taken by all people of every age, but we will notice the following:\n\n1. most of those who took this drug is between 28 years and 58 years.\n2. most of those who took this drug are females.\n3. this type of drug leads to high levels of blood pressure and Cholesterol.\n\nNow let's talk about Na to K rate in normal people this rate is between 27.8 Ml\\Liter to 37.5 Ml\\Liter, but here a lot of our patients have high blood pressure, this is because missing a lot of Na, and there isn't enough quantity of K, also there are high levels of Cholesterol, So that's led to high blood pressure, because of that 75% of our patients' rate in their body is 25.8 Ml\\Liter, this low rates because of what I said.\n","8cbe59dc":"## DrugC\n\nThis type of drug is not common and there is no good info about to know a lot of things, there we can't detect which age that prefers this drug but we can talk about his health complications.\n\nWhen we talk about health complications in this dataset and these drugs, we talk about blood pressure, Cholesterol, and Na to K rate.\n\nsurely, these 3 things have a strong relation between them, let us explain how when you look at our patients we will notice high levels of cholesterol this high levels lead to high levels of blood pressure, but actually, there are no high levels of blood pressure that is because the rate of Na to K is too low, I think there were high missing quantities of Na, these missing quantities with high levels of cholesterol leads to high levels of blood pressure, but there the Na to K rate is too low, this because when there's a lot of missing Na quantity the body needs to big quantities of K to prevent Na makes high levels of blood pressure.\n\nSo the health complication for this drug are:\n\n1. leads to high levels of cholesterol\n2. leads to missing big quantities of Na\n3. It contains big quantities of K \n4. leads to low levels of Blood pressure","2bc54414":"## drugB\n\nHere I think what this dataset failed in, 6 features of this small sample for this type of drug, not enough to know what is this drug affects, also I can't find where this drug spread in males or females, or at any age, what I can say is this drug hasn't any fats because that we have low levels of cholesterol, also it contains a big quantity of K, because the Na to K rate is lower than the normal rate, also it makes a high levels of blood pressure, and we don't have any reason to explain this high levels, because we just have  6 features can't include everything we want, maybe this high levels of blood pressure not from the drug, because if you look at the age's graph, we will notice that all who in this sample older than 50 years, and as we know in aging there's a lot of health issues.","b3fe899f":"# ***Drugs health complications [EDA]***\n\n\n![](https:\/\/i0.wp.com\/post.medicalnewstoday.com\/wp-content\/uploads\/sites\/3\/2021\/04\/GettyImages-1301603007_header-1024x575.jpg?w=1155&h=1528)\n\n# Introduction\n\nAfter a long time without any kernels and topics because of exams, I'm back with a new one about drug classification.\n\nAs I have seen while I was working on this dataset, that it included 6 features about the drug, these features weren't enough to know their  Symptoms carefully.\n\nBut as you say always thing better than nothing, now let me tell you more about our features.\n\n1. drug type\n2. age\n3. sex\n4. Blood pressure levels (BP)\n5. Cholesterol levels\n6. Na to Potassium Ration\n\nthe effect of drugs at the patient's health, it may spread like infection like hepatitis and AIDS, that's happened when use the tools of the drug abuser.\n\nNow let's go to our dataset and try find out some info from.","78eab55d":"according to this graph, we can detect every drug prefers, as we notice:\n\n> every ages prefer drug Y\n\n> there isn't a lot of people who prefer drug C\n\n> drug X looks like drug Y, but drug Y superior to drug X\n\n> who is between 20 and 50 prefers drug A\n\n> people who are older than 50 prefer drug B\n","6d333579":"> before I start, I have to make sure that no nulls in our dataset\n","5e55cff8":"## drugX\n\naccording to the description below and the graphs,\nwe can see this drug using a lot for who is in their 20s and 50s, also we can say males prefer this drug more than females.\n\nIf we look at Na to K rate, Blood pressure, and cholesterol, we will find that the second and third one is normal and there are no any issues in them, but the low level of Na to K rate leads us to say there were high missing quantities of Na and there were a lot of K ( read to the end of this section I will talk about what there are big quantities of K makes in our bodies)\n\nSo this drug just has 2 health complication:\n\n1. Missing big quantities of Na\n2. Contains a lot of K"}}