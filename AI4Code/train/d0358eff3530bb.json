{"cell_type":{"cf9c8c3a":"code","bee53e54":"code","30338717":"code","ef8df293":"code","188615b2":"code","2a4f2ae6":"code","ba13815f":"code","cd3d8bb2":"markdown","6129bd25":"markdown","4ab91314":"markdown","3120c10b":"markdown"},"source":{"cf9c8c3a":"import datatable as dt\nimport numpy as np \nimport pandas as pd\n","bee53e54":"train_dt = dt.fread('..\/input\/tabular-playground-series-oct-2021\/train.csv')\ntest_dt  = dt.fread('..\/input\/tabular-playground-series-oct-2021\/test.csv')","30338717":"%%time\nfor i,col in enumerate(train_dt):\n    if col.type.name == 'float64':\n        train_dt[:,i] = dt.as_type(col,'float32')\nfor i,col in enumerate(test_dt):\n    if col.type.name == 'float64':\n        test_dt[:,i] = dt.as_type(col,'float32')\ntrain_dt = train_dt.to_pandas()\ntest_dt = test_dt.to_pandas()","ef8df293":"train_pd = dt.fread('..\/input\/tabular-playground-series-oct-2021\/train.csv').to_pandas()\ntest_pd  = dt.fread('..\/input\/tabular-playground-series-oct-2021\/test.csv').to_pandas()","188615b2":"%%time\nfor col in train_pd.columns:\n    if train_pd[col].dtype == 'float64':\n        train_pd[col] = train_pd[col].astype('float32')\n        test_pd[col] = train_pd[col].astype('float32')","2a4f2ae6":"train_dt.dtypes.value_counts()","ba13815f":"train_pd.dtypes.value_counts()","cd3d8bb2":"# Change data types using datatable","6129bd25":"# Checking that both methods accomplished the desired data type conversion","4ab91314":"Due to the large size of the data for this comp, lots of people are trying to reduce memory usage by changing data types of columns, and most solutions I've seen for that use pandas. I found the pandas way painfully slow though, so after some digging around I've found a much faster way with the datatable package. Enjoy!","3120c10b":"# Change data types using pandas"}}