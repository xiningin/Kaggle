{"cell_type":{"f1e9bf49":"code","dae2498a":"code","027aefd7":"code","773636cc":"code","ffc1151e":"code","174c1e1e":"code","ce382056":"code","f2fd5d31":"code","f0e068ab":"code","5b022bb3":"code","152dc8f7":"code","5057d91f":"code","57312548":"code","83e664fb":"code","115bd6e5":"code","e2231113":"code","e8004219":"code","e3f025a2":"code","8e759706":"code","7f0bb202":"code","26e60681":"code","62178e09":"code","b659548a":"code","4c34ac5c":"code","992e0711":"code","39b32104":"code","41f1f570":"code","6b0af8b1":"code","271180f4":"code","614e9af3":"code","7fea63d4":"code","6ab431f1":"code","400e8789":"code","23936a07":"code","f4d80c32":"markdown","fca36366":"markdown","cc60127f":"markdown","ae752c3e":"markdown","44f80f9b":"markdown","f8e3c750":"markdown","98c93c2f":"markdown","d5174b82":"markdown","e9e9ac7d":"markdown","39bd8c38":"markdown","d6a3f2c5":"markdown","f028fa3e":"markdown","56943b90":"markdown","0a3af783":"markdown","908f186b":"markdown","b03486c0":"markdown","4cdfbccd":"markdown","ed4aec12":"markdown","5b104187":"markdown","a91226bd":"markdown"},"source":{"f1e9bf49":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport chardet\nimport re\nfrom nltk.tokenize import word_tokenize\nfrom nltk.corpus import stopwords\nimport string\nfrom pylab import rcParams\nfrom wordcloud import WordCloud\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom gensim.models import Word2Vec\nfrom sklearn.manifold import TSNE","dae2498a":"with open('\/kaggle\/input\/top50spotify2019\/top50.csv', 'rb') as f:\n    result = chardet.detect(f.read())\n    \n\nsongs_df = pd.read_csv(\"..\/input\/top50spotify2019\/top50.csv\", encoding=result['encoding'])\nlyrics_df = pd.read_csv(\"..\/input\/songs-lyrics\/Lyrics.csv\")","027aefd7":"songs_df.shape","773636cc":"songs_df.head()","ffc1151e":"songs_df = songs_df.drop('Unnamed: 0', axis = 1 )","174c1e1e":"songs_df.info()","ce382056":"lyrics_df.info()","f2fd5d31":"lyrics_df.shape","f0e068ab":"lyrics_df.head()","5b022bb3":"songs_df.describe()","152dc8f7":"songs_categorical_cols = ['Track.Name','Artist.Name','Genre']","5057d91f":"songs_df.describe()","57312548":"rcParams['figure.figsize'] = 10, 20\nsongs_df.drop(songs_categorical_cols,axis=1).hist();","83e664fb":"rcParams['figure.figsize'] = 8, 5\nsns.heatmap(songs_df.drop(songs_categorical_cols,axis=1).corr());","115bd6e5":"sns.pairplot(songs_df.drop(songs_categorical_cols,axis=1));","e2231113":"## Popularity\nsns.boxplot( y = songs_df[\"Popularity\"]);","e8004219":"fig, ax = plt.subplots(1,3)\nfig.subplots_adjust(hspace=0.6, wspace=0.6)\n\nsns.boxplot( y = songs_df[\"Beats.Per.Minute\"], ax=ax[0])\nsns.boxplot( y = songs_df[\"Energy\"], ax=ax[1])\nsns.boxplot( y = songs_df[\"Danceability\"], ax=ax[2])\n\nfig.show()","e3f025a2":"fig, ax = plt.subplots(1,3)\nfig.subplots_adjust(hspace=0.6, wspace=0.6)\n\nsns.boxplot( y = songs_df[\"Loudness..dB..\"], ax=ax[0])\nsns.boxplot( y = songs_df[\"Liveness\"], ax=ax[1])\nsns.boxplot( y = songs_df[\"Valence.\"], ax=ax[2])\n\nfig.show()","8e759706":"fig, ax = plt.subplots(1,3)\nfig.subplots_adjust(hspace=0.8, wspace=0.8)\n\nsns.boxplot( y = songs_df[\"Length.\"], ax=ax[0])\nsns.boxplot( y = songs_df[\"Acousticness..\"], ax=ax[1])\nsns.boxplot( y = songs_df[\"Speechiness.\"], ax=ax[2])\n\nfig.show()","7f0bb202":"rcParams['figure.figsize'] = 10, 8\nwordcloud = WordCloud(\n    width = 3000,\n    height = 2000,\n    background_color = 'black').generate(str(songs_df.Genre.values))\n\nplt.imshow(wordcloud, interpolation = 'bilinear');","26e60681":"rcParams['figure.figsize'] = 10, 8\nwordcloud = WordCloud(\n    width = 3000,\n    height = 2000,\n    background_color = 'black').generate(str(songs_df['Artist.Name'].values))\n\nplt.imshow(wordcloud, interpolation = 'bilinear');","62178e09":"dataset = pd.merge(songs_df, lyrics_df, left_on='Track.Name', right_on='Track.Name')\ndataset['Lyrics'] = dataset['Lyrics'].astype(str)","b659548a":"sns.jointplot(x='Danceability', y='Popularity', \n              data=dataset, kind='scatter');","4c34ac5c":"sns.jointplot(x='Acousticness..', y='Popularity', \n              data=dataset, kind='scatter');","992e0711":"sns.jointplot(x='Loudness..dB..', y='Popularity', \n              data=dataset, kind='scatter');","39b32104":"sns.jointplot(x='Liveness', y='Popularity', \n              data=dataset, kind='scatter');","41f1f570":"rcParams['figure.figsize'] = 15, 8\npopular_genre = dataset[['Genre','Popularity']].groupby('Genre').sum().sort_values(ascending=False,by='Popularity')[:10]\n\nsns.barplot(x=popular_genre.index, y=popular_genre['Popularity'], data=popular_genre, palette = \"pastel\");","6b0af8b1":"dataset['Lyrics'] = dataset['Lyrics'].str.lower().replace(r'\\n',' ')","271180f4":"stop_words_en = list(stopwords.words(\"english\"))\nstop_words_es = list(stopwords.words(\"spanish\"))\npunctuations = list(string.punctuation)\nforbidden = ['(',')',\"'\",',','oh',\"'s\", 'yo',\"'ll\", 'el', \"'re\",\"'m\",\"oh-oh\",\"'d\", \"n't\", \"``\", \"ooh\", \"uah\", \"'em\", \"'ve\", \"eh\", \"pa\", \"brr\", \"yeah\"] \nstop_words_all = set(stop_words_en + stop_words_es + punctuations + forbidden)","614e9af3":"def cleanse_text(tokens):\n    return [i for i in tokens if ((i not in list(stop_words_all)) and (re.search(r'\\d+', i) == None)) ]","7fea63d4":"songs = []\nfor song in dataset.Lyrics.values:\n    songs.append(cleanse_text(word_tokenize(song)))","6ab431f1":"word2vec = Word2Vec(songs, min_count=5)","400e8789":"def tsne_plot(model):\n    \"Creates and TSNE model and plots it\"\n    labels = []\n    tokens = []\n\n    for word in model.wv.vocab:\n        tokens.append(model[word])\n        labels.append(word)\n    \n    tsne_model = TSNE(perplexity=40, n_components=2, init='pca', n_iter=2500, random_state=23)\n    new_values = tsne_model.fit_transform(tokens)\n\n    x = []\n    y = []\n    for value in new_values:\n        x.append(value[0])\n        y.append(value[1])\n        \n    plt.figure(figsize=(16, 16)) \n    for i in range(len(x)):\n        plt.scatter(x[i],y[i])\n        plt.annotate(labels[i],\n                     xy=(x[i], y[i]),\n                     xytext=(5, 2),\n                     textcoords='offset points',\n                     ha='right',\n                     va='bottom')\n    plt.show();","23936a07":"tsne_plot(word2vec)","f4d80c32":"Liveness is distributed between ~ (1-20) which means the less lively the song is the more popular it is. ","fca36366":"**Dropping Unamed column since it has no significance**","cc60127f":"**Loading of libraries**","ae752c3e":"## Numerical Attributes","44f80f9b":"there is no direct relationship between Loudness and Popularity","f8e3c750":"The largest number of songs in the top 50 correspond to pop genre songs","98c93c2f":"# Loading of Datasets","d5174b82":"\nThere is a relationship between Popularity and the following variables:\n\n* More Danceability More Popularity?\n* More Acousticness More Popularity?\n* More Speechiness More Popularity?\n* Less Liveness More Popularity?\n* Most popular Genre?\n","e9e9ac7d":"Most of the songs of the top 50, possess a loudness value with around -6db, however there are atypical values close to -10db.\n\nSame is the case of liveness, where most songs have low values, where only those with high values are songs recorded live.","39bd8c38":"Acousticness is inversely proportional to Popularity","d6a3f2c5":"Most of the songs in the top 50, have a popularity around 85, presumably there are very small outliers compared to the median.","f028fa3e":"**Genres by Popularity**","56943b90":"Length and popularity almost follow a normal distribution.","0a3af783":"# Visualizing Dataset","908f186b":"Most of the songs of the top 50, possess a dancebility around 70, presumably there are very small outliers values compared to the median.","b03486c0":"# TSNE to visualize Word2Vec","4cdfbccd":"# Visualizing Individual Attributes","ed4aec12":"# Word2Vec on Lyrics","5b104187":"## Variable Interactions","a91226bd":"seems like danceability plays an important role in song's popularity"}}