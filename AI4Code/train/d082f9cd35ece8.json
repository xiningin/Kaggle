{"cell_type":{"e8e19a5d":"code","974fa186":"code","23a8a52b":"code","6ec80951":"code","5012c3b3":"code","68e62839":"code","b0e03cad":"code","f80faa70":"markdown","211d1a06":"markdown","d034d5e4":"markdown","e86fb2f9":"markdown","3ef453a4":"markdown"},"source":{"e8e19a5d":"import numpy as np\nimport pandas as pd\nimport itertools\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.linear_model import PassiveAggressiveClassifier\nfrom sklearn.metrics import accuracy_score, confusion_matrix\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","974fa186":"#Read Data\ndf = pd.read_csv(\"..\/input\/textdb3\/fake_or_real_news.csv\")\ndf.head()","23a8a52b":"#get labels from database\nlabels = df.label\nlabels.head()","6ec80951":"#split dataset\nx_train, x_test, y_train, y_test = train_test_split(df['text'], labels, test_size=0.2, random_state = 7)","5012c3b3":"#initialize TfidfVectorizer\ntfidf_vect = TfidfVectorizer(stop_words = 'english', max_df=0.7)\n\n#fit and transform train set and test set\ntfidf_train = tfidf_vect.fit_transform(x_train)\ntfidf_test = tfidf_vect.transform(x_test)","68e62839":"#initialize a passiveAgressiveCliassifier\npac = PassiveAggressiveClassifier(max_iter=50)\npac.fit(tfidf_train, y_train)\n\n#predict on test set and calculate accuracy\ny_pred = pac.predict(tfidf_test)\nscore = accuracy_score(y_test, y_pred)\nprint(f'Accuracy: {round(score*100, 2)}%')","b0e03cad":"#confusion matrix\nconfusion_matrix(y_test, y_pred, labels=['FAKE', 'REAL'])","f80faa70":"590 --> true Positive\n\n588 --> true negative\n\n41 --> false positive\n\n41 --> false negative","211d1a06":"With this model we can get accuracy of **92.98%**","d034d5e4":"\"\"\"Initialize TfidfVectorizer with stop words and max docs frequency of 0.7\"\"\"","e86fb2f9":"#### Fit the tfidf_train and y_train and then preidct the test set\n","3ef453a4":"# Fake News With Python\nThis advanced python project of detecting fake news deals with fake and real news. Using sklearn, we build a TfidfVectorizer on our dataset. Then, we initialize a PassiveAggressive Classifier and fit the model. In the end, the accuracy score and the confusion matrix tell us how well our model fares."}}