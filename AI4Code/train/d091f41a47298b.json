{"cell_type":{"52edd99f":"code","244d5807":"code","ea737be8":"code","03749c9a":"code","02f77132":"code","a669fdae":"code","14b5e809":"code","a03f9064":"code","b068ce42":"code","ebb588ad":"code","9fb424f5":"code","772f1745":"code","c1515075":"code","ffb045c9":"code","37fbd3a2":"code","48a29152":"code","459d5e72":"code","4cebe7e1":"code","7963c082":"code","17750c49":"code","f865b3a1":"code","453efdef":"code","bd87dd09":"code","924faa7c":"code","d7082f10":"code","dfb44034":"code","a921ef52":"markdown","096e9fda":"markdown","b8e32e3c":"markdown","885fedd4":"markdown","4cc6eb74":"markdown","a9045563":"markdown","2af32282":"markdown","43bb34a7":"markdown","0cbbd2d3":"markdown","02229bdd":"markdown","72da3e0f":"markdown","5c4ae79e":"markdown","2e75ff22":"markdown","20110baa":"markdown","4f27379a":"markdown"},"source":{"52edd99f":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\nfrom scipy import stats\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import train_test_split\n\n%matplotlib inline \nplt.rcParams['figure.figsize']=(8,5)","244d5807":"df = pd.read_csv('..\/input\/tabular-playground-series-apr-2021\/train.csv')\ndf.head()","ea737be8":"print(df.shape)","03749c9a":"df.info()","02f77132":"sns.heatmap(df.isnull(), cbar = False)\nplt.show()","a669fdae":"df.drop([\"Cabin\",\"Name\",\"PassengerId\",\"Ticket\"],axis = 1,inplace = True)\ndf.head()","14b5e809":"df[\"Sex\"] = df[\"Sex\"].astype(str)\ndf[\"Embarked\"] = df[\"Embarked\"].astype(str)","a03f9064":"sns.countplot(\"Sex\", data = df, hue =\"Survived\")\nplt.show()    ","b068ce42":"x= [0,1,2]\nsns.countplot(\"Pclass\", data = df, hue =\"Survived\")\nlabels = [\"1st Class\",\"2nd Class\",\"3rd Class\"]\nplt.xticks(x, labels)\nplt.show()    \n","ebb588ad":"x = [0,1,2,3]\nsns.countplot(\"Embarked\", data = df, hue =\"Survived\")\nlabels = [\"Southampton\",\"Cherbourg\", \"Queenstown\", \"Unknown\"]\nplt.xticks(x,labels)\nplt.show()    ","9fb424f5":"le = LabelEncoder()","772f1745":"for val in df.columns:\n    if df[val].dtype == \"O\":\n        df[val] = le.fit_transform(df[val])\ndf.head()","c1515075":"def fillmissing_val(col):\n    mean = col.mean()\n    col.fillna(mean, inplace = True)\nfillmissing_val(df[\"Age\"])\nfillmissing_val(df[\"Fare\"])\nfillmissing_val(df[\"Embarked\"])","ffb045c9":"df[\"Age\"] = np.round(df[\"Age\"])\ndf[\"Age\"] = df[\"Age\"].astype(int)","37fbd3a2":"df.isnull().sum()","48a29152":"correlation = df.corr()\nsns.heatmap(correlation,annot = True)\nplt.show()","459d5e72":"plt.figure(figsize=(12,6))\nsns.countplot(\"Age\",data = df, hue = \"Survived\")\nplt.xticks(range(0,90,5))\nplt.show()    ","4cebe7e1":"X = df.drop(columns = \"Survived\",axis =1)\nY = df[\"Survived\"]","7963c082":"xtrain, xtest, ytrain, ytest = train_test_split(X,Y, test_size = 0.2, random_state = 0)","17750c49":"model = LinearRegression()","f865b3a1":"model.fit(xtrain,ytrain) \nxtrain_predict = model.predict(xtrain)\nxtrain_predict = np.round(xtrain_predict).astype(int)\n\ntrain_predict = pd.DataFrame({\"Predicted Value\" : xtrain_predict,\n                              \"Actual Value\" : ytrain\n})","453efdef":"train_predict.head()","bd87dd09":"train_accuracy = accuracy_score(xtrain_predict,ytrain)\nprint(train_accuracy)","924faa7c":"xtest_predict = model.predict(xtest)\nxtest_predict = np.round(xtest_predict).astype(int)\n\ntest_predict = pd.DataFrame({\"Predicted Value\" : xtest_predict,\n                              \"Actual Value\" : ytest\n})","d7082f10":"test_predict.head()","dfb44034":"test_accuracy = accuracy_score(xtest_predict,ytest)\nprint(test_accuracy)","a921ef52":"### Linear Regression","096e9fda":"Dropping the insignificant variables","b8e32e3c":"### Importing Libraries","885fedd4":"### Visualization","4cc6eb74":"##### Test module","a9045563":"### Analyzing the Dataset","2af32282":"##### Train Module","43bb34a7":"Our target variable is Survived","0cbbd2d3":"Age has the highest correlation with survived variable","02229bdd":"Need to convert datatypes accordingly","72da3e0f":"0 - Not Survived, 1 - Survived\nFrom the above chart we come to know that the people between the 35 to 40 were survived the most.","5c4ae79e":"0 - Not Survived, 1 - Survived\n\nFrom the above plot we come to know that the people in 1st Class were mostly survived and people in 3rd class were mostly lost their life","2e75ff22":"### Encoding ","20110baa":"0 - Not Survived , 1 - Survived\n\nFrom the above plot we come to know that number of female's were survived when compared to male.","4f27379a":"### Train Test and Split"}}