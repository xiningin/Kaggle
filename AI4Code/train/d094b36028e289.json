{"cell_type":{"b39d2afc":"code","be388296":"code","791d6046":"code","25a81c9f":"code","5bda77be":"code","ca4a829c":"code","250c0227":"code","ddbb9388":"code","1b0c177f":"code","b38a6f6b":"code","d8091823":"code","ee28765a":"code","a10eaf1c":"code","fab3d07c":"markdown","f1b3ad11":"markdown","7292f8b2":"markdown","b6ee1ce0":"markdown"},"source":{"b39d2afc":"import numpy as np\nimport pandas as pd \nimport os\n\nimport matplotlib.pyplot as plt\n\nimport pathlib\nimport PIL\n\nfrom pathlib import Path","be388296":"train = pd.read_csv(\"..\/input\/tensorflow-great-barrier-reef\/train.csv\")\ntest = pd.read_csv(\"..\/input\/tensorflow-great-barrier-reef\/test.csv\")\nsub = pd.read_csv(\"..\/input\/tensorflow-great-barrier-reef\/example_sample_submission.csv\")\n\npath = Path('..\/input\/tensorflow-great-barrier-reef\/train_images')\nfilepaths = list(path.glob(r'**\/*.jpg'))","791d6046":"train.head()","25a81c9f":"train = train.loc[train[\"annotations\"] != \"[]\"]\ntrain.head()","5bda77be":"test.head()","ca4a829c":"sub.head()","250c0227":"train.shape , test.shape","ddbb9388":"train.info()","1b0c177f":"train.isnull().sum()","b38a6f6b":"(train.isnull().sum()\/ len(train))*100 ","d8091823":"def getLastFolderName(x): \n    pathwithoutFilename = os.path.split(x)[0] \n    lastFolderName = pathwithoutFilename.split(\"\/\")[-1] \n    return lastFolderName\n\ntargets = list(map(lambda x: getLastFolderName(x),filepaths)) \ntargets[:5]","ee28765a":"column_Imagepath = pd.Series(filepaths, name='ImagePath').astype(str)\ncolumn_ImageType = pd.Series(targets, name='ImageType').astype(str)\n\ntrain = pd.merge(column_Imagepath, column_ImageType, right_index = True, left_index = True)\ntrain= train.sample(frac = 1).reset_index(drop=True) # all shuffle \ntrain.head()","a10eaf1c":"f,a = plt.subplots(nrows=4, ncols=4,figsize=(15, 10),\n                        subplot_kw={'xticks': [], 'yticks': []})\n\nfor i, ax in enumerate(a.flat):\n    ax.imshow(plt.imread(train.ImagePath[i]))\n    ax.set_title(train.ImageType[i])\n    \nplt.tight_layout()\nplt.show()","fab3d07c":"# annotations != \"[]\"","f1b3ad11":"# make train dataframe","7292f8b2":"# get folder name => Target ","b6ee1ce0":"# draw images"}}