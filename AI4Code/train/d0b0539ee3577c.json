{"cell_type":{"59c02c46":"code","e20422b3":"code","58bf1371":"code","bfefcadc":"code","cb49ce27":"code","23471d9e":"code","69c48da8":"code","d84a576d":"code","7de6a41c":"code","5e5823fd":"code","b93565ce":"code","3ce58f94":"code","18ab8a5c":"code","876539e6":"code","9ea2e160":"code","afdf4531":"code","abb77a2e":"code","1fb434f7":"code","1283fd01":"code","30d20f76":"code","4d4af84d":"code","143d9176":"code","eed41175":"code","6e3d3f3a":"code","e9c99fe2":"code","dd81f47c":"code","f0f28e14":"code","7a3edacc":"code","47f4a323":"code","05635b74":"code","c3999b8b":"code","b1b0ee6b":"code","5a879adc":"code","6f53f8e7":"code","dbd9e24a":"code","b353bba7":"code","ea327089":"code","766f410f":"code","40c714f2":"code","66c06ae8":"code","b859a47f":"code","3c41aeab":"code","100f3c2f":"code","4c00e091":"code","99be7fd2":"code","e712087b":"code","07a334e4":"code","df84b8a7":"code","864b2a23":"code","fbcd9ac4":"code","7fe366ad":"code","a46178db":"code","c0401e15":"code","9b57be7e":"code","3af2aa04":"code","0bd6a3cf":"code","c17db4a0":"code","de6b90bc":"code","997cdd98":"code","d635c8f9":"code","1695ce1c":"code","3181954d":"code","53900606":"code","b3490769":"code","efb47aa0":"code","78d60f88":"code","b60c65b6":"code","2127dd10":"code","7a36fd28":"code","dff7a93f":"code","28b3add0":"code","57555758":"code","e0dc889d":"code","aab837a6":"code","528f5fb2":"code","a25f4c1a":"code","d499b562":"code","ee693cfa":"code","3196dcc4":"code","329ad87d":"code","7f671531":"code","fb501331":"code","bb447d66":"code","802f0350":"code","cf0f4eba":"code","5a85907b":"code","a19b3499":"markdown","402a6129":"markdown","a8cd6e82":"markdown","80adcd27":"markdown","9b5036d7":"markdown","1aee4c54":"markdown","4601e81b":"markdown","cf1b5a0d":"markdown","47ee6758":"markdown","ef42f1c2":"markdown"},"source":{"59c02c46":"import pandas as pd\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nimport statsmodels.api as sm\nfrom sklearn.metrics import mean_squared_error, r2_score\nimport matplotlib.pyplot as plt\nimport seaborn as sbn","e20422b3":"house = pd.read_csv('..\/input\/housing-prices-dataset\/Housing.csv')\nhouse.head()","58bf1371":"df = house.copy()\ndf.info()","bfefcadc":"df.describe().T","cb49ce27":"df.isnull().values.any()","23471d9e":"df.corr()","69c48da8":"sbn.pairplot(df, kind= \"reg\")","d84a576d":"g = sbn.PairGrid(df,  corner=True)\ng.map_lower(sbn.kdeplot, hue=None, levels=5, color=\".2\")\ng.map_lower(sbn.scatterplot, marker=\"+\")\ng.map_diag(sbn.histplot, element=\"step\", linewidth=0, kde=True)\ng.add_legend(frameon=True)\ng.legend.set_bbox_to_anchor((.61, .6))","7de6a41c":"g = sbn.pairplot(df)\ng.map_upper(sbn.kdeplot, levels=4, color=\".2\")\nplt.show()","5e5823fd":"plt.figure(figsize=[25,20])\nsbn.heatmap(df.corr(), annot=True, vmin=-1, vmax=1, center=0)\nplt.show()","b93565ce":"df = df.drop([\"area\",\"furnishingstatus\"], axis=1)","3ce58f94":"df.info()","18ab8a5c":"dms = pd.get_dummies(df[[\"mainroad\",\"guestroom\",\"basement\",\"hotwaterheating\",\"airconditioning\",\"prefarea\"]])\ndms.head()","876539e6":"y = df[\"price\"]\nX_ = df.drop([\"price\",\"mainroad\",\"guestroom\",\"basement\",\"hotwaterheating\",\"airconditioning\",\"prefarea\"], axis = 1).astype(\"float64\")","9ea2e160":"X_.head()","afdf4531":"X = pd.concat([X_, dms[[\"mainroad_yes\",\"guestroom_yes\",\"basement_yes\",\"hotwaterheating_yes\",\"airconditioning_yes\",\"prefarea_yes\"]]], axis=1)\nX.head()","abb77a2e":"RMSE = pd.DataFrame(np.zeros([5,2]), columns=['Train-RMSE','Test-RMSE'])\n#Test ve train hatalar\u0131n\u0131 bunun i\u00e7ine ekleyece\u011fiz","1fb434f7":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size= 0.20, random_state= 42)\n\nprint(\"X_train\", X_train.shape)\n\nprint(\"y_train\", y_train.shape)\n\nprint(\"X_test\", X_test.shape)\n\nprint(\"y_test\", y_test.shape)\n\ntraining = df.copy()\n\nprint(\"training\", training.shape)","1283fd01":"import statsmodels.api as sm\nlm = sm.OLS(y_train, X_train)\nmodel = lm.fit()\nmodel.summary()","30d20f76":"from sklearn.decomposition import PCA \nfrom sklearn.preprocessing import scale\npca = PCA()","4d4af84d":"X_reduced_train = pca.fit_transform(scale(X_train))\n#Verinin indirgenmesi","143d9176":"X_reduced_train [0:1, :]","eed41175":"np.cumsum(np.round(pca.explained_variance_ratio_, decimals=4)*100)[0:5]","6e3d3f3a":"from sklearn.linear_model import LinearRegression","e9c99fe2":"lm = LinearRegression()","dd81f47c":"pcr_model = lm.fit(X_reduced_train, y_train)","f0f28e14":"pcr_model.intercept_","7a3edacc":"pcr_model.coef_","47f4a323":"y_pred1 = pcr_model.predict(X_reduced_train)\n\npcr_train_mse = np.sqrt(mean_squared_error(y_train, y_pred1))\n\npcr_train_mse","05635b74":"df[\"price\"].mean()","c3999b8b":"r2_score(y_train, y_pred1)","b1b0ee6b":"pca2 = PCA()","5a879adc":"X_reduced_test = pca2.fit_transform(scale(X_test))","6f53f8e7":"y_pred2 = pcr_model.predict(X_reduced_test)\n\npcr_test_mse = np.sqrt(mean_squared_error(y_test, y_pred2))\n\npcr_test_mse","dbd9e24a":"r2_score(y_test, y_pred2)","b353bba7":"RMSE.loc[0,'Train-RMSE']= round(np.sqrt(mean_squared_error(y_train, y_pred1)))\n\nRMSE.loc[0,'Test-RMSE'] = round(np.sqrt(mean_squared_error(y_test, y_pred2)))","ea327089":"house = pd.read_csv(\"..\/input\/housing-prices-dataset\/Housing.csv\")\ndf = house.copy()\ndf = df.drop([\"area\",\"furnishingstatus\"], axis=1)\ndms = pd.get_dummies(df[[\"mainroad\",\"guestroom\",\"basement\",\"hotwaterheating\",\"airconditioning\",\"prefarea\"]])\ny = df[\"price\"]\nX_ = df.drop([\"price\",\"mainroad\",\"guestroom\",\"basement\",\"hotwaterheating\",\"airconditioning\",\"prefarea\"], axis = 1).astype(\"float64\")\nX = pd.concat([X_, dms[[\"mainroad_yes\",\"guestroom_yes\",\"basement_yes\",\"hotwaterheating_yes\",\"airconditioning_yes\",\"prefarea_yes\"]]], axis=1)\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size= 0.20, random_state= 42)","766f410f":"from sklearn.cross_decomposition import PLSRegression","40c714f2":"pls_model = PLSRegression(n_components=2).fit(X_train, y_train)","66c06ae8":"pls_model.coef_","b859a47f":"X_train.head()","3c41aeab":"pls_model.predict(X_train)[0:10]","100f3c2f":"y_pred1 = pls_model.predict(X_train)\n\npls_train_mse = np.sqrt(mean_squared_error(y_train, y_pred1))\n\npls_train_mse","4c00e091":"r2_score(y_train, y_pred1)","99be7fd2":"y_pred2 = pls_model.predict(X_test)\n\npls_test_mse = np.sqrt(mean_squared_error(y_test, y_pred2))\n\npls_test_mse","e712087b":"r2_score(y_test, y_pred2)","07a334e4":"RMSE.loc[1,'Train-RMSE']= round(np.sqrt(mean_squared_error(y_train, y_pred1)))\n\nRMSE.loc[1,'Test-RMSE'] = round(np.sqrt(mean_squared_error(y_test, y_pred2)))","df84b8a7":"house = pd.read_csv(\"..\/input\/housing-prices-dataset\/Housing.csv\")\ndf = house.copy()\ndf = df.drop([\"area\",\"furnishingstatus\"], axis=1)\ndms = pd.get_dummies(df[[\"mainroad\",\"guestroom\",\"basement\",\"hotwaterheating\",\"airconditioning\",\"prefarea\"]])\ny = df[\"price\"]\nX_ = df.drop([\"price\",\"mainroad\",\"guestroom\",\"basement\",\"hotwaterheating\",\"airconditioning\",\"prefarea\"], axis = 1).astype(\"float64\")\nX = pd.concat([X_, dms[[\"mainroad_yes\",\"guestroom_yes\",\"basement_yes\",\"hotwaterheating_yes\",\"airconditioning_yes\",\"prefarea_yes\"]]], axis=1)\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size= 0.20, random_state= 42)","864b2a23":"from sklearn.linear_model import Lasso","fbcd9ac4":"lasso_model = Lasso(alpha= 0.1).fit(X_train, y_train)","7fe366ad":"lasso_model","a46178db":"lasso_model.coef_","c0401e15":"lambdalar = 10**np.linspace(10,-2,100)*0.5\n\nlasso = Lasso()\nkatsayilar = []\n\nfor i in lambdalar:\n    lasso.set_params(alpha = i)\n    lasso.fit(X_train, y_train)\n    katsayilar.append(lasso.coef_)\n\nax = plt.gca()\nax.plot(lambdalar*2, katsayilar)\nax.set_xscale(\"log\")\nplt.axis(\"tight\")\nplt.xlabel(\"alpha\")\nplt.ylabel(\"weights\")","9b57be7e":"lasso_model.predict(X_test)","3af2aa04":"y_pred1 = pls_model.predict(X_train)\n\nlasso_train_mse = np.sqrt(mean_squared_error(y_train, y_pred1))\n\nlasso_train_mse","0bd6a3cf":"r2_score(y_train, y_pred1)","c17db4a0":"y_pred2 = lasso_model.predict(X_test)\n\nlasso_test_mse = np.sqrt(mean_squared_error(y_test, y_pred2))\n\nlasso_test_mse","de6b90bc":"r2_score(y_test, y_pred2)","997cdd98":"RMSE.loc[2,'Train-RMSE']= round(np.sqrt(mean_squared_error(y_train, y_pred1)))\n\nRMSE.loc[2,'Test-RMSE'] = round(np.sqrt(mean_squared_error(y_test, y_pred2)))","d635c8f9":"house = pd.read_csv(\"..\/input\/housing-prices-dataset\/Housing.csv\")\ndf = house.copy()\ndf = df.drop([\"area\",\"furnishingstatus\"], axis=1)\ndms = pd.get_dummies(df[[\"mainroad\",\"guestroom\",\"basement\",\"hotwaterheating\",\"airconditioning\",\"prefarea\"]])\ny = df[\"price\"]\nX_ = df.drop([\"price\",\"mainroad\",\"guestroom\",\"basement\",\"hotwaterheating\",\"airconditioning\",\"prefarea\"], axis = 1).astype(\"float64\")\nX = pd.concat([X_, dms[[\"mainroad_yes\",\"guestroom_yes\",\"basement_yes\",\"hotwaterheating_yes\",\"airconditioning_yes\",\"prefarea_yes\"]]], axis=1)\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size= 0.20, random_state= 42)","1695ce1c":"from sklearn.linear_model import Ridge\nridge_model = Ridge(alpha= 0.1).fit(X_train, y_train)","3181954d":"ridge_model","53900606":"ridge_model.coef_","b3490769":"ridge_model.intercept_","efb47aa0":"lambdalar = 10**np.linspace(10,-2,100)*0.5\n\nridge_model = Ridge()\nkatsayilar = []\n\nfor i in lambdalar:\n    ridge_model.set_params(alpha = i)\n    ridge_model.fit(X_train, y_train)\n    katsayilar.append(ridge_model.coef_)\n\nax = plt.gca()\nax.plot(lambdalar, katsayilar)\nax.set_xscale(\"log\")\n\nplt.xlabel(\"Lambda(Alpha) De\u011ferleri\")\nplt.ylabel(\"Katsay\u0131lar\/A\u011f\u0131rl\u0131klar\")\nplt.title(\"D\u00fczenlile\u015ftirmenin Bir Fonksiyonu Olarak Ridge Katsay\u0131lar\u0131\")\n\n","78d60f88":"y_pred1 = ridge_model.predict(X_train)\n\nridge_train_mse = np.sqrt(mean_squared_error(y_train, y_pred1))\n\nridge_train_mse","b60c65b6":"r2_score(y_train, y_pred1)","2127dd10":"y_pred2 = ridge_model.predict(X_test)\n\nridge_test_mse = np.sqrt(mean_squared_error(y_test, y_pred2))\n\nridge_test_mse","7a36fd28":"r2_score(y_test, y_pred2)","dff7a93f":"RMSE.loc[3,'Train-RMSE']= round(np.sqrt(mean_squared_error(y_train, y_pred1)))\n\nRMSE.loc[3,'Test-RMSE'] = round(np.sqrt(mean_squared_error(y_test, y_pred2)))","28b3add0":"house = pd.read_csv(\"..\/input\/housing-prices-dataset\/Housing.csv\")\ndf = house.copy()\ndf = df.drop([\"area\",\"furnishingstatus\"], axis=1)\ndms = pd.get_dummies(df[[\"mainroad\",\"guestroom\",\"basement\",\"hotwaterheating\",\"airconditioning\",\"prefarea\"]])\ny = df[\"price\"]\nX_ = df.drop([\"price\",\"mainroad\",\"guestroom\",\"basement\",\"hotwaterheating\",\"airconditioning\",\"prefarea\"], axis = 1).astype(\"float64\")\nX = pd.concat([X_, dms[[\"mainroad_yes\",\"guestroom_yes\",\"basement_yes\",\"hotwaterheating_yes\",\"airconditioning_yes\",\"prefarea_yes\"]]], axis=1)\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size= 0.20, random_state= 42)","57555758":"from sklearn.linear_model import ElasticNet","e0dc889d":"enet_model = ElasticNet().fit(X_train, y_train)","aab837a6":"enet_model.coef_","528f5fb2":"enet_model.intercept_","a25f4c1a":"enet_model.predict(X_test)","d499b562":"y_pred1 = enet_model.predict(X_train)\n\nenet_train_mse = np.sqrt(mean_squared_error(y_train, y_pred1))\n\nenet_train_mse","ee693cfa":"r2_score(y_train, y_pred1)","3196dcc4":"y_pred2 = enet_model.predict(X_test)\n\nenet_test_mse = np.sqrt(mean_squared_error(y_test, y_pred2))\n\nenet_test_mse","329ad87d":"r2_score(y_test, y_pred2)","7f671531":"RMSE.loc[4,'Train-RMSE']= round(np.sqrt(mean_squared_error(y_train, y_pred1)))\n\nRMSE.loc[4,'Test-RMSE'] = round(np.sqrt(mean_squared_error(y_test, y_pred2)))","fb501331":"RMSE","bb447d66":"RMSE.index = [\"PCR\", \"PLS\", \"LASSO\", \"R\u0130DGE\", \"ELASTICNET\"]","802f0350":"RMSE","cf0f4eba":"plt.bar(np.arange(5), RMSE[\"Train-RMSE\"].values, width=0.3, label='RMSE Train')\nplt.bar(np.arange(5)+0.3, RMSE[\"Test-RMSE\"].values, width=0.3, label='RMSE Test')\nplt.xticks(np.arange(5),RMSE.index, rotation =35)\nplt.legend()\nplt.ylim([0.75,1.95e6])\nplt.show()","5a85907b":"R2 = round(RMSE['Test-RMSE'].sort_values(ascending=True),4)\nplt.hlines(y=R2.index, xmin=0, xmax=R2.values)\nplt.plot(R2.values, R2.index,'o')\nplt.xlabel('Test-RMSE')\nplt.ylabel('Regression Models')\nfor i, v in enumerate(R2):\n    plt.text(v+0.02, i-0.05, str(v*100), color='black')\nplt.show()","a19b3499":"R\u0130DGE MODEL","402a6129":"R\u0130DGE MODEL TAHM\u0130N","a8cd6e82":"ELAST\u0130CNET MODEL","80adcd27":"LASSO MODEL","9b5036d7":"PCR MODEL","1aee4c54":"TEST HATALARI KAR\u015eILA\u015eTIRMASI","4601e81b":"LASSO MODEL TAHM\u0130N","cf1b5a0d":"PLS MODEL TAHM\u0130N","47ee6758":"PLS MODEL","ef42f1c2":"PCR MODEL TAHM\u0130N"}}