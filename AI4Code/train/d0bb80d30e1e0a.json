{"cell_type":{"5c02bf05":"code","6586b998":"code","72edb3db":"code","2dfa83ba":"code","bd08a756":"code","2fc301f3":"code","7eb0d7b2":"code","73c61387":"code","fb425752":"code","e9006193":"code","16b35536":"code","7841bf5b":"code","0e335a98":"code","452cca69":"code","e435478f":"code","5aac346b":"code","79ab331f":"code","543ab853":"code","254275e9":"markdown","7d689502":"markdown","0d26868d":"markdown","b47a90c0":"markdown","da869114":"markdown","1c3c328a":"markdown","01ed4140":"markdown","84e1897a":"markdown","23393b48":"markdown","af6fb30c":"markdown","33488b62":"markdown","a087d561":"markdown","497d85d5":"markdown","0f64b218":"markdown"},"source":{"5c02bf05":"#Setup\nimport pandas as pd\npd.plotting.register_matplotlib_converters()\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","6586b998":"#Reading data\n\nX_complete = pd.read_csv('\/kaggle\/input\/titanic\/train.csv', index_col='PassengerId')\nX_testing = pd.read_csv('\/kaggle\/input\/titanic\/test.csv', index_col='PassengerId')\n\nprint(f'Dataframe shape: {X_complete.shape}')\nX_complete.head()","72edb3db":"#Ratio between men and women onboard\nnumber_of_men = len(X_complete.loc[X_complete.Sex == 'male'])\nnumber_of_women = len(X_complete.loc[X_complete.Sex == 'female'])\nprint(f'Number of men onboard: {number_of_men}')\nprint(f'Number of women onboard: {number_of_women}')\nprint(f'Male to female ratio: {number_of_men\/number_of_women}')\n\n#Let's analize survival rates in relation to gender\nsns.barplot(x = 'Sex', y = 'Survived', data = X_complete)\nplt.title('Survival rate in relation to gender')\nplt.ylabel('Survived [%]')","2dfa83ba":"#Passengers age data\npassengers_age_data = X_complete['Age']\nmale_age_data = X_complete.loc[X_complete.Sex == 'male']['Age']\nfemale_age_data = X_complete.loc[X_complete.Sex == 'female']['Age']\n\n#Survivors age data\nsurvivor_data = X_complete.loc[X_complete.Survived == 1]['Age']\nsurvivor_male_age_data = X_complete.loc[X_complete.Sex == 'male'][X_complete.Survived == 1]['Age']\nsurvivor_female_age_data = X_complete.loc[X_complete.Sex == 'female'][X_complete.Survived == 1]['Age']\n","bd08a756":"#Analizing overall age distribution and survival age distributions\nplt.figure(figsize=(12,6))\n\nsns.distplot(a = passengers_age_data, label = 'Overall', kde = False)\nsns.distplot(a = survivor_data, label = 'Survivors', kde = False)\n\nplt.title('Age distribution of passengers')\nplt.ylabel('Number of passengers')\nplt.legend()","2fc301f3":"#Let's break the data up and look at the numbers among men\nplt.figure(figsize=(12,6))\n\nsns.distplot(a = male_age_data, label = 'Total', kde = False)\nsns.distplot(a = survivor_male_age_data, label = 'Survivors', kde = False)\n\nplt.title('Age distribution of male passengers')\nplt.ylabel('Number of passengers')\nplt.legend()","7eb0d7b2":"#Let's look at the numbers among women\nplt.figure(figsize=(12,6))\n\nsns.distplot(a = female_age_data, label = 'Total', kde = False)\nsns.distplot(a = survivor_female_age_data, label = 'Survivors', kde = False)\n\nplt.title('Age distribution of female passengers')\nplt.ylabel('Number of passengers')\nplt.legend()","73c61387":"#Taking a look at passenger classes\nsns.barplot(x = 'Pclass', y = 'Survived', data = X_complete)\nplt.ylabel('Survived [%]')\nplt.xlabel('Passenger class')\nplt.title('Survival rate in relation to passenger class')","fb425752":"sns.distplot(a = X_complete['Fare'], label = 'Overall', kde = False)\nsns.distplot(a = X_complete.loc[X_complete.Survived == 1]['Fare'], label = 'Survived', kde = False)\nplt.title('Fare paid')\nplt.legend()","e9006193":"sns.barplot(x = X_complete['Embarked'], y = X_complete['Survived'])\nplt.title('Port of boarding')\nplt.ylabel('Survived [%]')","16b35536":"sns.distplot(a = X_complete['SibSp'], label = 'Overall', kde=False)\nsns.distplot(a = X_complete.loc[X_complete.Survived == 1]['SibSp'], label = 'Survivors', kde=False)\nplt.legend()\nplt.title('Amount of spouses and siblings between the passengers')","7841bf5b":"sns.distplot(a = X_complete['Parch'], label = 'Overall', kde=False)\nsns.distplot(a = X_complete.loc[X_complete.Survived == 1]['Parch'], label = 'Survivors', kde=False)\nplt.legend()\nplt.title('Amount of parents and children among passengers')","0e335a98":"df = pd.read_csv('\/kaggle\/input\/titanic\/train.csv', index_col='PassengerId')\ndf.head()","452cca69":"from sklearn.preprocessing import LabelEncoder, OneHotEncoder\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.compose import ColumnTransformer\n\ndf.drop([\"Name\", \"Ticket\", \"Cabin\"], axis = 1, inplace = True)\n\nnum_encoder = Pipeline(steps = [('num-imputer', SimpleImputer(strategy = 'median'))])\ncat_encoder = Pipeline(steps = [('cat_imputer', SimpleImputer(strategy = 'most_frequent')),\n                                ('one-hot', OneHotEncoder())])\n\npreprocessor = ColumnTransformer(transformers =[('numerical', num_encoder, ['Pclass','Age', 'Fare', 'SibSp', 'Parch']),\n                                               ('categorical', cat_encoder, ['Sex', 'Embarked']),\n                                               ])","e435478f":"from sklearn.naive_bayes import GaussianNB\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import RandomForestClassifier, VotingClassifier\nfrom xgboost import XGBClassifier\n\ngaussian_NB = GaussianNB()\n\nk_neighbors = KNeighborsClassifier(n_neighbors = 5, p = 1)\n\nrandom_forest = RandomForestClassifier(n_estimators = 115, \n                                       max_depth  = 10, \n                                       min_samples_split = 10, \n                                       max_features = 0.9, \n                                       random_state=1)\nxgb = XGBClassifier()\n\nestimators = [('naive_bayes', gaussian_NB),\n              ('k_neighbors', k_neighbors),\n              ('random_forest', random_forest),\n              #('xgb', xgb)\n             ]\n\nvoting_csf = VotingClassifier(estimators = estimators, voting = 'hard')\n\nvoting_pipeline = Pipeline(steps = [('preprocessor', preprocessor),\n                                    ('voting_classifier', voting_csf)])","5aac346b":"from sklearn.model_selection import KFold, cross_validate\n\nkfold = KFold(n_splits = 5, shuffle = True, random_state = 1)\nresults = cross_validate(voting_pipeline, X = df.drop([\"Survived\"], axis = 1,), y = df['Survived'], scoring = 'accuracy', cv = kfold, return_train_score = True)\n\nprint(\"Average training acuraccy: Mean = {}; std = {}\".format(results['train_score'].mean(), results['train_score'].std()) )\nprint(\"Average testing acuraccy: Mean = {}; std = {}\".format(results['test_score'].mean(), results['test_score'].std()) )","79ab331f":"voting_pipeline.fit(X = df.drop(['Survived'], axis = 1), y = df['Survived'])\n\npredictions = pd.DataFrame(voting_pipeline.predict(X_testing), index = X_testing.index)\n\npredictions.rename(columns = {0: 'Survived'}, inplace = True)\n\npredictions.head()\npredictions.shape","543ab853":"predictions.to_csv(path_or_buf = 'submission.csv')","254275e9":"Curiously enough, there appears to be a correlation between port of embarking and survival rate. This could be explained by a certain port being the one where most of the first class passengers boarded the ship and the others being where the poorer passengers embarked.","7d689502":"## Socioeconomic status\nAnother factor that may be of relevance towards survival is the socioeconomic status of the passengers. Higher class passengers had cabins located in the top floors of the ship and received differentiated treatment during the evacuation of the ship.","0d26868d":"## Training classifiers","b47a90c0":"The data shows that the higher the fare paid by the passenger, the higher was his chance of survival. That is to be expected, as higher fares correspond to higher passenger classes.","da869114":"## Age and gender\nLet\u00b4s start by analizing survival rates by gender and age. As it was customary of the time, men where expected to help women and children to escape from tragedy first, so a correlation between gender, age and survival rate is to be expected.","1c3c328a":"## Family structure\nAt last, let\u00b4s analyze if there is a correlation of number of relatives traveling together and survival.","01ed4140":"The data about families traveling together reveals a slight correlation between size of family and survival rate. What can be inferred is that traveling in a small family (two to three relatives) increased chances of survival over traveling either alone (maybe because no one would be there to help you escape the ship or maybe because the passenger was young and traveling alone) or by traveling in a big family (not wanting to leave relatives behind to die alone because the whole family couldn't fit inside a escapeboat)","84e1897a":"By seeing the downward slope of the last graph, it can be said with confidence that the class of the passenger played a significant role towards survival chance. Also, it is of note that the cabins differed significantly between different classes, but not among the same class. Thus, the cabin number of the passengers will not be analyzed.","23393b48":"# Exploring the data\nBefore we begin, it must be noted that by having a look at the data one can see that some features may be more useful than others to predict passanger survival chance in the Titanic tragedy. While names and tickets were important for identifying passengers, such categorigal data mostly likely will not be as critical as the other features in the dataset such as passenger class, sex and age, among others.","af6fb30c":"# Training the model\nGiven the insights gathered from the data, the model fitting can begin. A range of models will be trained and evalued to","33488b62":"## Elected model: ensemble","a087d561":"## Gathering and formatting data","497d85d5":"As it can be seen, the majority (almost double) of the passengers where male. However, while about 70% of the women who where at Titanic survived the ship sinking, men had a survival rate just shy of 20%. It can be concluded that gender was a critical factor when it came to surviving the tragedy.","0f64b218":"The data reveals that the majority of the passengers were aged between their teens and their mid-thirties. However, that group had a smaller relative survival rate when compared to the children and the elder. This suggests that age did play a role in survival at the tragedy, and that the relation is U shaped."}}