{"cell_type":{"edfac1a7":"code","38c91cc0":"code","0ab4c546":"code","b05e3be1":"code","be070009":"code","450a803b":"code","0e7953a1":"code","57116f17":"code","30744e62":"code","fae61e93":"code","9cb75f4a":"code","b057271d":"markdown","1c79c5b9":"markdown","22acbc86":"markdown"},"source":{"edfac1a7":"from fastai.vision import *\nimport os\n\npath = Path(r'..\/input\/samples\/')\nprint(os.listdir(path\/'samples')[:10])","38c91cc0":"from IPython.display import Image\nImage(filename='..\/input\/samples\/samples\/bny23.png')","0ab4c546":"def label_from_filename(path):\n    label = [char for char in path.name[:-4]]\n    return label","b05e3be1":"data = (ImageList.from_folder(path)\n        .split_by_rand_pct(0.2)\n        .label_from_func(label_from_filename)\n        .transform(get_transforms(do_flip=False))\n        .databunch()\n        .normalize()\n       )\ndata.show_batch(3)","be070009":"acc_02 = partial(accuracy_thresh, thresh=0.2)","450a803b":"learn = learn = cnn_learner(data, models.resnet18, model_dir='\/tmp', metrics=acc_02)\nlr_find(learn)\nlearn.recorder.plot()","0e7953a1":"lr = 5e-2\nlearn.fit_one_cycle(5, lr)","57116f17":"import copy\nlosses = copy.deepcopy(learn.recorder.losses)","30744e62":"learn.unfreeze()\nlr_find(learn)\nlearn.recorder.plot()","fae61e93":"learn.fit_one_cycle(15, slice(1e-3, lr\/5))","9cb75f4a":"losses += learn.recorder.losses\n\nfig, ax = plt.subplots(figsize=(14,7))\nax.plot(losses, linewidth=2)\nax.set_ylabel('loss', fontsize=16)\nax.set_xlabel('iteration', fontsize=16)\nplt.show()","b057271d":"## Multilabel Classification","1c79c5b9":"[This](https:\/\/medium.com\/@oneironaut.oml\/solving-captchas-with-deeplearning-part-1-multi-label-classification-b9f745c3a599) article explains what's going in this kernel.","22acbc86":"# Captchas"}}