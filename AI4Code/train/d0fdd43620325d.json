{"cell_type":{"961bf54d":"code","28560726":"code","bf7d0e86":"code","9329d2a4":"code","3dda5254":"code","fb791d57":"code","49356d69":"code","71f2b03e":"code","fe9b46c9":"code","6a707ac7":"code","f660fb92":"code","b4fa2abf":"code","09eea829":"code","d46a4a2d":"code","b48d0783":"code","e94d3534":"code","19e72eae":"code","696eb42d":"code","8260ed80":"code","a3f6b0be":"code","f9593af3":"code","163d2857":"code","af2619ab":"code","c5d0be82":"code","1aa5e8d6":"markdown"},"source":{"961bf54d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n%matplotlib inline\nfrom sklearn.metrics import davies_bouldin_score\nfrom sklearn.metrics import silhouette_score\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.decomposition import PCA\nfrom sklearn.cluster import KMeans\nfrom sklearn.cluster import DBSCAN\nfrom sklearn.cluster import AgglomerativeClustering\nfrom scipy.cluster import hierarchy\nfrom scipy.spatial import distance_matrix\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","28560726":"# reading csv file \ndf = pd.read_csv('\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\ndf.drop('CustomerID',axis=1,inplace=True)","bf7d0e86":"# creating dummy variable \ndum = pd.get_dummies(df['Gender'],drop_first=True)\ndf = pd.concat([dum,df],axis=1)\ndf.drop('Gender',axis=1,inplace=True)","9329d2a4":"df.head()","3dda5254":"# Standardizing data using MinMaxScaler\nss = StandardScaler()\nmm = MinMaxScaler()\nscaler = mm.fit_transform(df)","fb791d57":"# Applying princpal compnent analysis for plot data in 2D graph\npca = PCA(n_components=2)\npca.fit(scaler)","49356d69":"xpca = pca.transform(scaler)","71f2b03e":"# ploting graph of whole data in 2 dimension\nplt.figure(figsize=(8,6))\nplt.scatter(xpca[:,0],xpca[:,1])","fe9b46c9":"# Using Kmeans for clustering\nkm = KMeans(n_clusters=2,random_state=1)\nkm.fit(xpca)\npred = km.predict(xpca)\nlab = km.labels_","6a707ac7":"# finding least error by changing no. of clusters\n# This method is known as Elbow Method\na = range(1,10)\nsse = []\nfor i in a:\n    km = KMeans(n_clusters=i)\n    km.fit(xpca)\n    sse.append(km.inertia_)\nplt.plot(a,sse)    ","f660fb92":"# ploting results of clustering\nplt.scatter(xpca[:,0],xpca[:,1],c=pred,cmap='Paired')","b4fa2abf":"# metrics used for measuring accuracy of clustering(value closer to 1 better it is)\nsilhouette_score(xpca,pred)","09eea829":"# metrics used for measuring accuracy of clustering(value closer to 0 better it is)\ndavies_bouldin_score(xpca,pred)","d46a4a2d":"# Using Agglomerative approach for clustering\nagglo = AgglomerativeClustering(n_clusters=2,linkage='average')\nagpred = agglo.fit_predict(xpca)","b48d0783":"plt.scatter(xpca[:,0],xpca[:,1],c=agpred,cmap='Paired')","e94d3534":"agp = agglo.labels_","19e72eae":"silhouette_score(xpca,agp)","696eb42d":"davies_bouldin_score(xpca,agp)","8260ed80":"#  showing hierarchy of data\ndist = distance_matrix(xpca,xpca)\nz = hierarchy.linkage(xpca,'average')\ndendro = hierarchy.dendrogram(z)","a3f6b0be":"# Using Agglomerative approach for clustering\ndb = DBSCAN()\ndbpred = db.fit_predict(xpca)","f9593af3":"plt.scatter(xpca[:,0],xpca[:,1],c=dbpred,cmap='Paired')","163d2857":"dbp = db.labels_","af2619ab":"silhouette_score(xpca,dbp)","c5d0be82":"davies_bouldin_score(xpca,dbp)","1aa5e8d6":"**As all the three methods shows same result we can use any method for final submission**"}}