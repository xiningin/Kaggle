{"cell_type":{"bf613ef8":"code","037206d4":"code","02c15487":"code","7ff03776":"code","829e7645":"code","a5c63dc6":"code","3f532081":"code","e9bc32ce":"code","1df2b1ad":"code","350ec216":"code","e433194a":"code","d0d678b1":"code","c55a72de":"code","7b2a689d":"code","4bfc3cf1":"code","6c5b384c":"code","ddf8a9c8":"code","407927f7":"code","5c7a16b0":"code","6014e257":"code","d174c58b":"code","7f642758":"code","c3ca6390":"code","e400236b":"code","d09cfabd":"code","d2af92d6":"code","1a7f6999":"code","cc385df0":"code","1ba7ff3a":"code","2a5ba895":"code","dc9e83c1":"code","168ff547":"markdown","a41cc9f1":"markdown","5c1d21b8":"markdown","d350ed7a":"markdown","fd2eb93e":"markdown"},"source":{"bf613ef8":"#Carregando as bibliotecas b\u00e1sicas:\nimport numpy as np\nimport pandas as pd ","037206d4":"#Carregando as bibliotecas de gera\u00e7\u00e3o de gr\u00e1ficos\nimport matplotlib.pyplot as plt","02c15487":"#Carregando as bibliotecas de machine learning\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import r2_score\nfrom sklearn.linear_model import SGDRegressor\nfrom sklearn.neural_network import MLPRegressor","7ff03776":"dataset = pd.read_csv(\"..\/input\/traffic-volume-in-brazils-highway-toll-plazas\/all.csv\",\n                     sep=\";\",\n                     decimal=\",\",\n                     encoding=\"ISO-8859-1\")","829e7645":"dataset.head()","a5c63dc6":"dataset[\"Concessionaria\"].unique()\n","3f532081":"dataset_dutra = dataset[dataset[\"Concessionaria\"] == \"01.Nova Dutra\"]","e9bc32ce":"dataset_dutra[\"Categoria\"].unique()","1df2b1ad":"dataset_dutra_carpasseio = dataset_dutra[dataset_dutra[\"Categoria\"] == \"Categoria 1\"]","350ec216":"dataset_dutra_carpasseio[\"Praca\"].unique()","e433194a":"dataset_dutra_carpasseio[\"mes_ano\"] = pd.to_datetime(dataset_dutra_carpasseio[\"mes_ano\"],\n                                                    format = \"%b-%y\")","d0d678b1":"dataset_agrupado = dataset_dutra_carpasseio.groupby([\"mes_ano\"]).sum()","c55a72de":"dataset_agrupado.head()","7b2a689d":"dataset_agrupado[\"mes\"] =  np.arange(1, 121)","4bfc3cf1":"dataset_agrupado[\"mes\"]","6c5b384c":"dataset_agrupado","ddf8a9c8":"X = dataset_agrupado[[\"mes\"]]\nY = dataset_agrupado[[\"Volume_total\"]]\nplt.scatter(X,Y)\nplt.xlabel(\"Meses\")\nplt.ylabel(\"Volume\")","407927f7":"X = dataset_agrupado[[\"mes\"]]\nY = dataset_agrupado[[\"Volume_total\"]]","5c7a16b0":"#Normaliza\u00e7\u00e3o\nescala = StandardScaler()\nescala.fit(X)\n\nX_norm = escala.transform(X)","6014e257":"#Dividindo em treinamento e em teste\nX_norm_train, X_norm_test, Y_train, Y_test = train_test_split(X_norm, Y, test_size=0.3)","d174c58b":"RNA = MLPRegressor(hidden_layer_sizes=(700, 400, 200, 100, 50),\n                   max_iter=2000,\n                   tol=0.0000001,\n                   solver=\"adam\",\n                   learning_rate_init=0.01,\n                   activation=\"relu\",\n                   learning_rate=\"constant\",\n                   verbose=2)","7f642758":"RNA.fit(X_norm_train, Y_train)","c3ca6390":"reglin = SGDRegressor(max_iter=500,\n                     tol=0.0000001,\n                     eta0=0.01,\n                     learning_rate=\"constant\",\n                     verbose=2,\n                     )","e400236b":"reglin.fit(X_norm_train, Y_train)","d09cfabd":"#previs\u00e3o do conjunto de teste:\n\nY_RNA_previsao = RNA.predict(X_norm_test)\nY_reglin_previsao = reglin.predict(X_norm_test)","d2af92d6":"#Calculo do R^2\n\nr2_RNA = r2_score(Y_test,Y_RNA_previsao)\nr2_reglin = r2_score(Y_test, Y_reglin_previsao)\n\nprint(\"R2 RNA:\", r2_RNA),\nprint(\"R2 REGLIN:\", r2_reglin)\n\n","1a7f6999":"X_test = escala.inverse_transform(X_norm_test)\n\nplt.scatter(X_test, Y_test, alpha=0.5,label=\"Regress\u00e3o\")\nplt.scatter(X_test, Y_RNA_previsao, alpha=0.5,label=\"MLP\")\nplt.scatter(X_test, Y_reglin_previsao, alpha=0.5,label=\"Reg Linear\")\nplt.xlabel(\"Mes\")\nplt.ylabel(\"Volume\")\nplt.title(\"Volume de trafego\/mes\")\nplt.legend(loc=1)","cc385df0":"#prever para mais 24 meses.\nX_previsao_reglin = X\ny_previsao_reglin = reglin.predict(escala.transform(X_previsao_reglin))\n\nX_previsao_futura_reglin = np.array([np.arange(121,145)])\nX_previsao_futura_reglin = X_previsao_futura_reglin.transpose()\nY_previsao_futura_reglin = reglin.predict(escala.transform(X_previsao_futura_reglin))\n\n","1ba7ff3a":"#regress\u00e3o linear\nplt.scatter(X, Y, label=\"Real\")\nplt.scatter(X_previsao_reglin, y_previsao_reglin, label=\"Aproxima\u00e7\u00e3o\")\nplt.scatter(X_previsao_futura_reglin, Y_previsao_futura_reglin, label=\"Previs\u00e3o\")\nplt.xlabel(\"mes\")\nplt.ylabel(\"Volume\")\nplt.title(\"Volume de trafego por m\u00eas (Regress\u00e3o linear)\")\nplt.legend(loc=\"best\")\n","2a5ba895":"#Dados Redes Neurais\nX_previsao_RNA = X\nY_previsao_RNA = RNA.predict(escala.transform(X_previsao_RNA))\n\nX_previsao_futura_RNA = np.array([np.arange(121.145)])\nX_previsao_futura_RNA = X_previsao_futura_RNA.transpose()\nY_previsao_futura_RNA = RNA.predict(escala.transform(X_previsao_futura_RNA))\n","dc9e83c1":"#redes neurais\nplt.scatter(X, Y, label=\"Real\")\nplt.scatter(X_previsao_RNA, Y_previsao_RNA, label=\"Aproxima\u00e7\u00e3o\")\nplt.scatter(X_previsao_futura_RNA, Y_previsao_futura_RNA, label=\"Previs\u00e3o\")\nplt.xlabel(\"mes\")\nplt.ylabel(\"Volume\")\nplt.title(\"Volume de trafego por m\u00eas (Redes neurais)\")\nplt.legend(loc=\"best\")","168ff547":"# Pr\u00e9_Procesamento","a41cc9f1":"# P\u00f3s-Processamento","5c1d21b8":"#  Pre\u00e2mbulo","d350ed7a":"# Processamento","fd2eb93e":"# Carregar o dataset"}}