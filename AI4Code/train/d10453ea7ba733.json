{"cell_type":{"4c83056c":"code","2c054d11":"code","e44e51f0":"code","2c32692c":"code","c80dd11b":"code","607778ea":"code","aaabb312":"code","8c0bf1ec":"code","cad0ed1a":"code","47b0193b":"code","07f76459":"code","cb7342bd":"code","d0ee8da8":"code","f50e8d79":"code","010e3132":"code","254eb59f":"code","50c76630":"code","1c61b96e":"code","d81167df":"code","c0246253":"code","0e53c9b7":"code","80c2d13f":"code","eed22283":"code","82cf59dd":"code","77768991":"code","d24f5471":"code","ba18e6f2":"code","2f30a4ed":"code","471425d9":"code","99aee96e":"code","1f103eb7":"code","3c8683f3":"code","9ec32146":"code","b11ae947":"code","75208f26":"code","7b4362f9":"code","7d6618b5":"code","696bf750":"code","e07ff66b":"code","ada55e4e":"code","189547bb":"code","f83cb8bd":"markdown","8953a946":"markdown","1d1fc1bb":"markdown","2555de69":"markdown","eae2cb20":"markdown","83444f7a":"markdown","7e0a19d2":"markdown","83d4748e":"markdown","33a090c2":"markdown","c395e5ce":"markdown","a9344972":"markdown","522f0475":"markdown","ec40a4f2":"markdown","5de60bfa":"markdown","134a9d46":"markdown","876827b5":"markdown","5d1630d2":"markdown","c2b6dce6":"markdown","6f5eeec1":"markdown","648525fe":"markdown","b0693796":"markdown","d9d0fd25":"markdown","d6b9e3ca":"markdown","0df89d26":"markdown","20e46f04":"markdown","ebb43b42":"markdown","3eccf1a8":"markdown"},"source":{"4c83056c":"import pandas as pd \nimport seaborn as sns\nimport warnings\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\nwarnings.filterwarnings('ignore')\ndata=pd.read_csv('..\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv')\ndata.head()","2c054d11":"data.info()","e44e51f0":"data.drop(['id'],axis=1,inplace=True)","2c32692c":"data.describe()","c80dd11b":"data.describe(include='object')","607778ea":"data.gender.value_counts()","aaabb312":"plt.pie(data.gender.value_counts(),explode=[.1,.3,.2],startangle=90,autopct='%.2f%%',labels=['female','male','other'],radius=10,colors=['blue','pink','red'])\nplt.axis('equal')\nplt.title('Gender',fontdict={'fontsize':22,'fontweight':'bold'})\nplt.show()","8c0bf1ec":"data.drop(data[data.gender=='Other'].index,inplace=True,axis=0)","cad0ed1a":"plt.figure(figsize=(10,8))\nsns.countplot(data.gender,hue=data.stroke,palette='Paired_r')\nplt.show()","47b0193b":"data.gender=pd.Categorical(data.gender,categories=['Male','Female'],ordered=True).codes","07f76459":"data.ever_married.value_counts()","cb7342bd":"plt.pie(data.ever_married.value_counts(),colors=['green','orchid'],autopct='%0.2f%%',explode=[.1,.2],startangle=90,labels=['Married','Unmarried'],radius=10)\nplt.title('Marital Status',fontdict={'fontsize':22,'fontweight':'bold'})\nplt.axis('equal')\nplt.show()","d0ee8da8":"plt.figure(figsize=(10,8))\nsns.countplot(data.ever_married,hue=data.stroke,palette='CMRmap_r')\nplt.show()","f50e8d79":"data.ever_married=pd.Categorical(data.ever_married,categories=['No','Yes'],ordered=True).codes","010e3132":"plt.figure(figsize=(10,8))\nplt.pie(data.work_type.value_counts(),autopct='%.2f%%',explode=[.1,.2,.2,1,.3],radius=20,startangle=90,labels=['Private','self-employed','children','Govt_job','never_worked'])\nplt.title('Type of work',fontdict={'fontsize':22,'fontweight':'bold'})\nplt.axis('equal')\nplt.show()","254eb59f":"plt.figure(figsize=(10,8))\npt=sns.countplot(data.work_type,hue=data.stroke)\nplt.show()","50c76630":"data.work_type=pd.Categorical(data.work_type).codes","1c61b96e":"plt.figure(figsize=(10,8))\nplt.pie(data.Residence_type.value_counts(),autopct='%.2f%%',explode=[.1,.2],radius=10,startangle=90,labels=['Urban','Rural'])\nplt.title('Type of recidence',fontdict={'fontsize':22,'fontweight':'bold'})\nplt.axis('equal')\nplt.show()","d81167df":"plt.figure(figsize=(10,8))\nsns.countplot(data.Residence_type,hue=data.stroke,palette='CMRmap')\nplt.show()","c0246253":"data.Residence_type=pd.Categorical(data.Residence_type,categories=['Rural','Urban'],ordered=True).codes","0e53c9b7":"(data.bmi.isnull().sum()\/len(data.bmi))*100","80c2d13f":"data.bmi.fillna(method='bfill',inplace=True)","eed22283":"plt.figure(figsize=(10,8))\nsns.distplot(data.bmi)\nplt.title('BMI',fontdict={'fontsize':22,'fontweight':'bold'})\nplt.show()","82cf59dd":"plt.figure(figsize=(10,8))\nplt.pie(data.smoking_status.value_counts(),autopct='%.2f%%',explode=[.1,.2,1,.3],radius=10,startangle=90,labels=['Never smoked','unknown','formerly smoked','smokers'])\nplt.title('Smoking Status',fontdict={'fontsize':22,'fontweight':'bold'})\nplt.axis('equal')\nplt.show()","77768991":"plt.figure(figsize=(10,8))\nsns.countplot(data.smoking_status,hue=data.stroke,palette='PuBu')\nplt.show()","d24f5471":"data.smoking_status=pd.Categorical(data.smoking_status,categories=['never smoked','Unknown','formerly smoked','smokes'],ordered=True).codes","ba18e6f2":"plt.figure(figsize=(20,10))\nsns.pairplot(data)\nplt.show()","2f30a4ed":"plt.figure(figsize=(20,10))\nsns.heatmap(data.corr(),annot=True)\nplt.show()","471425d9":"data.skew()","99aee96e":"from sklearn.model_selection import StratifiedShuffleSplit\nsplit=StratifiedShuffleSplit(test_size=.2,random_state=42,n_splits=1)\nfor train_index,test_index in split.split(data,data['stroke']):\n    train_data=data.iloc[train_index]\n    test_data=data.iloc[test_index]","1f103eb7":"train_x=train_data.iloc[:,:10]\ntrain_y=train_data.iloc[:,10]\ntest_x=test_data.iloc[:,:10]\ntest_y=test_data.iloc[:,10]","3c8683f3":"from sklearn.metrics import classification_report\nfrom sklearn.model_selection import GridSearchCV","9ec32146":"from sklearn.linear_model import LogisticRegression\nmodel1=LogisticRegression(max_iter=1000,tol=.01)\nmodel1.fit(train_x,train_y)","b11ae947":"train_pred=model1.predict(train_x)\ntest_pred=model1.predict(test_x)\nprint('Classification Report of train_data \\n',classification_report(train_y,train_pred))\nprint('Classification Report of test_data \\n',classification_report(test_y,test_pred))","75208f26":"from sklearn.tree import DecisionTreeClassifier\nmodel2=DecisionTreeClassifier(max_depth=8)\nmodel2.fit(train_x,train_y)","7b4362f9":"train_pred=model2.predict(train_x)\ntest_pred=model2.predict(test_x)\nprint('Classification Report of train_data \\n',classification_report(train_y,train_pred))\nprint('Classification Report of test_data \\n',classification_report(test_y,test_pred))","7d6618b5":"from sklearn.ensemble import RandomForestClassifier\nmodel3=RandomForestClassifier(max_depth=8)\nmodel3.fit(train_x,train_y)","696bf750":"train_pred=model3.predict(train_x)\ntest_pred=model3.predict(test_x)\nprint('Classification Report of train_data \\n',classification_report(train_y,train_pred))\nprint('Classification Report of test_data \\n',classification_report(test_y,test_pred))","e07ff66b":"from sklearn.neighbors import KNeighborsClassifier\nKNN=KNeighborsClassifier()\nmodel4=GridSearchCV(KNN,param_grid={'n_neighbors':range(3,9)})\nmodel4.fit(train_x,train_y)","ada55e4e":"model4.best_params_","189547bb":"train_pred=model4.predict(train_x)\ntest_pred=model4.predict(test_x)\nprint('Classification Report of train_data \\n',classification_report(train_y,train_pred))\nprint('Classification Report of test_data \\n',classification_report(test_y,test_pred))","f83cb8bd":"In categorical dtypes all data seems to be uniformly distributed","8953a946":"Id doesn't seems to have any impact on the output prediction thus can drop it.","1d1fc1bb":"## KNeighborsClassifier","2555de69":"## Ever Married","eae2cb20":"## Recidence type","83444f7a":"From the above information it is clear that only some data in bmi column is missing and rest columns have 5110 numbers of attributes.","7e0a19d2":"Attribute Information\n\n\n1) id: unique identifier\n\n2) gender: \"Male\", \"Female\" or \"Other\"\n\n3) age: age of the patient\n\n4) hypertension: 0 if the patient doesn't have hypertension, 1 if the patient has hypertension\n\n5) heart_disease: 0 if the patient doesn't have any heart diseases, 1 if the patient has a heart disease\n\n6) ever_married: \"No\" or \"Yes\"\n\n7) work_type: \"children\", \"Govt_jov\", \"Never_worked\", \"Private\" or \"Self-employed\"\n\n8) Residence_type: \"Rural\" or \"Urban\"\n\n9) avg_glucose_level: average glucose level in blood\n\n10) bmi: body mass index\n\n11) smoking_status: \"formerly smoked\", \"never smoked\", \"smokes\" or \"Unknown\"*\n\n12) stroke: 1 if the patient had a stroke or 0 if not","83d4748e":"## Work Type","33a090c2":"It is quite evident that the childrens are very less prone to stroke.","c395e5ce":"## RandomForestClassifier ","a9344972":"# Objective\nAccording to the World Health Organization (WHO) stroke is the 2nd leading cause of death globally, responsible for approximately 11% of total deaths.\nThis dataset is used to predict whether a patient is likely to get stroke based on the input parameters like gender, age, various diseases, and smoking status. Each row in the data provides relavant information about the patient.","522f0475":"## Gender","ec40a4f2":"Filling empty values in BMI with mean value of the BMI column.","5de60bfa":"The graph of BMI distribution is quite uniform","134a9d46":"As we have seen earlier that [ 'hypertension' , 'heart_disease' , 'stroke'] are highly skew so we use here stratified suffule split to evenly split data. \n","876827b5":"## Multi-Variate Analysis ","5d1630d2":"## spliting of data ","c2b6dce6":"#### Conclusion:- Though test accuracy of all models are about same i .e, 95% but LogisticRegression can be selected as an apt model because it give good precision for predicting 1 but no other model have and good responce in predicting 1. ","6f5eeec1":"## Model Selection","648525fe":"As there is only one row with gender as 'Other' so can drop it. By treating it as outlier","b0693796":"## Body Mass Index","d9d0fd25":"## Smoking Status","d6b9e3ca":"we can observe here that ever_married and age have high correlation i.e, 68% but as it is less then 90% it have no chane of collinearity in the feature.","0df89d26":"#### from the above table it is quite evident that though most of the columns are uniformly distributed but columns like ['hypertension','heart_disease','stroke'] have more than 75 percentile as 0 and very few numbers of 1.","20e46f04":"# DecisionTreeClassifier","ebb43b42":"## LogisticRegression","3eccf1a8":"From above countplot it is quite evident that females are quite less prone to strokes, though number of female data is more than that of male."}}