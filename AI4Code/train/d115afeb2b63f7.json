{"cell_type":{"d234446d":"code","35d92137":"code","aac27437":"code","58c5039c":"code","d15fe0d6":"code","72337045":"code","a581dc06":"code","9f59652b":"code","e0382a8e":"code","c562d371":"code","232e4cd9":"code","cc0496c8":"code","add00d54":"code","3a91f6ca":"code","60c80cb1":"markdown","11e49152":"markdown","91b377bd":"markdown","bac44393":"markdown","34e196e0":"markdown","be9f7be6":"markdown","d14d88f7":"markdown","cdd20f53":"markdown","e61658ad":"markdown","035078a4":"markdown"},"source":{"d234446d":"import tensorflow as tf\nimport pandas as pd\nimport matplotlib.pyplot as plt\ntest_data=pd.read_csv('\/kaggle\/input\/titanic\/test.csv')\ntrain_data=pd.read_csv('\/kaggle\/input\/titanic\/train.csv')","35d92137":"train_data.head()","aac27437":"x_1=train_data.drop([\"PassengerId\",\"Survived\",\"Name\",\"Ticket\",\"Cabin\",\"Embarked\"],axis=1)\nx_1=x_1.fillna(0)\ny_1=train_data[\"Survived\"]\ny_1=y_1.fillna(0)\nx_1,y_1","58c5039c":"from sklearn.compose import make_column_transformer\nfrom sklearn.preprocessing import MinMaxScaler, OneHotEncoder\ncf= make_column_transformer(\n    (MinMaxScaler(),[\"Pclass\", \"Age\", \"SibSp\", \"Parch\",\"Fare\"]),\n    (OneHotEncoder(handle_unknown=\"ignore\"),[\"Sex\"])    \n)\nfrom sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test= train_test_split(x_1,y_1, random_state=42)\ncf.fit(x_train)\nx_train_normal=cf.transform(x_train)\nx_test_normal=cf.transform(x_test)","d15fe0d6":"x_train_normal[0]","72337045":"tf.random.set_seed(42)\nmodel_titanic=tf.keras.Sequential([\n      tf.keras.layers.Dense(10, input_shape=(7,), activation=\"relu\"),\n      tf.keras.layers.Dense(600, activation=\"tanh\"),\n      tf.keras.layers.Dense(200, activation=\"tanh\"),\n      tf.keras.layers.Dense(10, activation=\"relu\"),\n      tf.keras.layers.Dense(1, activation=\"sigmoid\")\n])\n\nmodel_titanic.compile(loss= tf.keras.losses.BinaryCrossentropy(),\n                      optimizer=tf.keras.optimizers.Adam(lr=3e-4, decay=1e-6),\n                      metrics=[\"accuracy\"])\nhistory=model_titanic.fit(x_train_normal,y_train, epochs=500, verbose=0)","a581dc06":"pd.DataFrame(history.history).plot()\nplt.ylabel(\"loss\")\nplt.xlabel(\"epochs\")","9f59652b":"model_titanic.evaluate(x_test_normal, y_test)","e0382a8e":"test_data=test_data.fillna(0)\ntest_data","c562d371":"Id=test_data[\"PassengerId\"].values\ntest_data=test_data.drop([\"PassengerId\",\"Name\",\"Ticket\",\"Cabin\",\"Embarked\"],axis=1)\ntest_data_normal=cf.transform(test_data)\ntest_data_normal","232e4cd9":"predictions= model_titanic.predict(test_data_normal)\npred=[1 if predictions[i]>0.25 else 0 for i in range(len(test_data_normal))]\npred","cc0496c8":"table=pd.DataFrame()\ndata=pd.read_csv('\/kaggle\/input\/titanic\/gender_submission.csv')\ndata.head()","add00d54":"table['PassengerId']=Id\ntable['Survived']=pred\ntable.head()","3a91f6ca":"table.to_csv('Submission.csv', index=False)","60c80cb1":"Data Visualization:","11e49152":"submission as shown in gender_submission.csv","91b377bd":"Now let us build our model:\nUsing keras ","bac44393":"Let us examine the data:","34e196e0":"Now let us normalize our data and OneHotEncode it: ","be9f7be6":"Now lets use our saved model to predict the outcomes of the test dataset:","d14d88f7":"Evaluation of the model with the split test data set:","cdd20f53":"Now with the real test data, we must:\nFill the null columns with zeroes\nDrop the useless columns","e61658ad":"Dropping all the useless columns of the data and filling the null values with zeroes:","035078a4":"view a sample of the normalized data:"}}