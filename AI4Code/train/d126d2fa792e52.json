{"cell_type":{"3ba91d5e":"code","e823d53f":"code","a9b62844":"code","ed439346":"code","19b94bde":"code","78785441":"code","fe61c24b":"code","dab36648":"code","62f7e47f":"code","940bc2da":"code","77882b30":"code","ddd44550":"code","c0c9a825":"code","e7480f64":"code","e4a6cf28":"code","92433f04":"code","b1111cca":"code","ad2a6d88":"code","2353a7c3":"code","2766aeac":"code","db2e757b":"code","db188b15":"code","21b513b8":"code","dae2d70a":"code","6edf6b0d":"code","e5df7b54":"code","2bbb1c93":"code","73096c01":"code","5d07ec4d":"code","8238d82a":"code","e59fa074":"code","6e1fb3ff":"code","2c17b8a0":"code","bcd81ffd":"code","d74478b5":"code","ca116fb6":"code","b4e50b1e":"code","893c1c5e":"code","6ba76d79":"code","a52c14cf":"code","d0469159":"code","8b4a7050":"code","5da38ca3":"code","caff7a3e":"code","dda2cde7":"code","ebc9af03":"code","fef04406":"code","0c844052":"code","242e30dc":"code","05391f5f":"markdown","ddf567a6":"markdown","7ed821d8":"markdown","53175d7f":"markdown","13974aba":"markdown","9081a83a":"markdown","9e982c5a":"markdown","a73f6755":"markdown","958ba7e0":"markdown","8da378ac":"markdown"},"source":{"3ba91d5e":"import pandas as pd\nimport numpy as np\nimport warnings\nwarnings.filterwarnings(\"ignore\")","e823d53f":"df=pd.read_csv(\"..\/input\/CTG.csv\")","a9b62844":"df.head()","ed439346":"df=df.drop([\"FileName\",\"Date\",\"SegFile\",\"b\",\"e\"],axis=1)","19b94bde":"df.head()","78785441":"df.columns","fe61c24b":"df.shape","dab36648":"df.isnull().sum()","62f7e47f":"df=df.dropna()","940bc2da":"df.isnull().sum()","77882b30":"df.dtypes","ddd44550":"X=df[['LBE', 'LB', 'AC', 'FM', 'UC', 'DL',\n       'DS', 'DP', 'DR']]\nY=df[[\"NSP\"]]","c0c9a825":"from sklearn.preprocessing import StandardScaler, MinMaxScaler\nScaler=StandardScaler()\nX=Scaler.fit_transform(X)\n","e7480f64":"\nfrom sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,Y,test_size=0.3,random_state=42)","e4a6cf28":"from sklearn.svm import SVC\n\nsvm_clf=SVC(kernel=\"poly\",degree=6,coef0=5,gamma=0.1)\nsvm_clf=svm_clf.fit(X_train,y_train)\ny_pred=svm_clf.predict(X_test)\n","92433f04":"from sklearn.metrics import accuracy_score, precision_score, f1_score, recall_score, confusion_matrix","b1111cca":"print(confusion_matrix(y_test,y_pred))","ad2a6d88":"f1_score(y_test,y_pred,average='weighted')","2353a7c3":"\naccuracy_score(y_test,y_pred)","2766aeac":"precision_score(y_test,y_pred,average='weighted')","db2e757b":"recall_score(y_test,y_pred,average=\"weighted\")","db188b15":"from sklearn.tree import DecisionTreeClassifier","21b513b8":"tree_clf=DecisionTreeClassifier(min_samples_split=6, min_samples_leaf=4, max_depth=6, )\ntree_clf=tree_clf.fit(X_train,y_train)\ny_pred=tree_clf.predict(X_test)","dae2d70a":"accuracy_score(y_test,y_pred)","6edf6b0d":"recall_score(y_test,y_pred,average=\"weighted\")","e5df7b54":"precision_score(y_test,y_pred,average='weighted')","2bbb1c93":"from sklearn.tree import export_graphviz\nexport_graphviz(\ntree_clf, out_file=\"tree.dot\",\nfeature_names=['LBE', 'LB', 'AC', 'FM', 'UC', 'DL',\n       'DS', 'DP', 'DR'],\nclass_names=\"NSP\",\nrounded=True,\nfilled=True)","73096c01":"from subprocess import check_call\ncheck_call(['dot','-Tpng','tree.dot','-o','tree.png'])","5d07ec4d":"from sklearn.ensemble import VotingClassifier, RandomForestClassifier","8238d82a":"svm_clf=SVC(kernel=\"poly\",degree=6,coef0=5,gamma=0.1,probability=True)\ndecision_tree=DecisionTreeClassifier(min_samples_split=6, min_samples_leaf=4, max_depth=6)\nrnd_clf=RandomForestClassifier()\nvoting_clf=VotingClassifier(estimators=[(\"svm\",svm_clf),('rf',rnd_clf),(\"decision_tree\",decision_tree)],voting=\"hard\")","e59fa074":"voting_clf.fit(X_train,y_train)","6e1fb3ff":"for clf in (rnd_clf, svm_clf,decision_tree, voting_clf):\n    clf.fit(X_train, y_train)\n    y_pred = clf.predict(X_test)\n    print(clf.__class__.__name__, accuracy_score(y_test, y_pred))","2c17b8a0":"from sklearn.ensemble import BaggingClassifier","bcd81ffd":"bag_clf=BaggingClassifier(DecisionTreeClassifier(),n_estimators=500,n_jobs=-1,max_samples=100, bootstrap=True)","d74478b5":"bag_clf.fit(X_train,y_train)\ny_pred=bag_clf.predict(X_test)","ca116fb6":"print(accuracy_score(y_test,y_pred))","b4e50b1e":"##This accuracy is better than our previous decision tree model\n##Therefore, we will again call ensemble technique.","893c1c5e":"voting_clf=VotingClassifier(estimators=[(\"svm\",svm_clf),('rf',rnd_clf),(\"bagging_clf\",bag_clf)],voting=\"hard\")","6ba76d79":"for clf in (rnd_clf, svm_clf,bag_clf, voting_clf):\n    clf.fit(X_train, y_train)\n    y_pred = clf.predict(X_test)\n    print(clf.__class__.__name__, accuracy_score(y_test, y_pred))","a52c14cf":"##Using trial and hit method, and performing out-of-box evaluation\n##Since a predictor never sees the oob instances during training, it can be evaluated on these instances,\n##without the need for a separate validation set or cross-validation. You can evaluate the ensemble itself by\n##averaging out the oob evaluations of each predictor.","d0469159":"bag_clf=BaggingClassifier(DecisionTreeClassifier(),n_estimators=500,n_jobs=-1,max_samples=100, bootstrap=True,oob_score=True)\nbag_clf.fit(X_train,y_train)\ny_pred=bag_clf.predict(X_test)\nprint(bag_clf.oob_score_)\nprint(accuracy_score(y_test,y_pred))","8b4a7050":"from sklearn.ensemble import AdaBoostClassifier","5da38ca3":"ada_clf=AdaBoostClassifier(DecisionTreeClassifier(max_depth=1),n_estimators=1000,learning_rate=0.1)","caff7a3e":"ada_clf.fit(X_train,y_train)\ny_pred=ada_clf.predict(X_test)","dda2cde7":"print(accuracy_score(y_test,y_pred))","ebc9af03":"from xgboost import XGBClassifier\nxgb_clf=XGBClassifier(learning_rate=0.001)\nxgb_clf.fit(X_train,y_train)\ny_pred=xgb_clf.predict(X_test)","fef04406":"print(accuracy_score(y_test,y_pred))","0c844052":"voting_clf=VotingClassifier(estimators=[(\"svm\",svm_clf),(\"xgb_clf\",xgb_clf)],voting=\"hard\")\n","242e30dc":"for clf in (svm_clf,xgb_clf, voting_clf):\n    clf.fit(X_train, y_train)\n    y_pred = clf.predict(X_test)\n    print(clf.__class__.__name__, accuracy_score(y_test, y_pred))","05391f5f":"## Calculating different metrics","ddf567a6":"## Peforming the scaling","7ed821d8":"## As, we can observe that there is a slight increase in the overall acuracy while using the ensemble model.","53175d7f":"### CHecking for appropriate values of gamma","13974aba":"# Decision Tree Classifier","9081a83a":"## FileName:\tof CTG examination\t\n## Date:\tof the examination\t\n## b:\tstart instant\t\n## e:\tend instant\t\n## LBE:\tbaseline value (medical expert)\t\n## LB:\tbaseline value (SisPorto)\t\n## AC:\taccelerations (SisPorto)\t\n## FM:\tfoetal movement (SisPorto)\t\n## UC:\tuterine contractions (SisPorto)\t\n## ASTV:\tpercentage of time with abnormal short term variability  (SisPorto)\t\n## mSTV:\tmean value of short term variability  (SisPorto)\t\n## ALTV:\tpercentage of time with abnormal long term variability  (SisPorto)\t\n## mLTV:\tmean value of long term variability  (SisPorto)\t\n## DL:\tlight decelerations\t\n## DS:\tsevere decelerations\t\n## DP:\tprolongued decelerations\t\n## DR:\trepetitive decelerations\t\n## Width:\thistogram width\t\n## Min:\tlow freq. of the histogram\t\n## Max:\thigh freq. of the histogram\t\n## Nmax:\tnumber of histogram peaks\t\n## Nzeros:\tnumber of histogram zeros\t\n## Mode:\thistogram mode\t\n## Mean:\thistogram mean\t\n## Median:\thistogram median\t\n## Variance:\thistogram variance\t\n## Tendency:\thistogram tendency: -1=left assymetric; 0=symmetric; 1=right assymetric\t\n## A:\tcalm sleep\t\n## B:\tREM sleep\t\n## C:\tcalm vigilance\t\n## D:\tactive vigilance\t\n## SH:\tshift pattern (A or Susp with shifts)\t\n## AD:\taccelerative\/decelerative pattern (stress situation)\t\n## DE:\tdecelerative pattern (vagal stimulation)\t\n## LD:\tlargely decelerative pattern\t\n## FS:\tflat-sinusoidal pattern (pathological state)\t\n## SUSP:\tsuspect pattern\t\n## CLASS:\tClass code (1 to 10) for classes A to SUSP\t\n## NSP:\tNormal=1; Suspect=2; Pathologic=3\t\n","9e982c5a":"# Applying XGBoost","a73f6755":"## Classifiying the NSP into, Normal=1; Suspect=2; Pathologic=3","958ba7e0":"# Applying the ADAboost ","8da378ac":"# Using the ensemble technique"}}