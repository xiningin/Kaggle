{"cell_type":{"3b591d43":"code","3d48a8bc":"code","ed6cb424":"code","558ed11d":"code","53b24d9e":"code","24c30d20":"code","90e5a6e3":"code","735d7dae":"code","d25c3f0d":"code","eecbc335":"code","5fa5b703":"code","1dd58d81":"code","0b8cf712":"code","85adbe61":"code","f83f01fa":"code","08ebee84":"code","a765722c":"code","c0a6698c":"code","3942a273":"code","1fea1b96":"code","270e8211":"code","40209ff7":"code","4561d726":"code","18f87b69":"code","e1a720fc":"code","38505a49":"code","6db6f592":"code","4849f0a4":"code","9cc207cf":"code","67abaf28":"code","b86e9316":"code","d33eb5fd":"code","f089938e":"code","d8f82c8f":"code","c5e1ab4d":"code","199e9e03":"code","088a7c4d":"code","b52944b2":"code","d9cb6b84":"code","f414a7b3":"code","158c5343":"code","ffca72dd":"code","8d90b14f":"code","833a1ea6":"code","38a7a65a":"code","14d35e13":"code","945e1094":"code","0a78bd11":"code","f25d1faf":"code","eb072ae9":"code","e911926b":"code","2b47d265":"code","7cc16cb8":"code","0ab7eb87":"code","c4577d9a":"code","847d1418":"code","4d1b1e80":"code","2764c83d":"code","869410d8":"code","7e34195a":"code","de5455c2":"code","077c4386":"code","0d4e7a5f":"code","f74df778":"code","5f9a6e01":"code","c0ebdb89":"code","601f529e":"code","5ce3e32d":"code","0e06d5f2":"code","81b88e02":"code","1048dcbc":"code","28ca88a7":"code","c21cc110":"code","95cc5461":"code","ee8516ed":"code","6ca33707":"code","5a041227":"code","be3ddca5":"code","b7ff106a":"code","ce025c77":"code","ed9cdc32":"markdown","7b0f839c":"markdown","d827b057":"markdown","193f6648":"markdown","573fba05":"markdown","126359bf":"markdown","852acefe":"markdown","1b1122ce":"markdown","c761eb50":"markdown","1f3e1652":"markdown","b57f8be4":"markdown","26e8d992":"markdown","3f9df1b0":"markdown","e6f3ec62":"markdown","72ca7b7c":"markdown","2f6366fd":"markdown","ce835341":"markdown","9ba14de7":"markdown"},"source":{"3b591d43":"#importing relevant libraries\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn import tree","3d48a8bc":"from numpy import array\nfrom numpy import argmax\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.preprocessing import OneHotEncoder","ed6cb424":"#uploading the Titanic dataset\ndf1 = pd.read_csv('..\/input\/gender_submission.csv')\ndf2 = pd.read_csv('..\/input\/test.csv')\ndf3 = pd.read_csv('..\/input\/train.csv')","558ed11d":"#previewing our data i.e the gender_submission data\ndf1.head()","53b24d9e":"#previewing our test data i.e test data\ndf2.head()","24c30d20":"#previewing our train data\ndf3.head()","90e5a6e3":"#copy of train data\nclean_data = df3.copy()\n#copy of test data\nclean_data2 = df2.copy()\n#y_train\ny=clean_data[['Survived']].copy()","735d7dae":"#Dropping unnecessary columns\ndf2 = df2.drop(['PassengerId','Name','Ticket','Cabin','Embarked','Fare'],axis=1)","d25c3f0d":"#Replacing null values with mean\ndf2 = df2.fillna(df2.mean())","eecbc335":"#are there any null values?\ndf3.isnull().any()","5fa5b703":"#Replacing null values with mean\ndf3 = df3.fillna(df3.mean())","1dd58d81":"df3.columns","0b8cf712":"#Dropping unnecessary columns\ndf3 = df3.drop(['PassengerId','Name','Ticket','Cabin','Embarked','Fare','Survived'],axis=1)","85adbe61":"#creating a copy of gender in both train and test datasets before encoding\ngender=df3[['Sex']].copy()\n\ngender2=df2[['Sex']].copy()","f83f01fa":"values = array(gender)\n#Integer encoding\nlabel_encoder = LabelEncoder()\ninteger_encoded = label_encoder.fit_transform(values)","08ebee84":"values2 = array(gender2)\n#Integer encoding(df2)\nlabel_encoder2 = LabelEncoder()\ninteger_encoded2 = label_encoder2.fit_transform(values2)","a765722c":"#Binary encoding\nonehot_encoder = OneHotEncoder(sparse=False)\ninteger_encoded = integer_encoded.reshape(len(integer_encoded),1)\nonehot_encoded = onehot_encoder.fit_transform(integer_encoded)","c0a6698c":"#Binary encoding(df2)\nonehot_encoder = OneHotEncoder(sparse=False)\ninteger_encoded2 = integer_encoded.reshape(len(integer_encoded),1)\nonehot_encoded2 = onehot_encoder.fit_transform(integer_encoded2)","3942a273":"#Inverting back NOT RUN YET\n#inverted = label_encoder.inverse_transform([argmax(onehot_encoded[0:])])","1fea1b96":"#Replacing the coded column in the dataframe for train data\nsex = pd.DataFrame(integer_encoded)\ndf3['Sex'] = sex\n#Replacing the coded column in the dataframe for test data\nsex = pd.DataFrame(integer_encoded2)\ndf2['Sex'] = sex","270e8211":"#Assessing descriptives on Sex variable in train dataset\ndf3['Sex'].describe()","40209ff7":"#basic information about our train data\ndf3.info()","4561d726":"#type of each column values\ndf3.dtypes","18f87b69":"df3['Age'].head()","e1a720fc":"df3.index","38505a49":"df3.describe()","6db6f592":"#number of times the unique Survived appear\nclean_data['Survived'].value_counts()","4849f0a4":"df3['Sex'].value_counts()","9cc207cf":"df2['Sex'].value_counts()","67abaf28":"#Checking the variables in train data\ndf3.columns","b86e9316":"plt.style.use(\"classic\")\n#plt.style.use(\"fivethirtyeight\")\nplt.style.use(\"ggplot\")\n#plt.style.use(\"seaborn-whitegrid\")\n#plt.style.use(\"seaborn-pastel\")\n#plt.style.use([\"dark_background\", \"fivethirtyeight\"])","d33eb5fd":"#histogram for Age\n\ncount, bin_edges = np.histogram(df3,15)\n\ndf3['Age'].plot(kind = 'hist',\n               figsize = (10,6),\n               bins = 15,\n               xticks = bin_edges\n               )\n\nplt.title(' Histogram of Age in Titanic (train) dataset')\nplt.xlabel('Age')\nplt.show()","f089938e":"df3['Sex'].value_counts()","d8f82c8f":"import seaborn as sns\nplt.figure(figsize=(10,6))\nsns.set(style=\"darkgrid\")\nax = sns.countplot(x=\"Sex\", data=clean_data,saturation=.80)","c5e1ab4d":"import seaborn as sns\nplt.figure(figsize=(10,6))\nsns.set(style=\"darkgrid\")\n#tit = sns.load_dataset(\"clean_data\")\nax = sns.countplot(x=\"Pclass\",hue=\"Sex\", data=clean_data)","199e9e03":"import seaborn as sns\nplt.figure(figsize=(10,6))\nsns.set(style=\"darkgrid\")\nax = sns.countplot(x='SibSp', data=clean_data, saturation=.80)","088a7c4d":"import seaborn as sns\nplt.figure(figsize=(10,6))\n\nsns.set(style=\"darkgrid\")\nax = sns.countplot(x='Parch', data=clean_data,saturation=.80)","b52944b2":"clean_data['Survived'].corr(clean_data['Fare'])","d9cb6b84":"clean_data['Survived'].corr(df3['Age'])","f414a7b3":"clean_data['Survived'].corr(df3['Sex'])","158c5343":"clean_data['Survived'].corr(df3['Pclass'])","ffca72dd":"clean_data['Survived'].corr(df3['SibSp'])","8d90b14f":"clean_data['Survived'].corr(df3['Parch'])","833a1ea6":"#scatterplot of Age and survival in seaborn\nplt.figure(figsize=(10,6))\n\nsns.set(font_scale=1.5)\nx = df3['Age']\ny = clean_data['Survived']\nsns.regplot(x,y, fit_reg=True, color = 'green')","38a7a65a":"#scatterplot of Sex and survival in seaborn\nplt.figure(figsize=(10,6))\n\nx = df3['Sex']\ny = clean_data['Survived']\nsns.regplot(x,y, fit_reg=True)","14d35e13":"#scatterplot of Pclass and survival in seaborn\nplt.figure(figsize=(10,6))\n\nx = df3['Pclass']\ny = clean_data['Survived']\nsns.regplot(x,y, fit_reg=True)","945e1094":"#scatterplot of Parch and survival in seaborn\nplt.figure(figsize=(10,6))\nx = df3['Parch']\ny = clean_data['Survived']\nsns.regplot(x,y, fit_reg=True)","0a78bd11":"#scatterplot of SibSp and survival in seaborn\nplt.figure(figsize=(10,6))\nx = df3['SibSp']\ny = clean_data['Survived']\nsns.regplot(x,y, fit_reg=True)","f25d1faf":"plt.figure(figsize=(10,6))\nsns.violinplot(y = 'Survived', x = 'Parch', data = clean_data, inner = 'quartile')","eb072ae9":"plt.figure(figsize=(10,6))\nsns.violinplot(y = 'Survived', x = 'SibSp', data = clean_data, inner = 'quartile')","e911926b":"plt.figure(figsize=(10,6))\nsns.violinplot(y = 'Survived', x = 'Sex', data = clean_data, inner = 'quartile')","2b47d265":"plt.figure(figsize=(10,6))\nsns.violinplot(y = 'Survived', x = 'Pclass', data = clean_data, inner = 'quartile')","7cc16cb8":"survival_feautures = ['Sex','Pclass','Parch','SibSp', 'Age']","0ab7eb87":"X = df3[survival_feautures].copy()","c4577d9a":"X.columns","847d1418":"y.head()","4d1b1e80":"#Fitting a DecisionTree\n\nsurvival_classifier = DecisionTreeClassifier(max_leaf_nodes=10, random_state=389)\nsurvival_classifier.fit(X, y)","2764c83d":"type(survival_classifier)","869410d8":"from sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.ensemble import RandomForestClassifier","7e34195a":"#Fitting a RandomForest\n\nrf_model = RandomForestClassifier(n_estimators=1000,max_features=3,oob_score=True,random_state = 389)","de5455c2":"rf_model.fit(X,y)","077c4386":"df2.columns","0d4e7a5f":"df2.head()","f74df778":"df2.info()","5f9a6e01":"#predicting on method 1\npredictions = survival_classifier.predict(df2)","c0ebdb89":"#predicting on method 2\npredictions2 = rf_model.predict(df2)","601f529e":"predictions[:10]","5ce3e32d":"predictions2[:10]","0e06d5f2":"type(predictions2)","81b88e02":"#data frame on prediction\npred_survivors = pd.DataFrame(predictions)\npred_survivors.columns = ['survived']\n\nframes = [clean_data2,pred_survivors]\n\nresult = pd.concat(frames, axis=1)","1048dcbc":"#data frame on prediction 2\npred_survivors2 = pd.DataFrame(predictions2)\npred_survivors2.columns = ['survived2']\n\nframes2 = [clean_data2, pred_survivors2]\n\nresult2 = pd.concat(frames2, axis=1)","28ca88a7":"#Dropping unnecessary columns from the output\noutput = result.drop(['Pclass','Name','Sex','Age','SibSp','Parch','Ticket','Fare','Cabin','Embarked'],axis=1)\n\noutput2 = result2.drop(['Pclass','Name','Sex','Age','SibSp','Parch','Ticket','Fare','Cabin','Embarked'],axis=1)","c21cc110":"#Print out the head of the expected output\noutput.head()","95cc5461":"#Print out the head of the expected output\noutput2.head()","ee8516ed":"pred_survivors2.head()","6ca33707":"#dropping passengerId to assess accuracy on survived column\ndf1 = df1.drop(['PassengerId'],axis=1)\n\naccuracy_score(y_true=df1,y_pred=predictions)","5a041227":"print(\"OOB_accuracy:\")\nprint(rf_model.oob_score_)","be3ddca5":"for feature, imp in zip(X,rf_model.feature_importances_):\n    print(feature,imp)","b7ff106a":"#printing output (method 1) in csv\n\noutput.to_csv('survived_submission.csv', header=True, index=True, sep=',')","ce025c77":"#Creating Submission dataframe for Kaggle\nmysubmission = pd.DataFrame({\"PassengerId\":clean_data2[\"PassengerId\"],\n                            \"Survived\":pred_survivors2[\"survived2\"]})\n\n#Saving to CSV\nmysubmission.to_csv(\"survived_mysubmission.csv\", index=False)","ed9cdc32":"# Measure Accuracy of the Classifier and Comparing Methods","7b0f839c":"# Previewing our Data","d827b057":"# Using Features to predict Survival","193f6648":"# Data Visualization\n\nExploring the Variables of interest to get a feel of how they look","573fba05":"There data has already been split into train and test. Training should be used to develop a model off features notable in the sample.\n\nThe test data will then be used to assess how well the model performs on unseen data. Since these are merely predictions, a score would help gauge the outcome. the gender_submission provides an idea into how the submission file should look like.","126359bf":"# Binary Classification for Sex","852acefe":"Method 1","1b1122ce":"# Assessing the influence of different variables to the rate of survival","c761eb50":"# Using Decision Trees for Classification (Titanic Data Set)","1f3e1652":"Method 2","b57f8be4":"# Feature Engineering ","26e8d992":"# Violin Plots on Possible Feautures","3f9df1b0":"# Merging predictions array to test dataset","e6f3ec62":"The sinking of the Titanic remains one of the most tragic incidences in ship accidents. 1502 of the total 2224 occupants passed on during the shipwreck. Following the catastrophe, better safety regulations were developed.\n\nThe main task on this dataset is to create a surviver classifier based on a given features such as gender, age and class.","72ca7b7c":"# Goal\nAs such, it is the aim of this notebook to predict if a passenger survived the sinking of the Titanic or not. \nFor each PassengerId in the test set, you must predict a 0 or 1 value for the Survived variable.","2f6366fd":"# Predict on Test Set","ce835341":"# Target is stored in 'y'. ","9ba14de7":"Applying different styles"}}