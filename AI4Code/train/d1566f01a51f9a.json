{"cell_type":{"3c72621e":"code","4420ff2a":"code","eb80ab2f":"code","26253f35":"code","c45504db":"code","3e9217a9":"code","c54f72ff":"code","5ad0e551":"code","bfeb421f":"code","6407b422":"code","99e52d5c":"code","e743a146":"code","58ca0d4a":"code","cf018cbc":"code","c4de3ac9":"code","01ced7b0":"code","ad076c2b":"code","03c3bee1":"code","01c51e87":"code","e189add1":"code","8844e724":"code","ed63514d":"code","354b61ce":"code","f2829558":"code","745c5721":"code","6ee18326":"code","61126dcd":"code","b7777de1":"code","79989760":"code","24b2d8c9":"code","b9119c8e":"code","5f97f635":"code","44b6b6c4":"code","942ce424":"code","9cda438f":"code","b448580a":"code","6f90e77e":"code","2f582fdf":"code","9fe45823":"code","01a14cd9":"markdown","62356524":"markdown","feb46102":"markdown","9026f73d":"markdown","91d135ef":"markdown","8162b66e":"markdown","c5068173":"markdown"},"source":{"3c72621e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","4420ff2a":"import matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","eb80ab2f":"df=pd.read_csv('\/kaggle\/input\/health-care-data-set-on-heart-attack-possibility\/heart.csv')","26253f35":"df.head()","c45504db":"df.tail()","3e9217a9":"df.info()","c54f72ff":"df.describe().transpose()","5ad0e551":"df.isna().sum()","bfeb421f":"df['target'].value_counts()","6407b422":"plt.figure(figsize=(10,6))\nplt.style.use('ggplot')\nsns.set_style('whitegrid')\nsns.countplot(x='sex',data=df)","99e52d5c":"plt.figure(figsize=(12,6))\nsns.heatmap(df.corr(),annot=True,cmap='coolwarm')","e743a146":"df['cp'].value_counts()","58ca0d4a":"df['thalach'].head(10)","cf018cbc":"plt.figure(figsize=(10,6))\nsns.lineplot(x='target',y='cp',data=df)\nplt.title('A line plot depicting the relation between target and chest pain')","c4de3ac9":"plt.figure(figsize=(10,6))\nsns.boxplot(x='cp',y='target',data=df,palette='Set1')\nplt.title('A box plot depicting the relation between target and chest pain')","01ced7b0":"plt.figure(figsize=(8,4))\nsns.violinplot(x='target',y='thalach',data=df)\nplt.title('A violin plot depicting the relation between target and thalach')","ad076c2b":"plt.figure(figsize=(10,8))\nsns.scatterplot(x='target',y='thalach',data=df,palette='Set2')\nplt.title('A scatter plot depicting the relation between target and thalach')","03c3bee1":"import cufflinks as cf\ncf.go_offline()","01c51e87":"df['age'].iplot(kind='hist',bins=25)\n","e189add1":"g=sns.countplot(x='target',data=df,hue='age',palette='Set1')\ng.legend(loc='right', bbox_to_anchor=(1.25, 0.5), ncol=1)\nplt.title('a plot depicting the ages versus target')","8844e724":"g=sns.countplot(x='target',hue='sex',data=df,palette='viridis')\ng.legend(loc='right', bbox_to_anchor=(1.25, 0.5), ncol=1)","ed63514d":"from sklearn.model_selection import train_test_split","354b61ce":"X=df.drop('target',axis=1)\ny=df['target']","f2829558":"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.30,random_state=101)","745c5721":"from sklearn.linear_model import LogisticRegression","6ee18326":"lg=LogisticRegression()","61126dcd":"lg.fit(X_train,y_train)","b7777de1":"predictions=lg.predict(X_test)","79989760":"from sklearn.metrics import classification_report,confusion_matrix","24b2d8c9":"print(classification_report(y_test,predictions))","b9119c8e":"print(confusion_matrix(y_test,predictions))","5f97f635":"df['target'].value_counts()\/len(df)*100","44b6b6c4":"print('Number of correct predictions are {}'.format(36+44))","942ce424":"print('Number of wrong predictions are {}'.format(8+3))","9cda438f":"import random\nrandom.seed(101)\nnum=random.randint(0,len(df))\nnum","b448580a":"new_patient=df.iloc[num]\nnew_patient","6f90e77e":"lg.fit(X_train,y_train)\n","2f582fdf":"pred=lg.predict(new_patient.drop('target').values.reshape(1,-1))","9fe45823":"pred","01a14cd9":"Lets now take a random case and see whether our model predicts it correctly!","62356524":"Our model predicted that the patient does'nt have heart attack which is true!\nTHANK YOU!!!\n","feb46102":"#  **Now since we finished importing and viewing information about the data, lets now do some data visualisation!!**","9026f73d":"Now since we have finished data visualisations, lets train our model using logistic regresssion!\n","91d135ef":"**As we can see, target is mostly dependent on chest pain(cp) and thalach**","8162b66e":"We can see that if the target is 1, there is more chest pain and more thalach\nHence there is a good correlation among them","c5068173":"We can see that there is an accuracy of 88. If our model only predicted all targets as 1, then we would have only 54% accuracy. So our model did a good job!!"}}