{"cell_type":{"659531cd":"code","4e37424b":"code","24aed4bd":"code","56eebb01":"code","686ca5d0":"code","1f975489":"code","c4b3f744":"code","6fe57358":"code","2940bef3":"code","9ebec7e5":"code","7ac06c4f":"code","38f8f0b8":"code","005947c7":"code","8f1f33b0":"code","f6c9d14e":"code","2118a6ff":"code","66a7a681":"code","09f2325b":"code","dceb97e4":"code","1a94da52":"code","ac9f1223":"code","9cf1e56a":"code","6bbecadf":"code","8c06beba":"code","787f9ae5":"code","7d721bd6":"code","d48bd50c":"code","457ec827":"code","51a984f6":"code","67ecc54f":"code","fd90862c":"code","e0ea9b94":"code","f77ee003":"code","df1be213":"code","d8771375":"code","11f10af2":"code","3c532377":"code","71e03852":"code","b2526ec7":"code","fe73eef5":"markdown","369d7f96":"markdown"},"source":{"659531cd":"# !pip install seaborn\n# !pip install sklearn\n# !pip install --user scikit-learn\n# !pip install matplotlib\n# !pip install nltk","4e37424b":"import pandas as pd\nimport numpy as np\nimport string\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom nltk.corpus import stopwords\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.feature_extraction.text import TfidfTransformer\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.svm import SVC\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.naive_bayes import MultinomialNB\nfrom collections import Counter\nfrom sklearn.metrics import classification_report,confusion_matrix\nfrom sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.metrics import classification_report\nfrom sklearn.model_selection import GridSearchCV\n%matplotlib inline","24aed4bd":"data = pd.read_csv('..\/input\/sms-spam-collection-dataset\/spam.csv')\ndata.head()","56eebb01":"data.shape","686ca5d0":"data.drop([\"Unnamed: 2\",\"Unnamed: 3\",\"Unnamed: 4\"],axis=1,inplace=True)","1f975489":"data.head()","c4b3f744":"data.columns = [\"class\",\"message\"]","6fe57358":"data.head()","2940bef3":"data['length'] = [len(d) for d in data.message]","9ebec7e5":"data.head()","7ac06c4f":"data.groupby('class').describe()","38f8f0b8":"sns.countplot(x=data['class'])","005947c7":"sns.barplot(x=data[\"class\"],y=data[\"length\"])","8f1f33b0":"data.drop([\"length\"],axis=1,inplace=True)","f6c9d14e":"data.head()","2118a6ff":"def transform_message(message):\n    message_not_punc = [] # Message without punctuation\n    i = 0\n    for punctuation in message:\n        if punctuation not in string.punctuation:\n            message_not_punc.append(punctuation)\n    # Join words again to form the string.\n    message_not_punc = ''.join(message_not_punc) \n\n    # Remove any stopwords for message_not_punc, but first we should     \n    # to transform this into the list.\n    message_clean = list(message_not_punc.split(\" \"))\n    while i <= len(message_clean):\n        for mess in message_clean:\n            if mess.lower()  in stopwords.words('english'):\n                message_clean.remove(mess)\n        i =i +1\n    return  message_clean","66a7a681":"data['message'].apply(transform_message)","09f2325b":"vectorization = CountVectorizer(analyzer=transform_message)","dceb97e4":"X = vectorization.fit(data[\"message\"])","1a94da52":"X_transform = X.transform(data[\"message\"])","ac9f1223":"print(X_transform)","9cf1e56a":"tfidf_transformer = TfidfTransformer().fit(X_transform)","6bbecadf":"X_tfidf = tfidf_transformer.transform(X_transform)","8c06beba":"print(X_tfidf.shape)","787f9ae5":"X_train, X_test, y_train, y_test = train_test_split(data['message'], data['class'], test_size=0.3,random_state = 50, stratify=data['class'])  ","7d721bd6":"X_train,y_train","d48bd50c":"bow = CountVectorizer(stop_words='english')","457ec827":"# Fit the bag of words on the training docs\nbow.fit(X_train)","51a984f6":"X_train = bow.transform(X_train)\nX_test = bow.transform(X_test)","67ecc54f":"X_train,X_test","fd90862c":"naive_bayes = MultinomialNB()\nnaive_bayes.fit(X_train, y_train)","e0ea9b94":"print(f'Accuracy : {accuracy_score(y_test, naive_bayes.predict(X_test)):.3f}')\nprint(f'Precision : {precision_score(y_test, naive_bayes.predict(X_test), pos_label=\"spam\"):.3f}')\nprint(f'Recall : {recall_score(y_test, naive_bayes.predict(X_test), pos_label=\"spam\"):.3f}')\nprint(f'F1-Score : {f1_score(y_test, naive_bayes.predict(X_test), pos_label=\"spam\"):.3f}')","f77ee003":"predictions = naive_bayes.predict(X_test)","df1be213":"print(predictions)","d8771375":"print (classification_report(y_test, predictions))","11f10af2":"svm_clf = SVC(kernel='linear').fit(X_train, y_train)","3c532377":"print(f'Accuracy : {accuracy_score(y_test, svm_clf.predict(X_test)):.3f}')\nprint(f'Precision : {precision_score(y_test, svm_clf.predict(X_test), pos_label=\"spam\"):.3f}')\nprint(f'Recall : {recall_score(y_test, svm_clf.predict(X_test), pos_label=\"spam\"):.3f}')\nprint(f'F1-Score : {f1_score(y_test, svm_clf.predict(X_test), pos_label=\"spam\"):.3f}')","71e03852":"svm_predictions = svm_clf.predict(X_test)","b2526ec7":"print (classification_report(y_test, svm_predictions))","fe73eef5":"****Naive Bayes Classifier","369d7f96":"****Support Vector Machine Classifier"}}