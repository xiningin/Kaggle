{"cell_type":{"c23cd88f":"code","9ad3e20c":"code","f77eb15c":"code","6c0e9680":"code","1b25d318":"code","1d75029a":"code","6fcc33a7":"code","cfe5403e":"code","64378321":"code","c2bbd21f":"markdown","c6007ea0":"markdown","779f106f":"markdown","97c56b86":"markdown","afc74972":"markdown","99bbffd0":"markdown","bb634b3a":"markdown"},"source":{"c23cd88f":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.neighbors import NearestNeighbors","9ad3e20c":"train = pd.read_csv('..\/input\/ventilator-pressure-prediction\/train.csv')\ntest  = pd.read_csv('..\/input\/ventilator-pressure-prediction\/test.csv')\nsub   = pd.read_csv('..\/input\/ventilator-pressure-prediction\/sample_submission.csv', index_col = \"id\")","f77eb15c":"BL = 80 #Breath length - how many data points we have for each breath","6c0e9680":"samples = train['u_in'].values.reshape((-1, BL))\ntest_samples = test['u_in'].values.reshape((-1, BL))","1b25d318":"plt.plot(samples[0]);","1d75029a":"neigh = NearestNeighbors(n_neighbors=1, metric = 'manhattan')\nneigh.fit(samples)","6fcc33a7":"train_p_loc = train.columns.get_loc('pressure') # integer location of pressure\nsub_p_loc  = sub.columns.get_loc('pressure')\n\nfor idx in range(len(test_samples)):\n    nn = neigh.kneighbors([test_samples[idx]], 1, return_distance=False)[0,0]\n    sub.iloc[idx*BL:(idx+1)*BL, sub_p_loc] = train.iloc[nn*BL:(nn+1)*BL, train_p_loc].values","cfe5403e":"sub","64378321":"sub.to_csv('submission.csv')","c2bbd21f":"A short code using the sklearn nearest neighbor routine. For each test breath, find the train breath with the most similar u_in (MAE metric) and use its pressure.","c6007ea0":"# Check and save","779f106f":"# Define the estimator and fit it to the train data","97c56b86":"# For each test breath, find the nearest neighbor in the train sample and use its pressure","afc74972":"# Extract u_in as a numpy array, check","99bbffd0":"# Introduction","bb634b3a":"# Import libraries and data"}}