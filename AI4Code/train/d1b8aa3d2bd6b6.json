{"cell_type":{"24202ffa":"code","a6cf9b8c":"code","f82b698b":"code","3d640c59":"code","ab74d86c":"code","f16349cc":"code","c8f08d80":"code","32c47fb7":"code","0e07f908":"code","20215b45":"code","53201c23":"code","73f178e2":"code","be195336":"code","181398a5":"code","eeea0cd8":"code","6f57ddec":"code","c2a1cb6b":"code","f9379f57":"code","3686d861":"code","09d17121":"code","9703202e":"code","759fb995":"code","c57e997d":"markdown","0a1dadaf":"markdown","8911f254":"markdown","69dc0bb4":"markdown","52a872df":"markdown","d746856a":"markdown","c4b68868":"markdown","0474c21b":"markdown","aaec3332":"markdown","f522e8f4":"markdown","3fd1af81":"markdown","829e2560":"markdown","b869b56e":"markdown","18475bad":"markdown","8cc07551":"markdown","449a8091":"markdown","752fcb24":"markdown","4191faa0":"markdown","01220b40":"markdown","2cd8354a":"markdown","ad8fab71":"markdown"},"source":{"24202ffa":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport re\nimport nltk\nfrom nltk.corpus import stopwords\nfrom nltk.stem.porter import PorterStemmer\nimport wordcloud\nfrom sklearn import metrics\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import RandomizedSearchCV\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n","a6cf9b8c":"sms_data = pd.read_csv('\/kaggle\/input\/sms-spam-collection-dataset\/spam.csv',encoding = 'latin-1')","f82b698b":"# Let's check the head of our dataframe\nsms_data.head()","3d640c59":"sms_data.drop(sms_data.iloc[:,2:], axis = 1, inplace = True)","ab74d86c":"# Let's check our data again\nsms_data.head()","f16349cc":"sms_data.rename(columns = {'v1': 'label', 'v2' : 'sms'}, inplace = True)","c8f08d80":"sms_data.head()","32c47fb7":"# Let's check whether ther are null values present in the data or not\nsms_data.isnull().any()","0e07f908":"sms_data.label.value_counts().plot.bar(rot = 0)\nplt.xlabel('Class')\nplt.ylabel('Frequency')\nplt.title('SMS class distribution')","20215b45":"sms_data['spam'] = pd.get_dummies(sms_data['label'], drop_first = True)\n\nsms_data.head()","53201c23":"data_ham = sms_data[sms_data['spam'] == 0]\ndata_spam = sms_data[sms_data['spam'] == 1]","73f178e2":"def show_wordcloud(data_spam_or_ham, title):\n    text = ' '.join(data_spam_or_ham['sms'].astype(str).tolist())\n    stopwords = set(wordcloud.STOPWORDS)\n    \n    fig_wordcloud = wordcloud.WordCloud(stopwords = stopwords,background_color = 'lightgrey',\n                    colormap='Accent', width = 800, height = 600).generate(text)\n    \n    plt.figure(figsize = (10,7), frameon = True)\n    plt.imshow(fig_wordcloud)  \n    plt.axis('off')\n    plt.title(title, fontsize = 20 )\n    plt.show()","be195336":"show_wordcloud(data_spam, 'Spam SMS')","181398a5":"show_wordcloud(data_ham, 'Ham SMS')","eeea0cd8":"X = sms_data['sms']\ny = sms_data['spam']","6f57ddec":"def process_data(message):\n    ps = PorterStemmer()   # Porter Stemmer Object\n\n    corpus = []\n\n    for i in range(0, len(message)):\n        review = re.sub('[^A-Za-z]', ' ', message[i])\n        review = review.lower()\n        review = review.split()\n    \n        review = [ps.stem(word) for word in review if word not in(stopwords.words('english'))]\n        review = ' '.join(review)\n        corpus.append(review)\n    return corpus","c2a1cb6b":"corpus = process_data(X)","f9379f57":"corpus","3686d861":"tfidf = TfidfVectorizer(max_features = 4000)\nX = tfidf.fit_transform(corpus).toarray()","09d17121":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, \n                                                    random_state = 101, shuffle = True)","9703202e":"print(X_train.shape)\nprint(X_test.shape)","759fb995":"rf_model = RandomForestClassifier(random_state = 101)\n\nrf_model.fit(X_train, y_train)\ny_pred = rf_model.predict(X_test)\nprint(metrics.classification_report(y_test, y_pred))\n\nconfusion_matrix = metrics.confusion_matrix(y_test,y_pred)\ndisplay(pd.DataFrame(data = confusion_matrix, columns = ['Predicted 0', 'Predicted 1'],\n            index = ['Actual 0', 'Actual 1']))","c57e997d":"Now, since we have the data, all numerical to feed into our machine learning model.\n\nBut, first let's handle the problem of imbalanced class","0a1dadaf":"**And if you liked the notebook please give an upvote. It will boost my confidence and motivation.**\n\n**And any further suggestions for improving this notebook are most welcome as I will be looking to improve this notebook further.**\n\n**Thank you \ud83d\ude00**","8911f254":"### Data Preprocessing","69dc0bb4":"### Splitting the data into Train and Test set","52a872df":"### EDA (Exploratory Data Analysis)","d746856a":"#### Create dependent and independent variables","c4b68868":"***Wordcloud for Ham sms***","0474c21b":"#### Let's see the Distribution of the target variable","aaec3332":"**Clearly we have imbalanced data because ham class has a lot of examples than the spam class.**\n\n**We should handle this issue otherwise our model will overfit to predict only ham\/not spam.**\n\n**But first let's add a numerical label for spam or ham.**","f522e8f4":"#### Let's check our corpus","3fd1af81":"### Train and Test the model","829e2560":"### Bag of Words model (BOW)\nLet's create our Bag of Words model using TF-IDF vectorizer","b869b56e":"### Import the libraries","18475bad":"#### Using Random Forest Classifier","8cc07551":"### Classification of spam messages and non-spam messages\n\nAs we know that the spam messages are very frustrating things and to get out of this problem, our data scientists made the spam classifiers which separates spam messages from non-spam messsages.\n\n*And one real time example of such classifier is used in Gmail which efficiently handles spam mails.*\n\n* I have used random forest classifier to do the classify spam and non-spam messages.","449a8091":"### Load the data","752fcb24":"***Word Cloud for Spam sms***","4191faa0":"#### Let's\n* Remove unwanted Characters from the data.\n* Remove stopwords.\n* Perform stemming.","01220b40":"No null values are present.","2cd8354a":"#### Wordcloud for spam and ham sms","ad8fab71":"* Here the last three columns are null and are not usefull to us. We have to drop it first.\n* And for the first two columns we have to just change the names for our simplicity.\n\n---> We will be doing these in EDA step."}}