{"cell_type":{"4e666b7f":"code","84413882":"code","11dfe524":"code","60f69a18":"code","83cc2082":"code","ee927d0a":"code","2f3495cf":"code","4f5667df":"code","08043f66":"code","6a37c66d":"code","a10423b0":"code","a32a7650":"code","5218a04a":"code","b26b42da":"code","1bcf0406":"code","e97e2f71":"code","2a8f3c0f":"code","d3c7a39d":"code","6507fec6":"code","63fbbef2":"code","039148e2":"code","1f4c0da3":"code","6bd2afdd":"code","b20deb7f":"code","64e27de8":"markdown","e3de7220":"markdown","bb7ac45c":"markdown","ac65ae90":"markdown","b95bcb25":"markdown","88a39df1":"markdown","3f85dc54":"markdown","6cac7a41":"markdown","45bca54a":"markdown","48b9dcb3":"markdown","aaf1ed7f":"markdown","c9f38bea":"markdown","1514d37a":"markdown","88792006":"markdown"},"source":{"4e666b7f":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport datetime\nfrom math import ceil\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_squared_error\nfrom math import sqrt","84413882":"sales_train = pd.read_csv(\"..\/input\/competitive-data-science-predict-future-sales\/sales_train.csv\")\nitems = pd.read_csv(\"..\/input\/competitive-data-science-predict-future-sales\/items.csv\")\nsubmission = pd.read_csv(\"..\/input\/competitive-data-science-predict-future-sales\/sample_submission.csv\")\nsales_test = pd.read_csv(\"..\/input\/competitive-data-science-predict-future-sales\/test.csv\")\nitem_catalog = pd.read_csv(\"..\/input\/competitive-data-science-predict-future-sales\/item_categories.csv\")\nshops = pd.read_csv(\"..\/input\/competitive-data-science-predict-future-sales\/shops.csv\") ","11dfe524":"sales_train.head(10)","60f69a18":"sales_test.head(10)","83cc2082":"items.head(10)","ee927d0a":"plt.figure(figsize=(10,4))\nsns.scatterplot(x=sales_train.item_cnt_day, y=sales_train.item_price, data=sales_train)","2f3495cf":"items=items.drop(\"item_name\",axis=1)","4f5667df":"items.head(10)","08043f66":"sales_train = sales_train[sales_train.item_price<40000]\nsales_train = sales_train[sales_train.item_cnt_day<300]\nsales_train = sales_train[sales_train.item_cnt_day>=0]","6a37c66d":"plt.figure(figsize=(10,4))\nsns.scatterplot(x=sales_train.item_cnt_day, y=sales_train.item_price, data=sales_train)","a10423b0":"training = pd.merge(sales_train, items, on='item_id')\ntrained = training","a32a7650":"training.head(10)","5218a04a":"median = trained[(trained.shop_id==32)&(trained.item_id==2973)&(trained.date_block_num==4)&(trained.item_price>0)].item_price.median()\ntrained.loc[trained.item_price<0, 'item_price'] = median","b26b42da":"training.date = training.date.apply(lambda x:datetime.datetime.strptime(x, \"%d.%m.%Y\"))\ntrained.head()","1bcf0406":"grouped = pd.DataFrame(training.groupby(['shop_id', 'date_block_num','item_id'])['item_cnt_day'].sum().reset_index())\ntotal_item_cnt_mounth = grouped.groupby('date_block_num')['item_cnt_day'].sum()\ngrouped.head(10)","e97e2f71":"total_item_cnt_mounth_np = total_item_cnt_mounth.to_numpy()\ntotal_item_cnt_mounth_np\nmounths = np.arange(34)\n","2a8f3c0f":"X_train, X_test, y_train, y_test = train_test_split(mounths,total_item_cnt_mounth_np, test_size = 1\/3, random_state = 12, shuffle=1)\nX_train = X_train.reshape(-1, 1)\nX_test = X_test.reshape(-1, 1)\ny_train = y_train.reshape(-1, 1)\ny_test = y_test.reshape(-1, 1)","d3c7a39d":"model = LinearRegression(True,True,None,False)\nmodel.fit(X_train, y_train)","6507fec6":"model.predict([[34]])","63fbbef2":"pred = model.predict(X_test)\nrmse = sqrt(mean_squared_error(y_test, pred))\nrmse","039148e2":"pred = model.predict(X_test)\ndf = pd.DataFrame({'Actual': y_test.flatten(), 'Predicted': pred.flatten()})\ndf","1f4c0da3":"submission = df\nsubmission.to_csv('submission.csv', index=True)\nsubmission.head(50)","6bd2afdd":"plt.figure(figsize=(10,4))\nsns.scatterplot(x='Actual', y='Predicted', data=submission)","b20deb7f":"mean_squared_error(y_test, pred)","64e27de8":"### Submission.csv nin kaydedilmesi","e3de7220":"## Haz\u0131rl\u0131k evresi","bb7ac45c":"#   B\u00fcy\u00fck Veri Analizine Giri\u015f\n\n## Final Projesi 2\n\nBerke \u00dcNL\u00dc\n\n150202090\n\nberkeunlu@gmail.com","ac65ae90":"\"items\" tablosundan name s\u00fctununu \u00e7\u0131kar\u0131lmas\u0131","b95bcb25":"### K\u00fct\u00fcphanelerin import Edilmesi ","88a39df1":"### Tabloda ki u\u00e7 de\u011ferlerin kald\u0131r\u0131lmas\u0131","3f85dc54":"## \u00d6n \u0130\u015flemler","6cac7a41":"## \u00d6\u011frenme modelinin uygulanmas\u0131\nhttps:\/\/scikit-learn.org\/stable\/modules\/generated\/sklearn.model_selection.train_test_split.html","45bca54a":"### Items tablosuyla sales_train tablosunun item_id ile birle\u015ftirilmesi","48b9dcb3":"Trained tablosundaki verilerin medyan\u0131n\u0131n al\u0131nmas\u0131","aaf1ed7f":"Training tablosunun shop_id, date_block_num, item_id ye g\u00f6re gruplanmas\u0131","c9f38bea":"Tablolar\u0131n G\u00f6sterilmesi","1514d37a":"### Tablolar\u0131n Okunmas\u0131","88792006":"### Tabloda ki tarihin, tarih datas\u0131na \u00e7evrilmesi"}}