{"cell_type":{"ca57e436":"code","13aa4adc":"code","09f2f895":"code","7b5f8b64":"code","7f41531f":"code","af1d67ad":"code","cdb781ec":"code","a7c2c96b":"code","3770ea73":"code","12b41d7c":"code","9a2b25e2":"code","6e37f98b":"code","ee1c694a":"code","30abaad6":"code","267a4f7d":"code","0eca06ab":"code","ffa7065b":"code","3a6ef6b4":"code","f5366c06":"code","fd0ac1f3":"code","d957d19b":"code","d1ab929f":"code","9ec6f8cb":"code","b9013228":"markdown","4af3349c":"markdown","b19ae739":"markdown","b1ce26dc":"markdown","c6a30608":"markdown"},"source":{"ca57e436":"!pip install pycaret-ts-alpha","13aa4adc":"import pandas as pd\nimport matplotlib.pyplot as plt\nfrom pycaret.internal.pycaret_experiment import TimeSeriesExperiment\nfrom sktime.utils.plotting import plot_series\nimport random","09f2f895":"data0=pd.read_csv('..\/input\/earthquake-in-japan\/PastHugeEarthquakeinNankai.csv')\ndata0","7b5f8b64":"data0.info()","7f41531f":"data0['mag']=data0['mag'].astype(float)\ndata0['year']=data0['time'].apply(lambda x: int(x.split('\/')[0]))\n# consider max earthquake in each year, so number of data is one in each year","af1d67ad":"# in 1854, huge earthquake occurred twice. One of two occured in the next year to devide it.\ndata1=data0[['year', 'mag', 'coordinate']]\ndata1.loc[10,'year']=1855\ndata1","cdb781ec":"data1['latitude']=data1['coordinate'].apply(lambda x:float(x.split(' ')[0][0:-2]))\ndata1['longitude']=data1['coordinate'].apply(lambda x:float(x.split(' ')[1][0:-2]))","a7c2c96b":"data1=data1[['year', 'mag', 'latitude','longitude']]\ndata1","3770ea73":"data2=pd.DataFrame(columns=['year'])\ndata2['year']=list(range(683,2022))\ndata2=data2.merge(data1,how='left',on='year')\ndata2.info()","12b41d7c":"data2['date2']=data2['year'].apply(lambda x: str(x)+'-01-01')\ndata2.index = pd.PeriodIndex(data2['date2'].tolist(),freq='Y')    ####\ndata2.info()","9a2b25e2":"data2","6e37f98b":"AA=[]\nfor i in range(len(data2)):\n    aa=random.uniform(0,6) ##### \n    aa2=int(aa*10)\/10\n    AA+=[aa2]\n\ndata2['random']=AA\ndata2['mag']=data2['mag'].fillna('N')\ndata2","ee1c694a":"for i in range(len(data2)):\n    if data2.iloc[i,1] =='N':\n        data2.iloc[i,1]=data2.iloc[i,5]\ndata2","30abaad6":"data2['mag']=data2['mag'].astype(float)","267a4f7d":"#TimeSeriesExperiment from pycarat\nexp = TimeSeriesExperiment()\nexp.setup(data=data2['mag'], session_id=42, fh=60)","0eca06ab":"#ARIMA\nmodel = exp.create_model(\"arima\")\nmodel","ffa7065b":"y_train = exp.get_config(\"y_train\")\ny_train","3a6ef6b4":"y_predict = exp.predict_model(model)\nplot_series(data2['mag'], y_train, y_predict, labels=['All', 'Train', 'Test Predictions'])\nplt.grid()","f5366c06":"y_predict","fd0ac1f3":"#SMAPE\ntuned_model = exp.tune_model(model,optimize = 'SMAPE')\ntuned_model","d957d19b":"exp.predict_model(tuned_model)","d1ab929f":"# y_pred_future for Future Prediciton\nfinal_model = exp.finalize_model(tuned_model)\ny_pred_future = exp.predict_model(final_model, verbose=False)\n\n_=plot_series(data2['mag'], y_train, y_predict, y_pred_future, labels=['All','Train','Test Predictions','Future Prediciton'])\nplt.grid()","9ec6f8cb":"y_pred_future","b9013228":"# Introduction\n### Recent historical data is used to predict earthquakes. However, almost predicted earthquakes are of small magnitude because the data do not include historical huge earthquakes. In order to predict future huge earthquakes, it is essential to include the historical records of old past huge earthquakes. This notebook is an attempt for it.","4af3349c":"# Problem\n### In years of no huge earthquake, if assumpting small earthquake ocurred once a year, the prediction result would be dominated by its assumption. If assumpting no additional earthquake ocurred, number of data points is not enough for the model.","b19ae739":"# Earthquake Predict Nankai Pycarat Historical Data","b1ce26dc":"# Historical Huge Earhquake\nhttps:\/\/en.wikipedia.org\/wiki\/Nankai_megathrust_earthquakes","c6a30608":"# Conclusion\n### It is difficult to predict when a huge earthquake that occurs rarely will occur. The above model has predicted that there will be no huge earthquakes in the next 60 years. But, it is doubtful. Another approach is required."}}