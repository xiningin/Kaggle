{"cell_type":{"9811a1cb":"code","4dd18ef4":"code","7edd80e0":"code","1f29ed7f":"code","c4470021":"code","5e61e946":"code","b4b0213e":"code","d8d0dc8a":"code","2f69d1eb":"code","307eee23":"code","6c09e42d":"code","104eb83d":"code","71112db1":"code","8ac13ccc":"code","7722ebad":"code","d77ea701":"code","d08b306c":"code","7c3df32b":"code","22ae8e8e":"code","19ab082b":"code","af0bc120":"code","40555c04":"code","0677bd2f":"code","f68e1e49":"code","aa239372":"code","fac4df8e":"code","419eda04":"code","043f11a4":"code","d7cd16fa":"code","bd9f3d2d":"code","cc95a735":"code","0c2164eb":"code","9fe21343":"code","8ac4561c":"code","c124ddfc":"code","6c76ae5d":"code","5639b7d9":"code","bda762a5":"code","c35208aa":"code","fbe02827":"code","4b01ad86":"code","61e99bad":"code","65913299":"code","41e8bfa2":"code","88e42ca2":"code","cf430696":"code","958ada0e":"code","c6ecdd7f":"code","9ce7d454":"code","dff059ac":"code","79f93146":"code","9fc08b12":"code","3d8b6279":"code","47d96248":"markdown","8780fb6a":"markdown","baa34794":"markdown","29637c35":"markdown","6b020c38":"markdown","f5ce1567":"markdown","3bb8cd08":"markdown","62a0f17c":"markdown","810cb01e":"markdown"},"source":{"9811a1cb":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt \n%matplotlib inline\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import LabelEncoder\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\nimport seaborn as sns\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","4dd18ef4":"df = pd.read_csv('..\/input\/titanic\/train.csv')\ndf_test = pd.read_csv('..\/input\/titanic\/test.csv')\ndf","7edd80e0":"df.head()\n","1f29ed7f":"df.describe()","c4470021":"df.corr()","5e61e946":"plt.subplots(figsize = (15,8))\nsns.heatmap(df.corr(), annot=True,cmap=\"PiYG\")\nplt.title(\"Correlations Among Features\", fontsize = 20);","b4b0213e":"df.isna().sum()","d8d0dc8a":"df = df.drop('Cabin',axis = 1)\ndf_test = df_test.drop('Cabin',axis = 1)","2f69d1eb":"df.columns","307eee23":"df.dtypes","6c09e42d":"plt.figure(figsize=(30,10))\nplt.subplots_adjust(left=0.125, bottom=0.1, right=0.9, top=0.9,\n                      wspace=0.5, hspace=0.2)\nplt.subplot(141)\nplt.title('Embarked!',fontsize = 30)\ndf['Embarked'].value_counts().plot.pie(autopct=\"%1.1f%%\")","104eb83d":"plt.figure(figsize=(30,10))\nplt.subplots_adjust(left=0.125, bottom=0.1, right=0.9, top=0.9,\n                      wspace=0.5, hspace=0.2)\nplt.subplot(141)\nplt.title('Embarked!',fontsize = 30)\ndf['Embarked'].value_counts().plot.pie(autopct=\"%1.1f%%\")","71112db1":"plt.figure(figsize=(30,10))\nplt.subplots_adjust(left=0.125, bottom=0.1, right=0.9, top=0.9,\n                      wspace=0.5, hspace=0.2)\nplt.subplot(141)\nplt.title('Gender!',fontsize = 30)\ndf['Sex'].value_counts().plot.pie(autopct=\"%1.1f%%\")","8ac13ccc":"plt.figure(figsize=(30,10))\nplt.subplots_adjust(left=0.125, bottom=0.1, right=0.9, top=0.9,\n                      wspace=0.5, hspace=0.2)\nplt.subplot(141)\nplt.title('Parch!',fontsize = 30)\ndf['Parch'].value_counts().plot.pie(autopct=\"%1.1f%%\")","7722ebad":"\nplt.figure(figsize=(30,10))\nplt.subplots_adjust(left=0.125, bottom=0.1, right=0.9, top=0.9,\n                      wspace=0.5, hspace=0.2)\nplt.subplot(141)\nplt.title('Pclass!',fontsize = 30)\ndf['Pclass'].value_counts().plot.pie(autopct=\"%1.1f%%\")","d77ea701":"sns.catplot(x = 'Sex', hue = 'Survived',data = df, kind = 'count')","d08b306c":"plt.figure(figsize=(10,6))\nsns.countplot(y=\"Sex\",hue ='Embarked',data=df)","7c3df32b":"plt.figure(figsize=(10,6))\nsns.countplot(y=\"Embarked\",hue ='Survived',data=df)","22ae8e8e":"Female = df[df['Sex'] == 'female']\nMale = df[df['Sex'] == 'male']","19ab082b":"Female['Age'].unique()","af0bc120":"Female['Age'].mean()","40555c04":"sns.distplot(Female.Age.value_counts())","0677bd2f":"Male['Age'].unique()","f68e1e49":"sns.distplot(Male.Age.value_counts())","aa239372":"Male['Age'].mean()","fac4df8e":"df.Age.fillna(df.Age.mean(),inplace=True)\ndf.Embarked.fillna(df.Embarked.mode,inplace=True)","419eda04":"df.isnull().sum()\n","043f11a4":"df.drop(['Name','PassengerId'],axis = 1,inplace=True)\n","d7cd16fa":"df.drop(['Embarked'],axis= 1,inplace = True)\ndf.drop('Ticket',axis = 1,inplace = True)\ndf['Sex']=pd.get_dummies(df[['Sex']],drop_first=True)\n","bd9f3d2d":"df.head()","cc95a735":"df.columns","0c2164eb":"X = df.drop('Survived',axis = 1)\ny = df['Survived']","9fe21343":"X_train, X_test, y_train, y_test = train_test_split(  X, y, test_size=0.20, random_state=42)","8ac4561c":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nX_train= scaler.fit_transform(X_train)\nX_test = scaler.transform(X_test)","c124ddfc":"from sklearn.linear_model import LogisticRegression\nLogR = LogisticRegression()\nLogR.fit(X_train,y_train)","6c76ae5d":"y_pred = LogR.predict(X_test)\nLogR.score(X_train,y_train)","5639b7d9":"LogR.score(X_test,y_test)","bda762a5":"from xgboost import XGBClassifier\nfrom matplotlib import pyplot\nmodel = XGBClassifier()\nmodel.fit(X_train, y_train)\n","c35208aa":"xbg_pred = model.predict(X_test)\nmodel.score(X_train,y_train)","fbe02827":"model.score(X_test,y_test)","4b01ad86":"print(model.feature_importances_)","61e99bad":"features = X.columns\nimportances = model.feature_importances_","65913299":"pyplot.bar(features,importances)\npyplot.show()","41e8bfa2":"df_test.head()","88e42ca2":"df_test.Age.fillna(df_test.Age.mean(),inplace=True)\ndf_test.Embarked.fillna(df_test.Embarked.mode,inplace=True)\ndf_test.Fare.fillna(df_test.Fare.mean(), inplace = True)","cf430696":"df_test.drop(['Embarked'],axis= 1,inplace = True)\ndf_test.drop('Ticket',axis = 1,inplace = True)\ndf_test['Sex']=pd.get_dummies(df[['Sex']],drop_first=True)\n","958ada0e":"df_test.isnull().sum()\n","c6ecdd7f":"df_name = df_test['PassengerId']","9ce7d454":"df_test.drop(['Name','PassengerId'],axis = 1,inplace=True)","dff059ac":"X_df_test= scaler.fit_transform(df_test)","79f93146":"xgb_predictions = model.predict(X_df_test)","9fc08b12":"#Create a  DataFrame\nsubmission = pd.DataFrame({'PassengerId':df_name,'Survived':xgb_predictions})\n                        \n\n#Visualize the first 10 rows\nsubmission.head(10)","3d8b6279":"##% Submit Predictions \nsubmission.to_csv('submission.csv',index=False)","47d96248":"### Splitting of data into train and test","8780fb6a":"## Some Visuals: To get more Insights","baa34794":"## Feature Importance Plotting","29637c35":"### Distibution of male-age plot","6b020c38":"## Predictions on Test_Data","f5ce1567":"### Distibution of female-age plot","3bb8cd08":"## Modelling with XGBClassifier","62a0f17c":"## Modelling with Logistic Regression","810cb01e":"## Filling the missing values"}}