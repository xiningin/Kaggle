{"cell_type":{"7244c390":"code","a50176e3":"code","b17f7fa6":"code","7a0b6bd8":"code","00bd0608":"code","6d2cb5e7":"code","260fb114":"code","5fafa479":"code","8cd6c755":"code","1620a8e5":"code","b826e4f2":"code","fc8aafb8":"code","038ea21f":"code","666a6ab2":"code","dd66ad09":"code","3dafc76c":"code","3dd593fd":"code","c9631002":"code","79dc6a34":"code","4890f7cd":"code","52497031":"code","d2bafa43":"code","e828b4c9":"code","344cccb8":"code","3184a8eb":"code","1110f1a8":"markdown","487e3767":"markdown","53e47634":"markdown","bd2366d1":"markdown","8da38096":"markdown","1988c6e5":"markdown","5e1d21dd":"markdown","662fac68":"markdown"},"source":{"7244c390":"from keras.layers import Input, Dense, Flatten\nfrom keras.models import Model, Sequential\nfrom keras.applications.resnet50 import ResNet50, preprocess_input\nfrom keras.preprocessing import image\nfrom keras.preprocessing.image import ImageDataGenerator\nimport numpy as np\nfrom glob import glob\nimport matplotlib.pyplot as plt","a50176e3":"train_path='..\/input\/chest-xray-pneumonia\/chest_xray\/train'\nval_path='..\/input\/chest-xray-pneumonia\/chest_xray\/val'\ntest_path='..\/input\/chest-xray-pneumonia\/chest_xray\/test'\n\nimage_shape=[224, 224]","b17f7fa6":"resnet=ResNet50(input_shape=image_shape + [3], weights='imagenet', include_top=False) #Without top layers\nresnet","7a0b6bd8":"for layers in resnet.layers:\n    layers.trainable=False","00bd0608":"classes=glob('..\/input\/chest-xray-pneumonia\/chest_xray\/train\/*')\nclasses","6d2cb5e7":"x=Flatten()(resnet.output)\nd=Dense(256, activation='relu')(x)\nprediction=Dense(len(classes), activation='softmax')(d)\nmodel=Model(inputs=resnet.input, outputs=prediction)\nmodel.summary()","260fb114":"model.compile(\n  loss='categorical_crossentropy',\n  optimizer='adam',\n  metrics=['accuracy']\n)","5fafa479":"train_datagen=ImageDataGenerator(rescale=1\/255, shear_range=0.1, zoom_range=0.1, horizontal_flip=True)","8cd6c755":"test_datagen=ImageDataGenerator(rescale=1\/255)\nval_datagen=ImageDataGenerator(rescale=1\/255)","1620a8e5":"training_set=train_datagen.flow_from_directory('..\/input\/chest-xray-pneumonia\/chest_xray\/train', target_size=(224, 224), batch_size=32, class_mode='categorical')","b826e4f2":"test_set=test_datagen.flow_from_directory('..\/input\/chest-xray-pneumonia\/chest_xray\/test', target_size=(224, 224), batch_size=32, class_mode='categorical')","fc8aafb8":"val_set=val_datagen.flow_from_directory('..\/input\/chest-xray-pneumonia\/chest_xray\/val', target_size=(224, 224), batch_size=32, class_mode='categorical')","038ea21f":"fit=model.fit(training_set, validation_data=val_set, epochs=10, steps_per_epoch=len(training_set), validation_steps=len(val_set))","666a6ab2":"plt.plot(fit.history['loss'], label='train loss')\nplt.plot(fit.history['val_loss'], label='val loss')\nplt.legend()\nplt.show()","dd66ad09":"plt.plot(fit.history['accuracy'], label='train accuracy')\nplt.plot(fit.history['val_accuracy'], label='val accuracy')\nplt.legend()\nplt.show()","3dafc76c":"model.evaluate(test_set)","3dd593fd":"from keras.applications.vgg16 import VGG16","c9631002":"vgg=VGG16(input_shape=image_shape + [3], weights='imagenet', include_top=False)\nvgg","79dc6a34":"for layers in vgg.layers:\n    layers.trainable=False","4890f7cd":"x=Flatten()(vgg.output)\nd=Dense(256, activation='relu')(x)\nprediction=Dense(len(classes), activation='softmax')(d)\nmodel=Model(inputs=vgg.input, outputs=prediction)\nmodel.summary()","52497031":"model.compile(\n  loss='categorical_crossentropy',\n  optimizer='adam',\n  metrics=['accuracy']\n)","d2bafa43":"fit=model.fit(training_set, validation_data=val_set, epochs=10, steps_per_epoch=len(training_set), validation_steps=len(val_set))","e828b4c9":"plt.plot(fit.history['loss'], label='train loss')\nplt.plot(fit.history['val_loss'], label='val loss')\nplt.legend()\nplt.show()","344cccb8":"plt.plot(fit.history['accuracy'], label='train accuracy')\nplt.plot(fit.history['val_accuracy'], label='val accuracy')\nplt.legend()\nplt.show()","3184a8eb":"model.evaluate(test_set)","1110f1a8":"##### **Same as ResNet**","487e3767":"#### ***Geting the Datasets Path***","53e47634":"##### **Making the top layers**","bd2366d1":"#### ***VGG16 Model***","8da38096":"### ***Loading the Necessary Libraries***","1988c6e5":"#### ***ResNet model***","5e1d21dd":"##### **Finding the output classes**","662fac68":"##### **No train for the RestNet layers as they are pretrained**"}}