{"cell_type":{"ac7073aa":"code","d8cfa119":"code","1e5f6793":"code","6d22c01c":"code","033de7c3":"code","6a2f8108":"code","9bb95b41":"code","31f20b24":"code","6290bc26":"code","753cb092":"code","f51c5e5d":"code","672d28c5":"code","8f77773d":"code","b9831679":"code","2db34987":"code","62ddc0bc":"code","f8408f13":"code","bb5863c1":"code","28dad83b":"code","b73963f7":"markdown","437b3e3a":"markdown","eadf1d6e":"markdown","591879f6":"markdown","67f41c62":"markdown","0f3c7432":"markdown","a973b257":"markdown","249917b4":"markdown","56d86bbd":"markdown","be7968d7":"markdown","8a96bf2c":"markdown","c648fc19":"markdown","9c419f6e":"markdown","7787cd6e":"markdown","e0d7a079":"markdown","cd3760ae":"markdown","5b8d3de2":"markdown","08b189be":"markdown"},"source":{"ac7073aa":"import numpy as np # linear algebra\nimport pandas as pd \nimport statsmodels.formula.api as smf\nimport statsmodels.api as sm\nfrom sklearn.metrics import roc_curve, auc, confusion_matrix\nimport seaborn as sns\nimport matplotlib.pyplot as plt","d8cfa119":"train = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ntest = pd.read_csv(\"..\/input\/titanic\/test.csv\")","1e5f6793":"train","6d22c01c":"train.Age.fillna(train.Age.mean(), inplace=True)\ntrain.dropna(subset=[\"Embarked\"], inplace = True)\ntrain.drop(train[train.Fare == 0].index, inplace=True)\n\ntrain.describe()\n\n","033de7c3":"sns.regplot(x=\"Age\", y=\"Survived\", data=train, fit_reg=True).set_title(\"Age\")","6a2f8108":"sns.barplot(x=\"Sex\", y=\"Survived\", data=train).set_title(\"Sex\")","9bb95b41":"sns.regplot(x=\"PassengerId\", y=\"Survived\", data=train, fit_reg=True).set_title(\"PassengerId\")","31f20b24":"sns.barplot(x=\"Pclass\", y=\"Survived\", data=train).set_title(\"Pclass\")","6290bc26":"sns.regplot(x=\"Pclass\", y=\"Survived\", data=train, fit_reg=True).set_title(\"Pclass\")","753cb092":"sns.regplot(x=\"SibSp\", y=\"Survived\", data=train, fit_reg=True).set_title(\"SibSp\")","f51c5e5d":"sns.regplot(x=\"Parch\", y=\"Survived\", data=train, fit_reg=True).set_title(\"Parch\")","672d28c5":"sns.barplot(x=\"Embarked\", y=\"Survived\", data=train).set_title(\"Embarked\")","8f77773d":"sns.regplot(x=\"Fare\", y=\"Survived\", data=train, fit_reg=True).set_title(\"Fare\")","b9831679":"logit_reg = smf.glm(\"Survived~Age+Sex+Pclass+Embarked+Fare\", data=train,family=sm.families.Binomial()).fit()\nprint(logit_reg.summary())\npredictions = logit_reg.predict(test)\nprint(predictions)","2db34987":"y = train[\"Survived\"]\npred_probs =logit_reg.fittedvalues\n\nfpr,sens,th = roc_curve(y,pred_probs)\n\nplt.plot(fpr,sens) #plots the ROC curve\nplt.plot([0,1],[0,1],'k') #adds a 1-1 line for reference\nplt.xlabel('FPR') #adds an x label.\nplt.ylabel('Sensitivity') #adds an y label.\n\nprint(\"Area Under Curve:\",auc(fpr,sens))","62ddc0bc":"thresh = np.linspace(0,1,num=100)\n\nmisclass = np.repeat(np.NaN,repeats=thresh.size)\n\nfor i in range(thresh.size): \n    my_classification = pred_probs>thresh[i] \n    misclass[i] = np.mean(my_classification!=y)\n    \nthresh = thresh[np.argmin(misclass)]\nprint(\"The threshold is:\", thresh)","f8408f13":"log_predictions = (predictions > thresh) + 0\n\n#For classification matrix\npredictions_train = logit_reg.predict(train)\nlog_predictions_train = (predictions_train > thresh) + 0","bb5863c1":"confusion_matrix(y,log_predictions_train)","28dad83b":"output = pd.DataFrame({'PassengerId': test.PassengerId, 'Survived': log_predictions})\noutput.to_csv('my_submission.csv', index=False)\nprint(\"Your submission was successfully saved!\")","b73963f7":"However, whe it comes to those with parents or children, we so see a general trend upward of those who survived. This could be as you have more family, you had people looking out for you and ensuring your safety, rather then those without family.","437b3e3a":"From what it looks like, it seems that the following variable might explain survival rating the best:\n* Age\n* Sex\n* Passenger Class\n* Parch - # of Parents\/Children on board\n* Embarking Location\n* Fare\n\nHere we take our variables and fit it to a logistic model, we want to check coefficients and p-values before moving on.","eadf1d6e":"so we find our auc to be 85%, which is pretty decent in determining survival rate.\n\n\nHere we calcualte our missclassification value that will be our cutoff value for our predicited logits.","591879f6":"We now create an array of survivors from our predicited values","67f41c62":"Here I will be attempting my first Kaggle competition. With my first attempt, I tried a random tree that was suggested, but only gave me about 76% accuracy. So now I am trying a logisitc model, which has given me about 78.5% accuracy!","0f3c7432":"There doesnt seem to be much change between those with a spouse and\/or siblings, only about a 10% change, so we will leave this variable out aswell.","a973b257":"From what we can see here, We see a genereal linear trend downward as age increases. Much could be said about this, but most plausible is that there was a priority to save children before the older members of the titanic. This can be seen by the cluster those who survived seems to lean towards the younger ages while the age of those who parished has a wider distribution across age.","249917b4":"- True Negatives: 493\n- False Negatives: 124\n- True Positives: 215\n- False Positives: 42\n\nSo it seems that our model does pretty well predicitng whether someone either survived or parished, but it could be better with some fine tuning in the future!\n","56d86bbd":"From this graph, we could potentially see a hgiher rate of survival from this who embarked from Cherbourg, rather then those who embarked from Queenstown or Southhampton. We will include this for some of runs and see it it does.","be7968d7":"Reading in our data","8a96bf2c":"This I feel goes hand in hand with passanger class, the higher the fare, the more likely they were to survive.","c648fc19":"There was some missing data across our test and train set, so here, I will be replacing those missing slots.","9c419f6e":"Confusion Matrix","7787cd6e":"Here we will plot our variables against survival rate to see what types of variables will explain survival rate the best!","e0d7a079":"Passanger ID doesnt seem to matter at all since they were probably randomly assigned.","cd3760ae":"We see that 1st class passangers survied at much higher rate then their 2nd and 3rd class passangers, so we will inclde this in our model.","5b8d3de2":"It is apparent that Gender was VERY significant in explaining who survived, with females having a survivle rate of almost 80% while about only 20% of men survived.","08b189be":"From above, we also see that our data fits the assumption of linearity. Now for independence, we choose to accept this assumption since the survival of one person is not dependent on the survival of another person. However, we do recognize that survival is more likely if someone has family or is child, whose parent is more likely to save them before themselves, which we will take int considertation in assuming the predictive accuracy of this model."}}