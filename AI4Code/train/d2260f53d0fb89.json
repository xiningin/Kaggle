{"cell_type":{"da4a6e26":"code","7d6997c7":"code","633044fb":"code","13e400a9":"code","8fe7b6d4":"code","46af51b1":"code","64b224f6":"code","662d7b7d":"code","b0a75550":"code","fce73673":"code","70e2e351":"code","ef296edc":"code","6185e9af":"code","420a2237":"code","abac14c1":"code","99a61ff1":"code","e249e141":"code","6eec225e":"code","38ec89a9":"markdown","2d7d5bd9":"markdown","dec01d0f":"markdown","3ec9fdb9":"markdown","6c9f6b5d":"markdown","a2801f29":"markdown","9739f3fb":"markdown"},"source":{"da4a6e26":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt \nimport seaborn as sns\nimport plotly.express as px\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","7d6997c7":"df = pd.read_csv('..\/input\/hotel-prices-beginner-dataset\/hotels.csv')\ndf.head()","633044fb":"sns.histplot(data=df,x=\"Price in Millions\",color=\"#87ceed\",kde=True)","13e400a9":"sns.histplot(data=df,x=\"Square Meter\",color=\"#87ceed\",kde=True)","8fe7b6d4":"sns.countplot(data=df,x=\"City\",color=\"#87ceed\")","46af51b1":"sns.histplot(data=df,x=\"Profit\",color=\"#87ceed\",kde=True)","64b224f6":"df","662d7b7d":"from sklearn.preprocessing import LabelEncoder,StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.cluster import KMeans\nle = LabelEncoder()\nle.fit(df[\"City\"])\ndf[\"City\"] = le.transform(df[\"City\"])\nstd = StandardScaler()\nstd.fit(df[[\"Profit\",\"Price in Millions\",\"Square Meter\"]])\ndf[[\"Profit\",\"Price in Millions\",\"Square Meter\"]] = std.transform(df[[\"Profit\",\"Price in Millions\",\"Square Meter\"]])\ndf","b0a75550":"from sklearn.metrics import silhouette_score\nn = 6\nscore = []\nfor i in range(2,n):\n    km = KMeans(n_clusters=i,init=\"k-means++\",n_init=10,max_iter=300,tol=0.0001,random_state=123,algorithm=\"elkan\").fit(df[\"Profit\"].values.reshape(-1,1))\n    km.predict(df[\"Profit\"].values.reshape(-1,1))\n    score.append(silhouette_score(df[\"Profit\"].values.reshape(-1,1),km.labels_))\nscore","fce73673":"plt.plot(range(2,6),score,'o')\nplt.plot(range(2,6),score,'--')\nplt.xlabel(\"iter nums\")\nplt.ylabel(\"silhouette_score\")\nplt.title(\"Best Kmeans for n\")\nplt.show()","70e2e351":"km = KMeans(n_clusters=2,init=\"k-means++\",n_init=10,max_iter=300,tol=0.0001,random_state=123,algorithm=\"elkan\").fit(df[\"Profit\"].values.reshape(-1,1))\nkm.predict(df[\"Profit\"].values.reshape(-1,1))\nProfit_labels = km.labels_\ndf[\"Profit_labels\"] = Profit_labels\ndf.groupby([\"Profit_labels\"]).agg(mean_profit_labels=(\"Profit\",\"mean\"))","ef296edc":"n = 6\nscores = []\nfor i in range(2,n):\n    km = KMeans(n_clusters=i,init=\"k-means++\",n_init=10,max_iter=300,tol=0.0001,random_state=123,algorithm=\"elkan\").fit(df[\"Price in Millions\"].values.reshape(-1,1))\n    km.predict(df[\"Price in Millions\"].values.reshape(-1,1))\n    scores.append(silhouette_score(df[\"Price in Millions\"].values.reshape(-1,1),km.labels_))\nplt.plot(range(2,6),scores,'o')\nplt.plot(range(2,6),scores,'--')\nplt.xlabel(\"iter nums\")\nplt.ylabel(\"silhouette_score\")\nplt.title(\"Best Kmeans for n\")\nplt.show()","6185e9af":"km = KMeans(n_clusters=5,init=\"k-means++\",n_init=10,max_iter=300,tol=0.0001,random_state=123,algorithm=\"elkan\").fit(df[\"Price in Millions\"].values.reshape(-1,1))\nkm.predict(df[\"Price in Millions\"].values.reshape(-1,1))\npim = km.labels_\ndf[\"pim_labels\"] = pim\ndf.groupby([\"pim_labels\"]).agg(mean_pim_labels=(\"Price in Millions\",\"mean\"))","420a2237":"n = 6\nscoress = []\nfor i in range(2,n):\n    km = KMeans(n_clusters=i,init=\"k-means++\",n_init=10,max_iter=300,tol=0.0001,random_state=123,algorithm=\"elkan\").fit(df[\"Square Meter\"].values.reshape(-1,1))\n    km.predict(df[\"Square Meter\"].values.reshape(-1,1))\n    scoress.append(silhouette_score(df[\"Square Meter\"].values.reshape(-1,1),km.labels_))\nplt.plot(range(2,6),scoress,'o')\nplt.plot(range(2,6),scoress,'--')\nplt.xlabel(\"iter nums\")\nplt.ylabel(\"silhouette_score\")\nplt.title(\"Best Kmeans for n\")\nplt.show()\n","abac14c1":"km = KMeans(n_clusters=5,init=\"k-means++\",n_init=10,max_iter=300,tol=0.0001,random_state=123,algorithm=\"elkan\").fit(df[\"Square Meter\"].values.reshape(-1,1))\nkm.predict(df[\"Square Meter\"].values.reshape(-1,1))\nsm = km.labels_\ndf[\"sm_labels\"] = sm\ndf.groupby([\"sm_labels\"]).agg(mean_sm_labels=(\"Square Meter\",\"mean\"))","99a61ff1":"n = 6\nscoress = []\nfor i in range(2,n):\n    km = KMeans(n_clusters=i,init=\"k-means++\",n_init=10,max_iter=300,tol=0.0001,random_state=123,algorithm=\"elkan\").fit(df[\"City\"].values.reshape(-1,1))\n    km.predict(df[\"City\"].values.reshape(-1,1))\n    scoress.append(silhouette_score(df[\"City\"].values.reshape(-1,1),km.labels_))\nplt.plot(range(2,6),scoress,'o')\nplt.plot(range(2,6),scoress,'--')\nplt.xlabel(\"iter nums\")\nplt.ylabel(\"silhouette_score\")\nplt.title(\"Best Kmeans for n\")\nplt.show()","e249e141":"km = KMeans(n_clusters=3,init=\"k-means++\",n_init=10,max_iter=300,tol=0.0001,random_state=123,algorithm=\"elkan\").fit(df[\"City\"].values.reshape(-1,1))\nkm.predict(df[\"City\"].values.reshape(-1,1))\nsm = km.labels_\ndf[\"ct_labels\"] = sm\ndf.groupby([\"ct_labels\"]).agg(count_city_labels=(\"City\",\"count\"))","6eec225e":"# [\"Profit\",\"Price in Millions\",\"Square Meter\",\"City\"]\nn = 6\nscoress = []\nfor i in range(2,n):\n    km = KMeans(n_clusters=i,init=\"k-means++\",n_init=10,max_iter=300,tol=0.0001,random_state=123,algorithm=\"elkan\").fit(df[[\"Profit\",\"Price in Millions\",\"Square Meter\",\"City\"]].values.reshape(-1,1))\n    km.predict(df[[\"Profit\",\"Price in Millions\",\"Square Meter\",\"City\"]].values.reshape(-1,1))\n    scoress.append(silhouette_score(df[[\"Profit\",\"Price in Millions\",\"Square Meter\",\"City\"]].values.reshape(-1,1),km.labels_))\nplt.plot(range(2,6),scoress,'o')\nplt.plot(range(2,6),scoress,'--')\nplt.xlabel(\"iter nums\")\nplt.ylabel(\"silhouette_score\")\nplt.title(\"Best Kmeans for n\")\nplt.show()","38ec89a9":"# Price in Millions","2d7d5bd9":"- **select 2**","dec01d0f":"- **select 5**","3ec9fdb9":"# Square Meter","6c9f6b5d":"# profit","a2801f29":"<div style=\"color: #FD7013;\n           display:fill;\n           border-radius:10px;\n           border-style: solid;\n           border-color:#424949;\n           text-align:center;\n           background-color:#8ac6d1 ;\n           font-size:20px;\n           letter-spacing:0.5px;\n           padding: 0.7em;\n           text-align:left\">  \n<center> 1. Clustering  <\/center> \n<\/div>","9739f3fb":"# City"}}