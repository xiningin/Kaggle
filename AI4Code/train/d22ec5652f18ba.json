{"cell_type":{"ea02c2b2":"code","42c84924":"code","89f8c74b":"code","3858bc45":"code","949b53e4":"code","9add157b":"code","a96fd351":"code","4b2f7d51":"code","df568f64":"code","72efb82d":"code","eb7b9645":"code","8bd53e0e":"code","2e18016e":"code","a4fe23de":"code","899a92f8":"code","16a6f3d6":"code","cc467b2f":"markdown","5652f021":"markdown","8fb6e78e":"markdown","7944a718":"markdown","d3fc763d":"markdown","8df5f48e":"markdown","85f1347f":"markdown"},"source":{"ea02c2b2":"import pandas as pd\nimport numpy as np\nimport statsmodels.api as sm\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport math\n","42c84924":"df = pd.read_csv('..\/input\/predictingese\/amsPrediction - Sheet1.csv')\ndf.head()","89f8c74b":"df.describe()","3858bc45":"corr=df.corr()\ncorr.style.background_gradient(cmap='coolwarm')","949b53e4":"endog = df['ESE']\nexog = sm.add_constant(df[['MSE','Attendance','HRS']])\nprint(exog)","9add157b":"X=exog.to_numpy()\nY= endog.to_numpy()\ns1_xt =np.transpose(X)\nprint(s1_xt)\n","a96fd351":"s2_mul1= np.matmul(s1_xt,X)\nprint(s2_mul1)","4b2f7d51":"s3_inv=np.linalg.inv(s2_mul1)\nprint(s3_inv)","df568f64":"s4_mul= np.matmul(s3_inv,s1_xt)\nprint(s4_mul)","72efb82d":"s5_res =np.matmul(s4_mul,Y)\nprint(s5_res)","eb7b9645":"mod = sm.OLS(endog, exog)\nresults = mod.fit()\nprint (results.summary())","8bd53e0e":"def RSE(y_true, y_predicted):\n   \n    y_true = np.array(y_true)\n    y_predicted = np.array(y_predicted)\n    RSS = np.sum(np.square(y_true - y_predicted))\n\n    rse = math.sqrt(RSS \/ (len(y_true) - 2))\n    return rse","2e18016e":"yp= results.predict()\nypa = np.array(yp)\nyta = df['ESE']\neterms =yta-ypa\n\n\ndf1 = pd.DataFrame(eterms)\ndf1['ESE'].hist(bins=10)\n\n\n\n\n","a4fe23de":"rse= RSE(df['ESE'],results.predict())\nprint(rse)","899a92f8":"from sklearn import linear_model\nX = df[['MSE','Attendance','HRS']]\ny = df['ESE']\n\nlm = linear_model.LinearRegression()\nmodel = lm.fit(X,y)\nlm.coef_","16a6f3d6":"lm.intercept_","cc467b2f":"> The follwoing code segment imports required modules and loads dataset as Panda's Dataframe.","5652f021":"The follwing code converts the input and output vectors as numpy array in order to implement the  formula in a stepwise manner.\n\n\n\nIt also transpose the input vector.","8fb6e78e":"The correlation analysis shows no strong correlation between the input vectors, namely 'Attendance'(-0.10), 'HRS'(0.25) and output vector 'ESE'.","7944a718":"The following code segment builds the MLR model from Scikit-Learn module.","d3fc763d":"The following code segment build the MLR model using  the OLS method from the statsmodel. ","8df5f48e":"The following code segment separates input and output vectors. Also, it adds a constant unit vector as a coefficient for *beta0* or *intercept*.","85f1347f":"The dataset has four different feature vectors called Attendance, MSE, HRS and ESE. The 'ESE' is an output vector, and the rest of the columns are input vectors representing independent variables."}}