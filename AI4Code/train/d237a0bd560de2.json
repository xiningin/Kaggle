{"cell_type":{"9c0999b8":"code","04236450":"code","3a82b1cf":"code","36e87115":"code","899cd2a6":"code","81f02f3d":"code","e73f8f4e":"code","a78b5dc5":"code","e1f8fff5":"code","753617a1":"code","6237a411":"code","70686012":"code","e34667db":"code","14f1b02a":"code","f8871858":"code","a1a22cf5":"code","1b697900":"code","54ccdf08":"code","5ca373e6":"code","155da1d6":"code","574fac53":"code","01357e23":"code","54460ba4":"code","32dd8046":"code","9226e4b9":"code","b37255c5":"code","84d2c91b":"code","0f9a1ae8":"code","ad68d9bc":"code","b246e671":"code","cf35b295":"code","743eef99":"code","c5f991e6":"code","a778f0b9":"code","9bfc17bc":"code","c5ece131":"markdown"},"source":{"9c0999b8":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","04236450":"import seaborn as sns\nimport matplotlib.pyplot as plt","3a82b1cf":"df = pd.read_csv('\/kaggle\/input\/titanic\/train.csv')","36e87115":"df.isnull().sum()","899cd2a6":"df['Age'] = df['Age'].transform(lambda val: val.fillna(val.mean()))","81f02f3d":"df.isnull().sum()","e73f8f4e":"df['Sex'] = df['Sex'].map({'male': 0, 'female': 1})\ndf = df.fillna(0)","a78b5dc5":"df","e1f8fff5":"plt.figure(figsize=(8,6), dpi=150)\nsns.heatmap(data=df.corr(), cmap='coolwarm', annot=True)","753617a1":"np.abs(df.corr()['Survived']).sort_values().tail(6)","6237a411":"X = df.drop(['Survived', 'Cabin', 'Name', 'Embarked', 'Ticket'], axis=1)\ny = df['Survived']","70686012":"X","e34667db":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1, random_state=42)","14f1b02a":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()","f8871858":"scaled_X_train = scaler.fit_transform(X_train)\nscaled_X_test = scaler.transform(X_test)","a1a22cf5":"from sklearn.neighbors import KNeighborsClassifier\nknn = KNeighborsClassifier()\noperations = [('scaler',scaler),('knn',knn)]\nfrom sklearn.pipeline import Pipeline\npipe = Pipeline(operations)","1b697900":"from sklearn.model_selection import GridSearchCV\nk_values = list(range(1, 30))\nparam_grid = {'knn__n_neighbors': k_values}","54ccdf08":"fullcvclassifier = GridSearchCV(pipe, param_grid, cv=5,scoring='accuracy')","5ca373e6":"fullcvclassifier","155da1d6":"fullcvclassifier.fit(X_train, y_train)","574fac53":"fullcvclassifier.best_estimator_.get_params()","01357e23":"y_pred = fullcvclassifier.predict(X_test)","54460ba4":"from sklearn.metrics import classification_report,confusion_matrix\nconfusion_matrix(y_test,y_pred)","32dd8046":"print(classification_report(y_test, y_pred))","9226e4b9":"test_df = pd.read_csv('\/kaggle\/input\/titanic\/test.csv')","b37255c5":"test_df.isnull().sum()","84d2c91b":"test_df['Age'] = test_df['Age'].transform(lambda val: val.fillna(val.mean()))\ntest_df['Fare'] = test_df['Fare'].transform(lambda val: val.fillna(val.mean()))\ntest_df['Sex'] = test_df['Sex'].map({'male': 0, 'female': 1})\ntest_df = test_df.drop(['Cabin', 'Name', 'Embarked', 'Ticket'], axis=1)","0f9a1ae8":"scaler = StandardScaler()\nknn7 = KNeighborsClassifier(n_neighbors=7)\noperations = [('scaler',scaler),('knn7',knn7)]","ad68d9bc":"pipe = Pipeline(operations)","b246e671":"pipe.fit(X_train,y_train)","cf35b295":"pipe_pred = pipe.predict(test_df)","743eef99":"test_df['Survived'] = pipe_pred","c5f991e6":"pred_results = test_df[['PassengerId', 'Survived']]","a778f0b9":"pred_results = pred_results.set_index('PassengerId')","9bfc17bc":"pred_results.to_csv('\/kaggle\/working\/submission.csv')","c5ece131":"![](http:\/\/)***FINAL MODEL EVALUATION WITH K=7***"}}