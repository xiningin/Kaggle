{"cell_type":{"94ccc8b0":"code","bda02936":"code","71298972":"code","3fbed888":"code","c20c399f":"code","50389330":"code","1bd37a26":"code","d9e4cad5":"code","fd76ff03":"code","6b4e022e":"code","537ef245":"markdown","a368122d":"markdown","e88157d6":"markdown","0d157b91":"markdown"},"source":{"94ccc8b0":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","bda02936":"pip install beautifulsoup4","71298972":"pip install requests","3fbed888":"pip install openpyxl","c20c399f":"# Importing required libraries\nfrom bs4 import BeautifulSoup\nimport requests, openpyxl","50389330":"#Creating excel file\nexcel = openpyxl.Workbook()\nsheet = excel.active","1bd37a26":"#Changing sheet name\nsheet.title = 'IMDb Top 250 Movies'","d9e4cad5":"#Adding a row\nsheet.append(['Rank','Movie Name','Year of release','IMDB Rating'])","fd76ff03":"# Scraping required data\ntry:\n    html = requests.get('https:\/\/www.imdb.com\/chart\/top\/')\n    html.raise_for_status()\n\n    soup = BeautifulSoup(html.text,'html.parser')\n    movies = soup.find('tbody',class_='lister-list').find_all('tr')\n    for movie in movies:\n        name = movie.find('td',class_='titleColumn').a.text\n        rank = movie.find('td',class_='titleColumn').get_text(strip=True).split('.')[0]\n        year = movie.find('td',class_='titleColumn').span.text.strip('()')\n        rating = movie.find('td',class_='ratingColumn imdbRating').strong.text\n        print(rank,name, year, rating)\n        sheet.append([rank,name, year, rating])\nexcept Exception as e:\n    print(e)","6b4e022e":"#Saving the excel file\nexcel.save('IMDb Top 250 Movies.xlsx')","537ef245":"## Web Scraper","a368122d":"## Imports","e88157d6":"## Preparing Excel Sheet","0d157b91":"## Installing required libraries"}}