{"cell_type":{"66b3f88c":"code","eee13d45":"code","ac445639":"code","3f63c025":"code","c1f1880f":"code","bda00f77":"code","cb3ec84c":"code","3fa901dc":"code","23cea13e":"code","78089f55":"code","7186f271":"code","aef36890":"code","be8c83b6":"code","27593190":"code","b7944a16":"code","b5eb740d":"code","4e808e42":"code","ca24b304":"code","4b611158":"code","0c2f34aa":"code","c442789a":"code","c45b1ac2":"code","2ffa4fbd":"code","84f769de":"code","152f6985":"code","7d7cd00b":"code","bb34e335":"code","88bbe56c":"code","79851afa":"code","9b374cc7":"code","1a4b73ec":"code","e40400b1":"code","342f4dcb":"code","5e0dcdb2":"code","ed05d7f0":"code","3df5d15a":"code","8a863cce":"code","995e2384":"code","056c9f5c":"code","8f51863a":"code","2660175d":"code","048ca39a":"code","d36d14e1":"code","d96d6e10":"code","747b12f0":"code","c0f59ec3":"code","4f346031":"code","11767101":"code","00c5dfe3":"code","c79bf080":"code","3d015636":"code","b8f57813":"code","d7bc21bd":"code","88db0907":"markdown","79cfc29f":"markdown","82c3f947":"markdown","f167f58e":"markdown","d19ef2f7":"markdown","3983d776":"markdown","8f96160e":"markdown","bf29ae71":"markdown","5d04cb69":"markdown","fdfa741e":"markdown","69b7aaa0":"markdown","3a7b36a9":"markdown","f7729787":"markdown","c873a736":"markdown","093f14ae":"markdown","a49427c4":"markdown","f0f5fa50":"markdown","aa5066e5":"markdown","0d7f5dc4":"markdown","36d89c67":"markdown","06bb34c9":"markdown","df3f9fa7":"markdown","10eed663":"markdown","2d3dea88":"markdown","c1468035":"markdown"},"source":{"66b3f88c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","eee13d45":"import matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","ac445639":"file1 = pd.read_csv ('..\/input\/geospiza-scandens-beak-evolution\/finch_beaks_1975.csv')","3f63c025":"file2 = pd.read_csv ('..\/input\/geospiza-scandens-beak-evolution\/finch_beaks_2012.csv')","c1f1880f":"file1.head ()","bda00f77":"file2.head ()","cb3ec84c":"file1.columns = ['band', 'species', 'blength', 'bdepth']","3fa901dc":"file1 ['year'] = 1975","23cea13e":"file2 ['year'] = 2012","78089f55":"df = pd.concat ([file1, file2])","7186f271":"df.head ()","aef36890":"df.shape","be8c83b6":"df.info ()","27593190":"df.isnull ().sum ()","b7944a16":"print (round (df.groupby ('species')[['blength', 'bdepth']].describe ().transpose (),2))","b5eb740d":"df.species.value_counts ()","4e808e42":"df_fortis = df[df.species == 'fortis']","ca24b304":"\nfig, ax = plt.subplots (1, 2, figsize=(22, 7), sharex=True)\n\nsns.set_style ('ticks')\n\nplt.subplot (1,2,1)\nsns.swarmplot (x = 'species', y = 'blength', data = df_fortis , hue = 'year', dodge = True,)\nplt.title ('Beak length comparison for fortis', fontsize = 20)\n\nplt.subplot (1,2,2)\nsns.swarmplot (x = 'species', y = 'bdepth', data = df_fortis, hue = 'year', dodge = True)\nplt.title ('Beak depth comparison for fortis', fontsize = 20)","4b611158":"df_scandens = df[df.species == 'scandens']","0c2f34aa":"fig, ax = plt.subplots (1, 2, figsize=(22, 7), sharex=True)\n\nsns.set_style ('ticks')\n\nplt.subplot (1,2,1)\nsns.swarmplot (x = 'species', y = 'blength', data = df_scandens , hue = 'year', dodge = True,)\nplt.title ('Beak length comparison for scandens', fontsize = 20)\n\nplt.subplot (1,2,2)\nsns.swarmplot (x = 'species', y = 'bdepth', data = df_scandens, hue = 'year', dodge = True)\nplt.title ('Beak depth comparison for scandens', fontsize = 20)","c442789a":"def ecdf (data):\n    x = np.sort (data)\n    n = len (data)\n    y = np.arange (1, n+1)\/n \n    return x,y","c45b1ac2":"df_fortis = df_fortis.set_index ('year')","2ffa4fbd":"df_scandens = df_scandens.set_index ('year')","84f769de":"x10,y10 = ecdf (df_fortis.loc ['1975','blength'])\nx20,y20 = ecdf (df_fortis.loc ['2012','blength'])\n\nx11,y11 = ecdf (df_fortis.loc ['1975','bdepth'])\nx21,y21 = ecdf (df_fortis.loc ['2012','bdepth'])\n\n\nx30,y30 = ecdf (df_scandens.loc ['1975','blength'])\nx40,y40 = ecdf (df_scandens.loc ['2012','blength'])\n\nx31,y31 = ecdf (df_scandens.loc ['1975','bdepth'])\nx41,y41 = ecdf (df_scandens.loc ['2012','bdepth'])","152f6985":"fig, ax = plt.subplots (3,3, figsize = (15,7))\n\nax [0,0].hist (df_fortis.loc ['1975','blength'])\nax [0,1].hist (df_fortis.loc ['2012','blength'])\nax [0,2].hist (df_fortis.loc ['1975','bdepth'])\nax [1,0].hist (df_fortis.loc ['2012','bdepth'])\nax [1,1].hist (df_scandens.loc ['1975','blength'])\nax [1,2].hist (df_scandens.loc ['2012','blength'])\nax [2,0].hist (df_scandens.loc ['1975','bdepth'])\nax [2,1].hist (df_scandens.loc ['2012','bdepth'])\n\nplt.tight_layout ()","7d7cd00b":"fig, ax = plt.subplots (1, 2, figsize=(22, 7), sharex=True)\nsns.set_style ('ticks')\nplt.subplot (1,2,1)\nsns.lineplot (x10,y10, data = df_fortis.loc ['1975','blength'])\nsns.lineplot (x21,y21, data = df_fortis.loc ['2012','blength'])\nplt.title ('Fortis beak length comparison', fontsize = 20)\n\nplt.subplot (1,2,2)\nsns.lineplot (x11,y11, data = df_fortis.loc ['1975','bdepth'])\nsns.lineplot (x21,y21, data = df_fortis.loc ['2012','bdepth'])\nplt.title ('Fortis beak depth comparison', fontsize = 20)","bb34e335":"fig, ax = plt.subplots (1, 2, figsize=(22, 7), sharex=True)\nsns.set_style ('ticks')\nplt.subplot (1,2,1)\nsns.lineplot (x30,y30, data = df_scandens.loc ['1975','blength'])\nsns.lineplot (x40,y40, data = df_scandens.loc ['2012','blength'])\nplt.title ('Scandens beak length comparison', fontsize = 20)\n\nplt.subplot (1,2,2)\nsns.lineplot (x31,y31, data = df_scandens.loc ['1975','bdepth'])\nsns.lineplot (x41,y41, data = df_scandens.loc ['2012','bdepth'])\nplt.title ('Scandens beak depth comparison', fontsize = 20)","88bbe56c":"# function for generating replicates of means for a given data.\ndef BS_replicates_mean (data, n_replicates):\n    replicates = np.empty (n_replicates, dtype = object)\n    for i in range (n_replicates):\n        replicates [i] = np.mean (np.random.choice (data, len (data)))\n    return replicates","79851afa":"#Mean difference basis observed data\nmean_diff_fortis_l = np.mean (df_fortis.loc ['2012','blength']) - np.mean (df_fortis.loc ['1975','blength']) \nmean_diff_fortis_d = np.mean (df_fortis.loc ['2012','bdepth']) - np.mean (df_fortis.loc ['1975','bdepth'])\nmean_diff_scandens_l = np.mean (df_scandens.loc ['2012','blength']) - np.mean (df_scandens.loc ['1975','blength']) \nmean_diff_scandens_d = np.mean (df_scandens.loc ['2012','bdepth']) - np.mean (df_scandens.loc ['1975','bdepth'])","9b374cc7":"#Mean difference replicates\nmean_diff_fortis_l_replicates = BS_replicates_mean (df_fortis.loc ['2012','blength'],1000)-BS_replicates_mean (df_fortis.loc ['1975','blength'],1000)\nmean_diff_fortis_d_replicates = BS_replicates_mean (df_fortis.loc ['2012','bdepth'],1000)-BS_replicates_mean (df_fortis.loc ['1975','bdepth'],1000)\n\nmean_diff_scandens_l_replicates = BS_replicates_mean (df_scandens.loc ['2012','blength'],1000)-BS_replicates_mean (df_scandens.loc ['1975','blength'],1000)\nmean_diff_scandens_d_replicates = BS_replicates_mean (df_scandens.loc ['2012','bdepth'],1000)-BS_replicates_mean (df_scandens.loc ['1975','bdepth'],1000)","1a4b73ec":"#Confidence Intervals\nprint ('The confidence interval {} for fortis length mean difference {}'.format ( np.percentile (mean_diff_fortis_l_replicates, [2.5,97.5]), mean_diff_fortis_l))\nprint ('The confidence interval {} for fortis depth mean difference {}'.format ( np.percentile (mean_diff_fortis_d_replicates, [2.5,97.5]), mean_diff_fortis_d))\nprint ('The confidence interval {} for scandens length mean difference {}'.format ( np.percentile (mean_diff_scandens_l_replicates, [2.5,97.5]), mean_diff_scandens_l))\nprint ('The confidence interval {} for scandens depth mean difference {}'.format ( np.percentile (mean_diff_scandens_d_replicates, [2.5,97.5]), mean_diff_scandens_d))","e40400b1":"#Let's first check this metric for the observed data.\nmean_beak_ratio_fortis_1975 = np.mean (df_fortis.loc ['1975','blength']\/df_fortis.loc ['1975','bdepth'])\nmean_beak_ratio_fortis_2012 = np.mean (df_fortis.loc ['2012','blength']\/df_fortis.loc ['2012','bdepth'])\n\nmean_beak_ratio_scandens_1975 = np.mean (df_scandens.loc ['1975','blength']\/df_scandens.loc ['1975','bdepth'])\nmean_beak_ratio_scandens_2012 = np.mean (df_scandens.loc ['2012','blength']\/df_scandens.loc ['2012','bdepth'])\n","342f4dcb":"print ('mean_beak_ratio_fortis_1975 : {}'.format (round (mean_beak_ratio_fortis_1975,2)))\nprint ('mean_beak_ratio_fortis_2012 : {}'.format (round (mean_beak_ratio_fortis_2012,2)))\nprint ('\\n\\n')\nprint ('mean_beak_ratio_scandens_1975 : {}'.format (round (mean_beak_ratio_scandens_1975,2)))\nprint ('mean_beak_ratio_scandens_2012 : {}'.format (round (mean_beak_ratio_scandens_2012,2)))","5e0dcdb2":"fig, axes = plt.subplots (2,2, figsize = (10, 10))\n\naxes [0,0].scatter (x = df_fortis.loc ['1975','blength'], y = df_fortis.loc ['1975','bdepth'])\naxes [0,0].set_title ('fortis 1975')\n\naxes [0,1].scatter (x = df_fortis.loc ['2012','blength'], y = df_fortis.loc ['2012','bdepth'] )\naxes [0,1].set_title ('fortis 2012')\naxes [1,0].scatter (x = df_scandens.loc ['1975','blength'], y = df_scandens.loc ['1975','bdepth'] )\naxes [1,0].set_title ('scandens 1975')\naxes [1,1].scatter (x = df_scandens.loc ['2012','blength'], y = df_scandens.loc ['2012','bdepth'] )\naxes [1,1].set_title ('scandens 2012')\ndict = pd.DataFrame ({'fortis 1975':round (np.corrcoef (df_fortis.loc ['1975','blength'],df_fortis.loc ['1975','bdepth'])[0,1],2),'fortis 2012': round (np.corrcoef (df_fortis.loc ['2012','blength'],df_fortis.loc ['2012','bdepth'])[0,1],2), 'scandens 1975': round (np.corrcoef (df_scandens.loc ['1975','blength'],df_scandens.loc ['1975','bdepth'])[0,1],2), 'scandens 2012': round (np.corrcoef (df_scandens.loc ['2012','blength'],df_scandens.loc ['2012','bdepth'])[0,1],2)}, index = [' '])\nprint (dict)","ed05d7f0":"beak_ratio_fortis_1975 = df_fortis.loc ['1975','blength']\/df_fortis.loc ['1975','bdepth']\nbeak_ratio_fortis_2012 = df_fortis.loc ['2012','blength']\/df_fortis.loc ['2012','bdepth']\n\nbeak_ratio_scandens_1975 = df_scandens.loc ['1975','blength']\/df_scandens.loc ['1975','bdepth']\nbeak_ratio_scandens_2012 = df_scandens.loc ['2012','blength']\/df_scandens.loc ['2012','bdepth']\n","3df5d15a":"beak_ratio_fortis_combinedMean = np.mean (np.concatenate ((beak_ratio_fortis_1975.values,beak_ratio_fortis_2012.values)))\n\nbeak_ratio_scandens_combinedMean = np.mean (np.concatenate ((beak_ratio_scandens_1975.values,beak_ratio_scandens_2012.values)))","8a863cce":"beak_ratio_fortis_1975_shifted = beak_ratio_fortis_1975 - np.mean (beak_ratio_fortis_1975 ) + beak_ratio_fortis_combinedMean\nbeak_ratio_fortis_2012_shifted = beak_ratio_fortis_2012 - np.mean (beak_ratio_fortis_2012) + beak_ratio_fortis_combinedMean\n\nbeak_ratio_scandens_1975_shifted = beak_ratio_scandens_1975 - np.mean (beak_ratio_scandens_1975) + beak_ratio_scandens_combinedMean\nbeak_ratio_scandens_2012_shifted = beak_ratio_scandens_2012 - np.mean (beak_ratio_scandens_2012) + beak_ratio_scandens_combinedMean","995e2384":"np.mean (beak_ratio_scandens_2012_shifted)","056c9f5c":"beak_ratio_fortis_1975_replicates = BS_replicates_mean (beak_ratio_fortis_1975_shifted, 10000)\nbeak_ratio_fortis_2012_replicates = BS_replicates_mean (beak_ratio_fortis_2012_shifted, 10000)\n\nbeak_ratio_scandens_1975_replicates = BS_replicates_mean (beak_ratio_scandens_1975_shifted, 10000)\nbeak_ratio_scandens_2012_replicates = BS_replicates_mean (beak_ratio_scandens_2012_shifted, 10000)","8f51863a":"\nprint ('P-value fortis :',np.sum ((beak_ratio_fortis_2012_replicates - beak_ratio_fortis_1975_replicates) >= abs((np.mean (beak_ratio_fortis_2012)- np.mean(beak_ratio_fortis_1975))))\/10000)","2660175d":"print ('P-value scandens :',np.sum ((beak_ratio_scandens_2012_replicates - beak_ratio_scandens_1975_replicates) >= abs((np.mean (beak_ratio_scandens_2012)- np.mean(beak_ratio_scandens_1975))))\/10000)","048ca39a":"from sklearn.cluster import KMeans\nfrom sklearn.model_selection import train_test_split","d36d14e1":"y = df.species","d96d6e10":"X = df.drop (['species','band','year'], axis = 1)","747b12f0":"X.shape","c0f59ec3":"X_train, X_test, y_train, y_test = train_test_split (X, y, test_size = 0.3)","4f346031":"K_Means = KMeans (n_clusters=2,\n    init='k-means++', n_init = 12)","11767101":"K_Means.fit (X_train)","00c5dfe3":"k_pred = K_Means.predict (X_test)","c79bf080":"k_means_labels = K_Means.labels_ ","3d015636":"k_means_cluster_centers = K_Means.cluster_centers_","b8f57813":"pd.crosstab (k_pred, y_test)","d7bc21bd":"# Initialize the plot with the specified dimensions.\nfig = plt.figure(figsize=(15, 8))\n\n# Colors uses a color map, which will produce an array of colors based on\n# the number of labels there are. We use set(k_means_labels) to get the\n# unique labels.\ncolors = plt.cm.Spectral(np.linspace(0, 1, len(set(k_means_labels))))\n\n# Create a plot\nax = fig.add_subplot(1, 1, 1)\n\n# For loop that plots the data points and centroids.\n# k will range from 0-3, which will match the possible clusters that each\n# data point is in.\nfor k, col in zip(range(2), colors):\n\n    # Create a list of all data points, where the data poitns that are \n    # in the cluster (ex. cluster 0) are labeled as true, else they are\n    # labeled as false.\n    my_members = (k_means_labels == k)\n    \n    # Define the centroid, or cluster center.\n    cluster_center = k_means_cluster_centers[k]\n    \n    # Plots the datapoints with color col.\n    ax.plot(X_train[my_members]['blength'], X_train[my_members]['bdepth'], 'w', markerfacecolor=col, marker='o')\n    \n    # Plots the centroids with specified color, but with a darker outline\n    ax.plot(cluster_center[0], cluster_center[1], 'o', markerfacecolor=col,  markeredgecolor='k', markersize=12)\n\n# Title of the plot\nax.set_title('KMeans', fontsize = 30)\n\n# Remove x-axis ticks\nax.set_xticks(())\nax.set_xlabel ('length', fontsize = 15)\n# Remove y-axis ticks\nax.set_yticks(())\nax.set_ylabel ('depth', fontsize = 15)\nplt.legend ()\n# Show the plot\nplt.show()\n","88db0907":"Visual comparison is not giving a very clear picture at this stage and we need to progress with a statistical analysis.The first impression is that beak length has decreased over the years and beak depth has increased for fortis.","79cfc29f":"The observed data is showing some changes to the beak structure. Let's test this statistically further through hypothesis testing.","82c3f947":"### 2 Neat clusters are appearing for the 2 species","f167f58e":"For both scpecies, the correlation between the beak dimension is showing a decrease.Let's analyse further.","d19ef2f7":"The P-value for both species is < 0.05, which means that there is a significant change in the beak structure (length\/depth) of both the species between the years 1975 and 2012.\nEven the scatter plots between length and depth for the 2 species showed a change.\n\n# This shows that an evolution is in progress across the 2 species in consideration.","3983d776":"Exploring the shapes of the distributions of beak dimensions for the 2 species between the years 1975 and 2012","8f96160e":"# Cluster visualization","bf29ae71":"The respective ecdfs show that over time beak lengths and depths have shown some difference for both the species.However to confirm the visual findings a statistical analysis is required.","5d04cb69":"The observed mean difference for all cases lies within the confidence intervals showing that the observed data is significant. In all cases the dimensions of the beaks of both the species has shown a change.","fdfa741e":"# ECDF - Graphical analysis","69b7aaa0":"# Overall analysis shows:\n* There is an evolution in progress\n* The 2 species are distinct in their characteristics.","3a7b36a9":"# Input data","f7729787":"Now we will test the hypothesis whether there has been a change in the shape of the beaks of the 2 species.\nNull hypothesis : There has been no change in the beaks.\nAlternate hypothesis : There has been a change in the beaks.","c873a736":"### The model has done well with accuracy over 95%","093f14ae":"# Clustering the Species","a49427c4":"# Data visualization","f0f5fa50":"Visual comparison is not giving a very clear picture at this stage and we need to progress with a statistical analysis.The first impression is that beak length has increased over the years and beak depth has decreased for fortis.","aa5066e5":"# Beak Ratio (length\/ depth) ","0d7f5dc4":"Plotting the ECDFs","36d89c67":"# Statistical analysis - P-value","06bb34c9":"Descriptive statistics show there is a difference in the 2 species.","df3f9fa7":"# Data preprocessing","10eed663":"Before hypothesis testing, let's check correlation between beak dimensions for both species at the 2 given timelines.","2d3dea88":"Although, we have seen a change in the mean of the beak dimensions, length and depth, however the real metric of interest is the beak ratio (length\/depth) which shows whether the beak shape has changed.","c1468035":"# Statistical analysis - Confidence intervals\nTo explore the dimensional changes"}}