{"cell_type":{"cecb0b46":"code","d8158d43":"code","4b12b326":"code","47beee71":"code","262f18f7":"code","8fe57da8":"code","ae1f1b55":"markdown"},"source":{"cecb0b46":"import pandas as pd\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","d8158d43":"# Take some submissions files (different one). I took 6 but could be more less ... just like in ML ... experiment ...\n\nsub1 = '..\/input\/tps12-pseudolabels\/source_submissions\/01.csv'\nsub2 = '..\/input\/tps12-pseudolabels\/source_submissions\/02.csv'\nsub3 = '..\/input\/tps12-pseudolabels\/source_submissions\/03.csv'\nsub4 = '..\/input\/tps12-pseudolabels\/source_submissions\/04.csv'\nsub5 = '..\/input\/tps12-pseudolabels\/source_submissions\/04.csv'\nsub6 = '..\/input\/tps12-pseudolabels\/source_submissions\/06.csv'\n\nresult = pd.concat([pd.read_csv(sub1, index_col = \"Id\"),\n                    pd.read_csv(sub2, index_col = \"Id\"),\n                    pd.read_csv(sub3, index_col = \"Id\"),\n                    pd.read_csv(sub4, index_col = \"Id\"),\n                    pd.read_csv(sub5, index_col = \"Id\"),\n                    pd.read_csv(sub6, index_col = \"Id\")], axis=1)\n\ntest = pd.read_csv('..\/input\/tabular-playground-series-dec-2021\/test.csv', index_col = \"Id\")","4b12b326":"def pseudo(row):\n    values = row.values\n    if (values == values[0]).all():\n        return [True, values[0]]\n    else:\n        return [False, None]\n\nresult[['Pseudo', 'Result']] = result.apply(lambda row: pd.Series(pseudo(row)), axis=1)","47beee71":"result[result.Pseudo == True]","262f18f7":"# I take only this rows that every submissions tell the same prediction\npseudo_indexes = result[result.Pseudo].index\n\npseudo = test[test.index.isin(pseudo_indexes)]\n\npseudo_classes = result[result.index.isin(pseudo_indexes)]['Result'].astype(int)\n\npseudo['Cover_Type'] = pseudo_classes\npseudo.to_csv(\"tps12-pseudolabels.csv\")\n\npseudo.tail(5)","8fe57da8":"pseudo['Cover_Type'].value_counts()","ae1f1b55":"## Pseudolabels for classification tutorial\n\nAs simple as possible - just to show how to boost score a little bit using pseudolabels. \n\n<div class=\"alert alert-warning\" role=\"alert\"><ul><li>This is DEOMO only! What does it mean? You can play with your own source submission files. However I use the same technique for my best score.<\/li><li>I really appreciate if you <u><strong>vote on both of these notebooks<\/strong><\/u> - thank you! I just share my work to make competition fun and more interesting.: <ul><li>Pseudolabels for classification tutorial - this notebook<\/li><li>TPS-12 NN (TPU) + Pseudolabeling [0.95690] <a href=\"https:\/\/www.kaggle.com\/remekkinas\/tps-12-nn-tpu-pseudolabeling-0-95690\"\/><\/li><\/ul><\/li><\/ul> <\/div>"}}