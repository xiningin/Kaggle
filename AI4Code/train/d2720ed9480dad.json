{"cell_type":{"1804f238":"code","b18ae44d":"code","9ba2fd9d":"code","ff3ce758":"code","54f6f7ab":"code","4a73fada":"code","d7ba09c0":"code","a5750d8d":"code","27ee652e":"code","48eb8db6":"code","65ab1adc":"code","5bd9997a":"code","c496a3ea":"code","8c703176":"code","3d017708":"code","64fb5a08":"code","0d02186f":"code","450a91cb":"code","ecd92dfa":"code","6ce2e84a":"code","67c58e41":"markdown","0850a0ec":"markdown","6de44629":"markdown","00c6e9a4":"markdown","a231f4c7":"markdown","c1b6c2e6":"markdown","4c5bfb60":"markdown","a7c0d340":"markdown","fcd4797f":"markdown","74ec7497":"markdown","460436b0":"markdown","42bd6248":"markdown","5b9bc7ff":"markdown","36e9eb79":"markdown"},"source":{"1804f238":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","b18ae44d":"df = pd.read_csv(\"..\/input\/connectionist-bench-sonar-mines-vs-rocks\/sonar.all-data.csv\")","9ba2fd9d":"df.info()","ff3ce758":"df.head(10)","54f6f7ab":"sns.countplot(data=df, x='Label')","4a73fada":"fig = plt.figure(figsize=(10,10), dpi=100)\n\nsns.heatmap(df.corr(),cmap=\"BuPu\")","d7ba09c0":"df['NumbLabel'] = df['Label'].map({'R':0, 'M':1})","a5750d8d":"df.corr()['NumbLabel'].sort_values(ascending=False)","27ee652e":"from sklearn.model_selection import train_test_split\nX = df.drop(['Label', 'NumbLabel'], axis = 1)\ny = df['Label']\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.1, random_state=101)","48eb8db6":"from sklearn.preprocessing import StandardScaler\nfrom sklearn.neighbors import KNeighborsClassifier\nscaler = StandardScaler()\nknn = KNeighborsClassifier()\n\noperations = [('scaler', scaler),('knn', knn)]","65ab1adc":"from sklearn.pipeline import Pipeline\npipe = Pipeline(operations)","5bd9997a":"from sklearn.model_selection import GridSearchCV\nk_values = list(range(1,30))\nparam_grid = {'knn__n_neighbors': k_values}","c496a3ea":"cv_classifier = GridSearchCV(pipe, param_grid, cv = 5, scoring='accuracy')","8c703176":"cv_classifier.fit(X_train,y_train)","3d017708":"cv_classifier.best_estimator_.get_params()","64fb5a08":"pd.DataFrame(cv_classifier.cv_results_)","0d02186f":"fig = plt.figure(figsize=(9,6), dpi=100)\nplt.plot(pd.DataFrame(cv_classifier.cv_results_)['mean_test_score'])","450a91cb":"y_pred = cv_classifier.predict(X_test)","ecd92dfa":"from sklearn.metrics import classification_report, confusion_matrix\nconfusion_matrix(y_test, y_pred)","6ce2e84a":"print(classification_report(y_test,y_pred))","67c58e41":"Now I'm looking for frequencies that are more corrolated with out label so first thing to do is to change my label to 0,1 and I am going to do this using map() in python.","0850a0ec":"The grid-search has been performed now let's see what's our best parameters:","6de44629":"we have 60 frequencies as our features and our label is either R or M wich means we detect Rock or Mine.","00c6e9a4":"Since Sklearn has no problem with categorical labels, we are going to use out Label feature in its own way although we already convert it to 0 and 1 in NumbLabel.","a231f4c7":"In KNN modeling, feature scaling is neccary because we are caculating distance and all our feature should have the same unit in order to help us comparing them better.\nThus, I am going to make a pipeline incluing scaling and out knn model.","c1b6c2e6":"# Train|Test Split","4c5bfb60":"# Model Evaluation","a7c0d340":"Since we're going to use cross validation, these X_test and y_test are more kinda a hold out. Therefor I fill out the test_size with 10 percent.","fcd4797f":"we can see the corrolations in numbers:","74ec7497":"This prove why we should use only 1 neighbor because as we can see as our k value increase our accuracy decrease and k=1 has the best accuracy","460436b0":"We can see the results for diffrent n_neighbors in above data frame","42bd6248":"In the next step we are going to make a grid seearch and testing out diffrect values for k to find out wich k is best for out model.","5b9bc7ff":"**Our main goal is to create a machine learning model capable of detecting the difference between a rock or a mine based on the response of the 60 separate sonar frequencies.**","36e9eb79":"That purplish color alongside the diognal of our heat map shows that frequencies that are close to each other are somehow more corrolated."}}