{"cell_type":{"a4c1e287":"code","16df5e77":"code","70a7176c":"code","e1ad641a":"code","219a7e9a":"code","e8626925":"code","a67ae4b9":"code","e5fb23d4":"code","b354d593":"code","36322626":"code","0a0e4f10":"code","702b3cc9":"code","2b1828ce":"code","ea6459a9":"code","10e98f2b":"code","78ae85bb":"code","ffdc42a0":"code","8bb8c3b3":"code","7d922a34":"code","eccf6f41":"code","c2524d6f":"code","0ef590db":"code","25845a0b":"code","e309d536":"code","de46bad6":"code","1180e90f":"code","485da488":"code","fbae445d":"code","28905eed":"code","48e6eb8c":"code","13325e26":"code","200c8a95":"code","e92de4f9":"code","63faaeec":"code","4c4c6936":"markdown","04408d81":"markdown","4d60d638":"markdown","462782e3":"markdown","d83ab98d":"markdown","dc8047d8":"markdown","81924b3c":"markdown","1c283a85":"markdown","7a8cd7d3":"markdown","7cad5f55":"markdown","01b3dd78":"markdown","d41ba202":"markdown","fc2baedb":"markdown","80ffa8c5":"markdown","07cacd12":"markdown","93a6b272":"markdown","bd009549":"markdown","c7418a0f":"markdown","abf3b3d0":"markdown","06881e35":"markdown","d6a51e4d":"markdown","388c2df7":"markdown","834c5585":"markdown","81deec80":"markdown"},"source":{"a4c1e287":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport missingno as msno\nfrom plotly.offline import iplot, init_notebook_mode\ninit_notebook_mode()\nimport plotly.graph_objs as go\nimport plotly.express as px\nimport seaborn as sns\n","16df5e77":"train = pd.read_csv('..\/input\/siim-isic-melanoma-classification\/train.csv')\ntest = pd.read_csv('..\/input\/siim-isic-melanoma-classification\/test.csv')\nsample_sub = pd.read_csv('..\/input\/siim-isic-melanoma-classification\/sample_submission.csv')","70a7176c":"train.head()","e1ad641a":"test.head()","219a7e9a":"sample_sub.head()","e8626925":"print('Train has {:,} rows and Test has {:,} rows.'.format(len(train), len(test)))","a67ae4b9":"cols = ['image', 'ID', 'sex', 'age', 'anatomy_site', 'diagnosis', 'benign_malignant', 'target']\ntrain.columns = cols\ntest.columns = cols[:5]","e5fb23d4":"print(train.columns)\nprint(test.columns)","b354d593":"print(train.isnull().sum())\nprint(test.isnull().sum())","36322626":"# msno.bar(train)\n\nplt.style.use('seaborn-colorblind')\nf, (ax1, ax2) = plt.subplots(1, 2, figsize = (16, 6))\n\nmsno.bar(train, ax = ax1, color=(193\/255, 53\/255, 192\/255), fontsize=10)\nmsno.bar(test, ax = ax2, color=(251\/255, 0\/255, 0\/255), fontsize=10)\n\nax1.set_title('Train Missing Values Map', fontsize = 16)\nax2.set_title('Test Missing Values Map', fontsize = 16);","0a0e4f10":"print(plt.style.available)","702b3cc9":"plt.style.use('seaborn-colorblind')\nf, (ax1, ax2) = plt.subplots(1, 2, figsize = (15, 5))\n\nmsno.matrix(train, ax = ax1, color=(0\/255, 248\/255, 0\/255), fontsize=10 ,sparkline=False)\nmsno.matrix(test, ax = ax2, color=(0\/255, 0\/255, 220\/255), fontsize=10 ,sparkline=False)\n\nax1.set_title('Missing Values in Training Data', fontsize = 16)\nax2.set_title('Missing Value in Testing Data', fontsize = 16);","2b1828ce":"# msno.dendrogram(train)\n# plt.style.use('seaborn-notebook')\nf, (ax1, ax2) = plt.subplots(1, 2, figsize = (18, 5))\n\nmsno.dendrogram(train, ax = ax1, fontsize=12)\nmsno.dendrogram(test, ax = ax2, fontsize=12)\n\n# ax1.set_title('Train Missing Values Map', fontsize = 16)\n# ax2.set_title('Test Missing Values Map', fontsize = 16);\n","ea6459a9":"train.nunique()","10e98f2b":"# train['anatomy_site'].value_counts().sort_index().plot.bar()\n\nprint(train['anatomy_site'].value_counts())\nprint(train['age'].value_counts())\nprint(train['sex'].value_counts())","78ae85bb":"# train['age'].value_counts().sort_index().plot.bar()\nplt.style.use('dark_background')\nplt.figure(figsize=(10,8))  \n# sns.set(style=\"darkgrid\")\nax = sns.countplot(x = train['age'])","ffdc42a0":"## Can use this as well to plot. \n# train['sex'].value_counts().sort_index().plot.bar()\n\n\n## Alternate and better plot:\n\n# plt.figure(figsize=(10,8))  \nsns.set(style=\"darkgrid\")\nplt.style.use('seaborn-notebook')\nax = sns.countplot(x = train['sex'])","8bb8c3b3":"print(plt.style.available)","7d922a34":"plt.figure(figsize=(10,8))\nsns.set(style=\"darkgrid\")\nplt.style.use('seaborn-notebook')\nax = sns.countplot(y = train['anatomy_site'],facecolor=(0, 0, 0, 0),\n                   linewidth=5,\n                   edgecolor=sns.color_palette(\"dark\", 3))","eccf6f41":"f, (ax1, ax2) = plt.subplots(1, 2, figsize = (15, 5))\n\nsns.set(style=\"darkgrid\")\na = sns.countplot(x = train['anatomy_site'], ax = ax1)\nb = sns.countplot(x = test['anatomy_site'], ax = ax2)\n\na.set_xticklabels(a.get_xticklabels(), rotation=45, ha=\"right\")\nb.set_xticklabels(b.get_xticklabels(), rotation=45, ha=\"right\")\n\nax1.set_title('Anatomy Site Distribution in Training Data', fontsize = 16)\nax2.set_title('Anatomy Site Distribution in Testing Data', fontsize = 16);","c2524d6f":"plt.figure(figsize = (10,8))\nplt.style.use('fivethirtyeight')\nax = sns.countplot(x= \"anatomy_site\", hue=\"sex\", data=train)","0ef590db":"plt.style.use('dark_background')\nplt.figure(figsize = (10,8))\nax = sns.countplot(x= \"sex\", hue= \"age\", data=train)","25845a0b":"plt.figure(figsize = (10,8))\nax = sns.countplot(x = \"target\", hue = \"sex\", data = train)","e309d536":"train['age'].median()","de46bad6":"train['age'].fillna(50,inplace = True) \ntrain['sex'].fillna('male', inplace = True) \ntrain['anatomy_site'].fillna('torso', inplace = True) \ntest['anatomy_site'].fillna('torso', inplace = True)\n\nprint(train.isnull().sum())\nprint(test.isnull().sum())","1180e90f":"print(train['target'].value_counts())\n\nplt.style.use('dark_background')\nplt.figure(figsize=(10,8))  \n# sns.set(style=\"darkgrid\")\nsns.countplot(x = train['target'])","485da488":"# x = dict(train['diagnosis'].value_counts())\n# print(x)\n# print(x.keys())\n\n\nplt.figure(figsize=(10,8))  \nsns.set(style=\"darkgrid\")\na = sns.countplot(x = train['diagnosis'])\na.set_xticklabels(a.get_xticklabels(), rotation=45, ha=\"right\")\n# b.set_xticklabels(b.get_xticklabels(), rotation=35, ha=\"right\")\n","fbae445d":"y = train['target']\nplt.style.use('dark_background')\n# plt.style.use('seaborn-paper')\na = y.value_counts().plot.bar()\na.set_xticklabels(a.get_xticklabels(), rotation=0, ha=\"right\")","28905eed":"from sklearn.preprocessing import LabelEncoder\n\n# Drop the unwanted columns\ntrain = train.drop(['image','ID','diagnosis','benign_malignant'],axis=1)\n\n# Label Encode categorical features\ntrain['age'].fillna(50,inplace = True) \ntrain['sex'].fillna('male', inplace = True) \ntrain['anatomy_site'].fillna('torso', inplace = True) \n\nle_sex = LabelEncoder()\nle_site = LabelEncoder()\ntrain.sex = le_sex.fit_transform(train.sex)\n\n## Getting dummies for anatomy_site\nx = pd.get_dummies(train['anatomy_site'], drop_first = True)\n\n## Concat dummies and actual data.\ntrain_x = pd.concat([train,x], axis = 1)\n","48e6eb8c":"train_x.head()","13325e26":"from imblearn.under_sampling import NearMiss\n\nX = train_x.drop(['target','anatomy_site'], axis = 1)\nn = NearMiss()\nX_new,y_new = n.fit_sample(X,y)","200c8a95":"plt.style.use('dark_background')\n# plt.style.use('seaborn-paper')\na = y_new.value_counts().plot.bar()\na.set_xticklabels(a.get_xticklabels(), rotation=0, ha=\"right\")","e92de4f9":"from imblearn.combine import SMOTETomek\nsmk = SMOTETomek(random_state=42)\nX_new_over,y_new_over = smk.fit_sample(X,y)","63faaeec":"plt.style.use('dark_background')\n# plt.style.use('seaborn-paper')\na = y_new_over.value_counts().plot.bar()\na.set_xticklabels(a.get_xticklabels(), rotation=0, ha=\"right\")","4c4c6936":"## References\n\n1. [SIIM Melanoma Competition: EDA + Augmentations](https:\/\/www.kaggle.com\/andradaolteanu\/siim-melanoma-competition-eda-augmentations)\n\n2. [Missingno Github Repository](https:\/\/github.com\/ResidentMario\/missingno)\n\n3. [Seaborn Countplot](https:\/\/seaborn.pydata.org\/generated\/seaborn.countplot.html)\n\n4. [Cover Image Source](https:\/\/www.health.harvard.edu\/cancer\/melanoma-overview)\n\n5. [Matplotlib Visualizations](https:\/\/matplotlib.org\/3.2.2\/tutorials\/introductory\/customizing.html)\n\n6. [imblearn.under_sampling.NearMiss](https:\/\/imbalanced-learn.readthedocs.io\/en\/stable\/generated\/imblearn.under_sampling.NearMiss.html)\n\n7. [imblearn.combine.SMOTETomek](https:\/\/imbalanced-learn.readthedocs.io\/en\/stable\/generated\/imblearn.combine.SMOTETomek.html)\n\n","04408d81":"## Missing Values Imputation in Training Data:\n\n- **sex : 65\/33126**\n- **age : 68\/33126**\n- **anatomy_site : 527\/33126**","4d60d638":"**In both Test and training data, 'torso' is the mode in anatomy_site column**","462782e3":"**32542 --> 0**\n\nand only\n**584 --> 1s**\n","d83ab98d":"## EDA: Let's do some Analysis.","dc8047d8":"**1. Target Variable** ","81924b3c":"![melanoma.jpg](attachment:melanoma.jpg)\n\n- **Melanoma is the deadliest form of skin cancer**. It occurs when pigment-making cells in the skin, called melanocytes, begin to reproduce uncontrollably. Melanoma can form from an existing mole or develop on unblemished skin.\n\n- The most common type of melanoma spreads on the skin's surface. It is called superficial spreading melanoma. It may stay on the surface or grow down into deeper tissues. Other types of melanoma can start anywhere on or inside the body, including under fingernails or toenails and inside the eye.\n\n- Melanoma rarely occurs before age 18. However, the risk of melanoma rises rapidly in young adulthood, making it one of the most common **life-threatening forms of cancer in people between the ages of 20 and 50.** After age 50, the risk of melanoma rises more slowly with advancing age.\n\n- Source: [Melanoma - Harvard  Health](https:\/\/www.health.harvard.edu\/cancer\/melanoma-overview)","1c283a85":"### 2. [Oversampling:](https:\/\/imbalanced-learn.readthedocs.io\/en\/stable\/generated\/imblearn.combine.SMOTETomek.html)","7a8cd7d3":"### Missing Values in Test Data:\n\n- **anatom_site : 351**\n","7cad5f55":"### Renaming the columns:","01b3dd78":"### Missing Values in Training Data.\n\n- **sex : 65**\n- **age : 68**\n- **anatomy_site : 527**\n","d41ba202":"**Both Ones and Zeroes are 584**. This is known as balanced dataset, but the issue here is we have reduced the dataset drastically. ","fc2baedb":"### Sex:\n\n- **male --> 17080**\n\n- **female --> 15981**","80ffa8c5":"**Feel free to fork and if you find this kernel helpful do cast an upvote.**","07cacd12":"## Next Steps:\n\n- Feature Extraction\n\n- Modelling\n\n- Predictions\n\n","93a6b272":"## Missing Values","bd009549":"### Anatomy_site:\n\n- torso --> 16845\n\n- lower extremity --> 8417\n\n- upper extremity --> 4983\n\n- head\/neck --> 1855\n\n- palms\/soles --> 375\n\n- oral\/genital  --> 124","c7418a0f":"**Now the sample size is north of 30K.**","abf3b3d0":"![under-over.png](attachment:under-over.png)\n\n**Oversampling** and **undersampling** in data analysis are techniques used to adjust the class distribution of a data set (i.e. the ratio between the different classes\/categories represented). These terms are used both in statistical sampling, survey design methodology and in machine learning.\n\nOversampling and undersampling are opposite and roughly equivalent techniques.\n\n**In simple Terms**\n\n- Undersampling does undersamples the training data so that both the classes have equal distribution.\n\n- Oversampling is oversamples the training data so that both the classes have equal distribution.","06881e35":"## Importing Libraries","d6a51e4d":"### 1. [Undersampling:](https:\/\/imbalanced-learn.readthedocs.io\/en\/stable\/generated\/imblearn.under_sampling.NearMiss.html)","388c2df7":"## Handling Class Imbalance:","834c5585":"### Age:\n\n- 45.0 :   4466\n\n- 50.0 :  4270\n\n- 55.0  : 3824\n\n- 40.0 : 3576\n\n- 60.0 :   3240\n\n- 35.0 :   2850\n\n- 65.0 :   2527\n\n- 30.0 :   2358\n\n- 70.0 :   1968\n\n- 25.0 :   1544\n\n- 75.0  :   981\n\n- 20.0  :   655\n\n- 80.0  :   419\n\n- 85.0  :   149\n\n- 15.0  :   132\n\n- 90.0      80\n\n- 10.0  :    17\n\n- 0.0   :     2","81deec80":"**Haven't found any strong correlation between columns**\n- Let's impute the null values with:\n\n- **Age --> Median**\n- **Sex --> Mode**\n- **Anatomy_site --> Mode**"}}