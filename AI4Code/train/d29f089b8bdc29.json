{"cell_type":{"5d462240":"code","ffd687f4":"code","b219178f":"code","623c4737":"code","5d10a5c1":"code","49da317e":"code","b62559d5":"code","e4f39a9a":"code","8b6981f5":"code","80f77d19":"code","946a9d9a":"code","507c1304":"code","d2ee99fe":"code","364562a9":"code","5c633be3":"code","6b671745":"code","9a4aca50":"code","26643c0d":"code","cd102f33":"code","126e5b42":"code","40bafb98":"markdown","a23f5a59":"markdown","ef0a3caa":"markdown","92a00a35":"markdown","7b75b21c":"markdown","c4900e39":"markdown","7c3ecff9":"markdown"},"source":{"5d462240":"import matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\n\nimport tensorflow as tf\n\nfrom tensorflow import keras\nfrom tensorflow.keras import layers\nfrom tensorflow.keras.layers.experimental import preprocessing\n\nfrom tensorflow.keras.callbacks import TensorBoard\nprint(tf.__version__)","ffd687f4":"tensorboard = TensorBoard(\n  log_dir='.\\logs',\n  histogram_freq=1,\n  write_images=True\n)\nkeras_callbacks = [\n  tensorboard\n]","b219178f":"train_data = pd.read_csv('..\/input\/tabular-playground-series-jul-2021\/train.csv')\ntest_data = pd.read_csv('..\/input\/tabular-playground-series-jul-2021\/test.csv')","623c4737":"train_dataset = train_data.sample(frac=0.8, random_state=0)\ntest_dataset = train_data.drop(train_dataset.index)","5d10a5c1":"features = ['sensor_1','sensor_2','sensor_3','sensor_4','sensor_5']\n","49da317e":"train_dataset.describe().T","b62559d5":"sns.heatmap(train_dataset.corr())","e4f39a9a":"train_features = train_data.copy()\ntest_features = test_dataset.copy()\n\ntrain_labels = pd.DataFrame([train_features.pop(x) for x in ['date_time','target_carbon_monoxide','target_benzene','target_nitrogen_oxides']]).T\ntest_labels = pd.DataFrame([test_features.pop(x) for x in ['date_time','target_carbon_monoxide','target_benzene','target_nitrogen_oxides']]).T\n","8b6981f5":"normalizer = preprocessing.Normalization(axis=-1)\nnormalizer.adapt(np.array(train_features[features]))","80f77d19":"model = keras.Sequential([ normalizer, \n                          layers.Dense(16, activation='relu'), \n                          layers.Dense(16, activation='relu'),\n                          layers.Dense(3)])\nmodel.compile(loss='mean_squared_error', optimizer=tf.keras.optimizers.Adam(0.001))\n","946a9d9a":"history = model.fit(train_features[features], \n                    np.asarray(train_labels[['target_carbon_monoxide','target_benzene','target_nitrogen_oxides']]).astype('float32'),\n                    validation_split=0.2, verbose=0, epochs=100, callbacks=keras_callbacks)\n","507c1304":"def plot_loss(history):\n  plt.plot(history.history['loss'], label='loss')\n  plt.plot(history.history['val_loss'], label='val_loss')\n  plt.ylim([0, 50000])\n  plt.xlabel('Epoch')\n  plt.ylabel('Error')\n  plt.legend()\n  plt.grid(True)\n  plt.show()","d2ee99fe":"plot_loss(history)","364562a9":"test_predictions = model.predict(test_features[features])","5c633be3":"def r_squared(y, f):\n    ss_tot = np.sum((y - (np.sum(y)\/len(y)))**2)\n    ss_res = np.sum((y - f)**2)\n    return 1 - ss_res\/ss_tot","6b671745":"r_squared(test_labels['target_carbon_monoxide'],test_predictions[:,0])","9a4aca50":"r_squared(test_labels['target_benzene'],test_predictions[:,1])","26643c0d":"r_squared(test_labels['target_nitrogen_oxides'],test_predictions[:,2])","cd102f33":"test_labels = pd.DataFrame(test_data.pop('date_time'))","126e5b42":"pred = model.predict(test_data[features])\ntest_labels['target_carbon_monoxide'] = pred[:,0]\ntest_labels['target_benzene'] = pred[:,1]\ntest_labels['target_nitrogen_oxides'] = pred[:,2]\n\ntest_labels.to_csv('submission.csv',index = False)","40bafb98":"# Testing Model Predictions","a23f5a59":"# Model ","ef0a3caa":"# Loading Data","92a00a35":"# EDA","7b75b21c":"# Making Predictions","c4900e39":"# Splitting Train Data into Test and Train Datasets","7c3ecff9":"# Separating Features and labels"}}