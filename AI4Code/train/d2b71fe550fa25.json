{"cell_type":{"4709142b":"code","7a3f0984":"code","c6ac7c5f":"code","30b1e60b":"code","b47248b0":"code","8dde41f7":"code","e984b6bb":"code","7ccab27e":"code","36059ab6":"code","e818006c":"code","f9bbc30a":"code","4531f783":"code","48ed9876":"code","305fa413":"code","937d7ddc":"code","f273ba01":"code","4c30becf":"code","e85f6722":"code","1d9761cf":"code","81be7904":"code","5f1c3cef":"code","85f4a693":"code","dbe94b66":"code","f346f1f9":"code","30bbbae4":"code","f1674b05":"code","68854401":"code","734b6d1f":"code","239c16f5":"code","74040e78":"code","87f6def0":"code","da9bca1d":"code","37321dd5":"code","152aabc7":"markdown","1c42ad8f":"markdown","80fcc0c9":"markdown","3a27ce85":"markdown","21123c8d":"markdown","81fd514d":"markdown","359d85d8":"markdown","933074fd":"markdown","6762c5b6":"markdown","bd942bac":"markdown","b0d13faf":"markdown","f9f20e01":"markdown","42b72023":"markdown"},"source":{"4709142b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","7a3f0984":"import seaborn as sns\nimport matplotlib.pyplot as plt","c6ac7c5f":"#Users\nu_cols = ['user_id', 'location', 'age']\nusers = pd.read_csv('..\/input\/bookcrossing-dataset\/Book reviews\/BX-Users.csv', sep=';', names=u_cols, encoding='latin-1',low_memory=False)\n\n#Books\ni_cols = ['isbn', 'book_title' ,'book_author','year_of_publication', 'publisher', 'img_s', 'img_m', 'img_l']\nitems = pd.read_csv('..\/input\/bookcrossing-dataset\/Book reviews\/BX-Books.csv', sep=';', names=i_cols, encoding='latin-1',low_memory=False)\n\n#Ratings\nr_cols = ['user_id', 'isbn', 'rating']\nratings = pd.read_csv('..\/input\/bookcrossing-dataset\/Book reviews\/BX-Book-Ratings.csv', sep=';', names=r_cols, encoding='latin-1',low_memory=False)","30b1e60b":"users.head(5)\nusers.shape","b47248b0":"items.head(5)\nitems.shape","8dde41f7":"ratings.head(5)\nratings.shape","e984b6bb":"users = users.drop(users.index[0])\nitems = items.drop(items.index[0])\nratings = ratings.drop(ratings.index[0])","7ccab27e":"df = pd.merge(users, ratings, on='user_id')\ndf = pd.merge(df, items, on='isbn')\ndf.head(5)\ndf.shape","36059ab6":"df = df[:102000]\ndf.shape","e818006c":"df = df.dropna()\ndf.drop(['img_s','img_m','img_l'],axis=1,inplace=True)\ndf.head()","f9bbc30a":"df.describe()","4531f783":"df['age'] = df['age'].astype(int)\ndf['user_id'] = df['user_id'].astype(int)\ndf['rating'] = df['rating'].astype(int)","48ed9876":"location = df.location.str.split(', ', n=2, expand=True)\nlocation.columns=['city', 'state', 'country']\n\ndf['city'] = location['city']\ndf['state'] = location['state']\ndf['country'] = location['country']","305fa413":"df.head(5)","937d7ddc":"df.isna().sum()","f273ba01":"df.groupby('book_title')['rating'].mean().sort_values(ascending=False).head(5)","4c30becf":"df.groupby('book_title')['rating'].count().sort_values(ascending=False).head(5)","e85f6722":"ratings = pd.DataFrame(df.groupby('book_title')['rating'].mean())\nratings.head(5)","1d9761cf":"ratings['num of ratings'] = pd.DataFrame(df.groupby('book_title')['rating'].count())\nratings.head(5)","81be7904":"ratings['num of ratings'].hist(bins=80)","5f1c3cef":"ratings['rating'].hist(bins=70)","85f4a693":"sns.jointplot(x='rating',y='num of ratings',data=ratings,alpha=0.5)","dbe94b66":"df.head(10)","f346f1f9":"df1 = df.pivot_table(index='user_id',columns='book_title',values='rating').fillna(0)\ndf1.head(10)","30bbbae4":"ratings.sort_values('num of ratings',ascending=False).head(10)","f1674b05":"DV_rating = df1['The Da Vinci Code']\nLP_rating = df1['Life of Pi']\nHP_rating = df1['Harry Potter and the Goblet of Fire (Book 4)']\nDV_rating.head()","68854401":"similar_to_DV = df1.corrwith(DV_rating)\nsimilar_to_LP = df1.corrwith(LP_rating)\nsimilar_to_HP = df1.corrwith(HP_rating)\nsimilar_to_DV.sort_values(ascending=False).head()","734b6d1f":"corr_DV = pd.DataFrame(similar_to_DV,columns=['correlation'])\ncorr_DV.dropna(inplace=True)\ncorr_DV = corr_DV.join(ratings['num of ratings'])\ncorr_DV.head()","239c16f5":"corr_DV[corr_DV['num of ratings']>200].sort_values('correlation',ascending=False).head()","74040e78":"corr_LP = pd.DataFrame(similar_to_LP,columns=['correlation'])\ncorr_LP.dropna(inplace=True)\ncorr_LP = corr_LP.join(ratings['num of ratings'])","87f6def0":"corr_LP[corr_LP['num of ratings']>200].sort_values('correlation',ascending=False).head()","da9bca1d":"corr_HP = pd.DataFrame(similar_to_HP,columns=['correlation'])\ncorr_HP.dropna(inplace=True)\ncorr_HP = corr_HP.join(ratings['num of ratings'])","37321dd5":"corr_HP[corr_HP['num of ratings']>200].sort_values('correlation',ascending=False).head()","152aabc7":"# Imports","1c42ad8f":"# What does the data look like?","80fcc0c9":"# Merging the dataframes","3a27ce85":"### We now create a pivot table. From this table we use the same users who rated for different books. This is collaborative filtering based recommendation system(similarity between users). ","21123c8d":"### We can see different books suggested whose number of ratings are less but has perfect correlation. So lets filter out the number of ratings to 200. This will improve our recommended books.","81fd514d":"## Splitting location column into newer columns","359d85d8":"So now we use the count() function to see the number of user that rated the books. In this we can see 'Wild Animus' has the most users rated to it.","933074fd":"Changing The Dataframe chunk to 1 Lakh because I was running out of memory. you can work with original data which will give you better result.","6762c5b6":"# Reading csv files","bd942bac":"# Dropping null values and Unwanted values","b0d13faf":"# Collaborative Filtering Based Recommender\n\n### DV_rating - The Da Vinci Code, LP_rating - Life of Pi, HP_rating - Harry Potter. I'm using these three books for our recomendation. ","f9f20e01":"# Changing datatypes","42b72023":"Lets see which books got highest ratings. As we can see here these 5 books from top got 10\/10 rating. Bit suspicious, it is possible that only one user read it and rate it as 10."}}