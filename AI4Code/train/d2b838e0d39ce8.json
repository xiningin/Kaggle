{"cell_type":{"75254c9f":"code","c05dc754":"code","8d964250":"code","58a27e7c":"code","6a5571dc":"code","b81623eb":"code","62998693":"code","4c5e1dfb":"code","8d2a6d19":"code","bdba6ffd":"code","d4abb9b8":"markdown","f4b73026":"markdown","95353d60":"markdown","2614c3be":"markdown","0869108e":"markdown","ae8a51ce":"markdown","d742ef3b":"markdown","f62f77d1":"markdown","d260f417":"markdown"},"source":{"75254c9f":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","c05dc754":"from fastai.vision import *\nfrom fastai.metrics import error_rate","8d964250":"!ls ..\/input\/train","58a27e7c":"path = Path(\"..\/input\/\")\ntfms = get_transforms()\ndata = ImageDataBunch.from_folder(path,valid_pct=0.1,test=\"test\", ds_tfms=tfms, size=224)","6a5571dc":"learn = cnn_learner(data, models.resnet18, metrics=error_rate)","b81623eb":"learn.fit_one_cycle(1)","62998693":"sub=pd.read_csv('..\/input\/sample_submission.csv').set_index('id')\nsub.head()","4c5e1dfb":"preds, _ = learn.get_preds(ds_type=DatasetType.Test)\nthresh = 0.2\nlabelled_preds = [' '.join([learn.data.classes[i] for i,p in enumerate(pred) if p > thresh]) for pred in preds]\n\nlabelled_preds[:5]","8d2a6d19":"fnames = [f.name[:-4] for f in learn.data.test_ds.items]","bdba6ffd":"df = pd.DataFrame({'id':fnames, 'predicted_class':labelled_preds}, columns=['id', 'predicted_class'])\ndf['id'] = df['id'].astype(str) + '.jpg'\ndf.to_csv('\/kaggle\/working\/submission.csv', index=False)","d4abb9b8":"### Set autoreload and defaults for notebook","f4b73026":"## Finish","95353d60":"Let's peek inside of the training folder","2614c3be":"Let's peek into the sample submission","0869108e":"1. Set path\n2. Import Transforms\n3. Create databunch object.","ae8a51ce":"## Import from fastai vision","d742ef3b":"Dirt Logic: Don't copy blindly","f62f77d1":"- Create a learner object\n- Ideas: Use other resnets","d260f417":"Idea: Fit more, Unfreeze and fit more"}}