{"cell_type":{"eea890d8":"code","fd217381":"code","380dc7d4":"code","0d73a53b":"code","ec24c3f0":"code","08a8bde5":"code","d63e75b7":"code","1f7681ba":"code","051e4928":"code","ef5d5090":"code","43752f56":"code","9200a61f":"code","7d849bcc":"code","5c837fb1":"code","c4b954d1":"code","ba2987b7":"code","3ffc2f33":"code","2c7680f5":"code","865ec21e":"code","00e36795":"code","62c2388a":"code","cc5ff440":"markdown","9f79689c":"markdown","f64d5452":"markdown","e6ca0a7d":"markdown","18daf3ef":"markdown","6b1beb33":"markdown","818798c1":"markdown","d6f9d4d6":"markdown","3567d3e6":"markdown","354273bd":"markdown","84060302":"markdown","eccd0ceb":"markdown","13a4a692":"markdown","52890908":"markdown","fb068baa":"markdown","b9c9f2ba":"markdown"},"source":{"eea890d8":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt","fd217381":"\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","380dc7d4":"train = pd.read_csv(\"\/kaggle\/input\/tabular-playground-series-jul-2021\/train.csv\")\ntrain","0d73a53b":"test = pd.read_csv(\"\/kaggle\/input\/tabular-playground-series-jul-2021\/test.csv\")\ntest","ec24c3f0":"submission = pd.read_csv(\"\/kaggle\/input\/tabular-playground-series-jul-2021\/sample_submission.csv\")\nsubmission","08a8bde5":"#plt.plot(train.date_time, train.target_carbon_monoxide)\n#plt.xlabel('Date')\n#plt.ylabel('Carbon Monoxide')\n#plt.title('Carbon Monoxide')\n#plt.show()","d63e75b7":"#plt.plot(train.date_time, train.target_benzene)\n#plt.xlabel('Date')\n#plt.ylabel('Benzene')\n#plt.title('Benzene')\n#plt.show()","1f7681ba":"#plt.plot(train.date_time, train.target_nitrogen_oxides)\n#plt.xlabel('Date')\n#plt.ylabel('Nitrogen Oxides')\n#plt.title('Nitrogen Oxides')\n#plt.show()","051e4928":"target = train[['target_carbon_monoxide', 'target_benzene', 'target_nitrogen_oxides']]\ntrain.drop(['target_carbon_monoxide', 'target_benzene', 'target_nitrogen_oxides'], axis = 1, inplace = True)\ntrain","ef5d5090":"combi = train.append(test)\ncombi","43752f56":"combi.drop(['date_time'], axis = 1, inplace = True)\ncombi","9200a61f":"combi.isnull().sum()","7d849bcc":"combi = (combi.max() - combi) \/ (combi.max() - combi.min())\ncombi","5c837fb1":"y = target\nX = combi[: len(train)]\nX_test = combi[len(train) :]","c4b954d1":"from sklearn.model_selection import train_test_split\n\nX_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.10, random_state=1)\nX_train.shape, y_train.shape, X_val.shape, y_val.shape, X_test.shape","ba2987b7":"from sklearn.multioutput import RegressorChain\nfrom sklearn.neural_network import MLPRegressor\n\nmodel = RegressorChain(MLPRegressor(random_state=1, max_iter = 500)).fit(X_train, y_train)\nmodel.score(X_train, y_train)","3ffc2f33":"y_pred = model.predict(X_val)\nmodel.score(X_val, y_val)","2c7680f5":"predictions = model.predict(X_test)\npredictions.shape","865ec21e":"predictions[predictions < 0] = 0","00e36795":"submission.target_carbon_monoxide = predictions[:, 0]\nsubmission.target_benzene = predictions[:, 1]\nsubmission.target_nitrogen_oxides = predictions[:, 2]","62c2388a":"submission.to_csv('submission.csv', index=False)\nsubmission = pd.read_csv(\"submission.csv\")\nsubmission","cc5ff440":"Define model","9f79689c":"Predict on validation set","f64d5452":"Define target and drop from train","e6ca0a7d":"Analyse targets","18daf3ef":"Predict on test set","6b1beb33":"Read","818798c1":"Prepare submission","d6f9d4d6":"Check for null values","3567d3e6":"Split X for training and validationg","354273bd":"Drop date_time","84060302":"Combine train and test","eccd0ceb":"see paper on regressor chains:- https:\/\/www.scitepress.org\/Papers\/2019\/79328\/79328.pdf","13a4a692":"Problem statement:-\nThis is a time series problem dealing with air quality","52890908":"Import","fb068baa":"Define X and y","b9c9f2ba":"Normalise combi"}}