{"cell_type":{"00a3b396":"code","a6c498c2":"code","31adb1ae":"code","d42fefec":"code","0aa295b2":"code","e238310b":"code","9ca2c24f":"code","f561272a":"code","1da01cbb":"markdown","46889eb8":"markdown","bf4fcd87":"markdown"},"source":{"00a3b396":"import tensorflow as tf\nimport numpy as np\nfrom IPython.display import SVG\nfrom keras.utils.vis_utils import model_to_dot\nSequential = tf.keras.models.Sequential\nModel = tf.keras.models.Model\nlayers = tf.keras.layers\nInput = tf.keras.Input","a6c498c2":"# in the functional api you directly manipulate tensors and use layers as functions that take tensors and return tensors (hence the name funtional API)\ninput_tensor = tf.keras.Input(shape=(32,))           # a tensor\ndense = tf.keras.layers.Dense(32, activation='relu') # a layer is a function\noutput_tensor = dense(input_tensor)                  # a layer may be called on a tensor, and it returns a tensor","31adb1ae":"seq_model = Sequential()\nseq_model.add(layers.Dense(32, activation='relu', input_shape=(64,)))\nseq_model.add(layers.Dense(32, activation='relu'))\nseq_model.add(layers.Dense(10, activation='softmax'))\nseq_model.summary()","d42fefec":"SVG(model_to_dot(seq_model,show_shapes=True).create(prog='dot', format='svg'))","0aa295b2":"input_tensor = Input(shape=(64,))\nx = layers.Dense(32, activation='relu')(input_tensor)\nx = layers.Dense(32, activation='relu')(x)\noutput_tensor = layers.Dense(10, activation='softmax')(x)\nfunc_model = Model(input_tensor, output_tensor)\nfunc_model.summary()","e238310b":"func_model.compile(optimizer='rmsprop', loss='categorical_crossentropy')\nx_train = np.random.random((1000, 64))\ny_train = np.random.random((1000, 10))\n\nfunc_model.fit(x_train, y_train, epochs=10, batch_size=128)","9ca2c24f":"score = func_model.evaluate(x_train, y_train)\nscore","f561272a":"SVG(model_to_dot(func_model,show_shapes=True).create(prog='dot', format='svg'))","1da01cbb":"#Compare Sequential model and Functional model","46889eb8":"Functional","bf4fcd87":"Sequential"}}