{"cell_type":{"b75124ec":"code","9a35ae43":"code","edaccf2a":"code","e7606b1d":"code","3f5685df":"code","5044d4e9":"code","036b25a1":"code","8ad1d0e1":"code","be5d8350":"code","c204e7e9":"code","dfed4c7a":"code","0cf75f6d":"code","d37200e3":"code","52111040":"code","1d898eca":"code","2253755e":"code","769011e8":"code","8b487245":"code","bfd5408b":"code","c29912af":"code","eb0c8c22":"code","b5e200b8":"code","147cacea":"code","2fee1312":"code","828c9091":"code","acb656f3":"code","7b075454":"code","5216dd2e":"code","8dfe16d6":"code","56d1a259":"code","192618d2":"code","12d26eef":"code","3dc8fda9":"code","be8e57ed":"code","d457ba67":"code","0ae42ad1":"code","a9497b79":"code","d695e0a2":"code","b8ebb10e":"code","4bc3fce9":"code","934298e6":"code","b6cc7a5b":"code","553c8317":"markdown","37c9090f":"markdown","63eeafb0":"markdown","431bf806":"markdown","638a19ce":"markdown","76d0ae5d":"markdown","87d3529c":"markdown","b1c113c9":"markdown","6702f0bb":"markdown","4d3358e7":"markdown"},"source":{"b75124ec":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport missingno as mn\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nimport statsmodels.api as sm\nfrom sklearn.metrics import confusion_matrix,precision_score,recall_score,f1_score,accuracy_score\nfrom sklearn.model_selection import cross_val_predict\nfrom sklearn import metrics\n# Suppressing Warnings\nimport warnings\nwarnings.filterwarnings('ignore')","9a35ae43":"penguin = pd.read_csv('..\/input\/penguin-data-set\/Penguins_data.csv')","edaccf2a":"penguin.head()","e7606b1d":"penguin.shape","3f5685df":"penguin.info()","5044d4e9":"mn.matrix(penguin)","036b25a1":"round(100*(penguin.isnull().sum()\/(len(penguin))),2)","8ad1d0e1":"# We will predict the sex of the penguins therefore we will drop all the rows with null values in 'Sex' column\npenguin.dropna(subset=['sex'],axis = 0,inplace = True)","be5d8350":"# Checking the shape after dropping the rows\npenguin.shape","c204e7e9":"penguin.info()","dfed4c7a":"# All the missing values are gone\nround(100*(penguin.isnull().sum()\/(len(penguin))),)","0cf75f6d":"penguin['species'].value_counts().plot.bar()","d37200e3":"penguin['island'].value_counts().plot.bar()","52111040":"# Creating dummy variables for species\nspecies = pd.get_dummies(penguin['species'], drop_first=True)\nspecies.head()","1d898eca":"# Creating dummy variables for island\nisland = pd.get_dummies(penguin['island'], drop_first=True)\nisland.head()","2253755e":"penguin = pd.concat([penguin,species,island],axis = 1)","769011e8":"penguin.head()","8b487245":"# Dropping the 'species' and 'island' columns\npenguin.drop(['species','island'],axis = 1,inplace = True)","bfd5408b":"penguin.head()","c29912af":"var = ['bill_length_mm','bill_depth_mm','flipper_length_mm','body_mass_kg']\nscaler = StandardScaler()\npenguin[var] = scaler.fit_transform(penguin[var])","eb0c8c22":"penguin.head()","b5e200b8":"penguin['sex'] = penguin['sex'].map({'male':1,'female':0})","147cacea":"penguin.head()","2fee1312":"X = penguin.drop(['sex'],1)\ny = penguin.sex","828c9091":"X.head()","acb656f3":"y.head()","7b075454":"X_train,X_test,y_train,y_test = train_test_split(X,y,train_size = 0.7,random_state = 100)","5216dd2e":"log_reg1 = LogisticRegression()\nlog_reg1.fit(X_train,y_train)","8dfe16d6":"# lets make predictions\ny_train = pd.DataFrame(y_train)\nprediction = log_reg1.predict(X_train)","56d1a259":"prediction","192618d2":"# Confusion_matrix\nconfusion_matrix(prediction,y_train)","12d26eef":"# Precision_score\nprecision_score(prediction,y_train)","3dc8fda9":"# Recall_score\nrecall_score(prediction,y_train)","be8e57ed":"# F1 score\nf1_score(prediction,y_train)","d457ba67":"# Accuracy score\naccuracy_score(prediction,y_train)","0ae42ad1":"# Using Statsmodel\nX_train_lr = sm.add_constant(X_train)\nlog_reg2 = sm.GLM(y_train,X_train,family = sm.families.Binomial()).fit()","a9497b79":"log_reg2.summary()","d695e0a2":"# Getting the predicted values on the train set\ny_train_pred = log_reg2.predict(X_train)\ny_train_pred[:10]","b8ebb10e":"y_train_pred = y_train_pred.values.reshape(-1)\ny_train_pred[:10]","4bc3fce9":"def draw_roc( actual, probs ):\n    fpr, tpr, thresholds = metrics.roc_curve( actual, probs,\n                                              drop_intermediate = False )\n    auc_score = metrics.roc_auc_score( actual, probs )\n    plt.figure(figsize=(5, 5))\n    plt.plot( fpr, tpr, label='ROC curve (area = %0.2f)' % auc_score )\n    plt.plot([0, 1], [0, 1], 'k--')\n    plt.xlim([0.0, 1.0])\n    plt.ylim([0.0, 1.05])\n    plt.xlabel('False Positive Rate or [1 - True Negative Rate]')\n    plt.ylabel('True Positive Rate')\n    plt.title('Receiver operating characteristic example')\n    plt.legend(loc=\"lower right\")\n    plt.show()\n\n    return None","934298e6":"fpr, tpr, thresholds = metrics.roc_curve(y_train['sex'], y_train_pred, drop_intermediate = False )","b6cc7a5b":"draw_roc(y_train['sex'], y_train_pred)","553c8317":"### Step 4 Mapping of the column 'sex' into 0 and 1","37c9090f":"### Step 5 Splitting the data into train and test","63eeafb0":"### Step 6 Model Building","431bf806":"### Step 2 Dummy Encoding","638a19ce":"### This notebook is about predicting the sex of the penguin based on the following features:\n1.Species\n2.Island\n3.Bill length\n4.Bill_depth\n5.Flipper length\n6.BMI\n\n### Logistic Regression has been used for this problem statement","76d0ae5d":"# Data Preprocessing","87d3529c":"### Step 3 Scaling the features","b1c113c9":"### Step 1 Dealing with the missing values","6702f0bb":"####  -we can see than there are a few missing values in the data","4d3358e7":"### From the above ROC curve we can see that the area under the curve is '0.97' which not  bad"}}