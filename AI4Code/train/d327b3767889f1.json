{"cell_type":{"8ce39414":"code","a6353c54":"code","e3a04722":"code","1da727fc":"code","4482f967":"code","9c4cf3cc":"code","6a388089":"code","f3cc7630":"code","4cf55bad":"code","322d3ee4":"code","20440522":"code","57b2e36a":"code","7559e6b7":"code","d655a038":"code","96bca305":"code","2cfad9fb":"code","c618cec1":"code","3d667e08":"code","036d955e":"markdown","16b1f62d":"markdown","241bb75b":"markdown","d8e87547":"markdown","3b4f03ca":"markdown"},"source":{"8ce39414":"import pandas as pd\nimport numpy as np\nhitters=pd.read_csv(\"..\/input\/hittlers\/Hitters.csv\")\ndf=hitters.copy()","a6353c54":"df=df.dropna()\ndf.head(2)","e3a04722":"y=df[\"Salary\"]\nx=df.drop([\"League\",\"Division\",\"NewLeague\",\"Salary\"],axis=1).astype(\"float64\")\ndummies = pd.get_dummies(df[['League', 'Division', 'NewLeague']])\nX=pd.concat([x,dummies[[\"League_N\",\"Division_W\",\"NewLeague_N\"]]],axis=1)","1da727fc":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y, test_size=0.25,random_state=42)","4482f967":"#STANDARDIZATION","9c4cf3cc":"from sklearn.preprocessing import StandardScaler   #if structures of outliers and variables' variances are so different \n                                                   #than each other, result's confidence decreases so we do standardization.","6a388089":"scaler=StandardScaler()\nscaler.fit(X_train)","f3cc7630":"\nX_train_scaled=scaler.transform(X_train)\nX_test_scaled=scaler.transform(X_test)","4cf55bad":"from sklearn.neural_network import MLPRegressor\nmlp_model=MLPRegressor(hidden_layer_sizes=(100,20)).fit(X_train_scaled,y_train)\nmlp_model.n_layers_","322d3ee4":"mlp_model.hidden_layer_sizes","20440522":"mlp_model.predict(X_train_scaled)[0:5]","57b2e36a":"y_pred=mlp_model.predict(X_test_scaled)\nfrom sklearn.metrics import mean_squared_error\nnp.sqrt(mean_squared_error(y_test,y_pred))","7559e6b7":"mlp_params={\"alpha\":[0.01,0.02,0.005],\"hidden_layer_sizes\":[(20,20),(100,50,150),(300,200,150)], \n            \"activation\":[\"relu\",\"logistic\"]}\n","d655a038":"from sklearn.model_selection import GridSearchCV\nmlp_cv_model=GridSearchCV(mlp_model,mlp_params,cv=10)","96bca305":"mlp_cv_model.fit(X_train_scaled,y_train)\n","2cfad9fb":"mlp_cv_model.best_params_","c618cec1":"from sklearn.neural_network import MLPRegressor\nmlp_tuned=MLPRegressor(alpha= 0.01, hidden_layer_sizes = (100, 50, 150))","3d667e08":"mlp_tuned.fit(X_train_scaled,y_train)\ny_pred=mlp_tuned.predict(X_test_scaled)\nnp.sqrt(mean_squared_error(y_test,y_pred))    #THE REAL TEST ERROR","036d955e":"# Artifical Neural Network TEST ERROR IS 363 THE BEST ONE, T\u0130LL NOW. \n# WE HAD 413 FROM KNN_TUNED.\n# WE HAD 367 FROM SVR_TUNED.\n","16b1f62d":"# 2) SET A MODEL","241bb75b":"# 4)TUNING","d8e87547":"# 1)IMPORT DATA AND SPLIT IT INTO TRAIN AND TEST DATA SETS","3b4f03ca":"# 3)PREDICTION"}}