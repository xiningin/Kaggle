{"cell_type":{"10c2c18b":"code","9b8642b9":"code","047df273":"code","2c82dc34":"code","b8d0cda9":"code","f0e7f839":"code","661793a8":"code","9b4e91e8":"code","4254343f":"code","7d028fa6":"code","5ff5b438":"code","a96ccb3d":"code","935755db":"code","67598a2d":"code","240c915d":"code","50d652de":"code","53ccfe00":"code","c44f7819":"code","24fb7a6c":"code","2f08e2f8":"code","60f127cc":"code","79116df7":"code","3b491848":"code","50545be7":"markdown","89510487":"markdown","746fbbad":"markdown","8b789899":"markdown","7903ec76":"markdown","4df2841a":"markdown","9137c1a0":"markdown"},"source":{"10c2c18b":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline","9b8642b9":"data=pd.read_csv('..\/input\/iris-flower-dataset\/IRIS.csv')\ndata.head()","047df273":"petal=data.drop(['sepal_length','sepal_width','species'],1)\npetal","2c82dc34":"plt.scatter(petal['petal_length'],petal['petal_width'])","b8d0cda9":"from sklearn.cluster import KMeans","f0e7f839":"kmeans=KMeans(n_clusters=3)\nkmeans","661793a8":"kmeans.fit(petal)","9b4e91e8":"pred=kmeans.predict(petal)\npred","4254343f":"centroids=kmeans.cluster_centers_\ncentroids","7d028fa6":"petal['CLUSTERING']=pred\npetal","5ff5b438":"petal1=petal[petal.CLUSTERING==0]\npetal2=petal[petal.CLUSTERING==1]\npetal3=petal[petal.CLUSTERING==2]\n\nplt.scatter(petal1['petal_length'],petal1['petal_width'],color='green')\nplt.scatter(petal2['petal_length'],petal2['petal_width'],color='red')\nplt.scatter(petal3['petal_length'],petal3['petal_width'],color='yellow')\nplt.scatter(centroids[:,0],centroids[:,1],color='blue',marker='*')\n\n\nplt.xlabel('petal_length')\nplt.ylabel('petal_width')\n","a96ccb3d":"distortions=[]\nK=range(1,10)\nfor k in K:\n    kmeans=KMeans(n_clusters=k)\n    kmeans.fit(petal)\n    distortions.append(kmeans.inertia_)\n    \ndistortions","935755db":"plt.plot(K,distortions, 'bx-')\nplt.xlabel('k')\nplt.ylabel('Distortion')\nplt.title('The Elbow Method showing the optimal k')\nplt.show()","67598a2d":"data['species'].value_counts()","240c915d":"fulldata=data.drop('species',1)\nfulldata.head()","50d652de":"KMNS=KMeans(n_clusters=3)\nKMNS","53ccfe00":"KMNS.fit(fulldata)","c44f7819":"prediction=KMNS.predict(fulldata)\nprediction","24fb7a6c":"data['predicted']=prediction\ndata","2f08e2f8":"centroids=KMNS.cluster_centers_\ncentroids","60f127cc":"data1=data.copy()\ndata1[\"species\"]=data1[\"species\"].map({'Iris-versicolor':0,'Iris-setosa':1,'Iris-virginica':2}).astype(int)\ndata1['predicted']=prediction\ndata1","79116df7":"data['predicted']=prediction\ndata","3b491848":"from sklearn.metrics import confusion_matrix\nconfusion_matrix(data1['species'],prediction)","50545be7":"the above graph shows that elbow formed at k=3 so hence we took n_clusters=3 is  good ","89510487":"we are taking petal length and petal width for clustering ","746fbbad":"Iris-versicolor 48 are correctly predicted  2  wrongly predicted .50 data of Iris-setosa are wcorrectly predicted. 50 data of Iris-virginica 36 are correctly predicted whereas 14 are wrongly predicted .\n\n","8b789899":"thats how petal data is scattered \nby using k means algoritham we are clustering the petal data","7903ec76":"by using the elbow method lets check the n_clusters value ","4df2841a":"visualize the data after clustering","9137c1a0":"model has prepared for clustering the data now lets take the sepal data also to cluster "}}