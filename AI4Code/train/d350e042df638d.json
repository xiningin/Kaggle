{"cell_type":{"677071c1":"code","5e53f329":"code","5b83fe07":"code","c59790f4":"code","2f8dcd1c":"code","95fa5395":"code","b9db3d29":"code","1c891439":"code","53db8cf5":"code","517d71ce":"code","3fea7de7":"code","da056dc7":"code","5a3f0b23":"code","f59e8205":"code","1c5da135":"code","cbaa78a9":"code","be1dc741":"code","9b35f665":"code","4077dc71":"code","ffac1fe7":"markdown","9b711d48":"markdown","9ef72072":"markdown","8e1a465c":"markdown","2eb26504":"markdown","1bbf60e3":"markdown","f54b5f38":"markdown","d50a9495":"markdown","73fc0a1c":"markdown","fad65c84":"markdown","c87ead02":"markdown","84fd93fa":"markdown","ab0ea55f":"markdown","569f5e54":"markdown","0bcd626a":"markdown","31cb8352":"markdown"},"source":{"677071c1":"from IPython.display import clear_output\n!pip3 install pycaret --user\nclear_output()","5e53f329":"import numpy as np\nimport pandas as pd \n\nimport random\nimport os \n\nfrom pycaret.classification import *","5b83fe07":"TRAIN_PATH = \"..\/input\/titanic\/train.csv\"\nTEST_PATH = \"..\/input\/titanic\/test.csv\"\nSAMPLE_SUBMISSION_PATH = \"..\/input\/titanic\/gender_submission.csv\"\nSUBMISSION_PATH = \"submission.csv\"\n\nID = \"PassengerId\"\nTARGET = \"Survived\"\n\nSEED = 2022\n\ndef seed_everything(seed: int = SEED):\n    random.seed(seed)\n    np.random.seed(seed)\n    os.environ[\"PYTHONHASHSEED\"] = str(seed)\n    \nseed_everything()","c59790f4":"train = pd.read_csv(TRAIN_PATH)\ntest = pd.read_csv(TEST_PATH)","2f8dcd1c":"setup(\n    data=train,\n    target=TARGET,\n    silent=True\n)","95fa5395":"model = create_model('lightgbm')","b9db3d29":"tuneModel = tune_model(model,optimize = 'AUC')","1c891439":"plot_model(tuneModel)","53db8cf5":"plot_model(tuneModel, plot = 'error')","517d71ce":"plot_model(tuneModel, plot='feature')","3fea7de7":"evaluate_model(tuneModel)","da056dc7":"plot_model(tuneModel,plot = 'confusion_matrix',use_train_data=True)","5a3f0b23":"plot_model(tuneModel,plot = 'confusion_matrix')","f59e8205":"plot_model(tuneModel,plot = 'class_report',use_train_data=True)","1c5da135":"plot_model(tuneModel,plot = 'class_report')","cbaa78a9":"predict_model(tuneModel)","be1dc741":"finalModel = finalize_model(tuneModel)","9b35f665":"pred_test = predict_model(finalModel, data=test)\npred_test[:5]","4077dc71":"sub = pd.read_csv(SAMPLE_SUBMISSION_PATH)\nsub[TARGET] = pred_test[\"Label\"]\nsub.to_csv(SUBMISSION_PATH,index=False)\nsub.head()","ffac1fe7":"# predict test data target ","9b711d48":"4.1. plot model","9ef72072":"5.1.evaluate model","8e1a465c":"1. pycaret default setup","2eb26504":"3.tune model as AUC score ","1bbf60e3":"5.4.class report(validataion data)","f54b5f38":"4.2.plot error ","d50a9495":"# build lightgbm model","73fc0a1c":"5.2. confusion matrix (train data)","fad65c84":"2.create pycaret lightgbm model","c87ead02":"6.predict model","84fd93fa":"5.3. confusion matrix (validation data)","ab0ea55f":"7.fianlize model ","569f5e54":"4.3. plot feature importance","0bcd626a":"# make submission csv ","31cb8352":"5.3.class report (train data)"}}