{"cell_type":{"a71b9653":"code","65ef13cc":"code","23ae34b6":"code","e5f6562c":"code","0e9a12c6":"code","eb46bfad":"code","d061e2ec":"code","30fa2abf":"code","19a0ca64":"code","16cf8182":"code","17c4b9a1":"code","87ac0af7":"code","6871f663":"code","8db47ed9":"code","6ee87a79":"code","f4e8a471":"code","099e5596":"code","426fccf8":"code","36f2bac3":"code","03ed9792":"code","221704ae":"markdown"},"source":{"a71b9653":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","65ef13cc":"df_train = pd.read_csv('..\/input\/train.csv')\ndf_test = pd.read_csv('..\/input\/test.csv')","23ae34b6":"df_train.head()","e5f6562c":"df_train.shape","0e9a12c6":"df_train.isna().sum()","eb46bfad":"sns.countplot(data=df_train, x='experiment', hue='event')","d061e2ec":"sns.countplot(data=df_train, x='event')","30fa2abf":"plt.figure(figsize=(15, 10))\nsns.violinplot(x='event', y='time', data=df_train.sample(5000))","19a0ca64":"experiments = {'CA': 0, 'DA': 1, 'SS': 2, 'LOFT': 3}\ndf_train[\"experiment\"] = df_train[\"experiment\"].apply(lambda x: experiments[x])\ndf_test[\"experiment\"] = df_test[\"experiment\"].apply(lambda x: experiments[x])","16cf8182":"events = {'A': 0, 'B':1, 'C':2, 'D':3}\ndf_train[\"event\"] = df_train[\"event\"].apply(lambda x: events[x])","17c4b9a1":"from sklearn.model_selection import train_test_split","87ac0af7":"train_data, test_data = train_test_split(df_train, test_size=0.3, random_state=420)","6871f663":"import lightgbm as lgb\nfrom tqdm import tqdm_notebook as tqdm","8db47ed9":"features = [\"crew\", \"seat\", \"eeg_fp1\", \"eeg_f7\", \"eeg_f8\", \"eeg_t4\", \"eeg_t6\", \"eeg_t5\", \"eeg_t3\", \"eeg_fp2\", \"eeg_o1\", \"eeg_p3\", \"eeg_pz\", \"eeg_f3\", \"eeg_fz\", \"eeg_f4\", \"eeg_c4\", \"eeg_p4\", \"eeg_poz\", \"eeg_c3\", \"eeg_cz\", \"eeg_o2\", \"ecg\", \"r\", \"gsr\"]\nparams = {\"objective\" : \"multiclass\",\n              \"num_class\": 4,\n              \"metric\" : \"multi_error\",\n              \"num_leaves\" : 30,\n              \"min_child_weight\" : 50,\n              \"learning_rate\" : 0.1,\n              \"bagging_fraction\" : 0.7,\n              \"feature_fraction\" : 0.7,\n              \"bagging_seed\" : 420,\n              \"verbosity\" : -1\n            }","6ee87a79":"lg_train = lgb.Dataset(train_data[features], label=(train_data[\"event\"]))\nlg_test = lgb.Dataset(test_data[features], label=(test_data[\"event\"]))\nmodel = lgb.train(params, lg_train, 1000, valid_sets=[lg_test], early_stopping_rounds=50, verbose_eval=100)","f4e8a471":"predictions = model.predict(test_data[features], num_iteration=model.best_iteration)","099e5596":"submission = pd.DataFrame(np.concatenate((np.arange(len(test_data))[:, np.newaxis], predictions), axis=1), columns=['id', 'A', 'B', 'C', 'D'])\nsubmission['id'] = submission['id'].astype(int)","426fccf8":"submission.head()","36f2bac3":"submission.to_csv('submission.csv', index=False)","03ed9792":"submission.shape","221704ae":"# Reducing Commercial Aviation Fatalities"}}