{"cell_type":{"58987376":"code","e6f69a0b":"code","6163e493":"code","85535fee":"code","62fa15a3":"code","9a9de290":"code","e6e6c42d":"code","55fe513c":"code","ed0ef4d7":"code","f624d606":"code","ce3158df":"code","10da31d7":"code","1ebef432":"code","1b867812":"code","78af39fe":"code","33ba0578":"code","78bd7ca4":"code","4df9d14a":"code","df732787":"code","123a8c93":"code","4d6f12ca":"code","7d813641":"code","b6e3cf45":"code","32c27f77":"code","20d0cb72":"code","2e93f37b":"code","9814b15b":"code","3b2ffcf6":"code","0db375ab":"code","440a92d1":"code","2b9b40b5":"code","d2eb0650":"code","c8ee7a76":"code","87a04588":"code","8862032d":"code","245878ec":"code","8adea4ad":"code","680f3202":"code","db1f3dbe":"code","ae985ba7":"code","bc023dbb":"code","3426f2cb":"code","29f68f53":"code","95ab28bb":"code","4b7a5506":"code","90afd6a5":"code","1740b9d8":"code","d06dd016":"code","6914347d":"code","9875422a":"code","7b8cb9c5":"code","97c6d833":"code","4e1b3c10":"code","cad59c7e":"code","e8ce350b":"code","804c17cc":"code","2f62376c":"code","14291471":"code","c0a06e73":"code","0fbdc20a":"code","5f375273":"code","b1602140":"code","3f1be90a":"code","7bd12695":"code","5d2878fa":"code","93a72627":"code","c1a669bd":"code","22ccfedd":"code","8570898f":"code","0b2bc70f":"code","b87f367b":"code","b61c688e":"code","535fe098":"markdown","6a03abba":"markdown","a1aec6c3":"markdown","4c098d39":"markdown","c0d03c67":"markdown","a1ad8b6f":"markdown","25824706":"markdown","c0eb2bba":"markdown","f8e8172f":"markdown","f6c56a13":"markdown","8d69a75b":"markdown","e5e8e930":"markdown","0f02e0d8":"markdown","3145875c":"markdown","889c592d":"markdown","2e9c4cb2":"markdown","4055a45a":"markdown","0450324d":"markdown","0b750066":"markdown","5a487b4b":"markdown","359f5b57":"markdown","893b944f":"markdown","0fb9969e":"markdown","6ef4d228":"markdown","bec42fad":"markdown","c064bf16":"markdown","23c4c7b9":"markdown","d898b93a":"markdown","c414bc90":"markdown","e7a53340":"markdown","77f803e1":"markdown"},"source":{"58987376":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport os\nimport warnings\nwarnings.filterwarnings('ignore')","e6f69a0b":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n#df = pd.read_csv('\/kaggle\/input\/heart.csv')","6163e493":"df= pd.read_csv('\/kaggle\/input\/heart-disease-prediction-uci\/heart.csv')","85535fee":"df.head()","62fa15a3":"df.tail()","9a9de290":"df.shape","e6e6c42d":"df.columns","55fe513c":"df.describe()","ed0ef4d7":"df.isnull().sum()","f624d606":"print(df.info())","ce3158df":"plt.figure(figsize=(20,10))\nsns.heatmap(df.corr(), annot=True, cmap='terrain')","10da31d7":"sns.pairplot(data=df)","1ebef432":"df.hist(figsize=(12,12), layout=(5,3));","1b867812":"# box and whiskers plot\ndf.plot(kind='box', subplots=True, layout=(5,3), figsize=(12,12))\nplt.show()","78af39fe":"\nsns.catplot(data=df, x='sex', y='age',  hue='target', palette='husl')","33ba0578":"sns.barplot(data=df, x='sex', y='chol', hue='target', palette='spring')","78bd7ca4":"df['sex'].value_counts()","4df9d14a":"df['target'].value_counts()","df732787":"df['thal'].value_counts()","123a8c93":"sns.countplot(x='sex', data=df, palette='husl', hue='target')","4d6f12ca":"sns.countplot(x='target',palette='BuGn', data=df)","7d813641":"sns.countplot(x='ca',hue='target',data=df)","b6e3cf45":"df['ca'].value_counts()","32c27f77":"sns.countplot(x='thal',data=df, hue='target', palette='BuPu' )","20d0cb72":"sns.countplot(x='thal', hue='sex',data=df, palette='terrain')","2e93f37b":"df['cp'].value_counts()  # chest pain type","9814b15b":"sns.countplot(x='cp' ,hue='target', data=df, palette='rocket')","3b2ffcf6":"sns.countplot(x='cp', hue='sex',data=df, palette='BrBG')","0db375ab":"sns.boxplot(x='sex', y='chol', hue='target', palette='seismic', data=df)","440a92d1":"sns.barplot(x='sex', y='cp', hue='target',data=df, palette='cividis')","2b9b40b5":"sns.barplot(x='sex', y='thal', data=df, hue='target', palette='nipy_spectral')","d2eb0650":"sns.barplot(x='target', y='ca', hue='sex', data=df, palette='mako')","c8ee7a76":"sns.barplot(x='sex', y='oldpeak', hue='target', palette='rainbow', data=df)","87a04588":"df['fbs'].value_counts()","8862032d":"sns.barplot(x='fbs', y='chol', hue='target', data=df,palette='plasma' )","245878ec":"sns.barplot(x='sex',y='target', hue='fbs',data=df)","8adea4ad":"gen = pd.crosstab(df['sex'], df['target'])\nprint(gen)","680f3202":"gen.plot(kind='bar', stacked=True, color=['green','yellow'], grid=False)","db1f3dbe":"temp=pd.crosstab(index=df['sex'],\n            columns=[df['thal']], \n            margins=True)\ntemp","ae985ba7":"temp.plot(kind=\"bar\",stacked=True)\nplt.show()","bc023dbb":"temp=pd.crosstab(index=df['target'],\n            columns=[df['thal']], \n            margins=True)\ntemp","3426f2cb":"temp.plot(kind='bar', stacked=True)\nplt.show()","29f68f53":"chest_pain = pd.crosstab(df['cp'], df['target'])\nchest_pain","95ab28bb":"chest_pain.plot(kind='bar', stacked=True, color=['purple','blue'], grid=False)","4b7a5506":"from sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nStandardScaler = StandardScaler()  \ncolumns_to_scale = ['age','trestbps','chol','thalach','oldpeak']\ndf[columns_to_scale] = StandardScaler.fit_transform(df[columns_to_scale])","90afd6a5":"df.head()","1740b9d8":"X= df.drop(['target'], axis=1)\ny= df['target']","d06dd016":"X_train, X_test,y_train, y_test=train_test_split(X,y,test_size=0.3,random_state=40)","6914347d":"print('X_train-', X_train.size)\nprint('X_test-',X_test.size)\nprint('y_train-', y_train.size)\nprint('y_test-', y_test.size)","9875422a":"from sklearn.linear_model import LogisticRegression\nlr=LogisticRegression()\n\nmodel1=lr.fit(X_train,y_train)\nprediction1=model1.predict(X_test)","7b8cb9c5":"from sklearn.metrics import confusion_matrix\n\ncm=confusion_matrix(y_test,prediction1)\ncm","97c6d833":"sns.heatmap(cm, annot=True,cmap='BuPu')","4e1b3c10":"TP=cm[0][0]\nTN=cm[1][1]\nFN=cm[1][0]\nFP=cm[0][1]\nprint('Testing Accuracy:',(TP+TN)\/(TP+TN+FN+FP))","cad59c7e":"from sklearn.metrics import accuracy_score\naccuracy_score(y_test,prediction1)","e8ce350b":"from sklearn.metrics import classification_report\nprint(classification_report(y_test, prediction1))","804c17cc":"from sklearn.tree import DecisionTreeClassifier\n\ndtc=DecisionTreeClassifier()\nmodel2=dtc.fit(X_train,y_train)\nprediction2=model2.predict(X_test)\ncm2= confusion_matrix(y_test,prediction2)","2f62376c":"cm2","14291471":"accuracy_score(y_test,prediction2)","c0a06e73":"\nprint(classification_report(y_test, prediction2))","0fbdc20a":"from sklearn.ensemble import RandomForestClassifier\n\nrfc=RandomForestClassifier()\nmodel3 = rfc.fit(X_train, y_train)\nprediction3 = model3.predict(X_test)\nconfusion_matrix(y_test, prediction3)","5f375273":"accuracy_score(y_test, prediction3)","b1602140":"\nprint(classification_report(y_test, prediction3))","3f1be90a":"from sklearn.model_selection import KFold\nfrom sklearn.model_selection import cross_val_score","7bd12695":"from sklearn.svm import SVC\n\nsvm=SVC()\nmodel4=svm.fit(X_train,y_train)\nprediction4=model4.predict(X_test)\ncm4= confusion_matrix(y_test,prediction4)","5d2878fa":"cm4","93a72627":"accuracy_score(y_test, prediction4)","c1a669bd":"from sklearn.naive_bayes import GaussianNB\n\nNB = GaussianNB()\nmodel5 = NB.fit(X_train, y_train)\nprediction5 = model5.predict(X_test)\ncm5= confusion_matrix(y_test, prediction5)","22ccfedd":"cm5","8570898f":"accuracy_score(y_test, prediction5)","0b2bc70f":"print('cm4', cm4)\nprint('-----------')\nprint('cm5',cm5)\n","b87f367b":"from sklearn.neighbors import KNeighborsClassifier\n\nKNN = KNeighborsClassifier()\nmodel6 = KNN.fit(X_train, y_train)\nprediction6 = model6.predict(X_test)\ncm6= confusion_matrix(y_test, prediction5)\ncm6","b61c688e":"print('KNN :', accuracy_score(y_test, prediction6))\nprint('lr :', accuracy_score(y_test, prediction1))\nprint('dtc :', accuracy_score(y_test, prediction2))\nprint('rfc :', accuracy_score(y_test, prediction3))\nprint('NB: ', accuracy_score(y_test, prediction4))\nprint('SVC :', accuracy_score(y_test, prediction5))\n","535fe098":"## Load Basic Libraries","6a03abba":"Here 1 means male and 0 denotes female. \nwe observe female having heart disease are comparatively less when compared to males\nMales have low heart diseases as compared to females in the given dataset.","a1aec6c3":"we can see the column names here ","4c098d39":"### fbs(fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false) and chest pain relation","c0d03c67":"##### ca : number of major vessels (0-3) colored by flourosopy","a1ad8b6f":"ca number of major vessels (0-3) colored by flourosopy\nca has a negative corelation with the target i.e when ca will increase we witness a drop in \nheart diseases and vice versa.","25824706":"## followed by NB and Decision tree : 90","c0eb2bba":"## Finding the correlation among the attributes","f8e8172f":"## Best accuracy is given by Logistic Regression : 92\n","f6c56a13":"thal3 = normal; 6 = fixed defect; 7 = reversable defect","8d69a75b":"we observe the count for not having heart disease and having heart disease are almost balanced\nnot having frequency count is 140\nand those having heart disease the count is 160.","e5e8e930":"##### ST depression induced by exercise relative to rest, a measure of abnormality in electrocardiograms","0f02e0d8":"#### 165 cases of heart diseases\nand 138 cases of no heart diseases","3145875c":"## Random Forest","889c592d":"this shows chest pain count experienced by male and female","2e9c4cb2":"## Reading the csv file","4055a45a":"## Decision Tree","0450324d":"Statstical Details\nDescribe provides us with statistical information in  the numerical format.\nwe can infer that in the AGE column the minimum age is 29yrs and maximium is 77yrs \nmean of age is 54yrs.\nThe quartiles details are given in form of 25%, 50% and 75%. The data is divided into 3 quartiles\nor 4 equal parts. so 25% values lie in each group.\nstandard deviation and mean are statistical measures which give us an idea of the central tendency \nof the data set. However , mean is effected by outliers and hence we need more information \nto make accurate decisions.\n\n","0b750066":"we observe the outliers with the help of boxplot. outliers are values that are very small \nor large in the given data set.","5a487b4b":"### Cross Tables","359f5b57":"we observe positive correlation between target and cp, thalach,slope\nand also negative correlation between target and sex, exang,ca,thai,oldpeak","893b944f":"## Exploring the data set in order to derive useful information","0fb9969e":"#### results of thallium stress test measuring blood flow to the heart,\nwith possible values normal, fixed_defect, reversible_defect","6ef4d228":"### Logistic Regression","bec42fad":"# Preparing the data for Model ","c064bf16":"#### 207 males and 96 females","23c4c7b9":"this shows our data has 303 rows and 14 columns","d898b93a":"### Scaling the data","c414bc90":"we notice that the dataset has no null values.\nthis saved us from conveting the null values into some data or dropping then altogether.","e7a53340":"### Check the sample Size","77f803e1":"shows chest pain with respect to heart disease\/ target"}}