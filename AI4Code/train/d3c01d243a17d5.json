{"cell_type":{"fad84b8f":"code","d0ce2dc7":"code","52641696":"code","c912fc19":"code","24ef7239":"code","c7a00f89":"code","a54b1a54":"code","5475c6c2":"code","5d69eb1a":"code","b6c47a0b":"code","1823887c":"code","bd8d1f6e":"code","00f9b024":"code","44c91911":"markdown"},"source":{"fad84b8f":"from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegressionCV\nfrom sklearn.metrics import roc_auc_score\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport numpy as np ","d0ce2dc7":"submission = pd.read_csv(\"\/kaggle\/input\/cat-in-the-dat\/sample_submission.csv\")\ntrain = pd.read_csv(\"\/kaggle\/input\/cat-in-the-dat\/train.csv\")\ntest = pd.read_csv(\"\/kaggle\/input\/cat-in-the-dat\/test.csv\")\n\nlabels = train.pop('target')\nlabels = labels.values\ntrain_id = train.pop(\"id\")\ntest_id = test.pop(\"id\")","52641696":"train.head(5)","c912fc19":"data = pd.concat([train, test])\ndata[\"ord_5a\"] = data[\"ord_5\"].str[0]\ndata[\"ord_5b\"] = data[\"ord_5\"].str[1]\ndata.drop([\"bin_0\", \"ord_5\"], axis=1, inplace=True)","24ef7239":"columns = [i for i in data.columns]\n\ndummies = pd.get_dummies(data,\n                         columns=columns,\n                         drop_first=True,\n                         sparse=True)\n\ndel data","c7a00f89":"train = dummies.iloc[:train.shape[0], :]\ntest = dummies.iloc[train.shape[0]:, :]\n\ndel dummies","a54b1a54":"train = train.fillna(0)\ntrain.head(5)","5475c6c2":"print(train.shape)\nprint(test.shape)","5d69eb1a":"train = train.sparse.to_coo().tocsr()\ntest = test.sparse.to_coo().tocsr()","b6c47a0b":"lr_cv = LogisticRegressionCV(Cs=7,\n                        solver=\"lbfgs\",\n                        tol=0.0002,\n                        max_iter=10000,\n                        cv=5)\n\nlr_cv.fit(train, labels)\n\nlr_cv_pred = lr_cv.predict_proba(train)[:, 1]\nscore = roc_auc_score(labels, lr_cv_pred)\n\nprint(\"score: \", score)","1823887c":"submission[\"id\"] = test_id\nsubmission[\"target\"] = lr_cv.predict_proba(test)[:, 1]","bd8d1f6e":"submission.head()","00f9b024":"submission.to_csv(\"submission_lr_cv.csv\", index=False)","44c91911":"## The kernel basic on the kernel [Logistic Regression](https:\/\/www.kaggle.com\/martin1234567890\/logistic-regression)"}}