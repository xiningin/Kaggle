{"cell_type":{"0715386d":"code","7252a82d":"code","e003651a":"code","4a8f2f1a":"code","47a80d1e":"code","c554dfd2":"code","ad836736":"code","609b6ac1":"code","0ce1ef4b":"code","d6a421dc":"code","7d9933ba":"code","6e411787":"code","e9637916":"code","232eab52":"code","cfa5cddc":"code","fbd7f297":"code","869ed7ee":"code","5b544d95":"code","f382ae97":"code","9716edd0":"code","882daa10":"code","077f466f":"code","ec5e22e3":"code","5e19abf2":"code","62385253":"code","874c5512":"code","b94949f6":"code","ed48db56":"code","06c9a898":"code","eb1ed988":"code","f7e264da":"code","7e89d665":"code","46db0c57":"markdown","e05b94fa":"markdown","826d91de":"markdown","86294327":"markdown","984a5f27":"markdown","f52ed5fc":"markdown","3dda0eed":"markdown","ea350aba":"markdown","f95e5cc6":"markdown","f1471a27":"markdown","a908b39d":"markdown","8981c0a6":"markdown"},"source":{"0715386d":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport plotly\nimport plotly.express as ex\nimport plotly.graph_objs as go\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport geopandas as gpd\nimport geopy\nfrom geopy.geocoders import Nominatim\nfrom geopy.extra.rate_limiter import RateLimiter\nimport tqdm\nfrom tqdm.notebook import *","7252a82d":"data=pd.read_csv('..\/input\/automobile-telematics-dataset\/Telematicsdata.csv')","e003651a":"data.info()","4a8f2f1a":"data.shape","47a80d1e":"data.head()","c554dfd2":"### Subset for position data\nposition=data[data['variable']=='POSITION']","ad836736":"position['deviceId'].unique()","609b6ac1":"position.isna().sum()","0ce1ef4b":"position.shape","d6a421dc":"## Device id = zRYzhAEAHAABAAAKCRtcAAsAtwB1gBAQ\npos_d1=position[position['deviceId']=='zRYzhAEAHAABAAAKCRtcAAsAtwB1gBAQ']\npos_d2=position[position['deviceId']=='zRYzhAEAHAABAAAKCRtcAAsANAB0gBAQ']\npos_d3=position[position['deviceId']=='zRYzhAEAHAABAAAKCRtcAAsAGAB0gBAQ']","7d9933ba":"print(pos_d1.shape)\nprint(pos_d2.shape)\nprint(pos_d3.shape)","6e411787":"pos_d1.sort_values(by='timestamp',ascending=False,inplace=True)\npos_d2.sort_values(by='timestamp',ascending=False,inplace=True)\npos_d3.sort_values(by='timestamp',ascending=False,inplace=True)","e9637916":"pos_d1['timestamp']=pd.to_datetime(pos_d1['timestamp'])\npos_d2['timestamp']=pd.to_datetime(pos_d2['timestamp'])\npos_d3['timestamp']=pd.to_datetime(pos_d3['timestamp'])","232eab52":"pos_d1['day']=pos_d1['timestamp'].dt.day\npos_d1['month']=pos_d1['timestamp'].dt.month\npos_d1['year']=pos_d1['timestamp'].dt.year\n\npos_d2['day']=pos_d2['timestamp'].dt.day\npos_d2['month']=pos_d2['timestamp'].dt.month\npos_d2['year']=pos_d2['timestamp'].dt.year\n\npos_d3['day']=pos_d3['timestamp'].dt.day\npos_d3['month']=pos_d3['timestamp'].dt.month\npos_d3['year']=pos_d3['timestamp'].dt.year","cfa5cddc":"pos_d1.reset_index(drop=True,inplace=True)\npos_d2.reset_index(drop=True,inplace=True)\npos_d3.reset_index(drop=True,inplace=True)","fbd7f297":"temp=pos_d1['value'].str.split(',',expand=True)\ntemp1=pos_d2['value'].str.split(',',expand=True)\ntemp2=pos_d3['value'].str.split(',',expand=True)","869ed7ee":"temp.rename({0:'start_lat',1:'start_long',2:'start_elevation'},axis=1,inplace=True)\ntemp.reset_index(drop=True,inplace=True)\n\ntemp1.rename({0:'start_lat',1:'start_long',2:'start_elevation'},axis=1,inplace=True)\ntemp1.reset_index(drop=True,inplace=True)\n\ntemp2.rename({0:'start_lat',1:'start_long',2:'start_elevation'},axis=1,inplace=True)\ntemp2.reset_index(drop=True,inplace=True)","5b544d95":"pos_d1=pd.concat([pos_d1,temp],axis=1)\npos_d2=pd.concat([pos_d2,temp1],axis=1)\npos_d3=pd.concat([pos_d3,temp2],axis=1)","f382ae97":"print(pos_d1.shape)\nprint(pos_d2.shape)\nprint(pos_d3.shape)","9716edd0":"pos_d1['start_lat']=pos_d1['start_lat'].astype(float)\npos_d1['start_long']=pos_d1['start_long'].astype(float)\npos_d1['start_elevation']=pos_d1['start_elevation'].astype(float)\n\npos_d2['start_lat']=pos_d2['start_lat'].astype(float)\npos_d2['start_long']=pos_d2['start_long'].astype(float)\npos_d2['start_elevation']=pos_d2['start_elevation'].astype(float)\n\npos_d3['start_lat']=pos_d3['start_lat'].astype(float)\npos_d3['start_long']=pos_d3['start_long'].astype(float)\npos_d3['start_elevation']=pos_d3['start_elevation'].astype(float)","882daa10":"pos_d1['geom'] = pos_d1['start_lat'].map(str) +\",\" + pos_d1['start_long'].map(str)\npos_d2['geom'] = pos_d2['start_lat'].map(str) +\",\" + pos_d2['start_long'].map(str)\npos_d3['geom'] = pos_d3['start_lat'].map(str) +\",\" + pos_d3['start_long'].map(str)","077f466f":"fig=ex.scatter_mapbox(pos_d1, lat=pos_d1['start_lat'], lon=pos_d1['start_long'],hover_data=['timestamp','day','month'],color=pos_d1['day'], zoom=4,opacity=1,size_max=30,title='Location tagging', width=1200,height=800,template=\"plotly_dark\")\nfig.update_layout(mapbox_style=\"open-street-map\")\nfig.update_layout(margin={\"r\":0,\"t\":0,\"l\":0,\"b\":0})\nfig.show()","ec5e22e3":"fig=ex.scatter_mapbox(pos_d2, lat=pos_d2['start_lat'], lon=pos_d2['start_long'],hover_data=['timestamp','day','month'],color=pos_d2['day'], zoom=4,opacity=1,size_max=30,title='Location tagging', width=1200,height=800)\nfig.update_layout(mapbox_style=\"open-street-map\")\nfig.update_layout(margin={\"r\":0,\"t\":0,\"l\":0,\"b\":0})\nfig.show()","5e19abf2":"fig=ex.scatter_mapbox(pos_d3, lat=pos_d3['start_lat'], lon=pos_d3['start_long'],hover_data=['timestamp','day','month'],color=pos_d3['day'], zoom=4,opacity=1,size_max=30,title='Location tagging', width=1000,height=800)\nfig.update_layout(mapbox_style=\"open-street-map\")\nfig.update_layout(margin={\"r\":0,\"t\":0,\"l\":0,\"b\":0})\nfig.show()","62385253":"data['timestamp']=pd.to_datetime(data['timestamp'])","874c5512":"data['day']=data['timestamp'].dt.day","b94949f6":"t1=data.groupby(['deviceId','variable','day'])['deviceId'].count()\nt1=t1.to_frame(name='count')\nt1.reset_index(inplace=True)","ed48db56":"## By alaram Class\ndv=data.groupby(['deviceId','variable','alarmClass','day','value'])['value'].count()\ndv=dv.to_frame(name='count')\ndv.reset_index(inplace=True)","06c9a898":"ex.scatter(data_frame=dv[(dv['deviceId']=='zRYzhAEAHAABAAAKCRtcAAsAtwB1gBAQ') & (dv['variable']=='ACCELERATION Z')],x='alarmClass',y='value',facet_col='day',hover_name='count',title='Acc Z - Alarm class wise distribution',template=\"ggplot2\")","eb1ed988":"ex.scatter(data_frame=dv[(dv['deviceId']=='zRYzhAEAHAABAAAKCRtcAAsAtwB1gBAQ') & (dv['variable']=='ACCELERATION Y')],x='alarmClass',y='value',facet_col='day',hover_name='count',title='Acc Y - Alarm class wise distribution',template=\"ggplot2\")","f7e264da":"ex.scatter(data_frame=dv[(dv['deviceId']=='zRYzhAEAHAABAAAKCRtcAAsAtwB1gBAQ') & (dv['variable']=='ACCELERATION X')],x='alarmClass',y='value',facet_col='day',hover_name='count',title='Acc X - Alarm class wise distribution',template=\"ggplot2\")","7e89d665":"ex.scatter(data_frame=dv[(dv['deviceId']=='zRYzhAEAHAABAAAKCRtcAAsAtwB1gBAQ') & (dv['variable']=='Vehicle speed')],x='alarmClass',y='value',facet_col='day',hover_name='count',title='Vehicle Speed - Alarm class wise distribution',template=\"ggplot2\")","46db0c57":"<h1 style=\"font-family: Verdana; font-size: 24px; font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; letter-spacing: 3px; background-color: #ffffff; color: navy;\">Separate Device values&nbsp;&nbsp;&nbsp;&nbsp;<\/h1>","e05b94fa":"<h1 style=\"font-family: Verdana; font-size: 15px; font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; letter-spacing: 3px; background-color: #ffffff; color: red;\">Vehicle Speed&nbsp;&nbsp;&nbsp;&nbsp;<\/h1>","826d91de":"<h1 style=\"font-family: Verdana; font-size: 24px; font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; letter-spacing: 3px; background-color: #ffffff; color: navy;\">Split Lat , Long and Elevation from Position values&nbsp;&nbsp;&nbsp;&nbsp;<\/h1>","86294327":"<br>\n<h1 style = \"font-size:40px; font-family:Garamond ; font-weight : normal; background-color: #f6f5f5 ; color : #fe346e; text-align: center; border-radius: 100px 100px;\">Telematics : Device Tracking<\/h1>\n<br>\n\n<h1 style=\"font-family: Verdana; font-size: 24px; font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; letter-spacing: 3px; background-color: #ffffff; color: navy;\">Introduction&nbsp;&nbsp;&nbsp;&nbsp;<\/h1> \n\nFor automobile insurers, telematics represents a growing and valuable way to quantify driver risk. Instead of pricing decisions on vehicle and driver characteristics, telematics gives the opportunity to measure the quantity and quality of a driver's behavior. This can lead to savings for safe or infrequent drivers, and transition the burden to policies that represent increased liability.\n\nThe intent to understand this is whether a driver drive long trips? Short trips? Highway trips? Back roads? Do they accelerate hard from stops? Do they take turns at high speed? The answers to these questions combine to form an aggregate profile that potentially makes each driver unique.\n","984a5f27":"<h1 style=\"font-family: Verdana; font-size: 24px; font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; letter-spacing: 3px; background-color: #ffffff; color: navy;\">Import libraries&nbsp;&nbsp;&nbsp;&nbsp;<\/h1> ","f52ed5fc":"<h1 style=\"font-family: Verdana; font-size: 24px; font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; letter-spacing: 3px; background-color: #ffffff; color: navy;\">Separate Position values&nbsp;&nbsp;&nbsp;&nbsp;<\/h1>","3dda0eed":"<h1 style=\"font-family: Verdana; font-size: 24px; font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; letter-spacing: 3px; background-color: #ffffff; color: navy;\">Analzing the sensors&nbsp;&nbsp;&nbsp;&nbsp;<\/h1>","ea350aba":"<h1 style=\"font-family: Verdana; font-size: 15px; font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; letter-spacing: 3px; background-color: #ffffff; color: red;\">Accelerometer-Z&nbsp;&nbsp;&nbsp;&nbsp;<\/h1>","f95e5cc6":"<h1 style=\"font-family: Verdana; font-size: 24px; font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; letter-spacing: 3px; background-color: #ffffff; color: navy;\">Scatter Mapbox - Zoom in the map&nbsp;&nbsp;&nbsp;&nbsp;<\/h1>","f1471a27":"<h1 style=\"font-family: Verdana; font-size: 15px; font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; letter-spacing: 3px; background-color: #ffffff; color: red;\">Accelerometer-Y&nbsp;&nbsp;&nbsp;&nbsp;<\/h1>","a908b39d":"<h1 style=\"font-family: Verdana; font-size: 24px; font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; letter-spacing: 3px; background-color: #ffffff; color: navy;\">Read Data&nbsp;&nbsp;&nbsp;&nbsp;<\/h1> ","8981c0a6":"<h1 style=\"font-family: Verdana; font-size: 15px; font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; letter-spacing: 3px; background-color: #ffffff; color: red;\">Accelerometer-X&nbsp;&nbsp;&nbsp;&nbsp;<\/h1>"}}