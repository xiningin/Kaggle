{"cell_type":{"dc15d393":"code","a6448280":"code","af217ecc":"code","dfe7d6a9":"code","ae48ed89":"code","628eb448":"code","5775f0e9":"code","a8bb0ba8":"code","e68cd616":"code","b46db1a5":"code","c3c7c817":"code","b12f36de":"code","f2987759":"code","8fa7dd5c":"code","6ff1cf66":"code","94e8fcc9":"code","764af263":"code","484ac295":"code","51146906":"code","c629907e":"code","71bc2e77":"code","261daa10":"code","7bd6f9d6":"code","90b09f93":"code","ec64e36f":"code","5c9d23ac":"code","9255c30c":"code","a94157f5":"code","9b197be9":"code","37d6f8d0":"code","7fa233ff":"code","50f96246":"code","8ac8d256":"code","022bb03a":"code","353c562f":"code","beaea24d":"code","929cf2aa":"code","26f66750":"code","bad1d4b7":"code","587949bb":"code","805fd4aa":"code","a99c185b":"code","272faa18":"code","d2dac078":"code","625efd0e":"code","a85f00c0":"code","f5bf5065":"markdown","9cd1d246":"markdown","fe68f307":"markdown","0842002f":"markdown","69b2d1da":"markdown","2934b7ef":"markdown","39920293":"markdown","a5f68d0b":"markdown","54a337fc":"markdown","526210e7":"markdown","17254af7":"markdown","99dd23d7":"markdown","875e16c1":"markdown","3717cc97":"markdown","09fc7a95":"markdown","352b0507":"markdown","4361a461":"markdown","b66a057a":"markdown","79f40a0c":"markdown","0e4d0515":"markdown","6552f3a2":"markdown","09c18a7a":"markdown","bc082471":"markdown","34092c7d":"markdown","f91b2bff":"markdown","c290bc39":"markdown","b9aa4dfd":"markdown","ad11b60a":"markdown","73bd6d68":"markdown","572003a7":"markdown","d6eed3a6":"markdown","b78924c4":"markdown","d17871f0":"markdown"},"source":{"dc15d393":"! pip install -q dabl","a6448280":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nfrom colorama import Fore, Style\n\nimport dabl\n\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.gaussian_process import GaussianProcessClassifier\nfrom sklearn.gaussian_process.kernels import RBF\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.discriminant_analysis import QuadraticDiscriminantAnalysis\nfrom sklearn.metrics import roc_auc_score\nfrom sklearn.preprocessing import StandardScaler\n\nplt.style.use(\"classic\")\nwarnings.filterwarnings('ignore')","af217ecc":"def cout(string: str, color=Fore.RED):\n    \"\"\"\n    Saves some work \ud83d\ude05\n    \"\"\"\n    print(color+string+Style.RESET_ALL)","dfe7d6a9":"def statistics(dataframe, column):\n    cout(f\"The Average value in {column} is: {dataframe[column].mean():.2f}\", Fore.RED)\n    cout(f\"The Maximum value in {column} is: {dataframe[column].max()}\", Fore.BLUE)\n    cout(f\"The Minimum value in {column} is: {dataframe[column].min()}\", Fore.YELLOW)\n    cout(f\"The 25th Quantile of {column} is: {dataframe[column].quantile(0.25)}\", Fore.GREEN)\n    cout(f\"The 50th Quantile of {column} is: {dataframe[column].quantile(0.50)}\", Fore.CYAN)\n    cout(f\"The 75th Quantile of {column} is: {dataframe[column].quantile(0.75)}\", Fore.MAGENTA)","ae48ed89":"data = pd.read_csv(\"..\/input\/health-care-data-set-on-heart-attack-possibility\/heart.csv\")\ndata.head()","628eb448":"data.isna().sum()","5775f0e9":"# Print Age Column Statistics\nstatistics(data, 'age')","a8bb0ba8":"# Let's plot the age column too\nplt.style.use(\"classic\")\nsns.distplot(data['age'], color='blue')\nplt.title(f\"Age Distribution [\\u03BC : {data['age'].mean():.2f} years | \\u03C3 : {data['age'].std():.2f} years]\")\nplt.xlabel(\"Age\")\nplt.ylabel(\"Count\")\nplt.show()","e68cd616":"statistics(data, 'sex')","b46db1a5":"# Pie Chart\nplt.style.use(\"classic\")\nplt.figure(figsize=(10, 8))\ntarget = [len(data[data['sex'] == 0]), len(data[data['sex'] == 1])]\nlabels = [\"Female\", \"Male\"]\nplt.pie(x=target, labels=labels, autopct='%1.2f%%')\nplt.title(\"Gender Values Distribution\")\nplt.show()","c3c7c817":"statistics(data, \"cp\")","b12f36de":"# Count Plot\nplt.style.use(\"classic\")\nplt.figure(figsize=(10, 8))\nsns.countplot(data['cp'])\nplt.xlabel(\"Chest Pain Severity Type\")\nplt.ylabel(\"Count\")\nplt.title(\"Chest Pain Severity Count Plot\")\nplt.show()","f2987759":"statistics(data, 'trestbps')","8fa7dd5c":"# Dist plot of Resting Blood Pressure\nplt.style.use(\"classic\")\nsns.distplot(data['trestbps'], color='green')\nplt.title(f\"Resting BP Count [\\u03BC : {data['trestbps'].mean():.2f} mmHg | \\u03C3 : {data['trestbps'].std():.2f} mmHg]\")\nplt.xlabel(\"Resting Blood Pressure (in mmHg)\")\nplt.ylabel(\"Count\")\nplt.show()","6ff1cf66":"statistics(data, \"chol\")","94e8fcc9":"# Dist plot of Resting Blood Pressure\nplt.style.use(\"classic\")\nsns.distplot(data['chol'], color='red')\nplt.title(f\"Serum Cholestrol Count [\\u03BC : {data['chol'].mean():.2f} mg\/dl | \\u03C3 : {data['chol'].std():.2f} mg\/dl]\")\nplt.xlabel(\"Serum Cholestrol (in mg\/dl)\")\nplt.ylabel(\"Count\")\nplt.show()","764af263":"statistics(data, \"fbs\")","484ac295":"# Pie Chart\nplt.style.use(\"fivethirtyeight\")\nplt.figure(figsize=(10, 8))\ntarget = [len(data[data['fbs'] == 0]), len(data[data['fbs'] == 1])]\nlabels = [\"Less than 120 mg\/dl\", \"Greater than 120 mg\/dl\"]\nplt.pie(x=target, labels=labels, autopct='%1.2f%%', explode=[0, 0.1])\nplt.title(\"FBS Values Distribution\")\nplt.show()","51146906":"statistics(data, \"restecg\")","c629907e":"# Count Plot\nplt.style.use(\"ggplot\")\nplt.figure(figsize=(10, 8))\nsns.countplot(data['restecg'])\nplt.xlabel(\"Resting ECG Type\")\nplt.ylabel(\"Count\")\nplt.title(\"Resting ECG Results\")\nplt.show()","71bc2e77":"statistics(data, \"thalach\")","261daa10":"# Dist plot of Resting Blood Pressure\nplt.style.use(\"classic\")\nsns.distplot(data['thalach'], color='black')\nplt.title(f\"Maximum Heart Rate [\\u03BC : {data['thalach'].mean():.2f} bpm | \\u03C3 : {data['thalach'].std():.2f} bpm]\")\nplt.xlabel(\"Maximum Heart Rate Achieved (in bpm)\")\nplt.ylabel(\"Count\")\nplt.show()","7bd6f9d6":"statistics(data, \"exang\")","90b09f93":"# Pie Chart\nplt.style.use(\"ggplot\")\nplt.figure(figsize=(10, 8))\ntarget = [len(data[data['exang'] == 0]), len(data[data['exang'] == 1])]\nlabels = [\"0\", \"1\"]\nplt.pie(x=target, labels=labels, autopct='%1.2f%%', explode=[0, 0.05])\nplt.title(\"Exercise Induced Angina Values Distribution\")\nplt.show()","ec64e36f":"statistics(data, \"oldpeak\")","5c9d23ac":"# Dist plot of Resting Blood Pressure\nplt.style.use(\"seaborn-dark\")\nsns.distplot(data['oldpeak'], color='orange')\nplt.title(f\"ST Depression [ \\u03BC : {data['oldpeak'].mean():.2f} | \\u03C3 : {data['oldpeak'].std():.2f} ]\")\nplt.xlabel(\"ST Depression Induced by Exercise\")\nplt.ylabel(\"Count\")\nplt.show()","9255c30c":"statistics(data, \"slope\")","a94157f5":"# Count Plot\nplt.style.use(\"classic\")\nplt.figure(figsize=(10, 8))\nsns.countplot(data['slope'])\nplt.xlabel(\"Slope\")\nplt.ylabel(\"Count\")\nplt.title(\"Slope of Peak Exercise\")\nplt.show()","9b197be9":"statistics(data, \"ca\")","37d6f8d0":"# Count Plot\nplt.style.use(\"fivethirtyeight\")\nplt.figure(figsize=(10, 8))\nsns.countplot(data['ca'])\nplt.xlabel(\"Major Vessels\")\nplt.ylabel(\"Count\")\nplt.title(\"Number of Major Vessels colored by flouropsy\")\nplt.show()","7fa233ff":"statistics(data, \"thal\")","50f96246":"# Count Plot\nplt.style.use(\"ggplot\")\nplt.figure(figsize=(10, 8))\nsns.countplot(data['thal'])\nplt.xlabel(\"Type of Defect\")\nplt.ylabel(\"Count\")\nplt.title(\"Type of Defect count\")\nplt.show()","8ac8d256":"statistics(data, \"target\")","022bb03a":"# Pie Chart\nplt.style.use(\"fivethirtyeight\")\nplt.figure(figsize=(10, 8))\ntarget = [len(data[data['target'] == 0]), len(data[data['target'] == 1])]\nlabels = [\"Less Chances\", \"High Chances\"]\nplt.pie(x=target, labels=labels, autopct='%1.2f%%', explode=[0, 0])\nplt.title(\"Chances of Heart Attack - Target\")\nplt.show()","353c562f":"plt.style.use(\"classic\")\nplt.figure(figsize=(18, 9))\nsns.violinplot(data['sex'], data['age'], palette='Dark2')\nplt.title(\"Age v\/s Sex\")\nplt.xlabel(\"Gender (0-Female, 1-Male)\")\nplt.ylabel(\"Age\")\nplt.show()","beaea24d":"plt.style.use(\"ggplot\")\nplt.figure(figsize=(18, 9))\nsns.boxplot(data['cp'], data['age'])\nplt.title(\"Age v\/s Chest Pain Type\")\nplt.xlabel(\"Chest Pain type\")\nplt.ylabel(\"Age\")\nplt.show()","929cf2aa":"plt.style.use(\"fivethirtyeight\")\nplt.figure(figsize=(18, 9))\nsns.swarmplot(data['cp'], data['chol'])\nplt.title(\"Serum Cholestrol v\/s Chest Pain Type\")\nplt.xlabel(\"Chest Pain type\")\nplt.ylabel(\"Serum Cholestrol (in mg\/dl)\")\nplt.show()","26f66750":"plt.figure(figsize=(10, 6))\nsns.set(style='ticks')\nscatter_data = data[[\"trestbps\", \"thalach\", \"target\"]]\nsns.pairplot(scatter_data)\nplt.show()","bad1d4b7":"plt.figure(figsize=(16, 9))\nsns.pairplot(data.corr())\nplt.show()","587949bb":"plt.figure(figsize=(12, 9))\nsns.heatmap(data.corr(), annot=True)\nplt.title(\"Correlation Heatmap\", fontsize=25)\nplt.show()","805fd4aa":"# Split the data into training and testing sets\nsplit_pcent = 0.15\nsplit = int(len(data) * split_pcent)\n\ndata = data.sample(frac=1)\n\ntrain = data[split:]\ntest = data[:split]\n\ntrainX = train.drop(['target'], axis=1)\ntrainY = train['target']\n\ntestX = test.drop(['target'], axis=1)\ntestY = test['target']\n\ncout(f\"Training Data Shape is: {train.shape}\", Fore.RED)\ncout(f\"Testing Data Shape is: {test.shape}\", Fore.BLUE)","a99c185b":"# Standard Scaling the Data\nsc = StandardScaler()\ntrainX = sc.fit_transform(trainX)\ntestX = sc.transform(testX)","272faa18":"# Define all the classifiers we will be using\nnames = [\"Logistic Regression\", \"Nearest Neighbors\", \"Linear SVM\", \"RBF SVM\", \"Gaussian Process\",\n         \"Decision Tree\", \"Random Forest\", \"Neural Net\", \"AdaBoost\",\n         \"Naive Bayes\", \"QDA\"]\n\nclassifiers = [\n    LogisticRegression(),\n    KNeighborsClassifier(3),\n    SVC(kernel=\"linear\", C=0.025),\n    SVC(gamma=2, C=1),\n    GaussianProcessClassifier(1.0 * RBF(1.0)),\n    DecisionTreeClassifier(max_depth=5),\n    RandomForestClassifier(max_depth=5, n_estimators=10, max_features=1),\n    MLPClassifier(alpha=1, max_iter=1000),\n    AdaBoostClassifier(),\n    GaussianNB(),\n    QuadraticDiscriminantAnalysis()\n]","d2dac078":"clf_results_roc = {}\nclf_results_acc = {}\n\nfor name, clf in zip(names, classifiers):    \n    # Fit on the traning data\n    clf.fit(trainX, trainY)\n    \n    # Get the test time prediction\n    preds = clf.predict(testX)\n    \n    # Calculate Test ROC_AUC\n    score = roc_auc_score(testY, preds)\n    \n    # Calculate the val accuracy\n    val_acc = clf.score(testX, testY)\n    \n    # Store the results in a dictionary\n    clf_results_roc[name] = score\n    clf_results_acc[name] = val_acc\n    \n    cout(f\"Classifier: {name}\", Fore.YELLOW)\n    cout(f\"\\nval_acc: {val_acc:.2f} | roc_auc: {score:.2f}\\n\", Fore.BLUE)","625efd0e":"# Sort the Model Accuracies based on the test score\nsort_clf = dict(sorted(clf_results_acc.items(), key=lambda x: x[1], reverse=True))\n\n# Get the names and the corresponding scores\nclf_names = list(sort_clf.keys())[::-1]\nclf_scores = list(sort_clf.values())[::-1]\n\n# Plot the results\nplt.style.use(\"fivethirtyeight\")\nplt.figure(figsize=(14, 8))\nsns.barplot(x=clf_names, y=clf_scores)\nplt.xlabel(\"Models\")\nplt.ylabel(\"Validation Accuracy\")\nplt.xticks(rotation=45)\nplt.title(\"Model Comparison - Validation Accuracy\")\nplt.show()","a85f00c0":"# Sort the Model Accuracies based on the roc-auc score\nsort_clf = dict(sorted(clf_results_roc.items(), key=lambda x: x[1], reverse=True))\n\n# Get the names and the corresponding scores\nclf_names = list(sort_clf.keys())[::-1]\nclf_scores = list(sort_clf.values())[::-1]\n\n# Plot the results\nplt.style.use(\"fivethirtyeight\")\nplt.figure(figsize=(14, 8))\nsns.barplot(x=clf_names, y=clf_scores)\nplt.xlabel(\"Models\")\nplt.ylabel(\"ROC-AUC Score\")\nplt.xticks(rotation=45)\nplt.title(\"Model Comparison - ROC-AUC Scores\")\nplt.show()","f5bf5065":"## Age\nLet's start with `Age` column.","9cd1d246":"## Number of Major Vessels colored by flouropsy - ca\nThis feature too is discrete.","fe68f307":"## ST Depression Induced by Excercise - oldpeak\nThis feature is continuous","0842002f":"## Serum Cholestrol - chol\nThis feature too is continuous in nature. It's measured in mg\/dl","69b2d1da":"## Sex\n`Sex` column has only 2 possible values in this dataset: `1` - `Male` and `0` - `Female`, so it can be visualized easily using a pie chart.\n\nNo point in doing maximum and minimum statistics in here since the 0 and 1 are not literal values but rather encoded representations of genders.","2934b7ef":"# Introduction and Imports","39920293":"## Resting Blood Pressure - trestbps\nThis feature has values that are continuous, ie; non-discrete in nature.","a5f68d0b":"# Modelling\nFinally, let's fit different classifiers on our data and compare the results!","54a337fc":"### Model Comparison based on ROC-AUC Value\nLet's finally compare all the models based on their ROC-AUC scores","526210e7":"## Fasting Blood Sugar - fbs\nThis feature has only 2 unique values - `1` if FBS is > 120 mg\/dl otherwise `0`","17254af7":"## Correlation Heatmap of Data Features","99dd23d7":"## Age v\/s Chest pain type\nLet's see if age has anything serious to do with chest pain type","875e16c1":"# Data Preprocessing\nLet's pre-process the data and get it ready for modelling.","3717cc97":"## Age v\/s Sex\nLet's see how Age is related to Sex","09fc7a95":"## Slope of the peak exercise - slope\nThis feature has discrete values","352b0507":"As we can see, the data is almost balanced on both sides.","4361a461":"Here's some information about what each column actually means:\n1. Age\n2. Sex (1-Male, 0-Female)\n3. Chest pain type (4 values) - **cp**\n4. Resting blood pressure - **trestbps**\n5. Serum cholestoral in mg\/dl - **chol**\n6. Fasting blood sugar > 120 mg\/dl - **fbs**\n7. Resting electrocardiographic results (values 0,1,2) - **restecg**\n8. Maximum heart rate achieved - **thalach**\n9. Exercise induced angina - **exang**\n10. ST depression induced by exercise relative to rest - **oldpeak**\n11. The slope of the peak exercise ST segment - **slope**\n12. Number of major vessels (0-3) colored by flourosopy - **ca**\n13. 0 = normal; 1 = fixed defect; 2 = reversable defect - **thal**\n14. 0 = less chance of heart attack 1= more chance of heart attack - **target**","b66a057a":"# Basic Exploratory Data Analysis\nWe will proceed through every column and do some basic EDA on it.","79f40a0c":"## Cholestrol vs Chest Pain Type\nLet's see if cholestrol has anything to do with chest pain type.","0e4d0515":"# Advanced Exploratory Data Analysis\nLet's take a look at how different features affect each other.\n\n*Note: I am doing Advanced EDA only on the pair of features that I think will be interesting to see. If you were to do it on every possible pair, you can imagine how many combinations there would be (`>91` plots \ud83d\ude05) and it won't be super cool to see every plot!*","6552f3a2":"## Chest Pain Type - cp\nThis feature defines the chest pain severity in scale of 0-4","09c18a7a":"## thal\nThis feature again is discrete -> `0`- Normal, `1` - Fixed defect, `2` - Reversible defect. ","bc082471":"### Model Comparison based on Validation Accuracy\nNow that the training is over, let's compare all the models based on their validation (test-time) accuracy","34092c7d":"## Maximum Heart Rate Achieved - thalach\nThis feature is a continuous one.","f91b2bff":"## Target\nThis is the target variable we want to predict. It has 2 possible values -> `0` - Less chance of Heart attack and `1` - More chance of heart attack.","c290bc39":"## Pairplot of the Dataset","b9aa4dfd":"## Resting Electrocardiographic Results - restecg\nThis feature has 3 possible values: `1`, `2`, `3`.","ad11b60a":"**Please consider giving this notebook an upvote if it was good as it helps me work harder and publish more quality notebooks.**","73bd6d68":"# Thank you!\n\nPlease correct me if I\u2019ve made any mistakes in EDA, modelling or maybe explaining some concept since I am a beginner and prone to making mistakes.","572003a7":"## Resting BPS v\/s Maximum Heart Rate v\/s Target\nLet's draw up an scatter plot matrix to see combined relationship between resting bps, maximum heart rate and target (chance of heart attack) ","d6eed3a6":"Let's check if the data has any Null values beforehand.","b78924c4":"### Model training loop","d17871f0":"## Exercise Induced Angina - exang\nThis feature is discrete and has 2 unique values - `1` and `0`."}}