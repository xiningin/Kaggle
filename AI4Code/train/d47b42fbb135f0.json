{"cell_type":{"c454d11d":"code","816a2c11":"code","00ed0307":"code","faaadd53":"code","ad0a694e":"code","20f32389":"code","979afa22":"code","101b855d":"code","e72fd181":"code","4bb815e0":"code","7792b8ed":"code","7f95c69e":"code","238a78a1":"code","a93e15bb":"code","4ad0c038":"code","ff5309ba":"code","6592f54c":"code","fd9dcd32":"code","fae2f4a9":"code","8becc51d":"code","75ca72ef":"code","6a9ec5a0":"code","a511b3cf":"code","9214a572":"code","30201e77":"code","f3d324a1":"code","1b40975a":"markdown","f991da7f":"markdown","aac32123":"markdown","765445e1":"markdown","b7272e0f":"markdown","73affd00":"markdown","915b4ad6":"markdown","fee598ab":"markdown","2e114016":"markdown","6bcb28ee":"markdown","1a7bc484":"markdown","38e8a996":"markdown","12ec0af3":"markdown","b452f273":"markdown","8dceef1b":"markdown","b3932b09":"markdown","850b4bcb":"markdown","0ffeded9":"markdown","e1494575":"markdown","c3b21e6b":"markdown","432c3ffe":"markdown","22e64a7f":"markdown","abb2ef89":"markdown","657a26a9":"markdown","9ad583c3":"markdown","0baedaaa":"markdown"},"source":{"c454d11d":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nfrom matplotlib import dates\nfrom datetime import datetime\nimport sklearn\nimport seaborn as sns","816a2c11":"walmart_data = pd.read_csv(\"..\/input\/walmart-dataset-retail\/Walmart_Store_sales.csv\")\nwalmart_data.head()","00ed0307":"# Convert date to datetime format \nwalmart_data['Date'] =  pd.to_datetime(walmart_data['Date'])\nwalmart_data.info()","faaadd53":"walmart_data.isnull().sum()","ad0a694e":"walmart_data[\"Day\"]= pd.DatetimeIndex(walmart_data['Date']).day\nwalmart_data['Month'] = pd.DatetimeIndex(walmart_data['Date']).month\nwalmart_data['Year'] = pd.DatetimeIndex(walmart_data['Date']).year\nwalmart_data","20f32389":"total_sales= walmart_data.groupby('Store')['Weekly_Sales'].sum().sort_values() \ntotal_sales_array = np.array(total_sales)\nplt.figure(figsize=(15,7))\nplt.xticks(rotation=0)\nplt.ticklabel_format(useOffset=False, style='plain', axis='y')\nplt.title('Total sales for each store')\nplt.xlabel('Store')\nplt.ylabel('Total Sales')\ntotal_sales.plot(kind='bar')","979afa22":"walmart_data_std = pd.DataFrame(walmart_data.groupby('Store')['Weekly_Sales'].std().sort_values(ascending=False))\nwalmart_data_std.head(1).index[0] , walmart_data_std.head(1).Weekly_Sales[walmart_data_std.head(1).index[0]]","101b855d":"# Extracting the sales data for store number 14 and plotting its distribution\nplt.figure(figsize=(15,7))\nsns.distplot(walmart_data[walmart_data['Store'] == walmart_data_std.head(1).index[0]]['Weekly_Sales'])\nplt.title('The Sales Distribution of Store No.'+ str(walmart_data_std.head(1).index[0]))\nimport warnings\nwarnings.filterwarnings('ignore')","e72fd181":"#Calculating the coefficient of mean to standard deviation\ncoef = pd.DataFrame(walmart_data.groupby('Store')['Weekly_Sales'].std() \/ walmart_data.groupby('Store')['Weekly_Sales'].mean())\ncoef = coef.rename(columns={'Weekly_Sales':'Coefficient of mean to standard deviation'})\ncoef_max = coef.sort_values(by='Coefficient of mean to standard deviation',ascending=False)\ncoef_max.head(7)","4bb815e0":"# Distribution of store 35 has maximum coefficient of mean to standard deviation\nplt.figure(figsize=(15,7))\nsns.distplot(walmart_data[walmart_data['Store'] == coef_max.head(1).index[0]]['Weekly_Sales'])\nplt.title('The Sales Distribution of Store No.'+str(coef_max.head(1).index[0]))\nimport warnings\nwarnings.filterwarnings('ignore')","7792b8ed":"# Sales for second and third quarter in 2012\nquarter_2_sales = walmart_data[(walmart_data['Date'] >= '2012-04-01') & (walmart_data['Date'] <= '2012-06-30')].groupby('Store')['Weekly_Sales'].sum()\nquarter_3_sales= walmart_data[(walmart_data['Date'] >= '2012-07-01') & (walmart_data['Date'] <= '2012-09-30')].groupby('Store')['Weekly_Sales'].sum()\n\n# Plotting the difference between sales for second and third quarterly\nplt.figure(figsize=(15,7))\nquarter_2_sales.plot(ax=quarter_3_sales.plot(kind ='bar'),kind='bar',color='g',alpha=0.2,legend=True)\nplt.legend([\"Q3' 2012\", \"Q2' 2012\"])","7f95c69e":"#Calculating Growth rate in Q3'2012\nquarter_2_sales= walmart_data[(walmart_data['Date'] >= '2012-04-01') & (walmart_data['Date'] <= '2012-06-30')].groupby('Store')['Weekly_Sales'].sum()\nquarter_3_sales= walmart_data[(walmart_data['Date'] >= '2012-07-01') & (walmart_data['Date'] <= '2012-09-30')].groupby('Store')['Weekly_Sales'].sum()\nquarterly_growth_rate = ((quarter_3_sales - quarter_2_sales )\/quarter_2_sales)*100\nquarterly_growth_rate.sort_values(ascending=False).head()\n","238a78a1":"plt.figure(figsize=(15,7))\nquarterly_growth_rate.sort_values(ascending=False).plot(kind='bar')","a93e15bb":"#Defining holiday dates\nSuper_Bowl =['12-2-2010', '11-2-2011', '10-2-2012']\nLabour_Day =  ['10-9-2010', '9-9-2011', '7-9-2012']\nThanksgiving =  ['26-11-2010', '25-11-2011', '23-11-2012']\nChristmas = ['31-12-2010', '30-12-2011', '28-12-2012']","4ad0c038":"#Calculating mean sales on holidays : \nSuper_Bowl_Sales = (pd.DataFrame(walmart_data.loc[walmart_data.Date.isin(Super_Bowl)]))['Weekly_Sales'].mean()\nLabour_Day_Sales = (pd.DataFrame(walmart_data.loc[walmart_data.Date.isin(Labour_Day)]))['Weekly_Sales'].mean()\nThanksgiving_Sales = (pd.DataFrame(walmart_data.loc[walmart_data.Date.isin(Thanksgiving)]))['Weekly_Sales'].mean()\nChristmas_Sales = (pd.DataFrame(walmart_data.loc[walmart_data.Date.isin(Christmas)]))['Weekly_Sales'].mean()\nSuper_Bowl_Sales,Labour_Day_Sales,Thanksgiving_Sales,Christmas_Sales","ff5309ba":"#Calculating mean sales on non-holidays :\nNon_Holiday_Sales = walmart_data[walmart_data['Holiday_Flag'] == 0 ]['Weekly_Sales'].mean()\nNon_Holiday_Sales","6592f54c":"Mean_Sales = {'Super_Bowl_Sales' : Super_Bowl_Sales,\n              'Labour_Day_Sales': Labour_Day_Sales,\n              'Thanksgiving_Sales':Thanksgiving_Sales,\n              'Christmas_Sales': Christmas_Sales,\n              'Non_Holiday_Sales': Non_Holiday_Sales}\nMean_Sales ","fd9dcd32":"#Year-wise Monthly Sales\n\nplt.figure(figsize=(15,7))\nplt.scatter(walmart_data[walmart_data.Year==2010][\"Month\"],walmart_data[walmart_data.Year==2010][\"Weekly_Sales\"])\nplt.xlabel(\"Months\")\nplt.ylabel(\"Weekly Sales\")\nplt.title(\"Monthly view of sales in 2010\")\nplt.show()\n\nplt.figure(figsize=(15,7))\nplt.scatter(walmart_data[walmart_data.Year==2011][\"Month\"],walmart_data[walmart_data.Year==2011][\"Weekly_Sales\"])\nplt.xlabel(\"Months\")\nplt.ylabel(\"Weekly Sales\")\nplt.title(\"Monthly view of sales in 2011\")\nplt.show()\n\nplt.figure(figsize=(15,7))\nplt.scatter(walmart_data[walmart_data.Year==2012][\"Month\"],walmart_data[walmart_data.Year==2012][\"Weekly_Sales\"])\nplt.xlabel(\"Months\")\nplt.ylabel(\"Weekly Sales\")\nplt.title(\"Monthly view of sales in 2012\")\nplt.show()","fae2f4a9":"#Overall Monthly Sales\nplt.figure(figsize=(15,7))\nplt.bar(walmart_data[\"Month\"],walmart_data[\"Weekly_Sales\"])\nplt.xlabel(\"Months\")\nplt.ylabel(\"Weekly Sales\")\nplt.title(\"Monthly view of sales\")\nplt.show()","8becc51d":"#Yearly Sales\nplt.figure(figsize=(15,7))\nwalmart_data.groupby(\"Year\")[[\"Weekly_Sales\"]].sum().plot(kind='bar',legend=False)\nplt.xlabel(\"Years\")\nplt.ylabel(\"Weekly Sales\")\nplt.title(\"Yearly view of sales\")\nplt.show()","75ca72ef":"#Detecting outliers :\nfig, axis = plt.subplots(4,figsize=(16,16))\nX = walmart_data[['Temperature','Fuel_Price','CPI','Unemployment']]\nfor i,column in enumerate(X):\n    sns.boxplot(walmart_data[column],ax=axis[i])\n    \nimport warnings\nwarnings.filterwarnings('ignore')","6a9ec5a0":"# Dropping outliers     \nwalmart_data_clean = walmart_data[(walmart_data['Unemployment']<10) & (walmart_data['Unemployment']>4.5) & (walmart_data['Temperature']>10)]\nwalmart_data_clean","a511b3cf":"#Checking data for outliers\nfig, axis = plt.subplots(4,figsize=(16,16))\nX = walmart_data_clean[['Temperature','Fuel_Price','CPI','Unemployment']]\nfor i,column in enumerate(X):\n    sns.boxplot(walmart_data_clean[column], ax=axis[i])\n\nimport warnings\nwarnings.filterwarnings('ignore')\n    ","9214a572":"# Linear Regression :\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import metrics\nfrom sklearn.linear_model import LinearRegression\nX = walmart_data_clean[['Store','Fuel_Price','CPI','Unemployment','Day','Month','Year']]\nY = walmart_data_clean['Weekly_Sales']\nX_train, X_test, Y_train, Y_test = train_test_split(X,Y,test_size=0.2)","30201e77":"print('Linear Regression:')\nprint()\nreg = LinearRegression()\nreg.fit(X_train, Y_train)\nY_pred = reg.predict(X_test)\nprint('Accuracy:',reg.score(X_train, Y_train)*100)\nprint('Mean Absolute Error:', metrics.mean_absolute_error(Y_test, Y_pred))\nprint('Mean Squared Error:', metrics.mean_squared_error(Y_test, Y_pred))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(Y_test, Y_pred)))\nsns.scatterplot(Y_pred, Y_test)\n\nimport warnings\nwarnings.filterwarnings('ignore')","f3d324a1":"# Random Forest Regressor\nfrom sklearn.ensemble import RandomForestRegressor\nprint('Random Forest Regressor:')\nprint()\nrfr = RandomForestRegressor()        \nrfr.fit(X_train,Y_train)\nY_pred = rfr.predict(X_test)\nprint('Accuracy:',rfr.score(X_test, Y_test)*100)\nprint('Mean Absolute Error:', metrics.mean_absolute_error(Y_test, Y_pred))\nprint('Mean Squared Error:', metrics.mean_squared_error(Y_test, Y_pred))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(Y_test, Y_pred)))\nsns.scatterplot(Y_pred, Y_test)\n\n\nimport warnings\nwarnings.filterwarnings('ignore')","1b40975a":"**2) Which store has maximum standard deviation? i.e. the sales vary a lot. Also, find out the coefficient of mean to standard deviation.**","f991da7f":"**Clearly, Thanksgiving has higher sales than the mean sales on non-holidays.**\n\n---","aac32123":"**Thus, the store which has maximum standard deviation is store number 14.**","765445e1":" ### **Analysis:**","b7272e0f":"**Here, there is no store which has performed better in the 3rd quarter as compared to the 2nd quarter.**\n\n---","73affd00":" ### **Data Preparation :**\n \n ","915b4ad6":"**4) Some holidays have a negative impact on sales. Find out holidays which have higher sales than the mean sales in non-holiday season for all stores together.**\n\n**Holiday Events:**\n\n- Super Bowl: 12-Feb-10, 11-Feb-11, 10-Feb-12, 8-Feb-13\n\n- Labour Day: 10-Sep-10, 9-Sep-11, 7-Sep-12, 6-Sep-13\n\n- Thanksgiving: 26-Nov-10, 25-Nov-11, 23-Nov-12, 29-Nov-13\n\n- Christmas: 31-Dec-10, 30-Dec-11, 28-Dec-12, 27-Dec-13\n","fee598ab":"**Clearly, from the above graph, it is evident that the store which has good quarterly sales in Q3\u20192012 is store no. 4.**","2e114016":"##### **Loading required libraries :**","6bcb28ee":"**For Store 1 \u2013 Build prediction models to forecast demand : \nLinear Regression \u2013 Utilize variables like date and restructure dates as 1 for 5 Feb 2010 (starting from the earliest date in order). \nHypothesize if CPI, unemployment, and fuel price have any impact on sales. \nChange dates into days by creating new variable. \nSelect the model which gives best accuracy.**","1a7bc484":" # **RETAIL ANALYSIS WITH WALMART DATA**\n     \n   ######                    **PYHTON PROJECT BY - RUTU PATEL**\n \n---","38e8a996":"##### **Viewing Data Information :**","12ec0af3":"**5) Provide a monthly and semester view of sales in units and give insights.**","b452f273":"**Here, overall monthly sales are higher in the month of December while the yearly sales in the year 2011 are the highest.**\n\n---","8dceef1b":"##### **Checking for missing values :**","b3932b09":"**3) Which store\/s has good quarterly growth rate in Q3\u20192012 ?**","850b4bcb":"### **Data Understanding :**\n\nThis is the historical data that covers sales from 2010-02-05 to 2012-11-01, in which you will find the following fields:\n\n- Store - the store number\n\n- Date - the week of sales\n\n- Weekly_Sales -  sales for the given store\n\n- Holiday_Flag - whether the week is a special holiday week 1 \u2013 Holiday week 0 \u2013 Non-holiday week\n\n- Temperature - Temperature on the day of sale\n\n- Fuel_Price - Cost of fuel in the region\n\n- CPI \u2013 Prevailing consumer price index\n\n- Unemployment - Prevailing unemployment rate\n\n---","0ffeded9":"**Clearly, from the above graph, it is visible that the store which has maximum sales is store number 20 and the store which has minimum sales is the store number 33.**\n\n---","e1494575":"##### **Splitting date column into day, month and year :**","c3b21e6b":"### **Summary & Objective :**\n\nHistorical sales data for 45 Walmart stores located in different regions are available. There are certain events and holidays which impact sales on each day. The business is facing a challenge due to unforeseen demands and runs out of stock some times, due to inappropriate machine learning algorithm. Walmart would like to predict the sales and demand accurately. An ideal ML algorithm will predict demand accurately and ingest factors like economic conditions including CPI, Unemployment Index, etc. The objective is to determine the factors affecting the sales and to analyze the impact of markdowns around holidays on the sales.\n\n---","432c3ffe":"**1 ) Which store has maximum sales ?**","22e64a7f":"##### **Importing the dataset :**","abb2ef89":"**Thus, the store which has maximum coefficient of mean to standard deviation is store number 35.**","657a26a9":"**Here, Linear Regression is not an appropriate model to use which is clear from it's low accuracy. However, Random Forest Regression gives accuracy of over 95% , so, it is the best model to forecast demand.**","9ad583c3":"---","0baedaaa":"---"}}