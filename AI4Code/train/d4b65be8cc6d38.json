{"cell_type":{"50ae738f":"code","9d120941":"code","7f8c12ba":"code","e1371493":"code","12265297":"code","703230be":"code","2539735a":"code","b1cd7c41":"code","65d9278d":"code","b1aafd69":"code","a09980ae":"code","b339c8f0":"code","07509b66":"code","cbfbc641":"code","c86367b6":"code","864687f7":"code","fd1a47da":"code","df4f3038":"code","444160c7":"code","081f4314":"code","8c524c66":"code","fcc80d9f":"code","24fc7b39":"code","0141e6a0":"markdown","d5f8297d":"markdown","120c6814":"markdown","3290868b":"markdown","3ec102fb":"markdown"},"source":{"50ae738f":"import pandas as pd\nimport numpy as np\n\nfrom sklearn.model_selection import train_test_split","9d120941":"import tensorflow\nfrom tensorflow.keras.layers import Dense\nfrom tensorflow.keras.models import Sequential","7f8c12ba":"from sklearn.metrics import roc_auc_score","e1371493":"df = pd.read_csv('..\/input\/creditcardfraud\/creditcard.csv')","12265297":"df.head()","703230be":"df.Class.value_counts()","2539735a":"pd.value_counts(df.Class).plot.bar()","b1cd7c41":"len(df.columns)","65d9278d":"X = df.iloc[:,1:30]\ny = df.iloc[:,-1]","b1aafd69":"X.head()","a09980ae":"y.head()","b339c8f0":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.30, random_state = 99 )","07509b66":"y_train.value_counts()","cbfbc641":"n_inputs = len(X.columns)","c86367b6":"# Define Model\nmodel = Sequential()\n\n# First Hidden Layer \nmodel.add(Dense(50, input_dim = n_inputs, activation = 'relu', kernel_initializer = 'he_uniform'))\n\n# Define output layer\nmodel.add(Dense(1, activation = 'sigmoid'))","864687f7":"# Compile\nmodel.compile(\n    loss = 'binary_crossentropy',\n    optimizer = 'adam'\n)","fd1a47da":"# Fit\nmodel.fit(X_train, y_train, epochs = 10)","df4f3038":"y_pred1 = model.predict(X_test)","444160c7":"print(roc_auc_score(y_test, y_pred1))","081f4314":"# Define weights\nweights_assigned = {0:1, 1:550} # Take some random.. or have the weights based on how many time the 1 is of 0.\n# Here count of data point for class 1 is 335, and class 0 has 199029 records which is approx 595 times of class 1. So here taking around 550 as weights.","8c524c66":"# Fit the model with weights..\nmodel.fit(X_train, y_train, epochs = 10, class_weight = weights_assigned)","fcc80d9f":"y_pred2 = model.predict(X_test)","24fc7b39":"print(roc_auc_score(y_test, y_pred2))","0141e6a0":"# Solving using Weighted Neural Network \n","d5f8297d":"How to solve such class imbalanced dataset.\n1. At first will create ANN and see how the model behave.\n2. Next we will use some weights handling techniques to solve the problem for the same model and checks its performance.\n\nNote: The best performance metric while working with Class Imbalanced Dataset is `ROC AUC`.","120c6814":"# Step 1 : ANN","3290868b":"# Handling Imbalanced Classification using Neural Network.","3ec102fb":"This is purely an Imbalanced Class dataset."}}