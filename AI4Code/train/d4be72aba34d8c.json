{"cell_type":{"086eb0a5":"code","c6bc9352":"code","9bd6e3eb":"code","a127d736":"code","7814f464":"code","3964f9e7":"code","827af532":"code","d169d9fa":"code","6687fce5":"code","187867db":"code","74a8a463":"code","4e31cf88":"code","4248afab":"code","adfc5e24":"code","76de6af1":"code","26451f04":"code","c21b6c3e":"code","869d1a88":"code","d12d2c69":"code","fcf43272":"code","6b99796c":"code","251228dc":"code","1b283a2a":"code","13720830":"code","76c9cbc6":"code","b8ad1330":"code","ee392dcb":"code","d499e941":"code","7b8b935b":"code","52384917":"code","96395e3a":"code","0c2eb20e":"code","ee7f11c1":"code","7cb47588":"code","961588da":"code","ea283ba8":"code","26cf3ef1":"code","668a961e":"code","ba89de96":"code","e8323d9b":"code","01f9de1d":"code","c008c87b":"code","0eb1cc4b":"code","5d778154":"code","eb049c8b":"code","3f7f63f5":"code","a9de8bf7":"code","dcf05588":"code","201a893e":"code","10137f09":"code","b37c86b1":"code","1018caf1":"code","691b31ce":"code","699aac0f":"code","55f887bb":"code","ef1816bc":"code","761f088b":"code","abd46c31":"code","3eda3bab":"code","f09097a5":"code","ac50a7ae":"code","f04ad062":"code","246fd422":"code","6c105d02":"code","c26ec987":"code","8d9399f1":"code","15ffadf3":"code","85f58e63":"code","8bafdc0c":"code","01e4e4e2":"code","3adcb701":"code","f9808869":"code","fd24e395":"code","ee83f2cb":"code","a1ff243c":"code","9141b424":"code","8e779447":"code","d3c5267a":"code","2e5a377b":"code","50b73b74":"code","bda46fde":"code","263a7a48":"code","f7fb8ba1":"code","fbde7a90":"code","03dee220":"code","8238c562":"markdown","b6e9ed37":"markdown","2365337f":"markdown","7b573743":"markdown","55a6a508":"markdown","bf18b938":"markdown","6d0ff297":"markdown","8a27e0eb":"markdown","96aeb7ec":"markdown","878fd4e3":"markdown","7fba064b":"markdown","d842234b":"markdown","09f7f3a7":"markdown","7ea5365b":"markdown","938fc5e4":"markdown","428714b3":"markdown","833aea6a":"markdown","6ee27515":"markdown","6b32b603":"markdown","dc1355c4":"markdown","6818a436":"markdown","a28e81ee":"markdown","52a70bd5":"markdown","3d2234f5":"markdown","d78bbce9":"markdown","558ffd43":"markdown","43725efc":"markdown","d973e8be":"markdown","95ece163":"markdown"},"source":{"086eb0a5":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","c6bc9352":"#Import Ames House Dataset\ndf= pd.read_csv('\/kaggle\/input\/ames-housing-dataset\/AmesHousing.csv')","9bd6e3eb":"df.head()","a127d736":"df.corr()['SalePrice'].sort_values()","7814f464":"sns.scatterplot(data=df, x='Overall Qual', y='SalePrice' , color='g')\nplt.axhline(y=200000,color='c')","3964f9e7":"df[(df['Overall Qual']>8) &(df['SalePrice']<200000)][['SalePrice', 'Overall Qual']]","827af532":"sns.scatterplot(x='Gr Liv Area', y='SalePrice', data=df, color='g')\nplt.axhline(y=200000, color='c')\nplt.axvline(x=4000, color='c')","d169d9fa":"df[(df['Gr Liv Area']>4000) & (df['SalePrice']<400000)][['SalePrice', 'Gr Liv Area']]","6687fce5":"#Remove the outliers:\nindex_drop=df[(df['Gr Liv Area']>4000) & (df['SalePrice']<400000)].index\ndf=df.drop(index_drop, axis=0)","187867db":"sns.scatterplot(x='Gr Liv Area', y='SalePrice', data=df, color='g')\nplt.axhline(y=200000, color='c')\nplt.axvline(x=4000, color='c')","74a8a463":"sns.scatterplot(x='Overall Qual', y='SalePrice', data=df, color='g')\nplt.axhline(y=200000,color='c')","4e31cf88":"sns.boxplot(x='Overall Qual', y='SalePrice', data=df)","4248afab":"df.head()","adfc5e24":"df.info()","76de6af1":"df= df.drop('PID', axis=1)","26451f04":"df.isnull().values.any()","c21b6c3e":"print('max_missing:', df.count().idxmin())","869d1a88":"df.isnull()","d12d2c69":"#How many missing data is there in each features?\ndf.isnull().sum()","fcf43272":"100*(df.isnull().sum()\/len(df))","6b99796c":"def missing_percent(df):\n    nan_percent= 100*(df.isnull().sum()\/len(df))\n    nan_percent= nan_percent[nan_percent>0].sort_values()\n    return nan_percent","251228dc":"nan_percent= missing_percent(df)","1b283a2a":"nan_percent","13720830":"plt.figure(figsize=(12,6))\nsns.barplot(x=nan_percent.index, y=nan_percent)\nplt.xticks(rotation=90)","76c9cbc6":"plt.figure(figsize=(12,6))\nsns.barplot(x=nan_percent.index, y=nan_percent)\nplt.xticks(rotation=90)\n\n#Set 1% threshold:\nplt.ylim(0,1)","b8ad1330":"nan_percent[nan_percent<1]","ee392dcb":"nan_percent[nan_percent<1].index","d499e941":"100\/len(df)\n#It shows that, Feature with just one missing rows has this percent value of missing data","7b8b935b":"df[df['Electrical'].isnull()]","52384917":"df[df['Garage Area'].isnull()]","96395e3a":"df= df.dropna(axis=0, subset=['Electrical', 'Garage Area'])","0c2eb20e":"nan_percent= missing_percent(df)\n\nplt.figure(figsize=(12,6))\nsns.barplot(x=nan_percent.index, y=nan_percent)\nplt.xticks(rotation=90)\nplt.ylim(0,1)","ee7f11c1":"#Features related to Basement:","7cb47588":"df[df['Total Bsmt SF'].isnull()]","961588da":"df[df['Bsmt Half Bath'].isnull()]","ea283ba8":"df[df['Bsmt Full Bath'].isnull()]","26cf3ef1":"#Numerical Columns fill with 0:\nbsmt_num_cols= ['BsmtFin SF 1', 'BsmtFin SF 2', 'Bsmt Unf SF','Total Bsmt SF' ,'Bsmt Full Bath', 'Bsmt Half Bath']\ndf[bsmt_num_cols]=df[bsmt_num_cols].fillna(0)\n\n#String Columns fill with None:\nbsmt_str_cols= ['Bsmt Qual', 'Bsmt Cond', 'Bsmt Exposure', 'BsmtFin Type 1', 'BsmtFin Type 2']\ndf[bsmt_str_cols]= df[bsmt_str_cols].fillna('None')","668a961e":"nan_percent= missing_percent(df)\n\nplt.figure(figsize=(12,6))\nsns.barplot(x=nan_percent.index, y=nan_percent)\nplt.xticks(rotation=90)\nplt.ylim(0,1)","ba89de96":"df[\"Mas Vnr Type\"]= df[\"Mas Vnr Type\"].fillna(\"None\")\ndf[\"Mas Vnr Area\"]= df[\"Mas Vnr Area\"].fillna(0)","e8323d9b":"nan_percent= missing_percent(df)\n\nplt.figure(figsize=(12,6))\nsns.barplot(x=nan_percent.index, y=nan_percent)\nplt.xticks(rotation=90)\n","01f9de1d":"df[['Garage Type', 'Garage Yr Blt', 'Garage Finish', 'Garage Qual', 'Garage Cond']]","c008c87b":"#Filling the missing Value:\nGar_str_cols= ['Garage Type', 'Garage Finish', 'Garage Qual', 'Garage Cond']\ndf[Gar_str_cols]=df[Gar_str_cols].fillna('None')\n\ndf['Garage Yr Blt']=df['Garage Yr Blt'].fillna(0)","0eb1cc4b":"nan_percent= missing_percent(df)\n\nplt.figure(figsize=(12,6))\nsns.barplot(x=nan_percent.index, y=nan_percent)\nplt.xticks(rotation=90)\n","5d778154":"nan_percent.index","eb049c8b":"df[['Lot Frontage', 'Fireplace Qu', 'Fence', 'Alley', 'Misc Feature',\n       'Pool QC']]","3f7f63f5":"df= df.drop(['Fence', 'Alley', 'Misc Feature','Pool QC'], axis=1)","a9de8bf7":"nan_percent= missing_percent(df)\n\nplt.figure(figsize=(12,6))\nsns.barplot(x=nan_percent.index, y=nan_percent)\nplt.xticks(rotation=90)","dcf05588":"#Filling in Fireplace Quality based on dataset documentation:\ndf['Fireplace Qu']= df['Fireplace Qu'].fillna('None')","201a893e":"nan_percent= missing_percent(df)\n\nplt.figure(figsize=(12,6))\nsns.barplot(x=nan_percent.index, y=nan_percent)\nplt.xticks(rotation=90)","10137f09":"df['Neighborhood'].unique()","b37c86b1":"plt.figure(figsize=(8,12))\nsns.boxplot(data=df, x='Lot Frontage', y='Neighborhood')","1018caf1":"#Impute missing data based on other columns:\n\ndf.groupby('Neighborhood')['Lot Frontage']","691b31ce":"df.groupby('Neighborhood')['Lot Frontage'].mean()","699aac0f":"df.groupby('Neighborhood')['Lot Frontage'].transform(lambda val: val.fillna(val.mean()))","55f887bb":"df['Lot Frontage']=df.groupby('Neighborhood')['Lot Frontage'].transform(lambda val: val.fillna(val.mean()))","ef1816bc":"nan_percent= missing_percent(df)\n\nplt.figure(figsize=(12,6))\nsns.barplot(x=nan_percent.index, y=nan_percent)\nplt.xticks(rotation=90)","761f088b":"df['Lot Frontage']= df['Lot Frontage'].fillna(0)","abd46c31":"nan_percent= missing_percent(df)\n","3eda3bab":"nan_percent","f09097a5":"df['MS SubClass']","ac50a7ae":"df.info()","f04ad062":"df['MS SubClass'].unique()","246fd422":"#Convert to String:\ndf['MS SubClass']= df['MS SubClass'].apply(str)","6c105d02":"\ndf.info()\n#or: df['MS SubClass'].dtype","c26ec987":"df.select_dtypes(include='object')","8d9399f1":"df_num= df.select_dtypes(exclude='object')\ndf_obj= df.select_dtypes(include='object')","15ffadf3":"df_num.info()","85f58e63":"df_obj.info()","8bafdc0c":"# Converting:\ndf_obj= pd.get_dummies(df_obj, drop_first=True)","01e4e4e2":"df_obj.shape","3adcb701":"Final_df= pd.concat([df_num, df_obj], axis=1)","f9808869":"Final_df.head()","fd24e395":"plt.figure(figsize=(15,5))\nsns.displot(df['SalePrice'] , bins=30 , kde=True )","ee83f2cb":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import Ridge\nfrom sklearn.metrics import mean_absolute_error, mean_squared_error\nfrom sklearn.linear_model import RidgeCV\nfrom sklearn.linear_model import LassoCV\nfrom sklearn.linear_model import ElasticNetCV","a1ff243c":"X= Final_df.drop(['SalePrice'], axis=1)\ny=Final_df['SalePrice']","9141b424":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=101)","8e779447":"#LinearRegression\nmodel= LinearRegression()\nprint(model.fit(X_train, y_train))\n\n#Coeficient Matrix\npd.DataFrame(model.coef_, X.columns, columns=['Coeficient'])\n\n","d3c5267a":"y_pred=model.predict(X_test)\npd.DataFrame({'Y_Test':y_test , 'Y_Pred':y_pred , 'Residuals':(y_test-y_pred)}).head()","2e5a377b":"test_residuals=y_test-y_pred\ntest_residuals.head()","50b73b74":"sns.scatterplot(x=y_test, y=y_pred , color='c')\nplt.xlabel('Y-Test')\nplt.ylabel('Y-Pred')","bda46fde":"sns.scatterplot(x=y_test, y=test_residuals , color='c')\nplt.axhline(y=0, color='r', ls='--')","263a7a48":"scaler= StandardScaler()\nscaler.fit(X_train)","f7fb8ba1":"X_train= scaler.transform(X_train)\nX_test= scaler.transform(X_test)","fbde7a90":"#Train the Model\n\nridge_model= Ridge(alpha=10)\nprint(ridge_model.fit(X_train, y_train))\n\n\n#predict Test Data\ny_pred= ridge_model.predict(X_test)\n\n#Evaluating the Model\nMAE= mean_absolute_error(y_test, y_pred)\nMSE= mean_squared_error(y_test, y_pred)\nRMSE= np.sqrt(MSE)\n\n\n#Train the Model\nridge_cv_model=RidgeCV(alphas=(0.5, 1.0, 10.0), scoring='neg_mean_absolute_error')\nprint(ridge_cv_model.fit(X_train, y_train))\n\nprint('ridge_cv_model.alpha=' , ridge_cv_model.alpha_)\n\n#Predicting Test Data\ny_pred_ridge= ridge_cv_model.predict(X_test)\n\n#Evaluating the Model\nMAE_ridge= mean_absolute_error(y_test, y_pred_ridge)\nMSE_ridge= mean_squared_error(y_test, y_pred_ridge)\nRMSE_ridge= np.sqrt(MSE_ridge)\n\n\n#  Lasso Regression\nlasso_cv_model= LassoCV(eps=0.01, n_alphas=100, cv=5)\nprint(lasso_cv_model.fit(X_train, y_train))\nprint('lasso_cv_model.alpha=' , lasso_cv_model.alpha_)\n\ny_pred_lasso= lasso_cv_model.predict(X_test)\n\n#Evaluating the Model\nMAE_Lasso= mean_absolute_error(y_test, y_pred_lasso)\nMSE_Lasso= mean_squared_error(y_test, y_pred_lasso)\nRMSE_Lasso= np.sqrt(MSE_Lasso)\n\n\nelastic_model= ElasticNetCV(l1_ratio=[0.1, 0.5, 0.7, 0.9, 0.95, 0.99, 1],cv=5, max_iter=10000)\nprint(elastic_model.fit(X_train, y_train))\nprint('elastic_model.l1_ratio=' , elastic_model.l1_ratio_)\n\ny_pred_elastic=elastic_model.predict(X_test)\n\n#Evaluating the Model\nMAE_Elastic= mean_absolute_error(y_test, y_pred_elastic)\nMSE_Elastic= mean_squared_error(y_test, y_pred_elastic)\nRMSE_Elastic= np.sqrt(MSE_Elastic)\n\n\npd.DataFrame({'metrics':[MAE, MSE, RMSE],'ridge':[MAE_ridge ,MSE_ridge, RMSE_ridge] ,'LassoCV':[MAE_Lasso, MSE_Lasso, RMSE_Lasso]\n              ,'ElasticNetCV':[MAE_Elastic, MSE_Elastic, RMSE_Elastic] } ,index=['MAE', 'MSE', 'RMSE'])","03dee220":"print('ridge_cv_modelr:','\\n', ridge_cv_model.coef_ , '\\n')\nprint('lasso_cv_model:', '\\n',lasso_cv_model.coef_ , '\\n')\nprint('elastic_model:' , '\\n', elastic_model.coef_)","8238c562":"**If only a few rows are missing some values, then it might just be a good idea to drop those rows.** \n\n**What does this cost you in terms of performace? It essentialy removes potential training\/testing data, but if its only a few rows, its unlikely to change performance.**\n\n\n**Sometimes it is a good idea to remove a feature entirely if it has too many null values. However, you should carefully consider why it has so many null values, in certain situations null could just be used as a separate category.** \n\n(Take for example a feature column for the number of cars that can fit into a garage. Perhaps if there is no garage then there is a null value, instead of a zero. It probably makes more sense to quickly fill the null values in this case with a zero instead of a null. Only you can decide based off your domain expertise and knowledge of the data set!)","b6e9ed37":"### B- Creating Dummy Variables","2365337f":"### Dropping Rows:","7b573743":"Make a Function to calculate the percent of missing data in each columns (feature) and then sort it","55a6a508":"**Definition:**\n\n**In Statistics, on outlier is a data point that differs significantly from other observations.**\n\n**An outlier may be due to variability in the measurement or it may indicate experimental error, the latter are sometimes excluded from the data set.**\n\n**Anoutlier can couse serious problem in statistical analysis.**","bf18b938":"### D- Imputation of Missing Data","6d0ff297":"#  Data Preparation","8a27e0eb":"#### Now, the Dataset is Ready for any Machine Learing Model & Analysis","96aeb7ec":"### B- Working base on Rows Missing Data","878fd4e3":"plot the feature with missing indicating the percent of missing data","7fba064b":"**Columns: Lot Frontage**\n\n**We assume that the Lot Frontage is related to what a Neighborhood a house is in**","d842234b":"every Feature with missing data must be checked!\nWe choose a threshold of 1%. It means, if there is less than 1% of a feature are missing,\nthen we will consider just dropping that rows","09f7f3a7":"#### A- Numerical Columns to Categorical\nWe need to be careful when it comes to encoding categorical as numbers. We want to make sure that the numerical relationship makes sense for model. For example, the encoding MSSubClass is essentially just a code per class","7ea5365b":"### A- How Much Data is Missing?","938fc5e4":"### Filling the missing values:","428714b3":"### Garage Columns:\n**Based on the dataset documentation, NaN in Garage Columns seems to indicate no garage.**\n\n**Decision: Fill with 'None' or 0**","833aea6a":" The percent of missing data in any feature:","6ee27515":"**In statistics, missing data, or missing values, occur when no data value is stored for the variable in an observation. missing data are a common occurrence and can have a significant effect on the conclusions that can be drawn from the data.**","6b32b603":"Our objective is to predict the SalePrice based on several Features, \n\n Correlation overview:","dc1355c4":"## 2-Dealing with Missing Data","6818a436":"###  Dealing with Outliers","a28e81ee":"**We don't have any Missing Data**","52a70bd5":"### Regularization","3d2234f5":"### C-Working based on Columns Missing Data","d78bbce9":"**Remove the Columns with more than 80% missing values**","558ffd43":"## Dealing with Categorical Data","43725efc":"After checking the data documentation,\nit shows that missing value (two rows) in Basement Features are becouse of there is no basement in these rows\n\nDecision: Filling in data based on column: numerical basement & string descriptive:","d973e8be":"### Fill\/Keep\/Drop?\nRemoving the PID (We already have an index, so we don't need PID unique identifier. \n\nbecuase it doesn't have any information and can't help our learning models)\n","95ece163":"**Mas Vnr Features:**\n\nBased on the Dataset Document File, missing values for 'Mas Vnr Type' and 'Mas Vnr Area' means the house doesn't have any mansonry veneer. so, we decide to fill the missing value as below: "}}