{"cell_type":{"e7a47377":"code","6ff5dbcb":"code","b95da64b":"code","2eaff2d5":"code","6dc475a8":"code","64af576a":"code","2b1806ed":"code","325308be":"code","434312b5":"code","c486af19":"code","822ba065":"code","7708c6c7":"code","291c62f8":"code","a790de52":"code","da835bf3":"code","fc756b97":"code","49b41680":"code","4df203a7":"code","c443cfa8":"code","d9afd2e1":"code","256ba747":"code","c9a132e4":"code","625d9e74":"code","92dcd9bd":"code","7d2f344a":"code","bcf4e909":"code","975be642":"code","ee029b3a":"code","165255f3":"code","883dceba":"code","04c1d56f":"code","e3cbe8d1":"code","b24e0471":"code","425d9199":"code","33a65563":"code","0ac9f4ac":"code","815f2726":"code","12a2fb7a":"code","ffc506e3":"code","3afff08d":"code","3710c939":"code","97fdfa45":"code","ef201505":"code","e5e95586":"code","acb4d664":"code","faefb0e4":"code","2c395eec":"code","79e2ac15":"code","1cf0f428":"code","5f6fcfda":"code","acc1423e":"code","7eb79c84":"code","45b94ac4":"code","6038013c":"code","32284bdd":"code","20bc10a7":"code","57bc1417":"code","d52f2d5a":"code","1fd9f897":"code","7e85dba5":"code","c4f8d529":"code","8c96dbb2":"code","1bb4a779":"code","d92432d7":"code","dd43dc03":"code","08a8c06b":"code","c5ceb7b0":"code","74e68754":"code","9416a843":"code","1937ff41":"code","d34eecd3":"code","cae81769":"code","a71b918d":"code","263e1744":"code","19931d49":"code","ae3ce9e6":"code","8cef96fc":"code","347792e5":"code","ffa609c6":"code","31a0de1d":"code","b675562d":"code","deea8059":"code","f8bffbac":"code","837e46fd":"code","69c9953d":"code","6062a242":"code","5af6e384":"code","a314cdf5":"code","b8cb2279":"code","f0e1e3c3":"code","187a1246":"code","bbb44aff":"code","237c34f6":"code","22e6a2c1":"code","c19e540f":"code","28b6c005":"code","2ae274c3":"code","7525ac08":"code","71ea5fbc":"code","9f0abe2d":"code","13dd8799":"code","3098b6cb":"code","ef749161":"code","c91657bc":"code","29e8d0cb":"code","e041a414":"code","478d58be":"code","736da7e9":"code","71c7429c":"code","40c6523a":"code","d2998a8f":"code","de3322e5":"code","d47ed3c9":"code","220f8f78":"code","2bf15d64":"code","bc245c0b":"code","f7b47f5c":"code","f83fc4c3":"code","80c9136e":"code","f0c5f0aa":"code","0d02888b":"code","608ceb73":"code","cc240701":"code","6f0080bb":"code","eafcc7b0":"code","82296e80":"code","9be75eb9":"code","29f1f114":"code","aa5ecaf5":"code","52e3f31b":"code","9fe6848b":"code","d4fd6a3d":"code","98bf0d68":"code","cbda956b":"code","522a7760":"code","62469631":"code","a2cb1410":"markdown","57c774cb":"markdown","7d17a292":"markdown","211967e5":"markdown","c9d25482":"markdown","b918ca0f":"markdown","62445783":"markdown","ef319921":"markdown","04974820":"markdown","f6fc72f2":"markdown","aba73f8a":"markdown","4bc4b48e":"markdown","210eb56b":"markdown","8132f692":"markdown","858f2c2c":"markdown","e54b84ed":"markdown","e614e4fb":"markdown","e62cb136":"markdown","9dd98354":"markdown","694d7f1d":"markdown","d261cf44":"markdown","f688fd2c":"markdown","46a56ae0":"markdown","4bd50536":"markdown","20825437":"markdown","ccfe8423":"markdown","0ecacb3d":"markdown","6c6e7c6d":"markdown","86b6b22a":"markdown","535299cb":"markdown","5362b5fd":"markdown"},"source":{"e7a47377":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","6ff5dbcb":"data=pd.read_csv('..\/input\/credit-card-customers\/BankChurners.csv')\ndata=data[data.columns[1:-2]]\ndata.head()","b95da64b":"data.describe()","2eaff2d5":"data.info()","6dc475a8":"data.isna().sum()","64af576a":"data.duplicated().sum()","2b1806ed":"data.plot(kind='box',subplots=True,layout=(10,2),figsize=(20,15))","325308be":"data.plot(kind='density',subplots=True,layout=(10,2),figsize=(20,15))","434312b5":"data['Attrition_Flag'].nunique()","c486af19":"data['Attrition_Flag'].unique()","822ba065":"data['Attrition_Flag'].value_counts()","7708c6c7":"sns.countplot(data=data,x='Attrition_Flag')","291c62f8":"data['Customer_Age'].nunique()","a790de52":"sns.distplot(data['Customer_Age'])","da835bf3":"sns.boxplot(data=data,y='Customer_Age')","fc756b97":"sns.boxplot(data=data,x='Attrition_Flag',y='Customer_Age')","49b41680":"data['Gender'].unique()","4df203a7":"data['Gender'].value_counts()","c443cfa8":"sns.countplot(data=data,x='Gender',hue='Attrition_Flag')","d9afd2e1":"data['Dependent_count'].nunique()","256ba747":"data['Dependent_count'].unique()","c9a132e4":"sns.countplot(data=data,x='Dependent_count')","625d9e74":"sns.countplot(data=data,x='Dependent_count',hue='Attrition_Flag')","92dcd9bd":"data['Education_Level'].nunique()","7d2f344a":"data['Education_Level'].unique()","bcf4e909":"data['Education_Level'].value_counts()","975be642":"plt.figure(figsize=(15,7))\nsns.countplot(data=data,x='Education_Level')","ee029b3a":"plt.figure(figsize=(15,7))\nsns.countplot(data=data,x='Education_Level',hue='Attrition_Flag')","165255f3":"data['Marital_Status'].nunique()","883dceba":"data['Marital_Status'].unique()","04c1d56f":"data['Marital_Status'].value_counts()","e3cbe8d1":"sns.countplot(data=data,x='Marital_Status')","b24e0471":"sns.countplot(data=data,x='Marital_Status',hue='Attrition_Flag')","425d9199":"data['Income_Category'].nunique()","33a65563":"data['Income_Category'].unique()","0ac9f4ac":"data['Income_Category'].value_counts()","815f2726":"plt.figure(figsize=(12,7))\nsns.countplot(data=data,x='Income_Category')","12a2fb7a":"plt.figure(figsize=(12,7))\nsns.countplot(data=data,x='Income_Category',hue='Attrition_Flag')","ffc506e3":"data['Card_Category'].nunique()","3afff08d":"data['Card_Category'].unique()","3710c939":"data['Card_Category'].value_counts()","97fdfa45":"sns.countplot(data=data,x='Card_Category')","ef201505":"sns.countplot(data=data,x='Card_Category',hue='Attrition_Flag')","e5e95586":"data['Months_on_book'].nunique()","acb4d664":"data['Months_on_book'].unique()","faefb0e4":"data['Months_on_book'].value_counts()","2c395eec":"sns.distplot(data['Months_on_book'])","79e2ac15":"sns.boxplot(data=data,y='Months_on_book')","1cf0f428":"sns.boxplot(data=data,x='Attrition_Flag',y='Months_on_book')","5f6fcfda":"data['Total_Relationship_Count'].nunique()","acc1423e":"data['Total_Relationship_Count'].unique()","7eb79c84":"data['Total_Relationship_Count'].value_counts()","45b94ac4":"sns.countplot(data=data,x='Total_Relationship_Count')","6038013c":"sns.countplot(data=data,x='Total_Relationship_Count',hue='Attrition_Flag')","32284bdd":"data['Months_Inactive_12_mon'].unique()","20bc10a7":"data['Months_Inactive_12_mon'].nunique()","57bc1417":"data['Months_Inactive_12_mon'].value_counts()","d52f2d5a":"sns.countplot(data=data,x='Months_Inactive_12_mon')","1fd9f897":"sns.countplot(data=data,x='Months_Inactive_12_mon',hue='Attrition_Flag')","7e85dba5":"data['Contacts_Count_12_mon'].nunique()","c4f8d529":"data['Contacts_Count_12_mon'].unique()","8c96dbb2":"sns.countplot(data=data,x='Contacts_Count_12_mon')","1bb4a779":"sns.countplot(data=data,x='Contacts_Count_12_mon',hue='Attrition_Flag')","d92432d7":"data['Credit_Limit'].nunique()","dd43dc03":"data['Credit_Limit'].unique()","08a8c06b":"sns.distplot(data['Credit_Limit'])","c5ceb7b0":"sns.boxplot(data=data,y='Credit_Limit')","74e68754":"sns.boxplot(data=data,y='Credit_Limit',x='Attrition_Flag')","9416a843":"data['Total_Revolving_Bal'].nunique()","1937ff41":"sns.distplot(data['Total_Revolving_Bal'])","d34eecd3":"sns.boxplot(data=data,y='Total_Revolving_Bal')","cae81769":"sns.boxplot(data=data,x='Attrition_Flag',y='Total_Revolving_Bal')","a71b918d":"data['Avg_Open_To_Buy'].nunique()","263e1744":"sns.distplot(data['Avg_Open_To_Buy'])","19931d49":"sns.boxplot(data=data,y='Avg_Open_To_Buy')","ae3ce9e6":"sns.boxplot(data=data,x='Attrition_Flag',y='Avg_Open_To_Buy')","8cef96fc":"data['Total_Amt_Chng_Q4_Q1'].nunique()","347792e5":"sns.distplot(data['Total_Amt_Chng_Q4_Q1'])","ffa609c6":"sns.boxplot(data=data,y='Total_Amt_Chng_Q4_Q1')","31a0de1d":"sns.boxplot(data=data,y='Total_Amt_Chng_Q4_Q1',x='Attrition_Flag')","b675562d":"data['Total_Trans_Amt'].nunique()","deea8059":"sns.distplot(data['Total_Trans_Amt'])","f8bffbac":"sns.boxplot(data=data,y='Total_Trans_Amt')","837e46fd":"sns.boxplot(data=data,x='Attrition_Flag',y='Total_Trans_Amt')","69c9953d":"data['Total_Trans_Ct'].nunique()","6062a242":"data['Total_Trans_Ct'].value_counts()","5af6e384":"sns.distplot(data['Total_Trans_Ct'])","a314cdf5":"sns.boxplot(data=data,y='Total_Trans_Ct')","b8cb2279":"sns.boxplot(data=data,x='Attrition_Flag',y='Total_Trans_Ct')","f0e1e3c3":"data['Total_Ct_Chng_Q4_Q1'].nunique()","187a1246":"sns.distplot(data['Total_Ct_Chng_Q4_Q1'])","bbb44aff":"sns.boxplot(data=data,y='Total_Ct_Chng_Q4_Q1')","237c34f6":"sns.boxplot(data=data,x='Attrition_Flag',y='Total_Ct_Chng_Q4_Q1')","22e6a2c1":"data['Avg_Utilization_Ratio'].nunique()","c19e540f":"sns.distplot(data['Avg_Utilization_Ratio'])","28b6c005":"sns.boxplot(data=data,y='Avg_Utilization_Ratio')","2ae274c3":"sns.boxplot(data=data,x='Attrition_Flag',y='Avg_Utilization_Ratio')","7525ac08":"data.isna().sum()","71ea5fbc":"data.duplicated().sum()","9f0abe2d":"def outliers(col):\n    global data\n    curr=len(data)\n    prev=0\n    while curr!=prev:\n        q1=data[col].describe()[4]\n        q3=data[col].describe()[6]\n        iqr=q3-q1\n        up=q3+1.5*iqr\n        low=q1-1.5*iqr\n        if q3==q1 or low==up:\n            pass\n        else:\n            data=data[(data[col]>low)&(data[col]<up)]\n            prev=curr\n            curr=len(data)","13dd8799":"sns.boxplot(data=data,y='Customer_Age')","3098b6cb":"outliers('Customer_Age')\nsns.boxplot(data=data,y='Customer_Age')","ef749161":"data['Education_Level'].unique()","c91657bc":"plt.figure(figsize=(14,7))\nsns.countplot(data=data,x='Education_Level')","29e8d0cb":"data['Education_Level'].value_counts()","e041a414":"bools=data[data['Education_Level']=='Unknown']['Education_Level'].value_counts()[0]<int(len(data)\/10)\nif bools==False:\n    data=data[data['Education_Level']!='Unknown']\nlen(data)","478d58be":"plt.figure(figsize=(14,7))\nsns.countplot(data=data,x='Education_Level')","736da7e9":"data['Marital_Status'].value_counts()","71c7429c":"data[data['Marital_Status']=='Unknown'].describe()","40c6523a":"data[data['Marital_Status']=='Divorced'].describe()","d2998a8f":"sample=data[(data['Marital_Status']=='Unknown')|(data['Marital_Status']=='Divorced')]","de3322e5":"sns.countplot(data=sample,x='Marital_Status')","d47ed3c9":"plt.figure(figsize=(12,7))\nsns.countplot(data=data,x='Income_Category')","220f8f78":"data['Income_Category'].value_counts()","2bf15d64":"data[data['Income_Category']!='Unknown'].describe()","bc245c0b":"data=data[data['Income_Category']!='Unknown']\ndata.describe()","f7b47f5c":"from sklearn.preprocessing import LabelEncoder,MinMaxScaler","f83fc4c3":"minmax = MinMaxScaler()\nle = LabelEncoder()","80c9136e":"col=data.select_dtypes(include='object').columns\ncol","f0c5f0aa":"data[col]=data[col].apply(le.fit_transform)","0d02888b":"cols=data.select_dtypes(include=['int64','float64']).columns[1:-1]\ncols","608ceb73":"data[cols]=minmax.fit_transform(data[cols])","cc240701":"plt.figure(figsize=(15,7))\nsns.heatmap(data.corr(),annot=True,fmt='.2f')","6f0080bb":"from sklearn.feature_selection import SelectKBest,chi2,f_classif,mutual_info_classif,SelectPercentile","eafcc7b0":"skc = SelectKBest(score_func=f_classif).fit(data.drop(['Attrition_Flag'],axis=1),data['Attrition_Flag'])\nfeatures = pd.DataFrame(skc.scores_,data.drop(['Attrition_Flag'],axis=1).columns)\nfeatures.sort_values(by=0,ascending=False)","82296e80":"cols=features[features[0]>100].index\ncols","9be75eb9":"from sklearn.metrics import accuracy_score,f1_score,classification_report,confusion_matrix,recall_score\nfrom sklearn.model_selection import train_test_split","29f1f114":"train_x,test_x,train_y,test_y=train_test_split(data[cols],data['Attrition_Flag'],test_size=0.3,random_state=11)","aa5ecaf5":"from sklearn.linear_model import LogisticRegression","52e3f31b":"lr=LogisticRegression()\nlr.fit(train_x,train_y)\npredict=lr.predict(test_x)\nprint('Accuracy Score',accuracy_score(predict,test_y)*100)\nprint('F1 Score',f1_score(predict,test_y)*100)\nprint('Recall Score',f1_score(predict,test_y)*100)\nprint('Classification Report\\n',classification_report(predict,test_y))\nprint('Confusion Matrix\\n',confusion_matrix(predict,test_y))","9fe6848b":"from sklearn.tree import DecisionTreeClassifier","d4fd6a3d":"dtc = DecisionTreeClassifier()\ndtc.fit(train_x,train_y)\npredict=dtc.predict(test_x)\nprint('Accuracy Score',accuracy_score(predict,test_y)*100)\nprint('F1 Score',f1_score(predict,test_y)*100)\nprint('Recall Score',recall_score(predict,test_y)*100)\nprint('Classification Report\\n',classification_report(predict,test_y))\nprint('Confusion Matrix\\n',confusion_matrix(predict,test_y))","98bf0d68":"from sklearn.ensemble import RandomForestClassifier","cbda956b":"rfc=RandomForestClassifier()\nrfc.fit(train_x,train_y)\nprint('Accuracy Score',accuracy_score(predict,test_y)*100)\nprint('F1 Score',f1_score(predict,test_y)*100)\nprint('Recall Score',recall_score(predict,test_y)*100)\nprint('Classification Report\\n',classification_report(predict,test_y))\nprint('Confusion Matrix\\n',confusion_matrix(predict,test_y))","522a7760":"from xgboost import XGBClassifier","62469631":"xgc=XGBClassifier()\nxgc.fit(train_x,train_y)\npredict=xgc.predict(test_x)\nprint('Accuracy Score',accuracy_score(predict,test_y)*100)\nprint('F1 Score',f1_score(predict,test_y)*100)\nprint('Recall Score',recall_score(predict,test_y)*100)\nprint('Classification Report\\n',classification_report(predict,test_y))\nprint('Confusion Matrix\\n',confusion_matrix(predict,test_y))","a2cb1410":"## Data Cleaning","57c774cb":"### Feature Engineering","7d17a292":"### Customer Age","211967e5":"### Income Category","c9d25482":"I hope this was of some use or help. ","b918ca0f":"### Education Level","62445783":"### Marital Status","ef319921":"### Total Amt Chng Q4 Q1\t","04974820":"### Total Revolving Bal","f6fc72f2":"### Card Category","aba73f8a":"### Contacts Count 12 mon","4bc4b48e":"## Label Encoding","210eb56b":"### Customer Age","8132f692":"### Months of book","858f2c2c":"### Gender","e54b84ed":"### Marital Status","e614e4fb":"### Dependent Count","e62cb136":"### Avg Utilization Ratio\n","9dd98354":"### Avg Open To Buy","694d7f1d":"### Months Inactive 12 mon","d261cf44":"### Total Ct Chng Q4 Q1","f688fd2c":"### Credit Limit","46a56ae0":"### Total Trans Ct","4bd50536":"## Data Modeling","20825437":"### Total Relationship Count","ccfe8423":"### Total Trans Amt","0ecacb3d":"### Education Level","6c6e7c6d":"### Attrition Flag","86b6b22a":"### Income Category","535299cb":"Random Forest and XBGClassifier are giving a recall score aprox to 98.","5362b5fd":"## EDA"}}