{"cell_type":{"2c9e4c12":"code","1654f911":"code","604a97dd":"code","2feadd83":"code","7cdd140e":"markdown"},"source":{"2c9e4c12":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.datasets import make_moons\nfrom sklearn.model_selection import train_test_split\nX,y = make_moons(n_samples=100,noise=0.25,random_state=3)\nX_train,X_test,y_train,y_test = train_test_split(X,y,stratify=y,random_state=42)\nforest = RandomForestClassifier(n_estimators=5,random_state=5)\nforest.fit(X_train,y_train)","1654f911":"!pip install mglearn\nimport matplotlib.pyplot as plt\nimport mglearn\n%matplotlib inline\nfig,axes=plt.subplots(2,3,figsize=(20,10))\nfor i,(ax,tree) in enumerate(zip(axes.ravel(),forest.estimators_)):\n    ax.set_title(\"Tree {}\".format(i))\n    mglearn.plots.plot_tree_partition(X_train,y_train,tree,ax=ax)\nmglearn.plots.plot_2d_separator(forest,X_train,fill=True,ax=axes[-1,1],alpha=.4)\naxes[-1,1].set_title(\"Random Forest\")\nmglearn.discrete_scatter(X_train[:,0],X_train[:,1],y_train)","604a97dd":"from sklearn.datasets import load_breast_cancer\ncancer = load_breast_cancer()\nX_train,X_test,y_train,y_test = train_test_split(cancer.data,cancer.target,random_state=0)\nforest.fit(X_train,y_train)\nprint(\"Accuracy on the training set: {}\".format(forest.score(X_train,y_train)))\nprint(\"Accuracy on the test set: {}\".format(forest.score(X_test,y_test)))","2feadd83":"import numpy as np\nplt.figure(figsize=(15,10))\ndef plot_feature_importances_cancer(model):\n    n_features = cancer.data.shape[1]\n    plt.barh(range(n_features), model.feature_importances_, align='center')\n    plt.yticks(np.arange(n_features), cancer.feature_names)\n    plt.xlabel(\"Feature importance\")\n    plt.ylabel(\"Feature\")\nplot_feature_importances_cancer(forest)","7cdd140e":"## Reference taken from Introduction to ML by Python-O'Reilly"}}