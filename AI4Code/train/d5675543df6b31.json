{"cell_type":{"f1c7fdb5":"code","ff77af4b":"code","7ed676d9":"code","f4b445c4":"code","cdfbd842":"code","b2d46db1":"code","a0028fea":"code","d9b16402":"code","c079142c":"code","e2a32603":"code","3b43208b":"code","ebc7b2bb":"code","285b65b7":"code","2e4e9da7":"code","c59ab9fe":"code","da61726b":"code","105050c9":"code","9895997e":"code","78c5caf0":"code","619812ee":"code","361ab586":"code","dca7afcb":"code","029ea948":"code","f4b95f55":"code","be0758ee":"code","7197c700":"code","70909668":"code","599ea85b":"code","827c656e":"code","7f42428c":"code","acf98d6f":"code","5242acf8":"code","9938f2e0":"code","c7597039":"code","46ceb0f3":"code","f8208ff3":"code","aef2d4ba":"code","6a2bd6bc":"code","31d72628":"code","14742d68":"code","6929b712":"code","c21f8683":"code","2d5c7b51":"markdown"},"source":{"f1c7fdb5":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport seaborn as sns  # seaborn for visualizationn\nimport matplotlib.pyplot as plt  # for visualization\nfrom sklearn.linear_model import LinearRegression  #Import Linear regression model\nfrom sklearn.model_selection import train_test_split  #To split the dataset into Train and test randomly\nfrom sklearn.metrics import mean_absolute_error, mean_squared_error, mean_squared_log_error, r2_score\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","ff77af4b":"\nimport matplotlib.pyplot as plt\nimport seaborn as sns","7ed676d9":"df = pd.read_csv(\"..\/input\/insurance.csv\")","f4b445c4":"df.head()","cdfbd842":"df.isnull().sum()","b2d46db1":"        df.info()","a0028fea":"# Defining dependent and independent variable\n\nx= df.iloc[:,0:7].values\n\n\n\n","d9b16402":"y= df.iloc[:, 7:8].values","c079142c":"df.duplicated().sum()","e2a32603":"df.duplicated().sum()","3b43208b":"df.drop_duplicates(inplace = True)","ebc7b2bb":"df.duplicated().sum()","285b65b7":"# to convert categorical to numerical by label encoder\n\nfrom sklearn.preprocessing import LabelEncoder\nLabel_x= LabelEncoder\n","2e4e9da7":"x[:,5] = Label_x.fit_transform(x[:,5])","c59ab9fe":"df.isnull().sum()","da61726b":"df.head()","105050c9":"from sklearn.preprocessing import LabelEncoder, OneHotEncoder","9895997e":"Label_x= LabelEncoder()","78c5caf0":"x[:,4]= Label_x.fit_transform(x[:,4])","619812ee":"x[:,1]= Label_x.fit_transform(x[:,1])","361ab586":"onehotencoder_x= OneHotEncoder(categorical_features=[1])\n","dca7afcb":"x=onehotencoder_x.fit_transform(x).toarray()","029ea948":"df.head()","f4b95f55":"df.describe()","be0758ee":"df.corr()","7197c700":"ax = sns.boxplot(df['age'])\nax.set_title('Dispersion of Age')\nplt.show(ax)","70909668":"#To split test and train\n","599ea85b":"from sklearn.model_selection import train_test_split","827c656e":"xtrain, xtest, ytrain, ytest = train_test_split(x,y,test_size=.2, random_state = 0)","7f42428c":"xtrain","acf98d6f":"ytrain","5242acf8":"plt.figure(figsize=(15,10))\nax = sns.scatterplot(x='age',y='expenses',hue = 'bmi',size = 'bmi', data=df)\nax = ax.set_title(\"Age vs Expenses by BMI\")\nplt.xlabel(\"Age\")\nplt.ylabel(\"Expenses\")\nplt.show(ax)","9938f2e0":"#Scatter plot clearly states that, Age with sex are not influencing the expenses.\nplt.figure(figsize=(10,7))\nax = sns.scatterplot(x='age',y='expenses', hue='sex',style = 'sex',data=df)\nax.set_title(\"Age vs Expenses by Sex\")\nplt.show(ax)","c7597039":"#Both Age and smoker are highly influncing the expenses. Smoker yes\nplt.figure(figsize=(10,7))\nax = sns.scatterplot(x='age',y='expenses', hue=df['smoker'],style = df['smoker'],size = df['smoker'], data=df)\nax.set_title(\"Age vs Expenses by Smoker\")\nplt.xlabel(\"Smoker (Yes - 1, No - 0)\")\nplt.ylabel(\"Expenses\")\nplt.show(ax)","46ceb0f3":"df.corr()","f8208ff3":"#Swarm plot shows how smoker feature is influencing the expeneses compare with smoker and non-smoker\nax = sns.swarmplot(x='smoker',y='expenses',data=df)\nax.set_title(\"Smoker vs Expenses\")\nplt.xlabel(\"Smoker (Yes - 1, No - 0)\")\nplt.ylabel(\"Expenses\")\nplt.show(ax)","aef2d4ba":"from sklearn.preprocessing import LabelEncoder\nlabelencoder = LabelEncoder()\ndf.iloc[:,4] = labelencoder.fit_transform(df.iloc[:,4])","6a2bd6bc":"df.head()","31d72628":"x = df[['age','bmi','smoker']]\ny = df['expenses']","14742d68":"model = LinearRegression()","6929b712":"model.fit(xtrain, ytrain) \n","c21f8683":"print(\"Intercept value:\", model.intercept_)\nprint(\"Coefficient values:\", model.coef_)","2d5c7b51":"df.corr()"}}