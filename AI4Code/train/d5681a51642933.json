{"cell_type":{"e9ef8382":"code","f44923f7":"code","317de497":"code","57ad3e63":"code","fa0caffa":"code","7f00043e":"code","9988dc88":"code","fda0755f":"code","9254fcc9":"code","73a95148":"code","99452aee":"code","5a5acaaa":"code","82bd682a":"code","af01d2fa":"code","b408d93e":"code","4e386e8f":"code","53af3482":"code","17e48c23":"code","2c566b70":"code","3afaa64a":"code","8de6bbd0":"code","2834d988":"code","2e154d9e":"code","bf412e09":"code","dde766fe":"code","49ecf02e":"code","e294fdb4":"code","3ef1b9c8":"code","77374851":"code","7f9086b1":"code","36a3b964":"code","8f98708e":"code","720f55af":"code","650b5a60":"code","a0b5aa10":"code","4a5dd76b":"code","b6038fbb":"code","f7683cb2":"code","9b594ee1":"code","7e3810be":"code","eeaa44d3":"markdown","e7fed7c3":"markdown","6b767f94":"markdown","402ec870":"markdown","c83f23f5":"markdown","f6d8db13":"markdown","b59612f8":"markdown","334b4cae":"markdown","519507e8":"markdown","34cad995":"markdown","f86a949d":"markdown","833573f9":"markdown","7f91f193":"markdown"},"source":{"e9ef8382":"## define configuration\nPATH_TRAIN = '..\/input\/tabular-playground-series-oct-2021\/train.csv'\nPATH_TEST = '..\/input\/tabular-playground-series-oct-2021\/test.csv'\n\nPATH_AUTOGLUON_SUBMISSION = 'submission_autogluon.csv'\nPATH_EVALML_SUBMISSION = 'submission_evalml.csv'\nPATH_FLAML_SUBMISSION = 'submission_flaml.csv'\nPATH_H2OAML_SUBMISSION = 'submission_h2oaml.csv'\nPATH_LAML_SUBMISSION = 'submission_laml.csv'\n\nMAX_MODEL_RUNTIME_MINS = 5\nMAX_MODEL_RUNTIME_SECS = MAX_MODEL_RUNTIME_MINS * 60","f44923f7":"## prepare data\nimport gc\nimport os\nimport shutil\nimport datatable as dt\nfrom pathlib import Path\nimport warnings\n\nwarnings.filterwarnings('ignore')\n\ntrain = dt.fread(PATH_TRAIN)[:100000, :]\ntest = dt.fread(PATH_TEST)\n\ntarget = train['target'].to_numpy().ravel()\ntest_ids = test['id']\n\ndel train[:, ['id', 'target']]\ntest = test[:, train.names]","317de497":"## install packages\n!python3 -m pip install -q \"mxnet<2.0.0\"\n!python3 -m pip install -q autogluon\n!python3 -m pip install -q -U graphviz\n!python3 -m pip install -q scikit-learn==0.24.2","57ad3e63":"## import packages\nfrom autogluon.tabular import TabularPredictor","fa0caffa":"## run model\ntrain['target'] = dt.Frame(target)\n\nmodel_autogluon = TabularPredictor(label='target')\nmodel_autogluon.fit(train_data=train.to_pandas(), excluded_model_types=['KNN'], time_limit=MAX_MODEL_RUNTIME_SECS)\n\ndel train['target']","7f00043e":"## check leaderboard\nmodel_autogluon.leaderboard()","9988dc88":"## generate predictions\npreds_autogluon = model_autogluon.predict_proba(test.to_pandas())[True]","fda0755f":"## create submission\nsubmission = dt.Frame(id=test_ids, target=dt.Frame(preds_autogluon))\nsubmission.head()","9254fcc9":"## save submission\nsubmission.to_csv(PATH_AUTOGLUON_SUBMISSION)","73a95148":"## clear memory\nshutil.rmtree('AutogluonModels')\ndel model_autogluon\n\ngc.collect()","99452aee":"## install packages\n!python3 -m pip install -q evalml==0.28.0","5a5acaaa":"## import packages\nfrom evalml.automl import AutoMLSearch","82bd682a":"## run model\nmodel_evalml = AutoMLSearch(X_train=train.to_pandas(), y_train=target, problem_type='binary', max_time=MAX_MODEL_RUNTIME_SECS)\nmodel_evalml.search()","af01d2fa":"## check leaderboard\nmodel_evalml.rankings","b408d93e":"## generate predictions\npreds_evalml = model_evalml.best_pipeline.predict_proba(test.to_pandas())[True]","4e386e8f":"## create submission\nsubmission = dt.Frame(id=test_ids, target=dt.Frame(preds_evalml))\nsubmission.head()","53af3482":"## save submission\nsubmission.to_csv(PATH_EVALML_SUBMISSION)","17e48c23":"## clear memory\nos.remove('evalml_debug.log')\ndel model_evalml\n\ngc.collect()","2c566b70":"## install packages\n!python3 -m pip install -q flaml\n!python3 -m pip install -q -U graphviz\n!python3 -m pip install -q scikit-learn==0.24.2","3afaa64a":"## import packages\nfrom flaml import AutoML","8de6bbd0":"## run model\nmodel_flaml = AutoML()\nmodel_flaml.fit(X_train=train.to_pandas(), y_train=target, metric='roc_auc', time_budget=MAX_MODEL_RUNTIME_SECS)","2834d988":"## generate predictions\npreds_flaml = model_flaml.predict_proba(test.to_pandas())[:, 1]","2e154d9e":"## create submission\nsubmission = dt.Frame(id=test_ids, target=preds_flaml)\nsubmission.head()","bf412e09":"## save submission\nsubmission.to_csv(PATH_FLAML_SUBMISSION)","dde766fe":"## clear memory\nif Path('catboost_info').exists():\n    shutil.rmtree('catboost_info')\n\nos.remove('flaml.log')\ndel model_flaml\n\ngc.collect()","49ecf02e":"## import packages\nimport h2o\nfrom h2o.automl import H2OAutoML","e294fdb4":"## prepare data\nh2o.init()\n\nh2o_train = h2o.H2OFrame(train.to_pandas())\nh2o_test = h2o.H2OFrame(test.to_pandas())\n\nh2o_train['target'] = h2o.H2OFrame(target).asfactor()","3ef1b9c8":"## run model\nfeatures = [x for x in h2o_train.columns if x != 'target']\n\nmodel_h2o = H2OAutoML(stopping_metric='AUC', max_runtime_secs=MAX_MODEL_RUNTIME_SECS)\nmodel_h2o.train(x=features, y='target', training_frame=h2o_train)","77374851":"## check leaderboard\nmodel_h2o.leaderboard","7f9086b1":"## generate predictions\npreds_h2o = model_h2o.leader.predict(h2o_test).as_data_frame()['True']","36a3b964":"## create submission\nsubmission = dt.Frame(id=test_ids, target=dt.Frame(preds_h2o))\nsubmission.head()","8f98708e":"## save submission\nsubmission.to_csv(PATH_H2OAML_SUBMISSION)","720f55af":"## clear memory\nh2o.cluster().shutdown()\ndel model_h2o\n\ngc.collect()","650b5a60":"## install packages\n!python3 -m pip install -q lightautoml\n!python3 -m pip install -q -U torch\n!python3 -m pip install -q -U torchvision","a0b5aa10":"## import packages\nfrom lightautoml.automl.presets.tabular_presets import TabularAutoML\nfrom lightautoml.tasks import Task","4a5dd76b":"## run model\ntrain['target'] = dt.Frame(target)\n\nmodel_laml = TabularAutoML(task = Task('binary'), timeout = MAX_MODEL_RUNTIME_SECS)\nmodel_laml.fit_predict(train_data=train.to_pandas(), roles={'target': 'target'})\n\ndel train['target']","b6038fbb":"## generate predictions\npreds_laml = model_laml.predict(test.to_pandas()).data.ravel()","f7683cb2":"## create submission\nsubmission = dt.Frame(id=test_ids, target=preds_laml)\nsubmission.head()","9b594ee1":"## save submission\nsubmission.to_csv(PATH_LAML_SUBMISSION)","7e3810be":"## clear memory\nif Path('catboost_info').exists():\n    shutil.rmtree('catboost_info')\n\ndel model_laml\n\ngc.collect()","eeaa44d3":"## AutoGluon\n<img src='https:\/\/user-images.githubusercontent.com\/16392542\/77208906-224aa500-6aba-11ea-96bd-e81806074030.png' width='250px'>\n\n[AutoGluon](https:\/\/auto.gluon.ai\/stable\/index.html) is an automl library open sourced by [Amazon](http:\/\/amazon.com\/aws)","e7fed7c3":"## Similar Tutorials\nSimilar tutorials on other Kaggle TPS competitions are published here:\n\n* [AutoML Tutorial: TPS (January 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-january-2021)\n* [AutoML Tutorial: TPS (February 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-february-2021)\n* [AutoML Tutorial: TPS (March 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-march-2021)\n* [AutoML Tutorial: TPS (April 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-april-2021)\n* [AutoML Tutorial: TPS (May 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-may-2021)\n* [AutoML Tutorial: TPS (June 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-june-2021)\n* [AutoML Tutorial: TPS (July 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-july-2021)\n* [AutoML Tutorial: TPS (August 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-august-2021)\n* [AutoML Tutorial: TPS (September 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-september-2021)","6b767f94":"## LightAutoML\n<img src='https:\/\/github.com\/sberbank-ai-lab\/LightAutoML\/blob\/master\/imgs\/LightAutoML_logo_small.png?raw=true' width='150px'>\n\n[LightAutoML](https:\/\/github.com\/sberbank-ai-lab\/LightAutoML) is a framework for automatic classification and regression model creation open sourced by [Sberbank](https:\/\/www.sberbank.com) AI Lab.","402ec870":"## H2O AutoML\n<img src='https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/_images\/h2o-automl-logo.jpg' width='150px'>\n\n[H2O AutoML](https:\/\/www.h2o.ai\/products\/h2o-automl) is an automated machine learning library open sourced by [H2O.ai](https:\/\/h2o.ai)","c83f23f5":"**Auto**mated **M**achine **L**earning (**AutoML**) has become widely adopted for building, experimenting and productionizing various types of machine learning models across business use-cases.\n\nThere are different open source solutions available and this notebook explores a simple baseline solution for some of them on the [Kaggle TPS (October 2021) competition](https:\/\/www.kaggle.com\/c\/tabular-playground-series-oct-2021).\n\n* [AutoGluon](#AutoGluon)\n* [EvalML](#EvalML)\n* [FLAML](#FLAML)\n* [H2O AutoML](#H2O-AutoML)\n* [LightAutoML](#LightAutoML)","f6d8db13":"Read more in [Documentation of FLAML](https:\/\/microsoft.github.io\/FLAML)","b59612f8":"<div align='center'>\n    <h1>AutoML Tutorial<\/h1>\n    <img src='https:\/\/github.com\/vopani\/fortyone\/blob\/main\/images\/automl_banner_530_x_455.png?raw=true'>\n<\/div>","334b4cae":"Read more in [Documentation of LightAutoML](https:\/\/lightautoml.readthedocs.io\/en\/latest\/index.html)","519507e8":"Read more in [Documentation of H2O AutoML](https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/automl.html)","34cad995":"Read more in [Documentation of AutoGluon](https:\/\/auto.gluon.ai\/stable\/index.html)","f86a949d":"## FLAML\n<img src='https:\/\/github.com\/microsoft\/FLAML\/raw\/main\/docs\/images\/FLAML.png' width='150px'>\n\n[FLAML](https:\/\/microsoft.github.io\/FLAML) is a fast and light automl library open sourced by [Microsoft](https:\/\/opensource.microsoft.com)","833573f9":"## EvalML\n<img src='https:\/\/evalml.alteryx.com\/en\/stable\/_images\/evalml_horizontal.svg' width='250px'>\n\n[EvalML](https:\/\/evalml.alteryx.com\/en\/stable) is an automl library open sourced by [Alteryx](http:\/\/www.alteryx.com)","7f91f193":"Read more in [Documentation of EvalML](https:\/\/evalml.alteryx.com)"}}