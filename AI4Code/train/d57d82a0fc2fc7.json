{"cell_type":{"288ac45c":"code","cb248a56":"code","1e0bab2a":"code","6df25e69":"code","4a7302f3":"code","ac67b05c":"code","2aee7baa":"code","f4cf08e3":"code","88c6bd9a":"code","d43f3a0a":"code","76b5a405":"code","98f1462e":"code","5d83d543":"code","1edfa7cc":"code","aa13e244":"code","a9be5aa4":"code","b7d83273":"code","fc956902":"code","a90703d3":"code","81c65e12":"code","ce484947":"code","8e42e8a7":"code","5b18c5a9":"code","1f38ada0":"code","f6d13378":"code","b52cfe60":"code","6f23e67d":"code","3c9faf0b":"code","fa72c536":"code","8e8b90ed":"markdown"},"source":{"288ac45c":"import pandas as pd \nimport numpy as np\nfrom matplotlib import pyplot as plt\n\nfrom sklearn.preprocessing import MinMaxScaler,StandardScaler\nfrom sklearn.model_selection import train_test_split\n\nimport tensorflow as tf\nfrom tensorflow import keras\n","cb248a56":"data=pd.read_csv(\"..\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv\")\ndata","1e0bab2a":"data.describe(include = 'all').T","6df25e69":"data.info()","4a7302f3":"data.drop(\"customerID\",axis=1,inplace=True)\ndata.head(1)","ac67b05c":"data.TotalCharges.values","2aee7baa":"data[pd.to_numeric(data.TotalCharges,errors=\"coerce\").isnull()]","f4cf08e3":"data.iloc[488][\"TotalCharges\"]","88c6bd9a":"print(data.shape)","d43f3a0a":"df=data[data.TotalCharges!= ' ']\ndf.shape","76b5a405":"data.TotalCharges=pd.to_numeric(df.TotalCharges)","98f1462e":"data.TotalCharges.dtypes","5d83d543":"tenure_Churn_no=data[data.Churn==\"No\"].tenure\ntenure_Churn_yes=data[data.Churn==\"Yes\"].tenure\n\nplt.hist([tenure_Churn_yes,tenure_Churn_no],color=[\"green\",\"red\"],label=[\"Churn_yes\",\"Churn_no\"])\nplt.xlabel(\"tenure\")\nplt.ylabel(\"Churn\")\nplt.title(\"Cutomer churn\")\nplt.legend()","1edfa7cc":"MonthlyCharges_Churn_no=data[data.Churn==\"No\"].MonthlyCharges\nMonthlyCharges_Churn_yes=data[data.Churn==\"Yes\"].MonthlyCharges\n\nplt.hist([MonthlyCharges_Churn_yes,MonthlyCharges_Churn_no],color=[\"green\",\"red\"],label=[\"Churn_yes\",\"Churn_no\"])\nplt.xlabel(\"MonthlyCharges\")\nplt.ylabel(\"Churn\")\nplt.title(\"Cutomer churn_MonthlyCharges\")\nplt.legend()","aa13e244":"def unique_value(data):\n    for column in data:\n        if data[column].dtypes==object:\n            print(f'{column}={data[column].unique()}')","a9be5aa4":"unique_value(data)","b7d83273":"data.replace('No internet service','No',inplace=True)\ndata.replace('No phone service','No',inplace=True)\ndata.replace({'Yes':1, \"No\":0},inplace=True)\ndata.replace({'Female':1, \"Male\":0},inplace=True)\ndata=pd.get_dummies(data=data,columns=[\"InternetService\",\"Contract\",\"PaymentMethod\"])","fc956902":"for column in data: \n    print(f'{column}={data[column].unique()}')","a90703d3":"data.dtypes","81c65e12":"data\n","ce484947":"col_scale= ['tenure','MonthlyCharges','TotalCharges']\nscaler= MinMaxScaler()\ndata[col_scale]=scaler.fit_transform(data[col_scale])","8e42e8a7":"data.head(2)","5b18c5a9":"data.columns","1f38ada0":"y=data['Churn']\nX=data.drop('Churn',axis=1)\n\nX_train, X_test, y_train, y_test = train_test_split(X,y,train_size=0.8,random_state=123)","f6d13378":"model= keras.Sequential([\n    keras.layers.Dense(20,input_shape=(26,),activation='relu'),\n    keras.layers.Dense(15,activation='relu'),\n    keras.layers.Dense(1,activation='sigmoid'),\n\n])\n\nmodel.compile(optimizer=\"adam\",\n              loss=\"binary_crossentropy\",\n              metrics=[\"accuracy\"])\n\nmodel.fit(X_train,y_train,epochs=15)","b52cfe60":"model.evaluate(X_test,y_test)","6f23e67d":"yp=model.predict(X_test)\nyp[:5]","3c9faf0b":"y_pred =[]\nfor element in yp:\n    if element > 0.5:\n        y_pred.append(1)\n    else:\n        y_pred.append(0)","fa72c536":"from sklearn.metrics import confusion_matrix, classification_report\nprint(classification_report(y_test,y_pred))","8e8b90ed":"# Telco Customer Churn Project\n### Predict behavior to retain customers. You can analyze all relevant customer data and develop focused customer retention programs."}}