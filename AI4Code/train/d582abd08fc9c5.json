{"cell_type":{"a274a284":"code","45b5e7b2":"code","1fe934b7":"code","c4cce71e":"code","8ea61693":"code","38d07ef3":"code","c349ffda":"code","f5a2ab27":"code","3b7437e2":"code","78cb1e07":"markdown","b6c31c25":"markdown","ad55ad0d":"markdown","832cc3c6":"markdown","08e515b6":"markdown","3f013d1f":"markdown","1c638734":"markdown","3b214e47":"markdown"},"source":{"a274a284":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","45b5e7b2":"!pip install openpyxl","1fe934b7":"data = pd.read_excel(r\"\/kaggle\/input\/coal-mine-disastersuk\/COAL MINING DISASTERS UK.xlsx\")","c4cce71e":"data","8ea61693":"data.describe()","38d07ef3":"import matplotlib.pyplot as plt\n%matplotlib inline\nimport pymc3 as pm\n\nfrom matplotlib import cycler\ncolors = cycler('color',\n                ['#EE6666', '#3388BB', '#9988DD',\n                 '#EECC55', '#88BB44', '#FFBBBB'])\nplt.rc('axes', facecolor='#E6E6E6', edgecolor='none',\n       axisbelow=True, grid=True, prop_cycle=colors)\nplt.rc('grid', color='w', linestyle='solid')\nplt.rc('xtick', direction='out', color='gray')\nplt.rc('ytick', direction='out', color='gray')\nplt.rc('patch', edgecolor='#E6E6E6')\nplt.rc('lines', linewidth=2)\n\nplt.plot(data.Year, data.Count, \"*\")\nplt.ylabel(\"Number of disasters\")\nplt.xlabel(\"Year\")\n","c349ffda":"with pm.Model() as disaster_model:  #context manager to wrap all values\n    switchpoint = pm.DiscreteUniform(\"switchpoint\", lower=data.Year.min(), upper=data.Year.max(),testval=1900)\n    \n    #priors for pre- and post-switch rates number of disasters\n    early_rate = pm.Exponential(\"early_rate\",1)\n    late_rate = pm.Exponential(\"late_rate\",1)\n    \n    #allocate appropriate Poisson rates to years before and after current\n    rate = pm.math.switch(switchpoint>=data.Year,early_rate,late_rate)\n    \n    disasters = pm.Poisson(\"disasters\",rate,observed=data.Count)\n    \n    \n    ","f5a2ab27":"with disaster_model:\n    trace = pm.sample(1000)","3b7437e2":"pm.traceplot(trace,combined=False, compact = False)\n\"\"\"A trace plot shows the sampled values per chain and node throughout iterations. It allows us to evaluate convergence and mixing of the chains visually\"\"\"","78cb1e07":"# **Conclusion**\n\nWe observe the 5 years span which is most likely where the safety rules must have essential amendments, i.e, 1888-1893.","b6c31c25":"The occurrences of disasters are thought to follow a Poisson process with a large rate parameter in the early part and one with a smaller rate in the later years.\n\nThe probability mass function of a Poisson distribution is given as\n![image.png](attachment:29c5d6a3-e52b-4d5e-b70b-6d9c28b9d92b.png)\n","ad55ad0d":"Hence the values are in proper range and no invalid entries exist.","832cc3c6":"**Poisson log-likelihood** is often used to model the number of events occurring in a fixed period of time when the times at which events occurr are independent.\n","08e515b6":"Certain use-cases of changepoint detection are analysis of the point when\n* A server began to overload.\n* A campaign began to kick-in.\n* A user behaviour took a drastic change\n* and many more","3f013d1f":"Reference: \nR.G. Jarrett, A note on the intervals between coal mining disasters, Biometrika, 66:191-193, 1979.","1c638734":"So most of the disasters took place at the begining,i.e, around 1860s.\n\nWe aim to find the point in time where the safety regulations started to kick-in and the number of disaster was brought under control. \n\nOur main assumption here is that our data is highly influenced by the safety regulations and it's changes over time.","3b214e47":"Consider the following time series of coal mine disasters. We build a model for this and attempt to estimate the point of change."}}