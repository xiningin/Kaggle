{"cell_type":{"803f0897":"code","d9b7e6c0":"code","3df7724d":"code","42154002":"code","4c544e29":"code","8b34bab8":"code","1ceb5849":"code","939014f6":"code","643bfeda":"code","18b83ce6":"code","f838bdd6":"code","8936c064":"code","343c7f46":"code","5775777d":"code","fd1dce7a":"code","e621b786":"markdown","ce3069e8":"markdown","77b05ca3":"markdown","6dd20a0f":"markdown","5ad6dc80":"markdown","515032a3":"markdown","93b5b55a":"markdown","8c4cff0d":"markdown","05a68fbe":"markdown","11a1f5c3":"markdown","9d599f52":"markdown"},"source":{"803f0897":"import warnings\nwarnings.simplefilter('ignore')\nimport pandas as pd\nimport numpy as np\nimport sys\n\nimport feather\nfrom sklearn.feature_extraction.text import TfidfVectorizer #\nfrom sklearn.decomposition import TruncatedSVD #\n\nfrom pandas import DataFrame\nimport matplotlib.pyplot as plt\nplt.style.use('ggplot')\n%matplotlib inline\n\nimport umap #\n\npd.set_option(\"display.max_columns\", 200)","d9b7e6c0":"TRAIN_PATH = '\/kaggle\/input\/data-science-winter-osaka2\/train.csv'\nTEST_PATH = '\/kaggle\/input\/data-science-winter-osaka2\/test.csv'\nSAVE_PATH = \"game_tfidf.feather\"\n\ndf_train = pd.read_csv(TRAIN_PATH, index_col=0)\ndf_test = pd.read_csv(TEST_PATH, index_col=0)","3df7724d":"df_train.info(), df_test.info()","42154002":"X_train = df_train.copy()\nX_test = df_test.copy()","4c544e29":"# TEST\u30c7\u30fc\u30bf\u306a\u3057\u3092\u9078\u629e\uff08\u53ef\u8996\u5316\u3092\u898b\u6613\u304f\u3059\u308b\u305f\u3081\uff09\n#description_all = X_train[['description','user_reviews']]\ndescription_all = pd.concat([X_train[['description','user_reviews']],X_test[['description']]]).reset_index(drop=True)","8b34bab8":"# user_reviews \u3092\u6570\u5024\u5316\ndescription_all['user_reviews'] = description_all['user_reviews'].replace({'c0':0, 'c1':1, 'c2':2, np.nan:3})","1ceb5849":"description_all.tail(3)","939014f6":"# tf-idf\u8a08\u7b97\ntv = TfidfVectorizer()\ndescription_all['description'] = description_all['description'].astype(str)\nX = tv.fit_transform(description_all['description'])","643bfeda":"# SVD : \u6b21\u5143\u524a\u6e1b\nn_components = 20\nsvd = TruncatedSVD(n_components=n_components)\nX = svd.fit_transform(X)","18b83ce6":"# \u7279\u5fb4\u91cf\u4f5c\u6210\u3000\uff08\u6b63\u898f\u5316\u3055\u308c\u305f\u5024\u3092\u51fa\u529b\uff09\ndescription_ = pd.DataFrame(X, columns=[f\"tfidf_{i}\" for i in range(n_components)])\ndescription_","f838bdd6":"# \u5358\u8a9e\u306e\u4e00\u4f8b\nwords = tv.get_feature_names()\nwords[100]","8936c064":"# feather\u5f62\u5f0f\u3067\u4fdd\u5b58\ndescription_.to_feather(SAVE_PATH)","343c7f46":"# \u4e0a\u4e0b\u53cd\u8ee2\ndescription_all = description_all.iloc[::-1]\ndescription_ = description_.iloc[::-1]","5775777d":"# UMAP\nembedding = umap.UMAP().fit_transform(description_)","fd1dce7a":"# Plot\nplt.scatter(embedding[:,0],embedding[:,1],marker=\"o\",c=description_all.user_reviews,alpha=0.6)\nplt.colorbar()\nplt.savefig('umap.png')","e621b786":"## 3.Data preprocess","ce3069e8":"\u3010\u307e\u3068\u3081\u3011  \n\u4e0a\u306e\u5206\u5e03\u56f3\u3092\u898b\u307e\u3059\u3068\u3001description \u304b\u3089\u30dd\u30b8\u30c6\u30a3\u30d6(0:\u7d2b)\u304b\u30cd\u30ac\u30c6\u30a3\u30d6(1:\u9ec4\u7dd1)\u304b\u3092\u5224\u5225\u3059\u308b\u3053\u3068\u306f\u96e3\u3057\u305d\u3046\u3067\u3059\u3002\u30ec\u30d3\u30e5\u30fc\u306a\u3057(2:\u9ec4)\u306f\u3001\u3069\u3046\u306b\u304b\u4e00\u90e8\u304c\u5224\u5225\u3067\u304d\u305d\u3046\u3067\u3059\u3002\uff08\u4e2d\u592e\u306e\u584a\u306e\u5916\u5074\u306b\u70b9\u5728\u3059\u308b\u9ec4\u70b9\uff09  \nBERT(Google)\u3001fastText(Facebook) \u7b49\u3068\u6bd4\u3079\u3066\u3001tfidf\u306f\u3001\u5206\u6563\u8868\u73fe(Word2Vec)\u3092\u63a1\u7528\u3057\u3066\u304a\u3089\u305a\u3001\u5358\u8a9e\u3092\u5358\u306b\u30ab\u30a6\u30f3\u30c8\u3057\u3066\u8a08\u7b97\u3057\u3066\u3044\u308b\u3060\u3051\u306a\u306e\u3067\u7cbe\u5ea6\u7684\u306b\u306f\u52a3\u308b\u3088\u3046\u306b\u601d\u308f\u308c\u307e\u3059\u3002\uff08\u63a8\u6e2c\uff09","77b05ca3":"## 3.Tf-Idf","6dd20a0f":"## 1. Importing libraries and loading datasets","5ad6dc80":"\u3010\u904e\u53bb\u306e\u95a2\u4fc2 Discussion\u3011  \nhttps:\/\/www.kaggle.com\/c\/machine-learning-challenge-osaka-2020\/discussion\/208418#1136735","515032a3":"\u3010tf-idf \u3068\u306f\u3011  \ntf-idf \u306f\u3001\u5358\u8a9e\u306e\u91cd\u8981\u5ea6\u3092\u6e2c\u308b\u305f\u3081\u306e\u6307\u6a19\u306e1\u3064\uff1a\u3000tf-idf = TF x IDF  [\u7a4d]   \n\u30fbTF(Term Frequency): \u5358\u8a9e\u306e\u51fa\u73fe\u983b\u5ea6  \n\u30fbIDF(Inverse Document Frequency): \u5358\u8a9e\u306e\u5e0c\u5c11\u6027  \ntf-idf\u5024\u306e\u9ad8\u3044\u5358\u8a9e\u304c\u305d\u306e\u6587\u7ae0\u306e\u7279\u5fb4\u3068\u306a\u308a\u307e\u3059\u3002  \n\u4eca\u56de\u3067\u8a00\u3046\u3068\u3001\u4f3c\u305f\u30b2\u30fc\u30e0\u30bd\u30d5\u30c8\u306f\u3001tfidf \u306e\u6570\u5024\u914d\u5217\u3082\u8fd1\u3044\u3068\u3044\u3046\u4e8b\u3067\u3059\u3002  \n\"\u4f3c\u305f\u30b2\u30fc\u30e0\u30bd\u30d5\u30c8\u306f\u3001user_score\u304c\u8fd1\u3044\" \u50be\u5411\u304c\u3042\u308b\u306e\u3067\u3042\u308c\u3070\u3001\u7279\u5fb4\u91cf\u306btf-idf\u3092\u52a0\u3048\u3066\u30b9\u30b3\u30a2\u30a2\u30c3\u30d7\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002","93b5b55a":"## 2. Basic data check","8c4cff0d":"\u4e8b\u52d9\u5c40\u304b\u3089\u306e tfidf_code \u306e\u52df\u96c6\u3092\u898b\u3066\u3001\u30a2\u30c3\u30d7\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002  \n\u793e\u5185Kaggle\u30b3\u30f3\u30da\u30fb\u7b2c\uff11\u56de\u3067\u4e0a\u304c\u3063\u3066\u3044\u305f\u86f8\u4e95\u3055\u3093\u306e\u30b3\u30fc\u30c9\u3092\u898b\u672c\u306b\u3057\u3066\u3044\u307e\u3059\u3002  \n\u51e6\u7406\u6642\u9593\u306f\u3001\u4ed6\u306e\u81ea\u7136\u8a00\u8a9e\u51e6\u7406\u3068\u6bd4\u3079\u3066\u77ed\u3044\u65b9\u3067\u3059\u3002\uff08GPU-OFF\u3067\u3001\u5168\u90e8\u3067\u7d04\uff12\uff0c\uff13\u5206\uff09  \n\u66f4\u306b\u3001tfidf \u306e\u7d50\u679c\u3092 UMAP \u3092\u4f7f\u3063\u3066\uff12\u6b21\u5143\u306b\u53ef\u8996\u5316\u3057\u307e\u3057\u305f\u3002\uff08\u6563\u5e03\u56f3\u3092\u898b\u6613\u304f\u3059\u308b\u305f\u3081\u3001\u9014\u4e2d\u304b\u3089TEST\u30c7\u30fc\u30bf\u3092\u7701\u3044\u3066\u3044\u307e\u3059\uff09  \n\u305f\u3060\u3057\u3001tfidf \u306f\u3001\u65e2\u306bBaseline\u306b\u5165\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u306e\u610f\u7fa9\u306f\u3001\u591a\u5c11\u306e\u8a73\u3057\u3044\u8aac\u660e\u3068\u53ef\u8996\u5316\u306b\u306a\u308a\u307e\u3059\u3002\u3053\u306e\u5f8c\u306f\u3001BEAT \u3084 fastText \u3068\u6bd4\u8f03\u3057\u3066\u3001\u3069\u3061\u3089\u304c\u512a\u308c\u3066\u3044\u308b\u304b\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002","05a68fbe":"\u3010\u51e6\u7406\u306e\u6d41\u308c\u3011  \n1. tfidf \u8a08\u7b97  \n2. SVD \u3067\u6b21\u5143\u524a\u6e1b\u3057\u3001\u7279\u5fb4\u91cf\u4f5c\u6210\u3002  \n3. \u66f4\u306b UMAP \u3067\uff12\u6b21\u5143\u306b\u6b21\u5143\u524a\u6e1b\u5f8c\u3001\u53ef\u8996\u5316\u3002","11a1f5c3":"## 5. Visualization - UMAP","9d599f52":"## 4. Save_feather"}}