{"cell_type":{"19fae1b3":"code","b2e5bdaf":"code","591d2ded":"code","364b947d":"code","a8b53039":"code","cb60146c":"code","7a5cb2d0":"code","6ef9b28f":"code","c7fa69ff":"code","19a5675c":"code","bf8060aa":"code","9618c30f":"code","3a013708":"code","3d259ff4":"code","b8dc816e":"code","6700a963":"code","3590ebcf":"code","48b4f2c6":"code","a1897726":"code","aacb5bdf":"code","50bc8cc2":"code","ec59f276":"code","9164d5d5":"code","64c2c7f9":"code","dd5cd6f4":"code","122b940d":"markdown","061d14a9":"markdown"},"source":{"19fae1b3":"import numpy as np\nimport pandas as pd\nimport torch\nimport random\n\nrandom.seed(777)\ntorch.manual_seed(777)\ntorch.cuda.manual_seed_all(777)\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'","b2e5bdaf":"train = pd.read_csv('..\/input\/termprojectfoodwaste\/train.csv')\ntest = pd.read_csv('..\/input\/termprojectfoodwaste\/test.csv')\nsubmit = pd.read_csv('..\/input\/termprojectfoodwaste\/sample_submit.csv')","591d2ded":"train","364b947d":"from sklearn.preprocessing import LabelEncoder\nclassle = LabelEncoder()\nif test['\uc2dc\uad70\uad6c\uba85'].dtype == 'object' and train['\uc2dc\uad70\uad6c\uba85'].dtype == 'object':\n    classle.fit(pd.concat([train['\uc2dc\uad70\uad6c\uba85'], test['\uc2dc\uad70\uad6c\uba85']]))\n    train['\uc2dc\uad70\uad6c\uba85'] = classle.transform(train['\uc2dc\uad70\uad6c\uba85'])\n    test['\uc2dc\uad70\uad6c\uba85'] = classle.transform(test['\uc2dc\uad70\uad6c\uba85'])","a8b53039":"train_y = train['\ubc30\ucd9c\ub7c9(kg)']\ntrain_x = train.drop(['\ubc30\ucd9c\ub7c9(kg)','\ubc30\ucd9c\ub144\ub3c4'], axis =1)\ntest_x = test.drop(['\ubc30\ucd9c\ub144\ub3c4'], axis =1)","cb60146c":"train.\uc2dc\uad70\uad6c\uba85.unique()","7a5cb2d0":"def outlier_iqr(data):\n  q1, q3 = np.percentile(data, [10, 90])\n  iqr = q3-q1\n  lower = q1- (iqr*1.5)\n  upper = q3 + (iqr*1.5)  \n  return np.where((data > upper) | (data < lower))","6ef9b28f":"outlier0 = outlier_iqr(train_x.loc[train_x['\uc2dc\uad70\uad6c\uba85']==0]['\ubc30\ucd9c\ub7c9\ube44\uc728(%)'])[0]","c7fa69ff":"for i in range (1,28):\n    outlier1 = outlier_iqr(train_x.loc[train_x['\uc2dc\uad70\uad6c\uba85']==i]['\ubc30\ucd9c\ub7c9\ube44\uc728(%)'])[0]\n    outlier0 = np.concatenate([outlier0, outlier1], axis=0)","19a5675c":"outlier2 = outlier_iqr(train_x.loc[train_x['\uc2dc\uad70\uad6c\uba85']==0]['\ubc30\ucd9c\ud69f\uc218\ube44\uc728(%)'])[0]","bf8060aa":"for i in range (1,28):\n    outlier3 = outlier_iqr(train_x.loc[train_x['\uc2dc\uad70\uad6c\uba85']==i]['\ubc30\ucd9c\ud69f\uc218\ube44\uc728(%)'])[0]\n    outlier2 = np.concatenate([outlier2, outlier3], axis=0)","9618c30f":"outlier4 = outlier_iqr(train_x.loc[train_x['\uc2dc\uad70\uad6c\uba85']==0]['\ubc30\ucd9c\ud69f\uc218'])[0]","3a013708":"for i in range (1,28):\n    outlier5 = outlier_iqr(train_x.loc[train_x['\uc2dc\uad70\uad6c\uba85']==i]['\ubc30\ucd9c\ud69f\uc218'])[0]\n    outlier4 = np.concatenate([outlier4, outlier5], axis=0)","3d259ff4":"outlier_index = set(np.concatenate([outlier0, outlier2, outlier4], axis=0))","b8dc816e":"for i in outlier_index:\n  train_x = train_x.drop(index=i, axis = 0)\n  train_y= train_y.drop(index=i, axis = 0)","6700a963":"from sklearn.preprocessing import StandardScaler\n\nsc = StandardScaler()\ntrain_x_sc = sc.fit_transform(train_x)\ntest_x_sc= sc.transform(test_x)","3590ebcf":"train_x_tensor = torch.FloatTensor(np.array(train_x_sc)).to(device)\ntest_x_tensor = torch.FloatTensor(np.array(test_x_sc)).to(device)\ntrain_y_tensor = torch.FloatTensor(np.array(train_y.values).reshape(-1,1)).to(device)\n\n#train_x_tensor = torch.FloatTensor(np.array(train_x)).to(device)\n#test_x_tensor = torch.FloatTensor(np.array(test)).to(device)\n#train_y_tensor = torch.FloatTensor(np.array(train_y.values).reshape(-1,1)).to(device)","48b4f2c6":"class NN(torch.nn.Module):\n    def __init__(self):\n        super(NN, self).__init__()\n        self.linear1 = torch.nn.Linear(10, 56, bias = True)\n        self.linear2 = torch.nn.Linear(56, 56, bias = True)\n        self.linear3 = torch.nn.Linear(56, 56, bias = True)\n        self.linear4 = torch.nn.Linear(56, 56, bias = True)\n        self.linear5 = torch.nn.Linear(56, 56, bias = True)\n        self.linear6 = torch.nn.Linear(56, 56, bias = True)\n        self.linear7 = torch.nn.Linear(56, 1, bias = True)\n        self.relu = torch.nn.ReLU()\n        self.sigmoid = torch.nn.Sigmoid()\n    \n    def forward(self, x):\n        out = self.linear1(x)\n        out = self.relu(out)\n        out = self.linear2(out)\n        out = self.relu(out)\n        out = self.linear3(out)\n        out = self.relu(out)\n        out = self.linear4(out)\n        out = self.relu(out)\n        out = self.linear5(out)\n        out = self.relu(out)\n        out = self.linear6(out)\n        out = self.relu(out)\n        out = self.linear7(out)\n        return out\n    \nmodel = NN().to(device)","a1897726":"loss = torch.nn.MSELoss().to(device) #\ud68c\uadc0 \uc774\ubbc0\ub85c mseloss \uc0ac\uc6a9\noptimizer = torch.optim.Adam(model.parameters(), lr = 0.001)","aacb5bdf":"from sklearn.metrics import mean_squared_error\nfrom sklearn.metrics import mean_absolute_error","50bc8cc2":"from sklearn.metrics import r2_score\n\nmodel.train()\ntrain_epoch = 5000 #\uc804\ucc98\ub9ac \ucd94\uac00 \uc9c4\ud589 \ud6c4 epoch \uc99d\uac00\uc2dc\ud0a4\uba74\uc11c \ud559\uc2b5\uc2dc loss\uac00 \ub354 \uc791\uc544\uc9c0\ub294 \uacb0\uacfc\ub97c \uc5bb\uc5b4\uc11c \ubcc0\uacbd\nfor epoch in range(1,train_epoch + 1):\n    optimizer.zero_grad()\n    hypothesis = model(train_x_tensor)\n    \n    cost = loss(hypothesis, train_y_tensor)\n    cost.backward()\n    optimizer.step()\n    if epoch % 1000 == 0:\n        model.eval()\n        with torch.no_grad():\n            test_prediction = model(test_x_tensor)\n            train_prediction = model(train_x_tensor)\n            accuracy = r2_score(train_y, train_prediction.detach().cpu())\n            RMSE_train = mean_absolute_error(train_y, train_prediction.detach().cpu())\n            print('train_acc:', '{:.9f}'.format(accuracy), 'train_rmse:', '{:.9f}'.format(RMSE_train))","ec59f276":"model.eval()\nwith torch.no_grad():\n    prediction = model(test_x_tensor)","9164d5d5":"submit['\ubc30\ucd9c\ub7c9(kg)'] = prediction.detach().cpu().numpy()","64c2c7f9":"submit","dd5cd6f4":"submit.to_csv('submission.csv', index= False) #2429","122b940d":"\ucd94\uac00\ub41c \ubd80\ubd84\n====\n\uac01 \uc2dc\uad70\ubcc4 \ub370\uc774\ud130 \uc911\uc5d0\uc11c \ud2b9\uc815 \ub0a0\uc758 \ub370\uc774\ud130\uc14b\uc73c\ub85c\ub294 \uc54c \uc218 \uc5c6\ub294 \uc694\uc778\ub4e4\ub85c \uc778\ud574\uc11c \ud2b9\uc815 \ub0a0\uc758 \ubc30\ucd9c\uacfc \uad00\ub828\ub41c \ub370\uc774\ud130\uac00 \ubcc0\ud560 \uc218 \uc788\ub2e4\uace0 \uc0dd\uac01\ud588\uae30 \ub54c\ubb38\uc5d0 \uac01 \uc2dc\uad70\ubcc4 \ub370\uc774\ud130 \uc911 \ub108\ubb34 \ub9ce\uc774 \ubc30\ucd9c\ub418\uc5c8\uac70\ub098 \ub108\ubb34 \uc801\uac8c \ubc30\ucd9c\ub41c \uacbd\uc6b0\uc758 \ub370\uc774\ud130\ub97c \uc81c\uac70\ud558\uc5ec \ud559\uc2b5\uc744 \uc9c4\ud589\ud560 \uacbd\uc6b0 \ub354\uc6b1 \uc815\ud655\ud55c \uc608\uce21\uc774 \uac00\ub2a5\ud558\ub2e4\uace0 \ud310\ub2e8\ud558\uc600\uae30 \ub54c\ubb38\uc5d0 \ub2e4\uc74c\uacfc \uac19\uc740 \ucf54\ub4dc\ub97c \uc791\uc131\ud558\uc600\uc2b5\ub2c8\ub2e4.\n\n\uc5b4\ub290 \uc815\ub3c4\uae4c\uc9c0 outlier\ub85c \ubcf4\uace0 \uc81c\uac70\ub97c \ud560 \uac83\uc778\uc9c0 \uc9c1\uc811 \ubc94\uc704\ub97c \ubc14\uafb8\uba74\uc11c \uc608\uce21\uacb0\uacfc\ub97c \ubcf4\uba74\uc11c \uc9c4\ud589\ud558\uc600\uc2b5\ub2c8\ub2e4.  \n1. 25\/75\n2. 10\/90\n3. 5\/95\n\n\uc774\ub807\uac8c \uc138\uac00\uc9c0 \uacbd\uc6b0\ub85c \uc9c4\ud589\ud55c \uacb0\uacfc 2\ubc88\uc9f8 \uacbd\uc6b0\uc5d0\uc11c \uac00\uc7a5 \ub192\uc740 \uc131\ub2a5 \uac1c\uc120\uc774 \ub098\ud0c0\ub098 2\ubc88 \uac12\uc744 \uac00\uc9c0\uace0 \uc774\uc0c1\uce58 \uc81c\uac70\ub97c \uc9c4\ud589 \ud55c \ud6c4 \ud559\uc2b5\uc744 \ud558\uc600\uc2b5\ub2c8\ub2e4.","061d14a9":"\uc218\uc815 \ubc0f\ucd94\uac00\ub41c \ubd80\ubd84\n====\n\n\uc77c\uc790\ubcc4 \uc74c\uc2dd\ubb3c\uc4f0\ub808\uae30 \ubc30\ucd9c\ub7c9\uc5d0 \uc788\uc5b4\uc11c \uc911\uc694\ud55c \uac83\uc740 \uc8fc\uae30\uc131\uc5d0 \uad00\ud55c feature\ub4e4\uc744 \ub0a8\uae30\ub294 \uac83\uc774 \ub354 \ud6a8\uacfc\uc801\uc778 \uc608\uce21\uc744 \ud560 \uc218 \uc788\ub2e4\uace0 \uc0dd\uac01\ud558\uc600\uc2b5\ub2c8\ub2e4. \uadf8\ub798\uc11c \ubc30\ucd9c\ub144\ub3c4\uc5d0 \uad00\ud55c \ub370\uc774\ud130\ub294 \uc624\ud788\ub824 \uc815\ud655\ud55c \uc608\uce21\uc744 \ubc29\ud574\ud55c\ub2e4\uace0 \ud310\ub2e8\ud558\uc600\uae30 \ub54c\ubb38\uc5d0 train \ubc0f test\uc5d0\uc11c \uc81c\uac70\ud558\uc600\uc2b5\ub2c8\ub2e4."}}