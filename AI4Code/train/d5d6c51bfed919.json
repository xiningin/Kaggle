{"cell_type":{"b3f5db18":"code","5e2f0cc2":"code","d072f024":"code","4b95daee":"code","faf40ef9":"code","1d3c01b2":"code","397bdf79":"code","e47adbe8":"code","babe95a3":"code","e6fb2c6a":"code","d2a0120c":"code","bf8d9a72":"code","11d30fab":"code","23c39382":"code","8f3af000":"code","dec4126f":"code","ad5bd869":"code","3f474f17":"code","9c21ab97":"code","dbc7d8e4":"code","7ab41d5e":"code","81bb1f45":"code","9ed9f006":"code","a0ee6493":"code","a9f5370b":"code","01599b01":"code","8e5ad49e":"code","d862912e":"code","c6871273":"code","a6a70a86":"code","2c6bb241":"code","f3d6dd74":"code","a967b7ef":"code","3a124040":"code","4c5c15d8":"code","9c1768a8":"code","e839cc36":"code","d08f7253":"code","bd6d1612":"code","1aaa6dec":"code","9150646d":"code","9a37ad90":"code","826a91df":"code","ff398bcd":"code","b22c225b":"code","3de84986":"code","bd579e59":"code","304f5acf":"code","aa620c3c":"code","d47650f0":"code","43e4eba3":"code","288e2b33":"code","b60798fa":"code","5565cdd4":"code","ff7df95b":"code","161c5f59":"code","d8dddc07":"code","4f7ecb47":"code","d2d336b9":"code","2bfb8451":"code","8248f9f0":"code","321bd0af":"code","48501146":"code","c769f2a8":"code","8c2f261e":"code","e35dd51c":"markdown","29ed88ea":"markdown","dd7dde6e":"markdown","67ea6d71":"markdown","99bb5475":"markdown","730f1da1":"markdown","c1d6c91a":"markdown","f52071a3":"markdown","8361c989":"markdown","dfdc425e":"markdown","375effdb":"markdown","0094e9bd":"markdown","08a353e7":"markdown","e9bd0bc4":"markdown","ccc81b9e":"markdown","3d7b32fb":"markdown","ce452f2e":"markdown","eba52db0":"markdown","e62d0cb0":"markdown","4a88246c":"markdown","9eb0fc08":"markdown","bf096546":"markdown","83c5e4b1":"markdown","7067a2e3":"markdown","ec3daa34":"markdown","95f85dc1":"markdown","961df00b":"markdown","bf1f8275":"markdown","a1cb4f8b":"markdown","a140eb79":"markdown","09cea5ab":"markdown","2934e8ef":"markdown","d719ce3e":"markdown","9050aa53":"markdown","298b5d26":"markdown","74aa1a99":"markdown"},"source":{"b3f5db18":"import numpy as np\nimport pandas as pd\nimport os\nimport glob\nimport matplotlib\nimport matplotlib.pyplot as plt\nimport matplotlib.lines as lines\nimport seaborn as sns\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport wandb\nimport lightgbm as lgb\n\nfrom plotly.subplots import make_subplots\nfrom matplotlib_venn import venn2, venn2_circles\nfrom sklearn.model_selection import train_test_split \nfrom sklearn.linear_model import Ridge\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import KFold\nfrom sklearn.metrics import mean_squared_error\nfrom tqdm.notebook import tqdm","5e2f0cc2":"#set context to customize and style plots\nsns.set_context(\"poster\", font_scale = 0.6, rc={\"grid.linewidth\": 0.4})\n\n#set font family\nsns.set_style({'font.family':'serif'})","d072f024":"from kaggle_secrets import UserSecretsClient\nuser_secrets = UserSecretsClient()\napi_key = user_secrets.get_secret(\"api_key\")\n\nos.environ[\"WANDB_SILENT\"] = \"true\"","4b95daee":"! wandb login $api_key","faf40ef9":"path = '..\/input\/ncaaw-march-mania-2021-spread\/WDataFiles_Stage2_Spread' \nall_files = glob.glob(path + \"\/*.csv\")\n\ndf = {}\nli = []\n\nfor x in all_files:\n    name = x\n    name = name.split(\"\/\")[4]\n    name = name.split(\".\")[0]\n    b = f\"{x}\"\n    try:   \n        df_b = pd.read_csv(b)\n        df[name] = df_b\n    except:\n        df_b = pd.read_csv(b,encoding='cp1252')\n        df[name] = df_b\n    li.append(name)","1d3c01b2":"def display(i):\n    print(i)\n    return df[i].head(10)","397bdf79":"len(li)","e47adbe8":"display(li[0])","babe95a3":"display(li[1])","e6fb2c6a":"display(li[2])","d2a0120c":"display(li[3])","bf8d9a72":"display(li[4])","11d30fab":"display(li[5])","23c39382":"display(li[6])","8f3af000":"display(li[7])","dec4126f":"display(li[8])","ad5bd869":"display(li[9])","3f474f17":"display(li[10])","9c21ab97":"display(li[11])","dbc7d8e4":"display(li[12])","7ab41d5e":"display(li[13])","81bb1f45":"df['WTeams']['TeamID'].nunique()","9ed9f006":"new_teams = pd.DataFrame({\"Team ID\": [3468,3469,3470,3471]},\n                  index=[\"Bellarmine\",\"North Alabama\",\"Tarleton State\",\"UC_San Diego\"])\n\ncustom_colors = [\"#FFC8FB\",\"#9B287B\",\"#00B295\",\"#D5FFF3\"]\ncolormap = matplotlib.colors.LinearSegmentedColormap.from_list(\"\", custom_colors)\n\nfig = plt.figure(figsize=(12,8), facecolor=\"white\") \ngs = fig.add_gridspec(1,1)\ngs.update(wspace=0.1, hspace=0.5)\nax = fig.add_subplot(gs[0, :])\n\nsns.heatmap(new_teams,annot=True, fmt='g',cmap=colormap, linewidths=1.5,cbar=False,annot_kws={\"fontsize\":15})\n\nax.text(0.25,-0.4,'Teams that are new to Division 1',fontfamily='serif',fontsize=20,fontweight='bold')\n\nax.set_xticklabels(ax.get_xticklabels(), fontfamily='serif',fontsize=15,fontweight='bold')\nax.set_yticklabels(ax.get_yticklabels(), fontfamily='serif',rotation=0,fontsize=15,fontweight='bold')\n        \nplt.show()","a0ee6493":"df['WSeasons']['Season'].nunique()","a9f5370b":"run = wandb.init(project='ncaaw', name='count')\n\nb = df['WSeasons']['Season'].nunique()\nc = df['WTeams']['TeamID'].nunique()\n\nwandb.log({'No. of files in the data folder': len(li), \n           'No. of seasons :' : b,\n           'No. of unique teams' : c })\nrun.finish()","01599b01":"df['WNCAATourneySeeds']","8e5ad49e":"df['WNCAATourneySeeds']['Region'] = df['WNCAATourneySeeds']['Seed'].apply(lambda x: x[0][:1])\ndf['WNCAATourneySeeds']['Seed'] = df['WNCAATourneySeeds']['Seed'].apply(lambda x: int(x[1:3]))","d862912e":"df['WNCAATourneySeeds']","c6871273":"df['WNCAATourneySeeds'] = pd.merge(df['WNCAATourneySeeds'], df['WTeams'],on='TeamID')\ndf['WNCAATourneySeeds']","a6a70a86":"data = df['WNCAATourneySeeds'][df['WNCAATourneySeeds']['Seed'] ==1]['TeamName'].value_counts()[:10]\n\nfig = plt.gcf()\nfig.set_size_inches(12, 8)\nax = sns.barplot(x=data.index, y=data, \n       edgecolor='darkgray',\n       linewidth=0.6,palette=\"spring\")\n\nplt.title('Highest seeded teams', fontsize=15, fontweight='bold',horizontalalignment='center',fontfamily='serif')\nax.set_xticklabels(data.index, rotation=45,fontfamily='serif',fontsize=12) \nax.set(xlabel='Team Name', ylabel='count')\n\nplt.show()","2c6bb241":"run = wandb.init(project='ncaaw', job_type='image-visualization',name='seed')\n\ndata1 = df['WNCAATourneySeeds'][df['WNCAATourneySeeds']['Seed'] ==1]['TeamName'].value_counts()[:10]\nlabels = data1.index\nvalues = data1.values\ndt = [[label, val] for (label, val) in zip(labels, values)]\ntable = wandb.Table(data=dt, columns = [\"Team name\", \"Count\"])\nwandb.log({\"highest_seeded_teams\" : wandb.plot.bar(table, \"Team name\", \"Count\",title=\"Highest seeded teams\")})\n\nrun.finish()\n\nrun","f3d6dd74":"data = df['WNCAATourneySeeds'][df['WNCAATourneySeeds']['Seed'] ==16]['TeamName'].value_counts()[:10]\n\nfig = plt.gcf()\nfig.set_size_inches(12, 8)\nax = sns.barplot(x=data.index, y=data, \n       edgecolor='darkgray',\n       linewidth=0.6,palette=\"cool\")\n\nplt.title('Lowest seeded teams', fontsize=15, fontweight='bold',horizontalalignment='center',fontfamily='serif')\nax.set_xticklabels(data.index, rotation=45,fontfamily='serif',fontsize=12) \nax.set(xlabel='Team Name', ylabel='count')\n\nplt.show()","a967b7ef":"run = wandb.init(project='ncaaw', job_type='image-visualization',name='seed')\n\ndata2 = df['WNCAATourneySeeds'][df['WNCAATourneySeeds']['Seed'] ==16]['TeamName'].value_counts()[:10]\nlabels = data2.index\nvalues = data2.values\ndt = [[label, val] for (label, val) in zip(labels, values)]\ntable = wandb.Table(data=dt, columns = [\"Team name\", \"Count\"])\nwandb.log({\"lowest_seeded_teams\" : wandb.plot.bar(table, \"Team name\", \"Count\",title=\"Lowest seeded teams\")})\n\n\nrun.finish()\n\nrun","3a124040":"df['WNCAATourneyCompactResults']","4c5c15d8":"run = wandb.init(project='ncaaw', job_type='image-visualization',name='score_diff')\nfig = plt.gcf()\nfig.set_size_inches(14, 6)\n\nplt.hist(df['WNCAATourneyCompactResults']['WScore'],label=\"Winning Score\",color='#c5ffff',alpha=0.9)\nplt.hist(df['WNCAATourneyCompactResults']['LScore'],label=\"Losing Score\",color='#eca3fc',alpha=0.6)\nplt.title('Distribution of Winning and Losing Scores',fontsize=15, fontweight='bold',horizontalalignment='center',fontfamily='serif')\nplt.xlabel('')\nplt.ylabel('')\nplt.legend();\nplt.grid()\n\nwandb.log({\"Distribution of Winning and Losing Scores\": [wandb.Image(plt)]})\nrun.finish()\n\nrun","9c1768a8":"run = wandb.init(project='ncaaw', job_type='image-visualization',name='score_diff')\n\ndata3 = [[s] for s in df['WNCAATourneyCompactResults']['WScore']]\ntable1 = wandb.Table(data=data3, columns=[\"w_score\"])\n\ndata4 = [[s] for s in df['WNCAATourneyCompactResults']['LScore']]\ntable2 = wandb.Table(data=data4, columns=[\"l_score\"])\n\nwandb.log({'winning_score': wandb.plot.histogram(table1, \"w_score\",title=\"Winning Score Distribution\")})\nwandb.log({'losing_score': wandb.plot.histogram(table2, \"l_score\",title=\"Losing Score Distribution\")})\nrun.finish()\n\nrun","e839cc36":"data = df['WNCAATourneyCompactResults'].groupby('Season')[['WScore','LScore']].mean()\n\nfig = plt.gcf()\nfig.set_size_inches(16, 8)\n\nsns.lineplot(x=data.index,y=data['WScore'],color='#52D1DC',label=\"Winning Score\")\nsns.lineplot(x=data.index,y=data['LScore'],color='#d216d2',label=\"Losing Score\")\n\nplt.title('Distribution of Winning and Losing Scores Average' ,fontsize=15, fontweight='bold',horizontalalignment='center',fontfamily='serif')\nplt.xlabel('Season')\nplt.ylabel('Score')\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)\nplt.grid()\nplt.show()","d08f7253":"run = wandb.init(project='ncaaw', job_type='image-visualization',name='score_avg')\n\ndata = df['WNCAATourneyCompactResults'].groupby('Season')[['WScore','LScore']].mean()\n\ndata5 = [[x, y] for (x, y) in zip(data.index,data['WScore'])]\ntable1 = wandb.Table(data=data5, columns=[\"year\",\"w_score_avg\"])\n\ndata6 = [[x, y] for (x, y) in zip(data.index,data['LScore'])]\ntable2 = wandb.Table(data=data6, columns=[\"year\",\"l_score_avg\"])\n\nwandb.log({'winning_score_avg': wandb.plot.line(table1,\"year\",\"w_score_avg\",title=\"Winning Score Average\")})\nwandb.log({'losing_score_avg': wandb.plot.line(table2, \"year\",\"l_score_avg\",title=\"Losing Score Average\")})\nrun.finish()\n\nrun","bd6d1612":"fig, ax  = plt.subplots(figsize=(16, 8))\nfig.suptitle('Winning Location Distribution', size = 20, fontsize=15, fontweight='bold',horizontalalignment='center',fontfamily='serif')\nlabels = [\"Neutral\",\"Home\",\"Away\"]\nsizes = df['WNCAATourneyCompactResults']['WLoc'].value_counts()\nax.pie(sizes, explode=(0.05, 0.05, 0.2), colors=[\"#ffdf64\",\"#b98de8\",\"#ff74d4\"], startangle=60, labels=labels,autopct='%1.0f%%', pctdistance=0.6)\nax.add_artist(plt.Circle((0,0),0.4,fc='white'))\nplt.show()","1aaa6dec":"df['WNCAATourneyCompactResults'] = pd.merge(df['WNCAATourneyCompactResults'], df['WNCAATourneySeeds'], left_on=['Season', 'WTeamID'], right_on=['Season', 'TeamID'], how='left')\ndf['WNCAATourneyCompactResults'].rename(columns={'Seed':'WSeed'}, inplace=True)\ndf['WNCAATourneyCompactResults'] = df['WNCAATourneyCompactResults'].drop(columns=['Region','TeamID','DayNum','NumOT','TeamName'],axis=1)\n\ndf['WNCAATourneyCompactResults'] = pd.merge(df['WNCAATourneyCompactResults'], df['WNCAATourneySeeds'], left_on=['Season', 'LTeamID'], right_on=['Season', 'TeamID'], how='left')\ndf['WNCAATourneyCompactResults'].rename(columns={'Seed':'LSeed'}, inplace=True)\ndf['WNCAATourneyCompactResults'] = df['WNCAATourneyCompactResults'].drop(columns=['TeamName','Region'],axis=1)","9150646d":"df['WNCAATourneyCompactResults']","9a37ad90":"df_w_s = df['WNCAATourneyCompactResults'].copy()\ndf_l_s = df_w_s.copy()","826a91df":"def score_seed(df,a):\n    if a==1:\n        df['score_diff'] = df.WScore-df.LScore\n        df['seed_diff'] = df.WSeed-df.LSeed\n        df['result'] = 1\n    else:\n        df['score_diff'] = -(df.WScore-df.LScore)\n        df['seed_diff'] = -(df.WSeed-df.LSeed)\n        df['result'] = 0\n    return df","ff398bcd":"df_w_s = score_seed(df_w_s,1)\ndf_l_s = score_seed(df_l_s,0)","b22c225b":"train_df = pd.concat([df_w_s,df_l_s])","3de84986":"pairplot_df=train_df.copy()\npairplot_df['Season'] = pairplot_df['Season'].astype(str)\nfig = px.scatter_matrix(pairplot_df,\n    dimensions=['WScore','LScore','score_diff','WSeed','LSeed','Season'],\n    color=\"Season\",template=\"none\",color_discrete_sequence=px.colors.qualitative.Pastel)\nfig.show()","bd579e59":"fig = plt.gcf()\nfig.set_size_inches(16, 8)\nsns.kdeplot(data=train_df, x=\"score_diff\",color='#5bffdd',shade=True)\nplt.title('Distribution of difference in scores' ,fontsize=15, fontweight='bold',horizontalalignment='center',fontfamily='serif')\nplt.xlim(0, None);","304f5acf":"fig = plt.gcf()\nfig.set_size_inches(14, 6)\n\nd1 = train_df[train_df['WLoc'] == 'N']['score_diff']\nd2 = train_df[train_df['WLoc'] == 'H']['score_diff']\nd3 = train_df[train_df['WLoc'] == 'A']['score_diff']\n\nax = sns.histplot(d1,label=\"Neutral\",color='#EAC435',alpha=0.2,element=\"step\")\nax = sns.histplot(d2,label=\"Home\",color='#7353BA',alpha=0.2,element=\"step\")\nax = sns.histplot(d3,label=\"Away\",color='#FAA6FF',alpha=0.5,element=\"step\")\n\nplt.title('Distribution of difference in scores vs Winning Location',fontsize=15, fontweight='bold',horizontalalignment='center',fontfamily='serif')\nplt.xlim(0, None);\nax.set(xlabel='', ylabel='')\nplt.grid(axis = 'y')\nax.legend();","aa620c3c":"train_df = train_df.drop(columns=['TeamID','Season','WTeamID','LTeamID','WLoc'],axis=1)\ntrain_df","d47650f0":"df_w_sc = df['WRegularSeasonCompactResults'][['Season', 'WTeamID', 'WScore']]\ndf_l_sc = df['WRegularSeasonCompactResults'][['Season', 'LTeamID', 'LScore']]","43e4eba3":"df_w_sc.rename(columns={'WTeamID':'TeamID', 'WScore':'Score'}, inplace=True)\ndf_l_sc.rename(columns={'LTeamID':'TeamID', 'LScore':'Score'}, inplace=True)","288e2b33":"scores = pd.concat([df_w_sc,df_l_sc])","b60798fa":"test_df = df['WSampleSubmissionStage2']\ntest_df['Season'] = test_df['ID'].map(lambda x: int(x[:4]))\ntest_df['WTeamID'] = test_df['ID'].map(lambda x: int(x[5:9]))\ntest_df['LTeamID'] = test_df['ID'].map(lambda x: int(x[10:14]))","5565cdd4":"fig = plt.figure(figsize=(8,8))\n\nv1 = venn2(subsets = (3, 1, 2),\n          set_labels = ( '', '', ''),\n          set_colors=( 'lightcoral', 'linen'),\n           alpha=1)\nv1.get_patch_by_id('11').set_color('mistyrose')\nv1.get_patch_by_id('11').set_alpha(1)\n\nv2 = venn2_circles(subsets = (3, 1, 2),color='linen')\n\nplt.annotate('Included', xy=v1.get_label_by_id('10').get_position() - np.array([0, -0.05]), xytext=(-80,55),\nha='center', textcoords='offset points', \narrowprops=dict(arrowstyle='->', connectionstyle='arc3,rad=0.5',color='gray'))\n\nplt.annotate('Not included', xy=v1.get_label_by_id('01').get_position() - np.array([0, -0.05]), xytext=(70,60),\nha='center', textcoords='offset points', \narrowprops=dict(arrowstyle='->', connectionstyle='arc3,rad=-0.5',color='gray'))\n\nplt.annotate('Included', xy=v1.get_label_by_id('11').get_position() - np.array([0, -0.05]), xytext=(0,60),\nha='center', textcoords='offset points',\narrowprops=dict(arrowstyle='->', color='gray'))\n\nplt.text(1, 0.05, '''\nLeft Join clause returns \n- all the rows from the left table \n                AND                \n- matched records from the right table OR\n- returns Null if no matching record found. \n\n'''\n         , fontsize=12, fontweight='light', fontfamily='serif')\n\nl1 = lines.Line2D([1, 1], [0, 1], transform=fig.transFigure, figure=fig,color='black',lw=0.2)\nfig.lines.extend([l1])\n\nplt.title(\"Left join\",fontsize=15, fontweight='bold',horizontalalignment='center',fontfamily='serif')\nplt.show()","ff7df95b":"test_df = pd.merge(test_df, df['WNCAATourneySeeds'], left_on=['Season', 'WTeamID'], right_on=['Season', 'TeamID'], how='left')\ntest_df.rename(columns={'Seed':'WSeed'}, inplace=True)\ntest_df = test_df.drop(columns=['Region','TeamID','TeamName'],axis=1)\n\ntest_df = pd.merge(test_df, df['WNCAATourneySeeds'], left_on=['Season', 'LTeamID'], right_on=['Season', 'TeamID'], how='left')\ntest_df.rename(columns={'Seed':'LSeed'}, inplace=True)\ntest_df = test_df.drop(columns=['Region','TeamID','TeamName'],axis=1)","161c5f59":"ws=[]\nls=[]\nfor ii, row in test_df.iterrows():\n    t1 = test_df['WTeamID'][ii]\n    t2 = test_df['LTeamID'][ii]\n    year = test_df['Season'][ii]\n    w_score = scores[(scores.TeamID == t1) & (scores.Season == year)].Score.values[0]\n    l_score = scores[(scores.TeamID == t2) & (scores.Season == year)].Score.values[0]\n    ws.append(w_score)\n    ls.append(l_score)","d8dddc07":"test_df['WScore'] = ws\ntest_df['LScore'] = ls\n\ntest_df['score_diff'] = test_df.WScore - test_df.LScore\ntest_df['seed_diff'] = test_df.WSeed - test_df.LSeed","4f7ecb47":"train_df= train_df[['seed_diff','score_diff']]\ntest_df = test_df[['seed_diff']]","d2d336b9":"X = train_df['seed_diff'].values.reshape(-1, 1)\ny = train_df['score_diff']","2bfb8451":"train_oof = np.zeros((X.shape[0],))\ntest_preds = 0","8248f9f0":"def train_plot_regressor(model,name,v_ll,v_mll):\n    run = wandb.init(project='ncaaw', name=name+\" with KFold\")\n\n    mse_l = []\n    NUM_FOLDS = 10\n    kf = KFold(n_splits=NUM_FOLDS, shuffle=True, random_state=0)\n\n    for f, (trn_idx, val_idx) in tqdm(enumerate(kf.split(X, y))):\n            print('\\nFold {}'.format(f))\n            X_train, X_val = X[trn_idx], X[val_idx]\n            y_train, y_val = y.iloc[trn_idx], y.iloc[val_idx]\n\n            model = model\n            model.fit(X_train, y_train)\n            temp_oof = model.predict(X_val)\n            temp_test = model.predict(test_df)\n            \n            wandb.sklearn.plot_regressor(model, X_train, X_val, y_train, y_val)\n            \n            test_preds = 0\n            train_oof[val_idx] = temp_oof\n            test_preds += temp_test\/NUM_FOLDS\n\n            mse = mean_squared_error(y_val, temp_oof, squared=False)\n            mse_l.append(mse)\n            print(\"MSE: \",mse)\n            \n    mean_mse = np.mean(mse_l, axis=0)\n    v_mse_l.append(mse_l)\n    v_mean_mse.append(mean_mse)\n    print(\"\\nMean MSE of \",name,mean_mse)\n    run.finish()\n    return v_mse_l,v_mean_mse","321bd0af":"v_mse_l = []\nv_mean_mse = []\n\nv_mse_l,v_mean_mse = train_plot_regressor(Ridge(),'Ridge',v_mse_l,v_mean_mse)\nv_mse_l,v_mean_mse = train_plot_regressor(KNeighborsRegressor(n_neighbors=99),'K Neighbors Regressor',v_mse_l,v_mean_mse)\nv_mse_l,v_mean_mse = train_plot_regressor(RandomForestRegressor(random_state =21),'Random Forest Regressor',v_mse_l,v_mean_mse)\nv_mse_l,v_mean_mse = train_plot_regressor(lgb.LGBMRegressor(),'LGBM Regressor',v_mse_l,v_mean_mse)","48501146":"run = wandb.init(project='ncaaw', job_type='image-visualization',name='Mean MSE')\nvalues = v_mean_mse\nlabels = [\"Ridge\",\"K Neighbors Regressor\",\"Random Forest Regressor\",\"LGBM Regressor\"]\ndt = [[label, val] for (label, val) in zip(labels, values)]\ntable = wandb.Table(data=dt, columns = [\"Model name\", \"Mean MSE\"])\nwandb.log({\"Mean MSE\" : wandb.plot.bar(table,\"Model name\", \"Mean MSE\",title=\"Mean MSE of models\")})\n\nrun.finish()\n\nrun","c769f2a8":"def train_all(model):\n    \n    #fit model on entire training data\n    model.fit(X, y)        \n    \n    #test predictions\n    test_preds = model.predict(test_df)\n    \n    return test_preds\n\n#choosing LGBM Regressor as the baseline model\ntest_preds = train_all(lgb.LGBMRegressor())","8c2f261e":"df_submission = pd.read_csv(\"..\/input\/ncaaw-march-mania-2021-spread\/WDataFiles_Stage2_Spread\/WSampleSubmissionStage2.csv\")\ndf_submission['Pred'] = test_preds\ndf_submission.to_csv('\/kaggle\/working\/Predictions.csv',index=False)","e35dd51c":"<div>\n    <img src=\"https:\/\/i.imgur.com\/1X95zGn.png\">\n <\/div>","29ed88ea":">Here's a glimpse of the dataframes \ud83d\udd0d","dd7dde6e":"> Logging an **image** for Distribution of Winning and Losing Scores\ud83c\udfcb\ufe0f\u200d\u2640\ufe0f","67ea6d71":"<center><h1>Model training \ud83d\udee0\ufe0f<\/h1><\/center>","99bb5475":"> To find the exact date a game was played on, we can combine the game's \n> * \"DayNum\" from WNCAATourneyCompactResults \ud83d\udd1d \n> * and the season's \"DayZero\" from WSeasons \u2b07\ufe0f","730f1da1":"> Logging a **dictionary of custom objects** \ud83c\udfcb\ufe0f\u200d\u2640\ufe0f","c1d6c91a":"[Documentation](https:\/\/pypi.org\/project\/matplotlib-venn\/)","f52071a3":"> \ud83c\udfc0 A **seed** in basketball is the number which corresponds to a team's ranking.\n> \n> This is done to prevent high-ranking teams from playing together in the beginning of the competition and to encourage healthy competition!","8361c989":"<center><h1>Importing libraries\ud83d\udcda<\/h1><\/center>","dfdc425e":"> Super excited to integrate W&B for visualizations and tracking model performance!\n\n> [NCAAW Project on W&B Dashboard](https:\/\/wandb.ai\/ruchi798\/ncaaw?workspace=user-ruchi798)  \ud83c\udfcb\ufe0f\u200d\u2640\ufe0f ","375effdb":"<center><h1>EDA \ud83d\udcca<\/h1><\/center>","0094e9bd":"> Tourney Seeds and Scores","08a353e7":"Merging dataframes to get desired columns in one place","e9bd0bc4":"Inspiration:\n* [Netflix Data Visualization](https:\/\/www.kaggle.com\/joshuaswords\/netflix-data-visualization)\n* [Trends in 2020 with Advice from Top Kagglers](https:\/\/www.kaggle.com\/iamleonie\/trends-in-2020-with-advice-from-top-kagglers)\n\nIllustrations tools:\n\n- [Canva](https:\/\/www.canva.com\/) \ud83d\udd8c\ufe0f","ccc81b9e":"> \ud83c\udfc0 **Slot** - uniquely identifies one of the tournament games\n> First two characters: Round of the game\n> Second two characters: Expected seed of the favored team \n> \n> \ud83c\udfc0 **StrongSeed** - the expected stronger-seeded team that plays in this game\n> \n> \ud83c\udfc0 **WeakSeed** - the expected weaker-seeded team that plays in this game","3d7b32fb":"- To get the API key, an account is to be created on the [website](https:\/\/wandb.ai\/site) first.\n- Next, use secrets to use API Keys more securely\ud83e\udd2b","ce452f2e":"> Let's separate the region and seed into different columns.","eba52db0":"<img src=\"https:\/\/i.imgur.com\/wmcVZDC.png\">","e62d0cb0":"<center><h1>Reading and displaying csv files \ud83d\udcd6<\/h1><\/center>","4a88246c":"<center><h3><a href=\"https:\/\/www.ncaa.com\/brackets\/basketball-women\/d1\/2021\">NCAA bracket for the 2021 Division I Women's basketball tournament Official Bracket<\/a><\/h3><\/center>\n<img src=\"https:\/\/i.imgur.com\/Axcz5YO.png\" class=\"center\">","9eb0fc08":"> During my first glance at the competition data, I noticed a huge number of files in the dataset.\n> \n> Learning more about the game was essential to understand the data for this competition and the [NCAA Tournament Glossary](https:\/\/www.ncaa.com\/news\/basketball-men\/article\/2019-04-03\/march-madness-terms-ncaa-tournament-dictionary) came in handy for this purpose\u2728","bf096546":"> Since we have many csv files, I've written a code block to read multiple csv files and store them in a dictionary.","83c5e4b1":"**\ud83c\udfafGoal:**\n\n> - `Stage 1` - To predict and submit predicted point spread for every possible matchup in the past 5 NCAA tournaments (seasons 2015-2019).\n> \n> - `Stage 2` - To predict and submit predicted point spread for every possible matchup before the 2021 tournament begins.","7067a2e3":"**Home advantage \ud83c\udfe0** \u2013 describes the benefit that the home team is said to gain over the visiting team. This benefit has been attributed to psychological effects supporting fans have on the competitors or referees; to psychological or physiological advantages of playing near home in familiar situations; to the disadvantages away teams suffer from changing time zones or climates, or from the rigors of travel; and in some sports, to specific rules that favor the home team directly or indirectly. \n\n[Reference](https:\/\/en.wikipedia.org\/wiki\/Home_advantage)","ec3daa34":"> Logging **histograms** for Distribution of Winning and Losing Scores\ud83c\udfcb\ufe0f\u200d\u2640\ufe0f","95f85dc1":"> \ud83d\udccc **Special note about \"Season\" numbers**: \n\n> The season year is the year in which the season ends in, not the year that it starts in. \n> \n> Thus the Current season is:\n> - the 2021 season \u2705\n> - and not the 2020 season\/2020-2021 season\/ 2020-21 season\u274c","961df00b":"> There are 369 unique teams in this dataset.","bf1f8275":"> Logging sklearn plots to **visualize model performance** \ud83c\udfcb\ufe0f\u200d\u2640\ufe0f","a1cb4f8b":"> Logging a **custom line plot** for Winning Score and Losing Score Average\ud83c\udfcb\ufe0f\u200d\u2640\ufe0f","a140eb79":"> Logging a **custom bar chart** for Highest Seeded Teams\ud83c\udfcb\ufe0f\u200d\u2640\ufe0f","09cea5ab":"Here's a snapshot of my [project](https:\/\/wandb.ai\/ruchi798\/ncaaw?workspace=user-ruchi798) \u2b07\ufe0f\n\n<img src=\"https:\/\/i.imgur.com\/FYoTeYp.png\">","2934e8ef":"> Total number of seasons in this dataset are 24.","d719ce3e":"> Logging a **custom bar chart** for Lowest Seeded Teams\ud83c\udfcb\ufe0f\u200d\u2640\ufe0f","9050aa53":"<center><h1>Creating a submission file \ud83d\udd16<\/h1><\/center>","298b5d26":"<img src=\"https:\/\/i.imgur.com\/pl3FhXV.png\">","74aa1a99":"<img src=\"https:\/\/camo.githubusercontent.com\/dd842f7b0be57140e68b2ab9cb007992acd131c48284eaf6b1aca758bfea358b\/68747470733a2f2f692e696d6775722e636f6d2f52557469567a482e706e67\">"}}