{"cell_type":{"8ff2648a":"code","6894847c":"code","db95d478":"code","d85361be":"code","b164e5ac":"code","54d6d07e":"code","53beaa0a":"code","268bf7b6":"code","2c862352":"code","134eb405":"markdown","063ed1b2":"markdown"},"source":{"8ff2648a":"import json\nimport os\n\nimport numpy as np\nimport pandas as pd\nimport seaborn as sn\nimport matplotlib.pyplot as plt\nimport cv2\nimport albumentations as A\nfrom sklearn import metrics as sk_metrics\n\nBASE_DIR = \"..\/input\/cassava-leaf-disease-classification\/\"\nsn.set_style('whitegrid')","6894847c":"with open(os.path.join(BASE_DIR, 'label_num_to_disease_map.json')) as file:\n    id2label = json.loads(file.read())\n    id2label = {int(k) : v for k, v in id2label.items()}\n    \nid2label","db95d478":"train_df = pd.read_csv(BASE_DIR+'train.csv')\ntrain_df","d85361be":"train_df['class_name'] = train_df.label.map(id2label)\ntrain_df","b164e5ac":"sn.countplot(y='class_name', data=train_df)","54d6d07e":"def visualize_batch(image_ids, labels):\n    plt.figure(figsize=(16, 12))\n    \n    for ind, (image_id, label) in enumerate(zip(image_ids, labels)):\n        plt.subplot(3, 3, ind + 1)\n        image = cv2.imread(os.path.join(BASE_DIR, \"train_images\", image_id))\n        image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)\n\n        plt.imshow(image)\n        plt.title(f\"Class: {label}\", fontsize=12)\n        plt.axis(\"off\")\n    \n    plt.show()","53beaa0a":"id2label","268bf7b6":"class_id = 1\ntmp_df = train_df.loc[train_df.label==class_id].sample(9)\nimage_ids = tmp_df[\"image_id\"].values\nlabels = tmp_df[\"class_name\"].values\n\nvisualize_batch(image_ids, labels)","2c862352":"df_sub = pd.read_csv('..\/input\/cassava-leaf-disease-classification\/sample_submission.csv', index_col=0)\ndf_sub['label'] = 3\ndf_sub.to_csv('submission.csv')","134eb405":"## Augmentation","063ed1b2":"## Submission"}}