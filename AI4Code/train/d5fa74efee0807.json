{"cell_type":{"b2cce28e":"code","70a399ca":"code","50e736e6":"code","adba2146":"code","8db3cb23":"code","7380d68b":"code","83556801":"code","cb3e72b2":"code","266c73fb":"code","6733fa5b":"code","b872e5aa":"code","e5da780e":"code","6fb552a2":"code","9962cb38":"code","662d3dbc":"markdown","022d7220":"markdown","079691e2":"markdown"},"source":{"b2cce28e":"import numpy as np\nimport pandas as pd \nimport os","70a399ca":"#\u30c7\u30fc\u30bf\u8aad\u307f\u8fbc\u307f\nos.listdir('..\/input')\nsales_data = pd.read_csv('..\/input\/sales_train.csv')\nitem_cat = pd.read_csv('..\/input\/item_categories.csv')\nitems = pd.read_csv('..\/input\/items.csv')\nshops = pd.read_csv('..\/input\/shops.csv')\nsample_submission = pd.read_csv('..\/input\/sample_submission.csv')\ntest_data = pd.read_csv('..\/input\/test.csv')\n","50e736e6":"def basic_eda(df):\n    print(\"----------TOP 5 RECORDS--------\")\n    print(df.head(5))\n    print(\"----------INFO-----------------\")\n    print(df.info())\n    print(\"----------Describe-------------\")\n    print(df.describe())\n    print(\"----------Columns--------------\")\n    print(df.columns)\n    print(\"----------Data Types-----------\")\n    print(df.dtypes)\n    print(\"-------Missing Values----------\")\n    print(df.isnull().sum())\n    print(\"-------NULL values-------------\")\n    print(df.isna().sum())\n    print(\"-----Shape Of Data-------------\")\n    print(df.shape)\n    \n    ","adba2146":"#Litle bit of exploration of data\n\nprint(\"=============================Sales Data=============================\")\nbasic_eda(sales_data)\nprint(\"=============================Test data=============================\")\nbasic_eda(test_data)\nprint(\"=============================Item Categories=============================\")\nbasic_eda(item_cat)\nprint(\"=============================Items=============================\")\nbasic_eda(items)\nprint(\"=============================Shops=============================\")\nbasic_eda(shops)\nprint(\"=============================Sample Submission=============================\")\nbasic_eda(sample_submission)\n\n","8db3cb23":"#'date'\u304cobject\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u76f4\u3059\nsales_data['date'] = pd.to_datetime(sales_data['date'],format = '%d.%m.%Y')","7380d68b":"#\u6708\u6b21\u306e\u58f2\u4e0a\u30c7\u30fc\u30bf\u304c\u6b32\u3057\u3044\u306e\u3067\u6a2a\u306bdate_block_num\uff08\u6708\uff09\u3092\u3001\u7e26\u306bshop_id,item_id,item_cnt_day\uff08\u65e5\u6b21\u306e\u58f2\u4e0a\uff09\ndataset = sales_data.pivot_table(index = ['shop_id','item_id'],values = ['item_cnt_day'],columns = ['date_block_num'],fill_value = 0,aggfunc='sum')\ndataset.reset_index(inplace = True)\ndataset.head()","83556801":"#\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3068merge\ndataset = pd.merge(test_data,dataset,on = ['item_id','shop_id'],how = 'left')","cb3e72b2":"# \u6b20\u640d\u5024\u3092\uff10\u306b\ndataset.fillna(0,inplace = True)\ndataset.head()","266c73fb":"# shop_id\u3068item_id\u306f\u3044\u3089\u306a\u3044\u306e\u3067\u843d\u3068\u3059\ndataset.drop(['shop_id','item_id','ID'],inplace = True, axis = 1)\ndataset.head()","6733fa5b":"# \u6700\u7d42\u6708\u3092\u9664\u3044\u305f\u6708\u304b\u3089\u3001 \nX_train = np.expand_dims(dataset.values[:,:-1],axis = 2)\n# \u6700\u7d42\u6708\u3092\u6c42\u3081\u308b\ny_train = dataset.values[:,-1:]\n\n# \u30c6\u30b9\u30c8\u3067\u306f\u6700\u521d\u306e\u6708\u3060\u3051\u7701\u304f\nX_test = np.expand_dims(dataset.values[:,1:],axis = 2)\n\nprint(X_train.shape,y_train.shape,X_test.shape)\n","b872e5aa":"# \u30e9\u30a4\u30d6\u30e9\u30ea\u30a4\u30f3\u30dd\u30fc\u30c8\nfrom keras.models import Sequential\nfrom keras.layers import LSTM,Dense,Dropout","e5da780e":"# \u30e2\u30c7\u30eb\u3092\u5b9a\u7fa9\nmy_model = Sequential()\nmy_model.add(LSTM(units = 64,input_shape = (33,1)))\nmy_model.add(Dropout(0.4))\nmy_model.add(Dense(1))\n\nmy_model.compile(loss = 'mse',optimizer = 'adam', metrics = ['mean_squared_error'])\nmy_model.summary()\n","6fb552a2":"my_model.fit(X_train,y_train,batch_size = 2048,epochs = 5)","9962cb38":"#\u63d0\u51fa\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\nsubmission_pfs = my_model.predict(X_test)\nsubmission_pfs = submission_pfs.clip(0,20)\nsubmission = pd.DataFrame({'ID':test_data['ID'],'item_cnt_month':submission_pfs.ravel()})\nsubmission.to_csv('sub_pfs.csv',index = False)\n","662d3dbc":"\u30c7\u30fc\u30bf\n1. date - every date of items sold\n2. date_block_num - this number given to every month\n3. shop_id - unique number of every shop\n4. item_id - unique number of every item\n5. item_price - price of every item\n6. item_cnt_day - number of items sold on a particular day \n\n\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\n1. ID - unique for every (shop_id,item_id) pair.\n2. shop_id - unique number of every shop\n3. item_id - unique number of every item\n\n\u6765\u6708\u3001\u305d\u308c\u305e\u308c\u306eshop\u304b\u3089\u3069\u308c\u3060\u3051item\u304c\u58f2\u308c\u305f\u304b\nID\u3068item_cnt_month\n\n\u30a2\u30d7\u30ed\u30fc\u30c1\n\u7279\u5fb4\u91cf\uff1a\u6700\u7d42\u6708\u3092\u9664\u3044\u305f\uff11\u30f6\u6708\u306b\u58f2\u308c\u305fitem\u91cf\n\u30c6\u30b9\u30c8\u3067\u306f\u6700\u521d\u306e\u6708\u3092\u9664\u304f\n","022d7220":"**\u30d0\u30c3\u30c1\u30b5\u30a4\u30ba\u3001\u30a8\u30dd\u30c3\u30af\u6570**\n\nhttps:\/\/qiita.com\/kenta1984\/items\/bad75a37d552510e4682","079691e2":"**RNN\u3068LSTM**\n\n\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306e\u89e3\u6790\u304c\u53ef\u80fd\n\nhttps:\/\/www.renom.jp\/ja\/notebooks\/tutorial\/basic_algorithm\/LSTM\/notebook.html"}}