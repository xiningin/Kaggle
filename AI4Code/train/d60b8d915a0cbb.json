{"cell_type":{"47b742df":"code","22a5b15f":"code","75a69da1":"code","46d749f7":"code","7414162b":"code","734f27a8":"code","3da424ff":"code","1230029d":"code","573bdc90":"code","b95f2499":"code","60726eba":"code","77be3cb7":"code","a1e808e7":"code","a8c8efbf":"code","40031763":"code","f99b7bb2":"code","20d6bedb":"code","fcd1cb59":"code","de7b1bcd":"code","023060ea":"code","2a6a8518":"code","f6941472":"code","e5ee267a":"code","0e846c1d":"code","37533e7f":"code","f170845c":"code","53bfaca7":"code","1903e6f8":"code","22c7afca":"code","25f67a64":"markdown","e7c05c02":"markdown","fd2a0ae1":"markdown","57d8a94d":"markdown","183472be":"markdown","56167563":"markdown","d2840531":"markdown","7353bcab":"markdown","e1efb055":"markdown","5c9362f7":"markdown","9b6835a4":"markdown","d89d7e1d":"markdown","28bbeec5":"markdown","04899493":"markdown"},"source":{"47b742df":"# Import libraries \nimport numpy as np \nimport pandas as pd\nimport missingno as msno\nfrom scipy import stats\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Suppress warnings \nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","22a5b15f":"# Load the data \ntrain = pd.read_csv('..\/input\/siim-isic-melanoma-classification\/train.csv')\ntest = pd.read_csv('..\/input\/siim-isic-melanoma-classification\/test.csv')\nsample_submission = pd.read_csv('..\/input\/siim-isic-melanoma-classification\/sample_submission.csv')","75a69da1":"# Rename the columns \nnew_names = ['image_name', 'patient_ID', 'sex', 'age', 'anatomy', 'diagnosis', 'benign_malignant', 'target']\ntrain.columns = new_names\ntest.columns = new_names[:5]","46d749f7":"# Print a concise summary of the DataFrame\nprint('Train:', train.info(),'\\n')\nprint('Test:', test.info())","7414162b":"# Print the dimensionality of the DataFrame\nprint('Train:', train.shape)\nprint('Test :',test.shape)","734f27a8":"# Print the columns' names \nprint('Train:', train.columns,'\\n')\nprint('Test:', test.columns)","3da424ff":"# Observe the index values\ntrain.head()","1230029d":"test.head()","573bdc90":"# The data type of each column\nprint('Train:', train.dtypes,'\\n')\nprint('Test:', test.dtypes)","b95f2499":"# The unique IDs\nprint(f\"The total patient IDs are {train['patient_ID'].count()}, from those the unique IDs are {train['patient_ID'].value_counts().shape[0]} \")","60726eba":"# Total number of images in the dataset(train+test)\nprint(\"Total images in Train set: \",train['image_name'].count())\nprint(\"Total images in Test set: \",test['image_name'].count())","77be3cb7":"print('Train:', train.isna().sum(),'\\n')\nprint('Test:', test.isna().sum())","a1e808e7":"# Missing data visualization\n\nf, (ax1, ax2) = plt.subplots(1, 2, figsize = (16, 6))\n\nmsno.matrix(train, ax = ax1, fontsize=10)\nmsno.matrix(test, ax = ax2, fontsize=10)\n\nax1.set_title('Train Missing Values', fontsize = 16)\nax2.set_title('Test Missing Values', fontsize = 16);","a8c8efbf":"train['sex'].value_counts()","40031763":"train['sex'].mode()","f99b7bb2":"# Impute the missing values with the mode \ntrain['sex'].fillna(train['sex'].mode()[0], inplace=True)","20d6bedb":"age_median = int(train['age'].median())\nprint('Median:', age_median)\nage_mean = int(train['age'].mean())\nprint('Mean:', age_mean)","fcd1cb59":"# Impute the missing values with the median\ntrain['age'] = train['age'].fillna(age_median)","de7b1bcd":"# Fill the missing data in anatomy with 'unknown'\ntrain['anatomy'].fillna('unknown', inplace=True)\ntest['anatomy'].fillna('unknown', inplace=True)","023060ea":"# The sex in each dataset\nfig, ax = plt.subplots(1,2,figsize=(15,5));\n#train\nsns.countplot(train['sex'], ax=ax[0]);\nax[0].set_title('sex count of Train');\n#test\nsns.countplot(test['sex'], ax=ax[1]);\nax[1].set_title('sex count of Test');","2a6a8518":"# Gender vs Target\ntarget_sex = train.groupby(['target','sex'])['benign_malignant'].count().to_frame().reset_index()\ntarget_sex.style.background_gradient() ","f6941472":"sns.catplot(x='target',y='benign_malignant', hue='sex',data=target_sex,kind='bar')\nplt.ylabel('Count')\nplt.xlabel('benign:0 vs malignant:1');","e5ee267a":"# Age distribution\nfig, ax = plt.subplots(1,2,figsize=(17,6))\n#train\nsns.countplot(train['age'], ax=ax[0]);\nlabel = ax[0].get_xticklabels();\nax[0].set_xticklabels(label, rotation=50);\nax[0].set_title('Train age distribution');\n#test\nsns.countplot(test['age'], ax=ax[1]);\nlabel = ax[1].get_xticklabels();\nax[1].set_xticklabels(label, rotation=50);\nax[1].set_title('Test age distribution');","0e846c1d":"# Count The anatomy location imaged site for each dataset\nfig, ax = plt.subplots(1,2, figsize=(17,6));\n#train\nsns.countplot(train['anatomy'].sort_values(), ax=ax[0]);\nlabel = ax[0].get_xticklabels();\nax[0].set_xticklabels(label, rotation=50);\nax[0].set_title('Train imaged site');\n#test\nsns.countplot(test['anatomy'].sort_values(), ax=ax[1]);\nlabel = ax[1].get_xticklabels();\nax[1].set_xticklabels(label, rotation=50);\nax[1].set_title('Test imaged site');","37533e7f":"# sex vs. anatomy\nsex_anatomy = train.groupby(['sex','anatomy'])['benign_malignant'].count().to_frame().reset_index();\nsns.catplot(x='anatomy',y='benign_malignant', hue='sex',data=sex_anatomy,kind='bar');\nplt.xlabel('Location of imaged site');\nplt.xticks(rotation=90,fontsize='10');\nplt.ylabel('Count of melanoma cases');","f170845c":"# Count benign and malignant\nfig, ax = plt.subplots(figsize=(10,6))\nsns.countplot(train['benign_malignant']);","53bfaca7":"# Visualizing a random selection of images\n\nimages = train['image_name'].values\n\n# Extract 9 random images from it\nrandom_images = [np.random.choice(images+'.jpg') for i in range(9)]\n\n# Location of the image dirictory \nIMAGE_PATH = \"..\/input\/siim-isic-melanoma-classification\/\"\nimg_dir = IMAGE_PATH+'\/jpeg\/train'\n\nprint('Display Random Images')\n\n# Adjust the size of your images\nplt.figure(figsize=(10,8))\n\n# Iterate and plot random images\nfor i in range(9):\n    plt.subplot(3, 3, i + 1)\n    img = plt.imread(os.path.join(img_dir, random_images[i]))\n    plt.imshow(img, cmap='gray')\n    plt.axis('off')\n    \n# Adjust subplot parameters to give specified padding\nplt.tight_layout()   ","1903e6f8":"# Visualizing Images with benign lesions\n\nbenign = train[train['benign_malignant']=='benign']\nmalignant = train[train['benign_malignant']=='malignant']\n\nimages = benign['image_name'].values\nrandom_images = [np.random.choice(images+'.jpg') for i in range(9)]\nimg_dir = IMAGE_PATH+'\/jpeg\/train'\n\nprint('Display benign Images')\n\nplt.figure(figsize=(10,8))\nfor i in range(9):\n    plt.subplot(3, 3, i + 1)\n    img = plt.imread(os.path.join(img_dir, random_images[i]))\n    plt.imshow(img, cmap='gray')\n    plt.axis('off')\n    \nplt.tight_layout() ","22c7afca":"# Visualizing Images with Malignant lesions\n\nimages = malignant['image_name'].values\nrandom_images = [np.random.choice(images+'.jpg') for i in range(9)]\nimg_dir = IMAGE_PATH+'\/jpeg\/train'\n\nprint('Display malignant Images')\n\nplt.figure(figsize=(10,8))\nfor i in range(9):\n    plt.subplot(3, 3, i + 1)\n    img = plt.imread(os.path.join(img_dir, random_images[i]))\n    plt.imshow(img, cmap='gray')\n    plt.axis('off')\n    \nplt.tight_layout()  ","25f67a64":"# Melanoma Image Classification","e7c05c02":"### Missing Data:","fd2a0ae1":"### Train: AGE Variable","57d8a94d":"### Train: SEX Variable","183472be":"## Dealing with the missing data","56167563":"### Train & Test: ANATOMY Variable","d2840531":"## Data Exploration","7353bcab":"### Objective: \nThe purpose of this project is to identify Melanoma cases in images of skin lesions. In particular, we need to create a model that predicts the probability whether the lesion is malignant or benign.","e1efb055":"### Data cleaning","5c9362f7":"The number of unique patients is less than the total number of patients. Which means, several patients have multiple records.","9b6835a4":"## Images Visualization","d89d7e1d":"### Data Overview:\n**The dataset consists of images in :**\n- DIOCOM format\n- JPEG format in JPEG directory\n- TFRecord format in tfrecords directory\n- A metadata comprising of train, test and submission file in CSV format.","28bbeec5":"**Train**:\n- `sex`: 65 missing values (0.2% of the total data)\n- `age`: 68 missing values (correspond with sex missingness)\n- `anatomy`: 527 missing values (1.59% of the total data)\n\n**Test**:\n- `anatomy`: 351 missing values (3.1% of the total data)","04899493":"The mean and median of `age` variable has the same value of 50, while the mode is 45. The distribution is normal, so we'll use the MEDIAN to impute. "}}