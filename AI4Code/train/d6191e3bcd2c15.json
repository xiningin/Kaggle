{"cell_type":{"c3493de8":"code","36e1c0f6":"code","3084408a":"code","6e97e437":"code","e15c68f5":"code","09d82689":"code","2548c85d":"code","69a91138":"code","f4714918":"code","b9603f22":"code","1b6ad900":"code","163427d3":"code","6da9734e":"code","b4e4519d":"code","ded6b2e6":"code","2256890b":"code","f8540d86":"code","b82a5c05":"code","725de648":"code","1a841fcc":"code","c3738b5e":"code","37f692d6":"code","51ce238e":"code","48724dcd":"markdown","a9bc8333":"markdown","72362e5e":"markdown","859e152f":"markdown","0d50bb84":"markdown","813a934e":"markdown","b2f9a086":"markdown","f286248e":"markdown","4f631e07":"markdown","f6605713":"markdown","56652aa5":"markdown","65677929":"markdown","c0a8966b":"markdown","5255e442":"markdown","3b81f275":"markdown","ce24c78b":"markdown","b7e02f32":"markdown","92236a77":"markdown","922f5838":"markdown","7a6e903b":"markdown","152e400a":"markdown","89162d1d":"markdown","484a2d1d":"markdown","29a7b8ce":"markdown","6128ec54":"markdown","ea17a3cb":"markdown","471f9773":"markdown","44959540":"markdown","d972e0dd":"markdown"},"source":{"c3493de8":"#First, we must import libraries needed for analysis\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","36e1c0f6":"#read the dataset\nnetflix = pd.read_csv('..\/input\/netflix-shows-exploratory-analysis\/netflix_titles.csv')\nnetflix.head()\n","3084408a":"netflix['date_added'].head()","6e97e437":"netflix['date_added'] = pd.to_datetime(netflix['date_added'])\nnetflix['date_added'].head()","e15c68f5":"#we can filter by all movies released in the United States since 2010, and get the counts\nmovies_since_2010 = netflix[(netflix.date_added >= '2010-01-01') & (netflix.type == 'Movie')\n                           & (netflix.country.str.contains('United States', case=False))]\nmovies_by_year = movies_since_2010.groupby(movies_since_2010.date_added.dt.year).show_id.count()\n\nfig, ax = plt.subplots()\n\nax.bar(movies_by_year.index, movies_by_year)\nax.spines['right'].set_visible(False) #removing spines to minimize chartjunk\nax.spines['top'].set_visible(False)\nax.spines['bottom'].set_visible(False)\nax.spines['left'].set_visible(False)\nax.set_title('Movies added to Netflix (Released in U.S.)')\nax.tick_params(left=True, bottom=False)\nax.grid(False)\nplt.show()","09d82689":"netflix[['title', 'country']].head()","2548c85d":"#from stackoverflow\ndef explode(df, lst_cols, fill_value='', preserve_index=False):\n    # make sure `lst_cols` is list-alike\n    if (lst_cols is not None\n        and len(lst_cols) > 0\n        and not isinstance(lst_cols, (list, tuple, np.ndarray, pd.Series))):\n        lst_cols = [lst_cols]\n    # all columns except `lst_cols`\n    idx_cols = df.columns.difference(lst_cols)\n    # calculate lengths of lists\n    lens = df[lst_cols[0]].str.len()\n    # preserve original index values    \n    idx = np.repeat(df.index.values, lens)\n    # create \"exploded\" DF\n    res = (pd.DataFrame({\n                col:np.repeat(df[col].values, lens)\n                for col in idx_cols},\n                index=idx)\n             .assign(**{col:np.concatenate(df.loc[lens>0, col].values)\n                            for col in lst_cols}))\n    # append those rows that have empty lists\n    if (lens == 0).any():\n        # at least one list in cells is empty\n        res = (res.append(df.loc[lens==0, idx_cols], sort=False)\n                  .fillna(fill_value))\n    # revert the original index order\n    res = res.sort_index()\n    # reset index if requested\n    if not preserve_index:        \n        res = res.reset_index(drop=True)\n    return res","69a91138":"#since countries appear as comma separated values in the country column, we need to separate the values, and create new rows for each value\nnew = netflix.copy() #create a copy of the original dataframe\nnew = new.replace(np.nan, '', regex=True)\nnew['country'] = new.country.str.split(',')\nnew = explode(new, ['country']) #new dataframe with new rows added for each country\nnew['country'] = new.country.str.strip()\nnew[['title', 'country']].head()","f4714918":"results = new[new.type == 'Movie'].groupby('country').show_id.count().sort_values(ascending=True)[-11:] #group by the country column, get top ten countries by movie releases\nresults = results.drop(labels='') #dropping rows with blank values\n\nfig, ax = plt.subplots()\n\nax.barh(results.index, results)\nax.set_title('Number of Netflix movies added')\nax.spines['right'].set_visible(False) #removing spines to minimize chartjunk\nax.spines['top'].set_visible(False)\nax.spines['bottom'].set_visible(False)\nax.spines['left'].set_visible(False)\nax.tick_params(left=False, bottom=False) #remove ticks\nax.grid(False) #remove grid\n\nplt.show()\n","b9603f22":"netflix[netflix.type == 'Movie'].duration.head()","1b6ad900":"def to_minutes(series): #function to return only the first element\n    return series.split()[0]\n    \n        \nnetflix['duration'] = netflix.duration.apply(lambda x: to_minutes(x))","163427d3":"netflix[netflix.type == 'Movie'].duration.head()","6da9734e":"netflix['duration'] = netflix.duration.astype('int') #to determine the average duration, must convert to int","b4e4519d":"netflix[netflix.type == 'Movie'].duration.mean() #average duration for all movies in the dataset","ded6b2e6":"sns.set(style='whitegrid')\n\nsns.distplot(netflix[netflix.type == 'Movie'].duration).set_title('Distribution of Movie Durations')\nplt.show()","2256890b":"sns.boxplot(netflix[netflix.type == 'Movie'].duration).set_title('Distribution of Movie Durations')\nplt.show()","f8540d86":"duration_by_year = netflix[netflix.type == 'Movie'].groupby(netflix.date_added.dt.year).mean().duration\nduration_by_year","b82a5c05":"fig, ax = plt.subplots()\n\nax.plot(duration_by_year)\nax.grid(False)\nax.set_title('Average duration of Netflix movies')\nax.spines['right'].set_visible(False) #removing spines to minimize chartjunk\nax.spines['top'].set_visible(False)\nax.spines['bottom'].set_visible(False)\nax.spines['left'].set_visible(False)\nax.set_xlabel('Year')\nax.set_ylabel('Average Duration')\nplt.show()","725de648":"netflix[['title','cast']].head()","1a841fcc":"cast_df = netflix.copy()\ncast_df = cast_df.dropna(axis=0, how='any', subset=['cast'])\ncast_df['cast'] = cast_df.cast.str.split(',')\ncast_df = explode(cast_df, ['cast']) #new dataframe with new rows added for each country\ncast_df[['title', 'cast']].head()","c3738b5e":"cast_df.groupby('cast').count()","37f692d6":"cast_df_filtered = cast_df[(cast_df.cast != '') & cast_df.country.str.contains('United States', case=False)]\ngrouped_cast = cast_df_filtered.groupby('cast').count().show_id.sort_values()[-11:] #get top ten cast members\ngrouped_cast","51ce238e":"fig, ax = plt.subplots(figsize=(7,5))\n\nax.barh(grouped_cast.index, grouped_cast)\nax.grid(False)\nax.spines['right'].set_visible(False) #remove spines to minimize chartjunk\nax.spines['top'].set_visible(False)\nax.spines['bottom'].set_visible(False)\nax.spines['left'].set_visible(False)\nax.set_title('Top Actors on Netflix')\nax.set_xlabel('Number of Titles')\nax.set_xlim(left=10) #start x-axis at 10\nplt.show()","48724dcd":"Since we want to break down the number of movies added per year, we'll use the \"date_added\" column.","a9bc8333":"Since we want to treat the duration column as time values, we should remove the \"min\" from all of the rows. At first glance, we can apply the str.split() method to each row, and return the first element. ","72362e5e":"With a new \"exploded\" dataframe with a separate row for each cast member, we can group by the cast members.","859e152f":"We can gauge the popularity of Netflix in each country by examining the number of releases in each country. First, let's examine the column we want to break down: 'country'.","0d50bb84":"The United States has the most number of movies added on Netflix by a wide margin.","813a934e":"#### Which country has the most movie releases?","b2f9a086":"We can see that Netflix has added longer movies over time, on average.","f286248e":"#### What is the average duration of all movies?","4f631e07":"We've explored the Netflix dataset and now have a more firm understanding of the content distribution. Some topics for further exploration could be:\n\n* Which actors\/actresses tend to appear in the same movies\/tv shows?\n* What is the average IMDB rating of Netflix content?\n* What are the most popular genres on Netflix?","f6605713":"With the data formatted as we need, we can now group by each individual cast member.","56652aa5":"We have the same problem as when we examined the \"country\" column. Each cast member must be separated into individual rows. We can use the same explode function as before.","65677929":"### Questions to explore","c0a8966b":"Its no surprise that the increasing popularity of Netflix has coincided with the addition of more movie titles over the years. The number of titles added per year has increased since 2014. We can assume that the trend will continue in 2020.","5255e442":"#### On average, has Netflix added shorter or longer movies over time?","3b81f275":"With the data in the correct format, we can group the rows in the dataframe by year.","ce24c78b":"#### Which actors have appeared in the most titles?","b7e02f32":"Now, each country has its own row in the dataframe, even if it is the same title. We are now able to group by the individual country.","92236a77":"Let's examine the average duration of movies for each year.","922f5838":"# Exploring the Netflix Dataset ","7a6e903b":"Each row in the dataframe represents a title on Netflix. The \"show_id\" column corresponds to that title's unique id. There are many factors we could explore, but for this analysis let's focus mainly on the \"country\", \"cast\", and \"date_added\" columns.","152e400a":"The interquartile range appears to be fairly small and there are many outliers present.","89162d1d":"If a title is released in multiple countries, it is represented as one row in the dataframe. We actually want one row for each country and title. For example, in the first row in the above dataframe, we would like the \"country\" values to be separated into four rows: one for the United States, India, South Korea, and China. This will allow us to break down the number of releases by each country.","484a2d1d":"#### In the United States, how many movies have been added, per year, since 2010?","29a7b8ce":"I've found a function via stackoverflow that will be useful. For our purposes, each country in the \"country\" column will be stacked as a new row in the resulting dataframe. ","6128ec54":"The average duration for all movies released on Netflix is 99 minutes. Visualizing the distribution of movie durations can give us a more clear picture of the data.","ea17a3cb":"Netflix has undoubtetdly grown to become an entertainment giant. Over the past few years, they've added content on a regular basis, with new titles released seemingly overnight. The dataset that we'll be exploring contains metadata on Netflix movies and TV shows. Exploring factors such as the number of movies released over time, the average duration of movies, and the top actors and actresses can give us an idea of how content has evolved on Netflix over time.  ","471f9773":"Does Netflix tend to add shorter or longer movies? Let's look at the \"duration\" column.","44959540":"We can see that the data type (dtype) for the date_added column is an object. Pandas is handling the values as Python strings. We'll want to convert those values to datetime if we want them to be treated as dates.","d972e0dd":"Now, the values in the duration column are formatted correctly."}}