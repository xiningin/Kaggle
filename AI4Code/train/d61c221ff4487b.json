{"cell_type":{"83414968":"code","cf9465bc":"code","e2c3704b":"code","8a34a211":"code","acd580dc":"code","d5a0b1ea":"code","858a089c":"code","2ae0a690":"code","0cb696e4":"code","ec9640c3":"code","cc053ae5":"code","84e23969":"code","4c56cc0f":"code","5a2cede1":"code","51870d73":"markdown"},"source":{"83414968":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","cf9465bc":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nfrom fastai import *\nfrom fastai.vision import *\nfrom fastai.callbacks.hooks import *\n\nimport os\nprint(os.listdir(\"..\/input\/pollendataset\/PollenDataset\/\"))\npd.read_csv(\"..\/input\/pollendataset\/PollenDataset\/pollen_data.csv\").head()","e2c3704b":"path=Path(\"..\/input\/pollendataset\/PollenDataset\/\")\ndata = ImageDataBunch.from_csv(path, folder='images\/',csv_labels='pollen_data.csv',fn_col=1, label_col=2,\n                                  ds_tfms=get_transforms(flip_vert=True,do_flip=True, max_warp=0,  max_rotate=0, p_affine=0.5, max_zoom=1.1),\n                                  bs=64, \n                                  num_workers=0).normalize(imagenet_stats)","8a34a211":"print(f'Classes: \\n {data.classes}')\ndata.show_batch(rows=3, figsize=(7,6))","acd580dc":"learn = create_cnn(data, models.resnet34, metrics=accuracy, model_dir=\"\/tmp\/model\/\")","d5a0b1ea":"learn.lr_find()\nlearn.recorder.plot()","858a089c":"learn.fit_one_cycle(10,1e-2)","2ae0a690":"learn.save('stage-1')","0cb696e4":"learn.lr_find()\nlearn.recorder.plot()","ec9640c3":"learn.load('stage-1')\nlearn.unfreeze()\nlearn.fit_one_cycle(5, max_lr=slice(5e-5,5e-3 ))","cc053ae5":"learn.recorder.plot_losses()","84e23969":"interp = ClassificationInterpretation.from_learner(learn)","4c56cc0f":"interp.plot_top_losses(9, figsize=(15,11))","5a2cede1":"interp.plot_confusion_matrix(figsize=(8,8), dpi=60)","51870d73":"Bee pollen is a ball or pellet of field-gathered flower pollen packed by worker honeybees, and used as the primary food source for the hive."}}