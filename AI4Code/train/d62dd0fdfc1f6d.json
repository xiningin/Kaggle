{"cell_type":{"cd58e439":"code","a2987d1f":"code","c2127e8a":"code","9dd2ff20":"code","f5165a84":"code","33fea50a":"code","27dc5955":"code","dc289bce":"code","7c065a87":"code","1a2288cf":"code","28b93c1c":"code","1332f169":"code","6b8e79cc":"code","2caf6f43":"code","425fe2ea":"code","458e0ab4":"code","417f4baf":"code","66f70d6b":"code","c927b293":"code","3dbcd28e":"code","ca7284f2":"code","c5862d94":"markdown","dc19d517":"markdown","6f36dbb1":"markdown","a4367d36":"markdown","da796894":"markdown","2cbb07e8":"markdown","6b856e9d":"markdown","f122daf9":"markdown","e2e9c4fa":"markdown","91406d96":"markdown","160b2293":"markdown"},"source":{"cd58e439":"import numpy as np \nimport pandas as pd\n\ndf = pd.read_csv(\"\/kaggle\/input\/passenger-list-for-the-estonia-ferry-disaster\/estonia-passenger-list.csv\")","a2987d1f":"df.head(),df.shape","c2127e8a":"df.isnull().sum()","9dd2ff20":"df.set_index('PassengerId')","f5165a84":"from sklearn.preprocessing import LabelEncoder\n\nlabel_encoder = LabelEncoder()\n\ndf['Sex'] = label_encoder.fit_transform(df['Sex']) #Male is 1\ndf['Category'] = label_encoder.fit_transform(df['Category']) #P is 1","33fea50a":"def age_group(Age):\n  a=''\n  if (Age<=1):\n    a='toddler'\n\n  elif(Age<=4):\n    a='infant'\n\n  elif(Age<=12):\n    a='child'\n\n  elif(Age<=19):\n    a='teenager'\n    \n  elif(Age<=55):\n    a='adult'\n\n  else:\n    a='senior'\n    \n  return a\n\ndf['age_group']=df.Age.map(age_group)","27dc5955":"import matplotlib as plt \nimport seaborn as sns","dc289bce":"sns.heatmap(data = df.corr(), annot = True)","7c065a87":"df['Sex'].value_counts()","1a2288cf":"sns.barplot(x='Sex',y='Survived', data =df)","28b93c1c":"df['Category'].value_counts()","1332f169":"sns.barplot(x='Category',y='Survived', data =df)","6b8e79cc":"sns.kdeplot(df.loc[(df['Survived']==0),'Age'],shade = True ,Label='Not Survived')\nsns.kdeplot(df.loc[(df['Survived']==1),'Age'],shade = True ,Label='Survived')","2caf6f43":"from sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split \nimport category_encoders as ce\n\n# Libraries for Predicting on the data:\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom xgboost import XGBClassifier","425fe2ea":"c = (df.dtypes == 'object')\n\ncategorical = list(c[c].index)","458e0ab4":"survived = df['Survived']\n\ncat = ce.CatBoostEncoder()\ncat.fit(df[categorical], survived)\n\ndf[categorical] = cat.transform(df[categorical])\n\ny = df['Survived']","417f4baf":"df = df.drop(['Survived'], axis=1)","66f70d6b":"scale = StandardScaler()\nscaleddata = pd.DataFrame(scale.fit_transform(df), columns=df.columns)","c927b293":"train, test, ytrain, ytest = train_test_split(scaleddata,y, train_size=0.75, test_size=0.25)","3dbcd28e":"xgb = XGBClassifier(n_estimators=600)\nxgb.fit(train, ytrain)\nxpred = xgb.predict(test)","ca7284f2":"from sklearn.metrics import *\nprint(\"The Accuracy of this model is :\", accuracy_score(xpred, ytest)*100)","c5862d94":"# Introduction\n\nOn September 28, 1994, 852 people die in one of the worst maritime disasters of the century when the Estonia, a large car-and-passenger ferry, sank in the Baltic Sea. It is named one of the deadliest ship-sinking tragedy second only to the Titanic Incident.","dc19d517":"We have about 7 coloumns out of which the last 4 are of atmost importance for building this model.\n* Sex : M or F \n* Age of the passenger\n* Category : P- Passenger C-Crew\n* Survived : Yes - 0, No - 1","6f36dbb1":"# Preprocessing","a4367d36":"# The Dataset ","da796894":"I have created a new coloumn using the Age of the passangers to fit them into age groups.","2cbb07e8":"# Model Training","6b856e9d":"As we can see the sex of the passenger is an important factor since the survival percentange of Males (1) is higher than Females(0)","f122daf9":"# Exploratory Data Analysis\n\nLets take a deeper look at our variables to know how much do they truly affect the Survival.","e2e9c4fa":"Finally Age, also an important variable to consider.","91406d96":"Looking at the Category Coloumn, the crew even at a lower number had a higher probability of survival compared to a regular passenger. So Category of passanger is also an important factor.","160b2293":"# Data Pre-Processing\n\nWe'll convert the categorical variables such as Sex and Categories into 0s and 1s using Label Encoder so we can use them in our model building."}}