{"cell_type":{"3ed7735f":"code","ffb6b97c":"code","5d91fe0d":"code","bd8a490d":"code","a0ff8500":"code","36b58a3f":"code","933c1818":"code","4f0e7807":"code","323b4d18":"code","2c14d884":"code","6ada168b":"code","e108e8c0":"code","6cb8ea9c":"code","020b6c13":"code","d0595380":"code","e57b5d63":"code","9de73c80":"code","9ea3a607":"code","7f29ec8e":"code","bb9054dc":"code","b5e8129b":"code","78068a35":"code","71a1424f":"code","c20c26cf":"code","7e3330b0":"code","7a4af133":"code","0f0ebd85":"code","375b6335":"code","2326c0c1":"code","80a6bd39":"code","8503136e":"code","ca4fd1ad":"code","569f7836":"code","3b1569b5":"code","d099bfaf":"code","bf6192be":"code","807050e6":"code","c29cb96a":"code","d39c469b":"code","1f308653":"markdown","bae0fbb0":"markdown","afd1f071":"markdown","13de456f":"markdown","9720ad11":"markdown","2ea7a64e":"markdown","8e369552":"markdown","5f206086":"markdown","c0692e5e":"markdown","feef456d":"markdown","95ea4425":"markdown","a539b3ed":"markdown","e7991b0d":"markdown","3852285e":"markdown","15745451":"markdown","72a51db8":"markdown","f8ef76ed":"markdown","86bdac5d":"markdown","0dda87dc":"markdown","bbbd5e90":"markdown","845f93f8":"markdown","2cffe5e1":"markdown","5b97d5fe":"markdown"},"source":{"3ed7735f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n#Ignore warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","ffb6b97c":"train = pd.read_parquet('..\/input\/kaggle-pog-series-s01e01\/train.parquet')\ntest = pd.read_parquet('..\/input\/kaggle-pog-series-s01e01\/test.parquet')\nsub = pd.read_csv('..\/input\/kaggle-pog-series-s01e01\/sample_submission.csv')","5d91fe0d":"train.head()","bd8a490d":"train[['year','month','date']] = train['trending_date'].apply(lambda x : pd.Series(str(x).split('-')))","a0ff8500":"train.drop('trending_date', inplace=True, axis =1)","36b58a3f":"#train = pd.read_parquet('..\/input\/\/kaggle-pog-series-s01e01\/train.parquet', index_col='publishedAt', parse_dates=['publishedAt'])\n#train.tail()","933c1818":"#Code by Carl McBride Ellis https:\/\/www.kaggle.com\/c\/kaggle-pog-series-s01e01\/discussion\/300866#1649954\n\ntrain.comments_disabled = train.comments_disabled.replace({True: 1, False: 0})\ntrain.ratings_disabled = train.ratings_disabled.replace({True: 1, False: 0})\ntrain.has_thumbnail = train.has_thumbnail.replace({True: 1, False: 0})","4f0e7807":"#Code by Carl McBride Ellis https:\/\/www.kaggle.com\/c\/kaggle-pog-series-s01e01\/discussion\/300866#1649954\n\n#train['ratings_disabled'] = train['ratings_disabled'].astype(int)\n#train['comments_disabled'] = train['comments_disabled'].astype(int)\n#train['has_thumbnail'] = train['has_thumbnail'].astype(int)","323b4d18":"train['target'] = train['target'].astype(int)\ntrain['year'] = train['year'].astype(int)\ntrain['month'] = train['month'].astype(int)\ntrain['date'] = train['date'].astype(int)","2c14d884":"train['duration_seconds']=train['duration_seconds'].replace(\"(NaN)\", np.nan)","6ada168b":"train.fillna(value=0,inplace=True)","e108e8c0":"train[\"duration_seconds\"]=train[\"duration_seconds\"].apply(int)","6cb8ea9c":"train.head()","020b6c13":"!pip install feyn","d0595380":"import feyn","e57b5d63":"train.dtypes","9de73c80":"cols_to_drop=['publishedAt']\ntrain=train.drop(cols_to_drop,axis=1)\ntrain.columns","9ea3a607":"stypes = {\n    \"video_id\": \"cat\",\n    \"title\": \"cat\",\n    \"channelId\": \"cat\",\n    \"channelTitle\": \"cat\",\n    \"tags\": \"cat\",\n    \"thumbnail_link\": \"cat\",\n    \"description\": \"cat\",\n    \"id\": \"cat\",\n    \n}","7f29ec8e":"#Code by Bizen https:\/\/www.kaggle.com\/hiro5299834\/tps-apr-2021-deebtables\/notebook\n\nTARGET = 'target' #Target could Not be float otherwise will result in valueError: Unknown label type: 'continuous'. Even after the encoding.\n\nlabel_cols = ['video_id','title', 'channelId', 'channelTitle', 'tags', 'thumbnail_link', 'description', 'id']\nnumerical_cols = ['categoryId', 'view_count', 'likes', 'dislikes', 'comment_count', 'comments_disabled', 'ratings_disabled', 'has_thumbnail', 'year', 'month', 'date']","bb9054dc":"#Code by Bizen https:\/\/www.kaggle.com\/hiro5299834\/tps-apr-2021-deebtables\/notebook\n\nfrom sklearn.preprocessing import LabelEncoder\n\ndef label_encoder(c):\n    le = LabelEncoder()\n    return le.fit_transform(c)\n\nlabel_encoded_train = train[label_cols].apply(label_encoder)\nnumerical_train = train[numerical_cols]\ntarget_train = train[TARGET]\n\ntrain = pd.concat([label_encoded_train, numerical_train, target_train], axis=1)","b5e8129b":"from sklearn.preprocessing import LabelEncoder\n\n#fill in mean for floats\nfor c in train.columns:\n    if train[c].dtype=='float16' or  train[c].dtype=='float32' or  train[c].dtype=='float64':\n        train[c].fillna(train[c].mean())\n\n#fill in -999 for categoricals\ntrain = train.fillna(-999)\n# Label Encoding\nfor f in train.columns:\n    if train[f].dtype=='object': \n        lbl = LabelEncoder()\n        lbl.fit(list(train[f].values))\n        train[f] = lbl.transform(list(train[f].values))\n        \nprint('Labelling done.')","78068a35":"train.head()","71a1424f":"import sklearn.model_selection","c20c26cf":"train, test = feyn.tools.split(train, ratio=(1,1), random_state=42)","7e3330b0":"ql = feyn.connect_qlattice()","7a4af133":"ql.reset(random_seed=1)","0f0ebd85":"#Code by Liv Toft https:\/\/www.kaggle.com\/livtoft\/explainable-model-for-hf-using-the-qlattice\n\nql.reset(random_seed=1)\nmodels = ql.auto_run(train, output_name=\"target\", kind=\"regression\", max_complexity=10, criterion='bic')","375b6335":"models[0]","2326c0c1":"models[0].plot(train, test)","80a6bd39":"from feyn.plots.interactive import interactive_activation_flow","8503136e":"interactive_activation_flow(models[0], train)","ca4fd1ad":"models[0].plot_probability_scores(test)","569f7836":"models[0].sympify(2)","3b1569b5":"#Code by Liv Toft https:\/\/www.kaggle.com\/livtoft\/explainable-model-for-hf-using-the-qlattice\n\nql.reset(random_seed=1)\nmodels = ql.auto_run(train, output_name=\"target\", kind=\"regression\", max_complexity=10, criterion='aic')","d099bfaf":"models[1]","bf6192be":"#models[1].plot(train, test)","807050e6":"interactive_activation_flow(models[1], train)","c29cb96a":"models[1].plot_probability_scores(test)","d39c469b":"models[1].sympify(2)","1f308653":"#Below ValueError: cannot convert float NaN to integer\n\nMust fillna to avoid error.","bae0fbb0":"![](https:\/\/encrypted-tbn0.gstatic.com\/images?q=tbn:ANd9GcR3wH4On4THNleXcW9CvUdnBb8AH23FYpZKig&usqp=CAU)abzu.ai","afd1f071":"#Criterion BIC (Bayesian Information Criterion)","13de456f":"Or another way to deal with Booleans","9720ad11":"#Cheating AGAIN! Since I didn't achieve to work with this datetime yet in parquet files.","2ea7a64e":"#Acknowledgements\n\nhttps:\/\/docs.abzu.ai\/\n\nhttps:\/\/docs.abzu.ai\/docs\/guides\/getting_started\/community.html\n\n\nCasper Wilstrup https:\/\/www.kaggle.com\/wilstrup\/use-qlattice-to-predict-rainy-days-in-australia\/notebook\n\nLiv Toft https:\/\/www.kaggle.com\/livtoft\/explainable-model-for-hf-using-the-qlattice\n\nCarl McBride Ellis (Booleans to integers)","8e369552":"#Check if the Label encoding worked","5f206086":"\"Feyn is inspired by Richard Feynman's path integral formulation. That's why the python module to use it is called Feyn, and the Q in QLattice is for Quantum.\"","c0692e5e":"#Criterion  Must be 'aic', 'bic' or None)\n\nI tried to chage to MAE.","feef456d":"#Above LinAlgError: Singular matrix","95ea4425":"#Check if columns\/booleans changed to integers.","a539b3ed":"![](https:\/\/encrypted-tbn0.gstatic.com\/images?q=tbn:ANd9GcQWKyaAE_qUWlP0zFYUAIgAnmmgQVctt3F8g9yuohRDUV_c90GpadGsDKKwZ_bxV5ootY0&usqp=CAU)kwize.com","e7991b0d":"#Create a dict names stypes with this information which we will pass to the QLattice later.","3852285e":"#Equation","15745451":"#Columns to be convert into integers","72a51db8":"#Label Encoding","f8ef76ed":"#Models\n\nModels is a list of graphs sorted by accuracy. Each model shows how the selected features, or inputs, interact to achieve the output. We can access the best graph by calling:","86bdac5d":"#Deal with Booleans","0dda87dc":"#I tried to index_col though it didn't work with Parquet files\n\nTypeError: read_table() got an unexpected keyword argument 'index_col'","bbbd5e90":"#Let's try AIC\n\nThe Akaike information criterion (AIC) is a metric that is used to compare the fit of different regression models.","845f93f8":"#It's impossible not to love this guy (Professor Feyman).","2cffe5e1":"#Below didn't work!","5b97d5fe":"#Equation"}}