{"cell_type":{"46e3f609":"code","c8286b5f":"code","95e99144":"code","63eacf79":"code","85dac225":"code","0c24f0aa":"code","9b96cca8":"code","44730d23":"code","a35e76f7":"code","38a31c7c":"code","528811df":"code","85b36305":"code","bfbb84fd":"code","d0dc7ece":"code","aae082e1":"code","1620b42c":"code","b55416de":"markdown","e1515417":"markdown","6e579d74":"markdown","2252cdfc":"markdown"},"source":{"46e3f609":"import random\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import LabelEncoder\nimport lightgbm as lgb\nfrom sklearn.model_selection import train_test_split\nimport seaborn as sns","c8286b5f":"SEED=2021\ndef fix_seed(seed):\n    # random\n    random.seed(seed)\n    # Numpy\n    np.random.seed(seed)\nfix_seed(SEED)","95e99144":"train_df=pd.read_csv(\"..\/input\/competition-test-210902\/train.csv\",index_col=0)\ntest_df=pd.read_csv(\"..\/input\/competition-test-210902\/test.csv\",index_col=0)\nsample_df=pd.read_csv(\"..\/input\/competition-test-210902\/sample.csv\",index_col=0)","63eacf79":"train_df","85dac225":"train_df.dtypes #\u6587\u5b57\u5217\u306b\u306a\u3063\u3066\u3044\u308b\u30ab\u30c6\u30b4\u30ea\u5909\u6570\u306e\u78ba\u8a8d","0c24f0aa":"cols_to_encode=[\n    \"school\",\"sex\",\"address\",\"famsize\",\"Pstatus\",\"Mjob\",\"Fjob\",\"reason\",\"guardian\",\"schoolsup\",\"famsup\",\"paid\",\"activities\",\n    \"nursery\",\"higher\",\"internet\",\"romantic\",\"subject\"\n]","9b96cca8":"encoders={}\nfor col in cols_to_encode:\n    le=LabelEncoder().fit(pd.concat([train_df[col],test_df[col]])) #train\u3068test\u3092\u3064\u306a\u3052\u3066\u304b\u3089LabelEncoder\u3092\u4f7f\u3046\u3002test\u306b\u3057\u304b\u306a\u3044\u30ab\u30c6\u30b4\u30ea\u304c\u3042\u3063\u305f\u5834\u5408\u7528\n    train_df[col]=le.transform(train_df[col])\n    test_df[col]=le.transform(test_df[col])\n    encoders[col]=le","44730d23":"train_df","a35e76f7":"X_train,X_val,y_train,y_val=train_test_split(train_df.drop(columns=[\"G3\"]),train_df[\"G3\"],test_size=0.2,random_state=SEED)","38a31c7c":"train_dataset=lgb.Dataset(X_train,y_train)\nval_dataset=lgb.Dataset(X_val,y_val,reference=train_dataset)","528811df":"params={\n    \"objective\":\"mse\", #\u4e8c\u4e57\u8aa4\u5dee\n    \"num_leaves\":10\n}","85b36305":"gbm=lgb.train(params,train_dataset,num_boost_round=100,valid_sets=[val_dataset],)","bfbb84fd":"y_pred=gbm.predict(test_df)","d0dc7ece":"sample_df[\"Expected\"]=y_pred","aae082e1":"sample_df[\"ID\"]=sample_df.index","1620b42c":"sample_df.to_csv(\"submission.csv\",index=False)","b55416de":"# Training","e1515417":"# Preprocessing","6e579d74":"# Inference","2252cdfc":"# Baseline Notebook for 0th datascience competition\nLGBM\u3092\u4f7f\u3046\u3060\u3051\u306e\u6700\u3082\u30b7\u30f3\u30d7\u30eb\u306a\u30d9\u30fc\u30b9\u30e9\u30a4\u30f3\u3092\u793a\u3057\u307e\u3059\u3002"}}