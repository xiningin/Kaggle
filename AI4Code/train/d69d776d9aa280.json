{"cell_type":{"6c6bb305":"code","e350b35d":"code","4ec09406":"code","7c5f1d53":"code","d40e4f8c":"code","b62fe22b":"code","c482acfb":"code","8ea4fd23":"code","e882bf8f":"code","7fc89f15":"code","3207c345":"code","e3e81ade":"code","8442db51":"code","1c25bd33":"code","199eeeb6":"code","1c6e38d1":"code","b638665d":"code","f3d9b477":"code","6112cc68":"code","29d28052":"code","13a34844":"code","2a134a19":"code","1f842f9e":"code","679f8554":"code","18154974":"code","52946e0e":"code","dd46a385":"code","f3382422":"code","8c541473":"markdown","f0d836d5":"markdown"},"source":{"6c6bb305":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","e350b35d":"credit_df=pd.read_csv(\"..\/input\/CreditCardUsage.csv\")\ncredit_df.shape","4ec09406":"credit_df.describe().transpose()","7c5f1d53":"credit_df.info()","d40e4f8c":"credit_df.head(10)","b62fe22b":"credit_df.isna().sum()","c482acfb":"credit_df[\"MINIMUM_PAYMENTS\"]=credit_df.MINIMUM_PAYMENTS.fillna(np.mean(credit_df.MINIMUM_PAYMENTS))\ncredit_df[\"CREDIT_LIMIT\"]=credit_df.CREDIT_LIMIT.fillna(np.mean(credit_df.CREDIT_LIMIT))\ncredit_df.isna().sum()","8ea4fd23":"credit_df.cov()","e882bf8f":"credit_corr=credit_df.corr()","7fc89f15":"import seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","3207c345":"plt.figure(figsize=(20,10))\nsns.heatmap(credit_corr,vmin=-1,vmax=1,center=0,annot=True)","e3e81ade":"df = credit_df.drop('CUST_ID', axis=1)\ndf.head()","8442db51":"from sklearn.preprocessing import StandardScaler\nX = df.values[:]\nX = np.nan_to_num(X)\nClus_dataSet = StandardScaler().fit_transform(X)\nClus_dataSet","1c25bd33":"X_BAL_PUR = df.iloc[:,[0,2]].values\nX_BAL_INSTALL_PUR=df.iloc[:,[0,4]].values\nX_PUR_CASH_ADVANCE=df.iloc[:,[2,5]].values\nX_PUR_PAYMENT=df.iloc[:,[2,13]].values\nX_BAL_PYMT=df.iloc[:,[0,13]].values\n","199eeeb6":"import scipy.cluster.hierarchy as sch\n\nplt.figure(figsize=(15,6))\nplt.title('Dendrogram')\nplt.xlabel('BALANCE AND PURCHASES')\nplt.ylabel('Euclidean distances')\n#plt.grid(True)\ndendrogram = sch.dendrogram(sch.linkage(X_BAL_PUR, method = 'ward'))\nplt.show()","1c6e38d1":"plt.figure(figsize=(15,6))\nplt.title('Dendrogram')\nplt.xlabel('BALANCE AND PURCHASES')\nplt.ylabel('Euclidean distances')\nplt.hlines(y=80000,xmin=0,xmax=2000000,lw=3,linestyles='--')\nplt.text(x=1000,y=100000,s='Horizontal line crossing 6 vertical lines so k=7(6+1)',fontsize=20)\n#plt.grid(True)\ndendrogram = sch.dendrogram(sch.linkage(X_BAL_PUR, method = 'ward'))\nplt.show()","b638665d":"plt.figure(figsize=(15,6))\nplt.title('Dendrogram')\nplt.xlabel('BALANCE AND PYMT')\nplt.ylabel('Euclidean distances')\n#plt.grid(True)\ndendrogram = sch.dendrogram(sch.linkage(X_BAL_PYMT, method = 'ward'))\nplt.show()","f3d9b477":"plt.figure(figsize=(15,6))\nplt.title('Dendrogram')\nplt.xlabel('BALANCE AND PYMT')\nplt.ylabel('Euclidean distances')\nplt.hlines(y=100000,xmin=0,xmax=2000000,lw=3,linestyles='--')\nplt.text(x=1000,y=120000,s='Horizontal line crossing 5 vertical lines so k=5',fontsize=20)\n#plt.grid(True)\ndendrogram = sch.dendrogram(sch.linkage(X_BAL_PYMT, method = 'ward'))\nplt.show()","6112cc68":"\n\nplt.figure(figsize=(15,6))\nplt.title('Dendrogram')\nplt.xlabel('BALANCE AND INSTALLMENT')\nplt.ylabel('Euclidean distances')\n#plt.grid(True)\ndendrogram = sch.dendrogram(sch.linkage(X_BAL_INSTALL_PUR, method = 'ward'))\nplt.show()","29d28052":"plt.figure(figsize=(15,6))\nplt.title('Dendrogram')\nplt.xlabel('BALANCE AND INSTALLMENT')\nplt.ylabel('Euclidean distances')\nplt.hlines(y=80000,xmin=0,xmax=2000000,lw=3,linestyles='--')\nplt.text(x=1000,y=100000,s='Horizontal line crossing 3 vertical lines so k=3',fontsize=20)\n#plt.grid(True)\ndendrogram = sch.dendrogram(sch.linkage(X_BAL_INSTALL_PUR, method = 'ward'))\nplt.show()","13a34844":"\n\nplt.figure(figsize=(15,6))\nplt.title('Dendrogram')\nplt.xlabel('PURCHASE AND CASH ADVANCE')\nplt.ylabel('Euclidean distances')\n#plt.grid(True)\ndendrogram = sch.dendrogram(sch.linkage(X_PUR_CASH_ADVANCE, method = 'ward'))\nplt.show()","2a134a19":"plt.figure(figsize=(15,6))\nplt.title('Dendrogram')\nplt.xlabel('PURCHASE AND CASH ADVANCE')\nplt.ylabel('Euclidean distances')\nplt.hlines(y=80000,xmin=0,xmax=2000000,lw=3,linestyles='--')\nplt.text(x=1000,y=100000,s='Horizontal line crossing 7 vertical lines so k=7',fontsize=20)\n#plt.grid(True)\ndendrogram = sch.dendrogram(sch.linkage(X_PUR_CASH_ADVANCE, method = 'ward'))\nplt.show()","1f842f9e":"\n\nplt.figure(figsize=(15,6))\nplt.title('Dendrogram')\nplt.xlabel('PURCHASE AND PAYMENT')\nplt.ylabel('Euclidean distances')\n#plt.grid(True)\ndendrogram = sch.dendrogram(sch.linkage(X_PUR_PAYMENT, method = 'ward'))\nplt.show()","679f8554":"plt.figure(figsize=(15,6))\nplt.title('Dendrogram')\nplt.xlabel('PURCHASE AND PAYMENT')\nplt.ylabel('Euclidean distances')\nplt.hlines(y=100000,xmin=0,xmax=2000000,lw=3,linestyles='--')\nplt.text(x=1000,y=120000,s='Horizontal line crossing 5 vertical lines so k=5',fontsize=20)\n#plt.grid(True)\ndendrogram = sch.dendrogram(sch.linkage(X_PUR_PAYMENT, method = 'ward'))\nplt.show()","18154974":"from sklearn.cluster import AgglomerativeClustering\nhc_7 = AgglomerativeClustering(n_clusters = 7, affinity = 'euclidean', linkage = 'ward')\nhc_5 = AgglomerativeClustering(n_clusters = 5, affinity = 'euclidean', linkage = 'ward')\ny_hc_bal_pur = hc_7.fit_predict(X_BAL_PUR)\ny_hc_bal_pymt = hc_5.fit_predict(X_BAL_PYMT)\ny_hc_pur_pymt = hc_7.fit_predict(X_PUR_PAYMENT)\n","52946e0e":"plt.figure(figsize=(12,7))\nplt.scatter(X_BAL_PUR[y_hc_bal_pur == 0, 0], X_BAL_PUR[y_hc_bal_pur == 0, 1], s = 100, c = 'red', label = 'VV Low Balance,VV Low Purchase')\nplt.scatter(X_BAL_PUR[y_hc_bal_pur == 1, 0], X_BAL_PUR[y_hc_bal_pur == 1, 1], s = 100, c = 'blue', label = 'High Balance, High Purchase ')\nplt.scatter(X_BAL_PUR[y_hc_bal_pur == 2, 0], X_BAL_PUR[y_hc_bal_pur == 2, 1], s = 100, c = 'green', label = 'Medium Balance, Medium Purchase')\nplt.scatter(X_BAL_PUR[y_hc_bal_pur == 3, 0], X_BAL_PUR[y_hc_bal_pur == 3, 1], s = 100, c = 'orange', label = 'V High Balance, Low Purchase')\nplt.scatter(X_BAL_PUR[y_hc_bal_pur == 4, 0], X_BAL_PUR[y_hc_bal_pur == 4, 1], s = 100, c = 'magenta', label = 'Low Balance,Medium Purchase')\nplt.scatter(X_BAL_PUR[y_hc_bal_pur == 5, 0], X_BAL_PUR[y_hc_bal_pur == 5, 1], s = 100, c = 'yellow', label = 'Medium Balance,Medium Purchase')\nplt.scatter(X_BAL_PUR[y_hc_bal_pur == 6, 0], X_BAL_PUR[y_hc_bal_pur == 6, 1], s = 100, c = 'pink', label = 'V Low Balance,V low Purchase')\nplt.title('Clustering of Balance Vs Purchase',fontsize=20)\nplt.xlabel('Balance',fontsize=16)\nplt.ylabel('Purchase',fontsize=16)\nplt.legend(fontsize=16)\nplt.grid(True)\nplt.axhspan(ymin=20,ymax=25,xmin=0.4,xmax=0.96,alpha=0.3,color='yellow')\nplt.show()","dd46a385":"plt.figure(figsize=(12,7))\nplt.scatter(X_BAL_PYMT[y_hc_bal_pymt == 0, 0], X_BAL_PYMT[y_hc_bal_pymt == 0, 1], s = 100, c = 'red', label = 'Low Balance average payment')\nplt.scatter(X_BAL_PYMT[y_hc_bal_pymt == 1, 0], X_BAL_PYMT[y_hc_bal_pymt == 1, 1], s = 100, c = 'blue', label = 'High Balance,low payment')\nplt.scatter(X_BAL_PYMT[y_hc_bal_pymt == 2, 0], X_BAL_PYMT[y_hc_bal_pymt == 2, 1], s = 100, c = 'green', label = 'High Balance high payment')\nplt.scatter(X_BAL_PYMT[y_hc_bal_pymt == 3, 0], X_BAL_PYMT[y_hc_bal_pymt == 3, 1], s = 100, c = 'orange', label = 'Average Balance,average payment')\nplt.scatter(X_BAL_PYMT[y_hc_bal_pymt == 4, 0], X_BAL_PYMT[y_hc_bal_pymt == 4, 1], s = 100, c = 'magenta', label = 'Low Balance,Average payment')\nplt.title('Clustering of Balance vs Payments',fontsize=20)\nplt.xlabel('Balance',fontsize=16)\nplt.ylabel('Payments',fontsize=16)\nplt.legend(fontsize=16)\nplt.grid(True)\nplt.axhspan(ymin=20,ymax=25,xmin=0.4,xmax=0.96,alpha=0.3,color='yellow')\nplt.show()","f3382422":"plt.figure(figsize=(12,7))\nplt.scatter(X_PUR_PAYMENT[y_hc_pur_pymt == 0, 0], X_PUR_PAYMENT[y_hc_pur_pymt == 0, 1], s = 100, c = 'red', label = 'Medium purchases average payment')\nplt.scatter(X_PUR_PAYMENT[y_hc_pur_pymt == 1, 0], X_PUR_PAYMENT[y_hc_pur_pymt == 1, 1], s = 100, c = 'blue', label = 'average puchase,medium payment')\nplt.scatter(X_PUR_PAYMENT[y_hc_pur_pymt == 2, 0], X_PUR_PAYMENT[y_hc_pur_pymt == 2, 1], s = 100, c = 'green', label = 'V.High Puchases V.high payment')\nplt.scatter(X_PUR_PAYMENT[y_hc_pur_pymt == 3, 0], X_PUR_PAYMENT[y_hc_pur_pymt == 3, 1], s = 100, c = 'orange', label = 'Low purchase,V.high payment')\nplt.scatter(X_PUR_PAYMENT[y_hc_pur_pymt == 4, 0], X_PUR_PAYMENT[y_hc_pur_pymt == 4, 1], s = 100, c = 'magenta', label = 'Low purchase,Low payment')\nplt.scatter(X_PUR_PAYMENT[y_hc_pur_pymt == 5, 0], X_PUR_PAYMENT[y_hc_pur_pymt == 5, 1], s = 100, c = 'yellow', label = 'Average purchases,Low payment')\nplt.scatter(X_PUR_PAYMENT[y_hc_pur_pymt == 6, 0], X_PUR_PAYMENT[y_hc_pur_pymt == 6, 1], s = 100, c = 'pink', label = 'Low Purchase,high payment')\nplt.title('Clustering of Purchases vs Payments',fontsize=20)\nplt.xlabel('Purchases',fontsize=16)\nplt.ylabel('Payments',fontsize=16)\nplt.legend(fontsize=16)\nplt.grid(True)\nplt.axhspan(ymin=20,ymax=25,xmin=0.4,xmax=0.96,alpha=0.3,color='yellow')\nplt.show()","8c541473":"**BALANCE HAVE CORRELATION WITH CASH_ADVANCE(0.5),CASH_ADVANCE_FREQUENCE(0.45),CASH_ADVANCE_TXN(0.39),CREDIT_LIMIT(0.53) **\n\n**PURCHASES HAVE CORRELATION WITH ONE-OFF-PURCHASE(0.92),INSTALLEMENT_PURCHASE(0.68),PURCHASE_TXN(0.69),PAYMENT(0.6) **\n\n**ONE-OFF PURCHASE HAVE CORRELATION WITH ONE-OFF-PURCHASE-FREQUENCE(0.52),PURCHASE_TXN(0.55),PAYMENTS(0.57)**\n\n**INSTALLEMENT_PURCHASE HAVE CORRELATION WITH INSTALLEMENT_PURCHASE-FREQUENCE(0.51),& PURCHASE_TXN(0.63)**\n\n**CASH-ADVANCE-FREQUENCY HAVE CORRELATION WITH CASH_ADVANCE_FREQUENCE (0.63) & CASH_ADVANCE_TXN(0.66)**\n\n**PURCHASE-FREQUENCE HAVE CORRELATION WITH INSTALLEMENT_PURCHASE-FREQUENCE(.86) & PURCHASE_TXN(.57)**\n\n**ONE-OFF-PURCHASE-FREQUENCE HAVE CORRELATION WITH PURCHASE_TXN(0.54)**\n\n**INSTALLEMENT_PURCHASE-FREQUENCE HAVE CORRELATION WITH PURCHASE_TXN(0.53)**","f0d836d5":"**Horizontal line cutting 5 lines so we can consider cluster value k=6+1**"}}