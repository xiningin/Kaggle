{"cell_type":{"9603939f":"code","9809def2":"code","d896b260":"code","8d7c8d5d":"code","f185b00b":"code","734a9f41":"code","607ccb16":"code","14bb483e":"code","31ebf94a":"code","5dcad8e1":"code","bb0b2fcc":"code","41dcf487":"code","1e41eb2c":"code","c9602701":"code","72462ad4":"code","e6bdf275":"code","0fdbedd9":"code","0916b22d":"code","0a4fb244":"code","0106a37a":"code","a1426817":"code","3317c229":"code","ba3a83ed":"code","7968876d":"markdown","6280181a":"markdown"},"source":{"9603939f":"pip install auto-sklearn","9809def2":"# Import Lab\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom autosklearn.classification import AutoSklearnClassifier\n\n","d896b260":"# Load the well-known Breast Cancer dataset\n\ndf= pd.read_csv('..\/input\/breast-cancer-wisconsin\/Breast Cancer Prediction.csv')\ndf.head()","8d7c8d5d":"df.info()","f185b00b":"df.describe()","734a9f41":"import pandas_profiling as pp\npp.ProfileReport(df)","607ccb16":"sns.countplot(df['Class'],label=\"Count\")","14bb483e":"plt.figure(figsize=(20,10))\nsns.heatmap(df.corr(), annot=True, fmt='.0%')","31ebf94a":"x = df.iloc[:, 0:9].values \ny = df.iloc[:, 10].values ","5dcad8e1":"# Split into train and test sets\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state=23)","bb0b2fcc":"print(f'Training Shape x:',x_train.shape)\nprint(f'Testing Shape x:',x_test.shape)\nprint('*****___________*****___________*****')\nprint(f'Training Shape y:',x.shape)\nprint(f'Testing Shape y:',y.shape)","41dcf487":"# Auto-Sklearn Initialization\n\n# time_left_for_this_task : Time limit in seconds to find the optimal configuration\n# per_run_time_limi : Time limit in seconds for the each model\n# ensemble_size: Number of models added to the Ensemble model\n# initial_configurations_via_metalearning: \"k\" configurations to start the Bayesian Optimization\nmodel = AutoSklearnClassifier(time_left_for_this_task=300, \n                              per_run_time_limit=9, \n                              ensemble_size=1, \n                              initial_configurations_via_metalearning=0)\n# Init training\nmodel.fit(x_train, y_train)","1e41eb2c":"model.score(x_train, y_train)","c9602701":"model.score(x_test, y_test)","72462ad4":"print(model.sprint_statistics())","e6bdf275":"from sklearn.metrics import confusion_matrix, accuracy_score\ny_pred = model.predict(x_test)\ncm = confusion_matrix(y_test, y_pred)\nprint(f'CM:',cm)\nprint(f'Accuracy:',accuracy_score(y_test, y_pred)* 100 ,'%')","0fdbedd9":"conf_matrix = confusion_matrix(y_pred, y_test)\n\nprint(f'Confussion Matrix: \\n{conf_matrix}\\n')\n\nsns.heatmap(conf_matrix, annot=True)","0916b22d":"#Performance Measures\ntn = conf_matrix[0,0]\nfp = conf_matrix[0,1]\ntp = conf_matrix[1,1]\nfn = conf_matrix[1,0]\n\ntotal = tn + fp + tp + fn\nreal_positive = tp + fn\nreal_negative = tn + fp","0a4fb244":"accuracy  = (tp + tn) \/ total # Accuracy Rate\nprecision = tp \/ (tp + fp) # Positive Predictive Value\nrecall    = tp \/ (tp + fn) # True Positive Rate\nf1score  = 2 * precision * recall \/ (precision + recall)\nspecificity = tn \/ (tn + fp) # True Negative Rate\nerror_rate = (fp + fn) \/ total # Missclassification Rate\nprevalence = real_positive \/ total\nmiss_rate = fn \/ real_positive # False Negative Rate\nfall_out = fp \/ real_negative # False Positive Rate\n\nprint(f'Accuracy    : {accuracy}')\nprint(f'Precision   : {precision}')\nprint(f'Recall      : {recall}')\nprint(f'F1 score    : {f1score}')\nprint(f'Specificity : {specificity}')\nprint(f'Error Rate  : {error_rate}')\nprint(f'Prevalence  : {prevalence}')\nprint(f'Miss Rate   : {miss_rate}')\nprint(f'Fall Out    : {fall_out}')","0106a37a":"#Classification Report\nfrom sklearn.metrics import classification_report\nprint(classification_report(y_pred, y_test))","a1426817":"int(round(model.predict([[4,5,5,7,1,6,4,5,1]])[0]))","3317c229":"import joblib","ba3a83ed":"joblib.dump(model, 'model2.pkl')","7968876d":"\n<h1 style='background-color:Green; font-family:newtimeroman; font-size:250%; text-align:center; border-radius: 15px 50px;' > Auto-Sklearn <\/h1>\n\n\nThe Auto-Sklearn architecture is composed of 3 phases: meta-learning, bayesian optimization, ensemble selection. The key idea of the meta-learning phase is to reduce the space search by learning from models that performed well on similar datasets. Right after, the bayesian optimization phase takes the space search created in the meta-learning step and creates bayesian models for finding the optimal pipeline configuration. Finally, an ensemble selection model is created by reusing the most accurate models found in the bayesian optimization step. In Figure 2 it\u2019s described the Auto-Sklearn architectur\n\n\n\n<img src=\"https:\/\/miro.medium.com\/max\/1000\/1*w8qIzewO97qdqmiZi69Maw.jpeg\" width=\"800px\">","6280181a":"## **Datsset Breast Cancer Wisconsin**\n\n\n\n\n<img src=\"https:\/\/www.medgadget.com\/wp-content\/uploads\/2020\/10\/Breast-Cancer-Market.jpg\" width=\"800px\">\n\n\n\n\n\n\n\n## Data Set Information:\n\nSamples arrive periodically as Dr. Wolberg reports his clinical cases. The database therefore reflects this chronological grouping of the data. This grouping information appears immediately below, having been removed from the data itself:\n\nGroup 1: 367 instances (January 1989)\nGroup 2: 70 instances (October 1989)\nGroup 3: 31 instances (February 1990)\nGroup 4: 17 instances (April 1990)\nGroup 5: 48 instances (August 1990)\nGroup 6: 49 instances (Updated January 1991)\nGroup 7: 31 instances (June 1991)\nGroup 8: 86 instances (November 1991)\n-----------------------------------------\nTotal: 699 points (as of the donated datbase on 15 July 1992)\n\nNote that the results summarized above in Past Usage refer to a dataset of size 369, while Group 1 has only 367 instances. This is because it originally contained 369 instances; 2 were removed. The following statements summarizes changes to the original Group 1's set of data:\n\n##### Group 1 : 367 points: 200B 167M (January 1989)\n\n##### Revised Jan 10, 1991: Replaced zero bare nuclei in 1080185 & 1187805\n\n##### Revised Nov 22,1991: Removed 765878,4,5,9,7,10,10,10,3,8,1 no record\n##### : Removed 484201,2,7,8,8,4,3,10,3,4,1 zero epithelial\n##### : Changed 0 to 1 in field 6 of sample 1219406\n##### : Changed 0 to 1 in field 8 of following sample:\n##### : 1182404,2,3,1,1,1,2,0,1,1,1\n\n\n## Attribute Information:\n\n1. Sample code number: id number\n2. Clump Thickness: 1 - 10\n3. Uniformity of Cell Size: 1 - 10\n4. Uniformity of Cell Shape: 1 - 10\n5. Marginal Adhesion: 1 - 10\n6. Single Epithelial Cell Size: 1 - 10\n7. Bare Nuclei: 1 - 10\n8. Bland Chromatin: 1 - 10\n9. Normal Nucleoli: 1 - 10\n10. Mitoses: 1 - 10\n11. Class: (2 for benign, 4 for malignant)\n\n\n\n## Dataset in this link\n\n\n[Here](https:\/\/archive.ics.uci.edu\/ml\/datasets\/Breast+Cancer+Wisconsin+%28Original%29)"}}