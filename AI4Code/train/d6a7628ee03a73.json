{"cell_type":{"bb96cb2a":"code","15f315bf":"code","835b5b0e":"code","2e84e70b":"code","e3d6e773":"code","ce4b2516":"code","993086f3":"code","420449eb":"code","7f93e6a9":"code","bf019083":"code","e93fc13c":"code","f39e08a1":"code","c28e6d57":"code","81714ccd":"code","63aac800":"code","330afa1a":"code","5cfd9fc5":"code","84272b74":"code","b079097e":"code","b906f69f":"code","5a14d32b":"code","cd9fb0cc":"code","797d9255":"code","b168974a":"code","536f3bec":"code","dccd647b":"code","b878bcb2":"code","7baf2e78":"code","7f61f589":"code","f551d1b7":"code","de8f5191":"code","de0e2eb5":"markdown","05b1a9b0":"markdown","14585cdd":"markdown","c45db3ae":"markdown","53c9c25f":"markdown","d7f894f4":"markdown","a6e7d91a":"markdown"},"source":{"bb96cb2a":"import numpy as np\nimport pandas as pd","15f315bf":"df = pd.read_excel(\"\/kaggle\/input\/penguin data.xlsx\")","835b5b0e":"df.head()","2e84e70b":"df.shape","e3d6e773":"df.info()","ce4b2516":"df.describe(include = 'all')","993086f3":"#Drop unnecessary columns\ndf.drop(['studyName', 'Sample Number', 'Region', 'Stage', 'Individual ID', 'Date Egg' ,'Delta 15 N (o\/oo)', 'Delta 13 C (o\/oo)', 'Comments'], axis = 1, inplace = True)","420449eb":"#Remove latin name of the penguins\ndf = df.replace('\\(.*', '', regex=True)","7f93e6a9":"#Check the records with the null values\ndf[df['Culmen Length (mm)'].isna()]","bf019083":"#Let's drop these records\ndf = df[df['Culmen Length (mm)'].notnull()]","e93fc13c":"#There are 3 types of sex\ndf['Sex'].value_counts()","f39e08a1":"#Select sex value \".\"\ndf[df['Sex'] == '.']","c28e6d57":"#Let's see counts by Island and Sex\ndf.groupby(['Species', 'Island', 'Sex']).count()","81714ccd":"df['Sex'] = df['Sex'].replace('.', 'MALE')","63aac800":"#Some sex is missing\ndf[df['Sex'].isna()]","330afa1a":"#Check the counts by Sex\ndf.groupby(['Sex']).count()","5cfd9fc5":"df['Sex'] = df['Sex'].fillna('MALE')","84272b74":"df.count()","b079097e":"df.head()","b906f69f":"from sklearn.preprocessing import OneHotEncoder\nohe = OneHotEncoder(handle_unknown='ignore')\nencoded = pd.DataFrame(ohe.fit_transform(df[['Island', 'Clutch Completion', 'Sex']]).toarray())","5a14d32b":"#join original dataframe with the encoded one\ndf = df.join(encoded)","cd9fb0cc":"#rename columns after one hot encoding\nreal = ohe.get_feature_names(['Island', 'Clutch Completion', 'Sex'])\nkeys = np.array(df.columns[8:])\nnames = dict(zip(keys,real))\ndf.rename(columns = names, inplace = True)","797d9255":"df.head()","b168974a":"#transform target variable into codes\ndf['Species'] = df.Species.astype('category')\ndf['Species'] = df.Species.cat.codes","536f3bec":"#drop text attributes\ndf.drop(columns=['Island', 'Clutch Completion', 'Sex'], inplace = True)","dccd647b":"#drop nulls\ndf.dropna(inplace = True)","b878bcb2":"df","7baf2e78":"#build a decision tree classifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn import tree\nmodel = DecisionTreeClassifier()","7f61f589":"#fit the model\nmytree = model.fit(X = df[df.columns[1:]], y = df['Species'])","f551d1b7":"#plot the tree\ntree.plot_tree(mytree)","de8f5191":"#export to pdf\nimport graphviz \ndot_data = tree.export_graphviz(mytree, out_file=None) \ngraph = graphviz.Source(dot_data) \ngraph.render(\"penguins\") ","de0e2eb5":"there are more male penguins, therefore I will fill na with Male ones","05b1a9b0":"# 3 Feature engineering","14585cdd":"# 1 Imports","c45db3ae":"# 4 Modeling","53c9c25f":"# 2 Exploration","d7f894f4":"## 3.1 One Hot encoding","a6e7d91a":"Almost every species has the same count per sex, so let's replace '.' with female, to make it more equal"}}