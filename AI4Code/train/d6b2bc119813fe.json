{"cell_type":{"bd21fcd4":"code","9f62b1ff":"code","82468d37":"code","7d75d90d":"code","fa569704":"code","6c0754a4":"code","f182bcd5":"code","9cc6944c":"code","23602ad8":"code","a8cb6e7f":"code","152f2df7":"code","47022987":"code","3f58459f":"code","6452f47f":"code","5316931a":"code","769328ce":"markdown","72847dab":"markdown","d04c2681":"markdown","41af6e4f":"markdown","6ee09a3b":"markdown","730b7ba2":"markdown","9ff55f58":"markdown","8634ea19":"markdown","8b5cc5f6":"markdown","cd2567cf":"markdown","cf1e7bcd":"markdown","14dc81d4":"markdown","d23df57d":"markdown","8d8b2f09":"markdown","609e2504":"markdown","7b002881":"markdown","c4695389":"markdown","4aab02de":"markdown","6c9477a4":"markdown","1040b81f":"markdown"},"source":{"bd21fcd4":"import tensorflow as tf\nfrom keras.preprocessing.image import ImageDataGenerator","9f62b1ff":"tf.__version__","82468d37":"train_datagen = ImageDataGenerator(rescale = 1.\/255,\n                                   shear_range = 0.2,\n                                   zoom_range = 0.2,\n                                   horizontal_flip = True)\ntraining_set = train_datagen.flow_from_directory('..\/input\/pneumonia-xray-images\/train',\n                                                 target_size = (64, 64),\n                                                 batch_size = 32,\n                                                 class_mode = 'binary')","7d75d90d":"test_datagen = ImageDataGenerator(rescale = 1.\/255)\ntest_set = test_datagen.flow_from_directory('..\/input\/pneumonia-xray-images\/test',\n                                            target_size = (64, 64),\n                                            batch_size = 32,\n                                            class_mode = 'binary')","fa569704":"cnn = tf.keras.models.Sequential()","6c0754a4":"cnn.add(tf.keras.layers.Conv2D(filters=32, kernel_size=3, activation='relu', input_shape=[64, 64, 3]))","f182bcd5":"cnn.add(tf.keras.layers.MaxPool2D(pool_size=2, strides=2))","9cc6944c":"cnn.add(tf.keras.layers.Conv2D(filters=32, kernel_size=3, activation='relu'))\ncnn.add(tf.keras.layers.MaxPool2D(pool_size=2, strides=2))","23602ad8":"cnn.add(tf.keras.layers.Flatten())","a8cb6e7f":"cnn.add(tf.keras.layers.Dense(units=128, activation='relu'))","152f2df7":"cnn.add(tf.keras.layers.Dense(units=1, activation='sigmoid'))","47022987":"cnn.compile(optimizer = 'adam', loss = 'binary_crossentropy', metrics = ['accuracy'])","3f58459f":"cnn.fit(x = training_set, validation_data = test_set, epochs = 10)","6452f47f":"import numpy as np\nfrom keras.preprocessing import image\ntest_image = image.load_img('..\/input\/pneumonia-xray-images\/test\/normal\/IM-0011-0001-0001.jpeg', target_size = (64, 64))\ntest_image = image.img_to_array(test_image)\ntest_image = np.expand_dims(test_image, axis = 0)\nresult = cnn.predict(test_image)\ntraining_set.class_indices\nif result[0][0] == 1:\n  prediction = 'normal'\nelse:\n  prediction = 'opacity'","5316931a":"print(prediction)","769328ce":"### Step 4 - Full Connection","72847dab":"## Part 2 - Building the CNN","d04c2681":"## Part 3 - Training the CNN","41af6e4f":"## Part 1 - Data Preprocessing","6ee09a3b":"## Part 4 - Making a single prediction","730b7ba2":"### Importing the libraries","9ff55f58":"### Initialising the CNN","8634ea19":"### Pneumonia detection using CNN","8b5cc5f6":"### Step 5 - Output Layer","cd2567cf":"# Convolutional Neural Network","cf1e7bcd":"### Adding a second convolutional layer","14dc81d4":"### Step 1 - Convolution","d23df57d":"### Preprocessing the Training set","8d8b2f09":"### Step 2 - Pooling","609e2504":"### Compiling the CNN","7b002881":"### Training the CNN on the Training set and evaluating it on the Test set","c4695389":"### Image classification ","4aab02de":"### Preprocessing the Test set","6c9477a4":"### for more accuracy increase number of epochs","1040b81f":"### Step 3 - Flattening"}}