{"cell_type":{"86fd0e19":"code","ea804141":"code","15f56e2f":"code","c792c94c":"code","e61a8c40":"code","288d45ce":"code","e5022b78":"code","7df7b3fa":"code","9194f1d6":"code","1b5fa820":"code","59296bf2":"code","141c4f43":"code","46e188aa":"code","efe133d6":"code","f58f305f":"code","84063cff":"code","72e4fe80":"code","ce878938":"code","6a76490c":"code","7d2fa1e3":"code","72f4548f":"code","40036bfe":"code","ed6e5ef2":"code","16b31769":"code","98094e9d":"code","40ec7649":"code","3a1aecdd":"code","f107d115":"code","75e8981f":"code","b01e1895":"markdown","04a281ee":"markdown","b8251c93":"markdown","af7497da":"markdown","e2fc0f76":"markdown","e2e552f9":"markdown","ee09aa9d":"markdown","d3dd0b4a":"markdown","0d15cc45":"markdown","18921449":"markdown","59727856":"markdown","d44453d9":"markdown","4e0fd8dd":"markdown","c45ea111":"markdown","b35248d5":"markdown","d52571ba":"markdown","9c4cd744":"markdown"},"source":{"86fd0e19":"# numerical analysis\nimport numpy as np\n# processing and storing in dataframe\nimport pandas as pd\n\n# basic plotting\nimport matplotlib.pyplot as plt\n# advanced plotting\nimport seaborn as sns\n# interactive plotting\nimport plotly.express as px\n\n# dealing with geographic data\nimport geopandas as gpd\n# to get geolocation \nfrom geopandas.tools import geocode","ea804141":"def plot_cfr(epidemic, mid, end):\n    '''Plot case fatality rate'''\n    inc_day = []\n    for i in range(1, 101):\n        if(i<=mid):\n            inc_day.append(2)\n        elif(i<end):\n            inc_day.append(1)\n        else:\n            inc_day.append(0)\n    inc_day = np.array(inc_day)\n    inc_day = inc_day.reshape(20, 5).T\n    \n    fig, ax = plt.subplots(figsize=(10, 5))\n    ax=sns.heatmap(inc_day, linewidths=2, square=True, xticklabels='', \n                   yticklabels='', ax=ax, cbar=False, \n                   cmap=['darkgray', 'coral','orangered'])\n    ax.set_title(epidemic, fontdict={'fontsize':16}, loc='left', pad=15)\n    \n    plt.show()","15f56e2f":"def plot_cal(title, start, end):\n    '''Plot incubation period'''\n    inc_day = []\n    for i in range(1, 29):\n        if(i>=start and i<=end):\n            inc_day.append(1)\n        else:\n            inc_day.append(0)\n            \n    inc_day = np.array(inc_day)\n    inc_day = inc_day.reshape(4, 7)\n    \n    fig, ax = plt.subplots(figsize=(6, 3))\n    ax=sns.heatmap(inc_day, linewidths=2, square=True, \n                   xticklabels='', yticklabels='', ax=ax,\n                   cbar=False, cmap=['whitesmoke','royalblue'])\n    ax.set_title(title, fontdict={'fontsize':16}, loc='left', pad=15)\n    \n    plt.show()","c792c94c":"# importing datasets\ndf = pd.read_csv('..\/input\/ebola-outbreak-20142016-complete-dataset\/ebola_2014_2016_clean.csv', \n                 parse_dates=['Date'])\n\n# first few rows\ndf.head()","e61a8c40":"# rename columns\ndf.columns = ['Country', 'Date', 'Cumulative no. cases', 'Cumulative no. deaths']\n\n# fix data\nfor col in ['Cumulative no. cases', 'Cumulative no. deaths']:\n    # fill na with 0\n    df[col] = df[col].fillna(0)\n    # convert data type to 'int'\n    df[col] = df[col].astype('int')\n    \n# group by date and country\ndf = df.groupby(['Date', 'Country'])['Cumulative no. cases', 'Cumulative no. deaths'].sum()\n\n# reset index\ndf = df.reset_index()\n\n# CFR\ndf['CFR'] = round((df['Cumulative no. deaths'] \/ df['Cumulative no. cases']) * 100, 2)\n\n# first few rows\ndf.head()","288d45ce":"# new cases ======================================================\ntemp = df.groupby(['Country', 'Date', ])['Cumulative no. cases', 'Cumulative no. deaths']\ntemp = temp.sum().diff().reset_index()\n\nmask = temp['Country'] != temp['Country'].shift(1)\n\ntemp.loc[mask, 'Cumulative no. cases'] = np.nan\ntemp.loc[mask, 'Cumulative no. deaths'] = np.nan\n\n# renaming columns\ntemp.columns = ['Country', 'Date', 'New cases', 'New deaths']\n\n# merging new values\ndf = pd.merge(df, temp, on=['Country', 'Date'])\n\n# filling na with 0\ndf = df.fillna(0)\n\n# fixing data types\ncols = ['New cases', 'New deaths']\ndf[cols] = df[cols].astype('int')\n\ndf['New cases'] = df['New cases'].apply(lambda x: 0 if x<0 else x)\n\ndf.head()","e5022b78":"# load countries map\nworld_map = gpd.read_file('..\/input\/human-development-index-hdi\/countries.geojson')\n# avoid Antartica\nworld_map = world_map[world_map['name']!='Antarctica']\n# select only important columns\nworld_map = world_map[['name', 'continent', 'geometry']]\n# first few rows\nworld_map.head()","7df7b3fa":"# First EVD reported locations\n# ============================\n\n# print(geocode('Nzara, South Sudan'))\n# # > 4.6340\u00b0 N, 28.2644\u00b0 E\n\n# print(geocode('Yambuku, DRC'))\n# # > 2.8250\u00b0 N, 22.2250\u00b0 E","9194f1d6":"# First cases of Wester AFrica Ebola Outbreak of 2013-2014\n# ========================================================\n\n# print(geocode('Meliandou, Guinea'))\n# # > 8.6161\u00b0 N, 10.0612\u00b0 W","1b5fa820":"fig, ax = plt.subplots(figsize=(18, 14))\nsns.set_style('whitegrid')\n\nworld_map.plot(ax=ax, color='gainsboro')\nax.set_title('EVD first appeared in 1976 in 2 simultaneous outbreaks, \\n  1. Nzara, South Sudan, \\n  2. Yambuku, DRC', \n             loc='left', fontdict={'fontsize': 16, \n                                   'fontfamily': 'monospace', \n                                   'fontweight': 'bold',\n                                   'color': 'black'})\n\nax.scatter(28.2644, 4.6340, color='orangered', s=150, alpha=0.8)\nax.text(34.2644, 5.6340, 'Nzara, South Sudan', \n        fontfamily='monospace', fontsize=12, fontweight='bold',\n        color='white', backgroundcolor='black')\n\nax.scatter(22.2250, 2.8250, color='orangered', s=150, alpha=0.8)\nax.text(-18.2250, -1.8250, 'Yambuku, DRC', \n        fontfamily='monospace', fontsize=12, fontweight='bold',\n        color='white', backgroundcolor='black')\n\nax.set_axis_off()","59296bf2":"plot_cfr('The average CFR of EVD is around 50%', 50, 50)","141c4f43":"plot_cal('Incubation period of Ebola is from 2 to 21 days', 2, 21)","46e188aa":"latest = df[df['Date']==max(df['Date'])]\nlatest = latest.sort_values('Cumulative no. cases', ascending=False)\nlatest = latest.reset_index()\nlatest","efe133d6":"fig = px.choropleth(latest, locations=\"Country\", locationmode='country names',\n                    color=\"Cumulative no. cases\", hover_name=\"Country\", \n                    color_continuous_scale=\"Sunsetdark\", \n                    title='Geographical distribution of Cumulative no. of cases')\nfig.update(layout_coloraxis_showscale=False)\nfig.show()","f58f305f":"fig = px.choropleth(df, locations=\"Country\", color=\"Cumulative no. cases\",\n                    locationmode='country names', hover_name=\"Country\", \n                    animation_frame=df[\"Date\"].dt.strftime('%Y-%m-%d'),\n                    title='Ebola spread over time', color_continuous_scale=\"Sunsetdark\")\nfig.update(layout_coloraxis_showscale=False)\nfig.show()","84063cff":"fig = px.treemap(latest.sort_values(by=\"Cumulative no. cases\", ascending=False).reset_index(drop=True), \n                 path=[\"Country\"], values=\"Cumulative no. cases\", \n                 title='Proportion of Cumulative no. of cases',\n                 color_discrete_sequence = px.colors.qualitative.Dark2)\nfig.data[0].textinfo = 'label+text+value'\nfig.show()","72e4fe80":"# fig, ax = plt.subplots(figsize=(15, 7))\n# sns.set_style('darkgrid')\n\n# sns.barplot(data=latest, x='Cumulative no. cases', y='Country', color='midnightblue', ax=ax)\n# sns.barplot(data=latest, x='Cumulative no. deaths', y='Country', color='royalblue', ax=ax)\n\n# for ind, row in latest.iterrows():\n#     s = str(row['Cumulative no. cases']) + ' (' + str(row['Cumulative no. deaths']) + ')'\n#     ax.text(row['Cumulative no. cases']+100, ind+0.1, s, fontsize=12)\n    \n# ax.set_title('No. of Cases (No. of Deaths in brackets)', loc='left', pad=10, fontsize=16)\n# ax.set_xlabel('')\n# ax.set_ylabel('')\n\n# plt.show()","ce878938":"def plot_barh(col):\n    '''Plot horizontal bar chart on cumulative count on given column'''\n    temp_df = latest.sort_values(col, ascending=False)\n#     temp_df = temp_df[temp_df[col]!=0]\n    fig =  px.bar(temp_df, x=col, y='Country', orientation='h', \n                  color='Country', text=col, title=col, width=700, \n                  hover_data = ['Cumulative no. cases', \n                                'Cumulative no. deaths', \n                                'CFR'],\n                  color_discrete_sequence = px.colors.qualitative.Dark2)\n    fig.update_traces(textposition='auto')\n    fig.update_layout(xaxis_title=\"\", yaxis_title=\"\", showlegend=False,\n                      uniformtext_minsize=8, uniformtext_mode='hide')\n    fig.show()","6a76490c":"plot_barh('Cumulative no. cases')","7d2fa1e3":"plot_barh('Cumulative no. deaths')","72f4548f":"plot_barh('CFR')","40036bfe":"temp = df.groupby('Date')['Cumulative no. cases', 'Cumulative no. deaths'].sum()\ntemp = temp.reset_index()\ntemp = temp.melt(id_vars='Date', value_vars=['Cumulative no. cases', 'Cumulative no. deaths'],\n                var_name='Reported', value_name='Count')\nfig = px.line(temp, x=\"Date\", y=\"Count\", color='Reported', facet_col=\"Reported\",\n              title='Number of cases')\nfig.show()","ed6e5ef2":"def plot_stacked(col):\n    temp = df.groupby([df['Date'].dt.strftime('%Y-%m-01'), 'Country']) \\\n            ['Cumulative no. cases', 'Cumulative no. deaths', 'New cases', 'New deaths'].max()\n    temp = temp.reset_index()\n    \n    fig = px.area(temp, x=\"Date\", y=col, color='Country', orientation='v',\n             title='Cases', color_discrete_sequence = px.colors.qualitative.Prism)\n    fig.show()","16b31769":"plot_stacked('Cumulative no. cases')","98094e9d":"plot_stacked('New cases')","40ec7649":"high_df = latest.iloc[:3]\nhigh_melt = high_df.melt(id_vars = 'Country', \n                         value_vars=['Cumulative no. cases', 'Cumulative no. deaths'], \n                         var_name='Case', value_name='Count')","3a1aecdd":"fig = px.bar(high_melt, x='Count', y='Country', color='Case', text='Count',\n             orientation='h', width=700, height=400, barmode='group', \n             color_discrete_sequence=['#444444', 'orangered'])\nfig.update_layout(title='No. of cases and deaths', xaxis_title=\"\", yaxis_title=\"\")\nfig.update_layout(yaxis={'categoryorder':'total ascending'})\nfig.show()","f107d115":"low_df = latest.iloc[3:]\nlow_melt = low_df.melt(id_vars = 'Country', \n                       value_vars=['Cumulative no. cases', 'Cumulative no. deaths'], \n                       var_name='Case', value_name='Count')","75e8981f":"fig = px.bar(low_melt, x='Count', y='Country', color='Case', text='Count',\n             orientation='h', width=700, barmode='group', \n             color_discrete_sequence=['#444444', 'orangered'])\nfig.update_layout(title='No. of cases and deaths', xaxis_title=\"\", yaxis_title=\"\")\nfig.update_layout(barmode='group', yaxis={'categoryorder':'total ascending'})\nfig.show()","b01e1895":"### Geo Map","04a281ee":"## Utility Functions","b8251c93":"### CFR (the proportion of people who die from a specified disease among all individuals diagnosed with the disease)\n\n> * The average CFR of EVD is around 50%. CFR have varied from 25% to 90% in past outbreaks.","af7497da":"## References\n> * Wikipedia Link : https:\/\/en.wikipedia.org\/wiki\/Western_African_Ebola_virus_epidemic  \n> * WHO Link : https:\/\/www.who.int\/csr\/disease\/ebola\/en\/  \n> * CDC Link : https:\/\/www.cdc.gov\/vhf\/ebola\/index.html  \n> * Kaggle Dataset : https:\/\/www.kaggle.com\/imdevskp\/ebola-outbreak-20142016-complete-dataset","e2fc0f76":"## Ebola Virus Disease (EVD)\n\n> ### First Found \n> * The Ebola virus causes an acute, serious illness which is often fatal if untreated.  \n> * EVD first appeared in 1976 in 2 simultaneous outbreaks, one in what is now **Nzara, South Sudan**, and the other in **Yambuku, DRC**.  \n> * The latter occurred in a village near the **Ebola River**, from which the disease takes its name.  ","e2e552f9":"## 2014-2016 Ebola outbreak in West Africa\n\n### First found\n> * On **March 23, 2014**, the WHO reported cases of Ebola Virus Disease (EVD) in the forested rural region of southeastern **Guinea**. \n> * The identification of these early cases marked the beginning of the West Africa Ebola epidemic, the largest in history. \n> * The initial case, or **index patient**, was reported in December 2013. \n> * An 18-month-old boy from a small village in Guinea is believed to have been infected by bats. \n\n\n### Symptoms  \n> * Symptoms of EVD can be sudden and include: Fever, Fatigue, Muscle pain, Headache, Sore throat.  \n> * This is followed by: Vomiting, Diarrhoea, Rash, Symptoms of impaired kidney and liver function  \n> * In some cases, both internal and external bleeding (for example, oozing from the gums, or blood in the stools).  \n> * Laboratory findings include low white blood cell and platelet counts and elevated liver enzymes.  ","ee09aa9d":"## Less affected countries","d3dd0b4a":"# Over the time","0d15cc45":"## Libraries","18921449":"### Data Cleaning","59727856":"### Location Data\n> (sometimes geocode doesn't work)","d44453d9":"### Incubation period (time interval from infection with the virus to onset of symptoms)\n> Incubation period of Ebola is from 2 to 21 days. A person infected with Ebola cannot spread the disease until they develop symptoms.","4e0fd8dd":"### Transmission\n> One can get EVD  \n> * through direct contact with infected animal (bat or nonhuman primate) or  \n> * contact with sick or dead person infected with EVD .\n\n### Vaccines\n> * Vaccines to protect against Ebola are under development and have been used to help control the spread of Ebola outbreaks in Guinea and in the Democratic Republic of the Congo (DRC)","c45ea111":"## Highly affected countries","b35248d5":"### Import Data","d52571ba":"## Exploring the Dataset","9c4cd744":"## Dataset"}}