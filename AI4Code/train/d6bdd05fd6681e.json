{"cell_type":{"2a854a15":"code","c156b450":"code","dfc01e70":"code","3b9c2e5c":"code","6f834e96":"code","0bc9638b":"code","57ab77a0":"code","9f0a741e":"code","c75aba6e":"code","608e0068":"code","de59fa98":"code","381f3b61":"code","828fc317":"code","ed463497":"code","51dfeea6":"code","85da7b80":"code","037800da":"code","37840c29":"code","950d8bbf":"code","3e5f6401":"code","4e127909":"code","c8261394":"code","92e15021":"code","0f1cdd8f":"code","b5cfe2a8":"code","105b21e1":"code","504bcedd":"code","3717808e":"code","84ce52a1":"code","4669f9d0":"code","5a4a4a4c":"code","03f30d43":"code","800ad90b":"code","7e0ca41a":"code","3af5fe94":"code","921358f9":"code","ac1493f6":"code","b2d1918a":"markdown","12246fb1":"markdown","e77e2db7":"markdown","e6ebe3c2":"markdown","3fd5a4ee":"markdown","f0942ac7":"markdown","0b194d5c":"markdown","ec0293d9":"markdown","6052d4f3":"markdown","2b6532a9":"markdown","8b1b04d6":"markdown"},"source":{"2a854a15":"#importing libraries\n\nimport numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport seaborn as sns\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom imblearn.over_sampling import SMOTE\nfrom sklearn.ensemble import ExtraTreesClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import accuracy_score, classification_report\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\n","c156b450":"df = pd.read_csv('..\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv')","dfc01e70":"df.head()","3b9c2e5c":"df.isnull().sum()","6f834e96":"plt.figure(figsize = (8,5))\nsns.heatmap(df.isnull())","0bc9638b":"df['bmi'].fillna(df['bmi'].mean(), inplace = True)","57ab77a0":"df.isnull().sum()","9f0a741e":"df.drop('id', axis = 1,inplace = True)","c75aba6e":"df.head()","608e0068":"df.info()","de59fa98":"en = LabelEncoder()\n\ncols = ['gender', 'ever_married', 'work_type', 'Residence_type', 'smoking_status']\nfor col in cols:\n  df[col] = en.fit_transform(df[col])","381f3b61":"df.head()","828fc317":"sns.pairplot(df)","ed463497":"plt.figure(figsize = (10,8))\nsns.heatmap(df.corr(), annot = True)","51dfeea6":"plt.figure(figsize = (15,10))\nplt.subplot(2,2,1)\ndf['bmi'].plot.box()\n\nplt.subplot(2,2,2)\ndf['age'].plot.box()","85da7b80":"df.stroke.value_counts()","037800da":"x = df.drop('stroke', axis = 'columns')\ny = df['stroke']","37840c29":"pip install imbalanced-learn","950d8bbf":"smote = SMOTE(sampling_strategy = 'minority')\nx_sm, y_sm = smote.fit_resample(x,y)","3e5f6401":"y_pd = pd.DataFrame(y_sm)\nx_pd = pd.DataFrame(x_sm)","4e127909":"y_pd.value_counts()","c8261394":"mod = ExtraTreesClassifier()\nfeat = mod.fit(x_pd, y_pd)\nfeat.feature_importances_","92e15021":"imp = pd.Series(feat.feature_importances_, index = x_pd.columns)\nimp.nlargest(9).plot(kind = 'barh')","0f1cdd8f":"plot = imp.nlargest(9)\nplot.index","b5cfe2a8":"coll = ['age', 'avg_glucose_level', 'bmi', 'work_type', 'smoking_status', 'Residence_type', 'gender', 'ever_married', 'hypertension']","105b21e1":"x_new = x_pd[coll]","504bcedd":"x_sm.shape","3717808e":"x_new.shape","84ce52a1":"x_train, x_test, y_train, y_test = train_test_split(x_new, y_pd, test_size = 0.2, random_state = 5)","4669f9d0":"mode = RandomForestClassifier()\nmode.fit(x_train, y_train)\ny_pre = mode.predict(x_test)\naccuracy_score(y_test, y_pre)","5a4a4a4c":"cr = classification_report(y_test, y_pre)\nprint(cr)","03f30d43":"m = DecisionTreeClassifier()\nm.fit(x_train, y_train)\ny_predd = m.predict(x_test)\naccuracy_score(y_test, y_predd)","800ad90b":"cr = classification_report(y_test, y_predd)\nprint(cr)","7e0ca41a":"model = KNeighborsClassifier(n_neighbors = 4)\nmodel.fit(x_train, y_train)\ny_pred = model.predict(x_test)\naccuracy_score(y_test, y_pred)","3af5fe94":"cr = classification_report(y_test, y_pred)\nprint(cr)","921358f9":"med = LogisticRegression()\nmed.fit(x_train, y_train)\ny_pr = m.predict(x_test)\naccuracy_score(y_test, y_pr)","ac1493f6":"cr = classification_report(y_test, y_pr)\nprint(cr)","b2d1918a":"# Handling Categorical Features","12246fb1":"# K-Nearest Neighbors","e77e2db7":"# Train Test Split","e6ebe3c2":"# Handling Imbalanced Data","3fd5a4ee":"# Feature Selection\/Feature Importances","f0942ac7":"# Data Visualization","0b194d5c":"# Random Forest Classifier # ","ec0293d9":"# Stroke Prediction\n\nusing:\n* K Nearest Neighbors\n* Decision Tree Classifier\n* Random Forest Classifier\n* Logistic Regression","6052d4f3":"# Model Building and evaluation","2b6532a9":"# Decision Tree Classifier","8b1b04d6":"# Logistic Regression"}}