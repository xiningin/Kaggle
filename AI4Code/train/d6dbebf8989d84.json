{"cell_type":{"bb17edfa":"code","cea1248d":"code","317de514":"code","91d81e56":"code","3cc5b87c":"code","9cd577d2":"code","463a648a":"code","09054930":"code","390b26c1":"code","303aaf97":"markdown","6b66d52e":"markdown","db6cc2d7":"markdown","fb9a1ec3":"markdown"},"source":{"bb17edfa":"!pip install fastai --upgrade -q\nfrom fastai.vision.all import *\n\nfrom fastai.callback.cutmix import *","cea1248d":"path = Path('..\/input\/Imagenette-comp\/')","317de514":"data = DataBlock(blocks = (ImageBlock, CategoryBlock),\n                 get_items=get_image_files, \n                 splitter=RandomSplitter(seed=42),\n                 get_y=parent_label,\n                 item_tfms=RandomResizedCrop(460),\n                 batch_tfms = [*aug_transforms(size=224, min_scale=0.75),\n                               Normalize.from_stats(*imagenet_stats)]\n                )\ndls = data.dataloaders(path\/'train')","91d81e56":"dls.show_batch(nrows=2, ncols=3)","3cc5b87c":"learn = cnn_learner(dls, resnet34, metrics=error_rate, cbs=CutMix)\nlearn.lr_find()","9cd577d2":"learn.fine_tune(5, 3e-3, freeze_epochs=2)","463a648a":"df = pd.read_csv('..\/input\/Imagenette-comp\/sample_submission.csv')\ndf","09054930":"tst_dl = learn.dls.test_dl([path\/'test'\/(i+'.jpg') for i in df['Id']])\npredictions = learn.tta(dl = tst_dl)\npredlist = [learn.dls.vocab[np.argmax(i)] for i in predictions[0]]\ndf['Category'] = predlist","390b26c1":"df.to_csv('submission.csv', index=False)\ndf","303aaf97":"# Prediction","6b66d52e":"# Setup Env","db6cc2d7":"# Import Data","fb9a1ec3":"# Training"}}