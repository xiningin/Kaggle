{"cell_type":{"678b7526":"code","c566ea65":"code","715b422a":"code","aa6c30a4":"code","4dff80da":"code","5d7663e5":"code","5911bf03":"code","1f8e942d":"code","9aa1a04f":"code","8dd8ebce":"code","9f6c60e0":"code","3e094d1b":"markdown"},"source":{"678b7526":"import numpy as np\nimport pandas as pd\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\nimport seaborn as sns","c566ea65":"%matplotlib inline\n# CONFIG\nmpl.rcParams['figure.figsize'] = 8, 6\npd.options.mode.chained_assignment = None  # default='warn'\nsns.set(style='whitegrid', palette='muted', font_scale=1.5)","715b422a":"%%time\n# LOAD DATA\ntrain = pd.read_csv('\/kaggle\/input\/covid19-local-us-ca-forecasting-week-1\/ca_train.csv')\n# SCRUB DATA\njunk =['Id','Country\/Region','Lat','Long','Province\/State']\ntrain.drop(junk, axis=1, inplace=True)\n# LOAD MISSING CASE DATA\norg = pd.read_csv('\/kaggle\/input\/gthubdata-new\/time_series_19-covid-Confirmed.csv')\nus = org[org['Country\/Region']=='US']\ndays = us.columns[4:]\nca_state = us[us['Province\/State']=='California']\nca_counties = us[us['Province\/State'].str.find('CA')>0]\nmissing=(ca_counties[days].sum() + ca_state[days])[days[4:48]]\n# LOAD MISSING DEATH DATA\nxx = pd.read_csv('\/kaggle\/input\/gthubdata-new\/time_series_19-covid-Deaths.csv')\nus_death = xx[xx['Country\/Region']=='US']\ndays = us_death.columns[4:]\nca_state_death = us_death[us_death['Province\/State']=='California']\nca_counties_death = us_death[us_death['Province\/State'].str.find('CA')>0]\nmissing_death=(ca_counties_death[days].sum() + ca_state_death[days])[days[40:48]]\n# LOAD WEATHER DATA\nweather = pd.read_csv('\/kaggle\/input\/noaa-california-weather\/2087824.csv')\n# SCRUB WEATHER DATA\nempty=['STATION','SNOW','SNWD']\nweather.drop(empty, axis=1, inplace=True)\n","aa6c30a4":"# ADD MISSING CASE DATA\ntrain.ConfirmedCases.loc[4]=int(missing['1\/26\/20'])\ntrain.ConfirmedCases.loc[5]=int(missing['1\/27\/20'])\ntrain.ConfirmedCases.loc[6]=int(missing['1\/28\/20'])\ntrain.ConfirmedCases.loc[7]=int(missing['1\/29\/20'])\ntrain.ConfirmedCases.loc[8]=int(missing['1\/30\/20'])\ntrain.ConfirmedCases.loc[9]=int(missing['1\/31\/20'])\ntrain.ConfirmedCases.loc[10]=int(missing['2\/1\/20'])\ntrain.ConfirmedCases.loc[11]=int(missing['2\/2\/20'])\ntrain.ConfirmedCases.loc[12]=int(missing['2\/3\/20'])\ntrain.ConfirmedCases.loc[13]=int(missing['2\/4\/20'])\ntrain.ConfirmedCases.loc[14]=int(missing['2\/5\/20'])\ntrain.ConfirmedCases.loc[15]=int(missing['2\/6\/20'])\ntrain.ConfirmedCases.loc[16]=int(missing['2\/7\/20'])\ntrain.ConfirmedCases.loc[17]=int(missing['2\/8\/20'])\ntrain.ConfirmedCases.loc[18]=int(missing['2\/9\/20'])\ntrain.ConfirmedCases.loc[19]=int(missing['2\/10\/20'])\ntrain.ConfirmedCases.loc[20]=int(missing['2\/11\/20'])\ntrain.ConfirmedCases.loc[21]=int(missing['2\/12\/20'])\ntrain.ConfirmedCases.loc[22]=int(missing['2\/13\/20'])\ntrain.ConfirmedCases.loc[23]=int(missing['2\/14\/20'])\ntrain.ConfirmedCases.loc[24]=int(missing['2\/15\/20'])\ntrain.ConfirmedCases.loc[25]=int(missing['2\/16\/20'])\ntrain.ConfirmedCases.loc[26]=int(missing['2\/17\/20'])\ntrain.ConfirmedCases.loc[27]=int(missing['2\/18\/20'])\ntrain.ConfirmedCases.loc[28]=int(missing['2\/19\/20'])\ntrain.ConfirmedCases.loc[29]=int(missing['2\/20\/20'])\ntrain.ConfirmedCases.loc[30]=int(missing['2\/21\/20'])\ntrain.ConfirmedCases.loc[31]=int(missing['2\/22\/20'])\ntrain.ConfirmedCases.loc[32]=int(missing['2\/23\/20'])\ntrain.ConfirmedCases.loc[33]=int(missing['2\/24\/20'])\ntrain.ConfirmedCases.loc[34]=int(missing['2\/25\/20'])\ntrain.ConfirmedCases.loc[35]=int(missing['2\/26\/20'])\ntrain.ConfirmedCases.loc[36]=int(missing['2\/27\/20'])\ntrain.ConfirmedCases.loc[37]=int(missing['2\/28\/20'])\ntrain.ConfirmedCases.loc[38]=int(missing['2\/29\/20'])\ntrain.ConfirmedCases.loc[39]=int(missing['3\/1\/20'])\ntrain.ConfirmedCases.loc[40]=int(missing['3\/2\/20'])\ntrain.ConfirmedCases.loc[41]=int(missing['3\/3\/20'])\ntrain.ConfirmedCases.loc[42]=int(missing['3\/4\/20'])\ntrain.ConfirmedCases.loc[43]=int(missing['3\/5\/20'])\ntrain.ConfirmedCases.loc[44]=int(missing['3\/6\/20'])\ntrain.ConfirmedCases.loc[45]=int(missing['3\/7\/20'])\ntrain.ConfirmedCases.loc[46]=int(missing['3\/8\/20'])\ntrain.ConfirmedCases.loc[47]=int(missing['3\/9\/20'])\n# ADD MISSING DEATH DATA\ntrain.Fatalities.loc[42]=int(missing_death['3\/4\/20'])\ntrain.Fatalities.loc[43]=int(missing_death['3\/5\/20'])\ntrain.Fatalities.loc[44]=int(missing_death['3\/6\/20'])\ntrain.Fatalities.loc[45]=int(missing_death['3\/7\/20'])\ntrain.Fatalities.loc[46]=int(missing_death['3\/8\/20'])\ntrain.Fatalities.loc[47]=int(missing_death['3\/9\/20'])","4dff80da":"train.plot(subplots=False)","5d7663e5":"# CALCULATE EXPANSION TABLE\ndiff_conf, conf_old = [], 0 \ndiff_fat, fat_old = [], 0\ndd_conf, dc_old = [], 0\ndd_fat, df_old = [], 0\n\nfor row in train.values:\n    diff_conf.append(row[1]-conf_old)\n    conf_old=row[1]\n    diff_fat.append(row[2]-fat_old)\n    fat_old=row[2]\n    dd_conf.append(diff_conf[-1]-dc_old)\n    dc_old=diff_conf[-1]\n    dd_fat.append(diff_fat[-1]-df_old)\n    df_old=diff_fat[-1]\n    \nprint(len(diff_conf),train.shape)","5911bf03":"# POPULATE DATAFRAME FEATURES\ntrain['CasePerDay'] = diff_conf\ntrain['DeathPerDay'] = diff_fat\ntrain['CaseDifferential'] = dd_conf\ntrain['DeathDifferential'] = dd_fat\n# PREP TRAIN DATA \n#train = train[:-1] ","1f8e942d":"train.plot(subplots=True)","9aa1a04f":"weather.plot(subplots=True)","8dd8ebce":"# ADD WEATHER FEATURES\ntrain['Rain'] = weather['PRCP']\ntrain['TempMin'] = weather['TMIN']\ntrain['TempMax'] = weather['TMAX']\n\n# MISSING WEATHER DATA (3\/20-24)\ntrain.TempMax[58] = 64\ntrain.TempMin[58] = 48\ntrain.Rain[58] = 0.0\ntrain.TempMax[59] = 63\ntrain.TempMin[59] = 49\ntrain.Rain[59] = 0.0\ntrain.TempMax[60] = 67\ntrain.TempMin[60] = 51\ntrain.Rain[60] = 0.01\ntrain.TempMax[61] = 55\ntrain.TempMin[61] = 50\ntrain.Rain[61] = 0.0\ntrain.TempMax[62] = 56\ntrain.TempMin[62] = 48\ntrain.Rain[62] = 0.0\ntrain[60:]","9f6c60e0":"corrmat = train.corr()\nf, ax = plt.subplots(figsize=(8, 6))\nsns.heatmap(corrmat, vmax=.8, square=True);","3e094d1b":"This notebook attempts to model the California outbreak from Day 0.\n\n* Missing Infection Data\n* Taylor Series\n* NOAA Weather Data (San Francisco, CA) \n* Precipitation Correlation Heatmap"}}