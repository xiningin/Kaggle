{"cell_type":{"cfa42036":"code","80e6cbd2":"code","a8706da6":"code","220bde9d":"code","05e6fb29":"code","ef9392f3":"code","59051aaf":"code","d1a5b0dc":"code","4ef410c2":"code","d7b187a4":"markdown","deb8866b":"markdown","323e5e61":"markdown","c9fb04b6":"markdown","a21e3dde":"markdown"},"source":{"cfa42036":"import os\n\nfrom pathlib import Path\n\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\nfrom sklearn.metrics import accuracy_score, confusion_matrix\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import KNeighborsClassifier","80e6cbd2":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","a8706da6":"%%time\n\npath_input = Path('\/kaggle\/input\/digit-recognizer\/')\n\ndf_train = pd.read_csv(path_input \/ 'train.csv')\ndf_test  = pd.read_csv(path_input \/ 'test.csv')\n\nX_train = df_train.iloc[:, 1:].values.reshape(-1, 28, 28)\ny_train = df_train.iloc[:, 0 ].values\n\nX_train, X_valid, y_train, y_valid = train_test_split(X_train, y_train, random_state=42)\n\nX_test  = df_test.values.reshape(-1, 28, 28)","220bde9d":"fig = plt.figure(figsize=(18, 9))\nfor row in range(5):\n    for col in range(10):\n        ax = fig.add_subplot(5, 10, 1+10*row+col)\n        ax.imshow(X_train[10*row+col])\n        ax.set_axis_off()\n        ax.set_title(y_train[10*row+col])","05e6fb29":"%%time\n\nmodel = KNeighborsClassifier(n_neighbors=10)\nmodel.fit(X_train.reshape(-1, 28*28), y_train)","ef9392f3":"%%time\n\nh_valid = model.predict(X_valid.reshape((-1, 28*28)))","59051aaf":"confusion_matrix(y_valid, h_valid)","d1a5b0dc":"accuracy_score(y_valid, h_valid)","4ef410c2":"fig = plt.figure(figsize=(18, 9))\nfor row in range(5):\n    for col in range(10):\n        ax = fig.add_subplot(5, 10, 1+10*row+col)\n        ax.imshow(X_valid[y_valid != h_valid][10*row+col])\n        ax.set_axis_off()\n        ax.set_title(h_valid[y_valid != h_valid][10*row+col])","d7b187a4":"# Train","deb8866b":"# validation","323e5e61":"# Predict","c9fb04b6":"# Load datasets","a21e3dde":"# Import libraries"}}