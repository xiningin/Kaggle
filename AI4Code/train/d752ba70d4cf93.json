{"cell_type":{"cf93595b":"code","138a1deb":"code","b6cbaefe":"code","04a6ca39":"code","2e14c516":"code","e29edd96":"markdown","e591ef10":"markdown","7ebd851a":"markdown","3fd580dd":"markdown"},"source":{"cf93595b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","138a1deb":"from sklearn.model_selection import train_test_split\nfrom keras.preprocessing import image\nfrom keras.utils.np_utils import to_categorical\n\ngen = image.ImageDataGenerator(rotation_range=8, width_shift_range=0.08, shear_range=0.3,\n                               height_shift_range=0.08, zoom_range=0.08)\n\nprint(\"Reading Data Set\")\ntrainCsv = pd.read_csv(\"..\/input\/train.csv\")\ntestCsv = pd.read_csv(\"..\/input\/test.csv\")\n\nX = (trainCsv.iloc[:,1:].values).astype('float32') # all pixel values\nX = X.reshape(X.shape[0], 28, 28,1)\nY = trainCsv.iloc[:,0].values.astype('int32') # only labels i.e targets digits\n#Convert Y to one-hot encoding\nY = to_categorical(Y)\n\nX_train, X_val, Y_train, Y_val = train_test_split(X, Y, test_size=0.10, random_state=42)\nbatches = gen.flow(X_train, Y_train, batch_size=64,seed=40)\nval_batches=gen.flow(X_val, Y_val, batch_size=64,seed=41)\n\nX_test = testCsv.values.astype('float32')\nX_test = X_test.reshape(X_test.shape[0], 28, 28,1)\n\nmean_px = X_train.mean().astype(np.float32)\nstd_px = X_train.std().astype(np.float32)\n\ndef standardize(x): \n    return (x-mean_px)\/std_px\n\nprint(\"Done\")","b6cbaefe":"import random\n\nprint(\"Training Set:\", trainCsv.shape)\nprint(\"Test Entry:\", testCsv.shape)\n\ncount=0\nfor loc in random.sample(range(0, trainCsv.shape[0]), 3):\n    img=X_train[loc]\n    img=img.reshape((28,28))\n    count+=1\n    plt.subplot(130+count)\n    plt.imshow(img,cmap='gray')\n    plt.title(Y_train[loc])\ncount=0\nplt.show()\nfor loc in random.sample(range(0, testCsv.shape[0]), 3):\n    img=X_test[loc]\n    img=img.reshape((28,28))\n    count+=1\n    plt.subplot(130+count)\n    plt.imshow(img,cmap='gray')","04a6ca39":"from keras.models import  Sequential\nfrom keras.layers.core import  Lambda , Dense, Flatten, Dropout\nfrom keras.callbacks import EarlyStopping\nfrom keras.layers import BatchNormalization, Convolution2D , MaxPooling2D\nfrom keras.optimizers import RMSprop\nfrom keras.utils.vis_utils import plot_model\nimport matplotlib.image as mpimg\nfrom PIL import Image\n\nmodel= Sequential()\nmodel.add(Lambda(standardize,input_shape=(28,28,1)))\nmodel.add(Flatten())\nmodel.add(Dense(512, activation='relu'))\nmodel.add(Dense(10, activation='softmax'))\nprint(\"input shape \",model.input_shape)\nprint(\"output shape \",model.output_shape)\n\nmodel.summary()\n#plot_model(model, to_file='model_plot.png', show_shapes=True, show_layer_names=True)\n#img=mpimg.imread('model_plot.png')\n#imgplot = plt.imshow(img,interpolation='nearest')\n#plt.show()\n\nmodel.compile(optimizer=RMSprop(lr=0.001),\n loss='categorical_crossentropy',\n metrics=['accuracy'])\n\nhistory=model.fit_generator(generator=batches, steps_per_epoch=batches.n, epochs=5, \n                    validation_data=val_batches, validation_steps=val_batches.n)\n","2e14c516":"predictions = model.predict_classes(X_test, verbose=0)\n\nsubmissions=pd.DataFrame({\"ImageId\": list(range(1,len(predictions)+1)),\n                         \"Label\": predictions})\nsubmissions.to_csv(\"DR.csv\", index=False, header=True)\nsubmissions.head()","e29edd96":"# Analyse Data (Optional)","e591ef10":"# Generate Submition CSV","7ebd851a":"# Fully connected Model","3fd580dd":"# Read Input Data Set"}}