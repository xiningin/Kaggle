{"cell_type":{"614d3d8a":"code","6e7957ec":"code","db885760":"code","199a5a3a":"code","7c9f28cc":"code","26f63e36":"code","fec40637":"code","40a2b79e":"code","6b08f656":"code","eed92fea":"code","c992d716":"code","0745c146":"code","faed7878":"code","6b54e563":"code","071f6c83":"code","cc996502":"code","2581e2a4":"code","8bc1ab75":"code","f43aff53":"code","bac34ac6":"code","9358a30a":"code","4f570947":"code","dc5b097e":"code","37418b0a":"code","8b80e660":"code","cba98847":"code","7eb0566c":"markdown","ebcfe031":"markdown","1067cf3a":"markdown","8819930c":"markdown","8c657b1d":"markdown","a471cb23":"markdown","2cfc29db":"markdown","da54acdf":"markdown"},"source":{"614d3d8a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n\nimport seaborn as sns\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# Any results you write to the current directory are saved as output.\n\nsns.set()","6e7957ec":"filepath_train = os.path.join('..', 'input', 'train.csv')\nfilepath_test = os.path.join('..', 'input', 'test.csv')","db885760":"df_train = pd.read_csv(filepath_train)\ndf_test = pd.read_csv(filepath_test)","199a5a3a":"df_train.shape, df_test.shape","7c9f28cc":"df_train.head()","26f63e36":"df_train_qid = df_train.copy()\n\ndf_train_qid['qid_base_ten'] = df_train_qid['qid'].apply(lambda x : int(x, 16))\ndf_train_qid.head()","fec40637":"min_qid = df_train_qid['qid_base_ten'].min()\nmax_qid = df_train_qid['qid_base_ten'].max()\ndf_train_qid['qid_base_ten_normalized'] = df_train_qid['qid_base_ten'].apply(lambda x : (x - min_qid)\/min_qid)","40a2b79e":"plt.figure(figsize=(18, 8));\nplt.scatter(x=df_train_qid['qid_base_ten_normalized'][:100], y=df_train_qid.index[:100]);\nplt.xlabel('qid_base_ten_normalized');\nplt.ylabel('Question index in df_train_qid');","6b08f656":"df_test_qid = df_test.copy()\n\ndf_test_qid['qid_base_ten'] = df_test_qid['qid'].apply(lambda x : int(x, 16))\n\ndf_test_qid['qid_base_ten_normalized'] = df_test_qid['qid_base_ten'].apply(lambda x : (x - min_qid)\/min_qid)\n\nplt.figure(figsize=(18, 8));\nplt.scatter(x=df_test_qid['qid_base_ten_normalized'][:100], y=df_test_qid.index[:100]);\nplt.xlabel('qid_base_ten_normalized');\nplt.ylabel('Question index in df_test_qid');","eed92fea":"df_train_qid.drop('target', axis=1, inplace=True)\ndf_train_qid['test_or_train'] = 'train'\ndf_test_qid['test_or_train'] = 'test'","c992d716":"df_qid = pd.concat([df_train_qid, df_test_qid]).sort_values('qid_base_ten_normalized').reset_index()\ndf_qid.drop('index', axis=1, inplace=True)\ndf_qid.head()","0745c146":"df_qid_train = df_qid[df_qid['test_or_train']=='train']\ndf_qid_test = df_qid[df_qid['test_or_train']=='test']\n\nplt.figure(figsize=(18, 8));\nplt.scatter(x=df_qid_train['qid_base_ten_normalized'], y=df_qid_train.index, label='Train', s=300);\nplt.scatter(x=df_qid_test['qid_base_ten_normalized'], y=df_qid_test.index, label='Test',s=2);\nplt.xlabel('qid_base_ten_normalized');\nplt.ylabel('Question index');\nplt.title('qid_base_ten_normalized for train and test datasets')\nplt.legend();","faed7878":"plt.figure(figsize=(18, 8));\nplt.scatter(x=df_qid_train['qid_base_ten_normalized'][:1500], y=df_qid_train.index[:1500], label='Train');\nplt.scatter(x=df_qid_test['qid_base_ten_normalized'][:50], y=df_qid_test.index[:50], label='Test',s=150, marker='d');\nplt.xlabel('qid_base_ten_normalized');\nplt.ylabel('Question index');\nplt.title('qid_base_ten_normalized for the first 1500 train points and 50 test points')\nplt.legend();","6b54e563":"df_train_qid.head()","071f6c83":"df_train_0 = df_train_qid[df_train['target']==0][:5000].drop('test_or_train', axis=1)\ndf_train_1 = df_train_qid[df_train['target']==1][:5000].drop('test_or_train', axis=1)","cc996502":"df_train_0['qid_distance'] = 0\n\nfor i in range(1, df_train_0.shape[0]):\n    df_train_0.iloc[i, 4] = df_train_0.iloc[i, 3] - df_train_0.iloc[i-1, 3]\ndf_train_0.head()","2581e2a4":"df_train_1['qid_distance'] = 0\n\nfor i in range(1, df_train_1.shape[0]):\n    df_train_1.iloc[i, 4] = df_train_1.iloc[i, 3] - df_train_1.iloc[i-1, 3]\ndf_train_1.head()","8bc1ab75":"print('The mean \\'qid_distance\\' for sincere questions is {} with a standard deviation of {}'.format(round(df_train_0['qid_distance'].mean(), 3), round(df_train_0['qid_distance'].std(), 3)))\nprint('The mean \\'qid_distance\\' for insincere questions is {} with a standard deviation of {}'.format(round(df_train_1['qid_distance'].mean(), 3), round(df_train_1['qid_distance'].std(), 3)))","f43aff53":"fig, axes = plt.subplots(1, 2, figsize=(18, 8));\nsns.distplot(df_train_1['qid_distance'], ax=axes[0], color='red', label='Insincere questions', kde=False);\naxes[0].legend();\nsns.distplot(df_train_0['qid_distance'], ax=axes[1], label='Sincere questions', kde=False);\naxes[1].legend();","bac34ac6":"plt.figure(figsize=(18, 8));\nsns.boxplot(df_train_1['qid_distance'], color='red');\nplt.title('Insincere questions');\nplt.figure(figsize=(18, 8));\nsns.boxplot(df_train_0['qid_distance']);\nplt.title('Sincere questions');","9358a30a":"df_train_qid.head()","4f570947":"df_train_distance = df_train_qid[:100000].drop(['qid_base_ten', 'test_or_train'], axis=1).copy()\ndf_train_distance['qid_distance'] = 0\nfor i in range(1, df_train_distance['qid'].shape[0]):\n    df_train_distance.iloc[i, 3] = df_train_distance.iloc[i, 2] - df_train_distance.iloc[i-1, 2]","dc5b097e":"df_train_distance.head()","37418b0a":"df_train_distance_0 = df_train_distance[df_train['target']==0]\ndf_train_distance_1 = df_train_distance[df_train['target']==1]","8b80e660":"ax=plt.gca()\nsns.distplot(df_train_distance_0['qid_distance'], ax=ax, color='red', label='Insincere questions');\nsns.distplot(df_train_distance_1['qid_distance'], ax=ax, label='Sincere questions');\nax.legend();","cba98847":"sns.boxplot(x=df_train_distance['qid_distance'], y=df_train['target'], orient='h');","7eb0566c":"So the question ids range of the test dataset is the same as the question ids range for the train dataset. The test and train datasets come as expected from a random train\/test split on a single dataset.\nThe figure below confirms the 'random' choice of the elements for the test dataset.","ebcfe031":"As I suspected, questions are indeed sorted by ascending question id in our train dataset. Let's see if it is the same in the test one.","1067cf3a":"Here, we still can't figure out if the train\/test plit was done using the 'stratify' parameter of `train_test_split()`!\n","8819930c":"**Hi !**\n\nThis kernel is an improved extract from my first kernel, focusing on questions id and how Quora probably built the train and test datasets. I don't know what to do of this work, if you have any idea feel free to share it!\n","8c657b1d":"# Working on 'distance' between questions","a471cb23":"That's all for this bonus part on questions id, it is not that useful, but it was working on it was fun!\n\n![FolksURL](https:\/\/media.giphy.com\/media\/upg0i1m4DLe5q\/giphy.gif \"Folks\")","2cfc29db":"Here again, questions are sorted by ascending question id ! Now I wonder if I can know how Quora has made its train an test datasets. Is it with a random (and stratified?) train.test split, or a simple split based on the id?\n\nTo get the answer, I have merged the train and test dataframes, with the 'qid_base_ten_normalized' column, sorted by ascending 'qid_base_ten_normalized' and reset the index.","da54acdf":"I was wondering wether the test dataset was an extract from the train one, or completely different. To answer this existential question, I've been working on the 'qid' column.\n\nThe question id is an hexadecimal number. The first step here is to extract this value, and see if the questions are ordered by id."}}