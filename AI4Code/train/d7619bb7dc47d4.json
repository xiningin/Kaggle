{"cell_type":{"45d51772":"code","a7352090":"code","fc342a38":"code","a1c53dce":"code","6813d250":"code","78a92e78":"code","d034b59d":"code","92c67713":"code","6ba2b4c4":"code","e6fd4bc4":"code","357f23fb":"code","32a515d7":"code","d1059054":"code","46603fe3":"code","ba22cf56":"code","b08765b1":"code","b8adb31d":"code","82b3d397":"code","456eedea":"markdown","f60d738a":"markdown","159bec6e":"markdown","36058abe":"markdown"},"source":{"45d51772":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns","a7352090":"train = pd.read_csv('..\/input\/train.csv')","fc342a38":"train.head()","a1c53dce":"sns.heatmap(train.corr());","6813d250":"sns.pairplot(train);","78a92e78":"train.min()","d034b59d":"train.max()","92c67713":"test = pd.read_csv('..\/input\/test.csv')","6ba2b4c4":"sns.pairplot(test);","e6fd4bc4":"test.head()","357f23fb":"test.min()","32a515d7":"test.max()","d1059054":"def rmsle(y_true, y_pred):\n    return np.sqrt(np.mean((np.log1p(y_true) - np.log1p(y_pred)) ** 2))","46603fe3":"X = train.drop(['id', 'target'], axis=1)\ny = train.target","ba22cf56":"X['bias'] = 1","b08765b1":"X_test = test.drop('id', axis=1)\nX_test['bias'] = 1","b8adb31d":"y_pred = []\nk = 10\nbatch = X.shape[0] \/\/ k\nscores = []\nfor i in range(k):\n    X_train, y_train = pd.concat((X[:i*batch], X[(i+1)*batch:])), pd.concat((y[:i*batch], y[(i+1)*batch:]))\n    X_val, y_val = X[i*batch: (i+1)*batch], y[i*batch: (i+1)*batch]\n    coef = np.linalg.lstsq(X_train, y_train, rcond=None)[0]\n    scores.append(rmsle(y_val, X_val.dot(coef)))\n    y_pred.append(X_test.dot(coef))\ny_pred = np.array(y_pred)\ny_pred = y_pred.T.mean(axis=1)\nprint('RMSLE:', np.mean(scores))","82b3d397":"pd.DataFrame({'id': test.id, 'target': y_pred}).to_csv('submission.csv', index=None)","456eedea":"# Train","f60d738a":"# Metric","159bec6e":"# Data exploration","36058abe":"## Cross-validation"}}