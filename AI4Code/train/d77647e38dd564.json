{"cell_type":{"f6a01cba":"code","7b7914c2":"code","ac2178a4":"code","5d1bba59":"code","6b542a52":"code","00d634d6":"code","b9a220b7":"code","c6c62316":"code","d0e514cc":"code","6de0a1ee":"code","5da6f2ea":"code","f861a411":"code","8fe37129":"code","cb6cafab":"code","40aa2b58":"code","1423a2b9":"code","6a2c8599":"code","edf2aeda":"code","31594302":"code","8f539798":"code","798cceec":"code","e5414d55":"code","e800de37":"code","13b82af7":"code","12abc1de":"code","fb806612":"code","d5d89aeb":"markdown","c1fe522e":"markdown","12b5baeb":"markdown","e5df3f0a":"markdown","3dec55a4":"markdown","b86aac84":"markdown","b2b727cc":"markdown","c1a6be0f":"markdown","58ccd72d":"markdown","87495b84":"markdown","47112508":"markdown","d832335b":"markdown","0ce10d1d":"markdown","a37b6920":"markdown"},"source":{"f6a01cba":"import pandas as pd \nimport numpy as np \nimport seaborn as sns \nimport matplotlib.pyplot as plt \n\nimport plotly.express as px\n%matplotlib inline","7b7914c2":"#Create folds\n# The below cell creates a dataset with the columns which I plan to utilize only and also add the folds columns which can be \n#used cross validation \nimport pandas as pd \nimport numpy as np \n\ntrain=pd.read_csv('\/kaggle\/input\/pump-it-up-challenge-driven-data\/training_Set_values.csv')\nlabels=pd.read_csv('\/kaggle\/input\/pump-it-up-challenge-driven-data\/training_Set_labels.csv')\ntest=pd.read_csv('..\/input\/pump-it-up-challenge-driven-data\/Test_set_values.csv')\n\n\ntrain=train.merge(labels, on='id')\n\n\nnumerical=['gps_height','longitude','latitude']\n\ncategorical=['permit','management_group','source_class','public_meeting','quality_group',\n              'scheme_management','payment','extraction_type_class','quantity','waterpoint_type_group',\n              'region','lga','ward','subvillage',\n              'funder','installer',\n             'construction_year',\n             'status_group']\n\ntest_id=['id']\n\ntrain=train[numerical+categorical]\ntest=test[[col for col in numerical+categorical+test_id if col not in 'status_group']]\n\nfrom sklearn import model_selection\n\ntrain['folds']=-1\n\ntrain=train.sample(frac=1).reset_index(drop=True)\ny=train['status_group'].values\n\nkf=model_selection.StratifiedKFold(n_splits=5)\n\nfor f,(t_,v_) in enumerate(kf.split(X=train,y=y)):\n    train.loc[v_,'folds']=f\n\n    \ntrain.to_csv('.\/train_folds.csv',index=False)\ntest.to_csv('.\/test_columns.csv',index=False)","ac2178a4":"train=pd.read_csv('.\/train_folds.csv')\ntest=pd.read_csv('.\/test_columns.csv')","5d1bba59":"\nsns.set_style(\"darkgrid\");\nsns.set_color_codes(palette='bright');\nsns.countplot(x=train['status_group'],color='y');","6b542a52":"fig = px.scatter(data_frame=train,y=train['latitude'], x=train['longitude'],color=train['lga'],opacity=0.5\n                 )\nfig.show()\n\n#hover_name=train['status_group']","00d634d6":"df=train.groupby(['extraction_type_class','status_group']).count()['permit'].head(200).reset_index()\n\n\nfig = px.bar(df, x=\"extraction_type_class\", y=\"permit\",color=\"status_group\", title=\" \",width=1000, height=500)\n\nfig.show()\n\ndel df","b9a220b7":"df=train.groupby(['region','status_group']).count()['permit'].head(200).reset_index()\n\n\nfig = px.bar(df, x=\"region\", y=\"permit\",color=\"status_group\", title=\" \",width=1000, height=500)\n\nfig.show()\n\ndel df","c6c62316":"df=train.groupby(['lga','status_group']).count()['permit'].head(200).reset_index()\n\n\nfig = px.bar(df, x=\"lga\", y=\"permit\",color=\"status_group\", title=\" \",width=1000, height=500)\n\nfig.show()\n\ndel df","d0e514cc":"#Filling the missing Lattitude and longitude values\n\nindex=train[train['longitude']==0].index\n\ntrain.loc[index,'longitude']=np.nan\ntrain.loc[index,'latitude']=np.nan\n\n\nmean_longitude=train['longitude'].mean()\nmean_latitude=train['latitude'].mean()\n\ntrain['longitude'].fillna(value=mean_longitude,inplace=True)\ntrain['latitude'].fillna(value=mean_latitude,inplace=True)\n\n#Filling the test dataset \ntest_index=test[test['longitude']==0].index\n\ntest.loc[test_index,'longitude']=np.nan\ntest.loc[test_index,'latitude']=np.nan\n\ntest['longitude'].fillna(value=mean_longitude,inplace=True)\ntest['latitude'].fillna(value=mean_latitude,inplace=True)","6de0a1ee":"# Filling the gps_height columns . Google search revals that the entire country of Tanzania lies abouve sea level.\n#So the zero in GPS height must be the missing value in the column. Using data from the below site I am gng to fill values by region \n#https:\/\/elevation.maplogs.com\/poi\/tanzania.10739.html \n\ngps_missing_region=train[train['gps_height']==0]['region'].value_counts().index\n\ntrain['gps_height'].replace({0:np.nan},inplace=True)\ntest['gps_height'].replace({0:np.nan},inplace=True)\n\nheight={'Shinyanga':1233,'Mbeya':1360,'Kagera':1199, 'Mwanza':1138, 'Dodoma':1741,'Tabora':1177, 'Tanga':458,\\\n        'Morogoro':254, 'Pwani':258, 'Lindi':317, 'Dar es Salaam':52, 'Mtwara':470}\n\nfor region in gps_missing_region:\n    train.loc[((train['region']==region) & (train['gps_height'].isnull())),'gps_height']=height[region]\n    test.loc[((test['region']==region) & (test['gps_height'].isnull())),'gps_height']=height[region]\n","5da6f2ea":"#Creating the model \n\n# Fill Na and group rare groups into one \n\ntrain['quality_group'].replace({'salty':'not_good','unknown':'not_good','milky':'not_good','colored':'not_good',\n                                  'fluoride':'not_good'},inplace=True)\n\ntest['quality_group'].replace({'salty':'not_good','unknown':'not_good','milky':'not_good','colored':'not_good',\n                                  'fluoride':'not_good'},inplace=True)\n\n\ntrain['permit'].fillna('none',inplace=True)\ntrain['public_meeting'].fillna('none',inplace=True)\n\ntest['permit'].fillna('none',inplace=True)\ntest['public_meeting'].fillna('none',inplace=True)\n\ntrain['scheme_management'].fillna('None',inplace=True)\n\ntrain['scheme_management'].replace({'SWC':'VWC','Water authority':'government','Water Board':'government','Parastatal':'government'\n                                   ,'Private operator':'private','Company':'private','Other':'private','Trust':'board','WUG':'board',\n                                    'WUA':'board'\n                                   },inplace=True)\n\ntest['scheme_management'].fillna('None',inplace=True)\n\ntest['scheme_management'].replace({'SWC':'VWC','Water authority':'government','Water Board':'government','Parastatal':'government'\n                                   ,'Private operator':'private','Company':'private','Other':'private','Trust':'board','WUG':'board',\n                                    'WUA':'board'\n                                   },inplace=True)\n\ntrain['subvillage'].fillna('none',inplace=True)\ntest['subvillage'].fillna('none',inplace=True)\n\n#Converting columns to string\n\ntrain['funder']=train['funder'].astype('str')\ntrain['installer']=train['installer'].astype('str')\n\ntest['funder']=test['funder'].astype('str')\ntest['installer']=test['installer'].astype('str')\n\n#lower casing the funder and installer names \n\ntrain['funder']=train['funder'].apply(lambda x:x.lower())\ntrain['installer']=train['installer'].apply(lambda x:x.lower())\n\ntrain['funder'].replace({'0':'none'},inplace=True)\ntrain['funder'].fillna('none',inplace=True)\n\ntrain['installer'].replace({'0':'none'},inplace=True)\ntrain['installer'].fillna('none',inplace=True)\n\n\ntest['funder']=test['funder'].apply(lambda x:x.lower())\ntest['installer']=test['installer'].apply(lambda x:x.lower())\n\ntest['funder'].replace({'0':'none'},inplace=True)\ntest['funder'].fillna('none',inplace=True)\n\ntest['installer'].replace({'0':'none'},inplace=True)\ntest['installer'].fillna('none',inplace=True)\n\n\ntrain['extraction_type_class'].replace({'motorpump':'other','rope pump':'other',\n                                                                       'wind-powered':'other'},inplace=True)\ntest['extraction_type_class'].replace({'motorpump':'other','rope pump':'other',\n                                                                       'wind-powered':'other'},inplace=True)\n\n\n#train['construction_year'].replace({0:np.nan},inplace=True)","f861a411":"train['installer']=train['installer'].replace({'government of tanzania':'government','danid':'danida','nethalan':'netherland','unisef':'unicef'\n                                        ,'do':'donor','w\/':'w','germany republi':'germany','kkt':'kkkt','kkkt chruch':'kkkt','central government':'government'\n                                        ,'roman cathoric same':'church','nethe':'netherland','not known':'none','da':'danida',\n                                        'rwe\/dwe':'dwe','ces (gmbh)':'cse','netherlands':'netherland','private individual':'private',\n                                        'priva':'private','ces(gmbh)':'ces','w.b':'wb','fin water':'fini water','lawatefuka water sup':'lawatefuka water supply'\n                                        ,'would bank':'world bank','chruc':'chur','british colonial government':'british','canada and tanzania':'government',\n                                        'rural water supply and sanitat':'rural water supply and sanitation','central govt':'government','world':'world bank',\n                                        'losaa-kia water supp':'losaa-kia water supply','killflora \/community':'killflora','finw':'fini water','ministry of water':'government',                   \n                                        'oikos e.afrika':'oikos e africa','quick win project \/council':'quick win project','rotary i':'rotary',\n                                         'local te':'local te','magadini-makiwaru wa':'magadini-makiwaru water','parastatal':'government',\n                                        'ruangwa contractor':'private','donor':'private','village council':'village','district council':'district',\n                                        'distri':'district','mileniam':'millenium','roman catholic':'church','rc church':'chruch','cartas':'caritas',\n                                        'tz japan':'japan','rcchurch\/cefa':'church','swedish':'swedan','rc churc':'church','wo':'world bank','rudep\/':'rudep',\n                                        'cetral government \/rc':'government','nyamingu subvillage':'village','tanza':'government','handeni trunk main(':\n                                        'handeni trunk main','0':'none','nan':'none','finn water':'fini water','government\/ community':'government',\n                                        'rwe \/community':'rwe' ,'mwaki contractor':'private','gwasco l':'gwasco','village govt':'village',\n                                       '\\tmagadini-makiwaru water':'magadini-makiwaru water','plan internationa':'plan international',\n                                        'village council\/ haydom luther':'village','wua':'wu','swiss if':'swiss','mkinga distric cou':'district'\n                                    ,'wateraid':'water aid','mwe &':'mwe','individuals':'private','gover':'government','anglican church':'church',\n                                     'angli':'church','kkkt_makwale':'kkkt','kkkt _ konde and dwe':'kkkt','happy watoto foundation':'private',\n                                      'irish ai':'irish','drdp ngo':'drdp','roman ca':'church','roman':'church','ministry of education':\n                                    'government','sekei village community':'village','local technician':'private','tabora municipal council':\n                                    'district','clause workers':'clause','bank':'world bank','desk c':'private','desk and chair foundation':\n                                    'private','ministry of water engineer':'government','mkinga distric coun':'district','koberg contractor':'private',\n                                    'roman cathoric-same':'chruch','adra \/government':'government','world vision\/ kkkt':'world vision','hw\/rc':'church',\n                                      'adra \/community':'adra','sengerema water department':'district','tasaf\/tlc':'tasaf','olgilai village community':'village',\n                                      'china government':'china','chinese':'china','village government':'village','finwater':'fini water','rural water supply and sanitation':'village',\n                                   'institutional':'private','the people of japan':'japan','hesawz':'hesawa','tasaf and lga':'district','cipro\/government':'government','kkkt church':'kkkt',\n                                       'plan internatio':'plan international','schoo':'school','songea district coun':'songea district council',\n                                'regwa company of egypt':'egypt','regwa company':'egypt','us embassy':'usa','lga':'district','hotels and loggs tz ltd':'private',\n                                  'the desk and chair foundat':'the desk and chair foundation','game fronti':'game frontier',\n                                  'oikos e.africa\/european union':'oikos e africa','oikos e .africa':'oikos e africa','african':'oikos e africa',\n                                'finland':'fini water','i.e.c':'iec','isf\/government':'government','roman catholic rulenge diocese':'church',\n                                 'w.d &':'wd','isf\/tacare':'isf','ubalozi wa japani':'japan','cipro\/care\/tcrs':'tcrs','lutheran':'church','mkinga distric cou':\n                                'district','villagers':'village','rc ch':'church','rc':'church','unice':'unicef','world vision\/adra':'world vision',\n                                 'unicef\/central':'unicef','karumba biulding contractor':'private','songea district council'  :'distict','district water department':'district',\n                                  'saxon building contractor':'private','j mal abdallah':'jamal abdallah','finida german tanzania govt':'government', \n                                    'rural water supply and sanita':'village','winnin spirit co ltd':'private','water aid\/sema':'water aid','pr':'private','tasaf\/':'tasaf' \n                                     ,'dokta mwandulami':'dokta mwandulam' ,'dr. matobola':'private','dwe}':'dwe','water aid \/sema':'water aid','doner and com':'private',\n                                              'a\/co germany':'germany','churc':'church','aco\/germany':'germany','rc church\/centr':'church','cental government':'government',\n                                        'villagers mpi':'village','udc\/sema':'sema','china henan contractor':'china','tcrs \/government':'government','communit':'community',\n                                       'church of disciples':'church','adra\/ community':'adra','village authority':'village','uniceffinida german tanzani':'unicef','uniceffinidagermantanzania':'unicef',\n                                      'w0rld  bank':'world bank','villager':'village','old bank':'world bank','village gover':'village','village committee':'village','village fou':'village',\n                                      'village gover':'village','the desk and chair foundati':'private','tz\/japan embass':'government','tanzania na egypt':'government',\n                                      'tanzania christian service':'government','tanzania na egypt':'government','tanzania nea egypt':'government','tasaf\/village community':'village','unise':'unicef',\n                                      'swedish tandala project':'sweden','rcchurch':'church','othodox church':'church','private company':'private','private manager':'private',\n                                      'tanzania\/australia':'government','wise-usa':'usa','tober and friends from austral':'australia','tz\/japan embass':'japan','watoto foundation':'private',\n                                      'ubalozi wa marekani\/dwe':'dwe','tag church vi':'church','school administration':'school','school capital':'school','sinohydro':'china','daids':'dandia','danida \/wsdp':'dandia',\n                                      'heaswa':'heasawa','kkkt church s':'kkkt','lga and the commu':'lga','chruch':'church','dwe\/norad':'dwe','fw':'fini water','ga':'germany','gen':'germany',\n                                      'plan int':'plan international','ridep':'redep','tasaf':'tassaf','the desk and chair foundation':'private','ru':'rudep','peter tesha':'peters','md':'mdrdp',\n                                      'local  technician':'local','local contract':'local','local te':'local','muwsa':'muwasa','oxfam':'oxfarm','finland government finland gov':'fini water',\n                                      'government\/julius':'government','kkkt imbaseny':'kkkt','kkkt kolila':'kkkt','kkkt mso':'kkkt','lgsp\/dwe':'dwe','mosque bugula':'mosque','mosque pera':'mosque','water of water':'water',\n                                      'romam catholc\/vil':'church'})\n\n\ntest['installer']=test['installer'].replace({'government of tanzania':'government','danid':'danida','nethalan':'netherland','unisef':'unicef'\n                        ,'do':'donor','w\/':'w','germany republi':'germany','kkt':'kkkt','kkkt chruch':'kkkt','central government':'government'\n                        ,'roman cathoric same':'church','nethe':'netherland','not known':'none','da':'danida',\n                        'rwe\/dwe':'dwe','ces (gmbh)':'cse','netherlands':'netherland','private individual':'private',\n                        'priva':'private','ces(gmbh)':'ces','w.b':'wb','fin water':'fini water','lawatefuka water sup':'lawatefuka water supply'\n                        ,'would bank':'world bank','chruc':'chur','british colonial government':'british','canada and tanzania':'government',\n                        'rural water supply and sanitat':'rural water supply and sanitation','central govt':'government','world':'world bank',\n                        'losaa-kia water supp':'losaa-kia water supply','killflora \/community':'killflora','finw':'fini water','ministry of water':'government',                   \n                         'oikos e.afrika':'oikos e africa','quick win project \/council':'quick win project','rotary i':'rotary',\n                         'local te':'local te','magadini-makiwaru wa':'magadini-makiwaru water','parastatal':'government',\n                        'ruangwa contractor':'private','donor':'private','village council':'village','district council':'district',\n                          'distri':'district','mileniam':'millenium','roman catholic':'church','rc church':'chruch','cartas':'caritas',\n                           'tz japan':'japan','rcchurch\/cefa':'church','swedish':'swedan','rc churc':'church','wo':'world bank','rudep\/':'rudep',\n                    'cetral government \/rc':'government','nyamingu subvillage':'village','tanza':'government','handeni trunk main(':\n                    'handeni trunk main','0':'none','nan':'none','finn water':'fini water','government\/ community':'government',\n                       'rwe \/community':'rwe' ,'mwaki contractor':'private','gwasco l':'gwasco','village govt':'village',\n                       '\\tmagadini-makiwaru water':'magadini-makiwaru water','plan internationa':'plan international',\n                        'village council\/ haydom luther':'village','wua':'wu','swiss if':'swiss','mkinga distric cou':'district'\n                        ,'wateraid':'water aid','mwe &':'mwe','individuals':'private','gover':'government','anglican church':'church',\n                         'angli':'church','kkkt_makwale':'kkkt','kkkt _ konde and dwe':'kkkt','happy watoto foundation':'private',\n                          'irish ai':'irish','drdp ngo':'drdp','roman ca':'church','roman':'church','ministry of education':\n                            'government','sekei village community':'village','local technician':'private','tabora municipal council':\n                                'district','clause workers':'clause','bank':'world bank','desk c':'private','desk and chair foundation':\n                                    'private','ministry of water engineer':'government','mkinga distric coun':'district','koberg contractor':'private',\n                            'roman cathoric-same':'chruch','adra \/government':'government','world vision\/ kkkt':'world vision','hw\/rc':'church',\n                              'adra \/community':'adra','sengerema water department':'district','tasaf\/tlc':'tasaf','olgilai village community':'village',\n                              'china government':'china','chinese':'china','village government':'village','finwater':'fini water','rural water supply and sanitation':'village',\n                               'institutional':'private','the people of japan':'japan','hesawz':'hesawa','tasaf and lga':'district','cipro\/government':'government','kkkt church':'kkkt',\n                               'plan internatio':'plan international','schoo':'school','songea district coun':'songea district council',\n                            'regwa company of egypt':'egypt','regwa company':'egypt','us embassy':'usa','lga':'district','hotels and loggs tz ltd':'private',\n                              'the desk and chair foundat':'the desk and chair foundation','game fronti':'game frontier',\n                              'oikos e.africa\/european union':'oikos e africa','oikos e .africa':'oikos e africa','african':'oikos e africa',\n                                'finland':'fini water','i.e.c':'iec','isf\/government':'government','roman catholic rulenge diocese':'church',\n                                 'w.d &':'wd','isf\/tacare':'isf','ubalozi wa japani':'japan','cipro\/care\/tcrs':'tcrs','lutheran':'church','mkinga distric cou':\n                                'district','villagers':'village','rc ch':'church','rc':'church','unice':'unicef','world vision\/adra':'world vision',\n                                 'unicef\/central':'unicef','karumba biulding contractor':'private','songea district council'  :'distict','district water department':'district',\n                                  'saxon building contractor':'private','j mal abdallah':'jamal abdallah','finida german tanzania govt':'government', \n                                    'rural water supply and sanita':'village','winnin spirit co ltd':'private','water aid\/sema':'water aid','pr':'private','tasaf\/':'tasaf' \n                                     ,'dokta mwandulami':'dokta mwandulam' ,'dr. matobola':'private','dwe}':'dwe','water aid \/sema':'water aid','doner and com':'private',\n                                              'a\/co germany':'germany','churc':'church','aco\/germany':'germany','rc church\/centr':'church','cental government':'government',\n                                        'villagers mpi':'village','udc\/sema':'sema','china henan contractor':'china','tcrs \/government':'government','communit':'community',\n                                       'church of disciples':'church','adra\/ community':'adra','village authority':'village','uniceffinida german tanzani':'unicef','uniceffinidagermantanzania':'unicef',\n                                      'w0rld  bank':'world bank','villager':'village','old bank':'world bank','village gover':'village','village committee':'village','village fou':'village',\n                                      'village gover':'village','the desk and chair foundati':'private','tz\/japan embass':'government','tanzania na egypt':'government',\n                                      'tanzania christian service':'government','tanzania na egypt':'government','tanzania nea egypt':'government','tasaf\/village community':'village','unise':'unicef',\n                                      'swedish tandala project':'sweden','rcchurch':'church','othodox church':'church','private company':'private','private manager':'private',\n                                      'tanzania\/australia':'government','wise-usa':'usa','tober and friends from austral':'australia','tz\/japan embass':'japan','watoto foundation':'private',\n                                      'ubalozi wa marekani\/dwe':'dwe','tag church vi':'church','school administration':'school','school capital':'school','sinohydro':'china','daids':'dandia','danida \/wsdp':'dandia',\n                                      'heaswa':'heasawa','kkkt church s':'kkkt','lga and the commu':'lga','chruch':'church','dwe\/norad':'dwe','fw':'fini water','ga':'germany','gen':'germany',\n                                      'plan int':'plan international','ridep':'redep','tasaf':'tassaf','the desk and chair foundation':'private','ru':'rudep','peter tesha':'peters','md':'mdrdp',\n                                      'local  technician':'local','local contract':'local','local te':'local','muwsa':'muwasa','oxfam':'oxfarm','finland government finland gov':'fini water',\n                                      'government\/julius':'government','kkkt imbaseny':'kkkt','kkkt kolila':'kkkt','kkkt mso':'kkkt','lgsp\/dwe':'dwe'})","8fe37129":"train['funder']=train['funder'].replace({'government of tanzania':'government','danid':'danida','nethalan':'netherland','unisef':'unicef'\n                        ,'do':'donor','w\/':'w','germany republi':'germany','kkt':'kkkt','kkkt chruch':'kkkt','central government':'government'\n                        ,'roman cathoric same':'church','nethe':'netherland','not known':'none','da':'danida',\n                        'rwe\/dwe':'dwe','ces (gmbh)':'cse','netherlands':'netherland','private individual':'private',\n                        'priva':'private','ces(gmbh)':'ces','w.b':'wb','fin water':'fini water','lawatefuka water sup':'lawatefuka water supply'\n                        ,'would bank':'world bank','chruc':'chur','british colonial government':'british','canada and tanzania':'government',\n                        'rural water supply and sanitat':'rural water supply and sanitation','central govt':'government','world':'world bank',\n                        'losaa-kia water supp':'losaa-kia water supply','killflora \/community':'killflora','finw':'fini water','ministry of water':'government',                   \n                         'oikos e.afrika':'oikos e africa','quick win project \/council':'quick win project','rotary i':'rotary',\n                         'local te':'local te','magadini-makiwaru wa':'magadini-makiwaru water','parastatal':'government',\n                        'ruangwa contractor':'private','donor':'private','village council':'village','district council':'district',\n                          'distri':'district','mileniam':'millenium','roman catholic':'church','rc church':'chruch','cartas':'caritas',\n                           'tz japan':'japan','rcchurch\/cefa':'church','swedish':'swedan','rc churc':'church','wo':'world bank','rudep\/':'rudep',\n                    'cetral government \/rc':'government','nyamingu subvillage':'village','tanza':'government','handeni trunk main(':\n                    'handeni trunk main','0':'none','nan':'none','finn water':'fini water','government\/ community':'government',\n                       'rwe \/community':'rwe' ,'mwaki contractor':'private','gwasco l':'gwasco','village govt':'village',\n                       '\\tmagadini-makiwaru water':'magadini-makiwaru water','plan internationa':'plan international',\n                        'village council\/ haydom luther':'village','wua':'wu','swiss if':'swiss','mkinga distric cou':'district'\n                        ,'wateraid':'water aid','mwe &':'mwe','individuals':'private','gover':'government','anglican church':'church',\n                         'angli':'church','kkkt_makwale':'kkkt','kkkt _ konde and dwe':'kkkt','happy watoto foundation':'private',\n                          'irish ai':'irish','drdp ngo':'drdp','roman ca':'church','roman':'church','ministry of education':\n                            'government','sekei village community':'village','local technician':'private','tabora municipal council':\n                                'district','clause workers':'clause','bank':'world bank','desk c':'private','desk and chair foundation':\n                                    'private','ministry of water engineer':'government','mkinga distric coun':'district','koberg contractor':'private',\n                            'roman cathoric-same':'chruch','adra \/government':'government','world vision\/ kkkt':'world vision','hw\/rc':'church',\n                              'adra \/community':'adra','sengerema water department':'district','tasaf\/tlc':'tasaf','olgilai village community':'village',\n                              'china government':'china','chinese':'china','village government':'village','finwater':'fini water','rural water supply and sanitation':'village',\n                               'institutional':'private','the people of japan':'japan','hesawz':'hesawa','tasaf and lga':'district','cipro\/government':'government','kkkt church':'kkkt',\n                               'plan internatio':'plan international','schoo':'school','songea district coun':'songea district council',\n                            'regwa company of egypt':'egypt','regwa company':'egypt','us embassy':'usa','lga':'district','hotels and loggs tz ltd':'private',\n                              'the desk and chair foundat':'the desk and chair foundation','game fronti':'game frontier',\n                              'oikos e.africa\/european union':'oikos e africa','oikos e .africa':'oikos e africa','african':'oikos e africa',\n                                'finland':'fini water','i.e.c':'iec','isf\/government':'government','roman catholic rulenge diocese':'church',\n                                 'w.d &':'wd','isf\/tacare':'isf','ubalozi wa japani':'japan','cipro\/care\/tcrs':'tcrs','lutheran':'church','mkinga distric cou':\n                                'district','villagers':'village','rc ch':'church','rc':'church','unice':'unicef','world vision\/adra':'world vision',\n                                 'unicef\/central':'unicef','karumba biulding contractor':'private','songea district council'  :'distict','district water department':'district',\n                                  'saxon building contractor':'private','j mal abdallah':'jamal abdallah','finida german tanzania govt':'government', \n                                    'rural water supply and sanita':'village','winnin spirit co ltd':'private','water aid\/sema':'water aid','pr':'private','tasaf\/':'tasaf' \n                                     ,'dokta mwandulami':'dokta mwandulam' ,'dr. matobola':'private','dwe}':'dwe','water aid \/sema':'water aid','doner and com':'private',\n                                              'a\/co germany':'germany','churc':'church','aco\/germany':'germany','rc church\/centr':'church','cental government':'government',\n                                        'villagers mpi':'village','udc\/sema':'sema','china henan contractor':'china','tcrs \/government':'government','communit':'community',\n                                       'church of disciples':'church','adra\/ community':'adra','village authority':'village','uniceffinida german tanzani':'unicef','uniceffinidagermantanzania':'unicef',\n                                      'w0rld  bank':'world bank','villager':'village','old bank':'world bank','village gover':'village','village committee':'village','village fou':'village',\n                                      'village gover':'village','the desk and chair foundati':'private','tz\/japan embass':'government','tanzania na egypt':'government',\n                                      'tanzania christian service':'government','tanzania na egypt':'government','tanzania nea egypt':'government','tasaf\/village community':'village','unise':'unicef',\n                                      'swedish tandala project':'sweden','rcchurch':'church','othodox church':'church','private company':'private','private manager':'private',\n                                      'tanzania\/australia':'government','wise-usa':'usa','tober and friends from austral':'australia','tz\/japan embass':'japan','watoto foundation':'private',\n                                      'ubalozi wa marekani\/dwe':'dwe','tag church vi':'church','school administration':'school','school capital':'school','sinohydro':'china','daids':'dandia','danida \/wsdp':'dandia',\n                                      'heaswa':'heasawa','kkkt church s':'kkkt','lga and the commu':'lga','chruch':'church','dwe\/norad':'dwe','fw':'fini water','ga':'germany','gen':'germany',\n                                      'plan int':'plan international','ridep':'redep','tasaf':'tassaf','the desk and chair foundation':'private','ru':'rudep','peter tesha':'peters','md':'mdrdp',\n                                      'local  technician':'local','local contract':'local','local te':'local','muwsa':'muwasa','oxfam':'oxfarm','finland government finland gov':'fini water',\n                                      'government\/julius':'government','kkkt imbaseny':'kkkt','kkkt kolila':'kkkt','kkkt mso':'kkkt','lgsp\/dwe':'dwe','mosque bugula':'mosque','mosque pera':'mosque','water of water':'water',\n                                      'romam catholc\/vil':'church'})\n\n\ntest['funder']=test['funder'].replace({'government of tanzania':'government','danid':'danida','nethalan':'netherland','unisef':'unicef'\n                        ,'do':'donor','w\/':'w','germany republi':'germany','kkt':'kkkt','kkkt chruch':'kkkt','central government':'government'\n                        ,'roman cathoric same':'church','nethe':'netherland','not known':'none','da':'danida',\n                        'rwe\/dwe':'dwe','ces (gmbh)':'cse','netherlands':'netherland','private individual':'private',\n                        'priva':'private','ces(gmbh)':'ces','w.b':'wb','fin water':'fini water','lawatefuka water sup':'lawatefuka water supply'\n                        ,'would bank':'world bank','chruc':'chur','british colonial government':'british','canada and tanzania':'government',\n                        'rural water supply and sanitat':'rural water supply and sanitation','central govt':'government','world':'world bank',\n                        'losaa-kia water supp':'losaa-kia water supply','killflora \/community':'killflora','finw':'fini water','ministry of water':'government',                   \n                         'oikos e.afrika':'oikos e africa','quick win project \/council':'quick win project','rotary i':'rotary',\n                         'local te':'local te','magadini-makiwaru wa':'magadini-makiwaru water','parastatal':'government',\n                        'ruangwa contractor':'private','donor':'private','village council':'village','district council':'district',\n                          'distri':'district','mileniam':'millenium','roman catholic':'church','rc church':'chruch','cartas':'caritas',\n                           'tz japan':'japan','rcchurch\/cefa':'church','swedish':'swedan','rc churc':'church','wo':'world bank','rudep\/':'rudep',\n                    'cetral government \/rc':'government','nyamingu subvillage':'village','tanza':'government','handeni trunk main(':\n                    'handeni trunk main','0':'none','nan':'none','finn water':'fini water','government\/ community':'government',\n                       'rwe \/community':'rwe' ,'mwaki contractor':'private','gwasco l':'gwasco','village govt':'village',\n                       '\\tmagadini-makiwaru water':'magadini-makiwaru water','plan internationa':'plan international',\n                        'village council\/ haydom luther':'village','wua':'wu','swiss if':'swiss','mkinga distric cou':'district'\n                        ,'wateraid':'water aid','mwe &':'mwe','individuals':'private','gover':'government','anglican church':'church',\n                         'angli':'church','kkkt_makwale':'kkkt','kkkt _ konde and dwe':'kkkt','happy watoto foundation':'private',\n                          'irish ai':'irish','drdp ngo':'drdp','roman ca':'church','roman':'church','ministry of education':\n                            'government','sekei village community':'village','local technician':'private','tabora municipal council':\n                                'district','clause workers':'clause','bank':'world bank','desk c':'private','desk and chair foundation':\n                                    'private','ministry of water engineer':'government','mkinga distric coun':'district','koberg contractor':'private',\n                            'roman cathoric-same':'chruch','adra \/government':'government','world vision\/ kkkt':'world vision','hw\/rc':'church',\n                              'adra \/community':'adra','sengerema water department':'district','tasaf\/tlc':'tasaf','olgilai village community':'village',\n                              'china government':'china','chinese':'china','village government':'village','finwater':'fini water','rural water supply and sanitation':'village',\n                               'institutional':'private','the people of japan':'japan','hesawz':'hesawa','tasaf and lga':'district','cipro\/government':'government','kkkt church':'kkkt',\n                               'plan internatio':'plan international','schoo':'school','songea district coun':'songea district council',\n                            'regwa company of egypt':'egypt','regwa company':'egypt','us embassy':'usa','lga':'district','hotels and loggs tz ltd':'private',\n                              'the desk and chair foundat':'the desk and chair foundation','game fronti':'game frontier',\n                              'oikos e.africa\/european union':'oikos e africa','oikos e .africa':'oikos e africa','african':'oikos e africa',\n                                'finland':'fini water','i.e.c':'iec','isf\/government':'government','roman catholic rulenge diocese':'church',\n                                 'w.d &':'wd','isf\/tacare':'isf','ubalozi wa japani':'japan','cipro\/care\/tcrs':'tcrs','lutheran':'church','mkinga distric cou':\n                                'district','villagers':'village','rc ch':'church','rc':'church','unice':'unicef','world vision\/adra':'world vision',\n                                 'unicef\/central':'unicef','karumba biulding contractor':'private','songea district council'  :'distict','district water department':'district',\n                                  'saxon building contractor':'private','j mal abdallah':'jamal abdallah','finida german tanzania govt':'government', \n                                    'rural water supply and sanita':'village','winnin spirit co ltd':'private','water aid\/sema':'water aid','pr':'private','tasaf\/':'tasaf' \n                                     ,'dokta mwandulami':'dokta mwandulam' ,'dr. matobola':'private','dwe}':'dwe','water aid \/sema':'water aid','doner and com':'private',\n                                              'a\/co germany':'germany','churc':'church','aco\/germany':'germany','rc church\/centr':'church','cental government':'government',\n                                        'villagers mpi':'village','udc\/sema':'sema','china henan contractor':'china','tcrs \/government':'government','communit':'community',\n                                       'church of disciples':'church','adra\/ community':'adra','village authority':'village','uniceffinida german tanzani':'unicef','uniceffinidagermantanzania':'unicef',\n                                      'w0rld  bank':'world bank','villager':'village','old bank':'world bank','village gover':'village','village committee':'village','village fou':'village',\n                                      'village gover':'village','the desk and chair foundati':'private','tz\/japan embass':'government','tanzania na egypt':'government',\n                                      'tanzania christian service':'government','tanzania na egypt':'government','tanzania nea egypt':'government','tasaf\/village community':'village','unise':'unicef',\n                                      'swedish tandala project':'sweden','rcchurch':'church','othodox church':'church','private company':'private','private manager':'private',\n                                      'tanzania\/australia':'government','wise-usa':'usa','tober and friends from austral':'australia','tz\/japan embass':'japan','watoto foundation':'private',\n                                      'ubalozi wa marekani\/dwe':'dwe','tag church vi':'church','school administration':'school','school capital':'school','sinohydro':'china','daids':'dandia','danida \/wsdp':'dandia',\n                                      'heaswa':'heasawa','kkkt church s':'kkkt','lga and the commu':'lga','chruch':'church','dwe\/norad':'dwe','fw':'fini water','ga':'germany','gen':'germany',\n                                      'plan int':'plan international','ridep':'redep','tasaf':'tassaf','the desk and chair foundation':'private','ru':'rudep','peter tesha':'peters','md':'mdrdp',\n                                      'local  technician':'local','local contract':'local','local te':'local','muwsa':'muwasa','oxfam':'oxfarm','finland government finland gov':'fini water',\n                                      'government\/julius':'government','kkkt imbaseny':'kkkt','kkkt kolila':'kkkt','kkkt mso':'kkkt','lgsp\/dwe':'dwe','mosque bugula':'mosque','mosque pera':'mosque','water of water':'water',\n                                      'romam catholc\/vil':'church'})","cb6cafab":"#Combining the rare values in funders and installers columns into one group to redcuce noise \n\nFunder=set(train['funder'].value_counts().tail(1631).index)\n\nfor funder in Funder:\n    train['funder'].replace({funder:'rare_field'},inplace=True)\n    test['funder'].replace({funder:'rare_field'},inplace=True)\n#print('Funder Done')\n    \nInstaller=set(train['installer'].value_counts().tail(1648).index)\n\nfor installer in Installer:\n    train['installer'].replace({installer:'rare_field'},inplace=True)\n    test['installer'].replace({installer:'rare_field'},inplace=True)\n#print('Installer Done')\n    \nWard=set(train['ward'].value_counts().tail(1891).index)\n\nfor ward in Ward:\n    train['ward'].replace({ward:'rare_field'},inplace=True)\n    test['ward'].replace({ward:'rare_field'},inplace=True)\n#print('Ward Done')  \n\nvillage=set(train['subvillage'].value_counts().tail(18384).index) #95 percentile \n\nfor v in village:\n    train['subvillage'].replace({v:'rare_field'},inplace=True)\n    test['subvillage'].replace({v:'rare_field'},inplace=True)\n#print('subvillage Done')  ","40aa2b58":"del Funder \ndel village\ndel Installer\ndel Ward","1423a2b9":"#Remving values where are unique in test set and replacing them with rare_field\n\nfor col in ['funder','installer','subvillage','ward']:\n    for v in set(test[col]).symmetric_difference(set(train[col])):\n        test[col].replace({v:'rare_field'},inplace=True)\n                                                   \n                                                   ","6a2c8599":"#Creating new columns \n\n\n\ntrain['location']=(train['region'].astype(str)\n                   +\"_\"+\n                   train['lga'].astype(str)\n                  )\n\ntest['location']=(test['region'].astype(str)\n                   +\"_\"+\n                   test['lga'].astype(str)\n                  )\n\n\ntrain['quality_quantity']=(train['quality_group'].astype(str)\n                   +\"_\"+\n                   train['quantity'].astype(str)\n                  )\n\ntest['quality_quantity']=(test['quality_group'].astype(str)\n                   +\"_\"+\n                   test['quantity'].astype(str)\n                  )","edf2aeda":"train['ext_type_class_year']=(train['extraction_type_class'].astype(str)\n                   +\"_\"+\n                   train['construction_year'].astype(str)\n                  )\n\ntest['ext_type_class_year']=(test['extraction_type_class'].astype(str)\n                   +\"_\"+\n                   test['construction_year'].astype(str)\n                  )\n","31594302":"\next_type_class_year=set(train['ext_type_class_year'].value_counts().tail(54).index)\n\nfor v in ext_type_class_year:\n    train['ext_type_class_year'].replace({v:'rare_field'},inplace=True)\n    test['ext_type_class_year'].replace({v:'rare_field'},inplace=True)\n#print('ext_type_class_year Done')\n    \n    \nfor col in ['ext_type_class_year']:\n    for v in set(test[col]).symmetric_difference(set(train[col])):\n        test[col].replace({v:'rare_field'},inplace=True)","8f539798":"\nfrom sklearn.feature_selection import mutual_info_classif\n\ndiscrete_features=[ 'permit', 'management_group',\n       'source_class', 'public_meeting', 'quality_group', 'scheme_management',\n       'payment', 'extraction_type_class', 'quantity', 'waterpoint_type_group',\n       'region', 'lga', 'ward', 'subvillage', 'funder', 'installer',\n       'construction_year', 'location',\n        'quality_quantity','ext_type_class_year']\n\nX=train.copy()\n\nfor col in discrete_features:\n    X[col],_=X[col].factorize()\n\nX=X.drop(['status_group','folds'],axis=1)\ny,_=train['status_group'].factorize()\n\nmi_scores=mutual_info_classif(X, y)\nmi_scores = pd.Series(mi_scores, name=\"MI Scores\",index=X.columns)\nmi_scores = mi_scores.sort_values(ascending=False)\n\nmi_scores","798cceec":"from category_encoders import TargetEncoder\nimport xgboost as xgb\nfrom sklearn import preprocessing, metrics \nimport random \nimport warnings \nimport lightgbm as lgb\n\nwarnings.filterwarnings('ignore')\n\ndef run(fold=5,model_num=15):\n    \n    \n    \n    #Converting all columns to string \n\n    for column in categorical+['location','quality_quantity','ext_type_class_year']:\n        \n        train.loc[:,column]=train[column].astype(str)\n        if(column!='status_group'):\n            test.loc[:,column]=test[column].astype(str)\n\n        \n\n    #label_encoding=[col for col in categorical if col not in ['funder','installer','ward','subvillage','region','lga']]\n    \n    for column in categorical+['location','quality_quantity','ext_type_class_year']:\n        lb=preprocessing.LabelEncoder()\n        lb.fit(train[column])\n        train.loc[:,column]=lb.transform(train[column])\n        \n        \n        if( column!='status_group'): \n            test.loc[:,column]=lb.transform(test[column])\n    \n    \n    \n    \n    \n    model_list=[0]*model_num\n    prediction=np.zeros((test.shape[0],2*model_num*fold))\n    col=0\n    \n    print('******XGB Model******')\n    \n    for i in np.arange(model_num):\n        \n        \n        print(f\"model no:{i}\")\n        \n        for fold in np.arange(5):\n            \n            \n            \n            df_train=train[train['folds']!=fold].reset_index(drop=True)\n            df_valid=train[train['folds']==fold].reset_index(drop=True)\n    \n            model_xgb = xgb.XGBClassifier(objective ='multi:softmax', num_class=3 ,colsample_bytree =0.6,\n                                        learning_rate = 0.15, max_depth = 10, alpha = 0.8,\n                                        n_estimators = 200,eval_metric='merror',nthread=-1,\n                                        subsample=0.8, verbosity=0,use_label_encoder=False\n                                        ,scale_pos_weight= 4,random_state=random.randint(10, 10000))\n    \n            model_xgb.fit(df_train.drop(['status_group','folds'],axis=1),df_train['status_group'])\n    \n            train_preds=model_xgb.predict(df_train.drop(['status_group','folds'],axis=1))\n            valid_preds=model_xgb.predict(df_valid.drop(['status_group','folds'],axis=1))\n        \n            \n    \n            train_accuracy=metrics.accuracy_score(df_train['status_group'],train_preds)\n    \n            valid_accuracy=metrics.accuracy_score(df_valid['status_group'],valid_preds)\n            \n            prediction[:,col]=model_xgb.predict(test.drop(['id'],axis=1))\n            \n        \n    \n            print(f\"fold={fold},train_accuracy={train_accuracy},valid_accuracy={valid_accuracy}\")\n        \n            \n            col=col+1\n    \n    ### Add Light GBM here too \n    print('******Light GBM Model******')\n    \n    for i in np.arange(model_num):\n        \n        \n        print(f\"model no:{i}\")\n        \n        for fold in np.arange(5):            \n            \n            df_train=train[train['folds']!=fold].reset_index(drop=True)\n            df_valid=train[train['folds']==fold].reset_index(drop=True)\n    \n            model_lgb = lgb.LGBMClassifier(objective ='multiclass', num_class=3,learning_rate= 0.12,lambda_l1= 0.22,\n                                           num_leaves= 184, max_depth= 74,min_data_in_leaf=5, feature_fraction= 0.52,  \n                                           bagging_fraction= 0.85,bagging_freq= 7,boosting_type= 'gbdt',\n                                            random_state=random.randint(10, 10000),verbose=-1)\n    \n            model_lgb.fit(df_train.drop(['status_group','folds'],axis=1),df_train['status_group'])\n    \n            train_preds=model_lgb.predict(df_train.drop(['status_group','folds'],axis=1))\n            valid_preds=model_lgb.predict(df_valid.drop(['status_group','folds'],axis=1))\n        \n            \n    \n            train_accuracy=metrics.accuracy_score(df_train['status_group'],train_preds)\n    \n            valid_accuracy=metrics.accuracy_score(df_valid['status_group'],valid_preds)\n\n            prediction[:,col]=model_lgb.predict(test.drop(['id'],axis=1))\n            \n        \n    \n            print(f\"fold={fold},train_accuracy={train_accuracy},valid_accuracy={valid_accuracy}\")\n        \n            \n            col=col+1\n        \n    return prediction","e5414d55":"predictions=run()","e800de37":"from scipy import stats\ntest['status_group']=stats.mode(predictions,axis=1)[0]\n\ntest['status_group'].replace({0.0:'functional',2.0:'non functional',1.0:'functional needs repair'},inplace=True)\n\ntest[['id','status_group']].to_csv('.\/Xgboost_lightGBM_ensemble_fold_random.csv',index=False)","13b82af7":"#import lightgbm as lgb\n\n#from category_encoders import TargetEncoder\n#import xgboost as xgb\n#from sklearn import preprocessing, metrics \n#import random \n#import warnings \n#import optuna \n\n#def pre_process(train=train,test=test):\n    \n    \n    \n    #Converting all columns to string \n\n    #for column in categorical+['location','quality_quantity','ext_type_class_year']:\n        \n        #train.loc[:,column]=train[column].astype(str)\n        #if(column!='status_group'):\n            #test.loc[:,column]=test[column].astype(str)\n    \n    #for column in categorical+['location','quality_quantity','ext_type_class_year']:\n        #lb=preprocessing.LabelEncoder()\n        #lb.fit(train[column])\n        #train.loc[:,column]=lb.transform(train[column])\n        \n        \n        #if( column!='status_group'): \n            #test.loc[:,column]=lb.transform(test[column])\n\n        \n    #return train, test\n\n#train,test=pre_process(train=train,test=test)\n\n\n#def d_train_test(fold,train,test):\n    \n    \n    \n    #df_train=train[train['folds']!=fold].reset_index(drop=True)\n    #df_valid=train[train['folds']==fold].reset_index(drop=True)\n    \n    #train_data=lgb.Dataset(df_train.drop(['status_group','folds'],axis=1),label=df_train['status_group'])\n    \n    \n    #return train_data,df_valid.drop(['status_group','folds'],axis=1),df_valid['status_group'],test\n\n\n        \n\n#def objective(trial,train_set=train,test_set=test):\n    \n    #param = {\n        #'objective': 'multiclass',\n        #'num_class':3,\n        #'verbosity': -1,\n        #'boosting_type': 'gbdt',\n        #'learning_rate':trial.suggest_loguniform('learning_rate',0.01,0.8),\n        #'lambda_l1': trial.suggest_loguniform('lambda_l1', 1e-8, 10.0),\n        #'lambda_l2': trial.suggest_loguniform('lambda_l2', 1e-8, 10.0),\n        #'num_leaves': trial.suggest_int('num_leaves', 2, 256),\n        #'max_depth':trial.suggest_int('max_depth',10,100),\n        #'min_data_in_leaf':trial.suggest_int('min_data_in_leaf',5,150),\n        #'feature_fraction': trial.suggest_uniform('feature_fraction', 0.5, 1.0),\n        #'bagging_fraction': trial.suggest_uniform('bagging_fraction', 0.5, 1.0),\n        #'bagging_freq': trial.suggest_int('bagging_freq', 1, 7),\n    #}\n    \n    #accuracy_list=[]\n    \n    #for v in np.arange(5):\n        #X_train,X_valid,y_valid,test=d_train_test(v,train_set,test_set)\n    \n\n        #gbm = lgb.train(param, X_train)\n        #predictions=gbm.predict(X_valid).argmax(axis=1)\n        #accuracy_list.append(metrics.accuracy_score(y_valid,predictions))\n        \n    #accuracy=np.mean(accuracy_list)\n    \n    \n\n    #return accuracy\n\n# Run the optuna study \n\n#study = optuna.create_study(direction='maximize',study_name='Light GBM optimization')\n#study.optimize(objective, n_trials=200)\n","12abc1de":"#from category_encoders import TargetEncoder\n#import xgboost as xgb\n#from sklearn import preprocessing\n#import warnings \n\n#warnings.filterwarnings('ignore')\n\n#def get_data():\n    \n    #Converting all columns to string \n\n    #for columns in categorical:\n        #train.loc[:,columns]=train[columns].astype(str)\n        \n\n    #label_encoding=[col for col in categorical if col not in ['funder','installer','ward','subvillage','region','lga','construction_year','location']]\n    \n    #for column in label_encoding:\n        #lb=preprocessing.LabelEncoder()\n        \n        #lb.fit(train[column])\n        \n        #train.loc[:,column]=lb.transform(train[column])\n \n    \n    #Target encoder \n    \n    #for column in ['funder','installer','funder','installer','ward','subvillage','region','lga','construction_year','location']:\n        #encoder = TargetEncoder(min_samples_leaf=1)\n        #encoder.fit(train[column], train['status_group'])\n        #train.loc[:,column] =encoder.transform(train[column])\n         \n    \n    #return train.drop(['status_group','folds'],axis=1),train['status_group']","fb806612":"#from sklearn.model_selection import RandomizedSearchCV\n#import numpy as np \n#import xgboost as xgb\n\n#params = {\n        #'learning_rate': np.arange(0,0.3,0.05),\n       #'n_estimators':np.arange(50,250,50),\n       #'subsample':np.arange(0,1.2,0.2),\n        #'gamma': [0.5, 1, 1.5, 2, 5],\n       #'colsample_bytree': np.arange(0.4,1,0.2),\n       # 'max_depth': np.arange(5,15,5),\n       # 'reg_alpha':np.arange(0.5,1,0.5),\n        #'scale_pos_weight':np.arange(0,11,2)\n       # }\n\n#model = xgb.XGBClassifier(objective='multi:softmax',\\\n #                    nthread=1,num_class=3,random_state=7)\n\n#folds = 5\n#param_comb = 150\n\n#X,y=get_data()\n\n\n#kfold = model_selection.StratifiedKFold(n_splits=folds, shuffle = True, random_state = 7)\n\n#random_search = RandomizedSearchCV(model, param_distributions=params, n_iter=param_comb, scoring='accuracy', n_jobs=-1, cv=kfold.split(X,y), verbose=5, random_state=101,refit=True )\n\n\n#random_search.fit(X, y)\n\n#print(\"The best score is {}\".format(random_search.best_score_ ))\n\n#print('\/n')\n\n#print ('The best paramerts are {}'.format(random_search.best_params_))\n","d5d89aeb":"###  Reading Resources ","c1fe522e":"### Model Fitting ","12b5baeb":"### EDA \n\nI performed some EDA on this dataset i wont be sharing all my graphs here in this notebook . But below is the summary of my findings.  I went through each column in the dataset and saw many columns where repeated . So between two columns of the same type one catergorical column will have more levels than the other.  \n\nSome points to consider \n\n1. Plotting latitude vs longtitude vs basin\/ region we see that both point to the same feature . So taking region feature as it has more categories \n\n2. Imputing points outside the area of Tanzania with the mean of the latitude and longitute column \n\n3. Reducing the number of levels in scheme managment \n\n4. All null values for Funder and installer are occuring together with the recording year being 2011\n\n5. Lot of construction year is missing \n\n6. basin,region and region code are the same things \n\n7. lga ( local government authority),ward and subvillage are just smaller unit of admistration \n\n8. waterpoint_type_group and waterpoint_type columns are identical so one can be dropped \n\n9.  source type ,source and source class are the same , One has more distinction\/sub-division\n\n10. payment and payment_type is the same column .  \n\n11. extraction and extraction_type_group and extraction_type_class are similar\n\n12. water quality and quality_group are also similar \n\n13. quantity and quantity group are also similar \n\n14. managment and managment group also the same columns\n","e5df3f0a":"### Checking Feature importance \n\nSeeing mutual scores I was able to conclude that the new features added ","3dec55a4":"https:\/\/medium.com\/vickdata\/a-simple-guide-to-scikit-learn-pipelines-4ac0d974bdcf\n\nhttps:\/\/medium.com\/@pushkarmandot\/https-medium-com-pushkarmandot-what-is-lightgbm-how-to-implement-it-how-to-fine-tune-the-parameters-60347819b7fc\n\nhttps:\/\/www.analyticsvidhya.com\/blog\/2017\/06\/which-algorithm-takes-the-crown-light-gbm-vs-xgboost\/\n\n\n#np.percentile(train['ext_type_class_year'].value_counts(),25)","b86aac84":"The latitude and longitude have data which is outside of tanzania . Replacing those points with the mean of the latitude \nand longitude points. ","b2b727cc":"### About the competition \nCan you predict which water pumps are faulty?\n\nUsing data from Taarifa and the Tanzanian Ministry of Water, can you predict which pumps are functional, which need some repairs, and which don't work at all? This is an intermediate-level practice competition. Predict one of these three classes based on a number of variables about what kind of pump is operating, when it was installed, and how it is managed. A smart understanding of which waterpoints will fail can improve maintenance operations and ensure that clean, potable water is available to communities across Tanzania.\n\n### Data Description \nYour goal is to predict the operating condition of a waterpoint for each record in the dataset. You are provided the following set of information about the waterpoints:\n\n1.  **amount_tsh** - Total static head (amount water available to waterpoint)<br>\n2. **date_recorded**- The date the row was entered <br>\n3. **funder** - Who funded the well <br>\n4. **gps_height** - Altitude of the well<br>\n5. **installer** - Organization that installed the well<br>\n6. **longitude** - GPS coordinate <br>\n7. **latitude** - GPS coordinate<br>\n8. **wpt_name** - Name of the waterpoint if there is one<br>\n9. **num_private** -is it private <br>\n10. **basin** - Geographic water basin<br>\n11. **subvillage** - Geographic location<br>\n12. **region** - Geographic location<br>\n13. **region_code** - Geographic location (coded)<br>\n14. **district_code** - Geographic location (coded)<br>\n15. **lga** - Geographic location<br>\n16. **ward** - Geographic location<br>\n17. **population** - Population around the well<br>\n18. **public_meeting**- True\/False<br>\n19. **recorded_by** - Group entering this row of data<br>\n20. **scheme_management** - Who operates the waterpoint<br>\n21. **scheme_name**- Who operates the waterpoint<br>\n22. **permit**- If the waterpoint is permitted<br>\n23. **construction_year** - Year the waterpoint was constructed<br>\n24. **extraction_type** - The kind of extraction the waterpoint uses<br>\n25. **extraction_type_group** - The kind of extraction the waterpoint uses<br>\n26. **extraction_type_class**- The kind of extraction the waterpoint uses<br>\n27. **management**- How the waterpoint is managed<br>\n28. **management_group** - How the waterpoint is managed<br>\n29. **payment** - What the water costs<br>\n30. **payment_type** - What the water costs<br>\n31. **water_quality** - The quality of the water<br>\n32. **quality_group** - The quality of the water<br>\n33. **quantity** - The quantity of water<br>\n34. **quantity_group** - The quantity of water<br>\n35. **source**- The source of the water<br>\n36. **source_type** - The source of the water<br>\n37. **source_class** - The source of the water<br>\n38. **waterpoint_type** - The kind of waterpoint<br>\n39. **waterpoint_type_group** - The kind of waterpoint<br>\n\n### My Stratergy \n\nI am planing to learn and use different gradient boost model on this dataset .This data set has a good mix of numerical and catergorical values so it would be good learning experience for me to try this data with gradient boost . I plan to use \n\n1. XGboost<br>\n2. Light GBM<br>\n3. Catboot <br>\n\nand then try to create a ensemble of it . The current rank one of this competition is at score 0.8294 so want to get as close to that score.\n\nIn this notebook I have tried the XGboost and LightGBM . Catboost was tried in another notebook whose work is not share below. ","c1a6be0f":"So to summarize I have used two GBM model Light GBM and XGboost and fine tuned them using Optuna and RandomsearchCV \n\nAfter that I have I have combined the two model to generate prediction on the test set which gets me 0.8147 private LB score.The topper for the competition is at 0.8245. ","58ccd72d":"## The End ","87495b84":"### Fine  tuning XGboost using Random search CV ","47112508":"There are many entries in the funder and installer columns which are similar but spelled differently. I did some manual sampling to correct as many as I can so as to reduce the noise in the dataset and also removed rare catergories in the dataset. ","d832335b":"### Fine Tune Light GMB using Optuna ","0ce10d1d":"#### import the required dataset with required columns only ","a37b6920":"Intresting to note that natural ways of pumps work much more reliable than technologically powered so thinking of group this into 3 types \ngravity , handpump ,submersible and other( other + motorpump+rope_pump+wind-powered)"}}