{"cell_type":{"626b2071":"code","bb437b32":"code","ce19d78d":"code","12eb3a51":"code","57424d1b":"code","43f93958":"code","4265edef":"code","fe08f6ec":"code","3575ae68":"code","e4b34870":"code","2e4718ea":"code","7d648cb5":"code","166da2d3":"code","0dd58bdb":"code","020bc249":"code","f358b04b":"code","72b1a6fa":"code","50f41fe9":"code","97aa6f1a":"markdown","f17abdaf":"markdown","4180c32f":"markdown","b3ef3eba":"markdown","7092f2ab":"markdown","6bc45d25":"markdown","bb716371":"markdown","0101029a":"markdown","c0725833":"markdown","f77b8991":"markdown","0c824448":"markdown","072d1f91":"markdown","f742e422":"markdown"},"source":{"626b2071":"import pandas as pd\nimport numpy as np\nimport re\nimport string\nimport nltk\nfrom nltk.corpus import stopwords\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nfrom wordcloud import WordCloud, STOPWORDS","bb437b32":"# Import the dataset 150k\ndf = pd.read_csv('..\/input\/wine-reviews\/winemag-data_first150k.csv', index_col=0)\n\n# Drop the duplicates from 150k --> almost 100k rows \ndf = df.drop_duplicates()\ndf = df.replace('US-France', 'US') # only 1 row classified as US-France but it's actually US\ndf.head()","ce19d78d":"df.info()","12eb3a51":"# Top 10 wine countries \ncountry = df.groupby('country').size().reset_index(name='count').sort_values('count', ascending=False)\npx.bar(country.head(10), x='country', y='count', template='simple_white')","57424d1b":"# World map \npx.choropleth(country, locations = 'country', locationmode='country names', color = 'count', template = 'simple_white',range_color=[2000,15000], color_continuous_scale='Viridis')","43f93958":"# Price distribution, you can move the bar below to zoom in for some price ranges\nfig = px.histogram(df, x=\"price\", nbins = 250, template='simple_white')\nfig.update_layout(xaxis=dict(rangeslider=dict(visible=True), type=\"linear\"))","4265edef":"df.groupby('country').price.agg(['count', 'min', 'max', 'mean']).reset_index().sort_values('count', ascending=False).head(10)\n","fe08f6ec":"px.scatter(df[df.price < 30], x = 'points', y = 'price', template='simple_white')","3575ae68":"france = df[df.country == 'France'].groupby('province').size().reset_index(name='count').sort_values('count', ascending=False)\n\npx.pie(france, names = 'province', values = 'count')","e4b34870":"us = df[df.country == 'US'].groupby('province').size().reset_index(name='count').sort_values('count', ascending=False)\n\npx.pie(us.head(10), names = 'province', values = 'count')","2e4718ea":"df.description","7d648cb5":"# Remove numbers and punctuations\ndef cleaning(words):\n    words = re.sub(\"[^a-zA-Z]\",\" \", str(words))\n    text = words.lower().split()                   \n    return \" \".join(text)\n\ndf['text'] = df.description.apply(cleaning)\ndf[['description', 'text']].head()","166da2d3":"# Remove stopwords\nnltk.download('stopwords')\n\nstop_words = stopwords.words('english')\ndef stopwords(text):\n    word = [word.lower() for word in text.split() if word.lower() not in stop_words]\n    return \" \".join(word)\n\ndf['text_ready'] = df.text.apply(stopwords)\ndf[['description', 'text']].head()","0dd58bdb":"text = \" \".join(review for review in df.text_ready)\n\n# Create a custom stopwords list\nstopwords = set(STOPWORDS)\nstopwords.update([\"drink\", \"now\", \"wine\", \"flavor\", \"flavors\", 'finish', 'palate', 'show', 'nose', 'note', 'taste', 'shows', 'notes'])\n\n# Generate a word cloud image\nwordcloud = WordCloud(stopwords=stopwords, background_color=\"white\").generate(text)\n\n# Display the generated image the matplotlib way:\nplt.imshow(wordcloud, interpolation='bilinear')\nplt.axis(\"off\")\nplt.show()","020bc249":"# Top 5 varieties\ndf.groupby('variety').size().reset_index(name='count').sort_values('count', ascending=False).head(5)","f358b04b":"pinot = \" \".join(review for review in df[df.variety == 'Pinot Noir'].text_ready)\n\nwordcloud = WordCloud(stopwords=stopwords, background_color=\"white\").generate(pinot)\nplt.imshow(wordcloud, interpolation='bilinear')\nplt.axis(\"off\")\nplt.show()","72b1a6fa":"chardonnay = \" \".join(review for review in df[df.variety == 'Chardonnay'].text_ready)\n\nwordcloud = WordCloud(stopwords=stopwords, background_color=\"white\").generate(chardonnay)\nplt.imshow(wordcloud, interpolation='bilinear')\nplt.axis(\"off\")\nplt.show()","50f41fe9":"sauvignon = \" \".join(review for review in df[df.variety == 'Cabernet Sauvignon'].text_ready)\n\nwordcloud = WordCloud(stopwords=stopwords, background_color=\"white\").generate(sauvignon)\nplt.imshow(wordcloud, interpolation='bilinear')\nplt.axis(\"off\")\nplt.show()","97aa6f1a":"**Price distribution of top 10 countries**\n\nAs you can see while all the wines despite their origins start around 5$, only US and French wines have an actual bottle of more than 2,000$","f17abdaf":"**Correlation between price and points**\n\nConsider paying max 30$ for a bottle which is quite acceptable, so here we can see the points begin at 80. \n\nYou can find a bottle at any price but to have a bottle at min 94 pts, you have to pay at least 15$","4180c32f":"**Zoom in to French provinces**\n\nAlthough Bordeaux is the most popular province for wine, France has quite a list of good wines through the country.","b3ef3eba":"### EDA","7092f2ab":"**WORDCLOUDS**\n\nWe can see \"black cherry\" or \"full bodied\" are displayed many times, we can spot some words like \"rich\", \"fruit\", \"sweet\" or \"fresh\"","6bc45d25":"**Price distribution**","bb716371":"### Wine description analysis","0101029a":"Firstly, I will do some cleaning of the description","c0725833":"We can now know that almost all the wines in the dataset come from US and Europe (specially France, Italy and Spain). The 3rd zone is South America with Chile and Argentina. ","f77b8991":"Let's see if the words are differents based on variety","0c824448":"### The dataset\n\nAs you can see below, there is duplicates which reduce the dataset from 150k entries to almost 100k. There is also missing values in some columns but I choose to not handle it for now.","072d1f91":"Hello, I'm learning data analysis and Python so here is my notebook using this dataset. Feel free to comment! ","f742e422":"**US provinces**\n\nCalifornia is the place-to-be if you want to produce wine in US with over 70%, following with Washington and Oregon who cover already over 90% of the market."}}