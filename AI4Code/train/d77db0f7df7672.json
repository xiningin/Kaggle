{"cell_type":{"80beca0f":"code","bd52d12e":"code","8061fd5c":"code","f9120246":"code","9e47e561":"code","50942f5d":"code","bedd97f5":"code","d3bff5f2":"code","5fde41e1":"code","e96cf9ee":"code","a7e1c395":"code","1de49a57":"code","b3531475":"code","a88237a5":"code","29a5c14f":"code","78143041":"code","7043f7b3":"code","3cde3d39":"code","0486ce30":"code","a22fc010":"code","467f9a24":"code","dfbc34e5":"code","bd7b2b93":"code","8950834b":"code","322378e8":"code","6084a89a":"code","0a9f57ae":"code","d8dfe48b":"code","201f9d05":"code","07302016":"code","adbb168d":"code","b91ecf7a":"code","ff6b974c":"code","ba9c4a69":"code","fd02ff61":"code","750c445a":"code","2b0bd35b":"code","368da2fb":"code","17efaea3":"code","55977e65":"code","fb42a951":"code","27e21a7c":"code","d2af16da":"code","97fe976c":"code","3f332ade":"code","28aa4262":"code","8a8ddc7b":"code","94af40ab":"code","069d8ba2":"code","e25cb161":"markdown","8ced4f37":"markdown","404e6ae9":"markdown","16f8cd6d":"markdown","20e72cf2":"markdown","da316a77":"markdown","cf2b467f":"markdown","dfe63455":"markdown","7457619b":"markdown","1e8af90d":"markdown","4ac816e9":"markdown","1d36533b":"markdown","bb5d3591":"markdown","82b50dfa":"markdown","cfe1ce74":"markdown","b25aa1bd":"markdown","bc220ace":"markdown","6067ccf4":"markdown","4bdcf524":"markdown","ae63fe9f":"markdown","e5bae689":"markdown","ccc47262":"markdown","471f631e":"markdown","36b33c6c":"markdown","ebd0de56":"markdown","19793141":"markdown"},"source":{"80beca0f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","bd52d12e":"!pip install mido\n!pip install pygame","8061fd5c":"from mido import MidiFile\nimport pygame\nimport IPython\nimport matplotlib.pyplot as plt\nimport librosa.display","f9120246":"data=pd.read_csv('..\/input\/musicnet-dataset\/musicnet_metadata.csv')\ndata.head()","9e47e561":"# Let's try to open one of the file (Beethoven ??)\nmid=MidiFile('..\/input\/musicnet-dataset\/musicnet_midis\/musicnet_midis\/Beethoven\/2313_qt15_1.mid',clip=True)\nmid","50942f5d":"for track in mid.tracks:\n    print(track)","bedd97f5":"for msg in mid.tracks[1]:\n    print(msg)","d3bff5f2":"message_numbers = []\nduplicates = []\n\nfor track in mid.tracks:\n    if len(track) in message_numbers:\n        duplicates.append(track)\n    else:\n        message_numbers.append(len(track))\n\nfor track in duplicates:\n    mid.tracks.remove(track)\n\nmid.save('new_song.mid')","5fde41e1":"mid1=MidiFile('..\/input\/musicnet-dataset\/musicnet_midis\/musicnet_midis\/Bach\/2186_vs6_1.mid',clip=True)\nmid2=MidiFile('..\/input\/musicnet-dataset\/musicnet_midis\/musicnet_midis\/Beethoven\/2313_qt15_1.mid',clip=True)","e96cf9ee":"# Let's take the violin from this and put it in mid2\nmid1.tracks","a7e1c395":"mid2.tracks.append(mid1.tracks[0])","1de49a57":"# Let's have a look once\nmid2.tracks","b3531475":"# Wow we got both of them together now let's save the new song\nmid2.save('Yet Another Song.mid')","a88237a5":"for i in mid1.tracks :\n    for msg in i :\n        if str(type(msg))!=\"<class 'mido.midifiles.meta.MetaMessage'>\":\n            print(msg)","29a5c14f":"# Using Librosa to have a look at the data\nimport librosa\nx, sr = librosa.load('..\/input\/musicnet-dataset\/musicnet\/musicnet\/train_data\/1727.wav')","78143041":"print(x.shape)\nprint(sr)","7043f7b3":"plt.figure(figsize=(14, 5))\nlibrosa.display.waveplot(x, sr=sr)","3cde3d39":"X = librosa.stft(x)\nXdb = librosa.amplitude_to_db(abs(X))\nplt.figure(figsize=(14, 5))\nlibrosa.display.specshow(Xdb, sr=sr, x_axis='time', y_axis='hz')","0486ce30":"data=pd.read_csv('..\/input\/musicnet-dataset\/musicnet\/musicnet\/train_labels\/1727.csv')\ndata.head()","a22fc010":"IPython.display.Audio('.\/animal.wav')","467f9a24":"pip install mido==1.1.11","dfbc34e5":"import mido\nmsg = mido.Message('note_on', note=60)\nmsg.type\n'note_on'\nmsg.note\n60\nmsg.bytes()\n[144, 60, 64]\nmsg.copy(channel=2)\n#<message note_on channel=2 note=60 velocity=64 time=0>","bd7b2b93":"mido.get_output_names()\n['SH-201', 'Integra-7']","8950834b":"!pip install intervaltree","322378e8":"import matplotlib.pyplot as plt                          # plotting\n\nfrom IPython.display import Audio\n\nfrom intervaltree import Interval,IntervalTree\n\n%matplotlib inline","6084a89a":"fs = 44100 ","0a9f57ae":"train_data = np.load(open('..\/input\/musicnet-dataset\/musicnet.npz','rb'))","d8dfe48b":"print ('Number of recordings: ' + str(len(train_data.files)))\n#print ('Example MusicNet ids: ' + str(train_data.keys()[0:5]))","201f9d05":"#I added that to see if the next snippet could work. And it didn't work at all.\n#np.load(train_data, allow_pickle=True)","07302016":"X,Y = train_data['2494'] # data X and labels Y for recording id 2494\nprint type(X)\nprint type(Y)","adbb168d":"#Since I got SyntaxError: invalid syntax I tried\nclass ListType: \n    List = [X, Y] \n      \n    # Will print the object type \n    # of existing class \n    print(type(List))","b91ecf7a":"fig = plt.figure()\nfig.set_figwidth(20)\nfig.set_figheight(2)\nplt.plot(X[0:30*fs],color=(41\/255.,104\/255.,168\/255.))\nfig.axes[0].set_xlim([0,30*fs])\nfig.axes[0].set_xlabel('sample (44,100Hz)')\nfig.axes[0].set_ylabel('amplitude')","ff6b974c":"!pip install MIDIFile","ba9c4a69":"from MIDI import MIDIFile\nfrom sys import argv\n\ndef parse(\"..\/input\/musicnet-dataset\/musicnet_midis\/musicnet_midis\/Brahms\/2150_br25m3.mid\"):\n    c=MIDIFile('..\/input\/musicnet-dataset\/musicnet_midis\/musicnet_midis\/Brahms\/2150_br25m3.mid')\n    c.parse()\n    print(str(c))\n    for idx, track in enumerate(c):\n        track.parse()\n        print(f'Track {idx}:')\n        print(str(track))\n\n\nparse(argv[1])","fd02ff61":"import mido # easy to use python MIDI library\nimport matplotlib.pyplot as plt # plotting\nimport numpy as np # linear algebra\nimport os # accessing directory structure\n\nfrom mido import MidiFile, MidiTrack, Message","750c445a":"os.listdir('..\/input')","2b0bd35b":"paths = []\nsongs = []\n#append every filepath in the blues folder to paths[]\nfor r, d, f in os.walk(r'..\/input\/musicnet-dataset'):\n    for file in f:\n        if '.mid' in file:\n            paths.append(os.path.join(r, file))\n\n#for each path in the array, create a Mido object and append it to song[]\nfor path in paths:\n    mid = MidiFile(path, type = 1)\n    songs.append(mid)\ndel paths","368da2fb":"#first Mido Object\nprint(songs[0])","17efaea3":"notes = []\ndataset = []\nchunk = []\n\n#for each in midi object in list of songs\nfor i in range(len(songs)):\n    #for each note in midi object\n    for msg in songs[i]:\n        #filtering out meta messages\n        if not msg.is_meta:\n            #filtering out control changes\n            if (msg.type == 'note_on'):\n                #normalizing note and velocity values\n                notes.append(msg.note)\n    for i in range(1, len(notes)):\n        chunk.append(notes[i])\n    dataset.append(chunk)\n    chunk = []\n    notes = []\ndel chunk\ndel notes","55977e65":"#ModuleNotFoundError: No module named 'user_details'\n\nfrom user_details.serializers import UserSerializer\n\nclass UserSerializer(serializers.Serializer):\n    uid = serializers.UUIDField()\n    age = serializers.IntegerField()\n    phno = serializers.CharField()\n    uname = serializers.CharField()\n\n    def create(self, validated_data):\n        return Users.objects.create(validated_data)\n\n    def update(self, instance, validated_data):\n        instance.uid = validated_data.get('uid', instance.uid)\n        instance.age = validated_data.get('age', instance.age)\n        instance.phno = validated_data.get('phno', instance.phno)\n        instance.uname = validated_data.get('uname', instance.uname)\n        instance.save()\n        return instance","fb42a951":"from mido import MidiFile\nfrom mido import tempo2bpm\n\nmid = MidiFile('..\/input\/musicnet-dataset\/musicnet_midis\/musicnet_midis\/Brahms\/2150_br25m3.mid')\n\nfor i, track in enumerate(mid.tracks):\n    print('Track {}: {}'.format(i, track.name))\nfor msg in track:\n    print(msg)\nprint(\"type\",msg.type)\nif msg.type==\"set_tempo\":\n    print(\"tempo:\",tempo2bpm(msg.tempo))\nprint(\"time:\",msg.time)\nif not msg.is_meta:\n    print(\"note:\",msg.note)\nprint(\"velocity:\",msg.velocity)\nif msg.type==\"note_on\":\n    print(msg.note)\nprint(msg.velocity)\nif msg.type==\"note_off\":\n    print(msg.note)","27e21a7c":"from mido import MetaMessage","d2af16da":"from mido import MidiFile\nmid = MidiFile('..\/input\/musicnet-dataset\/musicnet_midis\/musicnet_midis\/Brahms\/2150_br25m3.mid')","97fe976c":"for i, track in enumerate(mid.tracks):\n    print('Track {}: {}'.format(i, track.name))\n    for msg in track:\n        print(msg)","3f332ade":"#if msg.is_meta:\n#    ...","28aa4262":"from time import sleep\nimport time","8a8ddc7b":"for msg in MidiFile('..\/input\/musicnet-dataset\/musicnet_midis\/musicnet_midis\/Brahms\/2150_br25m3.mid'):\n    time.sleep(msg.time)\n    if not msg.is_meta:\n        port.send(msg)","94af40ab":"inport = mido.open_input('SH-201')\noutport = mido.open_output('Integra-7')","069d8ba2":"for msg in MidiFile('..\/input\/musicnet-dataset\/musicnet_midis\/musicnet_midis\/Brahms\/2150_br25m3.mid').play():\n    port.send(msg)","e25cb161":"#NameError: name 'port' is not defined","8ced4f37":"#Load MusicNet\n\nDownload MusicNet from http:\/\/homes.cs.washington.edu\/~thickstn\/musicnet.html","404e6ae9":"#It is known to run on MacOS and Linux. It should run on Windows, but then, nothing is certain when Windows is involved, is it? Attempts to make it run on Windows are at your own risk.\nhttps:\/\/pypi.org\/project\/MIDIFile\/","16f8cd6d":"#Fifth Attempt https:\/\/github.com\/mido\/mido\/issues\/186","20e72cf2":"#The time series X is a floating point array of pressure samples, normalized to the interval `[-1,1]`","da316a77":"#OSError: libportmidi.so: cannot open shared object file: No such file or directory","cf2b467f":"#libportmidi.so  is for Ubuntu. Therefore, I'm out.","dfe63455":"#End of attempts with Midi file, for now.","7457619b":"#Each item in MusicNet consists of both an audio time series X and a collection of labels Y.","1e8af90d":"#Displaying a Spectrogram","4ac816e9":"#I'm this close but got again the \"'MetaMessage' object has no attribute 'is_meta'\" issue","1d36533b":"#Fourth Attempt\n\n#Codes by Vee Upatising https:\/\/www.kaggle.com\/function9\/starter-blues-genre-midi-melodies-data-processing","bb5d3591":"#Mido - MIDI Objects for Python https:\/\/mido.readthedocs.io\/en\/latest\/","82b50dfa":"#MusicNet consists of 330 recordings. Each recording is indexed in train_data by a MusicNet id.","cfe1ce74":"#Again AttributeError: 'MetaMessage' object has no attribute 'is_meta'","b25aa1bd":"#The Errors start from now.","bc220ace":"This means this is a midi file from the above location and type 1 which means all the tracks starts at the same time and 6 tracks here means 6 synchronous tracks while showing 11947 messages in total\nThere are 3 types in total :\n\n\nFirst: 0 Type (Single Track) : all messages are saved in one track.\n\nSecond:  1 Type (Synchronous Track) : all tracks start at the same time.\n\nThird:  2 Type (Asynchronous Track) : each track is independent of the others.","6067ccf4":"#Sixth Attempt\n\nhttps:\/\/mido.readthedocs.io\/en\/latest\/midi_files.html#about-the-time-attribute","4bdcf524":"#Third Attempt https:\/\/pypi.org\/project\/MIDIFile\/","ae63fe9f":"#Data Preprocessing","e5bae689":"#There is more script, though I gave up due everything I ran resulted in errors.","ccc47262":"#Code by Puru Behl  https:\/\/www.kaggle.com\/accountstatus\/music-net\/notebook","471f631e":"#Script from Dataset came from here https:\/\/homes.cs.washington.edu\/~thickstn\/intro.html","36b33c6c":"#From the above example we can see that there are some repetitions of the messages we can clean that up using a code:","ebd0de56":"#A recording of a musical performance is a real-valued time series.\n\nThe values of this time series represent sound pressure variations sampled at regular intervals, in this case 44,100Hz. The human ear interprets pressure periodicities as musical notes.","19793141":"#I tried many ways and I failed in both attempts. I've tried to reproduce tutorials.\n\n#I'd appreciate if anyone can fix it. Cause after searching in Stack overflow I'm still stucked  "}}