{"cell_type":{"4a437d5d":"code","66e43a1b":"code","1f2599d1":"code","bb42f7a6":"code","598f84ed":"code","ea243f33":"code","4795c2cb":"code","b76d5d52":"code","283737e4":"code","e1929625":"code","488a2d39":"code","377a7b59":"markdown","c0f99d58":"markdown","ee60fb6d":"markdown","6b1e3337":"markdown","ea6cb870":"markdown","853b92ba":"markdown","9004f63e":"markdown","be9d00d6":"markdown","2d472b40":"markdown","596bcdaf":"markdown","04be7280":"markdown","078b7929":"markdown","024b738b":"markdown","8c5674a5":"markdown","0fc3b18d":"markdown","8caab5e1":"markdown","dd2580be":"markdown","5ef9fa0b":"markdown","766d4bfd":"markdown","f629725f":"markdown","00964836":"markdown","01a60c5e":"markdown","6ebcaa30":"markdown","358fb7d7":"markdown","0e99f1fa":"markdown","2855951e":"markdown","35e76174":"markdown","ea444cf3":"markdown","5e170a78":"markdown","4f5b5c07":"markdown","8be4b436":"markdown","ecd66b81":"markdown","4ad15800":"markdown","00b6a008":"markdown","10cf36a7":"markdown","18b935b9":"markdown","db569093":"markdown"},"source":{"4a437d5d":"import pandas as pd \nimport numpy as np\nfrom IPython.display import Video, Image\npath_data = '..\/input\/bdb2022plots\/'\n\nfrom IPython.display import HTML\nfrom base64 import b64encode\n\ndef play(filename):\n    html = ''\n    video = open(filename,'rb').read()\n    src = 'data:video\/mp4;base64,' + b64encode(video).decode()\n    html += '<video width=1000 controls autoplay loop><source src=\"%s\" type=\"video\/mp4\"><\/video>' % src \n    return HTML(html)","66e43a1b":"Image(path_data + 'AccelPaths.png')","1f2599d1":"Image(path_data + 'FullReturning.png')","bb42f7a6":"play(path_data + \"NYGTB2508.mp4\")","598f84ed":"Image(path_data + 'static2645.png')","ea243f33":"play(path_data + \"SEA2645OB.mp4\")","4795c2cb":"play(path_data + \"LAC4139.mp4\")","b76d5d52":"Image(path_data + 'static4139b.png')","283737e4":"pd.read_csv(path_data + 'gunners1.csv')","e1929625":"pd.read_csv(path_data + 'gunners2.csv')","488a2d39":"pd.read_csv(path_data + 'vises1.csv')","377a7b59":"# <h1 id = '7' style=\"background-color: #641E16; color: #EE9A81; text-align: center; padding-top: 12px \">7. What are the pros and cons of FireTime?<a class=\"anchor-link\" href=\"https:\/\/www.kaggle.com\/wonkydiamond\/redepa-quantifying-good-coverage-but-no-throw\/notebook#5\">\u00b6<\/a><\/h1>","c0f99d58":"![image.png](attachment:c234e785-eefb-4f88-8a47-208c8f2eb823.png)  \n<i>Equation 1: Bayes Theorem and the relationship between priors, likelihood and posterior<\/i>","ee60fb6d":"A gunner and his team will have strategies on where they plan to punt towards. We have some of that information based on the \u201ckickType\u201d and \u201ckickDirectionIntendended\u201d features in the data.  \n\nA gunner will have rough directional estimates at the start of the play and update those estimates by watching the receiver downfield. This is actually a Bayesian process from the gunners perspective, so we apply a Bayesian model to estimate where the punt is projected to land.\n1. At the snap, we search for punts in the past of the same type and the same direction, by the same kicker, from similar yardages. \n2. The landing spots of those punts act as the priors of where the current punt might land \n3. For each frame when the football is in air, we update the estimate with the projected location of the returner. Since the returner usually moves towards the punt, we call this the likelihood  \n4. We apply bayes theorem below to calculate the posterior distibution, which is what we use for evaluating gunners and also shown in the animations\n\n","6b1e3337":"Again Facyson's $FireTime$ of $0.22$ was superb, meanwhile the other gunner did not have have a viable path to the target via uniform circular motion (this happens occasionally when their pushed on a path too far away from the target). We would then approximate $TotalTime$ using $AltTime$ which is calculated as a worst case, come to a stop then turn then and head straight approximation, this is also a amateur \"juke move\" but rarely used in pro play. We also note that one of the gunners was double teamed, which is accounted for in the next section. ","ea6cb870":"Firstly, we reproduce [the plot generated by NFL Operations](https:\/\/operations.nfl.com\/gameday\/analytics\/stats-articles\/visualizing-the-special-teams-gunner\/) to test our hypothesis that vertical downfield distance lacks key pieces of information. We color code the path that the gunners are taking based on their acceleration and keep the order used in the original article. Blue dots are moments of negative acceleration and we\u2019ve confirm that some gunners are slowing down at the end of their run.  \n","853b92ba":"<i>Figure 4: The projected kinematic path between the gunner (red circles) to the bayesian target (blue circle) <\/i>","9004f63e":"And against double teams: ","be9d00d6":"We suspect that gunners are slowing down because they\u2019ve approached where the football is landing. So we plot the difference in vertical and horizontal distances and also calculate the average deviation between the gunner and the football - at the moment when the football lands. \nIn figure 2 the gunner is still moving from the bottom up. The center (0,0) grey circle is the football, the coloured dots shows how far the gunners were with respect to the football.  We color code by whether the punt was returned (red = yes):","2d472b40":"In the first 2 seconds the gunner and vises are in a unique \u201cduel\u201d. At 2 seconds, a gunner has also committed to their \u201cmove\u201d (eg. breaking inside vs outside) and has chosen a path towards the target. After 2 seconds other complications may also occur.\nWe wish to evaluate this chosen path from the gunner to the target and determine how closely it resembles an optimal path which they would take if they were unimpeded by a vise. Fire time is calculated as:\n\n $$FireTime = \\frac{ChosenPathTime-OptimalPathTime}{OptimalPathTime}$$\n\n\n\nOptimal Path Time is a straight line unimpeded time from snap to that target, using maximum acceleration, capped at full speed. This would be the time a gunner takes to reach the target when there are no blocks of any kind. \nChosen Path Time is an approximation of the path which the gunner has chosen (at the 2 second mark), starting with their position and velocity at that instant. It is then broken up into three stages:\n1. Acceleration stage to get close to top velocity while maintaining the trajectory they\u2019ve chosen\n2. A uniform circular motion stage where a receiver turns while maintaining a set velocity\n3. A final stage where they approach the target in a straight line\n\nDepending on when the gunner starts their turn and given the direction they are heading, they\u2019ll be at a different speed and thus turn at a different radius (to follow uniform circular motion). The Chosen Path and $ChosenPathTime$ is the option of acceleration, turn, run that gets them there the fastest. \n\nAgain these paths are not calculated with the endpoint in where the ball lands, we use the Bayesian estimate from section 3, still giving a meaningful target and a general direction (blue dot). We see the three stages highlighted in different colors in the following play: \n\n1. The red indicates stage 1, straight line acceleration\n2. The orange is the uniform circular motion at a constant speed, from entering the turn\n3. The pink is stage 3 after the turn to the target\n\nThe red dot are the two gunners and the black dot are the vises at exactly 2 seconds, with vectors showing their velocities. There are no double teams in this play. \n","596bcdaf":"# <h1 id = '6' style=\"background-color: #641E16; color: #EE9A81; text-align: center; padding-top: 12px \">6. The best Gunners and Vises<a class=\"anchor-link\" href=\"https:\/\/www.kaggle.com\/wonkydiamond\/redepa-quantifying-good-coverage-but-no-throw\/notebook#5\">\u00b6<\/a><\/h1>","04be7280":"# <h1 id = '4' style=\"background-color: #641E16; color: #EE9A81; text-align: center; padding-top: 12px\">4. An Example Play<a class=\"anchor-link\" href=\"https:\/\/www.kaggle.com\/wonkydiamond\/redepa-quantifying-good-coverage-but-no-throw\/notebook#3\">\u00b6<\/a><\/h1>","078b7929":"By: J. Li, R. Kasar | MIT |\n[Github](https:\/\/github.com\/jlirms\/NFL-BDA-2022)","024b738b":"Sometimes the receiver intentionally lets the punt land, and this bayesian approach accounts for that since we have priors of previous punt locations weighted by where the receiver is moving. \nHere we show an animated version of a punt from 2019 week 9, starting with priors and updating the heatmap frame by frame until the punt lands. ","8c5674a5":"We calculate and aggregate Fire Time for the entire 2019 season, for every gunner listed in the original NFL Operations article to determine the best gunners against single teams:","0fc3b18d":"Although the article was a great starting point and good publicity for gunners. It is blind to many factors gunners have to account for during a play. The article:\n* analyzes gunner performance only by considering how far down the length of the field they run during a punt in the first 4.5s, width is ignored\n* ranks gunners from the first 7 weeks of the 2019 season based on this distance.\n\nHowever, the analysis: \n* Does not account for field position of the punting team. If the punt is from a good field position, the gunner does not need to run as far and may even slow down at the end of a run.\n* Does not show how close the gunner gets to the football when it lands. This should be the gunner\u2019s ultimate goal. In the case of a poor kick, the gunner often adjusts their paths and again, may intentionally slow down\n* Does not account for the strength of opposition against vises, or give any information on vise play or gunners against double teams\n\nWe introduce a novel approach to analyzing gunner performance. This approach quantifies how much a gunner deviates from an optimal path, to an target that is uncertain. The uncertainty is mitigated using Bayes Theorem.  It also focuses on the interaction between gunners and vises early in the play and avoids complications such as late double teams or chasing out of bounds punts.   \nTo motivate this metric, let us first revisit the visualizations used in the original article. ","8caab5e1":"<i>Figure 7: Path calculations for the play shown in Figure 6.<\/i>","dd2580be":"We recognize that $FireTime$ is not the full story, other metrics such as top speed and missed tackles have been studied in greater detail (eg. Combine, PFF grades). In last year's Big Data Bowl, a receiver only needed to be open at a specific moment in time so it was easier to make frame by frame projections. This year the gunners path to the football is filled with many complications and $FireTime$ is a tool to focus on the beginning stage.\n\nAs promised we have the vises, ranked by the fire time achieved by the opposing gunners. ","5ef9fa0b":"<i>Figure 5: Example play animation showing the posterior distribution and motions of Figure 4 - <a href=\"https:\/\/youtu.be\/YyYp92GDwa4?t=2415\"> youtube timestamp <\/a>  <\/i> ","766d4bfd":"<i>Figure 2: Distance between football and gunner when the football lands, up is farther away from the line of scrimmage. Blue dots are returned puts, red dots are fair catches, downed punts or out of bounds<\/i>","f629725f":"# <h1 id = 'Appen' style=\"background-color: #641E16; color: #EE9A81; text-align: center; padding-top: 12px \">Appendix<a class=\"anchor-link\" href=\"https:\/\/www.kaggle.com\/wonkydiamond\/redepa-quantifying-good-coverage-but-no-throw\/notebook#Appen\">\u00b6<\/a><\/h1>\n\n\n","00964836":"<div style=\"font-family:verdana; word-spacing:1.5px;\">\n  <p style=\"text-align:center;\">\"There is no defense against a perfect pass. I can throw the perfect pass.\" -Dan Marino<\/p>\n    <p>A gunner might say something similar to Dan the Man:<\/p>\n   <p style=\"text-align:center;\">\"There is no run back when I make progress downfield, the kicker gets all the credit...\"<\/p>\n     <p>While a vise may add:<\/p>\n   <p style=\"text-align:center;\">\"There is no tackle when I lock up a gunner, the returner gets all the credit...\"<\/p>\n<\/div>","01a60c5e":"We remark that identifying top performing vises may not be as useful as teams will simply utilize a double team against top gunners. The interaction between two vises and a single gunner was too complex to model for $FireTime$ in its current iteration. ","6ebcaa30":"NFL games are often won or lost on special teams, see 2010 Chargers. Special teams are on the field for roughly 20% of the plays in a game but account for more than 30% of the games scoring. [[1]](https:\/\/www.rookieroad.com\/football\/101\/special-teams\/)[[2]](https:\/\/www.sbnation.com\/2017\/11\/15\/16596068\/nfl-kickers-coaching-special-teams) . In addition, special teams can also flip field position, leading to scores. Focus on field position usually centers on punters and recievers: \"*what a kick!..what a run!*\" However, the unsung players of this story are the gunners and vises working hard when the punt is airborne. \n\nGunners are often speedy edge of the roster players that rarely see the field on offense or defense, yet they have the ability to impact the game and be star players, thus identifying the best is important. We began with [this article published by the NFL Operations](https:\/\/operations.nfl.com\/gameday\/analytics\/stats-articles\/visualizing-the-special-teams-gunner\/) which also using tracking data. We assume the judges have read that article, and build on it below.\n\n\n* <a href=\"#2\">Section 2 addresses areas of improvement for this article <\/a>\n* <a href=\"#3\">Section 3 provides updated visuals from the article <\/a>\n* <a href=\"#4\">Section 4 uses an animation to motivate FireTime <\/a>\n* <a href=\"#5\">Section 5 shows the Math and Physics behind FireTime <\/a>\n* <a href=\"#6\">Section 6 ranks Gunners and Vises using FireTime <\/a>\n* <a href=\"#7\">Section 7 talks about the Pros and Cons of FireTime <\/a>","358fb7d7":"It turns out, some gunners who were originally considered below average by vertical distance in the [original article](https:\/\/operations.nfl.com\/gameday\/analytics\/stats-articles\/visualizing-the-special-teams-gunner\/), actually do well in the first 2 seconds of a play according to $Fire Time$. This metric recognizes players like Facyson and Moore and their abilities to win off the line and consistently commit to near optimal paths to the ball. And we believe this is a more meaningful contribution than simply running downfield. Some top performers in the original article such as Bethel and Mostert are still regonized by $FireTime$. \n\nOther factors such as late double teams, their top speed beyond 2 seconds or intentionally slowing down is likely what prevents them from making more progress downfield. And conversely is what allows players like the speedy Slater to \u201ccatch up\u201d even though he is only average in this metric. \n\n","0e99f1fa":"<i>Figure 3: Example play animation showing the posterior distribution of where the punt is projected to land<\/i>","2855951e":"We now see that 10x pro bowler Mathew Slater\u2019s ability to get very close to the ball, with an average vertical deviation of less than four feet. While this plot is useful to evaluate a gunner after the punt lands, we wish to evaluate the gunner at the 2 second mark.  \nPer the original article: \n\n*\u201cNo one travels quicker in the play's first two seconds than Johnny Holton Jr. of the Pittsburgh Steelers. At that point, Holton is an average of 7.7 yards downfield, typically about 0.4 yards in front of the next fastest gunner at that point (Slater).\u201d*  \n\nAgain we use vertical distance downfield as an approximation for gunners ability - which has the same pitfalls listed above. In addition, since a gunner does not know exactly where the ball will land in the future, it would be unfair to use that information to critique his performance and decisions 2 seconds in. We first need an unbiased approximation of where the punt would land, 2 seconds after the snap.  \n","35e76174":"<i>Figure 1: Recreation of the work done by NFL Operations, color by magnitude of acceleration <\/i>","ea444cf3":"# <h1 id = \"5\" style=\"background-color: #641E16; color: #EE9A81; text-align: center; padding-top: 12px \">5. Fire Time<a class=\"anchor-link\" href=\"https:\/\/www.kaggle.com\/wonkydiamond\/redepa-quantifying-good-coverage-but-no-throw\/notebook#4\">\u00b6<\/a><\/h1>","5e170a78":"# <h1 id = '3' style=\"background-color: #641E16; color: #EE9A81; text-align: center; padding-top: 12px \">3. Updated Visualizations <a class=\"anchor-link\" href=\"https:\/\/www.kaggle.com\/wonkydiamond\/redepa-quantifying-good-coverage-but-no-throw\/notebook#2\">\u00b6<\/a><\/h1>","4f5b5c07":"However $FireTime$ tells a completely different story, with B.Facyson (ranked the #1 Gunner against single vise coverage) taking a near perfect path to the ball while the opposite gunner was pushed off the field in a very convoluded path: ","8be4b436":"When we see the animation of this play, we notice that Ugo Amadit (top of screen) has a great inside release. His path is close to optimal given the position and according to $FireTime$ better than the Neiko Thropes path. Although the two are early the same amount of yards downfield, we can use $FireTime$ to evaluate their trajectory. The values needed to calculate $FireTime$ are shown at the bottom, for Amadit: \n$$FireTime = \\frac{8.22-5.5}{5.58}$$ \nwhere  \n$$TotalTime = 8.22 = S1Time + UCMTime + S3Time$$\nWe divide by $OptimalTime$ so that players who have to travel longer distances are not unfairly penalized. \n\nThe animation of this play is shown, and the game footage can be found on [Youtube](https:\/\/youtu.be\/YyYp92GDwa4?t=2415), it confirms great work by both gunners as they cross the 40 yard line.","ecd66b81":"<table>\n  <tr>\n    <td>\n      <p><b>Pro: Metric holistically considers the gunner and vise interaction before the punt fully develops<\/b>\n        This was the main motivator for the project, we can also calculate $FireTime$ at 1 or 3 seconds if desired.<\/p>\n    <\/td>\n    <td>\n      <p><b>Con: Does not account for performance after 2 seconds, such as tackling <\/b>\n        Although these are well tracked stats it is a crucial part in successful punt converage, $FireTime$ by itself is not enough.<i>\n      <\/p>\n    <\/td>\n  <\/tr>\n  <tr>\n    <td>\n      <p><b>Pro: Uses realistic bayesian methods to project where the punt will land<\/b>\n        This is similar to real world gunner play, and is a more fair assement of decisions they make near the line of scrimmage.\n      <\/p>\n    <\/td>\n    <td>\n      <p><b>Con: Generic kinematic\/physics assumptions do not apply to every player \n        <\/b>\n      We assume all gunners and vises move at certain top speeds which is not the case for extremely gifted individuals. They're performance would be underestimated by this metric. \n      <\/p>\n    <\/td>\n  <\/tr>\n\n  <tr>\n    <td>\n      <p><b>Pro: Extracts valueable information without excessive complexity  <\/b>\n       Paths rather than predictions can be visualized for training and scouting purposes, white box (no fancy AI models) approach makes it easy and accessible for the community.<i>\n      <\/p>\n    <\/td>\n    <td>\n      <p><b>Con: Uncertainty in vise strategy\n        <\/b>\n        A vise may not have deployed their defensive tactics by two seconds yet, perhaps electing to match the gunners top speed first as it is much more difficult to evade contact at top speed. <a href=\"https:\/\/youtu.be\/YyYp92GDwa4?t=2415\"> Example, see right vise <\/a> \n      <\/p>\n    <\/td>\n  <\/tr>\n\n<\/table>\n","4ad15800":"<i>Figure 6: Example play animation showing a punt with excellent gunner play on the bottom and excellent vise blocking at the top","00b6a008":"All of the parameters (eg. acceleration and max velocity values) were taken from the first year of punts data in addition to values aquired for similar positioned players from last years data bowl. These parameters can all be adjusted and in the future, fitted to a specific player's speed or turning ability. For now we use features that are generic to all gunners and vises.\n\nWhen we look at another example from week 17, it seems like both gunners make the same amount of progress downfield:","10cf36a7":"# <h1 id = '1' style=\"background-color: #641E16; color: #EE9A81; text-align: center; padding-top: 12px \">1. Introduction<a class=\"anchor-link\" href=\"https:\/\/www.kaggle.com\/wonkydiamond\/redepa-quantifying-good-coverage-but-no-throw\/notebook#1\">\u00b6<\/a><\/h1>","18b935b9":"We estimate the \"target\" location as the center of mass of the posterior distribution. Although this is not ideal, we do not have a computational power to run a full bayesian model at every frame, we instead target the center point. By having reasonable estimates of where the punt would land, we can now properly evaluate gunners and vises 2 seconds after the snap. ","db569093":"# <h1 id = '2' style=\"background-color: #641E16; color: #EE9A81; text-align: center; padding-top: 12px \">2. Areas for Improvement<a class=\"anchor-link\" href=\"https:\/\/www.kaggle.com\/wonkydiamond\/redepa-quantifying-good-coverage-but-no-throw\/notebook#2\">\u00b6<\/a><\/h1>"}}