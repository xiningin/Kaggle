{"cell_type":{"0c031f2a":"code","29b202d0":"code","a59651cd":"code","ef868232":"code","40156bff":"code","8969a0a9":"code","af69c569":"code","320d2388":"code","b4b5734e":"code","5c96853d":"code","78dc9cfd":"code","a7b50d8f":"code","a1c37f21":"code","59f012b4":"code","5a6e4d95":"code","a6a3cdbb":"code","aa45cfad":"code","e37ef34d":"code","f276460f":"code","8520e1a9":"code","3c7db0d3":"markdown","85c044eb":"markdown","c362c720":"markdown","c6b4b7db":"markdown","171ec1bd":"markdown","0d0497e4":"markdown","fd980b2a":"markdown","c2544833":"markdown","69bdc59e":"markdown","80911899":"markdown","ae0c8685":"markdown","2509e793":"markdown","ae339bcc":"markdown","be81416e":"markdown","749f62db":"markdown","98873552":"markdown","c6b833c2":"markdown","c67195ea":"markdown","ee59bfa6":"markdown","db260f44":"markdown","c8e62a19":"markdown","e83a7c2f":"markdown","70e30fe4":"markdown"},"source":{"0c031f2a":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n%matplotlib inline\nimport matplotlib.pyplot as plt\nimport seaborn as sns","29b202d0":"admission_datasets = pd.read_csv(\"\/kaggle\/input\/graduate-admissions\/Admission_Predict.csv\")\nprint(f\"Number of samples: {admission_datasets.shape[0]}\")","a59651cd":"admission_datasets.head()","ef868232":"admission_datasets.describe()","40156bff":"admission_datasets.info()","8969a0a9":"admission_datasets.drop(\"Serial No.\", axis=\"columns\", inplace=True)","af69c569":"column_names = [\"gre_score\", \"toefl_score\", \"univ_rating\", \"sop\", \"lor\", \"cgpa\", \"research\", \"admit_chance\"]\nadmission_datasets.columns = column_names\nadmission_datasets.head()","320d2388":"sns.pairplot(admission_datasets,\n            x_vars=[\"gre_score\", \"toefl_score\", \"univ_rating\", \"sop\", \"lor\", \"cgpa\", \"research\"],\n            y_vars=[\"admit_chance\"])\nplt.show()","b4b5734e":"X, y = admission_datasets.loc[:,column_names[:-1]], admission_datasets.loc[:,column_names[-1]]","5c96853d":"from sklearn.model_selection import train_test_split\n# Split the data into 300 training samples and 100 testing samples\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)","78dc9cfd":"print(f\"Training data size: {X_train.shape}\")\nprint(f\"Testing data size: {X_test.shape}\")","a7b50d8f":"from sklearn.ensemble import RandomForestRegressor\nregr = RandomForestRegressor(random_state=0)","a1c37f21":"from sklearn.model_selection import GridSearchCV\n\n# Create the parameter grid based on the results of random search \nparam_grid = {\n    'n_estimators': [200, 500],\n    'max_features': ['sqrt', 'log2'],\n    'max_depth' : [5,6,7],\n}\n\n# Instantiate the grid search model\ngrid_search = GridSearchCV(estimator = regr, param_grid = param_grid, \n                          cv = 5, n_jobs = -1, verbose = 2, scoring=\"r2\")","59f012b4":"# Fit the grid search to the data\ngrid_search.fit(X_train, y_train)","5a6e4d95":"from prettytable import PrettyTable\ntable = PrettyTable()\ntable.field_names = [\"Parameter\", \"Value\"] \n\nfor param, val in grid_search.best_params_.items():\n    table.add_row([param, val])\n\nprint(table)","a6a3cdbb":"# retrain the model with best parameters\nregr = RandomForestRegressor(max_depth=grid_search.best_params_['max_depth'], \n                             max_features=grid_search.best_params_['max_features'], \n                             n_estimators=grid_search.best_params_['n_estimators'])","aa45cfad":"regr.fit(X_train, y_train)\ntest_score = regr.score(X_test, y_test)\nprint(f\"Test score: {round(test_score, 3)}\")","e37ef34d":"table = PrettyTable()\ntable.field_names = [\"Parameter\", \"Value\"] \n\nfor column, imp in zip(column_names[:-1], regr.feature_importances_):\n    table.add_row([column, round(imp, 3)])\n\nprint(table)","f276460f":"from sklearn.base import clone\nselect_cols = ['gre_score', \"toefl_score\", \"cgpa\"]\n\n\nmodel = clone(regr)\nmodel.fit(X_train.loc[:,select_cols], y_train)\nscore = model.score(X_test.loc[:,select_cols], y_test)\nprint(f\"Score with only three important features (GRE, TOEFL, CGPA): {round(score, 3)}.\")\nprint(f\"Drop in r2 score when unimportant features are removed: {round(test_score - score, 3)}.\")","8520e1a9":"from sklearn.base import clone\nselect_cols = [\"univ_rating\", \"sop\", \"lor\", \"research\"]\n\n\nmodel = clone(regr)\nmodel.fit(X_train.loc[:,select_cols], y_train)\nscore = model.score(X_test.loc[:,select_cols], y_test)\nprint(f\"Score without three important features (GRE, TOEFL, CGPA): {round(score, 3)}.\")\nprint(f\"Drop in r2 score when important features are removed: {round(test_score - score, 3)}.\")","3c7db0d3":"Before continuing with analysis, we should remove column 'Serial No.' and then rename the column names for each indexing.","85c044eb":"From the pairplot above, we observe that their is linear relationship between admission chance and features such as GRE score, TOEFL score, CGPA. We next test our hypothesis.","c362c720":"# Train a machine learning model to predict admission chance","c6b4b7db":"# Preparing datasets for training","171ec1bd":"## Cross validation with grid search for hyperparameter selection","0d0497e4":"Getting an admission to an university in the USA is a dream for lot of students. To apply for graduate admission, applicants need to take multiple tests such as GRE, TOEFL. Furthermore, the chance of admission depends on the statement of purpose, letter of recommendation, prior research experience and undergraduate GPA. \n\nThe dataset contains following features:\n\n- GRE Score [260-320]\n- TOEFL Score [0, 120]\n- University rating {1,...,5}\n- Statement of purpose [1, 10]\n- Letter of recommendation [1, 10]\n- Undergraduate GPA [0, 10]\n- Prior research experience {0, 1}\n- Chance of admit [0, 1]\n","fd980b2a":"# Conclusion","c2544833":"### Retrain the model with best hyperparameters","69bdc59e":"# Loading dataset to notebook","80911899":"The score significantly drops indicating the importance of these three features.","ae0c8685":"## If you have good undergraduate GPA, GRE score and TOEFL score, you are likely to get accepted for a graduate admission. Note that other aspects also play a role in the admission.","2509e793":"We should first separate the training features from training labels. Then, split the dataset into training and test set to train the machine learning model and evaluate the model.","ae339bcc":"# Exploratory Data Analysis","be81416e":"The choice of appropriate hyperparameters plays crucial role in the performance of the model. There are several ways to select such hyperparameters:\n1. Heuristics: We can pick values of hyperparameters and then select the best hyperparameter settings based on their final performance.\n2. Random Search: We can randomly search the hyperparameters in a given range and pick the best.\n3. Grid search: Instead of randomly sampling, we can try all possible combinations in a given hyperparameter grid.\n\nWe will follow third approach to find best hyperparamter settings.","749f62db":"### Dropping important features","98873552":"Let's plot the pairwise relationships between features and target (admission chance).","c6b833c2":"### Best set of hyperparameters","c67195ea":"Since there are multiple features that may contribute to the chance of admission, we want to train Random Forest Regressor that can rank the importance of the features.","ee59bfa6":"In this notebook, we are going to analyze the admission datasets and build a machine learning model to predict the chance of admission from the features.","db260f44":"We can next check if there are null values in any columns of the dataframe.","c8e62a19":"We can describe the columns of the dataframe to get details about different features. For each column, the description provides number of samples, mean value, standard deviation, minimum value, $1^{st}$ quartile, $2^{nd}$ quartile,  $3^{rd}$ quartile, and maximum value.","e83a7c2f":"The feature importance score indicates that GRE score, TOEFL score and GPA play crucial role to get an admission. So, we test the performance for two cases:\n1. only with these three features\n2. Without these three features","70e30fe4":"### Check the importances of the features"}}