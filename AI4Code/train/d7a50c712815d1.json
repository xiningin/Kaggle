{"cell_type":{"ca981ce0":"code","069aef5b":"code","db836b56":"code","01c31e1c":"code","b4db5e7c":"code","fb893297":"code","ffaadd6e":"code","91f16fd1":"code","810e9217":"code","10745cd9":"code","960fa0f9":"code","eaae94b1":"code","080eb03b":"code","dbb955cf":"code","fbb07bc0":"code","cb335c7d":"code","b0c54983":"code","bbc83809":"code","e5417df3":"code","f30685fa":"code","7392110d":"code","952de4ce":"code","0ac3b953":"code","372fddf0":"code","7b6dbc7c":"code","832da88d":"code","0ffd112d":"code","7fda94bd":"code","312025b9":"code","eace7dc4":"code","c96383be":"code","face4f4f":"code","97332734":"code","3dbec359":"code","39d8a2ed":"code","42408c6d":"code","da80f681":"code","e3cb7054":"code","01fd01a7":"code","0a93013e":"code","7b1a15d0":"code","c2921ba5":"code","351efc73":"code","5daf5014":"code","b4c37c76":"code","ed34a1f5":"code","7e2f4b22":"code","101d7055":"code","5ff45fe2":"code","b0182a0a":"code","2f7955df":"code","45a2f469":"code","3c75b78f":"code","8abfe103":"code","cb846e50":"markdown","8b1e6adf":"markdown","39e9fb5a":"markdown","5e458b5b":"markdown","fbc187ac":"markdown","3656b32d":"markdown","17277e0b":"markdown","0da5bdd8":"markdown","f83b5dab":"markdown","d089e02a":"markdown","7cfeba85":"markdown","6f4f665e":"markdown","1a594854":"markdown","4542fec7":"markdown","30099b03":"markdown","30245269":"markdown","56a76052":"markdown","0b6fa744":"markdown","b39f27a7":"markdown","f1cfb295":"markdown","2a81a00b":"markdown","06688545":"markdown","e531c9da":"markdown","8378b1e6":"markdown","c80e1cba":"markdown","b18c9972":"markdown","0d10bc7d":"markdown","ddbe2c24":"markdown","4fd54442":"markdown","5fd4bf09":"markdown","4ef695d5":"markdown"},"source":{"ca981ce0":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns #for plotting\nfrom sklearn.ensemble import RandomForestClassifier #for the model\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.tree import export_graphviz #plot tree\nfrom sklearn import metrics #for model evalution\nfrom sklearn.feature_selection import RFE,RFECV   #for feature selection\nfrom sklearn.model_selection import train_test_split #for data splitting\npd.options.mode.chained_assignment = None  #hide any pandas warnings","069aef5b":"data=pd.read_csv(\"..\/input\/heart-disease-diagnosis\/heart.csv\")","db836b56":"data.head() #upper five observation","01c31e1c":"data.tail() # lower five observation","b4db5e7c":"data.drop(index=[48,281],axis=0,inplace=True)  # blank value, so thats why i removed","fb893297":"data.columns = ['age', 'sex', 'chest_pain_type', 'resting_blood_pressure', 'cholesterol', 'fasting_blood_sugar', 'rest_ecg', 'max_heart_rate_achieved',\n       'exercise_induced_angina', 'st_depression', 'slope', 'no_major_vessels', 'thalassemia', 'target']","ffaadd6e":"data.head()","91f16fd1":"data.chest_pain_type.value_counts()","810e9217":"data['sex'][data['sex'] == 0] = 'female'\ndata['sex'][data['sex'] == 1] = 'male'\n\ndata['chest_pain_type'][data['chest_pain_type'] == 0] = 'typical angina'\ndata['chest_pain_type'][data['chest_pain_type'] == 1] = 'atypical angina'\ndata['chest_pain_type'][data['chest_pain_type'] == 2] = 'non-anginal pain'\ndata['chest_pain_type'][data['chest_pain_type'] == 3] = 'asymptomatic'\n\ndata['fasting_blood_sugar'][data['fasting_blood_sugar'] == 0] = 'lower than 120mg\/ml'\ndata['fasting_blood_sugar'][data['fasting_blood_sugar'] == 1] = 'greater than 120mg\/ml'\n\ndata['rest_ecg'][data['rest_ecg'] == 0] = 'normal'\ndata['rest_ecg'][data['rest_ecg'] == 1] = 'ST-T wave abnormality'\ndata['rest_ecg'][data['rest_ecg'] == 2] = 'left ventricular hypertrophy'\n\ndata['exercise_induced_angina'][data['exercise_induced_angina'] == 0] = 'no'\ndata['exercise_induced_angina'][data['exercise_induced_angina'] == 1] = 'yes'\n\ndata['slope'][data['slope'] == 0] = 'upsloping'\ndata['slope'][data['slope'] == 1] = 'flat'\ndata['slope'][data['slope'] == 2] = 'downsloping'\n\ndata['thalassemia'][data['thalassemia'] == 1] = 'normal'\ndata['thalassemia'][data['thalassemia'] == 2] = 'fixed defect'\ndata['thalassemia'][data['thalassemia'] == 3] = 'reversable defect'","10745cd9":"data.head()","960fa0f9":"data.info()       # check null value","eaae94b1":"data.age.skew()       # near to normal distribution","080eb03b":"sns.distplot(data.age)","dbb955cf":"sns.distplot(data.resting_blood_pressure)","fbb07bc0":"sns.distplot(data.cholesterol)     #positive skewed and some outlier also","cb335c7d":"sns.boxplot(data.cholesterol)    # upper outlier","b0c54983":"sns.distplot(data.max_heart_rate_achieved)   # moderate skew to left side","bbc83809":"g=sns.FacetGrid(data,row=\"sex\",col=\"target\")   #female cholestral level is very high with target 1 as compared to other\ng.map(sns.distplot,\"cholesterol\")","e5417df3":"data.target.value_counts()","f30685fa":"sns.countplot(x=\"target\", data=data )\nplt.show()","7392110d":"sns.countplot(x='sex', data=data)\nplt.xlabel('Sex')\nplt.show()","952de4ce":"pd.crosstab(data.age,data.target).plot(kind=\"bar\",figsize=(15,6))\nplt.title('Heart disease frequency ages wise')\nplt.xlabel('Age')\nplt.ylabel('Frequency')\nplt.show()","0ac3b953":"pd.crosstab(data.sex,data.target).plot(kind=\"bar\",figsize=(15,6))\nplt.title('Heart disease frequency sex wise')\nplt.xlabel('Sex')\nplt.legend([\"Haven't Disease\", \"Have Disease\"])\nplt.ylabel('Frequency')\nplt.show()","372fddf0":"pd.crosstab(data.fasting_blood_sugar,data.target).plot(kind=\"bar\",figsize=(15,6))\nplt.title('Heart Disease Frequency By FBS')\nplt.xlabel('FBS - (Fasting Blood Sugar )')\nplt.legend([\"Haven't Disease\", \"Have Disease\"])\nplt.ylabel('Frequency of Disease or Not')\nplt.show()","7b6dbc7c":"pd.crosstab(data.chest_pain_type,data.target).plot(kind=\"bar\",figsize=(15,6),color=['#11A5AA','#AA1190' ])\nplt.title('Heart disease frequency acc. to chest pain type')\nplt.xlabel('chest_pain_type')\nplt.ylabel('Frequency of Disease or Not')\nplt.show()","832da88d":"data.dtypes","0ffd112d":"data=pd.get_dummies(data,drop_first=True)\ndata.head()       # Now,Let's see","7fda94bd":"data.shape","312025b9":"x=data.drop(\"target\",axis=1).values    ","eace7dc4":"y=data.target.values","c96383be":"x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.25,random_state=0) #split the data","face4f4f":"x_train.shape","97332734":"x_test.shape","3dbec359":"model = RandomForestClassifier(random_state=0)\nmodel.fit(x_train, y_train)                     #fits the data into model","39d8a2ed":"y_predict=model.predict(x_test)\ny_predict                       #predicted value","42408c6d":"confusion_matrix=metrics.confusion_matrix(y_test,y_predict)\nconfusion_matrix","da80f681":"classification_report=metrics.classification_report(y_test,y_predict)\nprint(classification_report)","e3cb7054":"accuracy=metrics.accuracy_score(y_test,y_predict)    # accuracy\naccuracy","01fd01a7":"y_pred_prob=model.predict_proba(x_test)[:,1]","0a93013e":"fpr, tpr, thresholds = metrics.roc_curve(y_test,y_pred_prob)\nplt.plot(fpr, tpr)\nplt.xlim([0.0, 1.0])\nplt.ylim([0.0, 1.0])\nplt.title('ROC curve')\nplt.xlabel('False Positive Rate (1 - Specificity)')\nplt.ylabel('True Positive Rate (Sensitivity)')\nplt.grid(True)","7b1a15d0":"metrics.auc(fpr,tpr)    #auc Area Under the Curve","c2921ba5":"Rfecv=RFECV(estimator=model)\nRfecv=Rfecv.fit(x_train,y_train)","351efc73":"X_train_df=data.drop(\"target\",axis=1)    # because columns attribute not in array so thats why array convert into dataframe","5daf5014":"list(zip(X_train_df.columns,Rfecv.support_,Rfecv.ranking_))","b4c37c76":"Rfecv.support_","ed34a1f5":"X_train_df.columns[Rfecv.support_]","7e2f4b22":"X_train=x_train    # create two new variable for new model\nX_test=x_test","101d7055":"X_train","5ff45fe2":"X_train=np.delete(x_train,obj=[10,11,16],axis=1)   # remove 10,11,16 columns because these are not important\nX_test=np.delete(x_test,obj=[10,11,16],axis=1) ","b0182a0a":"model_new=RandomForestClassifier(random_state=0)","2f7955df":"model_new.fit(X_train,y_train)      # fit model after removes cloumns with the help of RFECV","45a2f469":"Y_predict=model_new.predict(X_test)\nY_predict","3c75b78f":"classification_report_new=metrics.classification_report(y_test,Y_predict)\nprint(classification_report_new)","8abfe103":"print(classification_report)                          #nothing much has changed  same like older","cb846e50":"### Diagnosing Heart Disease\n\n\nUsing ML Tools and Techniques","8b1e6adf":"##### All are significant features\n\n'age', 'resting_blood_pressure', 'cholesterol',\n\n'max_heart_rate_achieved', 'st_depression', 'no_major_vessels',\n\n'sex_male', 'chest_pain_type_atypical angina',\n\n'chest_pain_type_non-anginal pain', 'chest_pain_type_typical angina',\n\n'rest_ecg_normal', 'exercise_induced_angina_yes', 'slope_flat',\n\n'slope_upsloping', 'thalassemia_reversable defect']","39e9fb5a":"##### our model works fine","5e458b5b":"### We can't plot the consequent decision tree,because max_depth of random forest may bi high if you want to show the random forest plot you can edit the max_depth parameter value and then use export_graphviz package for visualize tree","fbc187ac":"## Data Exploration (EDA)==>","3656b32d":"### Let's also check with a Receiver Operator Curve (ROC)","17277e0b":"### Looking good. Now i fits a Random forest model to the data","0da5bdd8":"## Let's change the column names to be a bit clearer->","f83b5dab":"### However, the meaning of some of the column headers are not obvious. Here's what they mean\n\n\nage: The person's age in years\n\nsex: The person's sex (1 = male, 0 = female)\n\ncp: The chest pain type (Value 1: typical angina, Value 2: atypical angina, Value 3: non-anginal pain, Value 4: asymptomatic)\n\ntrestbps: resting blood pressure (on admission to the hospital)\n\nchol: cholesterol\n\nfbs: fasting blood sugar (> 120 mg\/dl, 1 = true; 0 = false)\n\nrestecg: Resting electrocardiographic measurement (0 = normal, 1 = having ST-T wave abnormality, 2 = showing probable)\n\nthalach: maximum heart rate achieved\n\nexang: Exercise induced angina (1 = yes; 0 = no)\n\noldpeak: ST depression induced by exercise relative to rest\n\nslope: the slope of the peak exercise ST segment (Value 1: upsloping, Value 2: flat, Value 3: downsloping)\n\nca: The number of major vessels (0-3)\n\nthal: thalassemia (3 = normal; 6 = fixed defect; 7 = reversable defect)\n\ntarget: Heart disease (0 = no, 1 = yes)","d089e02a":"## Model==>\n\n###### create two variable (x,y), x stores all independent features and (y) store dependent feature","7cfeba85":"### I'm also going to change the values of the categorical variables, to improve the interpretation\n","6f4f665e":"### Random Forest Algorithm Accuracy Score : 0.84\n\n### Random Forest Algorithm AUC Score : 0.92","1a594854":"#### Heart Disease Frequency Sex Wise==>","4542fec7":"#### Heart disease frequency acc. to fasting_blood_sugar==>","30099b03":"### Introduction\n\n\nWe have a data which classified if patients have heart disease or not according to features in it. We will try to use this data to create a model which tries predict if a patient has this disease or not. We will use Random Forest Classifier (classification) algorithm.\n\nThis dataset gives a number of variables along with a target condition of having or not having heart disease. Below, the data\nis first used in a simple random forest model, and then the model is investigated using ML tools and\ntechniques.","30245269":"### Context\n\n\nThis database contains 76 attributes, but all published experiments refer to using a subset of 14 of them. In particular, the \n\nCleveland database is the only one that has been used by ML researchers to\n\nthis date. The \"goal\" field refers to the presence of heart disease in the patient. It is integer valued from 0 (no presence) \n\nto 4.","56a76052":"##### RFECV (Recursive Feature Selection with cross validation)","0b6fa744":"#### I am new with data science. Please comment me your feedbacks to help me improve myself. Thanks for your time.","b39f27a7":"##### Heart Disease Frequency Ages Wise==>","f1cfb295":"For the categorical varibles, we need to create dummy variables. I'm also going to drop the first category of each. Ex- rather\n\nthan having 'male' and 'female', we'll have 'male' with values of 0 or 1 (1 being male, and 0 therefore being female).","2a81a00b":"#### Again fit the model with these significant features==>","06688545":"### Use Feature Selection Technique for select significant features","e531c9da":"## First, Load important Libraries=>","8378b1e6":"### Conclusion\n\nThis dataset is old and small by today's standards. However, it's allowed us to create a simple model and then use various machine learning explainability tools and techniques to peek inside. At the start, I hypothesised, using (Googled) domain knowledge that factors such as cholesterol and age would be major factors in the model.I actually feel like I've learnt a thing or two about heart disease!\n\nI suspect this sort of approach will become increasingly important as machine learning has a greater and greater role in health care.","c80e1cba":"## Creating Dummy Variables==>","b18c9972":"it's working well","0d10bc7d":"### All are natural outlier because cholestral level can be above 500","ddbe2c24":"#### Heart disease frequency acc. to chest pain type","4fd54442":"#### We will split our data. 75% of our data will be train data and 25% of it will be test data.","5fd4bf09":"Another common metric is the Area Under the Curve, or AUC. This is a convenient way to capture the performance of a model in a single number, As a rule of thumb, an AUC can be classed as follows,\n\n0.90 - 1.00 = excellent\n\n0.80 - 0.90 = good\n\n0.70 - 0.80 = fair\n\n0.60 - 0.70 = poor\n\n0.50 - 0.60 = fail\n\nLet's see what the above ROC gives us,","4ef695d5":"### Data==>"}}