{"cell_type":{"9bd5a669":"code","9e15c4de":"code","5dea7af9":"code","214825ab":"code","f23de06b":"code","54fb74d3":"code","b681bbd1":"code","6a7f9856":"code","89ff9455":"code","981fdaa6":"code","b44ab9ef":"code","1b9fd46e":"code","994b056d":"code","67f6fa4f":"code","86613c02":"code","9e2ba62b":"code","561148d7":"code","56a8e157":"code","e442979e":"code","3189fc0d":"code","489012a7":"markdown","110e2eb8":"markdown","b692edca":"markdown"},"source":{"9bd5a669":"import numpy as np\nimport pandas as pd \nimport xgboost\nimport csv as csv\nfrom xgboost import plot_importance\nfrom matplotlib import pyplot\nfrom sklearn.model_selection import cross_val_score,KFold\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_absolute_error\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import GridSearchCV\nfrom scipy.stats import skew\nfrom collections import OrderedDict\n\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import OrdinalEncoder","9e15c4de":"#read data\ntraining_features_data = pd.read_csv(\"..\/input\/flu-shot-learning-h1n1-seasonal-flu-vaccines\/training_set_features.csv\",\n                    sep=',')\n\n\ntraining_set_labels = pd.read_csv(\"..\/input\/flu-shot-learning-h1n1-seasonal-flu-vaccines\/training_set_labels.csv\",\n                    sep=',')\n\n\ntest_features_data = pd.read_csv(\"..\/input\/flu-shot-learning-h1n1-seasonal-flu-vaccines\/test_set_features.csv\",\n                    sep=',')\n","5dea7af9":"#eliminate null values\n\n#for float types\ntraining_features_data=training_features_data.fillna(training_features_data.mean())\n\n#for string types\ntraining_features_data=training_features_data.fillna('out-of-category')","214825ab":"#check no missing values are left \ntraining_features_data.isna().sum()","f23de06b":"#encoding categorical features (str-->float)\nenc = OrdinalEncoder()\n\nenc.fit(training_features_data)\ntraining_features_data_arr=enc.transform(training_features_data)\n\ncol_names_list=training_features_data.columns\nencoded_categorical_df=pd.DataFrame(training_features_data_arr, columns=col_names_list)","54fb74d3":"#normalization(make all values bet. 0-1)\nscaler = StandardScaler()\nscaler.fit(encoded_categorical_df)\nnormalized_arr=scaler.transform(encoded_categorical_df)\n\nnormalized_df=pd.DataFrame(normalized_arr, columns=col_names_list)","b681bbd1":"#check if data types are correct or not \nnormalized_df.info()","6a7f9856":"#check types of test dataset\ntest_features_data.info()","89ff9455":"#eliminate null values\n\n#for float types\ntest_features_data=test_features_data.fillna(test_features_data.mean())\n\n#for string types\ntest_features_data=test_features_data.fillna('out-of-category')","981fdaa6":"#check no missing values are left \ntest_features_data.isna().sum()","b44ab9ef":"#encoding categorical features  (str-->float)\nenc = OrdinalEncoder()\nenc.fit(test_features_data)\ntest_features_data_arr=enc.transform(test_features_data)\n\ncol_names_list=test_features_data.columns\ntest_encoded_categorical_df=pd.DataFrame(test_features_data_arr, columns=col_names_list)","1b9fd46e":"#check data types\ntest_encoded_categorical_df.info()","994b056d":"#normalization(bet. 0-1)\n\n#using minmax scaler(look up)\ntest_normalized_arr=scaler.transform(test_encoded_categorical_df)\ntest_normalized_df=pd.DataFrame(test_normalized_arr, columns=col_names_list)","67f6fa4f":"# split df to X and Y\ny = training_set_labels.loc[:, 'h1n1_vaccine'].values  #train_y\nX = normalized_df  #train_x\n","86613c02":"best_xgb_model = xgboost.XGBRegressor(\n                 colsample_bytree=0.4,\n                 gamma=0,                 \n                 learning_rate=0.1,\n                 max_depth=5,\n                 min_child_weight=1.5,\n                 n_estimators=10000,                                                                    \n                 reg_alpha=0.75,\n                 reg_lambda=0.45,\n                 subsample=0.6,\n                 seed=42)\n","9e2ba62b":"best_xgb_model.fit(X,y)","561148d7":"y_pred = best_xgb_model.predict(test_normalized_df)","56a8e157":"y_pred[:10]","e442979e":"np.sum(np.logical_or(np.array(y_pred) > 1, np.array(y_pred) < 0), axis=0)\n\ny_pred = 1\/(1+np.exp(-y_pred))","3189fc0d":"#write out pred to a file\ndf_pred_h1n1_vaccine_xg=pd.DataFrame(y_pred, columns=['h1n1_vaccine'])\ndf_pred_h1n1_vaccine_xg[\"respondent_id\"] = df_pred_h1n1_vaccine_xg.index\n\ndf_pred_h1n1_vaccine_xg=df_pred_h1n1_vaccine_xg[['respondent_id', 'h1n1_vaccine']]\n\ndf_pred_h1n1_vaccine_xg.to_csv('\/kaggle\/working\/df_h1n1_xg_son.csv', columns=['respondent_id', 'h1n1_vaccine'], \n                            index=False, sep=',')\n\ndf_pred_h1n1_vaccine_xg.head()","489012a7":"Looking for most relevant features","110e2eb8":"test dataset","b692edca":"This is a submission for hackathon by Driven Data. You can reach project specifications and dataset from here:\n> https:\/\/www.drivendata.org\/competitions\/66\/flu-shot-learning\/"}}