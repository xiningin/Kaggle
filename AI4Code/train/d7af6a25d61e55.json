{"cell_type":{"c92b08fd":"code","5b39650a":"code","e03f791b":"code","e170cbed":"code","a2284907":"code","5a503a52":"code","488af80a":"code","e4d0d5f5":"code","08ab4dde":"code","67f80ea4":"code","3bc28764":"code","d5e8c692":"code","e6e084fe":"code","e0b1ea17":"code","cb18686f":"code","88a9698a":"code","848fcda7":"code","aca6f7ff":"code","02db098e":"code","f42bff25":"code","f422d7bd":"code","c20b58de":"code","b990caa0":"code","b6b673a6":"code","dafe98f9":"code","7a96f537":"code","cc9c715c":"code","5cadcacb":"code","d97e2d42":"code","22ee193e":"code","1769527a":"markdown","0cd4e208":"markdown","f0efabbb":"markdown","df285ec7":"markdown","c21bdae0":"markdown","33dad5e6":"markdown","06178dd9":"markdown","a92b7515":"markdown","f76c90e0":"markdown","c6c10158":"markdown","c1f4b68f":"markdown"},"source":{"c92b08fd":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\n\nwarnings.filterwarnings('ignore')\nwarnings.filterwarnings('ignore',message='DeprecationWarning')\nfrom sklearn import preprocessing\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn import metrics\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier","5b39650a":"train=pd.read_csv('..\/input\/train.csv').copy()\ntest=pd.read_csv('..\/input\/test.csv').copy()","e03f791b":"train.describe()","e170cbed":"train.info()","a2284907":"train['type'].unique()","5a503a52":"train=train.drop(['id'],axis=1)\ntest_df=test.drop(['id'],axis=1)","488af80a":"train.head()","e4d0d5f5":"np.sort(train['color'].unique())==np.sort(test['color'].unique())","08ab4dde":"color_le=preprocessing.LabelEncoder()\ncolor_le.fit(train['color'])\ntrain['color_le']=color_le.transform(train['color'])\n","67f80ea4":"sns.pairplot(train.drop(['color'],axis=1),palette='muted',diag_kind='kde',hue='type')","3bc28764":"train.drop(['color_le'],axis=1,inplace=True)","d5e8c692":"sns.heatmap(train.corr(),annot=True)","e6e084fe":"df=pd.get_dummies(train.drop(['type'],axis=1))\nX_train,X_test,y_train,y_test=train_test_split(df,train['type'],random_state=0)","e0b1ea17":"tr=DecisionTreeClassifier(random_state=0)\ntr.fit(X_train,y_train)\ny_pre=tr.predict(X_test)\n\nprint(\"accuracy score is \",metrics.accuracy_score(y_test,y_pre))\nprint('\\n',metrics.classification_report(y_test,y_pre))","cb18686f":"sns.barplot(y=X_test.columns,x=tr.feature_importances_)","88a9698a":"params={'max_depth':np.linspace(1, 16, 16, endpoint=True),'min_samples_split':np.linspace(.1, 1,10, endpoint=True),\"max_features\":[1,4,6]}","848fcda7":"accuracy=metrics.make_scorer(metrics.accuracy_score)","aca6f7ff":"tr=DecisionTreeClassifier()\nclf=GridSearchCV(tr,param_grid=params,scoring=accuracy,cv=5,n_jobs=-1)\nclf.fit(X_train,y_train)\nprint('best score',clf.best_score_)\nprint('param',clf.best_params_)","02db098e":"rf=RandomForestClassifier(random_state=0)\nrf.fit(X_train,y_train)\ny_pre=rf.predict(X_test)\n\nprint('rf basline score',metrics.accuracy_score(y_test,y_pre))\nprint('\\n',metrics.classification_report(y_test,y_pre))","f42bff25":"gb=GradientBoostingClassifier()\ngb.fit(X_train,y_train)\ny_pre=gb.predict(X_test)\n\nprint('score',metrics.accuracy_score(y_test,y_pre))","f422d7bd":"rf.get_params()","c20b58de":"from sklearn.model_selection import RandomizedSearchCV\n\n# Number of trees in random forest\nn_estimators = [int(x) for x in np.linspace(start = 10, stop = 200, num = 20)]\n# Number of features to consider at every split\nmax_features = ['auto', 'sqrt']\n# Maximum number of levels in tree\nmax_depth = [int(x) for x in np.linspace(10, 110, num = 11)]\nmax_depth.append(None)\n# Minimum number of samples required to split a node\nmin_samples_split = [2, 5, 10]\n# Minimum number of samples required at each leaf node\nmin_samples_leaf = [1, 2, 4]\n# Method of selecting samples for training each tree\nbootstrap = [True, False]\n\n# Create the random grid\nrandom_grid = {'n_estimators': n_estimators,\n               'max_features': max_features,\n               'max_depth': max_depth,\n               'min_samples_split': min_samples_split,\n               'min_samples_leaf': min_samples_leaf,\n               'bootstrap': bootstrap}\n\nprint(random_grid)","b990caa0":"rf1=RandomForestClassifier(random_state=0)\nrf1_rand=RandomizedSearchCV(rf1,param_distributions=random_grid,n_iter=100,cv=3,n_jobs=-1)\nrf1_rand.fit(X_train,y_train)\nprint(rf1_rand.best_params_)","b6b673a6":"best_random=rf1_rand.best_estimator_\nbest_random.fit(X_train,y_train)\ny_pre=best_random.predict(X_test)\nprint(metrics.accuracy_score(y_test,y_pre))","dafe98f9":"params={'max_features':['auto',],'bootstrap':[False],'max_depth':[50,60,70,56],'min_samples_leaf':[1,2],'n_estimators':[100,120,130,140],'min_samples_split':[5,10,15,20]}\nrf=RandomForestClassifier()\ngcv=GridSearchCV(rf,param_grid=params,cv=5,n_jobs=-1,scoring=accuracy)\ngcv.fit(X_train,y_train)\nprint('score',gcv.best_params_)","7a96f537":"y_pre=gcv.predict(X_test)\nprint('score',metrics.accuracy_score(y_test,y_pre))","cc9c715c":"gcv.param_grid","5cadcacb":"test_=pd.get_dummies(test_df)","d97e2d42":"pre=gcv.predict(test_)","22ee193e":"df=pd.DataFrame({'id':test['id'],'type':pre},columns=['id','type'])\ncsv=df[['id','type']].to_csv('submission.csv',index=False)","1769527a":"There are 3 types of monsters in the dataset","0cd4e208":"Gradient Boosting","f0efabbb":"Making submission","df285ec7":"Random forrests","c21bdae0":"on hot encoding","33dad5e6":"### Encoding categorical variable","06178dd9":"\n## Baseline modelling","a92b7515":"## Loading datasets","f76c90e0":"There is no missing values in the dataset.","c6c10158":" Tuning random forrest classifier","c1f4b68f":"correlation"}}