{"cell_type":{"6a76d020":"code","e3a8a801":"code","6968b214":"code","9f1377d0":"code","0e568acc":"code","e59f75ad":"code","edf68dd0":"code","84806cba":"code","aded5641":"code","69345eea":"code","c846dfc1":"code","c55a813d":"markdown","00161bcd":"markdown","542d1530":"markdown"},"source":{"6a76d020":"import pandas as pd\nimport numpy as np\nimport matplotlib as plt\nimport seaborn as sns","e3a8a801":"train = pd.read_csv('\/kaggle\/input\/tabular-playground-series-jan-2022\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/tabular-playground-series-jan-2022\/test.csv')\n\ndisplay(train, test)","6968b214":"all_data = pd.concat([train, test])\nall_data","9f1377d0":"all_data['date'] = pd.to_datetime(all_data['date'])\nall_data['year'] = all_data['date'].dt.year\nall_data['month'] = all_data['date'].dt.month\nall_data['day'] = all_data['date'].dt.day\nall_data['dayofweek'] = all_data['date'].dt.dayofweek\nall_data['dayofmonth'] = all_data['date'].dt.days_in_month\nall_data['dayofyear'] = all_data['date'].dt.dayofyear\nall_data['weekday'] = all_data['date'].dt.weekday\nall_data['weekofyear'] = all_data['date'].dt.weekofyear","0e568acc":"all_data.drop(columns = ['num_sold', 'date', 'row_id'], inplace = True)\nall_data","e59f75ad":"from sklearn.preprocessing import LabelEncoder\n\nle = LabelEncoder()\nfor col in ['country', 'product', 'store']:\n    all_data[col] = le.fit_transform(all_data[col])\n    \n    \nall_data","edf68dd0":"train2 = all_data[:len(train)]\ntest2 = all_data[len(train):]\ny = train['num_sold']","84806cba":"from sklearn.model_selection import TimeSeriesSplit\nkfold = TimeSeriesSplit(10)","aded5641":"from catboost import CatBoostRegressor\n\ntest_pred = []\nfor fold, (train_id, test_id) in enumerate(kfold.split(train2)):\n    print('<------- fold', fold+1, '------->')\n    x_train, y_train = train2.iloc[train_id], y.iloc[train_id]\n    x_valid, y_valid = train2.iloc[test_id], y.iloc[test_id]\n    \n    cat = CatBoostRegressor(n_estimators = 10000)\n    cat.fit(x_train, y_train, eval_set = (x_valid, y_valid), verbose = 1000, early_stopping_rounds = 1500)\n    test_pred.append(cat.predict(test2))","69345eea":"sold = np.mean(test_pred, axis = 0)","c846dfc1":"sub = pd.read_csv('\/kaggle\/input\/tabular-playground-series-jan-2022\/sample_submission.csv')\nsub['num_sold'] = sold\nsub.to_csv('sub.csv', index = False)","c55a813d":"# **Preprocessing**","00161bcd":"# **TPS Jan, 2022**\n\n## **Catboost Baseline**","542d1530":"# **Modeling**\n\n* Used TimeSeriesSplit"}}