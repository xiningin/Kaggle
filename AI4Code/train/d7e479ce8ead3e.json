{"cell_type":{"0d097da1":"code","085121ed":"code","bf55b886":"code","827e8460":"code","dd667a68":"code","30c0956d":"code","8f0d2d8a":"code","f7b8190d":"code","392e8e68":"code","cfdeeba5":"code","ec7103b9":"code","045f8849":"code","edc193ec":"code","560d983f":"code","fa7c0f0f":"code","7267eccd":"code","98f3313e":"code","0c64d663":"code","d3d0a4bc":"code","13b851be":"code","a2bbdb96":"code","41297d6b":"code","acad36b8":"code","2f640f1d":"code","f23e7fad":"markdown","f7c51298":"markdown","ba803e6f":"markdown"},"source":{"0d097da1":"from fastai import *\nfrom fastai.vision import *\n\nimport numpy as np \nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import auc,roc_curve\n\nimport os\nprint(os.listdir(\"..\/input\"))","085121ed":"path = Path('..\/input\/IDC_regular_ps50_idx5\/')","bf55b886":"fnames=get_files(path, recurse=True)","827e8460":"pattern= r'([^\/_]+).png$'","dd667a68":"tfms=get_transforms(flip_vert=True, max_warp=0., max_zoom=0., max_rotate=0.)","30c0956d":"data = ImageDataBunch.from_name_re(path, fnames, pattern, ds_tfms=tfms, size=50, bs=64,num_workers=2\n                                  ).normalize()","8f0d2d8a":"data.show_batch(rows=3, figsize=(8,8))","f7b8190d":"arch = densenet121","392e8e68":"learner= create_cnn(data, models.densenet121, metrics=[accuracy], model_dir='\/tmp\/models\/')","cfdeeba5":"learner.lr_find()\nlearner.recorder.plot()","ec7103b9":"lr=1e-1\nlearner.fit_one_cycle(1, lr)","045f8849":"learner.unfreeze()","edc193ec":"learner.lr_find()\nlearner.recorder.plot()","560d983f":"learner.fit_one_cycle(3,slice(1e-4,1e-3))","fa7c0f0f":"learner.recorder.plot_losses()","7267eccd":"learner.save('stage-1', return_path=True) ","98f3313e":"learner.freeze_to(-3)","0c64d663":"learner.lr_find()\nlearner.recorder.plot()","d3d0a4bc":"learner.fit_one_cycle(2,slice(1e-5,1e-4))","13b851be":"learner.freeze_to(-2)\nlearner.fit_one_cycle(2,slice(1e-6,1e-5))","a2bbdb96":"conf= ClassificationInterpretation.from_learner(learner)\nconf.plot_confusion_matrix(figsize=(10,8))","41297d6b":"# Predictions of the validation data\npreds_val, y_val=learner.get_preds()","acad36b8":"#  ROC curve\nfpr, tpr, thresholds = roc_curve(y_val.numpy(), preds_val.numpy()[:,1], pos_label=1)\n\n#  ROC area\npred_score = auc(fpr, tpr)\nprint(f'ROC area is {pred_score}')","2f640f1d":"plt.figure()\nplt.plot(fpr, tpr, color='orange', label='ROC curve (area = %0.2f)' % pred_score)\nplt.plot([0, 1], [0, 1], color='navy', linestyle='--')\nplt.xlim([-0.01, 1.0])\nplt.ylim([0.0, 1.01])\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive Rate')\nplt.title('Receiver Operating Characteristic')\nplt.legend(loc=\"lower right\")","f23e7fad":"## Dataset ","f7c51298":"\n## Model","ba803e6f":"# Invasive Ductal Carcinoma Classifier\n\"Invasive Ductal Carcinoma (IDC) is the most common subtype of all breast cancers. To assign an aggressiveness grade to a whole mount sample, pathologists typically focus on the regions which contain the IDC. As a result, one of the common pre-processing steps for automatic aggressiveness grading is to delineate the exact regions of IDC inside of a whole mount slide. The original dataset consisted of 162 whole mount slide images of Breast Cancer (BCa) specimens scanned at 40x. From that, 277,524 patches of size 50 x 50 were extracted (198,738 IDC negative and 78,786 IDC positive). Each patch\u2019s file name is of the format: u_xX_yY_classC.png \u2014 > example 10253_idx5_x1351_y1101_class0.png . Where u is the patient ID (10253_idx5), X is the x-coordinate of where this patch was cropped from, Y is the y-coordinate of where this patch was cropped from, and C indicates the class where 0 is non-IDC and 1 is IDC."}}